\sim 33\%
1.5\times
3\times
5
5
<1\%
<1\%
16\%
36\%
18\%
49\%
f_{\theta}:\mathcal{X}\to\mathcal{Y}
f_{\theta}=f^{(\mathsf{head})}_{\theta_{\mathsf{head}}}\circ f^{(\mathsf{L})}_%
{\theta_{L}}\circ\ldots\circ f^{(\mathsf{1})}_{\theta_{1}}\circ f^{(\mathsf{%
embed})}_{\theta_{\mathsf{embed}}}
\theta=(\theta_{\mathsf{head}},\theta_{L},\ldots,\theta_{1},\theta_{\mathsf{%
embed}})
f^{(\mathsf{embed})}_{\theta_{\mathsf{embed}}}
f^{(\mathsf{head})}_{\theta}{}_{\mathsf{head}}
\theta^{\mathsf{pretrain}}
D_{\mathsf{train}}{\color[rgb]{0.5,0.5,0}\sim P_{\mathsf{finetune}}}
\ell:\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}_{\geq 0}
L(\theta)=\frac{1}{\lvert D_{\mathsf{train}}\rvert}\sum_{(x,y)\in D_{\mathsf{%
train}}}\ell(f_{\theta}(x),y)
\theta^{\mathsf{pretrain}}
D_{\mathsf{test}}^{\mathsf{id}}\sim{\color[rgb]{0.5,0.5,0}P_{\mathsf{finetune}}}
D_{\mathsf{test}}^{\mathsf{ood}}\sim{\color[rgb]{.75,0,.25}P_{\mathsf{ood}}}
{\color[rgb]{0.5,0.5,0}P_{\mathsf{finetune}}}
L(\theta)
f^{(\mathsf{embed})}_{\theta_{\mathsf{embed}}}
f^{(\mathsf{head})}_{\theta_{\mathsf{head}}}
7\times 7
2
2\times 2
4\times 4
4
f^{(\mathsf{head})}_{\theta_{\mathsf{head}}}
\approx
f_{\theta}=f^{(\mathsf{head})}_{\theta_{\mathsf{head}}}\circ f^{(\mathsf{L})}_%
{\theta_{L}}\circ\ldots\circ f^{(\mathsf{1})}_{\theta_{1}}\circ f^{(\mathsf{%
embed})}_{\theta_{\mathsf{embed}}}
B=\{(x_{1},y_{1}),\ldots,(x_{b},y_{b})\}
\ell\in\{\mathsf{embed},1,2,\ldots,L,\mathsf{head}\}
g_{\ell}(B)=\frac{1}{|B|}\sum_{i=1}^{|B|}\nabla_{\theta_{\ell}}l(f_{\theta^{%
\mathsf{pretrain}}}(x_{i}),y_{i})
\|g_{\ell}(B)\|_{2}
\ell
B_{1},\ldots,B_{m}
D_{\mathsf{train}}
G^{\mathsf{init}}_{\ell}=\frac{1}{m}\sum_{t=1}^{m}\|g_{\ell}(B_{t})\|_{2},%
\text{ where }\ell\in\{\mathsf{embed},1-L,\mathsf{head}\}.
\theta^{\mathsf{pretrain}}
G^{\mathsf{init}}_{\ell}
G^{\mathsf{init}}_{\ell}
G^{\mathsf{init}}_{\mathsf{embed}}
G^{\mathsf{init}}_{\mathsf{head}}
G^{\mathsf{init}}_{\ell}
G^{\mathsf{init}}_{\mathsf{embed}}
G^{\mathsf{init}}_{\mathsf{head}}
8\%
16\%
36\%
18\%
48\%
20\%
60\%
\sqrt{L}
L
3
3
\theta^{(0)}=\theta^{\mathsf{pretrain}}
batch\_size
num\_epochs
T=\frac{num\_epochs\cdot{|D_{\mathsf{train}}|}}{batch\_size}
t=0,1,\ldots,T
B_{t}
D_{\mathsf{train}}
g_{t}=\frac{1}{|B_{t}|}\sum_{(x,y)\in B_{t}}\nabla_{\theta}l(f_{\theta}(x),y)
\theta^{(t)}
g_{t}
\theta^{(t)}
m_{t}
m_{-1}=0
\eta_{t},\mu,\lambda
\eta_{t}
\mu
\lambda
\begin{split}g_{t}&=g_{t}+\lambda\theta^{(t)}\\
m_{t}&=\mu m_{t-1}+g_{t}\quad(\text{first moment})\\
\theta^{(t+1)}&=\theta^{(t)}-\eta_{t}m_{t}\end{split}
m_{t}
v_{t}
m_{-1}=v_{-1}=0
\eta_{t},\beta_{1},\beta_{2},\lambda
\eta_{t}
(\beta_{1},\beta_{2})
\lambda
\begin{split}m_{t}&=\beta_{1}m_{t-1}+(1-\beta_{1})g_{t}\;\quad(\text{first %
moment})\\
v_{t}&=\beta_{2}v_{t-1}+(1-\beta_{2})g_{t}^{\odot 2}\quad(\text{second moment}%
)\\
\widehat{m}_{t}&=\frac{m_{t}}{(1-\beta_{1}^{t})};\;\quad\widehat{v}_{t}=\frac{%
v_{t}}{(1-\beta_{2}^{t})}\\
\theta^{(t+1)}&=(1-\eta_{t}\lambda)\theta^{(t)}-\eta_{t}\frac{\widehat{m}_{t}}%
{\sqrt{\widehat{v}_{t}}+\epsilon}\end{split}
0
T
t
0
T
\exp(3.73*(1.0-t/(T-1)))
\exp(3.73)\approx 41.7
0
1
\exp(3.73)
224\times 224
224\times 224
224\times 224
256\times 256
224\times 224
256\times 256
224\times 224
224\times 224
224\times 224
224\times 224
(-7,2,5)
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\approx c
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
\sqrt{\text{\#parameters}}
