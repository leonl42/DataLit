\mathtt{root}(Z)
\mathtt{children}(Z_{j})
Z_{j}
Z_{j}
g
\mathtt{on}(Z_{j})
\mathtt{on}(g)
Z_{j}
g
\mathtt{x}
\mathtt{y}
\mathtt{shape}
\mathtt{moon}
\mathtt{star}
\mathtt{ship}
\mathtt{moon}
\mathtt{phase}
\mathtt{star}
\mathtt{shine}
\mathtt{ship}
\mathtt{angle}
\mathtt{ship}
\mathtt{jet}
\mathtt{jetlen}
\mathtt{jetlen}
\mathtt{slope}
\mathtt{intercept}
\mathtt{both}
\mathtt{either}
\mathtt{chop}
\mathtt{depth}
\mathtt{either}
\mathtt{both}
X
X
X
Z
Z
Z
\hat{H}
\hat{A}_{n}
X
Z
Z=X
|Z|
|Z|
Z
H
H
X
X
X
\mathrm{HAE}_{\theta}=\text{init\_hierarchical\_autoencoder}(\mathrm{hierarchy})
D_{\psi}=\text{init\_discriminator}()
x,a\sim\mathrm{minibatch}(X,\mathrm{assignments})
a^{\prime},z=\mathrm{HAE}_{\theta}.\mathrm{encode(}x;\tau)
x^{\prime}=\mathrm{HAE}_{\theta}.\mathrm{decode}(\mathrm{concat(}a^{\prime},z%
\mathrm{))}
z^{\prime}=\mathrm{copy}(z)
i=1..|z_{0}|
\mathrm{shuffle}\,z^{\prime}_{:,i}\,\mathrm{over\,minibatch\,indices\,where}\,%
\mathtt{on}(z_{:,i})
\mathcal{L}_{\theta}=\mathcal{L}_{x}(x^{\prime},x)+\lambda_{1}\mathcal{L}_{a}(%
a^{\prime},a)-\lambda_{2}\log\frac{D_{\psi}(z)}{1-D_{\psi}(z)}
\mathcal{L}_{\psi}={-}\log D_{\psi}(z^{\prime})-\log(1-D_{\psi}(z))
\theta=\mathrm{descent\_step}(\theta,\mathcal{L}_{\theta})
\psi=\mathrm{descent\_step}(\psi,\mathcal{L}_{\psi})
\mathrm{HAE}_{\theta}
x
z_{pre}
\tau
z_{pre}
z
a^{\prime}
a
\mathcal{L}_{a}(a^{\prime},a)
\lambda_{1}
a^{\prime}
a
z
q(z)
z
\bar{q}(z)\equiv\prod_{j=1}^{|z|}q(z_{j})
\bar{q}(z)
z_{i}
D_{\psi}(z)
KL(q(z)||\bar{q}(z))\approx\log\frac{D_{\psi}(z)}{1-D_{\psi}(z)}
D_{\psi}(z)
z
\bar{q}
z_{i}
\mathcal{B}
\mathcal{B}\cap\mathtt{on}(z_{i})
\bar{q}(z)
D_{\psi}(z)
q(z)
\lambda_{2}
Z
V
V_{i}
Z_{j}
Z_{j}
V_{i}
\mathtt{phase}
\mathtt{shine}
\mathtt{angle}
\mathtt{shape}
\mathtt{x}
\mathtt{y}
H
H
\hat{H}
H
H
H
\hat{H}
\hat{H}
H
\hat{H}
R^{4}
R^{4}_{c}
V_{i}
Z_{j}
Z_{j}
V_{i}
\mathcal{S}\subseteq\mathbb{R}
\begin{split}\exists\,f(\cdot):\mathcal{S}\to\mathbb{R}\text{ s.t. }f(V_{i})&=%
Z_{j}\text{ and }f^{-1}(Z_{j})=V_{i}\end{split}
Z
V
V_{i}
Z_{j}
V_{i}
Z_{j}
R^{2}
\begin{split}f&\equiv\min_{f\in\mathcal{F}}\mathbb{E}_{\mathrm{train}}\left[(f%
(X)-Y)^{2}\right]\\
R^{2}(X{\to}Y)&\equiv\mathbb{E}_{\mathrm{test}}\left[1-\frac{\sum(f(X)-Y)^{2}}%
{\sum(\mathbb{E}[Y]-Y)^{2}}\right]\\
R^{2}(X{\leftrightarrow}Y)&\equiv\sqrt{\lfloor R^{2}(X{\to}Y)\rfloor_{+}%
\lfloor R^{2}(Y{\to}X)\rfloor_{+}},\\
\end{split}
\mathcal{F}
f\in\mathcal{F}
R^{2}(X{\leftrightarrow}Y)
X
Y
\mathbb{E}[(f(X)-Y)^{2}]>0
\mathbb{E}[(f(Y)-X)^{2}]>0
Y
f
R^{2}
Z
V
V_{i}
Z_{j}
R^{2}(V_{i}\leftrightarrow Z_{j})=1
R^{4}(V,Z)\equiv\frac{1}{|V|}\sum_{i}\max_{j}R^{2}(V_{i}\leftrightarrow Z_{j}),
R^{2}
R^{4}
R^{2}
R^{4}
R^{2}
\mathbb{E}[Y]
V_{i}
Z
\begin{split}\text{for}&\,\text{all}\,V_{i}\in\mathtt{on}(V_{i})\,\exists\,%
\mathcal{Z}_{i}=\{Z_{j},Z_{k},\ldots\}\,\mathrm{s.t.}\\
&(a)\,V_{i}\,\text{corresponds to}\,Z_{j}\,\text{over}\,\mathtt{on}(V_{i})\cap%
\mathtt{on}(Z_{j}),\\
&(b)\,\mathtt{on}(Z_{j})\cap\mathtt{on}(Z_{k})=\emptyset\,\text{for all}\,j%
\neq k,\text{and}\\
&(c)\,\textstyle\bigcup_{z\in\mathcal{Z}_{i}}\mathtt{on}(z)=\mathtt{on}(V_{i})%
,\end{split}
\mathtt{on}(V_{i})
Z_{j}
Z_{j}
V
V_{i}
Z
R_{c}^{4}
\begin{split}R^{2}_{c}(V_{i},g)\equiv&\max\bigg{(}\max_{j\in g}\Big{(}R^{2}%
\big{(}V_{i}{\leftrightarrow}Z_{j}\big{|}\mathtt{on}(V_{i})\cap\mathtt{on}(g)%
\big{)},\\
&\displaystyle\sum_{g^{\prime}\in\mathtt{children}(Z_{j})}R^{2}_{c}(V_{i},g^{%
\prime})\frac{\left|\mathtt{on}(V_{i})\cap\mathtt{on}(g^{\prime})\right|}{|%
\mathtt{on}(V_{i})|}\Big{)}\bigg{)},\end{split}
g
R^{4}_{c}(V{\leftrightarrow}Z)\equiv\frac{1}{|V|}\sum_{i=1}^{|V|}R^{2}_{c}(V_{%
i},\mathtt{root}(Z)).
V
Z
R^{4}_{c}
R^{4}
R^{4}
\beta
H
R^{4}_{c}
R^{4}
X
a^{\prime}
a
x
\tau
\{\frac{1}{2},\frac{2}{3},1\}
\lambda_{1}
\{10,100,1000\}
\lambda_{2}
\{1,10,100\}
\mathcal{L}_{x}
\frac{1}{3}
\mathcal{L}_{a}
H
\beta{=}5
\gamma{=}10
\beta{=}1,C_{z}{=}C_{c}{=}10
\beta_{\ell}{=}2
\beta
\beta
\mathtt{both}
H
H
A
H{+}A
H{+}A{+}TC(Z)
H{+}A{+}TC(Z|on)
H{+}A{+}Z
H{+}TC(Z)
\mathtt{both}
H
H
A
H{+}A
H{+}A{+}TC(Z)
H{+}A{+}TC(Z|on)
H{+}A{+}Z
H{+}TC(Z)
1.0{\pm}0.0
1.0{\pm}0.0
1.0{\pm}0.0
1.0{\pm}0.0
.98{\pm}0.0
.95{\pm}0.0
.94{\pm}0.0
.93{\pm}0.0
1.0{\pm}0.0
.99{\pm}0.0
.99{\pm}0.0
.96{\pm}0.0
.94{\pm}0.0
.98{\pm}0.0
.98{\pm}0.0
.82{\pm}0.01
.75{\pm}0.01
1.0{\pm}0.0
H
0.0{\pm}0.0
0.0{\pm}0.0
0.0{\pm}0.0
0.0{\pm}0.0
0.0{\pm}0.0
0.0{\pm}0.0
0.0{\pm}0.0
2.40{\pm}0.89
0.0{\pm}0.0
H
H
R^{4}
R^{4}_{c}
R^{4}
R^{4}_{c}
\mathtt{either}
R^{4}_{c}
\mathtt{either}
\mathtt{both}
\mathtt{both}
R^{4}_{c}
H{+}A{+}Z
\gamma{=}1
R^{4}_{c}
H{+}A{+}Z
R^{4}
R^{4}_{c}
R^{4}
R^{2}
R^{4}
R^{4}_{c}
R^{4}_{c}
R^{4}
R^{4}
\mathtt{x}
\mathtt{y}
R^{4}_{c}
0.98{\to}0.89
\mathtt{jetlen}
R^{4}_{c}
R^{4}
R^{4}_{c}
\beta
\beta
Z_{3}
\mathtt{phase}
\mathtt{shine}
\mathtt{jetlen}
R^{4}
R^{4}_{c}
N
\frac{7}{8}
\frac{1}{8}
8*32*N=256N
N
(\frac{1}{8}*8*32)+(\frac{7}{8}*1*32)+1)N=61N
\mathcal{L}_{x}
\sigma=0.1
\mathcal{L}_{x}
\mathcal{L}_{a}
\mathcal{L}_{a}(a,a^{\prime})=\sum_{i}\mathbbm{1}[a_{i}^{\prime}{\geq}0](a_{i}%
-a_{i}^{\prime})^{2}
\max(0,x)
\ln(1+e^{x})
\frac{1}{10}
\tau
\lambda_{1}
\lambda_{2}
X
A
\tau
\{\frac{1}{2},\frac{2}{3},1\}
\lambda_{1}
\{10,100,1000\}
\lambda_{2}
\{1,10,100\}
\sum_{n}||x_{n}-x_{n}^{\prime}||_{2}^{2}
\sum_{n}\mathcal{L}_{a}(a_{n},a_{n}^{\prime})
R^{4}
R^{4}_{c}
d\geq 1
1-2^{-(d-1)}
H
H
H
\hat{H}
H
\hat{H}
H
N
O(|Z|N\log N)
|Z|
|X|
\mathtt{num\_nearest\_neighbors}
k
O(N(|Z|^{2}k+|Z|k^{2}+k^{3}))
k
|Z|
O(Nkd^{3}(d+|Z|))
d
O(Nke^{d})
O(Nk^{2}d)
Z
Z
Z
\mathtt{ransac\_frac}<1
\mathrm{each\,dimension}
d
\mathrm{from}
1
\mathrm{to}
\mathtt{initial\_dim}-1
\mathrm{each\,point}\,z_{n}
z_{n}
d
\mathtt{num\_nearest\_neighbors}
100\times\mathtt{ransac\_frac}
\mathrm{each\,dimension}
d
\mathrm{from}
1
\mathrm{to}
\mathtt{initial\_dim}-1
d
d
d+1
\mathrm{both\,of\,these\,conditions\,are\,true}
d
U,V
U,V
U
V
|\det(U\cdot V^{T})|
z_{i}
z_{i}
z_{i}
z_{j}
\mathrm{TangentPlaneCos}(\mathrm{svds}_{i},\mathrm{svds}_{j})\geq\mathtt{cos\_%
simil\_thresh}
z_{k}
z_{\ell}
\mathrm{TangentPlaneCos}(\mathrm{svds}_{k},\mathrm{svds}_{\ell})\geq\mathtt{%
cos\_simil\_thresh}
z_{k}
\mathtt{min\_size\_init}
c_{i}
c_{i}
c_{i}
M
|
|
|
|
(c_{i},c_{j})
M_{ij}
c_{i}
c_{j}
M
c_{i}\neq c_{j}
d
M_{ij}\geq\mathtt{min\_common\_edge\_frac}(d)
\mathtt{min\_size\_merged}
c_{i}
c_{i}
(c_{i},c_{j})
c_{i}
c_{i}
c_{j}
c_{i}.\mathrm{neighbor\_lengthscale}
\mathrm{the\,resulting\,ratio}\leq\mathtt{neighbor\_lengthscale\_mult}
c_{j}\in c_{i}
c_{j}
c_{i}
c_{1}\in c_{2}\in c_{3}
c_{1}
c_{3}
\emptyset
\mathrm{HAE}_{\theta}
x;\tau
\mathrm{HAE}_{\theta}
x;\tau
x
z_{pre}
\mathrm{HAE}_{\theta}.\mathrm{hierarchy}
\tau
z_{pre}
\mathrm{HAE}_{\theta}.\mathrm{hierarchy}
a^{\prime}
z
m
\mathtt{either}
\mathtt{either}
\mathtt{slope}
0
\mathtt{either}
\mathtt{either}
\mathtt{slope}
0
H
\mathtt{contagion\_num}{>}1
\mathtt{ransac\_frac}{<}1
H
\mathtt{contagion\_num}{>}1
\mathtt{ransac\_frac}{<}1
\mathtt{initial\_dim}=|X|
40
2/3
0.95
4
\epsilon
0.99
0.95
T
5
3
20\%
\mathtt{num\_nearest\_neighbors}
0.02\%
2\%
d
2^{-d-1}+2^{-d-2}
d
2^{d}
2^{-d}
d+1
2^{-d-1}
2^{-d-1}+2^{-d-2}
10
H
H
A
H{+}A
H{+}A{+}TC(Z)
H{+}A{+}TC(Z|on)
H{+}A{+}Z
H
H
A
H{+}A
H{+}A{+}TC(Z)
H{+}A{+}TC(Z|on)
H{+}A{+}Z
R^{4}_{c}
R^{4}_{c}
R^{4}
R^{4}_{c}
R^{4}
R^{4}_{c}
R^{4}
R^{4}_{c}
R^{4}
R^{4}_{c}
R^{4}
R^{4}_{c}
R^{4}
R^{4}_{c}
\beta
R^{4}_{c}
\beta
\beta
R^{4}_{c}
\beta
\mathtt{shine}
Z_{5}
\mathtt{phase}
Z_{8}
\mathtt{angle}
Z_{10}
\mathtt{jetlen}
Z_{12}
(\mathtt{x},\mathtt{y})
(Z_{3},Z_{4})
(Z_{6},Z_{7})
(Z_{11},Z_{9})
\mathtt{shine}
Z_{5}
\mathtt{phase}
Z_{8}
\mathtt{angle}
Z_{10}
\mathtt{jetlen}
Z_{12}
(\mathtt{x},\mathtt{y})
(Z_{3},Z_{4})
(Z_{6},Z_{7})
(Z_{11},Z_{9})
\mathtt{phase},\mathtt{shine},\mathtt{angle}
\mathtt{x}
\mathtt{y}
R^{4}_{c}
H
\mathtt{phase},\mathtt{shine},\mathtt{angle}
\mathtt{x}
\mathtt{y}
R^{4}_{c}
H
\mathtt{both}
\mathtt{both}
\mathtt{both}
\mathtt{both}
\mathtt{either}
R^{4}_{c}
\mathtt{either}
R^{4}_{c}
