y_{i}
i+1
y_{i}
i
y_{i}
y_{i}
i+1
y_{i}
i
y_{i}
i
y_{i}
y^{\prime}_{i}
y_{i}
y^{\prime}_{i}
y_{i}
y^{\prime}_{i}
y_{i}
i
y_{i}
y_{i}
i+1
i
i+1
y_{i}
y_{i}
\bullet
\bullet
\bullet
\mathbf{x}=\{x_{1},...,x_{|\mathbf{x}|}\}
\mathbf{y}=\{y_{1},...,y_{|\mathbf{y}|}\}
p(\mathbf{y}|\mathbf{x};\bm{\theta})
\displaystyle p(\mathbf{y}|\mathbf{x};\bm{\theta})=\prod_{t=1}^{|\mathbf{y}|+1%
}p(y_{t}|y_{0:t-1},\mathbf{x};\bm{\theta}),
\displaystyle p(\mathbf{y}|\mathbf{x};\bm{\theta})=\prod_{t=1}^{|\mathbf{y}|+1%
}p(y_{t}|y_{0:t-1},\mathbf{x};\bm{\theta}),
y_{0}=\langle\mathrm{bos}\rangle
y_{|\mathbf{y}|+1}=\langle\mathrm{eos}\rangle
\bm{\theta}
\mathbf{h}=\{h_{1},...,h_{|\mathbf{x}|}\}
l
\mathbf{z}=\{z_{1}^{l},...,z_{|\mathbf{y}|+1}^{l}\}
l
\bm{W}^{l}\in\mathbb{R}^{(|\mathbf{y}|+1)\times|\mathbf{x}|}
W_{i,j}^{l}
z_{i}^{l}
h_{j}
\bm{S}\in\mathbb{R}^{{{|\mathbf{y}|}\times|\mathbf{x}|}}
S_{i,j}
y_{i}
x_{j}
\bm{S}
S_{i,j}=W_{i,j}^{l}\quad(1\leq i\leq|\mathbf{y}|\mathrm{,}1\leq j\leq|\mathbf{%
x}|)
\bm{A}
\displaystyle A_{ij}=\left\{\begin{array}[]{cl}1&\text{if }j=\mathop{\rm argmax%
}_{j^{\prime}}S_{i,j^{\prime}}\\[1.42271pt]
0&\text{otherwise}\end{array}\right.,
\displaystyle A_{ij}=\left\{\begin{array}[]{cl}1&\text{if }j=\mathop{\rm argmax%
}_{j^{\prime}}S_{i,j^{\prime}}\\[1.42271pt]
0&\text{otherwise}\end{array}\right.,
A_{ij}=1
y_{i}
x_{j}
l=L-1
y_{i}
x_{j}
W_{i,j}^{l}
z_{i}^{l}
h_{j}
y_{i-1}
y_{i}
i
z_{i}^{l}
y_{i-1}
y_{i}
W_{i,j}^{l}
y_{i}
y_{i}
z_{i}^{l}
y_{i}
y_{i-1}
y_{i}
i
y_{i}
l
y_{i}
i+1
y_{i}
\bm{S}
S_{i,j}=W_{i+1,j}^{l}\quad(1\leq i\leq|\mathbf{y}|\mathrm{,}1\leq j\leq|%
\mathbf{x}|).
W_{i+1,j}^{l}
z_{i+1}^{l}
h_{j}
z_{i+1}^{l}
h_{j}
y_{i}
x_{j}
\bm{S}
\bm{A}
z_{i+1}^{l}
y_{i}
z_{i}^{l}
z_{i+1}^{l}
z_{i+1}^{l}
y_{i}
y_{i+1}
z_{i+1}^{l}
l
y_{i}
z_{i+1}^{l}
y_{i}
l_{b}
\langle\mathbf{x},\mathbf{y}\rangle
\bm{\theta}_{\mathbf{x}\rightarrow\mathbf{y}}
\bm{\theta}_{\mathbf{y}\rightarrow\mathbf{x}}
L
L
L\times L
l_{\text{b},\mathbf{x}\rightarrow\mathbf{y}},l_{\text{b},\mathbf{y}\rightarrow%
\mathbf{x}}\\
=\mathop{\rm argmin}_{i,j}{\text{AER}(\bm{A}_{\mathbf{x}\rightarrow\mathbf{y}}%
^{i},\bm{A}_{\mathbf{y}\rightarrow\mathbf{x}}^{j})}.
i
y_{i-1}
y_{i}
S_{i-1}
y_{i-1}
i
y_{i-1}
y_{i}
S_{i-1}
y_{i-1}
i
l_{b}
\mathbf{h}=\{h_{1},...,h_{|\mathbf{x}|}\}
\tilde{z}_{i}^{l_{b}}
l_{b}
S_{i-1}
y_{i-1}
S_{i-1}=\frac{1}{N}\sum_{n}\mathrm{softmax}(\frac{(\mathbf{h}\bm{G}_{n}^{K})(%
\tilde{z}_{i}^{l_{b}}\bm{G}_{n}^{Q})^{\top}}{\sqrt{d_{k}}}),
\bm{G}_{n}^{K}\mathrm{,}\bm{G}_{n}^{Q}\in\mathbb{R}^{d_{\mathrm{model}}\times d%
_{k}}
n
N
d_{k}=d_{\mathrm{model}}/N
\displaystyle\mathcal{L}_{a}=-\frac{1}{|\mathbf{y}|}\sum_{i=1}^{|\mathbf{y}|}%
\sum_{j=1}^{|\mathbf{x}|}\big{(}\hat{A}^{p}_{i,j}\odot\log S_{i,j}),
\displaystyle\mathcal{L}_{a}=-\frac{1}{|\mathbf{y}|}\sum_{i=1}^{|\mathbf{y}|}%
\sum_{j=1}^{|\mathbf{x}|}\big{(}\hat{A}^{p}_{i,j}\odot\log S_{i,j}),
\bm{S}=\{S_{1}\text{;}...\text{;}S_{|\mathbf{y}|}\}
\bm{\hat{A}}^{p}
\bm{\hat{A}}
\bm{\theta}_{\mathbf{x}\rightarrow\mathbf{y}}
\bm{\theta}_{\mathbf{y}\rightarrow\mathbf{x}}
\bm{S}
\bm{A}
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
|\mathbf{x}|+1
m
m=30
8.7
11.1
1.4
4.8
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
<
\rightarrow
\rightarrow
<
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
l_{\text{b}}=3
3
l_{\text{b}}
\rightarrow
\rightarrow
l_{\text{b}}=3
3
l_{\text{b}}
l_{\text{b},\mathbf{x}\rightarrow\mathbf{y}}
l_{\text{b},\mathbf{y}\rightarrow\mathbf{x}}
l_{\text{b},\mathbf{x}\rightarrow\mathbf{y}}
l_{\text{b},\mathbf{y}\rightarrow\mathbf{x}}
z_{i}^{l}
y_{i-1}/y_{i}
z_{i}^{l}
y_{i-1}
y_{i}
z_{i}^{l}
g
y_{i-1}=g(z_{i}^{l})
g
l
\hat{g}_{l}
\hat{y}_{i}^{l}=\hat{g}_{l}(z_{i}^{l})
y_{k}
z_{i}^{l}
y_{i-1}
k=i-1
y_{i}
\rightarrow
\hat{g}_{l}^{\text{naive}}(z_{i}^{l})=z_{i}^{l}
\hat{g}_{l}^{\text{lin}}
\hat{g}_{l}^{\text{mlp}}
\hat{g}_{l}^{\text{lin}}
\hat{g}_{l}^{\text{mlp}}
z_{i}^{l}
y_{i}
y_{i}
z_{i+1}^{l}
z_{i}^{l}
l
z_{i}^{l}
y_{i-1}
y_{i}
\rightarrow
3
4
5
6
4
1
2
6
5
6
5
3
\rightarrow
\rightarrow
