L^{2}
G:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}
{\bm{x}}
{\bm{y}}
{\bm{y}}=G({\bm{x}})+\xi,\quad{\bm{x}}\in\mathbb{R}^{n},{\bm{y}},\xi\in\mathbb%
{R}^{m}
G
\xi
\xi\sim{\mathcal{N}}(0,\Gamma)
{\bm{y}}
m<n
{\bm{x}}
p({\bm{x}}|{\bm{y}})
p({\bm{x}}|{\bm{y}})\propto p({\bm{y}}|{\bm{x}})\cdot p({\bm{x}})
p({\bm{x}})
p({\bm{y}}|{\bm{x}})
G
p({\bm{y}}|{\bm{x}})
\arg\max_{\bm{x}}p({\bm{y}}|{\bm{x}})\cdot p({\bm{x}})
p({\bm{x}})
{\bm{x}}_{0}\sim p_{\mathrm{data}}
{\bm{x}}_{T}\sim{\mathcal{N}}(0,\sigma^{2}(T){\bm{I}})
t
T
{\bm{x}}_{0}\sim p_{\mathrm{data}}
t
T
{\mathrm{d}}{\bm{x}}_{t}=-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}}_{t}}\log p_%
{t}({\bm{x}}_{t}){\mathrm{d}}t.
\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}}_{t})
p({\bm{x}})
\displaystyle{\mathrm{d}}{\bm{x}}_{t}=-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}%
}_{t}}\log p_{t}({\bm{x}}_{t}|{\bm{y}}){\mathrm{d}}t,
\displaystyle{\mathrm{d}}{\bm{x}}_{t}
\displaystyle=-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}%
}_{t}|{\bm{y}}){\mathrm{d}}t,
\displaystyle=-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}%
}_{t}){\mathrm{d}}t-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}}_{t}}\log p_{t}({%
\bm{y}}|{\bm{x}}_{t}){\mathrm{d}}t,
\displaystyle=-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}%
}_{t}){\mathrm{d}}t-\dot{\sigma}(t)\sigma(t)\nabla_{{\bm{x}}_{t}}\log p_{t}({%
\bm{y}}|{\bm{x}}_{t}){\mathrm{d}}t,
\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{x}}_{t})
\nabla_{{\bm{x}}_{t}}\log p_{t}({\bm{y}}|{\bm{x}}_{t})
s_{\theta}({\bm{x}}_{t},t)
{\mathrm{d}}{\bm{x}}_{t}=-\dot{\sigma}(t)\sigma(t)s_{\theta}({\bm{x}}_{t},t){%
\mathrm{d}}t-w_{t}\nabla_{{\bm{x}}_{t}}\log\hat{p}_{t}({\bm{y}}|{\bm{x}}_{t}){%
\mathrm{d}}t,
w_{t}
w_{t}
\dot{\sigma}(t)\sigma(t)
\nabla_{{\bm{x}}_{t}}\log\hat{p}_{t}({\bm{y}}|{\bm{x}}_{t})
\hat{p}_{t}({\bm{y}})
T=t_{0}>t_{1}\dots>t_{N}=0
w_{i}=w_{t_{i}}
{\bm{x}}^{\prime}_{i}={\bm{x}}_{i}-\dot{\sigma}(t_{i})\sigma(t_{i})s_{\theta}%
\left({\bm{x}}_{i},t_{i}\right)(t_{i+1}-t_{i}).
G,{\bm{y}},s_{\theta},\{t_{i}\}_{i=1}^{N},\{w_{i}\}_{i=1}^{N}
{\bm{x}}_{0}\sim{\mathcal{N}}(0,\sigma^{2}(t_{0}){\bm{I}})
i\in\{0,\dots,N-1\}
{\bm{x}}^{\prime}_{i}\leftarrow{\bm{x}}_{i}-\dot{\sigma}(t_{i})\sigma(t_{i})s_%
{\theta}\left({\bm{x}}_{i},t_{i}\right)(t_{i+1}-t_{i})
\log\hat{p}({\bm{y}}|{\bm{x}}_{t})\approx\log p({\bm{y}}|{\bm{x}}_{t})
{\bm{x}}_{i+1}\leftarrow\arg\min_{{\bm{x}}_{i+1}}\frac{\|{\bm{x}}_{i+1}-{\bm{x%
}}^{\prime}_{i}\|^{2}_{2}}{2w_{i}}-\log\hat{p}({\bm{y}}|{\bm{x}}_{i+1})
{\bm{x}}_{N}
p_{t}({\bm{x}}_{t})
p_{t}({\bm{x}}_{t})
\log p({\bm{y}}|{\bm{x}}_{t})
\log\hat{p}({\bm{y}}|{\bm{x}}_{i})\approx\log p({\bm{y}}|{\bm{x}}_{i}).
{\bm{x}}\prime_{i}
{\bm{x}}_{i+1}=\arg\min_{{\bm{x}}_{i+1}}\frac{\|{\bm{x}}_{i+1}-{\bm{x}}^{%
\prime}_{i}\|^{2}_{2}}{2w_{i}}-\log\hat{p}({\bm{y}}|{\bm{x}}_{i+1}),
w_{i}
w_{i}
\log\hat{p}({\bm{y}}|{\bm{x}}_{i+1})
{\bm{x}}_{i}^{\prime}
\log\hat{p}({\bm{y}}|{\bm{x}}_{i+1})=\log\hat{p}({\bm{y}}|{\bm{x}}_{i}^{\prime%
})+\nabla^{\top}\log\hat{p}({\bm{y}}|{\bm{x}}_{i}^{\prime})\left({\bm{x}}_{i+1%
}-{\bm{x}}_{i}^{\prime}\right)+O(\Delta{\bm{x}}_{i}^{2}).
\displaystyle{\bm{x}}_{i+1}\approx\arg\min_{{\bm{x}}_{i+1}}\frac{\|{\bm{x}}_{i%
+1}-{\bm{x}}^{\prime}_{i}\|^{2}_{2}}{2w_{i}}-\log\hat{p}({\bm{y}}|{\bm{x}}_{i}%
^{\prime})-\nabla^{\top}\log\hat{p}({\bm{y}}|{\bm{x}}_{i}^{\prime})\left({\bm{%
x}}_{i+1}-{\bm{x}}_{i}^{\prime}\right)
\displaystyle{\bm{x}}_{i+1}
\displaystyle\approx\arg\min_{{\bm{x}}_{i+1}}\frac{\|{\bm{x}}_{i+1}-{\bm{x}}^{%
\prime}_{i}\|^{2}_{2}}{2w_{i}}-\log\hat{p}({\bm{y}}|{\bm{x}}_{i}^{\prime})-%
\nabla^{\top}\log\hat{p}({\bm{y}}|{\bm{x}}_{i}^{\prime})\left({\bm{x}}_{i+1}-{%
\bm{x}}_{i}^{\prime}\right)
\displaystyle={\bm{x}}_{i}^{\prime}+w_{i}\nabla\log\hat{p}({\bm{y}}|{\bm{x}}_{%
i}^{\prime}),
\displaystyle={\bm{x}}_{i}^{\prime}+w_{i}\nabla\log\hat{p}({\bm{y}}|{\bm{x}}_{%
i}^{\prime}),
G,{\bm{y}},s_{\theta},\mathrm{solver}~{}\phi,\{t_{i}\}_{i=1}^{N},\{w_{i}\}_{i=%
1}^{N},J
{\bm{x}}^{(j)}_{0}\sim{\mathcal{N}}(0,\sigma^{2}(t_{0}){\bm{I}}),j=1,\dots,J
i\in\{0,\dots,N-1\}
{\bm{x}}^{\prime(j)}_{i}\leftarrow{\bm{x}}^{(j)}_{i}-\dot{\sigma}(t_{i})\sigma%
(t_{i})s_{\theta}\left({\bm{x}}^{(j)}_{i},t_{i}\right)(t_{i+1}-t_{i})
\hat{{\bm{x}}}^{(j)}_{N}\leftarrow\phi\left({\bm{x}}^{(j)}_{i},t_{i}\right),j=%
1,\dots,J
g^{(j)}_{i}\leftarrow\frac{1}{J}\sum_{k=1}^{J}\left\langle G(\hat{{\bm{x}}}^{(%
k)}_{N})-\bar{G},{\bm{y}}-G(\hat{{\bm{x}}}^{(j)}_{N})\right\rangle_{\Gamma}%
\left({\bm{x}}^{(j)}_{i}-\bar{{\bm{x}}_{i}}\right)
{\bm{x}}^{(j)}_{i+1}\leftarrow{\bm{x}}^{\prime(j)}_{i}+w_{i}g^{(j)}_{i},j=1,%
\dots,J
\{{\bm{x}}^{(j)}_{N}\}_{j=1}^{J}
p({\bm{y}}|{\bm{x}}_{i})=\int p({\bm{y}}|{\bm{x}}_{N})p({\bm{x}}_{N}|{\bm{x}}_%
{i}){\mathrm{d}}{\bm{x}}_{N}=\mathbb{E}_{{\bm{x}}_{N}\sim p({\bm{x}}_{N}|{\bm{%
x}}_{i})}p({\bm{y}}|{\bm{x}}_{N}),
p({\bm{y}}|{\bm{x}}_{i})=\mathbb{E}_{{\bm{x}}_{N}\sim p({\bm{x}}_{N}|{\bm{x}}_%
{i})}p({\bm{y}}|{\bm{x}}_{N})\approx p({\bm{y}}|\hat{{\bm{x}}}_{N}),
\hat{{\bm{x}}}_{N}
\phi
{\bm{x}}_{i}
\mathbb{E}[{\bm{x}}_{N}|{\bm{x}}_{i}]
p({\bm{y}}|{\bm{x}})
\{{\bm{x}}_{i}^{(j)}\}_{j=1}^{J}
\bar{{\bm{x}}}_{i}
{\bm{C}}_{xx}^{(i)}
i
\bar{{\bm{x}}}_{i}=\frac{1}{J}\sum_{j=1}^{J}{\bm{x}}_{i}^{(j)},{\bm{C}}_{xx}^{%
(i)}=\frac{1}{J}\sum_{j=1}^{J}\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}%
\right)\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)^{\top}.
w_{i}
w_{i}{\bm{C}}_{xx}^{(i)}
\displaystyle{\bm{x}}_{i+1}^{(j)}\approx\arg\min_{{\bm{x}}_{i+1}^{(j)}}\frac{1%
}{2}\left({\bm{x}}_{i+1}-{\bm{x}}^{\prime}_{i}\right)^{\top}\left(w_{i}{\bm{C}%
}_{xx}^{(i)}\right)^{-1}\left({\bm{x}}_{i+1}-{\bm{x}}^{\prime}_{i}\right)
\displaystyle{\bm{x}}_{i+1}^{(j)}\approx\arg\min_{{\bm{x}}_{i+1}^{(j)}}
\displaystyle\frac{1}{2}\left({\bm{x}}_{i+1}-{\bm{x}}^{\prime}_{i}\right)^{%
\top}\left(w_{i}{\bm{C}}_{xx}^{(i)}\right)^{-1}\left({\bm{x}}_{i+1}-{\bm{x}}^{%
\prime}_{i}\right)
\displaystyle-\nabla^{\top}\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{\prime(j)}%
\right)\left({\bm{x}}_{i+1}-{\bm{x}}_{i}^{\prime(j)}\right)
\displaystyle-\nabla^{\top}\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{\prime(j)}%
\right)\left({\bm{x}}_{i+1}-{\bm{x}}_{i}^{\prime(j)}\right)
\displaystyle={\bm{x}}_{i}^{\prime(j)}+w_{i}{\bm{C}}_{xx}^{(i)}\nabla\log\hat{%
p}\left({\bm{y}}|{\bm{x}}_{i}^{\prime(j)}\right),
\displaystyle={\bm{x}}_{i}^{\prime(j)}+
\displaystyle w_{i}{\bm{C}}_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}%
_{i}^{\prime(j)}\right),
{\bm{C}}_{xx}^{(i)}
G\circ\phi
\psi
G\circ\phi
M_{1},M_{2}
{\bm{u}},{\bm{u}}^{\prime},{\bm{v}},{\bm{v}}^{\prime}\in\mathbb{R}^{d}
\|\psi({\bm{u}})-\psi({\bm{u}}^{\prime})\|\leq M_{1}\|{\bm{u}}-{\bm{u}}^{%
\prime}\|,{\bm{v}}^{\top}H_{\psi}({\bm{v}}^{\prime}){\bm{v}}\leq M_{2}\|{\bm{v%
}}\|^{2}.
H_{\psi}
\psi
M_{3}
\|{\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}\|<M_{3},j=1,\dots,J
tr\left(C_{yy}^{(i)}\right)=0
C_{xx}^{(i)}=0
C_{xx}^{(i)}\neq 0\rightarrow tr\left(C_{yy}^{(i)}\right)>M_{4},M_{4}>0,
C_{yy}^{(i)}=\frac{1}{J}\sum_{j=1}^{J}\left(\psi({\bm{x}}_{i}^{(j)})-\bar{\psi%
}_{i}\right)\left(\psi({\bm{x}}_{i}^{(j)})-\bar{\psi}_{i}\right)^{\top},\bar{%
\psi}_{i}=\frac{1}{J}\sum_{j=1}^{J}\psi({\bm{x}}_{i}^{(j)}).
w_{i}=1/\left(tr\left(C_{yy}^{(i)}\right)\right)
{\bm{C}}_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{\prime(j)}%
\right)\approx\frac{1}{J}\sum_{k=1}^{J}\left\langle\psi\left({\bm{x}}^{\prime(%
k)}_{i}\right)-\bar{G},{\bm{y}}-\psi\left({\bm{x}}^{\prime(j)}_{i}\right)%
\right\rangle_{\Gamma}\left({\bm{x}}^{\prime(j)}_{i}-\bar{{\bm{x}}_{i}}\right),
\bar{G}=\frac{1}{J}\sum_{j=1}^{J}G\left(\hat{{\bm{x}}}^{(j)}_{N}\right)=\frac{%
1}{J}\sum_{j=1}^{J}\psi({\bm{x}}_{i}^{\prime(j)}).
\sigma=0.05
\sigma=0.05
\times
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\sigma_{\mathrm{noise}}=0
\sigma_{\mathrm{noise}}=1.0
\sigma_{\mathrm{noise}}=2.0
\times 2
\times 4
61\times 61
\sigma=0.05
64\times 64
\sigma=0.01
64\times 64
256\times 256
{\bm{u}}\in C\left([0,T];H^{r}_{\text{per}}((0,2\pi)^{2};\mathbb{R}^{2})\right)
r>0
{\bm{w}}=\nabla\times{\bm{u}}
{\bm{w}}_{0}\in L^{2}_{\text{per}}\left((0,2\pi)^{2};\mathbb{R}\right)
\nu\in\mathbb{R}_{+}
f\in L^{2}_{\text{per}}\left((0,2\pi)^{2};\mathbb{R}\right)
{\mathcal{G}}
T
{\mathcal{G}}:{\bm{w}}_{0}\rightarrow{\bm{w}}_{T}
\displaystyle\begin{split}\partial_{t}{\bm{w}}({\bm{x}},t)+{\bm{u}}({\bm{x}},t%
)\cdot\nabla{\bm{w}}({\bm{x}},t)&=\nu\Delta{\bm{w}}({\bm{x}},t)+f({\bm{x}}),%
\qquad{\bm{x}}\in(0,2\pi)^{2},t\in(0,T]\\
\nabla\cdot{\bm{u}}({\bm{x}},t)&=0,\qquad\qquad\qquad\qquad\quad\,{\bm{x}}\in(%
0,2\pi)^{2},t\in[0,T]\\
{\bm{w}}({\bm{x}},0)&={\bm{w}}_{0}({\bm{x}}),\qquad\qquad\qquad\quad{\bm{x}}%
\in(0,2\pi)^{2}\end{split}
\displaystyle\begin{split}\partial_{t}{\bm{w}}({\bm{x}},t)+{\bm{u}}({\bm{x}},t%
)\cdot\nabla{\bm{w}}({\bm{x}},t)&=\nu\Delta{\bm{w}}({\bm{x}},t)+f({\bm{x}}),%
\qquad{\bm{x}}\in(0,2\pi)^{2},t\in(0,T]\\
\nabla\cdot{\bm{u}}({\bm{x}},t)&=0,\qquad\qquad\qquad\qquad\quad\,{\bm{x}}\in(%
0,2\pi)^{2},t\in[0,T]\\
{\bm{w}}({\bm{x}},0)&={\bm{w}}_{0}({\bm{x}}),\qquad\qquad\qquad\quad{\bm{x}}%
\in(0,2\pi)^{2}\end{split}
T=1
T=5
L^{2}
\frac{\left\|\hat{{\bm{w}}}_{0}-{\bm{w}}^{*}_{0}\right\|_{L^{2}}}{\left\|{\bm{%
w}}^{*}_{0}\right\|_{L^{2}}}
\hat{{\bm{w}}}_{0}
{\bm{w}}^{*}_{0}
L^{2}
V_{a,b}^{t}
(a,b)
t
{\bm{y}}^{\mathrm{cph}}_{t,(a,b,c)}
{\bm{y}}^{\mathrm{camp}}_{t,(a,b,c,d)}
\ell({\bm{y}}|{\bm{x}})=\sum_{t}\frac{\|\mathcal{A}^{\mathrm{cph}}_{t}({\bm{x}%
})-{\bm{y}}^{\mathrm{cph}}_{t}\|_{2}^{2}}{2\beta^{2}_{\mathrm{cph}}}+\sum_{t}%
\frac{\|\mathcal{A}_{t}^{\mathrm{camp}}({\bm{x}})-{\bm{y}}_{t}^{\mathrm{camp}}%
\|_{2}^{2}}{2\beta^{2}_{\mathrm{camp}}}+\rho\frac{\|\sum{\bm{x}}_{i}-{\bm{y}}^%
{\mathrm{flux}}\|_{2}^{2}}{2},
\mathcal{A}_{t}^{\mathrm{cph}}
\mathcal{A}_{t}^{\mathrm{camp}}
{\bm{x}}
\beta_{\mathrm{cph}}
\beta_{\mathrm{camp}}
\times
\chi_{\mathrm{cph}}^{2}
\chi_{\mathrm{camp}}^{2}
\uparrow
\uparrow
\chi^{2}_{\mathrm{cph}}
\downarrow
\chi^{2}_{\mathrm{camp}}
\downarrow
L^{2}
G
\phi
\psi
G
\phi
{\bm{D}}f
f
L^{r}_{\text{per}}
r
H^{r}_{\text{per}}
r
\hat{\nabla}f
f
\mu
Q
w_{i}
i
N
E_{\mu,Q}(f({\bm{x}}))
f({\bm{x}})
\mu
Q
w_{i}=1/\left(tr\left(C_{yy}^{(i)}\right)\right)
tr\left(C_{xx}^{(i+1)}\right)\leq tr\left((C_{xx}^{(i)}\right)-\frac{1}{M_{3}}%
tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right),
C_{xy}^{(i)}=\frac{1}{J}\sum_{j=1}^{J}\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_%
{i}\right)\left(\psi({\bm{x}}_{i}^{(j)})-\bar{\psi}_{i}\right)^{\top}.
tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right)
tr\left(C_{xx}^{(i)}\right)=0
tr\left(C_{xx}^{(i)}\right)
i
i
{\bm{x}}_{i+1}^{(j)}={\bm{x}}_{i}^{(j)}+w_{i}C_{xy}^{(i)}\left(y-\psi({\bm{x}}%
_{i}^{(j)})\right),
j\in\{1,\dots,J\}
C_{xx}^{(i+1)}=\frac{1}{J}\sum_{j=1}^{J}({\bm{x}}_{i+1}^{(j)}-\bar{{\bm{x}}}_{%
i+1})({\bm{x}}_{i+1}^{(j)}-\bar{{\bm{x}}}_{i+1})^{\top}.
\displaystyle C_{xx}^{(i+1)}=\frac{1}{J}\sum_{j}\left[({\bm{x}}_{i}^{(j)}-\bar%
{{\bm{x}}}_{i})+w_{i}C_{xy}^{(i)}\left(\bar{\psi}_{i}-\psi({\bm{x}}_{i}^{(j)})%
\right)\right]\left[({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i})+w_{i}C_{xy}^{(i)}(%
\bar{\psi}_{i}-\psi({\bm{x}}_{i}^{(j)}))\right]^{\top}
\displaystyle C_{xx}^{(i+1)}
\displaystyle=\frac{1}{J}\sum_{j}\left[({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i})%
+w_{i}C_{xy}^{(i)}\left(\bar{\psi}_{i}-\psi({\bm{x}}_{i}^{(j)})\right)\right]%
\left[({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i})+w_{i}C_{xy}^{(i)}(\bar{\psi}_{i}%
-\psi({\bm{x}}_{i}^{(j)}))\right]^{\top}
\displaystyle=C_{xx}^{(i)}-2w_{i}C_{xy}^{(i)}C_{xy}^{(i)\top}+w_{i}^{2}C_{xy}^%
{(i)}C_{yy}^{(i)}C_{xy}^{(i)\top}.
\displaystyle=C_{xx}^{(i)}-2w_{i}C_{xy}^{(i)}C_{xy}^{(i)\top}+w_{i}^{2}C_{xy}^%
{(i)}C_{yy}^{(i)}C_{xy}^{(i)\top}.
tr\left(C_{xx}^{(i+1)}\right)=tr\left(C_{xx}^{(i)}\right)-2w_{i}tr\left(C_{xy}%
^{(i)}C_{xy}^{(i)\top}\right)+w_{i}^{2}tr\left(C_{xy}^{(i)}C_{yy}^{(i)}C_{xy}^%
{(i)\top}\right).
w_{i}^{2}tr\left(C_{xy}^{(i)}C_{yy}^{(i)}C_{xy}^{(i)\top}\right)=w_{i}^{2}tr%
\left(C_{yy}^{(i)}C_{xy}^{(i)\top}C_{xy}^{(i)}\right)\leq w_{i}^{2}tr\left(C_{%
yy}^{(i)}\right)tr\left(C_{xy}^{(i)\top}C_{xy}^{(i)}\right).
w_{i}=1/\left(tr\left(C_{yy}^{(i)}\right)\right)
\displaystyle tr\left(C_{xx}^{(i+1)}\right)\leq tr\left(C_{xx}^{(i)}\right)-%
\frac{2}{tr\left(C_{yy}^{(i)}\right)}tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}%
\right)+\frac{1}{tr\left(C_{yy}^{(i)}\right)}tr\left(C_{xy}^{(i)\top}C_{xy}^{(%
i)}\right)
\displaystyle tr\left(C_{xx}^{(i+1)}\right)
\displaystyle\leq tr\left(C_{xx}^{(i)}\right)-\frac{2}{tr\left(C_{yy}^{(i)}%
\right)}tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right)+\frac{1}{tr\left(C_{yy}^{(%
i)}\right)}tr\left(C_{xy}^{(i)\top}C_{xy}^{(i)}\right)
\displaystyle=tr\left(C_{xx}^{(i)}\right)-\frac{1}{tr\left(C_{yy}^{(i)}\right)%
}tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right).
\displaystyle=tr\left(C_{xx}^{(i)}\right)-\frac{1}{tr\left(C_{yy}^{(i)}\right)%
}tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right).
M_{4}>0
tr\left(C_{yy}^{(i)}\right)\leq M_{4}
tr\left(C_{xx}^{(i+1)}\right)\leq tr\left(C_{xx}^{(i)}\right)-\frac{1}{tr\left%
(C_{yy}^{(i)}\right)}tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right)\leq tr\left(C%
_{xx}^{(i)}\right)-\frac{1}{M_{4}}tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right).
tr\left(C_{xy}^{(i)}C_{xy}^{(i)\top}\right)
tr\left(C_{xx}^{(i)}\right)=0
tr\left(C_{xx}^{(i)}\right)
w_{i}<1/\left(tr\left(C_{yy}^{(i)}\right)\right)
C_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{\prime(j)}\right)%
\approx\frac{1}{J}\sum_{k=1}^{J}\left\langle G(\hat{{\bm{x}}}^{\prime(k)}_{N})%
-\bar{G},{\bm{y}}-G(\hat{{\bm{x}}}^{(j)}_{N})\right\rangle_{\Gamma}\left({\bm{%
x}}^{(j)}_{i}-\bar{{\bm{x}}_{i}}\right),
\bar{G}=\frac{1}{J}\sum_{j=1}^{J}G(\hat{{\bm{x}}}^{(j)}_{N})
\Gamma
\Gamma=\mathbf{I}
{\bm{x}}_{i}^{\prime(j)}
\displaystyle~{}C_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{%
\prime(j)}\right)
\displaystyle~{}C_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{%
\prime(j)}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(k)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{x}}_{i}^{\prime(k)}-\bar{{\bm{x}}}_{i}\right)^{%
\top}\nabla\frac{1}{2}\left\|\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}%
}\right\|^{2}
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(k)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{x}}_{i}^{\prime(k)}-\bar{{\bm{x}}}_{i}\right)^{%
\top}\nabla\frac{1}{2}\left\|\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}%
}\right\|^{2}
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(k)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{x}}_{i}^{\prime(k)}-\bar{{\bm{x}}}_{i}\right)^{%
\top}{\bm{D}}^{\top}\psi\left({\bm{x}}_{i}^{\prime(j)}\right)\left(\psi\left({%
\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(k)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{x}}_{i}^{\prime(k)}-\bar{{\bm{x}}}_{i}\right)^{%
\top}{\bm{D}}^{\top}\psi\left({\bm{x}}_{i}^{\prime(j)}\right)\left(\psi\left({%
\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(k)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{D}}\psi\left({\bm{x}}_{i}^{\prime(j)}\right){\bm%
{x}}_{i}^{\prime(k)}-{\bm{D}}\psi\left({\bm{x}}_{i}^{\prime(j)}\right)\bar{{%
\bm{x}}}_{i}\right)^{\top}\left(\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm%
{y}}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(k)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{D}}\psi\left({\bm{x}}_{i}^{\prime(j)}\right){\bm%
{x}}_{i}^{\prime(k)}-{\bm{D}}\psi\left({\bm{x}}_{i}^{\prime(j)}\right)\bar{{%
\bm{x}}}_{i}\right)^{\top}\left(\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm%
{y}}\right)
\displaystyle=-\frac{1}{J^{2}}\sum_{k=1}^{J}\sum_{l=1}^{J}\left({\bm{x}}_{i}^{%
\prime(j)}-\bar{{\bm{x}}}_{i}\right)\left({\bm{D}}\psi\left({\bm{x}}_{i}^{%
\prime(j)}\right)\left({\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{(l)}\right)%
\right)^{\top}\left(\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right).
\displaystyle=-\frac{1}{J^{2}}\sum_{k=1}^{J}\sum_{l=1}^{J}\left({\bm{x}}_{i}^{%
\prime(j)}-\bar{{\bm{x}}}_{i}\right)\left({\bm{D}}\psi\left({\bm{x}}_{i}^{%
\prime(j)}\right)\left({\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{(l)}\right)%
\right)^{\top}\left(\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right).
\displaystyle tr\left(C_{xx}^{(i)}\right)=tr\left(\frac{1}{J}\sum_{j=1}^{J}%
\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)\left({\bm{x}}_{i}^{(j)}-%
\bar{{\bm{x}}}_{i}\right)^{\top}\right)
\displaystyle tr\left(C_{xx}^{(i)}\right)
\displaystyle=tr\left(\frac{1}{J}\sum_{j=1}^{J}\left({\bm{x}}_{i}^{(j)}-\bar{{%
\bm{x}}}_{i}\right)\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)^{\top}\right)
\displaystyle=\frac{1}{J}\sum_{j=1}^{J}tr\left(\left({\bm{x}}_{i}^{(j)}-\bar{{%
\bm{x}}}_{i}\right)^{\top}\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)\right)
\displaystyle=\frac{1}{J}\sum_{j=1}^{J}tr\left(\left({\bm{x}}_{i}^{(j)}-\bar{{%
\bm{x}}}_{i}\right)^{\top}\left({\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)\right)
\displaystyle=\frac{1}{J}\sum_{j=1}^{J}\|{\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}%
\|_{2}^{2},
\displaystyle=\frac{1}{J}\sum_{j=1}^{J}\|{\bm{x}}_{i}^{(j)}-\bar{{\bm{x}}}_{i}%
\|_{2}^{2},
tr\left(C_{xx}^{(i)}\right)
h
{\bm{x}}_{i}^{\prime(j)}
\displaystyle\psi\left({\bm{x}}_{i}^{\prime(k)}\right)=\psi\left({\bm{x}}_{i}^%
{\prime(j)}+{\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{\prime(j)}\right)
\displaystyle\psi\left({\bm{x}}_{i}^{\prime(k)}\right)
\displaystyle=\psi\left({\bm{x}}_{i}^{\prime(j)}+{\bm{x}}_{i}^{\prime(k)}-{\bm%
{x}}_{i}^{\prime(j)}\right)
\displaystyle=\psi\left({\bm{x}}_{i}^{\prime(j)}\right)+{\bm{D}}\psi\left({\bm%
{x}}_{i}^{\prime(j)}\right)\left({\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{\prime%
(j)}\right)+o\left(\|{\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{\prime(j)}\|_{2}^{%
2}\right),
\displaystyle=\psi\left({\bm{x}}_{i}^{\prime(j)}\right)+{\bm{D}}\psi\left({\bm%
{x}}_{i}^{\prime(j)}\right)\left({\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{\prime%
(j)}\right)+o\left(\|{\bm{x}}_{i}^{\prime(k)}-{\bm{x}}_{i}^{\prime(j)}\|_{2}^{%
2}\right),
k\in\{1,\dots,J\}
k,l\in\{1,\dots,J\}
\psi\left({\bm{x}}_{i}^{\prime(k)}\right)-\psi\left({\bm{x}}_{i}^{\prime(l)}%
\right)={\bm{D}}\psi\left({\bm{x}}_{i}^{\prime(j)}\right)\left({\bm{x}}_{i}^{%
\prime(k)}-{\bm{x}}_{i}^{\prime(l)}\right)
\displaystyle~{}C_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{%
\prime(j)}\right)
\displaystyle~{}C_{xx}^{(i)}\nabla\log\hat{p}\left({\bm{y}}|{\bm{x}}_{i}^{%
\prime(j)}\right)
\displaystyle\approx-\frac{1}{J^{2}}\sum_{k=1}^{J}\sum_{l=1}^{J}\left({\bm{x}}%
_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)\left(\psi\left({\bm{x}}_{i}^{\prime(k)}%
\right)-\psi\left({\bm{x}}_{i}^{(l)}\right)\right)^{\top}\left(\psi\left({\bm{%
x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right)
\displaystyle\approx-\frac{1}{J^{2}}\sum_{k=1}^{J}\sum_{l=1}^{J}\left({\bm{x}}%
_{i}^{(j)}-\bar{{\bm{x}}}_{i}\right)\left(\psi\left({\bm{x}}_{i}^{\prime(k)}%
\right)-\psi\left({\bm{x}}_{i}^{(l)}\right)\right)^{\top}\left(\psi\left({\bm{%
x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(j)}-\bar{{%
\bm{x}}}_{i}\right)\left(\psi\left({\bm{x}}_{i}^{\prime(k)}\right)-\bar{\psi}_%
{i}\right)^{\top}\left(\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left({\bm{x}}_{i}^{\prime(j)}-\bar{{%
\bm{x}}}_{i}\right)\left(\psi\left({\bm{x}}_{i}^{\prime(k)}\right)-\bar{\psi}_%
{i}\right)^{\top}\left(\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{\bm{y}}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left\langle\psi\left({\bm{x}}_{i}^{%
\prime(k)}\right)-\bar{\psi}_{i},\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{%
\bm{y}}\right\rangle\left({\bm{x}}_{i}^{\prime(j)}-\bar{{\bm{x}}}_{i}\right)
\displaystyle=-\frac{1}{J}\sum_{k=1}^{J}\left\langle\psi\left({\bm{x}}_{i}^{%
\prime(k)}\right)-\bar{\psi}_{i},\psi\left({\bm{x}}_{i}^{\prime(j)}\right)-{%
\bm{y}}\right\rangle\left({\bm{x}}_{i}^{\prime(j)}-\bar{{\bm{x}}}_{i}\right)
\displaystyle=\frac{1}{J}\sum_{k=1}^{J}\left\langle G(\hat{{\bm{x}}}^{\prime(k%
)}_{N})-\bar{G},{\bm{y}}-G(\hat{{\bm{x}}}^{(j)}_{N})\right\rangle\left({\bm{x}%
}^{(j)}_{i}-\bar{{\bm{x}}_{i}}\right),
\displaystyle=\frac{1}{J}\sum_{k=1}^{J}\left\langle G(\hat{{\bm{x}}}^{\prime(k%
)}_{N})-\bar{G},{\bm{y}}-G(\hat{{\bm{x}}}^{(j)}_{N})\right\rangle\left({\bm{x}%
}^{(j)}_{i}-\bar{{\bm{x}}_{i}}\right),
\hat{\nabla}f({\bm{x}})=\sum_{i}^{Q}\frac{f({\bm{x}}+\mu{\bm{u}}_{i})-f({\bm{x%
}})}{\mu}\tilde{{\bm{u}}}_{i}
\hat{\nabla}f({\bm{x}})=\sum_{i}^{Q}\frac{f({\bm{x}}+\mu{\bm{u}}_{i})-f({\bm{x%
}}-\mu{\bm{u}}_{i})}{2\mu}\tilde{{\bm{u}}}_{i}
{\bm{u}}_{i}
\tilde{{\bm{u}}}_{i}=\frac{1}{Q}{\bm{u}}_{i}
\mu
Q
\nabla_{{\bm{x}}_{t}}p({\bm{x}}_{t})
\nabla_{{\bm{x}}_{t}}p({\bm{y}}\mid{\bm{x}}_{t})
{\bm{x}}_{t}
{\bm{x}}_{0}
\hat{\nabla}_{\hat{{\bm{x}}}_{0}}p({\bm{y}}\mid\hat{{\bm{x}}}_{0})
\hat{\nabla}_{{\bm{x}}_{t}}p({\bm{y}}\mid{\bm{x}}_{t})
\hat{\nabla}_{{\bm{x}}_{t}}\log{p({\bm{y}}\mid{\bm{x}}_{t})}=\hat{\nabla}_{{%
\bm{x}}_{t}}\log p({\bm{y}}\mid\hat{{\bm{x}}}_{0})={\bm{D}}_{{\bm{x}}_{t}}^{%
\top}\hat{{\bm{x}}}_{0}\hat{\nabla}_{\hat{{\bm{x}}}_{0}}\log{p({\bm{y}}\mid%
\hat{{\bm{x}}}_{0})}
{\bm{D}}_{{\bm{x}}_{t}}^{\top}
\hat{{\bm{x}}}_{0}
{\bm{x}}_{t}
\sigma(t)=t
s(t)=1
G,{\bm{y}},D_{\theta},\{t_{i}\}_{i=1}^{N},\{w_{i}\}_{i=1}^{N},E_{\mu,Q}
{\bm{x}}_{0}\sim{\mathcal{N}}(0,t_{0}^{2}{\bm{I}})
i\in\{0,\dots,N-1\}
\hat{{\bm{x}}}_{0}\leftarrow D_{\theta}\left({\bm{x}}_{i},t_{i}\right)
{\bm{x}}^{\prime}_{i}\leftarrow{\bm{x}}_{i}+\frac{{\bm{x}}_{i}-\hat{{\bm{x}}}_%
{0}}{t_{i}}(t_{i+1}-t_{i})
\hat{\nabla}_{{\bm{x}}_{i}}\log p({\bm{y}}|{\bm{x}}_{i})\leftarrow\nabla_{{\bm%
{x}}_{i}}(\hat{{\bm{x}}}_{0}^{\top}E_{\mu,Q}(\log p({\bm{y}}\mid\hat{{\bm{x}}}%
_{0})))
{\bm{x}}_{i+1}\leftarrow{\bm{x}}^{\prime}_{i}+w_{i}\hat{\nabla}_{{\bm{x}}_{t}}%
\log p({\bm{y}}|{\bm{x}}_{i})
{\bm{x}}_{N}
w_{i}
w_{i}^{-1}=\frac{1}{J^{2}}\sqrt{\sum_{k=1}^{J}\left\|G(\hat{{\bm{x}}}^{\prime(%
k)}_{N})-\bar{G}\right\|^{2}\left\|{\bm{y}}-G(\hat{{\bm{x}}}^{(j)}_{N})\right%
\|^{2}}
\sigma=0.05
\sigma=0.05
\times
\sigma=0.01
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
64\times 64
64\times 64
\times
\sigma=0.01
\mu
Q
w_{i}
N
\mu
Q
w_{i}
N
256\times 256
256\times 256
\times
\sigma=0.05
\mu
Q
w_{i}
N
\mu
Q
w_{i}
N
\displaystyle{\bm{y}}_{t,(a,b,c)}^{\text{cph}}=\angle(V_{a,b}^{t}V_{b,c}^{t}V_%
{a,c}^{t}):=\mathcal{A}_{t,(a,b,c)}^{\text{cph}}(\mathbf{x})
\displaystyle{\bm{y}}_{t,(a,b,c)}^{\text{cph}}=\angle(V_{a,b}^{t}V_{b,c}^{t}V_%
{a,c}^{t}):=\mathcal{A}_{t,(a,b,c)}^{\text{cph}}(\mathbf{x})
\displaystyle{\bm{y}}_{t,(a,b,c,d)}^{\text{camp}}=\log\left(\frac{|V_{a,b}^{t}%
||V_{c,d}^{t}|}{|V_{a,c}^{t}||V_{b,d}^{t}|}\right):=\mathcal{A}_{t,(a,b,c,d)}^%
{\text{camp}}({\bm{x}})
\displaystyle{\bm{y}}_{t,(a,b,c,d)}^{\text{camp}}=\log\left(\frac{|V_{a,b}^{t}%
||V_{c,d}^{t}|}{|V_{a,c}^{t}||V_{b,d}^{t}|}\right):=\mathcal{A}_{t,(a,b,c,d)}^%
{\text{camp}}({\bm{x}})
V_{a,b}
V_{a,b}^{t}({\bm{x}})=g_{a}^{t}g_{b}^{t}\exp(-i(\phi_{a}^{t}-\phi_{b}^{t}))%
\cdot\tilde{\bm{I}}^{t}_{a,b}({\bm{x}})+\eta_{a,b}.
g_{a},g_{b}
\phi_{a}^{t},\phi_{b}^{t}
\eta_{a,b}
(M-1)(M-2)/2
{\bm{y}}^{\text{cph}}
M(M-3)/2
{\bm{y}}^{\text{camp}}
M
M=9
