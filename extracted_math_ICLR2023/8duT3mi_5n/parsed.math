\Pr_{\text{train}}(X,Y)=\Pr_{\text{test}}(X,Y)
\Pr(Y|X)
3\%
>
\Pr_{\text{train}}(Y|X)\neq\Pr_{\text{test}}(Y|X)
\|
\|
\Pr(X^{t},Y^{t})
\Pr_{\Phi}(C^{s}|X^{s})
\Pr_{\text{train}}(Y^{s}|X^{s})
\Pr(x_{i}^{t},y_{i}^{t})
\Pr(y_{i}^{t}|x_{i}^{t})
\mathcal{H}
\mathcal{G}=\{V,A,X\}
V
X\in\mathbb{R}^{|V|\times|F|}
A,A\in\mathbb{R}^{|V|\times|V|}
X
A
h_{v}^{k}
v
k
i
k-1
z
h_{i}^{k}=\textsc{Aggregate}\circ\textsc{Transform}^{(k)}\left(\{h_{j}^{k-1},j%
\in\mathcal{N}_{i}\}\right),
h_{i}^{k}\in\mathbb{R}^{d}
\mathcal{N}_{i}
i
h^{0}=X
\mathcal{G}
\mathcal{D}^{s}=\{(x_{1},y_{1}),(x_{2},y_{2}),...(x_{n},y_{n})\}
N
\mathcal{L}=\frac{1}{|\mathcal{D}^{s}|}\sum\limits_{i=1}^{n}\sum\limits_{j=1}^%
{N}y_{ij}\log\hat{y}_{ij},\hat{y}_{ij}=\textbf{softmax}(f(h_{i}^{k}))
\Pr_{\text{train}}(H,Y)\neq\Pr_{\text{test}}(H,Y)
H
\Pr(H,Y)
|y_{\text{train}}|<|y_{\text{test}}|
\Pr_{\text{train}}(H,Y)\neq\Pr_{\text{test}}(H,Y)
\mathbf{P}_{\theta}
\mathcal{Q}_{\Phi}
\mathbf{P}_{\theta}
\mathcal{L}_{\theta,S}
(x_{i}^{s},y_{i}^{s})
\mathcal{L}_{\theta,T}
(x_{i}^{t},y_{i}^{t})
\begin{array}[]{l}\mathcal{L}_{\theta,S}=\sum\limits_{i=1}^{|D^{s}|}-\log%
\mathbf{P}_{\theta}(y_{i}^{s}|x_{i}^{s},\text{A}^{s})\\
\mathcal{L}_{\theta,\Phi,T}=\mathbb{E}_{(x_{j}^{t},y_{j}^{t})\sim\mathcal{Q}_{%
\Phi}(\cdot|\mathbf{X}^{t},\text{A}^{t})}\left[-\log\mathbf{P}_{\theta}(y_{j}^%
{t}|x_{j}^{t},\text{A}^{t})\right]\end{array}
(x_{j}^{t},y_{j}^{t})\sim\mathcal{Q}_{\Phi}
\{x_{j}^{t}\}_{j=1}^{|\mathcal{D}^{s}|}
\{y_{j}^{t}\}_{j=1}^{|\mathcal{D}^{s}|}
\mathcal{Q}_{\Phi}(y_{j}|x_{j}^{t},\text{A}^{t})
\{1..C\}
\{1..N\}
\mathbf{P}_{\theta}
\{x_{j}^{t},y_{j}^{t}\}
C>N
\mathbf{P}_{\theta}
N
N+1
y_{j}^{t}\in C\setminus N
N+1
\{x_{i}^{t},y_{i}^{t}\}\sim\mathbb{P}^{t}
\mathbb{P}^{t}
\mathbb{P}^{t}(y_{i}^{t}|x_{i}^{t})
x_{i}^{t}
\mathbb{P}^{t}(y_{i}^{t}|x_{i}^{t})
k
c_{k}
\mathcal{Q}_{\Phi}(c_{k}|\mathbf{X},\mathbf{A})\sim\text{Categorical}(\Phi)
\mathcal{Q}_{\Phi}
\mathcal{Q}_{\Phi}(c_{k}|\mathbf{X},\mathbf{A})=\text{softmax}(W^{T}h_{\Phi,k}%
),h_{\Phi,i}=\text{GNN}_{\Phi}(x_{k},\mathcal{N}_{k})
c\sim\mathcal{Q}_{\Phi}
\mathcal{C}\in\{0,1\}^{|V|\times C}
\mathcal{S}
\mathcal{S}=\frac{1}{2|E|}\sum_{ij}\left[A_{ij}-\frac{d_{i}d_{j}}{2|E|}\right]%
\delta(c_{i},c_{j})
c_{i}
c_{j}
i
j
d_{i}\in\mathbb{R}^{|V|}
\mathcal{C}
\text{GNN}_{\Phi}
\mathcal{Q}_{\Phi}(y_{i}|\mathbf{X},\mathbf{A})
\mathcal{L}_{\Phi,T}=\frac{1}{2|E|}\text{Tr}\left(\mathcal{Q}_{\Phi}^{%
\intercal}d^{\intercal}d\mathcal{Q}_{\Phi}-\mathcal{Q}_{\Phi}^{\intercal}A^{t}%
\mathcal{Q}_{\Phi}\right)
\mathcal{Q}_{\Phi}^{t}(c_{j}|x_{j})
\mathbb{P}^{t}(y_{i}^{t}|x_{i}^{t})
\mathcal{Q}_{\Phi}^{s}(c_{j}|x_{j})\approx\mathbb{P}^{s}(y_{i}^{s}|x_{i}^{s})%
\rightarrow\mathcal{Q}_{\Phi}^{t}(c_{j}|x_{j})\approx\mathbb{P}^{t}(y_{i}^{t}|%
x_{i}^{t})
C
Y
N
K\geq N
\{c_{k=1}^{K}\}
\{y_{n=1}^{N}\}
c_{k}
y_{n}
\mathcal{M}\in\{0,1\}^{K\times N}
\begin{array}[]{l}\min\sum\limits_{k}\sum\limits_{n}T_{k,n}\mathcal{M}_{k,n},%
\\
T_{k,n}=\text{KL}\left(\mathbf{P}_{\theta}(y_{n}|X,A)||\mathcal{Q}_{\Phi}(c_{k%
}|X,A)\right),\\
\text{subject to}\ \forall\sum\limits_{k}\mathcal{M}_{k,n}\leq 1,\sum\limits_{%
n}\mathcal{M}_{k,n}\leq 1.\end{array}
C_{L}\rightarrow Y,C_{L}\subseteq C,|C_{L}|=N
\mathcal{Q}_{\Phi}^{s}(c_{j}|x_{j})\approx\mathbb{P}^{s}(y_{i}^{s}|x_{i}^{s})
\mathcal{L}_{\Phi,\theta,S}=\sum\limits_{i=1}^{B}\text{KL}\left(\mathbb{P}^{s}%
(\mathbf{y}|x_{i}^{s},A^{s})||\mathcal{Q}_{\Phi}(\mathbf{y}|x_{i}^{s},A^{s})\right)
B
\mathbb{P}^{s}(y_{i}^{s}|x_{i}^{s},A^{s})
\mathbf{P}_{\theta}(\mathbf{y}|x_{i}^{s},A^{s})
\mathcal{L}_{\theta}=\mathcal{L}_{\theta,S}+\mathcal{L}_{\theta,\Phi,T}+\alpha%
\mathcal{L}_{\theta,\Phi,S}
(x_{i}^{s},y_{i}^{s})
\alpha=1
\alpha=0
\mathcal{L}_{\theta,\Phi,T}
\mathcal{L}_{\Phi}=\mathcal{L}_{\Phi,T}+\mathcal{L}_{\Phi,\theta,S}
\mathcal{L}_{\theta,S}
\mathcal{L}_{\Phi,T}
\mathcal{L}_{\theta}
\mathcal{L}_{\Phi}
\mathcal{L}_{\theta,\Phi,T}
\mathcal{D}^{s}
\mathcal{L}_{\Phi,\theta,S}
\text{GNN}_{\Phi}
T
B
\mathbf{G}=(\mathbf{X}^{s},\text{A}^{s})
\begin{array}[]{l}\log\mathbf{P}_{\theta}(\mathbf{y}|\mathbf{X}^{s},\text{A}^{%
s})\geq\\
\mathbb{E}_{\mathcal{Q}_{\Phi}(\mathbf{y}|\mathbf{X}^{s},\text{A}^{s})}\left[%
\log\mathbf{P}_{\theta}(\mathbf{y}|\mathbf{X}^{s},\text{A}^{s})-\log\mathcal{Q%
}_{\Phi}(\mathbf{y}|\mathbf{X}^{s},\text{A}^{s})\right]\end{array}
\mathcal{Q}_{\Phi}^{(t+1)}
\begin{array}[]{l}\log\mathcal{Q}_{\Phi}^{(t+1)}(\mathbf{y}|\mathbf{G})=%
\mathbb{E}_{\mathcal{Q}_{\Phi}^{(t)}(\mathbf{y}|\mathbf{G})}\left[\log\mathbf{%
P}_{\theta}^{(t)}(\mathbf{y}|\mathbf{G})\right]+\text{const}\end{array}
\mathcal{Q}_{\Phi}^{(t+1)}(\mathbf{y}|\mathbf{G})=\operatorname*{argmin}\text{%
KL}(\mathbf{P}_{\theta}^{(t)}(\mathbf{y}|\mathbf{G})||Q_{\Phi}^{(t)}(\mathbf{y%
}|\mathbf{G}))
B
\mathbf{P}_{\theta}^{(t+1)}
\mathcal{Q}_{\Phi}^{(t+1)}(\mathbf{y}|\mathbf{G})
(x_{j}^{s},y_{j}^{s})\sim\mathcal{Q}_{\Phi}
\theta
\mathcal{L}_{\theta,\Phi,T}
\mathcal{L}_{\theta,\Phi,S}
\mathcal{Q}_{\Phi}
\mathcal{O}(\Phi)
\Phi
\mathcal{T}
|V^{t}|
\mathcal{O}(|V^{t}|\cdot(\Phi+\mathcal{T}))
\mathcal{O}(2\cdot\mathcal{E}\cdot B\cdot\Phi)
\mathcal{E}
\text{GNN}_{\theta}
\mathcal{L}_{\theta,S}
\text{GNN}_{\Phi}
\mathcal{L}_{\Phi,T}
\text{GNN}_{\Phi}
T
B
(x_{i}^{s},y_{i}^{s})
\Phi\xleftarrow{-}\nabla_{\Phi}\mathcal{L}_{\Phi,S}+\nabla_{\Phi}\mathcal{L}_{%
\Phi,\theta,T}
\text{GNN}_{\theta}
|\mathcal{D}^{s}|
(x_{j}^{t},y_{j}^{t})
\mathcal{L}_{\theta}
\theta\xleftarrow{-}\nabla_{\theta}\mathcal{L}_{\theta,S}+\nabla_{\theta}%
\mathcal{L}_{\theta,\Phi,T}+\nabla_{\theta}\alpha\mathcal{L}_{\theta,\Phi,S}
\uparrow
\uparrow
\Delta
\downarrow
\uparrow
\uparrow
\Delta
\downarrow
\uparrow
\uparrow
\Delta
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Phi
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Phi
\theta
\Phi
\{(x^{t},y^{t})\}
\mathcal{D}^{t}
\hat{y}
\displaystyle\text{Micro-F1}=\frac{|x\in D^{t}\wedge\hat{y}=y^{t}|}{|(x,y)\in D%
^{t}|}
\displaystyle\text{Micro-F1}=\frac{|x\in D^{t}\wedge\hat{y}=y^{t}|}{|(x,y)\in D%
^{t}|}
\displaystyle\text{Macro-F1}=\frac{1}{N_{\text{test}}}\sum\limits_{i=1}^{N_{%
\text{test}}}\frac{|x\in D^{t}\wedge\hat{y}=y^{t}|}{|x\in D^{t}\wedge y^{t}=i|}
\displaystyle\text{Macro-F1}=\frac{1}{N_{\text{test}}}\sum\limits_{i=1}^{N_{%
\text{test}}}\frac{|x\in D^{t}\wedge\hat{y}=y^{t}|}{|x\in D^{t}\wedge y^{t}=i|}
\mathcal{D}^{t}
N_{\text{test}}=N_{\text{train}}+1)
\text{GNN}_{\Phi}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Phi
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Delta\text{F1}
\alpha
\{\alpha_{k}\}
\text{GNN}_{\Phi}
\%
\%
\Phi
\sim
\Pr_{\text{test}}(X,Y)
\Phi
\Delta
4.73
3.79
1.62
1.15
|C|
k
|C|
|C|
\mathcal{Q}_{\Phi}
\text{GNN}_{\Phi}
\mathcal{L}_{\Phi,\theta,S}
\mathcal{L}_{\Phi,\theta,S}
\mathcal{Q}_{\Phi}
\Pr(Y|X)
