Q
V
\mathcal{M}
\mathcal{M}=(\mathcal{S},\mathcal{A},\mathcal{O},\mathcal{T},\mathcal{Z},\mu_{%
0},\mathcal{R},\gamma)
h_{t}\in\mathcal{O}
h_{t}=\{t_{0},t_{1},t_{2},t_{3},...t_{t-1}\}
a_{t}=t_{t}\in\mathcal{A}
a_{\text{end}}
\pi
\mathcal{D}
\pi_{\beta}
Q^{*}(s,a)=R(s,a)+\gamma\max_{\begin{subarray}{c}a^{\prime},\text{s.t. }\pi_{%
\beta}(a^{\prime}|s^{\prime})>0\end{subarray}}Q^{*}(s^{\prime},a^{\prime}).
L_{V}(\psi)=\mathbf{E}_{(s,a)~{}\sim D}[L_{2}^{\tau}(Q_{\hat{\theta}}(s,a)-V_{%
\psi}(s))]
L_{2}^{\tau}(u)=|\tau-\mathbbm{1}(u<0)|u^{2}
\tau
L_{Q}(\theta)=\mathbf{E}_{(s,a,s^{\prime})~{}\sim D}[(R(s,a)+\gamma V_{\psi}(s%
^{\prime})-Q_{\theta}(s,a))^{2}].
\pi_{\beta}
\pi_{\beta}
\pi_{\beta}
\pi_{\beta}
\pi_{\beta}
\pi
L_{Q,V}(\theta)=\mathbf{E}_{\tau\sim D}\left[\sum_{i=0}^{T}(R(h_{i},a_{i})+%
\gamma V_{\theta}(h_{i+1})-Q_{\theta}(h_{i},a_{i}))^{2}+L_{2}^{\tau}(Q_{\hat{%
\theta}}(h_{i},a_{i})-V_{\theta}(h_{i}))\right]
e^{\beta(\hat{Q}-V)}
\pi_{\beta}
Q(h,a)-V(h)
\pi_{\beta}
\beta
\pi(a|h)\propto\pi_{\beta}(a|h)e^{\beta(Q(h,a)-V(h))}=\exp({\log(\pi_{\beta}(a%
|h))+\beta(Q(h,a)-V(h))})
\pi_{\beta}
\pi_{\beta}
\pi_{\beta}
Q
V
\pi_{\beta}
\displaystyle L^{c}_{Q,V}(\theta)=L_{Q,V}(\theta)-\alpha\mathbf{E}_{\tau\sim D%
}\log\left(\frac{e^{Q_{\theta}(s_{i},a_{i})}}{\sum_{a^{\prime}\in\mathcal{A}}e%
^{Q_{\theta}(s_{i},a^{\prime})}}\right)
\displaystyle L^{c}_{Q,V}(\theta)=L_{Q,V}(\theta)-\alpha\mathbf{E}_{\tau\sim D%
}\log\left(\frac{e^{Q_{\theta}(s_{i},a_{i})}}{\sum_{a^{\prime}\in\mathcal{A}}e%
^{Q_{\theta}(s_{i},a^{\prime})}}\right)
\pi_{\beta}
\alpha
\pi_{\beta}
\alpha
\hat{Q}=\text{min}(Q_{1},Q_{2})
Q(h_{t},a_{t})
\text{``The movie''}\to\text{``was''}
\pi_{\text{upper bound}}
S_{0}\to\text{Goal}
\pi_{\text{adversarial}}
\pi_{\text{upper bound}}
S_{0}\to S_{1}
S_{0}\to\text{Lava}
\pi_{\text{suboptimal}}
S_{0}\to S_{1}
S_{2}
S_{1}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\psi
\sigma
\pm
\pm
\psi
\pm
\pm
\pm
\pm
\pm
N
\sim
>
\sigma
\pm
\pm
\pm
\mathcal{M}
\mathcal{M}=(\mathcal{S},\mathcal{A},\mathcal{O},\mathcal{T},\mathcal{Z},\mu_{%
0},\mathcal{R},\gamma)
h_{t}\in\mathcal{O}
h_{t}=\{t_{0},t_{1},t_{2},t_{3},...t_{t-1}\}
a_{t}=t_{t}\in\mathcal{A}
a_{\text{end}}
\pi:\mathcal{O}\to\mathcal{P}(\mathcal{A})
s_{t}
\mathcal{T}(\cdot|s_{t},a_{t})
s_{t}
R(s_{t},a_{t})\to\mathcal{R}
r_{t}
0.005
\gamma=0.99
\tau=\{0.7,0.8,0.9\}
\beta=\{4,8,16,\infty\}
\beta=\infty
\tau=0.6
\beta=\{1,2,4,8,16,32\}
\alpha
1.0
0.25
0.0001
\pi_{\beta}
\{10\%,30\%,50\%\}
\{10\%,20\%,30\%\}
\{-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0\}
\tau=0.5
\beta=\{4,8,16\}
\beta=\{1,2,4,8,16,32\}
\tau=\{0.7,0.8,0.9\}
\{4,8,16\}
\tau=0.5
\{4,8,16\}
\sigma
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha=\{0.1,1.0,10.0\}
\{4,8,16\}
\psi
\alpha=\{0.1,1.0,10.0\}
\psi
c=\{0.1,1.0,10.0\}
\beta=\{4,8,16\}
Q
L_{Q,V}(\theta)=\mathbf{E}_{\tau\sim D}\left[\sum_{i=0}^{T}(R(h_{i},a_{i})+%
\gamma\max_{a_{t+1}\in\mathcal{A}}Q_{\hat{\theta}}(h_{i+1},a_{t+1})-Q_{\theta}%
(h_{i},a_{i}))^{2}\right]
\psi
L_{Q,V}(\theta)=\mathbf{E}_{\tau\sim D}\left[\sum_{i=0}^{T}L_{\delta}(\frac{R(%
h_{i},a_{i})}{c}+\log(\pi_{\beta}(h_{i},a_{i}))+\gamma\log(\sum_{a_{t+1}\in%
\mathcal{A}}\exp{Q_{\hat{\theta}}(h_{i+1},a_{t+1})})-Q_{\theta}(h_{i},a_{i}))\right]
\pi_{\beta}
L_{\gamma}
\gamma=1
\tau=0.5
\psi
\psi
\tau=\{0.7,0.8,0.9\}
\beta=\{4,8,16\}
\tau=\{4,8,16\}
\{0.00,0.10,0.15,0.20\}
\pi_{\text{upper bound}}
S_{0}\to\text{Goal}
\pi_{\text{adversarial}}
\pi_{\text{upper bound}}
S_{0}\to S_{1}
S_{0}\to\text{Lava}
\pi_{\text{suboptimal}}
S_{0}\to S_{1}
\pi_{\text{upper bound}}>\pi_{\text{suboptimal}}>\pi_{\text{adversarial}}
\pi_{\text{upper bound}}
\pi_{\text{suboptimal}}
\pi_{\text{adversarial}}
S_{2}
S_{1}
\pm
\pm
\pm
\pm
\pi_{\text{upper bound}}
\pm
(1-p_{t})<(1-p_{0})*0.5
p_{t}
t
p_{0}
\geq 0
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\beta
\beta
\beta
\beta
\beta=4
\beta=32
\beta=32
\beta=4
\tau=0.7
\beta=4
\pm
\pm
\pm
\tau=0.7
\beta=8
\pm
\pm
\pm
\tau=0.7
\beta=16
\pm
\pm
\pm
\tau=0.7
\beta=\infty
\pm
\pm
\pm
\tau=0.8
\beta=4
\pm
\pm
\pm
\tau=0.8
\beta=8
\pm
\pm
\pm
\tau=0.8
\beta=16
\pm
\pm
\pm
\tau=0.8
\beta=\infty
\pm
\pm
\pm
\tau=0.9
\beta=4
\pm
\pm
\pm
\tau=0.9
\beta=8
\pm
\pm
\pm
\tau=0.9
\beta=16
\pm
\pm
\pm
\tau=0.9
\beta=\infty
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\beta=\infty
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=\infty
\beta=\infty
\alpha=0.1
\beta=4
\pm
\alpha=0.1
\beta=8
\pm
\alpha=0.1
\beta=16
\pm
\alpha=0.1
\beta=\infty
\pm
\alpha=1.0
\beta=4
\pm
\alpha=1.0
\beta=8
\pm
\alpha=1.0
\beta=16
\pm
\alpha=1.0
\beta=\infty
\pm
\alpha=10.0
\beta=4
\pm
\alpha=10.0
\beta=8
\pm
\alpha=10.0
\beta=16
\pm
\alpha=10.0
\beta=\infty
\pm
\psi
c=0.1
\beta=4
\pm
\psi
c=0.1
\beta=8
\pm
\psi
c=0.1
\beta=16
\pm
\psi
c=0.1
\beta=\infty
\pm
\psi
c=1.0
\beta=4
\pm
\psi
c=1.0
\beta=8
\pm
\psi
c=1.0
\beta=16
\pm
\psi
c=1.0
\beta=\infty
\pm
\psi
c=10.0
\beta=4
\pm
\psi
c=10.0
\beta=8
\pm
\psi
c=10.0
\beta=16
\pm
\psi
c=10.0
\beta=\infty
\pm
\text{R}=-11
\pm
\text{R}=-10
\pm
\text{R}=-9
\pm
\text{R}=-8
\pm
\text{R}=-7
\pm
\text{R}=-6
\pm
\text{R}=-5
\pm
\text{R}=-4
\pm
\text{R}=-3
\pm
\text{R}=-2
\pm
\text{R}=-1
\pm
\text{R}=0
\pm
\tau=0.7
\beta=4
\pm
\tau=0.7
\beta=8
\pm
\tau=0.7
\beta=16
\pm
\tau=0.7
\text{N}=4
\pm
\tau=0.7
\text{N}=8
\pm
\tau=0.7
\text{N}=16
\pm
\tau=0.8
\text{N}=4
\pm
\tau=0.8
\text{N}=8
\pm
\tau=0.8
\text{N}=16
\pm
\tau=0.9
\text{N}=4
\pm
\tau=0.9
\text{N}=8
\pm
\tau=0.9
\text{N}=16
\pm
\text{N}=4
\pm
\text{N}=8
\pm
\text{N}=16
\pm
\alpha=0.1
\text{N}=4
\pm
\alpha=0.1
\text{N}=8
\pm
\alpha=0.1
\text{N}=16
\pm
\alpha=1.0
\text{N}=4
\pm
\alpha=1.0
\text{N}=8
\pm
\alpha=1.0
\text{N}=16
\pm
\alpha=10.0
\text{N}=4
\pm
\alpha=10.0
\text{N}=8
\pm
\alpha=10.0
\text{N}=16
\pm
\text{u}=0.00
\pm
\text{u}=0.10
\pm
\text{u}=0.15
\pm
\text{u}=0.20
\pm
\beta=\infty
\beta=\infty
\tau=0.6
\beta=1
\pm
\pm
\pm
\pm
\tau=0.6
\beta=2
\pm
\pm
\pm
\pm
\tau=0.6
\beta=4
\pm
\pm
\pm
\pm
\tau=0.6
\beta=8
\pm
\pm
\pm
\pm
\tau=0.6
\beta=16
\pm
\pm
\pm
\pm
\tau=0.6
\beta=32
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\tau=0.6
\beta=1
\pm
\pm
\pm
\pm
\tau=0.6
\beta=2
\pm
\pm
\pm
\pm
\tau=0.6
\beta=4
\pm
\pm
\pm
\pm
\tau=0.6
\beta=8
\pm
\pm
\pm
\pm
\tau=0.6
\beta=16
\pm
\pm
\pm
\pm
\tau=0.6
\beta=32
\pm
\pm
\pm
\pm
\beta=1
\pm
\pm
\pm
\pm
\beta=2
\pm
\pm
\pm
\pm
\beta=4
\pm
\pm
\pm
\pm
\beta=8
\pm
\pm
\pm
\pm
\beta=16
\pm
\pm
\pm
\pm
\beta=32
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta
\beta
\tau=0.7
\beta=4
\pm
\tau=0.7
\beta=8
\pm
\tau=0.7
\beta=16
\pm
\tau=0.7
\beta=\infty
\pm
\tau=0.8
\beta=4
\pm
\tau=0.8
\beta=8
\pm
\tau=0.8
\beta=16
\pm
\tau=0.8
\beta=\infty
\pm
\tau=0.9
\beta=4
\pm
\tau=0.9
\beta=8
\pm
\tau=0.9
\beta=16
\pm
\tau=0.9
\beta=\infty
\pm
\beta=4
\pm
\beta=8
\pm
\beta=16
\pm
\beta=\infty
\pm
\pm
\pm
\pm
\pm
\beta=\infty
\beta=\infty
