10^{5}\times 10^{5}
x
x^{\operatorname{aug}}
\{x^{\operatorname{diff}}_{i}\}_{i=1}^{n}
\mathcal{S}_{x}
\mathcal{D}_{x}
x
x
\mathcal{S}_{x}
\mathcal{D}_{x}
x
x^{\operatorname{aug}}
\{x^{\operatorname{diff}}_{i}\}_{i=1}^{n}
\mathcal{S}_{x}
\mathcal{D}_{x}
x
x
\mathcal{S}_{x}
\mathcal{D}_{x}
\footnotesize\mathcal{L}_{\text{CSSL}}=\underset{\underset{\{x^{\operatorname{%
diff}}_{i}\}_{i=1}^{n}}{x,x^{\operatorname{aug}}}}{\mathbb{E}}\left[-\log\frac%
{sim(x,x^{\operatorname{aug}})}{sim(x,x^{\operatorname{aug}})+\sum_{i=1}^{n}%
sim(x,x^{\operatorname{diff}}_{i})}\right].
sim\left(\cdot,\cdot\right):\mathbb{R}^{m}\times\mathbb{R}^{m}\rightarrow%
\mathbb{R}
sim\left(x,x^{\prime}\right)=\exp\left(f_{\psi}(x)\cdot f_{\psi}(x^{\prime})/%
\tau\right)
x,x^{\prime}\in\mathbb{R}^{m}
f_{\psi}=\psi\circ f
f:\mathbb{R}^{m}\rightarrow\mathbb{R}^{d}
\psi:\mathbb{R}^{d}\rightarrow\mathbb{R}^{d^{\prime}}
\ell_{2}
\tau
x\in\mathbb{R}^{m}
x
x^{\operatorname{aug}}
x
n
\{x^{\operatorname{diff}}_{i}\}_{i=1}^{n}
x
x^{\operatorname{diff}}_{1}
x^{\operatorname{diff}}_{n}
\sum_{i=1}^{n}\exp\left(f_{\psi}(x)\cdot f_{\psi}(x^{\operatorname{diff}}_{i})%
/\tau\right)
(x,x^{\operatorname{diff}}_{i})
\ell_{2}
\ell_{2}
x
\{x^{\operatorname{diff}}_{i}\}_{i=1}^{n}
\eta\in(0,1)
x
\mathcal{S}_{x}
x
\mathcal{D}_{x}
x
x
\footnotesize\mathcal{L}_{\text{sup }}(x)=\frac{1}{|\mathcal{S}_{x}|}\sum_{x_{%
s}\in\mathcal{S}_{x}}-\log\frac{sim\left(x,x_{s}\right)}{\sum\limits_{x_{s}\in%
\mathcal{S}_{x}}sim\left(x,x_{s}\right)+\sum\limits_{x_{d}\in\mathcal{D}_{x}}%
sim\left(x,x_{d}\right)}.
x
\mathcal{S}_{x}
\mathcal{D}_{x}
f
\psi
g_{\phi}
\phi
\{X_{b}\}_{b=1}^{B}
\{Y_{b}\}_{b=1}^{B}
{f}^{(0)}\leftarrow f_{\text{SSL}}
f
t=0
{h_{k}^{b}}\leftarrow{f^{(t)}(x_{k}^{b}),\forall x_{k}^{b}\in X_{b},\forall b}
{H_{b}\leftarrow{\{h_{k}^{b}\}_{k=1}^{K_{b}}},\forall b}
g_{\phi}^{(t)}\leftarrow
\{H_{b}\}_{b=1}^{B}
\{Y_{b}\}_{b=1}^{B}
\text{AUC}^{(t)}_{val}\leftarrow
{\text{AUC}^{(t)}_{val}\geq\max_{t^{\prime}\leq t}\left\{\text{AUC}^{(t^{%
\prime})}_{val}\right\}}
\hat{y}_{k}^{b}\leftarrow\mathbbm{1}_{\{\phi^{(t)}(h_{k}^{b})>\eta\}},\forall x%
_{k}^{b}\in X_{b},\forall b
f_{\psi}^{(t+1)}\leftarrow\text{argmin}_{f_{\psi}}\mathcal{L}_{\text{sup}}(f_{%
\psi}^{(t)})
x
\mathcal{S}_{x}
\mathcal{D}_{x}
\mathcal{X}^{-}_{\text{neg}}
\mathcal{X}^{-}_{\text{neg}}
\mathcal{X}_{\text{pos}}^{+}
\mathcal{X}_{\text{pos}}^{-}
T_{\text{warm-up}}
x
\mathcal{X}^{-}_{\text{neg}}
\mathcal{S}_{x}
\mathcal{X}^{-}_{\text{neg}}
\mathcal{D}_{x}
\mathcal{X}_{\text{pos}}^{+}
\mathcal{X}_{\text{pos}}^{+}
\mathcal{X}_{\text{pos}}^{-}
r\%
\mathcal{X}_{\text{pos}}^{+}
\mathcal{X}_{\text{pos}}^{-}
\mathcal{X}_{\text{pos}}^{+}(r)
\mathcal{X}_{\text{pos}}^{-}(r)
p_{+}
x
\mathcal{S}_{x}
\mathcal{X}_{\text{pos}}^{+}(r)
x
\mathcal{X}^{-}_{\text{neg}}\cup\mathcal{X}_{\text{pos}}^{-}(r)
x
\mathcal{D}_{x}
\mathcal{X}^{-}_{\text{neg}}\cup\mathcal{X}_{\text{pos}}^{-}(r)
x
\mathcal{X}_{\text{pos}}^{+}(r)
x
(\times 10^{-2})
r
t
T
T_{\text{warmup}}<t\leq T
r:=r_{0}+\alpha_{r}\left(t-T_{\text{warm-up}}\right),
\alpha_{r}={(r_{T}-r_{0})}/{(T-T_{\text{warm-up}})}
r_{0}
r_{T}
(\times 10^{-2})
86.69_{1.09}
98.25_{0.01}
85.48_{0.24}
88.05_{0.77}
85.38_{0.31}
91.96_{0.31}
90.85_{0.76}
\textbf{94.69}_{0.07}
85.39_{1.20}
98.39_{0.05}
85.96_{0.45}
87.26_{0.42}
85.46_{0.21}
91.73_{0.42}
91.69_{0.28}
\textbf{95.07}_{0.09}
79.49_{3.20}
99.06_{0.02}
88.50_{0.54}
90.46_{0.64}
85.21_{0.74}
93.13_{0.22}
86.20_{3.25}
\textbf{94.45}_{0.05}
85.38_{1.32}
98.65_{0.08}
87.01_{0.82}
90.38_{0.67}
85.08_{0.38}
91.69_{0.54}
88.29_{0.99}
\textbf{94.25}_{0.07}
87.25_{0.59}
98.85_{0.25}
89.02_{0.54}
92.13_{1.07}
87.13_{0.71}
93.52_{0.49}
92.12_{0.68}
\textbf{95.74}_{0.27}
(\times 10^{-2})
5\%
71.2
10\%
45.0
40\%
23.5
10.9
50\%
5.8
33\%
4.1
\%
\%
\%
<
\times
10^{-2}
p=0.8
[0.2,1.8]
[-0.2,0.2]
p=0.2
2\times 10^{-4}
\times
2\times 10^{-4}
\times
x_{1},...,x_{k}
f
\hat{y}_{i}
x_{i}
\alpha_{i}\in[0,1]
x_{i}
f(x_{i})
\hat{y}=\sum_{i}^{k}\alpha_{i}\hat{y}_{i}
10^{-3}
\mathcal{X}^{+}_{\text{pos}}
\mathcal{X}^{-}_{\text{pos}}
\eta
r
r\%
\mathcal{X}^{-}_{\text{pos}}(r)
\mathcal{X}^{+}_{\text{pos}}(r)
r
\mathcal{X}^{+}_{\text{pos}}
\mathcal{X}^{-}_{\text{pos}}
\eta
r
r\%
\mathcal{X}^{-}_{\text{pos}}(r)
\mathcal{X}^{+}_{\text{pos}}(r)
r
lr\in[1\times 10^{-5},1\times 10^{-3}]
\eta\in[0.1,0.9]
p_{+}\in[0.05,0.5]
r_{0}\in[0.01,0.7]
r_{T}\in[0.2,0.8]
r
\eta=0.3
p_{+}=0.2
r_{0}=0.2
r_{T}=0.8
\eta
r_{0}
r_{T}
p_{+}
\eta
\eta
\eta
\eta
\eta
\eta
\eta
p_{+}
p_{+}
\mathcal{X}^{-}_{\text{neg}}
r_{0}
r_{T}
r_{0}
r_{T}
r_{0}
r_{T}
\mathcal{X}_{\text{neg}}^{-}
\mathcal{X}_{\text{pos}}^{+}
\mathcal{D}_{x}
\mathcal{X}_{\text{neg}}^{-}
90.91
94.25
\eta
p_{+}
\eta
p_{+}
r_{0}
r_{T}
r_{0}
r_{T}
\text{Dice}=\frac{2\sum_{i}y_{i}p_{i}}{\sum_{i}y_{i}+\sum_{i}p_{i}},
y_{i}
p_{i}
i
s_{i}
p_{i}=\sigma\left(as_{i}+b\right),
a\in[-5,5]
b\in[0.1,10]
(\times 10^{-2})
(\times 10^{-2})
\mathcal{B}
\mathbb{R}^{d}
\{H_{b}\}_{b=1}^{B}\subset\mathcal{B}
g:\mathcal{B}\rightarrow[0,1]
[0,1]
H={\{h_{k}\}_{k=1}^{K}}
K
\phi
g_{\phi}(H)=\max_{k=1,\cdots,K}\left\{\phi(h_{k})\right\}.
M
\phi
M
\text{top}M\left(\phi,H\right)
H
\phi
M
g_{\phi}(H)=\frac{1}{M}\sum_{k\in\text{top}M\left(\phi,H\right)}\phi(h_{k}).
\varphi
g_{\varphi}(H)=\varphi\left(\sum_{k=1}^{K}a_{k}h_{k}\right),
a_{k}
k
a_{k}=\frac{\exp\left(w^{T}\tanh(Vh_{k}^{T})\right)}{\sum_{j=1}^{K}\exp\left(w%
^{T}\tanh(Vh_{j}^{T})\right)},
w\in\mathbb{R}^{l\times 1}
V\in\mathbb{R}^{l\times d}
l
L
H
H^{(0)}
H
\displaystyle H^{\prime(l)}=\text{MSA}\left(H^{(l-1)}\right)+H^{(l-1))}
\displaystyle H^{\prime(l)}=\text{MSA}\left(H^{(l-1)}\right)+H^{(l-1))}
\displaystyle H^{(l)}=\text{MLP}\left(H^{\prime(l-1)}\right)+H^{\prime(l-1)}
\displaystyle H^{(l)}=\text{MLP}\left(H^{\prime(l-1)}\right)+H^{\prime(l-1)}
l=1,\cdots,L
H^{(l)}
g_{\varphi}(H^{l})=\varphi\left(\sum_{k=1}^{K}a_{k}h_{k}^{l}\right).
a_{k}
k
a_{k}=\frac{\exp\left(w^{T}\tanh(V(h_{k}^{l})^{T})\right)}{\sum_{j=1}^{K}\exp%
\left(w^{T}\tanh(V(h_{j}^{l})^{T})\right)},
w\in\mathbb{R}^{p\times 1}
V\in\mathbb{R}^{p\times d}
p
\{0.1\%,1\%,3\%,10\%,20\%\}
[0.1,5]
