{f_{\theta}}
\mathcal{X}
\mathcal{Y}
x
y
x
\mathbf{s}=[s_{1},s_{2},\cdots,s_{N_{s}}]
\mathbf{c}=[c_{1},c_{2},\cdots,c_{N_{c}}]
\mathbf{d}=[d_{1},d_{2},\cdots,d_{N_{d}}]
N
\mathbf{s}
\mathbf{c}
\mathbf{d}
\mathbf{d}_{x}
x
\mathbf{d}
\mathbf{c}
[0,1]
\oplus
x
x^{\prime}\in\mathcal{X}
D_{\mathcal{X}},D_{\mathcal{Y}}
{f_{\theta}}
D_{\mathcal{Y}}({f_{\theta}}(x),{f_{\theta}}(x^{\prime}))\leq D_{\mathcal{X}}(%
x,x^{\prime}),
D_{\mathcal{X}}(\cdot,\cdot)
D_{\mathcal{Y}}(\cdot,\cdot)
\mathcal{X}
\mathcal{Y}
D_{\mathcal{X}}(\cdot,\cdot)
D_{\mathcal{Y}}(\cdot,\cdot)
D_{\mathcal{X}}(x,x^{\prime})=0
x
x^{\prime}
\mathbf{c}=\mathbf{c}^{\prime}
\mathbf{d}=\mathbf{d}^{\prime}
\mathbf{s}\neq\mathbf{s}^{\prime}
D_{\mathcal{X}}(\cdot,\cdot)
x
x^{\prime}
|{f_{\theta}}(x)-{f_{\theta}}(x^{\prime})|
T_{d},T_{c}\in\mathbb{R}_{\geq 0}
x
x^{\prime}
\sum_{i=1}^{N_{d}}\mathbbm{1}\{d_{i}\neq d_{i}^{\prime}\}\leq T_{d}
\max\{|c_{i}-c_{i}^{\prime}|\}\leq T_{c},\forall\ 1\leq i\leq N_{c}
y=y^{\prime}
T_{d}
T_{c}
T_{d}
T_{c}
\displaystyle\min_{f_{\theta}}\mathbb{E}_{(x,y)}\ \ell({f_{\theta}}(x),y),
\displaystyle\min_{f_{\theta}}\mathbb{E}_{(x,y)}\ \ell({f_{\theta}}(x),y),
\displaystyle\min_{f_{\theta}}\mathbb{E}_{(x,y)}\ \max_{x+\epsilon\sim\mathcal%
{D}_{\text{Sen}}}\ell({f_{\theta}}(x+\epsilon),y),
\displaystyle\min_{f_{\theta}}\mathbb{E}_{(x,y)}\ \max_{x+\epsilon\sim\mathcal%
{D}_{\text{Sen}}}\ell({f_{\theta}}(x+\epsilon),y),
\mathcal{D}_{\text{Sen}}
\mathcal{D}_{\text{Sen}}
\mathcal{D}_{\text{Sen}}
\mathcal{D}_{\text{Sen}}
\mathcal{D}_{\text{Sen}}
{g_{\theta}}
x
{g_{\theta}}
\bar{\mathbf{s}}\neq\mathbf{s}_{x}
\mathbf{s}_{x}
x
\displaystyle{g_{\theta}}:(x,\bar{\textbf{s}},\mathbf{z})\rightarrow\hat{x},
\displaystyle{g_{\theta}}:(x,\bar{\textbf{s}},\mathbf{z})\rightarrow\hat{x},
\displaystyle\text{with}\ \mathbf{s}_{\hat{x}}=\bar{\mathbf{s}},\ x\ \text{and%
}\ \hat{x}\ \text{satisfy \lx@cref{creftype~refnum}{def:comp}},
\displaystyle\text{with}\ \mathbf{s}_{\hat{x}}=\bar{\mathbf{s}},\ x\ \text{and%
}\ \hat{x}\ \text{satisfy \lx@cref{creftype~refnum}{def:comp}},
\mathbf{z}\sim\mathcal{N}(0,\,1)
\hat{x}
{g_{\theta}}
c_{i,j}
i
j
\mathbb{P}(c_{i,j})=\sum_{k=1}^{K_{i}}w_{i,k}\mathcal{N}({c_{i,j};\mu_{i,k},%
\sigma_{i,k}^{2}})
w_{i,k}
k
i
\mu_{k}
\sigma_{k}
k
c_{i,j}
p_{i,k}(c_{i,j})=w_{i,k}\mathcal{N}({c_{i,j};\mu_{i,k},\sigma_{i,k}^{2})}
\mathbf{p}_{i}
K_{i}
k
c_{i,j}
\mathbf{e}_{i,x}
k
k
v_{i,x}=(c_{i,j}-\mu_{i,k})/4\sigma_{i,k}
\tilde{x}
x
{g_{\theta}}
\tilde{x}=(v_{1,x}\oplus\mathbf{e}_{1,x}\oplus\cdots\oplus v_{N_{c},x}\oplus%
\mathbf{e}_{N_{c},x})\oplus\mathbf{d}_{x}\oplus\mathbf{s}_{x}.
\oplus
\hat{x}
\mathbf{e}_{i,k}
v_{i,x}
v_{i,x}
\mathbf{e}_{i,x}
{g_{\theta}}
{d_{\theta}}
{g_{\theta}}
\tilde{x}
\bar{\mathbf{s}}
\mathbf{z}
{g_{\theta}}
\tilde{x}
v_{\hat{x}}
\mathbf{e}_{\hat{x}}
\mathbf{d}_{\hat{x}}
\mathbf{s}_{\hat{x}}
\mathbf{d}_{\hat{x}}
\mathbf{s}_{\hat{x}}
\mathbf{e}_{\hat{x}}
{d_{\theta}}
\hat{x}\oplus\tilde{x}\oplus(\hat{x}-\tilde{x})
\tilde{x}^{\prime}\oplus\tilde{x}\oplus(\tilde{x}^{\prime}-\tilde{x})
\tilde{x}^{\prime}
x^{\prime}
x
\hat{x}-\tilde{x}
\displaystyle\min_{g_{\theta}}\mathbb{E}_{x,x^{\prime}\sim\mathcal{D_{\text{%
comp}}}}\ \ell_{\text{CE}}(\mathbf{s}_{\hat{x}},\mathbf{s}_{x^{\prime}})-{d_{%
\theta}}({g_{\theta}}(\tilde{x}\oplus\mathbf{s}_{x^{\prime}}\oplus\mathbf{z})),
\displaystyle\min_{g_{\theta}}\mathbb{E}_{x,x^{\prime}\sim\mathcal{D_{\text{%
comp}}}}\ \ell_{\text{CE}}(\mathbf{s}_{\hat{x}},\mathbf{s}_{x^{\prime}})-{d_{%
\theta}}({g_{\theta}}(\tilde{x}\oplus\mathbf{s}_{x^{\prime}}\oplus\mathbf{z})),
\displaystyle\min_{d_{\theta}}\mathbb{E}_{x,x^{\prime}\sim\mathcal{D_{\text{%
comp}}}}\ {d_{\theta}}({g_{\theta}}(\tilde{x}\oplus\mathbf{s}_{x^{\prime}}%
\oplus\mathbf{z}))-{d_{\theta}}(\tilde{x}^{\prime}),
\displaystyle\min_{d_{\theta}}\mathbb{E}_{x,x^{\prime}\sim\mathcal{D_{\text{%
comp}}}}\ {d_{\theta}}({g_{\theta}}(\tilde{x}\oplus\mathbf{s}_{x^{\prime}}%
\oplus\mathbf{z}))-{d_{\theta}}(\tilde{x}^{\prime}),
\mathcal{D}_{\text{comp}}
\ell_{\text{CE}}
\mathbf{s}_{\hat{x}}
\mathbf{s}_{x^{\prime}}
{g_{\theta}}
X
x
\mathbf{s}_{x}
\hat{X}
(\hat{X})
y
\min_{f_{\theta}}\sum\ell(f_{\theta}(x),y),\quad x\in X+\texttt{Post}(\hat{X}).
\ell(x,y)
x
\max_{\hat{x}\in\{\hat{x}_{i}\}^{M}\leftarrow x}\ell(\hat{x},y)
\displaystyle\max_{\hat{x}\in\{\hat{x}_{i}\}^{m}\leftarrow x}\ell(\hat{x},y)
\displaystyle\max_{\hat{x}\in\{\hat{x}_{i}\}^{m}\leftarrow x}\ell(\hat{x},y)
\displaystyle=\ell(x,y)+\max_{\hat{x}\in\{\hat{x}_{i}\}^{m}\leftarrow x}[\ell(%
\hat{x},y)-\ell(x,y)]
\displaystyle=\ell(x,y)+\max_{\hat{x}\in\{\hat{x}_{i}\}^{m}\leftarrow x}[\ell(%
\hat{x},y)-\ell(x,y)]
\displaystyle=\ell(x,y)+\max_{\hat{x}\in\{\hat{x}_{i}\}^{m}\leftarrow x}[%
\langle\nabla_{x}\ell(x,y),(\hat{x}-x)\rangle]+\mathcal{O}(\delta^{2})
\displaystyle=\ell(x,y)+\max_{\hat{x}\in\{\hat{x}_{i}\}^{m}\leftarrow x}[%
\langle\nabla_{x}\ell(x,y),(\hat{x}-x)\rangle]+\mathcal{O}(\delta^{2})
\displaystyle\leq\ell(x,y)+T_{d}\max_{i}\nabla_{d_{i}}\ell(x,y)+T_{c}\max_{i}%
\nabla_{c_{i}}\ell(x,y)
\displaystyle\leq\ell(x,y)+T_{d}\max_{i}\nabla_{d_{i}}\ell(x,y)+T_{c}\max_{i}%
\nabla_{c_{i}}\ell(x,y)
\displaystyle+N_{s}\max_{i}\nabla_{s_{i}}\ell(x,y)+\mathcal{O}(\delta^{2}).
\displaystyle+N_{s}\max_{i}\nabla_{s_{i}}\ell(x,y)+\mathcal{O}(\delta^{2}).
T_{d}
T_{c}
\mathcal{O}(\delta^{2})
T=\{(x_{i},y_{i})\}^{N}
\eta
\ell
{g_{\theta}}
\{x_{i}\}^{N}
\hat{X}
{g_{\theta}}
{f_{\theta}}:\theta\leftarrow\theta-\eta\mathbb{E}_{(x,y)}[\nabla_{\theta}(%
\max_{\hat{x}\in\{\hat{x}_{i}\}^{M}\leftarrow x}\ell(\hat{x},y)+\ell(x,y))]
\{\hat{x}_{i}\}^{M}\leftarrow x
M
x
\{\hat{x}_{i}\}^{M}\in\texttt{Post}(\hat{X})
{f_{\theta}}
\hat{X}
(\hat{X})
\uparrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
T_{d}
-T_{c}
T_{c}
\uparrow
\uparrow
\uparrow
T_{d}
T_{c}
T_{c}
T_{d}=1
T_{c}=0.025
T_{d}=1
T_{c}=0.025
T_{d}=1
T_{c}=0.1
T_{d}=1
T_{c}=0.025
T_{d}=1
T_{c}=0.025
h
{g_{\theta}}=\begin{cases}h_{1}=\texttt{ReLU}(\texttt{BatchNorm1d}(\texttt{%
Linear}_{\rightarrow 256}(\tilde{x}\oplus\tilde{s}\oplus\mathbf{z})))\oplus%
\tilde{x}\oplus\tilde{s}\oplus\mathbf{z}\\
h_{2}=\texttt{ReLU}(\texttt{BatchNorm1d}(\texttt{Linear}_{\rightarrow 256}(h_{%
1})))\oplus h_{1}\\
h_{3}=\texttt{ReLU}(\texttt{BatchNorm1d}(\texttt{Linear}_{\rightarrow\text{Dim%
}(\tilde{x})}(h_{2})))\\
\hat{v}_{i}=\texttt{tanh}(\texttt{Linear}_{\rightarrow 1}(h_{3}[\text{index %
for}\ v_{i}]))\quad\forall\ 0\leq i\leq N_{c}\\
\hat{\mathbf{e}}_{i}=\texttt{gumbel}_{{0.2}}(\texttt{Linear}_{\rightarrow|d_{i%
}|}(h_{3}[\text{index for}\ K_{i}]))\quad\forall\ 0\leq i\leq N_{c}\\
\hat{\mathbf{d}}_{i}=\texttt{gumbel}_{{0.2}}(\texttt{Linear}_{\rightarrow|d_{i%
}|}(h_{3}[\text{index for}\ d_{i}]))\quad\forall\ 0\leq i\leq N_{d}\\
\end{cases}
{d_{\theta}}=\begin{cases}h_{1}=\texttt{Dropout}_{0.5}(\texttt{LeakyReLU}_{0.2%
}(\texttt{Linear}_{\rightarrow 256}(\hat{x}\oplus\tilde{x}\oplus{\hat{x}-%
\tilde{x}})))\\
h_{2}=\texttt{Dropout}_{0.5}(\texttt{LeakyReLU}_{0.2}(\texttt{Linear}_{%
\rightarrow 256}(h_{1})))\\
\text{score}=\texttt{Linear}_{\rightarrow 1}(h_{2})\\
\end{cases}
{g_{\theta}}
{d_{\theta}}
{g_{\theta}}
{d_{\theta}}
\ell_{2}
\ell_{2}
\%
\uparrow
\uparrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
