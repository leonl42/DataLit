4.5
<1\%
6.8
<1\%
L=12
H=768
H=768
N=128
48
80
7
73
768
L=12
H=768
H=768
N=128
48
80
7
73
768
4.5
<1\%
6.8
L=12
A=12
H=768
N
N
N
H=768
12
h\in[1,12]
\mathbf{W}^{h}_{\mathbf{q}}
\mathbf{W}^{h}_{\mathbf{k}}
\mathbf{W}^{h}_{\mathbf{v}}
\mathbf{M}
N\times 768
h
\mathbf{A}_{h}={\sf{softmax}}[(\mathbf{M}\times\mathbf{W}^{h}_{\mathbf{q}})%
\times(\mathbf{M}\times\mathbf{W}^{h}_{\mathbf{k}})^{T}]
\mathbf{A}_{h}
N\times N
1
\mathbf{V}_{h}=\mathbf{M}\times\mathbf{W}^{h}_{\mathbf{v}}
\mathbf{Z}_{h}=\mathbf{A}_{h}\times\mathbf{V}_{h}
\mathbf{Z}_{h}
1.2\%
0.23\%
92.43\%
j\in[1,12]
\binom{N}{2}
N
j^{th}
j^{th}
j^{th}
j^{th}
(\ell_{1},\ell_{2},\ldots,\ell_{12})
\ell_{j}
j
(80,73,70,50,50,40,33,27,20,15,13,3)
\ell_{j}
j
(\ell_{1},\ell_{2},\ldots,\ell_{12})
j\in[1,12]
\ell_{j-1}
\ell_{j-1}\times 768
\ell_{0}=N
\ell_{j}
\ell_{j}
\ell_{j}
N
\ell_{j}
w
w
j
\mathbf{M}
\ell_{j-1}\times 768
\ell_{j-1}\times\ell_{j-1}
h\in[1,12]
w^{\prime}
\mathbf{Z}_{h}[w^{\prime},:]
h
\sum_{w}\mathbf{A}_{h}[w^{\prime},w]\cdot\mathbf{V}_{h}[w,:]
\mathbf{Z}_{h}[w^{\prime},:]
\mathbf{V}_{h}
\mathbf{A}_{h}[w^{\prime},w]
w^{\prime}
w
h
w
w
w
h
w
h
{\tt Sig}_{h}(w)=\sum_{w^{\prime}}\mathbf{A}_{h}[w^{\prime},w]
w
{\tt Sig}(w)=\sum_{h}{\tt Sig}_{h}(w)
w
N=6
\ell_{1}=4
\ell_{2}=2
w_{2}
w_{4}
w_{1}
w_{5}
N=6
\ell_{1}=4
\ell_{2}=2
w_{2}
w_{4}
w_{1}
w_{5}
\ell_{j}
w
h
w
h
{\tt Sig}_{h}(w)=\sum_{w^{\prime}}\mathbf{A}_{h}[w^{\prime},w]
A_{h}
h
w^{\prime}
w
{\tt Sig}(w)=\sum_{h}{\tt Sig}_{h}(w)
\mathbf{X}
\mathbf{Y}
\mathbf{X}
\mathbf{Y}
\mathbf{MI}(\mathbf{X};\mathbf{Y})=\mathbf{H}(\mathbf{X})-\mathbf{H}(\mathbf{X%
}|\mathbf{Y})
\mathbf{H}(\mathbf{X})
\mathbf{X}
\mathbf{H}(\mathbf{X}|\mathbf{Y})
\mathbf{X}
\mathbf{Y}
\mathbf{X}
\mathbf{Y}
\mathbf{X}
\mathbf{Y}
\mathbf{X}
\mathbf{Y}
\mathbf{MI}(\mathbf{X};\mathbf{Y})=0
\mathbf{MI}(\mathbf{X};\mathbf{Y})=\mathbf{H}(\mathbf{X})=\mathbf{H}(\mathbf{Y})
N=128
C=2
j
j
\mathbf{X}
k\leq\ell_{j-1}
w
k^{th}
1,2,\ldots,j-1
w
j
j+1,j+2,\ldots,12
\mathbf{Y}_{k}
\mathbf{X}
\mathbf{Y}_{k}
\sum_{b,b^{\prime}\in\{0,1\}}\Pr(\mathbf{X}=b,\mathbf{Y}=b^{\prime})\cdot\ln%
\left[\frac{\Pr(\mathbf{X}=b,\mathbf{Y}=b^{\prime})}{\Pr(\mathbf{X}=b)\cdot\Pr%
(\mathbf{Y}=b^{\prime})}\right]
\mathbf{X}
\mathbf{Y}_{k}
j
k\in[1,128]
j=1,3,6,9
\mathbf{H}(\mathbf{X})\sim\ln(2)=0.69
k
j
{\tt Sig}(\cdot)
j
w_{1},w_{2},\ldots,w_{N}
w_{i}
{\tt Sig}(w_{i})
w_{i}
{\tt Sig}^{\it pos}(w_{i})
w_{i}
w_{i}
N=4
w_{3},w_{4},w_{1},w_{2}
w_{3}
{\mathbf{r}}_{1}[1]
w_{2}
{\mathbf{r}}_{1}[4]
N=4
w_{3},w_{4},w_{1},w_{2}
w_{3}
{\mathbf{r}}_{1}[1]
w_{2}
{\mathbf{r}}_{1}[4]
N
{\mathbf{r}}_{j}[1],\ldots,{\mathbf{r}}_{j}[N]
[0,1]
{\mathbf{r}}_{j}[k]
k^{th}
\mathbf{E}^{in}
N\times 768
i\in[1,N]
\mathbf{E}^{in}[i,:]
w_{i}
\mathbf{E}^{out}[i,:]={\mathbf{r}}_{j}[{\tt Sig}^{\it pos}(w_{i})]\cdot\mathbf%
{E}^{in}[i,:].
\mathbf{E}^{out}[i,:]
k^{th}
{\mathbf{r}}_{j}[k]
j
{{\rm mass}}(j;{\mathbf{r}})=\sum_{k=1}^{N}{\mathbf{r}}_{j}[k]
{\rm mass}(j;{\mathbf{r}})
L_{1}
\mathbf{\Theta}
{\cal L}(\cdot)
\displaystyle\min_{\mathbf{\Theta},{\mathbf{r}}}\left[{{\cal L}}(\mathbf{%
\Theta},{\mathbf{r}})~{}+~{}\lambda\cdot\sum_{j=1}^{L}j\cdot{\rm mass}(j;{%
\mathbf{r}})\right]
\displaystyle\min_{\mathbf{\Theta},{\mathbf{r}}}\left[{{\cal L}}(\mathbf{%
\Theta},{\mathbf{r}})~{}+~{}\lambda\cdot\sum_{j=1}^{L}j\cdot{\rm mass}(j;{%
\mathbf{r}})\right]
\displaystyle{\rm s.t.}~{}~{}{\mathbf{r}}_{j}[k]\in[0,1]~{}~{}\forall(j\in[1,L%
],k\in[1,N]),
\displaystyle{\rm s.t.}~{}~{}{\mathbf{r}}_{j}[k]\in[0,1]~{}~{}\forall(j\in[1,L%
],k\in[1,N]),
L
{\cal L}(\mathbf{\Theta},{\mathbf{r}})
\lambda
{\mathbf{r}}_{j}[k]=1
{\mathbf{r}}_{j}[k]
k^{th}
j
\ell_{j}={\tt ceil}({\rm mass}(j))
\ell_{j}=\min\{\ell_{j},\ell_{j-1}\}
\lambda
2-3
\#
(N)
1\%
\lambda
1\%
\lambda
9
[10^{-4},10^{-2}]
[2\times 10^{-5},6\times 10^{-5}]
\lambda
[10^{-4},10^{-3}]
\{4,8,16,32,64\}
N
N
N=512
N
N
N^{\prime}
1\%
N^{\prime}
N
\{64,128,256,512\}
N^{\prime}
\lambda
\{3,4,6\}
16\%
6\%
305
1326
2.7
2
48.2\%
65.5\%
\lambda
\{3,4,6\}
16\%
6\%
305
1326
2.7
2
48.2\%
65.5\%
1\%
\lambda
2.0
4.5
N=256
12\times 256=3072
(153,125,111,105,85,80,72,48,35,27,22,5)
868
868
\lambda
3
4
6
16\%
6\%
2.7
2.0
~{}26\%
2
<1\%
6.8
>16
(64,32,16,16,16,16,16,16,16)
16
16
N=12
(7,7,7,7,4,4,4,4,2,2,2,2)
4.5
<1\%
