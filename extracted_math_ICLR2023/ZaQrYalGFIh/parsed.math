G=G(V,E)
V
|V|=n
E
|E|=m
\bm{A}
\bm{X}\in\mathbb{R}^{n\times d_{X}}
d_{X}
\bm{P}\in\mathbb{R}^{n\times d_{P}}
d_{P}
i
\bm{x}_{i}\in\mathbb{R}^{d_{X}}
\bm{p}_{i}\in\mathbb{R}^{d_{P}}
y_{i}\in\{1,\dots,c\}
G_{\text{train}}(V_{\text{train}},E_{\text{train}})
G_{\text{valid}}(V_{\text{valid}},E_{\text{valid}})
G_{\text{test}}(V_{\text{test}},E_{\text{test}})
\mathbb{I}\{\cdot\}
\Gamma_{c}
c
G(V,E)
V_{\text{train}}\subseteq V
\bm{X}
\bm{Y}
\bm{Y}_{\text{final}}
\bm{P}
\bm{\hat{y}}_{i}=\frac{\sum_{j\in V_{\text{train}}:(j,i)\in E_{\text{train}}}%
\bm{y}_{j}}{|\{j\in V_{\text{train}}:(j,i)\in E_{\text{train}}\}|}
i\in V_{\text{train}}
\bm{\tilde{y}}_{i}=f_{1}(\bm{x}_{i},\bm{p}_{i};\bm{\theta}_{1})
i\in V_{\text{train}}
\mathcal{L}_{\text{CE},1}(\bm{\theta}_{1})=\sum_{i\in V_{\text{train}}}\text{%
CE}(\bm{\hat{y}}_{i},\bm{\tilde{y}}_{i};\bm{\theta}_{1})
\bm{\tilde{y}_{i}}
\bm{\hat{y}_{i}}
\bm{\theta}_{1}^{*}
\bm{y}_{i}^{\prime}=\frac{\sum_{j\in V:(i,j)\in E}\bm{\tilde{y}}_{j}}{|\{j\in V%
:(i,j)\in E\}|}
i\in V_{\text{train}}
\bm{\tilde{y}}_{j}=f_{1}(\bm{x}_{j},\bm{p}_{j};\bm{\theta}_{1}^{*})
y_{\text{final},i}=f_{2}(\bm{x}_{i},\bm{p}_{i},\bm{y}_{i}^{\prime};\bm{\theta}%
_{2})
\mathcal{L}_{\text{CE},2}(\bm{\theta}_{2})=\sum_{i\in V_{\text{train}}}\text{%
CE}(y_{i},y_{\text{final},i};\bm{\theta}_{2})
\bm{Y}_{\text{final}}
i
i
i+1
G
\bm{A}_{sym}^{\prime}
\begin{split}\bm{H}^{(0)}=\bm{X},\;\bm{H}^{(i+1)}=\sigma\left(\bm{A}_{sym}^{%
\prime}\bm{H}^{(i)}\bm{W}^{(i)}\right)\forall i\in[L],\;\bm{Y}=\mathrm{softmax%
}\left(\bm{H}^{(L)}\right).\end{split}
\bm{H}^{(i)}
\bm{W}^{(i)}
\sigma(\cdot)
\bm{X}
\begin{split}\bm{H}_{X}=\text{MLP}_{\text{$X$}}\!\left(\bm{X}\right),\;\bm{H}_%
{A}=\text{MLP}_{\text{$A$}}\!\left(\bm{A}\right),\;\bm{Y}=\mathrm{ResNet}(\bm{%
H}_{X},\bm{H}_{A}).\end{split}
f(\bm{X},\bm{Y}_{\text{train}},\bm{A};\bm{\theta})
\bm{X}
\bm{Y}_{\text{train}}
\bm{A}
i
G
c
V_{\text{train}}
d_{P}\sim 10^{2}
j_{\ell},\ell\in[5]
i
i
i
\bm{x}_{i}
\bm{p}_{i}
i
i
i
i
j_{\ell}
i
i
j_{\ell}
G
\bm{\hat{y}}_{i}=\frac{\sum_{j\in V_{\text{train}}:(j,i)\in E_{\text{train}}}%
\bm{y}_{j}}{|\{j\in V_{\text{train}}:(j,i)\in E_{\text{train}}\}|}\qquad%
\forall i\in V_{\text{train}}.
\bm{\tilde{y}}_{i}
\{\bm{x}_{i}\}_{i\in V_{\text{train}}}
\{\bm{p}_{i}\}_{i\in V_{\text{train}}}
\{\bm{\hat{y}}_{i}\}_{i\in V_{\text{train}}}
\mathcal{L}_{\text{CE, 1}}(\bm{\theta}_{1})=\sum_{i\in V_{\text{train}}}\sum_{%
l\in[c]}\bm{\hat{y}}_{i,l}\log(\bm{\tilde{y}}_{i,l}),
\bm{\tilde{y}}_{i}=f_{1}(\bm{x}_{i},\bm{p}_{i};\bm{\theta}_{1})
\bm{\theta}_{1}\in\Theta_{1}
\bm{\tilde{y}}_{i}
\bm{y}_{i}^{\prime}=\frac{\sum_{j\in V:(i,j)\in E}\bm{\tilde{y}}_{j}}{|\{j\in V%
:(i,j)\in E\}|}\quad\forall i\in V_{\text{train}},
\{\bm{\tilde{y}}_{i}\}_{i\in V_{\text{train}}}
\bm{\theta}_{1}^{*}
f_{1}(\cdot|\bm{\theta}_{1})
\bm{y}_{\text{final, i}}=f_{2}(\bm{x}_{i},\bm{p}_{i},\bm{y}_{i}^{\prime};\bm{%
\theta}_{2})
\bm{\theta}_{2}
\bm{\tilde{y}}_{i}
\text{one-hot}\left(y_{i}\right)
\mathcal{L}_{\text{CE, 2}}(\bm{\theta}_{2})=\sum_{i\in V_{\text{train}}}\sum_{%
l\in[c]}\mathbb{I}\{y_{i}=l\}\log(\bm{y}_{\text{final, i},l}),
i
i
\bm{x}_{i}\in\mathbb{R}^{d_{X}}
\bm{p}_{i}\in\mathbb{R}^{d_{P}}
\widetilde{\bm{y}}_{i}\in\mathbb{R}^{c}
\bm{\hat{y}}_{i}
\bm{\tilde{y}}_{i}
j_{1}
j_{5}
j_{1}
\bm{\tilde{y}}_{i}
i
\bm{y}_{j_{1}}^{\prime}
\bm{y}_{j_{1}}^{\prime},\bm{x}_{j_{1}},\bm{p}_{j_{1}}
i
i
\bm{x}_{i}\in\mathbb{R}^{d_{X}}
\bm{p}_{i}\in\mathbb{R}^{d_{P}}
\widetilde{\bm{y}}_{i}\in\mathbb{R}^{c}
\bm{\hat{y}}_{i}
\bm{\tilde{y}}_{i}
j_{1}
j_{5}
j_{1}
\bm{\tilde{y}}_{i}
i
\bm{y}_{j_{1}}^{\prime}
\bm{y}_{j_{1}}^{\prime},\bm{x}_{j_{1}},\bm{p}_{j_{1}}
O(mc)
c
d_{X}
\bm{\xi}_{i}
\bm{\xi}_{i}
\bm{\xi}_{i}=[\bm{x}_{i};\bm{p}_{i}]
i
G([n],E)
K>c^{2}
\bm{Q}_{i}\in\Gamma_{c}
i
\mathcal{N}(i)
i\in[n]
\bm{\widehat{Q}}_{i}
\bm{Q}_{i}
\widehat{Q}_{i,j}=\frac{1}{|\mathcal{N}(i)|}\sum_{k\in\mathcal{N}(i)}\mathbb{I%
}\{y_{k}=j\}
i\in[n]
\max_{j\in[c]}\mathbb{E}[|Q_{i,j}-\widehat{Q}_{i,j}|]\leq\mathbb{E}[\|\bm{Q}_{%
i}-\bm{\widehat{Q}}_{i}\|_{\infty}]\leq O\left(\sqrt{\tfrac{\log(Kc)}{K}}\right)
q(\cdot|\bm{\xi}_{i};\bm{\theta})
\bm{\theta}\in\mathbb{R}^{D}
\bm{\xi}_{i}
i
\bm{Q}_{i}
\bm{\theta}_{1}
t=n
\mathcal{L}(\bm{\theta})=\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}Q_{i,j}\log q(%
j|\bm{\xi}_{i};\bm{\theta})
i\in[n]
\max_{j\in[c]}\mathbb{E}[|q(j;\bm{\xi}_{i};\bm{\theta}_{1})-Q_{i,j}|]\leq O%
\left(\sqrt{\tfrac{\log n}{n}}\right)
K
n
\tilde{O}(n^{-1/2})
\tilde{O}(K^{-1/2})
G([n],E)
K>c^{2}
\bm{P}_{i}
i
\bm{Q}_{i},q(\cdot|\bm{\xi}_{i};\bm{\theta}_{1})
p(\cdot|\bm{\xi}_{i};\bm{w})
\bm{w}\in\mathbb{R}^{D}
y_{i}\sim p(\cdot|\bm{\xi}_{i};\bm{w})
\bm{w}_{*}
\mathcal{G}(\bm{w})=\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}P_{i,j}\log p(j|\bm%
{\xi}_{i};\bm{w})
n
\mathbb{E}[\mathcal{G}(\bm{w}_{n+1})-\mathcal{G}(\bm{w}_{*})]\leq O\left(%
\tfrac{\log n}{n}\right)
\widehat{\mathcal{G}}(\bm{w})=\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}{\big{(}%
\frac{1}{|\mathcal{N}(i)|}\sum_{k\in\mathcal{N}(i)}q(j|\bm{\xi}_{k};\bm{\theta%
}_{1})\big{)}}\log p(j|\bm{\xi}_{i};\bm{w})
n_{1}
\bm{w}^{\prime}
\lambda\widehat{\mathcal{G}}(\bm{w})+(1-\lambda)\mathcal{G}(\bm{w})
n
\bm{w}^{\prime}
\mathbb{E}[\mathcal{G}(\bm{w}_{n+1})-\mathcal{G}(\bm{w}_{*})]\leq O\left(\frac%
{\sqrt{\log n\log\log n}}{n}\right)
\sqrt{\log n/\log\log n}
r\in\mathbb{N}
[X,\Phi X,\Phi^{2}X,\dots,\Phi^{r}X]
\Phi
n
m
d_{X}/c
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbb{I}[A^{2}\!-\!A\!-\!I\!\geq\!0]
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\bm{X}
\bm{A}
AA^{T}
\bm{y}_{i}^{\prime}
\bm{A}
\bm{A}
O(mc+n(d_{X}h+h^{2}L_{X}+d_{P}h+h^{2}L_{P}+h^{2}L_{\text{agg}}))
O(md+n(d_{X}h+h^{2}L_{X}+h^{2}L_{\text{agg}})
L
O(mdL+nd^{2}L)
L
O(nL(nd+d^{2}h+L_{\text{agg}}h^{2}))
L
\tau
O((n+m)cL\tau)
O(m_{\text{train}}c)
m_{\text{train}}=|E_{\text{train}}|
\bm{x}_{i}
\bm{p}_{i}
L_{X}
\bm{x}_{i}
L_{P}
\bm{p}_{i}
L_{\text{agg}}
h
O\left(n(d_{X}h+h^{2}L_{X}+d_{P}h+h^{2}L_{P}+h^{2}L_{\text{agg}})\right)
O(m_{\text{train}}c)
O(n(d_{X}h+h^{2}L_{X}+d_{P}h+h^{2}L_{P}+ch+h^{2}L_{\text{prop}}+h^{2}L_{\text{%
agg}}))
c
L_{\text{prop}}
\bm{y}_{i}^{\prime}
L
L
O(m_{\text{train}}c)
O(mh+nh^{2}L_{P})
h
O(nd_{P}h+nh^{2}L_{P})
d_{P}=O(m/n)
d_{P}\sim 10^{2}
n\sim 1\mathrm{B}
m\sim 100\mathrm{B}
L
\bm{A}
\bm{W}^{(i)}
O(dLm+nd^{2}L)
\bm{A}
L
L
L
2L
\bm{X}
\{\Phi^{\ell}\}_{\ell\in[L]}
O(n^{2}dL)
L_{\text{agg}}
O(nLdhL_{\text{agg}})
O(nL(nd+d^{2}h+L_{\text{agg}}h^{2}))
O((n+m)cL\tau)
\tau
\bm{P}
G
\bm{r}=\bm{\rho}
(u,v)\in E
\bm{h}=\bm{p}_{u}
\bm{t}=\bm{p}_{v}
\bm{\rho}=\bm{1}
G(V,E)
d_{P}
f:\mathbb{R}^{d_{P}}\times\mathbb{R}^{d_{P}}\times\mathbb{R}^{d_{P}}\to\mathbb%
{R}
\ell:\mathbb{R}\times\mathbb{R}\to\mathbb{R}
T
B
\nu
\bm{P}\in\mathbb{R}^{n\times d_{P}}
\bm{P}\in\mathbb{R}^{n\times d_{P}}
\bm{p}_{u}
u\in V
\bm{\rho}=\bm{1}
t\in[T]
\{E_{\text{batch}}\}
E
B
E_{\text{batch}}
(u,v)\in E
\nu
(u_{i}^{\prime},v_{i}^{\prime})\notin E
T_{\text{batch}}=\bigcup_{i\in[\nu]}\{((u,v),(u_{i}^{\prime},v_{i}^{\prime}))\}
\bm{P}
\displaystyle\nabla_{\bm{P}}\sum_{((u,v),(u^{\prime},v^{\prime}))\in T_{\text{%
batch}}}\ell(f(\bm{p}_{u},\bm{\rho},\bm{p}_{v}),f(\bm{p}_{u}^{\prime},\bm{\rho%
},\bm{p}_{v}^{\prime}))
\displaystyle\nabla_{\bm{P}}\sum_{((u,v),(u^{\prime},v^{\prime}))\in T_{\text{%
batch}}}\ell(f(\bm{p}_{u},\bm{\rho},\bm{p}_{v}),f(\bm{p}_{u}^{\prime},\bm{\rho%
},\bm{p}_{v}^{\prime}))
\bm{P}
f(\bm{h},\bm{r},\bm{t})=\sum_{i\in d_{P}}h_{i}r_{i}t_{i}
\ell(f(\bm{h},\bm{r},\bm{t}),f(\bm{h}^{\prime},\bm{r},\bm{t}^{\prime}))=\max\{%
0,\gamma+f(\bm{h},\bm{r},\bm{t})-f(\bm{h}^{\prime},\bm{r},\bm{t}^{\prime})\}
\gamma
G_{\text{train}}(V_{\text{train}},E_{\text{train}})
G\subseteq G_{\text{train}}
G_{\text{train}}
G_{\text{train}}
\bm{x}_{i}
\bm{\tilde{y}}_{i}
\bm{y}^{\prime}_{i}
G_{\text{train}}
\bm{y}_{i}^{\prime}
G(V,E)
V_{\text{train}}\subseteq V
V_{\text{test}}\subseteq V
X
Y
i\in V_{\text{test}}
G_{\text{train}}(V_{\text{train}},E_{\text{train}})
\{\bm{p}_{i}\}_{i\in V_{\text{train}}}
f_{1}
f_{2}
\{\bm{p}_{i}\}_{i\in V_{\text{test}}}
\bm{\tilde{y}}_{i}=f_{1}(\bm{x}_{i},\bm{p}_{i})
i\in V_{\text{test}}
\bm{y}_{i}^{\prime}=\frac{\sum_{j\in V:(i,j)\in E}\bm{\tilde{y}}_{j}}{|\{j\in V%
:(i,j)\in E\}|}
i\in V_{\text{test}}
\bm{y}_{\text{final},i}=f_{2}(\bm{x}_{i},\bm{p}_{i},\bm{y}_{i}^{\prime})
i\in V_{\text{test}}
\{\bm{y}_{\text{final},i}\}_{i\in V_{\text{test}}}
\in\{1,2\}
\in\{1,2\}
\in\{1,2\}
\in\{0.5\}
\in\{0.1,0.001\}
\in\{1,2\}
\in\{1,2\}
\in\{1,2\}
\in\{0.5\}
\in\{0.1,0.001\}
\in\{1\}
\in\{4,8,16,32\}
\in\{2,4\}
\in\{0.01,0.001\}
\in\{1\}
\in\{4,8,16,32,64\}
\in\{0.01,0.001\}
\in\{2,3\}
\in\{32,64,128\}
\in\{0.01,0.001\}
\in\{\text{true},\text{false}\}
\alpha\in\{0.01,0.1,0.25,0.5,0.75,0.99\}
\text{hops }\in\{1,2\}
Q
Q_{i}
\widehat{Q}_{i}
\mathcal{N}(i)
\widehat{Q}_{i,j}=\frac{1}{|\mathcal{N}(i)|}\sum_{k\in\mathcal{N}(i)}\mathbb{I%
}\{y_{k}=j\}
\mathbb{E}[\widehat{Q}_{i,j}]=Q_{i,j}
1-\delta
\left|\widehat{Q}_{i,j}-\frac{1}{|\mathcal{N}(i)|}\sum_{k\in\mathcal{N}(i)}P_{%
k,j}\right|\leq\sqrt{\frac{1}{2K}\log\frac{2}{\delta}}
\bm{Q}_{i}=\frac{1}{|\mathcal{N}(i)|}\sum_{k\in\mathcal{N}(i)}\bm{P}_{k}
\|\bm{\widehat{Q}}_{i}-\bm{Q}_{i}\|_{\infty}\leq\sqrt{\frac{1}{2K}\log\frac{2c%
}{\delta}}
1-\delta
\delta
\displaystyle\max_{j\in[c]}\mathbb{E}[|Q_{ij}-\widehat{Q}_{ij}|]\leq\mathbb{E}%
[\|\bm{Q}_{i}-\bm{\widehat{Q}}_{i}\|_{\infty}]\leq\min_{\delta\in(0,1)}\sqrt{%
\frac{1}{2K}\log\frac{2c}{\delta}}+\delta\leq O\left(\sqrt{\frac{\log(Kc)}{K}}\right)
\displaystyle\max_{j\in[c]}\mathbb{E}[|Q_{ij}-\widehat{Q}_{ij}|]\leq\mathbb{E}%
[\|\bm{Q}_{i}-\bm{\widehat{Q}}_{i}\|_{\infty}]\leq\min_{\delta\in(0,1)}\sqrt{%
\frac{1}{2K}\log\frac{2c}{\delta}}+\delta\leq O\left(\sqrt{\frac{\log(Kc)}{K}}\right)
\bm{Q}_{i}
\bm{Q}_{i}
q(j|\bm{\xi}_{i};\bm{\theta})
\bm{\theta}\in\mathbb{R}^{D}
\bm{\theta}_{*}
Q_{i,j}=q(j|\bm{\xi}_{i};\bm{\theta}_{*})
\mathcal{L}(\bm{\theta})=-\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}Q_{i,j}\log q%
(j|\bm{\xi}_{i};\bm{\theta})
\bm{\theta}_{*}
\mathcal{L}(\bm{\theta})
\mathcal{L}(\bm{\theta})
L
\gamma
\|\nabla\mathcal{L}(\bm{\theta})\|\leq L,\quad\mathcal{L}(\bm{\theta})-%
\mathcal{L}(\bm{\theta}_{*})\leq\frac{1}{2\gamma}\|\nabla\mathcal{L}(\bm{%
\theta})\|^{2}
\widehat{\mathcal{L}}(\bm{\theta})
\widehat{\mathcal{L}}(\bm{\theta})=-\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}%
\widehat{Q}_{i,j}\log q(j|\bm{\xi}_{i};\bm{\theta})
\bm{\theta}
t
i_{t}
\bm{g}_{t}
\bm{g}_{t}=\sum_{j=1}^{c}\widehat{Q}_{i,j}\nabla_{\bm{\theta}}\log q(j|x_{i_{t%
}};\bm{\theta})
\bm{\theta}_{t+1}=\bm{\theta}_{t}-\eta\bm{g}_{t}
\eta
\displaystyle\mathbb{E}[\mathcal{L}(\bm{\theta}_{t+1})-\mathcal{L}(\bm{\theta}%
_{t})]\leq\mathbb{E}\left[\langle\nabla\mathcal{L}(\bm{\theta}_{t}),\bm{\theta%
}_{t+1}-\bm{\theta}_{t}\rangle\right]+\frac{L}{2}\mathbb{E}\left[\|\bm{\theta}%
_{t+1}-\bm{\theta}_{t}\|^{2}\right]=-\eta\left(1-\frac{\eta L}{2}\right)%
\mathbb{E}\left[\|\nabla\mathcal{L}(\bm{\theta}_{t})\|^{2}\right]+\frac{\eta^{%
2}L}{2}\mathbb{E}\left[\|\bm{g}_{t}-\bm{g}_{t}^{\prime}\|^{2}+\|\bm{g}_{t}^{%
\prime}-\nabla\mathcal{L}(\bm{\theta}_{t})\|^{2}\right]
\displaystyle\mathbb{E}[\mathcal{L}(\bm{\theta}_{t+1})-\mathcal{L}(\bm{\theta}%
_{t})]
\displaystyle\leq
\displaystyle\mathbb{E}\left[\langle\nabla\mathcal{L}(\bm{\theta}_{t}),\bm{%
\theta}_{t+1}-\bm{\theta}_{t}\rangle\right]+\frac{L}{2}\mathbb{E}\left[\|\bm{%
\theta}_{t+1}-\bm{\theta}_{t}\|^{2}\right]
\displaystyle=
\displaystyle-\eta\left(1-\frac{\eta L}{2}\right)\mathbb{E}\left[\|\nabla%
\mathcal{L}(\bm{\theta}_{t})\|^{2}\right]+\frac{\eta^{2}L}{2}\mathbb{E}\left[%
\|\bm{g}_{t}-\bm{g}_{t}^{\prime}\|^{2}+\|\bm{g}_{t}^{\prime}-\nabla\mathcal{L}%
(\bm{\theta}_{t})\|^{2}\right]
\bm{g}_{t}^{\prime}=\sum_{j=1}^{c}Q_{i,j}\nabla_{\bm{\theta}}\log q(j|x_{i_{t}%
};\bm{\theta})
\|\nabla_{\bm{\theta}}\log q(j|\bm{\xi}_{i};\bm{\theta})\|\leq G
\bm{\theta}
i
\mathbb{E}\left[\|\bm{g}_{t}-\bm{g}_{t}^{\prime}\|^{2}\right]\leq\left(\frac{c%
^{2}}{K}\log\frac{2}{\delta}+\delta\right)G^{2},\quad\mathbb{E}\left[\|\bm{g}_%
{t}^{\prime}-\nabla\mathcal{L}(\bm{\theta}_{t})\|^{2}\right]\leq G^{2}
\delta=c^{2}/K
\mathbb{E}\left[\|\bm{g}_{t}-\bm{g}_{t}^{\prime}\|^{2}\right]\leq\frac{2c^{2}G%
^{2}}{K}\log\frac{2K}{c^{2}}
\mathbb{E}\left[\mathcal{L}(\bm{\theta}_{t+1})-\mathcal{L}(\bm{\theta}_{t})%
\right]\leq-\eta\left(1-\frac{\eta L}{2}\right)\mathbb{E}\left[\|\nabla%
\mathcal{L}(\bm{\theta}_{t})\|^{2}\right]+\frac{\eta^{2}G^{2}L}{2}\left(1+%
\frac{2c^{2}}{K}\log\frac{2K}{c^{2}}\right)
\eta L\leq 1
\mathcal{L}(\bm{\theta}_{t})-\mathcal{L}(\bm{\theta}_{*})\leq\frac{1}{2\gamma}%
\|\nabla\mathcal{L}(\bm{\theta}_{t})\|^{2}
\mathbb{E}\left[\mathcal{L}(\bm{\theta}_{t+1})-\mathcal{L}(\bm{\theta}_{*})%
\right]\leq\left(1-\frac{\eta\gamma}{4}\right)\mathbb{E}\left[\mathcal{L}(\bm{%
\theta}_{t})-\mathcal{L}(\bm{\theta}_{*})\right]+\frac{\eta^{2}G^{2}L}{2}\left%
(1+\frac{2c^{2}}{K}\log\frac{2K}{c^{2}}\right)
\mathbb{E}\left[\mathcal{L}(\bm{\theta}_{t+1})-\mathcal{L}(\bm{\theta}_{*})%
\right]\leq\exp\left(-\frac{\eta\gamma t}{4}\right)\left(\mathcal{L}(\bm{%
\theta}_{0})-\mathcal{L}(\bm{\theta}_{*})\right)+\frac{\eta G^{2}L}{2}\left(1+%
\frac{2c^{2}}{K}\log\frac{2K}{c^{2}}\right)
\bm{\theta}_{1}=\bm{\theta}_{n+1}
\eta=\frac{4}{n\gamma}\log\left(\frac{n\gamma(\mathcal{L}(\bm{\theta}_{0})-%
\mathcal{L}(\bm{\theta}_{*}))}{2G^{2}L(1+2c^{2}/K\log(2K/c^{2}))}\right)
\mathbb{E}\left[\mathcal{L}(\bm{\theta}_{1})-\mathcal{L}(\bm{\theta}_{*})%
\right]\leq\frac{2G^{2}L}{n\gamma}\left(1+\frac{2c^{2}}{K}\log\frac{2K}{c^{2}}%
\right)\log\frac{n\gamma(\mathcal{L}(\bm{\theta}_{0})-\mathcal{L}(\bm{\theta}_%
{*}))}{2G^{2}L(1+2c^{2}/K\log(2K/c^{2}))}=O\left(\frac{\log n}{n\gamma}\right)
\mathcal{L}(\bm{\theta}_{1})-\mathcal{L}(\bm{\theta}_{*})=\frac{1}{n}\sum_{i=1%
}^{n}\sum_{j=1}^{c}q(j|\bm{\xi}_{i};\bm{\theta}_{*})\log\frac{q(j|\bm{\xi}_{i}%
;\bm{\theta}_{1})}{q(j|\bm{\xi}_{i};\bm{\theta}_{*})}=\frac{1}{n}\sum_{i=1}^{n%
}\sum_{j=1}^{c}\mbox{KL}\left(q(\cdot|\bm{\xi}_{i};\bm{\theta}_{*})\|q(\cdot|%
\bm{\xi}_{i};\bm{\theta}_{1})\right)
\mbox{KL}\left(q(\cdot|\bm{\xi}_{i};\bm{\theta}_{*})\|q(\cdot|\bm{\xi}_{i};\bm%
{\theta}_{1})\right)\geq 2\left(\sum_{j=1}^{c}|q(j|\bm{\xi}_{i};\bm{\theta}_{1%
})-q(j|\bm{\xi}_{i};\bm{\theta}_{*})|\right)^{2}
\frac{1}{n}\sum_{i=1}^{n}\mathbb{E}\left[\left(\sum_{j=1}^{c}|q(j|\bm{\xi}_{i}%
;\bm{\theta}_{1})-Q_{i,j}|\right)^{2}\right]\leq\frac{C\log n}{n\gamma}
C=G^{2}L\left(1+\frac{2c^{2}}{K}\log\frac{2K}{c^{2}}\right)\log\frac{\gamma(%
\mathcal{L}(\bm{\theta}_{0})-\mathcal{L}(\bm{\theta}_{*}))}{2G^{2}L(1+2c^{2}/K%
\log(2K/c^{2})}
|q(j|\bm{\xi}_{i};\bm{\theta}_{1})-Q_{i,j}|\leq\sqrt{\frac{C\log n}{n\gamma}}
O(1/\sqrt{K})
n\gg K
Q_{i,j}
\widehat{\mathcal{L}}(\bm{\theta})
Q_{i,j}
P
q(\cdot|\bm{\xi}_{i};\bm{\theta}_{1})
\bm{P}_{i}
p(j|\bm{\xi}_{i};\bm{w})
w\in\mathbb{R}^{d}
\bm{w}_{*}
P_{i,j}=p(j|\bm{\xi}_{i};\bm{w}_{*})
\mathcal{G}(\bm{w})
\mathcal{G}(\bm{w})=\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}P_{i,j}\log p(j|\bm%
{\xi}_{i};\bm{w})
w_{*}
\mathcal{G}(\bm{w})
\mathcal{G}(\bm{w})
L
\gamma
\mathcal{G}(\bm{w})
t
i_{t}
\bm{g}_{t}=y_{i_{t}}\nabla_{\bm{\theta}}\log p(y_{i_{t}}|\bm{\xi}_{i_{t}};\bm{%
\theta}_{t})
\bm{w}_{t+1}=\bm{w}_{t}-\eta\bm{g}_{t}
\mathbb{E}\left[\mathcal{G}(\bm{w}_{n+1})-\mathcal{G}(\bm{w}_{*})\right]\leq O%
\left(\frac{\log n}{n\gamma}\right)
\frac{1}{n}\sum_{i=1}^{n}\mathbb{E}\left[\sum_{j=1}^{c}|p(j|\bm{\xi}_{i};\bm{w%
}_{n+1})-P_{i,j}|^{2}\right]\leq O\left(\sqrt{\frac{\log n}{n\gamma}}\right)
y_{i}
\bm{w}
\widehat{\mathcal{G}}(\bm{w})=\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}%
\underbrace{\left(\frac{1}{|\mathcal{N}(i)|}\sum_{k\in\mathcal{N}(i)}q(j|\bm{%
\xi}_{k};\bm{\theta}_{1})\right)}_{:=\widehat{P}_{i,j}}\log p(j|\bm{\xi}_{i};%
\bm{w})
\widehat{\mathcal{G}}(\bm{w})
\lambda\widehat{\mathcal{G}}(\bm{w})+(1-\lambda)\mathcal{G}(\bm{w})
\bm{w}_{t+1}=\bm{w}_{t}-\eta\nabla\widehat{\mathcal{G}}(\bm{w}_{t})
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{t})]\leq%
-\eta\mathbb{E}\left[\langle\nabla\mathcal{G}(\bm{w}_{t}),\widehat{\mathcal{G}%
}(\bm{w}_{t})\rangle\right]+\frac{\eta^{2}L}{2}\|\nabla\widehat{\mathcal{G}}(%
\bm{w}_{t})\|^{2}=-\frac{\eta}{2}\mathbb{E}[|\nabla\mathcal{G}(\bm{w}_{t})|^{2%
}]-\frac{\eta}{2}(1-\eta L)\mathbb{E}[\|\nabla\widehat{\mathcal{G}}(\bm{w})\|^%
{2}]+\frac{\eta}{2}\mathbb{E}[\|\nabla\mathcal{G}(\bm{w}_{t})-\nabla\widehat{%
\mathcal{G}}(\bm{w}_{t})\|^{2}]
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{t})]
\displaystyle\leq
\displaystyle-\eta\mathbb{E}\left[\langle\nabla\mathcal{G}(\bm{w}_{t}),%
\widehat{\mathcal{G}}(\bm{w}_{t})\rangle\right]+\frac{\eta^{2}L}{2}\|\nabla%
\widehat{\mathcal{G}}(\bm{w}_{t})\|^{2}
\displaystyle=
\displaystyle-\frac{\eta}{2}\mathbb{E}[|\nabla\mathcal{G}(\bm{w}_{t})|^{2}]-%
\frac{\eta}{2}(1-\eta L)\mathbb{E}[\|\nabla\widehat{\mathcal{G}}(\bm{w})\|^{2}%
]+\frac{\eta}{2}\mathbb{E}[\|\nabla\mathcal{G}(\bm{w}_{t})-\nabla\widehat{%
\mathcal{G}}(\bm{w}_{t})\|^{2}]
\displaystyle\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_{t})-\nabla\widehat{%
\mathcal{G}}(\bm{w}_{t})\|^{2}\right]|=\mathbb{E}\left\|\frac{1}{n}\sum_{i=1}^%
{n}\sum_{j=1}^{c}(P_{i,j}-\widehat{P}_{i,j})\nabla\log p(j|\bm{\xi}_{i};\bm{w}%
_{t})\right\|^{2}\leq\frac{G^{2}}{n^{2}}\mathbb{E}\left|\sum_{i=1}^{n}\|\bm{P}%
_{i}-\bm{\widehat{P}}_{i}\|_{1}\right|^{2}\leq\frac{CG^{2}\log n}{n\gamma}
\displaystyle\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_{t})-\nabla\widehat{%
\mathcal{G}}(\bm{w}_{t})\|^{2}\right]|
\displaystyle=
\displaystyle\mathbb{E}\left\|\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}(P_{i,j}-%
\widehat{P}_{i,j})\nabla\log p(j|\bm{\xi}_{i};\bm{w}_{t})\right\|^{2}\leq\frac%
{G^{2}}{n^{2}}\mathbb{E}\left|\sum_{i=1}^{n}\|\bm{P}_{i}-\bm{\widehat{P}}_{i}%
\|_{1}\right|^{2}\leq\frac{CG^{2}\log n}{n\gamma}
\eta L\leq 1
\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{t})]\leq-\frac{\eta}{%
2}\mathbb{E}[\|\nabla\mathcal{G}(\bm{w}_{t})\|^{2}]+\frac{\eta CG^{2}\log n}{n\gamma}
\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{*})]\leq(1-\eta\gamma%
)\mathbb{E}[\mathcal{G}(\bm{w}_{t})-\mathcal{G}(\bm{w}_{*})]+\frac{\eta CG^{2}%
\log n}{n\gamma}
\mathbb{E}[\mathcal{G}(\bm{w}_{t+1}-\mathcal{G}(\bm{w}_{*})]\leq\exp\left(-%
\gamma\eta t\right)\left(\mathcal{G}(\bm{w}_{0})-\mathcal{G}(\bm{w}_{*})\right%
)+\frac{CG^{2}\log n}{n\gamma}
\eta=1/L
t
t=\frac{L}{\gamma}\log\frac{n\gamma(\mathcal{G}(\bm{w}_{0})-\mathcal{G}(\bm{w}%
_{*}))}{CG^{2}\log n}
w^{\prime}
\mathbb{E}[\mathcal{G}(\bm{w}^{\prime})-\mathcal{G}(\bm{w}_{*})]\leq\frac{2CG^%
{2}\log n}{n\gamma}
\bm{w}^{\prime}
\bm{w}
t
i_{t}
\bm{g}_{t}=(1-\lambda)y_{i_{t}}\nabla\log p(y_{i_{t}}|x_{i_{t}};\bm{w}_{t})+%
\lambda\nabla\widehat{\mathcal{G}}(\bm{w}_{t})
\bm{w}_{t+1}=\bm{w}_{t}-\eta\bm{g}_{t}
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w})]\leq-%
\eta\mathbb{E}\left[\langle\nabla\mathcal{G}(\bm{w}_{t}),(1-\lambda)\nabla%
\mathcal{G}(\bm{w}_{t})+\lambda\widehat{\mathcal{G}}(\bm{w}_{t})\right]+\frac{%
\eta^{2}L}{2}\mathbb{E}\left[\|\lambda\nabla\widehat{\mathcal{G}}(\bm{w}_{t})+%
(1-\lambda)\mathcal{G}(\bm{w}_{t})\|^{2}\right]+\frac{\eta^{2}\eta^{2}G^{2}L}{%
2}\leq-\frac{\eta}{2}\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_{t})\|^{2}%
\right]-\frac{\eta}{2}\left(1-\eta L\right)\mathbb{E}\left[\|\lambda\nabla%
\widehat{\mathcal{G}}(\bm{w}_{t})+(1-\lambda)\nabla\mathcal{G}(\bm{w}_{t})\|^{%
2}\right]+\frac{\eta\lambda^{2}}{2}\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_%
{t})-\nabla\widehat{\mathcal{G}}(\bm{w}_{t})\|^{2}\right]+\frac{(1-\lambda)^{2%
}\eta^{2}G^{2}L}{2}
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w})]
\displaystyle\leq
\displaystyle-\eta\mathbb{E}\left[\langle\nabla\mathcal{G}(\bm{w}_{t}),(1-%
\lambda)\nabla\mathcal{G}(\bm{w}_{t})+\lambda\widehat{\mathcal{G}}(\bm{w}_{t})%
\right]+\frac{\eta^{2}L}{2}\mathbb{E}\left[\|\lambda\nabla\widehat{\mathcal{G}%
}(\bm{w}_{t})+(1-\lambda)\mathcal{G}(\bm{w}_{t})\|^{2}\right]+\frac{\eta^{2}%
\eta^{2}G^{2}L}{2}
\displaystyle\leq
\displaystyle-\frac{\eta}{2}\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_{t})\|^%
{2}\right]-\frac{\eta}{2}\left(1-\eta L\right)\mathbb{E}\left[\|\lambda\nabla%
\widehat{\mathcal{G}}(\bm{w}_{t})+(1-\lambda)\nabla\mathcal{G}(\bm{w}_{t})\|^{%
2}\right]+\frac{\eta\lambda^{2}}{2}\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_%
{t})-\nabla\widehat{\mathcal{G}}(\bm{w}_{t})\|^{2}\right]
\displaystyle+\frac{(1-\lambda)^{2}\eta^{2}G^{2}L}{2}
\eta\leq 1/L
\mathbb{E}\left[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{t})\right]\leq-%
\frac{\eta}{2}\mathbb{E}\left[\|\nabla\mathcal{G}(\bm{w}_{t})\|^{2}\right]+%
\frac{(1-\lambda)^{2}\eta^{2}G^{2}L}{2}+\frac{\eta\lambda^{2}}{2}\mathbb{E}%
\left[\|\mathcal{G}(\bm{w}_{t})-\widehat{\mathcal{G}}(\bm{w}_{t})\|^{2}\right]
\displaystyle\|\nabla\mathcal{G}(\bm{w}_{t})-\nabla\widehat{\mathcal{G}}(\bm{w%
}_{t})\|^{2}=\left\|\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}(P_{i,j}-\widehat{P%
}_{i,j})\nabla\log p(j|\bm{\xi}_{i};\bm{w}_{t})\right\|^{2}\leq\frac{G^{2}}{n^%
{2}}\left|\sum_{i=1}^{n}\|\bm{P}_{i}-\bm{\widehat{P}}_{i}\|_{1}\right|^{2}\leq%
\frac{CG^{2}\log n}{n\gamma}
\displaystyle\|\nabla\mathcal{G}(\bm{w}_{t})-\nabla\widehat{\mathcal{G}}(\bm{w%
}_{t})\|^{2}
\displaystyle=
\displaystyle\left\|\frac{1}{n}\sum_{i=1}^{n}\sum_{j=1}^{c}(P_{i,j}-\widehat{P%
}_{i,j})\nabla\log p(j|\bm{\xi}_{i};\bm{w}_{t})\right\|^{2}\leq\frac{G^{2}}{n^%
{2}}\left|\sum_{i=1}^{n}\|\bm{P}_{i}-\bm{\widehat{P}}_{i}\|_{1}\right|^{2}\leq%
\frac{CG^{2}\log n}{n\gamma}
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{t})]\leq%
-\frac{\eta}{2}\mathbb{E}[\|\nabla\mathcal{G}(\bm{w}_{t})\|^{2}]+\frac{(1-%
\lambda)^{2}\eta^{2}G^{2}L}{2}+\frac{\eta CG^{2}\lambda^{2}\log n}{n\gamma}
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{t})]
\displaystyle\leq
\displaystyle-\frac{\eta}{2}\mathbb{E}[\|\nabla\mathcal{G}(\bm{w}_{t})\|^{2}]+%
\frac{(1-\lambda)^{2}\eta^{2}G^{2}L}{2}+\frac{\eta CG^{2}\lambda^{2}\log n}{n\gamma}
\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{*})]\leq\exp\left(-%
\eta\gamma t\right)(\mathcal{G}(\bm{w}^{\prime})-\mathcal{G}(\bm{w}_{*}))+%
\frac{CG^{2}\lambda^{2}\log n}{n\gamma}+\frac{(1-\lambda)^{2}\eta G^{2}L}{2}
\lambda
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{*})]\leq%
\exp\left(-\eta\gamma t\right)(\mathcal{G}(\bm{w}^{\prime})-\mathcal{G}(\bm{w}%
_{*}))+G^{2}\sqrt{\frac{CL\eta\log n}{2n\gamma}}\leq\frac{2CG^{2}\log n}{n%
\gamma}\exp(-\eta\gamma t)+G^{2}\sqrt{\frac{CL\eta\log n}{2n\gamma}}
\displaystyle\mathbb{E}[\mathcal{G}(\bm{w}_{t+1})-\mathcal{G}(\bm{w}_{*})]
\displaystyle\leq
\displaystyle\exp\left(-\eta\gamma t\right)(\mathcal{G}(\bm{w}^{\prime})-%
\mathcal{G}(\bm{w}_{*}))+G^{2}\sqrt{\frac{CL\eta\log n}{2n\gamma}}
\displaystyle\leq
\displaystyle\frac{2CG^{2}\log n}{n\gamma}\exp(-\eta\gamma t)+G^{2}\sqrt{\frac%
{CL\eta\log n}{2n\gamma}}
t=n
\eta=O\left(\frac{\log\log n}{n\gamma}\right)
\mathbb{E}[\mathcal{G}(\bm{w}_{n+1})-\mathcal{G}(\bm{w}_{*})]\leq O\left(\frac%
{1}{n\gamma}\sqrt{\log n\log\log n}\right)
y_{i}
\sqrt{\log n/\log\log n}
