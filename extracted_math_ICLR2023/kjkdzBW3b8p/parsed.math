d_{\pi}
\pi
\pi
\pi
d_{\pi}.
d_{\pi}
\pi
d_{\pi}
(S,A,P,R)
(S,A,P,R,\gamma,D_{0})
s_{0}\sim D_{0}
t
s_{t}
a_{t}
\pi(s_{t},\cdot),
r_{t}\sim R(s_{t},a_{t})
s_{t+1}\sim P(\cdot,s_{t},a_{t})
v^{\mathrm{avg}}_{\pi}=\lim_{T\rightarrow\infty}\tfrac{1}{T}\mathbb{E}\text{%
\scriptsize$\sum$}_{t=1}^{T}r_{t},v^{\mathrm{\gamma}}_{\pi}=(1-\gamma)\mathbb{%
E}\text{\scriptsize$\sum$}_{t=1}^{\infty}\gamma^{t}r_{t},
v^{\mathrm{avg}}_{\pi}
v^{\mathrm{\gamma}}_{\pi}
\mathbb{P}_{\pi}(s_{t}=\cdot)
t
\pi
d_{\pi}
d_{\pi}^{\mathrm{avg}}(s,a)=\lim_{T\rightarrow\infty}\tfrac{1}{T}\mathbb{E}%
\sum\nolimits_{t=1}^{T}\mathbb{P}_{\pi}(s_{t}=s)\pi(s,a),
d_{\pi}^{\mathrm{\gamma}}(s,a)=(1-\gamma)\mathbb{E}\sum\nolimits_{t=1}^{\infty%
}\gamma^{t}\mathbb{P}_{\pi}(s_{t}=s)\pi(s,a),
\max_{d_{\pi}\in\mathcal{K}}\sum_{s,a}r(s,a)d_{\pi}(s,a),
\mathcal{K}
\min_{d_{\pi}\in\mathcal{K}}f(d_{\pi}),
f:\mathcal{K}\rightarrow\mathbb{R}
f
\min_{d_{\pi}\in\mathcal{K}}f(d_{\pi})=\max_{\lambda\in\Lambda}\min_{d_{\pi}%
\in\mathcal{K}}\left(\lambda\cdot d_{\pi}-f^{*}(\lambda)\right)
\Lambda
\{\partial f(d_{\pi})|d_{\pi}\in\mathcal{K}\},
f^{*}
f
\text{Alg}_{\pi}
\text{Alg}_{\lambda}
d_{\pi}.
r=-\lambda.
\text{Alg}_{\pi}
\{\pi^{k}\}_{k\in\mathbb{N}}
\{-\lambda^{k}\}_{k\in\mathbb{N}}
\text{Alg}_{\lambda}
k
\lambda^{k}=\nabla f(\bar{d}^{k-1}_{\pi}).
k
f
\bar{d}^{k-1}_{\pi}
f
\bar{d}_{\pi}^{K}=\frac{1}{K}\sum_{k=1}^{K}d^{k}_{\pi}
\bar{d}_{\pi}^{K}\rightarrow d_{\pi}^{\star}\in\arg\min_{d_{\pi}\in\mathcal{K}%
}f(d_{\pi})
\phi(s,a)\in\mathbb{R}^{d}
\phi
\psi_{\pi}(s,a)=\mathbb{E}_{s^{\prime},a^{\prime}\sim d_{\pi}(s,a)}\,\phi(s^{%
\prime},a^{\prime})\in\mathbb{R}^{d}.
\psi_{\pi}
\psi_{\pi}^{\gamma}\in\mathbb{R}^{d}
\psi_{\pi}^{\mathrm{avg}}\in\mathbb{R}^{d}
n
\Pi^{n}=\{\pi^{i}\}_{i=1}^{n}
\max_{\Pi^{n}}\enspace\text{Diversity}(\Pi^{n})\enspace\text{s.t}\enspace d_{%
\pi}\cdot r_{e}\geq\alpha v_{e}^{*},\enspace\forall\pi\in\Pi^{n},
v_{e}^{*}
\text{Diversity}:\{\mathbb{R}^{|S||A|}\}^{n}\rightarrow\mathbb{R}.
\alpha\in[0,1]
\alpha v_{e}^{*}
\mu^{1}=1
v_{e}^{*}
v_{e}^{*}=v_{e}^{1}
v_{e}^{*}=\max_{i}v_{e}^{i}
\max_{i}v_{e}^{i}=v_{e}^{0}
0
r^{i}_{d}=\nabla_{d_{\pi}^{i}}\text{Diversity}(d_{\pi}^{1},\ldots,d_{\pi}^{n}).
c^{i}_{e}
c^{i}_{d}
\pi^{1},\ldots,\pi^{n},
r^{i}
r_{e}
r_{d}^{i}:
r^{i}(s,a)=c^{i}_{e}r_{e}(s,a)+c^{i}_{d}r^{i}_{d}(s,a).
\max_{\pi^{1},\pi^{2}}||\psi^{1}-\psi^{2}||^{2}_{2}.
\min_{\psi}||\psi-\psi^{E}||^{2}_{2}
\psi^{E}
\Pi^{n}
D,C
\text{Dist}(D,C)=\min_{c\in C,d\in D}||c-d||^{2}_{2}.
\psi^{i}
\min_{j\neq i}||\psi^{i}-\psi^{j}||^{2}_{2}.
\max_{d_{\pi}^{1},\ldots,d_{\pi}^{n}}0.5\sum\nolimits_{i=1}^{n}\min_{j\neq i}|%
|\psi^{i}-\psi^{j}||^{2}_{2}.
r^{i}_{d}=\nabla_{d_{\pi}^{i}}\text{Diversity}(d_{\pi}^{1},\ldots,d_{\pi}^{n}).
r=\nabla_{d_{\pi}^{1}}||\psi^{1}-\psi^{2}||^{2}_{2}=\nabla_{d_{\pi}^{1}}||%
\mathbb{E}_{s^{\prime},a^{\prime}\sim d_{\pi}^{1}(s,a)}\phi(s,a)-\mathbb{E}_{s%
^{\prime},a^{\prime}\sim d_{\pi}^{2}(s,a)}\phi(s,a)||^{2}_{2}=\phi\cdot(\psi^{%
1}-\psi^{2}),
r(s,a)=\phi(s,a)\cdot(\psi^{1}-\psi^{2})
\pi^{i}
j^{*}_{i}
\pi^{i}
j^{*}_{i}=\arg\min_{j\neq i}||\psi^{i}-\psi^{j}||^{2}_{2}.
j^{*}_{i}
\arg\min
\nabla_{d_{\pi}^{i}}\min_{j\neq i}||\psi^{i}-\psi^{j}||^{2}_{2}=\nabla_{d_{\pi%
}^{i}}||\psi^{i}-\psi^{j^{*}_{i}}||^{2}_{2},
r_{d}^{i}(s,a)=\phi(s,a)\cdot(\psi^{i}-\psi^{j^{*}_{i}}).
\ell_{0}
\ell_{0}
\ell_{0}.
\ell_{i}=||\psi^{i}-\psi^{j^{*}_{i}}||_{2}
i.
\max_{d_{\pi}^{1},\ldots,d_{\pi}^{n}}\sum\nolimits_{i=1}^{n}\quad\underset{%
\text{Repulsive}}{\underbrace{0.5\ell_{i}^{2}}}\quad\underset{\text{Attractive%
}}{\underbrace{-0.2\big{(}\ell_{i}^{5}/\ell_{0}^{3}\big{)}}}.
\ell_{i},
\ell_{i}<<\ell_{0}
\ell_{i}>>\ell_{0}
r_{d}^{i}(s,a)=(1-(\ell_{i}/\ell_{0})^{3})\phi(s,a)\cdot(\psi^{i}-\psi^{j^{*}_%
{i}}).
1
\ell_{0}
\min_{d_{\pi}\in\mathcal{K}}f(d_{\pi}),
g(d_{\pi})\leq 0,
f
g
g(d_{\pi})=\alpha v_{e}^{*}-d_{\pi}\cdot r_{e}
\displaystyle\min_{d_{\pi}\in\mathcal{K}}\max_{\mu\geq 0}\quad f(d_{\pi})+\mu g%
(d_{\pi})=\min_{d_{\pi}\in\mathcal{K}}\max_{\mu\geq 0,\lambda}\lambda\cdot d_{%
\pi}-f^{*}(\lambda)+\mu(\alpha v_{e}^{*}-d_{\pi}\cdot r_{e}),
\displaystyle\min_{d_{\pi}\in\mathcal{K}}\max_{\mu\geq 0}\quad f(d_{\pi})+\mu g%
(d_{\pi})=\min_{d_{\pi}\in\mathcal{K}}\max_{\mu\geq 0,\lambda}\lambda\cdot d_{%
\pi}-f^{*}(\lambda)+\mu(\alpha v_{e}^{*}-d_{\pi}\cdot r_{e}),
\lambda
k,
\lambda^{k},
r_{d}.
\lambda-\mu r_{e}
d_{\pi}
r_{d}+\mu r_{e}.
\mu
\mu(\alpha v_{e}^{*}-d_{\pi}\cdot r_{e})
\mu
d_{\pi}
\lambda
\mu
\max_{\Pi^{n}}\enspace c_{e}d_{\pi}^{i}\cdot r_{e}+c_{d}\text{Diversity}(d_{%
\pi}^{1},\ldots,d_{\pi}^{n}),
c_{e},c_{d}
\mu^{*},
\max_{\Pi^{n}}\enspace\max(0,\alpha v_{e}^{*}-d_{\pi}^{i}\cdot r_{e})+c_{d}%
\text{Diversity}(d_{\pi}^{1},\ldots,d_{\pi}^{n}).
I^{i}
\pi^{i}
I^{i}=1
d_{\pi}^{i}\cdot r_{e}<\alpha v_{e}^{*},
0
\text{{Reverse SMERL:} }r^{i}(s,a)=I^{i}r_{e}(s,a)+c_{d}r^{i}_{d}(s,a)
\text{{SMERL:} }r^{i}(s,a)=r_{e}(s,a)+c_{d}(1-I^{i})r^{i}_{d}(s,a)
c_{d}
\alpha
38
223-
z\in[1,n]
\tilde{v}^{\mathrm{avg}}_{\pi^{i}}
\phi_{obs}
\phi_{embedding}
\tilde{\psi}^{\mathrm{avg}}_{\pi^{i}}
\tilde{x}^{i}=\alpha_{d}\tilde{x}^{i-1}+(1-\alpha_{d})\frac{1}{T}\sum\nolimits%
_{t=1}^{T}x^{i}(s_{t},a_{t})
\alpha_{d}
\alpha_{d}
\alpha_{d}
\alpha_{d}
\tilde{\psi}^{\mathrm{avg}}_{\pi^{i}}
\tilde{v}^{\mathrm{avg}}_{\pi^{i}}
\mu
0.9
1
95\%
5
\alpha
\alpha
\ell_{0}=1
\ell_{0}
\alpha
\alpha
\alpha
\ell_{0}=1
\ell_{0}
\alpha
\alpha
\alpha,
\ell_{0}
10.
\ell_{0}
\alpha
\alpha
c_{e}
c_{d}=1-c_{e}
\alpha
c_{d}
c_{d}
\alpha
\alpha
c_{e}
\alpha
c_{e}
c_{e}
\alpha
c_{d}
c_{d}
\phi_{\text{obs}}
\phi_{\text{embedding}}
1.21\pm 0.05
1.01\pm 0.05
2.14\pm 0.09
2.35\pm 0.09
k
50
T=10
k=10
40
r_{\text{method}}
\nicefrac{{r_{\text{method}}}}{{r_{\text{baseline}}}},
r_{\text{baseline}}
r_{\text{method}},r_{\text{baseline}}
20
95\%
10
\alpha=0.9
c_{d}=0.5
c_{e}=0.7
r_{\text{baseline}}
10
1.5-2.0
\pi
\ell_{0}
\pi
\pi(s,a)=\frac{d_{\pi}(s,a)}{\sum_{a}d_{\pi}(s,a)}
z
z
[1,n]
\mu^{i}=\sigma^{-1}(0.5),\forall i\in[2,n],
\sigma^{-1}
\mu^{1}=1;
\tilde{v}^{\mathrm{avg}}_{\pi^{i}}=0.,\forall i\in[1,n]
\tilde{\psi}^{\mathrm{avg}}_{\pi^{i}}=\bar{1}/d,\forall i\in[1,n]
n
d
\phi
\mu
r(s,a)=\sigma(\mu^{i})r_{e}(s,a)+(1-\sigma(\mu^{i}))r_{d}^{i}(s,a),
\mu
\sigma(\mu)(\alpha v_{e}^{*}-d_{\pi}\cdot r_{e}).
T
\sim 5\%
v_{e}^{i}
d_{\pi}\cdot r_{e},
\tilde{v}^{\mathrm{avg}}_{\pi^{i}}.
\ell_{2}
\text{td}_{d}^{2}+\text{td}_{e}^{2}
\delta=\sigma(\mu^{i})\delta_{e}+(1-\sigma(\mu^{i}))\delta_{d}
\alpha
\alpha
\mu
\mu^{1}=1.
\theta
\mu
\left\{\tilde{v}^{\mathrm{avg}}_{\pi^{i}}\right\}_{i=1}^{n}
\left\{\tilde{\psi}^{\mathrm{avg}}_{\pi^{i}}\right\}_{i=1}^{n}
m
\left\{\tau_{j}\right\}_{j=1}^{m}
T,
\tau_{j}=\left\{z^{j},x^{j}_{s},a^{j}_{s},r^{j}_{s},\phi^{j}_{s},\mu(a^{j}_{s}%
|x^{j}_{s})\right\}_{s=1}^{T},
\mu(a^{j}_{s}|x^{j}_{s})
a^{j}_{s}
x^{i}_{s}
\mu(a|x).
\{\pi(a^{j}_{s}|x^{j}_{s}),v_{e}(x^{j}_{s}),v_{d}(x^{j}_{s})\}\leftarrow\text{%
Network}(\left\{\tau_{j}\right\}_{j=1}^{m})
\text{td}_{e}(x^{j}_{s}),\delta_{e}(x^{j}_{s})\leftarrow\text{V-trace}
r^{j}_{s}
v_{e}(x^{j}_{s})
r_{d}^{i}(x^{j}_{s})
\tilde{\psi}^{\mathrm{avg}}_{\pi^{z}},z,\phi^{j}_{s}
\text{td}_{d}(x^{j}_{s}),\delta_{d}(x^{j}_{s})\leftarrow\text{V-trace}
r^{j}_{s}
v_{d}(x^{j}_{s})
\delta(x^{j}_{s})=\sigma(\mu^{i})\delta_{e}(x^{j}_{s})+(1-\sigma(\mu^{i}))%
\delta_{d}(x^{j}_{s})
\sum_{s,j}b_{v}(\text{td}_{e}(x^{j}_{s})^{2}+\text{td}_{d}(x^{j}_{s})^{2})+b_{%
\pi}\log(\pi(a^{j}_{s}|x^{j}_{s}))\delta(x^{j}_{s})+b_{\text{Ent}}\text{%
Entropy}(\pi(a^{j}_{s}|x^{j}_{s}))
\sum_{i=1}^{n}\sigma(\mu^{i})(\tilde{v}^{\mathrm{avg}}_{\pi^{i}}-\alpha\tilde{%
v}^{\mathrm{avg}}_{\pi^{1}})
\tilde{v}^{\mathrm{avg}}_{\pi^{i}}=\alpha_{d}^{\tilde{v}^{avg}}\tilde{v}^{%
\mathrm{avg}}_{\pi^{i}}+(1-\alpha_{d}^{\tilde{v}^{avg}})r_{t},\quad\tilde{\psi%
}^{\mathrm{avg}}_{\pi^{i}}=\alpha_{d}^{\tilde{\psi}^{avg}}\tilde{\psi}^{%
\mathrm{avg}}_{\pi^{i}}+(1-\alpha_{d}^{\tilde{\psi}^{avg}})\phi_{t}
\left\{\tilde{v}^{\mathrm{avg}}_{\pi^{i}}\right\}_{i=1}^{n}
\left\{\tilde{\psi}^{\mathrm{avg}}_{\pi^{i}}\right\}_{i=1}^{n}
f_{1},\ldots,f_{T}
f_{n},\ldots,f_{n+m}
1/p
f_{n},f_{n+p},f_{n+2p}\ldots,
10^{-5}
5\times 10^{7}
5\times 10^{5}
10^{-4}
2\times 10^{7}
0.99
b_{\text{Ent}}
0.01
b_{\pi}
1.0
b_{v}
1.0
600
6
40
\alpha
0.9
0.7
0.5
0.5
10^{-3}
10^{-3}
\tilde{v}^{\mathrm{avg}}_{\pi^{i}}
\alpha_{d}^{\tilde{v}^{avg}}
0.9
0.999
\tilde{\psi}^{\mathrm{avg}}_{\pi^{i}}
\alpha_{d}^{\tilde{\psi}^{avg}}
0.99
0.9999
0.9
\ell_{2}
i
\pi^{i}
j=j^{*}_{i}=\arg\min_{j\neq i}||\psi^{i}-\psi^{j}||^{2}_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
95\%
5
\ell_{0}
\ell_{0}
c_{d}
c_{d}
\alpha
c_{d}
0.5
\alpha
c_{d}
0.5
T
\psi^{\gamma}
\psi^{avg}
\psi^{\gamma}
\psi^{avg}
r=r_{d}+r_{e}
r_{d}
\ell_{0}
\ell_{0}
\ell_{0}=0.25
0.25
\ell_{0}
\ell_{0}
10
\ell_{0}
\ell_{0}
\ell_{0}
\ell_{0}
\alpha
\alpha
\alpha
\alpha
\alpha
\lambda
v_{e}^{i}\sim\alpha v_{e}^{*}
v_{e}^{i}>\alpha v_{e}^{*}
v_{e}^{i}=\alpha v_{e}^{*}
\alpha
v_{e}^{i}\geq\alpha v_{e}^{*}
\alpha=0.9
\alpha=0.5
r_{\text{method}}
r_{\text{method}}/r_{\text{baseline}}
r_{\text{baseline}}
10
10
\alpha=0.9
c_{d}\in[0.5,1,2,5]
c_{e}\in[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.9]
10
c_{d}=1
c_{d}
c_{d}
c_{d}=0.5
1
K
K
10
K
30
\text{leg}_{1}=((w_{1}^{1},h_{1}^{1}),(w_{1}^{2},h_{1}^{2}))
\text{leg}_{2}=((w_{2}^{1},h_{2}^{1}),(w_{2}^{2},h_{2}^{2}))
[0,\eta]
\ell_{i}^{j},\nu_{i}^{j}\sim[-\eta,\eta]
i=1,2
j=1,2
\widetilde{\text{leg}}_{1}=(((1+\ell_{1}^{1})w_{1}^{1},(1+\nu_{1}^{1})h_{1}^{1%
}),((1+\ell_{1}^{2})w_{1}^{2},(1+\nu_{1}^{2})h_{1}^{2}))
\widetilde{\text{leg}}_{2}=(((1+\ell_{2}^{1})w_{1}^{1},(1+\nu_{2}^{1})h_{1}^{1%
}),((1+\ell_{2}^{2})w_{1}^{2},(1+\nu_{2}^{2})h_{1}^{2}))
\eta
0.
0.10
0.15
0.20
0.25
0.30
0.35
0.
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.
0.
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.
0.
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.
[0,\eta]
5
10
\eta
30
40
10
30
\ell_{0}
\ell_{0}
\ell_{0}
\ell_{0}
