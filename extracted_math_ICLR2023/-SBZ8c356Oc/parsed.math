\mathcal{X}\subset\mathbb{R}^{d}
\mathcal{Y}=\left\{1,\cdots,C\right\}
f_{\bm{\theta}}:\mathcal{X}\rightarrow\mathbb{R}^{C}
\bm{\theta}
\mathbf{p}_{\bm{\theta}}(\cdot|\bm{x})=\operatorname{softmax}(f_{\bm{\theta}}(%
\bm{x}))
F_{\bm{\theta}}(\bm{x})=\underset{c}{\operatorname{argmax}}[f_{\bm{\theta}}(%
\bm{x})]_{c},
\mathcal{B}_{p}(\bm{x},\varepsilon)=\left\{\bm{x}^{\prime}\in\mathcal{X}:%
\lVert\bm{x}-\bm{x}^{\prime}\rVert_{p}\leq\varepsilon\right\}
\mathbbm{1}(\cdot)
\mathbf{X,Y}
\bm{x},y
\mathcal{R}_{\text{rob}}(\theta):=\mathbb{E}_{\mathbf{(X,Y)}}\;\underset{%
\mathbf{X^{\prime}}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon)}{\max\;\;\;}%
\mathbbm{1}\left\{F_{\bm{\theta}}(\mathbf{X^{\prime}})\neq\mathbf{Y}\right\},
\mathbf{X}
\mathbf{Y}
\mathcal{X}
\mathcal{Y}
\bm{\theta}
\bm{x}^{\text{adv}}:=\underset{\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},%
\varepsilon)}{\operatorname{argmax}\;\;\;}\mathbbm{1}\left\{F_{\theta}(\bm{x^{%
\prime}})\neq y\right\}.
\ell(\bm{x}^{\prime}|\theta,\bm{x},y)
\mathbbm{1}\left\{F_{\theta}(\bm{x^{\prime}})\neq y\right\}
\bm{\theta},\bm{x},y
\ell
\bm{x}^{\prime}
\mathcal{B}_{\infty}(\bm{x},\varepsilon).
\footnotesize\bm{x}^{(m+1)}=\bm{\Pi}_{\mathcal{B}_{\infty}(\bm{x},\varepsilon)%
}\left(\bm{x}^{(m)}+\eta\operatorname{sgn}\left(\nabla_{\bm{x}^{(m)}}\ell(\bm{%
x}^{(m)}|\bm{\theta},\bm{x},y)\right)\right),
\eta>0
\bm{\Pi}_{\mathcal{B}_{\infty}(\bm{x},\varepsilon)}(\cdot)
\mathcal{B}_{\infty}(\bm{x},\varepsilon)
\bm{x}^{(0)}=\bm{x}
\bm{x}^{\text{pgd}}
\bm{x}^{\text{pgd}}:=\lim\limits_{m\rightarrow\infty}\bm{x}^{(m)}
\widehat{\bm{x}}^{\text{pgd}}=\bm{x}^{(M)}
M
\ell
\left\{\bm{x}_{i},\tilde{y}_{i}\right\}_{i=1}^{n}
\tilde{y}_{i}
\bm{x}_{i}
\bm{\theta}
\bm{\theta}
\bm{\widehat{x}}^{\text{pgd}}_{i}
(\bm{x}_{i},y_{i})
\bm{\theta}
\sum\limits_{i=1}^{n}\ell_{\text{ce}}(f_{\bm{\theta}}(\bm{\widehat{x}}^{\text{%
pgd}}_{i}),y_{i}),
\ell_{\text{ce}}
\sum\limits_{i=1}^{n}w_{\theta}(\bm{x}_{i},y_{i})\ell_{\text{ce}}(f_{\bm{%
\theta}}(\widehat{\bm{x}}^{\text{pgd}}_{i}),y_{i}),
\kappa_{\theta}(\bm{x}_{i},y_{i})=\min\left(\min(\{t:F_{\bm{\theta}}(\bm{x}_{i%
}^{(t)})\neq y_{i}\}),T\right)
T
w_{\theta}(\bm{x}_{i},y_{i})=(1+\operatorname{tanh}(5(1-2\kappa_{\theta}(\bm{x%
}_{i},y_{i})/T)))/2
\displaystyle\mathcal{R}_{\text{rob}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}%
\mathbbm{1}\left\{\exists\mathbf{X}^{\prime}\in\mathcal{B}_{p}(\mathbf{X},%
\varepsilon):F_{\bm{\theta}}(\mathbf{X}^{\prime})\neq Y\right\},
\displaystyle\mathcal{R}_{\text{rob}}(\bm{\theta})
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{\exists\mathbf{X}^{%
\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon):F_{\bm{\theta}}(\mathbf{X}^{%
\prime})\neq Y\right\},
\displaystyle\mathcal{R}_{\text{nat}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}%
\mathbbm{1}\left\{F_{\bm{\theta}}(\mathbf{X})\neq Y\right\},
\displaystyle\mathcal{R}_{\text{nat}}(\bm{\theta})
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq Y\right\},
\displaystyle\mathcal{R}_{\text{bdy}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}%
\mathbbm{1}\{\exists\mathbf{X}^{\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon)
\displaystyle\mathcal{R}_{\text{bdy}}(\bm{\theta})
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\{\exists\mathbf{X}^{%
\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon)
\displaystyle\qquad\qquad\;:F_{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(%
\mathbf{X}^{\prime}),F_{\bm{\theta}}(\mathbf{X})=Y\}.
\displaystyle\qquad\qquad\;:F_{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(%
\mathbf{X}^{\prime}),F_{\bm{\theta}}(\mathbf{X})=Y\}.
\mathcal{R}_{\text{rob}}(\bm{\theta})=\mathcal{R}_{\text{nat}}(\bm{\theta})+%
\mathcal{R}_{\text{bdy}}(\bm{\theta}).
\mathcal{R}_{\text{bdy}}(\bm{\theta})
\sum\limits_{i=1}^{n}\left\{\ell_{\text{ce}}(f_{\theta}(\bm{x}_{i}),y_{i})+%
\lambda\cdot\operatorname{KL}(\mathbf{p}_{\theta}(\cdot|\bm{x}_{i})\lVert%
\mathbf{p}_{\theta}(\cdot|\widehat{\bm{x}}^{\text{pgd}}_{i}))\right\},
\displaystyle\sum_{i=1}^{n}\Bigg{\{}\ell_{\text{ce}}\left(f_{\bm{\theta}}\left%
(\bm{x}_{i}\right),y_{i}\right)+\lambda\cdot\operatorname{KL}\left(\mathbf{p}_%
{\theta}\left(\cdot|\bm{x}_{i}\right)\|\mathbf{p}_{\theta}(\cdot|\widehat{\bm{%
x}}^{\text{pgd}}_{i})\right)
\displaystyle\sum_{i=1}^{n}\Bigg{\{}
\displaystyle\ell_{\text{ce}}\left(f_{\bm{\theta}}\left(\bm{x}_{i}\right),y_{i%
}\right)+\lambda\cdot\operatorname{KL}\left(\mathbf{p}_{\theta}\left(\cdot|\bm%
{x}_{i}\right)\|\mathbf{p}_{\theta}(\cdot|\widehat{\bm{x}}^{\text{pgd}}_{i})\right)
\displaystyle+\gamma\ell_{\text{ce}}\left(f_{\bm{\theta}}(\bm{x}_{i}^{\text{%
helper}}),F_{\bm{\theta}_{\text{pre}}}(\widehat{\bm{x}}^{\text{pgd}}_{i})%
\right)\Bigg{\}},
\displaystyle+\gamma\ell_{\text{ce}}\left(f_{\bm{\theta}}(\bm{x}_{i}^{\text{%
helper}}),F_{\bm{\theta}_{\text{pre}}}(\widehat{\bm{x}}^{\text{pgd}}_{i})%
\right)\Bigg{\}},
\bm{\theta}_{\text{pre}}
\bm{x}_{i}^{\text{helper}}=\bm{x}_{i}+2(\widehat{\bm{x}}^{\text{pgd}}_{i}-\bm{%
x}_{i})
\displaystyle\sum\limits_{i=1}^{n}\bigg{\{}\ell_{\text{margin}}(f_{\bm{\theta}%
}(\widehat{\bm{x}}^{\text{pgd}}_{i}),y_{i})
\displaystyle\sum\limits_{i=1}^{n}\bigg{\{}
\displaystyle\ell_{\text{margin}}(f_{\bm{\theta}}(\widehat{\bm{x}}^{\text{pgd}%
}_{i}),y_{i})
\displaystyle+\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}}(\cdot|\bm%
{x}_{i})\lVert\mathbf{p}_{\bm{\theta}}(\cdot|\bm{\widehat{x}}^{\text{pgd}}_{i}%
))(1-p_{\bm{\theta}}(y_{i}|\bm{x}_{i}))\bigg{\}},
\displaystyle+\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}}(\cdot|\bm%
{x}_{i})\lVert\mathbf{p}_{\bm{\theta}}(\cdot|\bm{\widehat{x}}^{\text{pgd}}_{i}%
))(1-p_{\bm{\theta}}(y_{i}|\bm{x}_{i}))\bigg{\}},
\ell_{\text{margin}}(f_{\bm{\theta}}(\widehat{\bm{x}}^{\text{pgd}}_{i}),y_{i})%
=-\log p_{\bm{\theta}}(y_{i}|\widehat{\bm{x}}^{\text{pgd}}_{i})-\log(1-%
\underset{k\neq y_{i}}{\max}\;p_{\bm{\theta}}(k|\widehat{\bm{x}}^{\text{pgd}}_%
{i}))
f_{\bm{\theta}}
z(\cdot)
\mathcal{X}
\mathcal{X}
z(\bm{x})\in\underset{\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},\varepsilon)}{%
\operatorname{argmax}}\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{%
\theta}}(\bm{x}^{\prime})\right).
\bm{x}\in\mathcal{X}
\displaystyle\mathcal{R}_{\text{rob}}(\bm{\theta})\leq\mathbb{E}_{(\mathbf{X},%
Y)}\mathbbm{1}(Y\neq F_{\bm{\theta}}(\mathbf{X}))
\displaystyle\mathcal{R}_{\text{rob}}(\bm{\theta})\leq\mathbb{E}_{(\mathbf{X},%
Y)}\mathbbm{1}(Y\neq F_{\bm{\theta}}(\mathbf{X}))
\displaystyle+\mathbb{E}_{(\mathbf{X},Y)}{\mathbbm{1}(F_{\bm{\theta}}(\mathbf{%
X})\neq F_{\bm{\theta}}(z(\mathbf{X})))}\mathbbm{1}\left\{p_{\bm{\theta}}(Y|z(%
\mathbf{X}))<1/2\right\}
\displaystyle+\mathbb{E}_{(\mathbf{X},Y)}{\mathbbm{1}(F_{\bm{\theta}}(\mathbf{%
X})\neq F_{\bm{\theta}}(z(\mathbf{X})))}\mathbbm{1}\left\{p_{\bm{\theta}}(Y|z(%
\mathbf{X}))<1/2\right\}
\mathcal{R}_{\text{rob}}(\bm{\theta})\leq\mathbb{E}_{(\mathbf{X},Y)}\phi(Yf_{%
\bm{\theta}}(\mathbf{X}))+\mathbb{E}_{\mathbf{X}}{\phi(f_{\bm{\theta}}(\mathbf%
{X})f_{\bm{\theta}}(z(\mathbf{X})))},
z(\bm{x})\in\underset{\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},\varepsilon)}{%
\operatorname{argmax}}\phi\left(f_{\bm{\theta}}(\bm{x})f_{\bm{\theta}}(\bm{x}^%
{\prime})\right)
\phi(\cdot)
\mathbbm{1}(\cdot<0).
\phi(\cdot)
f_{\bm{\theta}}
\mathbbm{1}(\cdot<0)
F_{\bm{\theta}},
\mathbbm{1}\left\{p_{\bm{\theta}}(Y|z(\mathbf{X}))<1/2\right\}
f_{\bm{\theta}}
\mathcal{D}=\{(\bm{x}_{i},y_{i})\}_{i=1}^{n}
\eta
\varepsilon
M
\lambda
\alpha
T
B
K
f_{\bm{\theta}}
t=1,\cdots,T
b=1,\cdots,B
k=1,\cdots,K
\widehat{\bm{x}}^{\text{pgd}}_{b,k}
\displaystyle\bm{\theta}\leftarrow\bm{\theta}-\eta\frac{1}{K}\nabla_{\bm{%
\theta}}\mathcal{R}_{\text{ARoW}}({\bm{\theta}}\;;\{(\bm{x}_{k},y_{k})\}^{K}_{%
k=1},\lambda,\alpha)
\displaystyle\bm{\theta}\leftarrow\bm{\theta}-\eta\frac{1}{K}\nabla_{\bm{%
\theta}}
\displaystyle\mathcal{R}_{\text{ARoW}}({\bm{\theta}}\;;\{(\bm{x}_{k},y_{k})\}^%
{K}_{k=1},\lambda,\alpha)
f_{\bm{\theta}}
z(\bm{x})
\widehat{\bm{x}}^{\text{pgd}}
\mathbbm{1}(Y\neq F_{\bm{\theta}}(\mathbf{X}))
\ell^{\text{LS}}(f_{\bm{\theta}}(\bm{x}),y)=-{\bm{y}_{\alpha}^{\text{LS}}}^{%
\top}\log\mathbf{p}_{\theta}(\cdot|\bm{x})
\alpha>0,
\bm{y}_{\alpha}^{\text{LS}}=(1-\alpha)\mathbf{u}_{y}+\frac{\alpha}{C}\mathbf{1%
}_{C}
\mathbf{u}_{y}\in\mathbb{R}^{C}
y
\mathbf{1}_{C}\in\mathbb{R}^{C}
\mathbbm{1}(F_{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X})))
\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}}(\cdot|\mathbf{X})||%
\mathbf{p}_{\bm{\theta}}(\cdot|\widehat{\mathbf{X}}^{\text{pgd}}))
\lambda>0;
\mathbbm{1}\left\{p_{\bm{\theta}}(Y|z(\mathbf{X}))<1/2\right\}
2(1-p_{\bm{\theta}}(Y|\widehat{\mathbf{X}}^{\text{pgd}}));
\displaystyle\mathcal{R}_{\text{ARoW}}(\bm{\theta};\left\{(\bm{x}_{i},y_{i})%
\right\}_{i=1}^{n},\lambda)
\displaystyle\mathcal{R}_{\text{ARoW}}(\bm{\theta};\left\{(\bm{x}_{i},y_{i})%
\right\}_{i=1}^{n},\lambda)
\displaystyle:=\sum\limits_{i=1}^{n}\bigg{\{}\ell^{\text{LS}}(f_{\bm{\theta}}(%
\bm{x}_{i}),y_{i})
\displaystyle:=\sum\limits_{i=1}^{n}\bigg{\{}\ell^{\text{LS}}(f_{\bm{\theta}}(%
\bm{x}_{i}),y_{i})
\displaystyle+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}}(\cdot|%
\bm{x}_{i})||\mathbf{p}_{\bm{\theta}}(\cdot|\widehat{\bm{x}}^{\text{pgd}}_{i})%
)\cdot(1-p_{\bm{\theta}}(y_{i}|\widehat{\bm{x}}^{\text{pgd}}_{i}))\bigg{\}}.
\displaystyle+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}}(\cdot|%
\bm{x}_{i})||\mathbf{p}_{\bm{\theta}}(\cdot|\widehat{\bm{x}}^{\text{pgd}}_{i})%
)\cdot(1-p_{\bm{\theta}}(y_{i}|\widehat{\bm{x}}^{\text{pgd}}_{i}))\bigg{\}}.
\lambda>0
\mathcal{R}_{\text{nat}}(\bm{\theta})+\lambda\mathcal{R}_{\text{bdy}}(\bm{%
\theta}).
\mathbbm{1}(Y\neq F_{\bm{\theta}}(\mathbf{X}))
\mathbf{p}_{\theta}(\cdot|\bm{x})
\mathbf{p}_{\bm{\theta}}(\cdot|\bm{x})
\bm{\theta}
\mathcal{R}_{\text{ARoW}}(\bm{\theta};\left\{(\bm{x}_{i},y_{i})\right\}_{i=1}^%
{n},\lambda),
\textbf{PGD}^{20}
\textbf{PGD}^{20}
\textbf{PGD}^{20}
\textbf{PGD}^{20}
\lambda
x
y
\lambda
x
y
(1-p_{\bm{\theta}}(y_{i}|\widehat{\bm{x}}^{\text{pgd}}_{i}))
p_{\bm{\theta}}(y_{i}|\widehat{\bm{x}}^{\text{pgd}}_{i})
(1-p_{\bm{\theta}}(y|\bm{x}))
(1-p_{\bm{\theta}}(y|\widehat{\bm{x}}^{\text{pgd}})).
p_{\bm{\theta}}(y|\bm{x})
\textbf{PGD}^{20}
\lambda,
\lambda
x
y
\lambda.
\lambda
\lambda=3
\lambda=3
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{TRADES}}
\text{PGD}^{10}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{TRADES}}
\text{PGD}^{10}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{ARoW}}
\textbf{PGD}^{10}
(1-p_{\bm{\theta}}(y|\widehat{\bm{x}}^{\text{pgd}}))
p_{\bm{\theta}_{\text{PGD}}}(y_{i}|\widehat{\bm{x}}_{i}^{\text{pgd}})
<0.3,
0.3\sim 0.5
0.5\sim 0.7
>0.7
\bm{\theta}_{\text{PGD}}
\lambda=6
\lambda=3
\lambda=6
\lambda=3
\textbf{PGD}^{20}
\mathbbm{1}(F_{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))))
\operatorname{KL}(\mathbf{p}_{\bm{\theta}}(\cdot|\mathbf{X})||\mathbf{p}_{\bm{%
\theta}}(\cdot|\widehat{\mathbf{X}}^{\text{pgd}})).
f_{\bm{\theta}},
z(\cdot)
\mathcal{X}
\mathcal{X}
z(\bm{x})\in\underset{\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},\varepsilon)}{%
\operatorname{argmax}}\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{%
\theta}}(\bm{x}^{\prime})\right)
\bm{x}\in\mathcal{X}
\displaystyle\begin{split}\mathbbm{1}\left\{\exists\bm{x}^{\prime}\in\mathcal{%
B}_{p}(\bm{x},\varepsilon):F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(\bm{x}^%
{\prime}),F_{\bm{\theta}}(\bm{x})=Y\right\}\\
\leq\mathbbm{1}\left\{F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(z(\bm{x})),Y%
\neq F_{\bm{\theta}}(z(\bm{x}))\right\}\end{split}
\displaystyle\begin{split}\mathbbm{1}\left\{\exists\bm{x}^{\prime}\in\mathcal{%
B}_{p}(\bm{x},\varepsilon):F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(\bm{x}^%
{\prime}),F_{\bm{\theta}}(\bm{x})=Y\right\}\\
\leq\mathbbm{1}\left\{F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(z(\bm{x})),Y%
\neq F_{\bm{\theta}}(z(\bm{x}))\right\}\end{split}
\mathbbm{1}\left\{F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(z(\bm{x})),Y\neq
F%
_{\bm{\theta}}(z(\bm{x}))\right\}=1
\mathbbm{1}\left\{\exists\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},\varepsilon)%
:F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(\bm{x}^{\prime}),F_{\bm{\theta}}(%
\bm{x})=Y\right\}=0
F_{\bm{\theta}}(\bm{x})=F_{\bm{\theta}}(z(\bm{x}))
Y=F_{\bm{\theta}}(z(\bm{x})).
F_{\bm{\theta}}(\bm{x})=F_{\bm{\theta}}(z(\bm{x})).
\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(z(\bm{x}))\right)%
\leq\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(\bm{x}^{%
\prime})\right)
\bm{x}^{\prime}\in\mathcal{X}
\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(z(\bm{x}))\right)=0
F_{\bm{\theta}}(z(\bm{x}))=F_{\bm{\theta}}(\bm{x}^{\prime})
z(\bm{x})
0
\mathbbm{1}\left\{\exists\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},\varepsilon)%
:F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(\bm{x}^{\prime})\right\}=0,
Y=F_{\bm{\theta}}(z(\bm{x})).
F_{\bm{\theta}}(\bm{x})=Y
\bm{x}^{\prime}
\mathcal{B}_{p}(\bm{x},\varepsilon)
F_{\bm{\theta}}(\bm{x}^{\prime})\neq F_{\bm{\theta}}(\bm{x})
F_{\bm{\theta}}(\bm{x}^{\prime})\neq Y=F_{\bm{\theta}}(\bm{x})=F_{\bm{\theta}}%
(z(\bm{x}))
\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(z(\bm{x}))\right)%
<\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{\theta}}(\bm{x}^{\prime})%
\right),
z(\bm{x})
0
\mathcal{R}_{\text{rob}}({\bm{\theta}})=\mathcal{R}_{\text{nat}}({\bm{\theta}}%
)+\mathcal{R}_{\text{bdy}}({\bm{\theta}})
\mathcal{R}_{\text{nat}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}%
\left\{F_{\bm{\theta}}(\mathbf{X})\neq Y\right\}
\mathcal{R}_{\text{bdy}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}%
\left\{\exists\mathbf{X}^{\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon):F_%
{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(\mathbf{X}^{\prime}),F_{\bm{%
\theta}}(\mathbf{X})=Y\right\}
\displaystyle\mathcal{R}_{\text{bdy}}({\bm{\theta}})=\mathbb{E}_{(\mathbf{X},Y%
)}\mathbbm{1}\left\{\exists\mathbf{X}^{\prime}\in\mathcal{B}_{p}(\mathbf{X},%
\varepsilon):F_{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(\mathbf{X}^{%
\prime}),F_{\bm{\theta}}(\mathbf{X})=Y\right\}
\displaystyle\mathcal{R}_{\text{bdy}}({\bm{\theta}})
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{\exists\mathbf{X}^{%
\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon):F_{\bm{\theta}}(\mathbf{X})%
\neq F_{\bm{\theta}}(\mathbf{X}^{\prime}),F_{\bm{\theta}}(\mathbf{X})=Y\right\}
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X})),Y\neq F_{\bm{\theta}}(z(\mathbf%
{X}))\right\}(\because\text{\;Lemma\;}\ref{lemma2})
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X})),Y\neq F_{\bm{\theta}}(z(\mathbf%
{X}))\right\}(\because\text{\;Lemma\;}\ref{lemma2})
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\left\{Y\neq F%
_{\bm{\theta}}(z(\mathbf{X}))\right\}
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\left\{Y\neq F%
_{\bm{\theta}}(z(\mathbf{X}))\right\}
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\left\{p_{\bm%
{\theta}}(Y|z(\mathbf{X}))<1/2\right\},
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\left\{p_{\bm%
{\theta}}(Y|z(\mathbf{X}))<1/2\right\},
f_{\bm{\theta}}
z(\cdot)
\mathcal{X}
\mathcal{X}
z(\bm{x})\in\underset{\bm{x}^{\prime}\in\mathcal{B}_{p}(\bm{x},\varepsilon)}{%
\operatorname{argmax}}\mathbbm{1}\left(F_{\bm{\theta}}(\bm{x})\neq F_{\bm{%
\theta}}(\bm{x}^{\prime})\right).
\bm{x}\in\mathcal{X}
\displaystyle\mathcal{R}_{\text{rob}}(\bm{\theta})\leq\mathbb{E}_{(\mathbf{X},%
Y)}\mathbbm{1}(Y\neq F_{\bm{\theta}}(\mathbf{X}))
\displaystyle\mathcal{R}_{\text{rob}}(\bm{\theta})
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}(Y\neq F_{\bm{\theta}}(%
\mathbf{X}))
\displaystyle+2\mathbb{E}_{(\mathbf{X},Y)}{\mathbbm{1}(F_{\bm{\theta}}(\mathbf%
{X})\neq F_{\bm{\theta}}(z(\mathbf{X})))}\cdot p_{\bm{\theta}}(Y|\mathbf{X})
\displaystyle+2\mathbb{E}_{(\mathbf{X},Y)}{\mathbbm{1}(F_{\bm{\theta}}(\mathbf%
{X})\neq F_{\bm{\theta}}(z(\mathbf{X})))}\cdot p_{\bm{\theta}}(Y|\mathbf{X})
\mathcal{R}_{\text{rob}}({\bm{\theta}})=\mathcal{R}_{\text{nat}}({\bm{\theta}}%
)+\mathcal{R}_{\text{bdy}}({\bm{\theta}})
\mathcal{R}_{\text{nat}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}%
\left\{F_{\bm{\theta}}(\mathbf{X})\neq Y\right\}
\mathcal{R}_{\text{bdy}}(\bm{\theta})=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}%
\left\{\exists\mathbf{X}^{\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon):F_%
{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(\mathbf{X}^{\prime}),F_{\bm{%
\theta}}(\mathbf{X})=Y\right\}
\displaystyle\mathcal{R}_{\text{bdy}}({\bm{\theta}})=\mathbb{E}_{(\mathbf{X},Y%
)}\mathbbm{1}\left\{\exists\mathbf{X}^{\prime}\in\mathcal{B}_{p}(\mathbf{X},%
\varepsilon):F_{\bm{\theta}}(\mathbf{X})\neq F_{\bm{\theta}}(\mathbf{X}^{%
\prime}),F_{\bm{\theta}}(\mathbf{X})=Y\right\}
\displaystyle\mathcal{R}_{\text{bdy}}({\bm{\theta}})
\displaystyle=\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{\exists\mathbf{X}^{%
\prime}\in\mathcal{B}_{p}(\mathbf{X},\varepsilon):F_{\bm{\theta}}(\mathbf{X})%
\neq F_{\bm{\theta}}(\mathbf{X}^{\prime}),F_{\bm{\theta}}(\mathbf{X})=Y\right\}
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\left\{Y=F_{%
\bm{\theta}}(\mathbf{X})\right\}
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\left\{Y=F_{%
\bm{\theta}}(\mathbf{X})\right\}
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\{p_{\bm{%
\theta}}(Y|\mathbf{X})>1/2\}
\displaystyle\leq\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}}(%
\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\mathbbm{1}\{p_{\bm{%
\theta}}(Y|\mathbf{X})>1/2\}
\displaystyle\leq 2\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}%
}(\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\cdot p_{\bm{\theta}}(%
Y|\mathbf{X}),
\displaystyle\leq 2\mathbb{E}_{(\mathbf{X},Y)}\mathbbm{1}\left\{F_{\bm{\theta}%
}(\mathbf{X})\neq F_{\bm{\theta}}(z(\mathbf{X}))\right\}\cdot p_{\bm{\theta}}(%
Y|\mathbf{X}),
\displaystyle\mathcal{R}_{\text{CoW}}(\bm{\theta};\left\{(\bm{x}_{i},y_{i})%
\right\}_{i=1}^{n},\lambda):=\sum\limits_{i=1}^{n}\bigg{\{}\ell^{\text{LS}}(f_%
{\bm{\theta}}(\bm{x}_{i}),y_{i})+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{%
\bm{\theta}}(\cdot|\bm{x}_{i})||\mathbf{p}_{\bm{\theta}}(\cdot|\widehat{\bm{x}%
}^{\text{pgd}}_{i}))\cdot p_{\bm{\theta}}(y_{i}|\bm{x}_{i})\bigg{\}}.
\displaystyle\mathcal{R}_{\text{CoW}}(\bm{\theta};\left\{(\bm{x}_{i},y_{i})%
\right\}_{i=1}^{n},\lambda):=\sum\limits_{i=1}^{n}\bigg{\{}\ell^{\text{LS}}(f_%
{\bm{\theta}}(\bm{x}_{i}),y_{i})+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{%
\bm{\theta}}(\cdot|\bm{x}_{i})||\mathbf{p}_{\bm{\theta}}(\cdot|\widehat{\bm{x}%
}^{\text{pgd}}_{i}))\cdot p_{\bm{\theta}}(y_{i}|\bm{x}_{i})\bigg{\}}.
\text{PGD}^{20}
\lambda=4
\lambda=4
p_{\bm{\theta}_{\text{PGD}}}(y|\bm{x})
<0.3,
0.3\sim 0.5
0.5\sim 0.7
>0.7
\bm{\theta}_{\text{PGD}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{CoW}}
\textbf{Rob}_{\text{CoW}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{CoW}}
\textbf{Rob}_{\text{CoW}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{MART}}
\textbf{Rob}_{\text{CoW}}
p=\infty
\varepsilon=8/255
\nu=2/255
T
0.9
5\times 10^{-4}
\lambda
\gamma
\alpha
5e^{-4}
5e^{-4}
2e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
2e^{-4}
5e^{-4}
\lambda=3
\lambda=3
\nabla_{\bm{x}}\ell_{\text{ce}}(f_{\bm{\theta}}(\bm{x}),y)\approx\bm{0}
\lambda
\gamma
\alpha
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
5e^{-4}
+0.29\%
+0.11\%
\textbf{PGD}^{20}
\lambda
\lambda,
\lambda
\lambda
\lambda
\textbf{PGD}^{20}
\lambda=6
\lambda=2.5
\lambda=3.0
\lambda=3.5
\lambda=4.0
\lambda=4.5
\lambda=5.0
\alpha
\lambda
\alpha
\alpha
\alpha
\textbf{PGD}^{20}
\textbf{PGD}^{20}
\varepsilon
\varepsilon
\varepsilon
\varepsilon
\varepsilon=8
\varepsilon
\varepsilon
\varepsilon=8
\varepsilon
\textbf{PGD}^{20}
\varepsilon
\varepsilon=8
\varepsilon
\varepsilon
\varepsilon=8
\varepsilon
\varepsilon
\textbf{PGD}^{20}
\displaystyle\min_{\bm{\theta}}\max_{\left\|\bm{\delta}_{l}\right\|\leq\gamma%
\left\|\bm{\theta}_{l}\right\|}\frac{1}{n}\sum_{i=1}^{n}\left\{\ell_{\text{ce}%
}(f_{\bm{\theta}+\bm{\delta}}(\bm{x}_{i}),y_{i})+\lambda\cdot\operatorname{KL}%
(\mathbf{p}_{\bm{\theta}+\bm{\delta}}(\cdot|\bm{x}_{i})\lVert\mathbf{p}_{{\bm{%
\theta}+\bm{\delta}}}(\cdot|\widehat{\bm{x}}^{\text{pgd}}_{i}))\right\},
\displaystyle\min_{\bm{\theta}}\max_{\left\|\bm{\delta}_{l}\right\|\leq\gamma%
\left\|\bm{\theta}_{l}\right\|}\frac{1}{n}\sum_{i=1}^{n}\left\{\ell_{\text{ce}%
}(f_{\bm{\theta}+\bm{\delta}}(\bm{x}_{i}),y_{i})+\lambda\cdot\operatorname{KL}%
(\mathbf{p}_{\bm{\theta}+\bm{\delta}}(\cdot|\bm{x}_{i})\lVert\mathbf{p}_{{\bm{%
\theta}+\bm{\delta}}}(\cdot|\widehat{\bm{x}}^{\text{pgd}}_{i}))\right\},
\bm{\theta}_{l}
l
\gamma
\displaystyle\min_{\bm{\theta}}\max_{\left\|\bm{\delta}_{l}\right\|\leq\gamma%
\left\|\bm{\theta}_{l}\right\|}\frac{1}{n}\sum_{i=1}^{n}\Big{\{}\ell_{\text{ce%
}}(f_{\bm{\theta}+\bm{\delta}}(\bm{x}_{i}),y_{i})
\displaystyle\min_{\bm{\theta}}\max_{\left\|\bm{\delta}_{l}\right\|\leq\gamma%
\left\|\bm{\theta}_{l}\right\|}\frac{1}{n}\sum_{i=1}^{n}\Big{\{}
\displaystyle\ell_{\text{ce}}(f_{\bm{\theta}+\bm{\delta}}(\bm{x}_{i}),y_{i})
\displaystyle+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}+\bm{%
\delta}}(\cdot|\bm{x}_{i})\lVert\mathbf{p}_{{\bm{\theta}+\bm{\delta}}}(\cdot|%
\widehat{\bm{x}}^{\text{pgd}}_{i}))\cdot(1-p_{\bm{\theta}}(y_{i}|\widehat{\bm{%
x}}^{\text{pgd}}_{i}))\Big{\}}.
\displaystyle+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{\bm{\theta}+\bm{%
\delta}}(\cdot|\bm{x}_{i})\lVert\mathbf{p}_{{\bm{\theta}+\bm{\delta}}}(\cdot|%
\widehat{\bm{x}}^{\text{pgd}}_{i}))\cdot(1-p_{\bm{\theta}}(y_{i}|\widehat{\bm{%
x}}^{\text{pgd}}_{i}))\Big{\}}.
\gamma
\sum\limits_{i=1}^{n}\ell_{\text{ce}}(f_{\bm{\theta}}(\bm{x}_{i}),y_{i})+%
\lambda\cdot\operatorname{KL}(\mathbf{p}_{\theta}(\cdot|\bm{x}_{i})\lVert%
\mathbf{p}_{\theta}(\cdot|\widehat{\bm{x}}^{(t_{i})}_{i}))
t_{i}=\min\left\{\min\{t:F_{\bm{\theta}}(\widehat{\bm{x}}_{i}^{(t)})\neq y_{i}%
\}+K,T\right\}.
T
\sum\limits_{i=1}^{n}\left\{\ell^{\text{LS}}_{\alpha}(f_{\theta}(\bm{x}_{i}),y%
_{i})+2\lambda\cdot\operatorname{KL}(\mathbf{p}_{\theta}(\cdot|\bm{x}_{i})%
\lVert\mathbf{p}_{\theta}(\cdot|\widehat{\bm{x}}^{(t_{i})}_{i}))\cdot(1-p_{\bm%
{\theta}}(y_{i}|\widehat{\bm{x}}^{(t_{i})}_{i}))\right\}.
K
\text{WC-Acc}=\underset{c}{\min}\;\text{Acc}(c)
\text{SD}=\sqrt{\dfrac{1}{C}\sum\limits_{c=1}^{C}(\text{Acc}(c)-\bar{\text{Acc%
}}})^{2}
\text{Acc}(c)
c
\bar{\text{Acc}}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{ARoW}}
\text{PGD}^{20}
\textbf{Stand}_{\text{TRADES}}
\textbf{Stand}_{\text{ARoW}}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{ARoW}}
\text{PGD}^{20}
\textbf{Stand}_{\text{TRADES}}
\textbf{Stand}_{\text{ARoW}}
\textbf{Rob}_{\text{TRADES}}
\textbf{Rob}_{\text{ARoW}}
\textbf{Stand}_{\text{TRADES}}
\textbf{Stand}_{\text{ARoW}}
(26.1\%\rightarrow 30.2\%
(65.9\%\rightarrow 75.1\%)
