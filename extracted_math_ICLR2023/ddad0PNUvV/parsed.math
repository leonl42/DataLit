{\bm{W}}_{t}
{\bm{W}}_{t}
t
d_{\text{key}}
d_{\text{in}}
d_{\text{out}}
t
{\bm{x}}_{t}\in\mathbb{R}^{d_{\text{in}}}
{\bm{y}}_{t}\in\mathbb{R}^{d_{\text{out}}}
{\bm{W}}_{t-1}\in\mathbb{R}^{d_{\text{out}}\times d_{\text{key}}}
{\bm{W}}_{0}=0
\displaystyle[{\bm{q}}_{t},{\bm{k}}_{t},{\bm{v}}_{t},\beta_{t}]={\bm{W}}_{%
\text{slow}}{\bm{x}}_{t}
\displaystyle[{\bm{q}}_{t},{\bm{k}}_{t},{\bm{v}}_{t},\beta_{t}]
\displaystyle=
\displaystyle{\bm{W}}_{\text{slow}}{\bm{x}}_{t}
\displaystyle{\bm{W}}_{t}={\bm{W}}_{t-1}+\sigma(\beta_{t})({\bm{v}}_{t}-{\bm{W%
}}_{t-1}\phi({\bm{k}}_{t}))\otimes\phi({\bm{k}}_{t})
\displaystyle{\bm{W}}_{t}
\displaystyle=
\displaystyle{\bm{W}}_{t-1}+\sigma(\beta_{t})({\bm{v}}_{t}-{\bm{W}}_{t-1}\phi(%
{\bm{k}}_{t}))\otimes\phi({\bm{k}}_{t})
\displaystyle{\bm{y}}_{t}={\bm{W}}_{t}\phi({\bm{q}}_{t})
\displaystyle{\bm{y}}_{t}
\displaystyle=
\displaystyle{\bm{W}}_{t}\phi({\bm{q}}_{t})
{\bm{W}}_{\text{slow}}\in\mathbb{R}^{(2*d_{\text{key}}+d_{\text{out}}+1)\times
d%
_{\text{in}}}
{\bm{q}}_{t}\in\mathbb{R}^{d_{\text{key}}}
{\bm{k}}_{t}\in\mathbb{R}^{d_{\text{key}}}
{\bm{v}}_{t}\in\mathbb{R}^{d_{\text{out}}}
\beta_{t}\in\mathbb{R}
\sigma
\phi
{\bm{W}}_{t-1}
{\bm{W}}_{t}
{\bm{v}}_{t}
\phi({\bm{k}}_{t})
\sigma(\beta_{t})
{\bm{W}}_{t}={\bm{W}}_{t-1}+{\bm{v}}_{t}\otimes\phi({\bm{k}}_{t})
G
D
\mathcal{R}
c
h
w
d
{\bm{z}}\in\mathbb{R}^{d}
\mathcal{N}(0,1)
G
G({\bm{z}})\in\mathbb{R}^{c\times h\times w}
h
w
c
c=3
D
{\bm{X}}\in\mathbb{R}^{c\times h\times w}
D({\bm{X}})\in\mathbb{R}
{\bm{X}}
\mathcal{R}
G
D
G
D
D
G
G
D
D(G(z))
G
D
G
T
c
d_{\text{key}}
d_{\text{value}}
d_{\text{latent}}
d_{\text{in}}
d_{\text{hidden}}
{\bm{z}}\in\mathbb{R}^{d_{\text{latent}}}
T
{\bm{W}}\in\mathbb{R}^{c\times d_{\text{value}}\times d_{\text{key}}}
c
d_{\text{value}}
d_{\text{key}}
\displaystyle({\bm{x}}_{1},...,{\bm{x}}_{T})=\mathrm{InputGenerator}({\bm{z}})
\displaystyle({\bm{x}}_{1},...,{\bm{x}}_{T})
\displaystyle=
\displaystyle\mathrm{InputGenerator}({\bm{z}})
\displaystyle({\bm{h}}_{1},...,{\bm{h}}_{T})=\mathrm{SequenceProcessor}({\bm{x%
}}_{1},...,{\bm{x}}_{T})
\displaystyle({\bm{h}}_{1},...,{\bm{h}}_{T})
\displaystyle=
\displaystyle\mathrm{SequenceProcessor}({\bm{x}}_{1},...,{\bm{x}}_{T})
\displaystyle{\bm{W}}_{t}=\mathrm{UpdateNet}({\bm{W}}_{t-1},{\bm{h}}_{t})\text%
{ for $t\in$ \{1, ..., $T$\}}
t\in
T
\displaystyle{\bm{W}}_{t}
\displaystyle=
\displaystyle\mathrm{UpdateNet}({\bm{W}}_{t-1},{\bm{h}}_{t})\text{ for $t\in$ %
\{1, ..., $T$\}}
t\in
T
\displaystyle{\bm{W}}={\bm{W}}_{T}
\displaystyle{\bm{W}}
\displaystyle=
\displaystyle{\bm{W}}_{T}
t\in
T
{\bm{x}}_{t}\in\mathbb{R}^{d_{\text{in}}}
{\bm{h}}_{t}\in\mathbb{R}^{d_{\text{hidden}}}
{\bm{W}}_{t}\in\mathbb{R}^{c\times d_{\text{value}}\times d_{\text{key}}}
{\bm{W}}_{0}=0
\mathrm{InputGenerator}
\mathrm{SequenceProcessor}
\mathrm{UpdateNet}
\mathrm{InputGenerator}
{\bm{z}}\in\mathbb{R}^{d_{\text{latent}}}
({\bm{x}}_{1},...,{\bm{x}}_{T})
{\bm{x}}_{t}\in\mathbb{R}^{d_{\text{in}}}
t\in
T
\mathrm{SequenceProcessor}
\mathrm{SequenceProcessor}
{\bm{x}}_{t}={\bm{z}}
t
d_{\text{in}}=d_{\text{latent}}
\mathrm{InputGenerator}
d_{\text{latent}}
T*d_{\text{in}}
T
{\bm{x}}_{t}
t\in\{1,...,T\}
d_{\text{in}}
T
\mathrm{SequenceProcessor}
\mathrm{InputGenerator}
{\bm{z}}
\mathrm{UpdateNet}
\mathrm{UpdateNet}
{\bm{W}}_{t-1}
{\bm{W}}_{0}=0
{\bm{W}}_{t}
t
{\bm{h}}_{t}\in\mathbb{R}^{d_{\text{hidden}}}
{\bm{k}}_{t}\in\mathbb{R}^{c*d_{\text{key}}}
{\bm{v}}_{t}\in\mathbb{R}^{c*d_{\text{value}}}
\beta_{t}\in\mathbb{R}^{c}
{\bm{W}}_{\text{slow}}\in\mathbb{R}^{c*(d_{\text{key}}+d_{\text{value}}+1)%
\times d_{\text{hidden}}}
\displaystyle[{\bm{k}}_{t},{\bm{v}}_{t},\beta_{t}]={\bm{W}}_{\text{slow}}{\bm{%
h}}_{t}
\displaystyle[{\bm{k}}_{t},{\bm{v}}_{t},\beta_{t}]
\displaystyle=
\displaystyle{\bm{W}}_{\text{slow}}{\bm{h}}_{t}
c
t\in
T
[{\bm{k}}_{t}^{1},...,{\bm{k}}_{t}^{c}]={\bm{k}}_{t}
[{\bm{v}}_{t}^{1},...,{\bm{v}}_{t}^{c}]={\bm{v}}_{t}
[\beta_{t}^{1},...,\beta_{t}^{c}]=\beta_{t}
{\bm{k}}_{t}^{i}\in\mathbb{R}^{d_{\text{key}}}
{\bm{v}}_{t}^{i}\in\mathbb{R}^{d_{\text{value}}}
\beta_{t}^{i}\in\mathbb{R}
i\in
c
t\in
T
i\in
c
{\bm{W}}_{t}^{i}\in\mathbb{R}^{d_{\text{value}}\times d_{\text{key}}}
\displaystyle{\bm{W}}_{t}^{i}={\bm{W}}_{t-1}^{i}+\sigma(\beta_{t}^{i})({\bm{v}%
}_{t}^{i}-{\bm{W}}_{t-1}^{i}\phi({\bm{k}}_{t}^{i}))\otimes\phi({\bm{k}}_{t}^{i})
\displaystyle{\bm{W}}_{t}^{i}
\displaystyle=
\displaystyle{\bm{W}}_{t-1}^{i}+\sigma(\beta_{t}^{i})({\bm{v}}_{t}^{i}-{\bm{W}%
}_{t-1}^{i}\phi({\bm{k}}_{t}^{i}))\otimes\phi({\bm{k}}_{t}^{i})
t=T
{\bm{W}}=[{\bm{W}}_{T}^{1},...,{\bm{W}}_{T}^{c}]\in\mathbb{R}^{c\times d_{%
\text{value}}\times d_{\text{key}}}
\tanh
{\bm{W}}={\bm{W}}_{T}\in\mathbb{R}^{c\times d_{\text{value}}\times d_{\text{%
key}}}
{\bm{W}}^{\prime}\in\mathbb{R}^{c\times d_{\text{value}}\times d_{\text{key}}}
\displaystyle{\bm{W}}^{\prime}=\mathrm{UNet}({\bm{W}}_{T})
\displaystyle{\bm{W}}^{\prime}
\displaystyle=
\displaystyle\mathrm{UNet}({\bm{W}}_{T})
T=64
T=64
\tanh
\tanh
T=64
T=64
T
T=64
T=64
\mathrm{InputGenerator}
\tanh
\tanh
d_{\text{latent}}\in\{128,256,512\}
d_{\text{hidden}}\in\{1024,2048,4096\}
L\in\{1,2\}
\mathrm{InputGenerator}
d_{\text{in}}\in\{8,16,32\}
d_{\text{in}}^{\prime}\in\{128,256,512\}
20
2e^{-4}
\mathrm{InputGenerator}
\tanh
d_{\text{latent}}
d_{\text{in}}
d_{\text{in}}^{\prime}
d_{\text{hidden}}
L
