{}^{1~{}*}
{}^{1~{}*}
{}^{1,3,4~{}{\dagger}}
``object_{1},object_{2},object_{3}...object_{M}"
object_{i}
M
O=Enc_{I}(\text{Image}),P=Enc_{L}(\text{Prompt}),S_{ground}=OP^{\top},L_{cls}=%
Loss(S_{ground};T),
O\in\mathbb{R}^{N\times d},P\in\mathbb{R}^{M\times d}
S_{ground}\in\mathbb{R}^{N\times M}
T\in\{0,1\}^{N\times M}
M
N
\text{Prompt}=\sum\nolimits_{m}\text{Template}(\{v^{Attr_{i}}\},object_{m}),%
Attr_{i}\in\{Attr_{1},Attr_{2},...,Attr_{N}\},
M
N
\{\text{shape},\text{color},\text{location}\}
object
{v^{shape}}
{v^{color}}
{v^{location}}
v^{Attr}=\arg\max\limits_{\tilde{v}^{Attr}\in V}{P_{\text{Expert}}([mask]=%
\tilde{v}^{Attr}|t_{s})},
V
t_{s}
P_{\text{Expert}}
\tilde{v}
{Attr}
object
k
k
Attr_{i}
object_{m}
\text{Prompt}_{k}=\sum\nolimits_{m}\text{Template}(\{v_{k}^{Attr_{i}}\},object%
_{m}),Attr_{i}\in\{Attr_{1},Attr_{2},...,Attr_{N}\},
v_{k}^{Attr_{i}}|v_{k}^{Attr_{i}}\in\underset{\tilde{v}^{Attr_{i}}\in V}{\text%
{Top-}k}\{P_{\text{Expert}}([mask]=\tilde{v}^{Attr_{i}}|t_{s})\}\}
k
MLM(Attr_{i},object_{m})
k
x
\text{Prompt}_{x}=\sum\nolimits_{m}\text{Template}(\{VQA(x,Q_{Attr_{1}}),...,%
VQA(x,Q_{Attr_{N}})\},object_{m}),
VQA(x,Q_{Attr_{i}})
x
Q_{Attr_{i}}
i
\text{Template}(\cdot)
\text{Prompt}_{x}=\sum\nolimits_{m}\text{Template}(\{VQA(x,Q_{Attr_{1}}),...,%
MLM(Location,object_{m})\},object_{m}),
MLM({Location},object_{m})
VQA(x,Q_{Attr_{i}})
1\times 10^{-4}
1\times 10^{-5}
\times
\star
\Delta
\Delta
\times
+
+
+
\times
\times
512\times 512
800\times 800
\cdot
\cdot
+
+
+
+
+
+
+
+
+
+
+
55.9_{\pm{1.67}}
41.4_{{\pm{0.37}}}
57.6_{\pm{1.10}}
59.8_{\pm{1.15}}
58.0_{\pm{1.08}}
43.7_{\pm{1.17}}
60.8_{\pm}{0.64}
60.1_{\pm{0.95}}
58.8_{\pm{1.93}}
42.4_{\pm{1.06}}
60.8_{\pm}{1.24}
60.2_{\pm{0.36}}
69.6_{\pm{2.42}}
59.4_{\pm{1.63}}
52.3_{\pm{0.38}}
63.0_{\pm{1.44}}
43.6_{\pm{3.69}}
70.2_{\pm{1.96}}
61.6_{\pm{0.88}}
53.6_{\pm{2.61}}
66.8_{\pm{2.63}}
51.8_{\pm{1.94}}
71.3_{\pm{0.93}}
60.4_{\pm{1.25}}
55.4_{\pm{2.36}}
67.1_{\pm{1.31}}
49.6_{\pm{4.31}}
6.0_{\pm{1.10}}
19.8_{\pm{4.66}}
2.5_{\pm{2.06}}
6.4_{\pm{4.67}}
1.7_{\pm{0.95}}
5.5_{\pm{3.48}}
12.7_{\pm{5.5}}
24.2_{\pm{8.18}}
13.0_{\pm{3.49}}
37.6_{\pm{10.10}}
12.3_{\pm{1.14}}
32.8_{\pm{3.09}}
15.1_{\pm{0.59}}
44.9_{\pm{3.15}}
26.1_{\pm{1.60}}
49.6_{\pm{3.77}}
33.5_{\pm{1.35}}
72.6_{\pm{2.86}}
34.1_{\pm{1.81}}
78.1_{\pm{2.78}}
39.5_{\pm{0.93}}
77.0_{\pm{0.70}}
48.5_{\pm{0.66}}
79.2_{\pm{1.52}}
