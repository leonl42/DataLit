\displaystyle\begin{split}\max_{\mathcal{P}}\mathcal{L}(S_{val};\theta^{*}),s.%
t.\;\theta^{*}\in\arg\min_{\theta}\mathcal{L}(\mathcal{P}(S_{train});\theta),%
\end{split}
\displaystyle\begin{split}\max_{\mathcal{P}}\mathcal{L}(S_{val};\theta^{*}),s.%
t.\;\theta^{*}\in\arg\min_{\theta}\mathcal{L}(\mathcal{P}(S_{train});\theta),%
\end{split}
S_{train}
S_{val}
\mathcal{P}(\cdot)
S_{train}
\mathcal{L}(S;\theta)
S=\{x_{i},y_{i}\}^{N}_{i=1}
\theta
\ell_{\infty}
\displaystyle\min_{\mathcal{P},\mathcal{A}}\nabla_{\theta}\mathcal{L}(S_{val};%
\mathcal{A}(\theta^{T}))^{\top}\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{T});%
\mathcal{A}(\theta^{T})),
\displaystyle\min_{\mathcal{P},\mathcal{A}}\nabla_{\theta}\mathcal{L}(S_{val};%
\mathcal{A}(\theta^{T}))^{\top}\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{T});%
\mathcal{A}(\theta^{T})),
\mathcal{A}
\mathcal{A}(\theta^{T})
T
\nabla_{\theta}
\mathcal{A}
\mathcal{P}(S_{T})
\mathcal{P}(S_{T})
k
\theta^{t}
\theta^{t-1}
\theta^{t-k}
k
k
\theta^{t}
\theta^{t-1}
\theta^{t-k}
k
\alpha
\alpha^{\prime}
\alpha
\theta^{t}
\alpha^{{}^{\prime}}
\theta^{t-k}
\alpha^{\prime}<\alpha
\beta^{\prime}>\beta
\alpha
\alpha^{\prime}
\alpha
\theta^{t}
\alpha^{{}^{\prime}}
\theta^{t-k}
\alpha^{\prime}<\alpha
\beta^{\prime}>\beta
\theta^{t}
\theta^{t-k}
t
t-k
\hat{x}(\theta^{t})
x
\theta^{t}
\mathbb{D}
\begin{split}\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t}),&f(x;\theta^{t}))%
\neq\\
&\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t-k}),f(x;\theta^{t-k})).\end{split}
f(x;\theta^{t})
x
t
S
\min\mathcal{L}(S,\theta^{*})
\max\mathcal{L}(S,\theta^{*})
\theta^{*}
\begin{split}\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t}),f(\hat{x}(\theta^{t-%
k});\theta^{t-k}))-&\\
\mathbb{D}(f(x;\theta^{t}),f(x;\theta^{t-k}))\propto\mathcal{L}(S;\theta^{t-k}%
)&-\mathcal{L}(S;\theta^{t}).\end{split}
x
\hat{x}
\hat{x}
x
\hat{x}
t
t-k
\epsilon
\epsilon
\epsilon
\epsilon
f:~{}\mathbb{R}^{d}\rightarrow\Delta^{C}
C
\hat{x}(\theta^{t})
x
f(\cdot;\theta^{t})
\theta^{t-k}
k
t
\hat{x}(\theta^{t})
\theta^{t}
\theta^{t-k}
\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t-k}),f(\hat{x}(\theta^{t});\theta^{t%
})),
\hat{x}
\theta^{t}
k
t
t-k
\mathbb{D}(f(x^{*};\theta^{t-k}),f(x^{*};\theta^{t}))
0
k
x^{*}
x
\hat{x}
\theta^{t-k}
\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t-k}),f(\hat{x}(\theta^{t});\theta^{t%
}))
\mathbb{D}(f(x;\theta^{t-k}),f(x;\theta^{t}))
\epsilon
\epsilon
0
25
k
\alpha
\alpha^{\prime}
\beta
\beta^{\prime}
\theta^{t}
\theta^{t-k}
\alpha
\alpha^{\prime}
\epsilon
\displaystyle\begin{split}\tilde{{x}}=\arg\min_{\tilde{x}\in\mathcal{B}[{x},%
\epsilon]}&\ell(f(x),y),\\
&\text{s.t.},\mathbb{D}(f(\tilde{{x}};\theta),f(\tilde{{x}};\theta^{*}))>P,%
\end{split}
\displaystyle\begin{split}\tilde{{x}}=\arg\min_{\tilde{x}\in\mathcal{B}[{x},%
\epsilon]}&\ell(f(x),y),\\
&\text{s.t.},\mathbb{D}(f(\tilde{{x}};\theta),f(\tilde{{x}};\theta^{*}))>P,%
\end{split}
\tilde{x}
\mathcal{B}[{x},\epsilon]=\{\tilde{x}\mid d_{\infty}({x},\tilde{x})\leq\epsilon\}
\epsilon>0
{x}
P
\theta^{*}
0.1
0.9
0.0001
\pm
\pm
\Delta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Delta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Delta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\ell_{\infty}
\mu=0.5,\tau=0.02
\mu=1.7,\tau=0.1
\theta^{*}
\theta^{t-k}
P=\mu+\tau*m
P
\mu
\tau
m
\theta^{t}
\theta^{t}
\Delta
\Delta
\theta^{t}
\theta^{t}
\theta^{t}
k
k
k
k\in[4,36]
k
k
\theta^{t-k}
\beta
\Delta
P
P
P
P
P
P
\epsilon
\epsilon
\epsilon
k
\Delta
\beta
\max\mathcal{L}(S;\theta^{*})
\theta^{*}
\min\mathcal{L}(S;\theta^{*})
f(x;\theta^{t})
x
t
\min\mathcal{L}(S;\theta^{*})
\max\mathcal{L}(S;\theta^{*})
S
P
\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t}),f(x;\theta^{t}))\propto\max%
\mathcal{L}(S;\theta^{*})-\mathcal{L}(S;\theta^{t}),\quad s.t.\;\theta^{*}\in%
\arg\min_{\theta}\mathcal{L}(P;\theta)
S
f(x;\theta^{t})
x
t
S
\min\mathcal{L}(S,\theta^{*})
\max\mathcal{L}(S,\theta^{*})
\theta^{*}
\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t}),f(\hat{x}(\theta^{t-k});\theta^{t%
-k}))-\mathbb{D}(f(x;\theta^{t}),f(x;\theta^{t-k}))\propto\mathcal{L}(S;\theta%
^{t-k})-\mathcal{L}(S;\theta^{t}),
\displaystyle\begin{split}&\theta^{t}-\beta\nabla_{\theta^{t}}\mathcal{L}(f(x;%
\theta^{t}),y)\rightarrow\min\mathcal{L}(S;\theta^{t+1})\\
&\theta^{t}-\beta\nabla_{\theta^{t}}\mathcal{L}(f(\hat{x}(\theta^{t});\theta^{%
t}),y)\rightarrow\max\mathcal{L}(S;\theta^{t+1}),\end{split}
\displaystyle\begin{split}&\theta^{t}-\beta\nabla_{\theta^{t}}\mathcal{L}(f(x;%
\theta^{t}),y)\rightarrow\min\mathcal{L}(S;\theta^{t+1})\\
&\theta^{t}-\beta\nabla_{\theta^{t}}\mathcal{L}(f(\hat{x}(\theta^{t});\theta^{%
t}),y)\rightarrow\max\mathcal{L}(S;\theta^{t+1}),\end{split}
\displaystyle\mathbb{D}(\nabla_{\theta}\mathcal{L}(f(x),y,\theta^{t}),\nabla_{%
\theta}\mathcal{L}(f(\hat{x}(\theta^{t})),y,\theta^{t}))\propto\max\mathcal{L}%
(S;\theta^{*})-\mathcal{L}(S;\theta^{t}),
\displaystyle\mathbb{D}(\nabla_{\theta}\mathcal{L}(f(x),y,\theta^{t}),\nabla_{%
\theta}\mathcal{L}(f(\hat{x}(\theta^{t})),y,\theta^{t}))\propto\max\mathcal{L}%
(S;\theta^{*})-\mathcal{L}(S;\theta^{t}),
\theta^{*}\in\arg\min_{\theta}\mathcal{L}(P;\theta)
\displaystyle\mathbb{D}(\nabla_{\theta}\mathcal{L}(f(x),y,\theta^{t-k}),\nabla%
_{\theta}\mathcal{L}(f(\hat{x}(\theta^{t-k})),y,\theta^{t-k}))\propto\max%
\mathcal{L}(S;\theta^{*})-\mathcal{L}(S;\theta^{t-k}),
\displaystyle\mathbb{D}(\nabla_{\theta}\mathcal{L}(f(x),y,\theta^{t-k}),\nabla%
_{\theta}\mathcal{L}(f(\hat{x}(\theta^{t-k})),y,\theta^{t-k}))\propto\max%
\mathcal{L}(S;\theta^{*})-\mathcal{L}(S;\theta^{t-k}),
\displaystyle\begin{split}\mathbb{D}(\mathcal{L}(f(x),y,\theta^{t}),\mathcal{L%
}(f(\hat{x}(\theta^{t})),y,\theta^{t}))&\propto\max\mathcal{L}(S;\theta^{*})-%
\mathcal{L}(S;\theta^{t}),\\
\mathbb{D}(\mathcal{L}(f(x),y,\theta^{t-k}),\mathcal{L}(f(\hat{x}(\theta^{t-k}%
)),y,\theta^{t-k}))&\propto\max\mathcal{L}(S;\theta^{*})-\mathcal{L}(S;\theta^%
{t-k}),\end{split}
\displaystyle\begin{split}\mathbb{D}(\mathcal{L}(f(x),y,\theta^{t}),\mathcal{L%
}(f(\hat{x}(\theta^{t})),y,\theta^{t}))&\propto\max\mathcal{L}(S;\theta^{*})-%
\mathcal{L}(S;\theta^{t}),\\
\mathbb{D}(\mathcal{L}(f(x),y,\theta^{t-k}),\mathcal{L}(f(\hat{x}(\theta^{t-k}%
)),y,\theta^{t-k}))&\propto\max\mathcal{L}(S;\theta^{*})-\mathcal{L}(S;\theta^%
{t-k}),\end{split}
\displaystyle\begin{split}\mathbb{D}(f(x;\theta^{t-k})&,f(x;\theta^{t})),\\
\mathbb{D}(f(\hat{x}(\theta^{t-k});\theta^{t-k})&,f(\hat{x}(\theta^{t});\theta%
^{t})),\end{split}
\displaystyle\begin{split}\mathbb{D}(f(x;\theta^{t-k})&,f(x;\theta^{t})),\\
\mathbb{D}(f(\hat{x}(\theta^{t-k});\theta^{t-k})&,f(\hat{x}(\theta^{t});\theta%
^{t})),\end{split}
\displaystyle\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t}),f(\hat{x}(\theta^{t-%
k});\theta^{t-k}))-\mathbb{D}(f(x;\theta^{t}),f(x;\theta^{t-k}))\propto%
\mathcal{L}(S;\theta^{t-k})-\mathcal{L}(S;\theta^{t}).
\displaystyle\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{t}),f(\hat{x}(\theta^{t-%
k});\theta^{t-k}))-\mathbb{D}(f(x;\theta^{t}),f(x;\theta^{t-k}))\propto%
\mathcal{L}(S;\theta^{t-k})-\mathcal{L}(S;\theta^{t}).
k
\epsilon=0.064
\epsilon=0.064
S_{train}
S_{val}
S_{train}
\mathcal{P}(S_{train})
\max_{\mathcal{P}}\mathcal{L}(S_{val};\theta^{*}),\quad s.t.\;\theta^{*}\in%
\arg\min_{\theta}\mathcal{L}(\mathcal{P}(S_{train});\theta),
T
\max_{\mathcal{P}}\mathcal{L}(S_{val};\theta^{T+1}),\quad s.t.\;\theta^{T+1}=%
\theta^{T}-\beta\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{train});\theta^{T}),
\beta
\min_{\mathcal{P}}\nabla_{\theta}\mathcal{L}(S_{val};\theta^{T})^{\top}\nabla_%
{\theta}\mathcal{L}(\mathcal{P}(S_{T});\theta^{T}),
\mathcal{A}
T
\min_{\mathcal{P},\mathcal{A}}\nabla_{\theta}\mathcal{L}(S_{val};\mathcal{A}(%
\theta^{T}))^{\top}\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{T});\mathcal{A}(%
\theta^{T})),
\mathcal{A}(S_{t})
\max_{\mathcal{P},\mathcal{A}_{t}}\nabla_{\theta}\mathcal{L}(\mathcal{A}_{t}(S%
_{t});\theta^{t})^{\top}\left[\nabla_{\theta}\mathcal{L}(S_{t};\theta^{t})+%
\lambda\cdot\nabla_{\theta}(\nabla_{\theta}\mathcal{L}(S_{val};\mathcal{A}(%
\theta^{T}))^{\top}\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{T});\mathcal{A}(%
\theta^{T})))\right],
\max_{\mathcal{P},\mathcal{A}_{t}}\nabla_{\theta}\mathcal{L}(\mathcal{A}_{t}(S%
_{t});\theta^{t})^{\top}\left[\underbrace{\nabla_{\theta}\mathcal{L}(S_{t};%
\theta^{t})}_{\text{keep accuracy}}+\lambda\cdot\underbrace{\nabla_{\theta}(%
\nabla_{\theta}\mathcal{L}(S_{val};\theta^{T})^{\top}\nabla_{\theta}\mathcal{L%
}(\mathcal{P}(S_{T});\theta^{T}))}_{\text{accumulating poisoning effects for %
the trigger batch}}\right],
\ell_{\infty}
S=\{({x}_{i},y_{i})\}^{n}_{i=1}
\eta
T
m
M
{x}\in\mathcal{X}
y\in\mathcal{Y}
\theta
\ell
K
\epsilon
\delta
\Pi
P
\theta^{*}
\theta^{T}
=1
\dots
T
=1
\dots
M
\{({x}_{i},y_{i})\}^{m}_{i=1}
S
i=1
\dots
m
\tilde{{x}}_{i}
x_{i}
\tilde{{x_{i}}}\leftarrow{x_{i}},n=1
\mathbb{D}(f(\tilde{{x_{i}}};\theta),f(\tilde{{x_{i}}};\theta^{*}))>P
n<K
\tilde{{x_{i}}}\leftarrow\Pi_{\mathcal{B}[{x_{i}},\epsilon]}\big{(}\tilde{{x_{%
i}}}-\delta\cdot\text{sign}(\nabla_{\tilde{{x_{i}}}}\ell(f(\tilde{{x_{i}}}),y)%
)\big{)}
n=n+1
\mathbf{\theta}\leftarrow\mathbf{\theta}-\eta\nabla_{\mathbf{\theta}}\ell(f_{%
\mathbf{\theta}}(\tilde{{x}}_{i}),y_{i})
P
P
P
P
P
P
m
m
m
m
m
m
m
m
m
m
P
P
E\;\;(E\in[1,\text{present}])
\Delta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Delta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\Delta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mu
\tau
\mu
\tau
k
K
\mathcal{L}_{\text{MD}}=\mathbb{D}(f(\hat{x}(\theta^{t});\theta^{*}),f(\hat{x}%
(\theta^{t});\theta^{t}))
\theta^{*}
\displaystyle\max_{\mathcal{P},\mathcal{A}_{t}}\nabla_{\theta}\mathcal{L}(%
\mathcal{A}_{t}(S_{t});\theta^{t})^{\top}\left[\underbrace{\nabla_{\theta}%
\mathcal{L}(S_{t};\theta^{t})}_{\text{keep accuracy}}+\underbrace{\beta\cdot%
\nabla_{\theta}\mathcal{L}_{\text{MD}}}_{\text{keep imperceptibility}}+\lambda%
\cdot\underbrace{\nabla_{\theta}(\nabla_{\theta}\mathcal{L}(S_{val};\theta^{T}%
)^{\top}\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{T});\theta^{T}))}_{\text{%
accumulating poisoning effects for the trigger batch}}\right],
\displaystyle\max_{\mathcal{P},\mathcal{A}_{t}}\nabla_{\theta}\mathcal{L}(%
\mathcal{A}_{t}(S_{t});\theta^{t})^{\top}\left[\underbrace{\nabla_{\theta}%
\mathcal{L}(S_{t};\theta^{t})}_{\text{keep accuracy}}+\underbrace{\beta\cdot%
\nabla_{\theta}\mathcal{L}_{\text{MD}}}_{\text{keep imperceptibility}}+\lambda%
\cdot\underbrace{\nabla_{\theta}(\nabla_{\theta}\mathcal{L}(S_{val};\theta^{T}%
)^{\top}\nabla_{\theta}\mathcal{L}(\mathcal{P}(S_{T});\theta^{T}))}_{\text{%
accumulating poisoning effects for the trigger batch}}\right],
\max\mathcal{L}(S,\theta)
\min\mathcal{L}(S,\theta)
