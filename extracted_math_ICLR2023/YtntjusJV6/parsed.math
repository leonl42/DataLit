n
f:\mathbb{R}^{\ell_{0}}\to\mathbb{R}^{\ell_{n}}
f=f_{n}\circ f_{n-1}\circ\cdots\circ f_{1}
j=1,\ldots,n
f_{j}=\sigma_{j}\circ A_{j}:\mathbb{R}^{\ell_{j-1}}\to\mathbb{R}^{\ell_{j}}
A_{j}(z):=W_{j}z+b_{j}
\sigma_{j}:\mathbb{R}^{\ell_{j}}\to\mathbb{R}^{\ell_{j}}
W_{j}\in L\left(\mathbb{R}^{\ell_{j-1}},\mathbb{R}^{\ell_{j}}\right)
b_{j}\in\mathbb{R}^{\ell_{j}}
L(K,V)
K\to V
K
\mathcal{D}=\left\{(x_{i},y_{i})\in\mathcal{X}\times\mathcal{Y}\right\}
n
f=f_{n}\circ f_{n-1}\circ...\circ f_{1}:\mathcal{X}\to\mathcal{Y}
\mathcal{D}
\mathcal{L}(f)
k
g:\mathcal{X}\to\mathcal{Y}
g=g_{n}\circ g_{n-1}\circ\cdots\circ g_{k+1}\circ\underbrace{f_{k}\circ\cdots%
\circ f_{1}}_{\text{fixed}},
\mathcal{L}(g)
\mathcal{\widetilde{D}}=\left\{(\widetilde{x}_{i},\widetilde{y}_{i})\in%
\mathcal{X}\times\mathcal{Y}\right\}
k
f
g_{j}:=\sigma_{j}\circ\widetilde{A}_{j}
\widetilde{A}_{j}
k<j<n
f
\mathcal{D}
g
\mathcal{\widetilde{D}}
f
g
\mathcal{Y}
\|\cdot\|_{\mathcal{Y}}
\mathcal{L}(f)=\frac{1}{N}\sum_{i=1}^{N}\|f(x_{i})-y_{i}\|_{\mathcal{Y}}^{2},%
\quad\mathcal{L}(g)=\frac{1}{N}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde%
{y}_{i}\|_{\mathcal{Y}}^{2}.
\mathfrak{D}=\{(x_{i},y_{i})\in\mathcal{X}\times\mathcal{Y}\}
h
\mathfrak{D}
\varepsilon_{\text{trained}}>0
\mathcal{L}(h)=\sum_{i=1}^{N}\|h(x_{i})-y_{i}\|^{2}_{\mathcal{Y}}\leq%
\varepsilon^{2}_{\text{trained}}.
f
\varepsilon_{\text{pretrained}}
\mathcal{L}(f)\leq\varepsilon^{2}_{\text{pretrained}}.
\mathcal{L}(f)=\mathbb{E}_{(x,y)\sim\mathcal{D}}\,\,\ell^{2}(f(x),y),\quad%
\mathcal{L}(g)=\mathbb{E}_{(\widetilde{x},\tilde{y})\sim\widetilde{\mathcal{D}%
}}\,\,\ell^{2}(g(\widetilde{x}),\widetilde{y})
\ell
\mathcal{D}
\widetilde{\mathcal{D}}
\varepsilon_{\text{data}}\geq 0
\mathcal{D}
\widetilde{\mathcal{D}}
\max_{i}\Big{\{}\min_{j}\Big{\{}\|(\widetilde{x}_{i},\widetilde{y}_{i})-(x_{j}%
,y_{j})\|_{\mathcal{X}\times\mathcal{Y}}\Big{\}}\Big{\}}\leq\varepsilon_{\text%
{data}},\qquad(i\leq|\widetilde{\mathcal{D}}|,\,\,j\leq|\mathcal{D}|)
i\leq|\widetilde{\mathcal{D}}|
j_{i}:=\operatorname*{arg\,min}_{j}\Big{\{}\|(\widetilde{x}_{i},\widetilde{y}_%
{i})-(x_{j},y_{j})\|_{\mathcal{X}\times\mathcal{Y}}\Big{\}}
j_{i}
\mathcal{D}
i
j_{i}
i
r
h
C_{h}
f
f=(f_{n}\circ\cdots\circ f_{n-r+1})\circ(f_{n-r}\circ\cdots\circ f_{1}):=F%
\circ F_{n-r}
F_{n-r}=f_{n-r}\circ\cdots\circ f_{1}
F=f_{n}\circ...\circ f_{n-r+1}
r
1<r<n
\mathcal{D}
\widetilde{\mathcal{D}}
\varepsilon_{\text{data}}
f=F\circ F_{n-r}
\mathcal{D}
r
f
g:=\left(F+\delta F\right)\circ F_{n-r}
\widetilde{\mathcal{D}}
\mathcal{L}(g)=\frac{1}{N}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{%
i}\|_{\mathcal{Y}}^{2}\leq C_{1}\varepsilon^{2}_{\text{pretrained}}+C_{2}\,%
\varepsilon^{2}_{\text{data}},
\delta F
C_{\delta F}\leq\varepsilon_{\text{data}}
C_{1}
C_{2}
C_{F_{n-r}}
C_{F}
C_{\widetilde{x}}:=\max_{i}\|\widetilde{x}_{i}\|_{\mathcal{X}}
g=\left(F+\delta F\right)\circ F_{n-r}
g\left(\widetilde{x}_{i}\right)=\left(F+\delta F\right)\circ F_{n-r}\left(%
\widetilde{x}_{i}\right)=f(x_{j_{i}})+v_{1}
v_{1}:=\delta F\circ F_{n-r}(\widetilde{x}_{i})+f(\widetilde{x}_{i})-f(x_{j_{i%
}})
\frac{1}{N}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{i}\|^{2}_{%
\mathcal{Y}}=\frac{1}{N}\sum_{i=1}^{N}\|f(x_{j_{i}})-\widetilde{y}_{i}+v_{1}\|%
^{2}_{\mathcal{Y}}\leq 3\left(\varepsilon^{2}_{\text{pretrained}}+\varepsilon^%
{2}_{\text{data}}+\|v_{1}\|^{2}_{\mathcal{Y}}\right),
\|v_{1}\|^{2}_{\mathcal{Y}}\leq 2\Big{(}\|\delta F\circ F_{n-r}(\widetilde{x}_%
{i}))\|^{2}_{\mathcal{Y}}+\|f(\widetilde{x}_{i})-f(x_{i})\|^{2}_{\mathcal{Y}}%
\Big{)}\leq 2\Big{(}C_{\delta F}^{2}\,C^{2}_{F_{n-r}}\,C^{2}_{\widetilde{x}}+C%
_{F}^{2}\,C_{F_{n-r}}^{2}\varepsilon^{2}_{\text{data}}\Big{)}.
C_{\delta F}\leq\varepsilon_{\text{data}}
\varepsilon_{\text{data}}\gg 0
\varepsilon_{\text{pretrained}}
\varepsilon_{\text{data}}
\widetilde{\mathcal{D}}\neq\mathcal{D}
\varepsilon_{\text{data}}=0
\mathcal{D},\widetilde{\mathcal{D}}
r=1
z_{i}
\widetilde{z}_{i}
g_{n}
z_{i}:=F_{n-1}(x_{i}),\,\,\widetilde{z}_{i}:=F_{n-1}(\widetilde{x}_{i}),\,\,g_%
{n}:=f_{n}+\delta f_{n}
\|g(\widetilde{x}_{i})-\widetilde{y}_{i}\|_{\mathcal{Y}}=\left\|\big{(}g_{n}(%
\widetilde{z}_{i})-f_{n}(\widetilde{z}_{i})\big{)}+\big{(}f_{n}(\widetilde{z}_%
{i})-f_{n}(z_{i})\big{)}+\big{(}f(x_{i})-y_{i}\big{)}+\big{(}y_{i}-\widetilde{%
y}_{i}\big{)}\right\|_{\mathcal{Y}}
g(\widetilde{x}_{i})=g_{n}(\widetilde{z}_{i})
f_{n}(z_{i})=f(x_{i})
f_{n}(\widetilde{z}_{i})-f_{n}(z_{i})=J(f_{n})(z_{i})\cdot\delta z_{i}+\delta z%
_{i}^{T}\cdot H(f_{n})(z_{i})\cdot\delta z_{i}+\mathcal{O}(\delta z_{i}^{3})
\delta z_{i}:=\left(\widetilde{z}_{i}-z_{i}\right)
J(f_{n})(z_{i})
H(f_{n})(z_{i})
f_{n}
z_{i}
\delta z_{i}
f_{n}
\mathcal{L}(g)=\frac{1}{N}\sum_{i=1}^{N}\|\delta f_{n}(\widetilde{z}_{i})-q_{i%
}\|_{\mathcal{Y}}^{2}
\delta y_{i}:=\widetilde{y}_{i}-y_{i}
q_{i}\in\mathcal{Y}
q_{i}:=\delta y_{i}-J(f_{n})(z_{i})\cdot\delta z_{i}+\left(y_{i}-f(x_{i})\right)
q_{i}=\delta y_{i}-J(f)(x_{i})\cdot\delta x_{i}+\left(y_{i}-f(x_{i})\right)
\mathcal{L}(g)=\frac{1}{N}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{%
i}\|_{\mathcal{Y}}^{2}
q_{i}=\underbracket{\delta y_{i}-J(f)(x_{i})\cdot\delta x_{i}}_{\text{domain %
mismatch }(\Delta)}+\overbracket{\left(y_{i}-f(x_{i})\right)}_{\text{pretrain %
error}(\star)}
(\Delta)
f
f(x_{i})=y_{i}
(\star)=0
\mathcal{D}=\mathcal{\widetilde{D}}
\delta x_{i}=\delta y_{i}=0
(\Delta)=0
q_{i}\equiv 0
f
\mathcal{\widetilde{D}}
f
\|\delta x_{i}\|
\|\delta y_{i}\|
q_{i}
\mathcal{\widetilde{D}}
\|q_{i}\|\to 0\,\,\,\text{(nothing to adapt)},\quad\|q_{i}\|\to\infty\,\,\,%
\text{(much to adapt)}
g
f
\delta f_{n}
q_{i}
\mathcal{L}(g)
\delta f_{n}
q_{i}\approx 0\,\xhookrightarrow[\text{adapt}]{no}\,\delta f_{n}\approx 0,%
\qquad\qquad\quad q_{i}\neq 0\,\xhookrightarrow[\text{adapt}]{need}\,\delta f_%
{n}\xleftarrow{\otimes}\min\text{Eq.~{}(\ref{1-layerloss})}
\otimes
\delta f_{n}
\|\cdot\|_{\mathcal{Y}}
L_{2}
\delta f_{n}=\left(\widetilde{z}^{T}\cdot\widetilde{z}\right)^{-1}\widetilde{z%
}^{T}\cdot q
\tilde{z}:=(\widetilde{z}_{1},\ldots,\widetilde{z}_{N})
q:=(q_{1},\ldots,q_{N})
q_{i}
\mathcal{\widetilde{D}}
J(f)(x_{i})\delta x_{i}
q_{i}
f(x_{i})
J(f)(x_{i})\delta x_{i}
\delta y_{i}
\mathcal{D}=\mathcal{\widetilde{D}}
\delta x_{i}=0
f
J(f)(x_{i})\delta x_{i}
f
\delta x_{i}=\delta y_{i}=0
\delta x_{i}\neq 0
\delta y_{i}=0
\delta x_{i}=0
\delta y_{i}\neq 0
\delta x_{i}\neq 0
\delta y_{i}\neq 0
f
\mathcal{D}\to\widetilde{\mathcal{D}}
\mathcal{D}
\widetilde{\mathcal{D}}
f
\mathcal{D}\to\widetilde{\mathcal{D}}
\mathcal{D}
\widetilde{\mathcal{D}}
\sim
\mathcal{D}
\widetilde{\mathcal{D}}
\widetilde{\mathcal{D}}
\mathcal{D}=\big{\{}(t_{i},\,\sin(5\pi t_{i}))\big{\}}_{i},\quad\widetilde{%
\mathcal{D}}=\big{\{}\left(t_{i}+0.05\,\xi_{i},\gamma(t_{i})\sin(5\pi t_{i}))+%
0.03\,\eta_{i}\right)\big{\}}_{i}
\{t_{i}\,|\,i=1,\ldots,2000\}\in[-1,1]
\gamma(t_{i})=0.4\,t_{i}+1.3998
\xi_{i}\sim\mathcal{N}(1.5,0.8)
\eta_{i}\sim\mathcal{U}(-1,1)
\mathcal{N}(\mu,\sigma)
\mu
\sigma
\mathcal{U}
[-1,1]
f
g
f
L_{2}
\sim
\mathcal{D}
\mathcal{\widetilde{D}}
\mathcal{D}
\mathcal{\widetilde{D}}
\mathcal{D}
\widetilde{\mathcal{D}}
\mathcal{D}
\widetilde{\mathcal{D}}
\displaystyle\mathcal{D}=\{(x_{ijk},y_{i})\}_{i,k}^{N_{1},N_{2}}\,\overset{%
\text{adapt}}{\longrightarrow}\,\widetilde{\mathcal{D}}=\{(\widetilde{x}_{ijk}%
,\widetilde{y}_{i})\}_{i,k}^{\widetilde{N}_{1},\widetilde{N}_{2}}\,(x_{ijk}=y_%
{i}+c_{j}\times n_{k};\,\widetilde{x}_{ijk}=\widetilde{y}_{i}+\widetilde{c}_{j%
}\times\widetilde{n}_{k})
\displaystyle\mathcal{D}=\{(x_{ijk},y_{i})\}_{i,k}^{N_{1},N_{2}}\,\overset{%
\text{adapt}}{\longrightarrow}\,\widetilde{\mathcal{D}}=\{(\widetilde{x}_{ijk}%
,\widetilde{y}_{i})\}_{i,k}^{\widetilde{N}_{1},\widetilde{N}_{2}}\,(x_{ijk}=y_%
{i}+c_{j}\times n_{k};\,\widetilde{x}_{ijk}=\widetilde{y}_{i}+\widetilde{c}_{j%
}\times\widetilde{n}_{k})
y_{i}
n_{k}
k
x_{ijk}
c_{j}\propto\exp{(-\text{SNR}_{j})}
\text{SNR}_{j}
N_{1}
\widetilde{N}_{1}
\mathcal{D}
\widetilde{\mathcal{D}}
N_{2}
\widetilde{N}_{2}
\mathcal{D}
\widetilde{\mathcal{D}}
f
\mathcal{D}
f(x_{ijk})=y_{i}
N_{1}=
n_{k}\in\{\text{White-noise, Train, Sea, Aircraft-cabin, Airplane-takeoff}\}
N_{2}=5
\{-5,0,5,10\}
\widetilde{N}_{1}
\widetilde{n}_{k}\in\{\text{Baby-cry, Bell, Siren}\}
\widetilde{N}_{2}=3
\{-1,1\}
f
L_{2}
g
f
L_{2}
\in[-0.5,4.5]
\in[0,1]
\widetilde{N}_{1}
\widetilde{\mathcal{D}}
\widetilde{N}_{1}
\widetilde{\mathcal{D}}
\widetilde{n}_{k}\in\{\text{Baby-cry, Bell, Siren}\}
\{-1,1\}
\mathcal{D}\to\widetilde{\mathcal{D}}
\widetilde{\mathcal{D}}
\widetilde{N}_{1}
L_{2}
\widetilde{\mathcal{D}}
-1
\widetilde{N}_{1}=400
-1
\widetilde{N}_{1}=400
\mathcal{D}
\widetilde{\mathcal{D}}
f=f_{n}\circ\cdots f_{2}\circ f_{1}
f_{n}
\widetilde{\mathcal{D}}
f=f_{n}\circ\cdots f_{2}\circ f_{1}
f_{n}
\widetilde{\mathcal{D}}
(x,y)\in\mathcal{D}
(\widetilde{x},\widetilde{y})\in\widetilde{\mathcal{D}}
x\in\{\text{$\times 3$ blurred patches}\},\,\,\widetilde{x}\in\{\text{$\times 4%
$, $\times 6$ blurred patches}\},\,\,y=\widetilde{y}\in\{\text{High-Res %
patches}\}
\times 3
\times 4
\times 6
\mathcal{D}
\widetilde{\mathcal{D}}
\mathcal{D}
\widetilde{\mathcal{D}}
\mathcal{C}=(\mathcal{C}_{ij\gamma})
W=(W_{\ell m})
f
\mathcal{D}
f(x)=y
f\to g
\widetilde{\mathcal{D}}
g(\widetilde{x})=\widetilde{y}
\widetilde{x}
\widetilde{\mathcal{D}}
N=256
N=16384
L_{2}
r
k+r=n
F_{n-r}=f_{n-r}\circ\cdots\circ f_{1}
r
F=f_{n}\circ...\circ f_{n-r+1}
G=g_{n}\circ...\circ g_{n-r+1}
G-F=\delta F
\displaystyle g\left(\widetilde{x}_{i}\right)=G\circ F_{n-r}\left(\widetilde{x%
}_{i}\right)=\left(F+\delta F\right)\circ F_{n-r}\left(\widetilde{x}_{i}\right%
)=f(x_{j_{i}})+v_{1},
\displaystyle g\left(\widetilde{x}_{i}\right)
\displaystyle=G\circ F_{n-r}\left(\widetilde{x}_{i}\right)=\left(F+\delta F%
\right)\circ F_{n-r}\left(\widetilde{x}_{i}\right)=f(x_{j_{i}})+v_{1},
v_{1}=\delta F\circ F_{n-r}(\widetilde{x}_{i})+f(\widetilde{x}_{i})-f(x_{j_{i}})
j_{i}
\displaystyle\frac{1}{N}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{i}%
\|^{2}_{\mathcal{Y}}=\frac{1}{N}\sum_{i=1}^{N}\|f(x_{j_{i}})-\widetilde{y}_{i}%
+v_{1}\|^{2}_{\mathcal{Y}}
\displaystyle\frac{1}{N}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{i}%
\|^{2}_{\mathcal{Y}}
\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\|f(x_{j_{i}})-\widetilde{y}_{i}+v_{1}%
\|^{2}_{\mathcal{Y}}
\displaystyle\leq\frac{3}{N}\sum_{i=1}^{N}\left(\|f(x_{j_{i}})-y_{j_{i}}\|^{2}%
_{\mathcal{Y}}+\|y_{j_{i}}-\widetilde{y}_{i}\|^{2}_{\mathcal{Y}}+\|v_{1}\|^{2}%
_{\mathcal{Y}}\right)
\displaystyle\leq\frac{3}{N}\sum_{i=1}^{N}\left(\|f(x_{j_{i}})-y_{j_{i}}\|^{2}%
_{\mathcal{Y}}+\|y_{j_{i}}-\widetilde{y}_{i}\|^{2}_{\mathcal{Y}}+\|v_{1}\|^{2}%
_{\mathcal{Y}}\right)
\displaystyle\leq 3\left(\varepsilon^{2}_{\text{pretrained}}+\varepsilon^{2}_{%
\text{data}}+\|v_{1}\|^{2}_{\mathcal{Y}}\right),
\displaystyle\leq 3\left(\varepsilon^{2}_{\text{pretrained}}+\varepsilon^{2}_{%
\text{data}}+\|v_{1}\|^{2}_{\mathcal{Y}}\right),
\displaystyle\|v_{1}\|^{2}_{\mathcal{Y}}\leq 2\Big{(}\|\delta F\circ F_{n-r}(%
\widetilde{x}_{i}))\|^{2}_{\mathcal{Y}}+\|f(\widetilde{x}_{i})-f(x_{j_{i}})\|^%
{2}_{\mathcal{Y}}\Big{)}
\displaystyle\|v_{1}\|^{2}_{\mathcal{Y}}
\displaystyle\leq 2\Big{(}\|\delta F\circ F_{n-r}(\widetilde{x}_{i}))\|^{2}_{%
\mathcal{Y}}+\|f(\widetilde{x}_{i})-f(x_{j_{i}})\|^{2}_{\mathcal{Y}}\Big{)}
\displaystyle\leq 2\Big{(}C_{\delta F}^{2}\,C^{2}_{F_{n-r}}\,C_{\widetilde{x}}%
^{2}+C_{F}^{2}\,C_{F_{n-r}}^{2}\varepsilon^{2}_{\text{data}}\Big{)}.
\displaystyle\leq 2\Big{(}C_{\delta F}^{2}\,C^{2}_{F_{n-r}}\,C_{\widetilde{x}}%
^{2}+C_{F}^{2}\,C_{F_{n-r}}^{2}\varepsilon^{2}_{\text{data}}\Big{)}.
C_{\widetilde{x}}:=\max_{i}\|\widetilde{x}_{i}\|_{\mathcal{X}}
g
C_{\delta F}\approx\varepsilon_{\text{data}}
C_{\delta F}
\varepsilon_{\text{data}}
\widetilde{D}_{\text{test}}=\{(x^{\text{(test)}}_{i},y^{\text{(test)}}_{i})\in%
\mathcal{X}\times\mathcal{Y}\}_{i=1}^{N_{\text{test}}}
|\widetilde{D}_{\text{test}}|\leq|\widetilde{D}|
g
\mathcal{L}_{\text{test}}(g)=\frac{1}{N_{\text{test}}}\sum_{i=1}^{N_{\text{%
test}}}\|g(\widetilde{x}^{\text{test}}_{i})-\widetilde{y}^{\text{test}}_{i}\|^%
{2}_{\mathcal{Y}}\leq C_{1}\,\varepsilon^{2}_{\text{data}}+C_{2}\,\mathcal{L}(g)
\varepsilon_{\text{data}}
\widetilde{D}
\widetilde{D}_{\text{test}}
C_{1}
C_{2}
C_{1}
C_{g}
\mathcal{L}(g)
\displaystyle\mathcal{L}_{\text{test}}(g)=\frac{1}{N_{\text{test}}}\sum_{i=1}^%
{N_{\text{test}}}\|g(\widetilde{x}^{\text{test}}_{i})-\widetilde{y}^{\text{%
test}}_{i}\|^{2}_{\mathcal{Y}}
\displaystyle\mathcal{L}_{\text{test}}(g)
\displaystyle=\frac{1}{N_{\text{test}}}\sum_{i=1}^{N_{\text{test}}}\|g(%
\widetilde{x}^{\text{test}}_{i})-\widetilde{y}^{\text{test}}_{i}\|^{2}_{%
\mathcal{Y}}
\displaystyle\leq\frac{3}{N_{\text{test}}}\sum_{i=1}^{N_{\text{test}}}\left(\|%
g(\widetilde{x}^{\text{test}}_{i})-g(\widetilde{x}_{i})\|^{2}_{\mathcal{Y}}+\|%
\widetilde{y}^{\text{test}}_{i}-\widetilde{y}_{i}\|^{2}_{\mathcal{Y}}+\|g(%
\widetilde{x}_{i})-\widetilde{y}_{i}\|^{2}_{\mathcal{Y}}\right)
\displaystyle\leq\frac{3}{N_{\text{test}}}\sum_{i=1}^{N_{\text{test}}}\left(\|%
g(\widetilde{x}^{\text{test}}_{i})-g(\widetilde{x}_{i})\|^{2}_{\mathcal{Y}}+\|%
\widetilde{y}^{\text{test}}_{i}-\widetilde{y}_{i}\|^{2}_{\mathcal{Y}}+\|g(%
\widetilde{x}_{i})-\widetilde{y}_{i}\|^{2}_{\mathcal{Y}}\right)
\displaystyle\leq\frac{3}{N_{\text{test}}}\sum_{i=1}^{N_{\text{test}}}\left(C_%
{g}^{2}\,\varepsilon^{2}_{\text{test}}+\varepsilon^{2}_{\text{test}}\right)+%
\frac{3}{N_{\text{test}}}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{i%
}\|^{2}_{\mathcal{Y}}
\displaystyle\leq\frac{3}{N_{\text{test}}}\sum_{i=1}^{N_{\text{test}}}\left(C_%
{g}^{2}\,\varepsilon^{2}_{\text{test}}+\varepsilon^{2}_{\text{test}}\right)+%
\frac{3}{N_{\text{test}}}\sum_{i=1}^{N}\|g(\widetilde{x}_{i})-\widetilde{y}_{i%
}\|^{2}_{\mathcal{Y}}
\delta z_{i}:=\widetilde{z}_{i}-z_{i}
n^{\text{th}}
(n-1)^{\text{th}}
g_{n}=f_{n}+\delta f_{n},\quad g_{n-1}=f_{n-1}+\delta f_{n-1}
f_{n-1}(\widetilde{z}_{i})\approx f_{n-1}(z_{i})+J(f_{n-1})(z_{i})\cdot\delta z%
_{i},
J(f_{n-1})(z_{i})
f_{n-1}
z_{i}
f_{n-1}
\delta f_{n-1}(\tilde{z}_{i}):=W_{n-1}\cdot\delta z_{i}+b,
W_{n-1}
b
g_{n-1}(\widetilde{z}_{i})\approx f_{n-1}(z_{i})+b+\Big{(}J(f_{n-1})(z_{i})+W_%
{n-1}\Big{)}\cdot\delta z_{i}.
\displaystyle g(\widetilde{x}_{i})=(f_{n}+\delta f_{n})\circ g_{n-1}(%
\widetilde{z}_{i})
\displaystyle g(\widetilde{x}_{i})
\displaystyle=(f_{n}+\delta f_{n})\circ g_{n-1}(\widetilde{z}_{i})
\displaystyle\approx f_{n}\circ f_{n-1}(z_{i})+f_{n}\circ\Big{(}\big{(}J(f_{n-%
1})(z_{i})+W_{n-1}\big{)}\cdot\delta z_{i}+b\Big{)}+\delta f_{n}\circ f_{n-1}(%
z_{i}).
\displaystyle\approx f_{n}\circ f_{n-1}(z_{i})+f_{n}\circ\Big{(}\big{(}J(f_{n-%
1})(z_{i})+W_{n-1}\big{)}\cdot\delta z_{i}+b\Big{)}+\delta f_{n}\circ f_{n-1}(%
z_{i}).
\delta f_{n}
\delta f_{n-1}
\displaystyle\|g(\widetilde{x}_{i})-\widetilde{y}_{i}\|_{\mathcal{Y}}=\|\left(%
g(\widetilde{x}_{i})-f_{n}\circ f_{n-1}(z_{i})\right)+\left(f_{n}\circ f_{n-1}%
(z_{i})-y_{i}\right)+\left(y_{i}-\widetilde{y}_{i}\right)\|_{\mathcal{Y}}
\displaystyle\|g(\widetilde{x}_{i})-\widetilde{y}_{i}\|_{\mathcal{Y}}
\displaystyle=\|\left(g(\widetilde{x}_{i})-f_{n}\circ f_{n-1}(z_{i})\right)+%
\left(f_{n}\circ f_{n-1}(z_{i})-y_{i}\right)+\left(y_{i}-\widetilde{y}_{i}%
\right)\|_{\mathcal{Y}}
\displaystyle\|g(\widetilde{x}_{i})-\widetilde{y}_{i}\|_{\mathcal{Y}}\approx\|%
\delta f_{n}\circ f_{n-1}(z_{i})+f_{n}\circ\Big{(}\big{(}J(f_{n-1})(z_{i})+W_{%
n-1}+b\big{)}(\widetilde{z}_{i}-z_{i})\Big{)}+f(x_{i})-y_{i}-\delta y_{i}\|_{%
\mathcal{Y}}.
\displaystyle\|g(\widetilde{x}_{i})
\displaystyle-\widetilde{y}_{i}\|_{\mathcal{Y}}\approx\|\delta f_{n}\circ f_{n%
-1}(z_{i})+f_{n}\circ\Big{(}\big{(}J(f_{n-1})(z_{i})+W_{n-1}+b\big{)}(%
\widetilde{z}_{i}-z_{i})\Big{)}+f(x_{i})-y_{i}-\delta y_{i}\|_{\mathcal{Y}}.
\delta f_{n}
b
W_{n-1}
b
\delta f_{n}
W_{n-1}
L_{2}
\delta f_{n}
W_{n-1}
b
\mathcal{D}
\mathcal{\widetilde{D}}
\delta x_{i}:=\widetilde{x}_{i}-x_{i},\quad\delta y_{i}:=\widetilde{y}_{i}-y_{i}
\varepsilon
\varepsilon
\delta x_{i}=\delta x_{i}^{(1)}+\delta x_{i}^{(2)}+\cdots,\quad\delta%
\widetilde{y}_{i}=\delta y_{i}^{(1)}+\delta y_{i}^{(2)}+\cdots
\mathcal{O}\left(\|\delta x_{i}^{(k)}\|_{\mathcal{X}}\right)=\mathcal{O}\left(%
\|\delta y_{i}^{(k)}\|_{\mathcal{Y}}\right)=\varepsilon^{k}
\delta x_{i}^{(2)},\delta y_{i}^{(2)}
\delta x_{i}^{(1)}
\delta y_{i}^{(1)}
\delta x_{i}
\delta y_{i}
\displaystyle\mathcal{L}(g)=\frac{1}{N}\sum_{i=1}^{N}\|\left(f_{n}+\delta f_{n%
}\right)\circ f_{n-1}\circ\cdots\circ f_{1}\left(\widetilde{x}_{i}\right)-%
\widetilde{y}_{i}\|_{\mathcal{Y}}^{2}
\displaystyle\mathcal{L}(g)
\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\|\left(f_{n}+\delta f_{n}\right)\circ f%
_{n-1}\circ\cdots\circ f_{1}\left(\widetilde{x}_{i}\right)-\widetilde{y}_{i}\|%
_{\mathcal{Y}}^{2}
\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\|\delta f_{n}(\widetilde{z}_{i})-%
\widetilde{y}_{i}+f(x_{i})+J(f)(x_{i})\delta x_{i}\|_{\mathcal{Y}}^{2}+%
\mathcal{O}(\varepsilon^{2})
\displaystyle=\frac{1}{N}\sum_{i=1}^{N}\|\delta f_{n}(\widetilde{z}_{i})-%
\widetilde{y}_{i}+f(x_{i})+J(f)(x_{i})\delta x_{i}\|_{\mathcal{Y}}^{2}+%
\mathcal{O}(\varepsilon^{2})
J(f)(x_{i})
f
x_{i}
\mathcal{O}(\varepsilon^{2})
H(f)(x_{i})\delta x_{i}\delta x_{i}
H(f)(x_{i})
f
x_{i}
\mathcal{L}(g)=\frac{1}{N}\sum_{i=1}^{N}\|\delta f_{n}(\widetilde{z}_{i})-q_{i%
}\|_{\mathcal{Y}}^{2}
q_{i}=\delta y_{i}-J(f)(x_{i})\cdot\delta x_{i}+\left(y_{i}-f(x_{i})\right)
q_{i}
\|\cdot\|_{\mathcal{X}}
\|\cdot\|_{\mathcal{Y}}
L_{2}
\mathcal{D}
f
\widetilde{\mathcal{D}}
\displaystyle\mathcal{D}=\big{\{}(x_{i},\sin(5\pi x_{i}))\,|\,x_{i}\in[-1,1]%
\big{\}}_{i=1}^{N=2000}
\displaystyle\mathcal{D}
\displaystyle=\big{\{}(x_{i},\sin(5\pi x_{i}))\,|\,x_{i}\in[-1,1]\big{\}}_{i=1%
}^{N=2000}
\displaystyle\widetilde{\mathcal{D}}=\left\{\underbrace{\left(x_{i}+0.05\,\xi_%
{i},\gamma(x_{i})\,y_{i}+0.03\,\eta_{i}\right)}_{(\widetilde{x}_{i},\widetilde%
{y}_{i})}\,|\,x_{i}\in[-1,1]\right\}_{i=1}^{N=2000}
\displaystyle\widetilde{\mathcal{D}}
\displaystyle=\left\{\underbrace{\left(x_{i}+0.05\,\xi_{i},\gamma(x_{i})\,y_{i%
}+0.03\,\eta_{i}\right)}_{(\widetilde{x}_{i},\widetilde{y}_{i})}\,|\,x_{i}\in[%
-1,1]\right\}_{i=1}^{N=2000}
\displaystyle\gamma(x_{i})=0.4\,x_{i}+1.3998,
\displaystyle\gamma(x_{i})
\displaystyle=0.4\,x_{i}+1.3998,
\displaystyle\xi_{i}\sim\mathcal{N}(1.5,0.8)\quad\text{(normal distribution %
mean=1.5, variance=0.8)},
\displaystyle\xi_{i}
\displaystyle\sim\mathcal{N}(1.5,0.8)\quad\text{(normal distribution mean=1.5,%
 variance=0.8)},
\displaystyle\eta_{i}\sim\mathcal{U}(-1,1)\quad\quad\text{(uniform %
distribution in $[-1,1]$)}.
[-1,1]
\displaystyle\eta_{i}
\displaystyle\sim\mathcal{U}(-1,1)\quad\quad\text{(uniform distribution in $[-%
1,1]$)}.
[-1,1]
\mathcal{D}
\widetilde{\mathcal{D}}
\mathcal{D}
\widetilde{\mathcal{D}}
f
\mathcal{D}
g_{\text{GD}}
f
\widetilde{\mathcal{D}}
f
g_{\text{GD}}
L_{2}
10^{-3}
g_{\text{pesudo}}
\widetilde{\mathcal{D}}
f
f_{n}\mapsto(f_{n}+\delta f_{n})
\delta f_{n}
\{\text{White-noise, Train, Sea, Aircraft-cabin, Airplane-takeoff}\}
\{\text{Baby-cry, Bell, Siren}\}
\{-5,0,5,10\}
\{\text{Baby-cry, Bell, Siren}\}
\{-1,1\}
\{\text{Baby-cry, Bell, Siren}\}
\{-1,1\}
log1p(x):=log(1+x)
10^{-3}
\delta f
-1
+1
-1
+1
-1
+1
L_{2}
-1
+1
-1
+1
-1
+1
f=f_{n}\circ\cdots f_{2}\circ f_{1}
f_{n}
\widetilde{\mathcal{D}}
f=f_{n}\circ\cdots f_{2}\circ f_{1}
f_{n}
\widetilde{\mathcal{D}}
\sim
\{\mathcal{C}_{ij\alpha\beta}\}
(i,j,\alpha,\beta)\in L_{1}\times L_{2}\times C_{\text{in}}\times C_{\text{out}}
L_{1},L_{2}
3\times 3
C_{\text{in}}
C_{\text{out}}
\mathcal{C}_{ij\alpha\beta}
x_{ij\alpha}
x_{ij\alpha}
\mathcal{C}_{ij\alpha\beta}
\beta
(k,\ell,\beta)
y_{\underbracket{k\ell\beta}}=\sum_{i,j,\alpha}\mathcal{C}_{\underline{ij%
\alpha}\beta}\cdot x_{\underline{ij\alpha}}(k,\ell)
\{W_{mn}\}
\mathbf{v}=(v_{1},\ldots,v_{m},\ldots)
\mathbf{u}=(u_{1},\ldots,u_{n},\ldots)
v_{m}=\sum_{n}W_{mn}\cdot u_{n}
n
\underline{ij\alpha}
m
\underbracket{k\ell\beta}
\mathcal{C}_{ij\alpha\beta}
W_{mn}
\eta
x_{ij\alpha}(k,\ell)
u_{n}
\xi
\sim
x_{ij\alpha}
x_{ij\alpha}
33\times 33
\mathcal{D}
\widetilde{\mathcal{D}}
\displaystyle\mathcal{D}_{1}=\big{\{}(x_{i},y_{i})\,|\,y_{i}\in\{\text{%
original patches}\},\,x_{i}\in\{\text{$\times 3$ blurred patches}\}\big{\}}_{i%
=1}^{N=40K}
\times 3
\displaystyle\mathcal{D}_{1}
\displaystyle=\big{\{}(x_{i},y_{i})\,|\,y_{i}\in\{\text{original patches}\},\,%
x_{i}\in\{\text{$\times 3$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 3
\displaystyle\widetilde{\mathcal{D}}_{1}=\big{\{}(\widetilde{x}_{i},\widetilde%
{y}_{i})\,|\,\widetilde{y}_{i}\in\{\text{original patches}\},\,\widetilde{x}_{%
i}\in\{\text{$\times 6$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 6
\displaystyle\widetilde{\mathcal{D}}_{1}
\displaystyle=\big{\{}(\widetilde{x}_{i},\widetilde{y}_{i})\,|\,\widetilde{y}_%
{i}\in\{\text{original patches}\},\,\widetilde{x}_{i}\in\{\text{$\times 6$ %
blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 6
\displaystyle\mathcal{D}_{2}=\big{\{}(x_{i},y_{i})\,|\,y_{i}\in\{\text{%
original patches}\},\,x_{i}\in\{\text{$\times 3$ blurred patches}\}\big{\}}_{i%
=1}^{N=40K}
\times 3
\displaystyle\mathcal{D}_{2}
\displaystyle=\big{\{}(x_{i},y_{i})\,|\,y_{i}\in\{\text{original patches}\},\,%
x_{i}\in\{\text{$\times 3$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 3
\displaystyle\widetilde{\mathcal{D}}_{2}=\big{\{}(\widetilde{x}_{i},\widetilde%
{y}_{i})\,|\,\widetilde{y}_{i}\in\{\text{original patches}\},\,\widetilde{x}_{%
i}\in\{\text{$\times 4$, $\times 6$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 4
\times 6
\displaystyle\widetilde{\mathcal{D}}_{2}
\displaystyle=\big{\{}(\widetilde{x}_{i},\widetilde{y}_{i})\,|\,\widetilde{y}_%
{i}\in\{\text{original patches}\},\,\widetilde{x}_{i}\in\{\text{$\times 4$, $%
\times 6$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 4
\times 6
\displaystyle\mathcal{D}_{3}=\big{\{}(x_{i},y_{i})\,|\,y_{i}\in\{\text{%
original patches}\},\,x_{i}\in\{\text{$\times 3,\times 4$ blurred patches}\}%
\big{\}}_{i=1}^{N=40K}
\times 3,\times 4
\displaystyle\mathcal{D}_{3}
\displaystyle=\big{\{}(x_{i},y_{i})\,|\,y_{i}\in\{\text{original patches}\},\,%
x_{i}\in\{\text{$\times 3,\times 4$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 3,\times 4
\displaystyle\widetilde{\mathcal{D}}_{3}=\big{\{}(\widetilde{x}_{i},\widetilde%
{y}_{i})\,|\,\widetilde{y}_{i}\in\{\text{original patches}\},\,\widetilde{x}_{%
i}\in\{\text{$\times 6$ blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 6
\displaystyle\widetilde{\mathcal{D}}_{3}
\displaystyle=\big{\{}(\widetilde{x}_{i},\widetilde{y}_{i})\,|\,\widetilde{y}_%
{i}\in\{\text{original patches}\},\,\widetilde{x}_{i}\in\{\text{$\times 6$ %
blurred patches}\}\big{\}}_{i=1}^{N=40K}
\times 6
\{\times 3,\times 4,\times 6\}
\sim
\{\times 3,\times 4,\times 6\}
\sim
\mathcal{D}
\widetilde{\mathcal{D}}
f=f_{n}\circ\cdots f_{2}\circ f_{1}
\mathcal{D}
L_{2}
f_{n}
\widetilde{\mathcal{D}}
\Leftrightarrow
f
\displaystyle f=f_{1}\circ f_{2}\circ f_{3},\qquad\qquad\qquad\qquad\quad\text%
{(3-layer CNNs)}
\displaystyle f
\displaystyle=f_{1}\circ f_{2}\circ f_{3},\qquad\qquad\qquad\qquad\quad\text{(%
3-layer CNNs)}
\displaystyle f=f_{1}\circ f_{2}\circ f_{3}\circ f_{4}\circ f_{5},\qquad\qquad%
\quad\,\,\text{(5-layer CNNs)}
\displaystyle f
\displaystyle=f_{1}\circ f_{2}\circ f_{3}\circ f_{4}\circ f_{5},\qquad\qquad%
\quad\,\,\text{(5-layer CNNs)}
\displaystyle f=f_{1}\circ f_{2}\circ f_{3}\circ f_{4}\circ f_{5}\circ f_{6}%
\circ f_{7}\qquad\text{(7-layer CNNs)}
\displaystyle f
\displaystyle=f_{1}\circ f_{2}\circ f_{3}\circ f_{4}\circ f_{5}\circ f_{6}%
\circ f_{7}\qquad\text{(7-layer CNNs)}
f
(9,5,5)
(1,32,32,1)
(9,5,5,5,5)
(1,32,32,32,32,1)
(9,5,5,5,5,5,5)
(1,32,32,32,32,32,32,1)
N=256
\sim
f
\sim
\mathcal{D}
\widetilde{\mathcal{D}}
\mathcal{D}\to\widetilde{\mathcal{D}}
\{\times 3,\times 4\}\to\times 6
\sim
\{\times 3\}\to\{\times 4,\times 6\}
\{\times 3\}\to\{\times 6\}
\{\times 4,\times 6\}\to\{\times 3\}
\{\times 3\}\to\{\times 4,\times 6\}
x
\{\times 3\}\to\{\times 4,\times 6\}
\{\times 3\}\to\{\times 6\}
\{\times 3,\times 4\}\to\{\times 6\}
\sim
f_{3}
f=f_{3}\circ f_{2}\circ f_{1}
x
f_{3}
f=f_{3}\circ f_{2}\circ f_{1}
x
f_{3}
f=f_{3}\circ f_{2}\circ f_{1}
f_{3}
f=f_{3}\circ f_{2}\circ f_{1}
f_{5}
f=f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{5}
f=f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{5}
f=f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{5}
f=f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{7}
f=f_{7}\circ f_{6}\circ f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{7}
f=f_{7}\circ f_{6}\circ f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{7}
f=f_{7}\circ f_{6}\circ f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
f_{7}
f=f_{7}\circ f_{6}\circ f_{5}\circ f_{4}\circ f_{3}\circ f_{2}\circ f_{1}
\to
A
D
W
\to
\to
\to
\to
\to
\to
\to
\to
\to
