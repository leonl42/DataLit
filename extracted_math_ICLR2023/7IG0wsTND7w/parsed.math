S=\{(x,y)|(x,y)\sim\mathcal{D}_{i},i=1,\dots,N\}
x\in\mathcal{X}
y\in\mathcal{Y}=\{1,\dots,C\}
S
\{\mathcal{D}_{i}\}_{i=1}^{N}
N
S
T
x
y
h
\mathcal{H}=\{h|h:\mathcal{X}\rightarrow\mathcal{Y}\}
\displaystyle e_{T}(h)\ \leq\ e_{S}(h)+\sup_{h,h^{\prime}\in\mathcal{H}}\big{|%
}d_{S}(h,h^{\prime})-d_{T}(h,h^{\prime})\big{|}+e^{*}(\mathcal{H};S,T),
\displaystyle e_{T}(h)\ \leq\ e_{S}(h)+\sup_{h,h^{\prime}\in\mathcal{H}}\big{|%
}d_{S}(h,h^{\prime})-d_{T}(h,h^{\prime})\big{|}+e^{*}(\mathcal{H};S,T),
e_{S}(h):=\mathbb{E}_{(x,y)\sim S}[\mathbb{I}(h(x)\neq y)]
h(\cdot)
S
d_{S}(h,h^{\prime}):=\mathbb{E}_{x\sim S}[\mathbb{I}(h(x)\neq h^{\prime}(x))]
h
h^{\prime}
S
e_{T}(h)
d_{T}(h,h^{\prime})
e^{*}(\mathcal{H};S,T):=\min_{h\in\mathcal{H}}e_{S}(h)+e_{T}(h)
e_{S}(h)
\mathcal{H}
h
e_{S}(h)
\mathcal{H}_{|S}
e_{S}(h)
d_{S}(h,h^{\prime})
0
h,h^{\prime}\in\mathcal{H}_{|S}
\textrm{MCD}(\mathcal{H}_{|S};T):=\sup_{h,h^{\prime}\in\mathcal{H}_{|S}}|d_{T}%
(h.h^{\prime})|=\sup_{h,h^{\prime}\in\mathcal{H}_{|S}}\mathbb{E}_{x\sim T}\big%
{[}\mathbb{I}(h(x)\neq h^{\prime}(x))\big{]}.
S
\mathcal{H}_{|S}
T
e^{*}
e^{*}
h(x)=g(\phi(x))
h^{\prime}(x)=g^{\prime}(\phi(x))
g
g^{\prime}
\phi
S
\mathcal{H}_{|S}
T
g
g^{\prime}
\phi
\phi(x)
\mathcal{H}_{|S}
\textrm{MCD}(\mathcal{H}_{|S};T)
T
\mathcal{H}
\mathcal{H}_{|S}
\mathcal{H}
\mathcal{H}_{|S}
h
\mathcal{H}
\phi_{\theta}(x)\in\mathbb{R}^{d}
\theta
W=[w_{1},\dots,w_{C}]
C
w_{j}\in\mathbb{R}^{d}
\displaystyle P(y=j|x,\theta,W)\propto e^{w_{j}^{\top}\phi_{\theta}(x)},\ \ \ %
\ j=1,\dots,C.
\displaystyle P(y=j|x,\theta,W)\propto e^{w_{j}^{\top}\phi_{\theta}(x)},\ \ \ %
\ j=1,\dots,C.
(\theta,W)
h
\mathcal{H}
\ni h
(\theta,W)
P_{\beta}(\theta,W)
\beta
\mathcal{H}
(\theta,W)\sim P_{\beta}(\theta,W)
h\in\mathcal{H}
\theta
W
P(W)
P(W)=\prod_{j=1}^{C}\mathcal{N}(w_{j};0,I)
\mathcal{H}=\{P(y|x,\theta,W)\ |\ W\sim P(W)\}
\mathcal{H}
\theta
\theta
\mathcal{H}
W
P(W)
h\in\mathcal{H}
\mathcal{H}_{|S}
P(W|S,\theta)\propto P(W)\cdot\prod_{(x,y)\sim S}P(y|x,\theta,W).
W
S
\theta
S
S
\theta
\displaystyle\theta\in\Theta_{S}\ \ \textrm{where}\ \Theta_{S}:=\{\theta\ |\ %
\log P(S|\theta)\geq L_{th}\},
\displaystyle\theta\in\Theta_{S}\ \ \textrm{where}\ \Theta_{S}:=\{\theta\ |\ %
\log P(S|\theta)\geq L_{th}\},
L_{th}
S
\mathcal{H}_{|S}
P(W|S,\theta)
\theta\in\Theta_{S}
\mathcal{H}_{|S}
h
S
\displaystyle\mathcal{H}_{|S}(\theta)=\{P(y|x,\theta,W)\ |\ W\sim P(W|S,\theta%
)\}\ \ \textrm{for}\ \theta\in\Theta_{S},
\displaystyle\mathcal{H}_{|S}(\theta)=\{P(y|x,\theta,W)\ |\ W\sim P(W|S,\theta%
)\}\ \ \textrm{for}\ \theta\in\Theta_{S},
\mathcal{H}_{|S}(\theta)
\theta
\mathcal{H}_{|S}
\theta\in\Theta_{S}
h\in\mathcal{H}_{|S}
W\sim P(W|S,\theta)
P(W|S,\theta)
\log P(S|\theta)
T
T
\displaystyle\min_{\theta\in\Theta_{S}}\max_{T}\ \textrm{MCD}(\mathcal{H}_{|S}%
(\theta);T).
\displaystyle\min_{\theta\in\Theta_{S}}\max_{T}\ \textrm{MCD}(\mathcal{H}_{|S}%
(\theta);T).
T
x
T
\mathcal{H}_{|S}
T
S
T
S
x\in T
G_{\nu}(\epsilon)
\nu
\epsilon\sim\mathcal{N}(0,I)
(x,y)\sim T
(x_{S},y_{S})\sim S
S
A_{S}\angle P_{S}=\mathcal{F}(x_{S})
x_{S}
A=G_{\nu}(\epsilon)
\epsilon\sim\mathcal{N}(0,I)
G
x=\mathcal{F}^{-1}(A\angle P_{S})
y=y_{S}
A
\mathcal{F}(\cdot)
F(u,v)=\mathcal{F}(x)=\iint x(h,w)e^{-i(hu+wv)}dhdw
A\angle P
A
P
A\angle P=A\cdot e^{i\cdot P}=A\cdot(\cos P+i\sin P)
i=\sqrt{-1}
y=y_{S}
P_{S}
x
\displaystyle\textrm{(Fix $\nu$)}\ \ \min_{\theta\in\Theta_{S}}\ \textrm{MCD}(%
\mathcal{H}_{|S}(\theta);T(\nu))
\nu
\displaystyle\textrm{(Fix $\nu$)}\ \ \min_{\theta\in\Theta_{S}}\ \textrm{MCD}(%
\mathcal{H}_{|S}(\theta);T(\nu))
\nu
\displaystyle\textrm{(Fix $\theta$)}\ \ \ \max_{\nu}\ \textrm{MCD}(\mathcal{H}%
_{|S}(\theta);T(\nu))
\theta
\displaystyle\textrm{(Fix $\theta$)}\ \ \ \max_{\nu}\ \textrm{MCD}(\mathcal{H}%
_{|S}(\theta);T(\nu))
\theta
T(\nu)
\nu
P_{S}
y=y_{S}
P(W|S,\theta)
P(W|S,\theta)
Q_{\lambda}(W)=\prod_{j=1}^{C}\mathcal{N}(w_{j};m_{j},V_{j}),
\lambda:=\{m_{j},V_{j}\}_{j=1}^{C}
Q_{\lambda}(W)\approx P(W|S,\theta)
\textrm{ELBO}(\lambda,\theta;S):=\sum_{(x,y)\sim S}\mathbb{E}_{Q_{\lambda}(W)}%
\big{[}\log P(y|x,W,\theta)\big{]}-\textrm{KL}\big{(}Q_{\lambda}(W)||P(W)\big{%
)},
\log P(S|\theta)
\textrm{ELBO}(\lambda,\theta;S)
\lambda
Q_{\lambda}(W)\approx P(W|S,\theta)
\theta
\log P(S|\theta)
\theta\in\Theta_{S}
\textrm{MCD}(\mathcal{H}_{|S}(\theta);T)
T
G_{\nu}
W\sim Q_{\lambda}(W)
x\sim T
j^{*}
x\sim T
j^{*}
j^{*}=\arg\max_{j}w_{j}^{\top}\phi(x)
\phi_{\theta}(x)
j^{\dagger}
j^{\dagger}=\arg\max_{j\neq j^{*}}w_{j}^{\top}\phi(x)
w_{j^{*}}^{\top}\phi(x)<w_{j^{\dagger}}^{\top}\phi(x)
W\sim Q_{\lambda}(W)
w_{j^{*}}^{\top}\phi(x)
w_{j^{\dagger}}^{\top}\phi(x)
f_{j}(x):=w_{j}^{\top}\phi(x)
Q_{\lambda}(W)
\displaystyle f_{j}(x)\sim\mathcal{N}(\mu_{j}(x),\sigma_{j}(x)^{2})\ \ \textrm%
{where}\ \ \mu_{j}(x)=m_{j}^{\top}\phi(x),\ \sigma_{j}^{2}(x)=\phi(x)^{\top}V_%
{j}\phi(x),
\displaystyle f_{j}(x)\sim\mathcal{N}(\mu_{j}(x),\sigma_{j}(x)^{2})\ \ \textrm%
{where}\ \ \mu_{j}(x)=m_{j}^{\top}\phi(x),\ \sigma_{j}^{2}(x)=\phi(x)^{\top}V_%
{j}\phi(x),
\mu_{j^{*}}(x)-\alpha\sigma_{j^{*}}(x)>\mu_{j^{\dagger}}(x)+\alpha\sigma_{j^{%
\dagger}}(x)
\alpha=1.96
2.5\%
\xi(x)\geq 0
\mu_{j^{*}}(x)-\alpha\sigma_{j^{*}}(x)\geq 1+\max_{j\neq j^{*}}\big{(}\mu_{j}(%
x)+\alpha\sigma_{j}(x)\big{)}-\xi(x).
1
\mu
\sigma
\theta
\displaystyle\textrm{MCD}(\theta;T):=\mathbb{E}_{x\sim T}\Big{(}1+\mathcal{T}^%
{2}\big{(}\mu_{j}(x)+\alpha\sigma_{j}(x)\big{)}-\mathcal{T}^{1}\big{(}\mu_{j}(%
x)-\alpha\sigma_{j}(x)\big{)}\Big{)}_{+}
\displaystyle\textrm{MCD}(\theta;T):=\mathbb{E}_{x\sim T}\Big{(}1+\mathcal{T}^%
{2}\big{(}\mu_{j}(x)+\alpha\sigma_{j}(x)\big{)}-\mathcal{T}^{1}\big{(}\mu_{j}(%
x)-\alpha\sigma_{j}(x)\big{)}\Big{)}_{+}
\mathcal{T}^{k}
k
(a)_{+}=\max(0,a)
\mathcal{H}_{|S}
C=3
f_{j}(x)\sim\mathcal{N}(\mu_{j}(x),\sigma_{j}(x)^{2})
j=1,2,3
x\in T
y=2
\mu_{2}(x)
\mu_{2}(x)-1.96\sigma_{2}(x)
\mu_{1}(x)+1.96\sigma_{1}(x)
\mathcal{H}_{|S}
C=3
f_{j}(x)\sim\mathcal{N}(\mu_{j}(x),\sigma_{j}(x)^{2})
j=1,2,3
x\in T
y=2
\mu_{2}(x)
\mu_{2}(x)-1.96\sigma_{2}(x)
\mu_{1}(x)+1.96\sigma_{1}(x)
y=y_{S}
P_{S}
1\sim 4
\{(x,y)\}\in T
y
y
\mu_{y}(x)-\alpha\sigma_{y}(x)\geq 1+\max_{j\neq y}\big{(}\mu_{j}(x)+\alpha%
\sigma_{j}(x)\big{)}-\xi(x),
y
x
\displaystyle\textrm{SMCD}(\theta;T):=\mathbb{E}_{(x,y)\sim T}\Big{(}1+\max_{j%
\neq y}\big{(}\mu_{j}(x)+\alpha\sigma_{j}(x)\big{)}-\big{(}\mu_{y}(x)-\alpha%
\sigma_{y}(x)\big{)}\Big{)}_{+}.
\displaystyle\textrm{SMCD}(\theta;T):=\mathbb{E}_{(x,y)\sim T}\Big{(}1+\max_{j%
\neq y}\big{(}\mu_{j}(x)+\alpha\sigma_{j}(x)\big{)}-\big{(}\mu_{y}(x)-\alpha%
\sigma_{y}(x)\big{)}\Big{)}_{+}.
\lambda
\lambda
y
T
e^{*}(\mathcal{H};S,T)
e^{*}(\mathcal{H};S,T)=\min_{h\in\mathcal{H}}e_{S}(h)+e_{T}(h)\approx\min_{h%
\in\mathcal{H}_{|S}}e_{T}(h)
\theta
e_{T}(h)
h\in\mathcal{H}_{|S}(\theta)
\eta>0
\min_{\lambda,\theta}\ -\textrm{ELBO}(\lambda,\theta;S)+\eta\textrm{SMCD}(%
\theta;T)
+
\nu
\max_{\nu}\ \textrm{SMCD}(\theta;T)
\theta
\lambda
\theta
W\sim Q_{\lambda}(W)
w_{j}=m_{j}
Q_{\lambda}(W)
G_{\nu}
A=G_{\nu}(\epsilon)
A_{S}
P_{S}
A
\displaystyle A\leftarrow\lambda A+(1-\lambda)A_{S}\ \ \textrm{where}\ \ %
\lambda\sim\textrm{Uniform}(0,\alpha).\vspace{-0.5em}
\displaystyle A\leftarrow\lambda A+(1-\lambda)A_{S}\ \ \textrm{where}\ \ %
\lambda\sim\textrm{Uniform}(0,\alpha).\vspace{-0.5em}
(\lambda,\theta)
F(-u,-v)=\overline{F(u,v)}
\eta
\eta=0.1
84.2
77.3
67.6
47.8
44.0
64.2
83.5
78.6
64.3
47.6
33.9
61.6
84.4
76.7
66.0
43.2
33.3
60.7
84.6
77.4
68.1
47.9
39.2
63.4
84.9
77.2
66.8
47.8
41.2
63.6
86.2
78.8
68.7
47.7
41.5
64.5
84.7
77.5
66.4
42.2
23.4
58.8
83.7
78.6
65.9
46.7
38.3
62.6
82.6
77.5
65.7
45.8
38.3
62.0
84.6
77.2
66.4
45.6
40.6
62.9
86.3
77.8
68.1
48.6
40.3
64.2
85.1
77.6
64.8
45.5
35.5
61.7
84.9
78.3
66.4
46.4
33.6
61.9
85.2
77.1
65.5
46.6
38.9
62.7
85.2
77.9
60.4
44.0
34.0
60.3
88.2
-
66.6
-
-
-
86.4
76.6
66.6
45.4
42.6
63.5
84.7
75.9
64.0
46.8
42.0
62.7
88.1
79.1
70.6
50.0
46.5
66.9
+
88.1
77.7
70.6
51.0
46.7
66.8
+
88.1
78.2
70.3
51.2
46.4
66.8
{\bf 89.3}
{\bf 79.5}
{\bf 71.5}
{\bf 52.4}
{\bf 47.1}
{\bf 68.0}
1.1\%
>
+
+
+
\eta
\eta
\eta
\eta=0
\eta
\eta
\eta
\alpha
\alpha
\alpha=0
\alpha
\alpha
88.94\pm 0.23
83.83\pm 0.19
97.27\pm 0.10
81.77\pm 0.36
87.95
88.90\pm 0.16
81.80\pm 0.17
97.43\pm 0.14
80.86\pm 0.31
87.25
84.20\pm 0.68
81.56\pm 0.55
94.83\pm 0.12
79.28\pm 0.94
84.97
88.85\pm 0.15
83.62\pm 0.26
97.23\pm 0.15
82.10\pm 0.63
87.95
\ {\bf 89.80\pm 0.34}\ 
\ {\bf 85.16\pm 0.65}\ 
\ {\bf 97.59\pm 0.27}\ 
\ {\bf 84.67\pm 0.82}\ 
\ {\bf 89.30}\ 
100
100
100
Q_{\lambda}(W)
5\times 10^{-5}
\theta
\lambda
t_{s}
t_{e}
t\in[t_{s},t_{e}]
\displaystyle\theta_{SWAD}=\frac{1}{t_{e}-t_{s}+1}\sum_{t=t_{s}}^{t_{e}}\theta%
^{t},\ \ \ \ \lambda_{SWAD}=\frac{1}{t_{e}-t_{s}+1}\sum_{t=t_{s}}^{t_{e}}%
\lambda^{t},
\displaystyle\theta_{SWAD}=\frac{1}{t_{e}-t_{s}+1}\sum_{t=t_{s}}^{t_{e}}\theta%
^{t},\ \ \ \ \lambda_{SWAD}=\frac{1}{t_{e}-t_{s}+1}\sum_{t=t_{s}}^{t_{e}}%
\lambda^{t},
\theta^{t}
\lambda^{t}
t
(\theta_{SWAD},\lambda_{SWAD})
[t_{s},t_{e}]
t
l_{val}^{t}
t_{s}
t
N_{s}
N_{s}=3
\displaystyle t_{s}=\min\{t-N_{s}+1\ |\ l_{val}^{t-N_{s}+1}\leq l_{val}^{t},l_%
{val}^{t-1},\dots,l_{val}^{t-N_{s}+1}\}.
\displaystyle t_{s}=\min\{t-N_{s}+1\ |\ l_{val}^{t-N_{s}+1}\leq l_{val}^{t},l_%
{val}^{t-1},\dots,l_{val}^{t-N_{s}+1}\}.
t_{s}
\displaystyle\overline{l}_{val}=\frac{\sum_{t=t_{s}}^{t_{s}+N_{s}-1}l_{val}^{t%
}}{N_{s}},
\displaystyle\overline{l}_{val}=\frac{\sum_{t=t_{s}}^{t_{s}+N_{s}-1}l_{val}^{t%
}}{N_{s}},
t_{e}
\overline{l}_{val}
\displaystyle t_{e}=\min\{t-N_{e}\ |\ l_{val}^{t},l_{val}^{t-1},\dots,l_{val}^%
{t-N_{e}+1}>r\cdot\overline{l}_{val}\},
\displaystyle t_{e}=\min\{t-N_{e}\ |\ l_{val}^{t},l_{val}^{t-1},\dots,l_{val}^%
{t-N_{e}+1}>r\cdot\overline{l}_{val}\},
r
N_{e}
r=1.3
N_{e}=6
N_{s}
N_{e}
r
N_{s}=3
N_{e}=6
r=1.3
r=1.2
V
V=50
V=500
V=100
V
S
\eta
\alpha
\gamma
N_{s}
N_{e}
r
\theta
\lambda
\nu
\leftarrow FALSE
t\leftarrow 0
S_{B}=\{(x^{S}_{i},y^{S}_{i})\}_{i=1}^{n}
S
\{(A^{S}_{i},P^{S}_{i})\}_{i=1}^{n}
A^{S}_{i}\angle P^{S}_{i}=\mathcal{F}(x^{S}_{i})
A^{G}_{i}=G_{\nu}(\epsilon_{i})
\epsilon_{i}\sim\mathcal{N}(0,I)
i=1,\dots,n
A^{G}_{i}\leftarrow\lambda A^{G}_{i}+(1-\lambda)A^{S}_{i}
\lambda\sim\textrm{Uniform}(0,\alpha)
T_{B}=\{(x^{T}_{i},y^{T}_{i})\}_{i=1}^{n}
x^{T}_{i}=\mathcal{F}^{-1}(A^{G}_{i}\angle P^{S}_{i})
y^{T}_{i}=y^{S}_{i}
\mathcal{L}_{model}:=-\textrm{ELBO}(\lambda,\theta;S_{B})+\eta\textrm{SMCD}(%
\theta;T_{B})
(\lambda,\theta)\leftarrow(\lambda,\theta)-\gamma\nabla_{(\lambda,\theta)}%
\mathcal{L}_{model}
\mathcal{L}_{gen}:=-\textrm{SMCD}(\theta;T_{B})
\nu\leftarrow\nu-\gamma\nabla_{\nu}\mathcal{L}_{gen}
t\leftarrow t+1
(\lambda^{t},\theta^{t})\leftarrow(\lambda,\theta)
==FALSE
l_{val}^{t-N_{s}+1}=\min_{0\leq t^{\prime}<N_{s}}l_{val}^{t-t^{\prime}}
t_{s}\leftarrow t-N_{s}+1
\overline{l}_{val}\leftarrow\frac{1}{N_{s}}\sum_{t^{\prime}=0}^{N_{s}-1}l_{val%
}^{t-t^{\prime}}
\leftarrow True
r\cdot\overline{l}_{val}<\min_{0\leq t^{\prime}<N_{e}}l_{val}^{t-t^{\prime}}
t_{e}\leftarrow t-N_{e}
\theta_{SWAD}=\frac{1}{t_{e}-t_{s}+1}\sum_{t=t_{s}}^{t_{e}}\theta^{t}
\lambda_{SWAD}=\frac{1}{t_{e}-t_{s}+1}\sum_{t=t_{s}}^{t_{e}}\lambda^{t}
\eta
\alpha
100
100
82.9
80.5
95.0
72.3
82.7
82.6
78.1
94.5
78.3
83.4
87.2
79.2
97.6
70.3
83.6
87.5
79.3
{\bf 98.3}
76.3
85.3
85.8
81.1
97.2
77.4
85.4
86.6
81.5
97.1
78.1
85.8
87.0
80.6
96.0
82.9
86.6
85.7\pm 0.6
77.1\pm 0.8
97.4\pm 0.4
76.6\pm 0.7
84.2
84.8\pm 1.3
76.4\pm 1.1
96.7\pm 0.6
76.1\pm 1.0
83.5
83.5\pm 0.9
79.1\pm 0.6
96.7\pm 0.3
78.3\pm 2.0
84.4
86.1\pm 0.5
78.9\pm 0.8
97.6\pm 0.1
75.8\pm 1.8
84.6
85.5\pm 1.4
80.1\pm 1.7
97.4\pm 0.3
76.6\pm 1.1
84.9
88.3\pm 0.2
80.0\pm 0.5
97.5\pm 0.3
78.8\pm 1.3
86.2
86.1\pm 1.4
79.4\pm 0.9
96.6\pm 0.2
76.5\pm 0.5
84.7
86.4\pm 0.8
77.4\pm 0.8
97.3\pm 0.4
73.5\pm 2.3
83.7
84.6\pm 1.8
75.5\pm 0.9
96.8\pm 0.3
73.5\pm 0.6
82.6
87.5\pm 0.8
77.1\pm 0.5
96.4\pm 0.8
77.3\pm 1.8
84.6
87.4\pm 1.0
80.7\pm 0.6
97.1\pm 0.1
80.0\pm 0.4
86.3
86.8\pm 0.6
76.8\pm 0.5
97.4\pm 0.3
79.3\pm 1.2
85.1
86.0\pm 1.6
79.1\pm 0.6
96.9\pm 0.5
77.7\pm 1.7
84.9
85.4\pm 0.8
79.7\pm 1.8
97.6\pm 0.3
78.2\pm 1.2
85.2
86.8\pm 0.5
79.0\pm 1.4
96.6\pm 0.1
78.5\pm 2.3
85.2
89.6\pm 0.5
81.8\pm 0.2
96.8\pm 0.1
84.5\pm 0.8
88.2
87.8\pm 0.2
80.5\pm 1.1
96.2\pm 0.2
81.2\pm 0.6
86.4
84.7\pm 0.6
81.0\pm 1.1
95.0\pm 0.2
78.1\pm 1.0
84.7
89.3\pm 0.2
83.4\pm 0.6
97.3\pm 0.3
82.5\pm 0.5
88.1
+
89.6\pm 0.8
82.5\pm 0.3
96.6\pm 0.2
83.8\pm 0.8
88.1
+
88.7\pm 0.1
83.2\pm 0.4
96.4\pm 0.1
84.1\pm 0.5
88.1
{\bf 89.8\pm 0.3}
{\bf 85.2\pm 0.6}
97.6\pm 0.3
{\bf 84.7\pm 0.8}
{\bf 89.3}
98.0\pm 0.3
64.7\pm 1.2
71.4\pm 1.2
75.2\pm 1.6
77.3
98.6\pm 0.1
64.9\pm 0.9
73.4\pm 0.6
77.3\pm 0.9
78.6
97.3\pm 0.3
63.4\pm 0.9
69.5\pm 0.8
76.7\pm 0.7
76.7
98.3\pm 0.6
64.8\pm 1.0
72.1\pm 0.5
74.3\pm 0.8
77.4
97.4\pm 0.2
65.2\pm 0.7
71.0\pm 1.4
75.3\pm 1.0
77.2
98.3\pm 0.1
{\bf 66.1\pm 1.2}
73.4\pm 0.3
77.5\pm 1.2
78.8
97.7\pm 0.1
64.0\pm 1.1
72.8\pm 0.2
75.3\pm 3.3
77.5
{\bf 99.0\pm 0.3}
65.1\pm 1.4
73.1\pm 0.3
77.2\pm 0.6
78.6
97.1\pm 0.3
65.1\pm 1.2
70.7\pm 0.8
77.1\pm 1.5
77.5
97.8\pm 0.4
64.3\pm 0.3
71.5\pm 0.7
75.3\pm 1.7
77.2
97.9\pm 0.4
64.5\pm 0.5
71.4\pm 1.3
77.5\pm 0.5
77.8
98.7\pm 0.2
63.6\pm 0.7
71.3\pm 1.2
76.7\pm 0.6
77.6
98.4\pm 0.3
64.4\pm 1.4
74.1\pm 0.4
76.2\pm 1.3
78.3
97.9\pm 0.1
62.5\pm 0.7
72.3\pm 1.2
75.6\pm 0.8
77.1
98.6\pm 0.3
64.5\pm 1.1
72.6\pm 0.5
75.7\pm 1.7
77.9
97.6\pm 0.1
65.5\pm 0.5
69.2\pm 0.8
73.9\pm 0.7
76.6
97.4\pm 0.7
65.6\pm 0.3
70.5\pm 0.9
70.1\pm 0.8
75.9
98.8\pm 0.1
63.3\pm 0.3
75.3\pm 0.5
{\bf 79.2\pm 0.6}
79.1
+
98.4\pm 0.1
63.1\pm 0.3
72.4\pm 0.5
77.0\pm 0.4
77.7
+
98.7\pm 0.1
63.9\pm 0.5
73.5\pm 0.2
76.7\pm 0.2
78.2
{\bf 99.0\pm 0.1}
64.5\pm 0.6
{\bf 75.4\pm 0.3}
78.9\pm 0.6
{\bf 79.5}
63.1\pm 0.3
51.9\pm 0.4
77.2\pm 0.5
78.1\pm 0.2
67.6
58.9\pm 2.3
52.2\pm 1.6
72.1\pm 2.9
74.0\pm 2.5
64.3
60.4\pm 0.7
52.7\pm 1.0
75.0\pm 0.7
76.0\pm 0.7
66.0
62.4\pm 0.8
54.8\pm 0.6
76.9\pm 0.3
78.3\pm 0.2
68.1
61.5\pm 0.9
53.2\pm 0.6
75.0\pm 1.2
77.5\pm 0.4
66.8
65.3\pm 0.4
54.4\pm 0.5
76.5\pm 0.1
78.4\pm 0.5
68.7
60.4\pm 0.2
53.3\pm 0.3
74.3\pm 0.1
77.4\pm 0.6
66.4
59.9\pm 1.3
53.0\pm 0.3
73.6\pm 0.7
76.9\pm 0.5
65.9
61.5\pm 1.4
50.4\pm 2.4
74.4\pm 0.9
76.6\pm 0.8
65.7
61.5\pm 0.7
52.4\pm 0.6
74.9\pm 0.4
76.8\pm 0.4
66.4
63.4\pm 0.2
54.8\pm 0.4
75.8\pm 0.4
78.3\pm 0.3
68.1
58.9\pm 0.8
51.0\pm 0.5
74.1\pm 0.1
75.2\pm 0.3
64.8
60.7\pm 0.9
53.0\pm 0.9
75.3\pm 0.1
76.6\pm 0.5
66.4
60.7\pm 1.4
51.4\pm 0.3
74.8\pm 1.1
75.1\pm 1.3
65.5
51.1\pm 0.3
53.2\pm 0.4
68.2\pm 0.7
69.2\pm 0.6
60.4
60.3\pm 0.1
54.9\pm 0.4
74.5\pm 0.1
76.6\pm 0.1
66.6
61.2\pm 0.1
55.2\pm 0.1
74.0\pm 0.2
76.2\pm 0.4
66.6
57.1\pm 0.3
51.9\pm 0.1
72.5\pm 0.3
74.4\pm 0.2
64.0
66.1\pm 0.4
57.7\pm 0.4
78.4\pm 0.1
80.2\pm 0.2
70.6
+
66.4\pm 0.2
58.3\pm 0.2
78.0\pm 0.1
79.6\pm 0.1
70.6
+
65.9\pm 0.2
57.9\pm 0.4
77.8\pm 0.2
79.7\pm 0.1
70.3
{\bf 67.5\pm 0.3}
{\bf 58.5\pm 0.1}
{\bf 79.3\pm 0.1}
{\bf 80.7\pm 0.1}
{\bf 71.5}
54.3\pm 0.4
42.5\pm 0.7
55.6\pm 0.3
38.8\pm 2.5
47.8
54.6\pm 1.3
39.8\pm 1.9
56.2\pm 1.8
39.6\pm 0.8
47.6
41.2\pm 0.7
38.6\pm 2.1
56.7\pm 0.9
36.4\pm 2.1
43.2
59.6\pm 2.0
42.2\pm 1.4
55.9\pm 0.8
33.9\pm 1.4
47.9
54.2\pm 3.0
44.3\pm 1.1
55.6\pm 0.3
36.9\pm 2.2
47.8
51.6\pm 2.4
42.2\pm 1.0
57.0\pm 1.0
39.8\pm 2.9
47.7
41.9\pm 3.0
34.8\pm 1.0
57.0\pm 1.9
35.2\pm 1.8
42.2
51.1\pm 3.5
40.6\pm 0.6
57.4\pm 0.5
37.7\pm 1.8
46.7
47.0\pm 1.9
41.3\pm 4.8
54.9\pm 1.7
39.8\pm 2.3
45.8
49.3\pm 1.2
39.6\pm 6.3
55.6\pm 1.1
37.8\pm 0.8
45.6
53.0\pm 2.9
43.0\pm 2.5
57.9\pm 0.6
40.4\pm 1.3
48.6
49.3\pm 0.7
38.3\pm 2.4
55.8\pm 0.8
38.7\pm 1.3
45.5
48.2\pm 4.3
41.7\pm 1.3
56.8\pm 0.8
38.7\pm 3.1
46.4
50.2\pm 2.2
39.2\pm 1.4
56.3\pm 1.4
40.8\pm 0.6
46.6
54.3\pm 1.1
34.1\pm 1.1
55.9\pm 1.1
31.7\pm 2.1
44.0
52.4\pm 1.2
42.3\pm 1.0
55.5\pm 0.3
31.3\pm 0.9
45.4
56.0\pm 0.8
38.9\pm 0.7
56.9\pm 0.2
35.7\pm 0.8
46.8
55.4\pm 0.0
44.9\pm 1.1
59.7\pm 0.4
39.9\pm 0.2
50.0
+
57.0\pm 0.6
{\bf 46.6\pm 1.1}
{\bf 60.3\pm 0.5}
40.1\pm 0.3
51.0
+
56.6\pm 0.6
46.3\pm 0.3
60.2\pm 0.6
41.8\pm 0.4
51.2
{\bf 61.0\pm 0.3}
46.2\pm 2.3
{\bf 60.3\pm 0.7}
{\bf 42.3\pm 0.9}
{\bf 52.4}
65.2
22.2
50.0
15.7
59.6
49.0
43.6
59.8
{\bf 25.6}
50.2
11.5
64.6
50.1
43.6
63.0\pm 0.2
21.2\pm 0.2
50.1\pm 0.4
13.9\pm 0.5
63.7\pm 0.2
52.0\pm 0.5
44.0
48.5\pm 2.8
15.0\pm 1.5
38.3\pm 4.3
10.9\pm 0.5
48.2\pm 5.2
42.3\pm 3.1
33.9
47.2\pm 0.5
17.5\pm 0.4
33.8\pm 0.5
9.3\pm 0.3
51.6\pm 0.4
40.1\pm 0.6
33.3
55.7\pm 0.3
18.5\pm 0.5
44.3\pm 0.5
12.5\pm 0.4
55.8\pm 0.3
48.2\pm 0.5
39.2
59.1\pm 0.2
19.1\pm 0.3
45.8\pm 0.7
13.4\pm 0.3
59.6\pm 0.2
50.2\pm 0.4
41.2
59.2\pm 0.1
19.7\pm 0.2
46.6\pm 0.3
13.4\pm 0.4
59.8\pm 0.2
50.1\pm 0.6
41.5
32.1\pm 13.3
11.0\pm 4.6
26.8\pm 11.3
8.7\pm 2.1
32.7\pm 13.8
28.9\pm 11.9
23.4
53.1\pm 0.2
18.3\pm 0.1
44.2\pm 0.7
11.8\pm 0.1
55.5\pm 0.4
46.8\pm 0.6
38.3
54.6\pm 0.4
17.3\pm 0.1
43.7\pm 0.9
12.1\pm 0.7
56.2\pm 0.4
45.9\pm 0.5
38.3
57.9\pm 0.5
18.5\pm 0.4
46.0\pm 0.1
12.5\pm 0.1
59.5\pm 0.3
49.2\pm 0.1
40.6
57.7\pm 0.3
19.0\pm 0.2
45.3\pm 0.3
12.7\pm 0.5
58.1\pm 0.5
48.8\pm 0.2
40.3
49.7\pm 0.3
16.3\pm 0.5
40.9\pm 1.1
9.4\pm 0.1
53.4\pm 0.4
43.5\pm 0.4
35.5
47.3\pm 3.5
16.0\pm 1.5
35.8\pm 4.6
10.9\pm 0.3
49.6\pm 4.9
42.0\pm 3.0
33.6
55.0\pm 1.2
18.3\pm 0.5
44.4\pm 0.6
12.2\pm 0.2
55.7\pm 0.7
47.8\pm 0.9
38.9
51.9\pm 0.4
13.3\pm 0.2
37.0\pm 0.5
12.3\pm 0.1
46.1\pm 0.3
43.4\pm 0.4
34.0
62.5\pm 0.3
19.4\pm 0.1
48.2\pm 0.4
13.9\pm 0.3
60.5\pm 0.7
51.0\pm 0.7
42.6
62.3\pm 0.1
19.0\pm 0.2
47.2\pm 0.4
12.9\pm 0.6
59.5\pm 0.3
51.0\pm 0.1
42.0
66.0\pm 0.1
22.4\pm 0.3
53.5\pm 0.1
16.1\pm 0.2
65.8\pm 0.4
55.5\pm 0.3
46.5
+
66.3\pm 0.1
22.7\pm 0.2
53.7\pm 0.1
16.3\pm 0.1
65.0\pm 0.6
55.9\pm 0.1
46.7
+
66.1\pm 0.1
22.4\pm 0.2
53.3\pm 0.1
16.2\pm 0.3
64.6\pm 0.5
55.6\pm 0.1
46.4
{\bf 66.7\pm 0.1}
22.9\pm 0.2
{\bf 54.0\pm 0.1}
{\bf 16.7\pm 0.2}
{\bf 65.9\pm 0.1}
{\bf 56.3\pm 0.1}
{\bf 47.1}
\eta
\eta
\eta=0.0
89.08\pm 0.14
83.55\pm 0.16
97.23\pm 0.19
82.55\pm 0.30
88.10
\eta=0.01
89.24\pm 0.26
84.41\pm 0.53
97.17\pm 0.07
84.31\pm 0.37
88.78
\eta=0.05
89.52\pm 0.26
84.83\pm 0.20
97.33\pm 0.17
83.75\pm 0.14
88.86
\eta=0.1
\ {\bf 89.80\pm 0.34}\ 
\ {\bf 85.16\pm 0.65}\ 
\ {\bf 97.59\pm 0.27}\ 
\ {\bf 84.67\pm 0.82}\ 
\ {\bf 89.30}\ 
\eta=0.2
89.40\pm 0.60
84.57\pm 0.25
97.33\pm 0.15
83.88\pm 0.16
88.80
\eta=0.5
89.00\pm 0.14
84.40\pm 0.38
97.03\pm 0.17
83.10\pm 0.80
88.38
\eta=1.0
89.11\pm 0.36
84.20\pm 0.55
96.49\pm 0.22
82.39\pm 0.57
88.05
\eta=0.0
66.09\pm 0.28
57.72\pm 0.34
78.47\pm 0.16
80.19\pm 0.11
70.62
\eta=0.01
66.86\pm 0.17
58.43\pm 0.34
78.53\pm 0.09
80.51\pm 0.31
71.08
\eta=0.05
66.95\pm 0.09
{\bf 58.56\pm 0.32}
78.96\pm 0.28
80.46\pm 0.24
71.23
\eta=0.1
\ {\bf 67.46\pm 0.28}\ 
58.45\pm 0.13
\ {\bf 79.27\pm 0.07}\ 
\ {\bf 80.70\pm 0.11}\ 
\ {\bf 71.47}\ 
\eta=0.15
66.46\pm 0.33
58.31\pm 0.22
78.59\pm 0.33
80.51\pm 0.09
70.97
\eta=0.2
66.05\pm 0.03
58.10\pm 0.11
78.69\pm 0.18
80.45\pm 0.06
70.82
\eta=0.25
66.15\pm 0.17
58.29\pm 0.36
78.16\pm 0.04
79.87\pm 0.21
70.62
\alpha
\alpha
\alpha=0.0
89.29\pm 0.37
83.55\pm 0.20
97.11\pm 0.07
82.17\pm 0.91
88.03
\alpha=0.2
89.23\pm 0.22
83.80\pm 0.21
97.25\pm 0.05
82.59\pm 0.84
88.22
\alpha=0.4
89.37\pm 0.17
83.93\pm 0.07
97.27\pm 0.10
83.37\pm 0.43
88.49
\alpha=0.6
89.42\pm 0.48
84.30\pm 0.16
97.31\pm 0.13
83.71\pm 0.60
88.69
\alpha=0.8
89.47\pm 0.61
84.39\pm 0.18
97.41\pm 0.15
83.68\pm 0.15
88.74
\alpha=0.9
89.66\pm 0.23
85.04\pm 0.28
\ {\bf 97.60\pm 0.13}\ 
84.27\pm 0.40
89.14
\alpha=1.0
\ {\bf 89.80\pm 0.34}\ 
\ {\bf 85.16\pm 0.65}\ 
97.59\pm 0.27
\ {\bf 84.67\pm 0.82}\ 
\ {\bf 89.30}\ 
\alpha=0.0
65.99\pm 0.17
57.72\pm 0.16
78.36\pm 0.08
80.22\pm 0.09
70.57
\alpha=0.1
67.04\pm 0.15
58.09\pm 0.11
78.72\pm 0.15
80.36\pm 0.08
71.05
\alpha=0.2
\ {\bf 67.46\pm 0.28}\ 
58.45\pm 0.13
\ {\bf 79.27\pm 0.07}\ 
\ {\bf 80.70\pm 0.11}\ 
\ {\bf 71.47}\ 
\alpha=0.3
66.98\pm 0.24
\ {\bf 58.50\pm 0.22}\ 
78.87\pm 0.18
80.45\pm 0.06
71.20
\alpha=0.4
67.04\pm 0.32
58.37\pm 0.26
78.57\pm 0.09
80.43\pm 0.09
71.10
\alpha=0.6
66.45\pm 0.33
57.99\pm 0.20
78.53\pm 0.21
80.22\pm 0.11
70.80
\alpha=0.8
66.56\pm 0.23
57.89\pm 0.18
78.50\pm 0.12
80.21\pm 0.18
70.79
\alpha=1.0
66.47\pm 0.30
57.96\pm 0.09
78.46\pm 0.30
79.97\pm 0.29
70.72
Q_{\lambda}(W)\approx P(W|S,\theta)
\displaystyle\textrm{KL}\big{(}Q_{\lambda}(W)||P(W|S,\theta)\big{)}\ =\ %
\mathbb{E}_{Q_{\lambda}(W)}\bigg{[}\log\frac{Q_{\lambda}(W)}{P(W|S,\theta)}%
\bigg{]}
\displaystyle\textrm{KL}\big{(}Q_{\lambda}(W)||P(W|S,\theta)\big{)}\ =\ %
\mathbb{E}_{Q_{\lambda}(W)}\bigg{[}\log\frac{Q_{\lambda}(W)}{P(W|S,\theta)}%
\bigg{]}
\displaystyle\ \ =\ \mathbb{E}_{Q_{\lambda}(W)}\bigg{[}\log\frac{Q_{\lambda}(W%
)P(S|\theta)}{P(S|W,\theta)P(W)}\bigg{]}
\displaystyle\ \ =\ \mathbb{E}_{Q_{\lambda}(W)}\bigg{[}\log\frac{Q_{\lambda}(W%
)P(S|\theta)}{P(S|W,\theta)P(W)}\bigg{]}
\displaystyle\ \ =\ \log P(S|\theta)-\mathbb{E}_{Q_{\lambda}(W)}\big{[}\log P(%
S|W,\theta)\big{]}+\mathbb{E}_{Q_{\lambda}(W)}\bigg{[}\log\frac{Q_{\lambda}(W)%
}{P(W)}\bigg{]}
\displaystyle\ \ =\ \log P(S|\theta)-\mathbb{E}_{Q_{\lambda}(W)}\big{[}\log P(%
S|W,\theta)\big{]}+\mathbb{E}_{Q_{\lambda}(W)}\bigg{[}\log\frac{Q_{\lambda}(W)%
}{P(W)}\bigg{]}
\displaystyle\ \ =\ \log P(S|\theta)-\mathbb{E}_{Q_{\lambda}(W)}\big{[}\log P(%
S|W,\theta)\big{]}+\textrm{KL}\big{(}Q_{\lambda}(W)||P(W)\big{)}.
\displaystyle\ \ =\ \log P(S|\theta)-\mathbb{E}_{Q_{\lambda}(W)}\big{[}\log P(%
S|W,\theta)\big{]}+\textrm{KL}\big{(}Q_{\lambda}(W)||P(W)\big{)}.
\displaystyle\ \ =\ \log P(S|\theta)-\sum_{(x,y)\sim S}\mathbb{E}_{Q_{\lambda}%
(W)}\big{[}\log P(y|x,W,\theta)\big{]}+\textrm{KL}\big{(}Q_{\lambda}(W)||P(W)%
\big{)}.
\displaystyle\ \ =\ \log P(S|\theta)-\sum_{(x,y)\sim S}\mathbb{E}_{Q_{\lambda}%
(W)}\big{[}\log P(y|x,W,\theta)\big{]}+\textrm{KL}\big{(}Q_{\lambda}(W)||P(W)%
\big{)}.
\log P(S|\theta)\geq\sum_{(x,y)\sim S}\mathbb{E}_{Q_{\lambda}(W)}\big{[}\log P%
(y|x,W,\theta)\big{]}-\textrm{KL}\big{(}Q_{\lambda}(W)||P(W)\big{)},
77.0\pm 0.6
75.9\pm 0.6
96.0\pm 0.1
69.2\pm 0.6
79.5
76.8\pm 0.7
74.9\pm 0.7
95.8\pm 0.3
66.6\pm 0.7
78.5
83.1\pm 0.8
78.6\pm 0.9
95.9\pm 0.4
74.2\pm 2.7
82.9
83.9\pm 0.4
{\bf 79.4\pm 0.7}
{\bf 96.8\pm 0.4}
75.0\pm 0.7
83.9
{\bf 84.5\pm 0.6}
78.5\pm 0.5
95.7\pm 0.1
{\bf 80.9\pm 0.2}
{\bf 84.9}
72.7\pm 0.2
73.2\pm 0.3
10.0\pm 0.0
52.0
72.0\pm 0.2
73.2\pm 0.0
10.1\pm 0.2
51.8
72.7\pm 0.3
73.1\pm 0.3
10.0\pm 0.0
51.9
72.4\pm 0.2
73.3\pm 0.3
10.0\pm 0.1
51.9
71.4\pm 0.4
73.3\pm 0.0
10.0\pm 0.1
51.6
71.8\pm 0.4
73.3\pm 0.2
10.1\pm 0.1
51.7
72.1\pm 0.2
72.8\pm 0.2
10.5\pm 0.2
51.8
72.0\pm 0.3
72.4\pm 0.5
10.0\pm 0.2
51.5
72.2\pm 0.3
73.2\pm 0.2
10.4\pm 0.3
51.9
72.6\pm 0.1
73.8\pm 0.1
10.5\pm 0.1
52.3
95.6\pm 0.1
99.0\pm 0.1
98.9\pm 0.0
99.1\pm 0.1
99.0\pm 0.0
96.7\pm 0.2
98.1
95.9\pm 0.2
98.9\pm 0.0
99.0\pm 0.0
98.8\pm 0.1
98.9\pm 0.1
95.5\pm 0.3
97.8
95.9\pm 0.1
98.9\pm 0.0
99.0\pm 0.1
99.0\pm 0.0
99.0\pm 0.0
96.9\pm 0.1
98.1
96.1\pm 0.2
99.1\pm 0.0
98.9\pm 0.0
99.0\pm 0.0
99.0\pm 0.1
96.6\pm 0.1
98.1
95.9\pm 0.2
98.9\pm 0.1
99.0\pm 0.0
99.1\pm 0.0
99.0\pm 0.0
96.0\pm 0.2
98.0
95.7\pm 0.2
99.0\pm 0.0
99.1\pm 0.1
99.1\pm 0.0
99.0\pm 0.0
96.7\pm 0.2
98.1
96.6\pm 0.1
98.9\pm 0.0
98.9\pm 0.1
99.1\pm 0.1
99.0\pm 0.0
96.2\pm 0.1
98.1
95.6\pm 0.3
98.9\pm 0.0
98.9\pm 0.0
99.0\pm 0.1
98.9\pm 0.0
95.9\pm 0.5
97.9
96.0\pm 0.5
98.8\pm 0.0
99.0\pm 0.1
99.1\pm 0.0
98.9\pm 0.1
96.5\pm 0.3
98.0
98.1\pm 0.1
98.9\pm 0.0
99.0\pm 0.0
98.8\pm 0.0
99.0\pm 0.0
96.4\pm 0.1
98.0
10\%
7\%
58.6\pm 2.4
66.4\pm 0.7
34.0\pm 1.8
27.5\pm 4.3
46.6
61.9\pm 2.2
71.5\pm 0.8
41.2\pm 1.8
32.2\pm 4.1
51.7
63.2\pm 2.3
73.9\pm 0.7
42.5\pm 1.8
38.1\pm 3.7
54.4
{\bf 74.2\pm 1.1}
{\bf 77.5\pm 0.6}
{\bf 48.5\pm 2.6}
{\bf 58.3\pm 0.9}
{\bf 64.6}
63.5\pm 1.3
69.2\pm 1.6
38.0\pm 0.9
31.4\pm 1.5
50.5
73.2\pm 1.1
74.8\pm 1.1
46.0\pm 2.0
40.6\pm 2.0
58.6
75.3\pm 0.9
77.4\pm 0.8
48.0\pm 0.9
44.2\pm 2.4
61.2
{\bf 79.8\pm 0.9}
{\bf 81.7\pm 0.6}
{\bf 48.6\pm 0.5}
{\bf 64.6\pm 1.1}
{\bf 68.7}
100
