R(\cdot)\propto R_{1}(\cdot)...R_{N}(\cdot)
R_{n}
R_{n}
R:\mathcal{X}\rightarrow\mathbb{R}^{+}
p_{F}
x\in\mathcal{X}
s_{0}
R
p(\cdot|\mathcal{D})
\mathcal{X}
R
N
\mathcal{D}_{1},\ldots,\mathcal{D}_{N}
\mathcal{D}
N
R_{n}(x)\propto p(\mathcal{D}_{n}|x)p(x)^{1/N}\quad\forall n=1\ldots N,
p(x|\mathcal{D})
R\propto R_{1}R_{2}\ldots R_{N}
N
R_{1},\ldots,R_{N}
i
ii
iii
V
{A}\in\{1,0\}^{|V|\times|V|}
G=(V,A)
V
G
p\colon V\times V\rightarrow\mathbb{R}_{+}
p(v,\cdot)
V
v\in V
p(v,w)>0
A_{vw}=1
p(v\rightarrow w)
p(w|v)
p(v,w)
p
G
\tau=(v_{1}\rightarrow\cdots\rightarrow v_{n})
n
G
p(\tau|v_{1})=\prod_{i=1}^{n-1}p(v_{i+1}|v_{i})
G
G^{\mathchoice{\raisebox{0.0pt}{$\displaystyle\intercal$}}{\raisebox{0.0pt}{$%
\textstyle\intercal$}}{\raisebox{0.0pt}{$\scriptstyle\intercal$}}{\raisebox{0.%
0pt}{$\scriptscriptstyle\intercal$}}}=(V,A^{{\mathchoice{\raisebox{0.0pt}{$%
\displaystyle\intercal$}}{\raisebox{0.0pt}{$\textstyle\intercal$}}{\raisebox{0%
.0pt}{$\scriptstyle\intercal$}}{\raisebox{0.0pt}{$\scriptscriptstyle\intercal$%
}}}})
R\colon\mathcal{X}\rightarrow\mathbb{R}_{+}
\mathcal{X}
R
\mathcal{S}
s_{o}
G
V=\{s_{o}\}\cup\{s_{f}\}\cup\mathcal{S}\cup\mathcal{X}
s_{o}
s_{f}
x\in\mathcal{X}
s_{f}
V
\mathcal{X}
s_{o}
s_{f}
\mathcal{T}
G
s_{o}
s_{f}
\mathcal{X}
32
\mathcal{S}
32
s_{o}
p_{F}
G
p_{T}
\mathcal{X}
p_{T}(x)\coloneqq\sum_{\tau\colon\tau\text{ leads to }x}p_{F}(\tau|s_{o})%
\propto R(x).
p_{F}
\phi_{F}
p_{F}
Z_{\phi_{Z}}
p_{B}(\cdot,\cdot;\phi_{B})
\phi_{Z}
\phi_{B}
\!\!\!\!\!\!\begin{split}&\mathcal{L}_{TB}(\tau,\phi_{F},\phi_{B},\phi_{Z})=\\
&\bigg{(}\log Z_{\phi_{Z}}-\log R(x)+\sum_{s\rightarrow s^{\prime}\in\tau}\log%
\frac{p_{F}(s,s^{\prime};\phi_{F})}{p_{B}(s^{\prime},s;\phi_{B})}\bigg{)}^{2}%
\end{split}.\!\!
p_{F}(\tau;\phi_{F})=Z_{\phi_{Z}}^{-1}R(x)\prod p_{B}(s^{\prime},s;\phi_{B})
\tau\in\mathcal{T}
p_{B}
\phi_{B}
F
\phi_{S}
F(s;\phi_{S})p_{F}(s,s^{\prime};\phi_{F})=F(s^{\prime};\phi_{S})p_{B}(s^{%
\prime},s;\phi_{B})
s
F(s;\phi_{S})p_{F}(s_{f}|s;\phi_{F})=R(s)
G
\begin{split}\mathcal{L}_{DB}&(s,s^{\prime},\phi_{F},\phi_{B},\phi_{S})=\\
&\!\!\!\!\begin{cases}\left(\log\frac{p_{F}(s,s^{\prime};\phi_{F})}{p_{B}(s^{%
\prime},s;\phi_{B})}+\log\frac{F(s;\phi_{S})}{F(s^{\prime};\phi_{S})}\right)^{%
2}\text{ if }s^{\prime}\neq s_{f},\\
\left(\log\frac{F(s;\phi_{S})p_{F}(s_{f}|s;\phi_{F})}{R(s)}\right)^{2}\text{%
otherwise.}\end{cases}\end{split}\!\!
F
\xi
\log F(s)=\log\tilde{F}(s)+\log\xi(s)
\mathcal{L}_{FL}
\mathcal{L}_{DB}
\mathcal{L}_{TB}
\pi
\mathcal{T}
\pi
\epsilon
p_{F}
(1-\epsilon)\cdot p_{F}+\epsilon\cdot u_{F}
p_{F}
\pi
n=1,\ldots,N
R_{n}
R
R_{1},\ldots,R_{N}
R(x)\vcentcolon=\prod_{n=1}^{N}R_{n}(x)
R(x)\vcentcolon=\prod_{n=1}^{N}R_{n}(x)^{w_{n}}
w_{1},\ldots,w_{N}>0
p_{F}^{(n)}
p_{B}^{(n)}
(p_{F},p_{B})
R
\{(p_{F}^{(n)},p_{B}^{(n)})\}_{n=1}^{N}
R^{(n)}
p_{T}
p_{T}^{(1)},\ldots,p_{T}^{(N)}
\left(p_{F}^{(1)},p_{B}^{(1)}\right),\dots,\left(p_{F}^{(N)},p_{B}^{(N)}\right%
):V^{2}\rightarrow\mathbb{R}^{+}
N
R_{1},\ldots,R_{N}:\mathcal{X}\rightarrow\mathbb{R}^{+}
p_{F},p_{B}\in V^{2}\rightarrow\mathbb{R}^{+}
R(x)\vcentcolon=\prod_{n=1}^{N}R(x)
\tau,\tau^{\prime}\in\mathcal{T}
\!\!\prod_{n=1}^{N}\frac{\left(\displaystyle\prod_{s\rightarrow s^{\prime}\in%
\tau}\frac{p_{F}^{(i)}(s,s^{\prime})}{p_{B}^{(i)}(s^{\prime},s)}\right)}{\left%
(\displaystyle\prod_{s\rightarrow s^{\prime}\in\tau^{\prime}}\frac{p_{F}^{(i)}%
(s,s^{\prime})}{p_{B}^{(i)}(s^{\prime},s)}\right)}=\frac{\left(\displaystyle%
\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p_{F}(s,s^{\prime})}{p_{B}(s^{%
\prime},s)}\right)}{\left(\displaystyle\prod_{s\rightarrow s^{\prime}\in\tau^{%
\prime}}\frac{p_{F}(s,s^{\prime})}{p_{B}(s^{\prime},s)}\right)}.\!\!
(\tau,\tau^{\prime})\in\mathcal{T}^{2}
p^{(i)}_{F}
p^{(i)}_{B}
p^{(i)}_{T}(x)\propto R_{i}(x)
R_{i}
x\in\mathcal{X}
\nu:\mathcal{T}^{2}\rightarrow\mathbb{R}^{+}
p_{F}(\cdot,\cdot;\phi_{F})
p_{B}(\cdot,\cdot;\phi_{B})
\phi_{F}
\phi_{B}
p_{T}(x;\phi_{F})\propto\prod_{i}R_{i}(x)
x\in\mathcal{X}
\mathbb{E}_{(\tau,\tau^{\prime})\sim\nu}\left[\mathcal{L}_{AB}(\tau,\tau^{%
\prime},\phi_{F},\phi_{B})\right]=0
\tau\rightsquigarrow x
\tau\rightsquigarrow x^{\prime}
\begin{split}\mathcal{L}_{AB}(\tau,\tau^{\prime},\phi_{F},\phi_{B})\!\!=\!\!%
\bigg{(}\log\frac{p_{F}(\tau;\phi_{F})p_{B}(\tau^{\prime}|x^{\prime};\phi_{B})%
}{p_{B}(\tau|x;\phi_{B})p_{F}(\tau^{\prime};\phi_{F})}\\
-\!\!\!\!\sum_{1\leq i\leq N}\!\!\!\log\frac{p_{F}(\tau;\phi_{F})p_{B}(\tau^{%
\prime}|x^{\prime};\phi_{B})}{p_{B}(\tau|x;\phi_{B})p_{F}(\tau^{\prime};\phi_{%
F})}\bigg{)}^{2}.\end{split}
p_{T}^{(1)},\ldots,p_{T}^{(N)}
R_{1},\ldots,R_{N}
\mathbb{E}_{\tau\sim p_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p^{(i)}_{%
F}(\tau)}{p^{(i)}_{B}(\tau|x)}\right].
\nicefrac{{p^{(i)}_{F}(\tau)}}{{p^{(i)}_{B}(\tau|x)}}
R(x)
\tau
\tau
x
\pi_{n}\vcentcolon=R_{n}/Z_{n}
p_{F}^{(n)}
p_{B}^{(n)}
n
\tau\rightsquigarrow x
\tau\in\mathcal{T}
x\rightarrow s_{f}
\forall\,n\in[[1,N]]
\begin{split}1-\alpha_{n}\leq\min_{x\in\mathcal{X},\tau\rightsquigarrow x}%
\frac{p_{F}^{(n)}(\tau)}{p_{B}^{(n)}(\tau|x)\pi_{n}(x)}\\
\leq\max_{x\in\mathcal{X},\tau\rightsquigarrow x}\frac{p_{F}^{(n)}(\tau)}{p_{B%
}^{(n)}(\tau|x)\pi_{n}(x)}\leq 1+\beta_{n}\end{split}
\alpha_{n}\in(0,1)
\beta_{n}>0
\mathcal{D}_{J}
\hat{\pi}(x)
\pi(x)\propto\prod_{n=1}^{N}\pi_{n}(x)
\mathcal{D}_{J}(\pi,\hat{\pi})\leq\sum_{n=1}^{N}\log\left(\frac{1+\beta_{n}}{1%
-\alpha_{n}}\right).
\beta_{n}=\alpha_{n}=0\,\forall n
\pi=\hat{\pi}
\beta_{n}\rightarrow\infty
\alpha_{n}\rightarrow 1
n
R\propto R_{1}R_{2}
p_{F},p_{B}\in V^{2}\rightarrow\mathbb{R}^{+}
R:\mathcal{X}\rightarrow\mathbb{R}^{+}
\tau,\tau^{\prime}\in\mathcal{T}
\tau\rightsquigarrow x
\tau\rightsquigarrow x^{\prime}
{R(x^{\prime})}\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p_{F}(s,s^{\prime})%
}{p_{B}(s^{\prime},s)}={R(x)}\prod_{s\rightarrow s^{\prime}\in\tau^{\prime}}%
\frac{p_{F}(s,s^{\prime})}{p_{B}(s^{\prime},s)}.
p_{F},p_{B}
x\in\mathcal{X}
R
\log Z_{\phi_{Z}}
\mathcal{L}_{CB}
p(x)\propto R(x)
\mathcal{L}_{CB}
p_{F}(\cdot,\cdot;\phi_{F})
p_{B}(\cdot,\cdot;\phi_{B})
\nu:\mathcal{T}^{2}\rightarrow\mathbb{R}^{+}
p_{T}(x;\phi_{F})\propto R(x)
\forall x\in\mathcal{X}
\mathbb{E}_{(\tau,\tau^{\prime})\sim\nu}\left[\mathcal{L}_{CB}(\tau,\tau^{%
\prime},\phi_{F},\phi_{B})\right]=0
\begin{split}\mathcal{L}_{CB}(\tau,\tau^{\prime},\phi_{F},\phi_{B})=\bigg{(}%
\log\frac{p_{F}(\tau;\phi_{F})}{p_{B}(\tau;\phi_{B})}-\\
\log\frac{p_{F}(\tau^{\prime};\phi_{F})}{p_{B}(\tau^{\prime};\phi_{B})}+\log%
\frac{R(x^{\prime})}{R(x)}\bigg{)}^{2}.\end{split}
\mathcal{L}_{CB}
\mathcal{L}_{CB}
p_{F}
p_{B}
R
p_{F}
p_{B}
\mathcal{L}_{CB}
p_{F}\otimes p_{F}
p_{F}(\tau)p_{F}(\tau^{\prime})
(\tau,\tau^{\prime})
\nabla_{\phi_{F}}\mathcal{D}_{KL}[p_{F}||p_{B}]=\frac{1}{4}\underset{{(\tau,%
\tau^{\prime})\sim p_{F}\otimes p_{F}}}{\mathbb{E}}\!\!\!\!\!\left[\nabla_{%
\phi_{F}}\mathcal{L}_{CB}(\tau,\tau^{\prime},\phi_{F})\right].
\mathcal{L}_{CB}(\tau,\tau^{\prime})=\left(\mathcal{V}_{TB}(\tau)-\mathcal{V}_%
{TB}(\tau^{\prime})\right)^{2}
\mathcal{V}_{TB}(\tau)=\log\left(\nicefrac{{p_{F}(\tau)Z}}{{p_{B}(\tau|x)R(x)}%
}\right)
\mathcal{V}_{TB}(\tau)^{2}=\mathcal{L}_{TB}(\tau)
L_{1}\downarrow
\uparrow
L_{1}\downarrow
\uparrow
L_{1}\downarrow
\uparrow
0.027
-6.355
0.100
27.422
0.003
-1.535
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.016)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.001)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.001)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
\mathbf{0.038}
\mathbf{-6.355}
\mathbf{0.130}
\mathbf{27.422}
\mathbf{0.005}
\mathbf{-1.535}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.016)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.004)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.002)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
0.189
\mathbf{-6.355}
0.834
26.804
1.872
-16.473
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.006)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.005)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.018)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.011)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.007)}}
9\times 9
\rightarrow,\uparrow
R
L_{1}
\times
\times
\times
\times
S
\mathcal{S}
U
n
r^{n}_{u}
u\in U
\mathcal{S}
\log R_{n}(\mathcal{S})=\sum_{u\in\mathcal{S}}r^{(n)}_{u}
r^{(n)}_{u}
[0,1]
S=8
|U|=10
S
\mathcal{S}
U
S
n
p^{(n)}_{s}
S
t^{(n)}_{u}
|U|
\mathcal{S}=(u_{1},\dots,u_{M})
\log R_{n}(\mathcal{S})=\sum_{i=1}^{M}p^{(n)}_{i}t^{(n)}_{u_{i}}
L_{1}
\approx 8\times
\mathrm{T}=(t,b)
t
(2N-1)
b
t
N
\mathrm{T}
P
Y_{1},\dots,Y_{M}\in\Omega^{N}
\Omega
Y_{m}
m
t
r
{\pi}\in\Delta^{|\Omega|}
r
Y_{m}
{m}
n
\mathbf{P}_{n}(Y_{m}|\mathrm{T})=\begin{cases}\text{One-Hot}(Y_{m,n})&\text{ %
if }n\text{ is a leaf,}\\
\left[\mathbf{M}(n,n_{l})\odot\mathbf{M}(n,n_{r})\right]^{\intercal}&\text{ %
otherwise},\end{cases}
n_{l}
n_{r}
n
{b}_{n,a}
n
a
{Q}\in\mathbb{R}^{|\Omega|\times|\Omega|}
\mathbf{M}(n,k)=e^{{b}_{n,k}{Q}}\mathbf{P}_{k}(Y_{m}|\mathrm{T})^{\intercal}
n
k
b_{n,k}
\mathbf{P}_{r}(Y_{m}|\mathrm{T})^{\intercal}{\pi}
T
\mathbf{P}(\mathbf{Y}|\mathrm{T})=\prod_{1\leq i\leq M}(\mathbf{P}_{r}(Y_{i}|%
\mathrm{T})^{\intercal}{\pi})
{\pi}
t
2500
L_{1}
0.088
L_{1}
0.083{\scriptstyle(\pm 0.041)}
\times
\times
L_{1}
L_{1}
\mathbf{X}\in\mathbb{R}^{d}
\mathbf{B}\in\mathbb{R}^{d\times d}
\mathcal{G}
[[1,d]]
\mathbf{X}
\mathbf{X}=\mathbf{B}\mathbf{X}+\mathbf{N}
\mathbf{N}\sim\mathcal{N}(\mathbf{0},\sigma^{2}I)
10
L_{1}
\log Z_{\phi_{Z}}
{\color[rgb]{0.0,0.5,0.13}\mathcal{L}_{CB}}
{\color[rgb]{0,0,1}\mathcal{L}_{TB}}
{\color[rgb]{1,.5,0}\mathcal{L}_{DB}}
{\color[rgb]{1,0,0}\mathcal{L}_{DBC}}
{\color[rgb]{0.0,0.5,0.13}\mathcal{L}_{CB}}
{\color[rgb]{0,0,1}\mathcal{L}_{TB}}
{\color[rgb]{1,.5,0}\mathcal{L}_{DB}}
{\color[rgb]{1,0,0}\mathcal{L}_{DBC}}
\tau^{\star}\in\mathcal{T}
\displaystyle Z\prod_{s\rightarrow s^{\prime}\in\tau^{\star}}{p_{F}(s%
\rightarrow s^{\prime})}=R(x)\prod_{s\rightarrow s^{\prime}\in\tau^{\star}}{p_%
{B}(s^{\prime}\rightarrow s)}
\displaystyle Z\prod_{s\rightarrow s^{\prime}\in\tau^{\star}}{p_{F}(s%
\rightarrow s^{\prime})}=R(x)\prod_{s\rightarrow s^{\prime}\in\tau^{\star}}{p_%
{B}(s^{\prime}\rightarrow s)}
\displaystyle\iff Z=R(x)\prod_{s\rightarrow s^{\prime}\in\tau^{\star}}\frac{p_%
{B}(s^{\prime}\rightarrow s)}{p_{F}(s\rightarrow s^{\prime})}
\displaystyle\iff
\displaystyle Z=R(x)\prod_{s\rightarrow s^{\prime}\in\tau^{\star}}\frac{p_{B}(%
s^{\prime}\rightarrow s)}{p_{F}(s\rightarrow s^{\prime})}
\tau
\tau^{\prime}
{R(x)}\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p_{B}(s^{\prime}\rightarrow s%
)}{p_{F}(s\rightarrow s^{\prime})}={R(x^{\prime})}\prod_{s\rightarrow s^{%
\prime}\in\tau^{\prime}}\frac{p_{B}(s^{\prime}\rightarrow s)}{p_{F}(s%
\rightarrow s^{\prime})}.
(\tau,\tau^{\prime})
\tau^{\prime}
\tau
\tau^{\prime}
c
\displaystyle R(x)\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p_{B}(s^{\prime}%
\rightarrow s)}{p_{F}(s\rightarrow s^{\prime})}=c
\displaystyle R(x)\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p_{B}(s^{\prime}%
\rightarrow s)}{p_{F}(s\rightarrow s^{\prime})}=c
\displaystyle\iff R(x)\prod_{s\rightarrow s^{\prime}\in\tau}{p_{B}(s^{\prime}%
\rightarrow s)}=c\prod_{s\rightarrow s^{\prime}\in\tau}{p_{F}(s\rightarrow s^{%
\prime})},
\displaystyle\iff
\displaystyle R(x)\prod_{s\rightarrow s^{\prime}\in\tau}{p_{B}(s^{\prime}%
\rightarrow s)}=c\prod_{s\rightarrow s^{\prime}\in\tau}{p_{F}(s\rightarrow s^{%
\prime})},
\tau\in\mathcal{T}
\displaystyle\sum_{\tau\in\mathcal{T}}R(x)\prod_{s\rightarrow s^{\prime}\in%
\tau}{p_{B}(s^{\prime}\rightarrow s)}=c\sum_{\tau\in\mathcal{T}}\prod_{s%
\rightarrow s^{\prime}\in\tau}{p_{F}(s\rightarrow s^{\prime})}
\displaystyle\sum_{\tau\in\mathcal{T}}R(x)\prod_{s\rightarrow s^{\prime}\in%
\tau}{p_{B}(s^{\prime}\rightarrow s)}=c\sum_{\tau\in\mathcal{T}}\prod_{s%
\rightarrow s^{\prime}\in\tau}{p_{F}(s\rightarrow s^{\prime})}
\displaystyle\implies\sum_{\tau\in\mathcal{T}}R(x)\prod_{s\rightarrow s^{%
\prime}\in\tau}{p_{B}(s^{\prime}\rightarrow s)}=c
\displaystyle\implies
\displaystyle\sum_{\tau\in\mathcal{T}}R(x)\prod_{s\rightarrow s^{\prime}\in%
\tau}{p_{B}(s^{\prime}\rightarrow s)}=c
\displaystyle\sum_{x\in\mathcal{X}}R(x)\sum_{\tau\in T(x)}\prod_{s\rightarrow s%
^{\prime}\in\tau}{p_{B}(s^{\prime}\rightarrow s)}=c
\displaystyle\sum_{x\in\mathcal{X}}R(x)\sum_{\tau\in T(x)}\prod_{s\rightarrow s%
^{\prime}\in\tau}{p_{B}(s^{\prime}\rightarrow s)}=c
\displaystyle\implies\sum_{x\in\mathcal{X}}R(x)=c
\displaystyle\implies
\displaystyle\sum_{x\in\mathcal{X}}R(x)=c
\displaystyle\implies Z=c
\displaystyle\implies
\displaystyle Z=c
Z=c
\mathbb{E}_{\tau\sim p_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p^{(i)}_{%
F}(\tau)}{p^{(i)}_{B}(\tau|x)}\right],
p_{T}(x)\propto\prod_{1\leq i\leq N}R_{i}(x)
\nicefrac{{p_{F}^{(i)}(\tau)}}{{p_{B}^{(i)}(\tau|x)}}=R_{i}(x)
i=1,\dots,N
\prod_{1\leq i\leq N}\frac{\left(\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p%
_{F}^{(i)}(s,s^{\prime})}{p_{B}^{(i)}(s^{\prime},s)}\right)}{\left(\prod_{s%
\rightarrow s^{\prime}\in\tau^{\prime}}\frac{p_{F}^{(i)}(s,s^{\prime})}{p_{B}^%
{(i)}(s^{\prime},s)}\right)}=\frac{\left(\prod_{s\rightarrow s^{\prime}\in\tau%
}\frac{p_{F}(s,s^{\prime})}{p_{B}(s^{\prime},s)}\right)}{\left(\prod_{s%
\rightarrow s^{\prime}\in\tau^{\prime}}\frac{p_{F}(s,s^{\prime})}{p_{B}(s^{%
\prime},s)}\right)},
p_{F}(\tau)=c\left(\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(%
\tau|x)}\right)p_{B}(\tau|x)
c>0
x
\tau
x\in\mathcal{X}
\displaystyle p_{T}(x)\coloneqq\sum_{\tau\rightsquigarrow x}\prod_{s%
\rightarrow s^{\prime}\in\tau}p_{F}(s\rightarrow s^{\prime})
\displaystyle p_{T}(x)
\displaystyle\coloneqq\sum_{\tau\rightsquigarrow x}\prod_{s\rightarrow s^{%
\prime}\in\tau}p_{F}(s\rightarrow s^{\prime})
\displaystyle=c\sum_{\tau\rightsquigarrow x}\left(\prod_{1\leq i\leq N}\frac{p%
_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)}\right)p_{B}(\tau|x)
\displaystyle=c\sum_{\tau\rightsquigarrow x}\left(\prod_{1\leq i\leq N}\frac{p%
_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)}\right)p_{B}(\tau|x)
\displaystyle=c\mathbb{E}_{\tau\sim p_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}%
\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)}\right].
\displaystyle=c\mathbb{E}_{\tau\sim p_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}%
\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)}\right].
\nicefrac{{p_{F}^{(i)}(\tau)}}{{p_{B}^{(i)}(\tau|x)}}\propto R_{i}(x)
i=1,\dots,N
\tau
x
p_{T}(x)\propto\mathbb{E}_{\tau\sim p_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}%
R_{i}(x)\right]=\prod_{1\leq i\leq N}R_{i}(x),
\mathcal{D}_{J}(p,q)=\mathcal{D}_{KL}[p||q]+\mathcal{D}_{KL}[q||p]
p
q
\hat{\pi}(x)=\hat{Z}\,\mathbb{E}_{\tau\sim p_{B}(\cdot|x)}\left[\prod_{1\leq i%
\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)}\right]
\displaystyle\mathcal{D}_{KL}[\pi||\hat{\pi}]=\mathbb{E}_{x\sim\pi}\left[\log%
\frac{\pi(x)}{\hat{\pi}(x)}\right]
\displaystyle\mathcal{D}_{KL}[\pi||\hat{\pi}]
\displaystyle=\mathbb{E}_{x\sim\pi}\left[\log\frac{\pi(x)}{\hat{\pi}(x)}\right]
\displaystyle=\mathbb{E}_{x\sim\pi}\left[\log\pi(x)-\log Z\mathbb{E}_{\tau\sim
p%
_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(%
\tau|x)}\right]\right]
\displaystyle=\mathbb{E}_{x\sim\pi}\left[\log\pi(x)-\log Z\mathbb{E}_{\tau\sim
p%
_{B}(\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(%
\tau|x)}\right]\right]
\displaystyle=-\mathbb{E}_{x\sim\pi}\left[\log\mathbb{E}_{\tau\sim p_{B}(\cdot%
|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)\pi%
_{i}(x)}\right]\right]-\log\hat{Z}+\log Z
\displaystyle=-\mathbb{E}_{x\sim\pi}\left[\log\mathbb{E}_{\tau\sim p_{B}(\cdot%
|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|x)\pi%
_{i}(x)}\right]\right]-\log\hat{Z}+\log Z
\displaystyle\leq-\mathbb{E}_{x\sim\pi}\left[\log\prod_{1\leq i\leq N}(1-%
\alpha_{i})\right]-\log\hat{Z}+\log Z
\displaystyle\leq-\mathbb{E}_{x\sim\pi}\left[\log\prod_{1\leq i\leq N}(1-%
\alpha_{i})\right]-\log\hat{Z}+\log Z
\displaystyle=\log\frac{Z}{\hat{Z}}+\sum_{1\leq i\leq N}\log\left(\frac{1}{1-%
\alpha_{i}}\right),
\displaystyle=\log\frac{Z}{\hat{Z}}+\sum_{1\leq i\leq N}\log\left(\frac{1}{1-%
\alpha_{i}}\right),
Z\coloneqq\left(\sum_{x\in\mathcal{X}}\prod_{1\leq i\leq N}\pi_{i}(x)\right)^{%
-1}
\pi
\displaystyle\mathcal{D}_{KL}[\pi||\hat{\pi}]=\mathbb{E}_{x\sim\hat{\pi}}\left%
[\log\frac{\hat{\pi}(x)}{\pi(x)}\right]
\displaystyle\mathcal{D}_{KL}[\pi||\hat{\pi}]
\displaystyle=\mathbb{E}_{x\sim\hat{\pi}}\left[\log\frac{\hat{\pi}(x)}{\pi(x)}\right]
\displaystyle=\mathbb{E}_{x\sim\hat{\pi}}\left[\log Z\mathbb{E}_{\tau\sim p_{B%
}(\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(%
\tau|x)}\right]-\log\pi(x)\right]
\displaystyle=\mathbb{E}_{x\sim\hat{\pi}}\left[\log Z\mathbb{E}_{\tau\sim p_{B%
}(\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(%
\tau|x)}\right]-\log\pi(x)\right]
\displaystyle=\mathbb{E}_{x\sim\hat{\pi}}\left[\log\mathbb{E}_{\tau\sim p_{B}(%
\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|%
x)\pi_{i}(x)}\right]\right]+\log\hat{Z}-\log Z
\displaystyle=\mathbb{E}_{x\sim\hat{\pi}}\left[\log\mathbb{E}_{\tau\sim p_{B}(%
\cdot|x)}\left[\prod_{1\leq i\leq N}\frac{p_{F}^{(i)}(\tau)}{p_{B}^{(i)}(\tau|%
x)\pi_{i}(x)}\right]\right]+\log\hat{Z}-\log Z
\displaystyle\leq\mathbb{E}_{x\sim\hat{\pi}}\left[\log\prod_{1\leq i\leq N}(1+%
\beta_{i})\right]+\log\hat{Z}-\log Z
\displaystyle\leq\mathbb{E}_{x\sim\hat{\pi}}\left[\log\prod_{1\leq i\leq N}(1+%
\beta_{i})\right]+\log\hat{Z}-\log Z
\displaystyle=\log\frac{\hat{Z}}{Z}+\sum_{1\leq i\leq N}\log\left(1+\beta_{i}%
\right).
\displaystyle=\log\frac{\hat{Z}}{Z}+\sum_{1\leq i\leq N}\log\left(1+\beta_{i}%
\right).
\pi
\hat{\pi}
\displaystyle\mathcal{D}_{J}(\pi,\hat{\pi})=\mathcal{D}_{KL}[\pi||\hat{\pi}]+%
\mathcal{D}_{KL}[\hat{\pi}||\pi]
\displaystyle\mathcal{D}_{J}(\pi,\hat{\pi})
\displaystyle=\mathcal{D}_{KL}[\pi||\hat{\pi}]+\mathcal{D}_{KL}[\hat{\pi}||\pi]
\displaystyle\leq\log\frac{Z}{\hat{Z}}+\sum_{1\leq i\leq N}\log\left(\frac{1}{%
1-\alpha_{i}}\right)+\log\frac{\hat{Z}}{Z}+\sum_{1\leq i\leq N}\log\left(1+%
\beta_{i}\right)
\displaystyle\leq\log\frac{Z}{\hat{Z}}+\sum_{1\leq i\leq N}\log\left(\frac{1}{%
1-\alpha_{i}}\right)+\log\frac{\hat{Z}}{Z}+\sum_{1\leq i\leq N}\log\left(1+%
\beta_{i}\right)
\displaystyle=\sum_{1\leq i\leq N}\log\left(\frac{1+\beta_{i}}{1-\alpha_{i}}%
\right).
\displaystyle=\sum_{1\leq i\leq N}\log\left(\frac{1+\beta_{i}}{1-\alpha_{i}}%
\right).
p_{\theta}
\theta
f_{\theta}\colon\mathcal{X}\rightarrow\mathbb{R}
\mathcal{X}
\theta
\nabla_{\theta}\mathbb{E}_{x\sim p_{\theta}}[f_{\theta}(x)],
p_{\theta}
\theta
\displaystyle\nabla_{\theta}\mathbb{E}_{x\sim p_{\theta}}[f_{\theta}(x)]=%
\nabla_{\theta}\int_{x\in\mathcal{X}}f_{\theta}(x)p_{\theta}(x)\mathrm{d}x
\displaystyle\nabla_{\theta}\mathbb{E}_{x\sim p_{\theta}}[f_{\theta}(x)]
\displaystyle=\nabla_{\theta}\int_{x\in\mathcal{X}}f_{\theta}(x)p_{\theta}(x)%
\mathrm{d}x
\displaystyle=\int_{x\in\mathcal{X}}\left((\nabla_{\theta}f_{\theta}(x))p_{%
\theta}(x)\right)\mathrm{d}x+\int_{x\in\mathcal{X}}\left((\nabla_{\theta}p_{%
\theta}(x))f_{\theta}(x)\right)\mathrm{d}x
\displaystyle=\int_{x\in\mathcal{X}}\left((\nabla_{\theta}f_{\theta}(x))p_{%
\theta}(x)\right)\mathrm{d}x+\int_{x\in\mathcal{X}}\left((\nabla_{\theta}p_{%
\theta}(x))f_{\theta}(x)\right)\mathrm{d}x
\displaystyle=\mathbb{E}_{x\sim p_{\theta}}\left[\nabla_{\theta}f_{\theta}(x)+%
f_{\theta}(x)\nabla_{\theta}\log p_{\theta}(x)\right],
\displaystyle=\mathbb{E}_{x\sim p_{\theta}}\left[\nabla_{\theta}f_{\theta}(x)+%
f_{\theta}(x)\nabla_{\theta}\log p_{\theta}(x)\right],
f_{\theta}
p_{\theta}
\nabla_{\theta}f_{\theta}(x)+f_{\theta}(x)\nabla_{\theta}\log p_{\theta}(x)
p_{\theta}
\displaystyle\nabla_{\theta}\mathcal{D}_{KL}[p_{F}||p_{B}]=\nabla_{\theta}%
\mathbb{E}_{\tau\sim p_{F}}\left[\log\frac{p_{F}(\tau)}{p_{B}(\tau)}\right]
\displaystyle\nabla_{\theta}\mathcal{D}_{KL}[p_{F}||p_{B}]
\displaystyle=\nabla_{\theta}\mathbb{E}_{\tau\sim p_{F}}\left[\log\frac{p_{F}(%
\tau)}{p_{B}(\tau)}\right]
\displaystyle=\mathbb{E}_{\tau\sim p_{F}}\left[\nabla_{\theta}\log p_{F}(\tau)%
+\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}\right)\nabla_{\theta}\log p_{F}(%
\tau)\right]
\displaystyle=\mathbb{E}_{\tau\sim p_{F}}\left[\nabla_{\theta}\log p_{F}(\tau)%
+\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}\right)\nabla_{\theta}\log p_{F}(%
\tau)\right]
\displaystyle=\mathbb{E}_{\tau\sim p_{F}}\left[\left(\log\frac{p_{F}(\tau)}{p_%
{B}(\tau)}\right)\nabla_{\theta}\log p_{F}(\tau)\right],
\displaystyle=\mathbb{E}_{\tau\sim p_{F}}\left[\left(\log\frac{p_{F}(\tau)}{p_%
{B}(\tau)}\right)\nabla_{\theta}\log p_{F}(\tau)\right],
\mathbb{E}_{\tau\sim p_{F}}[\nabla_{\theta}\log p_{F}(\tau)]=\nabla_{\theta}%
\mathbb{E}_{\tau\sim p_{F}}[1]=0
\theta
\displaystyle\nabla_{\theta}\mathcal{L}_{CB}(\tau,\tau^{\prime},\theta)=\nabla%
_{\theta}\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}-\log\frac{p_{F}(\tau^{%
\prime})}{p_{B}(\tau^{\prime})}\right)^{2}
\displaystyle\nabla_{\theta}\mathcal{L}_{CB}(\tau,\tau^{\prime},\theta)
\displaystyle=\nabla_{\theta}\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}-\log%
\frac{p_{F}(\tau^{\prime})}{p_{B}(\tau^{\prime})}\right)^{2}
\displaystyle=2\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}-\log\frac{p_{F}(\tau^%
{\prime})}{p_{B}(\tau^{\prime})}\right)\left(\nabla_{\theta}\log p_{F}(\tau)-%
\nabla_{\theta}\log p_{F}(\tau^{\prime})\right),
\displaystyle=2\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}-\log\frac{p_{F}(\tau^%
{\prime})}{p_{B}(\tau^{\prime})}\right)\left(\nabla_{\theta}\log p_{F}(\tau)-%
\nabla_{\theta}\log p_{F}(\tau^{\prime})\right),
p_{F}\otimes p_{F}
4\nabla_{\theta}\mathcal{D}_{KL}[p_{F}||p_{B}]
\mathbb{E}_{\tau\sim p_{F}}\left[\left(\log\frac{p_{F}(\tau^{\prime})}{p_{B}(%
\tau^{\prime})}\right)\nabla_{\theta}\log p_{F}(\tau)\right]=0,
\tau
\tau^{\prime}
\displaystyle\underset{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}{\mathbb{E}%
}\left[\nabla_{\theta}\mathcal{L}_{CB}(\tau,\tau^{\prime},\theta)\right]=
\displaystyle\underset{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}{\mathbb{E}%
}\left[\nabla_{\theta}\mathcal{L}_{CB}(\tau,\tau^{\prime},\theta)\right]=
\displaystyle\underset{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}{\mathbb{E}%
}\left[2\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}-\log\frac{p_{F}(\tau^{\prime%
})}{p_{B}(\tau^{\prime})}\right)\left(\nabla_{\theta}\log p_{F}(\tau)-\nabla_{%
\theta}\log p_{F}(\tau^{\prime})\right)\right]=
\displaystyle\underset{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}{\mathbb{E}%
}\left[2\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}-\log\frac{p_{F}(\tau^{\prime%
})}{p_{B}(\tau^{\prime})}\right)\left(\nabla_{\theta}\log p_{F}(\tau)-\nabla_{%
\theta}\log p_{F}(\tau^{\prime})\right)\right]=
\displaystyle\underset{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}{\mathbb{E}%
}\left[2\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}\right)\nabla_{\theta}\log p_%
{F}(\tau)+2\left(\log\frac{p_{F}(\tau^{\prime})}{p_{B}(\tau^{\prime})}\right)%
\nabla_{\theta}\log p_{F}(\tau^{\prime})\right]=
\displaystyle\underset{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}{\mathbb{E}%
}\left[2\left(\log\frac{p_{F}(\tau)}{p_{B}(\tau)}\right)\nabla_{\theta}\log p_%
{F}(\tau)+2\left(\log\frac{p_{F}(\tau^{\prime})}{p_{B}(\tau^{\prime})}\right)%
\nabla_{\theta}\log p_{F}(\tau^{\prime})\right]=
\displaystyle\underset{\tau\sim p_{F}}{\mathbb{E}}\left[4\left(\log\frac{p_{F}%
(\tau)}{p_{B}(\tau)}\right)\nabla_{\theta}\log p_{F}(\tau)\right]=4\nabla_{%
\theta}\mathcal{D}_{KL}[p_{F}||p_{B}].
\displaystyle\underset{\tau\sim p_{F}}{\mathbb{E}}\left[4\left(\log\frac{p_{F}%
(\tau)}{p_{B}(\tau)}\right)\nabla_{\theta}\log p_{F}(\tau)\right]=4\nabla_{%
\theta}\mathcal{D}_{KL}[p_{F}||p_{B}].
\mathcal{L}_{CB}
\mathcal{L}_{TB}
\mathcal{L}_{CB}
\mathcal{V}_{TB}(\tau)=\log p_{F}(\tau)+\log Z-\log p_{B}(\tau|x_{\tau})-\log R%
(x_{\tau})
x_{\tau}
\tau
\mathcal{L}_{CB}(\tau,\tau^{\prime})=\left(\mathcal{V}_{TB}(\tau)-\mathcal{V}_%
{TB}(\tau^{\prime})\right)^{2}\text{ and }\mathcal{L}_{TB}(\tau)=\mathcal{V}_{%
TB}(\tau)^{2}.
\mathcal{V}_{TB}(\tau)^{2}=0
\mathcal{V}_{TB}(\tau)=0
\tau
R(x)
\mathcal{L}_{CB}(\tau,\tau^{\prime})=0
\mathcal{V}_{TB}
c>0
\mathcal{V}_{TB}+(\log c-\log Z)=\log p_{F}(\tau)+\log c-\log p_{B}(\tau|x_{%
\tau})-\log R(x_{\tau})=0.
\mathbb{E}_{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}\left[\nabla_{\theta_{%
F}}\mathcal{L}_{CB}(\tau,\tau^{\prime})\right]=\mathbb{E}_{(\tau,\tau^{\prime}%
)\sim p_{F}\otimes p_{F}}\left[2\left(\mathcal{V}_{TB}(\tau)-\mathcal{V}_{TB}(%
\tau^{\prime})\right)\nabla_{\theta_{F}}\left(\mathcal{V}_{TB}(\tau)-\mathcal{%
V}_{TB}(\tau^{\prime})\right)\right]
\mathbb{E}_{\tau\sim p_{F}}\left[\nabla_{\theta_{F}}\mathcal{L}_{TB}(\tau)%
\right]=\mathbb{E}_{\tau\sim p_{F}}\left[2\mathcal{V}_{TB}(\tau)\nabla_{\theta%
_{F}}\mathcal{V}_{TB}(\tau)\right]=2\mathcal{D}_{KL}\left[p_{F}||p_{B}\right]
\mathbb{E}_{\tau\sim p_{F}}\left[\nabla_{\theta_{F}}\mathcal{V}_{TB}(\tau)%
\right]=\sum_{\tau}p_{F}(\tau)\nabla_{\theta_{F}}\log p_{F}(\tau)=\nabla_{%
\theta_{F}}\sum_{\tau}p_{F}(\tau)=0,
\mathbb{E}_{(\tau,\tau^{\prime})\sim p_{F}\otimes p_{F}}\left[\mathcal{L}_{CB}%
(\tau,\tau^{\prime})\right]=4\mathcal{D}_{KL}\left[p_{F}||p_{B}\right],
\mathcal{L}_{CB}
\mathcal{L}_{VL}
\mathcal{L}_{VL}(\tau)=\left(\mathcal{V}_{TB}(\tau)-\mathbb{E}_{\tau^{\prime}}%
[\mathcal{V}_{TB}(\tau^{\prime})]\right)^{2};
\mathcal{L}_{VL}
\mathbb{E}_{\tau,\tau^{\prime}}\left[\left(\mathcal{V}_{TB}(\tau)-\mathcal{V}_%
{TB}(\tau^{\prime})\right)^{2}\right]=2\mathbb{E}_{\tau}\left[\left(\mathcal{V%
}_{TB}(\tau)-\mathbb{E}_{\tau^{\prime}}\left[\mathcal{V}_{TB}(\tau^{\prime})%
\right]\right)^{2}\right]=2\mathbb{E}_{\tau}\left[\mathcal{L}_{VL}(\tau)\right].
\mathcal{L}_{CB}
p_{B}
p_{F}
p_{B}
\phi_{B}
p_{B}\otimes p_{B}
\frac{1}{Z^{2}}R(x)R(x’)p_{B}(\tau|x)p_{B}(\tau|x’)
(\tau,\tau’)
x
x’
\mathbb{E}_{\tau,\tau’\sim p_{B}\otimes p_{B}}\left[\nabla_{\phi_{B}}\mathcal{%
L}_{CB}(\tau,\tau’;\phi_{B})\right]=\frac{1}{4}\mathcal{D}_{KL}\left[p_{B}||p_%
{F}\right].
p_{B}
p_{B}
p_{B}
R_{1},\dots,R_{N}\colon\mathcal{X}\rightarrow\mathbb{R}_{+}
\mathcal{X}
n=1,\dots,N
R_{n}
\prod_{n=1}^{N}R_{n}(x)^{\omega_{n}}
\omega_{1},\dots,\omega_{N}
\left(p_{F}^{(1)},p_{F}^{(1)}\right),\dots,\left(p_{F}^{(N)},p_{F}^{(N)}\right%
):V^{2}\rightarrow\mathbb{R}^{+}
N
R_{1},\ldots,R_{N}:\mathcal{X}\rightarrow\mathbb{R}^{+}
p_{F},p_{B}\in V^{2}\rightarrow\mathbb{R}^{+}
R(x)\vcentcolon=\prod_{n=1}^{N}R(x)^{\omega_{n}}
\tau,\tau^{\prime}\in\mathcal{T}
\prod_{1\leq i\leq N}\frac{\left(\prod_{s\rightarrow s^{\prime}\in\tau}\frac{p%
_{F}^{(i)}(s,s^{\prime})}{p_{B}^{(i)}(s^{\prime},s)}\right)^{\omega_{i}}}{%
\left(\prod_{s\rightarrow s^{\prime}\in\tau^{\prime}}\frac{p_{F}^{(i)}(s,s^{%
\prime})}{p_{B}^{(i)}(s^{\prime},s)}\right)^{\omega_{i}}}=\frac{\left(\prod_{s%
\rightarrow s^{\prime}\in\tau}\frac{p_{F}(s,s^{\prime})}{p_{B}(s^{\prime},s)}%
\right)}{\left(\prod_{s\rightarrow s^{\prime}\in\tau^{\prime}}\frac{p_{F}(s,s^%
{\prime})}{p_{B}(s^{\prime},s)}\right)}.
\pi_{n}\vcentcolon=R_{n}/Z_{n}
p_{F}^{(n)}
p_{B}^{(n)}
n
\tau\rightsquigarrow x
\tau\in\mathcal{T}
x\rightarrow s_{f}
\forall\,n=1,\ldots,N
1-\alpha_{n}\leq\min_{x\in\mathcal{X},\tau\rightsquigarrow x}\frac{p_{F}^{(n)}%
(\tau)}{p_{B}^{(n)}(\tau|x)\pi_{n}(x)}\leq\max_{x\in\mathcal{X},\tau%
\rightsquigarrow x}\frac{p_{F}^{(n)}(\tau)}{p_{B}^{(n)}(\tau|x)\pi_{n}(x)}\leq
1%
+\beta_{n}
\alpha_{n}\in(0,1)
\beta_{n}>0
\mathcal{D}_{J}
\hat{\pi}(x)
\pi(x)\propto\prod_{n=1}^{N}\pi_{n}(x)^{\omega_{n}}
\mathcal{D}_{J}(\pi,\hat{\pi})\leq\sum_{n=1}^{N}\omega_{n}\log\left(\frac{1+%
\beta_{n}}{1-\alpha_{n}}\right).
\prod_{n=1}^{N}R_{n}(x)^{\omega_{n}}
(\omega_{1},\dots,\omega_{N})
\left(p_{F}^{(1)},p_{B}^{(1)}\right),\dots,\left(p_{F}^{(K)},p_{B}^{(K)}\right)
R_{1},\dots,R_{K}
\left(p_{F},p_{B}\right)
E
u_{F}
p^{\intercal}(x)\propto R(x)\coloneq\prod_{1\leq k\leq K}R_{k}(x)
k\in\{1,\dots,K\}
\left(p_{F}^{(k)},p_{B}^{(k)}\right)
R_{k}
e\in\{1,\dots,E\}
\mathcal{B}\leftarrow\left\{(\tau,\tau^{\prime})\colon\tau,\tau^{\prime}\sim%
\nicefrac{{1}}{{2}}\cdot p_{F}+\nicefrac{{1}}{{2}}\cdot u_{F}\right\}
L\leftarrow\frac{1}{|\mathcal{B}|}\sum_{\tau,\tau^{\prime}\in\mathcal{B}}%
\mathcal{L}_{AB}\left(\tau,\tau^{\prime};\left\{\left(p_{F}^{(1)},p_{B}^{(1)}%
\right),\dots,\left(p_{F}^{(K)},p_{B}^{(K)}\right)\right\}\right)
p_{F}
p_{B}
L
5000
3\cdot 10^{-3}
L_{1}
\pi
\hat{\pi}
\|\pi-\hat{\pi}\|_{1}\coloneqq\sum_{x\in\mathcal{X}}|\pi(x)-\hat{\pi}(x)|
9
10^{6}
L_{1}
800
6
6
10^{6}
8
U
10
U
10
s
s
10^{6}
7
t
t
t
10^{5}
20
\mathbb{P}_{G}[U\rightarrow V]
\{G_{1},\ldots,G_{N}\}
\frac{1}{N}\sum_{1\leq n\leq N}\mathbbm{1}[U\rightarrow V|G_{n}],
\mathbbm{1}[U\rightarrow V|G_{n}]
U\rightarrow V
G_{n}
\pi
\mathbb{E}_{G\sim\pi}\left[\mathbbm{1}[U\rightarrow V|G]\right]
p_{T}
\mathcal{Q}
\hat{q}=\operatorname*{arg\,min}_{q\in\mathcal{Q}}\text{KL}[p_{T}||q]=%
\operatorname*{arg\,min}_{q\in\mathcal{Q}}-\mathbb{E}_{x\sim p_{T}}[\log q(x)],
W
H
\mathcal{Q}=\{(\phi,\psi)\in\Delta^{W+1}\times\Delta^{H+1}\colon q_{\phi,\psi}%
(x,y)=\text{Cat}(x|\phi)\text{Cat}(y|\psi)\},
\Delta^{d}
d
\text{Cat}(\phi)
\text{Cat}(\psi)
\{0,\dots,W\}
\{0,\dots,H\}
\phi
\psi
N
\left(q_{\phi^{(1)},\psi^{(1)}}\right),\dots,\left(q_{\phi^{(N)},\psi^{(N)}}\right)
\tilde{\phi}
\tilde{\psi}
\tilde{\phi}=\bigodot_{1\leq i\leq N}\phi^{(i)}\text{ and }\tilde{\psi}=%
\bigodot_{1\leq i\leq N}\psi^{(i)}.
\phi=\nicefrac{{\phi_{u}}}{{\phi_{u}^{\intercal}\mathbf{1}_{W+1}}}
\psi=\nicefrac{{\psi_{u}}}{{\psi_{u}^{\intercal}\mathbf{1}_{H+1}}}
\mathbf{1}_{d}
1
T
V
(S,(x_{1},\dots,x_{S}))
S
(x_{1},\dots,x_{S})
\displaystyle S\sim\text{Cat}(\theta),
\displaystyle S\sim\text{Cat}(\theta),
\displaystyle x_{i}\sim\text{Cat}(\phi_{i,S}|S)\text{ for }i\in\{1,\dots,S\},
\displaystyle x_{i}\sim\text{Cat}(\phi_{i,S}|S)\text{ for }i\in\{1,\dots,S\},
\theta\in\Delta^{T}
\phi_{\cdot,S}\in\mathbb{R}^{S\times|V|}
S\in\{1,\dots,T\}
\theta
\phi
\left(\theta^{(1)},\phi^{(1)}\right),\dots,\left(\theta^{(N)},\phi^{(N)}\right)
N
\tilde{\theta}
\tilde{\phi}
\tilde{\theta}=\bigodot_{1\leq i\leq N}\theta^{(i)}\text{ and }\tilde{\phi}_{%
\cdot,S}=\bigodot_{1\leq i\leq N}\phi_{\cdot,S}^{(i)}\text{ for }S\in\{1,\dots%
,T\},
\theta=\nicefrac{{\tilde{\theta}}}{{\tilde{\theta}^{\intercal}\mathbf{1}_{T}}}
\phi_{\cdot,S}=\text{diag}(\tilde{\phi}_{\cdot,S}\mathbf{1}_{|V|})^{-1}\tilde{%
\phi}_{\cdot,S}
\mathcal{S}
S
\mathcal{W}
\mathcal{Q}=\left\{q(\cdot|\phi)\colon q(\mathcal{S}|\phi)=\prod_{s\in\mathcal%
{S}}\text{Cat}(s|\phi)\right\},
\phi
\mathcal{W}
\phi^{(1)},\dots,\phi^{(N)}
N
q(\cdot|\phi)\in\mathcal{Q}
\phi=\nicefrac{{\tilde{\phi}}}{{\tilde{\phi}^{\intercal}\mathbf{1}_{|\mathcal{%
W}|}}}
\tilde{\phi}=\bigodot_{1\leq i\leq N}\phi^{(i)}.
3\cdot 10^{-3}
\log Z
1\cdot 10^{-1}
\mathcal{L}_{CB}
\mathcal{L}_{TB}
\mathcal{L}_{DB}
R(s^{\prime})p_{B}(s|s^{\prime})p_{F}(s_{f}|s)=R(s)p_{F}(s^{\prime}|s)p_{F}(s_%
{f}|s^{\prime})
F
L_{1}\downarrow
\uparrow
L_{1}\downarrow
\uparrow
L_{1}\downarrow
\uparrow
0.038
-6.355
0.130
27.422
0.005
-1.535
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.016)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.004)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.002)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
0.039
-6.355
0.131
27.422
0.006
-1.535
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.006)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.018)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.005)}}
{\color[rgb]{.5,.5,.5}{\scriptstyle(\pm 0.000)}}
L_{1}
\{2,4,6,8,10\}
1000
\log Z
\log Z
\log Z_{\phi_{Z}}
10^{-3}
\log Z_{\phi_{Z}}
q_{1},\ldots,q_{K}
x_{i}
q_{i}
x_{i}
(p^{(i)}_{F})_{1\leq i\leq N}
\prod_{1\leq i\leq N}R_{i}
p_{F}(\cdot|s)\propto\prod_{1\leq i\leq N}p_{F}^{(i)}(\cdot|s),
s
\mathcal{L}_{AB}
1000
1000
4
\log R^{\prime}_{i}(x)=\log R_{i}(x)+\epsilon
\epsilon\sim\mathcal{N}_{|\mathcal{X}|}(\mathbf{0},\sigma^{2}\mathbf{I})
|\mathcal{X}|
\prod_{1\leq i\leq 4}R_{i}
\sigma^{2}\in\{0.000,0.002,0.004,0.006,0.008,0.01\}
(U,V)
U
V
\mathbb{P}[U\rightarrow V]
U
V
\mathbb{P}[U\rightsquigarrow V]
(U,V)
U
V
\mathbb{P}[U\rightarrow V]
U
V
\mathbb{P}[U\rightsquigarrow V]
\mathbf{X}\in\mathbb{R}^{d}
\mathbf{B}\in\mathbb{R}^{d\times d}
\mathcal{G}
\{1,\dots,d\}
\mathbf{X}
\mathbf{X}=\mathbf{B}\mathbf{X}+\mathbf{N},
\mathbf{N}\sim\mathcal{N}(\mathbf{0},\sigma^{2}I)
K
\mathcal{D}_{k}=\{\mathbf{x}_{1},\dots,\mathbf{x}_{N}\}
R(G)=\prod_{1\leq k\leq K}R_{k}(G)
R_{k}(G)=p(\mathcal{D}_{k}|G)p(G)
p(\mathcal{D}_{k}|G)=p(\mathcal{D}_{k}|\hat{\mathbf{B}}_{k},G)
\hat{\mathbf{B}}_{k}
k
\mathbf{B}
G
R
R_{k}
L_{1}
400
d=4
4
10000
\mathcal{E}\colon\mathcal{S}\rightarrow\mathbb{R}
\mathcal{E}(s_{o})=0
\mathcal{E}(x)=-\log R(x)
x\in\mathcal{X}
\log F(s,\phi_{S})=-\mathcal{E}(s)+\log\tilde{F}(s,\phi_{S})
L_{1}
1.32
0.04
