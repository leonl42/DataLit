K
N
{K+1\choose 2}
{K+1\choose 2}^{N}
N
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\mathcal{G}=\{\mathcal{G}_{n}:1\leq n\leq N\}
N
\mathcal{G}_{n}=(\mathcal{V},\mathcal{E})\in\mathcal{G}
\mathcal{V}
\mathcal{E}
v\in\mathcal{V}
\mathcal{G}_{n}
F
\mathbf{X}_{v}\in\mathbb{R}^{F}
\mathcal{A}=\{A_{k}:1\leq k\leq K\}
K
A_{k}:\mathcal{G}_{n}\rightarrow{}\tilde{\mathcal{G}}_{n}
\mathcal{G}
A_{i,j}=(A_{i},A_{j})
A_{i},A_{j}\in\mathcal{A}
\mathcal{G}=(\mathcal{G}_{n}:1\leq n\leq N)
\mathcal{A}=\{A_{k}:1\leq k\leq K\}
K
A_{i,j}^{n}=(A_{i}^{n},A_{j}^{n})
\mathcal{G}_{n}\in\mathcal{G}
i
j
n
\mathcal{G}_{n}
\mathcal{G}_{n}=(\mathcal{V},\mathcal{E})
f_{w}:\mathcal{G}_{n}\xrightarrow{}\mathbb{R}^{D}
\mathcal{G}_{n}\in\mathcal{G}
D
K
f_{w}(\cdot)
k
\mathbf{h}_{v}^{(k)}=\text{UPDATE}^{(k)}\left(\mathbf{h}_{v}^{(k-1)},\text{AGG%
}^{(k)}(\{\mathbf{h}_{u}^{(k-1)}:u\in\mathcal{N}_{v}\})\right),
\mathbf{h}_{v}^{(k)}\in\mathbb{R}^{D}
v
\mathbf{h}_{v}^{(0)}=\mathbf{X}_{v}
\mathcal{N}_{v}=\{u:(v,u)\in\mathcal{E}\}
v
v
K
\mathcal{G}_{n}
\mathbf{h}_{n}=\text{READOUT}(\{\mathbf{h}_{v}^{(K)}:v\in\mathcal{G}_{n}\}),
\mathbf{h}_{n}\in\mathbb{R}^{D}
\mathcal{G}_{n}
\mathcal{G}=\{\mathcal{G}_{n}:1\leq n\leq N\}
\mathcal{A}=\{A_{1},A_{2},\cdots,A_{K}\}
(A_{i},A_{j}\mid 1\leq i,j\leq K)
N
{K+1\choose 2}
\mathcal{G}_{n}
A^{n}_{i,j}=(A_{i}^{n},A_{j}^{n})
{K+1\choose 2}
{K+1\choose 2}^{N}
K
K=5
K=5
N=100
15^{100}
N
K=5
\mathcal{A}=\{\text{Identical},\text{NodeDrop},\text{EdgePert},\text{Subgraph}%
,\text{AttMask}\}
\mathcal{G}_{n}
\mathcal{G}_{n}
\mathcal{G}_{n}
\mathcal{G}_{n}
\mathcal{G}_{n}
\mathcal{G}_{n}
\mathcal{G}_{n}
{K+1\choose 2}
{K+1\choose 2}^{N}
\mathcal{A}=\{A_{i}:1\leq i\leq K\}
\mathcal{G}_{n}
(A_{1}^{n},A_{3}^{n})
A^{n}_{i,j}=(A^{n}_{i},A^{n}_{j})
\mathcal{G}_{n}
\hat{\alpha}^{n}_{i,j}
\displaystyle\hat{\alpha}^{n}_{i,j}=\frac{\exp(\alpha_{i,j}^{n})}{\sum_{i^{%
\prime}j^{\prime}}\exp(\alpha^{n}_{i^{\prime},j^{\prime}})},
\displaystyle\hat{\alpha}^{n}_{i,j}
\displaystyle=\frac{\exp(\alpha_{i,j}^{n})}{\sum_{i^{\prime}j^{\prime}}\exp(%
\alpha^{n}_{i^{\prime},j^{\prime}})},
\displaystyle\alpha_{i,j}^{n}=g_{\theta}(f_{w}(A^{n}_{i}(\mathcal{G}_{n})%
\parallel A^{n}_{j}(\mathcal{G}_{n}))),
\displaystyle\alpha_{i,j}^{n}
\displaystyle=g_{\theta}(f_{w}(A^{n}_{i}(\mathcal{G}_{n})\parallel A^{n}_{j}(%
\mathcal{G}_{n}))),
g_{\theta}
A^{n}_{i}(\mathcal{G}_{n})
A^{n}_{j}(\mathcal{G}_{n})
\mathcal{G}_{n}
g_{\theta}
f_{w}
\parallel
g_{\theta}
\alpha^{n}=[\hat{{\alpha}}^{n}_{1,1},\cdots,\hat{\alpha}^{n}_{i,j},\cdots,\hat%
{\alpha}^{n}_{K,K}]
\mathcal{G}_{n}
\mathcal{G}_{n}
\alpha^{n}
A^{n}=(A^{n}_{i},A^{n}_{j})
\hat{\alpha}^{n}_{i,j}=\arg\max_{i^{\prime},j^{\prime}}\hat{\alpha}^{n}_{i^{%
\prime},j^{\prime}}
g_{\theta}
(A_{i}^{n},A^{n}_{j})
\mathcal{G}_{n}
f_{w}(\cdot)
f_{w}(\cdot)
A_{i}^{n}(\mathcal{G}_{n}),A^{n}_{j}(\mathcal{G}_{n})
\mathbb{R}^{D}
\mathbb{R}^{D}\rightarrow\mathbb{R}^{D}
f_{w}
\small\mathcal{L}(\mathcal{G}_{n})=-\log\frac{\exp(\text{sim}(f_{w}(A^{n}_{i}(%
\mathcal{G}_{n})),f_{w}(A^{n}_{j}(\mathcal{G}_{n})))/\tau)}{\sum_{n^{\prime}=1%
,n^{\prime}\neq n}^{N}\exp(\text{sim}(f_{w}(A^{n}_{i}(\mathcal{G}_{n})),f_{w}(%
A^{n^{\prime}}_{j}(\mathcal{G}_{n^{\prime}})))/\tau)},
\text{sim}(\cdot,\cdot)
\tau
\mathcal{G}
A_{i}^{n},A_{j}^{n}
\mathcal{G}_{n}
\begin{split}&\arg\min\limits_{\theta}\,\,\mathcal{L}_{valid}(w^{*}(\theta),%
\theta)\\
&s.t.\quad w^{*}(\theta)=\mathop{\arg\min}\limits_{w}\mathcal{L}_{train}(w,%
\theta),\end{split}
\theta
w
\mathcal{L}_{valid}(w^{*}(\theta),\theta)
\theta
w^{*}
\mathcal{L}_{train}(w,\theta^{*})
w
\theta
\theta
w
w^{\prime}=w-\xi\nabla_{w}\mathcal{L}_{train}(w,\theta),
\mathcal{L}_{train}=\mathbb{E}_{\mathcal{G}_{train}}\mathcal{L}(\mathcal{G}_{n})
\mathcal{L}(\mathcal{G}_{n})
\mathcal{G}_{train}
\xi
\theta
\begin{split}\mathcal{L}_{valid}(w^{*}(\theta),\theta)=\sum_{A_{i},A_{j}\in%
\mathcal{A}}\sum_{\mathcal{G}_{n}\in\mathcal{G}_{valid}}\hat{\alpha}^{n}_{i,j}%
\mathcal{L}(\mathcal{G}_{n}),\end{split}
\hat{\alpha}^{n}_{i,j}
g_{\theta}
\theta
\mathcal{G}_{valid}
\theta
w
\theta^{\prime}=\theta-\xi\nabla_{\theta}\mathcal{L}_{valid}(w^{*}(\theta),%
\theta).
\theta
w^{*}(\theta)
\theta
w^{*}(\theta)
w
\theta
\mathcal{L}_{train}(w^{\prime}(\theta),\theta)
\theta
w^{\prime}
w^{\prime}
\theta
\displaystyle\nabla_{\theta}\mathcal{L}_{valid}(w^{*}(\theta),\alpha)\approx%
\nabla_{\theta}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle\nabla_{\theta}\mathcal{L}_{valid}(w^{*}(\theta),\alpha)
\displaystyle\approx\nabla_{\theta}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle\approx\nabla_{\theta}\mathcal{L}_{valid}(w-\xi\nabla_{w}\mathcal%
{L}_{train}(w,\theta),\theta).
\displaystyle\approx\nabla_{\theta}\mathcal{L}_{valid}(w-\xi\nabla_{w}\mathcal%
{L}_{train}(w,\theta),\theta).
\theta
\displaystyle\nabla_{\theta}\mathcal{L}_{valid}(w^{*}(\theta)\theta)\approx%
\nabla_{\theta}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle\nabla_{\theta}\mathcal{L}_{valid}(w^{*}(\theta)\theta)
\displaystyle\approx\nabla_{\theta}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle-\xi\nabla^{2}_{\theta,w}\mathcal{L}_{train}(w,\theta)\nabla_{w^{%
\prime}}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle-\xi\nabla^{2}_{\theta,w}\mathcal{L}_{train}(w,\theta)\nabla_{w^{%
\prime}}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle\xi\nabla^{2}_{\theta,w}\mathcal{L}_{train}(w,\theta)\nabla_{w^{%
\prime}}\mathcal{L}_{valid}(w^{\prime},\theta)
\displaystyle\xi\nabla^{2}_{\theta,w}
\displaystyle\mathcal{L}_{train}(w,\theta)\nabla_{w^{\prime}}\mathcal{L}_{%
valid}(w^{\prime},\theta)
\displaystyle\approx\frac{\nabla_{\theta}\mathcal{L}_{train}(w^{+},\theta)-%
\nabla_{\theta}\mathcal{L}_{train}(w^{-},\theta)}{2\epsilon},
\displaystyle\approx\frac{\nabla_{\theta}\mathcal{L}_{train}(w^{+},\theta)-%
\nabla_{\theta}\mathcal{L}_{train}(w^{-},\theta)}{2\epsilon},
w^{\pm}=w\pm\epsilon\nabla_{w^{\prime}}\mathcal{L}_{valid}(w^{\prime},\theta)
\epsilon
\theta
\begin{split}\nabla_{\theta}\mathcal{L}_{valid}(w^{*}(\theta),\theta)&\approx%
\nabla_{\theta}\mathcal{L}_{valid}(w^{\prime},\theta)\\
&-\xi\frac{\nabla_{\theta}\mathcal{L}_{train}(w^{+},\theta)-\nabla_{\theta}%
\mathcal{L}_{train}(w^{-},\theta)}{2\epsilon}.\end{split}
\mathcal{G}
g_{\theta}(\cdot)
f_{w}(\cdot)
\mathcal{G}
\mathcal{G}_{train}
\mathcal{G}_{valid}
\theta
w
g_{\theta}(\cdot)
w
w^{\prime}
\theta
A_{i,j}
A_{i},A_{j}
A_{1,1}
A_{1}
A_{1}
A_{1,2}
A_{1}
A_{2}
A_{1,3}
A_{1}
A_{3}
A_{1,4}
A_{1}
A_{4}
A_{1,5}
A_{1}
A_{5}
A_{2,2}
A_{2}
A_{2}
A_{2,3}
A_{2}
A_{3}
A_{2,4}
A_{2}
A_{4}
A_{2,5}
A_{2}
A_{5}
A_{3,3}
A_{3}
A_{3}
A_{3,4}
A_{3}
A_{4}
A_{3,5}
A_{3}
A_{5}
A_{4,4}
A_{4}
A_{4}
A_{4,5}
A_{4}
A_{5}
A_{5,5}
A_{5}
A_{5}
d
\mid\mathcal{G}\mid
\#Label
4,110
29.87
32.30
2
1,113
39.06
72.82
2
1,178
284.32
715.66
2
188
17.93
19.79
2
5,000
74.49
2,457.78
3
1,000
19.77
96.53
2
2,000
429.63
497.75
2
4,999
508.52
594.87
5
12,725
113.79
234.64
2
41,127
25.5
27.5
2
d
g_{\theta}
d
\pm
\pm
76.20\pm 1.06
74.44\pm 0.31
72.85\pm 1.78
89.01\pm 1.13
70.65\pm 1.13
82.50\pm 1.42
53.46\pm 1.03
73.03\pm 0.87
77.87\pm 0.41
74.39\pm 0.45
78.62\pm 0.40
86.80\pm 1.34
71.36\pm 1.15
89.53\pm 0.84
55.99\pm 0.28
71.14\pm 0.44
78.07\pm 0.47
74.55\pm 0.41
77.32\pm 0.54
87.35\pm 1.02
69.50\pm 0.36
85.29\pm 1.35
55.74\pm 0.63
70.21\pm 3.08
78.36\pm 0.53
74.07\pm 1.10
77.40\pm 1.15
87.67\pm 0.79
69.33\pm 0.34
86.42\pm 1.45
56.03\pm 0.27
70.83\pm 0.25
69.67\pm 0.51
73.59\pm 0.65
74.49\pm 0.52
88.62\pm 1.27
73.32\pm 0.61
85.52\pm 0.79
53.00\pm 0.82
71.57\pm 1.01
80.42\pm 0.41
75.94\pm 0.25
79.90\pm 0.35
89.68\pm 0.80
76.17\pm 0.10
89.32\pm 0.38
53.70\pm 0.19
74.64\pm 0.35
74.36\pm 0.24
70.51\pm 0.17
74.54\pm 0.68
75.09\pm 0.19
87.69\pm 0.40
53.58\pm 0.13
63.89\pm 0.52
74.86\pm 0.26
72.27\pm 0.40
75.78\pm 0.34
73.76\pm 0.29
88.66\pm 0.95
53.61\pm 0.31
65.21\pm 0.88
74.63\pm 0.25
74.17\pm 0.34
76.17\pm 1.37
74.23\pm 0.21
89.11\pm 0.19
52.55\pm 0.45
65.81\pm 0.79
74.48\pm 0.25
72.13\pm 0.92
75.69\pm 0.67
75.30\pm 0.32
88.14\pm 0.25
52.83\pm 0.54
65.00\pm 0.30
74.86\pm 0.39
73.31\pm 0.48
75.81\pm 0.73
75.53\pm 0.18
88.79\pm 0.65
52.71\pm 0.28
66.60\pm 0.60
75.18\pm 0.31
73.96\pm 0.47
77.91\pm 0.73
75.82\pm 0.26
90.10\pm 0.15
53.49\pm 0.28
67.13\pm 0.52
75.50\pm 0.14
74.27\pm 1.11
76.68\pm 0.81
70.45\pm 0.06
89.99\pm 0.32
54.92\pm 0.35
68.31\pm 0.13
55.48\pm 1.32
57.39\pm 1.39
60.76\pm 1.01
77.71\pm 0.60
80.42\pm 0.41
74.21\pm 0.39
75.94\pm 0.25
77.25\pm 0.69
79.90\pm 0.35
86.08\pm 2.93
89.68\pm 0.80
71.80\pm 1.13
74.64\pm 0.35
d
d
d=128
