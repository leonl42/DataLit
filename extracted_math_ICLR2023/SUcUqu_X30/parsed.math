P_{c}
1-P_{c}
P_{c}
P_{c}
1-P_{c}
P_{c}
\mathcal{W}
w_{1}
w_{2}
w_{N}
N
\mathcal{W}
w_{i}
n
\mathcal{X}=[X^{1},X^{2},...,X^{n}]\in\mathcal{R}^{n\times p\times p\times 3}
p
p
\mathcal{T}_{0}=[X^{1}\textbf{E};X^{2}\textbf{E};...,X^{n}\textbf{E}]
d
p\times p
d
\mathcal{T}^{{}^{\prime}}_{l}=\mathcal{T}_{l-1}+\mathrm{MSA}(\mathrm{LN}(%
\mathcal{T}_{l-1}));\hskip 14.45377pt\mathcal{T}_{l}=\mathcal{T}^{{}^{\prime}}%
_{l}+\mathrm{MLP}(\mathrm{LN}(\mathcal{T}^{{}^{\prime}}_{l}))
l
l^{th}
L
w_{i}
\mathcal{T}_{L}
n
d
n
f
1
d
w_{i}
w_{i}
\mathcal{C}
\mathcal{C}_{i,j}=1
i,j
\mathcal{C}
n
\mathcal{C}=[C^{1},C^{2},...,C^{n}]
p,p
C^{i}=\mathrm{MaxPool}(C^{i})
C^{i}
n
1
w_{i}
P_{c}
w_{i}
n\times n
q,k,v
v
f
w_{i}
P_{c}
L^{th}
M_{self}
M_{cross}
\mathrm{sf}
\mathrm{softmax}
v
w_{i}
n_{c}
n_{b}
n\times n
q,k,v
v
f
w_{i}
P_{c}
L^{th}
M_{self}
M_{cross}
\mathrm{sf}
\mathrm{softmax}
v
w_{i}
n_{c}
n_{b}
L
\mathcal{T}_{L}\in\mathcal{R}^{n\times d}
P_{c}
f_{c}=\frac{P_{c}^{T}\mathcal{T}_{L}}{\sum P_{c}};\hskip 14.45377ptf_{b}=\frac%
{(1-P_{c})^{T}\mathcal{T}_{L}}{\sum 1-P_{c}}
f_{c}
f_{b}
M_{self}
M_{cross}
n\times n
M_{self}
M_{cross}
M_{self}
M_{cross}
\displaystyle M_{self}(i,j)=\left\{\begin{aligned} &0,&&\text{if}\ P_{c}(i)=P_%
{c}(j)\\
&-\infty,&&\text{otherwise}\end{aligned}\right.;
\displaystyle M_{self}(i,j)=\left\{\begin{aligned} &0,&&\text{if}\ P_{c}(i)=P_%
{c}(j)\\
&-\infty,&&\text{otherwise}\end{aligned}\right.;
\displaystyle M_{cross}(i,j)=\left\{\begin{aligned} &0,&&\text{if}\ P_{c}(i)%
\neq P_{c}(j)\hskip 2.8903ptor\hskip 2.8903pti=j\\
&-\infty,&&\text{otherwise}\end{aligned}\right.
\displaystyle M_{cross}(i,j)=\left\{\begin{aligned} &0,&&\text{if}\ P_{c}(i)%
\neq P_{c}(j)\hskip 2.8903ptor\hskip 2.8903pti=j\\
&-\infty,&&\text{otherwise}\end{aligned}\right.
i,j\in\{1,2,...n\}
M_{cross}
q
k
v
v
\mathrm{softmax}(qk^{T})
w_{i}
M_{self}
M_{cross}
\displaystyle\mathrm{MSA}_{self}=\mathrm{softmax}(\frac{qk^{T}+M_{self}}{\sqrt%
{d}})\hskip 2.84544ptv;
\displaystyle\mathrm{MSA}_{self}=\mathrm{softmax}(\frac{qk^{T}+M_{self}}{\sqrt%
{d}})\hskip 2.84544ptv;
\displaystyle\mathrm{MSA}_{cross}=\mathrm{softmax}(\frac{qk^{T}+M_{cross}}{%
\sqrt{d}})\hskip 2.84544ptv
\displaystyle\mathrm{MSA}_{cross}=\mathrm{softmax}(\frac{qk^{T}+M_{cross}}{%
\sqrt{d}})\hskip 2.84544ptv
M_{self}
M_{cross}
\mathrm{softmax}
\mathcal{T}_{L}
\displaystyle\mathcal{T}^{{}^{\prime}}_{self}=\mathcal{T}_{L}+\mathrm{MSA}_{%
self}(\mathrm{LN}(\mathcal{T}_{L}));
\displaystyle\mathcal{T}^{{}^{\prime}}_{self}=\mathcal{T}_{L}+\mathrm{MSA}_{%
self}(\mathrm{LN}(\mathcal{T}_{L}));
\displaystyle\mathcal{T}_{self}=\mathcal{T}^{{}^{\prime}}_{self}+\mathrm{MLP}(%
\mathrm{LN}(\mathcal{T}^{{}^{\prime}}_{self}))
\displaystyle\mathcal{T}_{self}=\mathcal{T}^{{}^{\prime}}_{self}+\mathrm{MLP}(%
\mathrm{LN}(\mathcal{T}^{{}^{\prime}}_{self}))
\displaystyle\mathcal{T}^{{}^{\prime}}_{cross}=\mathcal{T}_{L}+\mathrm{MSA}_{%
cross}(\mathrm{LN}(\mathcal{T}_{L}));
\displaystyle\mathcal{T}^{{}^{\prime}}_{cross}=\mathcal{T}_{L}+\mathrm{MSA}_{%
cross}(\mathrm{LN}(\mathcal{T}_{L}));
\displaystyle\mathcal{T}_{cross}=\mathcal{T}^{{}^{\prime}}_{cross}+\mathrm{MLP%
}(\mathrm{LN}(\mathcal{T}^{{}^{\prime}}_{cross}))
\displaystyle\mathcal{T}_{cross}=\mathcal{T}^{{}^{\prime}}_{cross}+\mathrm{MLP%
}(\mathrm{LN}(\mathcal{T}^{{}^{\prime}}_{cross}))
P_{c}
\displaystyle f_{cc}=\frac{P_{c}^{T}\mathcal{T}_{self}}{\sum P_{c}};\hskip 7.2%
2743ptf_{bb}=\frac{(1-P_{c})^{T}\mathcal{T}_{self}}{\sum 1-P_{c}};
\displaystyle f_{cc}=\frac{P_{c}^{T}\mathcal{T}_{self}}{\sum P_{c}};\hskip 7.2%
2743ptf_{bb}=\frac{(1-P_{c})^{T}\mathcal{T}_{self}}{\sum 1-P_{c}};
\displaystyle f_{cb}=\frac{P_{c}^{T}\mathcal{T}_{cross}}{\sum P_{c}};\hskip 7.%
22743ptf_{bc}=\frac{(1-P_{c})^{T}\mathcal{T}_{cross}}{\sum 1-P_{c}}
\displaystyle f_{cb}=\frac{P_{c}^{T}\mathcal{T}_{cross}}{\sum P_{c}};\hskip 7.%
22743ptf_{bc}=\frac{(1-P_{c})^{T}\mathcal{T}_{cross}}{\sum 1-P_{c}}
\mathcal{T}_{self}
\mathcal{T}_{cross}
f_{cc}
f_{bb}
f_{cb}
f_{bc}
w_{i}
\mathrm{softmax}
\mathcal{L}^{CE}
\mathcal{L}^{CE}=\lambda_{1}\times(\mathcal{L}^{CE}_{c}+\mathcal{L}^{CE}_{b})+%
\lambda_{2}\times(\mathcal{L}^{CE}_{cc}+\mathcal{L}^{CE}_{bb}+\mathcal{L}^{CE}%
_{cb}+\mathcal{L}^{CE}_{bc})
\mathcal{L}^{CE}_{c}
f_{c}
f_{c}
f_{b}
w_{i}
\mathcal{W}
N
d
N
\mathcal{W}
P_{c}
j
P_{c_{1}}
P_{c_{2}}
P_{c_{j}}
\mathcal{C}
\mathcal{W}
d=192
d=384
\times
\times
\times
P_{c}
\times
\times
\times
\times
\times
\times
224\times 224
p=16
n=196
d=192
d=384
\lambda_{1}=0.5
\lambda_{2}=\frac{0.1}{4}
\lambda_{1}=0.5
f_{c}
f_{b}
2e^{-4}
5e^{-2}
\mathcal{W}
3e^{-4}
1e^{-2}
1e^{-4}
1e^{-2}
5e^{-3}
d=192
d=384
1.7-3.16\%
0.8-1.1\%
1.5-2\%
0.3-0.4\%
n\times n
n
n
>
>
>
<
>1
p\times p
L_{sup}
L_{sup}
L_{sup}
L_{sup}
L_{sup}
L_{sup}
3000+
\times
P_{c}
>
>
f_{c}
f_{b}
f_{cc}
f_{bb}
f_{cb}
f_{bc}
f_{c}
f_{b}
n\times n
f_{c}
f_{b}
n\times n
M_{self}
M_{cross}
n\times n
f_{cc}
f_{bb}
f_{cb}
f_{bc}
f_{cc}
f_{bb}
f_{cc}
f_{bb}
f_{cb}
f_{bc}
f_{c}
f_{b}
f_{cc}
f_{bc}
f_{cb}
f_{bb}
n\times n
<
<
<
<
**
-
-
**
-
**
**
**
**
**
**
**
**
-
-
**
-
**
**
**
**
**
**
**
**
**
**
**
**
**
-
**
-
**
-
**
**
*
**
**
**
-
**
**
**
**
**
**
-
-
*
-
-
-
**
-
**
**
**
**
**
**
**
**
**
**
-
-
-
*
-
**
\times
\times
\times
\times
\times
\times
\times
\times
