\times
\times
N
D
\bm{X}\in\mathbb{R}^{N\times D}
M
I
M
P_{M}^{t}
M
t
P_{I}^{t+1}
I
T
P_{M}^{t+1}=\textrm{Top-M}\{P_{M}^{t}\cup P_{I}^{t+1}\mid\bm{a}^{t+1}\},
T=\lceil(N-M)/I\rceil
P_{M}^{0}=\{\bm{X}_{1},\dots,\bm{X}_{M}\}
\bm{X}_{\{1,\dots,M\}}
\bm{a}^{t+1}\in\mathbb{R}^{M+I}
t+1
M
P_{M}^{T}
3
N=16
M=4
I=4
3
N=16
M=4
I=4
M
M
\bm{X}^{*}\in\mathbb{R}^{M\times D}
\bm{z}=\sum_{m=1}^{M}a_{m}\bm{X}^{*}_{m}.
a_{m}
\bm{X}^{*}_{m}
a_{\{1,\dots,M\}}=\mathrm{Softmax}\left(f^{\theta}(\bm{X}^{*}_{1}),...,f^{%
\theta}(\bm{X}^{*}_{M})\right)
f^{\theta}
\theta
f^{\theta}
f^{\theta}\left(\bm{X}^{*}_{m}\right)=\frac{\bm{Q}\bm{K}^{T}}{\sqrt{D_{k}}},
\bm{Q}=\bm{q}^{\phi}\bm{W}^{q}
\bm{K}=\bm{X}^{*}_{m}\bm{W}^{k}
\bm{q}^{\phi}\in\mathbb{R}^{D}
\bm{X}^{*}_{m}
\bm{W}^{q},\bm{W}^{k}\in\mathbb{R}^{D\times D_{k}}
D_{k}
\bm{V}=\bm{X}^{*}_{m}\bm{W}^{v}
\bm{W}^{v}\in\mathbb{R}^{D\times D_{v}}
D_{v}
1D-
N
f^{\theta}(\bm{X}_{n})=\bm{w}(\tanh(\bm{X}_{n}\bm{U})\odot\mathrm{sigm}(\bm{X}%
_{n}\bm{V}))^{T}
\bm{U}
\bm{V}\in\mathbb{R}^{D\times D_{h}}
\bm{w}\in\mathbb{R}^{D_{h}}
D_{h}
M
M
N=768
N=768
M
192
98.4
\pm 0.5
14.2
323
10
98.6
\pm 0.5
1.3
126
2
98.5
\pm 0.8
1.2
114
10
50.7
\pm 2.6
1.3
31
2
28.3
\pm 3.2
0.9
26
10
94.0
\pm 2.2
3.5
337
2
97.2
\pm 0.7
2.5
296
10
97.7
\pm 0.5
4.5
109
2
98.2
\pm 0.5
4.5
96
192
96.2
\pm 1.6
14.2
323
192
97.7
\pm 1.3
14.3
323
-
84.1
\pm 4.7
13.4
231
0.3\times
-
76.3
\pm 0.9
1.4
83
\times
\times
I=32
M
M\in\{2,10\}
\times
M=2
M
M=10
M=192
97.2\%
91.7\%
\times
256\times 256
M
I=5k
\dagger
N
M
\dagger
N
M
M
N
5k
98.1
\pm 0.3
4.7
355
1k
97.5
\pm 0.2
4.1
313
100
97.3
\pm 0.6
4.0
313
5k
70k
95.1
\pm 1.7
2.9
286
10k
10k
84.1
\pm 1.9
4.5
26
50k
50k
93.8
\pm 1.4
22.5
110
70k
70k
94.5
\pm 1.1
31.5
150
5k
70k
71.8
\pm 2.0
19.8
84
1k
70k
76.2
\pm 2.9
19.8
76
100
70k
84.4
\pm 5.9
19.8
74
8k^{\dagger}
8k^{\dagger}
91.7
-
-
42k^{\dagger}
42k^{\dagger}
93.6
-
-
94.2
-
-
10k
10k
98.7
-
-
-
-
92.5
-
-
-
-
99.4
-
-
M=5k
M
\times
10k
\times
M
N
900
3{\small,}481
99.8
\pm 0.1
99.0
\pm 0.2
95.0
\pm 1.1
93.6
\pm 3.3
15.5
570
100
3{\small,}481
99.7
\pm 0.1
98.8
\pm 0.2
95.9
\pm 0.8
96.1
\pm 0.7
2.2
326
5
3{\small,}481
97.5
\pm 1.0
98.4
\pm 0.1
96.7
\pm 0.5
90.2
\pm 1.0
1.1
301
900
900
99.1
\pm 0.2
93.7
\pm 0.5
91.7
\pm 1.4
82.5
\pm 3.0
15.0
314
100
900
98.9
\pm 0.3
94.1
\pm 0.6
92.3
\pm 0.7
84.2
\pm 2.0
1.8
114
5
900
94.8
\pm 0.7
92.4
\pm 0.8
91.0
\pm 1.0
72.1
\pm 3.0
0.7
89
900
3{\small,}481
82.5
\pm 1.6
78.5
\pm 1.9
77.6
\pm 1.0
47.0
\pm 2.4
15.4
314
100
3{\small,}481
33.8
\pm 1.3
34.9
\pm 1.3
29.1
\pm 1.5
0.9
\pm 0.3
2.2
47
100
900
97.2
\pm 1.0
93.2
\pm 0.4
92.3
\pm 0.6
81.4
\pm 1.5
14.0
353
5
900
88.1
\pm 3.1
81.7
\pm 2.6
80.1
\pm 3.6
48.3
\pm 5.7
2.2
285
900
900
98.2
\pm 0.4
90.0
\pm 1.0
52.9
\pm 0.6
71.9
\pm 4.0
15.2
381
100
900
98.4
\pm 0.3
92.4
\pm 0.3
53.8
\pm 1.0
78.0
\pm 3.0
4.6
105
5
900
97.2
\pm 0.6
91.4
\pm 0.6
71.2
\pm 1.0
72.3
\pm 1.7
4.6
73
900
900
98.8
\pm 0.2
93.8
\pm 0.2
92.3
\pm 0.9
80.7
\pm 1.2
15.0
316
-
-
99.3
\pm 0.4
91.9
\pm 0.6
57.0
\pm 1.1
71.7
\pm 9.0
13.7
209
-
-
90.8
\pm 0.7
76.7
\pm 1.3
55.8
\pm 0.4
42.3
\pm 2.6
1.6
30
\times
\times
N=900
N=3{\small,}481
1D-
I=100
M=100
M=5
M
I
M
I
M=100
I=100
M
I
M
I
I
M=50
I\in\{25,50,100\}
I=100
I=all
\approx
M=10
I=890
I=N-M
M
I
M
M=2
I=32
M=2
I=32
25
96.7
0.9
417
6
423
50
98.7
1.0
167
7
174
100
98.8
1.2
104
10
114
200
99.1
3.3
74
15
89
400
98.4
4.2
88
49
137
C
\bm{\tilde{Y}}_{m}=g^{\psi}(\bm{X}^{*}_{m})
g^{\psi}:\mathbb{R}^{D}\to\mathbb{R}^{C}
\psi
\bm{\hat{y}}=\sigma(\sum_{m=1}^{M}a_{m}\bm{\tilde{Y}}_{m})
\sigma
\bm{X}^{*}_{m}
a_{m}
g^{\psi}
N=900
\operatorname*{argmax}_{c}\bm{\tilde{Y}}_{m}
a_{m}
M
I
M=10,I=32
M=100
I=100
N=3{\small,}481
M=5{\small,}000,I=5{\small,}000
N=all
step=1,2,\ldots
P_{M}^{0}=
t=0~{}
~{}T
P_{I}^{t+1}=
\bm{a}^{t+1}=
P_{M}^{t+1}=
M
P_{M}^{t}\cup P_{I}^{t+1}
P_{M}^{T}
\bm{z}=
\bm{z}^{h},h=1,\dots,H
H
\displaystyle\bm{z}^{c}=\textrm{concat}\left(\bm{z}^{1},\cdots,\bm{z}^{H}%
\right),
\displaystyle\bm{z}^{c}
\displaystyle=\textrm{concat}\left(\bm{z}^{1},\cdots,\bm{z}^{H}\right),
\displaystyle\bm{z}=\bm{z}^{c}\bm{W}^{o},
\displaystyle\bm{z}
\displaystyle=\bm{z}^{c}\bm{W}^{o},
\bm{z}^{h}\in\mathbb{R}^{D_{v}}
\bm{z}^{c}\in\mathbb{R}^{(D_{v}\cdot H)}
\bm{z}\in\mathbb{R}^{D}
\bm{W}^{o}\in\mathbb{R}^{(D_{v}\cdot H)\times D}
\bm{z}^{h}
\bm{a}^{h}
\displaystyle\bm{z}=\textrm{MCA}(\bm{X}^{*}+\bm{X}^{pos})
\displaystyle\bm{z}
\displaystyle=\textrm{MCA}(\bm{X}^{*}+\bm{X}^{pos})
\displaystyle\bm{z}^{\prime}=\textrm{LN}(\bm{z}+\bm{q}^{\phi})
\displaystyle\bm{z}^{\prime}
\displaystyle=\textrm{LN}(\bm{z}+\bm{q}^{\phi})
\displaystyle\bm{z}^{o}=\textrm{LN}(\textrm{MLP}(\bm{z}^{\prime})+\bm{z}^{%
\prime}),
\displaystyle\bm{z}^{o}
\displaystyle=\textrm{LN}(\textrm{MLP}(\bm{z}^{\prime})+\bm{z}^{\prime}),
\bm{X}^{pos}\in\mathbb{R}^{M\times D}
1D-
\times
M
M=2
D_{inner}=D
M=2
M=5
D_{\mathrm{inner}}
D_{\mathrm{inner}}
D
D_{k}
D/8
D_{v}
D/8
D_{\mathrm{inner}}
4D
0.1
0.1
\times
\times
\times
\times
N=900
N=768
500
L^{2}
0.1
\sigma=0.05
0
M=5
\sigma
D_{h}=128
D_{h}=1024
\times
\{0^{\circ},90^{\circ},180^{\circ},270^{\circ}\}
1.0
0.5
0.5
\text{scale}=(0.2,1.0)
1.0
\text{brightness}=0.8,
0.8
\text{contrast}=0.8,
\text{saturation}=0.8,
\text{hue}=0.2
0.2
\text{kernel size}=23
[1.0,0.1]
\text{threshold}=150
[0.0,0.2]
N=900
I=100
M
M
M=5
100
M=200
M=5
M=200
98.8\%
M=100
98.9\%
M
M=10
M=10
N=3{\small,}481
N=3{\small,}481
