M
N
M=3
N=5
M
N
M=3
N=5
q
\{d_{1},d_{2},\cdots d_{k}\}\in C
C
\displaystyle P(\text{Relevance}|q,d)\triangleq\phi(\eta_{q}(q),\eta_{d}(d))=%
\phi(\mathbf{q},\mathbf{d})
\displaystyle P(\text{Relevance}|q,d)\triangleq\phi(\eta_{q}(q),\eta_{d}(d))=%
\phi(\mathbf{q},\mathbf{d})
\eta_{q}(q)
\eta_{d}(d)\in\mathbb{R}^{h}
h
\mathbf{q}
\mathbf{d}
\mathbf{q}
\mathbf{d}
\phi(\cdot,\cdot)
\displaystyle P^{ds}(\text{Relevance}|q,d)\triangleq\langle\mathbf{q}^{\texttt%
{[CLS]}},\mathbf{d}^{\texttt{[CLS]}}\rangle,
\displaystyle P^{ds}(\text{Relevance}|q,d)\triangleq\langle\mathbf{q}^{\texttt%
{[CLS]}},\mathbf{d}^{\texttt{[CLS]}}\rangle,
\mathbf{q}^{\texttt{[CLS]}}
\mathbf{d}^{\texttt{[CLS]}}\in\mathbb{R}^{768}
|V_{\text{BERT}}|
|V_{\text{BERT}}|=30522
\displaystyle P^{sp}(\text{Relevance}|q,d)\triangleq\langle\mathbf{q}^{sp},%
\mathbf{d}^{sp}\rangle,
\displaystyle P^{sp}(\text{Relevance}|q,d)\triangleq\langle\mathbf{q}^{sp},%
\mathbf{d}^{sp}\rangle,
\mathbf{q}^{sp}
\mathbf{d}^{sp}\in\mathbb{R}^{30522}
k
k
|V|
\mathbf{q}^{sp}=(q_{0},\cdots q_{|V|-1})
\mathbf{d}^{sp}=(d_{0},\cdots d_{|V|-1})
M
N
|V|=M\cdot N
\displaystyle S^{q}_{m}=\mathbf{q}^{sp}[mN:mN+N]\in\mathbb{R}^{N}
\displaystyle S^{q}_{m}=\mathbf{q}^{sp}[mN:mN+N]\in\mathbb{R}^{N}
\displaystyle S^{d}_{m}=\mathbf{d}^{sp}[mN:mN+N]\in\mathbb{R}^{N},
\displaystyle S^{d}_{m}=\mathbf{d}^{sp}[mN:mN+N]\in\mathbb{R}^{N},
m\in\{0,1,\cdots,M-1\}
N
\mathbf{q}^{sp}
\mathbf{d}^{sp}
\displaystyle\langle\mathbf{q}^{sp},\mathbf{d}^{sp}\rangle=\sum_{m=0}^{M-1}%
\langle S^{q}_{m},S^{d}_{m}\rangle
\displaystyle\langle\mathbf{q}^{sp},\mathbf{d}^{sp}\rangle=\sum_{m=0}^{M-1}%
\langle S^{q}_{m},S^{d}_{m}\rangle
S^{q}_{m}
S^{d}_{m}
\displaystyle S^{q}_{m}\approx\max{(S^{q}_{m})}\cdot\hat{\mathbf{u}}(\text{e}^%
{q}_{m})
\displaystyle S^{q}_{m}\approx\max{(S^{q}_{m})}\cdot\hat{\mathbf{u}}(\text{e}^%
{q}_{m})
\displaystyle S^{d}_{m}\approx\max{(S^{d}_{m})}\cdot\hat{\mathbf{u}}(\text{e}^%
{d}_{m}),
\displaystyle S^{d}_{m}\approx\max{(S^{d}_{m})}\cdot\hat{\mathbf{u}}(\text{e}^%
{d}_{m}),
\hat{\mathbf{u}}(\text{e}^{q}_{m})
\text{e}^{q}_{m}=\mathrm{argmax}{(S^{q}_{m})}
\mathbf{q}^{sp}
\mathbf{d}^{sp}
\displaystyle\langle\mathbf{q}^{sp},\mathbf{d}^{sp}\rangle\approx
\displaystyle\langle\mathbf{q}^{sp},\mathbf{d}^{sp}\rangle\approx
\displaystyle\sum_{m=0}^{M-1}\max{(S^{q}_{m})}\cdot\max{(S^{d}_{m})}\cdot%
\langle\hat{\mathbf{u}}(\text{e}^{q}_{m}),\hat{\mathbf{u}}(\text{e}^{d}_{m})\rangle
\displaystyle\sum_{m=0}^{M-1}\max{(S^{q}_{m})}\cdot\max{(S^{d}_{m})}\cdot%
\langle\hat{\mathbf{u}}(\text{e}^{q}_{m}),\hat{\mathbf{u}}(\text{e}^{d}_{m})\rangle
\displaystyle=\sum_{m=0}^{M-1}\max{(S^{q}_{m})}\cdot\max{(S^{d}_{m})}\mathds{1%
}_{\{\text{e}^{q}_{m}=\text{e}^{d}_{m}\}}
\displaystyle=\sum_{m=0}^{M-1}\max{(S^{q}_{m})}\cdot\max{(S^{d}_{m})}\mathds{1%
}_{\{\text{e}^{q}_{m}=\text{e}^{d}_{m}\}}
M
\displaystyle\mathbf{q}^{ds}=(\max{(S^{q}_{0})},\cdots,\max{(S^{q}_{M-1})})\in%
\mathbb{R}^{M}
\displaystyle\mathbf{q}^{ds}
\displaystyle=(\max{(S^{q}_{0})},\cdots,\max{(S^{q}_{M-1})})\in\mathbb{R}^{M}
\displaystyle\mathbf{d}^{ds}=(\max{(S^{d}_{0})},\cdots,\max{(S^{d}_{M-1})})\in%
\mathbb{R}^{M}
\displaystyle\mathbf{d}^{ds}
\displaystyle=(\max{(S^{d}_{0})},\cdots,\max{(S^{d}_{M-1})})\in\mathbb{R}^{M}
\displaystyle\mathbf{e}^{q}=(\text{e}^{q}_{0},\cdots,\text{e}^{q}_{M-1})\in%
\mathbb{N}^{M}
\displaystyle\mathbf{e}^{q}
\displaystyle=(\text{e}^{q}_{0},\cdots,\text{e}^{q}_{M-1})\in\mathbb{N}^{M}
\displaystyle\mathbf{e}^{d}=(\text{e}^{d}_{0},\cdots,\text{e}^{d}_{M-1})\in%
\mathbb{N}^{M},
\displaystyle\mathbf{e}^{d}
\displaystyle=(\text{e}^{d}_{0},\cdots,\text{e}^{d}_{M-1})\in\mathbb{N}^{M},
\mathbf{q}^{ds}
\mathbf{d}^{ds}
M
\mathbf{e}^{q}
\mathbf{e}^{d}
\mathbf{q}^{ds}
\mathbf{e}^{q}
\mathbf{d}^{ds}
\mathbf{e}^{d}
\displaystyle\langle\mathbf{q}^{sp},\mathbf{d}^{sp}\rangle\approx
\displaystyle\langle\mathbf{q}^{sp},\mathbf{d}^{sp}\rangle\approx
\displaystyle\sum_{m=0}^{M-1}\mathbf{q}^{ds}[m]\cdot\mathbf{d}^{ds}[m]\mathds{%
1}_{\{\mathbf{e}^{q}[m]=\mathbf{e}^{d}[m]\}},
\displaystyle\sum_{m=0}^{M-1}\mathbf{q}^{ds}[m]\cdot\mathbf{d}^{ds}[m]\mathds{%
1}_{\{\mathbf{e}^{q}[m]=\mathbf{e}^{d}[m]\}},
\mathbf{q}^{ds}[m]
\mathbf{d}^{ds}[m]
\mathbf{e}^{q}[m]
\mathbf{e}^{d}[m]
m
4\cdot M
M
2\cdot M
C
4\cdot M|C|
2\cdot M|C|
\displaystyle\sum_{m\in\mathcal{M}}\mathbf{q}^{ds}[m]\cdot\mathbf{d}^{ds}[m]%
\mathds{1}_{\{\text{e}^{q}[m]=\text{e}^{d}[m]\}},
\displaystyle\sum_{m\in\mathcal{M}}\mathbf{q}^{ds}[m]\cdot\mathbf{d}^{ds}[m]%
\mathds{1}_{\{\text{e}^{q}[m]=\text{e}^{d}[m]\}},
\mathcal{M}=\{m|\mathbf{q}^{ds}[m]>\theta\}
\theta
\mathbf{q}^{ds}[m]
k
\theta
\theta=0
\theta
\theta=0
\times
\displaystyle\sum_{m=0}^{M-1}\lambda\cdot\mathbf{q}^{\texttt{[CLS]}}[m]\cdot%
\mathbf{d}^{\texttt{[CLS]}}[m]
\displaystyle\sum_{m=0}^{M-1}
\displaystyle\lambda\cdot\mathbf{q}^{\texttt{[CLS]}}[m]\cdot\mathbf{d}^{%
\texttt{[CLS]}}[m]
\displaystyle+\mathbf{q}^{ds}[m]\cdot\mathbf{d}^{ds}[m]\mathds{1}_{\{\mathbf{e%
}^{q}[m]=\mathbf{e}^{d}[m]\}},
\displaystyle+\mathbf{q}^{ds}[m]\cdot\mathbf{d}^{ds}[m]\mathds{1}_{\{\mathbf{e%
}^{q}[m]=\mathbf{e}^{d}[m]\}},
\lambda
k
|V_{\text{BERT}}|
|V_{\text{BERT}}|=30522
M=768
N=39
1\%
2\%
4\%
M=256
128
\theta
x
\theta=0
\theta
\theta\leq 0.1
\theta
0.1
\lambda
