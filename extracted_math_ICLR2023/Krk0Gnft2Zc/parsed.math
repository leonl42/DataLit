\mathcal{M}=(\mathcal{X},\mathcal{A},p,r,\gamma,x_{0})
\mathcal{X}
\mathcal{A}
p(x^{\prime}\mid x,a)
x^{\prime}
a
x
r:\mathcal{X}\times\mathcal{A}\to[0,1]
0<\gamma<1
x_{0}
x_{t}\in\mathcal{X},a_{t}\in\mathcal{A}
t
\pi(a_{t}\mid x_{t})
x_{t}
\pi
a
x
Q^{\pi}(x,a)=\mathbb{E}_{p,\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}r(x_{t},a_{t%
})\bigg{|}a_{0}=a,x_{0}=x\right]
a_{t}\sim\pi(\cdot|x_{t})
x_{t+1}\sim p(\cdot|x_{t},a_{t})
\pi
x_{0}
\pi\in\arg\max_{\bar{\pi}}\mathbb{E}_{a\sim\bar{\pi}(\cdot\mid x)}[Q^{\bar{\pi%
}}(x_{0},a)]
p
o=(\mathcal{I}_{o},\pi_{o},\mathcal{T}_{o})
\mathcal{I}_{o},\mathcal{T}_{o}\subseteq\mathcal{X}
\pi_{o}
x_{0}\in\mathcal{I}_{o}
\mathcal{T}_{o}
8\times 8
||\psi(s)-\psi(\bar{s})||
s
\bar{s}
8\times 8
||\psi(s)-\psi(\bar{s})||
s
\bar{s}
\pi
\mathcal{S}
\Psi_{\pi}\in\mathbb{R}^{|\mathcal{S}|\times|\mathcal{S}|}
(u,v)
\Psi_{\pi}(u,v)=\mathbb{E}_{p,\pi}\left[\sum_{t=1}^{\infty}\gamma^{t}\bm{1}_{%
\mathrm{s_{t}=v}}\bigg{|}s_{0}=u\right].
u
u
\Psi_{\pi}
\Psi_{\pi}(u)
\Psi_{\pi}(u,v)=\bm{1}_{\mathrm{u=v}}+\gamma\mathbb{E}_{s\sim p(\cdot|u,\pi(u)%
)}\Psi_{\pi}(s,v).
\mathcal{D}
\pi
\psi:\mathcal{S}\to\mathbb{R}^{|\mathcal{S}|}
\mathbb{E}_{s,s^{\prime}\sim D}\left[\psi(s)-(\mathbbm{1}(s)+\gamma\psi(s^{%
\prime}))\right]^{2}
\mathbbm{1}(s)
s
s
\pi
\pi
M_{\phi,\psi}
\mathcal{D}
\phi
M_{\phi,\psi}
\phi
x
s
\psi
x^{\prime}
M_{\phi,\psi}
\phi
x
s
\psi
x^{\prime}
\phi:\mathcal{X}\to\Delta(N)
x\in\mathcal{X}
N
N
\mathcal{U}(N)
N
\mathcal{D}
\mathcal{L}_{H}(\phi;\mathcal{D})=\displaystyle\mathop{\mathbb{E}}_{x\sim%
\mathcal{D}}\left[D_{\mathrm{KL}}(\phi(\cdot\mid x)\mid\mid\mathcal{U}(N))%
\right]=\displaystyle\mathop{\mathbb{E}}_{x\sim\mathcal{D}}\left[-H(\phi(\cdot%
\mid x))\right],
\mathcal{D}
H(\phi(x))=-\sum_{i}\phi(x)_{i}\log(\phi(x)_{i})
\phi
\psi
\phi
\psi:\Delta(N)\to\mathbb{R}^{N}
\mathcal{D}
\mathcal{L}_{SR}(\psi;\phi,\mathcal{D})=\mathop{\mathbb{E}}_{x,x^{\prime}\sim D%
}\left[\psi(\phi(x))-(\phi(x)+\gamma\psi(\phi(x^{\prime})))^{-}\right]^{2}
(\cdot)^{-}
\psi
\phi
\phi
\phi\equiv 0
\psi\equiv 0
\psi
\pi
\psi_{\pi}
\pi
\phi
\pi
\psi_{\pi}
\pi
\phi
N
\mathcal{D}=\{(x,a,x^{\prime})_{i}\mid x^{\prime}\sim p(\cdot\mid x,a)\}
\phi,\psi
N
\mathcal{L}_{A}(\phi,\psi;\mathcal{D})=\mathcal{L}_{H}(\phi;\mathcal{D})+%
\mathcal{L}_{SR}(\psi;\phi,\mathcal{D})
(\phi,\psi)\in\arg\min\mathcal{L}_{A}
\mathcal{D}
G=(V=[N],E=\{\})
E=\{(\phi(x),\phi(x^{\prime}))\mid(x,x^{\prime})\in\mathcal{D})\}
\mathcal{O}^{\prime}=\{o_{u,v}\mid(u,v)\in E\}
\phi^{-1}(u)
\phi^{-1}(v)
\phi,\psi,\mathcal{O}^{\prime}
\phi
\phi
\mathcal{O}
G
N
\mathcal{D}
\phi:\mathcal{X}\to[N]
\phi^{-1}(s)=\{x\in\mathcal{X}\mid\phi(x)=s\}
\psi:[N]\to\mathbb{R}^{N}
G=(V,E)
V=[N]
E=\{(\phi(x),\phi(x^{\prime}))\in[N]\times[N]\mid(x,x^{\prime})\in\mathcal{D}\}
o_{s,s^{\prime}}\in\mathcal{O}
o_{s,s^{\prime}}=(\phi^{-1}(s),\pi_{s,s^{\prime}},\mathcal{X}\setminus\phi^{-1%
}(s))
(s,s^{\prime})\in E
\pi_{s,s^{\prime}}
s
\pi_{s,s^{\prime}}
s^{\prime}
r_{s,s^{\prime}}(x,a)=\bm{1}_{\mathrm{\phi(x^{\prime})=s^{\prime}}}
x^{\prime}\sim p(\cdot|x,a)
x_{0}\in\mathcal{X}
x_{g}\in\mathcal{X}
G
P_{x_{0},x_{g}}=[s_{0},s_{1}\dotsc\dotsc\dotsc,s_{k}|s_{0}=\phi(x_{0}),s_{k}=%
\phi(s_{g})]
x_{g}
\{o_{s_{i},s_{i+1}}\}_{i=0}^{k-1}
s_{k}
\mathcal{X}
\phi^{-1}(\phi(x_{g}))\subseteq\mathcal{X}
G
M_{\phi,\psi}
M_{\phi,\psi}
M_{\phi,\psi}
N
30
200
30
200
\mathcal{X}
\phi:\mathcal{X}\to[N]
\psi:[N]\to\mathbb{R}^{N}
\displaystyle\min_{\phi,\psi}\mathbb{E}_{x\sim\mathcal{X},x^{\prime}\sim p(%
\cdot\mid x)}\left|\left|\psi(\phi(x))-(\phi(x)+\gamma\psi(\phi(x^{\prime})))%
\right|\right|_{2}^{2}
\displaystyle\min_{\phi,\psi}
\displaystyle\mathbb{E}_{x\sim\mathcal{X},x^{\prime}\sim p(\cdot\mid x)}\left|%
\left|\psi(\phi(x))-(\phi(x)+\gamma\psi(\phi(x^{\prime})))\right|\right|_{2}^{2}
\displaystyle\textrm{s.t.}H(\phi_{\mathcal{X}})>k
\displaystyle H(\phi_{\mathcal{X}})>k
p(\cdot\mid x)=\mathbb{E}_{a}p(\cdot\mid x,a)
\phi_{\mathcal{X}}
[N]
p_{\phi_{\mathcal{X}}}(i)=\mathbb{E}_{x}(\bm{1}_{\mathrm{\phi(x)=i}})
\mathcal{X}
i
\phi
\mathcal{L}_{A}
\beta=1
\beta=1
\beta=10
\beta=10
\beta=100
\beta=100
4
0
\beta
4
0
\beta
\phi
\beta>0
\mathcal{L}_{A}=\mathcal{L}_{H}+\beta\mathcal{L}_{SR}
-e_{n}
-e_{n}
e_{n}
e_{n}
-e_{n-1}
-e_{n-1}
e_{n-1}
e_{n-1}
-e_{n-2}
-e_{n-2}
e_{n-2}
e_{n-2}
-e_{n-3}
-e_{n-3}
e_{n-3}
e_{n-3}
4
1
\delta
\delta=1
-90
90
\delta
[0,0,0]
(x,y)=(13,13)
(0,0)
y=11
y=9
\phi,\psi,\pi_{s,s^{\prime}}
\phi:\mathcal{X}\to\Delta(N)
x
N
\tau
N=8,\tau=0.5
\psi:\Delta(N)\to\mathbb{R}^{N}
\phi
N
x
s=\phi(x)
N=8
5
8+5=13
\pi_{s,s^{\prime}}
N=8
|\mathcal{A}|=6
8\times 6=48
5000
100,000
20
100,000
0.001
512
\pi_{s,s^{\prime}}
\phi,\psi
\gamma
0.95
M_{\phi,\psi}
-\pi
\pi
19\times 19=361
62\times 62=3844
19\times 19=361
62\times 62=3844
10
0
4
10
0
4
