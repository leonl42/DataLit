\ell_{\infty}
\ell_{2}
N=\{1,\ldots,n\}
n
U:2^{N}\rightarrow\mathbb{R}
2^{N}
N
N
N
U
U(S)=\texttt{acc}(\mathcal{A}(S))
\mathcal{A}
S
U(S)\in[0,1]
S\cup i:=S\cup\{i\}
S\setminus i:=S\setminus\{i\}
\{i\}
i\in N
i\in N
U
\phi(i;U)
i
N
\displaystyle\phi_{\text{loo}}(i;U):=U(N)-U(N\setminus i)
\displaystyle\phi_{\text{loo}}(i;U):=U(N)-U(N\setminus i)
i
\displaystyle\phi_{\mathrm{shap}}\left(i;U\right)
\displaystyle\phi_{\mathrm{shap}}\left(i;U\right)
\displaystyle:=\frac{1}{n}\sum_{k=1}^{n}{n-1\choose k-1}^{-1}\sum_{S\subseteq N%
\setminus\{i\},|S|=k-1}\left[U(S\cup i)-U(S)\right]
\displaystyle:=\frac{1}{n}\sum_{k=1}^{n}{n-1\choose k-1}^{-1}\sum_{S\subseteq N%
\setminus\{i\},|S|=k-1}\left[U(S\cup i)-U(S)\right]
\bullet
U\left(S\cup i\right)=U(S)+c
S\subseteq N\setminus i
c\in\mathbb{R}
\phi\left(i;U\right)=c
\bullet
U(S\cup i)=U(S\cup j)
S\subseteq N\setminus\{i,j\}
\phi(i;U)=\phi(j;U)
\bullet
U_{1},U_{2}
\alpha_{1},\alpha_{2}\in\mathbb{R}
\phi\left(i;\alpha_{1}U_{1}+\alpha_{2}U_{2}\right)=\alpha_{1}\phi\left(i;U_{1}%
\right)+
\alpha_{2}\phi\left(i;U_{2}\right)
\bullet
U,\sum_{i\in N}\phi(i;U)=U(N)
U(S\cup i)-U(S)
i
S\subseteq N\setminus i
U(N)
i
U(S\cup i)-U(S)
S\subseteq N\setminus i
\phi_{\mathrm{semi}}
w:[n]\rightarrow\mathbb{R}
\sum_{k=1}^{n}{n-1\choose k-1}w(k)=n
\phi_{\mathrm{semi}}
\begin{split}\phi_{\mathrm{semi}}\left(i;U,w\right):=\sum_{k=1}^{n}\frac{w(k)}%
{n}\sum_{\begin{subarray}{c}S\subseteq N\setminus\{i\},\\
|S|=k-1\end{subarray}}\left[U(S\cup i)-U(S)\right]\end{split}
w_{\mathrm{shap}}(k)={n-1\choose k-1}^{-1}
w_{\mathrm{loo}}(k)=n\bm{1}[k=n]
U(S)
\texttt{acc}(\mathcal{A}(S))
\mathcal{A}(S)
S
\mathcal{A}
U(S)
k\%
k\%
k\%
k\%
k\%
k\%
\approx 0.001
\approx 0.038
k\%
<10\%
k\leq 50\%
U
U
U(S):=\mathbb{E}_{\mathcal{A}}[\texttt{acc}(\mathcal{A}(S))]
U(S)
\mathcal{A}
S
S
U(S)
\mathcal{A}
U(S)
w
\sum_{k=1}^{n}{n-1\choose k-1}w(k)=n
i
j
\begin{split}D_{i,j}(U;w)&:=n(\phi(i;w)-\phi(j;w))\\
&=\sum_{k=1}^{n-1}\left(w(k)+w(k+1)\right){n-2\choose k-1}\Delta_{i,j}^{(k)}(U%
),\end{split}
\Delta_{i,j}^{(k)}(U):={n-2\choose k-1}^{-1}\sum_{|S|=k-1,S\subseteq N%
\setminus\{i,j\}}[U(S\cup i)-U(S\cup j)]
i
j
k
U
\widehat{U}
U
\widehat{U}
U
i,j
D_{i,j}(U;w)D_{i,j}(\widehat{U};w)\leq 0
\leq 0
<0
\left\lVert\widehat{U}-U\right\rVert
U
\widehat{U}
U
2^{n}
U(S)
S\subseteq N
U
U
i
j
\Delta_{i,j}^{(k)}(U)\simeq 0
k=1,\ldots,n-1
D_{i,j}(U;w)
\phi(i)
\phi(j)
i
j
(i,j)
\tau
U
\Delta_{i,j}^{(k)}(U)\geq\tau
k\in\{1,\ldots,n-1\}
\mathcal{U}_{i,j}^{(\tau)}
U
\tau
(i,j)
\left\lVert\widehat{U}-U\right\rVert
(i,j)
U
\mathcal{U}_{i,j}^{(\tau)}
\tau>0
(i,j)
\displaystyle\texttt{Safe}_{i,j}(\tau;w):=\min_{U\in\mathcal{U}_{i,j}^{(\tau)}%
}\min_{\widehat{U}\in\{\widehat{U}:D_{i,j}(U;w)D_{i,j}(\widehat{U};w)\leq 0\}}%
\left\lVert\widehat{U}-U\right\rVert
\displaystyle\texttt{Safe}_{i,j}(\tau;w):=\min_{U\in\mathcal{U}_{i,j}^{(\tau)}%
}\min_{\widehat{U}\in\{\widehat{U}:D_{i,j}(U;w)D_{i,j}(\widehat{U};w)\leq 0\}}%
\left\lVert\widehat{U}-U\right\rVert
\displaystyle\texttt{Safe}(\tau;w):=\min_{i,j\in N,i\neq j}\texttt{Safe}_{i,j}%
(\tau;w)
\displaystyle\texttt{Safe}(\tau;w):=\min_{i,j\in N,i\neq j}\texttt{Safe}_{i,j}%
(\tau;w)
i
j
\phi_{\mathrm{banz}}(i;U)<\phi_{\mathrm{banz}}(j;U)
i,j
i
j
\phi_{\mathrm{banz}}(i;U)<\phi_{\mathrm{banz}}(j;U)
i,j
U(S)
S
\tau>0
w_{\mathrm{loo}}(k)=n\bm{1}[k=n]
\texttt{Safe}(\tau;w_{\mathrm{loo}})=\tau
w_{\mathrm{shap}}(k)={n-1\choose k-1}^{-1}
\texttt{Safe}(\tau;w_{\mathrm{shap}})=\tau\frac{n-1}{\sqrt{\sum_{k=1}^{n-1}{n-%
2\choose k-1}^{-1}}}
\texttt{Safe}(\tau;w_{\mathrm{loo}})<\texttt{Safe}(\tau;w_{\mathrm{shap}})<%
\tau(n-1)
\texttt{Safe}(\tau;w_{\mathrm{loo}})<\texttt{Safe}(\tau;w_{\mathrm{shap}})
i
\displaystyle\phi_{\mathrm{banz}}(i;U,N):=\frac{1}{2^{n-1}}\sum_{S\subseteq N%
\setminus i}[U(S\cup i)-U(S)]
\displaystyle\phi_{\mathrm{banz}}(i;U,N):=\frac{1}{2^{n-1}}\sum_{S\subseteq N%
\setminus i}[U(S\cup i)-U(S)]
w(k)=\frac{n}{2^{n-1}}
k\in\{1,\ldots,n\}
\tau>0
w(k)=\frac{n}{2^{n-1}}
\texttt{Safe}(\tau;w)=\tau 2^{n/2-1}
w
L
\|\phi(U)-\phi(\widehat{U})\|\leq L\|U-\widehat{U}\|
U
\widehat{U}
\widehat{\phi}
(\varepsilon,\delta)
\phi
\ell_{p}
\Pr_{\widehat{\phi}}[\|\phi-\widehat{\phi}\|_{p}\leq\varepsilon]\geq 1-\delta
(i,j)
|\phi(i)-\phi(j)|\geq 2\varepsilon
(\varepsilon,\delta)
\ell_{\infty}
i
j
1-\delta
\displaystyle\phi_{\mathrm{banz}}(i)=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N%
\setminus i})}\left[U(S\cup i)-U(S)\right]
\displaystyle\phi_{\mathrm{banz}}(i)=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N%
\setminus i})}\left[U(S\cup i)-U(S)\right]
\mathrm{Unif}(\cdot)
N\setminus\{i\}
\phi_{\mathrm{banz}}(i)
\mathcal{S}_{i}
2^{N\setminus i}
\widehat{\phi}_{\mathrm{MC}}(i)=\frac{1}{|\mathcal{S}_{i}|}\sum_{S\in\mathcal{%
S}_{i}}\left(U(S\cup i)-U(S)\right)
i\in N
\widehat{\phi}_{\mathrm{MC}}=[\widehat{\phi}_{\mathrm{MC}}(1),\ldots,\widehat{%
\phi}_{\mathrm{MC}}(n)]
\widehat{\phi}_{\mathrm{MC}}
(\varepsilon,\delta)
\ell_{2}
O(\frac{n^{2}}{\varepsilon^{2}}\log(\frac{n}{\delta}))
U(\cdot)
\ell_{\infty}
O(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta}))
U(\cdot)
S\in\mathcal{S}_{i}
U(S)
U(S\cup i)
\phi_{\mathrm{banz}}(i)
i
n
i\in N
\phi_{\mathrm{banz}}(i)=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus i})}\left%
[U(S\cup i)\right]-\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus i})}\left[U(S)\right]
m
\mathcal{S}=\{S_{1},\ldots,S_{m}\}
\mathrm{Unif}(2^{N})
i
\mathcal{S}
\mathcal{S}_{\ni i}\cup\mathcal{S}_{\not\ni i}
\mathcal{S}_{\ni i}=\{S\in\mathcal{S}:i\in S\}
\mathcal{S}_{\not\ni i}=\{S\in\mathcal{S}:i\notin S\}=\mathcal{S}\setminus%
\mathcal{S}_{\ni i}
\phi(i)
\displaystyle\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|}%
\sum_{S\in\mathcal{S}_{\ni i}}U(S)-\frac{1}{|\mathcal{S}_{\not\ni i}|}\sum_{S%
\in\mathcal{S}_{\not\ni i}}U(S)
\displaystyle\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|}%
\sum_{S\in\mathcal{S}_{\ni i}}U(S)-\frac{1}{|\mathcal{S}_{\not\ni i}|}\sum_{S%
\in\mathcal{S}_{\not\ni i}}U(S)
\widehat{\phi}_{\mathrm{MSR}}(i)=0
|\mathcal{S}_{\ni i}|
|\mathcal{S}_{\not\ni i}|
U(S)
\phi(i)
i\in N
\widehat{\phi}_{\mathrm{MSR}}
n
\widehat{\phi}_{\mathrm{MSR}}
(\varepsilon,\delta)
\ell_{2}
O\left(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
U(\cdot)
\ell_{\infty}
O\left(\frac{1}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
U(\cdot)
|\mathcal{S}_{\ni i}|
|\mathcal{S}_{\not\ni i}|
\|\widehat{\phi}_{\mathrm{MSR}}-\phi_{\mathrm{banz}}\|
|\mathcal{S}_{\ni i}|
\mathrm{Bin}(m,0.5)
|\mathcal{S}_{\ni i}|
m/2
\frac{1}{m/2}\sum_{S\in\mathcal{S}_{\ni i}}U(S)-\frac{1}{m/2}\sum_{S\in%
\mathcal{S}_{\not\ni i}}U(S)
\phi_{\mathrm{banz}}(i)
\widehat{U}
\widehat{U}
\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{2^{n-1}}{n|\mathcal{S}_{\ni i}|}\sum_{S%
\in\mathcal{S}_{\ni i}}w(|S|)U(S)-\frac{2^{n-1}}{n|\mathcal{S}_{\not\ni i}|}%
\sum_{S\in\mathcal{S}_{\not\ni i}}w(|S|+1)U(S)
w(|S|)={n-1\choose|S|-1}^{-1}
n
\mathcal{D}
2^{N}
\phi_{\mathrm{shap}}\left(i\right)=\mathbb{E}_{S\sim\mathcal{D}|\mathcal{D}\ni
i%
}\left[U(S)\right]-\mathbb{E}_{S\sim\mathcal{D}|\mathcal{D}\not\ni i}\left[U(S%
)\right]
(\varepsilon,\delta)
\ell_{\infty}
(\varepsilon,\delta)
\ell_{\infty}
\delta\in(0,1/2)
\Omega(\frac{1}{\varepsilon})
\widetilde{O}(\frac{1}{\varepsilon^{2}})
\widetilde{O}
\frac{1}{\varepsilon}
\geq 1000
\geq 1000
k
U(S)
k
k
U(S)
k
U(S)
k
k
\widehat{U}(S)
k=50
\approx 0.856
\approx 0.038
\geq 1000
S
N
\displaystyle\min_{\phi_{\mathrm{LC}}}e\quad\text{s.t. }\sum_{i=1}^{n}\phi_{%
\mathrm{LC}}(i)=U(N),\quad\sum_{i\in S}\phi_{\mathrm{LC}}(i)+e\geq U(S),%
\forall S\subseteq N
\displaystyle\min_{\phi_{\mathrm{LC}}}e\quad\text{s.t. }\sum_{i=1}^{n}\phi_{%
\mathrm{LC}}(i)=U(N),\quad\sum_{i\in S}\phi_{\mathrm{LC}}(i)+e\geq U(S),%
\forall S\subseteq N
U:2^{N}\rightarrow\{0,1\}
U(\emptyset)=0
U(N)=1
U(S)\leq U(T)
S\subseteq T
U
p=0.5
U
\phi:\mathbb{R}^{2^{n}}\rightarrow\mathbb{R}^{n}
U\in\mathbb{R}^{2^{n}}
\phi(U)\in\mathbb{R}^{n}
\phi(\cdot;w)
L
\displaystyle\left\lVert\phi(U;w)-\phi(\widehat{U};w)\right\rVert\leq L\left%
\lVert U-\widehat{U}\right\rVert
\displaystyle\left\lVert\phi(U;w)-\phi(\widehat{U};w)\right\rVert\leq L\left%
\lVert U-\widehat{U}\right\rVert
U
\widehat{U}
U(S)
U(S)=\texttt{acc}(\mathcal{A}(S))
S
\texttt{acc}(\cdot)
\mathcal{A}
U(S)
S
\chi^{2}
\chi^{2}
N
n
U(S)
S\subseteq N
U(S)
U(S)
\texttt{acc}(\mathcal{A}(S))
\mathcal{A}(S)
S
\mathcal{A}
S
\mathcal{A}(S;r)
r
r
r
\mathcal{P}_{\mathcal{A}}
\mathcal{A}(S)
U(S)
r
U(S):=\mathbb{E}_{r\sim P}[\texttt{acc}(\mathcal{A}(S;r))]
\widehat{U}(S)
\texttt{acc}(\mathcal{A}(S;r))
r\sim\mathcal{P}
\widehat{U}(S)-U(S)
\widehat{U}(S)
\widehat{U}(S)
1
f(x;\theta):=\theta x
S=\{(x,y)\}
\mathcal{L}(\theta;S)=\frac{1}{2}\sum_{(x,y)\in S}(y-f(x;\theta))^{2}
x
\theta
\mathbb{R}
\displaystyle\theta_{0}\sim\mathcal{N}(0,\sigma^{2})
\displaystyle\theta_{0}
\displaystyle\sim\mathcal{N}(0,\sigma^{2})
\displaystyle\theta_{1}\leftarrow\theta_{0}-\eta\nabla\mathcal{L}(\theta_{0})
\displaystyle\theta_{1}
\displaystyle\leftarrow\theta_{0}-\eta\nabla\mathcal{L}(\theta_{0})
\displaystyle\ldots
\displaystyle\ldots
\displaystyle\theta_{T}\leftarrow\theta_{0}-\eta\nabla\mathcal{L}(\theta_{T-1})
\displaystyle\theta_{T}
\displaystyle\leftarrow\theta_{0}-\eta\nabla\mathcal{L}(\theta_{T-1})
\eta
T
\widehat{U}(S):=\mathcal{L}(\theta_{T};S_{\mathrm{val}})
S_{\mathrm{val}}=\{(x^{*},y^{*})\}
\theta_{T}
\mathcal{L}(\theta_{T};S_{\mathrm{val}})
\nabla\mathcal{L}(\theta)=\sum_{(x,y)\in S}x(x\theta-y)
t
\displaystyle\theta_{t+1}=\theta_{t}-\eta\sum_{(x,y)\in S}x(x\theta_{t}-y)
\displaystyle\theta_{t+1}
\displaystyle=\theta_{t}-\eta\sum_{(x,y)\in S}x(x\theta_{t}-y)
\displaystyle=\theta_{t}\left(1-\eta\sum_{(x,y)\in S}x^{2}\right)+\eta\sum_{(x%
,y)\in S}xy
\displaystyle=\theta_{t}\left(1-\eta\sum_{(x,y)\in S}x^{2}\right)+\eta\sum_{(x%
,y)\in S}xy
\{\theta_{t}\}
\displaystyle\mathbb{E}[\theta_{t+1}]=\mathbb{E}[\theta_{t}]\left(1-\eta\sum_{%
(x,y)\in S}x^{2}\right)+\eta\sum_{(x,y)\in S}xy
\displaystyle\mathbb{E}[\theta_{t+1}]
\displaystyle=\mathbb{E}[\theta_{t}]\left(1-\eta\sum_{(x,y)\in S}x^{2}\right)+%
\eta\sum_{(x,y)\in S}xy
\displaystyle\mathrm{Var}(\theta_{t+1})=\mathrm{Var}(\theta_{t})\left(1-\eta%
\sum_{(x,y)\in S}x^{2}\right)^{2}
\displaystyle\mathrm{Var}(\theta_{t+1})
\displaystyle=\mathrm{Var}(\theta_{t})\left(1-\eta\sum_{(x,y)\in S}x^{2}\right%
)^{2}
f(S)=\sum_{(x,y)\in S}xy
g(S)=\sum_{(x,y)\in S}x^{2}
\theta_{T}
\displaystyle\mathbb{E}[\theta_{T}]=\frac{f(S)}{g(S)}\left(1-(1-\eta g(S))^{T}\right)
\displaystyle\mathbb{E}[\theta_{T}]
\displaystyle=\frac{f(S)}{g(S)}\left(1-(1-\eta g(S))^{T}\right)
\displaystyle\mathrm{Var}(\theta_{T})=\sigma^{2}\left(1-\eta g(S)\right)^{2T}
\displaystyle\mathrm{Var}(\theta_{T})
\displaystyle=\sigma^{2}\left(1-\eta g(S)\right)^{2T}
(x^{*},y^{*})
\displaystyle x^{*}\theta_{T}-y^{*}\sim\mathcal{N}\left(x^{*}\mathbb{E}[\theta%
_{T}]-y^{*},\mathrm{Var}(\theta_{T})(x^{*})^{2}\right)
\displaystyle x^{*}\theta_{T}-y^{*}\sim\mathcal{N}\left(x^{*}\mathbb{E}[\theta%
_{T}]-y^{*},\mathrm{Var}(\theta_{T})(x^{*})^{2}\right)
(x^{*}\theta_{T}-y^{*})^{2}
\chi^{\prime 2}
\frac{\left(x^{*}\mathbb{E}[\theta_{T}]-y^{*}\right)^{2}}{\mathrm{Var}(\theta_%
{T})(x^{*})^{2}}
\displaystyle(x^{*}\theta_{T}-y^{*})^{2}\sim\mathrm{Var}(\theta_{T})(x^{*})^{2%
}\cdot\chi^{\prime 2}\left(1,\left(\frac{x^{*}\mathbb{E}[\theta_{T}]-y^{*}}{%
\texttt{Std}(\theta_{T})(x^{*})}\right)^{2}\right)
\displaystyle(x^{*}\theta_{T}-y^{*})^{2}
\displaystyle\sim\mathrm{Var}(\theta_{T})(x^{*})^{2}\cdot\chi^{\prime 2}\left(%
1,\left(\frac{x^{*}\mathbb{E}[\theta_{T}]-y^{*}}{\texttt{Std}(\theta_{T})(x^{*%
})}\right)^{2}\right)
\displaystyle\sim\mathrm{Var}(\theta_{T})(x^{*})^{2}\cdot\chi^{\prime 2}\left(%
1,\frac{\left(x^{*}\mathbb{E}[\theta_{T}]-y^{*}\right)^{2}}{\mathrm{Var}(%
\theta_{T})(x^{*})^{2}}\right)
\displaystyle\sim\mathrm{Var}(\theta_{T})(x^{*})^{2}\cdot\chi^{\prime 2}\left(%
1,\frac{\left(x^{*}\mathbb{E}[\theta_{T}]-y^{*}\right)^{2}}{\mathrm{Var}(%
\theta_{T})(x^{*})^{2}}\right)
\mathcal{L}(\theta_{T};S_{\mathrm{val}})=\sum_{(x^{*},y^{*})\in S_{\mathrm{val%
}}}(x^{*}\theta_{T}-y^{*})^{2}
\displaystyle\mathcal{L}(\theta_{T};S_{\mathrm{val}})\sim\sum_{(x^{*},y^{*})%
\in S_{\mathrm{val}}}\mathrm{Var}(\theta_{T})(x^{*})^{2}\cdot\chi^{\prime 2}%
\left(1,\frac{\left(x^{*}\mathbb{E}[\theta_{T}]-y^{*}\right)^{2}}{\mathrm{Var}%
(\theta_{T})(x^{*})^{2}}\right)
\displaystyle\mathcal{L}(\theta_{T};S_{\mathrm{val}})\sim\sum_{(x^{*},y^{*})%
\in S_{\mathrm{val}}}\mathrm{Var}(\theta_{T})(x^{*})^{2}\cdot\chi^{\prime 2}%
\left(1,\frac{\left(x^{*}\mathbb{E}[\theta_{T}]-y^{*}\right)^{2}}{\mathrm{Var}%
(\theta_{T})(x^{*})^{2}}\right)
N
n
S\subseteq N
\theta_{1}
U
U
U(S)
S\subseteq N
\tau
U
\ell_{2}
U,N
w
w(\cdot)
\displaystyle\texttt{Safe}(\tau;w)=\tau\sqrt{\frac{\left(\sum_{k=1}^{n-1}{n-2%
\choose k-1}\left(w(k)+w(k+1)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k%
-1}\left(w(k)+w(k+1)\right)^{2}}}
\displaystyle\texttt{Safe}(\tau;w)=\tau\sqrt{\frac{\left(\sum_{k=1}^{n-1}{n-2%
\choose k-1}\left(w(k)+w(k+1)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k%
-1}\left(w(k)+w(k+1)\right)^{2}}}
\tau>0
\tau>0
(i,j)
\displaystyle\texttt{Safe}_{i,j}(\tau;w)=\min_{U\in\mathcal{U}_{i,j}^{(\tau)}}%
\min_{\widehat{U}\in\{\widehat{U}:D_{i,j}(U;w)D_{i,j}(\widehat{U};w)\leq 0\}}%
\left\lVert\widehat{U}-U\right\rVert
\displaystyle\texttt{Safe}_{i,j}(\tau;w)=\min_{U\in\mathcal{U}_{i,j}^{(\tau)}}%
\min_{\widehat{U}\in\{\widehat{U}:D_{i,j}(U;w)D_{i,j}(\widehat{U};w)\leq 0\}}%
\left\lVert\widehat{U}-U\right\rVert
(i,j)
\tau
(i,j)
w
\displaystyle\texttt{Safe}(\tau;w)=\min_{i\neq j}\texttt{Safe}_{i,j}(\tau;w)
\displaystyle\texttt{Safe}(\tau;w)=\min_{i\neq j}\texttt{Safe}_{i,j}(\tau;w)
D_{i,j}(U;w)
U
a\in\mathbb{R}^{2^{n}}
\displaystyle D_{i,j}(U;w)=a^{T}U
\displaystyle D_{i,j}(U;w)=a^{T}U
a
S\subseteq N
a[\cdot]
a
S
S\subseteq N\setminus\{i,j\}
a[S\cup i]=w(|S|+1)+w(|S|+2)
a[S\cup j]=-(w(|S|+1)+w(|S|+2))
a[S]=0
x=\widehat{U}-U
A=aa^{T}
\displaystyle D_{i,j}(U;w)D_{i,j}(\widehat{U};w)=(a^{T}U)(a^{T}\widehat{U})
\displaystyle D_{i,j}(U;w)D_{i,j}(\widehat{U};w)
\displaystyle=(a^{T}U)(a^{T}\widehat{U})
\displaystyle=(a^{T}U)^{T}(a^{T}\widehat{U})
\displaystyle=(a^{T}U)^{T}(a^{T}\widehat{U})
\displaystyle=U^{T}aa^{T}\widehat{U}
\displaystyle=U^{T}aa^{T}\widehat{U}
\displaystyle=U^{T}A\widehat{U}
\displaystyle=U^{T}A\widehat{U}
\displaystyle=U^{T}A(U+x)
\displaystyle=U^{T}A(U+x)
D_{i,j}(U;w)D_{i,j}(\widehat{U};w)\leq 0
x
\displaystyle\left\lVert x\right\rVert\geq\frac{|U^{T}AU|}{\left\lVert U^{T}A%
\right\rVert}
\displaystyle\left\lVert x\right\rVert
\displaystyle\geq\frac{|U^{T}AU|}{\left\lVert U^{T}A\right\rVert}
\displaystyle=\frac{|U^{T}AU|}{\sqrt{U^{T}AAU}}
\displaystyle=\frac{|U^{T}AU|}{\sqrt{U^{T}AAU}}
\displaystyle=\frac{|U^{T}AU|}{\sqrt{a^{T}a}\sqrt{|U^{T}AU|}}
\displaystyle=\frac{|U^{T}AU|}{\sqrt{a^{T}a}\sqrt{|U^{T}AU|}}
\displaystyle=\sqrt{\frac{|U^{T}AU|}{a^{T}a}}
\displaystyle=\sqrt{\frac{|U^{T}AU|}{a^{T}a}}
AA=(aa^{T})(aa^{T})=a(a^{T}a)a^{T}=(a^{T}a)aa^{T}=(a^{T}a)A
x
U^{T}A
\displaystyle\texttt{Safe}_{i,j}(\tau;w)=\min_{U\in\mathcal{U}_{i,j}^{(\tau)}}%
\sqrt{\frac{|U^{T}AU|}{a^{T}a}}
\displaystyle\texttt{Safe}_{i,j}(\tau;w)=\min_{U\in\mathcal{U}_{i,j}^{(\tau)}}%
\sqrt{\frac{|U^{T}AU|}{a^{T}a}}
f(S)=w(|S|+1)+w(|S|+2)
g(S)=U(S\cup i)-U(S\cup j)
\displaystyle\frac{|U^{T}AU|}{a^{T}a}=\frac{\left|\sum_{S_{1}\subseteq N%
\setminus\{i,j\}}\sum_{S_{2}\subseteq N\setminus\{i,j\}}f(S_{1})f(S_{2})g(S_{1%
})g(S_{2})\right|}{\sum_{S\subseteq N\setminus\{i,j\}}f^{2}(S)}
\displaystyle\frac{|U^{T}AU|}{a^{T}a}
\displaystyle=\frac{\left|\sum_{S_{1}\subseteq N\setminus\{i,j\}}\sum_{S_{2}%
\subseteq N\setminus\{i,j\}}f(S_{1})f(S_{2})g(S_{1})g(S_{2})\right|}{\sum_{S%
\subseteq N\setminus\{i,j\}}f^{2}(S)}
\displaystyle=\frac{\left|\left(\sum_{S_{1}\subseteq N\setminus\{i,j\}}f(S_{1}%
)g(S_{1})\right)\left(\sum_{S_{2}\subseteq N\setminus\{i,j\}}f(S_{2})g(S_{2})%
\right)\right|}{\sum_{S\subseteq N\setminus\{i,j\}}f^{2}(S)}
\displaystyle=\frac{\left|\left(\sum_{S_{1}\subseteq N\setminus\{i,j\}}f(S_{1}%
)g(S_{1})\right)\left(\sum_{S_{2}\subseteq N\setminus\{i,j\}}f(S_{2})g(S_{2})%
\right)\right|}{\sum_{S\subseteq N\setminus\{i,j\}}f^{2}(S)}
\displaystyle=\frac{\left(\sum_{S\subseteq N\setminus\{i,j\}}f(S)g(S)\right)^{%
2}}{\sum_{S\subseteq N\setminus\{i,j\}}f^{2}(S)}
\displaystyle=\frac{\left(\sum_{S\subseteq N\setminus\{i,j\}}f(S)g(S)\right)^{%
2}}{\sum_{S\subseteq N\setminus\{i,j\}}f^{2}(S)}
\displaystyle=\frac{\left(\sum_{k=1}^{n-1}\left(w(k)+w(k+1)\right)\sum_{S%
\subseteq N\setminus\{i,j\},|S|=k-1}\left(U(S\cup i)-U(S\cup j)\right)\right)^%
{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)\right)^{2}}
\displaystyle=\frac{\left(\sum_{k=1}^{n-1}\left(w(k)+w(k+1)\right)\sum_{S%
\subseteq N\setminus\{i,j\},|S|=k-1}\left(U(S\cup i)-U(S\cup j)\right)\right)^%
{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)\right)^{2}}
\displaystyle=\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)%
\right){n-2\choose k-1}^{-1}\sum_{S\subseteq N\setminus\{i,j\},|S|=k-1}\left(U%
(S\cup i)-U(S\cup j)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(%
w(k)+w(k+1)\right)^{2}}
\displaystyle=\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)%
\right){n-2\choose k-1}^{-1}\sum_{S\subseteq N\setminus\{i,j\},|S|=k-1}\left(U%
(S\cup i)-U(S\cup j)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(%
w(k)+w(k+1)\right)^{2}}
\displaystyle{n-2\choose k-1}^{-1}\sum_{S\subseteq N\setminus\{i,j\},|S|=k-1}%
\left(U(S\cup i)-U(S\cup j)\right)=\tau
\displaystyle{n-2\choose k-1}^{-1}\sum_{S\subseteq N\setminus\{i,j\},|S|=k-1}%
\left(U(S\cup i)-U(S\cup j)\right)=\tau
k
\texttt{Safe}_{i,j}(\tau;w)=\tau\sqrt{\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k%
-1}\left(w(k)+w(k+1)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(%
w(k)+w(k+1)\right)^{2}}}
(i,j)
\texttt{Safe}(\tau;w)=\tau\sqrt{\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k-1}%
\left(w(k)+w(k+1)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k%
)+w(k+1)\right)^{2}}}
\tau>0
w_{\mathrm{loo}}(k)=n\bm{1}[k=n]
\texttt{Safe}(\tau;w_{\mathrm{loo}})=\tau
w_{\mathrm{shap}}(k)={n-1\choose k-1}^{-1}
\texttt{Safe}(\tau;w_{\mathrm{shap}})=\tau\frac{n-1}{\sqrt{\sum_{k=1}^{n-1}{n-%
2\choose k-1}^{-1}}}
w_{\mathrm{loo}}(k)=n\bm{1}[k=n]
\texttt{Safe}(\tau;w_{\mathrm{loo}})=\tau
w_{\mathrm{shap}}(k)={n-1\choose k-1}^{-1}
\texttt{Safe}(\tau;w_{\mathrm{shap}})=\tau\frac{n-1}{\sqrt{\sum_{k=1}^{n-1}{n-%
2\choose k-1}^{-1}}}
\tau>0
w(k)=\frac{n}{2^{n-1}}
\texttt{Safe}(\tau;w)=\tau 2^{n/2-1}
w
\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)\right)\right)^{2%
}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)\right)^{2}}
\displaystyle\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)%
\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)\right)^{%
2}}=\frac{\left(\sum_{k=1}^{n-1}\sqrt{{n-2\choose k-1}}\sqrt{{n-2\choose k-1}}%
\left(w(k)+w(k+1)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k%
)+w(k+1)\right)^{2}}
\displaystyle\frac{\left(\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)%
\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)+w(k+1)\right)^{%
2}}
\displaystyle=\frac{\left(\sum_{k=1}^{n-1}\sqrt{{n-2\choose k-1}}\sqrt{{n-2%
\choose k-1}}\left(w(k)+w(k+1)\right)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k%
-1}\left(w(k)+w(k+1)\right)^{2}}
\displaystyle\leq\frac{\sum_{k=1}^{n-1}{n-2\choose k-1}\sum_{k=1}^{n-1}{n-2%
\choose k-1}\left(w(k)+w(k+1)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}%
\left(w(k)+w(k+1)\right)^{2}}
\displaystyle\leq\frac{\sum_{k=1}^{n-1}{n-2\choose k-1}\sum_{k=1}^{n-1}{n-2%
\choose k-1}\left(w(k)+w(k+1)\right)^{2}}{\sum_{k=1}^{n-1}{n-2\choose k-1}%
\left(w(k)+w(k+1)\right)^{2}}
\displaystyle=\sum_{k=1}^{n-1}{n-2\choose k-1}
\displaystyle=\sum_{k=1}^{n-1}{n-2\choose k-1}
\displaystyle=2^{n-2}
\displaystyle=2^{n-2}
w(|S|+1)+w(|S|+2)
\texttt{Safe}(\tau;w)
w
w
w(k)+w(k+1)
w(1)=w(3)=w(5)=\ldots
w(2)=w(4)=w(6)=\ldots
\widehat{\phi}_{\mathrm{MC}}
(\varepsilon,\delta)
\ell_{2}
O(\frac{n^{2}}{\varepsilon^{2}}\log(\frac{n}{\delta}))
U(\cdot)
\ell_{\infty}
O(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta}))
U(\cdot)
\mathcal{S}=\{S_{1},\ldots,S_{m}\}
\widehat{\phi}_{\mathrm{MC}}(i)
U(S\cup i)-U(S)
[-1,1]
\displaystyle\Pr\left[\left|\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq%
\varepsilon\right]\leq 2\exp\left(-2m\varepsilon^{2}\right)
\displaystyle\Pr\left[\left|\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq%
\varepsilon\right]\leq 2\exp\left(-2m\varepsilon^{2}\right)
i\in N
\ell_{2}
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left\lVert\widehat{\phi}%
_{\mathrm{MC}}-\phi\right\rVert_{2}\geq\varepsilon\right]=1-\Pr_{\widehat{\phi%
}_{\mathrm{MC}}}\left[\left\lVert\widehat{\phi}_{\mathrm{MC}}-\phi\right\rVert%
_{2}^{2}\leq\varepsilon^{2}\right]
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left\lVert\widehat{\phi}%
_{\mathrm{MC}}-\phi\right\rVert_{2}\geq\varepsilon\right]
\displaystyle=1-\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left\lVert\widehat{%
\phi}_{\mathrm{MC}}-\phi\right\rVert_{2}^{2}\leq\varepsilon^{2}\right]
\displaystyle\leq 1-\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\cap_{i}\left|%
\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\leq\varepsilon/\sqrt{n}\right]
\displaystyle\leq 1-\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\cap_{i}\left|%
\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\leq\varepsilon/\sqrt{n}\right]
\displaystyle=\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\cup_{i}\left|\widehat{%
\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon/\sqrt{n}\right]
\displaystyle=\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\cup_{i}\left|\widehat{%
\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon/\sqrt{n}\right]
\displaystyle\leq\sum_{i=1}^{n}\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left|%
\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon/\sqrt{n}\right]
\displaystyle\leq\sum_{i=1}^{n}\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left|%
\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon/\sqrt{n}\right]
\displaystyle\leq 2n\exp\left(-2m\varepsilon^{2}/n\right)
\displaystyle\leq 2n\exp\left(-2m\varepsilon^{2}/n\right)
2n\exp\left(-2m\varepsilon^{2}/n\right)\leq\delta
m\geq\frac{n}{2\varepsilon^{2}}\log\left(\frac{2n}{\delta}\right)=O\left(\frac%
{n}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
m
\phi(i)
O\left(\frac{n^{2}}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
\ell_{\infty}
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left\lVert\widehat{\phi}%
_{\mathrm{MC}}-\phi\right\rVert_{\infty}\geq\varepsilon\right]=\Pr_{\widehat{%
\phi}_{\mathrm{MC}}}\left[\cup_{i}\left|\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i%
)\right|\geq\varepsilon\right]
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left\lVert\widehat{\phi}%
_{\mathrm{MC}}-\phi\right\rVert_{\infty}\geq\varepsilon\right]
\displaystyle=\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\cup_{i}\left|\widehat{%
\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon\right]
\displaystyle\leq\sum_{i=1}^{n}\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left|%
\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon\right]
\displaystyle\leq\sum_{i=1}^{n}\Pr_{\widehat{\phi}_{\mathrm{MC}}}\left[\left|%
\widehat{\phi}_{\mathrm{MC}}(i)-\phi(i)\right|\geq\varepsilon\right]
\displaystyle\leq 2n\exp\left(-2m\varepsilon^{2}\right)
\displaystyle\leq 2n\exp\left(-2m\varepsilon^{2}\right)
2n\exp\left(-2m\varepsilon^{2}\right)\leq\delta
m\geq\frac{1}{2\varepsilon^{2}}\log\left(\frac{2n}{\delta}\right)=O\left(\frac%
{1}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
m
\phi(i)
O\left(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
\widehat{\phi}_{\mathrm{MSR}}
(\varepsilon,\delta)
\ell_{2}
O\left(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
U(\cdot)
\ell_{\infty}
O\left(\frac{1}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
U(\cdot)
\mathcal{S}=\{S_{1},\ldots,S_{m}\}
\mathrm{Unif}(2^{N})
i
|\mathcal{S}_{\ni i}|\sim\mathrm{Bin}(m,0.5)
|\mathcal{S}_{\ni i}|=m-|\mathcal{S}_{\not\ni i}|
\displaystyle\widetilde{\phi}(i)=\frac{1}{m/2}\sum_{S\in\mathcal{S}_{\ni i}}U(%
S)-\frac{1}{m/2}\sum_{S\in\mathcal{S}_{\not\ni i}}U(S)
\displaystyle\widetilde{\phi}(i)=\frac{1}{m/2}\sum_{S\in\mathcal{S}_{\ni i}}U(%
S)-\frac{1}{m/2}\sum_{S\in\mathcal{S}_{\not\ni i}}U(S)
|\mathcal{S}_{\ni i}|
|\mathcal{S}_{\not\ni i}|
|\mathcal{S}_{\ni i}|
|\mathcal{S}_{\not\ni i}|>0
\displaystyle\left|\widehat{\phi}(i)-\widetilde{\phi}(i)\right|=\left|\left(%
\frac{1}{|\mathcal{S}_{\ni i}|}-\frac{1}{m/2}\right)\sum_{S\in\mathcal{S}_{\ni
i%
}}U(S)-\left(\frac{1}{|\mathcal{S}_{\not\ni i}|}-\frac{1}{m/2}\right)\sum_{S%
\in\mathcal{S}_{\not\ni i}}U(S)\right|
\displaystyle\left|\widehat{\phi}(i)-\widetilde{\phi}(i)\right|
\displaystyle=\left|\left(\frac{1}{|\mathcal{S}_{\ni i}|}-\frac{1}{m/2}\right)%
\sum_{S\in\mathcal{S}_{\ni i}}U(S)-\left(\frac{1}{|\mathcal{S}_{\not\ni i}|}-%
\frac{1}{m/2}\right)\sum_{S\in\mathcal{S}_{\not\ni i}}U(S)\right|
\displaystyle\leq\left|1-\frac{2|\mathcal{S}_{\ni i}|}{m}\right|+\left|1-\frac%
{2|\mathcal{S}_{\not\ni i}|}{m}\right|
\displaystyle\leq\left|1-\frac{2|\mathcal{S}_{\ni i}|}{m}\right|+\left|1-\frac%
{2|\mathcal{S}_{\not\ni i}|}{m}\right|
\displaystyle=2\left|1-\frac{2|\mathcal{S}_{\ni i}|}{m}\right|
\displaystyle=2\left|1-\frac{2|\mathcal{S}_{\ni i}|}{m}\right|
\displaystyle=\frac{4}{m}\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|
\displaystyle=\frac{4}{m}\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|
U(S)\leq 1
|\mathcal{S}_{\ni i}|=m-|\mathcal{S}_{\not\ni i}|
|\mathcal{S}_{\ni i}|
|\mathcal{S}_{\not\ni i}|=0
|\mathcal{S}_{\ni i}|\sim\mathrm{Bin}(m,0.5)
\displaystyle\Pr\left[\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\geq\Delta%
\right]\leq 2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\Pr\left[\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\geq\Delta%
\right]\leq 2\exp\left(-\frac{2\Delta^{2}}{m}\right)
1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\left|\widehat{\phi}(i)-\widetilde{\phi}(i)\right|\leq\frac{4%
\Delta}{m}
\displaystyle\left|\widehat{\phi}(i)-\widetilde{\phi}(i)\right|\leq\frac{4%
\Delta}{m}
\displaystyle\widetilde{\phi}(i)=\frac{2}{m}\left(\sum_{S\in\mathcal{S}_{\ni i%
}}U(S)-\sum_{S\in\mathcal{S}_{\not\ni i}}U(S)\right)
\displaystyle\widetilde{\phi}(i)
\displaystyle=\frac{2}{m}\left(\sum_{S\in\mathcal{S}_{\ni i}}U(S)-\sum_{S\in%
\mathcal{S}_{\not\ni i}}U(S)\right)
\displaystyle=\frac{1}{m}\sum_{S\in\mathcal{S}}2U(S)\mathrm{sign}(i,S)
\displaystyle=\frac{1}{m}\sum_{S\in\mathcal{S}}2U(S)\mathrm{sign}(i,S)
\mathrm{sign}(i,S)=2\bm{1}[i\in S]-1\in\{\pm 1\}
2U(S)\mathrm{sign}(i,S)\in[-2,2]
|\widetilde{\phi}(i)-\phi(i)|
\displaystyle\Pr\left[|\widetilde{\phi}(i)-\phi(i)|\geq t\right]\leq 2\exp%
\left(-\frac{mt^{2}}{8}\right)
\displaystyle\Pr\left[|\widetilde{\phi}(i)-\phi(i)|\geq t\right]\leq 2\exp%
\left(-\frac{mt^{2}}{8}\right)
|\widehat{\phi}(i)-\phi(i)|
\displaystyle\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon\right]
\displaystyle\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon\right]
\displaystyle=\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon|\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]\Pr\left[\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]
\displaystyle=\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon|\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]\Pr\left[\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]
\displaystyle~{}~{}~{}~{}+\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon|%
\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|>\Delta\right]\Pr\left[\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|>\Delta\right]
\displaystyle~{}~{}~{}~{}+\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon|%
\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|>\Delta\right]\Pr\left[\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|>\Delta\right]
\displaystyle\leq\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon|\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]+2\exp\left(-\frac{2%
\Delta^{2}}{m}\right)
\displaystyle\leq\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon|\left||%
\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]+2\exp\left(-\frac{2%
\Delta^{2}}{m}\right)
\displaystyle\leq\Pr\left[|\widetilde{\phi}(i)-\phi(i)|\geq\varepsilon-\frac{4%
\Delta}{m}|\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]+2%
\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\Pr\left[|\widetilde{\phi}(i)-\phi(i)|\geq\varepsilon-\frac{4%
\Delta}{m}|\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]+2%
\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[|\widetilde{\phi}(i)-\phi(i)|\geq\varepsilon-%
\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp%
\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[|\widetilde{\phi}(i)-\phi(i)|\geq\varepsilon-%
\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp%
\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{2\exp\left(-\frac{1}{8}m(\varepsilon-\frac{4\Delta}{m})%
^{2}\right)}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp\left(-\frac{2%
\Delta^{2}}{m}\right)
\displaystyle\leq\frac{2\exp\left(-\frac{1}{8}m(\varepsilon-\frac{4\Delta}{m})%
^{2}\right)}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp\left(-\frac{2%
\Delta^{2}}{m}\right)
\displaystyle\leq 3\exp\left(-\frac{1}{8}m\left(\varepsilon-\frac{4\Delta}{m}%
\right)^{2}\right)+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq 3\exp\left(-\frac{1}{8}m\left(\varepsilon-\frac{4\Delta}{m}%
\right)^{2}\right)+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)\geq\frac{2}{3}
-\frac{1}{8}m\left(\varepsilon-\frac{4\Delta}{m}\right)^{2}=-\frac{2\Delta^{2}%
}{m}
\Delta=\frac{m\varepsilon}{8}
\displaystyle\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon\right]\leq 3%
\exp\left(-\frac{1}{8}m\left(\varepsilon-\frac{4\Delta}{m}\right)^{2}\right)+2%
\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\Pr\left[|\widehat{\phi}(i)-\phi(i)|\geq\varepsilon\right]
\displaystyle\leq 3\exp\left(-\frac{1}{8}m\left(\varepsilon-\frac{4\Delta}{m}%
\right)^{2}\right)+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle=5\exp\left(-\frac{m\varepsilon^{2}}{32}\right)
\displaystyle=5\exp\left(-\frac{m\varepsilon^{2}}{32}\right)
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MSR}}}\left[\left\lVert\widehat{\phi%
}_{\mathrm{MSR}}-\phi\right\rVert_{2}\geq\varepsilon\right]\leq 5n\exp\left(-%
\frac{m\varepsilon^{2}}{32n}\right)
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MSR}}}\left[\left\lVert\widehat{\phi%
}_{\mathrm{MSR}}-\phi\right\rVert_{2}\geq\varepsilon\right]\leq 5n\exp\left(-%
\frac{m\varepsilon^{2}}{32n}\right)
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MSR}}}\left[\left\lVert\widehat{\phi%
}_{\mathrm{MSR}}-\phi\right\rVert_{\infty}\geq\varepsilon\right]\leq 5n\exp%
\left(-\frac{m\varepsilon^{2}}{32}\right)
\displaystyle\Pr_{\widehat{\phi}_{\mathrm{MSR}}}\left[\left\lVert\widehat{\phi%
}_{\mathrm{MSR}}-\phi\right\rVert_{\infty}\geq\varepsilon\right]\leq 5n\exp%
\left(-\frac{m\varepsilon^{2}}{32}\right)
\delta\leq 5n\exp\left(-\frac{m\varepsilon^{2}}{32n}\right)
O\left(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
\ell_{2}
\delta\leq 5n\exp\left(-\frac{m\varepsilon^{2}}{32}\right)
O\left(\frac{1}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
\ell_{\infty}
(\varepsilon,\delta)
\ell_{\infty}
\delta\in(0,1/2)
\Omega(\frac{1}{\varepsilon})
\varepsilon\in(0,1)
\mathcal{I}_{0}
U
U(S)=U(S\cup n)
S\subseteq[n-1]
\mathcal{I}_{1}
U
2^{n-1}(2\varepsilon)
S\subseteq[n-1]
U(S)=0,U(S\cup n)=1
S
U(S)=U(S\cup n)
\mathcal{I}_{0}\cup\mathcal{I}_{1}
\mathcal{I}_{0}
\mathcal{I}_{1}
U\in\mathcal{I}_{0}
\phi(n;U)=0
U\in\mathcal{I}_{1}
\phi(n;U)=\frac{2^{n-1}(2\varepsilon)}{2^{n-1}}=2\varepsilon
\left\lVert\widehat{\phi}-\phi\right\rVert_{\infty}<\varepsilon
\mathcal{I}_{0}
\mathcal{I}_{1}
S\subseteq[n-1]
U(S)=0,U(S\cup n)=1
S
2^{n-1}(2\varepsilon)/2^{n-1}=2\varepsilon
m
(1-2m\varepsilon)/2
\delta
m
(1-2m\varepsilon)/2\leq\delta
m\geq\frac{1-2\delta}{2\varepsilon}
m\in\Omega(\frac{1}{\varepsilon})
\displaystyle\phi_{\mathrm{semi}}\left(i;U,N,w\right):=\frac{1}{n}\sum_{k=1}^{%
n}w(k)\sum_{S\subseteq N\setminus i,|S|=k-1}\left[U(S\cup i)-U(S)\right]
\displaystyle\phi_{\mathrm{semi}}\left(i;U,N,w\right)
\displaystyle:=\frac{1}{n}\sum_{k=1}^{n}w(k)\sum_{S\subseteq N\setminus i,|S|=%
k-1}\left[U(S\cup i)-U(S)\right]
\displaystyle=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus i})}\left[\frac{2^{%
n-1}w(|S|+1)}{n}\left(U(S\cup i)-U(S)\right)\right]
\displaystyle=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus i})}\left[\frac{2^{%
n-1}w(|S|+1)}{n}\left(U(S\cup i)-U(S)\right)\right]
\displaystyle=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus i})}\left[\frac{2^{%
n-1}w(|S|+1)}{n}U(S\cup i)\right]-\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus
i%
})}\left[\frac{2^{n-1}w(|S|+1)}{n}U(S)\right]
\displaystyle=\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus i})}\left[\frac{2^{%
n-1}w(|S|+1)}{n}U(S\cup i)\right]-\mathbb{E}_{S\sim\mathrm{Unif}(2^{N\setminus
i%
})}\left[\frac{2^{n-1}w(|S|+1)}{n}U(S)\right]
\displaystyle=\mathbb{E}_{S\sim\mathrm{Unif}(\{S\in 2^{N}:S\ni i\})}\left[%
\frac{2^{n-1}w(|S|)}{n}U(S)\right]-\mathbb{E}_{S\sim\mathrm{Unif}(2^{N%
\setminus i})}\left[\frac{2^{n-1}w(|S|+1)}{n}U(S)\right]
\displaystyle=\mathbb{E}_{S\sim\mathrm{Unif}(\{S\in 2^{N}:S\ni i\})}\left[%
\frac{2^{n-1}w(|S|)}{n}U(S)\right]-\mathbb{E}_{S\sim\mathrm{Unif}(2^{N%
\setminus i})}\left[\frac{2^{n-1}w(|S|+1)}{n}U(S)\right]
\mathcal{S}=\{S_{1},\ldots,S_{m}\}
\mathrm{Unif}(2^{N})
\phi(i)
\displaystyle\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|}%
\sum_{S\in\mathcal{S}_{\ni i}}\frac{2^{n-1}w(|S|)}{n}U(S)-\frac{1}{|\mathcal{S%
}_{\not\ni i}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\frac{2^{n-1}w(|S|+1)}{n}U(S)
\displaystyle\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|}%
\sum_{S\in\mathcal{S}_{\ni i}}\frac{2^{n-1}w(|S|)}{n}U(S)-\frac{1}{|\mathcal{S%
}_{\not\ni i}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\frac{2^{n-1}w(|S|+1)}{n}U(S)
w(|S|)={n-1\choose|S|-1}^{-1}
\displaystyle\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|}%
\sum_{S\in\mathcal{S}_{\ni i}}\frac{1}{n}{n-1\choose|S|-1}^{-1}U(S)-\frac{1}{|%
\mathcal{S}_{\not\ni i}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\frac{1}{n}{n-1%
\choose|S|}^{-1}U(S)
\displaystyle\widehat{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|}%
\sum_{S\in\mathcal{S}_{\ni i}}\frac{1}{n}{n-1\choose|S|-1}^{-1}U(S)-\frac{1}{|%
\mathcal{S}_{\not\ni i}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\frac{1}{n}{n-1%
\choose|S|}^{-1}U(S)
n
\mathrm{Unif}(2^{N})
S\sim\mathrm{Unif}(2^{N})
S|S\not\ni i\sim\mathrm{Unif}(2^{N\setminus i})
S|S\ni i\sim\mathrm{Unif}(\{S\in 2^{N}:S\ni i\})
w
\mathcal{D}
2^{N}
\phi_{\mathrm{semi}}\left(i;U,N,w\right)=\mathbb{E}_{S\sim\mathcal{D}|\mathcal%
{D}\ni i}\left[U(S)\right]-\mathbb{E}_{S\sim\mathcal{D}|\mathcal{D}\not\ni i}%
\left[U(S)\right]
\phi_{\mathrm{semi}}\left(i;U,N,w\right)
\displaystyle\Pr[\mathcal{D}=S|i\in S]=\frac{1}{n}w(|S|+1)
\displaystyle\Pr[\mathcal{D}=S|i\in S]=\frac{1}{n}w(|S|+1)
\displaystyle\Pr[\mathcal{D}=S|i\notin S]=\frac{1}{n}w(|S|)
\displaystyle\Pr[\mathcal{D}=S|i\notin S]=\frac{1}{n}w(|S|)
i\in N
S
i\notin S,j\in S
x=\Pr[i\notin\mathcal{D}]
y=\Pr[j\notin\mathcal{D}]
k=|S|+1
\displaystyle\Pr[\mathcal{D}=S|i\notin S,j\in S]=\frac{\Pr[j\in\mathcal{D}|%
\mathcal{D}=S,i\notin\mathcal{D}]\Pr[\mathcal{D}=S|i\notin\mathcal{D}]}{\Pr[j%
\in\mathcal{D}]}
\displaystyle\Pr[\mathcal{D}=S|i\notin S,j\in S]
\displaystyle=\frac{\Pr[j\in\mathcal{D}|\mathcal{D}=S,i\notin\mathcal{D}]\Pr[%
\mathcal{D}=S|i\notin\mathcal{D}]}{\Pr[j\in\mathcal{D}]}
\displaystyle=\frac{w(k-1)}{n(1-y)}
\displaystyle=\frac{w(k-1)}{n(1-y)}
\displaystyle=\frac{\Pr[i\notin\mathcal{D}|\mathcal{D}=S,j\in\mathcal{D}]\Pr[%
\mathcal{D}=S|j\in\mathcal{D}]}{\Pr[i\notin\mathcal{D}]}
\displaystyle=\frac{\Pr[i\notin\mathcal{D}|\mathcal{D}=S,j\in\mathcal{D}]\Pr[%
\mathcal{D}=S|j\in\mathcal{D}]}{\Pr[i\notin\mathcal{D}]}
\displaystyle=\frac{w(k)}{nx}
\displaystyle=\frac{w(k)}{nx}
w(k-1)x=w(k)(1-y)
S^{\prime}
i\in S,j\notin S
w(k-1)y=w(k)(1-x)
\displaystyle w(k-1)x=w(k)(1-y)
\displaystyle w(k-1)x
\displaystyle=w(k)(1-y)
\displaystyle w(k-1)y=w(k)(1-x)
\displaystyle w(k-1)y
\displaystyle=w(k)(1-x)
x=y
x=\frac{w(k-1)}{w(k-1)+w(k)}
k
w(1),w(2),\ldots,w(n)
w(k-1)+w(k)
k
x
x\neq y
w(k-1)(x-y)=w(k)(x-y)
w(k-1)=w(k)
U
\widehat{U}
\displaystyle\widetilde{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|%
}\sum_{S\in\mathcal{S}_{\ni i}}\widehat{U}(S)-\frac{1}{|\mathcal{S}_{\not\ni i%
}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\widehat{U}(S).
\displaystyle\widetilde{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|%
}\sum_{S\in\mathcal{S}_{\ni i}}\widehat{U}(S)-\frac{1}{|\mathcal{S}_{\not\ni i%
}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\widehat{U}(S).
\|U-\widehat{U}\|_{2}\leq\gamma
\widetilde{\phi}_{\mathrm{MSR}}
(\varepsilon+\frac{\gamma\sqrt{n}}{2^{n/2-1}},\delta)
\ell_{2}
O(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta}))
(\varepsilon+\frac{\gamma}{2^{n/2-1}},\delta)
\ell_{\infty}
O(\frac{1}{\varepsilon^{2}}\log(\frac{n}{\delta}))
\widehat{U}
\widehat{U}
\gamma\propto\sqrt{2^{n}}
\displaystyle\widetilde{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|%
}\sum_{S\in\mathcal{S}_{\ni i}}\widehat{U}(S)-\frac{1}{|\mathcal{S}_{\not\ni i%
}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\widehat{U}(S)
\displaystyle\widetilde{\phi}_{\mathrm{MSR}}(i)=\frac{1}{|\mathcal{S}_{\ni i}|%
}\sum_{S\in\mathcal{S}_{\ni i}}\widehat{U}(S)-\frac{1}{|\mathcal{S}_{\not\ni i%
}|}\sum_{S\in\mathcal{S}_{\not\ni i}}\widehat{U}(S)
\|U-\widehat{U}\|_{2}\leq\gamma
\widetilde{\phi}_{\mathrm{MSR}}
(\varepsilon+\frac{\gamma\sqrt{n}}{2^{n/2-1}},\delta)
\ell_{2}
O(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta}))
(\varepsilon+\frac{\gamma}{2^{n/2-1}},\delta)
\ell_{\infty}
O(\frac{1}{\varepsilon^{2}}\log(\frac{n}{\delta}))
\widehat{U}
i\in N
\displaystyle\left|\widetilde{\phi}(i)-\phi(i)\right|\leq\left|\widetilde{\phi%
}(i)-\widehat{\phi}(i)\right|+\left|\widehat{\phi}(i)-\phi(i)\right|
\displaystyle\left|\widetilde{\phi}(i)-\phi(i)\right|\leq\left|\widetilde{\phi%
}(i)-\widehat{\phi}(i)\right|+\left|\widehat{\phi}(i)-\phi(i)\right|
\displaystyle\Pr_{\widehat{\phi}}\left[\left|\widehat{\phi}(i)-\phi(i)\right|%
\geq\Delta\right]\leq 5\exp\left(-\frac{m}{32}\Delta^{2}\right)
\displaystyle\Pr_{\widehat{\phi}}\left[\left|\widehat{\phi}(i)-\phi(i)\right|%
\geq\Delta\right]\leq 5\exp\left(-\frac{m}{32}\Delta^{2}\right)
\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|
\displaystyle\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|=\left|\frac{1}%
{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}_{\ni i}}\left(U(S)-\widehat{U}(S)%
\right)-\frac{1}{|\mathcal{S}_{\not\ni i}|}\sum_{S\in\mathcal{S}_{\not\ni i}}%
\left(U(S)-\widehat{U}(S)\right)\right|
\displaystyle\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|
\displaystyle=\left|\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}_{\ni i%
}}\left(U(S)-\widehat{U}(S)\right)-\frac{1}{|\mathcal{S}_{\not\ni i}|}\sum_{S%
\in\mathcal{S}_{\not\ni i}}\left(U(S)-\widehat{U}(S)\right)\right|
\displaystyle\leq\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}_{\ni i}}%
\left|U(S)-\widehat{U}(S)\right|+\frac{1}{|\mathcal{S}_{\not\ni i}|}\sum_{S\in%
\mathcal{S}_{\not\ni i}}\left|U(S)-\widehat{U}(S)\right|
\displaystyle\leq\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}_{\ni i}}%
\left|U(S)-\widehat{U}(S)\right|+\frac{1}{|\mathcal{S}_{\not\ni i}|}\sum_{S\in%
\mathcal{S}_{\not\ni i}}\left|U(S)-\widehat{U}(S)\right|
\left\lVert U-\widehat{U}\right\rVert\leq\gamma
\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|
\displaystyle\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|\geq%
\varepsilon\right]
\displaystyle\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|\geq%
\varepsilon\right]
\displaystyle\leq\Pr\left[\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}%
_{\ni i}}\left|U(S)-\widehat{U}(S)\right|+\frac{1}{|\mathcal{S}_{\not\ni i}|}%
\sum_{S\in\mathcal{S}_{\not\ni i}}\left|U(S)-\widehat{U}(S)\right|\geq%
\varepsilon\right]
\displaystyle\leq\Pr\left[\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}%
_{\ni i}}\left|U(S)-\widehat{U}(S)\right|+\frac{1}{|\mathcal{S}_{\not\ni i}|}%
\sum_{S\in\mathcal{S}_{\not\ni i}}\left|U(S)-\widehat{U}(S)\right|\geq%
\varepsilon\right]
\displaystyle\leq\Pr\left[\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}%
_{\ni i}}\left|U(S)-\widehat{U}(S)\right|+\frac{1}{|\mathcal{S}_{\not\ni i}|}%
\sum_{S\in\mathcal{S}_{\not\ni i}}\left|U(S)-\widehat{U}(S)\right|\geq%
\varepsilon|\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]+2%
\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\Pr\left[\frac{1}{|\mathcal{S}_{\ni i}|}\sum_{S\in\mathcal{S}%
_{\ni i}}\left|U(S)-\widehat{U}(S)\right|+\frac{1}{|\mathcal{S}_{\not\ni i}|}%
\sum_{S\in\mathcal{S}_{\not\ni i}}\left|U(S)-\widehat{U}(S)\right|\geq%
\varepsilon|\left||\mathcal{S}_{\ni i}|-\frac{m}{2}\right|\leq\Delta\right]+2%
\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[\frac{2}{m}\sum_{S\subseteq\mathcal{S}}\left|U%
(S)-\widehat{U}(S)\right|\geq\varepsilon-\frac{4\Delta}{m}\right]}{1-2\exp%
\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[\frac{2}{m}\sum_{S\subseteq\mathcal{S}}\left|U%
(S)-\widehat{U}(S)\right|\geq\varepsilon-\frac{4\Delta}{m}\right]}{1-2\exp%
\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\left\lVert U-\widehat{U}\right\rVert\leq\gamma
\displaystyle\mathbb{E}[|U(S)-\widehat{U}(S)|]=\frac{1}{2^{n}}\sum_{S\subseteq
N%
}\left|U(S)-\widehat{U}(S)\right|=\frac{1}{2^{n}}\left\lVert U-\widehat{U}%
\right\rVert_{1}\leq\frac{\sqrt{2^{n}}}{2^{n}}\left\lVert U-\widehat{U}\right%
\rVert=\frac{\gamma}{2^{n/2}}
\displaystyle\mathbb{E}[|U(S)-\widehat{U}(S)|]=\frac{1}{2^{n}}\sum_{S\subseteq
N%
}\left|U(S)-\widehat{U}(S)\right|=\frac{1}{2^{n}}\left\lVert U-\widehat{U}%
\right\rVert_{1}\leq\frac{\sqrt{2^{n}}}{2^{n}}\left\lVert U-\widehat{U}\right%
\rVert=\frac{\gamma}{2^{n/2}}
\varepsilon^{\prime}=\varepsilon-\frac{\gamma}{2^{n/2-1}}
\displaystyle(\ref{eq:cont})=\frac{\Pr\left[\frac{2}{m}\sum_{S\subseteq%
\mathcal{S}}\left|U(S)-\widehat{U}(S)\right|-\frac{\gamma}{2^{n/2-1}}\geq%
\varepsilon^{\prime}-\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}%
}{m}\right)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle(\ref{eq:cont})
\displaystyle=\frac{\Pr\left[\frac{2}{m}\sum_{S\subseteq\mathcal{S}}\left|U(S)%
-\widehat{U}(S)\right|-\frac{\gamma}{2^{n/2-1}}\geq\varepsilon^{\prime}-\frac{%
4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+2\exp\left(-%
\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[\frac{2}{m}\sum_{S\subseteq\mathcal{S}}\left|U%
(S)-\widehat{U}(S)\right|-2\mathbb{E}[|U(S)-\widehat{U}(S)|]\geq\varepsilon^{%
\prime}-\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+%
2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[\frac{2}{m}\sum_{S\subseteq\mathcal{S}}\left|U%
(S)-\widehat{U}(S)\right|-2\mathbb{E}[|U(S)-\widehat{U}(S)|]\geq\varepsilon^{%
\prime}-\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right)}+%
2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[\left|\frac{2}{m}\sum_{S\subseteq\mathcal{S}}%
\left|U(S)-\widehat{U}(S)\right|-\frac{\gamma}{2^{n/2-1}}\right|\geq%
\varepsilon^{\prime}-\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}%
}{m}\right)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{\Pr\left[\left|\frac{2}{m}\sum_{S\subseteq\mathcal{S}}%
\left|U(S)-\widehat{U}(S)\right|-\frac{\gamma}{2^{n/2-1}}\right|\geq%
\varepsilon^{\prime}-\frac{4\Delta}{m}\right]}{1-2\exp\left(-\frac{2\Delta^{2}%
}{m}\right)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{2\exp\left(-\frac{1}{8}m\left(\varepsilon^{\prime}-%
\frac{4\Delta}{m}\right)^{2}\right)}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right%
)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq\frac{2\exp\left(-\frac{1}{8}m\left(\varepsilon^{\prime}-%
\frac{4\Delta}{m}\right)^{2}\right)}{1-2\exp\left(-\frac{2\Delta^{2}}{m}\right%
)}+2\exp\left(-\frac{2\Delta^{2}}{m}\right)
\displaystyle\leq 5\exp\left(-\frac{m}{32}(\varepsilon^{\prime})^{2}\right)
\displaystyle\leq 5\exp\left(-\frac{m}{32}(\varepsilon^{\prime})^{2}\right)
\displaystyle\Pr_{\widehat{\phi}}\left[\left|\widehat{\phi}(i)-\widetilde{\phi%
}(i)\right|\geq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]\leq 5\exp\left(-%
\frac{m}{32}\varepsilon^{2}\right)
\displaystyle\Pr_{\widehat{\phi}}\left[\left|\widehat{\phi}(i)-\widetilde{\phi%
}(i)\right|\geq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]\leq 5\exp\left(-%
\frac{m}{32}\varepsilon^{2}\right)
\displaystyle\Pr\left[\left|\widetilde{\phi}(i)-\phi(i)\right|\geq\varepsilon+%
\frac{\gamma}{2^{n/2-1}}\right]\leq\Pr\left[\left|\widetilde{\phi}(i)-\widehat%
{\phi}(i)\right|+\left|\widehat{\phi}(i)-\phi(i)\right|\geq\varepsilon+\frac{%
\gamma}{2^{n/2-1}}\right]
\displaystyle\Pr\left[\left|\widetilde{\phi}(i)-\phi(i)\right|\geq\varepsilon+%
\frac{\gamma}{2^{n/2-1}}\right]
\displaystyle\leq\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|+%
\left|\widehat{\phi}(i)-\phi(i)\right|\geq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]
\displaystyle=1-\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|+%
\left|\widehat{\phi}(i)-\phi(i)\right|\leq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]
\displaystyle=1-\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|+%
\left|\widehat{\phi}(i)-\phi(i)\right|\leq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]
\displaystyle\leq 1-\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right%
|\leq\frac{\varepsilon}{2}+\frac{\gamma}{2^{n/2-1}}\land\left|\widehat{\phi}(i%
)-\phi(i)\right|\leq\frac{\varepsilon}{2}\right]
\displaystyle\leq 1-\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right%
|\leq\frac{\varepsilon}{2}+\frac{\gamma}{2^{n/2-1}}\land\left|\widehat{\phi}(i%
)-\phi(i)\right|\leq\frac{\varepsilon}{2}\right]
\displaystyle\leq\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|%
\geq\frac{\varepsilon}{2}+\frac{\gamma}{2^{n/2-1}}\right]+\Pr\left[\left|%
\widehat{\phi}(i)-\phi(i)\right|\geq\frac{\varepsilon}{2}\right]
\displaystyle\leq\Pr\left[\left|\widetilde{\phi}(i)-\widehat{\phi}(i)\right|%
\geq\frac{\varepsilon}{2}+\frac{\gamma}{2^{n/2-1}}\right]+\Pr\left[\left|%
\widehat{\phi}(i)-\phi(i)\right|\geq\frac{\varepsilon}{2}\right]
\displaystyle=10\exp\left(-\frac{m}{128}\varepsilon^{2}\right)
\displaystyle=10\exp\left(-\frac{m}{128}\varepsilon^{2}\right)
\displaystyle\Pr\left[\left\lVert\widetilde{\phi}_{\mathrm{MSR}}-\phi\right%
\rVert_{2}\geq\varepsilon+\frac{\gamma\sqrt{n}}{2^{n/2-1}}\right]\leq 10n\exp%
\left(-\frac{m\varepsilon^{2}}{128n}\right)
\displaystyle\Pr\left[\left\lVert\widetilde{\phi}_{\mathrm{MSR}}-\phi\right%
\rVert_{2}\geq\varepsilon+\frac{\gamma\sqrt{n}}{2^{n/2-1}}\right]\leq 10n\exp%
\left(-\frac{m\varepsilon^{2}}{128n}\right)
\displaystyle\Pr\left[\left\lVert\widetilde{\phi}_{\mathrm{MSR}}-\phi\right%
\rVert_{\infty}\geq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]\leq 10n\exp%
\left(-\frac{m\varepsilon^{2}}{128}\right)
\displaystyle\Pr\left[\left\lVert\widetilde{\phi}_{\mathrm{MSR}}-\phi\right%
\rVert_{\infty}\geq\varepsilon+\frac{\gamma}{2^{n/2-1}}\right]\leq 10n\exp%
\left(-\frac{m\varepsilon^{2}}{128}\right)
\delta\leq 10n\exp\left(-\frac{m\varepsilon^{2}}{128n}\right)
O\left(\frac{n}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
\ell_{2}
\delta\leq 10n\exp\left(-\frac{m\varepsilon^{2}}{128}\right)
O\left(\frac{1}{\varepsilon^{2}}\log(\frac{n}{\delta})\right)
\ell_{\infty}
\ell_{2}
\phi:\mathbb{R}^{2^{n}}\rightarrow\mathbb{R}^{n}
U\in\mathbb{R}^{2^{n}}
\phi(U)\in\mathbb{R}^{n}
\phi(\cdot;w)
L
\displaystyle\left\lVert\phi(U;w)-\phi(\widehat{U};w)\right\rVert\leq L\left%
\lVert U-\widehat{U}\right\rVert
\displaystyle\left\lVert\phi(U;w)-\phi(\widehat{U};w)\right\rVert\leq L\left%
\lVert U-\widehat{U}\right\rVert
U
\widehat{U}
w(k)=\frac{n}{2^{n-1}}
L=\frac{1}{2^{n/2-1}}
\displaystyle\left\lVert\phi_{\mathrm{banz}}(U)-\phi_{\mathrm{banz}}(\widehat{%
U};w)\right\rVert\leq\frac{1}{2^{n/2-1}}\left\lVert U-\widehat{U}\right\rVert
\displaystyle\left\lVert\phi_{\mathrm{banz}}(U)-\phi_{\mathrm{banz}}(\widehat{%
U};w)\right\rVert\leq\frac{1}{2^{n/2-1}}\left\lVert U-\widehat{U}\right\rVert
U
\widehat{U}
L=\frac{1}{2^{n/2-1}}
\displaystyle\phi_{\mathrm{semi}}\left(i;U,w\right):=\frac{1}{n}\sum_{k=1}^{n}%
w(k)\sum_{S\subseteq N\setminus\{i\},|S|=k-1}\left[U(S\cup i)-U(S)\right]
\displaystyle\phi_{\mathrm{semi}}\left(i;U,w\right)
\displaystyle:=\frac{1}{n}\sum_{k=1}^{n}w(k)\sum_{S\subseteq N\setminus\{i\},|%
S|=k-1}\left[U(S\cup i)-U(S)\right]
\phi:\mathbb{R}^{2^{n}}\rightarrow\mathbb{R}^{n}
S_{n}\in\mathbb{R}^{n\times 2^{n}}
\phi(U)=S_{n}U
i
S_{n}
(S_{n})_{i}
i
S
(S_{n})_{i,S}
\displaystyle(S_{n})_{i,S}=\frac{1}{n}w(|S|)\text{ if }i\in S
\displaystyle(S_{n})_{i,S}
\displaystyle=\frac{1}{n}w(|S|)\text{ if }i\in S
\displaystyle(S_{n})_{i,S}=-\frac{1}{n}w(|S|+1)\text{ if }i\notin S
\displaystyle(S_{n})_{i,S}
\displaystyle=-\frac{1}{n}w(|S|+1)\text{ if }i\notin S
\phi
S_{n}
S_{n}S_{n}^{T}
S_{n}S_{n}^{T}
S_{n}S_{n}^{T}
\displaystyle d_{1}=\sum_{S\in 2^{n},i\in S}\frac{1}{n^{2}}w^{2}(|S|)+\sum_{S%
\in 2^{n},i\notin S}\frac{1}{n^{2}}w^{2}(|S|+1)
\displaystyle d_{1}
\displaystyle=\sum_{S\in 2^{n},i\in S}\frac{1}{n^{2}}w^{2}(|S|)+\sum_{S\in 2^{%
n},i\notin S}\frac{1}{n^{2}}w^{2}(|S|+1)
\displaystyle=\frac{1}{n^{2}}\left[\sum_{k=1}^{n}{n-1\choose k-1}w^{2}(k)+\sum%
_{k=1}^{n}{n-1\choose k-1}w^{2}(k)\right]
\displaystyle=\frac{1}{n^{2}}\left[\sum_{k=1}^{n}{n-1\choose k-1}w^{2}(k)+\sum%
_{k=1}^{n}{n-1\choose k-1}w^{2}(k)\right]
\displaystyle=\frac{2}{n^{2}}\sum_{k=1}^{n}{n-1\choose k-1}w^{2}(k)
\displaystyle=\frac{2}{n^{2}}\sum_{k=1}^{n}{n-1\choose k-1}w^{2}(k)
\displaystyle d_{2}=\sum_{k=2}^{n}{n-2\choose k-2}\left(\frac{1}{n}w(k)\right)%
^{2}+2\sum_{k=1}^{n-1}{n-2\choose k-1}\left(-\frac{1}{n^{2}}w(k)w(k+1)\right)+%
\sum_{k=0}^{n-2}{n-2\choose k}\left(\frac{1}{n}w(k+1)\right)^{2}
\displaystyle d_{2}
\displaystyle=\sum_{k=2}^{n}{n-2\choose k-2}\left(\frac{1}{n}w(k)\right)^{2}+2%
\sum_{k=1}^{n-1}{n-2\choose k-1}\left(-\frac{1}{n^{2}}w(k)w(k+1)\right)+\sum_{%
k=0}^{n-2}{n-2\choose k}\left(\frac{1}{n}w(k+1)\right)^{2}
\displaystyle=\frac{1}{n^{2}}\sum_{k=0}^{n-2}{n-2\choose k}\left[w^{2}(k+2)-2w%
(k+1)w(k+2)+w^{2}(k+1)\right]
\displaystyle=\frac{1}{n^{2}}\sum_{k=0}^{n-2}{n-2\choose k}\left[w^{2}(k+2)-2w%
(k+1)w(k+2)+w^{2}(k+1)\right]
\displaystyle=\frac{1}{n^{2}}\sum_{k=0}^{n-2}{n-2\choose k}\left(w(k+2)-w(k+1)%
\right)^{2}
\displaystyle=\frac{1}{n^{2}}\sum_{k=0}^{n-2}{n-2\choose k}\left(w(k+2)-w(k+1)%
\right)^{2}
S_{n}S_{n}^{T}=(d_{1}-d_{2})\mathds{1}_{n}+d_{2}\mathbf{1}_{n}
\mathds{1}_{n}\in\mathbb{R}^{n\times n}
\mathbf{1}_{n}\in\mathbb{R}^{n}
d_{1}+(n-1)d_{2}
d_{1}-d_{2}
d_{2}\geq 0
d_{1}+(n-1)d_{2}
w
\displaystyle\min_{w}d_{1}+(n-1)d_{2}
\displaystyle\min_{w}d_{1}+(n-1)d_{2}
\displaystyle\text{subject to }\sum_{k=1}^{n}{n-1\choose k-1}w(k)=n
\displaystyle\text{subject to }\sum_{k=1}^{n}{n-1\choose k-1}w(k)=n
\displaystyle\min_{w}\frac{2}{n^{2}}\sum_{k=1}^{n}{n-1\choose k-1}w(k)^{2}+%
\frac{n-1}{n^{2}}\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)-w(k+1)\right)^{2}
\displaystyle\min_{w}\frac{2}{n^{2}}\sum_{k=1}^{n}{n-1\choose k-1}w(k)^{2}+%
\frac{n-1}{n^{2}}\sum_{k=1}^{n-1}{n-2\choose k-1}\left(w(k)-w(k+1)\right)^{2}
\displaystyle\text{subject to }\sum_{k=1}^{n}{n-1\choose k-1}w(k)=n
\displaystyle\text{subject to }\sum_{k=1}^{n}{n-1\choose k-1}w(k)=n
\displaystyle n^{2}=\left(\sum_{k=1}^{n}{n-1\choose k-1}w(k)\right)^{2}
\displaystyle n^{2}
\displaystyle=\left(\sum_{k=1}^{n}{n-1\choose k-1}w(k)\right)^{2}
\displaystyle=\left(\sum_{k=1}^{n}\sqrt{{n-1\choose k-1}}\sqrt{{n-1\choose k-1%
}}w(k)\right)^{2}
\displaystyle=\left(\sum_{k=1}^{n}\sqrt{{n-1\choose k-1}}\sqrt{{n-1\choose k-1%
}}w(k)\right)^{2}
\displaystyle\leq\left(\sum_{k=1}^{n}{n-1\choose k-1}\right)\left(\sum_{k=1}^{%
n}{n-1\choose k-1}w(k)^{2}\right)
\displaystyle\leq\left(\sum_{k=1}^{n}{n-1\choose k-1}\right)\left(\sum_{k=1}^{%
n}{n-1\choose k-1}w(k)^{2}\right)
\displaystyle=2^{n-1}\sum_{k=1}^{n}{n-1\choose k-1}w(k)^{2}
\displaystyle=2^{n-1}\sum_{k=1}^{n}{n-1\choose k-1}w(k)^{2}
\frac{2}{2^{n-1}}
w(1)=\ldots=w(n)=\frac{n}{2^{n-1}}
\min_{w}=d_{1}+(n-1)d_{2}=\frac{1}{2^{n-2}}
S_{n}=\sqrt{\frac{1}{2^{n-2}}}=\frac{1}{2^{n/2-1}}
S
U(S)
32
10^{-3}
k\%
0.1
-0.1
32
10^{-3}
\mathds{1}[y=1]
128
10^{-3}
128
10^{-3}
10^{-2}
128
32
>500
>500
[0,1]
\frac{\texttt{value}-\texttt{min}}{\texttt{max}-\texttt{min}}
\phi(i)
i
f_{\phi}
\displaystyle f_{\phi}:=\operatorname*{\arg\!\min}_{f}\sum_{i\in N}\phi(i)%
\mathrm{loss}_{f}(i)
\displaystyle f_{\phi}:=\operatorname*{\arg\!\min}_{f}\sum_{i\in N}\phi(i)%
\mathrm{loss}_{f}(i)
\mathrm{loss}_{f}(i)
f
i\in N
k
m
S_{1}
S_{m}
S_{i}
\widehat{U}(S_{i})
k
k
u_{1},\ldots,u_{k}\sim\widehat{U}(S_{i})
\widetilde{U}_{k}(S_{i})=\frac{1}{k}\sum_{j=1}^{k}u_{j}
\widetilde{U}_{k}(S_{1}),\ldots,\widetilde{U}_{k}(S_{m})
k
k
k=50
k
\widehat{U}_{k}(S_{i})
m=2000
k
k
10
\sigma
\mathcal{N}(0,\sigma\textbf{I})
\widehat{U}=U+\mathcal{N}(0,\sigma\textbf{I})
U
\widehat{U}
\bullet
\leq 15
\bullet
\mathrm{loss}(\theta,N)=\sum_{i\in N}\mathrm{loss}(\theta,i)
\theta
N
t
\displaystyle\theta_{t+1}=\theta_{t}-\eta\nabla\mathrm{loss}(\theta_{t},N)
\displaystyle\theta_{t+1}=\theta_{t}-\eta\nabla\mathrm{loss}(\theta_{t},N)
\nabla
\theta
\displaystyle\theta_{t+1}=\theta_{t}-\eta\frac{1}{\ell}\sum_{j=1}^{\ell}\nabla%
\mathrm{loss}(\theta_{t}+\alpha\mathcal{N}(0,\textbf{I}),N)
\displaystyle\theta_{t+1}=\theta_{t}-\eta\frac{1}{\ell}\sum_{j=1}^{\ell}\nabla%
\mathrm{loss}(\theta_{t}+\alpha\mathcal{N}(0,\textbf{I}),N)
\ell=1
\alpha
