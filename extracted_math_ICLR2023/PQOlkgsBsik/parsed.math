\mathcal{T}=\{T_{1},...,T_{n}\}
q
\mathcal{I}=\{I_{1},...,I_{m}\}
I_{j}
T_{i}
I_{j}
\mathcal{I}=\{I_{1},...,I_{m}\}
\mathcal{T}=\{T_{1},...,T_{n}\}
q
\mathcal{D}=\{T_{1},...,T_{n},I_{1},...,I_{m}\}
\mathcal{D}
q
q
\mathcal{D}=\{d^{\,1}_{\,\text{Text}},...,d^{\,n}_{\,\text{Text}},d^{\,1}_{\,%
\text{Image}},...,d^{\,m}_{\,\text{Image}}\}
q
d^{\,i}_{\,\text{Text}}
d^{\,j}_{\,\text{Image}}
d^{\,j}_{\,\text{Image}}
I_{j}
C_{j}
I_{j}
C_{j}
q
\vec{q}
\small\vec{q}=TextEnocder(q).
i
d^{\,i}_{\,\text{Text}}
\vec{d}^{\,i}_{\,\text{Text}}
\small\vec{d}^{\,i}_{\,\text{Text}}=TextEnocder(d^{\,i}_{\,\text{Text}}).
I_{j}
C_{j}
\vec{d}^{\,j}_{\,\text{Image}}
j
\small\vec{d}^{\,j}_{\,\text{Image}}=ImgEnocder(I_{j})+TextEnocder(C_{j}).
\vec{d}^{\,j}_{\,\text{Image}}
\vec{d}^{\,i}_{\,\text{Text}}
TextEnocder
f(q,d)
q
d\in\mathcal{D}
q
d
\small f(q,d)=\cos(\vec{q},\vec{d}\,),
\vec{q}
\vec{d}
q
d
q
d^{+}\in\mathcal{D}
\mathcal{D}^{-}
L
\small\begin{split}L&=-\log\frac{e^{f(q,d^{+})/\tau}}{e^{f(q,d^{+})/\tau}+\sum%
_{d^{-}\in\mathcal{D}^{-}}{e^{f(q,d^{-})/\tau}}}\\
&=-\underbrace{f(q,d^{+})/\tau}_{L_{\text{Align}}}+\log(e^{f(q,d^{+})/\tau}+%
\underbrace{\sum_{i=1}^{k_{1}}{e^{f(q,d_{\,\text{Image}}^{i-})/\tau}}}_{L_{%
\text{Image}}}+\underbrace{\sum_{j=1}^{k_{2}}{e^{f(q,d_{\,\text{Text}}^{j-})/%
\tau}}}_{L_{\text{Text}}}),\end{split}
\tau
L_{\text{Align}}
L_{\text{Image}}
L_{\text{Text}}
k_{1}>k_{2}
k_{2}>k_{1}
L_{\text{Image}}+L_{\text{Text}}
L
k_{1}=k_{2}=k
I_{j}
\mathcal{O}=\{O_{1},...,O_{l}\}
O_{i}
\vec{O}_{i}
\hat{O}_{i}
V(I_{j})
I_{j}
d^{\,j}_{\,\text{Image}}=\{I_{j},C_{j}\}
\{\hat{O}_{1};...;\hat{O}_{l}\}
\{\vec{O}_{1};...;\vec{O}_{l}\}
C_{j}
\small X_{j}^{c}=\text{[CLS]};C_{j};\text{[SEP]};\hat{O}_{1};...;\hat{O}_{l};%
\text{[SEP]};\vec{O}_{1};...;\vec{O}_{l};
\{\vec{O}_{1};...;\vec{O}_{l}\}
X_{j}^{c}
C_{j}
q
d^{\,j}_{\,\text{Image}}
\small X_{j}^{q}=\text{[CLS]};q;\text{[SEP]};C_{j};\text{[SEP]};\vec{O}_{1};..%
.;\vec{O}_{l},
C_{j}
q
X_{j}^{c}
X_{j}^{q}
C^{*}_{j}
C_{j}
V(I_{j})
\small C^{*}_{j}=C_{j};\text{[SEP]};V(I_{j}),
C^{*}_{j}
C_{j}
d^{\,j}_{\,\text{Image}}
K
K
K
5e-6
\tau=0.01
k=1
2e-5
5e-6
\tau=0.01
5e-5
+\infty
+\infty
