0\%
60\%
10\%
\theta
\{0,0.05,0.1,0.2,0.4,0.6,0.8,1.0\}
\theta
0
\bar{X}\in\bar{\mathcal{X}}:=\mathbb{R}^{d}
Y\in[r]:=\{1,\ldots,r\}
\{(\bar{x}_{i},y_{i})\}_{i\in[N]}
\mathrm{P}(\bar{X},Y)
\bar{x}\in\bar{\mathcal{X}}
\mathcal{A}(\cdot|\bar{x})
\mathcal{X}
n=|\mathcal{X}|
\mathcal{G}
w_{xx^{\prime}}:=\mathbb{E}_{\bar{x}\sim\bar{\mathcal{P}}}[\mathcal{A}(x|\bar{%
x})\mathcal{A}(x^{\prime}|\bar{x})]
x
x^{\prime}
\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}=1
\boldsymbol{A}:=(w_{xx^{\prime}})_{x,x^{\prime}\in\mathcal{X}}\in\mathbb{R}^{n%
\times n}
\bar{\boldsymbol{A}}:=D^{-1/2}\boldsymbol{A}D^{-1/2}
D:=\mathrm{diag}(w_{x})_{x\in\mathcal{X}}
w_{x}:=\sum_{x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}
\mathcal{L}(f)
f:\mathcal{X}\to\mathbb{R}^{k}
\displaystyle-2\cdot\mathbb{E}_{x,x^{+}}[f(x)^{\top}f(x^{+})]+\mathbb{E}_{x,x^%
{\prime}}\Big{[}\big{(}f(x)^{\top}f(x^{\prime})\big{)}^{2}\Big{]}.
\displaystyle-2\cdot\mathbb{E}_{x,x^{+}}[f(x)^{\top}f(x^{+})]+\mathbb{E}_{x,x^%
{\prime}}\Big{[}\big{(}f(x)^{\top}f(x^{\prime})\big{)}^{2}\Big{]}.
F\in\mathbb{R}^{n\times k}:=(u_{x})_{x\in\mathcal{X}}
u_{x}:=w_{x}^{1/2}f(x)
\displaystyle\mathcal{L}_{\mathrm{mf}}(F):=\|\bar{\boldsymbol{A}}-FF^{\top}\|_%
{F}^{2}=\mathcal{L}(f)+const.
\displaystyle\mathcal{L}_{\mathrm{mf}}(F):=\|\bar{\boldsymbol{A}}-FF^{\top}\|_%
{F}^{2}=\mathcal{L}(f)+const.
x\in\mathcal{X}
y
\tilde{y}
\boldsymbol{Y}:=(\eta_{j}(x_{i}))_{i\in[n],j\in[r]}
\eta_{j}(x)=\mathrm{P}(Y=j|x)
\tilde{\boldsymbol{Y}}:=(\tilde{\eta}_{j}(x_{i}))_{i\in[n],j\in[r]}
\tilde{\eta}_{j}(x)=\mathrm{P}(\tilde{Y}=j|x)
\gamma\in(0,1)
\boldsymbol{T}=(t_{i,j})_{i\in[r],j\in[r]}
\displaystyle t_{i,i}=1-\gamma,\text{ and }t_{i,j}=\frac{\gamma}{r-1},\text{ %
for }j\neq i.
\displaystyle t_{i,i}=1-\gamma,\text{ and }t_{i,j}=\frac{\gamma}{r-1},\text{ %
for }j\neq i.
\displaystyle\tilde{\boldsymbol{Y}}=\boldsymbol{Y}\boldsymbol{T}.
\displaystyle\tilde{\boldsymbol{Y}}=\boldsymbol{Y}\boldsymbol{T}.
\boldsymbol{T}
\gamma=0
\boldsymbol{T}
\boldsymbol{I}_{r\times r}
\gamma<\frac{r-1}{r}
j\in[r]
n_{j}
j
n_{L}=\sum_{j\in[r]}n_{L,j}
n_{U}
n_{L}+n_{U}=n
n_{L}\ll n_{U}
(x_{1},\ldots,x_{n_{L}})
\gamma\in[0,\frac{r-1}{r})
\boldsymbol{Y}_{L}
\tilde{\boldsymbol{Y}}_{L}
\tilde{\boldsymbol{Y}}_{L}=\boldsymbol{Y}_{L}\boldsymbol{T}
\gamma=0
n_{L}=n
\gamma=0
x
y
\eta_{y}(x)=1
\eta_{j}(x)=0
j\neq y
w_{xx^{\prime}}=1
x
x^{\prime}
w_{xx^{\prime}}=0
w_{xx^{\prime}}
\mathcal{G}
x
x^{\prime}
w_{xx^{\prime}}
w_{xx^{\prime}}
x
x^{\prime}
w_{xx^{\prime}}=\sum_{j\in[r]}\eta_{j}(x)\eta_{j}(x^{\prime})
\boldsymbol{A}_{L}:=\boldsymbol{Y}_{L}\boldsymbol{Y}_{L}^{\top}
\bar{\boldsymbol{A}}
n_{1}=\ldots=n_{r}=n_{L}/r
\bar{\boldsymbol{A}}=\frac{r}{n_{L}}\boldsymbol{A}
\tilde{\boldsymbol{Y}}_{L}=\boldsymbol{Y}_{L}\boldsymbol{T}
\boldsymbol{T}
\displaystyle\boldsymbol{A}^{\star}_{L}:=\tilde{\boldsymbol{Y}}_{L}\tilde{%
\boldsymbol{Y}}_{L}^{\top}=\boldsymbol{Y}_{L}\boldsymbol{T}(\boldsymbol{Y}_{L}%
\boldsymbol{T})^{\top}=\boldsymbol{Y}_{L}\boldsymbol{T}\boldsymbol{T}^{\top}%
\boldsymbol{Y}_{L}^{\top}
\displaystyle\boldsymbol{A}^{\star}_{L}:
\displaystyle=\tilde{\boldsymbol{Y}}_{L}\tilde{\boldsymbol{Y}}_{L}^{\top}=%
\boldsymbol{Y}_{L}\boldsymbol{T}(\boldsymbol{Y}_{L}\boldsymbol{T})^{\top}=%
\boldsymbol{Y}_{L}\boldsymbol{T}\boldsymbol{T}^{\top}\boldsymbol{Y}_{L}^{\top}
\displaystyle=\boldsymbol{Y}_{L}\boldsymbol{T}^{2}\boldsymbol{Y}_{L}^{\top}.
\displaystyle=\boldsymbol{Y}_{L}\boldsymbol{T}^{2}\boldsymbol{Y}_{L}^{\top}.
\bar{\boldsymbol{A}}^{\star}_{L}=\frac{n_{L}}{r}\boldsymbol{A}^{\star}_{L}
\boldsymbol{Y}_{U}
\boldsymbol{I}_{n_{U}\times n_{U}}
\displaystyle\tilde{\boldsymbol{Y}}=\begin{bmatrix}\tilde{\boldsymbol{Y}}_{L}&%
\boldsymbol{0}\\
\boldsymbol{0}&\tilde{\boldsymbol{Y}}_{U}\end{bmatrix}=\begin{bmatrix}%
\boldsymbol{Y}_{L}\boldsymbol{T}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix}.
\displaystyle\tilde{\boldsymbol{Y}}=\begin{bmatrix}\tilde{\boldsymbol{Y}}_{L}&%
\boldsymbol{0}\\
\boldsymbol{0}&\tilde{\boldsymbol{Y}}_{U}\end{bmatrix}=\begin{bmatrix}%
\boldsymbol{Y}_{L}\boldsymbol{T}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix}.
n_{L}
\displaystyle\boldsymbol{A}^{\star}=\tilde{\boldsymbol{Y}}\tilde{\boldsymbol{Y%
}}^{\top}=\begin{bmatrix}\boldsymbol{Y}_{L}\boldsymbol{T}^{2}\boldsymbol{Y}_{L%
}^{\top}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}.\end{bmatrix}
\displaystyle\boldsymbol{A}^{\star}=\tilde{\boldsymbol{Y}}\tilde{\boldsymbol{Y%
}}^{\top}=\begin{bmatrix}\boldsymbol{Y}_{L}\boldsymbol{T}^{2}\boldsymbol{Y}_{L%
}^{\top}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}.\end{bmatrix}
\gamma
\boldsymbol{A}^{\star}
n_{1}=\ldots=n_{r}=\frac{n_{L}}{r}
\displaystyle\bar{\boldsymbol{A}}^{\star}=\begin{bmatrix}\alpha(\gamma)\bar{%
\boldsymbol{A}}_{L}+\beta(\gamma)\frac{r}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}%
^{\top}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix},
\displaystyle\bar{\boldsymbol{A}}^{\star}=\begin{bmatrix}\alpha(\gamma)\bar{%
\boldsymbol{A}}_{L}+\beta(\gamma)\frac{r}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}%
^{\top}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix},
\alpha(\gamma):=\big{(}1-\frac{r}{r-1}\gamma\big{)}^{2}
\beta(\gamma):=\frac{\gamma}{r-1}\big{(}2-\frac{r}{r-1}\gamma\big{)}
\gamma=0
\alpha(\gamma)=1
\beta(\gamma)=0
\alpha
\beta
\alpha(\gamma)
\beta(\gamma)
\boldsymbol{A}_{L}=\boldsymbol{I}_{n_{L}\times n_{L}}
1
\alpha
0
\beta
\gamma
\alpha
\beta
\alpha
\beta
\alpha+\frac{r}{n_{L}}\beta
0
\frac{r}{n_{L}}\beta
\boldsymbol{T}
\frac{r}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}
\theta\in(0,1)
\displaystyle\mathcal{L}_{\mathrm{JointTraining}}:=(1-\theta)\mathcal{L}_{%
\mathrm{unsup}}+\theta\mathcal{L}_{\mathrm{sup}},
\displaystyle\mathcal{L}_{\mathrm{JointTraining}}:=(1-\theta)\mathcal{L}_{%
\mathrm{unsup}}+\theta\mathcal{L}_{\mathrm{sup}},
\mathcal{L}_{\mathrm{unsup}}
\mathcal{L}_{\mathrm{sup}}
\displaystyle(1-\theta)\|\bar{\boldsymbol{A}}_{0}-FF^{\top}\|_{F}^{2}+\theta\|%
\bar{\boldsymbol{A}}^{\star}-FF^{\top}\|_{F}^{2},
\displaystyle(1-\theta)\|\bar{\boldsymbol{A}}_{0}-FF^{\top}\|_{F}^{2}+\theta\|%
\bar{\boldsymbol{A}}^{\star}-FF^{\top}\|_{F}^{2},
\boldsymbol{A}_{0}
\boldsymbol{A}^{\star}
\displaystyle\|((1-\theta)\bar{\boldsymbol{A}}_{0}+\theta\bar{\tilde{%
\boldsymbol{A}}})-FF^{\top}\|_{F}^{2}+c_{0}(\theta),
\displaystyle\|((1-\theta)\bar{\boldsymbol{A}}_{0}+\theta\bar{\tilde{%
\boldsymbol{A}}})-FF^{\top}\|_{F}^{2}+c_{0}(\theta),
c_{0}(\theta):=(1-\theta)\|\bar{\boldsymbol{A}}_{0}\|_{F}^{2}+\theta\|\bar{%
\tilde{\boldsymbol{A}}}\|_{F}^{2}-\|(1-\theta)\bar{\boldsymbol{A}}_{0}+\theta%
\bar{\tilde{\boldsymbol{A}}}\|_{F}^{2}
F
c_{0}(\theta)
F
\displaystyle\boldsymbol{A}_{\theta,\gamma,n_{L}}:=(1-\theta)\bar{\boldsymbol{%
A}}_{0}+\theta\bar{\boldsymbol{A}}^{\star}.
\displaystyle\boldsymbol{A}_{\theta,\gamma,n_{L}}:=(1-\theta)\bar{\boldsymbol{%
A}}_{0}+\theta\bar{\boldsymbol{A}}^{\star}.
\boldsymbol{Y}
\sum_{i\in[n_{L}]}\eta_{j}(x_{i})=n_{L}/r
j\in[r]
\bar{\boldsymbol{A}}_{L}
\mu_{1},\ldots,\mu_{n}
\bar{\boldsymbol{A}}^{\star}
\displaystyle\tilde{\mu}_{1}=\ldots=\tilde{\mu}_{n_{U}+1}=1,
\displaystyle\tilde{\mu}_{1}=\ldots=\tilde{\mu}_{n_{U}+1}=1,
\displaystyle\tilde{\mu}_{j}=\mu_{j}\alpha,\text{ for }j=n_{U}+2,\ldots,n,
\displaystyle\tilde{\mu}_{j}=\mu_{j}\alpha,\text{ for }j=n_{U}+2,\ldots,n,
\alpha=\mu_{j}\Big{(}1-\frac{r}{r-1}\gamma\Big{)}^{2}
\bar{\boldsymbol{A}}^{\star}
\bar{\boldsymbol{A}}
\max_{j\in[r]}\mathrm{P}(Y=j|x)
\bar{\boldsymbol{A}}
\bar{\boldsymbol{A}}^{\star}
\gamma
\alpha
\bar{\boldsymbol{A}}^{\star}
\mathrm{rank}(\boldsymbol{A}^{\star})\leq\mathrm{rank}(\boldsymbol{Y}_{L})+n_{%
U}\leq n_{U}+r
\tilde{\mu}_{n_{U}+r+1}=\ldots=\tilde{\mu}_{n}=0
\mu_{n_{U}+2}=\ldots=\mu_{n_{U}+r}=1
\bar{\boldsymbol{A}}^{\star}
\displaystyle\tilde{\mu}_{1}=\ldots=\tilde{\mu}_{n_{U}+1}=1,
\displaystyle\tilde{\mu}_{1}=\ldots=\tilde{\mu}_{n_{U}+1}=1,
\displaystyle\tilde{\mu}_{n_{U}+2}=\ldots=\tilde{\mu}_{n_{U}+r}=\alpha=\Big{(}%
1-\frac{r}{r-1}\gamma\Big{)}^{2},
\displaystyle\tilde{\mu}_{n_{U}+2}=\ldots=\tilde{\mu}_{n_{U}+r}=\alpha=\Big{(}%
1-\frac{r}{r-1}\gamma\Big{)}^{2},
\displaystyle\tilde{\mu}_{n_{U}+r+1}=\ldots=\tilde{\mu}_{n}=0.
\displaystyle\tilde{\mu}_{n_{U}+r+1}=\ldots=\tilde{\mu}_{n}=0.
\boldsymbol{A}_{\theta,\gamma,n_{L}}
\lambda_{1},\ldots,\lambda_{n}
\boldsymbol{A}_{\theta,\gamma,n_{L}}
\bar{\boldsymbol{A}}_{0}
\nu_{1},\ldots,\nu_{n}
\bar{\boldsymbol{A}}_{L}
\mu_{1},\ldots,\mu_{n_{L}}
k\leq n_{U}
\displaystyle\max\medmath
\displaystyle\max\medmath
\displaystyle\leq\medmath{\lambda_{k+1}\leq\theta+(1-\theta)\nu_{k+1}},
\displaystyle\leq\medmath{\lambda_{k+1}\leq\theta+(1-\theta)\nu_{k+1}},
k\geq n_{U}+r
\displaystyle(1-\theta)\nu_{k+1}\leq\lambda_{k+1}
\displaystyle(1-\theta)\nu_{k+1}\leq\lambda_{k+1}
\displaystyle\leq\medmath{\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(1-%
\theta)\nu_{k-n_{U}},(1-\theta)\nu_{k+1-r-n_{U}}\}.}
\displaystyle\leq\medmath{\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(1-%
\theta)\nu_{k-n_{U}},(1-\theta)\nu_{k+1-r-n_{U}}\}.}
k+1
\boldsymbol{A}_{\theta,\gamma,n_{L}}
k+1
\boldsymbol{A}_{\theta,\gamma,n_{L}}
\boldsymbol{A}_{0}
\lambda_{k+1}
\theta
\nu_{k+1}
\nu_{k-n_{U}}
\nu_{k+1-n_{U}-r}
k
n_{U}
\lambda_{k+1}
k\geq n_{U}+r
\lambda_{k+1}
f:\mathcal{X}\to\mathbb{R}^{k}
B\in\mathbb{R}^{k\times r}
g_{f,B}(\bar{x})=\operatornamewithlimits{arg\,max}_{i\in[r]}\mathrm{P}_{x\sim%
\mathcal{A}(\cdot|\bar{x})}(g_{f,B}(x)=i)
g_{f^{*}_{\mathrm{pop}},B^{*}}
f^{*}_{\mathrm{pop}}\in\operatornamewithlimits{arg\,min}_{f:\mathcal{X}\to%
\mathbb{R}^{k}}
\mathcal{L}(f)
B^{*}
g
y(x)
x
\delta\in(0,1)
\delta_{u},\delta_{s}>0
\displaystyle\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim\mathcal{A}(%
\cdot|\bar{x})}\boldsymbol{1}[\hat{y}(x_{i})\neq y(\bar{x})]\leq\delta_{u}.
\displaystyle\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim\mathcal{A}(%
\cdot|\bar{x})}\boldsymbol{1}[\hat{y}(x_{i})\neq y(\bar{x})]\leq\delta_{u}.
\displaystyle\frac{1}{n_{L}}\sum_{i\in[n_{L}]}\sum_{\ell\in[r]}\eta_{\ell}(x_{%
i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]\leq\delta_{s}.
\displaystyle\frac{1}{n_{L}}\sum_{i\in[n_{L}]}\sum_{\ell\in[r]}\eta_{\ell}(x_{%
i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]\leq\delta_{s}.
\delta_{u}
\delta_{s}
\delta_{s}\leq\delta_{u}
\displaystyle\|B^{*}\|_{F}\leq 1/\max\Big{\{}(1-\theta)\nu_{k},\theta+(1-%
\theta)\nu_{n_{L}+k-r}\Big{\}},
\displaystyle\|B^{*}\|_{F}
\displaystyle\leq 1/\max\Big{\{}(1-\theta)\nu_{k},\theta+(1-\theta)\nu_{n_{L}+%
k-r}\Big{\}},
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[(1+\rho)\delta_{s}-2%
\delta_{u}]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_{u}.
\displaystyle\mathcal{E}
\displaystyle\leq\frac{2\big{[}2\delta_{u}+[(1+\rho)\delta_{s}-2\delta_{u}]%
\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_{u}.
\delta_{u}
\delta_{s}
\theta=1
\rho\leq 2\delta_{u}/\delta_{s}-1
\mathcal{E}\leq 2(1+\rho)\delta_{s}+8\delta_{u}\leq 2(1+\rho)\delta_{u}+8%
\delta_{u}
\nu_{k+1}\in[0,1]
\rho\leq(1+\nu_{k+1})/(1-\nu_{k+1})
2(1+\rho)\delta_{u}+8\delta_{u}\leq\frac{4\delta_{u}}{1-\nu_{k+1}}+8\delta_{u}
\frac{4\delta_{u}}{1-\nu_{k+1}}+8\delta_{u}
\boldsymbol{Y}
\sum_{i\in[n_{L}]}\eta_{j}(x_{i})=n_{L}/r
j\in[r]
\nu_{1},\ldots,\nu_{n}
\bar{\boldsymbol{A}}_{0}
\mathcal{E}:=\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim\mathcal{A}(%
\cdot|\bar{x})}\big{(}g_{f^{*}_{\mathrm{pop}},B^{*}}(x)\neq y(\bar{x})\big{)}
B^{*}\in\mathbb{R}^{r\times k}
\|B^{*}\|_{F}\leq 1/(1-\theta)\nu_{k}
\rho>0
w_{i}/w_{j}<\rho
i,j\in[n]
k>r
\displaystyle\mathcal{E}\leq{\small\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)%
\delta_{s}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\lambda(\boldsymbol{\nu};%
\theta,\alpha)}}+8\delta_{u},
\displaystyle\mathcal{E}\leq{\small\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)%
\delta_{s}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\lambda(\boldsymbol{\nu};%
\theta,\alpha)}}+8\delta_{u},
\displaystyle\lambda(\boldsymbol{\nu};\theta,\alpha)=\min\{\theta+(1-\theta)%
\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k},
\displaystyle\lambda(\boldsymbol{\nu};\theta,\alpha)
\displaystyle=\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k},
\displaystyle\qquad\quad\ (1-\theta)\nu_{k+1-r}\}.
\displaystyle\qquad\quad\ (1-\theta)\nu_{k+1-r}\}.
\alpha:=\big{(}1-\frac{r}{r-1}\gamma\big{)}^{2}
\gamma
\delta_{u}
\delta_{s}
\displaystyle\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(%
1-\alpha)]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_{u},
\displaystyle\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(%
1-\alpha)]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_{u},
\displaystyle\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(%
1-\alpha)]\theta\big{]}}{1-\theta\alpha-(1-\theta)\nu_{k}}+8\delta_{u},
\displaystyle\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(%
1-\alpha)]\theta\big{]}}{1-\theta\alpha-(1-\theta)\nu_{k}}+8\delta_{u},
\displaystyle\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(%
1-\alpha)]\theta\big{]}}{1-(1-\theta)\nu_{k+1-r}}+8\delta_{u}.
\displaystyle\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(%
1-\alpha)]\theta\big{]}}{1-(1-\theta)\nu_{k+1-r}}+8\delta_{u}.
\theta
\theta
\theta=0
\theta=1
\mathcal{E}
\theta=0
\theta=1
\gamma>\gamma_{\mathrm{threshold}}:=\frac{r-1}{r}\Big{(}1-\sqrt{\frac{1-\nu_{k%
+1}-2\delta_{u}}{(1-(1+\rho)\delta_{s})(1-\nu_{k+1})}}\Big{)}
\mathcal{E}
\theta=0
\gamma<\gamma_{\mathrm{threshold}}
\mathcal{E}
\theta=1
\theta\in(0,1)
n
\widehat{\mathcal{E}}:=\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim%
\mathcal{A}(\cdot|\bar{x})}\big{(}g_{\hat{f},\widehat{B}}(x)\neq y(\bar{x})%
\big{)}
\hat{y}:\mathcal{X}\to[r]
\widehat{B}\in\mathbb{R}^{r\times k}
1-\varepsilon
\displaystyle\widehat{\mathcal{E}}\leq{\small\min_{1\leq k^{\prime}\leq k}%
\bigg{(}\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(1-%
\alpha)]\theta\big{]}}{1-\lambda(\boldsymbol{\nu};\theta,\alpha,k^{\prime}+1)}}
\displaystyle\widehat{\mathcal{E}}
\displaystyle\leq{\small\min_{1\leq k^{\prime}\leq k}\bigg{(}\frac{2\big{[}2%
\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-%
\lambda(\boldsymbol{\nu};\theta,\alpha,k^{\prime}+1)}}
\displaystyle+{\small\frac{4k^{\prime}\Big{[}c_{1}\cdot\widehat{R}_{n/2}(%
\mathcal{F})+c_{2}\big{(}\sqrt{\frac{\log 2/\delta}{n}}+\varepsilon\big{)}\Big%
{]}}{\big{(}(1-\theta)\nu_{k^{\prime}}-\lambda(\boldsymbol{\nu};\theta,\alpha,%
k+1)\big{)}^{2}}\bigg{)}+8\delta_{u},}
\displaystyle+{\small\frac{4k^{\prime}\Big{[}c_{1}\cdot\widehat{R}_{n/2}(%
\mathcal{F})+c_{2}\big{(}\sqrt{\frac{\log 2/\delta}{n}}+\varepsilon\big{)}\Big%
{]}}{\big{(}(1-\theta)\nu_{k^{\prime}}-\lambda(\boldsymbol{\nu};\theta,\alpha,%
k+1)\big{)}^{2}}\bigg{)}+8\delta_{u},}
\widehat{R}_{n/2}(\mathcal{F})
\mathcal{F}
n/2
\lambda(\boldsymbol{\nu};\theta,\alpha,k+1)=\min\{\theta+(1-\theta)\nu_{k+1},%
\theta\alpha+(1-\theta)\nu_{k},(1-\theta)\nu_{k+1-r}\}
\alpha:=\big{(}1-\frac{r}{r-1}\gamma\big{)}^{2}
c_{1}\lesssim k^{2}\kappa^{2}+k\kappa
c_{2}\lesssim k\kappa^{2}+k^{2}\kappa^{4}
n\to\infty
0
n<\infty
k
k
k
\lambda_{k+1}
k
\lambda_{k^{\prime}}-\lambda_{k+1}\to 0
\lambda_{k^{\prime}}
\lambda_{k+1}
k
e^{f(x)^{\top}f(x^{\prime})}
\tau
1024
1000
0.5
700
800
900
0.1
100
\{0.1,0.2,0.3,0.4,0.5,0.6\}
\{0.2,0.4,0.6,0.8\}
\theta
\theta
\theta
\mathcal{L}_{\mathrm{JointTraining}}
\theta
\mathcal{L}_{\mathrm{JointTraining}}
\theta
\mathcal{L}_{\mathrm{JointTraining}}
\theta
0
1
\mathcal{L}_{\mathrm{JointTraining}}
\theta
0.4
0.8
\theta
\mathcal{L}_{\mathrm{JointTraining}}
\mathcal{L}_{\mathrm{JointTraining}}
\theta
\theta
\theta
\theta
\theta
\theta
k
k
\theta=0.1
30\%
\{128,256,512,1024,2048\}
k
k
k
k
k
\mathcal{L}_{\mathrm{JointTraining}}
\theta\in\{0.1,0.2,0.4,0.6\}
\{0.2,0.4,0.6,0.8\}
\displaystyle(\boldsymbol{T}^{2})_{i,j}=\left\{\begin{aligned} &(1-\gamma)^{2}%
+\gamma^{2}/(r-1),&\ i=j\\
&2\gamma(1-\gamma)/(r-1)+(r-2)\gamma^{2}/(r-1)^{2},&\ i\neq j\\
\end{aligned}\right.
\displaystyle(\boldsymbol{T}^{2})_{i,j}
\displaystyle=\left\{\begin{aligned} &(1-\gamma)^{2}+\gamma^{2}/(r-1),&\ i=j\\
&2\gamma(1-\gamma)/(r-1)+(r-2)\gamma^{2}/(r-1)^{2},&\ i\neq j\\
\end{aligned}\right.
\displaystyle=\left\{\begin{aligned} &(1-\gamma)^{2}+\gamma^{2}/(r-1),&\ i=j\\
&\frac{\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)},&\ i\neq j.\\
\end{aligned}\right.
\displaystyle=\left\{\begin{aligned} &(1-\gamma)^{2}+\gamma^{2}/(r-1),&\ i=j\\
&\frac{\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)},&\ i\neq j.\\
\end{aligned}\right.
\displaystyle\boldsymbol{T}^{2}=\Big{[}(1-\gamma)^{2}+\gamma^{2}/(r-1)-\frac{%
\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)}\Big{]}\boldsymbol{I}_{r\times r}
\displaystyle\boldsymbol{T}^{2}
\displaystyle=\Big{[}(1-\gamma)^{2}+\gamma^{2}/(r-1)-\frac{\gamma}{r-1}\Big{(}%
2-\frac{r}{r-1}\gamma\Big{)}\Big{]}\boldsymbol{I}_{r\times r}
\displaystyle\qquad+\frac{\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)}\vec{%
1}_{r}\vec{1}_{r}^{\top}
\displaystyle\qquad+\frac{\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)}\vec{%
1}_{r}\vec{1}_{r}^{\top}
\displaystyle=\Big{(}1-\frac{r}{r-1}\gamma\Big{)}^{2}\boldsymbol{I}_{r\times r%
}+\frac{\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)}\vec{1}_{r}\vec{1}_{r}^%
{\top}
\displaystyle=\Big{(}1-\frac{r}{r-1}\gamma\Big{)}^{2}\boldsymbol{I}_{r\times r%
}+\frac{\gamma}{r-1}\Big{(}2-\frac{r}{r-1}\gamma\Big{)}\vec{1}_{r}\vec{1}_{r}^%
{\top}
\displaystyle:=\alpha\boldsymbol{I}_{r\times r}+\beta\vec{1}_{r}\vec{1}_{r}^{%
\top}.
\displaystyle:=\alpha\boldsymbol{I}_{r\times r}+\beta\vec{1}_{r}\vec{1}_{r}^{%
\top}.
\gamma\in[0,1)
\displaystyle\boldsymbol{A}^{\star}_{L}=\boldsymbol{Y}_{L}\boldsymbol{T}^{2}%
\boldsymbol{Y}_{L}^{\top}=\boldsymbol{Y}_{L}\big{(}\alpha\boldsymbol{I}_{r%
\times r}+\beta\vec{1}_{r}\vec{1}_{r}^{\top}\big{)}\boldsymbol{Y}_{L}^{\top}
\displaystyle\boldsymbol{A}^{\star}_{L}=\boldsymbol{Y}_{L}\boldsymbol{T}^{2}%
\boldsymbol{Y}_{L}^{\top}
\displaystyle=\boldsymbol{Y}_{L}\big{(}\alpha\boldsymbol{I}_{r\times r}+\beta%
\vec{1}_{r}\vec{1}_{r}^{\top}\big{)}\boldsymbol{Y}_{L}^{\top}
\displaystyle=\alpha\boldsymbol{Y}_{L}\boldsymbol{Y}_{L}^{\top}+\beta%
\boldsymbol{Y}_{L}\vec{1}_{r}\vec{1}_{r}^{\top}\boldsymbol{Y}_{L}^{\top}
\displaystyle=\alpha\boldsymbol{Y}_{L}\boldsymbol{Y}_{L}^{\top}+\beta%
\boldsymbol{Y}_{L}\vec{1}_{r}\vec{1}_{r}^{\top}\boldsymbol{Y}_{L}^{\top}
\displaystyle=\alpha\boldsymbol{A}_{L}+\beta\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{%
\top},
\displaystyle=\alpha\boldsymbol{A}_{L}+\beta\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{%
\top},
\sum_{j}\eta_{j}(x_{i})=1
i\in[n]
\displaystyle\bar{\boldsymbol{A}}^{\star}=\tilde{\boldsymbol{D}}^{-1/2}%
\boldsymbol{A}^{\star}\tilde{\boldsymbol{D}}^{-1/2},
\displaystyle\bar{\boldsymbol{A}}^{\star}=\tilde{\boldsymbol{D}}^{-1/2}%
\boldsymbol{A}^{\star}\tilde{\boldsymbol{D}}^{-1/2},
\displaystyle\tilde{\boldsymbol{D}}=\begin{bmatrix}\tilde{\boldsymbol{D}}_{L}&%
\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix},
\displaystyle\tilde{\boldsymbol{D}}=\begin{bmatrix}\tilde{\boldsymbol{D}}_{L}&%
\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix},
\displaystyle\tilde{\boldsymbol{D}}_{L}=\mathrm{diag}(d_{i}),
\displaystyle\tilde{\boldsymbol{D}}_{L}=\mathrm{diag}(d_{i}),
\displaystyle d_{i}=\sum_{j\in[n_{L}]}\boldsymbol{A}^{\star}_{i,j}=\alpha\sum_%
{j\in[n_{L}]}\sum_{\ell\in[r]}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})+n_{L}\beta
\displaystyle d_{i}
\displaystyle=\sum_{j\in[n_{L}]}\boldsymbol{A}^{\star}_{i,j}=\alpha\sum_{j\in[%
n_{L}]}\sum_{\ell\in[r]}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})+n_{L}\beta
\displaystyle=\alpha\sum_{\ell\in[r]}\eta_{\ell}(x_{i})\sum_{j\in[n_{L}]}\eta_%
{\ell}(x_{j})+n_{L}\beta=\alpha\sum_{\ell\in[r]}\eta_{\ell}(x_{i})n_{\ell}+n_{%
L}\beta
\displaystyle=\alpha\sum_{\ell\in[r]}\eta_{\ell}(x_{i})\sum_{j\in[n_{L}]}\eta_%
{\ell}(x_{j})+n_{L}\beta=\alpha\sum_{\ell\in[r]}\eta_{\ell}(x_{i})n_{\ell}+n_{%
L}\beta
n_{1}=\ldots=n_{r}=n_{L}/r
\displaystyle d_{i}=\frac{n_{L}}{r}\alpha\sum_{\ell\in[r]}\eta_{\ell}(x_{i})+n%
_{L}\beta=\frac{n_{L}}{r}\alpha+n_{L}\beta=\frac{n_{L}}{r},
\displaystyle d_{i}=\frac{n_{L}}{r}\alpha\sum_{\ell\in[r]}\eta_{\ell}(x_{i})+n%
_{L}\beta=\frac{n_{L}}{r}\alpha+n_{L}\beta=\frac{n_{L}}{r},
\displaystyle\bar{\boldsymbol{A}}^{\star}=\begin{bmatrix}\alpha\frac{r}{n_{L}}%
\boldsymbol{A}_{L}+\beta\frac{r}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}&%
\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix}.
\displaystyle\bar{\boldsymbol{A}}^{\star}=\begin{bmatrix}\alpha\frac{r}{n_{L}}%
\boldsymbol{A}_{L}+\beta\frac{r}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}&%
\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix}.
v_{1}=\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}
\bar{\boldsymbol{A}}_{L}:=\frac{r}{n_{L}}\boldsymbol{A}_{L}
\mu_{1}=1
\displaystyle\bar{\boldsymbol{A}}_{L}\cdot\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}%
}=\frac{1}{\sqrt{n_{L}}}\cdot\frac{r}{n_{L}}\boldsymbol{A}_{L}\cdot\vec{1}_{n_%
{L}}
\displaystyle\bar{\boldsymbol{A}}_{L}\cdot\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}
\displaystyle=\frac{1}{\sqrt{n_{L}}}\cdot\frac{r}{n_{L}}\boldsymbol{A}_{L}%
\cdot\vec{1}_{n_{L}}
\displaystyle=\frac{1}{\sqrt{n_{L}}}\cdot\frac{r}{n_{L}}\boldsymbol{Y}_{L}%
\boldsymbol{Y}_{L}^{\top}\vec{1}_{n_{L}}
\displaystyle=\frac{1}{\sqrt{n_{L}}}\cdot\frac{r}{n_{L}}\boldsymbol{Y}_{L}%
\boldsymbol{Y}_{L}^{\top}\vec{1}_{n_{L}}
\displaystyle=\frac{1}{\sqrt{n_{L}}}\cdot\frac{r}{n_{L}}\boldsymbol{Y}_{L}%
\frac{n_{L}}{r}\vec{1}_{r}
\displaystyle=\frac{1}{\sqrt{n_{L}}}\cdot\frac{r}{n_{L}}\boldsymbol{Y}_{L}%
\frac{n_{L}}{r}\vec{1}_{r}
\displaystyle=\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},
\displaystyle=\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},
\sum_{i\in[n_{L}]}\eta_{j}(x_{i})=n_{L}/r
j\in[r]
\sum_{j\in[r]}\eta_{j}(x_{i})=1
i\in[n_{L}]
\bar{\boldsymbol{A}}_{L}
\displaystyle\bar{\boldsymbol{A}}_{L}=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}%
\vec{1}_{n_{L}},v_{2},\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}1&0&\ldots&0%
\\
0&\mu_{2}&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&\mu_{n_{L}}\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1%
}_{n_{L}}^{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}.
\displaystyle\bar{\boldsymbol{A}}_{L}=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}%
\vec{1}_{n_{L}},v_{2},\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}1&0&\ldots&0%
\\
0&\mu_{2}&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&\mu_{n_{L}}\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1%
}_{n_{L}}^{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}.
\frac{1}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}
\displaystyle\frac{1}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}=\Big{(}\frac%
{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}\Big{)}\Big{(}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n%
_{L}}\Big{)}^{\top}
\displaystyle\frac{1}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}
\displaystyle=\Big{(}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}\Big{)}\Big{(}\frac{%
1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}\Big{)}^{\top}
\displaystyle=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},v_{2},%
\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}1&0&\ldots&0\\
0&0&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&0\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}^%
{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}.
\displaystyle=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},v_{2},%
\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}1&0&\ldots&0\\
0&0&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&0\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}^%
{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}.
\displaystyle\bar{\boldsymbol{A}}^{\star}_{L}:=\alpha\frac{r}{n_{L}}%
\boldsymbol{A}_{L}+r\beta\frac{1}{n_{L}}\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}
\displaystyle\bar{\boldsymbol{A}}^{\star}_{L}
\displaystyle:=\alpha\frac{r}{n_{L}}\boldsymbol{A}_{L}+r\beta\frac{1}{n_{L}}%
\vec{1}_{n_{L}}\vec{1}_{n_{L}}^{\top}
\displaystyle=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},v_{2},%
\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}\alpha&0&\ldots&0\\
0&\alpha\mu_{2}&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&\alpha\mu_{n_{L}}\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}%
\vec{1}_{n_{L}}^{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}
\displaystyle=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},v_{2},%
\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}\alpha&0&\ldots&0\\
0&\alpha\mu_{2}&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&\alpha\mu_{n_{L}}\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}%
\vec{1}_{n_{L}}^{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}
\displaystyle\phantom{=}\cdot\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{%
L}},v_{2},\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}r\beta&0&\ldots&0\\
0&0&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&0\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}^%
{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}
\displaystyle\phantom{=}\cdot\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{%
L}},v_{2},\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}r\beta&0&\ldots&0\\
0&0&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&0\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}}^%
{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}
\displaystyle=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},v_{2},%
\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}\alpha+r\beta&0&\ldots&0\\
0&\alpha\mu_{2}&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&\alpha\mu_{n_{L}}\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}%
\vec{1}_{n_{L}}^{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}.
\displaystyle=\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}\vec{1}_{n_{L}},v_{2},%
\ldots,v_{n_{L}}\end{bmatrix}\begin{bmatrix}\alpha+r\beta&0&\ldots&0\\
0&\alpha\mu_{2}&\ldots&0\\
\vdots&\vdots&&\vdots\\
0&0&\ldots&\alpha\mu_{n_{L}}\end{bmatrix}\begin{bmatrix}\frac{1}{\sqrt{n_{L}}}%
\vec{1}_{n_{L}}^{\top}\\
v_{2}^{\top}\\
\vdots\\
v_{n_{L}}^{\top}\end{bmatrix}.
\alpha+r\beta=1
\bar{\boldsymbol{A}}^{\star}_{L}
1,\alpha\mu_{2},\ldots,\alpha\mu_{n_{L}}
\displaystyle\bar{\boldsymbol{A}}^{\star}=\begin{bmatrix}\bar{\boldsymbol{A}}^%
{\star}_{L}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix}
\displaystyle\bar{\boldsymbol{A}}^{\star}=\begin{bmatrix}\bar{\boldsymbol{A}}^%
{\star}_{L}&\boldsymbol{0}\\
\boldsymbol{0}&\boldsymbol{I}_{n_{U}\times n_{U}}\end{bmatrix}
\displaystyle\tilde{\mu}_{1}=\ldots=\tilde{\mu}_{n_{U}+1}=1,
\displaystyle\tilde{\mu}_{1}=\ldots=\tilde{\mu}_{n_{U}+1}=1,
\displaystyle\tilde{\mu}_{j}=\alpha\mu_{j},\text{ for }j=n_{U}+2,\ldots,n.
\displaystyle\tilde{\mu}_{j}=\alpha\mu_{j},\text{ for }j=n_{U}+2,\ldots,n.
n
n
(1-\theta)\bar{\boldsymbol{A}}_{0}
\theta\bar{\boldsymbol{A}}^{\star}
k+1
\boldsymbol{A}_{\theta,\lambda,n_{L}}:=(1-\theta)\bar{\boldsymbol{A}}_{0}+%
\theta\bar{\boldsymbol{A}}^{\star}
\displaystyle\max_{i+j=n+k+1}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}\leq%
\lambda_{k+1}\leq\min_{i+j=k+2}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}.
\displaystyle\max_{i+j=n+k+1}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}\leq%
\lambda_{k+1}\leq\min_{i+j=k+2}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}.
\displaystyle\tilde{\mu}_{j}=\left\{\begin{aligned} &1,&j=1,\ldots,n_{U}+1;\\
&\alpha\mu_{j},&j=n_{U}+2,\ldots,n_{U}+r;\\
&0,&j=n_{U}+r+1,\ldots,n.\\
\end{aligned}\right.
\displaystyle\tilde{\mu}_{j}=\left\{\begin{aligned} &1,&j=1,\ldots,n_{U}+1;\\
&\alpha\mu_{j},&j=n_{U}+2,\ldots,n_{U}+r;\\
&0,&j=n_{U}+r+1,\ldots,n.\\
\end{aligned}\right.
\displaystyle\phantom{=}\max_{i+j=n+k+1}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}
\displaystyle\phantom{=}\max_{i+j=n+k+1}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}
\displaystyle=\max_{1\leq i\leq n+k+1}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{n+k%
+1-i}
\displaystyle=\max_{1\leq i\leq n+k+1}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{n+k%
+1-i}
\displaystyle=\max\left\{\begin{aligned} &\theta+(1-\theta)\nu_{i},&i=n_{L}+k,%
\ldots,n;\\
&\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i},&i=n_{L}+k-r+1,\ldots,n_{L}+k-1;%
\\
&(1-\theta)\nu_{i},&i=k+1,\ldots,n_{L}+k-r\end{aligned}\right.
\displaystyle=\max\left\{\begin{aligned} &\theta+(1-\theta)\nu_{i},&i=n_{L}+k,%
\ldots,n;\\
&\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i},&i=n_{L}+k-r+1,\ldots,n_{L}+k-1;%
\\
&(1-\theta)\nu_{i},&i=k+1,\ldots,n_{L}+k-r\end{aligned}\right.
\displaystyle=\max\left\{\begin{aligned} &\theta+(1-\theta)\nu_{n_{L}+k}\\
&\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i},&i=n_{L}+k-r+1,\ldots,n_{L}+k-1;%
\\
&(1-\theta)\nu_{k+1},\end{aligned}\right.
\displaystyle=\max\left\{\begin{aligned} &\theta+(1-\theta)\nu_{n_{L}+k}\\
&\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i},&i=n_{L}+k-r+1,\ldots,n_{L}+k-1;%
\\
&(1-\theta)\nu_{k+1},\end{aligned}\right.
\{\nu_{i}\}_{i\in[n]}
k\leq n_{U}
\displaystyle\lambda_{k+1}\geq\max\big{\{}\theta+(1-\theta)\nu_{n_{L}+k},\max_%
{i=n_{L}+k-r+1,\ldots,n_{L}+k-1}\{\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i}%
\},(1-\theta)\nu_{k+1}\big{\}},
\displaystyle\lambda_{k+1}\geq\max\big{\{}\theta+(1-\theta)\nu_{n_{L}+k},\max_%
{i=n_{L}+k-r+1,\ldots,n_{L}+k-1}\{\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i}%
\},(1-\theta)\nu_{k+1}\big{\}},
n_{U}<k<n_{U}+r
\displaystyle\lambda_{k+1}\geq\max\big{\{}(1-\theta)\nu_{k+1},\max_{i=n_{L}+k-%
r+1,\ldots,n_{L}+k-1}\{\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i}\}\big{\}},
\displaystyle\lambda_{k+1}\geq\max\big{\{}(1-\theta)\nu_{k+1},\max_{i=n_{L}+k-%
r+1,\ldots,n_{L}+k-1}\{\theta\alpha\mu_{n+k+1-i}+(1-\theta)\nu_{i}\}\big{\}},
k\geq n_{U}+r
\displaystyle\lambda_{k+1}\geq(1-\theta)\nu_{k+1}.
\displaystyle\lambda_{k+1}\geq(1-\theta)\nu_{k+1}.
\displaystyle\phantom{=}\min_{i+j=k+2}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}
\displaystyle\phantom{=}\min_{i+j=k+2}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{j}
\displaystyle=\min_{1\leq i\leq k+2}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{k+2-i}
\displaystyle=\min_{1\leq i\leq k+2}(1-\theta)\nu_{i}+\theta\tilde{\mu}_{k+2-i}
\displaystyle=\min\left\{\begin{aligned} &\theta+(1-\theta)\nu_{i},&i=k+1-n_{U%
},\ldots,k+1;\\
&\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i},&i=k+2-r-n_{U},\ldots,k-n_{U};\\
&(1-\theta)\nu_{i},&i=k+2-n,\ldots,k+1-r-n_{U}.\end{aligned}\right.
\displaystyle=\min\left\{\begin{aligned} &\theta+(1-\theta)\nu_{i},&i=k+1-n_{U%
},\ldots,k+1;\\
&\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i},&i=k+2-r-n_{U},\ldots,k-n_{U};\\
&(1-\theta)\nu_{i},&i=k+2-n,\ldots,k+1-r-n_{U}.\end{aligned}\right.
\displaystyle=\min\left\{\begin{aligned} &\theta+(1-\theta)\nu_{k+1};\\
&\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i},&i=k+2-r-n_{U},\ldots,k-n_{U};\\
&(1-\theta)\nu_{k+1-r-n_{U}}.\end{aligned}\right.
\displaystyle=\min\left\{\begin{aligned} &\theta+(1-\theta)\nu_{k+1};\\
&\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i},&i=k+2-r-n_{U},\ldots,k-n_{U};\\
&(1-\theta)\nu_{k+1-r-n_{U}}.\end{aligned}\right.
k\leq n_{U}
\displaystyle\lambda_{k+1}\leq\theta+(1-\theta)\nu_{k+1},
\displaystyle\lambda_{k+1}\leq\theta+(1-\theta)\nu_{k+1},
n_{U}<k<n_{U}+r
\displaystyle\lambda_{k+1}\leq\min\Big{\{}\theta+(1-\theta)\nu_{k+1},\min_{i=k%
+2-r-n_{U},\ldots,k-n_{U}}\{\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i}\}\Big{\}},
\displaystyle\lambda_{k+1}\leq\min\Big{\{}\theta+(1-\theta)\nu_{k+1},\min_{i=k%
+2-r-n_{U},\ldots,k-n_{U}}\{\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i}\}\Big{\}},
k\geq n_{U}+r
\displaystyle\lambda_{k+1}\leq\min\Big{\{}\theta+(1-\theta)\nu_{k+1},\min_{i=k%
+2-r-n_{U},\ldots,k-n_{U}}\{\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i}\},(1-%
\theta)\nu_{k+1-r-n_{U}}\Big{\}}.
\displaystyle\lambda_{k+1}\leq\min\Big{\{}\theta+(1-\theta)\nu_{k+1},\min_{i=k%
+2-r-n_{U},\ldots,k-n_{U}}\{\theta\alpha\mu_{k+2-i}+(1-\theta)\nu_{i}\},(1-%
\theta)\nu_{k+1-r-n_{U}}\Big{\}}.
\boldsymbol{Y}
\sum_{i\in[n_{L}]}\eta_{j}(x_{i})=n_{L}/r
j\in[r]
\nu_{1},\ldots,\nu_{n}
\bar{\boldsymbol{A}}_{0}
\mathcal{E}:=\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim\mathcal{A}(%
\cdot|\bar{x})}\big{(}g_{f^{*}_{\mathrm{pop}},B^{*}}(x)\neq y(\bar{x})\big{)}
B^{*}\in\mathbb{R}^{r\times k}
\|B^{*}\|_{F}\leq 1/\lambda_{k}
\rho>0
w_{i}/w_{j}<\rho
i,j\in[n]
k\leq n_{U}
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_%
{u},
\displaystyle\mathcal{E}
\displaystyle\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{%
u}+(1-\alpha)]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_{u},
n_{U}+1\leq k\leq n_{U}+r-1
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\min\{\theta+(1-\theta)\nu_{k+1},%
\theta\alpha+(1-\theta)\nu_{k-n_{U}}\}}+8\delta_{u},
\displaystyle\mathcal{E}
\displaystyle\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{%
u}+(1-\alpha)]\theta\big{]}}{1-\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(%
1-\theta)\nu_{k-n_{U}}\}}+8\delta_{u},
k\geq n_{U}+r
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\lambda(\nu;\theta,\alpha)}+8\delta_%
{u},
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\lambda(\nu;\theta,\alpha)}+8\delta_%
{u},
\displaystyle\lambda(\boldsymbol{\nu};\theta,\alpha)=\min\{\theta+(1-\theta)%
\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k-n_{U}},
\displaystyle\lambda(\boldsymbol{\nu};\theta,\alpha)
\displaystyle=\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k-n%
_{U}},
\displaystyle\qquad\quad\ (1-\theta)\nu_{k+1-r-n_{U}}\}
\displaystyle\qquad\quad\ (1-\theta)\nu_{k+1-r-n_{U}}\}
\alpha:=\big{(}1-\frac{r}{r-1}\gamma\big{)}^{2}
\vec{y}:\mathcal{X}\to[r]
B^{*}\in\mathbb{R}^{r\times k}
\|B^{*}\|_{F}\leq 1/\lambda_{k}
\displaystyle\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim\mathcal{A}(%
\cdot|\bar{x})}\Big{(}g_{f^{*}_{\mathrm{pop}},B^{*}}(x)\neq y(\bar{x})\Big{)}%
\leq\frac{2\phi^{\hat{y}}}{1-\lambda_{k+1}}+8\delta_{u},
\displaystyle\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim\mathcal{A}(%
\cdot|\bar{x})}\Big{(}g_{f^{*}_{\mathrm{pop}},B^{*}}(x)\neq y(\bar{x})\Big{)}%
\leq\frac{2\phi^{\hat{y}}}{1-\lambda_{k+1}}+8\delta_{u},
\boldsymbol{A}_{\theta,\lambda,n_{L}}
\displaystyle\phi^{\hat{y}}=\sum_{i,j\in[n]}\big{[}(1-\theta)\frac{w_{ij}}{%
\sqrt{w_{i}w_{j}}}+\theta\bar{\boldsymbol{A}}^{\star}_{i,j}\big{]}\boldsymbol{%
1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle\phi^{\hat{y}}
\displaystyle=\sum_{i,j\in[n]}\big{[}(1-\theta)\frac{w_{ij}}{\sqrt{w_{i}w_{j}}%
}+\theta\bar{\boldsymbol{A}}^{\star}_{i,j}\big{]}\boldsymbol{1}[\hat{y}(x_{i})%
\neq\hat{y}(x_{j})]
\displaystyle=\frac{1}{\sqrt{w_{i}w_{j}}}\big{[}(1-\theta)\sum_{i,j\in[n]}w_{i%
,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]+\theta\sum_{i,j\in[n]}%
\sqrt{w_{i}w_{j}}\bar{\boldsymbol{A}}^{\star}_{i,j}\boldsymbol{1}[\hat{y}(x_{i%
})\neq\hat{y}(x_{j})]\big{]}.
\displaystyle=\frac{1}{\sqrt{w_{i}w_{j}}}\big{[}(1-\theta)\sum_{i,j\in[n]}w_{i%
,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]+\theta\sum_{i,j\in[n]}%
\sqrt{w_{i}w_{j}}\bar{\boldsymbol{A}}^{\star}_{i,j}\boldsymbol{1}[\hat{y}(x_{i%
})\neq\hat{y}(x_{j})]\big{]}.
\displaystyle\quad\sum_{i,j\in[n]}w_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat%
{y}(x_{j})]
\displaystyle\quad\sum_{i,j\in[n]}w_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat%
{y}(x_{j})]
\displaystyle=\sum_{i,j\in[n]}\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{%
\mathcal{X}}}}\mathcal{A}(x_{i}|\bar{x})\mathcal{A}(x_{j}|\bar{x})\boldsymbol{%
1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle=\sum_{i,j\in[n]}\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{%
\mathcal{X}}}}\mathcal{A}(x_{i}|\bar{x})\mathcal{A}(x_{j}|\bar{x})\boldsymbol{%
1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle\leq\sum_{i,j\in[n]}\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{%
\mathcal{X}}}}\mathcal{A}(x_{i}|\bar{x})\mathcal{A}(x_{j}|\bar{x})\big{(}%
\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(\bar{x})]+\boldsymbol{1}[\hat{y}(x_{j%
})\neq\hat{y}(\bar{x})]\big{)}
\displaystyle\leq\sum_{i,j\in[n]}\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{%
\mathcal{X}}}}\mathcal{A}(x_{i}|\bar{x})\mathcal{A}(x_{j}|\bar{x})\big{(}%
\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(\bar{x})]+\boldsymbol{1}[\hat{y}(x_{j%
})\neq\hat{y}(\bar{x})]\big{)}
\displaystyle=2\sum_{i\in[n]}\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{\mathcal%
{X}}}}\mathcal{A}(x_{i}|\bar{x})\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(\bar{%
x})]
\displaystyle=2\sum_{i\in[n]}\mathbb{E}_{\bar{x}\sim\mathcal{P}_{\bar{\mathcal%
{X}}}}\mathcal{A}(x_{i}|\bar{x})\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(\bar{%
x})]
\displaystyle\leq 2\delta_{u}.
\displaystyle\leq 2\delta_{u}.
\displaystyle\quad\sum_{i,j\in[n]}\sqrt{w_{i}w_{j}}\bar{\boldsymbol{A}}^{\star%
}_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle\quad\sum_{i,j\in[n]}\sqrt{w_{i}w_{j}}\bar{\boldsymbol{A}}^{\star%
}_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle=\sum_{i,j\in[n_{L}]}\sqrt{w_{i}w_{j}}(\bar{\boldsymbol{A}}^{%
\star}_{L})_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]+\sum_{i>n_{L%
}}\sqrt{w_{i}w_{j}}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{i})]
\displaystyle=\sum_{i,j\in[n_{L}]}\sqrt{w_{i}w_{j}}(\bar{\boldsymbol{A}}^{%
\star}_{L})_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]+\sum_{i>n_{L%
}}\sqrt{w_{i}w_{j}}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{i})]
\displaystyle\qquad+2\sum_{i\leq n_{L},j>n_{L}}\sqrt{w_{i}w_{j}}\bar{%
\boldsymbol{A}}^{\star}_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{i})].
\displaystyle\qquad+2\sum_{i\leq n_{L},j>n_{L}}\sqrt{w_{i}w_{j}}\bar{%
\boldsymbol{A}}^{\star}_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{i})].
\bar{\boldsymbol{A}}^{\star}
0
\displaystyle\quad\sum_{i,j\in[n]}\sqrt{w_{i}w_{j}}\bar{\boldsymbol{A}}^{\star%
}_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle\quad\sum_{i,j\in[n]}\sqrt{w_{i}w_{j}}\bar{\boldsymbol{A}}^{\star%
}_{i,j}\boldsymbol{1}[\hat{y}(x_{i})\neq\hat{y}(x_{j})]
\displaystyle=\sum_{i,j\in[n_{L}]}\sqrt{w_{i}w_{j}}\Big{(}\alpha\bar{%
\boldsymbol{A}}_{i,j}+\beta\frac{r}{n_{L}}\Big{)}\boldsymbol{1}[\hat{y}(x_{i})%
\neq\hat{y}(x_{j})]
\displaystyle=\sum_{i,j\in[n_{L}]}\sqrt{w_{i}w_{j}}\Big{(}\alpha\bar{%
\boldsymbol{A}}_{i,j}+\beta\frac{r}{n_{L}}\Big{)}\boldsymbol{1}[\hat{y}(x_{i})%
\neq\hat{y}(x_{j})]
\displaystyle\leq\alpha\frac{r}{n_{L}}\sum_{i,j\in[n_{L}]}\sum_{\ell\in[r]}%
\sqrt{w_{i}w_{j}}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\Big{(}\boldsymbol{1}[%
\hat{y}(x_{i})\neq\ell]+\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]\Big{)}
\displaystyle\leq\alpha\frac{r}{n_{L}}\sum_{i,j\in[n_{L}]}\sum_{\ell\in[r]}%
\sqrt{w_{i}w_{j}}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\Big{(}\boldsymbol{1}[%
\hat{y}(x_{i})\neq\ell]+\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]\Big{)}
\displaystyle\qquad+(1-\alpha)\frac{1}{n_{L}}\sum_{i,j\in[n_{L}]}\sqrt{w_{i}w_%
{j}}
\displaystyle\qquad+(1-\alpha)\frac{1}{n_{L}}\sum_{i,j\in[n_{L}]}\sqrt{w_{i}w_%
{j}}
\displaystyle\leq\alpha\frac{r}{n_{L}}\sum_{i,j\in[n_{L}]}\sum_{\ell\in[r]}%
\frac{1}{2}(w_{i}+w_{j})\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\Big{(}\boldsymbol%
{1}[\hat{y}(x_{i})\neq\ell]+\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]\Big{)}
\displaystyle\leq\alpha\frac{r}{n_{L}}\sum_{i,j\in[n_{L}]}\sum_{\ell\in[r]}%
\frac{1}{2}(w_{i}+w_{j})\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\Big{(}\boldsymbol%
{1}[\hat{y}(x_{i})\neq\ell]+\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]\Big{)}
\displaystyle\qquad+(1-\alpha)\frac{1}{n_{L}}\sum_{i,j\in[n_{L}]}\frac{1}{2}(w%
_{i}+w_{j})
\displaystyle\qquad+(1-\alpha)\frac{1}{n_{L}}\sum_{i,j\in[n_{L}]}\frac{1}{2}(w%
_{i}+w_{j})
\displaystyle=\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{i})%
\neq\ell]
\displaystyle=\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{i})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{i})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{i})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})%
\neq\ell]+(1-\alpha)
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})%
\neq\ell]+(1-\alpha)
\displaystyle\leq\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in%
[n_{L}]}\rho w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x%
_{i})\neq\ell]
\displaystyle\leq\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in%
[n_{L}]}\rho w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x%
_{i})\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{i})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}w_{j}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{i})%
\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}\rho w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j%
})\neq\ell]+(1-\alpha)
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i,j\in[n_%
{L}]}\rho w_{i}\eta_{\ell}(x_{i})\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j%
})\neq\ell]+(1-\alpha)
\displaystyle=\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i\in[n_{L%
}]}\rho\pi_{\ell}\eta_{\ell}(x_{i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]
\displaystyle=\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i\in[n_{L%
}]}\rho\pi_{\ell}\eta_{\ell}(x_{i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{j\in[n_{L%
}]}\pi_{\ell}\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{j\in[n_{L%
}]}\pi_{\ell}\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i\in[n_{L%
}]}\pi_{\ell}\eta_{\ell}(x_{i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{i\in[n_{L%
}]}\pi_{\ell}\eta_{\ell}(x_{i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{j\in[n_{L%
}]}\rho\pi_{\ell}\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]+(1-\alpha)
\displaystyle+\frac{1}{2}\alpha\frac{r}{n_{L}}\sum_{\ell\in[r]}\sum_{j\in[n_{L%
}]}\rho\pi_{\ell}\eta_{\ell}(x_{j})\boldsymbol{1}[\hat{y}(x_{j})\neq\ell]+(1-\alpha)
\displaystyle=\alpha(1+\rho)\frac{1}{n_{L}}\sum_{\ell\in[r]}\sum_{i\in[n_{L}]}%
\eta_{\ell}(x_{i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]+(1-\alpha)
\displaystyle=\alpha(1+\rho)\frac{1}{n_{L}}\sum_{\ell\in[r]}\sum_{i\in[n_{L}]}%
\eta_{\ell}(x_{i})\boldsymbol{1}[\hat{y}(x_{i})\neq\ell]+(1-\alpha)
\displaystyle\leq\alpha(1+\rho)\delta_{s}+(1-\alpha),
\displaystyle\leq\alpha(1+\rho)\delta_{s}+(1-\alpha),
\pi_{\ell}=\mathrm{P}(Y=\ell)
\pi_{\ell}=\frac{1}{r}
\displaystyle\phi^{\hat{y}}\leq 2(1-\theta)\delta_{u}+\theta\alpha(1+\rho)%
\delta_{s}+\theta(1-\alpha)=2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+%
(1-\alpha)]\theta.
\displaystyle\phi^{\hat{y}}\leq 2(1-\theta)\delta_{u}+\theta\alpha(1+\rho)%
\delta_{s}+\theta(1-\alpha)=2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}+%
(1-\alpha)]\theta.
\displaystyle\mathcal{E}:=\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim%
\mathcal{A}(\cdot|\bar{x})}\Big{(}g_{f^{*}_{\mathrm{pop}},B^{*}}(x)\neq y(\bar%
{x})\Big{)}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}%
+(1-\alpha)]\theta\big{]}}{1-\lambda_{k+1}}+8\delta_{u},
\displaystyle\mathcal{E}:=\mathrm{P}_{\bar{x}\sim\mathcal{P}_{\bar{X}},x\sim%
\mathcal{A}(\cdot|\bar{x})}\Big{(}g_{f^{*}_{\mathrm{pop}},B^{*}}(x)\neq y(\bar%
{x})\Big{)}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{u}%
+(1-\alpha)]\theta\big{]}}{1-\lambda_{k+1}}+8\delta_{u},
k\leq n_{U}
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_%
{u},
\displaystyle\mathcal{E}
\displaystyle\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{%
u}+(1-\alpha)]\theta\big{]}}{1-\theta-(1-\theta)\nu_{k+1}}+8\delta_{u},
n_{U}+1\leq k\leq n_{U}+r-1
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\min\{\theta+(1-\theta)\nu_{k+1},%
\theta\alpha+(1-\theta)\nu_{k-n_{U}}\}}+8\delta_{u},
\displaystyle\mathcal{E}
\displaystyle\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s}-2\delta_{%
u}+(1-\alpha)]\theta\big{]}}{1-\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(%
1-\theta)\nu_{k-n_{U}}\}}+8\delta_{u},
k\geq n_{U}+r
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\min\{\theta+(1-\theta)\nu_{k+1},%
\theta\alpha+(1-\theta)\nu_{k-n_{U}},(1-\theta)\nu_{k+1-r-n_{U}}\}}+8\delta_{u}.
\displaystyle\mathcal{E}\leq\frac{2\big{[}2\delta_{u}+[\alpha(1+\rho)\delta_{s%
}-2\delta_{u}+(1-\alpha)]\theta\big{]}}{1-\min\{\theta+(1-\theta)\nu_{k+1},%
\theta\alpha+(1-\theta)\nu_{k-n_{U}},(1-\theta)\nu_{k+1-r-n_{U}}\}}+8\delta_{u}.
\gamma=0
\alpha=1
k\leq n_{U}
\displaystyle\|B^{*}\|_{F}\leq 1/\lambda_{k}
\displaystyle\|B^{*}\|_{F}
\displaystyle\leq 1/\lambda_{k}
\displaystyle\leq 1/\max\Big{\{}\theta+(1-\theta)\nu_{n_{L}+k-1},(1-\theta)\nu%
_{k},\theta\alpha+(1-\theta)\nu_{n_{L}+k-r}\Big{\}}
\displaystyle\leq 1/\max\Big{\{}\theta+(1-\theta)\nu_{n_{L}+k-1},(1-\theta)\nu%
_{k},\theta\alpha+(1-\theta)\nu_{n_{L}+k-r}\Big{\}}
\displaystyle\leq 1/\max\Big{\{}\theta+(1-\theta)\nu_{n_{L}+k-1},(1-\theta)\nu%
_{k},\theta+(1-\theta)\nu_{n_{L}+k-r}\Big{\}}
\displaystyle\leq 1/\max\Big{\{}\theta+(1-\theta)\nu_{n_{L}+k-1},(1-\theta)\nu%
_{k},\theta+(1-\theta)\nu_{n_{L}+k-r}\Big{\}}
\displaystyle\leq 1/\max\Big{\{}(1-\theta)\nu_{k},\theta+(1-\theta)\nu_{n_{L}+%
k-r}\Big{\}}.
\displaystyle\leq 1/\max\Big{\{}(1-\theta)\nu_{k},\theta+(1-\theta)\nu_{n_{L}+%
k-r}\Big{\}}.
n_{U}=0
k>r
\displaystyle\|B^{*}\|_{F}\leq 1/\lambda_{k}\leq 1/(1-\theta)\nu_{k}.
\displaystyle\|B^{*}\|_{F}\leq 1/\lambda_{k}\leq 1/(1-\theta)\nu_{k}.
\kappa>0
\|f\|_{\infty}\leq\kappa
f\in\mathcal{F}
x\in\mathcal{X}
f^{*}_{pop}\in\mathcal{F}
\mathcal{L}(f)
n
\hat{f}_{emp}\in\mathcal{F}
\widehat{\mathcal{L}}_{n}(f)
1-\varepsilon
\displaystyle\mathcal{L}(\hat{f}_{emp})\leq\mathcal{L}(f^{*}_{pop})+c_{1}\cdot%
\widehat{R}_{n/2}(\mathcal{F})+c_{2}\cdot\bigg{(}\sqrt{\frac{\log 2/\delta}{n}%
}+\varepsilon\bigg{)},
\displaystyle\mathcal{L}(\hat{f}_{emp})\leq\mathcal{L}(f^{*}_{pop})+c_{1}\cdot%
\widehat{R}_{n/2}(\mathcal{F})+c_{2}\cdot\bigg{(}\sqrt{\frac{\log 2/\delta}{n}%
}+\varepsilon\bigg{)},
c_{1}\lesssim k^{2}\kappa^{2}+k\kappa
c_{2}\lesssim k\kappa^{2}+k^{2}\kappa^{4}
\hat{f}\in\operatornamewithlimits{arg\,min}_{f:\mathcal{X}\to\mathbb{R}^{k}}%
\widehat{\mathcal{L}}_{n}(f)
\mathcal{L}(\hat{f})\leq\min_{f:\mathcal{X}\to\mathbb{R}^{k}}\mathcal{L}(f)+%
\epsilon_{0}
\displaystyle\widehat{\mathcal{E}}\leq\min_{1\leq k^{\prime}\leq k}\bigg{(}%
\frac{2\phi^{\hat{y}}}{1-\lambda_{k^{\prime}+1}}+\frac{4k^{\prime}\epsilon_{0}%
}{\big{(}\lambda_{k^{\prime}}-\lambda_{k+1}\big{)}^{2}}\bigg{)}+8\delta_{u}.
\displaystyle\widehat{\mathcal{E}}\leq\min_{1\leq k^{\prime}\leq k}\bigg{(}%
\frac{2\phi^{\hat{y}}}{1-\lambda_{k^{\prime}+1}}+\frac{4k^{\prime}\epsilon_{0}%
}{\big{(}\lambda_{k^{\prime}}-\lambda_{k+1}\big{)}^{2}}\bigg{)}+8\delta_{u}.
n_{U}=0
k\geq r
\displaystyle(1-\theta)\nu_{k+1}\leq\lambda_{k+1}\leq\min\{\theta+(1-\theta)%
\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k},(1-\theta)\nu_{k+1-r}\}.
\displaystyle(1-\theta)\nu_{k+1}\leq\lambda_{k+1}\leq\min\{\theta+(1-\theta)%
\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k},(1-\theta)\nu_{k+1-r}\}.
k^{\prime}\leq k
\lambda_{k^{\prime}}>\lambda_{k+1}
\displaystyle\lambda_{k^{\prime}}-\lambda_{k+1}\geq(1-\theta)\nu_{k^{\prime}}-%
\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k},(1-\theta)\nu_%
{k+1-r}\}\big{.}
\displaystyle\lambda_{k^{\prime}}-\lambda_{k+1}\geq(1-\theta)\nu_{k^{\prime}}-%
\min\{\theta+(1-\theta)\nu_{k+1},\theta\alpha+(1-\theta)\nu_{k},(1-\theta)\nu_%
{k+1-r}\}\big{.}
1\leq k^{\prime}\leq k+1-r
\geq 0
L_{\mathrm{SimCLR}}
L_{\mathrm{SimCLR}}
\{x_{i}\}_{i=1}^{n}
L_{\mathrm{SupCon}}
\{(x_{i},y_{i})\}_{i=1}^{n_{L}}
\{(x_{i},y_{i})\}_{i=1}^{n_{L}}
\{x_{i}\}_{i=n_{L}+1}^{n}
\theta
f
\{(x_{i},y_{i})\}_{i=1}^{n_{L}}
\{x_{i}\}_{i=1}^{n}
f
(1-\theta)\frac{1}{n_{L}}\sum_{i=1}^{n_{L}}\mathcal{L}_{\mathrm{SupCon}}(f(x_{%
i}),y_{i})+\theta\frac{1}{n}\sum_{i=1}^{n}\mathcal{L}_{\mathrm{SimCLR}}(f(x_{i%
}))
f
L_{\mathrm{SupCon}}
{(x_{i},\tilde{y}_{i})}_{i=1}^{n}
L_{\mathrm{SimCLR}}
\{(x_{i},\tilde{y}_{i})\}_{i=1}^{n}
\theta
f
\{(x_{i},\tilde{y}_{i})\}_{i=1}^{n}
\{x_{i}\}_{i=1}^{n}
f
(1-\theta)\frac{1}{n}\sum_{i=1}^{n}\mathcal{L}_{\mathrm{SupCon}}(f(x_{i}),%
\tilde{y}_{i})+\theta\frac{1}{n}\sum_{i=1}^{n}\mathcal{L}_{\mathrm{SimCLR}}(f(%
x_{i}))
f
\theta=0.2
\gamma\in\{20\%,40\%,60\%,80\%\}
\gamma
\gamma
\gamma
