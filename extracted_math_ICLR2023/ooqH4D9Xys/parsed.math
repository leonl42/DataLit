+
C
N
X=\{x_{1},x_{2},\cdots,x_{N}\}
Y=\{y_{1},y_{2},\cdots,y_{N}\}
P\left(y\thinspace|\thinspace{x,\theta}\right)
y
x
\theta
\mathbb{S}=\left\{1,\cdots,S\right\}
z^{\ast}(x,\theta)
z^{\ast}(x,\theta)
\pi_{z}
z
\mathcal{L}\left(\Theta\right)=-\mathbb{E}_{\left(x,y\right)\sim\left(X,Y%
\right)}\mathrm{log}\left(\sum\limits_{z\in\mathbb{S}}{\pi_{z}P\left(y%
\thinspace|\thinspace{o_{z}\left(x\right),\theta}\right)}\right)
o_{z}(x)
z
\Theta=\{\theta,\pi\}
\pi=\{\pi_{1},\cdots,\pi_{S}\}
\Theta^{(t)}=\{\theta^{(t)},\pi^{(t)}\}
t
h_{z}^{(t)}(x,y,\Theta^{\left(t\right)},\mathbb{S})
z
x
y
t
h_{z}^{(t)}(x,y,\Theta^{\left(t\right)},\mathbb{S})=\frac{\pi_{z}^{(t)}P\left(%
y\thinspace|\thinspace{o_{z}\left(x\right),\theta^{(t)}}\right)}{\sum\limits_{%
z\in\mathbb{S}}{\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x\right)%
,\theta^{(t)}}\right)}}.
h_{z}^{(t)}
\mathcal{E}\left(\Theta|\Theta^{\left(t\right)}\right)
\mathcal{E}\left(\Theta|\Theta^{\left(t\right)}\right)=-\mathbb{E}_{\left(x,y%
\right)\sim\left(X,Y\right)}\left[\sum\limits_{z\in\mathbb{S}}{h_{z}^{(t)}\log%
\left(\pi_{z}\right)}\right.\left.+\sum\limits_{z\in\mathbb{S}}{h_{z}^{(t)}%
\log\left(P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta}\right)%
\right)}\right].
\theta
\pi_{z}
h_{z}^{(t)}
\mathcal{E}\left(\Theta|\Theta^{\left(t\right)}\right)
\Theta^{(t+1)}
\mathcal{E}\left(\Theta^{(t+1)}|\Theta^{\left(t\right)}\right)<\mathcal{E}%
\left(\Theta|\Theta^{\left(t\right)}\right)
\mathcal{E}\left(\Theta|\Theta^{(t)}\right)
\mathbb{S}
\mathcal{E}\left(\Theta|\Theta^{(t)}\right)
\mathbb{K}
\mathbb{S}
h_{z}^{(t)}
h_{z}^{\left(t\right)}\left(x,y,\Theta^{\left(t\right)},\mathbb{K}\right)=%
\frac{\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta^{%
\left(t\right)}}\right)}{\sum\limits_{z\in\mathbb{K}}{\pi_{z}^{(t)}P\left(y%
\thinspace|\thinspace{o_{z}\left(x\right),\theta^{\left(t\right)}}\right)}}.
\mathbb{K}
\mathbb{S}
\mathcal{L}_{z}^{(t)}=-\log\left(\pi_{z}^{(t)}\cdot P\left(y\thinspace|%
\thinspace{o_{z}\left(x\right),\theta^{(t)}}\right)\right)
\left(x,y\right)
z
t
\tilde{h}^{(t)}_{z}
z
\mathbb{K}
\tilde{h}^{(t)}_{z}=\Pr[\mathcal{L}^{(t)}_{z}\geq\mathcal{L}^{(t)}_{k},\forall
k%
\in\mathbb{K}]=\Pr[h^{(t)}_{z}\leq h^{(t)}_{k},\forall k\in\mathbb{K}]=\frac{%
\exp(-h^{(t)}_{z}/\sigma)}{\sum_{k\in\mathbb{K}}\exp(-h^{(t)}_{k}/\sigma)},
\sigma
\mathcal{L}_{z}
h_{z}
\mathcal{L}_{z}
\tilde{h}^{(t)}_{z}
\tilde{h}_{z}^{\left(t\right)}
h_{z}^{\left(t\right)}
\tilde{\mathcal{E}}\left(\Theta|\Theta^{(t)}\right)=-\mathbb{E}_{\left(x,y%
\right)\sim\left(X,Y\right)}\mathbb{E}_{\mathbb{K}\sim\mathbb{S}}\left[\sum%
\limits_{z\in\mathbb{K}}{\tilde{h}_{z}^{\left(t\right)}\log\left(\pi_{z}\right%
)}\right.\left.+\sum\limits_{z\in\mathbb{K}}{\tilde{h}_{z}^{\left(t\right)}%
\log\left(P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta}\right)%
\right)}\right].
\tilde{h}_{z}^{(t)}
\theta^{(t+1)}=\theta^{(t)}-\eta\mathrm{\nabla}_{\theta}\tilde{\mathcal{E}}%
\left(\Theta|\Theta^{(t)}\right),\pi_{z}^{(t+1)}=\mathrm{Moving\,Average\,of}%
\,\frac{\mathbb{E}_{\left(x,y\right)\sim\left(X_{B},Y_{B}\right)}\tilde{h}_{z}%
^{\left(t\right)}}{\mathbb{E}_{\left(x,y\right)\sim\left(X_{B},Y_{B}\right)}%
\sum\limits_{z\in\mathbb{K}}\tilde{h}_{z}^{(t)}},
\left(X_{B},Y_{B}\right)
\left(X,Y\right)
B
\mathbb{S}
S
\sigma
\pi_{z}=1/S
z=\{1,\mathellipsis,S\}
\theta^{(0)}
t=1,\mathellipsis,B
\mathbb{K}
\mathbb{S}
\tilde{h}_{z}^{(t)}
\tilde{\mathcal{E}}
\theta^{(t)}
\pi^{(t)}
\theta^{(B)}
\pi^{(B)}
\pi_{z}
K=2)
K=4)
K=6)
\tilde{h}_{z}^{\left(t\right)})
\pi_{z}=1/S,\forall z
\sigma\to 0
\sigma\to\infty
\sigma\to\infty
S=16\times 16=256
\pi_{z})
1\mathord{\left/{\vphantom{1S}}\right.\kern-1.2pt}S
\pi_{z})
\mathbb{S}
S=256
\mathbb{K}
\mathbb{S}
K=6)
\sigma
+
K=8
K)
K)
K)
K)
K=6
K
K\in\{2,4,6,8\}
K=6
K
K
K=6
K\in\{2,4,8,16,32\}
K=4
K=8
K=4
K=8
\sigma
\sigma=1
\sigma\to 0
\sigma)
\sigma)
\pi_{s})
\theta)
\pi_{z})
\sigma)
\pi_{z}
\sigma=1
\pi_{z}
\pi_{z}
\pi_{z}
\pi_{z}
\sigma
\sigma)
\sigma=0
\sigma=1
\pi_{z}
\pi_{z}
\delta_{z}
z
\delta_{z}
h_{z}^{\left(t\right)}=\frac{\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}%
\left(x\right),\theta^{\left(t\right)}}\right)}{\sum\limits_{z\in\mathbb{S}}{%
\delta_{z}\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x\right),%
\theta^{\left(t\right)}}\right)}}.
\delta_{z}
\begin{split}\mathcal{E}\left(\Theta|\Theta^{(t)},\delta_{z}\right)&=-\mathbb{%
E}_{\left(x,y\right)\sim\left(X,Y\right)}\sum\limits_{z\in\mathbb{S}}{\delta_{%
z}h_{z}^{\left(t\right)}\log\left(\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o%
_{z}\left(x\right),\theta}\right)\right)}\\
&=-\mathbb{E}_{\left(x,y\right)\sim\left(X,Y\right)}\sum\limits_{z\in\mathbb{S%
}}{\frac{\delta_{z}\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x%
\right),\theta^{\left(t\right)}}\right)}{\sum\limits_{z\in\mathbb{S}}{\delta_{%
z}\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta^{\left%
(t\right)}}\right)}}\log\left(\pi_{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}%
\left(x\right),\theta}\right)\right)}.\end{split}
\delta_{z}=\delta,\,\forall z\in\mathbb{S}
\mathcal{E}\left(\Theta|\Theta^{(t)},\delta\right)=-\mathbb{E}_{\left(x,y%
\right)\sim\left(X,Y\right)}\sum\limits_{z\in\mathbb{S}}{\frac{\delta\pi_{z}^{%
(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta^{\left(t\right)}}%
\right)}{\delta\sum\limits_{z\in\mathbb{S}}{\pi_{z}^{(t)}P\left(y\thinspace|%
\thinspace{o_{z}\left(x\right),\theta^{\left(t\right)}}\right)}}\log\left(\pi_%
{z}^{(t)}P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta}\right)%
\right)}=\mathcal{E}\left(\Theta|\Theta^{\left(t\right)}\right).
\mathcal{L}_{UBS}=\mathbb{E}_{\left(x,y\right)\sim\left(X,Y\right)}\max_{z\in%
\mathbb{K}}\left[-\log\left(P\left(y\thinspace|\thinspace{o_{z}\left(x\right),%
\theta}\right)\right)\right].
\sigma\to 0
\tilde{h}_{z}
\lim_{\sigma\to 0}\tilde{h}_{z}=\lim_{\sigma\to 0}\frac{\exp\left(-\frac{h_{z}%
}{\sigma}\right)}{\sum\limits_{r\in\mathbb{K}}\exp\left(-\frac{h_{r}}{\sigma}%
\right)}=I\left[h_{z}\leq h_{r},\,\forall r\in\mathbb{K}\right],
I\left[\cdot\right]
I\left[\cdot\right]=1
h_{z}\leq h_{r},\,\forall r\in\mathbb{K}
I\left[\cdot\right]=0
\pi_{z}=1\mathord{\left/{\vphantom{1S}}\right.\kern-1.2pt}S
z
\sigma\to 0
\tilde{h}_{z}\to I\left[h_{z}\leq h_{r},\,\forall r\in\mathbb{K}\right]=I\left%
[P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta^{(t)}}\right)\leq P%
\left(y\thinspace|\thinspace{o_{r}\left(x\right),\theta^{(t)}}\right),\,%
\forall r\in\mathbb{K}\right]
\begin{split}\tilde{\mathcal{E}}\left(\Theta|\Theta^{(t)}\right)&\to-\mathbb{E%
}_{\left(x,y\right)\sim\left(X,Y\right)}\mathbb{E}_{\mathbb{K}\sim\mathbb{S}}%
\\
&\left[\sum\limits_{z\in\mathbb{K}}{I\left[P\left(y\thinspace|\thinspace{o_{z}%
\left(x\right),\theta^{\left(t\right)}}\right)\leq P\left(y\thinspace|%
\thinspace{o_{r}\left(x\right),\theta^{\left(t\right)}}\right),\,\forall r\in%
\mathbb{K}\right]\log\left(P\left(y\thinspace|\thinspace{o_{z}\left(x\right),%
\theta}\right)\right)}+\log\left(1\mathord{\left/{\vphantom{1S}}\right.\kern-1%
.2pt}S\right)\right],\end{split}
\left.\tilde{\mathcal{E}}\left(\Theta|\Theta^{(t)}\right)\right|_{\theta=%
\theta^{\left(t\right)}}\to\mathbb{E}_{\left(x,y\right)\sim\left(X,Y\right)}%
\mathbb{E}_{\mathbb{K}\sim\mathbb{S}}\max_{z\in\mathbb{K}}\left[-\log\left(P%
\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta^{\left(t\right)}}%
\right)\right)\right]-\log\left(1\mathord{\left/{\vphantom{1S}}\right.\kern-1.%
2pt}S\right).
\theta=\theta^{\left(t\right)}
\,\mathrm{\nabla}_{\theta}\left.\tilde{\mathcal{E}}\left(\Theta|\Theta^{(t)}%
\right)\right|_{\theta=\theta^{\left(t\right)}}\to\mathrm{\nabla}_{\theta}%
\left.\mathcal{L}_{UBS}\right|_{\theta=\theta^{\left(t\right)}}
\pi_{z}=1\mathord{\left/{\vphantom{1S}}\right.\kern-1.2pt}S
z
\sigma\to 0
\mathcal{L}_{AdvAA}=-\mathbb{E}_{\left(x,y\right)\sim\left(X,Y\right)}\mathbb{%
E}_{\mathbb{K}\sim\mathcal{A}\left(\mathbb{S},\mu\right)}\left[\frac{1}{K}\sum%
\limits_{z\in\mathbb{K}}\log\left(P\left(y\thinspace|\thinspace{o_{z}\left(x%
\right),\theta}\right)\right)\right],
\mathcal{A}\left(\mathbb{S},\mu\right)
\mathbb{S}
\mu
\sigma\to\infty
\tilde{h}_{z}\to 1\mathord{\left/{\vphantom{1K}}\right.\kern-1.2pt}K
\pi_{z}=1\mathord{\left/{\vphantom{1S}}\right.\kern-1.2pt}S
z
\mathbb{E}_{\mathbb{K}\sim\ \mathcal{A}\left(\mathbb{S},\mu\right)}\left[%
\tilde{\mathcal{E}}\left(\Theta|\Theta^{\left(t\right)}\right)\right]\to-%
\mathbb{E}_{\left(x,y\right)\sim\left(X,Y\right)}\mathbb{E}_{\mathbb{K}\sim%
\mathcal{A}\left(\mathbb{S},\mu\right)}\left[\frac{1}{K}\sum\limits_{z\in%
\mathbb{K}}\log\left(P\left(y\thinspace|\thinspace{o_{z}\left(x\right),\theta}%
\right)\right)\right]-\log\left(1\mathord{\left/{\vphantom{1S}}\right.\kern-1.%
2pt}S\right).
\mathrm{\nabla}_{\theta}\mathbb{E}_{\mathbb{K}\sim\mathcal{A}\left(\mathbb{S},%
\mu\right)}\left[\tilde{\mathcal{E}}\left(\Theta|\Theta^{\left(t\right)}\right%
)\right]\to\mathrm{\nabla}_{\theta}\mathcal{L}_{AdvAA}
\pi_{z}=1\mathord{\left/{\vphantom{1S}}\right.\kern-1.2pt}S
z
\sigma\to\infty
+
K=8
K=6
\pm
\pm
K=8
\pm
\pi_{z}
\pi_{z}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
