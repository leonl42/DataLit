2.54\%
3.91\%
\mathcal{C}_{b}^{O}
\mathcal{C}_{n}^{O}
\mathcal{C}_{b}^{P}
\mathcal{C}_{n}^{P}
\mathcal{C}_{b}^{O}\times\mathcal{C}_{b}^{P}\times\mathcal{C}_{b}^{O}
\mathcal{C}_{b}^{O}\cup\mathcal{C}_{n}^{O}
\mathcal{C}_{b}^{P}\cup\mathcal{C}_{n}^{P}
\bm{t}_{c}\in\mathbb{R}^{d}
c
\bm{t}_{c}=\text{VLM}_{\text{txt}}(\bm{W}_{c}),~{}\bm{W}_{c}=[\bm{w}_{1},%
\ldots,\bm{w}_{L},\tilde{\bm{w}}_{c}],\forall c\in\mathcal{C}_{b}^{O}\cup%
\mathcal{C}_{n}^{O}~{}\text{or}~{}\mathcal{C}_{b}^{P}\cup\mathcal{C}_{n}^{P},
\bm{W}_{c}
L
\tilde{\bm{w}}_{c}
\bm{v}_{i}\in\mathbb{R}^{d}
i,j
\bm{v}_{i,j}
i
\bm{v}_{i}
\{\bm{t}_{c}\}
\hat{c}_{i}=\arg\max_{c}\cos(\bm{v}_{i},\bm{t}_{c}),~{}\forall c\in\mathcal{C}%
_{b}^{O}\cup\mathcal{C}_{n}^{O}~{}\text{or}~{}\mathcal{C}_{b}^{P}\cup\mathcal{%
C}_{n}^{P},~{}\text{where}\cos(\bm{x},\bm{y})=\bm{x}^{\rm T}\bm{y}/(\|\bm{x}\|%
\|\bm{y}\|).
\bm{w}_{i}
\bm{W}_{c}
\tilde{\bm{w}}_{c}
\{\tilde{\bm{w}}_{c}\}
L
\bm{W}_{c}
\bm{v}_{i},\bm{v}_{i,j}
\phi_{o}
\phi_{p}
\bm{f}_{i},\bm{f}_{i,j}
\bm{f}^{s}_{i,j}
\bm{v}^{\prime}_{i}
\bm{v}_{i}
\bm{v}_{i,j}
\bm{v}_{i},\bm{v}_{i,j}
\phi_{o}
\phi_{p}
\bm{f}_{i},\bm{f}_{i,j}
\bm{f}^{s}_{i,j}
\bm{v}^{\prime}_{i}
\bm{v}_{i}
\bm{v}_{i,j}
\mathcal{T}=\{T_{i}\}_{i=1}^{N}
T_{i}
\bm{f}_{i}\in\mathbb{R}^{2048}
\phi_{o}(\cdot)
\phi_{o}(\cdot)
\bm{f}_{i}
\mathbb{R}^{d}
{\bm{v}^{\prime}_{i}}=\phi_{o}(\bm{f}_{i})
\bm{t}_{c}^{o}
c\in\mathcal{C}_{b}^{O}
T_{i}
c
p_{i}(c)=\frac{\exp(\cos({\bm{v}^{\prime}_{i}},\bm{t}^{o}_{c})/\tau)}{\sum_{c^%
{\prime}\in\mathcal{C}^{O}_{b}}\exp(\cos({\bm{v}^{\prime}_{i}},\bm{t}^{o}_{c^{%
\prime}})/\tau)},\forall c\in\mathcal{C}^{O}_{b},
\tau
1/|\mathcal{C}^{O}_{b}|
\mathcal{L}_{\text{cls-pos}}=-\frac{1}{|\mathcal{T}_{p}|}\sum_{T_{i}\in%
\mathcal{T}_{p}}\sum_{c\in\mathcal{C}^{O}_{b}}\mathbbm{1}_{\{c=c^{*}_{i}\}}%
\log p_{i}(c),\quad\mathcal{L}_{\text{cls-neg}}=-\frac{1}{|\mathcal{T}_{n}|}%
\sum_{T_{i}\in\mathcal{T}_{n}}\sum_{c\in\mathcal{C}^{O}_{b}}\frac{1}{|\mathcal%
{C}^{O}_{b}|}\log p_{i}(c),
\mathcal{T}_{p}
\mathcal{T}_{n}
\mathcal{T}_{p}\cup\mathcal{T}_{n}=\mathcal{T}
c^{*}_{i}
i
\phi_{o}(\cdot)
\bm{v}^{\prime}_{i}
\bm{v}_{i}
l_{1}
{\mathcal{L}_{\text{distill}}}=(1/N){\textstyle{\sum}}_{i=1}^{N}\|{\bm{v}^{%
\prime}_{i}-\bm{v}_{i}}\|_{1}
\mathcal{L}_{\text{cls}}=\mathcal{L}_{\text{cls-pos}}+\mathcal{L}_{\text{cls-%
neg}}+\lambda{\mathcal{L}_{\text{distill}}}
\lambda
\bm{S}_{c}
\bm{O}_{c}
c
\bm{S}_{c}=[\bm{s}_{1},\ldots,\bm{s}_{L},\tilde{\bm{w}}_{c}],\quad\bm{O}_{c}=[%
\bm{o}_{1},\ldots,\bm{o}_{L},\tilde{\bm{w}}_{c}],
\bm{s}_{i}
\bm{o}_{i}
\tilde{\bm{w}}_{c}
c
c\in\mathcal{C}_{b}^{P}
c
\bm{t}_{c}^{p}
\bm{t}_{c}^{p}=[\text{VLM}_{\text{txt}}(\bm{S}_{c}),\text{VLM}_{\text{txt}}(%
\bm{O}_{c})],~{}\text{and}~{}\bm{t}_{c}^{p}\in\mathbb{R}^{2d}.
T_{i},T_{j}
\bm{m}_{i,j}=\operatorname{sign}([G^{s}_{i,j}-\gamma,G^{e}_{i,j}-\gamma,G^{e}_%
{i,j}-G^{s}_{i,j}]),~{}~{}\text{and}~{}~{}\bm{m}_{i,j}\in\{+,-\}^{3},
G^{s}_{i,j},G^{e}_{i,j}
\gamma
\bm{S}_{c}
\bm{O}_{c}
T_{i},T_{j}
\bm{t}_{c}^{p}
c\in\mathcal{C}_{b}^{P}
\bm{v}_{i}
\bm{v}_{j}
{\bm{v}_{i,j}=[\bm{v}_{i},\bm{v}_{j}]\in\mathbb{R}^{2d}}
T_{i}
T_{j}
\bm{f}^{s}_{i,j}\in\mathbb{R}^{12}
c
p_{i,j}(c)=\text{Sigmoid}(\cos({\bm{v}_{i,j}}+\phi_{\text{pos}}(\bm{f}^{s}_{i,%
j}),\bm{t}_{c}^{p})),~{}\forall c\in\mathcal{C}_{b}^{P}.
\phi_{\text{pos}}
\bm{f}_{i,j}^{s}
{\bm{v}_{i,j}}
\mathcal{C}_{b}^{P}
T_{i},T_{j}
\bm{p}_{i,j}
\mathcal{P}_{p}
\mathcal{P}_{n}
\mathcal{P}_{p}
|\mathcal{C}_{b}^{P}|
\bm{p}^{*}_{i,j}
\mathcal{P}_{n}
\mathcal{L}_{\text{pred-cls}}=(1/|\mathcal{P}_{p}|){\textstyle\sum}_{(T_{i},T_%
{j})\in\mathcal{P}_{p}}\text{BCE}(\bm{p}_{i,j},\bm{p}^{*}_{i,j})+(1/|\mathcal{%
P}_{n}|){\textstyle\sum}_{(T_{i},T_{j})\in\mathcal{P}_{n}}\text{BCE}(\bm{p}_{i%
,j},\bm{0}).
\{\bm{f}_{i}\}
\{\tilde{\bm{t}}_{c}^{p}\}
T_{i},T_{j}
{\bm{f}_{i,j}=[\bm{f}_{i},\bm{f}_{j}]\in\mathbb{R}^{4096}}
\phi_{p}
c
p_{i,j}(c)=\text{Sigmoid}(\cos(\phi_{p}({\bm{f}_{i,j}})+\phi_{\text{pos}}(\bm{%
f}^{s}_{i,j}),\tilde{\bm{t}}_{c}^{p})),~{}\forall c\in\mathcal{C}_{b}^{P}.
\phi_{\text{pos}}
\phi_{p}
l_{1}
\phi_{p}({\bm{f}_{i,j}})
{\bm{v}_{i,j}}
{\bm{v}_{i,j}}
\phi_{o}
\phi_{o}
\mathcal{L}_{\text{cls-neg}}
\mathcal{L}_{\text{cls-neg}}
\times
\times
\times
\times
\mathcal{L}_{\text{cls-neg}}
1/|\mathcal{C}_{b}|
\mathcal{L}_{\text{cls-neg}}
\times
\times
\times
\times
\times
\times
\bm{W}_{c}
\bm{t}_{c}^{p}
{\bm{v}_{i,j}=\bm{v}_{i}-\bm{v}_{j}}
{\bm{v}_{i,j}}
\times
\times
\times
\times
\times
\times
\rightarrow
\rightarrow
\rightarrow
\rightarrow
T_{i},T_{j}
\displaystyle\bm{f}_{i,j}^{B}=\left[\frac{x_{i}-x_{j}}{x_{j}},\frac{y_{i}-y_{j%
}}{y_{j}},\log\frac{w_{i}}{w_{j}},\log\frac{h_{i}}{h_{j}},\log\frac{w_{i}h_{i}%
}{w_{j}h_{j}},\frac{t_{i}-t_{j}}{L_{\text{seg}}}.\right],
\displaystyle\bm{f}_{i,j}^{B}=\left[\frac{x_{i}-x_{j}}{x_{j}},\frac{y_{i}-y_{j%
}}{y_{j}},\log\frac{w_{i}}{w_{j}},\log\frac{h_{i}}{h_{j}},\log\frac{w_{i}h_{i}%
}{w_{j}h_{j}},\frac{t_{i}-t_{j}}{L_{\text{seg}}}.\right],
(x_{i},y_{i})
T_{i}
(w_{i},h_{i})
t_{i}
(x_{j},y_{j},w_{j},h_{j},t_{j})
T_{j}
L_{\text{seg}}
L_{\text{seg}}=30
T_{i},T_{j}
\bm{f}_{i,j}^{B}
\bm{f}_{i,j}^{E}
T_{i},T_{j}
\bm{f}^{s}_{i,j}=[\bm{f}_{i,j}^{B},\bm{f}_{i,j}^{E}]
\bm{f}^{s}_{i,j}\in\mathbb{R}^{12}
\bm{m}_{i,j}
[+,-,+]
[-,+,-]
\phi_{o},\phi_{p}
\phi_{\text{pos}}
\lambda
L
\tau
\gamma
\gamma
