\alpha
\alpha_{i}
i
i
\alpha^{\mathrm{new}}_{i}
\alpha^{\mathrm{old}}_{i}
\epsilon
\alpha
\alpha_{i}
i
i
\alpha^{\mathrm{new}}_{i}
\alpha^{\mathrm{old}}_{i}
\epsilon
N
{t_{1},...,t_{N}}
i
\mathcal{M}_{i}=\langle\mathcal{S}_{i},\mathcal{A}_{i},\mathcal{T}_{i},r_{i},\gamma\rangle
\mathcal{S}_{i}
\mathcal{A}_{i}
\mathcal{T}_{i}:\mathcal{S}_{i}\times\mathcal{A}_{i}\rightarrow\mathcal{P}(%
\mathcal{S}_{i})
r_{i}:\mathcal{S}_{i}\times\mathcal{A}_{i}\rightarrow\mathbb{R}
\Pi:[1..N]\times\mathcal{Z}\rightarrow(\mathcal{S}\rightarrow\mathcal{P}(%
\mathcal{A}))
i
\mathcal{Z}
i
\mathcal{P}(\mathcal{A})
i
b_{i}
t_{i+1}
\mathcal{M}_{i}
\theta\in\mathbb{R}^{d}
\pi(a|s,\theta)
\mathbb{R}^{d}
\Theta=\{\theta_{1},...,\theta_{k}\}
\alpha\in\mathbb{R}^{k}_{+}
\|\alpha\|_{1}=1
\alpha
\pi(a|s,[\alpha,\Theta])=\pi(a|s,\sum\alpha_{i}\theta_{i})
\alpha
\pi(a|s,[\alpha,\Theta])
\Theta_{1},...,\Theta_{N}
\Theta_{j}
j
|\Theta_{j}|\leq j,\;\forall\;j\in 1...N
m
\Theta_{j}
j
\Theta_{j}
\alpha
i
j
\forall\,i\leq j
\pi^{j}_{i}(a|s)
\Theta_{j}
\alpha^{j}_{i}
\pi^{j}_{i}(a|s)=\pi(a|s,[\alpha^{j}_{i},\Theta_{j}])
|\alpha^{j}_{i}|=|\Theta_{j}|\leq j
\Theta_{j}
\{\alpha_{1}^{j},...\ ,\alpha_{j}^{j}\}
t_{j+1}
\Theta_{j+1}
\{\alpha_{1}^{j+1},...\ ,\alpha_{j+1}^{j+1}\}
t_{j+1}
t_{j+1}
t_{j+1}
{j+1}
j
\Theta_{j}
m\leq j
j
\tilde{\Theta}_{j+1}
\theta_{j+1}
\tilde{\Theta}_{j+1}=\Theta_{j}\bigcup\{\theta_{j+1}\}
\alpha
j+1
Dir\bigl{(}\mathcal{U}(j+1)\bigr{)}
\theta_{j+1}
j+1
\alpha
\theta_{j+1}=\operatorname*{arg\,max}\limits_{\theta}\mathbb{E}_{\alpha\sim Dir%
,\,\tau\sim\pi(a|s,[\alpha,\Theta_{j}\bigcup\{\theta\}])}\left[R_{j+1}(\tau)\right]
R_{j+1}(\tau)
j+1
\tau
\pi(a|s,[\alpha,\tilde{\Theta}_{j+1})]
\alpha
\alpha
j+1
j+1
j
\Theta_{j}
Q
Q(s,a,\alpha)
j
\alpha
\alpha
\mathcal{B}
Q
Q(s,a,\alpha)
W(\alpha)
\alpha
W(\alpha)=\mathbb{E}_{s,a\sim\mathcal{B}}Q(s,a,\alpha).
\alpha
\alpha^{\mathrm{new}}\in\mathbb{R}^{m+1}_{+},\|\alpha^{\mathrm{\mathrm{new}}}%
\|_{1}=1
\alpha^{\mathrm{new}}=\operatorname*{arg\,max}_{\alpha\in\mathbb{R}^{m+1}_{+},%
\|\alpha\|_{1}=1}W(\alpha),
\alpha
\alpha^{\mathrm{old}}\in\mathbb{R}^{m}_{+},\|\alpha^{\mathrm{old}}\|_{1}=1
\alpha^{\mathrm{old}}=\operatorname*{arg\,max}_{(\alpha,0)\text{ with }\alpha%
\in\mathbb{R}^{m}_{+},\|\alpha\|_{1}=1}W(\alpha).
\alpha^{\mathrm{new}}
\alpha^{\mathrm{old}}
\alpha
W(\alpha^{\mathrm{new}})
W(\alpha^{\mathrm{old}})
W(\alpha^{\mathrm{new}})>(1+\epsilon)\cdot W(\alpha^{\mathrm{old}})
\Theta_{j+1}=\tilde{\Theta}_{j+1}
\Theta_{j+1}=\Theta_{j}
\alpha_{i}^{j+1}\in\mathbb{R}^{j+1}_{+}
\forall\;i\leq j,\;\alpha_{i}^{j+1}:=(\alpha_{i}^{j},0)
\alpha^{j+1}_{j+1}:=\alpha^{\mathrm{new}}
\forall\;i\leq j,\;\alpha_{i}^{j+1}:=\alpha_{i}^{j}
\alpha^{j+1}_{j+1}:=\alpha^{\mathrm{old}}
\alpha
\pi_{\theta_{j+1}}
W_{\phi}
\epsilon
\epsilon
L_{2}
\epsilon
\pi^{j}_{i}\coloneqq\Pi(i,[t_{1},\ldots,t_{j}])
\Pi
i
t_{1},...,t_{j}
j
\Pi
\pi^{t_{i}}_{i}\coloneqq\Pi(i,[t_{i}])
i
t_{i}
b_{i}
P_{i}(\pi)
i
\pi
P_{i}(\pi):=\mathbb{E}_{\pi,\mathcal{T}_{i}}\left[\sum r_{i}\left(s,a\right)\right]
r_{i}(s,a)
i
a
s
P:=\frac{1}{N}\sum_{i=1}^{N}P_{i}(\pi^{N}_{i})
|\Theta_{N}|
0.62\pm 0.29
1.0
0.52\pm 0.26
1.0
0.71\pm 0.07
1.0
0.38\pm 0.15
2.0
0.78\pm 0.20
2.0
0.68\pm 0.28
2.0
0.85\pm 0.14
2.0
1.08\pm 0.21
2.0
0.96\pm 0.21
2.0
0.43\pm 0.24
3.0
0.55\pm 0.24
3.0
0.94\pm 0.01
3.0
1.03\pm 0.14
8.0
0.98\pm 0.31
8.0
0.98\pm 0.26
4.0
1.00\pm 0.15
8.0
1.00\pm 0.38
8.0
1.00\pm 0.29
4.0
1.16\pm 0.20
8.0
0.97\pm 0.20
8.0
0.65\pm 0.46
4.0
1.27\pm 0.27
5.4\pm 1.3
1.11\pm 0.17
3.9\pm 0.8
1.76\pm 0.19
3.4\pm 0.3
1.88\pm 0.19
1.24\pm 0.07
1.98\pm 0.22
0.81\pm 0.06
0.83\pm 0.02
0.66\pm 0.03
0.48\pm 0.05
0.10\pm 0.01
5.3\pm 1.6
10
10
10
10
\epsilon
\epsilon
\epsilon
70\%
70\%
\epsilon
\epsilon=0.1
128
0.5
\alpha=0.2
i
t_{1},...,t_{i}
t_{i}
\mathrm{T}_{i}:=P_{i}(\pi^{i}_{i})-P_{i}(\pi^{t_{i}}_{i})
\mathrm{T}:=\frac{1}{N}\sum_{i=1}^{N}\mathrm{T}_{i}
i
\pi^{i}_{i}
\pi^{N}_{i}
\mathrm{F}_{i}:=P_{i}(\pi^{i}_{i})-P_{i}(\pi^{N}_{i})
\mathrm{F}:=\frac{1}{N}\sum_{i=1}^{N}\mathrm{F}_{i}
\left\{0.0003,0.001\right\}
\left\{0.0003,0.001\right\}
\left\{1.,10.\right\}
\left\{0.05,0.1\right\}
\left\{2,4\right\}
\left\{2,4\right\}
0.0003
0.005
256
128^{*}
0.5^{*}
0.99
1M
12,800
\left\{10^{-2},10^{0},10^{2},10^{4},10^{6}\right\}
\left\{0.1,0.25\right\}
\left\{20,100\right\}
0.001
0.0003
0.001
0.0003
0.0003
0.0003
0.001
0.0003
1.
1.
1.
10.
0.1
0.05
0.1
0.1
2
2
4
4
2
2
2
4
10^{4}
10^{0}
10^{2}
10^{2}
10^{-2}
10^{0}
10^{-2}
10^{0}
0.1
0.1
0.1
0.1
100
20
20
100
0.001
0.001
0.001
0.0003
0.001
0.001
0.001
0.0003
10.
1.
1.
10.
0.05
0.05
0.1
0.1
2
2
2
4
4
2
4
4
10^{4}
10^{0}
10^{0}
10^{2}
10^{-2}
10^{4}
10^{2}
10^{-2}
0.1
0.1
0.1
0.1
100
100
100
20
0.001
0.0003
0.1
0.1
1
1
10^{-2}
10^{-2}
0.1
100
\left[0.5,1.5\right]
\left[0.5,1.5\right]
\left[0.15,1.5\right]
\left[0.4,1.5\right]
\left\{1,-1\right\}
-1
\left[0.1,0.8\right]
\left[0.25,0.75\right]
1M
8M
2M
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\blacksquare
\theta_{1}
\theta_{j}
\epsilon
W_{\phi}
\mathcal{B}
\theta_{j+1}\leftarrow\frac{1}{j}\sum^{j}_{i=1}\theta_{i}
i=1,...,B
\alpha\sim Dir\bigl{(}\mathcal{U}(j+1)\bigr{)}
\theta_{\alpha}\leftarrow\sum^{j+1}_{i=1}\alpha_{i}\theta_{i}
l=1,...,K
(s,a,r,s^{\prime},\alpha)
\mathcal{B}
a\sim\pi_{\theta_{\alpha}}\left(\cdot|s\right)
\pi_{\theta_{j+1}}
W_{\phi}
\mathcal{B}
\mathcal{B}
W_{\phi}
\displaystyle\alpha^{\mathrm{old}}\leftarrow\operatorname*{arg\,max}_{(\alpha,%
0)\text{ with }\alpha\in\mathbb{R}^{m}_{+},\|\alpha\|_{1}=1}W_{\phi}(\alpha)
\displaystyle\alpha^{\mathrm{old}}\leftarrow\operatorname*{arg\,max}_{(\alpha,%
0)\text{ with }\alpha\in\mathbb{R}^{m}_{+},\|\alpha\|_{1}=1}W_{\phi}(\alpha)
\displaystyle\alpha^{\mathrm{new}}\leftarrow\operatorname*{arg\,max}_{\alpha%
\in\mathbb{R}^{m+1}_{+},\|\alpha\|_{1}=1}W_{\phi}(\alpha)
\displaystyle\alpha^{\mathrm{new}}\leftarrow\operatorname*{arg\,max}_{\alpha%
\in\mathbb{R}^{m+1}_{+},\|\alpha\|_{1}=1}W_{\phi}(\alpha)
W_{\phi}(\cdot,\alpha^{\mathrm{new}})>(1+\epsilon)\cdot W_{\phi}(\cdot,\alpha^%
{\mathrm{old}})
\theta_{1},\ldots,\theta_{j},\theta_{j+1},\alpha^{\mathrm{new}}
\theta_{1},\ldots,\theta_{j},\alpha^{\mathrm{old}}
\epsilon
\epsilon
\epsilon=0.1
W_{\phi}
\alpha
(s,a)
\alpha
{\theta}_{j+1}
{\Theta}_{j}
{\Theta}_{j}
\alpha^{old}
{\Theta}_{j+1}
\alpha^{new}
(s,a)
\alpha
k:=8
1M
1000
0.8\%
\alpha^{old}
\mathbb{R}^{3}
(s,a)
0.52\pm 0.08
1.0\pm 0.0
0.19\pm 0.23
0.67\pm 0.19
0.67\pm 0.32
2.0\pm 0.0
-0.34\pm 0.3
-0.01\pm 0.0
0.94\pm 0.18
2.0\pm 0.0
-0.07\pm 0.17
-0.0\pm 0.0
1.00\pm 0.05
4.0\pm 0.0
0.00\pm 0.05
-0.0\pm 0.0
0.64\pm 0.26
3.0\pm 0.0
-0.27\pm 0.31
0.09\pm 0.13
0.96\pm 0.15
8.0\pm 0.0
-0.04\pm 0.13
0.0\pm 0.0
1.0\pm 0.1
8.0\pm 0.0
-0.0\pm 0.09
-0.0\pm 0.0
1.25\pm 0.24
8.0\pm 0.0
0.25\pm 0.23
0.0\pm 0.0
1.60\pm 0.12
4.5\pm 2.0
0.38\pm 0.08
-0.22\pm 0.15
1.41\pm 0.07
0.41\pm 0.06
0.00\pm 0.0
0.86\pm 0.7
1.0\pm 0.0
0.52\pm 0.62
0.66\pm 0.42
-0.03\pm 0.07
2.0\pm 0.0
-1.00\pm 0.03
-0.03\pm 0.04
0.99\pm 0.25
2.0\pm 0.0
-0.01\pm 0.24
0.0\pm 0.0
1.03\pm 0.12
4.0\pm 0.0
0.03\pm 0.12
0.0\pm 0.0
-0.13\pm 0.23
3.0\pm 0.0
-1.13\pm 0.21
0.0\pm 0.02
1.05\pm 0.14
8.0\pm 0.0
0.04\pm 0.13
-0.0\pm 0.0
1.0\pm 0.15
8.0\pm 0.0
-0.0\pm 0.14
-0.0\pm 0.0
1.39\pm 0.34
8.0\pm 0.0
0.39\pm 0.33
0.0\pm 0.01
3.75\pm 0.49
4.9\pm 1.1
2.09\pm 0.71
-0.66\pm 0.6
1.95\pm 0.83
0.93\pm 0.79
-0.01\pm 0.03
0.36\pm 0.25
1.0\pm 0.0
-0.11\pm 0.2
0.53\pm 0.25
0.22\pm 0.16
2.0\pm 0.0
-0.79\pm 0.15
-0.0\pm 0.0
0.65\pm 0.11
2.0\pm 0.0
-0.35\pm 0.1
0.0\pm 0.0
0.73\pm 0.12
4.0\pm 0.0
-0.27\pm 0.12
0.0\pm 0.0
0.68\pm 0.28
3.0\pm 0.0
-0.31\pm 0.23
0.01\pm 0.09
1.14\pm 0.1
8.0\pm 0.0
0.14\pm 0.1
0.0\pm 0.0
1.0\pm 0.29
8.0\pm 0.0
0.0\pm 0.28
0.0\pm 0.0
0.98\pm 0.12
8.0\pm 0.0
-0.02\pm 0.11
-0.0\pm 0.0
1.28\pm 0.09
7.4\pm 0.5
0.19\pm 0.08
-0.09\pm 0.08
1.01\pm 0.13
0.01\pm 0.12
-0.0\pm 0.01
0.75\pm 0.12
1.0\pm 0.0
-0.04\pm 0.09
0.22\pm 0.11
0.66\pm 0.03
-0.35\pm 0.03
0.01\pm 0.03
0.79\pm 0.03
2.0\pm 0.0
-0.21\pm 0.03
-0.0\pm 0.0
0.88\pm 0.08
4.0\pm 0.0
-0.12\pm 0.08
0.0\pm 0.0
0.53\pm 0.17
3.0\pm 0.0
-0.34\pm 0.09
0.13\pm 0.12
0.97\pm 0.16
8.0\pm 0.0
-0.03\pm 0.16
0.0\pm 0.0
1.0\pm 0.05
8.0\pm 0.0
-0.0\pm 0.05
-0.0\pm 0.0
1.01\pm 0.09
8.0\pm 0.0
0.01\pm 0.09
0.0\pm 0.0
0.87\pm 0.07
3.4\pm 1.5
-0.1\pm 0.07
0.03\pm 0.06
0.69\pm 0.09
-0.31\pm 0.09
0.0\pm 0.0
0.62\pm 0.29
1.0\pm 0.0
0.14\pm 0.29
0.52\pm 0.24
0.38\pm 0.15
2.0\pm 0.0
-0.62\pm 0.13
-0.01\pm 0.02
0.85\pm 0.14
2.0\pm 0.0
-0.15\pm 0.09
0.0\pm 0.0
0.91\pm 0.09
4.0\pm 0.0
-0.09\pm 0.09
0.0\pm 0.0
0.43\pm 0.24
3.0\pm 0.0
-0.51\pm 0.21
0.06\pm 0.09
1.03\pm 0.14
8.4\pm 0.0
0.03\pm 0.13
0.0\pm 0.0
1.0\pm 0.15
8.0\pm 0.0
0.0\pm 0.14
0.0\pm 0.0
1.16\pm 0.2
8.0\pm 0.0
0.16\pm 0.19
0.0\pm 0.0
1.88\pm 0.19
5.4\pm 1.3
0.64\pm 0.24
-0.24\pm 0.22
1.27\pm 0.27
0.27\pm 0.26
0.0\pm 0.01
1.31\pm 0.33
1.0\pm 0.0
0.36\pm 0.2
0.05\pm 0.23
0.76\pm 0.27
2.0\pm 0.0
-0.24\pm 0.24
0.0\pm 0.04
1.13\pm 0.2
2.0\pm 0.0
0.13\pm 0.19
0.0\pm 0.0
1.12\pm 0.21
3.0\pm 0.0
0.3\pm 0.15
0.17\pm 0.22
0.97\pm 0.2
8.0\pm 0.0
-0.03\pm 0.19
0.0\pm 0.0
1.0\pm 0.17
8.0\pm 0.0
-0.0\pm 0.16
0.0\pm 0.0
1.36\pm 0.26
8.0\pm 0.0
0.36\pm 0.25
-0.0\pm 0.0
1.24\pm 0.08
3.7\pm 1.2
0.11\pm 0.06
-0.13\pm 0.02
1.03\pm 0.14
0.03\pm 0.13
0.0\pm 0.0
0.08\pm 0.14
1.0\pm 0.0
-0.28\pm 0.2
0.64\pm 0.15
0.44\pm 0.12
2.0\pm 0.0
-0.44\pm 0.07
0.12\pm 0.09
0.89\pm 0.09
2.0\pm 0.0
-0.11\pm 0.09
-0.0\pm 0.0
0.22\pm 0.05
3.0\pm 0.0
-0.78\pm 0.04
0.0\pm 0.0
1.02\pm 0.05
8.0\pm 0.0
0.02\pm 0.05
0.0\pm 0.0
1.0\pm 0.08
8.0\pm 0.0
0.0\pm 0.07
-0.0\pm 0.0
0.83\pm 0.12
8.0\pm 0.0
-0.17\pm 0.12
-0.0\pm 0.0
1.02\pm 0.09
4.3\pm 0.6
0.0\pm 0.07
-0.02\pm 0.02
0.93\pm 0.1
-0.07\pm 0.09
-0.0\pm 0.0
0.34\pm 0.06
1.0\pm 0.0
-0.16\pm 0.04
0.5\pm 0.09
0.61\pm 0.08
2.0\pm 0.0
-0.42\pm 0.05
-0.03\pm 0.06
0.74\pm 0.05
2.0\pm 0.0
-0.26\pm 0.04
0.0\pm 0.0
0.54\pm 0.08
3.0\pm 0.0
-0.47\pm 0.07
-0.01\pm 0.02
0.98\pm 0.19
8.0\pm 0.0
-0.02\pm 0.18
-0.0\pm 0.0
1.0\pm 0.09
8.0\pm 0.0
-0.0\pm 0.09
-0.0\pm 0.0
0.8\pm 0.09
8.0\pm 0.0
-0.2\pm 0.09
-0.0\pm 0.0
0.57\pm 0.08
4.0\pm 0.8
-0.35\pm 0.1
0.08\pm 0.09
0.6\pm 0.11
-0.4\pm 0.1
0.0\pm 0.0
0.35\pm 0.49
1.0\pm 0.0
0.32\pm 0.89
0.97\pm 0.73
1.33\pm 0.35
2.0\pm 0.0
0.08\pm 0.37
-0.25\pm 0.18
1.54\pm 0.5
2.0\pm 0.0
0.54\pm 0.47
-0.0\pm 0.0
0.31\pm 0.62
3.0\pm 0.0
-0.07\pm 0.47
0.62\pm 0.27
0.95\pm 0.81
8.0\pm 0.0
-0.05\pm 0.77
-0.0\pm 0.0
1.0\pm 1.17
8.0\pm 0.0
0.0\pm 1.11
0.0\pm 0.0
0.88\pm 0.35
8.0\pm 0.0
-0.12\pm 0.34
-0.0\pm 0.0
2.15\pm 0.02
3.6\pm 0.4
1.04\pm 0.23
-0.11\pm 0.24
1.88\pm 0.33
0.88\pm 0.32
-0.0\pm 0.01
0.52\pm 0.26
1.0\pm 0.0
0.06\pm 0.33
0.54\pm 0.3
0.78\pm 0.2
2.0\pm 0.0
-0.25\pm 0.18
-0.04\pm 0.09
1.08\pm 0.21
2.0\pm 0.0
0.08\pm 0.2
0.0\pm 0.0
0.55\pm 0.24
3.0\pm 0.0
-0.26\pm 0.18
0.2\pm 0.13
0.98\pm 0.31
8.0\pm 0.0
-0.02\pm 0.3
0.0\pm 0.0
1.0\pm 0.38
8.0\pm 0.0
0.0\pm 0.36
0.0\pm 0.0
0.97\pm 0.2
8.0\pm 0.0
-0.03\pm 0.2
0.0\pm 0.0
1.24\pm 0.07
3.9\pm 0.8
0.20\pm 0.06
-0.05\pm 0.16
1.11\pm 0.17
0.11\pm 0.16
0.0\pm 0.0
0.71\pm 0.07
1.0\pm 0.0
0.1\pm 0.23
0.38\pm 0.27
0.68\pm 0.28
2.0\pm 0.0
0.01\pm 0.31
0.33\pm 0.28
0.96\pm 0.21
2.0\pm 0.0
-0.04\pm 0.2
-0.0\pm 0.0
0.94\pm 0.01
3.0\pm 0.0
-0.05\pm 0.02
0.01\pm 0.02
0.98\pm 0.26
4.0\pm 0.0
-0.02\pm 0.3
0.0\pm 0.0
1.0\pm 0.29
4.0\pm 0.0
0.0\pm 0.21
-0.0\pm 0.0
0.65\pm 0.46
4.0\pm 0.0
-0.35\pm 0.35
-0.0\pm 0.0
1.98\pm 0.22
3.4\pm 0.3
0.93\pm 0.12
-0.05\pm 0.32
1.76\pm 0.19
0.75\pm 0.16
-0.0\pm 0.0
