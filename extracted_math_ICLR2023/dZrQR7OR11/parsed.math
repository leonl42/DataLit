\textbf{Han Guo}^{\dagger\star}
\textbf{Philip Greengard}^{\ddagger}
\textbf{Hongyi Wang}^{\dagger}
\textbf{Andrew Gelman}^{\ddagger}
\textbf{Yoon Kim}^{\star}
\textbf{Eric P. Xing}^{\dagger\diamond}
\dagger
\star
\ddagger
\diamond
\btheta
K
\mathcal{D}=\bigcup_{k\in[K]}\mathcal{D}_{k}
\displaystyle\btheta=\operatorname*{arg\,min}\nolimits_{\btheta}\,L(\btheta),%
\;\;\;\;\text{where}\;\;L(\btheta)=\sum\nolimits_{k\in[K]}-\log p(\mathcal{D}_%
{k}\mid\btheta).
\displaystyle\btheta=\operatorname*{arg\,min}\nolimits_{\btheta}\,L(\btheta),%
\;\;\;\;\text{where}\;\;L(\btheta)=\sum\nolimits_{k\in[K]}-\log p(\mathcal{D}_%
{k}\mid\btheta).
p(\btheta\mid\mathcal{D})
p(\btheta)
p(\mathcal{D}_{k}\mid\btheta)
p(\btheta\mid\mathcal{D})\propto p(\btheta)\prod\nolimits_{k\in[K]}p(\mathcal{%
D}_{k}\mid\btheta).
q\in\mathcal{Q}
D(\cdot\|\cdot)
\displaystyle\btheta=\operatorname*{arg\,max}\nolimits_{\btheta}\,q(\btheta),%
\;\;\;\;\text{where}\;\;q(\btheta)=\operatorname*{arg\,min}\nolimits_{q\in%
\mathcal{Q}}D\left(p\left(\btheta\mid\mathcal{D}\right)\,\|\,q\left(\btheta%
\right)\right).
\displaystyle\btheta=\operatorname*{arg\,max}\nolimits_{\btheta}\,q(\btheta),%
\;\;\;\;\text{where}\;\;q(\btheta)=\operatorname*{arg\,min}\nolimits_{q\in%
\mathcal{Q}}D\left(p\left(\btheta\mid\mathcal{D}\right)\,\|\,q\left(\btheta%
\right)\right).
p\left(\btheta\mid\mathcal{D}\right)
\mathcal{D}=\bigcup_{k\in[K]}\mathcal{D}_{k}
\displaystyle p\left(\btheta\mid\mathcal{D}\right)\propto p(\btheta)\prod_{k=1%
}^{K}p(\mathcal{D}_{k}\mid\btheta)=\prod_{k=0}^{K}p_{k}(\bm{\theta}),
\displaystyle p\left(\btheta\mid\mathcal{D}\right)\propto p(\btheta)\prod_{k=1%
}^{K}p(\mathcal{D}_{k}\mid\btheta)=\prod_{k=0}^{K}p_{k}(\bm{\theta}),
p_{0}(\bm{\theta}):=p(\bm{\theta})
p_{k}(\bm{\theta}):=p(\mathcal{D}_{k}\mid\bm{\theta})
k
p_{\text{global}}(\btheta)
\mathcal{D}
q_{\text{global}}(\btheta)
q_{\text{global}}(\btheta)\propto\prod_{k=0}^{K}q_{k}(\bm{\theta}).
\underset{\btheta}{\arg\max}\;\prod_{k=0}^{K}q_{k}(\bm{\theta}),\,\text{ where%
 }\{q_{k}(\bm{\theta})\}_{k=0}^{K}=\underset{q_{k}\in\mathcal{Q}}{\arg\min}\,%
\infdiv{\prod_{k=0}^{K}p_{k}(\bm{\theta})}{\prod_{k=0}^{K}q_{k}(\bm{\theta})}.
\mathcal{Q}
\prod_{k}p_{k}(\bm{\theta})
p_{\text{global}}(\btheta)
q_{\text{global}}(\btheta)
p_{k}
\displaystyle q_{k}^{\text{new}}(\bm{\theta})=\underset{q\in\mathcal{Q}}{\arg%
\min}\,\infdiv{\underbrace{p_{k}(\bm{\theta})\,{q_{-k}(\btheta)}}_{\propto\,\,%
q_{\backslash k}(\btheta)}}{\underbrace{q(\bm{\theta})\,{q_{-k}(\btheta)}}_{%
\propto\,\,\widehat{q}_{\backslash k}(\btheta)}},
\displaystyle q_{k}^{\text{new}}(\bm{\theta})=\underset{q\in\mathcal{Q}}{\arg%
\min}\,\infdiv{\underbrace{p_{k}(\bm{\theta})\,{q_{-k}(\btheta)}}_{\propto\,\,%
q_{\backslash k}(\btheta)}}{\underbrace{q(\bm{\theta})\,{q_{-k}(\btheta)}}_{%
\propto\,\,\widehat{q}_{\backslash k}(\btheta)}},
\displaystyle\text{where}\;q_{-k}(\btheta)\propto\frac{q_{\text{global}}(\bm{%
\theta})}{q_{k}(\bm{\theta})}.
\displaystyle\text{where}\;q_{-k}(\btheta)\propto\frac{q_{\text{global}}(\bm{%
\theta})}{q_{k}(\bm{\theta})}.
q_{\text{global}}(\bm{\theta})
q_{k}(\bm{\theta})
q_{-k}(\btheta)
q_{\backslash k}(\btheta)
\widehat{q}_{\backslash k}(\btheta)
q_{k}^{\text{new}}(\bm{\theta})
q_{\text{global}}^{\text{new}}(\bm{\theta})
q_{\text{global}}(\btheta)
\mathcal{K}
q_{k}^{\text{new}}(\btheta)
q_{-k}(\btheta)\propto 1
q^{\text{new}}_{k}(\bm{\theta})={\arg\min_{q\in\mathcal{Q}}}\,D\left(p_{k}(\bm%
{\theta})\,\|\,q(\bm{\theta})\right)
q_{\text{global}}(\btheta)
q_{k}(\btheta)
t=1,\dots,T
\mathcal{K}
q_{\text{global}}(\bm{\theta})
k\in\mathcal{K}
\Delta q_{k}(\bm{\theta})\leftarrow\operatorname{ClientInfer}(q_{\text{global}%
}(\bm{\theta}))
\Delta q_{k}(\bm{\theta})
q_{\text{global}}(\bm{\theta})\leftarrow\operatorname{ServerInfer}(\{\Delta q_%
{k}(\bm{\theta})\}_{k})
\bmu_{\text{global}}
q_{\backslash k}(\btheta;\mathcal{D}_{k},\boldeta_{-k},\bLambda_{-k})
\mathcal{S}_{k}\leftarrow\{\}
i=1,\dots,N
\btheta^{(i)}_{k}\leftarrow\operatorname{SGDEpoch}({-}\log q_{\backslash k},\;%
\btheta^{(i-1)}_{k})
\mathcal{S}_{k}\leftarrow\mathcal{S}_{k}\cup\btheta^{(i)}_{k}
\boldeta_{\backslash k},\bLambda_{\backslash k}\leftarrow\operatorname{%
EstimateMoments}(\mathcal{S}_{k})
\widehat{q}_{\backslash k}(\bm{\theta};\boldeta_{\backslash k},\bLambda_{%
\backslash k})
\{\Delta q_{k}(\bm{\theta};\Delta\boldeta_{k},\Delta\bLambda_{k})\}_{k}
q_{\text{global}}^{\text{new}}\propto q_{\text{global}}\prod\nolimits_{k}\left%
(\Delta q_{k}\right)^{\delta}
\displaystyle\boldeta_{\text{global}}\leftarrow\boldeta_{\text{global}}+\delta%
\operatorname{ServerOptim}(\sum\nolimits_{k}\Delta\boldeta_{k})
\displaystyle\boldeta_{\text{global}}\leftarrow\boldeta_{\text{global}}+\delta%
\operatorname{ServerOptim}(\sum\nolimits_{k}\Delta\boldeta_{k})
\displaystyle\bLambda_{\text{global}}\leftarrow\bLambda_{\text{global}}+\delta%
\operatorname{ServerOptim}(\sum\nolimits_{k}\Delta\bLambda_{k})
\displaystyle\bLambda_{\text{global}}\leftarrow\bLambda_{\text{global}}+\delta%
\operatorname{ServerOptim}(\sum\nolimits_{k}\Delta\bLambda_{k})
q_{\text{global}}(\bm{\theta};\boldeta_{\text{global}},\bLambda_{\text{global}})
q_{\text{global}}(\bm{\theta};\boldeta_{\text{global}},\bLambda_{\text{global}})
q_{-k}\propto q_{\text{global}}/q_{k}
\displaystyle\boldeta_{-k}\leftarrow\boldeta_{\text{global}}-\boldeta_{k},%
\bLambda_{-k}\leftarrow\bLambda_{\text{global}}-\bLambda_{k}
\displaystyle\boldeta_{-k}\leftarrow\boldeta_{\text{global}}-\boldeta_{k},
\displaystyle\bLambda_{-k}\leftarrow\bLambda_{\text{global}}-\bLambda_{k}
\widehat{q}_{\backslash k}\approx q_{\backslash k}\propto p_{k}\;q_{-k}
\displaystyle\boldeta_{\backslash k},\bLambda_{\backslash k}\leftarrow%
\operatorname{ApproxInference}(q_{\backslash k}\propto p_{k}\;q_{-k})
\displaystyle\boldeta_{\backslash k},\bLambda_{\backslash k}\leftarrow%
\operatorname{ApproxInference}(q_{\backslash k}\propto p_{k}\;q_{-k})
\Delta q_{k}\propto\widehat{q}_{\backslash k}/q_{\text{global}}
\displaystyle\Delta\boldeta_{k}\leftarrow\boldeta_{\backslash k}-\boldeta_{%
\text{global}},\Delta\bLambda_{k}\leftarrow\bLambda_{\backslash k}-\bLambda_{%
\text{global}}
\displaystyle\Delta\boldeta_{k}\leftarrow\boldeta_{\backslash k}-\boldeta_{%
\text{global}},
\displaystyle\Delta\bLambda_{k}\leftarrow\bLambda_{\backslash k}-\bLambda_{%
\text{global}}
q_{k}^{\text{new}}\propto q_{k}\left(\Delta q_{k}\right)^{\delta}
\displaystyle\boldeta_{k}\leftarrow\boldeta_{k}+\delta\operatorname{%
ClientOptim}(\Delta\boldeta_{k})
\displaystyle\boldeta_{k}\leftarrow\boldeta_{k}+\delta\operatorname{%
ClientOptim}(\Delta\boldeta_{k})
\displaystyle\bLambda_{k}\leftarrow\bLambda_{k}+\delta\operatorname{%
ClientOptim}(\Delta\bLambda_{k})
\displaystyle\bLambda_{k}\leftarrow\bLambda_{k}+\delta\operatorname{%
ClientOptim}(\Delta\bLambda_{k})
\Delta q_{k}(\bm{\theta};\Delta\boldeta_{k},\Delta\bLambda_{k})
\mathcal{Q}
\displaystyle q(\btheta)=\mathcal{N}\left(\btheta;\bmu,\bSigma\right)=\mathcal%
{N}\left(\btheta;\boldeta,\bLambda\right),
\displaystyle q(\btheta)=\mathcal{N}\left(\btheta;\bmu,\bSigma\right)=\mathcal%
{N}\left(\btheta;\boldeta,\bLambda\right),
\displaystyle\text{where}\;\;\bLambda:=\bSigma^{-1},\boldeta:=\bSigma^{-1}\bmu.
\displaystyle\text{where}\;\;\bLambda:=\bSigma^{-1},\boldeta:=\bSigma^{-1}\bmu.
q_{-k}(\btheta)
q_{\text{global}}(\btheta)
\displaystyle\mathcal{N}\left(\btheta;\boldeta_{1},\bLambda_{1}\right)\mathcal%
{N}\left(\btheta;\boldeta_{2},\bLambda_{2}\right)\propto\mathcal{N}\left(%
\btheta;\boldeta_{1}+\boldeta_{2},\bLambda_{1}+\bLambda_{2}\right),
\displaystyle\mathcal{N}\left(\btheta;\boldeta_{1},\bLambda_{1}\right)\mathcal%
{N}\left(\btheta;\boldeta_{2},\bLambda_{2}\right)\propto\mathcal{N}\left(%
\btheta;\boldeta_{1}+\boldeta_{2},\bLambda_{1}+\bLambda_{2}\right),
\displaystyle\frac{\mathcal{N}\left(\btheta;\boldeta_{1},\bLambda_{1}\right)}{%
\mathcal{N}\left(\btheta;\boldeta_{2},\bLambda_{2}\right)}\propto\mathcal{N}%
\left(\btheta;\boldeta_{1}-\boldeta_{2},\bLambda_{1}-\bLambda_{2}\right).
\displaystyle\frac{\mathcal{N}\left(\btheta;\boldeta_{1},\bLambda_{1}\right)}{%
\mathcal{N}\left(\btheta;\boldeta_{2},\bLambda_{2}\right)}\propto\mathcal{N}%
\left(\btheta;\boldeta_{1}-\boldeta_{2},\bLambda_{1}-\bLambda_{2}\right).
\widehat{q}_{\backslash k}(\btheta)
q_{\backslash k}(\btheta)
\mathcal{S}_{k}=\{\btheta_{k}^{(1)},\dots,\btheta_{k}^{(N)}\}
\displaystyle\underbrace{-\sum\nolimits_{z\in\mathcal{D}_{k}}\log p(\bm{z}\mid%
\btheta)}_{-\log p_{k}(\btheta)}\underbrace{+\frac{1}{2}\btheta^{\top}\bLambda%
_{-k}\btheta-\boldeta_{-k}^{\top}\bm{\theta}}_{-\log q_{-k}(\btheta)},
\displaystyle\underbrace{-\sum\nolimits_{z\in\mathcal{D}_{k}}\log p(\bm{z}\mid%
\btheta)}_{-\log p_{k}(\btheta)}\underbrace{+\frac{1}{2}\btheta^{\top}\bLambda%
_{-k}\btheta-\boldeta_{-k}^{\top}\bm{\theta}}_{-\log q_{-k}(\btheta)},
-\log p_{k}(\btheta)
-\log q_{-k}(\btheta)
\mathcal{S}_{k}
q_{\backslash k}(\btheta)
\displaystyle q_{\backslash k}(\btheta)=\mathcal{N}(\btheta;\bmu_{\backslash k%
},\bSigma_{\backslash k})
\displaystyle q_{\backslash k}(\btheta)=\mathcal{N}(\btheta;\bmu_{\backslash k%
},\bSigma_{\backslash k})
\displaystyle\text{where}\;\;\bmu_{\backslash k},\bSigma_{\backslash k}%
\leftarrow\operatorname{MomentEstimator}(\mathcal{S}_{k}).
\displaystyle\text{where}\;\;\bmu_{\backslash k},\bSigma_{\backslash k}%
\leftarrow\operatorname{MomentEstimator}(\mathcal{S}_{k}).
\mathcal{S}_{k}
\alpha_{\text{cov}}
\bSigma_{\backslash k}\leftarrow\alpha_{\text{cov}}\boldI.
\displaystyle\bSigma_{\backslash k}\leftarrow\left(\bm{H}_{k}+\bSigma^{-1}_{-k%
}\right)^{-1},\;\text{where}\;\boldH_{k}\approx\underbrace{\operatorname{diag}%
\left(\mathbb{E}_{x\sim\mathcal{D}_{k},\;y\sim p(y\mid x,\btheta)}\left[\bigg{%
(}\nabla_{\theta}\log p(y\mid\btheta,x)\bigg{)}^{2}\right]\right)}_{\text{%
diagonal Fisher approximation}}.
\displaystyle\bSigma_{\backslash k}\leftarrow\left(\bm{H}_{k}+\bSigma^{-1}_{-k%
}\right)^{-1},\;\text{where}\;\boldH_{k}\approx\underbrace{\operatorname{diag}%
\left(\mathbb{E}_{x\sim\mathcal{D}_{k},\;y\sim p(y\mid x,\btheta)}\left[\bigg{%
(}\nabla_{\theta}\log p(y\mid\btheta,x)\bigg{)}^{2}\right]\right)}_{\text{%
diagonal Fisher approximation}}.
x
D_{k}
y
p(y\mid x,\btheta)
t=1\ldots T_{\text{NGVI}}
\beta_{\text{NGVI}}
\displaystyle\bSigma_{\backslash k,t}\leftarrow\left(|\mathcal{D}_{k}|\bolds_{%
t}+\bSigma^{-1}_{-k}\right)^{-1},\text{where}\;\bolds_{t}\leftarrow\beta_{%
\text{NGVI}}\bolds_{t-1}+\left(1-\beta_{\text{NGVI}}\right)\mathbb{E}_{\btheta%
\sim q_{\backslash k,t-1}}\left[\frac{1}{|\mathcal{D}_{k}|}\operatorname{%
Fisher}(\btheta)\right].
\displaystyle\bSigma_{\backslash k,t}\leftarrow\left(|\mathcal{D}_{k}|\bolds_{%
t}+\bSigma^{-1}_{-k}\right)^{-1},\text{where}\;\bolds_{t}\leftarrow\beta_{%
\text{NGVI}}\bolds_{t-1}+\left(1-\beta_{\text{NGVI}}\right)\mathbb{E}_{\btheta%
\sim q_{\backslash k,t-1}}\left[\frac{1}{|\mathcal{D}_{k}|}\operatorname{%
Fisher}(\btheta)\right].
\operatorname{Fisher}(\cdot)
q_{\backslash k,t}(\btheta)
\bSigma_{\backslash k,t}
\widehat{q}_{\backslash k}(\btheta)
\bmu_{\backslash k},\bSigma_{\backslash k}
q_{\text{global}}^{\text{new}}(\btheta)
\delta
\Delta q_{k}(\btheta)\propto\widehat{q}_{\backslash k}(\btheta)/q_{\text{%
global}}(\btheta)
\displaystyle\textbf{Client:}q^{\text{new}}_{k}(\btheta)\propto q_{k}(\btheta)%
\Big{(}\Delta q_{k}(\btheta)\Big{)}^{\delta},
\displaystyle q^{\text{new}}_{k}(\btheta)\propto q_{k}(\btheta)\Big{(}\Delta q%
_{k}(\btheta)\Big{)}^{\delta},
\displaystyle\textbf{Server:}q^{\text{new}}_{\text{global}}(\btheta)\propto q_%
{\text{global}}(\btheta)\prod_{k}\Big{(}\Delta q_{k}(\btheta)\Big{)}^{\delta}.
\displaystyle q^{\text{new}}_{\text{global}}(\btheta)\propto q_{\text{global}}%
(\btheta)\prod_{k}\Big{(}\Delta q_{k}(\btheta)\Big{)}^{\delta}.
\boldeta
\displaystyle\textbf{Client:}\boldeta_{k}\leftarrow\boldeta_{k}+\delta\Delta%
\boldeta_{k},
\displaystyle\boldeta_{k}\leftarrow\boldeta_{k}+\delta\Delta\boldeta_{k},
\displaystyle\textbf{Server:}\boldeta_{\text{global}}\leftarrow\boldeta_{\text%
{global}}+\delta\sum_{k\in\mathcal{K}}\Delta\boldeta_{k}.
\displaystyle\boldeta_{\text{global}}\leftarrow\boldeta_{\text{global}}+\delta%
\sum_{k\in\mathcal{K}}\Delta\boldeta_{k}.
\bLambda
\Delta q_{k}(\btheta;\Delta\boldeta_{k},\Delta\bLambda_{k})
\displaystyle\textbf{Client:}\boldeta_{k}\leftarrow\boldeta_{k}+\delta\;{%
\color[rgb]{1,0,0}\operatorname{optim}}(\Delta\boldeta_{k}),
\displaystyle\boldeta_{k}\leftarrow\boldeta_{k}+\delta\;{\color[rgb]{1,0,0}%
\operatorname{optim}}(\Delta\boldeta_{k}),
\displaystyle\textbf{Server:}\boldeta_{\text{global}}\leftarrow\boldeta_{\text%
{global}}+\delta\;{\color[rgb]{1,0,0}\operatorname{optim}}(\sum_{k\in\mathcal{%
K}}\Delta\boldeta_{k}).
\displaystyle\boldeta_{\text{global}}\leftarrow\boldeta_{\text{global}}+\delta%
\;{\color[rgb]{1,0,0}\operatorname{optim}}(\sum_{k\in\mathcal{K}}\Delta%
\boldeta_{k}).
p(\btheta)
K
\overline{q_{k}}(\btheta)
q_{\text{global}}(\btheta)\propto p(\btheta)\bigg{(}\overline{q_{k}}(\btheta)%
\bigg{)}^{K}.
2
q_{-k}(\btheta)\propto q_{\text{global}}(\bm{\theta})/\overline{q_{k}}(\bm{%
\theta})
5
p_{k}(\bm{\theta})=\mathcal{N}(\btheta;\bmu_{k},\bSigma_{k})
k\in\{1,2\}
D_{\operatorname{KL}}(q_{\backslash k}\|\widehat{q}_{\backslash k})
\displaystyle\bm{\mu}_{k}\sim\mathcal{N}\left(\bm{\mu}\mid\bm{\mu}_{0},\frac{1%
}{\lambda}\bm{\Sigma}_{k}\right),
\displaystyle\bm{\mu}_{k}\sim\mathcal{N}\left(\bm{\mu}\mid\bm{\mu}_{0},\frac{1%
}{\lambda}\bm{\Sigma}_{k}\right),
\displaystyle\bm{\Sigma}_{k}\sim\mathcal{W}^{-1}(\bm{\Sigma}\mid\bm{\Psi},\nu).
\displaystyle\bm{\Sigma}_{k}\sim\mathcal{W}^{-1}(\bm{\Sigma}\mid\bm{\Psi},\nu).
\bmu_{0}=\bm{0}
\nu=7
\lambda=0.2
\bm{\Psi}
200
11.2
100_{\pm 0}
100_{\pm 0}
5.0
397_{\pm 1279}
81_{\pm 301}
1.2
198_{\pm 77}
23_{\pm 9}
\pm
\pm
\%
\uparrow
\#
\downarrow
45.8
48.4
811
-
44.7_{(0.2)}
46.2_{(0.2)}
911_{(86)}
-
\underline{48.7}_{(0.4)}
\textbf{50.7}_{(0.4)}
\underline{473}_{(17)}
\textbf{1167}_{(107)}
\textbf{48.8}_{(0.4)}
\underline{50.4}_{(0.5)}
\textbf{461}_{(13)}
\underline{1240}_{(133)}^{\dagger}
46.5_{(0.4)}
47.7_{(0.3)}
523_{(28)}
-
47.8_{(0.5)}
49.6_{(0.6)}
487_{(24)}
1290_{(-)}^{\ddagger}
48.2_{(0.4)}
48.9_{(0.4)}
438_{(9)}
-
48.2_{(0.4)}
48.9_{(0.4)}
438_{(9)}
-
47.2_{(0.4)}
47.8_{(0.4)}
442_{(10)}
-
47.8_{(0.4)}
48.5_{(0.5)}
440_{(10)}
-
5
10
100
5
10
100
\underline{74.66}
19.94
30.78
11.63
\textbf{75.20}_{(0.18)}
13.88_{(0.27)}
23.32_{(0.41)}
\;\;8.02_{(0.26)}
71.32_{(0.20)}
25.10_{(0.22)}
37.04_{(0.25)}
13.61_{(0.15)}
58.31_{(18.04)}
\;\;8.70_{(1.14)}
14.29_{(2.20)}
\;\;2.70_{(0.33)}
70.98_{(0.18)}
\underline{25.88}_{(0.30)}
\underline{37.80}_{(0.29)}
\underline{13.97}_{(0.19)}
69.51_{(0.35)}
\textbf{28.02}_{(0.20)}
\textbf{39.78}_{(0.25)}
\textbf{15.32}_{(0.08)}
5
1500
100
5
1500
100
5.4\times 10^{-1}
\pm\,4.7\times 10^{-1}
2.6\times 10^{-1}
\pm\,2.6\times 10^{-1}
1.1\times 10^{-7}
\pm\,9.8\times 10^{-8}
200
200
10
100
1500
100
10K
400
400
2
5
400
2
5
800
2
5
800
2
5
10.1K
172.9K
\%
\uparrow
\%
\downarrow
48.1
-
13.6
-
46.6_{(0.7)}
-
19.5_{(0.4)}
-
50.8_{(0.4)}
49.6_{(0.6)}
4.9_{(0.3)}
7.9_{(0.2)}
50.5_{(0.5)}
50.2_{(0.4)}
5.9_{(0.5)}
4.6_{(0.4)}
47.7_{(0.5)}
47.8_{(0.5)}
8.8_{(0.4)}
6.6_{(0.4)}
49.7_{(0.5)}
49.5_{(0.3)}
5.9_{(0.4)}
2.2_{(0.5)}
49.0_{(0.4)}
48.5_{(0.4)}
10.0_{(0.4)}
3.4_{(0.3)}
48.9_{(0.4)}
48.6_{(0.4)}
10.1_{(0.4)}
3.5_{(0.3)}
47.7_{(0.5)}
47.8_{(0.5)}
9.6_{(0.6)}
7.2_{(0.6)}
48.5_{(0.4)}
48.7_{(0.4)}
9.3_{(0.4)}
3.7_{(0.4)}
\operatorname{ECE}=\sum_{i}^{N_{\text{bins}}}b_{i}\left|\operatorname{accuracy%
}_{i}-\operatorname{confidence}_{i}\right|.
\operatorname{accuracy}_{i}
1
i
\operatorname{confidence}_{i}
i
b_{i}
i
[0,1]
10
\Delta\boldeta_{k},\Delta\bLambda_{k}
D_{\text{KL}}(p\|q)
D_{\text{KL}}(q\|p)
\displaystyle q_{k}^{\text{new}}(\bm{\theta})\propto\frac{\widehat{q}_{%
\backslash k}(\bm{\theta})}{q_{-k}(\bm{\theta})},
\displaystyle q_{k}^{\text{new}}(\bm{\theta})\propto\frac{\widehat{q}_{%
\backslash k}(\bm{\theta})}{q_{-k}(\bm{\theta})},
\displaystyle\text{where}\;\widehat{q}_{\backslash k}(\bm{\theta})=\underset{%
\widehat{q}_{\backslash k}\in\mathcal{Q}}{\arg\min}\,\infdiv{p_{k}(\bm{\theta}%
)\,{q_{-k}(\btheta)}}{\widehat{q}_{\backslash k}(\btheta)}.
\displaystyle\text{where}\;\widehat{q}_{\backslash k}(\bm{\theta})=\underset{%
\widehat{q}_{\backslash k}\in\mathcal{Q}}{\arg\min}\,\infdiv{p_{k}(\bm{\theta}%
)\,{q_{-k}(\btheta)}}{\widehat{q}_{\backslash k}(\btheta)}.
\displaystyle q^{\text{new}}_{k}(\btheta)\propto\bigg{(}q_{k}(\btheta)\bigg{)}%
^{1-\delta}\bigg{(}\frac{\widehat{q}_{\backslash k}(\btheta)}{q_{-k}(\btheta)}%
\bigg{)}^{\delta}
\displaystyle q^{\text{new}}_{k}(\btheta)
\displaystyle\propto\bigg{(}q_{k}(\btheta)\bigg{)}^{1-\delta}\bigg{(}\frac{%
\widehat{q}_{\backslash k}(\btheta)}{q_{-k}(\btheta)}\bigg{)}^{\delta}
\displaystyle\propto\bigg{(}q_{k}(\btheta)\bigg{)}^{1-\delta}\bigg{(}\frac{%
\widehat{q}_{\backslash k}(\btheta)}{q_{\text{global}}(\btheta)/q_{k}(\btheta)%
}\bigg{)}^{\delta}
\displaystyle\propto\bigg{(}q_{k}(\btheta)\bigg{)}^{1-\delta}\bigg{(}\frac{%
\widehat{q}_{\backslash k}(\btheta)}{q_{\text{global}}(\btheta)/q_{k}(\btheta)%
}\bigg{)}^{\delta}
\displaystyle\propto\bigg{(}q_{k}(\btheta)\bigg{)}^{1-\delta}\bigg{(}q_{k}(%
\btheta)\bigg{)}^{\delta}\bigg{(}\frac{\widehat{q}_{\backslash k}(\btheta)}{q_%
{\text{global}}(\btheta)}\bigg{)}^{\delta}
\displaystyle\propto\bigg{(}q_{k}(\btheta)\bigg{)}^{1-\delta}\bigg{(}q_{k}(%
\btheta)\bigg{)}^{\delta}\bigg{(}\frac{\widehat{q}_{\backslash k}(\btheta)}{q_%
{\text{global}}(\btheta)}\bigg{)}^{\delta}
\displaystyle\propto q_{k}(\btheta)\bigg{(}\frac{\widehat{q}_{\backslash k}(%
\btheta)}{q_{\text{global}}(\btheta)}\bigg{)}^{\delta}
\displaystyle\propto q_{k}(\btheta)\bigg{(}\frac{\widehat{q}_{\backslash k}(%
\btheta)}{q_{\text{global}}(\btheta)}\bigg{)}^{\delta}
\displaystyle\propto q_{k}(\btheta)\bigg{(}\Delta q_{k}(\btheta)\bigg{)}^{%
\delta},
\displaystyle\propto q_{k}(\btheta)\bigg{(}\Delta q_{k}(\btheta)\bigg{)}^{%
\delta},
\displaystyle\Delta q_{k}(\btheta)\propto\frac{\widehat{q}_{\backslash k}(%
\btheta)}{q_{\text{global}}(\btheta)}.
\displaystyle\Delta q_{k}(\btheta)
\displaystyle\propto\frac{\widehat{q}_{\backslash k}(\btheta)}{q_{\text{global%
}}(\btheta)}.
\displaystyle q^{\text{new}}_{\text{global}}(\btheta)\propto\prod_{k}q^{\text{%
new}}_{k}(\btheta)
\displaystyle q^{\text{new}}_{\text{global}}(\btheta)
\displaystyle\propto\prod_{k}q^{\text{new}}_{k}(\btheta)
\displaystyle\propto\prod_{k}q_{k}(\btheta)\bigg{(}\Delta q_{k}(\btheta)\bigg{%
)}^{\delta}
\displaystyle\propto\prod_{k}q_{k}(\btheta)\bigg{(}\Delta q_{k}(\btheta)\bigg{%
)}^{\delta}
\displaystyle\propto\bigg{[}\prod_{k}q_{k}(\btheta)\bigg{]}\bigg{[}\prod_{k}%
\bigg{(}\Delta q_{k}(\btheta)\bigg{)}^{\delta}\;\bigg{]}
\displaystyle\propto\bigg{[}\prod_{k}q_{k}(\btheta)\bigg{]}\bigg{[}\prod_{k}%
\bigg{(}\Delta q_{k}(\btheta)\bigg{)}^{\delta}\;\bigg{]}
\displaystyle\propto q_{\text{global}}(\btheta)\prod_{k}\bigg{(}\Delta q_{k}(%
\btheta)\bigg{)}^{\delta}.
\displaystyle\propto q_{\text{global}}(\btheta)\prod_{k}\bigg{(}\Delta q_{k}(%
\btheta)\bigg{)}^{\delta}.
\displaystyle q_{k}^{\text{new}}(\bm{\theta})=\underset{q\in\mathcal{Q}}{\arg%
\min}\,\infdiv{p_{k}(\bm{\theta})\,{\color[rgb]{1,0,0}p_{-k}(\btheta)}}{q(\bm{%
\theta})\,{\color[rgb]{1,0,0}p_{-k}(\btheta)}},
\displaystyle q_{k}^{\text{new}}(\bm{\theta})=\underset{q\in\mathcal{Q}}{\arg%
\min}\,\infdiv{p_{k}(\bm{\theta})\,{\color[rgb]{1,0,0}p_{-k}(\btheta)}}{q(\bm{%
\theta})\,{\color[rgb]{1,0,0}p_{-k}(\btheta)}},
\displaystyle\text{where}\;p_{-k}(\btheta)\propto\frac{p_{\text{global}}(\bm{%
\theta})}{p_{k}(\bm{\theta})}.
\displaystyle\text{where}\;p_{-k}(\btheta)\propto\frac{p_{\text{global}}(\bm{%
\theta})}{p_{k}(\bm{\theta})}.
\displaystyle q_{k}^{\text{new}}(\bm{\theta})=\underset{q\in\mathcal{Q}}{\arg%
\min}\,\infdiv{p_{k}(\bm{\theta})\,{\color[rgb]{1,0,0}q_{-k}(\btheta)}}{q(\bm{%
\theta})\,{\color[rgb]{1,0,0}q_{-k}(\btheta)}},
\displaystyle q_{k}^{\text{new}}(\bm{\theta})=\underset{q\in\mathcal{Q}}{\arg%
\min}\,\infdiv{p_{k}(\bm{\theta})\,{\color[rgb]{1,0,0}q_{-k}(\btheta)}}{q(\bm{%
\theta})\,{\color[rgb]{1,0,0}q_{-k}(\btheta)}},
\displaystyle\text{where}\;q_{-k}(\btheta)\propto\frac{q_{\text{global}}(\bm{%
\theta})}{q_{k}(\bm{\theta})}.
\displaystyle\text{where}\;q_{-k}(\btheta)\propto\frac{q_{\text{global}}(\bm{%
\theta})}{q_{k}(\bm{\theta})}.
T_{\text{NGVI}}
T_{\text{NGVI}}
1
10
200
200
\%
\uparrow
\#
\downarrow
85.9
86.5
246
398
85.3
85.8
465
-
399
399
382
10
100
10
100
\mathcal{D}_{k},\bmu_{\backslash k},\bSigma_{-k},T_{\text{NGVI}},N_{\text{NGVI%
}},\beta_{\text{NGVI}}
\bolds_{0},\bSigma_{\backslash k,0}
t=1,\dots,T_{\text{NGVI}}
\mathcal{F}\leftarrow\{\}
i=1,\dots,N_{\text{NGVI}}
\btheta\sim\mathcal{N}\left(\btheta;\bmu_{\backslash k},\bSigma_{\backslash k,%
t-1}\right)
\mathcal{F}\leftarrow\mathcal{F}\cup\frac{1}{|\mathcal{D}_{k}|}\operatorname{%
Fisher}(\btheta,\mathcal{D}_{k})
\boldF\leftarrow\operatorname{Average}(\mathcal{F})
\bolds_{t}\leftarrow\beta_{\text{NGVI}}\bolds_{t-1}+\left(1-\beta\right)\boldF
\bSigma_{\backslash k,t}\leftarrow\left(|\mathcal{D}_{k}|\bolds_{t}+\bSigma^{-%
1}_{-k}\right)^{-1}
\bSigma_{\backslash k,T_{\text{NGVI}}}
m=0.9
\tau=10^{-5}
m=0.9
m=0.9
m=0.9
m=0.9
20
10
100
0.5
5.0
0.5
0.01
50.0
0.01
10
5
20
400
800
200
{\alpha_{\text{cov}}}^{\ddagger}
5\times 10^{-2}
1\times 10^{-8}
5\times 10^{-3}
1\times 10^{-4}
1\times 10^{-6}
1\times 10^{-4}
5^{\star}
5
5
5
10
5
5
10
5
\beta_{\text{NGVI}}
0.99
0.99
0.99
{\alpha_{\text{cov}}}
\{1,2,5,10\}\times 10^{-2}
1\times\{10^{-7},10^{-8},10^{-9}\}
\{1,5\}\times\{10^{-2},10^{-3},10^{-4}\}
1\times\{10^{-3},10^{-4},10^{-5},10^{-6}\}
\{5,10\}
\{5,10\}
\{5,10\}
\beta_{\text{NGVI}}
\{0.9,0.99\}
10
10
\%
\uparrow
\#
\downarrow
\alpha_{\text{cov}}
4\times 10^{-2}
49.1
50.3
457
1081
5\times 10^{-2}
48.9
50.5
464
1105
6\times 10^{-2}
48.8
50.5
474
1206
5\times 10^{-5}
47.8
48.8
482
-
1\times 10^{-4}
48.9
50.5
456
1179
5\times 10^{-4}
49.2
49.2
436
-
5
46.7
47.9
513
-
10
46.7
47.9
514
-
5
47.9
49.6
478
-
10
46.6
48.5
523
-
\alpha_{\text{cov}}
4\times 10^{-2}
48.2
48.7
431
-
5\times 10^{-2}
48.3
49.0
431
-
6\times 10^{-2}
48.3
49.1
433
-
5\times 10^{-5}
48.3
48.9
431
-
1\times 10^{-4}
48.3
49.0
432
-
5\times 10^{-4}
48.4
49.0
431
-
5
47.2
47.9
437
-
10
47.2
47.9
439
-
5
47.9
48.8
432
-
10
47.8
48.6
432
-
