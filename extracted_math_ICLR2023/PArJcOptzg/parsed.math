f_{\theta}(x)
x
y
f_{\theta}(x)
x^{\star}
x
x^{\star}
x
f_{\theta}(x^{\star})\neq y
f_{\theta}(x)=y
x^{\star}
x
f_{\theta}(x^{\star})=y^{\star}
y^{\star}
y^{\star}\neq y
x
y=f_{\theta}(x)
x^{\star}
\displaystyle f_{\theta}(x^{\star})\neq y
\displaystyle f_{\theta}(x^{\star})\neq y
\displaystyle d(x,x^{\star})\leq B
\displaystyle d(x,x^{\star})\leq B
d(\cdot,\cdot)
B
f
J_{\theta}(x)
f
\mathbf{argmin}_{x^{\star}}\lambda d(x,x^{\star})-\ell(\mathbf{1}_{y},J_{%
\theta}(x^{\star}))
\mathbf{1}_{y}
y
\ell
\lambda
\ell
\ell(u,v)=\log{(1-u\cdot v)}
L_{\infty}
x^{\star}\leftarrow\mathrm{clip}(x+B\mathbf{sgn}(\nabla_{x}\ell(\mathbf{1}_{y}%
,J_{\theta}(x))))
\mathrm{clip}(x)
x
[0,255]
\ell(u,v)=\log{(1-u\cdot v)}
x^{\star}\leftarrow\mathrm{clip}(x+B\frac{\nabla_{x}\ell(\mathbf{1}_{y},J_{%
\theta}(x))}{||\nabla_{x}\ell(\mathbf{1}_{y},J_{\theta}(x))||}))
d(x,x^{\star})=||x-x^{\star}||
x-x^{\star}
\mathbf{sgn}(\nabla_{x}\ell)
\frac{\nabla_{x}\ell}{||\nabla_{x}\ell||}
x^{\star}
\displaystyle f_{\theta}(x^{\star})=y^{\star}
\displaystyle f_{\theta}(x^{\star})=y^{\star}
y^{\star}
\mathbf{argmin}_{x^{\star}}\lambda d(x,x^{\star})+\ell^{\prime}(\mathbf{1}_{y^%
{\star}},J_{\theta}(x^{\star}))
\ell^{\prime}(u,v)=-\sum\limits_{i}u_{i}\log v_{i}
x^{\star}\leftarrow\mathrm{clip}(x-B\mathbf{sgn}(\nabla_{x}\ell^{\prime}(%
\mathbf{1}_{y^{\star}},J_{\theta}(x))))~{}~{}~{}~{}\mathrm{(FGS)}
x^{\star}\leftarrow\mathrm{clip}(x-B\frac{\nabla_{x}\ell^{\prime}(\mathbf{1}_{%
y^{\star}},J_{\theta}(x))}{||\nabla_{x}\ell^{\prime}(\mathbf{1}_{y^{\star}},J_%
{\theta}(x))||})~{}~{}~{}~{}\mathrm{(FG)}
\ell^{\prime}
d(x^{\star},x)=\sqrt{\sum_{i}(x_{i}^{\star}-x_{i})^{2}/N}
x^{\star}
x
N
x
x^{\star}
x_{i}
i
x
[0,255]
x^{\star}_{i}
x^{\star}
x
\lambda
<2
\lambda
x^{\star}
x
x
\lambda
0
x^{\star}
x
\lambda
0
4
(i,j)
i
j
(i,j)
i
j
B
B
x
M_{1},M_{2}
B
\delta
x_{B}=x+B\delta
M_{1}
M_{1}
M_{2}
\delta
\mathbf{sgn}(\nabla_{x}\ell)
\nabla_{x}\ell/||\nabla_{x}\ell||
M_{1}
M_{2}
x_{B}
B
M_{1}
M_{2}
B
80.91
86.56
L_{\infty}
L_{2}
(i,j)
i
j
(i,j)
i
j
0\%
k
J_{1},...,J_{k}
x
y
\mathbf{argmin}_{x\star}-\log{\big{(}(\sum_{i=1}^{k}\alpha_{i}J_{i}(x^{\star})%
)\cdot\mathbf{1}_{y^{\star}}\big{)}}+\lambda d(x,x^{\star})
y^{\star}
\sum\alpha_{i}J_{i}(x^{\star})
\alpha_{i}
\sum_{i=1}^{k}\alpha_{i}=1
J_{k+1}
8
(i,j)
i
j
-
(i,j)
i
j
-
6\%
(i,j)
i
j
-
(i,j)
i
j
-
\delta_{1},\delta_{2}
(u,v)
x+u\delta_{1}+v\delta_{2}
x
57\%
76\%
18\%
2\%
(i,j)
i
j
(i,j)
i
j
\mathbf{argmin}_{x^{\star}}-\log{(1-\mathbf{1}_{y}\cdot J_{\theta}(x^{\star}))%
}+\lambda_{1}\mathrm{ReLU}(\tau-d(x,x^{\star}))+\lambda_{2}\mathrm{ReLU}(d(x,x%
^{\star})-\tau)
-\log{(1-\mathbf{1}_{y}\cdot J_{\theta}(x^{\star}))}
d(x,x^{\star})
\tau
d(x,x^{\star})
-
-
-
-
-
-
-
-
-
-
(i,j)
i
j
i
j
(i,j)
i
j
i
j
x_{B}
x_{B}
B
B
B\delta
\delta
x_{B}
B\delta
\delta
x_{B}
(i,j)
i
j
(i,j)
i
j
25
66\%
j
(i,j)
j
i
j
(i,j)
j
i
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
(i,j)
i
j
-
-
-
-
-
-
-
-
-
-
(i,j)
i
j
i
j
(i,j)
i
j
i
j
-
-
-
-
-
-
-
-
-
-
(i,j)
i
j
i
j
(i,j)
i
j
i
j
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
(i,j)
i
j
-
i
i
i
i
-
-
-
-
-
-
-
-
-
-
i
j
(i,j)
i
j
(i,j)
B
B
