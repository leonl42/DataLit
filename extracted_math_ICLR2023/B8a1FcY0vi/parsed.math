t
t
t
t
t
t
t
t
t
t
t
t
t
t
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
\bar{Z}=|X|/m
\bar{Z}
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
\bar{Z}=|X|/m
\bar{Z}
t
t
t
t
t
k
t
t
t
t
q_{\theta}
s_{1},\dots,s_{N}
p
X
\theta
\theta^{*}=\operatorname*{arg\,max}_{\theta}\sum\nolimits_{i=1}^{N}\log\big{(}%
q_{\theta}(s_{i})\big{)}\,.
q_{\theta}
q_{\theta}
Z(\theta)=\sum_{x\in X}q_{\theta}(x)
N
m
t_{1},\dots t_{mN}
\xi
X
\theta
\mathbb{P}(\text{data}\mid x)=q_{\theta}(x)/\big{(}q_{\theta}(x)+m\xi(x)\big{)}
\mathbb{P}(\text{noise}\mid x)=1-\mathbb{P}(\text{data}\mid x)
\theta^{*}=\operatorname*{arg\,min}_{\theta}\left[-\sum_{i=1}^{N}\log\left(%
\frac{q_{\theta}(s_{i})}{q_{\theta}(s_{i})+m\xi(s_{i})}\right)-\sum_{i=1}^{mN}%
\log\left(1-\frac{q_{\theta}(t_{i})}{q_{\theta}(t_{i})+m\xi(t_{i})}\right)%
\right].
p
\xi
\theta^{*}
q_{\theta^{*}}=p
\theta^{*}
\mathcal{L}^{\mathrm{NCE}}(\theta)=-\mathbb{E}_{s\sim p}\log\left(\frac{q_{%
\theta}(s)}{q_{\theta}(s)+m\xi(s)}\right)-m\mathbb{E}_{t\sim\xi}\log\left(1-%
\frac{q_{\theta}(t)}{q_{\theta}(t)+m\xi(t)}\right)
\mathcal{L}^{\mathrm{NCE}}
\tilde{\theta}
q_{\tilde{\theta}}=p
Z
q_{\theta,Z}=q_{\theta}/Z
q_{\theta}
p
(m+1)
m
\xi
\mathcal{L}^{\text{InfoNCE}}(\theta)=-\mathop{\mathbb{E}}\limits_{\begin{%
subarray}{c}x\sim p\\
x_{1},\dots,x_{m}\sim\xi\end{subarray}}\log\left(\frac{q_{\theta}(x)}{q_{%
\theta}(x)+\sum_{i=1}^{m}q_{\theta}(x_{i})}\right).
t
e_{1},\dots,e_{n}\in\mathbb{R}^{d}
x_{1},\dots,x_{n}\in\mathbb{R}^{D}
D\gg d
d=2
t
k
\text{s}k\text{NN}
t
ij
\text{s}k\text{NN}
x_{i}
k
x_{j}
p(ij)=\mathds{1}(ij\in\text{s}k\text{NN})/|\text{s}k\text{NN}|
|\text{s}k\text{NN}|
\text{s}k\text{NN}
\mathds{1}
k=15
t
\phi(d_{ij})=1/(d_{ij}^{2}+1)
d_{ij}=\|e_{i}-e_{j}\|
\phi(ij)=\phi(d_{ij})
p
q_{\theta}
X
p
q_{\theta}
ij
1\leq i<j\leq n
e_{1},\dots,e_{n}
\theta
q_{\theta}
t
t
q_{\theta}
\phi(\|e_{i}-e_{j}\|)
q_{\theta}(ij)=\phi(ij)/Z(\theta)
Z(\theta)=\sum_{k\neq l}\phi(kl)
\mathcal{L}^{t\text{-SNE}}(\theta)=-\mathbb{E}_{ij\sim p}\log\big{(}q_{\theta}%
(ij)\big{)}=-\sum\nolimits_{i\neq j}\Big{(}p(ij)\log\big{(}\phi(ij)\big{)}\Big%
{)}+\log\Big{(}\sum\nolimits_{k\neq l}\phi(kl)\Big{)}
\theta
t
t
p
q_{\theta}
p
\theta
t
\mathcal{L}^{\text{NC-}t\text{-SNE}}(\theta,Z)=-\mathbb{E}_{ij\sim p}\log\left%
(\frac{q_{\theta,Z}(ij)}{q_{\theta,Z}(ij)+m\xi(ij)}\right)-m\mathbb{E}_{ij\sim%
\xi}\log\left(1-\frac{q_{\theta,Z}(ij)}{q_{\theta,Z}(ij)+m\xi(ij)}\right),
q_{\theta,Z}(ij)=\phi(ij)/Z
Z
\xi
t
t
t
Z
t
Z(\theta)
t
\mathcal{L}^{\text{UMAP}}(\theta)=-\mathbb{E}_{ij\sim p}\log\big{(}q_{\theta}(%
ij)\big{)}-m\mathbb{E}_{ij\sim\xi}\log\big{(}1-q_{\theta}(ij)\big{)},
q_{\theta}(ij)=\phi(ij)
\xi
m/n
t
\mathcal{O}(n)
\text{s}k\text{NN}
t
Z
\mathcal{L}^{\text{NEG}}(\theta)=-\mathbb{E}_{x\sim p}\log\left(\frac{q_{%
\theta}(x)}{q_{\theta}(x)+1}\right)-m\mathbb{E}_{x\sim\xi}\log\left(1-\frac{q_%
{\theta}(x)}{q_{\theta}(x)+1}\right).
\bar{Z},m\in\mathbb{R}_{+}
\xi
\theta^{*}
q_{\theta^{*}}=\bar{Z}p
\theta^{*}
\mathcal{L}^{\textup{NCE}}_{\bar{Z}}(\theta)=-\mathbb{E}_{x\sim p}\log\left(%
\frac{q_{\theta}(x)}{q_{\theta}(x)+\bar{Z}m\xi(x)}\right)-m\mathbb{E}_{x\sim%
\xi}\log\left(1-\frac{q_{\theta}(x)}{q_{\theta}(x)+\bar{Z}m\xi(x)}\right)
\mathcal{L}^{\textup{NCE}}_{\bar{Z}}
\tilde{\theta}
q_{\tilde{\theta}}=\bar{Z}p
\tilde{q}_{\theta}\coloneqq q_{\theta}/\bar{Z}
\xi(x)=1/|X|
X
m=|X|
m\xi(x)=1
m\ll|X|
\bar{Z}=|X|/m
(|X|/m)m\xi(x)=1
\theta^{*}
q_{\theta^{*}}=(|X|/m)p
q_{\theta}
|X|/m
m\ll|X|
m
b
|X|
m\ll|X|
q_{\theta}/Z
Z
q_{\theta}/\bar{Z}
\bar{Z}=|X|/m
q_{\theta}
\bar{Z}
t
|X|=\binom{n}{2}
t
Z(\theta)
50n
100n
t
\bar{Z}=\mathcal{O}(n^{2})
\phi(ij)
\text{s}k\text{NN}
t
t
t
t
Z
Z
\bar{Z}
\theta^{*}
\bar{Z}
\bar{Z}=|X|/m
\bar{Z}
t
t
\bar{Z}
\bar{Z}
q_{\theta}
\bar{Z}
\bar{Z}
\bar{Z}
\sum_{x}q_{\theta}(x)
\bar{Z}
\sum_{ij}\phi(ij)
\bar{Z}
1
\bar{Z}>\binom{n}{2}
\bar{Z}
\bar{Z}
t
t
t
t
\theta^{*}
Z^{\text{NC-}t\text{-SNE}}
t
\bar{Z}=Z^{\text{NC-}t\text{-SNE}}
\theta^{*}
\bar{Z}=Z^{\text{NC-}t\text{-SNE}}
t
t
\bar{Z}
Z(\theta^{t\text{-SNE}})
t
t
t
k
t
t
m
\bar{Z}
\bar{Z}m
m
\text{s}k\text{NN}
\bar{Z}m
t
t
t
t
t
t
1/d_{ij}^{2}
t
t
1/d_{ij}^{2}
t
t
t
\text{s}k\text{NN}
\tilde{q}_{\theta}(ij)=1/d_{ij}^{2}
q_{\theta}(ij)=1/(1+d_{ij}^{2})=(1/d_{ij}^{2})/(1/d_{ij}^{2}+1)=\tilde{q}_{%
\theta}(ij)/\big{(}\tilde{q}_{\theta}(ij)+1\big{)}.
\tilde{q}_{\theta}
d_{ij}
1/d_{ij}^{2}
d_{ij}\to 0
1/(1+d_{ij}^{2})
t
\bar{Z}=|X|/m
t
-\log\big{(}1/(d_{ij}^{2}+1)\big{)}=\log(1+d_{ij}^{2})
-\log\big{[}1/(d_{ij}^{2}+1)/\big{(}1/(d_{ij}^{2}+1)+1\big{)}\big{]}=\log(2+d_%
{ij}^{2})
t
\log\big{(}(1+d_{ij}^{2})/d_{ij}^{2}\big{)}
\log\big{(}(2+d_{ij}^{2})/(1+d_{ij}^{2})\big{)}
t
t
1/d_{ij}^{2}
t
t
t
\bar{Z}
t
Z
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
m=5
b=1024
m=5
b=1024
t
t
k
\sim 128
2
m
t
t
t
m=5
t
t
t
m=500
t
t
m=5
m=500
t
t
t
t
\mathbb{R}^{D}\to\mathbb{R}^{d}
b=1024
m
Z
t
t
k
t
b=1024
m
H\in\mathbb{R}^{512}
\pm
b=1024
m
H\in\mathbb{R}^{512}
\pm
m=2
m=16
m=128
m=512
m=2b-2
k
86.9\pm 0.2
91.7\pm 0.1
92.0\pm 0.3
92.2\pm 0.2
91.9\pm 0.1
90.7\pm 0.2
93.1\pm 0.2
93.3\pm 0.3
93.2\pm 0.3
93.3\pm 0.1
m
m=16
b=1024
m
m=16
m
m
m
m=5
Z
\bar{Z}
t
t
\bar{Z}^{\text{UMAP}}=\binom{n}{2}/m
t
Z^{t\text{-SNE}}
[50n,100n]
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=\bar{Z}^{\text{UMAP}}
\bar{Z}
t
t
t
t
t
S^{128}
t
t
S
N
s_{1},\dots,s_{N}
m
t_{1},\dots,t_{mN}
\xi
\mathbb{P}(y|x)
x\in S
y=\text{data}
y=\text{noise}
x
\mathbb{P}(x|\text{noise})
\xi
\mathbb{P}(x|\text{data})
p
q_{\theta}
S
m
\mathbb{P}(\text{data})=1/(m+1)
\mathbb{P}(\text{noise})=m/(m+1)
S
\mathbb{P}(x)=(q_{\theta}(x)+m\xi(x))/(m+1)
x
S
\mathbb{P}(\text{data}|x)=\frac{\mathbb{P}(x|\text{data})\mathbb{P}(\text{data%
})}{\mathbb{P}(x)}=\frac{q_{\theta}(x)}{q_{\theta}(x)+m\xi(x)}.
\theta
\theta^{*}=\operatorname*{arg\,min}_{\theta}\left[-\sum_{i=1}^{N}\log\left(%
\frac{q_{\theta}(s_{i})}{q_{\theta}(s_{i})+m\xi(s_{i})}\right)-\sum_{i=1}^{mN}%
\log\left(1-\frac{q_{\theta}(t_{i})}{q_{\theta}(t_{i})+m\xi(t_{i})}\right)%
\right].
\mathcal{L}^{\mathrm{NCE}}(\theta)=-\mathbb{E}_{s\sim p}\log\left(\frac{q_{%
\theta}(s)}{q_{\theta}(s)+m\xi(s)}\right)-m\mathbb{E}_{t\sim\xi}\log\left(1-%
\frac{q_{\theta}(t)}{q_{\theta}(t)+m\xi(t)}\right)\,.
q_{\theta}(x)/\big{(}q_{\theta}(x)+m\xi(x)\big{)}=1/\Big{[}1+\Big{(}q_{\theta}%
(x)/\big{(}m\xi(x)\big{)}\Big{)}^{-1}\Big{]}
\log\left(\frac{q_{\theta}(x)}{m\xi(x)}\right)
\mathcal{L}^{\mathrm{NCE}}(\theta)=-\mathbb{E}_{s\sim p}\log\left(\sigma\left(%
\log\left(\frac{q_{\theta}(s)}{m\xi(s)}\right)\right)\right)-m\mathbb{E}_{t%
\sim\xi}\log\left(1-\sigma\left(\log\left(\frac{q_{\theta}(t)}{m\xi(t)}\right)%
\right)\right)\,,
\sigma(x)=1/\big{(}1+\exp(-x)\big{)}
m+1
T=(x_{0},\dots,x_{m})
m+1
Y
\mathbb{P}(Y=k)=1/(m+1)
k=0,\dots,m
k
\mathbb{P}(x_{i}|Y=k)=\xi(x_{i})
i\neq k
\mathbb{P}(x_{k}|Y=k)=q_{\theta}(x_{k})
T
Y=k
\mathbb{P}(T|Y=k)=q_{\theta}(x_{k})\prod_{i\neq k}\xi(x_{i})=\frac{q_{\theta}(%
x_{k})}{\xi(x_{k})}\prod_{i=0}^{m}\xi(x_{i}).
Y
\mathbb{P}(T)=\frac{1}{m+1}\prod_{i=0}^{m}\xi(x_{i})\sum_{k=0}^{m}\frac{q_{%
\theta}(x_{k})}{\xi(x_{k})}.
\mathbb{P}(Y=k|T)=\frac{\mathbb{P}(T|Y=k)\mathbb{P}(Y=k)}{\mathbb{P}(T)}=\frac%
{\frac{q_{\theta}(x_{k})}{\xi(x_{k})}}{\sum_{i=0}^{m}\frac{q_{\theta}(x_{i})}{%
\xi(x_{i})}}=\frac{q_{\theta}(x_{k})}{\sum_{i=0}^{m}q_{\theta}(x_{i})},
\xi
\mathcal{L}^{\text{InfoNCE}}(\theta)=-\mathop{\mathbb{E}}\limits_{\begin{%
subarray}{c}x\sim p\\
x_{1},\dots,x_{m}\sim\xi\end{subarray}}\log\left(\frac{q_{\theta}(x)}{q_{%
\theta}(x)+\sum_{i=1}^{m}q_{\theta}(x_{i})}\right).
\log\left(\frac{q_{\theta}(x_{i})}{\xi(x_{i})}\right)
q_{\theta}(x)=\phi_{\theta}(x)/Z(\theta)
Z(\theta)=\sum_{x^{\prime}}\phi_{\theta}(x^{\prime})
q_{\theta,Z}(x)=\phi_{\theta}(x)/Z
Z
q_{\theta,\bar{Z}}(x)=\phi_{\theta}(x)/\bar{Z}
\bar{Z}
\bar{Z}
\xi
\bar{Z}=|X|/m
\xi(x)=1/|X|
\displaystyle\mathcal{L}^{\text{MLE}}(\theta)=-\mathbb{E}_{x\sim p}\log\big{(}%
q_{\theta}(x)\big{)},
\displaystyle\mathcal{L}^{\text{MLE}}(\theta)
\displaystyle=-\mathbb{E}_{x\sim p}\log\big{(}q_{\theta}(x)\big{)},
\displaystyle\mathcal{L}^{\mathrm{NCE}}(\theta,Z)=-\mathbb{E}_{x\sim p}\log%
\left(\frac{q_{\theta,Z}(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)-m\mathbb{E}_{x%
\sim\xi}\log\left(1-\frac{q_{\theta,Z}(x)}{q_{\theta,Z}(x)+m\xi(x)}\right),
\displaystyle\mathcal{L}^{\mathrm{NCE}}(\theta,Z)
\displaystyle=-\mathbb{E}_{x\sim p}\log\left(\frac{q_{\theta,Z}(x)}{q_{\theta,%
Z}(x)+m\xi(x)}\right)-m\mathbb{E}_{x\sim\xi}\log\left(1-\frac{q_{\theta,Z}(x)}%
{q_{\theta,Z}(x)+m\xi(x)}\right),
\displaystyle\mathcal{L}^{\text{NEG}}(\theta,\bar{Z})=-\mathbb{E}_{x\sim p}%
\log\left(\frac{q_{\theta,\bar{Z}}(x)}{q_{\theta,\bar{Z}}(x)+m\xi(x)}\right)-m%
\mathbb{E}_{x\sim\xi}\log\left(1-\frac{q_{\theta,\bar{Z}}(x)}{q_{\theta,\bar{Z%
}}(x)+m\xi(x)}\right),
\displaystyle\mathcal{L}^{\text{NEG}}(\theta,\bar{Z})
\displaystyle=-\mathbb{E}_{x\sim p}\log\left(\frac{q_{\theta,\bar{Z}}(x)}{q_{%
\theta,\bar{Z}}(x)+m\xi(x)}\right)-m\mathbb{E}_{x\sim\xi}\log\left(1-\frac{q_{%
\theta,\bar{Z}}(x)}{q_{\theta,\bar{Z}}(x)+m\xi(x)}\right),
\displaystyle\mathcal{L}^{\text{NEG}}(\theta)=-\mathbb{E}_{x\sim p}\log\left(%
\frac{\phi_{\theta}(x)}{\phi_{\theta}(x)+1}\right)-m\mathbb{E}_{x\sim\xi}\log%
\left(1-\frac{\phi_{\theta}(x)}{\phi_{\theta}(x)+1}\right).
\displaystyle\mathcal{L}^{\text{NEG}}(\theta)
\displaystyle=-\mathbb{E}_{x\sim p}\log\left(\frac{\phi_{\theta}(x)}{\phi_{%
\theta}(x)+1}\right)-m\mathbb{E}_{x\sim\xi}\log\left(1-\frac{\phi_{\theta}(x)}%
{\phi_{\theta}(x)+1}\right).
\displaystyle\frac{d\mathcal{L}^{\text{MLE}}(\theta)}{d\theta}=\frac{d}{d%
\theta}\left(-\mathbb{E}_{x\sim p}\log\big{(}q_{\theta}(x)\big{)}\right)
\displaystyle\frac{d\mathcal{L}^{\text{MLE}}(\theta)}{d\theta}
\displaystyle=\frac{d}{d\theta}\left(-\mathbb{E}_{x\sim p}\log\big{(}q_{\theta%
}(x)\big{)}\right)
\displaystyle=\frac{d}{d\theta}\left(-\sum_{x}\Big{(}p(x)\log\big{(}\phi_{%
\theta}(x)\big{)}\Big{)}+\log\Big{(}\sum_{x}\phi_{\theta}(x)\Big{)}\right)
\displaystyle=\frac{d}{d\theta}\left(-\sum_{x}\Big{(}p(x)\log\big{(}\phi_{%
\theta}(x)\big{)}\Big{)}+\log\Big{(}\sum_{x}\phi_{\theta}(x)\Big{)}\right)
\displaystyle=-\sum_{x}\left(\frac{p(x)}{\phi_{\theta}(x)}\cdot\frac{d\phi_{%
\theta}(x)}{d\theta}\right)-\frac{1}{\sum_{x}\phi_{\theta}(x)}\cdot\sum_{x}%
\frac{d\phi_{\theta}(x)}{d\theta}
\displaystyle=-\sum_{x}\left(\frac{p(x)}{\phi_{\theta}(x)}\cdot\frac{d\phi_{%
\theta}(x)}{d\theta}\right)-\frac{1}{\sum_{x}\phi_{\theta}(x)}\cdot\sum_{x}%
\frac{d\phi_{\theta}(x)}{d\theta}
\displaystyle=-\sum_{x}\left(\frac{p(x)}{q_{\theta}(x)}-1\right)\cdot\frac{1}{%
Z(\theta)}\cdot\frac{d\phi_{\theta}(x)}{d\theta}.
\displaystyle=-\sum_{x}\left(\frac{p(x)}{q_{\theta}(x)}-1\right)\cdot\frac{1}{%
Z(\theta)}\cdot\frac{d\phi_{\theta}(x)}{d\theta}.
\displaystyle\frac{d\log\left(\frac{f(z)}{f(z)+c}\right)}{dz}=\frac{d\log\left%
(\frac{1}{1+c/f(z)}\right)}{dz}
\displaystyle\frac{d\log\left(\frac{f(z)}{f(z)+c}\right)}{dz}
\displaystyle=\frac{d\log\left(\frac{1}{1+c/f(z)}\right)}{dz}
\displaystyle=-\frac{d\log(1+c/f(z))}{dz}
\displaystyle=-\frac{d\log(1+c/f(z))}{dz}
\displaystyle=-\frac{1}{1+c/f(z)}\cdot\frac{-c}{f(z)^{2}}\cdot\frac{df(z)}{dz},
\displaystyle=-\frac{1}{1+c/f(z)}\cdot\frac{-c}{f(z)^{2}}\cdot\frac{df(z)}{dz},
\displaystyle=\frac{c}{f(z)+c}\cdot\frac{1}{f(z)}\cdot\frac{df(z)}{dz}
\displaystyle=\frac{c}{f(z)+c}\cdot\frac{1}{f(z)}\cdot\frac{df(z)}{dz}
\displaystyle\frac{d\log\left(\frac{c}{f(z)+c}\right)}{dz}=-\frac{d\log\left(f%
(z)/c+1\right)}{dz}
\displaystyle\frac{d\log\left(\frac{c}{f(z)+c}\right)}{dz}
\displaystyle=-\frac{d\log\left(f(z)/c+1\right)}{dz}
\displaystyle=-\frac{1}{f(z)/c+1}\cdot\frac{1}{c}\cdot\frac{df(z)}{dz}
\displaystyle=-\frac{1}{f(z)/c+1}\cdot\frac{1}{c}\cdot\frac{df(z)}{dz}
\displaystyle=-\frac{1}{f(x)+c}\cdot\frac{df(z)}{dz}
\displaystyle=-\frac{1}{f(x)+c}\cdot\frac{df(z)}{dz}
f(z)
c
z
\displaystyle\frac{d\mathcal{L}^{\text{NCE}}(\theta,Z)}{d\theta}=\frac{d}{d%
\theta}\left(-\mathbb{E}_{x\sim p}\log\left(\frac{q_{\theta,Z}(x)}{q_{\theta,Z%
}(x)+m\xi(x)}\right)-m\mathbb{E}_{x\sim\xi}\log\left(1-\frac{q_{\theta,Z}(x)}{%
q_{\theta,Z}(x)+m\xi(x)}\right)\right)
\displaystyle\frac{d\mathcal{L}^{\text{NCE}}(\theta,Z)}{d\theta}
\displaystyle=\frac{d}{d\theta}\left(-\mathbb{E}_{x\sim p}\log\left(\frac{q_{%
\theta,Z}(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)-m\mathbb{E}_{x\sim\xi}\log\left(%
1-\frac{q_{\theta,Z}(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)\right)
\displaystyle=\frac{d}{d\theta}\left(-\mathbb{E}_{x\sim p}\log\left(\frac{q_{%
\theta,Z}(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)-m\mathbb{E}_{x\sim\xi}\log\left(%
\frac{m\xi(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)\right)
\displaystyle=\frac{d}{d\theta}\left(-\mathbb{E}_{x\sim p}\log\left(\frac{q_{%
\theta,Z}(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)-m\mathbb{E}_{x\sim\xi}\log\left(%
\frac{m\xi(x)}{q_{\theta,Z}(x)+m\xi(x)}\right)\right)
\displaystyle=-\sum_{x}\left[p(x)\frac{m\xi(x)}{q_{\theta,Z}(x)+m\xi(x)}\frac{%
1}{q_{\theta,Z}(x)}\frac{dq_{\theta,Z}(x)}{d\theta}\right.
\displaystyle=-\sum_{x}\left[p(x)\frac{m\xi(x)}{q_{\theta,Z}(x)+m\xi(x)}\frac{%
1}{q_{\theta,Z}(x)}\frac{dq_{\theta,Z}(x)}{d\theta}\right.
\displaystyle\left.\hskip 42.67912pt+m\xi(x)\frac{-1}{q_{\theta,Z}(x)+m\xi(x)}%
\frac{dq_{\theta,Z}(x)}{d\theta}\right]
\displaystyle\left.\hskip 42.67912pt+m\xi(x)\frac{-1}{q_{\theta,Z}(x)+m\xi(x)}%
\frac{dq_{\theta,Z}(x)}{d\theta}\right]
\displaystyle=-\sum_{x}\left(\frac{p(x)}{q_{\theta,Z}(x)}-1\right)\frac{m\xi(x%
)}{q_{\theta,Z}(x)+m\xi(x)}\frac{1}{Z}\frac{d\phi_{\theta}(x)}{d\theta}.
\displaystyle=-\sum_{x}\left(\frac{p(x)}{q_{\theta,Z}(x)}-1\right)\frac{m\xi(x%
)}{q_{\theta,Z}(x)+m\xi(x)}\frac{1}{Z}\frac{d\phi_{\theta}(x)}{d\theta}.
f(z)=q_{\theta,Z}(x)
c=m\xi(x)
q_{\theta,Z}(x)
q_{\theta,\bar{Z}}(x)
\displaystyle\frac{d\mathcal{L}^{\text{MLE}}(\theta)}{d\theta}=-\sum_{x\in X}%
\left(\frac{p(x)}{q_{\theta}(x)}-1\right)
\displaystyle\frac{d\mathcal{L}^{\text{MLE}}(\theta)}{d\theta}
\displaystyle=-\sum_{x\in X}\left(\frac{p(x)}{q_{\theta}(x)}-1\right)
\displaystyle\frac{1}{Z(\theta)}
\displaystyle\frac{1}{Z(\theta)}
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta},
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta},
\displaystyle\frac{d\mathcal{L}^{\text{NCE}}(\theta,Z)}{d\theta}=-\sum_{x\in X%
}\left(\frac{p(x)}{q_{\theta,Z}(x)}-1\right)
\displaystyle\frac{d\mathcal{L}^{\text{NCE}}(\theta,Z)}{d\theta}
\displaystyle=-\sum_{x\in X}\left(\frac{p(x)}{q_{\theta,Z}(x)}-1\right)
\displaystyle\frac{m\xi(x)}{q_{\theta,Z}(x)+m\xi(x)}\kern 8.5359pt\frac{1}{Z}
\displaystyle\frac{m\xi(x)}{q_{\theta,Z}(x)+m\xi(x)}
\displaystyle\kern 8.5359pt\frac{1}{Z}
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta},
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta},
\displaystyle\frac{d\mathcal{L}^{\text{NEG}}(\theta,\bar{Z})}{d\theta}=-\sum_{%
x\in X}\left(\frac{p(x)}{q_{\theta,\bar{Z}}(x)}-1\right)
\displaystyle\frac{d\mathcal{L}^{\text{NEG}}(\theta,\bar{Z})}{d\theta}
\displaystyle=-\sum_{x\in X}\left(\frac{p(x)}{q_{\theta,\bar{Z}}(x)}-1\right)
\displaystyle\frac{m\xi(x)}{q_{\theta,\bar{Z}}(x)+m\xi(x)}\kern 8.5359pt\frac{%
1}{\bar{Z}}
\displaystyle\frac{m\xi(x)}{q_{\theta,\bar{Z}}(x)+m\xi(x)}
\displaystyle\kern 8.5359pt\frac{1}{\bar{Z}}
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta},
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta},
\displaystyle\frac{d\mathcal{L}^{\text{NEG}}(\theta)}{d\theta}=-\sum_{x\in X}%
\left(\frac{p(x)}{\phi_{\theta}(x)}-\frac{m}{|X|}\right)
\displaystyle\frac{d\mathcal{L}^{\text{NEG}}(\theta)}{d\theta}
\displaystyle=-\sum_{x\in X}\left(\frac{p(x)}{\phi_{\theta}(x)}-\frac{m}{|X|}\right)
\displaystyle\frac{1}{\phi_{\theta}(x)+1}\kern 14.22636pt
\displaystyle\frac{1}{\phi_{\theta}(x)+1}\kern 14.22636pt
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta}.
\displaystyle\frac{d\phi_{\theta}(x)}{d\theta}.
m\xi(x)
\mathcal{L}^{\text{NCE}}
\mathcal{L}^{\text{NEG}}
m\to\infty
q_{\theta}
q_{\theta,Z}
q_{\theta,\bar{Z}}
p
t
t
t
t
\bar{Z}
\bar{Z}=\binom{n}{2}/m
X=\{ij|1\leq i<j\leq n\}
\theta=\{e_{1},\dots,e_{n}\}
\phi(ij)=1/(1+\|e_{i}-e_{j}\|^{2})
\xi(ij)\approx\binom{n}{2}^{-1}
\displaystyle\frac{d\mathcal{L}^{t\text{-SNE}}}{de_{i}}=2\sum_{j\neq i}
\displaystyle\frac{d\mathcal{L}^{t\text{-SNE}}}{de_{i}}
\displaystyle=2\sum_{j\neq i}
\displaystyle\bigg{(}p(ij)-\frac{\phi(ij)}{\sum_{k\neq l}\phi(kl)}\bigg{)}
\displaystyle\bigg{(}p(ij)
\displaystyle-\frac{\phi(ij)}{\sum_{k\neq l}\phi(kl)}\bigg{)}
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\frac{d\mathcal{L}^{\text{NC-}t\text{-SNE}}}{de_{i}}=2\sum_{j\neq
i%
}\underbrace{\frac{m\xi(ij)}{\frac{\phi(ij)}{Z}+m\xi(ij)}}_{\to 1\text{ for }m%
\to\infty}
\displaystyle\frac{d\mathcal{L}^{\text{NC-}t\text{-SNE}}}{de_{i}}
\displaystyle=2\sum_{j\neq i}\underbrace{\frac{m\xi(ij)}{\frac{\phi(ij)}{Z}+m%
\xi(ij)}}_{\to 1\text{ for }m\to\infty}
\displaystyle\bigg{(}p(ij)-\hskip 11.38092pt\frac{\phi(ij)}{Z}\bigg{)}
\displaystyle\bigg{(}p(ij)
\displaystyle-\hskip 11.38092pt\frac{\phi(ij)}{Z}\bigg{)}
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\frac{d\mathcal{L}^{\text{Neg-}t\text{-SNE}}(\bar{Z})}{de_{i}}=2%
\sum_{j\neq i}\overbrace{\frac{m\xi(ij)}{\frac{\phi(ij)}{\vphantom{\hat{Z}}%
\bar{Z}}+m\xi(ij)}}
\displaystyle\frac{d\mathcal{L}^{\text{Neg-}t\text{-SNE}}(\bar{Z})}{de_{i}}
\displaystyle=2\sum_{j\neq i}\overbrace{\frac{m\xi(ij)}{\frac{\phi(ij)}{%
\vphantom{\hat{Z}}\bar{Z}}+m\xi(ij)}}
\displaystyle\bigg{(}p(ij)-\hskip 11.38092pt\frac{\phi(ij)}{\bar{Z}}\bigg{)}
\displaystyle\bigg{(}p(ij)
\displaystyle-\hskip 11.38092pt\frac{\phi(ij)}{\bar{Z}}\bigg{)}
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\frac{d\mathcal{L}^{\text{Neg-}t\text{-SNE}}}{de_{i}}\approx 2%
\sum_{j\neq i}\hskip 9.95863pt\underbrace{\frac{1}{\phi(ij)+1}}_{\in[0.5,1]}
\displaystyle\frac{d\mathcal{L}^{\text{Neg-}t\text{-SNE}}}{de_{i}}
\displaystyle\approx 2\sum_{j\neq i}\hskip 9.95863pt\underbrace{\frac{1}{\phi(%
ij)+1}}_{\in[0.5,1]}
\displaystyle\bigg{(}p(ij)-\hskip 8.5359pt\frac{\phi(ij)}{\binom{n}{2}/m}\bigg%
{)}
\displaystyle\bigg{(}p(ij)
\displaystyle-\hskip 8.5359pt\frac{\phi(ij)}{\binom{n}{2}/m}\bigg{)}
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\frac{d\mathcal{L}^{\text{UMAP}}}{de_{i}}=2\sum_{j\neq i}
\displaystyle\frac{d\mathcal{L}^{\text{UMAP}}}{de_{i}}
\displaystyle=2\sum_{j\neq i}
\displaystyle\bigg{(}p(ij)-\hskip 8.5359pt\frac{\phi(ij)}{\binom{n}{2}/m}%
\underbrace{\frac{1}{1-\phi(ij)}}_{\begin{subarray}{c}\text{numerically %
unstable}\\
\text{for $e_{i}\approx e_{j}$}\end{subarray}}\bigg{)}
e_{i}\approx e_{j}
\displaystyle\bigg{(}p(ij)
\displaystyle-\hskip 8.5359pt\frac{\phi(ij)}{\binom{n}{2}/m}\underbrace{\frac{%
1}{1-\phi(ij)}}_{\begin{subarray}{c}\text{numerically unstable}\\
\text{for $e_{i}\approx e_{j}$}\end{subarray}}\bigg{)}
e_{i}\approx e_{j}
\displaystyle\phi(ij)(e_{j}-e_{i})
\displaystyle\phi(ij)(e_{j}-e_{i})
t
t
m\to\infty
t
\bar{Z}
\xi(ij)\approx\binom{n}{2}^{-1}
[0.5,1]
t
1/\bar{Z}
n(n-1)/(2m)
\sum_{k\neq l}\phi(kl)
t
Z
t
[50n,100n]
t
t
t
e_{i}\approx e_{j}
\phi(ij)\approx 1
\mu(ij)\in[0,1]
\text{s}k\text{NN}
\phi(ij)
ij
-\sum_{ij}\Big{[}\mu(ij)\log\big{(}\phi(ij)\big{)}+\big{(}1-\mu(ij)\big{)}\log%
\big{(}1-\phi(ij)\big{)}\Big{]}\,.
\mu(ij)=\phi(ij)
ij
\mu(ij)
\text{s}k\text{NN}
1-\mu(ij)
1-\mu(ij)
1
-\sum_{ij}\Big{[}\mu(ij)\log\big{(}\phi(ij)\big{)}+\log\big{(}1-\phi(ij)\big{)%
}\Big{]}\,.
-\sum_{ij}\Big{[}\mu(ij)\log\big{(}\phi(ij)\big{)}+\frac{m(d_{i}+d_{j})}{2n}%
\log\big{(}1-\phi(ij)\big{)}\Big{]}\,,
d_{i}=\sum_{j}\mu(ij)
i
m
m=5
d_{i}\approx\log(k)
m\log(k)/n
\mu(ij)
\mu(ij)
\sum_{ij}\mu(ij)
m
p(ij)=\mu(ij)/\sum_{ij}\mu(ij)
\xi(ij)=\big{(}p(i)+p(j)\big{)}/2n
p(i)=\sum_{j}p(ij)
-\sum_{ij}p(ij)\log\big{(}\phi(ij)\big{)}-m\sum_{ij}\xi(ij)\log\big{(}1-\phi(%
ij)\big{)},
-\mathbb{E}_{ij\sim p}\log\big{(}\phi(ij)\big{)}-m\mathbb{E}_{ij\sim\xi}\log%
\big{(}1-\phi(ij)\big{)},
ij
ji
E:=2|\text{s}k\text{NN}|
p(ij)=p(ji)
\sum_{i,j=1}^{n}p(ij)=1
ij
p(i)=\sum_{j=1}^{n}p(ij)
\sum_{i}p(i)=1
p(i)
p(ij)
\text{s}k\text{NN}
\xi(ij)=\frac{p(i)+p(j)}{2n}\,.
\text{s}k\text{NN}
\xi
\xi(ij)=\frac{p(i)}{n}\,.
\mathbb{P}(\text{data}|ij)=\frac{q_{\theta,Z}(ij)}{q_{\theta,Z}(ij)+m\xi(ij)}\,.
\mathbb{P}(\text{data}|ij)=\frac{q_{\theta,Z}(ij)}{q_{\theta,Z}(ij)+m\frac{1}{%
2|\text{s}k\text{NN}|}}\,.
e_{i}
e_{j}
ij
ji
\mathbb{E}_{ij\sim\xi}\log\left(1-\frac{q_{\theta,Z}(ij)}{q_{\theta,Z}(ij)+m%
\frac{1}{2|\text{s}k\text{NN}|}}\right)
\xi(ij)=p(i)/n
\xi(ij)=\frac{p(i)+p(j)}{2n}\,.
\text{s}k\text{NN}
m
ij
ik
lj
jl
ij
E
\text{s}k\text{NN}
ij
B
b
Y_{rs}
rs
B
Y_{\neg rs}=\sum_{t\neq r}Y_{ts}
Y_{r\neg s}=\sum_{t\neq s}Y_{rt}
p(r\neg s)\coloneqq p(\neg sr)\coloneqq p(r)-p(rs)
i
B
m
B
i
i
ii
m
ij
i
j
i
Y_{ij}+Y_{i\neg j}
j
Y_{ij}+Y_{ji}+Y_{\neg ij}+Y_{j\neg i}
j
1/(2b-1)
N_{ij}
ij
i\neq j
B
\displaystyle N_{ij}=m(Y_{ij}+Y_{i\neg j})\frac{Y_{ij}+Y_{ji}+Y_{\neg ij}+Y_{j%
\neg i}}{2b-1}.
\displaystyle N_{ij}
\displaystyle=m(Y_{ij}+Y_{i\neg j})\frac{Y_{ij}+Y_{ji}+Y_{\neg ij}+Y_{j\neg i}%
}{2b-1}.
i
ii
N_{ii}=m\sum_{j}Y_{ij}\frac{Y_{ij}-1+Y_{i\neg j}+Y_{ji}+Y_{\neg ji}}{2b-1}.
Y_{rs}
\displaystyle\mathbb{E}(Y_{rs})=bp(rs),
\displaystyle\mathbb{E}(Y_{rs})
\displaystyle=bp(rs),
\displaystyle\mathbb{E}(Y_{\neg rs})=bp(\neg rs),
\displaystyle\mathbb{E}(Y_{\neg rs})
\displaystyle=bp(\neg rs),
\displaystyle\text{Var}(Y_{rs})=b\frac{E-b}{E-1}p(rs)\big{(}1-p(rs)\big{)},
\displaystyle\text{Var}(Y_{rs})
\displaystyle=b\frac{E-b}{E-1}p(rs)\big{(}1-p(rs)\big{)},
\displaystyle\text{Cov}(Y_{rs},Y_{\neg uv})=-b\frac{E-b}{E-1}p(rs)p(\neg uv).
\displaystyle\text{Cov}(Y_{rs},Y_{\neg uv})
\displaystyle=-b\frac{E-b}{E-1}p(rs)p(\neg uv).
p(rs)=p(sr)
N_{ij}
\displaystyle\mathbb{E}(N_{ij})=\frac{mb}{2b-1}\left(\frac{E-b}{E-1}p(ij)+2%
\left(b-\frac{E-b}{E-1}\right)p(i)p(j)\right).
\displaystyle\mathbb{E}(N_{ij})=\frac{mb}{2b-1}\left(\frac{E-b}{E-1}p(ij)+2%
\left(b-\frac{E-b}{E-1}\right)p(i)p(j)\right).
m
b
\mathbb{E}(N_{ij})
mb
\xi(ij)
\xi(ij)=\frac{1}{2b-1}\left(\frac{E-b}{E-1}p(ij)+2\left(b-\frac{E-b}{E-1}%
\right)p(i)p(j)\right).
\mathbb{E}(N_{ii})=\frac{mb}{2b-1}\left(-\frac{b-1}{E-1}p(i)+2\left(b-\frac{E-%
b}{E-1}\right)p(i)^{2}\right)
ii
\xi(ii)=\frac{1}{2b-1}\left(-\frac{b-1}{E-1}p(i)+2\left(b-\frac{E-b}{E-1}%
\right)p(i)^{2}\right).
b
ij
b=1
\xi(ij)=p(ij),
b=E
\xi(ij)=\frac{2E}{2E-1}p(i)p(j)
1
E
E\approx 1.5\cdot 10^{6}
b=1024
0.0005
p(i)p(j)
0.9995
\zeta=10^{-3}
\zeta=10^{-3}
\zeta=10^{-10}
\zeta=10^{-10}
\zeta=0
\zeta=0
\zeta=10^{-3}
\zeta=10^{-3}
\zeta=10^{-10}
\zeta=10^{-10}
\zeta=0
\zeta=0
\zeta
\zeta
\zeta
\zeta
-\log(1-\phi(ij))=\log\left(\frac{1+d_{ij}^{2}}{d_{ij}^{2}}\right)
e_{i}
ij
2\frac{1}{d_{ij}^{2}+\zeta}\frac{1}{1+d_{ij}^{2}}(e_{j}-e_{i})
\zeta=0.001
\zeta=0
-\mathbb{E}_{ij\sim p}\log(\phi(ij))-m\Big{(}1+\frac{\zeta}{1-\zeta}\Big{)}%
\mathbb{E}_{ij\sim\xi}\log\left(1+\frac{\zeta}{1-\zeta}-\phi(ij)\right).
\zeta
\zeta
\zeta=10^{-10}
\zeta=0
\zeta=0
\log(0)
\varepsilon=10^{-4}
-\mathbb{E}_{ij\sim p}\log\left(\max\Big{\{}\varepsilon,\frac{1}{1+d_{ij}^{2}}%
\Big{\}}\right)-m\mathbb{E}_{ij\sim\xi}\log\left(\max\Big{\{}\varepsilon,1-%
\frac{1}{1+d_{ij}^{2}}\Big{\}}\right).
\varepsilon
\varepsilon=0
ii
ii
\varepsilon=10^{-4}
\varepsilon=10^{-4}
\varepsilon=10^{-10}
\varepsilon=10^{-10}
\varepsilon=10^{-4}
\varepsilon=10^{-4}
\varepsilon=10^{-10}
\varepsilon=10^{-10}
t
\varepsilon=10^{-4}
t
\varepsilon=10^{-4}
t
\varepsilon=10^{-10}
t
\varepsilon=10^{-10}
t
\varepsilon=0
t
\varepsilon=0
t
\varepsilon=10^{-4}
t
\varepsilon=10^{-4}
t
\varepsilon=10^{-10}
t
\varepsilon=10^{-10}
t
\varepsilon=0
t
\varepsilon=0
t
\varepsilon
\varepsilon
\varepsilon=0
t
t
\varepsilon
\varepsilon
\varepsilon=0
t
t
-\log\left(1-\frac{\frac{1}{1+d_{ij}^{2}}}{\frac{1}{1+d_{ij}^{2}}+1}\right)=%
\log\left(\frac{2+d_{ij}^{2}}{1+d_{ij}^{2}}\right)\leq\log(2)
d_{ij}\to 0
t
\varepsilon=0
\varepsilon=10^{-10}
\displaystyle-\log\Big{(}\max\big{(}\varepsilon,\phi(ij)\big{)}\Big{)}\to-\log%
\bigg{(}\sigma\Big{(}\log\big{(}\phi(ij)\big{)}\Big{)}\bigg{)},
\displaystyle-\log\Big{(}\max\big{(}\varepsilon,\phi(ij)\big{)}\Big{)}
\displaystyle\to-\log\bigg{(}\sigma\Big{(}\log\big{(}\phi(ij)\big{)}\Big{)}%
\bigg{)},
\displaystyle-\log\Big{(}\max\big{(}\varepsilon,1-\phi(ij)\big{)}\Big{)}\to-%
\log\bigg{(}1-\sigma\Big{(}\log\big{(}\phi(ij)\big{)}\Big{)}\bigg{)},
\displaystyle-\log\Big{(}\max\big{(}\varepsilon,1-\phi(ij)\big{)}\Big{)}
\displaystyle\to-\log\bigg{(}1-\sigma\Big{(}\log\big{(}\phi(ij)\big{)}\Big{)}%
\bigg{)},
\sigma(x)=1/\big{(}1+\exp(-x)\big{)}
\phi(ij)=1
\max\big{\{}\varepsilon,\phi(ij)\big{\}}=1
\sigma\Big{(}\log\big{(}\phi(ij)\big{)}\Big{)}=1/2
t
\sigma\Big{(}\log\big{(}\phi(ij)\big{)}\Big{)}=\frac{1}{1+\exp\Big{(}-\log\big%
{(}\phi(ij)\big{)}\Big{)}}=\frac{1}{1+\phi(ij)^{-1}}=\frac{\phi(ij)}{\phi(ij)+%
1}.
1/d_{ij}^{2}
t
t
t
t
(i,j,k)
i
j
i
k
e_{i}
e_{j}
e_{i}
e_{k}
t
m=1
(i,j,k)
i
j
k
12
j
i
(i,j)
k
4
i
j
48
(i,j,k)
i
3
i
j
k
i
j
i
k
i
51
(i,j,k)
51n
w_{ijk}
i
j
i
k
\sum_{ijk\in\text{triplets}}w_{ijk}\frac{\phi(ik)}{\phi(ij)+\phi(ik)}=\text{%
const}-\sum_{ijk\in\text{triplets}}w_{ijk}\frac{\phi(ij)}{\phi(ij)+\phi(ik)}.
t
m=1
-\mathop{\mathbb{E}}\limits_{\begin{subarray}{c}ij\sim p\\
k\sim\mathcal{U}\end{subarray}}\log\left(\frac{\phi(ij)}{\phi(ij)+\phi(ik)}%
\right).
\log
5000
k
k=15
k
k
t
m=1
t
m=1
t
m=1
t
m=1
15
t
w_{ijk}
t
m=1
\frac{d\left(\log\big{(}\frac{\phi(ij)}{\phi(ij)+\phi(ik)}\big{)}\right)}{d%
\theta}=\frac{\phi(ij)+\phi(ik)}{\phi(ij)}\frac{d\big{(}\frac{\phi(ij)}{\phi(%
ij)+\phi(ik)}\big{)}}{d\theta},
t
t
\big{(}\phi(ij)+\phi(ik)\big{)}/\phi(ij)
w_{ijk}
t
m=5
m=1
m=1
m
t
t
t
t
k
0.098\pm 0
0.245\pm 0.005
k
0.099\pm 0
0.232\pm 0.003
0.101\pm 0
0.355\pm 0.004
0.099\pm 0
0.381\pm 0.004
t
m=1
\,0.085\pm 0.001
0.381\pm 0.006
t
m=5
0.104\pm 0
0.365\pm 0.005
t
t
Z(\theta)
n
t
t
t
t
t
\mathcal{O}(kn\log(n)2^{d})
\mathcal{O}(kn2^{d})
t
t
t
t
t
t
t
nm
\mathcal{O}(kmnd)
d
d\gg 2
t
t
t
t
t
t
t
m
t
mkn
Z^{t\text{-SNE}}(\theta)\cdot mkn/\big{(}n(n-1)\big{)}
mk/(n-1)
t
n(n-1)
m=1
Z
Z
\mathcal{L}^{\text{LargeVis}}(\theta)=-\mathbb{E}_{ij\sim p}\log(\phi(ij))-%
\gamma m\mathbb{E}_{ij\sim\xi}\log(1-\phi(ij)).
\gamma
7
\gamma=7
t
m
m=2
t
\frac{d^{2}+1}{d^{2}+1+c}=1-c\cdot\frac{1}{d^{2}+1+c}
c=10
c=10\,000
t
\bar{Z}=c|X|/m
-\log\left(\frac{\phi(d)}{\phi(d)+c}\right)=-\log\left(\frac{1}{(d/\sqrt{c})^{%
2}+1+c}\right).
t
c=10
c=1
\frac{1}{2+d^{2}}=1-\frac{1+d^{2}}{2+d^{2}}.
t
\bar{Z}=|X|/m
-\log\left(1-\frac{\phi(d)}{\phi(d)+1}\right)=-\log\left(\frac{1}{\phi(d)+1}%
\right)=-\log\left(\frac{1+d^{2}}{2+d^{2}}\right).
t
t
t
k
k=15
5000
t
t
\bar{Z}
t
t
k
k
\bar{Z}
\bar{Z}
t
Z^{t\text{-SNE}}
t
Z^{\text{NC-}t\text{-SNE}}
\bar{Z}^{\text{UMAP}}
k
\bar{Z}
\bar{Z}^{\text{UMAP}}
Z^{t\text{-SNE}}
k
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}
k
t
k
t
t
\bar{Z}=Z^{t\text{-SNE}}
t
t
t
\bar{Z}
t
t
k
\bar{Z}
Z^{t\text{-SNE}}
t
\bar{Z}\approx\bar{Z}^{\text{UMAP}}
k
\bar{Z}
t
t
k
m
t
t
m
k
t
k
m
t
t
t
t
t
k
t
t
t
t
t
k
t
t
t
t
t
\bar{Z}
t
\bar{Z}
k
t
p\equiv\frac{1}{6}
\bar{Z}
1/(1+0^{2})=1
\bar{Z}=6
\bar{Z}
\bar{Z}
6
0.01
t
\bar{Z}
\bar{Z}
\bar{Z}=6
t
\bar{Z}
\bar{Z}
\bar{Z}=6
70\,000
28\times 28
270\,912
28\times 28
49
60\,000
32\times 32
20\,272
63\,530
1000
\log_{2}(x+1)
50
100
t
t
t
m
t
t
\text{s}k\text{NN}
\text{s}k\text{NN}
\text{s}k\text{NN}
\text{s}k\text{NN}
k=15
\text{s}k\text{NN}
50
t
0.0001
1
0.01
250
t
\bar{Z}
t
\bar{Z}=|X|/m
250
m=5
250
\bar{Z}
m
250
500
[10^{-10},1]
10^{-4}
1024
1
0.001
0
750
m=5
\textit{input dimension}-100-100-100-2
786
\text{s}k\text{NN}
q_{\theta,Z}(x)/(q_{\theta,Z}(x)+m)
q_{\theta,Z}(x)/\big{(}q_{\theta,Z}(x)+m\xi(x)\big{)}
Z
n(n-1)
t
t
q_{\theta}(x)/(q_{\theta}(x)+\bar{Z}m/|X|)
q_{\theta}(x)/\big{(}q_{\theta}(x)+\bar{Z}m\xi(x)\big{)}
t
m
\bar{Z}
\gamma
\gamma
1
\bar{Z}
t
\bar{Z}
Z(\theta^{t\text{-SNE}})
Z^{\text{NC-}t\text{-SNE}}
\frac{n(n-1)}{m}\cdot x
x\in\{5\cdot 10^{-5},1\cdot 10^{-4},2\cdot 10^{-4},5\cdot 10^{-4},\dots,1\cdot
1%
0^{2},2\cdot 10^{2},5\cdot 10^{2}\}
1000
5
0
0
0.9
1024
512-1024-128
L_{2}
0.5
k=15
0.0001
m
2
m=2b-2
\pm
t
360
39\pm 4
t
24
121\pm 44
t
3
3592\pm 44
t
3
786\pm 2
12
721\pm 16
3
\pm
\text{s}k\text{NN}
t
\text{s}k\text{NN}
t
0.006
t
t
t
t
t
t
Z^{\text{NC-}t\text{-SNE}}
[10^{6}]
Z(\theta^{t\text{-SNE}})
[10^{6}]
34.3\pm 0.1
8.13
34.3\pm 0.1
6.25
6.15\pm 0.06
3.12
3.57\pm 0.03
1.30
30.8\pm 0.1
7.98
36.9\pm 0.7
11.7
395\pm 3
89.6
56
6132
2.60
502
10
8
5220
2.20
100
54
646
1024
2^{19}
\text{s}k\text{NN}
40
20
2^{16}
t
1{,}500{,}006
\text{s}k\text{NN}
2^{19}
t
t
t
k
E=[i_{1}j_{1},\dots,i_{|E|}j_{|E|}]
\theta
T
\eta
m
q
b
mode
\bar{Z}
\binom{n}{2}/m
mode=\text{\mbox{Neg-$t$-SNE}}
t
e_{1},\dots,e_{n}
mode=\text{\mbox{NC-$t$-SNE}{}}
t
Z=1
t=0
T
\eta_{t}=\eta\cdot(1-\frac{t}{T})
\alpha=0
\alpha<|E|
\mathcal{L}=0
\beta=1,\dots,b
i_{\alpha+\beta}j_{\alpha+\beta}
i_{\alpha+\beta}j_{\mu}^{-}
j^{-}_{1},\dots,j^{-}_{m}\sim\text{Uniform}(\{i_{\alpha+1},j_{\alpha+1},\dots,%
j_{\alpha+b}\}\backslash\{i_{\alpha+\beta}\})
mode=\text{\mbox{Neg-$t$-SNE}}
t
\mathcal{L}=\mathcal{L}-\log\left(\frac{q_{\theta}(i_{\alpha+\beta}j_{\alpha+%
\beta})}{q_{\theta}(i_{\alpha+\beta}j_{\alpha+\beta})+\vphantom{\hat{Z}}\bar{Z%
}m/\binom{n}{2}}\right)-\sum_{\mu=1}^{m}\log\left(1-\frac{q_{\theta}(i_{\alpha%
+\beta}j_{\mu}^{-})}{q_{\theta}(i_{\alpha+\beta}j_{\mu}^{-})+\vphantom{\hat{Z}%
}\bar{Z}m/\binom{n}{2}}\right)
mode=\text{\mbox{NC-$t$-SNE}{}}
t
\mathcal{L}=\mathcal{L}-\log\left(\frac{q_{\theta}(i_{\alpha+\beta}j_{\alpha+%
\beta})/Z}{q_{\theta}(i_{\alpha+\beta}j_{\alpha+\beta})/Z+m}\right)-\sum_{\mu=%
1}^{m}\log\left(1-\frac{q_{\theta}(i_{\alpha+\beta}j_{\mu}^{-})/Z}{q_{\theta}(%
i_{\alpha+\beta}j_{\mu}^{-})/Z+m}\right)
mode=\text{InfoNC-}t\text{-SNE}
\mathcal{L}=\mathcal{L}-\log\left(\frac{q_{\theta}(i_{\alpha+\beta}j_{\alpha+%
\beta})}{q_{\theta}(i_{\alpha+\beta}j_{\alpha+\beta})+\sum_{\mu=1}^{m}q_{%
\theta}(i_{\alpha+\beta}j^{-}_{\mu})}\right)
mode=\text{UMAP}
\mathcal{L}=\mathcal{L}-\log\Big{(}q_{\theta}(i_{\alpha+\beta}j_{\alpha+\beta}%
)\Big{)}-\sum_{\mu=1}^{m}\log\Big{(}1-q_{\theta}(i_{\alpha+\beta}j_{\mu}^{-})%
\Big{)}
\theta=\theta-\eta_{t}\cdot\nabla_{\theta}\mathcal{L}
mode=\mbox{NC-$t$-SNE}{}
t
Z=Z-\eta_{t}\nabla_{Z}\mathcal{L}
\alpha=\alpha+b
E
\theta
t
\log(1+d_{ij}^{2})
\log(2+d_{ij}^{2})
t
\log\big{(}(1+d_{ij}^{2})/d_{ij}^{2}\big{)}
\log\big{(}(2+d_{ij}^{2})/(1+d_{ij}^{2})\big{)}
t
\log(1+d_{ij}^{2})
\log(2+d_{ij}^{2})
t
\log\big{(}(1+d_{ij}^{2})/d_{ij}^{2}\big{)}
\log\big{(}(2+d_{ij}^{2})/(1+d_{ij}^{2})\big{)}
m=5
m=5
m=50
m=50
m=500
m=500
m=2b-2=2046
m=2b-2=2046
t
m
b=1024
t
t
t
m
t
m
t
m
\bar{Z}
m
t
m
b=1024
t
t
t
m
t
m
t
m
\bar{Z}
m
t
t
t
t
t
t
t
t
\sum_{ij}\phi(ij)/Z
t
Z
t
t
t
\sum_{ij}\phi(ij)/Z
t
Z
t
t
t
m
t
m=5
250
Z
t
\sum_{ij}q_{\theta}(ij)
Z
t
Z
t
t
m
t
m=5
250
Z
t
\sum_{ij}q_{\theta}(ij)
Z
t
Z
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
1
0.0001
\bar{Z}
t
\bar{Z}
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
1
0.0001
\bar{Z}
t
\bar{Z}
t
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
10\cdot c\%
c
0
9
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
10\cdot c\%
c
0
9
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
\bar{Z}
t
\bar{Z}
t
t
\bar{Z}=|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
t
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
20\,272
10
t
\bar{Z}
\bar{Z}
\bar{Z}
t
\bar{Z}
t
t
\bar{Z}=|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
t
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
20\,272
10
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
\bar{Z}
t
\bar{Z}
t
t
\bar{Z}=|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
t
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
63\,530
8
24
t
\bar{Z}
\bar{Z}
\bar{Z}
t
\bar{Z}
t
t
\bar{Z}=|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
t
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
63\,530
8
24
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
86\,024
37
25
31\,375
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
86\,024
37
25
31\,375
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}<Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{t\text{-SNE}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=Z^{\text{NCVis}}
\bar{Z}=|X|/m
\bar{Z}=|X|/m
\bar{Z}>|X|/m
\bar{Z}>|X|/m
t
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
270\,912
49
456
7\,000
\bar{Z}=|X|/m
t
\bar{Z}=Z^{t\text{-SNE}}
t
t
t
\bar{Z}
\bar{Z}
t
t
\bar{Z}
t
Z
|X|/m=\binom{n}{2}/m
\sum_{ij}(1+d_{ij}^{2})^{-1}
\bar{Z}
t
t
\bar{Z}=|X|/m
\bar{Z}
270\,912
49
456
7\,000
\bar{Z}=|X|/m
t
\bar{Z}=Z^{t\text{-SNE}}
t
t
t
\bar{Z}=Z^{t\text{-SNE}}
t
t
\bar{Z}=|X|/m
250
\bar{Z}
t
\bar{Z}=Z^{t\text{-SNE}}
t
t
\bar{Z}=|X|/m
250
\bar{Z}
t
\bar{Z}=Z^{t\text{-SNE}}
q_{\theta}/(\sum_{ij}q_{\theta}(ij))
t
\bar{Z}=Z^{t\text{-SNE}}
q_{\theta}/(\sum_{ij}q_{\theta}(ij))
500
1000
5000
10000
10^{6}
18.96\pm 0.02
13.27\pm 0.01
6.93\pm 0.01
5.75\pm 0.01
t
1021\pm 2
832\pm 2
630\pm 1
599\pm 1
5.52\pm 0.01
5.18\pm 0.01
4.76\pm 0.01
4.65\pm 0.00
m=5
m=5
m=50
m=50
m=500
m=500
t
t
m=5
m=5
m=50
m=50
m=500
m=500
t
t
m=5
m=5
m=50
m=50
m=500
m=500
t
t
t
m
m
t
0.0001
t
t
250
m=5
m
t
t
t
t
m
k
m
k
k
t
m
m
t
0.0001
t
t
250
m=5
m
t
t
t
t
m
k
m
k
k
m=5
m=5
m=50
m=50
m=500
m=500
t
t
m=5
m=5
m=50
m=50
m=500
m=500
t
t
m=5
m=5
m=50
m=50
m=500
m=500
t
t
t
m
m
t
0.0001
t
t
250
m=5
m
t
t
t
t
m
k
m
k
k
t
m
m
t
0.0001
t
t
250
m=5
m
t
t
t
t
m
k
m
k
k
