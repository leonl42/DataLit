(\mathcal{S},\mathcal{A},\mathcal{P}_{T},\mathcal{R},\gamma,p_{0})
\mathcal{S}
\mathcal{A}
\mathcal{P}_{T}:\mathcal{S}\times\mathcal{A}\to\mathcal{S}
\mathcal{R}:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\to\mathbb{R}
\gamma\in(0,1)
p_{0}
t
a_{t}\in\mathcal{A}
s_{t}\in\mathcal{S}
s_{t+1}
r_{t}
\tau
\tau=\{(s_{t},a_{t},r_{t})\}_{t=1,...,T}
T
\pi:\mathcal{S}\to\mathcal{A}
R=\mathbb{E}[\sum_{t=1}^{\infty}\gamma^{t}r_{t}]
\pi
V^{\pi}(s_{t})=\mathbb{E}_{a_{t},s_{t+1},...|\pi}[\sum_{0}^{\infty}\gamma^{l}r%
_{t+1}]
Q^{\pi}(s_{t},a_{t})=\mathbb{E}_{s_{t+1},a_{t+1},...|\pi}[\sum_{t=0}^{\infty}%
\gamma^{l}r_{t+1}]
A^{\pi}(s_{t},a_{t})=Q^{\pi}(s_{t},a_{t})-V^{\pi}(s_{t})
a_{t},s_{t+1},...|\pi
s_{t+1},a_{t+1},...|\pi
\pi
\rho_{\pi}(s)
s
\rho_{\pi}(s)=\sum_{t=0}^{\infty}\gamma^{t}p(s_{t}=s)
p(s_{t}=s)
s
t
\widetilde{\pi}
\pi_{\theta}
\mathcal{J}=\mathbb{E}_{s\sim\widetilde{\pi}}[D(\pi_{\theta}(\cdot|s),%
\widetilde{\pi}(\cdot|s))]
s\sim\widetilde{\pi}
s
\rho_{\pi}(\cdot)
D(\cdot,\cdot)
\widetilde{\pi}_{\phi}
\phi
\pi_{\theta}
\widetilde{\pi}_{\phi}
\pi
\widetilde{\pi}
\pi
\widetilde{\pi}
\pi
\widetilde{\pi}
\pi^{hypo}(\cdot|s)=\left\{\begin{array}[]{rcl}\widetilde{\pi}(\cdot|s)&&\xi^{%
\widetilde{\pi}}(s)>0\\
\pi(\cdot|s)&&otherwise\\
\end{array}\right.
\xi^{\widetilde{\pi}}(s)=V^{\widetilde{\pi}}(s)-V^{\pi}(s)
\widetilde{\pi}
\pi
s
\pi^{hypo}
\pi
\widetilde{\pi}
\pi
\widetilde{\pi}
\pi^{hypo}
\forall s\in\mathcal{S}
V^{\pi^{hypo}}(s)\geq V^{\pi}(s)
V^{\pi^{hypo}}(s)\geq V^{\widetilde{\pi}}(s)
s\in\mathcal{S}
V^{\pi^{hypo}}(s)\geq V^{\pi}(s)
s
\pi^{adv}_{s}=\left\{\begin{array}[]{rcl}\widetilde{\pi}&&\xi^{\widetilde{\pi}%
}(s)>0\\
\pi&&otherwise.\\
\end{array}\right.
\pi^{adv}_{s}
\pi
\widetilde{\pi}
s
\pi^{adv}_{s}(\cdot|s^{\prime})
\pi
\widetilde{\pi}
s
s^{\prime}
s^{\prime}
V^{\pi^{adv}_{s}}(s)\geq V^{\pi}(s),
V^{\pi^{adv}_{s}}(s)\geq V^{\pi^{adv}_{s^{\prime}}}(s),
s^{\prime}
s\neq s^{\prime}
s_{i}\in S
s_{i+1}
V_{n}(s_{i})=\left\{\begin{array}[]{lcl}\mathbb{E}_{(s_{i+1},r_{i})\sim\pi^{%
hypo}(s_{i})}[r_{i}+\gamma V_{n-1}(s_{i+1})]&n\geq 1\\
V^{\pi^{adv}_{s_{i}}}(s_{i})&n=0,\\
\end{array}\right.
n
s_{i}
\pi^{hypo}
n
\pi^{adv}_{s_{i+n}}
n=0
V_{0}(s_{i})=V^{\pi^{adv}_{s_{i}}}(s_{i})
\forall s_{i}\in S
V_{1}(s_{i})\geq V_{0}(s_{i})
\begin{split}V_{1}(s_{i})&=\mathbb{E}_{(s_{i+1},r_{i})\sim\pi^{hypo}(s_{i})}[r%
_{i}+\gamma V_{0}(s_{i+1})]\\
&=\sum_{s_{i+1},r_{i}}p^{\pi^{hypo}}(s_{i+1},r_{i}|s_{i})[r_{i}+\gamma V_{0}(s%
_{i+1})]\\
&=\sum_{s_{i+1},r_{i}}p^{\pi^{hypo}}(s_{i+1},r_{i}|s_{i})[r_{i}+\gamma V^{\pi^%
{adv}_{s_{i+1}}}(s_{i+1})]\\
&\geq\sum_{s_{i+1},r_{i}}p^{\pi^{hypo}}(s_{i+1},r_{i}|s_{i})[r_{i}+\gamma V^{%
\pi^{adv}_{s_{i}}}(s_{i+1})]\\
&=\sum_{s_{i+1},r_{i}}p^{\pi^{adv}_{s_{i}}}(s_{i+1},r_{i}|s_{i})[r_{i}+\gamma V%
^{\pi^{adv}_{s_{i}}}(s_{i+1})]\\
&=V^{\pi^{adv}_{s_{i}}}(s_{i})\\
&=V_{0}(s_{i}).\end{split}
k\geq 1
\forall s_{i}\in S
V_{k}(s_{i})\geq V_{k-1}(s_{i})
\begin{split}V_{k+1}(s_{i})&=\mathbb{E}_{(s_{i+1},r_{i})\sim\pi^{hypo}(s_{i})}%
[r_{i}+\gamma V_{k}(s_{i+1})]\\
&=\sum_{s_{i+1},r_{i}}p^{\pi^{hypo}}(s_{i+1},r_{i}|s_{i})[r_{i}+\gamma V_{k}(s%
_{i+1})]\\
&\geq\sum_{s_{i+1},r_{i}}p^{\pi^{hypo}}(s_{i+1},r_{i}|s_{i})[r_{i}+\gamma V_{k%
-1}(s_{i+1})]\\
&=\mathbb{E}_{(s_{i+1},r_{i})\sim\pi^{hypo}(s_{i})}[r_{i}+\gamma V_{k-1}(s_{i+%
1})]\\
&=V_{k}(s_{i}).\end{split}\vspace{-50pt}
\forall n\geq 0
\forall s\in\mathcal{S}
V_{n}(s)\geq V^{\pi^{adv}_{s}}(s)\geq V^{\pi}(s)
\forall s\in\mathcal{S}
V^{\pi^{hypo}}(s)\geq V^{\pi}(s)
\forall s\in\mathcal{S}
V^{\pi^{hypo}}(s)\geq V^{\widetilde{\pi}}(s)
\pi^{hypo}
\pi
\widetilde{\pi}
V^{\pi}(s)>V^{\widetilde{\pi}}(s)
V^{\pi}(s^{\prime})<V^{\widetilde{\pi}}(s^{\prime})
\pi^{hypo}
\pi
\widetilde{\pi}
\pi
\widetilde{\pi}
\pi^{hypo}
\pi^{hypo}
\pi^{hypo}
\pi
\pi^{hypo}
\mathcal{J}=\mathbb{E}_{s\sim\widetilde{\pi}}[D(\pi(\cdot|s),\widetilde{\pi}(%
\cdot|s))\mathbbm{1}(\xi^{\widetilde{\pi}}(s)>0)],
\mathbbm{1}(\cdot)
D(\cdot,\cdot)
\pi
\widetilde{\pi}
\pi^{hypo}
\begin{split}&\mathbb{E}_{s\sim\pi^{hypo}}[D(\pi(\cdot|s),\pi^{hypo}(\cdot|s))%
]\\
=&\sum_{s\sim\rho_{\pi^{hypo}}(\cdot)}\!\!\!\!\!\!\!\!D(\pi(\cdot|s),\pi^{hypo%
}(\cdot|s))\\
=&\sum_{s\sim\rho_{\pi^{hypo}}(\cdot);\xi^{\widetilde{\pi}}(s)>0}\!\!\!\!\!\!%
\!\!\!\!\!\!\!\!\!\!\!D(\pi(\cdot|s),\widetilde{\pi}(\cdot|s))+\!\!\!\!\!\!\!%
\!\!\!\!\!\!\!\sum_{s\sim\rho_{\pi^{hypo}}(\cdot);\xi^{\widetilde{\pi}}(s)\leq
0%
}\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!D(\pi(\cdot|s),\pi(\cdot|s))\\
=&\sum_{s\sim\rho_{\widetilde{\pi}}(\cdot);\xi^{\widetilde{\pi}}(s)>0}\!\!\!\!%
\!\!\!\!\!\!\!\!D(\pi(\cdot|s),\widetilde{\pi}(\cdot|s))+\!\!\!\!\!\!\!\!\sum_%
{s\sim\rho_{\widetilde{\pi}}(\cdot);\xi^{\widetilde{\pi}}(s)\leq 0}\!\!\!\!\!%
\!\!\!\!\!\!\!D(\pi(\cdot|s),\pi(\cdot|s))\\
=&\mathbb{E}_{s\sim\widetilde{\pi}}[D(\pi(\cdot|s),\widetilde{\pi}(\cdot|s))%
\mathbbm{1}(\xi^{\widetilde{\pi}}(s)>0)]\\
\end{split}
\rho_{\pi}(\cdot)
\rho_{\widetilde{\pi}}(\cdot)
\pi_{\theta}
\widetilde{\pi}_{\phi}
M
1,M
\pi_{\theta}
B_{\pi}
\pi_{\theta}
\pi_{\theta}
\widetilde{\pi}_{\phi}
B_{\widetilde{\pi}}
\widetilde{\pi}_{\phi}
\widetilde{\pi}_{\phi}
\mathcal{J}^{w}_{\pi_{\theta}}(\theta)
\mathcal{J}^{w}_{\widetilde{\pi}_{\phi}}(\phi)
\pi_{\theta}
\widetilde{\pi}_{\phi}
\mathcal{J}^{w}_{\pi_{\theta}}(\theta)=\mathbb{E}_{s\sim\widetilde{\pi}_{\phi}%
}[D(\pi_{\theta}(\cdot|s),\widetilde{\pi}_{\phi}(\cdot|s))\exp(\alpha\xi^{%
\widetilde{\pi}_{\phi}}(s))],
\mathcal{J}^{w}_{\widetilde{\pi}_{\phi}}(\phi)=\mathbb{E}_{s\sim\pi_{\theta}}[%
D(\widetilde{\pi}_{\phi}(\cdot|s),\pi_{\theta}(\cdot|s))\exp(\alpha\xi^{\pi_{%
\theta}}(s))],
\exp(\alpha\xi^{\widetilde{\pi}_{\phi}}(s))
\exp(\alpha\xi^{\pi_{\theta}}(s))
\alpha
\pi_{\theta}
\widetilde{\pi}_{\phi}
\pi_{\theta}
\pi_{\theta}
\widetilde{\pi}_{\phi}
\xi^{\widetilde{\pi}_{\phi}}(s)
\widetilde{\pi}_{\phi}
\pi^{*}
V^{\pi^{*}}(s)
s
V_{i+1}(s)\leftarrow\max_{a}\sum_{s^{\prime}}\mathcal{P}_{T}(s^{\prime}|s,a)[%
\mathcal{R}(s,a,s^{\prime})+V_{i}(s^{\prime})],
V_{i}(\cdot)
V_{i+1}(\cdot)
\mathcal{S}_{\widetilde{\pi}}
S_{\widetilde{\pi}}=\{s|V^{\widetilde{\pi}}(s)>V^{\pi}(s)\}
V^{\pi^{*}}(s)\geq V^{\widetilde{\pi}}(s)>V^{\pi}(s),\forall s\in\mathcal{S}_{%
\widetilde{\pi}}.
S_{\widetilde{\pi}}
\pi
\pi
\widetilde{\pi}
S_{\widetilde{\pi}}
\pi
V^{\widetilde{\pi}}(\cdot)
\pm
2.5\times 10^{6}
5.0\times 10^{6}
5\times 10^{6}
10
\pm
2.5\times 10^{6}
5.0\times 10^{6}
5\times 10^{6}
10
10^{6}
\alpha
[0.1,10.0]
10^{-4}
64
10^{-5}
256
2.5\times 10^{6}
1\times 10^{7}
5\times 10^{6}
2\times 10^{7}
4
2.5\times 10^{6}
15
3
4
2.5\times 10^{6}
5\times 10^{6}
10
\alpha
\alpha
10
5\times 10^{6}
10
5\times 10^{5}
1.5\times 10^{6}
2.5\times 10^{6}
100
10
100
10
5\times 10^{6}
10
5\times 10^{5}
1.5\times 10^{6}
2.5\times 10^{6}
100
10
100
\pm{201.11}
\boldsymbol{\pm{190.51}}
\pm{224.12}
\boldsymbol{\pm{143.58}}
\pm{127.40}
\boldsymbol{\pm{230.72}}
\pm{0.57}
\boldsymbol{\pm{2.50}}
\pm{3048.85}
\boldsymbol{\pm{941.01}}
\pm{161.22}
\boldsymbol{\pm{286.84}}
\pm{278.31}
\boldsymbol{\pm{261.89}}
\pm{0.83}
\boldsymbol{\pm{8.01}}
1\times 10^{7}
2\times 10^{7}
5
1\times 10^{7}
2\times 10^{7}
5
5\times 10^{6}
0.43
0.31
