\S
\S
\dagger
\dagger
\S
\dagger
\ell^{2}
f_{1..N}
D_{1..N}
f_{1..N}
D_{1..N}
i\in\{1..N\}
f_{i}
\theta_{\textrm{LM}}
D_{i}=\langle X_{i},Y_{i}\rangle
\theta_{i}
X_{i}\in\mathbb{R}^{N_{i},*}
Y_{i}\in\mathbb{R}^{N_{i},*}
N_{i}
D_{i}
f_{i}(\cdot;\theta_{i})
S_{i}
D_{i}
f_{i}(\cdot;\theta_{i})
S_{i}
g
\mathcal{K}\subseteq{\{1..N\}}
K=|\mathcal{K}|
\theta_{M_{\mathcal{K}}}
f_{M_{\mathcal{K}}}
\theta_{M_{\mathcal{K}}}=g(\theta_{\mathcal{K}},S_{\mathcal{K}})
g
\theta_{M_{\mathcal{K}}}
g
f_{i}
f_{M_{\mathcal{K}}}
\ell^{2}
\ell^{2}
\theta_{M_{\mathcal{K}}}={1}/{K}\sum_{i}^{i\in\mathcal{K}}\theta_{i}
F_{i}
i
\theta_{M_{\mathcal{K}}}=\sum_{i}^{i\in\mathcal{K}}F_{i}\theta_{i}/\sum_{i}^{i%
\in\mathcal{K}}F_{i}
F_{i}
F_{i}=\mathbb{E}_{x\sim D_{i}}\mathbb{E}_{y\sim p_{\theta}(y|x)}\nabla_{\theta%
_{i}}(\log p_{\theta_{i}}(y|x_{i}))^{2}
F_{i}
f_{1}(x)=W_{1}^{T}x
f_{2}(x)=W_{2}^{T}x
x\in\mathbb{R}^{m}
W_{1},W_{2}\in\mathbb{R}^{m\times n}
\langle X_{1},y_{1}\rangle
\langle X_{2},y_{2}\rangle
X_{1}\in\mathbb{R}^{N_{1}\times m}
X_{2}\in\mathbb{R}^{N_{2}\times m}
X_{i}
f_{M}(x)=W_{M}^{T}x
f_{1}
X_{1}
f_{2}
X_{2}
\ell^{2}
\displaystyle\min_{W}\quad\lVert W^{T}X_{1}-W_{1}^{T}X_{1}\rVert^{2}+\lVert W^%
{T}X_{2}-W_{2}^{T}X_{2}\rVert^{2}.
\displaystyle\min_{W}\quad\lVert W^{T}X_{1}-W_{1}^{T}X_{1}\rVert^{2}+\lVert W^%
{T}X_{2}-W_{2}^{T}X_{2}\rVert^{2}.
[X_{1};X_{2}]
X_{1}
X_{2}
[W_{1}^{T}X_{1};W_{2}^{T}X_{2}]
W_{M}=(X_{1}^{T}X_{1}+X_{2}^{T}X_{2})^{-1}(X_{1}^{T}X_{1}W_{1}+X_{2}^{T}X_{2}W%
_{2})
K
W_{i},i\in\mathcal{K}
W_{M}=(\sum_{i}^{i\in\mathcal{K}}X_{i}^{T}X_{i})^{-1}\sum_{i}^{i\in\mathcal{K}%
}(X_{i}^{T}X_{i}W_{i}).
f_{i}
X_{i}^{T}X_{i}
X_{i}^{T}X_{i}
X_{i}^{T}X_{i}
X_{i}^{T}X_{i}
W_{i}
X_{i}^{T}X_{i}
X_{i}
W_{M}=1/K\sum_{i}^{i\in\mathcal{K}}W_{i}
X_{i}^{(j)T}X_{i}^{(j)}
f^{(j)}
X_{i}^{(j)}
\alpha
W_{M}
W_{1..K}
f_{1..K}
J
G_{i}^{(j)}=X_{i}^{(j)T}X_{i}^{(j)}
1\leq j\leq J
1\leq i\leq K
\alpha
f_{M}
j
\mathbf{in}
1,2,...,J
W_{1}^{(j)},W_{2}^{(j)}...,W_{K}^{(j)}\leftarrow\textrm{getLinearWeights}(f_{1%
..K},j)
G_{i}^{(j)}
\tilde{G}_{i}^{(j)}\leftarrow\alpha G_{i}^{(j)}+(1-\alpha)\textrm{diag}(G_{i}^%
{(j)})
W_{M}^{(j)}\leftarrow(\sum_{i}^{i\in\mathcal{K}}\tilde{G}_{i}^{(j)})^{-1}\sum_%
{i}^{i\in\mathcal{K}}(\tilde{G}_{i}^{(j)}W_{i}^{(j)})
W_{M}^{(j)}
f_{M}
W_{M}=\frac{1}{K}\sum_{i}^{i\in\mathcal{K}}W_{i}
f_{M}
\sum_{j=1}^{J}d_{j}^{2}
J
d_{j}
X_{i}
f_{1..N}
\mathcal{K}
f_{\mathcal{K}}
D_{1..N}
f_{M}
D_{1..N}
D_{1..N}
D_{1..N}
f_{M}
D^{o}_{1..N_{o}}
D_{1..N}
f_{1..N}
f_{1..N}
D_{1..N}
f_{i}
\theta_{\textrm{LM}}
\theta_{\textrm{LM}}
\alpha
0.9
0.1
1,000
f_{1..\textsc{N}}
f_{1..N}
f_{1..N}
\mathcal{C}_{5}^{2}
\mathcal{C}_{6}^{2}
\mathcal{C}_{5}^{2}
\mathcal{C}_{6}^{2}
\mathcal{C}^{2}_{5}
\mathcal{C}^{2}_{6}
\frac{1}{N(N-1)}\sum_{i=1}^{N}\sum_{j=1,j\neq i}^{N}[\mathcal{M}(f_{M_{i,j}},D%
_{i})-\mathcal{M}(f_{i},D_{i})]/\mathcal{M}(f_{i},D_{i})
\mathcal{M}(f,D)
f
D
\rightarrow
\downarrow
f_{1..\textsc{N}}
f_{1..\textsc{N}}
f_{1..\textsc{N}}
f_{1..\textsc{N}}
f_{1..\textsc{N}}
f_{1..\textsc{N}}
f_{1..\textsc{N}}
\rightarrow
\downarrow
f_{1..\textsc{N}}
f_{1..\textsc{N}}
\alpha
*
\alpha
*
f_{1..\textsc{N}}
f_{1..\textsc{N}}
\mathcal{K}\subseteq{\{1..\textsc{N}\}}
f_{1..\textsc{N}}
\alpha=1.0
\alpha
\alpha=0
0\leq\alpha\leq 1
\alpha=0.1
\alpha=1.0
\alpha=0.1
\alpha
f_{1..\mathrm{N}}
f_{1..\mathrm{N}}
K
\displaystyle\min_{W}\quad\sum_{i}^{i\in\mathcal{K}}\;\lVert W^{T}X_{i}-W_{i}^%
{T}X_{i}\rVert^{2}+\sum_{i}^{i\in\mathcal{K}}\mathrm{tr}[(W-W_{i})^{T}\Lambda_%
{i}(W-W_{i})]
\displaystyle\min_{W}\quad\sum_{i}^{i\in\mathcal{K}}\;\lVert W^{T}X_{i}-W_{i}^%
{T}X_{i}\rVert^{2}+\sum_{i}^{i\in\mathcal{K}}\mathrm{tr}[(W-W_{i})^{T}\Lambda_%
{i}(W-W_{i})]
i
W,W_{i}\in\mathbb{R}^{m\times n}
X_{i}\in\mathbb{R}^{N_{i}\times m}
\Lambda_{i}=\textrm{diag}(\lambda_{i1},\lambda_{i2},...,\lambda_{iK})\succeq 0
W
W_{i}
\lambda_{ij}
j
W_{i}
\lambda_{ij}
W_{M}=[\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}+\Lambda_{i})]^{-1}\sum_{i}^{i%
\in\mathcal{K}}[(X_{i}^{T}X_{i}+\Lambda_{i})W_{i}]
L
W
\displaystyle\frac{\partial L}{\partial W}=\sum_{i}^{i\in\mathcal{K}}(-2X_{i}^%
{T}X_{i}W_{i}+2X_{i}^{T}X_{i}W)+\sum_{i}^{i\in\mathcal{K}}(-2\Lambda W_{i}+2%
\Lambda W)
\displaystyle\frac{\partial L}{\partial W}
\displaystyle=\sum_{i}^{i\in\mathcal{K}}(-2X_{i}^{T}X_{i}W_{i}+2X_{i}^{T}X_{i}%
W)+\sum_{i}^{i\in\mathcal{K}}(-2\Lambda W_{i}+2\Lambda W)
L
W
L
\frac{\partial L}{\partial W}=0.
\displaystyle\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}W_{i}+\Lambda W_{i})=%
\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}+\Lambda)W^{*}
\displaystyle\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}W_{i}+\Lambda W_{i})=%
\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}+\Lambda)W^{*}
\displaystyle W^{*}=[\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}+\Lambda_{i})]^{%
-1}\sum_{i}^{i\in\mathcal{K}}[(X_{i}^{T}X_{i}+\Lambda_{i})W_{i}]
\displaystyle W^{*}=[\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}+\Lambda_{i})]^{%
-1}\sum_{i}^{i\in\mathcal{K}}[(X_{i}^{T}X_{i}+\Lambda_{i})W_{i}]
\Lambda_{i}
X_{i}^{T}X_{i}
\Lambda_{i}
X_{i}^{T}X_{i}
\Lambda_{i}=\gamma\;\textrm{diag}(X_{i}^{T}X_{i})
\gamma
W_{M}=[\sum_{i}^{i\in\mathcal{K}}(X_{i}^{T}X_{i}+\gamma\;\textrm{diag}(X_{i}^{%
T}X_{i}))]^{-1}\sum_{i}^{i\in\mathcal{K}}[(X_{i}^{T}X_{i}+\gamma\;\textrm{diag%
}(X_{i}^{T}X_{i}))W_{i}]
X_{i}^{T}X_{i}
\alpha=\frac{1}{1+\gamma}
W_{M}=[\sum_{i}^{i\in\mathcal{K}}(\frac{1}{1+\gamma}X_{i}^{T}X_{i}+\frac{%
\gamma}{1+\gamma}\;\textrm{diag}(X_{i}^{T}X_{i}))]^{-1}\sum_{i}^{i\in\mathcal{%
K}}[(\frac{1}{1+\gamma}X_{i}^{T}X_{i}+\frac{\gamma}{1+\gamma}\;\textrm{diag}(X%
_{i}^{T}X_{i}))W_{i}]
N
N
N
N=1,000
N
N
N=100
\beta=0.01
\beta=0.1
\beta=0.2
\beta=0.5
\alpha=0.1
\alpha
\beta
\ell^{2}
n
W_{A}\in\mathbb{R}^{m\times n}
W_{B}\in\mathbb{R}^{m\times n}
T
\ell^{2}
n
W_{A}\in\mathbb{R}^{m\times n}
W_{B}\in\mathbb{R}^{m\times n}
T
Z_{A}^{T}Z_{B}
Z_{A}=\textrm{gelu}(W_{A}^{T}X_{A})
Z_{B}=\textrm{gelu}(W_{B}^{T}X_{B})
Z_{A}^{T}Z_{B}
Z_{A}^{T}Z_{B}
Z_{A}=\textrm{gelu}(W_{A}^{T}X_{A})
Z_{B}=\textrm{gelu}(W_{B}^{T}X_{B})
Z_{A}^{T}Z_{B}
W_{A}
W_{B}
M\in\mathbb{R}^{n\times n}
n
M_{ij}\in M
\ell^{2}
W_{A}^{:,i}
W_{B}^{:,j}
M
M
M
M
C\in\mathbb{R}^{n\times n}
N
C
Z_{A}^{T}Z_{B}
Z_{A},Z_{B}\in\mathbb{R}^{N\times n}
f_{A}
f_{B}
C
C
C
C
