\triangleright
\triangleright
(\alpha,\beta)
({\mathcal{X}},{\mathcal{Y}})
\pi^{\star}(\alpha,\beta,c)\in\operatorname*{arg\,min}_{\pi\in{\mathcal{U}}(%
\alpha,\beta)}\int_{{\mathcal{X}}\times{\mathcal{Y}}}c(x,y){\rm d}\pi(x,y),
\pi^{\star}
{\mathcal{U}}(\alpha,\beta)
\alpha
\beta
c:{\mathcal{X}}\times{\mathcal{Y}}\rightarrow\mathbb{R}
\mathcal{X}
\mathcal{Y}
(\alpha,\beta)
(\alpha,\beta)
\pi
{\mathcal{U}}(\alpha,\beta)
\alpha\vcentcolon=\sum_{i=1}^{m}a_{i}\delta_{x_{i}}
\beta\vcentcolon=\sum_{i=1}^{n}b_{i}\delta_{y_{i}}
\delta_{z}
z
a\in\Delta_{m-1}
b\in\Delta_{n-1}
\Delta_{k-1}\vcentcolon=\{x\in\mathbb{R}^{k}:x\geq 0\;{\rm and}\;\sum_{i}x_{i}%
=1\}.\footnotesize
P^{\star}(\alpha,\beta,c)\in\operatorname*{arg\,min}_{P\in U(a,b)}\langle C,P\rangle\qquad
U(a,b)\vcentcolon=\small\{P\in\mathbb{R}_{+}^{n\times m}:P1_{m}=a,\quad P^{%
\top}1_{n}=b\}
P
P^{\star}(\alpha,\beta)
C\in\mathbb{R}^{m\times n}
C_{i,j}\vcentcolon=c(x_{i},y_{j})
\langle C,P\rangle\vcentcolon=\sum_{i,j}C_{i,j}P_{i,j}
P^{\star}(\alpha,\beta,c,\epsilon)\in\operatorname*{arg\,min}_{P\in U(a,b)}%
\langle C,P\rangle-\epsilon H(P)
H(P)\vcentcolon=-\sum_{i,j}P_{i,j}(\log(P_{i,j})-1)
P
K\in\mathbb{R}^{m\times n}
K_{i,j}\vcentcolon=\exp\{-C_{i,j}/\epsilon\}
f^{\star},g^{\star}\in\operatorname*{arg\,max}_{f\in\mathbb{R}^{n},g\in\mathbb%
{R}^{m}}\langle f,a\rangle+\langle g,b\rangle-\epsilon e^{f/\epsilon}Ke^{g/\epsilon}
f\in\mathbb{R}^{n}
g\in\mathbb{R}^{m}
P1_{m}=a
P^{\top}1_{n}=b
f^{\star}
f^{\star}(\alpha,\beta,c,\epsilon)
f^{\star}
g^{\star}
P^{\star}
P_{i,j}^{\star}(\alpha,\beta,c,\epsilon)\vcentcolon=\exp\{f_{i}^{\star}/%
\epsilon\}K_{i,j}\exp\{g_{j}^{\star}/\epsilon\}.\qquad
(f,g)
{\rm err}(f,g;\alpha,\beta,c)\vcentcolon=\|P1_{m}-a\|_{1}+\|P^{\top}1_{n}-b\|_%
{1},\qquad
P
g(f;b,c)\vcentcolon=\epsilon\log b-\epsilon\log\left(K^{\top}\exp\{f/\epsilon%
\}\right).
\alpha,\beta,c,\epsilon,f_{0}=0
\alpha,\beta,c,\epsilon,f_{0}=0
i
N
g_{i}\leftarrow\epsilon\log b-\epsilon\log\left(K^{\top}\exp\{f_{i-1}/\epsilon%
\}\right)
f_{i}\leftarrow\epsilon\log a-\epsilon\log\left(K\exp\{g_{i}/\epsilon\}\right)
P_{N}
f_{N},g_{N}
P_{N}\approx P^{\star}
\alpha,\beta,\varphi_{0}
\alpha,\beta,\varphi_{0}
i
N
(\alpha,\beta)
{\mathcal{L}}(\varphi_{i-1})
\varphi_{i}
\nabla_{\varphi}{\mathcal{L}}(\varphi_{i-1})
T_{N}(\cdot)\vcentcolon=\nabla_{x}\psi_{\varphi_{N}}(\cdot)\approx T^{\star}(\cdot)
\alpha
\beta
c
\pi^{\star}
\theta
{\mathcal{D}}
\alpha
\beta
c
f^{\star}
g^{\star}
P^{\star}
\theta
{\mathcal{D}}
\alpha
\beta
\psi^{\star}
T^{\star}
\theta
{\mathcal{D}}
\theta
\pi^{\star}
{\mathcal{D}}
f^{\star}
\psi^{\star}
\theta
\pi^{\star}
{\mathcal{D}}
f^{\star}
\psi^{\star}
\alpha
\beta
{\mathcal{X}}={\mathcal{Y}}=\mathbb{R}^{d}
\alpha
c(x,y)\vcentcolon=\|x-y\|_{2}^{2}
\displaystyle W_{2}^{2}(\alpha,\beta)\vcentcolon=\min_{\pi\in{\mathcal{U}}(%
\alpha,\beta)}\int_{{\mathcal{X}}\times{\mathcal{Y}}}\|x-y\|_{2}^{2}{\rm d}\pi%
(x,y)
\displaystyle W_{2}^{2}(\alpha,\beta)\vcentcolon=
\displaystyle\min_{\pi\in{\mathcal{U}}(\alpha,\beta)}\int_{{\mathcal{X}}\times%
{\mathcal{Y}}}\|x-y\|_{2}^{2}{\rm d}\pi(x,y)
\displaystyle=\min_{T}\int_{\mathcal{X}}\|x-T(x)\|_{2}^{2}{\rm d}\alpha(x),
\displaystyle=
\displaystyle\min_{T}\int_{\mathcal{X}}\|x-T(x)\|_{2}^{2}{\rm d}\alpha(x),
T
\alpha
\beta
T_{\#}\alpha=\beta
T_{\#}\alpha(B)\vcentcolon=\alpha(T^{-1}(B))
B
\psi^{\star}(\ \cdot\ ;\alpha,\beta)\in\operatorname*{arg\,min}_{\psi\in{\rm
convex%
}}\int_{\mathcal{X}}\psi(x){\rm d}\alpha(x)+\int_{\mathcal{Y}}\overline{\psi}(%
y){\rm d}\beta(y),
\psi
\overline{\psi}(y)\vcentcolon=\max_{x\in{\mathcal{X}}}\langle x,y\rangle-\psi(x)
\psi
\psi^{\star}
T^{\star}
T^{\star}(x)=\nabla_{x}\psi^{\star}(x).
\psi_{\varphi}
\overline{\psi_{\varphi}}
\varphi
\overline{\psi_{\varphi}}
\displaystyle{\mathcal{L}}(\varphi)\vcentcolon=\underbrace{\mathop{\mathbb{E}}%
_{x\sim\alpha}\left[\psi_{\varphi}(x)\right]+\mathop{\mathbb{E}}_{y\sim\beta}%
\left[\langle\nabla\overline{\psi_{\text{\sout{$\varphi$}}}}(y),y\rangle-\psi_%
{\varphi}(\nabla\overline{\psi_{\text{\sout{$\varphi$}}}}(y))\right]}_{\text{%
Cyclic monotone correlations (dual objective)}}
\displaystyle{\mathcal{L}}(\varphi)
\displaystyle\vcentcolon=\underbrace{\mathop{\mathbb{E}}_{x\sim\alpha}\left[%
\psi_{\varphi}(x)\right]+\mathop{\mathbb{E}}_{y\sim\beta}\left[\langle\nabla%
\overline{\psi_{\text{\sout{$\varphi$}}}}(y),y\rangle-\psi_{\varphi}(\nabla%
\overline{\psi_{\text{\sout{$\varphi$}}}}(y))\right]}_{\text{Cyclic monotone %
correlations (dual objective)}}
\displaystyle\hskip 11.38109pt+\gamma\underbrace{\mathop{\mathbb{E}}_{y\sim%
\beta}\|\nabla\psi_{\varphi}\circ\nabla\overline{\psi_{\varphi}}(y)-y\|_{2}^{2%
},}_{\text{Cycle-consistency regularizer}}
\displaystyle\hskip 11.38109pt+\gamma\underbrace{\mathop{\mathbb{E}}_{y\sim%
\beta}\|\nabla\psi_{\varphi}\circ\nabla\overline{\psi_{\varphi}}(y)-y\|_{2}^{2%
},}_{\text{Cycle-consistency regularizer}}
\varphi
\gamma
\overline{\psi}
{\mathcal{L}}
z^{\star}(\phi)\in\operatorname*{arg\,min}_{z}J(z;\phi),
J
z\in{\mathcal{Z}}
\phi\in\Phi
{\mathcal{P}}(\phi)
\hat{z}_{\theta}
\theta
\hat{z}_{\theta}(\phi)\approx z^{\star}(\phi)
J
\min_{\theta}\mathop{\mathbb{E}}_{\phi\sim{\mathcal{P}}(\phi)}J(\hat{z}_{%
\theta}(\phi);\phi),
z^{\star}
{\mathcal{D}}(\alpha,\beta,c)
\alpha,\beta
(a,b)\sim{\mathcal{D}}
{\mathcal{D}}
\Delta_{m-1}\times\Delta_{n-1}
P_{\theta}(\alpha,\beta,c)\approx P^{\star}(\alpha,\beta,c)
(\alpha,\beta,c)\sim{\mathcal{D}}
\alpha\vcentcolon=\sum_{i=1}^{m}a_{i}\delta_{x_{i}}
\beta\vcentcolon=\sum_{i=1}^{n}b_{i}\delta_{x_{i}}
a\in\Delta_{m-1}
b\in\Delta_{n-1}
c
(\alpha,\beta,c)\sim{\mathcal{D}}(\alpha,\beta,c)
(a,b)\sim{\mathcal{D}}
{\mathcal{D}}
\Delta_{m-1}\times\Delta_{n-1}
g(f;\alpha,\beta,c)\vcentcolon=\epsilon\log b-\epsilon\log\left(K^{\top}\exp\{%
f/\epsilon\}\right)
K\in\mathbb{R}^{m\times n}
f
f
f^{\star}(\alpha,\beta,c,\epsilon)\in\ \operatorname*{arg\,min}_{f\in\mathbb{R%
}^{n}}\ J(f;\alpha,\beta,c),
-J(f;\alpha,\beta,c)\vcentcolon=\langle f,a\rangle+\langle g,b\rangle-\epsilon%
\left\langle\exp\{f/\epsilon\},K\exp\{g/\epsilon\}\right\rangle
f
g
f
f
g
\hat{f}_{\theta}(\alpha,\beta,c)
\theta
\hat{f}_{\theta}\approx f^{\star}
\hat{f}_{\theta}(\alpha,\beta,c)
\hat{f}_{\theta}
\hat{f}_{\theta}
\min_{\theta}\mathop{\mathbb{E}}_{(\alpha,\beta,c)\sim{\mathcal{D}}}J(\hat{f}_%
{\theta}(\alpha,\beta,c);\alpha,\beta,c),
f^{\star}
\hat{f}_{\theta}
\hat{g}
\theta_{0}
i
(\alpha,\beta,c)\sim{\mathcal{D}}
\hat{f}_{\theta}
\hat{\varphi}_{\theta}
\theta_{i+1}
\alpha_{0}
\alpha_{1}
\alpha_{2}
\alpha_{0}
\alpha_{1}
\alpha_{2}
\bf{\approx}100
\bf{\approx}100
10^{-2}
\approx 5\cdot 10^{-5}
10^{-2}
\approx 5\cdot 10^{-5}
t_{\rm zeros}
4.5\cdot 10^{-3}
\pm 1.5\cdot 10^{-3}
0.88
\pm 0.13
4.1\cdot 10^{-3}
\pm 1.2\cdot 10^{-3}
0.56
\pm 9.9\cdot 10^{-2}
t_{\rm Meta}
2.3\cdot 10^{-3}
\pm 9.2\cdot 10^{-6}
7.8\cdot 10^{-2}
\pm 3.4\cdot 10^{-2}
t_{\rm zeros}/t_{\rm Meta}
\alpha,\beta
{\mathcal{X}}={\mathcal{Y}}=\mathbb{R}^{d}
(\alpha,\beta)\sim{\mathcal{D}}(\alpha,\beta)
c
{\mathcal{D}}
\psi^{\star}(\ \cdot\ ;\alpha,\beta)
\varphi
\psi_{\varphi}
\hat{\varphi}_{\theta}
\varphi^{\star}
\psi_{\varphi}
\overline{\psi_{\varphi}}
{\mathcal{L}}(\varphi;\alpha,\beta)
\hat{\varphi}_{\theta}(\alpha,\beta)
\theta
\hat{\varphi}_{\theta}\approx\varphi^{\star}
\alpha,\beta
\min_{\theta}\mathop{\mathbb{E}}_{(\alpha,\beta)\sim{\mathcal{D}}}{\mathcal{L}%
}(\hat{\varphi}_{\theta}(\alpha,\beta);\alpha,\beta).
\varphi^{\star}
\bf{\approx}37500
T
\bf{\approx}37500
T
{\mathcal{D}}
\alpha_{0}
\alpha_{1}
P^{\star}
\alpha_{0}
\alpha_{1}
\alpha_{t}=(t\operatorname*{proj}_{y}+(1-t)\operatorname*{proj}_{x})_{\#}P^{\star}
t\in[0,1]
\operatorname*{proj}_{x}(x,y)\vcentcolon=x
\operatorname*{proj}_{y}(x,y)\vcentcolon=y
\epsilon=10^{-2}
\hat{f}_{\theta}
10^{-2}
{\mathcal{S}}_{2}\vcentcolon=\{x\in\mathbb{R}^{3}:\|x\|=1\}
{\mathcal{X}}={\mathcal{Y}}={\mathcal{S}}_{2}
c(x,y)=\arccos(\langle x,y\rangle)
94.75
\pm 0.05
94.16
\pm 0.02
94.70
\pm 0.05
93.00
\pm 0.15
93.41
\pm 0.08
93.53
\pm 0.01
88.67
\pm 0.10
88.08
\pm 0.10
89.08
\pm 0.61
91.96
\pm 0.13
91.76
\pm 0.25
91.98
\pm 0.16
88.80
\pm 0.11
90.59
\pm 0.05
90.13
\pm 0.21
81.09
\pm 0.06
87.07
\pm 0.08
83.57
\pm 1.13
70.93
\pm 0.23
69.79
\pm 0.34
70.25
\pm 0.04
66.23
\pm 0.29
66.18
\pm 0.18
66.59
\pm 0.38
52.69
\pm 0.12
61.63
\pm 0.33
61.13
\pm 0.17
p_{\theta}
\mathbb{R}^{c}
\displaystyle R_{\text{WAR}}(x_{i})=W_{C}^{\epsilon}(p_{\theta}(x_{i}+r_{i}^{a%
}),p_{\theta}(x_{i}))
\displaystyle R_{\text{WAR}}(x_{i})=W_{C}^{\epsilon}(p_{\theta}(x_{i}+r_{i}^{a%
}),p_{\theta}(x_{i}))
\displaystyle r_{i}^{a}=\operatorname*{arg\,max}_{r_{i},||r_{i}||\leq%
\varepsilon}W_{C}^{\epsilon}(p_{\theta}(x_{i}+r_{i}),p_{\theta}(x_{i})).
\displaystyle r_{i}^{a}=\operatorname*{arg\,max}_{r_{i},||r_{i}||\leq%
\varepsilon}W_{C}^{\epsilon}(p_{\theta}(x_{i}+r_{i}),p_{\theta}(x_{i})).
W_{C}^{\epsilon}
C\in R^{c\times c}
p_{\theta}
R_{\text{WAR}}(x_{i})
W_{C}^{\epsilon}
11.51
\pm 0.07
12.88
\pm 0.02
13.13
\pm 0.02
14.37
\pm 0.04
14.07
\pm 0.15
14.17
\pm 0.02
17.04
\pm 0.12
14.36
\pm 0.02
14.37
\pm 0.02
\alpha
\beta
T_{\#}\alpha
T_{\#}^{-1}\beta
\alpha
\beta
T
\bf{\approx}1000
\alpha
\beta
\alpha
\beta
T
\bf{\approx}1000
\alpha
\beta
3.5\cdot 10^{-3}
\pm 2.7\cdot 10^{-4}
0.90
\pm 6.08\cdot 10^{-2}
0.93
\pm 2.27\cdot 10^{-2}
1.0
\pm 2.57\cdot 10^{-3}
1.84
\pm 3.78\cdot 10^{-2}
1.0
\pm 5.30\cdot 10^{-3}
0.90
\pm 1.62\cdot 10^{-2}
0.96
\pm 2.62\cdot 10^{-2}
1.81
\pm 3.05\cdot 10^{-2}
0.99
\pm 1.14\cdot 10^{-2}
{\mathcal{X}}={\mathcal{Y}}=[0,1]^{3}
c
{\approx}200
{\mathcal{D}}
\epsilon
\epsilon
\epsilon=10^{-2}
\epsilon=10^{-2}
\alpha,\beta
{\mathcal{L}}
\gamma
\ell_{2}
\times
10^{23}
10^{-2}
10^{-3}
10^{-4}
10^{-5}
4.5\cdot 10^{-3}
1.5\cdot 10^{-3}
7.7\cdot 10^{-3}
1.2\cdot 10^{-3}
1.1\cdot 10^{-2}
1.8\cdot 10^{-3}
1.5\cdot 10^{-2}
2.3\cdot 10^{-3}
4.1\cdot 10^{-3}
1.2\cdot 10^{-3}
7.7\cdot 10^{-3}
1.4\cdot 10^{-3}
1.1\cdot 10^{-2}
1.7\cdot 10^{-3}
1.4\cdot 10^{-2}
2.4\cdot 10^{-3}
2.3\cdot 10^{-3}
9.2\cdot 10^{-6}
3.9\cdot 10^{-3}
1.6\cdot 10^{-3}
6.7\cdot 10^{-3}
1.4\cdot 10^{-3}
1.0\cdot 10^{-2}
2.4\cdot 10^{-3}
10^{-2}
10^{-3}
10^{-4}
10^{-5}
8.8\cdot 10^{-1}
\pm 1.3\cdot 10^{-1}
1.4
\pm 1.9\cdot 10^{-1}
2.1
\pm 3.6\cdot 10^{-1}
2.8
\pm 5.6\cdot 10^{-1}
5.6\cdot 10^{-1}
\pm 9.9\cdot 10^{-2}
1.1
\pm 2.0\cdot 10^{-1}
1.7
\pm 3.5\cdot 10^{-1}
2.4
\pm 5.4\cdot 10^{-1}
7.8\cdot 10^{-2}
\pm 3.4\cdot 10^{-2}
0.44
\pm 1.5\cdot 10^{-1}
0.97
\pm 3.2\cdot 10^{-1}
1.7
\pm 6.8\cdot 10^{-1}
(14.southwest)+(1.2mm,4mm)
(13.southwest)+(1.2mm,4mm)
(12.southwest)+(1.2mm,4mm)
(11.southwest)+(7mm,.5mm)
(24.southwest)+(1.2mm,4mm)
(23.southwest)+(1.2mm,4mm)
(22.southwest)+(1.2mm,4mm)
(21.southwest)+(7mm,.5mm)
(34.southwest)+(1.2mm,4mm)
(33.southwest)+(1.2mm,4mm)
(32.southwest)+(1.2mm,4mm)
(31.southwest)+(7mm,.5mm)
(44.southwest)+(1.2mm,4mm)
(43.southwest)+(1.2mm,4mm)
(42.southwest)+(1.2mm,4mm)
(11.southwest)+(7.5mm,5.3mm)
(22.southwest)+(7.5mm,5.3mm)
(33.southwest)+(7.5mm,5.3mm)
(44.southwest)+(7.5mm,5.8mm)
\alpha
\beta
z_{1}
z_{2}
z
(zmid)+(-5mm,-15mm)
(zmid)+(0mm,+15mm)
\hat{\varphi}_{\theta}
\psi_{\hat{\varphi}_{\theta}}
\hat{T}(\cdot)=\nabla_{x}\psi_{\hat{\varphi}_{\theta}}(\cdot)
\alpha
\beta
z
\varphi
\psi_{\varphi}
\hat{T}
\alpha
\beta
z
\varphi
\psi_{\varphi}
\hat{T}
\psi_{\varphi}(x)
\varphi_{0}
{\mathcal{L}}
{\mathcal{L}}(\varphi_{K})
K
\operatorname*{arg\,min}_{\varphi_{0}}{\mathcal{L}}(\varphi_{K})\quad\text{%
where}\quad\varphi_{t+1}=\varphi_{t}-\nabla_{\varphi}{\mathcal{L}}(\varphi_{t})
T=\nabla\psi
\alpha,\beta
{\mathcal{L}}
\psi_{\varphi}(x;z)
z\vcentcolon=f^{\rm emb}_{\varphi}(\alpha,\beta)
\psi
\operatorname*{arg\,min}_{\varphi}\mathop{\mathbb{E}}_{(\alpha,\beta)\sim{%
\mathcal{D}}}{\mathcal{L}}(\varphi,f^{\rm emb}_{\varphi}(\alpha,\beta)),
{\mathcal{L}}
z
x
x
z
z
\alpha,\beta
\varphi
\alpha
\beta
T_{\#}\alpha
T_{\#}^{-1}\beta
\alpha
\beta
T_{\#}\alpha
T_{\#}^{-1}\beta
\alpha
\beta
T_{\#}\alpha
T_{\#}^{-1}\beta
