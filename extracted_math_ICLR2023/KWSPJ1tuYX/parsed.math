\lambda
R+\lambda D
R
D
\lambda
\lambda
\bm{x}_{1:T}
\bm{x}_{i}\in R^{H\times W}
i^{th}
H\times W
T
\bm{x}_{i}
\bm{w}_{i}=f^{w}_{\phi}(\bm{x}_{i},\bm{x}^{\prime}_{i})
\bm{x}_{i}
\bm{x}^{\prime}_{i-1}
f^{w}_{\phi}(\cdot)
\phi
\phi
\theta
\bm{\tilde{w}}_{i}=\lfloor\bm{w}_{i}\rceil
P_{\theta}(\bm{\tilde{w}}_{i}|\bm{\tilde{w}}_{<i},\bm{\tilde{y}}_{<i})
\theta
\lfloor\cdot\rceil
\bm{y}_{i}=f_{\phi}^{y}(\bm{x},\bm{x}^{\prime},\bm{\tilde{w}})
f_{\phi}^{y}(\cdot)
\bm{w}_{i}
\bm{\tilde{y}}_{i}=\lfloor\bm{y}_{i}\rceil
P_{\theta}(\bm{\tilde{y}}_{i}|\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{<i})
\bm{x}^{\prime}_{i}=g^{x}_{\theta}(\bm{x}^{\prime}_{i-1},\bm{\tilde{w}}_{i},%
\bm{\tilde{y}}_{i})
g^{x}_{\theta}(\cdot)
\theta
\bm{\tilde{w}}_{i}
\bm{\tilde{y}}_{i}
f_{\phi}(\cdot)
g_{\theta}(\cdot)
R_{i}+\lambda_{i}D_{i}
R_{i}
D_{i}
\lambda_{i}
R_{i}
D_{i}
d(\cdot,\cdot)
\lambda_{i}D_{i}
-\log p_{\theta}(\bm{x}_{i}|\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{\leq i})
\lambda_{i}D_{i}
d(\cdot,\cdot)
\lambda_{i}D_{i}=-\log p_{\theta}(\bm{x}_{i}|\bm{\tilde{w}}_{\leq i},\bm{%
\tilde{y}}_{\leq i})+const
p_{\theta}(\bm{x}_{i}|\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{\leq i})
\mathcal{N}(\bm{\hat{x}}_{i},1/2\lambda_{i}I)
\displaystyle\bm{w}_{i}=f_{\phi}(\bm{x}_{i},\bm{\tilde{w}}_{<i},\bm{\tilde{y}}%
_{<i}),\bm{y}_{i}=f_{\phi}(\bm{x}_{i},\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{%
<i})\textrm{, where }\bm{\tilde{w}}_{i}=\lfloor\bm{w}_{i}\rceil\textrm{, }\bm{%
\tilde{y}}_{i}=\lfloor\bm{y}_{i}\rceil
\displaystyle\bm{w}_{i}=f_{\phi}(\bm{x}_{i},\bm{\tilde{w}}_{<i},\bm{\tilde{y}}%
_{<i}),\bm{y}_{i}=f_{\phi}(\bm{x}_{i},\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{%
<i})
\displaystyle\textrm{, where }\bm{\tilde{w}}_{i}=\lfloor\bm{w}_{i}\rceil%
\textrm{, }\bm{\tilde{y}}_{i}=\lfloor\bm{y}_{i}\rceil
\displaystyle R_{i}=\log P_{\theta}(\bm{\tilde{w}}_{i},\bm{\tilde{y}}_{i}|\bm{%
\tilde{w}}_{<i},\bm{\tilde{y}}_{<i})\textrm{, }D_{i}=d(\bm{x}_{i},g_{\theta}(%
\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{\leq i}))
\displaystyle R_{i}=\log P_{\theta}(\bm{\tilde{w}}_{i},\bm{\tilde{y}}_{i}|\bm{%
\tilde{w}}_{<i},\bm{\tilde{y}}_{<i})\textrm{, }D_{i}=d
\displaystyle(\bm{x}_{i},g_{\theta}(\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{%
\leq i}))
\displaystyle\max-(R_{i}+\lambda_{i}D_{i})
\displaystyle\max-(R_{i}+\lambda_{i}D_{i}
\displaystyle)
\lfloor\cdot\rceil
\bm{\tilde{w}}_{i}=\lfloor\bm{w}_{i}\rceil
\bm{\tilde{y}}_{i}=\lfloor\bm{y}_{i}\rceil
\bm{\tilde{w}}_{i}=\bm{w}_{i}+\mathcal{U}(-0.5,0.5)
\bm{\tilde{y}}_{i}=\bm{y}_{i}+\mathcal{U}(-0.5,0.5)
\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{\leq i}\rightarrow\bm{x}_{i}
\bm{w}_{i},\bm{y}_{i}
\displaystyle q_{\phi}(\bm{\tilde{w}}_{i}|\bm{x}_{i},\bm{\tilde{w}}_{<i},\bm{%
\tilde{y}}_{<i})=\mathcal{U}(\bm{w}_{i}-0.5,\bm{w}_{i}+0.5),q_{\phi}(\bm{%
\tilde{y}}_{i}|\bm{x}_{i},\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{<i})=%
\mathcal{U}(\bm{y}_{i}-0.5,\bm{y}_{i}+0.5)
\displaystyle q_{\phi}(\bm{\tilde{w}}_{i}|\bm{x}_{i},\bm{\tilde{w}}_{<i},\bm{%
\tilde{y}}_{<i})=\mathcal{U}(\bm{w}_{i}-0.5,\bm{w}_{i}+0.5),q_{\phi}(\bm{%
\tilde{y}}_{i}
\displaystyle|\bm{x}_{i},\bm{\tilde{w}}_{\leq i},\bm{\tilde{y}}_{<i})=\mathcal%
{U}(\bm{y}_{i}-0.5,\bm{y}_{i}+0.5)
\displaystyle-(R_{i}+\lambda_{i}D_{i})=\mathbb{E}_{q_{\phi}}[\underbrace{\log P%
_{\theta}(\bm{\tilde{w}}_{i},\bm{\tilde{y}}_{i}|\bm{\tilde{w}}_{<i},\bm{\tilde%
{y}}_{<i})}_{-R_{i}}+\underbrace{\log p_{\theta}(\bm{x}_{i}|\bm{\tilde{w}}_{%
\leq i},\bm{\tilde{y}}_{\leq i})}_{-\lambda_{i}D_{i}}\underbrace{\cancel{-\log
q%
_{\phi}}}_{\textrm{bits-back bitrate: 0}}]
\displaystyle-(R_{i}+\lambda_{i}D_{i})=\mathbb{E}_{q_{\phi}}[\underbrace{\log P%
_{\theta}(\bm{\tilde{w}}_{i},\bm{\tilde{y}}_{i}|\bm{\tilde{w}}_{<i},\bm{\tilde%
{y}}_{<i})}_{-R_{i}}
\displaystyle+\underbrace{\log p_{\theta}(\bm{x}_{i}|\bm{\tilde{w}}_{\leq i},%
\bm{\tilde{y}}_{\leq i})}_{-\lambda_{i}D_{i}}\underbrace{\cancel{-\log q_{\phi%
}}}_{\textrm{bits-back bitrate: 0}}]
\lambda_{i}
T
\mathcal{L}
\lambda_{0}
\mathcal{L}_{i}
i
\partial R_{i+1}/\partial R_{i}
\partial D_{i+1}/\partial D_{i}
\lambda_{1:T}^{*}
\displaystyle\max\mathcal{L}=\sum_{i=1}^{T}\mathcal{L}_{i}\textrm{, where }%
\mathcal{L}_{i}=-(R_{i}+\lambda_{0}D_{i})
\displaystyle\max\mathcal{L}=\sum_{i=1}^{T}\mathcal{L}_{i}\textrm{, where }%
\mathcal{L}_{i}=-(R_{i}+\lambda_{0}D_{i})
\displaystyle\lambda^{*}_{1:T}\leftarrow\arg\max_{\lambda_{1:T}}\mathcal{L}(%
\lambda_{1:T})\textrm{, versus }\bm{w}^{*}_{1:T},\bm{y}^{*}_{1:T}\leftarrow%
\arg\max_{\bm{w}_{1:T},\bm{y}_{1:T}}\mathcal{L}(\bm{w}_{1:T},\bm{y}_{1:T})
\displaystyle\lambda^{*}_{1:T}\leftarrow\arg\max_{\lambda_{1:T}}
\displaystyle\mathcal{L}(\lambda_{1:T})\textrm{, versus }\bm{w}^{*}_{1:T},\bm{%
y}^{*}_{1:T}\leftarrow\arg\max_{\bm{w}_{1:T},\bm{y}_{1:T}}\mathcal{L}(\bm{w}_{%
1:T},\bm{y}_{1:T})
\lambda_{1:T}^{*}
\bm{w}_{1:T}^{0},\bm{y}_{1:T}^{0}
\bm{w}_{1:T},\bm{y}_{1:T}
\mathcal{L}
\partial R_{i+1}/\partial R_{i},\partial D_{i+1}/\partial D_{i}
K
\bm{w}_{i}^{k},\bm{y}_{i}^{k}
\bm{w}_{i},\bm{y}_{i}
k
\bm{w}_{i},\bm{y}_{i}
\bm{y}_{i}
\bm{y}_{i}
\bm{w}_{i},\bm{y}_{i}
\displaystyle\bm{w}^{k+1}_{i}\leftarrow\bm{w}^{k}_{i}+\alpha\frac{d\mathcal{L}%
(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{w}^{k}_{i}}\textrm{, where }\frac{d%
\mathcal{L}(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{w}^{k}_{i}}=\sum_{j=i}^{T%
}\frac{\partial\mathcal{L}_{j}(\bm{w}^{k}_{1:j},\bm{y}^{k}_{1:j})}{\partial\bm%
{w}^{k}_{i}}
\displaystyle\bm{w}^{k+1}_{i}\leftarrow\bm{w}^{k}_{i}+\alpha\frac{d\mathcal{L}%
(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{w}^{k}_{i}}\textrm{, where }\frac{d%
\mathcal{L}(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{w}^{k}_{i}}=\sum_{j=i}^{T%
}\frac{\partial\mathcal{L}_{j}(\bm{w}^{k}_{1:j},\bm{y}^{k}_{1:j})}{\partial\bm%
{w}^{k}_{i}}
\displaystyle\bm{y}^{k+1}_{i}\leftarrow\bm{y}^{k}_{i}+\alpha\frac{d\mathcal{L}%
(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{y}^{k}_{i}}\textrm{, where }\frac{d%
\mathcal{L}(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{y}^{k}_{i}}=\sum_{j=i}^{T%
}\frac{\partial\mathcal{L}_{j}(\bm{w}^{k}_{1:j},\bm{y}^{k}_{1:j})}{\partial\bm%
{y}^{k}_{i}}
\displaystyle\bm{y}^{k+1}_{i}\leftarrow\bm{y}^{k}_{i}+\alpha\frac{d\mathcal{L}%
(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{y}^{k}_{i}}\textrm{, where }\frac{d%
\mathcal{L}(\bm{w}^{k}_{1:T},\bm{y}^{k}_{1:T})}{d\bm{y}^{k}_{i}}=\sum_{j=i}^{T%
}\frac{\partial\mathcal{L}_{j}(\bm{w}^{k}_{1:j},\bm{y}^{k}_{1:j})}{\partial\bm%
{y}^{k}_{i}}
\bm{w}_{i},\bm{y}_{i}
\bm{w}_{i},\bm{y}_{i}
d\mathcal{L}/d\bm{w}_{i},d\mathcal{L}/d\bm{y}_{i}
d\mathcal{L}/d\bm{w}_{i},d\mathcal{L}/d\bm{y}_{i}
\partial\mathcal{L}_{j}/\partial\bm{w}_{i},\partial\mathcal{L}_{j}/\partial\bm%
{y}_{i}
\bm{w}_{i}
\bm{y}_{i}
k
k
d\mathcal{L}/d\bm{w}_{i},d\mathcal{L}/d\bm{y}_{i}
\displaystyle\frac{d\mathcal{L}(\bm{w}_{1:T},\bm{y}_{1:T})}{d\bm{w}_{i}}=\sum_%
{j=i}^{T}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{w}_{i}}
\displaystyle\frac{d\mathcal{L}(\bm{w}_{1:T},\bm{y}_{1:T})}{d\bm{w}_{i}}=
\displaystyle\sum_{j=i}^{T}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{%
d\bm{w}_{i}}
\displaystyle\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{w}_{i}}=%
\underbrace{\sum_{l=i+1}^{j}\frac{\partial\bm{w}_{l}}{\partial\bm{w}_{i}}\frac%
{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{w}_{l}}+\sum_{l=i}^{j}\frac%
{\partial\bm{y}_{l}}{\partial\bm{w}_{i}}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},%
\bm{y}_{1:j})}{d\bm{y}_{l}}}_{\textrm{ignored by BAO}}+\underbrace{\frac{%
\partial\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{\partial\bm{w}_{i}}}_{%
\textrm{considered by BAO}}
\displaystyle\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{w}_{i}}=
\displaystyle\underbrace{\sum_{l=i+1}^{j}\frac{\partial\bm{w}_{l}}{\partial\bm%
{w}_{i}}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{w}_{l}}+\sum_{%
l=i}^{j}\frac{\partial\bm{y}_{l}}{\partial\bm{w}_{i}}\frac{d\mathcal{L}_{j}(%
\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{y}_{l}}}_{\textrm{ignored by BAO}}+%
\underbrace{\frac{\partial\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{\partial%
\bm{w}_{i}}}_{\textrm{considered by BAO}}
d\mathcal{L}/d\bm{w}_{i},d\mathcal{L}/d\bm{y}_{i}
\partial\mathcal{L}_{j}/\partial\bm{w}_{i},\partial\mathcal{L}_{j}/\partial\bm%
{y}_{i}
i^{th}
\bm{w}_{i},\bm{y}_{i}
j^{th}
\mathcal{L}_{j}
\bm{w}_{1:T},\bm{y}_{1:T}
\bm{w}_{1:T}^{0},\bm{y}_{1:T}^{0}
\bm{w}_{1:T}^{k},\bm{y}_{1:T}^{k}
k\geq 1
\bm{w}_{1:T},\bm{y}_{1:T}
\bm{w}_{1:T}^{k},\bm{y}_{1:T}^{k}
\bm{w}_{>i},\bm{y}_{\geq i}
\bm{w}_{i}
K
\bm{w}_{i}
\bm{w}_{>i},\bm{y}_{\geq i}
\bm{y}_{i}
\bm{w}_{i}^{k_{i}}
\bm{w}_{i}
k_{i}
\bm{y}_{i}^{k^{\prime}_{j}}
\bm{y}_{i}
k^{\prime}_{i}
\displaystyle\bm{w}^{k_{i}+1}_{i}\leftarrow\bm{w}^{k_{i}}_{i}+\alpha\frac{d%
\mathcal{L}(\bm{w}_{1}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{w}^{K}_{>i},\bm{y}_{%
1}^{k^{\prime}_{1}},...,\bm{y}_{i-1}^{k^{\prime}_{i-1}},\bm{y}^{K}_{\geq i})}{%
d\bm{w}^{k_{i}}_{i}},
\displaystyle\bm{w}^{k_{i}+1}_{i}\leftarrow\bm{w}^{k_{i}}_{i}+\alpha\frac{d%
\mathcal{L}(\bm{w}_{1}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{w}^{K}_{>i},\bm{y}_{%
1}^{k^{\prime}_{1}},...,\bm{y}_{i-1}^{k^{\prime}_{i-1}},\bm{y}^{K}_{\geq i})}{%
d\bm{w}^{k_{i}}_{i}},
\displaystyle\textrm{where }\bm{w}_{>i}^{0},\bm{y}_{\geq i}^{0}=f(\bm{x},\bm{w%
}_{1}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{y}_{1}^{k^{\prime}_{1}},...,\bm{y}_{i%
-1}^{k^{\prime}_{i-1}})
\displaystyle\textrm{where }\bm{w}_{>i}^{0},\bm{y}_{\geq i}^{0}=f(\bm{x},\bm{w%
}_{1}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{y}_{1}^{k^{\prime}_{1}},...,\bm{y}_{i%
-1}^{k^{\prime}_{i-1}})
\bm{x}
\bm{w}
\bm{\tilde{w}}
\bm{y}
\bm{\tilde{y}}
\mathcal{L}(\bm{w},\bm{y})
q(\bm{\tilde{w}},\bm{\tilde{y}}|\bm{x})
q(\bm{\tilde{w}}|\bm{x})q(\bm{\tilde{y}}|\bm{\tilde{w}},\bm{x})
\bm{y}
\bm{w}
\bm{w}
\bm{y}
\bm{w}
\bm{x},\bm{w}^{k}
\bm{w}^{0}\leftarrow f(\bm{x})
k=0,...,K-1
\quad\quad\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{w}^{k}}=\textrm{grad%
-2-level}(\bm{x},\bm{w}^{k})
\quad\quad\bm{w}^{k+1}\leftarrow\bm{w}^{k}+\alpha\frac{d\mathcal{L}(\bm{w}^{k}%
,\bm{y}^{K})}{d\bm{w}^{k}}
\bm{w}^{K},\bm{y}^{K}
\bm{x},\bm{w}^{k}
\quad\bm{y}^{0}\leftarrow f(\bm{x},\bm{w}^{k})
k^{\prime}=0,...,K-1
\quad\quad\bm{y}^{k^{\prime}+1}\leftarrow\bm{y}^{k^{\prime}}+\alpha\frac{d%
\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{d\bm{y}^{k^{\prime}}}
\quad\overleftarrow{\bm{w}}\leftarrow\frac{\partial\mathcal{L}(\bm{w}^{k},\bm{%
y}^{K})}{\partial\bm{w}^{k}}
\quad\overleftarrow{\bm{y}^{K}}\leftarrow\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^%
{K})}{d\bm{y}^{K}}
k^{\prime}=K-1,...,0
\quad\quad\overleftarrow{\bm{w}}\leftarrow\overleftarrow{\bm{w}}+\alpha\frac{%
\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{\partial\bm{w}^{k}%
\partial\bm{y}^{k^{\prime}}}\overleftarrow{\bm{y}^{k^{\prime}+1}}
\quad\quad\overleftarrow{\bm{y}^{k^{\prime}}}\leftarrow\overleftarrow{\bm{y}^{%
k^{\prime}}}+\alpha\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}%
})}{\partial\bm{y}^{k^{\prime}}\partial\bm{y}^{k^{\prime}}}\overleftarrow{\bm{%
y}^{k^{\prime}+1}}
\quad\overleftarrow{\bm{w}}=\overleftarrow{\bm{w}}+\frac{\partial\bm{y}^{0}}{%
\partial\bm{w}^{k}}\overleftarrow{\bm{y}^{0}}
\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{w}^{k}}=\overleftarrow{\bm{w}}
\bm{x}
\bm{y}_{1},...,\bm{y}_{N}
\bm{y}_{j}
\mathcal{P}(\bm{y}_{j})=\varnothing
\bm{y}_{j}
\bm{y}_{0}
\mathcal{C}(\bm{y}_{0})
\bm{x},\bm{y}_{0}^{0}
\bm{y}_{1}^{K},...,\bm{y}_{N}^{K}
\bm{x},\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})
\bm{y}_{j}^{0}\leftarrow f(\bm{x},\bm{y}_{0}^{k_{0}},...,\bm{y}_{<j}^{k_{<j}})
k_{j}=0,...,K-1
\quad\quad\quad\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{j}^{k_{j}},%
\bm{y}_{>j}^{K})}{d\bm{y}_{j}^{k_{j}}}\leftarrow\textrm{grad-dag}(\bm{x},\bm{y%
}_{0}^{k_{0}},...,\bm{y}_{j}^{k_{j}})
\quad\quad\quad\bm{y}_{j}^{k_{j}+1}\leftarrow\bm{y}_{j}^{k_{j}}+\alpha\frac{d%
\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{j}^{k_{j}},\bm{y}_{>j}^{K})}{d\bm{y%
}_{j}^{k_{j}}}
\quad\overleftarrow{\bm{y}_{i}}\leftarrow\frac{\partial\mathcal{L}(\bm{y}_{0}^%
{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})}{\partial\bm{y}_{i}^{k_{i}}}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})
\quad\quad\overleftarrow{\bm{y}_{j}}\leftarrow\bm{0},\overleftarrow{\bm{y}_{j}%
^{K}}\leftarrow\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},%
\bm{y}_{>i}^{K})}{d\bm{y}_{j}^{K}}
k_{j}=K-1,...,0
\quad\quad\quad\overleftarrow{\bm{y}_{j}}\leftarrow\overleftarrow{\bm{y}_{j}}+%
\alpha\frac{\partial^{2}\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{j}^{k_{j}},%
\bm{y}_{>j}^{K})}{\partial\bm{y}_{i}^{k_{i}}\partial\bm{y}_{j}^{k_{j}}}%
\overleftarrow{\bm{y}_{j}^{k_{j}+1}}
\quad\quad\quad\overleftarrow{\bm{y}_{j}^{k_{j}}}\leftarrow\overleftarrow{\bm{%
y}_{j}^{k_{j}+1}}+\alpha\frac{\partial^{2}\mathcal{L}(\bm{y}_{0}^{k_{0}},...,%
\bm{y}_{j}^{k_{j}},\bm{y}_{>j}^{K})}{\partial\bm{y}_{j}^{k_{j}}\partial\bm{y}_%
{j}^{k_{j}}}\overleftarrow{\bm{y}_{j}^{k_{j}+1}}
\quad\quad\overleftarrow{\bm{y}_{i}}\leftarrow\overleftarrow{\bm{y}_{i}}+%
\overleftarrow{\bm{y}_{j}}+\frac{\partial\bm{y}_{j}^{0}}{\partial\bm{y_{i}^{k_%
{i}}}}\overleftarrow{\bm{y}_{j}^{0}}
\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})}%
{d\bm{y}_{i}^{k_{i}}}=\overleftarrow{\bm{y}_{i}}
\bm{w}
\mathcal{L}(\bm{w},\bm{y})
\bm{y}
\bm{w}
\max_{\bm{y}}\mathcal{L}(\bm{w},\bm{y})
\bm{w}
\mathcal{L}(\bm{w},\bm{y})
\bm{w}
\bm{y}
\displaystyle\bm{w}\leftarrow\arg\max_{\bm{w}}\mathcal{L}(\bm{w},\bm{y}^{*}(%
\bm{w}))\textrm{, where }\bm{y}^{*}(\bm{w})\leftarrow\arg\max_{\bm{y}}\mathcal%
{L}(\bm{w},\bm{y})
\displaystyle\bm{w}\leftarrow\arg\max_{\bm{w}}\mathcal{L}(\bm{w},\bm{y}^{*}(%
\bm{w}))\textrm{, where }\bm{y}^{*}(\bm{w})\leftarrow\arg\max_{\bm{y}}\mathcal%
{L}(\bm{w},\bm{y})
\alpha
K
\bm{w}^{k}
\bm{w}
k
\bm{y}^{k^{\prime}}
\bm{y}
k^{\prime}
f(.)
\bm{w}^{0},\bm{y}^{0}
\displaystyle\bm{w}^{k+1}\leftarrow\bm{w}^{k}+\alpha\frac{d\mathcal{L}(\bm{w}^%
{k},\bm{y}^{K})}{d\bm{w}^{k}},\bm{y}^{k^{\prime}+1}\leftarrow\bm{y}^{k^{\prime%
}}+\alpha\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{d\bm{y}^{k^{%
\prime}}}\textrm{, where }\bm{y}^{0}=f(\bm{x},\bm{w}^{k})
\displaystyle\bm{w}^{k+1}\leftarrow\bm{w}^{k}+\alpha\frac{d\mathcal{L}(\bm{w}^%
{k},\bm{y}^{K})}{d\bm{w}^{k}},\bm{y}^{k^{\prime}+1}\leftarrow\bm{y}^{k^{\prime%
}}+\alpha\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{d\bm{y}^{k^{%
\prime}}}\textrm{, where }\bm{y}^{0}=f(\bm{x},\bm{w}^{k})
d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})/d\bm{y}^{k^{\prime}}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}
\bm{w}^{0}
\bm{w}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}
\bm{x},\bm{w}^{k}
\bm{x},\bm{w}^{k}
\bm{y}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}
\bm{x},\bm{w}^{k}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}=\overleftarrow{\bm{w}}
N
\bm{y}_{1},...,\bm{y}_{N}
\mathcal{G}
\bm{\tilde{y}}_{1},...,\bm{\tilde{y}}_{N}
\mathcal{G}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i}),\bm{y}_{i}\in\mathcal{P}(\bm{y}_{j})
\bm{y}_{i}
\bm{y}_{j}
\bm{\tilde{y}}_{j}
\bm{\tilde{y}}_{i}
\bm{y}_{1},...,\bm{y}_{N}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i}),\bm{y}_{i}\in\mathcal{P}(\bm{y}_{j})
i<j
K
\bm{y}_{i}^{k_{i}}
\bm{y}_{i}
k_{i}
\displaystyle\bm{y}^{k_{i}+1}_{i}\leftarrow\bm{y}^{k_{i}}_{i}+\alpha\frac{d%
\mathcal{L}(\bm{y}_{1}^{k_{1}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})}{d\bm{y%
}^{k_{i}}}\textrm{, where }\bm{y}_{>i}^{0}=f(\bm{x},\bm{y}_{1}^{k_{1}},...,\bm%
{y}_{i}^{k_{i}})
\displaystyle\bm{y}^{k_{i}+1}_{i}\leftarrow\bm{y}^{k_{i}}_{i}+\alpha\frac{d%
\mathcal{L}(\bm{y}_{1}^{k_{1}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})}{d\bm{y%
}^{k_{i}}}\textrm{, where }\bm{y}_{>i}^{0}=f(\bm{x},\bm{y}_{1}^{k_{1}},...,\bm%
{y}_{i}^{k_{i}})
\bm{y}_{0}
\bm{y}
\bm{y}s
\bm{y}_{1},...,\bm{y}_{N}
\bm{x},\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}}
\bm{x},\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}}
\bm{y}_{i}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})
\bm{x},\bm{y}_{0}^{0}
\bm{y}_{1}^{K},...,\bm{y}_{N}^{K}
d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})/d\bm{y%
}_{i}^{k_{i}}
\bm{x},\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}}
d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})/d\bm{y%
}_{i}^{k_{i}}=\overleftarrow{\bm{y}_{i}}
\bm{w}_{1},\bm{y}_{1},...,\bm{w}_{T},\bm{y}_{T}
\bm{w}_{1}^{K},\bm{y}_{1}^{K},...,\bm{w}_{T}^{K},\bm{y}_{T}^{K}
d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})/d\bm{y%
}_{i}^{k_{i}}
N
K
\Theta(K^{N})
10
N=20
K=2000
\approx 2000^{20}
\Theta(KN)\approx 4\times 10^{4}
\Theta(KN)
\displaystyle\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{%
y}_{>i}^{K})}{d\bm{y}_{i}^{k_{i}}}\approx\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}}%
,...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{0})}{d\bm{y}_{i}^{k_{i}}}
\displaystyle\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{%
y}_{>i}^{K})}{d\bm{y}_{i}^{k_{i}}}\approx\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}}%
,...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{0})}{d\bm{y}_{i}^{k_{i}}}
\bm{y}_{>i}^{K}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})
\bm{y}_{i}
\bm{y}_{j}
\bm{y}_{i}\in\mathcal{P}(\bm{y}_{j})
\bm{y}_{i}^{K}
\Theta(KN)
\bm{x}
\quad\bm{y}_{1}^{0},...,\bm{y}_{N}^{0}\leftarrow f(\bm{x})
k=0,...,K-1
i=1,...,N
\quad\quad\quad\bm{y}_{i}^{k+1}\leftarrow\bm{y}_{i}^{k}+\alpha\frac{\partial%
\mathcal{L}(\bm{y}_{1}^{k},...,\bm{y}_{N}^{k})}{\partial\bm{y}_{i}^{k}}
y_{1}^{K},...,y_{N}^{K}
\bm{x}
\bm{y}_{1},...,\bm{y}_{N}
i=1,...,N
\quad\quad\bm{y}_{i}^{0},...,\bm{y}_{N}^{0}\leftarrow f(\bm{x},\bm{y}_{<i}^{K})
k=0,...,K-1
\quad\quad\quad\frac{d\mathcal{L}(\bm{y}_{<i}^{K},\bm{y}_{i}^{k},\bm{y}_{>i}^{%
K})}{d\bm{y}_{i}^{k}}\approx\frac{d\mathcal{L}(\bm{y}_{<i}^{K},\bm{y}_{i}^{k},%
\bm{y}_{>i}^{0})}{d\bm{y}_{i}^{k}}
\quad\quad\quad\bm{y}_{i}^{k+1}\leftarrow\bm{y}_{i}^{k}+\alpha\frac{d\mathcal{%
L}(\bm{y}_{<i}^{K},\bm{y}_{i}^{k},\bm{y}_{>i}^{K})}{d\bm{y}_{i}^{k}}
y_{1}^{K},...,y_{N}^{K}
\bm{y}_{1:T}
\bm{y}_{i}
\bm{y}_{>i}
\bm{y}_{>i}^{K}
\bm{y}_{i}
\bm{y}_{<i}
\bm{y}_{<i}^{K}
N
K
\Theta(KN)
\Theta(K^{N})
\Theta(KN)
1
4
\phi
\lambda_{0}=\{256,512,1024,2048\}
lr=1\times 10^{-3}
K=2000
K=400
\downarrow
920
2000
\bm{w}_{1:T},\bm{y}_{1:T}
\bm{y}_{1:T}
\bm{w}_{1:T}
\bm{w}_{1:T},\bm{y}_{1:T}
\bm{y}_{1:T}
\bm{w}_{1:T}
\downarrow
\downarrow
\bm{y}
\bm{w}
\bm{y},\bm{w}
\bm{y}
\bm{w}
\bm{y},\bm{w}
4^{th}
\bm{y}_{i}
\bm{x},\bm{w}^{k}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}=\overleftarrow{\bm{w}}
\bm{w}
\bm{y}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}
\displaystyle\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{w}^{k}}=%
\underbrace{\frac{\partial\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{\partial\bm{w}^{%
k}}}_{\textrm{known}}+\sum_{k^{\prime}=0}^{K}\underbrace{\frac{\partial\bm{y}^%
{k^{\prime}}}{\partial\bm{w}^{k}}}_{\textrm{Eq.~{}}\ref{eq:yw_gd}}\underbrace{%
\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{y}^{k^{\prime}}}}_{\textrm{Eq.%
~{}}\ref{eq:yKyk_gd}}
\displaystyle\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{w}^{k}}=%
\underbrace{\frac{\partial\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{\partial\bm{w}^{%
k}}}_{\textrm{known}}+\sum_{k^{\prime}=0}^{K}\underbrace{\frac{\partial\bm{y}^%
{k^{\prime}}}{\partial\bm{w}^{k}}}_{\textrm{Eq.~{}}\ref{eq:yw_gd}}\underbrace{%
\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{y}^{k^{\prime}}}}_{\textrm{Eq.%
~{}}\ref{eq:yKyk_gd}}
\partial\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/\partial\bm{w}^{k},d\mathcal{L}(\bm%
{w}^{k},\bm{y}^{K})/d\bm{y}^{K},\partial\bm{y}^{0}/\partial\bm{w}^{k}
\bm{y}^{k^{\prime}+1}\leftarrow\bm{y}^{k^{\prime}}+\alpha d\mathcal{L}(\bm{w}^%
{k},\bm{y}^{k^{\prime}})/d\bm{y}^{k^{\prime}}
\bm{w}^{k},\bm{y}^{k^{\prime}}
\partial\bm{y}^{k^{\prime}+1}/\partial\bm{w}^{k}
d\bm{y}^{k^{\prime}+1}/d\bm{w}^{k}=(\partial\bm{y}^{k^{\prime}+1}/\partial\bm{%
y}^{k^{\prime}})(d\bm{y}^{k^{\prime}}/d\bm{w}^{k})+\partial\bm{y}^{k^{\prime}+%
1}/\partial\bm{w}^{k}
\displaystyle\frac{\partial\bm{y}^{k^{\prime}+1}}{\partial\bm{y}^{k^{\prime}}}%
=I+\alpha\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{%
\partial\bm{y}^{k^{\prime}}\partial\bm{y}^{k^{\prime}}}
\displaystyle\frac{\partial\bm{y}^{k^{\prime}+1}}{\partial\bm{y}^{k^{\prime}}}
\displaystyle=I+\alpha\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{%
\prime}})}{\partial\bm{y}^{k^{\prime}}\partial\bm{y}^{k^{\prime}}}
\displaystyle\frac{\partial\bm{y}^{k^{\prime}+1}}{\partial\bm{w}^{k}}=\alpha%
\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{\partial\bm{w}^%
{k}\partial\bm{y}^{k^{\prime}}}
\displaystyle\frac{\partial\bm{y}^{k^{\prime}+1}}{\partial\bm{w}^{k}}
\displaystyle=\alpha\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime%
}})}{\partial\bm{w}^{k}\partial\bm{y}^{k^{\prime}}}
d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{y}^{k^{\prime}}
\displaystyle\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{y}^{k^{\prime}}}=%
\frac{\partial\bm{y}^{k^{\prime}+1}}{\partial\bm{y}^{k^{\prime}}}\frac{d%
\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{y}^{k^{\prime}+1}}
\displaystyle\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{y}^{k^{\prime}}}=%
\frac{\partial\bm{y}^{k^{\prime}+1}}{\partial\bm{y}^{k^{\prime}}}\frac{d%
\mathcal{L}(\bm{w}^{k},\bm{y}^{K})}{d\bm{y}^{k^{\prime}+1}}
\bm{x},\bm{w}^{k}
\overleftarrow{\bm{y}^{k^{\prime}+1}}
\overleftarrow{\bm{w}}
\bm{x},\bm{w}^{k}
\overleftarrow{\bm{w}}=d\mathcal{L}(\bm{w}^{k},\bm{y}^{K})/d\bm{w}^{k}
\displaystyle\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{%
\partial\bm{w}^{k}\partial\bm{y}^{k^{\prime}}}\bm{v}=\lim_{r\rightarrow 0}%
\frac{1}{r}(\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}}+r\bm{v})}{d\bm{w%
}^{k}}-\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{d\bm{w}^{k}})
\displaystyle\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{%
\partial\bm{w}^{k}\partial\bm{y}^{k^{\prime}}}\bm{v}
\displaystyle=\lim_{r\rightarrow 0}\frac{1}{r}(\frac{d\mathcal{L}(\bm{w}^{k},%
\bm{y}^{k^{\prime}}+r\bm{v})}{d\bm{w}^{k}}-\frac{d\mathcal{L}(\bm{w}^{k},\bm{y%
}^{k^{\prime}})}{d\bm{w}^{k}})
\displaystyle\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{%
\partial\bm{y}^{k^{\prime}}\partial\bm{y}^{k^{\prime}}}\bm{v}=\lim_{r%
\rightarrow 0}\frac{1}{r}(\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}}+r%
\bm{v})}{d\bm{y}^{k^{\prime}}}-\frac{d\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime%
}})}{d\bm{y}^{k^{\prime}}})
\displaystyle\frac{\partial^{2}\mathcal{L}(\bm{w}^{k},\bm{y}^{k^{\prime}})}{%
\partial\bm{y}^{k^{\prime}}\partial\bm{y}^{k^{\prime}}}\bm{v}
\displaystyle=\lim_{r\rightarrow 0}\frac{1}{r}(\frac{d\mathcal{L}(\bm{w}^{k},%
\bm{y}^{k^{\prime}}+r\bm{v})}{d\bm{y}^{k^{\prime}}}-\frac{d\mathcal{L}(\bm{w}^%
{k},\bm{y}^{k^{\prime}})}{d\bm{y}^{k^{\prime}}})
\bm{x},\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}}
d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})/d\bm{y%
}_{i}^{k_{i}}=\overleftarrow{\bm{y}_{i}}
\mathcal{G}
\bm{y}_{i}^{k}
\mathcal{L}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})
\bm{y}_{j}^{K}
\bm{y}_{j}
\displaystyle\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{%
y}_{>i}^{K})}{d\bm{y}_{i}^{k_{i}}}=\underbrace{\frac{\partial\mathcal{L}(\bm{y%
}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})}{\partial\bm{y}_{i}^{k_{%
i}}}}_{\textrm{known}}+\sum_{\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})}(\sum_{k_{j}%
=0}^{K}\underbrace{\frac{\partial\bm{y}_{j}^{k_{j}}}{\partial\bm{y}_{i}^{k_{i}%
}}}_{\textrm{Eq.~{}}\ref{eq:yw_gd}}\underbrace{\frac{d\mathcal{L}(\bm{y}_{0}^{%
k_{0}},...,\bm{y}_{j-1}^{k_{j-1}},\bm{y}_{\geq j}^{K})}{d\bm{y}_{j}^{k_{j}}}}_%
{\textrm{Eq.~{}}\ref{eq:yKyk_gd}})
\displaystyle\frac{d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{%
y}_{>i}^{K})}{d\bm{y}_{i}^{k_{i}}}=\underbrace{\frac{\partial\mathcal{L}(\bm{y%
}_{0}^{k_{0}},...,\bm{y}_{i}^{k_{i}},\bm{y}_{>i}^{K})}{\partial\bm{y}_{i}^{k_{%
i}}}}_{\textrm{known}}+\sum_{\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})}(\sum_{k_{j}%
=0}^{K}\underbrace{\frac{\partial\bm{y}_{j}^{k_{j}}}{\partial\bm{y}_{i}^{k_{i}%
}}}_{\textrm{Eq.~{}}\ref{eq:yw_gd}}\underbrace{\frac{d\mathcal{L}(\bm{y}_{0}^{%
k_{0}},...,\bm{y}_{j-1}^{k_{j-1}},\bm{y}_{\geq j}^{K})}{d\bm{y}_{j}^{k_{j}}}}_%
{\textrm{Eq.~{}}\ref{eq:yKyk_gd}})
\partial\bm{y}_{j}^{k_{j}}/\partial\bm{y}_{i}^{k_{i}}
d\mathcal{L}(\bm{y}_{0}^{k_{0}},...,\bm{y}_{j-1}^{k_{j-1}},\bm{y}_{\geq j}^{K}%
)/d\bm{y}_{j}^{k_{j}}
\bm{y}_{i}
\bm{y}_{j}\in\mathcal{C}(\bm{y}_{i})
\bm{y}_{j}^{k_{j}+1}\leftarrow\bm{y}_{j}^{k_{j}}+\alpha d\mathcal{L}(\bm{y}_{0%
}^{k_{0}},...,\bm{y}_{j}^{k_{j}},\bm{y}_{>j}^{K})/d\bm{y}_{j}^{k_{j}}
\mathcal{C}(\bm{y}_{j})
\Theta(K^{N})
\bm{y}_{i}
\displaystyle\frac{d\mathcal{L}(\bm{w}_{1:T},\bm{y}_{1:T})}{d\bm{y}_{i}}=\sum_%
{j=i}^{T}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{y}_{i}}
\displaystyle\frac{d\mathcal{L}(\bm{w}_{1:T},\bm{y}_{1:T})}{d\bm{y}_{i}}=
\displaystyle\sum_{j=i}^{T}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{%
d\bm{y}_{i}}
\displaystyle\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{y}_{i}}=%
\underbrace{\sum_{l=i+1}^{j}(\frac{\partial\bm{y}_{l}}{\partial\bm{y}_{i}}%
\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{y}_{l}}+\frac{\partial%
\bm{w}_{l}}{\partial\bm{y}_{i}}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j%
})}{d\bm{w}_{l}})}_{\textrm{ignored by BAO}}+\underbrace{\frac{\partial%
\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{\partial\bm{y}_{i}}}_{\textrm{%
considered by BAO}}
\displaystyle\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{y}_{i}}=
\displaystyle\underbrace{\sum_{l=i+1}^{j}(\frac{\partial\bm{y}_{l}}{\partial%
\bm{y}_{i}}\frac{d\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{d\bm{y}_{l}}+%
\frac{\partial\bm{w}_{l}}{\partial\bm{y}_{i}}\frac{d\mathcal{L}_{j}(\bm{w}_{1:%
j},\bm{y}_{1:j})}{d\bm{w}_{l}})}_{\textrm{ignored by BAO}}+\underbrace{\frac{%
\partial\mathcal{L}_{j}(\bm{w}_{1:j},\bm{y}_{1:j})}{\partial\bm{y}_{i}}}_{%
\textrm{considered by BAO}}
\displaystyle\bm{y}^{k^{\prime}_{i}+1}_{i}\leftarrow\bm{y}^{k^{\prime}_{i}}+%
\alpha\frac{d\mathcal{L}(\bm{w}_{1}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{w}^{K}_%
{>i},\bm{y}_{1}^{k^{\prime}_{1}},...,\bm{y}_{i}^{k^{\prime}_{i}},\bm{y}^{K}_{>%
i})}{d\bm{y}^{k^{\prime}_{i}}_{i}},
\displaystyle\bm{y}^{k^{\prime}_{i}+1}_{i}\leftarrow\bm{y}^{k^{\prime}_{i}}+%
\alpha\frac{d\mathcal{L}(\bm{w}_{1}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{w}^{K}_%
{>i},\bm{y}_{1}^{k^{\prime}_{1}},...,\bm{y}_{i}^{k^{\prime}_{i}},\bm{y}^{K}_{>%
i})}{d\bm{y}^{k^{\prime}_{i}}_{i}},
\displaystyle\textrm{where }\bm{w}_{>i}^{0},\bm{y}_{>i}^{0}=f(\bm{x},\bm{w}_{1%
}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{y}_{1}^{k^{\prime}_{1}},...,\bm{y}_{i}^{k%
^{\prime}_{i}})
\displaystyle\textrm{where }\bm{w}_{>i}^{0},\bm{y}_{>i}^{0}=f(\bm{x},\bm{w}_{1%
}^{k_{1}},...,\bm{w}_{i}^{k_{i}},\bm{y}_{1}^{k^{\prime}_{1}},...,\bm{y}_{i}^{k%
^{\prime}_{i}})
N=3
\bm{y}_{1},\bm{y}_{2},\bm{y}_{3}
K=2
k_{i}
\bm{y}_{i}
k_{i}
\bm{y}_{i}
\bm{y}_{i}
\bm{y}_{i},\bm{z}_{i},\Delta^{y}_{i}
\bm{w}_{i}
\bm{w}_{i}
\bm{w}_{i},\bm{v}_{i},\Delta^{w}_{i}
\bm{y}_{i}
\lambda_{0}=\{256,512,1024,2048\}
K=2000
K=400
920
2000
\uparrow
10
\bm{y}_{0},\bm{w}_{1},\bm{y}_{1},...,\bm{w}_{9},\bm{y}_{9}
\bm{y}_{0}
\bm{w}_{i}
i^{th}
\bm{y}_{i}
i^{th}
\bm{y}_{3}
\bm{y}_{9}
\bm{w}_{1:T}
\bm{y}_{1:T}
\bm{y}_{1:T}
\bm{y}_{1:T}
\pm 0.1
=0.148
=33.06
=0.103
=34.91
=0.148
=33.06
=0.103
=34.91
=0.206
=30.71
=0.129
=32.34
=0.206
=30.71
=0.129
=32.34
=0.232
=28.72
=0.128
=30.87
=0.232
=28.72
=0.128
=30.87
=0.448
=30.48
=0.379
=31.92
=0.448
=30.48
=0.379
=31.92
