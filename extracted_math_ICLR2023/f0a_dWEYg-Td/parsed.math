100\%
\ell_{\infty}
\epsilon=8/255
{\mathcal{D}}
{\mathcal{X}}
{\mathcal{Y}}
C
{\mathcal{Y}}=[C]
h:{\mathcal{X}}\to\Delta_{{\mathcal{Y}}}
f:{\mathcal{X}}\to\mathbb{R}^{d}
g:\mathbb{R}^{d}\to\Delta_{{\mathcal{Y}}}
\Delta_{{\mathcal{Y}}}
l
{\mathcal{L}}(h;{\mathcal{D}})
h
{\mathcal{D}}
{\mathcal{L}}_{\texttt{CE}}(h;{\mathcal{D}})
h
{\mathcal{L}}_{\texttt{CL}}(f;{\mathcal{D}})
f
{\mathcal{D}}_{c}
{\mathcal{D}}_{p}
{\mathcal{D}}_{p}
f_{p}=\operatorname*{arg\,min}_{f}{\mathcal{L}}_{\texttt{CL}}(f;{\mathcal{D}}_%
{p})
{\mathcal{D}}_{e}
g_{p}=\operatorname*{arg\,min}_{g}{\mathcal{L}}_{\texttt{CE}}(g\circ f_{p};{%
\mathcal{D}}_{e})
h_{p}=g_{p}\circ f_{p}
{\mathcal{D}}_{e}
f_{\theta}
\theta
\delta(x)
\min_{\theta,\delta:\|\delta(x)\|_{\infty}\leq\epsilon}\mathbb{E}_{\{x_{i}\}^{%
B}_{i=1}\sim{\mathcal{D}}_{c}}{\mathcal{L}}_{\texttt{CL}}(f_{\theta};\{x_{i}+%
\delta(x_{i})\}^{B}_{i=1}).
{\mathcal{L}}_{\texttt{CL}}(f_{\theta};\{x_{i}+\delta(x_{i})\}^{B}_{i=1})
T_{\theta}
T_{\delta}
\ell_{\infty}
{\mathcal{D}}_{c}
\eta_{\theta}
\eta_{\delta}
T
T_{\theta}
T_{\delta}
T_{p}
=1,\ldots
=1,2,\ldots,T_{\theta}
\{x_{i}\}_{i=1}^{B}\sim{\mathcal{D}}_{c}
\theta\leftarrow\theta-\eta_{\theta}\nabla_{\theta}{\mathcal{L}}_{\texttt{CL}}%
(f_{\theta};\{x_{i}+\delta_{i}\}^{B}_{i=1})
=1,2,\ldots,T_{\delta}
\{(x_{i},y_{i})\}_{i=1}^{B}\sim{\mathcal{D}}_{c}
=1,2,\ldots,T_{p}
g_{i}\leftarrow\nabla_{\delta_{i}}{\mathcal{L}}_{\texttt{CL}}(f_{\theta};\{x_{%
i}+\delta_{i}\}^{B}_{i=1})
\delta(x_{i})\leftarrow\Pi_{\epsilon}\left(\delta(x_{i})-\eta_{\delta}\cdot%
\text{sign}(g_{i})\right)
\delta(y)\leftarrow\Pi_{\epsilon}\left(\delta(x_{i})-\eta_{\delta}\cdot\text{%
sign}(\sum_{i:y_{i}=y}g_{i})\right),\forall y
{\mathcal{D}}_{p}=\{x+\delta(x):x\in{\mathcal{D}}_{c}\}
\nabla_{x}l_{\texttt{CE}}(h(x),y)
O
I
r_{b}
\frac{\partial O_{c,h,w}}{\partial I_{c^{\prime},h^{\prime},w^{\prime}}}=r_{b}%
\bm{1}_{[c=c^{\prime},h=h^{\prime},w=w^{\prime}]}
h,w,h^{\prime},w^{\prime}
c,c^{\prime}
\sim
[-8/255,8/255]
\%
\downarrow
\%
\downarrow
\%
\downarrow
\%
\downarrow
10\%
p
-p
-
p
100\%-p
p
100\%
7\%
20\%
l_{\infty}
\sigma=8/255
\sigma=64/255
k=3
k=15
\sigma=8/255
\sigma=64/255
3\times 3
15\times 15
16\times 16
50\%
86.9\%
5.9\%
I\in\mathbb{R}^{3\times H\times W}
H
W
O\in\mathbb{R}^{3\times P\times Q}
P
Q
P,Q
H,W
(c_{x},c_{y})
T=\begin{bmatrix}1&0&-c_{x}\\
0&1&-c_{y}\\
0&0&1\end{bmatrix}.
T=\begin{bmatrix}P/H&0&0\\
0&Q/W&0\\
0&0&1\end{bmatrix}.
T=\begin{bmatrix}1&0&0\\
0&-1&W-1\\
0&0&1\end{bmatrix}.
T
(c,p,q)
c\in\{0,1,2\}
p\in\{0,1,\ldots,P-1\}
q\in\{0,1,\ldots,Q-1\}
O_{c,p,q}=\sum_{h,w}\alpha_{h,w}\cdot I_{c,h,w},
\alpha_{h,w}=1
\begin{bmatrix}h\\
w\\
1\end{bmatrix}=T^{-1}\begin{bmatrix}p\\
q\\
1\end{bmatrix}
\alpha_{h,w}=0
\alpha_{h,w}
\alpha_{h,w}
(h,w)
(h^{\prime},w^{\prime})
\begin{bmatrix}h^{\prime}\\
w^{\prime}\\
1\end{bmatrix}=T^{-1}\begin{bmatrix}p\\
q\\
1\end{bmatrix}
\alpha_{h,w}=0
\alpha_{h,w}=1
(h,w)
(h^{\prime},w^{\prime})=(\frac{pH}{P},\frac{qW}{Q})
\alpha_{h,w}=0
\frac{\partial O_{c,p,q}}{\partial I_{c,h,w}}=\alpha_{h,w}
H=P
W=Q
O_{c,p,q}=0.299\cdot I_{0,p,q}+0.587\cdot I_{1,p,q}+0.114\cdot I_{2,p,q}
\forall c,p,q
O=r_{b}\cdot I
r_{b}
O=r_{c}\cdot I+(1-r_{c})\cdot\text{mean}(G)\cdot J_{3,H,W}
r_{c}
G
I
J_{3,H,W}
O=r_{s}\cdot I+(1-r_{s})\cdot G
r_{s}
G
I
O=f(r_{h}\cdot h(I),s(I),v(I))
r_{h}
f
h,s,v
f,h,s,v
\frac{\partial O_{c,p,q}}{\partial I_{c,h,w}}
\sim
10^{-4}
10^{-4}
10^{-4}
T=600
T_{\theta}=100
T_{\delta}=100
T_{p}=5
T=200
T_{\theta}=20
T_{\delta}=20
T_{p}=1
\eta_{\delta}
L_{\infty}
\eta_{\delta}=\epsilon/10=0.8/255
T
T_{p}
T_{\theta}
T_{\delta}
f_{\theta}
