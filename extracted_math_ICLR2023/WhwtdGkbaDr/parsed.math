\S
{\ddagger}
\mathcal{X}
\mathcal{Y}
(\mathbf{x},y)\!\in\!\mathcal{X}{\times}\mathcal{Y}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{S}{=}\{(\mathbf{x}_{i},y_{i})\}_{i=1}^{m}
m
\mathcal{D}
\mathcal{D}^{m}
\mathcal{H}
h\!:\!\mathcal{X}{\to}\mathcal{Y}
\mathcal{Y}
\mathcal{X}
\mathcal{M}(\mathcal{H})
\mathcal{H}
\mathcal{S}
\ell\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})\to\mathbb{R}
h\!\in\!\mathcal{H}
\text{R}^{\ell}_{\mathcal{D}}(h){=}\operatorname*{\mathbb{E}}_{(\mathbf{x},y)%
\sim\mathcal{D}}\ell(h,(\mathbf{x},y))
\mathcal{D}
\text{R}^{\ell}_{\mathcal{D}}(h)
\text{R}^{\ell}_{\mathcal{S}}(h){=}\frac{1}{m}\sum_{i=1}^{m}\ell(h,(\mathbf{x}%
_{i},y_{i}))
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\!=\!|%
\text{R}^{\ell}_{\mathcal{D}}(h){-}\text{R}^{\ell}_{\mathcal{S}}(h)|
\mathcal{H}
\pi\!\in\!\mathcal{M}(\mathcal{H})
\mathcal{H}
h\!\in\!\mathcal{H}
\mathcal{S}
\pi
\rho\!\in\!\mathcal{M}(\mathcal{H})
\mathcal{H}
\mathcal{H}
\rho
\pi
\rho
|\operatorname*{\mathbb{E}}_{h\sim\rho}[\text{R}^{\ell}_{\mathcal{D}}(h){-}%
\text{R}^{\ell}_{\mathcal{S}}(h)]|
\rho
\pi
\operatorname{KL}(\rho\|\pi)=\operatorname*{\mathbb{E}}_{h\sim\rho}\!\ln\frac{%
\rho(h)}{\pi(h)}
\rho
\pi
\rho
h
\rho
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h)){=}|%
\text{R}^{\ell}_{\mathcal{D}}(h){-}\text{R}^{\ell}_{\mathcal{S}}(h)|
h
\rho_{\mathcal{S}}
\rho_{\mathcal{S}}
\mathcal{S}\!\sim\!\mathcal{D}^{m}
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\pi\!\in\!\mathcal{M}(\mathcal{H})
\varphi:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})^{m}\to\mathbb{R}
\delta\!\in\!(0,1]
1-\delta
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\varphi(h,\mathcal{S})\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}%
\!+\!\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{\varphi(g,\mathcal{V})%
}\right],
\displaystyle\varphi(h,\mathcal{S})\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}%
\!+\!\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{\varphi(g,\mathcal{V})%
}\right],
\rho_{\mathcal{S}}\in\mathcal{M}(\mathcal{H})
\varphi
\varphi(h,\mathcal{S})=m\,\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell%
}_{\mathcal{S}}(h))
\text{R}^{\ell}_{\mathcal{D}}(h)
\text{R}^{\ell}_{\mathcal{S}}(h)
\ln\tfrac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\pi
\rho_{\mathcal{S}}
h
\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}}%
\operatorname*{\mathbb{E}}_{g}\exp\left(\varphi(g,\mathcal{V})\right)\right]
h\!\in\!\mathcal{H}
\mathcal{S}\!\in\!(\mathcal{X}{\times}\mathcal{Y})^{m}
\varphi
g{\sim}\pi
\mathcal{V}{\sim}\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\mathcal{S}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\operatorname{\mu}
\Phi_{\operatorname{\mu}}^{r}(h{,}\mathcal{S}{,}\delta)
\operatorname{\mu}
r\!\sim\!\mathcal{R}
h\!\in\!\mathcal{H}
\mathcal{S}{\in}(\mathcal{X}{\times}\mathcal{Y})^{m}
\delta
\Phi_{\operatorname{\mu}}^{r}(h,\mathcal{S},\delta)
\rho_{\mathcal{S}}
\operatorname{\mu}
\rho_{\mathcal{S}}
\operatorname{\mu}
\rho_{\mathcal{S}}
\operatorname{\mu}
\rho_{\mathcal{S}}
\operatorname{\mu}
\rho_{\mathcal{S}}
\operatorname{\mu}
\rho_{\mathcal{S}}
\operatorname{\mu}
\ell\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{R}
\mathcal{H}
\Phi_{\operatorname{\mu}}^{r}:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{%
Y})^{m}{\times}(0,1]{\to}\mathbb{R}
\delta\!\in\!(0,1]
\displaystyle\operatorname*{\mathbb{P}}_{r\sim\mathcal{R},\mathcal{S}\sim%
\mathcal{D}^{m},h\sim\rho_{\mathcal{S}}}\!\Big{[}\phi(\text{R}^{\ell}_{%
\mathcal{D}}(h){,}\text{R}^{\ell}_{\mathcal{S}}(h))\leq\Phi_{\operatorname{\mu%
}}^{r}(h,\mathcal{S},\delta)\Big{]}{\geq}1{-}\delta,
\displaystyle\operatorname*{\mathbb{P}}_{r\sim\mathcal{R},\mathcal{S}\sim%
\mathcal{D}^{m},h\sim\rho_{\mathcal{S}}}\!\Big{[}\phi(\text{R}^{\ell}_{%
\mathcal{D}}(h){,}\text{R}^{\ell}_{\mathcal{S}}(h))\leq\Phi_{\operatorname{\mu%
}}^{r}(h,\mathcal{S},\delta)\Big{]}{\geq}1{-}\delta,
\rho_{\mathcal{S}}\in\mathcal{M}(\mathcal{H})
\rho_{\mathcal{S}}
\operatorname{\mu}
\rho_{\mathcal{S}}
\displaystyle\rho_{\mathcal{S}}(h)\propto\exp\left[-\operatorname{\mu}(h,%
\mathcal{S})\right].
\displaystyle\rho_{\mathcal{S}}(h)\propto\exp\left[-\operatorname{\mu}(h,%
\mathcal{S})\right].
\rho_{\mathcal{S}}^{\prime}
\mathcal{H}
\operatorname{\mu}(h,\mathcal{S})\!=\!-\ln\rho_{\mathcal{S}}^{\prime}(h)
\rho_{\mathcal{S}}^{\prime}
\rho_{\mathcal{S}}
\mathcal{S}
h
\operatorname{\mu}(h,\mathcal{S})
h\mapsto\operatorname{\mu}(h,\mathcal{S})
\text{R}^{\ell}_{\mathcal{D}}(h)
\operatorname{\mu}(h,\mathcal{S})\!=\!\alpha\text{R}^{\ell}_{\mathcal{D}}(h)
\alpha\!\in\!\mathbb{R}_{+}^{*}
\operatorname{\mu}
\operatorname{\mu}
\operatorname{\mu}(h,\mathcal{S})\!=\!\alpha\text{R}^{\ell}_{\mathcal{S}}(h)
\operatorname{\mu}(h,\mathcal{S})\!=\!\alpha\nu(h,\mathcal{S})
\alpha
h\!\in\!\mathcal{H}
\displaystyle h_{t}\longleftarrow h_{t-1}-\eta\nabla\nu(h_{t},\mathcal{S})+%
\sqrt{\frac{2\eta}{\alpha}}\epsilon_{t},
\displaystyle h_{t}\longleftarrow h_{t-1}-\eta\nabla\nu(h_{t},\mathcal{S})+%
\sqrt{\frac{2\eta}{\alpha}}\epsilon_{t},
\epsilon_{t}\!\sim\!\mathcal{N}({\mathbf{0}},\mathbf{I}_{D})
h_{t}
t\!\in\!\mathbb{N}
\eta
\alpha
\alpha
\epsilon_{t}
\sqrt{\nicefrac{{2\eta}}{{\alpha}}}\epsilon_{t}
\nu
\eta
t\geq 0
\displaystyle dh_{t}=-\nabla\nu(h_{t},\mathcal{S})dt+\sqrt{\frac{2}{\alpha}}B_%
{t},
\displaystyle dh_{t}=-\nabla\nu(h_{t},\mathcal{S})dt+\sqrt{\frac{2}{\alpha}}B_%
{t},
B_{t}
\nu
\rho_{\mathcal{S}}
\operatorname{\mu}(h,\mathcal{S})=\alpha\nu(h,\mathcal{S})
\operatorname{\mu}
\rho_{\mathcal{S}}(h)\!\propto\!\exp\left[-\!\operatorname{\mu}(h,\mathcal{S})\right]
\phi
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\pi\in\mathcal{M}(\mathcal{H})
\mathcal{H}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1-\delta
h^{\prime}\sim\pi
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S%
}}(h))\leq\operatorname{\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{\mu}(h,%
\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h)}
\displaystyle\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S%
}}(h))
\displaystyle\leq\operatorname{\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{%
\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h)}
\displaystyle+\ln\!\left[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{%
\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))}\right]
\displaystyle+\ln\!\left[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{%
\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))}\right]
\displaystyle\triangleq\Phi_{\operatorname{\mu}}^{h^{\prime}}(h,\mathcal{S},%
\delta),
\displaystyle\triangleq\Phi_{\operatorname{\mu}}^{h^{\prime}}(h,\mathcal{S},%
\delta),
\rho_{\mathcal{S}}
\Phi_{\operatorname{\mu}}^{h^{\prime}}(h{,}\mathcal{S}{,}\delta)
\operatorname{\mu}(h^{\prime}{,}\mathcal{S}){-}\operatorname{\mu}(h{,}\mathcal%
{S})
\ln({\pi(h^{\prime})}/{\pi(h)})
\ln[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}\exp[\phi(\text{R}^{%
\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))]]
\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\operatorname{\mu}(h^{\prime}{,}\mathcal{S}){-}\operatorname{\mu}(h{,}\mathcal%
{S})
\ln({\pi(h^{\prime})}/{\pi(h)})
\operatorname{\mu}(h^{\prime},\mathcal{S})
\operatorname{\mu}(h,\mathcal{S})
\pi
\epsilon>0
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Big{[}|\text{R}_{\mathcal{D}}(h){-}\text{R}_{\mathcal{S}}(%
h)|\leq\operatorname{\mu}(h,\mathcal{S}){+}\epsilon\Big{]}\geq 1{-}\delta^{%
\prime}(\epsilon),
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Big{[}|\text{R}_{\mathcal{D}}(h){-}\text{R}_{\mathcal{S}}(%
h)|\leq\operatorname{\mu}(h,\mathcal{S}){+}\epsilon\Big{]}\geq 1{-}\delta^{%
\prime}(\epsilon),
\delta^{\prime}(\epsilon)
n
\mathcal{S}_{1},\dots,\mathcal{S}_{n}
n
h_{1}\sim\rho_{\mathcal{S}_{1}},\dots,h_{n}\sim\rho_{\mathcal{S}_{n}}
\mathcal{D}
\rho_{\mathcal{S}}
\mathcal{D}
\delta^{\prime}(\epsilon)
\phi
m
\phi
m
\pi
\operatorname{\mu}
h\!\sim\!\rho_{\mathcal{S}}
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))
\operatorname{\mu}(h,\mathcal{S}){=}0
\operatorname{\mu}(h^{\prime},\mathcal{S}){-}\operatorname{\mu}(h,\mathcal{S})%
{=}0
\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{D}}(h)
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))
\text{R}^{\ell}_{\mathcal{D}}(h)
\mu
\ln[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}\exp[\phi(\text{R}^{%
\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))]]
\ln({\pi(h^{\prime})}/{\pi(h)})
\ell\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})\!\to\![0,1]
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h)){=}m%
\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{\ell}_{\mathcal{%
D}}(h)]
\operatorname{kl}(q\|p)\triangleq q\ln\frac{q}{p}+(1{-}q)\ln\frac{1{-}q}{1{-}p}
p\in(0,1)
q\in[0,1]
\pi
\mathcal{H}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\pi
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h^{\prime}{\sim}\pi
h{\sim}\rho_{\mathcal{S}}
\displaystyle\operatorname{kl}\!\left[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{%
R}^{\ell}_{\mathcal{D}}(h)\right]\leq\frac{\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S}){-}\!\operatorname{\mu}(h{,}\mathcal{S}){+}\ln\tfrac{8\sqrt{m}}{%
\delta^{2}}}{m},
\displaystyle\operatorname{kl}\!\left[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{%
R}^{\ell}_{\mathcal{D}}(h)\right]\leq\frac{\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S}){-}\!\operatorname{\mu}(h{,}\mathcal{S}){+}\ln\tfrac{8\sqrt{m}}{%
\delta^{2}}}{m},
\rho_{\mathcal{S}}
\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{\ell}_{\mathcal{%
D}}(h)]
\text{R}^{\ell}_{\mathcal{D}}(h)
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\overline{\operatorname{kl}}%
\left[\text{R}^{\ell}_{\mathcal{S}}(h)\;\middle|\;\frac{\operatorname{\mu}(h^{%
\prime}\!,\mathcal{S}){-}\operatorname{\mu}(h{,}\mathcal{S}){+}\ln\tfrac{8%
\sqrt{m}}{\delta^{2}}}{m}\,\right]\!,
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\overline{\operatorname{kl}}%
\left[\text{R}^{\ell}_{\mathcal{S}}(h)\;\middle|\;\frac{\operatorname{\mu}(h^{%
\prime}\!,\mathcal{S}){-}\operatorname{\mu}(h{,}\mathcal{S}){+}\ln\tfrac{8%
\sqrt{m}}{\delta^{2}}}{m}\,\right]\!,
\overline{\operatorname{kl}}[q|\tau]{=}\max\{p\!\in\!(0,1)\;|\;\operatorname{%
kl}(q\|p){\leq}\tau\}
\operatorname{\mu}
\operatorname{\mu}(h\!,\mathcal{S})\!=\!m\text{R}^{\ell}_{\mathcal{S}}(h)
\text{R}^{\ell}_{\mathcal{S}}(h^{\prime})
h^{\prime}
\mathcal{H}
\Phi_{\operatorname{\mu}}^{h^{\prime}}(h{,}\mathcal{S}{,}\delta)\!=\![(\text{R%
}^{\ell}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell}_{\mathcal{S}}(h)){+}\frac%
{1}{m}\ln({2\sqrt{m}}/{\delta})]_{+}
m
\operatorname{\mu}
\rho_{\mathcal{S}}
h
\text{R}^{\ell}_{\mathcal{S}}(h)
\Phi_{\operatorname{\mu}}^{h^{\prime}}(h,\mathcal{S},\delta)
h^{\prime}\!\sim\!\pi
\rho_{\mathcal{S}}
\pi
\displaystyle\pi(h)\propto\exp\left[-\omega(h)\right],
\displaystyle\pi(h)\propto\exp\left[-\omega(h)\right],
\omega\!:\!\mathcal{H}{\to}\mathbb{R}
\mathcal{D}
\mathcal{S}^{\prime}\!\in\!(\mathcal{X}{\times}\mathcal{Y})^{m^{\prime}}
\mathcal{D}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\omega\!:\!\mathcal{H}{\to}\mathbb{R}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h^{\prime}{\sim}\pi
h{\sim}\rho_{\mathcal{S}}
\displaystyle\operatorname{kl}\!\left[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{%
R}^{\ell}_{\mathcal{D}}(h)\right]\leq\frac{1}{m}\Big{[}[\operatorname{\mu}(h^{%
\prime}\!,\mathcal{S}){-}\omega(h^{\prime})]
\displaystyle\operatorname{kl}\!\left[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{%
R}^{\ell}_{\mathcal{D}}(h)\right]\leq
\displaystyle\frac{1}{m}\Big{[}[\operatorname{\mu}(h^{\prime}\!,\mathcal{S}){-%
}\omega(h^{\prime})]
\displaystyle-[\operatorname{\mu}(h{,}\mathcal{S}){-}\omega(h)]+\ln\tfrac{8%
\sqrt{m}}{\delta^{2}}\Big{]},
\displaystyle-[\operatorname{\mu}(h{,}\mathcal{S}){-}\omega(h)]+\ln\tfrac{8%
\sqrt{m}}{\delta^{2}}\Big{]},
\rho_{\mathcal{S}}
\pi
\operatorname{\mu}(h,\mathcal{S})\!=\!\alpha\text{R}^{\ell^{\prime}}_{\mathcal%
{S}}(h)
\ell^{\prime}
\mu
\ell(h,(\mathbf{x},y))\!=\!\operatorname{I}[h(\mathbf{x})\neq y]
\operatorname{I}[a]\!=\!1
a
0
4
10
5{\times}5
1
2
8{\times}8
-1/\sqrt{250}
+1/\sqrt{250}
[-1/5,+1/5]
\mathcal{T}
\text{R}_{\mathcal{T}}(h)
h\!\sim\!\rho_{\mathcal{S}}
\mathcal{S}
h\!\sim\!\rho_{\mathcal{S}}
h^{\prime}\!\sim\!\pi
2
\mathcal{S}
\mathcal{S}^{\prime}
m
m^{\prime}
\frac{m^{\prime}}{m+m^{\prime}}{=}0
h\!\sim\!\rho_{\mathcal{S}}
h^{\prime}\!\sim\!\pi
\overline{\operatorname{kl}}
0.1
0.1
10^{-10}
0.1
10
64
0.5
\ell^{\prime}(h,(\mathbf{x},y)){=}-\frac{1}{4}\ln(e^{-4}{+}(1{-}2e^{-4})h(%
\mathbf{x})[y])
h[y]
y
h
\ell(h,(\mathbf{x},y))\in[0,1]
\rho_{\mathcal{S}}
\pi
\rho_{\mathcal{S}}
\mu(h,\mathcal{S})\!=\!\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)
1{-}\delta
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\!\leq\!{\textstyle\frac{1}{m}\!\!\left[\frac{\alpha^{2%
}}{8m}{+}\sqrt{\!\frac{\alpha^{2}}{2m}\!\ln\!\frac{6\sqrt{m}}{\delta}}{+}\ln\!%
\frac{6\sqrt{m}}{\delta}\right]}.
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\!\leq\!{\textstyle\frac{1}{m}\!\!\left[\frac{\alpha^{2%
}}{8m}{+}\sqrt{\!\frac{\alpha^{2}}{2m}\!\ln\!\frac{6\sqrt{m}}{\delta}}{+}\ln\!%
\frac{6\sqrt{m}}{\delta}\right]}.
1{-}\delta
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\Big{[}\alpha\!\left[\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)\right]
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\Big{[}\alpha\!\left[\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)\right]
\displaystyle+\alpha^{\prime}\Big{[}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){%
-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\Big{]}+2\alpha^{\prime}+%
\ln\!\tfrac{8\sqrt{m}}{\delta^{2}}\Big{]},
\displaystyle+\alpha^{\prime}\Big{[}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){%
-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\Big{]}+2\alpha^{\prime}+%
\ln\!\tfrac{8\sqrt{m}}{\delta^{2}}\Big{]},
h^{\prime}\!\sim\!\pi
\pi(h)\!\propto\!\exp[-\alpha^{\prime}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)]
\pi
\omega(h)\!=\!\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}^{\prime}}(h)
\mathcal{S}^{\prime}
\frac{m^{\prime}}{m\!+\!m^{\prime}}\!=\!0.5
\alpha
\alpha^{\prime}
\sqrt{m}
m
\alpha
5
\alpha
\alpha
\alpha
\text{R}^{\ell}_{\mathcal{T}}(h)
\alpha
\alpha
\alpha[\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\!-\!\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h)]
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})
h^{\prime}
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)
h
\rho_{\mathcal{S}}(h)\propto\exp[-\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}%
(h)]
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})
\alpha^{\prime}
h^{\prime}\!\sim\!\pi
h\!\sim\!\rho_{\mathcal{S}}
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})
\text{R}^{\ell^{\prime}}_{\mathcal{S}^{\prime}}(h)
\alpha
\frac{m^{\prime}}{m+m^{\prime}}{=}0.5
\alpha
h
L
\mathbf{w}\!\in\!\mathbb{R}^{d}
h_{\mathbf{w}^{2}}
h
\mathbf{w}^{2}
\mathbf{w}_{i}
i
\mathbf{v}\!\in\!\mathbb{R}^{d}
6
\mu
6
\text{\sc DistFro}^{\boldsymbol{R}}_{\beta}(h,\mathcal{S})={\footnotesize%
\alpha(\beta\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)+\bar{\beta}\text{\sc
DistFro%
}(h,\mathcal{S}))},
\text{\sc DistL${}_{2}$}^{\boldsymbol{R}}_{\beta}(h,\mathcal{S})={%
\footnotesize\alpha(\beta\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)+\bar{\beta}%
\text{\sc DistL${}_{2}$}(h,\mathcal{S}))},
\text{\sc ParNorm}^{\boldsymbol{R}}_{\beta}(h,\mathcal{S})={\footnotesize%
\alpha(\beta\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)+\bar{\beta}\text{\sc
ParNorm%
}(h,\mathcal{S}))},
\text{\sc PathNorm}^{\boldsymbol{R}}_{\beta}(h,\mathcal{S})={\footnotesize%
\alpha(\beta\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){+}\bar{\beta}\text{\sc
PathNorm%
}(h,\mathcal{S}))},
\text{\sc SumFro}^{\boldsymbol{R}}_{\beta}(h,\mathcal{S})={\footnotesize\alpha%
(\beta\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)+\bar{\beta}\text{\sc SumFro}(h%
,\mathcal{S}))},
\text{\sc Gap}^{\boldsymbol{R}}_{\beta}(h,\mathcal{S})={\footnotesize\alpha(%
\beta\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)+\bar{\beta}\text{\sc Gap}(h,%
\mathcal{S}))}
\bar{\beta}=1-\beta
\text{\sc DistFro}(h,\mathcal{S})=\sum_{i=1}^{L}\|\mathbf{w}_{i}{-}\mathbf{v}_%
{i}\|_{2},
\text{\sc DistL${}_{2}$}(h,\mathcal{S})={\footnotesize\|\mathbf{w}{-}\mathbf{v%
}\|_{2}},
\text{\sc ParNorm}(h,\mathcal{S})={\footnotesize\sum_{i=1}^{L}\|\mathbf{w}_{i}%
\|_{2}^{2}},
\text{\sc PathNorm}(h,\mathcal{S})={\footnotesize\sum_{y\in\mathcal{Y}}h_{%
\mathbf{w}^{2}}(\mathbf{1})[y]},
\text{\sc SumFro}(h,\mathcal{S})={\footnotesize L{[\prod_{i=1}^{L}\|\mathbf{w}%
_{i}\|_{2}^{2}]^{\frac{1}{L}}}},
\text{\sc Gap}(h,\mathcal{S})={\footnotesize|\text{R}^{\ell^{\prime}}_{%
\mathcal{T}}(h){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)|}
\mathcal{S}
\mathcal{T}
64
\frac{m^{\prime}}{m+m^{\prime}}\!=\!0.5
\frac{m^{\prime}}{m+m^{\prime}}\!=\!0.0
\omega
\pi
\omega(h_{\mathbf{w}})\!=\!\operatorname{\mu}(h_{\mathbf{w}},\mathcal{S}^{%
\prime})
\rho_{\mathcal{S}}
\text{R}_{\mathcal{T}}(h)
\beta
\beta\!=\!0.3
\frac{m^{\prime}}{m+m^{\prime}}
\frac{m^{\prime}}{m+m^{\prime}}\!=\!0.0
\beta\!\geq\!0.7
\frac{m^{\prime}}{m+m^{\prime}}\!=\!0.5
\beta\!\geq\!0.7
\rho_{\mathcal{S}}
\rho_{\mathcal{S}}
\mu
\displaystyle\mu(h,\mathcal{S})=f^{\boldsymbol{D}}(h,\mathcal{S})=\alpha|f(h,%
\mathcal{S})-f(h_{\text{SGD}},\mathcal{S})|,
\displaystyle\mu(h,\mathcal{S})=f^{\boldsymbol{D}}(h,\mathcal{S})=\alpha|f(h,%
\mathcal{S})-f(h_{\text{SGD}},\mathcal{S})|,
f\!\in\!\{\text{\sc DistFro},\text{\sc DistL${}_{2}$},\text{\sc ParNorm},\text%
{\sc PathNorm},
\text{\sc SumFro},\text{\sc Gap}\}
\alpha\!=\!m
h_{\text{SGD}}
\mu
f
h_{\text{SGD}}
\text{\sc Neural}^{\boldsymbol{D}}\!
\text{\sc Neural}(h,\mathcal{S})
\mathcal{S}
\mathbf{w}
h
\text{\sc Neural}^{\boldsymbol{D}}
h\sim\rho_{\mathcal{S}}
h_{\text{SGD}}
1
10
h\!\sim\!\rho_{\mathcal{S}}
h_{\text{SGD}}
10
10^{-10}
\alpha\!=\!m
\boldsymbol{D}
\operatorname{\mu}(h,\mathcal{S})
h
h_{\text{SGD}}
\text{\sc Gap}^{\boldsymbol{D}}
\text{\sc Neural}^{\boldsymbol{D}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\alpha
\text{R}^{\ell}_{\mathcal{T}}(h)
\alpha
\text{R}^{\ell}_{\mathcal{T}}(h)
\beta
\alpha=m
\text{R}^{\ell}_{\mathcal{T}}(h)
\beta
\alpha=m
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\text{\sc Neural}^{\boldsymbol{D}}
\text{\sc Gap}^{\boldsymbol{D}}
1
\text{\sc DistFro}^{\boldsymbol{D}}
\text{\sc DistL${}_{2}$}^{\boldsymbol{D}}
\text{\sc ParNorm}^{\boldsymbol{D}}
\text{\sc PathNorm}^{\boldsymbol{D}}
\text{\sc SumFro}^{\boldsymbol{D}}
h_{\text{SGD}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\text{R}^{\ell}_{\mathcal{T}}(h_{\text{SGD}})
h
h^{\prime}
\text{\sc Neural}^{\boldsymbol{D}}
\text{\sc Gap}^{\boldsymbol{D}}
h_{\text{SGD}}
0
h_{\text{SGD}}
\text{\sc Neural}^{\boldsymbol{D}}
Z=\int_{\mathcal{H}}\exp\left[-\operatorname{\mu}(g,\mathcal{S})\right]d%
\lambda(g)
\rho_{\mathcal{S}}
\lambda
\mathcal{H}
\displaystyle\rho_{\mathcal{S}}(h)=\frac{1}{Z}\exp\left[-\operatorname{\mu}(h,%
\mathcal{S})\right]\propto\exp\left[-\operatorname{\mu}(h,\mathcal{S})\right].
\displaystyle\rho_{\mathcal{S}}(h)=\frac{1}{Z}\exp\left[-\operatorname{\mu}(h,%
\mathcal{S})\right]\propto\exp\left[-\operatorname{\mu}(h,\mathcal{S})\right].
\frac{\delta}{2}
\delta
\varphi(h,\mathcal{S})=\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{%
\mathcal{S}}(h))
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\left[\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}%
_{\mathcal{S}}(h))\leq\ln\!\left[\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\right]\!%
+\!\ln\!\left[\frac{2}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{\phi(\text{R}^{\ell}_{%
\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))}\right]\right]\geq 1-\frac{%
\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\left[\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}%
_{\mathcal{S}}(h))\leq\ln\!\left[\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\right]\!%
+\!\ln\!\left[\frac{2}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{\phi(\text{R}^{\ell}_{%
\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))}\right]\right]\geq 1-\frac{%
\delta}{2}.
\ln\!\left[\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\right]
\displaystyle\ln\!\left[\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\right]=\ln\left(%
\frac{\exp\left[-\operatorname{\mu}(h,\mathcal{S})\right]}{Z}\frac{1}{\pi(h)}\right)
\displaystyle\ln\!\left[\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\right]
\displaystyle=\ln\left(\frac{\exp\left[-\operatorname{\mu}(h,\mathcal{S})%
\right]}{Z}\frac{1}{\pi(h)}\right)
\displaystyle=\ln\left(\exp\left[-\operatorname{\mu}(h,\mathcal{S})\right]%
\right)-\ln\left(\pi(h)\int_{\mathcal{H}}\!\exp\left[-\operatorname{\mu}(g,%
\mathcal{S})\right]d\lambda(g)\right)
\displaystyle=\ln\left(\exp\left[-\operatorname{\mu}(h,\mathcal{S})\right]%
\right)-\ln\left(\pi(h)\int_{\mathcal{H}}\!\exp\left[-\operatorname{\mu}(g,%
\mathcal{S})\right]d\lambda(g)\right)
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\left(\pi(h)\int_{\mathcal%
{H}}\frac{\pi(g)}{\pi(g)}\exp\left[-\operatorname{\mu}(g,\mathcal{S})\right]d%
\lambda(g)\right)
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\left(\pi(h)\int_{\mathcal%
{H}}\frac{\pi(g)}{\pi(g)}\exp\left[-\operatorname{\mu}(g,\mathcal{S})\right]d%
\lambda(g)\right)
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\left(\operatorname*{%
\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S%
})}\right).
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\left(\operatorname*{%
\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S%
})}\right).
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{%
\ell}_{\mathcal{S}}(h))\leq\ln\!\left[\frac{2}{\delta}\operatorname*{\mathbb{E%
}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))}\right%
]-\operatorname{\mu}(h,\mathcal{S})-\ln\left({\textstyle\operatorname*{\mathbb%
{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\Bigg{]}\geq 1-\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{%
\ell}_{\mathcal{S}}(h))\leq\ln\!\left[\frac{2}{\delta}\operatorname*{\mathbb{E%
}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))}\right%
]-\operatorname{\mu}(h,\mathcal{S})-\ln\left({\textstyle\operatorname*{\mathbb%
{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\Bigg{]}\geq 1-\frac{\delta}{2}.
-\ln\left({\textstyle\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)%
}}e^{-\operatorname{\mu}(g,\mathcal{S})}\right)
\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}>0
h\in\mathcal{H}
h^{\prime}\in\mathcal{H}
\mathcal{S}\in(\mathcal{X}{\times}\mathcal{Y})^{m}
\displaystyle\forall h\in\mathcal{H},\quad\forall\mathcal{S}\in(\mathcal{X}{%
\times}\mathcal{Y})^{m},\quad\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}%
\Bigg{[}\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},%
\mathcal{S})}\leq\frac{2}{\delta}\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{%
\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\Bigg{]}\geq 1-\frac{%
\delta}{2}
\displaystyle\forall h\in\mathcal{H},\quad\forall\mathcal{S}\in(\mathcal{X}{%
\times}\mathcal{Y})^{m},\quad\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}%
\Bigg{[}\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},%
\mathcal{S})}\leq\frac{2}{\delta}\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{%
\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\Bigg{]}\geq 1-\frac{%
\delta}{2}
\displaystyle\iff\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}\Bigg{[}-\ln%
\left(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-%
\operatorname{\mu}(g,\mathcal{S})}\right)\leq\ln\frac{2}{\delta}-\ln\left(%
\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}%
\right)\Bigg{]}\geq 1-\frac{\delta}{2}.
\displaystyle\iff\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}\Bigg{[}-\ln%
\left(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-%
\operatorname{\mu}(g,\mathcal{S})}\right)\leq\ln\frac{2}{\delta}-\ln\left(%
\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}%
\right)\Bigg{]}\geq 1-\frac{\delta}{2}.
\displaystyle-\ln\left(\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^%
{\prime}\!,\mathcal{S})}\right)=\ln\frac{\pi(h^{\prime})}{\pi(h)}+%
\operatorname{\mu}(h^{\prime}\!,\mathcal{S}).
\displaystyle-\ln\left(\frac{\pi(h)}{\pi(h^{\prime})}e^{-\operatorname{\mu}(h^%
{\prime}\!,\mathcal{S})}\right)=\ln\frac{\pi(h^{\prime})}{\pi(h)}+%
\operatorname{\mu}(h^{\prime}\!,\mathcal{S}).
\displaystyle\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}\!\left[-\ln\!\left%
(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{%
\mu}(g,\mathcal{S})}\right)\!\leq\ln\frac{2}{\delta}{+}\ln\frac{\pi(h^{\prime}%
)}{\pi(h)}{+}\operatorname{\mu}(h^{\prime}\!,\mathcal{S})\right]\!\geq 1{-}%
\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}\!\left[-\ln\!\left%
(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{%
\mu}(g,\mathcal{S})}\right)\!\leq\ln\frac{2}{\delta}{+}\ln\frac{\pi(h^{\prime}%
)}{\pi(h)}{+}\operatorname{\mu}(h^{\prime}\!,\mathcal{S})\right]\!\geq 1{-}%
\frac{\delta}{2}.
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\pi\in\mathcal{M}(\mathcal{H})
\mathcal{H}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h^{\prime}{\sim}\pi
h{\sim}\rho_{\mathcal{S}}
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\left[\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h%
)}+\ln\frac{8\sqrt{m}}{\delta^{2}}\right].
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]
\displaystyle\leq\frac{1}{m}\!\left[\operatorname{\mu}(h^{\prime}\!,\mathcal{S%
})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln%
\frac{8\sqrt{m}}{\delta^{2}}\right].
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h)){=}m%
\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{\ell}_{\mathcal{%
D}}(h)]
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\left[\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h%
)}+\ln\!\left[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{%
\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{m\operatorname{%
kl}[\text{R}^{\ell}_{\mathcal{S}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)]}\right%
]\right].
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]
\displaystyle\leq\frac{1}{m}\!\left[\operatorname{\mu}(h^{\prime}\!,\mathcal{S%
})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!%
\left[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{m\operatorname{kl}[%
\text{R}^{\ell}_{\mathcal{S}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)]}\right]%
\right].
\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}\!\operatorname*{%
\mathbb{E}}_{g\sim\pi}\!\exp\left(m\operatorname{kl}\left[\text{R}^{\ell}_{%
\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]\right)
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\operatorname{kl}\left[\text{R}^{\ell%
}_{\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}=\operatorname*{%
\mathbb{E}}_{g\sim\pi}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{%
m}}e^{m\operatorname{kl}\left[\text{R}^{\ell}_{\mathcal{V}}(g)\|\text{R}^{\ell%
}_{\mathcal{D}}(g)\right]}
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\operatorname{kl}\left[\text{R}^{\ell%
}_{\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}
\displaystyle=\operatorname*{\mathbb{E}}_{g\sim\pi}\operatorname*{\mathbb{E}}_%
{\mathcal{V}\sim\mathcal{D}^{m}}e^{m\operatorname{kl}\left[\text{R}^{\ell}_{%
\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}
\displaystyle\text{and}\quad\operatorname*{\mathbb{E}}_{g\sim\pi}\operatorname%
*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}e^{m\operatorname{kl}\left[\text%
{R}^{\ell}_{\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}\leq 2%
\sqrt{m},
\displaystyle\text{and}\quad\operatorname*{\mathbb{E}}_{g\sim\pi}\operatorname%
*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}e^{m\operatorname{kl}\left[\text%
{R}^{\ell}_{\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}
\displaystyle\leq 2\sqrt{m},
\pi
\ln\frac{\pi(h^{\prime})}{\pi(h)}=0
\pi(h)\propto\exp(-\omega(h))
\ln\frac{\pi(h^{\prime})}{\pi(h)}=\omega(h)-\omega(h^{\prime})
\operatorname{\mu}
\mu(h,\mathcal{S})=\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\pi\!\in\!\mathcal{M}(\mathcal{H})
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}_{1}{\sim}\mathcal{D}^{m},\dots,\mathcal{S}_{n}{\sim}\mathcal{D}^{m}
h_{1}{\sim}\rho_{\mathcal{S}_{1}},\dots h_{n}{\sim}\rho_{\mathcal{S}_{n}}
\epsilon{>}0
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Big{[}|\text{R}_{\mathcal{D}}(h)-\text{R}_{\mathcal{S}}(h)%
|\leq\operatorname{\mu}(h,\mathcal{S})+\epsilon\Big{]}\geq 1{-}\frac{1}{n}\sum%
_{i=1}^{n}\operatorname{I}\Big{[}|\text{R}_{\mathcal{D}}(h_{i}){-}\text{R}_{%
\mathcal{S}_{i}}(h_{i})|{-}\operatorname{\mu}(h_{i},\mathcal{S}_{i})>\epsilon%
\Big{]}{-}\sqrt{\frac{\ln\frac{2}{\delta}}{2n}}\triangleq 1{-}\delta^{\prime}(%
\epsilon),
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Big{[}|\text{R}_{\mathcal{D}}(h)-\text{R}_{\mathcal{S}}(h)%
|\leq\operatorname{\mu}(h,\mathcal{S})+\epsilon\Big{]}\geq 1{-}\frac{1}{n}\sum%
_{i=1}^{n}\operatorname{I}\Big{[}|\text{R}_{\mathcal{D}}(h_{i}){-}\text{R}_{%
\mathcal{S}_{i}}(h_{i})|{-}\operatorname{\mu}(h_{i},\mathcal{S}_{i})>\epsilon%
\Big{]}{-}\sqrt{\frac{\ln\frac{2}{\delta}}{2n}}\triangleq 1{-}\delta^{\prime}(%
\epsilon),
\operatorname{I}[a]=1
a
0
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Big{[}|\text{R}_{\mathcal{D}}(h)-\text{R}_{\mathcal{S}}(h)%
|\leq\operatorname{\mu}(h,\mathcal{S})+\epsilon\Big{]}=\operatorname*{\mathbb{%
P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim\rho_{\mathcal{S}}}\Big{[}|\text{R}_{%
\mathcal{D}}(h)-\text{R}_{\mathcal{S}}(h)|-\operatorname{\mu}(h,\mathcal{S})%
\leq\epsilon\Big{]}\triangleq F(\epsilon),
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\Big{[}|\text{R}_{\mathcal{D}}(h)-\text{R}_{\mathcal{S}}(h)%
|\leq\operatorname{\mu}(h,\mathcal{S})+\epsilon\Big{]}=\operatorname*{\mathbb{%
P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim\rho_{\mathcal{S}}}\Big{[}|\text{R}_{%
\mathcal{D}}(h)-\text{R}_{\mathcal{S}}(h)|-\operatorname{\mu}(h,\mathcal{S})%
\leq\epsilon\Big{]}\triangleq F(\epsilon),
F(\cdot)
|\text{R}_{\mathcal{D}}(h){-}\text{R}_{\mathcal{S}}(h)|{-}\operatorname{\mu}(h%
,\mathcal{S})
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
1-\delta
\mathcal{S}_{1}{\sim}\mathcal{D}^{m},\dots,\mathcal{S}_{n}{\sim}\mathcal{D}^{m}
h_{1}{\sim}\rho_{\mathcal{S}_{1}},\dots h_{n}{\sim}\rho_{\mathcal{S}_{n}}
\displaystyle F(\epsilon)\geq\frac{1}{n}\sum_{i=1}^{n}\operatorname{I}\Big{[}|%
\text{R}_{\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}%
\operatorname{\mu}(h_{i},\mathcal{S}_{i})\leq\epsilon\Big{]}-\sqrt{\frac{\ln%
\frac{2}{\delta}}{2n}}.
\displaystyle F(\epsilon)\geq\frac{1}{n}\sum_{i=1}^{n}\operatorname{I}\Big{[}|%
\text{R}_{\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}%
\operatorname{\mu}(h_{i},\mathcal{S}_{i})\leq\epsilon\Big{]}-\sqrt{\frac{\ln%
\frac{2}{\delta}}{2n}}.
\displaystyle\frac{1}{n}\sum_{i=1}^{n}\operatorname{I}\Big{[}|\text{R}_{%
\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}\operatorname{\mu}(%
h_{i},\mathcal{S}_{i})\leq\epsilon\Big{]}=\frac{1}{n}\sum_{i=1}^{n}\Bigg{(}1-%
\operatorname{I}\Big{[}|\text{R}_{\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_%
{i}}(h_{i})|{-}\operatorname{\mu}(h_{i},\mathcal{S}_{i})>\epsilon\Big{]}\Bigg{)}
\displaystyle\frac{1}{n}\sum_{i=1}^{n}\operatorname{I}\Big{[}|\text{R}_{%
\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}\operatorname{\mu}(%
h_{i},\mathcal{S}_{i})\leq\epsilon\Big{]}
\displaystyle=\frac{1}{n}\sum_{i=1}^{n}\Bigg{(}1-\operatorname{I}\Big{[}|\text%
{R}_{\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}\operatorname{%
\mu}(h_{i},\mathcal{S}_{i})>\epsilon\Big{]}\Bigg{)}
\displaystyle=1-\frac{1}{n}\sum_{i=1}^{n}\operatorname{I}\Big{[}|\text{R}_{%
\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}\operatorname{\mu}(%
h_{i},\mathcal{S}_{i})>\epsilon\Big{]}.
\displaystyle=1-\frac{1}{n}\sum_{i=1}^{n}\operatorname{I}\Big{[}|\text{R}_{%
\mathcal{D}}(h_{i}){-}\text{R}_{\mathcal{S}_{i}}(h_{i})|{-}\operatorname{\mu}(%
h_{i},\mathcal{S}_{i})>\epsilon\Big{]}.
\text{R}_{\mathcal{D}}(h){-}\text{R}_{\mathcal{S}}(h){-}\operatorname{\mu}(h,%
\mathcal{S})
|\text{R}_{\mathcal{D}}(h){-}\text{R}_{\mathcal{S}}(h)|{-}\operatorname{\mu}(h%
,\mathcal{S})
\sqrt{\nicefrac{{\ln\frac{2}{\delta}}}{{2n}}}
\operatorname{\mu}(h,\mathcal{S}){+}\epsilon
1{-}\delta^{\prime}(\epsilon)
\text{R}_{\mathcal{D}}(h_{i})
\mathcal{D}
\delta^{\prime}(\epsilon)
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\pi\!\in\!\mathcal{M}(\mathcal{H})
\delta\!\in\!(0,1]
1-\delta
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\left[\ln\frac{\rho_{%
\mathcal{S}}(h)}{\pi(h)}+\ln\frac{1}{\delta}\right]\right)\right\}.
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\left[\ln\frac{\rho_{%
\mathcal{S}}(h)}{\pi(h)}+\ln\frac{1}{\delta}\right]\right)\right\}.
\varphi(h,\mathcal{S})=m\left[-\ln(1{-}\text{R}^{\ell}_{\mathcal{D}}(h)\left[1%
{-}e^{-c}\right])-c\text{R}^{\ell}_{\mathcal{S}}(h)\right]
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\left[\ln\frac{\rho_{%
\mathcal{S}}(h)}{\pi(h)}+\ln\left(\frac{1}{\delta}\operatorname*{\mathbb{E}}_{%
\mathcal{S}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\left[%
-\ln(1{-}\text{R}^{\ell}_{\mathcal{D}}(h)[1{-}e^{-c}])-c\text{R}^{\ell}_{%
\mathcal{S}}(h)\right]}\right)\right]\right)\right\}.
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\left[\ln\frac{\rho_{%
\mathcal{S}}(h)}{\pi(h)}+\ln\left(\frac{1}{\delta}\operatorname*{\mathbb{E}}_{%
\mathcal{S}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\left[%
-\ln(1{-}\text{R}^{\ell}_{\mathcal{D}}(h)[1{-}e^{-c}])-c\text{R}^{\ell}_{%
\mathcal{S}}(h)\right]}\right)\right]\right)\right\}.
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{S}\sim\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\left[-\ln(1{-}\text{R}^{\ell}_{%
\mathcal{D}}(h)[1{-}e^{-c}])-c\text{R}^{\ell}_{\mathcal{S}}(h)\right]}\leq 1.
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{S}\sim\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\left[-\ln(1{-}\text{R}^{\ell}_{%
\mathcal{D}}(h)[1{-}e^{-c}])-c\text{R}^{\ell}_{\mathcal{S}}(h)\right]}\leq 1.
c>0
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\operatorname{\mu}(h,\mathcal{S})=cm\text{R}^{\ell}_{\mathcal{S}}(h)-\ln\pi(h)
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\pi\in\mathcal{M}(\mathcal{H})
\mathcal{H}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h{\sim}\rho_{\mathcal{S}}
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\left[-\operatorname{%
\mu}(h,\mathcal{S})-\ln\pi(h)-\ln\left(\operatorname*{\mathbb{E}}_{g\sim\pi}%
\frac{1}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\right)+\ln\frac{1}{%
\delta}\right]\right)\right\},
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\left[-\operatorname{%
\mu}(h,\mathcal{S})-\ln\pi(h)-\ln\left(\operatorname*{\mathbb{E}}_{g\sim\pi}%
\frac{1}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\right)+\ln\frac{1}{%
\delta}\right]\right)\right\},
\rho_{\mathcal{S}}
\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\displaystyle\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}=-\operatorname{\mu}(h,%
\mathcal{S})-\ln\left(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g%
)}e^{-\operatorname{\mu}(g,\mathcal{S})}\right)
\displaystyle\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\left(\operatorname*{%
\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S%
})}\right)
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\pi(h)-\ln\left(%
\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{1}{\pi(g)}e^{-\operatorname{\mu}(g,%
\mathcal{S})}\right),
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\pi(h)-\ln\left(%
\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{1}{\pi(g)}e^{-\operatorname{\mu}(g,%
\mathcal{S})}\right),
\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{1}{\pi(g)}\exp[-\operatorname{\mu}(%
g,\mathcal{S})]
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\pi\in\mathcal{M}(\mathcal{H})
\mathcal{H}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h^{\prime}{\sim}\pi
h{\sim}\rho_{\mathcal{S}}
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\!\left[\operatorname{%
\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(%
h^{\prime})}{\pi(h)}+\ln\frac{4}{\delta^{2}}\right]\right)\right\},
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1-e^{-c}}\left\{1-%
\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\!\left[\operatorname{%
\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(%
h^{\prime})}{\pi(h)}+\ln\frac{4}{\delta^{2}}\right]\right)\right\},
\rho_{\mathcal{S}}
\delta/2
\delta
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\left[\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1{-}e^{-%
c}}\left\{1{-}\exp\left(\!-c\text{R}^{\ell}_{\mathcal{S}}(h){-}\frac{1}{m}%
\left[-\!\operatorname{\mu}(h,\mathcal{S}){-}\ln\left(\operatorname*{\mathbb{E%
}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\right%
){+}\ln\frac{2}{\delta}\right]\right)\right\}\right]\!\geq 1{-}\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\left[\text{R}^{\ell}_{\mathcal{D}}(h)\leq\frac{1}{1{-}e^{-%
c}}\left\{1{-}\exp\left(\!-c\text{R}^{\ell}_{\mathcal{S}}(h){-}\frac{1}{m}%
\left[-\!\operatorname{\mu}(h,\mathcal{S}){-}\ln\left(\operatorname*{\mathbb{E%
}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\right%
){+}\ln\frac{2}{\delta}\right]\right)\right\}\right]\!\geq 1{-}\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}\!\left[-\ln\!\left%
(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{%
\mu}(g,\mathcal{S})}\right)\!\leq\ln\frac{2}{\delta}{+}\ln\frac{\pi(h^{\prime}%
)}{\pi(h)}{+}\operatorname{\mu}(h^{\prime}\!,\mathcal{S})\right]\!\geq 1{-}%
\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi}\!\left[-\ln\!\left%
(\operatorname*{\mathbb{E}}_{g\sim\pi}\frac{\pi(h)}{\pi(g)}e^{-\operatorname{%
\mu}(g,\mathcal{S})}\right)\!\leq\ln\frac{2}{\delta}{+}\ln\frac{\pi(h^{\prime}%
)}{\pi(h)}{+}\operatorname{\mu}(h^{\prime}\!,\mathcal{S})\right]\!\geq 1{-}%
\frac{\delta}{2}.
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\pi\in\mathcal{M}(\mathcal{H})
\mathcal{H}
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h^{\prime}{\sim}\pi
h{\sim}\rho_{\mathcal{S}}
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)\leq\inf_{c>0}\left\{\frac{1}{1-e%
^{-c}}\left\{1-\exp\left(-c\text{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\!\left%
[\operatorname{\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{\mu}(h,\mathcal{S}%
)+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\frac{8\sqrt{m}}{\delta^{2}}\right]%
\right)\right\}\right\}
\displaystyle\text{R}^{\ell}_{\mathcal{D}}(h)
\displaystyle\leq\inf_{c>0}\left\{\frac{1}{1-e^{-c}}\left\{1-\exp\left(-c\text%
{R}^{\ell}_{\mathcal{S}}(h)-\frac{1}{m}\!\left[\operatorname{\mu}(h^{\prime}\!%
,\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(%
h)}+\ln\frac{8\sqrt{m}}{\delta^{2}}\right]\right)\right\}\right\}
\displaystyle=\underbrace{\overline{\operatorname{kl}}\left[\text{R}^{\ell}_{%
\mathcal{S}}(h)\;\middle|\;\frac{1}{m}\!\left(\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h%
)}+\ln\frac{8\sqrt{m}}{\delta^{2}}\right)\,\right]}_{\text{Bound of \lx@cref{%
creftypecap~refnum}{corollary:disintegrated-comp}}},
\displaystyle=\underbrace{\overline{\operatorname{kl}}\left[\text{R}^{\ell}_{%
\mathcal{S}}(h)\;\middle|\;\frac{1}{m}\!\left(\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h%
)}+\ln\frac{8\sqrt{m}}{\delta^{2}}\right)\,\right]}_{\text{Bound of \lx@cref{%
creftypecap~refnum}{corollary:disintegrated-comp}}},
\rho_{\mathcal{S}}
\mathcal{L}_{\mathcal{D}}(G_{\theta})
\mathcal{L}_{\mathcal{S}}(G_{\theta})
\text{R}^{\ell}_{\mathcal{D}}(h)
\text{R}^{\ell}_{\mathcal{S}}(h)
\xi
\xi\triangleq\frac{1}{m}\!\left(\operatorname{\mu}(h^{\prime}\!,\mathcal{S})-%
\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\frac{8%
\sqrt{m}}{\delta^{2}}\right)
c>0
\frac{\ln(2\sqrt{m})}{m}
m
c>0
c
\frac{\ln(2\sqrt{m})}{m}
m
\operatorname{\mu}(h,\mathcal{S})\!=\!\alpha\text{R}^{\ell^{\prime}}_{\mathcal%
{S}}(h)
\operatorname{kl}[\operatorname*{\mathbb{E}}_{h\sim\rho_{\mathcal{S}}}\text{R}%
^{\ell}_{\mathcal{S}}(h)\|\operatorname*{\mathbb{E}}_{h\sim\rho_{\mathcal{S}}}%
\text{R}^{\ell}_{\mathcal{D}}(h)]
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\ell^{\prime}:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h{\sim}\rho_{\mathcal{S}}
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\!\left[\frac{\alpha^{2}}{8m}{+}\sqrt{%
\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}{+}\ln\frac{6\sqrt{m}}{\delta%
}\right],
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\!\left[\frac{\alpha^{2}}{8m}{+}\sqrt{%
\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}{+}\ln\frac{6\sqrt{m}}{\delta%
}\right],
\rho_{\mathcal{S}}
\pi
\rho_{\mathcal{S}}(h)\propto e^{-\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}(%
h)}
\pi(h)\propto e^{-\alpha\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)}
\operatorname{\mu}
\alpha\in\mathbb{R}
m
\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\rho_{\mathcal{S}}
\pi
\rho_{\mathcal{S}}(h)\propto e^{-\operatorname{\mu}(h,\mathcal{S})}
\pi(h)\propto e^{-\omega(h)}
\displaystyle\forall h\in\mathcal{H},\quad\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)%
}{\pi(h)}\leq\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\operatorname{\mu}(h^{%
\prime},\mathcal{S})-\omega(h^{\prime})\right]_{+},
\displaystyle\forall h\in\mathcal{H},\quad\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)%
}{\pi(h)}\leq\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\operatorname{\mu}(h^{%
\prime},\mathcal{S})-\omega(h^{\prime})\right]_{+},
[\cdot]_{+}\triangleq\max(\cdot,0)
\ln_{+}(\cdot)\triangleq[\ln(\cdot)]_{+}
Z_{\rho_{\mathcal{S}}}=\int_{\mathcal{H}}\exp\left[-\operatorname{\mu}(g,%
\mathcal{S})\right]d\lambda(g)
Z_{\pi}=\int_{\mathcal{H}}\exp\left[-\omega(g)\right]d\lambda(g)
\rho_{\mathcal{S}}
\pi
\lambda
\mathcal{H}
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}=\ln_{+}\!\frac{Z_{%
\pi}e^{-\operatorname{\mu}(h,\mathcal{S})}}{Z_{\rho_{\mathcal{S}}}e^{-\omega(h%
)}}
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\displaystyle=\ln_{+}\!\frac{Z_{\pi}e^{-\operatorname{\mu}(h,\mathcal{S})}}{Z_%
{\rho_{\mathcal{S}}}e^{-\omega(h)}}
\displaystyle\leq\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\ln_{+}\frac{Z_{\pi}}{Z_{\rho_{\mathcal{S}}}}
\displaystyle\leq\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\ln_{+}\frac{Z_{\pi}}{Z_{\rho_{\mathcal{S}}}}
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(\ln\frac{Z_{\pi}}{Z_{\rho_{\mathcal{S}}}},0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(\ln\frac{Z_{\pi}}{Z_{\rho_{\mathcal{S}}}},0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\frac{1}{Z_{\pi}}\int_{\mathcal{H}}e^{-\operatorname{\mu}(%
g,\mathcal{S})}d\lambda(g)\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\frac{1}{Z_{\pi}}\int_{\mathcal{H}}e^{-\operatorname{\mu}(%
g,\mathcal{S})}d\lambda(g)\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\frac{1}{Z_{\pi}}\int_{\mathcal{H}}e^{\omega(g)}e^{-\omega%
(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}d\lambda(g)\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\frac{1}{Z_{\pi}}\int_{\mathcal{H}}e^{\omega(g)}e^{-\omega%
(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}d\lambda(g)\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\int_{\mathcal{H}}\pi(g)e^{\omega(g)-\operatorname{\mu}(g,%
\mathcal{S})}d\lambda(g)\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\int_{\mathcal{H}}\pi(g)e^{\omega(g)-\operatorname{\mu}(g,%
\mathcal{S})}d\lambda(g)\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}e^{\omega(h^%
{\prime})-\operatorname{\mu}(h^{\prime},\mathcal{S})}\right),0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\ln\left(\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}e^{\omega(h^%
{\prime})-\operatorname{\mu}(h^{\prime},\mathcal{S})}\right),0\right)
\displaystyle\leq\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\left[\omega(h^{%
\prime})-\operatorname{\mu}(h^{\prime},\mathcal{S})\right],0\right)
\displaystyle\leq\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\max\left(-\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\left[\omega(h^{%
\prime})-\operatorname{\mu}(h^{\prime},\mathcal{S})\right],0\right)
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\operatorname{\mu}(h^{%
\prime},\mathcal{S})-\omega(h^{\prime})\right]_{+},
\displaystyle=\left[\omega(h)-\operatorname{\mu}(h,\mathcal{S})\right]_{+}+%
\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\operatorname{\mu}(h^{%
\prime},\mathcal{S})-\omega(h^{\prime})\right]_{+},
[a{+}b]_{+}\leq[a]_{+}{+}[b]_{+}
[\cdot]_{+}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})\to[0,1]
\pi\in\mathcal{M}(\mathcal{H})
\mathcal{H}
\delta\!\in\!(0,1]
1{-}\delta
\mathcal{S}{\sim}\mathcal{D}^{m}
h{\sim}\rho_{\mathcal{S}}
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\left[\ln_{+}\!\frac{\rho_{\mathcal{S}%
}(h)}{\pi(h)}+\ln\frac{2\sqrt{m}}{\delta}\right],
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\left[\ln_{+}\!\frac{\rho_{\mathcal{S}%
}(h)}{\pi(h)}+\ln\frac{2\sqrt{m}}{\delta}\right],
\displaystyle\text{and}\left|\text{R}^{\ell}_{\mathcal{S}}(h)-\text{R}^{\ell}_%
{\mathcal{D}}(h)\right|\leq\sqrt{\frac{1}{2m}\!\left[\ln_{+}\!\frac{\rho_{%
\mathcal{S}}(h)}{\pi(h)}+\ln\frac{2\sqrt{m}}{\delta}\right]},
\displaystyle\left|\text{R}^{\ell}_{\mathcal{S}}(h)-\text{R}^{\ell}_{\mathcal{%
D}}(h)\right|\leq\sqrt{\frac{1}{2m}\!\left[\ln_{+}\!\frac{\rho_{\mathcal{S}}(h%
)}{\pi(h)}+\ln\frac{2\sqrt{m}}{\delta}\right]},
\rho_{\mathcal{S}}\in\mathcal{M}(\mathcal{H})
\varphi(h,\mathcal{S})=m\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|%
\text{R}^{\ell}_{\mathcal{D}}(h)]
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\left[\ln\frac{\rho_{\mathcal{S}}(h)}{%
\pi(h)}+\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{%
\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{m\operatorname{%
kl}[\text{R}^{\ell}_{\mathcal{S}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)]}\right%
]\right].
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]
\displaystyle\leq\frac{1}{m}\!\left[\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+%
\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{m\operatorname{kl}[%
\text{R}^{\ell}_{\mathcal{S}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)]}\right]%
\right].
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\operatorname{kl}\left[\text{R}^{\ell%
}_{\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}=\operatorname*{%
\mathbb{E}}_{g\sim\pi}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{%
m}}e^{m\operatorname{kl}\left[\text{R}^{\ell}_{\mathcal{V}}(g)\|\text{R}^{\ell%
}_{\mathcal{D}}(g)\right]}\leq 2\sqrt{m}.
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{g\sim\pi}e^{m\operatorname{kl}\left[\text{R}^{\ell%
}_{\mathcal{V}}(g)\|\text{R}^{\ell}_{\mathcal{D}}(g)\right]}=\operatorname*{%
\mathbb{E}}_{g\sim\pi}\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{%
m}}e^{m\operatorname{kl}\left[\text{R}^{\ell}_{\mathcal{V}}(g)\|\text{R}^{\ell%
}_{\mathcal{D}}(g)\right]}\leq 2\sqrt{m}.
\ln_{+}(\cdot)
\ln\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\ln_{+}\frac{\rho_{\mathcal{S}}(h)}%
{\pi(h)}
2(\text{R}^{\ell}_{\mathcal{S}}(h)-\text{R}^{\ell}_{\mathcal{D}}(h))^{2}\leq%
\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{\ell}_{\mathcal{%
D}}(h)]
1-\delta/3
1-\delta
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\!\left[\ln_{+}\!\frac{\rho_{\mathcal{S}%
}(h)}{\pi(h)}+\ln\!\frac{6\sqrt{m}}{\delta}\right].
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]
\displaystyle\leq\frac{1}{m}\!\left[\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(%
h)}+\ln\!\frac{6\sqrt{m}}{\delta}\right].
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\alpha\left[%
\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)-\text{R}^{\ell^{\prime}}_{\mathcal{S%
}}(h)\right]_{+}+\alpha\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}%
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})-\text{R}^{\ell^{\prime}}_{%
\mathcal{D}}(h^{\prime})\right]_{+}.
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\alpha\left[%
\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)-\text{R}^{\ell^{\prime}}_{\mathcal{S%
}}(h)\right]_{+}+\alpha\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}%
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})-\text{R}^{\ell^{\prime}}_{%
\mathcal{D}}(h^{\prime})\right]_{+}.
1-\delta/3
\mathcal{S}\sim\mathcal{D}^{m}
\displaystyle\alpha\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\text{R%
}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})-\text{R}^{\ell^{\prime}}_{\mathcal%
{D}}(h^{\prime})\right]_{+}\leq\alpha\left|\operatorname*{\mathbb{E}}_{h^{%
\prime}\sim\pi}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})-\text{R}^{%
\ell^{\prime}}_{\mathcal{D}}(h^{\prime})\right|\leq\sqrt{\frac{\alpha^{2}}{2m}%
\ln\frac{6\sqrt{m}}{\delta}}.
\displaystyle\alpha\left[\operatorname*{\mathbb{E}}_{h^{\prime}\sim\pi}\text{R%
}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})-\text{R}^{\ell^{\prime}}_{\mathcal%
{D}}(h^{\prime})\right]_{+}\leq\alpha\left|\operatorname*{\mathbb{E}}_{h^{%
\prime}\sim\pi}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})-\text{R}^{%
\ell^{\prime}}_{\mathcal{D}}(h^{\prime})\right|\leq\sqrt{\frac{\alpha^{2}}{2m}%
\ln\frac{6\sqrt{m}}{\delta}}.
1-\delta/3
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\alpha\left[\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)-\text{R}^{%
\ell^{\prime}}_{\mathcal{S}}(h)\right]_{+}\leq\alpha\left|\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h)-\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)\right|\leq%
\sqrt{\frac{\alpha^{2}}{2m}\left[\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}%
+\ln\frac{6\sqrt{m}}{\delta}\right]}.
\displaystyle\alpha\left[\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)-\text{R}^{%
\ell^{\prime}}_{\mathcal{S}}(h)\right]_{+}\leq\alpha\left|\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h)-\text{R}^{\ell^{\prime}}_{\mathcal{D}}(h)\right|\leq%
\sqrt{\frac{\alpha^{2}}{2m}\left[\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}%
+\ln\frac{6\sqrt{m}}{\delta}\right]}.
1-2\delta/3
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\sqrt{\frac{%
\alpha^{2}}{2m}\left[\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6%
\sqrt{m}}{\delta}\right]}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{%
\delta}}
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\sqrt{\frac{%
\alpha^{2}}{2m}\left[\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6%
\sqrt{m}}{\delta}\right]}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{%
\delta}}
\displaystyle\iff\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt%
{m}}{\delta}-\ln\frac{6\sqrt{m}}{\delta}\leq\sqrt{\frac{\alpha^{2}}{2m}\left[%
\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt{m}}{\delta}%
\right]}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}
\displaystyle\iff
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt{m}}%
{\delta}-\ln\frac{6\sqrt{m}}{\delta}\leq\sqrt{\frac{\alpha^{2}}{2m}\left[\ln_{%
+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt{m}}{\delta}\right]}+%
\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}
\displaystyle\iff\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt%
{m}}{\delta}-\ln\frac{6\sqrt{m}}{\delta}-\sqrt{\frac{\alpha^{2}}{2m}\left[\ln_%
{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt{m}}{\delta}\right]}-%
\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}\leq 0.
\displaystyle\iff
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt{m}}%
{\delta}-\ln\frac{6\sqrt{m}}{\delta}-\sqrt{\frac{\alpha^{2}}{2m}\left[\ln_{+}%
\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6\sqrt{m}}{\delta}\right]}-%
\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}\leq 0.
\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}
\displaystyle ax^{2}+bx+c\leq 0\quad\text{such that}\quad x\in\mathbb{R}^{+}%
\quad\text{with}\quad a=1,\quad b=-\sqrt{\frac{\alpha^{2}}{2m}},\quad\text{and%
}\quad c=-\ln\frac{6\sqrt{m}}{\delta}-\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6%
\sqrt{m}}{\delta}}.
\displaystyle ax^{2}+bx+c\leq 0\quad\text{such that}\quad x\in\mathbb{R}^{+}%
\quad\text{with}\quad a=1,\quad b=-\sqrt{\frac{\alpha^{2}}{2m}},\quad\text{and%
}\quad c=-\ln\frac{6\sqrt{m}}{\delta}-\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6%
\sqrt{m}}{\delta}}.
\displaystyle x\in\left[0,\sqrt{\frac{\alpha^{2}}{8m}+\ln\frac{6\sqrt{m}}{%
\delta}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}}-\sqrt{\frac{%
\alpha^{2}}{8m}}\right].
\displaystyle x\in\left[0,\sqrt{\frac{\alpha^{2}}{8m}+\ln\frac{6\sqrt{m}}{%
\delta}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}}-\sqrt{\frac{%
\alpha^{2}}{8m}}\right].
\displaystyle\sqrt{\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6%
\sqrt{m}}{\delta}}\leq\sqrt{\frac{\alpha^{2}}{8m}+\ln\frac{6\sqrt{m}}{\delta}+%
\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}}-\sqrt{\frac{\alpha^{2%
}}{8m}}
\displaystyle\sqrt{\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}+\ln\frac{6%
\sqrt{m}}{\delta}}
\displaystyle\leq\sqrt{\frac{\alpha^{2}}{8m}+\ln\frac{6\sqrt{m}}{\delta}+\sqrt%
{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}}-\sqrt{\frac{\alpha^{2}}{8m}}
\displaystyle\leq\sqrt{\frac{\alpha^{2}}{8m}+\ln\frac{6\sqrt{m}}{\delta}+\sqrt%
{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}}
\displaystyle\leq\sqrt{\frac{\alpha^{2}}{8m}+\ln\frac{6\sqrt{m}}{\delta}+\sqrt%
{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}}
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\frac{\alpha^{2}%
}{8m}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}.
\displaystyle\ln_{+}\!\frac{\rho_{\mathcal{S}}(h)}{\pi(h)}\leq\frac{\alpha^{2}%
}{8m}+\sqrt{\frac{\alpha^{2}}{2m}\ln\frac{6\sqrt{m}}{\delta}}.
\operatorname{\mu}(h,\mathcal{S})\!=\!\alpha\text{R}^{\ell}_{\mathcal{S}}(h)
\epsilon
\epsilon
\pi
\epsilon
\mathcal{T}^{\prime}
\mathcal{T}
\displaystyle D_{\infty}(\pi_{\mathcal{T}^{\prime}}\|\pi_{\mathcal{T}})%
\triangleq\ln\left(\operatorname*{\text{\rm esssup}}_{h\sim\pi_{\mathcal{T}^{%
\prime}}}\frac{\pi_{\mathcal{T}^{\prime}}(h)}{\pi_{\mathcal{T}}(h)}\right)\leq\epsilon.
\displaystyle D_{\infty}(\pi_{\mathcal{T}^{\prime}}\|\pi_{\mathcal{T}})%
\triangleq\ln\left(\operatorname*{\text{\rm esssup}}_{h\sim\pi_{\mathcal{T}^{%
\prime}}}\frac{\pi_{\mathcal{T}^{\prime}}(h)}{\pi_{\mathcal{T}}(h)}\right)\leq\epsilon.
\pi
\epsilon
\mathcal{T}^{\prime}
\mathcal{T}
\epsilon
\mathcal{T}
\mathcal{T}^{\prime}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\epsilon
\pi
\varphi:\mathcal{H}\times(\mathcal{X}{\times}\mathcal{Y})^{m}\to\mathbb{R}
\delta\!\in\!(0,1]
1-\delta
\mathcal{S}^{\prime}\sim\mathcal{D}^{m}
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\varphi(h,\mathcal{S})\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{%
\mathcal{S}}(h)}+m\epsilon+\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E%
}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi_{%
\mathcal{S}^{\prime}}}e^{\varphi(g,\mathcal{V})}\right].
\displaystyle\varphi(h,\mathcal{S})\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{%
\mathcal{S}}(h)}+m\epsilon+\ln\!\left[\frac{1}{\delta}\operatorname*{\mathbb{E%
}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi_{%
\mathcal{S}^{\prime}}}e^{\varphi(g,\mathcal{V})}\right].
\pi_{\mathcal{S}^{\prime}}
\mathcal{S}^{\prime}
1-\delta
\mathcal{S}^{\prime}\sim\mathcal{D}^{m}
\mathcal{S}\sim\mathcal{D}^{m}
h\sim\rho_{\mathcal{S}}
\displaystyle\varphi(h,\mathcal{S})\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{%
\mathcal{S}^{\prime}}(h)}\!+\!\ln\!\left[\frac{1}{\delta}\operatorname*{%
\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim%
\pi_{\mathcal{S}^{\prime}}}e^{\varphi(g,\mathcal{V})}\right].
\displaystyle\varphi(h,\mathcal{S})\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{%
\mathcal{S}^{\prime}}(h)}\!+\!\ln\!\left[\frac{1}{\delta}\operatorname*{%
\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim%
\pi_{\mathcal{S}^{\prime}}}e^{\varphi(g,\mathcal{V})}\right].
\mathcal{S}^{(i)}
\mathcal{S}
1
i
\mathcal{S}^{\prime}
\mathcal{S}^{(0)}=\mathcal{S}
\mathcal{S}^{(m)}=\mathcal{S}^{\prime}
\displaystyle\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{\prime}}(h)}=%
\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{(m)}}(h)}
\displaystyle\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{\prime}}(h)}
\displaystyle=\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{(m)}}(h)}
\displaystyle\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{(m-1)}}(h)}+\epsilon
\displaystyle\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{(m-1)}}(h)}+\epsilon
\displaystyle\dotsb
\displaystyle\dotsb
\displaystyle\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{(0)}}(h)}+m\epsilon
\displaystyle\leq\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}^{(0)}}(h)}+m\epsilon
\displaystyle=\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h)}+m\epsilon.
\displaystyle=\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h)}+m\epsilon.
\pi
\epsilon
\mathcal{S}^{\prime}\sim\mathcal{D}^{m}
\mathcal{S}^{\prime}\sim\mathcal{D}^{m}
\operatorname{\mu}
\epsilon
\pi
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\epsilon
\pi
\operatorname{\mu}\!:\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}%
{\to}\mathbb{R}
\delta\!\in\!(0,1]
1-\delta
\mathcal{S}^{\prime}\sim\mathcal{D}^{m}
\mathcal{S}\sim\mathcal{D}^{m}
h^{\prime}\sim\pi_{\mathcal{S}}
h\sim\rho_{\mathcal{S}}
\displaystyle\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S%
}}(h))\leq\operatorname{\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{\mu}(h,%
\mathcal{S})+\ln\frac{\pi_{\mathcal{S}}(h^{\prime})}{\pi_{\mathcal{S}}(h)}+m%
\epsilon+\ln\!\left[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V%
}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi_{\mathcal{S}^{%
\prime}}}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}%
}(g))}\right],
\displaystyle\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S%
}}(h))
\displaystyle\leq\operatorname{\mu}(h^{\prime}\!,\mathcal{S})-\operatorname{%
\mu}(h,\mathcal{S})+\ln\frac{\pi_{\mathcal{S}}(h^{\prime})}{\pi_{\mathcal{S}}(%
h)}+m\epsilon+\ln\!\left[\frac{4}{\delta^{2}}\operatorname*{\mathbb{E}}_{%
\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi_{%
\mathcal{S}^{\prime}}}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}%
_{\mathcal{V}}(g))}\right],
\rho_{\mathcal{S}}
\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h)}
\displaystyle\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h)}=-%
\operatorname{\mu}(h,\mathcal{S})-\ln\left(\operatorname*{\mathbb{E}}_{g\sim%
\pi_{\mathcal{S}}}\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}e^{-%
\operatorname{\mu}(g,\mathcal{S})}\right).
\displaystyle\ln\frac{\rho_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h)}
\displaystyle=-\operatorname{\mu}(h,\mathcal{S})-\ln\left(\operatorname*{%
\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{%
S}}(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\right).
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\!\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{%
\ell}_{\mathcal{S}}(h))\leq\ln\!\left[\frac{2}{\delta}\operatorname*{\mathbb{E%
}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi_{%
\mathcal{S}^{\prime}}}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}%
_{\mathcal{V}}(g))}\right]\!{-}\operatorname{\mu}(h,\mathcal{S}){-}\ln\!\left(%
{\textstyle\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi_{%
\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\Bigg{]}\!\geq 1-\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim%
\rho_{\mathcal{S}}}\!\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{%
\ell}_{\mathcal{S}}(h))\leq\ln\!\left[\frac{2}{\delta}\operatorname*{\mathbb{E%
}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g\sim\pi_{%
\mathcal{S}^{\prime}}}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}%
_{\mathcal{V}}(g))}\right]\!{-}\operatorname{\mu}(h,\mathcal{S}){-}\ln\!\left(%
{\textstyle\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi_{%
\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\Bigg{]}\!\geq 1-\frac{\delta}{2}.
-\ln\left({\textstyle\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{%
\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}}e^{-\operatorname{\mu}(g,\mathcal{%
S})}\right)
\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h^{\prime})}e^{-\operatorname{%
\mu}(h^{\prime},\mathcal{S})}>0
\displaystyle\forall h\in\mathcal{H},\quad\forall\mathcal{S}\in(\mathcal{X}{%
\times}\mathcal{Y})^{m},\quad\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi_{%
\mathcal{S}}}\Bigg{[}\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h^{\prime})%
}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}\leq\frac{2}{\delta}%
\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi_{\mathcal{S}}(h)}%
{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\Bigg{]}\geq 1-\frac{\delta}{2}
\displaystyle\forall h\in\mathcal{H},\quad\forall\mathcal{S}\in(\mathcal{X}{%
\times}\mathcal{Y})^{m},\quad\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi_{%
\mathcal{S}}}\Bigg{[}\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h^{\prime})%
}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}\leq\frac{2}{\delta}%
\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi_{\mathcal{S}}(h)}%
{\pi(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}\Bigg{]}\geq 1-\frac{\delta}{2}
\displaystyle\iff\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi_{\mathcal{S}}}%
\Bigg{[}-\ln\left(\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi%
_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\leq\ln\frac{2}{\delta}-\ln\left(\frac{\pi_{\mathcal{S}}(h)}{\pi_{%
\mathcal{S}}(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}\right%
)\Bigg{]}\geq 1{-}\delta.
\displaystyle\iff\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi_{\mathcal{S}}}%
\Bigg{[}-\ln\left(\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi%
_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\leq\ln\frac{2}{\delta}-\ln\left(\frac{\pi_{\mathcal{S}}(h)}{\pi_{%
\mathcal{S}}(h^{\prime})}e^{-\operatorname{\mu}(h^{\prime},\mathcal{S})}\right%
)\Bigg{]}\geq 1{-}\delta.
\displaystyle-\ln\left(\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h^{\prime%
})}e^{-\operatorname{\mu}(h^{\prime}\!,\mathcal{S})}\right)=\ln\frac{\pi_{%
\mathcal{S}}(h^{\prime})}{\pi_{\mathcal{S}}(h)}+\operatorname{\mu}(h^{\prime}%
\!,\mathcal{S}).
\displaystyle-\ln\left(\frac{\pi_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(h^{\prime%
})}e^{-\operatorname{\mu}(h^{\prime}\!,\mathcal{S})}\right)
\displaystyle=\ln\frac{\pi_{\mathcal{S}}(h^{\prime})}{\pi_{\mathcal{S}}(h)}+%
\operatorname{\mu}(h^{\prime}\!,\mathcal{S}).
\displaystyle\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi_{\mathcal{S}}}\!%
\left[-\ln\!\left(\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi%
_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\!\leq\ln\frac{2}{\delta}+\ln\frac{\pi_{\mathcal{S}}(h^{\prime})}{\pi_{%
\mathcal{S}}(h)}+\operatorname{\mu}(h^{\prime}\!,\mathcal{S})\right]\!\geq 1{-%
}\frac{\delta}{2}.
\displaystyle\operatorname*{\mathbb{P}}_{h^{\prime}\sim\pi_{\mathcal{S}}}\!%
\left[-\ln\!\left(\operatorname*{\mathbb{E}}_{g\sim\pi_{\mathcal{S}}}\frac{\pi%
_{\mathcal{S}}(h)}{\pi_{\mathcal{S}}(g)}e^{-\operatorname{\mu}(g,\mathcal{S})}%
\right)\!\leq\ln\frac{2}{\delta}+\ln\frac{\pi_{\mathcal{S}}(h^{\prime})}{\pi_{%
\mathcal{S}}(h)}+\operatorname{\mu}(h^{\prime}\!,\mathcal{S})\right]\!\geq 1{-%
}\frac{\delta}{2}.
\mathcal{D}
\mathcal{X}{\times}\mathcal{Y}
\mathcal{H}
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\ell^{\prime}:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\alpha,\alpha^{\prime}\geq 0
\delta\in(0,1]
1-\delta
\mathcal{S}^{\prime}\sim\mathcal{D}^{m}
\mathcal{S}\sim\mathcal{D}^{m}
h^{\prime}\sim\pi_{\mathcal{S}}
h\sim\rho_{\mathcal{S}}
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\Big{[}\alpha\!\left[\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)%
\right]+\alpha^{\prime}\Big{[}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){-}%
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\Big{]}+2\alpha^{\prime}+\ln%
\!\tfrac{8\sqrt{m}}{\delta^{2}}\Big{]},
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\Big{[}\alpha\!\left[\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)%
\right]+\alpha^{\prime}\Big{[}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){-}%
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\Big{]}+2\alpha^{\prime}+\ln%
\!\tfrac{8\sqrt{m}}{\delta^{2}}\Big{]},
\rho_{\mathcal{S}}
\pi
\rho_{\mathcal{S}}(h)\propto e^{-\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}(%
h)}
\pi(h)\propto e^{-\alpha^{\prime}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)}
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))=m%
\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{\ell}_{\mathcal{%
D}}(h)]
\operatorname*{\mathbb{E}}_{\mathcal{V}\sim\mathcal{D}^{m}}\operatorname*{%
\mathbb{E}}_{g\sim\pi}\exp(m\operatorname{kl}[\text{R}^{\ell}_{\mathcal{V}}(g)%
\|\text{R}^{\ell}_{\mathcal{D}}(g)])\leq 2\sqrt{m}
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\left[\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi_{\mathcal{S}}(h^{%
\prime})}{\pi_{\mathcal{S}}(h)}+m\epsilon+\ln\!\frac{8\sqrt{m}}{\delta^{2}}%
\right].
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\left[\operatorname{\mu}(h^{\prime}\!,%
\mathcal{S})-\operatorname{\mu}(h,\mathcal{S})+\ln\frac{\pi_{\mathcal{S}}(h^{%
\prime})}{\pi_{\mathcal{S}}(h)}+m\epsilon+\ln\!\frac{8\sqrt{m}}{\delta^{2}}%
\right].
\rho_{\mathcal{S}}
\pi
\rho_{\mathcal{S}}\propto\exp(-\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h))
\operatorname{\mu}(h,\mathcal{S})=\alpha\text{R}^{\ell^{\prime}}_{\mathcal{S}}%
(h)
\pi_{\mathcal{S}}\propto\exp(-\alpha^{\prime}\text{R}^{\ell^{\prime}}_{%
\mathcal{S}}(h))
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\left[\alpha\!\left[\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)%
\right]+\alpha^{\prime}\!\left[\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){-}%
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\right]+m\epsilon+\ln\!\frac%
{8\sqrt{m}}{\delta^{2}}\right].
\displaystyle\operatorname{kl}[\text{R}^{\ell}_{\mathcal{S}}(h)\|\text{R}^{%
\ell}_{\mathcal{D}}(h)]\leq\frac{1}{m}\left[\alpha\!\left[\text{R}^{\ell^{%
\prime}}_{\mathcal{S}}(h^{\prime}){-}\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h)%
\right]+\alpha^{\prime}\!\left[\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h){-}%
\text{R}^{\ell^{\prime}}_{\mathcal{S}}(h^{\prime})\right]+m\epsilon+\ln\!\frac%
{8\sqrt{m}}{\delta^{2}}\right].
\pi_{\mathcal{S}}
\epsilon=2\alpha^{\prime}\frac{1}{m}
h^{\prime}
\epsilon
\mathcal{S}
\operatorname*{\mathbb{E}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim\rho_{\mathcal%
{S}}}\text{R}^{\ell}_{\mathcal{D}}(h){-}\text{R}^{\ell}_{\mathcal{S}}(h)
\operatorname{\mu}(h,\mathcal{S}){=}\alpha\text{R}^{\ell}_{\mathcal{S}}(h)
0
1
\operatorname{\mu}(h,\mathcal{S}){=}\alpha\text{R}^{\ell}_{\mathcal{S}}(h)
\operatorname*{\mathbb{E}}_{\mathcal{S}\sim\mathcal{D}^{m},h\sim\rho_{\mathcal%
{S}}}\text{R}^{\ell}_{\mathcal{D}}(h)
\operatorname*{\mathbb{E}}_{h\sim\rho_{\mathcal{S}}}\text{R}^{\ell}_{\mathcal{%
D}}(h)
\operatorname{\mu}(h,\mathcal{S}){=}\alpha\text{R}^{\ell}_{\mathcal{S}}(h)
\alpha
\operatorname{\mu}
h\sim\rho_{\mathcal{S}}
h
\rho_{\mathcal{S}}
\operatorname{\mu}
\operatorname{\mu}
\operatorname{\mu}
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\mathcal{D}
\mathcal{X}\times\mathcal{Y}
\mathcal{H}
\Phi_{{\tt u}}:(0,1]{\to}\mathbb{R}
\delta\in(0,1]
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\Bigg{%
[}\,\forall h{\in}\mathcal{H},\ \phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}%
^{\ell}_{\mathcal{S}}(h))\leq\Phi_{{\tt u}}\big{(}\delta\big{)}\Bigg{]}=%
\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\left[\,\sup_{h\in%
\mathcal{H}}\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}%
}(h))\leq\Phi_{{\tt u}}\big{(}\delta\big{)}\right]\geq 1-\delta.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\Bigg{%
[}\,\forall h{\in}\mathcal{H},\ \phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}%
^{\ell}_{\mathcal{S}}(h))\leq\Phi_{{\tt u}}\big{(}\delta\big{)}\Bigg{]}=%
\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\left[\,\sup_{h\in%
\mathcal{H}}\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}%
}(h))\leq\Phi_{{\tt u}}\big{(}\delta\big{)}\right]\geq 1-\delta.
\Phi_{{\tt u}}(\delta){=}{\tt rad}(\mathcal{H}){+}\sqrt{\frac{1}{2m}\ln\frac{1%
}{\delta}}
{\tt rad}(\mathcal{H})
\Phi_{{\tt u}}(\delta){=}\sqrt{\frac{1}{m}2{\tt vc}(\mathcal{H})\ln\frac{em}{{%
\tt vc}(\mathcal{H})}}{+}\sqrt{\tfrac{1}{2m}\ln\frac{1}{\delta}}
{\tt vc}(\mathcal{H})
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))=\text{%
R}^{\ell}_{\mathcal{D}}(h)-\text{R}^{\ell}_{\mathcal{S}}(h)
\ell
\delta
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))
\Phi_{{\tt u}}(\delta)
(h,\mathcal{S})\!\in\!\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y})^{m}
\Phi_{{\tt u}}(\delta)
h_{\mathcal{S}}
\mathcal{S}
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\mathcal{D}
\mathcal{X}\times\mathcal{Y}
\Phi_{{\tt a}}:(0,1]{\to}\mathbb{R}
\delta\in(0,1]
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\Big{[%
}\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),\text{R}^{\ell}_{\mathcal%
{S}}(h_{\mathcal{S}}))\leq\Phi_{{\tt a}}(\delta)\Big{]}\geq 1{-}\delta,
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\Big{[%
}\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),\text{R}^{\ell}_{\mathcal%
{S}}(h_{\mathcal{S}}))\leq\Phi_{{\tt a}}(\delta)\Big{]}\geq 1{-}\delta,
h_{\mathcal{S}}\in\mathcal{H}
\mathcal{S}\sim\mathcal{D}^{m}
\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),\text{R}^{\ell}_{\mathcal{%
S}}(h_{\mathcal{S}}))=\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}})-\text{R}^%
{\ell}_{\mathcal{S}}(h_{\mathcal{S}})
\Phi_{{\tt a}}(\delta)=2\beta+(4m\beta+1)\sqrt{\frac{\ln 1/\delta}{2m}}
\beta
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}[0,1]
\Phi_{{\tt a}}(\delta)
h_{\mathcal{S}}
\mathcal{S}
\operatorname{\mu}
\mathcal{S}
h
\operatorname{\mu}
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\Phi_{{\tt u}}:(0,1]\to\mathbb{R}
\operatorname{\mu}
\displaystyle\forall(h,\mathcal{S})\in\mathcal{H}{\times}(\mathcal{X}{\times}%
\mathcal{Y})^{m},\quad\operatorname{\mu}(h,\mathcal{S})=-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))-\Phi_{{\tt u}}(\tfrac{%
\delta}{2})-\ln\pi(h)
\displaystyle\forall(h,\mathcal{S})\in\mathcal{H}{\times}(\mathcal{X}{\times}%
\mathcal{Y})^{m},\quad\operatorname{\mu}(h,\mathcal{S})=-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))-\Phi_{{\tt u}}(\tfrac{%
\delta}{2})-\ln\pi(h)
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h^{%
\prime}\sim\pi}\Bigg{[}\sup_{f\in\mathcal{H}}\phi(\text{R}^{\ell}_{\mathcal{D}%
}(f),\text{R}^{\ell}_{\mathcal{S}}(f))\leq\underbrace{\Phi_{{\tt u}}(\tfrac{%
\delta}{2})+\ln\!\left[\frac{16}{\delta^{2}}\operatorname*{\mathbb{E}}_{%
\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))-\phi(%
\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime}))}\right]}_{\triangleq\ \Phi_{{\tt u}}^{\prime}(\delta)}\Bigg{]}\geq 1%
{-}\delta.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h^{%
\prime}\sim\pi}
\displaystyle\Bigg{[}\sup_{f\in\mathcal{H}}\phi(\text{R}^{\ell}_{\mathcal{D}}(%
f),\text{R}^{\ell}_{\mathcal{S}}(f))\leq\underbrace{\Phi_{{\tt u}}(\tfrac{%
\delta}{2})+\ln\!\left[\frac{16}{\delta^{2}}\operatorname*{\mathbb{E}}_{%
\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))-\phi(%
\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime}))}\right]}_{\triangleq\ \Phi_{{\tt u}}^{\prime}(\delta)}\Bigg{]}\geq 1%
{-}\delta.
\rho_{\mathcal{S}}
\operatorname{\mu}
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq\underbrace{-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{\prime}))-\Phi_{{%
\tt u}}(\tfrac{\delta}{2})-\ln\pi(h^{\prime})}_{\operatorname{\mu}(h^{\prime},%
\mathcal{S})}
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq
\displaystyle\underbrace{-\phi(\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text%
{R}^{\ell}_{\mathcal{S}}(h^{\prime}))-\Phi_{{\tt u}}(\tfrac{\delta}{2})-\ln\pi%
(h^{\prime})}_{\operatorname{\mu}(h^{\prime},\mathcal{S})}
\displaystyle+\underbrace{\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell%
}_{\mathcal{S}}(h))+\Phi_{{\tt u}}(\tfrac{\delta}{2})+\ln\pi(h)}_{-%
\operatorname{\mu}(h,\mathcal{S})}
\displaystyle+\underbrace{\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell%
}_{\mathcal{S}}(h))+\Phi_{{\tt u}}(\tfrac{\delta}{2})+\ln\pi(h)}_{-%
\operatorname{\mu}(h,\mathcal{S})}
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\frac{\delta}{2}.
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\frac{\delta}{2}.
1{-}\frac{\delta}{2}
\mathcal{S}
-\Phi_{{\tt u}}(\tfrac{\delta}{2})\leq-\sup_{f\in\mathcal{H}}\phi(\text{R}^{%
\ell}_{\mathcal{D}}(f),\text{R}^{\ell}_{\mathcal{S}}(f))
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq-\phi(\text{R}^{\ell}_{\mathcal{D}%
}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{\prime}))-\sup_{f\in\mathcal{H}%
}\phi(\text{R}^{\ell}_{\mathcal{D}}(f),\text{R}^{\ell}_{\mathcal{S}}(f))-\ln%
\pi(h^{\prime})
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq
\displaystyle-\phi(\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{%
\mathcal{S}}(h^{\prime}))-\sup_{f\in\mathcal{H}}\phi(\text{R}^{\ell}_{\mathcal%
{D}}(f),\text{R}^{\ell}_{\mathcal{S}}(f))-\ln\pi(h^{\prime})
\displaystyle+\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{%
S}}(h))+\Phi_{{\tt u}}(\tfrac{\delta}{2})+\ln\pi(h)
\displaystyle+\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{%
S}}(h))+\Phi_{{\tt u}}(\tfrac{\delta}{2})+\ln\pi(h)
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\delta.
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\delta.
\sup_{f\in\mathcal{H}}\phi(\text{R}^{\ell}_{\mathcal{D}}(f),\text{R}^{\ell}_{%
\mathcal{S}}(f))
\Phi_{{\tt u}}(\delta)
\Phi_{{\tt u}}(\delta)
\Phi_{{\tt u}}(\delta)={\tt rad}(\mathcal{H}){+}\sqrt{\frac{1}{2m}\ln\frac{1}{%
\delta}}
{\tt rad}(\mathcal{H})
\Phi_{{\tt u}}(\delta)
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}[0,1]
\operatorname{\mu}
\displaystyle\forall(h,\mathcal{S})\in\mathcal{H}{\times}(\mathcal{X}{\times}%
\mathcal{Y})^{m},\quad\operatorname{\mu}(h,\mathcal{S})=-\sqrt{m}[\text{R}^{%
\ell}_{\mathcal{D}}(h){-}\text{R}^{\ell}_{\mathcal{S}}(h)]-\sqrt{m}\left[{\tt
rad%
}(\mathcal{H}){+}\sqrt{\tfrac{1}{2m}\ln\tfrac{2}{\delta}}\right]-\ln\pi(h),
\displaystyle\forall(h,\mathcal{S})\in\mathcal{H}{\times}(\mathcal{X}{\times}%
\mathcal{Y})^{m},\quad\operatorname{\mu}(h,\mathcal{S})=-\sqrt{m}[\text{R}^{%
\ell}_{\mathcal{D}}(h){-}\text{R}^{\ell}_{\mathcal{S}}(h)]-\sqrt{m}\left[{\tt
rad%
}(\mathcal{H}){+}\sqrt{\tfrac{1}{2m}\ln\tfrac{2}{\delta}}\right]-\ln\pi(h),
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}\Bigg{%
[}\sup_{f\in\mathcal{H}}\text{R}^{\ell}_{\mathcal{D}}(f)-\text{R}^{\ell}_{%
\mathcal{S}}(f)\leq{\tt rad}(\mathcal{H}){+}\sqrt{\frac{1}{2m}\ln\frac{4}{%
\delta}}+\frac{\ln\frac{128}{\delta^{3}}{+}2}{\sqrt{m}}\Bigg{]}\geq 1{-}\delta.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m}}
\displaystyle\Bigg{[}\sup_{f\in\mathcal{H}}\text{R}^{\ell}_{\mathcal{D}}(f)-%
\text{R}^{\ell}_{\mathcal{S}}(f)\leq{\tt rad}(\mathcal{H}){+}\sqrt{\frac{1}{2m%
}\ln\frac{4}{\delta}}+\frac{\ln\frac{128}{\delta^{3}}{+}2}{\sqrt{m}}\Bigg{]}%
\geq 1{-}\delta.
\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))=\sqrt{%
m}[\text{R}^{\ell}_{\mathcal{D}}(h){-}\text{R}^{\ell}_{\mathcal{S}}(h)]
\Phi_{{\tt u}}(\delta)={\tt rad}(\mathcal{H}){+}\sqrt{\frac{1}{2m}\ln\frac{1}{%
\delta}}
1-\delta/2
\mathcal{S}\sim\mathcal{D}^{m}
h^{\prime}\sim\pi
\displaystyle\sup_{f\in\mathcal{H}}\text{R}^{\ell}_{\mathcal{D}}(f)-\text{R}^{%
\ell}_{\mathcal{S}}(f)\leq\Phi_{{\tt u}}(\tfrac{\delta}{4})+\frac{1}{\sqrt{m}}%
\ln\!\left[\frac{64}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim%
}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{\sqrt{m}[\text{R}^{%
\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m}[\text{R}^{%
\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{\prime})]}%
\right].
\displaystyle\sup_{f\in\mathcal{H}}\text{R}^{\ell}_{\mathcal{D}}(f)-\text{R}^{%
\ell}_{\mathcal{S}}(f)\leq\Phi_{{\tt u}}(\tfrac{\delta}{4})+\frac{1}{\sqrt{m}}%
\ln\!\left[\frac{64}{\delta^{2}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim%
}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{\sqrt{m}[\text{R}^{%
\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m}[\text{R}^{%
\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{\prime})]}%
\right].
1-\delta
\mathcal{S}\sim\mathcal{D}^{m}
\displaystyle\sup_{f\in\mathcal{H}}\text{R}^{\ell}_{\mathcal{D}}(f)-\text{R}^{%
\ell}_{\mathcal{S}}(f)\leq\Phi_{{\tt u}}(\tfrac{\delta}{4})+\frac{1}{\sqrt{m}}%
\ln\!\left[\frac{128}{\delta^{3}}\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*%
{\mathbb{E}}_{\mathcal{V}{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{%
\sim}\pi}e^{\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{%
\mathcal{V}}(g)]-\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{%
\ell}_{\mathcal{S}}(h^{\prime})]}\right].
\displaystyle\sup_{f\in\mathcal{H}}\text{R}^{\ell}_{\mathcal{D}}(f)-\text{R}^{%
\ell}_{\mathcal{S}}(f)\leq\Phi_{{\tt u}}(\tfrac{\delta}{4})+\frac{1}{\sqrt{m}}%
\ln\!\left[\frac{128}{\delta^{3}}\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}%
\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*%
{\mathbb{E}}_{\mathcal{V}{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{%
\sim}\pi}e^{\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{%
\mathcal{V}}(g)]-\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{%
\ell}_{\mathcal{S}}(h^{\prime})]}\right].
\operatorname*{\mathbb{E}}_{\mathcal{S}\!{\sim}\mathcal{D}^{m}}\operatorname*{%
\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{%
\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{[\text{R}^{\ell%
}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-[\text{R}^{\ell}_{%
\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{\prime})]}
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*{\mathbb{E}}_{%
\mathcal{V}{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-%
\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S%
}}(h^{\prime})]}
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*{\mathbb{E}}_{%
\mathcal{V}{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-%
\sqrt{m}[\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S%
}}(h^{\prime})]}
\displaystyle=\operatorname*{\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*{%
\mathbb{E}}_{g{\sim}\pi}\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}\mathcal{%
D}^{m}}\operatorname*{\mathbb{E}}_{\mathcal{V}{\sim}\mathcal{D}^{m}}e^{\sqrt{m%
}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m}[%
\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime})]}.
\displaystyle=\operatorname*{\mathbb{E}}_{h^{\prime}{\sim}\pi}\operatorname*{%
\mathbb{E}}_{g{\sim}\pi}\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}\mathcal{%
D}^{m}}\operatorname*{\mathbb{E}}_{\mathcal{V}{\sim}\mathcal{D}^{m}}e^{\sqrt{m%
}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m}[%
\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime})]}.
\operatorname*{\mathbb{E}}_{\mathcal{S}{\sim}\mathcal{D}^{m}}\operatorname*{%
\mathbb{E}}_{\mathcal{V}{\sim}\mathcal{D}^{m}}e^{\sqrt{m}[\text{R}^{\ell}_{%
\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m}[\text{R}^{\ell}_{%
\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{\prime})]}
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{\mathcal{S}\!{\sim}\mathcal{D}^{m}}\exp\left(\sqrt%
{m}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m%
}[\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime})]\right)
\displaystyle\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}%
\operatorname*{\mathbb{E}}_{\mathcal{S}\!{\sim}\mathcal{D}^{m}}\exp\left(\sqrt%
{m}[\text{R}^{\ell}_{\mathcal{D}}(g)-\text{R}^{\ell}_{\mathcal{V}}(g)]-\sqrt{m%
}[\text{R}^{\ell}_{\mathcal{D}}(h^{\prime})-\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime})]\right)
\displaystyle=\prod_{i=1}^{m}\left[\operatorname*{\mathbb{E}}_{(\mathbf{x}_{i}%
^{\prime},y_{i}^{\prime})\sim\mathcal{D}}\operatorname*{\mathbb{E}}_{(\mathbf{%
x}_{i},y_{i})\sim\mathcal{D}}\exp\left(\frac{1}{\sqrt{m}}\!\left[\operatorname%
*{\mathbb{E}}_{(\mathbf{x},z)\sim\mathcal{D}}\ell(g,(\mathbf{x},y))-\ell(g,(%
\mathbf{x}^{\prime}_{i},y^{\prime}_{i}))-\operatorname*{\mathbb{E}}_{(\mathbf{%
x},z)\sim\mathcal{D}}\ell(h^{\prime},(\mathbf{x},y))+\ell(h^{\prime},(\mathbf{%
x}_{i},y_{i}))\right]\right)\right]
\displaystyle=\prod_{i=1}^{m}\left[\operatorname*{\mathbb{E}}_{(\mathbf{x}_{i}%
^{\prime},y_{i}^{\prime})\sim\mathcal{D}}\operatorname*{\mathbb{E}}_{(\mathbf{%
x}_{i},y_{i})\sim\mathcal{D}}\exp\left(\frac{1}{\sqrt{m}}\!\left[\operatorname%
*{\mathbb{E}}_{(\mathbf{x},z)\sim\mathcal{D}}\ell(g,(\mathbf{x},y))-\ell(g,(%
\mathbf{x}^{\prime}_{i},y^{\prime}_{i}))-\operatorname*{\mathbb{E}}_{(\mathbf{%
x},z)\sim\mathcal{D}}\ell(h^{\prime},(\mathbf{x},y))+\ell(h^{\prime},(\mathbf{%
x}_{i},y_{i}))\right]\right)\right]
\displaystyle\leq\prod_{i=1}^{m}\left[\exp\left(\frac{2}{m}\right)\right]
\displaystyle\leq\prod_{i=1}^{m}\left[\exp\left(\frac{2}{m}\right)\right]
\displaystyle=\exp\left(2\right).
\displaystyle=\exp\left(2\right).
\operatorname{\mu}
m
\operatorname{\mu}
\ell:\mathcal{H}{\times}(\mathcal{X}{\times}\mathcal{Y}){\to}\mathbb{R}
\phi\!:\!\mathbb{R}^{2}{\to}\mathbb{R}
\Phi_{{\tt a}}:(0,1]\to\mathbb{R}
\operatorname{\mu}
\displaystyle\forall(h,\mathcal{S})\in\mathcal{H}{\times}(\mathcal{X}{\times}%
\mathcal{Y})^{m},\quad\operatorname{\mu}(h,\mathcal{S})=-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))-\Phi_{{\tt a}}(\tfrac{%
\delta}{2})-\ln\pi(h)
\displaystyle\forall(h,\mathcal{S})\in\mathcal{H}{\times}(\mathcal{X}{\times}%
\mathcal{Y})^{m},\quad\operatorname{\mu}(h,\mathcal{S})=-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))-\Phi_{{\tt a}}(\tfrac{%
\delta}{2})-\ln\pi(h)
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h^{%
\prime}\sim\pi}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),%
\text{R}^{\ell}_{\mathcal{S}}(h_{\mathcal{S}}))\leq\underbrace{\Phi_{{\tt a}}(%
\tfrac{\delta}{2})+\ln\!\left[\frac{16}{\delta^{2}}\operatorname*{\mathbb{E}}_%
{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))-\phi(%
\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime}))}\right]}_{\triangleq\ \Phi_{{\tt a}}^{\prime}(\delta)}\Bigg{]}\geq 1%
{-}\delta.
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},h^{%
\prime}\sim\pi}
\displaystyle\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),\text%
{R}^{\ell}_{\mathcal{S}}(h_{\mathcal{S}}))\leq\underbrace{\Phi_{{\tt a}}(%
\tfrac{\delta}{2})+\ln\!\left[\frac{16}{\delta^{2}}\operatorname*{\mathbb{E}}_%
{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname*{\mathbb{E}}_{g{\sim}\pi}e^{%
\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{\ell}_{\mathcal{V}}(g))-\phi(%
\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{%
\prime}))}\right]}_{\triangleq\ \Phi_{{\tt a}}^{\prime}(\delta)}\Bigg{]}\geq 1%
{-}\delta.
\rho_{\mathcal{S}}
\operatorname{\mu}
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq\underbrace{-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{\prime}))-\Phi_{{%
\tt a}}(\tfrac{\delta}{2})-\ln\pi(h^{\prime})}_{\operatorname{\mu}(h^{\prime},%
\mathcal{S})}
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq
\displaystyle\underbrace{-\phi(\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text%
{R}^{\ell}_{\mathcal{S}}(h^{\prime}))-\Phi_{{\tt a}}(\tfrac{\delta}{2})-\ln\pi%
(h^{\prime})}_{\operatorname{\mu}(h^{\prime},\mathcal{S})}
\displaystyle+\underbrace{\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell%
}_{\mathcal{S}}(h))+\Phi_{{\tt a}}(\tfrac{\delta}{2})+\ln\pi(h)}_{-%
\operatorname{\mu}(h,\mathcal{S})}
\displaystyle+\underbrace{\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell%
}_{\mathcal{S}}(h))+\Phi_{{\tt a}}(\tfrac{\delta}{2})+\ln\pi(h)}_{-%
\operatorname{\mu}(h,\mathcal{S})}
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\frac{\delta}{2}.
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\frac{\delta}{2}.
1{-}\frac{\delta}{2}
\mathcal{S}
-\Phi_{{\tt a}}(\tfrac{\delta}{2})\leq-\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{%
\mathcal{S}}),\text{R}^{\ell}_{\mathcal{S}}(h_{\mathcal{S}}))
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq-\phi(\text{R}^{\ell}_{\mathcal{D}%
}(h^{\prime}),\text{R}^{\ell}_{\mathcal{S}}(h^{\prime}))-\phi(\text{R}^{\ell}_%
{\mathcal{D}}(h_{\mathcal{S}}),\text{R}^{\ell}_{\mathcal{S}}(h_{\mathcal{S}}))%
-\ln\pi(h^{\prime})
\displaystyle\operatorname*{\mathbb{P}}_{\mathcal{S}\sim\mathcal{D}^{m},\ h^{%
\prime}\sim\pi,h\sim\rho_{\mathcal{S}}}\Bigg{[}\phi(\text{R}^{\ell}_{\mathcal{%
D}}(h),\text{R}^{\ell}_{\mathcal{S}}(h))\leq
\displaystyle-\phi(\text{R}^{\ell}_{\mathcal{D}}(h^{\prime}),\text{R}^{\ell}_{%
\mathcal{S}}(h^{\prime}))-\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),%
\text{R}^{\ell}_{\mathcal{S}}(h_{\mathcal{S}}))-\ln\pi(h^{\prime})
\displaystyle+\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{%
S}}(h))+\Phi_{{\tt a}}(\tfrac{\delta}{2})+\ln\pi(h)
\displaystyle+\phi(\text{R}^{\ell}_{\mathcal{D}}(h),\text{R}^{\ell}_{\mathcal{%
S}}(h))+\Phi_{{\tt a}}(\tfrac{\delta}{2})+\ln\pi(h)
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\delta.
\displaystyle+\ln\frac{\pi(h^{\prime})}{\pi(h)}+\ln\!\left[\frac{16}{\delta^{2%
}}\operatorname*{\mathbb{E}}_{\mathcal{V}\!{\sim}\mathcal{D}^{m}}\operatorname%
*{\mathbb{E}}_{g{\sim}\pi}e^{\phi(\text{R}^{\ell}_{\mathcal{D}}(g),\text{R}^{%
\ell}_{\mathcal{V}}(g))}\right]\Bigg{]}\geq 1{-}\delta.
\phi(\text{R}^{\ell}_{\mathcal{D}}(h_{\mathcal{S}}),\text{R}^{\ell}_{\mathcal{%
S}}(h_{\mathcal{S}}))
h_{\mathcal{S}}
\Phi_{{\tt a}}^{\prime}(\delta)
\operatorname{\mu}
\alpha
\text{\sc Neural}^{\boldsymbol{D}}
\overline{\operatorname{kl}}
\operatorname{kl}(q\|p)\leq\tau
q
p
\tau
p
\displaystyle\overline{\operatorname{kl}}[q|\tau]=\max\Big{\{}p\in(0,1)\;\Big{%
|}\;\operatorname{kl}(q\|p)\leq\tau\Big{\}}.
\displaystyle\overline{\operatorname{kl}}[q|\tau]=\max\Big{\{}p\in(0,1)\;\Big{%
|}\;\operatorname{kl}(q\|p)\leq\tau\Big{\}}.
[p_{\text{min}},p_{\text{max}}]
p
p_{\text{min}}=q
p_{\text{max}}=1
p_{\text{tmp}}=\frac{1}{2}(p_{\text{max}}-p_{\text{min}})
p_{\text{min}}
p_{\text{max}}
p_{\text{tmp}}
\operatorname{kl}(q\|p_{\text{tmp}})>\tau
\operatorname{kl}(q\|p_{\text{tmp}})<\tau
p_{\text{max}}=p_{\text{tmp}}
p_{\text{min}}=p_{\text{tmp}}
\operatorname{kl}(q\|p_{\text{tmp}})=\tau
p_{\text{max}}-p_{\text{min}}<\epsilon
p_{\text{tmp}}
\overline{\operatorname{kl}}[q|\tau]
\epsilon=10^{-9}
1000
\alpha=m
\alpha
\sqrt{m}
m
\alpha
\alpha
\text{R}^{\ell}_{\mathcal{T}}(h)
\alpha
\text{\sc Neural}^{\boldsymbol{D}}
m_{\text{val}}
m_{\text{train}}
1000
\frac{m_{\text{val}}}{m_{\text{val}}+m_{\text{train}}}\in\{0.99,0.97,0.95,0.93\}
120
\frac{m_{\text{val}}}{m_{\text{val}}+m_{\text{train}}}=0.90
110
\frac{m_{\text{val}}}{m_{\text{val}}+m_{\text{train}}}\in\{0.80,0.70,0.60,0.50%
,0.40,0.30,0.20,0.10\}
\rho_{\mathcal{S}}
3
1024
\mathbf{w}
h
\text{\sc Neural}(h,\mathcal{S})
\mathbf{w}
\ell_{2}
0.1
\epsilon=0.0
-1/\sqrt{1024}
+1/\sqrt{1024}
[-1/\sqrt{d},+1/\sqrt{d}]
d
m_{\text{train}}
m_{\text{val}}
50
64
128
256
0.001
0.0001
\frac{m_{\text{val}}}{m_{\text{train}}+m_{\text{val}}}
0.1
0.3
0.5
\rho_{\mathcal{S}}
\text{\sc Neural}^{\boldsymbol{D}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\beta
\alpha
\frac{m^{\prime}}{m^{\prime}+m}=0.0
\text{R}^{\ell}_{\mathcal{T}}(h)
\beta
\alpha
\frac{m^{\prime}}{m^{\prime}+m}=0.0
\text{R}^{\ell}_{\mathcal{T}}(h)
\beta
\alpha
\frac{m^{\prime}}{m^{\prime}+m}=0.5
\text{R}^{\ell}_{\mathcal{T}}(h)
\beta
\alpha
\frac{m^{\prime}}{m^{\prime}+m}=0.5
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\text{\sc Neural}^{\boldsymbol{D}}
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\text{\sc Neural}^{\boldsymbol{D}}
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\text{\sc Neural}^{\boldsymbol{D}}
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
\text{\sc Neural}^{\boldsymbol{D}}
h\sim\rho_{\mathcal{S}}
\text{R}^{\ell}_{\mathcal{T}}(h)
