\triangleright
{\mathcal{X}}=({\bm{x}}_{1},\ldots,{\bm{x}}_{T})\in\mathbb{R}^{T\times n}
T
n
e
i
{\mathcal{X}}_{i,e}=({\bm{x}}_{i-e+1},\ldots,{\bm{x}}_{i})
H
f_{\omega}({\mathcal{X}}_{i,H})=({\bm{x}}_{i+1},\ldots,{\bm{x}}_{i+H})
\omega
H>1
H
L
\bm{\theta}=\{\bm{\theta}_{l}\}_{l=1}^{L}
\bm{\phi}_{l}
\mathcal{M}_{l}
\bm{\omega}=\{\bm{\theta}_{l},\bm{\phi}_{l}\}_{l=1}^{L}
\mathcal{M}=\{\mathcal{M}_{l}\}_{l=1}^{L}
t
\nabla_{\bm{\theta}_{l}}\ell
\bm{\theta}_{l}
\ell
\displaystyle\hat{{\bm{g}}}_{l}\leftarrow\gamma\hat{{\bm{g}}}_{l}+(1-\gamma){%
\bm{g}}_{l}^{t},
\displaystyle\hat{{\bm{g}}}_{l}\leftarrow\gamma\hat{{\bm{g}}}_{l}+(1-\gamma){%
\bm{g}}_{l}^{t},
{\bm{g}}_{l}^{t}
l
t
\hat{{\bm{g}}}_{l}
\hat{{\bm{g}}}_{l}
{\bm{u}}_{l}
{\bm{u}}_{l}
\bm{\alpha}_{l}
\bm{\beta}_{l}
{\bm{u}}_{l}=[\bm{\alpha}_{l};\bm{\beta}_{l}]
\alpha_{l}
\bm{\theta}_{l}
\displaystyle[\bm{\alpha}_{l},\bm{\beta}_{l}]={\bm{u}}_{l},\;\mathrm{where}\;{%
\bm{u}}_{l}=\bm{\Omega}(\hat{{\bm{g}}}_{l};\bm{\phi}_{l})
\displaystyle[\bm{\alpha}_{l},\bm{\beta}_{l}]=
\displaystyle{\bm{u}}_{l},\;\mathrm{where}\;{\bm{u}}_{l}=\bm{\Omega}(\hat{{\bm%
{g}}}_{l};\bm{\phi}_{l})
\displaystyle\tilde{\bm{\theta}_{l}}=\mathrm{tile}(\bm{\alpha}_{l})\odot\bm{%
\theta}_{l},\;\mathrm{and}\;\tilde{\bm{h}_{l}}=\mathrm{tile}(\bm{\beta}_{l})%
\odot\bm{h}_{l},\;\mathrm{where}\;\bm{h}_{l}=\tilde{\bm{\theta}_{l}}%
\circledast\tilde{\bm{h}}_{l-1}.
\displaystyle\tilde{\bm{\theta}_{l}}=
\displaystyle\mathrm{tile}(\bm{\alpha}_{l})\odot\bm{\theta}_{l},\;\mathrm{and}%
\;\tilde{\bm{h}_{l}}=\mathrm{tile}(\bm{\beta}_{l})\odot\bm{h}_{l},\;\mathrm{%
where}\;\bm{h}_{l}=\tilde{\bm{\theta}_{l}}\circledast\tilde{\bm{h}}_{l-1}.
\bm{\theta}_{l}
I
C
Z
\tilde{\bm{\theta}_{l}}
\odot
\bm{\alpha}_{l}
\Omega(\cdot;\bm{\phi}_{l})
{\bm{u}}
{\bm{u}}
{\bm{u}}
\mathcal{M}_{l}\in\mathbb{R}^{N\times d}
d
{\bm{u}}_{l}
N
N=32
\hat{{\bm{g}}}^{\prime}_{l}
\gamma^{\prime}<\gamma
\mathrm{Trigger\;if:}\;\mathrm{cos}(\hat{{\bm{g}}}_{l},\hat{{\bm{g}}}^{\prime}%
_{l})=\frac{\hat{{\bm{g}}}_{l}\cdot\hat{{\bm{g}}}_{l}^{\prime}}{||\hat{{\bm{g}%
}}_{l}||\,||\hat{{\bm{g}}}_{l}||}<-\tau,
\tau>0
\tau
\gamma^{\prime}
{\bm{u}}_{l}
{\bm{r}}_{l}=\mathrm{softmax}(\mathcal{M}_{l}\hat{{\bm{u}}}_{l})
{\bm{r}}^{(k)}_{l}=\mathrm{TopK}({\bm{r}}_{l})
\tilde{{\bm{u}}_{l}}=\sum_{i=1}^{K}{\bm{r}}^{(k)}_{l}[i]\mathcal{M}_{l}[i]
{\bm{r}}^{(k)}[i]
i
{\bm{r}}^{(k)}_{l}
\mathcal{M}_{l}[i]
i
\mathcal{M}_{l}
k=2
{\bm{u}}_{l}\leftarrow\tau{\bm{u}}_{l}+(1-\tau)\tilde{{\bm{u}}}_{t}
\tau
\mathcal{M}_{l}
\displaystyle\mathcal{M}_{l}\leftarrow\tau\mathcal{M}_{l}+(1-\tau)\hat{{\bm{u}%
}}_{l}\otimes{\bm{r}}^{(k)}_{l}\;\mathrm{and}\;\mathcal{M}_{l}\leftarrow\frac{%
\mathcal{M}_{l}}{\max(1,||\mathcal{M}_{l}||_{2})},
\displaystyle\mathcal{M}_{l}\leftarrow
\displaystyle\tau\mathcal{M}_{l}+(1-\tau)\hat{{\bm{u}}}_{l}\otimes{\bm{r}}^{(k%
)}_{l}\;\mathrm{and}\;\mathcal{M}_{l}\leftarrow\frac{\mathcal{M}_{l}}{\max(1,|%
|\mathcal{M}_{l}||_{2})},
\otimes
{\bm{r}}^{(k)}_{l}
1,000
\varphi
\varphi
\varphi
\dagger
\dagger
\ell_{2}
60
H\in\{1,24,48\}
H=24
H=24
t=3000
t=3000
t=3100
t=3100
t=3200
t=3200
t=4000
t=4000
t=4100
t=4100
t=4200
t=4200
t=5000
t=5000
t=5100
t=5100
t=5200
t=5200
t=3000
{\bm{u}}
\mathrm{vec}(\cdot)
\mathrm{split}({\bm{e}},B)
{\bm{e}}
B
\mathrm{dim}({\bm{e}})/B
{\bm{u}}\in\mathbb{R}^{d}
\displaystyle\hat{{\bm{g}}}_{l}\leftarrow\mathrm{vec}(\hat{{\bm{g}}}_{l})
\displaystyle\hat{{\bm{g}}}_{l}\leftarrow
\displaystyle\mathrm{vec}(\hat{{\bm{g}}}_{l})
\displaystyle[{\bm{b}}_{1},{\bm{b}}_{2},\ldots{\bm{b}}_{d}]\leftarrow\mathrm{%
reshape}(\hat{{\bm{g}}}_{l};d)
\displaystyle[{\bm{b}}_{1},{\bm{b}}_{2},\ldots{\bm{b}}_{d}]\leftarrow
\displaystyle\mathrm{reshape}(\hat{{\bm{g}}}_{l};d)
\displaystyle[{\bm{h}}_{1},{\bm{h}}_{2},\ldots,{\bm{h}}_{d}]\leftarrow[\bm{W}^%
{(1)}_{\bm{\phi}}{\bm{b}}_{1},\bm{W}^{(1)}_{\bm{\phi}}{\bm{b}}_{2},\ldots,\bm{%
W}^{(1)}_{\bm{\phi}}{\bm{b}}_{d}]
\displaystyle[{\bm{h}}_{1},{\bm{h}}_{2},\ldots,{\bm{h}}_{d}]\leftarrow
\displaystyle[\bm{W}^{(1)}_{\bm{\phi}}{\bm{b}}_{1},\bm{W}^{(1)}_{\bm{\phi}}{%
\bm{b}}_{2},\ldots,\bm{W}^{(1)}_{\bm{\phi}}{\bm{b}}_{d}]
\displaystyle[{\bm{u}}_{1},{\bm{u}}_{2},\ldots,{\bm{u}}_{d}]\leftarrow[\bm{W}^%
{(2)}_{\bm{\phi}}{\bm{h}}_{1},\bm{W}^{(2)}_{\bm{\phi}}{\bm{h}}_{2},\ldots,\bm{%
W}^{(2)}_{\bm{\phi}}{\bm{h}}_{d}].
\displaystyle[{\bm{u}}_{1},{\bm{u}}_{2},\ldots,{\bm{u}}_{d}]\leftarrow
\displaystyle[\bm{W}^{(2)}_{\bm{\phi}}{\bm{h}}_{1},\bm{W}^{(2)}_{\bm{\phi}}{%
\bm{h}}_{2},\ldots,\bm{W}^{(2)}_{\bm{\phi}}{\bm{h}}_{d}].
\bm{W}^{(1)}_{\bm{\phi}}
\bm{W}^{(2)}_{\bm{\phi}}
d
{\bm{u}}
\gamma^{\prime}<\gamma
\tau
\bm{\theta}
\bm{\phi}
\mathcal{M}
\bm{R}
t\leftarrow 1
T
t-
{\bm{x}}_{t}
{\bm{h}}_{0}={\bm{x}}_{t}
L
j\leftarrow 1
L
[\bm{\alpha}_{l},\bm{\beta}_{l}]={\bm{u}}_{l},\;\mathrm{where}\;{\bm{u}}_{l}=%
\bm{\Omega}(\hat{{\bm{g}}}_{l};\bm{\phi}_{l})
\mathrm{trigger}==\mathrm{True}
\tilde{{\bm{u}}_{l}}\leftarrow\mathrm{Read}(\hat{{\bm{u}}}_{l},\mathcal{M}_{l})
\mathcal{M}_{l}\leftarrow\mathrm{Write}(\mathcal{M}_{l},\hat{{\bm{u}}_{l}})
{\bm{u}}_{l}\leftarrow\tau{\bm{u}}_{l}+(1-\tau)\tilde{{\bm{u}}}_{l}
\tilde{\bm{\theta}_{l}}=\mathrm{tile}(\bm{\alpha}_{l})\odot\bm{\theta}_{l}
\tilde{\bm{h}_{l}}=\mathrm{tile}(\bm{\beta}_{l})\odot\bm{h}_{l},\;\mathrm{%
where}\;\bm{h}_{l}=\tilde{\bm{\theta}_{l}}\circledast\tilde{h}_{l-1}.
\hat{{\bm{y}}}_{t}=\bm{R}h_{T}
{\bm{y}}
\bm{R}
j\leftarrow 1
L
\hat{{\bm{g}}_{l}},\hat{{\bm{g}}_{l}}^{\prime},{\bm{u}}_{l}
\bm{\phi}_{l},\bm{\theta}_{l}
\mathrm{cos}(\hat{{\bm{g}}_{l}},\hat{{\bm{g}}_{l}})<-\tau
\leftarrow
AR_{\varphi}(1)
X_{t}=\varphi X_{t-1}+\epsilon_{t},
\epsilon_{t}
X_{t-1}
X_{t}=\begin{cases}AR_{0.1}&\mathrm{if}\ 1<t\leq 1000\\
AR_{0.4}&\mathrm{if}\ 1000<t\leq 1999\\
AR_{0.6}&\mathrm{if}\ 2000<t\leq 2999\\
AR_{0.1}&\mathrm{if}\ 3000<t\leq 3999\\
AR_{0.4}&\mathrm{if}\ 4000<t\leq 4999\\
AR_{0.6}&\mathrm{if}\ 5000<t\leq 5999.\\
\end{cases}
X_{t}=\begin{cases}AR_{0.1}&\mathrm{if}\ 1<t\leq 800\\
0.5\times(AR_{0.1}+AR_{0.4})&\mathrm{if}\ 800<t\leq 1000\\
AR_{0.4}&\mathrm{if}\ 1000<t\leq 1600\\
0.5\times(AR_{0.4}+AR_{0.6})&\mathrm{if}\ 1600<t\leq 1800\\
AR_{0.6}&\mathrm{if}\ 1800<t<2400\\
0.5\times(AR_{0.6}+AR_{0.1})&\mathrm{if}\ 2400<t\leq 2600\\
AR_{0.1}&\mathrm{if}\ 2600<t\leq 3200\\
0.5\times(AR_{0.1}+AR_{0.4})&\mathrm{if}\ 3200<t\leq 3400\\
AR_{0.4}&\mathrm{if}\ 3400<t\leq 4000\\
0.5\times(AR_{0.4}+AR_{0.6}&\mathrm{if}\ 4000<t\leq 4200\\
AR_{0.6}&\mathrm{if}\ 4200<t\leq 5000\\
\end{cases}
\ell_{2}
\ell_{2}
{\bm{x}}
{\bm{y}}\in\mathbb{R}^{H}
\hat{{\bm{y}}}
\ell_{2}
\ell(\hat{{\bm{y}}}_{t},{\bm{y}}_{t})=\ell(f_{\bm{\omega}}({\bm{x}}_{t}),{\bm{%
y}}_{t})\coloneqq\frac{1}{H}\sum_{j=1}^{H}||\hat{{\bm{y}}}_{i}-{\bm{y}}_{i}||^%
{2}
\mathcal{M}
\mathcal{B}_{t}
\mathcal{M}
\mathcal{L}^{\mathrm{ER}}_{t}=\ell(f_{\bm{\omega}}({\bm{x}}_{t}),{\bm{y}}_{t})%
+\lambda_{\mathrm{ER}}\sum_{({\bm{x}},{\bm{y}})\in\mathcal{B}_{t}}\ell(f_{\bm{%
\omega}}({\bm{x}}),{\bm{y}}),
\ell(\cdot,\cdot)
\lambda_{\mathrm{ER}}
\mathcal{L}^{\mathrm{DER++}}_{t}=\ell(f_{\bm{\omega}}({\bm{x}}_{t}),{\bm{y}}_{%
t})+\lambda_{\mathrm{ER}}\sum_{({\bm{x}},{\bm{y}})\in\mathcal{B}_{t}}\ell(f_{%
\bm{\omega}}({\bm{x}}),{\bm{y}})+\lambda_{\mathrm{DER++}}\sum_{({\bm{x}},\hat{%
{\bm{y}}})\in\mathcal{B}_{t}}\ell(f_{\bm{\omega}}({\bm{x}}),\hat{{\bm{y}}}).
3e-3
1e-3
\gamma=0.9
\gamma^{\prime}=0.3
\tau=0.75
\gamma=0.9
\gamma^{\prime}=0.3
\tau=0.75
[2,4,8]
\lambda_{\mathrm{ER}}
[0.1,0.2,0.5,0.7,1]
\lambda_{\mathrm{DER++}}
[0.1,0.2,0.5,0.7,1]
\gamma
\gamma^{\prime}
[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]
\tau
[0.6,0.65,0.7,0.75,0.8,0.85,0.9]
\dagger
\dagger
H=24
H=24
N
E
H
N
H
E
N
H
E
\mathcal{O}(N+H)
\mathcal{O}(E+H)
\mathcal{O}(N)
\mathcal{O}(N+H)
\mathcal{O}(N+E+H)
\mathcal{O}(N+H)
\mathcal{O}(N+H)
N
H
\mathcal{O}(N+H)
\mathcal{O}(E+H)
\mathcal{O}(N+H)
\mathcal{O}(N+E+H)
\mathcal{O}(N+H)
H=24
H=1
H=1
H=48
H=24
H=48
H=24
\gamma
\gamma^{\prime}
\tau
\gamma
\gamma^{\prime}
\tau
\gamma
\gamma^{\prime}
\tau
