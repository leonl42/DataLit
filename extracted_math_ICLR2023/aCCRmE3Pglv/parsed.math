s\in\mathcal{S}
a\in\mathcal{A}
p(s_{t+1},r_{t}|s_{t},a_{t})
r_{t}
t
r(s,a)
p(s_{t+1},r_{t}|s_{t},a_{t},s_{t-1},a_{t-1},...,s_{0},a_{0})=p(s_{t+1},r_{t}|s%
_{t},a_{t})
s_{t}
a_{t}
\pi(a|s_{t})
a_{t}
s_{t+1},r_{t}\sim p(s_{t+1},r_{t}|s_{t},a_{t})
r_{t}
\tau=\{s_{t},a_{t},r_{t}\}_{t=0}^{T}
p(\tau)=p(s_{0})\prod_{t=0}^{T}p(s_{t+1},r_{t}|s_{t},a_{t})p(a_{t}|s_{t}).
p(a_{t}|s_{t})
a_{t}
s_{t}
\pi(a_{t}|s_{t})
\displaystyle J(\pi)=\mathbb{E}_{\tau\sim p_{\pi}(\tau)}\left[R_{\tau}\right]=%
\mathbb{E}_{\tau\sim p_{\pi}(\tau)}\left[\sum_{t=0}^{T}\gamma^{t}r_{t}|\tau%
\right],
\displaystyle J(\pi)
\displaystyle=\mathbb{E}_{\tau\sim p_{\pi}(\tau)}\left[R_{\tau}\right]=\mathbb%
{E}_{\tau\sim p_{\pi}(\tau)}\left[\sum_{t=0}^{T}\gamma^{t}r_{t}|\tau\right],
R_{\tau}:=\sum_{t=0}^{T}\gamma^{t}r_{t}|\tau
J(\pi)
J
\gamma
(1-\gamma)
\gamma
J(\pi
J
\{\tau\}
J(\pi)
\pi
s
\pi
\pi
s
V^{\pi}(s)=\mathbb{E}_{\tau\sim p_{\pi}(\tau)}\left[\sum_{t^{\prime}\geq t}%
\gamma^{t^{\prime}-t}r_{t^{\prime}}|s_{t}=s\right].
\mathbb{E}_{\tau\sim p_{\pi}(\tau)}[\cdot]
\tau
\pi
\displaystyle V^{\pi}(s)=r(s)+\sum_{s^{\prime}}p_{\pi}(s_{t+1}=s^{\prime}|s_{t%
}=s)\mathbb{E}_{\tau\sim p_{\pi}(\tau)}\left[\sum_{t^{\prime}=t+1}\gamma^{t^{%
\prime}-t}r_{t^{\prime}}|s_{t+1}=s^{\prime}\right]
\displaystyle V^{\pi}(s)
\displaystyle=r(s)+\sum_{s^{\prime}}p_{\pi}(s_{t+1}=s^{\prime}|s_{t}=s)\mathbb%
{E}_{\tau\sim p_{\pi}(\tau)}\left[\sum_{t^{\prime}=t+1}\gamma^{t^{\prime}-t}r_%
{t^{\prime}}|s_{t+1}=s^{\prime}\right]
\displaystyle=r(s)+\gamma\sum_{s^{\prime}}p_{\pi}(s_{t+1}=s^{\prime}|s_{t}=s)V%
^{\pi}(s^{\prime}),
\displaystyle=r(s)+\gamma\sum_{s^{\prime}}p_{\pi}(s_{t+1}=s^{\prime}|s_{t}=s)V%
^{\pi}(s^{\prime}),
p_{\pi}(s_{t+1}=s^{\prime}|s_{t}=s)=\sum_{a}\pi(a|s)p(s_{t+1}=s^{\prime}|s_{t}%
=s,a_{t}=a)
s
s^{\prime}
\pi
V^{\pi}(s)
V(s)
\mathcal{L}\propto\left(V(s)-\left(r(s)+\gamma\mathbb{E}_{p_{\pi}(s^{\prime}|s%
)}\left[V(s^{\prime})\right]\right)\right)^{2},
V(s)
\displaystyle\Delta V(s)\propto-\frac{\partial\mathcal{L}}{\partial V(s)}
\displaystyle\Delta V(s)
\displaystyle\propto-\frac{\partial\mathcal{L}}{\partial V(s)}
\displaystyle\propto-V(s)+r(s)+\gamma\mathbb{E}_{p_{\pi}(s^{\prime}|s)}\left[V%
(s^{\prime})\right]
\displaystyle\propto-V(s)+r(s)+\gamma\mathbb{E}_{p_{\pi}(s^{\prime}|s)}\left[V%
(s^{\prime})\right]
\displaystyle\approx-V(s_{t})+r_{t}+\gamma V(s_{t+1}).
\displaystyle\approx-V(s_{t})+r_{t}+\gamma V(s_{t+1}).
\delta_{t}:=-V(s_{t})+r_{t}+\gamma V(s_{t+1})
\alpha=0.05
\gamma=1
\alpha=0.5
r(s,a)
p(s^{\prime}|s,a)
a
\mathbb{E}\left[\sum_{t^{\prime}=t}\gamma^{t^{\prime}-t}r_{t^{\prime}}|s_{t}=s%
,a_{t}=a\right]=r(s,a)+\gamma\sum_{s^{\prime}}p(s^{\prime}|s,a)V(s^{\prime}).
a^{*}(s)=\text{argmax}_{a}\left(r(s,a)+\gamma\sum_{s^{\prime}}p(s^{\prime}|s,a%
)V(s^{\prime})\right).
\pi
Q^{\pi}(s,a)
Q^{\pi}(s,a)=\mathbb{E}_{\tau\sim p_{\pi}(\tau)}\left[\sum_{t^{\prime}=t}%
\gamma^{t^{\prime}-t}r_{t^{\prime}}|s_{t}=s,a_{t}=a\right].
Q^{\pi}
a^{*}(s)=\text{argmax}_{a}Q^{\pi}(s,a).
Q
Q^{\pi}(s,a)=r(s,a)+\gamma\sum_{s^{\prime}}p(s_{t+1}=s^{\prime}|s_{t}=s,a_{t}=%
a)\sum_{a^{\prime}}\pi(a^{\prime}|s^{\prime})Q^{\pi}(s^{\prime},a^{\prime}).
\pi^{g}(a|s):=I_{a=a^{*}(s)}
I_{a=b}=1
a=b
0
Q^{\pi^{g}}(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim p(s^{\prime}|s,a)}%
\left[\text{max}_{a^{\prime}}Q^{\pi^{g}}(s^{\prime},a^{\prime})\right].
\mathcal{L}\propto\left(Q(s,a)-(r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim p(s^{%
\prime}|s,a)}\left[\text{max}_{a^{\prime}}Q(s^{\prime},a^{\prime})\right])%
\right)^{2},
Q(s,a)
\displaystyle\Delta Q(s,a)\propto-Q(s,a)+r(s,a)+\gamma\mathbb{E}_{s^{\prime}%
\sim p(s^{\prime}|s,a)}\left[\text{max}_{a^{\prime}}Q(s^{\prime},a^{\prime})\right]
\displaystyle\Delta Q(s,a)
\displaystyle\propto-Q(s,a)+r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim p(s^{%
\prime}|s,a)}\left[\text{max}_{a^{\prime}}Q(s^{\prime},a^{\prime})\right]
\displaystyle\approx-Q(s_{t},a_{t})+r_{t}+\gamma\text{max}_{a^{\prime}}Q(s_{t+%
1},a^{\prime}).
\displaystyle\approx-Q(s_{t},a_{t})+r_{t}+\gamma\text{max}_{a^{\prime}}Q(s_{t+%
1},a^{\prime}).
\epsilon\in\{0,0.1,0.2\}
\alpha=0.05
\gamma=1
\epsilon=0
\alpha=1
\epsilon=0.3
\epsilon
\epsilon=0
\epsilon
0
a^{*}(s)=\text{argmax}_{a}Q(s,a)
\epsilon
\pi(a|s)=\epsilon/|\mathcal{A}|+(1-\epsilon)I_{a=a^{*}(s)}
\pi(a|s)\propto\text{exp}(\beta Q(s,a))
a_{t+1}
\displaystyle\Delta Q(s_{t},a_{t})\propto-Q(s_{t},a_{t})+r_{t}+\gamma Q(s_{t+1%
},a_{t+1}).
\displaystyle\Delta Q(s_{t},a_{t})\propto-Q(s_{t},a_{t})+r_{t}+\gamma Q(s_{t+1%
},a_{t+1}).
\pi
s
a
\tilde{p}(s^{\prime},r|s,a)
\displaystyle Q(s_{t},a_{t})\approx r(s_{t},a_{t})+\gamma\mathbb{E}_{\tilde{p}%
(s_{t+1}|s_{t},a_{t})}\left[\text{argmax}_{a_{t+1}}Q(s_{t+1},a_{t+1})\right]
\displaystyle Q(s_{t},a_{t})
\displaystyle\approx r(s_{t},a_{t})+\gamma\mathbb{E}_{\tilde{p}(s_{t+1}|s_{t},%
a_{t})}\left[\text{argmax}_{a_{t+1}}Q(s_{t+1},a_{t+1})\right]
\displaystyle\approx r(s_{t},a_{t})+\gamma\mathbb{E}_{\tilde{p}(s_{t+1}|s_{t},%
a_{t})}\left[\text{argmax}_{a_{t+1}}\left[r(s_{t+1},a_{t+1})+\gamma\mathbb{E}_%
{\tilde{p}(s_{t+2}|s_{t+1},a_{t+1})}\left[\text{argmax}_{a_{t+2}}Q(s_{t+2},a_{%
t+2})\right]\right]\right]
\displaystyle\approx r(s_{t},a_{t})+\gamma\mathbb{E}_{\tilde{p}(s_{t+1}|s_{t},%
a_{t})}\left[\text{argmax}_{a_{t+1}}\left[r(s_{t+1},a_{t+1})+\gamma\mathbb{E}_%
{\tilde{p}(s_{t+2}|s_{t+1},a_{t+1})}\left[\text{argmax}_{a_{t+2}}Q(s_{t+2},a_{%
t+2})\right]\right]\right]
\displaystyle=\ldots
\displaystyle=\ldots
p(s^{\prime}|s,a)
s_{t}
\epsilon=0
\alpha=1
\sigma=3
s
\displaystyle V^{\pi}(s)=\mathbb{E}_{\pi}\left[\sum_{t=0}\gamma^{t}r_{t}|s_{0}%
=s\right]
\displaystyle V^{\pi}(s)
\displaystyle=\mathbb{E}_{\pi}\left[\sum_{t=0}\gamma^{t}r_{t}|s_{0}=s\right]
\displaystyle=\sum_{t=0}\gamma^{t}\sum_{s^{\prime}}p_{\pi}(s_{t}=s^{\prime}|s_%
{0}=s)r(s^{\prime})
\displaystyle=\sum_{t=0}\gamma^{t}\sum_{s^{\prime}}p_{\pi}(s_{t}=s^{\prime}|s_%
{0}=s)r(s^{\prime})
\displaystyle=\sum_{s^{\prime}}r(s^{\prime})\sum_{t}\gamma^{t}p_{\pi}(s_{t}=s^%
{\prime}|s_{0}=s)
\displaystyle=\sum_{s^{\prime}}r(s^{\prime})\sum_{t}\gamma^{t}p_{\pi}(s_{t}=s^%
{\prime}|s_{0}=s)
\displaystyle=\bm{r}^{T}\bm{m}^{\pi}_{s}.
\displaystyle=\bm{r}^{T}\bm{m}^{\pi}_{s}.
\bm{r}
\bm{m}^{\pi}_{s}
s^{\prime}
s
\pi
M^{\pi}_{ss^{\prime}}=\sum_{t=0}\gamma^{t}p_{\pi}(s_{t}=s^{\prime}|s_{0}=s).
\bm{M}^{\pi}
\bm{m}^{\pi}_{s}
s
\bm{v}^{\pi}=\bm{M}^{\pi}\bm{r}.
\pi
\bm{r}\rightarrow\bm{r}^{\prime}
{\bm{v}^{\prime}}^{\pi}=\bm{M}^{\pi}\bm{r}^{\prime}.
\bm{M}
s_{t}
\Delta M^{\pi}_{s_{t}s^{\prime}}\propto-M^{\pi}_{s_{t}s^{\prime}}+I_{s_{t}=s^{%
\prime}}+\gamma M^{\pi}_{s_{t+1}s^{\prime}}.
{s^{\prime}}
s_{t+1}
s_{t}
s_{t+1}
s_{t}
s_{t+1}
s_{t+1}
\bm{T}^{\pi}
T^{\pi}_{ss^{\prime}}=p_{\pi}(s_{t+1}=s^{\prime}|s_{t}=s)
\bm{M}^{\pi}=\bm{I}+\gamma\bm{T}^{\pi}+\gamma^{2}(\bm{T}^{\pi})^{2}+\ldots=(%
\bm{I}-\gamma\bm{T}^{\pi})^{-1}
\bm{r}
\bm{M}
\bm{M}
s
s^{\prime}
s
s^{\prime}
s
s^{\prime}
s^{\prime}
(s_{t},a_{t},r_{t},s_{t+1},a_{t+1})
Q_{\theta}(s,a)
\theta
(s_{t},a_{t},r_{t},s_{t+1})
\mathcal{L}=0.5[Q_{\theta}(s_{t},a_{t})-(r_{t}+\gamma\text{max}_{a}Q_{\theta}(%
s_{t+1},a))]^{2}
\Delta\theta\propto-\frac{\partial\mathcal{L}}{\partial\theta}
\epsilon
\mathcal{B}
\text{max}_{a}Q_{\theta}(s_{t+1},a)
\theta
Q_{\theta^{\prime}}(s_{t+1},a)
(s_{t},a_{t},r_{t},s_{t+1})
\mathcal{B}
(s^{\prime}_{t},a^{\prime}_{t},r^{\prime}_{t},s^{\prime}_{t+1})\sim\mathcal{B}
\mathcal{L}(\theta)=0.5[Q_{\theta}(s^{\prime}_{t},a^{\prime}_{t})-(r^{\prime}_%
{t}+\gamma\text{max}_{a}Q_{\theta^{\prime}}(s^{\prime}_{t+1},a))]^{2}
\theta
\theta^{\prime}
\Delta\theta\propto-\frac{\partial\mathcal{L}(\theta)}{\partial\theta}
\theta^{\prime}\leftarrow\theta
\mathcal{B}
\mathcal{B}
Q_{\text{max}}(s^{\prime}_{t+1})=\text{max}_{a}Q_{\theta^{\prime}}(s^{\prime}_%
{t+1},a)
Q_{\text{max}}(s^{\prime}_{t+1})\leftarrow Q_{\theta^{\prime}}(s^{\prime}_{t+1%
},\text{argmax}_{a}(Q_{\theta}(s^{\prime}_{t+1},a)))
\theta
\pi_{\theta}
\theta
R_{\tau}:=\sum_{t=0}^{T}\gamma^{t}r_{t}
\displaystyle\nabla_{\theta}J(\theta)=\nabla_{\theta}\mathbb{E}_{\tau\sim p_{%
\pi_{\theta}}(\tau)}\left[R_{\tau}\right]
\displaystyle\nabla_{\theta}J(\theta)
\displaystyle=\nabla_{\theta}\mathbb{E}_{\tau\sim p_{\pi_{\theta}}(\tau)}\left%
[R_{\tau}\right]
\displaystyle=\sum_{\tau}R_{\tau}\nabla_{\theta}p_{\pi_{\theta}}(\tau).
\displaystyle=\sum_{\tau}R_{\tau}\nabla_{\theta}p_{\pi_{\theta}}(\tau).
\tau\sim p_{\pi_{\theta}}(\tau)
\pi_{\theta}
J(\theta)
R_{\tau}
p_{\pi_{\theta}}(\tau)
\nabla_{\theta}\log f(\theta)=f(\theta)^{-1}\nabla_{\theta}f(\theta)
\displaystyle\nabla_{\theta}J(\theta)=\sum_{\tau}R_{\tau}\nabla_{\theta}p_{\pi%
_{\theta}}(\tau)
\displaystyle\nabla_{\theta}J(\theta)
\displaystyle=\sum_{\tau}R_{\tau}\nabla_{\theta}p_{\pi_{\theta}}(\tau)
\displaystyle=\sum_{\tau}R_{\tau}p_{\pi_{\theta}}(\tau)\nabla_{\theta}\log p_{%
\pi_{\theta}}(\tau)
\displaystyle=\sum_{\tau}R_{\tau}p_{\pi_{\theta}}(\tau)\nabla_{\theta}\log p_{%
\pi_{\theta}}(\tau)
\displaystyle=\mathbb{E}_{\tau\sim p_{\pi_{\theta}}(\tau)}\left[R_{\tau}\nabla%
_{\theta}\log p_{\pi_{\theta}}(\tau)\right],
\displaystyle=\mathbb{E}_{\tau\sim p_{\pi_{\theta}}(\tau)}\left[R_{\tau}\nabla%
_{\theta}\log p_{\pi_{\theta}}(\tau)\right],
\theta
\nabla_{\theta}\log p_{\pi_{\theta}}(\tau)
\displaystyle\nabla_{\theta}\log p_{\pi_{\theta}}(\tau)=\nabla_{\theta}\left[%
\log p(s_{0})+\sum_{t=0}^{T}\log p(s_{t+1}|s_{t},a_{t})+\log\pi_{\theta}(a_{t}%
|s_{t})\right]
\displaystyle\nabla_{\theta}\log p_{\pi_{\theta}}(\tau)
\displaystyle=\nabla_{\theta}\left[\log p(s_{0})+\sum_{t=0}^{T}\log p(s_{t+1}|%
s_{t},a_{t})+\log\pi_{\theta}(a_{t}|s_{t})\right]
\displaystyle=\sum_{t=0}^{T}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t}).
\displaystyle=\sum_{t=0}^{T}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t}).
\displaystyle\nabla_{\theta}J(\theta)=\mathbb{E}_{\tau\sim p_{\pi_{\theta}}(%
\tau)}\left[R_{\tau}\sum_{t=0}^{T}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\right]
\displaystyle\nabla_{\theta}J(\theta)
\displaystyle=\mathbb{E}_{\tau\sim p_{\pi_{\theta}}(\tau)}\left[R_{\tau}\sum_{%
t=0}^{T}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\right]
\displaystyle\approx\frac{1}{N}\sum_{\tau\sim p_{\pi_{\theta}}(\tau)}\left(%
\sum_{t=0}^{T}\gamma^{t}r_{t}\right)\left(\sum_{t=0}^{T}\nabla_{\theta}\log\pi%
_{\theta}(a_{t}|s_{t})\right),
\displaystyle\approx\frac{1}{N}\sum_{\tau\sim p_{\pi_{\theta}}(\tau)}\left(%
\sum_{t=0}^{T}\gamma^{t}r_{t}\right)\left(\sum_{t=0}^{T}\nabla_{\theta}\log\pi%
_{\theta}(a_{t}|s_{t})\right),
N
t
t^{\prime}<t
R_{t}:=\sum_{t^{\prime}=t}^{T}\gamma^{t^{\prime}-t}r_{t^{\prime}}
\hat{\nabla}_{\theta}J(\theta)\approx\frac{1}{N}\sum_{\tau\sim p_{\pi_{\theta}%
}(\tau)}\sum_{t=0}^{T}R_{t}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t}).
R_{t}=\sum_{t^{\prime}=t}^{T}\gamma^{t^{\prime}-0}r_{t^{\prime}}
\gamma
\hat{\nabla}
R_{t}
V(s_{t})
\hat{\nabla}_{\theta}J(\theta)\approx\frac{1}{N}\sum_{\tau\sim p_{\pi_{\theta}%
}(\tau)}\sum_{t=0}^{T}(R_{t}-V(s_{t}))\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_%
{t}).
R_{t}\approx r_{t}+\gamma V(s_{t+1})
r_{t}+\gamma V(s_{t+1})
\sum_{t^{\prime}=t}^{T}\gamma^{t^{\prime}-t}r_{t^{\prime}}
(R_{t}-V(s_{t}))
A_{t}=r_{t}+\gamma V(s_{t+1})-V(s_{t})
R_{t}
R_{t}
R_{t^{\prime}}
V(s_{t^{\prime}})
V(s_{t^{\prime}})
\pi_{\theta}(a|s)
V_{\theta}(s)
\tilde{J}(\theta)=\frac{1}{N}\sum_{\tau\sim p_{\pi_{\theta}}(\tau)}\sum_{t=0}^%
{T}(R_{t}-V(s_{t}))\log\pi_{\theta}(a_{t}|s_{t}),
R_{t}
r_{t}+\gamma V(s_{t+1})
\tilde{J}(\theta)
\nabla_{\theta}\tilde{J}(\theta)=\hat{\nabla}_{\theta}J(\theta)
\delta_{t}:=(R_{t}-V(s_{t}))
\theta
\nabla_{\theta}\sum_{t}\frac{1}{2}(R_{t}-V_{\theta}(s_{t}))^{2}=\sum_{t}\left[%
-\delta_{t}\nabla_{\theta}V_{\theta}(s_{t})\right]
\mathcal{U}(0,1)
p(r|a=1)
p(r|a=2)=1-p(r|a=1)
p(r|a=1)
Z^{\pi}(s,a)
\pi
a
s
Z^{\pi}(s,a)\sim p_{z^{\pi}}\left(\sum_{t^{\prime}>=t}\gamma^{t^{\prime}-t}r_{%
t^{\prime}}|s_{t}=s,a_{t}=a\right)
Z^{\pi}
Z^{\pi}(s,a)
\mathbb{E}_{p_{z^{\pi}}}\left[Z^{\pi}(s,a)\right]=Q^{\pi}(s,a).
p_{z^{\pi}}(Z^{\pi}(s,a))
\tau\textsuperscript{th}
p_{z^{\pi}}(Z^{\pi}(s,a))
\epsilon_{\tau}
Z
\tau\mathbb{E}[\text{max}(0,Z-\epsilon_{\tau})]=(1-\tau)\mathbb{E}[\text{max}(%
0,\epsilon_{\tau}-Z)].
\tau=0.5
p_{z^{\pi}}(Z^{\pi}(s,a))
\{\epsilon_{\tau}\}
\{V_{\tau_{i}}(s)\}
\tau_{i}:=\frac{\alpha_{i}^{+}}{\alpha_{i}^{+}+\alpha_{i}^{-}}
p_{z^{\pi}}(Z^{\pi}(s))
p_{z^{\pi}}(Z^{\pi}(s))=\sum_{a}\left[\pi(a|s)p_{z^{\pi}}(Z^{\pi}(s))\right]
\displaystyle\delta_{i}:=r_{t}+\gamma\tilde{Z}^{\pi}_{j}(s_{t+1})-V_{\tau_{i}}%
(s_{t}).
\displaystyle\delta_{i}:=r_{t}+\gamma\tilde{Z}^{\pi}_{j}(s_{t+1})-V_{\tau_{i}}%
(s_{t}).
\tilde{Z}^{\pi}_{j}(s_{t+1})
s_{t+1}
p_{\{V_{\tau_{i}}\}}(\tilde{Z}^{\pi}(s_{t+1}))
\Delta V_{\tau_{i}}(s_{t})=\alpha_{i}^{+}\text{max}(\delta_{i},0)+\alpha_{i}^{%
-}\text{min}(\delta_{i},0).
\alpha_{i}^{+}
\alpha_{i}^{-}
V_{\tau_{i}}(s)
\tau_{i}\textsuperscript{th}
\epsilon_{\tau_{i}}
p_{z^{\pi}}(Z^{\pi}(s,a))
\nabla_{\theta}\mathcal{L}=\sum_{i}\Delta V_{\tau_{i}}(s_{t})\partial V_{\tau_%
{i}}(s_{t})/\partial\theta
\theta
V_{\tau_{i}}
\tau_{i}=0.5
\tau_{i}=\frac{\alpha_{i}^{+}}{\alpha_{i}^{+}+\alpha_{i}^{-}}
p_{\{V_{\tau_{i}}\}}(\tilde{Z}^{\pi}(s))
V_{\tau_{i}}
i
\tau_{i}=\frac{\alpha_{i}^{+}}{\alpha_{i}^{+}+\alpha_{i}^{-}}
\sigma=0.1
\{V_{\tau_{i}}\}
V_{\tau_{i}}=0.5
r=0.5
i
V_{\tau_{i}}\approx\epsilon_{\tau_{i}}
V_{\tau_{i}}
\alpha_{i}^{+}
\alpha_{i}^{-}
i
\tau_{i}=\frac{\alpha_{i}^{+}}{\alpha_{i}^{-}+\alpha_{i}^{+}}
V_{\tau_{i}}\approx\epsilon_{\tau_{i}}
p_{\{V_{\tau_{i}}\}}(\tilde{Z}^{\pi}(s))
\{V_{\tau_{i}}(s)\}
\epsilon
\mathcal{L}_{E}=\sum_{\tau\sim p_{\pi_{\theta}}(\tau)}\sum_{t=0}^{T}\sum_{a}%
\pi_{\theta}(a_{t}|s_{t})\log\pi_{\theta}(a_{t}|s_{t})
\epsilon
\mathcal{L}_{ctrl}(s)=KL\left[u(s^{\prime}|s)||p(s^{\prime}|s)\right],
p(s^{\prime}|s)
u(s^{\prime}|s)
\mathcal{L}_{ctrl}(s)
u(s^{\prime}|s)=0
p(s^{\prime}|s)=0
u
