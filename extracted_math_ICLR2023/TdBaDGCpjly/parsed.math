{o}_{t-\ell}
{z}_{t-\ell}
{\hat{o}}_{t-\ell}
h_{t-\ell}
{a}_{t-\ell}
{h}_{t-\ell}
{r}_{t-\ell}
h_{t-\ell}
\cdots
\cdots
{o}_{t-1}
{z}_{t-1}
{\hat{o}}_{t-1}
h_{t-1}
{a}_{t-1}
{h}_{t-1}
{r}_{t-1}
h_{t-1}
{o}_{t}
{z}_{t}
{\hat{o}}_{t}
h_{t}
{a}_{t}
{h}_{t}
{\hat{r}}_{t}
\hat{\gamma}_{t}
{\hat{z}}_{t+1}
o_{t-\ell:t}
z_{t-\ell:t}
a_{t-\ell:t}
r_{t-\ell:t}
h_{t}
r_{t}
\gamma_{t}
z_{t+1}
h_{t}
o_{t-\ell:t}
z_{t-\ell:t}
a_{t-\ell:t}
r_{t-\ell:t}
h_{t}
r_{t}
\gamma_{t}
z_{t+1}
h_{t}
t\in\mathbb{N}
r_{t}\in\mathbb{R}
o_{t}\in\mathbb{R}^{h\times w\times c}
a_{t}\in\{1,\ldots,m\}
a_{t}\sim\pi(a_{t}\>\lvert\>o_{1:t},a_{1:t-1})
o_{1:t}
a_{1:t-1}
t
t-1
d_{t}\in\{0,1\}
o_{t},r_{t},d_{t}\sim p(o_{t},r_{t},d_{t}\>\lvert\>o_{1:t-1},a_{1:t-1})
\pi
\mathbb{E}_{\pi\!}\big{[}\sum_{t=1}^{\infty}\gamma^{t-1}r_{t}\big{]}\!
\gamma\in[0,1)
o_{t}
z_{t}
z_{t}
\displaystyle z_{t}\sim p_{\phi}(z_{t}\>\lvert\>o_{t})
\displaystyle z_{t}
\displaystyle\sim p_{\phi}(z_{t}\>\lvert\>o_{t})
\displaystyle\hat{o}_{t}\sim p_{\phi}(\hat{o}_{t}\>\lvert\>z_{t}).
\displaystyle\hat{o}_{t}
\displaystyle\sim p_{\phi}(\hat{o}_{t}\>\lvert\>z_{t}).
z_{t}
32
32
o_{t}
f_{\psi}
h_{t}
\ell
\displaystyle\quad h_{t}=f_{\psi}(z_{t-\ell:t},a_{t-\ell:t},r_{t-\ell:t-1})
\displaystyle\quad h_{t}
\displaystyle=f_{\psi}(z_{t-\ell:t},a_{t-\ell:t},r_{t-\ell:t-1})
\displaystyle\quad\hat{r}_{t}\sim p_{\psi}(\hat{r}_{t}\>\lvert\>h_{t})
\displaystyle\quad\hat{r}_{t}
\displaystyle\sim p_{\psi}(\hat{r}_{t}\>\lvert\>h_{t})
\displaystyle\quad\hat{\gamma}_{t}\sim p_{\psi}(\hat{\gamma}_{t}\>\lvert\>h_{t})
\displaystyle\quad\hat{\gamma}_{t}
\displaystyle\sim p_{\psi}(\hat{\gamma}_{t}\>\lvert\>h_{t})
\displaystyle\quad\hat{z}_{t+1}\sim p_{\psi}(\hat{z}_{t+1}\>\lvert\>h_{t}).
\displaystyle\quad\hat{z}_{t+1}
\displaystyle\sim p_{\psi}(\hat{z}_{t+1}\>\lvert\>h_{t}).
3\ell-1
p_{\psi}(\hat{z}_{t+1}\>\lvert\>h_{t})
p_{\psi}(\hat{r}_{t}\>\lvert\>h_{t})
p_{\psi}(\hat{\gamma}_{t}\>\lvert\>h_{t})
H\lparen p_{\phi}(z_{t+1}\>\lvert\>o_{t+1}),p_{\psi}(\hat{z}_{t+1}\>\lvert\>h_%
{t})\rparen
H\lparen p_{\phi}(z_{t}\>\lvert\>o_{t})\rparen
\mathcal{L}_{\phi}^{\text{Obs.}}=\mathbb{E}_{\!}\bigg{[}\,\operatorname*{%
\textstyle\sum}_{t=1}^{T}-\underbrace{\ln p_{\phi}(o_{t}\>\lvert\>z_{t})}_{%
\text{decoder}}-\underbrace{\alpha_{1}H\lparen p_{\phi}(z_{t}\>\lvert\>o_{t})%
\rparen}_{\text{entropy regularizer}}+\underbrace{\alpha_{2}H\lparen p_{\phi}(%
z_{t}\>\lvert\>o_{t}),p_{\psi}(\hat{z}_{t}\>\lvert\>h_{t-1})\rparen}_{\text{%
consistency}}\bigg{]}\!,
\alpha_{1},\alpha_{2}\geq 0
\mathcal{L}_{\psi}^{\text{Dyn.}}=\mathbb{E}_{\!}\bigg{[}\,\operatorname*{%
\textstyle\sum}_{t=1}^{T}\underbrace{H\lparen p_{\phi}(z_{t+1}\>\lvert\>o_{t+1%
}),p_{\psi}(\hat{z}_{t+1}\>\lvert\>h_{t})\rparen}_{\text{latent state %
predictor}}-\underbrace{\beta_{1}\ln p_{\psi}(r_{t}\>\lvert\>h_{t})}_{\text{%
reward predictor}}-\underbrace{\beta_{2}\ln p_{\psi}(\gamma_{t}\>\lvert\>h_{t}%
)}_{\text{discount predictor}}\,\bigg{]}\!,
\beta_{1},\beta_{2}\geq 0
\gamma_{t}=0
d_{t}=1
\gamma_{t}=\gamma
\pi_{\theta}(a_{t}\>\lvert\>\hat{z}_{t})
a_{t}\sim\pi_{\theta}(a_{t}\>\lvert\>\hat{z}_{t})
\theta
v_{\xi}(\hat{z}_{t})
\xi
\hat{\gamma}_{t}
\mathcal{L}^{\text{Ent.}}_{\theta}=\max\!\left(0,\Gamma-\frac{H(\pi_{\theta})}%
{\ln(m)}\right),
0\leq\Gamma\leq 1
H(\pi_{\theta})
m
\ln(m)
\epsilon
\pi_{\theta}(a_{t}\>\lvert\>x_{t})
x_{t}
x_{t}
o_{t}
z_{t}
[z_{t},h_{t}]
\hat{o}_{t}
\hat{z}_{t}
[\hat{z}_{t},h_{t}]
x_{t}=o_{t}
\hat{o}_{t}
\hat{o}_{t}
p(o)
x_{t}=z_{t}
\hat{z}_{t}
p_{\phi}(z_{t}\>\lvert\>o_{t})
p_{\psi}(\hat{z}_{t+1}\>\lvert\>h_{t})
x_{t}=[z_{t},h_{t}]
[\hat{z}_{t},h_{t}]
x_{t}=z_{t}
x_{t}=\hat{z}_{t}
\mathcal{D}=[(o_{1},a_{1},r_{1},d_{1}),\ldots,(o_{T},a_{T},r_{T},d_{T})]
N
\ell
\mathcal{D}
M
N\times\ell
M
H
v_{1},\ldots,v_{T}
(p_{1},\ldots,p_{T})=\mathrm{softmax}\left(-\tfrac{v_{1}}{\tau},\dots,{-\tfrac%
{v_{T}}{\tau}}\right),
\tau>0
\tau=\infty
\tau
\tau
\tau=\infty
\mathcal{D}
50\%
19
\tau=20
\tau
\tau=\infty
\mathcal{D}
50\%
19
\tau=20
26
100
400
2
500
200
95\%
100
5
5
95\%
100
5
5
95\%
95\%
100
\varepsilon
\varepsilon
5
100
5
100
5
100
\varepsilon
h
h
\tau=\infty
[z,h]
50
50
50
25
\ell=16
\eta=0.01
\Gamma=0.1
\eta=0.001
\Gamma=1.0
\eta
\ell=4
\ell=16
x=z
x=[z,h]
h
10
25
50
100
25
50
25
50
5
10
25
50
75
100
10
15.5
1.5
20
23.3
1
[z,h]
3
z
z
[z,h]
230
230
\hat{z}_{t}
\hat{z}_{t}
\Gamma=1
\Gamma=1
\ell=16
\ell=4
\ell=4
\ell=16
\ell=4
\ell=4
[z,h]
z
[z,h]
z
50
50
q_{\theta}
p_{\theta}
\theta
\lambda\,D_{\text{KL}}(\text{sg}\lparen q_{\theta}\rparen\;\|\;p_{\theta})+(1-%
\lambda)\,D_{\text{KL}}(q_{\theta}\;\|\;\text{sg}\lparen p_{\theta}\rparen),
\text{sg}\lparen\cdot\rparen
\lambda\in[0,1]
D_{\text{KL}}(q\;\|\;p)=H\lparen q,p\rparen-H\lparen q\rparen
H\lparen q,p\rparen
p
q
\displaystyle\nabla_{\theta}\left[\lambda\,D_{\text{KL}}(\text{sg}\lparen q_{%
\theta}\rparen\;\|\;p_{\theta})+(1-\lambda)\,D_{\text{KL}}(q_{\theta}\;\|\;%
\text{sg}\lparen p_{\theta}\rparen)\right]
\displaystyle\nabla_{\theta}\left[\lambda\,D_{\text{KL}}(\text{sg}\lparen q_{%
\theta}\rparen\;\|\;p_{\theta})+(1-\lambda)\,D_{\text{KL}}(q_{\theta}\;\|\;%
\text{sg}\lparen p_{\theta}\rparen)\right]
\displaystyle={}\nabla_{\theta}\left[\lambda\left(H\lparen\text{sg}\lparen q_{%
\theta}\rparen,p_{\theta}\rparen-H\lparen\text{sg}\lparen q_{\theta}\rparen%
\rparen\right)+(1-\lambda)\left(H\lparen q_{\theta},\text{sg}\lparen p_{\theta%
}\rparen\rparen-H\lparen q_{\theta}\rparen\right)\right]
\displaystyle={}
\displaystyle\nabla_{\theta}\left[\lambda\left(H\lparen\text{sg}\lparen q_{%
\theta}\rparen,p_{\theta}\rparen-H\lparen\text{sg}\lparen q_{\theta}\rparen%
\rparen\right)+(1-\lambda)\left(H\lparen q_{\theta},\text{sg}\lparen p_{\theta%
}\rparen\rparen-H\lparen q_{\theta}\rparen\right)\right]
\displaystyle={}\nabla_{\theta}\left[\lambda_{1}\,H\lparen\text{sg}\lparen q_{%
\theta}\rparen,p_{\theta}\rparen+\lambda_{2}\,H\lparen q_{\theta},\text{sg}%
\lparen p_{\theta}\rparen\rparen-\lambda_{3}\,H\lparen q_{\theta}\rparen\right%
]\!,
\displaystyle={}
\displaystyle\nabla_{\theta}\left[\lambda_{1}\,H\lparen\text{sg}\lparen q_{%
\theta}\rparen,p_{\theta}\rparen+\lambda_{2}\,H\lparen q_{\theta},\text{sg}%
\lparen p_{\theta}\rparen\rparen-\lambda_{3}\,H\lparen q_{\theta}\rparen\right%
]\!,
\nabla_{\theta}H\lparen\text{sg}\lparen q_{\theta}\rparen\rparen=0
\lambda_{1}=\lambda
\lambda_{2}=1-\lambda
\lambda_{3}=1-\lambda
100
H
\tau
\gamma
\lambda
N
\ell
M
H
\alpha_{1}
\alpha_{2}
\beta_{1}
\beta_{2}
\eta
\Gamma
100
4
64\times 64
4
108
30
0.0001
0.0001
0.0001
0.00001
256
10
4\times 64
1024
4\times 512
4\times 256
4\times 256
4\times 512
4\times 512
\phi
8.2
\psi
10.8
\theta
1.3
\xi
1.3
19
2.6
21.6
4.4
