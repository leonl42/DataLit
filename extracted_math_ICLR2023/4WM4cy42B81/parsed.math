U_{dis}
U_{data}
U_{dis}
U_{data}
\mathcal{S}=\{\boldsymbol{x}^{s}_{i},y^{s}_{i}\}_{i=1}^{n_{s}}
\mathcal{T}=\{\boldsymbol{x}^{t}_{j}\}_{j=1}^{n_{t}}
y^{s}_{i}\in\{1,2,\cdots,C\}
\boldsymbol{x}^{s}_{i}
C
\mathcal{Y}=\{1,2,\cdots,C\}
\mathcal{T}^{l}
\varnothing
b
\mathcal{T}^{l}
\mathcal{T}=\mathcal{T}^{l}\cup\mathcal{T}^{u}
\mathcal{T}^{u}
B
C
\mathcal{X}
f
\boldsymbol{\theta}
\boldsymbol{x}\in\mathcal{X}
C
f:\mathcal{X}\to\mathbb{R}^{C}
f
\boldsymbol{\rho}
\boldsymbol{\rho}=[\rho_{1},\rho_{2},\cdots,\rho_{C}]^{\top}=[P(y=1),P(y=2),%
\cdots,P(y=C)]^{\top}
\boldsymbol{\rho}
\boldsymbol{\rho}
\boldsymbol{\rho}
\boldsymbol{\rho}
\boldsymbol{\rho}
\boldsymbol{x}_{i}
\boldsymbol{\rho}
\displaystyle p(\boldsymbol{\rho|\boldsymbol{x}_{i},\boldsymbol{\theta}})=Dir(%
\boldsymbol{\rho}|\boldsymbol{\alpha}_{i})=\left\{\begin{array}[]{r}\frac{%
\Gamma(\sum_{c=1}^{C}\alpha_{ic})}{\prod_{c=1}^{C}\Gamma(\alpha_{ic})}\prod_{c%
=1}^{C}\rho_{c}^{\alpha_{ic}-1},\quad if\;\boldsymbol{\rho}\in\triangle^{C}\\
0\qquad\qquad\quad,\quad otherwise\end{array}\right.,\quad\alpha_{ic}>0,
\displaystyle p(\boldsymbol{\rho|\boldsymbol{x}_{i},\boldsymbol{\theta}})=Dir(%
\boldsymbol{\rho}|\boldsymbol{\alpha}_{i})=\left\{\begin{array}[]{r}\frac{%
\Gamma(\sum_{c=1}^{C}\alpha_{ic})}{\prod_{c=1}^{C}\Gamma(\alpha_{ic})}\prod_{c%
=1}^{C}\rho_{c}^{\alpha_{ic}-1},\quad if\;\boldsymbol{\rho}\in\triangle^{C}\\
0\qquad\qquad\quad,\quad otherwise\end{array}\right.,\quad\alpha_{ic}>0,
\boldsymbol{\alpha}_{i}
\boldsymbol{x}_{i}
\Gamma(\cdot)
\triangle^{C}
C
\triangle^{C}=\{\boldsymbol{\rho}|\sum_{c=1}^{C}\rho_{c}=1\;\mathrm{and}\;%
\forall\rho_{c},0\leq\rho_{c}\leq 1\}
\boldsymbol{\alpha}_{i}
\boldsymbol{\alpha}_{i}=g(f(\boldsymbol{x}_{i},\boldsymbol{\theta}))
g(\cdot)
\boldsymbol{\alpha}_{i}
\boldsymbol{\alpha}_{i}
\boldsymbol{x}_{i}
\boldsymbol{e}_{i}=\boldsymbol{\alpha}_{i}-\mathbf{1}
\boldsymbol{e}_{i}
\boldsymbol{\rho}
\boldsymbol{\alpha}_{i}
\boldsymbol{x}_{i}
c
\boldsymbol{\rho}
\displaystyle P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})\!=\!\!\int\!p(y=c|%
\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_{i},\boldsymbol{\theta})d%
\boldsymbol{\rho}\!=\!\frac{\alpha_{ic}}{\sum_{k=1}^{C}\alpha_{ik}}\!=\!\frac{%
g(f_{c}(\boldsymbol{x}_{i},\boldsymbol{\theta}))}{\sum_{k=1}^{C}g(f_{k}(%
\boldsymbol{x}_{i},\boldsymbol{\theta}))}\!=\!\mathbb{E}[Dir(\rho_{c}|%
\boldsymbol{\alpha}_{i})].
\displaystyle P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})\!=\!\!\int\!p(y=c|%
\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_{i},\boldsymbol{\theta})d%
\boldsymbol{\rho}\!=\!\frac{\alpha_{ic}}{\sum_{k=1}^{C}\alpha_{ik}}\!=\!\frac{%
g(f_{c}(\boldsymbol{x}_{i},\boldsymbol{\theta}))}{\sum_{k=1}^{C}g(f_{k}(%
\boldsymbol{x}_{i},\boldsymbol{\theta}))}\!=\!\mathbb{E}[Dir(\rho_{c}|%
\boldsymbol{\alpha}_{i})].
g(\cdot)
U_{dis}
U_{data}
\boldsymbol{\alpha}
\kappa b
U_{dis}
U_{data}
b
B
U_{dis}
U_{data}
\boldsymbol{\alpha}
\kappa b
U_{dis}
U_{data}
b
B
U_{dis}
\boldsymbol{x}_{j}
\displaystyle U_{dis}(\boldsymbol{x}_{j},\boldsymbol{\theta})\triangleq I[y,%
\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]=\sum_{c=1}^{C}\bar{%
\rho}_{jc}\bigg{(}\psi(\alpha_{jc}+1)-\psi(\sum_{k=1}^{C}\alpha_{jk}+1)\bigg{)%
}-\sum_{c=1}^{C}\bar{\rho}_{jc}\mathrm{log}\bar{\rho}_{jc},
\displaystyle U_{dis}(\boldsymbol{x}_{j},\boldsymbol{\theta})\triangleq I[y,%
\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]=\sum_{c=1}^{C}\bar{%
\rho}_{jc}\bigg{(}\psi(\alpha_{jc}+1)-\psi(\sum_{k=1}^{C}\alpha_{jk}+1)\bigg{)%
}-\sum_{c=1}^{C}\bar{\rho}_{jc}\mathrm{log}\bar{\rho}_{jc},
\boldsymbol{\theta}
\psi(\cdot)
\bar{\rho}_{jc}=\mathbb{E}[Dir(\rho_{c}|\boldsymbol{\alpha}_{j})]
U_{dis}
\boldsymbol{x}_{j}
\boldsymbol{\theta}
U_{data}
\displaystyle U_{data}(\boldsymbol{x}_{j},\boldsymbol{\theta})\triangleq%
\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})}\left[%
H[P(y|\boldsymbol{\rho})]\right]=\sum_{c=1}^{C}\bar{\rho}_{jc}\bigg{(}\psi(%
\sum_{k=1}^{C}\alpha_{jk}+1)-\psi(\alpha_{jc}+1)\bigg{)}.
\displaystyle U_{data}(\boldsymbol{x}_{j},\boldsymbol{\theta})\triangleq%
\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})}\left[%
H[P(y|\boldsymbol{\rho})]\right]=\sum_{c=1}^{C}\bar{\rho}_{jc}\bigg{(}\psi(%
\sum_{k=1}^{C}\alpha_{jk}+1)-\psi(\alpha_{jc}+1)\bigg{)}.
H[\mathbb{E}[Dir(\boldsymbol{\rho}|\boldsymbol{\alpha}_{j})]]
U_{dis}
U_{data}
\kappa b
U_{dis}
U_{data}
b
U_{dis},U_{data}
\boldsymbol{x}_{j}
H[P(y|\boldsymbol{x}_{j},\boldsymbol{\theta})]=H[\mathbb{E}[Dir(\boldsymbol{%
\rho}|\boldsymbol{\alpha}_{j})]]=-\sum_{c=1}^{C}\bar{\rho}_{jc}\mathrm{log}%
\bar{\rho}_{jc},
\bar{\rho}_{jc}=\mathbb{E}[Dir(\rho_{c}|\boldsymbol{\alpha}_{j})]
U_{dis}(\boldsymbol{x}_{j},\boldsymbol{\theta})+U_{data}(\boldsymbol{x}_{j},%
\boldsymbol{\theta})=H[P(y|\boldsymbol{x}_{j},\boldsymbol{\theta})]
\mathcal{L}_{nll}
\mathcal{L}_{KL}
\mathcal{L}_{nll}
\displaystyle\mathcal{L}_{nll}=\frac{1}{n_{s}}\sum_{\boldsymbol{x}_{i}\in%
\mathcal{S}}-\mathrm{log}\left(\int p(y=y_{i}|\boldsymbol{\rho})p(\boldsymbol{%
\rho}|\boldsymbol{x}_{i},\boldsymbol{\theta})d\boldsymbol{\rho}\right)+\frac{1%
}{|\mathcal{T}^{l}|}\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{l}}-\mathrm{log}%
\left(\int p(y=y_{j}|\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_{j},%
\boldsymbol{\theta})d\boldsymbol{\rho}\right)
\displaystyle\mathcal{L}_{nll}
\displaystyle=\frac{1}{n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}-\mathrm{%
log}\left(\int p(y=y_{i}|\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_%
{i},\boldsymbol{\theta})d\boldsymbol{\rho}\right)+\frac{1}{|\mathcal{T}^{l}|}%
\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{l}}-\mathrm{log}\left(\int p(y=y_{j}|%
\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})d%
\boldsymbol{\rho}\right)
\displaystyle=\frac{1}{n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}\sum_{c=1}%
^{C}\Upsilon_{ic}\bigg{(}\mathrm{log}\big{(}\sum_{c=1}^{C}\alpha_{ic}\big{)}-%
\mathrm{log}\alpha_{ic}\bigg{)}+\frac{1}{|\mathcal{T}^{l}|}\sum_{\boldsymbol{x%
}_{j}\in\mathcal{T}^{l}}\sum_{c=1}^{C}\Upsilon_{jc}\bigg{(}\mathrm{log}\big{(}%
\sum_{c=1}^{C}\alpha_{jc}\big{)}-\mathrm{log}\alpha_{jc}\bigg{)},
\displaystyle=\frac{1}{n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}\sum_{c=1}%
^{C}\Upsilon_{ic}\bigg{(}\mathrm{log}\big{(}\sum_{c=1}^{C}\alpha_{ic}\big{)}-%
\mathrm{log}\alpha_{ic}\bigg{)}+\frac{1}{|\mathcal{T}^{l}|}\sum_{\boldsymbol{x%
}_{j}\in\mathcal{T}^{l}}\sum_{c=1}^{C}\Upsilon_{jc}\bigg{(}\mathrm{log}\big{(}%
\sum_{c=1}^{C}\alpha_{jc}\big{)}-\mathrm{log}\alpha_{jc}\bigg{)},
\Upsilon_{ic}/\Upsilon_{jc}
c
\boldsymbol{\Upsilon}_{i}/\boldsymbol{\Upsilon}_{j}
\boldsymbol{x}_{i}/\boldsymbol{x}_{j}
\mathcal{L}_{nll}
\mathcal{L}_{kl}
\displaystyle\mathcal{L}_{kl}=\frac{1}{C\cdot n_{s}}\sum_{\boldsymbol{x}_{i}%
\in\mathcal{S}}KL\big{[}Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})%
\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]}+\frac{1}{C\cdot|\mathcal{T}^{l%
}|}\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{l}}KL\big{[}Dir(\boldsymbol{\rho}|%
\boldsymbol{\tilde{\alpha}}_{j})\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]},
\displaystyle\mathcal{L}_{kl}
\displaystyle=\frac{1}{C\cdot n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}KL%
\big{[}Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})\lVert Dir(%
\boldsymbol{\rho}|\mathbf{1})\big{]}+\frac{1}{C\cdot|\mathcal{T}^{l}|}\sum_{%
\boldsymbol{x}_{j}\in\mathcal{T}^{l}}KL\big{[}Dir(\boldsymbol{\rho}|%
\boldsymbol{\tilde{\alpha}}_{j})\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]},
\boldsymbol{\tilde{\alpha}}_{i/j}=\boldsymbol{\Upsilon}_{i/j}+(\mathbf{1}-%
\boldsymbol{\Upsilon}_{i/j})\bigodot\boldsymbol{\alpha}_{i/j}
\bigodot
\boldsymbol{\tilde{\alpha}}_{i/j}
\mathcal{L}_{kl}
C
\mathcal{L}_{un}
\displaystyle\mathcal{L}_{un}=\beta\mathcal{L}_{U_{dis}}+\lambda\mathcal{L}_{U%
_{data}}=\frac{\beta}{|\mathcal{T}^{u}|}\sum_{\boldsymbol{x}_{k}\in\mathcal{T}%
^{u}}U_{dis}(\boldsymbol{x}_{k},\boldsymbol{\theta})+\frac{\lambda}{|\mathcal{%
T}^{u}|}\sum_{\boldsymbol{x}_{k}\in\mathcal{T}^{u}}U_{data}(\boldsymbol{x}_{k}%
,\boldsymbol{\theta}),
\displaystyle\mathcal{L}_{un}
\displaystyle=\beta\mathcal{L}_{U_{dis}}+\lambda\mathcal{L}_{U_{data}}=\frac{%
\beta}{|\mathcal{T}^{u}|}\sum_{\boldsymbol{x}_{k}\in\mathcal{T}^{u}}U_{dis}(%
\boldsymbol{x}_{k},\boldsymbol{\theta})+\frac{\lambda}{|\mathcal{T}^{u}|}\sum_%
{\boldsymbol{x}_{k}\in\mathcal{T}^{u}}U_{data}(\boldsymbol{x}_{k},\boldsymbol{%
\theta}),
\beta
\lambda
\displaystyle\mathcal{L}_{total}=\mathcal{L}_{edl}+\mathcal{L}_{un}=(\mathcal{%
L}_{nll}+\mathcal{L}_{kl})+(\beta\mathcal{L}_{U_{dis}}+\lambda\mathcal{L}_{U_{%
data}}).
\displaystyle\mathcal{L}_{total}=\mathcal{L}_{edl}+\mathcal{L}_{un}=(\mathcal{%
L}_{nll}+\mathcal{L}_{kl})+(\beta\mathcal{L}_{U_{dis}}+\lambda\mathcal{L}_{U_{%
data}}).
\mathcal{L}_{nll},\mathcal{L}_{kl}
\mathcal{L}_{U_{dis}}
\mathcal{O}(|\mathcal{T}^{u}|\mathrm{log}|\mathcal{T}^{u}|)
\mathcal{O}((\kappa b)\mathrm{log}(\kappa b))
\mathcal{O}(|\mathcal{T}^{u}|\mathrm{log}|\mathcal{T}^{u}|)+\mathcal{O}((%
\kappa b)\mathrm{log}(\kappa b))
r
\sum_{m=1}^{r}(\mathcal{O}(|\mathcal{T}^{u}_{m}|\mathrm{log}|\mathcal{T}^{u}_{%
m}|)+\mathcal{O}((\kappa b)\mathrm{log}(\kappa b)))
\mathcal{T}^{u}_{m}
m
r
5
\kappa b\leq|\mathcal{T}^{u}_{m}|\leq n_{t}
\mathcal{O}(n_{t}\mathrm{log}n_{t})
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\pm{0.4}
\pm{0.5}
\pm{0.5}
\pm{0.6}
\pm{0.3}
\pm{0.3}
\pm{0.7}
\pm{0.4}
\pm{0.4}
\pm{0.3}
\pm{0.5}
\pm{0.3}
\pm{0.4}
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm{0.3}
\pm{0.2}
\pm{0.4}
\pm{0.4}
\pm{0.2}
\pm{0.3}
\pm{0.3}
\pm{0.5}
\pm{0.2}
\pm{0.2}
\pm{0.3}
\pm{0.1}
\pm{0.3}
\to
\to
B
5\%
b=B\verb|/|5=1\%\times n_{t}
\beta=1.0,\lambda=0.05,\kappa=10
5\%
\beta=1.0,\lambda=0.01,\kappa=10
\pm
\to
\to
\to
\to
1.3\%
88.9\%
\to
\uparrow
\uparrow
\to
\mathcal{L}_{U_{dis}}
\mathcal{L}_{U_{data}}
U_{dis}
U_{data}
\mathcal{L}_{U_{dis}}
\mathcal{L}_{U_{data}}
\mathcal{L}_{U_{data}}
U_{data}
U_{dis}
U_{dis}
U_{data}
\%
\mathcal{L}_{U_{dis}}
\mathcal{L}_{U_{data}}
1.6\%
U_{dis}
U_{data}
\mathrm{log}U_{dis}
\mathrm{log}U_{dis}
\mathrm{log}U_{dis}
Ar\to Cl
Cl\to Ar
U_{dis}
\mathrm{log}U_{dis}
Ar\to Cl
Cl\to Ar
U_{dis}
U_{dis}
U_{dis}
\mathcal{L}_{edl}
U_{dis}
U_{dis}
U_{dis}
\kappa
\kappa
\kappa
\kappa=1
\kappa=100
U_{dis}
U_{data}
\kappa\in\{10,20,30\}
\kappa\%
\beta
\lambda
\kappa\%
\beta
\lambda
\beta
\lambda
\mathcal{L}_{U_{dis}}
\mathcal{L}_{U_{data}}
\beta\in\{0.01,0.05,0.1,0.5,1.0\}
\lambda\in\{0.001,0.005,0.01,0.05,0.1\}
\beta
\lambda
\lambda\in\{0.01,0.05,0.1\}
\mathcal{S}
\mathcal{T}
R
B
\kappa,\beta,\lambda
T
\boldsymbol{\theta}
\boldsymbol{\theta}
\mathcal{T}^{l}=\varnothing
\mathcal{T}^{u}=\mathcal{T}
b=\frac{B}{|R|}
t=1
T
\boldsymbol{\theta}
\mathcal{L}_{total}
t\in R
\forall\boldsymbol{x}_{j}\in\mathcal{T}^{u}
U_{dis}(\boldsymbol{x}_{j},\boldsymbol{\theta}),U_{data}(\boldsymbol{x}_{j},%
\boldsymbol{\theta})
temp\_Candi
\leftarrow
\kappa b
U_{dis}
\mathcal{T}^{u}
{Candi}
\leftarrow
b
U_{data}
temp\_Candi
Candi
\mathcal{T}^{u}=\mathcal{T}^{u}\backslash Candi
\mathcal{T}^{l}=\mathcal{T}^{l}\cup Candi
\boldsymbol{\theta}
\to
\cdots
\to
\to
\times
\times
\times
B
B
B
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\mathcal{L}_{nll}^{fixmatch}
\boldsymbol{\alpha}
B
5\%
b=B\verb|/|5=1\%\times n_{t}
\beta=1.0,\lambda=0.05,\kappa=10
B
5\%
\times
\times
\beta=1.0,\lambda=0.01,\kappa=10
U_{dis},U_{data}
U_{dis},U_{data}
U_{dis},U_{data}
U_{dis},U_{data}
U_{data},U_{dis}
\to
\to
U_{dis},U_{data}
U_{data},U_{dis}
U_{dis}
U_{data}
U_{dis},U_{data}
U_{dis}
U_{data}
U_{dis},U_{data}
U_{data},U_{dis}
U_{dis},U_{data}
B
\boldsymbol{x}_{j}
\boldsymbol{x}^{strong}_{j}
\boldsymbol{x}^{weak}_{j}
\boldsymbol{x}^{weak}_{j}
\boldsymbol{x}^{strong}_{j}
\mathcal{L}_{nll}^{fixmatch}
\mathcal{L}_{nll}^{fixmatch}
\displaystyle\mathcal{L}_{nll}^{fixmatch}=\frac{1}{M}\sum_{\boldsymbol{x}_{j}%
\in\mathcal{T}^{u}\land\tau<\max_{c}\bar{\rho}^{weak}_{jc}}-\mathrm{log}\left(%
\int p(y=\hat{y}^{weak}_{j}|\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{%
x}^{strong}_{j},\boldsymbol{\theta})d\boldsymbol{\rho}\right)
\displaystyle\mathcal{L}_{nll}^{fixmatch}
\displaystyle=\frac{1}{M}\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{u}\land\tau<%
\max_{c}\bar{\rho}^{weak}_{jc}}-\mathrm{log}\left(\int p(y=\hat{y}^{weak}_{j}|%
\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}^{strong}_{j},\boldsymbol{%
\theta})d\boldsymbol{\rho}\right)
\displaystyle=\frac{1}{M}\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{u}\land\tau<%
\max_{c}\bar{\rho}^{weak}_{jc}}\sum_{c=1}^{C}\hat{\Upsilon}^{weak}_{jc}\bigg{(%
}\mathrm{log}\big{(}\sum_{c=1}^{C}\alpha^{strong}_{jc}\big{)}-\mathrm{log}%
\alpha^{strong}_{jc}\bigg{)},
\displaystyle=\frac{1}{M}\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{u}\land\tau<%
\max_{c}\bar{\rho}^{weak}_{jc}}\sum_{c=1}^{C}\hat{\Upsilon}^{weak}_{jc}\bigg{(%
}\mathrm{log}\big{(}\sum_{c=1}^{C}\alpha^{strong}_{jc}\big{)}-\mathrm{log}%
\alpha^{strong}_{jc}\bigg{)},
\hat{y}^{weak}_{j}={\arg\max}_{c}\bar{\rho}^{weak}_{jc}={\arg\max}_{c}\mathbb{%
E}[Dir(\rho_{c}|\boldsymbol{\alpha}^{weak}_{j})]
M=|\{\boldsymbol{x}_{j}|\boldsymbol{x}_{j}\in\mathcal{T}^{u}\land\tau<\max_{c}%
\bar{\rho}^{weak}_{jc}\}|
\tau
\hat{\Upsilon}^{weak}_{jc}
c
\hat{\boldsymbol{\Upsilon}}^{weak}_{j}
\hat{y}^{weak}_{j}
\tau
B=5\%\times n_{t}
\to
\to
\to
\mathcal{L}_{U_{dis}}
U_{dis}
\mathcal{L}_{edl}
\mathcal{L}_{edl}+\beta\mathcal{L}_{U_{dis}}
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\to
\mathcal{L}_{edl}
\mathcal{L}_{edl}+\beta\mathcal{L}_{U_{dis}}
\mathcal{L}_{edl}
\mathcal{L}_{edl}+\beta\mathcal{L}_{U_{dis}}
P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})
\boldsymbol{x}_{i}
f
\boldsymbol{\theta}
c
\displaystyle P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})=\int p(y=c|%
\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_{i},\boldsymbol{\theta})d%
\boldsymbol{\rho}
\displaystyle P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})
\displaystyle=\int p(y=c|\boldsymbol{\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_%
{i},\boldsymbol{\theta})d\boldsymbol{\rho}
\displaystyle=\int\rho_{c}\cdot p(\boldsymbol{\rho}|\boldsymbol{x}_{i},%
\boldsymbol{\theta})d\boldsymbol{\rho}
\displaystyle=\int\rho_{c}\cdot p(\boldsymbol{\rho}|\boldsymbol{x}_{i},%
\boldsymbol{\theta})d\boldsymbol{\rho}
\displaystyle=\int\int\cdots\int\rho_{c}\cdot p(\rho_{1},\rho_{2},\cdots,\rho_%
{C}|\boldsymbol{x}_{i},\boldsymbol{\theta})d\rho_{1}d\rho_{2}\cdots d\rho_{C}
\displaystyle=\int\int\cdots\int\rho_{c}\cdot p(\rho_{1},\rho_{2},\cdots,\rho_%
{C}|\boldsymbol{x}_{i},\boldsymbol{\theta})d\rho_{1}d\rho_{2}\cdots d\rho_{C}
\displaystyle=\int\rho_{c}\big{(}\int\int\cdots\int\int\cdots\int p(\rho_{1},%
\rho_{2},\cdots,\rho_{C}|\boldsymbol{x}_{i},\boldsymbol{\theta})d\rho_{1}d\rho%
_{2}\cdots d\rho_{c-1}d\rho_{c+1}\cdots d\rho_{C}\big{)}d\rho_{c}
\displaystyle=\int\rho_{c}\big{(}\int\int\cdots\int\int\cdots\int p(\rho_{1},%
\rho_{2},\cdots,\rho_{C}|\boldsymbol{x}_{i},\boldsymbol{\theta})d\rho_{1}d\rho%
_{2}\cdots d\rho_{c-1}d\rho_{c+1}\cdots d\rho_{C}\big{)}d\rho_{c}
\displaystyle=\int\rho_{c}\cdot p(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{%
\theta})d\rho_{c}\,,
\displaystyle=\int\rho_{c}\cdot p(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{%
\theta})d\rho_{c}\,,
\rho_{c}
c
\boldsymbol{\rho}
p(\boldsymbol{\rho}|\boldsymbol{x}_{i},\boldsymbol{\theta})\sim Dir(%
\boldsymbol{\rho}|\boldsymbol{\alpha}_{i})
p(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{\theta})\sim Beta(\rho_{c}|\alpha_{%
ic},\alpha_{i0}-\alpha_{ic})
\boldsymbol{\alpha}_{i}=g(f(\boldsymbol{x}_{i},\boldsymbol{\theta}))
\alpha_{i0}=\sum_{k=1}^{C}\alpha_{ik}
g(\cdot)
\boldsymbol{\alpha}_{i}
\boldsymbol{x}_{i}
\displaystyle p(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{\theta})=\frac{1}{%
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})}\rho_{c}^{\alpha_{ic}-1}(1-%
\rho_{c})^{\alpha_{i0}-\alpha_{ic}-1},
\displaystyle p(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{\theta})=\frac{1}{%
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})}\rho_{c}^{\alpha_{ic}-1}(1-%
\rho_{c})^{\alpha_{i0}-\alpha_{ic}-1},
\mathcal{B}(\cdot,\cdot)
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})=\frac{\Gamma(\alpha_{ic})%
\Gamma(\alpha_{i0}-\alpha_{ic})}{\Gamma(\alpha_{ic}+\alpha_{i0}-\alpha_{ic})}
\Gamma(\cdot)
P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})
\displaystyle P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})=\int\rho_{c}\cdot p%
(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{\theta})d\rho_{c}
\displaystyle P(y=c|\boldsymbol{x}_{i},\boldsymbol{\theta})
\displaystyle=\int\rho_{c}\cdot p(\rho_{c}|\boldsymbol{x}_{i},\boldsymbol{%
\theta})d\rho_{c}
\displaystyle=\int\rho_{c}\cdot\left(\frac{1}{\mathcal{B}(\alpha_{ic},\alpha_{%
i0}-\alpha_{ic})}\rho_{c}^{\alpha_{ic}-1}(1-\rho_{c})^{\alpha_{i0}-\alpha_{ic}%
-1}\right)d\rho_{c}
\displaystyle=\int\rho_{c}\cdot\left(\frac{1}{\mathcal{B}(\alpha_{ic},\alpha_{%
i0}-\alpha_{ic})}\rho_{c}^{\alpha_{ic}-1}(1-\rho_{c})^{\alpha_{i0}-\alpha_{ic}%
-1}\right)d\rho_{c}
\displaystyle=\frac{\mathcal{B}(\alpha_{ic}+1,\alpha_{i0}-\alpha_{ic})}{%
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})}\int\frac{1}{\mathcal{B}(%
\alpha_{ic}+1,\alpha_{i0}-\alpha_{ic})}\rho_{c}^{\alpha_{ic}}(1-\rho_{c})^{%
\alpha_{i0}-\alpha_{ic}-1}d\rho_{c}
\displaystyle=\frac{\mathcal{B}(\alpha_{ic}+1,\alpha_{i0}-\alpha_{ic})}{%
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})}\int\frac{1}{\mathcal{B}(%
\alpha_{ic}+1,\alpha_{i0}-\alpha_{ic})}\rho_{c}^{\alpha_{ic}}(1-\rho_{c})^{%
\alpha_{i0}-\alpha_{ic}-1}d\rho_{c}
\displaystyle=\frac{\mathcal{B}(\alpha_{ic}+1,\alpha_{i0}-\alpha_{ic})}{%
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})}\cdot 1
\displaystyle=\frac{\mathcal{B}(\alpha_{ic}+1,\alpha_{i0}-\alpha_{ic})}{%
\mathcal{B}(\alpha_{ic},\alpha_{i0}-\alpha_{ic})}\cdot 1
\displaystyle=\frac{\Gamma(\alpha_{ic}+1)\Gamma(\alpha_{i0})}{\Gamma(\alpha_{i%
0}+1)\Gamma(\alpha_{ic})}
\displaystyle=\frac{\Gamma(\alpha_{ic}+1)\Gamma(\alpha_{i0})}{\Gamma(\alpha_{i%
0}+1)\Gamma(\alpha_{ic})}
\displaystyle=\frac{\alpha_{ic}\bcancel{\Gamma(\alpha_{ic})}\bcancel{\Gamma(%
\alpha_{i0})}}{\alpha_{i0}\bcancel{\Gamma(\alpha_{i0})}\bcancel{\Gamma(\alpha_%
{ic})}}=\frac{\alpha_{ic}}{\sum_{k=1}^{C}\alpha_{ik}}=\frac{g(f_{c}(%
\boldsymbol{x}_{i},\boldsymbol{\theta}))}{\sum_{k=1}^{C}g(f_{k}(\boldsymbol{x}%
_{i},\boldsymbol{\theta}))}
\displaystyle=\frac{\alpha_{ic}\bcancel{\Gamma(\alpha_{ic})}\bcancel{\Gamma(%
\alpha_{i0})}}{\alpha_{i0}\bcancel{\Gamma(\alpha_{i0})}\bcancel{\Gamma(\alpha_%
{ic})}}=\frac{\alpha_{ic}}{\sum_{k=1}^{C}\alpha_{ik}}=\frac{g(f_{c}(%
\boldsymbol{x}_{i},\boldsymbol{\theta}))}{\sum_{k=1}^{C}g(f_{k}(\boldsymbol{x}%
_{i},\boldsymbol{\theta}))}
\displaystyle=\mathbb{E}[Dir(\rho_{c}|\boldsymbol{\alpha}_{i})].
\displaystyle=\mathbb{E}[Dir(\rho_{c}|\boldsymbol{\alpha}_{i})].
g(\cdot)
\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})}[H[P(y%
|\boldsymbol{\rho})]]
\boldsymbol{x}_{j}
\theta
\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})}[H[P(y%
|\boldsymbol{\rho})]]
\displaystyle\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})}[H[P(y|\boldsymbol{\rho})]]=\mathbb{E}_{p(\boldsymbol{\rho}|%
\boldsymbol{x}_{j};\boldsymbol{\theta})}[-\sum_{c=1}^{C}\rho_{c}\,log\,\rho_{c}]
\displaystyle\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})}[H[P(y|\boldsymbol{\rho})]]
\displaystyle=\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j};\boldsymbol{%
\theta})}[-\sum_{c=1}^{C}\rho_{c}\,log\,\rho_{c}]
\displaystyle=-\sum_{c=1}^{C}\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j%
};\boldsymbol{\theta})}[\rho_{c}\,log\,\rho_{c}]
\displaystyle=-\sum_{c=1}^{C}\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j%
};\boldsymbol{\theta})}[\rho_{c}\,log\,\rho_{c}]
\displaystyle=-\sum_{c=1}^{C}\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j};%
\boldsymbol{\theta})\rho_{c}\,log\,\rho_{c}\,d\boldsymbol{\rho}
\displaystyle=-\sum_{c=1}^{C}\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j};%
\boldsymbol{\theta})\rho_{c}\,log\,\rho_{c}\,d\boldsymbol{\rho}
\displaystyle=-\sum_{c=1}^{C}\int\int\cdots\int p(\rho_{1},\rho_{2},\cdots,%
\rho_{C}|\boldsymbol{x}_{j};\boldsymbol{\theta})\rho_{c}\,log\,\rho_{c}\,d\rho%
_{1}d\rho_{2}\cdots d\rho_{C}
\displaystyle=-\sum_{c=1}^{C}\int\int\cdots\int p(\rho_{1},\rho_{2},\cdots,%
\rho_{C}|\boldsymbol{x}_{j};\boldsymbol{\theta})\rho_{c}\,log\,\rho_{c}\,d\rho%
_{1}d\rho_{2}\cdots d\rho_{C}
\displaystyle=-\sum_{c=1}^{C}\int(\rho_{c}log\rho_{c})(\int\cdots\int\int%
\cdots\int p(\rho_{1},\rho_{2},\cdots,\rho_{C}|\boldsymbol{x}_{j};\boldsymbol{%
\theta})\,d\rho_{1}\cdots d\rho_{c-1}d\rho_{c+1}\cdots d\rho_{C})d\rho_{c}
\displaystyle=-\sum_{c=1}^{C}\int(\rho_{c}log\rho_{c})(\int\cdots\int\int%
\cdots\int p(\rho_{1},\rho_{2},\cdots,\rho_{C}|\boldsymbol{x}_{j};\boldsymbol{%
\theta})\,d\rho_{1}\cdots d\rho_{c-1}d\rho_{c+1}\cdots d\rho_{C})d\rho_{c}
\displaystyle=-\sum_{c=1}^{C}\mathbb{E}_{p(\rho_{c}|\boldsymbol{x}_{j};%
\boldsymbol{\theta})}[\rho_{c}\,log\,\rho_{c}].
\displaystyle=-\sum_{c=1}^{C}\mathbb{E}_{p(\rho_{c}|\boldsymbol{x}_{j};%
\boldsymbol{\theta})}[\rho_{c}\,log\,\rho_{c}].
\mathbb{E}_{p(\rho_{c}|\boldsymbol{x}_{j};\boldsymbol{\theta})}[\rho_{c}\,log%
\,\rho_{c}]
\displaystyle\mathbb{E}_{p(\rho_{c}|\boldsymbol{x}_{j};\boldsymbol{\theta})}[%
\rho_{c}\,log\,\rho_{c}]=\int(\rho_{c}log\rho_{c})\frac{1}{\mathcal{B}(\alpha_%
{jc},\alpha_{j0}-\alpha_{jc})}\rho_{c}^{\alpha_{jc}-1}(1-\rho_{c})^{\alpha_{j0%
}-\alpha_{jc}-1}\,d\rho_{c}
\displaystyle\mathbb{E}_{p(\rho_{c}|\boldsymbol{x}_{j};\boldsymbol{\theta})}[%
\rho_{c}\,log\,\rho_{c}]
\displaystyle=\int(\rho_{c}log\rho_{c})\frac{1}{\mathcal{B}(\alpha_{jc},\alpha%
_{j0}-\alpha_{jc})}\rho_{c}^{\alpha_{jc}-1}(1-\rho_{c})^{\alpha_{j0}-\alpha_{%
jc}-1}\,d\rho_{c}
\displaystyle=\frac{\mathcal{B}(\alpha_{jc}+1,\alpha_{j0}-\alpha_{jc})}{%
\mathcal{B}(\alpha_{jc},\alpha_{j0}-\alpha_{jc})}\int(log\rho_{c})\frac{1}{%
\mathcal{B}(\alpha_{jc}+1,\alpha_{j0}-\alpha_{jc})}\rho_{c}^{\alpha_{jc}}(1-%
\rho_{c})^{\alpha_{j0}-\alpha_{jc}-1}\,d\rho_{c}
\displaystyle=\frac{\mathcal{B}(\alpha_{jc}+1,\alpha_{j0}-\alpha_{jc})}{%
\mathcal{B}(\alpha_{jc},\alpha_{j0}-\alpha_{jc})}\int(log\rho_{c})\frac{1}{%
\mathcal{B}(\alpha_{jc}+1,\alpha_{j0}-\alpha_{jc})}\rho_{c}^{\alpha_{jc}}(1-%
\rho_{c})^{\alpha_{j0}-\alpha_{jc}-1}\,d\rho_{c}
\displaystyle=\frac{\Gamma(\alpha_{jc}+1)\Gamma(\alpha_{j0})}{\Gamma(\alpha_{j%
0}+1)\Gamma(\alpha_{jc})}\mathbb{E}_{\rho_{c}\sim Beta(\rho_{c}|\alpha_{jc}+1,%
\alpha_{j0}-\alpha_{jc})}[log\rho_{c}]
\displaystyle=\frac{\Gamma(\alpha_{jc}+1)\Gamma(\alpha_{j0})}{\Gamma(\alpha_{j%
0}+1)\Gamma(\alpha_{jc})}\mathbb{E}_{\rho_{c}\sim Beta(\rho_{c}|\alpha_{jc}+1,%
\alpha_{j0}-\alpha_{jc})}[log\rho_{c}]
\displaystyle=\frac{\alpha_{jc}}{\alpha_{j0}}\left(\psi(\alpha_{jc}+1)-\psi(%
\alpha_{j0}+1)\right),
\displaystyle=\frac{\alpha_{jc}}{\alpha_{j0}}\left(\psi(\alpha_{jc}+1)-\psi(%
\alpha_{j0}+1)\right),
\psi(\cdot)
\alpha_{jc}
c
\boldsymbol{\alpha}_{j}
\alpha_{j0}=\sum_{k=1}^{C}\alpha_{jk}
\boldsymbol{x}_{j}
\displaystyle\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})}[H[P(y|\boldsymbol{\rho})]]=-\sum_{c=1}^{C}\mathbb{E}_{p(\rho_{c}|%
\boldsymbol{x}_{j};\boldsymbol{\theta})}[\rho_{c}\,log\,\rho_{c}]
\displaystyle\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})}[H[P(y|\boldsymbol{\rho})]]
\displaystyle=-\sum_{c=1}^{C}\mathbb{E}_{p(\rho_{c}|\boldsymbol{x}_{j};%
\boldsymbol{\theta})}[\rho_{c}\,log\,\rho_{c}]
\displaystyle=-\sum_{c=1}^{C}\frac{\alpha_{jc}}{\alpha_{j0}}\left(\psi(\alpha_%
{jc}+1)-\psi(\alpha_{j0}+1)\right)
\displaystyle=-\sum_{c=1}^{C}\frac{\alpha_{jc}}{\alpha_{j0}}\left(\psi(\alpha_%
{jc}+1)-\psi(\alpha_{j0}+1)\right)
\displaystyle=\sum_{c=1}^{C}\bar{\rho}_{jc}\bigg{(}\psi(\sum_{k=1}^{C}\alpha_{%
jk}+1)-\psi(\alpha_{jc}+1)\bigg{)},
\displaystyle=\sum_{c=1}^{C}\bar{\rho}_{jc}\bigg{(}\psi(\sum_{k=1}^{C}\alpha_{%
jk}+1)-\psi(\alpha_{jc}+1)\bigg{)},
\bar{\rho}_{jc}=\frac{\alpha_{jc}}{\alpha_{j0}}=\mathbb{E}[Dir(\rho_{c}|%
\boldsymbol{\alpha}_{j})]
I[y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]
I[y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]
\displaystyle I[y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]=%
\int\sum_{c=1}^{C}p(y=c,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})\,log\,\frac{p(y=c,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})}{p(y=c|\boldsymbol{x}_{j},\boldsymbol{\theta})p(\boldsymbol{\rho}|%
\boldsymbol{x}_{j},\boldsymbol{\theta})}d\boldsymbol{\rho}.
\displaystyle I[y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]
\displaystyle=\int\sum_{c=1}^{C}p(y=c,\boldsymbol{\rho}|\boldsymbol{x}_{j},%
\boldsymbol{\theta})\,log\,\frac{p(y=c,\boldsymbol{\rho}|\boldsymbol{x}_{j},%
\boldsymbol{\theta})}{p(y=c|\boldsymbol{x}_{j},\boldsymbol{\theta})p(%
\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})}d\boldsymbol{\rho}.
(\boldsymbol{x}_{j},\boldsymbol{\theta})\rightarrow\boldsymbol{\rho}\rightarrow
y
y
(\boldsymbol{x}_{j},\boldsymbol{\theta})
\boldsymbol{\rho}
p(y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})=p(y|\boldsymbol{%
\rho})p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})
\displaystyle I[y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]=%
\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})\sum_{c=1}^{C}%
p(y=c|\boldsymbol{\rho})\,log\,\frac{p(y=c|\boldsymbol{\rho})}{p(y=c|%
\boldsymbol{x}_{j},\boldsymbol{\theta})}d\boldsymbol{\rho}
\displaystyle I[y,\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta}]
\displaystyle=\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})%
\sum_{c=1}^{C}p(y=c|\boldsymbol{\rho})\,log\,\frac{p(y=c|\boldsymbol{\rho})}{p%
(y=c|\boldsymbol{x}_{j},\boldsymbol{\theta})}d\boldsymbol{\rho}
\displaystyle=\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})%
\sum_{c=1}^{C}\big{(}\rho_{c}\,log\,\rho_{c}-\rho_{c}\,log\,p(y=c|\boldsymbol{%
x}_{j},\boldsymbol{\theta})\big{)}d\boldsymbol{\rho}
\displaystyle=\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})%
\sum_{c=1}^{C}\big{(}\rho_{c}\,log\,\rho_{c}-\rho_{c}\,log\,p(y=c|\boldsymbol{%
x}_{j},\boldsymbol{\theta})\big{)}d\boldsymbol{\rho}
\displaystyle=\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})%
\sum_{c=1}^{C}(\rho_{c}\,log\,\rho_{c})d\boldsymbol{\rho}-\int p(\boldsymbol{%
\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})\sum_{c=1}^{C}(\rho_{c}\,log\,%
\frac{\alpha_{jc}}{\sum_{k=1}^{C}\alpha_{jk}})d\boldsymbol{\rho}
\displaystyle=\int p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})%
\sum_{c=1}^{C}(\rho_{c}\,log\,\rho_{c})d\boldsymbol{\rho}-\int p(\boldsymbol{%
\rho}|\boldsymbol{x}_{j},\boldsymbol{\theta})\sum_{c=1}^{C}(\rho_{c}\,log\,%
\frac{\alpha_{jc}}{\sum_{k=1}^{C}\alpha_{jk}})d\boldsymbol{\rho}
\displaystyle=\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})\sim Dir(\boldsymbol{\rho}|\boldsymbol{\alpha_{j}})}[\sum_{c=1}^{C}%
\rho_{c}\,log\,\rho_{c}]-\sum_{c=1}^{C}\big{(}log\frac{\alpha_{jc}}{\sum_{k=1}%
^{C}\alpha_{jk}}\big{)}\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},%
\boldsymbol{\theta})\sim Dir(\boldsymbol{\rho}|\boldsymbol{\alpha_{j}})}[\rho_%
{c}]
\displaystyle=\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})\sim Dir(\boldsymbol{\rho}|\boldsymbol{\alpha_{j}})}[\sum_{c=1}^{C}%
\rho_{c}\,log\,\rho_{c}]-\sum_{c=1}^{C}\big{(}log\frac{\alpha_{jc}}{\sum_{k=1}%
^{C}\alpha_{jk}}\big{)}\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},%
\boldsymbol{\theta})\sim Dir(\boldsymbol{\rho}|\boldsymbol{\alpha_{j}})}[\rho_%
{c}]
\displaystyle=\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})\sim Dir(\boldsymbol{\rho}|\boldsymbol{\alpha_{j}})}[\sum_{c=1}^{C}%
\rho_{c}\,log\,\rho_{c}]-\sum_{c=1}^{C}\bar{\rho}_{jc}log\bar{\rho}_{jc}
\displaystyle=\mathbb{E}_{p(\boldsymbol{\rho}|\boldsymbol{x}_{j},\boldsymbol{%
\theta})\sim Dir(\boldsymbol{\rho}|\boldsymbol{\alpha_{j}})}[\sum_{c=1}^{C}%
\rho_{c}\,log\,\rho_{c}]-\sum_{c=1}^{C}\bar{\rho}_{jc}log\bar{\rho}_{jc}
\displaystyle=\sum_{c=1}^{C}\bar{\rho}_{jc}\bigg{(}\psi(\alpha_{jc}+1)-\psi(%
\sum_{k=1}^{C}\alpha_{jk}+1)\bigg{)}-\sum_{c=1}^{C}\bar{\rho}_{jc}\mathrm{log}%
\bar{\rho}_{jc}.
\displaystyle=\sum_{c=1}^{C}\bar{\rho}_{jc}\bigg{(}\psi(\alpha_{jc}+1)-\psi(%
\sum_{k=1}^{C}\alpha_{jk}+1)\bigg{)}-\sum_{c=1}^{C}\bar{\rho}_{jc}\mathrm{log}%
\bar{\rho}_{jc}.
P(y=c|\boldsymbol{x}_{j},\boldsymbol{\theta})=\frac{\alpha_{jc}}{\sum_{k=1}^{C%
}\alpha_{jk}}
\mathcal{L}_{kl}
p(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})\sim Dir(\boldsymbol{\rho}%
|\boldsymbol{\tilde{\alpha}}_{i})
\displaystyle p(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})=\frac{1}{%
\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})}\prod_{c=1}^{C}\rho_{c}^{\tilde{%
\alpha}_{ic}-1},
\displaystyle p(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})=\frac{1}{%
\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})}\prod_{c=1}^{C}\rho_{c}^{\tilde{%
\alpha}_{ic}-1},
\mathfrak{B}(\cdot)
\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})=\frac{\prod_{c=1}^{C}\Gamma(%
\tilde{\alpha}_{ic})}{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{ic})}
\Gamma(\cdot)
Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})
Dir(\boldsymbol{\rho}|\boldsymbol{1})
\displaystyle KL\big{[}Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})%
\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]}=\int p(\boldsymbol{\rho}|%
\tilde{\boldsymbol{\alpha}}_{i})\,log\,\frac{p(\boldsymbol{\rho}|\tilde{%
\boldsymbol{\alpha}}_{i})}{p(\boldsymbol{\rho}|\boldsymbol{1})}d\boldsymbol{\rho}
\displaystyle KL\big{[}Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})%
\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]}
\displaystyle=\int p(\boldsymbol{\rho}|\tilde{\boldsymbol{\alpha}}_{i})\,log\,%
\frac{p(\boldsymbol{\rho}|\tilde{\boldsymbol{\alpha}}_{i})}{p(\boldsymbol{\rho%
}|\boldsymbol{1})}d\boldsymbol{\rho}
\displaystyle=\int\left(\frac{1}{\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})%
}\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1}\right)\,log\left(\frac{%
\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})}%
\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1}\right)d\boldsymbol{\rho}
\displaystyle=\int\left(\frac{1}{\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})%
}\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1}\right)\,log\left(\frac{%
\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i})}%
\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1}\right)d\boldsymbol{\rho}
\displaystyle=log\frac{\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{%
\tilde{\alpha}}_{i})}\int(\frac{1}{\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i%
})}\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1})\,d\boldsymbol{\rho}+\int(%
log\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1})(\frac{1}{\mathfrak{B}(%
\boldsymbol{\tilde{\alpha}}_{i})}\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-%
1})\,d\boldsymbol{\rho}
\displaystyle=log\frac{\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{%
\tilde{\alpha}}_{i})}\int(\frac{1}{\mathfrak{B}(\boldsymbol{\tilde{\alpha}}_{i%
})}\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1})\,d\boldsymbol{\rho}+\int(%
log\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-1})(\frac{1}{\mathfrak{B}(%
\boldsymbol{\tilde{\alpha}}_{i})}\prod_{c=1}^{C}\rho_{c}^{\tilde{\alpha}_{ic}-%
1})\,d\boldsymbol{\rho}
\displaystyle=log\frac{\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{%
\tilde{\alpha}}_{i})}\cdot 1+\mathbb{E}_{\boldsymbol{\rho}\sim Dir(\boldsymbol%
{\rho}|\boldsymbol{\tilde{\alpha}}_{i})}[log\prod_{c=1}^{C}\rho_{c}^{\tilde{%
\alpha}_{ic}-1}]
\displaystyle=log\frac{\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{%
\tilde{\alpha}}_{i})}\cdot 1+\mathbb{E}_{\boldsymbol{\rho}\sim Dir(\boldsymbol%
{\rho}|\boldsymbol{\tilde{\alpha}}_{i})}[log\prod_{c=1}^{C}\rho_{c}^{\tilde{%
\alpha}_{ic}-1}]
\displaystyle=log\frac{\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{%
\tilde{\alpha}}_{i})}+\sum_{c=1}^{C}(\tilde{\alpha}_{ic}-1)\mathbb{E}_{\rho_{c%
}\sim Beta(\rho_{c}|\tilde{\alpha}_{ic},\tilde{\alpha}_{i0}-\tilde{\alpha}_{ic%
})}[log\rho_{c}]
\displaystyle=log\frac{\mathfrak{B}(\boldsymbol{1})}{\mathfrak{B}(\boldsymbol{%
\tilde{\alpha}}_{i})}+\sum_{c=1}^{C}(\tilde{\alpha}_{ic}-1)\mathbb{E}_{\rho_{c%
}\sim Beta(\rho_{c}|\tilde{\alpha}_{ic},\tilde{\alpha}_{i0}-\tilde{\alpha}_{ic%
})}[log\rho_{c}]
\displaystyle=log\Big{(}\frac{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{ic})}{%
\Gamma(C)\prod_{c=1}^{C}\Gamma(\tilde{\alpha}_{ic})}\Big{)}+\sum_{c=1}^{C}(%
\tilde{\alpha}_{ic}-1)\Big{[}\psi(\tilde{\alpha}_{ic})-\psi(\sum_{k=1}^{C}%
\tilde{\alpha}_{ik})\Big{]}.
\displaystyle=log\Big{(}\frac{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{ic})}{%
\Gamma(C)\prod_{c=1}^{C}\Gamma(\tilde{\alpha}_{ic})}\Big{)}+\sum_{c=1}^{C}(%
\tilde{\alpha}_{ic}-1)\Big{[}\psi(\tilde{\alpha}_{ic})-\psi(\sum_{k=1}^{C}%
\tilde{\alpha}_{ik})\Big{]}.
\mathcal{L}_{kl}
\displaystyle\mathcal{L}_{kl}=\frac{1}{C\cdot n_{s}}\sum_{\boldsymbol{x}_{i}%
\in\mathcal{S}}KL\big{[}Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})%
\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]}+\frac{1}{C\cdot|\mathcal{T}^{l%
}|}\sum_{\boldsymbol{x}_{j}\in\mathcal{T}^{l}}KL\big{[}Dir(\boldsymbol{\rho}|%
\boldsymbol{\tilde{\alpha}}_{j})\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]},
\displaystyle\mathcal{L}_{kl}
\displaystyle=\frac{1}{C\cdot n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}KL%
\big{[}Dir(\boldsymbol{\rho}|\boldsymbol{\tilde{\alpha}}_{i})\lVert Dir(%
\boldsymbol{\rho}|\mathbf{1})\big{]}+\frac{1}{C\cdot|\mathcal{T}^{l}|}\sum_{%
\boldsymbol{x}_{j}\in\mathcal{T}^{l}}KL\big{[}Dir(\boldsymbol{\rho}|%
\boldsymbol{\tilde{\alpha}}_{j})\lVert Dir(\boldsymbol{\rho}|\mathbf{1})\big{]},
\displaystyle=\frac{1}{C\cdot n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}\,%
log\,\left(\frac{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{ic})}{\Gamma(C)\prod_{c=%
1}^{C}\Gamma(\tilde{\alpha}_{ic})}\right)+\sum_{c=1}^{C}(\tilde{\alpha}_{ic}-1%
)\left[\psi(\tilde{\alpha}_{ic})-\psi(\sum_{k=1}^{C}\tilde{\alpha}_{ik})\right]
\displaystyle=\frac{1}{C\cdot n_{s}}\sum_{\boldsymbol{x}_{i}\in\mathcal{S}}\,%
log\,\left(\frac{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{ic})}{\Gamma(C)\prod_{c=%
1}^{C}\Gamma(\tilde{\alpha}_{ic})}\right)+\sum_{c=1}^{C}(\tilde{\alpha}_{ic}-1%
)\left[\psi(\tilde{\alpha}_{ic})-\psi(\sum_{k=1}^{C}\tilde{\alpha}_{ik})\right]
\displaystyle+\frac{1}{C\cdot|\mathcal{T}^{l}|}\sum_{\boldsymbol{x}_{j}\in%
\mathcal{T}^{l}}\,log\,\left(\frac{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{jc})}{%
\Gamma(C)\prod_{c=1}^{C}\Gamma(\tilde{\alpha}_{jc})}\right)+\sum_{c=1}^{C}(%
\tilde{\alpha}_{jc}-1)\left[\psi(\tilde{\alpha}_{jc})-\psi(\sum_{k=1}^{C}%
\tilde{\alpha}_{jk})\right].
\displaystyle+\frac{1}{C\cdot|\mathcal{T}^{l}|}\sum_{\boldsymbol{x}_{j}\in%
\mathcal{T}^{l}}\,log\,\left(\frac{\Gamma(\sum_{c=1}^{C}\tilde{\alpha}_{jc})}{%
\Gamma(C)\prod_{c=1}^{C}\Gamma(\tilde{\alpha}_{jc})}\right)+\sum_{c=1}^{C}(%
\tilde{\alpha}_{jc}-1)\left[\psi(\tilde{\alpha}_{jc})-\psi(\sum_{k=1}^{C}%
\tilde{\alpha}_{jk})\right].
