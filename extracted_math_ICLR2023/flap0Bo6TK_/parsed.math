W^{L}
I_{n}\in\mathbb{R}^{n\times n}
\operatorname{\mathrm{batchm}}(X,Y)_{ij}=\langle X,Y_{IJ}\rangle_{F}
X\in\mathbb{R}^{n\times n}
Y\in\mathbb{R}^{zn\times zn}
z
\operatorname{\mathrm{batchm}}(\cdot,\cdot)
X
IJ
n\times n
Y
\operatorname{\mathrm{batchm}}(X,Y)\in\mathbb{R}^{z\times z}
\operatorname{concat}(\cdot,\cdot)
\odot
\overset{P}{\longrightarrow}
\displaystyle f(x)=W^{3}\sigma(W^{2}(\sigma(W^{1}x))\in\mathbb{R}^{d_{3}}\text%
{ with $x\in\mathbb{R}^{d_{0}}$ and weights $W^{l}\in\mathbb{R}^{d_{l}\times d%
_{l-1}}$.}
x\in\mathbb{R}^{d_{0}}
W^{l}\in\mathbb{R}^{d_{l}\times d_{l-1}}
\displaystyle f(x)
\displaystyle=W^{3}\sigma(W^{2}(\sigma(W^{1}x))\in\mathbb{R}^{d_{3}}\text{ %
with $x\in\mathbb{R}^{d_{0}}$ and weights $W^{l}\in\mathbb{R}^{d_{l}\times d_{%
l-1}}$.}
x\in\mathbb{R}^{d_{0}}
W^{l}\in\mathbb{R}^{d_{l}\times d_{l-1}}
x
X\in\mathbb{R}^{d_{0}\times n}
A\in\mathbb{R}^{n\times n}
X^{T}\in\mathbb{R}^{n\times d_{0}}
\displaystyle g(X)=A\sigma(A\sigma(AX^{T}W^{1})W^{2})W^{3}\in\mathbb{R}^{n%
\times d_{L}}
\displaystyle g(X)=A\sigma(A\sigma(AX^{T}W^{1})W^{2})W^{3}\in\mathbb{R}^{n%
\times d_{L}}
W^{l}\in\mathbb{R}^{d_{l-1}\times d_{l}}
A
A_{0\textbf{-}1}
A
A_{0\textbf{-}1}+I
A
L=D-A
D
D_{ii}=\sum_{ij}A_{ij}
A
A=(D+I)^{-\frac{1}{2}}(A+I)(D+I)^{-\frac{1}{2}}
A
I
g(X)
\displaystyle g(X)^{T}=W^{3^{T}}\sigma(W^{{2^{T}}}(\sigma(W^{1^{T}}X^{T}))\in%
\mathbb{R}^{d_{3}\times n}
\displaystyle g(X)^{T}=W^{3^{T}}\sigma(W^{{2^{T}}}(\sigma(W^{1^{T}}X^{T}))\in%
\mathbb{R}^{d_{3}\times n}
g(X)^{T}
f(X)
X
x
\displaystyle\underset{W}{\operatorname{argmin}}(||(Y^{T}-g(X)^{T})I_{train}||%
_{F}^{2})\text{ with $I_{train}=\operatorname{diag}([0,0,1,0,1,...,0,1])$}
I_{train}=\operatorname{diag}([0,0,1,0,1,...,0,1])
\displaystyle\underset{W}{\operatorname{argmin}}(||(Y^{T}-g(X)^{T})I_{train}||%
_{F}^{2})\text{ with $I_{train}=\operatorname{diag}([0,0,1,0,1,...,0,1])$}
I_{train}=\operatorname{diag}([0,0,1,0,1,...,0,1])
I_{train}\in\mathbb{R}^{n\times n}
I_{test}
I_{test}=I_{n}-I_{train}
\in\mathbb{R}^{n}
I_{train}
g(X)^{T}
g(X)^{T}
g(X)^{T}=f(X)
g(X)^{T}
\displaystyle g(X)^{T}=W^{3^{T}}\sigma(W^{{2^{T}}}(\sigma(W^{1^{T}}X^{T}%
\operatorname{dropout}(I)))
\displaystyle g(X)^{T}=W^{3^{T}}\sigma(W^{{2^{T}}}(\sigma(W^{1^{T}}X^{T}%
\operatorname{dropout}(I)))
I
\displaystyle g(X)^{T}=W^{3^{T}}\sigma(W^{{2^{T}}}(\sigma(W^{1^{T}}X^{T}%
\operatorname{dropout}(A))A)A
\displaystyle g(X)^{T}=W^{3^{T}}\sigma(W^{{2^{T}}}(\sigma(W^{1^{T}}X^{T}%
\operatorname{dropout}(A))A)A
A
I
A
AXW
(AXW)_{i}=\sum_{k\in\text{Neighbors}(i)}x_{k}W
A
\Theta_{ij}
\Theta
\displaystyle\Theta=\biggr{[}\sum_{i=1}^{d+1}\Sigma_{i}\odot(SS^{T})^{\odot(d+%
1-i)}\odot\bigl{(}\odot^{d+1-i}_{j=i}\dot{E}_{j}\bigr{)}\biggr{]}
\displaystyle\Theta
\displaystyle=\biggr{[}\sum_{i=1}^{d+1}\Sigma_{i}\odot(SS^{T})^{\odot(d+1-i)}%
\odot\bigl{(}\odot^{d+1-i}_{j=i}\dot{E}_{j}\bigr{)}\biggr{]}
\displaystyle\odot\,\underset{f\sim\mathcal{N}(0,\Sigma_{d})}{\mathbb{E}}[\dot%
{\Phi}(f)\dot{\Phi}(f)^{T}]
\displaystyle\odot\,\underset{f\sim\mathcal{N}(0,\Sigma_{d})}{\mathbb{E}}[\dot%
{\Phi}(f)\dot{\Phi}(f)^{T}]
\Sigma_{i}\in\mathbb{R}^{n\times n}
f_{i}
\Sigma_{1}:=SXX^{T}S^{T}
\Sigma_{i}:=SE_{i-1}S^{T}
E_{i}:=c_{\sigma}\underset{f\sim\mathcal{N}(0,\Sigma_{i})}{\mathbb{E}}[\sigma(%
f)\sigma(f)^{T}]
\dot{E}_{i}:=c_{\sigma}\underset{f\sim\mathcal{N}(0,\Sigma_{i})}{\mathbb{E}}[%
\dot{\sigma}(f)\dot{\sigma}(f)^{T}]
\Phi(x)\approx\frac{1}{1+e^{-x}}
S
l_{2}
\displaystyle\frac{du(\theta(t))}{dt}=\frac{\partial u(\theta(t))}{\partial%
\theta}\left(\frac{\partial u(\theta(t))}{\partial\theta}\right)^{T}\left(u(%
\theta(t))-\operatorname{vec}(Y)\right)
u(\theta(t)):=\operatorname{vec}(F(\theta(t),X))
\theta
F(\theta(t),X))
\frac{\partial u(\theta(t))}{\partial\theta}\left(\frac{\partial u(\theta(t))}%
{\partial\theta}\right)^{T}=\Theta
\Theta
\frac{\partial u(\theta(t))}{\partial\theta}\left(\frac{\partial u(\theta(t))}%
{\partial\theta}\right)^{T}
W^{h}\in\mathbb{R}^{d_{h}\times d_{h-1}}
X\in\mathbb{R}^{d_{0}\times n}
d_{0}
n
B
\sigma
\displaystyle F^{h}(X)=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}W^{h}G^{h-1}(X)+\sigma%
_{b}B^{h}\in\mathbb{R}^{d_{h}\times n}
\displaystyle F^{h}(X)
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}W^{h}G^{h-1}(X)+\sigma_{b}B^{h}%
\in\mathbb{R}^{d_{h}\times n}
\displaystyle\text{with }B^{h}=b^{h}\otimes\mathbf{1}_{n}^{T}\text{ and }b^{h}%
\in\mathbb{R}^{d_{h}}
\displaystyle\text{with }B^{h}
\displaystyle=b^{h}\otimes\mathbf{1}_{n}^{T}\text{ and }b^{h}\in\mathbb{R}^{d_%
{h}}
\displaystyle G^{h}(X)=\sigma(F^{h}(X))
\displaystyle G^{h}(X)
\displaystyle=\sigma(F^{h}(X))
\displaystyle G^{0}=X\in\mathbb{R}^{d_{0}\times n}
\displaystyle G^{0}
\displaystyle=X\in\mathbb{R}^{d_{0}\times n}
W^{h}\sim N(0,1)
b^{h}\sim N(0,1)
F^{L}(X)=\frac{\sigma_{w}}{\sqrt{d_{L-1}}}W^{L}G^{L-1}(X)+\sigma_{b}B^{L}\in%
\mathbb{R}^{d_{L}\times n}
F^{1}(X)
d_{L-1},d_{L-1},...,d_{1}
F(X)^{L}
\operatorname{vec}(F(X)^{L})\sim
\Lambda^{L-1}\otimes I_{d_{L}}
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\begin{pmatrix}\mathbb{E}\bigl{[}\sigma%
(u_{1})\sigma(u_{1})\bigr{]}&\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{2})\bigr%
{]}\dots&\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{n})\bigr{]}\\
\vdots&\ddots&\vdots\\
\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{1})\bigr{]}&\dots&\mathbb{E}\bigl{[}%
\sigma(u_{n})\sigma(u_{n})\bigr{]}\end{pmatrix}+\sigma_{b}^{2}
\displaystyle\text{ with }u\sim GP(0,\Lambda^{L-1})
\Lambda^{L}
u
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})%
\right]+\sigma_{b}^{2}
\displaystyle\Lambda^{0}=\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+\sigma_{b}^{2}
\mathbb{E}\left[\sigma(u)\sigma(u^{T})\right]
u
l
F^{l}(X)
\operatorname{vec}(Y^{1})=\operatorname{vec}(F(X)^{1})
\operatorname{vec}(F^{l+1}(X))
\operatorname{vec}(G^{l}(X))
d_{l}\rightarrow\infty
d_{L-1},d_{L-1},...,d_{1}
F(X)^{L}
\Theta^{L}\otimes I_{d_{l}}
\displaystyle\Theta^{L}=\Lambda^{L-1}+\left(\dot{\Lambda}^{L-1}\odot\Theta^{L-%
1}\right)
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})%
\right]+\sigma_{b}^{2}
\displaystyle\dot{\Lambda}^{L}=\sigma^{2}_{w}\mathbb{E}\left[\dot{\sigma}(u)%
\dot{\sigma}(u^{T})\right]+\sigma_{b}^{2}
u\sim N(0,\Lambda^{L-1})
\displaystyle\Theta^{1}=\Lambda^{0}=\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+\sigma^%
{2}_{b}
l
\displaystyle\dot{\Lambda}^{L+1}:=\mathds{1}_{n}
\displaystyle\dot{\Lambda}^{L+1}:=\mathds{1}_{n}
\displaystyle\Theta^{L}=\sum_{h=2}^{L+1}\left(\Lambda^{h-1}\odot(\dot{\Lambda}%
^{h}\odot\dot{\Lambda}^{h+1}\odot\cdots\odot\dot{\Lambda}^{L+1})\right)\otimes
I%
_{d_{L}}
\displaystyle\Theta^{L}=\sum_{h=2}^{L+1}\left(\Lambda^{h-1}\odot(\dot{\Lambda}%
^{h}\odot\dot{\Lambda}^{h+1}\odot\cdots\odot\dot{\Lambda}^{L+1})\right)\otimes
I%
_{d_{L}}
A\in\mathbb{R}^{n\times n}
\displaystyle F^{h}(X)=\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{h-1}}}W^{h}G^{h-1}(%
X)+\sigma_{b}B^{h}\biggr{)}A^{T}\in\mathbb{R}^{d_{h}\times n}
\displaystyle F^{h}(X)
\displaystyle=\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{h-1}}}W^{h}G^{h-1}(X)+\sigma%
_{b}B^{h}\biggr{)}A^{T}\in\mathbb{R}^{d_{h}\times n}
\displaystyle\text{with }B^{h}=b^{h}\otimes\mathbf{1}_{n}^{T}\text{ and }b^{h}%
\in\mathbb{R}^{d_{h}}
\displaystyle\text{with }B^{h}
\displaystyle=b^{h}\otimes\mathbf{1}_{n}^{T}\text{ and }b^{h}\in\mathbb{R}^{d_%
{h}}
\displaystyle G^{h}(X)=\sigma(F^{h}(X))
\displaystyle G^{h}(X)
\displaystyle=\sigma(F^{h}(X))
\displaystyle G^{0}=X\in\mathbb{R}^{d_{0}\times n}
\displaystyle G^{0}
\displaystyle=X\in\mathbb{R}^{d_{0}\times n}
W^{h}\sim N(0,1)
b^{h}\sim N(0,1)
L
F^{L}(X)=\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{L-1}}}W^{L}G^{L-1}(X)+\sigma_{b}B%
^{L}\biggr{)}A^{T}\in\mathbb{R}^{d_{L}\times n}
d_{L-1},d_{L-1},...,d_{1}
F(X)^{L}
\Theta^{L}\otimes I_{d_{L}}
\displaystyle\Theta^{L}=A\left(\Lambda^{L-1}+\left(\dot{\Lambda}^{L-1}\odot%
\Theta^{L-1}\right)\right)A^{T}\text{ with }
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})%
\right]+\sigma_{b}^{2}
\displaystyle\dot{\Lambda}^{L}=\sigma^{2}_{w}\mathbb{E}\left[\dot{\sigma}(u)%
\dot{\sigma}(u^{T})\right]+\sigma_{b}^{2}
u\sim N(0,A\Lambda^{L-1}A^{T})
\displaystyle\Theta^{1}=\Lambda^{0}=\sigma^{2}_{w}X^{T}X+\sigma^{2}_{b}
(A\otimes B)(C\otimes D)=(AC\otimes BD)
\mathbb{E}\left[\sigma(u)\sigma(u^{T})\right]
u
d_{L-1},d_{L-1},...,d_{1}
F(X)^{L}
\Theta^{L}\otimes I_{d_{L}}
\displaystyle\Theta^{L}=A\left(\Lambda^{L-1}+\left(\dot{\Lambda}^{L-1}\odot%
\Theta^{L-1}\right)\right)A^{T}\text{ with }
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})%
\right]+\sigma_{b}^{2}
\displaystyle\dot{\Lambda}^{L}=\sigma^{2}_{w}\mathbb{E}\left[\dot{\sigma}(u)%
\dot{\sigma}(u^{T})\right]+\sigma_{b}^{2}
u\sim N(0,A\Lambda^{L-1}A^{T})
\displaystyle\Theta^{1}=\Lambda^{0}=\sigma^{2}_{w}X^{T}X+\sigma^{2}_{b}
\Lambda^{L-1}+(\dot{\Lambda}^{L-1}\odot\Theta^{L-1})
A
[0,2]
W^{h}
h>1
W^{h}\in\mathbb{R}^{d_{l}\times 2d_{l-1}}
\displaystyle F^{h}(X)=\biggl{(}\frac{\sigma_{w}}{\sqrt{2d_{h-1}}}W^{h}G^{h-1}%
(X)+\sigma_{b}B^{h}\biggr{)}A^{T}\text{ for }h>1
\displaystyle F^{h}(X)
\displaystyle=\biggl{(}\frac{\sigma_{w}}{\sqrt{2d_{h-1}}}W^{h}G^{h-1}(X)+%
\sigma_{b}B^{h}\biggr{)}A^{T}\text{ for }h>1
\displaystyle F^{1}(X)=\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{1}}}W^{1}G^{0}(X)+%
\sigma_{b}B^{1}\biggr{)}A^{T}
\displaystyle F^{1}(X)
\displaystyle=\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{1}}}W^{1}G^{0}(X)+\sigma_{b}%
B^{1}\biggr{)}A^{T}
\displaystyle\text{with }B^{h}=b^{h}\otimes\mathbf{1}_{n}^{T}\text{ and }b^{h}%
\in\mathbb{R}^{d_{h}}
\displaystyle\text{with }B^{h}
\displaystyle=b^{h}\otimes\mathbf{1}_{n}^{T}\text{ and }b^{h}\in\mathbb{R}^{d_%
{h}}
\displaystyle G^{h}(X)=\begin{pmatrix}\sigma(F^{h}(X))\\
F^{h}(X)\end{pmatrix}\text{ so }G^{h}(X)\in\mathbb{R}^{2d_{l}\times n}
\displaystyle G^{h}(X)
\displaystyle=\begin{pmatrix}\sigma(F^{h}(X))\\
F^{h}(X)\end{pmatrix}\text{ so }G^{h}(X)\in\mathbb{R}^{2d_{l}\times n}
\displaystyle G^{0}=X\in\mathbb{R}^{d_{0}\times n}
\displaystyle G^{0}
\displaystyle=X\in\mathbb{R}^{d_{0}\times n}
W^{h}\sim N(0,1)
b^{h}\sim N(0,1)
L
F^{L}(X)=\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{L-1}}}W^{L}G^{L-1}(X)+\sigma_{b}B%
^{L}\biggr{)}A^{T}\in\mathbb{R}^{d_{L}\times n}
d_{L-1},d_{L-1},...,d_{1}
F(X)^{L}
\operatorname{vec}(F(X)^{L})\sim
A\Lambda^{L-1}A^{T})\otimes I_{d_{L}}
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\frac{1}{2}\left(\mathbb{E}\left[\sigma%
(u)\sigma(u^{T})\right]+A\Lambda^{L-1}A^{T}\right)+\sigma_{b}^{2}
u\sim N(0,A\Lambda^{L-1}A^{T})
\displaystyle\Lambda^{0}=\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+\sigma^{2}_{b}
d_{L-1},d_{L-1},...,d_{1}
F(X)^{L}
\Theta^{L}\otimes I_{d_{l}}
\displaystyle\Theta^{L}=A\left(\Lambda^{L-1}+\left(\dot{\Lambda}^{L-1}\odot%
\Theta^{L-1}\right)\right)A^{T}
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\frac{1}{2}\left(\mathbb{E}\left[\sigma%
(u)\sigma(u^{T})\right]+A\Lambda^{L-1}A^{T}\right)+\sigma_{b}^{2}
\displaystyle\dot{\Lambda}^{L}=\sigma^{2}_{w}\frac{1}{2}\left(\mathbb{E}\left[%
\dot{\sigma}(u)\dot{\sigma}(u^{T})\right]+1\right)+\sigma_{b}^{2}
u\sim N(0,A\Lambda^{L-1}A^{T})
\displaystyle\Theta^{1}=\Lambda^{0}=\sigma^{2}_{w}X^{T}X+\sigma^{2}_{b}
X\in\mathbb{R}^{d_{0}\times n}
W\in\mathbb{R}^{d_{1}\times d_{0}}
A\in\mathbb{R}^{n\times n}
GCN(A,X)=\sigma(WXA^{T})
GAT(A,X)=\sigma_{2}(WX\alpha(c,A,WX)))
A_{0\text{-}1}
A=A_{0\text{-}1}+I
\alpha(c,A,WX)
\displaystyle H:=XW\in\mathbb{R}^{n\times d_{out}}
\displaystyle M(H,c)_{ij}=\langle c,\operatorname{concat}(H_{\cdot i},H_{\cdot
j%
})\rangle=c_{1}^{T}H_{\cdot i}+c_{2}^{T}H_{\cdot j}\text{ with $c_{1}:=c_{[1,.%
..,d_{out}]}$ and $c_{2}:=c_{[d_{out},...,2d_{out}]}$}
c_{1}:=c_{[1,...,d_{out}]}
c_{2}:=c_{[d_{out},...,2d_{out}]}
\displaystyle\alpha(c,A,G)_{ij}=\frac{\exp\left(\sigma_{1}\left(M(H,c)_{ij}%
\right)\right)}{\sum_{k\in Neighbors(i)\mathop{\cup}\{i\}}\exp(\sigma_{1}\left%
(M(H,c)_{ik}\right)}
\operatorname{Softmax}
i
i
c\in\mathbb{R}^{2d_{0}}
\sigma_{1}
\frac{1}{H}\sum_{h}GAT_{h}(A,X)
W
\tilde{W}
GAT(A,X)=\sigma_{2}(WX\alpha(c,A,\tilde{W}X))
M(H,c)_{ij}=c_{1}^{T}(\tilde{W}X)_{\cdot i}+c_{2}^{T}(\tilde{W}X)_{\cdot j}=%
\tilde{c}_{1}^{T}X_{\cdot i}+\tilde{c}_{2}^{T}X_{\cdot j}
\tilde{W}
\tilde{W}
\operatorname{Softmax}
\mathbb{E}\left[\operatorname{Softmax}(u)\operatorname{Softmax}(u^{T})\right]
u\sim N(0,\Lambda)
\sigma_{1}
\sigma_{1}
\sigma(x)=c+m|x|\text{ for some }c,m\in\mathbb{R}_{+}
c,c_{1},c_{2}
c^{T}=\operatorname{concat}(c_{1}^{T},c_{2}^{T})
\displaystyle G^{0}=X\text{ with $X\in\mathbb{R}^{d_{0}\times n}$}
X\in\mathbb{R}^{d_{0}\times n}
\displaystyle G^{0}
\displaystyle=X\text{ with $X\in\mathbb{R}^{d_{0}\times n}$}
X\in\mathbb{R}^{d_{0}\times n}
\displaystyle L^{l,h}_{i,j}=A_{ij}\frac{\sigma_{c}}{\sqrt{2{d_{l-1}}}}(c_{1}^{%
l,h^{T}}G^{l-1}_{\cdot i}+c_{2}^{l,h^{T}}G^{l-1}_{\cdot j})
\displaystyle L^{l,h}_{i,j}
\displaystyle=A_{ij}\frac{\sigma_{c}}{\sqrt{2{d_{l-1}}}}(c_{1}^{l,h^{T}}G^{l-1%
}_{\cdot i}+c_{2}^{l,h^{T}}G^{l-1}_{\cdot j})
c_{1}^{l,h},c_{2}^{l,h}\in\mathbb{R}^{d_{l-1}}
\displaystyle F^{l,h}=G^{l-1}\sigma_{1}(L^{l,h})
\displaystyle F^{l,h}
\displaystyle=G^{l-1}\sigma_{1}(L^{l,h})
\displaystyle F^{l}=\frac{\sigma_{w}}{\sqrt{Hd_{l-1}}}W^{l}\left[F^{l,1},F^{l,%
2},\cdots,F^{l,H}\right]^{T}
\displaystyle F^{l}
\displaystyle=\frac{\sigma_{w}}{\sqrt{Hd_{l-1}}}W^{l}\left[F^{l,1},F^{l,2},%
\cdots,F^{l,H}\right]^{T}
W\in\mathbb{R}^{d_{l}\times Hd_{l-1}}
F^{l}
\displaystyle F^{l}=\frac{\sigma_{w}}{\sqrt{Hd_{l-1}}}\sum_{h}^{H}W^{l,h}F^{l,h}
\displaystyle F^{l}
\displaystyle=\frac{\sigma_{w}}{\sqrt{Hd_{l-1}}}\sum_{h}^{H}W^{l,h}F^{l,h}
\displaystyle G^{l}=\sigma_{2}(F^{l})
\displaystyle G^{l}
\displaystyle=\sigma_{2}(F^{l})
W^{l},c^{l,h}\sim N(0,1)
l
H
\displaystyle F^{l}=\frac{\sigma_{w}}{\sqrt{Hd_{l-1}}}W^{l}\left[F^{l,1},F^{l,%
2},\cdots,F^{l,H}\right]^{T}
\displaystyle F^{l}
\displaystyle=\frac{\sigma_{w}}{\sqrt{Hd_{l-1}}}W^{l}\left[F^{l,1},F^{l,2},%
\cdots,F^{l,H}\right]^{T}
\{H,d_{l-1}\}\to\infty
F^{l+1}
\operatorname{vec}(F^{l+1})\sim\text{GP}\left(0,\Lambda^{l}\otimes I_{d_{l+1}}\right)
\displaystyle\Lambda^{l}:=\mathbb{E}\bigl{[}\sigma_{2}(u)\sigma_{2}(u^{T})%
\bigr{]}\text{ with u $\sim\text{GP}\left(0,\operatorname{\mathrm{batchm}}%
\left(\sigma_{w}^{2}\Lambda^{l-1},\psi(\Lambda^{l-1})\right)\right)$}
\sim\text{GP}\left(0,\operatorname{\mathrm{batchm}}\left(\sigma_{w}^{2}\Lambda%
^{l-1},\psi(\Lambda^{l-1})\right)\right)
\displaystyle\Lambda^{l}
\displaystyle:=\mathbb{E}\bigl{[}\sigma_{2}(u)\sigma_{2}(u^{T})\bigr{]}\text{ %
with u $\sim\text{GP}\left(0,\operatorname{\mathrm{batchm}}\left(\sigma_{w}^{2%
}\Lambda^{l-1},\psi(\Lambda^{l-1})\right)\right)$}
\sim\text{GP}\left(0,\operatorname{\mathrm{batchm}}\left(\sigma_{w}^{2}\Lambda%
^{l-1},\psi(\Lambda^{l-1})\right)\right)
\displaystyle\psi(\Lambda^{l}):=\mathbb{E}\bigl{[}\sigma_{1}(v)\sigma_{1}(v^{T%
})\bigr{]}\text{ with $v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)%
\right)$}
v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)\right)
\displaystyle\psi(\Lambda^{l})
\displaystyle:=\mathbb{E}\bigl{[}\sigma_{1}(v)\sigma_{1}(v^{T})\bigr{]}\text{ %
with $v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)\right)$}
v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)\right)
\gamma_{A}(\Omega):=J_{A}\begin{pmatrix}\Omega&\Omega\\
\Omega&\Omega\\
\end{pmatrix}J_{A}^{T}\text{ and $J_{A}=\operatorname{diag}(\operatorname{vec}%
(A))\operatorname{concat}\left((\mathbf{1}_{n}\otimes I_{n}),(I_{n}\otimes%
\mathbf{1}_{n})\right)$}
J_{A}=\operatorname{diag}(\operatorname{vec}(A))\operatorname{concat}\left((%
\mathbf{1}_{n}\otimes I_{n}),(I_{n}\otimes\mathbf{1}_{n})\right)
\displaystyle\Lambda^{0}=\frac{1}{d_{1}}X^{T}X
\displaystyle\Lambda^{0}
\displaystyle=\frac{1}{d_{1}}X^{T}X
L
\Theta^{L}\otimes I_{d_{l}}
\displaystyle\Lambda^{l}:=\mathbb{E}\bigl{[}\sigma_{2}(v)\sigma_{2}(v^{T})%
\bigr{]}),\ \dot{\Lambda}^{l}:=\mathbb{E}\bigl{[}\dot{\sigma}_{2}(v)\dot{%
\sigma}_{2}(v^{T})\bigr{]}\text{ with $v\sim\text{GP}\left(0,\Lambda^{l-1}%
\right)$}
v\sim\text{GP}\left(0,\Lambda^{l-1}\right)
\displaystyle\Lambda^{l}
\displaystyle:=\mathbb{E}\bigl{[}\sigma_{2}(v)\sigma_{2}(v^{T})\bigr{]}),\ %
\dot{\Lambda}^{l}:=\mathbb{E}\bigl{[}\dot{\sigma}_{2}(v)\dot{\sigma}_{2}(v^{T}%
)\bigr{]}\text{ with $v\sim\text{GP}\left(0,\Lambda^{l-1}\right)$}
v\sim\text{GP}\left(0,\Lambda^{l-1}\right)
\displaystyle\dot{\psi}(\Lambda^{l}):=\mathbb{E}\bigl{[}\dot{\sigma}_{1}(v)%
\dot{\sigma}_{1}(v^{T})\bigr{]}\text{ with $v\sim\text{GP}\left(0,\sigma_{c}^{%
2}\gamma_{A}(\Omega)\right)$}
v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)\right)
\displaystyle\dot{\psi}(\Lambda^{l})
\displaystyle:=\mathbb{E}\bigl{[}\dot{\sigma}_{1}(v)\dot{\sigma}_{1}(v^{T})%
\bigr{]}\text{ with $v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)%
\right)$}
v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Omega)\right)
\displaystyle\Theta^{1}=\Lambda^{0}=\sigma_{w}^{2}\frac{1}{d_{1}}X^{T}X
\displaystyle\Theta^{1}
\displaystyle=\Lambda^{0}=\sigma_{w}^{2}\frac{1}{d_{1}}X^{T}X
\displaystyle\Theta^{L}=\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}%
\Lambda^{L-1},\psi(\Lambda^{L-1})\right]
\displaystyle\Theta^{L}
\displaystyle=\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\psi(\Lambda^{L-1})\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\sigma_{c}^{2}\left(\gamma_{A}(\Lambda^{L-1})\odot\dot{\psi}(\Lambda^{L-1})%
\right)\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\sigma_{c}^{2}\left(\gamma_{A}(\Lambda^{L-1})\odot\dot{\psi}(\Lambda^{L-1})%
\right)\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\sigma^{2}_{c}\left(\gamma_{A}(\Theta^{L-1}\odot\dot{\Lambda}^{L-1})\odot\dot{%
\psi}(\Lambda^{L-1})\right)\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\sigma^{2}_{c}\left(\gamma_{A}(\Theta^{L-1}\odot\dot{\Lambda}^{L-1})\odot\dot{%
\psi}(\Lambda^{L-1})\right)\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\left(\Theta^{%
L-1}\odot\dot{\Lambda}^{L-1}\right),\psi(\Lambda^{L-1})\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\left(\Theta^{%
L-1}\odot\dot{\Lambda}^{L-1}\right),\psi(\Lambda^{L-1})\right]
L
\sigma_{1}
\Theta^{L}\otimes I_{d_{l}}
\displaystyle\Lambda^{l}:=\mathbb{E}\bigl{[}\sigma_{2}(v)\sigma_{2}(v^{T})%
\bigr{]}),\ \dot{\Lambda}^{l}:=\mathbb{E}\bigl{[}\dot{\sigma}_{2}(v)\dot{%
\sigma}_{2}(v^{T})\bigr{]}\text{ with $v\sim\text{GP}\left(0,\Lambda^{l-1}%
\right)$}
v\sim\text{GP}\left(0,\Lambda^{l-1}\right)
\displaystyle\Lambda^{l}
\displaystyle:=\mathbb{E}\bigl{[}\sigma_{2}(v)\sigma_{2}(v^{T})\bigr{]}),\ %
\dot{\Lambda}^{l}:=\mathbb{E}\bigl{[}\dot{\sigma}_{2}(v)\dot{\sigma}_{2}(v^{T}%
)\bigr{]}\text{ with $v\sim\text{GP}\left(0,\Lambda^{l-1}\right)$}
v\sim\text{GP}\left(0,\Lambda^{l-1}\right)
\displaystyle\Theta^{1}=\Lambda^{0}=\sigma_{w}^{2}\frac{1}{d_{1}}X^{T}X
\displaystyle\Theta^{1}
\displaystyle=\Lambda^{0}=\sigma_{w}^{2}\frac{1}{d_{1}}X^{T}X
\displaystyle\Theta^{L}=2\cdot\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{%
2}\Lambda^{L-1},\sigma_{c}^{2}\gamma_{A}(\Lambda^{L-1})\right]
\displaystyle\Theta^{L}
\displaystyle=2\cdot\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^%
{L-1},\sigma_{c}^{2}\gamma_{A}(\Lambda^{L-1})\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\sigma^{2}_{c}\gamma_{A}\left(\Theta^{L-1}\odot\dot{\Lambda}^{L-1}\right)\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{L-1},%
\sigma^{2}_{c}\gamma_{A}\left(\Theta^{L-1}\odot\dot{\Lambda}^{L-1}\right)\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\left(\Theta^{%
L-1}\odot\dot{\Lambda}^{L-1}\right),\sigma_{c}^{2}\gamma_{A}(\Lambda^{L-1})\right]
\displaystyle+\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\left(\Theta^{%
L-1}\odot\dot{\Lambda}^{L-1}\right),\sigma_{c}^{2}\gamma_{A}(\Lambda^{L-1})\right]
\sigma_{w}^{2}\Lambda^{l-1}
\sigma_{w}^{2}\Lambda^{l-1}+\sigma_{b}^{2}
{((A_{1},X_{1},y_{1}),(A_{2},X_{2},y_{2}),...,(A_{n},X_{n},y_{n})}
F^{3}(A_{i},X_{i})_{h}=\sum_{h}F^{2}(A_{i},X_{i})_{\cdot h}
F^{3}(A_{i},X_{i})\in\mathbb{R}^{d_{3}}
F^{2}(A_{i},X_{i})\in\mathbb{R}^{d_{2}\times d_{3}}
\operatorname{vec}(F^{3})\sim GP(0,\Sigma)
\Sigma_{ij}=\sum_{st}\left(A_{i}\Lambda^{1}A_{j}^{T}\right)_{st}
\displaystyle\Lambda^{1}=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})%
\right]+\sigma_{b}^{2}
\displaystyle\Lambda^{1}
\displaystyle=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})\right]+%
\sigma_{b}^{2}
u\sim N(0,A_{i}\Lambda^{0}A_{j}^{T})
\displaystyle\Lambda^{0}=\frac{\sigma^{2}_{w}}{d_{0}}X_{i}^{T}X_{j}+\sigma^{2}%
_{b}
\displaystyle\Lambda^{0}
\displaystyle=\frac{\sigma^{2}_{w}}{d_{0}}X_{i}^{T}X_{j}+\sigma^{2}_{b}
\sum_{st}\Theta^{L}(i,j)_{st}
\displaystyle\Theta^{L}(i,j)=\sum_{st}\left(A_{i}\left(\Lambda^{L-1}+\left(%
\dot{\Lambda}^{L-1}\odot\Theta^{L-1}\right)\right)A_{j}^{T}\right)_{st}\text{ %
with }
\displaystyle\Lambda^{L}=\sigma^{2}_{w}\mathbb{E}\left[\sigma(u)\sigma(u^{T})%
\right]+\sigma_{b}^{2}
\displaystyle\dot{\Lambda}^{L}=\sigma^{2}_{w}\mathbb{E}\left[\dot{\sigma}(u)%
\dot{\sigma}(u^{T})\right]+\sigma_{b}^{2}
u\sim N(0,A_{i}\Lambda^{L-1}A_{j}^{T})
\displaystyle\Theta^{1}=\Lambda^{0}=\sigma^{2}_{w}X_{i}^{T}X_{j}+\sigma^{2}_{b}
\Theta^{L}(i,j)
(A_{i},X_{i})
(A_{j},X_{j})
R^{2}
I
R^{2}
\lambda I
\sigma_{w}^{2}
\sigma_{c}^{2}
\sigma_{b}^{2}
\sigma_{b}^{2}=0.1
\sigma_{b}^{2}
\sigma_{1}
\sigma_{2}
\sigma_{2}
\sigma_{1}
R^{2}
R^{2}
\displaystyle\psi(\Lambda^{l}):=\mathbb{E}\bigl{[}\sigma_{1}(v)\sigma_{1}(v^{T%
})\bigr{]}\text{ with $v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Lambda^%
{l-1})\right)\text{and }\gamma_{A}(\Omega):=J_{A}\begin{pmatrix}\Omega&\Omega%
\\
\Omega&\Omega\\
\end{pmatrix}J_{A}^{T}$}
v\sim\text{GP}\left(0,\sigma_{c}^{2}\gamma_{A}(\Lambda^{l-1})\right)\text{and %
}\gamma_{A}(\Omega):=J_{A}\begin{pmatrix}\Omega&\Omega\\
\Omega&\Omega\\
\end{pmatrix}J_{A}^{T}
J_{A}=\operatorname{diag}(\operatorname{vec}(A))\operatorname{concat}\left((%
\mathbf{1}_{n}\otimes I_{n}),(I_{n}\otimes\mathbf{1}_{n})\right)
\gamma_{A}(\Omega):=J_{A}\begin{pmatrix}\Lambda^{l}&\Lambda^{l}\\
\Lambda^{l}&\Lambda^{l}\end{pmatrix}J_{A}^{T}
\in\mathbb{R}^{n^{2}\times n^{2}}
A\in\mathbb{R}^{n\times n}
400,000\times 400,000
\psi(\Lambda^{l}):=\mathbb{E}\bigl{[}\sigma_{1}(v)\sigma_{1}(v^{T})\bigr{]}
\sigma_{1}
\psi(\Lambda^{l})=\gamma_{A}(\Omega)
\sigma_{1}
\displaystyle G^{1}=W^{1}X
\displaystyle F^{2}=\sigma_{2}(G^{1}\sigma_{1}(A\odot C))\text{ with }C_{ij}=c%
_{1}^{T}G^{1}_{\dot{i}}+c_{2}^{T}G^{1}_{\dot{j}}
\sigma_{1}(0)=0
F^{2}=\sigma_{2}(G^{1}(A\odot\sigma_{1}(C)))
\displaystyle\psi(\Lambda^{l}):=\gamma_{A}\biggl{(}\mathbb{E}\bigl{[}\sigma_{1%
}(v)\sigma_{1}(v^{T})\bigr{]}\biggr{)}\text{ with $v\sim\text{GP}\left(0,%
\sigma_{c}^{2}\Lambda^{l-1}\right)$}
v\sim\text{GP}\left(0,\sigma_{c}^{2}\Lambda^{l-1}\right)
\mathbb{E}\bigl{[}\sigma_{1}(v)\sigma_{1}(v^{T})\bigr{]}
\in\mathbb{R}^{n\times n}
\in\mathbb{R}^{n^{2}\times n^{2}}
\gamma_{A}(\Omega)
\sigma_{b}^{2}
\sigma_{b}^{2}=0.1
\sigma_{b}^{2}=0
\sigma_{b}^{2}=0
\sigma_{b}^{2}=0
\sigma_{b}^{2}
\sigma_{b}^{2}
R^{2}
\sigma_{b}=0
\sigma_{b}=0
\sigma_{b}=0
\sigma_{b}=0
\sigma_{b}=0
\sigma_{b}=0
\sigma_{b}^{2}
\sigma_{b}^{2}
F(\theta,X)
W^{l}
b^{l}
\displaystyle\frac{\partial\operatorname{vec}(F(\theta,X))}{\partial%
\operatorname{vec}(W^{l})}=\frac{\partial\operatorname{vec}(F^{L})}{\partial%
\operatorname{vec}(G^{L-1})}\frac{\partial\operatorname{vec}(G^{L-1})}{%
\partial\operatorname{vec}(F^{L-1)}}\cdots\frac{\partial\operatorname{vec}(F^{%
l+1})}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l%
})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l})}%
{\partial\operatorname{vec}(W^{l})}
\displaystyle\frac{\partial\operatorname{vec}(F(\theta,X))}{\partial%
\operatorname{vec}(W^{l})}=\frac{\partial\operatorname{vec}(F^{L})}{\partial%
\operatorname{vec}(G^{L-1})}\frac{\partial\operatorname{vec}(G^{L-1})}{%
\partial\operatorname{vec}(F^{L-1)}}\cdots\frac{\partial\operatorname{vec}(F^{%
l+1})}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l%
})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l})}%
{\partial\operatorname{vec}(W^{l})}
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(G^{h-1})}=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{h})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(G^{h-1})}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{h})
\displaystyle\Sigma^{h}:=\frac{\partial\operatorname{vec}(G^{h})}{\partial%
\operatorname{vec}(F^{h})}=\operatorname{diag}(\operatorname{vec}(\dot{\sigma}%
(F^{h}))
\displaystyle\Sigma^{h}:=\frac{\partial\operatorname{vec}(G^{h})}{\partial%
\operatorname{vec}(F^{h})}
\displaystyle=\operatorname{diag}(\operatorname{vec}(\dot{\sigma}(F^{h}))
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(W^{h})}=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(G^{h-1^{T}}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(W^{h})}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(G^{h-1^{T}}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial b^{h}}=\sigma_{%
b}(\mathbf{1}_{n}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial b^{h}}
\displaystyle=\sigma_{b}(\mathbf{1}_{n}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F(X))}{\partial\operatorname{vec%
}(W^{l})}=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{L})\Sigma^{L-1}%
\cdots\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{l})\Sigma^{l}\frac{%
\sigma_{w}}{\sqrt{d_{h-1}}}(G^{l-1^{T}}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F(X))}{\partial\operatorname{vec%
}(W^{l})}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{L})\Sigma^{L-1%
}\cdots\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{l})\Sigma^{l}\frac{%
\sigma_{w}}{\sqrt{d_{h-1}}}(G^{l-1^{T}}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F(X))}{\partial b^{l}}=\frac{%
\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{L})\Sigma^{L-1}\cdots\frac{\sigma_%
{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{l})\Sigma^{l}\sigma_{b}(\mathbf{1}_{n}%
\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F(X))}{\partial b^{l}}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{L})\Sigma^{L-1%
}\cdots\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(I_{n}\otimes W^{l})\Sigma^{l}\sigma_{%
b}(\mathbf{1}_{n}\otimes I_{d_{h}})
\mathrm{Cov}(\text{Y})_{IJ}\in\mathbb{R}^{d_{1}\times d_{1}}
\mathrm{Cov}(\text{Y}_{\cdot i},\text{Y}_{\cdot j})
\mathbb{E}(Y)_{I}\in\mathbb{R}^{d_{1}}
\mathbb{E}(Y_{\cdot i})
\mathbb{E}(x)
\mathrm{Cov}(x,x^{\prime})
\displaystyle\mathbb{E}(\text{Y})_{I}=\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X_{%
\cdot i}+\sigma_{b}b^{1}=0
\displaystyle\mathbb{E}(\text{Y})_{I}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X_{\cdot i}+\sigma_{b}b^{1}=0
\displaystyle\mathrm{Cov}(\text{Y})_{IJ}=\mathbb{E}\biggl{[}\left(\frac{\sigma%
_{w}}{\sqrt{d_{0}}}W^{1}X_{\cdot i}+\sigma_{b}b^{1}\right)\left(\frac{\sigma_{%
w}}{\sqrt{d_{0}}}W^{1}X_{\cdot j}+\sigma_{b}b^{1}\right)^{T}\biggl{]}
\displaystyle\mathrm{Cov}(\text{Y})_{IJ}
\displaystyle=\mathbb{E}\biggl{[}\left(\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X_{%
\cdot i}+\sigma_{b}b^{1}\right)\left(\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X_{%
\cdot j}+\sigma_{b}b^{1}\right)^{T}\biggl{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}\mathbb{E}\biggl{[}W^{1}X_{\cdot i}X%
_{\cdot j}^{T}W^{1^{T}}\biggr{]}+\sigma^{2}_{b}\mathbb{E}\biggl{[}b^{1}b^{1^{T%
}}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}\mathbb{E}\biggl{[}W^{1}X_{\cdot i}X%
_{\cdot j}^{T}W^{1^{T}}\biggr{]}+\sigma^{2}_{b}\mathbb{E}\biggl{[}b^{1}b^{1^{T%
}}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}I_{d_{1}}\left<X_{\cdot i},X_{\cdot j%
}\right>+I_{d_{1}}\sigma^{2}_{b}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}I_{d_{1}}\left<X_{\cdot i},X_{\cdot j%
}\right>+I_{d_{1}}\sigma^{2}_{b}
\displaystyle=I_{d_{1}}\left(\frac{\sigma_{w}^{2}}{d_{0}}\left<X_{\cdot i},X_{%
\cdot j}\right>+\sigma^{2}_{b}\right)
\displaystyle=I_{d_{1}}\left(\frac{\sigma_{w}^{2}}{d_{0}}\left<X_{\cdot i},X_{%
\cdot j}\right>+\sigma^{2}_{b}\right)
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{1}))=\frac{\sigma_{w}}{\sqrt{d_{%
0}}}\operatorname{vec}(W^{1}X)+\sigma_{b}\operatorname{vec}(B^{1})=0
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{1}))
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{0}}}\operatorname{vec}(W^{1}X)+\sigma%
_{b}\operatorname{vec}(B^{1})=0
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{1}))=\mathbb{E}\biggl{[}\biggl%
{(}\frac{\sigma_{w}}{\sqrt{d_{0}}}\operatorname{vec}(W^{1}X)+\sigma_{b}%
\operatorname{vec}(B^{1}\biggr{)}\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{0}}}%
\operatorname{vec}(W^{1}X)+\sigma_{b}\operatorname{vec}(B^{1}))^{T}\biggr{)}%
\biggr{]}
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{1}))
\displaystyle=\mathbb{E}\biggl{[}\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{0}}}%
\operatorname{vec}(W^{1}X)+\sigma_{b}\operatorname{vec}(B^{1}\biggr{)}\biggl{(%
}\frac{\sigma_{w}}{\sqrt{d_{0}}}\operatorname{vec}(W^{1}X)+\sigma_{b}%
\operatorname{vec}(B^{1}))^{T}\biggr{)}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}\mathbb{E}\biggl{[}\operatorname{vec%
}(W^{1}X)\operatorname{vec}(W^{1}X)^{T}\biggr{]}+\sigma^{2}_{b}\mathbb{E}%
\biggl{[}\operatorname{vec}(B^{1})\operatorname{vec}(B^{1})^{T}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}\mathbb{E}\biggl{[}\operatorname{vec%
}(W^{1}X)\operatorname{vec}(W^{1}X)^{T}\biggr{]}+\sigma^{2}_{b}\mathbb{E}%
\biggl{[}\operatorname{vec}(B^{1})\operatorname{vec}(B^{1})^{T}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}\mathbb{E}\biggl{[}(I_{n}\otimes W^{%
1})\operatorname{vec}(X)\operatorname{vec}(X)^{T}(I_{n}\otimes W^{1^{T}})%
\biggr{]}+\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{1}})
\displaystyle=\frac{\sigma_{w}^{2}}{d_{0}}\mathbb{E}\biggl{[}(I_{n}\otimes W^{%
1})\operatorname{vec}(X)\operatorname{vec}(X)^{T}(I_{n}\otimes W^{1^{T}})%
\biggr{]}+\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{1}})
\displaystyle=\biggl{(}\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+\sigma^{2}_{b}\biggr%
{)}\otimes I_{d_{1}}
\displaystyle=\biggl{(}\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+\sigma^{2}_{b}\biggr%
{)}\otimes I_{d_{1}}
\displaystyle\mathbb{E}(\text{Y}^{l+1})_{I}=0
\displaystyle\mathbb{E}(\text{Y}^{l+1})_{I}
\displaystyle=0
\displaystyle\mathrm{Cov}(\text{Y}^{l+1})_{IJ}=\mathbb{E}\bigg{[}\biggl{(}%
\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l+1}G^{l}_{\cdot i})+\sigma_{b}b^{l+1}\biggr%
{)}\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l+1}\sigma(Y^{l}_{\cdot i})+%
\sigma_{b}b^{l+1})\biggr{)}^{T}\biggr{]}
\displaystyle\mathrm{Cov}(\text{Y}^{l+1})_{IJ}
\displaystyle=\mathbb{E}\bigg{[}\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l+1%
}G^{l}_{\cdot i})+\sigma_{b}b^{l+1}\biggr{)}\biggl{(}\frac{\sigma_{w}}{\sqrt{d%
_{l}}}W^{l+1}\sigma(Y^{l}_{\cdot i})+\sigma_{b}b^{l+1})\biggr{)}^{T}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\biggr{[}W^{l+1}\sigma(Y^{%
l}_{\cdot i})\sigma(Y^{l}_{\cdot j})^{T}W^{l+1^{T}}\biggr{]}+\sigma^{2}_{b}I_{%
d_{l}}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\biggr{[}W^{l+1}\sigma(Y^{%
l}_{\cdot i})\sigma(Y^{l}_{\cdot j})^{T}W^{l+1^{T}}\biggr{]}+\sigma^{2}_{b}I_{%
d_{l}}
\displaystyle\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}(W^{l+1}\sigma(Y^{l}_{\cdot
i%
})\sigma(Y^{l}_{\cdot j}W^{l+1^{T}})^{T})_{uv}=\frac{\sigma^{2}_{w}}{d_{l}}%
\operatorname{tr}(\sigma(Y^{l}_{\cdot i})\sigma(Y^{l}_{\cdot j})^{T})\delta_{uv}
\displaystyle\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}(W^{l+1}
\displaystyle\sigma(Y^{l}_{\cdot i})\sigma(Y^{l}_{\cdot j}W^{l+1^{T}})^{T})_{%
uv}=\frac{\sigma^{2}_{w}}{d_{l}}\operatorname{tr}(\sigma(Y^{l}_{\cdot i})%
\sigma(Y^{l}_{\cdot j})^{T})\delta_{uv}
\displaystyle\delta_{uv}\frac{\sigma^{2}_{w}}{d_{l}}\sum_{n=1}^{d_{l}}\sigma(Y%
^{l}_{nj})\sigma(Y^{l}_{ni})\overset{\overset{P}{d_{l}\rightarrow\infty}}{%
\longrightarrow}\sigma^{2}_{w}\delta_{uv}\underset{s,t\sim N(0,\biggl{(}\begin%
{smallmatrix}\Lambda^{l-1}_{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\end{smallmatrix}\biggr{)})}{\mathbb{E}}%
\bigl{[}\sigma(s)\sigma(t)\bigr{]}
\displaystyle\delta_{uv}\frac{\sigma^{2}_{w}}{d_{l}}\sum_{n=1}^{d_{l}}\sigma(Y%
^{l}_{nj})\sigma(Y^{l}_{ni})\overset{\overset{P}{d_{l}\rightarrow\infty}}{%
\longrightarrow}\sigma^{2}_{w}\delta_{uv}\underset{s,t\sim N(0,\biggl{(}\begin%
{smallmatrix}\Lambda^{l-1}_{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\end{smallmatrix}\biggr{)})}{\mathbb{E}}%
\bigl{[}\sigma(s)\sigma(t)\bigr{]}
Y^{l}_{ni}
Y^{l}_{mi}
n\neq m
\mathrm{Cov}(Y^{l}_{\cdot i},Y^{l}_{\cdot j}
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{l+1}))=\frac{\sigma_{w}}{\sqrt{d%
_{l}}}\operatorname{vec}(W^{l+1}G^{l})+\sigma_{b}\operatorname{vec}(B^{l+1})=0
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{l+1}))
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{l}}}\operatorname{vec}(W^{l+1}G^{l})+%
\sigma_{b}\operatorname{vec}(B^{l+1})=0
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{l+1}))=\mathbb{E}\biggr{[}%
\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{l}}}\operatorname{vec}(W^{l+1}G^{l})+%
\sigma_{b}\operatorname{vec}(B^{l+1}\biggl{)}\biggr{(}\frac{\sigma_{w}}{\sqrt{%
d_{l}}}\operatorname{vec}(W^{l+1}G^{l})+\sigma_{b}\operatorname{vec}(B^{l+1})^%
{T}\biggl{)}\biggr{]}
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{l+1}))
\displaystyle=\mathbb{E}\biggr{[}\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{l}}}%
\operatorname{vec}(W^{l+1}G^{l})+\sigma_{b}\operatorname{vec}(B^{l+1}\biggl{)}%
\biggr{(}\frac{\sigma_{w}}{\sqrt{d_{l}}}\operatorname{vec}(W^{l+1}G^{l})+%
\sigma_{b}\operatorname{vec}(B^{l+1})^{T}\biggl{)}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\bigl{[}\operatorname{vec}%
(W^{l+1}G^{l})\operatorname{vec}(G^{l^{T}}W^{l+1^{T}}\bigl{]}+\sigma^{2}_{b}(%
\mathds{1}_{n}\otimes I_{d_{l}})
\displaystyle=\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\bigl{[}\operatorname{vec}%
(W^{l+1}G^{l})\operatorname{vec}(G^{l^{T}}W^{l+1^{T}}\bigl{]}+\sigma^{2}_{b}(%
\mathds{1}_{n}\otimes I_{d_{l}})
\displaystyle=\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\bigl{[}(I_{n}\otimes W^{l%
+1})\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}(I_{n}\otimes W^{l+1%
^{T}})\bigr{]}+\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{l+1}})
\displaystyle=\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\bigl{[}(I_{n}\otimes W^{l%
+1})\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}(I_{n}\otimes W^{l+1%
^{T}})\bigr{]}+\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{l+1}})
\displaystyle\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\bigl{[}(I_{n}\otimes W^{l+%
1})\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}(I_{n}\otimes W^{l+1^%
{T}})\bigr{]}+\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{l}})
\displaystyle\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{E}\bigl{[}(I_{n}\otimes W^{l+%
1})\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}(I_{n}\otimes W^{l+1^%
{T}})\bigr{]}+\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{l}})
\displaystyle=\left(\sigma_{w}^{2}\begin{pmatrix}\mathbb{E}\bigl{[}\sigma(u_{1%
})\sigma(u_{1})\bigr{]}&\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{2})\bigr{]}%
\dots&\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{n})\bigr{]}\\
\vdots&\ddots&\vdots\\
\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{1})\bigr{]}&\dots&\mathbb{E}\bigl{[}%
\sigma(u_{n})\sigma(u_{n})\bigr{]}\end{pmatrix}+\sigma^{2}_{b}\right)\otimes I%
_{d_{l+1}}
\displaystyle=\left(\sigma_{w}^{2}\begin{pmatrix}\mathbb{E}\bigl{[}\sigma(u_{1%
})\sigma(u_{1})\bigr{]}&\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{2})\bigr{]}%
\dots&\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{n})\bigr{]}\\
\vdots&\ddots&\vdots\\
\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{1})\bigr{]}&\dots&\mathbb{E}\bigl{[}%
\sigma(u_{n})\sigma(u_{n})\bigr{]}\end{pmatrix}+\sigma^{2}_{b}\right)\otimes I%
_{d_{l+1}}
\displaystyle\text{ with }u\sim N(0,\Lambda^{L-1})
\displaystyle\text{ with }u\sim N(0,\Lambda^{L-1})
\operatorname{vec}(AXB)=(B^{T}\otimes A)\operatorname{vec}(X)
\ell(\theta)
\frac{d\theta(t)}{dt}=-\nabla\ell(\theta(t))
F(\theta,X)
\displaystyle\frac{du(t)}{dt}=-H(t)\cdot\operatorname{vec}(u(t)-Y)
\displaystyle\frac{du(t)}{dt}
\displaystyle=-H(t)\cdot\operatorname{vec}(u(t)-Y)
\displaystyle\text{with }u(t)=F(\theta(t),X)
\displaystyle\text{with }u(t)
\displaystyle=F(\theta(t),X)
\displaystyle\text{and }H(t)=\frac{\partial\operatorname{vec}(F(\theta(t),X)}{%
\partial\theta}\left(\frac{\partial\operatorname{vec}(F(\theta(t),X)}{\partial%
\theta}\right)^{T}
\displaystyle\text{and }H(t)
\displaystyle=\frac{\partial\operatorname{vec}(F(\theta(t),X)}{\partial\theta}%
\left(\frac{\partial\operatorname{vec}(F(\theta(t),X)}{\partial\theta}\right)^%
{T}
\theta
\displaystyle\frac{d\theta(t)}{dt}=-\nabla\ell(\theta(t))=\left(\frac{\partial%
\operatorname{vec}(F(\theta(t),X)}{\partial\theta}\right)^{T}\operatorname{vec%
}(F(\theta(t),X)-Y)^{T}
\displaystyle\frac{d\theta(t)}{dt}
\displaystyle=-\nabla\ell(\theta(t))=\left(\frac{\partial\operatorname{vec}(F(%
\theta(t),X)}{\partial\theta}\right)^{T}\operatorname{vec}(F(\theta(t),X)-Y)^{T}
t>0
F(\theta(l),X)
\displaystyle\frac{dF(\theta(t),X}{dt}=\frac{\partial\operatorname{vec}(F(%
\theta(t),X)}{\partial\theta}\left(\frac{\partial\operatorname{vec}(F(\theta(t%
),X)}{\partial\theta}\right)^{T}\operatorname{vec}(F(\theta(t),X)-Y)^{T}
\displaystyle\frac{dF(\theta(t),X}{dt}
\displaystyle=\frac{\partial\operatorname{vec}(F(\theta(t),X)}{\partial\theta}%
\left(\frac{\partial\operatorname{vec}(F(\theta(t),X)}{\partial\theta}\right)^%
{T}\operatorname{vec}(F(\theta(t),X)-Y)^{T}
\emph{u}(t)=\operatorname{vec}(F(\theta(t),X))
\displaystyle\frac{d\emph{u}(t)}{dt}=-\emph{H}(t)\cdot\operatorname{vec}(\emph%
{u}(t)-Y)
\displaystyle\frac{d\emph{u}(t)}{dt}
\displaystyle=-\emph{H}(t)\cdot\operatorname{vec}(\emph{u}(t)-Y)
H(t)
H(0)
H(0)
H^{*}
\Theta
H(t)=H^{*}
t
\displaystyle\frac{du(t)}{dt}=-H^{*}\cdot\operatorname{vec}(u(t)-Y)
\displaystyle\frac{du(t)}{dt}
\displaystyle=-H^{*}\cdot\operatorname{vec}(u(t)-Y)
t\rightarrow\infty
\displaystyle F^{*}(X_{test})=H^{*}_{test,train}(H_{train,train}^{*})^{-1}y
\displaystyle F^{*}(X_{test})=H^{*}_{test,train}(H_{train,train}^{*})^{-1}y
H_{train,train}^{*}
l
\displaystyle\Theta^{l}=\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{%
\partial\theta}\left(\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{%
\partial\theta}\right)^{T}
\displaystyle\Theta^{l}=\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{%
\partial\theta}\left(\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{%
\partial\theta}\right)^{T}
\displaystyle\Theta^{L}=\sum_{h=1}^{H}\frac{\partial\operatorname{vec}(F^{L}(%
\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F(\theta,X)}{\partial\operatorname{vec}(W^{h})}\right)^{T}+%
\frac{\partial\operatorname{vec}(F(\theta,X))}{\partial\operatorname{vec}(b^{h%
})}\left(\frac{\partial\operatorname{vec}(F^{L}(\theta,X)}{\partial%
\operatorname{vec}(b^{h})}\right)^{T}
\displaystyle\Theta^{L}=\sum_{h=1}^{H}\frac{\partial\operatorname{vec}(F^{L}(%
\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F(\theta,X)}{\partial\operatorname{vec}(W^{h})}\right)^{T}+%
\frac{\partial\operatorname{vec}(F(\theta,X))}{\partial\operatorname{vec}(b^{h%
})}\left(\frac{\partial\operatorname{vec}(F^{L}(\theta,X)}{\partial%
\operatorname{vec}(b^{h})}\right)^{T}
\displaystyle\Theta^{1}=\Lambda{{}^{1}}=\frac{\partial\operatorname{vec}(F^{1}%
(\theta,X))}{\partial\operatorname{vec}(W^{1})}\left(\frac{\partial%
\operatorname{vec}(F^{1}(\theta,X)}{\partial\operatorname{vec}(W^{1})}\right)^%
{T}+\frac{\partial\operatorname{vec}(F^{1}(\theta,X))}{\partial\operatorname{%
vec}(b^{1})}\left(\frac{\partial\operatorname{vec}(F^{1}(\theta,X)}{\partial%
\operatorname{vec}(b^{1})}\right)^{T}
\displaystyle\Theta^{1}
\displaystyle=\Lambda{{}^{1}}=\frac{\partial\operatorname{vec}(F^{1}(\theta,X)%
)}{\partial\operatorname{vec}(W^{1})}\left(\frac{\partial\operatorname{vec}(F^%
{1}(\theta,X)}{\partial\operatorname{vec}(W^{1})}\right)^{T}+\frac{\partial%
\operatorname{vec}(F^{1}(\theta,X))}{\partial\operatorname{vec}(b^{1})}\left(%
\frac{\partial\operatorname{vec}(F^{1}(\theta,X)}{\partial\operatorname{vec}(b%
^{1})}\right)^{T}
\displaystyle=(\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+{\sigma^{2}_{b}})\otimes I_{%
d_{1}}
\displaystyle=(\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+{\sigma^{2}_{b}})\otimes I_{%
d_{1}}
\displaystyle\Theta^{l+1}=\sum_{h=1}^{l+1}\frac{\partial\operatorname{vec}(F^{%
l+1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X)}{\partial\operatorname{vec}(W^{h})}\right%
)^{T}
\displaystyle\Theta^{l+1}
\displaystyle=\sum_{h=1}^{l+1}\frac{\partial\operatorname{vec}(F^{l+1}(\theta,%
X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial\operatorname{vec}(%
F^{l+1}(\theta,X)}{\partial\operatorname{vec}(W^{h})}\right)^{T}
\displaystyle=\underbrace{\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}%
{\partial\operatorname{vec}(W^{l+1})}\left(\frac{\partial\operatorname{vec}(F^%
{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{l+1})}\right)^{T}+\frac{%
\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(b^{l%
+1})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{l+1})}\right)^{T}}_{B}
\displaystyle=\underbrace{\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}%
{\partial\operatorname{vec}(W^{l+1})}\left(\frac{\partial\operatorname{vec}(F^%
{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{l+1})}\right)^{T}+\frac{%
\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(b^{l%
+1})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{l+1})}\right)^{T}}_{B}
\displaystyle+\underbrace{\sum_{h=1}^{l}\frac{\partial\operatorname{vec}(F^{l+%
1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}%
\right)^{T}+\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{h})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(%
\theta,X))}{\partial\operatorname{vec}(b^{h})}\right)^{T}}_{\Gamma}
\displaystyle+\underbrace{\sum_{h=1}^{l}\frac{\partial\operatorname{vec}(F^{l+%
1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}%
\right)^{T}+\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{h})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(%
\theta,X))}{\partial\operatorname{vec}(b^{h})}\right)^{T}}_{\Gamma}
\displaystyle B=\frac{\sigma^{2}_{w}}{d_{l}}(G^{l^{T}}G\otimes I_{d_{l+1}})+%
\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{l+1}})=(\frac{\sigma^{2}_{w}}{d_{l}%
}G^{l^{T}}G^{l}+\sigma^{2}_{b})\otimes I_{d_{l+1}}
\displaystyle B
\displaystyle=\frac{\sigma^{2}_{w}}{d_{l}}(G^{l^{T}}G\otimes I_{d_{l+1}})+%
\sigma^{2}_{b}(\mathds{1}_{n}\otimes I_{d_{l+1}})=(\frac{\sigma^{2}_{w}}{d_{l}%
}G^{l^{T}}G^{l}+\sigma^{2}_{b})\otimes I_{d_{l+1}}
\displaystyle(\frac{\sigma^{2}_{w}}{d_{l}}G^{l^{T}}G^{l})_{ij}=\frac{\sigma^{2%
}_{w}}{d_{l}}\sum_{m}^{d_{l}}G^{l}_{im}G^{l}_{jm}\overset{\overset{P}{d_{l}%
\rightarrow\infty}}{\longrightarrow}\sigma^{2}_{w}\underset{u,v\sim N(0,\biggl%
{(}\begin{smallmatrix}\Lambda^{l-1}_{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\end{smallmatrix}\biggr{)})}{\mathbb{E}}%
\bigl{[}\sigma(u)\sigma(v)\bigr{]}
\displaystyle(\frac{\sigma^{2}_{w}}{d_{l}}G^{l^{T}}G^{l})_{ij}=\frac{\sigma^{2%
}_{w}}{d_{l}}\sum_{m}^{d_{l}}G^{l}_{im}G^{l}_{jm}\overset{\overset{P}{d_{l}%
\rightarrow\infty}}{\longrightarrow}\sigma^{2}_{w}\underset{u,v\sim N(0,\biggl%
{(}\begin{smallmatrix}\Lambda^{l-1}_{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\end{smallmatrix}\biggr{)})}{\mathbb{E}}%
\bigl{[}\sigma(u)\sigma(v)\bigr{]}
d_{l}\rightarrow\infty
\displaystyle\implies B=\Lambda^{L}\otimes I_{d_{l+1}}
\displaystyle\implies B=\Lambda^{L}\otimes I_{d_{l+1}}
\displaystyle\Gamma=\sum_{h=1}^{l}\left(\frac{\partial\operatorname{vec}(F^{l+%
1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{%
vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec%
}(F^{l}(\theta,X))}{\partial\operatorname{vec}(W^{l})}\right)\left(\frac{%
\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l%
})}\frac{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}%
\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(%
W^{l})}\right)^{T}
\displaystyle\Gamma
\displaystyle=\sum_{h=1}^{l}\left(\frac{\partial\operatorname{vec}(F^{l+1}(%
\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}%
(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^%
{l}(\theta,X))}{\partial\operatorname{vec}(W^{l})}\right)\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{%
\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(W^{l})%
}\right)^{T}
\displaystyle+\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{%
\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l})}{%
\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l}(%
\theta,X))}{\partial\operatorname{vec}(b^{l})}\right)\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{%
\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(b^{l})%
}\right)^{T}
\displaystyle+\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{%
\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l})}{%
\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l}(%
\theta,X))}{\partial\operatorname{vec}(b^{l})}\right)\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{%
\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(b^{l})%
}\right)^{T}
\displaystyle=\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l})}{\partial%
\operatorname{vec}(F^{l})}(\Theta^{l}\otimes I_{d_{l}})\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\right)^%
{T}
\displaystyle=\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l})}{\partial%
\operatorname{vec}(F^{l})}(\Theta^{l}\otimes I_{d_{l}})\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\right)^%
{T}
\displaystyle=\frac{\sigma^{2_{w}}}{d_{l}}(I_{n}\otimes W^{l+1})\Sigma^{l}(%
\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}})
\displaystyle=\frac{\sigma^{2_{w}}}{d_{l}}(I_{n}\otimes W^{l+1})\Sigma^{l}(%
\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}})
\displaystyle T_{IJ}=\left(\frac{\sigma_{w}^{2}}{d_{l}}(I_{n}\otimes W^{l+1})%
\Sigma^{l}(\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}})\right)%
_{IJ}=\frac{\sigma_{w}^{2}}{d_{l}}W^{l+1}\Sigma^{l}_{II}\Theta^{l}_{ij}\Sigma^%
{l}_{JJ}W^{l+1^{T}}
\displaystyle T_{IJ}
\displaystyle=\left(\frac{\sigma_{w}^{2}}{d_{l}}(I_{n}\otimes W^{l+1})\Sigma^{%
l}(\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}})\right)_{IJ}=%
\frac{\sigma_{w}^{2}}{d_{l}}W^{l+1}\Sigma^{l}_{II}\Theta^{l}_{ij}\Sigma^{l}_{%
JJ}W^{l+1^{T}}
\displaystyle=\Theta^{l}_{ij}\frac{\sigma_{w}^{2}}{d_{l}}W^{l+1}\Sigma^{l}_{II%
}\Sigma^{l}_{JJ}W^{l+1^{T}}
\displaystyle=\Theta^{l}_{ij}\frac{\sigma_{w}^{2}}{d_{l}}W^{l+1}\Sigma^{l}_{II%
}\Sigma^{l}_{JJ}W^{l+1^{T}}
\displaystyle(\frac{\sigma_{w}^{2}}{d_{l}}W{}^{l+1}\Sigma^{l}_{II}\Sigma^{l}_{%
JJ}W^{l+1^{T}})_{uv}=\frac{\sigma_{w}^{2}}{d_{l}}\sum_{st}^{d_{l}}\Sigma^{l}_{%
II_{ss}}\Sigma^{l}_{JJ_{tt}}W_{us}W_{vt}\overset{\overset{P}{d_{l}\rightarrow%
\infty}}{\longrightarrow}\delta_{uv}\sigma^{2}_{w}\underset{s,t\sim N(0,\biggl%
{(}\begin{smallmatrix}\Lambda^{l-1}_{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\\
\end{smallmatrix}\biggr{)})}{\mathbb{E}}\bigl{[}\dot{\sigma}(s)\dot{\sigma}(t)%
\bigr{]}
\displaystyle(\frac{\sigma_{w}^{2}}{d_{l}}W
{}^{l+1}\Sigma^{l}_{II}\Sigma^{l}_{JJ}W^{l+1^{T}})_{uv}=\frac{\sigma_{w}^{2}}{%
d_{l}}\sum_{st}^{d_{l}}\Sigma^{l}_{II_{ss}}\Sigma^{l}_{JJ_{tt}}W_{us}W_{vt}%
\overset{\overset{P}{d_{l}\rightarrow\infty}}{\longrightarrow}\delta_{uv}%
\sigma^{2}_{w}\underset{s,t\sim N(0,\biggl{(}\begin{smallmatrix}\Lambda^{l-1}_%
{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\\
\end{smallmatrix}\biggr{)})}{\mathbb{E}}\bigl{[}\dot{\sigma}(s)\dot{\sigma}(t)%
\bigr{]}
\Sigma^{l}
l-1
\displaystyle\implies T=(\Theta\odot\dot{\Lambda}^{L})\otimes I_{d_{l+1}}
\displaystyle\implies T
\displaystyle=(\Theta\odot\dot{\Lambda}^{L})\otimes I_{d_{l+1}}
\displaystyle\implies\Theta^{l+1}=B+\Gamma=\Lambda^{l}+\left(\dot{\Lambda}^{l}%
\odot\Theta^{l}\right)
\displaystyle\implies\Theta^{l+1}
\displaystyle=B+\Gamma=\Lambda^{l}+\left(\dot{\Lambda}^{l}\odot\Theta^{l}\right)
F(\theta,X)
W^{l}
\displaystyle\frac{\partial\operatorname{vec}(F(\theta,X))}{\partial%
\operatorname{vec}(W^{l})}=\frac{\partial\operatorname{vec}(F^{L})}{\partial%
\operatorname{vec}(G^{L-1})}\frac{\partial\operatorname{vec}(G^{L-1})}{%
\partial\operatorname{vec}(F^{L-1)}}\cdots\frac{\partial\operatorname{vec}(F^{%
l+1})}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l%
})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l})}%
{\partial\operatorname{vec}(W^{l})}
\displaystyle\frac{\partial\operatorname{vec}(F(\theta,X))}{\partial%
\operatorname{vec}(W^{l})}=\frac{\partial\operatorname{vec}(F^{L})}{\partial%
\operatorname{vec}(G^{L-1})}\frac{\partial\operatorname{vec}(G^{L-1})}{%
\partial\operatorname{vec}(F^{L-1)}}\cdots\frac{\partial\operatorname{vec}(F^{%
l+1})}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l%
})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l})}%
{\partial\operatorname{vec}(W^{l})}
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(G^{h-1})}=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(A\otimes W^{h})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(G^{h-1})}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(A\otimes W^{h})
\displaystyle\Sigma^{h}:=\frac{\partial\operatorname{vec}(G^{h})}{\partial%
\operatorname{vec}(F^{h})}=\operatorname{diag}(\operatorname{vec}(\dot{\sigma}%
(F^{h}))
\displaystyle\Sigma^{h}:=\frac{\partial\operatorname{vec}(G^{h})}{\partial%
\operatorname{vec}(F^{h})}
\displaystyle=\operatorname{diag}(\operatorname{vec}(\dot{\sigma}(F^{h}))
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(W^{h})}=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(AG^{h-1^{T}}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial\operatorname{%
vec}(W^{h})}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{h-1}}}(AG^{h-1^{T}}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial b^{h}}=\sigma_{%
b}(A\mathbf{1}_{n}\otimes I_{d_{h}})
\displaystyle\frac{\partial\operatorname{vec}(F^{h})}{\partial b^{h}}
\displaystyle=\sigma_{b}(A\mathbf{1}_{n}\otimes I_{d_{h}})
\text{Y}^{L}=F^{L}(X)
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{1}))=\frac{\sigma_{w}}{\sqrt{d_{%
0}}}\operatorname{vec}\left(\biggl{(}\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X+%
\sigma_{b}B^{1}\biggr{)}A^{T}\right)=0
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{1}))
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{0}}}\operatorname{vec}\left(\biggl{(}%
\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X+\sigma_{b}B^{1}\biggr{)}A^{T}\right)=0
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{1}))=\mathrm{Cov}\bigl{[}(A%
\otimes I_{d_{1}})\operatorname{vec}(\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X+%
\sigma_{b}B^{1})\bigr{]}
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{1}))
\displaystyle=\mathrm{Cov}\bigl{[}(A\otimes I_{d_{1}})\operatorname{vec}(\frac%
{\sigma_{w}}{\sqrt{d_{0}}}W^{1}X+\sigma_{b}B^{1})\bigr{]}
\displaystyle=(A\otimes I_{d_{1}})\mathbb{E}\bigl{[}\operatorname{vec}(\frac{%
\sigma_{w}}{\sqrt{d_{0}}}W^{1}XA^{T}+\sigma_{b}B^{1})\bigr{]}(A^{T}\otimes I_{%
d_{1}})
\displaystyle=(A\otimes I_{d_{1}})\mathbb{E}\bigl{[}\operatorname{vec}(\frac{%
\sigma_{w}}{\sqrt{d_{0}}}W^{1}XA^{T}+\sigma_{b}B^{1})\bigr{]}(A^{T}\otimes I_{%
d_{1}})
\displaystyle=(A\Lambda^{1}A^{T})\otimes I_{d_{1}}
\displaystyle=(A\Lambda^{1}A^{T})\otimes I_{d_{1}}
(A\otimes B)(C\otimes D)=(AC\otimes BD)
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{l+1}))=0
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{l+1}))
\displaystyle=0
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{l+1}))=(A\Lambda^{l+1}A^{T})%
\otimes I_{d_{l+1}}
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{l+1}))
\displaystyle=(A\Lambda^{l+1}A^{T})\otimes I_{d_{l+1}}
\displaystyle\Theta^{1}=\Lambda{{}^{1}}=\frac{\partial\operatorname{vec}(F^{1}%
(\theta,X))}{\partial\operatorname{vec}(W^{1})}\left(\frac{\partial%
\operatorname{vec}(F^{1}(\theta,X)}{\partial\operatorname{vec}(W^{1})}\right)^%
{T}+\frac{\partial\operatorname{vec}(F^{1}(\theta,X))}{\partial\operatorname{%
vec}(b^{1})}\left(\frac{\partial\operatorname{vec}(F^{1}(\theta,X)}{\partial%
\operatorname{vec}(b^{1})}\right)^{T}
\displaystyle\Theta^{1}=\Lambda{{}^{1}}=\frac{\partial\operatorname{vec}(F^{1}%
(\theta,X))}{\partial\operatorname{vec}(W^{1})}\left(\frac{\partial%
\operatorname{vec}(F^{1}(\theta,X)}{\partial\operatorname{vec}(W^{1})}\right)^%
{T}+\frac{\partial\operatorname{vec}(F^{1}(\theta,X))}{\partial\operatorname{%
vec}(b^{1})}\left(\frac{\partial\operatorname{vec}(F^{1}(\theta,X)}{\partial%
\operatorname{vec}(b^{1})}\right)^{T}
\displaystyle=\bigl{(}A\bigl{(}\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+{\sigma^{2}_%
{b}}\bigr{)}A^{T}\bigr{)}\otimes I_{d_{1}}
\displaystyle=\bigl{(}A\bigl{(}\frac{\sigma^{2}_{w}}{d_{0}}X^{T}X+{\sigma^{2}_%
{b}}\bigr{)}A^{T}\bigr{)}\otimes I_{d_{1}}
\displaystyle\Theta^{l+1}=\sum_{h=1}^{l+1}\frac{\partial\operatorname{vec}(F^{%
l+1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X)}{\partial\operatorname{vec}(W^{h})}\right%
)^{T}
\displaystyle\Theta^{l+1}
\displaystyle=\sum_{h=1}^{l+1}\frac{\partial\operatorname{vec}(F^{l+1}(\theta,%
X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial\operatorname{vec}(%
F^{l+1}(\theta,X)}{\partial\operatorname{vec}(W^{h})}\right)^{T}
\displaystyle=\underbrace{\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}%
{\partial\operatorname{vec}(W^{l+1})}\left(\frac{\partial\operatorname{vec}(F^%
{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{l+1})}\right)^{T}+\frac{%
\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(b^{l%
+1})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{l+1})}\right)^{T}}_{B}
\displaystyle=\underbrace{\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}%
{\partial\operatorname{vec}(W^{l+1})}\left(\frac{\partial\operatorname{vec}(F^%
{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{l+1})}\right)^{T}+\frac{%
\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(b^{l%
+1})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{l+1})}\right)^{T}}_{B}
\displaystyle+\underbrace{\sum_{h=1}^{l}\frac{\partial\operatorname{vec}(F^{l+%
1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}%
\right)^{T}+\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{h})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(%
\theta,X))}{\partial\operatorname{vec}(b^{h})}\right)^{T}}_{\Gamma}
\displaystyle+\underbrace{\sum_{h=1}^{l}\frac{\partial\operatorname{vec}(F^{l+%
1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(W^{h})}%
\right)^{T}+\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial%
\operatorname{vec}(b^{h})}\left(\frac{\partial\operatorname{vec}(F^{l+1}(%
\theta,X))}{\partial\operatorname{vec}(b^{h})}\right)^{T}}_{\Gamma}
\displaystyle B=\biggl{(}A\biggl{(}\frac{\sigma^{2}_{w}}{d_{l}}G^{l^{T}}G^{l}+%
\sigma^{2}_{b}\biggr{)}A^{T}\biggr{)}\otimes I_{d_{l+1}}
\displaystyle B
\displaystyle=\biggl{(}A\biggl{(}\frac{\sigma^{2}_{w}}{d_{l}}G^{l^{T}}G^{l}+%
\sigma^{2}_{b}\biggr{)}A^{T}\biggr{)}\otimes I_{d_{l+1}}
\displaystyle\implies B=A\left(\Lambda^{L}\otimes I_{d_{l+1}}\right)A^{T}
\displaystyle\implies B=A\left(\Lambda^{L}\otimes I_{d_{l+1}}\right)A^{T}
\displaystyle\Gamma=\sum_{h=1}^{l}\left(\frac{\partial\operatorname{vec}(F^{l+%
1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{%
vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec%
}(F^{l}(\theta,X))}{\partial\operatorname{vec}(W^{l})}\right)\left(\frac{%
\partial\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l%
})}\frac{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}%
\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(%
W^{l})}\right)^{T}
\displaystyle\Gamma
\displaystyle=\sum_{h=1}^{l}\left(\frac{\partial\operatorname{vec}(F^{l+1}(%
\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}%
(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^%
{l}(\theta,X))}{\partial\operatorname{vec}(W^{l})}\right)\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{%
\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(W^{l})%
}\right)^{T}
\displaystyle+\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{%
\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l})}{%
\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l}(%
\theta,X))}{\partial\operatorname{vec}(b^{l})}\right)\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{%
\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(b^{l})%
}\right)^{T}
\displaystyle+\left(\frac{\partial\operatorname{vec}(F^{l+1}(\theta,X))}{%
\partial\operatorname{vec}(G^{l})}\frac{\partial\operatorname{vec}(G^{l})}{%
\partial\operatorname{vec}(F^{l})}\frac{\partial\operatorname{vec}(F^{l}(%
\theta,X))}{\partial\operatorname{vec}(b^{l})}\right)\left(\frac{\partial%
\operatorname{vec}(F^{l+1}(\theta,X))}{\partial\operatorname{vec}(G^{l})}\frac%
{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}\frac{%
\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\operatorname{vec}(b^{l})%
}\right)^{T}
\displaystyle=\frac{\sigma^{2_{w}}}{d_{l}}(A\otimes W^{l+1})\Sigma^{l}(\Theta^%
{l}\otimes I_{d})\Sigma^{l}(A^{T}\otimes W^{l+1^{T}})
\displaystyle=\frac{\sigma^{2_{w}}}{d_{l}}(A\otimes W^{l+1})\Sigma^{l}(\Theta^%
{l}\otimes I_{d})\Sigma^{l}(A^{T}\otimes W^{l+1^{T}})
\displaystyle=\frac{\sigma^{2_{w}}}{d_{l}}(A\otimes I_{d_{l}})(I_{n}\otimes W^%
{l+1})\Sigma^{l}(\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}}(A%
^{T}\otimes I_{d_{l}}))
\displaystyle=\frac{\sigma^{2_{w}}}{d_{l}}(A\otimes I_{d_{l}})(I_{n}\otimes W^%
{l+1})\Sigma^{l}(\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}}(A%
^{T}\otimes I_{d_{l}}))
\displaystyle\implies T=(A(\Theta\odot\dot{\Lambda}^{L})A^{T})\otimes I_{d_{l+%
1}}
\displaystyle\implies T=(A(\Theta\odot\dot{\Lambda}^{L})A^{T})\otimes I_{d_{l+%
1}}
\Sigma^{h}
\displaystyle\Sigma^{h}:=\frac{\partial\operatorname{vec}(G^{h})}{\partial%
\operatorname{vec}(F^{h})}=\begin{pmatrix}\operatorname{diag}(\operatorname{%
vec}\dot{\sigma}(F^{h}_{\cdot 1}))&0&0&\dots&0\\
I_{d_{h}}&0&0&\dots&0\\
0&\operatorname{diag}(\operatorname{vec}\dot{\sigma}(F^{h}_{\cdot 2}))&0&\dots%
&0\\
0&I_{d_{h}}&0&\dots\\
0&0&\ddots\\
\vdots&\vdots&\ddots\\
0&0&&\dots&\operatorname{diag}(\operatorname{vec}\dot{\sigma}(F^{h}_{\cdot n})%
)\\
0&0&0&\dots&I_{d_{h}}\\
\end{pmatrix}\in\mathbb{R}^{2d_{l}n\times 2d_{l}n}
\displaystyle\Sigma^{h}:=\frac{\partial\operatorname{vec}(G^{h})}{\partial%
\operatorname{vec}(F^{h})}=\begin{pmatrix}\operatorname{diag}(\operatorname{%
vec}\dot{\sigma}(F^{h}_{\cdot 1}))&0&0&\dots&0\\
I_{d_{h}}&0&0&\dots&0\\
0&\operatorname{diag}(\operatorname{vec}\dot{\sigma}(F^{h}_{\cdot 2}))&0&\dots%
&0\\
0&I_{d_{h}}&0&\dots\\
0&0&\ddots\\
\vdots&\vdots&\ddots\\
0&0&&\dots&\operatorname{diag}(\operatorname{vec}\dot{\sigma}(F^{h}_{\cdot n})%
)\\
0&0&0&\dots&I_{d_{h}}\\
\end{pmatrix}\in\mathbb{R}^{2d_{l}n\times 2d_{l}n}
\displaystyle\Sigma^{h}\text{ is block-diagonal, with each block }\Sigma^{h}_{%
II}=\begin{pmatrix}\operatorname{diag}(\operatorname{vec}\dot{\sigma}(F^{h}_{%
\cdot i}))\\
I_{d_{h}}\end{pmatrix}
\displaystyle\Sigma^{h}\text{ is block-diagonal, with each block }\Sigma^{h}_{%
II}=\begin{pmatrix}\operatorname{diag}(\operatorname{vec}\dot{\sigma}(F^{h}_{%
\cdot i}))\\
I_{d_{h}}\end{pmatrix}
\text{Y}^{L}=F^{L}(X)
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{1}))=0
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{1}))=(A\Lambda^{1}A^{T})%
\otimes I_{d_{1}}
\displaystyle\mathbb{E}(\operatorname{vec}(Y^{l+1}))=0
\displaystyle\mathrm{Cov}(\operatorname{vec}(Y^{l+1}))=\mathrm{Cov}\bigl{[}(A%
\otimes I_{d_{l+1}})\operatorname{vec}(\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{l+1}G%
^{l}A^{T}+\sigma_{b}B^{l+1})\bigr{]}
\displaystyle=(A\otimes I_{d_{l+1}})\mathrm{Cov}\bigl{[}\operatorname{vec}(%
\frac{\sigma_{w}}{\sqrt{d_{0}}}W^{l+1}G^{l}+\sigma_{b}B^{1})\bigr{]}(A^{T}%
\otimes I_{d_{l+1}})
\displaystyle=(A\otimes I_{d_{l+1}})\left(\frac{\sigma_{w}^{2}}{d_{l}}\mathbb{%
E}\biggl{[}(I_{n}\otimes W^{l+1})\operatorname{vec}(G^{l})\operatorname{vec}(G%
^{l})^{T}(I_{n}\otimes W^{l+1^{T}})\biggr{]}+\sigma_{b}^{2}(\mathds{1}_{n}%
\otimes\mathbf{1}_{d_{l+1}})\right)(A^{T}\otimes I_{d_{l+1}})
\displaystyle\frac{\sigma_{w}^{2}}{2d_{l}}\mathbb{E}\biggl{[}(I_{n}\otimes W^{%
l+1})\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}(I_{n}\otimes W^{l+%
1^{T}})\biggr{]}_{IJ_{uv}}=\frac{\sigma_{w}^{2}}{2d_{l}}\mathbb{E}\biggl{[}W_{%
u}(\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T})_{IJ}W_{v}^{T}\biggr%
{]}
Z:=\left(\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}\right)_{IJ}
Z_{11}
\mathbb{R}^{d_{l}\times d_{l}}
W^{l+1}_{u}=\biggl{[}\overset{\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u},%
\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}\biggr{]}
\overset{\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u},\overset{%
\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}\in\mathbb{R}^{1\times d_{l}}
W^{l+1}_{u}
d_{l}
\displaystyle\frac{\sigma_{w}^{2}}{2d_{l}}\mathbb{E}\biggl{[}W_{u}(%
\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T})_{IJ}W_{v}^{T}\biggr{]}
\displaystyle=\frac{\sigma_{w}^{2}}{2d_{l}}\mathbb{E}\biggl{[}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u}Z_{11}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 1}{%
W}\vphantom{W}^{l+1}_{u}Z_{12}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}+\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}Z_{21}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 2}{%
W}\vphantom{W}^{l+1}_{u}Z_{22}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}\biggr{]}
\displaystyle=\delta_{uv}\frac{\sigma_{w}^{2}}{2d_{l}}\mathbb{E}\biggl{[}%
\overset{\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u}Z_{11}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 2}{%
W}\vphantom{W}^{l+1}_{u}Z_{22}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}\biggr{]}
\displaystyle=\delta_{uv}\frac{\sigma_{w}^{2}}{2d_{l}}\left(\sum_{s}^{d_{l}}%
\sigma(Y^{l})_{is}\sigma(Y^{l})_{js}+\sum_{s}^{d_{l}}(Y^{l}_{is}Y^{l}_{js})%
\right)=\delta_{uv}\frac{\sigma_{w}^{2}}{2d_{l}}\left(\sum_{s}^{d_{l}}\sigma(Y%
^{l})_{is}\sigma(Y^{l})_{js}+(Y^{l}_{is}Y^{l}_{js})\right)
\displaystyle\overset{\overset{P}{d_{l}\rightarrow\infty}}{\longrightarrow}%
\delta_{uv}\frac{1}{2}\biggl{(}\underset{s,t\sim N(0,\biggl{(}\begin{%
smallmatrix}\Lambda^{l-1}_{ii}&\Lambda^{l-1}_{ij}\\
\Lambda^{l-1}_{ji}&\Lambda^{l-1}_{jj}\end{smallmatrix}\biggr{)})}{\mathbb{E}}%
\bigl{[}\sigma(s)\sigma(t)\bigr{]}+\mathbb{E}\bigl{[}st\bigr{]}\biggr{)}
\Sigma^{l}
l-1
F^{1}
\displaystyle\Theta^{l+1}=B+\Gamma
\displaystyle\Theta^{l+1}
\displaystyle=B+\Gamma
\displaystyle B=\biggl{(}A\biggl{(}\frac{\sigma_{w}^{2}}{2d_{l}}G^{l^{T}}G^{l}%
+\sigma^{2}_{b}\mathds{1}_{n}\biggr{)}A^{T}\biggr{)}\otimes I_{d_{l+1}}
\displaystyle B
\displaystyle=\biggl{(}A\biggl{(}\frac{\sigma_{w}^{2}}{2d_{l}}G^{l^{T}}G^{l}+%
\sigma^{2}_{b}\mathds{1}_{n}\biggr{)}A^{T}\biggr{)}\otimes I_{d_{l+1}}
\displaystyle\frac{\sigma_{w}^{2}}{2d_{l}}G^{l^{T}}G^{l}\overset{\overset{P}{d%
_{l}\rightarrow\infty}}{\rightarrow}\sigma^{2}_{w}\begin{pmatrix}\frac{1}{2}%
\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{1})\bigr{]}+\mathbb{E}\bigl{%
[}u_{1}u_{1}\bigr{]}\biggr{)}&\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{%
1})\sigma(u_{2})\bigr{]}+\mathbb{E}\bigl{[}u_{1}u_{2}\bigr{]}\biggr{)}\dots&%
\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{n})\bigr{]}+%
\mathbb{E}\bigl{[}u_{1}u_{n}\bigr{]}\biggr{)}\\
\vdots&\ddots&\vdots\\
\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{1})\bigr{]}+%
\mathbb{E}\bigl{[}u_{n}u_{1}\bigr{]}\biggr{)}&\dots&\frac{1}{2}\biggl{(}%
\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{n})\bigr{]}+\mathbb{E}\bigl{[}u_{n}u_%
{n}\bigr{]}\biggr{)}\end{pmatrix}
\displaystyle\frac{\sigma_{w}^{2}}{2d_{l}}G^{l^{T}}G^{l}
\displaystyle\overset{\overset{P}{d_{l}\rightarrow\infty}}{\rightarrow}\sigma^%
{2}_{w}\begin{pmatrix}\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{1})%
\sigma(u_{1})\bigr{]}+\mathbb{E}\bigl{[}u_{1}u_{1}\bigr{]}\biggr{)}&\frac{1}{2%
}\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{1})\sigma(u_{2})\bigr{]}+\mathbb{E}\bigl%
{[}u_{1}u_{2}\bigr{]}\biggr{)}\dots&\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}%
\sigma(u_{1})\sigma(u_{n})\bigr{]}+\mathbb{E}\bigl{[}u_{1}u_{n}\bigr{]}\biggr{%
)}\\
\vdots&\ddots&\vdots\\
\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{1})\bigr{]}+%
\mathbb{E}\bigl{[}u_{n}u_{1}\bigr{]}\biggr{)}&\dots&\frac{1}{2}\biggl{(}%
\mathbb{E}\bigl{[}\sigma(u_{n})\sigma(u_{n})\bigr{]}+\mathbb{E}\bigl{[}u_{n}u_%
{n}\bigr{]}\biggr{)}\end{pmatrix}
\displaystyle\implies B=\Lambda^{L}\otimes I_{d_{l+1}}
\displaystyle\implies B=\Lambda^{L}\otimes I_{d_{l+1}}
\displaystyle\Gamma=\frac{\sigma^{2_{w}}}{2d_{l}}(A\otimes I_{d_{l}})(I_{n}%
\otimes W^{l+1})\Sigma^{l}(\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{%
l+1^{T}})(A^{T}\otimes I_{d_{l}}))
\displaystyle\Gamma=\frac{\sigma^{2_{w}}}{2d_{l}}(A\otimes I_{d_{l}})(I_{n}%
\otimes W^{l+1})\Sigma^{l}(\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{%
l+1^{T}})(A^{T}\otimes I_{d_{l}}))
\displaystyle\frac{\sigma^{2}_{w}}{2d_{l}}(I_{n}\otimes W^{l+1})\Sigma^{l}(%
\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}})_{IJ_{uv}}=\Theta_%
{ij}\frac{\sigma^{2}_{w}}{2d_{l}}W^{l+1}_{u}\Sigma^{l}_{II}\Sigma^{l^{T}}_{JJ}%
(W^{l+1}_{v})^{T}
\displaystyle\frac{\sigma^{2}_{w}}{2d_{l}}(I_{n}\otimes W^{l+1})\Sigma^{l}(%
\Theta^{l}\otimes I_{d})\Sigma^{l}(I_{n}\otimes W^{l+1^{T}})_{IJ_{uv}}=\Theta_%
{ij}\frac{\sigma^{2}_{w}}{2d_{l}}W^{l+1}_{u}\Sigma^{l}_{II}\Sigma^{l^{T}}_{JJ}%
(W^{l+1}_{v})^{T}
Z:=\left(\operatorname{vec}(G^{l})\operatorname{vec}(G^{l})^{T}\right)_{IJ}
Z_{11}
\mathbb{R}^{d_{l}\times d_{l}}
W^{l+1}_{u}=\biggl{[}\overset{\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u},%
\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}\biggr{]}
\overset{\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u},\overset{%
\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}\in\mathbb{R}^{1\times d_{l}}
W^{l+1}_{u}
d_{l}
\displaystyle=\Theta_{ij}\frac{\sigma_{w}^{2}}{2d_{l}}\left(\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u}Z_{11}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 1}{%
W}\vphantom{W}^{l+1}_{u}Z_{12}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}+\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}Z_{21}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 2}{%
W}\vphantom{W}^{l+1}_{u}Z_{22}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}\right)
\displaystyle=\Theta_{ij}\frac{\sigma_{w}^{2}}{2d_{l}}\left(\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{u}Z_{11}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 1}{%
W}\vphantom{W}^{l+1}_{u}Z_{12}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}+\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l+1}_{u}Z_{21}\overset{%
\scriptscriptstyle 1}{W}\vphantom{W}^{l+1}_{v}+\overset{\scriptscriptstyle 2}{%
W}\vphantom{W}^{l+1}_{u}Z_{22}\overset{\scriptscriptstyle 2}{W}\vphantom{W}^{l%
+1}_{v}\right)
\displaystyle\overset{\overset{P}{d_{l}\rightarrow\infty}}{\longrightarrow}%
\delta_{uv}\Theta_{ij}\sigma_{w}^{2}\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\dot%
{\sigma}(s)\dot{\sigma}(t)\bigr{]}+1\biggr{)}
\displaystyle\overset{\overset{P}{d_{l}\rightarrow\infty}}{\longrightarrow}%
\delta_{uv}\Theta_{ij}\sigma_{w}^{2}\frac{1}{2}\biggl{(}\mathbb{E}\bigl{[}\dot%
{\sigma}(s)\dot{\sigma}(t)\bigr{]}+1\biggr{)}
\displaystyle\overset{\scriptscriptstyle 2}{\Sigma}\vphantom{\sigma}^{l}:=%
\frac{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{vec}(F^{l})}=%
\operatorname{diag}(\operatorname{vec}(\dot{\sigma}_{2}(F^{l})))
\displaystyle\overset{\scriptscriptstyle 2}{\Sigma}\vphantom{\sigma}^{l}
\displaystyle:=\frac{\partial\operatorname{vec}(G^{l})}{\partial\operatorname{%
vec}(F^{l})}=\operatorname{diag}(\operatorname{vec}(\dot{\sigma}_{2}(F^{l})))
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(W^{l})}=\frac{\sigma_{w}}{\sqrt{d_{l-1}}}\left[F^{l1},\cdots,F^{lH}\right%
]\otimes I_{d_{l}}
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(W^{l})}
\displaystyle=\frac{\sigma_{w}}{\sqrt{d_{l-1}}}\left[F^{l1},\cdots,F^{lH}%
\right]\otimes I_{d_{l}}
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(\sigma_{1}(L^{l,h}))}=I_{n}\otimes\left(\frac{\sigma_{w}}{\sqrt{d_{l-1}}}%
W^{l,h}G^{l-1}\right)
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(\sigma_{1}(L^{l,h}))}
\displaystyle=I_{n}\otimes\left(\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h}G^{l-1%
}\right)
\displaystyle\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}:=%
\frac{\partial\operatorname{vec}(\sigma_{1}(L^{l,h}))}{\partial\operatorname{%
vec}(L^{l,h})}=\operatorname{diag}(\operatorname{vec}(\dot{\sigma}_{1}(L^{l,h}))
\displaystyle\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}
\displaystyle:=\frac{\partial\operatorname{vec}(\sigma_{1}(L^{l,h}))}{\partial%
\operatorname{vec}(L^{l,h})}=\operatorname{diag}(\operatorname{vec}(\dot{%
\sigma}_{1}(L^{l,h}))
\displaystyle\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{%
vec}(c^{l,h})}=\frac{\sigma_{c}}{\sqrt{2d_{l-1}}}\hat{A}\operatorname{concat}(%
(\mathbf{1}_{n}\otimes G^{T}),(G^{T}\otimes\mathbf{1}_{n}))\text{ with $\hat{A%
}:=\operatorname{diag}(\operatorname{vec}(A^{T})$}
\hat{A}:=\operatorname{diag}(\operatorname{vec}(A^{T})
\displaystyle\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{%
vec}(c^{l,h})}
\displaystyle=\frac{\sigma_{c}}{\sqrt{2d_{l-1}}}\hat{A}\operatorname{concat}((%
\mathbf{1}_{n}\otimes G^{T}),(G^{T}\otimes\mathbf{1}_{n}))\text{ with $\hat{A}%
:=\operatorname{diag}(\operatorname{vec}(A^{T})$}
\hat{A}:=\operatorname{diag}(\operatorname{vec}(A^{T})
\operatorname{vec}(L^{l,h})=\frac{\sigma_{c}}{\sqrt{2d_{l-1}}}\hat{A}\left((%
\mathbf{1}_{n}\otimes G^{T})c_{1}^{l,h}+(G^{T}\otimes\mathbf{1}_{n}^{T})c_{2}^%
{l,h}\right)
\frac{\sigma_{c}}{\sqrt{2d_{l-1}}}\hat{A}\left((\mathbf{1}_{n}\otimes G^{T}c_{%
1}^{l,h})+(G^{T}c_{2}^{l,h}\otimes\mathbf{1}_{n})\right)=\frac{\sigma_{c}}{%
\sqrt{2d_{l-1}}}\hat{A}\operatorname{concat}(\mathbf{1}_{n}\otimes I_{n},I_{n}%
\otimes\mathbf{1}_{n})\operatorname{concat}(G,G)^{T}
\displaystyle\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{%
vec}(G^{h-1})}=\frac{\sigma_{c}}{\sqrt{2d_{l-1}}}\hat{A}\left((\mathbf{1}_{n}%
\otimes(I_{n}\otimes c_{1}^{l,h^{T}})+(I_{n}\otimes c_{2}^{l,h^{T}})\otimes%
\mathbf{1}_{n})\right)
\displaystyle\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{%
vec}(G^{h-1})}
\displaystyle=\frac{\sigma_{c}}{\sqrt{2d_{l-1}}}\hat{A}\left((\mathbf{1}_{n}%
\otimes(I_{n}\otimes c_{1}^{l,h^{T}})+(I_{n}\otimes c_{2}^{l,h^{T}})\otimes%
\mathbf{1}_{n})\right)
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(G^{l-1})}=\frac{1}{\sqrt{H}}\sum_{h}^{H}\biggr{[}\left(I_{n}\otimes\left(%
\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h}G^{l-1}\right)\right)\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}\frac{\partial%
\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})}+\left(\sigma%
_{1}(L^{l,h})^{T}\otimes\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h}\right)\biggl{]}
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(G^{l-1})}=
\displaystyle\frac{1}{\sqrt{H}}\sum_{h}^{H}\biggr{[}\left(I_{n}\otimes\left(%
\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h}G^{l-1}\right)\right)\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}\frac{\partial%
\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})}+\left(\sigma%
_{1}(L^{l,h})^{T}\otimes\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h}\right)\biggl{]}
d^{-\frac{1}{2}}
d^{-\frac{1}{2}}
d_{l-1}\rightarrow\infty
\{H,d_{l-1}\}\to\infty
H,d_{l-1}
L
L
L_{ij}
L_{ij}
c
L
l-1
\operatorname{vec}(F^{l-1})\sim GP(0,\Omega\otimes I_{d_{l-1}})
\Omega
d_{l-1}\to\infty
\operatorname{vec}(L^{l})\sim GP(0,\psi(\Omega))
\displaystyle\psi(\Omega):=\mathbb{E}\bigl{[}\sigma_{1}(u)\sigma_{1}(u^{T})%
\bigr{]}\text{ with $u\sim GP\bigl{(}0,\sigma_{c}J_{A}\begin{pmatrix}\Omega&%
\Omega\\
\Omega&\Omega\\
\end{pmatrix}J_{A}^{T}\otimes I_{d_{l-1}}\bigr{)})$ }
u\sim GP\bigl{(}0,\sigma_{c}J_{A}\begin{pmatrix}\Omega&\Omega\\
\Omega&\Omega\\
\end{pmatrix}J_{A}^{T}\otimes I_{d_{l-1}}\bigr{)})
J_{A}:=\operatorname{diag}(\operatorname{vec}(A^{T})\operatorname{concat}((%
\mathbf{1}_{n}\otimes I_{n}),(I_{n}\otimes\mathbf{1}_{n}))
d_{l-1}\rightarrow\infty
L^{1}
\{d_{l-1}\}\rightarrow\infty
L^{l,h}
h
c^{l,h}
h
c^{l}
c^{l,h}
L^{l}
L^{l}
\displaystyle\mathbb{E}\bigl{[}L^{l}_{ij}\bigr{]}=0
\displaystyle\mathbb{E}\bigl{[}L^{l}_{ij}\bigr{]}
\displaystyle=0
\displaystyle\mathbb{E}\bigl{[}L^{l}_{lm}L^{l}_{st}\bigr{]}=\frac{\sigma_{c}^{%
2}}{2d_{l-1}}A_{lm}A_{st}\mathbb{E}\bigl{[}\left(c_{1}^{l^{T}}(G_{\cdot l}+G_{%
\cdot m})+c_{2}^{l^{T}}(G_{\cdot l}+G_{\cdot m})\right)+\left(c_{1}^{l^{T}}(G_%
{\cdot s}+G_{\cdot t})c_{2}^{l^{T}}(G_{\cdot s}+G_{\cdot t})\right)\bigr{]}=
\displaystyle\mathbb{E}\bigl{[}L^{l}_{lm}L^{l}_{st}\bigr{]}
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\mathbb{E}\bigl{[}%
\left(c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})+c_{2}^{l^{T}}(G_{\cdot l}+G_{%
\cdot m})\right)+\left(c_{1}^{l^{T}}(G_{\cdot s}+G_{\cdot t})c_{2}^{l^{T}}(G_{%
\cdot s}+G_{\cdot t})\right)\bigr{]}=
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\biggl{(}\mathbb{E}%
\bigl{[}c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{1}^{l^{T}}(G_{\cdot s}+G_{%
\cdot t})\bigr{]}+\mathbb{E}\bigl{[}c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{2%
}^{l^{T}}(G_{\cdot s}+G_{\cdot t})\bigr{]}
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\biggl{(}\mathbb{E}%
\bigl{[}c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{1}^{l^{T}}(G_{\cdot s}+G_{%
\cdot t})\bigr{]}+\mathbb{E}\bigl{[}c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{2%
}^{l^{T}}(G_{\cdot s}+G_{\cdot t})\bigr{]}
\displaystyle+\mathbb{E}\bigl{[}c_{2}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{1}^{l%
^{T}}(G_{\cdot s}+G_{\cdot t})\bigr{]}+\mathbb{E}\bigl{[}c_{2}^{l^{T}}(G_{%
\cdot l}+G_{\cdot m})c_{2}^{l^{T}}G_{\cdot l}{s}+G_{\cdot t})\bigr{]}\biggr{)}
\displaystyle+\mathbb{E}\bigl{[}c_{2}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{1}^{l%
^{T}}(G_{\cdot s}+G_{\cdot t})\bigr{]}+\mathbb{E}\bigl{[}c_{2}^{l^{T}}(G_{%
\cdot l}+G_{\cdot m})c_{2}^{l^{T}}G_{\cdot l}{s}+G_{\cdot t})\bigr{]}\biggr{)}
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\biggl{(}\mathbb{E}%
\bigl{[}c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{1}^{l^{T}}(G_{\cdot s}+G_{%
\cdot t})\bigr{]}+\mathbb{E}\bigl{[}c_{2}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{2%
}^{l^{T}}G_{\cdot l}{s}+G_{\cdot t})\bigr{]}\biggr{)}
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\biggl{(}\mathbb{E}%
\bigl{[}c_{1}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{1}^{l^{T}}(G_{\cdot s}+G_{%
\cdot t})\bigr{]}+\mathbb{E}\bigl{[}c_{2}^{l^{T}}(G_{\cdot l}+G_{\cdot m})c_{2%
}^{l^{T}}G_{\cdot l}{s}+G_{\cdot t})\bigr{]}\biggr{)}
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\biggl{(}\mathbb{E}%
\bigl{[}\sum_{uv}c_{1u}^{l}c_{1v}^{l}G_{ul}G_{vs}\bigr{]}+\mathbb{E}\bigl{[}%
\sum_{uv}c_{1u}^{l}c_{1v}^{l}G_{ul}G_{vt}\bigr{]}+\mathbb{E}\bigl{[}\sum_{uv}c%
_{1u}^{l}c_{1v}^{l}G_{um}G_{vs}\bigr{]}+\mathbb{E}\bigl{[}\sum_{uv}c_{1u}^{l}c%
_{1v}^{l}G_{um}G_{vt}\bigr{]}
\displaystyle=\frac{\sigma_{c}^{2}}{2d_{l-1}}A_{lm}A_{st}\biggl{(}\mathbb{E}%
\bigl{[}\sum_{uv}c_{1u}^{l}c_{1v}^{l}G_{ul}G_{vs}\bigr{]}+\mathbb{E}\bigl{[}%
\sum_{uv}c_{1u}^{l}c_{1v}^{l}G_{ul}G_{vt}\bigr{]}+\mathbb{E}\bigl{[}\sum_{uv}c%
_{1u}^{l}c_{1v}^{l}G_{um}G_{vs}\bigr{]}+\mathbb{E}\bigl{[}\sum_{uv}c_{1u}^{l}c%
_{1v}^{l}G_{um}G_{vt}\bigr{]}
\displaystyle+\mathbb{E}\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{ul}G_{vs}\bigr%
{]}+\mathbb{E}\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{ul}G_{vt}\bigr{]}+%
\mathbb{E}\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{um}G_{vs}\bigr{]}+\mathbb{E}%
\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{um}G_{vt}\bigr{]}\biggr{)}
\displaystyle+\mathbb{E}\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{ul}G_{vs}\bigr%
{]}+\mathbb{E}\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{ul}G_{vt}\bigr{]}+%
\mathbb{E}\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{um}G_{vs}\bigr{]}+\mathbb{E}%
\bigl{[}\sum_{uv}c_{2u}^{l}c_{2v}^{l}G_{um}G_{vt}\bigr{]}\biggr{)}
\overset{\text{Converges in probability for $d_{l-1}\rightarrow\infty$}}{\longrightarrow}
d_{l-1}\rightarrow\infty
\displaystyle\sigma_{c}^{2}A_{lm}A_{st}\biggl{(}\mathbb{E}\bigl{[}\sigma_{1}(u%
_{l})\sigma_{1}(u_{s})\bigr{]}+\mathbb{E}\bigl{[}\sigma_{1}(u_{l})\sigma_{1}(u%
_{t})\bigr{]}+\mathbb{E}\bigl{[}\sigma_{1}(u_{m})\sigma_{1}(u_{s})\bigr{]}+%
\mathbb{E}\bigl{[}\sigma_{1}(u_{m})\sigma_{1}(u_{t})\bigr{]}\biggr{)}
\displaystyle\sigma_{c}^{2}A_{lm}A_{st}\biggl{(}\mathbb{E}\bigl{[}\sigma_{1}(u%
_{l})\sigma_{1}(u_{s})\bigr{]}+\mathbb{E}\bigl{[}\sigma_{1}(u_{l})\sigma_{1}(u%
_{t})\bigr{]}+\mathbb{E}\bigl{[}\sigma_{1}(u_{m})\sigma_{1}(u_{s})\bigr{]}+%
\mathbb{E}\bigl{[}\sigma_{1}(u_{m})\sigma_{1}(u_{t})\bigr{]}\biggr{)}
u=\operatorname{vec}(F^{l-1})\sim GP(0,\Omega\otimes I_{d_{l-1}})
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\bigr{]}=0
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\bigr{]}
\displaystyle=0
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{vec}(F^{%
l})^{T}\bigr{]}=\mathbb{E}\bigl{[}\left(\sigma_{1}(L^{l,h})\otimes\frac{\sigma%
_{w}}{\sqrt{d_{l}}}W^{l,h}\right)G^{l-1^{T}}G^{l-1}\left(\sigma_{1}(L^{l,h})%
\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}\right)^{T}\bigr{]}
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{vec}(F^{%
l})^{T}\bigr{]}
\displaystyle=\mathbb{E}\bigl{[}\left(\sigma_{1}(L^{l,h})\otimes\frac{\sigma_{%
w}}{\sqrt{d_{l}}}W^{l,h}\right)G^{l-1^{T}}G^{l-1}\left(\sigma_{1}(L^{l,h})%
\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}\right)^{T}\bigr{]}
I,J
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{vec}(F^{%
l})^{T}\bigr{]}_{IJ}=
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{vec}(F^{%
l})^{T}\bigr{]}_{IJ}
\displaystyle=
\displaystyle\mathbb{E}\bigl{[}\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}%
\left(\sigma_{1}(L^{l,h})\otimes I_{d_{l}}\right)_{IS}\left[\left(I_{n}\otimes%
\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}\right)G^{l-1^{T}}G^{l-1}\left(I_{d_{l}}%
\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h^{T}}\right)\right]_{ST}\left(%
\sigma_{1}(L^{l,h})\otimes I_{d_{l}}\right)_{TJ}\bigr{]}
\displaystyle\mathbb{E}\bigl{[}\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}%
\left(\sigma_{1}(L^{l,h})\otimes I_{d_{l}}\right)_{IS}
\displaystyle\left[\left(I_{n}\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}%
\right)G^{l-1^{T}}G^{l-1}\left(I_{d_{l}}\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}%
W^{l,h^{T}}\right)\right]_{ST}\left(\sigma_{1}(L^{l,h})\otimes I_{d_{l}}\right%
)_{TJ}\bigr{]}
\displaystyle=\mathbb{E}\bigl{[}\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}%
\sigma_{1}(L^{l,h})_{is}\frac{\sigma_{w}^{2}}{d_{l}}W^{l,h}(G^{l-1^{T}}G^{l-1}%
)_{ST}W^{l,h^{\prime T}}\sigma_{1}(L^{l,h^{\prime}})_{tj}\bigr{]}
\displaystyle=\mathbb{E}\bigl{[}\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}%
\sigma_{1}(L^{l,h})_{is}\frac{\sigma_{w}^{2}}{d_{l}}W^{l,h}
\displaystyle(G^{l-1^{T}}G^{l-1})_{ST}W^{l,h^{\prime T}}\sigma_{1}(L^{l,h^{%
\prime}})_{tj}\bigr{]}
u,v
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{vec}(F^{%
l})^{T}\bigr{]}_{IJ_{uv}}=\mathbb{E}\bigl{[}\frac{1}{H}\sum_{h,h^{\prime}}^{H}%
\sum_{ST}\sum_{lm}\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}%
\frac{\sigma_{w}^{2}}{d_{l}}W^{l,h}_{ul}W^{l,h^{\prime}}_{vm}(G^{l-1^{T}}G^{l-%
1})_{ST_{lm}}\bigr{]}
\displaystyle\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{vec}(F^{%
l})^{T}\bigr{]}_{IJ_{uv}}
\displaystyle=\mathbb{E}\bigl{[}\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}%
\sum_{lm}\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}\frac{\sigma%
_{w}^{2}}{d_{l}}W^{l,h}_{ul}W^{l,h^{\prime}}_{vm}(G^{l-1^{T}}G^{l-1})_{ST_{lm}%
}\bigr{]}
\displaystyle=\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}\sum_{lm}\sigma_{1}(L%
^{l,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}\mathbb{E}\bigl{[}\frac{\sigma_{w%
}^{2}}{d_{l}}W^{l,h}_{ul}W^{l,h^{\prime}}_{vm}(G^{l-1^{T}}G^{l-1})_{ST_{lm}}%
\bigr{]}
\displaystyle=\frac{1}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}\sum_{lm}\sigma_{1}(L%
^{l,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}\mathbb{E}\bigl{[}\frac{\sigma_{w%
}^{2}}{d_{l}}W^{l,h}_{ul}W^{l,h^{\prime}}_{vm}(G^{l-1^{T}}G^{l-1})_{ST_{lm}}%
\bigr{]}
d_{l-1}\rightarrow\infty
\displaystyle\mathbb{E}\bigl{[}\frac{\sigma_{w}^{2}}{d_{l}}W^{l,h}_{ul}W^{l,h^%
{\prime}}_{vm}(G^{l-1^{T}}G^{l-1})_{ST_{lm}}\bigr{]}\overset{P}{\rightarrow}%
\sigma_{w}^{2}\Lambda^{l-1}_{ST_{lm}}
H\rightarrow\infty
\displaystyle\frac{\sigma_{w}^{2}}{H}\sum_{h,h^{\prime}}^{H}\sum_{ST}\sum_{lm}%
\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}\Lambda_{ST_{lm}}%
\overset{P}{\rightarrow}\sigma_{w}^{2}\mathbb{E}\bigl{[}\sum_{ST}\sum_{lm}%
\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}\Lambda_{ST_{lm}}%
\bigr{]}
\displaystyle\sigma_{w}^{2}\mathbb{E}\bigl{[}\sum_{ST}\sum_{lm}\sigma_{1}(L^{l%
,h})_{is}\sigma_{1}(L^{l,h^{\prime}})_{tj}\Lambda_{ST_{lm}}\bigr{]}=\sigma_{w}%
^{2}\sum_{st}^{n}\mathbb{E}\bigl{[}\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{(l,h^%
{\prime})})_{tj}\bigr{]}\Lambda^{l-1}_{st}=\sigma_{w}^{2}\sum_{st}^{n}\Lambda^%
{l-1}_{st}\psi(\Lambda^{l-1})_{IJ_{st}}
\displaystyle\implies\mathbb{E}\bigl{[}\operatorname{vec}(F^{l})\operatorname{%
vec}(F^{l})^{T}\bigr{]}\rightarrow\operatorname{\mathrm{batchm}}(\sigma_{w}^{2%
}\Lambda^{l-1},\psi(\Lambda^{l-1}))
\{H,d_{l-1}\}\rightarrow\infty
l
\displaystyle\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\theta%
}\left(\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\theta}%
\right)^{T}
\theta
\Theta^{l}\otimes I_{d_{l}}
\displaystyle\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\theta%
}\left(\frac{\partial\operatorname{vec}(F^{l}(\theta,X))}{\partial\theta}%
\right)^{T}=\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{vec%
}(W^{l})}\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(W^{l})}\right)^{T}+\frac{1}{H}\sum_{h}^{H}\frac{\partial\operatorname{vec%
}(F^{l})}{\partial\operatorname{vec}(c^{l,h})}\left(\frac{\partial%
\operatorname{vec}(F^{l})}{\partial\operatorname{vec}(c^{l,h})}\right)^{T}
\displaystyle+\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(G^{l-1})}\frac{\partial\operatorname{vec}(G^{l-1})}{\partial\operatorname%
{vec}(F^{l-1})}\frac{\partial\operatorname{vec}(F^{l-1}(\theta,X))}{\partial%
\theta}\left(\frac{\partial\operatorname{vec}(F^{l-1}(\theta,X))}{\partial%
\theta}\right)^{T}\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(G^{l-1})}\frac{\partial\operatorname{vec}(G^{l-1})}{%
\partial\operatorname{vec}(F^{l-1})}\right)^{T}
\{d_{l-1},H\}\to\infty
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(W^{l})}\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(W^{l})}\right)^{T}\overset{P}{\longrightarrow}\operatorname%
{\mathrm{batchm}}\left(\sigma_{w}^{2}\Lambda^{l-1},\psi(\Lambda^{l-1})\right)%
\otimes I_{d_{l}}
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(W^{l})}\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(W^{l})}\right)^{T}\overset{P}{\longrightarrow}\operatorname%
{\mathrm{batchm}}\left(\sigma_{w}^{2}\Lambda^{l-1},\psi(\Lambda^{l-1})\right)%
\otimes I_{d_{l}}
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(W^{l})}\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(W^{l})}\right)^{T}=\frac{\sigma_{w}^{2}}{d_{l-1}}\left[F^{l%
1},...,F^{lH}\right]\left[F^{l1},...,F^{lH}\right]^{T}\otimes I_{d_{l}}
\displaystyle\frac{\sigma_{w}^{2}}{Hd_{l-1}}\left(\left[F^{l1},...,F^{lH}%
\right]\left[F^{l1},...,F^{lH}\right]^{T}\right)=\sigma_{w}^{2}\sum_{h}^{H}%
\frac{1}{Hd_{l-1}}\sigma_{1}(L^{l,h})G^{l-1^{T}}G^{l-1}\sigma_{1}(L^{l,h})
i,j
\displaystyle\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(W^{l})}\left(\frac{\partial\operatorname{vec}(F^{l})}{%
\partial\operatorname{vec}(W^{l})}\right)^{T}\right)_{ij}=\frac{\sigma_{w}^{2}%
}{H}\sum_{h}^{H}\sum_{l,s}^{n}\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{l,h})_{tj}%
\frac{\left(G^{l-1^{T}}G^{l-1}\right)_{st}}{d_{l-1}}
\displaystyle\overset{P}{\longrightarrow}\sigma_{w}^{2}\sum_{st}^{n}\mathbb{E}%
\bigl{[}\sigma_{1}(L^{l,h})_{is}\sigma_{1}(L^{l,h})_{tj}\bigr{]}\Lambda^{l-1}_%
{st}=\sigma_{w}^{2}\sum_{st}^{n}\Lambda^{l-1}_{st}\psi(\Lambda^{l-1})_{IJ_{st}}
\{d_{l-1},H\}\rightarrow\infty
\displaystyle\sum_{h}^{H}\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(c^{l,h})}\left(\frac{\partial\operatorname{vec}(F^{l})}{%
\partial\operatorname{vec}(c^{l,h})}\right)^{T}\overset{P}{\longrightarrow}%
\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{l-1},\sigma_{c}^{2}%
\left(\gamma_{A}(\Lambda^{l-1})\odot\dot{\psi}(\Lambda^{l-1})\right)\right]%
\otimes I_{d_{l}}
\displaystyle\frac{1}{H}\sum_{h}^{H}\left(\frac{\partial\operatorname{vec}(F^{%
l})}{\partial\operatorname{vec}(\sigma_{1}(L^{l,h}))}\frac{\partial%
\operatorname{vec}(\sigma_{1}(L^{l,h})}{\partial\operatorname{vec}(L^{l,h})}%
\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(c^{l,h})%
}\right)\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(\sigma_{1}(L^{l,h}))}\frac{\partial\operatorname{vec}(\sigma_{1}(L^{l,h})%
}{\partial\operatorname{vec}(L^{l,h})}\frac{\partial\operatorname{vec}(L^{l,h}%
)}{\partial\operatorname{vec}(c^{l,h})}\right)^{T}=
\displaystyle\frac{1}{H}\sum_{h}^{H}\left(\left(I_{n}\otimes\frac{\sigma_{w}}{%
\sqrt{d_{l-1}}}W^{l,h}G^{l}\right)\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h}\frac{\partial\operatorname{vec}(L^{l,h})}{\partial%
\operatorname{vec}(c^{l,h})}\left(\frac{\partial\operatorname{vec}(L^{l,h})}{%
\partial\operatorname{vec}(c^{l,h})}\right)^{T}\overset{\scriptscriptstyle 1}{%
\Sigma}\vphantom{\sigma}^{l,h}\left(I_{n}\otimes\frac{\sigma_{w}}{\sqrt{d_{l-1%
}}}G^{l^{T}}W^{l,h^{T}}\right)\right)
I,J
\displaystyle\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(c^{l,h})}\left(\frac{\partial\operatorname{vec}(F^{l})}{%
\partial\operatorname{vec}(c^{l,h})}\right)^{T}\right)_{IJ}=\frac{\sigma_{w}^{%
2}}{Hd_{l-1}}\sum_{h}^{H}W^{l,h}G^{l}\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h}_{II}\biggl{[}\frac{\partial\operatorname{vec}(L^{l,h})%
}{\partial\operatorname{vec}(c^{l,h})}\left(\frac{\partial\operatorname{vec}(L%
^{l,h})}{\partial\operatorname{vec}(c^{l,h})}\right)^{T}\biggr{]}_{IJ}\overset%
{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{JJ}G^{l-1^{T}}W^{l,h^{T}}
u,v
I,J
\displaystyle\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(c^{l,h})}\left(\frac{\partial\operatorname{vec}(F^{l})}{%
\partial\operatorname{vec}(c^{l,h})}\right)^{T}\right)_{IJ_{uv}}=\sigma^{2}_{w%
}\frac{1}{Hd_{l-1}}\sum_{h}^{H}\sum_{st}^{n}\biggr{[}\frac{\partial%
\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(c^{l,h})}\left(\frac{%
\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(c^{l,h})}%
\right)^{T}\biggl{]}_{IJ_{st}}\langle W^{l,h}_{u},G^{l-1}_{\cdot s}\rangle%
\langle W^{l,h}_{v},G^{l-1}_{\cdot t}\rangle\overset{\scriptscriptstyle 1}{%
\Sigma}\vphantom{\sigma}^{l,h}_{II_{ss}}\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h}_{JJ_{tt}}
\displaystyle=\sigma^{2}_{w}\frac{1}{H}\sum_{h}^{H}\sum_{st}^{n}\biggr{[}\frac%
{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(c^{l,h})}%
\left(\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(c^%
{l,h})}\right)^{T}\biggl{]}_{IJ_{st}}\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h}_{II_{ss}}\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h}_{JJ_{tt}}\frac{1}{d_{l-1}}\sum_{ab}^{d_{l-1}}W^{l,h}_{%
ua}W^{l,h}_{vb}G^{l-1}_{as}G^{l-1}_{bt}
\displaystyle\biggr{[}\frac{\partial\operatorname{vec}(L^{l,h})}{\partial%
\operatorname{vec}(c^{l,h})}\left(\frac{\partial\operatorname{vec}(L^{l,h})}{%
\partial\operatorname{vec}(c^{l,h})}\right)^{T}\biggl{]}_{IJ_{st}}=\frac{%
\sigma_{c}^{2}}{2d_{l-1}}\langle\hat{A}\operatorname{concat}((\mathbf{1}_{n}%
\otimes G^{T}),(G^{T}\otimes\mathbf{1}_{n}))_{I_{s}},\hat{A}\operatorname{%
concat}((\mathbf{1}_{n}\otimes G^{T}),(G^{T}\otimes\mathbf{1}_{n}))_{J_{t}}\rangle
\displaystyle=\sigma_{c}^{2}\hat{A}_{II_{ss}}\hat{A}_{JJ_{tt}}\frac{\langle G_%
{\cdot I_{s}},G_{\cdot J_{t}}\rangle+\langle G_{\cdot I_{s}},G_{\cdot J_{t}}%
\rangle}{2d_{l-1}}
\displaystyle=\sigma^{2}_{w}\sigma_{c}^{2}\frac{1}{H}\sum_{h}^{H}\sum_{st}^{n}%
\hat{A}_{II_{ss}}\hat{A}_{JJ_{tt}}\frac{\langle G_{\cdot I_{s}},G_{\cdot J_{t}%
}\rangle+\langle G_{\cdot I_{s}},G_{\cdot J_{t}}\rangle}{2d_{l-1}}\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{II_{ss}}\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{JJ_{tt}}\frac{1}{d_{l-1}%
}\sum_{ab}^{d_{l-1}}W^{l,h}_{ua}W^{l,h}_{vb}G^{l-1}_{as}G^{l-1}_{bt}
\text{min}\{d_{l-1},H\}\rightarrow\infty
\displaystyle=\delta_{uv}\sigma^{2}_{w}\sum_{st}^{n}(J_{A}\begin{pmatrix}%
\Lambda^{l-1}&\Lambda^{l-1}\\
\Lambda^{l-1}&\Lambda^{l-1}\\
\end{pmatrix}J_{A}^{T})_{IJ_{st}}\dot{\psi}(\Lambda^{l-1})_{IJ_{st}}\dot{%
\Lambda}^{l-1}_{st}
\gamma_{A}(\Omega):=J_{A}\begin{pmatrix}\Omega&\Omega\\
\Omega&\Omega\\
\end{pmatrix}J_{A}^{T}
\displaystyle=\delta_{uv}\sigma^{2}_{w}\sum_{st}^{n}\gamma_{A}(\Lambda^{l-1})_%
{IJ_{st}}\dot{\psi}(\Lambda^{l-1})_{IJ_{st}}\Lambda^{l-1}_{st}
\text{min}\{d_{l-1},H\}\to\infty
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(G^{l-1})}\frac{\partial\operatorname{vec}(G^{l-1})}{\partial\operatorname%
{vec}(F^{l-1})}\left(\Theta^{l-1}\otimes I_{d_{l-1}}\right)\left(\frac{%
\partial\operatorname{vec}(F^{l})}{\partial\operatorname{vec}(G^{l-1})}\frac{%
\partial\operatorname{vec}(G^{l-1})}{\partial\operatorname{vec}(F^{l-1})}%
\right)^{T}
\displaystyle\overset{P}{\longrightarrow}
\displaystyle\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{l-1},%
\sigma^{2}_{c}\left(\gamma_{A}(\Theta^{l-1}\odot\dot{\Lambda}^{l-1})\odot\dot{%
\psi}(\Lambda^{l-1})\right)\right]+\operatorname{\mathrm{batchm}}\left[\sigma_%
{w}^{2}\left(\Theta^{l-1}\odot\dot{\Lambda}^{l-1}\right),\psi(\Lambda^{l-1})\right]
\displaystyle\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial%
\operatorname{vec}(G^{l-1})}\frac{\partial\operatorname{vec}(G^{l-1})}{%
\partial\operatorname{vec}(F^{l-1})}\right)\left(\Theta^{l-1}\otimes I_{d_{l-1%
}}\right)\left(\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(G^{l-1})}\frac{\partial\operatorname{vec}(G^{l-1})}{\partial\operatorname%
{vec}(F^{l-1})}\right)^{T}=
\displaystyle\frac{\partial\operatorname{vec}(F^{l})}{\partial\operatorname{%
vec}(G^{l-1})}\hat{\Theta}^{l}\frac{\partial\operatorname{vec}(F^{l})}{%
\partial\operatorname{vec}(G^{l-1})}^{T}
\hat{\Theta}^{l}_{IJ}:=\Theta^{l-1}_{ij}\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h}_{II}\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{%
\sigma}^{l,h^{\prime}}_{JJ}
d_{l-1}\rightarrow\infty
\hat{\Theta}^{l}\overset{P}{\rightarrow}(\Theta^{l-1}\odot\dot{\Lambda}^{l-1})%
\otimes I_{d_{l-1}}
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}\biggr{[}\left(I_{n}\otimes%
\left(\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}G^{l-1}\right)\right)\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}\frac{\partial%
\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})}+\left(\sigma%
_{1}(L^{l,h})\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}\right)\biggl{]}
\displaystyle\cdot\ \hat{\Theta}^{l}\biggr{[}\left(I_{n}\otimes\left(\frac{%
\sigma_{w}}{\sqrt{d_{l}}}W^{l,h^{\prime}}G^{l-1}\right)\right)\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h^{\prime}}\frac{\partial%
\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})}+\left(\sigma%
_{1}(L^{l,h^{\prime}})\otimes\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h^{\prime}}%
\right)\biggl{]}^{T}
\displaystyle=\frac{1}{H}\sum_{h,h^{\prime}}^{H}\left(A^{l,h,h^{\prime}}+B^{l,%
h,h^{\prime}}+C^{l,h,h^{\prime}}+C^{l,h,h^{\prime T}}\right)
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}A^{l,h,h^{\prime}}\overset{P}{%
\rightarrow}\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\Lambda^{l-1},%
\sigma^{2}_{c}\left(\gamma_{A}(\Theta^{l-1}\odot\dot{\Lambda}^{l-1})\odot\dot{%
\psi}(\Lambda^{l-1})\right)\right]\otimes I_{d_{l}}
\displaystyle A^{l,h,h^{\prime}}=\biggl{[}\left(I_{n}\otimes\left(\frac{\sigma%
_{w}}{\sqrt{d_{l}}}W^{l,h}G^{l-1}\right)\right)\overset{\scriptscriptstyle 1}{%
\Sigma}\vphantom{\sigma}^{l,h}\frac{\partial\operatorname{vec}(L^{l,h})}{%
\partial\operatorname{vec}(G^{h-1})}\biggr{]}\hat{\Theta}^{l}\biggl{[}\left(I_%
{n}\otimes\left(\frac{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h^{\prime}}G^{l-1}\right%
)\right)\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h^{\prime}}%
\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})%
}\biggr{]}^{T}
\displaystyle=\left(I_{n}\otimes\left(\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h}G^%
{l-1}\right)\right)\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,%
h}\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1%
})}\hat{\Theta}^{l}\left(\frac{\partial\operatorname{vec}(L^{l,h})}{\partial%
\operatorname{vec}(G^{h-1})}\right)^{T}\overset{\scriptscriptstyle 1}{\Sigma}%
\vphantom{\sigma}^{l,h^{\prime}}\left(I_{n}\otimes\left(\frac{\sigma_{w}}{%
\sqrt{d_{l-1}}}G^{l-1^{T}}W^{l,h^{\prime T}}\right)\right)
I,J
\displaystyle A^{l,h,h^{\prime}}_{IJ}=\frac{\sigma_{w}^{2}}{d_{l-1}}W^{l,h}G^{%
l-1}\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{II}\left[%
\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})%
}\hat{\Theta}^{l}\left(\frac{\partial\operatorname{vec}(L^{l,h})}{\partial%
\operatorname{vec}(G^{h-1})}\right)^{T}\right]_{IJ}\overset{\scriptscriptstyle
1%
}{\Sigma}\vphantom{\sigma}^{l,h^{\prime}}_{JJ}G^{l-1^{T}}W^{l,h^{\prime T}}
\displaystyle\left[\frac{\partial\operatorname{vec}(L^{l,h})}{\partial%
\operatorname{vec}(G^{h-1})}\hat{\Theta}^{l}\left(\frac{\partial\operatorname{%
vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})}\right)^{T}\right]_{IJ_{st}%
}=\frac{\sigma_{c}^{2}}{2d_{l-1}}\tilde{A}_{II_{ss}}\tilde{A}_{JJ_{tt}}\left(c%
_{1}^{T}\hat{\Theta}^{l}_{st}c_{1}+c_{1}^{T}\hat{\Theta}^{l}_{sJ}c_{2}+c_{2}^{%
T}\hat{\Theta}^{l}_{It}c_{1}+c_{2}^{T}\hat{\Theta}^{l}_{IJ}c_{2}\right)
\hat{\Theta}^{l}_{st}\in\mathbb{R}^{d_{l-1}\times d_{l-1}}
u,v
\displaystyle A^{l,h,h^{\prime}}_{IJ_{uv}}=\frac{\sigma^{2}_{w}}{d_{l-1}}\sum_%
{st}\left[\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec%
}(G^{h-1})}\hat{\Theta}^{l}\left(\frac{\partial\operatorname{vec}(L^{l,h})}{%
\partial\operatorname{vec}(G^{h-1})}\right)^{T}\right]_{IJ_{st}}\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{II_{ss}}\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h^{\prime}}_{JJ_{tt}}\langle
W%
_{u},G^{l-1}_{\cdot s}\rangle\langle W_{v},G^{l-1}_{\cdot t}\rangle
\displaystyle A^{l,h,h^{\prime}}_{IJ_{uv}}=\frac{\sigma^{2}_{w}\sigma^{2}_{c}}%
{2d_{l-1}^{2}}\sum_{st}\tilde{A}_{II_{ss}}\tilde{A}_{JJ_{tt}}\left(c_{1}^{T}%
\hat{\Theta}^{l}_{st}c_{1}+c_{1}^{T}\hat{\Theta}^{l}_{sJ}c_{2}+c_{2}^{T}\hat{%
\Theta}^{l}_{It}c_{1}+c_{2}^{T}\hat{\Theta}^{l}_{IJ}c_{2}\right)\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{II_{ss}}\overset{%
\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h^{\prime}}_{JJ_{tt}}\langle
W%
_{u},G^{l-1}_{\cdot s}\rangle\langle W_{v},G^{l-1}_{\cdot t}\rangle
\hat{\Theta}^{l}\overset{P}{\rightarrow}(\Theta^{l-1}\odot\dot{\Lambda}^{l-1})%
\otimes I_{d_{l-1}}
\text{min}\{d_{l-1},H\}\rightarrow\infty
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}A^{l,h,h^{\prime}}_{IJ_{uv}}%
\overset{P}{\longrightarrow}\delta_{uv}\delta_{hh^{\prime}}\sum_{st}\tilde{A}_%
{II_{ss}}\tilde{A}_{JJ_{tt}}\dot{\Lambda}^{l-1}_{IJ_{st}}\Theta^{l-1}_{st}%
\Theta^{l-1}_{ij}\Lambda^{l-1}_{st}
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}B^{l,h,h^{\prime}}\overset{P}{%
\rightarrow}\operatorname{\mathrm{batchm}}\left[\sigma_{w}^{2}\left(\Theta^{l-%
1}\odot\dot{\Lambda}^{l-1}\right),\psi(\Lambda^{l-1})\right]\otimes I_{d_{l-1}}
\displaystyle B^{l,h,h^{\prime}}=\left(\sigma_{1}(L^{l,h})\otimes\frac{\sigma_%
{w}}{\sqrt{d_{l}}}W^{l,h}\right)\hat{\Theta}^{l}\left(\sigma_{1}(L^{l,h^{%
\prime}})\otimes\frac{\sigma_{w}}{\sqrt{d_{l}}}W^{l,h^{\prime}}\right)^{T}
\displaystyle B^{l,h,h^{\prime}}_{IJ}=\sum_{ST}\left(\sigma_{1}(L^{l,h})%
\otimes I_{d_{l}}\right)_{IS}\left[\left(I_{n}\otimes\frac{\sigma_{w}}{\sqrt{d%
_{l}}}W^{l,h}\right)\hat{\Theta}^{l}\left(I_{d_{n}}\otimes\frac{\sigma_{w}}{%
\sqrt{d_{l}}}W^{l,h^{\prime T}}\right)\right]_{ST}\left(\sigma_{1}(L^{l,h^{%
\prime}})\otimes I_{d_{l}}\right)_{TJ}
\displaystyle B^{l,h,h^{\prime}}_{IJ}=\sum_{ST}\sigma_{1}(L^{l,h})_{is}\frac{%
\sigma_{w}^{2}}{d_{l}}W^{l,h^{\prime}}\hat{\Theta}^{l}_{ST}W^{l,h^{\prime T}}%
\sigma_{1}(L^{l,h^{\prime}})_{tj}
\displaystyle\frac{1}{H}\sum_{h}^{H}B^{l,h,h^{\prime}}_{IJ}\overset{P}{%
\rightarrow}\sum_{st}^{n}\mathbb{E}\bigl{[}\sigma_{1}(L^{l,h})_{is}\sigma_{1}(%
L^{l,h^{\prime}})_{tj}\bigr{]}\Theta^{l-1}_{st}\dot{\Lambda}^{l-1}_{st}=\sum_{%
st}^{n}\psi(\Lambda^{l-1})_{IJ_{st}}\Theta^{l-1}_{st}\dot{\Lambda}^{l-1}_{st}
\{d_{l-1},H\}\to\infty
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}C^{l,h,h^{\prime}}\overset{P}{%
\rightarrow}0
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}C^{l,h,h^{\prime}}=\frac{1}{H}%
\sum_{h,h^{\prime}}^{H}\left(I_{n}\otimes\left(\frac{\sigma_{w}}{\sqrt{2d_{l}}%
}W^{l,h}G^{l-1}\right)\right)\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{%
\sigma}^{l,h}\frac{\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{%
vec}(G^{h-1})}\hat{\Theta}^{l}\left(\sigma_{1}(L^{l,h^{\prime}})\otimes\frac{%
\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h^{\prime}}\right)^{T}
IJ
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}C^{l,h,h^{\prime}}_{IJ}=\frac{1%
}{H}\sum_{h,h^{\prime}}^{H}\frac{\sigma_{w}}{\sqrt{2d_{l}}}W^{l,h}G^{l-1}%
\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h}_{II}\left(\frac{%
\partial\operatorname{vec}(L^{l,h})}{\partial\operatorname{vec}(G^{h-1})}\hat{%
\Theta}^{l}\right)_{I}\left((\sigma_{1}(L^{l,h^{\prime}})_{j})^{T}\otimes\frac%
{\sigma_{w}}{\sqrt{d_{l-1}}}W^{l,h^{\prime T}}\right)
uv
\displaystyle\frac{1}{H}\sum_{h,h^{\prime}}^{H}C^{l,h,h^{\prime}}_{IJ_{uv}}=%
\frac{\sigma_{w}^{2}\sigma_{c}}{\sqrt{2}Hd_{l-1}^{\frac{3}{2}}}\sum_{h,h^{%
\prime}}^{H}\sum_{st}W_{u}^{l,h}G^{l-1}_{\cdot s}\overset{\scriptscriptstyle 1%
}{\Sigma}\vphantom{\sigma}^{l,h}_{II_{ss}}\tilde{A}_{II_{ss}}(c_{1}^{T}\hat{%
\Theta}^{l}_{s}+c_{2}^{T}\hat{\Theta}^{l}_{I})\left((\sigma_{1}(L^{l,h^{\prime%
}})_{j})^{T}\otimes\frac{\sigma_{w}}{\sqrt{d_{l-1}}}(W^{l,h^{\prime}}_{v})^{T}\right)
\displaystyle=\frac{\sigma_{w}^{2}\sigma_{c}}{\sqrt{2}Hd_{l-1}^{\frac{3}{2}}}%
\sum_{h,h^{\prime}}^{H}\sum_{stz}\sigma_{1}(L^{l,h^{\prime}})_{[j,\lfloor t%
\bmod n\rfloor+1]}W_{uz}^{l,h}G^{l-1}_{zs}\overset{\scriptscriptstyle 1}{%
\Sigma}\vphantom{\sigma}^{l,h}_{II_{ss}}\tilde{A}_{II_{ss}}(c_{1}^{T}\hat{%
\Theta}^{l}_{st}+c_{2}^{T}\hat{\Theta}^{l}_{It})W^{l,h^{\prime T}}_{v}
\nu(t):=\lfloor t\bmod n\rfloor+1
\displaystyle\frac{\sigma_{w}^{2}\sigma_{c}}{\sqrt{2}Hd_{l-1}^{\frac{3}{2}}}%
\sum_{h,h^{\prime}}^{H}\sum_{stzlm}\sigma_{1}(L^{l,h^{\prime}})_{j\nu(j)}W_{uz%
}^{l,h}G^{l-1}_{zs}\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,%
h}_{II_{ss}}\tilde{A}_{II_{ss}}\left(c_{1l}W^{l,h^{\prime}}_{vm}\hat{\Theta}^{%
l}_{st_{lm}}+c_{2l}W^{l,h^{\prime}}_{vm}\hat{\Theta}^{l}_{It_{lm}}\right)
\displaystyle\mathbb{P}\left(|S-\mathbb{E}S|\geq\delta\right)\leq\frac{\mathbb%
{E}\bigl{[}S^{2}\bigr{]}-\mathbb{E}\bigl{[}S\bigr{]}^{2}}{\delta^{2}}
\mathbb{E}\bigl{[}S^{2}\bigr{]}=\mathbb{E}\bigl{[}S^{2}\bigr{]}
\mathbb{E}\bigl{[}S\bigr{]}=0
\{H,d_{l-1}\}\to\infty
c_{1}
c_{2}
\Gamma_{h_{1}h_{2}h^{\prime}_{1}h^{\prime}_{2}s_{1}s_{2}}:=\sigma_{1}(L^{l,h^{%
\prime}_{1}})_{j\nu(t_{1})}\sigma_{1}(L^{l,h^{\prime}_{2}})_{j\nu(t_{2})}%
\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h_{1}}_{II_{s_{1}s_%
{1}}}\overset{\scriptscriptstyle 1}{\Sigma}\vphantom{\sigma}^{l,h_{2}}_{II_{s_%
{2}s_{2}}}(L^{l,h^{\prime}_{2}})_{j\nu(t_{2})}\tilde{A}_{II_{s_{1}s_{1}}}%
\tilde{A}_{II_{s_{2}s_{2}}}
\displaystyle\mathbb{E}\biggr{[}\bigl{(}\frac{1}{H}\sum_{h,h^{\prime}}^{H}C^{l%
,h,h^{\prime}}_{IJ_{uv}}\bigr{)}^{2}\biggl{]}=
\displaystyle\frac{\sigma_{w}^{4}\sigma_{c}^{2}}{2H^{2}d_{l-1}^{3}}\biggl{(}%
\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h_{1}h_{2}\\
h^{\prime}_{1}h^{\prime}_{2}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z_{1}z_{2}\\
l_{1}l_{2}\\
m_{1}m_{2}\end{subarray}}\Gamma_{h_{1}h_{2}h^{\prime}_{1}h^{\prime}_{2}s_{1}s_%
{2}}W_{uz_{1}}^{l,h_{1}}G^{l-1}_{z_{1}s_{1}}W_{uz_{2}}^{l,h_{2}}G^{l-1}_{z_{2}%
s_{2}}c_{1l_{1}}W^{l,h^{\prime}_{1}}_{vm_{1}}\hat{\Theta}^{l}_{s_{1}t_{1_{l_{1%
}m_{1}}}}c_{1l_{2}}W^{l,h^{\prime}_{2}}_{vm_{2}}\hat{\Theta}^{l}_{s_{2}t_{2_{l%
_{2}m_{2}}}}\biggr{]}
\displaystyle+\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h_{1}h_{2}\\
h^{\prime}_{1}h^{\prime}_{2}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z_{1}z_{2}\\
l_{1}l_{2}\\
m_{1}m_{2}\end{subarray}}\Gamma_{h_{1}h_{2}h^{\prime}_{1}h^{\prime}_{2}s_{1}s_%
{2}}W_{uz_{1}}^{l,h_{1}}G^{l-1}_{z_{1}s_{1}}W_{uz_{2}}^{l,h_{2}}G^{l-1}_{z_{2}%
s_{2}}c_{2l_{1}}W^{l,h^{\prime}_{1}}_{vm_{1}}\hat{\Theta}^{l}_{It_{1_{l_{1}m_{%
1}}}}c_{2l_{2}}W^{l,h^{\prime}_{2}}_{vm_{2}}\hat{\Theta}^{l}_{It_{2_{l_{2}m_{2%
}}}}\biggr{]}\biggl{)}
\Gamma
\{H,d_{l-1}\}\rightarrow\infty
d_{l-1}
H
\Gamma
\displaystyle\frac{\zeta\sigma_{w}^{4}\sigma_{c}^{2}}{2H^{2}d_{l-1}^{3}}%
\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h_{1}h_{2}\\
h^{\prime}_{1}h^{\prime}_{2}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z_{1}z_{2}\\
l_{1}l_{2}\\
m_{1}m_{2}\end{subarray}}W_{uz_{1}}^{l,h_{1}}G^{l-1}_{z_{1}s_{1}}W_{uz_{2}}^{l%
,h_{2}}G^{l-1}_{z_{2}s_{2}}c_{1l_{1}}W^{l,h^{\prime}_{1}}_{vm_{1}}\hat{\Theta}%
^{l}_{s_{1}t_{1_{l_{1}m_{1}}}}c_{1l_{2}}W^{l,h^{\prime}_{2}}_{vm_{2}}\hat{%
\Theta}^{l}_{s_{2}t_{2_{l_{2}m_{2}}}}\biggr{]}
\{d_{l-1},H\}\rightarrow\infty,\hat{\Theta}^{l}_{IJ_{lm}}\overset{P}{%
\longrightarrow}0
l\neq m
\displaystyle\frac{\zeta\sigma_{w}^{4}\sigma_{c}^{2}}{2H^{2}d_{l-1}^{3}}%
\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h_{1}h_{2}\\
h^{\prime}_{1}h^{\prime}_{2}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z_{1}z_{2}\\
l\\
m\end{subarray}}W_{uz_{1}}^{l,h_{1}}G^{l-1}_{z_{1}s_{1}}W_{uz_{2}}^{l,h_{2}}G^%
{l-1}_{z_{2}s_{2}}c_{1l}W^{l,h^{\prime}_{1}}_{vl}\hat{\Theta}^{l}_{s_{1}t_{1_{%
ll}}}c_{1m}W^{l,h^{\prime}_{2}}_{vm}\hat{\Theta}^{l}_{s_{2}t_{2_{mm}}}\biggr{]}
u\neq v
\displaystyle\frac{\zeta\sigma_{w}^{4}\sigma_{c}^{2}}{2H^{2}d_{l-1}^{3}}%
\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h\\
h^{\prime}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z\\
l\end{subarray}}W_{uz}^{l,h}G^{l-1}_{zs_{1}}W_{uz}^{l,h}G^{l-1}_{zs_{2}}c_{1l}%
c_{1l}W^{l,h^{\prime}}_{vl}W^{l,h^{\prime}}_{vl}\hat{\Theta}^{l}_{s_{1}t_{1_{%
ll}}}\hat{\Theta}^{l}_{s_{2}t_{2_{ll}}}\biggr{]}\overset{\text{min$\{d_{l-1},H%
\}\rightarrow\infty$}}{=}0
\{d_{l-1},H\}\rightarrow\infty
\{d_{l-1},H\}\rightarrow\infty
h,h^{\prime},z,l
{H^{2}d_{l-1}^{3}}
h,h^{\prime},z,l
u\neq v
u=v
\displaystyle\frac{\zeta\sigma_{w}^{4}\sigma_{c}^{2}}{2H^{2}d_{l-1}^{3}}%
\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h_{1}h_{2}\\
h^{\prime}_{1}h^{\prime}_{2}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z_{1}z_{2}\\
l\\
m\end{subarray}}W_{uz_{1}}^{l,h_{1}}G^{l-1}_{z_{1}s_{1}}W_{uz_{2}}^{l,h_{2}}G^%
{l-1}_{z_{2}s_{2}}c_{1l}W^{l,h^{\prime}_{1}}_{ul}\hat{\Theta}^{l}_{s_{1}t_{1_{%
ll}}}c_{1m}W^{l,h^{\prime}_{2}}_{um}\hat{\Theta}^{l}_{s_{2}t_{2_{mm}}}\biggr{]}
\displaystyle=\frac{\zeta\sigma_{w}^{4}\sigma_{c}^{2}}{2H^{2}d_{l-1}^{3}}%
\mathbb{E}\biggl{[}\sum_{\begin{subarray}{c}h_{1}h_{2}\\
h^{\prime}_{1}h^{\prime}_{2}\\
s_{1}s_{2}\\
t_{1}t_{2}\\
z_{1}z_{2}\\
l\\
m\end{subarray}}W^{l,h^{\prime}_{1}}_{ul}W^{l,h^{\prime}_{2}}_{um}W_{uz_{1}}^{%
l,h_{1}}W_{uz_{2}}^{l,h_{2}}c_{1l}c_{1m}G^{l-1}_{z_{1}s_{1}}G^{l-1}_{z_{2}s_{2%
}}\hat{\Theta}^{l}_{s_{1}t_{1_{ll}}}\hat{\Theta}^{l}_{s_{2}t_{2_{mm}}}\biggr{]}
h_{1},h_{2},h^{\prime}_{1},h^{\prime}_{2}
h^{\prime}_{1}=h^{\prime}_{2}
h_{1}=h_{2}
l=m
z_{1}=z_{2}
h^{\prime}_{1}=h_{1}
h^{\prime}_{2}=h_{2}
l=z_{1}
m=z_{2}
h^{\prime}_{1}=h_{2}
h^{\prime}_{2}=h_{1}
l=z_{2}
m=z_{1}
