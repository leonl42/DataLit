99.3\%
81.1\%
53.2\%
83.2\%
57\%
x
f
\vec{\alpha}=f(\vec{x})
\vec{\alpha}
\vec{\beta}=P\vec{\alpha}
x_{i}
\vec{x}_{i}
\vec{x}_{n(i)}
\vec{\alpha}_{i}
\vec{x}_{i}
P
\underset{P}{\text{min}}\,\sum_{i}\sum_{j\in n(i)}\|P{\vec{\alpha}_{i}}-P{\vec%
{\alpha}_{j}}\|_{F}^{2},\quad\text{s.t.}\quad P\ {\mathbb{E}}[\vec{\alpha}_{i}%
{\vec{\alpha}_{i}}^{T}]P^{T}=I
\vec{\alpha}=f(\cdot)
\underset{P}{\text{min}}\,\sum_{i}\|P{\vec{\alpha}}_{i}-\sum_{j\in n(i)}w(i,j)%
P{\vec{\alpha}}_{j}\|_{F}^{2},\quad\text{s.t.}\quad P\ {\mathbb{E}}[\vec{%
\alpha}_{i}{\vec{\alpha}_{i}}^{T}]P^{T}=I
\sum_{j\in n(i)}w(i,j)=1
w(\cdot,\cdot)
\{{\vec{\alpha}_{i}}\}
A
A
\underset{P}{\text{min}}\,\|PAD\|_{F}^{2},\quad\text{s.t.}\quad PVP^{T}=I
D
V=\frac{1}{N}AA^{T}
N
D
D
M
D=[{\bf d_{1}},{\bf d_{2}},\cdots{\bf d_{M}}]
k^{th}
x_{i},x_{j}
{\bf d_{k}}_{i}=1
{\bf d_{k}}_{j}=-1
D
D_{ji}=-w(i,j)
j\in n(i)
D_{ii}=1
D_{ji}=0
P=UV^{-\frac{1}{2}}
U
L
Q=V^{-\frac{1}{2}}ADD^{T}A^{T}V^{-\frac{1}{2}}
U
Q
P
P_{1,\cdot}
P_{2,\cdot}
P_{3,\cdot}
P_{4,\cdot}
Pf(\cdot)
P
P_{1,\cdot}
P_{2,\cdot}
P_{3,\cdot}
P_{4,\cdot}
Pf(\cdot)
\Phi\in\mathbb{R}^{2\times K}
K
\vec{x}
\vec{\alpha}=f(\vec{x})=\text{argmin}_{\vec{\alpha}}\|\vec{x}-\Phi\vec{\alpha}%
\|,\text{s.t.}\|\vec{\alpha}\|_{0}=1,\|\vec{\alpha}\|_{1}=1
\vec{\alpha}\in{\rm I\!R}^{K}
\vec{\phi}
\vec{x}
P
\vec{\alpha}
\vec{\beta}=Pf(\vec{x})
\vec{\beta}\in{\rm I\!R}^{d}
P\in{\rm I\!R}^{d\times K}
d
\alpha
i^{th}
P_{i,\cdot}
P
P
\vec{x}\in{\rm I\!R}^{2}
\epsilon_{1},\epsilon_{2}
\vec{x}_{1}=x_{1}+\epsilon_{1}
\vec{x}_{2}=x_{2}+\epsilon_{2}
f(\vec{x}_{1})
f(\vec{x}_{2})
P
\mathbb{E}_{x\sim p(x),\epsilon_{1},\epsilon_{2}\sim\mathcal{N}(0,I)}\|Pf(x_{1%
}+\epsilon_{1})-Pf(x_{2}+\epsilon_{2})\|^{2}
\{P_{1,\cdot},P_{2,\cdot},P_{3,\cdot},P_{4,\cdot}\}
P_{i,\cdot}
P_{1,\cdot}
P_{2,\cdot}
P_{1,\cdot}
P_{2,\cdot}
P_{2,\cdot}
P_{3,\cdot}
P_{3,\cdot}
P_{4,\cdot}
f
P
\vec{\beta}=Pf(\vec{x})
\vec{\alpha}
P
P
f_{vq}
f_{vq}
f_{vq}
S\times S
T\times T
\{\vec{x}_{ij}\}
i
j
\{\vec{x}_{ij}\}
n(ij)=\{\ lm;\ |i-l|\leq d\ \text{and}\ |j-m|\leq d\}
f
d=S-T+1
f
d
ADD^{T}A^{T}
V
P
\vec{x}_{ij}
\vec{\beta}_{ij}=Pf(\vec{x}_{ij})
B
\vec{z}=\text{L2\_normalize\_pw}\left(\text{avg\_pool}(B;\text{ks},\text{%
stride})\right)
\text{avg\_pool}(\cdot;\text{ks},\text{stride})
\vec{z}
d,\text{ks},\text{stride}
S\times S
(S-T+1)\times(S-T+1)
T\times T
\vec{\alpha}_{ij}=f(\vec{x}_{ij})
ij
\vec{x}_{ij}
\vec{x}_{ij}
\vec{\beta}_{ij}=Pf(\vec{x}_{ij})
\vec{\beta}_{ij}
\vec{z}
S\times S
(S-T+1)\times(S-T+1)
T\times T
\vec{\alpha}_{ij}=f(\vec{x}_{ij})
ij
\vec{x}_{ij}
\vec{x}_{ij}
\vec{\beta}_{ij}=Pf(\vec{x}_{ij})
\vec{\beta}_{ij}
\vec{z}
f_{vq}
f_{gq}
\vec{\alpha}=f_{vq}(\vec{x};D)
\vec{\alpha}_{i}=1
i=\text{argmax}_{i}\|\vec{x}-D_{\cdot,i}\|_{2}
D
f_{vq}
\vec{\alpha}=f_{gq}(\vec{x};D,t)
D
t
\vec{\alpha}=f_{gq}(\vec{x};D,t)
i
\vec{\alpha}
1
\vec{x}
i
\alpha_{i}=1
cos(\vec{x},D_{\cdot,i})\geq t
\alpha_{i}=0
f_{gq}
f_{gq}
T=6
\text{ks}=4
\text{stride}=2
f_{vq}
D\in{\rm I\!R}^{36\times K}
98.8\%
d=3
d=28-6+1
d=3
d=28-6+1
f_{vq}(\cdot;D)
f_{gq}(\cdot;D,t)
D
f_{vq}
D
f_{gq}
f_{vq}
f_{gq}
f_{gq}
t
0.3
0.45
16
P
f_{vq}
f_{gq}
f_{gq}
f_{vq}
f_{gq}
f_{gq}
D
f
f
x
f
\vec{x_{i}}
f
ADD^{T}A^{T}
V
P
f
\vec{x_{i}}
\vec{\beta_{i}}=Pf(\vec{x_{i}})=P{\bf e_{i}}=\vec{P_{i}}
T\times T\times c
T
c
T^{2}c
x_{i}
N_{i}=\{x_{j}:j\in n(i)\}
x_{i}
x_{i}
\mu_{i}=\frac{1}{||N_{i}||}\sum_{j\in N_{i}}x_{j}
\bar{x_{i}}
\bar{x_{i}}=x_{i}-\mu_{i}
\mu
\{\vec{x}_{i}\}
\vec{x}_{i}=(\lambda I+\Sigma)^{-\frac{1}{2}}\bar{x_{i}}
(\lambda I+\Sigma)^{\frac{1}{2}}
\vec{x_{i}}\in\mathbb{R}^{d}
\Phi\in\mathbb{R}^{d\times K}
d
K
\begin{split}\min_{\vec{\alpha_{i}},\Phi}\sum_{i}||\vec{x}_{i}-\Phi\vec{\alpha%
}_{i}||_{2},\\
s.t.\quad||\vec{\alpha}_{i}||_{0}=1,||\vec{\alpha}_{i}||_{1}=1,\vec{\alpha}_{i%
}\succeq 0.\end{split}
f_{vq}
\Phi
X=[\vec{x}_{1},\cdots,\vec{x}_{N}]
\eta
\Phi=[\vec{\phi}_{1},\cdots,\vec{\phi}_{K}]
A=[\vec{\alpha}_{1},\cdots,\vec{\alpha}_{N}]
\Phi\leftarrow 0,A\leftarrow 0
i\in 1,\cdots,n
\vec{x}_{i}=\frac{\vec{x}_{i}}{||\vec{x}_{i}||_{2}}
\phi
i\in 1,\cdots,n
\vec{\alpha_{i}}\leftarrow\vec{e}_{j^{*}}\quad j^{*}=\operatorname*{arg\,max}_%
{j}||\vec{\phi}_{j}-\vec{x}_{i}||_{2}
\Phi\leftarrow\Phi+\frac{\eta}{\vec{h}}\odot\sum_{i}(\vec{x}_{i}-\Phi^{T}\vec{%
\alpha}_{i}),\quad s.t.\quad\vec{h}_{j}=(\sum_{i}\vec{\alpha}_{i})_{j}
j\in 1,\cdots,K
\vec{\phi}_{j}=\frac{\vec{\phi}_{j}}{||\vec{\phi}_{j}||_{2}}
f_{gq}
0.3
f_{gq}
0.3
f_{gq}
f_{gq}
\{\vec{x}_{ij}\}
n(ij)=\{\ lm;\ |i-l|\leq d\ \text{and}\ |j-m|\leq d\}
d
f_{gq}
0.3
f_{gq}
0.3
d
f_{gq}
0.3
f_{gq}
0.3
f_{gq}
0.3
f_{gq}
0.3
x
k
y,y_{j}
x,x_{j}
\hat{z(x)}=\frac{1}{|n(x)|}\sum_{x_{j}\in n(x)}OneHot(y_{j})
x
q(x)=softmax(z(x))
q(x)_{k}=\frac{exp(\frac{z(x)_{k}}{T})}{\sum_{l}exp(\frac{z(x)_{l}}{T})}
x
k
T
\mathbb{P}(y=k|x)
\hat{y(x)}=\arg\max_{k}q(x)_{k}
x
x
x
\hat{z(x)}=\frac{1}{|n(x)|}\sum_{x_{j}\in n(x)}OneHot(y_{j})
\hat{z(x)}=\frac{1}{|n(x)|}\sum_{x_{j}\in n(x)}OneHot(y_{j})cos(x_{j},x)
K=30
T=0.03
\underset{P}{\text{min}}\,\|PAD\|_{F}^{2},\quad\text{s.t.}\quad PVP^{T}=I
A
f:\mathcal{X}\to\mathcal{A}
g:\mathcal{A}\to\mathcal{Z}
Z=g(f(X))
\underset{f,g}{\text{min}}\,\|ZD\|_{F}^{2},\quad\text{s.t.}\quad ZZ^{T}=I
L_{vic}=\alpha\sum_{k=1}^{d}max(0,1-\sqrt{(}Cov(Z)_{kk}))+\beta\sum_{i=1,j\neq
k%
}Cov(Z)_{kj}^{2}+\frac{\gamma}{N}\sum_{i}\sum_{j\in n(i)}|z_{i}-z_{j}|_{2}^{2}
Z=g(f(X))
f
g
\alpha=\beta=\gamma=1
\begin{split}L_{vic}&=\sum_{k=1}^{d}(1-\sqrt{(}Cov(Z)_{kk})^{2}+\sum_{i=1,j%
\neq k}Cov(Z)_{kj}^{2}+\frac{1}{N}\sum_{i}\sum_{j\in n(i)}|z_{i}-z_{j}|_{2}^{2%
}\\
&=||ZZ^{T}-I||^{2}_{F}+\frac{1}{N}\sum_{i}\sum_{j\in n(i)}||z_{i}-z_{j}||_{2}^%
{2}\\
\end{split}
\min_{f,g}L_{vic}=\min_{f,g}\sum_{i}\sum_{j\in n(i)}||z_{i}-z_{j}||_{2}^{2},%
\quad\text{s.t.}\quad ZZ^{T}=I
D
\underset{f,g}{\text{min}}\,\|ZD\|_{F}^{2},\quad\text{s.t.}\quad ZZ^{T}=I
f
g
g
\vec{x}
\vec{\beta}
g:\mathbb{R}^{m}\to\mathbb{R}^{d}
g=Pf(\cdot)
f
D_{\hat{u}}g(\alpha)=\lim_{h\to 0}\frac{g(\alpha+h\hat{u})-g(\alpha)}{h}
\hat{u}
h
x_{i}
x_{j}
f(x_{j})-f(x_{i})
h=1
x_{i}
x_{j}
\hat{u}=f(x_{j})-f(x_{i})
\begin{split}D_{\hat{u}}g(x_{i})&=D_{\hat{u}}g(f(x_{i}))\\
&=\lim_{h\to 0}\frac{g(f(x_{i})+h\hat{u})-g(f(x_{i}))}{h}\\
&=g(f(x_{i})+(f(x_{j})-f(x_{i})))-g(f(x_{i}))\\
&=g(f(x_{j}))-g(f(x_{i}))\end{split}
