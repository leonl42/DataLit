{\bm{x}}\in\mathbb{R}^{d}
f:\mathcal{M}\rightarrow\mathcal{Y}
f
\mathcal{M}
\mathcal{Y}
{\bm{x}}_{i}\in\mathbb{R}^{h\times w}\times\mathbb{R}^{3}
f:\mathbb{R}^{2}\rightarrow\mathbb{R}^{3}
f:\mathbb{R}^{3}\rightarrow\mathbb{R}
f:\mathbb{S}^{2}\rightarrow\mathbb{R}^{d}
{\color[rgb]{1,0,0}\mathcal{M}}
f_{1:T}
{\color[rgb]{1,0,0}\mathcal{M}}
f_{1:T}
p_{\theta}({\bm{x}}_{0})
q({\bm{x}}_{0})
{\bm{x}}_{1:T}
{\bm{x}}_{0}\sim q({\bm{x}}_{0})
T
q({\bm{x}}_{t}|{\bm{x}}_{t-1}):=\mathcal{N}\left({\bm{x}}_{t-1};\sqrt{\bar{%
\alpha}_{t}}{\bm{x}}_{0},(1-\bar{\alpha}_{t}){\mathbf{I}}\right).
\bar{\alpha}_{t}
t
\epsilon_{\theta}
{\bm{x}}_{t}=\sqrt{\bar{\alpha}_{t}}{\bm{x}}_{0}+\sqrt{1-\bar{\alpha}_{t}}\epsilon
\mathcal{L}_{\theta}=\mathbb{E}_{t\sim[0,T],{\bm{x}}_{0}\sim q({\bm{x}}_{0}),%
\epsilon\sim\mathcal{N}(0,\mathbf{I})}\left[\|\epsilon-\epsilon_{\theta}(\sqrt%
{\bar{\alpha}_{t}}{\bm{x}}_{0}+\sqrt{1-\bar{\alpha}_{t}}\epsilon,t)\|^{2}%
\right],
p_{\theta}({\bm{x}}_{0})
{\bm{x}}_{0}\sim p_{\theta}({\bm{x}}_{0})
{\bm{x}}_{T}\sim\mathcal{N}({\bm{0}},\mathbf{I})
\epsilon_{\theta}
{\bm{x}}_{T}
{\bm{x}}_{0}
{\bm{x}}_{t-1}\sim p_{\theta}({\bm{x}}_{t-1}|{\bm{x}}_{t})
{\bm{x}}_{t-1}=\frac{1}{\sqrt{\alpha_{t}}}\left({\bm{x}}_{t}-\frac{1-\alpha_{t%
}}{\sqrt{1-\alpha_{t}}}\epsilon_{\theta}({\bm{x}}_{t},t)\right)+\mathbf{z},
{\bm{z}}\sim\mathcal{N}({\bm{0}},\mathbf{I})
\epsilon_{\theta}
p_{\theta}({\bm{x}}_{t-1}|{\bm{x}}_{t})
q(f_{0})
f_{0}:\mathcal{M}\rightarrow\mathcal{Y}
\mathcal{M}
\mathcal{Y}
f_{0}:\mathbb{R}^{2}\rightarrow\mathbb{R}^{3}
f_{1:T}
\{({\bm{m}}_{c},{\bm{y}}_{(c,0)})\}
{\bm{m}}_{c}\in\mathcal{M},{\bm{y}}_{(c,0)}\in\mathcal{Y}
{\mathbf{C}}_{0}\leavevmode\nobreak\ =\leavevmode\nobreak\ [{\mathbf{M}}_{c},%
\leavevmode\nobreak\ {\mathbf{Y}}_{(c,0)}]
{\mathbf{M}}_{c}
{\mathbf{Y}}_{(c,0)}
t=0
\hat{f}:\Psi({\bm{z}}_{0})\times\mathcal{M}\rightarrow\mathcal{Y}
{\bm{z}}_{0}
\Psi
{\bm{z}}_{0}
q({\bm{z}}_{0})
p_{\theta}({\bm{z}}_{0})
{\bm{z}}_{0}
{\bm{z}}_{0}
{\mathbf{C}}_{t}=[{\mathbf{M}}_{c},{\mathbf{Y}}_{(c,t)}=\sqrt{\bar{\alpha}_{t}%
}{\mathbf{Y}}_{(c,0)}+\sqrt{1-\bar{\alpha}_{t}}\mathbf{\epsilon}_{c}],
\mathbf{\epsilon}_{c}\sim\mathcal{N}({\bm{0}},\mathbf{I})
\mathcal{M}
\{{\bm{m}}_{q},{\bm{y}}_{(q,0)}\}
{\mathbf{Q}}_{0}\leavevmode\nobreak\ =\leavevmode\nobreak\ [{\mathbf{M}}_{q},%
\leavevmode\nobreak\ {\mathbf{Y}}_{(q,0)}]
{\mathbf{Q}}_{t}=[{\mathbf{M}}_{q},{\mathbf{Y}}_{(q,t)}=\sqrt{\bar{\alpha}_{t}%
}{\mathbf{Y}}_{(q,0)}+\sqrt{1-\bar{\alpha}_{t}}\mathbf{\epsilon}_{q}],
\mathbf{\epsilon}_{q}\sim\mathcal{N}({\bm{0}},\mathbf{I})
\hat{\mathbf{\epsilon}_{q}}=\epsilon_{\theta}({\mathbf{C}}_{t},t,{\mathbf{Q}}_%
{t})
f_{0}\sim\mathrm{Uniform}(q(f_{0}))
\epsilon_{\theta}
f_{0}\sim p_{\theta}(f_{0})
{\mathbf{Q}}_{T}\leavevmode\nobreak\ =\leavevmode\nobreak\ [{\mathbf{M}}_{q},%
\leavevmode\nobreak\ {\mathbf{Y}}_{(q,T)}\sim\leavevmode\nobreak\ \mathcal{N}(%
{\bm{0}},\leavevmode\nobreak\ {\mathbf{I}})]
32\times 32=1024
1024
{\mathbf{Q}}_{T}
t=T
{\mathbf{Q}}_{0}
f_{0}
{\mathbf{M}}_{q}
({\mathbf{C}}_{0},{\mathbf{Q}}_{0})\sim\mathrm{Uniform}(q(f_{0}))
t\sim\mathrm{Uniform}(\{1,\dotsc,T\})
\mathbf{\epsilon}_{c}\sim\mathcal{N}({\bm{0}},\mathbf{I})
\mathbf{\epsilon}_{q}\sim\mathcal{N}({\bm{0}},\mathbf{I})
{\mathbf{C}}_{t}=[{\mathbf{M}}_{c},\sqrt{\bar{\alpha}_{t}}{\mathbf{Y}}_{(c,0)}%
+\sqrt{1-\bar{\alpha}_{t}}\mathbf{\epsilon}_{c}]
{\mathbf{Q}}_{t}=[{\mathbf{M}}_{q},\sqrt{\bar{\alpha}_{t}}{\mathbf{Y}}_{(q,0)}%
+\sqrt{1-\bar{\alpha}_{t}}\mathbf{\epsilon}_{q}]
\nabla_{\theta}\left\|\mathbf{\epsilon}_{q}-\epsilon_{\theta}({\mathbf{C}}_{t}%
,t,{\mathbf{Q}}_{t})\right\|^{2}
{\mathbf{Q}}_{T}=[{\mathbf{M}}_{q},{\mathbf{Y}}_{(q,t)}\sim\mathcal{N}({\bm{0}%
}_{q},{\mathbf{I}}_{q})]
{\mathbf{C}}_{T}\subseteq{\mathbf{Q}}_{T}
t=T,\dotsc,1
{\bm{z}}\sim\mathcal{N}({\bm{0}},{\mathbf{I}})
t>1
{\bm{z}}={\bm{0}}
{\mathbf{Y}}_{(q,t-1)}\leavevmode\nobreak\ =\frac{1}{\sqrt{\alpha_{t}}}\left({%
\mathbf{Y}}_{(q,t)}-\frac{1-\alpha_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{%
\theta}({\mathbf{C}}_{t},t,{\mathbf{Q}}_{t})\right)+\sigma_{t}{\bm{z}}
{\mathbf{Q}}_{t-1}=[{\mathbf{M}}_{q},{\mathbf{Y}}_{(q,t-1)}]
{\mathbf{C}}_{t-1}\subseteq{\mathbf{Q}}_{t-1}
f_{0}
{\mathbf{M}}_{q}
\mathcal{M}
\mathcal{Y}
\epsilon_{\theta}
64^{2}
32^{2}
{\bm{x}}\in\mathbb{R}^{h\times w\times 3}
f:\mathbb{R}^{2}\rightarrow\mathbb{R}^{3}
64^{2}
\downarrow
\uparrow
\uparrow
32^{2}
\downarrow
\uparrow
49.46
5.29
31.75
3.26
9.74
64^{2}
64^{2}
64^{2}
64^{2}
64^{2}
\sim 35
64^{3}
f:\mathbb{R}^{3}\rightarrow\mathbb{R}^{1}
2048
32^{3}
32^{3}
32^{3}
64^{3}
64^{3}
\uparrow
\downarrow
\mathbb{S}^{2}
f_{0}:\mathbb{S}^{2}\rightarrow\mathbb{R}^{d}
\mathbb{S}^{2}
32^{2}
64^{2}
\mathcal{M}
{\bm{x}}\in\mathbb{S}^{2}
\mathbb{S}^{2}
64^{2}
1000
64^{2}
128^{2}
180
1k
128^{2}
64^{2}
128^{2}
64^{2}
64^{2}
\downarrow
\uparrow
\uparrow
64^{2}
=1028
50\%
=2048
75\%
=4096
100\%
1k
1k
64^{2}
\mathrm{latents}=256
\mathrm{dim\leavevmode\nobreak\ latents}=256
\mathrm{decoder\leavevmode\nobreak\ blocks}=2
\mathrm{blocks}=6
\mathrm{S.A.\leavevmode\nobreak\ block}=1
1k
1k
t
t
2
512\times 512
64^{2}
1024\times 1024
32^{2}
10
64
1e-4
\mathbf{C}_{t}
\mathbf{Q}_{t}
\hat{\epsilon_{q}}
\mathbf{C}_{t}
\mathbf{Q}_{t}
\hat{\epsilon_{q}}
t=1000
t=0
t=1000
t=0
64^{2}
32^{2}
32^{3}
64^{2}
32^{2}
64^{3}
4096
2048
32768
4096
2048
32768
2
2
3
3
3
1
10
10
10
t
64
64
64
1024
512
512
1024
512
1024
12
12
12
1
1
1
2
2
2
4
4
4
4
4
4
128
128
16
1e-4
1e-4
1e-4
1300
1300
1000
32\times 32
\epsilon_{\theta}
\epsilon_{\theta}
\epsilon_{\theta}
32\times 32
55
50\%
32^{2}
\downarrow
\downarrow
\times 10^{3}
\epsilon_{\theta}
\epsilon_{\theta}
\epsilon_{\theta}
\epsilon_{\theta}
\mathbb{S}^{2}
\mathbb{S}^{2}
46\times 90
181\times 360
181\times 360
46\times 90
46\times 90
\mathbb{S}^{2}
\mathbb{S}^{2}
32\times 32
32\times 32=1024
32\times 32
32\times 32
