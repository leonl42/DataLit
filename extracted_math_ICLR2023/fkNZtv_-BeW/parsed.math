N
M
\mathbb{D}
D_{i}
\mathbb{D}
\mathbb{D}
\mathcal{X}\in\mathbb{R^{\textnormal{l}\times\textnormal{w}\times\textnormal{c%
}}}
\mathcal{Y}={1,2,...,k}
\{D_{i}\}^{N},\mathbb{D}\setminus\{D_{i}\}\sim\mathcal{X}\times\mathcal{Y}
\mathcal{X}
\mathcal{Y}
x
x
x=\mathbf{x}+\varepsilon
\mathbf{x}
x
\varepsilon:\{\varepsilon\geq 0\}^{N+1}
\mathbf{x}
\mathbf{x}\sim\mathbb{D}\setminus D_{i}
y\approx f(\mathbf{x};\theta)
\{a_{i}\}^{i\in N}
X^{\textnormal{poison}}
\{X^{\textnormal{poison}}\in D_{i}\}^{i\in N}\in\mathbb{D}
b_{i}
\{X_{i}:Y_{i}^{\textnormal{poison}}\}\in D_{i}
\varepsilon_{i}
p_{i}=\frac{|X^{\textnormal{poison}}|}{|X^{\textnormal{clean}}|+|X^{%
\textnormal{poison}}|}
X^{\textnormal{poison}}=b_{i}(X_{i},Y_{i}^{\textnormal{poison}},\varepsilon_{i%
},p_{i})
a_{i}
X^{\textnormal{poison}}
Y_{i}^{\textnormal{clean}}
Y_{i}^{\textnormal{poison}}
f
p_{i}
(\varepsilon_{i},p_{i},Y_{i}^{\textnormal{poison}},b_{i})
\widetilde{Y}=f(X_{i};(\theta,\mathbb{D});(r_{j},s_{j});(\varepsilon_{i},p_{i}%
,Y_{i}^{\textnormal{poison}},b_{i}))
\pi=\max\texttt{Acc}(\widetilde{Y},Y^{\textnormal{poison}})
\neg i
\{d_{j}\}^{j\in M}
f
\mathbb{D}
\theta
M=1
\mathbb{D}
\{(r_{j},s_{j})\}^{j\in M}
r_{j}
s_{j}
\displaystyle\begin{split}\pi^{a_{i}}=\texttt{Acc}\Big{(}f(X_{i};(\theta,%
\mathbb{D});(r_{j},s_{j});\\
\{(\varepsilon_{i},p_{i},Y_{i}^{\textnormal{poison}},b_{i}),\\
(\varepsilon_{\neg i},p_{\neg i},Y_{\neg i}^{\textnormal{poison}},b_{\neg i})%
\}),\\
Y_{i}^{\textnormal{poison}}\Big{)}\end{split}
\displaystyle\begin{split}\pi^{a_{i}}=\texttt{Acc}\Big{(}f(X_{i};(\theta,%
\mathbb{D});(r_{j},s_{j});\\
\{(\varepsilon_{i},p_{i},Y_{i}^{\textnormal{poison}},b_{i}),\\
(\varepsilon_{\neg i},p_{\neg i},Y_{\neg i}^{\textnormal{poison}},b_{\neg i})%
\}),\\
Y_{i}^{\textnormal{poison}}\Big{)}\end{split}
\displaystyle\begin{split}\pi^{d}=1-\frac{1}{N}\sum_{i}^{N}\texttt{Acc}(f(%
\cdot),Y_{i}^{\textnormal{poison}})\end{split}
\displaystyle\begin{split}\pi^{d}=1-\frac{1}{N}\sum_{i}^{N}\texttt{Acc}(f(%
\cdot),Y_{i}^{\textnormal{poison}})\end{split}
\pi^{a}=\texttt{mean}\pm\texttt{std}
\pi^{d}=((1-\texttt{mean})\pm\texttt{std})
\theta_{t-1}
\mathbb{D}\setminus\{D_{i}\}
t-1
t
\phi\sim\Phi
\mathbb{D}
\phi_{i}=\theta_{t}-\theta_{t-1}
\phi:\varepsilon_{i}\mapsto y_{i}
\phi
\theta_{t}=\theta_{t-1}+\sum_{i}^{|\{\phi\}|}\phi_{i}
x,y\sim\mathbb{D}\setminus(D_{0}\cup\{D_{i}\}^{N})
(\mathbf{x}+\varepsilon_{\textnormal{noise}}+\{\varepsilon_{i}\}^{N}),(y%
\rightarrow y_{i})\sim D_{i}
\texttt{Rand}:s\sim\mathcal{U}(S)
\mathbb{P}(s)=\frac{1}{|S|}
s
S
N\rightarrow\infty
y^{*}=f(\mathbf{x}+\varepsilon;\theta)\sim\mathcal{U}(\mathcal{Y})
\mathbf{P}(y^{*})=\frac{1}{|\mathcal{Y}|}
\small\begin{split}&\sum_{x,y}^{\mathbb{D}\setminus D_{i}}\mathcal{L}(\theta+%
\sum\phi_{n}^{\textnormal{backdoor}};x^{\textnormal{clean}},y^{\textnormal{%
clean}})\\
+&\sum_{i}^{N}\sum_{x,y}^{D_{i}}\mathcal{L}(\theta+\sum\phi_{n}^{\textnormal{%
backdoor}};x^{\textnormal{poison}},y^{\textnormal{poison}})\\
<&\sum_{x,y}^{\mathbb{D}\setminus D_{i}}\mathcal{L}(\theta;x^{\textnormal{%
clean}},y^{\textnormal{clean}})+\sum_{i}^{N}\sum_{x,y}^{D_{i}}\mathcal{L}(%
\theta;x^{\textnormal{poison}},y^{\textnormal{poison}})\end{split}
\theta
\phi
\phi
\textnormal{LHS}<\textnormal{RHS}
\varepsilon
\phi
\varepsilon\mapsto\phi
\{\varepsilon:\phi\}^{*}\ll N
\small\begin{split}\{\varepsilon:\phi\}^{*}&:=\operatorname*{arg\,min}_{\{%
\varepsilon:\phi\}}-(1+|\{\varepsilon\}|)\\
&\equiv\operatorname*{arg\,min}_{\{\varepsilon:\phi\}}\bigg{[}\mathbf{sign}(%
\frac{\partial\mathcal{L}(\mathbf{x},y;\theta+\phi)}{\partial\theta})\\
&+\sum_{\varepsilon,\phi}^{\{\varepsilon\mapsto\phi\}}\mathbf{sign}(\frac{%
\partial\mathcal{L}(\varepsilon,y;\theta+\phi)}{\partial\theta})\bigg{]}\end{split}
N
p
\varepsilon
N
p
\varepsilon
\rho
a_{i}
\rho=\frac{|X_{i}^{\textnormal{poison}}|}{|\mathbb{D}|}
N
V_{d}
\rho=(1-V_{d})\times\frac{1}{N}\times p
N=1
99.7
92.1
84.5
95.4
100.0
98.1
89.8
100.0
10.4
9.9
13.0
10.9
N=100
99.7
91.9
84.6
71.9
27.5\pm 22.2
12.3\pm 19.1
12.1\pm 14.0
12.6\pm 15.4
10.5\pm 6.0
10.4\pm 3.2
15.5\pm 4.6
10.0\pm 10.2
N
N
[16,32,32]
\varepsilon_{a}
\alpha\mapsto\varepsilon_{\textnormal{style}}
\alpha=1.0
N=5
V_{d}=0.1
p,\varepsilon=0.55
N=100
N
N
N
N=100
p
p
N=100
p
p
\frac{1}{|\mathcal{Y}|}
N>1
N=1
N>1
N
\varepsilon
p
\varepsilon_{\textnormal{b}},p=0.0
>0.0
N=1
\pm
N=1
N=100
(\varepsilon_{\textnormal{style}}\in\varepsilon)\mapsto y_{i}
N
p
\varepsilon
0.0
0.849
0.849
0.873
0.785
0.0
0.904
0.883
0.895
0.819
0
2
4
6
8
0.15
0.15
0.15
0.15
0.15
0.005
0.005
0.005
0.005
0.005
3.9
14.4
9.7
36.3
8.7
23.9
29.7
27.6
28.4
24.9
2
4
4
6
8
0.15
0.15
0.15
0.15
0.15
0.005
0.005
0.005
0.005
0.005
6.9
18.9
21.2
30.4
9.9
25.1
28.8
28.1
27.2
24.9
4
4
4
4
4
0.15
0.15
0.15
0.15
0.15
0.005
0.005
0.005
0.005
0.005
38.3
33.4
38.8
29.9
50.4
24.8
27.1
26.5
26.4
21.9
N
p
\varepsilon
0.0
0.458
0.454
0.456
0.445
0.0
0.598
0.572
0.580
0.582
0
2
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
3.4
14.6
3.4
9.9
1.8
15.2
11.9
13.3
14.1
12.4
2
4
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
62.2
16.4
8.3
10.8
4.8
12.9
16.2
10.9
13.2
13.3
4
4
4
4
4
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
89.3
97.6
89.3
96.1
96.1
11.1
11.2
10.8
9.7
10.2
N
p
\varepsilon
0.0
0.053
0.046
0.044
0.049
0.0
0.286
0.283
0.282
0.283
0
2
4
6
8
0.95
0.95
0.95
0.95
0.95
0.005
0.005
0.005
0.005
0.005
75.9
18.6
0.2
61.7
0.0
7.8
10.3
11.6
8.9
11.3
2
4
4
6
8
0.95
0.95
0.95
0.95
0.95
0.005
0.005
0.005
0.005
0.005
2.7
9.6
81.2
3.7
0.0
12.7
10.4
9.6
9.3
10.2
4
4
4
4
4
0.95
0.95
0.95
0.95
0.95
0.005
0.005
0.005
0.005
0.005
100.0
91.8
100.0
100.0
100.0
10.4
12.2
9.4
9.4
10.1
N
0.453
0.583
20\{0,2,4,6,8\}
0.55
0.005
20.4\pm 15.8
12.3\pm 3.92
{\color[rgb]{1,0,0}40\{4\}},20\{2,6,8\}
0.55
0.005
30.8\pm 24.8
11.1\pm 3.29
{\color[rgb]{1,0,0}100\{4\}}
0.55
0.005
99.8\pm 1.56
9.67\pm 10.0
\varepsilon
0.0
0.458
0.454
0.456
0.445
0.0
0.598
0.572
0.580
0.582
0
2
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
9.8
9.6
4.4
47.5
5.6
13.6
13.3
14.2
14.6
15.1
2
4
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
7.2
23.0
14.7
38.4
7.0
11.1
14.4
15.79
14.2
14.2
4
4
4
4
4
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
26.7
31.7
12.9
51.7
13.9
12.6
12.9
12.2
14.1
13.2
N
p
\varepsilon
0.0
1.0
1.0
1.0
0.996
0.0
0.955
1.0
0.988
0.974
0
2
4
6
8
0.15
0.15
0.15
0.15
0.15
0.005
0.005
0.005
0.005
0.005
9.6
12.6
11.0
6.8
11.1
58.2
56.4
54.6
57.8
57.2
2
4
4
6
8
0.15
0.15
0.15
0.15
0.15
0.005
0.005
0.005
0.005
0.005
10.1
11.9
10.8
9.9
9.8
58.5
58.1
56.6
57.8
57.2
4
4
4
4
4
0.15
0.15
0.15
0.15
0.15
0.005
0.005
0.005
0.005
0.005
12.1
11.7
10.7
10.1
11.7
59.0
56.7
56.0
57.1
56.8
N
p
\varepsilon
0.0
0.897
1.0
1.0
0.959
0.0
1.0
1.0
0.994
0.975
0
2
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
10.2
11.5
11.6
8.8
10.3
60.0
58.3
57.6
58.5
56.3
2
4
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
9.7
13.3
11.2
10.4
11.9
58.1
57.3
56.3
58.2
57.5
4
4
4
4
4
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
15.2
14.8
15.0
14.2
14.8
58.61
56.7
54.7
56.4
57.4
N
p
\varepsilon
0.0
0.777
1.0
1.0
0.918
0.0
1.0
1.0
0.971
0.963
0
2
4
6
8
0.95
0.95
0.95
0.95
0.95
0.005
0.005
0.005
0.005
0.005
9.0
10.3
11.3
8.4
11.2
57.7
57.4
56.4
58.4
57.1
2
4
4
6
8
0.95
0.95
0.95
0.95
0.95
0.005
0.005
0.005
0.005
0.005
7.7
9.7
9.6
8.7
13.8
57.8
58.5
56.7
58.1
56.5
4
4
4
4
4
0.95
0.95
0.95
0.95
0.95
0.005
0.005
0.005
0.005
0.005
13.3
13.4
12.1
11.3
11.9
57.9
58.2
56.1
58.9
57.8
N
1.0
1.0
20\{0,2,4,6,8\}
0.55
0.005
10.0\pm 3.58
58.2\pm 4.65
{\color[rgb]{1,0,0}40\{4\}},20\{2,6,8\}
0.55
0.005
9.96\pm 2.96
58.9\pm 4.82
{\color[rgb]{1,0,0}100\{4\}}
0.55
0.005
23.8\pm 13.2
59.2\pm 5.79
\varepsilon
0.0
0.897
1.0
1.0
0.959
0.0
1.0
1.0
0.994
0.975
0
2
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
8.4
9.2
9.6
7.4
11.8
50.8
48.3
49.4
49.1
49.1
2
4
4
6
8
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
9.2
6.2
7.1
7.4
11.6
52.7
49.9
49.9
49.6
49.0
4
4
4
4
4
0.55
0.55
0.55
0.55
0.55
0.005
0.005
0.005
0.005
0.005
8.9
8.7
8.4
9.5
8.4
51.0
51.5
49.7
49.9
49.9
\varepsilon
||x_{i}-x_{\neg i}||^{2}_{2}\approx 0
N=5
N=100
\varepsilon
\varepsilon_{\textnormal{b}},p
\varepsilon_{\textnormal{a}}
\varepsilon_{\textnormal{b}},p
\varepsilon_{\textnormal{a}}
p
p
N=1
N>1
N>1
N|N>1
N=100
\small\begin{split}\widetilde{\pi}^{a,d}&=\Big{(}\texttt{Acc}(Q(\widetilde{q})%
|U(\widetilde{u})),\texttt{Acc}(U(\widetilde{u})|Q(\widetilde{q}))\Big{)}\\
\widetilde{q},\widetilde{u}&:=\Big{\{}\operatorname*{arg\,max}_{q,u}\texttt{%
Acc}(Q(q)|U(u))\Big{\}}\cap\Big{\{}\operatorname*{arg\,max}_{q,u}\texttt{Acc}(%
U(u)|Q(q))\Big{\}}\\
&:=\Big{\{}\operatorname*{arg\,max}_{q,u}\texttt{Acc}(Q(q)|U(u))\Big{\}}\cap%
\Big{\{}\operatorname*{arg\,min}_{q,u}\texttt{Acc}(Q(q)|U(u))\Big{\}},\phantom%
{=}{\textnormal{where }\texttt{Acc}(U(u)|Q(q))=1-\texttt{Acc}(Q(q)|U(u))};\\
&:=\Big{\{}(q,u)_{w}\Big{\}}^{w\in W}\cap\Big{\{}(q,u)_{v}\Big{\}}^{v\in V}\\
&:=\{(q,u)_{w=v}\}^{w,v\in W,V}\end{split}
\widetilde{\pi}^{a_{i},a_{\neg i}}
\pi^{a}
\widetilde{\pi}^{a_{i},a_{\neg i}}=\texttt{max}(\texttt{mean}\pm\texttt{std})
\widetilde{\pi}^{a,d}
\pi^{a}
\pi^{d}
q,u
Q,U
Q:q\mapsto(\varepsilon,p,Y^{\textnormal{poison}},b)
U:u\mapsto(r,s)
\widetilde{\pi}^{a,d}
(q,u)
(q,u)
(q,u)_{w=v}
\small\begin{split}\theta_{t}:=\theta_{t-1}-\sum_{x,y}^{X,Y}\frac{\partial%
\mathcal{L}(x,y)}{\partial\theta}\Rightarrow\phi_{X,Y}=-\sum_{x,y}^{X,Y}\frac{%
\partial\mathcal{L}(x,y)}{\partial\theta}\end{split}
\theta
\phi\sim\Phi
\mathcal{L}
\theta
\theta_{t-1}
\mathbb{D}\setminus\{D_{i}\}
t-1
t
\phi\sim\Phi
\mathbb{D}
\phi_{i}=\theta_{t}-\theta_{t-1}
\phi:\varepsilon_{i}\mapsto y_{i}
\Phi
\{\phi_{i}\}^{N}
\widehat{\phi_{i}\phi_{\neg i}}
\theta\odot m
m\in\{0,1\}^{|\theta|}
\theta
\theta
\phi
\widehat{\phi_{i}\phi_{\neg i}}=(\theta_{t}-\theta_{t-1})\odot(\bigcap_{i}^{N}%
m_{i})
m_{i}
\theta_{t}
\phi_{i}=\widehat{\phi_{i}\phi_{\neg i}}=(\theta_{t}-\theta_{t-1})\odot m_{i}
\phi
\varepsilon\mapsto\phi
\theta_{t}=\theta_{t-1}+\sum_{i}^{|\{\phi\}|}\phi_{i}
\phi
\{\varepsilon\}
\varepsilon
\mathbf{X}(\omega)
X(\omega)
\varepsilon
\mathbf{X}(\omega)
\mathbf{X}
W
\mathbb{R}
\mathbf{X}(\omega)\in\mathbb{R}
\omega\in\mathbb{R}
X(\omega)=\mathbf{X}(\omega)+\varepsilon
X
X:W\mapsto\mathbb{R}
\mathbf{X}
F(x)=\mathbf{P}(X\leq x)
x>0
F_{X}(x)=\mathbf{P}(X\leq x)=\mathbf{P}(\mathbf{X}+\varepsilon\leq x)=\mathbf{%
P}(\mathbf{X}\leq x-\varepsilon)=F_{\mathbf{X}}(x-\varepsilon)
X(\omega)
W
f(x,y;\theta)=\theta\cdot x
\mathcal{L}(x,y;\theta)=f(x)-y
(x_{i}=\mathbf{x}+\varepsilon_{i}),(y\rightarrow y_{i})\sim D_{i}
\frac{\partial\mathcal{L}}{\partial\theta}=\varepsilon(\theta)+c
\small\begin{split}\Delta\mathcal{L}&=\mathcal{L}(x_{i},y_{i};\theta)-\mathcal%
{L}(\mathbf{x},y;\theta)\\
&=[f(x_{i},y_{i};\theta)-f(\mathbf{x},y;\theta)]-[y_{i}-y]\\
&=\theta[x_{i}-\mathbf{x}]-[y_{i}-y]\\
\frac{\partial^{2}\mathcal{L}}{\partial\theta^{2}}&=x_{i}-\mathbf{x}=%
\varepsilon\\
\frac{\partial\mathcal{L}}{\partial\theta}&=\varepsilon(\theta)+c\end{split}
x,y\sim\mathbb{D}\setminus(D_{0}\cup\{D_{i}\}^{N})
(\mathbf{x}+\varepsilon_{\textnormal{noise}}+\{\varepsilon_{i}\}^{N}),(y%
\rightarrow y_{i})\sim D_{i}
\small\begin{split}x&=\mathbf{x}+\varepsilon\\
\mathcal{L}(x,y)&=\mathcal{L}(\mathbf{x},y)+\mathcal{L}(\varepsilon,y)\\
\frac{\partial\mathcal{L}(x,y)}{\partial\theta}&=\frac{\partial\mathcal{L}(%
\mathbf{x},y)}{\partial\theta}+\frac{\partial\mathcal{L}(\varepsilon,y)}{%
\partial\theta}\\
\Rightarrow\theta_{t}&:=\theta_{t-1}-\sum_{\mathbf{x},y}^{X,Y}\frac{\partial%
\mathcal{L}(\mathbf{x},y)}{\partial\theta}-\sum_{\varepsilon,y}^{X,Y}\frac{%
\partial\mathcal{L}(\varepsilon,y)}{\partial\theta}\end{split}
\frac{\partial\mathcal{L}(\mathbf{x},y)}{\partial\theta}
\theta
\mathbf{x}
\theta\odot m_{\mathbf{x}}
\frac{\partial\mathcal{L}(\varepsilon,y)}{\partial\theta}
\theta
\varepsilon
\theta\odot m_{\varepsilon}
m_{\mathbf{x}},m_{\varepsilon}\in\{0,1\}^{|\theta|}
\theta\equiv\theta\odot(m_{\mathbf{x}}+m_{\varepsilon})
\mathbf{x}\rightarrow x_{i}
y\rightarrow y_{i}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}\approx 0\phantom%
{=},\phantom{=}||y_{i}-y||_{2}^{2}\approx 0\phantom{==}\textnormal{(Case 1)}%
\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}\approx 0\phantom%
{=},\phantom{=}||y_{i}-y||_{2}^{2}\approx 0\phantom{==}\textnormal{(Case 1)}%
\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}>0\phantom{=},%
\phantom{=}||y_{i}-y||_{2}^{2}\approx 0\phantom{==}\textnormal{(Case 2)}\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}>0\phantom{=},%
\phantom{=}||y_{i}-y||_{2}^{2}\approx 0\phantom{==}\textnormal{(Case 2)}\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}\approx 0\phantom%
{=},\phantom{=}||y_{i}-y||_{2}^{2}>0\phantom{==}\textnormal{(Case 3)}\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}\approx 0\phantom%
{=},\phantom{=}||y_{i}-y||_{2}^{2}>0\phantom{==}\textnormal{(Case 3)}\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}>0\phantom{=},%
\phantom{=}||y_{i}-y||_{2}^{2}>0\phantom{==}\textnormal{(Case 4)}\end{split}
\displaystyle\begin{split}\small&||x_{i}-\mathbf{x}||_{2}^{2}>0\phantom{=},%
\phantom{=}||y_{i}-y||_{2}^{2}>0\phantom{==}\textnormal{(Case 4)}\end{split}
\varepsilon=\{\varepsilon_{i}\}^{i\in N+1}
N\rightarrow\infty
\varepsilon\sim\texttt{Rand}
\texttt{Rand}:s\sim\mathcal{U}(S)
\mathbb{P}(s)=\frac{1}{|S|}
s
S
\varepsilon\sim\texttt{Rand}
\frac{\partial\mathcal{L}(\varepsilon,y;\theta)}{\partial\theta}\sim\texttt{Rand}
f(x_{i};\theta)-f(\mathbf{x};\theta)\approx f(\varepsilon;\theta)\sim\texttt{Rand}
\frac{\partial\mathcal{L}(\varepsilon,y;\theta)}{\partial\theta}
\frac{\partial\mathcal{L}(\varepsilon,y;\theta)}{\partial\theta}\neq 0
\theta=\theta\odot(m_{\mathbf{x}}+m_{\varepsilon})
f(\varepsilon;\theta)\approx f(\varepsilon;\theta+m_{\varepsilon})\sim\texttt{Rand}
\frac{\partial\mathcal{L}(\varepsilon,y;\theta)}{\partial\theta}=0
m_{\mathbf{x}}=1^{|\theta|},m_{\varepsilon}=0^{|\theta|}
f(\varepsilon;\theta)\approx f(\varepsilon;\theta+m_{\mathbf{x}})\sim\texttt{Rand}
f
\mathcal{Y}
y\sim\mathcal{U}(\mathcal{Y})
\mathbb{P}(y)=\frac{1}{|\mathcal{Y}|}
\frac{1}{|\mathcal{Y}|}
0.1
\mathcal{X}
\mathcal{Y}
x,y\sim\mathbb{D}\setminus(D_{0}\cup\{D_{i}\}^{N})
(\mathbf{x}+\varepsilon_{\textnormal{noise}}+\{\varepsilon_{i}\}^{N}),(y%
\rightarrow y_{i})\sim D_{i}
\mathbf{P}_{x\rightarrow y}(x)
x
y
f
\mathbf{P}
(i,\neg i)
(\varepsilon_{i},\varepsilon_{\neg i})
(y_{i},y_{\neg i})
f
\mathbf{P}
f(x)
\{\varepsilon\}
\varepsilon_{i}:y_{i}
x,y\sim\mathbb{D}
\mathbf{P}_{x\rightarrow y}(x)
x
y
f
\mathbf{P}
\mathbf{P}(x)=\{\mathbf{P}_{\mathbf{x}\rightarrow y}(\mathbf{x})\cdot\mathbf{P%
}_{\varepsilon_{\textnormal{noise}}\rightarrow y}(\varepsilon_{\textnormal{%
noise}})\}^{y\in\mathcal{Y}}
\small\begin{split}f(x;\theta)=\operatorname*{arg\,max}_{y\in\mathcal{Y}}\{%
\mathbf{P}_{\mathbf{x}\rightarrow y}(\mathbf{x})\cdot\mathbf{P}_{\varepsilon_{%
\textnormal{noise}}\rightarrow y}(\varepsilon_{\textnormal{noise}})\}\end{split}
x,y\sim\mathbb{D}\setminus D_{0}
(\mathbf{x}+\varepsilon_{\textnormal{noise}}+\varepsilon_{0}),(y\rightarrow y_%
{0})\sim D_{0}
\varepsilon_{0}>0
y\neq y_{0}
x\sim\mathbb{D}
\mathbb{D}=D_{0}\cup(\mathbb{D}\setminus D_{0})
x
f
\varepsilon_{0}
f
\phi_{0}
\phi_{0}
\small\begin{split}f(x;\theta+\phi_{0})=\operatorname*{arg\,max}_{y\in\mathcal%
{Y}}\{&\mathbf{P}_{\mathbf{x}\rightarrow y}(\mathbf{x})\cdot\mathbf{P}_{%
\varepsilon_{\textnormal{noise}}\rightarrow y}(\varepsilon_{\textnormal{noise}%
})\cdot\mathbf{P}_{\varepsilon_{0}\rightarrow y}(\varepsilon_{0})\}\end{split}
x,y\sim\mathbb{D}\setminus(D_{0}\cup D_{1})
(\mathbf{x}+\varepsilon_{\textnormal{noise}}+\varepsilon_{0}),(y\rightarrow y_%
{0})\sim D_{0}
(\mathbf{x}+\varepsilon_{\textnormal{noise}}+\varepsilon_{1}),(y\rightarrow y_%
{1})\sim D_{1}
\varepsilon_{0},\varepsilon_{1}>0
y\neq y_{0},y_{1}
D_{0}
D_{1}
||\varepsilon_{0}-\varepsilon_{1}||_{2}^{2}>0
||\varepsilon_{0}-\varepsilon_{1}||_{2}^{2}\approx 0
y_{0}=y_{1}
y_{0}\neq y_{1}
\theta
\varepsilon_{0}
\theta+\phi_{0}
\varepsilon_{1}
\theta+\phi_{1}
\varepsilon_{0}
\varepsilon_{1}
\theta+\widehat{\phi_{0}\phi_{1}}
x\sim\mathbb{D}
\theta+\phi
\small\begin{split}f(x;\theta+\phi)=\operatorname*{arg\,max}_{y\in\mathcal{Y}}%
\{&\mathbf{P}_{\mathbf{x}\rightarrow y}(\mathbf{x})\cdot\mathbf{P}_{%
\varepsilon_{\textnormal{noise}}\rightarrow y}(\varepsilon_{\textnormal{noise}%
})\cdot\mathbf{P}_{\varepsilon_{0}\rightarrow y}(\varepsilon_{0})\cdot\mathbf{%
P}_{\varepsilon_{1}\rightarrow y}(\varepsilon_{1})\}\end{split}
(i,\neg i)
(\varepsilon_{i},\varepsilon_{\neg i})
(y_{i},y_{\neg i})
\phi
N
\small\begin{split}f(x;\theta+\phi)=\operatorname*{arg\,max}_{y\in\mathcal{Y}}%
\bigg{\{}\mathbf{P}_{\mathbf{x}\rightarrow y}(\mathbf{x})&\cdot\mathbf{P}_{%
\varepsilon_{\textnormal{noise}}\rightarrow y}(\varepsilon_{\textnormal{noise}%
})\cdot\prod_{i}^{N}\mathbf{P}_{\varepsilon_{i}\rightarrow y}(\varepsilon_{i})%
\bigg{\}}\end{split}
||\varepsilon_{i}-\varepsilon_{\neg i}||_{2}^{2}\approx 0
y_{i}=y_{\neg i}
\{\varepsilon_{0},y_{0}\}
y_{i}\neq y_{\neg i}
||\varepsilon_{i}-\varepsilon_{\neg i}||_{2}^{2}\approx 0
\mathbf{P}_{\varepsilon_{i}\rightarrow y}(\varepsilon_{i})
|\{\varepsilon_{i}\rightarrow y_{i}\}-|\{\varepsilon_{\neg i}\rightarrow y_{%
\neg i}\}|
a_{i}
a_{\neg i}
|{\varepsilon}|
||\varepsilon_{i}-\varepsilon_{\neg i}||_{2}^{2}>0
y_{i}=y_{\neg i}
y_{i}\neq y_{\neg i}
\varepsilon
||\varepsilon_{i}-\varepsilon_{\neg i}||_{2}^{2}>0
y_{i}=y_{\neg i}
y_{i}\neq y_{\neg i}
\phi
\theta
\theta
\theta
\mathbb{D}\setminus D_{i}
\frac{\partial\mathcal{L}(\mathbf{x},y)}{\partial\theta}\approx 0
\theta\rightarrow\theta^{*}
\mathcal{L}(\theta\cup\phi^{\textnormal{backdoor}})<\mathcal{L}(\theta)
\textnormal{LHS}>\textnormal{RHS}
\textnormal{LHS}>\textnormal{RHS}
\small\begin{split}\frac{\partial\mathcal{L}(x,y)}{\partial\theta}=\frac{%
\partial\mathcal{L}(\mathbf{x},y)}{\partial\theta}+\frac{\partial\mathcal{L}(%
\varepsilon,y)}{\partial\theta}\approx\frac{\partial\mathcal{L}(\varepsilon,y)%
}{\partial\theta}\end{split}
\small\begin{split}\phantom{X}\mathcal{L}(\theta+\phi^{\textnormal{backdoor}};%
X^{\textnormal{clean}},Y^{\textnormal{clean}})+\mathcal{L}(\theta+\phi^{%
\textnormal{backdoor}};X^{\textnormal{poison}},Y^{\textnormal{poison}})<%
\phantom{X}\mathcal{L}(\theta;X^{\textnormal{clean}},Y^{\textnormal{clean}})+%
\mathcal{L}(\theta;X^{\textnormal{poison}},Y^{\textnormal{poison}})\end{split}
\small\begin{split}&\phantom{X}\mathcal{L}(\theta+\phi^{\textnormal{backdoor}}%
;X^{\textnormal{clean}},Y^{\textnormal{clean}})-\mathcal{L}(\theta;X^{%
\textnormal{clean}},Y^{\textnormal{clean}})<\phantom{X}\mathcal{L}(\theta;X^{%
\textnormal{poison}},Y^{\textnormal{poison}})-\mathcal{L}(\theta+\phi^{%
\textnormal{backdoor}};X^{\textnormal{poison}},Y^{\textnormal{poison}})\end{split}
\phi
N=10^{0}
\small\begin{split}\sum_{x,y}^{\mathbb{D}\setminus D_{0}}\bigg{[}&\mathcal{L}(%
\theta+\phi^{\textnormal{backdoor}};x^{\textnormal{clean}},y^{\textnormal{%
clean}})-\mathcal{L}(\theta;x^{\textnormal{clean}},y^{\textnormal{clean}})%
\bigg{]}<\sum_{x,y}^{D_{0}}\bigg{[}\mathcal{L}(\theta;x^{\textnormal{poison}},%
y^{\textnormal{poison}})-\mathcal{L}(\theta+\phi^{\textnormal{backdoor}};x^{%
\textnormal{poison}},y^{\textnormal{poison}})\bigg{]}\end{split}
\small\begin{split}\sum_{x,y}^{\mathbb{D}\setminus D_{0}}\bigg{[}\mathcal{L}(%
\theta+\phi^{\textnormal{backdoor}};x^{\textnormal{clean}},y^{\textnormal{%
clean}})-\mathcal{L}(\theta;x^{\textnormal{clean}},y^{\textnormal{clean}})%
\bigg{]}<&\sum_{x,y}^{D_{0}}\frac{|\mathbf{x}|}{|x|}\bigg{[}\mathcal{L}(\theta%
;x^{\textnormal{poison}},y^{\textnormal{poison}})-\mathcal{L}(\theta+\phi^{%
\textnormal{backdoor}};x^{\textnormal{poison}},y^{\textnormal{poison}})\bigg{]%
}\\
+&\sum_{x,y}^{D_{0}}\frac{|\varepsilon|}{|x|}\bigg{[}\mathcal{L}(\theta;x^{%
\textnormal{poison}},y^{\textnormal{poison}})-\mathcal{L}(\theta+\phi^{%
\textnormal{backdoor}};x^{\textnormal{poison}},y^{\textnormal{poison}})\bigg{]%
}\end{split}
\small\begin{split}&\frac{|\varepsilon|}{|x|}\sum_{x,y}^{D_{0}}\bigg{[}%
\mathcal{L}(\theta;x^{\textnormal{poison}},y^{\textnormal{poison}})-\mathcal{L%
}(\theta+\phi^{\textnormal{backdoor}};x^{\textnormal{poison}},y^{\textnormal{%
poison}})\bigg{]}\\
>&\bigg{[}|\mathbb{D}\setminus D_{0}|+\frac{|\mathbf{x}|}{|x|}|D_{0}|\bigg{]}%
\cdot\frac{1}{|\mathbb{D}\setminus D_{0}|}\sum_{x,y}^{\mathbb{D}\setminus D_{0%
}}\bigg{[}\mathcal{L}(\theta+\phi^{\textnormal{backdoor}};x^{\textnormal{clean%
}},y^{\textnormal{clean}})-\mathcal{L}(\theta;x^{\textnormal{clean}},y^{%
\textnormal{clean}})\bigg{]}\end{split}
D_{0},\varepsilon
\begin{cases}\frac{|\varepsilon|}{|x|}\geq\frac{1}{2}\\
|D_{0}|>2|\mathbb{D}\setminus D_{0}|\end{cases}
\phi^{\textnormal{backdoor}}
X^{\textnormal{poison}}
\phi^{\textnormal{backdoor}}
\phi
\max(\textnormal{RHS}-\textnormal{LHS})
\max(\textnormal{LHS}-\textnormal{RHS})
\min(\textnormal{LHS}-\textnormal{RHS})
\min(\textnormal{RHS}-\textnormal{LHS})
\begin{cases}\frac{\partial\mathcal{L}(\mathbf{x},y)}{\partial\theta}<0\\
\frac{\partial\mathcal{L}(\varepsilon,y)}{\partial\theta}<0\end{cases}
\mathbf{sign}(x)=\begin{cases}+1\phantom{=}\textnormal{for }x>0\\
-1\phantom{=}\textnormal{for }x<0\end{cases}
\small\begin{split}\mathbf{sign}(\frac{\partial\mathcal{L}(\mathbf{x},y;\theta%
+\phi)}{\partial\theta})+\mathbf{sign}(\frac{\partial\mathcal{L}(\varepsilon,y%
;\theta+\phi)}{\partial\theta})\equiv-2\end{split}
\theta=\sum_{c}^{|\mathbb{D}|}\phi_{c}+\sum_{n}^{N}\phi_{b_{n}}
N
N>1
p
p=\sum_{n}^{N}p_{n}=\sum_{n}^{N}\frac{|D_{n}|}{\mathbb{D}}
(1-p)>p_{n}\forall n\in N
(1-p)
N
\theta
\theta
\small\begin{split}&\sum_{x,y}^{\mathbb{D}\setminus D_{i}}\mathcal{L}(\theta+%
\sum\phi_{n}^{\textnormal{backdoor}};x^{\textnormal{clean}},y^{\textnormal{%
clean}})+\sum_{i}^{N}\sum_{x,y}^{D_{i}}\mathcal{L}(\theta+\sum\phi_{n}^{%
\textnormal{backdoor}};x^{\textnormal{poison}},y^{\textnormal{poison}})\\
<&\sum_{x,y}^{\mathbb{D}\setminus D_{i}}\mathcal{L}(\theta;x^{\textnormal{%
clean}},y^{\textnormal{clean}})+\sum_{i}^{N}\sum_{x,y}^{D_{i}}\mathcal{L}(%
\theta;x^{\textnormal{poison}},y^{\textnormal{poison}})\end{split}
N
N
\small\begin{split}\{\varepsilon:\phi\}^{*}:=\operatorname*{arg\,min}_{\{%
\varepsilon:\phi\}}-(1+|\{\varepsilon\}|)\equiv\operatorname*{arg\,min}_{\{%
\varepsilon:\phi\}}\bigg{[}\mathbf{sign}(\frac{\partial\mathcal{L}(\mathbf{x},%
y;\theta+\phi)}{\partial\theta})+\sum_{\varepsilon,\phi}^{\{\varepsilon\mapsto%
\phi\}}\mathbf{sign}(\frac{\partial\mathcal{L}(\varepsilon,y;\theta+\phi)}{%
\partial\theta})\bigg{]}\end{split}
p_{n}
\theta
\phi^{\textnormal{clean}}
\phi^{\textnormal{clean}}
\phi^{\textnormal{style}}
\phi^{\textnormal{backdoor}}
N
||\phi_{i}(x)-\phi_{j}(x)||_{2}^{2}>0
\begin{cases}\frac{|\varepsilon|}{|x|}\geq\frac{1}{2}\\
|D_{0}|>2|\mathbb{D}\setminus D_{0}|\end{cases}
\frac{\mathcal{L}(\theta+\phi;X^{\textnormal{backdoor}},Y^{\textnormal{%
backdoor}})-\mathcal{L}(\theta;X^{\textnormal{backdoor}},Y^{\textnormal{%
backdoor}})}{\mathcal{L}(\theta+\phi;X^{\textnormal{clean}},Y^{\textnormal{%
clean}})-\mathcal{L}(\theta;X^{\textnormal{clean}},Y^{\textnormal{clean}})}=1
\small\begin{split}\frac{|\varepsilon|}{|x|}&>|\mathbb{D}\setminus D_{0}|+%
\frac{|\mathbf{x}|}{|x|}|D_{0}|\\
\frac{|\varepsilon|}{|x|}&>|\mathbb{D}\setminus D_{0}|+1-\frac{|\varepsilon|}{%
|x|}|D_{0}|\\
(2\frac{|\varepsilon|}{|x|}-1)|D_{0}|&>|\mathbb{D}\setminus D_{0}|\end{split}
2\frac{|\varepsilon|}{|x|}-1
\small\begin{split}2\frac{|\varepsilon|}{|x|}-1&\geq 0\\
\frac{|\varepsilon|}{|x|}&\geq\frac{1}{2}\end{split}
|D_{0}|
\frac{|\varepsilon|}{|x|}=\frac{1}{2}
\small\begin{split}|D_{0}|&>2|\mathbb{D}\setminus D_{0}|\end{split}
\texttt{length }l\times\texttt{width }w\times\texttt{channels }c
x\in X
m
x
(l,w,c)
m
x
z
z(l,w,c)=\begin{cases}1,&\mbox{if }m(l,w,c)>0\\
0,&\mbox{if }m(l,w,c)=0\end{cases}
p=\frac{|X^{\textnormal{poison}}|}{|X^{\textnormal{clean}}|+|X^{\textnormal{%
poison}}|}
\odot
x^{poison}=x\odot(1-z)+m\odot z
b:X^{\textnormal{poison}}:=\{x\odot(1-z)+m\odot z\}^{x\in X^{\textnormal{%
poison}}}
N=1
\varepsilon
m_{i}
a_{i}
\varepsilon_{i}
(l,w,c)
\varepsilon_{i}
z_{i}
m_{i}
\begin{split}z_{i}=\{\texttt{numpy.random.choice}([0,1],\texttt{size}=l\times w%
,\texttt{p}=[1-\varepsilon_{i},\varepsilon_{i}]).\texttt{reshape}(l,w)\}\times
c%
\end{split}
\begin{split}m_{i}(l,w,c)=\begin{cases}\texttt{numpy.random.uniform}(0,1)%
\times 255,\\
\phantom{==============}\mbox{if }z(l,w,c)=1\\
0,\phantom{============|}\mbox{if }z(l,w,c)=0\end{cases}\end{split}
x_{i}^{poison}=x_{i}\odot(1-z_{i})+m_{i}\odot z_{i}
b:X_{i}^{\textnormal{poison}}:=\{x_{i}\odot(1-z_{i})+m_{i}\odot z_{i}\}^{x_{i}%
\in X_{i}^{\textnormal{poison}}}
\frac{1}{10}
\texttt{Acc w.r.t. poisoned labels}-0.1
N
N
l=w
o_{i}=\{\texttt{scipy.stats.ortho_group.rvs(l)}\}\times c
b:X_{i}^{\textnormal{poison}}:=\{x_{i}\odot(1-z_{i}\odot o_{i})+m_{i}\odot z_{%
i}\odot o_{i}\}^{x_{i}\in X_{i}^{\textnormal{poison}}}
1-V_{d}
(1-V_{d})\times\frac{1}{N}
\rho=(1-V_{d})\times\frac{1}{N}\times p
N=1000
N
N=1000
p=0.1
V_{d}=0.1
N=1
30
92-93\%
0.001
0.9
[16,32,32]
N
1…10
10…20
20…100
100..500
500…1000
N
\varepsilon_{\textnormal{a}}=0.1
\varepsilon_{\textnormal{a}}=1.0
1.0
\varepsilon_{\textnormal{a}}^{{}^{\prime}}=0.1\times\varepsilon_{\textnormal{a}}
\alpha
\varepsilon,p=0.0
\varepsilon_{\textnormal{b}},p=1.0
V_{d}
\varepsilon
p
d
a
\varepsilon=0.55
(26.2,73.8)
(13.7,86.3)
0\%
(8.6,91.4)
(12.3,87.7)
100\%
(54.2,45.8)
(18.1,81.9)
(40.3,59.7)
(20.3,79.7)
(12.2,87.8)
(8.8,91.2)
(20.3,79.7)
a
d
(20.3,79.7)
a
d
p,\varepsilon
N
N=100
N\{Y\}
Y
\varepsilon
\varepsilon
\varepsilon
\varepsilon
0.0011(66)
12
p=1.0
N
\varepsilon
50\%
V_{d}=0.8
0.8
50\%
p,\varepsilon=0.4
(1-0.5)\times 0.8\times\frac{1}{20}
N=1
N=100
\varepsilon,p=0.55
N
N
N
N
N
N
N
\varepsilon
\varepsilon,p
N=1
N=100
\alpha=0.0
\alpha=0.0
\alpha=1.0
\alpha=1.0
N
N
\alpha=0,0.5,1.0
\alpha=0,0.5,1.0
