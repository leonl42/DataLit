f
{\mathcal{F}}
f^{*}
{\mathcal{P}}_{\theta}
{\mathcal{P}}_{d}
(x,x^{+})
x^{\prime}
f_{\theta}:{\mathbb{R}}^{d}\to{\mathbb{R}}^{m}
\textstyle{\mathcal{L}}_{\rm nce}(\theta)=-\mathbb{E}_{x,x^{+}}[f_{\theta}(x)^%
{\top}f_{\theta}(x^{+})]+\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}[\exp(f_{%
\theta}(x)^{\top}f_{\theta}(x^{\prime}))],
(x,x^{+})
(x,x^{\prime})
M
f_{\theta}(x)
{\mathcal{R}}^{m}
F_{\theta}
{\mathcal{X}}
\bar{\mathcal{X}}=\{\bar{x}\mid\bar{x}\in{\mathbb{R}}^{d}\}
\bar{x}\in{\mathcal{P}}_{d}(\bar{{\mathcal{X}}})
x,x^{+}
\bar{x}
{\mathcal{A}}(\cdot|\bar{x})
{\mathcal{X}}
\mathcal{X}=\cup_{\bar{x}\in\bar{\mathcal{X}}}\operatorname{supp}\left(%
\mathcal{A}(\cdot|\bar{x})\right)
N
{\mathcal{X}}
N
{\mathcal{G}}=({\mathcal{X}},A)
A
A_{xx^{\prime}}\geq 0
x
x^{\prime}
A_{xx^{\prime}}={\mathcal{P}}_{d}(x,x^{\prime})=\mathbb{E}_{\bar{x}}{\mathcal{%
A}}(x|\bar{x}){\mathcal{A}}(x^{\prime}|\bar{x})
\bar{A}=D^{-1/2}AD^{-1/2}
D=\deg(A)
D_{xx}=w_{x}=\sum_{x^{\prime}}A_{xx^{\prime}}
L=I-\bar{A}
w_{x}=1/N
{\mathcal{L}}_{\rm unif}
{\mathcal{L}}^{\rm(sp)}_{\rm unif}
\displaystyle{\mathcal{L}}_{\rm align}(F)=\operatorname{Tr}(F^{\top}LF)=\frac{%
1}{2}\mathbb{E}_{x,x^{+}}\|f(x)-f(x^{+})\|^{2},
\displaystyle{\mathcal{L}}_{\rm align}(F)
\displaystyle=\operatorname{Tr}(F^{\top}LF)=\frac{1}{2}\mathbb{E}_{x,x^{+}}\|f%
(x)-f(x^{+})\|^{2},
\displaystyle{\mathcal{L}}_{\rm unif}(F)=\operatorname{LSE}(FF^{\top})-\|F\|^{%
2}=\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}\exp(f(x)^{\top}f(x^{\prime}))-%
\mathbb{E}_{x}\|f(x)\|^{2},
\displaystyle{\mathcal{L}}_{\rm unif}(F)
\displaystyle=\operatorname{LSE}(FF^{\top})-\|F\|^{2}=\mathbb{E}_{x}\log%
\mathbb{E}_{x^{\prime}}\exp(f(x)^{\top}f(x^{\prime}))-\mathbb{E}_{x}\|f(x)\|^{%
2},
\operatorname{LSE}(X)={\operatorname{Tr}(D\log(\operatorname{deg}(D\exp(D^{-1/%
2}XD^{-1/2}))))}
\log,\exp
x
F
F_{x}=\sqrt{w_{x}}f_{\theta}(x)
\mathcal{L}_{\rm nce}(\theta)={\mathcal{L}}_{\rm align}(F_{\theta})+{\mathcal{%
L}}_{\rm unif}(F_{\theta}).
{\mathcal{L}}_{\rm align}(\theta)=-\mathbb{E}_{x,x^{+}}f_{\theta}(x)^{\top}f_{%
\theta}(x^{+})
-\infty
F
{\mathcal{L}}_{\rm align}(F)=\operatorname{Tr}(F^{\top}LF)
\alpha>0
\text{(global update)}\quad F^{(t+1)}=F^{(t)}-\alpha\nabla_{F^{(t)}}{{\mathcal%
{L}}}_{\rm align}(F^{(t)})=\left[(1-2\alpha)I+2\alpha\bar{A}\right]F^{(t)}.
F^{(t)}
P=(1-2\alpha)I+2\alpha\bar{A}
F_{x}
x
\textstyle\text{(local update)}\quad F^{(t+1)}_{x}=(1-2\alpha)F^{(t+1)}_{x}+2%
\alpha\sum_{x^{\prime}\in{\mathcal{N}}_{x}}{\bar{A}}_{xx^{\prime}}F^{(t+1)}_{x%
^{\prime}}.
F_{x}
{\mathcal{N}}_{x}=\{x^{\prime}\in{\mathcal{X}}|\bar{A}_{xx^{\prime}}>0\}
x,x^{+}
A_{xx^{+}}
k
{\mathcal{M}}
X
\Omega
d_{\Omega}(X):=\inf\{\|X-Y\|_{F}\mid Y\in\Omega\}
k
{\bar{A}}_{k}
t
F^{(t)}_{k}
{\mathcal{M}}
d_{\mathcal{M}}(F^{(t+1)}_{k})\leq|1-2\alpha\lambda_{{\mathcal{G}}_{k}}|\cdot d%
_{\mathcal{M}}(F^{(t)}_{k}),
\lambda_{{\mathcal{G}}_{k}}\in[0,2]
{\mathcal{G}}
\mathcal{M}=\{e_{1}\otimes y|y\in\mathbb{R}^{c}\}
e_{1}
{\bar{A}}_{k}
\lambda_{{\mathcal{G}}_{k}}
\lambda_{{\mathcal{G}}_{k}}
\lambda_{{\mathcal{G}}_{k}}
\lambda_{{\mathcal{G}}_{k}}
L
\lambda_{{\mathcal{G}}_{k}}>0
{\mathcal{G}}_{k}
\lambda_{{\mathcal{G}}_{k}}
x,x^{\prime}\in{\mathcal{X}}
{\mathcal{G}}^{\prime}
A^{\prime}
\text{(global update)}\quad F^{(t+1)}={F^{(t)}-\alpha\nabla_{F^{(t)}}{\mathcal%
{L}}_{\rm unif}(F^{(t)})}=[(1+2\alpha)I-2\alpha{\bar{A}}^{\prime}_{\rm sym}]F^%
{(t)},
{\bar{A}}^{\prime}_{\rm sym}={D^{\prime}}_{\exp}^{-1}A^{\prime}_{\exp}+{A^{%
\prime}}_{\exp}{D^{\prime}}_{\exp}^{-1}
A_{\exp}^{\prime}=\exp(D^{-1/2}F^{(t)}F^{(t)\top}D^{-1/2}),{D^{\prime}}_{\exp}%
=\deg({A^{\prime}}_{\exp})
\text{(global update with stop gradient)}~{}~{}F^{(t+1)}=[(1+\alpha)I-\alpha{%
\bar{A}}^{\prime}]F^{(t)},\text{ where }{\bar{A}}^{\prime}={D^{\prime}}_{\exp}%
^{-1}A^{\prime}_{\exp}.
{\mathcal{G}}^{\prime}=({\mathcal{X}},A^{\prime})
{\mathcal{X}}
A^{\prime}
{\mathcal{G}}
(x,x^{\prime})
{\bar{A}}^{\prime}
k_{\rm RBF}(u,v)=\exp(-\|u-v\|^{2}/2)
\|f(x)\|=1
{\bar{A}}
{\bar{A}}_{\rm nce}^{\prime}
{F^{(t+1)}={F^{(t)}-\alpha\nabla_{F^{(t)}}{\mathcal{L}}_{\rm nce}(F^{(t)})}=F^%
{(t)}+\alpha({\bar{A}}-{\bar{A}}^{\prime})F^{(t)},}
A_{\rm diff}={\bar{A}}-{\bar{A}}^{\prime}
\small{\mathcal{L}}(F)=-\operatorname{Tr}(\operatorname{sg}(A_{\rm diff})FF^{%
\top})=-\operatorname{Tr}({\bar{A}}FF^{\top})+\operatorname{Tr}(\operatorname{%
sg}(A^{\prime})FF^{\top})={\mathcal{L}}_{\rm align}(F)+{\mathcal{L}}_{\rm unif%
}(F),
\operatorname{sg}(\cdot)
{\mathcal{D}}
(-1,0)
(1,0)
0.7
{\mathcal{G}}
A_{ij}=1
\|x_{i}-x_{j}\|_{2}\leq 0.4
\{f_{i}\}
[-1,1]^{2}
{\mathcal{G}}
0.1
{\mathcal{D}}
(-1,0)
(1,0)
0.7
{\mathcal{G}}
A_{ij}=1
\|x_{i}-x_{j}\|_{2}\leq 0.4
\{f_{i}\}
[-1,1]^{2}
{\mathcal{G}}
0.1
{\bar{A}}_{\rm diff}={\bar{A}}-A^{\prime}=0
{\bar{A}}={\bar{A}}^{\prime}_{\rm nce}
\forall\ x,x^{+}\in{\mathcal{X}},~{}~{}{\mathcal{P}}_{d}(x^{+}|x)={\mathcal{P}%
}_{\theta}(x^{+}|x)\triangleq\frac{\exp(f_{\theta}(x)^{\top}f_{\theta}(x^{+}))%
}{\sum_{x^{\prime}}\exp(f_{\theta}(x)^{\top}f_{\theta}(x^{\prime}))}.
{\mathcal{P}}_{d}(x^{+}|x)
{\mathcal{P}}_{\theta}(x^{+}|x)
{\mathcal{P}}_{\theta}(x^{+}|x)
P_{d}(x^{+}|x)
{\mathcal{G}}
\tau
\tau
{\mathcal{P}}_{\theta}
{\mathcal{P}}_{d}
{\bar{A}}
{\bar{A}}^{\prime}
N
X\in{\mathbb{R}}^{N\times d}
{\bar{A}}\in{\mathbb{R}}^{n\times n}
H^{(t)}\in{\mathbb{R}}^{n\times m}
t
H^{(t+1)}={\bar{A}}H^{(t)}
H^{(t+1)}=(1-\Delta t)I+\Delta t{\bar{A}}H^{(t)}
\Delta t
\Delta t=1
{\bar{A}}
\Delta t=2\alpha
F
F
{\bar{A}}
H^{(t)}\in{\mathbb{R}}^{N\times m}
t
H^{(t+1)}={\bar{A}}^{\prime}H^{(t)},\text{ where }{\bar{A}}^{\prime}={D^{%
\prime}}_{\exp}^{-1}A^{\prime}_{\exp},A^{\prime}_{\exp}=\exp(H^{(t)}H^{(t)\top%
}).
\alpha=-1
\ell_{2}
\ell_{2}
f(x)/\|f(x)\|
\ell_{2}
\ell_{2}
f(x)-\mu
\mu
s
s
H^{(T)}
H^{(1)},\dots,H^{(T)}
{\mathcal{M}}
s
\bar{x}
t
x
\bar{x}
z^{(t-1)}_{\bar{x}},z^{(t-2)}_{\bar{x}},\dots,z^{(t-r)}_{\bar{x}}
r=\min(s,t)
f_{\theta}(x^{+})
z_{\bar{x}}=\frac{1}{r}\sum_{i=1}^{r}z^{(t-i)}_{\bar{x}}
f_{\theta}
{\mathcal{L}}_{\rm multi-align}(\theta)=-\mathbb{E}_{\bar{x}}\mathbb{E}_{x|%
\bar{x}}(f_{\theta}(x)^{\top}z_{\bar{x}}).
z=f_{\theta}(x)
s\geq 2
x
{\mathcal{N}}_{x}
\textstyle H^{(t+1)}_{x}=\sum_{x^{+}\in{\mathcal{N}}_{x}}\alpha(x,x^{+})H^{(t)%
}_{x^{+}},\text{ where }\alpha(x,x^{+})=\frac{\exp(e({x,x^{+}}))}{\sum_{x^{%
\prime}\in{\mathcal{N}}_{i}}\exp(e({x,x^{\prime}}))}.
e({x,x^{\prime}})
e(x,x^{\prime})=H^{(t)}x^{\top}{H}^{(t)}_{x^{\prime}}
e({x,x^{+}})=f_{\theta}(x)^{\top}f_{\theta}(x^{+})
{\mathcal{L}}_{\rm attn-align}(\theta)=\frac{1}{2}\mathbb{E}_{x,x^{+}}\alpha(x%
,x^{+})\|f_{\theta}(x)-f_{\theta}(x^{+})\|^{2}.
\alpha(x,x^{+})
\alpha(x,x^{+})=\frac{\exp(\beta\cdot f_{\theta}(x)^{\top}f_{\theta}(x^{+}))}{%
\sum_{x^{\prime}}\exp(\beta\cdot f_{\theta}(x)^{\top}f_{\theta}(x^{\prime}))}
M
\beta
\text{(local update with attention) }F_{x}\leftarrow(1-2\alpha)F_{x}+2\alpha%
\sum_{x^{+}}^{N}{\bar{A}}_{xx^{+}}\alpha(x,x^{+})F_{x^{+}}.
\alpha(x,x^{+})
{\mathcal{L}}_{\rm sp}
N
{\mathcal{O}}(N^{3})
x
F
F_{x}=\sqrt{w_{x}}f_{\theta}(x)
\mathcal{L}_{\rm nce}(\theta)={\mathcal{L}}_{\rm align}(F_{\theta})+{\mathcal{%
L}}_{\rm unif}(F_{\theta}).
F
f(x)
\displaystyle{\mathcal{L}}_{\rm align}(F)=\operatorname{Tr}(F^{\top}LF)=\frac{%
1}{2}\mathbb{E}_{x,x^{+}}\|f(x)-f(x^{+})\|^{2},
\displaystyle{\mathcal{L}}_{\rm align}(F)
\displaystyle=\operatorname{Tr}(F^{\top}LF)=\frac{1}{2}\mathbb{E}_{x,x^{+}}\|f%
(x)-f(x^{+})\|^{2},
\displaystyle{\mathcal{L}}_{\rm unif}(F)=\operatorname{LSE}(FF^{\top})-\|F\|^{%
2}=\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}\exp(f(x)^{\top}f(x^{\prime}))-%
\mathbb{E}_{x}\|f(x)\|^{2},
\displaystyle{\mathcal{L}}_{\rm unif}(F)
\displaystyle=\operatorname{LSE}(FF^{\top})-\|F\|^{2}=\mathbb{E}_{x}\log%
\mathbb{E}_{x^{\prime}}\exp(f(x)^{\top}f(x^{\prime}))-\mathbb{E}_{x}\|f(x)\|^{%
2},
\displaystyle\operatorname{Tr}(F^{\top}LF)=\operatorname{Tr}(F^{\top}(I-\bar{A%
})F)
\displaystyle\operatorname{Tr}(F^{\top}LF)
\displaystyle=\operatorname{Tr}(F^{\top}(I-\bar{A})F)
\displaystyle=-\sum_{x,{x^{\prime}}}\sqrt{w_{x}}\sqrt{w_{x^{\prime}}}\bar{A}_{%
x{x^{\prime}}}f(x)^{\top}f({x^{\prime}})+\sum_{x}w_{x}f(x)^{\top}f(x)
\displaystyle=-\sum_{x,{x^{\prime}}}\sqrt{w_{x}}\sqrt{w_{x^{\prime}}}\bar{A}_{%
x{x^{\prime}}}f(x)^{\top}f({x^{\prime}})+\sum_{x}w_{x}f(x)^{\top}f(x)
\displaystyle=-\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}f(x)^{\top}f(x^{%
\prime})+\sum_{x}\sum_{x^{\prime}}A_{x{x^{\prime}}}f(x)^{\top}f(x)
\displaystyle=-\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}f(x)^{\top}f(x^{%
\prime})+\sum_{x}\sum_{x^{\prime}}A_{x{x^{\prime}}}f(x)^{\top}f(x)
\displaystyle=-\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}f(x)^{\top}f(x^{%
\prime})+\frac{1}{2}\sum_{x}\sum_{x^{\prime}}(A_{x{x^{\prime}}}f(x)^{\top}f(x)%
+A_{{x^{\prime}}x}f(x^{\prime})^{\top}f(x^{\prime}))
\displaystyle=-\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}f(x)^{\top}f(x^{%
\prime})+\frac{1}{2}\sum_{x}\sum_{x^{\prime}}(A_{x{x^{\prime}}}f(x)^{\top}f(x)%
+A_{{x^{\prime}}x}f(x^{\prime})^{\top}f(x^{\prime}))
\displaystyle=-\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}f(x)^{\top}f(x^{%
\prime})+\frac{1}{2}\sum_{x}\sum_{x^{\prime}}(A_{x{x^{\prime}}}f(x)^{\top}f(x)%
+A_{x{x^{\prime}}}f(x^{\prime})^{\top}f(x^{\prime}))
\displaystyle=-\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}f(x)^{\top}f(x^{%
\prime})+\frac{1}{2}\sum_{x}\sum_{x^{\prime}}(A_{x{x^{\prime}}}f(x)^{\top}f(x)%
+A_{x{x^{\prime}}}f(x^{\prime})^{\top}f(x^{\prime}))
\displaystyle=\frac{1}{2}\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}\|f(x)-f(%
x^{\prime})\|^{2}
\displaystyle=\frac{1}{2}\sum_{x}\sum_{{x^{\prime}}}A_{x{x^{\prime}}}\|f(x)-f(%
x^{\prime})\|^{2}
\displaystyle=\frac{1}{2}\mathbb{E}_{x,x^{+}}\|f(x)-f(x^{+})\|^{2}
\displaystyle=\frac{1}{2}\mathbb{E}_{x,x^{+}}\|f(x)-f(x^{+})\|^{2}
\displaystyle\operatorname{LSE}(FF^{\top})-\|F\|^{2}=\operatorname{Tr}(D\log(D%
\deg(\exp(D^{-1/2}FF^{\top}D^{-1/2}))))-\|F\|^{2}
\displaystyle\operatorname{LSE}(FF^{\top})-\|F\|^{2}
\displaystyle=\operatorname{Tr}(D\log(D\deg(\exp(D^{-1/2}FF^{\top}D^{-1/2}))))%
-\|F\|^{2}
\displaystyle=\sum_{x}w_{x}\log\sum_{x^{\prime}}w_{x^{\prime}}\exp(f(x)^{\top}%
f(x^{\prime}))-\sum_{x}w_{x}\|f(x)\|^{2}
\displaystyle=\sum_{x}w_{x}\log\sum_{x^{\prime}}w_{x^{\prime}}\exp(f(x)^{\top}%
f(x^{\prime}))-\sum_{x}w_{x}\|f(x)\|^{2}
\displaystyle=\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}\exp(f(x)^{\top}f(x^{%
\prime}))-\mathbb{E}_{x}\|f(x)\|^{2}.
\displaystyle=\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}\exp(f(x)^{\top}f(x^{%
\prime}))-\mathbb{E}_{x}\|f(x)\|^{2}.
\displaystyle\mathcal{L}_{\rm nce}(\theta)=-\mathbb{E}_{x,x^{+}}[f(x)^{\top}f(%
x^{+})]+\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}[\exp(f(x)^{\top}f(x^{\prime}%
))]
\displaystyle\mathcal{L}_{\rm nce}(\theta)
\displaystyle=-\mathbb{E}_{x,x^{+}}[f(x)^{\top}f(x^{+})]+\mathbb{E}_{x}\log%
\mathbb{E}_{x^{\prime}}[\exp(f(x)^{\top}f(x^{\prime}))]
\displaystyle=-\mathbb{E}_{x,x^{+}}[f(x)^{\top}f(x^{+})]+\mathbb{E}_{x}(f(x)^{%
\top}f(x))+\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}[\exp(f(x)^{\top}f(x^{%
\prime}))]-\mathbb{E}_{x}\|f(x)\|^{2}
\displaystyle=-\mathbb{E}_{x,x^{+}}[f(x)^{\top}f(x^{+})]+\mathbb{E}_{x}(f(x)^{%
\top}f(x))+\mathbb{E}_{x}\log\mathbb{E}_{x^{\prime}}[\exp(f(x)^{\top}f(x^{%
\prime}))]-\mathbb{E}_{x}\|f(x)\|^{2}
\displaystyle=\frac{1}{2}\mathbb{E}_{x,x^{+}}\|f(x)-f(x^{+})\|^{2}+\mathbb{E}_%
{x}\log\mathbb{E}_{x^{\prime}}[\exp(f(x)^{\top}f(x^{\prime}))]-\mathbb{E}_{x}%
\|f(x)\|^{2}
\displaystyle=\frac{1}{2}\mathbb{E}_{x,x^{+}}\|f(x)-f(x^{+})\|^{2}+\mathbb{E}_%
{x}\log\mathbb{E}_{x^{\prime}}[\exp(f(x)^{\top}f(x^{\prime}))]-\mathbb{E}_{x}%
\|f(x)\|^{2}
\displaystyle={\mathcal{L}}_{\rm align}(F_{\theta})+{\mathcal{L}}_{\rm unif}(F%
_{\theta}).
\displaystyle={\mathcal{L}}_{\rm align}(F_{\theta})+{\mathcal{L}}_{\rm unif}(F%
_{\theta}).
X
\Omega
d_{\Omega}(X):=\inf\{\|X-Y\|_{F}\mid Y\in\Omega\}
k
{\bar{A}}_{k}
t
F^{(t)}_{k}
{\mathcal{M}}
d_{\mathcal{M}}(F^{(t+1)}_{k})\leq|1-2\alpha\lambda_{{\mathcal{G}}_{k}}|\cdot d%
_{\mathcal{M}}(F^{(t)}_{k}),
\lambda_{{\mathcal{G}}_{k}}\in[0,2]
{\mathcal{G}}
\mathcal{M}=\{e_{1}\otimes y|y\in\mathbb{R}^{c}\}
e_{1}
{\bar{A}}_{k}
Q_{k}=(1-2\alpha)I+2\alpha\bar{A}_{k}
F_{k}^{(t+1)}=Q_{k}F_{k}^{(t)}
\bar{A}_{k}
\bar{A}_{k}
1=\lambda_{1}\geq\dots\geq\lambda_{n}\geq-1
Q_{k}
q_{i}=1-2\alpha+2\alpha\lambda_{i},i=1,2,\dots,N
q_{1}=1
Q_{k}
[e_{1},\dots,e_{n}]
Q_{k}
F_{k}^{(t)}
F_{k}^{(t)}=\sum_{i=1}^{n}e_{i}\otimes h_{i},h_{i}\in\mathbb{R}^{m}.
F_{k}^{(t)}
\mathcal{M}=\{e_{1}\otimes y|y\in\mathbb{R}^{c}\}
i.e.
e_{1}\otimes h_{1}
e_{1}
i.e.
\sum_{i=2}^{n}e_{i}\otimes h_{i}
d^{2}_{\mathcal{M}}(F_{k}^{(t)})=\left\|\sum_{i=2}^{n}e_{i}\otimes h_{i},h_{i}%
\in\mathbb{R}^{m}\right\|_{F}^{2}=\sum_{i=2}^{n}\|h_{i}\|_{2}^{2}.
Qe_{i}=q_{i}e_{i}
QF_{k}^{(t)}=e_{1}\otimes h_{1}+\sum_{i=2}^{n}e_{i}\otimes(q_{i}h_{i}).
\mathcal{M}
e_{1}\otimes h_{1}
d^{2}_{\mathcal{M}}(QF_{k}^{(t)})=\left\|\sum_{i=2}^{n}e_{i}\otimes(q_{i}h_{i}%
)\right\|_{F}^{2}=\sum_{i=2}^{n}\|q_{i}h_{i}\|_{2}^{2}.
d^{2}_{\mathcal{M}}(F_{k}^{(t+1)})=d^{2}_{\mathcal{M}}(QF_{k}^{(t)})=\sum_{i=2%
}^{n}\|q_{i}h_{i}\|_{2}^{2}\leq\sum_{i=2}^{n}q_{2}^{2}\|h_{i}\|_{2}^{2}=q_{2}^%
{2}d^{2}_{\mathcal{M}}(F_{k}^{(t)}).
1-\lambda_{2}
{\mathcal{G}}
q_{2}=1-2\alpha+2\lambda_{2}
d^{2}_{\mathcal{M}}(F_{k}^{(t+1)})\leq(1-2\alpha\lambda_{\mathcal{G}}^{in})^{2%
}d^{2}_{\mathcal{M}}(F_{k}^{(t)})\leq d^{2}_{\mathcal{M}}(F_{k}^{(t)}),
d_{\mathcal{M}}(F_{k}^{(t+1)})\leq|(1-2\alpha\lambda_{\mathcal{G}}^{in})|\cdot
d%
_{\mathcal{M}}(F_{k}^{(t)})\leq d_{\mathcal{M}}(F_{k}^{(t)}),
{\bar{A}}={\bar{A}}^{\prime}_{\rm nce}
\forall\ x,x^{+}\in{\mathcal{X}},~{}~{}{\mathcal{P}}_{d}(x^{+}|x)={\mathcal{P}%
}_{\theta}(x^{+}|x)\triangleq\frac{\exp(f_{\theta}(x)^{\top}f_{\theta}(x^{+}))%
}{\sum_{x^{\prime}}\exp(f_{\theta}(x)^{\top}f_{\theta}(x^{\prime}))}.
{\mathcal{P}}_{d}(x^{+}|x)
{\mathcal{P}}_{\theta}(x^{+}|x)
F^{(t+1)}={F^{(t)}-\alpha\nabla_{F^{(t)}}{\mathcal{L}}_{\rm nce}(F^{(t)})}=F^{%
(t)}+2\alpha({\bar{A}}-{\bar{A}}^{\prime}_{\rm nce})F^{(t)}.
{\bar{A}}={\bar{A}}^{\prime}_{\rm nce}
F^{(t+1)}=F^{(t)}
{\bar{A}}_{x,x^{\prime}}=\left({\bar{A}}_{\rm nce}\right)_{x,x^{\prime}}=\frac%
{\exp(f(x)^{\top}f(x^{\prime}))}{\sum_{k}\exp(f(x)^{\top}f(x_{k}))},
k
k
k
