\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\sim
\sim
\sim
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\sim
\sim
\sim
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
x
2^{p}
p
x
2^{p}x=\left\{\begin{array}[]{ll}x<<p&{if}~{}~{}p>0\\
x>>p&{if}~{}~{}p<0\\
x&{if}~{}~{}p=0\end{array}\right.
2^{p}
s\in\{-1,0,+1\}
flip(x,s)=\left\{\begin{array}[]{ll}-x&{if}~{}~{}s=-1\\
0&{if}~{}~{}s=0\\
x&{if}~{}~{}s=+1\end{array}\right.
W
W=flip(2^{P},S)
P
S
N
\{x_{i}\}_{i=1}^{N}
j
x_{j}
x_{i}
(i,j)
(i,j)
\displaystyle{\overline{o}}^{(i,j)}(x)=\sum\limits_{o\in\mathcal{O}}\alpha_{o}%
^{(i,j)}o^{(i,j)}(x_{i}),
\displaystyle{\overline{o}}^{(i,j)}(x)=\sum\limits_{o\in\mathcal{O}}\alpha_{o}%
^{(i,j)}o^{(i,j)}(x_{i}),
\displaystyle\alpha_{o}^{(i,j)}=\frac{exp({\alpha^{\prime}}_{o}^{(i,j)})}{\sum%
\limits_{o^{\prime}\in\mathcal{O}}exp({\alpha^{\prime}}_{o^{\prime}}^{(i,j)})}
\displaystyle\alpha_{o}^{(i,j)}=\frac{exp({\alpha^{\prime}}_{o}^{(i,j)})}{\sum%
\limits_{o^{\prime}\in\mathcal{O}}exp({\alpha^{\prime}}_{o^{\prime}}^{(i,j)})}
o\in\mathcal{O}
\mathcal{O}
\alpha_{o}^{(i,j)}
(i,j)
x_{j}
x_{i}
x_{j}=\sum_{i<j}\overline{o}^{(i,j)}(x_{i})
\mathcal{L}_{train}
\mathcal{L}_{val}
\alpha
w
\displaystyle\mathop{min}\limits_{\alpha}~{}~{}\mathcal{L}_{val}(w^{*}(\alpha)%
,\alpha),
\displaystyle\mathop{min}\limits_{\alpha}~{}~{}\mathcal{L}_{val}(w^{*}(\alpha)%
,\alpha),
\displaystyle s.t.~{}~{}w^{*}(\alpha)=arg\mathop{min}\limits_{w}(\mathcal{L}_{%
train}(w,\alpha))
\displaystyle s.t.~{}~{}w^{*}(\alpha)=arg\mathop{min}\limits_{w}(\mathcal{L}_{%
train}(w,\alpha))
\alpha
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathcal{O}
3\times 3
5\times 5
3\times 3
5\times 5
3\times 3
3\times 3
\mathcal{O}_{c}
\mathcal{O}_{t}
\mathcal{O}=\{\mathcal{O}_{c},\mathcal{O}_{t}\}
\mathcal{O}_{c}
\mathcal{O}_{t}
P
S
w
\mathcal{O}_{c}
(P,S)
\displaystyle\overline{P}=round(P)
\displaystyle\overline{P}=round(P)
\displaystyle\overline{S}=sign(round(S))
\displaystyle\overline{S}=sign(round(S))
\displaystyle w=flip(2^{\overline{P}},\overline{S})
\displaystyle w=flip(2^{\overline{P}},\overline{S})
\overline{P}
\overline{S}
sign(s)=\left\{\begin{array}[]{ll}-1&{if}~{}~{}s\leq-0.5\\
0&{if}~{}~{}-0.5<s<0.5\\
+1&{if}~{}~{}s\geq 0.5\end{array}\right.
w=flip(2^{\overline{P}},\overline{S})
\mathcal{O}_{c}
Y=w*X=flip(2^{\overline{P}},\overline{S})*X+b
(X,Y)
b
\displaystyle\frac{\partial\mathcal{L}}{\partial X}=\frac{\partial\mathcal{L}}%
{\partial Y}\frac{\partial Y}{\partial X}=\frac{\partial\mathcal{L}}{\partial Y%
}w^{T}
\displaystyle\frac{\partial\mathcal{L}}{\partial X}=\frac{\partial\mathcal{L}}%
{\partial Y}\frac{\partial Y}{\partial X}=\frac{\partial\mathcal{L}}{\partial Y%
}w^{T}
\displaystyle\frac{\partial\mathcal{L}}{\partial P}=\frac{\partial\mathcal{L}}%
{\partial Y}\frac{\partial Y}{\partial w}\frac{\partial w}{\partial\overline{P%
}}\frac{\partial\overline{P}}{\partial P}
\displaystyle\frac{\partial\mathcal{L}}{\partial P}=\frac{\partial\mathcal{L}}%
{\partial Y}\frac{\partial Y}{\partial w}\frac{\partial w}{\partial\overline{P%
}}\frac{\partial\overline{P}}{\partial P}
\displaystyle\frac{\partial\mathcal{L}}{\partial S}=\frac{\partial\mathcal{L}}%
{\partial Y}\frac{\partial Y}{\partial w}\frac{\partial w}{\partial\overline{S%
}}\frac{\partial\overline{S}}{\partial S}
\displaystyle\frac{\partial\mathcal{L}}{\partial S}=\frac{\partial\mathcal{L}}%
{\partial Y}\frac{\partial Y}{\partial w}\frac{\partial w}{\partial\overline{S%
}}\frac{\partial\overline{S}}{\partial S}
\displaystyle\frac{\partial\mathcal{L}}{\partial b}=\frac{\partial\mathcal{L}}%
{\partial Y}
\displaystyle\frac{\partial\mathcal{L}}{\partial b}=\frac{\partial\mathcal{L}}%
{\partial Y}
\mathcal{L}
\frac{\partial{round}(x)}{\partial x}\approx 1
\frac{\partial sign(x)}{\partial x}\approx 1
\frac{\partial{flip}(x,s)}{\partial x}\approx flip(x,s)
\frac{\partial flip(x,s)}{\partial s}\approx 1
\frac{\partial\overline{P}}{\partial P}\approx 1
\frac{\partial\overline{S}}{\partial S}\approx 1
\displaystyle\frac{\partial w}{\partial\overline{S}}=\frac{\partial flip(2^{%
\overline{P}},\overline{S})}{\partial\overline{S}}\approx 1
\displaystyle\frac{\partial w}{\partial\overline{S}}=\frac{\partial flip(2^{%
\overline{P}},\overline{S})}{\partial\overline{S}}\approx 1
\displaystyle\frac{\partial w}{\partial\overline{P}}=\frac{\partial flip(2^{%
\overline{P}},\overline{S})}{\partial\overline{P}}=\frac{\partial flip(2^{%
\overline{P}},\overline{S})}{\partial 2^{\overline{P}}}\frac{\partial 2^{%
\overline{P}}}{\partial\overline{P}}
\displaystyle\frac{\partial w}{\partial\overline{P}}=\frac{\partial flip(2^{%
\overline{P}},\overline{S})}{\partial\overline{P}}=\frac{\partial flip(2^{%
\overline{P}},\overline{S})}{\partial 2^{\overline{P}}}\frac{\partial 2^{%
\overline{P}}}{\partial\overline{P}}
\displaystyle~{}~{}~{}~{}~{}~{}\approx flip(2^{\overline{P}},\overline{S})2^{%
\overline{P}}ln2=w2^{\overline{P}}ln2
\displaystyle~{}~{}~{}~{}~{}~{}\approx flip(2^{\overline{P}},\overline{S})2^{%
\overline{P}}ln2=w2^{\overline{P}}ln2
(P,S)
\mathcal{L}
\displaystyle\frac{\partial\mathcal{L}}{\partial P}\approx\frac{\partial%
\mathcal{L}}{\partial Y}\frac{\partial Y}{\partial w}w2^{\overline{P}}ln2
\displaystyle\frac{\partial\mathcal{L}}{\partial P}\approx\frac{\partial%
\mathcal{L}}{\partial Y}\frac{\partial Y}{\partial w}w2^{\overline{P}}ln2
\displaystyle\frac{\partial\mathcal{L}}{\partial S}\approx\frac{\partial%
\mathcal{L}}{\partial Y}\frac{\partial Y}{\partial w}
\displaystyle\frac{\partial\mathcal{L}}{\partial S}\approx\frac{\partial%
\mathcal{L}}{\partial Y}\frac{\partial Y}{\partial w}
\mathcal{O}_{t}
\mathcal{O}_{c}
\mathcal{O}
\mathcal{O}=\{\mathcal{O}_{t},\mathcal{O}_{c}\}
w
\alpha
\alpha
\displaystyle o_{t}^{(i,j)}=arg\mathop{max}\limits_{o_{t}\in\mathcal{O}_{t}}%
\alpha_{o_{t}}^{(i,j)}
\displaystyle o_{t}^{(i,j)}=arg\mathop{max}\limits_{o_{t}\in\mathcal{O}_{t}}%
\alpha_{o_{t}}^{(i,j)}
\displaystyle o_{c}^{(i,j)}=arg\mathop{max}\limits_{o_{c}\in\mathcal{O}_{c}}%
\alpha_{o_{c}}^{(i,j)}
\displaystyle o_{c}^{(i,j)}=arg\mathop{max}\limits_{o_{c}\in\mathcal{O}_{c}}%
\alpha_{o_{c}}^{(i,j)}
\mathcal{O}_{N}=\{o_{t}^{(i,j)},o_{c}^{(i,j)}\}
(i,j)
\mathcal{E}_{x_{j}}
x_{j}
\mathcal{E}_{x_{j}}=\{\langle(i_{1},j),(i_{2},j)\rangle|0<i_{1}<i_{2}<j\}
C_{n}^{2}=\frac{n!}{2!(n-2)!}
n
x_{j}
\mathcal{E}_{x_{j}}
\beta_{x_{j}}^{c}=\frac{exp({\beta^{\prime}}_{x_{j}}^{c}/T_{\beta})}{\sum%
\limits_{c^{\prime}\in\mathcal{E}_{x_{j}}}exp({\beta^{\prime}}_{x_{j}}^{c^{%
\prime}}/T_{\beta}))}
\beta_{x_{j}}^{c}
c\in\mathcal{E}_{x_{j}}
T_{\beta}(t)=T_{0}\theta^{t}
\gamma^{(i,j)}
(i,j)
\gamma^{(i,j)}=\sum\limits_{c\in\mathcal{E}_{x_{j}},(i,j)\in c}\frac{1}{N(c)}%
\beta_{x_{j}}^{c}
N(c)
c
x_{j}
\gamma^{(i,j)}
x_{j}=\sum\limits_{i<j}\gamma^{(i,j)}{\overline{o}}^{(i,j)}(x_{i})
{\overline{o}}^{(i,j)}(x_{i})
(i,j)
\mathcal{O}_{N}
(w,\alpha,\beta)
c
\beta
\alpha
w
\alpha
\beta
w
w
P
S
w\leftarrow\{P,S\}
P
\sum W^{2}=\sum(2^{P}S)^{2}
\sum(P^{2}+S^{2})
|2^{P}|<1
P
P
P^{2}
\mathcal{L}^{\prime}
\mathcal{L}^{\prime}=\mathcal{L}+\frac{\lambda}{2}\sum(2^{P}S)^{2}
\mathcal{L}
\lambda
\alpha
\beta
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\dagger
\pm
\pm
\dagger
\dagger
\mathtt{ShiftNAS}
P
[2^{-15},1]
S
\mathtt{ShiftNAS}
e
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\sim
\sim
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\times
\mathtt{ShiftNAS}
\sim
\times
\times
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\times
\times
\times
\times
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathbb{D}_{T}
\mathbb{D}_{V}
w
\alpha
\beta
T_{0}
w
\alpha
\beta
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
\mathtt{ShiftNAS}
