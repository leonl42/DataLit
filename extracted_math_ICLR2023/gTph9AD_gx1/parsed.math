\tilde{s}_{t+1}
\hat{R}_{t}
r_{g}
\tilde{s}_{t+1}
s_{t+1}
Q_{e}
r_{e}
Q_{g}
r_{g}
\tilde{s}_{t+1}
\hat{R}_{t}
r_{g}
\tilde{s}_{t+1}
s_{t+1}
Q_{e}
r_{e}
Q_{g}
r_{g}
Q_{e}
e
g
\pi
Q_{e}
\min_{Q_{e}}\mathbb{E}_{\mathcal{D}_{\mathrm{online}}}\|Q_{e}(s_{t},a_{t})-Q_{%
e,t}^{\rm target}\|_{2}^{2}
\mathcal{D}_{\mathrm{online}}\triangleq\{(s_{t},a_{t},r_{e,t},s_{t+1})\}
s_{t}
a_{t}
r_{e,t}
s_{t+1}
Q_{e,t}^{\rm target}
Q_{e,t}^{\rm target}=r_{e,t}+\gamma\mathbb{E}_{\pi}\left[Q_{e}(s_{t+1},a_{t+1}%
)-\alpha\log\pi(a_{t+1}|s_{t+1})\right]
\gamma
\alpha
\min_{\pi}\mathbb{E}_{s_{t}\sim\mathcal{D}_{\mathrm{online}},a_{t}\sim\pi}%
\left[\alpha\log(\pi(a_{t}|s_{t}))-Q_{e}(s_{t},a_{t})\right]
a_{t}
K
s_{t-k:t}
a_{t-k:t-1}
\hat{R}_{t-k:t}
\hat{R}_{t}=\sum_{t^{\prime}=t}^{T}r_{t^{\prime}}
s_{0}
\hat{R}_{0}
a_{t}
r_{t}
s_{t+1}
\hat{R}_{t+1}=\hat{R}_{t}-r_{t}
a_{t}
\hat{R}_{t+1}
s_{t+1}
\hat{R}_{0}
\mathcal{D}=\{\tau_{1},\tau_{2},...,\tau_{N}\}
\tau
\tau=(s_{0},r_{0},s_{1},r_{1},...,s_{T},r_{T})
T
K
2K
\text{Embed}_{s}
\text{Embed}_{R}
t
\text{Embed}_{t}
\text{Pred}_{s}
s_{t+1}
\Delta s_{t+1}=s_{t+1}-s_{t}
s_{t}
s_{t+1}
K
\tau=(s_{t-K+1},\hat{R}_{t-K+1},...,s_{t},\hat{R}_{t})
s
\hat{R}
t
f_{t}
\text{Embed}_{t}(t)
f_{s},~{}f_{\hat{R}}
\text{Embed}_{s}(s)+f_{t},~{}\text{Embed}_{R}(\hat{R})+f_{t}
s_{0},\hat{R}_{0},s_{1},\hat{R}_{1},...
f_{output}
f_{s}
f_{\hat{R}}
\Delta s
\text{Pred}_{s}
f_{output}
\Delta s
r_{g,t}
\widetilde{s}_{t+1}
s_{t+1}\sim\mathrm{P}(\cdot|s_{t},a_{t})
r_{g,t}=-\|\frac{1}{\sigma_{\mathcal{D}}}\odot(\widetilde{s}_{t+1}-s_{t+1})\|_%
{2}
\sigma_{\mathcal{D}}
{\mathcal{D}}
s_{1:t}
\hat{R}_{1:t}
\pi
\sigma_{s}
env
K
\widetilde{s}_{t+1}
s_{t-K+1:t}
\hat{R}_{t-K+1,t}
a_{t}
\pi(s_{t})
s_{t+1}
r_{e}
env
a_{t}
r_{g}
-\|\frac{1}{\sigma_{s}}\odot(\widetilde{s}_{t+1}-s_{t+1})\|_{2}
\hat{R}_{t+1}
\hat{R}_{t}
r_{e}
t=t+1
r_{g}
r_{t}=r_{e,t}+\beta r_{g,t}
\beta
Q
t+1
a_{t}
t
t
\tilde{s}_{t}
a_{t-1}
\tilde{s}_{t+1}
r_{g,t}
a_{t}
r_{g,t+1}
\tilde{s}_{t}
Q_{g}
Q_{e}
r_{g,t}
Q_{g,t}^{\rm target}=r_{g,t}
\gamma
Q_{e}
Q(s_{t},a_{t})=Q_{e}(s_{t},a_{t})+\beta Q_{g}(s_{t},a_{t})
\beta
\beta=0
r_{e}
Q_{e}
r_{g}
r_{g}
K
\hat{R}
\hat{R}
\beta
r_{g}
r_{g}
r_{g}
\sim
\sim
\sim
\sim
\sim
\sim
