\Phi(X)
\mathcal{A}
{\bm{\mathsfit{A}}}
\mathbb{R}
i,j\in\mathbb{N}
{\mathsfit{A}}_{ij}
{\bm{v}}
{\bm{M}}
{\bm{\mathsfit{B}}}\in\mathbb{R}^{I_{1}\times I_{2}\times I_{3}}
I_{1}\times I_{2}\times I_{3}
{\bm{\mathsfit{C}}}\in\mathbb{R}^{I_{1}\times\cdots\times I_{j}}
j
{\bm{\mathsfit{D}}}\in\mathbb{R}^{I_{j+1},\times\cdots\times I_{j+k}}
k
\otimes
{\mathsfit{E}}_{i_{1}\cdots i_{j+k}}={\mathsfit{C}}_{i_{1}...i_{j}}\cdot{%
\mathsfit{D}}_{i_{j+1}\cdots i_{j+k}}
j+k
j=k=1
{\bm{\mathsfit{X}}},{\bm{\mathsfit{Y}}}\in\mathbb{R}^{I_{1}\times I_{2}\times%
\cdots\times I_{N}}
\langle{\bm{\mathsfit{X}}},{\bm{\mathsfit{Y}}}\rangle=\sum_{i_{1}=1}^{I_{1}}%
\sum_{i_{2}=1}^{I_{2}}\cdots\sum_{i_{N}=1}^{I_{N}}{\mathsfit{X}}_{i_{1},i_{2},%
...,i_{N}}{\mathsfit{Y}}_{i_{1},i_{2},...,i_{N}}
{\bm{\mathsfit{X}}}\in\mathbb{R}^{I_{1}\times I_{2}\times\cdots\times I_{N}%
\times I_{x}}
{\bm{\mathsfit{Y}}}\in\mathbb{R}^{I_{1}\times I_{2}\times\cdots I_{N}\times I_%
{y}}
N
\displaystyle\langle{\bm{\mathsfit{X}}},{\bm{\mathsfit{Y}}}\rangle_{N}=\sum_{i%
_{1}=1}^{I_{1}}\sum_{i_{2}=1}^{I_{2}}\cdot\cdot\cdot\sum_{i_{N}=1}^{I_{N}}{%
\mathsfit{X}}_{i_{1},i_{2},...,i_{N}}{\mathsfit{Y}}_{i_{1},i_{2},...,i_{N}}
\displaystyle\langle{\bm{\mathsfit{X}}},{\bm{\mathsfit{Y}}}\rangle_{N}=\sum_{i%
_{1}=1}^{I_{1}}\sum_{i_{2}=1}^{I_{2}}\cdot\cdot\cdot\sum_{i_{N}=1}^{I_{N}}{%
\mathsfit{X}}_{i_{1},i_{2},...,i_{N}}{\mathsfit{Y}}_{i_{1},i_{2},...,i_{N}}
\langle{\bm{\mathsfit{X}}},{\bm{\mathsfit{Y}}}\rangle_{N}\in\mathbb{R}^{I_{x}%
\times I_{y}}
N
X=[x^{(1)},x^{(2)},\cdots,x^{(N)}]
{\bm{f}}_{i}\in\mathbb{R}^{I_{i}}
X
\begin{split}\Phi(X)&={\bm{f}}_{1}(x^{(1)})\otimes{\bm{f}}_{2}(x^{(2)})\cdots%
\otimes{\bm{f}}_{N}(x^{(N)})\\
&=\bigotimes^{N}_{i=1}{\bm{f}}_{i}(x^{(i)})\\
\end{split}
\mathbb{R}^{I_{1}}\otimes\mathbb{R}^{I_{2}}\otimes\cdots\otimes\mathbb{R}^{I_{%
N}}
{\bm{f}}_{i}
{\bm{f}}(x^{(t)})\in\mathbb{R}^{|V|}
\Phi(X)
|V|^{N}
X
X
\displaystyle p(X)=\langle\mathcal{A},\Phi(X)\rangle
\displaystyle p(X)
\displaystyle=\langle\mathcal{A},\Phi(X)\rangle
\displaystyle=\sum_{i_{1},i_{2},\cdots,i_{N}=1}^{|V|}\mathcal{A}_{i_{1},\cdots%
,i_{N}}\cdot\Phi(X)_{i_{1},\cdots,i_{N}}
\displaystyle=\sum_{i_{1},i_{2},\cdots,i_{N}=1}^{|V|}\mathcal{A}_{i_{1},\cdots%
,i_{N}}\cdot\Phi(X)_{i_{1},\cdots,i_{N}}
\langle\cdot\rangle
\mathcal{A}
\Phi(X)
\mathbb{V}^{\otimes N}=\underbrace{\mathbb{V}\otimes\cdots\otimes\mathbb{V}}_{N}
\mathbb{V}
\mathbb{R}^{|V|}
X
w_{1},w_{2},\cdots,w_{N}
w_{i}\in\{1,2,\cdots,|V|\}
\mathcal{A}
\mathcal{A}_{w_{1}w_{2}\cdots w_{N}}
\mathcal{A}_{w_{1}w_{2}\cdots w_{N}}
\displaystyle\mathcal{A}_{w_{1}w_{2}...w_{N}}=\underbrace{{\bm{\mathsfit{G}}}^%
{(1)}_{:,w_{1}}}_{1\times R_{1}}\underbrace{{\bm{\mathsfit{G}}}^{(2)}_{:,w_{2}%
,:}}_{R_{1}\times R_{2}}\cdots\underbrace{{\bm{\mathsfit{G}}}^{(N)}_{:,w_{N}}}%
_{R_{N-1}\times 1}
\displaystyle\mathcal{A}_{w_{1}w_{2}...w_{N}}
\displaystyle=\underbrace{{\bm{\mathsfit{G}}}^{(1)}_{:,w_{1}}}_{1\times R_{1}}%
\underbrace{{\bm{\mathsfit{G}}}^{(2)}_{:,w_{2},:}}_{R_{1}\times R_{2}}\cdots%
\underbrace{{\bm{\mathsfit{G}}}^{(N)}_{:,w_{N}}}_{R_{N-1}\times 1}
\displaystyle=\sum_{\alpha_{1},\cdots,\alpha_{N-1}}{\mathsfit{G}}^{(1)}_{w_{1}%
\alpha_{1}}{\mathsfit{G}}^{(2)}_{\alpha_{1}w_{2}\alpha_{2}}\cdots{\mathsfit{G}%
}^{(N)}_{\alpha_{N-1}w_{N}}
\displaystyle=\sum_{\alpha_{1},\cdots,\alpha_{N-1}}{\mathsfit{G}}^{(1)}_{w_{1}%
\alpha_{1}}{\mathsfit{G}}^{(2)}_{\alpha_{1}w_{2}\alpha_{2}}\cdots{\mathsfit{G}%
}^{(N)}_{\alpha_{N-1}w_{N}}
{\bm{\mathsfit{G}}}^{(t)}\in\mathbb{R}^{R_{t-1}\times|V|\times R_{t}}
t=1,...,d
R_{0}=R_{N}=1
R_{k}
k=1,\cdots,N
{\bm{\mathsfit{G}}}^{(t)}
R_{t}
{\bm{\mathsfit{G}}}={\bm{\mathsfit{G}}}^{(2)},\ldots,{\bm{\mathsfit{G}}}^{(N-1%
)}\in\mathbb{R}^{R\times|V|\times R}
{\bm{\mathsfit{G}}}^{(1)}={\bm{\mathsfit{G}}}^{(N)}\in\mathbb{R}^{|V|\times R}
\mathcal{A},\Phi(X)
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{W}}}^{eh}
\mathcal{A},\Phi(X)
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{W}}}^{eh}
\begin{split}p(X)=\sum_{i_{1},\cdots,i_{N}=1}^{|V|}\sum_{\alpha_{1},\cdots,%
\alpha_{N-1}=1}^{R}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}_{i_{1}\alpha_{1}}%
\cdots\\
f(x^{(N)})_{i_{N}}{\mathsfit{G}}^{(N)}_{\alpha_{N-1}i_{N}}\end{split}
{\bm{f}}(x^{(t)})
w_{t}=1
t
\mathcal{A}
{\bm{\mathsfit{G}}}^{(t)}_{:,w_{t},:}
\displaystyle{\mathsfit{G}}^{(t)}_{\alpha_{t-1}w_{t}\alpha_{t}}=\sum_{{i=1}}^{%
|V|}f(x^{(t)})_{i}{\mathsfit{G}}^{(t)}_{\alpha_{t-1}i\alpha_{t}}
\displaystyle{\mathsfit{G}}^{(t)}_{\alpha_{t-1}w_{t}\alpha_{t}}
\displaystyle=\sum_{{i=1}}^{|V|}f(x^{(t)})_{i}{\mathsfit{G}}^{(t)}_{\alpha_{t-%
1}i\alpha_{t}}
\mathcal{A}_{w_{1}w_{2}...w_{N}}
p(X)
\mathcal{A}
\Phi(X)
{\bm{\mathsfit{G}}}
{\bm{f}}(x^{(t)})
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}:\mathbb{R}^{|V|}\times\mathbb{R}^{R}\rightarrow\mathbb{R}^%
{R}
{\bm{h}}^{(t)}_{\text{TTLM}}
\displaystyle{\bm{h}}^{(t)}_{\textrm{TTLM}}={\bm{f}}(x^{(t)})^{T}{\bm{%
\mathsfit{G}}}{\bm{h}}^{(t-1)}_{\textrm{TTLM}}
\displaystyle{\bm{h}}^{(t)}_{\textrm{TTLM}}
\displaystyle={\bm{f}}(x^{(t)})^{T}{\bm{\mathsfit{G}}}{\bm{h}}^{(t-1)}_{%
\textrm{TTLM}}
{\bm{f}}(x^{(t)})
{\bm{\mathsfit{G}}}
{\bm{h}}^{(t-1)}_{\textrm{TTLM}}
{\bm{\mathsfit{G}}}
\mathbb{R}^{R\times|V|\times R}
\mathbb{R}^{|V|\times R\times R}
p(X)
p(X)
\displaystyle p(X)=\prod_{t=1}^{N}p(x^{(t)}|x^{(1:t-1)})
\displaystyle p(X)=\prod_{t=1}^{N}p(x^{(t)}|x^{(1:t-1)})
x^{(1:t-1)}
[x^{(1)},x^{(2)},\cdots,x^{(t-1)}]
t
{\bm{y}}^{(t)}\in\mathbb{V}
x^{(t)}
x^{(1:t-1)}
{\bm{y}}^{(t)}
\displaystyle{\bm{y}}^{(t)}=\psi\left({\bm{\mathsfit{G}}}^{(t)}{\bm{h}}^{(t-1)%
}_{\textrm{TTLM}}\right)
\displaystyle{\bm{y}}^{(t)}=\psi\left({\bm{\mathsfit{G}}}^{(t)}{\bm{h}}^{(t-1)%
}_{\textrm{TTLM}}\right)
{\bm{\mathsfit{G}}}^{(t)}\in\mathbb{R}^{|V|\times R}
t
\psi
{\bm{y}}^{(t)}
1
\psi
\psi
\mathrm{softmax}
x^{(1:3)}
{\bm{y}}^{(4)}=\psi({\bm{\mathsfit{G}}}^{(4)}{\bm{h}}_{\textrm{TTLM}}^{(3)})
{\bm{y}}^{(4)}
x^{(4)}
x^{(1:3)}
{\bm{y}}^{(4)}=\psi({\bm{\mathsfit{G}}}^{(4)}{\bm{h}}_{\textrm{TTLM}}^{(3)})
{\bm{y}}^{(4)}
x^{(4)}
{\bm{y}}^{(t)}
{\bm{h}}^{(t-1)}_{\textrm{TTLM}}
\displaystyle\small{\bm{y}}^{(t)}=\psi\left(\sum_{i_{1},\cdots,i_{t-1}}\sum_{%
\alpha_{1},\cdots,\alpha_{t-1}}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}_{i_{1}%
\alpha_{1}}\cdots{\bm{\mathsfit{G}}}^{(t)}_{\alpha_{t-1}}\right)
\displaystyle\small{\bm{y}}^{(t)}
\displaystyle=\psi\left(\sum_{i_{1},\cdots,i_{t-1}}\sum_{\alpha_{1},\cdots,%
\alpha_{t-1}}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}_{i_{1}\alpha_{1}}\cdots{%
\bm{\mathsfit{G}}}^{(t)}_{\alpha_{t-1}}\right)
\displaystyle=\psi\left(\langle\mathcal{A}^{(1:t)},\Phi(X^{(1:t-1)})\rangle_{t%
-1}\right)
\displaystyle=\psi\left(\langle\mathcal{A}^{(1:t)},\Phi(X^{(1:t-1)})\rangle_{t%
-1}\right)
\mathcal{A}^{(1:t)}\in\mathbb{V}^{\otimes t}
\Phi(X^{(1:t-1)})=\bigotimes\limits^{t-1}_{i=1}{\bm{f}}(x^{(i)})\in\mathbb{V}^%
{\otimes t-1}
\langle\cdot\rangle_{t-1}
{\bm{\mathsfit{G}}}^{(t)}
{\bm{\mathsfit{G}}}^{(1)}
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}^{(t)}
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}
\begin{split}&{\bm{h}}^{(t)}_{\textrm{Tiny}}={\bm{f}}(x^{(t)})^{T}{\bm{%
\mathsfit{W}}}^{xe}\bm{\delta}{\bm{W}}^{hh}{\bm{h}}^{(t-1)}_{\textrm{Tiny}}\\
&{\bm{h}}^{(t)}_{\textrm{Large}}={\bm{f}}(x^{(t)})^{T}{\bm{\mathsfit{W}}}^{xe}%
{\bm{\mathsfit{W}}}^{eh}\bm{\delta}{\bm{W}}^{hh}{\bm{h}}^{(t-1)}_{\textrm{%
Large}}\\
\end{split}
{\bm{W}}^{hh}\in\mathbb{R}^{R\times R}
{\bm{\mathsfit{W}}}^{xe}\in\mathbb{R}^{|V|\times R\times R}
{\bm{\mathsfit{W}}}^{eh}\in\mathbb{R}^{R\times R\times R\times R}
\bm{\delta}\in\mathbb{R}^{R\times R\times R\times R}
\delta_{ijkl}=1
i=j=k=l
\delta_{ijkl}=0
{\bm{\mathsfit{W}}}^{xe}
{\bm{\mathsfit{G}}}^{(t)}
{\bm{\mathsfit{G}}}={\bm{\mathsfit{W}}}^{xe}\bm{\delta}{\bm{W}}^{hh}
{\bm{\mathsfit{G}}}={\bm{\mathsfit{W}}}^{xe}{\bm{\mathsfit{W}}}^{eh}\bm{\delta%
}{\bm{W}}^{hh}
{\bm{y}}^{(t)}=\psi({\bm{\mathsfit{V}}}{\bm{\mathsfit{P}}}{\bm{h}}^{(t)})
{\bm{\mathsfit{V}}}\in\mathbb{R}^{R\times|V|\times R}
{\bm{\mathsfit{P}}}\in\mathbb{R}^{R\times R\times R}
{\bm{\mathsfit{W}}}^{xe}
{\bm{\mathsfit{V}}}
{\bm{\mathsfit{T}}}
{\bm{W}}^{hx}\odot{\bm{W}}^{hh}
{\bm{W}}^{hx}\odot{\bm{W}}^{hh}
-
-
{\bm{W}}^{xe}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{eh}\in\mathbb{R}^{E\times H}
{\bm{W}}^{hh}\in\mathbb{R}^{H\times H}
{\bm{P}}\in\mathbb{R}^{H\times E}
{\bm{V}}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{xe}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{eh}\in\mathbb{R}^{E\times H}
{\bm{W}}^{hh}\in\mathbb{R}^{H\times H}
{\bm{P}}\in\mathbb{R}^{H\times E}
{\bm{V}}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{xe}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{eh}\in\mathbb{R}^{E\times H}
{\bm{W}}^{hh}\in\mathbb{R}^{H\times H}
{\bm{P}}\in\mathbb{R}^{H\times E}
{\bm{V}}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{xe}\in\mathbb{R}^{E\times|V|}
{\bm{\mathsfit{T}}}\in\mathbb{R}^{H\times H\times H}
{\bm{W}}^{hh}\in\mathbb{R}^{E\times H}
{\bm{P}}\in\mathbb{R}^{H\times E}
{\bm{V}}\in\mathbb{R}^{E\times|V|}
{\bm{\mathsfit{G}}}\in\mathbb{R}^{R\times|V|\times R}
{\bm{G}}^{(t)}\in\mathbb{R}^{R\times|V|}
{\bm{G}}^{(1)}\in\mathbb{R}^{R\times|V|}
{\bm{\mathsfit{W}}}^{xe}\in\mathbb{R}^{R\times|V|\times R}
{\bm{W}}^{hh}\in\mathbb{R}^{R\times R}
{\bm{\mathsfit{P}}}\in\mathbb{R}^{R\times R\times R}
{\bm{\mathsfit{V}}}\in\mathbb{R}^{R\times R\times|V|}
{\bm{\mathsfit{W}}}^{xe}\in\mathbb{R}^{R\times|V|\times R}
{\bm{\mathsfit{W}}}^{eh}\in\mathbb{R}^{R\times R\times R\times R}
{\bm{W}}^{hh}\in\mathbb{R}^{R\times R}
{\bm{\mathsfit{P}}}\in\mathbb{R}^{R\times R\times R}
{\bm{\mathsfit{V}}}\in\mathbb{R}^{R\times R\times|V|}
E
H
R
H=R
E=R^{2}
{\bm{W}}^{xe}
[-0.1,0.1]
{\bm{W}}^{eh}
{\bm{W}}^{hh}
[-\frac{1}{\sqrt{H}},\frac{1}{\sqrt{H}}]
E
H
R
H=R
E=R^{2}
{\bm{W}}^{xe}
[-0.1,0.1]
{\bm{W}}^{eh}
{\bm{W}}^{hh}
[-\frac{1}{\sqrt{H}},\frac{1}{\sqrt{H}}]
{\bm{W}}^{xe}\in\mathbb{R}^{E\times|V|}
{\bm{W}}^{eh}\in\mathbb{R}^{E\times H}
{\bm{W}}^{hh}\in\mathbb{R}^{H\times H}
{\bm{W}}^{xe}
{\bm{V}}
{\bm{P}}\in\mathbb{R}^{H\times E}
{\bm{\mathsfit{W}}}^{xe}
{\bm{\mathsfit{V}}}
\delta
{\bm{\mathsfit{G}}}^{(1)}
|V|
{\bm{\mathsfit{G}}}^{(1)}
{\bm{G}}^{(1)}\in\mathbb{R}^{1\times R}
tanh
tanh
{\bm{\mathsfit{W}}}^{eh}
tanh
\tanh
\tanh
{\bm{\mathsfit{T}}}
X=[x^{(1)},x^{(2)},\cdots,x^{(N)}]
{\bm{\mathsfit{G}}}={\bm{\mathsfit{G}}}^{(2)},...,{\bm{\mathsfit{G}}}^{(N-1)}
{\bm{\mathsfit{G}}}^{(1)}={\bm{\mathsfit{G}}}^{(N)}
{\bm{y}}^{(t)}
x^{(t)}
x^{(1:t-1)})
t
{\bm{f}}(x^{(1)})
f(x^{(1)})_{1}=1
{\bm{\mathsfit{G}}}^{(1)}{\bm{f}}(x^{(1})
\displaystyle{\bm{\mathsfit{G}}}^{(1)}{\bm{f}}(x^{(1})=\left[\begin{array}[]{c%
}f\left(x^{(1)}\right)_{1}\\
f\left(x^{(1)}\right)_{2}\\
\ldots\\
f\left(x^{(1)}\right)_{|V|}\end{array}\right]\left[\begin{array}[]{cccc}{\bm{%
\mathsfit{G}}}_{11}^{(1)}&{\bm{\mathsfit{G}}}_{12}^{(1)}&\ldots&{\bm{\mathsfit%
{G}}}_{1R}^{(1)}\\
{\bm{\mathsfit{G}}}_{21}^{(1)}&{\bm{\mathsfit{G}}}_{22}^{(1)}&\ldots&{\bm{%
\mathsfit{G}}}_{2R}^{(1)}\\
\ldots&\ldots&\ldots&\ldots\\
{\bm{\mathsfit{G}}}_{|V|1}^{(1)}&{\bm{\mathsfit{G}}}_{|V|2}^{(1)}&\ldots&{\bm{%
\mathsfit{G}}}_{|V|R}^{(1)}\end{array}\right]
\displaystyle{\bm{\mathsfit{G}}}^{(1)}{\bm{f}}(x^{(1})
\displaystyle=\left[\begin{array}[]{c}f\left(x^{(1)}\right)_{1}\\
f\left(x^{(1)}\right)_{2}\\
\ldots\\
f\left(x^{(1)}\right)_{|V|}\end{array}\right]\left[\begin{array}[]{cccc}{\bm{%
\mathsfit{G}}}_{11}^{(1)}&{\bm{\mathsfit{G}}}_{12}^{(1)}&\ldots&{\bm{\mathsfit%
{G}}}_{1R}^{(1)}\\
{\bm{\mathsfit{G}}}_{21}^{(1)}&{\bm{\mathsfit{G}}}_{22}^{(1)}&\ldots&{\bm{%
\mathsfit{G}}}_{2R}^{(1)}\\
\ldots&\ldots&\ldots&\ldots\\
{\bm{\mathsfit{G}}}_{|V|1}^{(1)}&{\bm{\mathsfit{G}}}_{|V|2}^{(1)}&\ldots&{\bm{%
\mathsfit{G}}}_{|V|R}^{(1)}\end{array}\right]
\displaystyle=\left[{\bm{\mathsfit{G}}}_{11}^{(1)},{\bm{\mathsfit{G}}}_{12}^{(%
1)},\cdots,{\bm{\mathsfit{G}}}_{1R}^{(1)}\right]^{T}
\displaystyle=\left[{\bm{\mathsfit{G}}}_{11}^{(1)},{\bm{\mathsfit{G}}}_{12}^{(%
1)},\cdots,{\bm{\mathsfit{G}}}_{1R}^{(1)}\right]^{T}
\displaystyle={\bm{h}}_{\textrm{TTLM}}^{(1)}
\displaystyle={\bm{h}}_{\textrm{TTLM}}^{(1)}
{\bm{f}}(x^{(i)}){\bm{\mathsfit{G}}}{\bm{h}}^{(i-1)}_{\textrm{TTLM}}
i\in\{2,3,\cdots,t-1\}
{\bm{h}}_{\textrm{TTLM}}^{(2)}
t=2
\displaystyle{\bm{h}}_{\textrm{TTLM}}^{(2)}={\bm{f}}(x^{(2)})^{T}{\bm{%
\mathsfit{G}}}{\bm{h}}^{(1)}_{\textrm{TTLM}}
\displaystyle{\bm{h}}_{\textrm{TTLM}}^{(2)}={\bm{f}}(x^{(2)})^{T}{\bm{%
\mathsfit{G}}}{\bm{h}}^{(1)}_{\textrm{TTLM}}
{\bm{y}}^{(t)}
\displaystyle{\bm{\mathsfit{G}}}^{(t)}{\bm{h}}^{(t-1)}_{\textrm{TTLM}}=\left[%
\begin{array}[]{cccc}{\bm{\mathsfit{G}}}_{11}^{(t)}&{\bm{\mathsfit{G}}}_{12}^{%
(t)}&\ldots&{\bm{\mathsfit{G}}}_{1R}^{(t)}\\
{\bm{\mathsfit{G}}}_{21}^{(t)}&{\bm{\mathsfit{G}}}_{22}^{(t)}&\ldots&{\bm{%
\mathsfit{G}}}_{2R}^{(t)}\\
\ldots&\ldots&\ldots&\ldots\\
{\bm{\mathsfit{G}}}_{|V|1}^{(t)}&{\bm{\mathsfit{G}}}_{|V|2}^{(t)}&\ldots&{\bm{%
\mathsfit{G}}}_{|V|R}^{(t)}\end{array}\right]\left[\begin{array}[]{c}h^{(t-1)}%
_{{\textrm{TTLM}}_{1}}\\
h^{(t-1)}_{{\textrm{TTLM}}_{2}}\\
\ldots\\
h^{(t-1)}_{{\textrm{TTLM}}_{R}}\end{array}\right]
\displaystyle{\bm{\mathsfit{G}}}^{(t)}{\bm{h}}^{(t-1)}_{\textrm{TTLM}}
\displaystyle=\left[\begin{array}[]{cccc}{\bm{\mathsfit{G}}}_{11}^{(t)}&{\bm{%
\mathsfit{G}}}_{12}^{(t)}&\ldots&{\bm{\mathsfit{G}}}_{1R}^{(t)}\\
{\bm{\mathsfit{G}}}_{21}^{(t)}&{\bm{\mathsfit{G}}}_{22}^{(t)}&\ldots&{\bm{%
\mathsfit{G}}}_{2R}^{(t)}\\
\ldots&\ldots&\ldots&\ldots\\
{\bm{\mathsfit{G}}}_{|V|1}^{(t)}&{\bm{\mathsfit{G}}}_{|V|2}^{(t)}&\ldots&{\bm{%
\mathsfit{G}}}_{|V|R}^{(t)}\end{array}\right]\left[\begin{array}[]{c}h^{(t-1)}%
_{{\textrm{TTLM}}_{1}}\\
h^{(t-1)}_{{\textrm{TTLM}}_{2}}\\
\ldots\\
h^{(t-1)}_{{\textrm{TTLM}}_{R}}\end{array}\right]
\displaystyle=\left[\begin{array}[]{c}\sum_{i=1}^{R}{\bm{\mathsfit{G}}}_{1i}^{%
(t)}h^{(t-1)}_{{\textrm{TTLM}}_{1}}\\
\sum_{i=1}^{R}{\bm{\mathsfit{G}}}_{2i}^{(t)}h^{(t-1)}_{{\textrm{TTLM}}_{2}}\\
\ldots\\
\sum_{i=1}^{R}{\bm{\mathsfit{G}}}_{Ri}^{(t)}h^{(t-1)}_{{\textrm{TTLM}}_{R}}%
\end{array}\right]
\displaystyle=\left[\begin{array}[]{c}\sum_{i=1}^{R}{\bm{\mathsfit{G}}}_{1i}^{%
(t)}h^{(t-1)}_{{\textrm{TTLM}}_{1}}\\
\sum_{i=1}^{R}{\bm{\mathsfit{G}}}_{2i}^{(t)}h^{(t-1)}_{{\textrm{TTLM}}_{2}}\\
\ldots\\
\sum_{i=1}^{R}{\bm{\mathsfit{G}}}_{Ri}^{(t)}h^{(t-1)}_{{\textrm{TTLM}}_{R}}%
\end{array}\right]
{\bm{\mathsfit{G}}}^{(1)}
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}^{(t)}
{\bm{\mathsfit{G}}}^{(1)}={\bm{\mathsfit{G}}}^{(t)}
{\bm{\mathsfit{G}}}^{(1)}
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}^{(t)}
{\bm{h}}^{(t-1)}_{\textrm{TTLM}}
{\bm{W}}^{hx}\in\mathbb{R}^{R\times|V|}
{\bm{W}}^{hh}\in\mathbb{R}^{R\times R}
\phi(\cdot)
{\bm{h}}^{(t)}_{\textrm{2nd}}
{\bm{h}}^{(t)}_{\textrm{RAC}}
{\bm{h}}^{(t)}_{\textrm{MI}}
{\bm{\mathsfit{T}}}
i
{\bm{h}}^{(t)}_{\textrm{2nd}}
\small h^{(t)}_{\textrm{2nd}_{i}}=\phi({\bm{f}}(x^{(t)})^{T}{\bm{\mathsfit{T}}%
}_{i,:,:}{\bm{h}}^{(t-1)}_{\textrm{2nd}}+{\bm{b}})
{\bm{\mathsfit{T}}}_{i,:,:}\in\mathbb{R}^{M\times R}
i
{\bm{\mathsfit{T}}}\in\mathbb{R}^{M\times R\times R}
{\bm{b}}
{\bm{b}}
{\bm{b}}
0
{\bm{f}}(x^{(t)})
{\bm{\mathsfit{T}}}
\phi
\phi
\displaystyle p(X)=\sum_{{i_{=}1}}^{|V|}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}%
_{i_{1}\alpha_{1}}\cdots
\displaystyle p(X)
\displaystyle=\sum_{{i_{=}1}}^{|V|}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}_{i_{%
1}\alpha_{1}}\cdots
\displaystyle=\sum_{{i_{1},i_{2}=1}}^{|V|}\sum_{\alpha_{1}=1}^{R}f(x^{(1)})_{i%
_{1}}{\mathsfit{G}}^{(1)}_{i_{1}\alpha_{1}}f(x^{(2)})_{i_{2}}{\mathsfit{G}}_{%
\alpha_{1}i_{2}\alpha_{2}}\cdots
\displaystyle=\sum_{{i_{1},i_{2}=1}}^{|V|}\sum_{\alpha_{1}=1}^{R}f(x^{(1)})_{i%
_{1}}{\mathsfit{G}}^{(1)}_{i_{1}\alpha_{1}}f(x^{(2)})_{i_{2}}{\mathsfit{G}}_{%
\alpha_{1}i_{2}\alpha_{2}}\cdots
\displaystyle\quad\quad\vdots
\displaystyle\quad\quad\vdots
\displaystyle=\sum_{i_{1},\cdots,i_{N}=1}^{|V|}\sum_{\alpha_{1},\cdots,\alpha_%
{N-1}=1}^{R}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}_{i_{1}\alpha_{1}}f(x^{(2)})%
_{i_{2}}{\mathsfit{G}}_{\alpha_{1}i_{2}\alpha_{2}}\cdots f(x^{(N)})_{i_{N}}{%
\mathsfit{G}}^{(N)}_{\alpha_{N-1}i_{N}}
\displaystyle=\sum_{i_{1},\cdots,i_{N}=1}^{|V|}\sum_{\alpha_{1},\cdots,\alpha_%
{N-1}=1}^{R}f(x^{(1)})_{i_{1}}{\mathsfit{G}}^{(1)}_{i_{1}\alpha_{1}}f(x^{(2)})%
_{i_{2}}{\mathsfit{G}}_{\alpha_{1}i_{2}\alpha_{2}}\cdots f(x^{(N)})_{i_{N}}{%
\mathsfit{G}}^{(N)}_{\alpha_{N-1}i_{N}}
{\bm{\mathsfit{G}}}
{\bm{f}}(x^{(t)})
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}:\mathbb{R}^{|V|}\times\mathbb{R}^{R}\rightarrow\mathbb{R}^%
{R}
{\bm{h}}^{(t)}_{\text{TTLM}}
\small\begin{split}h^{(t)}_{\textrm{TTLM}_{\alpha_{t}}}&=\sum_{{i_{t}=1}}^{|V|%
}\sum_{{\alpha_{t}=1}}^{R}f(x^{(t)})_{i_{t}}{\mathsfit{G}}_{i_{t}\alpha_{t}%
\alpha_{t-1}}h^{(t-1)}_{\textrm{TTLM}_{\alpha_{t-1}}}\\
\end{split}
{\mathsfit{G}}_{\alpha_{t-1}i_{t}\alpha_{t}}
{\mathsfit{G}}_{i_{t}\alpha_{t}\alpha_{t-1}}
\small\begin{split}h^{(t)}_{\textrm{2nd}_{i}}&=\phi({\bm{f}}(x^{(t)})^{T}{\bm{%
\mathsfit{T}}}_{i,:,:}{\bm{h}}^{(t-1)}_{\textrm{2nd}})\\
&=\phi\left(\sum^{|V|}_{j=1}\sum^{R}_{k=1}f(x^{(t)})_{j}{\mathsfit{T}}_{jik}h^%
{(t-1)}_{\textrm{2nd}_{k}}\right)\\
\end{split}
j,k
i_{t},\alpha_{t}
i
{\bm{h}}^{(t)}_{2nd}
\alpha_{t}
{\bm{h}}^{(t)}_{\text{TTLM}}
{\bm{\mathsfit{T}}}
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{T}}}
{\bm{\mathsfit{G}}}
\phi
\phi
{\bm{h}}^{(t)}_{\text{TTLM}}
\odot
{\bm{h}}^{(t)}_{\textrm{RAC}}
\small{\bm{h}}^{(t)}_{\textrm{RAC}}={\bm{W}}^{hx}{\bm{f}}(x^{(t)})\odot{\bm{W}%
}^{hh}{\bm{h}}^{(t-1)}_{\textrm{RAC}}
{\bm{h}}^{(t)}_{\textrm{MI}}
\small{\bm{h}}^{(t)}_{\textrm{MI}}=\phi({\bm{W}}^{hx}{\bm{f}}(x^{(t)})\odot{%
\bm{W}}^{hh}{\bm{h}}^{(t-1)}_{\textrm{MI}})
\mathcal{A},\Phi(X)
{\bm{\mathsfit{G}}}
\mathcal{A},\Phi(X)
{\bm{\mathsfit{G}}}
{\bm{\mathsfit{G}}}={\bm{W}}^{hx}\odot{\bm{W}}^{hh}
\phi
\phi
{\bm{W}}^{hx}
{\bm{f}}(x^{(t)})
{\bm{W}}^{hh}
{\bm{h}}^{(t-1)}_{\textrm{RAC}}
\delta\in\mathbb{R}^{R\times R\times R}
\delta_{ijk}=1
i=j=k
\delta_{ijk}=0
\small\begin{split}h^{(t)}_{\textrm{RAC}_{\alpha_{t}}}&=\sum_{{i_{t}=1}}^{|V|}%
\sum_{{\alpha_{t}=1}}^{R}f(x^{(t)})_{i_{t}}W^{hx}_{i_{t}j}\mathbf{\delta}_{j%
\alpha_{t}k}W^{hh}_{k\alpha_{t-1}}h^{(t-1)}_{\textrm{RAC}_{\alpha_{t-1}}}\\
&=\sum_{{i_{t}=1}}^{|V|}\sum_{{\alpha_{t}=1}}^{R}f(x^{(t)})_{i_{t}}{\mathsfit{%
G}}_{i_{t}\alpha_{t}\alpha_{t-1}}h^{(t-1)}_{\textrm{RAC}_{\alpha_{t-1}}}\\
\end{split}
{\bm{\mathsfit{G}}}={\bm{W}}^{hx}\odot{\bm{W}}^{hh}
\phi
N
\times
\times
\leq 256
\times
\times
\times
\times
\times
\times
\surd
\surd
N
N
