p({\mathbf{x}}_{T})
q({\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})
p_{\psi}({\mathbf{x}}_{T})=\int p_{\psi}({\mathbf{x}}_{T}|{\mathbf{z}})p({%
\mathbf{z}})d{\mathbf{z}}
p({\mathbf{x}}_{T})
q({\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})
p_{\psi}({\mathbf{x}}_{T})=\int p_{\psi}({\mathbf{x}}_{T}|{\mathbf{z}})p({%
\mathbf{z}})d{\mathbf{z}}
{\mathbf{x}}_{0}\sim q({\mathbf{x}}_{0})
q_{t}
{\mathbf{x}}_{t=1:T}
\beta_{t}\in(0,1)
t
\displaystyle q({\mathbf{x}}_{1},...,{\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})%
\coloneqq\textstyle\prod_{t=1}^{T}q({\mathbf{x}}_{t}\,|\,{\mathbf{x}}_{t-1}),~%
{}~{}~{}q({\mathbf{x}}_{t}\,|\,{\mathbf{x}}_{t-1})\coloneqq\mathcal{N}({%
\mathbf{x}}_{t};\sqrt{1-\beta_{t}}{\mathbf{x}}_{t-1},\beta_{t}{\bm{I}}).
\displaystyle q({\mathbf{x}}_{1},...,{\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})
\displaystyle\coloneqq\textstyle\prod_{t=1}^{T}q({\mathbf{x}}_{t}\,|\,{\mathbf%
{x}}_{t-1}),~{}~{}~{}q({\mathbf{x}}_{t}\,|\,{\mathbf{x}}_{t-1})\coloneqq%
\mathcal{N}({\mathbf{x}}_{t};\sqrt{1-\beta_{t}}{\mathbf{x}}_{t-1},\beta_{t}{%
\bm{I}}).
i.e.
\beta_{t}
q({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})
p_{\theta}
p_{\theta}({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\coloneqq\mathcal{N}({%
\mathbf{x}}_{t-1};\mu_{\theta}({\mathbf{x}}_{t},t),\Sigma_{\theta}({\mathbf{x}%
}_{t},t)).
T
{\mathbf{x}}_{T}
{\mathbf{x}}_{T}\sim\mathcal{N}({\bm{0}},{\bm{I}})
q({\mathbf{x}}_{0})
q({\mathbf{x}}_{1},...,{\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})
\theta
\displaystyle{\mathcal{L}}_{\text{ELBO}}(\theta)\coloneqq{\mathcal{L}}_{0}(%
\theta)+\textstyle\sum_{t=2}^{T}{\mathcal{L}}_{t-1}(\theta)+{\mathcal{L}}_{T},%
~{}~{}~{}{\mathcal{L}}_{0}(\theta)\coloneqq\mathbb{E}_{q({\mathbf{x}}_{0})}%
\mathbb{E}_{q({\mathbf{x}}_{1}\,|\,{\mathbf{x}}_{0})}\left[-\log p_{\theta}({%
\mathbf{x}}_{0}\,|\,{\mathbf{x}}_{1})\right],
\displaystyle{\mathcal{L}}_{\text{ELBO}}(\theta)
\displaystyle\coloneqq{\mathcal{L}}_{0}(\theta)+\textstyle\sum_{t=2}^{T}{%
\mathcal{L}}_{t-1}(\theta)+{\mathcal{L}}_{T},~{}~{}~{}{\mathcal{L}}_{0}(\theta%
)\coloneqq\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{1}\,|\,{%
\mathbf{x}}_{0})}\left[-\log p_{\theta}({\mathbf{x}}_{0}\,|\,{\mathbf{x}}_{1})%
\right],
\displaystyle{\mathcal{L}}_{t-1}(\theta)\coloneqq\mathbb{E}_{q({\mathbf{x}}_{0%
})}\mathbb{E}_{q({\mathbf{x}}_{t}\,|\,{\mathbf{x}}_{0})}[D_{\mathrm{KL}}\left(%
{q({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t},{\mathbf{x}}_{0})}||{p_{\theta}({%
\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})}\right)],~{}~{}~{}t\in\{2,\ldots,T\}
\displaystyle{\mathcal{L}}_{t-1}(\theta)
\displaystyle\coloneqq\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x%
}}_{t}\,|\,{\mathbf{x}}_{0})}[D_{\mathrm{KL}}\left({q({\mathbf{x}}_{t-1}\,|\,{%
\mathbf{x}}_{t},{\mathbf{x}}_{0})}||{p_{\theta}({\mathbf{x}}_{t-1}\,|\,{%
\mathbf{x}}_{t})}\right)],~{}~{}~{}t\in\{2,\ldots,T\}
\displaystyle{\mathcal{L}}_{T}\coloneqq\mathbb{E}_{q({\mathbf{x}}_{0})}[D_{%
\mathrm{KL}}\left({q({\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})}||{p({\mathbf{x}}_%
{T})}\right)],
\displaystyle{\mathcal{L}}_{T}
\displaystyle\coloneqq\mathbb{E}_{q({\mathbf{x}}_{0})}[D_{\mathrm{KL}}\left({q%
({\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})}||{p({\mathbf{x}}_{T})}\right)],
D_{\mathrm{KL}}(q||p)=\mathbb{E}_{q}[\log q-\log p]
p
q
T
p_{\theta}({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t})
\beta_{t}
q({\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})\approx\mathcal{N}({\bm{0}},{\bm{I}})
L_{T}
{\mathbf{x}}_{0}
\theta
T
q({\mathbf{x}}_{0})
q({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})
\beta_{t}
p_{\theta}({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})
\displaystyle\min_{\theta}\textstyle\sum_{t\geq 1}\mathbb{E}_{q(t)}\left[D_{%
\mathrm{adv}}\!\left(q({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\|p_{\theta}({%
\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\right)\right],
\displaystyle\min_{\theta}\textstyle\sum_{t\geq 1}\mathbb{E}_{q(t)}\left[D_{%
\mathrm{adv}}\!\left(q({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\|p_{\theta}({%
\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\right)\right],
D_{\mathrm{adv}}
\{\beta_{1},\beta_{2},...,\beta_{T}\}
\displaystyle\textstyle q({\mathbf{x}}_{t}\,|\,{\mathbf{x}}_{0})=\mathcal{N}(%
\sqrt{\bar{\alpha}_{t}}{\mathbf{x}}_{0},(1-\bar{\alpha}_{t})I);\quad\bar{%
\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i},~{}\alpha_{i}=1-\beta_{i}.
\displaystyle\textstyle q({\mathbf{x}}_{t}\,|\,{\mathbf{x}}_{0})=\mathcal{N}(%
\sqrt{\bar{\alpha}_{t}}{\mathbf{x}}_{0},(1-\bar{\alpha}_{t})I);\quad\bar{%
\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i},~{}\alpha_{i}=1-\beta_{i}.
{\mathbf{x}}_{t}
{\mathbf{x}}_{0}
t
\bar{\alpha}_{t}
\alpha_{i}
T
\mathcal{N}({\bm{0}},{\bm{I}})
T_{\text{trunc}}
\{\beta_{1},\beta_{2},...,\beta_{T_{\text{trunc}}}\}\subset\{\beta_{1},\beta_{%
2},...,\beta_{T}\}
T_{\text{trunc}}
T
\beta_{t}
T_{\text{trunc}}
0
T_{\text{trunc}}
{\mathbf{x}}_{T}\sim\mathcal{N}({\bm{0}},{\bm{I}})
T_{\text{trunc}}
T_{\text{trunc}}
{\mathcal{L}}_{0}
\sum_{t=2}^{T}{\mathcal{L}}_{t-1}
{\mathcal{L}}_{T}
\sum_{t=2}^{T}{\mathcal{L}}_{t-1}
{\mathcal{L}}_{0}
{\mathcal{L}}_{T}
q({\mathbf{x}}_{T}\,|\,{\mathbf{x}}_{0})\approx p({\mathbf{x}}_{T})=\mathcal{N%
}({\bm{0}},{\bm{I}})
T_{\text{trunc}}\ll T
T_{\text{trunc}}
\displaystyle q({\mathbf{x}}_{T_{\text{trunc}}})\coloneqq\textstyle\int q({%
\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})p({\mathbf{x}}_{0})d{%
\mathbf{x}}_{0},
\displaystyle q({\mathbf{x}}_{T_{\text{trunc}}})\coloneqq\textstyle\int q({%
\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})p({\mathbf{x}}_{0})d{%
\mathbf{x}}_{0},
\mathcal{N}({\bm{0}},{\bm{I}})
T_{\text{trunc}}
p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})
\psi
p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})
q({\mathbf{x}}_{T_{\text{trunc}}})
\tilde{{\mathcal{L}}}_{T_{\text{trunc}}}\coloneqq\mathcal{D}\left(q({\mathbf{x%
}}_{T_{\text{trunc}}})||p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})\right),
\mathcal{D}(q||p)
q
p
T_{\text{trunc}}
\tilde{{\mathcal{L}}}_{T_{\text{trunc}}}
T_{\text{trunc}}
\displaystyle{{\mathcal{L}}}_{\text{TDPM}}\coloneqq\textstyle\sum_{t=1}^{T_{%
\text{trunc}}}{\mathcal{L}}_{t-1}(\theta)+\tilde{\mathcal{L}}_{T_{\text{trunc}%
}}(\psi),~{}~{}\tilde{{\mathcal{L}}}_{T_{\text{trunc}}}(\psi)\coloneqq\mathcal%
{D}\left(q({\mathbf{x}}_{T_{\text{trunc}}})||p_{\psi}({\mathbf{x}}_{T_{\text{%
trunc}}})\right),
\displaystyle{{\mathcal{L}}}_{\text{TDPM}}
\displaystyle\coloneqq\textstyle\sum_{t=1}^{T_{\text{trunc}}}{\mathcal{L}}_{t-%
1}(\theta)+\tilde{\mathcal{L}}_{T_{\text{trunc}}}(\psi),~{}~{}\tilde{{\mathcal%
{L}}}_{T_{\text{trunc}}}(\psi)\coloneqq\mathcal{D}\left(q({\mathbf{x}}_{T_{%
\text{trunc}}})||p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})\right),
p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})
G_{\psi}
\displaystyle{\mathbf{x}}_{T_{\text{trunc}}}=G_{\psi}({\mathbf{z}}),~{}{%
\mathbf{z}}\sim\mathcal{N}({\bm{0}},{\bm{I}}).
\displaystyle{\mathbf{x}}_{T_{\text{trunc}}}=G_{\psi}({\mathbf{z}}),~{}{%
\mathbf{z}}\sim\mathcal{N}({\bm{0}},{\bm{I}}).
\psi=\theta
p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})
\displaystyle\textstyle p_{\theta}({\mathbf{x}}_{0}\,|\,{\mathbf{x}}_{T_{\text%
{trunc}}})\coloneqq\int\ldots\int\big{[}\prod_{t=1}^{T_{\text{trunc}}}p_{%
\theta}({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\big{]}d{\mathbf{x}}_{T_{\text%
{trunc}}-1}\ldots d{\mathbf{x}}_{1},
\displaystyle\textstyle p_{\theta}({\mathbf{x}}_{0}\,|\,{\mathbf{x}}_{T_{\text%
{trunc}}})\coloneqq\int\ldots\int\big{[}\prod_{t=1}^{T_{\text{trunc}}}p_{%
\theta}({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})\big{]}d{\mathbf{x}}_{T_{\text%
{trunc}}-1}\ldots d{\mathbf{x}}_{1},
{T_{\text{trunc}}}
q({\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})
q({\mathbf{x}}_{T_{\text{trunc}}})
\displaystyle\mathcal{L}_{\text{Diffusion-AAE}}=-\mathbb{E}_{q({\mathbf{x}}_{0%
})}\mathbb{E}_{q({\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\log p_%
{\theta}({\mathbf{x}}_{0}\,|\,{\mathbf{x}}_{T_{\text{trunc}}})+\mathcal{D}(q({%
\mathbf{x}}_{T_{\text{trunc}}}))||p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})).
\displaystyle\mathcal{L}_{\text{Diffusion-AAE}}=-\mathbb{E}_{q({\mathbf{x}}_{0%
})}\mathbb{E}_{q({\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\log p_%
{\theta}({\mathbf{x}}_{0}\,|\,{\mathbf{x}}_{T_{\text{trunc}}})+\mathcal{D}(q({%
\mathbf{x}}_{T_{\text{trunc}}}))||p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})).
T_{\text{trunc}}
\theta
\mathcal{L}_{\emph{\text{Diffusion-AAE}}}\leq{{\mathcal{L}}}_{\emph{\text{TDPM%
}}}.
\tilde{{\mathcal{L}}}_{T_{\text{trunc}}}\coloneqq\mathcal{D}\left(q({\mathbf{x%
}}_{T_{\text{trunc}}})||p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})\right)
p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})
q({\mathbf{x}}_{T_{\text{trunc}}})
p
q
q
p
G_{\psi}(\cdot):{\mathbb{R}}^{d}\rightarrow{\mathbb{R}}^{d}
p({\mathbf{z}})
D_{\phi}(\cdot):{\mathbb{R}}^{d}\rightarrow[0,1]
q({\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})
p_{\psi}({\mathbf{x}}_{T_{\text{trunc}}})
{\mathcal{L}}_{T_{\text{trunc}}}^{\mathrm{GAN}}
\displaystyle\min_{\psi}\max_{\phi}~{}~{}~{}\mathbb{E}_{{\mathbf{x}}\sim q({%
\mathbf{x}}_{T_{\text{trunc}}})}\!\left[\log D_{\phi}({\mathbf{x}})\right]+%
\mathbb{E}_{{\mathbf{z}}\sim p({\mathbf{z}})}\left[\log(1\!-\!D_{\phi}(G_{\psi%
}({\mathbf{z}})))\right]\!.
\displaystyle\min_{\psi}\max_{\phi}~{}~{}~{}
\displaystyle\mathbb{E}_{{\mathbf{x}}\sim q({\mathbf{x}}_{T_{\text{trunc}}})}%
\!\left[\log D_{\phi}({\mathbf{x}})\right]+\mathbb{E}_{{\mathbf{z}}\sim p({%
\mathbf{z}})}\left[\log(1\!-\!D_{\phi}(G_{\psi}({\mathbf{z}})))\right]\!.
\Sigma_{\theta}(x_{t},t)=\sigma^{2}_{t}{\bm{I}}
\frac{1}{T_{\text{trunc}}}\sum_{t=1}^{T_{\text{trunc}}}{\mathcal{L}}_{t-1}
{\mathcal{L}}_{\text{simple\_trunc}}=\mathbb{E}_{t,{\mathbf{x}}_{0},\epsilon_{%
t}}\left[||\epsilon_{t}-\epsilon_{\theta}({\mathbf{x}}_{t},t)||^{2}\right],~{}%
~{}t\sim\mbox{Unif}(1,2,\ldots,T_{\text{trunc}}),~{}~{}\epsilon_{t}\sim%
\mathcal{N}({\bm{0}},{\bm{I}})
\epsilon_{t}
t
{\mathbf{x}}_{t}=\sqrt{\bar{\alpha}_{t}}{\mathbf{x}}_{0}+\sqrt{1-\bar{\alpha}_%
{t}}\epsilon_{t}
t
\epsilon_{\theta}
{\mathbf{x}}_{t}
\displaystyle{\mathcal{L}}_{\text{TDPM}}^{\text{GAN}}={\mathcal{L}}_{\text{%
simple\_trunc}}+\lambda{\mathcal{L}}_{T_{\text{trunc}}}^{\text{GAN}},.
\displaystyle{\mathcal{L}}_{\text{TDPM}}^{\text{GAN}}={\mathcal{L}}_{\text{%
simple\_trunc}}+\lambda{\mathcal{L}}_{T_{\text{trunc}}}^{\text{GAN}},.
\lambda
\mathcal{L}_{T_{\text{trunc}}}
\epsilon_{\theta}
{\mathcal{L}}_{\text{simple\_trunc}}
G_{\psi}
\mathbb{E}_{q}[\mathcal{D}\left(q({\mathbf{x}}_{T_{\text{trunc}}})||p_{\psi}({%
\mathbf{x}}_{T_{\text{trunc}}})\right)]
{\mathcal{L}}_{T_{\text{trunc}}}^{\text{GAN}}
\psi
G_{\psi}
\theta
i.e.
\psi=\theta
T
T_{\text{trunc}}
T_{\text{trunc}}
0
{\mathbf{x}}_{T_{\text{trunc}}}\!=\!G_{\psi}({\mathbf{x}}_{T})\!=\!\epsilon_{%
\theta}({\mathbf{x}}_{T},t\!\!=\!\!T_{\text{trunc}}\!+\!1)
{\mathbf{x}}_{T}\sim\mathcal{N}({\bm{0}},{\bm{I}})
T_{\text{trunc}}
{\mathbf{x}}_{T_{\text{Trunc}}}
t\!=\!T_{\text{trunc}},\ldots,1
{\mathbf{x}}_{t-1}=\frac{1}{\sqrt{\alpha_{t}}}({\mathbf{x}}_{t}-\frac{1-\alpha%
_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{\theta}({\mathbf{x}}_{t},t))+\beta_{%
t}{\mathbf{z}}_{t}
{\mathbf{z}}_{t}\sim N({\bm{0}},{\bm{I}})
t>1
{\mathbf{z}}_{1}={\bm{0}}
T_{\text{Trunc}}
T_{\text{Trunc}}
\downarrow
\uparrow
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
256\times 256
T_{\text{Trunc}}
256\times 256
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
\times
T_{\text{Trunc}}
\times
T_{\text{Trunc}}
\downarrow
\uparrow
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
T_{\text{Trunc}}
\times
T_{\text{Trunc}}
\times
32\times 32
256\times 256
t\!<\!T_{\text{Trunc}}
\epsilon_{\theta}
t\!=\!T_{\text{Trunc}}
G_{\psi}
t\!<\!T_{\text{Trunc}}
\epsilon_{\theta}
t\!=\!T_{\text{Trunc}}
G_{\psi}
256\times 256
{T_{\text{trunc}}}
{\mathbf{x}}_{T_{\text{trunc}}}\sim p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
{\mathbf{x}}_{0}
256\times 256
{T_{\text{trunc}}}=4
49
99
\mbox{NFE}={T_{\text{trunc}}}+1
p_{\theta}({\mathbf{x}}_{0})
\sim p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
256\times 256
{T_{\text{trunc}}}=4
49
99
\mbox{NFE}={T_{\text{trunc}}}+1
p_{\theta}({\mathbf{x}}_{0})
\sim p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
\times
t<T_{\text{Trunc}}
t=T_{\text{Trunc}}
{T_{\text{trunc}}}
{T_{\text{trunc}}}
t<T_{\text{Trunc}}
t=T_{\text{Trunc}}
i.e.,
i.e.,
{\mathcal{L}}_{0}+\textstyle\sum_{t=2}^{T_{\text{trunc}}}{\mathcal{L}}_{t-1}
\displaystyle-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{T_{%
\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\log p_{\theta}({\mathbf{x}}_{0}\,|\,{%
\mathbf{x}}_{T_{\text{trunc}}})
\displaystyle-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{T_{%
\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\log p_{\theta}({\mathbf{x}}_{0}\,|\,{%
\mathbf{x}}_{T_{\text{trunc}}})
\displaystyle=-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{T_{%
\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\log\mathbb{E}_{q({\mathbf{x}}_{1:{T_{%
\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}}_{T_{\text{trunc}}})}\left[%
\frac{p({\mathbf{x}}_{0:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{T_{\text{trunc%
}}})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}%
}_{T_{\text{trunc}}})}\right]
\displaystyle=-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{T_{%
\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\log\mathbb{E}_{q({\mathbf{x}}_{1:{T_{%
\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}}_{T_{\text{trunc}}})}\left[%
\frac{p({\mathbf{x}}_{0:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{T_{\text{trunc%
}}})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}%
}_{T_{\text{trunc}}})}\right]
\displaystyle\leq-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{%
T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{1:{T_{%
\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}}_{T_{\text{trunc}}})}\log%
\frac{p({\mathbf{x}}_{0:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{T_{\text{trunc%
}}})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}%
}_{T_{\text{trunc}}})}
\displaystyle\leq-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{%
T_{\text{trunc}}}\,|\,{\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{1:{T_{%
\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}}_{T_{\text{trunc}}})}\log%
\frac{p({\mathbf{x}}_{0:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{T_{\text{trunc%
}}})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}-1}\,|\,{\mathbf{x}}_{0},{\mathbf{x}%
}_{T_{\text{trunc}}})}
\displaystyle=-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{1:{%
T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}\log\left[\frac{p({\mathbf{x}}_{0:{T_%
{\text{trunc}}}-1})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0%
})}\frac{q({\mathbf{x}}_{{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}{p({\mathbf%
{x}}_{T_{\text{trunc}}})}\right]
\displaystyle=-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{1:{%
T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}\log\left[\frac{p({\mathbf{x}}_{0:{T_%
{\text{trunc}}}-1})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0%
})}\frac{q({\mathbf{x}}_{{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}{p({\mathbf%
{x}}_{T_{\text{trunc}}})}\right]
\displaystyle=\left(-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}%
}_{1:{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}\log\frac{p({\mathbf{x}}_{0:{T_%
{\text{trunc}}}-1})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0%
})}\right)-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{{T_{%
\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}\log\frac{q({\mathbf{x}}_{{T_{\text{%
trunc}}}}\,|\,{\mathbf{x}}_{0})}{p({\mathbf{x}}_{T_{\text{trunc}}})}
\displaystyle=\left(-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}%
}_{1:{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}\log\frac{p({\mathbf{x}}_{0:{T_%
{\text{trunc}}}-1})}{q({\mathbf{x}}_{1:{T_{\text{trunc}}}}\,|\,{\mathbf{x}}_{0%
})}\right)-\mathbb{E}_{q({\mathbf{x}}_{0})}\mathbb{E}_{q({\mathbf{x}}_{{T_{%
\text{trunc}}}}\,|\,{\mathbf{x}}_{0})}\log\frac{q({\mathbf{x}}_{{T_{\text{%
trunc}}}}\,|\,{\mathbf{x}}_{0})}{p({\mathbf{x}}_{T_{\text{trunc}}})}
\displaystyle=(\textstyle\sum_{t=1}^{T_{\text{trunc}}}{\mathcal{L}}_{t-1}+{%
\mathcal{L}}_{T_{\text{trunc}}})-{\mathcal{L}}_{T_{\text{trunc}}}
\displaystyle=(\textstyle\sum_{t=1}^{T_{\text{trunc}}}{\mathcal{L}}_{t-1}+{%
\mathcal{L}}_{T_{\text{trunc}}})-{\mathcal{L}}_{T_{\text{trunc}}}
\displaystyle=\sum_{t=1}^{T_{\text{trunc}}}{\mathcal{L}}_{t-1},
\displaystyle=\sum_{t=1}^{T_{\text{trunc}}}{\mathcal{L}}_{t-1},
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
\epsilon_{\theta}
{\mathcal{L}}_{\mathrm{simple}}
G_{\psi}
{\mathcal{L}}_{T_{\text{trunc}}}^{\mathrm{GAN}}
t={T_{\text{trunc}}}
0<t<{T_{\text{trunc}}}
t=T_{\text{trunc}}
{\mathbf{x}}_{T_{\text{trunc}}}=\epsilon_{\theta}({\mathbf{x}}_{T_{\text{trunc%
}}+1},t=T_{\text{trunc}}+1)
{\mathbf{x}}_{T_{\text{trunc}}+1}\sim\mathcal{N}(0,I)
t=T_{\text{trunc}},T_{\text{trunc}}-1,\ldots,1
{\mathbf{x}}_{t-1}=\frac{1}{\sqrt{\bar{\alpha}_{t}}}({\mathbf{x}}_{t}-\frac{1-%
\alpha_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{t-1})+\beta_{t}{\mathbf{z}}_{t%
};~{}{\mathbf{z}}_{t>1}\sim\mathcal{N}(0,I),{\mathbf{z}}_{1}={\bm{0}}
\epsilon_{t-1}=\epsilon_{\theta}({\mathbf{x}}_{t},t)
T_{\text{trunc}}
p({\mathbf{x}}_{T_{\text{trunc}}})
t=T
t<{T_{\text{trunc}}}
G_{\psi}
t={T_{\text{trunc}}}
32\times 32
256\times 256
{\mathbf{x}}_{0}\sim q({\mathbf{x}}_{0})
t\sim\mathrm{Uniform}(\{1,\dotsc,T_{\text{trunc}}\})
\epsilon_{t}\sim\mathcal{N}({\bm{0}},{\bm{I}}),{\mathbf{z}}\sim\mathcal{N}({%
\bm{0}},{\bm{I}})
{\mathbf{x}}_{T_{\text{trunc}}+1}\sim\mathcal{N}({\bm{0}},{\bm{I}})
G_{\psi}
\epsilon_{\theta}
{\mathbf{x}}_{T_{\text{trunc}}}=\epsilon_{\theta}({\mathbf{x}}_{T_{\text{trunc%
}}+1},T_{\text{trunc}}+1)
{\mathbf{x}}_{T_{\text{trunc}}}=G_{\psi}({\mathbf{x}}_{T_{\text{trunc}}+1})
t=T_{\text{trunc}},\dotsc,1
{\mathbf{z}}_{t}\sim\mathcal{N}({\bm{0}},{\bm{I}})
t>1
{\mathbf{z}}_{1}={\bm{0}}
{\mathbf{x}}_{t-1}=\frac{1}{\sqrt{\alpha_{t}}}\left({\mathbf{x}}_{t}-\frac{1-%
\alpha_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{\theta}({\mathbf{x}}_{t},t)%
\right)+\beta_{t}{\mathbf{z}}_{t}
{\mathbf{x}}_{0}
G_{\psi}
\pi_{\eta}
\eta
p
q
\phi
c_{\phi}
{\mathcal{L}}_{T_{\text{trunc}}}^{\mathrm{CT}}
\displaystyle\min_{\psi,\eta}\max_{\phi}~{}\!\mathbb{E}_{{\mathbf{x}}\sim q({%
\mathbf{x}}_{T_{\text{trunc}}})}\!\left[\mathbb{E}_{G_{\psi}({\mathbf{z}})\sim%
\pi_{\eta}(G_{\psi}({\mathbf{z}})\,|\,{\mathbf{x}}_{T_{\text{trunc}}})}c_{\phi%
}({\mathbf{x}}_{T_{\text{trunc}}},G_{\psi}({\mathbf{z}}))\right]
\displaystyle\min_{\psi,\eta}
\displaystyle\max_{\phi}~{}\!\mathbb{E}_{{\mathbf{x}}\sim q({\mathbf{x}}_{T_{%
\text{trunc}}})}\!\left[\mathbb{E}_{G_{\psi}({\mathbf{z}})\sim\pi_{\eta}(G_{%
\psi}({\mathbf{z}})\,|\,{\mathbf{x}}_{T_{\text{trunc}}})}c_{\phi}({\mathbf{x}}%
_{T_{\text{trunc}}},G_{\psi}({\mathbf{z}}))\right]
\displaystyle+\mathbb{E}_{{\mathbf{z}}\sim p({\mathbf{z}})}\left[\mathbb{E}_{{%
\mathbf{x}}_{T_{\text{trunc}}}\sim\pi_{\eta}({\mathbf{x}}_{T_{\text{trunc}}}\,%
|\,G_{\psi}({\mathbf{z}}))}c_{\phi}({\mathbf{x}}_{T_{\text{trunc}}},G_{\psi}({%
\mathbf{z}}))\right]\!.
\displaystyle+\mathbb{E}_{{\mathbf{z}}\sim p({\mathbf{z}})}\left[\mathbb{E}_{{%
\mathbf{x}}_{T_{\text{trunc}}}\sim\pi_{\eta}({\mathbf{x}}_{T_{\text{trunc}}}\,%
|\,G_{\psi}({\mathbf{z}}))}c_{\phi}({\mathbf{x}}_{T_{\text{trunc}}},G_{\psi}({%
\mathbf{z}}))\right]\!.
\displaystyle{\mathcal{L}}_{\text{TDPM}}^{\text{CT}}={\mathcal{L}}_{\text{%
simple\_trunc}}+\lambda{\mathcal{L}}_{T_{\text{trunc}}}^{\text{CT}}.
\displaystyle{\mathcal{L}}_{\text{TDPM}}^{\text{CT}}={\mathcal{L}}_{\text{%
simple\_trunc}}+\lambda{\mathcal{L}}_{T_{\text{trunc}}}^{\text{CT}}.
\displaystyle{\mathcal{L}}_{\text{TDPM}}^{\mathbf{c}}={\mathcal{L}}_{\text{%
simple\_trunc}}^{\mathbf{c}}+\lambda{\mathcal{L}}_{T_{\text{trunc}}}^{\mathbf{%
c}},
\displaystyle{\mathcal{L}}_{\text{TDPM}}^{\mathbf{c}}={\mathcal{L}}_{\text{%
simple\_trunc}}^{\mathbf{c}}+\lambda{\mathcal{L}}_{T_{\text{trunc}}}^{\mathbf{%
c}},
{\mathcal{L}}_{\text{simple\_trunc}}^{\mathbf{c}}
{\mathcal{L}}_{\text{simple\_trunc}}^{\mathbf{c}}=\mathbb{E}_{\mathbf{c}}%
\mathbb{E}_{t,{\mathbf{x}}_{0}|{\mathbf{c}},\epsilon_{t}}\left[||\epsilon_{t}-%
\epsilon_{\theta}({\mathbf{x}}_{t},{\mathbf{c}},t)||^{2}\right],~{}~{}t\sim%
\mbox{Unif}(1,2,\ldots,T_{\text{trunc}}),~{}~{}\epsilon_{t}\sim\mathcal{N}({%
\bm{0}},{\bm{I}}),
{\mathcal{L}}_{T_{\text{trunc}}}^{\mathbf{c}}
\displaystyle\min_{\psi}\max_{\phi}~{}~{}~{}\mathbb{E}_{\mathbf{c}}\left[%
\mathbb{E}_{{\mathbf{x}}\sim q({\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{c}%
})}\!\left[\log D_{\phi}({\mathbf{x}}\,|\,{\mathbf{c}})\right]+\mathbb{E}_{{%
\mathbf{z}}\sim p({\mathbf{z}})}\left[\log(1\!-\!D_{\phi}(G_{\psi}({\mathbf{z}%
},{\mathbf{c}}))\,|\,{\mathbf{c}})\right]\right]\!.
\displaystyle\min_{\psi}\max_{\phi}~{}~{}~{}
\displaystyle\mathbb{E}_{\mathbf{c}}\left[\mathbb{E}_{{\mathbf{x}}\sim q({%
\mathbf{x}}_{T_{\text{trunc}}}\,|\,{\mathbf{c}})}\!\left[\log D_{\phi}({%
\mathbf{x}}\,|\,{\mathbf{c}})\right]+\mathbb{E}_{{\mathbf{z}}\sim p({\mathbf{z%
}})}\left[\log(1\!-\!D_{\phi}(G_{\psi}({\mathbf{z}},{\mathbf{c}}))\,|\,{%
\mathbf{c}})\right]\right]\!.
\displaystyle\min_{\psi,\eta}\max_{\phi}~{}\!\mathbb{E}_{\mathbf{c}}\big{[}%
\mathbb{E}_{{\mathbf{x}}\sim q({\mathbf{x}}_{T_{\text{trunc}}\,|\,{\mathbf{c}}%
})}\!\left[\mathbb{E}_{G_{\psi}({\mathbf{z}})\sim\pi_{\eta}(G_{\psi}({\mathbf{%
z}},{\mathbf{c}})\,|\,{\mathbf{x}}_{T_{\text{trunc}}},{\mathbf{c}})}c_{\phi}({%
\mathbf{x}}_{T_{\text{trunc}}},G_{\psi}({\mathbf{z}},{\mathbf{c}}))\right]
\displaystyle\min_{\psi,\eta}\max_{\phi}~{}\!
\displaystyle\mathbb{E}_{\mathbf{c}}\big{[}\mathbb{E}_{{\mathbf{x}}\sim q({%
\mathbf{x}}_{T_{\text{trunc}}\,|\,{\mathbf{c}}})}\!\left[\mathbb{E}_{G_{\psi}(%
{\mathbf{z}})\sim\pi_{\eta}(G_{\psi}({\mathbf{z}},{\mathbf{c}})\,|\,{\mathbf{x%
}}_{T_{\text{trunc}}},{\mathbf{c}})}c_{\phi}({\mathbf{x}}_{T_{\text{trunc}}},G%
_{\psi}({\mathbf{z}},{\mathbf{c}}))\right]
\displaystyle+\mathbb{E}_{{\mathbf{z}}\sim p({\mathbf{z}})}\left[\mathbb{E}_{{%
\mathbf{x}}_{T_{\text{trunc}}}\sim\pi_{\eta}({\mathbf{x}}_{T_{\text{trunc}}}\,%
|\,G_{\psi}({\mathbf{z}},{\mathbf{c}}),{\mathbf{c}})}c_{\phi}({\mathbf{x}}_{T_%
{\text{trunc}}},G_{\psi}({\mathbf{z}},{\mathbf{c}}))\right]\big{]}\!.
\displaystyle+\mathbb{E}_{{\mathbf{z}}\sim p({\mathbf{z}})}\left[\mathbb{E}_{{%
\mathbf{x}}_{T_{\text{trunc}}}\sim\pi_{\eta}({\mathbf{x}}_{T_{\text{trunc}}}\,%
|\,G_{\psi}({\mathbf{z}},{\mathbf{c}}),{\mathbf{c}})}c_{\phi}({\mathbf{x}}_{T_%
{\text{trunc}}},G_{\psi}({\mathbf{z}},{\mathbf{c}}))\right]\big{]}\!.
\mathcal{X}
|\mathcal{X}|=2,000
[-10,10]
x
y
\hat{p}_{\theta}
\hat{q}
D_{\text{KL}}(\hat{q}||\hat{p}_{\theta})
T=2
T=5
q({\mathbf{x}}_{T_{\text{trunc}}})
\mathcal{N}({\bm{0}},{\bm{I}})
T=5
q({\mathbf{x}}_{T})
q({\mathbf{x}}_{T_{\text{trunc}}})
D_{\text{KL}}(\hat{q}||\hat{p}_{\theta})
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
q({\mathbf{x}}_{T_{\text{trunc}}})
T\!=\!2
T\!=\!5
T_{\text{Trunc}}\!\!=\!\!1
T_{\text{Trunc}}\!\!=\!\!4
q({\mathbf{x}}_{0})
q({\mathbf{x}}_{T-1})
p_{\theta}({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})
p({\mathbf{x}}_{T})\!=\!\mathcal{N}({\bm{0}},{\bm{I}})
q({\mathbf{x}}_{T-1})
p_{\theta}({\mathbf{x}}_{T-1})
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
q({\mathbf{x}}_{T-1})
q({\mathbf{x}}_{0})
T\!=\!2
T\!=\!5
T_{\text{Trunc}}\!\!=\!\!1
T_{\text{Trunc}}\!\!=\!\!4
q({\mathbf{x}}_{0})
q({\mathbf{x}}_{T-1})
p_{\theta}({\mathbf{x}}_{t-1}\,|\,{\mathbf{x}}_{t})
p({\mathbf{x}}_{T})\!=\!\mathcal{N}({\bm{0}},{\bm{I}})
q({\mathbf{x}}_{T-1})
p_{\theta}({\mathbf{x}}_{T-1})
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
q({\mathbf{x}}_{T-1})
q({\mathbf{x}}_{0})
t={T_{\text{trunc}}}
t={T_{\text{trunc}}}
t<{T_{\text{trunc}}}
t=T_{\text{Trunc}}
t<T_{\text{Trunc}}
\downarrow
{{}_{\text{trunc}}}
{{}_{\text{trunc}}}
{{}_{\text{trunc}}}
\downarrow
{{}_{\text{trunc}}}
{{}_{\text{trunc}}}
{{}_{\text{trunc}}}
{{}_{\text{trunc}}}
G_{\psi}
q({\mathbf{x}}_{t}|{\mathbf{x}}_{0})=\mathcal{N}(\sqrt{\bar{\alpha}_{t}}{%
\mathbf{x}}_{0},{1-\bar{\alpha}_{t}}I)
\text{SNR}=\frac{\sqrt{\bar{\alpha}_{t}}}{\sqrt{1-\bar{\alpha}_{t}}};\bar{%
\alpha}_{t}=\prod_{i=1}^{t}(1-\beta_{t}).
t>0
t\in\llbracket 1,100\rrbracket
T_{\text{Trunc}}=4
T_{\text{Trunc}}=99
T_{\text{Trunc}}>100
t<T_{\text{Trunc}}
\times
\times
\times
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
T
T
G_{\theta}
{\mathbf{z}}\sim\mathcal{N}({\bm{0}},{\bm{I}})
t=T_{\text{trunc}}+1
G_{\theta}
t={T_{\text{trunc}}}+1
t={T_{\text{trunc}}+1}
G_{\psi}
G_{\psi}
{\mathbf{x}}_{{T_{\text{trunc}}}}
q({\mathbf{x}}_{T_{\text{trunc}}})
p_{\theta}({\mathbf{x}}_{{T_{\text{trunc}}}})
{\mathcal{L}}_{T_{\text{trunc}}}^{\text{CT}}
t=T_{\text{Trunc}}
32\times 32
64\times 64
256\times 256
T_{\text{Trunc}}
\{\beta_{1},...,\beta_{T_{\text{Trunc}}}\}
\beta_{1}=10^{-4}
\beta_{T}=0.02
\beta_{1}
\beta_{2}
\beta_{1000}
10^{-4}
10^{-4}
10^{-4}
10^{-4}
10^{-4}
10^{-4}
10^{-4}
10^{-4}
1\times 10^{-5}
1\times 10^{-5}
2\times 10^{-5}
2\times 10^{-5}
\beta_{1}
\beta_{2}
\#
\#
G_{\psi}
10^{-5}
\times
G_{\psi}
16\times 16\rightarrow 32\times 32\rightarrow 64\times 64
\times
T_{\text{Trunc}}
t<T_{\text{Trunc}}
\downarrow
\downarrow
\uparrow
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
{}_{\text{trunc}}
64\times 64
64\times 64
256\times 256
{T_{\text{trunc}}}=99
49
4
\mbox{NFE}={T_{\text{trunc}}}+1
p_{\theta}({\mathbf{x}}_{0})
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
256\times 256
{T_{\text{trunc}}}=99
49
4
\mbox{NFE}={T_{\text{trunc}}}+1
p_{\theta}({\mathbf{x}}_{0})
p_{\theta}({\mathbf{x}}_{T_{\text{trunc}}})
T_{\text{trunc}}=49
T_{\text{trunc}}=49
T_{\text{trunc}}=4
T_{\text{trunc}}=4
