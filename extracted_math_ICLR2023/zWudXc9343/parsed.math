M
N
N
N
1
M
\displaystyle\mathcal{M}=\begin{bmatrix}\lx@intercol\hfil\mathcal{F}_{(N+1)%
\times(N+1)}\hfil\lx@intercol&\mathcal{T}_{(N+1)\times M}\\
\mathcal{M}^{{}^{\prime}}_{M\times N}&\mathcal{F}_{M\times 1}&\mathcal{T}_{M%
\times M}\end{bmatrix}
\displaystyle\mathcal{M}=\begin{bmatrix}\lx@intercol\hfil\mathcal{F}_{(N+1)%
\times(N+1)}\hfil\lx@intercol&\mathcal{T}_{(N+1)\times M}\\
\mathcal{M}^{{}^{\prime}}_{M\times N}&\mathcal{F}_{M\times 1}&\mathcal{T}_{M%
\times M}\end{bmatrix}
M
N
\mathcal{T}_{m\times n}
m\times n
\mathcal{F}_{m\times n}
m\times n
\mathcal{M}^{\prime}
\displaystyle\mathcal{M}^{\prime}_{i,j}=\begin{cases}\text{False}&\text{if %
mask${}_{i}$ contains at least one pixel in patch${}_{j}$}\\
\text{True}&\text{otherwise.}\end{cases}
\displaystyle\mathcal{M}^{\prime}_{i,j}=\begin{cases}\text{False}&\text{if %
mask${}_{i}$ contains at least one pixel in patch${}_{j}$}\\
\text{True}&\text{otherwise.}\end{cases}
\mathcal{M}
\mathcal{F}_{(N+1)\times(N+1)}
N
\mathcal{T}_{(N+1)\times M}
N
M
\mathcal{M}^{{}^{\prime}}_{M\times N}
\mathcal{F}_{M\times 1}
M
\mathcal{T}_{M\times M}
M
A^{\prime}_{:M,-N:}
M_{r}
A^{\prime}_{:M,-N:}
M_{r}
M_{r}
\mathcal{A}^{{}^{\prime}}_{:M,-N:}
f_{M}
f_{1}
f_{2}
f_{r}
D
T^{\text{MC}}_{i}\in\mathbb{R}^{D}
K_{i}\in\mathbb{R}^{H\times W}
T^{\text{MP}}\in\mathbb{R}^{M\times N\times D}
\displaystyle\mathcal{A}^{{}^{\prime}}_{:M,-N:}=\sum_{c}^{D}(\phi_{Q_{m}}(T^{%
\text{MP}})\odot\phi_{K_{m}}(T^{\text{IM}}))_{c}
\displaystyle\mathcal{A}^{{}^{\prime}}_{:M,-N:}
\displaystyle=\sum_{c}^{D}(\phi_{Q_{m}}(T^{\text{MP}})\odot\phi_{K_{m}}(T^{%
\text{IM}}))_{c}
\displaystyle\mathcal{A}_{:M,-N:}=\frac{\phi_{Q}(T^{\text{MC}})\cdot\phi_{K}(T%
^{\text{IM}})+\mathcal{A}^{{}^{\prime}}_{:M,-N:}}{2\sqrt{D}}
\displaystyle\mathcal{A}_{:M,-N:}
\displaystyle=\frac{\phi_{Q}(T^{\text{MC}})\cdot\phi_{K}(T^{\text{IM}})+%
\mathcal{A}^{{}^{\prime}}_{:M,-N:}}{2\sqrt{D}}
T^{\text{IM}}\in\mathbb{R}^{N\times D}
T^{\text{MC}}\in\mathbb{R}^{M\times D}
T^{\text{MP}}\in\mathbb{R}^{M\times N\times D}
\phi_{Q},\phi_{K},\phi_{Q_{m}},\phi_{K_{m}}
\odot
\sum_{c}^{D}(\cdot)_{c}
\phi_{K_{m}}(T^{\text{IM}})\in\mathbb{R}^{N\times D}
\mathbb{R}^{M\times N\times D}
\displaystyle M_{r}=\sigma(\sigma^{-1}(M_{c})+f_{r}(\phi_{Q}(T^{\text{MC}})%
\odot\phi_{K}(T^{\text{IM}})))
\displaystyle M_{r}=\sigma(\sigma^{-1}(M_{c})+f_{r}(\phi_{Q}(T^{\text{MC}})%
\odot\phi_{K}(T^{\text{IM}})))
M_{c},M_{r}\in\mathbb{R}^{N\times H\times W}
f_{r}
\sigma
\sigma^{-1}
\uparrow
\uparrow
\uparrow
\uparrow
\mathcal{L}=\lambda_{\text{ce}}\mathcal{L}_{\text{ce}}+\lambda_{\text{dice}}%
\mathcal{L}_{\text{dice}}+\lambda_{\text{bce}}\mathcal{L}_{\text{bce}}
\mathcal{L}_{\text{ce}}
\mathcal{L}_{\text{dice}}
\mathcal{L}_{\text{bce}}
\lambda_{\text{ce}}=2,\lambda_{\text{dice}}=5,\lambda_{\text{bce}}=5
\uparrow
{}^{\text{th}}
\uparrow
{}^{\text{st}}
\uparrow
\uparrow
{}^{\text{th}}
\uparrow
{}^{\text{st}}
\uparrow
\uparrow
{}^{\text{th}}
\uparrow
{}^{\text{st}}
\uparrow
\uparrow
{}^{\text{50}}
\uparrow
{}^{\text{75}}
\uparrow
\uparrow
{}^{\text{50}}
\uparrow
{}^{\text{75}}
\uparrow
N
N
\uparrow
\uparrow
\uparrow
{}^{\text{Th}}
\uparrow
{}^{\text{St}}
\uparrow
\uparrow
{}^{\text{Th}}
\uparrow
{}^{\text{St}}
\uparrow
\mathcal{I}\in\mathbb{R}^{H\times W\times 3}
H
W
C
\mathcal{E}\in\mathbb{R}^{C\times D}
f_{m}
N
\mathcal{M}\in\mathbb{R}^{N\times H\times W}
\mathcal{M}_{i}
\mathcal{I}
\mathcal{R}_{i}\in\mathbb{R}^{H\times W\times 3}
\mathcal{V}_{i}\in\mathbb{R}^{D}
D
\mathcal{Y}_{i}\in\mathbb{R}^{C}
\mathcal{V}_{i}
\mathcal{T}
f_{m}
f_{v}
f_{t}
\mathcal{I}\in\mathbb{R}^{H\times W\times 3}
\mathcal{T}
C
\mathcal{E}=f_{t}(\mathcal{T})
\mathcal{M}=f_{m}(\mathcal{I})
t=1,2,\dots,N
\mathcal{R}_{i}=\mathcal{M}_{i}\odot\mathcal{I}
\mathcal{V}_{i}=f_{v}(\mathcal{R}_{i})
\mathcal{Y}_{i}=\operatorname{softmax}(\mathcal{E}\otimes\mathcal{V}_{i})
{}^{\text{Th}}
{}^{\text{St}}
