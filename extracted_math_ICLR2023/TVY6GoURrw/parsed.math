i
i
i
i
i
i
i
i
i
\mathcal{A}
N
n
X_{i}=(x_{i,1},\cdots,x_{i,n})\in\mathcal{X}^{n}
i\in[N]\triangleq\{1,\cdots,N\}
X_{i}\sim\mathcal{D}_{i}^{n}
\mathcal{D}_{i}
r
w_{r}
w_{r+1}
f:\mathbb{R}^{d}\times\mathcal{X}\to\mathbb{R}\bigcup\{+\infty\}
F_{i}(w):=\mathbb{E}_{x_{i}\sim\mathcal{D}_{i}}[f(w,x_{i})].\vspace{-0.12cm}
\widehat{F}_{i}(w):=\frac{1}{n}\sum_{j=1}^{n}f(w,x_{i,j})
\small\min_{w\in\mathbb{R}^{d}}\left\{F(w):=\frac{1}{N}\sum_{i=1}^{N}F_{i}(w)%
\right\},
\small\min_{w\in\mathbb{R}^{d}}\{\widehat{F}_{\mathbf{X}}(w):=\frac{1}{N}\sum_%
{i=1}^{N}\widehat{F}_{i}(w)\}\normalsize
\mathbf{X}=(X_{1},\cdots,X_{N})\in\mathcal{X}_{1}^{n}\times\cdots\times%
\mathcal{X}_{N}^{n}=:\mathbb{X}
f
+\infty
\mathcal{W}\subset\mathbb{R}^{d}
F_{i}
x_{i,j}
\mathcal{A}
\mathbb{E}F(\mathcal{A}(\mathbf{X}))-F^{*}
F^{*}=\inf_{w}F(w)
\mathbf{X}=(X_{1},\ldots,X_{N})
\mathcal{A}
\mathcal{A}
\mathbb{E}\widehat{F}_{\mathbf{X}}(\mathcal{A}(\mathbf{X}))-\widehat{F}_{%
\mathbf{X}}^{*}
\mathcal{A}
F
h:\mathbb{R}^{d}\to\mathbb{R}^{m}
L
\mathcal{W}\subset\mathbb{R}^{d}
\|h(w)-h(w^{\prime})\|\leq L\|w-w^{\prime}\|
w,w^{\prime}\in\mathcal{W}
\mathbb{R}^{d}
\mathbb{R}^{d}
M=N
\kappa=\beta/\mu
\beta
\mu
M=N
\kappa=\beta/\mu
\beta
\mu
\mathbb{X}=\mathcal{X}_{1}^{n}\times\cdots\mathcal{X}^{n}
\rho:\mathbb{X}^{2}\to[0,\infty)
\mathbf{X},\mathbf{X}^{\prime}\in\mathbb{X}
\rho
\rho(\mathbf{X},\mathbf{X}^{\prime})\leq 1
\mathcal{A}
\epsilon\geq 0,~{}\delta\in[0,1).
\mathcal{A}:\mathbb{X}\to\mathcal{W}
(\epsilon,\delta)
\rho
\rho
\mathbf{X},\mathbf{X}^{\prime}\in\mathbb{X}
S\subseteq\mathcal{W}
\mathbb{P}(\mathcal{A}(\mathbf{X})\in S)\leq e^{\epsilon}\mathbb{P}(\mathcal{A%
}(\mathbf{X}^{\prime})\in S)+\delta.
\rho_{i}:\mathcal{X}^{2}\to[0,\infty)
\rho_{i}(X_{i},X^{\prime}_{i}):=\sum_{j=1}^{n}\mathds{1}_{\{x_{i,j}\neq x_{i,j%
}^{\prime}\}}
i\in[N]
\mathcal{A}
(\epsilon,\delta)
i\in[N]
\rho_{i}
X_{i},X^{\prime}_{i}
i
\mathcal{A}
(\epsilon,\delta)
\rho
\mathbf{X},\mathbf{X}^{\prime}\in\mathbb{X}
S
\rho(\mathbf{X},\mathbf{X}^{\prime}):=\sum_{i=1}^{N}\sum_{j=1}^{n}\mathds{1}_{%
\{x_{i,j}\neq x^{\prime}_{i,j}\}}
\|\cdot\|
\ell_{2}
\mathcal{W}
w
f^{0}:\mathcal{W}\times\mathcal{X}\to\mathbb{R}
w
\nabla f^{0}(w,x)
h
\beta
\nabla h
\beta
\mathbb{R}\bigcup\{+\infty\}
+\infty
g
\forall\alpha\in\mathbb{R}
\{w\in\mbox{dom}(g)|g(w)\leq\alpha\}
\mathcal{W}
\iota_{\mathcal{W}}(w):=\begin{cases}0&\mbox{if $w\in\mathcal{W}$}\\
+\infty&\mbox{otherwise}\end{cases}.
w\in\mathcal{W}
f^{1}
\texttt{{prox}}_{\eta f^{1}}(z):=\operatorname*{argmin}_{y\in\mathbb{R}^{d}}%
\left(\eta f^{1}(y)+\frac{1}{2}\|y-z\|^{2}\right),~{}\text{for}~{}\eta>0.
a\lesssim b
\exists C>0
a\leq Cb
a=\widetilde{\mathcal{O}}(b)
a\lesssim\log^{2}(\theta)b
\theta
\small\hat{\Delta}_{\mathbf{X}}:=\widehat{F}_{\mathbf{X}}(w_{0})-\widehat{F}_{%
\mathbf{X}}^{*}
\widehat{F}_{\mathbf{X}}^{*}=\inf_{w}\widehat{F}_{\mathbf{X}}(w)
f(w,x)=f^{0}(w,x)+f^{1}(w)
f^{0}
f^{0}(\cdot,x)
L
\mathcal{W}
f^{1}=\iota_{\mathcal{W}}+g
g\geq 0
\mathbb{R}^{d}
\beta
x\in\mathcal{X}
f^{1}
\iota_{\mathcal{W}}
\ell_{p}
\lambda\|w\|_{p}
p\in[1,\infty]
r
S_{r}
M=|S_{r}|\in[N]
|S_{r}|=M_{r}
M_{r}
M\approx N
r\in[R]
i\in S_{r}
\{x_{i,j}^{r}\}_{j=1}^{K:=\lfloor n/R\rfloor}
X_{i}
\widetilde{g}_{r}^{i}:=\frac{1}{K}\sum_{j=1}^{K}\nabla f^{0}(w_{r},x_{i,j}^{r}%
)+u_{i}
u_{i}\sim\mathcal{N}(0,\sigma^{2}\mathbf{I}_{d})
u_{i}
\widetilde{g}_{r}:=\frac{1}{M}\sum_{i\in S_{r}}\widetilde{g}_{r}^{i}
w_{r+1}:=\texttt{{prox}}_{\frac{1}{2\beta}f^{1}}(w_{r}-\frac{1}{2\beta}%
\widetilde{g}_{r})
f
\mu
\forall w\in\mathbb{R}^{d}
\displaystyle\small\mu\mathbb{E}[\widehat{F}_{\cal{S}}(w)-\inf_{w^{\prime}}%
\widehat{F}_{\cal{S}}(w^{\prime})]\leq-\beta\mathbb{E}\Bigg{[}\min_{y}\Big{[}%
\langle\nabla\widehat{F}_{\cal{S}}^{0}(w),y-w\rangle
\displaystyle\small\mu\mathbb{E}[\widehat{F}_{\cal{S}}(w)-\inf_{w^{\prime}}%
\widehat{F}_{\cal{S}}(w^{\prime})]
\displaystyle\leq-\beta\mathbb{E}\Bigg{[}\min_{y}\Big{[}\langle\nabla\widehat{%
F}_{\cal{S}}^{0}(w),y-w\rangle
\displaystyle\;\;+\frac{\beta}{2}\|y-w\|^{2}+f^{1}(y)-f^{1}(w)\Big{]}\Bigg{]},%
\vspace{-.02in}
\displaystyle\;\;+\frac{\beta}{2}\|y-w\|^{2}+f^{1}(y)-f^{1}(w)\Big{]}\Bigg{]},%
\vspace{-.02in}
\widehat{F}_{\cal{S}}(w):=\frac{1}{MK}\sum_{i\in S}\sum_{j=1}^{K}f(w,x_{i,j})
S\subseteq[N]
M
\mathcal{S}=\{x_{i,j}\}_{i\in S,j\in[K]}
x_{i,j}\sim\mathcal{D}_{i}
\kappa=\beta/\mu
\epsilon\leq\min\{8\ln(1/\delta),15\},\delta\in(0,1/2)
n\geq\widetilde{\Omega}(\kappa)
\sigma^{2}
K
(\epsilon,\delta)
R=\widetilde{\mathcal{O}}(\kappa)
\small\mathbb{E}F(w_{R})-F^{*}=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}%
\left(\frac{\kappa^{2}d\ln(1/\delta)}{\epsilon^{2}n^{2}M}+\frac{\kappa}{Mn}%
\right)\right).
(\epsilon,\delta)
M\geq N\min(\epsilon/2,1)
R=\widetilde{\mathcal{O}}(\kappa)
\small\mathbb{E}F(w_{R})-F^{*}=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}%
\left(\frac{\kappa^{2}d\ln^{2}(d/\delta)}{\epsilon^{2}n^{2}N^{2}}+\frac{\kappa%
}{Mn}\right)\right).
M=N
\widetilde{O}(\kappa^{2})
\kappa d\log^{2}(d/\delta)/\epsilon^{2}\lesssim nN
\widetilde{\mathcal{O}}(\kappa)
\widetilde{\mathcal{O}}(\kappa^{4})
C
C=\sqrt{R}=\widetilde{O}(\sqrt{\kappa})
\kappa d\ln(1/\delta)/\epsilon^{2}\lesssim n
\widetilde{\mathcal{O}}(\kappa)
\|\frac{1}{M}\sum_{i\in S_{r}}u_{i}\|^{2}
\mathbb{E}\|w_{r+1}-w_{r}\|^{2}
\mathbb{E}F(w_{r})-F^{*}
\mathbb{R}^{d}
w_{R}
F
\widehat{F}_{\mathbf{X}}
\mu>0
w\in\mathbb{R}^{d}
\displaystyle\mu[\widehat{F}_{\mathbf{X}}(w)-\inf_{w^{\prime}}\widehat{F}_{%
\mathbf{X}}(w^{\prime})]\leq-\beta\min_{y}\Big{[}\langle\nabla\widehat{F}_{%
\mathbf{X}}^{0}(w),y-w\rangle
\displaystyle\mu[\widehat{F}_{\mathbf{X}}(w)-\inf_{w^{\prime}}\widehat{F}_{%
\mathbf{X}}(w^{\prime})]
\displaystyle\leq-\beta\min_{y}\Big{[}\langle\nabla\widehat{F}_{\mathbf{X}}^{0%
}(w),y-w\rangle
\displaystyle\;\;\;+\frac{\beta}{2}\|y-w\|^{2}+\widehat{F}_{\mathbf{X}}^{1}(y)%
-\widehat{F}_{\mathbf{X}}^{1}(w)\Big{]}.
\displaystyle\;\;\;+\frac{\beta}{2}\|y-w\|^{2}+\widehat{F}_{\mathbf{X}}^{1}(y)%
-\widehat{F}_{\mathbf{X}}^{1}(w)\Big{]}.
(w_{0})
E\in\mathbb{N},K\in[n],Q:=\lfloor\frac{n}{K}\rfloor,\mathbf{X}\in\mathbb{X},%
\eta>0,\sigma_{1},\sigma_{2}\geq 0,\widebar{w}_{0}=w_{0}^{Q}=w_{0}\in\mathbb{R%
}^{d}
r\in\{0,1,\cdots,E-1\}
w^{0}_{r+1}=w^{Q}_{r}
i\in S_{r}
w_{r}
i
i
u^{i}_{1}\sim\mathcal{N}(0,\sigma_{1}^{2}\mathbf{I}_{d})
\widetilde{g}_{r+1}^{i}:=\nabla\widehat{F}_{i}^{0}(\widebar{w}_{r})+u^{i}_{1}
t\in\{0,1,\cdots Q-1\}
i
K
x_{i,j}^{r+1,t}
X_{i}
j\in[K]
u^{i}_{2}\sim\mathcal{N}(0,\sigma_{2}^{2}\mathbf{I}_{d})
i
\widetilde{v}_{r+1}^{t,i}=\frac{1}{K}\sum_{j=1}^{K}[\nabla f^{0}(w_{r+1}^{t},x%
_{i,j}^{r+1,t})-\nabla f^{0}(\widebar{w}_{r},x_{i,j}^{r+1,t})]+\widetilde{g}_{%
r+1}^{i}+u_{2}^{i}
\widetilde{v}_{r+1}^{t}=\frac{1}{M}\sum_{i\in S_{r+1}}\widetilde{v}_{r+1}^{t,i}
w_{r+1}^{t+1}:=\texttt{{prox}}_{\eta f^{1}}(w_{r+1}^{t}-\eta\widetilde{v}_{r+1%
}^{t})
\widebar{w}_{r+1}=w_{r+1}^{Q}
w_{\text{priv}}\sim\text{Unif}(\{w_{r+1}^{t}\}_{r=0,\cdots,E-1;t=0,\cdots Q-1})
E\in\mathbb{N},K\in[n],Q:=\lfloor\frac{n}{K}\rfloor,\mathbf{X}\in\mathbb{X},%
\eta>0,\sigma_{1},\sigma_{2}\geq 0,\widebar{w}_{0}=w_{0}^{Q}=w_{0}\in\mathbb{R%
}^{d}
s\in[S]
w_{s}=\texttt{ISRL-DP FedProx-SVRG}(w_{s-1})
w_{\text{priv}}:=w_{S}
i
w_{r+1}^{t}
\widebar{w}_{r}
\ell_{2}
\sigma_{2}^{2}>\sigma_{1}^{2}
S
\epsilon\leq\min\{15,2\ln(2/\delta)\},\delta\in(0,1/2)
M=N
\mathbf{X}\in\mathcal{X}^{n}
\kappa=\beta/\mu
\widetilde{\mathcal{O}}(\kappa)
(\epsilon,\delta)
\small\mathbb{E}\widehat{F}_{\small\mathbf{X}\normalsize}(w_{\text{priv}})-%
\widehat{F}_{\small\mathbf{X}\normalsize}^{*}=\widetilde{\mathcal{O}}\left(%
\kappa\frac{L^{2}d\ln(1/\delta)}{\mu\epsilon^{2}n^{2}N}\right).
(\epsilon,\delta)
\mathbb{E}\widehat{F}_{\small\mathbf{X}\normalsize}(w_{\text{priv}})-\widehat{%
F}_{\small\mathbf{X}\normalsize}^{*}=\widetilde{\mathcal{O}}\left(\kappa\frac{%
L^{2}d\ln(1/\delta)}{\mu\epsilon^{2}n^{2}N^{2}}\right).
\mathcal{A}
M<N
f^{1}=\iota_{\mathcal{W}})
\widetilde{\mathcal{O}}(\kappa)
f
\widehat{\mathcal{G}}_{\eta}(w,\mathbf{X}):=\frac{1}{\eta}[w-\texttt{{prox}}_{%
\eta f^{1}}(w-\eta\nabla\widehat{F}_{\mathbf{X}}^{0}(w))]
\|\widehat{\mathcal{G}}_{\eta}(w,\mathbf{X})\|
\|\nabla\widehat{F}_{\mathbf{X}}(w)\|
R\in\mathbb{N},K_{1},K_{2}\in[n],\mathbf{X}\in\mathbb{X},\eta>0,\sigma_{1}^{2}%
,\sigma_{2}^{2},\hat{\sigma}_{2}^{2}\geq 0,q\in\mathbb{N},w_{0}\in\mathcal{W}
r\in\{0,1,\cdots,R\}
i\in S_{r}
w_{r}
i
r\equiv 0~{}(\text{mod}~{}q)
i
K_{1}
\{x_{i,j}^{r}\}_{j=1}^{K_{1}}
X_{i}
u_{1}^{i}\sim\mathcal{N}(0,\sigma_{1}^{2}\mathbf{I}_{d})
i
h_{r}^{i}=\frac{1}{K_{1}}\sum_{j=1}^{K_{1}}\nabla f^{0}(w_{r},x_{i,j}^{r})+u_{%
1}^{i}
h_{r}=\frac{1}{M_{r}}\sum_{i\in S_{r}}h_{r}^{i}
i
K_{2}
\{x_{i,j}^{r}\}_{j=1}^{K_{1}}
X_{i}
u_{2}^{i}\sim\mathcal{N}(0,\mathbf{I}_{d}\min\{\sigma_{2}^{2}\|w_{r}-w_{r-1}\|%
^{2},\hat{\sigma}_{2}^{2}\})
i
H_{r}^{i}=\frac{1}{K_{2}}\sum_{j=1}^{K_{2}}[\nabla f^{0}(w_{r},x_{i,j}^{r})-%
\nabla f^{0}(w_{r-1},x_{i,j}^{r})]+u_{2}^{i}
H_{r}=\frac{1}{M_{r}}\sum_{i\in S_{r}}H_{r}^{i}
h_{r}=h_{r-1}+H_{r}
w_{r+1}=\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta h_{r})
w_{\text{priv}}\sim\text{Unif}(\{w_{r}\}_{r=1,\cdots,R})
\sigma_{2}^{2}=\frac{16\beta^{2}R\ln(1/\delta)}{\epsilon^{2}n^{2}}
\eta,\sigma_{1}^{2},\hat{\sigma}_{2}^{2},q,R
M=N
\epsilon\leq 2\ln(1/\delta)
(\epsilon,\delta)
M=N
\small\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},\mathbf{X})\|^{%
2}\lesssim\left(\frac{\sqrt{L\beta\hat{\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{%
\epsilon n\sqrt{N}}\right)^{4/3}+\frac{L^{2}d\ln(1/\delta)}{\epsilon^{2}n^{2}N%
}.\normalsize\vspace{-.2cm}
M\leq N
f^{1}\neq 0
N=1
f^{1}=\iota_{\mathcal{W}}
f^{1}
N>1
\beta\|w_{t}-w_{t-1}\|
t
\beta
f^{0}
M=N
\epsilon\leq\ln(1/\delta),~{}\delta\in(0,\frac{1}{2})
(\epsilon,\delta)
\displaystyle\small\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},%
\mathbf{X})\|^{2}=\widetilde{\mathcal{O}}\Bigg{(}\left[\frac{\sqrt{L\beta\hat{%
\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{\epsilon nN}\right]^{4/3}
\displaystyle\small\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},%
\mathbf{X})\|^{2}
\displaystyle=\widetilde{\mathcal{O}}\Bigg{(}\left[\frac{\sqrt{L\beta\hat{%
\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{\epsilon nN}\right]^{4/3}
\displaystyle\;\;\;\;+\frac{dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\Bigg{%
)}.\normalsize\vspace{-.2cm}
\displaystyle\;\;\;\;+\frac{dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\Bigg{%
)}.\normalsize\vspace{-.2cm}
\mathcal{O}(\sqrt{d}/\epsilon nN)
\epsilon\lesssim 1
2^{-\Omega(nN)}\leq\delta\leq 1/(nN)^{1+\Omega(1)}
L
\beta
f:\mathbb{R}^{d}\times\mathcal{X}\to\mathbb{R}
\mathbf{X}\in\mathcal{X}^{n\times N}
(\epsilon,\delta)
\mathcal{A}
\vspace{-.16cm}\small\mathbb{E}\|\nabla\widehat{F}_{\mathbf{X}}(\mathcal{A}(%
\mathbf{X}))\|^{2}=\Omega\left(L^{2}\min\left\{1,\frac{d\ln(1/\delta)}{%
\epsilon^{2}n^{2}N}\right\}\right).
(\epsilon,\delta)
\small\mathbb{E}\|\nabla\widehat{F}_{\mathbf{X}}(\mathcal{A}(\mathbf{X}))\|^{2%
}=\Omega\left(L^{2}\min\left\{1,\frac{d\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}%
\right\}\right).\vspace{-.2cm}
M=N
\epsilon=0.75
\epsilon=18
\delta=1/n^{2}
q=1
q=1
\epsilon
\epsilon
N=25
M=25,R=25
M=25,R=25
M=12,R=50
M=12,R=50
N=10
M=10,R=50
M=10,R=50
M=10,R=100
M=10,R=100
N=2
M=2,R=25
M=2,R=25
\mathcal{A}
R
r\in[R]
i
Z_{r}^{(i)}\in\mathcal{Z}
Z_{r}^{(i)}
i
Z^{(i)}_{r}:=\mathcal{R}^{(i)}_{r}(\mathbf{Z}_{1:r-1},X_{i})
\mathbf{Z}_{1:r-1}:=\{Z_{t}^{(j)}\}_{j\in[N],t\in[r-1]}
\mathcal{A}
\mathcal{R}^{(i)}_{r}:\mathcal{Z}^{(r-1)\times N}\times\mathcal{X}^{n_{i}}\to%
\mathcal{Z}
i\in[N],~{}r\in[R]
\mathcal{R}^{(i)}_{r}(\mathbf{Z}_{1:r-1},X_{i})
X_{j}
j\neq i
\mathbf{Z}_{1:r-1}
X_{i}
\mathcal{R}^{(i)}_{r}
\mathbf{Z}_{1:r-1}
X_{i}
i
Z^{(i)}_{r}
i
r
\mathcal{A}
(\epsilon,\delta)
i\in[N]
i
R
\{Z^{(i)}_{r}\}_{r\in[R]}
(\epsilon,\delta)
\mathcal{A}(\mathbf{X})\underset{(\epsilon,\delta)}{\simeq}\mathcal{A}(\mathbf%
{X}^{\prime})
S
\rho_{i}:\mathcal{X}^{2}\to[0,\infty)
\rho_{i}(X_{i},X^{\prime}_{i}):=\sum_{j=1}^{n}\mathds{1}_{\{x_{i,j}\neq x_{i,j%
}^{\prime}\}}
i\in[N]
\mathcal{A}:\mathcal{X}_{1}^{n}\times\cdots\times\mathcal{X}_{N}^{n}\to%
\mathcal{Z}^{R\times N}
(\epsilon,\delta)
i\in[N]
\rho_{i}
X_{i},X_{i}^{\prime}\in\mathcal{X}^{n}
\small(\mathcal{R}^{(i)}_{1}(X_{i}),\mathcal{R}^{(i)}_{2}(\mathbf{Z}_{1},X_{i}%
),\cdots,\mathcal{R}^{(i)}_{R}(\mathbf{Z}_{1:R-1},X_{i}))\underset{(\epsilon,%
\delta)}{\simeq}(\mathcal{R}^{(i)}_{1}(X^{\prime}_{i}),\mathcal{R}^{(i)}_{2}(%
\mathbf{Z}^{\prime}_{1},X^{\prime}_{i}),\cdots,\mathcal{R}^{(i)}_{R}(\mathbf{Z%
}^{\prime}_{1:R-1},X^{\prime}_{i})),
\mathbf{Z}_{r}:=\{\mathcal{R}^{(i)}_{r}(\mathbf{Z}_{1:r-1},X_{i})\}_{i=1}^{N}
\mathbf{Z}^{\prime}_{r}:=\{\mathcal{R}^{(i)}_{r}(\mathbf{Z}^{\prime}_{1:r-1},X%
_{i}^{\prime})\}_{i=1}^{N}
\mathcal{A}
(\epsilon,\delta)
\mathcal{A}
(\epsilon,\delta)
\mathcal{A}
(n\epsilon,ne^{(n-1)\epsilon}\delta)
\epsilon_{0}\lesssim 1/n
\delta_{0}=o(1/n^{2})
(\epsilon_{0},\delta_{0})
(\epsilon,\delta)
\epsilon\lesssim 1
\mathbb{R}^{d}
L
L
\mathbb{R}^{d}
L<+\infty
\mathbb{E}\|\nabla\widehat{F}_{\mathbf{X}}(w_{\text{priv}})\|^{2}\lesssim\left%
(\frac{\sqrt{d}}{\epsilon nN}\right)
M=N
M<N
M\in[N]
N>n
\sigma^{2}\approx TKL^{2}\log(1/\delta)/nN\epsilon^{2}
N
\eta=\frac{\sqrt{N}}{\sqrt{T}}
T=RK
\mathbb{E}\|\nabla\widehat{F}(\widehat{w}_{R})\|^{2}=\widetilde{O}\left(\frac{%
d\sqrt{NT}K}{\epsilon^{2}nN}+\frac{NK^{2}}{T}+\frac{\sqrt{N}}{\sqrt{T}}+\frac{%
dK^{2}}{\epsilon^{2}n}\right)
T
T
K
R\geq T_{\min}^{\text{nc}}
T_{\min}^{\text{nc}}
\frac{d\sigma^{2}}{R^{1/3}}\approx\frac{dR^{2/3}}{\epsilon^{2}n^{2}}
R
R
T
N=1
\mathbb{E}\|\nabla\widehat{F}_{\mathbf{X}}(w_{\text{priv}})\|^{2}=\mathcal{O}%
\left(\frac{\sqrt{d\ln(1/\delta)}}{\epsilon n}\right)^{4/3}
(\epsilon,\delta)
\epsilon\leq 1
(\epsilon,\delta)
\mathcal{A}:\mathcal{X}^{n}\to\mathcal{W}
\rho
\rho
X,X^{\prime}\in\mathcal{X}^{n}
d_{\text{hamming}}(X,X^{\prime})=1
\alpha\in(1,\infty)
D_{\alpha}(\mathcal{A}(X)||\mathcal{A}(X^{\prime}))\leq\rho\alpha,
D_{\alpha}(\mathcal{A}(X)||\mathcal{A}(X^{\prime}))
\alpha
P
Q
p
q
D_{\alpha}(P||Q):=\frac{1}{\alpha-1}\ln\left(\int p(x)^{\alpha}q(x)^{1-\alpha}%
dx\right)
\mathcal{A}(X)
\mathcal{A}(X^{\prime})
\mathcal{A}
\rho
\mathcal{A}
(\rho+2\sqrt{\rho\log(1/\delta)},\delta)
\delta>0
\epsilon\leq 2\ln(1/\delta)
\frac{\epsilon^{2}}{8\ln(1/\delta)}
(\epsilon,\delta)
q:\mathcal{X}^{n}\to\mathbb{R}
\ell_{2}
\Delta:=\sup_{X\sim X^{\prime}}\|q(X)-q(X^{\prime})\|
\mathcal{M}:\mathcal{X}^{n}\to\mathbb{R}
\mathcal{M}(X):=q(X)+u
u\sim\mathcal{N}(0,\sigma^{2})
\rho
\sigma^{2}\geq\frac{\Delta^{2}}{2\rho}
\epsilon\leq 2\ln(1/\delta)
\sigma^{2}\geq\frac{4\Delta^{2}\ln(1/\delta)}{\epsilon^{2}}
\mathcal{M}
(\epsilon,\delta)
\epsilon\geq\ 0,\delta,\delta^{\prime}\in[0,1)
\mathcal{A}_{1},\cdots,\mathcal{A}_{R}
\mathcal{A}_{r}:\mathcal{X}^{n}\times\mathcal{W}\to\mathcal{W}
(\epsilon,\delta)
\forall r=1,\cdots,R
\mathcal{A}(X):=\mathcal{A}_{R}(X,\mathcal{A}_{R-1}(X,\mathcal{A}_{R-2}(X,%
\cdots)))
(\epsilon^{\prime},R\delta+\delta^{\prime})
\epsilon^{\prime}=\sqrt{2R\ln(1/\delta^{\prime})}\epsilon+R\epsilon(e^{%
\epsilon}-1)
\mathcal{A}:\mathcal{X}^{n}\to\mathcal{Y}
\rho
\mathcal{A}^{\prime}:\mathcal{X}^{n}\times\mathcal{Y}\to\mathcal{Z}
\rho^{\prime}
\mathcal{A}
\mathcal{A}^{\prime}
\mathcal{A}^{\prime\prime}:\mathcal{X}^{n}\to\mathcal{Z}
\mathcal{A}^{\prime\prime}(X)=\mathcal{A}^{\prime}(X,\mathcal{A}(X))
\mathcal{A}^{\prime\prime}
(\rho+\rho^{\prime})
T
\rho
T\rho
\mathcal{P}_{\text{vec}}
\mathcal{R}
\mathcal{A}
\mathcal{S}(\mathbf{y})
\mathbf{y}
\mathbf{y}
\mathbf{y}
\mathcal{P}_{\text{1D}}
X=(x_{1},\cdots x_{N})\in[0,L]^{N}
g,b\in\mathbb{N};p\in(0,\frac{1}{2})
\mathcal{R}_{1D}(x_{i})
\widebar{x}_{i}\leftarrow\lfloor x_{i}g/L\rfloor
\eta_{1}\sim\textbf{Ber}(x_{i}g/L-\widebar{x}_{i})
\hat{x}_{i}\leftarrow\widebar{x}_{i}+\eta_{1}
\eta_{2}\sim\textbf{Bin}(b,p)
\mathbf{y}_{i}\in\{0,1\}^{g+b}
\hat{x}_{i}+\eta_{2}
1
g+b-(\hat{x}_{i}+\eta_{2})
0
\mathcal{A}_{\text{1D}}(\mathcal{S}(\mathbf{y}))
\frac{L}{g}((\sum_{i=1}^{N}\sum_{j=1}^{b+g}(\mathbf{y}_{i})_{j})-pbn)
d
\mathbf{y}
Nd
N
\mathbf{y}_{j}
N
j
j\in[d]
\mathcal{P}_{\text{vec}}
d
\mathbf{X}=(\mathbf{x}_{1},\cdots,\mathbf{x}_{N}
\epsilon,\delta
L
\mathcal{R}_{\text{vec}}(\mathbf{x}_{i})
j\in[d]
\mathbf{w}_{i,j}\leftarrow\mathbf{x}_{i,j}+L
\mathbf{m}_{j}\leftarrow\mathcal{R}_{1D}(\mathbf{w}_{i,j})
\{(j,\mathbf{m}_{j})\}_{j\in[d]}
\mathcal{A}_{\text{vec}}(\mathbf{y})
j\in[d]
j
z_{j}\leftarrow\mathcal{A}_{\text{1D}}(\mathbf{y}_{j})
o_{j}\leftarrow z_{j}-L
\mathbf{o}=(o_{1},\cdots o_{d})
M_{r}=M
K
N=MK
x_{i}
K
\mathcal{R}_{\text{vec}}
\mathcal{R}_{\text{vec}}(\mathbf{x}_{i})
\mathcal{R}_{\text{vec}}(\mathbf{x}_{1}),\cdots\mathcal{R}_{\text{vec}}(%
\mathbf{x}_{M})
\mathcal{A}_{\text{vec}}
\frac{1}{M}\mathbf{o}
\mathbf{X}
\mathcal{P}_{\text{vec}}(\mathbf{X}):=\mathcal{P}_{\text{vec}}(\mathbf{X};%
\epsilon,\delta;L)
0<\epsilon\leq 15,0<\delta<1/2,d,N\in\mathbb{N}
L>0
b,g\in\mathbb{N}
p\in(0,1/2)
\mathcal{P}_{\text{1D}}
\mathbf{X}=(\mathbf{x}_{1},\cdots\mathbf{x}_{N})
\max_{i\in[N]}\|\mathbf{x}_{i}\|\leq L
\mathcal{P}_{\text{vec}}
(\epsilon,\delta)
\mathcal{P}_{\text{vec}}(\mathbf{X})
\sum_{i=1}^{N}\mathbf{x}_{i}
\mathbb{E}\left[\left\|\mathcal{P}_{\text{vec}}(\mathbf{X};\epsilon,\delta;L)-%
\sum_{i=1}^{N}\mathbf{x}_{i}\right\|^{2}\right]=\mathcal{O}\left(\frac{dL^{2}%
\log^{2}\left(\frac{d}{\delta}\right)}{\epsilon^{2}}\right).
R\in\mathbb{N},X_{i}\in\mathcal{X}^{n}(i\in[N]),\sigma^{2}\geq 0,K\leq\frac{n}%
{R},w_{0}\in\mathbb{R}^{d}
r\in\{0,1,\cdots,R-1\}
i\in S_{r}
w_{r}
i
i
\{x_{i,j}^{r}\}_{j=1}^{K}
X_{i}
u_{i}\sim\mathcal{N}(0,\sigma^{2}\mathbf{I}_{d}).
i
\widetilde{g}_{r}^{i}:=\frac{1}{K}\sum_{j=1}^{K}\nabla f^{0}(w_{r},x_{i,j}^{r}%
)+u_{i}
\widetilde{g}_{r}:=\frac{1}{M_{r}}\sum_{i\in S_{r}}\widetilde{g}_{r}^{i}
w_{r+1}:=\texttt{{prox}}_{\frac{1}{2\beta}f^{1}}(w_{r}-\frac{1}{2\beta}%
\widetilde{g}_{r})
w_{R}
R\in\mathbb{N}
X_{i}\in\mathcal{X}^{n_{i}}
i\in[N]
f(w,x)=f^{0}(w,x)+f^{1}(w,x)
\epsilon,\delta
K\leq\frac{n}{R}
w_{0}\in\mathbb{R}^{d}
r\in\{0,1,\cdots,R-1\}
i\in S_{r}
w_{r}
i
i
K
\{x_{i,j}^{r}\}_{j=1}^{K}
X_{i}
\{\nabla f^{0}(w_{r},x_{i,j}^{r})\}_{j\in[K]}
\widetilde{g}_{r}:=\frac{1}{M_{r}K}\mathcal{P}_{\text{vec}}(\{\nabla f^{0}(w_{%
r},x_{i,j}^{r})\}_{i\in S_{r},j\in[K]};\frac{N}{2M}\epsilon,\delta;L)
w_{r+1}:=\texttt{{prox}}_{\frac{1}{2\beta}f^{1}}(w_{r}-\frac{1}{\beta}%
\widetilde{g}_{r})
w_{R}
M_{r}=M
K=\lfloor\frac{n}{R}\rfloor
R
\epsilon\leq\min\{8\ln(1/\delta),15\},\delta\in(0,1/2)
n\geq\widetilde{\Omega}(\kappa)
\sigma^{2}
(\epsilon,\delta)
\small\mathbb{E}F(w_{R})-F^{*}=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}%
\left(\frac{\kappa^{2}d\ln(1/\delta)}{\epsilon^{2}n^{2}M}+\frac{\kappa}{Mn}%
\right)\right)
R=\left\lceil 2\kappa\ln\left(\frac{\mu\Delta}{L^{2}}\min\left\{Mn,\frac{%
\epsilon^{2}n^{2}M}{d\ln(1/\delta)}\right\}\right)\right\rceil
\Delta\geq F(w_{0})-F^{*}
(\epsilon,\delta)
M\geq N\min(\epsilon/2,1)
\small\mathbb{E}F(w_{R})-F^{*}=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}%
\left(\frac{\kappa^{2}d\ln^{2}(d/\delta)}{\epsilon^{2}n^{2}N^{2}}+\frac{\kappa%
}{Mn}\right)\right)
R=\left\lceil 2\kappa\ln\left(\frac{\mu\Delta}{L^{2}}\min\left\{Mn,\frac{%
\epsilon^{2}n^{2}N^{2}}{d\ln(1/\delta)}\right\}\right)\right\rceil
i
i\in[N]
i
(\epsilon,\delta)
\widetilde{g}_{r}^{i}
(\epsilon,\delta)
\ell_{2}
\Delta_{2}:=\sup_{|X_{i}\Delta X^{\prime}_{i}|\leq 2,w\in\mathcal{W}}\|\frac{1%
}{K}\sum_{j=1}^{K}\nabla f(w,x_{i,j})-\nabla f(w,x^{\prime}_{i,j})\|\leq 2L/K,
L
f.
\widetilde{g}_{r}^{i}
(\epsilon,\delta)
\sigma^{2}\geq\frac{8L^{2}\ln(1/\delta)}{\epsilon^{2}K^{2}}
(\epsilon,\delta)
F
r
\widehat{F}_{r}(w):=\frac{1}{MK}\sum_{i\in S_{r}}\sum_{j=1}^{K}f(w,x_{i,j}^{r})
\widebar{u}_{r}:=\frac{1}{M}\sum_{i\in S_{r}}u_{i}\sim\mathcal{N}(0,\frac{%
\sigma^{2}}{M}\mathbf{I}_{d})
\beta
\displaystyle\mathbb{E}F(w_{r+1})=\mathbb{E}\left[F^{0}(w_{r+1})+f^{1}(w_{r})+%
f^{1}(w_{r+1})-f^{1}(w_{r})\right]
\displaystyle\mathbb{E}F(w_{r+1})
\displaystyle=\mathbb{E}\left[F^{0}(w_{r+1})+f^{1}(w_{r})+f^{1}(w_{r+1})-f^{1}%
(w_{r})\right]
\displaystyle\leq\mathbb{E}F(w_{r})+\mathbb{E}\left[\langle\nabla\widehat{F}_{%
r}^{0}(w_{r}),w_{r+1}-w_{r}\rangle+\frac{\beta}{2}\|w_{r+1}-w_{r}\|^{2}+f^{1}(%
w_{r+1})-f^{1}(w_{r})+\langle\widebar{u}_{r},w_{r+1}\rangle\right]
\displaystyle\leq\mathbb{E}F(w_{r})+\mathbb{E}\left[\langle\nabla\widehat{F}_{%
r}^{0}(w_{r}),w_{r+1}-w_{r}\rangle+\frac{\beta}{2}\|w_{r+1}-w_{r}\|^{2}+f^{1}(%
w_{r+1})-f^{1}(w_{r})+\langle\widebar{u}_{r},w_{r+1}\rangle\right]
\displaystyle\;\;\;+\mathbb{E}\langle\nabla F^{0}(w_{r})-\nabla\widehat{F}_{r}%
^{0}(w_{r}),w_{r+1}-w_{r}\rangle-\mathbb{E}\langle\widebar{u}_{r},w_{r+1}\rangle
\displaystyle\;\;\;+\mathbb{E}\langle\nabla F^{0}(w_{r})-\nabla\widehat{F}_{r}%
^{0}(w_{r}),w_{r+1}-w_{r}\rangle-\mathbb{E}\langle\widebar{u}_{r},w_{r+1}\rangle
\displaystyle\leq\mathbb{E}F(w_{r})+\mathbb{E}\left[\langle\nabla\widehat{F}_{%
r}^{0}(w_{r}),w_{r+1}-w_{r}\rangle+\beta\|w_{r+1}-w_{r}\|^{2}+f^{1}(w_{r+1})-f%
^{1}(w_{r})+\langle\widebar{u}_{r},w_{r+1}\rangle\right]
\displaystyle\leq\mathbb{E}F(w_{r})+\mathbb{E}\left[\langle\nabla\widehat{F}_{%
r}^{0}(w_{r}),w_{r+1}-w_{r}\rangle+\beta\|w_{r+1}-w_{r}\|^{2}+f^{1}(w_{r+1})-f%
^{1}(w_{r})+\langle\widebar{u}_{r},w_{r+1}\rangle\right]
\displaystyle\;\;\;-\langle\widebar{u}_{r},w_{r+1}\rangle+\mathbb{E}\left[%
\frac{1}{2\beta}\|\nabla F^{0}(w_{r})-\nabla\widehat{F}^{0}_{r}(w_{r})\|^{2}%
\right],
\displaystyle\;\;\;-\langle\widebar{u}_{r},w_{r+1}\rangle+\mathbb{E}\left[%
\frac{1}{2\beta}\|\nabla F^{0}(w_{r})-\nabla\widehat{F}^{0}_{r}(w_{r})\|^{2}%
\right],
\displaystyle\mathbb{E}\langle\nabla F^{0}(w_{r})-\nabla\widehat{F}_{r}^{0}(w_%
{r}),w_{r+1}-w_{r}\rangle\leq\underbrace{\mathbb{E}\left[\frac{1}{2\beta}\|%
\nabla F^{0}(w_{r})-\nabla\widehat{F}^{0}_{r}(w_{r})\|^{2}\right]}_{ⓐ}+\mathbb%
{E}\left[\frac{\beta}{2}\|w_{r+1}-w_{r}\|^{2}\right]
\displaystyle\mathbb{E}\langle\nabla F^{0}(w_{r})-\nabla\widehat{F}_{r}^{0}(w_%
{r}),w_{r+1}-w_{r}\rangle
\displaystyle\leq\underbrace{\mathbb{E}\left[\frac{1}{2\beta}\|\nabla F^{0}(w_%
{r})-\nabla\widehat{F}^{0}_{r}(w_{r})\|^{2}\right]}_{ⓐ}+\mathbb{E}\left[\frac{%
\beta}{2}\|w_{r+1}-w_{r}\|^{2}\right]
\displaystyle\mathbb{E}\left[\frac{1}{2\beta}\left\|\nabla F^{0}(w_{r})-\nabla%
\widehat{F}^{0}_{r}(w_{r})\right\|^{2}\right]=\frac{1}{2\beta}\mathbb{E}\left%
\|\frac{1}{MK}\sum_{i\in S_{r}}\sum_{j=1}^{K}\nabla F^{0}(w_{r})-\nabla f^{0}(%
w_{r},x_{i,j}^{r})\right\|^{2}
\displaystyle\mathbb{E}\left[\frac{1}{2\beta}\left\|\nabla F^{0}(w_{r})-\nabla%
\widehat{F}^{0}_{r}(w_{r})\right\|^{2}\right]
\displaystyle=\frac{1}{2\beta}\mathbb{E}\left\|\frac{1}{MK}\sum_{i\in S_{r}}%
\sum_{j=1}^{K}\nabla F^{0}(w_{r})-\nabla f^{0}(w_{r},x_{i,j}^{r})\right\|^{2}
\displaystyle=\frac{1}{2\beta M^{2}K^{2}}\sum_{i\in S_{r}}\sum_{j=1}^{K}%
\mathbb{E}\|\nabla F^{0}(w_{r})-\nabla f^{0}(w_{r},x_{i,j}^{r})\|^{2}
\displaystyle=\frac{1}{2\beta M^{2}K^{2}}\sum_{i\in S_{r}}\sum_{j=1}^{K}%
\mathbb{E}\|\nabla F^{0}(w_{r})-\nabla f^{0}(w_{r},x_{i,j}^{r})\|^{2}
\displaystyle\leq\frac{L^{2}}{\beta MK},
\displaystyle\leq\frac{L^{2}}{\beta MK},
L
f^{0}
\mathbb{E}\left[\langle\nabla\widehat{F}_{r}^{0}(w_{r}),w_{r+1}-w_{r}\rangle+%
\beta\|w_{r+1}-w_{r}\|^{2}+f^{1}(w_{r+1})-f^{1}(w_{r})+\langle\widebar{u}_{r},%
w_{r+1}\rangle\right]
H^{\text{priv}}_{r}(y):=\langle\widehat{F}_{r}^{0}(w_{r}),y-w_{r}\rangle+\beta%
\|y-w_{r}\|^{2}+f^{1}(y)-f^{1}(w_{r})+\langle\widebar{u}_{r},y\rangle
H_{r}(y):=\langle\nabla\widehat{F}_{r}^{0}(w_{r}),y-w_{r}\rangle+\beta\|y-w_{r%
}\|^{2}+f^{1}(y)-f^{1}(w_{r})
H_{r}
H^{\text{priv}}_{r}
2\beta
y_{*}
y_{*}^{\text{priv}}
w_{r},S_{r}
\widebar{u}_{r}
H_{r}(y_{*}^{\text{priv}})-H_{r}(y_{*})\leq\frac{\|\widebar{u}_{r}\|^{2}}{2%
\beta}.
H(y),h(y)
\mathcal{Y}\subseteq\mathbb{R}^{d}
H(w)
2\beta
h
L_{h}
y_{1}=\arg\min_{y\in\mathcal{Y}}H(y)
y_{2}=\arg\min_{y\in\mathcal{Y}}[H(y)+h(y)]
\|y_{1}-y_{2}\|_{2}\leq\frac{L_{h}}{2\beta}.
H(y):=H_{r}(y),~{}h(y):=\langle\widebar{u}_{r},y\rangle
L_{h}=\|\widebar{u}_{r}\|
y_{1}=y_{*}
y_{2}=y_{*}^{\text{priv}}
\|y_{*}-y_{*}^{\text{priv}}\|\leq\frac{\|\widebar{u}_{r}\|}{2\beta}.
H_{r}^{\text{priv}}(y_{*}^{\text{priv}})=H_{r}(y_{*}^{\text{priv}})+\langle%
\widebar{u}_{r},y_{*}^{\text{priv}}\rangle\leq H_{r}^{\text{priv}}(y_{*})=H_{r%
}(y_{*})+\langle\widebar{u}_{r},y_{*}\rangle.
\displaystyle H_{r}(y_{*}^{\text{priv}})-H_{r}(y_{*})\leq\langle\widebar{u}_{r%
},y_{*}-y_{*}^{\text{priv}}\rangle
\displaystyle H_{r}(y_{*}^{\text{priv}})-H_{r}(y_{*})
\displaystyle\leq\langle\widebar{u}_{r},y_{*}-y_{*}^{\text{priv}}\rangle
\displaystyle\leq\|\widebar{u}_{r}\|\|y_{*}-y_{*}^{\text{priv}}\|
\displaystyle\leq\|\widebar{u}_{r}\|\|y_{*}-y_{*}^{\text{priv}}\|
\displaystyle\leq\frac{\|\widebar{u}_{r}\|^{2}}{\beta},
\displaystyle\leq\frac{\|\widebar{u}_{r}\|^{2}}{\beta},
w_{r+1}=y_{*}^{\text{priv}}
\displaystyle\mathbb{E}H_{r}(y_{*})=\mathbb{E}\min_{y}\left[\langle\nabla%
\widehat{F}_{r}^{0}(w_{r}),y-w_{r}\rangle+\beta\|y-w_{r}\|^{2}+f^{1}(y)-f^{1}(%
w_{r})\right]
\displaystyle\mathbb{E}H_{r}(y_{*})
\displaystyle=\mathbb{E}\min_{y}\left[\langle\nabla\widehat{F}_{r}^{0}(w_{r}),%
y-w_{r}\rangle+\beta\|y-w_{r}\|^{2}+f^{1}(y)-f^{1}(w_{r})\right]
\displaystyle\leq-\frac{\mu}{2\beta}\mathbb{E}[\widehat{F}_{r}(w_{r})-\min_{w}%
\widehat{F}_{r}(w)]\leq-\frac{\mu}{2\beta}[F(w_{r})-F^{*}].
\displaystyle\leq-\frac{\mu}{2\beta}\mathbb{E}[\widehat{F}_{r}(w_{r})-\min_{w}%
\widehat{F}_{r}(w)]\leq-\frac{\mu}{2\beta}[F(w_{r})-F^{*}].
\displaystyle\mathbb{E}\left[\langle\nabla\widehat{F}_{r}^{0}(w_{r}),w_{r+1}-w%
_{r}\rangle+\beta\|w_{r+1}-w_{r}\|^{2}+f^{1}(w_{r+1})-f^{1}(w_{r})+\langle%
\widebar{u}_{r},w_{r+1}\rangle\right]
\displaystyle\mathbb{E}\left[\langle\nabla\widehat{F}_{r}^{0}(w_{r}),w_{r+1}-w%
_{r}\rangle+\beta\|w_{r+1}-w_{r}\|^{2}+f^{1}(w_{r+1})-f^{1}(w_{r})+\langle%
\widebar{u}_{r},w_{r+1}\rangle\right]
\displaystyle=\mathbb{E}H_{r}^{\text{priv}}(y_{*}^{\text{priv}})
\displaystyle=\mathbb{E}H_{r}^{\text{priv}}(y_{*}^{\text{priv}})
\displaystyle=\mathbb{E}H_{r}(y_{*}^{\text{priv}})+\mathbb{E}\langle\widebar{u%
}_{r},w_{r+1}\rangle
\displaystyle=\mathbb{E}H_{r}(y_{*}^{\text{priv}})+\mathbb{E}\langle\widebar{u%
}_{r},w_{r+1}\rangle
\displaystyle\leq\mathbb{E}H_{r}(y_{*})+\frac{d\sigma^{2}}{\beta M}+\mathbb{E}%
\langle\widebar{u}_{r},w_{r+1}\rangle
\displaystyle\leq\mathbb{E}H_{r}(y_{*})+\frac{d\sigma^{2}}{\beta M}+\mathbb{E}%
\langle\widebar{u}_{r},w_{r+1}\rangle
\displaystyle\leq-\mathbb{E}\frac{\mu}{2\beta}[F(w_{r})-F^{*}]+\frac{d\sigma^{%
2}}{\beta M}+\mathbb{E}\langle\widebar{u}_{r},w_{r+1}\rangle.
\displaystyle\leq-\mathbb{E}\frac{\mu}{2\beta}[F(w_{r})-F^{*}]+\frac{d\sigma^{%
2}}{\beta M}+\mathbb{E}\langle\widebar{u}_{r},w_{r+1}\rangle.
\mathbb{E}F(w_{r+1})\leq\mathbb{E}F(w_{r})-\frac{\mu}{2\beta}\mathbb{E}[F(w_{r%
})-F^{*}]+\frac{2d\sigma^{2}}{\beta M}+\frac{2L^{2}}{\beta MK},
\mathbb{E}[F(w_{r+1})-F^{*}]\leq\mathbb{E}[F(w_{r})-F^{*}]\left(1-\frac{\mu}{2%
\beta}\right)+\frac{2d\sigma^{2}}{\beta M}+\frac{2L^{2}}{\beta MK}.
\sigma^{2}
\mathbb{E}[F(w_{R})-F^{*}]\leq\Delta\left(1-\frac{\mu}{2\beta}\right)^{R}+%
\frac{L^{2}}{\mu}\left[\frac{16d\ln(1/\delta)}{\epsilon^{2}K^{2}M}+\frac{1}{MK%
}\right].
K
R
\frac{1}{\ln\left(\frac{\beta}{\beta-\mu}\right)}\leq\kappa
\mathbb{E}F(w_{R})-F^{*}\lesssim\frac{L^{2}}{\mu}\left[\ln^{2}\left(\frac{\mu%
\Delta}{L^{2}}\min\left\{Mn,\frac{\epsilon^{2}n^{2}M}{d}\right\}\right)\left(%
\frac{\kappa^{2}d\ln(1/\delta)}{\epsilon^{2}n^{2}M}+\frac{\kappa}{Mn}\right)%
\right].
R
(\epsilon,\delta)
M_{r}=M
N
(\frac{N}{2M}\epsilon,\delta)
L
f^{0}(\cdot,x)\forall x\in\mathcal{X}
\mathcal{P}_{\text{vec}}
M
(\epsilon,\delta)
\frac{d\sigma^{2}}{M}
\mathcal{P}_{\text{vec}}
Z:=\frac{1}{MK}\mathcal{P}_{\text{vec}}(\{\nabla f^{0}(w_{r},x_{i,j}^{r})\}_{i%
\in S_{r},j\in[K]};\frac{N}{2M}\epsilon,\delta)-\frac{1}{MK}\sum_{i\in S_{r+1}%
}\sum_{j=1}^{K}\nabla f^{0}(w_{r},x_{i,j}^{r})
\mathbb{E}\|Z\|^{2}=\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\delta)}{M^{2}K^{2}%
(\frac{N}{2M}\epsilon)^{2}}\right)=\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/%
\delta)}{\epsilon^{2}K^{2}N^{2}}\right).
Z
\frac{d\sigma^{2}}{M}
\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\delta)}{\epsilon^{2}K^{2}N^{2}}\right)
\mathbb{E}[F(w_{r+1})-F^{*}]\leq\mathbb{E}[F(w_{r})-F^{*}]\left(1-\frac{\mu}{2%
\beta}\right)+\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\delta)}{\epsilon^{2}K^{2%
}N^{2}}\right)+\frac{2L^{2}}{\beta MK}.
\mathbb{E}[F(w_{R})-F^{*}]\leq\Delta\left(1-\frac{\mu}{2\beta}\right)^{R}+%
\frac{L^{2}}{\mu}\left[\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\delta)}{%
\epsilon^{2}K^{2}N^{2}}\right)+\frac{1}{MK}\right].
R
K=n/R
\frac{1}{\ln\left(\frac{\beta}{\beta-\mu}\right)}\leq\kappa
\mathbb{E}F(w_{R})-F^{*}\lesssim\frac{L^{2}}{\mu}\left[\ln^{2}\left(\frac{\mu%
\Delta}{L^{2}}\min\left\{Mn,\frac{\epsilon^{2}n^{2}N^{2}}{d}\right\}\right)%
\left(\frac{\kappa^{2}d\ln^{2}(d/\delta)}{\epsilon^{2}n^{2}M}+\frac{\kappa}{Mn%
}\right)\right].
(w_{0},E,K,\eta,\epsilon,\delta)
E\in\mathbb{N}
K\in[n]
Q=\lfloor\frac{n}{K}\rfloor
X_{i}\in\mathcal{X}^{n}
f(w,x)=f^{0}(w,x)+f^{1}(w)
\eta
\epsilon,\delta
\widebar{w}_{0}=w_{0}^{Q}=w_{0}\in\mathbb{R}^{d}
\mathcal{P}_{\text{vec}}
\widetilde{\epsilon}:=\frac{\epsilon Nn}{8MK\sqrt{4EQ\ln(2/\delta)}}
\widetilde{\delta}:=\frac{\delta}{2EQ}
r\in\{0,1,\cdots,E-1\}
w^{0}_{r+1}=w^{Q}_{r}
i\in S_{r}
w_{r}
i
i
\{\nabla f^{0}(\widebar{w}_{r},x_{i,j})\}_{j=1}^{n}
\small\widetilde{g}_{r+1}:=\frac{1}{M_{r+1}n}\mathcal{P}_{\text{vec}}(\{\nabla
f%
^{0}(\widebar{w}_{r},x_{i,j})\}_{i\in S_{r+1},j\in[n]};\widetilde{\epsilon},%
\widetilde{\delta};L)
t\in\{0,1,\cdots Q-1\}
i
\{x_{i,j}^{r+1,t}\}_{j=1}^{K}
X_{i}
\{\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t})\}_{j=1}^{K}
\small\widetilde{p}_{r+1}^{t}:=\frac{1}{M_{r+1}K}\mathcal{P}_{\text{vec}}(\{%
\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t})-\nabla f^{0}(\widebar{w}_{r+1},x_{i,%
j}^{r+1,t})\}_{i\in S_{r+1},j\in[K]};\widetilde{\epsilon},\widetilde{\delta};2L)
\widetilde{v}_{r+1}^{t}:=\widetilde{p}_{r+1}^{t}+\widetilde{g}_{r+1}
w_{r+1}^{t+1}:=\texttt{{prox}}_{\eta f^{1}}(w_{r+1}^{t}-\eta\widetilde{v}_{r+1%
}^{t})
\widebar{w}_{r+1}:=w_{r+1}^{Q}
w_{\text{priv}}\sim\text{Unif}(\{w_{r+1}^{t}\}_{r=0,1,\cdots,E-1;t=0,1,\cdots Q%
-1})
s\in[S]
w_{s}=\texttt{SDP Prox-SVRG}(w_{s-1},E,K,\eta,\frac{\epsilon}{2\sqrt{2S}},%
\frac{\delta}{2S})
w_{\text{priv}}:=w_{S}
\upsilon_{\mathbf{X}}^{2}
\frac{1}{N}\sum_{i=1}^{N}\|\nabla\widehat{F}^{0}_{i}(w)-\nabla\widehat{F}^{0}_%
{\mathbf{X}}(w)\|^{2}\leq\hat{\upsilon}_{\mathbf{X}}^{2}
i\in[N],~{}w\in\mathcal{W}
r
S_{r}
M_{r}\in[N]
\{M_{r}\}_{r\geq 0}
\frac{1}{M}:=\mathbb{E}(\frac{1}{M_{r}})
\widehat{F}(w)=\widehat{F}^{0}(w)+f^{1}(w)
\widehat{F}^{0}
\beta
f^{1}
y:=\texttt{{prox}}_{\eta f^{1}}(w-\eta d^{\prime})
d^{\prime}\in\mathbb{R}^{d}
z\in\mathbb{R}^{d}
\displaystyle\widehat{F}(y)\leq\widehat{F}(z)+\langle y-z,\nabla\widehat{F}^{0%
}(w)-d^{\prime}\rangle+\left[\frac{\beta}{2}-\frac{1}{2\eta}\right]\|y-w\|^{2}%
+\left[\frac{\beta}{2}+\frac{1}{2\eta}\right]\|z-w\|^{2}-\frac{1}{2\eta}\|y-z%
\|^{2}.
\displaystyle\widehat{F}(y)\leq\widehat{F}(z)+\langle y-z,\nabla\widehat{F}^{0%
}(w)-d^{\prime}\rangle+\left[\frac{\beta}{2}-\frac{1}{2\eta}\right]\|y-w\|^{2}%
+\left[\frac{\beta}{2}+\frac{1}{2\eta}\right]\|z-w\|^{2}-\frac{1}{2\eta}\|y-z%
\|^{2}.
t\in\{0,1,\cdots,Q-1\}
r\in\{0,1,\cdots,E-1\}
\mathbb{E}\|\nabla\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}_{r+1}^{t}\|^{2}%
\leq\frac{8\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}\mathbb{E}\|w_{r+1}^{t}-%
\widebar{w}_{r}\|^{2}+\frac{2(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{d(\sigma_{1}^{2}+\sigma_{2}^{2})}{M}.
\mathbb{E}\|\nabla\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}_{r+1}^{t}\|^{2}%
\leq\frac{8\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}\mathbb{E}\|w_{r+1}^{t}-%
\widebar{w}_{r}\|^{2}+\frac{2(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\mathcal{O}\left(\frac{dL^{2}R\ln^{2}(dR/\delta)\ln(1/%
\delta)}{\epsilon^{2}n^{2}N^{2}}\right),
R=EQ
\displaystyle\zeta_{r+1}^{t}:=\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^%
{K}[\underbrace{\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t})-\nabla f^{0}(%
\widebar{w}_{r},x_{i,j}^{r+1,t})}_{:=\zeta_{r+1}^{t,i,j}}]
\displaystyle\zeta_{r+1}^{t}
\displaystyle:=\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^{K}[\underbrace%
{\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t})-\nabla f^{0}(\widebar{w}_{r},x_{i,j%
}^{r+1,t})}_{:=\zeta_{r+1}^{t,i,j}}]
\displaystyle=\widetilde{v}_{r+1}^{t}-\widetilde{g}_{r+1}-\widebar{u}_{2},
\displaystyle=\widetilde{v}_{r+1}^{t}-\widetilde{g}_{r+1}-\widebar{u}_{2},
\widetilde{g}_{r+1}:=\frac{1}{M_{r+1}}\sum_{i\in S_{r+1}}\widetilde{g}^{i}_{r+%
1}=\frac{1}{M_{r+1}}\sum_{i\in S_{r+1}}\nabla\widehat{F}^{0}_{i}(\widebar{w}_{%
r})+\widebar{u}_{1}
\widebar{u}_{j}=\frac{1}{M_{r+1}}\sum_{i\in S_{r+1}}u^{i}_{j}
j=1,2
\mathbb{E}\zeta_{r+1}^{t,i,j}=\nabla\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla%
\widehat{F}^{0}_{i}(\widebar{w}_{r})
w_{r+1}^{t}
\widebar{w}_{r}
\displaystyle\mathbb{E}\left\|\nabla\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}%
_{r+1}^{t}\right\|^{2}=\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}%
\sum_{j=1}^{K}[\zeta_{r+1}^{t,i,j}+\widetilde{g}_{r+1}^{i}-\nabla\widehat{F}^{%
0}(w_{r+1}^{t})]+\widebar{u}_{2}\right\|^{2}
\displaystyle\mathbb{E}\left\|\nabla\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}%
_{r+1}^{t}\right\|^{2}
\displaystyle=\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}%
^{K}[\zeta_{r+1}^{t,i,j}+\widetilde{g}_{r+1}^{i}-\nabla\widehat{F}^{0}(w_{r+1}%
^{t})]+\widebar{u}_{2}\right\|^{2}
\displaystyle=\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}%
^{K}[\zeta_{r+1}^{t,i,j}+\nabla\widehat{F}^{0}_{i}(\widebar{w}_{r})+u_{1}^{i}-%
\nabla\widehat{F}^{0}(w_{r+1}^{t})]+\widebar{u}_{2}\right\|^{2}
\displaystyle=\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}%
^{K}[\zeta_{r+1}^{t,i,j}+\nabla\widehat{F}^{0}_{i}(\widebar{w}_{r})+u_{1}^{i}-%
\nabla\widehat{F}^{0}(w_{r+1}^{t})]+\widebar{u}_{2}\right\|^{2}
\displaystyle=\frac{d(\sigma_{1}^{2}+\sigma_{2}^{2})}{M}+\underbrace{\mathbb{E%
}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^{K}[\zeta_{r+1}^{t,i,j%
}+\nabla\widehat{F}^{0}_{i}(\widebar{w}_{r})-\nabla\widehat{F}^{0}(w_{r+1}^{t}%
)]\right\|^{2}}_{:=ⓐ},
\displaystyle=\frac{d(\sigma_{1}^{2}+\sigma_{2}^{2})}{M}+\underbrace{\mathbb{E%
}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^{K}[\zeta_{r+1}^{t,i,j%
}+\nabla\widehat{F}^{0}_{i}(\widebar{w}_{r})-\nabla\widehat{F}^{0}(w_{r+1}^{t}%
)]\right\|^{2}}_{:=ⓐ},
\displaystyle ⓐ=\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=%
1}^{K}\left\{[\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}]+\nabla%
\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^{0}(w_{r+1}^{t})\right\}%
\right\|^{2}
\displaystyle ⓐ
\displaystyle=\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}%
^{K}\left\{[\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}]+\nabla\widehat{%
F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^{0}(w_{r+1}^{t})\right\}\right\|^{2}
\displaystyle\leq 2\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_%
{j=1}^{K}\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}\right\|^{2}+2%
\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^{K}\nabla%
\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^{0}(w_{r+1}^{t})\right\|^{2}.
\displaystyle\leq 2\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_%
{j=1}^{K}\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}\right\|^{2}+2%
\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^{K}\nabla%
\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^{0}(w_{r+1}^{t})\right\|^{2}.
M_{r+1}
r
\displaystyle\small\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_%
{j=1}^{K}\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}\right\|^{2}\leq%
\frac{\mathds{1}_{\{M_{r+1}K<Nn\}}}{M_{r+1}KNn}\sum_{i=1}^{N}\sum_{j=1}^{n}%
\mathbb{E}\left\|\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}\right\|^{2}
\displaystyle\small\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_%
{j=1}^{K}\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}\right\|^{2}
\displaystyle\leq\frac{\mathds{1}_{\{M_{r+1}K<Nn\}}}{M_{r+1}KNn}\sum_{i=1}^{N}%
\sum_{j=1}^{n}\mathbb{E}\left\|\zeta_{r+1}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,%
j}\right\|^{2}
\displaystyle\leq\small\frac{\mathds{1}_{\{M_{r+1}K<Nn\}}}{MKNn}\sum_{i=1}^{N}%
\sum_{j=1}^{n}2\mathbb{E}\left[\left\|\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t}%
)-f^{0}(\widebar{w}_{r},x_{i,j}^{r+1,t})\right\|^{2}\right]
\displaystyle\leq\small\frac{\mathds{1}_{\{M_{r+1}K<Nn\}}}{MKNn}\sum_{i=1}^{N}%
\sum_{j=1}^{n}2\mathbb{E}\left[\left\|\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t}%
)-f^{0}(\widebar{w}_{r},x_{i,j}^{r+1,t})\right\|^{2}\right]
\displaystyle\;\;\;+\mathbb{E}\|\nabla\widehat{F}^{0}(w_{r+1}^{t})-\nabla%
\widehat{F}^{0}(\widebar{w}_{r})\|^{2}
\displaystyle\;\;\;+\mathbb{E}\|\nabla\widehat{F}^{0}(w_{r+1}^{t})-\nabla%
\widehat{F}^{0}(\widebar{w}_{r})\|^{2}
\displaystyle\leq\frac{4\mathds{1}_{\{M_{r+1}K<Nn\}}}{M_{r+1}K}\beta^{2}\|w_{r%
+1}^{t}-\widebar{w}_{r}\|^{2},
\displaystyle\leq\frac{4\mathds{1}_{\{M_{r+1}K<Nn\}}}{M_{r+1}K}\beta^{2}\|w_{r%
+1}^{t}-\widebar{w}_{r}\|^{2},
\beta
M=N
M_{r+1}=N
1
M_{r+1}
w
\frac{4\mathds{1}_{\{K<n\}}}{MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}=%
\frac{4\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
M<N
M_{r+1}
w
\frac{4}{MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}=\frac{4\mathds{1}_{\{%
MK<Nn\}}}{MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
1
M<N
\widebar{w}_{r},w_{r+1}^{t}
\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^{K}\zeta_{r+1%
}^{t,i,j}-\mathbb{E}\zeta_{r+1}^{t,i,j}\right\|^{2}\leq\frac{4\mathds{1}_{\{MK%
<Nn\}}}{MK}\beta^{2}\mathbb{E}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}.
M_{r+1}
w_{r+1}^{t}
\displaystyle\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^%
{K}\nabla\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^{0}(w_{r+1}^{t})%
\right\|^{2}\leq\mathds{1}_{\{N>1\}}\frac{N-M_{r+1}}{(N-1)M_{r+1}}\times\frac{%
1}{N}\sum_{i=1}^{N}\|\nabla\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^%
{0}(w_{r+1}^{t})\|^{2}
\displaystyle\mathbb{E}\left\|\frac{1}{M_{r+1}K}\sum_{i\in S_{r+1}}\sum_{j=1}^%
{K}\nabla\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}^{0}(w_{r+1}^{t})%
\right\|^{2}
\displaystyle\leq\mathds{1}_{\{N>1\}}\frac{N-M_{r+1}}{(N-1)M_{r+1}}\times\frac%
{1}{N}\sum_{i=1}^{N}\|\nabla\widehat{F}^{0}_{i}(w_{r+1}^{t})-\nabla\widehat{F}%
^{0}(w_{r+1}^{t})\|^{2}
\displaystyle\leq\mathds{1}_{\{N>1\}}\frac{N-M_{r+1}}{(N-1)M_{r+1}}\hat{%
\upsilon}_{\mathbf{X}}^{2}.
\displaystyle\leq\mathds{1}_{\{N>1\}}\frac{N-M_{r+1}}{(N-1)M_{r+1}}\hat{%
\upsilon}_{\mathbf{X}}^{2}.
\widebar{u}_{1}
\widebar{u}_{2}
\mathcal{P}_{\text{vec}}
Z_{1}:=\frac{1}{Mn}\mathcal{P}_{\text{vec}}(\{\nabla f^{0}(\widebar{w}_{r},x_{%
i,j})\}_{i\in S_{r+1},j\in[n]};\widetilde{\epsilon},\widetilde{\delta})-\frac{%
1}{M}\sum_{i\in S_{r+1}}\nabla\widehat{F}_{i}^{0}(\widebar{w}_{r})
\small Z_{2}:=\frac{1}{MK}\left[\mathcal{P}_{\text{vec}}(\{\nabla f^{0}(w_{r+1%
}^{t},x_{i,j}^{r+1,t})-\nabla f^{0}(\widebar{w}_{r+1},x_{i,j}^{r+1,t})\}_{i\in
S%
_{r+1},j\in[K]};\widetilde{\epsilon},\widetilde{\delta})-\sum_{i\in S_{r+1}}%
\sum_{j=1}^{K}(\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t})-f^{0}(\widebar{w}_{r}%
,x_{i,j}^{r+1,t})\right]
\mathbb{E}\|Z_{1}\|^{2}=\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\widetilde{%
\delta})}{M^{2}n^{2}\widetilde{\epsilon}^{2}}\right)=\mathcal{O}\left(\frac{dL%
^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right)
\mathbb{E}\|Z_{2}\|^{2}=\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\widetilde{%
\delta})}{M^{2}K^{2}\widetilde{\epsilon}^{2}}\right)=\mathcal{O}\left(\frac{dL%
^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right).
M<N
\epsilon\leq\min\{2\ln(2/\delta),15\}
R:=EQ
\widehat{F}_{\mathbf{X}}
\mu
(\epsilon,\delta)
\sigma_{1}^{2}=\frac{256L^{2}SE\log(2/\delta)\log(5E/\delta)}{\epsilon^{2}n^{2}}
\sigma_{2}^{2}=\frac{1024L^{2}SR\log(2/\delta)\log(2.5R/\delta)}{\epsilon^{2}n%
^{2}}
K\geq\frac{\epsilon n}{4\sqrt{2SR\ln(2/\delta)}}
K\geq\left(\frac{n^{2}}{M}\right)^{1/3}
R=12\kappa
\small S\geq\log_{2}\left(\frac{\hat{\Delta}_{\mathbf{X}}\mu M\epsilon^{2}n^{2%
}}{\kappa dL^{2}}\right)
\eta
\forall\mathbf{X}\in\mathbb{X}
\small\mathbb{E}\widehat{F}_{\small\mathbf{X}\normalsize}(w_{S})-\widehat{F}_{%
\small\mathbf{X}\normalsize}^{*}=\widetilde{\mathcal{O}}\left(\kappa\frac{L^{2%
}d\ln(1/\delta)}{\mu\epsilon^{2}n^{2}M}+\frac{(N-M)\hat{\upsilon}_{\mathbf{X}}%
^{2}}{M(N-1)}\mathds{1}_{\{N>1\}}\right)
\widetilde{\mathcal{O}}(\kappa)
(\epsilon,\delta)
M_{r+1}=M\geq\min\left\{\frac{(\epsilon NL)^{3/4}(d\ln^{3}(d/\delta))^{3/8}}{n%
^{1/4}(\beta\hat{\Delta}_{\mathbf{X}})^{3/8}},N\right\}
r
K\geq\left(\frac{n^{2}}{M}\right)^{1/3}
R=12\kappa
\small S\geq\log_{2}\left(\frac{\hat{\Delta}_{\mathbf{X}}\mu\epsilon^{2}N^{2}n%
^{2}}{\kappa dL^{2}}\right)
\eta
\forall\mathbf{X}\in\mathbb{X}
\small\mathbb{E}\widehat{F}_{\small\mathbf{X}\normalsize}(w_{S})-\widehat{F}_{%
\small\mathbf{X}\normalsize}^{*}=\widetilde{\mathcal{O}}\left(\kappa\frac{L^{2%
}d\ln(1/\delta)}{\mu\epsilon^{2}n^{2}N^{2}}+\frac{(N-M)\hat{\upsilon}_{\mathbf%
{X}}^{2}}{\mu M(N-1)}\mathds{1}_{\{N>1\}}\right).
S=1
S
S
\sigma_{1}^{2}
\sigma_{2}^{2}
i
i\in[N]
E-1
\widetilde{g}_{r+1}^{i}
(\epsilon/2,\delta/2)
R=EQ
\widetilde{v}_{r+1}^{t,i}
i
r\in\{0,1,\cdots,E-1\},t\in\{0,1,\cdots,Q-1\}
(\epsilon,\delta)
E
\widetilde{g}_{r+1}^{i}
(\widetilde{\epsilon}_{1}/2,\widetilde{\delta}_{1}/2)
\widetilde{\epsilon}_{1}=\frac{\epsilon}{2\sqrt{2E\ln(2/\delta)}}
\widetilde{\delta}_{1}=\frac{\delta}{2E}
R=EQ
\widetilde{v}_{r+1}^{t,i}
(\widetilde{\epsilon}_{2}/2,\widetilde{\delta}_{2}/2)
\widetilde{\epsilon}_{2}=\frac{\epsilon}{2\sqrt{2R\ln(2/\delta)}}
\widetilde{\delta}_{2}=\frac{\delta}{2R}.
\ell_{2}
\Delta^{(1)}_{2}:=\sup_{|X_{i}\Delta X^{\prime}_{i}|\leq 2,w\in\mathcal{W}}\|%
\frac{1}{K_{2}}\sum_{j=1}^{n}\nabla f^{0}(w,x_{i,j})-\nabla f^{0}(w,x^{\prime}%
_{i,j})\|\leq 2L/n,
L
f^{0}.
\mathcal{W}
f^{1}=\iota_{\mathcal{W}}+h
h
\mathcal{W}=\mathbb{\mathbb{R}^{d}}
\sigma^{2}_{1}\geq\frac{8L^{2}\ln(1.25/(\widetilde{\delta}_{1}/2))}{(%
\widetilde{\epsilon}_{1}/2)^{2}n^{2}}=\frac{256L^{2}E\ln(2/\delta)\ln(5E/%
\delta)}{\epsilon^{2}n^{2}}
(\widetilde{\epsilon}_{1}/2,\widetilde{\delta}_{1}/2)
x_{i,j}^{r+1,t}
\ell_{2}
\widetilde{g}_{r+1}^{i}
\Delta^{(2)}_{2}:=\sup_{|X_{i}\Delta X^{\prime}_{i}|\leq 2,w,w^{\prime}\in%
\mathcal{W}}\|\frac{1}{K}\sum_{j=1}^{K}\nabla f^{0}(w,x_{i,j})-\nabla f^{0}(w,%
x^{\prime}_{i,j})-f^{0}(w^{\prime},x_{i,j})+\nabla f^{0}(w^{\prime},x^{\prime}%
_{i,j})\|\leq 2\sup_{|X_{i}\Delta X^{\prime}_{i}|\leq 2,w\in\mathcal{W}}\|%
\frac{1}{K}\sum_{j=1}^{K}\nabla f^{0}(w,x_{i,j})-\nabla f^{0}(w,x^{\prime}_{i,%
j})\|\leq 4L/K,
L
f^{0}
\mathcal{W}
\sigma^{2}_{1}\geq\frac{8L^{2}\ln(1.25/(\widetilde{\delta}_{2}/2))}{(%
\widetilde{\epsilon}_{2}/2)^{2}K_{2}^{2}}=\frac{32L^{2}\ln(2.5/\widetilde{%
\delta}_{2})}{\widetilde{\epsilon}_{2}^{2}K_{2}^{2}}
(\widetilde{\epsilon}_{2}/2,\widetilde{\delta}_{2}/2)
r
(\frac{2\widetilde{\epsilon}_{2}K}{n},\widetilde{\delta}_{2})
K
\epsilon^{\prime}:=\frac{n}{2K}\frac{\epsilon}{2\sqrt{2R\ln(2/\delta})}\leq 1
\sigma^{2}_{1}\geq\frac{128L^{2}\ln(2.5/\widetilde{\delta}_{2})}{n^{2}%
\widetilde{\epsilon}_{2}^{2}}=\frac{1024L^{2}R\ln(5R/\delta)\ln(2/\delta)}{n^{%
2}\epsilon^{2}}
R
(\epsilon/2,\delta/2)
(\epsilon,\delta)
\hat{w}_{r+1}^{t+1}:=\texttt{{prox}}_{\eta f^{1}}[w_{r+1}^{t}-\eta\nabla%
\widehat{F}^{0}(w_{r+1}^{t})]]
\mathbf{X}\in\mathbb{X}
\widehat{F}:=\widehat{F}_{\mathbf{X}}
\widehat{F}^{j}:=\widehat{F}_{\mathbf{X}}^{j}
j\in\{0,1\}
\alpha>0
w\in\mathbb{R}^{d}
D_{f^{1}}(w,\alpha):=-2\alpha\min_{y\in\mathbb{R}^{d}}\left[\langle\nabla%
\widehat{F}^{0}(w),y-w\rangle+\frac{\alpha}{2}\|y-w\|^{2}+f^{1}(y)-f^{1}(w)\right]
\eta:=\frac{1}{8\beta}\min\left(1,\frac{K^{3/2}\sqrt{M}}{n}\right)
\frac{\beta}{2}+c_{t+1}\left(1+\frac{n}{K}\right)\leq\frac{1}{2\eta}
t\in\{0,1,\cdots,Q-1\}
MK=Nn
c_{t}=c_{t+1}(2)=c_{t+2}(2)^{2}=c_{Q}(2)^{Q-t}=0
c_{Q}=0
MK<Nn
q:=\frac{K}{n}
t\in\{0,\cdots,Q-1\}
\displaystyle c_{t}=c_{t+1}(1+q)+\frac{4\eta\beta^{2}}{MK}
\displaystyle c_{t}
\displaystyle=c_{t+1}(1+q)+\frac{4\eta\beta^{2}}{MK}
\displaystyle=\frac{4\eta\beta^{2}}{MK}[(1+q)^{Q-t-1}+\cdots+(1+q)^{2}+(1+q)+1]
\displaystyle=\frac{4\eta\beta^{2}}{MK}[(1+q)^{Q-t-1}+\cdots+(1+q)^{2}+(1+q)+1]
\displaystyle=\frac{4\eta\beta^{2}}{MK}\left(\frac{(1+q)^{Q-t}-1)}{q}\right)
\displaystyle=\frac{4\eta\beta^{2}}{MK}\left(\frac{(1+q)^{Q-t}-1)}{q}\right)
\displaystyle\leq\frac{4\eta\beta^{2}n}{MK^{2}}\left(\left(1+\frac{K}{n}\right%
)^{n/K}-1\right)
\displaystyle\leq\frac{4\eta\beta^{2}n}{MK^{2}}\left(\left(1+\frac{K}{n}\right%
)^{n/K}-1\right)
\displaystyle\leq\frac{8\eta\beta^{2}n}{MK^{2}}.
\displaystyle\leq\frac{8\eta\beta^{2}n}{MK^{2}}.
\eta
w=z=w_{r+1}^{t}
d^{\prime}=\nabla\widehat{F}^{0}(w)
\widehat{F}(\widehat{w}_{r+1}^{t+1})\leq\widehat{F}(w_{r+1}^{t})+\left(\frac{%
\beta}{2}-\frac{1}{2\eta}\right)\|\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-%
\frac{1}{2\eta}\|\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\|^{2},
\mathbb{E}\widehat{F}(\widehat{w}_{r+1}^{t+1})\leq\mathbb{E}\widehat{F}(w_{r+1%
}^{t})+\left(\frac{\beta}{2}-\frac{1}{\eta}\right)\mathbb{E}\|\widehat{w}_{r+1%
}^{t+1}-w_{r+1}^{t}\|^{2}.
w_{r+1}^{t+1}=\texttt{{prox}}_{\eta f^{1}}(w_{r+1}^{t}-\eta\widetilde{v}_{r+1}%
^{t})
y=w_{r+1}^{t+1},z=\widehat{w}_{r+1}^{t+1},d^{\prime}=\widetilde{v}_{r+1}^{t},w%
=w_{r+1}^{t}
\displaystyle\small\widehat{F}(w_{r+1}^{t+1})\leq\widehat{F}(\widehat{w}_{r+1}%
^{t+1})+\langle w_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1},\nabla\widehat{F}^{0}(w_%
{r+1}^{t})-\widetilde{v}_{r+1}^{t}\rangle
\displaystyle\small\widehat{F}(w_{r+1}^{t+1})
\displaystyle\leq\widehat{F}(\widehat{w}_{r+1}^{t+1})+\langle w_{r+1}^{t+1}-%
\widehat{w}_{r+1}^{t+1},\nabla\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}_{r+1}%
^{t}\rangle
\displaystyle+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r%
+1}^{t}\|^{2}+\left(\frac{\beta}{2}+\frac{1}{2\eta}\right)\|\widehat{w}_{r+1}^%
{t+1}-w_{r+1}^{t}\|^{2}-\frac{1}{2\eta}\|w_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1}%
\|^{2}.
\displaystyle+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r%
+1}^{t}\|^{2}+\left(\frac{\beta}{2}+\frac{1}{2\eta}\right)\|\widehat{w}_{r+1}^%
{t+1}-w_{r+1}^{t}\|^{2}-\frac{1}{2\eta}\|w_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1}%
\|^{2}.
\beta
\widehat{F}^{0}
\displaystyle\widehat{F}(\widehat{w}_{r+1}^{t+1})\leq\widehat{F}^{0}(w_{r+1}^{%
t})+f^{1}(w_{r+1}^{t})+\langle\nabla\widehat{F}^{0}(w_{r+1}^{t}),\widehat{w}_{%
r+1}^{t+1}-w_{r+1}^{t}\rangle+\frac{\beta}{2}\|\widehat{w}_{r+1}^{t+1}-w_{r+1}%
^{t}\|^{2}+f^{1}(\widehat{w}_{r+1}^{t+1})-f^{1}(w_{r+1}^{t})
\displaystyle\widehat{F}(\widehat{w}_{r+1}^{t+1})
\displaystyle\leq\widehat{F}^{0}(w_{r+1}^{t})+f^{1}(w_{r+1}^{t})+\langle\nabla%
\widehat{F}^{0}(w_{r+1}^{t}),\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\rangle+\frac{%
\beta}{2}\|\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}+f^{1}(\widehat{w}_{r+1}^{%
t+1})-f^{1}(w_{r+1}^{t})
\displaystyle\leq\widehat{F}(w_{r+1}^{t})+\langle\nabla\widehat{F}^{0}(w_{r+1}%
^{t}),\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\rangle+\frac{1}{2\eta}\|\widehat{w}_%
{r+1}^{t+1}-w_{r+1}^{t}\|^{2}+f^{1}(\widehat{w}_{r+1}^{t+1})-f^{1}(w_{r+1}^{t})
\displaystyle\leq\widehat{F}(w_{r+1}^{t})+\langle\nabla\widehat{F}^{0}(w_{r+1}%
^{t}),\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\rangle+\frac{1}{2\eta}\|\widehat{w}_%
{r+1}^{t+1}-w_{r+1}^{t}\|^{2}+f^{1}(\widehat{w}_{r+1}^{t+1})-f^{1}(w_{r+1}^{t})
\displaystyle=\widehat{F}(w_{r+1}^{t})-\frac{\eta}{2}D_{f^{1}}(w_{r+1}^{t},%
\frac{1}{\eta})
\displaystyle=\widehat{F}(w_{r+1}^{t})-\frac{\eta}{2}D_{f^{1}}(w_{r+1}^{t},%
\frac{1}{\eta})
\displaystyle\leq\widehat{F}(w_{r+1}^{t})-\frac{\eta}{2}D_{f^{1}}(w_{r+1}^{t},\beta)
\displaystyle\leq\widehat{F}(w_{r+1}^{t})-\frac{\eta}{2}D_{f^{1}}(w_{r+1}^{t},\beta)
\displaystyle\leq\widehat{F}(w_{r+1}^{t})-\eta\mu[\widehat{F}(w_{r+1}^{t})-%
\widehat{F}^{*}],
\displaystyle\leq\widehat{F}(w_{r+1}^{t})-\eta\mu[\widehat{F}(w_{r+1}^{t})-%
\widehat{F}^{*}],
\eta\leq 1/\beta
\widehat{F}
2/3\times
1/3\times
\mathbb{E}\widehat{F}(\widehat{w}_{r+1}^{t+1})\leq\mathbb{E}\left[\widehat{F}(%
w_{r+1}^{t})+\frac{2}{3}\left(\frac{\beta}{2}-\frac{1}{\eta}\right)\|\widehat{%
w}_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-%
\widehat{F}^{*})\right].
\displaystyle\small\mathbb{E}\widehat{F}(w_{r+1}^{t+1})\leq\mathbb{E}\Bigg{[}%
\widehat{F}(w_{r+1}^{t})+\left(\frac{5\beta}{6}-\frac{1}{6\eta}\right)\|%
\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(\widehat{F}(w_{r+1%
}^{t})-\widehat{F}^{*})
\displaystyle\small\mathbb{E}\widehat{F}(w_{r+1}^{t+1})
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{5\beta%
}{6}-\frac{1}{6\eta}\right)\|\widehat{w}_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{%
\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})
\displaystyle\;\;\;+\langle w_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1},\nabla%
\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}_{r+1}^{t}\rangle+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{1}{2\eta}\|w%
_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1}\|^{2}\Bigg{]}.
\displaystyle\;\;\;+\langle w_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1},\nabla%
\widehat{F}^{0}(w_{r+1}^{t})-\widetilde{v}_{r+1}^{t}\rangle+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{1}{2\eta}\|w%
_{r+1}^{t+1}-\widehat{w}_{r+1}^{t+1}\|^{2}\Bigg{]}.
\eta\leq\frac{1}{5\beta}
\displaystyle\mathbb{E}\widehat{F}(w_{r+1}^{t+1})\leq\mathbb{E}\Bigg{[}%
\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\|w_{r+1}%
^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-\widehat{F%
}^{*})+\frac{\eta}{2}\|\widehat{F}(w_{r+1}^{t})-\widetilde{v}_{r+1}^{t}\|^{2}%
\Bigg{]}
\displaystyle\mathbb{E}\widehat{F}(w_{r+1}^{t+1})
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(%
\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\frac{\eta}{2}\|\widehat{F}(w_{r+1}^%
{t})-\widetilde{v}_{r+1}^{t}\|^{2}\Bigg{]}
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(%
\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\frac{4\eta\mathds{1}_{\{MK<Nn\}}}{%
MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(%
\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\frac{4\eta\mathds{1}_{\{MK<Nn\}}}{%
MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}\Bigg{]},
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}\Bigg{]},
\gamma_{r+1}^{t}:=\mathbb{E}[\widehat{F}(w_{r+1}^{t})+c_{t}\|w_{r+1}^{t}-%
\widebar{w}_{r}\|^{2}]
c_{t}:=c_{t+1}(1+\frac{K}{n})+\frac{4\eta\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}
t=0,\cdots,Q-1
c_{Q}:=0
\displaystyle\gamma_{r+1}^{t+1}\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+%
\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-%
\frac{\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\frac{4\eta\mathds%
{1}_{\{MK<Nn\}}}{MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\gamma_{r+1}^{t+1}
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|^{2}-\frac{\eta\mu}{3}(%
\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\frac{4\eta\mathds{1}_{\{MK<Nn\}}}{%
MK}\beta^{2}\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}+c_{t+1}%
\|w_{r+1}^{t+1}-\widebar{w}_{r}\|^{2}\Bigg{]}
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}+c_{t+1}%
\|w_{r+1}^{t+1}-\widebar{w}_{r}\|^{2}\Bigg{]}
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}+c_{t+1}(1+\frac{1}{q})\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|%
^{2}-\frac{\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})+\left(\frac{\beta}%
{2}-\frac{1}{2\eta}+c_{t+1}(1+\frac{1}{q})\right)\|w_{r+1}^{t+1}-w_{r+1}^{t}\|%
^{2}-\frac{\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})
\displaystyle\;\;\;+\left(\frac{4\eta\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}+c_{t%
+1}(1+q)\right)\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\;\;\;+\left(\frac{4\eta\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}+c_{t%
+1}(1+q)\right)\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}\Bigg{]},
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}\Bigg{]},
q:=\frac{K}{n}
\|w_{r+1}^{t+1}-\widebar{w}_{r}\|^{2}
\displaystyle\gamma_{r+1}^{t+1}\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})-%
\frac{\eta\mu}{3}(\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\left(\frac{4\eta%
\mathds{1}_{\{MK<Nn\}}}{MK}\beta^{2}+c_{t+1}(1+q)\right)\|w_{r+1}^{t}-\widebar%
{w}_{r}\|^{2}
\displaystyle\gamma_{r+1}^{t+1}
\displaystyle\leq\mathbb{E}\Bigg{[}\widehat{F}(w_{r+1}^{t})-\frac{\eta\mu}{3}(%
\widehat{F}(w_{r+1}^{t})-\widehat{F}^{*})+\left(\frac{4\eta\mathds{1}_{\{MK<Nn%
\}}}{MK}\beta^{2}+c_{t+1}(1+q)\right)\|w_{r+1}^{t}-\widebar{w}_{r}\|^{2}
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}\Bigg{]}
\displaystyle\;\;\;+\frac{\eta(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}%
\mathds{1}_{\{N>1\}}+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}\Bigg{]}
\displaystyle=\gamma_{r+1}^{t}-\frac{\eta\mu}{3}\mathbb{E}(\widehat{F}(w_{r+1}%
^{t})-\widehat{F}^{*})+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}
\displaystyle=\gamma_{r+1}^{t}-\frac{\eta\mu}{3}\mathbb{E}(\widehat{F}(w_{r+1}%
^{t})-\widehat{F}^{*})+\frac{\eta d(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}
\displaystyle\mathbb{E}[\widehat{F}(\widebar{w}_{r+1})-\widehat{F}(\widebar{w}%
_{r})]=\sum_{t=0}^{Q-1}\gamma_{r+1}^{t+1}-\gamma_{r+1}^{t}=\frac{\eta\mu}{3}%
\sum_{t=0}^{Q-1}\mathbb{E}[\widehat{F}(w_{r+1}^{t}-\widehat{F}^{*}]+\frac{\eta
Q%
(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}\mathds{1}_{\{N>1\}}
\displaystyle\mathbb{E}[\widehat{F}(\widebar{w}_{r+1})-\widehat{F}(\widebar{w}%
_{r})]
\displaystyle=\sum_{t=0}^{Q-1}\gamma_{r+1}^{t+1}-\gamma_{r+1}^{t}=\frac{\eta%
\mu}{3}\sum_{t=0}^{Q-1}\mathbb{E}[\widehat{F}(w_{r+1}^{t}-\widehat{F}^{*}]+%
\frac{\eta Q(N-M)\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}\mathds{1}_{\{N>1\}}
\displaystyle\;\;\;+\frac{\eta Qd(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}
\displaystyle\;\;\;+\frac{\eta Qd(\sigma_{1}^{2}+\sigma_{2}^{2})}{2M}
\displaystyle\implies\frac{\eta\mu}{3}\sum_{r=0}^{E-1}\sum_{t=0}^{Q-1}\mathbb{%
E}[\widehat{F}(w_{r+1}^{t}-\widehat{F}^{*}]\leq\Delta+R\eta\left(\frac{(N-M)%
\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}\mathds{1}_{\{N>1\}}+\frac{d(\sigma_{1%
}^{2}+\sigma_{2}^{2})}{2M}\right),
\displaystyle\implies\frac{\eta\mu}{3}\sum_{r=0}^{E-1}\sum_{t=0}^{Q-1}\mathbb{%
E}[\widehat{F}(w_{r+1}^{t}-\widehat{F}^{*}]\leq\Delta+R\eta\left(\frac{(N-M)%
\hat{\upsilon}_{\mathbf{X}}^{2}}{M(N-1)}\mathds{1}_{\{N>1\}}+\frac{d(\sigma_{1%
}^{2}+\sigma_{2}^{2})}{2M}\right),
\hat{\Delta}:=\widehat{F}(\widebar{w}_{0})-\widehat{F}^{*}=\hat{\Delta}_{%
\mathbf{X}}
R=EQ
w_{s}:=\texttt{ISRL-DP Prox-SVRG}(w_{s-1},E,K,\eta,\sigma_{1},\sigma_{2})
s\in[S]
\eta
\sigma_{1}^{2},\sigma_{2}^{2}
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{3\hat{%
\Delta}\beta}{\mu R}\left(1+\frac{n}{K^{3/2}\sqrt{M}}\right)+\frac{3\hat{%
\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+\widetilde{\mathcal{O}}\left(%
\frac{RdL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M}\right).
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{3\hat{%
\Delta}\beta}{\mu R}\left(1+\frac{n}{K^{3/2}\sqrt{M}}\right)+\frac{3\hat{%
\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+\widetilde{\mathcal{O}}\left(%
\frac{RdL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M}\right).
K\geq\left(\frac{n}{\sqrt{M}}\right)^{2/3}
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{6\hat{%
\Delta}\kappa}{R}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+%
\widetilde{\mathcal{O}}\left(\frac{RdL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M}%
\right).
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{6\hat{%
\Delta}\kappa}{R}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+%
\widetilde{\mathcal{O}}\left(\frac{RdL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M}%
\right).
R=12\kappa
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{\hat{%
\Delta}}{2}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+%
\widetilde{\mathcal{O}}\left(\frac{\kappa dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{%
2}M}\right).
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{\hat{%
\Delta}}{2}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+%
\widetilde{\mathcal{O}}\left(\frac{\kappa dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{%
2}M}\right).
S\geq\log_{2}\left(\frac{\hat{\Delta}_{\mathbf{X}}\mu M\epsilon^{2}n^{2}}{%
\kappa dL^{2}}\right)
SR=\widetilde{\mathcal{O}}(\kappa)
S=1
E
\widetilde{g}_{r+1}
r\in\{0,1,\cdots,E-1\}
(\epsilon/2,\delta/2)
R=EQ
\widetilde{p}_{r+1}^{t}
r\in\{0,1,\cdots,E-1\},t\in\{0,1,\cdots,Q-1\}
(\epsilon/2,\delta/2)
\epsilon
E
\widetilde{g}_{r+1}
(\epsilon^{\prime}/2,\delta^{\prime}/2)
R=EQ
\widetilde{p}_{r+1}^{t}
(\epsilon^{\prime}/2,\delta^{\prime}/2)
\epsilon^{\prime}:=\frac{\epsilon}{2\sqrt{2R\ln(2/\delta)}}
\delta^{\prime}:=\frac{\delta}{2R}
(\widetilde{\epsilon},\widetilde{\delta})
2L
L
f^{0}
M
K
R
\widetilde{\epsilon}\leq 1
(\frac{2MK}{Nn}\widetilde{\epsilon},\widetilde{\delta})
\widetilde{\epsilon}:=\frac{\epsilon Nn}{8MK\sqrt{4EQ\ln(2/\delta)}}
\widetilde{\delta}:=\frac{\delta}{2EQ}
(\epsilon,\delta)
S
\frac{d(\sigma^{2}_{1}+\sigma_{2}^{2})}{M}
\mathcal{P}_{\text{vec}}
Z_{1}:=\frac{1}{Mn}\mathcal{P}_{\text{vec}}(\{\nabla f^{0}(\widebar{w}_{r},x_{%
i,j})\}_{i\in S_{r+1},j\in[n]};\widetilde{\epsilon},\widetilde{\delta})-\frac{%
1}{M}\sum_{i\in S_{r+1}}\nabla\widehat{F}_{i}^{0}(\widebar{w}_{r})
\displaystyle\small Z_{2}:=\frac{1}{MK}\Bigg{[}\mathcal{P}_{\text{vec}}(\{%
\nabla f^{0}(w_{r+1}^{t},x_{i,j}^{r+1,t})-\nabla f^{0}(\widebar{w}_{r+1},x_{i,%
j}^{r+1,t})\}_{i\in S_{r+1},j\in[K]};\widetilde{\epsilon},\widetilde{\delta})
\displaystyle\small Z_{2}
\displaystyle:=\frac{1}{MK}\Bigg{[}\mathcal{P}_{\text{vec}}(\{\nabla f^{0}(w_{%
r+1}^{t},x_{i,j}^{r+1,t})-\nabla f^{0}(\widebar{w}_{r+1},x_{i,j}^{r+1,t})\}_{i%
\in S_{r+1},j\in[K]};\widetilde{\epsilon},\widetilde{\delta})
\displaystyle\;\;\;-\sum_{i\in S_{r+1}}\sum_{j=1}^{K}(\nabla f^{0}(w_{r+1}^{t}%
,x_{i,j}^{r+1,t})-f^{0}(\widebar{w}_{r},x_{i,j}^{r+1,t})\Bigg{]},
\displaystyle\;\;\;-\sum_{i\in S_{r+1}}\sum_{j=1}^{K}(\nabla f^{0}(w_{r+1}^{t}%
,x_{i,j}^{r+1,t})-f^{0}(\widebar{w}_{r},x_{i,j}^{r+1,t})\Bigg{]},
\mathbb{E}\|Z_{1}\|^{2}=\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\widetilde{%
\delta})}{M^{2}n^{2}\widetilde{\epsilon}^{2}}\right)=\mathcal{O}\left(\frac{dL%
^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right)
\mathbb{E}\|Z_{2}\|^{2}=\mathcal{O}\left(\frac{dL^{2}\ln^{2}(d/\widetilde{%
\delta})}{M^{2}K^{2}\widetilde{\epsilon}^{2}}\right)=\mathcal{O}\left(\frac{dL%
^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right).
\frac{d(\sigma^{2}_{1}+\sigma_{2}^{2})}{M}
\mathcal{O}\left(\frac{dL^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{%
2}N^{2}}\right)
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{3\hat{%
\Delta}_{\mathbf{X}}\beta}{\mu R}\left(1+\frac{n}{K^{3/2}\sqrt{M}}\right)+%
\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+\mathcal{O}\left(%
\frac{dL^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right).
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{3\hat{%
\Delta}_{\mathbf{X}}\beta}{\mu R}\left(1+\frac{n}{K^{3/2}\sqrt{M}}\right)+%
\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-1)}+\mathcal{O}\left(%
\frac{dL^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right).
K\geq\left(\frac{n}{\sqrt{M}}\right)^{2/3}
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{6\hat{%
\Delta}_{\mathbf{X}}\kappa}{R}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{%
\mu M(N-1)}+\mathcal{O}\left(\frac{dL^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{%
\epsilon^{2}n^{2}N^{2}}\right).
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{6\hat{%
\Delta}_{\mathbf{X}}\kappa}{R}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{%
\mu M(N-1)}+\mathcal{O}\left(\frac{dL^{2}R\ln^{2}(dR/\delta)\ln(1/\delta)}{%
\epsilon^{2}n^{2}N^{2}}\right).
R=12\kappa
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{\hat{%
\Delta}_{\mathbf{X}}}{2}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-%
1)}+\mathcal{O}\left(\frac{\kappa dL^{2}\ln^{2}(d\kappa/\delta)\ln(1/\delta)}{%
\epsilon^{2}n^{2}N^{2}}\right).
\displaystyle\mathbb{E}[\widehat{F}(w_{1})-\widehat{F}^{*}]\leq\frac{\hat{%
\Delta}_{\mathbf{X}}}{2}+\frac{3\hat{\upsilon}_{\mathbf{X}}^{2}(N-M)}{\mu M(N-%
1)}+\mathcal{O}\left(\frac{\kappa dL^{2}\ln^{2}(d\kappa/\delta)\ln(1/\delta)}{%
\epsilon^{2}n^{2}N^{2}}\right).
S\geq\log_{2}\left(\frac{\hat{\Delta}_{\mathbf{X}}\mu\epsilon^{2}N^{2}n^{2}}{%
\kappa dL^{2}}\right)
SR=\widetilde{\mathcal{O}}(\kappa)
\epsilon\leq 2\ln(1/\delta)
(\epsilon,\delta)
\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},\mathbf{X})\|^{2}%
\lesssim\left[\left(\frac{\sqrt{L\beta\hat{\Delta}_{\mathbf{X}}d\ln(1/\delta)}%
}{\epsilon n\sqrt{M}}\right)^{4/3}+\frac{L^{2}d\ln(1/\delta)}{\epsilon^{2}n^{2%
}M}+\mathds{1}_{\{M<N\}}\left(\frac{L\sqrt{\beta\hat{\Delta}_{\mathbf{X}}d\ln(%
1/\delta)}}{\epsilon n^{3/2}M}+\frac{L^{2}}{Mn}\right)\right].
\eta=\frac{1}{2\beta}
\sigma_{1}^{2}=\frac{16L^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}}\max\left(\frac{R%
}{q},1\right)
\sigma_{2}^{2}=\frac{16\beta^{2}R\ln(1/\delta)}{\epsilon^{2}n^{2}}
\hat{\sigma}_{2}^{2}=\frac{64L^{2}R\ln(1/\delta)}{\epsilon^{2}n^{2}}
K_{1}=K_{2}=n
i
i\in[N]
\epsilon\leq 2\ln(1/\delta)
i
\frac{\epsilon^{2}}{8\ln(1/\delta)}
2L/n
\frac{1}{n}\min\{2\beta\|w_{r}-w_{r-1}\|,4L\}
\sup_{X_{i}\sim X^{\prime}_{i}}\|\frac{1}{n}\sum_{j=1}^{n}\nabla f^{0}(w,x_{i,%
j})-\nabla f^{0}(w,x^{\prime}_{i,j})\|=\sup_{x,x^{\prime}}\|\nabla f^{0}(w,x)-%
\nabla f^{0}(w,x^{\prime})\|\leq 2L/n
w
f^{0}
L
\sup_{X_{i}\sim X^{\prime}_{i}}\|\frac{1}{n}\sum_{j=1}^{n}\nabla f^{0}(w_{r},x%
_{i,j}-\nabla f^{0}(w_{r-1},x_{i,j})-(f^{0}(w_{r},x^{\prime}_{i,j})-\nabla f^{%
0}(w_{r-1},x^{\prime}_{i,j}))\|=\frac{1}{n}\sup_{x,x^{\prime}}\|\nabla f^{0}(w%
_{r},x-\nabla f^{0}(w_{r-1},x)-(f^{0}(w_{r},x^{\prime})-\nabla f^{0}(w_{r-1},x%
^{\prime}))\|\leq\frac{1}{n}\min\{2\beta\|w_{r}-w_{r-1}\|,4L\}
f^{0}
L
\beta
R<q
\mathbf{X}\in\mathbb{X}
\widehat{\mathcal{G}}_{\eta}(w)=\widehat{\mathcal{G}}_{\eta}(w,\mathbf{X})
\displaystyle\tau_{1}^{2}=\sup_{r\equiv 0~{}(\text{mod}~{}q)}\mathbb{E}\left\|%
h_{r}-\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})\right\|^{2}
\displaystyle\tau_{1}^{2}
\displaystyle=\sup_{r\equiv 0~{}(\text{mod}~{}q)}\mathbb{E}\left\|h_{r}-\nabla%
\widehat{F}_{\mathbf{X}}^{0}(w_{r})\right\|^{2}
\displaystyle=\sup_{r\equiv 0~{}(\text{mod}~{}q)}\mathbb{E}\left\|\frac{1}{M_{%
r}n}\sum_{i\in S_{r}}\sum_{j=1}^{n}\left[\nabla f^{0}(w_{r},x_{i,j})-\nabla%
\widehat{F}_{\mathbf{X}}^{0}(w_{r})\right]\right\|^{2}+\frac{d\sigma_{1}^{2}}{M}
\displaystyle=\sup_{r\equiv 0~{}(\text{mod}~{}q)}\mathbb{E}\left\|\frac{1}{M_{%
r}n}\sum_{i\in S_{r}}\sum_{j=1}^{n}\left[\nabla f^{0}(w_{r},x_{i,j})-\nabla%
\widehat{F}_{\mathbf{X}}^{0}(w_{r})\right]\right\|^{2}+\frac{d\sigma_{1}^{2}}{M}
\displaystyle\leq\frac{2L^{2}}{Mn}\mathds{1}_{\{M<N\}}+\frac{d\sigma_{1}^{2}}{%
M},
\displaystyle\leq\frac{2L^{2}}{Mn}\mathds{1}_{\{M<N\}}+\frac{d\sigma_{1}^{2}}{%
M},
r
w_{r},w_{r-1}
\displaystyle\mathbb{E}\left\|H_{r}-\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})%
\right\|^{2}
\displaystyle\mathbb{E}\left\|H_{r}-\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})%
\right\|^{2}
\displaystyle\leq 2\left[\frac{d\sigma_{2}^{2}}{M}\|w_{r}-w_{r-1}\|^{2}+%
\mathbb{E}\left\|\frac{1}{M_{r}n}\sum_{i\in S_{r}}\sum_{j=1}^{n}\left[\nabla f%
^{0}(w_{r},x_{i,j})-\nabla f^{0}(w_{r-1},x_{i,j})-\left(\nabla\widehat{F}_{%
\mathbf{X}}^{0}(w_{r})-\widehat{F}_{\mathbf{X}}^{0}(w_{r-1})\right)\right]%
\right\|^{2}\right]
\displaystyle\leq 2\left[\frac{d\sigma_{2}^{2}}{M}\|w_{r}-w_{r-1}\|^{2}+%
\mathbb{E}\left\|\frac{1}{M_{r}n}\sum_{i\in S_{r}}\sum_{j=1}^{n}\left[\nabla f%
^{0}(w_{r},x_{i,j})-\nabla f^{0}(w_{r-1},x_{i,j})-\left(\nabla\widehat{F}_{%
\mathbf{X}}^{0}(w_{r})-\widehat{F}_{\mathbf{X}}^{0}(w_{r-1})\right)\right]%
\right\|^{2}\right]
\displaystyle\leq\frac{2d\sigma_{2}^{2}}{M}\|w_{r}-w_{r-1}\|^{2}+\frac{8\beta^%
{2}}{Mn}\|w_{r}-w_{r-1}\|^{2}\mathds{1}_{\{M<N\}},
\displaystyle\leq\frac{2d\sigma_{2}^{2}}{M}\|w_{r}-w_{r-1}\|^{2}+\frac{8\beta^%
{2}}{Mn}\|w_{r}-w_{r-1}\|^{2}\mathds{1}_{\{M<N\}},
\tau_{2}^{2}=8\left(\frac{\beta^{2}}{Mn}\mathds{1}_{\{M<N\}}+\frac{d\sigma_{2}%
^{2}}{M}\right)
\eta=1/2\beta
q\leq\frac{1}{\eta^{2}\tau_{2}^{2}}
\mathbb{E}\|\mathcal{G}_{\eta}(w_{\text{priv}})\|^{2}\leq 16\left(\frac{\hat{%
\Delta}_{\mathbf{X}}}{\eta R}+\tau_{1}^{2}\right).
g(w_{r}):=-\frac{1}{\eta}(w_{r+1}-w_{r})
y=w_{r+1},~{}z=w=w_{r},~{}d^{\prime}=h_{r}
\displaystyle\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r+1})\leq\mathbb{E}\widehat%
{F}_{\mathbf{X}}(w_{r})+\mathbb{E}\left\langle w_{r+1}-w_{r},\nabla\widehat{F}%
_{\mathbf{X}}^{0}(w_{r})-h_{r}\right\rangle+\left(\frac{\beta}{2}-\frac{1}{2%
\eta}\right)\mathbb{E}\|w_{r+1}-w_{r}\|^{2}-\frac{1}{2\eta}\mathbb{E}\|w_{r+1}%
-w_{r}\|^{2}
\displaystyle\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r+1})
\displaystyle\leq\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r})+\mathbb{E}\left%
\langle w_{r+1}-w_{r},\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})-h_{r}\right%
\rangle+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\mathbb{E}\|w_{r+1}-w_{r}%
\|^{2}-\frac{1}{2\eta}\mathbb{E}\|w_{r+1}-w_{r}\|^{2}
\displaystyle\leq\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r})+\frac{\eta}{2}%
\mathbb{E}\left\|\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})-h_{r}\right\|^{2}+%
\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\mathbb{E}\|w_{r+1}-w_{r}\|^{2}
\displaystyle\leq\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r})+\frac{\eta}{2}%
\mathbb{E}\left\|\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})-h_{r}\right\|^{2}+%
\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\mathbb{E}\|w_{r+1}-w_{r}\|^{2}
\displaystyle=\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r})+\frac{\eta}{2}\mathbb{%
E}\left\|\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})-h_{r}\right\|^{2}+\left(%
\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^{2}\mathbb{E}\|g(w_{r})\|^{2}.
\displaystyle=\mathbb{E}\widehat{F}_{\mathbf{X}}(w_{r})+\frac{\eta}{2}\mathbb{%
E}\left\|\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})-h_{r}\right\|^{2}+\left(%
\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^{2}\mathbb{E}\|g(w_{r})\|^{2}.
\displaystyle\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{r+1})-\widehat{F}_{\mathbf%
{X}}(w_{r})]\leq\frac{\eta}{2}\mathbb{E}\left\|\nabla\widehat{F}_{\mathbf{X}}^%
{0}(w_{r})-h_{r}\right\|^{2}+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^%
{2}\mathbb{E}\|g(w_{r})\|^{2}
\displaystyle\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{r+1})-\widehat{F}_{\mathbf%
{X}}(w_{r})]
\displaystyle\leq\frac{\eta}{2}\mathbb{E}\left\|\nabla\widehat{F}_{\mathbf{X}}%
^{0}(w_{r})-h_{r}\right\|^{2}+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta%
^{2}\mathbb{E}\|g(w_{r})\|^{2}
\displaystyle\leq\frac{\eta}{2}\tau_{2}^{2}\sum_{t=s_{r}+1}^{r}\mathbb{E}[\|w_%
{t}-w_{t-1}\|^{2}]+\frac{\eta}{2}\tau_{1}^{2}+\left(\frac{\beta}{2}-\frac{1}{2%
\eta}\right)\eta^{2}\mathbb{E}\|g(w_{r})\|^{2}
\displaystyle\leq\frac{\eta}{2}\tau_{2}^{2}\sum_{t=s_{r}+1}^{r}\mathbb{E}[\|w_%
{t}-w_{t-1}\|^{2}]+\frac{\eta}{2}\tau_{1}^{2}+\left(\frac{\beta}{2}-\frac{1}{2%
\eta}\right)\eta^{2}\mathbb{E}\|g(w_{r})\|^{2}
\displaystyle=\frac{\eta^{3}}{2}\tau_{2}^{2}\sum_{t=s_{r}+1}^{r}\mathbb{E}[\|g%
(w_{t})\|^{2}]+\frac{\eta}{2}\tau_{1}^{2}+\left(\frac{\beta}{2}-\frac{1}{2\eta%
}\right)\eta^{2}\mathbb{E}\|g(w_{r})\|^{2},
\displaystyle=\frac{\eta^{3}}{2}\tau_{2}^{2}\sum_{t=s_{r}+1}^{r}\mathbb{E}[\|g%
(w_{t})\|^{2}]+\frac{\eta}{2}\tau_{1}^{2}+\left(\frac{\beta}{2}-\frac{1}{2\eta%
}\right)\eta^{2}\mathbb{E}\|g(w_{r})\|^{2},
s_{r}=\lfloor\frac{r}{q}\rfloor q
s_{r}
r
r-q\leq s_{r}\leq r
\displaystyle\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{r+1})-\widehat{F}_{\mathbf%
{X}}(w_{s_{r}})]\leq\frac{\eta^{3}\tau_{2}^{2}}{2}\sum_{k=s_{r}}^{r}\sum_{j=s_%
{r}+1}^{k}\mathbb{E}[\|g(w_{j})\|^{2}]+\sum_{k=s_{r}}^{r}\left[\frac{\eta}{2}%
\tau_{1}^{2}+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^{2}\mathbb{E}\|g%
(w_{k})\|^{2}\right]
\displaystyle\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{r+1})-\widehat{F}_{\mathbf%
{X}}(w_{s_{r}})]
\displaystyle\leq\frac{\eta^{3}\tau_{2}^{2}}{2}\sum_{k=s_{r}}^{r}\sum_{j=s_{r}%
+1}^{k}\mathbb{E}[\|g(w_{j})\|^{2}]+\sum_{k=s_{r}}^{r}\left[\frac{\eta}{2}\tau%
_{1}^{2}+\left(\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^{2}\mathbb{E}\|g(w_{%
k})\|^{2}\right]
\displaystyle\leq\frac{q\eta^{3}\tau_{2}^{2}}{2}\sum_{k=s_{r}}^{r}\mathbb{E}[%
\|g(w_{k})\|^{2}]+\sum_{k=s_{r}}^{r}\left[\frac{\eta}{2}\tau_{1}^{2}+\left(%
\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^{2}\mathbb{E}\|g(w_{k})\|^{2}\right]
\displaystyle\leq\frac{q\eta^{3}\tau_{2}^{2}}{2}\sum_{k=s_{r}}^{r}\mathbb{E}[%
\|g(w_{k})\|^{2}]+\sum_{k=s_{r}}^{r}\left[\frac{\eta}{2}\tau_{1}^{2}+\left(%
\frac{\beta}{2}-\frac{1}{2\eta}\right)\eta^{2}\mathbb{E}\|g(w_{k})\|^{2}\right]
\displaystyle=-\sum_{k=s_{r}}^{r}\left\{\mathbb{E}[\|g(w_{k})\|^{2}]\left(%
\frac{\eta}{2}-\frac{\beta\eta^{2}}{2}-\frac{\eta^{3}\tau_{2}^{2}q}{2}\right)-%
\frac{\eta\tau_{1}^{2}}{2}\right\}
\displaystyle=-\sum_{k=s_{r}}^{r}\left\{\mathbb{E}[\|g(w_{k})\|^{2}]\left(%
\frac{\eta}{2}-\frac{\beta\eta^{2}}{2}-\frac{\eta^{3}\tau_{2}^{2}q}{2}\right)-%
\frac{\eta\tau_{1}^{2}}{2}\right\}
A=\frac{\eta}{2}-\frac{\beta\eta^{2}}{2}-\frac{\eta^{3}\tau_{2}^{2}q}{2}
P=\{p_{0},p_{1},\ldots\}=\left\{0,q,\ldots,\lfloor\frac{R-1}{q}\rfloor q,R\right\}
\displaystyle\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{R})-\widehat{F}_{\mathbf{X%
}}(w_{0})]\leq\sum_{j=1}^{|P|}\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{p_{j}})-%
\widehat{F}_{\mathbf{X}}(w_{p_{j-1}})]
\displaystyle\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{R})-\widehat{F}_{\mathbf{X%
}}(w_{0})]
\displaystyle\leq\sum_{j=1}^{|P|}\mathbb{E}[\widehat{F}_{\mathbf{X}}(w_{p_{j}}%
)-\widehat{F}_{\mathbf{X}}(w_{p_{j-1}})]
\displaystyle\leq\frac{\eta R\tau_{1}^{2}}{2}-A\sum_{r=0}^{R}\mathbb{E}[\|g(w_%
{r})\|^{2}],
\displaystyle\leq\frac{\eta R\tau_{1}^{2}}{2}-A\sum_{r=0}^{R}\mathbb{E}[\|g(w_%
{r})\|^{2}],
\frac{1}{R}\sum_{r=0}^{R}\mathbb{E}[\|g(w_{r})\|^{2}]\leq\frac{\hat{\Delta}_{%
\mathbf{X}}}{RA}+\frac{\eta\tau_{1}^{2}}{2A}.
r\geq 0
\displaystyle\left\|\widehat{\mathcal{G}}_{\eta}(w_{r})-g(w_{r})\right\|^{2}=%
\frac{1}{\eta^{2}}\left\|w_{r+1}-\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta%
\widehat{F}_{\mathbf{X}}^{0}(w_{r}))\right\|^{2}
\displaystyle\left\|\widehat{\mathcal{G}}_{\eta}(w_{r})-g(w_{r})\right\|^{2}
\displaystyle=\frac{1}{\eta^{2}}\left\|w_{r+1}-\texttt{{prox}}_{\eta f^{1}}(w_%
{r}-\eta\widehat{F}_{\mathbf{X}}^{0}(w_{r}))\right\|^{2}
\displaystyle=\frac{1}{\eta^{2}}\left\|\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta
h%
_{r})-\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta\widehat{F}_{\mathbf{X}}^{0}(w_{r%
}))\right\|^{2}
\displaystyle=\frac{1}{\eta^{2}}\left\|\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta
h%
_{r})-\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta\widehat{F}_{\mathbf{X}}^{0}(w_{r%
}))\right\|^{2}
\displaystyle\leq\frac{1}{\eta^{2}}\left\|-\eta h_{r}+\eta\widehat{F}_{\mathbf%
{X}}^{0}(w_{r})\right\|^{2}
\displaystyle\leq\frac{1}{\eta^{2}}\left\|-\eta h_{r}+\eta\widehat{F}_{\mathbf%
{X}}^{0}(w_{r})\right\|^{2}
\displaystyle=\left\|h_{r}-\widehat{F}_{\mathbf{X}}^{0}(w_{r})\right\|^{2},
\displaystyle=\left\|h_{r}-\widehat{F}_{\mathbf{X}}^{0}(w_{r})\right\|^{2},
r=r^{*}\in\{0,1,\ldots,R\}
\displaystyle\mathbb{E}\left\|\widehat{\mathcal{G}}_{\eta}(w_{r^{*}})-g(w_{r^{%
*}})\right\|^{2}\leq\mathbb{E}\left\|h_{r^{*}}-\widehat{F}_{\mathbf{X}}^{0}(w_%
{r^{*}})\right\|^{2}
\displaystyle\mathbb{E}\left\|\widehat{\mathcal{G}}_{\eta}(w_{r^{*}})-g(w_{r^{%
*}})\right\|^{2}
\displaystyle\leq\mathbb{E}\left\|h_{r^{*}}-\widehat{F}_{\mathbf{X}}^{0}(w_{r^%
{*}})\right\|^{2}
\displaystyle\leq\tau_{2}^{2}\sum_{k=s_{r^{*}}+1}^{r^{*}}\mathbb{E}\|w_{k}-w_{%
k-1}\|^{2}+\tau_{1}^{2}
\displaystyle\leq\tau_{2}^{2}\sum_{k=s_{r^{*}}+1}^{r^{*}}\mathbb{E}\|w_{k}-w_{%
k-1}\|^{2}+\tau_{1}^{2}
\displaystyle=\eta^{2}\tau_{2}^{2}\sum_{k=s_{r^{*}}+1}^{r^{*}}\mathbb{E}\|g(w_%
{k-1})\|^{2}+\tau_{1}^{2},
\displaystyle=\eta^{2}\tau_{2}^{2}\sum_{k=s_{r^{*}}+1}^{r^{*}}\mathbb{E}\|g(w_%
{k-1})\|^{2}+\tau_{1}^{2},
\displaystyle\mathbb{E}\left\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})-g(%
w_{\text{priv}})\right\|^{2}\leq\frac{\eta^{2}\tau_{2}^{2}}{R}\sum_{r=1}^{R}%
\sum_{k=s_{r}+1}^{r}\mathbb{E}\|g(w_{r-1})\|^{2}+\tau_{1}^{2}
\displaystyle\mathbb{E}\left\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})-g(%
w_{\text{priv}})\right\|^{2}
\displaystyle\leq\frac{\eta^{2}\tau_{2}^{2}}{R}\sum_{r=1}^{R}\sum_{k=s_{r}+1}^%
{r}\mathbb{E}\|g(w_{r-1})\|^{2}+\tau_{1}^{2}
\displaystyle\leq\frac{q\eta^{2}\tau_{2}^{2}}{R}\sum_{r=1}^{R}\mathbb{E}\|g(w_%
{r-1})\|^{2}+\tau_{1}^{2}
\displaystyle\leq\frac{q\eta^{2}\tau_{2}^{2}}{R}\sum_{r=1}^{R}\mathbb{E}\|g(w_%
{r-1})\|^{2}+\tau_{1}^{2}
\displaystyle\leq q\eta^{2}\tau_{2}^{2}\left[\frac{\hat{\Delta}_{\mathbf{X}}}{%
RA}+\frac{\eta\tau_{1}^{2}}{2A}\right]+\tau_{1}^{2},
\displaystyle\leq q\eta^{2}\tau_{2}^{2}\left[\frac{\hat{\Delta}_{\mathbf{X}}}{%
RA}+\frac{\eta\tau_{1}^{2}}{2A}\right]+\tau_{1}^{2},
\displaystyle\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}%
\leq 2\left[q\eta^{2}\tau_{2}^{2}\left[\frac{\hat{\Delta}_{\mathbf{X}}}{RA}+%
\frac{\eta\tau_{1}^{2}}{2A}\right]+\tau_{1}^{2}\right]+2\mathbb{E}\|g(w_{\text%
{priv}})\|^{2}
\displaystyle\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}
\displaystyle\leq 2\left[q\eta^{2}\tau_{2}^{2}\left[\frac{\hat{\Delta}_{%
\mathbf{X}}}{RA}+\frac{\eta\tau_{1}^{2}}{2A}\right]+\tau_{1}^{2}\right]+2%
\mathbb{E}\|g(w_{\text{priv}})\|^{2}
\displaystyle\leq 2\left[q\eta^{2}\tau_{2}^{2}\left[\frac{\hat{\Delta}_{%
\mathbf{X}}}{RA}+\frac{\eta\tau_{1}^{2}}{2A}\right]+\tau_{1}^{2}\right]+\frac{%
2\hat{\Delta}_{\mathbf{X}}}{RA}+\frac{\eta\tau_{1}^{2}}{A},
\displaystyle\leq 2\left[q\eta^{2}\tau_{2}^{2}\left[\frac{\hat{\Delta}_{%
\mathbf{X}}}{RA}+\frac{\eta\tau_{1}^{2}}{2A}\right]+\tau_{1}^{2}\right]+\frac{%
2\hat{\Delta}_{\mathbf{X}}}{RA}+\frac{\eta\tau_{1}^{2}}{A},
\eta=1/2\beta
q\leq\frac{1}{\tau_{2}^{2}\eta^{2}}
A=\frac{\eta}{2}-\frac{\beta\eta^{2}}{2}-\frac{\eta^{3}\tau_{2}^{2}q}{2}\geq%
\frac{\eta}{4}
\displaystyle\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}%
\leq 8\left[\left(\frac{\hat{\Delta}_{\mathbf{X}}}{R\eta}+\frac{\tau_{1}^{2}}{%
2}\right)+\tau_{1}^{2}\right]+\frac{8\hat{\Delta}_{\mathbf{X}}}{R\eta}+4\tau_{%
1}^{2}
\displaystyle\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}
\displaystyle\leq 8\left[\left(\frac{\hat{\Delta}_{\mathbf{X}}}{R\eta}+\frac{%
\tau_{1}^{2}}{2}\right)+\tau_{1}^{2}\right]+\frac{8\hat{\Delta}_{\mathbf{X}}}{%
R\eta}+4\tau_{1}^{2}
\displaystyle=\frac{16\hat{\Delta}_{\mathbf{X}}}{R\eta}+16\tau_{1}^{2},
\displaystyle=\frac{16\hat{\Delta}_{\mathbf{X}}}{R\eta}+16\tau_{1}^{2},
\tau_{1}^{2}
\tau_{1}^{2}=\frac{2L^{2}}{Mn}\mathds{1}_{\{M<N\}}+\frac{d\sigma_{1}^{2}}{M}%
\leq\frac{2L^{2}}{Mn}\mathds{1}_{\{M<N\}}+\frac{16dL^{2}R\ln(1/\delta)}{q%
\epsilon^{2}n^{2}M}+\frac{16dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M}
\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}\leq 16\left(%
\frac{\hat{\Delta}_{\mathbf{X}}}{\eta R}+\frac{2L^{2}}{Mn}\mathds{1}_{\{M<N\}}%
+\frac{16dL^{2}R\ln(1/\delta)}{q\epsilon^{2}n^{2}M}+\frac{16dL^{2}\ln(1/\delta%
)}{\epsilon^{2}n^{2}M}\right).
R=\frac{\epsilon n\sqrt{Mq}\sqrt{\hat{\Delta}_{\mathbf{X}}\beta}}{L\sqrt{d\ln(%
1/\delta)}}
R
\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}\leq C\left(%
\frac{L\sqrt{\hat{\Delta}_{\mathbf{X}}\beta}\sqrt{d\ln(1/\delta)}}{\epsilon n%
\sqrt{Mq}}+\frac{dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M}+\frac{L^{2}}{Mn}%
\mathds{1}_{\{M<N\}}\right)
C>0
R
q=\left\lfloor\min\left\{\left(\frac{\epsilon nL\sqrt{M}}{\sqrt{d\ln(1/\delta)%
\hat{\Delta}_{\mathbf{X}}\beta}}\right)^{2/3},\frac{nM}{\mathds{1}_{\{M<N\}}}%
\right\}\right\rfloor
q\leq\frac{1}{\tau_{2}^{2}\eta^{2}}
q\geq 1
q
\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}})\|^{2}\leq C^{\prime}%
\left[\left(\frac{\sqrt{L\beta\hat{\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{%
\epsilon n\sqrt{M}}\right)^{4/3}+\frac{dL^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}M%
}+\left(\frac{L\sqrt{\beta\hat{\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{\epsilon n%
^{3/2}M}+\frac{L^{2}}{Mn}\right)\mathds{1}_{\{M<N\}}\right]
C^{\prime}>0
q<1
L<\frac{\sqrt{\beta\hat{\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{\epsilon n\sqrt{M}}
w_{0}
\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},\mathbf{X})\|^{2}\leq
L%
^{2}<\left(\frac{\sqrt{L\beta\hat{\Delta}_{\mathbf{X}}d\ln(1/\delta)}}{%
\epsilon n\sqrt{M}}\right)^{4/3}
r\in\{0,1,\ldots,R\}
s_{r}=\lfloor\frac{r}{q}\rfloor q
\mathbb{E}|h_{s_{r}}-\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{s_{r}})\|^{2}\leq%
\tau_{1}^{2}
\mathbb{E}\left\|H_{r}-\left(\nabla\widehat{F}_{\mathbf{X}}^{0}(w_{r})-\nabla%
\widehat{F}_{\mathbf{X}}^{0}(w_{r-1})\right)\right\|^{2}\leq\tau_{2}^{2}\|w_{r%
}-w_{r-1}\|^{2}
r\geq s_{r}+1
\mathbb{E}\|h_{r}-\nabla\widehat{F}^{0}_{\mathbf{X}}(w_{r})\|^{2}\leq\tau_{2}^%
{2}\sum_{t=s_{r}+1}^{r}\mathbb{E}\|w_{t}-w_{t-1}\|^{2}+\tau_{1}^{2}.
\{a_{l}\}_{l\in[\widetilde{N}]}
\sum_{l=1}^{\widetilde{N}}a_{l}=0
\mathcal{S}
[\widetilde{N}]
\widetilde{M}
\mathbb{E}\left\|\frac{1}{\widetilde{M}}\sum_{l\in\mathcal{S}}a_{l}\right\|^{2%
}=\frac{\widetilde{N}-\widetilde{M}}{(\widetilde{N}-1)\widetilde{M}}\frac{1}{%
\widetilde{N}}\sum_{l=1}^{\widetilde{N}}\|a_{l}\|^{2}\leq\frac{\mathds{1}_{\{%
\widetilde{M}<~{}\widetilde{N}\}}}{\widetilde{M}~{}\widetilde{N}}\sum_{l=1}^{%
\widetilde{N}}\|a_{l}\|^{2}.
R\in\mathbb{N},K_{1},K_{2}\in[n],\mathbf{X}\in\mathbb{X},\eta>0,\epsilon>0,%
\delta\in(0,1/2),q\in\mathbb{N},w_{0}\in\mathcal{W}
r\in\{0,1,\cdots,R\}
i\in S_{r}
w_{r}
i
r\equiv 0~{}(\text{mod}~{}q)
i
K_{1}
\{x_{i,j}^{r}\}_{j=1}^{K_{1}}
X_{i}
i
\left\{\nabla f^{0}(w_{r},x_{i,j}^{r})\right\}_{j=1}^{K_{1}}
h_{r}=\frac{1}{MK_{1}}\mathcal{P}_{\text{vec}}\left(\left\{\nabla f^{0}(w_{r},%
x_{i,j}^{r})\right\}_{i\in S_{r},j\in[K_{1}]};\frac{\epsilon nN}{4K_{1}M\sqrt{%
2\ln(1/\delta)}\max\left(1,\frac{\sqrt{q}}{\sqrt{R}}\right)},\frac{\delta q}{2%
R};L\right).
i
K_{2}
\{x_{i,j}^{r}\}_{j=1}^{K_{1}}
X_{i}
i
J_{i}=\{\nabla f^{0}(w_{r},x_{i,j}^{r})-\nabla f^{0}(w_{r-1},x_{i,j}^{r})\}_{j%
=1}^{K_{2}}
H_{r}=\frac{1}{MK_{2}}\mathcal{P}_{\text{vec}}\Big{(}\{J_{i}\}_{i\in S_{r}};%
\frac{\epsilon Nn}{4MK_{2}\sqrt{2R\ln(1/\delta)}};\frac{\delta}{2R};\min\{2L,%
\beta\|w_{r}-w_{r-1}\|\}\Big{)}
h_{r}=h_{r-1}+H_{r}
w_{r+1}=\texttt{{prox}}_{\eta f^{1}}(w_{r}-\eta h_{r})
w_{\text{priv}}\sim\text{Unif}(\{w_{r}\}_{r=1,\cdots,R})
\epsilon\leq\ln(1/\delta),~{}\delta\in(0,\frac{1}{2})
M_{r}=M\geq\left(\frac{\epsilon Nd^{2}}{n^{2}}\right)^{1/3}\left(\frac{L}{%
\sqrt{\beta\hat{\Delta}_{\mathbf{X}}}}\right)^{1/3}\left[1+\left(\frac{L}{%
\sqrt{\beta\hat{\Delta}_{\mathbf{X}}}}\right)^{1/3}\right].
(\epsilon,\delta)
\small\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},\mathbf{X})\|^{%
2}\lesssim\left[\left(\frac{\sqrt{L\beta\hat{\Delta}_{\mathbf{X}}d\ln^{3}(dnN/%
\delta)}}{\epsilon nN}\right)^{4/3}+\frac{dL^{2}\ln^{3}(Rd/q\delta)}{\epsilon^%
{2}n^{2}N^{2}}+\mathds{1}_{\{M<N\}}\left(\frac{L\sqrt{\beta\hat{\Delta}_{%
\mathbf{X}}d\ln^{3}(dnN/\delta)}}{\epsilon n^{3/2}N\sqrt{M}}+\frac{L^{2}}{Mn}%
\right)\right].
R=\left\lceil\frac{\epsilon nN}{L}\sqrt{\frac{\hat{\Delta}_{\mathbf{X}}\beta}{%
d\ln^{3}(dnN/\delta)}}\min\left\{\frac{\sqrt{Mn}}{\mathds{1}_{\{M<N\}}},\left(%
\frac{\epsilon nNL}{\sqrt{\hat{\Delta}_{\mathbf{X}}\beta d\ln^{3}(dnN/\delta)}%
}\right)\right\}\right\rceil,
\eta=1/2\beta
K_{1}=K_{2}=n
\left(\frac{\epsilon}{2\sqrt{2R\ln(1/\delta)}},\frac{\delta}{2R}\right)
\left(\frac{\epsilon\sqrt{q}}{2\sqrt{2R\ln(1/\delta)}},\frac{\delta q}{2R}\right)
(\epsilon^{\prime},\delta^{\prime})
\epsilon^{\prime}\leq\frac{\epsilon N}{4M\sqrt{2R\ln(1/\delta)}}
\delta^{\prime}=\frac{\delta}{2R}
(\epsilon^{\prime\prime},\delta^{\prime\prime})
\epsilon^{\prime\prime}=\epsilon^{\prime}\sqrt{q}
\delta^{\prime\prime}=\delta^{\prime}\sqrt{q}
R
M
M\geq\frac{\epsilon N}{4\sqrt{2R\ln(1/\delta)}}
\epsilon^{\prime}\leq 1
(\epsilon,\delta)
q\leq R
q>R
r=0
\sigma_{1}^{2}
\mathcal{P}_{\text{vec}}
Z_{1}
Z_{2}
Z_{i}
\mathbb{E}\|Z_{1}\|^{2}\lesssim\frac{dL^{2}\ln^{3}(Rd/q\delta)}{\epsilon^{2}n^%
{2}N^{2}}\max\left(\frac{R}{q},1\right),
\mathbb{E}\|Z_{2}\|^{2}\lesssim\frac{dR\ln^{3}(dR/\delta)}{\epsilon^{2}n^{2}N^%
{2}}\beta^{2}\|w_{r}-w_{r-1}\|^{2}
r
\tau_{1}^{2}=\frac{2L^{2}}{Mn}\mathds{1}_{\{M<N\}}+\frac{dL^{2}\ln^{3}(Rd/q%
\delta)}{\epsilon^{2}n^{2}N^{2}}\max\left(\frac{R}{q},1\right),
\tau_{2}^{2}=8\beta^{2}\left(\frac{\mathds{1}_{\{M<N\}}}{Mn}+\frac{dR\ln^{3}(%
Rd/\delta)}{\epsilon^{2}n^{2}N^{2}}\right).
\mathbb{E}\|\mathcal{G}_{\eta}(w_{\text{priv}})\|^{2}\leq 16\left(\frac{\hat{%
\Delta}_{\mathbf{X}}}{\eta R}+\tau_{1}^{2}\right).
\eta=1/2\beta
q\leq\frac{1}{\eta^{2}\tau_{2}^{2}}
\mathbb{E}\|\widehat{\mathcal{G}}_{\eta}(w_{\text{priv}},\mathbf{X})\|^{2}%
\lesssim\frac{\hat{\Delta}_{\mathbf{X}}}{\eta R}+\frac{L^{2}}{Mn}\mathds{1}_{%
\{M<N\}}+\frac{dL^{2}\ln^{3}(Rd/q\delta)}{\epsilon^{2}n^{2}N^{2}}\max\left(%
\frac{R}{q},1\right).
R
q=\left\lfloor\frac{1}{2}\min\left(\frac{Mn}{\mathds{1}_{\{M<N\}}},\left(\frac%
{\epsilon nNL}{\sqrt{\hat{\Delta}_{\mathbf{X}}\beta d\ln^{3}(Rd/\delta)}}%
\right)\right)\right\rfloor
R
q\leq 1/(\eta^{2}\tau_{2}^{2})
\mathcal{A}
R
(\epsilon_{0},\delta_{0})
\mathcal{X}
\{(\epsilon_{0}^{r},\delta_{0}^{r})\}_{r=1}^{R}
\mathcal{R}^{(i)}_{r}
r
\mathcal{R}^{(i)}_{r}(\mathbf{Z}_{(1:r-1)},\cdot)
(\epsilon_{0}^{r},\delta_{0}^{r})
i\in[N]
\mathbf{Z}_{(1:r-1)}.
C>0
\mathcal{A}
C
\sqrt{\sum_{r\in[R]}(\epsilon_{0}^{r})^{2}}\leq C\epsilon_{0}.
C
\mathcal{A}
1
(\epsilon,\delta)
\mathbb{A}_{(\epsilon,\delta),C}
C
\mathcal{A}
O\mathcal{O}(1)
\mathcal{A}\in\mathbb{A}
\epsilon\in(0,\sqrt{N}],2^{-\Omega(nN)}\leq\delta\leq 1/(nN)^{1+\Omega(1)}
r
(\epsilon_{0}^{r},\delta_{0}^{r})
\epsilon_{0}^{r}\lesssim\frac{1}{n},~{}\delta_{0}^{r}=o(1/nNR)
M=N\geq 16\ln(2/\delta_{0}^{r}n)
L
\beta
f:\mathbb{R}^{d}\times\mathcal{X}\to\mathbb{R}
\mathbf{X}\in\mathcal{X}^{n\times N}
(\epsilon_{0},\delta_{0})
\mathcal{A}
\mathbf{X}
w_{\text{priv}}
\mathbb{E}\|\nabla\widehat{F}_{\mathbf{X}}(w_{\text{priv}})\|^{2}=\Omega\left(%
L^{2}\min\left\{1,\frac{d\ln(1/\delta_{0})}{\epsilon_{0}^{2}n^{2}N}\right\}%
\right).
(\epsilon_{0},\delta_{0})
\left(\mathcal{O}\left(\frac{\epsilon_{0}}{\sqrt{N}}\right),\delta\right)
\mathcal{A}\in\mathbb{A}_{(\epsilon_{0},\delta_{0}),C}
\epsilon_{0}\in(0,\sqrt{N}]
\delta_{0}\in(0,1).
\mathcal{R}^{(i)}_{r}(\mathbf{Z}_{(1:r-1)},\cdot):\mathcal{X}^{n}\to\mathcal{Z}
(\epsilon_{0}^{r},\delta_{0}^{r})
i\in[N],~{}r\in[R],~{}\mathbf{Z}_{(1:r-1)}\in\mathcal{Z}^{r-1\times N}
\epsilon_{0}^{r}\leq\frac{1}{n}
N\geq 16\ln(2/\delta_{0}^{r}n)
\mathcal{A}
C
\delta_{0}^{r}\leq\frac{1}{14nNR}
\delta:=14Nn\sum_{r=1}^{R}\delta_{0}^{r}
\mathcal{A}
\delta_{0}=\delta_{0}^{r}\leq\frac{1}{7Nn}
\delta:=7Nn\delta_{0}.
\mathcal{A}_{s}:\mathbb{X}\to\mathcal{W}
\mathcal{A}
r
\mathcal{A}_{s}
\pi_{r}
[N]
\mathcal{R}^{(i)}_{r}
X_{\pi_{r}(i)}
X_{i}
\mathcal{A}_{s}
(\epsilon,\delta)
\epsilon=\mathcal{O}\left(\frac{\epsilon_{0}\ln\left(1/nN\delta_{0}^{\min}%
\right)C^{2}}{\sqrt{N}}\right),
\delta_{0}^{\min}:=\min_{r\in[R]}\delta_{0}^{r}
\mathcal{A}\in\mathbb{A}
\epsilon=\mathcal{O}\left(\frac{\epsilon_{0}\ln\left(1/nN\delta_{0}^{\min}%
\right)}{\sqrt{N}}\right).
\mathcal{A}
\delta_{0}^{\min}=\delta_{0}.
\mathcal{A}_{s}
\mathcal{A}
g_{r}
g_{r}(Z_{1},\cdots,Z_{N})=g_{r}(Z_{\pi(1)},\cdots Z_{\pi(N)})
\pi
r
\mathcal{R}^{(i)}_{r}=\mathcal{R}_{r}
i\in[N]
\mathcal{R}^{(i)}_{r}
r
M_{r}
r
\mathcal{A}
\mathcal{A}_{s}
[N]
\pi
\pi
(\epsilon_{0},\delta_{0})
\mathcal{A}
\mathcal{A}
\mathcal{A}_{s}
\mathcal{A}_{s}
\epsilon\in(0,\sqrt{N}],2^{-\Omega(nN)}\leq\delta\leq 1/(nN)^{1+\Omega(1)}
L
\beta
f:\mathbb{R}^{d}\times\mathcal{X}\to\mathbb{R}
\mathbf{X}\in\mathcal{X}^{n\times N}
(\epsilon,\delta)
\mathcal{A}
\mathbf{X}
w_{\text{priv}}
\mathbb{E}\|\nabla\widehat{F}_{\mathbf{X}}(w_{\text{priv}})\|^{2}=\Omega\left(%
L^{2}\min\left\{1,\frac{d\ln(1/\delta)}{\epsilon^{2}n^{2}N^{2}}\right\}\right).
\epsilon=\epsilon_{0}/\sqrt{N}
\mathcal{A}_{s}
\mathcal{A}
M=N
M<N
(\epsilon,\delta)
\epsilon\leq 1
\epsilon_{0}=\epsilon/n
\delta_{0}=\delta/4n\leq\delta/(ne^{(n-1)\epsilon_{0}})=\delta/(ne^{(n-1)%
\epsilon/n})
(\epsilon_{0},\delta_{0})
(\epsilon,\delta)
\displaystyle\mathbb{E}F(\widehat{w}_{R})-F(w^{*})=\widetilde{\mathcal{O}}%
\left(\frac{L^{2}}{\mu}\left(\frac{\kappa^{2}\sqrt{d\ln(1/\delta_{0})}}{%
\epsilon_{0}^{2}n^{2}\sqrt{N}}+\frac{\kappa}{\sqrt{Nn}}\right)\right)
\displaystyle\mathbb{E}F(\widehat{w}_{R})-F(w^{*})
\displaystyle=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}\left(\frac{\kappa%
^{2}\sqrt{d\ln(1/\delta_{0})}}{\epsilon_{0}^{2}n^{2}\sqrt{N}}+\frac{\kappa}{%
\sqrt{Nn}}\right)\right)
\displaystyle=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}\left(\frac{\kappa%
^{2}\sqrt{d\ln(1/\delta_{0})}}{\epsilon^{2}\sqrt{N}}+\frac{\kappa}{\sqrt{Nn}}%
\right)\right)
\displaystyle=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}\left(\frac{\kappa%
^{2}\sqrt{d\ln(1/\delta_{0})}}{\epsilon^{2}\sqrt{N}}+\frac{\kappa}{\sqrt{Nn}}%
\right)\right)
\displaystyle=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}\left(\frac{\kappa%
^{2}\sqrt{d\ln(1/\delta_{0})}}{\epsilon^{2}\sqrt{N}}\right)\right).
\displaystyle=\widetilde{\mathcal{O}}\left(\frac{L^{2}}{\mu}\left(\frac{\kappa%
^{2}\sqrt{d\ln(1/\delta_{0})}}{\epsilon^{2}\sqrt{N}}\right)\right).
n
n=1
\widetilde{\mathcal{O}}(\kappa^{2})
N
n
\epsilon\in\{0.75,1,1.5,3,6,12,18\}
N\in\mathbb{N},
d\in\mathbb{N}
\sigma^{2}_{1}
\sigma^{2}_{2}
X_{i}\in\mathcal{X}^{n_{i}}
i\in[N]
f(w,x),
E-1\in\mathbb{N}
K_{1}
K_{2}
\eta
w_{0}^{2}:=0
w_{0}^{i,2}:=w_{0}^{2}
i\in[N]
S_{0}
M_{0}\in[N]
i\in S_{0}
i
K_{2}
\{x^{0,2}_{i,j}\}_{j\in[K_{2}]}
X_{i}
u_{2}^{(i)}\sim N(0,\sigma_{2}^{2}\mathbf{I}_{d}).
i
\widetilde{v}^{i,2}_{0}:=\frac{1}{K_{2}}\sum_{j=1}^{K_{2}}\nabla f(w_{0}^{2},x%
_{i,j}^{0,2})+u_{2}^{(i)}
\widetilde{v}^{2}_{0}:=\frac{1}{M_{0}}\sum_{i\in S_{0}}\widetilde{v}^{i,2}_{0}
r\in\{0,1,\cdots,E-2\}
S_{r+1}
M_{r+1}\in[N]
i\in S_{r+1}
w_{r+1}^{0}:=w_{r}^{2}
w_{r+1}^{1}:=w_{r}^{2}-\eta\widetilde{v}_{r}^{2}
w^{i,0}_{r+1}:=w_{r+1}^{0}
\widetilde{v}^{i,0}_{r+1}:=\widetilde{v}^{2}_{r}
w_{r+1}^{i,1}:=w_{r+1}^{1}
i\in[N])
i
K_{1}
\{x^{r+1,1}_{i,j}\}_{j\in[K_{1}]}
X_{i}
u_{1}^{(i)}\sim N(0,\sigma_{1}^{2}\mathbf{I}_{d}).
i
\widetilde{v}^{i,1}_{r+1}:=\frac{1}{K_{1}}\sum_{j=1}^{K_{1}}[\nabla f(w_{r+1}^%
{1},x^{r+1,1}_{i,j})-\nabla f(w_{r+1}^{0},x^{r+1,1}_{i,j})]+\widetilde{v}^{i,0%
}_{r+1}+u_{1}^{(i)}
\widetilde{v}_{r+1}^{1}:=\frac{1}{M_{r+1}}\sum_{i\in S_{r+1}}\widetilde{v}_{r+%
1}^{i,1}
w_{r+1}^{2}:=w_{r+1}^{1}-\eta\widetilde{v}_{r+1}^{1}
w_{r+1}^{i,2}:=w_{r+1}^{2}
i
K_{2}
\{x_{i,j}^{r+1,2}\}_{j\in[K_{2}]}
X_{i}
u_{2}^{(i)}\sim N(0,\sigma_{2}^{2}\mathbf{I}_{d}).
i
\widetilde{v}^{i,2}_{r+1}:=\frac{1}{K_{2}}\sum_{j=1}^{K_{2}}\nabla f(w_{r+1}^{%
2},x_{i,j}^{r+1,2})+u_{2}^{(i)}
\widetilde{v}_{r+1}^{2}:=\frac{1}{M_{r+1}}\sum_{i\in S_{r+1}}\widetilde{v}^{i,%
2}_{r+1}
w_{\text{priv}}\sim\text{Unif}(\{w_{r}^{t}\}_{r=1,\cdots,E-1;t=1,2})
N=25
\delta=1/n^{2}
n=
\epsilon\in\{0.75,1,1.5,3,6,12,18\}
d=784
d=50
5,421
n=1,543
L
\epsilon\in\{0.75,1,1.5,3,6,12,18\}
(M,R)\in\{(12,25),(12,50),
(25,25),(25,50)\}
e^{-9}
q\in\{1,2,3,4\}
R=50
q\in\{1,2\}
R=25
q
K
\sigma^{2}
K
K
\sigma_{1}^{2}=\frac{16L^{2}\ln(1/\delta)}{\epsilon^{2}n^{2}}\max\left(\frac{R%
}{q},1\right)
\sigma_{2}=\infty
\hat{\sigma}_{2}^{2}=\frac{64L^{2}R\ln(1/\delta)}{\epsilon^{2}n^{2}}
\sigma_{2}=\infty
\beta
\sigma_{1}^{2}=\frac{32L^{2}\ln(2/\delta)R}{n^{2}\epsilon^{2}}
\sigma_{2}^{2}=\frac{8L^{2}\ln(2/\delta)R}{n^{2}\epsilon^{2}}
K_{1}=K_{2}=\frac{n\sqrt{\epsilon}}{2\sqrt{R}}
32
\sigma_{1}^{2}
\ell_{2}
2
K
(M=12,R=25)
(M=25,R=50)
\epsilon\leq 1.5
M=12,R=25
M=12,R=25
M=25,R=50
M=25,R=50
\epsilon=0.75
\epsilon=18
\delta=1/n^{2}
N=10
L
(M,R)=(10,50)
(M,R)=(10,100)
e^{-5}
e^{1}
e^{-5}
e^{0}
e^{-5}
e^{1}
q\in\{1,2,3,4\}
R=50
q\in\{1,2,\dots,8\}
R=100
q
K
\sigma^{2}
K
\epsilon=0.75
\epsilon=18
\delta=1/n^{2}
N=2
\delta=1/n^{2}
n=
\epsilon\in\{0.75,1,1.5,3,6,12,18\}
L
(M,R)=(4,25)
e^{-9}
q\in\{1,2,\dots,10\}
q
K
\sigma^{2}
K
K
\epsilon
