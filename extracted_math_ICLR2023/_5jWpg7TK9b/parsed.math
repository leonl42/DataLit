\mathcal{L}_{2}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
\mathcal{L}_{2}
\mathcal{L}_{p}
\mathbf{x}_{0}\in\mathbb{R}^{d}
\mathbf{x}_{0}\sim q(\mathbf{x}_{0})
\mathbf{x}_{1},\dots,\mathbf{x}_{N}
q(\mathbf{x}_{1}|\mathbf{x}_{0}),\dots,q(\mathbf{x}_{N}|\mathbf{x}_{N-1})
N
\beta_{1},\dots,\beta_{N}
q(\mathbf{x}_{n}|\mathbf{x}_{n-1})
q(\mathbf{x}_{n}|\mathbf{x}_{n-1})=\mathcal{N}(\mathbf{x}_{n};\sqrt{1-\beta_{n%
}}\mathbf{x}_{n-1},\beta_{n}\textbf{I}),
\{\beta_{n}\}
\alpha_{n}=1-\beta_{n},\quad\bar{\alpha}_{n}=\prod_{n=1}^{N}\alpha_{n},\quad%
\tilde{\beta}_{n}=\left\{\begin{array}[]{rrrr}\frac{1-\bar{\alpha}_{n-1}}{1-%
\bar{\alpha}_{n}}\beta_{n},\quad n>1\\
\beta_{1},\quad n=1\end{array}\right.,
\displaystyle q(\mathbf{x}_{n}|\mathbf{x}_{0})=\mathcal{N}(\mathbf{x}_{n};%
\sqrt{\bar{\alpha}_{n}}\mathbf{x}_{0},(1-\bar{\alpha}_{n})\textbf{I})
\displaystyle q(\mathbf{x}_{n}|\mathbf{x}_{0})=\mathcal{N}(\mathbf{x}_{n};%
\sqrt{\bar{\alpha}_{n}}\mathbf{x}_{0},(1-\bar{\alpha}_{n})\textbf{I})
n
q(\mathbf{x}_{n}|\mathbf{x}_{0})
\mathbf{x}_{n-1}\sim p_{\theta}(\mathbf{x}_{n-1}|\mathbf{x}_{n})=\mathcal{N}(%
\mathbf{x}_{n-1};\mu_{\theta}(\mathbf{x}_{n},n),\sigma^{2}_{\theta}(\mathbf{x}%
_{n},n)\textbf{I}),
\mu_{\theta}(\mathbf{x}_{n},n)
\sigma^{2}_{\theta}(\mathbf{x}_{n},n)
\theta
\bm{\epsilon}_{\theta}
\mu_{\theta}
\sigma_{\theta}
\mu_{\theta}(\mathbf{x}_{n},n)=\frac{1}{\sqrt{\alpha_{n}}}\left(\mathbf{x}_{n}%
-\frac{\beta_{n}}{\sqrt{1-\bar{\alpha}_{n}}}\bm{\epsilon}_{\theta}(\mathbf{x}_%
{n},n)\right),\quad\sigma_{\theta}(\mathbf{x}_{n},n)=\sqrt{\tilde{\beta}_{n}}.
\mathbf{x}_{n}(\mathbf{x}_{0},\bm{\epsilon})=\sqrt{\bar{\alpha}_{n}}\mathbf{x}%
_{0}+\sqrt{(1-\bar{\alpha}_{n})}\bm{\epsilon},\bm{\epsilon}\sim\mathcal{N}(0,%
\textbf{I})
\displaystyle\theta^{\star}=\mathop{\arg\max}\limits_{\theta}\sum_{n=1}^{N}%
\lambda_{n}\mathbb{E}_{\mathbf{x}(0)}\left\|\bm{\epsilon}-\bm{\epsilon}_{%
\theta}(\sqrt{\bar{\alpha}_{n}}\mathbf{x}_{0}+\sqrt{(1-\bar{\alpha}_{n})}\bm{%
\epsilon},n)\right\|_{2}^{2}
\displaystyle\theta^{\star}=\mathop{\arg\max}\limits_{\theta}\sum_{n=1}^{N}%
\lambda_{n}\mathbb{E}_{\mathbf{x}(0)}\left\|\bm{\epsilon}-\bm{\epsilon}_{%
\theta}(\sqrt{\bar{\alpha}_{n}}\mathbf{x}_{0}+\sqrt{(1-\bar{\alpha}_{n})}\bm{%
\epsilon},n)\right\|_{2}^{2}
\lambda_{n}
N\to\infty
\mathrm{d}\mathbf{x}=-\frac{1}{2}\beta(t)\mathbf{x}\mathrm{d}t+\sqrt{\beta(t)}%
\mathrm{d}\mathbf{w}.
t\in[0,1]
\mathrm{d}t
\mathbf{w}
\beta(t)
\mathrm{d}\mathbf{x}=-\frac{1}{2}\beta(t)[\mathbf{x}+2\nabla_{\mathbf{x}}\log p%
_{t}(\mathbf{x})]\mathrm{d}t+\sqrt{\beta(t)}\mathrm{d}\bar{\mathbf{w}},
\mathrm{d}t
\bar{\mathbf{w}}
\Delta t=\frac{1}{N}
t=\frac{n}{N}
n\in\{1,\dots,N\}
\beta(\frac{n}{N}):=\beta_{n}
\bar{\alpha}(\frac{n}{N}):=\bar{\alpha}_{n}
\tilde{\beta}(\frac{n}{N}):=\tilde{\beta}_{n}
\mathbf{x}(\frac{n}{N}):=\mathbf{x}_{n}
x_{adv}
t=0
\mathbf{x}_{0}=\mathbf{x}_{adv}
t=0
t^{\star}=\frac{n^{\star}}{N}
n^{*}
\mathbf{x}(t^{\star})=\sqrt{\bar{\alpha}(t^{\star})}\mathbf{x}_{adv}+\sqrt{1-%
\bar{\alpha}(t^{\star})}\mathbf{z},\qquad\mathbf{z}\sim\mathcal{N}(0,\textbf{I%
}),
t=t^{\star}
t=0
\mathbf{sdeint}
\hat{\mathbf{x}}(0)
t=0
\hat{\mathbf{x}}(0)=\mathbf{sdeint}(\mathbf{x}(t^{\star}),f_{rev},g_{rev},\bar%
{\mathbf{w}},t^{\star},0).
f_{rev}(\mathbf{x},t):=-\frac{1}{2}\beta(t)[\mathbf{x}+2\mathbf{s}_{\theta}(%
\mathbf{x},t)],\qquad g_{rev}(t):=\sqrt{\tilde{\beta}(t)}.
\epsilon_{\theta}(\mathbf{x}_{n},n)
s_{\theta}(\mathbf{x},t)
\tilde{\epsilon}_{\theta}(\mathbf{x}(t),t):=\epsilon_{\theta}(\mathbf{x}(\frac%
{n}{N}),n)=\epsilon_{\theta}(\mathbf{x}_{n},n)
t:=\frac{n}{N}
\mathbf{s}_{\theta}(\mathbf{x},t)=-\frac{\tilde{\epsilon}_{\theta}(\mathbf{x},%
t)}{\sqrt{1-\bar{\alpha}(t)}}\approx\nabla_{\mathbf{x}}\log p_{t}(\mathbf{x}).
\hat{\mathbf{x}}(0)
\mathbf{x}(0)=\mathbf{x}_{adv}
\mathbf{Purifier}:\mathbb{R}^{d}\times\mathbb{R}\rightarrow\mathbb{R}^{d}
\mathbf{Purifier}(\mathbf{x}_{adv},n^{\star})=\mathbf{sdeint}\left(\sqrt{\bar{%
\alpha}(\frac{n^{\star}}{N})}\mathbf{x}_{adv}+\sqrt{1-\bar{\alpha}(\frac{n^{%
\star}}{N})}\mathbf{z},f_{rev},g_{rev},\bar{\mathbf{w}},\frac{n^{\star}}{N},0\right)
\text{Wave2Mel}:\mathbb{R}^{d}\rightarrow\mathbb{R}^{m}\times\mathbb{R}^{n}
F:\mathbb{R}^{m}\times\mathbb{R}^{n}\rightarrow\mathbb{R}^{c}
\mathbf{AS}:\mathbb{R}^{d}\times\mathbb{R}\rightarrow\mathbb{R}^{c}
\displaystyle\mathbf{AS}(\mathbf{x}_{adv},n^{\star})=F(\text{Wave2Mel}(\mathbf%
{Purifier}(\mathbf{x}_{adv},n^{\star})))
\displaystyle\mathbf{AS}(\mathbf{x}_{adv},n^{\star})
\displaystyle=F(\text{Wave2Mel}(\mathbf{Purifier}(\mathbf{x}_{adv},n^{\star})))
\mathbf{Purifier}
\mathbf{Purifier}_{spec}:\mathbb{R}^{m}\times\mathbb{R}^{n}\times\mathbb{R}%
\rightarrow\mathbb{R}^{m}\times\mathbb{R}^{n}
\displaystyle\mathbf{AS}(\mathbf{x}_{adv},n^{\star})=F(\mathbf{Purifier}_{spec%
}(\text{Wave2Mel}(\mathbf{x}_{adv})),n^{\star})
\displaystyle\mathbf{AS}(\mathbf{x}_{adv},n^{\star})
\displaystyle=F(\mathbf{Purifier}_{spec}(\text{Wave2Mel}(\mathbf{x}_{adv})),n^%
{\star})
\mathbf{x}(t^{\star})
\mathbf{x}(0)
\mathcal{L}
x(t^{\star})
\begin{pmatrix}\mathbf{x}(t^{\star})\\
\frac{\partial\mathcal{L}}{\partial\mathbf{x}(t^{\star})}\end{pmatrix}=\mathbf%
{sdeint}\left(\begin{pmatrix}\mathbf{x}(0)\\
\frac{\partial\mathcal{L}}{\partial\mathbf{x}(0)}\end{pmatrix},\begin{pmatrix}%
f_{rev}\\
\frac{\partial f_{rev}}{\partial\mathbf{x}}\mathbf{z}\end{pmatrix},\begin{%
pmatrix}g_{rev}\mathbf{1}\\
\mathbf{0}\end{pmatrix},\begin{pmatrix}-\mathbf{w}(1-t)\\
-\mathbf{w}(1-t)\end{pmatrix},0,t^{\star}\right)
\mathbf{1}
\mathbf{0}
\sigma_{\theta}^{2}=\tilde{\beta_{t}}
\sigma_{\theta}^{2}=\beta_{t}
\sigma_{\theta}^{2}=\tilde{\beta_{t}}
\sigma_{\theta}^{2}=\beta_{t}
\tilde{\beta}(\frac{n}{N})=\tilde{\beta}_{n}
g_{rev}=\sqrt{\tilde{\beta}(t)}
g_{rev}=\sqrt{\beta(t)}
\tilde{\beta_{t}}
\beta(t)=\beta_{0}+(\beta_{N}-\beta_{0})t
\tilde{\alpha}(t)=e^{-\int_{0}^{t}\beta(s)\mathrm{d}s}
\beta(t)=\beta_{0}+(\beta_{N}-\beta_{0})t
\beta_{Nt}
N
N=200
t
0
\tilde{\alpha}(t)=e^{-\int_{0}^{t}\beta(s)\mathrm{d}s}
\bar{\alpha}_{Nt}
\beta(\frac{n}{N}):=\beta_{n}
\bar{\alpha}(\frac{n}{N}):=\bar{\alpha}_{n}
\mathcal{L}_{2}
0\sim 9
L_{\infty}
L_{2}
\epsilon=0.002
\mathcal{L}_{\infty}
\epsilon=0.253
L_{2}
\kappa=0.5
\mathcal{L}_{\infty}
\epsilon=0.002
ratio=0.5
n^{\star}
\mathcal{L}_{\infty}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
\mathcal{L}_{2}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
\mathcal{L}_{\infty}
n\geq 70
\epsilon
\epsilon
\epsilon=\{0.002,0.004,0.008,0.016\}
n^{\star}
n^{\star}
n^{\star}
\epsilon
\epsilon
n^{\star}
n^{\star}
\epsilon
n^{\star}
\epsilon
n^{\star}
\epsilon
n^{\star}
\epsilon
n^{\star}
n^{\star}=0
n^{\star}=1
n^{\star}=2
n^{\star}=3
n^{\star}=5
n^{\star}=7
n^{\star}=10
\epsilon=0.002
\epsilon=0.004
\epsilon=0.008
\epsilon=0.016
\mathcal{L}_{\infty}
\mathcal{L}_{\infty}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
\mathcal{L}_{2}
\mathcal{L}_{\infty}
\mathcal{L}_{2}
N=100,000
\sigma\in\{0.5,1.0\}
\mathcal{L}_{2}
\sigma=\{0.5,1.0\}
\sigma=0.5
\mathcal{L}_{2}
\sigma
\sigma
\mathcal{L}_{2}
\sigma=0.5
\sigma=1.0
\sigma=0.5
\sigma=1.0
\sigma=0.5
\sigma=1.0
image\_size=32
num\_channels=3
num\_res\_blocks=128
N=200
\beta_{1}=0.0001
\beta_{N}=0.02
1e-4
n^{\star}=1
n^{\star}=5
\mathcal{L}_{2}
\sigma
t^{\star}
\mathbf{x}_{n}=\sqrt{\bar{\alpha}_{n}}\mathbf{x}_{0}+\sqrt{1-\bar{\alpha}_{t}}%
\mathbf{z}=\sqrt{\bar{\alpha}_{n}}(\mathbf{x}_{0}+\sqrt{\frac{1-\bar{\alpha}_{%
n}}{\bar{\alpha}_{n}}}\mathbf{z}),\qquad\mathbf{z}\sim\mathcal{N}(0,\textbf{I}),
\hat{\textbf{x}}
\hat{\mathbf{x}}=\mathbf{x}_{0}+\sqrt{\sigma}\mathbf{z},\qquad\mathbf{z}\sim%
\mathcal{N}(0,\textbf{I}).
n^{\star}
\frac{1-\bar{\alpha}_{n}}{\bar{\alpha}_{n}}=\sigma
\sqrt{\bar{\alpha}_{n}}
\hat{\textbf{x}}
\mathbf{x}_{0}=\frac{1}{\sqrt{\bar{\alpha}_{n}}}(\mathbf{x}_{n}-\sqrt{1-\bar{%
\alpha}_{n}}\bm{\epsilon}_{\theta}(\sqrt{\bar{\alpha}_{n}}\hat{\mathbf{x}},n))
\sigma=0.50
\mathcal{L}_{2}
\sigma
\sigma
\mathcal{L}_{2}
\sigma
\sigma
p(x)
q(x)
p_{t}
q_{t}
x(t)
x(t)\sim p(x)
x(t)
x(t)\sim q(x)
\frac{\partial D_{KL}(p_{t}||q_{t})}{\partial t}\leq 0
p_{t}=q_{t}
t
p_{t}
q_{t}
n^{\star}
n^{\star}
n^{\star}
f(x,t):=-\frac{1}{2}\beta(t)
g(t):=\sqrt{\beta(t)}
\displaystyle\frac{\partial p_{t}(x)}{\partial t}=-\nabla_{x}\left(f(x,t)p_{t}%
(x)-\frac{1}{2}g^{2}(t)\nabla_{x}p_{t}(x)\right)
\displaystyle\frac{\partial p_{t}(x)}{\partial t}
\displaystyle=-\nabla_{x}\left(f(x,t)p_{t}(x)-\frac{1}{2}g^{2}(t)\nabla_{x}p_{%
t}(x)\right)
\displaystyle=-\nabla_{x}\left(f(x,t)p_{t}(x)-\frac{1}{2}g^{2}(t)p_{t}(x)%
\nabla_{x}\log p_{t}(x)\right)
\displaystyle=-\nabla_{x}\left(f(x,t)p_{t}(x)-\frac{1}{2}g^{2}(t)p_{t}(x)%
\nabla_{x}\log p_{t}(x)\right)
\displaystyle=\nabla_{x}\cdot(h_{p}(x,t)p_{t}(x))
\displaystyle=\nabla_{x}\cdot(h_{p}(x,t)p_{t}(x))
h_{p}(x,t):=\frac{1}{2}g^{2}(t)\nabla_{x}\log p_{t}(x)-f(x,t)
p_{t}
q_{t}
i=1,\dots,d
\lim_{x_{i}\to\infty}p_{t}(x)\frac{\partial}{\partial x_{i}}\log p_{t}(x)=0,%
\qquad\lim_{x_{i}\to\infty}q_{t}(x)\frac{\partial}{\partial x_{i}}\log q_{t}(x%
)=0
x_{i}
i
x\in\mathbb{R}^{d}
\displaystyle\frac{\partial D_{KL}(p_{t}||q_{t})}{\partial t}=-\frac{\partial}%
{\partial t}\int p_{t}(x)\log\frac{p_{t}(x)}{q_{t}(x)}\mathrm{d}x
\displaystyle\frac{\partial D_{KL}(p_{t}||q_{t})}{\partial t}
\displaystyle=-\frac{\partial}{\partial t}\int p_{t}(x)\log\frac{p_{t}(x)}{q_{%
t}(x)}\mathrm{d}x
\displaystyle=-\nabla_{x}\left(f(x,t)p_{t}(x)-\frac{1}{2}g^{2}(t)p_{t}(x)%
\nabla_{x}\log p_{t}(x)\right)
\displaystyle=-\nabla_{x}\left(f(x,t)p_{t}(x)-\frac{1}{2}g^{2}(t)p_{t}(x)%
\nabla_{x}\log p_{t}(x)\right)
\displaystyle=\int\nabla_{x}\cdot(h_{p}(x,t)p_{t}(x))\log\frac{p_{t}(x)}{q_{t}%
(x)}\mathrm{d}x+\int\frac{p_{t}(x)}{q_{t}(x)}\nabla_{x}\cdot(h_{p}(x,t)p_{t}(x%
))\mathrm{d}x
\displaystyle=\int\nabla_{x}\cdot(h_{p}(x,t)p_{t}(x))\log\frac{p_{t}(x)}{q_{t}%
(x)}\mathrm{d}x+\int\frac{p_{t}(x)}{q_{t}(x)}\nabla_{x}\cdot(h_{p}(x,t)p_{t}(x%
))\mathrm{d}x
\displaystyle=-\int p_{t}(x)[h_{p}(x,t)-h_{q}(x,t)]^{\top}[\nabla_{x}\log p_{t%
}(x)-\nabla_{x}\log q_{t}(x)]\mathrm{d}x
\displaystyle=-\int p_{t}(x)[h_{p}(x,t)-h_{q}(x,t)]^{\top}[\nabla_{x}\log p_{t%
}(x)-\nabla_{x}\log q_{t}(x)]\mathrm{d}x
\displaystyle=-\frac{1}{2}g^{2}(t)\int p_{t}(x)\|\nabla_{x}\log p_{t}(x)-%
\nabla_{x}\log q_{t}(x)\|_{2}^{2}\mathrm{d}x
\displaystyle=-\frac{1}{2}g^{2}(t)\int p_{t}(x)\|\nabla_{x}\log p_{t}(x)-%
\nabla_{x}\log q_{t}(x)\|_{2}^{2}\mathrm{d}x
\displaystyle=-\frac{1}{2}g^{2}(t)D_{F}(p_{t}||q_{t})
\displaystyle=-\frac{1}{2}g^{2}(t)D_{F}(p_{t}||q_{t})
D_{F}(p_{t}||q_{t})
g^{2}(t)=\beta(t)>0
D_{F}(p_{t}||q_{t})\geq 0
p_{t}=q_{t}
p_{t}=q_{t}
lr=2e-4
batch\_size\_per\_gpu=2
\mathcal{L}_{\infty}
\epsilon=0.002
n^{\star}
n^{\star}
\mathop{\arg\max}\limits_{x^{\prime}}\Delta(x,x^{\prime})=\|STFT(x),STFT(x^{%
\prime})\|_{\infty},\quad s.t.\|x-x^{\prime}\|_{\infty}
x
x^{\prime}
x^{\prime}_{t+1}=clip(x^{\prime}_{t}+\alpha\cdot sign(\nabla_{x}\Delta(x,x^{%
\prime}_{t})),x-\epsilon,x+\epsilon),
t=1,\dots,T
T=100
\epsilon=0.002
\alpha=0.0004
\mathcal{L}_{tuning}=\mathcal{L}_{audio}+\lambda\mathcal{L}_{feat},
\mathcal{L}_{audio}=MSE(x,\mathbf{Purifier}(x^{\prime}_{t},n^{\star})),
\mathcal{L}_{feat}=MSE(STFT(x),STFT(\mathbf{Purifier}(x^{\prime}_{t},n^{\star}%
)).
\lambda=0.1
\mathcal{L}_{tuning}
1e-5
n^{\star}=3
\mathcal{L}_{\infty}
\epsilon=0.002
lr=1e-3
\beta_{1}=0.5
\beta_{2}=0.9
\epsilon=0.002
\mathcal{L}_{\infty}
\epsilon=0.002
batch\_size=20
\mathcal{L}_{\infty}
\epsilon=0.002
\mathcal{L}_{reg}=\sum_{i}\left(\mathcal{L}(x_{i},y_{i})+\lambda\|\frac{%
\partial f(x_{i})}{\partial x_{i}}\|_{F}\right),
x_{i}\in\mathbb{R}^{d}
y_{i}\in\mathbb{R}^{n}
\mathcal{L}:\mathbb{R}^{d}\times\mathbb{R}^{n}\to\mathbb{R}
f:\mathbb{R}^{d}\to\mathbb{R}^{n}
\lambda
\lambda
\lambda
\lambda
\lambda
\lambda
\lambda
\epsilon
\epsilon=\{0.01,0.02,0.03,0.04,0.05\}
n^{\star}
\epsilon=0.03
\epsilon=0.05
\epsilon
n^{\star}
n^{\star}
\epsilon=0.01
\epsilon=0.02
\epsilon=0.03
\epsilon=0.04
\epsilon=0.05
n^{\star}
n^{\star}
n^{\star}=0
n^{\star}=1
n^{\star}=2
n^{\star}=3
n^{\star}=5
n^{\star}=7
n^{\star}=10
