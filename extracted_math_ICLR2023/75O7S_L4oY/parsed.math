k
k
k
n
c\in\mathbb{N}
\bm{m}=[m_{1},\ldots,m_{c}]\in\mathbb{N}^{c}
N=\sum_{i=1}^{c}m_{i}
n\in\{0,\ldots,N\}
\bm{x}=[x_{1},\ldots,x_{c}]\in\mathbb{N}_{0}^{c}
\sum_{i=1}^{c}x_{i}=n
x_{i}
i
\bm{X}
\displaystyle P(\bm{X}=\bm{x};\bm{\omega})=p_{\bm{X}}(\bm{x};\bm{\omega})=%
\frac{1}{P_{0}}\prod_{i=1}^{c}\binom{m_{i}}{x_{i}}\omega_{i}^{x_{i}}\hskip 7.1%
1317pt
\displaystyle P(\bm{X}=\bm{x};\bm{\omega})=p_{\bm{X}}(\bm{x};\bm{\omega})=%
\frac{1}{P_{0}}\prod_{i=1}^{c}\binom{m_{i}}{x_{i}}\omega_{i}^{x_{i}}\hskip 7.1%
1317pt
P_{0}=\sum_{\bm{y}\in\mathcal{S}}\prod_{i=1}^{c}\binom{m_{i}}{y_{i}}\omega_{i}%
^{y_{i}}
\mathcal{S}
\mathcal{S}=\{\bm{x}\in\mathbb{N}_{0}^{c}:\forall i\quad x_{i}\leq m_{i},\sum_%
{i=1}^{c}x_{i}=n\}
\binom{n}{k}=\frac{n!}{k!(n-k)!}
\bm{m}
n
\bm{\omega}
\bm{m}
n
\bm{\omega}
\bm{\omega}
\bm{\omega}
\bm{m}\in\mathbb{N}^{c}
\bm{\omega}\in\mathbb{R}_{0+}^{c}
n\in\mathbb{N}
\tau\in\mathbb{R}_{0+}
\bm{x}\in\mathbb{N}_{0}^{c}
\{\bm{\alpha}_{i}\in\mathbb{R}^{m_{i}}\}_{i=1}^{c}
\{\hat{\bm{r}}_{i}\in\mathbb{R}^{m_{i}}\}_{i=1}^{c}
i\in\{1,\ldots,c\}
L\leftarrow i,R\leftarrow\{\bigcup_{j=i+1}^{c}j\}
\bm{m}\rightarrow m_{L},m_{R}\in\mathbb{Z}_{0+}
\bm{\omega}\rightarrow\omega_{L},\omega_{R}\in\mathbb{R}_{0+}
x_{L},\bm{\alpha}_{L},\hat{\bm{r}}_{L}\leftarrow
m_{L},m_{R},\omega_{L},\omega_{R},n,\tau
n\leftarrow n-x_{L}
\bm{m}\leftarrow\bm{m}\setminus\bm{m}_{L}
\bm{\omega}\leftarrow\bm{\omega}\setminus\bm{\omega}_{L}
x_{i}\leftarrow x_{L},\bm{\alpha}_{i}\leftarrow\bm{\alpha}_{L},\hat{\bm{r}}_{i%
}\leftarrow\hat{\bm{r}}_{L}
i
\bm{x},\{\bm{\alpha}_{i}\}_{i=1}^{c},\{\hat{\bm{r}}_{i}\}_{i=1}^{c}
m_{i},m_{j},\omega_{i},\omega_{j},n,\tau
\bm{\alpha}_{i}
\leftarrow
m_{i},m_{j},\omega_{i},\omega_{j},n
x_{i},\hat{\bm{r}}_{i}
\leftarrow
\bm{\alpha}_{i},\tau)
x_{i},\bm{\alpha}_{i},\hat{\bm{r}}_{i}
\mathcal{S}
\displaystyle p_{\bm{X}}(\bm{x};\bm{\omega})=p_{X_{1}}(x_{1};\bm{\omega})\prod%
_{i=2}^{c}p_{X_{i}}(x_{i}|\{\bigcup_{j<i}x_{j}\};\bm{\omega})
\displaystyle p_{\bm{X}}(\bm{x};\bm{\omega})=p_{X_{1}}(x_{1};\bm{\omega})\prod%
_{i=2}^{c}p_{X_{i}}(x_{i}|\{\bigcup_{j<i}x_{j}\};\bm{\omega})
p_{X_{i}}(\cdot)
i
j<i
p_{X_{i}}(\cdot)
L
R
i=1..c
L:=\{i\}
R:=\{j:j>i\land j\leq c\}
L
R
\displaystyle m_{L}=\sum_{l\in L}m_{l},\hskip 14.22636ptm_{R}=\sum_{r\in R}m_{%
r},\hskip 14.22636pt\omega_{L}=\frac{\sum_{l\in L}\omega_{l}\cdot m_{l}}{m_{L}%
},\hskip 14.22636pt\omega_{R}=\frac{\sum_{r\in R}\omega_{r}\cdot m_{r}}{m_{R}}
\displaystyle m_{L}=\sum_{l\in L}m_{l},\hskip 14.22636ptm_{R}=\sum_{r\in R}m_{%
r},\hskip 14.22636pt\omega_{L}=\frac{\sum_{l\in L}\omega_{l}\cdot m_{l}}{m_{L}%
},\hskip 14.22636pt\omega_{R}=\frac{\sum_{r\in R}\omega_{r}\cdot m_{r}}{m_{R}}
\bm{\tilde{\omega}}
\bm{\omega}
\bm{\omega}
\bm{\omega}
p_{X_{L}}(x_{L};\bm{\omega})
L
R
m_{L},m_{R},\omega_{L},\omega_{R}
n
\displaystyle p_{X_{L}}(x_{L};\bm{\omega})=\frac{1}{P_{0}}\binom{m_{L}}{x_{L}}%
\omega_{L}^{x_{L}}\binom{m_{R}}{n-x_{L}}\omega_{R}^{n-x_{L}}
\displaystyle p_{X_{L}}(x_{L};\bm{\omega})=\frac{1}{P_{0}}\binom{m_{L}}{x_{L}}%
\omega_{L}^{x_{L}}\binom{m_{R}}{n-x_{L}}\omega_{R}^{n-x_{L}}
P_{0}
\omega_{L},\omega_{R}
\bm{\omega}
m_{L},m_{R},n
\bm{\omega}
\log
\displaystyle\log p_{X_{L}}(x_{L};\bm{\omega})=x_{L}\log\omega_{L}+(n-x_{L})%
\log\omega_{R}+\psi_{F}(x_{L})+C
\displaystyle\log p_{X_{L}}(x_{L};\bm{\omega})=
\displaystyle x_{L}\log\omega_{L}+(n-x_{L})\log\omega_{R}+\psi_{F}(x_{L})+C
C
\psi_{F}(x_{L})
\displaystyle\psi_{F}(x_{L})=-\log\left(\Gamma(x_{L}+1)\Gamma(n-x_{L}+1)\right%
)-\log\left(\Gamma(m_{L}-x_{L}+1)\Gamma(m_{R}-n+x_{L}+1)\right)
\displaystyle\psi_{F}(x_{L})=-\log\left(\Gamma(x_{L}+1)\Gamma(n-x_{L}+1)\right%
)-\log\left(\Gamma(m_{L}-x_{L}+1)\Gamma(m_{R}-n+x_{L}+1)\right)
\log\Gamma(\cdot)
\mathcal{S}
c
\mathcal{S}
\prod_{i=1}^{c}m_{i}
p_{X_{L}}(\cdot)
p_{X_{i}}(x_{i}|\{x_{k}\}_{k=1}^{i-1};\bm{\omega})
i
k<i
\bm{\omega}
\displaystyle\bm{u}\sim\bm{U}(0,1),\hskip 28.45274pt\bm{g}_{i}=-\log(-\log(\bm%
{u})),\hskip 28.45274pt\hat{\bm{r}}_{i}=\bm{\alpha}_{i}(\bm{\omega})+\bm{g}_{i}
\displaystyle\bm{u}
\displaystyle\sim\bm{U}(0,1),\hskip 28.45274pt\bm{g}_{i}=-\log(-\log(\bm{u})),%
\hskip 28.45274pt\hat{\bm{r}}_{i}=\bm{\alpha}_{i}(\bm{\omega})+\bm{g}_{i}
\bm{u}\in[0,1]^{m_{i}+1}
\bm{U}
\bm{g}_{i}
\hat{\bm{r}}_{i}
i
\bm{\alpha}_{i}(\bm{\omega})
\displaystyle\bm{\alpha}_{i}(\bm{\omega})=\log\bm{p}_{X_{i}}(\bm{x}_{i};\bm{%
\omega})-C=[\log p_{X_{i}}(0;\bm{\omega}),\ldots,\log p_{X_{i}}(m_{i};\bm{%
\omega})]-C
\displaystyle\bm{\alpha}_{i}(\bm{\omega})=\log\bm{p}_{X_{i}}(\bm{x}_{i};\bm{%
\omega})-C=[\log p_{X_{i}}(0;\bm{\omega}),\ldots,\log p_{X_{i}}(m_{i};\bm{%
\omega})]-C
(m_{i}+1)
\hat{\bm{r}_{i}}/\tau
\tau
C
\bm{\alpha}_{i}
i
\bm{\omega}
\bm{x}_{i}=[0,\ldots,m_{i}]
\sum_{i=1}^{c}m_{i}
c
\bm{\omega}
\omega_{1}
\omega_{3}
1.0
\omega_{2}
1.0
10.0
1.0
\omega_{2}
50000
p
c=3
t=0.05
p>0.05
m_{i}=200
\forall i
n=180
\omega_{1}
\omega_{3}
1
3
1.0
\omega_{2}
1.0
10.0
1.0
2
p
m_{i}=200
\forall i
n=180
\omega_{1}
\omega_{3}
1
3
1.0
\omega_{2}
1.0
10.0
1.0
2
p
2
\omega_{2}
1
3
p
1.0
30
30
0
0
s=0
s=1
s=3
s=5
0.14{\scriptstyle\pm 0.01}
0.19{\scriptstyle\pm 0.03}
0.16{\scriptstyle\pm 0.01}
\bm{0.10}{\scriptstyle\pm 0.00}
0.23{\scriptstyle\pm 0.01}
\bm{0.34}{\scriptstyle\pm 0.00}
0.00{\scriptstyle\pm 0.00}
0.12{\scriptstyle\pm 0.01}
0.19{\scriptstyle\pm 0.01}
0.15{\scriptstyle\pm 0.01}
\bm{0.10}{\scriptstyle\pm 0.03}
0.22{\scriptstyle\pm 0.02}
0.33{\scriptstyle\pm 0.03}
0.00{\scriptstyle\pm 0.00}
\bm{0.18}{\scriptstyle\pm 0.01}
\bm{0.22}{\scriptstyle\pm 0.05}
\bm{0.19}{\scriptstyle\pm 0.01}
0.08{\scriptstyle\pm 0.02}
\bm{0.28}{\scriptstyle\pm 0.01}
0.28{\scriptstyle\pm 0.01}
\bm{0.01}{\scriptstyle\pm 0.00}
(s,\hat{s})
s
\hat{s}
(s,\hat{s})
s
\hat{s}
1
\bm{\omega}\in\mathbb{R}_{0+}^{2}
\bm{\omega}
d
k
s:=d-k
\hat{k}
\hat{s}:=d-\hat{k}
\bm{\omega}
\hat{k}
\hat{s}
(s,\hat{s})
s
\hat{s}
k
s
s=\{0,1,3,5\}
s=0
\hat{s}
s
s
\hat{s}
\blacksquare
\pi_{i}
\blacksquare
\blacksquare
\pi_{i}
\blacksquare
X=\{\mathbf{x}_{i}\}_{i=1}^{N}
K
p(\mathbf{c};\bm{\pi})
\mathbf{z}_{i}
c_{i}
\mathbf{x}_{i}
\bm{\mu}_{x_{i}}
\bm{\theta}
\mathbf{z}_{i}
\{\bm{\mu}_{i},\bm{\sigma}^{2}_{i}\}_{i=1}^{K}
\bm{92.0\pm 3.0}
87.2\pm 5.0
91.4\pm 5.0
84.8\pm 2.2
81.8\pm 1.9
\bm{85.6\pm 2.0}
84.2\pm 4.3
78.3\pm 4.6
\bm{84.8\pm 4.6}
90.8\pm 4.0
87.4\pm 4.7
\bm{92.5\pm 0.5}
84.1\pm 2.2
81.8\pm 2.3
\bm{84.6\pm 0.8}
83.2\pm 3.6
78.2\pm 5.0
\bm{84.4\pm 1.0}
83.5\pm 3.9
86.5\pm 4.9
\bm{89.7\pm 4.3}
80.7\pm 1.4
81.3\pm 2.9
\bm{82.9\pm 2.2}
77.6\pm 2.6
77.7\pm 6.3
\bm{81.5\pm 3.9}
p(\mathbf{c};\bm{\pi})=\prod_{i}p(c_{i})=\prod_{i}Cat(c_{i}\mid\bm{\pi})
\bm{\pi}
\bm{\pi}
K
p(\mathbf{c};\bm{\pi})=\prod_{i}Cat(c_{i}\mid\bm{\pi})
\pi_{i}=1/K
\forall\hskip 2.84544pti\in\{1,\ldots,K\}
\bm{\pi}
\bm{\omega}
x
n
N
m
x
n
X
\displaystyle P(X=x)=p_{X}(x)=\frac{\binom{m}{x}\binom{N-m}{n-x}}{\binom{N}{n}}
\displaystyle P(X=x)=p_{X}(x)=\frac{\binom{m}{x}\binom{N-m}{n-x}}{\binom{N}{n}}
N
m
x
n-x
\bm{X}
\displaystyle P(\bm{X}=\bm{x})=p_{\bm{X}}(\bm{x})=\frac{\prod_{i=1}^{c}\binom{%
m_{i}}{x_{i}}}{\binom{N}{n}}
\displaystyle P(\bm{X}=\bm{x})=p_{\bm{X}}(\bm{x})=\frac{\prod_{i=1}^{c}\binom{%
m_{i}}{x_{i}}}{\binom{N}{n}}
c\in\mathbb{N}_{+}
\bm{m}=[m_{1},\ldots,m_{c}]\in\mathbb{N}^{c}
N=\sum_{i=1}^{c}m_{i}
n\in\{0,\ldots,N\}
\mathcal{S}
\displaystyle\mathcal{S}=\left\{\bm{x}\in\mathbb{N}_{0}^{c}:\forall i\quad x_{%
i}\leq m_{i},\sum_{i=1}^{c}x_{i}=n\right\}
\displaystyle\mathcal{S}=\left\{\bm{x}\in\mathbb{N}_{0}^{c}:\forall i\quad x_{%
i}\leq m_{i},\sum_{i=1}^{c}x_{i}=n\right\}
\bm{z}
\bm{\pi}=[\pi_{1},\ldots,\pi_{C}]
\sum_{k=1}^{C}\pi_{k}=1
\bm{z}
\bm{\pi}
\displaystyle\bm{z}=\text{one\_hot}(\operatorname*{arg\,max}_{k}\log(\pi_{k})+%
g_{k})
\displaystyle\bm{z}=\text{one\_hot}(\operatorname*{arg\,max}_{k}\log(\pi_{k})+%
g_{k})
\bm{g}=[g_{1},\ldots,g_{C}]
g
u
U(0,1)
g=-\log(-\log u)
\operatorname*{arg\,max}
\displaystyle p_{k}=\frac{\exp((\log\pi_{k}+g_{k})/\tau)}{\sum_{j=1}^{C}\exp((%
\log\pi_{j}+g_{j})/\tau)}\hskip 7.11317pt\text{for}\hskip 7.11317ptk=1,\ldots,C
\displaystyle p_{k}=\frac{\exp((\log\pi_{k}+g_{k})/\tau)}{\sum_{j=1}^{C}\exp((%
\log\pi_{j}+g_{j})/\tau)}\hskip 7.11317pt\text{for}\hskip 7.11317ptk=1,\ldots,C
\tau
\tau
\displaystyle p_{\bm{X}}(\bm{x};\bm{\omega})=\frac{1}{P_{0}}\prod_{i=1}^{c}%
\binom{m_{i}}{x_{i}}\omega_{i}^{x_{i}}
\displaystyle p_{\bm{X}}(\bm{x};\bm{\omega})=\frac{1}{P_{0}}\prod_{i=1}^{c}%
\binom{m_{i}}{x_{i}}\omega_{i}^{x_{i}}
P_{0}
\displaystyle\log p_{\bm{X}}(\bm{x};\bm{\omega})=\log\left(\frac{1}{P_{0}}%
\prod_{i=1}^{c}\binom{m_{i}}{x_{i}}\omega_{i}^{x_{i}}\right)
\displaystyle\log p_{\bm{X}}(\bm{x};\bm{\omega})=
\displaystyle\log\left(\frac{1}{P_{0}}\prod_{i=1}^{c}\binom{m_{i}}{x_{i}}%
\omega_{i}^{x_{i}}\right)
\displaystyle=\log\left(\frac{1}{P_{0}}\right)+\log\left(\prod_{i=1}^{c}\binom%
{m_{i}}{x_{i}}\omega_{i}^{x_{i}}\right)
\displaystyle=
\displaystyle\log\left(\frac{1}{P_{0}}\right)+\log\left(\prod_{i=1}^{c}\binom{%
m_{i}}{x_{i}}\omega_{i}^{x_{i}}\right)
\displaystyle=\log\left(\frac{1}{P_{0}}\right)+\sum_{i=1}^{c}\log\left(\binom{%
m_{i}}{x_{i}}\omega_{i}^{x_{i}}\right)
\displaystyle=
\displaystyle\log\left(\frac{1}{P_{0}}\right)+\sum_{i=1}^{c}\log\left(\binom{m%
_{i}}{x_{i}}\omega_{i}^{x_{i}}\right)
\displaystyle=\log\left(\frac{1}{P_{0}}\right)+\sum_{i=1}^{c}\left(\log\binom{%
m_{i}}{x_{i}}+\log\left(\omega_{i}^{x_{i}}\right)\right)
\displaystyle=
\displaystyle\log\left(\frac{1}{P_{0}}\right)+\sum_{i=1}^{c}\left(\log\binom{m%
_{i}}{x_{i}}+\log\left(\omega_{i}^{x_{i}}\right)\right)
\displaystyle=\log\left(\frac{1}{P_{0}}\right)+\sum_{i=1}^{c}\left(\log\binom{%
m_{i}}{x_{i}}+x_{i}\log\left(\omega_{i}\right)\right)
\displaystyle=
\displaystyle\log\left(\frac{1}{P_{0}}\right)+\sum_{i=1}^{c}\left(\log\binom{m%
_{i}}{x_{i}}+x_{i}\log\left(\omega_{i}\right)\right)
\log
\displaystyle\log p_{\bm{X}}(\bm{x};\bm{\omega})=\sum_{i=1}^{c}\left(\log%
\binom{m_{i}}{x_{i}}+x_{i}\log\left(\omega_{i}\right)\right)+C
\displaystyle\log p_{\bm{X}}(\bm{x};\bm{\omega})=
\displaystyle\sum_{i=1}^{c}\left(\log\binom{m_{i}}{x_{i}}+x_{i}\log\left(%
\omega_{i}\right)\right)+C
\displaystyle=\sum_{i=1}^{c}\left(\log\frac{1}{x_{i}!(m_{i}-x_{i})!}+x_{i}\log%
\left(\omega_{i}\right)\right)+\tilde{C}
\displaystyle=
\displaystyle\sum_{i=1}^{c}\left(\log\frac{1}{x_{i}!(m_{i}-x_{i})!}+x_{i}\log%
\left(\omega_{i}\right)\right)+\tilde{C}
\displaystyle=\sum_{i=1}^{c}\left(-\log\left(\Gamma(x_{i}+1)\Gamma(m_{i}-x_{i}%
+1)\right)+x_{i}\log\left(\omega_{i}\right)\right)+\tilde{C}
\displaystyle=
\displaystyle\sum_{i=1}^{c}\left(-\log\left(\Gamma(x_{i}+1)\Gamma(m_{i}-x_{i}+%
1)\right)+x_{i}\log\left(\omega_{i}\right)\right)+\tilde{C}
\Gamma(k+1)=k!
C=\tilde{C}
\displaystyle\log p_{\bm{X}}(\bm{x};\bm{\omega})=\sum_{i=1}^{c}x_{i}\log\omega%
_{i}+\psi_{F}(\bm{x})+C
\displaystyle\log p_{\bm{X}}(\bm{x};\bm{\omega})=
\displaystyle\sum_{i=1}^{c}x_{i}\log\omega_{i}+\psi_{F}(\bm{x})+C
\psi_{F}(\bm{x})=-\sum_{i=1}^{c}\log\left(\Gamma(x_{i}+1)\Gamma(m_{i}-x_{i}+1)\right)
\displaystyle\Gamma(z)=\int_{0}^{\infty}x^{z-1}e^{-x}dx
\displaystyle\Gamma(z)=\int_{0}^{\infty}x^{z-1}e^{-x}dx
1
1
2
2
3
3
x
x
x
\displaystyle\log p_{X_{L}}(x_{L};\bm{\omega})=\log\left(\frac{1}{P_{0}}\binom%
{m_{L}}{x}\omega_{L}^{x_{L}}\binom{m_{R}}{n-x_{L}}\omega_{R}^{n-x_{L}}\right)
\displaystyle\log p_{X_{L}}(x_{L};\bm{\omega})=
\displaystyle\log\left(\frac{1}{P_{0}}\binom{m_{L}}{x}\omega_{L}^{x_{L}}\binom%
{m_{R}}{n-x_{L}}\omega_{R}^{n-x_{L}}\right)
\displaystyle=\log\binom{m_{L}}{x_{L}}+\log\binom{m_{R}}{n-x_{L}}+\log\left(%
\omega_{L}^{x_{L}}\right)+\log\left(\omega_{R}^{n-x_{L}}\right)+C
\displaystyle=
\displaystyle\log\binom{m_{L}}{x_{L}}+\log\binom{m_{R}}{n-x_{L}}+\log\left(%
\omega_{L}^{x_{L}}\right)+\log\left(\omega_{R}^{n-x_{L}}\right)+C
\Gamma(k+1)=k!
\displaystyle\log p_{X_{L}}(x_{L};\bm{\omega})=x\cdot\log\omega_{L}+(n-x_{L})%
\cdot\log\omega_{R}
\displaystyle\log p_{X_{L}}(x_{L};\bm{\omega})=
\displaystyle x\cdot\log\omega_{L}+(n-x_{L})\cdot\log\omega_{R}
\displaystyle-\log\left(\Gamma(x_{L}+1)\Gamma(n-x_{L}+1)\right)
\displaystyle-\log\left(\Gamma(x_{L}+1)\Gamma(n-x_{L}+1)\right)
\displaystyle-\log\left(\Gamma(m_{L}-x_{L}+1)\Gamma(m_{R}-n+x_{L}+1)\right)+C
\displaystyle-\log\left(\Gamma(m_{L}-x_{L}+1)\Gamma(m_{R}-n+x_{L}+1)\right)+C
\psi_{F}(x)
i
x_{i}
i
x_{i}\leq m_{i}
p_{X_{i}}(x_{i}|\{x_{k}\}_{k=1}^{i-1};\bm{\omega})
i
k<i
x_{i}
i
x_{i}
p_{X_{i}}(x_{i}|\{x_{k}\}_{k=1}^{i-1};\bm{\omega})
\displaystyle\sum_{0\leq x_{i}\leq m_{i}}p_{X_{i}}\left(x_{i}|\{x_{k}\}_{k=1}^%
{i-1};\bm{\omega}\right)=1,
\displaystyle\sum_{0\leq x_{i}\leq m_{i}}p_{X_{i}}\left(x_{i}|\{x_{k}\}_{k=1}^%
{i-1};\bm{\omega}\right)=1,
\displaystyle m_{1}=10,\hskip 7.11317ptm_{2}=7,\hskip 7.11317ptm_{3}=8,\hskip 7%
.11317ptn=9
\displaystyle m_{1}=10,\hskip 7.11317ptm_{2}=7,\hskip 7.11317ptm_{3}=8,\hskip 7%
.11317ptn=9
x_{j}\in\mathbb{N}_{0}
\sum_{j}x_{j}=n
\bm{\pi}_{1}
\bm{\pi}_{2}
\bm{\pi}_{3}
\sum_{k}\pi_{j,k}=1\hskip 7.11317pt\forall\hskip 7.11317ptj
\bm{\omega}
\bm{\omega}
\displaystyle\bm{\pi}_{i}=f_{\xi,i}(\cdot)
\displaystyle\bm{\pi}_{i}=f_{\xi,i}(\cdot)
\displaystyle\bm{y}_{j}=\text{straight\_through}(GS(\bm{\pi}_{j}))
\displaystyle\bm{y}_{j}=
\displaystyle\text{straight\_through}(GS(\bm{\pi}_{j}))
\displaystyle=\operatorname*{arg\,max}(GS(\bm{\pi}_{j}))
\displaystyle=
\displaystyle\operatorname*{arg\,max}(GS(\bm{\pi}_{j}))
\sum_{j}x_{j}=n
\bm{\pi}_{j},\forall j
x_{j},\forall j
\sum_{j}x_{j}=n
\bm{\pi}_{j}
\displaystyle p(x_{1},x_{2},x_{3})=p(x_{1})p(x_{2}\mid x_{1})p(x_{3}\mid x_{1}%
,x_{2})
\displaystyle p(x_{1},x_{2},x_{3})=p(x_{1})p(x_{2}\mid x_{1})p(x_{3}\mid x_{1}%
,x_{2})
\bm{\pi}_{1}
x_{1}\sim Cat(\bm{\pi}_{1})
x_{1}=7
\bm{\pi}_{2}
\bm{\pi}_{3}
\bm{\pi}_{2}
\sum_{j}x_{j}=n
\displaystyle\pi_{2,k}=0\hskip 7.11317pt\forall\hskip 7.11317ptk>2
\displaystyle\pi_{2,k}=0\hskip 7.11317pt\forall\hskip 7.11317ptk>2
\pi_{2,k},k>2
\sum_{j}x_{j}=n
\pi_{2,k}>0,k\leq 2
\bm{\pi}_{j}
\bm{\omega}
\sum_{j}x_{j}=n
\bm{\omega}
\omega_{j}\geq 0,\forall j
\omega_{j}\geq 0
\bm{\omega}
m_{i},m_{j},\omega_{i},\omega_{j},n,\tau
\bm{\alpha}_{i}
\leftarrow
m_{i},m_{j},\omega_{i},\omega_{j},n
x_{i},\hat{\bm{r}}_{i}
\leftarrow
\bm{\alpha}_{i},\tau)
x_{i},\bm{\alpha}_{i},\hat{\bm{r}}_{i}
m_{l},m_{r},\omega_{l},\omega_{r},n
k\in\{0,\ldots,m_{l}\}
\bm{x}_{l,k}\leftarrow
(k+1)
\bm{x}_{r,k}\leftarrow
(\text{ReLU}(n-k)+1)
\bm{l}\leftarrow\log\Gamma(\bm{x}_{l}+1)+\log\Gamma(m_{l}-\bm{x_{l}}+1)
\bm{r}\leftarrow\log\Gamma(\bm{x}_{r}+1)+\log\Gamma(m_{r}-\bm{x_{r}}+1)
\bm{\alpha}_{l}\leftarrow\bm{x}_{l}\log\omega_{l}+\bm{x}_{r}\log\omega_{r}-(%
\bm{l}+\bm{r})
\bm{\alpha}_{l}
\bm{\alpha}_{l},\tau
\bm{u}\leftarrow\bm{U}(\bm{0},\bm{1})
\bm{g}\leftarrow-\log(-\log\bm{u})
\hat{\bm{r}}_{l}\leftarrow\bm{\alpha}_{l}+\bm{g}
\bm{p}_{l}\leftarrow\text{Softmax}(\hat{\bm{r}}_{l}/\tau)
x_{l}\leftarrow\text{Count-Index}(\text{Straight-Through}(\bm{p}_{l}))
x_{l},\hat{\bm{r}}_{l}
m_{1}=3
N=12
m_{2}=5
m_{3}=4
n=5
\omega_{c}
c
N
m_{c}
n
n=5
\omega_{c}
\omega_{c}
\omega_{c}
c
N
m_{c}
n
n=5
\omega_{c}
\omega_{c}
X_{1}\sim p_{X}{}_{{}_{L}}(n,\ m_{L},\ m_{R},\ \omega_{L},\ \omega_{R})
n=5
m_{L}=m_{1}=3
m_{R}=m_{2}+m_{3}=9
\omega_{L}=\omega_{1}
\omega_{R}=\frac{\omega_{2}m_{2}+\omega_{3}m_{3}}{m_{R}}
N=12
X_{2}\sim p_{X}{}_{{}_{L}}(n,\ m_{L},\ m_{R},\ \omega_{L},\ \omega_{R})
n=4
m_{L}=m_{2}=5
m_{R}=m_{3}=4
\omega_{L}=\omega_{2}
\omega_{R}=\omega_{3}
N=9
n=1
m_{L}=m_{3}=4
m_{R}=0
\omega_{L}=\omega_{3}
\omega_{R}=0
N=4
X_{3}\sim p_{X}{}_{{}_{L}}(n,\ m_{L},\ 0,\ \omega_{L},\ 0)
\bm{m}=[3,5,4]
n=5
1
2
3
m_{L},m_{R},\omega_{L},\omega_{R}
p_{X_{L}}(\cdot)
p_{X_{L}}(\cdot)
X_{1}
1
2
m_{L}=m_{2}
m_{R}=m_{3}
n
n
X_{1}
X_{2}=3
n
X_{3}
\bm{m}=[3,5,4]
n=5
1
2
3
m_{L},m_{R},\omega_{L},\omega_{R}
p_{X_{L}}(\cdot)
p_{X_{L}}(\cdot)
X_{1}
1
2
m_{L}=m_{2}
m_{R}=m_{3}
n
n
X_{1}
X_{2}=3
n
X_{3}
\bm{\omega}
\bm{\omega}
\log p_{X}(\bm{x};\bm{\omega})
\bm{X}_{D}\in\mathbb{N}_{+}^{K\times n_{c}}
\bm{\omega}_{gt}\in\mathbb{R}_{+}^{c}
K
n_{c}
\bm{X}_{D}
X_{D}
X_{D}\in\bm{X}_{D}
\sum_{c}X_{D,c}=n
\bm{m}=[m_{1},m_{2},...,m_{c}]
\bm{\omega}
p_{X}(\bm{x};\bm{\omega})
X\sim p_{X}(\bm{x};\bm{\omega})
\mathbb{L}
\displaystyle\mathbb{L}=\sum_{X_{D}\in\bm{X}_{D}}\mathbb{E}_{X\sim p_{X}(\bm{x%
};\bm{\omega})}\left[\left(X_{D}-X\right)^{2}\right]
\displaystyle\mathbb{L}=
\displaystyle\sum_{X_{D}\in\bm{X}_{D}}\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{%
\omega})}\left[\left(X_{D}-X\right)^{2}\right]
\displaystyle=\sum_{X_{D}\in\bm{X}_{D}}\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{%
\omega})}\left[\mathbb{L}(X_{D},X)\right]
\displaystyle=
\displaystyle\sum_{X_{D}\in\bm{X}_{D}}\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{%
\omega})}\left[\mathbb{L}(X_{D},X)\right]
\mathbb{L}
p_{X}(\bm{x};\bm{\omega})
\bm{\omega}
\mathbb{E}[\mathbb{L}(X)]
\bm{\omega}
\bm{\omega}
\displaystyle\bm{\omega}_{t+1}:=\bm{\omega}_{t}-\eta\frac{d}{d\bm{\omega}}%
\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\mathbb{L}(X_{D},X)\right]
\displaystyle\bm{\omega}_{t+1}:=\bm{\omega}_{t}-\eta\frac{d}{d\bm{\omega}}%
\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\mathbb{L}(X_{D},X)\right]
\eta
t
\frac{d}{d\bm{\omega}}\mathbb{E}[\mathbb{L}(X_{D},X)]
\operatorname*{arg\,max}
p_{X}(\bm{x};\bm{\omega})
\frac{d}{d\bm{\omega}}\mathbb{E}[\mathbb{L}(X_{D},X)]
p_{X}(\bm{x};\bm{\omega})
\displaystyle p_{X}(\bm{x};\bm{\omega})=p_{X_{1}}(x_{1};\bm{\omega})\prod_{c=2%
}^{n_{c}}p_{X_{c}}(x_{c}\mid x_{1},...,x_{c-1};\bm{\omega})
\displaystyle p_{X}(\bm{x};\bm{\omega})=
\displaystyle p_{X_{1}}(x_{1};\bm{\omega})\prod_{c=2}^{n_{c}}p_{X_{c}}(x_{c}%
\mid x_{1},...,x_{c-1};\bm{\omega})
p_{X_{c}}(\cdot;\bm{\omega})
X_{c}
\displaystyle p_{X_{c}}(x_{L_{c}};\bm{\omega})=x_{L_{c}}\log\omega_{{L_{c}}}+(%
n_{c}-x_{L})\log\omega_{R_{c}}+\psi_{F}(x_{L_{c}})+C
\displaystyle p_{X_{c}}(x_{L_{c}};\bm{\omega})=
\displaystyle x_{L_{c}}\log\omega_{{L_{c}}}+(n_{c}-x_{L})\log\omega_{R_{c}}+%
\psi_{F}(x_{L_{c}})+C
\omega_{L_{c}},\omega_{R_{c}}
m_{L_{c}},m_{R_{c}}
n_{c}=\sum_{j<c}X_{j}
\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\mathbb{L}(X_{D},X)\right]
\displaystyle\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\mathbb{L}(X_{D%
},X)\right]=\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\sum_{c=1}^{n_{c%
}}(X_{D,c}-X_{c})^{2}\right]
\displaystyle\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\mathbb{L}(X_{D%
},X)\right]=
\displaystyle\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\sum_{c=1}^{n_{%
c}}(X_{D,c}-X_{c})^{2}\right]
\displaystyle=\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\sum_{c=1}^{n_%
{c}}\mathbb{L}(X_{D,c},X_{c})\right]
\displaystyle=
\displaystyle\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left[\sum_{c=1}^{n_{%
c}}\mathbb{L}(X_{D,c},X_{c})\right]
\displaystyle=\sum_{c=1}^{n_{c}}\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}%
\left[\mathbb{L}(X_{D,c},X_{c})\right]
\displaystyle=
\displaystyle\sum_{c=1}^{n_{c}}\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}%
\left[\mathbb{L}(X_{D,c},X_{c})\right]
\displaystyle\frac{d}{d\bm{\omega}}\mathbb{E}[\mathbb{L}(X_{D},X)]=\sum_{c=1}^%
{n_{c}}\frac{d}{d\bm{\omega}}\mathbb{E}_{X\sim p_{X}(\bm{x};\bm{\omega})}\left%
[\mathbb{L}(X_{D,c},X_{c})\right]
\displaystyle\frac{d}{d\bm{\omega}}\mathbb{E}[\mathbb{L}(X_{D},X)]=
\displaystyle\sum_{c=1}^{n_{c}}\frac{d}{d\bm{\omega}}\mathbb{E}_{X\sim p_{X}(%
\bm{x};\bm{\omega})}\left[\mathbb{L}(X_{D,c},X_{c})\right]
\frac{d}{d\bm{\omega}}\mathbb{E}\left[\mathbb{L}(X_{D,c},X_{c})\right]
p_{X_{c}}(\cdot)
\bm{\pi}
\displaystyle\bm{y}=\mathrm{softmax}((\log\bm{\pi}+\bm{g})/\tau)
\displaystyle\bm{y}=
\displaystyle\mathrm{softmax}((\log\bm{\pi}+\bm{g})/\tau)
\displaystyle=\mathrm{softmax}_{\tau}(\log\bm{\pi}+\bm{g})
\displaystyle=
\displaystyle\mathrm{softmax}_{\tau}(\log\bm{\pi}+\bm{g})
g_{1},\ldots,g_{k}
(0,1)
\tau
\bm{y}
0\leq y_{i}\leq 1
\sum_{i}y_{i}=1
\bm{\pi}
\log p_{X}(\cdot)
x_{L_{c}}
\displaystyle X_{\tau,c}(\bm{\omega},\bm{g})=\mathrm{softmax}_{\tau}(\log p_{X%
_{c}}(\bm{x}_{L_{c}};\bm{\omega})+\bm{g})
\displaystyle X_{\tau,c}(\bm{\omega},\bm{g})=\mathrm{softmax}_{\tau}(\log p_{X%
_{c}}(\bm{x}_{L_{c}};\bm{\omega})+\bm{g})
\bm{x}_{L_{c}}=[0,m_{L_{c}}]
\mathrm{softmax}
C
\log p_{X_{c}}(\bm{x}_{L_{c}};\bm{\omega})
\tau>0
\mathbb{E}[\mathbb{L}(X_{D},X_{\tau})]
\frac{d}{d\bm{\omega}}
\displaystyle\mathbb{E}_{\bm{g}}\left[\mathbb{L}(X_{D},X_{\tau}(\bm{\omega},%
\bm{g}))\right]=\sum_{c=1}^{n_{c}}\mathbb{E}_{\bm{g}}\left[\mathbb{L}(X_{D,c},%
X_{\tau,c}(\bm{\omega},\bm{g}))\right]
\displaystyle\mathbb{E}_{\bm{g}}\left[\mathbb{L}(X_{D},X_{\tau}(\bm{\omega},%
\bm{g}))\right]=
\displaystyle\sum_{c=1}^{n_{c}}\mathbb{E}_{\bm{g}}\left[\mathbb{L}(X_{D,c},X_{%
\tau,c}(\bm{\omega},\bm{g}))\right]
\displaystyle\frac{d}{d\bm{\omega}}\mathbb{E}_{\bm{g}}\left[\mathbb{L}(X_{D},X%
_{\tau}(\bm{\omega},\bm{g}))\right]=\sum_{c=1}^{n_{c}}\mathbb{E}_{\bm{g}}\left%
[\frac{d}{d\bm{\omega}}\mathbb{L}(X_{D,c},X_{\tau,c}(\bm{\omega},\bm{g}))\right]
\displaystyle\frac{d}{d\bm{\omega}}\mathbb{E}_{\bm{g}}\left[\mathbb{L}(X_{D},X%
_{\tau}(\bm{\omega},\bm{g}))\right]=
\displaystyle\sum_{c=1}^{n_{c}}\mathbb{E}_{\bm{g}}\left[\frac{d}{d\bm{\omega}}%
\mathbb{L}(X_{D,c},X_{\tau,c}(\bm{\omega},\bm{g}))\right]
\bm{\omega}
n_{c}=3
\bm{m}=[m_{1},m_{2},m_{3}]=[200,200,200]
n=180
10
\bm{X}_{D}\in\mathbb{N}^{1000\times 3}
\bm{\omega}_{gt}
1000
800
200
10
\omega_{gt,2}
\omega_{gt,2}=[1.0,2.0,\ldots,10.0]
\omega_{gt,1}
\omega_{gt,3}
1.0
\bm{\omega}_{gt}
\bm{X}_{D}
\bm{\omega}
\mathbb{L}
10
\omega_{2}
\log\bm{\omega}
x
y
\bm{\omega}
\omega_{gt,2}
\omega_{1}
\omega_{3}
\omega_{gt,1}
\omega_{gt,3}
\bm{\omega}_{gt}
\bm{\omega}_{gt}
\log\omega_{1}
\log\omega_{1}
\log\omega_{2}
\log\omega_{2}
\log\omega_{3}
\log\omega_{3}
\log\bm{\omega}
\bm{\omega}_{gt}
\bm{\omega}
\omega_{2}
\omega_{1}
\omega_{3}
\log\bm{\omega}
\bm{\omega}_{gt}
\bm{\omega}
\omega_{2}
\omega_{1}
\omega_{3}
1
3
\omega_{2}
n
m_{2}
1
1
2
2
3
3
p
p
n
\bm{m}=\{200,200,200\}
\bm{\omega}=\{1.0,5.0,1.0\}
n
n
\bm{m}=\{200,200,200\}
\bm{\omega}=\{1.0,5.0,1.0\}
n
1
1
2
2
3
3
p
p
m_{2}
n=200
\bm{\omega}=\{1.0,5.0,1.0\}
m_{1}=200
m_{3}=200
m_{2}
m_{2}
n=200
\bm{\omega}=\{1.0,5.0,1.0\}
m_{1}=200
m_{3}=200
m_{2}
k
k
\beta=1.0
\beta
z_{i}\in S
\bm{x}_{1}
\bm{x}_{2}
S
\displaystyle q_{\phi}(z_{i}\mid\bm{x}_{j})=avg(q_{\phi}(z_{i}\mid\bm{x}_{1}),%
q_{\phi}(z_{i}\mid\bm{x}_{2}))
\displaystyle q_{\phi}(z_{i}\mid\bm{x}_{j})=
\displaystyle avg(q_{\phi}(z_{i}\mid\bm{x}_{1}),q_{\phi}(z_{i}\mid\bm{x}_{2}))
\displaystyle\hskip 14.22636pt\forall\hskip 7.11317pti\in S
\displaystyle\hskip 14.22636pt\forall\hskip 7.11317pti\in S
\displaystyle q_{\phi}(z_{i}\mid\bm{x}_{j})=q_{\phi}(z_{i}\mid\bm{x}_{j})
\displaystyle q_{\phi}(z_{i}\mid\bm{x}_{j})=
\displaystyle q_{\phi}(z_{i}\mid\bm{x}_{j})
avg
j\in\{1,2\}
E
D
\bm{x}_{1}
\bm{x}_{2}
\hat{\bm{x}}_{1}
\hat{\bm{x}}_{2}
q_{\phi}(\bm{z}\mid\bm{x}_{1})
q_{\phi}(\bm{z}\mid\bm{x}_{2})
\bm{\omega}
d
d
\bm{\omega}
d
\bm{\omega}
\log\bm{\omega}
\log\bm{\omega}
\bm{\gamma}
P
Q
\frac{1}{2}(KL(P||Q)+KL(Q||P))
\hat{k}
\hat{s}
\hat{k}
d
\bm{\gamma}
\hat{k}
\hat{s}=d-\hat{k}
\tau
\tau
\displaystyle\tau_{t}=\tau_{init}\exp(-rt)
\displaystyle\tau_{t}=\tau_{init}\exp(-rt)
t
\tau_{init}
r
\displaystyle r=\frac{\log\tau_{init}-\log\tau_{final}}{n_{steps}}
\displaystyle r=\frac{\log\tau_{init}-\log\tau_{final}}{n_{steps}}
\tau_{final}
n_{steps}
\tau
\tau_{init}
10
\tau_{final}
0.01
n_{steps}=50000
10^{-6}
\beta
\beta
1
\tau_{final}
\tau_{final}
\tau_{final}
\tau_{final}
\tau_{final}
\tau_{final}
7
10000
5000
10000
5000
max\_iter
\mathcal{O}(c)
\mathcal{O}(m_{i})
k=\{-1,2,4,6\}
k=\{-1,2,4,6\}
k=-1
k=2
k=4
k=6
21907.4\pm 273.0
20921.1\pm 705.9
21389.3\pm 163.8
21761.1\pm 567.9
29071.5\pm 133.2
28609.8\pm 439.9
29479.1\pm 487.1
29966.3\pm 303.3
21888.9\pm 632.9
21299.4\pm 293.6
21863.9\pm 190.1
22241.0\pm 137.8
X=\{\mathbf{x}_{i}\}_{i=1}^{N}
K
\displaystyle\mathbf{c}\sim p(\mathbf{c};\bm{\pi}),\hskip 14.22636pt\mathbf{z}%
_{i}\sim p(\mathbf{z}_{i}|c_{i})=\mathcal{N}(\mathbf{z}_{i}|\bm{\mu}_{c_{i}},%
\bm{\sigma}^{2}_{c_{i}}\mathbb{I}),\hskip 14.22636pt\mathbf{x}_{i}\sim p_{%
\theta}(\mathbf{x}_{i}|\mathbf{z}_{i})=Ber(\bm{\mu}_{x_{i}})
\displaystyle\mathbf{c}\sim p(\mathbf{c};\bm{\pi}),\hskip 14.22636pt\mathbf{z}%
_{i}\sim p(\mathbf{z}_{i}|c_{i})=\mathcal{N}(\mathbf{z}_{i}|\bm{\mu}_{c_{i}},%
\bm{\sigma}^{2}_{c_{i}}\mathbb{I}),\hskip 14.22636pt\mathbf{x}_{i}\sim p_{%
\theta}(\mathbf{x}_{i}|\mathbf{z}_{i})=Ber(\bm{\mu}_{x_{i}})
\mathbf{c}=\{c_{i}\}_{i=1}^{N}
\mathbf{z}_{i}\in\mathbb{R}^{D}
\mathbf{x}_{i}
\displaystyle p(X)=\sum_{\mathbf{c}}\int_{\mathbf{z}}p(X,Z,\mathbf{c})=\sum_{%
\mathbf{c}}\int_{\mathbf{z}}p(\mathbf{c};\bm{\pi})p(X|Z)p(Z|\mathbf{c})=\sum_{%
\mathbf{c}}p(\mathbf{c};\bm{\pi})\prod_{i}\int_{\mathbf{z}_{i}}p(\mathbf{x}_{i%
}|\mathbf{z}_{i})p(\mathbf{z}_{i}|c_{i})
\displaystyle p(X)=\sum_{\mathbf{c}}\int_{\mathbf{z}}p(X,Z,\mathbf{c})=\sum_{%
\mathbf{c}}\int_{\mathbf{z}}p(\mathbf{c};\bm{\pi})p(X|Z)p(Z|\mathbf{c})=\sum_{%
\mathbf{c}}p(\mathbf{c};\bm{\pi})\prod_{i}\int_{\mathbf{z}_{i}}p(\mathbf{x}_{i%
}|\mathbf{z}_{i})p(\mathbf{z}_{i}|c_{i})
p(\mathbf{c};\bm{\pi})
p(c_{i};\bm{\pi})
i=1,\dots,K
q_{\phi}(Z,\mathbf{c}|X)
\displaystyle\log p(X)\geq E_{q_{\phi}(Z,c,|X)}\left[\log\left(\frac{p(\mathbf%
{c};\bm{\pi})p(X|Z)p(Z|\mathbf{c})}{q_{\phi}(Z,\mathbf{c},|X)}\right)\right]=%
\mathcal{L}_{ELBO}.
\displaystyle\log p(X)\geq E_{q_{\phi}(Z,c,|X)}\left[\log\left(\frac{p(\mathbf%
{c};\bm{\pi})p(X|Z)p(Z|\mathbf{c})}{q_{\phi}(Z,\mathbf{c},|X)}\right)\right]=%
\mathcal{L}_{ELBO}.
\displaystyle q_{\phi}(Z,\mathbf{c}|X)=q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)=%
\prod_{i}q_{\phi}(\mathbf{z}_{i}|\mathbf{x}_{i})q_{\phi}(c_{i}|\mathbf{x}_{i}).
\displaystyle q_{\phi}(Z,\mathbf{c}|X)=q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)=%
\prod_{i}q_{\phi}(\mathbf{z}_{i}|\mathbf{x}_{i})q_{\phi}(c_{i}|\mathbf{x}_{i}).
\displaystyle\mathcal{L}_{ELBO}=E_{q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)}\left[%
\log p(\mathbf{c}|\bm{\pi})+\log p(X|Z)+\log p(Z|\mathbf{c})-\log q_{\phi}(Z,%
\mathbf{c}|X)\right]
\displaystyle\mathcal{L}_{ELBO}=
\displaystyle E_{q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)}\left[\log p(\mathbf{c}|%
\bm{\pi})+\log p(X|Z)+\log p(Z|\mathbf{c})-\log q_{\phi}(Z,\mathbf{c}|X)\right]
\displaystyle=E_{q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)}\left[\log p(\mathbf{c}|%
\bm{\pi})\right]+E_{q_{\phi}(Z|X)}\left[\log p(X|Z)\right]+E_{q_{\phi}(Z|X)q_{%
\phi}(\mathbf{c}|X)}\left[\log p(Z|\mathbf{c})\right]
\displaystyle=
\displaystyle E_{q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)}\left[\log p(\mathbf{c}|%
\bm{\pi})\right]+E_{q_{\phi}(Z|X)}\left[\log p(X|Z)\right]+E_{q_{\phi}(Z|X)q_{%
\phi}(\mathbf{c}|X)}\left[\log p(Z|\mathbf{c})\right]
\displaystyle-E_{q_{\phi}(Z|X)}\left[\log q_{\phi}(Z|X)\right]-E_{q_{\phi}(Z|X%
)q(\mathbf{c}|X)}\left[\log q_{\phi}(\mathbf{c}|X)\right].
\displaystyle-E_{q_{\phi}(Z|X)}\left[\log q_{\phi}(Z|X)\right]-E_{q_{\phi}(Z|X%
)q(\mathbf{c}|X)}\left[\log q_{\phi}(\mathbf{c}|X)\right].
\displaystyle E_{q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)}\left[\log p(\mathbf{c}|%
\bm{\pi})\right]=\sum_{\bm{c}}\int_{Z}q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)\log p%
(\mathbf{c}|\bm{\pi}))
\displaystyle E_{q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)}\left[\log p(\mathbf{c}|%
\bm{\pi})\right]=
\displaystyle\sum_{\bm{c}}\int_{Z}q_{\phi}(Z|X)q_{\phi}(\mathbf{c}|X)\log p(%
\mathbf{c}|\bm{\pi}))
\displaystyle=\sum_{\bm{c}}\prod_{i}\int_{\mathbf{z}_{i}}q_{\phi}(\mathbf{z}_{%
i}|\mathbf{x}_{i})q_{\phi}(c_{i}|\mathbf{x}_{i})\log p(\mathbf{c}|\bm{\pi})
\displaystyle=
\displaystyle\sum_{\bm{c}}\prod_{i}\int_{\mathbf{z}_{i}}q_{\phi}(\mathbf{z}_{i%
}|\mathbf{x}_{i})q_{\phi}(c_{i}|\mathbf{x}_{i})\log p(\mathbf{c}|\bm{\pi})
\displaystyle=\sum_{l=1}^{L}\log p(\mathbf{c}^{l}|\bm{\pi}),
\displaystyle=
\displaystyle\sum_{l=1}^{L}\log p(\mathbf{c}^{l}|\bm{\pi}),
q_{\phi}(\mathbf{z}_{i}|\mathbf{x}_{i})
q_{\phi}(c_{i}|\mathbf{x}_{i})
\displaystyle p(c_{i}|\mathbf{z}_{i};\bm{\pi})=\frac{\mathcal{N}(\mathbf{z}_{i%
}|\bm{\mu}_{c_{i}},\bm{\sigma}^{2}_{c_{i}})\pi_{c_{i}}}{\sum_{k}\mathcal{N}(%
\mathbf{z}_{i}|\bm{\mu}_{k}.\bm{\sigma}^{2}_{k})\pi_{k}},
\displaystyle p(c_{i}|\mathbf{z}_{i};\bm{\pi})
\displaystyle=\frac{\mathcal{N}(\mathbf{z}_{i}|\bm{\mu}_{c_{i}},\bm{\sigma}^{2%
}_{c_{i}})\pi_{c_{i}}}{\sum_{k}\mathcal{N}(\mathbf{z}_{i}|\bm{\mu}_{k}.\bm{%
\sigma}^{2}_{k})\pi_{k}},
L
1
500
500
2000
D
D=10
0.001
128
1000
p(\bm{c};\bm{\pi})
E
\bm{x}
q_{\phi}(\bm{z}\mid\bm{x})
q_{\phi}(\bm{c}\mid\bm{x})
\bm{z}
D
\hat{\bm{x}}
p(\bm{c};\bm{\pi})
p(\bm{c};\bm{\pi})
