\langle S,A,R,T,\gamma\rangle
S
A
R:S\times A\mapsto[0,1]
0
1
T:S\times A\mapsto\Pr(S)
T(s^{\prime}|s,a)
s^{\prime}\in S
a\in A
s
\gamma\in[0,1)
m_{1},...,m_{n}
\langle S^{(i)},A^{(i)},R^{(i)},T^{(i)},\gamma^{(i)}\rangle
t
k\succ t
t
k\prec t
\omega
P_{\Omega}
\omega
\omega
T(s^{\prime}|s,a;\omega_{i})
R(r|s,a;\omega_{i})
i
\omega_{i}\in\Omega
\omega
P(\omega)
m_{1},\cdots,m_{n}
\omega_{1},\cdots,\omega_{n}\sim P_{\Omega}
P_{\Omega}
P(\omega_{i})
m_{i}
i
\omega_{i}
\omega_{i}
i
p(s^{t+1},r^{t}|s^{t},a^{t};\omega_{i})
i
P(\omega_{i}|D_{i}^{t},a^{t},s^{t+1},r^{t})=\frac{{\color[rgb]{0,0,1}P(\omega_%
{i}|D_{i}^{t})}P(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}{P(s^{t+1},r^{t}|D_%
{i}^{t},a^{t})},
D_{i}^{t}=\{s^{1},a^{1},\cdots,s^{t}\}
i
t
i
{\color[rgb]{0,0,1}P(\omega|D_{1:i})}=\frac{P(\omega|D_{1:i-1})P(D_{i}|D_{1:i-%
1};\omega)}{P(D_{i}|D_{1:i-1})},
D_{1:i}
1\sim i
i
i
D^{t}_{i}=\varnothing
{\color[rgb]{0,0,1}P(\omega_{i}|D_{i}^{t})}={\color[rgb]{0,0,1}P(\omega|D_{1:i%
})}
P_{\Omega}
\omega_{i}
i
K
P(\omega|D_{1:i-1})
i-1
P(\omega_{i})
i
\pi(\omega_{i})
\Gamma
p(\cdot|\omega_{i})=p(s^{t+1},r^{t}|s^{t},a^{t},\omega_{i})
\omega_{i}
q
\{p(\cdot|\omega_{i}):\omega_{i}\in\Gamma\}
\Gamma
g(\omega_{i})
\pi
\displaystyle R_{n}(g)=\mathbb{E}_{\pi}g(\omega_{i})\sum_{t=1}^{T}\ln\frac{q(s%
^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}+D_%
{KL}(gd\pi||d\pi).
\displaystyle R_{n}(g)=\mathbb{E}_{\pi}g(\omega_{i})\sum_{t=1}^{T}\ln\frac{q(s%
^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}+D_%
{KL}(gd\pi||d\pi).
\inf R_{n}(g)
g(\omega_{i})
d_{\pi}=\inf\{d:d\geq-\ln\pi(\{p\in\Gamma:D_{KL}(q||p)\leq d\})\}.
\forall\rho\in(0,1)
\eta\geq 1
\varepsilon_{n}=(1+\frac{1}{n})\eta d_{\pi}+(\eta-\rho)\varepsilon_{upper,n}((%
\eta-1)/(\eta-\rho)),
\varepsilon_{upper,n}
\varepsilon_{upper,n}
\rho=\frac{1}{2}
h\geq 0
\delta\in(0,1)
1-\delta
\displaystyle\pi_{n}\Big{(}\Big{\{}p\in\Gamma:||p-q||^{2}_{1}/2\geq\frac{2%
\varepsilon_{n}+(4\eta-2)h}{\delta/4}\Big{\}}\Big{|}X\Big{)}\leq\frac{1}{1+e^{%
nh}},
\displaystyle\pi_{n}\Big{(}\Big{\{}p\in\Gamma:||p-q||^{2}_{1}/2\geq\frac{2%
\varepsilon_{n}+(4\eta-2)h}{\delta/4}\Big{\}}\Big{|}X\Big{)}\leq\frac{1}{1+e^{%
nh}},
\pi_{n}(\omega_{i})
\omega
n
X
n
D_{i}^{t}
m^{*}\sim M
\omega_{m^{*}}
f(s,a,\epsilon_{0},\delta_{0},\rho_{0})
u
u
(s,a)
1-\delta_{0}
\displaystyle Pr_{m\sim posterior}(||T(\cdot|s,a,\omega_{m})-T(\cdot|s,a,%
\omega_{m^{*}})||_{1}<\epsilon_{0})\geq 1-\rho_{0}.
\displaystyle Pr_{m\sim posterior}(||T(\cdot|s,a,\omega_{m})-T(\cdot|s,a,%
\omega_{m^{*}})||_{1}<\epsilon_{0})\geq 1-\rho_{0}.
\epsilon_{0}
1-\rho_{0}
\varepsilon_{upper,n}=o(1)
\eta=2
f(s,a,\epsilon,\delta,\rho)=O\left(\frac{d_{\pi}+\ln\frac{1}{\rho}}{\epsilon^{%
2}\delta-d_{\pi}}\right)
K=\Theta(\frac{S^{2}A}{\delta}\ln\frac{SA}{\delta})
\epsilon_{0}=\epsilon(1-\gamma)^{2},\delta_{0}=\frac{\delta}{SA},\rho_{0}=%
\frac{\delta}{S^{2}A^{2}K}
1-4\delta
V^{t}(s^{t})\geq V^{*}(s^{t})-4\epsilon_{0}
\tilde{O}(\frac{S^{2}A^{2}d_{\pi}}{\delta\epsilon^{3}(1-\gamma)^{6}})
\tilde{O}(\cdot)
d_{\pi}
q
d_{\pi}
d_{\pi}
q(\omega;\phi)
\omega
\phi
q(\omega;\phi)=\prod_{j=1}^{|\Omega|}\mathcal{N}(\omega_{j}|\mu_{j},\sigma^{2}%
_{j}),
\phi=\{\mu,\sigma\}
\mu
\sigma
\displaystyle\phi_{t}=\operatorname*{arg\,min}_{\phi}\Big{[}D_{KL}[q(\omega;%
\phi)||p(\omega)]-\mathbb{E}_{\omega\sim q(\cdot;\phi)}[\log p(s^{t+1},r^{t}|D%
^{t},a^{t};\omega)]\Big{]},
\displaystyle\phi_{t}=\operatorname*{arg\,min}_{\phi}\Big{[}D_{KL}[q(\omega;%
\phi)||p(\omega)]-\mathbb{E}_{\omega\sim q(\cdot;\phi)}[\log p(s^{t+1},r^{t}|D%
^{t},a^{t};\omega)]\Big{]},
p(\omega)
\omega
D^{t}=\{s^{1},a^{1},r^{1},\cdots,s^{t}\}
p(\omega)
p(\omega)
\frac{1}{N}\sum_{i=1}^{N}\log p(s^{t+1},r^{t}|D^{t},a^{t};\omega_{i})
N
\omega_{i}\sim q(\phi)
s
\phi_{t-1}
\{\mu,\sigma\}
P
s^{p}_{\tau=t}=s_{t}\forall p
N
a_{t:t+T}
p_{m_{i}}(\cdot|s,a)
P_{\Omega}
m_{i}
\omega_{i}
P_{\Omega}
P(\omega_{i})
\omega_{i}
\geq 30
\{\sigma_{r^{p}_{\tau}},\sigma_{s^{p}_{\tau}}\}
(s,a)
c
r^{p}_{\tau}(s,a)
\displaystyle c=-\frac{\sum_{p=1}^{P}(\mu_{r^{p}_{\tau}}-\overline{\mu}_{r^{p}%
_{\tau}})^{2}}{P-1}-\alpha*\frac{\sum_{p=1}^{P}(\sigma_{r^{p}_{\tau}}-%
\overline{\sigma}_{r^{p}_{\tau}})^{2}}{P-1},
\displaystyle c=-\frac{\sum_{p=1}^{P}(\mu_{r^{p}_{\tau}}-\overline{\mu}_{r^{p}%
_{\tau}})^{2}}{P-1}-\alpha*\frac{\sum_{p=1}^{P}(\sigma_{r^{p}_{\tau}}-%
\overline{\sigma}_{r^{p}_{\tau}})^{2}}{P-1},
P
\alpha
c
P
P
\{\mu_{r^{p}_{\tau}},\sigma_{r^{p}_{\tau}}\}
P
c_{m_{i}}<c_{wm}
2\times
2\times
\mathbf{160.68\pm 48.80}
126.95\pm 31.41
\ -81.59\pm\ 9.18
-3426.76\pm 827.99
-83.96\pm 60.10
\mathbf{226.72\pm 26.53}
170.20\pm 39.92
\ -29.49\pm 11.03
-3440.66\pm 1007.50
-40.47\pm 10.68
\mathbf{231.79\pm 23.49}
\ 97.84\pm 22.04
\ -29.95\pm 11.64
-6672.33\pm 3748.63
\mathbf{110.74\pm 41.96}
\ 78.95\pm 18.43
-263.94\pm 40.80
-5016.93\pm 1708.10
-101.02\pm 39.11
\mathbf{173.97\pm 78.26}
\ 87.20\pm\ 9.42
-217.86\pm 42.82
-5454.52\pm 2145.82
-58.93\pm 33.24
\mathbf{181.60\pm 67.50}
116.03\pm 17.35
-116.41\pm 65.64
-13889.31\pm 6851.05
268.11\pm 33.29
230.21\pm 30.75
\ 305.63\pm 34.55
\mathbf{306.79\pm 29.14}
18.62\pm 1.51
332.89\pm 23.68
285.87\pm 41.48
\mathbf{352.10\pm 25.25}
345.47\pm 40.26
20.46\pm 1.77
\mathbf{360.94\pm\ 7.71}
312.11\pm 55.45
\ 347.07\pm 44.09
301.06\pm 114.11
193.27\pm\ 8.03
181.94\pm 12.97
\mathbf{256.13\pm 69.68}
133.95\pm 27.61
19.12\pm 1.75
\mathbf{296.34\pm 11.15}
227.50\pm 41.78
\ 285.62\pm 78.18
139.01\pm 46.24
21.25\pm 2.67
\mathbf{316.74\pm 20.72}
213.93\pm 75.95
\ 281.99\pm 74.96
-384.27\pm 199.27
\mathbf{248.97\pm 19.95}
217.94\pm 39.99
\ 140.75\pm 67.64
163.61\pm 86.55
4.32\pm 0.23
\mathbf{333.65\pm 26.73}
268.97\pm 36.26
\ 166.00\pm 45.04
181.76\pm 97.42
210.41\pm 39.34
\mathbf{364.18\pm 49.60}
173.33\pm 58.43
\ 168.39\pm 94.19
216.09\pm 62.67
\mathbf{222.88\pm 34.49}
220.07\pm 20.31
\ 164.79\pm 10.31
164.00\pm 34.31
4.64\pm 0.23
\mathbf{311.41\pm 16.30}
266.97\pm 26.72
\ 165.75\pm\ 2.39
206.97\pm 41.40
196.42\pm 22.04
\mathbf{317.82\pm 13.90}
229.10\pm 16.60
\ 195.01\pm 49.25
152.94\pm 70.59
{\bf 2\times}
p_{wm}(\cdot|s,a;\omega_{wm})
T
m_{i}
i=1,2,3,\cdots,M
p_{m_{i}}(\cdot|s,a;\omega_{i})
p_{wm}
t=0
a_{t:t+T}\sim
\cdot
s^{p}_{\tau}
p_{m_{i}}(s^{\prime}|s,a;\omega_{i})
\sum_{\tau=t}^{t+T}\frac{1}{P}\sum_{p=1}^{P}p_{m_{i}}(r|s,a;\omega_{i})
\cdot
a^{*}_{t:t+T}
D_{m_{i}}
D_{m_{i}}
\{D_{m_{1}},\cdots,D_{m_{i}}\}
p_{m_{i}}(\cdot|s,a;\omega_{i})
p_{m_{wm}}(\cdot|s,a;\omega_{wm})
p
s^{p}_{\tau}
\sum_{\tau=t}^{t+T}\frac{1}{P}\sum_{p=1}^{P}r^{p}_{\tau}
p
p\in\{1,\cdots,P\}
p_{wm}(\cdot|s,a;\omega_{wm})
p_{m_{i}}(\cdot|s,a;\omega_{i})
P
s^{p}_{\tau=t}=s_{t}\forall p
N
a_{t:t+T}
p_{m_{i}}(\cdot|s,a)
m_{i}
T
p_{m_{i}}(s^{\prime},r|s,a;\omega_{i})
p_{wm}(s^{\prime},r|s,a;\omega_{wm})
t=0
k=1
K
a_{t:t+T}\sim
\cdot
s^{p}_{\tau}
p_{m_{i}}(s^{\prime},r|s,a)
s^{p}_{\tau}
p_{wm}(s^{\prime},r|s,a)
c_{m_{i}}
c_{wm}
c
\sum_{\tau=t}^{t+T}\frac{1}{P}\sum_{p=1}^{P}r^{p}_{\tau}
\cdot
a^{*}_{t:t+T}
m_{i}
T(\cdot|s,a)=\mathcal{N}(f^{\mu}_{\omega}(s,a),f^{\sigma}_{\omega}(s,a))
f_{\theta}
\theta
\phi
\mu_{s},\mu_{r}
\sigma_{s},\sigma_{r}
s,a
T(s^{\prime},r|s,a)=\int_{\Omega}T(s^{\prime},r|s,a;\omega)q(\omega;\phi)d\omega
plate~{}notation
\Psi
P_{\Omega}
m_{i}
\omega_{i}
\Psi
\Psi
\tau_{j}
\{s,a,r,s^{\prime}\}_{j}
K
R
\tau_{j}
\{s,a,r,s^{\prime}\}_{j}
K
R
m_{i}
p_{m_{i}}(\cdot|s_{t},a_{t})
p_{wm}
p_{m_{i}}
K
B
N_{s_{t},a_{t}}=B
m^{\#}_{i}
m^{\#}_{i}
\pi_{m^{\#}_{i}}^{*}
K
\pi_{m^{\#}_{i}}^{*}
K
B
p_{wm}(s_{t+1},r_{t}|s_{t},a_{t})
m_{i}
N_{s,a}\leftarrow 0,\forall s,a
do\_sample\leftarrow
p_{m_{i}}(s_{t+1},r_{t}|s_{t},a_{t})\leftarrow p_{wm}(s_{t+1},r_{t}|s_{t},a_{t})
t=1,2,3,...
do\_sample
K
m_{i_{1}}
m_{i_{2}}
m_{i_{K}}
p_{m_{i}}(s_{t+1},r_{t}|s_{t},a_{t})
m^{\#}_{i}
m^{\#}_{i}
\pi^{*}_{m^{\#}_{i}}
do\_sample\leftarrow
\pi^{*}_{m^{\#}_{i}}
a_{t}\leftarrow\pi_{m^{\#}_{i}}(s_{t})
r_{t}
s_{t+1}
N_{s_{t},a_{t}}\leftarrow N_{s_{t},a_{t}}+1
p_{m_{i}}(s_{t+1},r_{t}|s_{t},a_{t})
N_{s_{t},a_{t}}=B
p_{wm}(s_{t+1},r_{t}|s_{t},a_{t})
do\_sample\leftarrow
0.5g
1.5g
0.5\times
1.5\times
100
100
100
100
100
100
150
150
100
100
400
400
400
400
150
150
0.001
0.001
0.0006
0.0006
0.0006
0.0006
0.001
0.001
0.0005
0.0005
0.0006
0.0006
0.0006
0.0006
0.001
0.001
20
20
30
30
30
30
1
1
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
50
50
\{1,20\}
\{1,20\}
\{1,20\}
\{1,20\}
\{1,20\}
\{1,20\}
8\times 64
8\times 64
8\times 64
8\times 64
8\times 64
8\times 64
8\times 64
8\times 64
256
256
256
256
256
256
256
256
40
40
20
20
20
20
30
30
500
500
500
500
500
500
500
500
50
50
50
50
50
50
50
50
\{0.005,0.05,0.5\}
\lambda=1e-5,\mu=1e-5
k
\lambda
\{1e-6,1e-7,1e-4\}
K=5
\gamma=0.95,\Delta=0.01
0.4
0
0.4
0.2
0
0.8
0
0.2
0.1
0
0
0.9
0
0
0.8
0.2
0
0.3
0
0
0.2
1
0.6
0
0
0
0
0
15\sim 33
(x,y)
x
y
R_{t}=\mathbb{I}\{s_{t}~{}\text{reach the right wall}\}-\mathbb{I}\{s_{t+1}~{}%
\text{hit the obstacle}\}+\dot{x}_{t}\cdot\mathbb{I}\{s_{t+1}~{}\text{not hit %
the obstacle}\}
n
T
g(\omega|D_{i}^{T})
\pi
\displaystyle g(\omega|D_{i}^{T})=\frac{p(D_{i}^{T}|\omega)}{\int_{\Gamma}p(D_%
{i}^{T}|\omega)d\pi(\omega)}
\displaystyle g(\omega|D_{i}^{T})
\displaystyle=\frac{p(D_{i}^{T}|\omega)}{\int_{\Gamma}p(D_{i}^{T}|\omega)d\pi(%
\omega)}
\displaystyle=\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}{%
\int_{\Gamma}\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)d\pi(\omega)}
\displaystyle=\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}{%
\int_{\Gamma}\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)d\pi(\omega)}
\displaystyle=\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}{%
\mathbb{E}_{\pi}\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}
\displaystyle=\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}{%
\mathbb{E}_{\pi}\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}
\displaystyle=\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}{%
\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}
\displaystyle=\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega)}{%
\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}
f(\omega)
\Gamma
g(\omega)
\pi
\mathbb{E}_{\pi}g(\omega)f(\omega)\leq D_{KL}(gd\pi||d\pi)+\ln\mathbb{E}_{\pi}%
\exp(f(\omega))
R_{n}(g)
\displaystyle R_{n}(g)=\mathbb{E}_{\pi}g(\omega_{i})\sum_{t=1}^{T}\ln\frac{q(s%
^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}+D_%
{KL}(gd\pi||d\pi)
\displaystyle R_{n}(g)
\displaystyle=\mathbb{E}_{\pi}g(\omega_{i})\sum_{t=1}^{T}\ln\frac{q(s^{t+1},r^%
{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}+D_{KL}(gd%
\pi||d\pi)
\displaystyle=\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a%
^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}\sum_{t=1}^{%
T}\ln\frac{q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};%
\omega_{i})}
\displaystyle=\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a%
^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}\sum_{t=1}^{%
T}\ln\frac{q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};%
\omega_{i})}
\displaystyle+\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a%
^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}\sum_{t=1}^{%
T}\ln\frac{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}{q(s^{t+1},r^{t}|D_{i}^%
{t},a^{t})}
\displaystyle+\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a%
^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}\sum_{t=1}^{%
T}\ln\frac{p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}{q(s^{t+1},r^{t}|D_{i}^%
{t},a^{t})}
\displaystyle=\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a%
^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}\Big{[}\ln%
\frac{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{\prod_{t=1}^{T}p(s^{t+1%
},r^{t}|D_{i}^{t},a^{t};\omega_{i})}-\ln\frac{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D%
_{i}^{t},a^{t})}{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}%
\Big{]}
\displaystyle=\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a%
^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}\Big{[}\ln%
\frac{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{\prod_{t=1}^{T}p(s^{t+1%
},r^{t}|D_{i}^{t},a^{t};\omega_{i})}-\ln\frac{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D%
_{i}^{t},a^{t})}{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t},a^{t};\omega_{i})}%
\Big{]}
\displaystyle=0
\displaystyle=0
f(\omega)=-\sum_{t=1}^{T}\ln\frac{q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},%
r^{t}|D_{i}^{t},a^{t};\omega)}
\displaystyle R_{n}(\cdot)=D_{KL}(gd\pi||d\pi)-\mathbb{E}_{\pi}g(\omega)f(\omega)
\displaystyle R_{n}(\cdot)
\displaystyle=D_{KL}(gd\pi||d\pi)-\mathbb{E}_{\pi}g(\omega)f(\omega)
\displaystyle\geq\ln\mathbb{E}_{\pi}\exp(f(\omega))
\displaystyle\geq\ln\mathbb{E}_{\pi}\exp(f(\omega))
\displaystyle=\ln\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t%
},a^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}
\displaystyle=\ln\mathbb{E}_{\pi}\frac{\prod_{t=1}^{T}p(s^{t+1},r^{t}|D_{i}^{t%
},a^{t};\omega_{i})}{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}
\displaystyle=\ln\frac{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{\prod_%
{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}
\displaystyle=\ln\frac{\prod_{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{\prod_%
{t=1}^{T}q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}
\displaystyle=0
\displaystyle=0
\inf R_{n}(\cdot)\geq 0=R_{n}(g)
g(\omega)
R_{n}(\cdot)
\varepsilon_{\pi,n}
d_{\pi}
n
T\rightarrow\infty
\sum_{t=1}^{T}\ln\frac{q(s^{t+1},r^{t}|D_{i}^{t},a^{t})}{p(s^{t+1},r^{t}|D_{i}%
^{t},a^{t};\omega_{i})}\rightarrow T\cdot D_{KL}(q||p(\cdot|\omega_{i}))
n
T
R_{n}(\cdot)
\displaystyle\inf R_{n}(g)=\inf[\mathbb{E}_{\pi}g(\omega_{i})\cdot n\cdot D_{%
KL}(q||p(\cdot|\omega_{i}))+D_{KL}(gd\pi||d\pi)]
\displaystyle\inf R_{n}(g)
\displaystyle=\inf[\mathbb{E}_{\pi}g(\omega_{i})\cdot n\cdot D_{KL}(q||p(\cdot%
|\omega_{i}))+D_{KL}(gd\pi||d\pi)]
\displaystyle=\inf[\mathbb{E}_{\pi}g(\omega_{i})D_{KL}(q||p(\cdot|\omega_{i}))%
+\frac{1}{n}D_{KL}(gd\pi||d\pi)]
\displaystyle=\inf[\mathbb{E}_{\pi}g(\omega_{i})D_{KL}(q||p(\cdot|\omega_{i}))%
+\frac{1}{n}D_{KL}(gd\pi||d\pi)]
\displaystyle r_{n}(q)=\inf_{g}[\mathbb{E}_{\pi}g(\omega_{i})D_{KL}(q||p(\cdot%
|\omega_{i}))+\frac{1}{n}D_{KL}(gd\pi||d\pi)]
\displaystyle r_{n}(q)
\displaystyle=\inf_{g}[\mathbb{E}_{\pi}g(\omega_{i})D_{KL}(q||p(\cdot|\omega_{%
i}))+\frac{1}{n}D_{KL}(gd\pi||d\pi)]
\displaystyle=-\frac{1}{n}\ln\mathbb{E}_{\pi}e^{-nD_{KL}(q||p(\cdot|\omega_{i}%
))}.
\displaystyle=-\frac{1}{n}\ln\mathbb{E}_{\pi}e^{-nD_{KL}(q||p(\cdot|\omega_{i}%
))}.
d_{\pi}
\displaystyle r_{n}(q)\leq\frac{n+1}{n}d_{\pi}
\displaystyle r_{n}(q)\leq\frac{n+1}{n}d_{\pi}
d>0
\displaystyle r_{n}(q)=-\frac{1}{n}\ln\mathbb{E}_{\pi}e^{-nD_{KL}(q||p(\cdot|%
\omega_{i}))}\leq-\frac{1}{n}\ln[e^{-nd}\pi({p\in\Gamma:D_{KL}(q||p)\leq d})]
\displaystyle r_{n}(q)
\displaystyle=-\frac{1}{n}\ln\mathbb{E}_{\pi}e^{-nD_{KL}(q||p(\cdot|\omega_{i}%
))}\leq-\frac{1}{n}\ln[e^{-nd}\pi({p\in\Gamma:D_{KL}(q||p)\leq d})]
\displaystyle=d+\frac{1}{n}\times[-\ln\pi({p\in\Gamma:D_{KL}(q||p)\leq d})]%
\leq\frac{n+1}{n}d_{\pi}
\displaystyle=d+\frac{1}{n}\times[-\ln\pi({p\in\Gamma:D_{KL}(q||p)\leq d})]%
\leq\frac{n+1}{n}d_{\pi}
n
d_{\pi}
d_{\pi}
\rho=\frac{1}{2}
\epsilon_{h}=\frac{2\varepsilon_{n}+(4\eta-2)h}{\delta/4}
\Gamma_{1}=\{p\in\Gamma:D^{Re}_{\rho}(q||p)<\epsilon_{h}\}
\Gamma_{2}=\{p\in\Gamma:D^{Re}_{\rho}(q||p)\geq\epsilon_{h}\}
a=e^{-nh}
\pi^{\prime}(\theta)=a\pi(\theta)C
\theta\in\Gamma_{1}
\pi^{\prime}(\theta)C
\theta\in\Gamma_{2}
C=(a\pi(\Gamma_{1})+\pi(\Gamma_{2}))^{-1}\in[1,1/a]
\displaystyle\mathbb{E}_{X}\pi^{\prime}(\Gamma_{2}|X)\epsilon_{h}\leq\mathbb{E%
}_{X}\mathbb{E}_{\pi^{\prime}}\pi^{\prime}(\theta|X)\frac{1}{2}||p-q||^{2}_{1}%
\leq\mathbb{E}_{X}\mathbb{E}_{\pi^{\prime}}\pi^{\prime}(\theta|X)D_{KL}(q||p)
\displaystyle\mathbb{E}_{X}\pi^{\prime}(\Gamma_{2}|X)\epsilon_{h}\leq\mathbb{E%
}_{X}\mathbb{E}_{\pi^{\prime}}\pi^{\prime}(\theta|X)\frac{1}{2}||p-q||^{2}_{1}%
\leq\mathbb{E}_{X}\mathbb{E}_{\pi^{\prime}}\pi^{\prime}(\theta|X)D_{KL}(q||p)
1-\delta
\displaystyle\mathbb{E}_{X}\mathbb{E}_{\pi^{\prime}}\pi^{\prime}(\theta|X)D_{%
KL}(q||p)\leq\frac{\eta\ln\mathbb{E}_{\pi^{\prime}}e^{-nD_{KL}(q||p(\cdot|%
\omega_{i}))}}{\rho(\rho-1)n}
\displaystyle\mathbb{E}_{X}\mathbb{E}_{\pi^{\prime}}\pi^{\prime}(\theta|X)D_{%
KL}(q||p)\leq\frac{\eta\ln\mathbb{E}_{\pi^{\prime}}e^{-nD_{KL}(q||p(\cdot|%
\omega_{i}))}}{\rho(\rho-1)n}
\displaystyle+\frac{\eta-\rho}{\rho(1-\rho)n}\inf_{\{\Gamma_{j}\}}\ln\sum_{j}%
\pi^{\prime}(\Gamma_{j})^{(\eta-1)/(\eta-\rho)}(1+r_{ub}(\Gamma_{j}))^{n}
\displaystyle+\frac{\eta-\rho}{\rho(1-\rho)n}\inf_{\{\Gamma_{j}\}}\ln\sum_{j}%
\pi^{\prime}(\Gamma_{j})^{(\eta-1)/(\eta-\rho)}(1+r_{ub}(\Gamma_{j}))^{n}
\displaystyle\leq\frac{\eta h-(\eta/n)\ln\mathbb{E}_{\pi}e^{-nD_{KL}(q||p(%
\cdot|\omega_{i}))}}{\rho(1-\rho)}+\frac{\eta-\rho}{\rho(1-\rho)}\Big{[}\frac{%
(\eta-1)h}{\eta-\rho}+\varepsilon_{upper,n}\Big{(}\frac{\eta-1}{\eta-\rho}\Big%
{)}\Big{]}
\displaystyle\leq\frac{\eta h-(\eta/n)\ln\mathbb{E}_{\pi}e^{-nD_{KL}(q||p(%
\cdot|\omega_{i}))}}{\rho(1-\rho)}+\frac{\eta-\rho}{\rho(1-\rho)}\Big{[}\frac{%
(\eta-1)h}{\eta-\rho}+\varepsilon_{upper,n}\Big{(}\frac{\eta-1}{\eta-\rho}\Big%
{)}\Big{]}
\displaystyle=\frac{(2\eta-1)h}{\rho(1-\rho)}+\frac{-(\eta/n)\ln\mathbb{E}_{%
\pi}e^{-nD_{KL}(q||p(\cdot|\omega_{i}))}+(\eta-\rho)\varepsilon_{upper,n}((%
\eta-1)/(\eta-\rho))}{\rho(1-\rho)}
\displaystyle=\frac{(2\eta-1)h}{\rho(1-\rho)}+\frac{-(\eta/n)\ln\mathbb{E}_{%
\pi}e^{-nD_{KL}(q||p(\cdot|\omega_{i}))}+(\eta-\rho)\varepsilon_{upper,n}((%
\eta-1)/(\eta-\rho))}{\rho(1-\rho)}
d_{\pi}
\displaystyle\mathbb{E}_{X}\pi^{\prime}(\Gamma_{2}|X)\epsilon_{h}
\displaystyle\mathbb{E}_{X}\pi^{\prime}(\Gamma_{2}|X)\epsilon_{h}
\displaystyle\leq\frac{(2\eta-1)h}{\rho(1-\rho)}+\frac{\eta\inf_{d>0}[d-\frac{%
1}{n}\ln\pi(\{p\in\Gamma:D_{KL}(q||p)\leq d\})]+(\eta-\rho)\varepsilon_{upper,%
n}((\eta-1)/(\eta-\rho))}{\rho(1-\rho)}
\displaystyle\leq\frac{(2\eta-1)h}{\rho(1-\rho)}+\frac{\eta\inf_{d>0}[d-\frac{%
1}{n}\ln\pi(\{p\in\Gamma:D_{KL}(q||p)\leq d\})]+(\eta-\rho)\varepsilon_{upper,%
n}((\eta-1)/(\eta-\rho))}{\rho(1-\rho)}
\displaystyle\leq\frac{(2\eta-1)h}{\rho(1-\rho)}+\frac{\eta(1+\frac{1}{n})d_{%
\pi}+(\eta-\rho)\varepsilon_{upper,n}((\eta-1)/(\eta-\rho))}{\rho(1-\rho)}
\displaystyle\leq\frac{(2\eta-1)h}{\rho(1-\rho)}+\frac{\eta(1+\frac{1}{n})d_{%
\pi}+(\eta-\rho)\varepsilon_{upper,n}((\eta-1)/(\eta-\rho))}{\rho(1-\rho)}
\displaystyle=\frac{(2\eta-1)h+\varepsilon_{n}}{\rho(1-\rho)}
\displaystyle=\frac{(2\eta-1)h+\varepsilon_{n}}{\rho(1-\rho)}
\eta
\gamma
\epsilon_{h}
\pi^{\prime}(\Gamma|X)\leq 0.5
\displaystyle\pi(\Gamma_{2}|X)=a\pi^{\prime}(\Gamma_{2}|X)/(1-(1-a)\pi^{\prime%
}(\Gamma|X))
\displaystyle\pi(\Gamma_{2}|X)
\displaystyle=a\pi^{\prime}(\Gamma_{2}|X)/(1-(1-a)\pi^{\prime}(\Gamma|X))
\displaystyle\leq\frac{a}{a+1}=\frac{1}{1+e^{nh}}
\displaystyle\leq\frac{a}{a+1}=\frac{1}{1+e^{nh}}
2.0\times
2.0\times
2\times
(x,y)
x
y
P_{\Omega}
i
\omega_{i}
\omega
\omega_{i}
P_{\Omega}
i
\omega_{i}
\omega
\omega_{i}
\Psi
P_{\Omega}
\omega
P_{\Omega}
\omega
m
\geq 70
\alpha_{0}=(n_{1},n_{2})
\theta_{0}=(\frac{1}{2},\frac{1}{2})
B
[0.5-\epsilon,0.5+\epsilon]
1-\delta
H\sim\mathit{Bin}(H|\rho=0.5,B),
\hat{\rho}\sim\mathit{Beta}(\hat{\rho}|\alpha=H+n_{1},\beta=B-H+n_{2}),
B
P(0.5-\epsilon\leq\hat{\rho}\leq 0.5+\epsilon)\geq 1-\delta,
\sum_{H=0}^{B}\mathit{Bin}(H|\rho=0.5,B)\cdot\int_{\hat{\rho}=0.5-\epsilon}^{0%
.5+\epsilon}\mathit{Beta}(\hat{\rho}|\alpha=H+n_{1},\beta=B-H+n_{2})\geq 1-\delta.
n_{1}
n_{2}
B
\epsilon=0.1
\delta=0.3
B
n_{1},n_{2}
(n_{1},n_{2})
B
(n_{1},n_{2})
10
B
(10,0)
(5,5)
(0,10)
(5,5)
B,\epsilon
\delta
\int_{P_{0}}Dir(P_{0}|\Phi^{True})\Big{[}\sum_{\mathbf{N}:||\mathbf{N}||_{1}=B%
}Mult(N|P_{0},B)\Big{[}\int_{P:||P(\Phi)-P_{0}(\Phi)||\leq\epsilon}Dir(P|\Phi_%
{old}+\mathbf{N})dP\Big{]}\Big{]}dP_{0}\geq 1-\delta
\sum_{\mathbf{N}:||\mathbf{N}||_{1}=B_{w}}Mult(N|P_{w_{0}},B_{w})\Big{[}\int_{%
P:||P_{w}(\Phi)-P_{w_{0}}(\Phi)||\leq\epsilon}Dir(P_{w}|\Phi_{w_{old}}+\mathbf%
{N})dP_{w}\Big{]}\geq 1-\delta
P_{0}
\Phi_{old}=\Phi_{w}
\epsilon
