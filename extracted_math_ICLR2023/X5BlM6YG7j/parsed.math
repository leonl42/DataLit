\operatorname{\mathbf{m}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{a}}
\operatorname{\mathbf{o}}
\operatorname{\mathbf{m}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{a}}
\operatorname{\mathbf{o}}
\operatorname{\mathbf{x}}
\operatorname{\mathbf{o}}_{i}
i
j
\operatorname{\mathbf{m}}
\operatorname{\mathbf{m}}
\operatorname{\mathbf{a}}_{i}=\operatorname{\mathbf{o}}_{i}\odot\operatorname{%
\mathbf{m}}
m_{j}>0
\sum_{j}m_{j}=1
\operatorname{\mathbf{r}}
\operatorname{\mathbf{x}}
\operatorname{\mathbf{o}}_{i}
\operatorname{\mathbf{a}}
\operatorname{\mathbf{x}}
\operatorname{\mathbf{a}}_{i}
\operatorname{\mathbf{o}}_{i}
\ln P(\operatorname{\mathbf{a}})=\sum_{i}\ln P(\operatorname{\mathbf{a}}_{i})
P(\operatorname{\mathbf{a}},\operatorname{\mathbf{r}})=P(\operatorname{\mathbf%
{a}}\mid\operatorname{\mathbf{r}})P(\operatorname{\mathbf{r}})
\operatorname{\mathbf{r}}
P(\operatorname{\mathbf{r}})
P(\operatorname{\mathbf{a}}_{i}\mid\operatorname{\mathbf{r}})\sim\mathcal{N}(%
\bm{\mu}_{i},\bm{\sigma}_{i})
\bm{\mu}_{i}
\bm{\mu}_{i}=f(LSTM_{i}(g(\operatorname{\mathbf{r}}),LSTM_{i-1}))
f(\cdots)
g(\cdots)
Q(\operatorname{\mathbf{r}}\mid\operatorname{\mathbf{a}})\sim\mathcal{N}(%
\operatorname{\bm{\mu_{q}}},\operatorname{\bm{\sigma_{q}}})
\operatorname{\mathbf{a}}_{i}
\operatorname{\bm{\mu_{q}}}
\operatorname{\bm{\sigma_{q}}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{o}}_{i}
\operatorname{\mathbf{\hat{a}}}_{i}
\operatorname{\mathbf{o}}_{i}
\operatorname{\mathbf{\hat{a}}}_{i}
\operatorname{\mathbf{x}}
\operatorname{\mathbf{a}}_{i}
\operatorname{\mathbf{\hat{a}}}_{i}
L_{rec}=\frac{1}{2}\sum_{(i,j)-pairs}\left|\right|\operatorname{\mathbf{a}}_{i%
}-\operatorname{\mathbf{\hat{a}}}_{j}\left|\right|^{2}
\beta
L_{reg}=\beta D_{\mathrm{KL}}\left(Q(\operatorname{\mathbf{r}}\mid%
\operatorname{\mathbf{x}})\left|\right|P(\operatorname{\mathbf{r}})\right)
L_{entropy}=-\sum_{j}m_{j}\ln m_{j}
L_{condition}=\sum_{j}(1-m_{j})~{}|~{}L^{*}_{rec_{j}}-\gamma_{j}~{}|
\gamma_{j}
L^{*}_{rec_{j}}
L^{*}_{rec_{j}}
L_{rec_{j}}
\operatorname{\mathbf{\hat{a}}}
\operatorname{\mathbf{o}}
L^{*}_{rec_{j}}=\frac{1}{2}\sum_{(i,j)-pairs}\left(\operatorname{\mathbf{o}}_{%
i}-\frac{\operatorname{\mathbf{\hat{a}}}_{j}}{m_{j}}\right)^{2}
L_{condition}
L_{reorder}=\sum_{i=1}\left|\right|\operatorname{\mathbf{\hat{a}}}_{i}-%
\operatorname{\mathbf{\hat{a}}}_{i-1}\left|\right|^{2}
L=L_{reg}+L_{rec}+L_{entropy}+L_{re-order}+L_{condition}
1e-3
1e-4
L_{reorder}
\operatorname{\mathbf{l}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{a}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{\tilde{r}}}
\operatorname{\mathbf{l}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{\tilde{r}}}
\operatorname{\bm{\sigma_{s}}}
\operatorname{\bm{\sigma_{s}}}
d_{\operatorname{\mathbf{r}}}
d_{\operatorname{\mathbf{r}}}
\operatorname{\mathbf{r}}
\operatorname{\bm{\mu_{q}}},\operatorname{\bm{\sigma_{q}}}
\operatorname{\mathbf{r}}\sim Q(\operatorname{\mathbf{r}}\mid\operatorname{%
\mathbf{a}})
\hat{\operatorname{\mathbf{a}}}_{i}
d_{\operatorname{\mathbf{a}}}
d_{\operatorname{\mathbf{a}}}
\operatorname{\mathbf{\tilde{r}}}
\operatorname{\mathbf{\tilde{r}}}
\operatorname{\mathbf{l}}
\operatorname{\mathbf{l}}
\operatorname{\mathbf{l}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{r}}
\operatorname{\mathbf{l}}
\operatorname{\mathbf{\tilde{r}}}
Q_{scan}(\operatorname{\mathbf{\tilde{r}}}\mid l)
\operatorname{\bm{\mu_{s}}}
\operatorname{\bm{\sigma_{s}}}
\beta
Q_{scan}(\operatorname{\mathbf{\tilde{r}}}\mid\operatorname{\mathbf{l}})
Q(\operatorname{\mathbf{r}}\mid a)
\operatorname{\mathbf{\tilde{r}}}
\operatorname{\bm{\sigma_{s}}}
\operatorname{\bm{\sigma_{s}}}
\operatorname{\mathbf{\tilde{r}}}
