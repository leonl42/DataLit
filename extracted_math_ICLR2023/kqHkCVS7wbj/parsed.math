4
4
4
4
4
4
4
4
4
4
4
4
i
s_{i},a_{i},r_{i}
L
\tau:=(s_{0},a_{0},r_{0},...,s_{L},a_{L},r_{L})
r_{i}
i
a_{i}
i
R_{i}:=\sum_{t^{\prime}=i}^{L}r_{t^{\prime}}
(R_{0},s_{0},a_{0},...,R_{L},s_{L},a_{L})
u(t)
\dot{x}=Ax(t)+Bu(t),\quad y(t)=Cx(t)+Du(t)
u(t)
y(t)
A
D
D
D=0
\Delta
\bar{A},\bar{B},\bar{C}
\bar{A}=(\mathit{I}-\Delta/2\cdot A)^{-1}(I+\Delta/2\cdot A),\quad\bar{B}=(%
\mathit{I}-\Delta/2\cdot A)^{-1}\Delta B,\quad\bar{C}=C
x_{k}=\bar{A}x_{k-1}+\bar{B}u_{k},\quad y_{k}=\bar{C}x_{k}
y_{t}=\sum_{i=0}^{t}K_{i}u_{t-i},\quad K_{i}=\bar{C}\bar{A}^{i-1}\bar{B},\quad
y%
=K*u
*
4
4
L
R_{i}=\sum_{i=1}^{L}r_{i}
r_{i}
i
\tau=(s_{1},a_{1},R_{1},\dots,s_{L},a_{L},R_{L},s_{T})
L
4
4
4
10
4
65
4
X
4
4
4
N=64
H=64
X
X
4
4
X(s_{i},R_{i-1},a_{i-1}\mid\theta_{X})=\texttt{Init}()
X
\tau
i\in[0,...,L]
R_{-1}=R_{\tau},a_{-1}=0
\hat{a_{i}}=X(s_{i},R_{i-1},a_{i-1})
=|\hat{a_{i}}-a_{i}|^{2}
\theta_{X}
s_{i}
R_{i-1}
a_{i-1}
X
\hat{a_{i}}
L_{2}
a_{i}
\hat{a_{i}}
4
R_{-1}
0.5,0.75,1.0
4
X
4
X^{\prime}
C
C^{\prime}
\bar{\tau}
Q
N(0,\sigma_{episode})
\sigma_{episode}
\sigma
\alpha_{C}
\alpha_{X}
4
A
4
R_{-1}
10\%
1.0
X^{\prime}(s_{i},R_{i-1},a_{i-1}\mid\theta_{X^{\prime}})
C(s_{i},a_{i-1}\mid\theta_{C})
C^{\prime}(s_{i},a_{i-1}\mid\theta_{C^{\prime}})
C(s_{i},a_{i-1}\mid\theta_{C})
X(s_{i},R_{i-1},a_{i-1}\mid\theta_{X})
=1
M
t
w_{t}\sim N(0,\sigma_{episode})
\sigma_{episode}:=\frac{M-episode}{M}\sigma
a_{t}:=X(s_{i},R_{i-1},a_{i-1}\mid\theta_{X})
w_{t}
a_{t}
r_{i}
s_{i+1}
((s_{i},a_{i-1},R_{i-1}),r_{i},(s_{i+1},a_{i},R_{i}))
D
K_{1}
C
B=\{(s_{i},a_{i-1},R_{i-1}),r_{i},(s_{i+1},a_{i},R_{i})\}\subset D
y=r_{i}+\gamma C^{\prime}(s_{i+1},X^{\prime}(s_{i+1},R_{i},a_{i}))
\theta_{C}\leftarrow\theta_{C}-\alpha_{C}\nabla_{\theta_{C}}(C(s_{i},a_{i})-y)%
^{2}
\theta_{X}\leftarrow\theta_{X}+\alpha_{X}\nabla_{\theta_{X}}C(s_{i},X(s_{i},R_%
{i-1},a_{i-1}))
K_{2}
C^{\prime}
C
X^{\prime}
X
\bar{\tau}
\theta_{C}^{\prime}\leftarrow(1-\bar{\tau})\theta_{C}^{\prime}+\bar{\tau}%
\theta_{C}
\theta_{X}^{\prime}\leftarrow(1-\bar{\tau})\theta_{X}^{\prime}+\bar{\tau}%
\theta_{X}
X,X^{\prime}
C,C^{\prime}
4
z_{i}=(s_{i},a_{i},R_{i})
s
4
(z_{i},r_{i},z_{i+1})
\delta
\delta
TT_{u}
TT_{q}
\delta
\delta
\delta
84\%
TT_{q}
TT_{q}
PW
P
W
P=15
W=256
17
2.1
4
0.1
4
2
\ast
2
\ast
\ast
\ast
4
k
k
k
s_{i}
4
\bar{A}
4
4
64
H
64
N
N
H
47.31
47.01
47.42
47.26
47.15
47.12
42.6
43.80
43.74
43.61
40.71
25.97
39.83
36.6
94.75
94.03
94.44
94.27
93.42
94.48
86.8
\%
1.0
0.88
0.82
0.47
0.25
0.41
\%
0.15
0.13
0.12
0.07
0.04
0.06
1.0
N
H
N
H
H=32
93\%
N=64,H=16
27K
4
N
64
32
16
H
64
32
16
4
4
4
4
u(t):\mathbb{R}\rightarrow\mathbb{R}
\dot{x}=Ax(t)+Bu(t),\quad y(t)=Cx(t)+Du(t)
u(t)
y(u)
A
D
D
D=0
\Delta
\bar{A},\bar{B},\bar{C}
\bar{A}=(\mathit{I}-\Delta/2\cdot A)^{-1}(I+\Delta/2\cdot A),\quad\bar{B}=(%
\mathit{I}-\Delta/2\cdot A)^{-1}\Delta B,\quad\bar{C}=C
x_{k}=\bar{A}x_{k-1}+\bar{B}u_{k},\quad y_{k}=\bar{C}x_{k}
\bar{A}
\bar{B},\bar{C}
u:=(u_{0},u_{1},...u_{L-1})
L
\displaystyle\forall i\in[L-1]:x_{i}\in\mathbb{R}^{N},\quad x_{0}=\bar{B}u_{0}%
,\quad x_{1}=\bar{A}\bar{B}u_{0}+\bar{B}u_{1}\quad,\quad...,\quad x_{L-1}=\sum%
_{i=0}^{L-1}\bar{A}^{L-1-i}u_{i}
\displaystyle\forall i\in[L-1]:x_{i}\in\mathbb{R}^{N},\quad x_{0}=\bar{B}u_{0}%
,\quad x_{1}=\bar{A}\bar{B}u_{0}+\bar{B}u_{1}\quad,\quad...,\quad x_{L-1}=\sum%
_{i=0}^{L-1}\bar{A}^{L-1-i}u_{i}
\displaystyle y_{i}\in\mathbb{R},\quad y_{0}=\bar{C}\bar{B}u_{0},\quad x_{1}=%
\bar{C}\bar{A}\bar{B}u_{0}+\bar{C}\bar{B}u_{1}\quad,\quad...,\quad x_{L-1}=%
\sum_{i=0}^{L-1}\bar{C}\bar{A}^{L-i-1}\bar{B}u_{i}
\displaystyle y_{i}\in\mathbb{R},\quad y_{0}=\bar{C}\bar{B}u_{0},\quad x_{1}=%
\bar{C}\bar{A}\bar{B}u_{0}+\bar{C}\bar{B}u_{1}\quad,\quad...,\quad x_{L-1}=%
\sum_{i=0}^{L-1}\bar{C}\bar{A}^{L-i-1}\bar{B}u_{i}
N
\begin{bmatrix}y_{0}\\
y_{1}\\
\vdots\\
\vdots\\
\vdots\\
y_{L-1}\end{bmatrix}=\begin{bmatrix}\bar{C}\bar{B}&0&0&0&0&0\\
\bar{C}\bar{A}\bar{B}&\bar{C}\bar{B}&0&\ddots&\ddots&0\\
\vdots&\bar{C}\bar{A}\bar{B}&\bar{C}\bar{B}&\ddots&\ddots&0\\
\vdots&\ddots&\ddots&\ddots&\ddots&0\\
\bar{C}\bar{A}^{L-2}\bar{B}&\ddots&\ddots&\bar{C}\bar{A}\bar{B}&\bar{C}\bar{B}%
&0\\
\bar{C}\bar{A}^{L-1}\bar{B}&\bar{C}\bar{A}^{L-2}\bar{B}&\ldots&\ldots&\bar{C}%
\bar{A}\bar{B}&\bar{C}\bar{B}\end{bmatrix}\begin{bmatrix}u_{0}\\
u_{1}\\
\vdots\\
\vdots\\
\vdots\\
u_{L-1}\end{bmatrix}\,,
y=\bar{k}*y
\bar{k}
A,B,C,D,\Delta
\bar{A},\bar{B},\bar{C}
4
4
1-
\bar{k}
16,000
L
\bar{A}
\bar{k}
\bar{k}
\bar{k}
A
A
L
L^{2}
5.4
O(L^{2})
L
k=1
k=20
k=100
k=250
k=300
TT_{q},TT_{u}
2.1
2.3
3.1
5.1
10.5
18.6
17K
1
k
TT_{q}
TT_{u}
1
k
TT_{q}
TT_{u}
L
L
L\log L
84\%
5.3
1
0
32
10^{-5}
10000
10^{-4}
\bar{\tau}=0.1
10\%
R_{-1}=1.0
96
\alpha_{C}=10^{-3}
\alpha_{X}=10^{-5}
K_{1}=200
K_{2}=300
\delta
4
x_{k}=\bar{A}x_{k-1}+\bar{B}u_{k},\quad y_{k}=\bar{C}x_{k}
y_{t}=\sum_{i=0}^{t}K_{i}u_{t-i},\quad K_{i}=\bar{C}\bar{A}^{i}\bar{B},\quad y%
=K*u
\bar{B}=(1,1,...,1)
\bar{A}
A
\Delta
\bar{A}
\lambda_{j}\in\mathbb{C}
j\in[N]
t
j
x_{t}(j)
\sum_{i=0}^{t}\lambda_{j}^{i}u_{t-i}
\lvert\lambda_{j}\rvert\leq 1
\lvert\lambda_{j}\rvert\geq\lvert\lambda_{j}^{2}\rvert\geq...\geq\lvert\lambda%
_{j}^{t}\rvert
\lvert\lambda_{j}\rvert
x_{t}(j)
\lvert\lambda_{j}\rvert\approx 1
\lvert\lambda_{j}\rvert<<1
i\in[L]
\lambda_{j}^{i}
j
x_{t}(j)
\lambda_{j}^{i}
i\in[L]
\lambda_{j}^{i}
j
x_{t}(j)
\lambda_{j}^{i}
x_{t}
x_{t}
\bar{C}
K
\bar{C}
y=K*u
K_{i}=\bar{C}\bar{A}^{i}
t
K_{i}
u_{t-i}
y_{t}
i\in[L]
K_{i}
K_{i}
i
i\in[L]
K_{i}
K_{i}
i
NL\epsilon_{\textbf{machine}}
L
N
L=1000
\bar{A}=\text{diag}(\lambda_{1},...,\lambda_{N})
\bar{B}=(1,...,1)
\displaystyle\quad y_{t}=\bar{C}x_{t},\quad x_{t}(j)=\lambda_{j}x_{t-1}(j)+u_{t}
\displaystyle\quad y_{t}=\bar{C}x_{t},\quad x_{t}(j)=\lambda_{j}x_{t-1}(j)+u_{t}
N
x_{t}
j\in[1,...,N]
\lambda_{j}x_{t-1}(j)
u_{t}
\lambda_{j}=1
4
NL\epsilon_{\textbf{machine}}
L
N
fl:\mathbb{B}\rightarrow\mathbb{B}
op
{}^{\prime}+^{\prime}
\displaystyle fl(a\quad op\quad b)=(1+\delta_{a}^{\text{op}})(a\quad op\quad b%
),\quad|\delta_{a}^{\text{op}}|\leq\epsilon_{\textbf{machine}}
\displaystyle fl(a\quad op\quad b)=(1+\delta_{a}^{\text{op}})(a\quad op\quad b%
),\quad|\delta_{a}^{\text{op}}|\leq\epsilon_{\textbf{machine}}
\Delta_{s_{t}}
\forall t\geq 0
\Delta_{s_{t}}\leq Nt\epsilon_{\textbf{machine}}\sum_{i=0}^{t}|\lambda_{j}^{t-%
i}u_{i}|
x_{t}
sum_{t}^{*}
sum_{t}:=fl(x_{t})
sum_{-1}=0
\displaystyle sum_{0}=(1+\delta^{+}_{sum_{0}})u_{0}
\displaystyle sum_{0}=(1+\delta^{+}_{sum_{0}})u_{0}
\displaystyle sum_{1}=(1+\delta^{+}_{sum_{1}})\Big{(}u_{1}+\lambda_{j}(1+%
\delta^{+}_{sum_{0}})u_{0}\Big{)}
\displaystyle sum_{1}=(1+\delta^{+}_{sum_{1}})\Big{(}u_{1}+\lambda_{j}(1+%
\delta^{+}_{sum_{0}})u_{0}\Big{)}
\displaystyle sum_{2}=(1+\delta^{+}_{sum_{2}})\Big{(}u_{2}+\lambda_{j}\Big{[}(%
1+\delta^{+}_{sum_{1}})\Big{(}u_{1}+\lambda_{j}(1+\delta^{+}_{sum_{0}})u_{0}%
\Big{)}\Big{]}\Big{)}
\displaystyle sum_{2}=(1+\delta^{+}_{sum_{2}})\Big{(}u_{2}+\lambda_{j}\Big{[}(%
1+\delta^{+}_{sum_{1}})\Big{(}u_{1}+\lambda_{j}(1+\delta^{+}_{sum_{0}})u_{0}%
\Big{)}\Big{]}\Big{)}
\displaystyle sum_{t}=\sum_{i=0}^{t}\lambda_{j}^{t-i}u_{i}\Pi_{k=i}^{t}(1+%
\delta^{+}_{sum_{k}})
\displaystyle sum_{t}=\sum_{i=0}^{t}\lambda_{j}^{t-i}u_{i}\Pi_{k=i}^{t}(1+%
\delta^{+}_{sum_{k}})
|\delta^{+}_{sum_{k}}|\leq\epsilon_{\textbf{machine}}
\epsilon_{\textbf{machine}}^{2}
\displaystyle\Pi_{k=i}^{t}(1+\delta^{+}_{sum_{k}})=1+\sum_{k=i}^{t}\delta^{+}_%
{sum_{k}}+O(t^{2}\epsilon_{\textbf{machine}}^{2})
\displaystyle\Pi_{k=i}^{t}(1+\delta^{+}_{sum_{k}})=1+\sum_{k=i}^{t}\delta^{+}_%
{sum_{k}}+O(t^{2}\epsilon_{\textbf{machine}}^{2})
\displaystyle sum_{t}=\sum_{i=0}^{t}\lambda_{j}^{t-i}u_{i}\Big{[}1+\sum_{k=i}^%
{t}\delta^{+}_{sum_{k}}+O(t^{2}\epsilon_{\textbf{machine}}^{2})\Big{]}
\displaystyle sum_{t}=\sum_{i=0}^{t}\lambda_{j}^{t-i}u_{i}\Big{[}1+\sum_{k=i}^%
{t}\delta^{+}_{sum_{k}}+O(t^{2}\epsilon_{\textbf{machine}}^{2})\Big{]}
\displaystyle\Delta_{sum_{t}}:=|sum_{t}-sum_{t}^{*}|=\Big{|}\sum_{i=0}^{t}%
\lambda_{j}^{t-i}u_{i}\Big{(}\sum_{k=i}^{t}\delta^{+}_{sum_{k}}+O(t^{2}%
\epsilon_{\textbf{machine}}^{2})\Big{)}\Big{|}\leq O(t\epsilon_{\textbf{%
machine}})\sum_{i=0}^{t}|\lambda_{j}^{t-i}u_{i}|
\displaystyle\Delta_{sum_{t}}:=|sum_{t}-sum_{t}^{*}|=\Big{|}\sum_{i=0}^{t}%
\lambda_{j}^{t-i}u_{i}\Big{(}\sum_{k=i}^{t}\delta^{+}_{sum_{k}}+O(t^{2}%
\epsilon_{\textbf{machine}}^{2})\Big{)}\Big{|}\leq O(t\epsilon_{\textbf{%
machine}})\sum_{i=0}^{t}|\lambda_{j}^{t-i}u_{i}|
\lambda_{j}
u_{i}
x
i
y
100
\lambda_{j}
sum_{i}^{*}
2
\lambda_{j}\in\{0.8,1.0,1.005\}
\lambda_{j}\in\{0.8,1.0,1.005\}
\lambda_{j}<1
\lambda_{j}\approx 1
x_{t}
\sum_{i=0}^{t}\lambda_{j}^{t-i}u_{i}
\lambda_{j}\approx 1
u_{0}
\lambda_{j}
|\lambda_{j}|
\bar{A}
H=10
N=64
\bar{A}
H=10
N=64
0.2\%-30\%
15\%-60\%
4
\Delta
A
2
5\%
