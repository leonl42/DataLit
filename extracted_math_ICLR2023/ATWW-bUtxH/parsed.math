\mathcal{G}=(\mathcal{V},\mathcal{E},\mathbf{X})\in\mathbb{G}
\mathcal{V}=\{v_{1},v_{2},\dots,v_{n}\}
n
\mathcal{E}=\{(v_{i},v_{j})\mid v_{i},v_{j}\in\mathcal{V}\}
\mathbf{X}=\{x_{1},x_{2},\dots,x_{n}\}\in\mathbb{R}^{n\times D}
x_{i}\in\mathbb{R}^{1\times D}
v_{i}
D
\mathbf{A}\in\{0,1\}^{n\times n}
\mathbf{A}_{ij}=1
(v_{i},v_{j})\in\mathcal{E}
f_{\theta}
g_{\phi}
\theta
\phi
\mathcal{D}=\{(\mathcal{G}_{1},y_{1}),\dots,(\mathcal{G}_{m},y_{m})\}
y
\mathcal{G}
\max_{\theta,\phi}\prod_{i=0}^{m}P_{f_{\theta},\,g_{\phi}}(y_{i}\mid\mathcal{G%
}_{i})=\max_{\theta,\phi}\prod_{i=0}^{m}g_{\phi}(f_{\theta}(\mathbf{X},\mathbf%
{A}))\left[y_{i}\right]
\left[y_{i}\right]
y_{i}
g_{\phi}(\cdot)
f_{\theta}
u_{\psi}:\mathbb{G}\to\mathbb{G}
\mathcal{G}
u_{\psi}(\mathcal{G})
g_{\phi}
u_{\psi}
g_{\phi}
\max_{\psi,\phi}\prod_{i=0}^{m}P_{f_{\theta},\,g_{\phi}}(y_{i}\mid u_{\psi}(%
\mathcal{G}_{i}))=\max_{\psi,\phi}\prod_{i=0}^{m}g_{\phi}(f_{\theta}(\mathbf{X%
}_{\psi},\mathbf{A}_{\psi}))\left[y_{i}\right]
\mathbf{X}_{\psi}
\mathbf{A}_{\psi}
u_{\psi}
\mathbf{X}=\{x_{1},x_{2},\dots,x_{n}\}
\mathcal{G}
p_{1},p_{2},\dots,p_{n}\in\mathbb{R}^{1\times D}
u_{\psi}
\mathbf{X}^{\ast}
\mathbf{X}^{\ast}=\{x_{1}+p_{1},x_{2}+p_{2},\dots,x_{n}+p_{n}\}=\{x^{\ast}_{1}%
,x^{\ast}_{2},\dots,x^{\ast}_{n}\}
\mathbf{X}^{\ast}
f_{\theta}(\mathcal{G}^{\ast})=f_{\theta}(\mathbf{X}^{\ast},\mathbf{A})
\mathcal{A}_{d}=\{a_{1},a_{2},\dots,a_{n}\}
z\in\mathbb{R}^{D}
D
\mathcal{A}_{c}=\{z_{1},z_{2},\dots,z_{n}\}
\mathcal{L}^{\text{PPO}}
\mathcal{L}^{\text{Critic}}
\mathcal{G}
n
a
v_{a}
\{v_{1},\dots,v_{n}\}
z\in\mathbb{R}^{1\times D}
v_{a}
D
t
(a_{t},z_{t})=p^{a,z}_{t}
t
\mathbf{P}_{t}=\{p_{1,t},\dots,p_{n,t}\}\in\mathbb{R}^{n\times D}
\mathbf{P}_{0}
\mathbf{X}^{\ast}
\mathcal{G}^{\ast}
\mathbf{X}^{\ast}=\mathbf{X}+\mathbf{P}
\mathcal{G}^{\ast}
f_{\theta}
t
\begin{split}s_{t}&\coloneqq f_{\theta}(\mathcal{G}^{\ast}_{t-1})=f_{\theta}(%
\mathbf{X}^{\ast}_{t-1},\mathbf{A})=f_{\theta}(\mathbf{X}+\mathbf{P}_{t-1},%
\mathbf{A})\\
&=\{h^{\ast}_{1,t-1}\,,\dots,h^{\ast}_{n,t-1}\}\in\mathbb{R}^{n\times d}\end{split}
h^{\ast}_{i,t-1}
v_{i}
\mathcal{G}^{\ast}_{t-1}
d
N
(N-n)
\mathbf{0}\in\mathbb{R}^{1\times d}
h^{\ast}_{n,t}
\begin{split}s_{t}&\coloneqq f_{\theta}(\mathbf{X}^{\ast}_{t-1},\mathbf{A})%
\left|\right|\mathbf{0}_{(N-n)\times d}\\
&=\{h^{\ast}_{1,t-1},\dots,h^{\ast}_{n,t-1},\mathbf{0}_{n+1},\dots,\mathbf{0}_%
{N}\}\in\mathbb{R}^{N\times d}\end{split}
||
p^{a,z}_{t}
t
v_{a}
p_{a}
\mathbf{X}^{\ast}_{t}=\mathbf{X}+\mathbf{P}_{t}
\mathbf{P}_{t}
\mathbf{P}_{t}=\mathbf{P}_{t-1}+p^{a,z}_{t}=\{p_{1,t-1}\,,\dots,\,p_{a,t-1}+p^%
{a,z}_{t},\dots,\,p_{n,t-1}\}
s_{t+1}
\mathbf{X}^{\ast}_{t-1}
\mathbf{X}^{\ast}_{t}
\mathcal{G}^{\ast}_{t}
r(s_{t},a_{t},z_{t},s_{t+1})
r_{t}
r_{t}=\mathcal{L}_{t-1}-\mathcal{L}_{t}=\mathcal{L}\left(g_{\phi}\left(f_{%
\theta}(\mathcal{G}^{\ast}_{t-1})\right),y\right)-\mathcal{L}\left(g_{\phi}%
\left(f_{\theta}(\mathcal{G}^{\ast}_{t})\right),y\right)
\mathcal{L}(\cdot)
1
T
\Pi_{\omega}
\omega
f_{\theta}
\mathcal{G}^{\ast}
\begin{split}p(a\mid s)&\leftarrow\textsc{Softmax}\left(\text{MLP}_{a}\left(f_%
{\theta}(\mathcal{G}^{\ast})\right)\right)\\
\boldsymbol{\mu}(s,a)&\leftarrow\text{MLP}_{z}\left(f_{\theta}(\mathcal{G}^{%
\ast})\right)\left[a\right]\\
V(s)&\leftarrow\text{MLP}_{c}\left(\textsc{Flatten}\left(f_{\theta}(\mathcal{G%
}^{\ast})\right)\right)\end{split}
\pi_{d}(a|s)
s
f_{\theta}(\mathcal{G}^{\ast})
N\times d
\text{MLP}_{a}
s
p(a|s)\in\mathbb{R}^{n}
v_{a}
p(a|s)
N
n
\pi_{c}(z|s,a)
s\in\mathbb{R}^{N\times d}
\text{MLP}_{z}
N
\boldsymbol{\mu}\in\mathbb{R}^{1\times D}
N
\boldsymbol{\mu}
\left[a\right]
a
(\boldsymbol{\mu},\boldsymbol{\sigma})
z\in\mathbb{R}^{1\times D}
p^{a,z}
\boldsymbol{\mu}
\boldsymbol{\sigma}\in\mathbb{R}^{1\times D}
p^{a,z}
z
\left[-z_{\text{max}},z_{\text{max}}\right]
z_{\text{max}}>0
s
V(s)\in\mathbb{R}
s
N\times d
1\times Nd
\text{MLP}_{c}
V(s)
\Pi_{\omega}
f_{\theta}
\Pi_{\omega}
g_{\phi}
\mathcal{G}
y
n
\mathcal{L}_{0}
\mathcal{L}(g_{\phi}(f_{\theta}(\mathcal{G})),y)
p^{a,z}_{t}
\pi_{d}
\pi_{c}
v_{a}
y
(s,a,z,r,s^{\prime})
n
n
\mathcal{L}^{\text{PPO}}
\mathcal{L}^{\text{Critic}}
n
\mathcal{G}^{\ast}
m
g_{\phi}
\min_{\phi}{\frac{1}{m}\sum^{m}_{i=1}\mathcal{L}\left(g_{\phi}\left(f_{\theta}%
(\mathcal{G}^{\ast}_{i})\right),y\right)}
\mathcal{L}(\cdot)
q
q
\mathcal{L}^{\text{PPO}}
\pi_{d}(a|s)
l
\{\pi_{d,1},\dots,\pi_{d,l}\}
\pi_{d,i}
\mathcal{D}_{i}
\mathcal{D}
\pi_{d,i}
\pi_{d,i}
\pi_{d,\,J}
\mathcal{L}_{d,i}=\mathcal{L}^{\text{PPO}}_{d,i}-\alpha_{d}\mathbb{E}_{s\sim%
\pi_{d,i},\,\mathcal{D}_{i}}\left[D_{\text{KL}}\Big{(}\pi_{d,i}(a|s)\left|%
\right|\pi_{d,\,J}(a|s)\Big{)}\right]
\alpha_{d}>0
D_{\text{KL}}
\pi_{d,\,J}
\pi_{d,i}
\pi_{d,\,J}(a|s)=\frac{\max_{i=1,\dots,l}\pi_{d,i}(a|s)}{\sum_{a^{\prime}}\max%
_{i=1,\dots,l}\pi_{d,i}(a^{\prime}|s)}
p(a|s)
\pi_{d,\,J}
l
a
l
\{\pi_{c,1},\dots,\pi_{c,l}\}
\mathcal{D}_{i}
l
\pi_{c,i}
\mathcal{L}_{c,i}=\mathcal{L}^{\text{PPO}}_{c,i}-\alpha_{c}\mathbb{E}_{s\sim%
\pi_{c,i},\,\mathcal{D}_{i}}\left[D_{\text{KL}}\Big{(}\pi_{c,i}(a|s)\left|%
\right|\pi_{c,\,J}(a|s)\Big{)}\right]
\alpha_{c}>0
\pi_{c,\,J}
\pi_{c,\,J}(z|s,a)=\frac{1}{l}\sum_{i=1}^{l}\pi_{c,i}(z|s,a)=\frac{1}{l}\sum_{%
i=1}^{l}\boldsymbol{\mu}_{i}(s,a)
\boldsymbol{\mu}_{i}
l
l
\mathcal{L}^{\text{Critic}}
\pi_{d,\,J}
\pi_{c,\,J}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathcal{G}
n
\mathbf{P}=\{p_{1},\dots,p_{n}\}\in\mathbb{R}^{n\times D}
p^{a,z}
n
\text{PCR}(\mathcal{G})=\frac{1}{n}\sum_{i=1}^{n}\mathbf{1}\left[p_{i}\neq%
\mathbf{0}_{1\times D}\right]\;\in\left[0,1\right]
\mathbf{1}\left[\cdot\right]
p_{i}
\mathbf{0}_{1\times D}
\text{APM}(\mathcal{G})=\frac{1}{n}\sum_{i=1}^{n}\frac{1}{D}\mathbf{1}\left[p_%
{i}\neq\mathbf{0}_{1\times D}\right]\cdot\left\|p_{i}\right\|_{1}\;\in\left[0,%
+\infty\right)
\left\|p_{i}\right\|_{1}
p_{i}
p_{i}
l
\alpha_{d}
\alpha_{c}
z_{\text{max}}
\{0.1,0.5,1.0\}
\{1,2,3\}
q
\{1,2,3\}
10^{-2}
10^{-2}
\boldsymbol{\times}
\boldsymbol{\times}
\times
\times
\times
\times
\times
\times
\times
\times
\times
k
z_{\text{max}}
l
\alpha_{d}
\alpha_{c}
k
\mathcal{L}(\cdot)
\min_{\theta}\sum_{v_{i},v_{j}}\mathcal{L}\left(f_{\theta}(v_{i})^{\top}f_{%
\theta}(v_{j}),\mathbf{A}_{ij}\right)
\mathbf{A}_{ij}
vi
vj
\mathcal{G}
\mathbf{A}
\begin{split}\min_{\theta}-\frac{1}{\left|\mathcal{V}\right|}&\sum_{v\in%
\mathcal{V}}\frac{1}{\left|\mathcal{V}^{+}\right|}\cdot\\
&\sum_{v^{+}\in\mathcal{N}(v)}\log\frac{\exp(h_{v}^{\top}h_{v^{+}}/\tau)}{\exp%
(h_{v}^{\top}h_{v^{+}}/\tau)+\sum_{v^{-}\in\mathcal{V}^{-}}\exp(h_{v}^{\top}h_%
{v^{-}}/\tau)}\end{split}
h_{v}
h_{v^{+}}
h_{v^{-}}
v
v^{+}
v^{-}
f_{\theta}(\mathcal{G})
\mathcal{V}^{+}
v
\mathcal{V}^{-}
\tau
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
k
l
\alpha_{d}
\alpha_{c}
z_{\text{max}}
q
\gamma
\lambda
\beta
z_{\text{max}}
l
\alpha_{d}
\alpha_{c}
z_{\text{max}}
z_{\text{max}}
l
l
\alpha_{d}
\alpha_{c}
\left\langle\mathcal{S},\mathcal{A}_{d},\mathcal{A}_{c},P,r,\gamma\right\rangle
\mathcal{S}
(a,z)
a\in\mathcal{A}_{d}
z\in\mathcal{A}_{c}
\gamma\in\left[0,1\right)
r(s,a,z,s^{\prime})\in\mathbb{R}
(a,z)
s
s^{\prime}
P(s^{\prime}|s,a,z)
\pi_{d}(a|s)
\pi_{c}(z|s,a)
R=\sum^{T}_{t=0}\gamma^{t}r(s_{t},a_{t},z_{t},s_{t+1})
T
\pi_{\Phi}
\nabla_{\Phi}J(\Phi)=\mathbb{E}_{(s,a,s^{\prime})\sim\pi}\left[\sum_{t=0}^{T}%
\nabla_{\Phi}\log\pi_{\Phi}(a_{t}|s_{t})\mathbf{M}_{t}\right]
\mathbf{M}_{t}
\mathbf{M}_{t}
A(s_{t},a_{t})
r(\Phi)
\mathcal{L}^{\text{surr}}
\begin{array}[]{c}\begin{aligned} \mathcal{L}^{\text{surr}}(\Phi)&=\mathbb{E}_%
{\pi}\left[\min\left(r(\Phi)A(s,a),\text{clip}\left(r(\Phi),1-\epsilon,1+%
\epsilon\right)A(s,a)\right)\right],\end{aligned}\\[5.0pt]
\begin{aligned} r(\Phi)&=\frac{\pi_{\Phi}(a|s)}{\pi_{\Phi\text{old}}(a|s)}\end%
{aligned}\end{array}
\mathcal{L}^{\text{PPO}}
\mathcal{L}^{\text{PPO}}(\Phi)=\mathcal{L}^{\text{surr}}(\Phi)+\mathbb{E}_{\pi%
}[\beta\mathcal{H}(\pi_{\Phi}(a|s))]
\beta
\mathcal{L}^{\text{PPO}}
\mathcal{L}^{\text{Critic}}
\mathcal{L}^{\text{Critic}}(\Psi)=\mathbb{E}_{\pi}\left[\left(V_{\Psi}(s_{t})-%
R_{t}\right)^{2}\right],\quad R_{t}=\sum_{l=0}^{\infty}\gamma^{l}r_{t+l}
(s,a,z,r,s^{\prime})
\mathcal{L}^{\text{PPO}}(\Phi_{d})
(s,a,r,s^{\prime})
\mathcal{L}^{\text{PPO}}(\Phi_{c})
(s,z,r,s^{\prime})
(s,r,s^{\prime})
\Pi_{\omega}
g_{\phi}
\Pi_{\omega}
l
{\pi_{\Phi_{d,1}},\dots,\pi_{\Phi_{d,l}}}
{\pi_{\Phi_{c,1}},\dots,\pi_{\Phi_{c,l}}}
V_{\Psi}(s)
{\Phi_{d,1},\dots,\Phi_{d,l},\Phi_{c,1},\dots,\Phi_{c,l},\Psi,\phi}
\omega
l
l
\left[m/l\right]
m
\left[\cdot\right]
\left[o\cdot\left[m/l\right]\right]
o
\pi_{d,\,J}
\pi_{c,\,J}
f_{\theta}
\mathcal{D}=\{(\mathcal{G}_{1},y_{1}),\dots,(\mathcal{G}_{m},y_{m})\}
\{n_{1},\dots,n_{m}\}
l
N
q
E
\Pi_{\omega}
g_{\phi}
\omega
\phi
l
\{\mathcal{D}_{1},\dots,\mathcal{D}_{l}\}
\mathcal{D}
l
epoch=1
E
i=1
l
(\mathcal{G}_{j},y_{j})
\mathcal{D}_{i}
\mathcal{L}_{0}=\mathcal{L}(g_{\phi}(f_{\theta}(\mathcal{G}_{j})),y_{j})
\mathbf{P}_{0}
\mathcal{B}
t=1
n_{i}
s_{t}
p_{t}^{a,z}
\pi_{\Phi_{d,i}}
\pi_{\Phi_{c,i}}
\mathbf{P}_{t-1}
r_{t}
(s_{t},a_{t},z_{t},r_{t},s_{t+1})
\mathcal{B}
\pi_{\Phi_{d,i}}
\pi_{\Phi_{c,i}}
V_{\Psi}(s)
\mathcal{B}
\mathcal{L}^{\text{Critic}}
\mathcal{D}^{\ast}
(\mathcal{G}_{k},y_{k})
\mathcal{D}
\mathbf{P}_{0}
t=1
n_{k}
p_{t}^{a,z}
\pi_{d,\,J}
\pi_{c,\,J}
\mathbf{P}_{t-1}
\mathcal{G}_{k}^{\ast}
\mathcal{D}^{\ast}
times=1
q
\mathcal{D}^{\ast}
L_{g}
d_{g}
(2l+1)
L_{p}
d_{p}
l
L_{h}
d_{h}
N
E
m
m^{\prime}
D
d_{g}
2O(d_{g}d_{p}+L_{p}d_{p}^{2})
O(L_{g}(Ed_{g}+NDd_{g}))
O(Nd_{g})
O(d_{g}d_{h}+L_{h}d_{h}^{2})
O(1)
N
N
m
\begin{split}mN&\cdot[2O(d_{g}d_{p}+L_{p}d_{p}^{2})\\
&+O(L_{g}(Ed_{g}+NDd_{g})+Nd_{g})+O(d_{g}d_{h}+L_{h}d_{h}^{2})+O(1)]\end{split}
mN
l
3mN\cdot O(d_{g}d_{p}+L_{p}d_{p}^{2})
q
\begin{split}&mNl\cdot[2O(d_{g}d_{p}+L_{p}d_{p}^{2})+O(L_{g}(Ed_{g}+NDd_{g})+%
Nd_{g})]\\
&+mq\cdot[O(d_{g}d_{h}+L_{h}d_{h}^{2})+O(1)]\end{split}
q
q
m
m^{\prime}
d_{g}
d_{p}
d_{h}
d
L_{(\cdot)}
q
m\cdot O(N^{2}Dd+N^{2}d+Nd^{2}+NED+d^{2}+N+1)
m^{\prime}\cdot O(N^{2}Dd+N^{2}d+Nd^{2}+NED+d^{2}+1)
D
d
O(mN^{2}Dd)
O(mNED)
m
