F
t
W^{t}
W^{t}_{i}
i
x^{t_{i}}
y^{t}_{i}
\nabla W^{t}_{i}
\nabla W^{t}_{i}=\frac{\partial\mathcal{L}(F(x^{t}_{i},W^{t}),y^{t}_{i})}{%
\partial W^{t}}.
\nabla W^{t}=\frac{1}{N}\sum_{i}^{N}\nabla W^{t}_{i}
W^{t+1}=W^{t}-\eta\nabla W^{t},
W^{t+1}_{i}=W^{t}-\eta\nabla W^{t}_{i}
W^{t+1}=\frac{1}{N}\sum_{i}^{N}W^{t+1}_{i}.
W^{t}_{i}
\nabla W^{t}_{i}
t
W^{t}_{i}
W^{t+1}_{i}
t
t+1
F(x;W)
W
\nabla W
N
\hat{x}_{N+1}
\hat{y}_{N+1}
\hat{x}_{1}\hookrightarrow\mathcal{N}(0,1)
\hat{y}_{1}\hookrightarrow\mathcal{N}(0,1)
\hat{\nabla W_{i}}=\frac{\partial\mathcal{L}(F(\hat{x}_{i},W),\hat{y}_{i})}{%
\partial W}
{\mathbb{D}_{i}=\left\|\hat{\nabla W_{i}}-\nabla W\right\|^{2}}
\hat{x}_{i+1}=\hat{x}_{i}-\eta\nabla_{\hat{x}_{i}}\mathbb{D}_{i},\quad\hat{y}_%
{i+1}=\hat{y}_{i}-\eta\nabla_{\hat{y}_{i}}\mathbb{D}_{i}
y
y_{c}=1
c
z
N
p_{i}=\frac{e^{z_{i}}}{\sum_{n=1}^{N}e^{z_{n}}}
(x,y)
\mathcal{L}(x,y)=-\sum_{n=1}^{N}y_{n}\log{\frac{e^{z_{n}}}{\sum_{n=1}^{N}e^{z_%
{n}}}}=-\log{\frac{e^{z_{c}}}{\sum_{n=1}^{N}e^{z_{n}}}}
i
\frac{\partial\mathcal{L}(x,y)}{\partial z_{i}}=-\frac{\partial z_{c}-\log\sum%
_{n=1}^{N}{e^{z_{n}}}}{\partial z_{i}}=p_{i}-y_{i},
i=c
y_{i}=1
y_{i}=0
x
y^{*}
x
y^{*}=\arg\min[E(x,y)+TV(y)]
TV(X)=\sum_{i,j}(|X_{i+1,j}-X_{i,j}|+|X_{i,j+1}-X_{i,j}|)
x
y
MSE(x,y)=E{(x-y)^{2}},
E
PSNR=10*\log_{10}(\frac{MAX^{2}}{MSE(x,y)}),
MAX
n
MAX=2^{n}-1
SSIM(x,y)=\frac{(2\mu_{x}\mu_{y}+c_{1})(2\sigma_{xy}+c_{2})}{(\mu_{x}^{2}+\mu_%
{y}^{2}+c_{1})(\sigma_{x}^{2}+\sigma_{y}^{2}+c_{2})},
\mu
\sigma
\sigma_{xy}
c_{1}=(k_{1}L)^{2}
c_{2}=(k_{2}L)^{2}
k_{1}=0.01
k_{2}=0.03
(x,y)
(\hat{x},\hat{y})
W
\nabla W
\hat{x}^{*},\hat{y}^{*}=\arg\min_{\hat{x},\hat{y}}{[\mathcal{L}_{gm}(\hat{x},%
\hat{y},W,\nabla W)+\mathcal{R}_{aux}(\hat{x})]}.
l
\mathcal{L}_{gm}(\hat{x},W,\nabla W)=\sum_{l}\left\|\nabla_{W_{(l)}}\mathcal{L%
}(\hat{x},\hat{y})-\nabla W_{(l)}\right\|_{2}.
\hat{y}^{*}
x^{*}=[x_{1},x_{2},\cdots,x_{K}]
y^{*}=[y_{1},y_{2},\cdots,y_{K}]
(x_{k}
y_{k})
z_{k,n}
y_{k,n}\in\{0,1\}
y_{k}
n
N
\mathcal{L}(x_{k},y_{k})=-\sum_{n=1}^{N}y_{k,n}\log(\frac{e^{z_{k,n}}}{\sum_{n%
=1}^{N}e^{z_{k,n}}})
W
K
z
n
k
p_{k,n}=\frac{e^{z_{k,n}}}{\sum_{n^{\prime}=1}^{N}e^{z_{k,n^{\prime}}}}
\nabla_{W}\mathcal{L}(x^{*},y^{*})=\frac{1}{K}\sum_{k=1}^{K}\nabla_{W}\mathcal%
{L}(x_{k},y_{k})
\nabla_{z_{k,n}}\mathcal{L}(x_{k},y_{k})=p_{k,n}-y_{k,n}
W^{(FC)}\in\mathbb{R}^{M\times N}
M
\Delta{W^{(FC)}_{m,n,k}}:=\nabla_{W^{(FC)}_{m,n}}\mathcal{L}(x_{k},y_{k})
(x_{k},y_{k})
W^{(FC)}_{m,n}
m
n
O_{k,m}
m
k
\Delta W^{(FC)}_{m,n}
\Delta W^{(FC)}
k
\Delta W^{(FC)}_{m,n}=\frac{1}{K}\sum_{k=1}^{K}\Delta W^{(FC)}_{m,n,k}
\begin{split}\Delta W^{(FC)}_{m,n,k}&=\frac{\partial\mathcal{L}(x_{k},y_{k})}{%
\partial z_{k,n}}\cdot\frac{\partial z_{k,n}}{\partial W^{(FC)}_{m,n}}\\
&=\nabla_{z_{k,n}}\mathcal{L}(x_{k},y_{k})\cdot O_{k,m}\\
&=(p_{k.n}-y_{k,n})\cdot O_{k,m}\end{split}
S_{k,n}
\Delta W^{(FC)}
m
S_{k,n}=\sum_{m=1}^{M}\Delta W^{(FC)}_{m,n,k}
O_{k,m}
\Delta W^{(FC)}_{m,n,k}
p_{k,n}-y_{k,n}
S_{k,n}
k
n=n^{*}_{k}
\Delta W^{(FC)}
m
\Delta W^{(FC)}_{n}
\begin{split}\Delta W^{(FC)}_{n}&=\frac{1}{K}\sum_{k}\sum_{m}{(p_{k,n}-y_{k,n}%
)\cdot O_{k,m}}\\
&=\frac{1}{K}\sum_{k}(p_{k,n}-y_{k,n})\cdot\sum_{m}O_{k,m}\end{split}
O_{k}=\sum_{m}O_{k,m}
O_{k}\approx\bar{O_{k}}
\Delta W^{(FC)}_{n}\approx\frac{1}{K}\sum_{k}{(p_{k,n}-y_{k,n})}\bar{O_{k}}
n
\sum_{k}{y_{k,n}}\approx\sum_{k}{p_{k,n}}-\frac{K\Delta W^{(FC)}_{n}}{\bar{O_{%
k}}},
n
p_{k,n}
\bar{O_{k}}
0
255
0\sim 1
\mathcal{R}_{clip}{(\hat{x})}=\left\|{\hat{x}-clip(\hat{x})}\right\|_{2}
\mathcal{R}_{scale}{(\hat{x})}=\left\|{\hat{x}-scale(\hat{x})}\right\|_{2}
clip(\hat{x}_{i})=min(max(\hat{x}_{i},0),1)
scale(\hat{x}_{i})=\frac{\hat{x}_{i}-min_{v}}{max_{v}-min_{v}}
max_{v}
min_{v}
\mathcal{R}_{aux}(\hat{x})
\mathcal{R}_{aux}(\hat{x})=\alpha_{tv}\mathcal{R}_{tv}(\hat{x})+\alpha_{c}%
\mathcal{R}_{clip}(\hat{x})+\alpha_{s}\mathcal{R}_{scale}(\hat{x})
\{F_{j}(x;W)\}_{j=1}^{M}
T
\{W^{t}\},t=1..T
\{\nabla W^{t}\},t=1..T
\hat{x}_{T+1}
\hat{y}
x\hookrightarrow\mathcal{U}(0,1)
\hat{y}
\hat{\nabla W^{t}_{i}}=\frac{\partial\mathcal{L}(F(x_{i},W^{t}),\hat{y})}{%
\partial W^{t}}
{\mathbb{D}_{i}=\frac{1}{T}\sum_{t}\left\|\hat{\nabla W^{t}_{i}}-\nabla W^{t}%
\right\|^{2}}
x^{\prime}_{i+1}=x^{\prime}_{i}-\eta\nabla_{x^{\prime}_{i}}\mathbb{D}_{i}
T
{\frac{1}{T}\sum_{t}\left\|\nabla W^{\prime}_{i,t}-\nabla W_{t}\right\|^{2}}
W^{t+1}=W^{t}-\eta\nabla W^{t}
T
W^{0}
W^{T}
W^{0}
W^{T}
\hat{x}^{*},\hat{y}^{*}=\arg\min_{\hat{x},\hat{y}}{[\mathcal{L}_{gm}(\hat{x},%
\hat{y},W^{0},W^{T})+\mathcal{R}_{aux}(\hat{x})]}
\nabla W^{t+1}=\frac{1}{\eta}{(W^{t}-W^{t+1})}
W^{T}\approx W^{0}-T\cdot\eta\nabla W^{0}
\nabla W^{0}\approx\frac{1}{T\eta}(W^{0}-W^{T}).
l2
\sum_{l}\left\|\nabla_{W^{0}_{(l)}}\mathcal{L}(\hat{x},\hat{y})-(\frac{W_{(l)}%
^{0}-W_{(l)}^{T}}{T\eta})\right\|_{cos}
K
m
\forall i\in 1,\ldots,N
m(i)\in 1,\ldots,N
\forall i,j\in 1,\ldots,K
i\neq j\Rightarrow m(i)\neq m(j)
sim(\hat{x}_{i},x_{m(i)})
\hat{x}_{i}
x_{m(i)}
m^{*}=\arg\max_{m}\sum_{i=1}^{N}sim(\hat{x}_{i},x_{m(i)})
32\times 32
224\times 224
0.1
lr=0.5
\alpha_{tv}=0.5
\alpha_{l2}=0.1
\alpha_{c}=100
\alpha_{s}=100
lr=0.1
\alpha_{tv}=200
\alpha_{l2}=200
\alpha_{c}=200
\alpha_{s}=200
\downarrow
\downarrow
\uparrow
\downarrow
\mathcal{U}(0,1)
\mathcal{N}(0.5,1)
\mathcal{N}(0,1)
\mathcal{U}(-0.5,0.5)
\mathcal{N}(0,1)
\mathcal{U}(0,1)
\mathcal{N}(0.5,1)
\mathcal{U}(-0.5,0.5)
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
\downarrow
\uparrow
\downarrow
