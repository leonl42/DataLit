\langle\mathcal{S},\mathcal{A},P,R,\gamma\rangle
\mathcal{S}
\mathcal{A}
P
P(\textbf{s}^{\prime}|\textbf{s},\textbf{a})
R
R(\textbf{s},\textbf{a})
\gamma\in[0,1]
\textbf{a}\sim\pi(\textbf{s})
\textbf{s}^{\prime}\sim P(\textbf{s},\textbf{a})
r\sim R(\textbf{s},\textbf{a})
\max_{\pi,P}\mathbb{E}[\gamma^{t}R(\textbf{s}_{t},\textbf{a}_{t})]
Q_{\pi}
\pi
a
\pi
Q_{\pi}(\textbf{s},\textbf{a}):=R(\textbf{s},\textbf{a})+\gamma\mathbb{E}_{%
\textbf{s}^{\prime}\sim P,\textbf{a}^{\prime}\sim\pi}\left[Q_{\pi}\left(%
\textbf{s}^{\prime},\textbf{a}^{\prime}\right)\right]
\mathcal{D}
(\textbf{X},Y)\sim\mathcal{D},\textbf{X}\in\mathbb{R}^{n}
f
Y
Y
\textbf{X}=(\textbf{X}_{causal},\textbf{X}_{spurious})
\textbf{X}_{causal}
Y
Y=f^{*}(\textbf{X}_{causal})+\epsilon_{causal}
f^{*}
\epsilon_{causal}
\textbf{X}_{causal}\upmodels\epsilon_{causal}
\textbf{X}_{spurious}
\textbf{X}_{spurious}\upmodels\textbf{X}_{causal}
\textbf{X}_{spurious}
\textbf{X}_{causal}
\textbf{X}_{spurious}
\textbf{X}_{causal}
\textbf{X}_{spurious}=\textbf{X}_{causal}\gamma_{spurious}+\epsilon_{spurious}
\epsilon_{spurious}
\textbf{X}_{cau}\triangleq\textbf{X}\circ\omega_{cau}
\circ
\textbf{X}_{causal}
cau
\textbf{X}_{causal}
(\omega_{cau})_{i}=\mathbb{I}(i\in cau)
\textbf{X}_{spu}\triangleq\textbf{X}\circ\omega_{spu}
\textbf{X}_{spurious}
\textbf{X}_{cau}
Y=(\textbf{X}\circ\omega_{cau})\beta^{*}+\epsilon_{cau}
\omega_{cau}\circ\beta^{*}
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}}[\textbf{X}%
\beta-Y]^{2}.
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}}[\textbf{X}%
\beta-Y]^{2}.
\mathcal{D}
\mathcal{D}_{train}
\pi_{train}
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}.
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}.
\textbf{X}_{spu}
\textbf{X}_{cau}
\mathcal{D}_{train}
\omega_{cau}\circ\beta^{*}
D_{train}
\textbf{X}_{spu}=(\textbf{X}\circ\omega_{cau})\gamma_{spu}+\epsilon_{spu}
\mathbb{E}_{D_{train}}[\epsilon_{spu}]=0
\gamma_{spu}\neq\textbf{0}
\hat{\beta}_{spu}\triangleq\omega_{cau}\circ(\beta^{*}-\lambda\gamma_{spu})+%
\lambda\omega_{spu}
\lambda
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X%
}(\omega_{cau}\circ\beta^{*})-Y|_{2}\Big{)}\mid\textbf{X}\Big{]}=\mathbb{E}_{(%
\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X}\hat{\beta}_{spu}-Y|_{2}%
\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X%
}(\omega_{cau}\circ\beta^{*})-Y|_{2}\Big{)}\mid\textbf{X}\Big{]}=\mathbb{E}_{(%
\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X}\hat{\beta}_{spu}-Y|_{2}%
\Big{)}\mid\textbf{X}\Big{]}
\beta
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}+k\|\beta\|^{2},
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}+k\|\beta\|^{2},
k
k
\lambda
\lambda
\textbf{X}_{cau}
\textbf{X}_{spu}
|\textbf{X}_{cau}|=|\textbf{X}_{spu}|=1
\lambda
\lambda
k
\lambda
\displaystyle\lambda=\frac{\beta^{*}\gamma_{spu}}{{\beta^{*}}^{2}+\gamma_{spu}%
^{2}+1+\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})}
\displaystyle\lambda
\displaystyle=\frac{\beta^{*}\gamma_{spu}}{{\beta^{*}}^{2}+\gamma_{spu}^{2}+1+%
\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})}
\sigma^{2}_{spu}
\textbf{X}_{spu}
\textbf{X}_{cau}
D_{train}
\lambda
\lambda
\lambda
-\frac{1}{2}\leq\lambda\leq\frac{1}{2}.
\mathcal{D}=\{(\textbf{X},Y)\}
\hat{\beta}_{spu}
\lambda
\hat{Y}_{spu}=\textbf{X}\hat{\beta}_{spu}
|X_{i}|_{1}\leq X_{max},i=1,\cdots,n
\epsilon_{cau}
|\epsilon_{cau}|_{1}\leq\epsilon_{c}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D}[(|\hat{Y}_{spu}-Y|_{1})\mid%
\textbf{X}]\leq X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)+\epsilon_{c}.
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D}[(|\hat{Y}_{spu}-Y|_{1})\mid%
\textbf{X}]\leq X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)+\epsilon_{c}.
|\hat{Y}_{spu}-Y|_{1}
X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)
X_{spu}
X_{spu}
X_{cau}
\lambda
X_{spu}
|S_{t,i}|_{1}\leq S_{max},R_{t}\leq R_{max}
\lambda_{max}
\lambda
\gamma_{max}
|\gamma_{spu}|_{1}
n_{s}
n_{a}
\pi_{D}
M^{*}
M_{\theta}
M_{\theta}^{i}
i^{th}
spu_{i}
cau_{i}
\hat{S}_{t+1,i}=M^{i}_{\theta}((\textbf{S}_{t},\textbf{A}_{t})\circ\omega_{cau%
_{i}\cup spu_{i}})
V_{\pi}^{M_{\theta}}
\pi
M_{\theta}
V_{\pi}^{M^{*}}
\pi
\max_{S}D_{KL}(\pi(\cdot|S),\pi_{D}(\cdot|S))\leq\epsilon_{\pi}
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq\frac{2\sqrt{2}R_{max}}%
{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+\frac{R_{max}\gamma}{2(1-\gamma)^{2}}S_{%
max}[n_{s}\epsilon_{c}+(1+\gamma_{max})\lambda_{max}n_{s}(n_{s}+n_{a})R_{spu}]
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq\frac{2\sqrt{2}R_{max}}%
{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+\frac{R_{max}\gamma}{2(1-\gamma)^{2}}S_{%
max}[n_{s}\epsilon_{c}+(1+\gamma_{max})\lambda_{max}n_{s}(n_{s}+n_{a})R_{spu}]
R_{spu}=\frac{\sum_{i=1}^{n_{s}}|spu_{i}|}{n_{s}(n_{s}+n_{a})}
R_{spu}
\bar{R}_{spu}<1
R_{spu}
0
R_{spu}
\lambda_{max}
R_{spu}=0
p
p
p
p
X,Y
Z
Z
X,Y
Z
Z
X\upmodels Y\mid Z
Y
X
(Y,Z)
H_{0}
p
Z
(X,Y,Z)
Z
X
Y
Z
X
Y
Z
X
Y
Z
X,Y
Z
p=f_{KCI}(X,Y,Z)\in[0,1]
X
Y
Z
p
X
Y
Z
p^{*}
\displaystyle Causation(X,Y)=\mathbb{I}(f_{KCI}(X,Y,Z)\leq p^{*})\in\{0,1\},
\displaystyle Causation(X,Y)=\mathbb{I}(f_{KCI}(X,Y,Z)\leq p^{*})\in\{0,1\},
Causation(X,Y)=1
0
p^{*}
t
i^{th}
X_{t}^{i}
t+1
j^{th}
X_{t+1}^{j}
Causation(\cdot,\cdot)
(X_{t}^{i},X_{t+1}^{j})
\mathcal{G}
\displaystyle\mathcal{G}_{i,j}=Causation(X_{t}^{i},X_{t+1}^{j}),
\displaystyle\mathcal{G}_{i,j}=Causation(X_{t}^{i},X_{t+1}^{j}),
\mathcal{G}_{i,j}
i
j
\mathcal{G}
X^{k}
t
X^{k}
t+1
X^{k}
t
X^{k}
t+1
t+1
t
X_{t}^{i}
X_{t+1}^{j}
X_{t}^{i},X_{t+1}^{j}
X_{t/t+1}^{k}
X_{t}^{k}
X_{t}^{k}
X_{t}^{k}
X_{t}^{i}
X_{t+1}^{j}
X_{t+1}^{j}
X_{t}^{k}
X_{t}^{k}
X_{t+1}j
X_{t}^{i}
Z
X_{t}^{k}
X_{t+1}^{k}
X_{t+1}^{k}
X_{t+1}^{k}
X_{t+1}^{k}
X_{t+1}^{k}
X_{t}^{i}
X_{t+1}^{j}
X_{t}^{i}
X_{t+1}^{j}
X_{t}^{i}
X_{t+1}^{j}
t
t+1
\mathcal{D}=\{(\textbf{s}_{t},\textbf{a}_{t},\textbf{s}_{t+1},r_{t})\}
\mathcal{M}(\cdot;\theta)
p
G_{p}
p^{*}
G_{p}
G
p^{*}
\cdot
\mathcal{M}(\cdot)
\mathcal{M}_{Causal}(\cdot,G,\mathcal{M})
\pi^{*}=\textbf{Algo}(\mathcal{D})
\pi^{*}
d
v
x
v_{x}
y
v_{y}
(p_{x},p_{y})
a
(v_{x})_{t}
(p_{y})_{t+1}
(v_{x})_{t}
(p_{y})_{t+1}
v_{t-1}
(v_{x})_{t}
(v_{y})_{t}
(v_{x})_{t}^{2}+(v_{y})_{t}^{2}=v_{t-1}^{2}
(p_{y})_{t+1}-(p_{y})_{t}=(v_{y})_{t}
(v_{x})_{t}
(p_{y})_{t+1}-(p_{y})_{t}
(v_{x})_{t}
(p_{y})_{t+1}
(p_{y})_{t}
(v_{x})_{t}
y_{t+1}
\textbf{1}\times\textbf{10}^{\textbf{6}}
1\times 10^{7}
1\times 10^{6}
1\times 10^{6}
50\%
68.1\pm 20.9
-58.9\pm 41.3
86.2\pm 18.2
23.5\pm 17.9
24.9\pm 14.1
49.2\pm 19.0
-30.3\pm 49.9
-50.1\pm 34.2
46.2\pm 28.1
8.5\pm 6.2
2.5\pm 0.08
43.4\pm 7.7
9.9\pm 42.5
-5.4\pm 32.5
11.4\pm 24.0
13.3\pm 0.9
3.1\pm 0.7
16.3\pm 6.4
\lambda
X\%
100\%
X\%
\mathcal{D}
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}}[\textbf{X}%
\beta-Y]^{2}.
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}}[\textbf{X}%
\beta-Y]^{2}.
\mathcal{D}_{train}
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}.
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}.
\mathcal{D}_{train}
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}+k\|\beta\|^{2},
\displaystyle\min_{\beta}\mathbb{E}_{(\textbf{X},Y)\sim\mathcal{D}_{train}}[%
\textbf{X}\beta-Y]^{2}+k\|\beta\|^{2},
\omega_{cau}\circ\beta^{*}
D_{train}
\textbf{X}_{spu}=(\textbf{X}\circ\omega_{cau})\gamma_{spu}+\epsilon_{spu}
\mathbb{E}_{D_{train}}[\epsilon_{spu}]=0
\gamma_{spu}\neq\textbf{0}
\hat{\beta}_{spu}\triangleq\omega_{cau}\circ(\beta^{*}-\lambda\gamma_{spu})+%
\lambda\omega_{spu}
\lambda
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X%
}(\omega_{cau}\circ\beta^{*})-Y|_{2}\Big{)}\mid\textbf{X}\Big{]}=\mathbb{E}_{(%
\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X}\hat{\beta}_{spu}-Y|_{2}%
\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X%
}(\omega_{cau}\circ\beta^{*})-Y|_{2}\Big{)}\mid\textbf{X}\Big{]}=\mathbb{E}_{(%
\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|\textbf{X}\hat{\beta}_{spu}-Y|_{2}%
\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|(\textbf{%
X}\circ\omega_{cau})\beta^{*}-Y|_{2}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{[}\Big{(}|(\textbf{%
X}\circ\omega_{cau})\beta^{*}-Y|_{2}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|(%
\textbf{X}\circ\omega_{cau})(\beta^{*}-\lambda\gamma_{spu}+\lambda\gamma_{spu}%
)-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|(\textbf%
{X}\circ\omega_{cau})(\beta^{*}-\lambda\gamma_{spu}+\lambda\gamma_{spu})-Y|_{2%
}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|(%
\textbf{X}\circ\omega_{cau})(\beta^{*}-\lambda\gamma_{spu})+(\textbf{X}\circ%
\omega_{cau})\lambda\gamma_{spu}-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|(\textbf%
{X}\circ\omega_{cau})(\beta^{*}-\lambda\gamma_{spu})+(\textbf{X}\circ\omega_{%
cau})\lambda\gamma_{spu}-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|(%
\textbf{X}\circ\omega_{cau})(\beta^{*}-\lambda\gamma_{spu})+\lambda(X_{spu}-%
\epsilon_{spu})-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|(\textbf%
{X}\circ\omega_{cau})(\beta^{*}-\lambda\gamma_{spu})+\lambda(X_{spu}-\epsilon_%
{spu})-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|\textbf%
{X}(\omega_{cau}\circ(\beta^{*}-\lambda\gamma_{spu}))+\lambda(\textbf{X}\circ%
\omega_{spu})-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|\textbf{%
X}(\omega_{cau}\circ(\beta^{*}-\lambda\gamma_{spu}))+\lambda(\textbf{X}\circ%
\omega_{spu})-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle\quad\quad\Big{(}\textrm{Since\ }\mathbb{E}_{(\textbf{X},Y)\sim D%
_{train}}[\epsilon_{spu}]=0\Big{)}
\displaystyle\quad\quad\Big{(}\textrm{Since\ }\mathbb{E}_{(\textbf{X},Y)\sim D%
_{train}}[\epsilon_{spu}]=0\Big{)}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|\textbf%
{X}(\omega_{cau}\circ(\beta^{*}-\lambda\gamma_{spu})+\lambda\omega_{spu})-Y|_{%
2}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|\textbf{%
X}(\omega_{cau}\circ(\beta^{*}-\lambda\gamma_{spu})+\lambda\omega_{spu})-Y|_{2%
}\Big{]}\mid\textbf{X}\Big{\}}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|X\hat{%
\beta}_{spu}-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}\quad\quad
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{train}}\Big{\{}\Big{[}|X\hat{%
\beta}_{spu}-Y|_{2}\Big{]}\mid\textbf{X}\Big{\}}\quad\quad
\displaystyle\Big{(}\rm{Let}\ \hat{\beta}_{spu}\rm{denote}\ \ \omega_{cau}%
\circ(\beta^{*}-\lambda\gamma_{spu})+\lambda\omega_{spu}\Big{)}
\displaystyle\Big{(}\rm{Let}\ \hat{\beta}_{spu}\rm{denote}\ \ \omega_{cau}%
\circ(\beta^{*}-\lambda\gamma_{spu})+\lambda\omega_{spu}\Big{)}
\lambda
\lambda
k
\lambda
\displaystyle\lambda=\frac{\beta^{*}\gamma_{spu}}{{\beta^{*}}^{2}+\gamma_{spu}%
^{2}+1+\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})}
\displaystyle\lambda
\displaystyle=\frac{\beta^{*}\gamma_{spu}}{{\beta^{*}}^{2}+\gamma_{spu}^{2}+1+%
\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})}
\beta(k)=(\textbf{X}^{T}\textbf{X}+k\textbf{I})^{-1}\textbf{X}^{T}\textbf{Y},
\hat{\beta}_{spu}
\displaystyle\lambda=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}k}{\sigma^{2}_%
{cau}\sigma^{2}_{spu}+\sigma^{2}_{cau}\gamma_{spu}^{2}k+\sigma^{2}_{cau}k+%
\sigma^{2}_{spu}k+k^{2}}
\displaystyle\lambda=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}k}{\sigma^{2}_%
{cau}\sigma^{2}_{spu}+\sigma^{2}_{cau}\gamma_{spu}^{2}k+\sigma^{2}_{cau}k+%
\sigma^{2}_{spu}k+k^{2}}
k
k=\frac{\sigma^{2}_{spu}}{(\beta^{*})^{2}}
\displaystyle\lambda=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{%
cau}\sigma^{2}_{spu}/k+\sigma^{2}_{cau}\gamma_{spu}^{2}+\sigma^{2}_{cau}+%
\sigma^{2}_{spu}+k}
\displaystyle\lambda
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}%
\sigma^{2}_{spu}/k+\sigma^{2}_{cau}\gamma_{spu}^{2}+\sigma^{2}_{cau}+\sigma^{2%
}_{spu}+k}
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}%
\sigma^{2}_{spu}/(\frac{\sigma^{2}_{spu}}{(\beta^{*})^{2}})+\sigma^{2}_{cau}%
\gamma_{spu}^{2}+\sigma^{2}_{cau}+\sigma^{2}_{spu}+\frac{\sigma^{2}_{spu}}{(%
\beta^{*})^{2}}}
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}%
\sigma^{2}_{spu}/(\frac{\sigma^{2}_{spu}}{(\beta^{*})^{2}})+\sigma^{2}_{cau}%
\gamma_{spu}^{2}+\sigma^{2}_{cau}+\sigma^{2}_{spu}+\frac{\sigma^{2}_{spu}}{(%
\beta^{*})^{2}}}
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}{%
\beta^{*}}^{2}+\sigma^{2}_{cau}\gamma_{spu}^{2}+\sigma^{2}_{cau}+\sigma^{2}_{%
spu}+\frac{\sigma^{2}_{spu}}{(\beta^{*})^{2}}}
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}{%
\beta^{*}}^{2}+\sigma^{2}_{cau}\gamma_{spu}^{2}+\sigma^{2}_{cau}+\sigma^{2}_{%
spu}+\frac{\sigma^{2}_{spu}}{(\beta^{*})^{2}}}
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}({%
\beta^{*}}^{2}+\gamma_{spu}^{2}+1)+\sigma^{2}_{spu}+\frac{\sigma^{2}_{spu}}{(%
\beta^{*})^{2}}}
\displaystyle=\frac{\sigma^{2}_{cau}\beta^{*}\gamma_{spu}}{\sigma^{2}_{cau}({%
\beta^{*}}^{2}+\gamma_{spu}^{2}+1)+\sigma^{2}_{spu}+\frac{\sigma^{2}_{spu}}{(%
\beta^{*})^{2}}}
\displaystyle=\frac{\beta^{*}\gamma_{spu}}{{\beta^{*}}^{2}+\gamma_{spu}^{2}+1+%
\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})}
\displaystyle=\frac{\beta^{*}\gamma_{spu}}{{\beta^{*}}^{2}+\gamma_{spu}^{2}+1+%
\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})}
\lambda
-\frac{1}{2}\leq\lambda\leq\frac{1}{2}.
\displaystyle|\lambda|=\frac{|\beta^{*}\gamma_{spu}|}{|{\beta^{*}}^{2}+\gamma_%
{spu}^{2}+1+\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{%
2}})|}
\displaystyle|\lambda|
\displaystyle=\frac{|\beta^{*}\gamma_{spu}|}{|{\beta^{*}}^{2}+\gamma_{spu}^{2}%
+1+\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})|}
\displaystyle\leq\frac{|\beta^{*}\gamma_{spu}|}{|{\beta^{*}}^{2}+\gamma_{spu}^%
{2}+1|+|\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})|}
\displaystyle\leq\frac{|\beta^{*}\gamma_{spu}|}{|{\beta^{*}}^{2}+\gamma_{spu}^%
{2}+1|+|\frac{\sigma^{2}_{spu}}{\sigma^{2}_{cau}}(1+\frac{1}{(\beta^{*})^{2}})|}
\displaystyle\leq\frac{|\beta^{*}\gamma_{spu}|}{|{\beta^{*}}^{2}+\gamma_{spu}^%
{2}+1|}
\displaystyle\leq\frac{|\beta^{*}\gamma_{spu}|}{|{\beta^{*}}^{2}+\gamma_{spu}^%
{2}+1|}
\displaystyle\leq\frac{|\beta^{*}\gamma_{spu}|}{|2{\beta^{*}}\gamma_{spu}+1|}
\displaystyle\leq\frac{|\beta^{*}\gamma_{spu}|}{|2{\beta^{*}}\gamma_{spu}+1|}
\displaystyle\leq\frac{1}{2}
\displaystyle\leq\frac{1}{2}
-\frac{1}{2}\leq\lambda\leq\frac{1}{2}
\mathcal{D}=\{(\textbf{X},Y)\}
\hat{\beta}_{spu}
\lambda
\hat{Y}_{spu}=\textbf{X}\hat{\beta}_{spu}
|X_{i}|_{1}\leq X_{max},i=1,\cdots,n
\epsilon_{cau}
|\epsilon_{cau}|_{1}\leq\epsilon_{c}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D}[(|\hat{Y}_{spu}-Y|_{1})\mid%
\textbf{X}]\leq X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)+\epsilon_{c}.
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D}[(|\hat{Y}_{spu}-Y|_{1})\mid%
\textbf{X}]\leq X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)+\epsilon_{c}.
\hat{Y}_{cau}
(\textbf{X}\circ\omega_{cau})\beta^{*}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|\hat{Y}_{%
spu}-Y|_{1}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|\hat{Y}_{%
spu}-Y|_{1}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|(\hat{Y}_%
{spu}-\hat{Y}_{cau})+(\hat{Y}_{cau}-Y)|_{1}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|(\hat{Y}_{%
spu}-\hat{Y}_{cau})+(\hat{Y}_{cau}-Y)|_{1}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\leq\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|(\hat{%
Y}_{spu}-\hat{Y}_{cau})|_{1}\Big{)}\mid\textbf{X}\Big{]}+\mathbb{E}_{(\textbf{%
X},Y)\sim D_{test}}\Big{[}\Big{(}|(\hat{Y}_{cau}-Y)|_{1}\Big{)}\mid\textbf{X}%
\Big{]}
\displaystyle\leq
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|(\hat{Y}_{%
spu}-\hat{Y}_{cau})|_{1}\Big{)}\mid\textbf{X}\Big{]}+\mathbb{E}_{(\textbf{X},Y%
)\sim D_{test}}\Big{[}\Big{(}|(\hat{Y}_{cau}-Y)|_{1}\Big{)}\mid\textbf{X}\Big{]}
\displaystyle\leq\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|%
\textbf{X}\lambda(-\omega_{cau}\circ\gamma_{spu}+\omega_{spu})|_{1}\Big{)}\mid%
\textbf{X}\Big{]}+\epsilon_{c}
\displaystyle\leq
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|\textbf{X}%
\lambda(-\omega_{cau}\circ\gamma_{spu}+\omega_{spu})|_{1}\Big{)}\mid\textbf{X}%
\Big{]}+\epsilon_{c}
\displaystyle=\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|\textbf{X%
}\lambda(-\gamma_{spu}+\omega_{spu})|_{1}\Big{)}\mid\textbf{X}\Big{]}+\epsilon%
_{c}
\displaystyle=
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}|\textbf{X}%
\lambda(-\gamma_{spu}+\omega_{spu})|_{1}\Big{)}\mid\textbf{X}\Big{]}+\epsilon_%
{c}
\displaystyle\leq\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}X_{max}%
|\lambda|_{1}*|-\gamma_{spu}+\omega_{spu}|_{1}\Big{)}\mid\textbf{X}\Big{]}+%
\epsilon_{c}
\displaystyle\leq
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}X_{max}|%
\lambda|_{1}*|-\gamma_{spu}+\omega_{spu}|_{1}\Big{)}\mid\textbf{X}\Big{]}+%
\epsilon_{c}
\displaystyle\leq\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}X_{max}%
|\lambda|_{1}*(|\gamma_{spu}|_{1}+1)\Big{)}\mid\textbf{X}\Big{]}+\epsilon_{c}
\displaystyle\leq
\displaystyle\mathbb{E}_{(\textbf{X},Y)\sim D_{test}}\Big{[}\Big{(}X_{max}|%
\lambda|_{1}*(|\gamma_{spu}|_{1}+1)\Big{)}\mid\textbf{X}\Big{]}+\epsilon_{c}
\displaystyle=X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)+\epsilon_{c}
\displaystyle=
\displaystyle X_{max}|\lambda|_{1}(|\gamma_{spu}|_{1}+1)+\epsilon_{c}
n_{s}
n_{a}
\pi_{D}
M^{*}
M_{\theta}
M_{\theta}^{i}
i^{th}
spu_{i}
cau_{i}
\hat{S}_{t+1,i}=M^{i}_{\theta}((\textbf{S}_{t},\textbf{A}_{t})\circ\omega_{cau%
_{i}\cup spu_{i}})
V_{\pi}^{M_{\theta}}
\pi
M_{\theta}
V_{\pi}^{M^{*}}
\pi
\max_{S}D_{KL}(\pi(\cdot|S),\pi_{D}(\cdot|S))\leq\epsilon_{\pi}
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq\frac{2\sqrt{2}R_{max}}%
{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq
\displaystyle\frac{2\sqrt{2}R_{max}}{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+
\displaystyle\frac{R_{max}\gamma}{2(1-\gamma)^{2}}S_{max}[n_{s}\epsilon_{c}+(1%
+\gamma_{max})\lambda_{max}n_{s}(n_{s}+n_{a})R_{spu}]
\displaystyle\frac{R_{max}\gamma}{2(1-\gamma)^{2}}S_{max}[n_{s}\epsilon_{c}+
\displaystyle(1+\gamma_{max})\lambda_{max}n_{s}(n_{s}+n_{a})R_{spu}]
R_{spu}=\frac{\sum_{i=1}^{n_{s}}|spu_{i}|}{n_{s}(n_{s}+n_{a})}
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq|V_{\pi}^{M^{*}}-V_{\pi%
_{D}}^{M^{*}}|+|V_{\pi_{D}}^{M_{\theta}}-V_{\pi_{D}}^{M^{*}}|+|V_{\pi_{D}}^{M_%
{\theta}}-V_{\pi}^{M_{\theta}}|
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq
\displaystyle|V_{\pi}^{M^{*}}-V_{\pi_{D}}^{M^{*}}|+|V_{\pi_{D}}^{M_{\theta}}-V%
_{\pi_{D}}^{M^{*}}|+|V_{\pi_{D}}^{M_{\theta}}-V_{\pi}^{M_{\theta}}|
\displaystyle\leq\frac{2\sqrt{2}R_{max}}{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+%
|V_{\pi_{D}}^{M_{\theta}}-V_{\pi_{D}}^{M^{*}}|
\displaystyle\leq
\displaystyle\frac{2\sqrt{2}R_{max}}{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+|V_{%
\pi_{D}}^{M_{\theta}}-V_{\pi_{D}}^{M^{*}}|
\displaystyle|V_{\pi_{D}}^{M_{\theta}}-V_{\pi_{D}}^{M_{*}}|\leq\frac{R_{max}}{%
1-\gamma}\sum_{s}|d_{\pi_{D}}^{M_{\theta}}(s)-d_{\pi_{D}}^{M^{*}}(s)|\sum_{a}%
\pi_{D}(a|s)
\displaystyle|V_{\pi_{D}}^{M_{\theta}}-V_{\pi_{D}}^{M_{*}}|\leq\frac{R_{max}}{%
1-\gamma}\sum_{s}|d_{\pi_{D}}^{M_{\theta}}(s)-d_{\pi_{D}}^{M^{*}}(s)|\sum_{a}%
\pi_{D}(a|s)
\displaystyle|d_{\pi_{D}}^{M_{\theta}}(s)-d_{\pi_{D}}^{M^{*}}(s)|\leq\frac{%
\gamma}{(1-\gamma)}\sum_{s,a,s^{\prime}}|M_{\theta}(S_{t},A_{t})-M^{*}(S_{t},A%
_{t})|\pi_{D}(a|s)d_{\pi_{D}}^{M^{*}}(s)
\displaystyle|d_{\pi_{D}}^{M_{\theta}}(s)-d_{\pi_{D}}^{M^{*}}(s)|\leq
\displaystyle\frac{\gamma}{(1-\gamma)}\sum_{s,a,s^{\prime}}|M_{\theta}(S_{t},A%
_{t})-M^{*}(S_{t},A_{t})|\pi_{D}(a|s)d_{\pi_{D}}^{M^{*}}(s)
\displaystyle|M_{\theta}(S_{t},A_{t})-M^{*}(S_{t},A_{t})|=\sum_{i=1}^{n_{s}}|M%
_{\theta}^{i}(S_{t},A_{t})-M^{*,i}(S_{t},A_{t})|
\displaystyle|M_{\theta}(S_{t},A_{t})-M^{*}(S_{t},A_{t})|=
\displaystyle\sum_{i=1}^{n_{s}}|M_{\theta}^{i}(S_{t},A_{t})-M^{*,i}(S_{t},A_{t%
})|
\displaystyle\leq\sum_{i=1}^{n_{s}}S_{max}[\epsilon_{c}+(\gamma_{max}+1)%
\lambda_{max}|spu_{i}|]
\displaystyle\leq
\displaystyle\sum_{i=1}^{n_{s}}S_{max}[\epsilon_{c}+(\gamma_{max}+1)\lambda_{%
max}|spu_{i}|]
\displaystyle=S_{max}[{n_{s}}\epsilon_{c}+(\gamma_{max}+1)\lambda_{max}\sum_{i%
=1}^{n_{s}}|spu_{i}|]
\displaystyle=
\displaystyle S_{max}[{n_{s}}\epsilon_{c}+(\gamma_{max}+1)\lambda_{max}\sum_{i%
=1}^{n_{s}}|spu_{i}|]
\displaystyle=S_{max}[{n_{s}}\epsilon_{c}+(\gamma_{max}+1)\lambda_{max}n_{s}(n%
_{s}+n_{a})R_{spu}]
\displaystyle=
\displaystyle S_{max}[{n_{s}}\epsilon_{c}+(\gamma_{max}+1)\lambda_{max}n_{s}(n%
_{s}+n_{a})R_{spu}]
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq\frac{2\sqrt{2}R_{max}}%
{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+
\displaystyle|V_{\pi}^{M_{\theta}}-V_{\pi}^{M^{*}}|\leq
\displaystyle\frac{2\sqrt{2}R_{max}}{(1-\gamma)^{2}}\sqrt{\epsilon_{\pi}}+
\displaystyle\frac{R_{max}\gamma}{2(1-\gamma)^{2}}S_{max}[n_{s}\epsilon_{c}+(%
\gamma_{max}+1)\lambda_{max}n_{s}(n_{s}+n_{a})R_{spu}]
\displaystyle\frac{R_{max}\gamma}{2(1-\gamma)^{2}}S_{max}[n_{s}\epsilon_{c}+
\displaystyle(\gamma_{max}+1)\lambda_{max}n_{s}(n_{s}+n_{a})R_{spu}]
p^{*}
p^{*}
p
[0,1]
[0,p_{1}),[p_{1},p_{2}),\cdots,[p_{n},1]
p
\{p_{i}\}_{i=1}^{n}
p^{*}
\displaystyle p^{*}=\arg\max_{p_{i}}\frac{p_{i+1}}{i+1}-\frac{p_{i}}{i}.
\displaystyle p^{*}=\arg\max_{p_{i}}\frac{p_{i+1}}{i+1}-\frac{p_{i}}{i}.
p_{i}
p^{*}
p_{i}
\mathcal{M}_{Causal}(\cdot)
\mathcal{M}_{Causal}(\cdot)
\textbf{s}_{t}\in\mathbb{R}^{n_{s}}
\textbf{a}_{t}\in\mathbb{R}^{n_{a}}
G\in\{0,1\}^{(n_{s},n_{a})\times n_{s}}
\mathcal{M}_{i}(\cdot;\theta_{i})
\mathcal{M}(\cdot;\theta)
i=1,\cdots,n_{s}
i=1
n_{s}
G_{\cdot,i}
i^{th}
G
X=(\textbf{s}_{t},\textbf{a}_{t})\circ G_{\cdot,i}
\tilde{Y}=\mathcal{M}_{i}(X;\theta_{i})\in\mathbb{R}^{n_{s}}
Y_{i}
i^{th}
\tilde{Y}
Y=(Y_{i})_{i=1}^{n_{s}}
t
s_{t+1}
s_{t}
a_{t}
R_{spu}=0
