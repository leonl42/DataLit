S
S
E
G_{e}
G_{i}
G_{t}
G_{l}
G_{c}
D
G_{e}
G_{i}
G_{t}
G_{s}
G_{l}
G_{c}
D
{\footnotesize ⓒ}
E
G_{e}
G_{i}
G_{t}
G_{l}
G_{c}
D
G_{e}
G_{i}
G_{t}
G_{s}
G_{l}
G_{c}
D
{\footnotesize ⓒ}
S^{\prime\prime}
S
N
p_{e}
p_{d}
p_{e}{+}N{\times}p_{d}
p_{e}{+}p_{d}
G
D
G
E
F
G_{e}
I^{\prime}_{e}
G_{i}
I^{\prime}
G_{t}
G_{s}
I^{\prime\prime}
G_{l}
I^{\prime\prime}
G_{c}
D
E
F{=}E(S)
E
S{\in}\mathbb{R}^{N\times H\times W}
H
W
N
G_{e}
G_{i}
G_{e}
G_{t}
G_{i}
G_{e}
G_{i}
G_{t}
\oplus
\otimes
{\footnotesize$\sigma$⃝}
G_{e}
G_{t}
G_{i}
G_{e}
G_{i}
G_{t}
\oplus
\otimes
{\footnotesize$\sigma$⃝}
F{\in}\mathbb{R}^{C\times H\times W}
H
W
C
I^{\prime}
G_{e}
n
n
F_{e}{=}\{F_{e}^{j}\}_{j=1}^{n}
I^{\prime}_{e}{\in}\mathbb{R}^{3\times H\times W}
F
G_{i}
n
F_{i}{=}\{F_{i}^{j}\}_{j=1}^{n}
I^{\prime}_{i}{\in}\mathbb{R}^{3\times H\times W}
F_{e}
I^{\prime}_{e}
F_{i}
I^{\prime}
G_{t}
G_{t}
F_{e}{=}\{F_{e}^{j}\}_{j=1}^{n}
F_{i}{=}\{F_{i}^{j}\}_{j=1}^{n}
F_{a}{=}{\rm Sigmoid}(F_{e}){=}\{F_{a}^{j}\}_{j=1}^{n}
F_{i}^{j}{=}{\rm Sigmoid}(F_{e}^{j}){\times}F_{i}^{j}{+}F_{i}^{j}(j{=}1,\cdots%
,n)
I^{\prime}_{e}
\displaystyle I^{\prime}={\rm Sigmoid}(I^{\prime}_{e})\times I^{\prime}_{i}+I^%
{\prime}_{i},
\displaystyle I^{\prime}={\rm Sigmoid}(I^{\prime}_{e})\times I^{\prime}_{i}+I^%
{\prime}_{i},
I^{\prime}_{a}{=}{\rm Sigmoid}(I^{\prime}_{e})
G_{s}
\mathcal{F}
\oplus
\otimes
{\footnotesize$\sigma$⃝}
\mathcal{F}^{\prime}
G_{s}
\mathcal{F}
\oplus
\otimes
{\footnotesize$\sigma$⃝}
\mathcal{F}^{\prime}
G_{s}
\mathcal{F}
S
I^{\prime}_{e}
I^{\prime}
F
E
\mathcal{F}
\mathcal{F}_{c}
\mathcal{F}_{c}
\gamma^{\prime}
\gamma^{\prime}{=}{\rm Sigmoid}({\rm AvgPool}(\mathcal{F}_{c}))
\gamma^{\prime}
\mathcal{F}_{c}
\mathcal{F}_{c}
\mathcal{F}^{\prime}_{c}{=}\mathcal{F}_{c}{\times}\gamma^{\prime}{+}\mathcal{F%
}_{c}
\mathcal{F}^{\prime}_{c}{\in}\mathbb{R}^{N\times H\times W}
\mathcal{F}^{\prime}_{c}
\mathcal{F}^{\prime}{\in}\mathbb{R}^{(C+N+3+3)\times H\times W}
\mathcal{F}^{\prime}
\mathcal{F}
\mathcal{F}^{\prime}
\mathcal{F}^{\prime}
I^{\prime\prime}
I^{\prime\prime}
S^{\prime\prime}{\in}\mathbb{R}^{N\times H\times W}
N
H
W
S^{\prime\prime}
S
S{\in}\mathbb{R}^{N\times H\times W}
S
\hat{S}{\in}\mathbb{R}^{N{\times}M}
M{=}H{\texttimes}W
A{=}\hat{S}\hat{S}^{\top}{\in}\mathbb{R}^{M{\times}M}
A
A^{\prime\prime}
S^{\prime\prime}
\{a_{m}{\in}A,m{\in}[1,M^{2}]\}
\{a^{\prime\prime}_{m}{\in}A^{\prime\prime},m{\in}[1,M^{2}]\}
\displaystyle\mathcal{L}_{sim}(S,S^{\prime\prime})=-\frac{1}{M^{2}}\sum_{m=1}^%
{M^{2}}(a_{m}\log a^{\prime\prime}_{m}+(1-a_{m})\log(1-a^{\prime\prime}_{m})).
\displaystyle\mathcal{L}_{sim}(S,S^{\prime\prime})=-\frac{1}{M^{2}}\sum_{m=1}^%
{M^{2}}(a_{m}\log a^{\prime\prime}_{m}+(1-a_{m})\log(1-a^{\prime\prime}_{m})).
S
v{=}B(S)
B
v
S
\mathcal{L}_{S}=-\log\frac{\exp(v\cdot v_{+}/\tau)}{\exp(v\cdot v_{+}/\tau)+%
\sum_{v_{-}\in N_{S}}{\exp(v\cdot v_{-}/\tau)}},
v_{+}
S
N_{S}
\tau{>}0
L_{2}
i
c
c
C{\setminus}{c}
\mathcal{L}_{i}=\frac{1}{|P_{i}|}\sum_{i_{+}\in P_{i}}-\log\frac{\exp(i\cdot i%
_{+}/\tau)}{\exp(i\cdot i_{+}/\tau)+\sum_{i_{-}\in N_{i}}{\exp(i\cdot i_{-}/%
\tau)}}.
i
P_{i}
N_{i}
i
\hat{I}_{i}
L_{1}
\mathcal{L}_{L_{1}}{=}\sum_{i=1}^{N}\mathbb{E}_{I_{i},\hat{I}_{i}}[||I_{i}{-}%
\hat{I}_{i}||_{1}].
I_{g}
I_{g}{=}I_{g_{1}}\oplus I_{g_{2}}\oplus\cdots\oplus I_{g_{N}}.
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
E
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
E
G_{i}
E
G_{i}
G_{e}
E
G_{i}
G_{e}
G_{t}
E
G_{i}
G_{e}
G_{t}
G_{s}
E
G_{i}
G_{e}
G_{t}
G_{s}
G_{l}
E
G_{i}
G_{e}
G_{t}
G_{s}
G_{l}
G_{c}
E
G_{i}
G_{i}
G_{e}
G_{i}
G_{e}
G_{t}
G_{s}
G_{l}
S
I^{\prime}_{e}
I_{e}
\displaystyle\mathcal{L}_{\mathrm{CGAN}}(G_{e},D)=\mathbb{E}_{S,I_{e}}\left[%
\log D(S,I_{e})\right]+\mathbb{E}_{S,I_{e}^{{}^{\prime}}}\left[\log(1-D(S,I^{%
\prime}_{e}))\right],
\displaystyle\mathcal{L}_{\mathrm{CGAN}}(G_{e},D)
\displaystyle=\mathbb{E}_{S,I_{e}}\left[\log D(S,I_{e})\right]+\mathbb{E}_{S,I%
_{e}^{{}^{\prime}}}\left[\log(1-D(S,I^{\prime}_{e}))\right],
S
I^{\prime}
I^{\prime\prime}
I
\displaystyle\mathcal{L}_{\mathrm{CGAN}}(G_{i},G_{s},D)=(\lambda+1)\mathbb{E}_%
{S,I}\left[\log D(S,I)\right]+\mathbb{E}_{S,I^{\prime}}\left[\log(1-D(S,I^{%
\prime}))\right]
\displaystyle\mathcal{L}_{\mathrm{CGAN}}(G_{i},G_{s},D)
\displaystyle=(\lambda+1)\mathbb{E}_{S,I}\left[\log D(S,I)\right]+\mathbb{E}_{%
S,I^{\prime}}\left[\log(1-D(S,I^{\prime}))\right]
\displaystyle+\lambda\mathbb{E}_{S,I^{\prime\prime}}\left[\log(1-D(S,I^{\prime%
\prime}))\right],
\displaystyle+\lambda\mathbb{E}_{S,I^{\prime\prime}}\left[\log(1-D(S,I^{\prime%
\prime}))\right],
\lambda
I^{\prime}
I^{\prime\prime}
I^{\prime}
I^{\prime\prime}
I^{\prime\prime}
I^{\prime}
I^{\prime}
I^{\prime}
\mathcal{L}_{f}
\mathcal{L}_{p}
\displaystyle\min_{G}\max_{D}\mathcal{L}=\lambda_{c}\underbrace{(\mathcal{L}_{%
\mathrm{CGAN}}(G_{e},D){+}\mathcal{L}_{\mathrm{CGAN}}(G_{i},G_{s},D))}_{\text{%
Multi-Modality Adversarial Loss}}+\lambda_{s}\underbrace{\mathcal{L}_{sim}(S,S%
^{\prime})+\mathcal{L}_{sim}(S,S^{\prime\prime})}_{\text{Similarity Loss}}
\displaystyle\min_{G}\max_{D}\mathcal{L}
\displaystyle=\lambda_{c}\underbrace{(\mathcal{L}_{\mathrm{CGAN}}(G_{e},D){+}%
\mathcal{L}_{\mathrm{CGAN}}(G_{i},G_{s},D))}_{\text{Multi-Modality Adversarial%
 Loss}}+\lambda_{s}\underbrace{\mathcal{L}_{sim}(S,S^{\prime})+\mathcal{L}_{%
sim}(S,S^{\prime\prime})}_{\text{Similarity Loss}}
\displaystyle+\lambda_{l}\underbrace{\mathcal{L}_{i}+\mathcal{L}_{L_{1}}}_{%
\text{Contrastive Learning Loss}}+\lambda_{f}\underbrace{(\mathcal{L}_{f}(I_{e%
},I^{\prime}_{e})+\mathcal{L}_{f}(I,I^{\prime})+\lambda\mathcal{L}_{f}(I,I^{%
\prime\prime}))}_{\text{Discriminator Feature Matching Loss}}
\displaystyle+\lambda_{l}\underbrace{\mathcal{L}_{i}+\mathcal{L}_{L_{1}}}_{%
\text{Contrastive Learning Loss}}+\lambda_{f}\underbrace{(\mathcal{L}_{f}(I_{e%
},I^{\prime}_{e})+\mathcal{L}_{f}(I,I^{\prime})+\lambda\mathcal{L}_{f}(I,I^{%
\prime\prime}))}_{\text{Discriminator Feature Matching Loss}}
\displaystyle+\lambda_{p}\underbrace{(\mathcal{L}_{p}(I_{e},I^{\prime}_{e}){+}%
\mathcal{L}_{p}(I,I^{\prime}){+}\lambda\mathcal{L}_{p}(I,I^{\prime\prime}))}_{%
\text{Perceptual Loss}},
\displaystyle+\lambda_{p}\underbrace{(\mathcal{L}_{p}(I_{e},I^{\prime}_{e}){+}%
\mathcal{L}_{p}(I,I^{\prime}){+}\lambda\mathcal{L}_{p}(I,I^{\prime\prime}))}_{%
\text{Perceptual Loss}},
\lambda_{c}
\lambda_{s}
\lambda_{l}
\lambda_{f}
\lambda_{p}
\mathcal{L}
\mathcal{L}_{f}
\mathcal{L}_{p}
G_{i}
G_{e}
3{\times}3
n{=}3
G_{i}
G_{s}
G_{t}
F
C{=}64
G_{s}
G
D
\beta_{1}{=}0
\beta_{2}{=}0.999
\lambda_{c}
\lambda_{s}
\lambda_{l}
\lambda_{f}
\lambda_{p}
\lambda
I^{\prime}
I^{\prime\prime}
I^{\prime}
I^{\prime\prime}
\uparrow
\uparrow
G_{e}
E
G_{i}
G_{e}
G_{t}
G_{t}
G_{e}
G_{i}
G_{s}
G_{s}
G_{s}
G_{s}
\mathcal{F}^{\prime}
G_{l}
