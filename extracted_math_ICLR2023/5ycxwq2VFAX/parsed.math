y^{c}
c
h_{l}
c
K
h_{l}
\displaystyle\alpha^{c}_{l}=\left[\dots,\frac{\partial y^{c}}{\partial h^{k}_{%
l}}h^{k}_{l},\dots\right]\,\,\quad\forall k=1,\dots,K
\displaystyle\alpha^{c}_{l}=\left[\dots,\frac{\partial y^{c}}{\partial h^{k}_{%
l}}h^{k}_{l},\dots\right]\,\,\quad\forall k=1,\dots,K
\displaystyle s^{c}_{l}=g(\alpha^{c}_{l})=ReLU(\sum_{k=1}^{K}\alpha^{c,k}_{l})
\displaystyle s^{c}_{l}=g(\alpha^{c}_{l})=ReLU(\sum_{k=1}^{K}\alpha^{c,k}_{l})
h^{k}_{l}
K
l
\alpha^{c}_{l}
n\times K
h_{l}
s^{c}_{l}
n
s^{c}_{l}
g(\cdot)
0
h_{0}
s^{c}_{l}
l=0
l>0
f
\mathcal{L}(\cdot)
t
\displaystyle\arg\min_{f}{\mathcal{L}(t,f(h_{l}))}
\displaystyle\arg\min_{f}{\mathcal{L}(t,f(h_{l}))}
f
l
t
n\times V
\mathcal{T}
V
V
\mathcal{L}(\cdot)
t
l=L
f^{base}(\cdot)
f^{lm}(\cdot)
\mathcal{L}(t^{i},f^{lm}(h^{i}_{L}))
h^{i}_{L}=f^{base}(t^{i})
i
t^{i}
i
f^{lm}(\cdot)
i
n\times K
n\times V
\displaystyle f^{lm}(h^{i}_{L})=\sum_{j=1}^{V}\hat{P}_{L}^{ij}{\boldsymbol{e}}%
^{(j)}
\displaystyle f^{lm}(h^{i}_{L})=\sum_{j=1}^{V}\hat{P}_{L}^{ij}{\boldsymbol{e}}%
^{(j)}
{\boldsymbol{e}}^{(j)}
1\times V
j
j
\mathcal{T}
\hat{P}_{L}
n\times V
i
j
{\boldsymbol{e}}^{(j)}
j
\hat{P}_{L}^{ij}
j
i
h_{L}
h_{L}
f^{lm}(\cdot)
l
\displaystyle X^{\prime}=AXW_{V}
\displaystyle X^{\prime}=AXW_{V}
A=softmax(\frac{XW_{Q}W_{K}^{T}X^{T}}{\sqrt{d}})
W_{Q},W_{K},W_{V}
d
A
X
X^{\prime}
K
\mathbb{R}^{K}
\mathcal{T}
f^{lm}(\cdot)
\mathbb{R}^{K}
\mathcal{T}
K<<V
f^{lm}(\cdot)
{\boldsymbol{e}}^{(j)}
\mathcal{T}
f^{lm}(h_{l})
\hat{P}_{l}
t^{1}
t^{2}
\mathcal{T}
K
h^{1}_{0}
h^{2}_{0}
l
h^{1}_{l}
h^{2}_{l}
\mathcal{T}
f^{lm}(\cdot)
\hat{t}^{1}_{l}
\hat{t}^{2}_{l}
\mathcal{T}
t^{1}
t^{2}
t^{1}
t^{2}
\mathcal{T}
K
h^{1}_{0}
h^{2}_{0}
l
h^{1}_{l}
h^{2}_{l}
\mathcal{T}
f^{lm}(\cdot)
\hat{t}^{1}_{l}
\hat{t}^{2}_{l}
\mathcal{T}
t^{1}
t^{2}
\hat{P}_{l}
h_{l}
\hat{P}_{l}
h_{l}
V
\hat{P}_{l}
T
\hat{D}_{l}
T\times n
\hat{D}_{l}
\hat{P}_{l}
\hat{D}_{l}
h_{l}
\displaystyle s^{c}_{l}=ReLU(\sum_{k=1}^{K}\hat{D}_{l}\alpha^{c,k}_{l})
\displaystyle s^{c}_{l}=ReLU(\sum_{k=1}^{K}\hat{D}_{l}\alpha^{c,k}_{l})
s^{c}_{l}
l
\hat{D}_{l}
g(\cdot)
s^{c}_{l}
l
l
\hat{s}^{i}_{l}
t_{i}
t
l
\tau
g(\cdot)
f^{lm}(\cdot)
m(\cdot)
m_{l}^{base}(\cdot)
l
m^{class}(\cdot)
l
\hat{\alpha}_{l}
\hat{y}
l
h_{l}
\hat{D}_{l}
\hat{P}_{l}
h_{l}
t
\hat{s}_{l}
\hat{\alpha}_{l}
\tau
\hat{D}_{l}
g(\cdot)
g(\cdot)=ReLU(\sum_{k=1}^{K}\cdot)
t,l,\tau,g(\cdot),f^{mlm}(\cdot),m(\cdot)
h_{l}=m_{l}^{base}(t)
\hat{y}=\max{m^{class}(m^{base}(t))}
\hat{\alpha}_{l}=\frac{\partial\hat{y}}{\partial h^{k}_{l}}h^{k}_{l}
l
\hat{P}_{l}=f^{lm}(h_{l})
\hat{D}^{i}_{l}=(\hat{P}^{j}_{l})^{\top}\,\quad\forall j
t^{i}
i=1
T
j=1
n
\hat{D}^{ij}_{l}
\tau
\hat{D}^{j}_{l}
\hat{s}^{j}_{l}\mathrel{+}=g(\hat{D}^{ij}_{l}\hat{\alpha}^{j}_{l})
\hat{s}_{l}
m(\cdot)
m_{l}^{base}
h_{l}
\mathbf{R}^{K}
f^{lm}(\cdot)
\mathbf{R}^{K}
\mathcal{T}
h_{l}
\approx
\approx
\uparrow
\downarrow
\uparrow
\downarrow
l_{0}
l_{5}
l_{6}
l_{7}
l_{8}
l_{0}
l_{6}
l_{8}
l_{9}
k
k
k
k
\ell_{1}
k
\binom{C}{2}*k
C
\uparrow
\downarrow
\uparrow
\downarrow
l_{5}
l_{6}
l_{7}
l_{0}
l_{5}
l_{6}
l_{7}
l_{7}
l_{5}
l_{6}
l_{7}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
l_{7}
k
k
l_{7}
l_{7}
l_{7}
l_{7}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
l_{6}
