X
G
\{1,\ldots,D\}
\mathbf{x}=(x_{1},\ldots,x_{D})
x_{i}=f_{i}(\mathbf{x}_{\text{pa}(i;G)},\epsilon_{i})
\epsilon_{i}
\text{pa}(i;G)
i
G
f_{i}
x_{i}
\epsilon_{i}
x_{i}=f_{i}(\mathbf{x}_{\text{pa}(i;G)},\epsilon_{i})=f_{i}(\mathbf{x}_{\text{%
pa}(i;G)})+\epsilon_{i},\quad\text{or}\quad\mathbf{x}=f_{G}(\mathbf{x})+%
\boldsymbol{\mathbf{\epsilon}}\quad\text{in vector form.}
p_{\theta}(\mathbf{x}^{n}|G)
\theta
\{f_{i}\}
G
\rightarrow
\leftrightarrow
x_{i}\rightarrow x_{j}
x_{i}
x_{j}
x_{i}\leftrightarrow x_{j}
x_{i}
x_{j}
G
D
\mathbf{x}=(x_{1},\ldots,x_{D})
G_{D}\in\mathbb{R}^{D\times D}
(i,j)
x_{i}\rightarrow x_{j}
G_{B}\in\mathbb{R}^{D\times D}
(i,j)
x_{i}\leftrightarrow x_{j}
G
G=\{G_{D},G_{B}\}
G_{D}
G_{B}
x_{i}\leftrightarrow x_{j}
G_{B}
u_{m}
x_{i}\leftrightarrow x_{j}
x_{i}
\mathbf{x}
x_{i}=f_{i}(\mathbf{x}_{\text{pa}(i;G_{D})},\mathbf{u}_{\text{pa}(i;G_{B})})+%
\epsilon_{i}
\mathbf{u}_{\text{pa}(i;G_{B})}
x_{i}
\mathbf{u}=(u_{1},\ldots,u_{M})
[\mathbf{x},\mathbf{u}]=f_{G}(\mathbf{x},\mathbf{u})+\boldsymbol{\mathbf{%
\epsilon}}.
\mathbf{x}
p_{\theta}(\mathbf{x}^{n};G)
x_{1}\leftrightarrow x_{2}
x_{2}\leftrightarrow x_{3}
x_{3}\leftrightarrow x_{1}
\{x_{1}\leftarrow u_{1}\rightarrow x_{2},x_{2}\leftarrow u_{2}\rightarrow x_{3%
},x_{3}\leftarrow u_{3}\rightarrow x_{1}\}
\{u_{1}\rightarrow x_{1},u_{1}\rightarrow x_{2},u_{1}\rightarrow x_{3}\}
G
\mathbf{x}^{1},\ldots,\mathbf{x}^{N}
p_{\theta}(\mathbf{x}^{1},\ldots,\mathbf{x}^{N},G)=p(G)\prod_{n=1}^{N}p_{%
\theta}(\mathbf{x}^{n}|G)
\theta
p_{\theta}(G|\mathbf{x}^{1},\ldots,\mathbf{x}^{N})
q_{\phi}(G)
\mathrm{KL}\left[{q_{\phi}(G)}||{p_{\theta}(G|\mathbf{x}^{1},\ldots,\mathbf{x}%
^{N})}\right]
\mathcal{L}_{\textrm{ELBO}}=\sum_{n=1}^{N}\mathbb{E}_{q_{\phi}(G)}\left[\log p%
_{\theta}(\mathbf{x}^{n}|G)\right]-\mathrm{KL}\left[{q_{\phi}(G)}||{p(G)}%
\right].
p_{\theta}(\mathbf{x}^{1},\ldots,\mathbf{x}^{N})
\theta
p_{\theta}(\mathbf{x};G)
G=\{G_{D},G_{B}\}
p_{\theta}(\mathbf{x};G)
p_{\theta^{\prime}}(\mathbf{x};G^{\prime})
G\neq G^{\prime}
p_{\theta}(\mathbf{x};G)=p_{\theta^{\prime}}(\mathbf{x};G^{\prime})
p_{\theta^{0}}(\mathbf{x};G^{0})
p_{\theta}(\mathbf{x};G)=p_{\theta^{0}}(\mathbf{x};G^{0})
G=G^{0}
\mathbf{x}=(x_{1},\ldots,x_{D})
\mathbf{u}=(u_{1},\ldots,u_{M})
[\mathbf{x},\mathbf{u}]^{\top}=f_{G_{D},\mathbf{x}}(\mathbf{x};\theta)+f_{G_{B%
},\mathbf{u}}(\mathbf{u};\theta)+\boldsymbol{\mathbf{\epsilon}}
\boldsymbol{\mathbf{\epsilon}}
\theta
f_{G_{D},\mathbf{x}}
f_{G_{B},\mathbf{u}}
x_{i}=\sum_{m}f_{im}(x_{m}\in\mathbf{x}_{\text{pa}(i;G_{D})})+\sum_{k}g_{ik}(u%
_{k}\in\mathbf{u}_{\text{pa}(i;G_{B})})+\epsilon_{i}
u_{k}
x_{i}
x_{j}
u_{k}
x_{i}\leftarrow u_{k}\rightarrow x_{j}
G_{D}
G_{B}
g_{i}
g_{j}
{[G_{B}]}_{i,j}=1
{[G_{D}]}_{i,j}=0
\forall g_{i},g_{j},\ [(x_{i}-g_{i}(\mathbf{x}_{-i})\cancel{\rotatebox[origin=%
{c}]{90.0}{$\models$}}(x_{j}-g_{j}(\mathbf{x}_{-j})].
{[G_{B}]}_{i,j}=0
{[G_{D}]}_{i,j}=0
\exists g_{i},g_{j},\ [(x_{i}-g_{i}(\mathbf{x}_{-(i,j)})\rotatebox[origin={c}]%
{90.0}{$\models$}(x_{j}-g_{j}(\mathbf{x}_{-(i,j)}))].
{[G_{B}]}_{i,j}=0
{[G_{D}]}_{i,j}=1
\forall g_{i},g_{j},\ [(x_{i}-g_{i}(\mathbf{x}_{-(i,j)})\cancel{\rotatebox[ori%
gin={c}]{90.0}{$\models$}}(x_{j}-g_{j}(\mathbf{x}_{-j})]
\exists g_{i},g_{j},\ [(x_{i}-g_{i}(\mathbf{x}_{-i})\rotatebox[origin={c}]{90.%
0}{$\models$}(x_{j}-g_{j}(\mathbf{x}_{-(i,j)}))]
p_{\theta}(\mathbf{x};G)
p_{\theta^{\prime}}(\mathbf{x};G^{\prime})
G\neq G^{\prime}
p_{\theta}(\mathbf{x};G)=p_{\theta^{\prime}}(\mathbf{x};G^{\prime})
G_{D}
G_{B}
\mathbf{u}
[\mathbf{x},\mathbf{u}]^{\top}=f_{G_{D},\mathbf{x}}(\mathbf{x};\theta)+f_{G_{B%
},\mathbf{u}}(\mathbf{u};\theta)+\boldsymbol{\mathbf{\epsilon}}.
p_{\theta}(\mathbf{x}^{n},\mathbf{u}^{n}|G)
\boldsymbol{\mathbf{\epsilon}}=\mathbf{v}-f_{G_{D},\mathbf{x}}(\mathbf{x};%
\theta)-f_{G_{B},\mathbf{u}}(\mathbf{u};\theta):=g_{\tilde{G}}(\mathbf{v};%
\theta)=\mathbf{v}-f_{\tilde{G}}(\mathbf{v};\theta)
\mathbf{v}=(\mathbf{x},\mathbf{u})\in\mathbb{R}^{D+M}
\tilde{G}
\mathbf{v}
\tilde{G}_{i,j}\in\{0,1\}
v_{i}\rightarrow v_{j}
p_{\theta}(\mathbf{v}^{n}|G)=p_{\boldsymbol{\mathbf{\epsilon}}}(g_{\tilde{G}}(%
\mathbf{v}^{n};\theta))=\prod_{i=1}^{D+M}p_{\epsilon_{i}}(g_{\tilde{G}}(%
\mathbf{v}^{n};\theta)_{i}).
\tilde{G}
f_{i}
f_{i}(\mathbf{v})=\xi_{1,i}\left(\sum_{v_{j}\in\mathbf{x}}^{D}\tilde{G}_{j,i}%
\ell_{j}(v_{j})\right)+\xi_{2,i}\left(\sum_{v_{j}\in\mathbf{u}}^{M}\tilde{G}_{%
j,i}\ell_{j}(v_{j})\right)
\xi_{1,i}
\xi_{2,i}
\ell_{i}
i=1,...,D+M
3(D+M)
\xi_{1,i}(\cdot)=\xi_{1,i}(\mathbf{e}_{i},\cdot)
\xi_{2,i}(\cdot)=\xi_{2,i}(\mathbf{e}_{i},\cdot)
\ell_{i}(\cdot)=\ell(\mathbf{e}_{i},\cdot)
\mathbf{e}_{i}\in\mathbb{R}^{D+M}
p_{\theta}(\mathbf{x}|G)
\mathbf{x}^{1},\ldots,\mathbf{x}^{N}
\mathbf{u}^{1},\ldots,\mathbf{u}^{N}
G
\mathbf{x}^{1},\ldots,\mathbf{x}^{N}
\mathbf{u}^{1},\ldots,\mathbf{u}^{N}
p_{\theta}(\mathbf{x}^{1},\mathbf{u}^{1},\ldots,\mathbf{x}^{N},\mathbf{u}^{N},%
G)=p(G)\prod_{n=1}^{N}p_{\theta}(\mathbf{x}^{n},\mathbf{u}^{n}|G)
p_{\theta}(\mathbf{x}^{n},\mathbf{u}^{n}|G)
\theta
p(G)
\theta
q_{\phi}(\mathbf{u}^{1},\ldots,\mathbf{u}^{N},G)\approx p_{\theta}(\mathbf{u}^%
{1},\ldots,\mathbf{u}^{N},G|\mathbf{x}^{1},\ldots,\mathbf{x}^{N})
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)\leq\sum_{n}\log p_{\theta}(\mathbf{x}%
^{n})
\displaystyle\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)=\mathbb{E}_{q_{\phi}(G)}%
\left[\sum_{n=1}^{N}\mathbb{E}_{q_{\phi}(\mathbf{u}^{n}|G)}\left[\log p_{%
\theta}(\mathbf{x}^{n}|\mathbf{u}^{n},G)\right]\right]-\mathrm{KL}\left[{q_{%
\phi}(G)}||{p(G)}\right]
\displaystyle\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
\displaystyle=\mathbb{E}_{q_{\phi}(G)}\left[\sum_{n=1}^{N}\mathbb{E}_{q_{\phi}%
(\mathbf{u}^{n}|G)}\left[\log p_{\theta}(\mathbf{x}^{n}|\mathbf{u}^{n},G)%
\right]\right]-\mathrm{KL}\left[{q_{\phi}(G)}||{p(G)}\right]
\displaystyle\ -\mathbb{E}_{q_{\phi}(G)}\left[\sum_{n=1}^{N}\mathrm{KL}\left[{%
q_{\phi}(\mathbf{u}^{n}|\mathbf{x}^{n},G))}||{p_{\theta}(\mathbf{u}^{n}|G)}%
\right]\right].
\displaystyle\ -\mathbb{E}_{q_{\phi}(G)}\left[\sum_{n=1}^{N}\mathrm{KL}\left[{%
q_{\phi}(\mathbf{u}^{n}|\mathbf{x}^{n},G))}||{p_{\theta}(\mathbf{u}^{n}|G)}%
\right]\right].
p(G)
q_{\phi}(\mathbf{u}^{1},\ldots,\mathbf{u}^{N},G)=\prod_{n}q_{\phi}(\mathbf{u}^%
{n}|\mathbf{x}^{n},G)q_{\phi}(G)
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
G
G_{D}
G_{B}
h(G_{D},G_{B})=\operatorname{trace}\left(e^{G_{D}}\right)-D+\operatorname{sum}%
\left(G_{D}\circ G_{B}\right)
(G_{D},G_{B})
p(G)\propto\exp\left(-\lambda_{s1}\|G_{D}\|^{2}_{F}-\lambda_{s2}\|G_{B}\|^{2}_%
{F}-\rho h(G_{D},G_{B})^{2}-\alpha h(G_{D},G_{B})\right)
\alpha
\rho
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
\|G_{D}\|^{2}_{F}
\|G_{B}\|^{2}_{F}
\lambda_{s1}
\lambda_{s2}
p_{\theta}(\mathbf{u}^{1},\ldots,\mathbf{u}^{N},G|\mathbf{x}^{1},\ldots,%
\mathbf{x}^{N})
q_{\phi}(\mathbf{u}^{1},\ldots,\mathbf{u}^{N},G)
q_{\phi}(\mathbf{u}^{1},\ldots,\mathbf{u}^{N},G)=q_{\phi}(G)\prod_{n=1}^{N}q_{%
\phi}(\mathbf{u}^{n}|\mathbf{x}^{n}).
q_{\phi}(G)
G_{D}
G_{B}
G_{D}
q_{\phi}(\mathbf{u}^{n}|\mathbf{x}^{n})
q_{\phi}(\mathbf{u}^{n}|\mathbf{x}^{n})
\mathbf{x}^{n}
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
G^{0}
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
p_{\theta}(\mathbf{x};G)
\exists\theta^{*}
p_{\theta^{*}}(\mathbf{x};G^{0})
\theta
G
\mathbb{E}_{p(\mathbf{x};G^{0})}\left[|\log p_{\theta}(\mathbf{x};G)|\right]<\infty
q_{\phi}(\mathbf{u}|\mathbf{x},G)
p_{\theta}(\mathbf{u}|\mathbf{x},G)
(\theta^{\prime},q^{\prime}_{\phi}({G}))
\mathcal{L}_{\textrm{ELBO}}(\theta,\phi)
q^{\prime}_{\phi}({G})=\delta({G}={G}^{0})
q(G)
(x_{2},x_{3})
(x_{3},x_{4})
(x_{4},x_{5})
G_{D}
G_{B}
x_{4}
x_{2}
x_{3}
x_{5}
x_{3}
x_{2}
x_{4}
x_{5}
x_{1}
x_{3}
x_{2}
x_{4}
x_{5}
x_{1}
x_{3}
x_{2}
x_{4}
x_{5}
x_{1}
x_{3}
x_{2}
x_{4}
x_{5}
x_{1}
x_{3}
x_{2}
x_{4}
x_{5}
x_{1}
x_{3}
x_{2}
x_{4}
x_{5}
x_{1}
\pm
\pm
g_{i},g_{j}
\mathbf{x}
M
N
(x_{i}-g_{i}(M))
(x_{i}-g_{j}(M))
\epsilon_{k}
(x_{i}-g_{i}(M))
(x_{i}-g_{j}(M))
g_{i}
s(x_{i})
x_{i}
s(x_{i})
\mathbf{x}_{-i}
\epsilon_{i}
\forall g_{i},\ [s(x_{i})-g_{i}(\mathbf{x}_{-i})\cancel{\rotatebox[origin={c}]%
{90.0}{$\models$}}\epsilon_{i}].
[s(x_{i})-g_{i}(\mathbf{x}_{-i})\rotatebox[origin={c}]{90.0}{$\models$}%
\epsilon_{i}]
\mathbf{x}_{-i}
x_{i}
\epsilon_{i}
\epsilon_{i}
s(x_{i})
g_{i}(\mathbf{x}_{-i})
u_{i}(\boldsymbol{\mathbf{\epsilon}})
g_{i}
u_{i}
a_{i}(\boldsymbol{\mathbf{\epsilon}}_{-i})+b_{i}(\epsilon_{i})
\mathbf{x}_{-i}
x_{i}
\boldsymbol{\mathbf{\epsilon}}_{-i}
\epsilon_{k}
x_{i}\rotatebox[origin={c}]{90.0}{$\models$}\epsilon_{k}
x_{i}
\epsilon_{i}
s(x_{i})-g_{i}(\mathbf{x}_{-i})
[s(x_{i})-g_{i}(\mathbf{x}_{-i})\rotatebox[origin={c}]{90.0}{$\models$}%
\epsilon_{i}]
g_{i}
g_{j}
g_{i}(\mathbf{x}_{-i})=f_{i,\mathbf{x}}(\textbf{pa}_{\mathbf{x}}(i))+g^{\prime%
}_{i}(\mathbf{x}_{-i})
g_{j}(\mathbf{x}_{-j})=f_{j,\mathbf{x}}(\textbf{pa}_{\mathbf{x}}(j))+g^{\prime%
}_{i}(\mathbf{x}_{-j})
\forall g^{\prime}_{i},g^{\prime}_{j},\ [(f_{i,\mathbf{u}}(\textbf{pa}_{%
\mathbf{u}}(i))+\epsilon_{i}-g^{\prime}_{i}(\mathbf{x}_{-i})\cancel{\rotatebox%
[origin={c}]{90.0}{$\models$}}(f_{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j))+%
\epsilon_{j}-g^{\prime}_{j}(\mathbf{x}_{-j})].
(f_{i,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(i))+\epsilon_{i})\cancel{\rotatebox%
[origin={c}]{90.0}{$\models$}}(f_{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j))+%
\epsilon_{j}).
\epsilon_{i}\rotatebox[origin={c}]{90.0}{$\models$}\epsilon_{j}
(f_{i,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(i))\cancel{\rotatebox[origin={c}]{9%
0.0}{$\models$}}\epsilon_{j})\lor(n_{i}\cancel{\rotatebox[origin={c}]{90.0}{$%
\models$}}f_{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j)))\lor(f_{i,\mathbf{u}}(%
\textbf{pa}_{\mathbf{u}}(i))\cancel{\rotatebox[origin={c}]{90.0}{$\models$}}f_%
{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j))).
x_{j}
x_{i}
x_{i}
x_{j}
x_{i}
x_{j}
x_{i}
x_{j}
x_{j}
x_{i}
g_{i}
g_{j}
x_{i}
\epsilon_{j}
g_{i}(\mathbf{x}_{-(i,j)})
(x_{i}-g_{i}(\mathbf{x}_{-(i,j)}))\cancel{\rotatebox[origin={c}]{90.0}{$%
\models$}}\epsilon_{j}
(x_{j}-g_{j}(\mathbf{x}_{-(i,j)}))\cancel{\rotatebox[origin={c}]{90.0}{$%
\models$}}\epsilon_{i}
[(x_{i}-g_{i}(\mathbf{x}_{-(i,j)})\cancel{\rotatebox[origin={c}]{90.0}{$%
\models$}}(x_{j}-g_{j}(\mathbf{x}_{-(i,j)}))]
x_{i}
x_{j}
x_{i}
x_{j}
x_{i}
x_{j}
x_{i}
x_{j}
x_{j}
x_{i}
g_{1}(\mathbf{x}_{-i})=f_{i,\mathbf{x}}(\textbf{pa}_{\mathbf{x}}(i))
g_{2}(\mathbf{x}_{-(i,j)})=f_{j,\mathbf{x}}(\textbf{pa}_{\mathbf{x}}(j))
x_{i}-g_{i}(\mathbf{x}_{-i})=f_{i,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(i))+%
\epsilon_{i}
x_{j}-g_{j}(\mathbf{x}_{-(i,j)})=f_{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j))%
+\epsilon_{j}
f_{i,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(i))\rotatebox[origin={c}]{90.0}{$%
\models$}f_{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j))
(f_{i,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(i))+\epsilon_{i})\rotatebox[origin=%
{c}]{90.0}{$\models$}(f_{j,\mathbf{u}}(\textbf{pa}_{\mathbf{u}}(j))+\epsilon_{%
j})
x_{i}
x_{j}
\forall g_{i},\ [(x_{i}-g_{i}(\mathbf{x}_{-i})\cancel{\rotatebox[origin={c}]{9%
0.0}{$\models$}}\epsilon_{i}].
x_{j}
x_{i}
\forall g_{j},\ [(x_{j}-g_{j}(\mathbf{x}_{-(i,j)})\cancel{\rotatebox[origin={c%
}]{90.0}{$\models$}}\epsilon_{i}].
\forall g_{i},g_{j},\ [(x_{i}-g_{i}(\mathbf{x}_{-i})\cancel{\rotatebox[origin=%
{c}]{90.0}{$\models$}}(x_{j}-g_{j}(\mathbf{x}_{-i,j})]
x_{j}
x_{i}
q_{\phi}(G)
\mathcal{G}_{\phi}
G\in\mathcal{G}_{\phi}
w_{\phi}(G)
p(G)
\lambda_{1},\lambda_{2},\rho,\alpha
\lim_{N\rightarrow\infty}\frac{1}{N}\mathrm{KL}[q_{\phi}(G)\|p(G)]=0.
\mathcal{L}_{\textrm{ELBO}}
\displaystyle\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{q_{%
\phi}(G)q(\mathbf{u}_{n}|G)}\left[\log p_{\theta}(\mathbf{x}_{n},\mathbf{u}_{n%
}|G)\right]-\frac{1}{N}\sum_{n=1}^{N}H[q(\mathbf{u}_{n}|\mathbf{x}_{n},G)]-%
\underbrace{\frac{1}{N}\mathrm{KL}\left[{q(G)}||{p(G)}\right]}_{\rightarrow 0}
\displaystyle\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{q_{%
\phi}(G)q(\mathbf{u}_{n}|G)}\left[\log p_{\theta}(\mathbf{x}_{n},\mathbf{u}_{n%
}|G)\right]-\frac{1}{N}\sum_{n=1}^{N}H[q(\mathbf{u}_{n}|\mathbf{x}_{n},G)]-%
\underbrace{\frac{1}{N}\mathrm{KL}\left[{q(G)}||{p(G)}\right]}_{\rightarrow 0}
\displaystyle=\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}\sum_{G\in%
\mathcal{G}_{\phi}}w_{\phi}(G)\mathbb{E}_{q(\mathbf{u}|\mathbf{x},G)}\left[%
\log p_{\theta}(\mathbf{x}_{n}|\mathbf{u}_{n},G)\right]-\frac{1}{N}\sum_{n=1}^%
{N}\mathbb{E}_{q(G)}\left[\mathrm{KL}\left[{q(\mathbf{u}_{n}|\mathbf{x}_{n}G)}%
||{p(\mathbf{u}_{n}|\mathbf{x}_{n},G)}\right]\right].
\displaystyle=\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}\sum_{G\in%
\mathcal{G}_{\phi}}w_{\phi}(G)\mathbb{E}_{q(\mathbf{u}|\mathbf{x},G)}\left[%
\log p_{\theta}(\mathbf{x}_{n}|\mathbf{u}_{n},G)\right]-\frac{1}{N}\sum_{n=1}^%
{N}\mathbb{E}_{q(G)}\left[\mathrm{KL}\left[{q(\mathbf{u}_{n}|\mathbf{x}_{n}G)}%
||{p(\mathbf{u}_{n}|\mathbf{x}_{n},G)}\right]\right].
\theta
q^{*}(\mathbf{u}_{n}|\mathbf{x}_{n},G)
q^{*}(\mathbf{u}_{n}|\mathbf{x}_{n},G)=p_{\theta}(\mathbf{u}_{n}|\mathbf{x}_{n%
},G)
\displaystyle\lim_{N\rightarrow\infty}\mathcal{L}_{\textrm{ELBO}}(\theta,\phi,%
q^{*}(\mathbf{u}_{n}|\mathbf{x}_{n},G))
\displaystyle\lim_{N\rightarrow\infty}\mathcal{L}_{\textrm{ELBO}}(\theta,\phi,%
q^{*}(\mathbf{u}_{n}|\mathbf{x}_{n},G))
\displaystyle=\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}\sum_{G\in%
\mathcal{G}_{\phi}}w_{\phi}(G){\log p_{\theta}(\mathbf{x}_{n}|G)}
\displaystyle=
\displaystyle\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}\sum_{G\in%
\mathcal{G}_{\phi}}w_{\phi}(G){\log p_{\theta}(\mathbf{x}_{n}|G)}
\displaystyle=\int p(\mathbf{x};G^{0})\sum_{G\in\mathcal{G}_{\phi}}w_{\phi}(G)%
\log p_{\theta}(\mathbf{x}|G)d\mathbf{x}
\displaystyle=
\displaystyle\int p(\mathbf{x};G^{0})\sum_{G\in\mathcal{G}_{\phi}}w_{\phi}(G)%
\log p_{\theta}(\mathbf{x}|G)d\mathbf{x}
p(\mathbf{x};G^{0})
G^{0}
(\theta^{*},G^{*})=\arg\max\int p(\mathbf{x};G^{0})\log p_{\theta}(\mathbf{x}|%
G)d\mathbf{x}
\sum_{G\in\mathcal{G}_{\phi}}w_{\phi}(G)=1
w_{\phi}(G)>0
\displaystyle\sum_{G\in\mathcal{G}_{\phi}}w_{\phi}(G)\mathbb{E}_{p(\mathbf{x};%
G^{0})}\left[\log p_{\theta}(\mathbf{x}|G)\right]\leq\mathbb{E}_{p(\mathbf{x};%
G^{0})}\left[\log p_{\theta^{*}}(\mathbf{x};G^{*})\right]
\displaystyle\sum_{G\in\mathcal{G}_{\phi}}w_{\phi}(G)\mathbb{E}_{p(\mathbf{x};%
G^{0})}\left[\log p_{\theta}(\mathbf{x}|G)\right]\leq\mathbb{E}_{p(\mathbf{x};%
G^{0})}\left[\log p_{\theta^{*}}(\mathbf{x};G^{*})\right]
\sum_{G\in\mathcal{G}_{\phi}}w_{\phi}(G)\mathbb{E}_{p(\mathbf{x};G^{0})}\left[%
\log p_{\theta}(\mathbf{x}|G)\right]
G\in\mathcal{G}_{\phi}
\theta_{G}
\mathbb{E}_{p(\mathbf{x};G^{0})}\left[\log p_{\theta_{G}}(\mathbf{x}|G)\right]%
=\mathbb{E}_{p(\mathbf{x};G^{0})}\left[\log p_{\theta^{*}}(\mathbf{x}|G^{*})%
\right].
(\theta^{*},G^{*})
\mathbb{E}_{p(\mathbf{x};G^{0})}\left[\log p_{\theta^{*}}(\mathbf{x}|G^{*})%
\right]=\mathbb{E}_{p(\mathbf{x};G^{0})}\left[\log p(\mathbf{x};G^{0})\right]
G^{\prime}\in\mathcal{G}_{\phi}
G^{\prime}=G^{0}
\mathcal{G}_{\phi}=\{G^{\prime}=G^{0}\}
q^{\prime}_{\phi}({G})=\delta({G}={G}^{\prime})
{G}^{\prime}={G}^{0}
\mathbb{E}_{q_{\phi}(G)}\left[\text{ATE}(\mathbf{a},\mathbf{b}|G)\right]
q_{\phi}(G)
\mathbb{E}_{q_{\phi}(G)}\left[\text{ATE}(\mathbf{a},\mathbf{b}|G)\right]=%
\mathbb{E}_{q_{\phi}(G)}\left[\mathbb{E}_{p(\mathbf{x}_{Y}|\text{do}(\mathbf{x%
}_{T}=\mathbf{b}),G)}\left[\mathbf{x}_{Y}\right]-\mathbb{E}_{p(\mathbf{x}_{Y}|%
\text{do}(\mathbf{x}_{T}=\mathbf{b}),G)}\left[\mathbf{x}_{Y}\right]\right].
p(\mathbf{x}_{Y}|\text{do}(\mathbf{x}_{T}=\mathbf{b}),G)=p(\mathbf{x}_{Y}|%
\mathbf{x}_{T}=\mathbf{b},G_{\text{do}(\mathbf{x}_{T})})
G_{\text{do}(\mathbf{x}_{T})}
\mathbf{x}_{T}
G_{\text{do}(\mathbf{x}_{T})}
\mathbf{x}_{T}=\mathbf{b}
q_{\phi}(\mathbf{u}|\mathbf{x})
\mathbf{u}
p(\mathbf{u})
q_{\phi}(\mathbf{u}|\mathbf{x})
u_{1}
u_{2}
x_{i}
x_{j}
x_{k}
u_{1}
u_{2}
x_{i}
x_{j}
x_{k}
\exists g,\quad x_{i}-g(x_{j})\rotatebox[origin={c}]{90.0}{$\models$}x_{k}
\exists g\quad f_{1i}(u_{1})+\epsilon_{i}-g(f_{2j}(f_{12}(u_{1}),u_{2}),%
\epsilon_{j})\rotatebox[origin={c}]{90.0}{$\models$}f_{2k}(f_{12}(u_{1}),u_{2}%
)+\epsilon_{k}.
u_{1}
u_{2}
f_{2k}(f_{12}(u_{1}),u_{2})
f_{1i}(u_{1})-g(f_{2j}(f_{12}(u_{1}),\epsilon_{j})
u_{1}
g
u_{2}
u_{2}
g
u_{1}
\exists g\quad f_{1i}(f_{21}(u_{2}),u_{1})+\epsilon_{i}-g(f_{2j}(u_{2})+%
\epsilon_{j})\rotatebox[origin={c}]{90.0}{$\models$}f_{2k}(u_{2})+\epsilon_{k}.
g
u_{2}
g=\frac{f_{1i}f_{21}}{f_{2j}}
u_{1}
u_{2}
u_{2}
\epsilon_{j}
\exists g,\quad x_{i}-g(x_{j})\rotatebox[origin={c}]{90.0}{$\models$}x_{k}.
\exists g\quad f_{i}(u)+\epsilon_{i}-g(f_{j}(u)+\epsilon_{j})\rotatebox[origin%
={c}]{90.0}{$\models$}f_{k}(u)+\epsilon_{k}.
g=\frac{f_{i}}{f_{j}}
u
f_{i}\neq f_{j}
u
g
u
\epsilon_{j}
\exists g\quad f_{i}(u_{1},u_{2})+\epsilon_{i}-g(f_{j}(u_{1},u_{3})+\epsilon_{%
j})\rotatebox[origin={c}]{90.0}{$\models$}f_{k}(u_{2},u_{3})+\epsilon_{k}.
u_{2}
u_{1}
u_{2}
u_{3}
x_{i}
x_{j}
x_{k}
x_{i}
x_{j}
x_{k}
u
f_{i}
f_{j}
f_{k}
x_{i}
x_{j}
x_{k}
x_{i}
x_{j}
x_{k}
\rho
\alpha
\rho
\alpha
\rho
\alpha
\rho
\alpha
10^{-3}
5\times 10^{-3}
\rho=1
\alpha=0
P_{1}=\mathbb{E}_{q_{\phi}(G)}\left[h(G)\right]
P_{2}=\mathbb{E}_{q_{\phi}(G)}\left[h(G)\right]
P_{2}<P_{1}
\rho
\alpha\leftarrow\alpha+\rho P_{2}
P_{2}\geq 0.65P_{1}
\alpha
\rho\leftarrow 10\rho
\alpha
\rho
10^{3}
\lambda_{s,1}=\lambda_{s,2}=5
\xi_{1}
\xi_{2}
\ell
q_{\phi}(\mathbf{u}|\mathbf{x})
\mathbf{x}_{Y}
\displaystyle{}^{T}\sim\mathcal{N}\left(\boldsymbol{\mathbf{0}},\mathbf{I}\right)
\displaystyle\sim\mathcal{N}\left(\boldsymbol{\mathbf{0}},\mathbf{I}\right)
\displaystyle x_{1}=\epsilon_{1}
\displaystyle x_{1}
\displaystyle=\epsilon_{1}
\displaystyle x_{2}=\sqrt{6}\exp(-u_{1}^{2})+0.1\epsilon_{2}
\displaystyle x_{2}
\displaystyle=\sqrt{6}\exp(-u_{1}^{2})+0.1\epsilon_{2}
\displaystyle x_{3}=\sqrt{6}\exp(-u_{1}^{2})+\sqrt{6}\exp(-u_{2}^{2})+0.2%
\epsilon_{3}
\displaystyle x_{3}
\displaystyle=\sqrt{6}\exp(-u_{1}^{2})+\sqrt{6}\exp(-u_{2}^{2})+0.2\epsilon_{3}
\displaystyle x_{4}=\sqrt{6}\exp(-u_{2}^{2})+\sqrt{6}\exp(-x_{1}^{2})+0.1%
\epsilon_{4}
\displaystyle x_{4}
\displaystyle=\sqrt{6}\exp(-u_{2}^{2})+\sqrt{6}\exp(-x_{1}^{2})+0.1\epsilon_{4}
\displaystyle x_{5}=\sqrt{6}\exp(-x_{1}^{2})+0.1\epsilon_{5}.
\displaystyle x_{5}
\displaystyle=\sqrt{6}\exp(-x_{1}^{2})+0.1\epsilon_{5}.
u_{1}
u_{2}
x_{2}
x_{3}
x_{3}
x_{4}
(d,e,m)
d\times d
G_{D}
e
d\times d
G_{B}
m
\epsilon_{i}
\mathbf{u}
x_{i}=f_{i}(\mathbf{x}_{\text{pa}(i;G_{D})})+g_{i}(\mathbf{u}_{\text{pa}(i;G_{%
B})})+\epsilon_{i}
f_{i},g_{i}
y=\mathbf{w}^{T}\ e^{-\mathbf{x}^{2}}
\mathbf{u}
\pm
\pm
