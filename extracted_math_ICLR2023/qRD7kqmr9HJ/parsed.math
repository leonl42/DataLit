36.9\%
3.3
60\%
0.5\%
36.9\%
3.3
8.4
37.4\%
i
\bar{\mathbf{X}}_{i}\in\mathbb{R}^{C_{i}\times H\times W}
\mathbf{X}_{i}=\textrm{PatchMerge}(\bar{\mathbf{X}}_{i})\in\mathbb{R}^{N\times
C%
_{i}}
N
C_{i}
i
\mathbf{Q}=\textrm{FC}(\mathbf{X}_{i})\in\mathbb{R}^{N\times C_{i}}
\mathbf{K}=\textrm{FC}(\mathbf{X}_{i})\in\mathbb{R}^{\bar{N}\times C_{i}}
\mathbf{V}=\textrm{FC}(\mathbf{X}_{i})\in\mathbb{R}^{\bar{N}\times C_{i}}
\textrm{FC}(\cdot)
\mathbf{K}
\mathbf{V}
\bar{N}=N/R
O(N^{2}/R)
\mathbf{X}_{mha}
\displaystyle\mathbf{A}=\textrm{softmax}(\frac{\mathbf{Q}\mathbf{K}^{\top}}{%
\sqrt{\bar{N}}})\mathbf{V}\in\mathbb{R}^{N\times C_{i}},
\displaystyle\mathbf{A}=\textrm{softmax}(\frac{\mathbf{Q}\mathbf{K}^{\top}}{%
\sqrt{\bar{N}}})\mathbf{V}\in\mathbb{R}^{N\times C_{i}},
\displaystyle\mathbf{X}_{mha}=\textrm{LN}\big{(}\hat{\mathbf{X}}+\textrm{FC}(%
\mathbf{A})\big{)}\in\mathbb{R}^{N\times C_{i}},\vspace{-0.5ex}
\displaystyle\mathbf{X}_{mha}=\textrm{LN}\big{(}\hat{\mathbf{X}}+\textrm{FC}(%
\mathbf{A})\big{)}\in\mathbb{R}^{N\times C_{i}},\vspace{-0.5ex}
\textrm{LN}(\cdot)
\mathbf{X}_{mha}
\mathbf{X}_{ffn}=\textrm{LN}(\textrm{FC}(\textrm{GeLU}(\textrm{Conv}(\textrm{%
FC}(\mathbf{X}_{mha})))+\mathbf{X}_{mha}),\vspace{-0.5ex}
\textrm{Conv}(\cdot)
\textrm{Conv}(\cdot)
\{\mathbf{X}_{i}\}_{i=1}^{4}
\textrm{FC}(\cdot)
\mathbf{W}_{1}
\mathbf{W}_{2}
\textrm{FC}(\cdot)
\mathbf{W}_{1}
\mathbf{W}_{2}
\mathbf{X}\in\mathbb{R}^{N\times C}
\mathbf{M}=g_{\phi}(\mathbf{X})\in\mathbb{R}^{N\times\bar{C}}
g_{\phi}(\cdot)
\phi
\bar{C}
\mathbf{M}
\mathbf{W}_{1}\in\mathbb{R}^{C\times\bar{C}}
\mathbf{W}_{2}\in\mathbb{R}^{\bar{C}\times C}
\mathbf{Y}=\mathbf{X}(\mathbf{W}_{1}\circ\mathbf{M})\in\mathbb{R}^{N\times\bar%
{C}},\ \ \mathbf{Z}=\mathbf{Y}(\mathbf{W}_{2}\circ\mathbf{M}^{\top})\in\mathbb%
{R}^{N\times C},
\circ
g_{\phi}(\cdot)
N
\mathbf{X}
\hat{\mathbf{X}}=\textrm{LN}(\textrm{AvgPool}(\mathbf{X}))\in\mathbb{R}^{C}
\mathbf{X}
\mathbf{W}
\hat{\mathbf{X}}
\mathbf{W}_{1}
\textrm{MLP}(\cdot)
\textrm{ReLU}(\cdot)
\mathbf{M}
\displaystyle\mathbf{M}=\textrm{Top-r}(\mathbf{G}),\quad\mathbf{G}=\textrm{MLP%
}(\hat{\mathbf{X}}\mathbf{W}_{1})\in\mathbb{R}^{\bar{C}},\vspace{-0.5ex}
\displaystyle\mathbf{M}=\textrm{Top-r}(\mathbf{G}),\quad\mathbf{G}=\textrm{MLP%
}(\hat{\mathbf{X}}\mathbf{W}_{1})\in\mathbb{R}^{\bar{C}},\vspace{-0.5ex}
\textrm{Top-r}(\cdot)
r\%
\mathbf{G}
t
r_{t}=r\min(1,\frac{t}{T})
T
\textrm{Top-r}(\cdot)
\mathbf{G}
\ell_{1}
\mathbf{G}
\vspace{-0.5ex}\mathcal{L}_{m}=\lambda_{m}\sum\|\mathbf{G}\|_{1}.\vspace{-0.5ex}
\mathbf{Q}
\mathbf{K}
\mathbf{V}
\{\mathbf{X}_{i}\}_{i=1}^{4}
g_{\phi}(\cdot)
O(C\bar{C})
O(NC\bar{C})
\mathbf{X}
\mathbf{W}_{1}
\tilde{\mathbf{X}}_{i}
\mathbf{X}_{i}
\ell_{1}=\sum_{i=1}^{4}\textrm{MSE}(\tilde{\mathbf{X}}_{i},\mathbf{X}_{i}).%
\vspace{-1ex}
\tilde{\mathbf{Y}}
\mathbf{Y}^{\star}
\mathbf{Y}
\ell_{2}=\textrm{CE}(\tilde{\mathbf{Y}},\mathbf{Y}^{\star})+\lambda_{s}\textrm%
{SCE}(\tilde{\mathbf{Y}},\mathbf{Y}).\vspace{-1ex}
512\times 512
1024\times 1024
16
8
\lambda_{m}=0.005
\lambda_{s}=0.5
160
50\%
0.00006
30\%
50\%
2.9\%
5\%
12\%
36.9\%
0.5\%
40\%
+0.44
+3.35
+0.44
+3.35
\downarrow
\downarrow
\uparrow
\downarrow
\uparrow
9.8
39.6
19.7
317.1
61.5
67.7
13.7
52.9
29.6
423.4
70.2
15.4
69.4
34.0
555.4
75.2
3.8
8.4
37.4
125.5
76.2
3.8_{+0.44}
3.3
36.9
62.7
75.1
3.8_{+0.44}
2.7
35.0
46.7
74.3
68.6
275.7
41.4
2203.3
76.6
55.1
218.8
44.7
1748.0
6.9
68.1
256.4
44.4
2048.9
78.5
68.9
255.1
45.2
2224.8
80.2
62.7
255.1
44.1
2032.3
80.9
70.5
164.8
45.6
1296.8
81.1
27.5
62.4
46.5
717.1
81.0
27.5_{+3.35}
18.5
45.4
286.5
80.3
27.5_{+3.35}
15.0
44.6
214.2
79.8
40
1.2\%
0.7\%
0.5\%
2.9\%
3.2\%
32.1
30.6
30.7
30.9
31.4
30.4
29.2
27.7
\sum_{i}\mathbb{I}(G_{i}>0)
\mathbb{I}(\cdot)
15
2,000
10\sim 1988
