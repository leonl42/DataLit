N\leq 20
\mathbf{X}=\{\mathbf{x}_{i,1:T}\}_{i=1}^{N}
x_{i,t}
i
t
t\in\left\{1,...,T\right\}
i\in\left\{1,...,N\right\}
T
N
x_{i,t}
x_{i,t}=f_{i}(\mathbf{x}_{1,t-\tau:t-1},\mathbf{x}_{2,t-\tau:t-1},...,\mathbf{%
x}_{N,t-\tau:t-1})+e_{i,t}
\tau
i=1,2,...,N
o_{t,i}
x_{i,t}
o_{t,i}
p
o_{t,i}\sim Ber(1-p)
p
p_{\text{blk}}
L_{\text{blk}}\sim\text{Uniform}(L_{\text{min}},L_{\text{max}})
p_{\text{blk}}\cdot N\cdot T
[L_{\text{min}},L_{\text{max}}]
i
j
\mathbf{x}_{i}
\mathbf{x}_{j}
i
j
\mathbf{x}^{\prime}_{i,t-\tau:t-1}\neq\mathbf{x}_{i,t-\tau:t-1}
\displaystyle f_{j}(\mathbf{x}_{1,t-\tau:t-1},...,\mathbf{x}^{\prime}_{i,t-%
\tau:t-1},...,\mathbf{x}_{N,t-\tau:t-1})=
\displaystyle f_{j}(\mathbf{x}_{1,t-\tau:t-1},...,\mathbf{x}^{\prime}_{i,t-%
\tau:t-1},...,\mathbf{x}_{N,t-\tau:t-1})=
\displaystyle f_{j}(\mathbf{x}_{1,t-\tau:t-1},...,\mathbf{x}_{i,t-\tau:t-1},..%
.,\mathbf{x}_{N,t-\tau:t-1})
\displaystyle f_{j}(\mathbf{x}_{1,t-\tau:t-1},...,\mathbf{x}_{i,t-\tau:t-1},..%
.,\mathbf{x}_{N,t-\tau:t-1})
i
x_{j,t}
\mathbf{x}_{i}
\mathbf{x}_{i,t-\tau:t-1}
\mathbf{A}=\{a_{ij}\}_{i,j=1}^{N}
a_{ij}=1
i
j
a_{ij}=0
\mathbf{A}_{N\times N}
N
N\leq 20
N>20
\mathbf{A}_{N\times N}
N
\mathbf{x}\in\mathbf{\mathcal{X}}\subset\mathbb{R}^{n},\mathbf{A}\in\mathbf{%
\mathcal{A}}\subset\left\{0,1\right\}^{n\times n}
\mathbf{y}\in\mathbf{\mathcal{Y}}\subset\mathbb{R}^{n}
\mathbf{f}_{\Theta}:\left<\mathbf{\mathcal{X}},\mathbf{\mathcal{A}}\right>%
\rightarrow\mathbf{\mathcal{Y}}
\mathbf{f}_{\Theta}(\mathbf{x},\mathbf{A})=\left[f_{\Theta_{1}}(\mathbf{x}%
\odot\mathbf{a}_{:,1}),...,f_{\Theta_{n}}(\mathbf{x}\odot\mathbf{a}_{:,n})%
\right]^{T}.
\mathbf{a}_{:,j}
\mathbf{A}
f_{\phi_{j}}:\mathbf{\mathcal{X}}_{j}\rightarrow\mathbf{\mathcal{Y}}_{j}
\mathbf{\mathcal{X}}_{j}\subset\mathbb{R}^{n}
\mathbf{\mathcal{Y}}_{j}\subset\mathbb{R}
\odot
f_{\Theta_{j}}(\cdot)
f_{j}(\cdot)
\mathbf{X}
\mathbf{x}
\odot
f_{\phi_{j}}(\mathbf{X}\odot\mathbf{a}_{:,j})\overset{\Delta}{=}f_{\phi_{j}}%
\left(\left\{\mathbf{x}_{1}\cdot a_{1j},...,\mathbf{x}_{N}\cdot a_{Nj}\right\}\right)
f_{j}
f_{\phi_{j}}
N
N
M
Q
S
\mathbf{M}
m_{ij}
i
j
m_{ij}=P(x_{i}\rightarrow x_{j})
\tilde{m}_{ij}
\mathbf{\tilde{\mathbf{M}}}
i
j
\mathbf{X}_{\mathcal{G}_{k}}=\left\{\mathbf{x}_{i}\right\}_{i\in\mathcal{G}_{k}}
\mathcal{G}_{k}
k
k\in\left[1,N_{g}\right]
N_{g}
\forall k\neq l\in\left[1,N_{g}\right],\mathcal{G}_{k}\cap\mathcal{G}_{l}=\phi
\mathbf{\tilde{\mathbf{M}}}
\mathbf{\tilde{\mathbf{M}}}=\mathbf{G}^{T}\mathbf{Q}
\mathbf{G}\in\mathbb{R}^{N_{g}\times N}
g_{ki}=\begin{cases}0,&\text{if }i\notin\mathcal{G}_{k}\\
1,&\text{if }i\in\mathcal{G}_{k},\end{cases}
\mathbf{G}
\forall i\in\left[1,N\right],\sum_{k=1}^{N_{g}}g_{ki}=1
\mathbf{X}_{\mathcal{G}_{k}}
\mathbf{X}_{\mathcal{G}_{k}}
\mathbf{x}_{j}
\mathbf{X}^{\prime}_{\mathcal{G}_{k}}\neq\mathbf{X}_{\mathcal{G}_{k}}
f_{j}\left(\left\{\mathbf{X}^{\prime}_{\mathcal{G}_{k}},\mathbf{X}\backslash%
\mathbf{X}_{\mathcal{G}_{k}}\}\right)=f_{j}\left(\{\mathbf{X}_{\mathcal{G}_{k}%
},\mathbf{X}\backslash\mathbf{X}_{\mathcal{G}_{k}}\right\}\right)
x_{\mathcal{G}_{k}}
x_{j,t}
\mathbf{X}\backslash\mathbf{X}_{\mathcal{G}_{k}}\overset{\Delta}{=}\left\{%
\mathbf{x}_{i}\right\}_{i\notin\mathcal{G}_{k}}
\mathbf{Q}\in\mathbb{R}^{N_{g}\times N}
q_{ij}=P(\mathbf{X}_{\mathcal{G}_{i}}\rightarrow\mathbf{x}_{j})
\mathbf{G}
N_{g}
|\mathcal{G}_{i}|=\begin{cases}\lfloor N/N_{g}\rfloor,&\text{if }i\in\left[1,N%
_{g}-1\right]\\
N-\lfloor N/N_{g}\rfloor\cdot(N_{g}-1),&\text{if }i=N_{g}.\end{cases}
N_{g}
q_{ij}
{q}_{i_{1},j}
{q}_{i_{2},j}
\mathbf{x}_{j}
\mathbf{x}_{j}
q_{ij}=P(\mathbf{X}_{\mathcal{G}_{i}}\rightarrow\mathbf{x}_{j})=1-P(\mathbf{X}%
_{\mathcal{G}_{i_{1}}}\nrightarrow\mathbf{x}_{j})P(\mathbf{X}_{\mathcal{G}_{i_%
{2}}}\nrightarrow\mathbf{x}_{j})
\nrightarrow
P(\mathbf{X}_{\mathcal{G}_{i_{1}}}\rightarrow\mathbf{x}_{j})=P(\mathbf{X}_{%
\mathcal{G}_{i_{2}}}\rightarrow\mathbf{x}_{j})
q_{i_{1},j}
q_{i_{2},j}
q_{i_{1},j}=q_{i_{2},j}=1-\sqrt{1-q_{ij}}.
N_{g}\ll N
N\cdot N_{g}
N^{2}
N_{g}
N_{g}
|\mathcal{G}_{k}|>1
q_{kj}
1
j
N_{g}
j
\text{MPNN}_{\mathbf{\nu}}(\mathbf{z};\mathbf{s})=\text{MLP}_{\mathbf{\nu}}%
\left(\mathbf{z}\odot\mathbf{s}\right)=\mathbf{z}^{\prime}
\mathbf{h}^{\prime}
\text{MLP}_{1}(\cdot),\text{MLP}_{2}(\cdot)
\odot
\mathbf{s}\in\left\{0,1\right\}^{N}
s_{i}=1
z_{i}
\displaystyle\mathbf{r}_{t}^{j}=\sigma\left(\text{MPNN}_{\mathbf{\nu}_{l}^{r}}%
\left({\mathbf{x}}_{:,t};\mathbf{s}_{:,j}\right)\right)
\displaystyle\mathbf{r}_{t}^{j}
\displaystyle=\sigma\left(\text{MPNN}_{\mathbf{\nu}_{l}^{r}}\left({\mathbf{x}}%
_{:,t};\mathbf{s}_{:,j}\right)\right)
\displaystyle\mathbf{u}_{t}^{j}=\sigma\left(\text{MPNN}_{\mathbf{\nu}_{l}^{u}}%
\left({\mathbf{x}}_{:,t};\mathbf{s}_{:,j}\right)\right)
\displaystyle\mathbf{u}_{t}^{j}
\displaystyle=\sigma\left(\text{MPNN}_{\mathbf{\nu}_{l}^{u}}\left({\mathbf{x}}%
_{:,t};\mathbf{s}_{:,j}\right)\right)
\displaystyle\mathbf{c}_{t}^{j}=\text{tanh}\left(\text{MPNN}_{\mathbf{\nu}_{l}%
^{c}}\left({\mathbf{x}}_{:,t};\mathbf{s}_{:,j}\right)\right)
\displaystyle\mathbf{c}_{t}^{j}
\displaystyle=\text{tanh}\left(\text{MPNN}_{\mathbf{\nu}_{l}^{c}}\left({%
\mathbf{x}}_{:,t};\mathbf{s}_{:,j}\right)\right)
\displaystyle\mathbf{h}_{t}^{j}=\mathbf{u}_{t}^{i}\odot\mathbf{h}_{t-1}^{i}+(1%
-\mathbf{u}_{t}^{i})\odot\mathbf{c}_{t}^{i},
\displaystyle\mathbf{h}_{t}^{j}
\displaystyle=\mathbf{u}_{t}^{i}\odot\mathbf{h}_{t-1}^{i}+(1-\mathbf{u}_{t}^{i%
})\odot\mathbf{c}_{t}^{i},
\sigma(\cdot)
l
\text{MPGNN}_{\mathbf{\nu}}\left({\mathbf{x}}_{:,t},\mathbf{h}_{0}^{j};\mathbf%
{s}_{:,j}\right)
\mathbf{\nu}=\{\mathbf{\nu}^{r}_{1},\mathbf{\nu}^{u}_{1},\mathbf{\nu}^{c}_{1},%
...,\mathbf{\nu}^{r}_{l},\mathbf{\nu}^{u}_{l},\mathbf{\nu}^{c}_{l}\}
\mathbf{\nu}
j
l\left(|\mathbf{\nu}^{r}|+|\mathbf{\nu}^{u}|+|\mathbf{\nu}^{c}|\right)
l
Nl\left(|\mathbf{\nu}^{r}|+|\mathbf{\nu}^{u}|+|\mathbf{\nu}^{c}|\right)
O(Nl)
\hat{x}_{j,t}
\hat{x}_{j,t}=\text{Linear}_{\psi_{j}^{2}}\left(\text{MLP}_{\psi^{1}}\left(%
\mathbf{h}_{t-1}^{j}\right)\right)
\text{Linear}_{\psi_{j}^{2}}(\cdot)
\psi
\psi_{j}
j
\tilde{\mathbf{M}}
\tilde{\mathbf{M}}
\left[0,1\right]
\mathbf{Q}=\sigma(\mathbf{\Theta})
\mathbf{\Theta}
\mathbf{\Theta}
s_{ij}=\frac{e^{{(\log(m_{ij})+g)}/{\tau}}}{e^{{(\log(m_{ij})+g)}/{\tau}}+e^{{%
(\log(1-m_{ij})+g)}/{\tau}}}
g=-\log(-\log(u)),u\sim\text{Uniform}(0,1)
\tau
\tau
\mathbf{\Theta}
\tilde{\mathbf{M}}
\mathbf{S}
s_{ij}\sim\text{Ber}(m_{ij})
\mathbf{s}_{:,j}
\tilde{\mathbf{M}}=\sigma(\mathbf{\Theta})
\displaystyle\max_{\mathbf{\Theta}}\mathcal{L}_{\text{graph}}=\max_{\mathbf{%
\Theta}}\frac{\sum_{j=1}^{N}\sum_{t=1}^{T}\left(\hat{x}_{j,t}-x_{j,t}\right)^{%
2}\cdot o_{j,t}}{\sum_{j=1}^{N}\sum_{t=1}^{T}o_{j,t}}
\displaystyle\max_{\mathbf{\Theta}}\mathcal{L}_{\text{graph}}=\max_{\mathbf{%
\Theta}}
\displaystyle\frac{\sum_{j=1}^{N}\sum_{t=1}^{T}\left(\hat{x}_{j,t}-x_{j,t}%
\right)^{2}\cdot o_{j,t}}{\sum_{j=1}^{N}\sum_{t=1}^{T}o_{j,t}}
\displaystyle+\lambda\left\|\sigma(\mathbf{\Theta})\right\|_{1}.
\displaystyle+\lambda\left\|\sigma(\mathbf{\Theta})\right\|_{1}.
\max_{\Phi}\mathcal{L}_{\text{data}}=\max_{\Phi}\frac{\sum_{j=1}^{N}\sum_{t=1}%
^{T}\left(\hat{x}_{j,t}-x_{j,t}\right)^{2}\cdot o_{j,t}}{\sum_{j=1}^{N}\sum_{t%
=1}^{T}o_{j,t}}.
\Phi=\left\{\nu,\psi_{1},\{\psi_{2}^{j}\}_{j=1}^{N}\right\}
\mathbf{A}
\mathbf{f}_{\Phi}(x,\mathbf{A})
\text{MPGNN}_{\mathbf{\nu}}\left(\tilde{\mathbf{X}},\mathbf{h}_{0}^{j};\mathbf%
{s}_{:,j}\right)
\text{Linear}_{\psi_{j}^{2}}\left(\text{MLP}_{\psi^{1}}\left(\cdot\right)\right)
\displaystyle\hat{x}_{:,t}=\mathbf{f}_{\Phi}(\mathbf{X},\mathbf{S})=
\displaystyle\hat{x}_{:,t}=\mathbf{f}_{\Phi}(\mathbf{X},\mathbf{S})=
\displaystyle\left[...,\text{Linear}_{\psi_{j}^{2}}\left(\text{MLP}_{\psi^{1}}%
\left(\text{MPGNN}_{\mathbf{\nu}}\left(\tilde{\mathbf{X}},\mathbf{h}_{0}^{j};%
\mathbf{s}_{:,j}\right)\right)\right),...\right]^{T}
\displaystyle\left[...,\text{Linear}_{\psi_{j}^{2}}\left(\text{MLP}_{\psi^{1}}%
\left(\text{MPGNN}_{\mathbf{\nu}}\left(\tilde{\mathbf{X}},\mathbf{h}_{0}^{j};%
\mathbf{s}_{:,j}\right)\right)\right),...\right]^{T}
\mathbf{h}_{0}^{j}
\mathbf{x}
\hat{x}_{j,t}
N=128
N=128
N=128
p=0.3
p=0.6
p_{\text{blk}}=0.15\%
~{}~{}p_{\text{blk}}=0.3\%~{}~{}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N=256
N=256
N=256
p=0.3
p=0.6
p_{\text{blk}}=0.15\%
p_{\text{blk}}=0.3\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N
T
N
T
\mathbf{x}_{:,t}=\sum_{\tau=1}^{\tau_{max}}\mathbf{A}\mathbf{x}_{:,t-\tau}+%
\mathbf{e}_{:,t}
\mathbf{A}
\mathbf{e}_{:,t}\sim\mathcal{N}(\mathbf{0},\sigma\mathbf{I})
i
j
a_{ij}>0
\mathbf{A}
\tilde{\mathbf{M}}
\tau_{max}=3
L=1000
\frac{dx_{i,t}}{dt}=-x_{i-1,t}(x_{i-2,t}-x_{i+1,t})-x_{i,t}+F
F=10,L=1000
\mathbf{x}_{i}
\mathbf{x}_{i-2},\mathbf{x}_{i-1},\mathbf{x}_{i},\mathbf{x}_{i+1}
\mathbf{A}
p=0.3
N=64,128,256,512,1024
p=0.3
N=64,128,256,512,1024
N
N
N
N
N
N=512
N>256
N=100
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
T=21
N=163,T=8760
\tilde{\mathbf{M}}
\mathbf{D}
d_{ij}\propto 1/\text{dist}(i,j)
P(i\rightarrow j)>0.5
