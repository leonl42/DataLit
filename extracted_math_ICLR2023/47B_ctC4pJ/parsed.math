\mathtt{GlobalDirection}
\mathbf{\mathcal{W}}{}
\mathbf{\mathcal{S}}{}
\mathbf{\mathcal{W}}{}
\mathbf{\mathcal{W}}{}
\mathtt{GlobalDirection}
\mathtt{GlobalDirection}
\mathtt{GlobalDirection}
\hat{\bm{s}}
\bm{\phi}(\cdot)
D{}_{\mathtt{GlobalDirection}}
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
D_{\text{{Multi2One}}}
\hat{\bm{s}}
\bm{\phi}(\cdot)
D{}_{\mathtt{GlobalDirection}}
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
D_{\text{{Multi2One}}}
\mathcal{Z}
\mathcal{W}
\mathcal{W}+
\mathcal{S}
\mathcal{Z}
z\sim N(0,I)
\mathcal{W}
\mathcal{W}+
\mathcal{S}
\mathcal{S}
\mathbf{\mathcal{S}}
1024^{2}
n
\mathbf{\mathcal{S}}{}
\bm{s}=[s_{1},s_{2},\cdots,s_{n}]^{T}\in\mathbf{\mathcal{S}}
s_{i}
G
X=G_{s}(\bm{s})
X
\hat{\bm{s}}=[\hat{s}_{1},\hat{s}_{2},...,\cdots,\hat{s}_{n}]^{T}
\mathbf{\mathcal{S}}{}
X_{\text{edited}}=G_{s}(\bm{s}+\hat{\bm{s}})
t
\bm{s}
X
\mathbf{\mathcal{S}}{}
\mathtt{GlobalDirection}
t
\text{CLIP}(t)\in\mathbb{R}^{p}
\mathbf{\mathcal{S}}{}
i
\mathbf{\mathcal{S}}{}
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i}):=\mathbb{E}_{\bm{s}\in\mathbf{\mathcal%
{S}}{}}\Big{[}\mathrm{CLIP}\big{(}G_{s}(\bm{s}+{\bm{e}}_{i})\big{)}-\mathrm{%
CLIP}\big{(}G_{s}(\bm{s}-{\bm{e}}_{i})\big{)}\Big{]}
{\bm{e}}_{i}\in\mathbb{R}^{n}
i
{\bm{e}}_{i}
{\bm{s}}
i
n
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})
p
G_{s}(\cdot)
p
n
\mathbf{\mathcal{S}}{}
D{}_{\texttt{GlobalDirection}}:=[\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{1}),\bm{%
\phi}_{\mathrm{CLIP}}({\bm{e}}_{2}),\cdots,\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_%
{n})]\in\mathbb{R}^{p\times n}
\hat{\bm{s}}\in\mathbb{R}^{n}
\hat{\bm{s}}=D{}_{\texttt{GlobalDirection}}^{T}\mathrm{CLIP}(t).
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})
D
cos(\cdot,\cdot)
\uparrow
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
\bm{\alpha}
cos(\cdot,\cdot)
\uparrow
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
\bm{\alpha}
cos(\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}),X_{\mathrm{unsup}})
cos(\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}),X_{\mathrm{GD}})
\bm{\alpha}^{(10)}
\bm{\alpha}^{(30)}
\bm{\alpha}^{(50)}
\mathtt{GlobalDirection}
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha})=\mathbb{E}_{\bm{s}\in\mathbf{\mathcal{S%
}}{}}[\mathrm{CLIP}\big{(}G_{s}(\bm{s}+\bm{\alpha})\big{)}-\mathrm{CLIP}\big{(%
}G_{s}(\bm{s}-\bm{\alpha})\big{)}]
X_{\mathrm{GD}}
X_{\mathrm{GD}}
\mathtt{GlobalDirection}
X_{\mathrm{unsup}}
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha})
\bm{\alpha}
X_{\mathrm{unsup}}
X_{\mathrm{GD}}
X=G_{s}({\bm{s}})
\bm{\alpha}\in\mathbb{R}^{n}
X_{\mathrm{unsup}}=G_{s}({\bm{s}}+\bm{\alpha})
\bm{\alpha}\in\mathbb{R}^{n}
k
n
\bm{\alpha}
\bm{\alpha}^{(k)}\in\mathbb{R}^{n}
X_{\mathrm{GD}}=G_{s}({\bm{s}}+\hat{\bm{\alpha}}_{\mathrm{}})
\hat{\bm{\alpha}}_{\mathrm{}}=D_{\texttt{GlobalDirection}}^{T}\mathrm{CLIP}(t)%
\in\mathbb{R}^{n}
\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}
X_{\mathrm{unsup}}
\mathtt{GlobalDirection}
\mathrm{CLIP}(t)
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(k)})=\mathbb{E}_{\bm{s}\in\mathbf{%
\mathcal{S}}{}}[\mathrm{CLIP}\big{(}G_{s}(\bm{s}+\bm{\alpha}^{(k)})\big{)}-%
\mathrm{CLIP}\big{(}G_{s}(\bm{s}-\bm{\alpha}^{(k)})\big{)}]
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(k)})
\bm{\alpha}^{(k)}
(t)
\hat{{\bm{s}}}={\bm{e}}_{i}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ %
\ \ \ \ \ \ \hat{{\bm{s}}}=\bm{\alpha}^{(50)}
\mathrm{CLIP}\big{(}G_{s}(\bm{s}+\hat{{\bm{s}}})\big{)}-\mathrm{CLIP}\big{(}G_%
{s}(\bm{s}-\hat{{\bm{s}}})\big{)}
{\bm{e}}_{i}
\bm{\alpha}^{(50)}
\mathrm{CLIP}\big{(}G_{s}(\bm{s}+\hat{{\bm{s}}})\big{)}-\mathrm{CLIP}\big{(}G_%
{s}(\bm{s}-\hat{{\bm{s}}})\big{)}
{\bm{e}}_{i}
\bm{\alpha}^{(50)}
{\bm{e}}_{i}
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})
D_{\texttt{GlobalDirection}}
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})=\mathbb{E}\big{[}\mathrm{CLIP}\big{(}G%
_{s}(\bm{s}+{\bm{e}}_{i})\big{)}-\mathrm{CLIP}\big{(}G_{s}(\bm{s}-{\bm{e}}_{i}%
)\big{)}\big{]}
D_{\texttt{GlobalDirection}}
i
\mathrm{CLIP}\big{(}G_{s}(\bm{s}+{\bm{e}}_{i})\big{)}-\mathrm{CLIP}\big{(}G_{s%
}(\bm{s}-{\bm{e}}_{i})\big{)}
\mathrm{CLIP}\big{(}G_{s}(\bm{s}+{\bm{e}}_{i})\big{)}-\mathrm{CLIP}\big{(}G_{s%
}(\bm{s}-{\bm{e}}_{i})\big{)}
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})
{\bm{e}}_{i}
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})
i
{\bm{e}}_{i}
\bm{\alpha}^{(50)}
\mathbf{\mathcal{S}}{}
D
\bm{\phi}(\cdot)
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
\mathbf{\mathcal{S}}{}\rightarrow
D
\bm{\phi}(\cdot)
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
\mathbf{\mathcal{S}}{}\rightarrow
t
\mathrm{CLIP}(t)\in\mathbb{R}^{p}
D\in\mathbb{R}^{p\times n}
\hat{\bm{s}}=D{}^{T}\mathrm{CLIP}(t)\in\mathbb{R}^{n}
\hat{\bm{s}}
G_{s}({\bm{s}}+\hat{\bm{s}})
t
\hat{{\bm{s}}}_{t}\in\mathbb{R}^{n}
t
\hat{\bm{s}}=D{}^{T}\mathrm{CLIP}(t)
X_{\mathrm{edited}}=G_{s}({\bm{s}}+D{}^{T}\mathrm{CLIP}(t))
G_{s}({\bm{s}}+\hat{{\bm{s}}}_{t})
\operatorname*{minimize}_{D}{}\big{\|}D{}^{T}\mathrm{CLIP}(t)-\hat{{\bm{s}}}_{%
t}\big{\|}_{2}^{2}
\hat{{\bm{s}}}_{t}
t
\hat{{\bm{s}}}_{t}
\bm{\alpha}\in\mathbb{R}^{n}
\mathrm{CLIP}(t)
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha})
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
\bm{\alpha}
t
\operatorname*{minimize}_{D}{}\sum_{\forall\bm{\alpha}}\big{\|}\ D^{T}\bm{\phi%
}_{\mathrm{CLIP}}(\bm{\alpha})-\bm{\alpha}\big{\|}_{2}^{2}.
\bm{\alpha}
\bm{\alpha}\in\mathbb{R}^{n}
k
n
n-k
\bm{\alpha}^{(k)}\in\mathbb{R}^{n}
k=10,30,50
k
\bm{\alpha}\in\mathbb{R}^{n}
k
\|D{}\bm{\alpha}^{(k)}-\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(k)})\|_{2}^{2}
D\in\mathbb{R}^{p\times n}
\bm{\phi}_{\mathrm{CLIP}}({\bm{e}}_{i})
n
\bm{\alpha}^{(k)}
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
k
\bm{\alpha}^{(k)}
\bm{\alpha}
\bm{\alpha}^{(10)},\bm{\alpha}^{(30)},\bm{\alpha}^{(50)}
D
k=1,2,3
\bm{\alpha}^{(1)},\bm{\alpha}^{(2)},\bm{\alpha}^{(3)}
\bm{\alpha}
\bm{\alpha}^{(3)}=[s_{1},s_{2},s_{3}]^{T}
\bm{\alpha}^{(2)}=[s_{1},0,s_{3}]^{T}
\bm{\alpha}^{(1)}=[s_{1},0,0]^{T}
\|D{}\bm{\alpha}^{(k)}-\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(k)})\|_{2}^{2}
D{}\bm{\alpha}^{(k)}=\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(k)})
s_{1}d_{1}\approx\text{CLIP(thick eyebrows)},s_{1}d_{1}+s_{3}d_{3}\approx\text%
{CLIP(thick eyebrows \& pink lipsticks)}
s_{1}d_{1}+s_{2}d_{2}+s_{3}d_{3}\approx\text{CLIP(thick eyebrows \& pink %
lipsticks \& glowing skin)}
d_{1}
d_{3}
d_{2}
\bm{\alpha}
s_{1}
s_{2}
s_{3}
\bm{\alpha}=[s_{1},s_{2},s_{3}]^{T}
\bm{\alpha}^{(k)}
\operatorname*{minimize}_{D}{}\sum_{\forall\bm{\alpha}^{(k)}}{\big{\|}D{}^{T}%
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(k)})-\bm{\alpha}^{(k)}\big{\|}_{2}^{2}%
+\lambda\cdot\big{\|}D{}\bm{\alpha}^{(k)}-\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha%
}^{(k)})\big{\|}_{2}^{2}}\ 
\lambda
\downarrow
100
\bm{\alpha}
\bm{\alpha}^{(100)}
\downarrow
100
\bm{\alpha}
\bm{\alpha}^{(100)}
\mathbf{MSE}(\bm{\alpha},\bm{\hat{\alpha}})
\pm
\pm
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{\neq 0}\big{)}
\pm
\pm
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{=0}\big{)}
\pm
\pm
\mathtt{GlobalDirection}
R_{\mathrm{CLIP}}
\uparrow
\bm{\alpha}
cos(\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}),\mathrm{CLIP}(t))
t
\lambda
R_{\mathrm{CLIP}}
\uparrow
\bm{\alpha}
cos(\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}),\mathrm{CLIP}(t))
t
\lambda
\lambda=0
\lambda=0.01
\bm{\alpha}
t
\mathbf{\mathcal{S}}{}
\mathbf{MSE}(\bm{\alpha},\hat{\bm{\alpha}}_{\mathrm{}}):=\mathbb{E}_{\bm{%
\alpha}\sim{\mathbb{A}}}\big{[}\|\hat{\bm{\alpha}}-\bm{\alpha}\|_{2}^{2}\big{]}
\bm{\alpha}
{\mathbb{A}}
\bm{\alpha}
\bm{\alpha}^{(100)}
n-100
\bm{\alpha}^{(100)}
\hat{\bm{\alpha}}_{\mathrm{}}=D{}^{T}\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}^{(1%
00)})
100
\bm{\alpha}^{(100)}
n-100
0
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{\neq 0}\big{)}
\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}
D
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{=0}\big{)}
\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}
n-100
\hat{\bm{\alpha}}_{\mathrm{}}
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}}):=\mathbb{E}_{t\sim{\mathbb{T%
}}}\big{[}cos\big{(}\text{CLIP}(t),\text{CLIP}(X_{\mathrm{edited}})\big{)}\big%
{]}.
{\mathbb{T}}
\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{=0}\big{)}
t\sim{\mathbb{T}}
t
\bm{\alpha}
cos(\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha}),\mathrm{CLIP}(t))
X_{\mathrm{unsup}}=G_{s}({\bm{s}}+\bm{\alpha})
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
\alpha
\beta
\bm{\alpha}
\bm{\phi}_{\mathrm{CLIP}}(\bm{\alpha})
k
k
E\big{(}G_{s}(s+{\bm{s}}_{i})\big{)}-E\big{(}G_{s}(s-{\bm{s}}_{i})\big{)}
E\big{(}G_{s}(s+\bm{\alpha})\big{)}-E\big{(}G_{s}(s-\bm{\alpha})\big{)}
s\sim\mathbf{\mathcal{S}}{}
p=512
2
(a_{i},b_{i})
i=1,2,\cdots,100
\mathbb{E}\bigg{[}E\big{(}G_{s}(\bm{s}+{\bm{s}}_{i})\big{)}-E\big{(}G_{s}(\bm{%
s}-{\bm{s}}_{i})\big{)}\bigg{]}
2
(\overline{a},\overline{b})
\theta_{i}=\operatorname{arctan2}(b_{i},a_{i})
[-\pi,+\pi]
\mathbb{R}{}^{2}
\operatorname{arctan2}(\overline{b},\overline{a})
\bm{\alpha}\in\mathbb{R}^{n}
k
\mathcal{W}
\mathcal{W}
E(\cdot)
E(\cdot)
E(\cdot)
E(\cdot)
\mathbf{\mathcal{W}}{}
\sim
\sim
\sim
\mathbf{\mathcal{S}}{}
\bm{\alpha}
\bm{\alpha}^{(k)}
k=10,30,50
\lambda
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
\uparrow
\mathbf{MSE}(\bm{\alpha},\hat{\bm{\alpha}}_{\mathrm{}})
\downarrow
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{=0}\big{)}
\downarrow
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{\neq 0}\big{)}
\downarrow
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
t
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
\bm{\alpha}^{(100)}
\bm{\alpha}
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
\bm{\alpha}^{(100)}
n
\bm{\alpha}^{(100)}
n-100
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{=0}\big{)}
n-100
\hat{\bm{\alpha}}_{\mathrm{}}
\bm{\alpha}^{(100)}
\mathbf{MSE}\big{(}\bm{\alpha}
\hat{\bm{\alpha}}_{\mathrm{}}|_{=0}\big{)}
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})-\mathbf{R}_{\mathrm{CLIP}}(t%
,X)
t
\mathbf{ID}
\lambda
\mathbf{ID}(.,.)
\lambda
\mathbf{ID}(.,.)
\mathbf{ID}(X,X_{edit})
\lambda
\lambda=0
\lambda=0.01
\lambda=0
\lambda=0.01
\lambda=0
\lambda=0.01
\bm{\alpha}\in\mathbb{R}^{n}
\bm{\alpha}
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
direction{}
\bm{\alpha}
direction{}
\bm{\alpha}
\bm{\alpha}
\mathbf{R}_{\mathrm{CLIP}}(t,X_{\mathrm{edited}})
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
{\bm{e}}_{i}
n
\bm{\alpha}
q
n
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
n
q
\bm{\phi}_{\mathrm{CLIP}}(\cdot)
D
\mathbf{1024^{2}}
\mathbf{512^{2}}
\mathbf{256^{2}}
