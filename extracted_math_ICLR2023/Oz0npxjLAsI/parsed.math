G=(V,E,X,W)
\mathcal{G}
X\in\mathbb{R}^{d\times|V|}
W\in\mathbb{R}^{d_{w}\times|E|}
X
W
G
F(G)
G
v\in V(G)
u,v
f(v)
N
\mathcal{D}=\{G_{i},y_{i}\}_{i=1}^{N}\in(\mathcal{G}\times\mathcal{Y})^{N}
\mathcal{P}
\mathcal{G}\times\mathcal{Y}
y_{i}
g(G_{i})
\ell:\mathcal{G}\times\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}
y
F(G)
F
\mathcal{F}
\mathcal{R}(F)
\min_{F\in\mathcal{F}}\;\mathbb{E}_{(G,y)\sim\mathcal{P}}[\ell(G,y,F(G))]%
\equiv\min_{F\in\mathcal{F}}\;\mathcal{R}(F).
g
\mathcal{F}
\widehat{F}\in\mathcal{F}
\mathcal{D}
\mathcal{P}
\mathcal{R}(F)
\widehat{\mathcal{R}}(F)
\widehat{F}\in\arg\min_{F\in\mathcal{F}}\;\frac{1}{N}\sum_{i=1}^{N}\ell(G_{i},%
y_{i},F(G_{i}))\equiv\arg\min_{F\in\mathcal{F}}\;\widehat{\mathcal{R}}(F).
\widehat{F}
\mathcal{R}(\widehat{F})
N
\mathcal{F}
\widehat{F}
\mathcal{Q}\neq\mathcal{P}
\operatorname{supp}(Q)\supset\operatorname{supp}(P)
\mathcal{Q}
h^{(t)}_{v}\in\mathbb{R}^{d_{t}}
v\in V
t
h^{(t)}_{v}
\displaystyle h_{v}^{(0)}=x_{v},\quad\quad\forall v\in V
\displaystyle h_{v}^{(0)}
\displaystyle=x_{v},\quad\quad\forall v\in V
\displaystyle m_{v}^{(t)}=f_{\text{Agg}}^{(t)}\big{(}h^{(t-1)}_{v},\,\{\!\!\{h%
^{(t-1)}_{u},w(u,v)\mid u\in\mathcal{N}(v)\}\!\!\}\big{)},\;1\leq t<T\qquad
\displaystyle m_{v}^{(t)}
\displaystyle=f_{\text{Agg}}^{(t)}\big{(}h^{(t-1)}_{v},\,\{\!\!\{h^{(t-1)}_{u}%
,w(u,v)\mid u\in\mathcal{N}(v)\}\!\!\}\big{)},\;1\leq t<T\qquad
\displaystyle h_{v}^{(t)}=f_{\text{Up}}(h_{v}^{(t)},m_{v}^{(t)})\qquad\quad
\displaystyle h_{v}^{(t)}
\displaystyle=f_{\text{Up}}(h_{v}^{(t)},m_{v}^{(t)})\qquad\quad
\displaystyle\text{(Update)}.
\displaystyle\text{(Update)}.
f(v)=h_{v}^{(T)},\forall v\in V
\mathcal{N}(v)\subset V
v\in V
\{\!\!\{\cdot\}\!\!\}
h^{(t)}_{v}
t
v
v
t
T
f_{\text{Agg}}^{(t)}:\mathbb{R}^{d_{t-1}}\to\mathbb{R}^{d_{t}}
\displaystyle f_{\text{Agg}}^{(t)}\Big{(}h^{(t-1)}_{v},\{\!\!\{h^{(t-1)}_{u},w%
(u,v)\mid u\in\mathcal{N}(v)\}\!\!\}\Big{)}=\phi_{1}^{(t)}\Big{(}\sum_{u\in%
\mathcal{N}(v)}\phi_{2}^{(t)}\big{(}h_{u}^{(t-1)},h_{v}^{(t-1)},w(u,v)\big{)}%
\Big{)}.
\displaystyle f_{\text{Agg}}^{(t)}\Big{(}h^{(t-1)}_{v},\{\!\!\{h^{(t-1)}_{u},w%
(u,v)\mid u\in\mathcal{N}(v)\}\!\!\}\Big{)}=\phi_{1}^{(t)}\Big{(}\sum_{u\in%
\mathcal{N}(v)}\phi_{2}^{(t)}\big{(}h_{u}^{(t-1)},h_{v}^{(t-1)},w(u,v)\big{)}%
\Big{)}.
\phi_{1},\phi_{2}
\sigma(a)=\max\{a,0\}
\sigma(a)=(1+\exp(-a))^{-1}
\displaystyle\mathrm{MLP}(h;\theta)=\sigma(W^{(M)}\ldots\sigma(W^{(2)}\sigma(W%
^{(1)}h+b^{(1)})+b^{(2)})\ldots+b^{(M)}).
\displaystyle\mathrm{MLP}(h;\theta)
\displaystyle=\sigma(W^{(M)}\ldots\sigma(W^{(2)}\sigma(W^{(1)}h+b^{(1)})+b^{(2%
)})\ldots+b^{(M)}).
\theta
W^{(j)}
b^{(j)}
f_{\text{Up}}
\displaystyle f_{\text{Up}}\Big{(}h_{v}^{(t)},m_{v}^{(t)}\Big{)}=\sigma\Big{(}%
W^{(t)}_{1}h_{v}^{(t)}+W^{(t)}_{2}m_{v}^{(t)}\Big{)}\quad\text{ or }\quad f_{%
\text{Up}}\Big{(}h_{v}^{(t)},m_{v}^{(t)}\Big{)}=m_{v}^{(t)}.
\displaystyle f_{\text{Up}}\Big{(}h_{v}^{(t)},m_{v}^{(t)}\Big{)}
\displaystyle=\sigma\Big{(}W^{(t)}_{1}h_{v}^{(t)}+W^{(t)}_{2}m_{v}^{(t)}\Big{)%
}\quad\text{ or }\quad f_{\text{Up}}\Big{(}h_{v}^{(t)},m_{v}^{(t)}\Big{)}=m_{v%
}^{(t)}.
\displaystyle F(G)=f_{\text{Read}}\big{(}\{\!\!\{h_{v}^{(T)}\mid v\in V\}\!\!%
\}\big{)}.
\displaystyle F(G)=f_{\text{Read}}\big{(}\{\!\!\{h_{v}^{(T)}\mid v\in V\}\!\!%
\}\big{)}.
n=|V|
N
A\in\mathbb{R}^{n\times n}
G\in\mathcal{G}
X\in\mathbb{R}^{n\times d}
P\in\mathbb{R}^{n\times n}
G\in\mathcal{G}
\displaystyle F(PAP^{\top},PX)=F(A,X)
\displaystyle F(PAP^{\top},PX)
\displaystyle=F(A,X)
\displaystyle f(PAP^{\top},PX,v)=f(A,X,v).
\displaystyle f(PAP^{\top},PX,v)
\displaystyle=f(A,X,v).
L
F(G)=p(L)X=Vp(\Lambda)V^{\top}X
V
\Lambda
p
l:V(G)\to\Sigma
\Sigma
(G,l)
c_{l}^{(t)}:V(G)\to\Sigma
c_{l}^{(0)}
t=0
t>0
v\in V
c_{l}^{(t)}(v)=\text{{Hash}}\left(c^{t-1}_{l}(v),\;\{\!\!\{c^{t-1}_{l}(u)\mid u%
\in\mathcal{N}(v)\}\!\!\}\right),
\Sigma
G,G^{\prime}
\{\!\!\{c_{l}^{(t)}(v)\mid v\in V(G)\}\!\!\}
\{\!\!\{c_{l}^{(t)}(u)\mid u\in V(G^{\prime})\}\!\!\}
G\neq G^{\prime}
t
t-1
\max\{|V(G)|,|V(G^{\prime})|\}
c_{l}^{(t)}(v)
h^{(t)}_{v}
G,G^{\prime}
f_{G}(G)\neq f_{G}(G^{\prime})
G\neq G^{\prime}
t
c_{l}^{(t)}\equiv h^{(t)}
f_{\text{Agg}}
S
|S|\leq M
G:\mathcal{X}^{\leq M}\to\mathbb{R}
\mathcal{X}
G(S)=\phi_{1}\Big{(}\sum\nolimits_{s\in S}\phi_{2}(s)\Big{)},
\phi_{1}:\mathbb{R}^{d_{1}}\to\mathbb{R}^{d_{2}}
\phi_{2}:\mathbb{R}^{d_{2}}\to\mathbb{R}
\sum_{s\in S}\phi(s)
\phi_{1},\phi_{2}
d_{2}
\phi_{1}
\mathbb{R}^{\leq M}
|S|\leq M
\phi_{1},\phi_{2}
d_{2}=M
d_{2}
\deg(G)
G
n
n\to\infty
h_{v}^{(t)}
\mathcal{T}(h^{(t)}_{v})
\mathcal{T}(h^{(t)}_{v})
\mathcal{T}(h^{(0)}_{v})=x_{v}
v\in V
t>0
x_{v}
u\in\mathcal{N}(v)
\mathcal{T}(h^{(t-1)}_{u})
G_{1}
G_{2}
G_{1}
G_{2}
G_{1}
G_{2}
G_{1}
G_{2}
u\neq v
\mathcal{T}(h^{(t)}_{v})=\mathcal{T}(h^{(t)}_{u})
h^{(t)}_{v}=h^{(t)}_{u}
\mathcal{F}
F\in\mathcal{F}
G,G^{\prime}
F(G)\neq F(G^{\prime})
k
v\in V
m_{v}^{(t)}=f^{(t)}_{\text{Agg}}\left(\{\!\!\{(\text{port}(u,v),\text{port}(v,%
u),h_{u}^{(t-1)})\}\!\!\}\right).
(\deg(G)+1)
H(\deg(G)+1)+\epsilon
H
1+\epsilon
f_{\text{Up}}
f_{\text{Agg}}
F
\mathcal{A}
F(G)=\mathcal{A}(G)
\mathrm{diameter}(G)
h^{(t)}_{v}
h^{(t)}_{v}
T
b
w\leq(b-\log_{2}n)/p=O(b/\log n)
T
p=\Theta(n)
Tw=\Omega(n/\log n)
T\sqrt{w}=\Omega(\sqrt{n}/\log n)
c_{f}
f
V_{1},V_{2}\subset V
c_{f}\leq\mathrm{cut}(V_{1},V_{2})\sum_{t=1}^{T}\min\{m_{t},w_{t}\}+\sum_{t=1}%
^{T}\gamma_{t}
T
w_{t}
t
m_{t}
\gamma_{t}
c_{f}=\Omega(n)
c_{f}=\Omega(n^{2})
g:\mathcal{G}\to\mathbb{R}
n\geq 1
\epsilon,\delta>0
F
G\in\mathcal{G}
\Pr(|F(G)-g(G)|\leq\epsilon)\geq 1-\delta
\exists^{\geq k}x\psi(x)
k
x
\psi
u,v\in V
u
v
V
k
s\in V^{k}
H^{(t)}\in R^{n^{k}\times d_{t}}
k
H^{(t)}_{s,:}\in\mathbb{R}^{d_{t}}
s
t
H^{(0)}\in\mathbb{R}^{n\times n\times(d+1)}
d
H^{(0)}
H^{(0)}_{v,v,1:d}=x_{v}
H^{(0)}_{u,v,1:d}=0
u\neq v
A
H^{(0)}_{:,:,(d+1)}=A
f:\mathbb{R}^{n^{k}\times(d_{0})}\to\mathbb{R}^{n^{k}\times(d_{T})}
f(G)=m\circ S_{E}\circ F^{(T)}\circ\ldots\circ F^{(1)}\circ\text{{shape}}(G),
m:\mathbb{R}^{d_{T}}\to\mathbb{R}^{d_{\text{out}}}
h^{T}_{s}
S_{E}:\mathbb{R}^{n^{k}\times d_{T}}\to\mathbb{R}^{n\times d_{T}}
S_{E}(H)_{v,:}=\sum_{s\in V^{k}:s_{1}=v}H_{s,:}
F^{(t)}:\mathbb{R}^{n^{k}\times d_{t-1}}\to\mathbb{R}^{n^{k}\times d_{t}}
S_{I}:\mathbb{R}^{n^{k}\times d_{T}}\to\mathbb{R}^{d_{T}}
S_{I}(H)=\sum_{s\in V^{k}}H_{s,:}
m
F(G)=m\circ S_{I}\circ F^{(T)}\circ\ldots\circ F^{(1)}\circ\text{{shape}(G)}.
F^{(t)}
k
k
k
0
k
k
s\in V^{k}
\mathcal{N}^{\text{WL}}_{i}(s)=\{(s_{1},s_{2},\ldots s_{i-1},v,s_{i+1},\ldots s%
_{k})\mid\forall v\in V\}
1\leq i\leq k
\displaystyle c_{i}^{(t)}(s)=\{\!\!\{c^{(t-1)}(s^{\prime})\mid s^{\prime}\in%
\mathcal{N}^{\text{WL}}_{i}(s)\}\!\!\}\;\;\quad 1\leq i\leq k,s\in V^{k}
\displaystyle c_{i}^{(t)}(s)
\displaystyle=\{\!\!\{c^{(t-1)}(s^{\prime})\mid s^{\prime}\in\mathcal{N}^{%
\text{WL}}_{i}(s)\}\!\!\}\;\;\quad 1\leq i\leq k,s\in V^{k}
\displaystyle c^{(t)}(s)=\text{{Hash}}\big{(}c^{(t-1)}(s),\,c_{1}^{(t)}(s),c_{%
2}^{(t)}(s)\ldots,c_{k}^{(t)}(s)\big{)}.
\displaystyle c^{(t)}(s)
\displaystyle=\text{{Hash}}\big{(}c^{(t-1)}(s),\,c_{1}^{(t)}(s),c_{2}^{(t)}(s)%
\ldots,c_{k}^{(t)}(s)\big{)}.
G,G^{\prime}
k
\{\!\!\{c^{(t)}(s)\mid s\in V(G)^{k}\}\!\!\}\neq\{\!\!\{c^{(t)}(s^{\prime})%
\mid s^{\prime}\in V(G^{\prime})^{k}\}\!\!\}
t
k
G\ncong G^{\prime}
k
k
\displaystyle c_{u}^{(t)}(s)=\big{(}c_{(u,s_{2},\ldots,s_{k})}^{(t-1)},c_{(s_{%
1},u,s_{3},\ldots,s_{k})}^{(t-1)},\ldots,c_{(s_{1},\ldots,s_{k-1},u)}^{(t-1)}%
\big{)},\;\forall u\in V,s\in V^{k}
\displaystyle c_{u}^{(t)}(s)
\displaystyle=\big{(}c_{(u,s_{2},\ldots,s_{k})}^{(t-1)},c_{(s_{1},u,s_{3},%
\ldots,s_{k})}^{(t-1)},\ldots,c_{(s_{1},\ldots,s_{k-1},u)}^{(t-1)}\big{)},\;%
\forall u\in V,s\in V^{k}
\displaystyle c^{(t)}(s)=\text{{Hash}}\big{(}c^{(t-1)}(s),\{\!\!\{c_{u}^{(t)}(%
s)\mid u\in V\}\!\!\}\big{)},\;\;\forall s\in V^{k}.
\displaystyle c^{(t)}(s)
\displaystyle=\text{{Hash}}\big{(}c^{(t-1)}(s),\{\!\!\{c_{u}^{(t)}(s)\mid u\in
V%
\}\!\!\}\big{)},\;\;\forall s\in V^{k}.
k\geq 2
(k+1)
k
k
(k+1)
k\geq 2
k
k
S\subseteq V
|S|=k
\mathcal{N}^{\text{set}}(S)=\{T\subset V,|T|=k\mid|S\cap T|=k-1\}
k
\displaystyle c^{(t)}(S)=\text{{Hash}}\Big{(}c^{(t-1)}(S),\{\!\!\{c^{(t-1)}(T)%
\mid T\in\mathcal{N}^{\text{set}}(S)\}\!\!\}\Big{)};
\displaystyle c^{(t)}(S)=\text{{Hash}}\Big{(}c^{(t-1)}(S),\{\!\!\{c^{(t-1)}(T)%
\mid T\in\mathcal{N}^{\text{set}}(S)\}\!\!\}\Big{)};
h_{S}^{(t+1)}=\sigma\Big{(}W_{1}^{(t)}h_{S}^{(t)}+\sum\nolimits_{T\in\mathcal{%
N}^{\text{set}}(S)}W^{(t)}_{2}h_{T}^{(t)}\Big{)},
\sigma
k
S
T
\{u,v\}=S\Delta T
k
k
h_{s}^{(t)}=f^{(t)}_{\text{Up}}\Big{(}h^{(t-1)}_{s},\sum_{v\in V}\prod_{i=1}^{%
k}f^{(t)}_{i}(h^{(t-1)}_{(s_{1},\ldots,s_{i-1},v,s_{i+1},\ldots s_{k})})\Big{)}.
k=2
H\in\mathbb{R}^{n\times n\times d_{t}}
H_{(u,v),:}=h_{(u,v)}
H^{(0)}\in\mathbb{R}^{n\times n\times(d+1)}
m_{1},m_{2}:\mathbb{R}^{d_{1}}\to\mathbb{R}^{d_{2}}
m_{3}:\mathbb{R}^{d_{1}}\to\mathbb{R}^{d_{3}}
h_{(u,v)}
H
m_{l}(H)_{(u,v),:}=m_{l}(H_{(u,v),:})
1\leq l\leq 3
H^{\prime}\in\mathbb{R}^{n\times n\times d_{2}}
m_{1},m_{2}
H^{\prime}_{:,:,i}=m_{1}(H)_{:,:,i}\cdot m_{2}(H)_{:,:,i}
(m_{3}(H),H^{\prime})\in\mathbb{R}^{n\times n\times(d_{2}+d_{3})}
k
k
(k+1)
k
k
k
F^{(t)}=\sigma\circ L^{(t)}:\mathbb{R}^{n^{k}\times d_{t-1}}\to\mathbb{R}^{n^{%
k}\times d_{t}}
L^{(t)}
\sigma
f_{1}^{(t)}:\mathbb{R}^{d_{t+1/2}}\to\mathbb{R}^{d_{t+1}}
L^{(t)}(H^{(t-1)})_{s,:}
f:\mathbb{R}^{n^{k}}\to\mathbb{R}^{n^{\ell}}
\mathrm{b}(k)
\mathrm{b}(k+\ell)
\mathrm{b}(k)
k
\mathbb{R}^{n^{k}\times d}\to\mathbb{R}^{d^{\prime}}
\mathbb{R}^{n^{k}\times d}\to\mathbb{R}^{n^{k}\times d^{\prime}}
dd^{\prime}\mathrm{b}(k)+d^{\prime}
dd^{\prime}\mathrm{b}(2k)+d^{\prime}\mathrm{b}(k)
[n]^{k}
\gamma
[k]
\gamma=\{\{1\},\{2,3\}\}
(i_{1},i_{2},i_{3})
i_{1}\neq i_{2},i_{3}
i_{2}=i_{3}
B^{\gamma}\in\{0,1\}^{n^{k}}
B^{\gamma}_{s}=1
s\in\gamma
k
k
k
H^{(0)}_{s,:}
k
s
\mathcal{F}
\mathcal{G}
\rho
F\in\mathcal{F}
G,G^{\prime}\in\mathcal{G}
(G,G^{\prime})\in\rho(\mathcal{F})\;\Leftrightarrow\;\forall F\in\mathcal{F},%
\;F(G)=F(G^{\prime}).
\displaystyle\rho(\text{MGNN})=\rho(\text{2-WL})\quad\text{\cite[cite]{[%
\@@bibref{Number}{xuhlj19}{}{}]}}
\displaystyle\rho(\text{MGNN})
\displaystyle=\rho(\text{2-WL})\quad\text{\cite[cite]{[\@@bibref{Number}{xuhlj%
19}{}{}]}}
\displaystyle\rho(k\text{-set-GNN})=\rho(\text{$k$-SWL})\quad\text{\cite[cite]%
{[\@@bibref{Number}{morris19}{}{}]}}
k
\displaystyle\rho(k\text{-set-GNN})
\displaystyle=\rho(\text{$k$-SWL})\quad\text{\cite[cite]{[\@@bibref{Number}{%
morris19}{}{}]}}
k
\displaystyle\rho(\text{$k$-LEGNN})=\rho(\text{$k$-WL})\quad\text{\cite[cite]{%
[\@@bibref{Number}{maron19,geerts20}{}{}]}}
k
k
\displaystyle\rho(\text{$k$-LEGNN})
k
\displaystyle=\rho(\text{$k$-WL})\quad\text{\cite[cite]{[\@@bibref{Number}{%
maron19,geerts20}{}{}]}}
k
\displaystyle\rho(\text{$k$-FGNN})=\rho(\text{$(k$+$1)$-WL})\quad\text{\cite[c%
ite]{[\@@bibref{Number}{maron19powerful,azizian21}{}{}]}}.
k
(k
1)
\displaystyle\rho(\text{$k$-FGNN})
k
\displaystyle=\rho(\text{$(k$+$1)$-WL})\quad\text{\cite[cite]{[\@@bibref{Numbe%
r}{maron19powerful,azizian21}{}{}]}}.
(k
1)
\rho(\text{$k$-LGNN}_{E})\subseteq\rho(\text{$k$-WL}_{E})
k
k
\Pi_{n}
A\in\mathbb{R}^{n\times n}
G
X\in\mathbb{R}^{n\times d}
F_{\text{RP}}(G)=\frac{1}{n!}\sum_{\pi\in\Pi_{n}}g(A_{\pi,\pi},X_{\pi})=g(\pi%
\cdot H^{(0)}),
X_{\pi}
X
H^{(0)}
g
A
X
g
F_{\text{RP}}(G)=\frac{1}{n!}\sum_{\pi\in\Pi_{n}}(A_{\pi,\pi},[X^{\top}_{\pi},%
I_{n}]^{\top})=\frac{1}{n!}\sum_{\pi\in\Pi_{n}}g(A,[X^{\top},(I_{n})_{\pi}]^{%
\top}),
I_{n}\in\mathbb{R}^{n\times n}
g
g
g
k
V
k
k
k
G,G^{\prime}
F(G)\neq F(G^{\prime})
G
G\setminus\{v\}
v
G
G\setminus\{v\}
\mathcal{N}_{r}(v)
r
v
G
G
(h^{\text{in}}_{u})_{u\in V(G)}
(r_{1},\ldots,r_{t})
r_{1}
G_{v}=\mathcal{N}_{r_{1}}(v)\setminus\{v\}
v\in V
h^{\text{aug}}_{u}
u\in V
v\in V
G_{v}
\displaystyle h^{\text{aug}}_{u}=(h^{\text{in}}_{u},\mathbf{1}[(u,v)\in E(G_{v%
})]);\;\,\;\forall u\in G_{v}
\displaystyle h^{\text{aug}}_{u}
\displaystyle=(h^{\text{in}}_{u},\mathbf{1}[(u,v)\in E(G_{v})]);\;\,\;\forall u%
\in G_{v}
\displaystyle({h}^{\prime}_{v,u})_{u\in G_{v}}\leftarrow\textsc{RNP-GNN}\big{(%
}G_{v},(h^{\text{aug}}_{u})_{u\in G_{v}},(r_{2},r_{3},\ldots,r_{t})\big{)}%
\quad\text{(recursion)}
\displaystyle({h}^{\prime}_{v,u})_{u\in G_{v}}
\displaystyle\leftarrow\textsc{RNP-GNN}\big{(}G_{v},(h^{\text{aug}}_{u})_{u\in
G%
_{v}},(r_{2},r_{3},\ldots,r_{t})\big{)}\quad\text{(recursion)}
\displaystyle\text{return}\qquad h^{\text{out}}_{v}=f_{\text{Agg}}^{(t)}\Big{(%
}h_{v}^{\text{in}},\{\!\!\{h^{\prime}_{v,u}:u\in G_{v}\}\!\!\}\Big{)},\;\;%
\forall v\in V\quad\quad\text{(aggregation)}.
\displaystyle\text{return}\qquad h^{\text{out}}_{v}
\displaystyle=f_{\text{Agg}}^{(t)}\Big{(}h_{v}^{\text{in}},\{\!\!\{h^{\prime}_%
{v,u}:u\in G_{v}\}\!\!\}\Big{)},\;\;\forall v\in V\quad\quad\text{(aggregation%
)}.
h^{\text{in}}_{u}
H
G
H
O(n^{k})
k
H
H
H
\mathcal{C}_{I}(\mathcal{X},\mathcal{Y})
\mathcal{X}
\mathcal{Y}
\mathcal{F}
\overline{\mathcal{F}}
K
\mathcal{C}_{I}(K,\mathbb{R}^{p})
K_{\text{disc}}\subseteq\mathcal{G}_{n}\times\mathbb{R}^{d_{0}\times n}
K\subseteq\mathbb{R}^{d_{0}\times n}
\mathcal{G}_{n}
n
\displaystyle\overline{\text{MGNN}}=\{f\in\mathcal{C}_{I}(K_{disc},\mathbb{R}^%
{p}):\rho(\text{$2$-WL})\subseteq\rho(f)\}
2
\displaystyle\overline{\text{MGNN}}
\displaystyle=\{f\in\mathcal{C}_{I}(K_{disc},\mathbb{R}^{p}):\rho(\text{$2$-WL%
})\subseteq\rho(f)\}
2
\displaystyle\overline{\text{$k$-LEGNN}}=\{f\in\mathcal{C}_{I}(K,\mathbb{R}^{p%
}):\rho(\text{$k$-WL})\subseteq\rho(f)\}
k
k
\displaystyle\overline{\text{$k$-LEGNN}}
k
\displaystyle=\{f\in\mathcal{C}_{I}(K,\mathbb{R}^{p}):\rho(\text{$k$-WL})%
\subseteq\rho(f)\}
k
\displaystyle\overline{\text{$k$-FGNN}}=\{f\in\mathcal{C}_{I}(K,\mathbb{R}^{p}%
):\rho(\text{$(k$+$1)$-WL})\subseteq\rho(f)\}.
k
(k
1)
\displaystyle\overline{\text{$k$-FGNN}}
k
\displaystyle=\{f\in\mathcal{C}_{I}(K,\mathbb{R}^{p}):\rho(\text{$(k$+$1)$-WL}%
)\subseteq\rho(f)\}.
(k
1)
\overline{\text{$k$-LEGNN}_{E}}=\{f\in\mathcal{C}_{E}(K,\mathbb{R}^{n\times p}%
):\rho(\text{$k$-LEGNN}_{E})\subseteq\rho(f)\}
k
k
\{f\in\mathcal{C}_{E}(K,\mathbb{R}^{n\times p}):\rho(\text{$k$-WL}_{E}%
\subseteq\rho(f)\}
k
\widehat{F}
\mathcal{R}(\widehat{F})
N
\mathcal{F}
\mathcal{R}(\widehat{F})-\widehat{\mathcal{R}}(\widehat{F})
\mathcal{F}
\mathcal{F}
\mathcal{F}
\mathcal{F}
p
H
n
O(p^{2}H^{2}n^{2})
\mathcal{F}
D
1-\delta
\mathcal{R}(\widehat{F})-\widehat{\mathcal{R}}(\widehat{F})\leq O\left(\sqrt{%
\frac{D}{N}\log\frac{N}{D}}\right)+\sqrt{\frac{1}{2N}\log\frac{1}{\delta}}.
n^{2}
\widehat{\mathfrak{R}}_{S}(\mathcal{F})
\mathcal{F}
\sigma=(\sigma_{1},\ldots,\sigma_{N})
\{-1,+1\}
\widehat{\mathfrak{R}}_{S}(\mathcal{F})=\mathbb{E}_{\sigma}\left[\sup_{F\in%
\mathcal{F}}\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}F(x_{i})\right],
S=\{x_{1},\ldots,x_{N}\}
\widehat{\mathfrak{R}}_{S}(\mathcal{F})
\mathbb{P}[\text{error}(F)]\leq\widehat{\mathcal{R}}(F)+2\widehat{\mathfrak{R}%
}_{S}(\mathcal{J})+3\sqrt{\frac{\log(2/\delta)}{2N}}
\mathcal{J}
F\in\mathcal{F}
h^{(t)}_{v}=\phi(W_{1}x_{v}+W_{2}\rho(\sum_{u\in N(v)}g(h^{(t-1)}_{u})))
\phi,\rho,g
\|W_{1}\|_{F},\|W_{2}\|_{F}\leq B
\frac{\gamma+1}{2}
\mathcal{C}
\phi,\rho,g
B
T
w
h^{(t)}_{v}
d
\widetilde{O}(\frac{wd}{\sqrt{N}\gamma})
\mathcal{C}<1/d
\widetilde{O}(\frac{wdT}{\sqrt{N}\gamma})
\mathcal{C}=1/d
\widetilde{O}(\frac{wd\sqrt{wT}}{\sqrt{N}\gamma})
\mathcal{C}>1/d
d
\max_{v\in G}\deg(v)-1
d=1
H=w
n>d
p
W
w^{2}
\tilde{O}(w^{3}n/\sqrt{N})
F(\theta,G)
F(\theta,G)
L(\theta)=\sum_{i=1}^{N}\ell(F(\theta,G_{i}),y_{i})=\frac{1}{2}\sum_{i=1}^{N}(%
F(\theta,G_{i})-y_{i})^{2}
\theta\in\mathbb{R}^{m}
\frac{d\theta(t)}{dt}=-\nabla L(\theta(t))
u(t)=(F(\theta(t),G_{i}))_{i=1}^{N}
\frac{du}{dt}=-H(t)(u(t)-\mathbf{y}),\text{ where }H(t)_{ij}=\Big{\langle}%
\frac{\partial F(\theta(t),G_{i})}{\partial\theta},\frac{\partial F(\theta(t),%
G_{j})}{\partial\theta}\Big{\rangle}.
\mathbf{y}=(y_{i})_{i=1}^{N}
\theta
H(t)\in\mathbb{R}^{N\times N}
t
\theta(0)
H(0)
\widetilde{H}
F_{\widetilde{H}}(G)
N
\ell:\mathbb{R}\times\mathbb{R}\to[0,1]
\ell(y,y)=0
1-\delta
\mathcal{R}(F_{\widetilde{H}})=O\Big{(}\tfrac{1}{N}\sqrt{\mathbf{y}^{\top}%
\widetilde{H}^{-1}\mathbf{y}\cdot\operatorname{tr}(\widetilde{H})}+\sqrt{%
\tfrac{1}{N}\log(1/\delta)}\Big{)}.
\mathbf{y}^{\top}\widetilde{H}^{-1}\mathbf{y}
\bar{h}_{v}=c_{v}\sum_{u\in\mathcal{N}(v)\cup\{v\}}h_{u}
y_{i}
1\leq i\leq N
y_{i}=\alpha_{1}\sum_{v\in V(G_{i})}\beta_{1}^{\top}\bar{h}_{v}+\sum_{l=1}^{%
\infty}\alpha_{2l}\sum_{v\in V}\big{(}\beta_{2l}^{\top}\bar{h}_{v}\big{)}^{2l}
\alpha_{k}\in\mathbb{R},\beta_{k}\in\mathbb{R}^{d}
\mathbf{y}^{\top}\widetilde{H}^{-1}\mathbf{y}\leq 2|\alpha_{1}|\cdot\|\beta_{1%
}\|_{2}+\sum_{l=1}^{\infty}\sqrt{2\pi}(2l-1)|\alpha_{2l}|\cdot\|\beta_{2l}\|_{%
2}^{2l}
n=\max_{i}V(G_{i})
\operatorname{tr}(\widetilde{H})=O(n^{2}N)
t
w(u,v)
\text{BF: }\;d[t][v]=\min_{u\in\mathcal{N}(v)}\;d[t-1][u]+w(u,v)\quad\text{GNN%
: }\;h^{(t)}_{v}=\sum_{u\in\mathcal{N}(v)}\mathrm{MLP}(h^{(t-1)}_{u},h^{(t-1)}%
_{v},w(u,v)).
\{(x_{i},y_{i})\}_{i=1}^{N}
\mathcal{P}
y_{i}=g(x_{i})
g
f=\mathcal{A}(\{x_{i},y_{i}\}_{i=1}^{N})
\mathcal{A}
\epsilon
1-\delta
g
(N,\epsilon,\delta)
\mathcal{A}
\mathbb{P}_{x\sim\mathcal{P}}\big{[}|f(x)-g(x)|<\epsilon\,\big{]}\geq 1-\delta.
\mathcal{C}_{\mathcal{A}}(g,\epsilon,\delta)
N
g
(N,\epsilon,\delta)
\mathcal{A}
g
\mathcal{N}
M
\mathcal{N}_{i}
f_{1},...,f_{M}
g
\mathcal{N}
\mathcal{N}_{i}
f_{i}
\mathcal{N}
g
\mathcal{N}
(N,\epsilon,\delta)
g
f_{1},...,f_{M}
g
\mathcal{A}_{i}
f_{i}
\mathcal{N}_{i}
M\cdot\max_{i}C_{\mathcal{A}_{i}}(f_{i},\epsilon,\delta)\leq N
\epsilon
\delta
\left\{G_{i},y_{i}\right\}_{i=1}^{N}\sim\mathcal{P}
\lvert V(G_{i})\rvert\leq n
y_{i}=g(G_{i})
g
\mathcal{N}_{1},...,\mathcal{N}_{M}
\mathcal{N}
\mathcal{N}
g
(N,\epsilon,\delta)
f_{1},...,f_{M}
M
g
(N,O(\epsilon),O(\delta))
\mathcal{N}
\mathcal{N}_{i}
\mathcal{N}_{1}
\{\hat{x}_{i}^{(1)},f_{1}(\hat{x}_{i}^{(1)})\}_{i=1}^{N}
\hat{x}_{i}^{(1)}
G_{i}
j>1
\hat{x}_{i}^{(j)}
\mathcal{N}_{j}
f_{j-1},...,f_{1}
\hat{x}_{i}^{(1)}
\mathcal{A}
\mathcal{N}_{i}
f=\mathcal{A}(\left\{x_{i},y_{i}\right\}_{i=1}^{N})
\hat{f}=\mathcal{A}(\left\{\hat{x}_{i},y_{i}\right\}_{i=1}^{N})
x
\|f(x)-\hat{f}(x)\|\leq L_{0}\cdot\max_{i}\|x_{i}-\hat{x}_{i}\|
L_{0}<\infty
\hat{f}_{j}
\|\hat{f}_{j}(x)-\hat{f}_{j}(\hat{x})\|\leq L_{1}\|x-\hat{x}\|
L_{1}<\infty
O
\mathcal{P}
\mathbb{E}_{G\sim\mathcal{Q}}[\ell(G,g(G),F(G))]
\mathcal{Q}
\operatorname{supp}(\mathcal{Q})\supset\operatorname{supp}(\mathcal{P})
\mathcal{Q}
\operatorname{supp}(\mathcal{Q})\setminus\operatorname{supp}(\mathcal{P})
\mathcal{P}
\mathcal{Q}
\mathcal{P}
\mathcal{Q}
t
v
c^{(t)}(v)
\mathcal{P}
\mathcal{Q}
\mathcal{P}^{t}
c^{(t)}(v)
\mathcal{P}
\mathcal{Q}^{t}
\mathcal{Q}
\mathcal{Q}
\mathcal{Q}^{t}\setminus\mathcal{P}^{t}
t
t+3
\mathcal{P}
\mathcal{Q}
t+2
\max\{(\max\deg(G)+1)^{t}\cdot|C|,2\sqrt{|P|}\}
|C|
P
\mathcal{Q}
\mathcal{P}
\operatorname{supp}(\mathcal{P})
f:\mathbb{R}^{d}\rightarrow\mathbb{R}
v\in\mathbb{R}^{d}
x_{0}=tv
t\rightarrow\infty
f(x_{0}+hv)-f(x_{0})\rightarrow\beta_{v}\cdot h
h>0
\beta_{v}
\epsilon>0
t=O(\frac{1}{\epsilon})
|\frac{f(x_{0}+hv)-f(x_{0})}{h}-\beta_{v}|<\epsilon
v
\displaystyle h_{u}^{(t)}=\max_{v\in\mathcal{N}(u)}\text{MLP}^{(t)}\big{(}h_{u%
}^{(t-1)},h_{v}^{(t-1)},w_{(v,u)}\big{)}.
\displaystyle h_{u}^{(t)}=\max_{v\in\mathcal{N}(u)}\text{MLP}^{(t)}\big{(}h_{u%
}^{(t-1)},h_{v}^{(t-1)},w_{(v,u)}\big{)}.
n
t
t+1
\mathcal{Q}
\mathcal{P}
\mathcal{Q}
k
k
