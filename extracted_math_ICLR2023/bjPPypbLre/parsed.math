19\%
({\mathbf{x}},y)
f_{\mathbf{w}}:{\mathbb{R}}^{n}\rightarrow{\mathbb{R}}^{c}
{\mathbf{x}}
y\in\mathbb{R}^{c}
{\mathbf{x}}+\mathbf{\Delta x}
\ell_{p}
{\mathbf{x}}
\max_{\|\mathbf{\Delta x}\|_{p}\leq\epsilon}L({\mathbf{x}}+\mathbf{\Delta x},y%
,{\mathbf{w}})
\epsilon
\epsilon\cdot\mathrm{sgn}(\nabla_{{\mathbf{x}}}L({\mathbf{x}},y,{\mathbf{w}}))
\mathbf{\Delta x}
p=\infty
{\mathbf{w}}
p(\mathbf{w}|\mathcal{D})\propto p(\mathcal{D}|\mathbf{w})p(\mathbf{w})
\mathcal{D}
{\mathbf{x}}
p(y|{\mathbf{x}},\mathcal{D})=\int_{{\mathbf{w}}}p(y|{\mathbf{x}},{\mathbf{w}}%
)p({\mathbf{w}}|\mathcal{D})d{\mathbf{w}},
p(y|{\mathbf{x}},{\mathbf{w}})
{\mathbf{w}}
\operatorname*{arg\,min}_{\|\mathbf{\Delta x}\|_{p}\leq\epsilon}p(y|{\mathbf{x%
}}+\mathbf{\Delta x},\mathcal{D})=\operatorname*{arg\,min}_{\|\mathbf{\Delta x%
}\|_{p}\leq\epsilon}\int_{{\mathbf{w}}}p(y|{\mathbf{x}}+\mathbf{\Delta x},{%
\mathbf{w}})p({\mathbf{w}}|\mathcal{D})d{\mathbf{w}}.
p(y|{\mathbf{x}},\mathcal{D})\approx\frac{1}{M}\sum_{i}p(y|{\mathbf{x}},{%
\mathbf{w}}_{i})
M
{\mathbf{w}}_{i}
p({\mathbf{w}}|\mathcal{D})
\operatorname*{arg\,min}_{\|\mathbf{\Delta x}\|_{p}\leq\epsilon}\frac{1}{M}%
\sum_{i=1}^{M}p(y|{\mathbf{x}}+\mathbf{\Delta x},{\mathbf{w}}_{i})=%
\operatorname*{arg\,max}_{\|\mathbf{\Delta x}\|_{p}\leq\epsilon}\frac{1}{M}%
\sum_{i=1}^{M}L({\mathbf{x}}+\mathbf{\Delta x},y,{\mathbf{w}}_{i}),%
\operatorname{s.t.}{\mathbf{w}}_{i}\sim p({\mathbf{w}}|\mathcal{D}).
L(\cdot,\cdot,{\mathbf{w}}_{i})
\mathbf{w}_{i}
\mathcal{N}(\hat{\mathbf{w}},\sigma^{2}\mathbf{I})
\hat{\mathbf{w}}
\sigma
\hat{\mathbf{w}}
\max_{\hat{\mathbf{w}}}\frac{1}{N}\sum_{i=1}^{N}\mathbb{E}_{{\mathbf{w}}\sim%
\mathcal{N}(\hat{\mathbf{w}},\sigma^{2}\mathbf{I})}p(y_{i}|{\mathbf{x}}_{i},{%
\mathbf{w}}).
\min_{\hat{\mathbf{w}}}\frac{1}{MN}\sum_{i=1}^{N}\sum_{j=1}^{M}L({\mathbf{x}}_%
{i},y_{i},\hat{\mathbf{w}}+\mathbf{\Delta w}_{j}),\,\operatorname{s.t.}\,%
\mathbf{\Delta w}_{j}\sim{\mathcal{N}}(\mathbf{0},\sigma^{2}\mathbf{I}).
\min_{\hat{\mathbf{w}}}\max_{\mathbf{\Delta w}}\frac{1}{N}\sum_{i=1}^{N}L({%
\mathbf{x}}_{i},y_{i},\hat{\mathbf{w}}+\mathbf{\Delta w}),\,\operatorname{s.t.%
}\,\mathbf{\Delta w}\sim{\mathcal{N}}(\mathbf{0},\sigma^{2}\mathbf{I})\ %
\mathrm{and}\ p(\mathbf{\Delta w})\geq\varepsilon,
\varepsilon
\displaystyle\min_{\hat{\mathbf{w}}}\max_{\mathbf{\Delta w}}{\textstyle\frac{1%
}{N}\sum_{i=1}^{N}}L({\mathbf{x}}_{i},y_{i},\hat{\mathbf{w}})+\mathbf{\Delta w%
}^{T}\nabla_{\hat{\mathbf{w}}}{\textstyle\frac{1}{N}\sum_{i=1}^{N}}L({\mathbf{%
x}}_{i},y_{i},\hat{\mathbf{w}}),
\displaystyle\min_{\hat{\mathbf{w}}}\max_{\mathbf{\Delta w}}{\textstyle\frac{1%
}{N}\sum_{i=1}^{N}}L({\mathbf{x}}_{i},y_{i},\hat{\mathbf{w}})+\mathbf{\Delta w%
}^{T}\nabla_{\hat{\mathbf{w}}}{\textstyle\frac{1}{N}\sum_{i=1}^{N}}L({\mathbf{%
x}}_{i},y_{i},\hat{\mathbf{w}}),
\displaystyle\operatorname{s.t.}\,\mathbf{\Delta w}\sim{\mathcal{N}}(\mathbf{0%
},\sigma^{2}\mathbf{I})\,\,\,\mathrm{and}\,\,\,p(\mathbf{\Delta w})\geq\varepsilon.
\displaystyle\operatorname{s.t.}\,\mathbf{\Delta w}\sim{\mathcal{N}}(\mathbf{0%
},\sigma^{2}\mathbf{I})\,\,\,\mathrm{and}\,\,\,p(\mathbf{\Delta w})\geq\varepsilon.
\mathbf{\Delta w}
\mathbf{\Delta w}^{*}=\lambda_{\varepsilon,\sigma}\nabla_{\hat{\mathbf{w}}}%
\frac{1}{N}\sum_{i=1}^{N}L({\mathbf{x}}_{i},y_{i},\hat{\mathbf{w}})/\|\nabla_{%
\hat{\mathbf{w}}}\frac{1}{N}\sum_{i=1}^{N}L({\mathbf{x}}_{i},y_{i},\hat{%
\mathbf{w}})\|_{2}
\lambda_{\varepsilon,\sigma}
\nabla_{\hat{\mathbf{w}}}\frac{1}{N}\sum_{i=1}^{N}L({\mathbf{x}}_{i},y_{i},%
\hat{\mathbf{w}})+\mathbf{H}\mathbf{\Delta w}^{*}
\mathbf{H}
\nabla_{\hat{\mathbf{w}}}\frac{1}{N}\sum_{i=1}^{N}L({\mathbf{x}}_{i},y_{i},%
\hat{\mathbf{w}})+(1/\gamma)(\nabla_{\hat{\mathbf{w}}}\frac{1}{N}\sum_{i=1}^{N%
}L({\mathbf{x}}_{i},y_{i},\hat{\mathbf{w}}+\gamma\mathbf{\Delta w}^{*})-\nabla%
_{\hat{\mathbf{w}}}\frac{1}{N}\sum_{i=1}^{N}L({\mathbf{x}}_{i},y_{i},\hat{%
\mathbf{w}}))
\gamma
\sigma
\ell_{\infty}
\epsilon=4/255
\sigma
\ell_{\infty}
\epsilon=4/255
\sigma
\hat{\mathbf{w}}
\mathcal{N}(\hat{\mathbf{w}},\sigma^{2}\mathbf{I})
\sigma\rightarrow 0
\sigma
0
\sigma>0
\sigma=0.012
+5.71\%
+14.30\%
+21\%
\sigma=0.009
100
90.59\%
91.68\%
91.91\%
92.65\%
\ell_{\infty}
\epsilon=4/255
\ell_{\infty}
\epsilon=4/255
\ell_{\infty}
\epsilon=4/255
\ell_{\infty}
\epsilon=4/255
{\mathbf{w}}\sim{\mathcal{N}}({\mathbf{w}}_{\mathrm{SWA}},\mathbf{\Sigma}_{%
\mathrm{SWAG}})
\mathbf{\Sigma}_{\mathrm{SWAG}}=\frac{1}{2}(\mathbf{\Sigma}_{\mathrm{diag}}+%
\mathbf{\Sigma}_{\mathrm{low-rank}})
{\mathbf{w}}_{\mathrm{SWA}}
{\mathbf{w}}
{\mathbf{w}}\sim\mathcal{N}({\mathbf{w}}_{\mathrm{SWA}},\mathbf{\Sigma}_{%
\mathrm{SWAG}}+\beta\mathbf{I})
\beta=\sigma^{2}
\ell_{\infty}
\epsilon=8/255
\ell_{\infty}
\epsilon=8/255
\ell_{\infty}
\epsilon=4/255
\epsilon=8/255
5000
[0.0,1.0]
20
50
1/255
\gamma=0.1/\|\mathbf{\Delta w}^{*}\|_{2}
0.05
0.001
\lambda_{\varepsilon,\sigma}=2
\lambda_{\varepsilon,\sigma}=0.2
\lambda_{\varepsilon,\sigma}=1
\sigma=0.009
\sigma=0.002
1.5
\ell_{\infty}
\epsilon=4/255
\ell_{\infty}
\epsilon=4/255
91.33\%
19.05\%
27.36\%
7.43\%
57.52\%
36.23\%
\ell_{\infty}
\epsilon=8/255
91.33\%
46.58\%
57.52\%
\ell_{\infty}
\epsilon=8/255
\ell_{\infty}
\epsilon=8/255
\epsilon=4/255
\epsilon/10
50
\ell_{\infty}
\epsilon=4/255
10
\ell_{\infty}
\epsilon=4/255
10
\mathbf{29.25\%}
\ell_{\infty}
\epsilon=16/255
9.74\%
16.06\%
17.64\%
\ell_{\infty}
\epsilon=8/255
\ell_{\infty}
\epsilon=8/255
94.65\%
32\%
84.44\%
\epsilon=8/255
\epsilon=8/255
\ell_{\infty}
\epsilon=8/255
\ell_{\infty}
\epsilon=8/255
\lambda_{\varepsilon,\sigma}
\lambda_{\varepsilon,\sigma}
\lambda_{\varepsilon,\sigma}
\lambda_{\varepsilon,\sigma}\in\{0,0.01,0.05,0.1,0.2,0.5,1,1.5,2\}
\lambda_{\varepsilon,\sigma}
\lambda
\epsilon=8/255
\lambda
\epsilon=8/255
\epsilon=8/255
\epsilon=8/255
3\times 3
7\times 7
5
3
0.2
30
50
20
