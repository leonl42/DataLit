K
\mathcal{T}^{1}
\mathcal{T}^{2}
\mathcal{L}_{\text{coord}}
\mathcal{L}_{\text{giou}}
\mathcal{L}_{\text{LocSCE}}
K
\mathcal{T}^{1}
\mathcal{T}^{2}
\mathcal{L}_{\text{coord}}
\mathcal{L}_{\text{giou}}
\mathcal{L}_{\text{LocSCE}}
{\mathbf{x}}=\{{\mathbf{x}}_{i}\}_{i=1}^{N_{b}}
{\mathbf{x}}_{i}
i
N_{b}
{\mathbf{x}}_{i}
\mathcal{T}^{1}
\mathcal{T}^{2}
{{\mathbf{x}}_{i}}^{\prime}=t^{1}({\mathbf{x}}_{i})
t^{1}\sim\mathcal{T}^{1}
{{\mathbf{x}}_{i}}^{\prime\prime}=t^{2}(t^{1}({\mathbf{x}}_{i}))
t^{2}\sim\mathcal{T}^{2}
K
{\mathbf{b}}^{SS}_{i}=\{{\mathbf{b}}^{SS}_{(i,j)}\in\mathbb{R}^{4}\}_{j=1}^{K}
{{\mathbf{x}}_{i}}^{\prime}
{\mathbf{y}}_{i}=\{{\mathbf{y}}_{(i,j)}\}_{j=1}^{N}=\{({\mathbf{z}}_{(i,j)},{%
\mathbf{b}}_{(i,j)}\}_{j=1}^{N}
{\mathbf{z}}_{(i,j)}
{\mathbf{b}}_{(i,j)}
j
\hat{{\mathbf{y}}}_{i}=\{\hat{{\mathbf{y}}}_{(i,j)}\}_{j=1}^{N}=\{(\hat{{%
\mathbf{z}}}_{(i,j)},\hat{{\mathbf{b}}}_{(i,j)}\}_{j=1}^{N}
{{\mathbf{x}}_{i}}^{\prime\prime}
N
\mathfrak{S}_{N}
\hat{\sigma}_{i}^{\text{prop}}
\hat{{\mathbf{y}}}_{i}
{\mathbf{y}}_{i}
\hat{\sigma}_{i}^{\text{prop}}=\arg\min_{\sigma\in\mathfrak{S}_{N}}\sum_{j=1}^%
{N}\mathcal{L}_{\text{prop\_match}}({\mathbf{y}}_{(i,j)},\hat{{\mathbf{y}}}_{(%
i,\sigma(j))}).
{\mathbf{x}}_{i}
j
{\mathbf{y}}_{(i,j)}
\hat{\sigma}_{i}^{\text{prop}}(j)
\hat{{\mathbf{y}}}_{(i,\hat{\sigma}_{i}^{\text{prop}}(j))}
\mathcal{L}_{\text{prop\_match}}
\mathcal{L}_{\text{sim}}({\mathbf{z}}_{(i,j)},\hat{{\mathbf{z}}}_{(i,\sigma(j)%
)})=\frac{\langle{\mathbf{z}}_{(i,j)},\hat{{\mathbf{z}}}_{(i,\sigma(j))}%
\rangle}{\|{\mathbf{z}}_{(i,j)}\|_{2}\cdot\|\hat{{\mathbf{z}}}_{(i,\sigma(j))}%
\|_{2}}
\ell_{1}
\mathcal{L}_{\text{coord}}=\|{\mathbf{b}}_{(i,j)}-\hat{{\mathbf{b}}}_{(i,\hat{%
\sigma}_{i}(j))}\|_{1}
\mathcal{L}_{\text{giou}}
\displaystyle\begin{split}\mathcal{L}_{\text{prop\_match}}({\mathbf{y}}_{(i,j)%
},\hat{{\mathbf{y}}}_{(i,\sigma(j))})&=\Bigl{[}\lambda_{\text{sim}}\mathcal{L}%
_{\text{sim}}\left({\mathbf{z}}_{(i,j)},\hat{{\mathbf{z}}}_{(i,\sigma(j))}%
\right)\\
&+\lambda_{\text{coord}}\mathcal{L}_{\text{coord}}\left({\mathbf{b}}_{(i,j)},%
\hat{{\mathbf{b}}}_{(i,\sigma(j))}\right)+\lambda_{\text{giou}}\mathcal{L}_{%
\text{giou}}\left({\mathbf{b}}_{(i,j)},\hat{{\mathbf{b}}}_{(i,\sigma(j))}%
\right)\Bigr{]}.\end{split}
\displaystyle\begin{split}\mathcal{L}_{\text{prop\_match}}({\mathbf{y}}_{(i,j)%
},\hat{{\mathbf{y}}}_{(i,\sigma(j))})&=\Bigl{[}\lambda_{\text{sim}}\mathcal{L}%
_{\text{sim}}\left({\mathbf{z}}_{(i,j)},\hat{{\mathbf{z}}}_{(i,\sigma(j))}%
\right)\\
&+\lambda_{\text{coord}}\mathcal{L}_{\text{coord}}\left({\mathbf{b}}_{(i,j)},%
\hat{{\mathbf{b}}}_{(i,\sigma(j))}\right)+\lambda_{\text{giou}}\mathcal{L}_{%
\text{giou}}\left({\mathbf{b}}_{(i,j)},\hat{{\mathbf{b}}}_{(i,\sigma(j))}%
\right)\Bigr{]}.\end{split}
\hat{\sigma}_{i}^{\text{box}}\in\mathfrak{S}_{N}
\hat{{\mathbf{b}}}_{i}
{\mathbf{b}}^{SS}_{i}
\mathcal{L}_{\text{box\_match}}
\displaystyle\hat{\sigma}_{i}^{\text{box}}=\arg\min_{\sigma\in\mathfrak{S}_{N}%
}\sum_{j=1}^{N}\mathcal{L}_{\text{box\_match}}({\mathbf{y}}_{(i,j)},\hat{{%
\mathbf{y}}}_{(i,\sigma(j))}),
\displaystyle\hat{\sigma}_{i}^{\text{box}}
\displaystyle=\arg\min_{\sigma\in\mathfrak{S}_{N}}\sum_{j=1}^{N}\mathcal{L}_{%
\text{box\_match}}({\mathbf{y}}_{(i,j)},\hat{{\mathbf{y}}}_{(i,\sigma(j))}),
\displaystyle\mathcal{L}_{\text{box\_match}}({\mathbf{b}}^{SS}_{(i,j)},\hat{{%
\mathbf{b}}}_{(i,\sigma(j))})=\lambda_{\text{coord}}\mathcal{L}_{\text{coord}}%
\left({\mathbf{b}}^{SS}_{(i,j)},\hat{{\mathbf{b}}}_{(i,\sigma(j))}\right)+%
\lambda_{\text{giou}}\mathcal{L}_{\text{giou}}\left({\mathbf{b}}^{SS}_{(i,j)},%
\hat{{\mathbf{b}}}_{(i,\sigma(j))}\right).
\displaystyle\mathcal{L}_{\text{box\_match}}({\mathbf{b}}^{SS}_{(i,j)},\hat{{%
\mathbf{b}}}_{(i,\sigma(j))})
\displaystyle=\lambda_{\text{coord}}\mathcal{L}_{\text{coord}}\left({\mathbf{b%
}}^{SS}_{(i,j)},\hat{{\mathbf{b}}}_{(i,\sigma(j))}\right)+\lambda_{\text{giou}%
}\mathcal{L}_{\text{giou}}\left({\mathbf{b}}^{SS}_{(i,j)},\hat{{\mathbf{b}}}_{%
(i,\sigma(j))}\right).
\mathcal{L}_{u}
\displaystyle\begin{split}\mathcal{L}_{u}({\mathbf{x}})&=\lambda_{\text{%
contrast}}\mathcal{L}_{\text{LocSCE}}\left({\mathbf{y}},\hat{{\mathbf{y}}},%
\hat{\sigma}^{\text{prop}}\right)+\\
&\frac{1}{N_{b}K}\sum_{i=1}^{N_{b}}\Bigl{[}\sum_{j=1}^{K}\lambda_{\text{coord}%
}\mathcal{L}_{\text{coord}}\left({\mathbf{b}}^{SS}_{(i,j)},\hat{{\mathbf{b}}}_%
{(i,\hat{\sigma}^{\text{box}}_{i}(j))}\right)+\sum_{j=1}^{K}\lambda_{\text{%
giou}}\mathcal{L}_{\text{giou}}\left({\mathbf{b}}^{SS}_{(i,j)},\hat{{\mathbf{b%
}}}_{(i,\hat{\sigma}^{\text{box}}_{i}(j))}\right)\Bigr{]}.\end{split}
\displaystyle\begin{split}\mathcal{L}_{u}({\mathbf{x}})&=\lambda_{\text{%
contrast}}\mathcal{L}_{\text{LocSCE}}\left({\mathbf{y}},\hat{{\mathbf{y}}},%
\hat{\sigma}^{\text{prop}}\right)+\\
&\frac{1}{N_{b}K}\sum_{i=1}^{N_{b}}\Bigl{[}\sum_{j=1}^{K}\lambda_{\text{coord}%
}\mathcal{L}_{\text{coord}}\left({\mathbf{b}}^{SS}_{(i,j)},\hat{{\mathbf{b}}}_%
{(i,\hat{\sigma}^{\text{box}}_{i}(j))}\right)+\sum_{j=1}^{K}\lambda_{\text{%
giou}}\mathcal{L}_{\text{giou}}\left({\mathbf{b}}^{SS}_{(i,j)},\hat{{\mathbf{b%
}}}_{(i,\hat{\sigma}^{\text{box}}_{i}(j))}\right)\Bigr{]}.\end{split}
\lambda_{\text{sim}},\lambda_{\text{coord}},\lambda_{\text{giou}},\lambda_{%
\text{contrast}}\in\mathbb{R}
\mathcal{L}_{\text{LocSCE}}
\hat{{\mathbf{y}}}=\{\hat{{\mathbf{y}}}_{i}\}_{i=1}^{N_{b}}
{\mathbf{y}}=\{{\mathbf{y}}_{i}\}_{i=1}^{N_{b}}
\hat{\sigma}^{\text{prop}}=\{\hat{\sigma}_{i}^{\text{prop}}\}_{i=1}^{N_{b}}
\delta
\delta
{\mathbf{x}}_{i}
\sigma_{i}^{\text{prop}}
\displaystyle p_{(in,jm)}^{\prime}=\frac{\mathds{1}_{i\neq n}\mathds{1}_{j\neq
m%
}\exp({\mathbf{z}}_{(i,j)}\cdot{\mathbf{z}}_{(n,m)}/\tau_{t})}{\sum_{k=1}^{N_{%
b}}\sum_{l=1}^{N}\mathds{1}_{i\neq k}\mathds{1}_{j\neq l}\exp({\mathbf{z}}_{(i%
,j)}\cdot{\mathbf{z}}_{(k,l)}/\tau_{t})},
\displaystyle p_{(in,jm)}^{\prime}
\displaystyle=\frac{\mathds{1}_{i\neq n}\mathds{1}_{j\neq m}\exp({\mathbf{z}}_%
{(i,j)}\cdot{\mathbf{z}}_{(n,m)}/\tau_{t})}{\sum_{k=1}^{N_{b}}\sum_{l=1}^{N}%
\mathds{1}_{i\neq k}\mathds{1}_{j\neq l}\exp({\mathbf{z}}_{(i,j)}\cdot{\mathbf%
{z}}_{(k,l)}/\tau_{t})},
\displaystyle p_{(in,jm)}^{\prime\prime}=\frac{\exp({\mathbf{z}}_{(i,j)}\cdot%
\hat{{\mathbf{z}}}_{(n,m)}/\tau)}{\sum_{k=1}^{N_{b}}\sum_{l=1}^{N}\exp({%
\mathbf{z}}_{(i,j)}\cdot\hat{{\mathbf{z}}}_{(k,l)}/\tau)}.
\displaystyle p_{(in,jm)}^{\prime\prime}
\displaystyle=\frac{\exp({\mathbf{z}}_{(i,j)}\cdot\hat{{\mathbf{z}}}_{(n,m)}/%
\tau)}{\sum_{k=1}^{N_{b}}\sum_{l=1}^{N}\exp({\mathbf{z}}_{(i,j)}\cdot\hat{{%
\mathbf{z}}}_{(k,l)}/\tau)}.
p_{(in,jm)}^{\prime}
\tau_{t}
p_{(in,jm)}^{\prime\prime}
\tau
w_{(in,jm)}=\lambda_{\text{SCE}}\cdot\mathds{1}_{i=n}\mathds{1}_{j=m}+(1-%
\lambda_{\text{SCE}})\cdot p_{(in,jm)}^{\prime}.
w_{(in,jm)}^{\text{Loc}}=\lambda_{\text{SCE}}\cdot\mathds{1}_{i=n}\mathds{1}_{%
IoU_{i}(j,m)\geq\delta}+(1-\lambda_{\text{SCE}})\cdot p_{(in,jm)}^{\prime},
IoU_{i}(j,m)
{\mathbf{y}}_{(i,j)}
{\mathbf{y}}_{(i,m)}
{\mathbf{x}}_{i}
\delta
\mathcal{L}_{\text{LocSCE}}({\mathbf{y}},\hat{{\mathbf{y}}},\hat{\sigma}^{%
\text{prop}})=-\frac{1}{N_{b}N}\sum_{i=1}^{N_{b}}\sum_{n=1}^{N_{b}}\sum_{j=1}^%
{N}\sum_{m=1}^{N}w^{\text{Loc}}_{(in,jm)}\log(p_{(in,j\hat{\sigma}_{n}^{\text{%
prop}}(m))}^{\prime\prime}).
\hat{\sigma}^{\text{prop}}
\delta=1
N_{b}\cdot N
\delta=0.5
N_{b}=64
\lambda_{\text{sim}}=\lambda_{\text{contrast}}=2
\tau=0.1,\tau_{t}=0.07
\lambda_{\text{SCE}}=0.5
K=30
\lambda_{\text{coord}}=5
\lambda_{\text{giou}}=2
N=300
lr=2\cdot 10^{-4}
\mathcal{T}^{1}
\mathcal{T}^{2}
\mathcal{T}^{1}
\delta
\forall\delta<1
\delta=1
\delta=0.5
\tau_{t}\in\{0.05,0.07\}
\tau_{t}=0.07
\delta
\delta
\delta
\tau_{t}
\mathcal{T}^{1}
\in\{400,500,600\}
\mathcal{T}^{2}
\tau
\mathcal{L}_{\text{InfoNCE}}({\mathbf{z}},\hat{{\mathbf{z}}},\hat{\sigma}^{%
\text{prop}})=-\frac{1}{N_{b}N}\sum_{i=1}^{N_{b}}\sum_{j=1}^{N}\log\left(\frac%
{\exp({\mathbf{z}}_{(i,j)}\cdot\hat{{\mathbf{z}}}_{(i,\hat{\sigma}_{i}^{\text{%
prop}}(j))}/\tau)}{\sum_{k=1}^{N_{b}}\sum_{l=1}^{N}\exp({\mathbf{z}}_{(i,j)}%
\cdot\hat{{\mathbf{z}}}_{(k,l)}/\tau)}\right).
N_{b}\cdot N
\mathcal{L}_{\text{LocNCE}}({\mathbf{y}},\hat{{\mathbf{z}}},\hat{\sigma}^{%
\text{prop}})=-\frac{1}{N_{b}N}\sum_{i=1}^{N_{b}}\sum_{j=1}^{N}\sum_{m=1}^{N}%
\mathds{1}_{IoU_{i}(j,m)\geq\delta}\log\left(\frac{\exp({\mathbf{z}}_{(i,j)}%
\cdot\hat{{\mathbf{z}}}_{(i,\hat{\sigma}_{i}^{\text{prop}}(m))}/\tau)}{\sum_{k%
=1}^{N_{b}}\sum_{l=1}^{N}\exp({\mathbf{z}}_{(i,j)}\cdot\hat{{\mathbf{z}}}_{(k,%
l)}/\tau)}\right).
\delta
\text{AP}_{50}
\text{AP}_{75}
\text{AP}_{50}
\text{AP}_{75}
\text{AP}_{50}
\text{AP}_{75}
\text{AP}_{50}
\text{AP}_{75}
\text{AP}_{50}
\text{AP}_{75}
\text{AP}_{50}
\text{AP}_{75}
N
N
N=300
N
1\times
\text{AP}_{50}
\text{AP}_{75}
1\times
\text{AP}_{50}
\text{AP}_{75}
1\times
\text{AP}_{50}
\text{AP}_{75}
5.42\pm 0.01
8.43\pm 0.03
17.01\pm 0.01
20.98\pm 0.01
6.83\pm 0.15
9.05\pm 0.16
18.47\pm 0.22
23.86\pm 0.81
\mathbf{8.95}\pm\mathbf{0.51}
\textbf{12.96}\pm\textbf{0.08}
\textbf{23.59}\pm\textbf{0.21}
\textbf{28.55}\pm\textbf{0.08}
