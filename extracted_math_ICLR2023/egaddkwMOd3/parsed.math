\hat{G}
\hat{G}
({\mathcal{S}},{\mathcal{A}},{\mathcal{P}},{\mathcal{R}})
{\mathbf{s}}\in{\mathcal{S}}
{\mathbf{a}}\in{\mathcal{A}}
{\mathcal{P}}({\mathbf{s}}^{\prime}|{\mathbf{s}},{\mathbf{a}})
r={\mathcal{R}}({\mathbf{s}},{\mathbf{a}})
\pi:{\mathcal{S}}\rightarrow{\mathcal{A}}
\mathbb{E}_{\tau\sim\pi}\big{[}G(\tau)\big{]}
G(\tau)=\sum_{t=0}^{H}r_{t}
{\mathcal{D}}
\tau=({\mathbf{s}}_{0},{\mathbf{a}}_{0},r_{0},\ldots,{\mathbf{s}}_{H},{\mathbf%
{a}}_{H},r_{H})
\mu
({\mathbf{s}}_{i},{\mathbf{a}}_{i},G_{i})
G_{i}=\sum_{t=i}^{H}r_{i}
({\mathbf{s}}_{i},{\mathbf{a}}_{i})
E:\mathbb{R}^{D}\rightarrow\mathbb{R}
\hat{y}=\arg\min_{\mathbf{y}}E_{\theta}(x,y)
({\mathbf{x}},{\mathbf{y}})
p_{\bm{\theta}}({\mathbf{y}}|{\mathbf{x}})=\frac{\exp(-E_{\bm{\theta}}({%
\mathbf{x}},{\mathbf{y}}))}{Z_{\bm{\theta}}}
E_{\bm{\theta}}
Z_{\bm{\theta}}=\int_{\mathbf{y}}\exp(-E_{\bm{\theta}}({\mathbf{x}},{\mathbf{y%
}}))d{\mathbf{y}}
\displaystyle{\mathcal{L}}({\bm{\theta}})=\sum_{i=1}^{N}-\log(\tilde{p}_{\bm{%
\theta}}({\mathbf{y}}_{i}\mid{\mathbf{x}},\{\tilde{{\mathbf{y}}}_{i}^{j}\}_{j=%
1}^{N_{\text{neg.}}}))
\displaystyle{\mathcal{L}}({\bm{\theta}})
\displaystyle=\sum_{i=1}^{N}-\log(\tilde{p}_{\bm{\theta}}({\mathbf{y}}_{i}\mid%
{\mathbf{x}},\{\tilde{{\mathbf{y}}}_{i}^{j}\}_{j=1}^{N_{\text{neg.}}}))
\displaystyle\tilde{p}_{\bm{\theta}}({\mathbf{y}}_{i}\mid{\mathbf{x}},\{\tilde%
{{\mathbf{y}}}_{i}^{j}\}_{j=1}^{N_{\text{neg.}}})=\frac{\exp({-E_{\bm{\theta}}%
({\mathbf{x}}_{i},{\mathbf{y}}_{i})})}{\exp({-E_{\bm{\theta}}({\mathbf{x}}_{i}%
,{\mathbf{y}}_{i})})+\sum_{j=1}^{N_{\text{neg.}}}\exp({-E_{\bm{\theta}}({%
\mathbf{x}}_{i},\tilde{{\mathbf{y}}}^{j}_{i})})}.
\displaystyle\tilde{p}_{\bm{\theta}}({\mathbf{y}}_{i}\mid{\mathbf{x}},\{\tilde%
{{\mathbf{y}}}_{i}^{j}\}_{j=1}^{N_{\text{neg.}}})
\displaystyle=\frac{\exp({-E_{\bm{\theta}}({\mathbf{x}}_{i},{\mathbf{y}}_{i})}%
)}{\exp({-E_{\bm{\theta}}({\mathbf{x}}_{i},{\mathbf{y}}_{i})})+\sum_{j=1}^{N_{%
\text{neg.}}}\exp({-E_{\bm{\theta}}({\mathbf{x}}_{i},\tilde{{\mathbf{y}}}^{j}_%
{i})})}.
\{\tilde{{\mathbf{y}}}_{i}^{j}\}_{j=1}^{N_{\text{neg.}}}
\tilde{{\mathbf{y}}}_{i}^{j}=\arg\min_{{\mathbf{y}}}E_{\bm{\theta}}({\mathbf{x%
}}_{i},{\mathbf{y}})
\hat{{\mathbf{y}}}=\arg\min_{{\mathbf{y}}\in{\mathcal{Y}}}E_{\bm{\theta}}({%
\mathbf{x}},{\mathbf{y}})
\mathbb{E}_{{\mathbf{s}},{\mathbf{a}}\sim{\mathcal{D}}}\big{[}({\mathbf{a}}-f_%
{\bm{\theta}}({\mathbf{s}}))^{2}\big{]}
\mu
p_{\bm{\theta}}({\mathbf{a}}|{\mathbf{s}})=\frac{\exp(-E_{\bm{\theta}}({%
\mathbf{s}},{\mathbf{a}}))}{Z_{\bm{\theta}}}.
\hat{{\mathbf{a}}}=\arg\min_{{\mathbf{a}}\in{\mathcal{A}}}E_{\bm{\theta}}({%
\mathbf{s}},{\mathbf{a}}).
\displaystyle p_{\bm{\theta}}({\mathbf{a}},G|{\mathbf{s}})=\frac{\exp(-E_{\bm{%
\theta}}({\mathbf{s}},{\mathbf{a}},G))}{Z_{\bm{\theta}}}.
\displaystyle p_{\bm{\theta}}({\mathbf{a}},G|{\mathbf{s}})=\frac{\exp(-E_{\bm{%
\theta}}({\mathbf{s}},{\mathbf{a}},G))}{Z_{\bm{\theta}}}.
p_{\bm{\theta}}({\mathbf{a}},G\mid{\mathbf{s}})
G
G
\displaystyle p_{\bm{\theta}}({\mathbf{a}},G\mid{\mathbf{s}}_{t};\eta)=p_{\bm{%
\theta}}({\mathbf{a}},G\mid{\mathbf{s}}_{t})\exp(\eta^{-1}G-\kappa(\eta)),
\displaystyle p_{\bm{\theta}}({\mathbf{a}},G\mid{\mathbf{s}}_{t};\eta)
\displaystyle=p_{\bm{\theta}}({\mathbf{a}},G\mid{\mathbf{s}}_{t})\exp(\eta^{-1%
}G-\kappa(\eta)),
\kappa(\eta)
\log\mathbb{E}[e^{\eta^{-1}G}]
\eta
\displaystyle\hat{{\mathbf{a}}},\hat{G}=\operatorname*{arg\,min}_{{\mathbf{a}}%
\in{\mathcal{A}},G\in{\mathcal{G}}}E_{\bm{\theta}}({\mathbf{s}},{\mathbf{a}},G%
)-\eta^{-1}G,
\displaystyle\hat{{\mathbf{a}}},\hat{G}=\operatorname*{arg\,min}_{{\mathbf{a}}%
\in{\mathcal{A}},G\in{\mathcal{G}}}E_{\bm{\theta}}({\mathbf{s}},{\mathbf{a}},G%
)-\eta^{-1}G,
\kappa(\eta)
\kappa(\eta)
\eta^{-1}=0
a=\arctan\frac{\Delta y}{\Delta x}
\eta^{-1}=0
a=\arctan\frac{\Delta y}{\Delta x}
\eta^{-1}=5.0
\pi/4
\eta^{-1}=5.0
\pi/4
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
(\Delta_{x},\Delta_{y})
a=\arctan\frac{\Delta y}{\Delta x}
\eta^{-1}=0
\eta^{-1}
\pi/4
Q
Q
Q
Q
Q
\eta^{-1}
\eta^{-1}
p({\mathbf{a}}|{\mathbf{s}},G)
G
p(G\mid{\mathbf{s}})
\hat{G}_{t}=\arg\max_{G}p(G\mid{\mathbf{s}}_{t})\exp(\eta^{-1}G-\kappa(\eta))
\hat{{\mathbf{a}}}=\arg\max_{\mathbf{a}}p_{\bm{\theta}}({\mathbf{a}}\mid{%
\mathbf{s}}_{t},\hat{G}_{t}).
p_{\bm{\theta}}({\mathbf{a}},G|{\mathbf{s}})
p_{\bm{\theta}}({\mathbf{a}}\mid{\mathbf{s}}_{t},\hat{G}_{t})
p_{\bm{\theta}}(\hat{G}_{t}\mid{\mathbf{s}}_{t})
{\mathbf{s}}
[-1,1]^{D}
[-0.1,0.1]^{D}
3\times D
{\mathbf{a}}^{*}=g^{*}-{\mathbf{s}}
D
g^{*}
g
[-0.1,0.1]^{D}
\epsilon
[-\delta,\delta]
\delta
\delta
\delta
\eta^{-1}
G
G
[-1,1]
10^{6}
2\times 10^{6}
~{}10^{5}
\eta^{-1}=1
\eta
\eta^{-1}=10
\eta
\eta^{-1}=1
\eta^{-1}=1
\eta^{-1}=10
\eta^{-1}=1
\eta^{-1}=10
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}=0
\eta^{-1}
\eta^{-1}=1
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}=0
\eta^{-1}
\eta^{-1}=1
\eta^{-1}>0
\eta^{-1}
\eta^{-1}=0
\eta^{-1}
\eta^{-1}
\eta^{-1}
\eta^{-1}=1
\eta^{-1}
\eta
\eta^{-1}
{\mathbf{s}}
{\mathbf{a}}\sim{\mathcal{U}}({\mathbf{a}}_{\text{min}},{\mathbf{a}}_{\text{%
max}})
G\sim{\mathcal{U}}(-1,1)
\alpha
i\in\{1,\ldots,100\}
g\leftarrow\nabla_{({\mathbf{a}},G)}E_{\theta}({\mathbf{s}},{\mathbf{a}},G)
u\leftarrow\text{clip}(\frac{1}{2}g+\epsilon,-0.5,0.5)
\epsilon\sim{\mathcal{N}}(0,1)
({\mathbf{a}},G)\leftarrow({\mathbf{a}},G)-\alpha u
({\mathbf{s}},{\mathbf{a}},G)
\eta^{-1}=10
