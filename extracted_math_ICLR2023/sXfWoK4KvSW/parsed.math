\rho=100
q=0.05
\rho=100
q=0.05
32.03\%
\log\mathbb{P}_{train}(y)
\mathcal{X}
\mathcal{Y}=\{1,2,...,C\}
\mathcal{S}
\mathcal{Y}
\mathcal{S}=2^{\mathcal{Y}}-\emptyset
\mathcal{D}_{train}=\{(\bm{x}_{i},y_{i},S_{i})\}_{i=1}^{N}\in(\mathcal{X},%
\mathcal{Y},\mathcal{S})^{N}
\bm{x}_{i}
S_{i}\subset\mathcal{Y}
y_{i}\in S_{i}
N_{c}
c\in\mathcal{Y}
f(\bm{x};\theta)
\theta
x
\bm{x}
z(\bm{x})=g(f(\bm{x};\theta);\bm{W})=\bm{W}^{\top}f(\bm{x};\theta)
g
\bm{W}
\Theta=[\theta,\bm{W}]
\mathcal{D}_{uni}=\{(\bm{x}_{i},y_{i})\}
\Theta
\mathcal{D}_{train}
\mathcal{D}_{uni}
\min_{\Theta}\mathrm{BER}(\Theta)\overset{\mathbb{P}_{uni}(y)=\frac{1}{C}}{=}%
\mathbb{P}_{(\bm{x},y)\in\mathcal{D}_{uni}}(y\neq\arg\!\max_{y^{\prime}\in%
\mathcal{Y}}z^{y^{\prime}}(\bm{x})).
\bm{w}
\bm{w}
\bm{w}
\mathbb{P}(y|\bm{x})\propto\mathbb{P}(\bm{x}|y)\cdot\mathbb{P}(y)
\mathrm{softmax}(z^{y}(\bm{x}))=\mathbb{P}_{train}(y|\bm{x})
z_{uni}
\mathrm{softmax}(z_{uni}^{y}(\bm{x}))=\mathbb{P}_{uni}(y|\bm{x})\propto\mathbb%
{P}(\bm{x}|y)\cdot\mathbb{P}_{uni}(y)
\mathbb{P}_{uni}(y)=\frac{1}{C}
\displaystyle\begin{split}\mathbb{P}_{uni}(y|\bm{x})&\propto\mathbb{P}(\bm{x}|%
y)\cdot\mathbb{P}_{train}(y)~{}/~{}\mathbb{P}_{train}(y)\\
&\propto\mathbb{P}_{train}(y|\bm{x})~{}/~{}\mathbb{P}_{train}(y)\\
&\propto\mathrm{softmax}(z^{y}(\bm{x})-\log\mathbb{P}_{train}(y)).\\
\end{split}
\displaystyle\begin{split}\mathbb{P}_{uni}(y|\bm{x})&\propto\mathbb{P}(\bm{x}|%
y)\cdot\mathbb{P}_{train}(y)~{}/~{}\mathbb{P}_{train}(y)\\
&\propto\mathbb{P}_{train}(y|\bm{x})~{}/~{}\mathbb{P}_{train}(y)\\
&\propto\mathrm{softmax}(z^{y}(\bm{x})-\log\mathbb{P}_{train}(y)).\\
\end{split}
z^{y}(\bm{x})
z_{uni}^{y}(\bm{x})=z^{y}(\bm{x})-\log\mathbb{P}_{train}(y)
\log\mathbb{P}_{train}(y)
z_{uni}^{y}(\bm{x})
\mathbb{P}(\bm{x}|y)
\mathbb{P}_{train}(y)
{z}_{uni}
z
\bm{w}
\mathbb{P}_{train}(y|\bm{x};\Theta)
\mathbb{P}_{uni}(y|\bm{x};\Theta)
\mathbb{P}_{uni}(y|\bm{x};\Theta)
\mathbb{P}_{train}(y|\Theta)
\mathbb{P}_{train}(y)
\bm{w}
\mathbb{P}_{train}(y|\bm{x};\Theta)
\mathbb{P}_{uni}(y|\bm{x};\Theta)
\mathbb{P}_{uni}(y|\bm{x};\Theta)
\mathbb{P}_{train}(y|\Theta)
\mathbb{P}_{train}(y)
\mathbb{P}_{train}(y)
\begin{split}\mathbb{P}_{uni}(y|\bm{x};\Theta)&\propto{\mathbb{P}}(\bm{x}|y;%
\Theta)\cdot{\mathbb{P}}_{train}(y|\Theta)~{}/~{}\mathbb{P}_{train}(y|\Theta)%
\\
&\propto\mathbb{P}_{train}(y|\bm{x};\Theta)~{}/~{}\mathbb{P}_{train}(y|\Theta)%
\\
&\propto\mathrm{softmax}(z^{y}(\bm{x})-\log{\mathbb{P}_{train}(y|\Theta)}),%
\end{split}
{\mathbb{P}}_{uni}(y|\bm{x};\Theta)
{\mathbb{P}}_{train}(y|\Theta)
{\mathbb{P}}_{train}(y)
{\mathbb{P}}(\bm{x}|y;\Theta)
{\mathbb{P}}(\bm{x}|y)
{\mathbb{P}}(\bm{x}|y;\Theta)
{\mathbb{P}}_{train}(y|\Theta)
{\mathbb{P}}_{train}(y|\Theta)=\mathbb{E}_{\bm{x}_{i}\in\mathcal{D}_{train}}%
\mathbb{P}_{train}(y|\bm{x};\Theta)
\mathrm{softmax}
\begin{split}{\mathbb{P}}_{train}(y|\Theta)=\mathbb{E}_{\bm{x}_{i}\in\mathcal{%
D}_{train}}\mathrm{softmax}(z^{y}(\bm{x}_{i}))&\overset{{NWGM}}{\approx}%
\mathrm{softmax}(\mathbb{E}_{\bm{x}_{i}\in\mathcal{D}_{train}}z^{y}(\bm{x}_{i}%
))\\
&=\mathrm{softmax}(g^{y}(\mathbb{E}_{\bm{x}_{i}\in\mathcal{D}_{train}}f(\bm{x}%
_{i};\theta);\bm{W})).\end{split}
\mathbb{P}_{train}(y|\Theta)
{\mathbb{P}}_{train}(y|\Theta)
F
F\leftarrow mF+(1-m)\mathbb{E}_{\bm{x}_{i}\in Batch}f(\bm{x}_{i};\theta),
m\in[0,1)
\mathbb{E}_{\bm{x}_{i}\in\mathcal{D}_{train}}f(\bm{x}_{i};\theta)
F
\begin{split}z_{uni}^{y}(\bm{x})&=z^{y}(\bm{x})-\log{\mathbb{P}}_{train}(y|%
\Theta)=z^{y}(\bm{x})-\log\mathrm{softmax}(g^{y}(F;\bm{W})).\end{split}
\mathbb{P}_{train}(y|\bm{x};\Theta)
\mathbb{P}_{uni}(y|\bm{x};\Theta)
\mathbb{P}_{train}(y|\Theta)
\mathbb{P}_{train}(y)
\mathbb{P}_{train}(y_{j})=\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},\mathcal{Y})}%
\mathds{1}(y=y_{j}),y_{j}\in\mathcal{Y}
\mathds{1}(\cdot)
H
h_{\Theta}\in H:\mathcal{X}\rightarrow\mathcal{Y}
\Theta
h=g\circ f
h_{\Theta}
\mathbb{P}_{train}(y_{j}|\Theta)=\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},%
\mathcal{Y})}\mathds{1}(h_{\Theta}(\bm{x})=y_{j}),y_{j}\in\mathcal{Y}
(\bm{x},y,S)
\tilde{y}(\bm{x},S)\in S
\mathcal{D}_{train}
R^{\mathcal{D}_{train}}(\Theta)=\frac{1}{N}\sum_{i=1}^{N}\mathds{1}(h_{\Theta}%
(\bm{x}_{i})\neq\tilde{y}(\bm{x}_{i},S_{i}))
\eta=\sup_{(\bm{x},y)\in\mathcal{X}\times\mathcal{Y},y_{j}\in\mathcal{Y},y_{j}%
\neq y}\mathbb{P}_{S|(\bm{x},y)}(y_{j}\in S)
d_{H}
H
\tilde{h}=h_{\tilde{\Theta}}
\tilde{\Theta}=\operatorname*{arg\,min}_{\Theta}R^{\mathcal{D}_{train}}({%
\Theta})
\eta\in[0,1)
\forall\delta>0
L_{2}
\mathbb{P}_{train}(y)
\mathbb{P}_{train}(y|\tilde{\Theta})
\tilde{h}
L_{2}\left({\tilde{h}}\right)<\frac{4}{(\ln 2-\ln(1+\eta))N}(d_{H}(\ln 2N+2\ln
C%
)-\ln\delta+\ln 2)
1-\delta
N
C
L_{2}
\mathbb{P}_{train}(y|\Theta)
\mathbb{P}_{train}(y)
L_{2}
L_{2}
L_{2}
\rho=100
q=0.03
L_{2}
\rho=100
q=0.03
\rho
q
\rho=100
q\in\{0.03,0.05,0.07\}
\rho=100
q\in\{0.03,0.05,0.07\}
q=0.03
q=0.05
q=0.07
\rho\in\{50,100\}
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y)=q
256
0.9
0.001
m
0.9
0.01
800
6.45\%
25.68\%
3.86\%
7.60\%
32.03\%
\rho=100
>
100
[20,100]
<
20
\rho=100
\rho=100
q\in\{0.3,0.5,0.7\}
\rho=100
q\in\{0.3,0.5,0.7\}
\rho=100
q\in\{0.03,0.05,0.07\}
\rho=100
q\in\{0.03,0.05,0.07\}
q=0.03
q=0.05
q=0.07
\rho
q
\rho
q
m
m
\rho=100
q=0.05
m
\rho=100
q=0.05
\rho=100
q=0.05
m
\rho=100
q=0.05
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y,D(\overline{y})\neq D(y))=q,%
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y,D(\overline{y})=D(y))=8q
D(y)
y
\rho=100
q\in\{0.03,0.05,0.07\}
\rho=100
q=0.05
\mathbb{P}_{train}(y)
0
1
m
m
m=0.9
m
m=0
m=1.0
\bm{w}
\bm{w}
\bm{w}
\bm{w}
w
\bm{w}
\sum_{j\in\mathcal{Y}}{\bm{w}}_{i,j}\ell(z^{j}(\bm{x}_{i}))
{\bm{w}}_{i,j}=\frac{\exp(z^{j}(\bm{x}_{i}))}{\sum_{k\in S_{i}}\exp(z^{k}(\bm{%
x}_{i}))},\ \text{if}\ j\in S_{i}
{\bm{w}}_{i,j}=0,\ \text{if}\ j\notin S_{i}
\sum_{j\in S_{i}}{\bm{w}}_{i,j}\ell(z^{j}(\bm{x}_{i}))+
{\bm{w}}_{i,j}=\frac{\exp(z^{j}(\bm{x}_{i}))}{\sum_{k\in S_{i}}\exp(z^{k}(\bm{%
x}_{i}))},\ \text{if}\ j\in S_{i}
\beta\sum_{j\notin S_{i}}{\bm{w}}_{i,j}\ell(-z^{j}(\bm{x}_{i}))
{\bm{w}}_{i,j}=\frac{\exp(z^{j}(\bm{x}_{i}))}{\sum_{k\notin S_{i}}\exp(z^{k}(%
\bm{x}_{i}))},\ \text{if}\ j\notin S_{i}
\sum_{j\in\mathcal{Y}}{\bm{w}}_{i,j}\ell(z^{j}(\bm{x}_{i}))
{\bm{w}}_{i,j}=1,\ \text{if}\ j=\arg\!\max_{j\in S_{i}}\left\lvert z^{j}(\bm{x%
}_{i})-1\right\rvert z^{j}(\bm{x}_{i})
{\bm{w}}_{i,j}=0,\ \text{else}
\lambda D_{\mathrm{KL}}(z(\bm{x}_{i})\|{\bm{w}}_{i})+
{\bm{w}}_{i,j}=\frac{(\prod_{\bm{x}^{\prime}\in A(\bm{x}_{i})}\exp(z^{j}(\bm{x%
}^{\prime})))^{\frac{1}{\left\lvert A(\bm{x}_{i})\right\rvert}}}{\sum_{k\in%
\mathcal{Y}}(\prod_{\bm{x}^{\prime}\in A(\bm{x}_{i})}\exp(z^{k}(\bm{x}^{\prime%
})))^{\frac{1}{\left\lvert A(\bm{x}_{i})\right\rvert}}},\ \text{if}\ j\in S_{i}
\sum_{j\notin S_{i}}\ell(-z^{j}(\bm{x}_{i}))
{\bm{w}}_{i,j}=0,\ \text{if}\ j\notin S_{i}
\mathbb{P}_{train}(y)
\mathcal{D}_{uni}=\{(\bm{x}_{i},y_{i})\}
\mathbb{P}_{uni}(y|\bm{x})\propto\mathbb{P}(\bm{x}|y)
\mathbb{P}_{uni}(y)=\frac{1}{C}
\mathcal{D}_{train}
\mathcal{D}_{uni}
\min_{\Theta}\mathrm{BER}(\Theta)\overset{\mathbb{P}_{uni}(y)=\frac{1}{C}}{=}%
\mathbb{P}_{(\bm{x},y)\in\mathcal{D}_{uni}}(y\neq\arg\!\max_{y^{\prime}\in%
\mathcal{Y}}z^{y^{\prime}}(\bm{x})).
z
\mathrm{softmax}(z^{y}(\bm{x}))=\mathbb{P}_{train}(y|\bm{x})\propto\mathbb{P}(%
\bm{x}|y)\cdot\mathbb{P}_{train}(y)
z_{uni}
\mathrm{softmax}(z_{uni}^{y}(\bm{x}))=\mathbb{P}_{uni}(y|\bm{x})
z
\begin{split}&\mathrm{softmax}(z^{y}(\bm{x}))=\mathbb{P}_{train}(y|\bm{x})%
\propto\mathbb{P}(\bm{x}|y)\cdot\mathbb{P}_{train}(y)\\
&\mathbb{P}_{uni}(y|\bm{x})\propto\mathbb{P}(\bm{x}|y)\propto\mathrm{softmax}(%
z^{y}(\bm{x})-\log\mathbb{P}_{train}(y)).\end{split}
z^{y}(\bm{x})
z_{uni}^{y}(\bm{x})=z^{y}(\bm{x})-\log\mathbb{P}_{train}(y)
\log\mathbb{P}_{train}(y)
z_{uni}^{y}(\bm{x})
\mathbb{P}(\bm{x}|y)
\mathbb{P}_{train}(y)
\mathcal{D}_{train}
f
g
\mathcal{A}
T
\theta
\bm{W}
\bm{w}
F
0
t=1,2,\ldots,T
\mathcal{D}_{train}
B
k=1,2,\ldots,B
z
\mathcal{D}_{k}
F
L_{\mathcal{A}}
\mathcal{A}
z_{uni}
\bm{w}
z_{uni}
\mathcal{A}
\theta
\bm{W}
L_{\mathcal{A}}
L_{2}(h)
h\in H
L_{2}
\mathbb{P}_{train}(y)
\mathbb{P}_{train}(y|\Theta)
h
\Theta
L_{2}(h)\leq 2\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},\mathcal{Y})}\mathds{1}(h%
(\bm{x})\neq y)).
\begin{split}L_{2}(h)&=\sqrt{\sum_{y_{j}=1}^{C}\left\lvert\mathbb{E}_{(\bm{x},%
y)\sim(\mathcal{X},\mathcal{Y})}(\mathds{1}(y=y_{j})-\mathds{1}(h(\bm{x})=y_{j%
}))\right\rvert^{2}}\\
&\leq\sum_{y_{j}=1}^{C}\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},\mathcal{Y})}%
\left\lvert\mathds{1}(y=y_{j})-\mathds{1}(h(\bm{x})=y_{j})\right\rvert\end{split}
(\bm{x},y)
h(\bm{x})=y
h
\bm{x}
\forall y_{j}\in\{1,2,\ldots,C\}
\left\lvert\mathds{1}(y=y_{j})-\mathds{1}(h(\bm{x})=y_{j})\right\rvert=0
h(\bm{x})\neq y
\left\lvert\mathds{1}(y=y_{j})-\mathds{1}(h(\bm{x})=y_{j})\right\rvert=\begin{%
cases}1,\quad&y_{j}=y\ \text{or}\ y_{j}=h(\bm{x})\\
0,\quad&else\end{cases}
L_{2}(h)
L_{2}(h)\leq 2\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},\mathcal{Y})}\mathds{1}(h%
(\bm{x})\neq y))
R
{\mathcal{D}_{train}}
\epsilon
L_{2}
h
R=\{{\mathcal{D}_{train}}\in(\mathcal{X},\mathcal{Y},\mathcal{S})^{N}:\exists h%
,L_{2}(h)\geq\epsilon,R^{\mathcal{D}_{train}}(h)=0\}
\mathcal{D}_{train}^{\prime}\in(\mathcal{X},\mathcal{Y},\mathcal{S})^{N}
M
({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})
h
\mathcal{D}_{train}
\epsilon
L_{2}
\frac{\epsilon N}{4}
\mathcal{D}_{train}^{\prime}
M=\{({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})\in(\mathcal{X},%
\mathcal{Y},\mathcal{S})^{2N}:\exists h,L_{2}(h)\geq\epsilon,R^{\mathcal{D}_{%
train}}(h)=0,\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})\geq%
\frac{\epsilon N}{4}\}
N>\frac{16\ln{2}}{{\epsilon}}
\mathbb{P}({\mathcal{D}_{train}}\in R)<2\mathbb{P}(({\mathcal{D}_{train}},%
\mathcal{D}_{train}^{\prime})\in M).
\begin{split}&\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})%
\in M)\\
=&\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})\in M|{%
\mathcal{D}_{train}}\in R)\cdot\mathbb{P}({\mathcal{D}_{train}}\in R)\\
=&\mathbb{P}(\exists h,L_{2}(h)\geq\epsilon,R^{\mathcal{D}_{train}}(h)=0,\sum_%
{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})\geq\frac{\epsilon N}{4}%
|{\mathcal{D}_{train}}\in R)\cdot\mathbb{P}({\mathcal{D}_{train}}\in R)\\
\geq&\mathbb{P}(\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})%
\geq\frac{\epsilon N}{4}|L_{2}(h)\geq\epsilon,R^{\mathcal{D}_{train}}(h)=0)%
\cdot\mathbb{P}({\mathcal{D}_{train}}\in R)\\
\end{split}
L_{2}(h)\geq\epsilon
\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},\mathcal{Y})}\mathds{1}(h(\bm{x})\neq y%
)\geq\frac{{\epsilon}}{2}
N>\frac{16\ln{2}}{{\epsilon}}
\begin{split}&\mathbb{P}(\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{%
\prime})\geq\frac{\epsilon N}{4})\\
=&1-\mathbb{P}(\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})<%
\frac{\epsilon N}{4})\\
\geq&1-\mathbb{P}(\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})<%
(1-\frac{1}{2})\mathbb{E}_{(\bm{x}^{\prime},y^{\prime})\sim(\mathcal{X},%
\mathcal{Y})}\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime}))\\
\geq&1-e^{-\frac{N\mathbb{E}_{(\bm{x},y)\sim(\mathcal{X},\mathcal{Y})}\mathds{%
1}(h(\bm{x})\neq y)}{8}}\\
\geq&1-e^{-\frac{N{\epsilon}}{16}}>\frac{1}{2}\end{split}
\mathbb{P}({\mathcal{D}_{train}}\in R)
\mathbb{P}({\mathcal{D}_{train}}\in R)<2\mathbb{P}(({\mathcal{D}_{train}},%
\mathcal{D}_{train}^{\prime})\in M)
H
d_{H}
\eta<1
\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})\in M)<(2N)^{d_%
{\mathcal{H}}}C^{2d_{\mathcal{H}}}(\frac{1+\eta}{2})^{\frac{{\epsilon}N}{4}}
{\mathcal{D}_{train}}
\mathcal{D}_{train}^{\prime}
{\mathcal{D}_{train}}=(\bm{x}^{N},y^{N},S^{N})\in(\mathcal{X},\mathcal{Y},%
\mathcal{S})^{N},\mathcal{D}_{train}^{\prime}=(\bm{x}^{\prime N},y^{\prime N},%
S^{\prime N})\in(\mathcal{X},\mathcal{Y},\mathcal{S})^{N}
\begin{split}\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})%
\in M)&=\mathbb{E}\ \mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{%
\prime})\in M|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\\
\end{split}
\mathbb{E}
(\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})
\mathbb{P}
(S^{N},S^{\prime N})
(\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})
H|(\bm{x}^{N},\bm{x}^{\prime N})
{\mathcal{D}_{train}}
\mathcal{D}_{train}^{\prime}
\begin{split}&\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})%
\in M|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\\
\leq&\sum_{h\in H|(\bm{x}^{N},\bm{x}^{\prime N})}\mathbb{P}(R^{\mathcal{D}_{%
train}}(h)=0,\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})\geq%
\frac{\epsilon N}{4}|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\end{split}
\begin{split}&\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})%
\in M|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\\
\leq&\sum_{h\in H|(\bm{x}^{N},\bm{x}^{\prime N})}\mathbb{P}(R^{\mathcal{D}_{%
train}}(h)=0,\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})\geq%
\frac{\epsilon N}{4}|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\end{split}
{\mathcal{D}_{train}}
\mathcal{D}_{train}^{\prime}
n
G
\sigma\in G
J_{\sigma}\subseteq\{1,2,\ldots,n\}
\left\lvert G\right\rvert=2^{N},\sigma({\mathcal{D}_{train}},\mathcal{D}_{%
train}^{\prime})=(\mathcal{D}_{train}^{\sigma},\mathcal{D}_{train}^{\prime%
\sigma})
a_{1},a_{2}
h
{\mathcal{D}_{train}}
\mathcal{D}_{train}^{\prime}
b_{1},b_{2}
h
\begin{split}&\mathbb{P}(R^{\mathcal{D}_{train}}(h)=0,\sum_{i=1}^{N}\mathds{1}%
(h(\bm{x}^{\prime})\neq y^{\prime})\geq\frac{\epsilon N}{4}|\bm{x}^{N},y^{N},%
\bm{x}^{\prime N},y^{\prime N})\\
=&\mathds{1}(\sum_{i=1}^{N}\mathds{1}(h(\bm{x}^{\prime})\neq y^{\prime})\geq%
\frac{\epsilon N}{4})\cdot\prod_{i=1}^{N}\mathbb{P}(h(\bm{x}_{i})=\tilde{y}(%
\bm{x}_{i},S_{i})|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\\
=&\mathds{1}(a_{2}\geq\frac{{\epsilon}N}{4})\cdot\prod_{i=1}^{N}\mathbb{P}(h(%
\bm{x}_{i})=\tilde{y}(\bm{x}_{i},S_{i})|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{%
\prime N})\end{split}
\prod_{i=1}^{N}\mathbb{P}(h(\bm{x}_{i})=\tilde{y}(\bm{x}_{i},S_{i})|\bm{x}^{N}%
,y^{N},\bm{x}^{\prime N},y^{\prime N})
\begin{split}\prod_{i=1}^{N}\mathbb{P}(h(\bm{x}_{i})=\tilde{y}(\bm{x}_{i},S_{i%
})|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\leq\prod_{i=1}^{N}\mathbb{%
P}(h(\bm{x}_{i})\in S_{i}|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\leq%
\eta^{a_{1}}\end{split}
\begin{split}&\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})%
\in M)\\
=&\mathbb{E}\ \mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})%
\in M|\bm{x}^{N},y^{N},\bm{x}^{\prime N},y^{\prime N})\\
=&\mathbb{E}\ \frac{1}{{2}^{N}}\sum_{\sigma\in G}\mathbb{P}(\sigma({\mathcal{D%
}_{train}},\mathcal{D}_{train}^{\prime})\in M|\bm{x}^{N},y^{N},\bm{x}^{\prime N%
},y^{\prime N})\\
\leq&\mathbb{E}\ \frac{1}{{2}^{N}}\sum_{\sigma\in G}\sum_{h\in H|\sigma(x,\bm{%
x}^{\prime})}\mathbb{P}(R^{\mathcal{D}_{train}}(h)=0,\sum_{i=1}^{N}\mathds{1}(%
h(\bm{x}^{\prime})\neq y^{\prime})\geq\frac{\epsilon N}{4}|\bm{x}^{N},y^{N},%
\bm{x}^{\prime N},y^{\prime N})\\
\leq&\mathbb{E}\ (2N)^{d_{\mathcal{H}}}C^{2d_{\mathcal{H}}}\frac{1}{{2}^{N}}%
\sum_{\sigma\in G}\mathds{1}(a_{2}^{\sigma}\geq\frac{{\epsilon}N}{4})\eta^{a_{%
1}^{\sigma}}\\
\leq&\mathbb{E}\ (2N)^{d_{\mathcal{H}}}C^{2d_{\mathcal{H}}}\frac{1}{{2}^{N}}%
\sum_{a_{1}^{\sigma}=b_{1}}^{b_{1}+b_{2}}\mathds{1}(b_{1}+b_{2}\geq\frac{{%
\epsilon}N}{4})C_{b_{2}}^{a_{1}^{\sigma}-b_{1}}2^{n-b_{2}}\eta^{a_{1}^{\sigma}%
}\\
=&\mathbb{E}\ (2N)^{d_{\mathcal{H}}}C^{2d_{\mathcal{H}}}\mathds{1}(b_{1}+b_{2}%
\geq\frac{{\epsilon}N}{4})\eta^{b_{1}}(\frac{1+\eta}{2})^{b_{2}}\\
\end{split}
\left\lvert H|(\bm{x}^{N},\bm{x}^{\prime N})\right\rvert\leq(2N)^{d_{\mathcal{%
H}}}C^{2d_{\mathcal{H}}}
b_{1}=0,b_{2}=\frac{{\epsilon}N}{4}
(2N)^{d_{\mathcal{H}}}C^{2d_{\mathcal{H}}}(\frac{1+\eta}{2})^{\frac{{\epsilon}%
N}{4}}
\eta=\sup_{(\bm{x},y)\in\mathcal{X}\times\mathcal{Y},y_{j}\in\mathcal{Y},y_{j}%
\neq y}\mathbb{P}_{S|(\bm{x},y)}(y_{j}\in S)
d_{H}
H
\tilde{h}=h_{\tilde{\Theta}}
\tilde{\Theta}=\operatorname*{arg\,min}_{\Theta}R^{\mathcal{D}_{train}}({%
\Theta})
\eta\in[0,1)
\forall\delta>0
L_{2}
\mathbb{P}_{train}(y)
\mathbb{P}_{train}(y|\tilde{\Theta})
\tilde{h}
L_{2}({\tilde{h}})<\frac{4}{(\ln 2-\ln(1+\eta))N}(d_{H}(\ln 2N+2\ln C)-\ln%
\delta+\ln 2)
1-\delta
N
C
R
R=\{{\mathcal{D}_{train}}\in(\mathcal{X},\mathcal{Y},\mathcal{S})^{N}:\exists h%
,L_{2}(h)\geq\epsilon,R^{\mathcal{D}_{train}}(h)=0\}
\mathbb{P}({\mathcal{D}_{train}}\in R)\leq\delta
\mathbb{P}({\mathcal{D}_{train}}\in R)
\mathbb{P}({\mathcal{D}_{train}}\in R)<2\mathbb{P}(({\mathcal{D}_{train}},%
\mathcal{D}_{train}^{\prime})\in M)
\mathbb{P}(({\mathcal{D}_{train}},\mathcal{D}_{train}^{\prime})\in M)
(2N)^{d_{\mathcal{H}}}C^{2d_{\mathcal{H}}}(\frac{1+\eta}{2})^{\frac{{\epsilon}%
N}{4}}
\mathbb{P}({\mathcal{D}_{train}}\in R)<2\mathbb{P}(({\mathcal{D}_{train}},%
\mathcal{D}_{train}^{\prime})\in M)\leq 2(2N)^{d_{\mathcal{H}}}C^{2d_{\mathcal%
{H}}}(\frac{1+\eta}{2})^{\frac{{\epsilon}N}{4}}
\mathbb{P}({\mathcal{D}_{train}}\in R)\leq\delta
\begin{split}\mathbb{P}({\mathcal{D}_{train}}\in R)\leq\delta&\ \Longleftarrow%
\ \ \ln 2+d_{\mathcal{H}}(\ln 2+\ln N)+2d_{\mathcal{H}}\ln C-\frac{{\epsilon}N%
}{4}\ln(\frac{1+\eta}{2})\leq\ln\delta\\
&\iff\epsilon\geq\frac{4}{(\ln 2-\ln(1+\eta))N}(d_{H}(\ln 2N+2\ln C)-\ln\delta%
+\ln 2)\end{split}
\epsilon=\frac{4}{(\ln 2-\ln(1+\eta))N}(d_{H}(\ln 2N+2\ln C)-\ln\delta+\ln 2)
L_{2}\left({\tilde{h}}\right)<\epsilon
1-\delta
32\times 32
\rho
\rho=\frac{N_{C}}{N_{1}}
N_{c}
c\in\mathcal{Y}
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y)=q
C-1
q
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y,D(\overline{y})\neq D(y))=q,%
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y,D(\overline{y})=D(y))=8q
D(y)
y
\rho\in\{50,100\}
q\in\{0.03,0.05,0.07\}
\rho\in\{50,100\}
q\in\{0.03,0.05,0.07\}
\rho
q
\mathds{U}([-1,-1],[0,0])
\mathds{U}([0,-1],[1,0])
\mathds{U}([-1,0],[0,1])
\mathds{U}([0,0],[1,1])
\mathbb{P}(\overline{y}\in S|\overline{y}\neq y)=0.6
0.9
50
2.0
\rho=100
q\in\{0.03,0.05,0.07\}
\rho=100
q\in\{0.03,0.05,0.07\}
q=0.03
q=0.05
q=0.07
500
0.7
0.0005
1000
10^{-2}
10^{-6}
\rho\in\{50,100\}
q\in\{0.03,0.05,0.07\}
\rho=100
q\in\{0.03,.0.05,0.07\}
\rho=100
q\in\{0.03,.0.05,0.07\}
\rho=100
q\in\{0.03,0.05,0.07\}
\rho=100
q\in\{0.03,0.05,0.07\}
q=0.03
q=0.05
q=0.07
f
\rho=100
q=0.5
\rho=100
q=0.5
\rho=100
q=0.5
\rho
q
\rho
q
