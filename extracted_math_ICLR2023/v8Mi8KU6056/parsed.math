k
r
c
k
r
c
K
P=\{n_{1},n_{2},n_{3},...,n_{K}\}
P_{nb}=\{x_{1},x_{2},x_{3},\ldots,x_{K}\}
x_{i}
\displaystyle(x_{i}^{\text{metric}},x_{i}^{\text{beat}},x_{i}^{\text{chord}},x%
_{i}^{\text{tempo}},x_{i}^{\text{inst}},x_{i}^{\text{pitch}},x_{i}^{\text{dur}%
},x_{i}^{\text{vel}})
\displaystyle(x_{i}^{\text{metric}},x_{i}^{\text{beat}},x_{i}^{\text{chord}},x%
_{i}^{\text{tempo}},x_{i}^{\text{inst}},x_{i}^{\text{pitch}},x_{i}^{\text{dur}%
},x_{i}^{\text{vel}})
x_{i}
\displaystyle(x_{i-1}^{\text{pitch}},x_{i-1}^{\text{dur}},x_{i-1}^{\text{vel}}%
,x_{i}^{\text{metric}},x_{i}^{\text{beat}},x_{i}^{\text{chord}},x_{i}^{\text{%
tempo}},x_{i}^{\text{inst}})
\displaystyle(x_{i-1}^{\text{pitch}},x_{i-1}^{\text{dur}},x_{i-1}^{\text{vel}}%
,x_{i}^{\text{metric}},x_{i}^{\text{beat}},x_{i}^{\text{chord}},x_{i}^{\text{%
tempo}},x_{i}^{\text{inst}})
i
x_{i}
h_{i}
s_{i}^{j}
j
i
h_{i}
s_{i}^{0},\dots,s_{i}^{j-1}
\text{K/V}_{i}
\text{Emb}(s_{i})
BOS
h_{i}
h_{i}
a_{i}^{j}
\text{W}_{\text{logits}}^{j}
\displaystyle\text{Query}_{i}^{j}=\text{PositionalEncoding}(h_{i}),
\displaystyle\text{Query}_{i}^{j}
\displaystyle=\text{PositionalEncoding}(h_{i}),
\displaystyle\text{K/V}_{i}^{j}=\begin{cases}BOS&\text{if }j=0,\\
\text{Concat}(BOS,\ldots,\text{Emb}(s_{i}^{j-1}))&\text{if }j>0,\\
\end{cases},
\displaystyle\text{K/V}_{i}^{j}
\displaystyle=\begin{cases}BOS&\text{if }j=0,\\
\text{Concat}(BOS,\ldots,\text{Emb}(s_{i}^{j-1}))&\text{if }j>0,\\
\end{cases},
\displaystyle a_{i}^{j}=\text{Cross-Attention}(\text{Query}_{i}^{j},\text{K/V}%
_{i}^{j}),
\displaystyle a_{i}^{j}
\displaystyle=\text{Cross-Attention}(\text{Query}_{i}^{j},\text{K/V}_{i}^{j}),
\displaystyle s_{i}^{j}=\text{Sampling}(\text{Softmax}(a_{i}^{j}\text{W}_{%
\text{logits}}^{j}))
\displaystyle s_{i}^{j}
\displaystyle=\text{Sampling}(\text{Softmax}(a_{i}^{j}\text{W}_{\text{logits}}%
^{j}))
\text{Emb}(s_{i})
h_{i-(w-1)},...,h_{i}
w
\displaystyle\text{Context}_{i}=\text{Concat}(BOS,h_{i-(w-1)},...,h_{i}),
\displaystyle\text{Context}_{i}
\displaystyle=\text{Concat}(BOS,h_{i-(w-1)},...,h_{i}),
\displaystyle\text{Enriched}_{i}=\text{Cross-Attention}(\text{Emb}(s_{i}),%
\text{Context}_{i})
\displaystyle\text{Enriched}_{i}
\displaystyle=\text{Cross-Attention}(\text{Emb}(s_{i}),\text{Context}_{i})
\text{Enriched}_{i}
h_{i}
h_{i}
\text{Seq}_{i}
\text{Emb}(s_{i})
h_{i}
\text{Seq}_{i}
\displaystyle\text{Seq}_{i}^{j}=\begin{cases}\text{Concat}(h_{i},BOS)&\text{if%
 }j=0,\\
\text{Concat}(h_{i},BOS,...,\text{Emb}(s_{i}^{j-1}))&\text{if }j>0,\\
\end{cases},
\displaystyle\text{Seq}_{i}^{j}
\displaystyle=\begin{cases}\text{Concat}(h_{i},BOS)&\text{if }j=0,\\
\text{Concat}(h_{i},BOS,...,\text{Emb}(s_{i}^{j-1}))&\text{if }j>0,\\
\end{cases},
\displaystyle a_{i}^{j}=\text{Self-Attention}(\text{Seq}_{i}^{j}),
\displaystyle a_{i}^{j}
\displaystyle=\text{Self-Attention}(\text{Seq}_{i}^{j}),
\displaystyle s_{i}^{j}=\text{Sampling}(\text{Softmax}(a_{i}^{j}\text{W}_{%
\text{logits}}^{j}))
\displaystyle s_{i}^{j}
\displaystyle=\text{Sampling}(\text{Softmax}(a_{i}^{j}\text{W}_{\text{logits}}%
^{j}))
\downarrow
\pm
\pm
\pm
h_{i}
h_{i}
h_{i}
h_{i}
s\in\mathbb{Z}
s\sim U(-5,6)
\beta_{1}
\beta_{2}
1\times\mathrm{e}^{-4}
P(\text{pitch}\mid\text{context})
P(\text{same\_beat}\mid\text{context})\times P(\text{pitch}\mid\text{context},%
\text{same\_beat})
\downarrow
\downarrow
\downarrow
\downarrow
p=0.99
\uparrow
\uparrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
