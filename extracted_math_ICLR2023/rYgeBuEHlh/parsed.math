\mathcal{D}=\langle\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma\rangle
\mathcal{S}
\mathcal{A}
\mathcal{P}:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\mapsto[0,1]
\mathcal{R}:\mathcal{S}\times\mathcal{A}\mapsto\mathbb{R}
\gamma\in[0,1)
t
a_{t}\sim\pi_{\theta}\left(\cdot\mid s_{t}\right)
a_{t}\in\mathcal{A}
s_{t}\in\mathcal{S}
\theta
r_{t}=\mathcal{R}\left(s_{t},a_{t}\right)
s_{t+1}\sim\mathcal{P}\left(\cdot\mid s_{t},a_{t}\right)
\tau_{\theta}:=\left(\left(s_{0},a_{0},r_{0}\right),\left(s_{1},a_{1},r_{1}%
\right),\ldots\right)
\pi_{\theta}
J(\theta)=\mathbb{E}_{\pi_{\theta}}\left[\sum_{t=0}^{\infty}\gamma^{t}r_{t}%
\right]\,.
F:\mathbb{R}^{d}\rightarrow\mathbb{R}
F(\mathbf{x})
\mathbb{E}_{\mathbf{\epsilon}\sim N(\mathbf{0},I_{d})}[F(\mathbf{x}+\sigma%
\mathbf{\epsilon})]\,,
\sigma
\nabla_{\mathbf{x}}\mathbb{E}_{\mathbf{\epsilon}\sim N(\mathbf{0},I_{d})}[F(%
\mathbf{x}+\sigma\mathbf{\epsilon})]=\mathbb{E}_{\mathbf{\epsilon}\sim N(%
\mathbf{0},I_{d})}\left[\frac{\mathbf{\epsilon}}{\sigma}F(\mathbf{x}+\sigma%
\mathbf{\epsilon})\right]\,,
\langle\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma,\mathcal{M},f,%
\mathcal{J}\rangle
\mathcal{M}
\mathcal{P},\mathcal{R}
\mathcal{M}
\mathcal{P}(\cdot\mid s,m,a)=\mathcal{P}(\cdot\mid s,m^{\prime},a)
\mathcal{R}(s,m,a)=\mathcal{R}(s,m^{\prime},a)
m,m^{\prime}\in\mathcal{M}
f:\mathcal{S}\to\mathcal{M}
m=f(s)
\mathcal{J}
a_{t}\sim\pi_{\theta}(\cdot\mid s,f(s))
a\in\mathcal{A},s\in\mathcal{S}
\pi_{\theta}
\theta
J
f_{\phi}(s)
s
f_{\phi}:\mathcal{S}\to\mathcal{M}
\phi
\mathcal{J}
\mathcal{J}=-J
\mathcal{J}=J
\mathcal{J}
J
\mathcal{M}
\pi_{0}(\cdot\mid s_{i},m_{j})=\pi_{0}(\cdot\mid s_{i},m_{j^{\prime}})\ %
\forall\ j,j^{\prime}
(s,f(s))
f
10
10
c=\pm 1
\phi
m=0
M
\phi_{n}\sim\phi+\sigma\epsilon_{n}
\epsilon_{n}\sim\mathcal{N}(0,I)
n=0
N
\theta
e=0
E
a\sim\pi_{\theta}(\cdot\mid s,f_{\phi_{n}}(s))
r,s
a
r
\theta
J
\mathcal{J}_{n}=c\cdot\text{sum(rewards)}/\text{len(rewards)}
\phi
\mathcal{J}
\phi
\theta
\phi
\theta
\mathcal{J}
\phi
J
J
\mathcal{J}=\pm J
E
N
\mathcal{J}
\mathcal{J}
\phi
\psi
\phi
\psi
\mathcal{J}
\phi
\psi
\mathcal{J}
\psi
\mathcal{J}
\theta^{\prime}
\mathcal{T}(\theta\mid\phi)
\phi
\theta
\psi
\theta^{\prime}
\theta^{\prime}\sim\mathcal{T}(\cdot\mid\phi)
\mathcal{T}(\theta\mid\phi)
\mathcal{T}(\theta\mid\phi)
10
10
\phi
10
10
\psi
\phi
\theta
\phi
\psi
\psi
\psi^{*}
\phi
\theta
\phi
\psi^{*}
\theta
\psi^{*}
\theta
\psi^{*}
\phi_{\text{random}}
\theta
\phi_{\text{random}}
\psi^{*}
J
\phi
\phi
\phi
\phi
\phi
\phi
\phi
\phi
\phi
\psi
\phi
\theta
\psi^{*}
\psi
\theta
\psi
\theta
\phi
\mathcal{M}
\pi_{0}(\cdot\mid s_{i},m_{j})=\pi_{0}(\cdot\mid s_{i},m_{j^{\prime}})\ %
\forall\ j,j^{\prime}
\langle\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma,\mathcal{M},f,%
\mathcal{J}\rangle
\{s_{1},\ldots,s_{d}\}
\{m_{1},\ldots,m_{k}\}
d=|\mathcal{S}|
k=|\mathcal{M}|
\pi_{t}(\cdot\mid s_{i},m_{j})
t
i\in[d],j\in[k]
\mathcal{M}
\pi_{0}(\cdot\mid s_{i},m_{j})=\pi_{0}(\cdot\mid s_{i},m_{j^{\prime}})
j,j^{\prime}\in[k]
f,g
V,W
\pi,{\mathchoice{\raisebox{0.6pt}{$\displaystyle\chi$}}{\raisebox{0.6pt}{$%
\textstyle\chi$}}{\raisebox{0.6pt}{$\scriptstyle\chi$}}{\raisebox{0.6pt}{$%
\scriptscriptstyle\chi$}}}
(s,f(s))
(s,g(s))
\pi_{t}(\cdot\mid s_{i},f(s_{i}))\qquad\text{and}\qquad{\mathchoice{\raisebox{%
0.6pt}{$\displaystyle\chi$}}{\raisebox{0.6pt}{$\textstyle\chi$}}{\raisebox{0.6%
pt}{$\scriptstyle\chi$}}{\raisebox{0.6pt}{$\scriptscriptstyle\chi$}}}_{t}(%
\cdot\mid s_{i},g(s_{i}))\,.
t
\mathcal{M}
0\leq t\leq T
T+1
\pi_{t}
{\mathchoice{\raisebox{0.6pt}{$\displaystyle\chi$}}{\raisebox{0.6pt}{$%
\textstyle\chi$}}{\raisebox{0.6pt}{$\scriptstyle\chi$}}{\raisebox{0.6pt}{$%
\scriptscriptstyle\chi$}}}_{t}
(s,f(s),a,s^{\prime},f(s^{\prime}))
V
(s,g(s),a,s^{\prime},g(s))
W
\displaystyle\pi_{t}(a\mid s_{i},f(s_{i}))={\mathchoice{\raisebox{0.6pt}{$%
\displaystyle\chi$}}{\raisebox{0.6pt}{$\textstyle\chi$}}{\raisebox{0.6pt}{$%
\scriptstyle\chi$}}{\raisebox{0.6pt}{$\scriptscriptstyle\chi$}}}_{t}(a\mid s_{%
i},g(s_{i}))\,;
\displaystyle\pi_{t}(a\mid s_{i},f(s_{i}))
\displaystyle={\mathchoice{\raisebox{0.6pt}{$\displaystyle\chi$}}{\raisebox{0.%
6pt}{$\textstyle\chi$}}{\raisebox{0.6pt}{$\scriptstyle\chi$}}{\raisebox{0.6pt}%
{$\scriptscriptstyle\chi$}}}_{t}(a\mid s_{i},g(s_{i}))\,;
\displaystyle\mathcal{P}(s^{\prime},f(s^{\prime})\mid s,f(s),a)=\mathcal{P}(s^%
{\prime},g(s^{\prime})\mid s,g(s),a)\,;
\displaystyle\mathcal{P}(s^{\prime},f(s^{\prime})\mid s,f(s),a)
\displaystyle=\mathcal{P}(s^{\prime},g(s^{\prime})\mid s,g(s),a)\,;
\displaystyle\mathcal{R}(s,f(s),a)=\mathcal{R}(s,g(s),a)
\displaystyle\mathcal{R}(s,f(s),a)
\displaystyle=\mathcal{R}(s,g(s),a)
\mathcal{P},\mathcal{R}
\mathcal{M}
\pi_{T}(\cdot\mid s_{i},f(s_{i}))={\mathchoice{\raisebox{0.6pt}{$\displaystyle%
\chi$}}{\raisebox{0.6pt}{$\textstyle\chi$}}{\raisebox{0.6pt}{$\scriptstyle\chi%
$}}{\raisebox{0.6pt}{$\scriptscriptstyle\chi$}}}_{T}(\cdot\mid s_{i},g(s_{i}))
\pi_{T+1}(\cdot\mid s_{i},f(s_{i}))={\mathchoice{\raisebox{0.6pt}{$%
\displaystyle\chi$}}{\raisebox{0.6pt}{$\textstyle\chi$}}{\raisebox{0.6pt}{$%
\scriptstyle\chi$}}{\raisebox{0.6pt}{$\scriptscriptstyle\chi$}}}_{T+1}(\cdot%
\mid s_{i},g(s_{i}))
\theta
(s_{i},f(s_{i}))
(s_{j},f(s_{j}))
\tau=(s^{k},f(s^{k}),a^{k})_{k}
V
\omega=(s^{k},g(s^{k}),a^{k})_{k}
W
\mathbb{E}_{\tau\sim\pi_{t}}\left[\mathcal{R}(\tau)\right]=\mathbb{E}_{\omega%
\sim{\mathchoice{\raisebox{0.6pt}{$\displaystyle\chi$}}{\raisebox{0.6pt}{$%
\textstyle\chi$}}{\raisebox{0.6pt}{$\scriptstyle\chi$}}{\raisebox{0.6pt}{$%
\scriptscriptstyle\chi$}}}_{t}}\left[\mathcal{R}(\omega)\right]
t
\bar{\pi}
\langle\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\mathcal{M},f,\mathcal{%
J},\gamma\rangle
\mathcal{S}\times\mathcal{M}
\mathcal{M}
\bar{\pi}
\pi
\pi(\cdot\mid s)\coloneqq\bar{\pi}(\cdot\mid s,f(s))
Q(s,a)=\bar{Q}(s,f(s),a)
\mathcal{M}
\pi
\displaystyle Q(s,a)=\bar{Q}(s,f(s),a)=\mathbb{E}_{s^{\prime}\sim\mathcal{P}(%
\cdot\mid s,a),r\sim\mathcal{R}(\cdot\mid s,a)}\left[r+\gamma\max_{a^{\prime}%
\in\mathcal{A}}\bar{Q}(s^{\prime},f(s^{\prime}),a^{\prime})\right]
\displaystyle Q(s,a)=\bar{Q}(s,f(s),a)
\displaystyle=\mathbb{E}_{s^{\prime}\sim\mathcal{P}(\cdot\mid s,a),r\sim%
\mathcal{R}(\cdot\mid s,a)}\left[r+\gamma\max_{a^{\prime}\in\mathcal{A}}\bar{Q%
}(s^{\prime},f(s^{\prime}),a^{\prime})\right]
\displaystyle=\mathbb{E}_{s^{\prime}\sim\mathcal{P}(\cdot\mid s,a),r\sim%
\mathcal{R}(\cdot\mid s,a)}\left[r+\gamma\max_{a^{\prime}\in\mathcal{A}}Q(s^{%
\prime},a^{\prime})\right]\,.
\displaystyle=\mathbb{E}_{s^{\prime}\sim\mathcal{P}(\cdot\mid s,a),r\sim%
\mathcal{R}(\cdot\mid s,a)}\left[r+\gamma\max_{a^{\prime}\in\mathcal{A}}Q(s^{%
\prime},a^{\prime})\right]\,.
\bar{\tau}=(s^{k},f(s^{k}),a^{k})_{k}
\tau=(s^{k},a^{k})_{k}
\pi
\bar{\pi}
\mathbb{E}_{\bar{\tau}\sim\bar{\pi}}\left[\mathcal{R}(\bar{\tau})\right]=%
\mathbb{E}_{\tau\sim\pi}\left[\mathcal{R}(\tau)\right]
\langle\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma,\mathcal{M},f,%
\mathcal{J}\rangle
f(s)
f:\mathcal{S}\to\mathcal{M}
s
s
a\sim\pi(\cdot\mid s,f(s))
\mathcal{P},\mathcal{R}
\mathcal{M}
\mathcal{P}(\cdot\mid s,m,a)=\mathcal{P}(\cdot\mid s,m^{\prime},a)
m,m^{\prime}\in\mathcal{M}
\mathcal{R}
m=f(s)
\mathcal{P}
\mathcal{R}
f:\mathcal{S}\to\mathcal{M}
\mathcal{S}
f
\pi(\cdot\mid s,f(s))
\mathcal{A}
f
\mathcal{S}\times\mathcal{A}
f
s_{t}=s_{t^{\prime}}
f(s_{t})=f(s_{t^{\prime}})
t,t^{\prime}
\pi
\pi(\cdot\mid s_{t},f(s_{t}))=\pi(\cdot\mid s_{t^{\prime}},f(s_{t^{\prime}}))
s_{t}=s_{t^{\prime}}
\mathcal{P}
\mathcal{R}
\mathcal{M}
\mathcal{M}
f:\mathcal{S}\to\mathcal{M}
\mathcal{M}
|\mathcal{M}|=1
1
\mathcal{S}
f
f:\{0\}\to\mathcal{M}
f(0)=m\in\mathcal{M}
\mathcal{M}
f:\mathcal{S}\to\mathcal{M}
f(s)=m
s
\mathcal{J}
\mathcal{J}
\mathcal{J}=\pm J
\phi
\psi
m=0
M
\phi_{n}\sim\phi+\sigma\epsilon_{n}
\epsilon_{1},...,\epsilon_{N}\sim\mathcal{N}(0,I)
\psi_{n}\sim\psi+\sigma\epsilon_{n}
\epsilon_{1},...,\epsilon_{N}\sim\mathcal{N}(0,I)
n=0
N
\theta
e=0
E
m=f_{\phi_{n}}(s)
\bar{s}
s
m
a\sim\pi_{\theta}(\cdot\mid\bar{s})
r,s
a
\theta
J
i=0
I
g=\text{env.getgoal()}
s=\text{env.reset()}
m=f_{\psi_{n}}(s,g)
\bar{s}
s
m
a\sim\pi_{\theta}(\cdot\mid\bar{s})
r,s
a
r^{G}_{t}=R^{G}(s,a,g)
r^{G}_{t}
\mathcal{J}
\text{sum(scores)}/I
\phi
\psi
\mathcal{J}
\phi
\phi
\theta
\psi^{*}
i=0
I
m\sim\pi_{\psi^{*}}(\cdot\mid s)
\bar{s}
s
m
a\sim\pi_{\theta}(\cdot\mid\bar{s})
r,s
a
r^{S}_{t}=R^{S}(s,a)
r^{S}_{t}
\psi^{*}
\mathcal{J}
\phi_{\text{random}}
\theta
e=0
E
m=f_{\phi_{\text{random}}}(s)
\bar{s}
s
m
a\sim\pi_{\theta}(\cdot\mid\bar{s})
r,s
a
\theta
J
\psi^{*}
i=0
I
m\sim\pi_{\psi^{*}}(\cdot\mid s)
\bar{s}
s
m
a\sim\pi_{\theta}(\cdot\mid\bar{s})
r,s
a
r^{S}_{t}=R^{S}(s,a)
r^{S}_{t}
\psi^{*}
\mathcal{J}
10
10
\pi
\pi
\gamma
\epsilon
\lambda
\pi
\pi
\gamma
\epsilon
\lambda
\pi
\pi
\gamma
\epsilon
\lambda
\pi
\pi
\gamma
\epsilon
\lambda
\pi
\pi
\gamma
\epsilon
\lambda
\phi
\phi
\phi
\phi
\phi
\phi
\phi
\phi
10
10
10
10
