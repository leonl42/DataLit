K
V
D
n
d
x_{nd}
z_{nd}
\displaystyle z_{nd}\mid\boldsymbol{\theta}_{d}\sim\text{Categorical}(%
\boldsymbol{\theta}_{d}),
\displaystyle z_{nd}\mid\boldsymbol{\theta}_{d}
\displaystyle\sim\text{Categorical}(\boldsymbol{\theta}_{d}),
\displaystyle x_{nd}\mid z_{nd}\text{,}\{\boldsymbol{\phi}_{k}\}_{k=1}^{K}\sim%
\text{Categorical}(\boldsymbol{\phi}_{z_{nd}}),
\displaystyle x_{nd}\mid z_{nd}\text{,}\{\boldsymbol{\phi}_{k}\}_{k=1}^{K}
\displaystyle\sim\text{Categorical}(\boldsymbol{\phi}_{z_{nd}}),
\boldsymbol{\theta}_{d}\sim\text{Dirichlet}(\alpha_{0}\textbf{1}_{K})
\boldsymbol{\phi}_{k}\sim\text{Dirichlet}(\beta_{0}\textbf{1}_{V})
\alpha_{0}
\beta_{0}
\displaystyle\ln p(X)\geqslant\langle\ln p(X,Z,\Theta,\Phi)\rangle+\text{H}[q(%
Z,\Theta,\Phi)]
\displaystyle\ln p(X)
\displaystyle\geqslant\langle\ln p(X,Z,\Theta,\Phi)\rangle+\text{H}[q(Z,\Theta%
,\Phi)]
\displaystyle=\ln p(X)-\text{KL}[q(Z,\Theta,\Phi)\|p(Z,\Theta,\Phi|X)],
\displaystyle=\ln p(X)-\text{KL}[q(Z,\Theta,\Phi)\|p(Z,\Theta,\Phi|X)],
X=\{x_{nd}\}_{n,d}
Z=\{z_{nd}\}_{n,d}
\Theta=\{\boldsymbol{\theta}_{d}\}_{d}
\Phi=\{\boldsymbol{\phi}_{k}\}_{k}
\langle\cdot\rangle
q(Z,\Theta,\Phi)
\text{H}[p]
\text{KL}[q\|p]
q
p(Z,\Theta,\Phi|X)
q(Z,\Theta,\Phi)
q(Z,\Theta,\Phi)
q(Z,\Theta,\Phi)=\prod_{n,d}q(z_{nd})\times\prod_{d}q(\boldsymbol{\theta}_{d})%
\times\prod_{k}q(\boldsymbol{\phi}_{k})
\displaystyle q(z_{nd})=\text{Categorical}(\boldsymbol{\pi}_{nd}),
\displaystyle q(z_{nd})
\displaystyle=\text{Categorical}(\boldsymbol{\pi}_{nd}),
\displaystyle\pi_{knd}\propto e^{\langle\ln\theta_{kd}\rangle+\langle\ln\phi_{%
x_{nd}k}\rangle},
\displaystyle\pi_{knd}
\displaystyle\propto e^{\langle\ln\theta_{kd}\rangle+\langle\ln\phi_{x_{nd}k}%
\rangle},
\displaystyle q(\boldsymbol{\theta}_{d})=\text{Dirichlet}(\boldsymbol{\alpha}_%
{d}),
\displaystyle q(\boldsymbol{\theta}_{d})
\displaystyle=\text{Dirichlet}(\boldsymbol{\alpha}_{d}),
\displaystyle\alpha_{kd}=\alpha_{0}+\langle m_{kd}\rangle,
\displaystyle\alpha_{kd}
\displaystyle=\alpha_{0}+\langle m_{kd}\rangle,
\displaystyle q(\boldsymbol{\phi}_{k})=\text{Dirichlet}(\boldsymbol{\beta}_{k}),
\displaystyle q(\boldsymbol{\phi}_{k})
\displaystyle=\text{Dirichlet}(\boldsymbol{\beta}_{k}),
\displaystyle\beta_{vk}=\beta_{0}+\langle m_{vk}\rangle,
\displaystyle\beta_{vk}
\displaystyle=\beta_{0}+\langle m_{vk}\rangle,
m_{kd}
k
d
m_{vk}
v
k
\langle m_{kd}\rangle
\langle m_{vk}\rangle
\sum_{n}\pi_{knd}
\sum_{n,d}\delta_{v}(x_{nd})\pi_{knd}
\delta_{v}(\cdot)
v
\langle\ln\theta_{kd}\rangle
\langle\ln\phi_{vk}\rangle
\psi(\alpha_{kd})-\psi(\sum_{k}\alpha_{kd})
\psi(\beta_{vk})-\psi(\sum_{v}\beta_{vk})
\beta_{vk}
\boldsymbol{\pi}_{nd}
Z
\Theta
\{\boldsymbol{\pi}_{nd}\}_{n,d}
\{\alpha_{d}\}_{d}
\Phi
\{\boldsymbol{\beta}_{k}\}_{k}
\displaystyle\boldsymbol{\beta}_{k}^{(t)}=(1-\rho_{t})\boldsymbol{\beta}_{k}^{%
(t-1)}+\rho_{t}\hat{\boldsymbol{\beta}}_{k},
\displaystyle\boldsymbol{\beta}_{k}^{(t)}
\displaystyle=(1-\rho_{t})\boldsymbol{\beta}_{k}^{(t-1)}+\rho_{t}\hat{%
\boldsymbol{\beta}}_{k},
\displaystyle\hat{\beta}_{vk}=\beta_{0}+D\sum_{n=1}^{N_{d}}\delta_{v}(x_{nd})%
\pi_{knd},
\displaystyle\hat{\beta}_{vk}
\displaystyle=\beta_{0}+D\sum_{n=1}^{N_{d}}\delta_{v}(x_{nd})\pi_{knd},
\sum_{t}\rho_{t}=\infty
\sum_{t}\rho_{t}^{2}<\infty
\rho_{t}=(t+\tau)^{-\kappa}
\kappa\in(0.5,1]
\tau\geqslant 0
\langle m_{vk}\rangle
\boldsymbol{\pi}_{nd}
\boldsymbol{\alpha}_{d}
\displaystyle\beta_{vk}=\beta_{0}+\langle m_{vk}\rangle+\sum_{n=1}^{N_{d}}%
\delta_{v}(x_{nd})\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}\big{)},
\displaystyle\beta_{vk}
\displaystyle=\beta_{0}+\langle m_{vk}\rangle+\sum_{n=1}^{N_{d}}\delta_{v}(x_{%
nd})\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}\big{)},
\boldsymbol{\pi}_{nd}
\boldsymbol{\alpha}_{d}
\boldsymbol{\pi}_{nd}
K
\beta_{vk}^{(0)}
\alpha_{kd}
\alpha_{0}
t=1,2,\cdots
d
\pi_{knd}^{(t)}\propto e^{\langle\ln\theta_{kd}\rangle+\langle\ln\phi_{x_{nd}k%
}\rangle}
\alpha_{kd}=\alpha_{0}+\sum_{n=1}^{N_{d}}\pi_{knd}
\alpha_{kd}
\pi_{knd}
\beta_{vk}=\beta_{0}+\langle m_{vk}\rangle+\sum_{n=1}^{N_{d}}\delta_{v}(x_{nd}%
)\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}\big{)}
\displaystyle\boldsymbol{\beta}_{k}^{(t)}=(1-\rho_{t})\boldsymbol{\beta}_{k}^{%
(t-1)}+\rho_{t}\hat{\boldsymbol{\beta}}_{k}\text{,}
\displaystyle\boldsymbol{\beta}_{k}^{(t)}
\displaystyle=(1-\rho_{t})\boldsymbol{\beta}_{k}^{(t-1)}+\rho_{t}\hat{%
\boldsymbol{\beta}}_{k}\text{,}
\displaystyle\hat{\beta}_{vk}=\beta_{0}+\langle m_{vk}\rangle+\sum_{n=1}^{N_{d%
}}\delta_{v}(x_{nd})\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}\big{)},
\displaystyle\hat{\beta}_{vk}
\displaystyle=\beta_{0}+\langle m_{vk}\rangle+\sum_{n=1}^{N_{d}}\delta_{v}(x_{%
nd})\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}\big{)},
\rho_{t}=(t+\tau)^{-\kappa}
P
1/P
\{\boldsymbol{\pi}_{nd}\}_{n,d}
\{\boldsymbol{\alpha}_{d}\}_{d}
\{\boldsymbol{\beta}_{k}\}_{k}
\sum_{n=1}^{N_{d}}\delta_{v}(x_{nd})\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}%
\big{)}
\beta^{(0)}
\alpha_{kd}
\alpha_{0}
\rho_{t}
P
\{D_{1},\cdots,D_{P}\}
t=1,2,\cdots\infty
p\in\{1,\cdots,P\}
d
D_{p}
\pi_{knd}^{(t)}\propto e^{\langle\ln\theta_{kd}\rangle+\langle\ln\phi_{x_{nd}k%
}\rangle}
\alpha_{kd}=\alpha_{0}+\sum_{n=1}^{N_{d}}\pi_{knd}
\alpha_{kd}
\pi_{knd}
\hat{\beta}_{vk}=\beta_{0}+\langle m_{vk}\rangle+\sum_{n=1}^{N_{d}}\delta_{v}(%
x_{nd})\big{(}\pi_{knd}^{(t)}-\pi_{knd}^{(t-1)}\big{)}
\boldsymbol{\beta}_{k}^{(t)}=(1-\rho_{t})\boldsymbol{\beta}_{k}^{(t-1)}+\rho_{%
t}\hat{\boldsymbol{\beta}}_{k}
K
\alpha_{0}
\beta_{0}
\kappa
\tau
P
P=\{1,2,4,8,16,32\}
P=1
\sim
P
\sim
\sim
\sim
P
0.5
\mu
\sigma=\mu/5
\mu
\mathcal{N}(\mu,\sigma^{2})
\mu
\mu
\mu
\mathcal{N}(\mu,\sigma^{2})
\mu
\mu
\mu
0.25
\mu
O(KN)
