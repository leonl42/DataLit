\mathcal{V}\in\mathbb{R}^{T\times H\times W\times C}
T
H\times W
C
H\times W
S
N=T\times S
D
\mathbf{Q}\in\mathbb{R}^{N\times D}
\mathbf{K}\in\mathbb{R}^{N\times D}
\mathbf{V}\in\mathbb{R}^{N\times D}
\sqrt{D}
\mathbf{Q}\mathbf{K}^{\mathrm{T}}
\mathbf{Y}=\delta(\mathbf{Q}\mathbf{K}^{\mathrm{T}})\mathbf{V},
\delta(\cdot)
\mathbf{Q}\mathbf{K}^{\mathrm{T}}
N\times N
\mathcal{O}(N^{2})
\mathcal{O}(N)
\delta(\cdot)
\rho(\cdot)
\delta(\mathbf{Q}\mathbf{K}^{\mathrm{T}})=\rho(\mathbf{Q})\rho(\mathbf{K})^{%
\mathrm{T}}
\rho(\mathbf{K})^{\mathrm{T}}
\mathbf{V}
\mathbf{Y}=(\rho(\mathbf{Q})\rho(\mathbf{K})^{\mathrm{T}})\mathbf{V}=\rho(%
\mathbf{Q})(\rho(\mathbf{K})^{\mathrm{T}}\mathbf{V}),
(\rho(\mathbf{K})^{\mathrm{T}}\mathbf{V})
D\times D
\mathcal{O}(N^{2}D)
\mathcal{O}(ND^{2})
N\gg D
\mathcal{O}(ND^{2})
\mathcal{O}(N)
\mathbf{Y}_{i}=\frac{\mathrm{ReLU(\mathbf{Q}_{\mathit{i}})}{\textstyle\sum_{j=%
1}^{N}\mathrm{ReLU(\mathbf{K}_{\mathit{j}})^{\mathrm{T}}\mathbf{V}_{\mathit{j}%
}}}}{\mathrm{ReLU(\mathbf{Q}_{\mathit{i}})}{\textstyle\sum_{j=1}^{N}\mathrm{%
ReLU(\mathbf{K}_{\mathit{j}})^{\mathrm{T}}}}}.
\mathbf{Q}
\mathbf{K}
\mathbf{Q}
\mathbf{K}
N\times N
\mathbf{Q}
\mathbf{K}
\mathbf{Q}
\mathbf{K}
\rho(\mathbf{Q})
\rho(\mathbf{K})
\mathbf{Q}
\mathbf{K}
\breve{\mathbf{Q}}
\breve{\mathbf{K}}
\gamma_{q}=\sigma(\varphi_{q}(\breve{\mathbf{Q}})),\gamma_{k}=\sigma(\varphi_{%
k}(\breve{\mathbf{K}})),\hat{\mathbf{Q}}=\gamma_{q}\odot\breve{\mathbf{Q}},%
\hat{\mathbf{K}}=\gamma_{k}\odot\breve{\mathbf{K}},
\varphi_{q}(\cdot)
\varphi_{k}(\cdot)
\mathbb{R}^{N\times D}\to\mathbb{R}^{N\times D}
D\times D
\sigma(\cdot)
\gamma_{q},\gamma_{k}\in\mathbb{R}^{N\times D}
\mathbf{Q}
\mathbf{K}
\odot
\mathbf{Q}
\mathbf{K}
\mathbf{Q}
\mathbf{K}
\mathbf{Q}
\mathbf{K}
\mathbf{Q}
\mathbf{K}
\mathbf{V}
\mathbf{Q}
\mathbf{K}
\mathbf{V}
\gamma=\sigma\left(\varphi(\breve{\mathbf{Q}},\breve{\mathbf{K}},\breve{%
\mathbf{V}})\right),\hat{\mathbf{Q}}=\gamma\odot\breve{\mathbf{Q}},\hat{%
\mathbf{K}}=\gamma\odot\breve{\mathbf{K}},
\varphi(\cdot)
\mathbf{Q}
\mathbf{K}
\mathbf{V}
\mathbf{K}
\mathbf{V}
\sim
\sim
\sim
\sim
\sim
\sim
\%
\times
\times
\times
1\times 3
2\times 3
1\times 1
1\times 3
1\times 3
4\times 3
1\times 3
1\times 3
2\times 3
2\times 3
2\times 3
2\times 3
1\times 3
1\times 3
2\times 3
16\times 224\times 224
x\times y
x
y
10\times 3
10\times 3
10\times 3
10\times 3
1\times 3
1\times 3
10\times 3
10\times 3
1\times 5
1\times 5
2\times 3
1\times 3
4\times 3
4\times 3
4\times 3
4\times 3
4\times 3
4\times 3
4\times 3
4\times 3
4\times 3
4\times 3
10\times 3
10\times 3
4\times 3
4\times 3
>
\times
\times
\times
\checkmark
\times
\times
\times
\checkmark
\times
\checkmark
\checkmark
\times
\times
\times
\checkmark
\checkmark
\checkmark
\checkmark
\times
\times
\times
\checkmark
\times
\times
\times
\checkmark
\times
\times
\checkmark
\checkmark
\times
\checkmark
\times
\times
\checkmark
\checkmark
\sim
\sim
\sim
8\times 224\times 224
32\times 224\times 224
16\times 336\times 336
64\times 448\times 448
96\times 336\times 336
96\times 448\times 448
256\times 320
256\times 320
a
b
a,b>0
b
b
\frac{b}{a+b}
a
b
m_{1}a
m_{2}b
m_{1},m_{2}\in(0,1)
m_{1}<m_{2}
b
\frac{m_{2}b}{m_{1}a+m_{2}b}
\frac{m_{2}b}{m_{1}a+m_{2}b}/\frac{b}{a+b}=\frac{a+b}{\frac{m_{1}}{m_{2}}a+b}>1
\frac{m_{2}b}{m_{1}a+m_{2}b}>\frac{b}{a+b}
b
[-\tau,\tau]
\alpha D
\alpha\in[0,1]
2\tau
(1-\alpha)D/2\tau
\xi
(2\xi+1)^{2}
4\xi
\xi
(1-\alpha)D/4\xi
\times
\times
\times
\checkmark
\times
\times
\times
\checkmark
\times
\checkmark
\checkmark
\times
\times
\times
\checkmark
\checkmark
\checkmark
\checkmark
