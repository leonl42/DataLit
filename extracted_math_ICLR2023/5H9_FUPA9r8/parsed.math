T
\mathcal{G}=(V,E)
N
V
M
E
v^{i}
\textbf{x}^{i}_{1...T}
T
\dot{\textbf{x}}^{i}=\textbf{F}^{i}(\textbf{x}^{i}(t),\textbf{u}^{i}(t))
z_{0}
z_{0}
\textbf{u}(t)
v^{i}
c^{\to i}_{1...T}
\textbf{e}(t)
\to i
v^{i}
i\to
v^{i}
j\to i
v^{j}
v^{i}
\textbf{F}^{i}
\textbf{z}^{i}_{0}
\log p(\textbf{z}^{i}|\textbf{x}^{i}_{1...T})=\log\mathcal{N}\left(\textbf{z}^%
{i};\bm{\mu}^{i}_{0},\bm{\sigma}^{i}_{0}\right)
\textbf{z}_{0}\sim p(\textbf{z}^{i}|\textbf{x}^{i}_{1...T})
p(\hat{x}^{i}_{1...T}|\textbf{z}^{i}_{0},\textbf{c}^{\to i}_{1...T},\textbf{e}%
_{1...T})
\textbf{c}^{i}
\log p(\textbf{c}^{i}|\textbf{x}^{i}_{1...t})=\log\mathcal{N}\left(\textbf{c}^%
{i};\bm{\mu}^{i\to j}_{t},\bm{\sigma}^{i\to j}_{t}\right)
i
j
\textbf{c}^{i\to j}\sim p(\textbf{c}^{i}|\textbf{x}^{i}_{1...t})
\textbf{c}^{\to i}_{t}
t
\textbf{c}^{\to i}_{t}
\displaystyle\textbf{h}^{i}_{T}=\text{RNN}^{i}_{\text{Enc}}(\textbf{x}^{i}_{1.%
..T})
\displaystyle\textbf{h}^{i}_{T}
\displaystyle=\text{RNN}^{i}_{\text{Enc}}(\textbf{x}^{i}_{1...T})
\displaystyle\bm{\mu}^{i}_{0}=\textbf{W}^{i}_{\mu}\textbf{h}^{i}_{T},\qquad\bm%
{\sigma}^{i}_{0}=\textbf{W}^{i}_{\sigma}\textbf{h}^{i}_{T},\qquad\textbf{z}^{i%
}_{0}\sim\mathcal{N}\left(\bm{\mu}^{i}_{0},\bm{\sigma}^{i}_{0}\right)
\displaystyle\bm{\mu}^{i}_{0}
\displaystyle=\textbf{W}^{i}_{\mu}\textbf{h}^{i}_{T},\qquad\bm{\sigma}^{i}_{0}%
=\textbf{W}^{i}_{\sigma}\textbf{h}^{i}_{T},\qquad\textbf{z}^{i}_{0}\sim%
\mathcal{N}\left(\bm{\mu}^{i}_{0},\bm{\sigma}^{i}_{0}\right)
\displaystyle\hat{\textbf{x}}^{i}_{1...T}=\text{RNN}^{i}_{\text{Dec}}(\textbf{%
z}^{i}_{0},\;\textbf{c}^{\to i}_{1...T},\;\textbf{e}_{1...T})
\displaystyle\hat{\textbf{x}}^{i}_{1...T}
\displaystyle=\text{RNN}^{i}_{\text{Dec}}(\textbf{z}^{i}_{0},\;\textbf{c}^{\to
i%
}_{1...T},\;\textbf{e}_{1...T})
\displaystyle\textbf{h}^{i}_{t}=\text{RNN}^{i}_{\text{Comm}}(\textbf{x}^{i}_{%
\leq t})
\displaystyle\textbf{h}^{i}_{t}
\displaystyle=\text{RNN}^{i}_{\text{Comm}}(\textbf{x}^{i}_{\leq t})
\displaystyle\bm{\mu}^{i\to}_{t}=\text{MLP}^{i}_{\text{Comm},\mu}(\textbf{h}^{%
i}_{t}),\qquad\bm{\sigma}^{i\to}_{t}=\text{MLP}^{i}_{\text{Comm},\sigma}(%
\textbf{h}^{i}_{t}),\qquad\textbf{c}^{i\to}_{t}\sim\mathcal{N}\left(\bm{\mu}^{%
i\to}_{t},\bm{\sigma}^{i\to}_{t}\right)
\displaystyle\bm{\mu}^{i\to}_{t}
\displaystyle=\text{MLP}^{i}_{\text{Comm},\mu}(\textbf{h}^{i}_{t}),\qquad\bm{%
\sigma}^{i\to}_{t}=\text{MLP}^{i}_{\text{Comm},\sigma}(\textbf{h}^{i}_{t}),%
\qquad\textbf{c}^{i\to}_{t}\sim\mathcal{N}\left(\bm{\mu}^{i\to}_{t},\bm{\sigma%
}^{i\to}_{t}\right)
\displaystyle\textbf{c}^{i\to}=\textbf{c}^{\to i}\odot\sigma\left(\text{MLP}^{%
i}_{\text{Router}}\left(\textbf{c}^{\to i}\right)\right)`
\displaystyle\textbf{c}^{i\to}
\displaystyle=\textbf{c}^{\to i}\odot\sigma\left(\text{MLP}^{i}_{\text{Router}%
}\left(\textbf{c}^{\to i}\right)\right)`
\sigma(\cdot)
\text{MLP}^{i}_{\text{Comm},\mu}
\text{MLP}^{i}_{\text{Comm},\sigma}
q_{\phi}^{i}\left(\textbf{z}^{i}_{0},\textbf{c}^{i\to}_{1...T}\;|\;\textbf{x}^%
{i}_{1...T}\right)
p_{\theta}^{i}\left(\textbf{x}^{i}_{1...T}\;|\;\textbf{z}^{i}_{0},\textbf{c}^{%
\to i}_{1...T},\textbf{e}_{1...T}\right)
\displaystyle\mathcal{L}(\theta,\phi,\textbf{x}_{1...T}):=\sum_{i=1}^{N}\frac{%
1}{N}\bigg{[}-\text{D}_{\text{KL}}\left(q_{\phi}(\textbf{z}^{i}_{0}\;|\;%
\textbf{x}^{i}_{1...T})\;||\;p(\textbf{z})\right)
\displaystyle\mathcal{L}(\theta,\phi,\textbf{x}_{1...T})
\displaystyle:=\sum_{i=1}^{N}\frac{1}{N}\bigg{[}-\text{D}_{\text{KL}}\left(q_{%
\phi}(\textbf{z}^{i}_{0}\;|\;\textbf{x}^{i}_{1...T})\;||\;p(\textbf{z})\right)
\displaystyle-\lambda\text{D}_{\text{KL}}\left(q_{\phi}(\textbf{c}^{i\to}_{1..%
.T}\;|\;\textbf{x}^{i}_{1...T})\;||\;p(\textbf{c})\right)
\displaystyle-\lambda\text{D}_{\text{KL}}\left(q_{\phi}(\textbf{c}^{i\to}_{1..%
.T}\;|\;\textbf{x}^{i}_{1...T})\;||\;p(\textbf{c})\right)
\displaystyle+\mathbf{E}_{q_{\phi}^{i}\left(\textbf{z}^{i}_{0},\textbf{c}^{i%
\to}_{1...T}|\textbf{x}^{i}_{1...T}\right)}\left[\log p_{\theta}^{i}\left(%
\textbf{x}^{i}_{1...T}\;|\;\textbf{z}^{i}_{0},\textbf{c}^{\to i}_{1...T},%
\textbf{e}_{1...T}\right)\right]\bigg{]}
\displaystyle+\mathbf{E}_{q_{\phi}^{i}\left(\textbf{z}^{i}_{0},\textbf{c}^{i%
\to}_{1...T}|\textbf{x}^{i}_{1...T}\right)}\left[\log p_{\theta}^{i}\left(%
\textbf{x}^{i}_{1...T}\;|\;\textbf{z}^{i}_{0},\textbf{c}^{\to i}_{1...T},%
\textbf{e}_{1...T}\right)\right]\bigg{]}
p(\textbf{z})
p(\textbf{c})
\lambda
0.1
T1
\text{Uniform}(0,70)
T2~{}T1+\text{Uniform}(30,50)
T2
T3~{}T2+\text{Uniform}(30,50)
T4~{}T3+\text{Uniform}(30,50)
~{}\text{Uniform}(-20,20)
z_{0}
2
3
1
2
2
3
-20
2
17
0.01-0.15
176
8
0.1
0.9
0.999
0.95
6
1E-5
200
8
42
1337
9999
50
100
500
1000
5000
5-6
16
z_{0}
32
0.001
0.025
0.005
0.0075
0.01
0.025
0.05
0.075
0.1
0.25
0.5
0.75
1.0
2.5
0.001
0.005
0.01
0.025
0.05
0.1
1.0
2.0
3.0
4
5
10
20
50
25\%
0.01
1
2
2
3
3
1
2
0.025
0
0
0.025
0.025
176
0.01
0.01
