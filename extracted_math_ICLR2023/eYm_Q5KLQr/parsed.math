{\dagger}
\mathcal{MG}=(\mathcal{N},\mathcal{S},\bm{\mathcal{A}},P,\bm{R},\gamma,\rho)
\mathcal{N}=\{1,2,\cdots,N\}
\mathcal{S}
\bm{\mathcal{A}}=\Pi_{i=1}^{N}\mathcal{A}_{i}
\mathcal{A}_{i}
i
P:\mathcal{S}\times\bm{\mathcal{A}}\rightarrow\Delta(\mathcal{S})
\bm{R}=(R_{1},R_{2},\cdots,R_{N}):\mathcal{S}\times\bm{\mathcal{A}}\rightarrow%
\mathbb{R}^{n}
R_{i}
i
\gamma
\rho
s
\bm{a}=(a_{1},a_{2},\cdots,a_{N})
s^{\prime}
P(s^{\prime}|s,\bm{a})
i
R_{i}(s,\bm{a})
\mathcal{MG}(s)
s
\rho(s)=1
t
N=2
R_{1}(s,\bm{a})+R_{2}(s,\bm{a})=0
(s,\bm{a})\in\mathcal{S}\times\bm{\mathcal{A}}
i
i
-i
i
\pi_{i}:\mathcal{S}\rightarrow\mathcal{A}_{i}
\bm{\pi}=(\pi_{1},\pi_{2})
s
(s,\bm{a})
\displaystyle V^{\bm{\pi}}_{i}(s)=\mathbb{E}\Big{[}\sum_{t}\gamma^{t}R_{i}(s^{%
t},\bm{a}^{t})\Big{|}s^{0}=s\Big{]},
\displaystyle V^{\bm{\pi}}_{i}(s)
\displaystyle=\mathbb{E}\Big{[}\sum_{t}\gamma^{t}R_{i}(s^{t},\bm{a}^{t})\Big{|%
}s^{0}=s\Big{]},
\displaystyle Q^{\bm{\pi}}_{i}(s,\bm{a})=\mathbb{E}\Big{[}\sum_{t}\gamma^{t}R_%
{i}(s^{t},\bm{a}^{t})\Big{|}s^{0}=s,\bm{a}^{0}=\bm{a}\Big{]}.
\displaystyle Q^{\bm{\pi}}_{i}(s,\bm{a})
\displaystyle=\mathbb{E}\Big{[}\sum_{t}\gamma^{t}R_{i}(s^{t},\bm{a}^{t})\Big{|%
}s^{0}=s,\bm{a}^{0}=\bm{a}\Big{]}.
\bm{\pi}^{*}=(\pi_{1}^{*},\pi_{2}^{*})
s^{0}
\rho(s^{0})>0
\displaystyle\pi_{i}^{*}=\operatorname*{arg\,max}_{\pi_{i}}V_{i}^{(\pi_{i},\pi%
_{-i}^{*})}(s^{0}),\ \forall i\in\{1,2\}.
\displaystyle\pi_{i}^{*}=\operatorname*{arg\,max}_{\pi_{i}}V_{i}^{(\pi_{i},\pi%
_{-i}^{*})}(s^{0}),\ \forall i\in\{1,2\}.
V^{*}_{i}(\cdot)
i
Q^{*}_{i}(\cdot,\cdot)
i
\displaystyle V^{*}_{i}(s)=\max_{\pi_{i}}\min_{\pi_{-i}}\mathbb{E}_{\bm{a}\sim%
\bm{\pi}(\cdot|s)}\left[Q^{*}_{i}(s,\bm{a})\right],
\displaystyle V^{*}_{i}(s)
\displaystyle=\max_{\pi_{i}}\min_{\pi_{-i}}\mathbb{E}_{\bm{a}\sim\bm{\pi}(%
\cdot|s)}\left[Q^{*}_{i}(s,\bm{a})\right],
\displaystyle Q^{*}_{i}(s,\bm{a})=R_{i}(s,\bm{a})+\gamma\cdot\mathbb{E}_{s^{%
\prime}\sim P(\cdot|s,\bm{a})}\left[V^{*}_{i}(s^{\prime})\right].
\displaystyle Q^{*}_{i}(s,\bm{a})
\displaystyle=R_{i}(s,\bm{a})+\gamma\cdot\mathbb{E}_{s^{\prime}\sim P(\cdot|s,%
\bm{a})}\left[V^{*}_{i}(s^{\prime})\right].
Q_{i}(\cdot,\cdot)
\{(s^{t},\bm{a}^{t},r_{i}^{t},s^{t+1})\}_{t=0}^{T}
Q_{i}(s^{t},\bm{a}^{t})\leftarrow(1-\alpha)\cdot Q_{i}(s^{t},\bm{a}^{t})+\\
\alpha\cdot\big{(}r_{i}^{t}+\gamma\cdot\max_{\pi_{i}}\min_{\pi_{-i}}\mathbb{E}%
_{\bm{a}\sim\bm{\pi}(\cdot|s)}\left[Q_{i}(s^{t+1},\bm{a})\right]\big{)},
\alpha
RPS(n)
RPS(n)
RPS(n)
RPS(n)
RPS(n)
P_{1}
P_{2}
n
P_{1}
1
P_{2}
-1
P_{1}
RPS(n)
n
n
P_{1}
s_{k}
k
k+1
P_{1}
1/3
P_{1}
n
1/3^{n}
RPS(n)
{\mathcal{O}}(3^{n})
P_{1}
\mathcal{O}(1/3^{n})
\mathcal{O}(3^{n})
RPS(n)
\mathrm{oracle}(\cdot)
\bm{\pi}
\bm{\pi}
s^{0}
\sim\mathrm{oracle}(\mathcal{\mathcal{S}})
\bm{\pi}
\mathcal{MG}(s^{0})
\bm{\pi}
\bm{\pi}
RPS(n)
n
RPS(1)
RPS(1)
s_{n-1}
RPS(n)
s_{0}
s_{n-1}
RPS(1)
\mathcal{O}(1)
RPS(k)
RPS(k+1)
RPS(1)
s_{n-k}
n
RPS(1)
RPS(n)
\mathcal{O}(3^{n})
\mathcal{O}(n)
RPS(1)
\mathcal{O}(n)
RPS(1)
RPS(n)
\mathcal{O}(n)
RPS(n)
n=1,\cdots,10
\mathcal{M}
K
p
\pi_{i}
V_{i}
i=1,2
(\pi_{1},\pi_{2})
V^{\prime}_{i}\leftarrow V_{i},\ i=1,2
s^{0}\sim\mathrm{sampler}(\mathcal{M})
p
s^{0}\sim\rho(\cdot)
\mathcal{MG}(s^{0})
\{\pi_{i},V_{i}\}_{i=1}^{2}
\tilde{w}^{t}\leftarrow\alpha\cdot\mathbb{E}[\tilde{V}_{i}(s^{t})-\tilde{V}^{%
\prime}_{i}(s^{t})]^{2}+\mathrm{Var}(\{\tilde{V}_{i}(s^{t})\}_{i=1}^{2}),\\
\ t=0,\cdots,T
\mathcal{M}\leftarrow\mathcal{M}\cup\{(s^{t},\tilde{w}^{t})\}_{t=0}^{T}
\|\mathcal{M}\|>K
\mathcal{M}\leftarrow\mathrm{FPS}(\mathcal{M},K)
(\pi_{1},\pi_{2})
\rho
\textrm{oracle}(\cdot)
s^{0}
\rho(s^{0})>0
\textrm{oracle}(\cdot)
\textrm{oracle}(\cdot)
0<p<1
\rho
1-p
s
V_{i}(s)=V_{i}^{*}(s)
\displaystyle w(s)=\frac{1}{2}\sum_{i=1}^{2}(V_{i}^{*}(s)-V_{i}(s))^{2}
\displaystyle w(s)
\displaystyle=\frac{1}{2}\sum_{i=1}^{2}(V_{i}^{*}(s)-V_{i}(s))^{2}
\displaystyle=\mathbb{E}_{i}\big{[}(V_{1}^{*}(s)-\tilde{V}_{i}(s))^{2}\big{]}
\displaystyle=\mathbb{E}_{i}\big{[}(V_{1}^{*}(s)-\tilde{V}_{i}(s))^{2}\big{]}
\displaystyle=\mathbb{E}_{i}\big{[}V_{1}^{*}(s)-\tilde{V}_{i}(s)\big{]}^{2}+%
\mathrm{Var}_{i}\big{[}V_{1}^{*}(s)-\tilde{V}_{i}(s)\big{]},
\displaystyle=\mathbb{E}_{i}\big{[}V_{1}^{*}(s)-\tilde{V}_{i}(s)\big{]}^{2}+%
\mathrm{Var}_{i}\big{[}V_{1}^{*}(s)-\tilde{V}_{i}(s)\big{]},
\tilde{V}_{1}(s)=V_{1}(s)
\tilde{V}_{2}(s)=-V_{2}(s)
V_{2}^{*}(s)=-V_{1}^{*}(s)
\{\tilde{V}_{i}\}_{i=1}^{2}
w(s)
P(s)=w(s)/\sum_{s^{\prime}}w(s^{\prime})
RPS(n)
s_{n-1}
s_{0}
\displaystyle\tilde{w}(s)=\alpha\cdot\mathbb{E}_{i}\big{[}\tilde{V}_{i}^{{\pi}%
_{i}^{(t)}}(s)-\tilde{V}^{{\pi}_{i}^{(t-1)}}_{i}(s)\big{]}^{2}+\mathrm{Var}_{i%
}\big{[}\tilde{V}_{i}(s)\big{]},
\displaystyle\tilde{w}(s)=\alpha\cdot\mathbb{E}_{i}\big{[}\tilde{V}_{i}^{{\pi}%
_{i}^{(t)}}(s)-\tilde{V}^{{\pi}_{i}^{(t-1)}}_{i}(s)\big{]}^{2}+\mathrm{Var}_{i%
}\big{[}\tilde{V}_{i}(s)\big{]},
\alpha
V^{*}_{1}(s)
\alpha=1
t
\mathcal{M}
K
s_{0}
\rho(\cdot)
0.3
\mathcal{M}
|\delta_{t}|=|r^{t}+\gamma V(s^{t+1})-V(s^{t})|
RPS(n)
\mathcal{O}(n)
\rho(\cdot)
s_{0}
s_{0}
s_{1}
1/3
s_{1}
\mathbb{E}[n(s_{1})]=3
s_{1}
s_{1}
s_{2}
\mathbb{E}[n(s_{2})]=3
s_{k-1}
s_{k}
\mathbb{E}[n(s_{k})]=3
k=1,2,\cdots,n-1
\sum_{k=1}^{n-1}\mathbb{E}[n(s_{k})]=3(n-1)
\mathcal{O}(n)
RPS(n)
RSP(1)
RPS(n)
RPS(1)
\alpha=1
(s,\bm{a})
RPS(1)
\sum_{i=1}^{9}9/i=25.46<26
RPS(1)
26
RPS(k)
RPS(k+1)
26
RPS(\infty)
1.5
RPS(k)
1.5
RPS(k+1)
P_{1}
1+1.5=2.5
P_{1}
1
2.5
26*2.5=65
RPS(1)
RPS(n)
65(n-1)
\mathcal{O}(n)
\mathcal{O}(n)
\mathcal{O}(n)
RPS(1)
RPS(n)
\mathcal{O}(n)
s_{0}
\rho(s_{0})>0
\displaystyle w(s)=\mathbb{E}_{i}\big{[}(V_{1}^{*}(s)-\tilde{V}_{i}(s))^{2}%
\big{]}
\displaystyle w(s)
\displaystyle=\mathbb{E}_{i}\big{[}(V_{1}^{*}(s)-\tilde{V}_{i}(s))^{2}\big{]}
\displaystyle\approx\alpha\cdot\mathbb{E}_{i}\big{[}\tilde{V}_{i}^{(t)}(s)-%
\tilde{V}^{(t-1)}_{i}(s)\big{]}^{2}+\mathrm{Var}_{i}\big{[}\tilde{V}_{i}(s)%
\big{]}.
\displaystyle\approx\alpha\cdot\mathbb{E}_{i}\big{[}\tilde{V}_{i}^{(t)}(s)-%
\tilde{V}^{(t-1)}_{i}(s)\big{]}^{2}+\mathrm{Var}_{i}\big{[}\tilde{V}_{i}(s)%
\big{]}.
\alpha
V_{1}^{(*,k)}
\displaystyle w(s)=\alpha\cdot\mathbb{E}_{i}\big{[}\tilde{V}_{i}^{(t)}(s)-%
\tilde{V}^{(t-1)}_{i}(s)\big{]}^{2}+\mathrm{Var}_{i}\big{[}\tilde{V}_{i}(s)%
\big{]}
\displaystyle w(s)
\displaystyle=\alpha\cdot\mathbb{E}_{i}\big{[}\tilde{V}_{i}^{(t)}(s)-\tilde{V}%
^{(t-1)}_{i}(s)\big{]}^{2}+\mathrm{Var}_{i}\big{[}\tilde{V}_{i}(s)\big{]}
\displaystyle\approx\mathbb{E}_{i}\big{[}V_{1}^{(*,k)}(s)-\tilde{V}_{i}(s)\big%
{]}^{2}+\mathrm{Var}_{i}\big{[}V_{1}^{(*,k)}(s)-\tilde{V}_{i}(s)\big{]}
\displaystyle\approx\mathbb{E}_{i}\big{[}V_{1}^{(*,k)}(s)-\tilde{V}_{i}(s)\big%
{]}^{2}+\mathrm{Var}_{i}\big{[}V_{1}^{(*,k)}(s)-\tilde{V}_{i}(s)\big{]}
\displaystyle=\mathbb{E}_{i}\big{[}(V_{1}^{(*,k)}(s)-\tilde{V}_{i}(s))^{2}\big%
{]}.
\displaystyle=\mathbb{E}_{i}\big{[}(V_{1}^{(*,k)}(s)-\tilde{V}_{i}(s))^{2}\big%
{]}.
V_{1}^{(*,1)}
V_{1}^{(*,1)}
V_{1}^{(*,1)}
V_{1}^{(*,1)}
V_{2}^{(*,1)}
V_{1}^{(*,2)}
V_{1}^{(*,3)}=V_{1}^{*}
M
i
\{\tilde{V}_{i,m}\}_{m=1}^{M}
i=1,2
s
\displaystyle w(s)=\alpha\cdot\mathbb{E}_{i,m}\big{[}\tilde{V}_{i,m}^{(t)}(s)-%
\tilde{V}^{(t-1)}_{i,m}(s)\big{]}^{2}+\mathrm{Var}_{i,m}\big{[}\tilde{V}_{i,m}%
(s)\big{]},
\displaystyle w(s)
\displaystyle=\alpha\cdot\mathbb{E}_{i,m}\big{[}\tilde{V}_{i,m}^{(t)}(s)-%
\tilde{V}^{(t-1)}_{i,m}(s)\big{]}^{2}+\mathrm{Var}_{i,m}\big{[}\tilde{V}_{i,m}%
(s)\big{]},
i
m
S^{\prime}
K
S
S^{\prime}
max_{S^{\prime}\subset S,|S^{\prime}|=K}\Sigma_{s\in S^{\prime}}min_{s^{\prime%
}\in S^{\prime}}|s-s^{\prime}|
s_{a}
S
s_{a}
S
min_{s\in S}|s_{a}-s|
[0,1]
\{(x,y)|-2\leq x\leq 2,-2\leq y\leq 2\}
\{(x,y)|1\leq x\leq 2,1\leq y\leq 2\}
\{(x,y)|-2\leq x\leq-1,-2\leq y\leq-1\}
5
200
+1
-1
\gamma
\lambda_{\textrm{GAE}}
p
M
K
\alpha
\gamma
\lambda_{\textrm{GAE}}
p
M
K
\alpha
\gamma
\lambda_{\textrm{GAE}}
10^{-6}
p
M
K
\alpha
\gamma
\lambda_{\textrm{GAE}}
p
M
K
\{(x,y)|-1.0\leq x\leq 1.0,-0.45\leq y\leq 0.45\}
(-1.0,0.0)
(0.7,0.0)
(0.7,-0.3)
(1.0,0.0)
(0.75,-0.3)
(0.7,-0.28)
(-1.0,0.0)
(0.7,0.0)
(0.7,-0.3)
(1.0,0.0)
(0.75,-0.1)
(0.7,-0.28)
(-1.0,0.0)
(0.6,0.0)
(0.7,0.2)
(0.7,-0.2)
(1.0,0.0)
(0.75,0.0)
(0.6,0.0)
80
+1
-1
-1
+1
-20
30
25
0
40
(\pi_{1},\pi_{2})
\displaystyle\mathrm{exploitability}(\pi_{1},\pi_{2})=\sum_{i=1}^{2}\max_{\pi_%
{i}^{\prime}}\mathbb{E}\left[V_{i}^{(\pi_{i}^{\prime},\pi_{-i})}(s^{0})\right].
\displaystyle\mathrm{exploitability}(\pi_{1},\pi_{2})=\sum_{i=1}^{2}\max_{\pi_%
{i}^{\prime}}\mathbb{E}\left[V_{i}^{(\pi_{i}^{\prime},\pi_{-i})}(s^{0})\right].
\pi_{i}^{\prime}
\tilde{\pi}_{i}^{\prime}
\pi_{i}
9\times 3=27
\times
3\times 3=9
-20
30
40
40M
K
K=10000
p
p=1
p=0.7
M=3
\alpha
\alpha
\alpha=0.7
\alpha=1.0
\mathcal{M}
