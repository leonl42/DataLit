\star
\star
(\mathcal{S},\mathcal{A},\mathcal{T},\mathcal{G})
t
\pi^{G}(\cdot\mid s_{t},g)
s_{t}\in\mathcal{S}
g\in\mathcal{G}
a_{t}\in\mathcal{A}
s_{t+1}
\mathcal{T}(s_{t+1}|s_{t},a_{t})
\mathcal{G}=\mathcal{S}
\pi^{G}(\cdot\mid s,g)
g
\pi^{G}
g
s_{T}
T
\pi^{E}(\cdot\mid s)
T_{E}
\pi^{E}(\cdot\mid s)
r^{E}
\displaystyle\begin{aligned} &\text{World model:}&&\widehat{\mathcal{T}}_{%
\theta}(s_{t}|s_{t-1},a_{t-1})&&&&\\
&\text{Exploration policy:}&&\pi^{E}_{\theta}(a_{t}|s_{t})&&\text{Goal %
Reaching policy:}&&\pi^{G}_{\theta}(a_{t}|s_{t},g)\\
&\text{Exploration value:}&&V^{E}_{\theta}(s_{t})&&\text{Goal Reaching value:}%
&&V^{G}_{\theta}(s_{t},g)\\
\end{aligned}
\pi^{G}
\pi^{E}
\widehat{\mathcal{T}}
r^{G},r^{E}
\mathcal{D}\leftarrow\{\}
i=1
N_{\text{train}}
\tau\leftarrow
(\ldots)
\mathcal{D}\leftarrow D\cup\tau
\widehat{\mathcal{T}}
(s_{t},a_{t},s_{t+1})\sim D
\pi^{G}
\widehat{\mathcal{T}}
r^{G}
\pi^{E}
\widehat{\mathcal{T}}
r^{E}
r^{G}
\ldots
i
\%
2=0
g
\tau
\pi^{G}(\cdot\mid\cdot,g)
\tau
\pi^{E}
\tau
\displaystyle\max_{g}\mathbb{E}_{p_{\pi^{G}(\cdot|\cdot,g)}(s_{T})}\left[V^{E}%
(s_{T})\right],
\displaystyle\max_{g}\mathbb{E}_{p_{\pi^{G}(\cdot|\cdot,g)}(s_{T})}\left[V^{E}%
(s_{T})\right],
\displaystyle\text{where}\quad V^{E}(s_{T})=\mathbb{E}_{\pi^{E}}\left[\sum^{T+%
T_{E}}_{t=T+1}\gamma^{t-T-1}r^{E}_{t}\right],
\displaystyle\text{where}\quad V^{E}(s_{T})=\mathbb{E}_{\pi^{E}}\left[\sum^{T+%
T_{E}}_{t=T+1}\gamma^{t-T-1}r^{E}_{t}\right],
p_{\pi^{G}(\cdot|\cdot,g)}(s_{T})
\pi^{G}
T
g
V^{E}
s_{T}
g_{1}\ldots g_{N}
g
\pi^{G}
\widehat{\mathcal{T}}
g
g_{1}\ldots g_{N}
g
\pi^{G}
\widehat{\mathcal{T}}
g
s_{T}
g
g
V^{E}(g)
p_{\pi^{G}(\cdot|\cdot,g)}(s_{T})
\widehat{\mathcal{T}}
\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(\tau)
\displaystyle\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(\tau)=p(s_{0})\large\left[%
\prod^{T}_{t=1}\mathcal{\widehat{T}}(s_{t}\mid s_{t-1},a_{t-1})\pi^{G}(a_{t-1}%
\mid s_{t-1},g)\large\right]
\displaystyle\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(\tau)
\displaystyle=p(s_{0})\large\left[\prod^{T}_{t=1}\mathcal{\widehat{T}}(s_{t}%
\mid s_{t-1},a_{t-1})\pi^{G}(a_{t-1}\mid s_{t-1},g)\large\right]
p_{\pi^{G}(\cdot|\cdot,g)}(s_{T})
\tau
s_{T}
\displaystyle\mathbb{E}_{\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(s_{T})}[V^{E}(s_{%
T})]\approx\frac{1}{K}\sum_{k}V_{\theta}^{E}(s^{k}_{T})\quad\quad\text{ where %
}s^{k}_{T}\sim\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(\tau)
\displaystyle\mathbb{E}_{\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(s_{T})}[V^{E}(s_{%
T})]\approx\frac{1}{K}\sum_{k}V_{\theta}^{E}(s^{k}_{T})\quad\quad\text{ where %
}s^{k}_{T}\sim\hat{p}_{\pi^{G}(\cdot\mid\cdot,g)}(\tau)
g
g
g
K
\tau_{k}
V_{\theta}^{E}(s^{k}_{T})
g
\ldots
g\leftarrow
\tau\leftarrow\textit{GO-EXPLORE}(g,\pi^{G},\pi^{E})
\tau
K
\pi^{G}
K=1
d(s,g)
\epsilon
\bullet
\bullet
\pm 7
\pm 12
\bullet
xy
\bullet
xyz
3+
\pi^{G}
xz
xy
xz
xy
\sim
\sim
\pi^{G}
\pi^{G}
\%
V^{E}(s_{T})
\sum_{t=1}^{T}r^{E}_{t}
\pm 7
\pm 12
x
x
x
xz
xyz
xy
xyz
xy
xyz
xyz
xyz
\pi^{G}
\pi^{E}
\widehat{\mathcal{T}}
r^{G},r^{E}
\mathcal{D}\leftarrow\{\}
i=1
N_{\text{train}}
\tau\leftarrow
(\ldots)
\mathcal{D}\leftarrow D\cup\tau
\widehat{\mathcal{T}}
(s_{t},a_{t},s_{t+1})\sim D
\pi^{G}
\widehat{\mathcal{T}}
r^{G}
\pi^{E}
\widehat{\mathcal{T}}
r^{E}
g,\pi^{G},\pi^{E}
s_{0}\leftarrow
\tau\leftarrow\{s_{0}\}
t=1\ldots T_{\text{Go}}
s_{t}\leftarrow
\pi^{G}(s_{t-1},g)
\tau\leftarrow\tau\cup\{s_{t}\}
t=1\ldots T_{\text{Explore}}
s_{t}\leftarrow
\pi^{E}(s_{t-1},g)
\tau\leftarrow\tau\cup\{s_{t}\}
\tau
g
\pi^{G}
T_{\text{Go}}
\pi^{E}
\ldots
i\%2=0
g
\tau
\pi^{G}(\cdot\mid\cdot,g)
\tau
\pi^{E}
\tau
\pi^{G}
\pi^{E}
\ldots
g\leftarrow\min_{g\in\mathcal{D}}\widehat{p}(g)
\tau\leftarrow\textit{GO-EXPLORE}(g,\pi^{G},\pi^{E})
\tau
\ldots
g\sim\left\{g\cdot\widehat{p}(g)^{-1}\mid g\in\mathcal{D}\right\}
\tau\leftarrow\textit{GO-EXPLORE}(g,\pi^{G},\pi^{E})
\tau
\ldots
\tau
\pi^{E}
\tau
N
g
g_{k}
V_{k}
\displaystyle\mu_{t}=\frac{\sum_{k=0}^{N}(e^{\gamma\cdot V_{k}})(g_{k})}{\sum_%
{k=0}^{N}(e^{\gamma\cdot V_{k}})}
\displaystyle\mu_{t}
\displaystyle=\frac{\sum_{k=0}^{N}(e^{\gamma\cdot V_{k}})(g_{k})}{\sum_{k=0}^{%
N}(e^{\gamma\cdot V_{k}})}
\gamma
(s,a,s^{\prime})
\star
\star
