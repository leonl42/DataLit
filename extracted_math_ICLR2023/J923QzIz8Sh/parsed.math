\bullet
\bullet
\bullet
N
K
N
K
K
N
K
\displaystyle P_{i}=[class_{i}^{p},patch_{i,1}^{p},patch_{i,2}^{p},...,patch_{%
i,M}^{p}],
\displaystyle P_{i}
\displaystyle=[class_{i}^{p},patch_{i,1}^{p},patch_{i,2}^{p},...,patch_{i,M}^{%
p}],
\displaystyle i\in[1,5],
\displaystyle i\in[1,5],
M
\displaystyle Q=[class^{q},patch_{1}^{q},patch_{2}^{q},...,patch_{M}^{q}],
\displaystyle Q=[class^{q},patch_{1}^{q},patch_{2}^{q},...,patch_{M}^{q}],
M
class
patch
\displaystyle P=[class,patch_{1},patch_{2},...,patch_{M}],
\displaystyle P=[class,patch_{1},patch_{2},...,patch_{M}],
\displaystyle r_{i}=cos(class,patch_{i}),
\displaystyle r_{i}=cos(class,patch_{i}),
\displaystyle i\in[1,2,...,M],
\displaystyle i\in[1,2,...,M],
cos(\cdot)
\displaystyle R=[r_{1},r_{2},r_{3},...,r_{M}].
\displaystyle R=[r_{1},r_{2},r_{3},...,r_{M}].
m
\displaystyle id_{i}=topK(R,m),
\displaystyle id_{i}=topK(R,m),
\displaystyle i\in[1,2,...,m],1\leq id_{i}\leq M.
\displaystyle i\in[1,2,...,m],1\leq id_{i}\leq M.
\displaystyle P_{selected}=[class^{p},patch_{id_{1}}^{p},patch_{id_{2}}^{p},..%
.,patch_{id_{m}}^{p}],
\displaystyle P_{selected}=[class^{p},patch_{id_{1}}^{p},patch_{id_{2}}^{p},..%
.,patch_{id_{m}}^{p}],
\displaystyle Q_{selected}=[class^{q},patch_{id_{1}}^{q},patch_{id_{2}}^{q},..%
.,patch_{id_{m}}^{q}].
\displaystyle Q_{selected}=[class^{q},patch_{id_{1}}^{q},patch_{id_{2}}^{q},..%
.,patch_{id_{m}}^{q}].
\displaystyle\overline{patch}_{id_{i}}=patch_{id_{i}}+2class.
\displaystyle\overline{patch}_{id_{i}}=patch_{id_{i}}+2class.
\displaystyle\overline{P_{selected}}=[\overline{patch}_{id_{1}}^{p},\overline{%
patch}_{id_{2}}^{p},...,\overline{patch}_{id_{m}}^{p}],
\displaystyle\overline{P_{selected}}=[\overline{patch}_{id_{1}}^{p},\overline{%
patch}_{id_{2}}^{p},...,\overline{patch}_{id_{m}}^{p}],
\displaystyle\overline{Q_{selected}}=[\overline{patch}_{id_{1}}^{q},\overline{%
patch}_{id_{2}}^{q},...,\overline{patch}_{id_{m}}^{q}],
\displaystyle\overline{Q_{selected}}=[\overline{patch}_{id_{1}}^{q},\overline{%
patch}_{id_{2}}^{q},...,\overline{patch}_{id_{m}}^{q}],
m
S
\displaystyle S_{ij}(q,p)=cos(\overline{patch}_{id_{i}}^{q},\overline{patch}_{%
id_{j}}^{p})^{2}.
\displaystyle S_{ij}(q,p)=cos(\overline{patch}_{id_{i}}^{q},\overline{patch}_{%
id_{j}}^{p})^{2}.
S
\displaystyle score(q,p)=MLP(Flatten(S(p,q))),
\displaystyle score(q,p)=MLP(Flatten(S(p,q))),
MLP
Flatten
S
\mathbf{x}
\mathbf{x}
\mathbf{x}
n
\displaystyle p(y=n|\mathbf{x})=\frac{exp(score(q_{\mathbf{x}},p_{n}))}{\sum_{%
n=1}^{N}exp(score(q_{\mathbf{x}},p_{n}))}.
\displaystyle p(y=n|\mathbf{x})=\frac{exp(score(q_{\mathbf{x}},p_{n}))}{\sum_{%
n=1}^{N}exp(score(q_{\mathbf{x}},p_{n}))}.
\mathcal{L}
mini
tiered
mini
tiered
1e-5
1e-6
mini
tiered
95\%
\%
mini
tiered
\%
mini
tiered
\approx
mini
tiered
\%
\%
\approx
mini
tiered
mini
tiered
mini
tiered
mini
mini
mini
mini
mini
\surd
\times
m=0
m=196
mini
mini
m
mini
mini
dot(\cdot)
abs(\cdot)
sqr(\cdot)
cos(\cdot)
mini
mini
dot
abs
sqr
cos
