L_{0}
\{\displaystyle{\bm{h}}_{1},...,\displaystyle{\bm{h}}_{N}\}
\displaystyle{\bm{h}}_{i}\in\mathbb{R}^{F}
N
\alpha_{ij}=a(\displaystyle\displaystyle{\bm{h}}_{i},\displaystyle%
\displaystyle{\bm{h}}_{j})
a:\mathbb{R}^{F^{\prime}}\times\mathbb{R}^{F^{\prime}}\rightarrow(0,1)
\alpha_{ij}
i
j
j
\displaystyle{\bm{h}}_{j}^{\prime}=\sum_{i\in N(j)}\alpha_{ij}\displaystyle{%
\bm{W}}\displaystyle{\bm{h}}_{i},~{}~{}\mathit{s.t.}~{}\sum_{i\in N(j)}\alpha_%
{ij}=1
K
\alpha_{i,j}^{(k)}
a^{(k)}(\cdot,\cdot)
e\in\mathcal{E}
S^{e}
Y^{e}=g(\mathcal{G}^{e}_{\mathcal{S}},\mathcal{X}^{e}_{\mathcal{S}},\epsilon^{%
e})
\mathcal{G}
\mathcal{X}
\mathcal{G}
\epsilon^{e}
\mathcal{S}
S^{e}
\mathcal{R}=Y-Y^{e}
\epsilon^{e}\sim F_{\epsilon}
\epsilon^{e}\perp\!\!\!\perp S^{e}
e\in\mathcal{E}
Y^{e}|S^{e}
Y^{f}|S^{f}
e,f\in\mathcal{E}
\mathcal{E}=\{e\}
S^{e}
Y^{e}
\epsilon^{e}
\mathcal{L}=\mathcal{L}^{p}+\lambda\mathcal{L}^{c}
\mathcal{L}
\mathcal{L}^{p}
\mathcal{L}^{c}
\lambda
\mathcal{L}^{p}=\frac{1}{N}\sum_{n=1}^{N}\ell^{p}(\hat{y}^{(n)},y^{(n)})
N
\ell^{p}(\cdot,\cdot)
\hat{y}^{(n)}
n
y^{(n)}
n
\mathcal{L}^{c}=\frac{1}{R}\sum^{R}_{r=1}\bigg{(}\frac{1}{\left|S^{\left(r%
\right)}\right|}\sum_{\left(n,i,j\right)\in S^{\left(r\right)}}\ell^{c}\left(%
\alpha_{ij}^{(n)},c_{ij}^{(n)}\right)\bigg{)}
n
n
n
R
S^{(r)}
r=1,\ldots,R
S^{(r)}
(n,i,j)
(i,j)
n
n
j
c_{ij}^{(n)}
(i,j)
\alpha_{ij}^{(n)}
\ell^{c}(\cdot,\cdot)
\mathcal{D}_{train}
\mathcal{D}_{val}
\mathcal{M}
\lambda
\text{mini-batch }\{\mathcal{B}^{k}=\{n_{j}^{(k)}\}_{j=1}^{b_{k}}\}
\text{Prediction loss: }\mathcal{L}^{p}\leftarrow\frac{1}{|\mathcal{B}^{k}|}%
\sum_{n\in\mathcal{B}^{k}}\ell^{p}(\hat{y}^{(n)},y^{(n)})
\text{Causal attention loss: }\mathcal{L}^{c}\leftarrow 0
\text{round }r\leftarrow 1\text{ to }R
\text{Set of edge interventions }S(r)\leftarrow\{\}
\text{entity }\{n_{j}^{(k)}\}_{j=1}^{b_{k}}
\text{Sample edge }(i,j)\sim E_{n_{j}^{(k)}}
E_{n_{j}^{(k)}}
n_{j}^{(k)}
(i,j)\text{ independent of }S(r)
S(r)\leftarrow S(r)\text{ }\cup(n_{j}^{(k)},i,j)
\text{Compute causal effect }c_{ij}^{(n)}\leftarrow\sigma\big{(}\big{(}\rho^{(%
n)}_{ij}\big{)}^{d(n)}-1\big{)}
\mathcal{L}^{c}\leftarrow\mathcal{L}^{c}+\frac{1}{R}\frac{1}{\left|S^{\left(r%
\right)}\right|}\sum_{\left(n,i,j\right)\in S^{\left(r\right)}}\ell^{c}\left(%
\alpha_{ij}^{(n)},c_{ij}^{(n)}\right)
\text{Total loss: }\mathcal{L}=\mathcal{L}^{p}+\lambda\mathcal{L}^{c}
\text{Update model parameters to minimize }\mathcal{L}
r
L
L
c_{ij}^{(n)}
n
(i,j)
n
c_{ij}^{(n)}=\sigma\bigg{(}\bigg{(}\rho^{(n)}_{ij}\bigg{)}^{d(n)}-1\bigg{)}\;%
\;\;\text{where}\;\;\rho^{(n)}_{ij}=\frac{\ell^{p}\bigl{(}\hat{y}_{\backslash
ij%
}^{(n)},y^{(n)}\bigr{)}}{\ell^{p}\bigl{(}\hat{y}^{(n)},y^{(n)}\bigr{)}}
\hat{y}_{\backslash ij}^{(n)}
n
(i,j)
d(n)
\rho^{(n)}_{ij}
d(n)
\rho
d
\sigma:\mathbb{R}\rightarrow(0,1)
\hat{y}^{(n)}
\hat{y}_{\backslash ij}^{(n)}
\hat{y}^{(n)}
\hat{y}_{\backslash ij}^{(n)}
\mathcal{O}(RN)
R
N
L
\mathcal{O}(b^{L})
\mathcal{O}(RNb^{L})
L
b
L\leq 2
L=\{1,2\}
K=\{1,3,5\}
F^{\prime}=\{10,25,100,200\}
\lambda=\{0.1,0.5,1,5\}
p<0.05
R
R=1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\lambda
\{0.1,0.5,1,5\}
\lambda=\{1,\,5\}
p<0.05
t
\lambda=\{0.1,\,0.5\}
\lambda
p
\lambda
p
e_{ij}
e_{ij}=\hat{e}_{ij}/\sum_{k\in N_{j}}\hat{e}_{kj}
\hat{e}_{ij}=1
i
j
\hat{e}_{ij}=0
N_{j}
j
\alpha_{i,j}
e_{ij}
p<0.05
p
p
c_{ij}^{(n)}
\lambda\in\{1,5\}
-\log_{10}(p)
-\log_{10}(p)
\Delta
2.5\times 10^{6}
2.0\times 10^{6}
\displaystyle e_{ij}=\text{LeakyReLU}\big{(}\vec{\displaystyle{\bm{A}}}^{T}[%
\displaystyle{\bm{W}}\displaystyle{\bm{h}}_{i}||\displaystyle{\bm{W}}%
\displaystyle{\bm{h}}_{j}\big{)}]\big{)}
\displaystyle e_{ij}=\vec{\displaystyle{\bm{A}}}^{T}\text{LeakyReLU}\big{(}%
\displaystyle{\bm{W}}\displaystyle{\bm{h}}_{i}||\displaystyle{\bm{W}}%
\displaystyle{\bm{h}}_{j}\big{)}
\displaystyle e_{ij}=\frac{(\displaystyle{\bm{W}}\displaystyle{\bm{h}}_{i})^{T%
}(\displaystyle{\bm{W}}\displaystyle{\bm{h}}_{j})}{\sqrt{F^{\prime}}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\vec{x}_{i}\in\mathbb{R}^{d}
\displaystyle{\bm{h}}_{i}=\text{LeakyReLU}\big{(}\displaystyle{\bm{W}}_{1}\vec%
{x}_{i}+\displaystyle{\bm{b}}_{1}\big{)}
\displaystyle{\bm{W}}_{1}\in\mathbb{R}^{F\times d}
\displaystyle{\bm{b}}_{1}\in\mathbb{R}^{F}
L
\displaystyle{\bm{h}}^{\prime}_{i}\in\mathbb{R}^{F}
[\displaystyle{\bm{h}}_{i}||\displaystyle{\bm{h}}^{\prime}_{i}]
\sigma_{\text{softmax}}(\cdot)
\hat{y}_{i}=\sigma_{\text{softmax}}\big{(}\displaystyle{\bm{W}}_{2}\text{%
LeakyReLU}\big{(}[\displaystyle{\bm{h}}_{i}||\displaystyle{\bm{h}}^{\prime}_{i%
}]\big{)}+\displaystyle{\bm{b}}_{2}\big{)}
\hat{y}_{i}\in\mathbb{R}^{C}
\displaystyle{\bm{W}}_{2}\in\mathbb{R}^{2F\times C}
\displaystyle{\bm{b}}_{2}\in\mathbb{R}^{F}
C
\ell^{p}(\cdot,\cdot)
\ell^{c}(\cdot,\cdot)
\sigma(\cdot)
T=0.1
R=5
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\lambda
\lambda\in\{1.0,5.0\}
\lambda\in\{0.1,0.5\}
\lambda
\lambda\in\{1.0,5.0\}
\lambda\in\{0.1,0.5\}
\lambda
\lambda\in\{1.0,5.0\}
\lambda\in\{0.1,0.5\}
\lambda
\lambda\in\{1.0,5.0\}
\lambda\in\{0.1,0.5\}
\lambda
\lambda\in\{1.0,5.0\}
\lambda\in\{0.1,0.5\}
\lambda
\lambda\in\{1.0,5.0\}
\lambda\in\{0.1,0.5\}
\lambda\in\{1,5\}
L=\{1,2\}
K=\{3\}
F^{\prime}=\{100,200\}
\lambda\in\{1,5\}
L=\{1,2\}
K=\{3\}
F^{\prime}=\{100,200\}
F^{\prime}=\{128,256\}
K=\{1,2,4\}
L=\{1,2\}
\lambda_{1}=\{0.2,0.4,0.6,0.8,1\}
\lambda_{2}=\{0.2,0.4,0.6,0.8,1\}
F^{\prime}
K
L
\lambda_{1}
\lambda_{2}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
p
t
\lambda\in\{1,5\}
\lambda\in\{0.1,0.5\}
p
t
\lambda\in\{1,5\}
\lambda\in\{0.1,0.5\}
h
\mathcal{E}
y_{u}
u
y_{v}
v
h=\frac{|\{(u,v):(u,v)\in\mathcal{E}\wedge y_{u}=y_{v}\}|}{|\mathcal{E}|}
h
F^{\prime}=\{100\}
\lambda=\{1,5\}
K=\{1,3,5\}
L=\{1,2\}
-\log_{10}(p)
-\log_{10}(p)
\hat{y}^{(n)}=(p_{1},\dotsc,p_{C})
p_{k}
k
\tilde{c}_{ij}^{(n)}
c_{ij}^{(n)}
\hat{y}_{\backslash ij}^{(n)}
\alpha_{T}
F^{\prime}=100
\Delta
\Delta
