\mathcal{M}^{c}
(\mathcal{{S}},\mathcal{{A}},p_{\mathcal{{R}}},p_{\mathcal{{T}}},
\{(p_{\mathcal{{C}}_{i}},\epsilon_{i})\}_{\forall i},\gamma,T)
\mathcal{{S}}
\mathcal{{A}}
p_{\mathcal{T}}(s^{\prime}|s,a)
p_{\mathcal{{R}}}(r|s,a)
p_{\mathcal{{C}}_{i}}(c|s,a)
\epsilon_{i}
i
c\in[0,\infty]
\gamma\in[0,1)
T
\tau=[s_{0},a_{0},...,a_{T-1},s_{T}]
p(\tau)=p(s_{0})\prod_{t=0}^{T-1}\pi(a_{t}|s_{t})p_{\mathcal{{T}}}(s_{t+1}|s_{%
t},a_{t})
\pi
\displaystyle\arg\max_{\pi}\mathbb{E}_{p_{\mathcal{{R}}},p_{\mathcal{T}},\pi}%
\left[\sum_{t=0}^{T}\gamma^{t}r_{t}\right]+\frac{1}{\beta}\mathcal{H}(\pi)%
\text{ s.t. }\mathbb{E}_{p_{\mathcal{{C}}_{i}},p_{\mathcal{T}},\pi}\left[\sum_%
{t=0}^{T}\gamma^{t}c_{i}(s_{t},a_{t})\right]\leq\epsilon_{i}\;\forall{i\in[0,I]}
\displaystyle\arg\max_{\pi}\mathbb{E}_{p_{\mathcal{{R}}},p_{\mathcal{T}},\pi}%
\left[\sum_{t=0}^{T}\gamma^{t}r_{t}\right]+\frac{1}{\beta}\mathcal{H}(\pi)%
\text{ s.t. }\mathbb{E}_{p_{\mathcal{{C}}_{i}},p_{\mathcal{T}},\pi}\left[\sum_%
{t=0}^{T}\gamma^{t}c_{i}(s_{t},a_{t})\right]\leq\epsilon_{i}\;\forall{i\in[0,I]}
\mathcal{H}(\pi)
\frac{1}{\beta}
T=\infty
c_{i}(s_{t},a_{t})
\epsilon_{i}
\displaystyle\arg\max_{\pi}\mathbb{E}_{p_{\mathcal{{R}}},p_{\mathcal{T}},\pi}%
\left[\sum_{t=0}^{T}\gamma^{t}r_{t}\right]+\frac{1}{\beta}\mathcal{H}(\pi)%
\text{ s.t. }\mathbb{E}_{\tau\sim(p_{\mathcal{T}},\pi),p_{\mathcal{{C}}_{i}}}%
\left[c_{i}(\tau)\right]\leq\epsilon_{i}\;\forall{i\in[0,I]}
\displaystyle\arg\max_{\pi}\mathbb{E}_{p_{\mathcal{{R}}},p_{\mathcal{T}},\pi}%
\left[\sum_{t=0}^{T}\gamma^{t}r_{t}\right]+\frac{1}{\beta}\mathcal{H}(\pi)%
\text{ s.t. }\mathbb{E}_{\tau\sim(p_{\mathcal{T}},\pi),p_{\mathcal{{C}}_{i}}}%
\left[c_{i}(\tau)\right]\leq\epsilon_{i}\;\forall{i\in[0,I]}
c(\tau)
c(\tau)=1-\prod_{(s,a)\in\tau}\phi(s,a)
\phi(s,a)
a
s
\exists{(\bar{s},\bar{a})\in\tau},\phi(\bar{s},\bar{a})\rightarrow 0
\prod_{(s,a)\in\tau}\phi(\cdot)\rightarrow 0
c(\tau)\rightarrow 1
\displaystyle p(\mathcal{D}_{e}|\phi)=\frac{1}{(Z_{\mathcal{M}^{\hat{c}_{\phi}%
}})^{N}}\prod_{i=1}^{N}\exp\left[r(\tau^{(i)})\right]\mathds{1}^{\mathcal{M}^{%
\hat{c}_{\phi}}}(\tau^{(i)})
\displaystyle p(\mathcal{D}_{e}|\phi)=\frac{1}{(Z_{\mathcal{M}^{\hat{c}_{\phi}%
}})^{N}}\prod_{i=1}^{N}\exp\left[r(\tau^{(i)})\right]\mathds{1}^{\mathcal{M}^{%
\hat{c}_{\phi}}}(\tau^{(i)})
N
\mathcal{D}_{e}
Z_{\mathcal{M}^{\hat{c}_{\phi}}}=\int\exp\left[r(\tau)\right]\mathds{1}^{%
\mathcal{M}^{\hat{c}_{\phi}}}(\tau)\mathrm{d}\tau
\mathds{1}^{\mathcal{M}^{\hat{c}_{\phi}}}(\tau^{(i)})
\phi(\tau^{(i)})=\prod_{t=1}^{T}\phi_{t}
\phi_{t}(s_{t}^{i},a_{t}^{i})
\tau^{(i)}
\displaystyle\log\left[p(\mathcal{D}_{e}|\phi)\right]=\sum_{i=1}^{N}\Big{[}r(%
\tau^{(i)})+\log\prod_{t=0}^{T}\phi_{\theta}(s^{(i)}_{t},a^{(i)}_{t})\Big{]}-N%
\log\int\exp[r(\hat{\tau})]\prod_{t=0}^{T}\phi_{\theta}(\hat{s}_{t},\hat{a}_{t%
})\mathrm{d}\hat{\tau}\vspace{-0.1in}
\displaystyle\log\left[p(\mathcal{D}_{e}|\phi)\right]=
\displaystyle\sum_{i=1}^{N}\Big{[}r(\tau^{(i)})+\log\prod_{t=0}^{T}\phi_{%
\theta}(s^{(i)}_{t},a^{(i)}_{t})\Big{]}-N\log\int\exp[r(\hat{\tau})]\prod_{t=0%
}^{T}\phi_{\theta}(\hat{s}_{t},\hat{a}_{t})\mathrm{d}\hat{\tau}\vspace{-0.1in}
\theta
\phi
\displaystyle\nabla_{\theta}\log\left[p(\mathcal{D}_{e}|\phi)\right]=\sum_{i=1%
}^{N}\Big{[}\nabla_{\phi}\sum_{t=0}^{T}\log[\phi_{\theta}(s^{(i)}_{t},a^{(i)}_%
{t})]\Big{]}-N\mathbb{E}_{\hat{\tau}\sim\pi_{\mathcal{M}^{\phi}}}\Big{[}\nabla%
_{\phi}\sum_{t=0}^{T}\log[\phi_{\theta}(\hat{s}_{t},\hat{a}_{t})]\Big{]}%
\vspace{-0.1in}
\displaystyle\nabla_{\theta}\log\left[p(\mathcal{D}_{e}|\phi)\right]=\sum_{i=1%
}^{N}\Big{[}\nabla_{\phi}\sum_{t=0}^{T}\log[\phi_{\theta}(s^{(i)}_{t},a^{(i)}_%
{t})]\Big{]}-N\mathbb{E}_{\hat{\tau}\sim\pi_{\mathcal{M}^{\phi}}}\Big{[}\nabla%
_{\phi}\sum_{t=0}^{T}\log[\phi_{\theta}(\hat{s}_{t},\hat{a}_{t})]\Big{]}%
\vspace{-0.1in}
\hat{\tau}
\pi_{\mathcal{M}^{\hat{\phi}}}(\hat{\tau})=\frac{\exp\left[r(\hat{\tau})\right%
]\phi(\hat{\tau})}{\int\exp\left[r(\tau)\right]\phi(\tau)\mathrm{d}\tau}
\pi_{\mathcal{M}^{\phi}}(\tau)=0
\sum_{(s,a)\in\tau}\hat{c}_{\phi}(s,a)>\epsilon
\hat{c}_{\phi}(s,a)=1-\phi_{t}
\pi
c^{*}(s_{t},a_{t})
a_{t}
s_{t}
\mathcal{D}_{e}=\{\emptyset\}
\mathcal{D}_{e}=\mathcal{D}_{e}\cup\{\tau_{e}\}
\mathcal{D}_{e}
\mathcal{D}_{e}
\zeta(s,a)
r^{\prime}(s,a)=r(\cdot)+\log\left[\zeta(\cdot)\right]
-\infty
\Phi
p(\phi|s,a)
a
s
\phi
\hat{c}_{\phi}(s,a)=1-\phi
\phi\sim p(\cdot|s,a)
\Phi
[0,1]
p(\phi|s,a)
\displaystyle\phi(s,a)\sim p(\phi|s,a)=\text{Beta}(\alpha,\beta)\text{ where }%
[\alpha,\beta]=\log[1+\exp(f(s,a))]\vspace{-0.05in}
\displaystyle\phi(s,a)\sim p(\phi|s,a)=\text{Beta}(\alpha,\beta)\text{ where }%
[\alpha,\beta]=\log[1+\exp(f(s,a))]\vspace{-0.05in}
f
\alpha
\beta
p(\phi|\mathcal{D}_{e})
q(\phi|\mathcal{D}_{e})
\mathcal{D}_{kl}\Big{[}q(\phi|\mathcal{D}_{e})\|p(\phi|\mathcal{D}_{e})\Big{]}
\displaystyle\mathbb{E}_{q}\Big{[}\log p(\mathcal{D}_{e}|\phi)\Big{]}-\mathcal%
{D}_{kl}\Big{[}q(\phi|\mathcal{D}_{e})\|p(\phi)\Big{]}
\displaystyle\mathbb{E}_{q}\Big{[}\log p(\mathcal{D}_{e}|\phi)\Big{]}-\mathcal%
{D}_{kl}\Big{[}q(\phi|\mathcal{D}_{e})\|p(\phi)\Big{]}
\log p(\mathcal{D}_{e}|\phi)
\mathcal{D}_{kl}\Big{[}q(\phi|\mathcal{D})\|p(\phi)\Big{]}
\sum_{(s,a)\in\mathcal{D}}\mathcal{D}_{kl}\Big{[}q(\phi|s,a)\|p(\phi)\Big{]}
\displaystyle\mathcal{D}_{kl}\Big{[}q(\phi|s,a)\|p(\phi)\Big{]}=\log\Big{(}%
\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha^{0}+\beta^{0})}\Big{)}+\log\Big{(}%
\frac{\Gamma(\alpha^{0})\Gamma(\beta^{0})}{\Gamma(\alpha)\Gamma(\beta)}\Big{)}
\displaystyle\mathcal{D}_{kl}\Big{[}q(\phi|s,a)\|p(\phi)\Big{]}=
\displaystyle\log\Big{(}\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha^{0}+\beta^{0%
})}\Big{)}+\log\Big{(}\frac{\Gamma(\alpha^{0})\Gamma(\beta^{0})}{\Gamma(\alpha%
)\Gamma(\beta)}\Big{)}
\displaystyle+(\alpha-\alpha^{0})\Big{[}\psi(\alpha)-\psi(\alpha+\beta)\Big{]}%
+(\beta-\beta^{0})\Big{[}\psi(\beta)-\psi(\alpha+\beta)\Big{]}
\displaystyle+(\alpha-\alpha^{0})\Big{[}\psi(\alpha)-\psi(\alpha+\beta)\Big{]}%
+(\beta-\beta^{0})\Big{[}\psi(\beta)-\psi(\alpha+\beta)\Big{]}
[\alpha^{0},\beta^{0}]
[\alpha,\beta]
\Gamma
\psi
\mathbb{E}[1-\phi(\tau)]
\pm
X
X
X
\geq
\geq
\geq
\geq
\leq
\pm
\uparrow(\downarrow)
\leq 0.05
\pm
\uparrow(\downarrow)
\leq 0.05
\downarrow
\downarrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\mathcal{N}(0,0.001)
\mathcal{N}(0,0.01)
\mathcal{N}(0,0.1)
\mathcal{N}(0,0.001)
\mathcal{N}(0,0.01)
\mathcal{N}(0,0.1)
p(s_{t+1}|s_{t},a_{t})=f(s_{t},a_{t)}+\eta,\text{where }\eta\sim\mathcal{N}(%
\mu,\sigma))
\mathcal{N}(0,0.1)
\leq
\geq
7*7
\leq-3
\infty
\leq-3
\infty
\geq
\leq-0.01
-0.01<
<0
\leq-0.015
-0.015
-0.01
\leq-3
\infty
\geq 0.5
-\infty
0.5
f^{*}
\epsilon
\lambda
{B}
\mathcal{K}
\xi_{1}
\xi_{2}
\omega
\pi_{\theta}
V_{r}
V_{c}
s_{0}
\mathcal{D}_{roll}
b=1,2,\dots,{B}
\pi_{\theta}
\tau_{b}=[s_{0},a_{0},r_{0},c_{0},\dots,s_{T},a_{T},r_{T},c_{T}]
c_{t}=f^{*}\left(s_{t},a_{t}\right)
A^{r}_{t}
R_{t}
A^{c}_{t}
{C}_{t}
\mathcal{D}_{roll}=\mathcal{D}_{roll}\cup\{s_{t},a_{t},r_{t},A^{r}_{t},R_{t},c%
_{t},A^{c}_{t},{C}_{t}\}_{t=1}^{T}
\kappa=1,2,\dots,\mathcal{K}
s_{\kappa},a_{\kappa},r_{\kappa},A^{r}_{\kappa},R_{\kappa},c_{\kappa},A^{c}_{%
\kappa},{C}_{\kappa}
\mathcal{D}_{roll}
L^{CLIP}=\min\left[\frac{\pi(a_{\kappa}|s_{\kappa})}{\pi_{old}(a_{\kappa}|s_{%
\kappa})}(\hat{A}^{r}_{\kappa}+\lambda\hat{A}^{c}_{\kappa}),clip(\frac{\pi(a_{%
\kappa}|s_{\kappa})}{\pi_{old}(a_{\kappa}|s_{\kappa})},1-\omega,1+\omega)(\hat%
{A}^{r}_{\kappa}+\lambda\hat{A}^{c}_{\kappa})\right]
L^{VF}=\|V^{r}_{\theta}(s_{\kappa})-R_{\kappa}\|_{2}^{2}+\|V^{c}_{\theta}(s_{%
\kappa})-C_{\kappa}\|_{2}^{2}
\theta
-L^{CLIP}+\xi_{1}L^{VF}-\xi_{2}\mathcal{H}(\pi)
\lambda
L^{\lambda}
\lambda[\mathbb{E}_{\mathcal{D}_{roll}}(\hat{A}^{c})-\epsilon]
f^{*}
\lambda
{B}
\mathcal{K}
\xi_{1}
\xi_{2}
\pi_{\theta}
s_{0}
\mathcal{D}_{roll}
V(s)\in\mathbf{R}
\pi(s)\in\mathcal{A}(s)
s\in\mathcal{{S}}
s\in{S}
V(s)=\sum_{r,s^{\prime}}p(s^{\prime},r|s,\pi(s))[r-\lambda c^{*}+\gamma V(s^{%
\prime})]
c^{*}_{t}=f^{*}\left(s_{t}\right)
s\in{S}
\pi(s)=\arg\max_{a}\sum_{r,s^{\prime}}p(s^{\prime},r|s,\pi(s))[r-\lambda c^{*}%
+\gamma V(s^{\prime})]
c^{*}_{t}=f^{*}\left(s_{t}\right)
b=1,2,\dots,{B}
\tau_{b}=[s_{0},a_{0},c^{*}_{0},\dots,s_{T},a_{T},c^{*}_{T}]
c^{*}_{t}=f^{*}\left(s_{t}\right)
{C}_{t}
\tau_{b}
\mathcal{D}_{roll}=\mathcal{D}_{roll}\cup\{s_{t},a_{t},{C}_{t}\}_{t=1}^{T}
\lambda
L^{\lambda}
\lambda[\mathbb{E}_{\mathcal{D}_{roll}}({C}_{t})-\epsilon]
K
M
N
L
B
O(KL(M+N)/B)
<
<
>
>
<
<
>
>
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
P_{\mathcal{{C}}}(c|s,a)
P_{\mathcal{{C}}}(c|s,a)
P_{\mathcal{{C}}}(c|s,a)
\mathcal{N}(0,0.001)
\mathcal{N}(0,0.01)
\mathcal{N}(0,0.1)
\mathcal{N}(0,0.001)
\mathcal{N}(0,0.01)
\mathcal{N}(0,0.1)
