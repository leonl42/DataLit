x
y
x
y
0.2\cdot\text{pred}_{A}+0.8\cdot\text{pred}_{B}
K
[K]:=\{1,2,\dots,K\}
K
i\in[K]
D_{i}=\{(\mathbf{\bm{x}}_{s}^{(i)},y_{s}^{(i)})\}_{s=1}^{n_{i}}
n_{i}
i
\mathbf{\bm{x}}_{s}\in\mathcal{X}
y_{s}\in\mathcal{Y}
\mathcal{D}_{i}
\mathcal{X}\times\mathcal{Y}
h_{i}:\mathcal{X}\mapsto\mathcal{Y}
\mathcal{D}_{i}
i
j
\Phi^{*}
D_{i}
z_{i}
K
\mathcal{D}_{i}
\{\mathcal{D}_{j}\}_{j=1}^{K}
\mathbf{\bm{\pi}}_{i}\!=\![\pi_{i1},\dots,\pi_{iK}]\!\in\!\Delta^{K}
\Delta^{K}
K\!-\!1
\mathbf{\bm{\pi}}_{i}
z_{i}
i
\Pi:=[\mathbf{\bm{\pi}}_{1},\dots,\mathbf{\bm{\pi}}_{K}]^{\top}
\Pi_{ij}=\Pr(z_{i}=j)
p_{i}(y|\mathbf{\bm{x}})
-\log p_{i}(y|\mathbf{\bm{x}})=\ell(h_{\mathbf{\bm{\phi}}_{i}^{*}}(\mathbf{\bm%
{x}}),y)+c
\mathbf{\bm{\phi}}_{i}^{*}\in\mathbb{R}^{d}
\ell:\mathcal{Y}\times\mathcal{Y}\mapsto\mathbb{R}^{+}
c
\Phi^{*}=[\mathbf{\bm{\phi}}_{1}^{*},\dots,\mathbf{\bm{\phi}}_{K}^{*}]\in%
\mathbb{R}^{d\times K}
\Theta:=(\Phi,\Pi)
f(\Theta):=\frac{1}{n}\log p(D;\Theta)=\frac{1}{n}\sum_{i=1}^{K}\log p(D_{i};%
\Theta)=\frac{1}{n}\sum_{i=1}^{K}\log\sum_{z_{i}=1}^{K}p(D_{i},z_{i};\Theta).
D:=\cup_{i}D_{i}
n:=\sum_{i}n_{i}
\mathcal{L}(q,\Theta):=\frac{1}{n}\sum_{i}\mathbb{E}_{q(z_{i})}[\log p(D_{i},z%
_{i};\Theta)]+C,
C
\Theta
p_{i}(x)=p(x),\forall i\in[K]
t
q
p(z_{i}=j|D_{i};\Theta^{(t-1)})
\Theta^{(t-1)}
\displaystyle w_{ij}^{(t)}:=q^{(t)}(z_{i}=j)\propto\Pi_{ij}^{(t-1)}\exp\left[-%
\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}^{(t-1)}}(\mathbf{\bm{x}}%
_{s}^{(i)}),\ y_{s}^{(i)}\right)\right].
\displaystyle w_{ij}^{(t)}:=q^{(t)}(z_{i}=j)\propto\Pi_{ij}^{(t-1)}\exp\left[-%
\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}^{(t-1)}}(\mathbf{\bm{x}}%
_{s}^{(i)}),\ y_{s}^{(i)}\right)\right].
q^{(t)}
\mathcal{L}
\Theta=(\Phi,\Pi)
\displaystyle\Pi^{(t)}_{ij}=w^{(t)}_{ij}\qquad\text{and}\qquad\Phi^{(t)}\in%
\mathop{\mathrm{argmin}}_{\Phi}\frac{1}{n}\sum_{i=1}^{K}\widehat{\mathcal{L}}_%
{w,i}(\Phi)
\displaystyle\Pi^{(t)}_{ij}=w^{(t)}_{ij}\qquad\text{and}\qquad\Phi^{(t)}\in%
\mathop{\mathrm{argmin}}_{\Phi}\frac{1}{n}\sum_{i=1}^{K}\widehat{\mathcal{L}}_%
{w,i}(\Phi)
\displaystyle\text{where}\qquad\widehat{\mathcal{L}}_{w,i}(\Phi):=\sum_{j=1}^{%
K}w_{ij}^{(t)}\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(\mathbf{%
\bm{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right).
\displaystyle\text{where}\qquad\widehat{\mathcal{L}}_{w,i}(\Phi):=\sum_{j=1}^{%
K}w_{ij}^{(t)}\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(\mathbf{%
\bm{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right).
D_{i}
\mathbf{\bm{\phi}}_{j},j\neq i
\Pi_{ij}^{(t)}
w_{ij}^{(t)}
\Phi^{(t)}
\Phi
\Phi^{(t)}
i
w_{ij}^{(t)}
\nabla\widehat{\mathcal{L}}_{w,i}(\Phi^{(t-1)})
D_{i}
\nabla\widehat{\mathcal{L}}_{w,i}(\Phi^{(t-1)})
\nabla\widehat{\mathcal{L}}_{w,j}(\Phi^{(t-1)})
j\neq i
\eta>0
\Phi^{(t)}=\Phi^{(t-1)}-\eta\sum_{j=1}^{K}\nabla\widehat{\mathcal{L}}_{w,j}(%
\Phi^{(t-1)}).
\widehat{h}_{i}(\mathbf{\bm{x}})=\sum_{j}w_{ij}^{(t)}h_{\mathbf{\bm{\phi}}^{(t%
)}_{j}}(\mathbf{\bm{x}})
w_{ij}^{(t)}
\Pi_{ij}^{(t)}
\mathbf{\bm{\phi}}_{j}
D_{i}
w_{ij}^{(t)}
i
i
w_{ij}^{(t)}
i
\mathbf{\bm{\phi}}_{j}
z
\Pi
\mathbf{\bm{\pi}}
\Pi
z
\eta=\frac{a_{0}}{\sqrt{T}}
T
\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\|\nabla_{\Phi}f(\Phi^{t},\Pi^{t})\|_{F}^{2%
}\leq\mathcal{O}\left(\frac{1}{\sqrt{T}}\right),\qquad\frac{1}{T}\sum_{t=1}^{T%
}\Delta_{\Pi}f(\Phi^{t},\Pi^{t})\leq\mathcal{O}\left(\frac{1}{T^{3/4}}\right),
\Delta_{\Pi}f(\Phi^{t},\Pi^{t}):=f(\Phi^{t},\Pi^{t})-f(\Phi^{t},\Pi^{t+1})\geq
0
\Phi
\Pi
T
f
\Phi
i
\ell(\mathbf{\bm{\phi}}_{j}^{(t-1)})
p(D_{i}|z_{i}=j;\Phi^{(t-1)})
\mathbf{\bm{\phi}}_{j},j\neq i
\Phi
\ell(\mathbf{\bm{\phi}}_{j}^{(t-1)})
\ell(\mathbf{\bm{\phi}}_{j}^{(t-2)})
{\mathcal{S}}
\epsilon
\Phi
\mathbf{\bm{\phi}}_{i}
\mathbf{\bm{\phi}}_{i}
-\eta\sum_{j=1}^{K}w_{ji}^{(t)}\sum_{s=1}^{n_{j}}\nabla_{\mathbf{\bm{\phi}}_{i%
}}\ell\left(h_{\mathbf{\bm{\phi}}_{i}}(\mathbf{\bm{x}}_{s}^{(j)}),\ y_{s}^{(j)%
}\right).
w_{ji}^{(t)}
w_{ij}^{(t)}
\mathbf{\bm{\phi}}_{i}
i
\mathbf{\bm{\phi}}_{i}
w_{ji}^{(t)}=0,\ \forall j
i
j
{\mathcal{S}}
\mathbf{\bm{\phi}}_{i}
j
\mathbf{\bm{g}}_{ij}:=w_{ji}^{(t)}\sum_{s=1}^{n_{j}}\nabla_{\mathbf{\bm{\phi}}%
_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{i}}(\mathbf{\bm{x}}_{s}^{(j)}),\ y_{s}^{%
(j)}\right)
j
\mathbf{\bm{g}}_{ij}
w_{ji}^{(t)}
\mathbf{\bm{\phi}}_{i}
\epsilon
{\mathcal{S}}
\epsilon
\epsilon\in[0,1]
\epsilon
\epsilon
M
\epsilon
w_{ij}^{(t)}
w_{ij}^{(t)}
L_{ij}^{(t)}:=\sum_{\tau=1}^{t-1}\ell_{ij}^{(\tau)}
\mathbf{\bm{\phi}}_{j}
i
i
\mathbf{\bm{\phi}}_{j}
\mathbf{\bm{\phi}}_{j}
\beta\in[0,1)
\widehat{L}_{ij}^{(t)}=(1-\beta)\widehat{L}_{ij}^{(t-1)}+\beta l_{ij}^{(t)}
w_{ij}^{(t)}
\widehat{L}_{ij}^{(t)}
\epsilon=0.3
\beta=0.6
20\%
0.01
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
w_{ij}^{(t)}
\epsilon=1
\epsilon
\epsilon
\beta
\beta
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon=1
\epsilon
\epsilon=0.3
M\in\{0,1,3,5,7\}
M=0
M=1
M=3
\beta
\beta
\beta\in\{0.1,0.3,0.6,0.9\}
\beta
\beta
\beta
\beta
\beta=0.6
i\in[K]
\displaystyle\log\sum_{z_{i}=1}^{K}p(D_{i},z_{i};\Theta)=\log\sum_{z_{i}=1}^{K%
}q(z_{i})\cdot\frac{p(D_{i},z_{i};\Theta)}{q(z_{i})}
\displaystyle\log\sum_{z_{i}=1}^{K}p(D_{i},z_{i};\Theta)
\displaystyle=\log\sum_{z_{i}=1}^{K}q(z_{i})\cdot\frac{p(D_{i},z_{i};\Theta)}{%
q(z_{i})}
\displaystyle=\log\mathbb{E}_{q(z_{i})}\left[\frac{p(D_{i},z_{i};\Theta)}{q(z_%
{i})}\right]
\displaystyle=\log\mathbb{E}_{q(z_{i})}\left[\frac{p(D_{i},z_{i};\Theta)}{q(z_%
{i})}\right]
\displaystyle\geq\mathbb{E}_{q(z_{i})}\left[\log\frac{p(D_{i},z_{i};\Theta)}{q%
(z_{i})}\right]
\displaystyle\geq\mathbb{E}_{q(z_{i})}\left[\log\frac{p(D_{i},z_{i};\Theta)}{q%
(z_{i})}\right]
\displaystyle=\mathbb{E}_{q(z_{i})}\left[\log p(D_{i},z_{i};\Theta)\right]-%
\mathbb{E}_{q(z_{i})}[\log q(z_{i})],
\displaystyle=\mathbb{E}_{q(z_{i})}\left[\log p(D_{i},z_{i};\Theta)\right]-%
\mathbb{E}_{q(z_{i})}[\log q(z_{i})],
q
\mathbb{E}_{q(z_{i})}[\log q(z_{i})]
\Theta
p_{i}(y|\mathbf{\bm{x}})
p_{i}(\mathbf{\bm{x}})
-\log p(D_{i}|z_{i}=j;\Phi)=\sum_{s=1}^{n_{i}}\ell(h_{\mathbf{\bm{\phi}}_{j}}(%
\mathbf{\bm{x}}_{s})^{(i)},y_{s}^{(i)})-\log p(\mathbf{\bm{x}}_{s}^{(i)})+c.
q
\Theta^{(t-1)}
\displaystyle w_{ij}^{(t)}:=q^{(t)}(z_{i}=j)=p(z_{i}=j|D_{i};\Theta^{(t-1)})
\displaystyle w_{ij}^{(t)}
\displaystyle:=q^{(t)}(z_{i}=j)=p(z_{i}=j|D_{i};\Theta^{(t-1)})
\displaystyle=\frac{p(z_{i}=j|\Pi^{(t-1)})\cdot p(D_{i}|z_{i}=j;\Phi^{(t-1)})}%
{\sum_{j^{\prime}=1}^{K}p(z_{i}=j^{\prime}|\Pi^{(t-1)})\cdot p(D_{i}|z_{i}=j^{%
\prime};\Phi^{(t-1)})}
\displaystyle=\frac{p(z_{i}=j|\Pi^{(t-1)})\cdot p(D_{i}|z_{i}=j;\Phi^{(t-1)})}%
{\sum_{j^{\prime}=1}^{K}p(z_{i}=j^{\prime}|\Pi^{(t-1)})\cdot p(D_{i}|z_{i}=j^{%
\prime};\Phi^{(t-1)})}
\displaystyle=\frac{\Pi_{ij}^{(t-1)}\cdot p(D_{i}|z_{i}=j;\Phi^{(t-1)})}{\sum_%
{j^{\prime}=1}^{K}\Pi_{ij^{\prime}}^{(t-1)}\cdot p(D_{i}|z_{i}=j^{\prime};\Phi%
^{(t-1)})}
\displaystyle=\frac{\Pi_{ij}^{(t-1)}\cdot p(D_{i}|z_{i}=j;\Phi^{(t-1)})}{\sum_%
{j^{\prime}=1}^{K}\Pi_{ij^{\prime}}^{(t-1)}\cdot p(D_{i}|z_{i}=j^{\prime};\Phi%
^{(t-1)})}
\displaystyle\propto\Pi_{ij}^{(t-1)}\exp\left[-\sum_{s=1}^{n_{i}}\ell\left(h_{%
\mathbf{\bm{\phi}}_{j}^{(t-1)}}(\mathbf{\bm{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right%
)\right].
\displaystyle\propto\Pi_{ij}^{(t-1)}\exp\left[-\sum_{s=1}^{n_{i}}\ell\left(h_{%
\mathbf{\bm{\phi}}_{j}^{(t-1)}}(\mathbf{\bm{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right%
)\right].
\displaystyle\mathcal{L}(q^{(t)},\Theta)=\frac{1}{n}\sum_{i}\sum_{j}w_{ij}^{(t%
)}\cdot\log p(D_{i},z_{i}=j;\Theta)+C
\displaystyle\mathcal{L}(q^{(t)},\Theta)
\displaystyle=\frac{1}{n}\sum_{i}\sum_{j}w_{ij}^{(t)}\cdot\log p(D_{i},z_{i}=j%
;\Theta)+C
\displaystyle=\frac{1}{n}\sum_{i}\sum_{j}w_{ij}^{(t)}\cdot\left(\ \log p(z_{i}%
=j;\Pi)+\log p(D_{i}|z_{i}=j;\Phi)\ \right)+C
\displaystyle=\frac{1}{n}\sum_{i}\sum_{j}w_{ij}^{(t)}\cdot\left(\ \log p(z_{i}%
=j;\Pi)+\log p(D_{i}|z_{i}=j;\Phi)\ \right)+C
\displaystyle=\frac{1}{n}\sum_{i}\sum_{j}w_{ij}^{(t)}\cdot\left(\ \log\Pi_{ij}%
+\log p(D_{i}|z_{i}=j;\Phi)\ \right)+C.
\displaystyle=\frac{1}{n}\sum_{i}\sum_{j}w_{ij}^{(t)}\cdot\left(\ \log\Pi_{ij}%
+\log p(D_{i}|z_{i}=j;\Phi)\ \right)+C.
w_{ij}^{(t)}
\mathcal{L}
\Theta=(\Phi,\Pi)
\Pi
i
\Pi
\Pi
\Pi_{ij}^{(t)}=w_{ij}^{(t)}
i
\Pi_{ij}
w_{ij}^{(t)}
\Phi
\displaystyle\Phi^{(t)}\in\mathop{\mathrm{argmax}}_{\Phi}\mathcal{L}(q^{(t)},%
\Theta)=\mathop{\mathrm{argmin}}_{\Phi}\frac{1}{n}\sum_{i=1}^{K}\sum_{j=1}^{K}%
w_{ij}^{(t)}\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(\mathbf{\bm%
{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right).
\displaystyle\Phi^{(t)}\in\mathop{\mathrm{argmax}}_{\Phi}\mathcal{L}(q^{(t)},%
\Theta)=\mathop{\mathrm{argmin}}_{\Phi}\frac{1}{n}\sum_{i=1}^{K}\sum_{j=1}^{K}%
w_{ij}^{(t)}\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(\mathbf{\bm%
{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right).
\ell_{ij}^{(t)}:=\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}^{(t)}}(%
\mathbf{\bm{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right)
\displaystyle w_{ij}^{(t)}=p(z_{i}=j|D_{i};\Theta^{(t-1)})
\displaystyle w_{ij}^{(t)}
\displaystyle=p(z_{i}=j|D_{i};\Theta^{(t-1)})
\displaystyle\propto w_{ij}^{(t-1)}\exp\left[-\ell_{ij}^{(t-1)}\right]
\displaystyle\propto w_{ij}^{(t-1)}\exp\left[-\ell_{ij}^{(t-1)}\right]
\displaystyle\propto w_{ij}^{(t-2)}\exp\left[-\left(\ell_{ij}^{(t-2)}+\ell_{ij%
}^{(t-1)}\right)\right].
\displaystyle\propto w_{ij}^{(t-2)}\exp\left[-\left(\ell_{ij}^{(t-2)}+\ell_{ij%
}^{(t-1)}\right)\right].
\mathbf{\bm{\phi}}_{j}^{(t-2)}
\mathbf{\bm{\phi}}_{j}^{(t-1)}
\Pi_{ij}^{(0)}=1/K,\forall j
w^{(t)}
L_{ij}^{(t)}:=\sum_{\tau=1}^{t-1}\ell_{ij}^{(\tau)}
t
\{D_{i}\}_{i=1}^{K}
r
M
\epsilon
\epsilon
\beta
\eta
\{\mathbf{\bm{\phi}}_{i}\}_{i=1}^{K}
w_{ij}
\{\mathbf{\bm{\phi}}_{i}\}_{i=1}^{K}
C_{i}
\{C_{i}\}_{i=1}^{K}
\widehat{L}_{ij}^{(0)}=0,\ell_{ij}^{(0)}=0,w_{ij}^{(0)}=\frac{1}{K}
t=1\dots T
C_{i}
\{C_{i}\}_{i=1}^{K}
M
B^{t}
\epsilon
w_{ij}^{(t-1)}
\mathbf{\bm{\phi}}_{i}
C_{i}
\mathbf{\bm{\phi}}_{j}
B^{t}
\ell_{ij}^{(t)}=\ell_{ij}^{(t-1)}
B^{t}
\ell_{ib}^{(t)}=\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{b}^{(t)}}(%
\mathbf{\bm{x}}_{s}^{(i)}),\ y_{s}^{(i)}\right)
\widehat{L}_{ij}^{(t)}=(1-\beta)\widehat{L}_{ij}^{(t-1)}+\beta\ell_{ij}^{(t)}
w_{ij}^{(t)}=\frac{\exp(-\widehat{L}_{ij}^{(t)})}{\sum_{j^{\prime}=1}^{K}\exp(%
-\widehat{L}_{ij^{\prime}}^{(t)})}
C_{b}
B^{t}
\mathbf{\bm{g}}_{bi}=w_{ib}^{(t)}\nabla_{\mathbf{\bm{\phi}}_{b}}\sum_{s=1}^{n_%
{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{b}}(\mathbf{\bm{x}}_{s}^{(i)}),\ y_{s}^{(%
i)}\right)
C_{b}
C_{j}
C_{i}
\mathbf{\bm{g}}_{ij}=w_{ji}^{(t)}\sum_{s=1}^{n_{j}}\nabla_{\mathbf{\bm{\phi}}_%
{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{i}}(\mathbf{\bm{x}}_{s}^{(j)}),\ y_{s}^{(%
j)}\right)
\mathbf{\bm{\phi}}_{i}^{t}=\mathbf{\bm{\phi}}_{i}^{(t-1)}-\eta\sum_{j}\mathbf{%
\bm{g}}_{ij}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\forall i\in[K],p_{i}(x)=p(x)
p_{i}(y|x)
-\log p_{i}(y|x)=\ell(h_{\mathbf{\bm{\phi}}_{i}^{*}}(x),y)+c,
\mathbf{\bm{\phi}}^{*}_{i}\in\mathbb{R}^{d}
\ell:\mathcal{Y}\times\mathcal{Y}\mapsto\mathbb{R}^{+}
c
f(\Phi,\Pi):=\frac{1}{n}\log p(D;\Phi,\Pi)
f
f^{*}\in\mathbb{R}
x,y
\mathbf{\bm{\phi}}\mapsto\ell(h_{\mathbf{\bm{\phi}}}(x),y)
L
B<\infty
\|\nabla_{\mathbf{\bm{\phi}}}\ell(h_{\mathbf{\bm{\phi}}}(x),y)\|\leq B
i\in[K]
\xi
\mathbf{\bm{g}}_{i}(\mathbf{\bm{\phi}},\xi)
\mathbb{E}_{\xi}[\mathbf{\bm{g}}_{i}(\mathbf{\bm{\phi}},\xi)]\!=\!\frac{1}{n_{%
i}}\sum_{s=1}^{n_{i}}\nabla\ell(h_{\mathbf{\bm{\phi}}}(\mathbf{\bm{x}}_{i}^{(s%
)}),y_{i}^{(s)})
\mathbb{E}_{\xi}\|\mathbf{\bm{g}}_{t}(\mathbf{\bm{\phi}},\xi)\!-\!\frac{1}{n_{%
i}}\sum_{s=1}^{n_{i}}\nabla\ell(h_{\mathbf{\bm{\phi}}}(\mathbf{\bm{x}}_{i}^{(s%
)}),y_{i}^{(s)})\|\leq\sigma^{2}
\beta
G
\mathbf{\bm{\gamma}}\in\Delta^{K}
\sum_{i=1}^{K}\frac{n_{i}}{n}\left\|\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j=1%
}^{K}\gamma_{j}\nabla\ell(h_{\mathbf{\bm{\phi}}}(\mathbf{\bm{x}}_{i}^{(s)}),y_%
{i}^{(s)})\right\|^{2}\leq G^{2}+\beta^{2}\left\|\frac{1}{n}\sum_{i=1}^{K}\sum%
_{s=1}^{n_{i}}\sum_{j=1}^{K}\gamma_{j}\nabla\ell(h_{\mathbf{\bm{\phi}}}(%
\mathbf{\bm{x}}_{i}^{(s)}),y_{i}^{(s)})\right\|^{2}.
g_{i}
g
f_{i}
f
f_{i}(\Theta)=f_{i}(\Phi,\pi_{i}):=-\frac{1}{n_{i}}\log p(D_{i}|\Phi,\pi_{i})=%
-\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\log p(x_{i}^{(s)},y_{i}^{(s)}|\Phi,\pi_{i}),
\displaystyle g_{i}^{(t)}(\Phi,\Pi):=g_{i}^{(t)}(\Phi,\mathbf{\bm{\pi}}_{i})
\displaystyle g_{i}^{(t)}(\Phi,\Pi)
\displaystyle:=g_{i}^{(t)}(\Phi,\mathbf{\bm{\pi}}_{i})
\displaystyle:=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j=1}^{K}q_{j}^{(t)}\left%
[\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(x_{i}^{(s)}),y_{i}^{(s)}\right)-\log p_{%
j}(x_{i}^{(s)})-\log\pi_{ij}+\log q_{j}^{(t)}-c\right],
\displaystyle:=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j=1}^{K}q_{j}^{(t)}\left%
[\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(x_{i}^{(s)}),y_{i}^{(s)}\right)-\log p_{%
j}(x_{i}^{(s)})-\log\pi_{ij}+\log q_{j}^{(t)}-c\right],
\displaystyle g^{(t)}(\Phi,\Pi):=\sum_{i=1}^{K}\frac{n_{i}}{n}g_{i}^{(t)}(\Phi%
,\mathbf{\bm{\pi}}_{i}),
\displaystyle g^{(t)}(\Phi,\Pi)
\displaystyle:=\sum_{i=1}^{K}\frac{n_{i}}{n}g_{i}^{(t)}(\Phi,\mathbf{\bm{\pi}}%
_{i}),
(\Phi^{(t-1)},\Pi^{(t-1)})
g^{(t)}
f
g_{i}^{(t)}(\Phi,\Pi)\geq f_{i}(\Phi,\Pi),\forall t,\Phi,\Pi
r_{i}^{(t)}(\Phi,\Pi):=g_{i}^{(t)}(\Phi,\Pi)-f_{i}(\Phi,\Pi)
\widetilde{L}
\Phi
\widetilde{L}<\infty
r_{i}^{(t)}(\Phi^{(t-1)},\Pi^{(t-1)})=0
\nabla_{\Phi}r_{i}(\Phi^{(t-1)},\Pi^{(t-1)})=\mathbf{\bm{0}}
g_{i}^{(t)}(\Phi,\Pi^{(t-1)})-g_{i}(\Phi,\Pi)=\mathsf{d}(\Pi^{(t-1)},\Pi)
\Phi
\Pi\in\mathop{\mathrm{argmin}}_{\Pi^{\prime}}g(\Phi,\Pi^{\prime})
\mathsf{d}
\mathsf{d}(\Pi,\Pi^{\prime})=0
\Pi=\Pi^{\prime}
t
\displaystyle q_{j}:=q_{i}(z_{i}=j),
\displaystyle q_{j}
\displaystyle:=q_{i}(z_{i}=j),
\displaystyle\mathcal{L}_{j}:=\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}%
}_{j}}(x_{i}^{(s)}),y_{i}^{(s)}\right),
\displaystyle\mathcal{L}_{j}
\displaystyle:=\sum_{s=1}^{n_{i}}\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(x_{i}^{(%
s)}),y_{i}^{(s)}\right),
\displaystyle\gamma_{j}:=p_{i}(z_{i}=j|D_{i},\Phi,\mathbf{\bm{\pi}}_{i}).
\displaystyle\gamma_{j}
\displaystyle:=p_{i}(z_{i}=j|D_{i},\Phi,\mathbf{\bm{\pi}}_{i}).
\displaystyle g_{i}(\Phi,\mathbf{\bm{\pi}}_{i})=\frac{1}{n_{i}}\sum_{s=1}^{n_{%
i}}\sum_{j=1}^{K}q_{j}\left[\ell\left(h_{\mathbf{\bm{\phi}}_{j}}(x_{i}^{(s)}),%
y_{i}^{(s)}\right)-\log p_{j}(x_{i}^{(s)})-\log\pi_{ij}+\log q_{j}-c\right]
\displaystyle g_{i}(\Phi,\mathbf{\bm{\pi}}_{i})
\displaystyle=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j=1}^{K}q_{j}\left[\ell%
\left(h_{\mathbf{\bm{\phi}}_{j}}(x_{i}^{(s)}),y_{i}^{(s)}\right)-\log p_{j}(x_%
{i}^{(s)})-\log\pi_{ij}+\log q_{j}-c\right]
\displaystyle=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j}q_{j}\left[-\log\left(p%
_{j}(y_{i}^{(s)}|x_{i}^{(s)},\mathbf{\bm{\phi}}_{j})\cdot p_{j}(x_{i}^{(s)})%
\cdot p_{i}(z_{i}=j)\right)+\log q_{j}\right]
\displaystyle=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j}q_{j}\left[-\log\left(p%
_{j}(y_{i}^{(s)}|x_{i}^{(s)},\mathbf{\bm{\phi}}_{j})\cdot p_{j}(x_{i}^{(s)})%
\cdot p_{i}(z_{i}=j)\right)+\log q_{j}\right]
\displaystyle=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j}q_{j}\left[-\log p_{i}%
\left(x_{i}^{(s)},y_{i}^{(s)},z_{i}=j\middle|\Phi,\mathbf{\bm{\pi}}_{i}\right)%
+\log q_{j}\right]
\displaystyle=\frac{1}{n_{i}}\sum_{s=1}^{n_{i}}\sum_{j}q_{j}\left[-\log p_{i}%
\left(x_{i}^{(s)},y_{i}^{(s)},z_{i}=j\middle|\Phi,\mathbf{\bm{\pi}}_{i}\right)%
+\log q_{j}\right]
\displaystyle=\frac{1}{n_{i}}\sum_{j}q_{j}\left[-\log p_{i}\left(D_{i},z_{i}=j%
\middle|\Phi,\mathbf{\bm{\pi}}_{i}\right)+\log q_{j}\right].
\displaystyle=\frac{1}{n_{i}}\sum_{j}q_{j}\left[-\log p_{i}\left(D_{i},z_{i}=j%
\middle|\Phi,\mathbf{\bm{\pi}}_{i}\right)+\log q_{j}\right].
\displaystyle r_{i}(\Phi,\mathbf{\bm{\pi}}_{i})=g_{i}(\Phi,\mathbf{\bm{\pi}}_{%
i})-f_{i}(\Phi,\mathbf{\bm{\pi}}_{i})
\displaystyle r_{i}(\Phi,\mathbf{\bm{\pi}}_{i})
\displaystyle=g_{i}(\Phi,\mathbf{\bm{\pi}}_{i})-f_{i}(\Phi,\mathbf{\bm{\pi}}_{%
i})
\displaystyle=\frac{1}{n_{i}}\mathcal{KL}\left(\ q(\cdot)\ \middle\|\ p_{t}(%
\cdot|D_{i},\Phi,\mathbf{\bm{\pi}}_{i})\ \right),
\displaystyle=\frac{1}{n_{i}}\mathcal{KL}\left(\ q(\cdot)\ \middle\|\ p_{t}(%
\cdot|D_{i},\Phi,\mathbf{\bm{\pi}}_{i})\ \right),
\mathcal{KL}
r_{t}
\displaystyle\gamma_{j}=p_{i}(z_{i}=j|D_{i},\Phi,\mathbf{\bm{\pi}}_{i})=\frac{%
\exp\left[-\mathcal{L}_{j^{\prime}}+\log\pi_{ij}\right]}{\sum_{j^{\prime}}\exp%
\left[-\mathcal{L}_{j^{\prime}}+\log\pi_{ij^{\prime}}\right]},
\displaystyle\gamma_{j}
\displaystyle=p_{i}(z_{i}=j|D_{i},\Phi,\mathbf{\bm{\pi}}_{i})=\frac{\exp\left[%
-\mathcal{L}_{j^{\prime}}+\log\pi_{ij}\right]}{\sum_{j^{\prime}}\exp\left[-%
\mathcal{L}_{j^{\prime}}+\log\pi_{ij^{\prime}}\right]},
\displaystyle\nabla_{\mathbf{\bm{\phi}}_{j^{\prime}}}\gamma_{j}=\begin{cases}(%
-\gamma_{j}+\gamma^{2}_{j})\nabla\mathcal{L}_{j}\qquad\text{if }j^{\prime}=j\\
\gamma_{j}\gamma_{j^{\prime}}\nabla\mathcal{L}_{j^{\prime}}\qquad\text{if }j^{%
\prime}\neq j,\\
\end{cases}
\displaystyle\nabla_{\mathbf{\bm{\phi}}_{j^{\prime}}}\gamma_{j}
\displaystyle=\begin{cases}(-\gamma_{j}+\gamma^{2}_{j})\nabla\mathcal{L}_{j}%
\qquad\text{if }j^{\prime}=j\\
\gamma_{j}\gamma_{j^{\prime}}\nabla\mathcal{L}_{j^{\prime}}\qquad\text{if }j^{%
\prime}\neq j,\\
\end{cases}
\nabla\mathcal{L}_{j}
\nabla_{\mathbf{\bm{\phi}}_{j}}\mathcal{L}_{j}
\displaystyle\nabla_{\mathbf{\bm{\phi}}_{j^{\prime}}}r_{i}=\frac{1}{n_{i}}%
\nabla_{\mathbf{\bm{\phi}}_{j^{\prime}}}\sum_{j}(-q_{j}\log\gamma_{j})
\displaystyle\nabla_{\mathbf{\bm{\phi}}_{j^{\prime}}}r_{i}
\displaystyle=\frac{1}{n_{i}}\nabla_{\mathbf{\bm{\phi}}_{j^{\prime}}}\sum_{j}(%
-q_{j}\log\gamma_{j})
\mathcal{K}\mathcal{L}
\mathcal{K}\mathcal{L}
\displaystyle=\frac{1}{n_{i}}\sum_{j}\left(-\frac{q_{j}}{\gamma_{j}}\nabla_{%
\mathbf{\bm{\phi}}_{j^{\prime}}}\gamma_{j}\right)
\displaystyle=\frac{1}{n_{i}}\sum_{j}\left(-\frac{q_{j}}{\gamma_{j}}\nabla_{%
\mathbf{\bm{\phi}}_{j^{\prime}}}\gamma_{j}\right)
\displaystyle=\frac{1}{n_{i}}\left[q_{j^{\prime}}(1-\gamma_{j^{\prime}})-\sum_%
{j\neq j^{\prime}}q_{j}\gamma_{j^{\prime}}\right]\nabla\mathcal{L}_{j^{\prime}}\qquad
\displaystyle=\frac{1}{n_{i}}\left[q_{j^{\prime}}(1-\gamma_{j^{\prime}})-\sum_%
{j\neq j^{\prime}}q_{j}\gamma_{j^{\prime}}\right]\nabla\mathcal{L}_{j^{\prime}}\qquad
j=j^{\prime}
j\neq j^{\prime}
j=j^{\prime}
j\neq j^{\prime}
\displaystyle=\frac{1}{n_{i}}\left[q_{j^{\prime}}(1-\gamma_{j^{\prime}})-(1-q_%
{j^{\prime}})\gamma_{j^{\prime}}\right]\nabla\mathcal{L}_{j^{\prime}}
\displaystyle=\frac{1}{n_{i}}\left[q_{j^{\prime}}(1-\gamma_{j^{\prime}})-(1-q_%
{j^{\prime}})\gamma_{j^{\prime}}\right]\nabla\mathcal{L}_{j^{\prime}}
\displaystyle\sum_{j}q_{j}=1
\displaystyle\sum_{j}q_{j}=1
\displaystyle=\frac{1}{n_{i}}(q_{j^{\prime}}-\gamma_{j^{\prime}})\nabla%
\mathcal{L}_{j^{\prime}}.
\displaystyle=\frac{1}{n_{i}}(q_{j^{\prime}}-\gamma_{j^{\prime}})\nabla%
\mathcal{L}_{j^{\prime}}.
r_{i}
\mathbf{\bm{H}}(r_{i})\in\mathbb{R}^{dK\times dK}
\Phi
\Big{(}\mathbf{\bm{H}}(r_{t})\Big{)}_{j,j^{\prime}}=\begin{cases}\frac{1}{n_{i%
}}\left[(q_{j}-\gamma_{j})\mathbf{\bm{H}}(\mathcal{L}_{j})+(\gamma_{j}-\gamma^%
{2}_{j})(\nabla\mathcal{L}_{j})(\nabla\mathcal{L}_{j})^{\top}\right]\\
-\frac{1}{n_{i}}\gamma_{j}\gamma_{j^{\prime}}(\nabla\mathcal{L}_{j})(\nabla%
\mathcal{L}_{j^{\prime}})^{\top}\qquad\text{when $j\neq j^{\prime}$},\end{cases}
j\neq j^{\prime}
\mathbf{\bm{H}}(\mathcal{L}_{j})\in\mathbb{R}^{d\times d}
\mathcal{L}_{\mathbf{\bm{\phi}}_{j}}(D_{t})
\mathbf{\bm{\phi}}_{j}
\widetilde{\mathbf{\bm{H}}},\widehat{\mathbf{\bm{H}}}\in\mathbb{R}^{dK\times dK}
\begin{split}\widetilde{\mathbf{\bm{H}}}_{j,j^{\prime}}&=\begin{cases}\frac{1}%
{n_{i}}(\gamma_{j}-\gamma^{2}_{j})(\nabla\mathcal{L}_{j})(\nabla\mathcal{L}_{j%
})^{\top}\\
-\frac{1}{n_{i}}\gamma_{j}\gamma_{j^{\prime}}(\nabla\mathcal{L}_{j})(\nabla%
\mathcal{L}_{j^{\prime}})^{\top}\qquad\text{when $j\neq j^{\prime}$},\end{%
cases}\\
\widehat{\mathbf{\bm{H}}}_{j,j^{\prime}}&=\begin{cases}\frac{1}{n_{i}}(q_{j}-%
\gamma_{j})\mathbf{\bm{H}}(\mathcal{L}_{j})\\
\mathbf{\bm{0}}\qquad\text{when $j\neq j^{\prime}$}.\end{cases}\end{split}
j\neq j^{\prime}
j\neq j^{\prime}
q_{j},\gamma_{j}\in[0,1]
\ell
L
-L\cdot I_{dK}\preccurlyeq\widehat{\mathbf{\bm{H}}}\preccurlyeq L\cdot I_{dK}
\mathbf{\bm{0}}\preccurlyeq\widetilde{\mathbf{\bm{H}}}\preccurlyeq B^{2}\cdot I%
_{dK}
\nabla\mathcal{L}_{j}
n_{i}
\mathbf{\bm{H}}(r_{t})
1/n_{i}
-\widetilde{L}\cdot I_{dK}\preccurlyeq\mathbf{\bm{H}}(r_{t})\preccurlyeq%
\widetilde{L}\cdot I_{dK}
\widetilde{L}=L+B^{2}<\infty
r_{t}
\widetilde{L}
q^{(t)}_{j}=p_{i}(z_{i}=j|D_{i},\Phi^{(t-1)},\mathbf{\bm{\pi}}^{(t-1)}_{i}),%
\forall t>0
r^{(t)}_{i}(\Phi^{(t-1)},\Pi^{(t-1)})=r_{i}^{(t)}(\Phi^{(t-1)},\mathbf{\bm{\pi%
}}_{i}^{(t-1)})=0.
r^{(t)}_{i}(\Phi,\mathbf{\bm{\pi}}_{i})
\Phi,\Pi
r_{i}^{(t)}
\Phi^{(t-1)}
\{\Phi\mapsto r_{i}^{(t)}(\Phi,\mathbf{\bm{\pi}}_{i}^{(t-1)})\}
\nabla_{\Phi}r_{i}^{(t)}(\Phi^{(t-1)},\mathbf{\bm{\pi}}_{i}^{(t-1)})=\mathbf{%
\bm{0}}.
\mathbf{\bm{\pi}}_{i}^{(t)}=\mathop{\mathrm{argmin}}_{\mathbf{\bm{\pi}}}g_{i}^%
{(t)}(\Phi,\mathbf{\bm{\pi}})
q_{i}^{(t)}
\mathbf{\bm{\pi}}_{i}
i\in[K]
\begin{split}g_{i}^{(t)}(\Phi,\mathbf{\bm{\pi}}_{i})-g_{i}^{(t)}(\Phi,\mathbf{%
\bm{\pi}}_{i}^{(t)})&=\sum_{j}q_{j}^{(t)}(\log\pi_{ij}^{(t)}-\log\pi_{ij})\\
&=\sum_{j}\pi_{ij}^{(t)}(\log\pi_{ij}^{(t)}-\log\pi_{ij})\\
&=\mathcal{KL}(\mathbf{\bm{\pi}}_{i}^{(t)}\|\mathbf{\bm{\pi}}_{i}),\end{split}
\mathbf{\bm{\pi}}_{i}^{(t)}=\mathbf{\bm{\pi}}_{i}
g,f
\{g_{i}\}_{i=1}^{K},\{f_{i}\}_{i=1}^{K}
g
f
\hbox{}\hfill\blacksquare
\mathbf{\bm{g}}_{1},\dots,\mathbf{\bm{g}}_{K}\in\mathbb{R}^{d}
\mathbf{\bm{\gamma}}=(\gamma_{1},\dots,\gamma_{K})\in\Delta^{K}
\mathbf{\bm{H}}\in\mathbb{R}^{dK}
\mathbf{\bm{H}}_{j,j^{\prime}}=\begin{cases}(\gamma_{j}-\gamma^{2}_{j})\mathbf%
{\bm{g}}_{j}\mathbf{\bm{g}}_{j}^{\top}\\
-\gamma_{j}\gamma_{j^{\prime}}\mathbf{\bm{g}}_{j}\mathbf{\bm{g}}_{j^{\prime}}^%
{\top}\qquad\text{when $j\neq j^{\prime}$},\end{cases}
j\neq j^{\prime}
\|\mathbf{\bm{g}}_{j}\|\leq B<\infty,\forall j\in[K]
\mathbf{\bm{H}}\preccurlyeq B^{2}\cdot I_{dK}
\mathbf{\bm{x}}=[\mathbf{\bm{x}}_{1},\dots,\mathbf{\bm{x}}_{K}]\in\mathbb{R}^{dK}
\displaystyle\mathbf{\bm{x}}^{\top}\mathbf{\bm{H}}\mathbf{\bm{x}}=\sum_{j,j^{%
\prime}=1}^{K}\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{H}}_{j,j^{\prime}}\mathbf{%
\bm{x}}_{j}
\displaystyle\mathbf{\bm{x}}^{\top}\mathbf{\bm{H}}\mathbf{\bm{x}}
\displaystyle=\sum_{j,j^{\prime}=1}^{K}\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{H%
}}_{j,j^{\prime}}\mathbf{\bm{x}}_{j}
\displaystyle=\sum_{j=1}^{K}\left(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{H}}_{j%
,j}\mathbf{\bm{x}}_{j}+\sum_{j^{\prime}\neq j}\mathbf{\bm{x}}_{j}^{\top}%
\mathbf{\bm{H}}_{j,j^{\prime}}\mathbf{\bm{x}}_{j^{\prime}}\right)
\displaystyle=\sum_{j=1}^{K}\left(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{H}}_{j%
,j}\mathbf{\bm{x}}_{j}+\sum_{j^{\prime}\neq j}\mathbf{\bm{x}}_{j}^{\top}%
\mathbf{\bm{H}}_{j,j^{\prime}}\mathbf{\bm{x}}_{j^{\prime}}\right)
\displaystyle=\sum_{j=1}^{K}(\gamma_{j}-\gamma_{j})^{2}\cdot(\mathbf{\bm{x}}_{%
j}^{\top}\mathbf{\bm{g}}_{j})^{2}-\sum_{j=1}^{K}\left(\sum_{j^{\prime}\neq j}%
\gamma_{j}\gamma_{j^{\prime}}\cdot(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{%
j})\cdot(\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}_{j^{\prime}})\right)
\displaystyle=\sum_{j=1}^{K}(\gamma_{j}-\gamma_{j})^{2}\cdot(\mathbf{\bm{x}}_{%
j}^{\top}\mathbf{\bm{g}}_{j})^{2}-\sum_{j=1}^{K}\left(\sum_{j^{\prime}\neq j}%
\gamma_{j}\gamma_{j^{\prime}}\cdot(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{%
j})\cdot(\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}_{j^{\prime}})\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(1-\gamma_{j})\cdot(\mathbf{\bm{x}}_{j}^%
{\top}\mathbf{\bm{g}}_{j})^{2}-\sum_{j=1}^{K}\left(\gamma_{j}(\mathbf{\bm{x}}_%
{j}^{\top}\mathbf{\bm{g}}_{j})\cdot\sum_{j^{\prime}\neq j}\gamma_{j^{\prime}}%
\cdot(\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}_{j^{\prime}})\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(1-\gamma_{j})\cdot(\mathbf{\bm{x}}_{j}^%
{\top}\mathbf{\bm{g}}_{j})^{2}-\sum_{j=1}^{K}\left(\gamma_{j}(\mathbf{\bm{x}}_%
{j}^{\top}\mathbf{\bm{g}}_{j})\cdot\sum_{j^{\prime}\neq j}\gamma_{j^{\prime}}%
\cdot(\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}_{j^{\prime}})\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}\left(\sum_{j^{\prime}\neq j}\gamma_{j^{%
\prime}}\right)\cdot(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j})^{2}-\sum_{%
j=1}^{K}\left(\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j})\cdot%
\sum_{j^{\prime}\neq j}\gamma_{j^{\prime}}\cdot(\mathbf{\bm{x}}_{j^{\prime}}^{%
\top}\mathbf{\bm{g}}_{j^{\prime}})\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}\left(\sum_{j^{\prime}\neq j}\gamma_{j^{%
\prime}}\right)\cdot(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j})^{2}-\sum_{%
j=1}^{K}\left(\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j})\cdot%
\sum_{j^{\prime}\neq j}\gamma_{j^{\prime}}\cdot(\mathbf{\bm{x}}_{j^{\prime}}^{%
\top}\mathbf{\bm{g}}_{j^{\prime}})\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g%
}}_{j})\cdot\sum_{j^{\prime}\neq j}\gamma_{j^{\prime}}\left(\mathbf{\bm{x}}_{j%
}^{\top}\mathbf{\bm{g}}_{j}-\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}%
_{j^{\prime}}\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g%
}}_{j})\cdot\sum_{j^{\prime}\neq j}\gamma_{j^{\prime}}\left(\mathbf{\bm{x}}_{j%
}^{\top}\mathbf{\bm{g}}_{j}-\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}%
_{j^{\prime}}\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g%
}}_{j})\cdot\sum_{j^{\prime}=1}^{K}\gamma_{j^{\prime}}\left(\mathbf{\bm{x}}_{j%
}^{\top}\mathbf{\bm{g}}_{j}-\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}%
_{j^{\prime}}\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g%
}}_{j})\cdot\sum_{j^{\prime}=1}^{K}\gamma_{j^{\prime}}\left(\mathbf{\bm{x}}_{j%
}^{\top}\mathbf{\bm{g}}_{j}-\mathbf{\bm{x}}_{j^{\prime}}^{\top}\mathbf{\bm{g}}%
_{j^{\prime}}\right)
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g%
}}_{j})^{2}-\left(\sum_{j=1}^{K}\gamma_{j}\mathbf{\bm{x}}_{j}^{\top}\mathbf{%
\bm{g}}_{j}\right)^{2}
\displaystyle=\sum_{j=1}^{K}\gamma_{j}(\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g%
}}_{j})^{2}-\left(\sum_{j=1}^{K}\gamma_{j}\mathbf{\bm{x}}_{j}^{\top}\mathbf{%
\bm{g}}_{j}\right)^{2}
\displaystyle=\mathbb{E}_{j\sim\mathbf{\bm{\gamma}}}[(\mathbf{\bm{x}}_{j}^{%
\top}\mathbf{\bm{g}}_{j})^{2}]-\left(\mathbb{E}_{j\sim\mathbf{\bm{\gamma}}}[%
\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j}]\right)^{2}
\displaystyle=\mathbb{E}_{j\sim\mathbf{\bm{\gamma}}}[(\mathbf{\bm{x}}_{j}^{%
\top}\mathbf{\bm{g}}_{j})^{2}]-\left(\mathbb{E}_{j\sim\mathbf{\bm{\gamma}}}[%
\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j}]\right)^{2}
\displaystyle=\mathbb{V}_{j\sim\mathbf{\bm{\gamma}}}[\mathbf{\bm{x}}_{j}^{\top%
}\mathbf{\bm{g}}_{j}]\geq 0,
\displaystyle=\mathbb{V}_{j\sim\mathbf{\bm{\gamma}}}[\mathbf{\bm{x}}_{j}^{\top%
}\mathbf{\bm{g}}_{j}]\geq 0,
\sum\gamma_{j}=1
\mathbb{E},\mathbb{V}
\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j}
\mathbf{\bm{H}}
\|\mathbf{\bm{g}}_{j}\|\leq B<\infty,\forall j\in[K]
-B\cdot\|\mathbf{\bm{x}}_{j}\|\leq-\|\mathbf{\bm{x}}_{j}\|\cdot\|\mathbf{\bm{g%
}}_{j}\|\leq\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j}\leq\|\mathbf{\bm{x}}%
_{j}\|\cdot\|\mathbf{\bm{g}}_{j}\|\leq B\cdot\|\mathbf{\bm{x}}_{j}\|.
\|\mathbf{\bm{x}}_{j}\|\leq\|\mathbf{\bm{x}}\|,\forall j\in[K]
-B\cdot\|\mathbf{\bm{x}}\|\leq\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j}%
\leq B\cdot\|\mathbf{\bm{x}}\|.
\mathbf{\bm{x}}^{\top}\mathbf{\bm{H}}\mathbf{\bm{x}}=\mathbb{V}_{j\sim\mathbf{%
\bm{\gamma}}}[\mathbf{\bm{x}}_{j}^{\top}\mathbf{\bm{g}}_{j}]\leq\frac{1}{4}(B%
\cdot\|\mathbf{\bm{x}}\|+B\cdot\|\mathbf{\bm{x}}\|)^{2}=B^{2}\|\mathbf{\bm{x}}%
\|^{2},
\mathbf{\bm{H}}\preccurlyeq B^{2}I_{dK}
\hbox{}\hfill\blacksquare
