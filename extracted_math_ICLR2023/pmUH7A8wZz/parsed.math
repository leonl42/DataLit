\mathbb{L}^{n}_{K}=(\mathcal{L},\mathfrak{g})
K
n
\mathcal{L}
(n+1)
\mathfrak{g}=\operatorname{diag}([-1,\bm{1}_{n}^{\top}])
\bm{1}_{n}
n
1
\mathbb{L}^{n}_{K}
{\bm{x}}=[x_{t},{\bm{x}}_{s}^{\top}]^{\top},x_{t}>0,{\bm{x}}_{s}\in\mathbb{R}^%
{n}
\left\langle{\bm{x}},{\bm{x}}\right\rangle_{{\mathcal{L}}}=1/K
\langle\cdot,\cdot\rangle_{\mathcal{L}}
\mathfrak{g}^{K}
\langle\bm{x},\bm{y}\rangle_{\mathcal{L}}\coloneqq\bm{x}^{\top}\mathfrak{g}\bm%
{y}=-x_{t}y_{t}+\bm{x}_{s}^{\top}\bm{y}_{s},~{}{\bm{x}},{\bm{y}}\in{\mathbb{L}%
}^{n}_{K}
x_{t}
{\bm{x}}_{s}
d_{\mathcal{L}}(\bm{x},\bm{y})
{\bm{x}},{\bm{y}}\in{\mathbb{L}}^{n}_{K}
\bm{x}\in\mathbb{L}^{n}_{K}
\bm{x}
\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}
\left\lVert\cdot\right\rVert_{\mathcal{L}}=\sqrt{\left\langle\cdot,\cdot\right%
\rangle_{\mathcal{L}}}
\bm{x},\bm{y}\in\mathbb{L}^{n}_{K}
\bm{v}\in\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}
\operatorname{exp}_{\bm{x}}^{K}(\bm{v})
{\bm{v}}
{\bm{x}}
\operatorname{log}_{\bm{x}}^{K}:\mathbb{L}^{n}_{K}\to\mathcal{T}_{\bm{x}}%
\mathbb{L}^{n}_{K}
\operatorname{log}_{\bm{x}}^{K}(\operatorname{exp}_{\bm{x}}^{K}(\bm{v}))=\bm{v}
\bm{x},\bm{y}\in\mathbb{L}^{n}_{K}
\operatorname{PT}^{K}_{\bm{x}\to\bm{y}}
\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}
\mathcal{T}_{\bm{y}}\mathbb{L}^{n}_{K}
\bm{x}
\bm{y}
\mathbb{L}^{n}_{K}
\mathbb{L}^{m}_{K}
\bm{x}\in\mathbb{L}_{K}^{n}
\bm{y}=\operatorname{HLinear}_{n,m}(\bm{x})=\begin{bmatrix}\sqrt{\|h(\bm{Wx},%
\bm{v})\|^{2}-1/K}\\
h(\bm{Wx},\bm{v})\end{bmatrix}.
h(\bm{W}\bm{x},\bm{v})=\frac{\lambda\sigma\left(\bm{v}^{\top}\bm{x}+b^{\prime}%
\right)}{\|\bm{W}\tau(\bm{x})+\bm{b}\|}(\bm{W}\tau(\bm{x})+\bm{b})
\bm{v}\in\mathbb{R}^{n+1}
\bm{W}\in\mathbb{R}^{m\times(n+1)}
\bm{b}
b^{\prime}
\sigma
\tau
\lambda>0
\operatorname{HLinear}
\mathbb{L}^{n}_{K}
\mathbb{R}^{m}
\bm{x}\in\mathbb{L}^{n}_{K}
m
\{\bm{c}_{i}\}_{i=1}^{m}\subset\mathbb{L}^{n}_{K}
\bm{y}=\operatorname{HCDist}_{n,m}(\bm{x})=[d_{\mathcal{L}}(\bm{x},\bm{c}_{1})%
\cdots d_{\mathcal{L}}(\bm{x},\bm{c}_{m})]^{\top}.
{\bm{z}}^{(0)}
\mathcal{G}(\bm{o},{\bm{I}})
\displaystyle L_{\rm WGAN}=\ \underset{\tilde{\bm{x}}\sim\mathbb{P}_{g}}{%
\mathbb{E}}[D(\tilde{\bm{x}})]-\underset{\bm{x}\sim\mathbb{P}_{r}}{\mathbb{E}}%
[D(\bm{x})]\ +\lambda\underset{\hat{\bm{x}}\sim\mathbb{P}_{\hat{x}}}{\mathbb{E%
}}\left[\left(\left\|\nabla D(\hat{\bm{x}})\right\|_{\mathcal{L}}-1\right)^{2}%
\right],
\displaystyle L_{\rm WGAN}=
\displaystyle\ \underset{\tilde{\bm{x}}\sim\mathbb{P}_{g}}{\mathbb{E}}[D(%
\tilde{\bm{x}})]-\underset{\bm{x}\sim\mathbb{P}_{r}}{\mathbb{E}}[D(\bm{x})]\ +%
\lambda\underset{\hat{\bm{x}}\sim\mathbb{P}_{\hat{x}}}{\mathbb{E}}\left[\left(%
\left\|\nabla D(\hat{\bm{x}})\right\|_{\mathcal{L}}-1\right)^{2}\right],
D
\nabla D(\hat{\bm{x}})
D(\bm{x})
\hat{\bm{x}}
\mathbb{P}_{g}
\mathbb{P}_{r}
\mathbb{P}_{\hat{\bm{x}}}
\mathbb{P}_{g}
\mathbb{P}_{r}
\mathbb{P}_{r}
\mathbb{P}_{g}
\mathbb{L}_{K}^{n}
f^{*}
\max_{\|f\|_{L}\leq 1}\mathbb{E}_{\bm{y}\sim\mathbb{P}_{r}}[f(\bm{y})]-\mathbb%
{E}_{\bm{x}\sim\mathbb{P}_{g}}[f(\bm{x})]
\left\lVert\cdot\right\rVert_{L}
\pi
\mathbb{P}_{r}
\mathbb{P}_{g}
W(\mathbb{P}_{r},\mathbb{P}_{g})=\inf_{\pi\in\Pi(\mathbb{P}_{r},\mathbb{P}_{g}%
)}\mathbb{E}_{x,y\sim\pi}[d_{\mathcal{L}}(\bm{x},\bm{y})]
\Pi(\mathbb{P}_{r},\mathbb{P}_{g})
\pi(\bm{x},\bm{y})
\mathbb{P}_{r}
\mathbb{P}_{g}
{\bm{x}}_{t}=\gamma(t),0\leq t\leq 1
\bm{x}
\bm{y}
\gamma(0)=\bm{x},\gamma(1)=\bm{y},\gamma^{\prime}(t)=\bm{v}_{t}\in\mathcal{T}%
\mathbb{L}_{K}^{n},\|\bm{v}_{t}\|_{\mathcal{L}}=d_{\mathcal{L}}(\bm{x},\bm{y})
f^{*}
\pi(\bm{x}=\bm{y})=0
\mathbb{P}_{(\bm{x},\bm{y})\sim\pi}\left[\nabla f^{*}\left(\bm{x}_{t}\right)=%
\frac{\bm{v}_{t}}{d_{\mathcal{L}}(\bm{x},\bm{y})}\right]=1.
\beta
\beta
\beta
\beta
\beta
\{\bm{x}_{i}\}_{i=1}^{N}
\bm{x}_{i}\in\mathbb{L}^{n_{i}}_{K}
{\bm{x}}_{i}
\bm{v}_{i}=\log_{\bm{o}}^{K}(\bm{x}_{i})=\begin{bmatrix}v_{i_{t}}\\
{\bm{v}}_{i_{s}}\end{bmatrix}\in\mathbb{R}^{n_{i}+1}
\bm{v}\coloneqq\left[0,\bm{v}_{1_{s}}^{\top},\ldots,\bm{v}_{N_{s}}^{\top}%
\right]^{\top}
\bm{y}=\exp_{\bm{o}}^{K}(\bm{v})
{\bm{y}}=\operatorname{HTCat}(\{{\bm{x}}_{i}\}_{i=1}^{N})
\bm{x}_{i}\in\mathbb{L}^{n}_{K}
\sum_{i=1}^{N}n_{i}=n
\bm{v}=\log_{\bm{o}}^{K}(\bm{x})=\left[0,\bm{v}_{1_{s}}^{\top}\in\mathbb{R}^{n%
_{1}},\ldots,\bm{v}_{N_{s}}^{\top}\in\mathbb{R}^{n_{N}}\right]^{\top}
\bm{v}_{i}=\begin{bmatrix}0\\
{\bm{v}}_{i_{s}}\end{bmatrix}\in\mathcal{T}_{\bm{o}}\mathbb{L}_{K}^{n_{i}}
\bm{y}_{i}=\exp_{\bm{o}}^{K}(\bm{v}_{i})
\lambda
{\bm{o}}
{\bm{o}}
\{\bm{x}_{i}\}_{i=1}^{N}
\bm{x}_{i}\in\mathbb{L}^{n_{i}}_{K}
M=\sum_{i=1}^{N}n_{i}
\{\bm{x}_{i}\}_{i=1}^{N}
\bm{y}\in\mathbb{L}^{M}_{k}
\bm{y}=\operatorname{HCat}(\{\bm{x}_{i}\}_{i=1}^{N})=\left[\sqrt{\sum_{i=1}^{N%
}x_{i_{t}}^{2}+(N-1)/{K}},\bm{x}_{1_{s}}^{\top},\cdots,\bm{x}_{N_{s}}^{\top}%
\right]^{\top}.
{\bm{x}}_{i_{s}}
{\bm{x}}_{i}
{\bm{x}}_{i}\in{\mathbb{L}}_{K}^{n_{i}}
\mathbb{R}^{n_{i}+1}
{\bm{x}}_{i}
\{0\}\times\mathbb{R}^{n}
{\bm{x}}_{i_{s}}
{\mathbb{L}}_{K}^{M}
\bm{x}\in\mathbb{L}^{n}_{K}
{\bm{x}}
n_{1},\cdots,n_{N}
\sum_{i=1}^{N}n_{i}=n
\{\bm{y}_{i}\}_{i=1}^{N}
{\bm{y}}_{i}\in\mathbb{L}^{n_{i}}_{K}
{\bm{x}}
\bm{x}=\left[x_{t},\bm{y}_{1_{s}}^{\top},\cdots,\bm{y}_{N_{s}}^{\top}\right]^{\top}
\bm{y}_{i}=\begin{bmatrix}\sqrt{\|\bm{y}_{i_{s}}\|^{2}-1/K}\ \\
\bm{y}_{i_{s}}\end{bmatrix}
\{{\bm{x}}_{i}\}_{i=1}^{N}
{\bm{x}}_{i}\in{\mathbb{L}}_{K}^{n_{i}}
{\bm{y}}=\operatorname{HCat}(\{{\bm{x}}_{i}\}_{i=1}^{N})
{\bm{z}}=\operatorname{HTCat}(\{{\bm{x}}_{i}\}_{i=1}^{N})
j\in\{1,\cdots,N\}
\{{\bm{x}}_{i}\}_{i=1}^{N}
y^{*}
{\bm{y}}
\left\lVert\partial y^{*}/\partial{{\bm{x}}_{j_{s}}}|_{{\bm{x}}_{1},\cdots,{%
\bm{x}}_{N}}\right\rVert\leq 1
M>0
\{{\bm{x}}_{i}\}_{i=1}^{N}
z^{*}
{\bm{z}}
\left\lVert\partial z^{*}/\partial{{\bm{x}}_{j_{s}}}|_{{\bm{x}}_{1},\cdots,{%
\bm{x}}_{N}}\right\rVert\geq M
L
d
d
l=0,\cdots,L-1
\displaystyle{\bm{h}}_{1}^{(l)}=\operatorname{Hlinear}_{d,d}({\bm{x}}^{(l)}),%
\qquad{\bm{h}}_{2}^{(l)}=\operatorname{Hlinear}_{d,d}({\bm{x}}^{(l)});
\displaystyle{\bm{h}}_{1}^{(l)}
\displaystyle=\operatorname{Hlinear}_{d,d}({\bm{x}}^{(l)}),\qquad{\bm{h}}_{2}^%
{(l)}=\operatorname{Hlinear}_{d,d}({\bm{x}}^{(l)});
\displaystyle{\bm{h}}^{(l)}=\operatorname{HCat}({\bm{h}}_{1}^{(l)},{\bm{h}}_{2%
}^{(l)});\qquad{\bm{x}}^{(l+1)}=\operatorname{Hlinear}_{2\times d,d}({\bm{h}}^%
{(l)}).
\displaystyle{\bm{h}}^{(l)}
\displaystyle=\operatorname{HCat}({\bm{h}}_{1}^{(l)},{\bm{h}}_{2}^{(l)});%
\qquad{\bm{x}}^{(l+1)}=\operatorname{Hlinear}_{2\times d,d}({\bm{h}}^{(l)}).
d=64
\bm{o}
\operatorname{E2H}(\bm{1}_{64})
\operatorname{diag}(\bm{1}_{64})
3\times\operatorname{diag}(\bm{1}_{64})
{\bm{x}}^{(0)}
{\bm{x}}^{(L)}
L=64
L=128
20
500
[20,50]
400
100
\beta
\beta
100
\beta
\beta
\beta
\bm{z}_{G}
\bm{z}_{T}
\bm{z}_{T}
\bm{z}_{G}
\beta
\pm
\beta
\pm
\beta
\beta
\mathbb{L}^{n}_{K}=(\mathcal{L},\mathfrak{g})
n
K
n
\mathcal{L}
(n+1)
\mathfrak{g}=\operatorname{diag}([-1,\bm{1}_{n}^{\top}])
\bm{1}_{n}
n
1
\mathbb{L}^{n}_{K}
\bm{x}=\begin{bmatrix}x_{t}\\
\bm{x}_{s}\end{bmatrix},x_{t}>0,{\bm{x}}_{s}\in\mathbb{R}^{n}
\left\langle{\bm{x}},{\bm{x}}\right\rangle_{{\mathcal{L}}}=1/K
\langle\cdot,\cdot\rangle_{\mathcal{L}}
\mathfrak{g}
\langle\bm{x},\bm{y}\rangle_{\mathcal{L}}\coloneqq\bm{x}^{\top}\mathfrak{g}\bm%
{y}=-x_{t}y_{t}+\bm{x}_{s}^{\top}\bm{y}_{s},~{}{\bm{x}},{\bm{y}}\in{\mathbb{L}%
}^{n}_{K}.
{\mathbb{L}}^{n}_{K}
{\bm{x}},{\bm{y}}\in{\mathbb{L}}^{n}_{K}
d_{\mathcal{L}}(\bm{x},\bm{y})=\frac{1}{\sqrt{-K}}\cosh^{-1}(K\langle\bm{x},%
\bm{y}\rangle_{\mathcal{L}}).
\bm{x}\in\mathbb{L}^{n}_{K}
\bm{x}
\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}\coloneqq\{\bm{y}\in\mathbb{R}^{n+1}\mid%
\langle\bm{y},\bm{x}\rangle_{\mathcal{L}}=0\}
\bm{x}
\mathbb{R}^{n+1}
\|\bm{v}\|_{\mathcal{L}}=\sqrt{\langle\bm{v},\bm{v}\rangle_{\mathcal{L}}}
\bm{v}\in\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}
\bm{x},\bm{y}\in\mathbb{L}^{n}_{K}
\bm{v}\in\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}
\operatorname{exp}_{\bm{x}}^{K}(\bm{v}):\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}%
\to\mathbb{L}^{n}_{K}
\bm{v}
\operatorname{exp}_{\bm{x}}^{K}(\bm{v})\coloneqq\gamma(1)
\gamma
\gamma(0)=\bm{x}
\gamma^{\prime}(0)=\bm{v}
\operatorname{exp}_{\bm{x}}^{K}(\bm{v})=\cosh(\phi)\bm{x}+\sinh(\phi)\frac{\bm%
{v}}{\phi},\phi=\sqrt{-K}\|\bm{v}\|_{\mathcal{L}}.
\operatorname{log}_{\bm{x}}^{K}(\bm{y}):\mathbb{L}^{n}_{K}\to\mathcal{T}_{\bm{%
x}}\mathbb{L}^{n}_{K}
\operatorname{log}_{\bm{x}}^{K}(\operatorname{exp}_{\bm{x}}^{K}(\bm{v}))=\bm{v}
\operatorname{log}_{\bm{x}}^{K}(\bm{y})=\frac{\cosh^{-1}(\psi)}{\sqrt{-K}}%
\frac{\bm{y}-\psi\bm{x}}{\|{\bm{y}}-\psi{\bm{x}}\|_{\mathcal{L}}},\psi=K%
\langle\bm{x},\bm{y}\rangle_{\mathcal{L}}.
\bm{x},\bm{y}\in\mathbb{L}^{n}_{K}
\bm{x}
\bm{y}
\operatorname{PT}^{K}_{\bm{x}\to\bm{y}}
\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K}
\mathcal{T}_{\bm{y}}\mathbb{L}^{n}_{K}
\bm{x}
\bm{y}
\forall\bm{u},\bm{v}\in\mathcal{T}_{\bm{x}}\mathbb{L}^{n}_{K},\left\langle%
\operatorname{PT}^{K}_{\bm{x}\to\bm{y}}(\bm{v}),\operatorname{PT}^{K}_{\bm{x}%
\to\bm{y}}(\bm{u})\right\rangle_{\mathcal{L}}=\left\langle\bm{v},\bm{u}\right%
\rangle_{\mathcal{L}}
{\mathbb{L}}^{n}_{K}
\operatorname{PT}^{K}_{\bm{x}\to\bm{y}}(\bm{v})=\frac{\langle\bm{y},\bm{v}%
\rangle_{\mathcal{L}}}{-1/K-\langle\bm{x},\bm{y}\rangle_{\mathcal{L}}}(\bm{x}+%
\bm{y}).
d^{2}_{\mathcal{L}}(\bm{x},\bm{y})=2/K-2\langle\bm{x},\bm{y}\rangle_{\mathcal{%
L}},~{}{\bm{x}},{\bm{y}}\in{\mathbb{L}}^{n}_{K}
\min_{\bm{\mu}\in\mathbb{L}^{n}_{K}}\sum_{i=1}^{N}\nu_{i}d_{\mathcal{L}}^{2}(%
\bm{x}_{i},\bm{\mu})
\bm{x}_{i}\in\mathbb{L}^{n}_{K}
\nu_{i}\geq 0
\sum_{i}\nu_{i}>0
i=1,\cdots,N
\bm{\mu}=\operatorname{HCent}(\bm{X},\bm{\nu})=\frac{\sum_{i=1}^{N}\nu_{i}\bm{%
x}_{i}}{\sqrt{-K}\left|\|\sum_{i=1}^{N}\nu_{i}\bm{x}_{i}\|_{\mathcal{L}}\right%
|},
{\bm{X}}
i
{\bm{x}}_{i}
\displaystyle\bm{x}_{v}^{(l)}=\operatorname{HGCN}(\bm{X}^{(l-1)})_{v}=%
\operatorname{HCent}(\{\operatorname{HLinear}_{d_{l-1},d_{l}}(\bm{x}_{u}^{(l-1%
)})\mid u\in N(v)\},\bm{1})
\displaystyle\bm{x}_{v}^{(l)}
\displaystyle=\operatorname{HGCN}(\bm{X}^{(l-1)})_{v}=\operatorname{HCent}(\{%
\operatorname{HLinear}_{d_{l-1},d_{l}}(\bm{x}_{u}^{(l-1)})\mid u\in N(v)\},\bm%
{1})
\bm{x}_{v}^{(l)}
v
l
d_{l}
l
N(v)
v
\bm{t}\in\mathbb{R}^{n}
\mathbb{L}^{m}_{K}
{\bm{t}}
\mathcal{T}_{\bm{o}}\mathbb{L}^{m}_{K}
\bm{y}=\operatorname{E2H}_{m}(\bm{t})=\exp_{\bm{o}}^{K}\left(\begin{bmatrix}0%
\\
\bm{t}\end{bmatrix}\right),
\bm{o}=\left[\sqrt{-1/K},0,\ldots,0\right]^{\top}
{\bm{x}}\in\mathbb{R}^{n}
\bm{h}=\bm{Wx}\in\mathbb{R}^{m}
\bm{W}\in\mathbb{R}^{n\times m}
\bm{y}=\operatorname{HEmbed}_{n,m}(\bm{x})=\operatorname{E2H}\left(\bm{Wx}%
\right).
\bm{\mu}\in\mathbb{L}^{n}_{K}
{\bm{\Sigma}}\in\mathbb{R}^{n\times n}
\bm{z}\in\mathbb{L}^{n}_{K}
\mathcal{G}(\bm{\mu},{\bm{\Sigma}})
\tilde{\bm{v}}
\mathcal{N}(\bm{0},{\bm{\Sigma}})
\tilde{\bm{v}}
{\bm{v}}\in\mathcal{T}_{\bm{o}}\mathbb{L}^{n}_{K}
\bm{v}=\begin{bmatrix}0\\
\tilde{\bm{v}}\end{bmatrix}
\bm{v}
\bm{u}=\operatorname{PT}^{K}_{\bm{o}\to\bm{\mu}}(\bm{v})
\bm{u}
\bm{z}=\exp_{\bm{\mu}}(\bm{u})\in\mathbb{L}^{n}_{K}
\mathcal{G}(\bm{o},{\bm{I}})
\mathbb{R}
W_{1}
d_{\mathcal{L}}
W_{1}
\mathbb{P}_{r},\mathbb{P}_{g}
W_{1}(\mathbb{P}_{r},\mathbb{P}_{g})=\inf_{\gamma\in\Pi(\mathbb{P}_{r},\mathbb%
{P}_{g})}\mathbb{E}_{(\bm{x,y})\sim\gamma}[d_{\mathcal{L}}(\bm{x},\bm{y})],
\Pi(\mathbb{P}_{r},\mathbb{P}_{g})
\mathbb{P}_{r}
\mathbb{P}_{g}
W_{1}
W_{1}(\mathbb{P}_{r},\mathbb{P}_{g})=\sup_{\|D\|_{L}\leq 1}\mathbb{E}_{\bm{x}%
\sim\mathbb{P}_{r}}[D(\bm{x})]-\mathbb{E}_{\bm{x}\sim\mathbb{P}_{g}}[D(\bm{x})],
D:\mathbb{L}_{K}^{n}\to\mathbb{R}
\displaystyle L_{\rm WGAN}=\ \underset{\tilde{\bm{x}}\sim\mathbb{P}_{g}}{%
\mathbb{E}}[D(\tilde{\bm{x}})]-\underset{\bm{x}\sim\mathbb{P}_{r}}{\mathbb{E}}%
[D(\bm{x})]\ +\lambda\underset{\hat{\bm{x}}\sim\mathbb{P}_{\hat{x}}}{\mathbb{E%
}}\left[\left(\left\|\nabla D(\hat{\bm{x}})\right\|_{\mathcal{L}}-1\right)^{2}%
\right],
\displaystyle L_{\rm WGAN}=
\displaystyle\ \underset{\tilde{\bm{x}}\sim\mathbb{P}_{g}}{\mathbb{E}}[D(%
\tilde{\bm{x}})]-\underset{\bm{x}\sim\mathbb{P}_{r}}{\mathbb{E}}[D(\bm{x})]\ +%
\lambda\underset{\hat{\bm{x}}\sim\mathbb{P}_{\hat{x}}}{\mathbb{E}}\left[\left(%
\left\|\nabla D(\hat{\bm{x}})\right\|_{\mathcal{L}}-1\right)^{2}\right],
\nabla D(\hat{\bm{x}})
D(\bm{x})
\hat{\bm{x}}
\mathbb{P}_{g}
\mathbb{P}_{r}
\mathbb{P}_{\hat{\bm{x}}}
\mathbb{P}_{g}
\mathbb{P}_{r}
f^{*}
\mathbb{P}_{(\bm{x},\bm{y})\sim\pi}\bigg{(}f^{*}(\bm{y})-f^{*}(\bm{x})=d_{%
\mathcal{L}}(\bm{y},\bm{x})\bigg{)}=1.
\psi(t)=f^{*}\left(\bm{x}_{t}\right)-f^{*}(\bm{x})
0\leq t,t^{\prime}\leq 1
\psi
d_{\mathcal{L}}(\bm{x},\bm{y})
f^{*}(\bm{x}_{t})-f^{*}(\bm{x})=\psi(t)=td_{\mathcal{L}}(\bm{x},\bm{y})
f^{*}(\bm{x}_{t})=f^{*}(\bm{x})+td_{\mathcal{L}}(\bm{x},\bm{y})=f^{*}(\bm{x})+%
t\|\bm{v}_{t}\|_{\mathcal{L}}
\bm{u}_{t}=\frac{\bm{v}_{t}}{d_{\mathcal{L}}(\bm{x},\bm{y})}\in\mathcal{T}%
\mathbb{L}_{K}^{n}
\bm{x}_{t}
\alpha:[-1,1]\to\mathbb{L}_{K}^{n}
\alpha(0)=\bm{x}_{t}
\alpha^{\prime}(0)=\bm{u}_{t}
\gamma^{\prime}(t)=d_{\mathcal{L}}(\bm{x},\bm{y})\alpha^{\prime}(0)
\lim_{h\to 0}\alpha(h)=\lim_{h\to 0}\gamma\left(t+\frac{h}{d_{\mathcal{L}}(\bm%
{x},\bm{y})}\right)=\lim_{h\to 0}\bm{x}_{t+{h\over d_{\mathcal{L}}(\bm{x},\bm{%
y})}}.
\displaystyle\nabla_{\bm{u}_{t}}f^{*}\left(\bm{x}_{t}\right)=\left.{d\over d%
\tau}f^{*}(\alpha(\tau))\right|_{\tau=0}=\lim_{h\rightarrow 0}\frac{f^{*}\left%
(\alpha(h)\right)-f^{*}\left(\alpha(0)\right)}{h}
\displaystyle\nabla_{\bm{u}_{t}}f^{*}\left(\bm{x}_{t}\right)
\displaystyle=\left.{d\over d\tau}f^{*}(\alpha(\tau))\right|_{\tau=0}=\lim_{h%
\rightarrow 0}\frac{f^{*}\left(\alpha(h)\right)-f^{*}\left(\alpha(0)\right)}{h}
\displaystyle=\lim_{h\rightarrow 0}\frac{f^{*}\left(\bm{x}_{t+{h\over d_{%
\mathcal{L}}(\bm{x},\bm{y})}}\right)-f^{*}\left(\bm{x}_{t}\right)}{h}
\displaystyle=\lim_{h\rightarrow 0}\frac{f^{*}\left(\bm{x}_{t+{h\over d_{%
\mathcal{L}}(\bm{x},\bm{y})}}\right)-f^{*}\left(\bm{x}_{t}\right)}{h}
\displaystyle=\lim_{h\rightarrow 0}\frac{f^{*}\left(\bm{x}\right)+(t+{h\over d%
_{\mathcal{L}}(\bm{x},\bm{y})})d_{\mathcal{L}}(\bm{x},\bm{y})-f^{*}\left(\bm{x%
}\right)-td_{\mathcal{L}}(\bm{x},\bm{y})}{h}
\displaystyle=\lim_{h\rightarrow 0}\frac{f^{*}\left(\bm{x}\right)+(t+{h\over d%
_{\mathcal{L}}(\bm{x},\bm{y})})d_{\mathcal{L}}(\bm{x},\bm{y})-f^{*}\left(\bm{x%
}\right)-td_{\mathcal{L}}(\bm{x},\bm{y})}{h}
\displaystyle=\lim_{h\rightarrow 0}\frac{h}{h}=1.
\displaystyle=\lim_{h\rightarrow 0}\frac{h}{h}=1.
f^{*}
\|\nabla f^{*}(\bm{x}_{t})\|_{\mathcal{L}}\leq 1
\displaystyle 1\geq\left\|\nabla f^{*}(\bm{x})\right\|_{\mathcal{L}}^{2}
\displaystyle 1
\displaystyle\geq\left\|\nabla f^{*}(\bm{x})\right\|_{\mathcal{L}}^{2}
\displaystyle=\left\langle\bm{u}_{t},\nabla f^{*}\left(\bm{x}_{t}\right)\right%
\rangle_{\mathcal{L}}^{2}+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\left%
\langle\bm{u}_{t},\nabla f^{*}\left(\bm{x}_{t}\right)\right\rangle\bm{u}_{t}%
\right\|_{\mathcal{L}}^{2}
\displaystyle=\left\langle\bm{u}_{t},\nabla f^{*}\left(\bm{x}_{t}\right)\right%
\rangle_{\mathcal{L}}^{2}+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\left%
\langle\bm{u}_{t},\nabla f^{*}\left(\bm{x}_{t}\right)\right\rangle\bm{u}_{t}%
\right\|_{\mathcal{L}}^{2}
\displaystyle=\left|\nabla_{\bm{u}_{t}}f^{*}\left(\bm{x}_{t}\right)\right|^{2}%
+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\bm{u}_{t}\nabla_{\bm{u}_{t}}f^{*}%
\left(\bm{x}_{t}\right)\right\|_{\mathcal{L}}^{2}
\displaystyle=\left|\nabla_{\bm{u}_{t}}f^{*}\left(\bm{x}_{t}\right)\right|^{2}%
+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\bm{u}_{t}\nabla_{\bm{u}_{t}}f^{*}%
\left(\bm{x}_{t}\right)\right\|_{\mathcal{L}}^{2}
\displaystyle=1+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\bm{u}_{t}\right\|_%
{\mathcal{L}}^{2}\geq 1.
\displaystyle=1+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\bm{u}_{t}\right\|_%
{\mathcal{L}}^{2}\geq 1.
1=1+\left\|\nabla f^{*}\left(\bm{x}_{t}\right)-\bm{u}_{t}\right\|_{\mathcal{L}%
}^{2}
\nabla f^{*}\left(\bm{x}_{t}\right)=\bm{u}_{t}
\nabla f^{*}\left(\bm{x}_{t}\right)={\bm{v}_{t}\over d_{\mathcal{L}}(\bm{x},%
\bm{y})}
[-1,1]
3
64
128
\pm
\star
\pm
\star
\mathcal{N}
\mathcal{P}
\mathcal{P}
\mathcal{N}
\mathbb{H}
\star
\mathcal{N}
\mathcal{T}
\star
\mathcal{W}\mathbb{H}
\pm
\pm
y*
{\bm{y}}
y^{*}
{\bm{x}}_{i_{s}}
i\in\{1,\cdots,N\}
i\neq j
\partial y^{*}/\partial{\bm{x}}_{j_{s}}
i=j
\partial y^{*}/\partial{\bm{x}}_{j_{s}}
\left\lVert\partial y^{*}/\partial{\bm{x}}_{j_{s}}\right\rVert\leq 1
y^{*}=y_{t}
{\bm{y}}
\displaystyle\partial y^{*}/\partial{\bm{x}}_{j_{s}}=\frac{{\bm{x}}_{j_{s}}}{%
\sqrt{\sum_{i=1}^{N}{\left\lVert{\bm{x}}_{i_{s}}\right\rVert^{2}}-\frac{1}{K}}}
\displaystyle\left\lVert\frac{\partial y^{*}}{\partial{\bm{x}}_{j_{s}}}\right%
\rVert=\frac{\left\lVert{\bm{x}}_{j_{s}}\right\rVert}{\sqrt{\sum_{i=1}^{N}{%
\left\lVert{\bm{x}}_{i_{s}}\right\rVert^{2}}-\frac{1}{K}}}\leq 1
K<0
\left\lVert\partial y^{*}/\partial{\bm{x}}_{j_{s}}\right\rVert\leq 1
y^{*}
{\bm{y}}
{\bm{z}}=\left[z_{t},{\bm{z}}_{1_{s}}^{\top},\cdots,{\bm{z}}_{N_{s}}^{\top}%
\right]^{\top}
l\in\{1,\cdots,N\}
p
{\bm{z}}_{l_{s}}
\displaystyle z_{l_{s}p}~{}=~{}\frac{\sinh(\Delta)}{\Delta}\frac{\cosh^{-1}%
\left(-K\sqrt{\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}-\frac{1}{K}}\right)}%
{\sqrt{-K}}\frac{x_{l_{s}p}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert}
\displaystyle z_{l_{s}p}~{}=~{}
\displaystyle\frac{\sinh(\Delta)}{\Delta}\frac{\cosh^{-1}\left(-K\sqrt{\left%
\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}-\frac{1}{K}}\right)}{\sqrt{-K}}\frac{x_%
{l_{s}p}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert}
\displaystyle~{}=~{}\frac{\sinh(\Delta)}{\Delta}\frac{\sinh^{-1}\left(\sqrt{K^%
{2}\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}-K-1}\right)}{\sqrt{-K}}\frac{x_%
{l_{s}p}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert},
\displaystyle~{}=~{}
\displaystyle\frac{\sinh(\Delta)}{\Delta}\frac{\sinh^{-1}\left(\sqrt{K^{2}%
\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}-K-1}\right)}{\sqrt{-K}}\frac{x_{l_%
{s}p}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert},
\Delta=\sqrt{-K}\left(\sum_{i=1}^{N}\left(\sinh^{-1}\left(\sqrt{K^{2}\left%
\lVert{\bm{x}}_{i_{s}}\right\rVert^{2}-K-1}\right)\right)^{2}\right)^{1/2}.
j\neq l
z_{l_{s}p}
x_{j_{s}k}
k
{\bm{x}}_{j_{s}}
\displaystyle\frac{\partial z_{l_{s}p}}{\partial x_{j_{s}k}}~{}=~{}C_{l}\left(%
\frac{\cosh(\Delta)}{\Delta^{2}}-\frac{\sinh(\Delta)}{\Delta^{3}}\right)\cdot{%
\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{2}-K-1}%
\right)}\cdot
\displaystyle\frac{\partial z_{l_{s}p}}{\partial x_{j_{s}k}}~{}=~{}
\displaystyle C_{l}\left(\frac{\cosh(\Delta)}{\Delta^{2}}-\frac{\sinh(\Delta)}%
{\Delta^{3}}\right)\cdot{\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{j_{s}%
}\right\rVert^{2}-K-1}\right)}\cdot
\displaystyle\qquad\frac{1}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{2}-%
\frac{1}{K}}}\frac{x_{j_{s}k}}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{%
2}-\frac{1+K}{K^{2}}}},
\displaystyle\qquad\frac{1}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{2}-%
\frac{1}{K}}}\frac{x_{j_{s}k}}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{%
2}-\frac{1+K}{K^{2}}}},
C_{l}={\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}-%
K-1}\right)}\frac{x_{l_{s}p}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert}
{\bm{x}}_{j_{s}}
{\bm{x}}_{i_{s}}
i\neq l
x_{j_{s}k}>0
x_{l_{s}q}
q\neq p
\displaystyle\frac{\partial z_{l_{s}p}}{\partial x_{j_{s}k}}\to\infty
x_{l_{s}q}\to\infty
\displaystyle\frac{\partial C_{l}}{\partial x_{l_{s}p}}~{}=~{}\frac{x_{l_{s}p}%
^{2}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}{\sqrt{\left\lVert{\bm{x}}_{j%
_{s}}\right\rVert^{2}-\frac{1}{K}}}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right%
\rVert^{2}-\frac{1+K}{K^{2}}}}}+
\displaystyle\frac{\partial C_{l}}{\partial x_{l_{s}p}}~{}=~{}
\displaystyle\frac{x_{l_{s}p}^{2}}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}%
{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{2}-\frac{1}{K}}}{\sqrt{\left%
\lVert{\bm{x}}_{j_{s}}\right\rVert^{2}-\frac{1+K}{K^{2}}}}}+
\displaystyle\qquad\left(1-\frac{x_{l_{s}p}^{2}}{\left\lVert{\bm{x}}_{l_{s}}^{%
2}\right\rVert}\right)\frac{\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{l_%
{s}}\right\rVert^{2}-K-1}\right)}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert}.
\displaystyle\qquad\left(1-\frac{x_{l_{s}p}^{2}}{\left\lVert{\bm{x}}_{l_{s}}^{%
2}\right\rVert}\right)\frac{\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{l_%
{s}}\right\rVert^{2}-K-1}\right)}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert}.
x_{l_{s}p}^{2}\leq\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}
\frac{\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{l_{s}}\right\rVert^{2}-K%
-1}\right)}{\left\lVert{\bm{x}}_{l_{s}}\right\rVert}>0
{\partial C_{l}}/{\partial x_{l_{s}p}}>0
C_{l}
x_{l_{s}p}
\displaystyle{\sinh^{-1}\left(\sqrt{K^{2}\left\lVert{\bm{x}}_{j_{s}}\right%
\rVert^{2}-K-1}\right)}\frac{1}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^%
{2}-1/K}}\frac{x_{j_{s}k}}{\sqrt{\left\lVert{\bm{x}}_{j_{s}}\right\rVert^{2}-%
\frac{1+K}{K^{2}}}}
x_{l_{s}p}
\displaystyle\frac{\cosh(\Delta)}{\Delta^{2}}-\frac{\sinh(\Delta)}{\Delta^{3}}\rightarrow\infty
x_{l_{s}p}\to\infty
\Delta\to\infty
x_{l_{s}p}\to\infty
\displaystyle f(t)=\frac{\cosh(t)}{t^{2}}-\frac{\sinh(t)}{t^{3}}\to\infty
t\to\infty
f(t)=\frac{1}{2}\left(\frac{e^{-t}}{t^{3}}+\frac{e^{-t}}{t^{2}}+\frac{(t-1)e^{%
t}}{t^{3}}\right).
M>0
\{{\bm{x}}_{i}\}_{i=1}^{N}
z^{*}
{\bm{z}}
z_{l_{s}p}
\partial z^{*}/\partial{{\bm{x}}_{j_{s}}}
M
\left\lVert\partial z^{*}/\partial{{\bm{x}}_{j_{s}}}|_{{\bm{x}}_{1},\cdots,{%
\bm{x}}_{N}}\right\rVert\geq M
1
2
\displaystyle\frac{\partial z_{t}}{\partial x_{s}}
\displaystyle\frac{\partial z_{s0}}{\partial x_{s}}
\displaystyle\frac{\partial z_{s1}}{\partial x_{s}}
\displaystyle\frac{\partial z_{t}}{\partial x_{s}}
\displaystyle\frac{\partial z_{s0}}{\partial x_{s}}
\displaystyle\frac{\partial z_{s1}}{\partial x_{s}}
{\bm{x}}=\left[\sqrt{x_{s}^{2}+1},x_{s}\right]^{\top}\in{\mathbb{L}}_{-1}^{1}
{\bm{y}}=\left[\sqrt{y_{s}^{2}+1},y_{s}\right]^{\top}\in{\mathbb{L}}_{-1}^{1}
K=-1
{\bm{z}}=[z_{t},z_{s0},z_{s1}]^{\top}\in{\mathbb{L}}_{-1}^{2}
{\bm{x}}
{\bm{y}}
x_{s},y_{s}\in[-100,100]
{\bm{z}}
x_{s}
\displaystyle\frac{\partial z_{t}}{\partial x_{s}}\Bigg{|}_{x_{s},y_{s}\in[-10%
0,100]}
\displaystyle\frac{\partial z_{s_{0}}}{\partial x_{s}}\Bigg{|}_{x_{s},y_{s}\in%
[-100,100]}
\displaystyle\frac{\partial z_{s_{1}}}{\partial x_{s}}\Bigg{|}_{x_{s},y_{s}\in%
[-100,100]}
\displaystyle\frac{\partial}{\partial y_{s}}
1
{\bm{x}}\in\mathbb{L}^{n}_{K}
{\bm{y}}\in\mathbb{L}^{m}_{K}
{\bm{z}}=\operatorname{HCat}({\bm{x}},{\bm{y}})\in\mathbb{L}_{K}^{n+m-1}
{\bm{z}}^{\prime}=\operatorname{HTCat}({\bm{x}},{\bm{y}})\in\mathbb{L}_{K}^{n+%
m-1}
d_{\mathcal{L}}({\bm{z}},{\bm{o}})
d_{\mathcal{L}}({\bm{z}}^{\prime},{\bm{o}})
{\bm{x}}\in\mathbb{L}^{n}_{K}
d_{\mathcal{L}}({\bm{x}},{\bm{o}})=\frac{1}{\sqrt{-K}}\cosh^{-1}(K\langle{\bm{%
x}},{\bm{o}}\rangle_{\mathcal{L}})=\frac{1}{\sqrt{-K}}\cosh^{-1}(-Kx_{t}).
\sqrt{x_{t}^{2}+y_{t}^{2}+1/K}
d_{\mathcal{L}}({\bm{z}},{\bm{o}})=\frac{1}{\sqrt{-K}}\cosh^{-1}\left(-K\sqrt{%
x_{t}^{2}+y_{t}^{2}+1/K}\right).
\displaystyle d_{\mathcal{L}}({\bm{z}}^{\prime},{\bm{o}})=\sqrt{d_{\mathcal{L}%
}({\bm{x}},{\bm{o}})^{2}+d_{\mathcal{L}}({\bm{y}},{\bm{o}})^{2}}
\displaystyle d_{\mathcal{L}}({\bm{z}}^{\prime},{\bm{o}})
\displaystyle=\sqrt{d_{\mathcal{L}}({\bm{x}},{\bm{o}})^{2}+d_{\mathcal{L}}({%
\bm{y}},{\bm{o}})^{2}}
\displaystyle=\sqrt{\frac{1}{-K}\left(\cosh^{-2}(-Kx_{t})+\cosh^{-2}(-Ky_{t})%
\right)}.
\displaystyle=\sqrt{\frac{1}{-K}\left(\cosh^{-2}(-Kx_{t})+\cosh^{-2}(-Ky_{t})%
\right)}.
d_{\mathcal{L}}({\bm{z}},o)
d_{\mathcal{L}}({\bm{x}},{\bm{o}})
d_{\mathcal{L}}({\bm{y}},{\bm{o}})
d_{\mathcal{L}}({\bm{z}},{\bm{o}})
d_{\mathcal{L}}({\bm{x}},{\bm{o}})
d_{\mathcal{L}}({\bm{y}},{\bm{o}})
d_{\mathcal{L}}^{2}({\bm{z}}^{\prime},{\bm{o}})=d_{\mathcal{L}}^{2}({\bm{x}},{%
\bm{o}})+d_{\mathcal{L}}^{2}({\bm{y}},{\bm{o}})
n=3
n=3
n=16
n=16
n=64
n=64
\left\lvert d_{\mathcal{L}}({\bm{x}}_{c},{\bm{y}}_{c})-d_{\mathcal{L}}({\bm{x}%
},{\bm{y}})\right\rvert-\left\lvert d_{\mathcal{L}}({\bm{x}}^{\prime}_{c},{\bm%
{y}}^{\prime}_{c})-d_{\mathcal{L}}({\bm{x}},{\bm{y}})\right\rvert
\left\lvert d_{\mathcal{L}}({\bm{x}}_{c},{\bm{y}}_{c})-d_{\mathcal{L}}({\bm{x}%
},{\bm{y}})\right\rvert-\left\lvert d_{\mathcal{L}}({\bm{x}}^{\prime}_{c},{\bm%
{y}}^{\prime}_{c})-d_{\mathcal{L}}({\bm{x}},{\bm{y}})\right\rvert
{\bm{x}},{\bm{y}},{\bm{c}}\in\mathbb{L}^{n}_{K}
{\bm{x}}_{c}=\operatorname{HCat}({\bm{x}},{\bm{c}})
{\bm{x}}
{\bm{c}}
{\bm{y}}_{c}=\operatorname{HCat}({\bm{y}},{\bm{c}})
{\bm{y}}
{\bm{c}}
{\bm{x}}^{\prime}_{c}=\operatorname{HTCat}({\bm{x}},{\bm{c}})
{\bm{y}}^{\prime}_{c}=\operatorname{HTCat}({\bm{y}},{\bm{c}})
{\bm{c}}
{\bm{x}}
{\bm{y}}
d_{\mathcal{L}}({\bm{x}}_{c},{\bm{y}}_{c})
d_{\mathcal{L}}({\bm{x}}^{\prime}_{c},{\bm{y}}^{\prime}_{c})
d_{\mathcal{L}}({\bm{x}},{\bm{y}})
K=-1
{\mathbb{L}}^{n}_{K}
{\bm{x}}
{\bm{y}}
{\bm{c}}
n\in\{3,16,64\}
\left\lvert d_{\mathcal{L}}({\bm{x}}_{c},{\bm{y}}_{c})-d_{\mathcal{L}}({\bm{x}%
},{\bm{y}})\right\rvert
\left\lvert d_{\mathcal{L}}({\bm{x}}^{\prime}_{c},{\bm{y}}^{\prime}_{c})-d_{%
\mathcal{L}}({\bm{x}},{\bm{y}})\right\rvert
d_{\mathcal{L}}({\bm{x}}_{c},{\bm{y}}_{c})
d_{\mathcal{L}}({\bm{x}},{\bm{y}})
d_{\mathcal{L}}({\bm{x}}^{\prime}_{c},{\bm{y}}^{\prime}_{c})
d_{\mathcal{L}}({\bm{x}},{\bm{y}})
\left\lvert d_{\mathcal{L}}({\bm{x}}_{c},{\bm{y}}_{c})-d_{\mathcal{L}}({\bm{x}%
},{\bm{y}})\right\rvert
\left\lvert d_{\mathcal{L}}({\bm{x}}^{\prime}_{c},{\bm{y}}^{\prime}_{c})-d_{%
\mathcal{L}}({\bm{x}},{\bm{y}})\right\rvert
n=16,64
n=64
G=(V_{G},E_{G})
V_{G}
E_{G}
v\in V_{G}
\bm{x}_{v}
T=(V_{T},E_{T})
V_{T}
u,v,w
i,j,k
\bm{x}_{v}
\bm{x}_{i}
d_{G_{0}}
d_{T_{0}}
d_{G}
d_{T}
\bm{z}_{T}
\bm{z}_{G}
\bm{z}_{T}
\bm{z}_{G}
\bm{z}_{T}
\bm{z}_{G}
\bm{z}_{T}
\bm{z}_{G}
G
{\bm{x}}_{v}
\bm{x}_{v}^{(0)}=\operatorname{E2H}_{d_{G_{0}}}(\bm{x}_{v}).
l_{G}
\bm{x}^{(l)}=\operatorname{HGCN}(\bm{x}^{(l-1)}),\quad l=1,\cdots,l_{G}.
\bm{z}_{G}
\bm{z}_{G}=\operatorname{HCent}(\bm{x}^{(l_{G})}).
\bm{z}_{T}
l_{T}
\bm{x}_{i}
\displaystyle\bm{x}_{i}^{(0)}=\operatorname{HEmbed}_{d_{T_{0}},d_{T}}(\bm{x}_{%
i}),
\displaystyle\bm{x}_{i}^{(0)}
\displaystyle=\operatorname{HEmbed}_{d_{T_{0}},d_{T}}(\bm{x}_{i}),
\displaystyle\bm{x}^{(l)}=\operatorname{HGCN}(\bm{x}^{(l-1)}),\quad l=1,\cdots%
,l_{T},
\displaystyle\bm{x}^{(l)}
\displaystyle=\operatorname{HGCN}(\bm{x}^{(l-1)}),\quad l=1,\cdots,l_{T},
\displaystyle\bm{z}_{T}=\operatorname{HCent}(\bm{x}^{(l_{T})}).
\displaystyle\bm{z}_{T}
\displaystyle=\operatorname{HCent}(\bm{x}^{(l_{T})}).
T=(V_{T},E_{T})
T
t
\tilde{E}=\{(i_{1},j_{1}),\ldots,(i_{m},j_{m})\}
T
m=2|E_{T}|
\bm{h}_{i_{t},j_{t}}
\tilde{E}
\tilde{E}_{t}
t
\tilde{E}
t
i_{t}
j_{t}
\bm{h}_{i_{t},j_{t}}
\bm{x}_{i_{t}}
\bm{h}_{k,i_{t}}
\bm{z}_{\rm{nei}}=\operatorname{HCent}(\operatorname{HLinear}_{d_{T},d_{T}}(\{%
\bm{h}_{k,i_{t}}\}_{(k,i_{t})\in\tilde{E},k\not=j_{t}})),
\bm{z}_{\rm{cur}}=\operatorname{HEmbed}_{d_{T_{0}},d_{T}}(\bm{x}_{i_{t}}).
\bm{h}_{i_{t},j_{t}}=\operatorname{HLinear}_{2\times d_{T},d_{T}}\left(%
\operatorname{HCat}(\{\bm{z}_{\rm{cur}},\bm{z}_{\rm{nei}}\})\right).
t
\bm{z}_{T}
\bm{x}_{i_{t}}
\bm{h}_{k,i_{t}}
\displaystyle\bm{z}_{\rm{nei}}=\operatorname{HCent}(\operatorname{HLinear}_{d_%
{T},d_{T}}(\{\bm{h}_{k,i_{t}}\}_{(k,i_{t})\in\tilde{E}})),
\displaystyle\bm{z}_{\rm{nei}}
\displaystyle=\operatorname{HCent}(\operatorname{HLinear}_{d_{T},d_{T}}(\{\bm{%
h}_{k,i_{t}}\}_{(k,i_{t})\in\tilde{E}})),
\displaystyle\bm{z}_{\rm{cur}}=\operatorname{HEmbed}_{d_{T_{0}},d_{T}}(\bm{x}_%
{i_{t}}),
\displaystyle\bm{z}_{\rm{cur}}
\displaystyle=\operatorname{HEmbed}_{d_{T_{0}},d_{T}}(\bm{x}_{i_{t}}),
\displaystyle\bm{z}_{\rm{all}}=\operatorname{HLinear}_{3\times d_{T},d_{T}}%
\left(\operatorname{HCat}(\{\bm{z}_{\rm{cur}},\bm{z}_{\rm{nei}},\bm{z}_{T}\})%
\right),
\displaystyle\bm{z}_{\rm{all}}
\displaystyle=\operatorname{HLinear}_{3\times d_{T},d_{T}}\left(\operatorname{%
HCat}(\{\bm{z}_{\rm{cur}},\bm{z}_{\rm{nei}},\bm{z}_{T}\})\right),
\displaystyle\bm{p}_{t}=\operatorname{Softmax}(\operatorname{HCDist}_{d_{T},2}%
(\bm{z}_{\rm{all}})).
\displaystyle\bm{p}_{t}
\displaystyle=\operatorname{Softmax}(\operatorname{HCDist}_{d_{T},2}(\bm{z}_{%
\rm{all}})).
j_{t}
\bm{z}_{T}
\bm{h}_{i_{t},j_{t}}
\displaystyle\bm{z}_{\rm{all}}=\operatorname{HLinear}_{2\times d_{T},d_{T}}%
\left(\operatorname{HCat}(\{\bm{h}_{i_{t},j_{t}},\bm{z}_{T}\})\right),
\displaystyle\bm{z}_{\rm{all}}
\displaystyle=\operatorname{HLinear}_{2\times d_{T},d_{T}}\left(\operatorname{%
HCat}(\{\bm{h}_{i_{t},j_{t}},\bm{z}_{T}\})\right),
\displaystyle\bm{q}_{t}=\operatorname{Softmax}(\operatorname{HCDist}_{d_{T},d_%
{T_{0}}}(\bm{z}_{\rm{all}})).
\displaystyle\bm{q}_{t}
\displaystyle=\operatorname{Softmax}(\operatorname{HCDist}_{d_{T},d_{T_{0}}}(%
\bm{z}_{\rm{all}})).
\bm{q}_{t}
j_{t}
i_{t}
{\bm{h}}_{i_{t},j_{t}}=\bm{o}
\hat{\bm{p}}_{t},\hat{\bm{q}}_{t}
L_{\rm{topo}}=\sum_{t=1}^{m}L_{\rm{cross}}(\hat{\bm{p}}_{t},{\bm{p}}_{t}),\ L_%
{\rm{label}}=\sum_{t=1}^{m}L_{\rm{cross}}(\hat{\bm{q}}_{t},{\bm{q}}_{t}),
L_{\rm{cross}}
\hat{T}=(\hat{V},\hat{E})
\bm{z}_{G}
\mathcal{G}_{i}
i
i
G^{(i)}_{j}\in\mathcal{G}_{i}
\bm{z}_{G^{(i)}_{j}}
G^{(i)}_{j}
\displaystyle\bm{x}_{v}^{(0)}=\operatorname{E2H}_{d_{G_{0}}}(\bm{x}_{v}),
\displaystyle\bm{x}_{v}^{(0)}
\displaystyle=\operatorname{E2H}_{d_{G_{0}}}(\bm{x}_{v}),
\displaystyle\bm{x}^{(l)}=\operatorname{HGCN}(\bm{x}^{(l-1)}),\quad l=1,\cdots%
,l_{G},
\displaystyle\bm{x}^{(l)}
\displaystyle=\operatorname{HGCN}(\bm{x}^{(l-1)}),\quad l=1,\cdots,l_{G},
\displaystyle\bm{z}_{G^{(i)}_{j}}=\operatorname{HCent}(\bm{x}^{(l_{G})}).
\displaystyle\bm{z}_{G^{(i)}_{j}}
\displaystyle=\operatorname{HCent}(\bm{x}^{(l_{G})}).
\bm{z}_{G}
\displaystyle\bm{z}_{\rm all}=\operatorname{Hlinear}_{2\times d_{G},d_{G}}(%
\operatorname{HCat}(\{\bm{z}_{G^{(i)}_{j}},\bm{z}_{G}\})),
\displaystyle\bm{z}_{\rm all}
\displaystyle=\operatorname{Hlinear}_{2\times d_{G},d_{G}}(\operatorname{HCat}%
(\{\bm{z}_{G^{(i)}_{j}},\bm{z}_{G}\})),
s^{(i)}_{j}=\operatorname{HCDist}_{d_{G},1}(\bm{z}_{\rm all})\in\mathbb{R}.
\mathcal{G}_{i}
G_{c}^{(i)}
L_{\rm{assm}}=\sum_{i}\left(s_{c}^{(i)}-\log\sum_{G_{j}^{(i)}\in\mathcal{G}_{i%
}}\exp(s_{j}^{(i)})\right).
\mathbb{L}_{K}^{256}
\mathcal{G}(\bm{o},\operatorname{diag}(\bm{1}_{256}))
\mathbb{L}_{K}^{3}
\mathbb{L}_{K}^{3}
\mathbb{L}_{K}^{128}\to\mathbb{R}
\mathbb{R}
K=-1.0
\lambda=10
\beta_{1}=0,\beta_{2}=0.9
\lambda
(28\times 28)
\mathbb{R}^{64}\to\mathbb{L}_{K}^{64}
\mathbb{L}_{K}^{64}
\mathbb{L}_{K}^{64}
\mathbb{L}_{K}^{64}\to\mathbb{R}^{64}
(28\times 28)
K=-1.0
\beta_{1}=0.9,\beta_{2}=0.9
\mathbb{L}_{K}^{128}
\mathcal{G}(\bm{o},\operatorname{diag}(\bm{1}_{128}))
\mathbb{L}_{K}^{64}
\mathbb{L}_{K}^{64}
\mathbb{L}_{K}^{64}\to\mathbb{R}
\mathbb{R}
K=-1.0
\lambda=10
\beta_{1}=0,\beta_{2}=0.9
\lambda
\mathbb{R}^{35}
\mathbb{R}^{35}\to\mathbb{L}_{K}^{35}
\mathbb{L}_{K}^{256}
\mathbb{R}^{828}
\mathbb{R}^{828}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{256}
\mathbb{R}^{828}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{512}
\mathbb{L}_{K}^{512}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{256}
\mathbb{R}^{828}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{768}
\mathbb{L}_{K}^{768}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{R}^{2}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{512}
\mathbb{L}_{K}^{512}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{R}^{828}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{512}
\mathbb{L}_{K}^{512}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{R}
K=-1.0
\beta_{1}=0.0,\beta_{2}=0.999
\gamma=0.5
\mathcal{G}(\bm{o},\operatorname{diag}(\bm{1}_{128}))
\mathbb{L}_{K}^{128}
\mathbb{L}_{K}^{128}
\mathbb{L}_{K}^{128}
\mathbb{L}_{K}^{256}\to\mathbb{L}_{K}^{512}
\mathbb{L}_{K}^{512}\to\mathbb{L}_{K}^{256}
\mathbb{L}_{K}^{256}\to\mathbb{R}
\mathbb{R}
K=-1.0
\lambda=10
\beta_{1}=0,\beta_{2}=0.9
\lambda
\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}\to\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}\to\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}\to\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}\to\mathbb{L}_{K}^{64}
\mathbb{L}_{K}^{64}\to\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}\to\mathbb{R}^{2}
K=-1.0
\beta_{1}=0.0,\beta_{2}=0.999
\gamma=0.5
\mathcal{G}(\bm{o},\operatorname{diag}(\bm{1}_{16}))
\mathbb{L}_{K}^{16}
\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}
\mathbb{L}_{K}^{32}\to\mathbb{R}
\mathbb{R}
K=-1.0
\lambda=10
\beta_{1}=0,\beta_{2}=0.9
\lambda
