t\in\mathbb{N}
o_{t}\in\mathcal{O}
s\in\mathcal{S}
a_{t}\in\mathcal{A}
\pi:\mathcal{O}\rightarrow\Delta_{\mathcal{A}}
r_{e}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
r_{i}
r_{e}
t
f_{\theta}:\mathcal{O}\rightarrow\mathcal{E}
o_{t}
e_{t}=f_{\theta}(o_{t})
\mathcal{E}
\mathbb{R}^{D}
D\in\mathbb{N}^{*}
f_{\theta}
o_{t}
M
e_{t}=f_{\theta}(o_{t})
\text{Neigh}_{k}(e_{t})
\mathcal{K}
r_{t}\propto\frac{1}{\sqrt{N(f_{\theta}(o_{t}))}}\approx\frac{1}{\sqrt{\sum_{m%
\in\text{Neigh}_{k}(e_{t})}{\mathcal{K}(e_{t},m)}}}.
M
e
M=\{m_{l}\}_{l=1}^{|M|}
\{c_{l}\}_{i=l}^{|M|}
k
\kappa
d_{\text{ema}}^{2}
d_{\text{ema}}^{2}
\tau
\gamma
\eta
\mathcal{K}
{n_{0}}
M=\{m_{l}\}_{l=1}^{|M|}
\{c_{l}\}_{i=l}^{|M|}
d_{\text{ema}}^{2}
r
N_{\mathcal{K}}(M,e)=\sum_{l=1}^{|M|}(1+c_{l})\,\mathcal{K}(m_{l},e)
r=\left(\sqrt{N_{\mathcal{K}}(M,e)}+{n_{0}}\right)^{-1}
k
e
\text{Neigh}_{k}(e)=\{m_{j}\}_{j=1}^{k}
d_{\text{ema}}
d_{\text{ema}}^{2}\leftarrow(1-\tau)\,d_{\text{ema}}^{2}+\frac{\tau}{k}\sum_{m%
\in\text{Neigh}_{k}(e)}\|m-e\|^{2}_{2}
c_{l}\leftarrow\gamma\,c_{l}\,\quad\forall l\in\{1,\cdots,|M|\}
m_{\star}=\operatorname*{arg\,min}_{m\in M,m\neq m_{j}}\|m-e\|_{2}
[0,1]
u\sim U[0,1]
\|m_{\star}-e\|_{2}^{2}>\kappa\,d_{\text{ema}}^{2}
u<\eta
m_{j}
P(j)\propto 1/c_{j}^{2}
m_{{\dagger}}
m_{j}
m_{\dagger}=\operatorname*{arg\,min}_{m\in M,m\neq m_{j}}\|m-m_{j}\|_{2}
c_{\dagger}\leftarrow c_{j}+c_{\dagger}
e
j
1
m_{j}\leftarrow{e}\,,c_{j}\leftarrow 1
m_{\star}\leftarrow\frac{c_{\star}}{c_{\star}+1}m_{\star}+\frac{1}{c_{\star}+1}e
c_{\star}\leftarrow c_{\star}+1
M=\{m_{j}\}_{j=1}^{|M|}
|M|
m_{j}\in\mathcal{E}
c
c_{i}
m_{i}
c_{i}
m_{i}
e
e
N_{\mathcal{K}}(M,e)=\sum\nolimits_{l}(1+c_{l})\mathcal{K}(m_{l},e;d_{\text{%
ema}}).
\mathcal{K}(m_{l},e)=\frac{1}{1+\frac{\|e-m_{l}\|_{2}^{2}}{\epsilon d_{\text{%
ema}}^{2}}}\,\mathds{1}_{\left\{\|e-m_{l}\|_{2}^{2}<d_{\text{ema}}^{2}\right\}%
}\,,
\epsilon\in\mathbb{R}_{+}
e
k
d_{\text{ema}}
e
k
k
r
{n_{0}}
r
m_{i}
k
M
e
|M|
e
m_{\star}
e
M
e
||m_{\star}-e||^{2}<\kappa d_{\text{ema}}^{2}
d_{\text{ema}}
\kappa>0
m_{\star}
m_{\star}
m_{\star}\longleftarrow\frac{c_{\star}}{c_{\star}+1}m_{\star}+\frac{1}{c_{%
\star}+1}e
c_{\star}
1
\eta
m_{\star}
1/\eta
m_{i}
c_{i}
\propto\frac{1}{c_{i}^{2}}
\propto\frac{1}{c_{i}}
c_{i}
i
c_{i}
k
a_{i}
e_{i}=f_{\theta}(o_{i})
t-1
t
f_{\theta}
N=4
a
e
z
k
a_{i}
e_{i}=f_{\theta}(o_{i})
t-1
t
f_{\theta}
N=4
a
e
z
f_{\theta}
d_{\text{ema}}^{2}
e
k
d_{\text{ema}}
\tau
f_{\theta}
\gamma
c_{i}\longleftarrow\gamma c_{i}
\gamma<1
f_{\theta}:\mathcal{O}\rightarrow\mathcal{E}
1
f_{\theta}
o_{t}
t
g_{\phi}
f_{\theta}(o_{t}),f_{\theta}(o_{t+1})
p_{\theta,\phi}(a_{t}|o_{t},o_{t+1})=g_{\phi}\left(f_{\theta}(o_{t}),f_{\theta%
}(o_{t+1})\right)
(o_{t},o_{t+1})
f_{\theta}
g_{\phi}
\min_{\theta,\phi}\mathcal{L}(\theta,\phi)(a_{t})=-\ln(p_{\theta,\phi}(a_{t}|o%
_{t},o_{t+1}))\,,
a_{t}
o_{t}
o_{t+1}
1
o_{t}
o_{t+1}
h_{t}
k\leq t
f_{\theta}(o_{k})
a_{k-1}
f_{\theta}(o_{k})
a_{k-1}
a_{t}
f_{\theta}(o_{t})
(h_{t-1},a_{t-1})
f_{\theta}(o_{t})
h_{t}
(f_{\theta}(o_{0}),a_{0},f_{\theta}(o_{1}),\dots,a_{t-1},f_{\theta}(o_{t}))
t
f_{\theta}(o_{t})
a_{t}
\dim z_{t}=\dim f_{\theta}(o_{t})
g_{\phi}
1
N=4
e_{t}=f_{\theta}(o_{t})
\mathcal{O}
27,000
5\cdot 10^{4}
30
2\cdot 10^{5}
[0,255]
210\times 160
\gamma\in[0,1)
(\mathcal{S},\mathcal{A},T,R)
\mathcal{S}
\mathcal{A}
T
R:\mathcal{S}\times\mathcal{A}\to\mathbb{R}
\mathcal{S}
o\in\Omega
\mathcal{O}
o
s\in\mathcal{S}
r_{i}
a\in\mathcal{A}
s^{\prime}\sim T(\cdot|s,a)
o^{\prime}\sim\Omega(\cdot|s^{\prime})
r\sim R(s,a)
t
h_{t}=\{o_{0},a_{1},o_{1},\ldots,a_{t},o_{t}\}\in\mathcal{H}_{t}
\mathcal{H}_{t}=\mathcal{H}_{t-1}\times\mathcal{A}\times\mathcal{O}
\mathcal{H}_{0}=\mathcal{O}
\mathcal{H}=\bigcup_{t\in\mathbb{N}}\mathcal{H}_{t}
\pi:\mathcal{H}\rightarrow\Delta_{\mathcal{A}}
e
|M|
k
\gamma
\kappa
\eta
d=0
m_{l}=0\quad\forall{l\in 1\dots|M|}
c_{l}=0\quad\forall{l\in 1\dots|M|}
k
e
\text{Neigh}_{k}(e)
e\in\{e_{0},e_{1},e_{2},\dots\}
d\leftarrow(1-\tau)d+\frac{\tau}{k}\sum_{l\in\text{Neigh}_{k}(e)}\|m_{l}-e\|^{%
2}_{2}
c_{l}\leftarrow\gamma\,c_{l}\,\quad\forall l\in 1,\dots,|M|
m_{\star}=\operatorname*{arg\,min}_{m\in M}\|m_{l}-e\|_{2}
\|m_{i}-e\|_{2}^{2}>\kappa\,d
\eta
j
P(j)\propto 1/c_{j}^{2}
m_{j}
m_{\dagger}=\operatorname*{arg\,min}_{m\in M,l\neq j}\|m_{l}-m_{j}\|_{2}
c_{\dagger}\leftarrow c_{j}+c_{\dagger}
j
e
m_{j}\leftarrow{e}\,,c_{j}\leftarrow 1
m_{\star}\leftarrow\frac{c_{\star}}{c_{\star}+1}\mu_{i}+\frac{1}{c_{\star}+1}e
c_{\star}\leftarrow c_{\star}+1
e_{t}
t
e_{t}
\displaystyle\min_{l\in 1,\dots,|M|}\|m_{l}-e_{t}\|^{2}_{2}
\displaystyle\min_{l\in 1,\dots,|M|}\|m_{l}-e_{t}\|^{2}_{2}
\displaystyle\text{s.t.}\quad\|m_{l}-e_{t}\|^{2}_{2}\leq\kappa d
\displaystyle\text{s.t.}\quad\|m_{l}-e_{t}\|^{2}_{2}\leq\kappa d
e_{t}
e_{s}
s\neq t
\propto c^{-2}
t
\min(100,t)
t=100
1/c_{j}^{2}
\gamma=0.9999
t
\min(100,t)
t=100
1/c_{j}^{2}
\gamma=0.9999
1/c^{2}
1/c^{2}
\displaystyle\mu_{l}\sim\mathcal{N}(0,c_{0})
\displaystyle\mu_{l}
\displaystyle\sim\mathcal{N}(0,c_{0})
\displaystyle e_{i}|\mu_{l}\sim\mathcal{N}(\mu_{l},1)
\displaystyle e_{i}|\mu_{l}
\displaystyle\sim\mathcal{N}(\mu_{l},1)
\mathcal{N}(\mu,\tau)
\mu
\tau
\mu_{l}
e_{i}
m_{l}
\mathcal{N}(\mu_{l},c_{l})
e_{i}
\displaystyle m\leftarrow\frac{c_{l}}{c_{l}+1}m+\frac{1}{c_{l}+1}e_{i}
\displaystyle m
\displaystyle\leftarrow\frac{c_{l}}{c_{l}+1}m+\frac{1}{c_{l}+1}e_{i}
\displaystyle c_{l}\leftarrow c_{l}+1
\displaystyle c_{l}
\displaystyle\leftarrow c_{l}+1
c_{l}
\gamma
e_{t}
|M|
c_{j}\mapsto 0
j
c_{j}\gg 0
1/c_{j}
\gamma
t=0,\ldots,100
64
1+\sqrt{t}
t=0,\ldots,100
64
1+\sqrt{t}
\gamma=1
\gamma=1
\gamma=1
\gamma=1
2\cdot 10^{6}
\gamma=0.999
\gamma=0.999
5\times 10^{4}
\gamma
0.999
\eta
0.05
\kappa
0.2
c
0.01
\tau
0.9999
k
20
\beta_{\mathrm{IM}}
1.0
0.9997
0.97
80
160
6.0
2\times 10^{5}
64
3\times 10^{-4}
6\times 10^{-4}
0.05
0.05
4
(2,3,4,4)
(64,128,128,64)
(1,2,2,2)
2\times 10^{5}
\gamma
0.997
\eta
0.2
\kappa
0.2
c
0.01
\tau
0.9999
k
20
\beta_{\mathrm{IM}}
0.1
0.997
0.97
40
80
2.0
5000
128
1\times 10^{-4}
3\times 10^{-4}
0.1
0.1
2
(2,4,12,6)
(64,128,128,64)
(1,2,2,2)
\pi_{\theta}
f_{\theta}
\theta
t
f_{\theta}(h_{t})
r_{t}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\{32,128,512\}
32
\{32,128,512\}
32
