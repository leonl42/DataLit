D
D
T
S_{i-1}
S_{i}
P_{i}
T
S_{i-1}
S_{i}
T
S_{i-1}
S_{i}
T
S_{i-1}
P_{i}
P_{i}
S_{i}
T
S_{i-1}
P_{i-1}
P_{i}
S_{i}
P_{i}
T
P_{i}
P_{i}
T
P_{i}
P_{G}
\hat{P_{G}}
\hat{P_{G}}
i
i
T
S_{i}
i
D
P_{i}
i
D
P_{i}
T\rightarrow S_{i}
S_{i-1}\rightarrow S_{i}
D
T
S_{i}
i
D
P_{i}
i
D
P_{i}
T\rightarrow S_{i}
S_{i-1}\rightarrow S_{i}
D
T
M_{T}
S_{T}=\{S_{1},...,S_{i}|S_{i}\in\bar{S}\}
\bar{S}
M_{T}
S_{i}
i
{\pi}(S_{i}|T,S_{0:i-1})
T
{\color[rgb]{0,0,0}S_{T}}=\{S_{1},S_{2},\ldots\}
T\rightarrow S_{i}
S_{k}\rightarrow S_{i},k<i
S_{i}
D
D
T
S_{i}
D
P_{i}
S_{i}
P
{\pi}(S_{i}|T,S_{0:i-1},P)
P
3
G_{s}
G
T
E_{w}
G_{s}
\hat{P_{G}}
P_{i}
S_{0:i-1}
T\rightarrow P_{i}
S_{i-1}\rightarrow P_{i}
S_{i}
D
P_{i}
T\leftarrow D\rightarrow S_{i}\leftarrow P_{i}
\pi_{i}
{\pi}(\cdot|P_{i-1})
P_{i-1}
T\rightarrow P_{i}
S_{i-1}\rightarrow P_{i}
\begin{split}{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(T))={{\color[rgb]{0,0,0}%
\pi_{i}}}(P_{i}=p|T),\hskip 8.61108pt{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(%
S_{i-1}))={{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|S_{i-1})\end{split}
T
T
T_{E}
e\in T_{E}
H
G_{s}\subseteq\mathcal{N}_{e}\times\mathcal{R}_{s}\times\mathcal{N}_{e}
G\subseteq\mathcal{N}\times\mathcal{R}\times\mathcal{N}
\mathcal{N}
\mathcal{R}
G_{s}
\mathcal{N}_{e}
k
R_{e}
T
T_{E}
G_{s}
G
P_{G}
\hat{P_{G}}
P_{G}
P
T
T_{E}
G_{s}
G
P_{G}
\hat{P_{G}}
P_{G}
P
P_{i}\rightarrow S_{i}
P_{i}\leftarrow T\leftarrow D\rightarrow S_{i}
P_{i}
S_{i}
P_{i}
D\rightarrow T
\begin{split}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p))&=\sum_{t,s}{{%
\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|p,T=t,S_{i-1}=s){{\color[rgb]{0,0,0}\pi_{i}}%
}(T=t,S_{i-1}=s)\\
&=\sum_{t,s}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|p,T=t,S_{i-1}=s){{\color[rgb]{%
0,0,0}\pi_{i}}}(S_{i-1}=s|T=t){\color[rgb]{0,0,0}\pi_{i}}(T=t)\end{split}
T
i-1
S_{i}
P(S_{i-1}=s|T=t)
N_{e}
E_{w}
{\bm{n}}_{E_{tail}}
R_{e}
{\bm{v}}_{task}
\hat{E_{w}}\leftarrow E_{w}+cosine({\bm{n}}_{E_{tail}},{\bm{v}}_{task})
N_{e}
\hat{E_{w}}
G_{s}
\theta_{e}
Op
R
R
AtLocation
Op\_AtLocation
AtLocation
R
G_{s}
r_{e}
r_{e}
r_{e}
G_{s}
P_{G}
\hat{P_{G}}
LM_{T}
P
i
T
S_{0:i-1}
\hat{P_{G}}
\begin{split}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(T),do(S_{i-1}))&=\sum_{p}{%
{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color[rgb]{0,0,0}\pi_{i}}}(p%
|do(T),{\color[rgb]{0,0,0}do(S_{i-1})})\\
&=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(p|T)\sum_{t,s}{{\color[rgb]{0,0,0}\pi_%
{i}}}(S_{i}|p,T=t,S_{i-1}=s){{\color[rgb]{0,0,0}\pi_{i}}}(T=t,S_{i-1}=s)\end{split}
P_{G}
P_{i}
D
T
S
G
LM_{G}
LM_{T}
R
T
T_{E}
k
\mathcal{N}_{e}
T_{E}
G_{s}\subseteq\mathcal{N}_{e}\times\mathcal{R}_{s}\times\mathcal{N}_{e}
G\subseteq\mathcal{N}\times\mathcal{R}\times\mathcal{N}
e\in T_{E}
\hat{E_{w}}\leftarrow E_{w}+cosine(n_{E_{tail}},v_{task})
\mathcal{N}_{e}
T_{E}
\mathcal{R}_{s}
G_{s}
R
P_{G}
G_{s}
R
P_{G}
\hat{P_{G}}
LM_{T}(P_{G})
S_{T}=\{S_{1},...,S_{i}\}
i
P_{i}\leftarrow[T;S_{0:i-1};\hat{P_{G}}]
S_{i}
LM_{T}(LM_{G}(P_{i}))
S_{T}
\leftarrow
S_{i}
T
LM_{G}\in\{P_{AR},P_{AE}\}
t
\theta
P_{AR}
P_{AE}
{\pi}_{AR}(x)=\prod_{i=1}^{n}p(s_{n}|\hat{P_{G}},s_{1:n-1},T),\hskip 8.61108pt%
{\pi}_{AE}(x)=\prod_{i=1}^{n}p(s_{n}|\hat{P_{G}},\{s_{1:n-1},[MASK]\},T)
\hat{P_{G}}
T
{LM_{T}}
{LM_{G}}
{LM_{G}}
LM_{T}
{\pi}(s_{i}|x)=LM_{T}(LM_{G}(x))
LM_{G}(x)
s_{i}\in\bar{S}
M_{T}
292
2000
50
150
1000
1
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
5
5
3
21\%
26\%
5
w/o
w/o
w/o
w/o
w/o
w/o
w/o
k
E_{W}
G
w/o
23.3\%
32.3\%
16.4\%
21.1\%
D
T
S_{i}
T
S_{i}
T
S_{i}
T
T\leftarrow D\rightarrow S_{i}
P_{i}
T
\{P_{i},S_{i-1}\}
D\rightarrow T
T
P_{i}
S_{i}
P_{i}\leftarrow T\leftarrow D\rightarrow S_{i}
P_{i}
S_{i}
\{T,S_{i-1}\}
D
T
S_{i-1}
S_{i}
X
Y
{\pi}(Y|do(X))
X
Z
Z\rightarrow X
{\pi}(Y|do(X))
P_{i}
P_{i-1}
S_{i-1}
P_{i}
T\rightarrow S_{i}
S_{i-1}\rightarrow S_{i}
P\rightarrow S_{i}
P_{i}
do(T=t)
D
\pi_{i}
{\pi}(\cdot|P_{i-1})
P_{i-1}
{\color[rgb]{0,0,0}\pi_{i}}(S_{i}|do(T))=\sum_{d}{\color[rgb]{0,0,0}\pi_{i}}(S%
_{i}|T,D=d){\color[rgb]{0,0,0}\pi_{i}}(D=d)
P_{i}
T
P_{i}
S_{1}
S_{t}
i=1
D
T
P_{1}
\begin{split}{\color[rgb]{0,0,0}\pi_{i}}(S_{1}|do(T))&=\sum_{p}{\color[rgb]{%
0,0,0}\pi_{i}}(S_{1}|do(P_{1}=p)){\color[rgb]{0,0,0}\pi_{i}}(p|do(T))\\
&=\sum_{p}{\color[rgb]{0,0,0}\pi_{i}}(p|T)\sum_{t}{\color[rgb]{0,0,0}\pi_{i}}(%
S_{i}|p,T=t){\color[rgb]{0,0,0}\pi_{i}}(T=t)\end{split}
T
do(T=t)
D
D\rightarrow T
i>1
P_{1}
T
P_{i-1}
S_{i-1}
P_{i}
P_{i}
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(T))={{\color[rgb]{0,0,0}%
\pi_{i}}}(P_{i}=p|T)
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(T))
\displaystyle={{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|T)
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(P_{i-1}))={{\color[rgb]{%
0,0,0}\pi_{i}}}(P_{i}=p|P_{i-1})
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(P_{i-1}))
\displaystyle={{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|P_{i-1})
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(S_{i-1}))={{\color[rgb]{%
0,0,0}\pi_{i}}}(P_{i}=p|S_{i-1})
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|do(S_{i-1}))
\displaystyle={{\color[rgb]{0,0,0}\pi_{i}}}(P_{i}=p|S_{i-1})
i=1
i=1
i>1
i>1
i>1
P_{i-1}
i>1
P_{i-1}
i=1
T
S_{1}
1
D
P_{1}
1
D
T\rightarrow S_{i}
P_{i-1}\rightarrow S_{i}
S_{i-1}\rightarrow S_{i}
P_{i}
1
2
D\rightarrow T
T
D\rightarrow T
2
S_{i-1}
D\rightarrow S_{i-1}
3
i>1
i=1
T
S_{1}
1
D
P_{1}
1
D
T\rightarrow S_{i}
P_{i-1}\rightarrow S_{i}
S_{i-1}\rightarrow S_{i}
P_{i}
1
2
D\rightarrow T
T
D\rightarrow T
2
S_{i-1}
D\rightarrow S_{i-1}
3
i>1
do
i=1
i>1
do
i=1
i>1
do
P_{i}
\displaystyle{\color[rgb]{0,0,0}\pi_{i}}(S_{i}|do(P_{i}))=\sum_{t,p^{\prime},s%
}\Big{(}{\color[rgb]{0,0,0}\pi_{i}}(S_{i}|P_{i},T=t,P_{i-1}=p^{\prime},S_{i-1}%
=s)
\displaystyle{\color[rgb]{0,0,0}\pi_{i}}(S_{i}|do(P_{i}))=\sum_{t,p^{\prime},s%
}\Big{(}
\displaystyle{\color[rgb]{0,0,0}\pi_{i}}(S_{i}|P_{i},T=t,P_{i-1}=p^{\prime},S_%
{i-1}=s)
\displaystyle{\color[rgb]{0,0,0}\pi_{i}}(T=t,P_{i-1}=p^{\prime},S_{i-1}=s)\Big%
{)}
\displaystyle{\color[rgb]{0,0,0}\pi_{i}}(T=t,P_{i-1}=p^{\prime},S_{i-1}=s)\Big%
{)}
T
P_{i-1}
S_{i-1}
T
P_{i}\leftarrow T\leftarrow D\rightarrow S_{i}
P_{i-1}
P_{i}\leftarrow P_{i-1}\leftarrow T\leftarrow D\rightarrow S_{i}
T
T
P_{i-1}
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(S_{i-1}),do(P_{i-1}),do(T))
\displaystyle{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(S_{i-1}),
\displaystyle do(P_{i-1}),do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color%
[rgb]{0,0,0}\pi_{i}}}(p|do(S_{i-1}),do(P_{i-1}),do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color%
[rgb]{0,0,0}\pi_{i}}}(p|do(S_{i-1}),do(P_{i-1}),do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color%
[rgb]{0,0,0}\pi_{i}}}(p|do(S_{i-1}),P_{i-1},do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color%
[rgb]{0,0,0}\pi_{i}}}(p|do(S_{i-1}),P_{i-1},do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color%
[rgb]{0,0,0}\pi_{i}}}(p|do(S_{i-1}),do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(P_{i}=p)){{\color%
[rgb]{0,0,0}\pi_{i}}}(p|do(S_{i-1}),do(T))
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(p|S_{i-1},T)\sum_{s,t}{{%
\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|p,S_{i-1}=s,T=t){{\color[rgb]{0,0,0}\pi_{i}}%
}(S_{i-1}=s,T=t)
\displaystyle=\sum_{p}{{\color[rgb]{0,0,0}\pi_{i}}}(p|S_{i-1},T)\sum_{s,t}{{%
\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|p,S_{i-1}=s,T=t){{\color[rgb]{0,0,0}\pi_{i}}%
}(S_{i-1}=s,T=t)
\displaystyle={{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(S_{i-1}),do(T))
\displaystyle={{\color[rgb]{0,0,0}\pi_{i}}}(S_{i}|do(S_{i-1}),do(T))
T
i>1
P_{i-1}
P_{i-1}
P_{G,i}
P_{G,i-1}
P_{i}
P_{i-1}
S_{i-1}
P_{i-1}
S_{i-2}
P_{i-1}
i
P_{i}
P_{i-1}
150
<
>
<
>
<
>
<
>
<
>
1000
799,273
2,487,810
1\%
1.5
LM_{T}
34
\theta
\{0,0.5,0.55,0.6,0.65,0.7,0.75,0.8\}
\{10,20,40\}
\{1,2,3\}
\{1,2,3\}
\{0.4,0.6,0.8\}
\theta_{e}
\{0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8\}
k
\{1,5,10,15,20,25,50,100\}
\theta
20
3
3
0.4
\theta_{e}
k
H
3
3
3
5
50
1
5
5
5
5
0.05
0.05
w/o
w/o
8.884e-13
1.4e-8
5
5
w/o
w/o
w/o
LM_{T}
P_{G}
\hat{P_{G}}
LM_{T}
\hat{P_{G}}
P_{G}
T
G_{s}
P_{G}
\hat{P_{G}}
T
G_{s}(N_{head},R_{e},N_{tail},E_{w})
P_{G}
\hat{P_{G}}
S_{T}
