h
t_{e}
\gamma
q
h
t_{e}
\gamma
q
t
y_{t}^{h}=\mathds{1}[t>t_{e}-h]
\hat{y}_{t}^{h}\in[0,1]
h
\lambda^{h}_{t}=\mathds{1}[t=t_{e}-h]
\hat{\lambda}^{h}_{t}
t
y_{t}^{h}=\mathds{1}[t>t_{e}-h]
\hat{y}_{t}^{h}\in[0,1]
h
\lambda^{h}_{t}=\mathds{1}[t=t_{e}-h]
\hat{\lambda}^{h}_{t}
-\sum_{t}y_{t}\log(\hat{y}_{t})
-\sum_{t}\omega y_{t}\log(\hat{y}_{t})
-\sum_{t}\omega(1-\hat{y}_{t})^{\zeta}y_{t}\log(\hat{y}_{t})
-\sum_{t}q^{LS}(y_{t})\log(\hat{y}_{t})
-\sum_{t}\sum_{h}y_{t}^{h}\log(\hat{y}_{t}^{h})
-\sum_{h}\lambda_{0}^{h}\log(\hat{\lambda}_{0}^{h})
-\sum_{t}\sum_{h}\lambda_{t}^{h}\log(\hat{\lambda}_{t}^{h})
-\sum_{t}\sum_{h}\hat{\lambda}_{t+1}^{h-1}\log(\hat{\lambda}_{t}^{h})
-\sum_{t}q^{TLS}(t)\log(\hat{y}_{t})
\mathbf{x}_{i,t}
e_{i,t}
t
i
\{(\mathbf{x}_{i,1},e_{i,1}),\ldots,(\mathbf{x}_{i,T_{i}},e_{i,T_{i}})\}
T_{i}
i
t
\operatorname{\mathbf{X}}_{t}=[\mathbf{x}_{0},\ldots,\mathbf{x}_{t}]
t_{e}=\operatorname*{arg\,min}_{\tau:\tau\geq t}\{e_{\tau}:e_{\tau}=1\}
h
y^{h}(t)=P(t>t_{e}-h|\mathbf{X}_{t})
y^{h}(t)=\mathds{1}\left[t>t_{e}-h\right]
\hat{y}^{h}(t)
h
t
S(h|\mathbf{X}_{t})=P(t_{e}-t>h|\mathbf{X}_{t})
t
h
\{t,h\}
y^{h}(t)=1-S(h|\mathbf{X}_{t})
h
\displaystyle\text{Time monotonicity: }y^{h}(t)\leq y^{h}(t+\delta t)
\displaystyle y^{h}(t)\leq y^{h}(t+\delta t)
\displaystyle\text{ Horizon monotonicity: }y^{h}(t)\geq y^{h+\delta h}(t)
\displaystyle y^{h}(t)\geq y^{h+\delta h}(t)
\displaystyle\text{Consistency: }y^{h}(t)=y^{h-\delta t}(t+\delta t)
\displaystyle y^{h}(t)=y^{h-\delta t}(t+\delta t)
\delta t,\delta h>0
h\leq h^{\prime}
\hat{y}^{h}(t)\geq\hat{y}^{h^{\prime}}(t)
h
\lambda(h|\mathbf{X}_{t})=P(t_{e}-t=h|t_{e}-t\geq h,\mathbf{X}_{t})
S(h|\mathbf{X}_{t})=\prod_{k=1}^{h}\left(1-\lambda(k|\mathbf{X}_{t})\right)
t
t
h-t
\hat{\lambda}(h|\mathbf{X}_{t})
h
q^{exp}
q^{exp}
q^{step}
q^{step}
(h_{min},h_{max})=(0,2h)
|y-q^{(T)LS}|
y^{*}
q^{step}
(h_{min},h_{max})=(0,2h)
|y-q^{(T)LS}|
y^{*}
q^{step}
y
q(t)
t_{e}-h
q_{t}
q^{exp}(t)=\begin{cases}0&\text{if }t\leq t_{e}-h_{max}\\
e^{-\gamma(t_{e}-t-d)}+A&\text{if }t_{e}-h_{max}<t<t_{e}-h_{min}\\
1&\text{if }t\geq t_{e}-h_{min}\par\end{cases}
h_{min}
h_{max}
[t_{e}-h_{max}
t_{e}-h_{min}]
\{d,A\}
q_{t}
\gamma
y
q
y
q
\{h_{1},\ldots h_{H}\}
q^{step}
q^{step}(t)=\begin{cases}0&\mathrm{if}\quad t<t_{e}-h_{H}\\
1-\frac{k}{H}&\mathrm{if}\quad t_{e}-h_{k+1}\leq t<t_{e}-h_{k}\quad\forall k%
\leq H-1\\
1&\mathrm{if}\quad t\geq t_{e}-h_{1}\end{cases}
q^{step}
h=12
h=24
0
2h
(h_{min},h_{max})=(0,2h)
l_{1}
\gamma
q^{exp}
h
h
t_{e}
\frac{h}{12}
h
t_{e}
\frac{h}{12}
p
<0.05
p
<0.05
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{40.6}
\pm
\mathbf{32.3}
\pm
\pm
\mathbf{35.5}
\pm
\mathbf{29.3}
\pm
\pm
p
t_{e}
t_{e}-h
t_{e}-h
t_{e}
\zeta=0
\zeta=0
p
<0.05
>50
>50
q^{step}
p
H_{0}
\leq
p<0.05
q^{step}
p
H_{0}
\leq
p<0.05
\pm
\pm
\pm
\pm
\pm
\pm
q^{step}
\pm
\pm
\pm
\pm
\pm
\pm
H_{0}
q^{step}(t)
q^{step}
t=t_{e}-2h
t=t_{e}
t_{e}
0.5
0.5
t_{e}-h
t
\mathbf{y}_{t}=[y^{h_{1}}_{t},\ldots,y^{h}_{t},\ldots,y^{h_{H}}_{t}]
\hat{\mathbf{y}}_{t}=[\hat{y}^{h_{1}}_{t},\ldots,\hat{y}^{h}_{t},\ldots,\hat{y%
}^{h_{H}}_{t}]
H
L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-\frac{1}{H}\sum_{k=1}^{H}y^{h_{k%
}}_{t}\log(\hat{y}^{h_{k}}_{t})+(1-y^{h_{k}}_{t})\log(1-\hat{y}^{h_{k}}_{t})
\{\hat{y}^{h_{k}}_{t}\}_{k}
k
L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-\left[\log(\hat{y}_{t})\frac{1}{%
H}\sum_{k=1}^{H}y^{h_{k}}_{t}+\log(1-\hat{y}_{t})\frac{1}{H}\sum_{k=1}^{H}(1-y%
^{h_{k}}_{t})\right]
\hat{y}_{t}
q^{step}(t)=\frac{1}{H}\sum_{k=1}^{H}y^{h_{k}}_{t}
L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-\left[\log(\hat{y}_{t})\cdot q^{%
step}(t)+\log(1-\hat{y}_{t})\cdot\left(1-q^{step}(t)\right)\right]
q^{step}(t)
\{h_{k}\}_{k}
h_{u}
h_{v}
\displaystyle v\leq u\quad\text{and}\quad y^{h_{v}}_{t}=1\implies y^{h_{u}}_{t%
}=1
\displaystyle v\leq u\quad\text{and}\quad y^{h_{v}}_{t}=1\implies y^{h_{u}}_{t%
}=1
\displaystyle v\geq u\quad\text{and}\quad y^{h_{v}}_{t}=0\implies y^{h_{u}}_{t%
}=0
\displaystyle v\geq u\quad\text{and}\quad y^{h_{v}}_{t}=0\implies y^{h_{u}}_{t%
}=0
q^{step}(t)
d_{e}(t)=t_{e}-t
q^{step}(t)
q^{step}(t)
d_{e}(t)\leq h_{1}
y^{h_{1}}_{t}=1
d_{e}(t)\leq h_{1}
h_{1}
y^{h_{c}}_{t}=1,\forall c\in\llbracket 1,H\rrbracket
\displaystyle L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-\log(\hat{y}_{t})
\displaystyle L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})
\displaystyle=-\log(\hat{y}_{t})
\displaystyle=-[q^{step}(t)\log(\hat{y}_{t})+(1-q^{step}(t))\log(1-\hat{y}_{t})]
\displaystyle=-[q^{step}(t)\log(\hat{y}_{t})+(1-q^{step}(t))\log(1-\hat{y}_{t})]
q^{step}(t)=1
d_{e}(t)>h_{H}
d_{e}(t)>h_{H}
y^{h_{H}}_{t}=0
y^{h_{c}}_{t}=0,\forall c\in\llbracket 1,H\rrbracket
\displaystyle L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-\log(1-\hat{y}_{t})
\displaystyle L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})
\displaystyle=-\log(1-\hat{y}_{t})
\displaystyle=-[q^{step}(t)\log(\hat{y}_{t})+(1-q^{step}(t))\log(1-\hat{y}_{t})]
\displaystyle=-[q^{step}(t)\log(\hat{y}_{t})+(1-q^{step}(t))\log(1-\hat{y}_{t})]
q^{step}(t)=0
\exists k\in\llbracket 1,H-1\rrbracket\quad\mathrm{s.t}\quad h_{k}<d_{e}(t)%
\leq h_{k+1}
k
y^{h_{c}}_{t}=0,\forall c\in\llbracket 1,k\rrbracket
y^{h_{c}}_{t}=1,\forall c\in\llbracket k+1,H\rrbracket
\displaystyle L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-[\frac{H-k}{H}\log%
(\hat{y}_{t})+\frac{k}{H}\log(1-\hat{y}_{t})]
\displaystyle L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})
\displaystyle=-[\frac{H-k}{H}\log(\hat{y}_{t})+\frac{k}{H}\log(1-\hat{y}_{t})]
\displaystyle=-[q^{step}(t)\log(\hat{y}_{t})+(1-q^{step}(t))\log(1-\hat{y}_{t})]
\displaystyle=-[q^{step}(t)\log(\hat{y}_{t})+(1-q^{step}(t))\log(1-\hat{y}_{t})]
q^{step}(t)=\frac{H-k}{H}.
q^{step}
q^{step}(t)=\begin{cases}1-\frac{k}{H}&\mathrm{if}\quad h_{k}\leq d_{e}(t)<h_{%
k+1}\quad\forall k\leq H-1\\
1&\mathrm{if}\quad d_{e}(t)\leq h_{1}\\
0&\mathrm{if}\quad d_{e}(t)>h_{H}\\
\end{cases}
\forall d_{e}(t)>0
L^{MHP}=L^{TLS}
q^{step}
q^{shift}
q^{shift}
q^{step}
q^{linear}
q^{step}
q^{linear}
q^{concave}
q^{concave}
q^{sigmoid}
q^{sigmoid}
q(t)
q(t_{e}-2h)=0
q(t_{e})=1
\gamma
q^{exp},q^{concave},q^{sigmoid}
h_{shift}
q^{shift}
\gamma
q^{exp},q^{concave},q^{sigmoid}
h_{shift}
q^{shift}
q^{step}
\pm
\pm
\pm
\pm
q^{shift}
40.1\pm 0.3
31.8\pm 0.6
\pm
\pm
q^{linear}
\pm
\pm
\pm
\pm
q^{sigmoid}
\pm
\pm
\pm
\pm
q^{concave}
\pm
\pm
\pm
\pm
q^{exp}
\mathbf{40.6}
\pm
\mathbf{32.3}
\pm
\mathbf{35.5}
\pm
\mathbf{29.3}
\pm
q^{shift}(t)
q^{shift}(t)=\mathds{1}\left[t\geq t_{e}-h_{shift}\right]
h_{shift}
h_{shift}=h
h_{shift}
q^{step}
H\rightarrow+\infty
q^{linear}(t)
q^{linear}(t)=\begin{cases}0&\mathrm{if}\quad t\leq t_{e}-2h\\
1-\frac{t_{e}-t}{2h}&\mathrm{if}\quad t>t_{e}-2h\end{cases}
H
t=t_{e}-h
q_{t}
q^{sigmoid}(t)=\begin{cases}0&\mathrm{if}\quad t\leq t_{e}-2h\\
\frac{K-A}{1+e^{\frac{t_{e}-t-d}{\gamma}}}+A&\mathrm{if}\quad t>t_{e}-2h\end{cases}
K
A
d
t=t_{e}-2h
t=t_{e}
q(t_{e}-2h)=\frac{1}{2}
\displaystyle K=-Ae^{\frac{2h-d}{\gamma}}
\displaystyle K
\displaystyle=-Ae^{\frac{2h-d}{\gamma}}
\displaystyle A=\frac{e^{\frac{-d}{\gamma}}+1}{e^{\frac{-d}{\gamma}}-e^{\frac{%
2h-d}{\gamma}}}
\displaystyle A
\displaystyle=\frac{e^{\frac{-d}{\gamma}}+1}{e^{\frac{-d}{\gamma}}-e^{\frac{2h%
-d}{\gamma}}}
\displaystyle d=h
\displaystyle d
\displaystyle=h
\gamma
\delta_{y=1}
\gamma\rightarrow 0
q^{linear}
\gamma\rightarrow+\infty
q^{exp}(t)
q^{exp}(t)=\begin{cases}0&\mathrm{if}\quad t\leq t_{e}-2h\\
e^{-\gamma(t_{e}-t-d)}+A&\mathrm{if}\quad t>t_{e}-2h\end{cases}
\{d,A\}
\displaystyle A=-e^{-\gamma(2h-d)}
\displaystyle A
\displaystyle=-e^{-\gamma(2h-d)}
\displaystyle d=-\frac{1}{\gamma}\ln\left(1-e^{-\gamma 2h}\right)
\displaystyle d
\displaystyle=-\frac{1}{\gamma}\ln\left(1-e^{-\gamma 2h}\right)
\gamma
q^{linear}
\gamma\rightarrow 0
q(t)=0\>\forall t<t_{e}
\gamma\rightarrow+\infty
q^{shift}
q^{exp}
(h_{min},h_{max})
(0,2h)
q^{concave}
q^{concave}(t)=\begin{cases}0&\mathrm{if}\quad t\leq t_{e}-2h\\
1-e^{-\gamma(d-t_{e}+t)}+A&\mathrm{if}\quad t>t_{e}-2h\end{cases}
\{d,A\}
q^{exp}
\gamma
t
t
t+h
h
t
h=\infty
L^{CE}(y,\hat{y})=-y\log(\hat{y})-(1-y)\log(1-\hat{y})
\omega
\omega
\omega=1/2
\hat{y}=p_{\theta}(y=1)
y
L^{focal}(y,\hat{y})=-\omega(1-\hat{y})^{\zeta}y\log(\hat{y})-(1-\omega)\hat{y%
}^{\zeta}(1-y)\log(1-\hat{y})
\omega_{y}
y
\zeta
L^{MHP}(\mathbf{y}_{t},\hat{\mathbf{y}}_{t})=-\frac{1}{H}\sum_{k=1}^{H}y^{h_{k%
}}_{t}\log(\hat{y}^{h_{k}}_{t})+(1-y^{h_{k}}_{t})\log(1-\hat{y}^{h_{k}}_{t})
\mathbf{y}_{t}=[y^{h_{1}}_{t},\ldots,y^{h}_{t},\ldots,y^{h_{H}}_{t}]
\hat{\mathbf{y}}_{t}=[\hat{y}^{h_{1}}_{t},\ldots,\hat{y}^{h}_{t},\ldots,\hat{y%
}^{h_{H}}_{t}]
H
\delta_{y=c}
L^{CE}(y,\hat{y})
q^{LS}(c|y)
c
q^{LS}(c|y)=\delta_{y=c}(1-\alpha)+u(c)\alpha\\

u
\alpha\in[0,1]
\hat{y}=1
u
y\in\{0,1\}
\hat{y}=p_{\theta}(y=1)
\alpha
q^{LS}=p(y=1)
q^{LS}=(1-\alpha)y+\alpha(1-y)\\

t
T
\operatorname{\mathbf{X}}_{i,0}=[\mathbf{x}_{i,0}]
T_{i}
c_{i}
T_{i}
c_{i}=1
c_{i}=0
T_{i}
\displaystyle\text{probability mass function:}\quad\quad\quad f(k|\mathbf{X})=%
P(T=k|\mathbf{X}_{i,0})
\displaystyle\text{probability mass function:}\quad\quad\quad f(k|\mathbf{X})
\displaystyle=P(T=k|\mathbf{X}_{i,0})
\displaystyle\text{survival function:}\quad\quad\quad S(k|\mathbf{X})=P(T>k|%
\mathbf{X})
\displaystyle\text{survival function:}\quad\quad\quad S(k|\mathbf{X})
\displaystyle=P(T>k|\mathbf{X})
\displaystyle\text{hazard function:}\quad\quad\quad\lambda(k|\mathbf{X})=P(T=k%
|T\geq k,\mathbf{X})=P(T=k|T>k-1,\mathbf{X})
\displaystyle\text{hazard function:}\quad\quad\quad\lambda(k|\mathbf{X})
\displaystyle=P(T=k|T\geq k,\mathbf{X})=P(T=k|T>k-1,\mathbf{X})
\displaystyle\mathcal{L}_{surv}=\prod_{i}P(T=T_{i}|\mathbf{X}_{i,0})^{1-c_{i}}%
P(T>T_{i}|\mathbf{X}_{i,0})^{c_{i}}
\displaystyle\mathcal{L}_{surv}
\displaystyle=\prod_{i}P(T=T_{i}|\mathbf{X}_{i,0})^{1-c_{i}}P(T>T_{i}|\mathbf{%
X}_{i,0})^{c_{i}}
\mathcal{L}_{surv}
T_{i}
T_{i}
\mathcal{L}_{surv}
\lambda^{h}_{i}=\mathds{1}\left[T_{i}=h\land c_{i}=0\right]
\sum^{N}_{i=1}\sum^{T_{i}}_{h=1}-\lambda^{h}_{i}\log(\hat{\lambda}(h|\mathbf{X%
}_{0,i}))
f,S
\lambda
f(k|\mathbf{X})=h(k|\mathbf{X})S(k-1|\mathbf{X})
S(k|\mathbf{X})=1-\sum^{k}_{p=1}f(p|\mathbf{X})=\prod^{k}_{p=1}(1-h(p|\mathbf{%
X}))
h
\hat{y}^{h}=1-\hat{S}(h|\mathbf{X})
\operatorname{\mathbf{X}}_{i,t}=[\mathbf{x}_{i,0},...,\mathbf{x}_{i,t}]
(\operatorname{\mathbf{X}}_{i,t},T_{i}-t,c_{i})
\sum^{N}_{i=1}\sum^{T_{i}-1}_{i=t}\sum^{T_{i}-t}_{h=1}-\lambda^{h}_{t,i}\log(%
\hat{\lambda}(h|\mathbf{X}_{t,i}))
\lambda^{h}_{t,i}=\mathds{1}\left[T_{i}-t=h\land c_{i}=0\right]
h
t
\hat{y}^{h}_{t}=1-\hat{S}(h|\mathbf{X}_{t})
[\lambda^{1}_{t,i},\lambda^{2}_{t,i},...,\lambda^{T_{i}-t}_{t,i}]
[\lambda^{1}_{t,i},\hat{\lambda}(1|\mathbf{X}_{t-1,i}),...,\hat{\lambda}(T_{i}%
-t-1|\mathbf{X}_{t+1,i})]
w^{1}_{t,i}=1,w^{2}_{t,i}=1-\hat{f}(1|\mathbf{X}_{t+1,i})
w^{h}_{t,i}=\hat{S}(h-2|\mathbf{X}_{t+1,i})\quad\forall h\geq 2
i
v
t_{e_{1}},...,t_{e_{v}}
s_{e_{1}},...,s_{e_{v}}
[\mathbf{X}_{i,0},...,\mathbf{X}_{i,t_{e_{1}}-1}],[\mathbf{X}_{i,s_{e_{1}}},..%
.,\mathbf{X}_{i,t_{e_{2}}-1}],...,[\mathbf{X}_{i,s_{e_{v}}},...,\mathbf{X}_{i,%
T_{i}}]
>2
<65
2/3
\omega
\omega
\omega=1
\zeta
\omega
\zeta=0
\omega=1
H
h
0
2h
H\longrightarrow+\infty
H=11
h
H=8
2
4
\alpha
\alpha=0.05
h_{\max}=\max_{i}(T_{i})
h_{\max}
\frac{d\mathcal{L}_{i,t}}{d\hat{\lambda}^{h}_{i,t+1}}=0
h_{min}
h_{max}
q(t)
h_{min}=0
h_{max}=2h
\gamma
q^{exp}
\gamma=0.2
\gamma=0.05
h
0.5
0.5
t_{e}-h
t_{e}
\leq 50
50<
\leq 70
>70
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{32.7}
\pm
\mathbf{41.1}
\pm
\mathbf{32.6}
\pm
\mathbf{40.0}
\pm
\mathbf{31.7}
\pm
\mathbf{41.2}
\pm
\mathbf{32.8}
\pm
\mathbf{40.4}
\pm
\mathbf{32.0}
\pm
\Delta
\leq 50
50<
\leq 70
>70
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{30.5}
\pm
\pm
\mathbf{36.7}
\pm
\mathbf{29.1}
\pm
\mathbf{36.3}
\pm
\mathbf{30.3}
\pm
\mathbf{31.6}
\pm
\mathbf{25.7}
\pm
\mathbf{39.6}
\pm
\mathbf{32.8}
\pm
\Delta
\omega>1
\zeta=0
\zeta\geq 0
b(c)
\zeta=0
\zeta\geq 0
b(c)
l_{1}
\alpha=0.1
\gamma=0.05
\gamma=0.1
300
60\%
\approx 40\%
~{}1.5
~{}10
~{}15
34\%
p
<0.05
p
<0.05
\pm
\pm
\pm
\pm
\pm
\pm
\pm
{76.6}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
p
t_{e}-h
0.5
0.5
0.5
0.5
