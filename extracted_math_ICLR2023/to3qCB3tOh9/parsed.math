{\mathcal{G}}=({\mathcal{V}},{\mathcal{E}},{\mathcal{R}})
{\mathcal{V}}
{\mathcal{E}}
{\mathcal{R}}
(i,j,r)
i
j
r
n
m
{\bm{x}}\in{\mathbb{R}}^{n\times 3}
{\bm{f}}_{i}
{\bm{f}}_{(i,j,r)}
i
(i,j,r)
d\in\{-2,-1,0,1,2\}
m
|{\mathcal{R}}|
\displaystyle{\bm{h}}^{(0)}_{i}={\bm{f}}_{i},\;\;\;{\bm{u}}^{(l)}_{i}=\sigma%
\left(\text{BN}\left(\sum\nolimits_{r\in{\mathcal{R}}}{\bm{W}}_{r}\sum%
\nolimits_{j\in{\mathcal{N}}_{r}(i)}{\bm{h}}^{(l-1)}_{j}\right)\right),\;\;\;{%
\bm{h}}^{(l)}_{i}={\bm{h}}^{(l-1)}_{i}+{\bm{u}}^{(l)}_{i}.
\displaystyle{\bm{h}}^{(0)}_{i}
\displaystyle={\bm{f}}_{i},\;\;\;{\bm{u}}^{(l)}_{i}=\sigma\left(\text{BN}\left%
(\sum\nolimits_{r\in{\mathcal{R}}}{\bm{W}}_{r}\sum\nolimits_{j\in{\mathcal{N}}%
_{r}(i)}{\bm{h}}^{(l-1)}_{j}\right)\right),\;\;\;{\bm{h}}^{(l)}_{i}={\bm{h}}^{%
(l-1)}_{i}+{\bm{u}}^{(l)}_{i}.
{\bm{f}}_{i}
{\bm{h}}^{(l)}_{i}
i
l
{\bm{u}}^{(l)}_{i}
{\mathcal{N}}_{r}(i)
{\mathcal{N}}_{r}(i)=\{j\in{\mathcal{V}}|(j,i,r)\in{\mathcal{E}}\}
i
r
{\bm{W}}_{r}
r
\sigma(\cdot)
{\bm{h}}_{i}^{(l)}
{\bm{u}}^{(l)}_{i}
{\mathcal{G}}^{\prime}=({\mathcal{V}}^{\prime},{\mathcal{E}}^{\prime},{%
\mathcal{R}}^{\prime})
{\mathcal{G}}^{\prime}
{\mathcal{G}}^{\prime}
(i,j,r_{1})
(w,k,r_{2})
j=w
i\neq k
(i,j,r_{1})
(w,k,r_{2})
[0,\pi]
8
{\mathcal{G}}^{\prime}
\displaystyle{\bm{m}}^{(0)}_{(i,j,r_{1})}={\bm{f}}_{(i,j,r_{1})},\;\;{\bm{m}}^%
{(l)}_{(i,j,r_{1})}=\sigma\left(\text{BN}\left(\sum\nolimits_{r\in{\mathcal{R}%
}^{\prime}}{\bm{W}}^{\prime}_{r}\sum\nolimits_{(w,k,r_{2})\in{\mathcal{N}}^{%
\prime}_{r}((i,j,r_{1}))}{\bm{m}}^{(l-1)}_{(w,k,r_{2})}\right)\right).
\displaystyle{\bm{m}}^{(0)}_{(i,j,r_{1})}={\bm{f}}_{(i,j,r_{1})},\;\;{\bm{m}}^%
{(l)}_{(i,j,r_{1})}=\sigma\left(\text{BN}\left(\sum\nolimits_{r\in{\mathcal{R}%
}^{\prime}}{\bm{W}}^{\prime}_{r}\sum\nolimits_{(w,k,r_{2})\in{\mathcal{N}}^{%
\prime}_{r}((i,j,r_{1}))}{\bm{m}}^{(l-1)}_{(w,k,r_{2})}\right)\right).
{\bm{m}}^{(l)}_{(i,j,r_{1})}
(i,j,r_{1})
l
(i,j,r_{1})
{\mathcal{N}}^{\prime}_{r}((i,j,r_{1}))
{\mathcal{N}}^{\prime}_{r}((i,j,r_{1}))=\{(w,k,r_{2})\in{\mathcal{V}}^{\prime}%
|((w,k,r_{2}),(i,j,r_{1}),r)\in{\mathcal{E}}^{\prime}\}
(i,j,r_{1})
r
{\mathcal{G}}^{\prime}
\displaystyle\adjustbox{maxwidth=0.9}${\bm{u}}^{(l)}_{i}=\sigma\left(\text{BN}%
\left(\sum_{r\in{\mathcal{R}}}{\bm{W}}_{r}\sum_{j\in{\mathcal{N}}_{r}(i)}({\bm%
{h}}^{(l-1)}_{j}+\text{FC}({\bm{m}}^{(l)}_{(j,i,r)})\right)\right)$
\displaystyle\adjustbox{maxwidth=0.9}${\bm{u}}^{(l)}_{i}=\sigma\left(\text{BN}%
\left(\sum_{r\in{\mathcal{R}}}{\bm{W}}_{r}\sum_{j\in{\mathcal{N}}_{r}(i)}({\bm%
{h}}^{(l-1)}_{j}+\text{FC}({\bm{m}}^{(l)}_{(j,i,r)})\right)\right)$
\text{FC}(\cdot)
{\mathcal{G}}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\mathcal{G}}^{(\text{space})}_{p,d}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\mathcal{G}}^{\prime}
{\mathcal{G}}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\mathcal{G}}^{(\text{space})}_{p,d}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\mathcal{G}}^{\prime}
{\mathcal{G}}
l
r
l
r
p
d
{\mathcal{G}}=({\mathcal{V}},{\mathcal{E}},{\mathcal{R}})
{\mathcal{G}}^{(\text{seq})}_{l,r}
{\mathcal{G}}^{(\text{space})}_{p,d}
\displaystyle{\mathcal{V}}^{(\text{seq})}_{l,r}=\{i|i\in{\mathcal{V}},l\leq i%
\leq r\},\;\;{\mathcal{E}}^{(\text{seq})}_{l,r}=\{(i,j,r)|(i,j,r)\in{\mathcal{%
E}},i\in{\mathcal{V}}^{(\text{seq})}_{l,r},j\in{\mathcal{V}}^{(\text{seq})}_{l%
,r}\},
\displaystyle{\mathcal{V}}^{(\text{seq})}_{l,r}=\{i|i\in{\mathcal{V}},l\leq i%
\leq r\}
\displaystyle,\;\;{\mathcal{E}}^{(\text{seq})}_{l,r}=\{(i,j,r)|(i,j,r)\in{%
\mathcal{E}},i\in{\mathcal{V}}^{(\text{seq})}_{l,r},j\in{\mathcal{V}}^{(\text{%
seq})}_{l,r}\},
\displaystyle{\mathcal{V}}^{(\text{space})}_{p,d}=\{i|i\in{\mathcal{V}},\|{\bm%
{x}}_{i}-{\bm{x}}_{p}\|_{2}\leq d\},\;\;{\mathcal{E}}^{(\text{space})}_{p,d}=%
\{(i,j,r)|(i,j,r)\in{\mathcal{E}},i\in{\mathcal{V}}^{(\text{space})}_{p,d},j%
\in{\mathcal{V}}^{(\text{space})}_{p,d}\},
\displaystyle{\mathcal{V}}^{(\text{space})}_{p,d}=\{i|i\in{\mathcal{V}},\|{\bm%
{x}}_{i}-{\bm{x}}_{p}\|_{2}\leq d\}
\displaystyle,\;\;{\mathcal{E}}^{(\text{space})}_{p,d}=\{(i,j,r)|(i,j,r)\in{%
\mathcal{E}},i\in{\mathcal{V}}^{(\text{space})}_{p,d},j\in{\mathcal{V}}^{(%
\text{space})}_{p,d}\},
{\mathcal{G}}^{(\text{seq})}_{l,r}=({\mathcal{V}}^{(\text{seq})}_{l,r},{%
\mathcal{E}}^{(\text{seq})}_{l,r},{\mathcal{R}})
{\mathcal{G}}^{(\text{space})}_{p,d}=({\mathcal{V}}^{(\text{space})}_{p,d},{%
\mathcal{E}}^{(\text{space})}_{p,d},{\mathcal{R}})
{\mathcal{G}}
{\mathcal{G}}_{x}
{\mathcal{G}}_{y}
{\bm{h}}_{x}
{\bm{h}}_{y}
{\bm{z}}_{x}
{\bm{z}}_{y}
x
y
x
y
\displaystyle\vspace{-0.3em}{\mathcal{L}}_{x,y}=-\log\frac{\exp(\text{sim}({%
\bm{z}}_{x},{\bm{z}}_{y})/\tau)}{\sum_{k=1}^{2B}\text{1}_{[k\neq x]}\exp(\text%
{sim}({\bm{z}}_{y},{\bm{z}}_{k})/\tau)},\vspace{-0.3em}
\displaystyle\vspace{-0.3em}{\mathcal{L}}_{x,y}=-\log\frac{\exp(\text{sim}({%
\bm{z}}_{x},{\bm{z}}_{y})/\tau)}{\sum_{k=1}^{2B}\text{1}_{[k\neq x]}\exp(\text%
{sim}({\bm{z}}_{y},{\bm{z}}_{k})/\tau)},\vspace{-0.3em}
B
\tau
\text{1}_{[k\neq x]}\in\{0,1\}
1
k\neq x
\text{sim}({\bm{u}},{\bm{v}})
{\bm{u}}
{\bm{v}}
\AA
\AA
r-l
d
15\AA
{\mathcal{L}}_{i}=\text{CE}(f_{\text{residue}}({\bm{h}}^{\prime}_{i}),{\bm{f}}%
_{i})
{\mathcal{L}}_{(i,j,r)}=(f_{\text{dist}}({\bm{h}}^{\prime}_{i},{\bm{h}}^{%
\prime}_{j})-\|{\bm{x}}_{i}-{\bm{x}}_{j}\|_{2})^{2}
{\mathcal{L}}_{(i,j,r_{1}),(j,k,r_{2})}=\text{CE}(f_{\text{angle}}({\bm{h}}^{%
\prime}_{i},{\bm{h}}^{\prime}_{j},{\bm{h}}^{\prime}_{k}),\text{bin}(\angle ijk))
{\mathcal{L}}_{(i,j,r_{1}),(j,k,r_{2}),(k,t,r_{3})}=\text{CE}(f_{\text{dih}}({%
\bm{h}}^{\prime}_{i},{\bm{h}}^{\prime}_{j},{\bm{h}}^{\prime}_{k},{\bm{h}}^{%
\prime}_{t}),\text{bin}(\angle ijkt))
f_{\text{residue}}(\cdot),f_{\text{dist}}(\cdot),f_{\text{angle}}(\cdot),f_{%
\text{dih}}(\cdot)
\text{CE}(\cdot)
\text{bin}(\cdot)
{\bm{f}}_{i}
{\bm{x}}_{i}
i
{\bm{h}}^{\prime}_{i}
i
f_{\text{residue}}(\cdot),f_{\text{dist}}(\cdot),f_{\text{angle}}(\cdot),f_{%
\text{dih}}(\cdot)
\text{CE}(\cdot)
\text{bin}(\cdot)
{\bm{f}}_{i}
{\bm{x}}_{i}
i
{\bm{h}}^{\prime}_{i}
i
4
(4,7,\text{red})
4
(4,7,\text{red})
i
j
d_{\text{seq}}
|j-i|<d_{\text{seq}}
d=j-i
2d_{\text{seq}}-1
i
j
d_{\text{radius}}
i
j
d_{\text{long}}
|i-j|<d_{\text{long}}
d_{\text{seq}}=3
d_{\text{radius}}=10.0\mathrm{\AA}
k=10
d_{\text{long}}=5
2d_{\text{seq}}+1=7
{\bm{f}}\in\{0,1\}^{n\times 21}
{\bm{f}}_{(i,j,r)}
(i,j,r)
\displaystyle{\bm{f}}_{(i,j,r)}=\text{Cat}\left({\bm{f}}_{i},{\bm{f}}_{j},%
\text{onehot}(r),|i-j|,\|{\bm{x}}_{i}-{\bm{x}}_{j}\|_{2}\right),
\displaystyle{\bm{f}}_{(i,j,r)}=\text{Cat}\left({\bm{f}}_{i},{\bm{f}}_{j},%
\text{onehot}(r),|i-j|,\|{\bm{x}}_{i}-{\bm{x}}_{j}\|_{2}\right),
\text{Cat}(\cdot)
{\mathcal{G}}
\tilde{{\bm{h}}}^{(l)}_{i}
i
l
i
\displaystyle\tilde{{\bm{h}}}^{(l)}_{i}=\sum\nolimits_{j\in{\mathcal{N}}(i)}k_%
{o}(f({\mathcal{G}},i,j))\cdot{\bm{h}}^{(l-1)}_{j},
\displaystyle\tilde{{\bm{h}}}^{(l)}_{i}=\sum\nolimits_{j\in{\mathcal{N}}(i)}k_%
{o}(f({\mathcal{G}},i,j))\cdot{\bm{h}}^{(l-1)}_{j},
{\mathcal{N}}(i)
i
f({\mathcal{G}},i,j)
i
j
k_{o}(\cdot)
\displaystyle{\bm{h}}^{(l)}_{i}={\bm{h}}^{(l-1)}_{i}+{\bm{u}}^{(l)}_{i}+\tilde%
{{\bm{h}}}^{(l)}_{i}.
\displaystyle{\bm{h}}^{(l)}_{i}={\bm{h}}^{(l-1)}_{i}+{\bm{u}}^{(l)}_{i}+\tilde%
{{\bm{h}}}^{(l)}_{i}.
[0,\pi]
8
i
t\in[0,1]
\displaystyle\text{precision}_{i}(t)=\frac{\sum_{f}\text{1}[f\in P_{i}(t)\cap T%
_{i}]}{\sum_{f}\text{1}[f\in P_{i}(t)]},
\displaystyle\text{precision}_{i}(t)=\frac{\sum_{f}\text{1}[f\in P_{i}(t)\cap T%
_{i}]}{\sum_{f}\text{1}[f\in P_{i}(t)]},
\displaystyle\text{recall}_{i}(t)=\frac{\sum_{f}\text{1}[f\in P_{i}(t)\cap T_{%
i}]}{\sum_{f}\text{1}[f\in T_{i}]},
\displaystyle\text{recall}_{i}(t)=\frac{\sum_{f}\text{1}[f\in P_{i}(t)\cap T_{%
i}]}{\sum_{f}\text{1}[f\in T_{i}]},
f
T_{i}
i
P_{i}(t)
i
t
\text{1}[\cdot]\in\{0,1\}
1
t
\displaystyle\text{precision}(t)=\frac{1}{M(t)}\sum_{i}\text{precision}_{i}(t),
\displaystyle\text{precision}(t)=\frac{1}{M(t)}\sum_{i}\text{precision}_{i}(t),
\displaystyle\text{recall}(t)=\frac{1}{N}\sum_{i}\text{recall}_{i}(t),
\displaystyle\text{recall}(t)=\frac{1}{N}\sum_{i}\text{recall}_{i}(t),
N
M(t)
t
|P_{i}(t)|>0
\displaystyle\text{F\textsubscript{max}}=\max_{t}\left\{\frac{2\cdot\text{%
precision}(t)\cdot\text{recall}(t)}{\text{precision}(t)+\text{recall}(t)}%
\right\}.
\displaystyle\text{F\textsubscript{max}}=\max_{t}\left\{\frac{2\cdot\text{%
precision}(t)\cdot\text{recall}(t)}{\text{precision}(t)+\text{recall}(t)}%
\right\}.
120\times 120\times 120
\mathrm{\AA}
\tau
0.6
5
50
0.5
0.859
0.821
{\bm{f}}
