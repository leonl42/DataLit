\square
\circ
\times
\square
\circ
\times
\mathbf{G}_{T_{s}}
\mathbf{F}_{T_{t}}
\text{Proj}_{T_{t}}
\mathbf{F}^{\prime}_{T_{t}}
\mathbf{G}_{T_{s}}
\mathbf{G}_{T_{s}}
\mathbf{F}_{T_{t}}
\text{Proj}_{T_{t}}
\mathbf{F}^{\prime}_{T_{t}}
\mathbf{G}_{T_{s}}
10^{5}
k
k
N
T_{s}
s\in\{1,\dots,N\}
T_{t}
t\in\{1,\dots,N\}
C_{A}
\mathbf{F}_{T_{t}}
\mathbf{G}_{T_{s}}
T_{s}
C_{A}
\{a_{T_{s}}^{c-},a_{T_{s}}^{c},a_{T_{s}}^{c+}\}_{c=1}^{C_{A}}
a_{T_{s}}^{c+}
a_{T_{s}}^{c-}
a_{T_{s}}^{c}
\mathcal{R}^{\text{ctr}}_{ts}
\displaystyle\mathcal{R}^{\text{ctr}}_{ts}=\frac{1}{C_{A}}\sum_{c=1}^{C_{A}}%
\big{[}D\big{(}\mathbf{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf{F}^{\prime}_%
{T_{t}}(a_{T_{s}}^{c+})\big{)}-
\displaystyle\mathcal{R}^{\text{ctr}}_{ts}=\frac{1}{C_{A}}\sum_{c=1}^{C_{A}}%
\big{[}
\displaystyle D\big{(}\mathbf{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf{F}^{%
\prime}_{T_{t}}(a_{T_{s}}^{c+})\big{)}-
\displaystyle D\big{(}\mathbf{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf{F}^{%
\prime}_{T_{t}}(a_{T_{s}}^{c-})\big{)}+m\big{]}_{+},
\displaystyle D\big{(}\mathbf{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf{F}^{%
\prime}_{T_{t}}(a_{T_{s}}^{c-})\big{)}+m\big{]}_{+},
D(\cdot)
\mathbf{F}^{\prime}_{T_{t}}
\mathrm{Proj}_{T_{t}}(\cdot)
\mathbf{F}^{\prime}_{T_{t}}=\mathrm{Proj}_{T_{t}}(\mathbf{F}_{T_{t}})
\text{Proj}_{T_{t}}(\cdot)=\text{BN}\circ\text{Conv}_{1\times 1}\circ\text{%
ReLU}\circ\text{Conv}_{1\times 1}(\cdot)
\mathrm{BN}
\mathrm{Conv_{1\times 1}}
\mathrm{ReLU}
\mathbf{F}_{T_{t}}(\cdot)
\mathbf{F}_{T_{t}}
m
T_{s}
T_{t}
\mathcal{L}^{\text{ctr}}=\sum_{t=1}^{N}{\sum_{s=1,s\neq t}^{N}{\mathcal{R}_{ts%
}^{\text{ctr}}}}\big{(}\mathbf{F}_{{T_{t}}},\mathbf{G}_{T_{s}},C_{A},m\big{)}.
\gamma
\mathbf{I}\in\mathbb{R}^{H\times W}
p_{t}
H
W
C_{A}=\gamma HW
a_{T_{s}}^{c}\sim U(\mathbf{I})
\mathbf{G}_{T_{s}}
T_{s}
a_{T_{s}}^{c}
\mathbf{I}
\mathbf{I}_{T_{s}}^{+}
\mathbf{I}_{T_{s}}^{-}
M\in\mathbb{R}^{C_{A}\times HW}
a_{T_{s}}^{c}
a_{T_{s}}^{c+}=\operatorname*{arg\,max}_{a\in I_{T_{s}}^{+}}{D\left(\mathbf{F}%
^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf{F}^{\prime}_{T_{t}}(a)\right)}.
\text{Proj}_{T_{t}}(\cdot)
a_{T_{s}}^{c}
C_{\text{neg}}
a_{T_{s}}^{c-}
a_{T_{s}}^{c}
\text{D}(\mathbf{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf{F}^{\prime}_{T_{t}%
}(a_{T_{s}}^{c-}))>\text{D}(\mathbf{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c}),\mathbf%
{F}^{\prime}_{T_{t}}(a_{T_{s}}^{c+}))
T_{t}
T_{s}
N
N\times(N-1)
T_{t}
t\in\{1,...,N\}
N-1
\mathcal{L}_{overall}
\mathcal{L}_{overall}=\sum_{i=1}^{N}\lambda_{i}^{\text{task}}\mathcal{L}_{i}^{%
\text{task}}+\lambda^{\text{ctr}}\mathcal{L}^{\text{ctr}},
\mathcal{L}_{i}^{\text{task}}
T_{i}
\lambda_{i}^{\text{task}}
\lambda^{\text{ctr}}
\lambda^{\text{ctr}}
\uparrow
\downarrow
\downarrow
\Delta_{m}(\%)\uparrow
\uparrow
\downarrow
\downarrow
F_{1}
m
\gamma
k
k
\lambda^{\text{con}}
T_{t}
T_{s}
\uparrow
\downarrow
\downarrow
\checkmark
\checkmark
\checkmark
\checkmark
T_{t}
T_{s}
T_{t}
T_{s}
k
\gamma
k
\gamma
k
\gamma
k
k
\gamma
k
\gamma
k
\gamma
k
\uparrow
\downarrow
\downarrow
\uparrow
\uparrow
\uparrow
\downarrow
\uparrow
l2
l2
k
\gamma
k
k
k
k
k
\gamma
k
\gamma
