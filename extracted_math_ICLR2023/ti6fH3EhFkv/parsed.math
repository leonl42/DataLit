\mathcal{X}
\mathcal{Y}
\mathcal{D}
\mathcal{X}
\mathcal{\widehat{D}}
\mathcal{D}
P(\cdot)
\mathbb{E}(\cdot)
\mathcal{U}
\mathcal{S}
\mathcal{T}
\mathcal{H}
h
\mathcal{H}
\psi
\theta
\mathbf{x}
\mathbf{y}
\mathbf{z}
D
\mathcal{X}
\mathcal{Y}
f:\mathcal{X}\mapsto\mathcal{Y}
f
\widehat{\mathcal{D}}=\{\mathbf{x}_{1},...,\mathbf{x}_{n}\}
\mathcal{D}
P(\mathbf{X})
\mathcal{X}
\mathcal{H}
\ell:\mathcal{Y}\times\mathcal{Y}\mapsto\mathbb{R}_{+}
h\in\mathcal{H}
\min_{h\in\mathcal{H}}\mathbb{E}_{\mathbf{x}\sim\mathcal{D}}\ell(h(\mathbf{x})%
,f(\mathbf{x}))
\mathcal{S}
t_{\mathcal{S}}
\mathcal{T}
t_{\mathcal{T}}
t_{\mathcal{S}}
\mathcal{S}
t_{\mathcal{T}}
\mathcal{T}
\mathcal{S}\neq\mathcal{T}
t_{\mathcal{S}}\neq t_{\mathcal{T}}
\mathcal{U}
t_{\mathcal{U}}
h(\mathbf{x})
\delta(\mathbf{x}):=h(\mathbf{x})-\mathbf{x}
\delta(\mathbf{x})+\mathbf{x}
\phi
\theta
n
i\in[n]
\mathcal{D}^{\text{tr}}_{i}
\mathcal{D}^{\text{ts}}_{i}
\mathcal{D}^{\text{ts}}
\phi^{*}={\arg}\mathop{\max}_{\phi}\sum_{i=1}^{n}\log P(\theta_{i}(\phi)|%
\mathcal{D}^{\text{ts}}_{i}),\quad\text{where}\ \theta_{i}(\phi)={\arg}\mathop%
{\max}_{\theta}\log P(\theta|\mathcal{D}^{\text{tr}}_{i},\phi).\\

\theta
\mathcal{D}^{\text{tr}}_{i}
\phi
\mathcal{D}^{\text{ts}}_{i}
\phi
\theta
\theta
\mathcal{D}^{\text{tr}}_{i}
\phi
\mathcal{D}^{\text{ts}}_{i}
\phi
\phi
\theta
\theta
\mathcal{D}^{\text{tr}}_{i}
\phi
\mathcal{D}^{\text{ts}}_{i}
\phi
\mathcal{D}_{i}^{\text{tr}}
\theta
\mathcal{D}_{i}^{\text{ts}}
i\in[n]
\phi
\mathcal{D}_{i}^{\text{tr}}
\alpha
\theta_{i}=\phi-\alpha\nabla_{\phi}L(\phi,\mathcal{D}_{i}^{\text{tr}}).
\phi
\phi
i\in[n]
\theta_{i}
\mathcal{D}_{i}^{\text{ts}}
\min_{\phi}\sum_{i=1}^{n}L(\theta_{i}(\phi),\mathcal{D}_{i}^{\text{ts}})=\sum_%
{i=1}^{n}L(\phi-\alpha\nabla_{\phi}L(\phi,\mathcal{D}_{i}^{\text{tr}}),%
\mathcal{D}_{i}^{\text{ts}}).
\psi:\mathcal{X}\rightarrow\mathcal{Z}
\mathcal{E}^{\text{tr}}
h:\mathcal{Z}\rightarrow\mathcal{Y}
\mathop{\min}_{\psi:\mathcal{X}\rightarrow\mathcal{Z},{h}:\mathcal{Z}%
\rightarrow\mathcal{Y}}\ \sum_{e\in\mathcal{E}^{\text{tr}}}\epsilon^{e}(h\circ%
\psi),\quad\text{subject to }h\in\mathop{\arg\min}_{\bar{h}:\mathcal{Z}%
\rightarrow\mathcal{Y}}\epsilon^{e}(\bar{h}\circ\psi),\ \text{for all}\ e\in%
\mathcal{E}^{\text{tr}},
\epsilon^{e}(h\circ\psi)
h\circ\psi
e
P(\mathbf{X})
f_{\theta}
\tilde{\mathbf{x}}
\mathbf{z}=f_{\theta}(\tilde{\mathbf{x}})
g_{\theta}
\widehat{\mathbf{x}}=g_{\theta}(\mathbf{z})
L_{\text{gen}}(\widehat{\mathbf{x}},\mathbf{x})
\mathbf{x}
\tilde{\mathbf{x}}
\mathbf{z}
\mathbf{x}
\tilde{\mathbf{x}}
\mathbf{z}
\mathbf{x}_{1:T}=[x_{1},x_{2},...,x_{T}]
x_{t}
\max_{\theta}\sum_{t=1}^{T}\log P_{\theta}(x_{t}|x_{t-k},\cdots,x_{t-1}),
k
\theta
7000
x
y
x
y
\mathbf{x}
\tilde{\mathbf{x}}
m(\mathbf{x})
\mathbf{x}
\mathbf{x}_{\setminus m(\mathbf{x})}
\max_{\theta}\sum_{x\in m(\mathbf{x})}\log P_{\theta}(x|\mathbf{x}_{\setminus m%
(\mathbf{x})}).
175
500
104
\mathbf{x}^{q}
\mathbf{x}^{k}
\mathbf{x}
\mathbf{q}
\mathbf{k}
\mathbf{x}
\mathbf{q}
\mathbf{k}
\mathbf{x}
\mathbf{x}
\psi
\max_{\psi}\mathbb{E}_{\mathbf{x}\sim\mathcal{U}}\left[D(\mathbf{x},\psi(%
\mathbf{x}))-\mathbb{E}_{\mathbf{x}^{\prime}\sim\widetilde{\mathcal{U}}}\Big{(%
}\log\sum_{\mathbf{x}^{\prime}}e^{D(\mathbf{x}^{\prime},\psi(\mathbf{x}))}\Big%
{)}\right],
\mathbf{x}
\mathcal{U}
\mathbf{x}^{\prime}
\widetilde{\mathcal{U}}=\mathcal{U}
D
n
\psi
\mathbf{q}
\mathbf{k}_{+}
\min_{\psi}-\log\frac{\text{exp}(\mathbf{q}\cdot\mathbf{k}_{+}/\tau)}{\sum_{j=%
0}^{K}\text{exp}(\mathbf{q}\cdot\mathbf{k}_{j}/\tau)},
\tau
K
n
K<n
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar
\bigstar
\bigstar\bigstar
\bigstar
\bigstar
\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
h_{\theta^{0}}
\widehat{\mathcal{T}}=\{\mathbf{x}_{i},\textbf{y}_{i}\}_{i=1}^{m}
m
h_{\theta}:\mathcal{X}\mapsto\mathcal{Y}
\mathcal{H}
\epsilon_{\mathcal{T}}(h_{\theta})
10
\mathcal{T}^{\prime}
\mathcal{T}
\mathcal{T}^{\prime}
\mathcal{T}
\min_{\theta}\sum_{i=1}^{m}L(h_{\theta}(\mathbf{x}_{i}),\mathbf{y}_{i})+%
\lambda\cdot\Omega({\theta}),
L
\Omega
\lambda
L_{2}
\Omega(\theta)=\frac{1}{2}||\theta||_{2}^{2}
\theta
h_{\theta^{0}}
\Omega(\theta)=\sum_{j}\frac{1}{2}F_{j}\left\|\theta_{j}-\theta^{0}_{j}\right%
\|_{2}^{2},
F
\theta
\theta_{0}
L_{2}
\mathbf{z}
\mathbf{z}_{0}
\widehat{\mathbf{y}}_{0}
\mathbf{y}_{0}
\theta
\theta_{0}
L_{2}
\mathbf{z}
\mathbf{z}_{0}
\widehat{\mathbf{y}}_{0}
\mathbf{y}_{0}
\Omega(\theta)=\sum_{i=1}^{m}\max_{||{\widetilde{\mathbf{x}}_{i}}-\mathbf{x}_{%
i}||_{p}\leq\epsilon}L_{s}(h_{\theta}({\widetilde{\mathbf{x}}_{i}}),h_{\theta}%
(\mathbf{x}_{i})),
\epsilon>0
L_{s}
h_{\theta}(\mathcal{U},\mathcal{T})
\mathcal{U}
\mathcal{T}
h_{\theta}(\emptyset,\mathcal{T})
\mathcal{T}
NTG=\epsilon_{\mathcal{T}}(h_{\theta}(\mathcal{U},\mathcal{T}))-\epsilon_{%
\mathcal{T}}(h_{\theta}(\emptyset,\mathcal{T})),
NTG
26
\{\mathbf{z}_{i}=\psi(\mathbf{x}_{i})\}_{i=1}^{m}
\{\mathbf{y}_{i}\}_{i=1}^{m}
h_{\text{side}}
h_{\text{pretrained}}
h(x)=\alpha h_{\text{pretrained}}(x)+(1-\alpha)h_{\text{side}}(x)
\alpha
3.6\%
\theta_{\text{task}}=\theta_{\text{pretrained}}\oplus\delta_{\text{task}},
\oplus
\theta_{\text{pretrained}}
\delta_{\text{task}}
\theta_{\text{task}}
\theta_{\text{pretrained}}
\delta_{\text{task}}
\delta_{\text{task}}
L_{0}
\delta_{\text{task}}
M
\delta_{\text{task}}
\delta_{\text{low}}
\delta_{\text{task}}=\delta_{\text{low}}M
\theta_{\text{task}}=\theta_{\text{pretrained}}\odot\delta_{\text{task}}
\delta_{\text{task}}
\delta_{\text{task}}
\mathbf{x}
\mathbf{y}
P(\mathbf{y}|\mathbf{x})
\mathbf{x}
\tilde{\mathbf{x}}
\tilde{\mathbf{x}}
\widehat{\mathbf{x}}
\mathbf{y}
\widehat{\mathbf{x}}
\mathbf{x}
\mathbf{y}
{f_{\text{prompt}}(\mathbf{x})}
\tilde{\mathbf{x}}
\mathbf{\widehat{x}}
\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar
\widehat{\mathcal{S}}=\{(\mathbf{x}_{i}^{s},\mathbf{y}_{i}^{s})\}_{i=1}^{n}
n
\widehat{\mathcal{T}}=\{\mathbf{x}_{i}^{t}\}_{i=1}^{m}
m
h:\mathcal{X}\mapsto\mathcal{Y}
\mathcal{H}
\epsilon_{\mathcal{T}}(h)=\mathbb{E}_{(\mathbf{x}^{t},\mathbf{y}^{t})\sim%
\mathcal{T}}[\ell(h(\mathbf{x}^{t}),\mathbf{y}^{t})]
\mathcal{T}
\ell:\mathcal{Y}\times\mathcal{Y}\rightarrow\mathbb{R}_{+}
\epsilon_{\mathcal{T}}(h)
\epsilon_{\mathcal{S}}(h)
\mathcal{H}\Delta\mathcal{H}
\ell
h
h^{\prime}
\mathcal{D}
\epsilon_{\mathcal{D}}(h,h^{\prime})=\mathbb{E}_{(\mathbf{x},\mathbf{y})\sim%
\mathcal{D}}[\ell(h(\mathbf{x}),h^{\prime}(\mathbf{x}))].
\epsilon_{\mathcal{T}}(h)
\displaystyle{\epsilon_{\mathcal{T}}}\left(h\right)\leqslant{\epsilon_{%
\mathcal{S}}}\left(h\right)+\left[{{\epsilon_{\mathcal{S}}}\left({{h^{*}}}%
\right)+{\epsilon_{\mathcal{T}}}\left({{h^{*}}}\right)}\right]+\left|{{%
\epsilon_{\mathcal{S}}}\left({h,{h^{*}}}\right)-{\epsilon_{\mathcal{T}}}\left(%
{h,{h^{*}}}\right)}\right|,
\displaystyle{\epsilon_{\mathcal{T}}}\left(h\right)
\displaystyle\leqslant{\epsilon_{\mathcal{S}}}\left(h\right)+\left[{{\epsilon_%
{\mathcal{S}}}\left({{h^{*}}}\right)+{\epsilon_{\mathcal{T}}}\left({{h^{*}}}%
\right)}\right]+\left|{{\epsilon_{\mathcal{S}}}\left({h,{h^{*}}}\right)-{%
\epsilon_{\mathcal{T}}}\left({h,{h^{*}}}\right)}\right|,
h^{*}={\arg\min}_{h\in\mathcal{H}}\left[{{\epsilon_{\mathcal{S}}}\left({{h}}%
\right)+{\epsilon_{\mathcal{T}}}\left({{h}}\right)}\right]
\epsilon_{ideal}={{\epsilon_{\mathcal{S}}}\left({{h^{*}}}\right)+{\epsilon_{%
\mathcal{T}}}\left({{h^{*}}}\right)}
\left|{{\epsilon_{\mathcal{S}}}\left({h,{h^{*}}}\right)-{\epsilon_{\mathcal{T}%
}}\left({h,{h^{*}}}\right)}\right|
\mathcal{S}
\mathcal{T}
{\epsilon_{ideal}}
h^{*}
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}\Delta\mathcal{H}\triangleq\{h|h=h_{1}\otimes h_{2},h_{1},h_{2}\in%
\mathcal{H}\}
\mathcal{H}
\otimes
\mathcal{H}\Delta\mathcal{H}
\mathcal{S}
\mathcal{T}
\displaystyle d_{\mathcal{H}\Delta\mathcal{H}}(\mathcal{S},\mathcal{T})%
\triangleq\sup_{h,h^{\prime}\in\mathcal{H}}\left|{{\epsilon_{\mathcal{S}}}%
\left({h,{h^{\prime}}}\right)-{\epsilon_{\mathcal{T}}}\left({h,{h^{\prime}}}%
\right)}\right|.
\displaystyle d_{\mathcal{H}\Delta\mathcal{H}}(\mathcal{S},\mathcal{T})
\displaystyle\triangleq\sup_{h,h^{\prime}\in\mathcal{H}}\left|{{\epsilon_{%
\mathcal{S}}}\left({h,{h^{\prime}}}\right)-{\epsilon_{\mathcal{T}}}\left({h,{h%
^{\prime}}}\right)}\right|.
01
\ell(y,y^{\prime})=\mathds{1}(y\neq y^{\prime})
\displaystyle d_{\mathcal{H}\Delta\mathcal{H}}(\mathcal{S},\mathcal{T})={\sup_%
{\delta\in\mathcal{H}\Delta\mathcal{H}}}\left|{{\mathbb{E}_{{\mathcal{S}}}}%
\left[{\delta{\left({\mathbf{x}}\right)}\neq 0}\right]-{\mathbb{E}_{{\mathcal{%
T}}}}\left[{\delta\left({{\mathbf{x}}}\right)\neq 0}\right]}\right|.
\displaystyle d_{\mathcal{H}\Delta\mathcal{H}}(\mathcal{S},\mathcal{T})
\displaystyle={\sup_{\delta\in\mathcal{H}\Delta\mathcal{H}}}\left|{{\mathbb{E}%
_{{\mathcal{S}}}}\left[{\delta{\left({\mathbf{x}}\right)}\neq 0}\right]-{%
\mathbb{E}_{{\mathcal{T}}}}\left[{\delta\left({{\mathbf{x}}}\right)\neq 0}%
\right]}\right|.
\mathcal{H}\Delta\mathcal{H}
D
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}\Delta\mathcal{H}\subset\mathcal{H}_{D}
\mathcal{H}\Delta\mathcal{H}
{\sup_{D\in{\mathcal{H}_{D}}}}\left|{{\mathbb{E}_{{\mathcal{S}}}}\left[{D{%
\left({\mathbf{x}}\right)}=1}\right]+{\mathbb{E}_{{\mathcal{T}}}}\left[{D\left%
({{\mathbf{x}}}\right)=0}\right]}\right|
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}\Delta\mathcal{H}
\mathcal{F}
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}
d
\widehat{\mathcal{S}}
\widehat{\mathcal{T}}
m
\delta\in(0,1)
1-\delta
h\in\mathcal{H}
\epsilon_{\mathcal{T}}(h)\leq\epsilon_{{\mathcal{S}}}(h)+d_{\mathcal{H}\Delta%
\mathcal{H}}({\mathcal{\widehat{\mathcal{S}}}},{\mathcal{\widehat{T}}})+%
\epsilon_{ideal}+4\sqrt{\frac{2d\log(2m)+\log(\frac{2}{\delta})}{m}}.
01
\ell
h_{\mathcal{S}}^{*}=\arg\min_{h\in\mathcal{H}}\epsilon_{\mathcal{S}}(h)
h_{\mathcal{T}}^{*}=\arg\min_{h\in\mathcal{H}}\epsilon_{\mathcal{T}}(h)
h\in\mathcal{H}
\epsilon_{\mathcal{T}}(h)\leq\epsilon_{{\mathcal{S}}}(h,h_{\mathcal{S}}^{*})+d%
_{\mathcal{H}\Delta\mathcal{H}}({\mathcal{S}},{\mathcal{T}})+\epsilon,
\epsilon_{{\mathcal{S}}}(h,h_{\mathcal{S}}^{*})
\epsilon=\epsilon_{{\mathcal{T}}}(h_{\mathcal{T}}^{*})+\epsilon_{{\mathcal{S}}%
}(h_{\mathcal{T}}^{*},h_{\mathcal{S}}^{*})
\ell
\forall(y,y^{\prime})\in\mathcal{Y}^{2},\ell(y,y^{\prime})\leq M
M>0
\ell(y,y^{\prime})=|y-y^{\prime}|^{q}
q
\widehat{\mathcal{S}}
\widehat{\mathcal{T}}
n
m
1-\delta
d_{\mathcal{H}\Delta\mathcal{H}}({\mathcal{S}},{\mathcal{T}})\leq d_{\mathcal{%
H}\Delta\mathcal{H}}(\widehat{\mathcal{S}},\widehat{\mathcal{T}})+4q(\mathfrak%
{R}_{n,\mathcal{S}}(\mathcal{H})+\mathfrak{R}_{m,\mathcal{T}}(\mathcal{H}))+3M%
\Bigg{(}\sqrt{\frac{\log\frac{4}{\delta}}{2n}}+\sqrt{\frac{\log\frac{4}{\delta%
}}{2m}}\Bigg{)},
\mathfrak{R}_{n,\mathcal{D}}
\mathcal{D}
n
\mathcal{H}\Delta\mathcal{H}
h^{\prime}\in\mathcal{H}
h\in\mathcal{H}
h
\mathcal{H}
\mathcal{H}
h\!\in\!\mathcal{H}
h^{\prime}\in\mathcal{H}
d_{h,\mathcal{H}}(\mathcal{S},\mathcal{T})=\sup_{h^{\prime}\in\mathcal{H}}%
\left(\mathbb{E}_{\mathcal{T}}\mathds{1}[h^{\prime}\neq h]-\mathbb{E}_{%
\mathcal{S}}\mathds{1}[h^{\prime}\neq h]\right)
h^{\prime}\in\mathcal{H}
\widehat{\mathcal{S}}
\widehat{\mathcal{T}}
n
m
\delta>0
h\in\mathcal{H}
1-3\delta
\displaystyle\epsilon_{\mathcal{T}}(h)\leq\epsilon_{\widehat{\mathcal{S}}}(h)+%
d_{h,\mathcal{H}}(\widehat{\mathcal{S}},\widehat{\mathcal{T}})+\epsilon_{ideal%
}+2\mathfrak{R}_{n,\mathcal{S}}(\mathcal{H})
\displaystyle\epsilon_{\mathcal{T}}(h)
\displaystyle\leq\epsilon_{\widehat{\mathcal{S}}}(h)+d_{h,\mathcal{H}}(%
\widehat{\mathcal{S}},\widehat{\mathcal{T}})+\epsilon_{ideal}+2\mathfrak{R}_{n%
,\mathcal{S}}(\mathcal{H})
\displaystyle+2\mathfrak{R}_{n,\mathcal{S}}(\mathcal{H}\Delta\mathcal{H})+2%
\sqrt{\frac{\log\frac{2}{\delta}}{2n}}+2\mathfrak{R}_{m,\mathcal{T}}(\mathcal{%
H}\Delta\mathcal{H})+\sqrt{\frac{\log\frac{2}{\delta}}{2m}}.
\displaystyle+2\mathfrak{R}_{n,\mathcal{S}}(\mathcal{H}\Delta\mathcal{H})+2%
\sqrt{\frac{\log\frac{2}{\delta}}{2n}}+2\mathfrak{R}_{m,\mathcal{T}}(\mathcal{%
H}\Delta\mathcal{H})+\sqrt{\frac{\log\frac{2}{\delta}}{2m}}.
\mathcal{F}
f:\mathcal{X}\times\mathcal{Y}\rightarrow\mathbb{R}
\mathcal{F}
f
(x,y)
\rho_{f}(x,y)\triangleq\frac{1}{2}(f(x,y)-\max_{y^{\prime}\neq y}f(x,y^{\prime%
}))
f
h_{f}:x\mapsto\arg\max_{y\in\mathcal{Y}}f(x,y)
\Phi_{\rho}(x)\triangleq\begin{cases}0&\rho\leq{x}\\
1-x/\rho&0\leq{x}\leq\rho\\
1&{x}\leq 0\\
\end{cases},
f
f^{\prime}
\mathcal{D}
\epsilon_{\mathcal{D}}^{(\rho)}(f^{\prime},f)=\mathbb{E}_{(x,y)\sim\mathcal{D}%
}[\Phi_{\rho}(\rho_{f^{\prime}}(x,h_{f}(x))].
f\!\in\!\mathcal{F}
d_{f,\mathcal{F}}^{(\rho)}(\mathcal{S},\mathcal{T})=\sup_{f^{\prime}\in%
\mathcal{F}}[\epsilon_{\mathcal{T}}^{(\rho)}(f^{\prime},f)-\epsilon_{\mathcal{%
S}}^{(\rho)}(f^{\prime},f)].
\delta>0
1-3\delta
f\in\mathcal{F}
\displaystyle\epsilon_{\mathcal{T}}(f)\leq\ \epsilon_{\widehat{\mathcal{S}}}^{%
(\rho)}(f)+d_{f,\mathcal{F}}^{(\rho)}(\mathcal{\widehat{\mathcal{S}}},\mathcal%
{\widehat{T}})+\epsilon_{ideal}+\frac{2k^{2}}{\rho}{\mathfrak{R}_{n,\mathcal{S%
}}}(\Pi_{1}\mathcal{F})
\displaystyle\epsilon_{\mathcal{T}}(f)\leq
\displaystyle\ \epsilon_{\widehat{\mathcal{S}}}^{(\rho)}(f)+d_{f,\mathcal{F}}^%
{(\rho)}(\mathcal{\widehat{\mathcal{S}}},\mathcal{\widehat{T}})+\epsilon_{%
ideal}+\frac{2k^{2}}{\rho}{\mathfrak{R}_{n,\mathcal{S}}}(\Pi_{1}\mathcal{F})
\displaystyle+\ \frac{k}{\rho}{\mathfrak{R}_{n,\mathcal{S}}}(\Pi_{\mathcal{H}}%
\mathcal{F})+2\sqrt{\frac{\log\frac{2}{\delta}}{2n}}+\frac{k}{\rho}{\mathfrak{%
R}_{m,\mathcal{T}}}(\Pi_{\mathcal{H}}\mathcal{F})+\sqrt{\frac{\log\frac{2}{%
\delta}}{2m}},
\displaystyle+
\displaystyle\ \frac{k}{\rho}{\mathfrak{R}_{n,\mathcal{S}}}(\Pi_{\mathcal{H}}%
\mathcal{F})+2\sqrt{\frac{\log\frac{2}{\delta}}{2n}}+\frac{k}{\rho}{\mathfrak{%
R}_{m,\mathcal{T}}}(\Pi_{\mathcal{H}}\mathcal{F})+\sqrt{\frac{\log\frac{2}{%
\delta}}{2m}},
\Pi_{\mathcal{H}}\mathcal{F}\triangleq\{x\mapsto f(x,h(x))|h\in\mathcal{H},f%
\in\mathcal{F}\}
\mathcal{H}\Delta\mathcal{H}
\Pi_{1}\mathcal{F}\triangleq\{x\mapsto f(x,y)|y\in\mathcal{Y},f\in\mathcal{F}\}
\epsilon_{ideal}=\min_{f^{*}\in\mathcal{F}}\{\mathrm{err}_{\mathcal{S}}^{(\rho%
)}(f^{*})+\mathrm{err}_{\mathcal{T}}^{(\rho)}(f^{*})\}
k
\rho
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}
\mathcal{S}
\mathcal{T}
\mathbf{X}
d_{\mathcal{F}}(\mathcal{S},\mathcal{T})\triangleq\sup_{f\in\mathcal{F}}\big{|%
}\mathbb{E}_{\mathbf{x}\sim\mathcal{S}}[f(\mathbf{x})]-\mathbb{E}_{\mathbf{x}%
\sim\mathcal{T}}[f(\mathbf{x})]\big{|}
\mathcal{F}
\mathbf{X}
\mathcal{F}
\mathcal{H}_{k}
k
\mathcal{F}=\{f\in\mathcal{H}_{k}:||f||_{\mathcal{H}_{k}}\leq 1\}
d_{\emph{MMD}}^{2}(\mathcal{S},\mathcal{T})=\big{\|}\mathbb{E}_{\mathbf{x}\sim%
\mathcal{S}}[\phi(\mathbf{x})]-\mathbb{E}_{\mathbf{x}\sim\mathcal{T}}[\phi(%
\mathbf{x})]\big{\|}_{\mathcal{H}_{k}}^{2},
\phi(x)
k
k(\mathbf{x},\mathbf{x}^{\prime})=\left\langle\phi(\mathbf{x}),\phi(\mathbf{x}%
^{\prime})\right\rangle
\mathcal{S}=\mathcal{T}
d_{\mathcal{F}}(\mathcal{S},\mathcal{T})=0
d_{\emph{MMD}}^{2}(\mathcal{S},\mathcal{T})=0
\ell
\ell(y,y^{\prime})=|y-y^{\prime}|^{q}
q
\delta>0
1-\delta
h\in\mathcal{F}
\displaystyle\epsilon_{\mathcal{T}}(h)\leq\epsilon_{\mathcal{S}}(h)+d_{\emph{%
MMD}}(\mathcal{\widehat{\mathcal{S}}},\mathcal{\widehat{T}})+\epsilon_{ideal}
\displaystyle\epsilon_{\mathcal{T}}(h)
\displaystyle\leq\epsilon_{\mathcal{S}}(h)+d_{\emph{MMD}}(\mathcal{\widehat{%
\mathcal{S}}},\mathcal{\widehat{T}})+\epsilon_{ideal}
\displaystyle+\frac{2}{n}\mathbb{E}_{\mathbf{x}\sim\mathcal{S}}[\sqrt{\mathrm{%
tr}(\mathbf{K}_{\mathcal{S}})}]+\frac{2}{m}\mathbb{E}_{\mathbf{x}\sim\mathcal{%
T}}[\sqrt{\mathrm{tr}(\mathbf{K}_{\mathcal{T}})}]+\sqrt{\frac{\log\frac{2}{%
\delta}}{2n}}+\sqrt{\frac{\log\frac{2}{\delta}}{2m}},
\displaystyle+\frac{2}{n}\mathbb{E}_{\mathbf{x}\sim\mathcal{S}}[\sqrt{\mathrm{%
tr}(\mathbf{K}_{\mathcal{S}})}]+\frac{2}{m}\mathbb{E}_{\mathbf{x}\sim\mathcal{%
T}}[\sqrt{\mathrm{tr}(\mathbf{K}_{\mathcal{T}})}]+\sqrt{\frac{\log\frac{2}{%
\delta}}{2n}}+\sqrt{\frac{\log\frac{2}{\delta}}{2m}},
\mathbf{K}_{\mathcal{S}}
\mathbf{K}_{\mathcal{T}}
\mathcal{S}
\mathcal{T}
\mathcal{F}
fc6
fc7
fc8
P(\mathbf{X}^{s},\mathbf{Y}^{s})
Q(\mathbf{X}^{t},\mathbf{Y}^{t})
\mathcal{L}
\{(\mathbf{z}_{i}^{s1},\dots,\mathbf{z}_{i}^{s|\mathcal{L}|})\}_{i=1}^{n}
\{(\mathbf{z}_{j}^{t1},\dots,\mathbf{z}_{j}^{t|\mathcal{L}|})\}_{j=1}^{m}
d_{\text{JMMD}}^{2}(\widehat{\mathcal{S}},\widehat{\mathcal{T}})=\Big{\|}%
\mathbb{E}_{i\in[n]}\otimes_{l\in\mathcal{L}}\phi^{l}(\mathbf{z}_{i}^{sl})-%
\mathbb{E}_{j\in[m]}\otimes_{l\in\mathcal{L}}\phi^{l}(\mathbf{z}_{j}^{tl})\Big%
{\|}_{\mathcal{H}_{k}}^{2}
\phi^{l}
k^{l}
l
\otimes
k(\mathbf{x}_{1},\mathbf{x}_{2})=\exp(-||\mathbf{x}_{1}-\mathbf{x}_{1}||^{2}/{%
2\sigma^{2}})
\psi
h
D
\psi
D
\psi
D
\widehat{\mathbf{y}}
\mathbf{z}\otimes\widehat{\mathbf{y}}
\psi
h
D
\psi
D
\psi
D
\widehat{\mathbf{y}}
\mathbf{z}\otimes\widehat{\mathbf{y}}
D
\psi
\mathcal{H}\Delta\mathcal{H}
D
L_{\text{DANN}}(\psi)=\max_{D}\mathbb{E}_{\mathbf{x}^{s}\sim\widehat{\mathcal{%
S}}}\log[D(\mathbf{z}^{s})]+\mathbb{E}_{\mathbf{x}^{t}\sim\widehat{\mathcal{T}%
}}\log[1-D(\mathbf{z}^{t})],
\mathbf{z}=\psi(\mathbf{x})
\mathbf{x}
\psi
\mathcal{H}\Delta\mathcal{H}
\min_{\psi,h}\mathbb{E}_{(\mathbf{x}^{s},\mathbf{y}^{s})\sim\widehat{\mathcal{%
S}}}L_{\text{CE}}(h(\mathbf{z}^{s}),\mathbf{y}^{s})+\lambda L_{\text{DANN}}(%
\psi),
L_{\text{CE}}
\lambda
\mathbf{z}
\widehat{\mathbf{y}}=h(\mathbf{z})
\mathbf{z}\otimes\widehat{\mathbf{y}}
\mathbf{z}
D
L_{\text{CDAN}}(\psi)=\max_{D}\mathbb{E}_{\mathbf{x}^{s}\sim\widehat{\mathcal{%
S}}}\log[D(\mathbf{z}^{s}\otimes\widehat{\mathbf{y}}^{s})]+\mathbb{E}_{\mathbf%
{x}^{t}\sim\widehat{\mathcal{T}}}\log[1-D(\mathbf{z}^{t}\otimes\widehat{%
\mathbf{y}}^{t})].
\widehat{\mathbf{y}}
\mathbf{z}^{t}
D(\mathbf{z}^{t})=0
\psi
D
D
\psi
\min_{\psi}\mathbb{E}_{\mathbf{x}^{t}\sim\widehat{\mathcal{T}}}-\log[D(\mathbf%
{z}^{t})].
\mathcal{H}\Delta\mathcal{H}
\mathcal{H}\Delta\mathcal{H}
L_{1}
\mathcal{H}\Delta\mathcal{H}
h
h^{\prime}
\mathcal{H}
\mathcal{H}\Delta\mathcal{H}
h^{\prime}
h
d_{h,\mathcal{H}}(\mathcal{S},\mathcal{T})
\begin{split}L_{\text{DD}}(h,\psi)=\max_{h^{\prime}}&\ \mathbb{E}_{\mathbf{x}^%
{s}\sim\widehat{\mathcal{S}}}L^{s}\left[h^{\prime}(\psi(\mathbf{x}^{s})),h(%
\psi(\mathbf{x}^{s}))\right]\\
-&\ \mathbb{E}_{\mathbf{x}^{t}\sim\widehat{\mathcal{T}}}L^{t}\left[h^{\prime}(%
\psi(\mathbf{x}^{t})),h(\psi(\mathbf{x}^{t}))\right],\\
\end{split}
L^{s}
L^{t}
h^{\prime}
\epsilon_{\mathcal{T}}
\min_{\psi,h}\ \mathbb{E}_{(\mathbf{x}^{s},\mathbf{y}^{s})\sim\widehat{%
\mathcal{S}}}L_{\text{CE}}(h(\psi(\mathbf{x}^{s})),\mathbf{y}^{s})+\lambda L_{%
\text{DD}}(h,\psi),
\lambda
h^{\prime}
h
\psi
h_{1}
h_{2}
\psi
h^{\prime}
\psi
h_{1}
h_{2}
\psi
h^{\prime}
\psi
01
\rho
\gamma\triangleq\exp\rho
\begin{split}L_{\text{MDD}}(h,\psi)=\max_{h^{\prime}}\ \gamma&\ \mathbb{E}_{%
\mathbf{x}^{s}\sim\widehat{\mathcal{S}}}\log\left[\sigma_{h(\psi(\mathbf{x}^{s%
}))}(h^{\prime}(\psi(\mathbf{x}^{s})))\right]\\
+&\ \mathbb{E}_{\mathbf{x}^{t}\sim\widehat{\mathcal{T}}}\log\left[1-\sigma_{h(%
\psi(\mathbf{x}^{t}))}(h^{\prime}(\psi(\mathbf{x}^{t})))\right],\\
\end{split}
\sigma
\gamma
h^{\prime}
h^{\prime}
L^{s}
L^{t}
L_{1}
L_{2}
h^{\prime}
h^{\prime}
\mathcal{S}
\mathcal{T}
G
D
h
\psi
f
G
D
h
\psi
f
G:\mathcal{S}\rightarrow\mathcal{T}
G(\mathbf{x})
D
\displaystyle L_{\mathrm{GAN}}(G)=\max_{D}\mathbb{E}_{\mathbf{x}\sim\widehat{%
\mathcal{S}}}\log\left[1-D(G(\mathbf{x}))\right]+\mathbb{E}_{\mathbf{x}\sim%
\widehat{\mathcal{T}}}\log\left[D(\mathbf{x})\right].
\displaystyle L_{\mathrm{GAN}}(G)
\displaystyle=\max_{D}\mathbb{E}_{\mathbf{x}\sim\widehat{\mathcal{S}}}\log%
\left[1-D(G(\mathbf{x}))\right]+\mathbb{E}_{\mathbf{x}\sim\widehat{\mathcal{T}%
}}\log\left[D(\mathbf{x})\right].
G
G(\mathbf{x})
\min_{G}L_{\mathrm{GAN}}(G)
h
\psi
\min_{\psi,h}\mathbb{E}_{(\mathbf{x},\mathbf{y})\sim\widehat{\mathcal{S}}}L_{%
\text{sup}}(h\circ\psi(G(\mathbf{x})),\mathbf{y})
F:\mathcal{T}\rightarrow\mathcal{S}
F
G
F(G(\mathbf{x}))\approx\mathbf{x}
G(F(\mathbf{x}))\approx\mathbf{x}
f
\mathbf{x}
f(\mathbf{x})=f(G(\mathbf{x}))
f
h_{\mathrm{p}}
d
\min_{G}L_{\mathrm{sc}}(G,h_{\mathrm{p}})=d(h_{\mathrm{p}}(\mathbf{x}),h_{%
\mathrm{p}}(G(\mathbf{x}))).
G
\mathbf{x}_{1}
\mathbf{x}_{2}
\mathbf{y}_{1}
\mathbf{y}_{2}
L_{\text{GCE}}(\mathbf{x},\tilde{y})=1/q\cdot(1-h_{\tilde{y}}(\mathbf{x})^{q}),
q\in(0,1]
\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar\bigstar
\bigstar\bigstar
\bigstar
\bigstar
\bigstar\bigstar\bigstar
\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar\bigstar
\bigstar
\bigstar
\text{BERT}_{\text{Large}}
\text{BERT}_{\text{Large}}
\text{BERT}_{\text{Large}}
\text{BERT}_{\text{Large}}
\text{MNLI}_{m}
\text{MNLI}_{mm}
\text{BERT}_{\text{Large}}
\text{ViT}_{\text{large, patch16}}
\text{MNLI}_{m}
\text{MNLI}_{mm}
{}_{\text{Large}}
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
\shortrightarrow
