5.5\%
38.5\%
5.5\%
38.5\%
O(L\log L)
\mathbf{X}^{(L)}
\mathbf{X}^{(H)}
\ell_{L},\ell_{H}
t_{0}
d_{x}
\mathbf{X}^{(L)}=\{\mathbf{x}_{t}|\mathbf{x}_{t}\in\mathbb{R}^{d_{x}},t\in[t_{%
0},t_{0}+\ell_{L}]\}
\mathbf{X}^{(H)}=\{\mathbf{x}_{t}|\mathbf{x}_{t}\in\mathbb{R}^{d_{x}},t\in[t_{%
0}+\ell_{L}+1,t_{0}+\ell_{L}+\ell_{H}]\}
\mathbf{X}^{(H)}
\mathbf{X}^{(L)}
\mathbf{X}^{(L)}
S=\{s^{m},...,s^{2},s^{1},1\}
s=2
S
2
m=\lfloor\log_{s}\ell_{L}\rfloor-1
s
i
0\leq i\leq m
\mathbf{X}^{(L)}
s_{i}\equiv s^{m-i}
\mathbf{X}^{\textrm{out}}_{i-1}
s
\mathbf{X}^{\textrm{dec}}_{0}
\displaystyle\mathbf{x}_{t,i}=\frac{1}{s_{i}}\sum_{\tau+1}^{\tau+s_{i}}\mathbf%
{x}_{\tau},\quad\tau=t\times s_{i}
\displaystyle\mathbf{x}_{t,i}
\displaystyle=\frac{1}{s_{i}}\sum_{\tau+1}^{\tau+s_{i}}\mathbf{x}_{\tau},\quad%
\tau=t\times s_{i}
\displaystyle\mathbf{X}^{(L)}_{i}=\Big{\{}\mathbf{x}_{t,i}\hskip 5.69046pt\Big%
{|}\hskip 5.69046pt\frac{t_{0}}{s_{i}}\leq t\leq\frac{t_{0}+\ell_{L}}{s_{i}}%
\Big{\}}
\displaystyle\mathbf{X}^{(L)}_{i}
\displaystyle=\Big{\{}\mathbf{x}_{t,i}\hskip 5.69046pt\Big{|}\hskip 5.69046pt%
\frac{t_{0}}{s_{i}}\leq t\leq\frac{t_{0}+\ell_{L}}{s_{i}}\Big{\}}
\displaystyle\mathbf{X}^{(H)}_{i}=\Big{\{}\mathbf{x}_{t,i}\hskip 5.69046pt\Big%
{|}\hskip 5.69046pt\frac{t_{0}+\ell_{L}+1}{s_{i}}\leq t\leq\frac{t_{0}+\ell_{L%
}+\ell_{H}}{s_{i}}\Big{\}},
\displaystyle\mathbf{X}^{(H)}_{i}
\displaystyle=\Big{\{}\mathbf{x}_{t,i}\hskip 5.69046pt\Big{|}\hskip 5.69046pt%
\frac{t_{0}+\ell_{L}+1}{s_{i}}\leq t\leq\frac{t_{0}+\ell_{L}+\ell_{H}}{s_{i}}%
\Big{\}},
\mathbf{X}^{(L)}_{i}
\mathbf{X}^{(H)}_{i}
i
s^{m-i}
\ell_{L,i}
\ell_{H,i}
\mathbf{x^{\prime}}_{t,i-1}
i-1
t
\mathbf{X}^{\textrm{enc}}_{i}
\mathbf{X}^{\textrm{dec}}_{i}
\displaystyle\mathbf{X}^{\text{enc}}_{i}=\mathbf{X}^{(L)}_{i}
\displaystyle\mathbf{X}^{\text{enc}}_{i}
\displaystyle=\mathbf{X}^{(L)}_{i}
\displaystyle\mathbf{x^{\prime\prime}}_{t,i}=\mathbf{x^{\prime}}_{\lfloor t/s%
\rfloor,i-1}+\left(\mathbf{x^{\prime}}_{\lceil t/s\rceil,i-1}-\mathbf{x^{%
\prime}}_{\lfloor t/s\rfloor,i-1}\right)\times\frac{t-\lfloor t/s\rfloor}{s}
\displaystyle\mathbf{x^{\prime\prime}}_{t,i}
\displaystyle=\mathbf{x^{\prime}}_{\lfloor t/s\rfloor,i-1}+\left(\mathbf{x^{%
\prime}}_{\lceil t/s\rceil,i-1}-\mathbf{x^{\prime}}_{\lfloor t/s\rfloor,i-1}%
\right)\times\frac{t-\lfloor t/s\rfloor}{s}
\displaystyle\mathbf{X}^{\text{dec}}_{i}=\{\mathbf{x^{\prime\prime}}_{t,i}\Big%
{|}\hskip 5.69046pt\frac{t_{0}+\ell_{L}+1}{s_{i}}\leq t\leq\frac{t_{0}+\ell_{L%
}+\ell_{H}}{s_{i}}\}.
\displaystyle\mathbf{X}^{\text{dec}}_{i}
\displaystyle=\{\mathbf{x^{\prime\prime}}_{t,i}\Big{|}\hskip 5.69046pt\frac{t_%
{0}+\ell_{L}+1}{s_{i}}\leq t\leq\frac{t_{0}+\ell_{L}+\ell_{H}}{s_{i}}\}.
\mathbf{X}^{(H)}_{i}
\mathbf{X}^{\textrm{out}}_{i}
\mathbf{X}^{(L)}\in\mathbb{R}^{\ell_{L}\times d_{x}}
s
S=\{s^{m},...,s^{2},s^{1},1\}
\ell_{H}
F
i\leftarrow 0
m
\mathbf{X}_{i}^{\textrm{enc}}\leftarrow\textrm{AvgPool}\left(\mathbf{X}^{(L)},%
\textrm{window\_size=}s^{m-i}\right)
i=0
\mathbf{X}_{i}^{\textrm{dec}}\leftarrow\left[\overrightarrow{0}^{\ell_{H}}\right]
\mathbf{X}_{i}^{\textrm{dec}}\leftarrow\textrm{Upsample}\left(\mathbf{X}_{i-1}%
^{\textrm{out}},\textrm{scale=}s\right)
\bar{\mu}_{\mathbf{X}_{i}}\leftarrow\frac{1}{\ell_{L,i}+\ell_{H,i}}\left(\sum_%
{\mathbf{x^{\textrm{enc}}}\in\mathbf{X}^{\text{enc}}_{i}}\mathbf{x}^{\textrm{%
enc}}+\sum_{\mathbf{\mathbf{x}^{\textrm{dec}}}\in\mathbf{X}^{\textrm{dec}}_{i}%
}\mathbf{x}^{\textrm{dec}}\right)
\hat{\mathbf{X}}^{\textrm{dec}}_{i}\leftarrow\mathbf{X}^{\textrm{dec}}_{i}-%
\bar{\mu}_{\mathbf{X}_{i}}
\hat{\mathbf{X}}^{\textrm{enc}}_{i}\leftarrow\mathbf{X}^{\textrm{enc}}_{i}-%
\bar{\mu}_{\mathbf{X}_{i}}
\mathbf{X}_{i}^{\textrm{out}}\leftarrow F\left(\mathbf{X}_{i}^{\textrm{enc}},%
\mathbf{X}_{i}^{\textrm{dec}}\right)+\bar{\mu}_{\mathbf{X}_{i}}
\mathbf{X}^{\textrm{out}}_{:}
\mathbf{X}^{\text{enc}}_{i},\mathbf{X}^{\text{dec}}_{i}
\ell_{L_{i}}\times d_{x}
\ell_{H_{i}}\times d_{x}
i
\mathbf{X}^{\text{enc}}_{i}
\mathbf{X}^{\text{dec}}_{i}
\displaystyle\bar{\mu}_{\mathbf{X}_{i}}=\frac{1}{\ell_{L,i}+\ell_{H,i}}\left(%
\sum_{\mathbf{x^{\textrm{enc}}}\in\mathbf{X}^{\text{enc}}_{i}}\mathbf{x}^{%
\textrm{enc}}+\sum_{\mathbf{\mathbf{x}^{\textrm{dec}}}\in\mathbf{X}^{\textrm{%
dec}}_{i}}\mathbf{x}^{\textrm{dec}}\right)
\displaystyle\bar{\mu}_{\mathbf{X}_{i}}
\displaystyle=\frac{1}{\ell_{L,i}+\ell_{H,i}}\left(\sum_{\mathbf{x^{\textrm{%
enc}}}\in\mathbf{X}^{\text{enc}}_{i}}\mathbf{x}^{\textrm{enc}}+\sum_{\mathbf{%
\mathbf{x}^{\textrm{dec}}}\in\mathbf{X}^{\textrm{dec}}_{i}}\mathbf{x}^{\textrm%
{dec}}\right)
\displaystyle\hat{\mathbf{X}}^{\textrm{dec}}_{i}=\mathbf{X}^{\textrm{dec}}_{i}%
-\bar{\mu}_{\mathbf{X}_{i}},\quad\quad\quad\hat{\mathbf{X}}^{\textrm{enc}}_{i}%
=\mathbf{X}^{\textrm{enc}}_{i}-\bar{\mu}_{\mathbf{X}_{i}}
\displaystyle\hat{\mathbf{X}}^{\textrm{dec}}_{i}
\displaystyle=\mathbf{X}^{\textrm{dec}}_{i}-\bar{\mu}_{\mathbf{X}_{i}},\quad%
\quad\quad\hat{\mathbf{X}}^{\textrm{enc}}_{i}=\mathbf{X}^{\textrm{enc}}_{i}-%
\bar{\mu}_{\mathbf{X}_{i}}
\bar{\mu}_{\mathbf{X}_{i}}\in\mathbb{R}^{d_{x}}
\hat{\mathbf{X}}^{\textrm{enc}}_{i}
\hat{\mathbf{X}}^{\textrm{dec}}_{i}
i
\mathbf{x_{t}}
0
0.5
1
1/s_{i}-0.5
s_{i}
PE(\textrm{pos},2k,s_{i})=\textrm{sin}\left(\frac{\textrm{pos}\times s_{i}}{10%
000^{2k/d_{\textrm{model}}}}\right),\quad PE(\textrm{pos},2k+1,s_{i})=\textrm{%
cos}\left(\frac{\textrm{pos}\times s_{i}}{10000^{2k/d_{\textrm{model}}}}\right)
f(\xi,\alpha,c)=\frac{\lvert{\alpha-2}\rvert}{\alpha}\left({\left(\frac{(\xi/c%
)^{2}}{\lvert\alpha-2\rvert}+1\right)}^{\alpha/2}-1\right)
\xi=(\mathbf{X}^{\textrm{out}}_{i}-\mathbf{X}^{(H)}_{i})
i
\alpha
c
\textbf{5.6}\%
\textbf{5.9}\%
\textbf{13.5}\%
\textbf{9.1}\%
\textbf{38.5}\%
\textbf{26.7}\%
\textbf{38.3}\%
\textbf{25.2}\%
\textbf{23.3}\%
\textbf{16.9}\%
\mathbf{X}^{\textrm{enc}}=\mathbf{X}^{(L)}
\mathbf{X}^{\textrm{dec}}=\{\mathbf{x}_{t_{0}+\ell_{L}/2},...,\mathbf{x}_{\ell%
_{L}},0,0,...,0\}
\ell_{L}/2+\ell_{H}
5.6\%
13\%
38\%
50\%
\alpha
c
\mu
\sigma
s
s
\frac{1-s^{m}}{1-s}
s=2
s^{0}
\textbf{X}^{\textrm{out}}_{m-1}
96
96
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\xi
\xi^{\alpha}
\xi
L^{\alpha}
\xi
\alpha
\alpha
S=\{16,8,4,2,1\}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
s
s=16
s=2
s=16
s=2
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha
\alpha
\alpha
\alpha
c
\xi
\alpha
\alpha
\alpha
\xi
\alpha
\alpha
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mu
\sigma
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\frac{dx}{dt}=\frac{0.2\times x(t-\tau)}{1+x(t-\tau)^{10}}-(0.1\times x(t)),
x(0)=1.2
\tau=18
\tau\geq 17
\tau=12
\tau=9
\tau=\{18,12,9\}
\tau=\{18,12,9\}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
70\%
5\%
p<0.05
p<0.5
