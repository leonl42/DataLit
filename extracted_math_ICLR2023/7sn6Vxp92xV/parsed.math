\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{c}}
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{c}}
f
h
X\in\mathbb{R}^{C\times H\times W}
X
N
\tilde{X}\in\mathbb{R}^{N\times(P^{2}\cdot C)}
P
\mathcal{M}
\mathcal{V}
\bm{z}=f(\mathcal{V})
h
\mathcal{M}
\hat{Y}=h(\bm{z};\mathcal{M})
\hat{Y}\in\mathbb{R}^{N\times(P^{2}\cdot C)}
\mathcal{L}_{r}
\mathcal{L}_{\text{r}}=\frac{1}{|\mathcal{M}|}\sum_{i\in\mathcal{M}}\big{\|}%
\tilde{X}_{i}-\hat{Y}_{i}\big{\|}^{2}_{2}
T
S
T^{(t)}=\alpha T^{(t-1)}+(1-\alpha)S^{(t)}=\sum_{i=0}^{t}\alpha^{i}(1-\alpha)S%
^{(t-i)},
\alpha\in(0,1)
\mathcal{L}_{\text{c}}
\hat{Y}^{\prime}
\mathcal{L}_{\text{c}}=\frac{1}{|\mathcal{M}|}\sum_{i\in\mathcal{M}}\big{\|}%
\hat{Y}_{i}-\hat{Y}^{\prime}_{i}\big{\|}^{2}_{2}
S
T
\mathbf{x}
\tilde{\mathbf{x}}=\mathbf{x}\odot\mathbf{m}
\odot
\mathbf{m}
\nabla_{S}\mathcal{L}_{\text{c}}
\nabla_{S}\mathcal{L}_{\text{r}}
\hat{\mathbf{x}}
\displaystyle\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}=\nabla_{S}%
\frac{1}{2}\|S\tilde{\mathbf{x}}-\mathbf{x}\|^{2}_{2}+\nabla_{S}\frac{1}{2}\|S%
\tilde{\mathbf{x}}-\text{StopGrad}(T\tilde{\mathbf{x}})\|^{2}_{2}
\displaystyle\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}
\displaystyle=\nabla_{S}\frac{1}{2}\|S\tilde{\mathbf{x}}-\mathbf{x}\|^{2}_{2}+%
\nabla_{S}\frac{1}{2}\|S\tilde{\mathbf{x}}-\text{StopGrad}(T\tilde{\mathbf{x}}%
)\|^{2}_{2}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}+S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-T\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}+S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-T\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}\color[rgb]{0,0,0}{-}\color[rgb]{%
0.8,0.2,0.2}{{\underbrace{\color[rgb]{0,0,0}{\Bigg{[}\sum_{i=1}^{t}\alpha^{i}%
\lambda\Big{[}{\color[rgb]{0,0.5,0}{\underbrace{\color[rgb]{0,0,0}S\hat{%
\mathbf{x}}\hat{\mathbf{x}}^{\top}-\mathbf{x}\hat{\mathbf{x}}^{\top}+S\hat{%
\mathbf{x}}\hat{\mathbf{x}}^{\top}-T\hat{\mathbf{x}}\hat{\mathbf{x}}^{\top}}_{%
\nabla_{S}\mathcal{L}_{\text{r}}+\nabla_{S}\mathcal{L}_{\text{c}}\text{ from }%
\hat{\mathbf{x}}}}}\Big{]}^{(t-i)}\Bigg{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}%
^{\top}}}_{\nabla_{S}\mathcal{L}_{\text{c}}}}}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}\color[rgb]{0,0,0}{-}\color[rgb]{%
0.8,0.2,0.2}{{\underbrace{\color[rgb]{0,0,0}{\Bigg{[}\sum_{i=1}^{t}\alpha^{i}%
\lambda\Big{[}{\color[rgb]{0,0.5,0}{\underbrace{\color[rgb]{0,0,0}S\hat{%
\mathbf{x}}\hat{\mathbf{x}}^{\top}-\mathbf{x}\hat{\mathbf{x}}^{\top}+S\hat{%
\mathbf{x}}\hat{\mathbf{x}}^{\top}-T\hat{\mathbf{x}}\hat{\mathbf{x}}^{\top}}_{%
\nabla_{S}\mathcal{L}_{\text{r}}+\nabla_{S}\mathcal{L}_{\text{c}}\text{ from }%
\hat{\mathbf{x}}}}}\Big{]}^{(t-i)}\Bigg{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}%
^{\top}}}_{\nabla_{S}\mathcal{L}_{\text{c}}}}}
\nabla_{S}\mathcal{L}_{\text{c}}
\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=\hat{\mathbf{x}}^{\top}\tilde{%
\mathbf{x}}/\|\hat{\mathbf{x}}\|\|\tilde{\mathbf{x}}\|
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\hat{\mathbf{x}}
t
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\in\{-1,0,1,(0,1),(-1,0)\}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\in\{-1,1\}
|1|
\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=0
|\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})|\in(0,1)
\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}
\big{\|}\nabla_{S}\mathcal{L}_{\text{c}}\big{\|}=\Big{\|}\sum_{i=1}^{t}\alpha^%
{i}\lambda\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}\Big{\|}\leq\sum_{i=1}^{t}\alpha^{i}\lambda\Big{\|}\nabla_{S%
^{(t-i)}}[\dots\hat{\mathbf{x}}^{\top}]\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{%
\top}\Big{\|}
\alpha^{i}\in(0,1)
\alpha
(\tilde{\mathbf{x}},\tilde{\mathbf{x}})
(\tilde{\mathbf{x}},\tilde{\mathbf{x}}^{\prime})
(\tilde{\mathbf{x}},\hat{\mathbf{x}})
\mathbf{x}\in\mathbb{R}^{32}
\|\nabla_{S}\mathcal{L}_{\text{c}}\|_{2}
\|\nabla_{S}\mathcal{L}_{\text{c}}\|_{2}
\|\nabla_{S}\mathcal{L}_{\text{r}}\|_{2}
\|\nabla_{S}\mathcal{L}_{\text{r}}\|_{2}
\text{CosSim}(\nabla_{S}\mathcal{L}_{\text{}}^{(t)},\nabla_{S}\mathcal{L}_{%
\text{c}}^{(t+1)})
\text{CosSim}(\nabla_{S}\mathcal{L}_{\text{}}^{(t)},\nabla_{S}\mathcal{L}_{%
\text{c}}^{(t+1)})
\nabla_{S}\mathcal{L}_{\text{r}}
\nabla_{S}\mathcal{L}_{\text{c}}
\|\nabla_{S}\mathcal{L}_{\text{c}}\|_{2}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\|\nabla_{S}\mathcal{L}_{\text{r}}\|_{2}
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=1
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\approx 0
\nabla_{S}\mathcal{L}_{\text{r}}
\nabla_{S}\mathcal{L}_{\text{c}}
\|\nabla_{S}\mathcal{L}_{\text{c}}\|_{2}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\|\nabla_{S}\mathcal{L}_{\text{r}}\|_{2}
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=1
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\approx 0
\|\nabla\mathcal{L}_{\text{c}}\|_{F}
\|\nabla\mathcal{L}_{\text{c}}\|_{F}
\|\nabla\mathcal{L}_{\text{r}}\|_{F}
\|\nabla\mathcal{L}_{\text{r}}\|_{F}
\text{CosSim}(\nabla_{S}\mathcal{L}_{\text{}}^{(t)},\nabla_{S}\mathcal{L}_{%
\text{c}}^{(t+1)})
\text{CosSim}(\nabla_{S}\mathcal{L}_{\text{}}^{(t)},\nabla_{S}\mathcal{L}_{%
\text{c}}^{(t+1)})
\nabla_{S}\mathcal{L}_{\text{r}}
\nabla_{S}\mathcal{L}_{\text{c}}
\|\nabla_{S}\mathcal{L}_{\text{c}}\|_{F}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=1
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\approx 0
\nabla_{S}\mathcal{L}_{\text{r}}
\nabla_{S}\mathcal{L}_{\text{c}}
\|\nabla_{S}\mathcal{L}_{\text{c}}\|_{F}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\nabla_{S}\mathcal{L}_{\text{c}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=1
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\approx 0
\tilde{\mathbf{x}}
\hat{\mathbf{x}}
f_{\theta_{t}}
h_{\theta_{t}}
t
\theta_{t}
\theta_{s}
\mathcal{M}
\frac{1}{|\mathcal{M}|}\sum_{i\in\mathcal{M}}\color[rgb]{0,0,0}{(\color[rgb]{%
0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{||\tilde{X}_{i}-\hat{Y}_{i}||^{%
2}}}_{\text{reconstruction}}}}\color[rgb]{0,0,0}{+}\color[rgb]{0.8,0.2,0.2}{%
\underbrace{\color[rgb]{0,0,0}{||\hat{Y}_{i}-\hat{Y}^{\prime}_{i}||^{2}}}_{%
\text{consistency}}}\color[rgb]{0,0,0}{)}},
i
\hat{Y},\hat{Y}^{\prime}
\mathcal{M}_{s}
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{c}}
\text{cos}(\nabla\mathcal{L}_{\text{r}},\nabla\mathcal{L}_{\text{c}})
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{c}}
\text{cos}(\nabla\mathcal{L}_{\text{r}},\nabla\mathcal{L}_{\text{c}})
224\times 224
224\times 224
\downarrow
\uparrow
\uparrow
\uparrow
S
T
(t)
\tilde{\mathbf{x}}
\mathbf{x}
\text{StopGrad}(.)
\lambda
\tilde{\mathbf{x}}
\mathbf{x}
N
\sum_{i=0}^{N}\alpha^{i}(1-\alpha)\approx 1
\displaystyle\nabla_{S}\mathcal{L}(S,T,\tilde{\mathbf{x}},\mathbf{x})=\nabla_{%
S}\mathcal{L}_{r}(S,\tilde{\mathbf{x}},\mathbf{x})+\nabla_{S}\mathcal{L}_{c}(S%
,T,\tilde{\mathbf{x}},\mathbf{x})
\displaystyle\nabla_{S}\mathcal{L}(S,T,\tilde{\mathbf{x}},\mathbf{x})
\displaystyle=\nabla_{S}\mathcal{L}_{r}(S,\tilde{\mathbf{x}},\mathbf{x})+%
\nabla_{S}\mathcal{L}_{c}(S,T,\tilde{\mathbf{x}},\mathbf{x})
\displaystyle=\nabla_{S}\frac{1}{2}\big{\|}S\tilde{\mathbf{x}}-\mathbf{x}\big{%
\|}^{2}_{2}+\nabla_{S}\frac{1}{2}\big{\|}S\tilde{\mathbf{x}}-\text{StopGrad}(T%
\tilde{\mathbf{x}})\big{\|}^{2}_{2}
\displaystyle=\nabla_{S}\frac{1}{2}\big{\|}S\tilde{\mathbf{x}}-\mathbf{x}\big{%
\|}^{2}_{2}+\nabla_{S}\frac{1}{2}\big{\|}S\tilde{\mathbf{x}}-\text{StopGrad}(T%
\tilde{\mathbf{x}})\big{\|}^{2}_{2}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}+\color[rgb]{0.8,0.2,0.2}{\underbrace{%
\color[rgb]{0,0,0}{(S-T)\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}}}_{\nabla_%
{S}\mathcal{L}_{\text{c}}}}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}+\color[rgb]{0.8,0.2,0.2}{\underbrace{%
\color[rgb]{0,0,0}{(S-T)\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}}}_{\nabla_%
{S}\mathcal{L}_{\text{c}}}}
p(\mathbf{x},\tilde{\mathbf{x}})
\displaystyle 0=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}
\displaystyle 0
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}
\displaystyle\mathbf{x}\tilde{\mathbf{x}}^{\top}=S\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}
\displaystyle\mathbf{x}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[\mathbf{x}\tilde{%
\mathbf{x}}^{\top}]=\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[S\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}]
\displaystyle\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[\mathbf{x}\tilde{%
\mathbf{x}}^{\top}]
\displaystyle=\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[S\tilde{\mathbf{x}%
}\tilde{\mathbf{x}}^{\top}]
\displaystyle\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[\mathbf{x}\tilde{%
\mathbf{x}}^{\top}]=S\iint_{\mathbf{x},\tilde{\mathbf{x}}}p(\mathbf{x},\tilde{%
\mathbf{x}})\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}d\mathbf{x}d\tilde{%
\mathbf{x}}
\displaystyle\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[\mathbf{x}\tilde{%
\mathbf{x}}^{\top}]
\displaystyle=S\iint_{\mathbf{x},\tilde{\mathbf{x}}}p(\mathbf{x},\tilde{%
\mathbf{x}})\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}d\mathbf{x}d\tilde{%
\mathbf{x}}
\displaystyle\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[\mathbf{x}\tilde{%
\mathbf{x}}^{\top}]=S\mathbb{E}_{p(\tilde{\mathbf{x}})}[\tilde{\mathbf{x}}%
\tilde{\mathbf{x}}^{\top}]
\displaystyle\mathbb{E}_{p(\mathbf{x},\tilde{\mathbf{x}})}[\mathbf{x}\tilde{%
\mathbf{x}}^{\top}]
\displaystyle=S\mathbb{E}_{p(\tilde{\mathbf{x}})}[\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}]
\displaystyle\Sigma_{\mathbf{x},\tilde{\mathbf{x}}}=S\Sigma_{\tilde{\mathbf{x}%
},\tilde{\mathbf{x}}}
\displaystyle\Sigma_{\mathbf{x},\tilde{\mathbf{x}}}
\displaystyle=S\Sigma_{\tilde{\mathbf{x}},\tilde{\mathbf{x}}}
S
\Sigma_{\tilde{\mathbf{x}},\tilde{\mathbf{x}}}
\Sigma_{\mathbf{x},\tilde{\mathbf{x}}}
\displaystyle\begin{bmatrix}\Sigma_{\mathbf{x},\mathbf{x}}&\Sigma_{\mathbf{x},%
\tilde{\mathbf{x}}}\\
\Sigma_{\tilde{\mathbf{x}},\mathbf{x}}&\Sigma_{\tilde{\mathbf{x}},\tilde{%
\mathbf{x}}}\\
\end{bmatrix}
\displaystyle\begin{bmatrix}\Sigma_{\mathbf{x},\mathbf{x}}&\Sigma_{\mathbf{x},%
\tilde{\mathbf{x}}}\\
\Sigma_{\tilde{\mathbf{x}},\mathbf{x}}&\Sigma_{\tilde{\mathbf{x}},\tilde{%
\mathbf{x}}}\\
\end{bmatrix}
\displaystyle\nabla_{S}\mathcal{L}=\nabla_{S}\mathcal{L}_{r}+\nabla_{S}%
\mathcal{L}_{c}
\displaystyle\nabla_{S}\mathcal{L}
\displaystyle=\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}
\displaystyle=\nabla_{S}\frac{1}{2}\|S\tilde{\mathbf{x}}-\mathbf{x}\|^{2}_{2}+%
\nabla_{S}\frac{1}{2}\|S\tilde{\mathbf{x}}-\text{StopGrad}(T\tilde{\mathbf{x}}%
)\|^{2}_{2}
\displaystyle=\nabla_{S}\frac{1}{2}\|S\tilde{\mathbf{x}}-\mathbf{x}\|^{2}_{2}+%
\nabla_{S}\frac{1}{2}\|S\tilde{\mathbf{x}}-\text{StopGrad}(T\tilde{\mathbf{x}}%
)\|^{2}_{2}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}+S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-T\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}+S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-T\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Big{[}(1-\alpha)S+\alpha(1-\alpha)S^{(t-1)}+\dots+\alpha^{%
t}(1-\alpha)S^{(t-t)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Big{[}(1-\alpha)S+\alpha(1-\alpha)S^{(t-1)}+\dots+\alpha^{%
t}(1-\alpha)S^{(t-t)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Big{[}(1-\alpha)S+\sum_{i=1}^{t}\alpha^{i}(1-\alpha)S^{(t-%
i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Big{[}(1-\alpha)S+\sum_{i=1}^{t}\alpha^{i}(1-\alpha)S^{(t-%
i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Big{[}(1-\alpha)S+\sum_{i=1}^{t}\alpha^{i}(1-\alpha)\Big{[%
}S+\Big{[}\lambda\sum_{j=t-i}^{t-1}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}%
\Big{]}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Big{[}(1-\alpha)S+\sum_{i=1}^{t}\alpha^{i}(1-\alpha)\Big{[%
}S+\Big{[}\lambda\sum_{j=t-i}^{t-1}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}%
\Big{]}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\Big{[}\sum_{i%
=1}^{t}\alpha^{i}(1-\alpha)\Big{[}\lambda\sum_{j=t-i}^{t-1}\nabla_{S^{(j)}}%
\mathcal{L}^{(j)}\Big{]}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=2S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\Big{[}\sum_{i%
=1}^{t}\alpha^{i}(1-\alpha)\Big{[}\lambda\sum_{j=t-i}^{t-1}\nabla_{S^{(j)}}%
\mathcal{L}^{(j)}\Big{]}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}-\color[rgb]{0.8,0.2,0.2}{{\underbrace%
{\color[rgb]{0,0,0}{\Big{[}\sum_{i=1}^{t}\alpha^{i}(1-\alpha)\Big{[}\lambda%
\sum_{j=t-i}^{t-1}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\Big{]}\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}}}_{\nabla_{S}\mathcal{L}_{\text{c}}}}}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}-\color[rgb]{0.8,0.2,0.2}{{\underbrace%
{\color[rgb]{0,0,0}{\Big{[}\sum_{i=1}^{t}\alpha^{i}(1-\alpha)\Big{[}\lambda%
\sum_{j=t-i}^{t-1}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\Big{]}\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}}}_{\nabla_{S}\mathcal{L}_{\text{c}}}}}
S^{(t-1)}
S
S^{(t-1)}-\lambda\nabla_{S^{(t-1)}}\mathcal{L}^{(t-1)}=S
S^{(t-1)}
S^{(0)}
\displaystyle\nabla_{S}\mathcal{L}=\nabla_{S}\mathcal{L}_{r}+\nabla_{S}%
\mathcal{L}_{c}
\displaystyle\nabla_{S}\mathcal{L}
\displaystyle=\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{i=1}^{t}\alpha^{i}(1-\alpha)\Big{[}\sum%
_{j=t-i}^{t-1}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\Big{]}\tilde{\mathbf{x}%
}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{i=1}^{t}\alpha^{i}(1-\alpha)\Big{[}\sum%
_{j=t-i}^{t-1}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\Big{]}\tilde{\mathbf{x}%
}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{i=1}^{t}\sum_{j=t-i}^{t-1}\alpha^{i}(1-%
\alpha)\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{i=1}^{t}\sum_{j=t-i}^{t-1}\alpha^{i}(1-%
\alpha)\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{j=0}^{t-1}\sum_{i=0}^{j}\alpha^{t-i}(1-%
\alpha)\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{j=0}^{t-1}\sum_{i=0}^{j}\alpha^{t-i}(1-%
\alpha)\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{j=0}^{t-1}\Big{[}1-\sum_{i=j}^{t-1}%
\alpha^{t-1-i}(1-\alpha)\Big{]}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{j=0}^{t-1}\Big{[}1-\sum_{i=j}^{t-1}%
\alpha^{t-1-i}(1-\alpha)\Big{]}\nabla_{S^{(j)}}\mathcal{L}^{(j)}\Big{]}\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{j=0}^{t-1}\alpha^{(t-j)}\nabla_{S^{(j)}%
}\mathcal{L}^{(j)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{j=0}^{t-1}\alpha^{(t-j)}\nabla_{S^{(j)}%
}\mathcal{L}^{(j)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}-\color[rgb]{0.8,0.2,0.2}{{\underbrace%
{\color[rgb]{0,0,0}{\lambda\Big{[}\sum_{i=1}^{t}\alpha^{i}\nabla_{S^{(t-i)}}%
\mathcal{L}^{(t-i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}}}_{%
\nabla_{S}\mathcal{L}_{\text{c}}}}}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}-\color[rgb]{0.8,0.2,0.2}{{\underbrace%
{\color[rgb]{0,0,0}{\lambda\Big{[}\sum_{i=1}^{t}\alpha^{i}\nabla_{S^{(t-i)}}%
\mathcal{L}^{(t-i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}}}_{%
\nabla_{S}\mathcal{L}_{\text{c}}}}}
\displaystyle\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}=S\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top}-%
\lambda\Big{[}\sum_{i=1}^{t}\alpha^{i}\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}%
\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\lambda\Big{[}\sum_{i=1}^{t}\alpha^{i}\nabla_{S^{(t-i)}}%
\mathcal{L}^{(t-i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}-\color[rgb]{0.8,0.2,0.2}{{\underbrace%
{\color[rgb]{0,0,0}{\lambda\Bigg{[}\sum_{i=1}^{t}\alpha^{i}\Big{[}S\hat{%
\mathbf{x}}\hat{\mathbf{x}}^{\top}-\mathbf{x}\hat{\mathbf{x}}^{\top}+(S-T)\hat%
{\mathbf{x}}\hat{\mathbf{x}}^{\top}\Big{]}^{(t-i)}\Bigg{]}\tilde{\mathbf{x}}%
\tilde{\mathbf{x}}^{\top}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}
\displaystyle=\color[rgb]{0.0,0.28,0.67}{{\underbrace{\color[rgb]{0,0,0}{S%
\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top%
}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}-\color[rgb]{0.8,0.2,0.2}{{\underbrace%
{\color[rgb]{0,0,0}{\lambda\Bigg{[}\sum_{i=1}^{t}\alpha^{i}\Big{[}S\hat{%
\mathbf{x}}\hat{\mathbf{x}}^{\top}-\mathbf{x}\hat{\mathbf{x}}^{\top}+(S-T)\hat%
{\mathbf{x}}\hat{\mathbf{x}}^{\top}\Big{]}^{(t-i)}\Bigg{]}\tilde{\mathbf{x}}%
\tilde{\mathbf{x}}^{\top}}}_{\nabla_{S}\mathcal{L}_{\text{r}}}}}
\hat{\mathbf{x}}
\hat{\mathbf{x}}\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\mathbf{x}\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=\hat{\mathbf{x}}^{\top}\tilde{%
\mathbf{x}}/\|\hat{\mathbf{x}}\|\|\tilde{\mathbf{x}}\|
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\in\{-1,0,1,(0,1),(-1,0)\}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})\in\{-1,1\}
|1|
\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}
\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})=0
\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}=0
|\text{cos}(\hat{\mathbf{x}},\tilde{\mathbf{x}})|\in(0,1)
\zeta=\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}
\displaystyle\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}=S\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top}-\Bigg%
{[}\sum_{i=1}^{t}\alpha^{i}\zeta_{i}\lambda\Big{[}S\hat{\mathbf{x}}-\mathbf{x}%
+(S-T)\hat{\mathbf{x}}\Big{]}^{(t-i)}\Bigg{]}\tilde{\mathbf{x}}^{\top}
\displaystyle\nabla_{S}\mathcal{L}_{r}+\nabla_{S}\mathcal{L}_{c}
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}-\Bigg{[}\sum_{i=1}^{t}\alpha^{i}\zeta_{i}\lambda\Big{[}S%
\hat{\mathbf{x}}-\mathbf{x}+(S-T)\hat{\mathbf{x}}\Big{]}^{(t-i)}\Bigg{]}\tilde%
{\mathbf{x}}^{\top}
\frac{\partial\mathcal{L}}{\partial\Theta}=(\Theta\tilde{\mathbf{x}}-\mathbf{x%
})\tilde{\mathbf{x}}^{\top}
(\Theta\tilde{\mathbf{x}}-\mathbf{x})
\Theta
\tilde{\mathbf{x}}^{\top}
S
\hat{\mathbf{x}}^{\top}\tilde{\mathbf{x}}
\tilde{\mathbf{x}}^{\top}
\displaystyle\nabla_{S}\mathcal{L}_{c}=-\Big{[}\sum_{i=1}^{t}\alpha^{i}\lambda%
\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x%
}}^{\top}
\displaystyle\nabla_{S}\mathcal{L}_{c}
\displaystyle=-\Big{[}\sum_{i=1}^{t}\alpha^{i}\lambda\nabla_{S^{(t-i)}}%
\mathcal{L}^{(t-i)}\Big{]}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}
\displaystyle\|\nabla_{S}\mathcal{L}_{c}\|=\Big{\|}\big{[}\sum_{i=1}^{t}\alpha%
^{i}\lambda\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}\big{]}\tilde{\mathbf{x}}%
\tilde{\mathbf{x}}^{\top}\Big{\|}\leq\sum_{i=1}^{t}\alpha^{i}\lambda\Big{\|}%
\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{%
\top}\Big{\|}
\displaystyle\|\nabla_{S}\mathcal{L}_{c}\|=\Big{\|}\big{[}\sum_{i=1}^{t}\alpha%
^{i}\lambda\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}\big{]}\tilde{\mathbf{x}}%
\tilde{\mathbf{x}}^{\top}\Big{\|}\leq\sum_{i=1}^{t}\alpha^{i}\lambda\Big{\|}%
\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)}\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{%
\top}\Big{\|}
\alpha
i=1
\hat{\mathbf{x}}^{(t-1)}
\displaystyle G(\mathcal{L}_{r})=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-%
\mathbf{x}\tilde{\mathbf{x}}^{\top}
\displaystyle G(\mathcal{L}_{r})
\displaystyle=S\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{%
\mathbf{x}}^{\top}
\displaystyle=(S^{(t-1)}-\lambda\nabla_{S^{(t-1)}}\mathcal{L}^{(t-1)})\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top}
\displaystyle=(S^{(t-1)}-\lambda\nabla_{S^{(t-1)}}\mathcal{L}^{(t-1)})\tilde{%
\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top}
\displaystyle=(S^{(0)}-\lambda\sum_{i=1}^{t}\nabla_{S^{(t-i)}}\mathcal{L}^{(t-%
i)})\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top}
\displaystyle=(S^{(0)}-\lambda\sum_{i=1}^{t}\nabla_{S^{(t-i)}}\mathcal{L}^{(t-%
i)})\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}-\mathbf{x}\tilde{\mathbf{x}}^{\top}
\displaystyle\Big{\|}\sum_{i=1}^{t}(\lambda\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i%
)})\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}\Big{\|}\leq\sum_{i=1}^{t}%
\lambda\Big{\|}\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)})\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}\Big{\|}
\displaystyle\Big{\|}\sum_{i=1}^{t}(\lambda\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i%
)})\tilde{\mathbf{x}}\tilde{\mathbf{x}}^{\top}\Big{\|}\leq\sum_{i=1}^{t}%
\lambda\Big{\|}\nabla_{S^{(t-i)}}\mathcal{L}^{(t-i)})\tilde{\mathbf{x}}\tilde{%
\mathbf{x}}^{\top}\Big{\|}
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{c}}
\tilde{\mathbf{x}}
\hat{\mathbf{x}}
S\tilde{\mathbf{x}}
T\hat{\mathbf{x}}
B\sigma(A\tilde{\mathbf{x}})
\sigma
\mathcal{L}_{\text{c}}=\frac{1}{2}\|B\sigma(A\tilde{\mathbf{x}})-D\sigma(C%
\tilde{\mathbf{x}})\|^{2}_{2}
\{C,D\}
\displaystyle D\sigma(C\tilde{\mathbf{x}})=D\sigma\Big{(}\big{[}(1-\alpha)A+%
\alpha C^{(t-1)}\big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle D\sigma(C\tilde{\mathbf{x}})
\displaystyle=D\sigma\Big{(}\big{[}(1-\alpha)A+\alpha C^{(t-1)}\big{]}\tilde{%
\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\big{[}(1-\alpha)A+\sum_{i=1}^{t}\alpha^{i}(1-%
\alpha)A^{(t-i)}\big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\big{[}(1-\alpha)A+\sum_{i=1}^{t}\alpha^{i}(1-%
\alpha)A^{(t-i)}\big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\Big{[}(1-\alpha)A+\sum_{i=1}^{t}\big{[}\alpha^{i}%
(1-\alpha)\big{(}A+\lambda\sum_{j=t-i}^{t-1}\nabla_{A^{(i)}}\mathcal{L}^{(j)}%
\big{)}\big{]}\Big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\Big{[}(1-\alpha)A+\sum_{i=1}^{t}\big{[}\alpha^{i}%
(1-\alpha)\big{(}A+\lambda\sum_{j=t-i}^{t-1}\nabla_{A^{(i)}}\mathcal{L}^{(j)}%
\big{)}\big{]}\Big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\Big{[}A+\sum_{i=1}^{t}\big{[}\alpha^{i}(1-\alpha)%
\big{(}\lambda\sum_{j=t-i}^{t-1}\nabla_{A^{(j)}}\mathcal{L}^{(j)}\big{)}\big{]%
}\Big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\Big{[}A+\sum_{i=1}^{t}\big{[}\alpha^{i}(1-\alpha)%
\big{(}\lambda\sum_{j=t-i}^{t-1}\nabla_{A^{(j)}}\mathcal{L}^{(j)}\big{)}\big{]%
}\Big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\big{[}A+\sum_{i=1}^{t}\alpha^{i}\lambda\nabla_{A^%
{t-i}}\mathcal{L}^{(t-i)}\big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\big{[}A+\sum_{i=1}^{t}\alpha^{i}\lambda\nabla_{A^%
{t-i}}\mathcal{L}^{(t-i)}\big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\big{[}A+\sum_{i=1}^{t}\alpha^{i}\lambda[\dots\hat%
{\mathbf{x}}^{\top}]^{(t-i)}\big{]}\tilde{\mathbf{x}}\Big{)}
\displaystyle=D\sigma\Big{(}\big{[}A+\sum_{i=1}^{t}\alpha^{i}\lambda[\dots\hat%
{\mathbf{x}}^{\top}]^{(t-i)}\big{]}\tilde{\mathbf{x}}\Big{)}
[\dots\hat{\mathbf{x}}^{\top}]
\hat{\mathbf{x}}^{\top}
\hat{\mathbf{x}}
\displaystyle\frac{\partial\mathcal{L}}{\partial A}=\frac{\partial\mathcal{L}}%
{dB\sigma(A\tilde{\mathbf{x}})}\frac{\partial B\sigma(A\tilde{\mathbf{x}})}{%
\partial\sigma(A\tilde{\mathbf{x}})}\frac{\partial\sigma(A\tilde{\mathbf{x}})}%
{\partial A\tilde{\mathbf{x}}}\frac{\partial A\tilde{\mathbf{x}}}{\partial A}
\displaystyle\frac{\partial\mathcal{L}}{\partial A}
\displaystyle=\frac{\partial\mathcal{L}}{dB\sigma(A\tilde{\mathbf{x}})}\frac{%
\partial B\sigma(A\tilde{\mathbf{x}})}{\partial\sigma(A\tilde{\mathbf{x}})}%
\frac{\partial\sigma(A\tilde{\mathbf{x}})}{\partial A\tilde{\mathbf{x}}}\frac{%
\partial A\tilde{\mathbf{x}}}{\partial A}
\displaystyle=\big{[}(B\sigma(A\tilde{\mathbf{x}})-D\sigma(C\tilde{\mathbf{x}}%
))^{\top}B\;\text{diag}(\sigma^{\prime}(A\tilde{\mathbf{x}}))\big{]}^{\top}%
\tilde{\mathbf{x}}^{\top}
\displaystyle=\big{[}(B\sigma(A\tilde{\mathbf{x}})-D\sigma(C\tilde{\mathbf{x}}%
))^{\top}B\;\text{diag}(\sigma^{\prime}(A\tilde{\mathbf{x}}))\big{]}^{\top}%
\tilde{\mathbf{x}}^{\top}
\displaystyle=\Big{[}\Big{(}B\sigma(A\tilde{\mathbf{x}})-D\sigma\big{(}\big{[}%
A+\sum_{i=1}^{t}\alpha^{i}\lambda[\dots\hat{\mathbf{x}}^{\top}]^{(t-i)}\big{]}%
\tilde{\mathbf{x}}\big{)}\Big{)}^{\top}B\;\text{diag}(\sigma^{\prime}(A\tilde{%
\mathbf{x}}))\Big{]}^{\top}\tilde{\mathbf{x}}^{\top}
\displaystyle=\Big{[}\Big{(}B\sigma(A\tilde{\mathbf{x}})-D\sigma\big{(}\big{[}%
A+\sum_{i=1}^{t}\alpha^{i}\lambda[\dots\hat{\mathbf{x}}^{\top}]^{(t-i)}\big{]}%
\tilde{\mathbf{x}}\big{)}\Big{)}^{\top}B\;\text{diag}(\sigma^{\prime}(A\tilde{%
\mathbf{x}}))\Big{]}^{\top}\tilde{\mathbf{x}}^{\top}
\bm{\mu}_{i}\sim U(-3,3)
\bm{\mu}_{i}\in\mathbb{R}^{32}
\Sigma_{i}\sim\text{Wishart}(V_{i})
\times
V_{i}
U(.25,.35)
S,\;T\in\mathbb{R}^{32\times 32}
\mathcal{L}_{\text{r}}
\mathcal{L}_{\text{c}}
\alpha
\times\leavevmode\nobreak\ 8
\leavevmode\nobreak\ \times\leavevmode\nobreak\ 2
\times\leavevmode\nobreak\ 8
\leavevmode\nobreak\ \times\leavevmode\nobreak\ 1
lr=base\_lr\times batch\_size/256
\beta_{1},\beta_{2}=0.9,0.95
\beta_{1},\beta_{2}=0.9,0.999
\times\leavevmode\nobreak\ 8
\times\leavevmode\nobreak\ 2
4\times
2\times
