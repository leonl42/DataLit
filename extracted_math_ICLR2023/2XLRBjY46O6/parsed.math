f_{t}
f_{s}
f_{t}
f_{s}
f_{t}
f_{s}
f_{t}
f_{s}
\{(x_{i}^{I},x_{i}^{T})\}_{i=1}^{B}
x_{i}^{I}
u
v
K
u
Z^{u_{s}}_{\text{Seg}}=\{Z_{\text{seg}_{k}}^{u_{s}},k=1,...,K\}=f_{s}(u)\in%
\mathbb{R}^{K\times d},
Z_{\text{seg}_{k}}^{u_{s}}\in\mathbb{R}^{d}
k
f_{s}
d
Z_{\text{seg}_{k}}^{v_{s}}
Z_{\text{seg}_{k}}^{u_{t}}
Z_{\text{seg}_{k}}^{v_{t}}
f_{t}
f_{t}
f_{s}
\theta_{i}
\overline{\theta}_{i}
f_{s}
f_{t}
i
\overline{\theta}_{i}
\overline{\theta}_{i}=\alpha\overline{\theta}_{i-1}+(1-\alpha)\theta_{i}
\alpha
q
k=\{k_{0},k_{1},k_{2},...\}^{N}
\mathcal{L}_{\textit{NCE}}(q,k)=-\log\frac{\text{exp}(q\cdot k_{+}/\tau)}{\sum%
_{i=0}^{N}\text{exp}(q\cdot k_{i}/\tau)},
\tau
q
k_{+}
(N-1)
\mathcal{L}^{t\leftrightarrow s}_{[\text{Seg}]}=\mathcal{L}^{t\rightarrow s}_{%
[\text{Seg}]}+\mathcal{L}^{s\rightarrow t}_{[\text{Seg}]}.
f_{t}
f_{s}
\mathcal{L}^{t\rightarrow s}_{[\text{Seg}]}
(u_{t},v_{s})
(v_{t},u_{s})
f_{t}
f_{s}
(u_{t},v_{s})
Z^{u_{t}}_{\text{seg}}\cdot{Z^{v_{s}}_{\text{seg}}}^{T}\in\mathbb{R}^{K\times K}
l_{2}
\{(Z^{u_{t}}_{\text{seg}_{i}},Z^{v_{s}}_{\text{seg}_{i}}),i=1,...,K\}
K(K-1)
\{(Z^{u_{t}}_{\text{seg}_{i}},Z^{v_{s}}_{\text{seg}_{j}}),i,j=1,...,K,i\neq j\}
\mathcal{L}^{t\rightarrow s}_{[\text{Seg}]}
\mathcal{L}^{t\rightarrow s}_{[\text{Seg}]}=\mathcal{L}_{u_{t}\rightarrow v_{s%
}}+\mathcal{L}_{v_{t}\rightarrow u_{s}}
\mathcal{L}^{t\rightarrow s}_{[\text{Seg}]}=-\frac{1}{KB}\sum_{i=1}^{B}\sum_{k%
=1}^{K}(\mathcal{L}_{\textit{NCE}}(Z^{u_{t}}_{\text{seg}_{k}},\{Z^{v_{s}}_{%
\text{seg}_{k}}\}_{k=1}^{K})+\mathcal{L}_{\textit{NCE}}(Z^{v_{t}}_{\text{seg}_%
{k}},\{Z^{u_{s}}_{\text{seg}_{k}}\}_{k=1}^{K})).
\mathcal{L}^{s\rightarrow t}_{[\text{Seg}]}
\mathcal{L}^{s\rightarrow t}_{[\text{Seg}]}=\mathcal{L}_{u_{s}\rightarrow v_{t%
}}+\mathcal{L}_{v_{s}\rightarrow u_{t}}
\mathcal{L}^{s\rightarrow t}_{[\text{Seg}]}=-\frac{1}{KB}\sum_{i=1}^{B}\sum_{k%
=1}^{K}(\mathcal{L}_{\textit{NCE}}(Z^{u_{s}}_{\text{seg}_{k}},\{Z^{v_{t}}_{%
\text{seg}_{k}}\}_{k=1}^{K})+\mathcal{L}_{\textit{NCE}}(Z^{v_{s}}_{\text{seg}_%
{k}},\{Z^{u_{t}}_{\text{seg}_{k}}\}_{k=1}^{K})).
\mathcal{L}_{[\text{Seg}]}
\mathcal{L}_{[\text{Seg}]}
\mathcal{L}_{[\text{Text-Views}]}
\mathcal{L}_{[\text{Text-Views}]}
Z^{I_{i}}_{\text{Seg}_{k}}
k
i
u
v
Z_{i}^{I_{v}}
Z_{i}^{I_{u}}
v
u
i
Z^{I_{i}}_{\text{Seg}_{k}}
k
i
u
v
Z_{i}^{I_{v}}
Z_{i}^{I_{u}}
v
u
i
(x_{i}^{I},x_{i}^{T})
(u_{i},v_{i},x_{i}^{T})
(Z_{i}^{u},Z_{i}^{v})
(u_{i},v_{i})
f_{s}
Z_{i}^{T}
E_{T}
(Z_{i}^{u},Z_{i}^{v})
Z_{i}^{T}
l_{2}
Z_{i}^{I_{u}}=\text{MLP}({\text{AvgPool}({Z^{u_{i}}_{[\text{Seg}]}})}),Z^{u_{i%
}}_{[\text{Seg}]}=f_{s}(u_{i});Z_{i}^{I_{v}}=\text{MLP}({\text{AvgPool}({Z^{v_%
{i}}_{[\text{Seg}]}})}),Z^{v_{i}}_{[\text{Seg}]}=f_{s}(v_{i}).
Z_{i}^{I}=\{Z_{i}^{I_{u}},Z_{i}^{I_{v}}\}
Z^{T}_{i}
2B(B-1)
\mathcal{L}_{I_{\{u,v\}}\leftrightarrow T}=\mathcal{L}_{I_{\{u,v\}}\rightarrow
T%
}+\mathcal{L}_{T\rightarrow I_{\{u,v\}}},
I_{\{u,v\}}
\mathcal{L}_{I_{\{u,v\}}\rightarrow T}=-\frac{1}{KB}\sum_{i=1}^{B}\sum_{k=1}^{%
K}(\mathcal{L}_{\textit{NCE}}(Z_{i}^{I_{u}},\{Z_{i}^{T}\}_{i=1}^{B})+\mathcal{%
L}_{\textit{NCE}}(Z_{i}^{I_{v}},\{Z_{i}^{T}\}_{i=1}^{B})).
I_{\{u,v\}}
\mathcal{L}_{T\rightarrow I_{\{u,v\}}}=-\frac{1}{KB}\sum_{i=1}^{B}\sum_{k=1}^{%
K}(\mathcal{L}_{\textit{NCE}}(Z_{i}^{T},\{Z_{i}^{I_{u}}\}_{i=1}^{B})+\mathcal{%
L}_{\textit{NCE}}(Z_{i}^{T},\{Z_{i}^{I_{v}}\}_{i=1}^{B})).
\{(Z_{i}^{I_{u}},\{Z_{i}^{t_{m}}\}_{m=1}^{M})_{i=1}^{B},(Z_{i}^{I_{v}},\{Z_{i}%
^{t_{m}}\}_{m=1}^{M})_{i=1}^{B}\}
\{Z_{i}^{t_{m}}\}_{m=1}^{M}
M
\{T_{i}^{m}\}^{M}_{m=1}
i
x_{i}^{T}
(Z_{i}^{I_{u}},\{Z_{i}^{t_{m}}\}_{m=1}^{M})
i
u
M
\{Z_{i}^{t_{m}}\}_{m=1}^{M}
I_{\{u,v\}}
\{T^{m}\}_{m=1}^{M}
\mathcal{L}_{I_{\{u,v\}}\leftrightarrow\{T^{m}\}_{m=1}^{M}}=\mathcal{L}_{I_{\{%
u,v\}}\rightarrow\{T^{m}\}_{m=1}^{M}}+\mathcal{L}_{\{T^{m}\}_{m=1}^{M}%
\rightarrow I_{\{u,v\}}}.
u
u
\mathcal{L}_{I_{u}\rightarrow\{T^{m}\}_{m=1}^{M}}=-\frac{1}{B}\sum_{i=1}^{B}%
\left(\log\frac{\sum_{m=1}^{M}\text{exp}(Z_{i}^{I_{u}}\cdot Z_{i}^{t_{m}}/\tau%
)}{\sum_{m=1}^{M}\sum_{j=1}^{B}\text{exp}(Z_{i}^{I_{u}}\!\cdot\!Z_{j}^{t_{m}}/%
\tau)}\right)\!.
\mathcal{L}_{\{T^{m}\}_{m=1}^{M}\rightarrow I_{\{u,v\}}}\!=\!-\frac{1}{2MB}%
\sum_{m=1}^{M}\sum_{i=1}^{B}(\mathcal{L}_{\textit{NCE}}(Z_{i}^{t_{m}},\{Z_{i}^%
{I_{u}}\}_{i=1}^{B})+\mathcal{L}_{\textit{NCE}}(Z_{i}^{t_{m}},\{Z_{i}^{I_{v}}%
\}_{i=1}^{B})).
\mathcal{L}=\mathcal{L}^{t\leftrightarrow s}_{[\text{Seg}]}+\mathcal{L}_{I_{\{%
u,v\}}\leftrightarrow T}+\mathcal{L}_{I_{\{u,v\}}\leftrightarrow\{T^{m}\}_{m=1%
}^{M}}.
f_{t}
f_{s}
f_{t}
f_{s}
224\times 224
16\times 16
K=8
E_{T}
K
f_{t}
K
53.0
35.9
39.1
20.4
37.6
22.8
34.3
21.3
36.1
23.0
13.5
18.2
12.3
16.8
17.7
\mathbf{45.7}
\mathbf{52.4}
\uparrow
K
\uparrow
\uparrow
x
u
u
v
\uparrow
\uparrow
\uparrow
2.3\uparrow
\times
M
f_{s}
\times
