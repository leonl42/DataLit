{}^{\textbf{\char 78}}
{}^{\textbf{\char 53}}
t=1,2,\dots
\{{\cal S},{\cal A},{\cal P},r,\gamma\}
\mathcal{S}
\mathcal{A}
\mathcal{P}({s_{t+1}},{s_{t}},{a_{t}})=p({s_{t+1}}|{s_{t}},{a_{t}})
{s_{t+1}}
\left({{s_{t}},{a_{t}}}\right)
r\left({{s_{t}},{a_{t}}}\right)
\gamma\in\left({0,1}\right)
p({s_{t+1}}|\{{s_{1}},{a_{1}},{s_{2}},{a_{2}},...,{s_{t}},{a_{t}}\})=p({s_{t+1%
}}|{s_{t}},{a_{t}}).
\pi
a
s
\pi={\cal P}(a|s)
\pi^{*}
\displaystyle J(\pi)=\mathbb{E}\bigg{[}\sum\limits_{t=0}^{\infty}{{\gamma^{t}}%
r({s_{t}},{a_{t}})}\bigg{]}.
\displaystyle J(\pi)=\mathbb{E}\bigg{[}\sum\limits_{t=0}^{\infty}{{\gamma^{t}}%
r({s_{t}},{a_{t}})}\bigg{]}.
\xi\in\Xi
\pi
\beta
{\cal I}\subseteq{\cal S}
\mu(\xi|s)
\pi^{\xi}
a_{t}
\pi^{\xi}
s_{t+1}
\beta^{\xi}(s_{t+1})
\mu(\xi|s_{t+1})
\xi
\displaystyle{\cal R}_{s}^{\xi}=\mathbb{E}\bigg{[}\sum\limits_{i=t}^{t+k-1}{%
\gamma^{i-t}}r^{\xi}({s_{i}},{a_{i}})\bigg{]}.
\displaystyle{\cal R}_{s}^{\xi}=\mathbb{E}\bigg{[}\sum\limits_{i=t}^{t+k-1}{%
\gamma^{i-t}}r^{\xi}({s_{i}},{a_{i}})\bigg{]}.
\xi
s
s^{\prime}
k
\displaystyle{\cal P}_{ss^{\prime}}^{\xi}=\sum\limits_{k=1}^{\infty}{\cal P}^{%
\xi}(s^{\prime},k|s,\xi)\gamma^{k}.
\displaystyle{\cal P}_{ss^{\prime}}^{\xi}=\sum\limits_{k=1}^{\infty}{\cal P}^{%
\xi}(s^{\prime},k|s,\xi)\gamma^{k}.
{\cal P}^{\xi}(s^{\prime},k|s,\xi)
s^{\prime}
k
\xi
s
\mu
\displaystyle{\cal V}^{\mu}(s)=\sum\limits_{\xi\in\Xi}\mu(\xi|s)\bigg{[}{\cal R%
}_{s}^{\xi}+\sum\limits_{s^{\prime}}{\cal P}_{ss^{\prime}}^{\xi}{\cal V}^{\mu}%
(s^{\prime})\bigg{]}
\displaystyle{\cal V}^{\mu}(s)=\sum\limits_{\xi\in\Xi}\mu(\xi|s)\bigg{[}{\cal R%
}_{s}^{\xi}+\sum\limits_{s^{\prime}}{\cal P}_{ss^{\prime}}^{\xi}{\cal V}^{\mu}%
(s^{\prime})\bigg{]}
\displaystyle{\cal Q}^{\mu}(s,\xi)={\cal R}_{s}^{\xi}+\sum\limits_{s^{\prime}}%
{\cal P}_{ss^{\prime}}^{\xi}\sum\limits_{\xi^{\prime}\in{\Xi}}\mu(\xi^{\prime}%
|s^{\prime}){\cal Q}^{\mu}(s^{\prime},\xi^{\prime}).
\displaystyle{\cal Q}^{\mu}(s,\xi)={\cal R}_{s}^{\xi}+\sum\limits_{s^{\prime}}%
{\cal P}_{ss^{\prime}}^{\xi}\sum\limits_{\xi^{\prime}\in{\Xi}}\mu(\xi^{\prime}%
|s^{\prime}){\cal Q}^{\mu}(s^{\prime},\xi^{\prime}).
\displaystyle{\cal V}^{*}(s)=\max\limits_{\xi\in{\Xi}}\bigg{[}{\cal R}_{s}^{%
\xi}+\sum\limits_{s^{\prime}}{\cal P}_{ss^{\prime}}^{\xi}{\cal V}^{*}(s^{%
\prime})\bigg{]}
\displaystyle{\cal V}^{*}(s)=\max\limits_{\xi\in{\Xi}}\bigg{[}{\cal R}_{s}^{%
\xi}+\sum\limits_{s^{\prime}}{\cal P}_{ss^{\prime}}^{\xi}{\cal V}^{*}(s^{%
\prime})\bigg{]}
\displaystyle{\cal Q}^{*}(s,\xi)={\cal R}_{s}^{\xi}+\sum\limits_{s^{\prime}}{%
\cal P}_{ss^{\prime}}^{\xi}\max\limits_{\xi^{\prime}\in{\Xi}}{\cal Q}^{*}(s^{%
\prime},\xi^{\prime}).
\displaystyle{\cal Q}^{*}(s,\xi)={\cal R}_{s}^{\xi}+\sum\limits_{s^{\prime}}{%
\cal P}_{ss^{\prime}}^{\xi}\max\limits_{\xi^{\prime}\in{\Xi}}{\cal Q}^{*}(s^{%
\prime},\xi^{\prime}).
\displaystyle{\cal V}(s)=\max\limits_{\xi\in{\Xi}}\bigg{[}{\cal R}_{s}^{\xi}+%
\sum\limits_{s^{\prime}}{\cal P}_{ss^{\prime}}^{\xi}{\cal V}(s^{\prime},\xi^{%
\prime})\bigg{]}.
\displaystyle{\cal V}(s)=\max\limits_{\xi\in{\Xi}}\bigg{[}{\cal R}_{s}^{\xi}+%
\sum\limits_{s^{\prime}}{\cal P}_{ss^{\prime}}^{\xi}{\cal V}(s^{\prime},\xi^{%
\prime})\bigg{]}.
{\cal Q}_{t}(s,\xi)
\displaystyle{\cal Q}(s,\xi)\leftarrow{\cal Q}(s,\xi)+\alpha\bigg{[}r(s,\xi(s)%
)+\gamma^{k}\max\limits_{\xi^{\prime}\in{\Xi}}{\cal Q}(s^{\prime},\xi^{\prime}%
)-{\cal Q}(s,\xi)\bigg{]},
\displaystyle{\cal Q}(s,\xi)\leftarrow{\cal Q}(s,\xi)+\alpha\bigg{[}r(s,\xi(s)%
)+\gamma^{k}\max\limits_{\xi^{\prime}\in{\Xi}}{\cal Q}(s^{\prime},\xi^{\prime}%
)-{\cal Q}(s,\xi)\bigg{]},
\alpha
k
s
s^{\prime}
r
\xi(s)
r
\xi(s)
\{{\cal S},{\cal A},{\cal P},r,{\Omega},{\cal Z}\}
{\cal S},{\cal A},{\cal P},r
{\Omega}
{\cal Z}
b_{t}
s
\displaystyle b^{\prime}(s^{\prime})\propto{\cal Z}(s^{\prime},a,o)\sum\limits%
_{s\in{\cal S}}{\cal P}(s,a,s^{\prime})b(s).
\displaystyle b^{\prime}(s^{\prime})\propto{\cal Z}(s^{\prime},a,o)\sum\limits%
_{s\in{\cal S}}{\cal P}(s,a,s^{\prime})b(s).
k
\theta
Q(s,a|\theta)
84\times 84
\displaystyle Q(s,a):=Q(s,a)+\alpha(r+\gamma\max\limits_{a^{\prime}}Q(s^{%
\prime},a^{\prime})-Q(s,a)).
\displaystyle Q(s,a):=Q(s,a)+\alpha(r+\gamma\max\limits_{a^{\prime}}Q(s^{%
\prime},a^{\prime})-Q(s,a)).
\{s,a,s^{\prime},r\}
\theta^{\prime}
\hat{Q}(s,a|\theta^{\prime})
\displaystyle{\cal L}=\mathbb{E}\bigg{[}(y-Q(s,a|\theta))^{2}\bigg{]},
\displaystyle{\cal L}=\mathbb{E}\bigg{[}(y-Q(s,a|\theta))^{2}\bigg{]},
y=r+\gamma\max\limits_{a^{\prime}}\hat{Q}(s^{\prime},a^{\prime}|\theta^{\prime})
\xi
g\in\Omega
o\in\Omega
a\in{\cal A}
r^{ex}\in\mathbb{R}
s^{\prime}
o^{\prime}\in\Omega
\xi
g
g
r^{in}\in\mathbb{R}
\xi
o
b
\displaystyle b^{\prime}(s^{\prime})\propto\sum_{k=1}^{\infty}\gamma^{k-1}\sum%
_{s}{\cal P}(s^{\prime},o,k|s,\xi)b(s)
\displaystyle b^{\prime}(s^{\prime})\propto\sum_{k=1}^{\infty}\gamma^{k-1}\sum%
_{s}{\cal P}(s^{\prime},o,k|s,\xi)b(s)
{\cal P}(s^{\prime},o,k|s,\xi)
Q^{M}(o_{t},\xi|\theta^{M})
o_{t},\theta^{M}
\theta^{M}
\xi
\xi
g_{t}
\{o_{t},\theta^{M}\}
t
b_{t}
Q^{M}(b,\xi)
Q^{M}(o,\xi|\theta^{M})
\xi
b
o
\displaystyle{\cal P}(o|b,\xi)=\sum\limits_{k=1}^{\infty}\sum_{s^{\prime}}\sum%
_{s}\gamma^{k}{\cal P}(s^{\prime},o,k|s,\xi)b(s)
\displaystyle{\cal P}(o|b,\xi)=\sum\limits_{k=1}^{\infty}\sum_{s^{\prime}}\sum%
_{s}\gamma^{k}{\cal P}(s^{\prime},o,k|s,\xi)b(s)
\pi
\displaystyle{\cal V}^{M}(b)=\sum_{\xi}\pi(\xi|b)\left[{\cal R}_{b}^{\xi}+\sum%
\limits_{o^{\prime}}{\cal P}(o^{\prime}|b,\xi){\cal V}^{M}(b^{\prime})\right]
\displaystyle{\cal V}^{M}(b)=\sum_{\xi}\pi(\xi|b)\left[{\cal R}_{b}^{\xi}+\sum%
\limits_{o^{\prime}}{\cal P}(o^{\prime}|b,\xi){\cal V}^{M}(b^{\prime})\right]
\displaystyle{\cal Q}^{M}(b,\xi)={\cal R}_{b}^{\xi}+\sum\limits_{o^{\prime}}{%
\cal P}(o^{\prime}|b,\xi)\sum\limits_{\xi^{\prime}\in{\Xi}}\mu(\xi^{\prime}|b^%
{\prime}){\cal Q}^{M}(b^{\prime},\xi^{\prime})
\displaystyle{\cal Q}^{M}(b,\xi)={\cal R}_{b}^{\xi}+\sum\limits_{o^{\prime}}{%
\cal P}(o^{\prime}|b,\xi)\sum\limits_{\xi^{\prime}\in{\Xi}}\mu(\xi^{\prime}|b^%
{\prime}){\cal Q}^{M}(b^{\prime},\xi^{\prime})
R_{b}^{\xi}
\xi
V^{\xi}(b)
Q^{S}(b,a)
Q^{S}(b,a)
Q^{S}(\{o_{t},g_{t}\},a|\theta^{S})
\theta^{S}
\{o_{t},g_{t}\}
o_{t}
g_{t}
a_{t}
g_{t}
o_{t}
h^{S}_{t}
t
o_{t}
h^{M}_{t}
Q
Q^{M}(o_{t},g_{t}|\theta^{M})
Q
g_{t+k}
o_{t}
g_{t}
h^{S}_{t}
Q
Q^{S}(\{o_{t},g_{t}\},a_{t}|\theta^{S})
a_{t+1}
\displaystyle\Phi^{M}=\begin{cases}f^{extract}(o_{t})&\text{framework 1}\\
f^{extract}(h^{S})&\text{framework 2}\end{cases}
\displaystyle\Phi^{M}=\begin{cases}f^{extract}(o_{t})&\text{framework 1}\\
f^{extract}(h^{S})&\text{framework 2}\end{cases}
\displaystyle h^{M}_{t},Q^{M}(o_{t},g_{t}|\theta^{M})=f^{M}(\Phi^{M},h^{M}_{t-%
1})
\displaystyle h^{M}_{t},Q^{M}(o_{t},g_{t}|\theta^{M})=f^{M}(\Phi^{M},h^{M}_{t-%
1})
\displaystyle\Phi^{S}=f^{extract}(o_{t},g_{t})
\displaystyle\Phi^{S}=f^{extract}(o_{t},g_{t})
\displaystyle h^{S}_{t},Q^{S}(\{o_{t},g_{t}\},a_{t}|\theta^{S})=f^{S}(\Phi^{S}%
,h^{S}_{t-1}),
\displaystyle h^{S}_{t},Q^{S}(\{o_{t},g_{t}\},a_{t}|\theta^{S})=f^{S}(\Phi^{S}%
,h^{S}_{t-1}),
\Phi^{M}
\Phi^{S}
f^{M}
f^{S}
Q
A
V
Q
Q^{M}(\hat{o}_{t},g_{t})=Q^{M}(\hat{o}_{t},g_{t})+\\
\alpha(r^{ex}+\gamma^{k}\max\limits_{g_{t+k}}Q^{M}(\hat{o}_{t+k},g_{t+k})-Q^{M%
}(\hat{o}_{t},g_{t}))
Q^{S}(\{o_{t},g_{t}\},a_{t})=Q^{S}(\{o_{t},g_{t}\},a_{t})+\\
\alpha(r^{in}+\gamma\max\limits_{a_{t+1}}Q^{S}(\{o_{t+1},g_{t}\},a_{t+1})-Q^{S%
}(\{o_{t},g_{t}\},a_{t}))
\hat{o}
\theta^{M}
\theta^{S}
Q^{M}(\hat{o}_{t},g_{t})
Q^{S}(\{o_{t},g_{t}\},a_{t})
Q^{M}(\hat{o}_{t},g_{t})=Q^{M}(\hat{o}_{t},g_{t}|\theta^{M})
Q^{S}(\{o_{t},g_{t}\},a_{t})=Q^{S}(\{o_{t},g_{t}\},a_{t}|\theta^{S})
Q^{M}
Q^{S}
L^{M}
L^{S}
L^{M}
\displaystyle L^{M}=\mathbb{E}_{(o,g,o^{\prime},g^{\prime},r^{ex})\sim\cal{M}^%
{M}}\big{[}y^{M}_{i}-Q^{M}(o,g|\theta^{M})\big{]},
\displaystyle L^{M}=\mathbb{E}_{(o,g,o^{\prime},g^{\prime},r^{ex})\sim\cal{M}^%
{M}}\big{[}y^{M}_{i}-Q^{M}(o,g|\theta^{M})\big{]},
\mathbb{E}
M^{M}
i
\displaystyle y^{M}_{i}=r^{ex}+\gamma Q^{M^{\prime}}(o^{\prime},\operatorname*%
{argmax}_{g^{\prime}}Q^{M}(o^{\prime},g^{\prime}|\theta^{M})|\theta^{M^{\prime%
}}).
\displaystyle y^{M}_{i}=r^{ex}+\gamma Q^{M^{\prime}}(o^{\prime},\operatorname*%
{argmax}_{g^{\prime}}Q^{M}(o^{\prime},g^{\prime}|\theta^{M})|\theta^{M^{\prime%
}}).
L^{S}
\displaystyle L^{S}=\mathbb{E}_{(o,g,a,r^{in})\sim\cal{M}^{S}}\big{[}y^{S}_{i}%
-Q^{S}(\{o,g\},a|\theta^{S})\big{]},
\displaystyle L^{S}=\mathbb{E}_{(o,g,a,r^{in})\sim\cal{M}^{S}}\big{[}y^{S}_{i}%
-Q^{S}(\{o,g\},a|\theta^{S})\big{]},
\displaystyle y^{S}_{i}=r^{in}+\gamma Q^{S^{\prime}}(\{o^{\prime},g\},%
\operatorname*{argmax}_{a^{\prime}}Q^{S}(\{o^{\prime},g\},a^{\prime}|\theta^{S%
})|\theta^{S^{\prime}}).
\displaystyle y^{S}_{i}=r^{in}+\gamma Q^{S^{\prime}}(\{o^{\prime},g\},%
\operatorname*{argmax}_{a^{\prime}}Q^{S}(\{o^{\prime},g\},a^{\prime}|\theta^{S%
})|\theta^{S^{\prime}}).
\cal{M}^{S}
Q^{S^{\prime}}
Q^{S}
n
n
Q
\frac{n}{2}
M=\{{\cal S},{\cal A},{\cal P},r,{\Omega},{\cal Z}\}
Q^{M}
Q^{M^{\prime}}
\theta^{M}
\theta^{M^{\prime}}
Q^{S}
Q^{S^{\prime}}
\theta^{S}
\theta^{S^{\prime}}
\epsilon^{M}
\epsilon^{S}
M^{M}
M^{S}
\cal G
f^{M}
f^{S}
M^{M}
M^{S}
\theta^{M}
\theta^{S}
\theta^{M^{\prime}}\leftarrow\theta^{M}
\theta^{S^{\prime}}\leftarrow\theta^{S}
\epsilon^{M}\leftarrow 1.0
0.1
\epsilon^{S}\leftarrow 1.0
0.1
k=1,2,\ldots K
o
h^{M}\leftarrow\mathbf{0}
o
h^{S}\leftarrow\mathbf{0}
o_{0}\leftarrow\hat{o}
\hat{o}
o
h^{S}
g,h^{M}\leftarrow
EPS\_GREEDY(\hat{o},h^{M},{\cal G},\epsilon^{M},Q^{M},f^{M})
o
g
a,h^{S}\leftarrow
EPS\_GREEDY(\{o,g\},h^{S},{\cal A},\epsilon^{S},Q^{S},f^{S})
a
r
r^{ex}
r^{in}
s^{\prime}
\{\{o,g\},a,r^{in},\{o^{\prime},g^{\prime}\}\}
M^{S}
SUB\_UPDATE(M^{S},Q^{S},Q^{S^{\prime}})
META\_UPDATE(M^{M},Q^{M},Q^{M^{\prime}})
o\leftarrow o^{\prime}
\{o_{0},g,r^{ex}_{total},\hat{o}^{\prime}\}
M^{S}
\hat{o}^{\prime}
o^{\prime}
h^{S}
\epsilon^{M}
\epsilon^{S}
Q^{M}
Q^{M^{\prime}}
Q^{S}
Q^{S^{\prime}}
\theta^{M}
\theta^{M^{\prime}}
\theta^{S}
\theta^{S^{\prime}}
M^{M}
M^{S}
\epsilon^{M}
\epsilon^{S}
o_{0}
o
h^{S}
\epsilon
\epsilon
M^{S}
M^{M}
{\cal B}
\epsilon
f
h\leftarrow f(x,h)
random()<\epsilon
o\leftarrow
{\cal B}
o=\operatorname*{argmax}_{m\in{\cal B}}Q(x,m)
o,h
EPS\_GREEDY(x,h,{\cal B},\epsilon,Q,f)
M^{M}
\{o,g,r^{ex},o^{\prime}\}
M^{M}
L^{M}=\mathbb{E}_{(o,g,o^{\prime},g^{\prime},r^{ex})\sim\cal{M}^{M}}\big{[}y^{%
M}_{i}-Q^{M}(o,g|\theta^{M})\big{]}
y^{M}_{i}=r^{ex}+\gamma Q^{M^{\prime}}(o^{\prime},\operatorname*{argmax}_{g^{%
\prime}}Q^{M}(o^{\prime},g^{\prime}|\theta^{M})|\theta^{M^{\prime}})
\theta^{M^{\prime}}\leftarrow\tau\theta^{M}+(1-\tau)\theta^{M^{\prime}}
META\_UPDATE(M^{M},Q^{M},Q^{M^{\prime}})
M^{S}
\{\{o,g\},a,r^{in},\{o^{\prime},g^{\prime}\}\}
M^{S}
L^{S}=\mathbb{E}_{(o,g,a,r^{in})\sim\cal{M}^{S}}\big{[}y^{S}_{i}-Q^{S}(\{o,g\}%
,a|\theta^{S})\big{]},
y^{S}_{i}=r^{in}+\gamma Q^{S^{\prime}}(\{o^{\prime},g\},\operatorname*{argmax}%
_{a^{\prime}}Q^{S}(\{o^{\prime},g\},a^{\prime}|\theta^{S^{\prime}})|\theta^{S^%
{\prime}})
\theta^{S^{\prime}}\leftarrow\tau\theta^{S}+(1-\tau)\theta^{S^{\prime}}
SUB\_UPDATE(M^{S},Q^{S},Q^{S^{\prime}})
44\times 44\times 3
3\times 3
5\times 5
0.001
\tau
0.001
0.99
M^{S}
M^{M}
1E5
5E4
11\times 11
3\times 3
5\times 5
0.01
r^{in}=\begin{cases}1&\text{obtain the goal}\\
-1&\text{hit the obstacle}\end{cases}
r^{ex}=\begin{cases}1&\text{reach goals in order}\\
0.01&\text{otherwise}\end{cases}
3\times 3
3\times 3
5\times 5
5\times 5
5\times 5
n^{M}=1
n^{S}=8
n^{S}=8
n^{S}=12
n^{S}=8
n^{S}=12
n^{S}=8
n^{M}=2
n^{M}=1
n^{M}=1
n^{M}=2
n^{M}=1
n^{M}=2
n^{M}=1
n^{S}=8
n^{M}=1
n^{S}=8
3\times 3
5\times 5
5\times 5
3\times 3
5\times 5
5\times 5
5
3\times 3
3\times 3
5\times 5
5\times 5
8
16
70\times 70
44\times 44
