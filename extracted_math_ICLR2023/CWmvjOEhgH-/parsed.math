\times
\text{BERT}_{\text{BASE}}
\times
\text{BERT}_{\text{BASE}}
\times
\text{ROBERTA}_{\text{BASE}}
\text{BERT}_{\text{Large}}
\text{BERT}_{\text{BASE}}
{<}1
{\sim}60
\text{BERT}_{\text{BASE}}
\times
\text{BERT}_{\text{LARGE}}
\times
\text{BERT}_{\text{BASE}}
\times
\text{RoBERTa}_{\text{BASE}}
n
n
x
x
x_{1}
x_{2}
x_{1}
x_{2}
x_{1}
x_{2}
x_{1}
x_{2}
x
x
x
x_{1}
x_{2}
x
x=x_{1}+x_{2}
\text{BERT}_{\text{BASE}}
<
\text{BERT}_{\text{BASE}}
<
x
y
x
y
x_{1}
y_{1}
x_{2}
y_{2}
c=ab
c_{1},a_{1},b_{1}
c_{2},a_{2},b_{2}
\epsilon_{1}=x_{1}-a_{1}
\delta_{1}=y_{1}-b_{1}
\epsilon_{2}=x_{2}-a_{2}
\delta_{2}=y_{2}-b_{2}
\epsilon=\epsilon_{1}+\epsilon_{2}
\delta=\delta_{1}+\delta_{2}
r_{1}=c_{1}+\epsilon b_{1}+\delta a_{1}+\delta\epsilon
r_{2}=c_{2}+\epsilon b_{2}+\delta a_{2}
xy
xy=r_{1}+r_{2}
x_{1}
\epsilon_{1}=x_{1}-a_{1}
a_{1}
\text{BERT}_{\text{BASE}}
\operatorname{GeLU}(x)=x\times\frac{1}{2}\left[1+\operatorname{erf}\left(\frac%
{x}{\sqrt{2}}\right)\right]
\operatorname{erf}(\cdot)
\operatorname{Softmax}(\textbf{x}_{i})=\frac{\exp(\textbf{x}_{i})}{\sum_{j}%
\exp(\textbf{x}_{j})}
\mathbf{x}
\operatorname{ReLU}(x)=0.125\times x^{2}+0.25\times x+0.5
\mathcal{T}
X
\mathcal{T}
\mathcal{T}
\mathcal{S}
\mathcal{S}
\mathcal{T}
\mathcal{T}
\mathcal{T}
\mathcal{D}
\mathcal{A}
\mathcal{A}
\mathcal{T}
\displaystyle\operatorname{Convert:}\;\;\mathcal{S}=\operatorname{\textsc{%
MPCFormer}{}}(\mathcal{T},\mathcal{D},\mathcal{A})
\displaystyle\operatorname{Convert:}\;\;\mathcal{S}
\displaystyle=\operatorname{\textsc{MPCFormer}{}}(\mathcal{T},\mathcal{D},%
\mathcal{A})
\displaystyle\operatorname{Inference:}\;\;y=\operatorname{MPC}_{\mathcal{S}}(X)
\displaystyle\operatorname{Inference:}\;\;y
\displaystyle=\operatorname{MPC}_{\mathcal{S}}(X)
\mathcal{A}
\mathcal{T}
\mathcal{S}^{\prime}
\mathcal{S}^{\prime}
\mathcal{S}
\mathcal{T}
\mathcal{T}
\mathcal{S}^{\prime}
\mathcal{S^{\prime}}
\mathcal{S}
\mathcal{T}
\mathcal{S}^{\prime}
\mathcal{S^{\prime}}
\mathcal{S}
\mathcal{T}
\mathcal{A}
\mathcal{S}^{\prime}
\mathcal{A}
\mathcal{A}
\S
GeLU(x)\approx 0.125x^{2}+0.25x+0.5.
\small\operatorname{softmax}(x)\approx\operatorname{ReLU}(x)/\sum\operatorname%
{ReLU}(x)
\small\operatorname{softmax}(x)\approx(x+c)^{2}/\sum(x+c)^{2}
\mathcal{S}^{\prime}
\mathcal{S}
\mathcal{T}
\mathcal{S}^{\prime}
\mathcal{T}
\mathcal{S}
\mathcal{S}^{\prime}
\mathcal{T}
\mathcal{S}^{\prime}
\mathcal{T}
\S
\S
\mathcal{S}
\mathcal{T}
\mathcal{T}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
\mathcal{S}^{\prime}
\mathcal{S}^{\prime}
\mathcal{D}
\mathcal{S}^{\prime}
\mathcal{T}
{}_{\text{w/o\{p,d\}}}
\mathcal{S}^{\prime}
\mathcal{D}
{}_{\text{w/o\{p,d\}}}
{}_{\text{w/o\{d\}}}
\text{BERT}_{\text{BASE}}
\text{BERT}_{\text{LARGE}}
\text{BERT}_{\text{BASE}}
\text{BERT}_{\text{BASE}}
\mathcal{T}
\mathcal{T}
\mathcal{T}
\text{BERT}_{\text{BASE}}
\mathcal{T}
\mathcal{T}
\mathcal{T}
\times
\times
{}_{\text{w/o\{p,d\}}}
\times
\times
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
\times
\times
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
\times
\times
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
\times
\times
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
\times
\times
{}_{\text{w/o\{d\}}}
\text{BERT}_{\text{BASE}}
\mathcal{T}
\mathcal{T}
\mathcal{T}
\text{BERT}_{\text{BASE}}
\mathcal{T}
\mathcal{T}
\mathcal{T}
\times
\times
\times
\times
\text{BERT}_{\text{BASE}}
\text{BERT}_{\text{BASE}}
\times
{}_{\text{w/o \{p,d\}}}
\times
{}_{\text{w/o \{d\}}}
{}_{\text{w/o \{p,d\}}}
\times
{}_{\text{w/o \{d\}}}
\times
\times
\times
\times
{}_{\text{w/o \{d\}}}
\times
\times
\text{BERT}_{\text{BASE}}
\times
\text{BERT}_{\text{BASE}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
\times
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
\mathcal{T}
\mathcal{S}^{\prime}
{}_{\text{w/o\{d\}}}
\text{BERT}_{\text{BASE}}
\text{ROBERTA}_{\text{BASE}}
\text{BERT}_{\text{LARGE}}
\text{ROBERTA}_{\text{BASE}}
\mathcal{T}
\mathcal{S}^{\prime}
{}_{\text{w/o \{d\}}}
{}_{\text{w/o \{p,d\}}}
\times
\times
\times
\times
\times
{}_{\text{w/o \{p,d\}}}
\times
{}_{\text{w/o \{d\}}}
\times
{}_{\text{w/o \{p,d\}}}
\times
{}_{\text{w/o \{d\}}}
\text{BERT}_{\text{LARGE}}
\text{BERT}_{\text{BASE}}
\times
{}_{\text{w/o \{p,d\}}}
{}_{\text{w/o \{d\}}}
\mathcal{T}
{}_{\text{w/o \{p,d\}}}
{}_{\text{w/o \{d\}}}
\mathcal{S}^{\prime}
\mathcal{T}
=1.0
=1.0
\mathcal{T}
\mathcal{S}^{\prime}
{}_{\text{r}}
{}_{\text{r}}
\times
{}_{\text{r}}
\mathcal{T}
\mathcal{S}
\mathcal{S}
\mathcal{T}
{}_{\text{r}}
\mathcal{T}
{}_{\text{r}}
{}_{\text{r}}
\mathcal{T}
\mathcal{S}
\mathcal{S}
x_{f}
x
x\in\mathcal{Z}/\mathcal{Q}\mathcal{Z}
\mathcal{Z}/\mathcal{Q}\mathcal{Z}
\mathcal{Q}
[x]=\{[x]_{1},[x]_{2}\}
[x]_{1}
[x]_{2}
[x]_{1}+[x]_{2}=x
\langle x\rangle
x
\langle x\rangle_{1}\oplus\langle x\rangle_{1}=x
[x]+[y]
[x]_{i}+[y]_{i}
[x][y]
([c],[a],[b])
c=ab
[\epsilon]=[x]-[a]
[\delta]=[y]-[b]
[x][y]=[c]+\epsilon[b]+[a]\delta+\epsilon\delta
[x]
\langle x\rangle
\langle[x]_{i}\rangle
[x]_{i}
i=0,1
\langle x\rangle=\langle[x]_{1}\rangle+\langle[x]_{2}\rangle
\langle x\rangle
[x]
[x]=\sum_{b=1}^{B}2^{b}[\langle x\rangle^{(b)}]
\langle x\rangle^{(b)}
b^{th}
\langle x\rangle
[z<0]
[z]
\langle z\rangle
\langle b\rangle=\langle z\rangle>>(L-1)
\langle b\rangle
[b]
\epsilon,\delta
[x]
\langle x\rangle
\log_{2}L=6
\langle x\rangle
[x]
[\langle x\rangle^{(b)}]
\max(\cdot)
\mathcal{O}(\log_{2}(N))
\mathcal{Q}
[m]_{1}+[m]_{2}=m.
[m]_{1}+[m]_{2}=m.
x=1
x=\operatorname{random}
[z_{x}]_{1}=-4
[z_{x}]_{2}=4
[x]_{1}=x+[z_{x}]_{1}=-3
[x]_{2}=[z_{x}]_{2}=4
x_{1}
y=\operatorname{random}
y=2
[z_{y}]_{1}=50
[z_{y}]_{2}=-50
[y]_{1}=[z_{y}]_{1}=50
[y]_{2}=y+[z_{y}]_{2}=-48
y_{2}
x+y
[x+y]_{i}=[x]_{1}+[y]_{1}=47
[x+y]_{2}=[x]_{2}+[y]_{2}=-44
x+y
x+y=[x+y]_{1}+[x+y]_{2}=3
x+y=[x+y]_{1}+[x+y]_{2}=3
\displaystyle Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf%
\}})V
\displaystyle Attention(Q,K,V)
\displaystyle=softmax(\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf\}})V
\displaystyle=\frac{e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf\}}\right)%
}}{\sum_{j=1}^{K}e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf\}}\right)_{j%
}}}V.
\displaystyle=\frac{e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf\}}\right)%
}}{\sum_{j=1}^{K}e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf\}}\right)_{j%
}}}V.
e^{x}
(x+c)^{2}
x=\frac{QK^{T}}{\sqrt{d_{k}}}+M_{\{0,-inf\}}
\displaystyle Attention(Q,K,V)=\frac{e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}%
\right)}\odot M_{\{1,0\}}}{\sum_{j=1}^{K}e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}%
\right)_{j}}\odot M_{\{1,0\}}}V
\displaystyle Attention(Q,K,V)
\displaystyle=\frac{e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}\right)}\odot M_{\{1,0%
\}}}{\sum_{j=1}^{K}e^{\left(\frac{QK^{T}}{\sqrt{d_{k}}}\right)_{j}}\odot M_{\{%
1,0\}}}V
\displaystyle\rightarrow\frac{\left(\frac{QK^{T}}{\sqrt{d_{k}}}+c\right)^{2}%
\odot M_{\{1,0\}}}{\sum_{j=1}^{K}\left(\frac{QK^{T}}{\sqrt{d_{k}}}+c\right)_{j%
}^{2}\odot M_{\{1,0\}}}V.
\displaystyle\rightarrow\frac{\left(\frac{QK^{T}}{\sqrt{d_{k}}}+c\right)^{2}%
\odot M_{\{1,0\}}}{\sum_{j=1}^{K}\left(\frac{QK^{T}}{\sqrt{d_{k}}}+c\right)_{j%
}^{2}\odot M_{\{1,0\}}}V.
c=5
c
\text{BERT}_{\text{BASE}}
\text{BERT}_{\text{Large}}
\text{ROBERTA}_{\text{BASE}}
{}_{\text{w/o\{d\}}}
\text{BERT}_{\text{Large}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p, d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{p,d\}}}
{}_{\text{w/o\{p,d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
{}_{\text{w/o\{d\}}}
