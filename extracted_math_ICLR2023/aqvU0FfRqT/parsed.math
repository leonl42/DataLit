t-1
t
\sim 1-20
\times
f_{\theta}:\mathcal{X}\rightarrow\mathcal{Y}
\theta
\mathcal{X}
\mathcal{Y}
\mathcal{Y}=\{0,1\}^{k}
k
\mathcal{D}=\{\mathbf{D}^{1},\dots,\mathbf{D}^{T}\}
T
\mathbf{D}^{t}
t
\mathbf{D}^{t}=\{({\bm{x}}^{t}_{i},y^{t}_{i})\}_{i=1}^{n_{t}}
{\bm{x}}_{i}^{t}
y_{i}^{t}
i
t
t
\mathcal{Y}^{t}
\mathcal{Y}^{t}\cap\mathcal{Y}^{u}=\varnothing
t\neq u
t
\mathcal{Y}^{t}
\mathcal{Y}=\bigcup_{t=1}^{T}\mathcal{Y}^{t}
{\bm{x}}
{\bm{h}}\in\mathbb{R}^{L\times D}
L
D
t
{\bm{p}}_{t}\in\mathbb{R}^{L_{{\bm{p}}}\times D}
L_{{\bm{p}}}
D
{\bm{h}}
i
{\bm{h}}^{(i)}
{\bm{h}}^{(i)}_{\text{mod}}=f_{\text{prompt}}({\bm{p}}_{t},{\bm{h}}^{(i)}),
f_{\text{prompt}}
f_{\text{prompt}}
{\bm{h}}\in\mathbb{R}^{L\times D}
{\bm{h}}
{\bm{h}}_{Q},{\bm{h}}_{K}
{\bm{h}}_{V}
W^{Q}
W^{K}
W^{V}
\displaystyle\text{MSA}({\bm{h}}_{Q},{\bm{h}}_{K},{\bm{h}}_{V})=\text{Concat}(%
\text{h}_{1},\dots,\text{h}_{\text{m}})W^{O}
\displaystyle\text{MSA}({\bm{h}}_{Q},{\bm{h}}_{K},{\bm{h}}_{V})=\text{Concat}(%
\text{h}_{1},\dots,\text{h}_{\text{m}})W^{O}
\displaystyle\text{where}\>\text{h}_{\text{i}}=\text{Attention}({\bm{h}}_{Q},{%
\bm{h}}_{K},{\bm{h}}_{V}),
\displaystyle\text{where}\>\text{h}_{\text{i}}=\text{Attention}({\bm{h}}_{Q},{%
\bm{h}}_{K},{\bm{h}}_{V}),
W^{O}
f_{\text{prompt}}
\displaystyle f_{\text{prompt}}({\bm{p}}_{t},{\bm{h}}^{(i)})=\text{MSA}({\bm{h%
}}^{(i)}_{Q},[{\bm{p}}_{t,K};{\bm{h}}^{(i)}_{K}],[{\bm{p}}_{t,V};{\bm{h}}^{(i)%
}_{V}]),
\displaystyle f_{\text{prompt}}({\bm{p}}_{t},{\bm{h}}^{(i)})=\text{MSA}({\bm{h%
}}^{(i)}_{Q},[{\bm{p}}_{t,K};{\bm{h}}^{(i)}_{K}],[{\bm{p}}_{t,V};{\bm{h}}^{(i)%
}_{V}]),
{\bm{p}}_{t}
{\bm{p}}_{t,K},{\bm{p}}_{t,V}\in\mathbb{R}^{L_{{\bm{p}}}/2\times D}
{\bm{h}}^{(i)}_{K}
{\bm{h}}^{(i)}_{V}
{\bm{h}}^{(i)}_{Q}
{\bm{p}}_{t}
{\bm{k}}_{t}\in\mathbb{R}^{D}
q(\cdot)
q(\cdot)
{\bm{k}}_{t}
{\bm{p}}_{t}
{\bm{p}}_{t}
t
t
O(L^{2})
O(TL^{2})
T
L
t
{\bm{s}}_{t}\in\mathbb{R}^{L_{\bm{s}}\times D}
L_{\bm{s}}
D
L_{\bm{s}}
L
{\bm{s}}_{t}
t
{\bm{g}}^{(l)}\in\mathbb{R}^{(L+1)\times D}
l
l
j
t
{\bm{g}}
\bar{{\bm{g}}}
\displaystyle\bar{{\bm{g}}}_{j}=\sum^{L+1}_{k=1}\bm{\alpha}_{k}{\bm{g}}_{k},%
\quad\text{where}\;\bm{\alpha}=\text{softmax}\left(\frac{{\bm{s}}_{j}{\bm{g}}^%
{\textrm{T}}}{\sqrt{D}}\right).
\displaystyle\bar{{\bm{g}}}_{j}=\displaystyle\sum^{L+1}_{k=1}\bm{\alpha}_{k}{%
\bm{g}}_{k},\quad\text{where}\;\bm{\alpha}=\text{softmax}\left(\frac{{\bm{s}}_%
{j}{\bm{g}}^{\textrm{T}}}{\sqrt{D}}\right).
\bm{\alpha}
{\bm{g}}
{\bm{s}}_{j}
L_{\bm{s}}
\bar{{\bm{g}}}\in\mathbb{R}^{L_{\bm{s}}\times D}
L_{\bm{s}}<L
O(L^{2}_{\bm{s}})\ll O(L^{2})
T
i
{\bm{h}}^{(i)}_{\text{mod}}=f_{\text{prompt}}({\bm{p}}_{t},\bar{{\bm{g}}}^{(i)%
}).
\bar{{\bm{g}}}^{(i)}
\hat{{\bm{y}}}
t
\mathcal{L}^{t}_{\text{bce}}=-\frac{1}{|\mathcal{Y}^{t}|}\sum_{i\in\mathcal{Y}%
^{t}}y_{i}\log\hat{y}_{i}+(1-y_{i})\log(1-\hat{y}_{i})
i
\mathcal{Y}^{t}
y_{i}
\hat{y}_{i}
T
T
T
\hat{\bm{Y}}=[\hat{{\bm{y}}}_{1};\dots;\hat{{\bm{y}}}_{T}]
[\cdot;\cdot]
(\uparrow)
(\uparrow)
(\uparrow)
(\uparrow)
\times
\beta_{1}=0.9
\beta_{2}=0.999
\times
D=768
T\times L_{\bm{s}}\times D
(\uparrow)
(\uparrow)
(\uparrow)
(\uparrow)
\sim
L_{s}
(\uparrow)
\pm 0.18
\pm 0.30
\pm 0.36
\pm 0.06
(\downarrow)
\uparrow
\times
\times
(\uparrow)
90.85
\pm 0.12
79.13
\pm 0.18
\pm 2.60
\pm 1.27
82.50
\pm 1.10
69.29
\pm 0.73
83.05
\pm 1.16
71.31
\pm 0.62
\pm 0.74
\pm 0.56
\pm 0.34
\pm 0.40
M\neq N
t-1
t
t
t-1
t+1
v
t
v
t
t
v
v
t
u
t
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
r
{\bm{g}}\in\mathbb{R}^{(L+1)\times D}
\bar{{\bm{g}}}^{\prime}\in\mathbb{R}^{L_{s}^{\prime}\times D}
\bar{{\bm{g}}}^{\prime}
\bar{{\bm{g}}}^{\prime\prime}\in\mathbb{R}^{L_{s}^{\prime\prime}\times D}
L_{s}
L_{s}
