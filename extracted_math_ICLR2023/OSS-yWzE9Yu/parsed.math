2\times
7\times
80\%
80\%
12\%
50\%
10\times
k
99\%
30
80\%
\bullet
\alpha
\bullet
\bullet
0.3\%
80\%
\bullet
w=v|{v}|^{\alpha-1}
T
w
T
\displaystyle\text{(sparse)}\quad\tilde{w}=\text{sign}(w)\cdot h_{\alpha}(|w|-T)
\displaystyle\text{(sparse)}\quad\tilde{w}=\text{sign}(w)\cdot h_{\alpha}(|w|-T)
\displaystyle\text{Forward pass}\quad h_{\alpha}(x)=\begin{cases}x,\quad x>0\\
0,\quad x\leq 0\end{cases}\qquad\text{(Proxy) Gradient}\quad\frac{\partial h_{%
\alpha}(x)}{\partial x}=\begin{cases}1,\quad x>0\\
\alpha,\quad x\leq 0\end{cases}
\displaystyle\text{Forward pass}\quad h_{\alpha}(x)=\begin{cases}x,\quad x>0\\
0,\quad x\leq 0\end{cases}\qquad\text{(Proxy) Gradient}\quad\frac{\partial h_{%
\alpha}(x)}{\partial x}=\begin{cases}1,\quad x>0\\
\alpha,\quad x\leq 0\end{cases}
0\leq\alpha\leq 1
\tilde{w}
0
|w|
T
h_{\alpha}(\cdot)
\alpha
\alpha
\alpha
\alpha
L_{0}=-6
L_{1}=6
T
\alpha
i
\displaystyle\text{Cosine-Decay}(i,T)\qquad c_{i}=(1+\text{cosine}(\pi\cdot i/%
T))/2
\displaystyle\text{Cosine-Decay}(i,T)\qquad c_{i}
\displaystyle=
\displaystyle(1+\text{cosine}(\pi\cdot i/T))/2
\displaystyle\text{Sigmoid-Decay}(i,T)\qquad s_{i}=1-\text{sigmoid}(L_{0}+(L_{%
1}-L_{0})\cdot i/T)
\displaystyle\text{Sigmoid-Decay}(i,T)\qquad s_{i}
\displaystyle=
\displaystyle 1-\text{sigmoid}(L_{0}+(L_{1}-L_{0})\cdot i/T)
\displaystyle\text{Sigmoid-Cosine-Decay}(i,T)\qquad=\max\{s_{i},c_{i}\}
\displaystyle\text{Sigmoid-Cosine-Decay}(i,T)\qquad
\displaystyle=
\displaystyle\max\{s_{i},c_{i}\}
\alpha
\alpha
h_{\alpha}(\cdot)
v=|w|-T
u=h_{\alpha}(v)
w^{*}
T^{*}
v^{*}=|w^{*}|-T^{*}
\displaystyle\min_{v}\mathcal{L}(v)=0.5\cdot(h_{\alpha}(v)-v^{*})^{2}
\displaystyle\min_{v}\mathcal{L}(v)=0.5\cdot(h_{\alpha}(v)-v^{*})^{2}
\partial h_{\alpha}(v)
\frac{\partial h_{\alpha}(v)}{\partial v}
v
\displaystyle\frac{\partial\mathcal{L}}{\partial{v}}=\partial h_{\alpha}(v)(h_%
{\alpha}(v)-v^{*})=\begin{cases}\partial h_{\alpha}(v)\cdot 0=0\quad\text{if}%
\quad h_{\alpha}(v)=v^{*}\\
\partial h_{\alpha}(v)\cdot(v-v^{*})=1\cdot(v-v^{*})\quad\text{if}\quad v>0%
\text{ and }v^{*}>0\\
\partial h_{\alpha}(v)\cdot(v+|v^{*}|)=1\cdot(v+|v^{*}|)\quad\text{if}\quad v>%
0\text{ and }v^{*}\leq 0\\
\partial h_{\alpha}(v)\cdot(-v^{*})=\alpha\cdot(-v^{*})\quad\text{if}\quad v%
\leq 0\text{ and }v^{*}>0\\
\partial h_{\alpha}(v)\cdot(|v^{*}|)=\alpha\cdot(|v^{*}|)\quad\text{if}\quad v%
\leq 0\text{ and }v^{*}\leq 0\end{cases}
\displaystyle\frac{\partial\mathcal{L}}{\partial{v}}=\partial h_{\alpha}(v)(h_%
{\alpha}(v)-v^{*})=\begin{cases}\partial h_{\alpha}(v)\cdot 0=0\quad\text{if}%
\quad h_{\alpha}(v)=v^{*}\\
\partial h_{\alpha}(v)\cdot(v-v^{*})=1\cdot(v-v^{*})\quad\text{if}\quad v>0%
\text{ and }v^{*}>0\\
\partial h_{\alpha}(v)\cdot(v+|v^{*}|)=1\cdot(v+|v^{*}|)\quad\text{if}\quad v>%
0\text{ and }v^{*}\leq 0\\
\partial h_{\alpha}(v)\cdot(-v^{*})=\alpha\cdot(-v^{*})\quad\text{if}\quad v%
\leq 0\text{ and }v^{*}>0\\
\partial h_{\alpha}(v)\cdot(|v^{*}|)=\alpha\cdot(|v^{*}|)\quad\text{if}\quad v%
\leq 0\text{ and }v^{*}\leq 0\end{cases}
h_{\alpha}(\cdot)
v
v^{*}
\partial h_{\alpha}(v)>0
v
v^{*}
h_{\alpha}(\cdot)
\alpha>0
v>0
v
v-v^{*}
v
v^{*}
v
v^{*}
v
v^{*}
v\leq 0
v
\alpha\cdot v^{*}
v
v^{*}
v\leq 0
T
\alpha
v
v^{*}
v
\alpha
\alpha<1
\alpha
v
v^{*}
t
S
\alpha=0
\alpha=0
\alpha
\bullet
\bullet
\alpha
\bullet
\mathcal{D}:=\{(\bf{x}_{i}\in\mathbb{R}^{d},\it{y_{i}}\in\mathbb{R})\}
\mathcal{W}
\mathcal{L}
L
\mathcal{W}
[\textbf{W}_{\ell}]_{\ell=1}^{L}
s_{\ell}
\ell
\bf{s}
=[s_{1},...,s_{L}]
g:\mathbb{R}\rightarrow\mathbb{R}
\ell
T_{\ell}=g(s_{\ell})
\textbf{W}_{\ell}
\displaystyle\min_{\mathcal{W},\bf{s}}\mathcal{L}(\mathcal{S}_{h_{\alpha},g}(%
\mathcal{W},\bf{s}),\mathcal{D})
\displaystyle\min_{\mathcal{W},\bf{s}}\mathcal{L}(\mathcal{S}_{h_{\alpha},g}(%
\mathcal{W},\bf{s}),\mathcal{D})
\mathcal{S}_{h_{\alpha},g}
h_{\alpha}\in\mathbb{R}\rightarrow\mathbb{R}
\displaystyle\hat{\textbf{W}}_{\ell}=\mathcal{S}_{h_{\alpha},g}(\textbf{W}_{%
\ell},s_{\ell})=\text{sign}(\textbf{W}_{\ell})\cdot h_{\alpha}(|\textbf{W}_{%
\ell}|-g(s_{\ell}))
\displaystyle\hat{\textbf{W}}_{\ell}=\mathcal{S}_{h_{\alpha},g}(\textbf{W}_{%
\ell},s_{\ell})=\text{sign}(\textbf{W}_{\ell})\cdot h_{\alpha}(|\textbf{W}_{%
\ell}|-g(s_{\ell}))
h_{\alpha}(\cdot)
t
\ell
\hat{\textbf{W}}{}^{(t)}_{\ell}=\mathcal{S}_{h_{\alpha},g}(\textbf{W}^{(t)}_{%
\ell},s^{(t)}_{\ell})
\mathcal{A}^{(t)}_{\ell}=\{i:\hat{\textbf{W}}{}^{(t)}_{\ell,i}>0\}
\hat{\textbf{W}}
\textbf{Y}=\textbf{X}\otimes\hat{\textbf{W}}
\otimes
A
\mathcal{A}
1-A
\hat{\textbf{W}}
\hat{\textbf{W}}
t
\ell
\textbf{Y}=\textbf{X}\otimes\hat{\textbf{W}}
\nabla_{Y}
\nabla_{X}
\hat{\textbf{W}}\otimes\nabla_{Y}
\nabla_{X}
\hat{\textbf{W}}
\nabla_{W}
\textbf{X}\otimes\nabla_{Y}
\alpha=0
\alpha=0
\alpha\neq 0
\alpha\neq 0
\nabla_{W}
\mathcal{B}
\displaystyle\mathcal{B}=\{i:\textbf{W}_{i}\in\text{TopK({W}, $B$)}\},\quad B\geq
A
B
\displaystyle\mathcal{B}=\{i:\textbf{W}_{i}\in\text{TopK({W}, $B$)}\},\quad B\geq
A
B
\mathcal{B}
\mathcal{A}
k
k
1-B
\mathcal{B}\setminus\mathcal{A}
\mathcal{B}\setminus\mathcal{A}
\alpha
\alpha=0
\mathcal{B}=\mathcal{A}
f^{\ell}_{D}
f^{\ell}_{S}
\ell
3\cdot\sum_{\ell}f^{\ell}_{D}
3\cdot\sum_{\ell}f^{\ell}_{S}
\alpha=0
2\cdot\sum_{\ell}f^{\ell}_{S}+\sum_{\ell}f^{\ell}_{D}
\alpha\neq 0
f^{\ell}_{S}
f_{B}
2\cdot\sum_{\ell}f^{\ell}_{S}+\sum_{\ell}f_{B}
\alpha\neq 0
2\cdot\sum_{\ell}f^{\ell}_{S}+\sum_{\ell}\max(f_{B},f^{\ell}_{S})
\alpha=0
0.875
0.256
5
100
256
\lambda=0.000030517578125
0.1
s_{0}=-5
\alpha
(0.9,0.997)
10240
4000
0.000846
s_{0}=-7.0
\alpha_{0}=0.4
t
\beta>0
\beta=1
\displaystyle\text{Exponential-Decay }(t;\beta)=e^{(-\beta\cdot t)}
\displaystyle\text{Exponential-Decay }(t;\beta)=e^{(-\beta\cdot t)}
44
S\%
S\%
B
76.8
74.6
2.86
80
0.33\times
0.22\times
76.8
75.7
0.94
80
0.48\times
0.22\times
76.8
76.24
0.73
80
0.48\times
0.22\times
76.8
76.47
0.43
80
0.48\times
0.22\times
76.9
76.71
0.25
80
0.57\times
0.21\times
74.95
74.02
1.24
80.4
0.15\times
77.01
76.19
1.06
79.55
0.54\times
0.18\times
77.01
76.77
0.31
79.67
0.51\times
0.14\times
\alpha_{0}
\alpha
77.01
76.59
0.55
80.78
0.46\times
0.14\times
\alpha_{0}
\alpha
76.9
75.91
1.29
90
0.28\times
0.11\times
74.95
72.78
2.9
90.13
0.087\times
77.01
74.31
3.51
90.23
0.44\times
0.083\times
77.01
75.9
1.44
85.1
0.42\times
0.096\times
\alpha_{0}
\alpha
77.01
75.19
2.36
89.94
0.40\times
0.081\times
\alpha_{0}
\alpha
77.01
70.4
8.58
95.03
0.28\times
0.039\times
77.01
70.84
8.01
95.09
0.2\times
0.036\times
\alpha_{0}
\alpha
1\times
0\%
79.67\%
\alpha_{0}
\sim 80\%
95.09\%
\alpha_{0}
1\times
0\%
79.67\%
\alpha_{0}
\sim 80\%
95.09\%
\alpha_{0}
83.74
75.02
2.58
0.37\times
0.128\times
\alpha_{0}
s_{0}
80
75
2.34
0.33\times
0.22\times
83.74\%
\alpha_{0}=1
83.74\%
\alpha_{0}=1
80\%
90\%
0.23\%
74\%
0.21\times
0.49\times
\alpha=0.85
\geq
0.128\times
1.7\times
\alpha_{0}=0.4
\alpha=0
10
27.83
27.57
60.99\%
\alpha=0
0.01
s
68.35
5
75.28
0.43\times
0.18\times
69.97
2.75
74.98
0.53\times
0.21\times
\alpha_{0}
\alpha
0.37\times
0.1\times
64.87
86.36
0.30\times
0.1\times
\alpha_{0}
\alpha
64.18
10.8
87.72
0.25\times
0.08\times
\alpha_{0}
\alpha
1\times
74.98\%
\alpha=0.4
87.72\%
86.36\%
\alpha=0.6
\alpha=0.8
\alpha=0
t
t
0.04
1\times
74.98\%
\alpha=0.4
87.72\%
86.36\%
\alpha=0.6
\alpha=0.8
\alpha=0
t
t
0.04
2.5\times
5\times
27.83
59.25
27.49
1.22
27.83
60.99
27.57
0.93
\alpha_{0}
\alpha=0
0.08
0.09
0.08
0.09
\mathbf{I}(\cdot)
\left<\cdot,\cdot\right>
\odot
\mathcal{S}
\mathcal{S}_{\textit{h}_{\alpha},\textit{g}}
g
\mathbf{W}_{\ell}
s_{\ell}
\displaystyle\mathcal{L}^{(t)}\leftarrow\mathcal{L}(\mathcal{S}(\mathcal{W}^{(%
t)},\textbf{s}^{(t)}),\mathcal{D}),\mathbf{G}_{\ell}^{(t)}\leftarrow\nabla_{%
\mathcal{S}(\mathbf{W}_{\ell},s_{\ell})}\mathcal{L}^{(t)}
\displaystyle\mathcal{L}^{(t)}\leftarrow\mathcal{L}(\mathcal{S}(\mathcal{W}^{(%
t)},\textbf{s}^{(t)}),\mathcal{D}),
\displaystyle\mathbf{G}_{\ell}^{(t)}\leftarrow\nabla_{\mathcal{S}(\mathbf{W}_{%
\ell},s_{\ell})}\mathcal{L}^{(t)}
\displaystyle\nabla_{\mathbf{W}_{\ell}^{(t)}}\mathcal{S}(\mathbf{W}_{\ell},s_{%
\ell})\leftarrow\mathbf{G}_{I}^{(t)},\mathbf{G}_{I}^{(t)}\leftarrow\textbf{I}%
\{\mathcal{S}(\mathbf{W}_{\ell}^{(t)},s_{\ell}^{(t)})\neq 0\}+\alpha\cdot%
\textbf{I}\{\mathcal{S}(\mathbf{W}_{\ell}^{(t)},s_{\ell}^{(t)})=0\}
\displaystyle\nabla_{\mathbf{W}_{\ell}^{(t)}}\mathcal{S}(\mathbf{W}_{\ell},s_{%
\ell})\leftarrow\mathbf{G}_{I}^{(t)},
\displaystyle\mathbf{G}_{I}^{(t)}\leftarrow\textbf{I}\{\mathcal{S}(\mathbf{W}_%
{\ell}^{(t)},s_{\ell}^{(t)})\neq 0\}+\alpha\cdot\textbf{I}\{\mathcal{S}(%
\mathbf{W}_{\ell}^{(t)},s_{\ell}^{(t)})=0\}
\displaystyle(\text{Loss grad for }\mathbf{W})\nabla_{\mathbf{W}_{\ell}^{(t)}}%
\mathcal{L}^{(t)}\leftarrow\mathbf{G}_{\ell}^{(t)}\odot\mathbf{G}_{I}^{(t)}
\displaystyle(\text{Loss grad for }\mathbf{W})
\displaystyle\nabla_{\mathbf{W}_{\ell}^{(t)}}\mathcal{L}^{(t)}\leftarrow%
\mathbf{G}_{\ell}^{(t)}\odot\mathbf{G}_{I}^{(t)}
\displaystyle(\text{Loss grad for }s)\nabla_{{s}_{\ell}^{(t)}}\mathcal{L}^{(t)%
}\leftarrow-g^{\prime}(s_{\ell}^{(t)})\text{ }\left<\mathbf{G}_{\ell}^{(t)},%
\text{sign}(\mathbf{W}_{\ell}^{(t)})\odot\mathbf{G}_{I}^{(t)}\right>
\displaystyle(\text{Loss grad for }s)
\displaystyle\nabla_{{s}_{\ell}^{(t)}}\mathcal{L}^{(t)}\leftarrow-g^{\prime}(s%
_{\ell}^{(t)})\text{ }\left<\mathbf{G}_{\ell}^{(t)},\text{sign}(\mathbf{W}_{%
\ell}^{(t)})\odot\mathbf{G}_{I}^{(t)}\right>
L_{2}
\mathbf{W}_{\ell}
s_{\ell}
\forall\in[L]
\lambda
\mathbf{W}_{\ell}
s_{\ell}
\lambda\cdot\mathbf{W}_{\ell}
\lambda\cdot s_{\ell}
\eta
g(s)
s_{\text{init}}
\lambda
s_{\text{init}}
-5
-3200
5
s_{\text{init}}=-5
80
\lambda=.000017
80\%
\lambda=.000030517578125209
\lambda=0.000030517578125209
s_{\text{init}}=-5
80
\lambda=.000017
80\%
\lambda=.000030517578125209
\lambda=0.000030517578125209
\alpha
\alpha
\alpha
\alpha
\alpha=0.5
\alpha\in[0,1]
\alpha
\alpha
\alpha
M
D
T
T_{0}
\alpha_{0}
L\in\mathbb{R}^{T_{0}}
\alpha\leftarrow\alpha_{0}
t=0,...,T-1
M
D
\mathcal{L}_{t}
t<T_{0}
\alpha
\mathcal{L}_{t}\geq(1+\varepsilon_{0})\cdot L[t]
\alpha\leftarrow(1+\varepsilon_{1})\cdot\alpha
\alpha\leftarrow(1-\varepsilon_{2})\cdot\alpha
\alpha
t==T_{0}
\alpha_{0}\leftarrow\alpha
\alpha\leftarrow\alpha_{0}\cdot\text{Sigmoid-Cosine-Decay}(t-T_{0},T-T_{0})
t>=90
\alpha\leftarrow 0
\alpha
M
\alpha
\alpha_{0}=0.5
0.5
\alpha
9
\alpha
\alpha
9
10\%
\alpha
\alpha_{0}=0.5
\alpha
9
10\%
\alpha
\alpha_{0}=0.5
\alpha
9
10\%
\alpha
9
10\%
(\varepsilon_{0},\varepsilon_{1},\varepsilon_{2})
77.01
(.01,.05,.005)
76.74
78.6
77.01
(.01,.05,.01)
76.58
80.1
0.59\times
0.14\times
71.95
(.01,.05,.005)
70.5
70.5
0.67\times
0.26\times
71.95
(.01,.05,.01)
70.43
71.2
100
\alpha
9
\varepsilon_{0}=1\%
\alpha
\varepsilon_{1}
\varepsilon_{2}
\varepsilon_{1}=5\%
\varepsilon_{2}
0.5\%
1\%
\alpha_{0}=0.5
0.07
0.08
100
\alpha
9
\varepsilon_{0}=1\%
\alpha
\varepsilon_{1}
\varepsilon_{2}
\varepsilon_{1}=5\%
\varepsilon_{2}
0.5\%
1\%
\alpha_{0}=0.5
0.07
0.08
\alpha
\alpha
+
