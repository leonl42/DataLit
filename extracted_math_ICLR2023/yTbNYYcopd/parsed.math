{{}^{\dagger}}{{}^{\circ}}
2.49\%
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
1.1\%
2.49\%
0.32\%
\textbf{[Forward]}\quad z_{l}=Q_{\mathrm{INT}}(W_{l})Q_{\mathrm{INT}}(a_{l-1})%
;\quad\quad a_{l}=f_{l}(z_{l})
\textbf{[Backward]}\quad g_{l-1}=Q_{\mathrm{INT}}(W_{l}^{T})Q_{\mathrm{FP}}(%
\delta_{l});\quad\delta_{l}=f_{l}^{\prime}(z_{l})\odot g_{l}
\textbf{[Update]}\quad\frac{\partial C}{\partial W_{l}}=Q_{\mathrm{FP}}(\delta%
_{l})Q_{\mathrm{INT}}(a_{l-1}^{T})\,,
C
\odot
l
f_{l}
W_{l}
a_{l}
Q_{\mathrm{INT}}
\delta_{l}\triangleq\frac{\partial C}{\partial z_{l}}
Q_{\mathrm{FP}}
z_{l}
g_{l}\triangleq\frac{\partial C}{\partial a_{l}}
Q_{\mathrm{INT}}
Q_{\mathrm{FP}}
x
l(x)
u(x)
\mathrm{SR}(x)=\begin{cases}l(x),&w.p.\quad p(x)=1-\frac{x-l(x)}{u(x)-l(x)}\\
u(x),&w.p.\quad 1-p(x)=\frac{x-l(x)}{u(x)-l(x)}\end{cases}\,.
\begin{split}E[\mathrm{SR}(x)]&=l(x)\cdot p(x)+u(x)\cdot(1-p(x))=x\,,\end{split}
x
\min{\left(x-l(x),u(x)-x\right)}
\left[\min{\left(x-l(x),u(x)-x\right)}\right]^{2}
\left(x-l(x)\right)\cdot\left(u(x)-x\right)
\left(x-l(x)\right)\cdot\left(u(x)-x\right)
\min(a,b)^{2}\leq a\cdot b
a,b
\int p(x)\mathrm{MSE}[SR(x)]dx\geq\int p(x)\mathrm{MSE}[RDN(x)]dx
p(x)
\text{MSE}\left[SR\left(x\right)\right]\geq\text{MSE}[RDN(x)],\quad\forall x\,.
x\in[0,1]
l(x)=0
u(x)=1
W_{l}
f_{l}
l
C
(x,y)
C\left(y,f_{L}\left(W_{L}f_{L-1}\left(W_{L-1}\cdots f_{2}\left(W_{2}f_{1}\left%
(W_{1}x\right)\right)\cdots\right)\right)\right)\,.
z_{l}
a_{l}
l
\delta_{l}\triangleq\frac{dC}{dz_{l}}
\delta_{l}^{q}\triangleq Q_{\mathrm{FP}}(\delta_{l})
l
\nabla_{W_{l}}C=\delta_{l}a_{l-1}^{\top}
\nabla_{W_{l}}C_{q}=\delta_{l}^{q}a_{l-1}^{\top}
\nabla_{W_{l}}C_{q}
\nabla_{W_{l}}C
\begin{split}E\left[\nabla_{W_{l}}C_{q}\right]&=E\left[\delta_{l}^{q}a_{l-1}^{%
\top}\right]=E\left[\delta_{l}^{q}\right]a_{l-1}^{\top}=\delta_{l}a_{l-1}^{%
\top}=\nabla_{W_{l}}C\,.\end{split}
W_{1},W_{2}
f
x
Q
Q
EQ(x)=x
\mathbb{E}[f(W_{2}Q(f(W_{1}x))]\neq\mathbb{E}[f(W_{2}(f(W_{1}x))]
f
Q_{INT}
Q_{\mathrm{INT}}
Q_{\mathrm{FP}}
Q_{\mathrm{INT}}
Q_{\mathrm{FP}}
Q_{\mathrm{INT}})
Q_{\mathrm{FP}}
Q_{\mathrm{INT}}
Q_{\mathrm{FP}}
Q_{\mathrm{INT}})
Q_{\mathrm{FP}}
Q_{\mathrm{INT}}
Q_{\mathrm{FP}}
2^{0}
2^{2}
2^{0}
2^{2}
Q_{\mathrm{FP}}
\alpha
x
T_{\alpha}\left(x\right)=\begin{cases}x&\quad\mathrm{,if}$ $|x|\geq\alpha\\
\text{sign}(x)\cdot\alpha&\quad w.p.\,\,\,\frac{|x|}{\alpha},\mathrm{if}$ $|x|%
<\alpha\\
0&\quad w.p.\,\,\,1-\frac{|x|}{\alpha},\mathrm{if}$ $|x|<\alpha\,.\end{cases}
2^{2^{b-1}}\alpha
x
\max(|x|)
\alpha
b=3
\alpha=\frac{\text{max}(|x|)}{2^{2^{b-1}}}\,.
\alpha
Q_{\alpha}(x)
b
\{\alpha,2\alpha,...,2^{2^{b-1}}\alpha\}
2^{n-1}\alpha<x<2^{n}\alpha
(n\in\{0,1...,b-1\})
Q_{\alpha}(x)=\begin{cases}2^{n-1}\alpha&w.p.\,\,\,\frac{2^{n}\alpha-x}{2^{n}%
\alpha-2^{n-1}\alpha}\\
2^{n}\alpha&w.p.\,\,\,1-\frac{2^{n}\alpha-x}{2^{n}\alpha-2^{n-1}\alpha}=\frac{%
x-2^{n-1}\alpha}{2^{n-1}\alpha}\,.\end{cases}
\epsilon\sim U[-\frac{2^{n-1}\alpha}{2},\frac{2^{n-1}\alpha}{2}]
x
\alpha\cdot 2^{\lfloor{\log\left(\frac{|x|}{\alpha}\right)\rceil}}\neq\alpha%
\cdot\lfloor 2^{\log\left(\frac{|x|}{\alpha}\right)}\rceil
[2^{n-1},2^{n}]
x_{m}
x_{m}=\frac{2^{n}+2^{n-1}}{2}=\frac{3}{4}\cdot 2^{n-1}\,.
x
2^{n-1}\leq 2^{x}\leq 2^{n}
\begin{split}\text{RDNP}(2^{x})&=2^{\lfloor\log{\left(\frac{4}{3}\cdot 2^{x}%
\right)\rfloor}}=2^{\lfloor x+\log{\left(\frac{4}{3}\right)}\rfloor}=2^{\text{%
RDN}\left(x+\log{\left(\frac{4}{3}\right)}-\frac{1}{2}\right)}\approx 2^{\text%
{RDN}\left(x-0.084\right)}\,.\end{split}
X_{q}=Q_{\alpha}\left(T_{\alpha}(x)\right)\,.
T_{\alpha}
Q_{\alpha}
X_{q}
x
\begin{split}E[X_{q}]&=E\left[Q_{\alpha}\left(T_{\alpha}(x)\right)\right]=E%
\left[E\left[Q_{\alpha}\left(T_{\alpha}(x)\right)\right]|T_{\alpha}(x)\right]=%
E\left[T_{\alpha}(x)\right]=x\,,\end{split}
T_{\alpha}
Q_{\alpha}
N
\frac{1}{N}
3.5\times
\bm{1}.75\times
T
\frac{T}{2}
\text{LR}_{t}=\begin{cases}\text{LR}_{T}+\frac{(\text{LR}_{\text{base}}-\text{%
LR}_{T})}{T/2}t&\quad\mathrm{,if}$ $t\leq\frac{T}{2}\\
\text{LR}_{\text{base}}+\frac{(\text{LR}_{T}-\text{LR}_{\text{base}})}{T/2}t&%
\quad\mathrm{,else}\end{cases}\,,
\text{LR}_{T}
\text{LR}_{\mathrm{base}}
\sim 8\%
\sim 50\%
\hat{m}
\hat{m}^{t}=(1-\eta)\cdot\text{max}(|x^{t-1}|)+\eta\cdot\hat{m}^{t-1}\,,
\eta
x
\alpha
\alpha
5\times
z_{l}=\sum Q_{INT4}(W_{l})Q_{INT4}(a_{l})=\sum\alpha_{W_{l}}W_{l}^{INT4}\alpha%
_{a_{l}}a_{l}^{INT4}=\alpha_{W_{l}}\alpha_{a_{l}}\sum W_{l}^{INT4}a_{l}^{INT4}\,,
\alpha
\alpha=\frac{\Delta}{2^{b}-1}\,
\Delta
b
\alpha
x
l(x)
u(x)
\mathrm{SR}(x)=\begin{cases}l(x),&w.p.\quad p(x)=1-\frac{x-l(x)}{u(x)-l(x)}\\
u(x),&w.p.\quad 1-p(x)=\frac{x-l(x)}{u(x)-l(x)}\end{cases}\,.
\begin{split}E[\mathrm{SR}(x)]&=l(x)\cdot p(x)+u(x)\cdot(1-p(x))=x\,,\end{split}
x
x
\operatorname{Bias}[\mathrm{SR}(x)]=E[\mathrm{SR}(x)-x]=E[\mathrm{SR}(x)]-x=0\,.
\begin{split}\operatorname{Var}[\mathrm{SR}(x)]&=(l(x)-E[\mathrm{SR}(x)])^{2}%
\cdot p(x)+(u(x)-E[\mathrm{SR}(x)])^{2}\cdot(1-p(x))\\
&=\left(x-l(x)\right)\cdot\left(u(x)-x\right)\,,\end{split}
E[\mathrm{SR}(x)])
p(x)
\operatorname{Bias}[\mathrm{RDN}(x)]=\min{\left(x-l(x),u(x)-x\right)}\,.
\operatorname{Var}[\mathrm{RDN}(x)]=0\,.
x
R(x)
\text{MSE}[R(x)]=E[R(x)-x]^{2}=\operatorname{Var}[\mathrm{R}(x)]+\operatorname%
{Bias}^{2}[\mathrm{R}(x)]\,.
\text{MSE}=\begin{cases}\left[\min{\left(x-l(x),u(x)-x\right)}\right]^{2}&%
\quad RDN(x)\\
\left(x-l(x)\right)\cdot\left(u(x)-x\right)&\quad SR(x)\\
\end{cases}\,.
W_{l}
l-1
l
C
f_{l}
l
(x,y)
C\left(y,f_{L}\left(W_{L}f_{L-1}\left(W_{L-1}\cdots f_{2}\left(W_{2}f_{1}\left%
(W_{1}x\right)\right)\cdots\right)\right)\right)\,.
z^{l}
l
l
a_{l}
\delta_{l}\triangleq\frac{dC}{dz_{l}}=\frac{da_{l}}{dz_{l}}\cdots\frac{dz_{L-1%
}}{da_{L-2}}\cdot\frac{da_{L-1}}{dz_{L-1}}\cdot\frac{dz_{L}}{da_{L-1}}\cdot%
\frac{da_{L}}{dz_{L}}\cdot\frac{dC}{da_{L}}\,.
\delta_{L}\triangleq\frac{da_{L}}{dz_{L}}\cdot\frac{dC}{da_{L}}
\forall l<L
\delta_{l}\triangleq\frac{da_{l}}{dz_{l}}\frac{dz_{l+1}}{da_{l}}\cdot\delta_{l%
+1}\,.
\delta_{L}^{q}=Q\left(\delta_{L}\right)
\delta_{l}^{q}\triangleq Q\left(\frac{da_{l}}{dz_{l}}\frac{dz_{l+1}}{da_{l}}%
\delta_{l+1}^{q}\right)\,.
Q(x)
E[Q(x)]=x
\delta_{l}^{q}
\begin{split}E\delta_{l}^{q}&=EQ\left(\frac{da_{l}}{dz_{l}}\frac{dz_{l+1}}{da_%
{l}}\delta_{l+1}^{q}\right)\overset{\left(1\right)}{=}E\left[E\left[Q\left(%
\frac{da_{l}}{dz_{l}}\frac{dz_{l+1}}{da_{l}}\delta_{l+1}^{q}\right)|\delta_{l+%
1}^{q}\right]\right]\\
&\overset{\left(2\right)}{=}E\left[\frac{da_{l}}{dz_{l}}\frac{dz_{l+1}}{da_{l}%
}\delta_{l+1}^{q}\right]\overset{\left(3\right)}{=}\frac{da_{l}}{dz_{l}}\frac{%
dz_{l+1}}{da_{l}}E\delta_{l+1}^{q}\overset{\left(4\right)}{=}\frac{da_{l}}{dz_%
{l}}\frac{dz_{l+1}}{da_{l}}\delta_{l}\,,\end{split}
E[Q(x)]=x
E\left[\delta_{l+1}\right]=\delta_{l+1}^{q}
E\delta_{L}^{q}=EQ\left({\delta_{L}}\right)=\delta_{L}
l
\nabla_{W_{l}}C=\delta_{l}a_{l-1}^{\top}
\nabla_{W_{l}}C_{q}=\delta_{l}^{q}a_{l-1}^{\top}
\nabla_{W_{l}}C_{q}
\nabla_{W_{l}}C
\begin{split}E\left[\nabla_{W_{l}}C_{q}\right]&=E\left[\delta_{l}^{q}a_{l-1}^{%
\top}\right]=E\left[\delta_{l}^{q}\right]a_{l-1}^{\top}=\delta_{l}a_{l-1}^{%
\top}=\nabla_{W_{l}}C\,.\end{split}
\sim 1\%
\eta=0.1
\text{lr}_{base}=1e-3
\sim 3\%
10^{3}
10^{4}
10^{5}
10^{6}
10^{7}
10^{8}
\sim\frac{1}{3}
\sim 33\%
\sim 33\%
\alpha
2^{n}\alpha
n\in\{0,1,..,b-1\})
\alpha
b=3
\alpha=\frac{\text{max}(|x|)}{2^{2^{b-1}}}\,.
\alpha
\alpha
\text{LUQ}_{\text{PW2}}
\alpha
\alpha_{\mathrm{PW2}}=\frac{2^{\lceil\log_{2}{\text{max}(|x|)}\rceil}}{2^{2^{b%
-1}}}\,.
E
M
[2^{1-q},2^{2^{E}-2-q}(2-2^{-M})]
q
q=2^{E-1}-1
\text{LUQ}_{\text{PW2}}
x
q=2^{3}-2-\lceil\log_{2}(\text{max}(|x|))\rceil
E=3
M=0
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
\text{LUQ}_{\text{PW2}}
l
\sim 15\%
5\times
\sim 8\%
\sim 22\%
5\times
\sim 5\times
\sim 22\%
