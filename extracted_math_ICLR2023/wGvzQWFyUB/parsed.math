T
t\in[T]
x_{t}\in\mathcal{X}
a_{t}\in\mathcal{A}
r_{t}(a_{t})
r_{t}:\mathcal{A}\to[0,1]
t
x_{t}
r_{t}
\mathbb{P}_{r_{t}}(\cdot\mid{}x_{t})
\displaystyle\mathrm{\mathbf{Reg}}_{\mathsf{CB}}(T)\vcentcolon=\sum_{t=1}^{T}r%
_{t}(\pi^{\star}(x_{t}))-r_{t}(a_{t})
\displaystyle\mathrm{\mathbf{Reg}}_{\mathsf{CB}}(T)\vcentcolon=\sum_{t=1}^{T}r%
_{t}(\pi^{\star}(x_{t}))-r_{t}(a_{t})
\pi^{\star}
\Pi
x_{1},\ldots,x_{T}
\mathbb{P}_{r_{1}},\ldots,\mathbb{P}_{r_{T}}
(x_{t},r_{t},y_{t})\sim D
x_{t}\in\mathcal{X}
a_{t}\in\mathcal{A}
y_{t}(a_{t})
y_{t}:\mathcal{A}\to[0,1]
r_{t}(a_{t})
x
a
r
y
x
a
r
y
x
a
y
r
r
x
a
y
r
r
y\perp x,a|r
y\perp x|a,r
y\perp a|x,r
y
a
x
r
r=1
r=0
r=-1
x
P(a|x)
\displaystyle P(a|y,x)=\frac{P(a|x)P(y|a,x)}{P(y|x)}
\displaystyle P(a|y,x)
\displaystyle=\frac{P(a|x)P(y|a,x)}{P(y|x)}
\displaystyle\left(\text{Bayes rule}\right)
\displaystyle\left(\text{Bayes rule}\right)
\displaystyle=P(a|x)\sum_{r}\frac{P(y|r,a,x)}{P(y|x)}P(r|a,x)
\displaystyle=P(a|x)\sum_{r}\frac{P(y|r,a,x)}{P(y|x)}P(r|a,x)
\displaystyle\left(\text{Total Probability}\right)
\displaystyle\left(\text{Total Probability}\right)
\displaystyle=P(a|x)\sum_{r}\frac{P(y|r,x)}{P(y|x)}P(r|a,x)
\displaystyle=P(a|x)\sum_{r}\frac{P(y|r,x)}{P(y|x)}P(r|a,x)
\displaystyle\left(y\perp a|x,r\right)
\displaystyle\left(y\perp a|x,r\right)
\displaystyle=P(a|x)\sum_{r}\frac{P(r|y,x)}{P(r|x)}P(r|a,x)
\displaystyle=P(a|x)\sum_{r}\frac{P(r|y,x)}{P(r|x)}P(r|a,x)
\displaystyle\left(\text{Bayes rule}\right)
\displaystyle\left(\text{Bayes rule}\right)
\displaystyle=\sum_{r}P(r|y,x)\left(\frac{P(r|a,x)P(a|x)}{\sum_{a}P(r|a,x)P(a|%
x)}\right).
\displaystyle=\sum_{r}P(r|y,x)\left(\frac{P(r|a,x)P(a|x)}{\sum_{a}P(r|a,x)P(a|%
x)}\right).
\displaystyle\left(\text{Total Probability}\right)
\displaystyle\left(\text{Total Probability}\right)
P(r|y,x
P(r|a,x)
\sum_{a}P(r=0|a,x)P(a|x)>\frac{1}{2}
P(a|x)
P(r|y,x)\in\{0,1\}
\displaystyle r=0\implies P(a|y,x)=\frac{P(r=0|a,x)P(a|x)}{\sum_{a}P(r=0|a,x)P%
(a|x)}
\displaystyle r=0\implies P(a|y,x)
\displaystyle=\frac{P(r=0|a,x)P(a|x)}{\sum_{a}P(r=0|a,x)P(a|x)}
\displaystyle\leq 2P(r=0|a,x)P(a|x)\leq 2P(a|x).
\displaystyle\leq 2P(r=0|a,x)P(a|x)\leq 2P(a|x).
r\neq 0
P(y|x)
P(a|x)
r\neq 0\implies r=1
\mathop{\mathbbm{1}}(P(a|y,x)>2P(a|x))
r\neq 0\implies r=\pm 1
\texttt{DN}:\mathcal{X}\times\mathcal{Y}\to\{-1,0\}
P(\texttt{DN}(x,y)=0|r=1)=1
P(\texttt{DN}(x,y)=-1|r=-1)>0
(x,a)
\alpha
\displaystyle\rho(x,a,y)=\begin{cases}0&P(a|y,x)\leq 2P(a|x)\\
-\alpha^{-1}&P(a|y,x)>2P(a|x)\text{ and }\texttt{DN}(x,y)=-1\\
1&\text{otherwise}\end{cases},
\displaystyle\rho(x,a,y)
\displaystyle=\begin{cases}0&P(a|y,x)\leq 2P(a|x)\\
-\alpha^{-1}&P(a|y,x)>2P(a|x)\text{ and }\texttt{DN}(x,y)=-1\\
1&\text{otherwise}\end{cases},
\alpha=1
\texttt{DN}(\ldots)=0
\alpha
\alpha=1
K
\pi\leftarrow\textrm{new }\texttt{CB-Alg}
\texttt{IK}\leftarrow\textrm{new }\texttt{MC-Alg}
t=1,2,\dots;
x_{t}
A_{t}
|A_{t}|=K
P(\cdot|x_{t})\leftarrow\pi.\textrm{predict}(x_{t},A_{t})
a_{t}\sim P(\cdot|x_{t})
y_{t}
\left(x_{t},a_{t},y_{t},P(\cdot|x_{t})\right)
w_{t}\leftarrow 1/(KP(a_{t}|x_{t}))
\hat{P}(a_{t}|y_{t},x_{t})\leftarrow\texttt{IK}.\textrm{predict}((x_{t},y_{t})%
,A_{t},a_{t})
\hat{r}_{t}=0
K\hat{P}(a_{t}|y_{t},x_{t})\leq 2
\pi.\textrm{learn}(x_{t},a_{t},A_{t},r_{t}=0)
\hat{r}_{t}\neq 0
\texttt{DN}(\ldots)=0
\pi.\textrm{learn}(x_{t},a_{t},A_{t},r_{t}=1,P(\cdot|x_{t}))
\pi.\textrm{learn}(x_{t},a_{t},A_{t},r_{t}=-\alpha^{-1},P(\cdot|x_{t}))
\texttt{IK}.\textrm{learn}((x_{t},y_{t}),A_{t},a_{t},w_{t})
P(a|x)
\hat{P}(a|y,x)
a
(x,y)
((x,y),a)
\hat{\rho}(x,a,y)
(x,a,y)
\left(x,a,\hat{r}=\hat{\rho}(x,a,y)\right)
P(a|x)
P(a|x)
t
x_{t}
a_{t}
y_{t}
y_{t}
N
M
M=N=100
r=1
r=0
r=-1
3
[0.999,1.067,1.152]
[0.985,1.029,1.054]
[0.751,1.072,1.274]
[0.926,1.005,1.091]
[0.914,0.949,0.988]
[1.141,1.337,1.557]
[1.000,1.010,1.020]
[1.006,1.026,1.049]
[0.890,0.918,0.955]
[0.968,0.979,0.990]
[0.935,0.959,0.977]
[1.234,1.311,1.348]
r=0
r=0
r=1
r=-1
r=1
r=-1
r=1
r=-1
r=-1
p
r=-1
p
\mathbf{P(\text{dislike}|r=-1)=0.2}
\mathbf{P(\text{dislike}|r=-1)=0.2}
\mathbf{P(\text{dislike}|r=-1)}
\mathbf{P(\text{dislike}|r=-1)}
2.5e^{-3}
512
\sigma=0.2
10^{-3}
r=0
r=-1
r=1
r=0
r=-1
r=1
r=-1
r=-1
