\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mbox{$\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits$}(\mbox{$\mathop{\mathtt{s}}%
\limits$}_{x},\mbox{$\mathop{\mathtt{s}}\limits$}_{y})
\mathop{\mathtt{s}}\limits
\mathop{\mathtt{M}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mbox{$\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits$}(\mbox{$\mathop{\mathtt{M}_{%
x}}\limits$},\mbox{$\mathop{\mathtt{M}_{y}}\limits$})
\mathop{\mathtt{M}}\limits
\mbox{$\mathop{\mathtt{M}}\limits$}=\{a_{1},a_{2},\cdots,a_{\scriptsize{|\mbox%
{$\mathop{\mathtt{M}}\limits$}|}}|a_{i}=(\mbox{$\mathop{\mathbf{x}}\limits$}_{%
i},\mbox{$\mathop{\mathbf{v}}$}_{i})\}
|\mbox{$\mathop{\mathtt{M}}\limits$}|
\mathop{\mathtt{M}}\limits
a_{i}
i
\mathop{\mathtt{M}}\limits
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}\in\mathbb{R}^{3}
a_{i}
\mbox{$\mathop{\mathbf{v}}$}_{i}\in\mathbb{R}^{K}
a_{i}
\mathop{\mathtt{s}}\limits
\mathop{\mathtt{M}}\limits
\mbox{$\mathop{\mathcal{P}}\limits$}=\{z_{1},z_{2},\cdots\,z_{\scriptsize{|%
\mbox{$\mathop{\mathcal{P}}\limits$}|}}|z_{j}=(\mbox{$\mathop{\mathbf{z}}%
\limits$}_{j})\}
|\mbox{$\mathop{\mathcal{P}}\limits$}|
\mathop{\mathcal{P}}\limits
z_{j}
j
\mbox{$\mathop{\mathbf{z}}\limits$}_{j}\in\mathbb{R}^{3}
z_{j}
\mathop{\mathcal{P}}\limits
\mbox{$\mathop{\mathbf{H}^{\mathtt{s}}}\limits$}\in\mathbb{R}^{d_{p}\times 3}
d_{p}
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{DIFF}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{SE}}\limits
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{SE}\text{-}\mathsf{enc}}\limits
\mathop{\mathcal{P}}\limits
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{SE}\text{-}\mathsf{dec}}\limits
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}
\mathop{\mathsf{SE}\text{-}\mathsf{enc}}\limits
\mathop{\mathsf{SE}\text{-}\mathsf{enc}}\limits
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}
\mathop{\mathcal{P}}\limits
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}
\mathop{\mathcal{P}}\limits
\mathop{\mathcal{P}}\limits
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}
\mathop{\mathsf{SE}\text{-}\mathsf{enc}}\limits
\mathop{\mathcal{P}}\limits
\mathop{\mathsf{SE}\text{-}\mathsf{enc}}\limits
\{\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{p}}_{1},\mbox{$\mathop{\mathbf{%
H}}\limits$}^{\mathtt{p}}_{2},\cdots,\mbox{$\mathop{\mathbf{H}}\limits$}^{%
\mathtt{p}}_{|\scriptsize{\mbox{$\mathop{\mathcal{P}}\limits$}}|}\}=\text{VN-%
DGCNN}(\{\mbox{$\mathop{\mathbf{z}}\limits$}_{1},\mbox{$\mathop{\mathbf{z}}%
\limits$}_{2},\cdots,\mbox{$\mathop{\mathbf{z}}\limits$}_{|\scriptsize{\mbox{$%
\mathop{\mathcal{P}}\limits$}}|}\}),\vspace{-5pt}
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}=\sum\nolimits_{j}\mbox{$%
\mathop{\mathbf{H}}\limits$}^{\mathtt{p}}_{j}/{|\mbox{$\mathop{\mathcal{P}}%
\limits$}|},
\text{VN-DGCNN}(\cdot)
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{p}}_{j}\in\mathbb{R}^{d_{p}\times
3}
z_{j}
\mathop{\mathcal{P}}\limits
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}\in\mathbb{R}^{d_{p}\times 3}
\mathop{\mathcal{P}}\limits
\text{VN-DGCNN}(\cdot)
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{p}}_{j}
\mathop{\mathsf{SE}\text{-}\mathsf{dec}}\limits
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{SE}\text{-}\mathsf{dec}}\limits
z_{q}
\tilde{o}_{q}=\text{MLP}(\text{concat}(\langle\mathbf{z}_{q},\mbox{$\mathop{%
\mathbf{H}}\limits$}^{\mathtt{s}}\rangle,\|\mathbf{z}_{q}\|^{2},\text{VN-In}(%
\mbox{$\mathop{\mathbf{H}}\limits$}^{\mathtt{s}}))),
\tilde{o}_{q}
z_{q}
z_{q}
\langle\cdot,\cdot\rangle
\|\mathbf{z}_{q}\|^{2}
z_{q}
\text{VN-In}(\cdot)
\mbox{$\mathop{\mathbf{H}^{\mathtt{s}}}\limits$}\in\mathbb{R}^{d_{p}\times 3}
\mathop{\mathsf{SE}\text{-}\mathsf{dec}}\limits
\|\mathbf{z}_{q}\|^{2}
\text{VN-In}(\cdot)
\langle\cdot,\cdot\rangle
\tilde{o}_{q}
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\tilde{o}_{q}
\mathop{\mathcal{P}}\limits
z_{q}
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{SE}}\limits
\mathcal{L}^{\mathtt{s}}=\sum\nolimits_{z_{q}\in\mathcal{Z}}\|o_{q}-\tilde{o}_%
{q}\|^{2},
\mathcal{Z}
o_{q}
z_{q}
\mathop{\mathsf{SE}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{DIFF}}\limits
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mathop{\mathsf{DIFF}}\limits
\mathop{\mathsf{DIFF}\text{-}\mathsf{forward}}\limits
\{(\mbox{$\mathop{\mathbf{x}}\limits$}_{i},\mbox{$\mathop{\mathbf{v}}$}_{i})\}
t
\{(\mbox{$\mathop{\mathbf{x}}\limits$}_{i,t},\mbox{$\mathop{\mathbf{v}}$}_{i,t%
})\}
t=1,\cdots,T
\{(\mbox{$\mathop{\mathbf{x}}\limits$}_{i,0},\mbox{$\mathop{\mathbf{v}}$}_{i,0%
})\}
T
\{(\mbox{$\mathop{\mathbf{x}}\limits$}_{i,T},\mbox{$\mathop{\mathbf{v}}$}_{i,T%
})\}
\mathcal{N}(\mathbf{0},\mathbf{I})
\mathcal{C}(\mathbf{1}/K)
\mathbf{I}
\mathbf{1}
\mathop{\mathsf{DIFF}}\limits
\mathop{\mathsf{DIFF}\text{-}\mathsf{backward}}\limits
\mathop{\mathsf{DIFF}}\limits
T
t
\mathop{\mathsf{DIFF}\text{-}\mathsf{forward}}\limits
t\in[1,T]
\{(\mbox{$\mathop{\mathbf{x}}\limits$}_{i,t-1},\mbox{$\mathop{\mathbf{v}}$}_{i%
,t-1})\}
i
(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1},\mbox{$\mathop{\mathbf{v}}$}_{t-1})
(\beta_{t}^{\mathtt{x}},\beta_{t}^{\mathtt{v}})\in(0,1)
\beta_{t}^{\mathtt{x}}
\beta_{t}^{\mathtt{v}}
\mathop{\mathsf{DIFF}\text{-}\mathsf{forward}}\limits
\mbox{$\mathop{\mathbf{x}}\limits$}_{t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}
q(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\mbox{$\mathop{\mathbf{x}}\limits$}_%
{t-1})
q(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\mbox{$\mathop{\mathbf{x}}\limits$}_%
{t-1})=\mathcal{N}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\sqrt{1-\beta^{%
\mathtt{x}}_{t}}\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1},\beta^{\mathtt{x}}_{%
t}\mathbf{I}),
\mathcal{N}(\cdot)
\mbox{$\mathop{\mathbf{x}}\limits$}_{t}
\sqrt{1-\beta_{t}^{\mathtt{x}}}\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}
\beta_{t}^{\mathtt{x}}\mathbf{I}
\mbox{$\mathop{\mathbf{v}}$}_{t}
K
\mbox{$\mathop{\mathbf{v}}$}_{t-1}
q(\mbox{$\mathop{\mathbf{v}}$}_{t}|\mbox{$\mathop{\mathbf{v}}$}_{t-1})=%
\mathcal{C}(\mbox{$\mathop{\mathbf{v}}$}_{t}|(1-\beta^{\mathtt{v}}_{t})\mbox{$%
\mathop{\mathbf{v}}$}_{t-1}+\beta^{\mathtt{v}}_{t}\mathbf{1}/K),
\mathcal{C}
\mbox{$\mathop{\mathbf{v}}$}_{t}
\mbox{$\mathop{\mathbf{v}}$}_{t-1}
\beta^{\mathtt{v}}_{t}\mathbf{1}/K
K
\mbox{$\mathop{\mathbf{x}}\limits$}_{t}
\mbox{$\mathop{\mathbf{v}}$}_{t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}
\mbox{$\mathop{\mathbf{v}}$}_{0}
\displaystyle q(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\mbox{$\mathop{\mathbf%
{x}}\limits$}_{0})=\mathcal{N}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\sqrt{%
\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{x}}_{t}}\mbox{$\mathop{\mathbf{%
x}}\limits$}_{0},(1-\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{x}}_{t})%
\mathbf{I}),
\displaystyle q(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\mbox{$\mathop{\mathbf%
{x}}\limits$}_{0})
\displaystyle=\mathcal{N}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}|\sqrt{\mbox{%
$\mathop{\bar{\alpha}}\limits$}^{\mathtt{x}}_{t}}\mbox{$\mathop{\mathbf{x}}%
\limits$}_{0},(1-\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{x}}_{t})%
\mathbf{I}),
\displaystyle q(\mbox{$\mathop{\mathbf{v}}$}_{t}|\mbox{$\mathop{\mathbf{v}}$}_%
{0})=\mathcal{C}(\mbox{$\mathop{\mathbf{v}}$}_{t}|\mbox{$\mathop{\bar{\alpha}}%
\limits$}^{\mathtt{v}}_{t}\mbox{$\mathop{\mathbf{v}}$}_{0}+(1-\mbox{$\mathop{%
\bar{\alpha}}\limits$}^{\mathtt{v}}_{t})\mathbf{1}/K),
\displaystyle q(\mbox{$\mathop{\mathbf{v}}$}_{t}|\mbox{$\mathop{\mathbf{v}}$}_%
{0})
\displaystyle=\mathcal{C}(\mbox{$\mathop{\mathbf{v}}$}_{t}|\mbox{$\mathop{\bar%
{\alpha}}\limits$}^{\mathtt{v}}_{t}\mbox{$\mathop{\mathbf{v}}$}_{0}+(1-\mbox{$%
\mathop{\bar{\alpha}}\limits$}^{\mathtt{v}}_{t})\mathbf{1}/K),
\displaystyle\text{where }\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{u}}_{%
t}=\prod\nolimits_{\tau=1}^{t}\alpha^{\mathtt{u}}_{\tau},\ \alpha^{\mathtt{u}}%
_{\tau}=1-\beta^{\mathtt{u}}_{\tau},\ {\mathtt{u}}={\mathtt{x}}\text{ or }{%
\mathtt{v}}.\;\;\;
\mathop{\bar{\alpha}}\limits
\displaystyle\text{where }\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{u}}_{t}
\mathop{\bar{\alpha}}\limits
\displaystyle=\prod\nolimits_{\tau=1}^{t}\alpha^{\mathtt{u}}_{\tau},\ \alpha^{%
\mathtt{u}}_{\tau}=1-\beta^{\mathtt{u}}_{\tau},\ {\mathtt{u}}={\mathtt{x}}%
\text{ or }{\mathtt{v}}.\;\;\;
\bar{\alpha}^{\mathtt{u}}_{t}
\mathtt{u}={\mathtt{x}}\text{ or }{\mathtt{v}}
t=[1,T]
t\rightarrow 1
\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{x}}_{t}
\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{v}}_{t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{t}
\mbox{$\mathop{\mathbf{v}}$}_{t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}
\mbox{$\mathop{\mathbf{v}}$}_{0}
t\rightarrow T
\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{x}}_{t}
\mbox{$\mathop{\bar{\alpha}}\limits$}^{\mathtt{v}}_{t}
q(\mbox{$\mathop{\mathbf{x}}\limits$}_{T}|\mbox{$\mathop{\mathbf{x}}\limits$}_%
{0})
\mathcal{N}(\mathbf{0},\mathbf{I})
q(\mbox{$\mathop{\mathbf{v}}$}_{T}|\mbox{$\mathop{\mathbf{v}}$}_{0})
\mathcal{C}(\mathbf{1}/K)
p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{\mathbf{x}}\limits$%
}_{t},\mbox{$\mathop{\mathbf{x}}\limits$}_{0})
\displaystyle p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{%
\mathbf{x}}\limits$}_{t},\mbox{$\mathop{\mathbf{x}}\limits$}_{0})=\mathcal{N}(%
\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mu(\mbox{$\mathop{\mathbf{x}}%
\limits$}_{t},\mbox{$\mathop{\mathbf{x}}\limits$}_{0}),\tilde{\beta}^{\mathtt{%
x}}_{t}\mathbf{I}),
\displaystyle p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{%
\mathbf{x}}\limits$}_{t},\mbox{$\mathop{\mathbf{x}}\limits$}_{0})=\mathcal{N}(%
\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mu(\mbox{$\mathop{\mathbf{x}}%
\limits$}_{t},\mbox{$\mathop{\mathbf{x}}\limits$}_{0}),\tilde{\beta}^{\mathtt{%
x}}_{t}\mathbf{I}),
\displaystyle\!\!\!\!\!\!\!\!\!\!\!\mu(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}%
,\mbox{$\mathop{\mathbf{x}}\limits$}_{0})\!=\!\frac{\sqrt{\bar{\alpha}^{%
\mathtt{x}}_{t-1}}\beta^{\mathtt{x}}_{t}}{1-\bar{\alpha}^{\mathtt{x}}_{t}}%
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}\!+\!\frac{\sqrt{\alpha^{\mathtt{x}}_{t%
}}(1-\bar{\alpha}^{\mathtt{x}}_{t-1})}{1-\bar{\alpha}^{\mathtt{x}}_{t}}\mbox{$%
\mathop{\mathbf{x}}\limits$}_{t},\tilde{\beta}^{\mathtt{x}}_{t}\!=\!\frac{1-%
\bar{\alpha}^{\mathtt{x}}_{t-1}}{1-\bar{\alpha}^{\mathtt{x}}_{t}}\beta^{%
\mathtt{x}}_{t}.\;\;\;
\displaystyle\!\!\!\!\!\!\!\!\!\!\!\mu(\mbox{$\mathop{\mathbf{x}}\limits$}_{t}%
,\mbox{$\mathop{\mathbf{x}}\limits$}_{0})\!=\!\frac{\sqrt{\bar{\alpha}^{%
\mathtt{x}}_{t-1}}\beta^{\mathtt{x}}_{t}}{1-\bar{\alpha}^{\mathtt{x}}_{t}}%
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}\!+\!\frac{\sqrt{\alpha^{\mathtt{x}}_{t%
}}(1-\bar{\alpha}^{\mathtt{x}}_{t-1})}{1-\bar{\alpha}^{\mathtt{x}}_{t}}\mbox{$%
\mathop{\mathbf{x}}\limits$}_{t},\tilde{\beta}^{\mathtt{x}}_{t}\!=\!\frac{1-%
\bar{\alpha}^{\mathtt{x}}_{t-1}}{1-\bar{\alpha}^{\mathtt{x}}_{t}}\beta^{%
\mathtt{x}}_{t}.\;\;\;
p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$%
\mathop{\mathbf{v}}$}_{0})
\displaystyle p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$%
}_{t},\mbox{$\mathop{\mathbf{v}}$}_{0})=\mathcal{C}(\mbox{$\mathop{\mathbf{v}}%
$}_{t-1}|\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{v}%
}$}_{0})),
\displaystyle p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$%
}_{t},\mbox{$\mathop{\mathbf{v}}$}_{0})=\mathcal{C}(\mbox{$\mathop{\mathbf{v}}%
$}_{t-1}|\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{v}%
}$}_{0})),
\displaystyle\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{%
\mathbf{v}}$}_{0})=\tilde{\mathbf{c}}/{\sum_{k=1}^{K}\tilde{c}_{k}},
\displaystyle\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{%
\mathbf{v}}$}_{0})=\tilde{\mathbf{c}}/{\sum_{k=1}^{K}\tilde{c}_{k}},
\displaystyle\tilde{\mathbf{c}}=[\alpha^{\mathtt{v}}_{t}\mbox{$\mathop{\mathbf%
{v}}$}_{t}+\frac{1-\alpha^{\mathtt{v}}_{t}}{K}]\odot[\bar{\alpha}^{\mathtt{v}}%
_{t-1}\mbox{$\mathop{\mathbf{v}}$}_{0}+\frac{1-\bar{\alpha}^{\mathtt{v}}_{t-1}%
}{K}],
\displaystyle\tilde{\mathbf{c}}=[\alpha^{\mathtt{v}}_{t}\mbox{$\mathop{\mathbf%
{v}}$}_{t}+\frac{1-\alpha^{\mathtt{v}}_{t}}{K}]\odot[\bar{\alpha}^{\mathtt{v}}%
_{t-1}\mbox{$\mathop{\mathbf{v}}$}_{0}+\frac{1-\bar{\alpha}^{\mathtt{v}}_{t-1}%
}{K}],
\tilde{c}_{k}
k
K
\tilde{\mathbf{c}}
\odot
\tilde{\mathbf{c}}
\mbox{$\mathop{\mathbf{v}}$}_{t}
\mbox{$\mathop{\mathbf{v}}$}_{0}
\mathop{\mathsf{DIFF}\text{-}\mathsf{backward}}\limits
\mathop{\mathsf{DIFF}}\limits
\mathop{\mathsf{DIFF}\text{-}\mathsf{forward}}\limits
(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{t})
(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1},\mbox{$\mathop{\mathbf{v}}$}_{t-1})
t\in[1,T]
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1},\mbox{$\mathop{\mathbf{v}}$}_{t-1})
(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{t})
p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{\mathbf{x}}\limits$%
}_{t},\mbox{$\mathop{\mathbf{x}}\limits$}_{0})
p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$%
\mathop{\mathbf{v}}$}_{0})
(\mbox{$\mathop{\mathbf{x}}\limits$}_{0},\mbox{$\mathop{\mathbf{v}}$}_{0})
f_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\mbox{$\mathop%
{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{H}^{\mathtt{s}}}\limits$})
t
(\mbox{$\mathop{\mathbf{x}}\limits$}_{0},\mbox{$\mathop{\mathbf{v}}$}_{0})
(\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t},\tilde{\mbox{$\mathop{%
\mathbf{v}}$}}_{0,t})=f_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}%
\limits$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{H}}%
\limits$}^{\mathtt{s}}),
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}
\mbox{$\mathop{\mathbf{v}}$}_{0}
t
{\boldsymbol{\Theta}}
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}
\mbox{$\mathop{\mathbf{x}}\limits$}_{t}
p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{\mathbf{x}}\limits$%
}_{t})
p_{\boldsymbol{\Theta}}((\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$%
\mathop{\mathbf{x}}\limits$}_{t},\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{%
0,t})
\displaystyle p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{%
\mathbf{x}}\limits$}_{t})\approx p_{\boldsymbol{\Theta}}(\mbox{$\mathop{%
\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\tilde{%
\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t})
\displaystyle p(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$\mathop{%
\mathbf{x}}\limits$}_{t})
\displaystyle\approx p_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits%
$}_{t-1}|\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\tilde{\mbox{$\mathop{\mathbf%
{x}}\limits$}}_{0,t})
\displaystyle=\mathcal{N}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mu_{%
\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\tilde{\mbox{$%
\mathop{\mathbf{x}}\limits$}}_{0,t}),\tilde{\beta}^{\mathtt{x}}_{t}\mathbf{I}),
\displaystyle=\mathcal{N}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mu_{%
\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\tilde{\mbox{$%
\mathop{\mathbf{x}}\limits$}}_{0,t}),\tilde{\beta}^{\mathtt{x}}_{t}\mathbf{I}),
\mu_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\tilde{\mbox%
{$\mathop{\mathbf{x}}\limits$}}_{0,t})
\mu(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\mbox{$\mathop{\mathbf{x}}\limits$%
}_{0})
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t}
\mbox{$\mathop{\mathbf{v}}$}_{t-1}
\mbox{$\mathop{\mathbf{v}}$}_{t}
p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t})
p_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{%
\mathbf{v}}$}_{t},\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t})
\displaystyle\!\!\!\!\!\!\!\!p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$%
\mathop{\mathbf{v}}$}_{t})\!\!\approx\!\!p_{\boldsymbol{\Theta}}(\mbox{$%
\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},\tilde{\mbox{$%
\mathop{\mathbf{v}}$}}_{0,t})\!\!=\!\!\mathcal{C}(\mbox{$\mathop{\mathbf{v}}$}%
_{t-1}|\mathbf{c}_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{v}}$}_{t},%
\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t})),
\displaystyle\!\!\!\!\!\!\!\!p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$%
\mathop{\mathbf{v}}$}_{t})\!\!\approx\!\!p_{\boldsymbol{\Theta}}(\mbox{$%
\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},\tilde{\mbox{$%
\mathop{\mathbf{v}}$}}_{0,t})\!\!=\!\!\mathcal{C}(\mbox{$\mathop{\mathbf{v}}$}%
_{t-1}|\mathbf{c}_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{v}}$}_{t},%
\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t})),
\mathbf{c}_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{v}}$}_{t},\tilde{\mbox%
{$\mathop{\mathbf{v}}$}}_{0,t})
\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{0})
\mbox{$\mathop{\mathbf{v}}$}_{0}
\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t}
\mathop{\mathsf{DIFF}\text{-}\mathsf{backward}}\limits
f_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\mbox{$\mathop%
{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{H}^{\mathtt{s}}}\limits$})
(\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t},\tilde{\mbox{$\mathop{%
\mathbf{v}}$}}_{0,t})
(\mbox{$\mathop{\mathbf{x}}\limits$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{t})
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
t
f_{\boldsymbol{\Theta}}(\cdot)
\mathop{\mathsf{EQ}\text{-}\mathsf{GNN}}\limits
\mathop{\mathsf{INV}\text{-}\mathsf{GNN}}\limits
\mathop{\mathcal{P}}\limits
\mathop{\mathsf{EQ}\text{-}\mathsf{GNN}}\limits
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}\in\mathbb{R}^{3}
a_{i}
l
\Delta\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}\!=\sum_{\mathclap{j\in N(a%
_{i}),i\neq j}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l}-\mbox{$\mathop{%
\mathbf{x}}\limits$}_{j}^{l})\text{MHA}^{\mathtt{x}}(d_{ij}^{l},\mbox{$\mathop%
{\mathbf{h}}\limits$}_{i}^{l+1},\mbox{$\mathop{\mathbf{h}}\limits$}_{j}^{l+1},%
\text{VN-In}(\mbox{$\mathop{\mathbf{H}^{\mathtt{s}}}\limits$})),
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}\!=\mbox{$\mathop{\mathbf{x}}%
\limits$}_{i}^{l}\!+\!\text{Mean}(\Delta{\mbox{$\mathop{\mathbf{x}}\limits$}_{%
i}^{l+1}})\!+\!\text{VN-Lin}(\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l},%
\Delta\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1},\mbox{$\mathop{\mathbf{H}^%
{\mathtt{s}}}\limits$}),
N(a_{i})
N
a_{i}
\Delta\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}\in\mathbb{R}^{n_{h}\times 3}
a_{i}
\text{MHA}^{\mathtt{x}}(\cdot)
\mathop{\mathsf{EQ}\text{-}\mathsf{GNN}}\limits
n_{h}
d_{ij}^{l}
i
j
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l}
\mbox{$\mathop{\mathbf{x}}\limits$}_{j}^{l}
l
\text{Mean}(\Delta{\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}})
\Delta\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}
\text{VN-Lin}(\cdot)\in\mathbb{R}^{3}
\text{VN-Lin}(\cdot)
\mathop{\mathbf{H}^{\mathtt{s}}}\limits
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l}
\Delta\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{l+1}
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}^{L}
L
\mathop{\mathsf{EQ}\text{-}\mathsf{GNN}}\limits
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{i,0}
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{i,0}=\mbox{$\mathop{\mathbf{x}}%
\limits$}_{i}^{L}.
\mathop{\mathsf{INV}\text{-}\mathsf{GNN}}\limits
\mbox{$\mathop{\mathbf{h}}\limits$}_{i}^{l+1}\in\mathbb{R}^{d_{h}}
i
a_{i}
l
\mathop{\mathsf{INV}\text{-}\mathsf{GNN}}\limits
\!\!\!\mbox{$\mathop{\mathbf{h}}\limits$}_{i}^{l+1}\!\!=\!\!\mbox{$\mathop{%
\mathbf{h}}\limits$}_{i}^{l}\!+\!\sum_{\mathclap{j\in N(a_{i}),i\neq j}}\text{%
MHA}^{\mathtt{h}}(d_{ij}^{l},\mbox{$\mathop{\mathbf{h}}\limits$}_{i}^{l},\mbox%
{$\mathop{\mathbf{h}}\limits$}_{j}^{l},\text{VN-In}(\mbox{$\mathop{\mathbf{H}^%
{\mathtt{s}}}\limits$})),\\
\mbox{$\mathop{\mathbf{h}}\limits$}_{i}^{0}\!=\!\mbox{$\mathop{\mathbf{v}}$}_{%
i},\!\!\!
\text{MHA}^{\mathtt{h}}(\cdot)\in\mathbb{R}^{d_{h}}
\mathop{\mathsf{INV}\text{-}\mathsf{GNN}}\limits
\mbox{$\mathop{\mathbf{h}}\limits$}_{i}^{L}
L
a_{i}
\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{i,0}=\text{softmax}(\text{MLP}(\mbox{$%
\mathop{\mathbf{h}}\limits$}_{i}^{L})).
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{DIFF}}\limits
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}
t
\displaystyle\mathcal{L}^{\mathtt{x}}_{t}({\mbox{$\mathop{\mathtt{M}}\limits$}%
})=w_{t}^{\mathtt{x}}\sum\nolimits_{\forall a\in{\scriptsize{\mbox{$\mathop{%
\mathtt{M}}\limits$}}}}\|\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}-%
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}\|^{2},
\displaystyle\mathcal{L}^{\mathtt{x}}_{t}({\mbox{$\mathop{\mathtt{M}}\limits$}%
})=w_{t}^{\mathtt{x}}\sum\nolimits_{\forall a\in{\scriptsize{\mbox{$\mathop{%
\mathtt{M}}\limits$}}}}\|\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}-%
\mbox{$\mathop{\mathbf{x}}\limits$}_{0}\|^{2},
\displaystyle\text{where}\ w_{t}^{\mathtt{x}}=\min(\lambda_{t},\delta),\ %
\lambda_{t}={\bar{\alpha}^{\mathtt{x}}_{t}}/({1-\bar{\alpha}^{\mathtt{x}}_{t}}),
\displaystyle\text{where}\ w_{t}^{\mathtt{x}}=\min(\lambda_{t},\delta),\ %
\lambda_{t}={\bar{\alpha}^{\mathtt{x}}_{t}}/({1-\bar{\alpha}^{\mathtt{x}}_{t}}),
w_{t}^{\mathtt{x}}
t
\lambda_{t}>0
\delta>0
\bar{\alpha}_{t}^{\mathtt{x}}
t
T
w_{t}^{\mathtt{x}}
t
w_{t}^{\mathtt{x}}
\mathtt{x}_{t}
t
\mathop{\mathsf{ShapeMol}}\limits
p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$%
\mathop{\mathbf{v}}$}_{0})
p_{\theta}(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t}%
,\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t})
\mathop{\mathsf{DIFF}}\limits
t
\mathcal{L}^{\mathtt{v}}_{t}({\mbox{$\mathop{\mathtt{M}}\limits$}})=\sum%
\nolimits_{\forall a\in\scriptsize{\mbox{$\mathop{\mathtt{M}}\limits$}}}\text{%
KL}(p(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},%
\mbox{$\mathop{\mathbf{v}}$}_{0})|p_{\boldsymbol{\Theta}}(\mbox{$\mathop{%
\mathbf{v}}$}_{t-1}|\mbox{$\mathop{\mathbf{v}}$}_{t},\tilde{\mbox{$\mathop{%
\mathbf{v}}$}}_{0,t})),
\!\!\!\!\!\!\!\!\!\!\!\!=\sum\nolimits_{\forall a\in\scriptsize{\mbox{$\mathop%
{\mathtt{M}}\limits$}}}\text{KL}(\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},%
\mbox{$\mathop{\mathbf{v}}$}_{0})|\mathbf{c}_{\boldsymbol{\Theta}}(\mbox{$%
\mathop{\mathbf{v}}$}_{t},\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t})),
\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{0})
\mbox{$\mathop{\mathbf{v}}$}_{t-1}
\mathbf{c}_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{v}}$}_{t},\tilde{\mbox%
{$\mathop{\mathbf{v}}$}}_{0,t})
\mathbf{c}(\mbox{$\mathop{\mathbf{v}}$}_{t},\mbox{$\mathop{\mathbf{v}}$}_{0})
\mathop{\mathsf{ShapeMol}}\limits
\mathcal{L}=\sum\nolimits_{\forall\scriptsize{\mbox{$\mathop{\mathtt{M}}%
\limits$}}\in\mathcal{M}}\sum\nolimits_{\forall t\in\mathcal{T}}(\mathcal{L}^{%
\mathtt{x}}_{t}(\mbox{$\mathop{\mathtt{M}}\limits$})+\xi\mathcal{L}^{\mathtt{v%
}}_{t}(\mbox{$\mathop{\mathtt{M}}\limits$})),
\mathcal{M}
\mathcal{T}
\xi>0
\mathcal{L}^{\mathtt{x}}_{t}
\mathop{\mathtt{M}}\limits
\mathcal{L}^{\mathtt{v}}_{t}
\mathop{\mathtt{M}}\limits
t
\{1,2,\cdots,1000\}
\mathop{\mathsf{ShapeMol}}\limits
(\mbox{$\mathop{\mathbf{x}}\limits$}_{T},\mbox{$\mathop{\mathbf{v}}$}_{T})
(\mbox{$\mathop{\mathbf{x}}\limits$}_{0},\mbox{$\mathop{\mathbf{v}}$}_{0})
\mathop{\mathsf{ShapeMol}}\limits
\mbox{$\mathop{\mathbf{x}}\limits$}_{T}
\mbox{$\mathop{\mathbf{v}}$}_{T}
\mathcal{N}(\mathbf{0},\mathbf{I})
\mathcal{C}(\mathbf{1}/K)
\mathop{\mathsf{ShapeMol}}\limits
\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}
\mbox{$\mathop{\mathbf{x}}\limits$}_{t}
p_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{x}}\limits$}_{t-1}|\mbox{$%
\mathop{\mathbf{x}}\limits$}_{t},\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{%
0,t})
\mathop{\mathsf{ShapeMol}}\limits
\mbox{$\mathop{\mathbf{v}}$}_{t-1}
\mbox{$\mathop{\mathbf{v}}$}_{t}
p_{\boldsymbol{\Theta}}(\mbox{$\mathop{\mathbf{v}}$}_{t-1}|\mbox{$\mathop{%
\mathbf{v}}$}_{t},\tilde{\mbox{$\mathop{\mathbf{v}}$}}_{0,t})
t
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mathcal{Q}
\mathop{\mathtt{M}_{x}}\limits
a_{i}
\mathop{\mathtt{M}_{x}}\limits
\mathcal{Q}
\mbox{$\mathop{\mathbf{x}}\limits$}_{i}
\phi
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
t
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathtt{M}_{x}}\limits
\displaystyle\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\mbox{$\mathop{\mathbf{x}}\limits$}%
_{0,t}^{*}\!\!=\!\!(1\!-\!\sigma)\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{%
0,t}\!\!+\!\sigma\!{\sum_{\mathclap{\mathbf{z}\in n(\tilde{\scriptsize{\mbox{$%
\mathop{\mathbf{x}}\limits$}}}_{0,t};\mathcal{Q})}}\mathbf{z}}/{n},\text{when %
}\!\!\sum_{\mathclap{\mathbf{z}\in n(\tilde{\scriptsize{\mbox{$\mathop{\mathbf%
{x}}\limits$}}}_{0,t};\mathcal{Q})}}d(\tilde{\mbox{$\mathop{\mathbf{x}}\limits%
$}}_{0,t},\mathbf{z})/n\!>\!\gamma,
\displaystyle\!\!\!\!\!\!\!\!\!\!\!\!\!\!\!\mbox{$\mathop{\mathbf{x}}\limits$}%
_{0,t}^{*}\!\!=\!\!(1\!-\!\sigma)\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{%
0,t}\!\!+\!\sigma\!{\sum_{\mathclap{\mathbf{z}\in n(\tilde{\scriptsize{\mbox{$%
\mathop{\mathbf{x}}\limits$}}}_{0,t};\mathcal{Q})}}\mathbf{z}}/{n},\text{when %
}\!\!\sum_{\mathclap{\mathbf{z}\in n(\tilde{\scriptsize{\mbox{$\mathop{\mathbf%
{x}}\limits$}}}_{0,t};\mathcal{Q})}}d(\tilde{\mbox{$\mathop{\mathbf{x}}\limits%
$}}_{0,t},\mathbf{z})/n\!>\!\gamma,
\sigma>0
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
d(\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t},\mathbf{z})
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
\mathbf{z}
n(\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t};\mathcal{Q})
n
\tilde{\mbox{$\mathop{\mathbf{x}}\limits$}}_{0,t}
\mathcal{Q}
d(\cdot)
\gamma>0
\mathop{\mathtt{M}_{x}}\limits
t=T,T-1,\cdots,S\text{, where }S>1,
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{-}\mathsf{enc}}\limits
\mathop{\mathsf{DIFF}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{SQUID}}\limits
\lambda=0.3
1.0
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{VS}}\limits
\mbox{$\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits$}(\mbox{$\mathop{\mathtt{s}}%
\limits$}_{x},\mbox{$\mathop{\mathtt{s}}\limits$}_{y})
\mbox{$\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits$}(\mbox{$\mathop{\mathtt{M}_{%
x}}\limits$},\mbox{$\mathop{\mathtt{M}_{y}}\limits$})
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{div}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{div}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{g}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{g}}}\limits
\mathop{\mathsf{div}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{g}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{g}}}\limits
\mathop{\mathsf{div}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\pm
\mathop{\mathsf{VS}}\limits
\pm
\pm
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\pm
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\pm
\pm
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{g}}}\limits
\pm
\pm
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\pm
\pm
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\pm
\pm
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\pm
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\lambda
\pm
\mathop{\mathsf{SQUID}}\limits
\lambda
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{ShapeMol}}\limits
w^{\mathtt{x}}_{t}
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
w^{\mathtt{x}}_{t}
\mathop{\mathsf{ShapeMol}}\limits
w^{\mathtt{x}}_{t}
\mathop{\mathsf{DIFF}}\limits
w^{\mathtt{x}}_{t}
\delta=10
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
98.8\%
89.4\%
0.748
0.660
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
w^{\mathtt{x}}_{t}
\gamma
S
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{g}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{g}}}\limits
\gamma
S
\gamma
S
\mathop{\mathsf{DIFF}}\limits
\gamma
S
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\gamma
S
S=50
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\gamma
0.2
0.6
\gamma=0.2
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
S
50
300
\mathop{\mathsf{ShapeMol}}\limits
\gamma
S
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
\mathop{\mathsf{maxSim}_{\mathtt{s}}}\limits
\gamma=0.2
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{avgSim}_{\mathtt{s}}}\limits
S
50
300
\gamma
S
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{x}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathsf{VS}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathsf{SQUID}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathtt{M}_{y}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{Sim}_{\mathtt{s}}}\limits
\mathop{\mathsf{Sim}_{\mathtt{g}}}\limits
\mathop{\mathsf{QED}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
\mathop{\mathsf{ShapeMol}}\limits
\mathop{\mathsf{ShapeMol}\text{+}\mathsf{g}}\limits
