\Pi=\{\pi_{1},\pi_{2},\dots,\pi_{m}\}
D_{\Pi}
\mathcal{A}_{DR}
D^{\Pi}_{stable}
D^{\Pi}_{unst}
\pi_{private}
\Pi=\{\pi_{1},\pi_{2},\dots,\pi_{m}\}
D_{\Pi}
\mathcal{A}_{DR}
D^{\Pi}_{stable}
D^{\Pi}_{unst}
\pi_{private}
D^{\Pi}_{stable}
D^{\Pi}\setminus D^{\Pi}_{stable}
\varepsilon
\pi_{\beta}
\pi
\mathcal{M}=\langle S,A,r,P,\rho_{0},\gamma\rangle
S
A
r:S\times A\rightarrow\mathbb{R}
P:S\times A\to\Delta(S)
\Delta(\mathcal{X})
\mathcal{X}
\rho_{0}\in\Delta(S)
\gamma\in[0,1]
\mathcal{M}=\langle S,A,r,P,\rho_{0},\gamma\rangle
D=\{(s_{i},a_{i},r_{i},s_{i}^{\prime})_{i}\}_{i=1}^{n}
(s_{i},a_{i})\sim\mu
\mu
r_{i}=r(s_{i},a_{i})
s_{i}^{\prime}\sim P(\cdot|s_{i},a_{i})
\pi^{*}:S\rightarrow\Delta(A)
\pi^{*}=\underset{\pi}{\mathop{argmax}}\;\mathbb{E}^{\pi}_{s_{0}\sim\rho_{0}}[%
R_{\tau}]
R_{\tau}=\sum_{t=0}^{\infty}\gamma^{t}r_{t}
\tau
\pi
\mathcal{M}
s_{0}\sim\rho_{0}
a_{t}\sim\pi(.|s_{t})
r_{t}=r(s_{t},a_{t})
s_{t+1}\sim P(.|s_{t},a_{t})
t\geq 0
\pi
\pi
\Pi=\{\pi_{1},\dots,\pi_{m}\}
(\varepsilon,\delta)
\varepsilon>0
0\leq\delta\leq 1
\mathcal{A}
(\varepsilon,\delta)
D,D^{\prime}\in\mathcal{D}^{*}
\mathcal{D}
S\subset Range(\mathcal{A})
Pr(\mathcal{A}(D)\in S)\leq e^{\varepsilon}Pr(\mathcal{A}(D^{\prime})\in S)+\delta
Range(\mathcal{A})
\mathcal{A}
e^{\varepsilon}
\delta
\varepsilon\leq 10
\delta=n^{-1.1}
n
\mathcal{D}
D^{\Pi}\in\mathcal{D}^{*}
\Pi
D^{\Pi},D^{\Pi^{\prime}}\in\mathcal{D}^{*}
|\Pi\Delta\Pi^{\prime}|=1
\Delta
D,D^{\prime}\in\mathcal{D}^{*}
|D\Delta D^{\prime}|=1
D
D^{\prime}
\pi
|D^{\pi}|
D^{\pi}
\pi
P
r
\Pi
m
m
\Pi=\{\pi_{1},\dots,\pi_{m}\}
D^{\Pi}=\{D^{\pi_{1}},\dots,D^{\pi_{m}}\}
m
D^{\pi_{i}}
N
\tau=(s_{1},a_{2},s_{2},a_{2},\dots,s_{L},a_{L},s_{L+1})
L
\pi_{i}
\mathcal{M}=\langle S,A,r,P,\rho_{0},\gamma\rangle
s_{1}\sim\rho_{0}
a_{h}\sim\pi_{i}(\cdot|s_{h})
s_{h+1}\sim P(\cdot|s_{h},a_{h})
|\tau|
\tau_{h:h^{\prime}}=(s_{h},a_{h},\dots s_{h},a_{h},s_{h^{\prime}+1})
\tau
h
h^{\prime}
s_{h^{\prime}+1}
D^{\Pi}
D^{\Pi^{\prime}}
A
\pi_{i}(a|s)
i,s
a
p_{\min}\in(0,1/|A|)
\Pi_{p_{\min}}=\{\pi\colon\inf_{s\in S}\min_{a\in A}\pi(a|s)\geq p_{\min}\},
p_{\min}
\Pi\subseteq\Pi_{p_{\min}}
\Pi_{p_{\min}}
p_{\min}
\tau_{k}
\tau_{k}
count_{\tau_{k}}(\Pi)=\sum_{i=1}^{m}\left[\prod_{j=1}^{k}\pi_{i}(a_{j}|s_{j})\right]
\tau
h\in[1,L]
\tau
count_{\tau}(\pi)
\tau
\mathcal{A}_{PQ}
\Pi
\tau=(s_{1},a_{1},s_{2},a_{2},\dots)
\hat{\theta}
\varepsilon
count_{\tau}(\Pi)\leftarrow\sum_{\pi\in\Pi}\prod_{j=1}^{|\tau|}\pi(a_{j}|s_{j})
count_{\tau}(\Pi)+Lap(\frac{4}{\varepsilon})>\hat{\theta}
\top
\perp
\mathcal{A}_{DR})
D^{\Pi}
\Pi
\varepsilon_{1}
\delta_{1}
p_{min}
T\leq N\cdot m
L
\varepsilon^{\prime}\leftarrow\frac{\varepsilon_{1}}{\sqrt{32T\log(2/\delta_{1%
})}},\quad\delta^{\prime}\leftarrow\frac{\delta_{1}}{(2TL)}
c_{min}\leftarrow\frac{e^{\varepsilon^{\prime}}}{(e^{\varepsilon^{\prime}}-1)}%
,\quad\theta\leftarrow\frac{c_{min}}{p_{min}},\quad D^{\Pi}_{stable}\leftarrow\{\}
D^{\Pi}
c=1,\dots,T
\tau\leftarrow
D^{\Pi}
\hat{\theta}\leftarrow\theta+\frac{4}{\varepsilon^{\prime}}\log(1/\delta^{%
\prime})+Lap(\frac{2}{\varepsilon^{\prime}})
i=1
L
r\leftarrow\mathcal{A}_{PQ}(\Pi,\tau_{1:i},\hat{\theta},\varepsilon^{\prime})
r=\top
i=L
D^{\Pi}_{stable}\leftarrow D^{\Pi}_{stable}\cup\{\tau_{1:i}\}
i\neq 1
D^{\Pi}_{stable}\leftarrow D^{\Pi}_{stable}\cup\{\tau_{1:i-1}\}
D^{\Pi}_{stable}
T
D^{\Pi}_{stable}
T
T
D^{\Pi}_{stable}
D^{\Pi}_{unst}=\{\tau_{k+1:L}\mbox{ if }\tau_{1:k}\in D^{\Pi}_{stable}\mbox{ %
for $k\geq 1$ or }\tau,~{}~{}\tau:D^{\Pi}\}
k\geq 1
\mathcal{H}_{\phi}
(s,a,r,s^{\prime})
D^{\Pi}_{stable}
\mathcal{H}_{\phi}
D^{\Pi}_{unst}
D^{\Pi}_{stable}
D^{\Pi}_{stable}
D^{\Pi}_{unst}
p
\mathcal{H}_{\phi}
\varepsilon_{2},\delta_{2}
N
B
\phi_{0}
n=1
N
b\sim Bernoulli(p)
b=1
p
\mathcal{B}\sim D^{\Pi}_{unst}
\phi_{n+1}\leftarrow
\phi_{n},\mathcal{B},\varepsilon_{2},\delta_{2},N
1-p
\mathcal{B}\sim D^{\Pi}_{stable}
\phi_{n+1}\leftarrow
\phi_{n},\mathcal{B}
\mathcal{H}_{\phi_{N}}
p
D^{\Pi}_{unst}
\phi_{n},\mathcal{B},\varepsilon_{2},\delta_{2},N
(\varepsilon_{2},\delta_{2})
q
q=p\cdot\frac{|B|}{m}
m
L
T
\mathcal{A}_{1},\mathcal{A}_{2}
\mathcal{A}_{1}
\pi\sim\mathrm{Unif}(\Pi)
\tau\sim\pi
L
Q^{\tau}=\{count_{\tau_{1}}(.),...,count_{\tau_{L}}(.)\}
\mathcal{A}_{2}
\Pi
Q^{\tau}
\mathcal{A}_{2}
\Pi
Q^{\tau}
\hat{\theta}
\mathcal{A}_{2}(\Pi,Q^{\tau})
r\in\{\top,\bot\}^{k+1}
r[i]=\top\;\forall\;i\leq k
r[k+1]=\bot
k\leq L
r[i]=\mathcal{A}_{PQ}(\Pi,\tau_{1:i},\hat{\theta},\varepsilon^{\prime})
\mathcal{A}_{1}
r
\tau_{1:k}=(s_{1},a_{1},\dots,s_{k},a_{k},s_{k+1})
Q^{\tau}
\mathcal{A}_{2}
(\varepsilon^{\prime},0)
\tau
\mathcal{A}_{2}
\varepsilon^{\prime}
Q^{\tau}
\Pi
\mathcal{A}=\mathcal{A}_{1}\circ\mathcal{A}_{2}
T
\mathcal{A}_{DR}
\mathcal{A}
T
\mathcal{A}
\tau_{k}
k
E_{\tau}
\mathcal{A}_{1}
\tau^{\prime}
\tau_{k}
\tau^{\prime}_{1:k}=\tau_{k}
\tau_{k}
\Pi,\Pi^{\prime}
count_{\tau_{k}}(\Pi)\geq c_{min}
\Pr(E_{\tau_{k}}|\Pi)\leq e^{\varepsilon^{\prime}}\Pr(E_{\tau_{k}}|\Pi^{\prime})
c_{min}
\varepsilon^{\prime}
\tau_{k}
\mathcal{A}_{1}
\tau_{k}
\tau_{k}
\Pi
count_{\tau_{k}}(\Pi)<\theta
\Pr(\mathcal{A}_{PQ}(\Pi,\tau_{k},\hat{\theta},\varepsilon^{\prime})=\top)<%
\delta^{\prime}
\varepsilon^{\prime},\delta^{\prime},\theta,\hat{\theta}
\tau_{k}
\delta^{\prime}
\mathcal{A}
(2\varepsilon^{\prime},\frac{\delta_{1}}{2T})
\varepsilon^{\prime},\delta_{1}
\Pr(\mathcal{A}(\Pi)=\tau)\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{%
\prime})=\tau)+\Pr(E_{\tau}|\Pi)\cdot\delta^{\prime}
\mathcal{T}
S,A
\mathcal{A}
(2\varepsilon^{\prime},\delta_{1}/(2T))
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
\displaystyle\sum_{\tau\in\mathcal{T}}\max\{\Pr(\mathcal{A}(\Pi)=\tau)-e^{2%
\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau),0\}
\displaystyle\sum_{\tau\in\mathcal{T}}\max\{\Pr(\mathcal{A}(\Pi)=\tau)-e^{2%
\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau),0\}
\displaystyle\leq\frac{\delta_{1}}{2T}.
\displaystyle\leq\frac{\delta_{1}}{2T}.
\tau_{k}
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
count_{\tau_{k}}(\Pi)<c_{min}
\Pr(\mathcal{A}(\Pi)=\tau_{k})<\Pr(E_{\tau_{k}}|\Pi)\cdot\delta^{\prime}.
count_{\tau_{k}}(\Pi)\geq c_{min}
\Pr(\mathcal{A}(\Pi)={\tau_{k}})\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(%
\Pi^{\prime})={\tau_{k}})+\Pr(E_{\tau_{k}}|\Pi)\cdot\delta^{\prime}
r=\top\cdots\top\bot\in\{\top,\perp\}^{k+1}
\gamma^{(L)}=\top^{L}
k<L
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{k})
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{k})
\displaystyle=\sum_{a\in A}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=%
r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle=\sum_{a\in A}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=%
r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\tau_{k}\cdot a
\tau_{k}
a
k=L
\Pr(\mathcal{A}(\Pi)=\tau_{k})=\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau}_{k})=\gamma^{(%
L)})\Pr(E_{\tau_{k}}|\Pi)
1e6
1e6
k=L
count_{\tau_{k}}(\Pi)
\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau}_{k})=\gamma^{(L)})
\delta^{\prime}
count_{\tau_{k}}(\Pi)
c_{min}
\Pr(E_{\tau_{k}}|\Pi)
\mathcal{A}_{2}
\varepsilon^{\prime}
k<L
a\in A
count_{\tau_{k}\cdot a}(\Pi)\geq c_{min}
count_{\tau_{k}\cdot a}(\Pi)<c_{min}
(\varepsilon_{1},\delta_{1})
\mathcal{A}
T
\mathcal{A}
(\varepsilon_{1}/\sqrt{8T\log(2/\delta_{1})},\delta_{1}/(2T))
(\varepsilon_{1},\delta_{1})
(\varepsilon,\delta)
\varepsilon=\varepsilon_{1}+\varepsilon_{2}\quad\text{and}\quad\delta=\delta_{%
1}+\delta_{2}
D^{\Pi}_{stable}
D^{\Pi}_{unst}
>75\%
\sim 47.9\%
3000
p
10
\varepsilon=10
\delta=1/m
m
10
1e6
10
1e6
\varepsilon
\varepsilon
\varepsilon
\varepsilon
D_{stable}^{\Pi}
\mathcal{D}^{\Pi}_{stable}
1-p
\mathcal{D}^{\Pi}_{stable}
1-p
\varepsilon
95\%
\varepsilon_{1}=0,\varepsilon_{2}=\varepsilon
\varepsilon
\varepsilon
\varepsilon\leq 5
\varepsilon\leq 2.5
\varepsilon
\varepsilon_{1}=\frac{3\varepsilon}{4},\varepsilon_{2}=\frac{\varepsilon}{4}
\varepsilon_{1}=\varepsilon,\varepsilon_{2}=0
D_{stable}^{\Pi}
\delta
\delta_{1}=\frac{9\delta}{10},\delta_{2}=\frac{\delta}{10}
E_{\tau_{k}}
\tau_{k}
\tau_{k}=s_{1},a_{1},s_{2},\ldots,a_{k},s_{k+1}
\pi
\rho_{0}(s_{1})\left(\Pi_{j=1}^{k}\pi(a_{j}|s_{j})P(s_{j+1}|s_{j},a_{j})\right)
\displaystyle\Pr(E_{\tau_{k}}|\Pi)=\frac{1}{m}\sum_{i=1}^{m}\left[\rho_{0}(s_{%
1})\left(\Pi_{j=1}^{k}\pi_{i}(a_{j}|s_{j})P(s_{j+1}|s_{j},a_{j})\right)\right]
\displaystyle\Pr(E_{\tau_{k}}|\Pi)
\displaystyle=\frac{1}{m}\sum_{i=1}^{m}\left[\rho_{0}(s_{1})\left(\Pi_{j=1}^{k%
}\pi_{i}(a_{j}|s_{j})P(s_{j+1}|s_{j},a_{j})\right)\right]
\displaystyle=\frac{1}{m}\rho_{0}(s_{1})\left(\Pi_{j=1}^{k}P(s_{j+1}|s_{j},a_{%
j})\right)\sum_{i=1}^{m}\left(\Pi_{j=1}^{k}\pi_{i}(a_{j}|s_{j})\right)
\displaystyle=\frac{1}{m}\rho_{0}(s_{1})\left(\Pi_{j=1}^{k}P(s_{j+1}|s_{j},a_{%
j})\right)\sum_{i=1}^{m}\left(\Pi_{j=1}^{k}\pi_{i}(a_{j}|s_{j})\right)
\displaystyle=\frac{1}{m}\rho_{0}(s_{1})\left(\Pi_{j=1}^{k}P(s_{j+1}|s_{j},a_{%
j})\right)count_{\tau_{k}}(\Pi)\enspace.
\displaystyle=\frac{1}{m}\rho_{0}(s_{1})\left(\Pi_{j=1}^{k}P(s_{j+1}|s_{j},a_{%
j})\right)count_{\tau_{k}}(\Pi)\enspace.
\displaystyle\Pr(E_{\tau_{k}}|\Pi^{\prime})=\frac{1}{m^{\prime}}\rho_{0}(s_{1}%
)\left(\Pi_{j=1}^{k}P(s_{j+1}|s_{j},a_{j})\right)count_{\tau_{k}}(\Pi^{\prime}%
)\enspace.
\displaystyle\Pr(E_{\tau_{k}}|\Pi^{\prime})=\frac{1}{m^{\prime}}\rho_{0}(s_{1}%
)\left(\Pi_{j=1}^{k}P(s_{j+1}|s_{j},a_{j})\right)count_{\tau_{k}}(\Pi^{\prime}%
)\enspace.
m^{\prime}=|\Pi^{\prime}|
|\Pi\Delta\Pi^{\prime}|=1
\displaystyle|count_{\tau_{k}}(\Pi)-count_{\tau_{k}}(\Pi^{\prime})|\leq 1\quad%
\text{and}\quad|m-m^{\prime}|=1\enspace.
\displaystyle|count_{\tau_{k}}(\Pi)-count_{\tau_{k}}(\Pi^{\prime})|\leq 1\quad%
\text{and}\quad|m-m^{\prime}|=1\enspace.
\displaystyle\frac{\Pr(E_{\tau_{k}}|\Pi)}{\Pr(E_{\tau_{k}}|\Pi^{\prime})}=%
\frac{count_{\tau_{k}}(\Pi)\times m^{\prime}}{count_{\tau_{k}}(\Pi^{\prime})%
\times m}
\displaystyle\frac{\Pr(E_{\tau_{k}}|\Pi)}{\Pr(E_{\tau_{k}}|\Pi^{\prime})}
\displaystyle=\frac{count_{\tau_{k}}(\Pi)\times m^{\prime}}{count_{\tau_{k}}(%
\Pi^{\prime})\times m}
\displaystyle\leq\max\left(\frac{count_{\tau_{k}}(\Pi)(m+1)}{(count_{\tau_{k}}%
(\Pi)+1)m},\frac{count_{\tau_{k}}(\Pi)(m-1)}{(count_{\tau_{k}}(\Pi)-1)m},\frac%
{m+1}{m},\frac{m-1}{m}\right)
\displaystyle\leq\max\left(\frac{count_{\tau_{k}}(\Pi)(m+1)}{(count_{\tau_{k}}%
(\Pi)+1)m},\frac{count_{\tau_{k}}(\Pi)(m-1)}{(count_{\tau_{k}}(\Pi)-1)m},\frac%
{m+1}{m},\frac{m-1}{m}\right)
\displaystyle=\max\left(\frac{count_{\tau_{k}}(\Pi)(m-1)}{(count_{\tau_{k}}(%
\Pi)-1)m},\frac{m+1}{m}\right)\enspace.
\displaystyle=\max\left(\frac{count_{\tau_{k}}(\Pi)(m-1)}{(count_{\tau_{k}}(%
\Pi)-1)m},\frac{m+1}{m}\right)\enspace.
m+1>count_{\tau_{k}}(\Pi)
\displaystyle\frac{m+1}{m}<\frac{count_{\tau_{k}}(\Pi)}{count_{\tau_{k}}(\Pi)-1}
\displaystyle\frac{m+1}{m}<\frac{count_{\tau_{k}}(\Pi)}{count_{\tau_{k}}(\Pi)-1}
\displaystyle\max\left(\frac{count_{\tau_{k}}(\Pi)(m-1)}{(count_{\tau_{k}}(\Pi%
)-1)m},\frac{m+1}{m}\right)<\frac{count_{\tau_{k}}(\Pi)}{count_{\tau_{k}}(\Pi)%
-1}\enspace.
\displaystyle\max\left(\frac{count_{\tau_{k}}(\Pi)(m-1)}{(count_{\tau_{k}}(\Pi%
)-1)m},\frac{m+1}{m}\right)<\frac{count_{\tau_{k}}(\Pi)}{count_{\tau_{k}}(\Pi)%
-1}\enspace.
E_{\tau_{k}}
\Pi
\Pi^{\prime}
\displaystyle\frac{\Pr(E_{\tau_{k}}|\Pi)}{\Pr(E_{\tau_{k}}|\Pi^{\prime})}<%
\frac{count_{\tau_{k}}(\Pi)}{count_{\tau_{k}}(\Pi)-1}\leq e^{\varepsilon^{%
\prime}}\enspace,
\displaystyle\frac{\Pr(E_{\tau_{k}}|\Pi)}{\Pr(E_{\tau_{k}}|\Pi^{\prime})}<%
\frac{count_{\tau_{k}}(\Pi)}{count_{\tau_{k}}(\Pi)-1}\leq e^{\varepsilon^{%
\prime}}\enspace,
count_{\tau}(\Pi)\geq c_{min}=e^{\varepsilon^{\prime}}/(e^{\varepsilon^{\prime%
}}-1)
\displaystyle\Pr(\mathcal{A}_{PQ}(\Pi,\tau,\hat{\theta},\varepsilon^{\prime})=%
\top)=\Pr\left[count_{\tau_{k}}(\Pi)+Lap(4/\varepsilon^{\prime})>\theta+(4/%
\varepsilon^{\prime})\log(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]
\displaystyle\Pr(\mathcal{A}_{PQ}(\Pi,\tau,\hat{\theta},\varepsilon^{\prime})=\top)
\displaystyle=\Pr\left[count_{\tau_{k}}(\Pi)+Lap(4/\varepsilon^{\prime})>%
\theta+(4/\varepsilon^{\prime})\log(1/\delta^{\prime})+Lap(2/\varepsilon^{%
\prime})\right]
\displaystyle<\Pr\left[\theta+Lap(4/\varepsilon^{\prime})>\theta+(4/%
\varepsilon^{\prime})\log(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]
\displaystyle<\Pr\left[\theta+Lap(4/\varepsilon^{\prime})>\theta+(4/%
\varepsilon^{\prime})\log(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]
\displaystyle=\Pr\left[Lap(4/\varepsilon^{\prime})>(4/\varepsilon^{\prime})%
\log(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]
\displaystyle=\Pr\left[Lap(4/\varepsilon^{\prime})>(4/\varepsilon^{\prime})%
\log(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]
u\sim Lap(4/\varepsilon^{\prime})
v\sim Lap(2/\varepsilon^{\prime})
v
\displaystyle\Pr\left[u\geq(4/\varepsilon^{\prime})\log(1/\delta^{\prime})+v%
\right]\leq\frac{\delta^{\prime}}{2}e^{-v(\varepsilon^{\prime}/4)}
\displaystyle\Pr\left[u\geq(4/\varepsilon^{\prime})\log(1/\delta^{\prime})+v%
\right]\leq\frac{\delta^{\prime}}{2}e^{-v(\varepsilon^{\prime}/4)}
v
\displaystyle\Pr\left[Lap(4/\varepsilon^{\prime})>(4/\varepsilon^{\prime})\log%
(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]\leq\int_{-\infty}^{%
\infty}\left(\frac{\delta^{\prime}}{2}e^{-v(\varepsilon^{\prime}/4)}\times%
\frac{\varepsilon^{\prime}}{4}e^{-|v|(\varepsilon^{\prime}/2)}\right)dv
\displaystyle\Pr\left[Lap(4/\varepsilon^{\prime})>(4/\varepsilon^{\prime})\log%
(1/\delta^{\prime})+Lap(2/\varepsilon^{\prime})\right]
\displaystyle\leq\int_{-\infty}^{\infty}\left(\frac{\delta^{\prime}}{2}e^{-v(%
\varepsilon^{\prime}/4)}\times\frac{\varepsilon^{\prime}}{4}e^{-|v|(%
\varepsilon^{\prime}/2)}\right)dv
\displaystyle<\delta^{\prime}
\displaystyle<\delta^{\prime}
count_{\tau_{k}}(\Pi)<c_{min}
k<L
count_{\tau_{k}}(\Pi)\geq c_{min}
k<L
k=L
\tau_{k},k<L
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
count_{\tau_{k}}(\Pi)<c_{min}
\Pr(\mathcal{A}(\Pi)=\tau_{k})<\Pr(E_{\tau_{k}}|\Pi)\delta^{\prime}
\delta^{\prime}
r=\top\cdots\top\bot\in\{\top,\perp\}^{k+1}
\Pr(\mathcal{A}(\Pi)=\tau_{k})=\sum_{a\in A}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{%
\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\tau_{k}\cdot a
\tau_{k}
a
\mathcal{A}_{2}
Q^{\tau_{k}\cdot a}
\top\cdots\top\bot
\top
\bot
\mathcal{A}_{PQ}
\mathcal{A}_{2}
r
\top
k^{th}
\mathcal{A}_{PQ}
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=r)\leq\Pr(\mathcal{A%
}_{PQ}(\Pi,\tau_{k},\hat{\theta},\varepsilon^{\prime})=\top)
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=r)\leq\Pr(\mathcal{A%
}_{PQ}(\Pi,\tau_{k},\hat{\theta},\varepsilon^{\prime})=\top)
\forall a
count_{\tau}(\Pi)<c_{min}<\theta
\theta=c_{min}/p_{min}
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=r)\leq\delta^{\prime}
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=r)\leq\delta^{\prime}
\Pr(\mathcal{A}(\Pi)=\tau_{k})<\delta^{\prime}\sum_{a\in A}\Pr(E_{\tau_{k}%
\cdot a}|\Pi)=\delta^{\prime}\Pr(E_{\tau_{k}}|\Pi)
\tau_{k}=(s_{1},a_{1},...,s_{k},a_{k},s_{k+1}),k<L
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
count_{\tau_{k}}(\Pi)\geq c_{min}
\Pr(\mathcal{A}(\Pi)=\tau_{k})\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(%
\Pi^{\prime})=\tau_{k})+\Pr(E_{\tau_{k}}|\Pi)\delta^{\prime}
\varepsilon^{\prime},\delta^{\prime}
r=\top\cdots\top\bot\in\{\top,\perp\}^{k+1}
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau)=\sum_{a\in A}\left[\Pr(\mathcal{A}_{2}%
(\Pi,Q^{\tau\cdot a})=r^{k+1})\Pr(E_{\tau\cdot a}|\Pi)\right]
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau)=\sum_{a\in A}\left[\Pr(\mathcal{A}_{2}%
(\Pi,Q^{\tau\cdot a})=r^{k+1})\Pr(E_{\tau\cdot a}|\Pi)\right]
A^{\prime}=\{a:a\in A,count_{\tau_{k}\cdot a}(\Pi)\geq c_{min}\},A^{\prime%
\prime}=A\setminus A^{\prime}
\forall a\in A^{\prime\prime}
\displaystyle count_{\tau_{k}\cdot a}(\Pi)=\sum_{i=1}^{m}[(\Pi_{j=1}^{k}\pi_{i%
}(a_{j}|s_{j}))\times\pi_{i}(a|s_{k+1})]\geq p_{min}\times\sum_{i=1}^{m}[\Pi_{%
j=1}^{k}\pi_{i}(a_{j}|s_{j})]=p_{min}\times count_{\tau_{k}}(\Pi)
\displaystyle count_{\tau_{k}\cdot a}(\Pi)=\sum_{i=1}^{m}[(\Pi_{j=1}^{k}\pi_{i%
}(a_{j}|s_{j}))\times\pi_{i}(a|s_{k+1})]\geq p_{min}\times\sum_{i=1}^{m}[\Pi_{%
j=1}^{k}\pi_{i}(a_{j}|s_{j})]=p_{min}\times count_{\tau_{k}}(\Pi)
\displaystyle p_{min}\times count_{\tau_{k}}(\Pi)\leq count_{\tau_{k}\cdot a}(%
\Pi)<c_{min}
\displaystyle p_{min}\times
\displaystyle count_{\tau_{k}}(\Pi)\leq count_{\tau_{k}\cdot a}(\Pi)<c_{min}
\displaystyle count_{\tau_{k}}(\Pi)<\frac{c_{min}}{p_{min}}=\theta
\displaystyle count_{\tau_{k}}(\Pi)<\frac{c_{min}}{p_{min}}=\theta
\mathcal{A}_{2}
\mathcal{A}_{PQ}
\mathcal{A}_{2}
r
\top
k^{th}
\mathcal{A}_{PQ}
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=r)\leq\Pr(\mathcal{A%
}_{PQ}(\Pi,\tau_{k},\hat{\theta},\varepsilon^{\prime})=\top)<\delta^{\prime}
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})
\displaystyle=r)\leq\Pr(\mathcal{A}_{PQ}(\Pi,\tau_{k},\hat{\theta},\varepsilon%
^{\prime})=\top)<\delta^{\prime}
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{k})=\sum_{a\in A}\left[\Pr(\mathcal{A}%
_{2}(\Pi,Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{k})
\displaystyle=\sum_{a\in A}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}\cdot a})=%
r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle=\sum_{a\in A^{\prime}}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}%
\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle=\sum_{a\in A^{\prime}}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}%
\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle\qquad+\sum_{a\in A^{\prime\prime}}\left[\Pr(\mathcal{A}_{2}(\Pi,%
Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle\qquad+\sum_{a\in A^{\prime\prime}}\left[\Pr(\mathcal{A}_{2}(\Pi,%
Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle=\sum_{a\in A^{\prime}}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}%
\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle=\sum_{a\in A^{\prime}}\left[\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{k}%
\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi)\right]
\displaystyle\qquad+\delta^{\prime}\sum_{a\in A^{\prime\prime}}\Pr(E_{\tau_{k}%
\cdot a}|\Pi)\qquad\text{[Using \eqref{eqn2}]}
\displaystyle\qquad+\delta^{\prime}\sum_{a\in A^{\prime\prime}}\Pr(E_{\tau_{k}%
\cdot a}|\Pi)\qquad\text{[Using \eqref{eqn2}]}
\displaystyle\leq e^{2\varepsilon^{\prime}}\sum_{a\in A^{\prime}}\left[\Pr(%
\mathcal{A}_{2}(\Pi^{\prime},Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|%
\Pi^{\prime})\right]
\displaystyle\leq e^{2\varepsilon^{\prime}}\sum_{a\in A^{\prime}}\left[\Pr(%
\mathcal{A}_{2}(\Pi^{\prime},Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|%
\Pi^{\prime})\right]
\displaystyle\qquad+\delta^{\prime}\Pr(E_{\tau_{k}}|\Pi)\qquad\text{[Using: $%
\mathcal{A}_{2}$ is $(\varepsilon^{\prime},0)$-DP and Lemma \ref{count_lemma}]}
\mathcal{A}_{2}
(\varepsilon^{\prime},0)
\displaystyle\qquad+\delta^{\prime}\Pr(E_{\tau_{k}}|\Pi)\qquad\text{[Using: $%
\mathcal{A}_{2}$ is $(\varepsilon^{\prime},0)$-DP and Lemma \ref{count_lemma}]}
\mathcal{A}_{2}
(\varepsilon^{\prime},0)
\displaystyle\leq e^{2\varepsilon^{\prime}}\sum_{a\in A}\left[\Pr(\mathcal{A}_%
{2}(\Pi^{\prime},Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi^{\prime})%
\right]+\delta^{\prime}\Pr(E_{\tau_{k}}|\Pi)
\displaystyle\leq e^{2\varepsilon^{\prime}}\sum_{a\in A}\left[\Pr(\mathcal{A}_%
{2}(\Pi^{\prime},Q^{\tau_{k}\cdot a})=r)\Pr(E_{\tau_{k}\cdot a}|\Pi^{\prime})%
\right]+\delta^{\prime}\Pr(E_{\tau_{k}}|\Pi)
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{k})\leq e^{2\varepsilon^{\prime}}\Pr(%
\mathcal{A}(\Pi^{\prime})=\tau_{k})+\Pr(E_{\tau_{k}}|\Pi)\delta^{\prime}
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{k})
\displaystyle\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau_%
{k})+\Pr(E_{\tau_{k}}|\Pi)\delta^{\prime}
\tau_{L}
L
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
count_{\tau_{L}}(\Pi)<c_{min}
\Pr(\mathcal{A}(\Pi)=\tau_{L})<\Pr(E_{\tau_{L}}|\Pi)\cdot\delta^{\prime}.
count_{\tau_{L}}(\Pi)\geq c_{min}
\Pr(\mathcal{A}(\Pi)={\tau_{L}})\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(%
\Pi^{\prime})={\tau_{L}})
\gamma^{(L)}=\top^{L}
\Pr(\mathcal{A}(\Pi)=\tau_{L})=\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau}_{L})=\gamma^{(%
L)})\Pr(E_{\tau_{L}}|\Pi)
count_{\tau_{L}}(\Pi)\geq c_{min}
\mathcal{A}_{2}
(\varepsilon^{\prime},0)
\Pr(\mathcal{A}(\Pi)=\tau_{L})\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(%
\Pi^{\prime})=\tau_{L})
\mathcal{A}_{2}
\mathcal{A}_{PQ}
\mathcal{A}_{2}
r
\top
L^{th}
\mathcal{A}_{PQ}
\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{L}})=\gamma^{(L)})\leq\Pr(\mathcal{A}_{PQ}(%
\Pi,\tau_{L},\hat{\theta},\varepsilon^{\prime})=\top)
count_{\tau_{L}}(\Pi)<c_{min}
count_{\tau}(\Pi)<c_{min}<c_{min}/p_{min}=\theta
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{L}})=\gamma^{(L)})\leq\Pr(%
\mathcal{A}_{PQ}(\Pi,\tau_{L},\hat{\theta},\varepsilon^{\prime})=\top)<\delta^%
{\prime}
\displaystyle\Pr(\mathcal{A}_{2}(\Pi,Q^{\tau_{L}})=\gamma^{(L)})\leq\Pr(%
\mathcal{A}_{PQ}(\Pi,\tau_{L},\hat{\theta},\varepsilon^{\prime})=\top)<\delta^%
{\prime}
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{L})\leq\Pr(E_{\tau_{L}}|\Pi)\delta^{%
\prime}\qquad[\text{From }\eqref{eqn:a_prob2}]
\displaystyle\Pr(\mathcal{A}(\Pi)=\tau_{L})\leq\Pr(E_{\tau_{L}}|\Pi)\delta^{%
\prime}\qquad[\text{From }\eqref{eqn:a_prob2}]
\mathcal{T}
S,A
\forall\tau\in\mathcal{T}
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
\Pr(\mathcal{A}(\Pi)=\tau)\leq e^{2\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{%
\prime})=\tau)+\Pr(E_{\tau}|\Pi)\cdot\delta^{\prime}
\delta^{\prime}=\delta_{1}/(2LT)
\mathcal{A}
(2\varepsilon^{\prime},\delta_{1}/(2T))
\Pi,\Pi^{\prime}\subseteq\Pi_{p_{min}}
\displaystyle\sum_{\tau\in\mathcal{T}}\max\{\Pr(\mathcal{A}(\Pi)=\tau)-e^{2%
\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau),0\}\leq\frac{\delta_{%
1}}{2T}
\displaystyle\sum_{\tau\in\mathcal{T}}\max\{\Pr(\mathcal{A}(\Pi)=\tau)-e^{2%
\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau),0\}\leq\frac{\delta_{%
1}}{2T}
k
\sum_{\tau\in\{\tau:\tau\in\mathcal{T},|\tau|=k\}}\Pr(E_{\tau}|\Pi)=1
|\tau|
\tau
\displaystyle\sum_{\tau\in\mathcal{T}}\Pr(E_{\tau}|\Pi)=\sum_{k=1}^{L}\left[%
\sum_{\tau\in\{\tau:\tau\in\mathcal{T},|\tau|=k\}}\Pr(E_{\tau}|\Pi)\right]=L
\displaystyle\sum_{\tau\in\mathcal{T}}\Pr(E_{\tau}|\Pi)=\sum_{k=1}^{L}\left[%
\sum_{\tau\in\{\tau:\tau\in\mathcal{T},|\tau|=k\}}\Pr(E_{\tau}|\Pi)\right]=L
L
\displaystyle\sum_{\tau\in\mathcal{T}}\max\{\Pr(\mathcal{A}(\Pi)=\tau)-e^{2%
\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau),0\}\leq\sum_{\tau\in%
\mathcal{T}}\Pr(E_{\tau}|\Pi)\delta^{\prime}
\displaystyle\sum_{\tau\in\mathcal{T}}\max\{\Pr(\mathcal{A}(\Pi)=\tau)-e^{2%
\varepsilon^{\prime}}\Pr(\mathcal{A}(\Pi^{\prime})=\tau),0\}
\displaystyle\leq\sum_{\tau\in\mathcal{T}}\Pr(E_{\tau}|\Pi)\delta^{\prime}
\displaystyle=L\delta^{\prime}=\frac{\delta_{1}}{2T}
\displaystyle=L\delta^{\prime}=\frac{\delta_{1}}{2T}
p_{min}=0.02
1e6
1e6
1e6
2e6
(1-(|A|-1)\cdot p_{min})
|A|
p_{min}
b
b
m
m
\phi
D^{\Pi}
\Pi
\mathcal{L(\phi)}=\frac{1}{b}\sum_{i=1}^{b}\mathcal{L}(\phi,x_{i})
\eta
b
\sigma
C
N
\phi_{0}
t=1,\dots,N-1
B
\Pi
\frac{b}{m}
\pi_{i}\in B
x=(s,a,r,s^{\prime})
D^{\pi_{i}}
B_{trans}
x_{i}\in B_{trans}
g_{i}(\phi_{t})\leftarrow\nabla_{\phi_{t}}\mathcal{L}(\phi_{t},x_{i})
\bar{g}_{i}(\phi_{t})\leftarrow g_{i}(\phi_{t})/\text{max}\left(1,\frac{\left%
\lVert g_{i}(\phi_{t})\right\rVert_{2}}{C}\right)
\tilde{g}_{t}\leftarrow\frac{1}{b}\left(\sum_{i=1}^{b}\bar{g}_{i}(\phi_{t})+%
\mathcal{N}(0,\sigma^{2}C^{2}\text{I})\right)
\phi_{t+1}\leftarrow\phi_{t}-\eta\cdot\tilde{g}_{t}
\phi_{T}
p
\mathcal{D}_{stable}^{\Pi}
q=p\cdot\frac{b}{m}
p_{min}=0.02
\varepsilon\leq 5
\varepsilon_{1}=0,\varepsilon_{2}=\varepsilon,\delta_{1}=0,\delta_{2}=\delta
\varepsilon\leq 2.5
\varepsilon
\varepsilon_{1}=\frac{3\varepsilon}{4},\varepsilon_{2}=\frac{\varepsilon}{4},%
\delta_{1}=\frac{9\delta}{10},\delta_{2}=\frac{\delta}{10}
\varepsilon_{1}=\varepsilon,\varepsilon_{2}=0,\delta_{1}=\delta,\delta_{2}=0
\eta
\mathcal{D}_{unst}^{\Pi}
p
\eta
p
\varepsilon_{2}
p=0.0
\mathcal{D}_{stable}^{\Pi}
\varepsilon
\eta
p=0.0
\varepsilon=
T
\varepsilon=10.0
\eta
p
\varepsilon=7.5
\varepsilon=5.0,2.5
\varepsilon=
T
\varepsilon=10.0
\eta
p
\varepsilon=7.5
\varepsilon
\varepsilon=
T
p=0.0
\mathcal{D}_{stable}^{\Pi}
\varepsilon=10.0
T=50
\eta
\varepsilon
