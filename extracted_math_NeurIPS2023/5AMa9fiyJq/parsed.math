c
I
q
y_{t}
I
L(y_{t},y_{gt})
y_{t}
y_{gt}
y_{gt}
y_{t}
F_{t}
F_{t}
(F_{1},F_{2},F_{3}...F_{t-1})
H_{t}^{Q}
C
F_{t}
H_{t}^{Q}
S_{t}^{Q}
S_{t}^{Q}
e_{t}^{Q}
y_{t}=f(S_{t}^{Q})
e_{t}^{Q}
q_{t}
Q_{t}
q_{t}
(F_{1},F_{2},F_{3}...F_{t})\rightarrow H_{t}^{A}
Q_{t}
I
H_{t}^{A},Q_{t},y_{gt}
e_{t}^{A}
e_{t}^{A}
a_{t}
y_{gt}
y_{t}
\{c,q_{1},a_{1}\ldots q_{10},a_{10}\}
I
c
q_{i},a_{i}
i^{th}
i={1\ldots 10}
t
q_{t}
q_{t}
a_{t}
r_{t}(s_{t}^{Q},(q_{t},a_{t},y_{t}))=l(y_{t-1},y^{gt})-l(y_{t},y^{gt})
t
t-1
(q_{t},a_{t})
f
Qbot\leftarrow\textit{random\_select }(Q_{1},Q_{2},Q_{3}....Q_{q})
Abot\leftarrow\textit{random\_select }(A_{1},A_{2},A_{3}....A_{a})
q
a
history\leftarrow(0,0,...0)
fact\leftarrow(0,0,...0)
\Delta image\_pred\leftarrow 0
Qz_{1}\leftarrow Ques\_enc(Qbot,fact,history,caption)
ques_{t}\leftarrow Ques\_gen(Qbot,Qz_{t})
Az_{t}\leftarrow Ans\_enc(Abot,fact,history,image,ques_{t},caption)
ans_{t}\leftarrow Ans\_gen(Abot,Az_{t})
fact\leftarrow[ques_{t},ans_{t}]
history\leftarrow concat(history,fact)
Qz_{t}\leftarrow Ques\_enc(Qbot,fact,history,caption)
image\_pred\leftarrow image\_regress(Qbot,fact,history,caption)
R_{t}\leftarrow(target\_image-image\_pred)^{2}-\Delta image\_pred
\Delta image\_pred\leftarrow(target\_image-image\_pred)^{2}
\Delta(w_{Qbot})\leftarrow\frac{1}{10}\sum_{t=1}^{10}\nabla_{\theta_{Qbot}}%
\left[G_{t}\log p(ques_{t},\theta_{Qbot})-\Delta image\_pred\right]
\Delta(w_{Abot})\leftarrow\frac{1}{10}\sum_{t=1}^{10}G_{t}\nabla_{\theta_{Abot%
}}\log p(ans_{t},\theta_{Abot})
w_{Qbot}\leftarrow w_{Qbot}+\Delta(w_{Qbot})
w_{Abot}\leftarrow w_{Abot}+\Delta(w_{Abot})
