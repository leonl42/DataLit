X,A,M
x,a,m
\mathcal{X},\mathcal{A},\mathcal{M}
\mathbb{P}(M)=\mathbb{P}_{M}
M
\mathbb{P}(M\mid
A=a
\mathbb{P}\left(M_{a}\right)
M
A
a
\mathbb{P}\left(M_{a^{\prime}}\mid A=a,M=m\right)
M
A
a^{\prime}
A=a
M=m
A
X
M
Y
\longrightarrow
\dashleftarrow\dashrightarrow
A
X
M
Y
\longrightarrow
\dashleftarrow\dashrightarrow
A\in\mathcal{A}
M\in\mathcal{M}
X\in\mathcal{X}
Y\in\mathcal{Y}
A
k
X
M
k=2
\mathcal{A}=\{0,1\}
M
A
A
M
M_{a}
M
A
Y_{a}
Y
k=2
A
A^{\prime}
M
M
A
Y
X
A
Y
A=a\Rightarrow M=M_{a}
{x}
\mathbb{P}(X={x})>0
0<\mathbb{P}\left(A={a}\mid X={x}\right)<1
\forall{a}\in\mathcal{A}
X
M_{a}
A
M_{a}\perp\!\!\!\perp A\mid X
Y
A
h(X,M)=\hat{Y}
h
X={x}
A={a}
M={m}
\mathbb{P}\left(h(x,M_{a})\mid X={x},A=a,M={m}\right)=\mathbb{P}\left(h(x,M_{a%
^{\prime}})\mid X={x},A=a,M={m}\right).
\delta\left({h(x,m)}\right)
Y
M
G
\left(X,A,M\right)
\hat{M}_{A}
\hat{M}_{A^{\prime}}
{D}
{M}
\hat{M}_{A^{\prime}}
\hat{M}_{A^{\prime}}
\mathcal{R}_{\mathrm{{cm}}}
\mathcal{R}_{\mathrm{{cm}}}
h
G
\left(X,A,M\right)
\hat{M}_{A}
\hat{M}_{A^{\prime}}
{D}
{M}
\hat{M}_{A^{\prime}}
\hat{M}_{A^{\prime}}
\mathcal{R}_{\mathrm{{cm}}}
\mathcal{R}_{\mathrm{{cm}}}
h
{G}
{D}
{G}
G
G
\mathbb{P}\left({M}_{a^{\prime}}\mid X=x,A=a,M=m\right)
G:\mathcal{X}\times\mathcal{A}\times\mathcal{M}\rightarrow\mathcal{M}
{G}
A
M
X
\mathbb{P}_{X,A,M}
\mathbb{P}_{\mathrm{f}}
G
\hat{M}_{0}
\hat{M}_{1}
G\left(X,A,M\right)
{G}\left(X,A,M\right)_{a}=\hat{M}_{a}\quad\text{for}\quad a\in\{0,1\}
G
\mathcal{L}_{\mathrm{f}}
\hat{M}_{A}
M
\mathcal{L}_{\mathrm{f}}(G)=\mathbb{E}_{({X,A,M)\sim\mathbb{P}_{\mathrm{f}}}}%
\left[\left\|M-{G}\left(X,A,M\right)_{A}\right\|^{2}_{2}\right],
\|\cdot\|_{2}
L_{2}
D
D
D
D
{D}
M
\hat{M}_{A^{\prime}}
G
G
D
\hat{M}_{A}
M
\tilde{G}\left(X,A,M\right)
\tilde{G}\left(X,A,M\right)_{a}=\begin{cases}{M},&\text{if }A=a,\\
{G}\left(X,A,M\right)_{a},&\text{if }A=a^{\prime},\end{cases}\quad\text{for }a%
\in\{0,1\}.
{D}
\tilde{G}
(X,\tilde{G})
D
{D}\left(X,\tilde{G}\right)_{a}=\hat{\mathbb{P}}\left(M=\tilde{G}_{a}\mid X,%
\tilde{G}\right)=\hat{\mathbb{P}}\left(A=a\mid X,\tilde{G}\right)\quad\text{%
for }a\in\{0,1\}.
{G}
D
\mathcal{L}_{\mathrm{adv}}
\mathcal{L}_{\mathrm{adv}}(G,D)=\mathbb{E}_{({X,A,M)\sim\mathbb{P}_{\mathrm{f}%
}}}\left[\log\big{(}{D}(X,\tilde{G}\left(X,A,M\right))_{A}\big{)}\right].
\min_{G}\max_{D}\mathcal{L}_{\mathrm{adv}}(G,D)+\alpha\mathcal{L}_{\mathrm{f}}%
(G),
\alpha
\mathcal{L}_{\mathrm{f}}
\mathbb{P}\left({M}_{a^{\prime}}\mid X=x,A=a,M=m\right)
h
\mathcal{R}_{\mathrm{{cm}}}(h)
\mathcal{R}_{\mathrm{{cm}}}(h)=\mathbb{E}_{({X,A,M)\sim\mathbb{P}_{\mathrm{f}}%
}}\left[\left\|h\left(X,M\right)-h\left(X,\hat{M}_{A^{\prime}}\right)\right\|^%
{2}_{2}\right].
\mathcal{R}_{\mathrm{{cm}}}
h
\hat{M}_{A^{\prime}}
\mathcal{R}_{\mathrm{{cm}}}
\mathcal{R}_{\mathrm{{cm}}}
\mathcal{L}(h)
h
\mathcal{L}_{\mathrm{ce}}(h)
\mathcal{R}_{\mathrm{{cm}}}(h)
\mathcal{L}(h)
\lambda\geq 0
\mathcal{L}(h)=\mathcal{L}_{\mathrm{ce}}(h)+\lambda\mathcal{R}_{\mathrm{{cm}}}%
(h).
\lambda
\mathcal{R}_{\mathrm{{cm}}}
\lambda
\mathit{CF}
\mathbb{E}\left[\left\|\left(h\left(X,M\right)-h\left(X,M_{A^{\prime}}\right)%
\right)\right\|^{2}_{2}\right]
\mathit{CF}
\mathit{CF}
h
\mathcal{C}
\mathbb{E}\left[\left\|(h(X,M)-h(X,M_{A^{\prime}})\right\|^{2}_{2}\right]\leq%
\mathcal{C}\,\mathbb{E}\left[\left\|M_{A^{\prime}}-\hat{M}_{A^{\prime}}\right%
\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}(h).
\mathcal{R}_{\mathrm{{cm}}}
h
U_{\gamma}(\mathit{accuracy},\mathit{CF}):\mathbb{R}^{2}\mapsto\mathbb{R}
\mathit{CF}
U_{\gamma}(\mathit{accuracy},\mathit{CF})=\mathit{accuracy}-\gamma\times%
\mathit{CF}
\gamma
U_{\gamma}
\gamma
\gamma\in\{0.1,\ldots,1.0\}
300
256
30
0.005
\lambda
0.5
\sin
\pm
\sin
\pm
\sin
\sim
\gamma
M_{A^{\prime}}
\hat{M}_{A^{\prime}}
\approx 0
M_{A^{\prime}}
\hat{M}_{A^{\prime}}
\approx 0
M
M_{A^{\prime}}
\pm
\pm
\pm
M
\hat{M}_{A^{\prime}}
\pm
\pm
\pm
M_{A^{\prime}}
\hat{M}_{A^{\prime}}
\pm
\pm
\pm
M
M_{A^{\prime}}
\hat{M}_{A^{\prime}}
M
M_{A^{\prime}}
\hat{M}_{A^{\prime}}
M,\hat{M}_{A^{\prime}})
\approx 1
M_{A^{\prime}},\hat{M}_{A^{\prime}})
\lambda
\uparrow
\downarrow
\pm
\lambda
\uparrow
\downarrow
\pm
\mathcal{R}_{\mathrm{{cm}}}
\lambda
\lambda
\lambda
2
7
\lambda
\lambda
U
u
\mathcal{U}
\mathbf{U}=\{U_{1},\dots,U_{n}\}
\mathbb{P}(Y)
Y
\langle\mathbf{V},\mathbf{U},\mathcal{F},\mathbb{P}(\mathbf{U})\rangle
\mathbf{U}
\mathbf{V}=\left\{{V}_{1},\ldots,{V}_{n}\right\}
\mathbf{V}\cup\mathbf{U}
\mathcal{F}=\left\{f_{1},\ldots,f_{n}\right\}
\mathbf{V},v_{i}\leftarrow
f_{i}\left(\operatorname{pa}\left(v_{i}\right),u_{i}\right)
\mathrm{pa}\left(V_{i}\right)\subseteq\mathbf{V}\backslash V_{i}
U_{i}\subseteq\mathbf{U}
f_{i}
\mathbb{P}(\mathbf{U})
\mathbf{U}
X
Y
\mathbf{V}
\mathbf{u}=\{u_{1},\ldots,u_{n}\}\in\mathcal{U}
Y_{x}(\mathbf{u})
Y
\mathcal{F}_{x}
\mathbf{U}=\mathbf{u}
\mathbf{U}
Y_{x}(\mathbf{u})
Y
X
x
\mathbf{u}
Y_{x}
Y_{x}(\mathbf{U})
\mathcal{M}=\langle\mathbf{V},\mathbf{U},\mathcal{F},\mathbb{P}(\mathbf{U})\rangle
\mathbb{P}(\mathbf{V})
Y\subseteq\mathbf{V}
\mathbb{P}^{\mathcal{M}}(Y=y)=\sum_{u}\mathds{1}(Y(\mathbf{u})=y)\mathbb{P}(%
\mathbf{U}=\mathbf{u})
Y(\mathbf{u})
Y
\mathcal{F}
\mathbf{U}=\mathbf{u}
\mathcal{M}=\langle\mathbf{V},\mathbf{U},\mathcal{F},\mathbb{P}(\mathbf{U})\rangle
Y_{x},\ldots,Z_{w}
Y,Z,\ldots,X,W\subseteq\mathbf{V}
\mathbb{P}^{\mathcal{M}}\left(Y_{x}=y,\ldots,Z_{w}=z\right)=\sum_{u}\mathds{1}%
\left(Y_{x}(\mathbf{u})=y,\ldots,Z_{w}(\mathbf{u})=z\right)\mathbb{P}(\mathbf{%
U}=\mathbf{u})
\mathcal{G}
\mathcal{M}
V_{i}\in\mathbf{V}
V_{i}\longrightarrow V_{j}
V_{i}
f_{j}\in\mathcal{F}
V_{i}\in\operatorname{pa}(V_{j})
V_{i}\dashleftarrow\dashrightarrow V_{j}
U_{i},U_{j}\subset\mathbf{U}
U_{i}\cap U_{j}\neq\varnothing
f_{i},f_{j}
U_{ij}\in\mathbf{U}
A,X
Y
\mathcal{M}=\langle\mathbf{V}=\{A,X,Y\},\mathbf{U},\mathcal{F},\mathbb{P}(%
\mathbf{U})\rangle
\hat{Y}=h(X,A,\mathbf{U})
X=x
A=a
\mathbb{P}\left(\hat{Y}_{a}(\mathbf{U})\mid X=x,A=a\right)=\mathbb{P}\left(%
\hat{Y}_{a^{\prime}}(\mathbf{U})\mid X=x,A=a\right),
a^{\prime}
A
\mathbb{P}\left(h(X_{a}(\mathbf{U}),a,\mathbf{U})\mid X=x,A=a\right)=\mathbb{P%
}\left(h(X_{a^{\prime}}(\mathbf{U}),a^{\prime},\mathbf{U})\mid X=x,A=a\right).
A
\mathbb{P}\left(\mathbf{U}\mid X=x,A=a\right)
X
\lambda
A=a
X=x
y
a^{\prime}\in\mathcal{A}
P(Y=y\mid X=x,do(A=a))=P\left(Y=y\mid X=x,do\left(A=a^{\prime}\right)\right)
P\left(\hat{Y}_{a}=y\mid X=x,A=a\right)=P\left(\hat{Y}_{a^{\prime}}=y\mid X=x,%
A=a\right)
\mathcal{D}
\lambda
e_{1}
e_{2}
n
\alpha
{G}
\theta_{g}
{D}
\theta_{d}
h
\theta_{h}
e_{1}
k
D
n
\left\{x^{(i)},a^{(i)},m^{(i)}\right\}_{i=1}^{n}
\mathcal{D}
{G}\left({x}^{(i)},{a}^{(i)},{m}^{(i)}\right)_{a}=\hat{m}^{(i)}_{a}\quad\text{%
for }a\in\{0,1\}
G
\tilde{G}^{(i)}_{a}=\begin{cases}{m}^{(i)},&\text{if }a^{(i)}=a,\\
\hat{m}^{(i)}_{a},&\text{if }a^{(i)}=a^{\prime}\end{cases}\quad\text{for }a\in%
\{0,1\}
\nabla_{\theta_{d}}\frac{1}{n}\sum_{i=1}^{n}\left[\log\big{(}{D}({x}^{(i)},%
\tilde{G}^{(i)})_{a^{(i)}}\big{)}\right]
k
G
n
\left\{x^{(i)},a^{(i)},m^{(i)}\right\}_{i=1}^{n}
\mathcal{D}
{G}\left({x}^{(i)},{a}^{(i)},{m}^{(i)}\right)_{a}=\hat{m}^{(i)}_{a}\quad\text{%
for }a\in\{0,1\}
G
\tilde{G}^{(i)}_{a}=\begin{cases}{m}^{(i)},&\text{if }a^{(i)}=a,\\
\hat{m}^{(i)}_{a},&\text{if }a^{(i)}=a^{\prime}\end{cases}\quad\text{for }a\in%
\{0,1\}
\nabla_{\theta_{g}}\frac{1}{n}\sum_{i=1}^{n}\left[\log\big{(}{D}({x}^{(i)},%
\tilde{G}^{(i)})_{a^{(i)}}\big{)}+\alpha\left\|m^{(i)}-{G}\left({x}^{(i)},{a}^%
{(i)},{m}^{(i)}\right)_{a^{(i)}}\right\|^{2}_{2}\right]
e_{2}
h
n
\left\{x^{(i)},a^{(i)},m^{(i)},y^{(i)}\right\}_{i=1}^{n}
\mathcal{D}
\hat{m}^{(i)}
{G}\left({x}^{(i)},{a}^{(i)},{m}^{(i)}\right)
\mathcal{R}_{\mathrm{{cm}}}=\left\|h(x^{(i)},m^{(i)})-h(x^{(i)},\hat{m}^{(i)}_%
{a^{{}^{\prime}(i)}})\right\|^{2}_{2}
\nabla_{\theta_{h}}\frac{1}{n}\sum_{i=1}^{n}\left[y^{(i)}\log\left(h(x^{(i)},m%
^{(i)})\right)+(1-y^{(i)})\log\left(1-h(x^{(i)},m^{(i)})\right)+\lambda%
\mathcal{R}_{\mathrm{{cm}}}\right]
h
h
\mathcal{C}
\mathbb{E}\left[\left\|(h(X,M)-h(X,M_{A^{\prime}})\right\|^{2}_{2}\right]\leq%
\mathcal{C}\,\mathbb{E}\left[\left\|M_{A^{\prime}}-\hat{M}_{A^{\prime}}\right%
\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}.
\displaystyle\mathbb{E}\left[\left\|h(X,M)-h(X,M_{A^{\prime}})\right\|^{2}_{2}\right]
\displaystyle\mathbb{E}\left[\left\|h(X,M)-h(X,M_{A^{\prime}})\right\|^{2}_{2}\right]
\displaystyle=\,\mathbb{E}\left[\left\|h(X,M)-h(X,M_{A^{\prime}})+h(X,\hat{M}_%
{A^{\prime}})-h(X,\hat{M}_{A^{\prime}})\right\|^{2}_{2}\right]
\displaystyle=
\displaystyle\,\mathbb{E}\left[\left\|h(X,M)-h(X,M_{A^{\prime}})+h(X,\hat{M}_{%
A^{\prime}})-h(X,\hat{M}_{A^{\prime}})\right\|^{2}_{2}\right]
\displaystyle\leq\,\mathbb{E}\left[\left\|h(X,M)-h(X,\hat{M}_{A^{\prime}})%
\right\|^{2}_{2}\right]+\mathbb{E}\left[\left\|h(X,\hat{M}_{A^{\prime}})-h(X,M%
_{A^{\prime}})\right\|^{2}_{2}\right]
\displaystyle\leq
\displaystyle\,\mathbb{E}\left[\left\|h(X,M)-h(X,\hat{M}_{A^{\prime}})\right\|%
^{2}_{2}\right]+\mathbb{E}\left[\left\|h(X,\hat{M}_{A^{\prime}})-h(X,M_{A^{%
\prime}})\right\|^{2}_{2}\right]
\displaystyle=\,\mathbb{E}\left[\left\|h(X,\hat{M}_{A^{\prime}})-h(X,M_{A^{%
\prime}})\right\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}
\displaystyle=
\displaystyle\,\mathbb{E}\left[\left\|h(X,\hat{M}_{A^{\prime}})-h(X,M_{A^{%
\prime}})\right\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}
\displaystyle\leq\,\mathcal{C}\,\mathbb{E}\left[\left\|(X,\hat{M}_{A^{\prime}}%
)-({X,{M_{A^{\prime}}}})\right\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}
\displaystyle\leq
\displaystyle\,\mathcal{C}\,\mathbb{E}\left[\left\|(X,\hat{M}_{A^{\prime}})-({%
X,{M_{A^{\prime}}}})\right\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}
\displaystyle=\,\mathcal{C}\,\mathbb{E}\left[\left\|{M_{A^{\prime}}}-\hat{M}_{%
A^{\prime}}\right\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}.
\displaystyle=
\displaystyle\,\mathcal{C}\,\mathbb{E}\left[\left\|{M_{A^{\prime}}}-\hat{M}_{A%
^{\prime}}\right\|^{2}_{2}\right]+\mathcal{R}_{\mathrm{{cm}}}.
\mathbb{P}_{X,A,M}=\mathbb{P}_{\mathrm{f}}
\mathcal{M}=\langle\mathbf{V},\mathbf{U},\mathcal{F},\mathbb{P}(\mathbf{U})\rangle
\displaystyle\mathbf{V}=\{X,A,M,Y\},\quad\mathbf{U}=\{U_{XA},U_{M},U_{Y}\},
\displaystyle\mathbf{V}
\displaystyle=\{X,A,M,Y\},\quad\mathbf{U}=\{U_{XA},U_{M},U_{Y}\},
\displaystyle\mathcal{F}=\{f_{X}(u_{XA}),f_{A}(x,u_{XA}),f_{M}(x,a,u_{M}),f_{Y%
}(x,m,u_{Y})\},\quad\mathbb{P}(\mathbf{U})=\mathbb{P}(U_{XA})\mathbb{P}(U_{M})%
\mathbb{P}(U_{Y}),
\displaystyle\mathcal{F}
\displaystyle=\{f_{X}(u_{XA}),f_{A}(x,u_{XA}),f_{M}(x,a,u_{M}),f_{Y}(x,m,u_{Y}%
)\},\quad\mathbb{P}(\mathbf{U})=\mathbb{P}(U_{XA})\mathbb{P}(U_{M})\mathbb{P}(%
U_{Y}),
\mathcal{M}\subseteq\mathbb{R}
f_{M}
f_{M}
u_{M}
\mathbb{P}(M_{a^{\prime}}\mid X=x,A=a,M=m)=\delta(\mathbb{F}^{-1}(\pm\mathbb{F%
}(m;x,a)\mp 0.5+0.5;x,a^{\prime})),
\mathbb{F}(\cdot;x,a)
\mathbb{F}^{-1}(\cdot;x,a)
\mathbb{P}(M\mid X=x,A=a)
\delta(\cdot)
M
\mathbb{P}(M_{a^{\prime}}\mid X=x,A=a,M=m)
\mathbb{P}(G(x,a,M_{a})_{a^{\prime}}\mid X=x,A=a)=\mathbb{P}(M_{a^{\prime}}%
\mid X=x,A=a)
M=m
\mathbb{P}(M_{a^{\prime}}\mid X=x,A=a,M=m)
\pi_{a}(x)=\mathbb{P}(A=a\mid X=x)
X=x
X
A
\displaystyle\mathbb{E}_{({X,A,M)\sim\mathbb{P}_{\mathrm{f}}}}\left[\log\big{(%
}{D}(X,\tilde{G}\left(X,A,M\right))_{A}\big{)}\right]
\displaystyle\mathbb{E}_{({X,A,M)\sim\mathbb{P}_{\mathrm{f}}}}\left[\log\big{(%
}{D}(X,\tilde{G}\left(X,A,M\right))_{A}\big{)}\right]
\displaystyle=\mathbb{E}_{X\sim\mathbb{P}(X)}\mathbb{E}_{({A,M)\sim\mathbb{P}(%
A,M\mid X)}}\left[\log\big{(}{D}(X,\tilde{G}\left(X,A,M\right))_{A}\big{)}\right]
\displaystyle=
\displaystyle\mathbb{E}_{X\sim\mathbb{P}(X)}\mathbb{E}_{({A,M)\sim\mathbb{P}(A%
,M\mid X)}}\left[\log\big{(}{D}(X,\tilde{G}\left(X,A,M\right))_{A}\big{)}\right]
\displaystyle=\mathbb{E}_{X\sim\mathbb{P}(X)}\Big{[}\mathbb{E}_{{M\sim\mathbb{%
P}(M\mid X,A=0)}}\left[\log\big{(}{D}(X,\tilde{G}\left(X,0,M\right))_{0}\big{)%
}\right]\,\pi_{0}(X)
\displaystyle=
\displaystyle\mathbb{E}_{X\sim\mathbb{P}(X)}\Big{[}\mathbb{E}_{{M\sim\mathbb{P%
}(M\mid X,A=0)}}\left[\log\big{(}{D}(X,\tilde{G}\left(X,0,M\right))_{0}\big{)}%
\right]\,\pi_{0}(X)
\displaystyle\qquad\qquad\qquad+\mathbb{E}_{({M\sim\mathbb{P}(M\mid X,A=1)}}%
\left[\log\big{(}{D}(X,\tilde{G}\left(X,1,M\right))_{1}\big{)}\right]\,\pi_{1}%
(X)\Big{]}
\displaystyle\qquad\qquad\qquad+\mathbb{E}_{({M\sim\mathbb{P}(M\mid X,A=1)}}%
\left[\log\big{(}{D}(X,\tilde{G}\left(X,1,M\right))_{1}\big{)}\right]\,\pi_{1}%
(X)\Big{]}
\displaystyle=\mathbb{E}_{X\sim\mathbb{P}(X)}\Big{[}\mathbb{E}_{{M\sim\mathbb{%
P}(M\mid X,A=0)}}\left[\log\big{(}{D}(X,\{M,{G}\left(X,0,M\right)_{1}\})_{0}%
\big{)}\right]\,\pi_{0}(X)
\displaystyle=
\displaystyle\mathbb{E}_{X\sim\mathbb{P}(X)}\Big{[}\mathbb{E}_{{M\sim\mathbb{P%
}(M\mid X,A=0)}}\left[\log\big{(}{D}(X,\{M,{G}\left(X,0,M\right)_{1}\})_{0}%
\big{)}\right]\,\pi_{0}(X)
\displaystyle\qquad\qquad\qquad+\mathbb{E}_{{M\sim\mathbb{P}(M\mid X,A=1)}}%
\left[\log\big{(}1-{D}(X,\{{G}\left(X,1,M\right)_{0},M\})_{0}\big{)}\right]\,%
\pi_{1}(X)\Big{]}.
\displaystyle\qquad\qquad\qquad+\mathbb{E}_{{M\sim\mathbb{P}(M\mid X,A=1)}}%
\left[\log\big{(}1-{D}(X,\{{G}\left(X,1,M\right)_{0},M\})_{0}\big{)}\right]\,%
\pi_{1}(X)\Big{]}.
Z_{0}=\{M,{G}\left(X,0,M\right)_{1}\}
Z_{1}=\{{G}\left(X,1,M\right)_{0},M\}
\displaystyle\mathbb{E}_{X\sim\mathbb{P}(X)}\Big{[}\mathbb{E}_{{Z_{0}\sim%
\mathbb{P}(Z_{0}\mid X,A=0)}}\left[\log\big{(}{D}(X,Z_{0})_{0}\big{)}\right]\,%
\pi_{0}(X)
\displaystyle\mathbb{E}_{X\sim\mathbb{P}(X)}\Big{[}\mathbb{E}_{{Z_{0}\sim%
\mathbb{P}(Z_{0}\mid X,A=0)}}\left[\log\big{(}{D}(X,Z_{0})_{0}\big{)}\right]\,%
\pi_{0}(X)
\displaystyle\qquad\qquad\qquad+\mathbb{E}_{{Z_{1}\sim\mathbb{P}(Z_{1}\mid X,A%
=1)}}\left[\log\big{(}1-{D}(X,Z_{1})_{0}\big{)}\right]\,\pi_{1}(X)\Big{]}
\displaystyle\qquad\qquad\qquad+\mathbb{E}_{{Z_{1}\sim\mathbb{P}(Z_{1}\mid X,A%
=1)}}\left[\log\big{(}1-{D}(X,Z_{1})_{0}\big{)}\right]\,\pi_{1}(X)\Big{]}
\displaystyle=\mathbb{E}_{X\sim\mathbb{P}(X)}\bigg{[}\int_{\mathcal{Z}}\Big{(}%
\log\big{(}{D}(X,z)_{0}\big{)}\,\pi_{0}(X)\mathbb{P}(Z_{0}=z\mid X,A=0)
\displaystyle=
\displaystyle\mathbb{E}_{X\sim\mathbb{P}(X)}\bigg{[}\int_{\mathcal{Z}}\Big{(}%
\log\big{(}{D}(X,z)_{0}\big{)}\,\pi_{0}(X)\mathbb{P}(Z_{0}=z\mid X,A=0)
\displaystyle\qquad\qquad\qquad\quad+\log\big{(}1-{D}(X,z)_{0}\big{)}\,\pi_{1}%
(X)\mathbb{P}(Z_{1}=z\mid X,A=1)\Big{)}\mathop{}\!\mathrm{d}z\bigg{]},
\displaystyle\qquad\qquad\qquad\quad+\log\big{(}1-{D}(X,z)_{0}\big{)}\,\pi_{1}%
(X)\mathbb{P}(Z_{1}=z\mid X,A=1)\Big{)}\mathop{}\!\mathrm{d}z\bigg{]},
\mathcal{Z}=\mathcal{M}\times\mathcal{M}
\pi_{0}(X)
\pi_{1}(X)
(a,b)\in\mathbb{R}^{2}\setminus\{0,0\}
y\mapsto\log(y)a+\log(1-y)b
[0,1]
\frac{a}{a+b}
\displaystyle D(x,z)_{0}=\frac{\mathbb{P}(Z_{0}=z\mid X=x,A=0)\,\pi_{0}(x)}{%
\mathbb{P}(Z_{0}=z\mid X=x,A=0)\,\pi_{0}(x)+\mathbb{P}(Z_{1}=z\mid X=x,A=1)\,%
\pi_{1}(x)}.
\displaystyle D(x,z)_{0}
\displaystyle=\frac{\mathbb{P}(Z_{0}=z\mid X=x,A=0)\,\pi_{0}(x)}{\mathbb{P}(Z_%
{0}=z\mid X=x,A=0)\,\pi_{0}(x)+\mathbb{P}(Z_{1}=z\mid X=x,A=1)\,\pi_{1}(x)}.
\displaystyle\mathbb{P}(Z_{0}=z\mid X=x,A=0)=\mathbb{P}(\{M=m_{0},G(x,0,M)_{1}%
=m_{1}\}\mid X=x,A=0)
\displaystyle\mathbb{P}(Z_{0}
\displaystyle=z\mid X=x,A=0)=\mathbb{P}(\{M=m_{0},G(x,0,M)_{1}=m_{1}\}\mid X=x%
,A=0)
\displaystyle=\mathbb{P}(\{M_{0}=m_{0},G(x,0,M_{0})_{1}=m_{1}\}\mid X=x),
\displaystyle=\mathbb{P}(\{M_{0}=m_{0},G(x,0,M_{0})_{1}=m_{1}\}\mid X=x),
\displaystyle\mathbb{P}(Z_{1}=z\mid X=x,A=1)=\mathbb{P}(\{G(x,1,M)_{0}=m_{0},M%
=m_{1}\}\mid X=x,A=1)
\displaystyle\mathbb{P}(Z_{1}
\displaystyle=z\mid X=x,A=1)=\mathbb{P}(\{G(x,1,M)_{0}=m_{0},M=m_{1}\}\mid X=x%
,A=1)
\displaystyle=\mathbb{P}(\{G(x,1,M_{1})_{0}=m_{0},M_{1}=m_{1}\}\mid X=x).
\displaystyle=\mathbb{P}(\{G(x,1,M_{1})_{0}=m_{0},M_{1}=m_{1}\}\mid X=x).
\displaystyle\operatorname{JSD}_{\pi_{0}(x),\pi_{1}(x)}\Big{(}\mathbb{P}(\{M_{%
0},G(x,0,M_{0})_{1}\}\mid X=x)\,\big{|}\big{|}\,\mathbb{P}(\{G(x,1,M_{1})_{0},%
M_{1}\}\mid X=x)\Big{)},
\displaystyle\operatorname{JSD}_{\pi_{0}(x),\pi_{1}(x)}
\displaystyle\Big{(}\mathbb{P}(\{M_{0},G(x,0,M_{0})_{1}\}\mid X=x)\,\big{|}%
\big{|}\,\mathbb{P}(\{G(x,1,M_{1})_{0},M_{1}\}\mid X=x)\Big{)},
\operatorname{JSD}_{w_{1},w_{2}}(\mathbb{P}_{1}\,||\,\mathbb{P}_{1})=w_{1}%
\operatorname{KL}(\mathbb{P}_{1}\,||\,w_{1}\,\mathbb{P}_{1}+w_{2}\,\mathbb{P}_%
{2})+w_{2}\operatorname{KL}(\mathbb{P}_{2}\,||\,w_{1}\,\mathbb{P}_{1}+w_{2}\,%
\mathbb{P}_{2})
\operatorname{KL}(\mathbb{P}_{1}\,||\,\mathbb{P}_{1})
G(x,0,M_{0})_{1}=M_{1}
G(x,1,M_{1})_{0}=M_{0}
X=x
\mathbb{P}(G(x,a,M_{a})_{a^{\prime}}\mid X=x)=\mathbb{P}(M_{a^{\prime}}\mid X=%
x).
\mathbb{P}(G(x,a,M_{a})_{a^{\prime}}\mid X=x,A=a)=\mathbb{P}(M_{a^{\prime}}%
\mid X=x,A=a)
X=x,A=a,M=m
\displaystyle\mathbb{P}(G(x,a,M_{a})_{a^{\prime}}\mid X=x,A=a,M=m)=\mathbb{P}(%
G(x,a,m)_{a^{\prime}}\mid X=x,A=a,M=m)
\displaystyle\mathbb{P}(G(x,a,M_{a})_{a^{\prime}}\mid X=x,A=a,M=m)
\displaystyle=\mathbb{P}(G(x,a,m)_{a^{\prime}}\mid X=x,A=a,M=m)
\displaystyle=\delta(G(x,a,m)_{a^{\prime}}).
\displaystyle=\delta(G(x,a,m)_{a^{\prime}}).
\mathbb{P}(M_{a^{\prime}}=m^{\prime}\mid X=x,A=a)
\displaystyle\mathbb{P}(M_{a^{\prime}}=m^{\prime}\mid X=x,A=a)=\mathbb{P}(G(x,%
a,M)_{a^{\prime}}=m^{\prime}|X=x,A=a)
\displaystyle\mathbb{P}(M_{a^{\prime}}=m^{\prime}\mid X=x,A=a)=\mathbb{P}(G(x,%
a,M)_{a^{\prime}}=m^{\prime}|X=x,A=a)
\displaystyle=\int_{\mathcal{M}}\delta(G(x,a,m)_{a^{\prime}}-m^{\prime})\,%
\mathbb{P}(M=m\mid X=x,A=a)\mathop{}\!\mathrm{d}m
\displaystyle=\int_{\mathcal{M}}\delta(G(x,a,m)_{a^{\prime}}-m^{\prime})\,%
\mathbb{P}(M=m\mid X=x,A=a)\mathop{}\!\mathrm{d}m
\displaystyle=\sum_{m:\,G(x,a,m)_{a^{\prime}}=m^{\prime}}\,\lvert\,\nabla_{m}G%
(x,a,m)_{a^{\prime}}\,\rvert^{-1}\,\mathbb{P}(M=m\mid X=x,A=a).
\displaystyle=\sum_{m:\,G(x,a,m)_{a^{\prime}}=m^{\prime}}\,\lvert\,\nabla_{m}G%
(x,a,m)_{a^{\prime}}\,\rvert^{-1}\,\mathbb{P}(M=m\mid X=x,A=a).
\displaystyle\mathbb{P}(M=m^{\prime}\mid X=x,A=a^{\prime})=\sum_{m:\,G(x,a,m)_%
{a^{\prime}}=m^{\prime}}\,\lvert\,\nabla_{m}G(x,a,m)_{a^{\prime}}\,\rvert^{-1}%
\,\mathbb{P}(M=m\mid X=x,A=a).
\displaystyle\mathbb{P}(M=m^{\prime}\mid X=x,A=a^{\prime})=\sum_{m:\,G(x,a,m)_%
{a^{\prime}}=m^{\prime}}\,\lvert\,\nabla_{m}G(x,a,m)_{a^{\prime}}\,\rvert^{-1}%
\,\mathbb{P}(M=m\mid X=x,A=a).
G(x,a,\cdot)
G(x,a,m)_{a^{\prime}}=\mathbb{F}^{-1}(\pm\mathbb{F}(m;x,a)\mp 0.5+0.5;x,a^{%
\prime}),
\mathbb{F}(\cdot;x,a)
\mathbb{F}^{-1}(\cdot;x,a)
\mathbb{P}(M\mid X=x,A=a)
\mathbb{P}(M_{a^{\prime}}\mid X=x,A=a,M=m)
\mathbb{P}(U_{M})
X
\mathcal{N}(0,1)
A
p
\mathrm{\sigma}
X
U_{A}
M
X
A
U_{M}
Y
p_{y}
X
M
U_{Y}
\beta_{i}\ (i\in[1,6])
\sigma(x)=\frac{1}{1+\mathrm{e}^{-x}}
\begin{cases}X=U_{X}&U_{X}\sim\mathcal{N}\left(0,1\right)\\
A\sim\mathrm{Bernoulli}\left(\mathrm{\sigma}(\beta_{1}X+U_{A})\right)&U_{A}%
\sim\mathcal{N}\left(0,0.01\right)\\
M=\beta_{2}X+\beta_{3}A+U_{M}&U_{M}\sim\mathcal{N}\left(0,0.01\right)\\
Y\sim\mathrm{Bernoulli}\left(\mathrm{\sigma}(\beta_{5}X+\beta_{6}M+U_{Y})%
\right)&U_{Y}\sim\mathcal{N}\left(0,0.01\right)\\
\end{cases}
M_{1}
M_{2}
X_{1}
X_{2}
w_{X_{1}},w_{X_{2}},w_{A},w_{M_{1}},w_{M_{2}}
U_{M_{1}},U_{M_{2}},U_{Y}
\sigma(x)=\frac{1}{1+\mathrm{e}^{-x}}
\blacksquare
\begin{cases}M_{1}=w_{M_{1}}\left(\mathrm{\sigma}(w_{A}A+w_{X_{1}}X_{1}+w_{X_{%
2}}X_{2}+U_{M_{1}})\right)&U_{M_{1}}\sim\mathcal{N}\left(0,0.01\right)\\
M_{2}=w_{M_{2}}+w_{M_{1}}\left(\mathrm{\sigma}(w_{A}S+w_{X_{1}}X_{1}+w_{X_{2}}%
X_{2}+U_{M_{2}})\right)&U_{M_{2}}\sim\mathcal{N}\left(0,0.01\right)\\
Y\sim\mathrm{Bernoulli}\left(\mathrm{\sigma}(w_{M_{1}}M_{1}+w_{M_{2}}M_{2}+w_{%
X_{1}}X_{1}+w_{X_{2}}X_{2}+U_{Y})\right)&U_{Y}\sim\mathcal{N}\left(0,0.01%
\right)\\
\end{cases}
\blacksquare
\begin{cases}M_{1}=w_{A}\cdot A-\sin\left(\pi\times\left(w_{X_{1}}X_{1}+w_{X_{%
2}}X_{2}+U_{M_{1}}\right)\right)&U_{M_{1}}\sim\mathcal{N}\left(0,0.01\right)\\
M_{2}=w_{A}\cdot A-\sin\left(\pi\times\left(w_{X_{1}}X_{1}+w_{X_{2}}X_{2}+U_{M%
_{2}}\right)\right)&U_{M_{2}}\sim\mathcal{N}\left(0,0.01\right)\\
Y\sim\mathrm{Bernoulli}\left(\mathrm{\sigma}(w_{M_{1}}M_{1}+w_{M_{2}}M_{2}+w_{%
X_{1}}X_{1}+w_{X_{2}}X_{2}+U_{Y})\right)&U_{Y}\sim\mathcal{N}\left(0,0.01%
\right)\\
\end{cases}
\gamma
\lambda
\lambda=0.1,0.5,1,5,10,15,20
\lambda=0.1,0.5,1,1.5,2
\lambda
0.5
64
300
256
0.0005
30
0.005
U
\gamma\in\{0.1,\ldots,1.0\}
U
\gamma
U
\gamma
U
\gamma
U
\gamma
U
\gamma
U
\gamma
\lambda
\lambda=0.5
\lambda=1000
\lambda
\mathcal{R}_{\mathrm{{cm}}}
\lambda=0
\lambda=0.5
\lambda=0
\lambda=0.5
\lambda=1
\lambda=5
\lambda=1
\lambda=5
\lambda=10
\lambda=100
\lambda=10
\lambda=100
\lambda=500
\lambda=1000
\lambda=500
\lambda=1000
