d
N
K
\tilde{\mathcal{O}}(d\sqrt{T})
T
\tilde{\mathcal{O}}(\sqrt{dT})
\sqrt{d}
K
N
d
t
\tilde{\mathcal{O}}(\sqrt{NT})
\Omega(\sqrt{NT/K})
\tilde{\mathcal{O}}(\sqrt{NT})
\tilde{\mathcal{O}}(d\sqrt{T})^{*}
\Omega(\sqrt{NT})
\equiv\Omega(\sqrt{dT})
\tilde{\mathcal{O}}(Kd\sqrt{T})
\tilde{\mathcal{O}}(d\sqrt{T})
\Omega(d\sqrt{T}/K)
\tilde{\mathcal{O}}(d\sqrt{T})^{*}
\tilde{\mathcal{O}}(d^{3/2}\sqrt{T})
\tilde{\mathcal{O}}(d\sqrt{T})
\tilde{\mathcal{O}}(\sqrt{dT})
T
K
N
d
\tilde{\mathcal{O}}
\mathcal{O}
T
K
N
d
\tilde{\mathcal{O}}
\mathcal{O}
N
\tilde{\mathcal{O}}(d\sqrt{T})
\tilde{\mathcal{O}}(\sqrt{dT})
\sqrt{d}
\tilde{\mathcal{O}}(\sqrt{dT})
\sqrt{d}
x\in\mathbb{R}^{d}
\|x\|
\ell_{2}
\ell_{2}
V
\|x\|_{V}:=\sqrt{x^{\top}Vx}
V
\lambda_{\min}(V)
\lambda_{\max}(V)
V
\text{trace}(V)
V
W
V\succeq W
V-W
n
[n]=\{1,2,...,n\}
\mathcal{S}
K
\mathcal{S}=\{S\subset[N]:|S|\leq K\}
\mathcal{S}
\mathcal{S}
[N]
N
t
x_{ti}\in\mathbb{R}^{d}
i\in[N]
t
S_{t}=\{i_{1},\ldots,i_{\ell}\}\in\mathcal{S}
\ell\leq K
c_{t}\in S_{t}\cup\{0\}
\{0\}
S_{t}
i_{k}\in S_{t}
\displaystyle p_{t}(i_{k}|S_{t},\theta^{*})=\frac{\exp\{x_{ti_{k}}^{\top}%
\theta^{*}\}}{1+\sum_{j\in S_{t}}\exp\{x_{tj}^{\top}\theta^{*}\}},
\displaystyle p_{t}(i_{k}|S_{t},\theta^{*})
\displaystyle=\frac{\exp\{x_{ti_{k}}^{\top}\theta^{*}\}}{1+\sum_{j\in S_{t}}%
\exp\{x_{tj}^{\top}\theta^{*}\}},
\displaystyle p_{t}(0|S_{t},\theta^{*})=\frac{1}{1+\sum_{j\in S_{t}}\exp\{x_{%
tj}^{\top}\theta^{*}\}}
\displaystyle p_{t}(0|S_{t},\theta^{*})
\displaystyle=\frac{1}{1+\sum_{j\in S_{t}}\exp\{x_{tj}^{\top}\theta^{*}\}}
\theta^{*}\in\mathbb{R}^{d}
i_{k}\in S_{t}
y_{ti_{k}}:=\mathbb{1}(c_{t}=i_{k})\in\{0,1\}
y_{t0}:=\mathbb{1}(c_{t}=0)
y_{t}=(y_{t0},y_{ti_{1}},...,y_{ti_{\ell}})
y_{t}\sim\text{multinomial}\left\{1,\left(p_{t}(0|S_{t},\theta^{*}),...,p_{t}(%
i_{\ell}|S_{t},\theta^{*})\right)\right\}
1
y_{t}
y_{t0}+\sum_{k=1}^{\ell}y_{ti_{k}}=1
i\in S_{t}\cup\{0\}
t
\epsilon_{ti}:=y_{ti}-p_{t}(i|S_{t},\theta^{*})
\epsilon_{ti}
[0,1]
\epsilon_{ti}
\sigma^{2}
\sigma^{2}=1/4
\epsilon_{ti}
i\in S_{t}
r_{ti}
t
r_{ti}
i
t
|r_{ti}|\leq 1
i
t
S_{t}
R_{t}(S_{t},\theta^{*})=\sum_{i\in S_{t}}r_{ti}p_{t}(i|S_{t},\theta^{*})
S^{*}_{t}
t
\theta^{*}
p_{t}(i|S,\theta^{*})
S^{*}_{t}=\argmax_{S\subset\mathcal{S}}{R_{t}(S,\theta^{*})}.
\theta^{*}
S_{t}
t
S_{\tau}
\tau<t
\mathcal{R}_{T}
T
\mathcal{R}_{T}=\mathbb{E}\left[\sum_{t=1}^{T}\Big{(}R_{t}(S^{*}_{t},\theta^{*%
})-R_{t}(S_{t},\theta^{*})\Big{)}\right]
R_{t}(S^{*}_{t},\theta^{*})
t
\theta^{*}
\theta^{*}
y_{t}\in\{0,1\}^{|S_{t}|+1}
y_{ti}
i
y_{t}
\theta
\ell_{n}(\theta):=-\sum_{t=1}^{n}\sum_{i\in S_{t}\cup\{0\}}y_{ti}\log p_{t}(i|%
S_{t},\theta)
\theta
\nabla_{\theta}\ell(\theta)=\sum_{t=1}^{n}\sum_{i\in S_{t}}(p_{t}(i|S_{t},%
\theta)-y_{ti})x_{ti}
n
\hat{\theta}_{n}
\hat{\theta}_{n}-\theta^{*}\rightarrow\mathcal{N}(0,\mathcal{I}^{-1}_{\theta^{%
*}})
\mathcal{I}_{\theta^{*}}
\mathcal{I}_{\theta^{*}}
\sum_{t}\sum_{i\in S_{t}}p_{t}(i|\theta^{*})p_{t}(0|\theta^{*})x_{ti}x_{ti}^{\top}
p_{t}(i|\theta^{*})p_{t}(0|\theta^{*})\geq\kappa>0
\mathcal{I}_{\theta^{*}}
x^{\top}\hat{\theta}
x
\theta^{\ast}
K
t
\mathcal{C}_{t}
\theta^{*}
\{x_{t^{\prime}i},i\in S_{t^{\prime}}\}_{t^{\prime}\leq t}
y_{1},...,y_{t-1}
\hat{\theta}_{t}
\theta^{*}
t
\theta^{*}
\mathcal{C}_{t}
\hat{\theta}_{t}
\alpha_{t}>0
\alpha_{t}
\alpha_{t}
\alpha_{t}
\argmax_{S\in\mathcal{S}}R_{t}(S,\hat{\theta}_{t})
S
R_{t}(S,\theta)
\theta
\mathcal{C}_{t}
{N\choose K}
N
K
z_{ti}
S
z_{ti}:=x_{ti}^{\top}\hat{\theta}_{t-1}+\alpha_{t}\|x_{ti}\|_{V^{-1}_{t-1}}
V_{t}=\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t}}x_{t^{\prime}i}x_{t^{\prime}i}^{%
\top}\in\mathbb{R}^{d\times d}
z_{ti}
x_{ti}^{\top}\hat{\theta}_{t-1}
\alpha_{t}\|x_{ti}\|_{V^{-1}_{t-1}}
z_{ti}
x_{ti}^{\top}\theta^{*}
\theta^{*}
\hat{\theta}_{t-1}
z_{ti}
\tilde{R}_{t}(S):=\frac{\sum_{i\in S}r_{ti}\exp\left(z_{ti}\right)}{1+\sum_{j%
\in S}\exp\left(z_{tj}\right)}\,.
t
S_{t}=\arg\max_{S\subset\mathcal{S}}\tilde{R}_{t}(S)
T_{0}
\alpha_{t}
t\in[T_{0}]
S_{t}
|S_{t}|=K
V_{t}\leftarrow V_{t-1}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
t=T_{0}+1
T
z_{ti}=x_{ti}^{\top}\hat{\theta}_{t-1}+\alpha_{t}\|x_{ti}\|_{V^{-1}_{t-1}}
i
S_{t}=\argmax_{S\subset\mathcal{S}}\tilde{R}_{t}(S)
y_{t}
V_{t}\leftarrow V_{t-1}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\hat{\theta}_{t}
\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}\big{(}p_{t^{\prime}}(i|S_{t^%
{\prime}},\hat{\theta}_{t})-y_{t^{\prime}i}\big{)}x_{t^{\prime}i}=\vec{0}
S_{t}
K
S_{t}
K
T_{0}
\lambda_{\min}(V_{T_{0}})
x_{ti}
p_{x}
\|x_{ti}\|\leq 1
t,i
\sigma_{0}>0
\mathbb{E}[x_{ti}x_{ti}^{\top}]\geq\sigma_{0}
\kappa>0
i\in S
S\in\mathcal{S}
t
\min_{\|\theta-\theta^{*}\|\leq 1}p_{t}(i|S,\theta)p_{t}(0|S,\theta)\geq\kappa
\alpha_{t}=\frac{1}{2\kappa}\sqrt{2d\log\left(1+\frac{t}{d}\right)+2\log t}
T_{0}=\Ocal(\max\{\kappa^{-2}\left(d\log(T/d)+4\log T\right),K/\sigma^{2}\})
\displaystyle\mathcal{R}_{T}=\mathcal{O}\left(d\sqrt{T\log\left(1+T/d\right)%
\log(T/d)}\right).
\displaystyle\mathcal{R}_{T}
\displaystyle=\mathcal{O}\left(d\sqrt{T\log\left(1+T/d\right)\log(T/d)}\right).
\tilde{\mathcal{O}}(d\sqrt{T})
N
\Omega(d\sqrt{T}/K)
K
\sqrt{d}
\tilde{\mathcal{O}}(d\sqrt{T})
N
K
\tilde{\mathcal{O}}(d\sqrt{T})
\tilde{\mathcal{O}}(d\sqrt{T})
\tilde{\mathcal{O}}(d\sqrt{T})
d
d
x^{\top}(\theta^{*}-\hat{\theta}_{t})
|x^{\top}\hat{\theta}_{t}-x^{\top}\theta^{*}|\leq\|x\|_{V^{-1}_{t}}\|\hat{%
\theta}_{t}-\theta^{*}\|_{V_{t}}
\tilde{\mathcal{O}}(\sqrt{d})
d
|x^{\top}(\hat{\theta}_{t}-\theta^{*})|
y_{1},...,y_{n}
\{x_{ti}\}_{t=1,i=1}^{n,K}
V_{n}=\sum_{t=1}^{n}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\delta>0
\lambda_{\min}(V_{n})\geq\max\!\left\{\frac{9\Dcal^{4}}{\kappa^{4}\log(1/%
\delta)},\frac{144\Dcal^{2}}{\kappa^{4}}\right\}
\Dcal:=\min\!\left\{4\sqrt{2d+\log\frac{1}{\delta}},\sqrt{d\log\!\left(n/d%
\right)+2\log\frac{1}{\delta}}\right\}
x\in\mathbb{R}^{d}
\hat{\theta}_{n}
1-3\delta
|x^{\top}\hat{\theta}_{n}-x^{\top}\theta^{*}|\leq\frac{5}{\kappa}\sqrt{\log%
\frac{1}{\delta}}\|x\|_{V^{-1}_{n}}\,.
\tilde{\mathcal{O}}(\sqrt{d})
i\in S_{t}
S_{t}
\tilde{\Ocal}(\sqrt{dT})
\Omega(\sqrt{NT})
\Omega(\sqrt{dT})
\tilde{\mathcal{O}}(\sqrt{dT})
\tilde{\Ocal}(\sqrt{dT})
q_{k}
\beta_{k}
\tau_{1}\leftarrow d
t\leftarrow 1
V_{0}\leftarrow\vec{0}_{d\times d}
t\in[d]
S_{t}\in\mathcal{S}
|S_{t}|=K
V_{t}\leftarrow V_{t-1}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
k=2,3,...
k
\tau_{k}\leftarrow 2^{k-1}
\hat{\theta}_{k}
\sum_{t=\tau_{k-2}+1}^{\tau_{k-1}}\sum_{i\in S_{t}}\big{(}p_{t}(i|S_{t},\hat{%
\theta}_{k})-y_{ti}\big{)}x_{ti}=\vec{0}
W_{k-1}\leftarrow V_{\tau_{k-1}+1}
V_{\tau_{k-1}+1}\leftarrow 0_{d\times d}
t=\tau_{k-1}+1,...,\tau_{k}
\tau_{k}-t\leq q_{k}
\lambda_{\min}(V_{t})\leq\frac{Kq_{k}\sigma_{0}}{2}
S_{t}\in\mathcal{S}
|S_{t}|=K
S_{t}=\argmax_{S\in\mathcal{S}}\tilde{R}_{t}(S)
V_{t+1}\leftarrow V_{t}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
t
k
\displaystyle\tilde{z}_{ti}=x_{ti}^{\top}\hat{\theta}_{k}+\alpha_{k}\|x_{ti}\|%
_{W_{k-1}^{-1}}
\displaystyle\tilde{z}_{ti}=x_{ti}^{\top}\hat{\theta}_{k}+\alpha_{k}\|x_{ti}\|%
_{W_{k-1}^{-1}}
\displaystyle\text{where }W_{k-1}=\sum_{t^{\prime}=\tau_{k-1}+1}^{\tau_{k-1}}%
\sum_{i\in S_{t^{\prime}}}x_{t^{\prime}i}x_{t^{\prime}i}^{\top}
\displaystyle\text{where }W_{k-1}=\sum_{t^{\prime}=\tau_{k-1}+1}^{\tau_{k-1}}%
\sum_{i\in S_{t^{\prime}}}x_{t^{\prime}i}x_{t^{\prime}i}^{\top}
\tau_{k-1}
k-1
k
k-1
\lambda_{\min}(V_{t})
\lambda_{\min}(V_{t})
t
\Ocal(\log T)
\lambda_{\min}(V_{t})
\tilde{\Ocal}(\sqrt{dT})
p_{X}
\rho_{0}<\infty
\frac{p_{X}(-x)}{p_{X}(x)}\leq\rho_{0}
x
p_{\mathcal{X}}
\rho_{0}=1
r_{i}\equiv r
T
\Rcal_{T}=\Ocal\big{(}\sqrt{dT\log\left(T/d\right)\log(TN)\log(T)}\big{)}
\tilde{\Ocal}(\sqrt{dT})
\tilde{\Ocal}(\sqrt{dT})
N
N
\tilde{\Ocal}(\sqrt{dT})
N
T
T
T
L
L=\lfloor\log_{2}T\rfloor+1
\Tcal_{k}:=\{\tau_{k-1}+1,...,\tau_{k}\}
k
k
|\Tcal_{k}|=\tau_{k}/2
\texttt{Reg}(k\text{-th episode})
k
\displaystyle\texttt{Reg}(k\text{-th episode}):=\mathbb{E}\left[\sum_{t\in%
\Tcal_{k}}\Big{(}R_{t}(S^{*}_{t},\theta^{*})-R_{t}(S_{t},\theta^{*})\Big{)}\right]
\displaystyle\texttt{Reg}(k\text{-th episode}):=\mathbb{E}\left[\sum_{t\in%
\Tcal_{k}}\Big{(}R_{t}(S^{*}_{t},\theta^{*})-R_{t}(S_{t},\theta^{*})\Big{)}\right]
T
\mathcal{R}(T)=\sum_{k=1}^{L}\texttt{Reg}(k\text{-th episode})
\texttt{Reg}(k\text{-th episode})
k\in[L]
|\Tcal_{k}|\leq q_{k}
\lambda_{\min}(V_{t})
T
|\Tcal_{k}|>q_{k}
\lambda_{\min}(V_{t})
\lambda_{\min}(V_{t})
t
\lambda_{\min}(V_{t})
\lambda_{\min}(V_{t})
q_{k}\leq q_{L}
k\in\{1,...,L\}
|\Tcal_{k}|
q_{L}
k
q_{L}
T
k^{\prime}
|\Tcal_{k^{\prime}}|\geq q_{L}
|\Tcal_{k^{\prime}}|\leq 2q_{L}
k^{\prime}
\Ocal\!\left(\log d+d^{2}+\log^{2}(TN)\right)
k^{\prime\prime}
|\Tcal_{k^{\prime\prime}}|\geq q_{k^{\prime\prime}}
k^{\prime\prime}\leq k^{\prime}
\displaystyle\sum_{k=1}^{k^{\prime\prime}-1}\texttt{Reg}(k\text{-th episode})%
\leq\sum_{k=1}^{k^{\prime}-1}\texttt{Reg}(k\text{-th episode})\,.
\displaystyle\sum_{k=1}^{k^{\prime\prime}-1}\texttt{Reg}(k\text{-th episode})%
\leq\sum_{k=1}^{k^{\prime}-1}\texttt{Reg}(k\text{-th episode})\,.
T
\lambda_{\min}(V_{t})
q_{k}
\lambda_{\min}(V_{\tau_{k}})\geq\max\!\left\{\frac{9\Dcal_{k}^{4}}{\kappa^{4}%
\log(\tau_{k}N/2)},\frac{144\Dcal_{k}^{2}}{\kappa^{4}}\right\}
k\in[L]
k
(k-1)
\lambda_{\min}(V_{\tau_{k-1}})
(k-1)
\lambda_{\min}(V_{\tau_{k-1}})
\displaystyle|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\beta_{k}\|x_{ti}%
\|_{W^{-1}_{k-1}},\enskip\forall i\in[N],\forall t\in\Tcal_{k}
\displaystyle|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\beta_{k}\|x_{ti}%
\|_{W^{-1}_{k-1}},\enskip\forall i\in[N],\forall t\in\Tcal_{k}
\beta_{k}
k
\tilde{\Ocal}(\sqrt{d\tau_{k}})
\tilde{\Ocal}(\sqrt{dT})
t\in\{1,...,T\}
\theta^{*}
d
\theta^{*}
[0,1]
r_{ti}=1
i
t
T
1000
5000
N=100,K=5,d=5
N=100,K=5,d=5
\mathcal{O}(N^{2}\log^{2}T)
\mathcal{O}(N\log T)
\tilde{\mathcal{O}}(d\sqrt{T})
N
K
N
K
N
K
d^{3/2}\sqrt{T}
\Omega(d\sqrt{T}/K)
K
\Omega(\sqrt{dT})
\Omega(\sqrt{NT})
\|\hat{\theta}_{t}-\theta^{*}\|_{V_{t}}
\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|_{V^{-1}_{%
t^{\prime}-1}}
T_{0}
\lambda_{\min}(V_{T_{0}})
\|\hat{\theta}_{t}-\theta^{*}\|\leq 1
t>T_{0}
T_{0}
x_{t^{\prime}i}
\nu
\|x_{t^{\prime}i}\|\leq 1
\mathbb{E}[x_{t^{\prime}i}x_{t^{\prime}i}^{\top}]\geq\sigma_{0}
V_{T_{0}}=\sum^{T_{0}}_{t^{\prime}=1}\sum_{i\in S_{t^{\prime}}}x_{t^{\prime}i}%
x_{t^{\prime}i}^{\top}
T_{0}
K
T_{0}
\displaystyle T_{0}\geq\frac{1}{K}\left(\frac{C_{1}\sqrt{d}+C_{2}\sqrt{2\log T%
}}{\sigma_{0}}\right)^{2}+\frac{2B}{K\sigma_{0}}
\displaystyle T_{0}\geq\frac{1}{K}\left(\frac{C_{1}\sqrt{d}+C_{2}\sqrt{2\log T%
}}{\sigma_{0}}\right)^{2}+\frac{2B}{K\sigma_{0}}
C_{1}
C_{2}
\lambda_{\min}(V_{T_{0}})\geq B
1-\frac{1}{T^{2}}
\lambda_{\min}(V_{T_{0}})\geq K
\mathcal{O}(\sigma_{0}^{-2}(d+\log T))
x_{ti}
V_{T_{0}}
x_{ti}
\|x_{ti}\|
\lambda_{\min}(V_{T_{0}})
\|\hat{\theta}_{t}-\theta^{*}\|\leq 1
t>T_{0}
\lambda_{\min}(V_{T_{0}})
T_{0}
\displaystyle\lambda_{\min}(V_{T_{0}})\geq\max\left\{\sigma^{2}\kappa^{-2}%
\left(d\log(T/d)+4\log T\right),K\right\}.
\displaystyle\lambda_{\min}(V_{T_{0}})\geq\max\left\{\sigma^{2}\kappa^{-2}%
\left(d\log(T/d)+4\log T\right),K\right\}.
t\geq T_{0}
\mathbb{P}\left(\|\hat{\theta}_{t}-\theta^{*}\|>1\right)\leq\frac{1}{T^{2}}
\theta^{*}
\hat{\theta}_{t}
V_{t}
\ell_{2}
\lambda_{\min}(V_{T_{0}})
K
\|\hat{\theta}_{t}-\theta^{*}\|\leq 1
t>T_{0}
\|\hat{\theta}_{t}-\theta^{*}\|_{V_{t}}\leq\frac{1}{2\kappa}\sqrt{2d\log\left(%
1+\frac{t}{d}\right)+2\log t}
t>T_{0}
1-\mathcal{O}(t^{-2})
\|\hat{\theta}_{t}-\theta^{*}\|\leq 1
\alpha_{t}=\frac{1}{2\kappa}\sqrt{2d\log\left(1+\frac{t}{d}\right)+2\log t}
z_{ti}
x^{\top}_{ti}\theta^{*}
\theta^{*}
\hat{\theta}_{t}
z_{ti}=x_{ti}^{\top}\hat{\theta}_{t-1}+\alpha_{t}\|x_{ti}\|_{V^{-1}_{t}}
0\leq z_{ti}-x^{\top}_{ti}\theta^{*}\leq 2\alpha_{t}\|x_{ti}\|_{V^{-1}_{t}}.
\tilde{R}_{t}(S_{t})
R_{t}(S^{*}_{t},\theta^{*})
S^{*}_{t}
S_{t}=\arg\max_{S\subset\mathcal{S}}\tilde{R}_{t}(S)
i\in S^{*}_{t}
z_{ti}\geq x^{\top}_{i}\theta^{*}
t
R_{t}(S^{*}_{t},\theta^{*})\leq\tilde{R}_{t}(S^{*}_{t})\leq\tilde{R}_{t}(S_{t}).
0\leq z_{ti}-x^{\top}_{ti}\theta^{*}\leq 2\alpha_{t}\|x_{ti}\|_{V^{-1}_{t}}
i\in S_{t}
S_{t}
t
\tilde{R}_{t}(S_{t})-R_{t}(S_{t},\theta^{*})\leq 2\alpha_{t}\max_{i\in S_{t}}%
\|x_{ti}\|_{V^{-1}_{t}}
\sum_{t=1}^{T}\max_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t}}
\tilde{\mathcal{O}}(\sqrt{dT})
V_{T_{0}}=\sum^{T_{0}}_{t=1}\sum_{i\in S_{t^{\prime}}}x_{ti}x_{ti}^{\top}
V_{T}=V_{T_{0}}+\sum_{t=V_{0}+1}^{T}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\lambda_{\min}(V_{T_{0}})\geq K
\sum_{t=1}^{T}\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t}}\leq 2d\log\left(T/d\right)
\sqrt{d}
d
\displaystyle\hat{\mathcal{E}}:=\left\{\|\hat{\theta}_{t}-\theta^{*}\|\leq 1,%
\enskip\|\hat{\theta}_{t}-\theta^{*}\|_{V_{t}}\leq\alpha_{t},\forall t\geq T_{%
0}\right\}
\displaystyle\hat{\mathcal{E}}
\displaystyle:=\left\{\|\hat{\theta}_{t}-\theta^{*}\|\leq 1,\enskip\|\hat{%
\theta}_{t}-\theta^{*}\|_{V_{t}}\leq\alpha_{t},\forall t\geq T_{0}\right\}
T_{0}=\max\left\{\frac{\sigma^{2}\left(d\log(T/d)+4\log T\right)}{K\sigma_{0}%
\kappa^{2}},\frac{d+\log T}{\sigma_{0}^{2}}\right\}
\displaystyle\lambda_{\min}(V_{T_{0}})\geq\max\left\{\sigma^{2}\kappa^{-2}%
\left(d\log(T/d)+4\log T\right),K\right\}
\displaystyle\lambda_{\min}(V_{T_{0}})\geq\max\left\{\sigma^{2}\kappa^{-2}%
\left(d\log(T/d)+4\log T\right),K\right\}
\|\hat{\theta}_{t}-\theta^{*}\|\leq 1
\displaystyle\mathcal{R}_{T}=\mathbb{E}\left[\sum_{t=1}^{T_{0}}\left(R(S^{*}_{%
t},\theta^{*})-R(S_{t},\theta^{*})\right)\right]+\mathbb{E}\left[\sum_{t=T_{0}%
+1}^{T}\left(R(S^{*}_{t},\theta^{*})-R(S_{t},\theta^{*})\right)\right]
\displaystyle\mathcal{R}_{T}
\displaystyle=\mathbb{E}\left[\sum_{t=1}^{T_{0}}\left(R(S^{*}_{t},\theta^{*})-%
R(S_{t},\theta^{*})\right)\right]+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(R(%
S^{*}_{t},\theta^{*})-R(S_{t},\theta^{*})\right)\right]
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R(S_{t},\theta^{*})\right)\right]
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R(S_{t},\theta^{*})\right)\right]
\hat{\mathcal{E}}
\hat{\mathcal{E}}^{c}
\displaystyle\mathcal{R}_{T}\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}%
\left(\tilde{R}_{t}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\hat{%
\mathcal{E}})\right]+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t}(S%
_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\hat{\mathcal{E}}^{c})\right]
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\hat{\mathcal{E}})\right]+%
\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t}(S_{t})-R_{t}(S_{t},%
\theta^{*})\right)\mathbb{1}(\hat{\mathcal{E}}^{c})\right]
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\hat{\mathcal{E}})\right]+%
\sum_{t=1}^{T}\mathcal{O}(t^{-2})
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\hat{\mathcal{E}})\right]+%
\sum_{t=1}^{T}\mathcal{O}(t^{-2})
\displaystyle\leq T_{0}+\sum_{t=1}^{T}2\alpha_{T}\max_{i\in S_{t}}\|x_{ti}\|_{%
V^{-1}_{t}}+\mathcal{O}(1)
\displaystyle\leq T_{0}+\sum_{t=1}^{T}2\alpha_{T}\max_{i\in S_{t}}\|x_{ti}\|_{%
V^{-1}_{t}}+\mathcal{O}(1)
\displaystyle\mathcal{R}_{T}\leq T_{0}+2\alpha_{T}\sqrt{T\sum_{t=1}^{T}\max_{i%
\in S_{t}}\|x_{ti}\|_{V^{-1}_{t}}^{2}}+\mathcal{O}(1).
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+2\alpha_{T}\sqrt{T\sum_{t=1}^{T}\max_{i\in S_{t}}\|x_{%
ti}\|_{V^{-1}_{t}}^{2}}+\mathcal{O}(1).
\sum_{t=1}^{T}\max_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t}}^{2}
\displaystyle\mathcal{R}_{T}\leq T_{0}+2\alpha_{T}\sqrt{2dT\log\left(T/d\right%
)}+\mathcal{O}(1).
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+2\alpha_{T}\sqrt{2dT\log\left(T/d\right)}+\mathcal{O}(%
1).
\alpha_{T}=\frac{\sigma}{\kappa}\sqrt{2d\log\left(1+\frac{T}{d}\right)+\log T}
\displaystyle\mathcal{R}_{T}\leq T_{0}+\frac{d}{\kappa}\sqrt{T\log\left(1+T/d%
\right)\log(T/d)}+\frac{1}{\kappa}\sqrt{d\log T\log\left(T/d\right)}+\mathcal{%
O}(1).
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+\frac{d}{\kappa}\sqrt{T\log\left(1+T/d\right)\log(T/d)%
}+\frac{1}{\kappa}\sqrt{d\log T\log\left(T/d\right)}+\mathcal{O}(1).
\displaystyle J_{n}(\theta)=\sum_{t=1}^{n-1}\sum_{i\in S_{t}}\left(p_{t}(i|S_{%
t},\theta)-p_{t}(i|S_{t},\theta^{*})\right)x_{ti}
\displaystyle J_{n}(\theta)
\displaystyle=\sum_{t=1}^{n-1}\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-p_{%
t}(i|S_{t},\theta^{*})\right)x_{ti}
\displaystyle Z_{n}:=J_{n}(\hat{\theta})=\sum^{n}_{t=1}\sum_{i\in S_{t}}%
\epsilon_{ti}x_{ti}\,.
\displaystyle Z_{n}
\displaystyle:=J_{n}(\hat{\theta})=\sum^{n}_{t=1}\sum_{i\in S_{t}}\epsilon_{ti%
}x_{ti}\,.
\|Z_{n}\|_{V^{-1}_{n}}=\|J_{n}(\hat{\theta})\|_{V^{-1}_{n}}\geq\kappa^{2}\|%
\hat{\theta}-\theta^{*}\|^{2}_{V_{n}}
\hat{\theta}\in\{\theta:\|\theta-\theta^{*}\|\leq 1\}
\|Z_{n}\|^{2}_{V^{-1}_{n}}
\epsilon_{ti}
\sigma
\|Z_{n}\|_{V^{-1}_{n}}^{2}\leq 2\sigma^{2}\log\left(\frac{\det(V_{n})^{1/2}%
\det(V_{T_{0}})^{-1/2}}{\delta}\right)
1-\delta
\displaystyle\|Z_{n}\|_{V^{-1}_{n}}^{2}\leq 2\sigma^{2}\left[\frac{d}{2}\log%
\left(\frac{\text{trace}(V_{T_{0}})+nK}{d}\right)-\frac{1}{2}\log\det(V_{T_{0}%
})+\log\frac{1}{\delta}\right].
\displaystyle\|Z_{n}\|_{V^{-1}_{n}}^{2}
\displaystyle\leq 2\sigma^{2}\left[\frac{d}{2}\log\left(\frac{\text{trace}(V_{%
T_{0}})+nK}{d}\right)-\frac{1}{2}\log\det(V_{T_{0}})+\log\frac{1}{\delta}%
\right].
\lambda_{1},...,\lambda_{d}
V_{T_{0}}
\bar{\lambda}=\frac{\sum_{i}\lambda_{i}}{d}
\displaystyle\|Z_{n}\|_{V^{-1}_{n}}^{2}\leq 2\sigma^{2}\left[\frac{d}{2}\log%
\left(\bar{\lambda}+\frac{nK}{d}\right)-\frac{d}{2}\log\bar{\lambda}+\frac{d}{%
2}\log\bar{\lambda}-\frac{1}{2}\log\det(V_{T_{0}})+\log\frac{1}{\delta}\right]
\displaystyle\|Z_{n}\|_{V^{-1}_{n}}^{2}
\displaystyle\leq 2\sigma^{2}\left[\frac{d}{2}\log\left(\bar{\lambda}+\frac{nK%
}{d}\right)-\frac{d}{2}\log\bar{\lambda}+\frac{d}{2}\log\bar{\lambda}-\frac{1}%
{2}\log\det(V_{T_{0}})+\log\frac{1}{\delta}\right]
\displaystyle=2\sigma^{2}\left[\frac{d}{2}\log\left(1+\frac{nK}{d\bar{\lambda}%
}\right)+\frac{1}{2}\sum_{i}\log\frac{\bar{\lambda}}{\lambda_{i}}+\log\frac{1}%
{\delta}\right]
\displaystyle=2\sigma^{2}\left[\frac{d}{2}\log\left(1+\frac{nK}{d\bar{\lambda}%
}\right)+\frac{1}{2}\sum_{i}\log\frac{\bar{\lambda}}{\lambda_{i}}+\log\frac{1}%
{\delta}\right]
\displaystyle\leq 2\sigma^{2}\left[\frac{d}{2}\log\left(1+\frac{nK}{d\lambda_{%
\min}(V_{T_{0}})}\right)+\frac{d}{2}\log\frac{\bar{\lambda}}{\lambda_{\min}(V_%
{T_{0}})}+\log\frac{1}{\delta}\right]
\displaystyle\leq 2\sigma^{2}\left[\frac{d}{2}\log\left(1+\frac{nK}{d\lambda_{%
\min}(V_{T_{0}})}\right)+\frac{d}{2}\log\frac{\bar{\lambda}}{\lambda_{\min}(V_%
{T_{0}})}+\log\frac{1}{\delta}\right]
\displaystyle\leq 2\sigma^{2}\left[\frac{d}{2}\log\left(1+\frac{n}{d}\right)+%
\frac{d}{2}\log\frac{\bar{\lambda}}{K}+\log\frac{1}{\delta}\right]
\displaystyle\leq 2\sigma^{2}\left[\frac{d}{2}\log\left(1+\frac{n}{d}\right)+%
\frac{d}{2}\log\frac{\bar{\lambda}}{K}+\log\frac{1}{\delta}\right]
\displaystyle\leq 2\sigma^{2}\left[d\log\left(1+\frac{n}{d}\right)+\log\frac{1%
}{\delta}\right]
\displaystyle\leq 2\sigma^{2}\left[d\log\left(1+\frac{n}{d}\right)+\log\frac{1%
}{\delta}\right]
\lambda_{\min}(V_{T_{0}})\geq K
d\bar{\lambda}=\text{trace}(V_{T_{0}})\leq nK
\sigma^{2}=\frac{1}{4}
\|\hat{\theta}_{n}-\theta^{*}\|_{V_{n}}\leq\frac{1}{2\kappa}\sqrt{2d\log\left(%
1+\frac{n}{d}\right)+\log\frac{1}{\delta}}.
1-\delta
V_{T_{0}}
\|x_{ti}\|\leq 1
i
t
\displaystyle V_{t}=V_{T_{0}}+\sum_{t^{\prime}=T_{0}+1}^{t}\sum_{i\in S_{t^{%
\prime}}}x_{t^{\prime}i}x_{t^{\prime}i}^{\top}
\lambda_{\min}(V_{T_{0}})\geq K
\sum_{t^{\prime}=T_{0}+1}^{t}\sum_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|_{V^%
{-1}_{t^{\prime}-1}}^{2}\leq 2\log\left(\frac{\det(V_{t})}{\lambda_{\min}(V_{T%
_{0}})^{d}}\right)
\lambda_{1},\lambda_{2},...,\lambda_{d}
\sum_{i=1}^{n}x_{ti}x_{ti}^{\top}
\sum_{i=1}^{n}x_{ti}x_{ti}^{\top}
\lambda_{j}\geq 0
j
\displaystyle\det\left(I+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)=\prod_{j=%
1}^{d}\left(1+\lambda_{j}\right)
\displaystyle\det\left(I+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)
\displaystyle=\prod_{j=1}^{d}\left(1+\lambda_{j}\right)
\displaystyle\geq 1+\sum_{j=1}^{d}\lambda_{j}=1-d+\sum_{j=1}^{d}(1+\lambda_{j})
\displaystyle\geq 1+\sum_{j=1}^{d}\lambda_{j}=1-d+\sum_{j=1}^{d}(1+\lambda_{j})
\displaystyle=1-d+\text{trace}\left(I+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}%
\right)=1+\sum_{i\in S_{t}}\|x_{ti}\|^{2}_{2}
\displaystyle=1-d+\text{trace}\left(I+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}%
\right)=1+\sum_{i\in S_{t}}\|x_{ti}\|^{2}_{2}
\det(V_{t})
\displaystyle\det(V_{t})=\det\left(V_{t}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)
\displaystyle\det(V_{t})
\displaystyle=\det\left(V_{t}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)
\displaystyle=\det(V_{t})\det\left(I+\sum_{i\in S_{t}}V_{t}^{-1/2}x_{ti}(V_{t}%
^{-1/2}x_{ti})^{\top}\right)
\displaystyle=\det(V_{t})\det\left(I+\sum_{i\in S_{t}}V_{t}^{-1/2}x_{ti}(V_{t}%
^{-1/2}x_{ti})^{\top}\right)
\displaystyle\geq\det(V_{t})\left(1+\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t}}^{%
2}\right)
\displaystyle\geq\det(V_{t})\left(1+\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t}}^{%
2}\right)
\displaystyle\geq\det(V_{T_{0}})\prod_{t^{\prime}=T_{0}+1}^{t}\left(1+\sum_{i%
\in S_{t}}\|x_{t^{\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}\right)
\displaystyle\geq\det(V_{T_{0}})\prod_{t^{\prime}=T_{0}+1}^{t}\left(1+\sum_{i%
\in S_{t}}\|x_{t^{\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}\right)
\lambda_{\min}(V_{t})
V_{t}
\|x_{ti}\|_{V^{-1}_{t^{\prime}-1}}^{2}\leq\frac{\|x_{ti}\|^{2}}{\lambda_{\min}%
(V_{\tau-1})}\leq\frac{1}{\lambda_{\min}(V_{T_{0}})}\leq\frac{1}{K}.
\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t^{\prime}-1}}^{2}\leq 1
t\geq T_{0}
z\leq 2\log(1+z)
z\in[0,1]
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\sum_{i\in S_{t^{\prime}}}\|x_{t^{%
\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}\leq 2\sum_{t^{\prime}=T_{0}+1}^{t}\log%
\left(1+\sum_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^%
{2}\right)
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\sum_{i\in S_{t^{\prime}}}\|x_{t^{%
\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}
\displaystyle\leq 2\sum_{t^{\prime}=T_{0}+1}^{t}\log\left(1+\sum_{i\in S_{t^{%
\prime}}}\|x_{t^{\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}\right)
\displaystyle=2\log\prod_{t^{\prime}=T_{0}+1}^{t}\left(1+\sum_{i\in S_{t^{%
\prime}}}\|x_{t^{\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}\right)
\displaystyle=2\log\prod_{t^{\prime}=T_{0}+1}^{t}\left(1+\sum_{i\in S_{t^{%
\prime}}}\|x_{t^{\prime}i}\|_{V^{-1}_{t^{\prime}-1}}^{2}\right)
\displaystyle\leq 2\log\left(\frac{\det(V_{t})}{\det(V_{T_{0}})}\right)
\displaystyle\leq 2\log\left(\frac{\det(V_{t})}{\det(V_{T_{0}})}\right)
\displaystyle\leq 2\log\left(\frac{\det(V_{t})}{\lambda_{\min}(V_{T_{0}})^{d}}\right)
\displaystyle\leq 2\log\left(\frac{\det(V_{t})}{\lambda_{\min}(V_{T_{0}})^{d}}\right)
\|x_{ti}\|\leq 1
i
t
\det(V_{t})
t
\det(V_{t})\leq\left(\frac{tK}{d}\right)^{d}
\tilde{V}\in\mathbb{R}^{d\times d}
x\in\mathbb{R}^{d}
\displaystyle\det(\tilde{V}+xx^{\top})=\det(V)\det\left(I+\tilde{V}^{-1/2}xx^{%
\top}\tilde{V}^{-1/2}\right)
\displaystyle\det(\tilde{V}+xx^{\top})
\displaystyle=\det(V)\det\left(I+\tilde{V}^{-1/2}xx^{\top}\tilde{V}^{-1/2}\right)
\displaystyle=\det(\tilde{V})\det(1+\|\tilde{V}^{-1/2}x\|^{2})
\displaystyle=\det(\tilde{V})\det(1+\|\tilde{V}^{-1/2}x\|^{2})
\displaystyle\geq\det(\tilde{V}).
\displaystyle\geq\det(\tilde{V}).
\det(I+BA)=\det(I+AB)
\lambda_{1},...,\lambda_{d}>0
V_{t}
\displaystyle\det(V_{t})\leq\left(\frac{\lambda_{1}+...+\lambda_{d}}{d}\right)%
^{d}
\displaystyle\det(V_{t})
\displaystyle\leq\left(\frac{\lambda_{1}+...+\lambda_{d}}{d}\right)^{d}
\displaystyle=\left(\frac{\text{trace}(V_{t})}{d}\right)^{d}
\displaystyle=\left(\frac{\text{trace}(V_{t})}{d}\right)^{d}
\displaystyle=\left(\frac{\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}%
\text{trace}(x_{t^{\prime}i}x_{t^{\prime}i}^{\top})}{d}\right)^{d}
\displaystyle=\left(\frac{\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}%
\text{trace}(x_{t^{\prime}i}x_{t^{\prime}i}^{\top})}{d}\right)^{d}
\displaystyle=\left(\frac{\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}\|x%
_{t^{\prime}i}\|_{2}^{2}}{d}\right)^{d}
\displaystyle=\left(\frac{\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}\|x%
_{t^{\prime}i}\|_{2}^{2}}{d}\right)^{d}
\displaystyle\leq\left(\frac{tK}{d}\right)^{d}.
\displaystyle\leq\left(\frac{tK}{d}\right)^{d}.
\displaystyle\sum_{t^{\prime}=1}^{t}\max_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i%
}\|_{V^{-1}_{\tau}}^{2}\leq 2\log\left(\frac{\det(V_{t})}{\det(V_{T_{0}})}%
\right)\leq 2\log\left(\frac{tK}{d\lambda_{\min}(V_{T_{0}})}\right)^{d}\leq 2d%
\log\left(t/d\right).
\displaystyle\sum_{t^{\prime}=1}^{t}\max_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i%
}\|_{V^{-1}_{\tau}}^{2}\leq 2\log\left(\frac{\det(V_{t})}{\det(V_{T_{0}})}%
\right)\leq 2\log\left(\frac{tK}{d\lambda_{\min}(V_{T_{0}})}\right)^{d}\leq 2d%
\log\left(t/d\right).
\lambda_{\min}(V_{T_{0}})\geq K
\displaystyle|x_{ti}^{\top}\hat{\theta}_{t-1}-x_{ti}^{\top}\theta^{*}|=\left|%
\left[V^{-1/2}_{t-1}(\hat{\theta}_{t-1}-\theta^{*})\right]^{\top}(V^{-1/2}_{t-%
1}x_{ti})\right|
\displaystyle|x_{ti}^{\top}\hat{\theta}_{t-1}-x_{ti}^{\top}\theta^{*}|
\displaystyle=\left|\left[V^{-1/2}_{t-1}(\hat{\theta}_{t-1}-\theta^{*})\right]%
^{\top}(V^{-1/2}_{t-1}x_{ti})\right|
\displaystyle\leq\|V^{-1/2}_{t-1}(\hat{\theta}_{t-1}-\theta^{*})\|_{2}\|(V^{-1%
/2}_{t-1}x_{ti})\|_{2}
\displaystyle\leq\|V^{-1/2}_{t-1}(\hat{\theta}_{t-1}-\theta^{*})\|_{2}\|(V^{-1%
/2}_{t-1}x_{ti})\|_{2}
\displaystyle=\|\hat{\theta}_{t-1}-\theta^{*}\|_{V_{t}}\|x_{ti}\|_{V^{-1}_{t}}
\displaystyle=\|\hat{\theta}_{t-1}-\theta^{*}\|_{V_{t}}\|x_{ti}\|_{V^{-1}_{t}}
\displaystyle\leq\alpha\|x_{ti}\|_{V^{-1}_{t}}
\displaystyle\leq\alpha\|x_{ti}\|_{V^{-1}_{t}}
\displaystyle\left(x_{ti}^{\top}\hat{\theta}_{t-1}+\alpha\|x_{ti}\|_{V^{-1}_{t%
}}\right)-x_{ti}^{\top}\theta^{*}\leq 2\alpha\|x_{ti}\|_{V^{-1}_{t}}.
\displaystyle\left(x_{ti}^{\top}\hat{\theta}_{t-1}+\alpha\|x_{ti}\|_{V^{-1}_{t%
}}\right)-x_{ti}^{\top}\theta^{*}\leq 2\alpha\|x_{ti}\|_{V^{-1}_{t}}.
|x_{ti}^{\top}\hat{\theta}_{t-1}-x_{ti}^{\top}\theta^{*}|\leq\alpha\|x_{ti}\|_%
{V^{-1}_{t}}
\displaystyle x_{ti}^{\top}\hat{\theta}_{t-1}-x_{ti}^{\top}\theta^{*}\geq-%
\alpha\|x_{ti}\|_{V^{-1}_{t}}
\displaystyle x_{ti}^{\top}\hat{\theta}_{t-1}-x_{ti}^{\top}\theta^{*}\geq-%
\alpha\|x_{ti}\|_{V^{-1}_{t}}
\left(x_{ti}^{\top}\hat{\theta}_{t-1}+\alpha\|x_{ti}\|_{V^{-1}_{t}}\right)-x_{%
ti}^{\top}\theta^{*}\geq 0
u_{ti}\geq u^{\prime}_{ti}
i
\bar{u}_{ti}:=(1-c)u_{ti}+cu^{\prime}_{ti}
c\in(0,1)
\displaystyle\frac{\sum_{i\in S}r_{ti}\exp\left(u_{ti}\right)}{1+\sum_{j\in S}%
\exp\left(u_{tj}\right)}-\frac{\sum_{i\in S}r_{ti}\exp(u^{\prime}_{ti})}{1+%
\sum_{j\in S}\exp(u^{\prime}_{tj})}
\displaystyle\frac{\sum_{i\in S}r_{ti}\exp\left(u_{ti}\right)}{1+\sum_{j\in S}%
\exp\left(u_{tj}\right)}-\frac{\sum_{i\in S}r_{ti}\exp(u^{\prime}_{ti})}{1+%
\sum_{j\in S}\exp(u^{\prime}_{tj})}
\displaystyle=\frac{(\sum_{i\in S}r_{ti}\exp\{\bar{u}_{ti}\}(u_{ti}-u^{\prime}%
_{ti}))(1+\sum_{i\in S}\exp\{\bar{u}_{ti}\})}{(1+\sum_{i\in S}\exp\{\bar{u}_{%
ti}\})^{2}}
\displaystyle=\frac{(\sum_{i\in S}r_{ti}\exp\{\bar{u}_{ti}\}(u_{ti}-u^{\prime}%
_{ti}))(1+\sum_{i\in S}\exp\{\bar{u}_{ti}\})}{(1+\sum_{i\in S}\exp\{\bar{u}_{%
ti}\})^{2}}
\displaystyle\qquad-\frac{(\sum_{i\in S}r_{ti}\exp\{\bar{u}_{ti}\})(\sum_{i\in
S%
}\exp\{\bar{u}_{ti}\}(u_{ti}-u^{\prime}_{ti}))}{(1+\sum_{i\in S}\exp\{\bar{u}_%
{ti}\})^{2}}
\displaystyle\qquad-\frac{(\sum_{i\in S}r_{ti}\exp\{\bar{u}_{ti}\})(\sum_{i\in
S%
}\exp\{\bar{u}_{ti}\}(u_{ti}-u^{\prime}_{ti}))}{(1+\sum_{i\in S}\exp\{\bar{u}_%
{ti}\})^{2}}
\displaystyle=\sum_{i\in S}r_{ti}p_{ti}(S,\bar{u}_{t})(u_{ti}-u^{\prime}_{ti})%
-R_{t}(S,\bar{u}_{t})\cdot\sum_{i\in S}p_{ti}(S,\bar{u}_{t})(u_{ti}-u^{\prime}%
_{ti})
\displaystyle=\sum_{i\in S}r_{ti}p_{ti}(S,\bar{u}_{t})(u_{ti}-u^{\prime}_{ti})%
-R_{t}(S,\bar{u}_{t})\cdot\sum_{i\in S}p_{ti}(S,\bar{u}_{t})(u_{ti}-u^{\prime}%
_{ti})
\displaystyle=\sum_{i\in S}\big{(}r_{ti}-R_{t}(S,\bar{u}_{t})\big{)}p_{ti}(S,%
\bar{u}_{t})(u_{ti}-u^{\prime}_{ti})
\displaystyle=\sum_{i\in S}\big{(}r_{ti}-R_{t}(S,\bar{u}_{t})\big{)}p_{ti}(S,%
\bar{u}_{t})(u_{ti}-u^{\prime}_{ti})
\displaystyle\leq\max_{i\in S}|u_{ti}-u^{\prime}_{ti}|=\max_{i\in S}(u_{ti}-u^%
{\prime}_{ti})
\displaystyle\leq\max_{i\in S}|u_{ti}-u^{\prime}_{ti}|=\max_{i\in S}(u_{ti}-u^%
{\prime}_{ti})
|r_{ti}|\leq 1
p_{ti}(S,\bar{u}_{t})\leq 1
t
\hat{\theta}_{t}
\Theta(tK)
t
f_{t}(\theta)
G_{t}(\theta)
\displaystyle f_{t}(\theta):=-\sum_{i\in S_{t}}y_{ti}\log p_{t}(i|S_{t},\theta%
)=-\sum_{i\in S_{t}}y_{ti}x_{ti}^{\top}\theta+\log\Big{(}1+\sum_{j\in S_{t}}%
\exp(x_{tj}^{\top}\theta)\Big{)}
\displaystyle f_{t}(\theta)
\displaystyle:=-\sum_{i\in S_{t}}y_{ti}\log p_{t}(i|S_{t},\theta)=-\sum_{i\in S%
_{t}}y_{ti}x_{ti}^{\top}\theta+\log\Big{(}1+\sum_{j\in S_{t}}\exp(x_{tj}^{\top%
}\theta)\Big{)}
\displaystyle G_{t}(\theta):=\nabla_{\theta}f_{t}(\theta)=\sum_{i\in S_{t}}%
\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)x_{ti}
\displaystyle G_{t}(\theta)
\displaystyle:=\nabla_{\theta}f_{t}(\theta)=\sum_{i\in S_{t}}\left(p_{t}(i|S_{%
t},\theta)-y_{ti}\right)x_{ti}
t
\displaystyle\hat{\theta}_{t}=\argmin_{\theta}\left\{\frac{1}{2}\|\theta-\hat{%
\theta}_{t-1}\|^{2}_{V_{t}}+(\theta-\hat{\theta}_{t-1})^{\top}G_{t-1}(\hat{%
\theta}_{t-1})\right\}
\displaystyle\hat{\theta}_{t}=\argmin_{\theta}\left\{\frac{1}{2}\|\theta-\hat{%
\theta}_{t-1}\|^{2}_{V_{t}}+(\theta-\hat{\theta}_{t-1})^{\top}G_{t-1}(\hat{%
\theta}_{t-1})\right\}
V_{t}=V_{t}+\frac{\kappa}{2}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
T
T_{0}
\tilde{\alpha}_{t}
t\in[T_{0}]
S_{t}
|S_{t}|=K
V_{t}\leftarrow V_{t-1}+\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
t=T_{0}+1
T
\tilde{z}_{ti}=x_{ti}^{\top}\hat{\theta}_{t-1}+\tilde{\alpha}_{t}\|x_{ti}\|_{V%
^{-1}_{t-1}}
i\in[N]
S_{t}=\argmax_{S\subset\mathcal{S}}\tilde{R}_{t}(S)
\{\tilde{z}_{ti}\}
S_{t}
y_{t}
t
V_{t}\leftarrow V_{t-1}+\frac{\kappa}{2}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\hat{\theta}_{t}
\displaystyle\hat{\theta}_{t}=\argmin_{\theta}\left\{\frac{1}{2}\|\theta-\hat{%
\theta}_{t-1}\|^{2}_{V_{t}}+(\theta-\hat{\theta}_{t-1})^{\top}G_{t-1}(\hat{%
\theta}_{t-1})\right\}
\displaystyle\hat{\theta}_{t}=\argmin_{\theta}\left\{\frac{1}{2}\|\theta-\hat{%
\theta}_{t-1}\|^{2}_{V_{t}}+(\theta-\hat{\theta}_{t-1})^{\top}G_{t-1}(\hat{%
\theta}_{t-1})\right\}
\tilde{z}_{ti}
\tilde{\alpha}_{t}
\Theta(K)
\Theta(tK)
t
\lambda_{\min}(V_{T_{0}})\geq K
\displaystyle\|\hat{\theta}_{t}-\theta^{*}\|_{V_{t}}\leq\sqrt{T_{0}+\frac{8}{%
\kappa}d\log\left(1+\frac{t}{d}\right)+\left(\frac{8}{\kappa}+\frac{16}{3}%
\right)\log\left(\lceil 2\log_{2}(tK/2)\rceil t^{4}\right)+4}
\displaystyle\|\hat{\theta}_{t}-\theta^{*}\|_{V_{t}}
\displaystyle\leq\sqrt{T_{0}+\frac{8}{\kappa}d\log\left(1+\frac{t}{d}\right)+%
\left(\frac{8}{\kappa}+\frac{16}{3}\right)\log\left(\lceil 2\log_{2}(tK/2)%
\rceil t^{4}\right)+4}
t>T_{0}
1-\mathcal{O}(t^{-2})
\mathcal{O}\big{(}\sqrt{d\log\left(1+t/d\right)}\big{)}
C_{0}>0
\tilde{\alpha}_{t}
T
T_{0}=\left\lceil C_{0}\max\left\{\frac{d+\log T}{\sigma_{0}^{2}K},\frac{1}{%
\sigma_{0}}\right\}\right\rceil
K
\displaystyle\mathcal{R}_{T}\leq T_{0}+\mathcal{O}(1)+\tilde{\alpha}_{T}\sqrt{%
dT\log\left(T/d\right)}=\mathcal{O}\left(d\sqrt{T\log\left(1+T/d\right)\log(T/%
d)}\right)
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+\mathcal{O}(1)+\tilde{\alpha}_{T}\sqrt{dT\log\left(T/d%
\right)}=\mathcal{O}\left(d\sqrt{T\log\left(1+T/d\right)\log(T/d)}\right)
\tilde{\alpha}_{t}=\sqrt{T_{0}+\frac{8}{\kappa}d\log\left(1+\frac{t}{d}\right)%
+\left(\frac{8}{\kappa}+\frac{16}{3}\right)\log\left(\lceil 2\log_{2}(tK/2)%
\rceil t^{4}\right)+4}
\tilde{\mathcal{O}}(d\sqrt{T})
f_{t}(\theta)
G_{t}(\theta)
\displaystyle f_{t}(\theta)=-\sum_{i\in S_{t}\cup\{0\}}y_{ti}\log p_{t}(i|S_{t%
},\theta)=-\sum_{i\in S_{t}}y_{ti}x_{ti}^{\top}\theta+\log\Big{(}1+\sum_{j\in S%
_{t}}\exp(x_{tj}^{\top}\theta)\Big{)}
\displaystyle f_{t}(\theta)
\displaystyle=-\sum_{i\in S_{t}\cup\{0\}}y_{ti}\log p_{t}(i|S_{t},\theta)=-%
\sum_{i\in S_{t}}y_{ti}x_{ti}^{\top}\theta+\log\Big{(}1+\sum_{j\in S_{t}}\exp(%
x_{tj}^{\top}\theta)\Big{)}
\displaystyle G_{t}(\theta)=\nabla_{\theta}f_{t}(\theta)=\sum_{i\in S_{t}}%
\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)x_{ti}
\displaystyle G_{t}(\theta)
\displaystyle=\nabla_{\theta}f_{t}(\theta)=\sum_{i\in S_{t}}\left(p_{t}(i|S_{t%
},\theta)-y_{ti}\right)x_{ti}
f_{t}(\theta)
G_{t}(\theta)
y
f_{t}(\theta)
G_{t}(\theta)
\displaystyle\bar{f}_{t}(\theta):=\mathbb{E}_{y}\left[f_{t}(\theta)|\mathcal{F%
}_{t}\right]\qquad\bar{G}_{t}(\theta):=\mathbb{E}_{y}[G_{t}(\theta)|\mathcal{F%
}_{t}]=\mathbb{E}_{y}[\nabla f_{t}(\theta)|\mathcal{F}_{t}]
\displaystyle\bar{f}_{t}(\theta):=\mathbb{E}_{y}\left[f_{t}(\theta)|\mathcal{F%
}_{t}\right]\qquad\bar{G}_{t}(\theta):=\mathbb{E}_{y}[G_{t}(\theta)|\mathcal{F%
}_{t}]=\mathbb{E}_{y}[\nabla f_{t}(\theta)|\mathcal{F}_{t}]
\theta_{1},\theta_{2}
f_{t}(\theta_{2})\geq f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(\theta_{2}-%
\theta_{1})+\frac{\kappa}{2}(\theta_{2}-\theta_{1})^{\top}\Big{(}\sum_{i\in S_%
{t}}x_{ti}x_{ti}^{\top}\Big{)}(\theta_{2}-\theta_{1})
\bar{\theta}=c\theta_{2}-(1-c)\theta_{1}
c\in(0,1)
\displaystyle f_{t}(\theta_{2})=f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(%
\theta_{2}-\theta_{1})+\frac{1}{2}(\theta_{2}-\theta_{1})^{\top}H_{f}(\bar{%
\theta})(\theta_{2}-\theta_{1})
\displaystyle f_{t}(\theta_{2})=f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(%
\theta_{2}-\theta_{1})+\frac{1}{2}(\theta_{2}-\theta_{1})^{\top}H_{f}(\bar{%
\theta})(\theta_{2}-\theta_{1})
H_{f}(\bar{\theta})
\bar{\theta}
\displaystyle H_{f}(\bar{\theta})=\sum_{i\in S_{t}}p_{t}(i|S_{t},\bar{\theta})%
x_{ti}x_{ti}^{\top}-\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{t}(i|S_{t},\bar{%
\theta})p_{tj}(S_{t},\bar{\theta})x_{ti}x_{tj}^{\top}
\displaystyle H_{f}(\bar{\theta})
\displaystyle=\sum_{i\in S_{t}}p_{t}(i|S_{t},\bar{\theta})x_{ti}x_{ti}^{\top}-%
\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{t}(i|S_{t},\bar{\theta})p_{tj}(S_{t},\bar%
{\theta})x_{ti}x_{tj}^{\top}
\displaystyle\succeq\sum_{i\in S_{t}}p_{t}(i|S_{t},\bar{\theta})p_{t0}(\bar{%
\theta})x_{ti}x_{ti}^{\top}
\displaystyle\succeq\sum_{i\in S_{t}}p_{t}(i|S_{t},\bar{\theta})p_{t0}(\bar{%
\theta})x_{ti}x_{ti}^{\top}
\displaystyle H_{f}(\bar{\theta})\succeq\kappa\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\displaystyle H_{f}(\bar{\theta})\succeq\kappa\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\displaystyle f_{t}(\theta_{2})=f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(%
\theta_{2}-\theta_{1})+\frac{1}{2}(\theta_{2}-\theta_{1})^{\top}H_{f}(\bar{%
\theta})(\theta_{2}-\theta_{1})
\displaystyle f_{t}(\theta_{2})
\displaystyle=f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(\theta_{2}-\theta_{1}%
)+\frac{1}{2}(\theta_{2}-\theta_{1})^{\top}H_{f}(\bar{\theta})(\theta_{2}-%
\theta_{1})
\displaystyle\geq f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(\theta_{2}-\theta%
_{1})+\frac{\kappa}{2}(\theta_{2}-\theta_{1})^{\top}\Big{(}\sum_{i\in S_{t}}x_%
{ti}x_{ti}^{\top}\Big{)}(\theta_{2}-\theta_{1}).
\displaystyle\geq f_{t}(\theta_{1})+G_{t}(\theta_{1})^{\top}(\theta_{2}-\theta%
_{1})+\frac{\kappa}{2}(\theta_{2}-\theta_{1})^{\top}\Big{(}\sum_{i\in S_{t}}x_%
{ti}x_{ti}^{\top}\Big{)}(\theta_{2}-\theta_{1}).
\displaystyle 2G_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})\leq%
\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}+\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{%
V_{t+1}}-\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle 2G_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})\leq%
\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}+\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{%
V_{t+1}}-\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}
\hat{\theta}_{t+1}
\displaystyle\hat{\theta}_{t+1}=\argmin_{\theta}\frac{1}{2}\|\theta-\hat{%
\theta}_{t}\|^{2}_{V_{t+1}}+(\theta-\hat{\theta}_{t})^{\top}G_{t}(\hat{\theta}%
_{t})
\displaystyle\hat{\theta}_{t+1}=\argmin_{\theta}\frac{1}{2}\|\theta-\hat{%
\theta}_{t}\|^{2}_{V_{t+1}}+(\theta-\hat{\theta}_{t})^{\top}G_{t}(\hat{\theta}%
_{t})
\displaystyle\left[G_{t}(\hat{\theta}_{t})+V_{t+1}(\hat{\theta}_{t+1}-\hat{%
\theta}_{t})\right]^{\top}(\theta-\hat{\theta}_{t+1})\geq 0,\forall\theta
\displaystyle\left[G_{t}(\hat{\theta}_{t})+V_{t+1}(\hat{\theta}_{t+1}-\hat{%
\theta}_{t})\right]^{\top}(\theta-\hat{\theta}_{t+1})\geq 0,\forall\theta
\displaystyle\theta^{\top}V_{t+1}(\hat{\theta}_{t+1}-\hat{\theta}_{t})\geq\hat%
{\theta}_{t+1}^{\top}V_{t+1}(\hat{\theta}_{t+1}-\hat{\theta}_{t})-G_{t}(\hat{%
\theta}_{t})(\theta-\hat{\theta}_{t+1}).
\displaystyle\theta^{\top}V_{t+1}(\hat{\theta}_{t+1}-\hat{\theta}_{t})\geq\hat%
{\theta}_{t+1}^{\top}V_{t+1}(\hat{\theta}_{t+1}-\hat{\theta}_{t})-G_{t}(\hat{%
\theta}_{t})(\theta-\hat{\theta}_{t+1}).
\displaystyle\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\|\hat{\theta}_{t+1%
}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\|\hat{\theta}_{t+1%
}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle=\hat{\theta}_{t}^{\top}V_{t+1}\hat{\theta}_{t}-\hat{\theta}_{t+1%
}^{\top}V_{t+1}\hat{\theta}_{t+1}+2{\theta^{*}}^{\top}V_{t+1}(\hat{\theta}_{t+%
1}-\hat{\theta}_{t})
\displaystyle=\hat{\theta}_{t}^{\top}V_{t+1}\hat{\theta}_{t}-\hat{\theta}_{t+1%
}^{\top}V_{t+1}\hat{\theta}_{t+1}+2{\theta^{*}}^{\top}V_{t+1}(\hat{\theta}_{t+%
1}-\hat{\theta}_{t})
\displaystyle\geq\hat{\theta}_{t}^{\top}V_{t+1}\hat{\theta}_{t}-\hat{\theta}_{%
t+1}^{\top}V_{t+1}\hat{\theta}_{t+1}+2\hat{\theta}_{t+1}^{\top}V_{t+1}(\hat{%
\theta}_{t+1}-\hat{\theta}_{t})-2G_{t}(\hat{\theta}_{t})(\theta^{*}-\hat{%
\theta}_{t+1})
\displaystyle\geq\hat{\theta}_{t}^{\top}V_{t+1}\hat{\theta}_{t}-\hat{\theta}_{%
t+1}^{\top}V_{t+1}\hat{\theta}_{t+1}+2\hat{\theta}_{t+1}^{\top}V_{t+1}(\hat{%
\theta}_{t+1}-\hat{\theta}_{t})-2G_{t}(\hat{\theta}_{t})(\theta^{*}-\hat{%
\theta}_{t+1})
\displaystyle=\hat{\theta}_{t}^{\top}V_{t+1}\hat{\theta}_{t}+\hat{\theta}_{t+1%
}^{\top}V_{t+1}\hat{\theta}_{t+1}-2\hat{\theta}_{t+1}^{\top}V_{t+1}\hat{\theta%
}_{t}-2G_{t}(\hat{\theta}_{t})(\theta^{*}-\hat{\theta}_{t+1})
\displaystyle=\hat{\theta}_{t}^{\top}V_{t+1}\hat{\theta}_{t}+\hat{\theta}_{t+1%
}^{\top}V_{t+1}\hat{\theta}_{t+1}-2\hat{\theta}_{t+1}^{\top}V_{t+1}\hat{\theta%
}_{t}-2G_{t}(\hat{\theta}_{t})(\theta^{*}-\hat{\theta}_{t+1})
\displaystyle=\|\hat{\theta}_{t}-\hat{\theta}_{t+1}\|^{2}_{V_{t+1}}+2G_{t}(%
\hat{\theta}_{t})(\hat{\theta}_{t+1}-\hat{\theta}_{t})+2G_{t}(\hat{\theta}_{t}%
)(\hat{\theta}_{t}-\theta^{*})
\displaystyle=\|\hat{\theta}_{t}-\hat{\theta}_{t+1}\|^{2}_{V_{t+1}}+2G_{t}(%
\hat{\theta}_{t})(\hat{\theta}_{t+1}-\hat{\theta}_{t})+2G_{t}(\hat{\theta}_{t}%
)(\hat{\theta}_{t}-\theta^{*})
\displaystyle\geq-\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}+2G_{t}(\hat{\theta}%
_{t})(\hat{\theta}_{t}-\theta^{*})
\displaystyle\geq-\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}+2G_{t}(\hat{\theta}%
_{t})(\hat{\theta}_{t}-\theta^{*})
\displaystyle\|\hat{\theta}_{t}-\hat{\theta}_{t+1}\|^{2}_{V_{t+1}}+2G_{t}(\hat%
{\theta}_{t})(\hat{\theta}_{t+1}-\hat{\theta}_{t})\geq\min_{\theta}\left\{\|%
\theta\|^{2}_{V_{t+1}}+2G_{t}(\hat{\theta}_{t})(\theta)\right\}
\displaystyle\|\hat{\theta}_{t}-\hat{\theta}_{t+1}\|^{2}_{V_{t+1}}+2G_{t}(\hat%
{\theta}_{t})(\hat{\theta}_{t+1}-\hat{\theta}_{t})
\displaystyle\geq\min_{\theta}\left\{\|\theta\|^{2}_{V_{t+1}}+2G_{t}(\hat{%
\theta}_{t})(\theta)\right\}
\displaystyle=-\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}.
\displaystyle=-\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}.
\theta\in\mathbb{R}^{d}
\bar{f}_{t}(\theta)\geq\bar{f}_{t}(\theta^{*})
\displaystyle\bar{f}_{t}(\theta)-\bar{f}_{t}(\theta^{*})=-\sum_{i\in S_{t}}p_{%
t}(i|S_{t},\theta^{*})\log p_{t}(i|S_{t},\theta)+\sum_{i\in S_{t}}p_{t}(i|S_{t%
},\theta^{*})\log p_{t}(i|S_{t},\theta^{*})
\displaystyle\bar{f}_{t}(\theta)-\bar{f}_{t}(\theta^{*})
\displaystyle=-\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\log p_{t}(i|S_{t},%
\theta)+\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\log p_{t}(i|S_{t},\theta^{*})
\displaystyle=\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\left[\log p_{t}(i|S_{%
t},\theta^{*})-\log p_{t}(i|S_{t},\theta)\right]
\displaystyle=\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\left[\log p_{t}(i|S_{%
t},\theta^{*})-\log p_{t}(i|S_{t},\theta)\right]
\displaystyle=\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\log\frac{p_{t}(i|S_{t%
},\theta^{*})}{p_{t}(i|S_{t},\theta)}
\displaystyle=\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\log\frac{p_{t}(i|S_{t%
},\theta^{*})}{p_{t}(i|S_{t},\theta)}
\displaystyle\geq 0
\displaystyle\geq 0
\sum_{i\in S_{t}}p_{t}(i|S_{t},\theta^{*})\log\frac{p_{t}(i|S_{t},\theta^{*})}%
{p_{t}(i|S_{t},\theta)}
V
\displaystyle\|G_{t}(\theta)\|^{2}_{V}\leq 4\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V}
\displaystyle\|G_{t}(\theta)\|^{2}_{V}\leq 4\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V}
V
\displaystyle(z_{i}-z_{j})^{\top}V(z_{i}-z_{j})^{\top}=z_{i}^{\top}Vz_{i}+z_{j%
}^{\top}Vz_{j}-z_{i}^{\top}Vz_{j}-z_{j}^{\top}Vz_{i}\geq 0
\displaystyle(z_{i}-z_{j})^{\top}V(z_{i}-z_{j})^{\top}=z_{i}^{\top}Vz_{i}+z_{j%
}^{\top}Vz_{j}-z_{i}^{\top}Vz_{j}-z_{j}^{\top}Vz_{i}\geq 0
z_{i}^{\top}Vz_{i}+z_{j}^{\top}Vz_{j}\geq z_{i}^{\top}Vz_{j}+z_{j}^{\top}Vz_{i}
z_{i}:=\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)x_{ti}
\displaystyle\|G_{t}(\theta)\|^{2}_{V}=\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left%
(p_{t}(i|S_{t},\theta)-y_{ti}\right)\left(p_{tj}(S_{t},\theta)-y_{tj}\right)x_%
{ti}^{\top}Vx_{tj}
\displaystyle\|G_{t}(\theta)\|^{2}_{V}
\displaystyle=\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_%
{ti}\right)\left(p_{tj}(S_{t},\theta)-y_{tj}\right)x_{ti}^{\top}Vx_{tj}
\displaystyle=\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x_%
{ti}^{\top}Vx_{ti}
\displaystyle=\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x_%
{ti}^{\top}Vx_{ti}
\displaystyle\quad+\frac{1}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{t}(i|%
S_{t},\theta)-y_{ti}\right)\left(p_{tj}(S_{t},\theta)-y_{tj}\right)(x_{ti}^{%
\top}Vx_{tj}+x_{tj}^{\top}Vx_{ti})
\displaystyle\quad+\frac{1}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{t}(i|%
S_{t},\theta)-y_{ti}\right)\left(p_{tj}(S_{t},\theta)-y_{tj}\right)(x_{ti}^{%
\top}Vx_{tj}+x_{tj}^{\top}Vx_{ti})
\displaystyle\leq\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2%
}x_{ti}^{\top}Vx_{ti}
\displaystyle\leq\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2%
}x_{ti}^{\top}Vx_{ti}
\displaystyle\quad+\frac{1}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left[\left(p_%
{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x_{ti}^{\top}Vx_{tj}+\left(p_{tj}(S_{t},%
\theta)-y_{tj}\right)^{2}x_{tj}^{\top}Vx_{ti}\right]
\displaystyle\quad+\frac{1}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left[\left(p_%
{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x_{ti}^{\top}Vx_{tj}+\left(p_{tj}(S_{t},%
\theta)-y_{tj}\right)^{2}x_{tj}^{\top}Vx_{ti}\right]
\displaystyle=\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x_%
{ti}^{\top}Vx_{ti}+\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^%
{2}x_{ti}^{\top}Vx_{ti}
\displaystyle=\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x_%
{ti}^{\top}Vx_{ti}+\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^%
{2}x_{ti}^{\top}Vx_{ti}
\displaystyle=2\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x%
_{ti}^{\top}Vx_{ti}
\displaystyle=2\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)^{2}x%
_{ti}^{\top}Vx_{ti}
\displaystyle\leq 4\max_{i\in S_{t}}x_{ti}^{\top}Vx_{ti}
\displaystyle\leq 4\max_{i\in S_{t}}x_{ti}^{\top}Vx_{ti}
\displaystyle=4\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V}
\displaystyle=4\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V}
1-\delta
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})\leq\frac{\kappa}{4}\sum_{t^{\prime}=T_{0%
}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}+\left(%
\frac{4}{\kappa}+\frac{8}{3}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{2%
}\rceil t^{2}}{\delta}\right)+2
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})\leq\frac{\kappa}{4}\sum_{t^{\prime}=T_{0%
}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}+\left(%
\frac{4}{\kappa}+\frac{8}{3}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{2%
}\rceil t^{2}}{\delta}\right)+2
\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})
\displaystyle\left|\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^%
{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right|\leq\left|\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime%
}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})\right|+\left|\left[G_{%
t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}%
-\theta^{*})\right|
\displaystyle\left|\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^%
{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right|
\displaystyle\leq\left|\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})%
\right]^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})\right|+\left|\left[G_{t^{%
\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right|
\displaystyle\leq\left\|\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right%
\|\left\|\hat{\theta}_{t^{\prime}}-\theta^{*}\right\|+\left\|G_{t^{\prime}}(%
\hat{\theta}_{t^{\prime}})\right\|\left\|\hat{\theta}_{t^{\prime}}-\theta^{*}\right\|
\displaystyle\leq\left\|\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right%
\|\left\|\hat{\theta}_{t^{\prime}}-\theta^{*}\right\|+\left\|G_{t^{\prime}}(%
\hat{\theta}_{t^{\prime}})\right\|\left\|\hat{\theta}_{t^{\prime}}-\theta^{*}\right\|
\displaystyle\leq 2\sqrt{2}\|\hat{\theta}_{t^{\prime}}-\theta^{*}\|
\displaystyle\leq 2\sqrt{2}\|\hat{\theta}_{t^{\prime}}-\theta^{*}\|
\|G_{t}(\theta)\|=\|\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\theta)-y_{ti}\right)%
x_{ti}\|\leq\sqrt{2}
\theta
t^{\prime}
\|\hat{\theta}_{t^{\prime}}-\theta^{*}\|\leq 1
\displaystyle\left|\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^%
{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right|\leq 2\sqrt{2}.
\displaystyle\left|\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^%
{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right|\leq 2\sqrt{2}.
M_{t}:=\sum_{t^{\prime}=1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{%
\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}%
_{t^{\prime}}-\theta^{*})
\Sigma_{t}
\displaystyle\Sigma_{t}:=\sum_{t^{\prime}=1}^{t}\mathbb{E}_{y_{t^{\prime}}}%
\left[\left(\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^{\prime%
}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{%
*})\right)^{2}\right]
\displaystyle\Sigma_{t}
\displaystyle:=\sum_{t^{\prime}=1}^{t}\mathbb{E}_{y_{t^{\prime}}}\left[\left(%
\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})\right]^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})%
\right)^{2}\right]
\displaystyle\leq\sum_{t^{\prime}=1}^{t}\mathbb{E}_{y_{t^{\prime}}}\left[\left%
(G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right)^{2}\right]
\displaystyle\leq\sum_{t^{\prime}=1}^{t}\mathbb{E}_{y_{t^{\prime}}}\left[\left%
(G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})^{\top}(\hat{\theta}_{t^{\prime}}-%
\theta^{*})\right)^{2}\right]
\displaystyle\leq\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}\left(x_{t^{%
\prime}i}^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})\right)^{2}
\displaystyle\leq\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}\left(x_{t^{%
\prime}i}^{\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})\right)^{2}
\displaystyle=\sum_{t^{\prime}=1}^{t}\|\hat{\theta}_{t^{\prime}}-\theta^{*}\|^%
{2}_{W_{t^{\prime}}}:=B_{t}
\displaystyle=\sum_{t^{\prime}=1}^{t}\|\hat{\theta}_{t^{\prime}}-\theta^{*}\|^%
{2}_{W_{t^{\prime}}}:=B_{t}
B_{t}
\Sigma_{t}
M_{t}
B_{t}\leq\frac{4}{tK}
B_{t}>\frac{4}{tK}
\displaystyle B_{t}=\sum_{t^{\prime}=1}^{t}\|\hat{\theta}_{t^{\prime}}-\theta^%
{*}\|^{2}_{W_{t^{\prime}}}\leq\frac{4}{tK}
\displaystyle M_{t}=\sum_{t^{\prime}=1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})
\displaystyle M_{t}
\displaystyle=\sum_{t^{\prime}=1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{\theta}_{%
t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(\hat{%
\theta}_{t^{\prime}}-\theta^{*})
\displaystyle=\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}(y_{t^{\prime}i%
}-p(S_{t},\theta^{*}))x_{t^{\prime}i}^{\top}(\hat{\theta}_{t^{\prime}}-\theta^%
{*})
\displaystyle=\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}(y_{t^{\prime}i%
}-p(S_{t},\theta^{*}))x_{t^{\prime}i}^{\top}(\hat{\theta}_{t^{\prime}}-\theta^%
{*})
\displaystyle\leq\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}|x_{t^{%
\prime}i}^{\top}(\hat{\theta}_{t}-\theta^{*})|
\displaystyle\leq\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}|x_{t^{%
\prime}i}^{\top}(\hat{\theta}_{t}-\theta^{*})|
\displaystyle\leq\sqrt{tK\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}%
\left(x_{t^{\prime}i}^{\top}(\hat{\theta}_{t}-\theta^{*})\right)^{2}}
\displaystyle\leq\sqrt{tK\sum_{t^{\prime}=1}^{t}\sum_{i\in S_{t^{\prime}}}%
\left(x_{t^{\prime}i}^{\top}(\hat{\theta}_{t}-\theta^{*})\right)^{2}}
\displaystyle\leq 2.
\displaystyle\leq 2.
\displaystyle B_{t}=\sum_{t^{\prime}=1}^{t}\|\hat{\theta}_{t^{\prime}}-\theta^%
{*}\|^{2}_{W_{t^{\prime}}}>\frac{4}{tK}
B_{t}
\frac{4}{tK}<B_{t}\leq tK
\displaystyle\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}+\frac{8\eta_{t}}{%
3}\right)=\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}+\frac{8\eta_{t}}{3},%
\frac{4}{tK}<B_{t}\leq tK\right)
\displaystyle\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}+\frac{8\eta_{t}}{%
3}\right)
\displaystyle=\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}+\frac{8\eta_{t}}%
{3},\frac{4}{tK}<B_{t}\leq tK\right)
\displaystyle=\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}+\frac{8\eta_{t}}%
{3},\frac{4}{tK}<B_{t}\leq tK,\Sigma_{t}\leq B_{t}\right)
\displaystyle=\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}+\frac{8\eta_{t}}%
{3},\frac{4}{tK}<B_{t}\leq tK,\Sigma_{t}\leq B_{t}\right)
\displaystyle\leq\sum_{j=1}^{m}\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}%
+\frac{8\eta_{t}}{3},\frac{4\cdot 2^{j-1}}{tK}<B_{t}\leq\frac{4\cdot 2^{j}}{tK%
},\Sigma_{t}\leq B_{t}\right)
\displaystyle\leq\sum_{j=1}^{m}\mathbb{P}\left(M_{t}\geq 2\sqrt{\eta_{t}B_{t}}%
+\frac{8\eta_{t}}{3},\frac{4\cdot 2^{j-1}}{tK}<B_{t}\leq\frac{4\cdot 2^{j}}{tK%
},\Sigma_{t}\leq B_{t}\right)
\displaystyle\leq\sum_{j=1}^{m}\mathbb{P}\left(M_{t}\geq\sqrt{\eta_{t}\frac{8%
\cdot 2^{j}}{tK}}+\frac{8\eta_{t}}{3},\Sigma_{t}\leq\frac{4\cdot 2^{j}}{tK}\right)
\displaystyle\leq\sum_{j=1}^{m}\mathbb{P}\left(M_{t}\geq\sqrt{\eta_{t}\frac{8%
\cdot 2^{j}}{tK}}+\frac{8\eta_{t}}{3},\Sigma_{t}\leq\frac{4\cdot 2^{j}}{tK}\right)
\displaystyle\leq m\exp(-\eta_{t})
\displaystyle\leq m\exp(-\eta_{t})
m=\lceil 2\log_{2}\frac{tK}{2}\rceil
\eta_{t}=\log\frac{mt^{2}}{\delta}=\log\frac{\lceil 2\log_{2}\frac{tK}{2}%
\rceil t^{2}}{\delta}
t
1-\delta
\displaystyle M_{t}=\sum_{t^{\prime}=1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})\leq 2\sqrt{\eta_{t}\sum_{t^{\prime}=T_{0%
}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}}+\frac{8%
\eta_{t}}{3}+2.
\displaystyle M_{t}=\sum_{t^{\prime}=1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})\leq 2\sqrt{\eta_{t}\sum_{t^{\prime}=T_{0%
}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}}+\frac{8%
\eta_{t}}{3}+2.
uv\leq cu^{2}+v^{2}/(4c)
c=\frac{2}{\kappa}
\displaystyle\sqrt{\eta_{t}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-\hat{%
\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}}\leq\frac{2\eta_{t}}{\kappa}+\frac%
{\kappa}{8}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}%
\|^{2}_{W_{t^{\prime}}}
\displaystyle\sqrt{\eta_{t}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-\hat{%
\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}}\leq\frac{2\eta_{t}}{\kappa}+\frac%
{\kappa}{8}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}%
\|^{2}_{W_{t^{\prime}}}
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})\leq\frac{\kappa}{4}\sum_{t^{\prime}=T_{0%
}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}+\left(%
\frac{4}{\kappa}+\frac{8}{3}\right)\eta_{t}+2
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})\leq\frac{\kappa}{4}\sum_{t^{\prime}=T_{0%
}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}+\left(%
\frac{4}{\kappa}+\frac{8}{3}\right)\eta_{t}+2
\displaystyle f_{t}(\hat{\theta}_{t})\leq f_{t}(\theta^{*})+G_{t}(\hat{\theta}%
_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})-\frac{\kappa}{2}(\theta^{*}-\hat{%
\theta}_{t})^{\top}\Big{(}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\Big{)}(\theta^{%
*}-\hat{\theta}_{t})
\displaystyle f_{t}(\hat{\theta}_{t})\leq f_{t}(\theta^{*})+G_{t}(\hat{\theta}%
_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})-\frac{\kappa}{2}(\theta^{*}-\hat{%
\theta}_{t})^{\top}\Big{(}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\Big{)}(\theta^{%
*}-\hat{\theta}_{t})
y
\displaystyle\bar{f}_{t}(\hat{\theta}_{t})\leq\bar{f}_{t}(\theta^{*})+\bar{G}_%
{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})-\frac{\kappa}{2}(%
\theta^{*}-\hat{\theta}_{t})^{\top}\Big{(}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}%
\Big{)}(\theta^{*}-\hat{\theta}_{t})
\displaystyle\bar{f}_{t}(\hat{\theta}_{t})\leq\bar{f}_{t}(\theta^{*})+\bar{G}_%
{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})-\frac{\kappa}{2}(%
\theta^{*}-\hat{\theta}_{t})^{\top}\Big{(}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}%
\Big{)}(\theta^{*}-\hat{\theta}_{t})
\nabla\bar{f}_{t}(\theta)=\mathbb{E}_{y}[\nabla f_{t}(\theta)]=\bar{G}_{t}(\theta)
W_{t}:=\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\bar{f}_{t}(\theta)\geq\bar{f}_{t}(\theta^{*})
\displaystyle 0\leq\bar{f}_{t}(\hat{\theta}_{t})-\bar{f}_{t}(\theta^{*})
\displaystyle 0
\displaystyle\leq\bar{f}_{t}(\hat{\theta}_{t})-\bar{f}_{t}(\theta^{*})
\displaystyle\leq\bar{G}_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^%
{*})-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}
\displaystyle\leq\bar{G}_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^%
{*})-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}
\displaystyle=G_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})-%
\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}+\left[\bar{G}_{t}(%
\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(\hat{\theta}_{t}-%
\theta^{*})
\displaystyle=G_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})-%
\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}+\left[\bar{G}_{t}(%
\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(\hat{\theta}_{t}-%
\theta^{*})
2G_{t}(\hat{\theta}_{t})^{\top}(\hat{\theta}_{t}-\theta^{*})\leq\|G_{t}(\theta%
_{t})\|^{2}_{V^{-1}_{t+1}}+\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\|%
\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle 0\leq\frac{1}{2}\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}+\frac{1%
}{2}\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\frac{1}{2}\|\hat{\theta}_{t%
+1}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle 0
\displaystyle\leq\frac{1}{2}\|G_{t}(\theta_{t})\|^{2}_{V^{-1}_{t+1}}+\frac{1}{%
2}\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\frac{1}{2}\|\hat{\theta}_{t+1%
}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\quad-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}%
+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(%
\hat{\theta}_{t}-\theta^{*})
\displaystyle\quad-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}%
+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(%
\hat{\theta}_{t}-\theta^{*})
\displaystyle\leq 2\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}+\frac{1}{2}%
\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\frac{1}{2}\|\hat{\theta}_{t+1}-%
\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\leq 2\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}+\frac{1}{2}%
\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}-\frac{1}{2}\|\hat{\theta}_{t+1}-%
\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\quad-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}%
+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(%
\hat{\theta}_{t}-\theta^{*})
\displaystyle\quad-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}%
+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(%
\hat{\theta}_{t}-\theta^{*})
\|G_{t}(\theta)\|^{2}_{V^{-1}_{t+1}}\leq 4\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{%
-1}_{t+1}}
V_{t+1}=V_{t}+\frac{\kappa}{2}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\displaystyle\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}=\|\hat{\theta}_{t}-%
\theta^{*}\|^{2}_{V_{t}}+\frac{\kappa}{2}(\hat{\theta}_{t}-\theta^{*})^{\top}%
\left(\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)(\hat{\theta}_{t}-\theta^{*})
\displaystyle\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle=\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}+\frac{\kappa}{2}(%
\hat{\theta}_{t}-\theta^{*})^{\top}\left(\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}%
\right)(\hat{\theta}_{t}-\theta^{*})
\displaystyle=\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}+\frac{\kappa}{2}\|%
\hat{\theta}_{t}-\theta^{*}\|^{2}_{W_{t}}.
\displaystyle=\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}+\frac{\kappa}{2}\|%
\hat{\theta}_{t}-\theta^{*}\|^{2}_{W_{t}}.
\displaystyle 0\leq 2\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}+\frac{1}{2%
}\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}+\frac{\kappa}{4}\|\hat{\theta}_{t%
}-\theta^{*}\|^{2}_{W_{t}}-\frac{1}{2}\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V%
_{t+1}}
\displaystyle 0
\displaystyle\leq 2\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}+\frac{1}{2}%
\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}+\frac{\kappa}{4}\|\hat{\theta}_{t}%
-\theta^{*}\|^{2}_{W_{t}}-\frac{1}{2}\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_%
{t+1}}
\displaystyle\quad-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}%
+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(%
\hat{\theta}_{t}-\theta^{*})
\displaystyle\quad-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}%
+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})\right]^{\top}(%
\hat{\theta}_{t}-\theta^{*})
\displaystyle=2\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}+\frac{1}{2}\|%
\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}-\frac{1}{2}\|\hat{\theta}_{t+1}-%
\theta^{*}\|^{2}_{V_{t+1}}-\frac{\kappa}{4}\|\theta^{*}-\hat{\theta}_{t}\|^{2}%
_{W_{t}}
\displaystyle=2\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}+\frac{1}{2}\|%
\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}-\frac{1}{2}\|\hat{\theta}_{t+1}-%
\theta^{*}\|^{2}_{V_{t+1}}-\frac{\kappa}{4}\|\theta^{*}-\hat{\theta}_{t}\|^{2}%
_{W_{t}}
\displaystyle\quad+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})%
\right]^{\top}(\hat{\theta}_{t}-\theta^{*})
\displaystyle\quad+\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t})%
\right]^{\top}(\hat{\theta}_{t}-\theta^{*})
\displaystyle\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}\leq\|\hat{\theta}%
_{t}-\theta^{*}\|^{2}_{V_{t}}+4\max_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}-%
\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|^{2}_{W_{t}}
\displaystyle\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\leq\|\hat{\theta}_{t}-\theta^{*}\|^{2}_{V_{t}}+4\max_{i\in S_{t}%
}\|x_{ti}\|^{2}_{V^{-1}_{t+1}}-\frac{\kappa}{2}\|\theta^{*}-\hat{\theta}_{t}\|%
^{2}_{W_{t}}
\displaystyle\quad+2\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t}%
)\right]^{\top}(\hat{\theta}_{t}-\theta^{*}).
\displaystyle\quad+2\left[\bar{G}_{t}(\hat{\theta}_{t})-G_{t}(\hat{\theta}_{t}%
)\right]^{\top}(\hat{\theta}_{t}-\theta^{*}).
t
\displaystyle\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}\leq\lambda_{\max}%
(V_{T_{0}})+4\sum_{t^{\prime}=T_{0}+1}^{t}\max_{i\in S_{t^{\prime}}}\|x_{t^{%
\prime}i}\|^{2}_{V^{-1}_{\tau+1}}-\frac{\kappa}{2}\sum_{t^{\prime}=T_{0}+1}^{t%
}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}
\displaystyle\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\leq\lambda_{\max}(V_{T_{0}})+4\sum_{t^{\prime}=T_{0}+1}^{t}\max_%
{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|^{2}_{V^{-1}_{\tau+1}}-\frac{\kappa}{2%
}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-\hat{\theta}_{t^{\prime}}\|^{2}_{W_%
{t^{\prime}}}
\displaystyle\quad+2\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(%
\hat{\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{%
\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})
\displaystyle\quad+2\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(%
\hat{\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{%
\top}(\hat{\theta}_{t^{\prime}}-\theta^{*})
1-\delta
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})
\displaystyle\sum_{t^{\prime}=T_{0}+1}^{t}\left[\bar{G}_{t^{\prime}}(\hat{%
\theta}_{t^{\prime}})-G_{t^{\prime}}(\hat{\theta}_{t^{\prime}})\right]^{\top}(%
\hat{\theta}_{t^{\prime}}-\theta^{*})
\displaystyle\leq\frac{\kappa}{4}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-%
\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}+\left(\frac{4}{\kappa}+\frac{%
8}{3}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{2}\rceil t^{2}}{\delta}%
\right)+2.
\displaystyle\leq\frac{\kappa}{4}\sum_{t^{\prime}=T_{0}+1}^{t}\|\theta^{*}-%
\hat{\theta}_{t^{\prime}}\|^{2}_{W_{t^{\prime}}}+\left(\frac{4}{\kappa}+\frac{%
8}{3}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{2}\rceil t^{2}}{\delta}%
\right)+2.
1-\delta
\displaystyle\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}\leq T_{0}+4\sum_{%
t^{\prime}=T_{0}+1}^{t}\max_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|^{2}_{V^{-%
1}_{\tau+1}}+\left(\frac{8}{\kappa}+\frac{16}{3}\right)\log\left(\frac{\lceil 2%
\log_{2}\frac{tK}{2}\rceil t^{2}}{\delta}\right)+4
\displaystyle\|\hat{\theta}_{t+1}-\theta^{*}\|^{2}_{V_{t+1}}
\displaystyle\leq T_{0}+4\sum_{t^{\prime}=T_{0}+1}^{t}\max_{i\in S_{t^{\prime}%
}}\|x_{t^{\prime}i}\|^{2}_{V^{-1}_{\tau+1}}+\left(\frac{8}{\kappa}+\frac{16}{3%
}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{2}\rceil t^{2}}{\delta}%
\right)+4
\displaystyle\leq T_{0}+\frac{8}{\kappa}d\log\left(1+\frac{T}{d}\right)+\left(%
\frac{8}{\kappa}+\frac{16}{3}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{%
2}\rceil t^{2}}{\delta}\right)+4
\displaystyle\leq T_{0}+\frac{8}{\kappa}d\log\left(1+\frac{T}{d}\right)+\left(%
\frac{8}{\kappa}+\frac{16}{3}\right)\log\left(\frac{\lceil 2\log_{2}\frac{tK}{%
2}\rceil t^{2}}{\delta}\right)+4
\sum_{t^{\prime}=1}^{t}\max_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|^{2}_{V^{-%
1}_{\tau+1}}
V_{t}
V_{t}
\frac{\kappa}{2}
\frac{2}{\kappa}
\sum_{t^{\prime}=1}^{t}\max_{i\in S_{t^{\prime}}}\|x_{t^{\prime}i}\|^{2}_{V^{-%
1}_{\tau+1}}
\displaystyle\tilde{\mathcal{E}}=\left\{\lambda_{\min}(V_{T_{0}})\geq K,%
\enskip\|\hat{\theta}_{t}-\theta^{*}\|_{V_{t}}\leq\tilde{\alpha}_{t},\forall t%
\leq T\right\}
\displaystyle\tilde{\mathcal{E}}
\displaystyle=\left\{\lambda_{\min}(V_{T_{0}})\geq K,\enskip\|\hat{\theta}_{t}%
-\theta^{*}\|_{V_{t}}\leq\tilde{\alpha}_{t},\forall t\leq T\right\}
\tilde{\alpha}_{t}
\displaystyle\mathcal{R}_{T}\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}%
\left(\tilde{R}_{t}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\tilde{%
\mathcal{E}})\right]+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t}(S%
_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\tilde{\mathcal{E}}^{c})\right]
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\tilde{\mathcal{E}})\right]+%
\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t}(S_{t})-R_{t}(S_{t},%
\theta^{*})\right)\mathbb{1}(\tilde{\mathcal{E}}^{c})\right]
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\tilde{\mathcal{E}})\right]+%
\sum_{t=1}^{T}\mathcal{O}(t^{-2})
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(\tilde{R}_{t%
}(S_{t})-R_{t}(S_{t},\theta^{*})\right)\mathbb{1}(\tilde{\mathcal{E}})\right]+%
\sum_{t=1}^{T}\mathcal{O}(t^{-2})
\displaystyle\leq T_{0}+\sum_{t=1}^{T}2\tilde{\alpha}_{T}\max_{i\in S_{t}}\|x_%
{ti}\|_{V^{-1}_{t}}+\mathcal{O}(1)
\displaystyle\leq T_{0}+\sum_{t=1}^{T}2\tilde{\alpha}_{T}\max_{i\in S_{t}}\|x_%
{ti}\|_{V^{-1}_{t}}+\mathcal{O}(1)
\sum_{t=1}^{T}\max_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t}}^{2}
\displaystyle\mathcal{R}_{T}\leq T_{0}+2\tilde{\alpha}_{T}\sqrt{2dT\log\left(T%
/d\right)}+\mathcal{O}(1)
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+2\tilde{\alpha}_{T}\sqrt{2dT\log\left(T/d\right)}+%
\mathcal{O}(1)
\tilde{\alpha}_{T}=\sqrt{T_{0}+\frac{8}{\kappa}d\log\left(1+\frac{T}{d}\right)%
+\left(\frac{8}{\kappa}+\frac{16}{3}\right)\log\left(\lceil 2\log_{2}(TK/2)%
\rceil t^{4}\right)+4}
\nabla_{\theta}\ell_{n}(\theta)=\sum_{t=1}^{n}\sum_{i\in S_{t}}(p_{t}(i|S_{t},%
\theta)-y_{ti})x_{ti}
J_{n}(\theta)
\nabla_{\theta}\ell(\theta)
\displaystyle J_{n}(\theta):=\mathbb{E}_{y}\left[\nabla_{\theta}\ell_{n}(%
\theta)|\mathcal{F}_{t}\right]=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i|S_%
{t},\theta)-p_{t}(i|S_{t},\theta^{*})\right)x_{ti}.
\displaystyle J_{n}(\theta):=\mathbb{E}_{y}\left[\nabla_{\theta}\ell_{n}(%
\theta)|\mathcal{F}_{t}\right]=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i|S_%
{t},\theta)-p_{t}(i|S_{t},\theta^{*})\right)x_{ti}.
J_{n}(\hat{\theta})=\sum^{n}_{t=1}\sum_{i\in S_{t}}\epsilon_{ti}x_{ti}
\hat{\theta}
\hat{\theta}
\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\hat{\theta})-y_{ti}\right)%
x_{ti}=0
\displaystyle J_{n}(\hat{\theta})=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i%
|S_{t},\hat{\theta})-p_{t}(i|S_{t},\theta^{*})\right)x_{ti}
\displaystyle J_{n}(\hat{\theta})
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\hat{\theta})%
-p_{t}(i|S_{t},\theta^{*})\right)x_{ti}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\hat{\theta})%
-y_{ti}\right)x_{ti}+\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(y_{ti}-p_{t}(i|S_{t}%
,\theta^{*})\right)x_{ti}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{t}(i|S_{t},\hat{\theta})%
-y_{ti}\right)x_{ti}+\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(y_{ti}-p_{t}(i|S_{t}%
,\theta^{*})\right)x_{ti}
\displaystyle=0+\sum^{n}_{t=1}\sum_{i\in S_{t}}\epsilon_{ti}x_{ti}
\displaystyle=0+\sum^{n}_{t=1}\sum_{i\in S_{t}}\epsilon_{ti}x_{ti}
Z_{n}:=J_{n}(\hat{\theta})
p_{ti}(\theta):=p_{t}(i|S_{t},\theta)
S_{t}
t
\hat{\theta}
\theta_{1},\theta_{2}\in\mathbb{R}^{d}
\bar{\theta}=c\theta_{1}+(1-c)\theta_{2}
c\in(0,1)
\displaystyle J_{n}(\theta_{1})-J_{n}(\theta_{2})=\left[\sum^{n}_{t=1}\sum_{i%
\in S_{t}}\sum_{j\in S_{t}}\nabla_{j}p_{ti}(\bar{\theta})x_{ti}x_{tj}^{\top}%
\right](\theta_{1}-\theta_{2})
\displaystyle J_{n}(\theta_{1})-J_{n}(\theta_{2})
\displaystyle=\left[\sum^{n}_{t=1}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\nabla_{j}%
p_{ti}(\bar{\theta})x_{ti}x_{tj}^{\top}\right](\theta_{1}-\theta_{2})
\displaystyle=\sum^{n}_{t=1}\left[\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x%
_{ti}^{\top}-\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar%
{\theta})x_{ti}x_{tj}^{\top}\right](\theta_{1}-\theta_{2})
\displaystyle=\sum^{n}_{t=1}\left[\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x%
_{ti}^{\top}-\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar%
{\theta})x_{ti}x_{tj}^{\top}\right](\theta_{1}-\theta_{2})
H_{t}:=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-\sum_{i,j\in S%
_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})x_{ti}x_{tj}^{\top}
H_{t}
H_{t}
\displaystyle(x_{i}-x_{j})(x_{i}-x_{j})^{\top}=x_{i}x_{i}^{\top}+x_{j}x_{j}^{%
\top}-x_{i}x_{j}^{\top}-x_{j}x_{i}^{\top}\succeq 0
\displaystyle(x_{i}-x_{j})(x_{i}-x_{j})^{\top}=x_{i}x_{i}^{\top}+x_{j}x_{j}^{%
\top}-x_{i}x_{j}^{\top}-x_{j}x_{i}^{\top}\succeq 0
x_{i}x_{i}^{\top}+x_{j}x_{j}^{\top}\succeq x_{i}x_{j}^{\top}+x_{j}x_{i}^{\top}
\displaystyle H_{t}=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-%
\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})x_{%
ti}x_{tj}^{\top}
\displaystyle H_{t}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-\sum_{i%
\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})x_{ti}x_{tj%
}^{\top}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-\frac{1%
}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})%
\left(x_{ti}x_{tj}^{\top}+x_{tj}x_{ti}^{\top}\right)
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-\frac{1%
}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})%
\left(x_{ti}x_{tj}^{\top}+x_{tj}x_{ti}^{\top}\right)
\displaystyle\succeq\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-%
\frac{1}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{%
\theta})\left(x_{ti}x_{ti}^{\top}+x_{tj}x_{tj}^{\top}\right)
\displaystyle\succeq\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-%
\frac{1}{2}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{%
\theta})\left(x_{ti}x_{ti}^{\top}+x_{tj}x_{tj}^{\top}\right)
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-\sum_{i%
\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})x_{ti}x_{ti%
}^{\top}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})x_{ti}x_{ti}^{\top}-\sum_{i%
\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\bar{\theta})p_{tj}(\bar{\theta})x_{ti}x_{ti%
}^{\top}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})\left(1-\sum_{j\in S_{t}}p_%
{tj}(\bar{\theta})\right)x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})\left(1-\sum_{j\in S_{t}}p_%
{tj}(\bar{\theta})\right)x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})p_{t0}(\bar{\theta})x_{ti}x%
_{ti}^{\top}
\displaystyle=\sum_{i\in S_{t}}p_{ti}(\bar{\theta})p_{t0}(\bar{\theta})x_{ti}x%
_{ti}^{\top}
p_{t0}(\bar{\theta})
\bar{\theta}
\mathcal{H}_{n}(\theta):=\sum^{n}_{t=1}\sum_{i\in S_{t}}p_{ti}(\bar{\theta})p_%
{t0}(\bar{\theta})x_{ti}x_{ti}^{\top}
\displaystyle J_{n}(\theta_{1})-J_{n}(\theta_{2})=\left[\sum^{n}_{t=1}H_{t}%
\right](\theta_{1}-\theta_{2})
\displaystyle J_{n}(\theta_{1})-J_{n}(\theta_{2})
\displaystyle=\left[\sum^{n}_{t=1}H_{t}\right](\theta_{1}-\theta_{2})
\displaystyle\geq\left[\sum^{n}_{t=1}\sum_{i\in S_{t}}p_{ti}(\bar{\theta})p_{t%
0}(\bar{\theta})x_{ti}x_{ti}^{\top}\right](\theta_{1}-\theta_{2})
\displaystyle\geq\left[\sum^{n}_{t=1}\sum_{i\in S_{t}}p_{ti}(\bar{\theta})p_{t%
0}(\bar{\theta})x_{ti}x_{ti}^{\top}\right](\theta_{1}-\theta_{2})
\displaystyle=\mathcal{H}_{n}(\bar{\theta})(\theta_{1}-\theta_{2})
\displaystyle=\mathcal{H}_{n}(\bar{\theta})(\theta_{1}-\theta_{2})
\bar{\theta}\in\mathcal{B}_{\eta}:=\{\theta:\|\theta-\theta^{*}\|\leq\eta\}
\eta>0
p_{ti}(\bar{\theta})p_{t0}(\bar{\theta})\geq\kappa_{\eta}
\kappa_{\eta}
\kappa_{\eta}:=\inf_{\theta\in\mathcal{B}_{\eta},i\in S,S\in\mathcal{S}}p_{ti}%
(\theta)p_{t0}(\theta)>0
\mathcal{H}_{n}(\bar{\theta})\succeq\kappa_{\eta}V_{n}
\displaystyle(\theta_{1}-\theta_{2})^{\top}(J_{n}(\theta_{1})-J_{n}(\theta_{2}%
))\geq(\theta_{1}-\theta_{2})^{\top}(\kappa_{\eta}V_{n})(\theta_{1}-\theta_{2}%
)>0
\displaystyle(\theta_{1}-\theta_{2})^{\top}(J_{n}(\theta_{1})-J_{n}(\theta_{2}%
))\geq(\theta_{1}-\theta_{2})^{\top}(\kappa_{\eta}V_{n})(\theta_{1}-\theta_{2}%
)>0
\theta_{1}\neq\theta_{2}
J_{n}(\theta)
\mathbb{R}^{d}
\mathbb{R}^{d}
\mathcal{B}_{\eta}
\theta_{1},\theta_{2}\in\mathcal{B}_{\eta}
\bar{\theta}\in\mathcal{B}_{\eta}
J_{n}(\theta)
J_{n}(\theta^{*})=0
\theta\in\mathcal{B}_{\eta}
\displaystyle\|J_{n}(\theta)\|_{V^{-1}_{n}}^{2}=\|J_{n}(\theta)-J_{n}(\theta^{%
*})\|_{V^{-1}_{n}}^{2}
\displaystyle\|J_{n}(\theta)\|_{V^{-1}_{n}}^{2}
\displaystyle=\|J_{n}(\theta)-J_{n}(\theta^{*})\|_{V^{-1}_{n}}^{2}
\displaystyle\geq(\theta-\theta^{*})^{\top}\mathcal{H}_{n}(\bar{\theta})V^{-1}%
_{n}\mathcal{H}_{n}(\bar{\theta})(\theta-\theta^{*})
\displaystyle\geq(\theta-\theta^{*})^{\top}\mathcal{H}_{n}(\bar{\theta})V^{-1}%
_{n}\mathcal{H}_{n}(\bar{\theta})(\theta-\theta^{*})
\displaystyle\geq\kappa^{2}_{\eta}\lambda_{\min}(V_{n})\|\theta-\theta^{*}\|^{2}
\displaystyle\geq\kappa^{2}_{\eta}\lambda_{\min}(V_{n})\|\theta-\theta^{*}\|^{2}
\mathcal{H}_{n}(\bar{\theta})\succeq\kappa_{\eta}V_{n}
\|J_{n}(\theta)\|_{V^{-1}_{n}}
\displaystyle\|J_{n}(\hat{\theta})\|_{V^{-1}_{n}}\leq 2\sqrt{2d+\log\frac{1}{%
\delta}}
\displaystyle\|J_{n}(\hat{\theta})\|_{V^{-1}_{n}}\leq 2\sqrt{2d+\log\frac{1}{%
\delta}}
1-\delta
\|\hat{\theta}-\theta^{*}\|\leq\frac{2}{\kappa_{\eta}}\sqrt{\frac{2d+\log(1/%
\delta)}{\lambda_{\min}(V_{n})}}
\kappa=\kappa_{1}
\kappa\leq\min_{\|\theta-\theta^{*}\|\leq 1}p_{ti}(S,\theta)p_{t0}(S,\theta)
\|\hat{\theta}-\theta^{*}\|\leq\frac{2}{\kappa}\sqrt{\frac{2d+\log(1/\delta)}{%
\lambda_{\min}(V_{n})}}\leq 1
\lambda_{\min}(V_{n})\geq\frac{4}{\kappa^{2}}(2d+\log\frac{1}{\delta})
\hat{\theta}
F,L
E
\displaystyle F(\theta):=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta)x_{ti}x_%
{ti}^{\top}-\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\theta)p_{%
tj}(\theta)x_{ti}x_{tj}^{\top}
\displaystyle F(\theta):=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta)x_{ti}x_%
{ti}^{\top}-\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(\theta)p_{%
tj}(\theta)x_{ti}x_{tj}^{\top}
\displaystyle L:=F(\theta^{*})=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta^{*%
})x_{ti}x_{ti}^{\top}-\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(%
\theta^{*})p_{tj}(\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle L:=F(\theta^{*})=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta^{*%
})x_{ti}x_{ti}^{\top}-\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}(%
\theta^{*})p_{tj}(\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle E:=F(\tilde{\theta})-F(\theta^{*})
\displaystyle E:=F(\tilde{\theta})-F(\theta^{*})
\tilde{\theta}:=c\theta^{*}+(1-c)\hat{\theta}
c\in(0,1)
\displaystyle Z_{n}=J_{n}(\hat{\theta})=J_{n}(\hat{\theta})-J_{n}(\theta^{*})
\displaystyle Z_{n}
\displaystyle=J_{n}(\hat{\theta})=J_{n}(\hat{\theta})-J_{n}(\theta^{*})
\displaystyle=(L+E)(\hat{\theta}-\theta^{*}).
\displaystyle=(L+E)(\hat{\theta}-\theta^{*}).
x\in\mathbb{R}^{2}
\displaystyle x^{\top}(\hat{\theta}-\theta^{*})=x^{\top}(L+E)^{-1}Z_{n}
\displaystyle x^{\top}(\hat{\theta}-\theta^{*})
\displaystyle=x^{\top}(L+E)^{-1}Z_{n}
\displaystyle=x^{\top}L^{-1}Z_{n}-x^{\top}L^{-1}E(L+E)^{-1}Z_{n}.
\displaystyle=x^{\top}L^{-1}Z_{n}-x^{\top}L^{-1}E(L+E)^{-1}Z_{n}.
(L+E)
(L+E)
E
\hat{\theta}
\theta^{*}
\tilde{\theta}
\theta^{*}
E
E
E
E_{1}
E_{2}
\displaystyle E=\underbrace{\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{ti}(\tilde%
{\theta})-p_{ti}(\theta^{*})\right)x_{ti}x_{ti}^{\top}}_{E_{1}}-\underbrace{%
\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{ti}(\tilde{\theta})p_%
{tj}(\tilde{\theta})-p_{ti}(\theta^{*})p_{tj}(\theta^{*})\right)x_{ti}x_{tj}^{%
\top}}_{E_{2}}
\displaystyle E
\displaystyle=\underbrace{\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{ti}(\tilde{%
\theta})-p_{ti}(\theta^{*})\right)x_{ti}x_{ti}^{\top}}_{E_{1}}-\underbrace{%
\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{ti}(\tilde{\theta})p_%
{tj}(\tilde{\theta})-p_{ti}(\theta^{*})p_{tj}(\theta^{*})\right)x_{ti}x_{tj}^{%
\top}}_{E_{2}}
E_{1}
\displaystyle E_{1}=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{ti}(\tilde{\theta}%
)-p_{ti}(\theta^{*})\right)x_{ti}x_{ti}^{\top}
\displaystyle E_{1}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\left(p_{ti}(\tilde{\theta})-p_{%
ti}(\theta^{*})\right)x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\nabla_{j}p_{ti}%
(\theta_{1})x_{tj}^{\top}(\hat{\theta}-\theta^{*})x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\nabla_{j}p_{ti}%
(\theta_{1})x_{tj}^{\top}(\hat{\theta}-\theta^{*})x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta_{1})x_{ti}^{\top}(%
\hat{\theta}-\theta^{*})x_{ti}x_{ti}^{\top}-\sum_{t=1}^{n}\sum_{i\in S_{t}}%
\sum_{j\in S_{t}}p_{ti}(\theta_{1})p_{tj}(\theta_{1})x_{tj}^{\top}(\hat{\theta%
}-\theta^{*})x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta_{1})x_{ti}^{\top}(%
\hat{\theta}-\theta^{*})x_{ti}x_{ti}^{\top}-\sum_{t=1}^{n}\sum_{i\in S_{t}}%
\sum_{j\in S_{t}}p_{ti}(\theta_{1})p_{tj}(\theta_{1})x_{tj}^{\top}(\hat{\theta%
}-\theta^{*})x_{ti}x_{ti}^{\top}
\theta_{1}:=c_{1}\theta^{*}+(1-c_{1})\hat{\theta}
c_{1}\in(0,1)
\tilde{\theta}
\theta^{*}
\tilde{\theta}
\hat{\theta}
\theta^{*}
c_{1}
\displaystyle E_{1}=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta_{1})\left(x_{%
ti}^{\top}(\hat{\theta}-\theta^{*})-\sum_{j\in S_{t}}p_{tj}(\theta_{1})x_{tj}^%
{\top}(\hat{\theta}-\theta^{*})\right)x_{ti}x_{ti}^{\top}
\displaystyle E_{1}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta_{1})\left(x_{ti}^{%
\top}(\hat{\theta}-\theta^{*})-\sum_{j\in S_{t}}p_{tj}(\theta_{1})x_{tj}^{\top%
}(\hat{\theta}-\theta^{*})\right)x_{ti}x_{ti}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta_{1})\left\|x_{ti%
}-\sum_{j\in S_{t}}p_{tj}(\theta_{1})x_{tj}\right\|\|\hat{\theta}-\theta^{*}\|%
x_{ti}x_{ti}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}p_{ti}(\theta_{1})\left\|x_{ti%
}-\sum_{j\in S_{t}}p_{tj}(\theta_{1})x_{tj}\right\|\|\hat{\theta}-\theta^{*}\|%
x_{ti}x_{ti}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}2p_{ti}(\theta_{1})\|\hat{%
\theta}-\theta^{*}\|x_{ti}x_{ti}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}2p_{ti}(\theta_{1})\|\hat{%
\theta}-\theta^{*}\|x_{ti}x_{ti}^{\top}
\|x_{ti}\|<1
i
t
x\in\mathbb{R}^{d}\setminus\{0\}
\displaystyle x^{\top}L^{-1/2}E_{1}L^{-1/2}x\leq\sum_{t=1}^{n}\sum_{i\in S_{t}%
}2p_{ti}(\theta_{1})\|\hat{\theta}-\theta^{*}\|\|x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle x^{\top}L^{-1/2}E_{1}L^{-1/2}x
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}2p_{ti}(\theta_{1})\|\hat{%
\theta}-\theta^{*}\|\|x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}2\|\hat{\theta}-\theta^{*}\|\|%
x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}2\|\hat{\theta}-\theta^{*}\|\|%
x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle\leq 2\|\hat{\theta}-\theta^{*}\|\left(x^{\top}L^{-1/2}\left(\sum%
_{t=1}^{n}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)L^{-1/2}x\right)
\displaystyle\leq 2\|\hat{\theta}-\theta^{*}\|\left(x^{\top}L^{-1/2}\left(\sum%
_{t=1}^{n}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)L^{-1/2}x\right)
\displaystyle\leq\frac{2}{\kappa}\|\hat{\theta}-\theta^{*}\|\|x\|^{2}
\displaystyle\leq\frac{2}{\kappa}\|\hat{\theta}-\theta^{*}\|\|x\|^{2}
p_{ti}(\theta_{1})\leq 1
\|L^{-1/2}E_{1}L^{-1/2}\|\leq\frac{2}{\kappa}\|\hat{\theta}-\theta^{*}\|\leq%
\frac{4}{\kappa^{2}}\sqrt{\frac{2d+\log(1/\delta)}{\lambda_{\min}(V_{n})}}.
E_{2}
\theta_{2}:=c_{2}\theta^{*}+(1-c_{2})\hat{\theta}
c_{2}\in(0,1)
\displaystyle E_{2}=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{%
ti}(\tilde{\theta})p_{tj}(\tilde{\theta})-p_{ti}(\theta^{*})p_{tj}(\theta^{*})%
\right)x_{ti}x_{tj}^{\top}
\displaystyle E_{2}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left(p_{ti}(%
\tilde{\theta})p_{tj}(\tilde{\theta})-p_{ti}(\theta^{*})p_{tj}(\theta^{*})%
\right)x_{ti}x_{tj}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\sum_{k\in S_{t}%
}\nabla_{k}[p_{ti}(\theta_{2})p_{tj}(\theta_{2})]x_{t,k}^{\top}(\hat{\theta}-%
\theta^{*})x_{ti}x_{ti}^{\top}.
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\sum_{k\in S_{t}%
}\nabla_{k}[p_{ti}(\theta_{2})p_{tj}(\theta_{2})]x_{t,k}^{\top}(\hat{\theta}-%
\theta^{*})x_{ti}x_{ti}^{\top}.
p_{ti}=p_{ti}(\theta_{2})
\displaystyle E_{2}=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\sum_{k\in
S%
_{t}}\nabla_{k}[p_{ti}p_{tj}]x_{t,k}^{\top}(\hat{\theta}-\theta^{*})x_{ti}x_{%
tj}^{\top}
\displaystyle E_{2}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\sum_{k\in S_{t}%
}\nabla_{k}[p_{ti}p_{tj}]x_{t,k}^{\top}(\hat{\theta}-\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left[p_{tj}%
\left(p_{ti}x_{ti}-\sum_{k\in S_{t}}p_{ti}p_{t,k}x_{t,k}\right)+p_{ti}\left(p_%
{tj}x_{tj}-\sum_{k\in S_{t}}p_{tj}p_{t,k}x_{t,k}\right)\right]^{\top}(\hat{%
\theta}-\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}\left[p_{tj}%
\left(p_{ti}x_{ti}-\sum_{k\in S_{t}}p_{ti}p_{t,k}x_{t,k}\right)+p_{ti}\left(p_%
{tj}x_{tj}-\sum_{k\in S_{t}}p_{tj}p_{t,k}x_{t,k}\right)\right]^{\top}(\hat{%
\theta}-\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}p_{tj}%
\left[(x_{ti}+x_{tj})-2\sum_{k\in S_{t}}p_{t,k}x_{t,k}\right]^{\top}(\hat{%
\theta}-\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}p_{tj}%
\left[(x_{ti}+x_{tj})-2\sum_{k\in S_{t}}p_{t,k}x_{t,k}\right]^{\top}(\hat{%
\theta}-\theta^{*})x_{ti}x_{tj}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}p_{tj}%
\left\|(x_{ti}+x_{tj})-2\sum_{k\in S_{t}}p_{t,k}x_{t,k}\right\|\|\hat{\theta}-%
\theta^{*}\|x_{ti}x_{tj}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}p_{ti}p_{tj}%
\left\|(x_{ti}+x_{tj})-2\sum_{k\in S_{t}}p_{t,k}x_{t,k}\right\|\|\hat{\theta}-%
\theta^{*}\|x_{ti}x_{tj}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}4p_{ti}p_{tj}%
\|\hat{\theta}-\theta^{*}\|x_{ti}x_{tj}^{\top}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}\sum_{j\in S_{t}}4p_{ti}p_{tj}%
\|\hat{\theta}-\theta^{*}\|x_{ti}x_{tj}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}4p_{ti}\left(1-p_{t0}\right)\|%
\hat{\theta}-\theta^{*}\|x_{ti}x_{ti}^{\top}
\displaystyle=\sum_{t=1}^{n}\sum_{i\in S_{t}}4p_{ti}\left(1-p_{t0}\right)\|%
\hat{\theta}-\theta^{*}\|x_{ti}x_{ti}^{\top}
p_{t0}=p_{t0}(\theta_{2})
x\in\mathbb{R}^{d}\setminus\{0\}
\displaystyle x^{\top}L^{-1/2}E_{2}L^{-1/2}x\leq\sum_{t=1}^{n}\sum_{i\in S_{t}%
}4p_{ti}(\theta_{2})\left(1-p_{t0}(\theta_{2})\right)\|\hat{\theta}-\theta^{*}%
\|\|x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle x^{\top}L^{-1/2}E_{2}L^{-1/2}x
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}4p_{ti}(\theta_{2})\left(1-p_{%
t0}(\theta_{2})\right)\|\hat{\theta}-\theta^{*}\|\|x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}4\|\hat{\theta}-\theta^{*}\|\|%
x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle\leq\sum_{t=1}^{n}\sum_{i\in S_{t}}4\|\hat{\theta}-\theta^{*}\|\|%
x^{\top}L^{-1/2}x_{ti}\|^{2}
\displaystyle\leq 4\|\hat{\theta}-\theta^{*}\|\left(x^{\top}L^{-1/2}\left(\sum%
_{t=1}^{n}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)L^{-1/2}x\right)
\displaystyle\leq 4\|\hat{\theta}-\theta^{*}\|\left(x^{\top}L^{-1/2}\left(\sum%
_{t=1}^{n}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\right)L^{-1/2}x\right)
\displaystyle\leq\frac{4}{\kappa}\|\hat{\theta}-\theta^{*}\|\|x\|^{2}
\displaystyle\leq\frac{4}{\kappa}\|\hat{\theta}-\theta^{*}\|\|x\|^{2}
\|L^{-1/2}E_{2}L^{-1/2}\|\leq\frac{4}{\kappa}\|\hat{\theta}-\theta^{*}\|\leq%
\frac{8}{\kappa^{2}}\sqrt{\frac{2d+\log(1/\delta)}{\lambda_{\min}(V_{n})}}.
\lambda_{\min}(V_{n})\geq\frac{24^{2}}{\kappa^{4}}(d+\log\frac{1}{\delta})
\displaystyle\|L^{-1/2}EL^{-1/2}\|=\|L^{-1/2}(E_{1}-E_{2})L^{-1/2}\|
\displaystyle\|L^{-1/2}EL^{-1/2}\|
\displaystyle=\|L^{-1/2}(E_{1}-E_{2})L^{-1/2}\|
\displaystyle\leq\|L^{-1/2}E_{1}L^{-1/2}\|+\|L^{-1/2}E_{2}L^{-1/2}\|
\displaystyle\leq\|L^{-1/2}E_{1}L^{-1/2}\|+\|L^{-1/2}E_{2}L^{-1/2}\|
\displaystyle\leq\frac{12}{\kappa^{2}}\sqrt{\frac{2d+\log(1/\delta)}{\lambda_{%
\min}(V_{n})}}\leq\frac{1}{2}.
\displaystyle\leq\frac{12}{\kappa^{2}}\sqrt{\frac{2d+\log(1/\delta)}{\lambda_{%
\min}(V_{n})}}\leq\frac{1}{2}.
x^{\top}(\hat{\theta}-\theta^{*})
x\in\mathbb{R}^{2}
\displaystyle x^{\top}(\hat{\theta}-\theta^{*})=x^{\top}L^{-1}Z_{n}-x^{\top}L^%
{-1}E(L+E)^{-1}Z_{n}.
\displaystyle x^{\top}(\hat{\theta}-\theta^{*})
\displaystyle=x^{\top}L^{-1}Z_{n}-x^{\top}L^{-1}E(L+E)^{-1}Z_{n}.
x^{\top}L^{-1}Z_{n}
\displaystyle X_{t}:=[x_{t1};x_{t2};...;x_{t|S_{t}|}]^{\top}\in\mathbb{R}^{|S_%
{t}|\times d}
\displaystyle X_{t}
\displaystyle:=[x_{t1};x_{t2};...;x_{t|S_{t}|}]^{\top}\in\mathbb{R}^{|S_{t}|%
\times d}
\displaystyle D:=[X_{1};X_{2};...;X_{n}]^{\top}\in\mathbb{R}^{(\sum_{t}|S_{t}|%
)\times d}
\displaystyle D
\displaystyle:=[X_{1};X_{2};...;X_{n}]^{\top}\in\mathbb{R}^{(\sum_{t}|S_{t}|)%
\times d}
\displaystyle\mathcal{E}_{t}:=[\epsilon_{t1},\epsilon_{t2},...,\epsilon_{t|S_{%
t}|}]^{\top}\in\mathbb{R}^{|S_{t}|}
\displaystyle\mathcal{E}_{t}
\displaystyle:=[\epsilon_{t1},\epsilon_{t2},...,\epsilon_{t|S_{t}|}]^{\top}\in%
\mathbb{R}^{|S_{t}|}
|x^{\top}L^{-1}Z_{n}|=\left|\sum_{t}x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}\right|
X_{t}
\mathcal{E}_{t}
t
\displaystyle\mathbb{E}\left[x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}\right]=%
\mathbb{E}\left[\sum_{i\in S_{t}}x^{\top}L^{-1}x_{ti}\epsilon_{ti}\right]=\sum%
_{i\in S_{t}}\mathbb{E}\left[x^{\top}L^{-1}x_{ti}\right]\mathbb{E}[\epsilon_{%
ti}]=0
\displaystyle\mathbb{E}\left[x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}\right]=%
\mathbb{E}\left[\sum_{i\in S_{t}}x^{\top}L^{-1}x_{ti}\epsilon_{ti}\right]=\sum%
_{i\in S_{t}}\mathbb{E}\left[x^{\top}L^{-1}x_{ti}\right]\mathbb{E}[\epsilon_{%
ti}]
\displaystyle=0
\mathbb{E}[\epsilon_{ti}]=0
t,i
\displaystyle\left|x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}\right|\leq\|x^{%
\top}L^{-1}X_{t}^{\top}\|\|\mathcal{E}_{t}\|\leq\sqrt{2}\|x^{\top}L^{-1}X_{t}^%
{\top}\|
\displaystyle\left|x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}\right|\leq\|x^{%
\top}L^{-1}X_{t}^{\top}\|\|\mathcal{E}_{t}\|\leq\sqrt{2}\|x^{\top}L^{-1}X_{t}^%
{\top}\|
\|\mathcal{E}_{t}\|\leq\sqrt{2}
\|x^{\top}L^{-1}X_{t}^{\top}\|
X_{t}
x
x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}
\displaystyle\mathbb{P}\left(|x^{\top}L^{-1}Z_{n}|\geq\nu\right)=\mathbb{P}%
\left(\left|\sum_{t=1}^{n}x^{\top}L^{-1}X_{t}^{\top}\mathcal{E}_{t}\right|\geq%
\nu\right)
\displaystyle\mathbb{P}\left(|x^{\top}L^{-1}Z_{n}|\geq\nu\right)
\displaystyle=\mathbb{P}\left(\left|\sum_{t=1}^{n}x^{\top}L^{-1}X_{t}^{\top}%
\mathcal{E}_{t}\right|\geq\nu\right)
\displaystyle\leq 2\exp\left\{-\frac{2\nu^{2}}{\sum_{t=1}^{n}\left(2\sqrt{2}\|%
x^{\top}L^{-1}X^{\top}_{t}\|\right)^{2}}\right\}
\displaystyle\leq 2\exp\left\{-\frac{2\nu^{2}}{\sum_{t=1}^{n}\left(2\sqrt{2}\|%
x^{\top}L^{-1}X^{\top}_{t}\|\right)^{2}}\right\}
\displaystyle=2\exp\left\{-\frac{\nu^{2}}{4\|x^{\top}L^{-1}D^{\top}\|^{2}}\right\}
\displaystyle=2\exp\left\{-\frac{\nu^{2}}{4\|x^{\top}L^{-1}D^{\top}\|^{2}}\right\}
\displaystyle\leq 2\exp\left\{-\frac{\kappa^{2}\nu^{2}}{4\|x\|^{2}_{V^{-1}_{n}%
}}\right\}
\displaystyle\leq 2\exp\left\{-\frac{\kappa^{2}\nu^{2}}{4\|x\|^{2}_{V^{-1}_{n}%
}}\right\}
D_{t}
\displaystyle\sum_{t=1}^{n}\|x^{\top}L^{-1}X^{\top}_{t}\|^{2}=\sum_{t=1}^{n}x^%
{\top}L^{-1}X^{\top}_{t}X_{t}L^{-1}x=x^{\top}L^{-1}D^{\top}DL^{-1}x=\|x^{\top}%
L^{-1}D^{\top}\|^{2}\,.
\displaystyle\sum_{t=1}^{n}\|x^{\top}L^{-1}X^{\top}_{t}\|^{2}=\sum_{t=1}^{n}x^%
{\top}L^{-1}X^{\top}_{t}X_{t}L^{-1}x=x^{\top}L^{-1}D^{\top}DL^{-1}x=\|x^{\top}%
L^{-1}D^{\top}\|^{2}\,.
L\succeq\kappa V=\kappa D^{\top}D
\displaystyle\|x^{\top}L^{-1}D^{\top}\|^{2}=x^{\top}L^{-1}D^{\top}DL^{-1}x\leq%
\frac{1}{\kappa^{2}}\|x\|^{2}_{V^{-1}_{n}}\,.
\displaystyle\|x^{\top}L^{-1}D^{\top}\|^{2}=x^{\top}L^{-1}D^{\top}DL^{-1}x\leq%
\frac{1}{\kappa^{2}}\|x\|^{2}_{V^{-1}_{n}}\,.
2\delta
\nu
1-2\delta
|x^{\top}L^{-1}Z|\leq\frac{2\sqrt{\log(1/\delta)}}{\kappa}\|x\|_{V^{-1}_{n}}.
\displaystyle|x^{\top}L^{-1}E(L+E)^{-1}Z_{n}|\leq\|x\|_{L^{-1}}\|L^{-1/2}E(L+E%
)^{-1}Z_{n}\|
\displaystyle|x^{\top}L^{-1}E(L+E)^{-1}Z_{n}|
\displaystyle\leq\|x\|_{L^{-1}}\|L^{-1/2}E(L+E)^{-1}Z_{n}\|
\displaystyle\leq\|x\|_{L^{-1}}\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|\|Z_{n}\|_{L^{-1}}
\displaystyle\leq\|x\|_{L^{-1}}\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|\|Z_{n}\|_{L^{-1}}
\displaystyle\leq\frac{1}{\kappa}\|x\|_{V^{-1}_{n}}\|L^{-1/2}E(L+E)^{-1}L^{1/2%
}\|\|Z_{n}\|_{V^{-1}_{n}}
\displaystyle\leq\frac{1}{\kappa}\|x\|_{V^{-1}_{n}}\|L^{-1/2}E(L+E)^{-1}L^{1/2%
}\|\|Z_{n}\|_{V^{-1}_{n}}
L\succeq\kappa V_{n}
\displaystyle\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|=\|L^{-1/2}E(L^{-1}-L^{-1}E(L+E)^{-%
1})L^{1/2}\|
\displaystyle\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|
\displaystyle=\|L^{-1/2}E(L^{-1}-L^{-1}E(L+E)^{-1})L^{1/2}\|
\displaystyle=\|L^{-1/2}EL^{-1/2}-L^{-1/2}EL^{-1}E(L+E)^{-1}L^{1/2}\|
\displaystyle=\|L^{-1/2}EL^{-1/2}-L^{-1/2}EL^{-1}E(L+E)^{-1}L^{1/2}\|
\displaystyle\leq\|L^{-1/2}EL^{-1/2}\|+\|L^{-1/2}EL^{-1/2}\|\|L^{-1/2}E(L+E)^{%
-1}L^{1/2}\|
\displaystyle\leq\|L^{-1/2}EL^{-1/2}\|+\|L^{-1/2}EL^{-1/2}\|\|L^{-1/2}E(L+E)^{%
-1}L^{1/2}\|
\displaystyle\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|\leq\frac{\|L^{-1/2}EL^{-1/2}\|}{1-%
\|L^{-1/2}EL^{-1/2}\|}
\displaystyle\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|
\displaystyle\leq\frac{\|L^{-1/2}EL^{-1/2}\|}{1-\|L^{-1/2}EL^{-1/2}\|}
\displaystyle\leq 2\|L^{-1/2}EL^{-1/2}\|
\displaystyle\leq 2\|L^{-1/2}EL^{-1/2}\|
\displaystyle\leq\frac{24}{\kappa^{2}}\sqrt{\frac{d+\log(1/\delta)}{\lambda_{%
\min}(V_{n})}}
\displaystyle\leq\frac{24}{\kappa^{2}}\sqrt{\frac{d+\log(1/\delta)}{\lambda_{%
\min}(V_{n})}}
\|Z_{n}\|_{V^{-1}_{n}}\leq 2\sqrt{2d+\log\frac{1}{\delta}}
\displaystyle|x^{\top}L^{-1}E(L+E)^{-1}Z_{n}|\leq\frac{1}{\kappa}\|x\|_{V^{-1}%
_{n}}\|L^{-1/2}E(L+E)^{-1}L^{1/2}\|\|Z_{n}\|_{V^{-1}_{n}}
\displaystyle|x^{\top}L^{-1}E(L+E)^{-1}Z_{n}|
\displaystyle\leq\frac{1}{\kappa}\|x\|_{V^{-1}_{n}}\|L^{-1/2}E(L+E)^{-1}L^{1/2%
}\|\|Z_{n}\|_{V^{-1}_{n}}
\displaystyle\leq\frac{48\left(2d+\log\frac{1}{\delta}\right)}{\kappa^{3}\sqrt%
{\lambda_{\min}(V_{n})}}\|x\|_{V^{-1}_{n}}
\displaystyle\leq\frac{48\left(2d+\log\frac{1}{\delta}\right)}{\kappa^{3}\sqrt%
{\lambda_{\min}(V_{n})}}\|x\|_{V^{-1}_{n}}
\displaystyle|x^{\top}(\hat{\theta}_{n}-\theta^{*})|\leq|x^{\top}L^{-1}Z|+|x^{%
\top}L^{-1}E(L+E)^{-1}Z_{n}|
\displaystyle|x^{\top}(\hat{\theta}_{n}-\theta^{*})|
\displaystyle\leq|x^{\top}L^{-1}Z|+|x^{\top}L^{-1}E(L+E)^{-1}Z_{n}|
\displaystyle\leq\frac{\sqrt{\log\frac{1}{\delta}}}{\kappa}\|x\|_{V^{-1}_{n}}+%
\frac{48\left(2d+\log\frac{1}{\delta}\right)}{\kappa^{3}\sqrt{\lambda_{\min}(V%
_{n})}}\|x\|_{V^{-1}_{n}}.
\displaystyle\leq\frac{\sqrt{\log\frac{1}{\delta}}}{\kappa}\|x\|_{V^{-1}_{n}}+%
\frac{48\left(2d+\log\frac{1}{\delta}\right)}{\kappa^{3}\sqrt{\lambda_{\min}(V%
_{n})}}\|x\|_{V^{-1}_{n}}.
|x^{\top}(\hat{\theta}_{n}-\theta^{*})|\leq\frac{5}{\kappa}\sqrt{\log\frac{1}{%
\delta}}\|x\|_{V^{-1}_{n}}
\lambda_{\min}(V_{n})\geq\frac{144}{\kappa^{4}}\left(4d^{2}+\log\frac{1}{%
\delta}\right)
\delta>0
1-\delta
\|J_{n}(\hat{\theta})\|_{V^{-1}_{n}}\leq 4\sqrt{2d+\log\frac{1}{\delta}}.
Z=J_{n}(\hat{\theta})
V=V_{n}
\hat{\mathbb{B}}
\mathbb{B}^{d}
|\hat{\mathbb{B}}|\leq 6^{d}
x\in\mathbb{B}^{d}
\hat{x}\in\hat{\mathbb{B}}
\|x-\hat{x}\|\leq\frac{1}{2}
\displaystyle x^{\top}V^{-1/2}Z=\hat{x}^{\top}V^{-1/2}Z+(x-\hat{x})^{\top}V^{-%
1/2}Z
\displaystyle x^{\top}V^{-1/2}Z
\displaystyle=\hat{x}^{\top}V^{-1/2}Z+(x-\hat{x})^{\top}V^{-1/2}Z
\displaystyle=\hat{x}^{\top}V^{-1/2}Z+\|x-\hat{x}\|\cdot\frac{1}{\|x-\hat{x}\|%
}(x-\hat{x})^{\top}V^{-1/2}Z
\displaystyle=\hat{x}^{\top}V^{-1/2}Z+\|x-\hat{x}\|\cdot\frac{1}{\|x-\hat{x}\|%
}(x-\hat{x})^{\top}V^{-1/2}Z
\displaystyle\leq\hat{x}^{\top}V^{-1/2}Z+\frac{1}{2}\sup_{z\in\mathbb{B}^{d}}z%
^{\top}V^{-1/2}Z\,.
\displaystyle\leq\hat{x}^{\top}V^{-1/2}Z+\frac{1}{2}\sup_{z\in\mathbb{B}^{d}}z%
^{\top}V^{-1/2}Z\,.
\sup_{x\in\mathbb{B}^{d}}x^{\top}V^{-1/2}Z\leq 2\max_{\hat{x}\in\hat{\mathbb{B%
}}}\hat{x}^{\top}V^{-1/2}Z\,.
\|Z\|_{V^{-1}}=\|V^{-1/2}Z\|_{2}=\sup_{\|x\|_{2}\leq 1}x^{\top}V^{-1/2}Z
Z=\sum_{t=1}^{n}X^{\top}_{t}\mathcal{E}_{t}
\displaystyle\mathbb{P}\left(\|Z\|_{V^{-1}}\geq\nu\right)\leq\mathbb{P}\left(%
\max_{\hat{x}\in\hat{\mathbb{B}}}\hat{x}^{\top}V^{-1/2}Z>\frac{\nu}{2}\right)
\displaystyle\mathbb{P}\left(\|Z\|_{V^{-1}}\geq\nu\right)
\displaystyle\leq\mathbb{P}\left(\max_{\hat{x}\in\hat{\mathbb{B}}}\hat{x}^{%
\top}V^{-1/2}Z>\frac{\nu}{2}\right)
\displaystyle\leq\sum_{\hat{x}\in\hat{\mathbb{B}}}\mathbb{P}\left(\hat{x}^{%
\top}V^{-1/2}Z>\frac{\nu}{2}\right)
\displaystyle\leq\sum_{\hat{x}\in\hat{\mathbb{B}}}\mathbb{P}\left(\hat{x}^{%
\top}V^{-1/2}Z>\frac{\nu}{2}\right)
\displaystyle=\sum_{\hat{x}\in\hat{\mathbb{B}}}\mathbb{P}\left(\sum_{t=1}^{n}%
\hat{x}^{\top}V^{-1/2}X^{\top}_{t}\mathcal{E}_{t}\geq\frac{\nu}{2}\right)\,.
\displaystyle=\sum_{\hat{x}\in\hat{\mathbb{B}}}\mathbb{P}\left(\sum_{t=1}^{n}%
\hat{x}^{\top}V^{-1/2}X^{\top}_{t}\mathcal{E}_{t}\geq\frac{\nu}{2}\right)\,.
|\hat{x}^{\top}V^{-1/2}X^{\top}_{t}\mathcal{E}_{t}|\leq\sqrt{2}\|\hat{x}^{\top%
}V^{-1/2}X^{\top}_{t}\|
\hat{x}^{\top}V^{-1/2}X^{\top}_{t}\mathcal{E}_{t}
\displaystyle\mathbb{P}\left(\|Z\|_{V^{-1}}\geq\nu\right)\leq\sum_{\hat{x}\in%
\hat{\mathbb{B}}}\exp\left\{-\frac{2\nu^{2}}{32\sum_{t=1}^{n}\|\hat{x}^{\top}V%
^{-1/2}X^{\top}_{t}\|^{2}}\right\}
\displaystyle\mathbb{P}\left(\|Z\|_{V^{-1}}\geq\nu\right)
\displaystyle\leq\sum_{\hat{x}\in\hat{\mathbb{B}}}\exp\left\{-\frac{2\nu^{2}}{%
32\sum_{t=1}^{n}\|\hat{x}^{\top}V^{-1/2}X^{\top}_{t}\|^{2}}\right\}
\displaystyle=\sum_{\hat{x}\in\hat{\mathbb{B}}}\exp\left\{-\frac{\nu^{2}}{16\|%
\hat{x}^{\top}V^{-1/2}D^{\top}\|^{2}}\right\}
\displaystyle=\sum_{\hat{x}\in\hat{\mathbb{B}}}\exp\left\{-\frac{\nu^{2}}{16\|%
\hat{x}^{\top}V^{-1/2}D^{\top}\|^{2}}\right\}
\displaystyle\leq\exp\left\{-\frac{\nu^{2}}{16}+d\log 6\right\}
\displaystyle\leq\exp\left\{-\frac{\nu^{2}}{16}+d\log 6\right\}
V=D^{\top}D
|\hat{\mathbb{B}}|\leq 6^{d}
\nu=4\sqrt{2d+\log(1/\delta)}
\displaystyle\mathbb{P}\left(\|Z\|_{V^{-1}}\geq 4\sqrt{2d+\log(1/\delta)}%
\right)\leq\exp\left\{-\frac{32d+16\log(1/\delta)}{16}+d\log 6\right\}\leq\delta.
\displaystyle\mathbb{P}\left(\|Z\|_{V^{-1}}\geq 4\sqrt{2d+\log(1/\delta)}%
\right)\leq\exp\left\{-\frac{32d+16\log(1/\delta)}{16}+d\log 6\right\}\leq\delta.
\alpha
\Psi
A
\{x_{ti}\}
\hat{\theta}_{t}
\sum_{t^{\prime}\in\Psi}\sum_{i\in S_{t^{\prime}}}\left(p_{t^{\prime}}(i|S_{t^%
{\prime}},\theta)-y_{t^{\prime}i}\right)x_{t^{\prime}i}=0
V_{\Psi}=\sum_{t^{\prime}\in\Psi}\sum_{i\in S_{t^{\prime}}}x_{t^{\prime}i}x_{t%
^{\prime}i}^{\top}
\displaystyle w_{ti}=\alpha\|x_{ti}\|_{V^{-1}_{\Psi}}\text{ for all $i\in%
\mathcal{I}$}
i\in\mathcal{I}
\displaystyle w_{ti}
\displaystyle=\alpha\|x_{ti}\|_{V^{-1}_{\Psi}}\text{ for all $i\in\mathcal{I}$}
i\in\mathcal{I}
\displaystyle\mathcal{W}_{t}=2\max_{i\in\mathcal{I}}w_{ti}
\displaystyle\mathcal{W}_{t}
\displaystyle=2\max_{i\in\mathcal{I}}w_{ti}
\mathcal{I}=\{i\in S:S\in A\}
\{\Psi_{\ell}\}_{\ell=0}^{L}
\{1,2,...,T\}
y_{t}
\Psi_{\ell}
\Psi_{\ell}
T
T_{0}
\alpha
t\in[T_{0}]
S_{t}
|S_{t}|=K
L=\lfloor\frac{1}{2}\log_{2}T\rfloor
\Psi_{0}=\cdots=\Psi_{L}=\emptyset
T_{0}=\tau+1
T
A_{1}=\mathcal{S}
\ell=1
S_{t}
A_{\ell}
\alpha
\Psi_{\ell}\cup[T_{0}]
\hat{\theta}^{(\ell)}_{t}
w^{(\ell)}_{ti}
\mathcal{W}^{(\ell)}_{t}
\mathcal{W}^{(\ell)}_{t}\leq\frac{1}{\sqrt{T}}
S_{t}=\argmax_{S\in A_{\ell}}R_{t}(S,\hat{\theta}^{(\ell)}_{t})
\Psi_{0}=\Psi_{0}\cup\{t\}
\mathcal{W}^{(\ell)}_{t}>2^{-\ell}
S_{t}=\argmax_{S\subseteq A_{\ell}}\sum_{i\in S}w_{ti}^{(\ell)}
\Psi_{\ell}=\Psi_{\ell}\cup\{t\}
\mathcal{W}^{(\ell)}_{t}\leq 2^{-\ell}
\mathcal{M}_{t}^{(\ell)}=\max_{S\in A_{\ell}}R_{t}(S,\hat{\theta}^{(\ell)}_{t})
\displaystyle A_{\ell+1}=\left\{S\in A_{\ell}:R_{t}(S,\hat{\theta}^{(\ell)}_{t%
})\geq\mathcal{M}_{t}^{(\ell)}-2^{-\ell+1}\right\}
\ell\leftarrow\ell+1
w_{ti}=\alpha\|x_{ti}\|_{V^{-1}_{t}}
A_{\ell}
\ell=1,...,L
S_{t}
w^{(\ell)}_{ti}
i
\mathcal{W}^{(\ell)}_{t}
\hat{\theta}^{(\ell)}_{t}
\{y_{t},t\in\Psi_{\ell}\}
\Psi_{\ell}
\frac{1}{K\sqrt{T}}
2^{-\ell}
S_{t}
\Psi_{\ell}
t
S_{t}
\ell
\ell+1
S_{t}
R_{t}(S,\hat{\theta})
\theta^{*}
\hat{\theta}^{(\ell)}_{t}
R_{t}(S)
\tilde{R}_{t}(S)
\Psi_{\ell}
\ell\in[L]
t\in[T]
\Psi_{\ell}
\{[x_{ti}]_{i\in S_{t}},t\in\Psi_{\ell}\}
\{y_{t},t\in\Psi_{\ell}\}
\Psi_{\ell}
T_{0}=\frac{C_{0}}{\kappa^{4}}\max\left\{\frac{\sqrt{dT}}{\sigma_{0}},\frac{d+%
2\log(TN\log_{2}T)}{\sigma_{0}^{2}}\right\}
C_{0}
\alpha=\frac{5}{\kappa}\sqrt{2\log(TN\log_{2}T)}
T\geq\tilde{T}
\tilde{T}=\Omega\left(\max\left\{\frac{\log^{2}\left(TN\log_{2}T\right)}{d},d^%
{3}\right\}\right).
\displaystyle\mathcal{R}_{T}=\mathcal{O}\left(\sqrt{dT\log(T/d)\log(TN\log_{2}%
T)\log_{2}T}\right).
\displaystyle\mathcal{R}_{T}
\displaystyle=\mathcal{O}\left(\sqrt{dT\log(T/d)\log(TN\log_{2}T)\log_{2}T}%
\right).
\tilde{\mathcal{O}}(\sqrt{dT})
\Omega(\sqrt{NT})
K
\Omega(\sqrt{dT})
\tilde{\mathcal{O}}(\sqrt{dT})
N
\sqrt{d}
N
N
N\ll e^{d}
i\in[N]
t\in[T]
\ell
L=\mathcal{O}(\log_{2}T)
\alpha=\frac{5}{\kappa}\sqrt{2\log\left(TN\log_{2}T\right)}
1-\frac{3}{TN\log_{2}T}
|x_{ti}^{\top}(\hat{\theta}_{t}-\theta^{*})|\leq\alpha\|x_{ti}\|_{V^{-1}_{\Psi%
_{\ell}}}
t\in\Psi_{\ell}
\lambda_{\min}(V_{t})=\Omega\left(\frac{d^{2}+\log\left(TN\log_{2}T\right)}{%
\kappa^{4}}\right).
T\geq\tilde{T}
\tilde{T}=\Omega\left(\max\left\{\frac{\log^{2}\left(TN\log_{2}T\right)}{d},d^%
{3}\right\}\right)
\mathcal{O}(\sqrt{dT})
\alpha
T_{0}=\frac{C_{0}}{\kappa^{4}}\max\left\{\frac{\sqrt{dT}}{\sigma_{0}},\frac{d+%
2\log(TN\log_{2}T)}{\sigma_{0}^{2}}\right\}
\alpha=\frac{5}{\kappa}\sqrt{2\log(TN\log_{2}T)}
T\geq\tilde{T}
\tilde{T}
\mathcal{E}_{t}:=\left\{|x^{\top}_{ti}\hat{\theta}^{(\ell)}_{t-1}-x^{\top}_{ti%
}\theta^{*}|\leq w^{(\ell)}_{ti},\enskip\forall i\in[N],\forall\ell\in[L]\right\}
\mathcal{E}_{t}
1-\mathcal{O}(T^{-2})
t\geq T_{0}
\mathcal{E}_{t}
t
S_{t}
\ell_{t}
S_{t}^{*}\in A_{\ell}
\ell\leq\ell_{t}
\displaystyle R_{t}(S_{t}^{*},\theta^{*})-R_{t}(S_{t},\theta^{*})\leq\begin{%
dcases}\frac{2}{\sqrt{T}},&\text{if }S_{t}\text{ chosen in step }(b)\\
\frac{8}{2^{\ell_{t}}},&\text{if }S_{t}\text{ chosen in step }(c)\\
\end{dcases}
\displaystyle R_{t}(S_{t}^{*},\theta^{*})-R_{t}(S_{t},\theta^{*})\leq\begin{%
dcases}\frac{2}{\sqrt{T}},&\text{if }S_{t}\text{ chosen in step }(b)\\
\frac{8}{2^{\ell_{t}}},&\text{if }S_{t}\text{ chosen in step }(c)\\
\end{dcases}
V_{\ell,t}=\sum_{t\in\Psi_{\ell}}\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}
\displaystyle\sum_{t\in\Psi_{\ell}}\max_{i\in S_{t}}w_{ti}^{(\ell)}=\sum_{t\in%
\Psi_{\ell}}\max_{i\in S_{t}}\alpha\|x_{ti}\|_{V^{-1}_{\ell,t}}
\displaystyle\sum_{t\in\Psi_{\ell}}\max_{i\in S_{t}}w_{ti}^{(\ell)}
\displaystyle=\sum_{t\in\Psi_{\ell}}\max_{i\in S_{t}}\alpha\|x_{ti}\|_{V^{-1}_%
{\ell,t}}
\displaystyle\leq\alpha\sqrt{2|\Psi_{\ell}|d\log(T/d)}.
\displaystyle\leq\alpha\sqrt{2|\Psi_{\ell}|d\log(T/d)}.
\displaystyle 2^{-\ell}|\Psi_{\ell}|\leq 2\sum_{t\in\Psi_{\ell}}\max_{i\in S_{%
t}}w_{ti}^{(\ell)}
\displaystyle 2^{-\ell}|\Psi_{\ell}|\leq 2\sum_{t\in\Psi_{\ell}}\max_{i\in S_{%
t}}w_{ti}^{(\ell)}
\ell\in\{1,...,L\}
\displaystyle|\Psi_{\ell}|\leq 2^{\ell+1}\alpha\sqrt{2|\Psi_{\ell}|d\log(T/d)}.
\displaystyle|\Psi_{\ell}|\leq 2^{\ell+1}\alpha\sqrt{2|\Psi_{\ell}|d\log(T/d)}.
\Psi_{\ell}
\cup^{L}_{\ell=0}\Psi_{\ell}=\{t+1,...,T\}
\mathcal{E}_{t}
\mathcal{E}^{c}_{t}
T_{0}
V_{T_{0}}
\displaystyle\mathcal{R}_{T}\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}%
\left(R(S^{*},\theta^{*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E%
}_{t}\right)\right]+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(R(S^{*},\theta^{%
*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E}^{c}_{t}\right)\right]
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(R(S^{*},%
\theta^{*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E}_{t}\right)%
\right]+\mathbb{E}\left[\sum_{t=T_{0}+1}^{T}\left(R(S^{*},\theta^{*})-R(S_{t},%
\theta^{*})\right)\mathbb{1}\left(\mathcal{E}^{c}_{t}\right)\right]
\Psi_{\ell}
\displaystyle\mathcal{R}_{T}\leq T_{0}+\mathbb{E}\left[\sum_{t\in\Psi_{0}}%
\left(R(S^{*},\theta^{*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E%
}_{t}\right)\right]+\mathbb{E}\left[\sum^{L}_{\ell=1}\sum_{t\in\Psi_{\ell}}%
\left(R(S^{*},\theta^{*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E%
}_{t}\right)\right]+\mathcal{O}(1)
\displaystyle\mathcal{R}_{T}
\displaystyle\leq T_{0}+\mathbb{E}\left[\sum_{t\in\Psi_{0}}\left(R(S^{*},%
\theta^{*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E}_{t}\right)%
\right]+\mathbb{E}\left[\sum^{L}_{\ell=1}\sum_{t\in\Psi_{\ell}}\left(R(S^{*},%
\theta^{*})-R(S_{t},\theta^{*})\right)\mathbb{1}\left(\mathcal{E}_{t}\right)%
\right]+\mathcal{O}(1)
\displaystyle\leq T_{0}+\frac{2}{\sqrt{T}}|\Psi_{0}|+\sum^{L}_{\ell=1}\frac{8}%
{2^{\ell}}|\Psi_{\ell}|+\mathcal{O}(1)
\displaystyle\leq T_{0}+\frac{2}{\sqrt{T}}|\Psi_{0}|+\sum^{L}_{\ell=1}\frac{8}%
{2^{\ell}}|\Psi_{\ell}|+\mathcal{O}(1)
\displaystyle\leq T_{0}+2\sqrt{T}+\sum^{L}_{\ell=1}16\alpha\sqrt{2|\Psi_{\ell}%
|d\log(T/d)}+\mathcal{O}(1)
\displaystyle\leq T_{0}+2\sqrt{T}+\sum^{L}_{\ell=1}16\alpha\sqrt{2|\Psi_{\ell}%
|d\log(T/d)}+\mathcal{O}(1)
\displaystyle\leq T_{0}+2\sqrt{T}+16\alpha\sqrt{2dLT\log(T/d)}+\mathcal{O}(1)
\displaystyle\leq T_{0}+2\sqrt{T}+16\alpha\sqrt{2dLT\log(T/d)}+\mathcal{O}(1)
\alpha=\frac{5}{\kappa}\sqrt{2\log(TN\log_{2}T)}
T_{0}=\frac{C_{0}}{\kappa^{4}}\max\left\{\frac{\sqrt{dT}}{\sigma_{0}},\frac{d+%
2\log(TN\log_{2}T)}{\sigma_{0}^{2}}\right\}
L=\lfloor\frac{1}{2}\log_{2}T\rfloor\leq\frac{1}{2}\log_{2}T
t
\Psi_{\ell},\ell\geq 1
\{t\in\Psi_{\ell}\}
t^{\prime}\in\cup_{\ell^{\prime}<\ell}\Psi_{\ell^{\prime}}
\bar{w}^{(\ell)}_{ti}
\bar{w}^{(\ell)}_{ti}
\{x_{u,i}\}_{i\in S_{u}},u\in\Psi_{\ell}
\{x_{ti}\}_{i\in S_{t}}
T_{0}=\frac{C_{0}}{\kappa^{4}}\max\left\{\frac{\sqrt{dT}}{\sigma_{0}},\frac{d+%
2\log(TN\log_{2}T)}{\sigma_{0}^{2}}\right\}
T\geq\tilde{T}
\displaystyle\lambda_{\min}(V_{T_{0}})\geq C\sqrt{dT}=\Omega\left(\max\left\{%
\log\left(TN\log_{2}T\right),d^{2}\right\}\right),
\displaystyle\lambda_{\min}(V_{T_{0}})\geq C\sqrt{dT}=\Omega\left(\max\left\{%
\log\left(TN\log_{2}T\right),d^{2}\right\}\right),
1-\frac{1}{(TN\log_{2}T)^{2}}
V_{t}
t\geq T_{0}
\lambda_{\min}(V_{t})\geq\lambda_{\min}(V_{T_{0}})
|x_{ti}^{\top}(\hat{\theta}_{t}-\theta^{*})|\leq\alpha\|x_{ti}\|_{V^{-1}_{t}}
1-\frac{3}{(TN\log_{2}T)^{2}}
x_{ti}
i
\displaystyle\left|R_{t}(S,\theta^{*})-R_{t}(S,\hat{\theta}^{(\ell)})\right|%
\leq\left|\tilde{R}_{t}(S,\hat{\theta}^{(\ell)})-R_{t}(S,\hat{\theta}^{(\ell)}%
)\right|\leq 2\max_{i\in S}w^{(\ell)}_{ti}\leq\mathcal{W}^{(\ell)}_{t}.
\displaystyle\left|R_{t}(S,\theta^{*})-R_{t}(S,\hat{\theta}^{(\ell)})\right|%
\leq\left|\tilde{R}_{t}(S,\hat{\theta}^{(\ell)})-R_{t}(S,\hat{\theta}^{(\ell)}%
)\right|\leq 2\max_{i\in S}w^{(\ell)}_{ti}\leq\mathcal{W}^{(\ell)}_{t}.
S_{t}^{*}\in A_{\ell}
\ell
\ell=1
S^{*}_{t}\in A_{\ell}
S^{*}_{t}\in A_{\ell+1}
\ell+1
\displaystyle\left|R_{t}(S,\theta^{*})-R_{t}(S,\hat{\theta}^{(\ell)})\right|%
\leq\mathcal{W}^{(\ell)}_{t}\leq 2^{-\ell}
\displaystyle\left|R_{t}(S,\theta^{*})-R_{t}(S,\hat{\theta}^{(\ell)})\right|%
\leq\mathcal{W}^{(\ell)}_{t}\leq 2^{-\ell}
S\in A_{\ell}
S=S^{*}_{t}
S^{*}_{t}\in A_{\ell}
S_{t}^{*}
\displaystyle R_{t}(S^{*}_{t},\hat{\theta}^{(\ell)})\geq R_{t}(S^{*}_{t},%
\theta^{*})-2^{-\ell}\geq R_{t}(S,\theta^{*})-2^{-\ell}\geq R_{t}(S,\hat{%
\theta}^{(\ell)})-2\cdot 2^{-\ell}
\displaystyle R_{t}(S^{*}_{t},\hat{\theta}^{(\ell)})
\displaystyle\geq R_{t}(S^{*}_{t},\theta^{*})-2^{-\ell}\geq R_{t}(S,\theta^{*}%
)-2^{-\ell}\geq R_{t}(S,\hat{\theta}^{(\ell)})-2\cdot 2^{-\ell}
S\in A_{\ell}
\displaystyle R_{t}(S^{*}_{t},\hat{\theta}^{(\ell)})\geq\max_{S\in A_{\ell}}R_%
{t}(S,\hat{\theta}^{(\ell)})-2\cdot 2^{-\ell}=\mathcal{M}_{t}^{(\ell)}-2\cdot 2%
^{-\ell}.
\displaystyle R_{t}(S^{*}_{t},\hat{\theta}^{(\ell)})\geq\max_{S\in A_{\ell}}R_%
{t}(S,\hat{\theta}^{(\ell)})-2\cdot 2^{-\ell}=\mathcal{M}_{t}^{(\ell)}-2\cdot 2%
^{-\ell}.
S^{*}_{t}\in A_{\ell+1}
S_{t}
R_{t}(S_{t},\hat{\theta}^{(\ell_{t})})\geq R_{t}(S^{*}_{t},\hat{\theta}^{(\ell%
_{t})})
\displaystyle R_{t}(S_{t},\theta^{*})\geq R_{t}(S_{t},\hat{\theta}^{(\ell_{t})%
})-\frac{1}{\sqrt{T}}\geq R_{t}(S^{*}_{t},\hat{\theta}^{(\ell_{t})})-\frac{1}{%
\sqrt{T}}\geq R_{t}(S^{*}_{t},\theta^{*})-\frac{2}{\sqrt{T}}.
\displaystyle R_{t}(S_{t},\theta^{*})
\displaystyle\geq R_{t}(S_{t},\hat{\theta}^{(\ell_{t})})-\frac{1}{\sqrt{T}}%
\geq R_{t}(S^{*}_{t},\hat{\theta}^{(\ell_{t})})-\frac{1}{\sqrt{T}}\geq R_{t}(S%
^{*}_{t},\theta^{*})-\frac{2}{\sqrt{T}}.
S_{t}
\ell_{t}
\ell_{t}=1
R_{t}(S,\theta^{*})\in[0,1]
S
t
\ell_{t}>1
S_{t}
\ell_{t}-1
S^{*}_{t}\in A_{\ell_{t}}
S^{*}_{t}
\ell_{t}-1
\ell_{t}-1
\displaystyle\left|R_{t}(S,\hat{\theta}^{(\ell_{t}-1)})-R_{t}(S,\theta^{*})%
\right|\leq\mathcal{W}^{(\ell_{t}-1)}_{t}\leq 2^{-(\ell_{t}-1)}
\displaystyle\left|R_{t}(S,\hat{\theta}^{(\ell_{t}-1)})-R_{t}(S,\theta^{*})%
\right|\leq\mathcal{W}^{(\ell_{t}-1)}_{t}\leq 2^{-(\ell_{t}-1)}
S=S_{t}
S=S^{*}_{t}
\ell_{t}-1
\displaystyle R_{t}(S^{*}_{t},\hat{\theta}^{(\ell_{t}-1)})-R_{t}(S_{t},\hat{%
\theta}^{(\ell_{t}-1)})\leq 2\cdot 2^{-(\ell_{t}-1)}
\displaystyle R_{t}(S^{*}_{t},\hat{\theta}^{(\ell_{t}-1)})-R_{t}(S_{t},\hat{%
\theta}^{(\ell_{t}-1)})\leq 2\cdot 2^{-(\ell_{t}-1)}
\displaystyle R_{t}(S_{t},\theta^{*})\geq R_{t}(S_{t},\hat{\theta}^{(\ell_{t}-%
1)})-2^{-(\ell_{t}-1)}
\displaystyle R_{t}(S_{t},\theta^{*})
\displaystyle\geq R_{t}(S_{t},\hat{\theta}^{(\ell_{t}-1)})-2^{-(\ell_{t}-1)}
\displaystyle\geq R_{t}(S^{*}_{t},\hat{\theta}^{(\ell_{t}-1)})-3\cdot 2^{-(%
\ell_{t}-1)}
\displaystyle\geq R_{t}(S^{*}_{t},\hat{\theta}^{(\ell_{t}-1)})-3\cdot 2^{-(%
\ell_{t}-1)}
\displaystyle\geq R_{t}(S^{*}_{t},\theta^{*})-4\cdot 2^{-(\ell_{t}-1)}.
\displaystyle\geq R_{t}(S^{*}_{t},\theta^{*})-4\cdot 2^{-(\ell_{t}-1)}.
r_{i}\equiv r
i
K\leq\frac{18}{\kappa^{4}}
\alpha_{k}=\frac{5}{\kappa}\sqrt{\log(\tau_{k}^{2}N/4)}
q_{k}=\frac{288}{K\sigma_{0}\kappa^{4}}(4d^{2}+\log(\tau_{k}^{2}N/4))
T
\displaystyle\Rcal_{T}=\Ocal\big{(}\sqrt{dT\log\left(T/d\right)\log(TN)\log_{2%
}T}\big{)}\,.
\displaystyle\Rcal_{T}=\Ocal\big{(}\sqrt{dT\log\left(T/d\right)\log(TN)\log_{2%
}T}\big{)}\,.
K\leq\frac{18}{\kappa^{4}}
\displaystyle q_{k}=\frac{C}{K}\max\left\{\frac{d^{2}+\log(\tau_{k}^{2}N/4)}{%
\sigma_{0}\kappa^{4}},\frac{d+2\log(\tau_{k}/2)}{\sigma_{0}^{2}}\right\}
\displaystyle q_{k}=\frac{C}{K}\max\left\{\frac{d^{2}+\log(\tau_{k}^{2}N/4)}{%
\sigma_{0}\kappa^{4}},\frac{d+2\log(\tau_{k}/2)}{\sigma_{0}^{2}}\right\}
C
\lambda_{\min}(V_{\tau_{k}})
K\leq\frac{18}{\kappa^{4}}
q_{k}
q_{k}
K
K\leq\frac{18}{\kappa^{4}}
\kappa\in(0,1)
T
T
T
L
L=\lfloor\log_{2}T\rfloor+1
\text{Regret}(k)
k
\displaystyle\mathcal{R}_{T}\leq\sum_{k=1}^{L}\text{Regret}(k)\,.
\displaystyle\mathcal{R}_{T}\leq\sum_{k=1}^{L}\text{Regret}(k)\,.
\Tcal_{k}:=\{\tau_{k-1}+1,...,\tau_{k}\}
k
k
|\Tcal_{k}|=\tau_{k}/2
k
|\Tcal_{k}|\leq q_{k}
\lambda_{\min}(V_{t})
T
|\Tcal_{k}|>q_{k}
\lambda_{\min}(V_{t})
\lambda_{\min}(V_{t})
t
\lambda_{\min}(V_{t})
\lambda_{\min}(V_{t})
q_{k}\leq 2C_{0}(4d^{2}+\log(T^{2}N))
k
C_{0}=\frac{144}{K\sigma_{0}\kappa^{4}}
|\Tcal_{k}|
2C_{0}(4d^{2}+\log(T^{2}N))
k^{\prime}
|\Tcal_{k^{\prime}}|\geq 2C_{0}(4d^{2}+\log(T^{2}N))
|\Tcal_{k^{\prime}}|\leq 4C_{0}(2d^{2}+\log(T^{2}N))
\displaystyle\sum_{k=1}^{k^{\prime}-1}\text{Regret}(k)\leq\sum_{k=1}^{k^{%
\prime}-1}|\Tcal_{k}|=|\Tcal_{k^{\prime}}|\leq 4C_{0}\left(4d^{2}+\log(T^{2}N)%
\right)\,.
\displaystyle\sum_{k=1}^{k^{\prime}-1}\text{Regret}(k)\leq\sum_{k=1}^{k^{%
\prime}-1}|\Tcal_{k}|=|\Tcal_{k^{\prime}}|\leq 4C_{0}\left(4d^{2}+\log(T^{2}N)%
\right)\,.
\lambda_{\min}(V_{t})
q_{k}
\lambda_{\min}(V_{t})
\lambda_{\min}(V_{t})\geq C_{0}(4d^{2}+\log(\tau_{k}^{2}N/4))
K\leq\frac{18}{\kappa^{4}}
q_{k}=2C_{0}(4d^{2}+\log(\tau_{k}^{2}N/4))
k
1-\frac{4}{\tau_{k}^{2}N}
\displaystyle\lambda_{\min}(V_{\tau_{k}})\geq C_{0}(4d^{2}+\log(\tau_{k}^{2}N/%
4))
\displaystyle\lambda_{\min}(V_{\tau_{k}})\geq C_{0}(4d^{2}+\log(\tau_{k}^{2}N/%
4))
C_{0}=\frac{144}{K\sigma_{0}\kappa^{4}}
k
k-1
\lambda_{\min}(V_{\tau_{k-1}})
k-1
\lambda_{\min}(V_{\tau_{k-1}})
1-\frac{3}{|\Tcal_{k}|^{2}N}
\displaystyle|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\alpha_{k}\|x_{ti%
}\|_{W^{-1}_{k-1}}
\displaystyle|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\alpha_{k}\|x_{ti%
}\|_{W^{-1}_{k-1}}
\alpha_{k}=\frac{5}{\kappa}\sqrt{\log(\tau_{k}^{2}N/4)}
W_{k-1}=V_{\tau_{k-1}}=\sum_{t^{\prime}=\tau_{k-1}+1}^{\tau_{k-1}}\sum_{i\in S%
_{t^{\prime}}}x_{t^{\prime}i}x_{t^{\prime}i}^{\top}
k-1
1-\frac{3}{|\Tcal_{k}|}
\displaystyle|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\alpha_{k}\|x_{ti%
}\|_{W^{-1}_{k-1}},\enskip\forall i\in[N],\forall t\in\Tcal_{k}\,.
\displaystyle|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\alpha_{k}\|x_{ti%
}\|_{W^{-1}_{k-1}},\enskip\forall i\in[N],\forall t\in\Tcal_{k}\,.
\tilde{\Ecal}_{k}
k-1
\displaystyle\tilde{\Ecal}_{k,1}:=\left\{\lambda_{\min}(V_{\tau_{k-1}})\geq C_%
{0}\left(4d^{2}+\log\Big{(}\frac{\tau_{k-1}N}{2}\Big{)}\right)\right\}
\displaystyle\tilde{\Ecal}_{k,1}
\displaystyle:=\left\{\lambda_{\min}(V_{\tau_{k-1}})\geq C_{0}\left(4d^{2}+%
\log\Big{(}\frac{\tau_{k-1}N}{2}\Big{)}\right)\right\}
\displaystyle\tilde{\Ecal}_{k,2}:=\left\{|x_{ti}^{\top}(\hat{\theta}_{k}-%
\theta^{*})|\leq\alpha_{k}\|x_{ti}\|_{W^{-1}_{k-1}},\forall i\in[N],\forall t%
\in\Tcal_{k}\right\}
\displaystyle\tilde{\Ecal}_{k,2}
\displaystyle:=\left\{|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})|\leq\alpha_{%
k}\|x_{ti}\|_{W^{-1}_{k-1}},\forall i\in[N],\forall t\in\Tcal_{k}\right\}
\displaystyle\tilde{\Ecal}_{k}:=\tilde{\Ecal}_{k,1}\cap\tilde{\Ecal}_{k,2}\,.
\displaystyle\tilde{\Ecal}_{k}
\displaystyle:=\tilde{\Ecal}_{k,1}\cap\tilde{\Ecal}_{k,2}\,.
\tilde{\Ecal}_{k}
\tilde{z}_{ti}
\displaystyle 0\leq\tilde{z}_{ti}-x_{ti}^{\top}\theta^{*}\leq 2\alpha_{k}\|x_{%
ti}\|_{W^{-1}_{k-1}}\,.
\displaystyle 0\leq\tilde{z}_{ti}-x_{ti}^{\top}\theta^{*}\leq 2\alpha_{k}\|x_{%
ti}\|_{W^{-1}_{k-1}}\,.
\tilde{R}_{t}(S)
\{\tilde{z}_{ti}\}
\tilde{R}_{t}(S)
\tilde{R}_{t}(S)
d
\tilde{R}_{t}(S)
\tilde{\alpha}_{k}
d
S_{t}=\argmax_{S\in\Scal}\tilde{R}_{t}(S)
\tilde{R}_{t}(S_{t})\geq R(S_{t}^{*},\theta^{*})
k
\displaystyle\text{Regret}(k)=\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*}%
)-R(S_{t},\theta^{*})\right)\mathbb{1}(\tilde{\Ecal}_{k})
\displaystyle\text{Regret}(k)
\displaystyle=\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta%
^{*})\right)\mathbb{1}(\tilde{\Ecal}_{k})
\displaystyle\leq\sum_{t\in\Tcal_{k}}\left(\tilde{R}(S_{t})-R(S_{t},\theta^{*}%
)\right)\mathbb{1}(\tilde{\Ecal}_{k})
\displaystyle\leq\sum_{t\in\Tcal_{k}}\left(\tilde{R}(S_{t})-R(S_{t},\theta^{*}%
)\right)\mathbb{1}(\tilde{\Ecal}_{k})
\displaystyle\sum_{t\in\Tcal_{k}}\left(\tilde{R}(S_{t})-R(S_{t},\theta^{*})%
\right)\mathbb{1}(\tilde{\Ecal}_{k})\leq\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}%
\left|x_{ti}^{\top}(\hat{\theta}_{k}-\theta^{*})+\alpha_{k}\|x_{ti}\|_{W^{-1}_%
{k-1}}\right|
\displaystyle\sum_{t\in\Tcal_{k}}\left(\tilde{R}(S_{t})-R(S_{t},\theta^{*})%
\right)\mathbb{1}(\tilde{\Ecal}_{k})
\displaystyle\leq\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\left|x_{ti}^{\top}(\hat%
{\theta}_{k}-\theta^{*})+\alpha_{k}\|x_{ti}\|_{W^{-1}_{k-1}}\right|
\displaystyle\leq 2\alpha_{k}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{%
W^{-1}_{k-1}}
\displaystyle\leq 2\alpha_{k}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{%
W^{-1}_{k-1}}
t\in\Tcal_{k}
\displaystyle\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{W^{-1}_{k-1}}%
\leq C_{1}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t-1}}
\displaystyle\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{W^{-1}_{k-1}}%
\leq C_{1}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t-1}}
1-de^{-C_{2}(t-\tau_{k-1})}
\tilde{\Ecal}_{k,3}:=\left\{\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{W%
^{-1}_{k-1}}\leq C_{1}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_%
{t-1}},\forall t\in\Tcal_{k}\right\}
k
\displaystyle\sum_{t\in\Tcal_{k}}\left(\tilde{R}(S_{t})-R(S_{t},\theta^{*})%
\right)\mathbb{1}(\tilde{\Ecal}_{k}\cap\tilde{\Ecal}_{k,3})\leq 2C_{1}\alpha_{%
k}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti}\|_{V^{-1}_{t-1}}
\displaystyle\sum_{t\in\Tcal_{k}}\left(\tilde{R}(S_{t})-R(S_{t},\theta^{*})%
\right)\mathbb{1}(\tilde{\Ecal}_{k}\cap\tilde{\Ecal}_{k,3})
\displaystyle\leq 2C_{1}\alpha_{k}\sum_{t\in\Tcal_{k}}\sum_{i\in S_{t}}\|x_{ti%
}\|_{V^{-1}_{t-1}}
\displaystyle\leq 2C_{1}\alpha_{k}\sqrt{\frac{\tau_{k}}{2}\sum_{t\in\Tcal_{k}}%
\sum_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t-1}}}
\displaystyle\leq 2C_{1}\alpha_{k}\sqrt{\frac{\tau_{k}}{2}\sum_{t\in\Tcal_{k}}%
\sum_{i\in S_{t}}\|x_{ti}\|^{2}_{V^{-1}_{t-1}}}
\displaystyle\leq 2C_{1}\alpha_{k}\sqrt{\tau_{k}d\log\left(\frac{\tau_{k}}{2d}%
\right)}
\displaystyle\leq 2C_{1}\alpha_{k}\sqrt{\tau_{k}d\log\left(\frac{\tau_{k}}{2d}%
\right)}
\tilde{\Ecal}_{k}
\tilde{\Ecal}_{k,3}
k
\displaystyle\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta^%
{*})\right)\mathbb{1}(\tilde{\Ecal}_{k}\cap\tilde{\Ecal}_{k,3})=\Ocal\left(%
\sqrt{d\tau_{k}\log\left(\tau_{k}/d\right)\log(\tau_{k}N)}\right)
\displaystyle\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta^%
{*})\right)\mathbb{1}(\tilde{\Ecal}_{k}\cap\tilde{\Ecal}_{k,3})=\Ocal\left(%
\sqrt{d\tau_{k}\log\left(\tau_{k}/d\right)\log(\tau_{k}N)}\right)
\tilde{\Ecal}_{k}
\tilde{\Ecal}_{k,3}
\displaystyle\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta^%
{*})\right)\mathbb{1}(\tilde{\Ecal}_{k}^{c})=\Ocal(1)
\displaystyle\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta^%
{*})\right)\mathbb{1}(\tilde{\Ecal}_{k}^{c})
\displaystyle=\Ocal(1)
\displaystyle\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta^%
{*})\right)\mathbb{1}(\tilde{\Ecal}_{k,3}^{c})=\Ocal(d)\,.
\displaystyle\sum_{t\in\Tcal_{k}}\left(R(S_{t}^{*},\theta^{*})-R(S_{t},\theta^%
{*})\right)\mathbb{1}(\tilde{\Ecal}_{k,3}^{c})
\displaystyle=\Ocal(d)\,.
\displaystyle\Rcal_{T}=\Ocal\left(\sqrt{dT\log\left(T/d\right)\log(TN)\log_{2}%
T}\right)
\displaystyle\Rcal_{T}=\Ocal\left(\sqrt{dT\log\left(T/d\right)\log(TN)\log_{2}%
T}\right)
q_{k}
\lambda_{\min}(V_{\tau_{k}})
\tilde{\Tcal}_{k}
k
q_{k}
\tilde{\Tcal}_{k}=\{\tau_{k}-q_{k}+1,\tau_{k}\}
S_{t}
\displaystyle\lambda_{\min}\left(\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}%
\EE[x_{ti}x_{ti}^{\top}]\right)\geq\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t%
}}\lambda_{\min}\left(\EE[x_{ti}x_{ti}^{\top}]\right)
\displaystyle\lambda_{\min}\left(\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}%
\EE[x_{ti}x_{ti}^{\top}]\right)
\displaystyle\geq\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}\lambda_{\min}%
\left(\EE[x_{ti}x_{ti}^{\top}]\right)
\displaystyle=Kq_{k}\sigma_{0}
\displaystyle=Kq_{k}\sigma_{0}
\displaystyle=\frac{288}{\kappa^{4}}(4d^{2}+\log(\tau_{k}^{2}N/4))
\displaystyle=\frac{288}{\kappa^{4}}(4d^{2}+\log(\tau_{k}^{2}N/4))
\lambda_{\min}(\cdot)
\|x_{ti}\|\leq 1
\displaystyle\lambda_{\max}\left(\sum_{i\in S_{t}}\EE[x_{ti}x_{ti}^{\top}]%
\right)\leq K
\displaystyle\lambda_{\max}\left(\sum_{i\in S_{t}}\EE[x_{ti}x_{ti}^{\top}]%
\right)\leq K
t
\displaystyle\PP\left\{\lambda_{\min}\Big{(}\sum_{t\in\tilde{\Tcal}_{k}}\sum_{%
i\in S_{t}}x_{ti}x_{ti}^{\top}\Big{)}\leq\frac{144}{\kappa^{4}}(4d^{2}+\log(%
\tau_{k}^{2}N/4))\right\}
\displaystyle\PP\left\{\lambda_{\min}\Big{(}\sum_{t\in\tilde{\Tcal}_{k}}\sum_{%
i\in S_{t}}x_{ti}x_{ti}^{\top}\Big{)}\leq\frac{144}{\kappa^{4}}(4d^{2}+\log(%
\tau_{k}^{2}N/4))\right\}
\displaystyle\leq\PP\left\{\lambda_{\min}\Big{(}\sum_{t\in\tilde{\Tcal}_{k}}%
\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\Big{)}\leq\frac{1}{2}\cdot\lambda_{\min}%
\Big{(}\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}\EE[x_{ti}x_{ti}^{\top}]%
\Big{)}\right\}
\displaystyle\leq\PP\left\{\lambda_{\min}\Big{(}\sum_{t\in\tilde{\Tcal}_{k}}%
\sum_{i\in S_{t}}x_{ti}x_{ti}^{\top}\Big{)}\leq\frac{1}{2}\cdot\lambda_{\min}%
\Big{(}\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}\EE[x_{ti}x_{ti}^{\top}]%
\Big{)}\right\}
\displaystyle\leq d\cdot\exp\left\{-\frac{1}{4}\cdot\lambda_{\min}\Big{(}\sum_%
{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}\EE[x_{ti}x_{ti}^{\top}]\Big{)}/(2K)\right\}
\displaystyle\leq d\cdot\exp\left\{-\frac{1}{4}\cdot\lambda_{\min}\Big{(}\sum_%
{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}\EE[x_{ti}x_{ti}^{\top}]\Big{)}/(2K)\right\}
\displaystyle\leq d\cdot\exp\left\{-\frac{18(4d^{2}+\log(\tau_{k}^{2}N/4))}{K%
\kappa^{4}}\right\}
\displaystyle\leq d\cdot\exp\left\{-\frac{18(4d^{2}+\log(\tau_{k}^{2}N/4))}{K%
\kappa^{4}}\right\}
\displaystyle=\exp\left\{\log d-\frac{72d^{2}}{K\kappa^{4}}-\frac{18\log(\tau_%
{k}^{2}N/4)}{K\kappa^{4}}\right\}
\displaystyle=\exp\left\{\log d-\frac{72d^{2}}{K\kappa^{4}}-\frac{18\log(\tau_%
{k}^{2}N/4)}{K\kappa^{4}}\right\}
\displaystyle\leq\exp\left\{-\frac{18\log(\tau_{k}^{2}N/4)}{K\kappa^{4}}\right\}
\displaystyle\leq\exp\left\{-\frac{18\log(\tau_{k}^{2}N/4)}{K\kappa^{4}}\right\}
\displaystyle\leq\left(\frac{4}{\tau^{2}_{k}N}\right)^{18/(K\kappa^{4})}
\displaystyle\leq\left(\frac{4}{\tau^{2}_{k}N}\right)^{18/(K\kappa^{4})}
\displaystyle\leq\frac{4}{\tau^{2}_{k}N}\,.
\displaystyle\leq\frac{4}{\tau^{2}_{k}N}\,.
\lambda(V_{\tau_{k}})\succcurlyeq\sum_{t\in\tilde{\Tcal}_{k}}\sum_{i\in S_{t}}%
x_{ti}x_{ti}^{\top}
W_{k-1}
k-1
V_{\tau_{t-1}}
k
V_{t}
V_{t}
k
W_{k-1}
CW_{k-1}\succcurlyeq V_{t}
t\in\{\tau_{k-1}+1,\tau_{k}\}
C
\lambda_{\min}(V_{t})
t
k-1
\Xcal
\lambda_{\min}(V_{t})
t
\tilde{\theta}_{k,t}
t
\max_{S\in\Scal}\tilde{R}_{t}(S)
\tilde{\theta}_{k,t}
\hat{\theta}_{k}
\hat{\theta}_{k}
y_{t}
(i_{1},...,i_{N})
\{1,,,N\}
N
K
\displaystyle\EE\left[X_{ti}X_{ti}^{\top}\right]=\frac{1}{N}\EE\left[X_{t1}X_{%
t1}^{\top}+...+X_{tN}X_{tN}^{\top}\right]
\displaystyle\EE\left[X_{ti}X_{ti}^{\top}\right]
\displaystyle=\frac{1}{N}\EE\left[X_{t1}X_{t1}^{\top}+...+X_{tN}X_{tN}^{\top}\right]
\displaystyle=\frac{1}{N}\sum_{(i_{1},...,i_{N})}\EE\left[(X_{t,i_{1}}X_{t,i_{%
1}}^{\top}+...+X_{t,i_{N}}X_{t,i_{N}}^{\top})\mathbb{1}\{X_{t,i_{1}}^{\top}%
\tilde{\theta}_{k,t}<\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\displaystyle=\frac{1}{N}\sum_{(i_{1},...,i_{N})}\EE\left[(X_{t,i_{1}}X_{t,i_{%
1}}^{\top}+...+X_{t,i_{N}}X_{t,i_{N}}^{\top})\mathbb{1}\{X_{t,i_{1}}^{\top}%
\tilde{\theta}_{k,t}<\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\displaystyle\preccurlyeq\frac{1}{N}\sum_{(i_{1},...,i_{N})}\frac{N}{K}C_{X}%
\EE\left[(\Vb_{t,\min}(\Ical)+\Vb_{t,\max}(\Ical))\mathbb{1}\{X_{t,i_{1}}^{%
\top}\tilde{\theta}_{k,t}<\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\displaystyle\preccurlyeq\frac{1}{N}\sum_{(i_{1},...,i_{N})}\frac{N}{K}C_{X}%
\EE\left[(\Vb_{t,\min}(\Ical)+\Vb_{t,\max}(\Ical))\mathbb{1}\{X_{t,i_{1}}^{%
\top}\tilde{\theta}_{k,t}<\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\Vb_{t,\min}(\Ical)
\Vb_{t,\max}(\Ical)
K
\Ical=(i_{1},...,i_{N})
\displaystyle\Vb_{t,\min}(\Ical)=\Vb_{t,\min}(i_{1},...,i_{N}):=X_{t,i_{1}}X_{%
t,i_{1}}^{\top}+...+X_{t,i_{K}}X_{t,i_{K}}^{\top}
\displaystyle\Vb_{t,\min}(\Ical)
\displaystyle=\Vb_{t,\min}(i_{1},...,i_{N}):=X_{t,i_{1}}X_{t,i_{1}}^{\top}+...%
+X_{t,i_{K}}X_{t,i_{K}}^{\top}
\displaystyle\Vb_{t,\max}(\Ical)=\Vb_{t,\max}(i_{1},...,i_{N}):=X_{t,i_{N-K+1}%
}X_{t,i_{N-K+1}}^{\top}+...+X_{t,i_{N}}X_{t,i_{N}}^{\top}
\displaystyle\Vb_{t,\max}(\Ical)
\displaystyle=\Vb_{t,\max}(i_{1},...,i_{N}):=X_{t,i_{N-K+1}}X_{t,i_{N-K+1}}^{%
\top}+...+X_{t,i_{N}}X_{t,i_{N}}^{\top}
C_{X}(\Vb_{\min}(\Ical)+\Vb_{\max}(\Ical))
K
\{X_{t,i_{1}}X_{t,i_{1}}^{\top},...,X_{t,i_{N}}X_{t,i_{N}}^{\top}\}
k^{\prime}=1
k^{\prime}=K
\displaystyle\EE\left[X_{ti}X_{ti}^{\top}\right]\preccurlyeq\frac{C_{X}}{K}%
\sum_{(i_{1},...,i_{N})}\EE\left[(\Vb_{t,\min}(\Ical)+\Vb_{t,\max}(\Ical))%
\mathbb{1}\{X_{t,i_{1}}^{\top}\tilde{\theta}_{k,t}<\cdots<X_{t,i_{N}}^{\top}%
\tilde{\theta}_{k,t}\}\right]
\displaystyle\EE\left[X_{ti}X_{ti}^{\top}\right]
\displaystyle\preccurlyeq\frac{C_{X}}{K}\sum_{(i_{1},...,i_{N})}\EE\left[(\Vb_%
{t,\min}(\Ical)+\Vb_{t,\max}(\Ical))\mathbb{1}\{X_{t,i_{1}}^{\top}\tilde{%
\theta}_{k,t}<\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\displaystyle\preccurlyeq\frac{C_{X}\rho_{0}}{K}\sum_{(i_{1},...,i_{N})}\EE%
\left[\Vb_{t,\max}(\Ical)\mathbb{1}\{X_{t,i_{1}}^{\top}\tilde{\theta}_{k,t}<%
\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\displaystyle\preccurlyeq\frac{C_{X}\rho_{0}}{K}\sum_{(i_{1},...,i_{N})}\EE%
\left[\Vb_{t,\max}(\Ical)\mathbb{1}\{X_{t,i_{1}}^{\top}\tilde{\theta}_{k,t}<%
\cdots<X_{t,i_{N}}^{\top}\tilde{\theta}_{k,t}\}\right]
\displaystyle=\frac{C_{X}\rho_{0}}{K}\EE\left[\sum_{X_{ti}\in\Xcal_{t}}X_{ti}X%
_{ti}^{\top}\mathbb{1}\big{(}X_{ti}\in S_{t}\big{)}\right]
\displaystyle=\frac{C_{X}\rho_{0}}{K}\EE\left[\sum_{X_{ti}\in\Xcal_{t}}X_{ti}X%
_{ti}^{\top}\mathbb{1}\big{(}X_{ti}\in S_{t}\big{)}\right]
S_{t}=\argmax_{S\in\Scal}\tilde{R}_{t}(S)
\displaystyle\EE\left[\sum_{X_{ti}\in\Xcal_{t}}X_{ti}X_{ti}^{\top}\mathbb{1}%
\big{(}X_{ti}\in S_{t}\big{)}\right]\succcurlyeq\frac{K}{C_{X}\rho_{0}}\EE%
\left[X_{ti}X_{ti}^{\top}\right]\,.
\displaystyle\EE\left[\sum_{X_{ti}\in\Xcal_{t}}X_{ti}X_{ti}^{\top}\mathbb{1}%
\big{(}X_{ti}\in S_{t}\big{)}\right]\succcurlyeq\frac{K}{C_{X}\rho_{0}}\EE%
\left[X_{ti}X_{ti}^{\top}\right]\,.
t\in\Tcal_{k}
\displaystyle\Sigma_{k,t}:=\sum_{t^{\prime}=\tau_{k-1}+1}^{t}\EE\left[\sum_{X_%
{t^{\prime}i}\in\Xcal_{t^{\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}%
\mathbb{1}\big{(}X_{t^{\prime}i}\in S_{t^{\prime}}\big{)}\right]\,.
\displaystyle\Sigma_{k,t}:=\sum_{t^{\prime}=\tau_{k-1}+1}^{t}\EE\left[\sum_{X_%
{t^{\prime}i}\in\Xcal_{t^{\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}%
\mathbb{1}\big{(}X_{t^{\prime}i}\in S_{t^{\prime}}\big{)}\right]\,.
\lambda_{\min}(\cdot)
\displaystyle\lambda_{\min}\left(\Sigma_{k,t}\right)=\lambda_{\min}\left(\sum_%
{t^{\prime}=\tau_{k-1}+1}^{t}\EE\left[\sum_{X_{t^{\prime}i}\in\Xcal_{t^{\prime%
}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}\mathbb{1}\big{(}X_{t^{\prime}i}\in S_%
{t^{\prime}}\big{)}\right]\right)
\displaystyle\lambda_{\min}\left(\Sigma_{k,t}\right)
\displaystyle=\lambda_{\min}\left(\sum_{t^{\prime}=\tau_{k-1}+1}^{t}\EE\left[%
\sum_{X_{t^{\prime}i}\in\Xcal_{t^{\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{%
\top}\mathbb{1}\big{(}X_{t^{\prime}i}\in S_{t^{\prime}}\big{)}\right]\right)
\displaystyle\geq\sum_{s=\tau_{k-1}+1}^{t}\lambda_{\min}\left(\EE\left[\sum_{X%
_{t^{\prime}i}\in\Xcal_{t^{\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}%
\mathbb{1}\big{(}X_{t^{\prime}i}\in S_{t^{\prime}}\big{)}\right]\right)
\displaystyle\geq\sum_{s=\tau_{k-1}+1}^{t}\lambda_{\min}\left(\EE\left[\sum_{X%
_{t^{\prime}i}\in\Xcal_{t^{\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}%
\mathbb{1}\big{(}X_{t^{\prime}i}\in S_{t^{\prime}}\big{)}\right]\right)
\displaystyle\geq\frac{K(t-\tau_{k-1})\sigma_{0}}{\rho_{0}C_{\mathcal{X}}}>0\,.
\displaystyle\geq\frac{K(t-\tau_{k-1})\sigma_{0}}{\rho_{0}C_{\mathcal{X}}}>0\,.
\EE\left[\sum_{X_{t^{\prime}i}\in\Xcal_{t^{\prime}}}X_{t^{\prime}i}X_{t^{%
\prime}i}^{\top}\mathbb{1}\big{(}X_{t^{\prime}i}\in S_{t^{\prime}}\big{)}\right]
\|X_{t^{\prime}i}\|\leq 1
\tau
\displaystyle\lambda_{\max}\left(\EE\left[\sum_{X_{t^{\prime}i}\in\Xcal_{t^{%
\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}\mathbb{1}\big{(}X_{t^{\prime}i}%
\in S_{t^{\prime}}\big{)}\right]\right)\leq K\,.
\displaystyle\lambda_{\max}\left(\EE\left[\sum_{X_{t^{\prime}i}\in\Xcal_{t^{%
\prime}}}X_{t^{\prime}i}X_{t^{\prime}i}^{\top}\mathbb{1}\big{(}X_{t^{\prime}i}%
\in S_{t^{\prime}}\big{)}\right]\right)\leq K\,.
V_{t}
t\in\Tcal_{k}
\displaystyle\mathbb{P}\left(\lambda_{\min}(V_{t})\leq\frac{K(t-\tau_{k-1})%
\sigma_{0}}{2\rho_{0}C_{\mathcal{X}}}\right)\leq d\left(\frac{e^{-1/2}}{0.5^{1%
/2}}\right)^{\frac{(t-\tau_{k-1})\sigma_{0}}{\rho_{0}C_{\mathcal{X}}}}
\displaystyle\mathbb{P}\left(\lambda_{\min}(V_{t})\leq\frac{K(t-\tau_{k-1})%
\sigma_{0}}{2\rho_{0}C_{\mathcal{X}}}\right)
\displaystyle\leq d\left(\frac{e^{-1/2}}{0.5^{1/2}}\right)^{\frac{(t-\tau_{k-1%
})\sigma_{0}}{\rho_{0}C_{\mathcal{X}}}}
\displaystyle=d\exp\left\{\frac{(t-\tau_{k-1})\sigma_{0}}{\rho_{0}C_{\mathcal{%
X}}}\log\left(\frac{e^{-1/2}}{0.5^{1/2}}\right)\right\}
\displaystyle=d\exp\left\{\frac{(t-\tau_{k-1})\sigma_{0}}{\rho_{0}C_{\mathcal{%
X}}}\log\left(\frac{e^{-1/2}}{0.5^{1/2}}\right)\right\}
\displaystyle\leq d\exp\left\{-\frac{(t-\tau_{k-1})\sigma_{0}}{10\rho_{0}C_{%
\mathcal{X}}}\right\}
\displaystyle\leq d\exp\left\{-\frac{(t-\tau_{k-1})\sigma_{0}}{10\rho_{0}C_{%
\mathcal{X}}}\right\}
-\frac{1}{2}-\frac{1}{2}\log\frac{1}{2}\leq-\frac{1}{10}
\lambda_{\min}(V_{t})
t
1-d\exp\left\{-(t-\tau_{k-1})\sigma_{0}/(10\rho_{0}C_{\mathcal{X}})\right\}
\lambda_{\min}(V_{t})
C_{\mathcal{X}}
C_{\mathcal{X}}
C_{\mathcal{X}}=\Ocal(1)
p_{\mathcal{X}}
\theta\in\mathbb{R}^{d}
k\in\{k^{\prime},...,N-k^{\prime}+1\}
\displaystyle\mathbb{E}\left[X_{k}X_{k}^{\top}\mathbb{1}\{X_{1}^{\top}\theta<%
\cdots<X_{k}^{\top}\theta<\cdots<X_{N}^{\top}\theta\}\right]
\displaystyle\mathbb{E}\left[X_{k}X_{k}^{\top}\mathbb{1}\{X_{1}^{\top}\theta<%
\cdots<X_{k}^{\top}\theta<\cdots<X_{N}^{\top}\theta\}\right]
\displaystyle\preccurlyeq C_{k}\mathbb{E}\left[(X_{k^{\prime}}X_{k^{\prime}}^{%
\top}+X_{N-k^{\prime}+1}X_{N-k^{\prime}+1}^{\top})\mathbb{1}\{X_{1}^{\top}%
\theta<\cdots<X_{N}^{\top}\theta\}\right]
\displaystyle\preccurlyeq C_{k}\mathbb{E}\left[(X_{k^{\prime}}X_{k^{\prime}}^{%
\top}+X_{N-k^{\prime}+1}X_{N-k^{\prime}+1}^{\top})\mathbb{1}\{X_{1}^{\top}%
\theta<\cdots<X_{N}^{\top}\theta\}\right]
C_{k}=\frac{(k^{\prime}-1)!(N-k^{\prime})!}{(k-1)!(N-k)!}
\displaystyle\mathbb{E}\left[X_{k}X_{k}^{\top}\mathbb{1}\{X_{1}^{\top}\theta<%
\cdots<X_{k}^{\top}\theta<\cdots<X_{N}^{\top}\theta\}\right]
\displaystyle\mathbb{E}\left[X_{k}X_{k}^{\top}\mathbb{1}\{X_{1}^{\top}\theta<%
\cdots<X_{k}^{\top}\theta<\cdots<X_{N}^{\top}\theta\}\right]
\displaystyle=\mathbb{E}_{V}\left[VV^{\top}\mathbb{E}_{X_{1:N}/X_{k}}\left[%
\mathbb{1}\{X_{1}^{\top}\theta<\cdots<X_{k-1}^{\top}\theta<V^{\top}\theta<X_{k%
+1}^{\top}\theta<\cdots<X_{N}^{\top}\theta\}\mid V\right]\right]
\displaystyle=\mathbb{E}_{V}\left[VV^{\top}\mathbb{E}_{X_{1:N}/X_{k}}\left[%
\mathbb{1}\{X_{1}^{\top}\theta<\cdots<X_{k-1}^{\top}\theta<V^{\top}\theta<X_{k%
+1}^{\top}\theta<\cdots<X_{N}^{\top}\theta\}\mid V\right]\right]
X_{1:N}/X_{k}
X_{1},...,X_{k-1},X_{k+1},...,X_{N}
\psi(y):=\mathbb{P}(X^{\top}\theta\leq y)
X^{\top}\theta
\displaystyle\mathbb{P}\left(X_{1}^{\top}\theta<\cdots<X_{k-1}^{\top}\theta<V^%
{\top}\theta<X_{k+1}^{\top}\theta<\cdots<X_{N}^{\top}\theta\right)
\displaystyle\mathbb{P}\left(X_{1}^{\top}\theta<\cdots<X_{k-1}^{\top}\theta<V^%
{\top}\theta<X_{k+1}^{\top}\theta<\cdots<X_{N}^{\top}\theta\right)
\displaystyle=\prod_{i=1}^{k-1}\mathbb{P}\left(X_{i}^{\top}\theta\leq V^{\top}%
\theta\right)\frac{1}{(k-1)!}\prod_{i=k+1}^{N}\mathbb{P}\left(X_{i}^{\top}%
\theta\geq V^{\top}\theta\right)\frac{1}{(N-k)!}
\displaystyle=\prod_{i=1}^{k-1}\mathbb{P}\left(X_{i}^{\top}\theta\leq V^{\top}%
\theta\right)\frac{1}{(k-1)!}\prod_{i=k+1}^{N}\mathbb{P}\left(X_{i}^{\top}%
\theta\geq V^{\top}\theta\right)\frac{1}{(N-k)!}
\displaystyle=\frac{1}{(k-1)!(N-k)!}\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{%
\top}\theta)\right)^{N-k}.
\displaystyle=\frac{1}{(k-1)!(N-k)!}\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{%
\top}\theta)\right)^{N-k}.
C
\displaystyle\mathbb{P}\left(X_{1}^{\top}\theta<\cdots<X_{k-1}^{\top}\theta<V^%
{\top}\theta<X_{k+1}^{\top}\theta<\cdots<X_{N}^{\top}\theta\right)
\displaystyle\mathbb{P}\left(X_{1}^{\top}\theta<\cdots<X_{k-1}^{\top}\theta<V^%
{\top}\theta<X_{k+1}^{\top}\theta<\cdots<X_{N}^{\top}\theta\right)
\displaystyle\leq C\mathbb{P}\left(X_{1}^{\top}\theta<...<X_{k^{\prime}-1}^{%
\top}\theta<V^{\top}\theta<X_{k^{\prime}+1}^{\top}\theta<...<X_{N}^{\top}%
\theta\right)
\displaystyle\leq C\mathbb{P}\left(X_{1}^{\top}\theta<...<X_{k^{\prime}-1}^{%
\top}\theta<V^{\top}\theta<X_{k^{\prime}+1}^{\top}\theta<...<X_{N}^{\top}%
\theta\right)
\displaystyle\quad+C\mathbb{P}\left(X_{1}^{\top}\theta<...<X_{N-k^{\prime}}^{%
\top}\theta<V^{\top}\theta<X_{N-k^{\prime}+2}^{\top}\theta<...<X_{N}^{\top}%
\theta\right)
\displaystyle\quad+C\mathbb{P}\left(X_{1}^{\top}\theta<...<X_{N-k^{\prime}}^{%
\top}\theta<V^{\top}\theta<X_{N-k^{\prime}+2}^{\top}\theta<...<X_{N}^{\top}%
\theta\right)
\displaystyle\frac{1}{(k-1)!(N-k)!}\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{%
\top}\theta)\right)^{N-k}
\displaystyle\frac{1}{(k-1)!(N-k)!}\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{%
\top}\theta)\right)^{N-k}
\displaystyle\leq\frac{C}{(k^{\prime}-1)!(N-k^{\prime})!}\left[\psi(V^{\top}%
\theta)^{k^{\prime}-1}\left(1-\psi(V^{\top}\theta)\right)^{N-k^{\prime}}+\psi(%
V^{\top}\theta)^{N-k^{\prime}}\left(1-\psi(V^{\top}\theta)\right)^{k^{\prime}-%
1}\right]
\displaystyle\leq\frac{C}{(k^{\prime}-1)!(N-k^{\prime})!}\left[\psi(V^{\top}%
\theta)^{k^{\prime}-1}\left(1-\psi(V^{\top}\theta)\right)^{N-k^{\prime}}+\psi(%
V^{\top}\theta)^{N-k^{\prime}}\left(1-\psi(V^{\top}\theta)\right)^{k^{\prime}-%
1}\right]
\displaystyle C\geq\frac{(k^{\prime}-1)!(N-k^{\prime})!}{(k-1)!(N-k)!}\cdot%
\frac{\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{\top}\theta)\right)^{N-k}}{%
\psi(V^{\top}\theta)^{k^{\prime}-1}\left(1-\psi(V^{\top}\theta)\right)^{N-k^{%
\prime}}+\psi(V^{\top}\theta)^{N-k^{\prime}}\left(1-\psi(V^{\top}\theta)\right%
)^{k^{\prime}-1}}
\displaystyle C\geq\frac{(k^{\prime}-1)!(N-k^{\prime})!}{(k-1)!(N-k)!}\cdot%
\frac{\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{\top}\theta)\right)^{N-k}}{%
\psi(V^{\top}\theta)^{k^{\prime}-1}\left(1-\psi(V^{\top}\theta)\right)^{N-k^{%
\prime}}+\psi(V^{\top}\theta)^{N-k^{\prime}}\left(1-\psi(V^{\top}\theta)\right%
)^{k^{\prime}-1}}
\psi(V^{\top}\theta)\in[0,1]
\displaystyle\frac{\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{\top}\theta)%
\right)^{N-k}}{\psi(V^{\top}\theta)^{k^{\prime}-1}\left(1-\psi(V^{\top}\theta)%
\right)^{N-k^{\prime}}+\psi(V^{\top}\theta)^{N-k^{\prime}}\left(1-\psi(V^{\top%
}\theta)\right)^{k^{\prime}-1}}\leq 1
\displaystyle\frac{\psi(V^{\top}\theta)^{k-1}\left(1-\psi(V^{\top}\theta)%
\right)^{N-k}}{\psi(V^{\top}\theta)^{k^{\prime}-1}\left(1-\psi(V^{\top}\theta)%
\right)^{N-k^{\prime}}+\psi(V^{\top}\theta)^{N-k^{\prime}}\left(1-\psi(V^{\top%
}\theta)\right)^{k^{\prime}-1}}\leq 1
N
k
k^{\prime}
C=\frac{(k^{\prime}-1)!(N-k^{\prime})!}{(k-1)!(N-k)!}
\mathcal{E}_{t}=[\epsilon_{t1},\epsilon_{t2},...,\epsilon_{t|S_{t}|}]^{\top}
\|\mathcal{E}_{t}\|\leq\sqrt{2}
\epsilon_{ti}
\displaystyle\epsilon_{t1}+\epsilon_{t2}+...+\epsilon_{t|S_{t}|}=0,\quad\text{%
and}\quad\epsilon_{ti}\in[-1,1].
\displaystyle\epsilon_{t1}+\epsilon_{t2}+...+\epsilon_{t|S_{t}|}=0,\quad\text{%
and}\quad\epsilon_{ti}\in[-1,1].
\mathcal{E}_{t}
\ell_{2}
\|\mathcal{E}_{t}\|=\sqrt{\epsilon_{t1}^{2}+\epsilon_{t2}^{2}+...+\epsilon_{t|%
S_{t}|}^{2}}
i,j\in S_{t}
i\neq j
\displaystyle\epsilon_{ti}=1,\epsilon_{tj}=-1\quad\text{and}\quad\epsilon_{tk}%
=0,\text{ for all }k\neq i,k\neq j,
\displaystyle\epsilon_{ti}=1,\epsilon_{tj}=-1\quad\text{and}\quad\epsilon_{tk}%
=0,\text{ for all }k\neq i,k\neq j,
\|\mathcal{E}_{t}\|\leq\sqrt{2}
X_{1},...,X_{n}
n
\mathbb{E}[X_{i}]=0
X_{i}\in[a_{i},b_{i}]
i
nu>0
\displaystyle\mathbb{P}\left(\left|\sum_{i=1}^{n}X_{i}\right|>\nu\right)\leq 2%
\exp\left(-\frac{2\nu^{2}}{\sum_{i=1}^{n}(b_{i}-a_{i})^{2}}\right)\,.
\displaystyle\mathbb{P}\left(\left|\sum_{i=1}^{n}X_{i}\right|>\nu\right)\leq 2%
\exp\left(-\frac{2\nu^{2}}{\sum_{i=1}^{n}(b_{i}-a_{i})^{2}}\right)\,.
\{\Yb_{k}\}
\Yb_{k}
\lambda_{\max}(\Yb_{k})\leq R
\displaystyle\mu_{\min}:=\lambda_{\min}\left(\sum_{k}\EE[\Yb_{k}]\right)%
\enskip\text{ and }\enskip\mu_{\max}:=\lambda_{\max}\left(\sum_{k}\EE[\Yb_{k}]\right)
\displaystyle\mu_{\min}:=\lambda_{\min}\left(\sum_{k}\EE[\Yb_{k}]\right)%
\enskip\text{ and }\enskip\mu_{\max}:=\lambda_{\max}\left(\sum_{k}\EE[\Yb_{k}]\right)
\displaystyle\PP\left\{\lambda_{\min}\left(\sum_{k}\EE[\Yb_{k}]\right)\leq(1-%
\delta)\mu_{\min}\right\}\leq d\cdot\left(\frac{e^{-\delta}}{(1-\delta)^{1-%
\delta}}\right)^{\mu_{\min}/R}\enskip\text{ for }\delta\in[0,1]\text{ and }
\displaystyle\PP\left\{\lambda_{\min}\left(\sum_{k}\EE[\Yb_{k}]\right)\leq(1-%
\delta)\mu_{\min}\right\}\leq d\cdot\left(\frac{e^{-\delta}}{(1-\delta)^{1-%
\delta}}\right)^{\mu_{\min}/R}\enskip\text{ for }\delta\in[0,1]\text{ and }
\displaystyle\PP\left\{\lambda_{\max}\left(\sum_{k}\EE[\Yb_{k}]\right)\leq(1+%
\delta)\mu_{\max}\right\}\leq d\cdot\left(\frac{e^{\delta}}{(1+\delta)^{1+%
\delta}}\right)^{\mu_{\max}/R}\enskip\text{ for }\delta\geq 0\,.
\displaystyle\PP\left\{\lambda_{\max}\left(\sum_{k}\EE[\Yb_{k}]\right)\leq(1+%
\delta)\mu_{\max}\right\}\leq d\cdot\left(\frac{e^{\delta}}{(1+\delta)^{1+%
\delta}}\right)^{\mu_{\max}/R}\enskip\text{ for }\delta\geq 0\,.
K
z_{tik}
i
t
k\in[K]
w_{tik}:=\exp(z_{tik})
S_{t}=\{(i,k)\in[N]\times[K]:\phi_{tik}=1\}
\displaystyle\max\sum_{i\in[N],k\in[K]}\frac{r_{ti}w_{tik}\phi_{tik}}{1+\sum_{%
ik}w_{tik}\phi_{tik}}
\displaystyle\max
\displaystyle\sum_{i\in[N],k\in[K]}\frac{r_{ti}w_{tik}\phi_{tik}}{1+\sum_{ik}w%
_{tik}\phi_{tik}}
\displaystyle\textrm{s.t.}\sum_{i}\phi_{tik}\leq 1\qquad\forall k\in[N]
\displaystyle\sum_{i}\phi_{tik}\leq 1\qquad\forall k\in[N]
\displaystyle\sum_{k}\phi_{tik}\leq 1\qquad\forall i\in[N]
\displaystyle\sum_{k}\phi_{tik}\leq 1\qquad\forall i\in[N]
\displaystyle\phi_{tik}\in\{0,1\}\qquad\forall i\in[N],k\in[K]
\displaystyle\phi_{tik}\in\{0,1\}\qquad\forall i\in[N],k\in[K]
\phi_{tik}
i
k
t
1
w_{ti}(\theta)=\exp(x_{ti}^{\top}\theta)
\theta
S_{t}\subset[N]
w_{ti}
t
\phi_{ti}\in\{0,1\}
\phi_{ti}=1
i
t
\phi_{ti}=0
\phi_{t}=\{\phi_{ti}:i\in[N]\}\in\{0,1\}^{N}
i
p_{i}(\phi_{t})=\frac{w_{ti}\phi_{ti}}{1+\sum_{j\in[N]}w_{tj}\phi_{tj}}
R_{t}(\phi_{t})=\sum_{i\in[N]}r_{ti}p_{i}(\phi_{t})=\frac{\sum_{i\in[N]}r_{ti}%
w_{ti}\phi_{ti}}{1+\sum_{j\in[N]}w_{tj}\phi_{tj}}
r_{ti}
i
t
\mathcal{F}=\{\phi_{t}\in\{0,1\}^{N}:\sum_{i\in[N]}\phi_{ti}\leq K\}
\mathcal{F}
R^{*}_{t}=\argmax_{\phi_{t}\in\mathcal{F}}R_{t}(\phi_{t})
\phi^{*}_{t}=\argmax_{\phi_{t}\in\mathcal{F}}R_{t}(\phi_{t})
S_{t}=\{i\in[N]:\phi_{ti}=1\}
\displaystyle\max\sum_{i\in[N]}r_{ti}\rho_{ti}
\displaystyle\max
\displaystyle\sum_{i\in[N]}r_{ti}\rho_{ti}
\displaystyle\textrm{s.t.}\sum_{i\in[N]}\rho_{ti}+\rho_{t0}=1
\displaystyle\sum_{i\in[N]}\rho_{ti}+\rho_{t0}=1
\displaystyle\sum_{i\in[N]}\frac{\rho_{ti}}{w_{ti}}\leq K\rho_{t0}
\displaystyle\sum_{i\in[N]}\frac{\rho_{ti}}{w_{ti}}\leq K\rho_{t0}
\displaystyle 0\leq\frac{\rho_{ti}}{w_{ti}}\leq\rho_{t0}
\displaystyle 0\leq\frac{\rho_{ti}}{w_{ti}}\leq\rho_{t0}
\{\rho_{ti}:i\in[N]\cup\{0\}\}
\rho_{ti},i\neq 0
i
t
\rho_{t0}
\phi_{tik}\in\{0,1\}
i
k
t
\displaystyle\max\sum_{i\in[N],k\in[K]}\frac{r_{ti}w_{tik}\phi_{tik}}{1+\sum_{%
i,k}w_{tik}\phi_{tik}}
\displaystyle\max
\displaystyle\sum_{i\in[N],k\in[K]}\frac{r_{ti}w_{tik}\phi_{tik}}{1+\sum_{i,k}%
w_{tik}\phi_{tik}}
\displaystyle\textrm{s.t.}\sum_{i}\phi_{tik}\leq 1\qquad\forall k\in[N]
\displaystyle\sum_{i}\phi_{tik}\leq 1\qquad\forall k\in[N]
\displaystyle\sum_{k}\phi_{tik}\leq 1\qquad\forall i\in[N]
\displaystyle\sum_{k}\phi_{tik}\leq 1\qquad\forall i\in[N]
\displaystyle\phi_{tik}\in\{0,1\}\qquad\forall i\in[N],k\in[K]
\displaystyle\phi_{tik}\in\{0,1\}\qquad\forall i\in[N],k\in[K]
1
N
K
K
K
K
K
N
K
x_{ti}
\mathcal{N}(\vec{0}_{d},I_{d})
r_{ti}=r
i
\theta^{*}
[0,1]^{d}
