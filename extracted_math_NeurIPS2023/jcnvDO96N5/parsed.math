2.57\times
1.85\times
\mathcal{O}(d^{3})
d
d
\mathcal{O}(bd^{2})
b
\mathcal{O}(b^{3})
\mathcal{O}(d^{2})
\mathcal{O}(d^{3})
\mathcal{O}(d^{2})
\mathcal{O}(d^{2})
\mathcal{O}(d)
2.57\times
\mathcal{W}=\{W^{m}\}_{m=1}^{M}
M
W^{m}
\mathbb{R}^{d\times d}
w^{m}\in\mathbb{R}^{d^{2}}
W^{m}
F^{m}
\mathcal{L}
w^{m}:=w^{m}-\alpha{(F^{m})}^{-1}\nabla_{w^{m}}\mathcal{L}
\mathcal{L}
{(L_{t}^{m})}^{-1}
{(R_{t}^{m})}^{-1}
W^{m}:=W^{m}-\alpha{(L_{t}^{m})}^{-1}\nabla_{W^{m}}\mathcal{L}{(R_{t}^{m})}^{-1}
{(L_{t}^{m})}^{-1}
{(R_{t}^{m})}^{-1}
a^{m}
m
g_{m}=\nabla_{a^{m-1}}\mathcal{L}
\gamma
L_{t}^{m}=\gamma L_{t-1}^{m}+(1-\gamma)\mathbb{E}[g_{t}^{m}{g_{t}^{m}}^{T}]
R_{t}^{m}=\gamma R_{t-1}^{m}+(1-\gamma)\mathbb{E}[a_{t}^{m-1}{a_{t}^{m-1}}^{T}]
m
A_{t}^{m}
G_{t}^{m}
\nabla_{W^{m}}\mathcal{L}
\Delta W^{m}
m
A_{t}^{m}
G_{t}^{m}
\nabla_{W^{m}}\mathcal{L}
\Delta W^{m}
A_{t}^{m-1},G_{t}^{m},W_{t-1}^{m}
W_{t}^{m}
m\in
\mathbf{a_{t}^{m-1}}\leftarrow\frac{1}{b}\sum_{i=1}^{b}(A_{t}^{m-1})_{:,i}
A_{t}^{m-1}{A_{t}^{m-1}}^{T}\approx\mathbf{a_{t}^{m-1}}\mathbf{a_{t}^{m-1}}^{T}
\mathbf{g_{t}^{m}}\leftarrow\frac{1}{b}\sum_{i=1}^{b}(G_{t}^{m})_{:,i}
G_{t}^{m}{G_{t}^{m}}^{T}\approx\mathbf{g_{t}^{m}}\mathbf{g_{t}^{m}}^{T}
\mathbf{a_{t}^{m-1}},\mathbf{g_{t}^{m}}\leftarrow
(\mathbf{a_{t}^{m-1}},\mathbf{g_{t}^{m}})
{\hat{L_{t-1}^{m}}}^{-1}
\leftarrow
\|{L_{t-1}^{m}}^{-1}\|>\epsilon
\zeta{L_{t-1}^{m}}^{-1}+(1-\zeta)I
{L_{t-1}^{m}}^{-1}
{\hat{R_{t-1}^{m}}}^{-1}
\leftarrow
\|{R_{t-1}^{m}}^{-1}\|>\epsilon
\zeta{R_{t-1}^{m}}^{-1}+(1-\zeta)I
{R_{t-1}^{m}}^{-1}
{L_{t}^{m}}^{-1}\leftarrow\gamma\hat{L_{t-1}^{m}}^{-1}+\frac{(1-\gamma)}{%
\gamma^{2}(1+\gamma(1-\gamma)\mathbf{g^{m}_{t}}^{T}\hat{L_{t-1}^{m}}^{-1}%
\mathbf{g^{m}_{t}})}\hat{L_{t-1}^{m}}^{-1}\mathbf{g^{m}_{t}}\mathbf{g^{m}_{t}}%
^{T}\hat{L_{t-1}^{m}}^{-1}
{R_{t}^{m}}^{-1}=\gamma\hat{R_{t-1}^{m}}^{-1}+\frac{(1-\gamma)}{\gamma^{2}(1+%
\gamma(1-\gamma)\mathbf{a^{m}_{t}}^{T}\hat{R_{t-1}^{m}}^{-1}\mathbf{a^{m}_{t}}%
)}\hat{R_{t-1}^{m}}^{-1}\mathbf{a^{m}_{t}}\mathbf{a^{m}_{t}}^{T}\hat{R_{t-1}^{%
m}}^{-1}
\Delta\hat{W^{m}_{t}}\leftarrow{L_{t}^{m}}^{-1}\nabla_{W^{m}}\mathcal{L}{R_{t}%
^{m}}^{-1}
\Delta W^{m}_{t}\leftarrow\frac{\|\nabla_{W^{m}}\mathcal{L}\|}{\Delta\hat{W^{m%
}_{t}}}\Delta\hat{W^{m}_{t}}
\Delta W^{m}_{t}\leftarrow\nabla_{W^{m}}\mathcal{L}
W_{t}^{m}\leftarrow Optimizer.step(\Delta W^{m}_{t},W_{t-1}^{m})
m
m
\mathbf{a_{t}^{m-1}}=\mathbb{E}[a_{t}^{m-1}]
\mathbf{g_{t}^{m}}=\mathbb{E}[g_{t}^{m}]
(A_{t}^{m-1})^{-1}_{:,i}
(G_{t}^{m})^{-1}_{:,i}
i^{th}
(A_{t}^{m-1})^{-1}
(G_{t}^{m})^{-1}
A_{t}^{m-1}
G_{t}^{m}
m
\mathbb{E}[g^{m}g^{m^{T}}]
\mathbf{g^{m}g^{m^{T}}}
{L_{t}^{m}}^{-1}=\gamma{L_{t-1}^{m}}^{-1}+\frac{(1-\gamma)}{\gamma^{2}(1+%
\gamma(1-\gamma)\mathbf{g^{m}_{t}}^{T}{L_{t-1}^{m}}^{-1}\mathbf{g^{m}_{t}})}{L%
_{t-1}^{m}}^{-1}\mathbf{g^{m}_{t}}\mathbf{g^{m}_{t}}^{T}{L_{t-1}^{m}}^{-1}
\mathbb{E}[a_{t}^{m-1}{a_{t}^{m-1}}^{T}]\approx\mathbf{a_{t}^{m}a_{t}^{{m}^{T}}}
{R_{t}^{m}}^{-1}=\gamma{R_{t-1}^{m}}^{-1}+\frac{(1-\gamma)}{\gamma^{2}(1+%
\gamma(1-\gamma)\mathbf{a^{m}_{t}}^{T}{R_{t-1}^{m}}^{-1}\mathbf{a^{m}_{t}})}{R%
_{t-1}^{m}}^{-1}\mathbf{a^{m}_{t}}\mathbf{a^{m}_{t}}^{T}{R_{t-1}^{m}}^{-1}
\mathcal{O}(d^{2}+bd)
\mathcal{O}(2d^{2}/2)
\mathcal{O}(2d/2)
\mathcal{O}(b^{3})
\mathcal{O}(2bd+b^{2})
\mathcal{O}(2bd+b^{2})
\mathcal{O}(d^{3})
\mathcal{O}(4d^{2})
\mathcal{O}(4d^{2})
\mathcal{O}(d^{2}+bd)
\mathcal{O}(2d)
\mathcal{O}(2d)
\mathcal{O}(d^{2})
\mathcal{O}(d^{2})
\mathcal{O}(d^{2})
\mathcal{O}(d^{3})
\mathcal{O}(b^{3})
\mathbb{R}^{d\times d}
\mathbb{R}^{b\times b}
2d
4d^{2}
2bd
b^{2}
2d^{2}+2d
4d^{2}
2bd+b^{2}
f
f
150\times
\mu I
\mu>0
\mathbb{R}^{b\times b}
min(b,d)
d
2\times
\epsilon
m
d
d\times d
O((\gamma+4\frac{(1-\gamma)}{\gamma^{2}}m^{3}d^{2})\epsilon)
\zeta
\hat{L_{t}^{m}}=\zeta L_{t}^{m}+(1-\zeta)I
\hat{R_{t}^{m}}=\zeta R_{t}^{m}+(1-\zeta)I
\displaystyle\hat{L}^{m^{-1}}\nabla_{W^{m}}\mathcal{L}\hat{R}^{m^{-1}}=\zeta^{%
2}L^{m^{-1}}\nabla_{W^{m}}\mathcal{L}R^{m^{-1}}
\displaystyle\hat{L}^{m^{-1}}\nabla_{W^{m}}\mathcal{L}\hat{R}^{m^{-1}}
\displaystyle=\zeta^{2}L^{m^{-1}}\nabla_{W^{m}}\mathcal{L}R^{m^{-1}}
\displaystyle\quad+\zeta(1-\zeta)L^{m^{-1}}\nabla_{W^{m}}\mathcal{L}+\zeta(1-%
\zeta)\nabla_{W^{m}}\mathcal{L}{R^{m}}^{-1}+(1-\zeta)^{2}\nabla_{W^{m}}%
\mathcal{L}
\displaystyle\quad+\zeta(1-\zeta)L^{m^{-1}}\nabla_{W^{m}}\mathcal{L}+\zeta(1-%
\zeta)\nabla_{W^{m}}\mathcal{L}{R^{m}}^{-1}+(1-\zeta)^{2}\nabla_{W^{m}}%
\mathcal{L}
\mathcal{L}(w)
\mathcal{\hat{L}}(w-\Delta w)=\mathcal{L}(w_{0})\Delta w^{T}\nabla_{w}\mathcal%
{L}(w_{0})
w_{0}
w_{0}
\mathcal{L}(w)
\nabla^{2}_{w}\mathcal{L}(w_{0})=H=L\otimes R
L
R
\Delta w=((\zeta L^{-1}+(1-\zeta)I)\otimes(\zeta R^{-1}+(1-\zeta)I))\nabla%
\mathcal{L}(w_{0})
\mathcal{\hat{L}}(w_{0}-\Delta w)<\mathcal{L}(w_{0})
\zeta
1,536
2.6\times
2.57\times
1.75\times
1.69\times
\times
2.6\times
2.57\times
0.89\times
1.69\times
1.24\%
\times
f
C=XX^{T}
C\in R^{d\times d}
X\in R^{d\times b}
d
b
min(b,d)
C=\sum_{i=1}^{r}{c_{i}c_{i}^{T}}
r
C
C_{1}^{new}=(C^{old}+c_{1}c_{1}^{T})^{-1}
O(d^{2})
C_{2}^{new}=(C_{1}^{new}+c_{2}c_{2}^{T})^{-1}
O(d^{2})
C_{i}^{new}=(C_{i-1}^{new}+c_{i}c_{i}^{T})^{-1}
O(rd^{2})
C
1.49\times
1.04\times
d
F^{m}
m
x_{i}
i^{th}
F^{m}=\frac{1}{b}\sum_{i=1}^{b}\nabla_{x_{i}}\ell(\mathcal{W},x_{i})\nabla_{x_%
{i}}\ell(\mathcal{W},x_{i})^{T}
g^{m}=\nabla_{x^{m}}\mathcal{L}
a^{m}
m
\mathbb{E}
x^{m}
m
F^{m}=\mathbb{E}[(g^{m}\otimes a^{m-1})(g^{m}\otimes a^{m-1})^{T}]=\mathbb{E}[%
(g^{m}{g^{m}}^{T})\otimes(a^{m-1}{a^{m-1}}^{T})]
\mathbb{E}[(g^{m}{g^{m}}^{T})\otimes(a^{m-1}{a^{m-1}}^{T})]\approx\mathbb{E}[g%
^{m}{g^{m}}^{T}]\otimes\mathbb{E}[a^{m-1}{a^{m-1}}^{T}]
{F^{m}}^{-1}w^{m}=\mathbb{E}[g^{m}{g^{m}}^{T}]^{-1}\otimes\mathbb{E}[a^{m-1}{a%
^{m-1}}^{T}]^{-1}w^{m}
L^{m}
R^{m}
(F^{m}+\mu I)\in\mathbb{R}^{d^{2}\times d^{2}}
\mu
A^{m}\in\mathbb{R}^{d\times b}
l
G^{m}\in\mathbb{R}^{d\times b}
U=[\nabla_{W^{m}}\mathcal{L(W},x_{1}),...,\nabla_{W^{m}}\mathcal{L(W},x_{b})]^%
{T}\in\mathbb{R}^{d^{2}\times b}
\odot
\mathbb{R}^{b\times b}
(F^{m}+\mu I)^{-1}=\frac{1}{\mu}(I-U^{m}({A^{m-1}}^{T}A^{m-1}\odot{G^{m}}^{T}G%
^{m}+\mu I)^{-1}{U^{m}}^{T})
*
*
10
1
0.1
0.01
94
79
78
76
112
100
90
89^{*}
D
123^{*}
98
150^{*}
D
D
108
145^{*}
{L_{t-1}^{m-1}}^{-1}
{R_{t-1}^{m}}^{-1}
\times
1.26\times
1.31\times
1.58\times
1.22\times
1.43\times
1.26\times
1.56\times
\beta
\beta
J_{t-1}
j
0<\gamma<1
{J_{t}}^{-1}=\gamma{J_{t-1}}^{-1}+\frac{(1-\gamma)}{\gamma^{2}(1+\gamma(1-%
\gamma){j}^{T}{J_{t-1}}^{-1}{j})}{J_{t-1}}^{-1}{j}{j}^{T}{J_{t-1}}^{-1}
\gamma>0
J_{t-1}
\gamma J_{t-1}
J_{t-1}
\forall x\neq 0:x^{T}J_{t-1}x>0
j^{T}L_{t-1}^{-1}j>0\xrightarrow[]{0<\gamma<1}1+\gamma(1-\gamma){j}^{T}{J_{t-1%
}}^{-1}{j}>0
{J_{t-1}}^{-1}{j}{j}^{T}{J_{t-1}}^{-1}
\forall x\neq 0:x^{T}{J_{t-1}}^{-1}{j}{j}^{T}{J_{t-1}}^{-1}x=(j^{T}J_{t-1}^{-1%
}x)^{T}(j^{T}J_{t-1}^{-1}x)=\|(j^{T}J_{t-1}^{-1}x)\|^{2}>0
P=(\zeta L^{-1}+(1-\zeta)I)\otimes(\zeta R^{-1}+(1-\zeta)I)
\mathcal{\hat{L}}(w_{0}-\Delta w)-\mathcal{L}(w_{0})=-\nabla\mathcal{L}(w_{0})%
^{T}P\nabla\mathcal{L}(w_{0})
P
P
P=\zeta^{2}L^{-1}\otimes R^{-1}+\zeta(1-\zeta)L^{-1}\otimes I+\zeta(1-\zeta)I%
\otimes R^{-1}+I
L
R
L^{-1}\otimes R^{-1}
L^{-1}\otimes I
I\otimes R^{-1}
x
x^{T}Px>0
-\nabla\mathcal{L}(w_{0})^{T}P\nabla\mathcal{L}(w_{0})
\mathcal{\hat{L}}(w_{0}-\Delta w)<\mathcal{L}(w_{0})
J
j
\epsilon
j
J
m
O(2\epsilon m^{2}d)
2m\epsilon+\epsilon^{2}
d
(2m+1)d\epsilon
O(2\epsilon m^{2}d)
O(2\epsilon m)
2\epsilon m^{2}+\epsilon^{2}
\gamma{J}+\frac{(1-\gamma)}{\gamma^{2}(1+\gamma(1-\gamma){j}^{T}{J}{j})}{J}{j}%
{j}^{T}{J^{T}}
\gamma J
\gamma\epsilon
1
Jj
O(2m^{2}d\epsilon)
Jjj^{T}J^{T}=(Jj)(Jj)^{T}
O(4m^{3}d^{2})
O((\gamma+4\frac{(1-\gamma)}{\gamma^{2}}m^{3}d^{2})\epsilon)
