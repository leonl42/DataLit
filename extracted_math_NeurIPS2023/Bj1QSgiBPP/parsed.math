\bm{g}{}
n^{+{}}_{\bm{g}}
n^{-{}}_{\bm{g}}
h
R_{\bm{g}}(h)
h_{0}{}
R_{\bm{g}}(h_{0})
0
24
+
-
25
0
+
-
25
0
+
-
0
27
-
-
50
51
h
\bm{r}
\Delta R_{\bm{g}}(h,h_{0}{})
h
-24
h
25
h
25
h
0
26
h
h_{0}{}
\bm{r}
\Delta R_{\bm{g}}(h,h_{0}{})
h_{0}{}
\varnothing{}
0
h
25
h
25
h_{0}{}
\varnothing{}
0
50
h
\Delta R_{\bm{g}}(h,h_{0}{})=
~{}26
[{\footnotesize{\texttt{male}}},{\footnotesize{\texttt{young}}}]
\Delta R_{\bm{g}}(h,h_{0}{})=
~{}0
[{\footnotesize{\texttt{female}}},{\footnotesize{\texttt{old}}}]
\Delta R_{\bm{g}}(h,h_{0}{})=~{}
-24
h
h_{0}{}
[{\footnotesize{\texttt{female}}},{\footnotesize{\texttt{old}}}]
[{\footnotesize{\texttt{male}}},{\footnotesize{\texttt{young}}}]
\Delta R_{\bm{g}}(h,h_{0}{})=~{}
50
\varnothing
h
\Delta R_{\bm{g}}(h,h_{0}{})=
~{}26
[{\footnotesize{\texttt{male}}},{\footnotesize{\texttt{young}}}]
\Delta R_{\bm{g}}(h,h_{0}{})=
~{}0
[{\footnotesize{\texttt{female}}},{\footnotesize{\texttt{old}}}]
\Delta R_{\bm{g}}(h,h_{0}{})=~{}
-24
h
h_{0}{}
[{\footnotesize{\texttt{female}}},{\footnotesize{\texttt{old}}}]
[{\footnotesize{\texttt{male}}},{\footnotesize{\texttt{young}}}]
\Delta R_{\bm{g}}(h,h_{0}{})=~{}
50
\varnothing
\{(\bm{x}_{i},y_{i},\bm{g}_{i})\}_{i=1}^{n}
\bm{x}_{i}\in\mathbb{R}^{d}
y_{i}\in\mathcal{Y}
k
\bm{g}_{i}=[g_{i,1},\ldots,g_{i,k}]\in\mathcal{G}_{1}\times\ldots\times%
\mathcal{G}_{k}=\mathcal{G}
\mathcal{G}
\bm{g}_{i}
i
n_{\bm{g}}:=|\{i~{}|\bm{g}_{i}=\bm{g}\}|
\bm{g}
|\mathcal{G}_{i}|
i
h:\mathcal{X}\times\mathcal{G}\to\mathcal{Y}
\ell:\mathcal{Y}\times\mathcal{Y}\to\mathbb{R}_{+}
h
{R(h)}
{\hat{R}(h)}
h
\bm{g}\in\mathcal{G}
\bm{g}^{\prime}\in\mathcal{G}
\displaystyle{R_{\bm{g}}(h(\cdot,\bm{g}^{\prime}))}:=\mathbb{E}\left[\ell\left%
(h(\cdot,\bm{r}^{\prime}),y\right)\mid\mathcal{G}=\bm{g}^{\prime}\right],%
\qquad{\hat{R}_{\bm{g}}(h(\cdot,\bm{g}^{\prime}))}:=\frac{1}{n_{\bm{g}}}\sum_{%
i:\bm{r}_{i}=\bm{g}}\ell\left(h(\cdot,\bm{r}^{\prime}),y_{i}\right).
\displaystyle{R_{\bm{g}}(h(\cdot,\bm{g}^{\prime}))}:=\mathbb{E}\left[\ell\left%
(h(\cdot,\bm{r}^{\prime}),y\right)\mid\mathcal{G}=\bm{g}^{\prime}\right],%
\qquad{\hat{R}_{\bm{g}}(h(\cdot,\bm{g}^{\prime}))}:=\frac{1}{n_{\bm{g}}}\sum_{%
i:\bm{r}_{i}=\bm{g}}\ell\left(h(\cdot,\bm{r}^{\prime}),y_{i}\right).
h
h^{\prime}
\bm{g}{}
h
{R_{\bm{g}}(h)}<{R_{\bm{g}}(h^{\prime})}
\varnothing{}
\bm{r}_{i}=[r_{i,1},\ldots,r_{i,k}]\in\mathcal{R}\subseteq\mathcal{G}\times\bm%
{\varnothing}{}
i
\bm{g}_{i}=[{\footnotesize{\texttt{female}}},{\footnotesize{\texttt{HIV}}}={%
\footnotesize{\texttt{+}}}]
\bm{r}_{i}=[{\footnotesize{\texttt{female}}},\varnothing{}]
\bm{r}_{i}=\bm{\varnothing}{}:=[\varnothing,\ldots,\varnothing]
\mathcal{R}
\mathcal{R}=\mathcal{G}
\mathcal{R}=\mathcal{G}\times\bm{\varnothing}{}
\bm{g}
\bm{r}\in\dim{\bm{g}}:=\bm{g}\times\bm{\varnothing}
n_{\bm{r}}
\bm{r}\in\mathcal{R}{}
\mathcal{G}
T
\textnormal{nodes}(T)=\mathcal{R}\subseteq\mathcal{G}\times\bm{\varnothing}{}
\textnormal{root}(T)=\bm{\varnothing}{}
\bm{r}
\bm{r}^{\prime}
\bm{r}=\textnormal{pa}(\bm{r}^{\prime})
\bm{\varnothing}\in\textrm{nodes}(T)
\mathcal{G}
T
f_{T}:\mathcal{X}\times\mathcal{R}\to\mathcal{Y}
\displaystyle{R_{\bm{r}}(f_{T}({\cdot,\bm{r}}))}<{R_{\bm{r}}(f_{T}({\cdot,\bm{%
r}}^{\prime}))}\textrm{ for all reporting groups }\bm{r},\bm{r}^{\prime}%
\textrm{ such that }\bm{r}^{\prime}=\textnormal{pa}(\bm{r})
\displaystyle{R_{\bm{r}}(f_{T}({\cdot,\bm{r}}))}<{R_{\bm{r}}(f_{T}({\cdot,\bm{%
r}}^{\prime}))}\textrm{ for all reporting groups }\bm{r},\bm{r}^{\prime}%
\textrm{ such that }\bm{r}^{\prime}=\textnormal{pa}(\bm{r})
h_{0}{}:\mathcal{X}\to\mathcal{Y}
h_{0}\in\operatorname*{argmin}_{h\in\mathcal{H}}{R(h)}
{R_{\bm{g}}(f_{T}(\cdot,\bm{\varnothing}{}))}\leq{R_{\bm{g}}(h_{0})}\textrm{ %
for all groups }\bm{g}\in\mathcal{G}.
\bm{g}
\Delta_{\bm{g}}({\bm{r}},{\bm{\varnothing}{}}):={R_{\bm{g}}(f_{T}(\cdot,\bm{%
\varnothing}{}))}-{R_{\bm{g}}(f_{T}(\cdot,\bm{r}))}
\hat{\Delta}_{\bm{g}}({\bm{r}},{\bm{\varnothing}{}}):={\hat{R}_{\bm{g}}(f_{T}(%
\cdot,\bm{\varnothing}{}))}-{\hat{R}_{\bm{g}}(f_{T}(\cdot,\bm{r}))}
\Delta_{\bm{g}}({\bm{r}},{\bm{\varnothing}{}})>0
\bm{g}\in\mathcal{G},\bm{r}\in\dim{\bm{g}}
h
h_{0}{}
\bm{g}_{i}=[\texttt{old},\texttt{female}]
\bm{r}_{i}=[\texttt{old},\varnothing]
{\footnotesize{\texttt{sex}}}\times{\footnotesize{\texttt{age}}}=[{%
\footnotesize{\texttt{male}}},{\footnotesize{\texttt{female}}}]\times[{%
\footnotesize{\texttt{old}}},{\footnotesize{\texttt{young}}}]
\varnothing
[{\footnotesize{\texttt{young}}},{\footnotesize{\texttt{female}}}]
\leq
{\footnotesize{\texttt{sex}}}\times{\footnotesize{\texttt{age}}}=[{%
\footnotesize{\texttt{male}}},{\footnotesize{\texttt{female}}}]\times[{%
\footnotesize{\texttt{old}}},{\footnotesize{\texttt{young}}}]
\varnothing
[{\footnotesize{\texttt{young}}},{\footnotesize{\texttt{female}}}]
\leq
\bm{r}=\bm{\varnothing}
{R_{\bm{g}}(f_{T}(\cdot,\hat{\bm{g}}))}>{R_{\bm{g}}(h_{0})}
\hat{\bm{g}}
h:\mathcal{X}\times\mathcal{R}{}\to\mathcal{Y}
\bm{r}_{i}\in\operatorname*{argmax}_{\bm{r}\in\mathcal{R}}{u_{i}({\bm{r};h})}
u_{i}({\bm{r};h})=b_{i}({\bm{r};h})-c_{i}({\bm{r}}),
c_{i}({\cdot})
b_{i}({\cdot})
c_{i}({\bm{r}})\geq 0
\bm{r}\in\mathcal{R}
c_{i}({\bm{r}})\leq c_{i}({\bm{r}^{\prime}})
\bm{r}\subseteq\bm{r}^{\prime}
b_{i}({\bm{r},h})>b_{i}({\bm{r}^{\prime},h})
{R_{\bm{r}}(h(\bm{x}_{i},\bm{r}))}<{R_{\bm{r}}(h(\bm{x}_{i},\bm{r}^{\prime}))}.
f:\mathcal{X}\times\mathcal{R}\to Y
h:\mathcal{X}\times\mathcal{G}\to\mathcal{Y}
h_{0}{}:\mathcal{X}\to\mathcal{Y}
\bullet
\bullet
\bullet
f
h_{0}
h
f:\mathcal{X}\times\mathcal{R}^{\min}\to Y
\bullet
\bullet
\bullet
f
\bullet
\bullet
\bullet
\mathcal{M}{}
\mathcal{D}^{\textrm{train}}
\mathcal{D}^{\textrm{valid}}
\mathcal{M}{}:\{h:\mathcal{X}\times\mathcal{G}\to\mathcal{Y}\}
\mathcal{D}^{\textrm{assign}}=\{(\bm{x}_{i},\bm{g}_{i},y_{i})\}_{i=1}^{n^{%
\textrm{assign}}}
\mathcal{D}^{\textrm{prune}}=\{(\bm{x}_{i},\bm{g}_{i},y_{i})\}_{i=1}^{n^{%
\textrm{prune}}}
\mathbb{T}\leftarrow{\small\textsf{ViableTrees}}(\mathcal{G},\mathcal{D}^{%
\textrm{assign}})
|\mathbb{T}|=1
T\in\mathbb{T}{}
T\leftarrow{\small\textsf{AssignModels}}(T,\mathcal{M},\mathcal{D}^{\textrm{%
assign}})
T\leftarrow{\small\textsf{PruneLeaves}}(T,\mathcal{D}^{\textrm{prune}})
\mathbb{T}{}
\mathcal{M}{}
h
h_{0}{}
\mathbb{T}{}
\mathcal{G}
\mathcal{D}^{\textrm{assign}}
m
n_{\bm{r}}\geq d+1
\leq 8
\mathbb{T}{}
24
3
\mathbb{T}
1
\bm{r}
\bm{r}_{i}\in\dim{\bm{r}}
h_{0}{}
[{\footnotesize{\texttt{female}}},\varnothing{}]
[{\footnotesize{\texttt{female}}},{\footnotesize{\texttt{young}}}]
f_{T}
\mathcal{D}^{\textrm{prune}}
f_{T^{\prime}}
T^{\prime}\subseteq T
\displaystyle H_{0}:\Delta_{\bm{r}}({\bm{r}},{\textnormal{pa}(\bm{r})})\leq 0%
\qquad H_{A}:\Delta_{\bm{r}}({\bm{r}},{\textnormal{pa}(\bm{r})})>0
\displaystyle H_{0}:\Delta_{\bm{r}}({\bm{r}},{\textnormal{pa}(\bm{r})})\leq 0%
\qquad H_{A}:\Delta_{\bm{r}}({\bm{r}},{\textnormal{pa}(\bm{r})})>0
\bm{r}
T
f_{T}({\cdot,\textnormal{pa}(\bm{r})})
H_{0}
H_{0}
f_{T}({\cdot,\bm{r}})
\bm{r}
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\displaystyle\sum_{\bm{g}\in\mathcal{G}}\tfrac{n_{\bm{g}}}{n}{\hat{R}_{\bm{g}}%
(h_{\bm{g}})}
\displaystyle\sum_{\bm{g}\in\mathcal{G}}\tfrac{n_{\bm{g}}}{n}\hat{\Delta}_{\bm%
{g}}({\bm{g}},{\bm{\varnothing}{}})
\displaystyle\min_{\bm{g}\in\mathcal{G}}/\max_{\bm{g}\in\mathcal{G}}\hat{%
\Delta}_{\bm{g}}({\bm{g}},{\bm{\varnothing}{}})
\displaystyle\sum_{\bm{g}\in\mathcal{G}}\mathbb{I}[\textrm{reject}~{}H_{0}]
H_{0}:\Delta_{\bm{g}}({\bm{g}},{\bm{\varnothing}{}})\geq 0
H_{A}:\Delta_{\bm{g}}({\bm{g}},{\bm{\varnothing}{}})<0
\displaystyle\min_{\bm{g}\in\mathcal{G}}\hat{\Delta}_{\bm{g}}({\bm{g}},{\bm{g}%
^{\prime}})
\displaystyle\frac{|\mathcal{R}|-|\mathcal{R}(h)|}{|\mathcal{R}|}
\mathcal{R}(h)
h
\mathcal{R}
\displaystyle\sum_{\bm{g}\in\mathcal{G}}\tfrac{n_{\bm{g}}}{n}\tfrac{\textrm{%
requested}({h,\bm{g}})}{\textrm{dim}(\mathcal{G})}
k
h
\mathcal{G}
n={1152},d={26}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={1341},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={5289},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={29211},d={72}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={120641},d={84}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={7797},d={36}
\mathcal{G}=\{{\footnotesize{\texttt{HIV}}},{\footnotesize{\texttt{age}}}\}
|\mathcal{G}|={4}
[{\footnotesize{\texttt{30\_to\_60}}},{\footnotesize{\texttt{male}}}]
[{\footnotesize{\texttt{30+}}},\varnothing{}]
[\varnothing{},{\footnotesize{\texttt{HIV+}}}]
3.7\%
[\varnothing{},{\footnotesize{\texttt{HIV+}}}]
16.7\%
[{\footnotesize{\texttt{30+}}},{\footnotesize{\texttt{HIV+}}}]
16.7\%-3.7\%=13.0\%
3.7\%
[{\footnotesize{\texttt{30+}}},{\footnotesize{\texttt{HIV+}}}]
[{\footnotesize{\texttt{<30}}},{\footnotesize{\texttt{HIV+}}}]
0.0\%
11.3\%
83.3\%
\mathcal{G}={\footnotesize{\texttt{HIV}}}\times{\footnotesize{\texttt{age}}}={%
\footnotesize{\texttt{[+,-]}}}\times{\footnotesize{\texttt{[<30, 30+]}}}
h_{0}{}
h_{1}
\mathcal{G}
h_{2}\cdots h_{m}
21.5\%
\mathcal{G}={\footnotesize{\texttt{HIV}}}\times{\footnotesize{\texttt{age}}}={%
\footnotesize{\texttt{[+,-]}}}\times{\footnotesize{\texttt{[<30, 30+]}}}
h_{0}{}
h_{1}
\mathcal{G}
h_{2}\cdots h_{m}
21.5\%
126
h_{0}{}
-4.6\%
4.6\%
\mathcal{G}
\mathcal{D}
\mathbb{T}{}{}
\mathcal{G},\mathcal{D}
\mathcal{G}{}
T_{\mathcal{G}}{}
\mathbb{T}{}\leftarrow[\ ]
\mathcal{A}\in[\mathcal{G}_{1},\ldots,\mathcal{G}_{k}]
T_{\mathcal{A}}{}\leftarrow
|\mathcal{A}|
\mathcal{S}\leftarrow\textsf{ViableTrees}(\mathcal{G}\setminus\mathcal{A},%
\mathcal{D})
\mathcal{A}
\Pi{}
\mathcal{S}{},\mathcal{A},\mathcal{D}
|\mathcal{A}|
T_{\mathcal{A}}{}
\mathbb{T}{}{}\leftarrow\mathbb{T}{}{}\cup T_{\mathcal{A}}.\textsf{assign}(\Pi%
{})
\mathbb{T}{}{}
\mathcal{G}{}
\mathcal{G}{}
\mathcal{G}
s
\mathcal{G}
T,\mathcal{M}{},\mathcal{D}
Q\leftarrow[T.\textsf{root}]
\bm{\varnothing}{}
Q
\bm{r}\leftarrow Q.\textsf{pop}()
\mathcal{M}_{\bm{r}}\leftarrow\textsf{ViableModels}(\mathcal{M},\bm{r})
\mathcal{M}
\bm{r}
\displaystyle h^{*}\leftarrow\operatorname*{argmin}_{h\in\mathcal{M}_{\bm{r}}}%
{{\hat{R}_{\bm{r}}(h,\mathcal{D})}}
T.\textsf{set\_model}(\bm{r},h^{*})
\bm{r}^{\prime}\in T.\textsf{get\_subgroups}(\bm{r})
\bm{r}
Q.\textsf{enqueue}(\bm{r}^{\prime})
T
T{}
\mathcal{M}
\mathcal{D}
T
h_{0}{}
h_{0}{}
T,\mathcal{D}
Stack\leftarrow[T.\textsf{leaves}]
\bm{r}\leftarrow Stack.pop()
h\leftarrow T.\textsf{get\_model}(\bm{r})
h^{\prime}\leftarrow T.\textsf{get\_model}(\textnormal{pa}(\bm{r}))
{\small\textsf{Test}}(\bm{r},h,h^{\prime},\mathcal{D})
T.\textsf{prune}(\bm{r})
T.\textsf{get\_children}(\textnormal{pa}(\bm{r}))
Stack.\textsf{enqueue}(\textnormal{pa}(\bm{r}))
Stack
T
T
\mathcal{D}
T
\displaystyle H_{0}:{R_{\bm{g}}(h)}\leq{R_{\bm{g}}(h^{\prime})}\quad\text{vs.}%
\quad H_{A}:{R_{\bm{g}}(h)}>{R_{\bm{g}}(h^{\prime})}
\displaystyle H_{0}:{R_{\bm{g}}(h)}\leq{R_{\bm{g}}(h^{\prime})}\quad\text{vs.}%
\quad H_{A}:{R_{\bm{g}}(h)}>{R_{\bm{g}}(h^{\prime})}
h
h^{\prime}
H_{0}
\mathcal{R}
T{}\leftarrow
\bm{r}{}\in\textrm{leaves}(T{})
\{\mathcal{A}_{\bm{r}{}}\}\leftarrow{G_{i}:\bm{r}{}[i]=\varnothing}
\{\mathcal{A}_{\bm{r}{}}\}
\mathcal{A}^{*}\leftarrow\operatorname*{argmax}_{\mathcal{A}\in\{\mathcal{A}_{%
\bm{r}{}}\}}{\min_{\bm{r}^{\prime}\in\bm{r}{}.\textsf{split}(\mathcal{A})}{%
\Delta_{\bm{r}^{\prime}}({\bm{r}^{\prime}},{\bm{r}})}}
\bm{r}{}.\textsf{split}(\mathcal{A}^{*})
T{}
\mathcal{R}{}
\mathcal{R}
\mathcal{R}
n
d
m
\mathcal{G}
n
d
\mathcal{G}
m=|\mathcal{G}|
n
d
\mathcal{G}
m=|\mathcal{G}|
n={1152},d={26}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={1341},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={5289},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={29211},d={72}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={120641},d={84}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={7797},d={36}
\mathcal{G}=\{{\footnotesize{\texttt{HIV}}},{\footnotesize{\texttt{age}}}\}
|\mathcal{G}|={4}
n={1152},d={26}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={1341},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={5289},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={29211},d={72}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={120641},d={84}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={7797},d={36}
\mathcal{G}=\{{\footnotesize{\texttt{HIV}}},{\footnotesize{\texttt{age}}}\}
|\mathcal{G}|={4}
n={1152},d={26}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={1341},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={5289},d={49}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}},{%
\footnotesize{\texttt{race}}}\}
|\mathcal{G}|={8}
n={29211},d={72}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={120641},d={84}
\mathcal{G}=\{{\footnotesize{\texttt{age}}},{\footnotesize{\texttt{sex}}}\}
|\mathcal{G}|={6}
n={7797},d={36}
\mathcal{G}=\{{\footnotesize{\texttt{HIV}}},{\footnotesize{\texttt{age}}}\}
|\mathcal{G}|={4}
