\{v_{1},v_{2},\dots,v_{6}\}
\{v_{1},v_{2},\dots,v_{6}\}
\pi
A_{1}
A_{2}
\{I_{1},I_{2},\dots,I_{6}\}
A_{1}
A_{2}
\{I_{1},I_{2},\dots,I_{6}\}
\mathcal{I}=\{I_{1},I_{2},\dots,I_{t},\dots,I_{m}\}
I_{t}
t
\mathcal{A}=\{A_{1},A_{2},\dots,A_{k},\dots,A_{n}\}
A_{k}
k
\mathcal{S}=\{S_{1},S_{2},\dots,S_{k},\dots,S_{n}\}
S_{k}
A_{k}
\alpha
A_{k}=\{u_{k,1},\dots,u_{k,h},\dots,u_{k,\alpha}\}
u_{k,h}
h
A_{k}
S_{k}
A_{k}
I_{t+1}
A_{k}
S_{k}
\displaystyle P(I_{t+1}|S_{k},A_{k})\sim f(S_{k},A_{k}),
\displaystyle P(I_{t+1}|S_{k},A_{k})\sim f(S_{k},A_{k}),
P(I_{t+1}|S_{k},A_{k})
I_{t+1}
A_{k}
S_{k}
f(S_{k},A_{k})
\mathcal{G}=\{\mathcal{V},\mathcal{E}\}
\mathcal{V}
\mathcal{E}
\mathcal{E}
\mathcal{M}\in\mathbb{R}^{(m+n)\times(m+n)}
\mathcal{G}
\mathcal{M}=\begin{bmatrix}\mathbf{M}_{S}&\mathbf{M}_{I}\\
\mathbf{M}_{I}^{\top}&\mathbf{0}\\
\end{bmatrix},
\mathbf{M}_{S}\in\mathbb{R}^{m\times m}
M_{ij}=1
I_{j}
I_{i}
M_{ij}=0
\mathbf{M}_{I}\in\mathbb{R}^{m\times n}
M_{kl}=1
A_{k}
I_{l}
M_{kl}=0
\mathbf{E}_{I}^{(0)}\in\mathbb{R}^{m\times d_{1}}
\mathbf{E}_{A}^{(0)}\in\mathbb{R}^{n\times d_{1}}
\mathbf{E}_{I}^{(0)}
\mathbf{C}_{I}^{(0)}\in\mathbb{R}^{m\times d_{2}}
\mathbf{E}_{I}^{(0)}
\mathcal{O}(N\times d^{2})
\mathbf{C}_{I}^{(0)}=\mathbf{Q}\left(\text{softmax}\left(\frac{{\mathbf{K}}^{%
\top}\mathbf{V}}{\sqrt{d_{1}}}\right)\right)\mathbf{W}_{l}+\mathbf{b}_{l},
\mathbf{W}_{l}\in\mathbb{R}^{d_{1}\times d_{2}}
\mathbf{b}_{l}\in\mathbb{R}^{1\times d_{2}}
\mathbf{E}_{A}^{(0)}
\mathbf{C}_{A}^{(0)}\in\mathbb{R}^{n\times\alpha\times d_{2}}
\mathbf{C}_{A}^{(0)}=\mathbf{E}_{A}^{(0)}\ast\mathbf{W}_{c}+\mathbf{b}_{c},
\ast
\mathbf{W}_{c}\in\mathbb{R}^{d_{1}\times\alpha\times d_{2}}
\mathbf{b}_{c}\in\mathbb{R}^{1\times\alpha\times d_{2}}
\alpha
\mathbf{C}_{A_{k}}^{(0)}\in\mathbb{R}^{\alpha\times d_{2}}
\alpha
\mathbf{C}_{u_{k}}^{(0)}\in\mathbb{R}^{d_{2}}
A_{k}
h
A_{k}
\mathbf{C}_{u_{k,h}}
a_{I_{j}}
\mathbf{C}_{I_{j}}
\mathbf{C}_{u_{k,h}}
a_{I_{j}}=\frac{\exp\left(\mathbf{C}_{u_{k,h}}\cdot\mathbf{C}_{I_{j}}\right)}{%
\sum_{I_{j}\in\mathcal{N}^{A_{k}}_{I}}\sqrt{\exp\left(\mathbf{C}_{u_{k,h}}%
\cdot\mathbf{C}_{I_{j}}\right)}},
\mathcal{N}^{A_{k}}_{I}
A_{k}
u_{k,h}
l
\mathbf{m}_{u_{k,h}\leftarrow I_{j}}^{(l)}=\mathbf{W}_{1}^{(l)}\mathbf{C}_{I_{%
j}}^{(l-1)}+\mathbf{W}_{2}^{(l)}(a_{I_{j}}^{(l-1)}\mathbf{C}_{I_{j}}^{(l-1)}),
\mathbf{m}_{u_{k,h}\leftarrow I_{j}}^{(l)}
\mathbf{W}_{1}^{(l)}
I_{j}
\mathbf{W}_{2}^{(l)}
\mathbf{C}_{u_{k,h}}^{(l)}
\mathbf{m}^{(l)}_{u_{k,h}\leftarrow u_{k,h}}=\mathbf{W}_{3}^{(l)}\mathbf{C}_{u%
_{k,h}}^{(l-1)},
\mathbf{m}^{(l)}_{u_{k,h}\leftarrow u_{k,h}}
(l-1)
\mathbf{W}_{3}^{(l)}
\mathbf{C}_{u_{k,h}}^{(l-1)}
\hat{\mathbf{C}}_{u_{k,h}}^{(l)}
u_{k,h}
\hat{\mathbf{C}}_{u_{k,h}}^{(l)}=\sum_{I_{j}\in\mathcal{N}^{u_{k,h}}_{I}}%
\mathbf{m}^{(l)}_{u_{k,h}\leftarrow I_{j}}+\mathbf{m}^{(l)}_{u_{k,h}\leftarrow
u%
_{k,h}},
\mathcal{N}^{u_{k,h}}_{I}
u_{k,h}
\mathbf{C}_{I_{j}}
l
\displaystyle\mathbf{m}^{(l)}_{I_{j}\leftarrow u_{k,g}}=\mathbf{W}^{(l)}_{4}%
\mathbf{C}^{(l-1)}_{u_{k,g}};\quad\mathbf{m}^{(l)}_{I_{j}\leftarrow I_{j-1}}=%
\mathbf{W}^{(l)}_{5}\mathbf{C}^{(l-1)}_{I_{j-1}},
\displaystyle\mathbf{m}^{(l)}_{I_{j}\leftarrow u_{k,g}}=\mathbf{W}^{(l)}_{4}%
\mathbf{C}^{(l-1)}_{u_{k,g}};\quad\mathbf{m}^{(l)}_{I_{j}\leftarrow I_{j-1}}=%
\mathbf{W}^{(l)}_{5}\mathbf{C}^{(l-1)}_{I_{j-1}},
u_{k,g}
I_{j}
\mathbf{m}^{(l)}_{I_{j}\leftarrow u_{k,g}}
u_{k,g}
I_{j}
I_{j-1}
I_{j}
\mathbf{m}^{(l)}_{I_{j}\leftarrow I_{j-1}}
I_{j-1}
I_{j}
\mathbf{W}^{(l)}_{4}
\mathbf{W}^{(l)}_{5}
\hat{\mathbf{C}}^{(l)}_{I_{j}}
I_{j}
\hat{\mathbf{C}}^{(l)}_{I_{j}}=\sum_{u_{k,g}\in\mathcal{N}^{I_{j}}_{u}}\mathbf%
{m}^{(l)}_{I_{j}\leftarrow u_{k,g}}+\sum_{I_{j-1}\in\mathcal{N}^{I_{j}}_{I}}%
\mathbf{m}^{(l)}_{I_{j}\leftarrow I_{j-1}},
\mathcal{N}^{I_{j}}_{u}
I_{j}
\mathcal{N}^{I_{j}}_{I}
I_{j}
I_{j}
u_{k,h}
\mathbf{E}_{I_{j}}=\sum_{l=0}^{L}\hat{\mathbf{C}}_{I_{j}}^{(l)};\quad\mathbf{E%
}_{u_{k,h}}=\sum_{l=0}^{L}\hat{\mathbf{C}}_{u_{k,h}}^{(l)},
L
b_{p}
\theta
\theta
\theta
j
\tilde{\mathbf{C}}_{A_{k}}^{(j)}=\sum_{h}^{A_{k}}\text{squash}\left(\sum_{p}b_%
{p}^{(j-1)}\mathbf{E}_{u_{k,h}}\right),
\tilde{\mathbf{C}}_{A_{k}}^{(j)}
A_{k}
\text{squash}(\cdot)
b_{p}
j
b_{p}^{(j)}=b_{p}^{(j-1)}+\mathbf{W}_{d}\sum_{h}^{A_{k}}\left(\mathbf{E}_{u_{k%
,h}}\odot\tilde{\mathbf{C}}_{A_{k}}^{(j)}\right),
\mathbf{W}_{d}
\odot
\mathbf{E}_{A}=\sum_{A_{k}\in\mathcal{A}}\tilde{\mathbf{C}}_{A_{k}}^{(\theta)}%
;\quad\mathbf{E}_{S}=\sum_{S_{k}\in\mathcal{S}}\sum_{I_{j}\in S_{k}}\mathbf{E}%
_{I_{j}}.
\mathbf{E}_{S}
S_{k}\in\mathcal{S}
\mathbf{E}_{S_{k}}\in\mathbb{R}^{n\times d_{2}}
\mathbf{D}=\{\mathbf{d}_{1},\mathbf{d}_{2},\dots,\mathbf{d}_{j},\dots,\mathbf{%
d}_{\alpha}\}\in\mathbb{R}^{\alpha\times d_{2}}
\mathbf{E}_{S_{k}}
s_{ij}=\frac{\left\|\mathbf{e}_{i}^{\top}\mathbf{d}_{j}\right\|_{F}^{2}+%
\lambda d_{2}}{\sum_{j}\left(\left\|\mathbf{e}_{i}^{\top}\mathbf{d}_{j}\right%
\|_{F}^{2}+\lambda d_{2}\right)},
s_{ij}
i
\mathbf{e}_{i}
S_{k}
j
\mathbf{d}_{j}
\lambda
\lambda
N\times d^{2}
\mathbf{e}_{i}\in\mathbb{R}^{1\times d_{2}}
\mathbf{z}_{i}=\mathbf{e}_{i}\cdot s_{ij},
\mathbf{z}_{i}\in\mathbf{Z}_{S_{k}}
i
S_{k}
\mathbf{Z}_{S_{k}}\in\mathbb{R}^{n\times d_{2}}
S_{k}
\mathbf{Z}_{S_{k}}
\mathbf{\hat{E}}_{S_{k}}
\mathcal{L}_{C}^{S_{k}}=-\sum_{\mathbf{z}_{i}\in\mathbf{Z}_{S_{k}}}^{\mathbf{%
\hat{e}}_{i}\in\mathbf{\hat{E}}_{S_{k}}}\log\left(\frac{\text{exp}(\mathbf{%
\hat{e}}_{i}\odot\mathbf{z}_{i}/\beta)}{\sum_{j\in\mathcal{I}}\text{exp}(%
\mathbf{\hat{e}}_{i}\odot\mathbf{z}_{j}/\beta)}\right),
\mathcal{L}_{C}^{S_{k}}
S_{k}
\mathbf{\hat{e}}_{i}
\mathbf{z}_{i}
\mathbf{\hat{e}}_{i}
\mathbf{z}_{j}
\beta
\mathcal{L}_{C}=\sum_{S_{k}\in\mathcal{S}}\mathcal{L}_{C}^{S_{k}}.
\mathbf{\hat{E}}_{S}=\sum_{S_{k}\in\mathcal{S}}\text{Norm}\left(\mathbf{\hat{E%
}}_{S_{k}}+\mathbf{W}_{s}\mathbf{Z}_{S_{k}}\right),
\mathbf{\hat{E}}_{S}
\mathbf{W}_{s}
P(I_{t+1}|\mathcal{S},\mathcal{A})=\text{softmax}\left(\mathbf{W}_{f}\cdot[%
\mathbf{\hat{E}}_{S},\mathbf{E}_{A}]^{\top}+\mathbf{b}_{f}\right),
\mathbf{W}_{f}
\mathbf{b}_{f}
\mathcal{L}_{S}=-\frac{1}{|\mathcal{S}|}\sum_{I_{t+1}\in\mathcal{I}}\text{log}%
P(I_{t+1}|\mathcal{S},\mathcal{A}).
\mathcal{L}=\mathcal{L}_{S}+\gamma\mathcal{L}_{C},
\gamma
\%
\%
\pi
\%
\%
N
N
N=\{5,20\}
\pi
\pi
\pi
\pi
{}_{w/o\text{LA}}
{}_{w/o\text{DR}}
{}_{w/o\text{C}}
{}_{w/o\text{CL}}
{}_{w/o\text{S}}
{}_{w/o\text{A}}
(\%)
(\%)
{}_{w/o\text{C}}
{}_{w/o\text{S}}
{}_{w/o\text{LA}}
{}_{w/o\text{DR}}
{}_{w/o\text{CL}}
{}_{w/o\text{A}}
{}_{w/o\text{C}}
{}_{w/o\text{A}}
{}_{w/o\text{LA}}
{}_{w/o\text{DR}}
{}_{w/o\text{S}}
{}_{w/o\text{CL}}
\alpha
\beta
\gamma
\alpha
\beta
\gamma
\alpha
\alpha
\{1,2,3,4,5\}
\beta
\gamma
\mathbf{E}_{I}^{(0)}
\mathbf{E}_{A}^{(0)}
\mathbf{C}_{I}^{(0)}
\mathbf{C}_{A}^{(0)}
\mathbf{C}_{u_{k,h}}
h
A_{k}
\mathbf{C}_{I_{j}}
j
u_{k,h}
\mathbf{m}_{u_{k,h}\leftarrow I_{j}}
\mathbf{C}_{u_{k,h}}
\mathbf{m}_{u_{k,h}\leftarrow u_{k,h}}
\mathbf{C}_{u_{k,h}}
\mathbf{m}_{I_{j}\leftarrow u_{k,g}}
\mathbf{C}_{I_{j}}
\mathbf{m}_{I_{j}\leftarrow I_{j-1}}
\mathbf{C}_{I_{j}}
\tilde{\mathbf{C}}_{A_{k}}
\mathbf{E}_{A}
\mathbf{E}_{S}
\mathbf{Z}_{S_{k}}
S_{k}
\mathbf{\hat{E}}_{S_{k}}
S_{k}
\mathbf{\hat{E}}_{S}
\pi
\pi
\mathcal{M}
\mathbf{E}_{I}^{(0)}
\mathbf{E}_{A}^{(0)}
\mathbf{E}_{S}
\mathbf{E}_{A}
\mathcal{G}_{c}
\mathbf{E}_{I}^{(0)}
\mathbf{C}_{I}^{(0)}
\mathbf{E}_{A}^{(0)}
\mathbf{C}_{A}^{(0)}
\mathbf{C}_{A}^{(0)}
\alpha
\mathbf{C}_{u}^{(0)}
l=0\rightarrow L
\mathbf{C}^{(l)}_{u_{k,h}}
\mathbf{m}^{(l)}_{u_{k,h}\leftarrow I_{j}}
\mathbf{m}^{(l)}_{u_{k,h}\leftarrow u_{k,h}}
\mathbf{C}^{(l)}_{I_{j}}
\mathbf{m}^{(l)}_{I_{j}\leftarrow u_{k,g}}
\mathbf{m}^{(l)}_{I_{j}\leftarrow I_{j-1}}
\mathbf{C}_{u_{k,h}}^{(l)}
\mathbf{C}_{I_{j}}^{(l)}
b_{p}
\theta=0\rightarrow\theta
\tilde{\mathbf{C}}_{A_{k}}^{(\theta)}
b^{(\theta)}_{p}
\mathbf{E}_{A}
\mathbf{E}_{S}
\mathbf{E}_{S}
\hat{\mathbf{E}}_{S}
\mathbf{E}_{S}
\mathbf{D}=\{\mathbf{d}_{1},\mathbf{d}_{2},\dots,\mathbf{d}_{j},\dots,\mathbf{%
d}_{\alpha}\}
S_{k}\in\mathcal{S}
s_{ij}
\mathbf{E}_{S_{k}}
\mathbf{D}
s_{ij}
\mathbf{E}_{S_{k}}
\mathcal{L}_{C}^{S_{k}}
\mathbf{Z}_{S_{k}}
\mathbf{\hat{E}}_{S_{k}}
\mathcal{L}_{C}
\hat{E}_{S}
{}_{w/o\text{C}}
{}_{w/o\text{S}}
{}_{w/o\text{A}}
{}_{w/o\text{C}}
{}_{w/o\text{S}}
L
L
L=2
L
L
L
L
L
