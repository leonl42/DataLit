h
u_{s}
u_{c,j}
p
r
sim
\sigma
+
\times
h
u_{s}
u_{c,j}
p
r
sim
\sigma
+
\times
X=\{x_{1},x_{2},...,x_{t}\}
x=\left\langle q,\{s|s\in N_{q}\},a,t\right\rangle
a
q
s
t
a\in\{0,1\}
1
0
t+1
p
p
e
e_{t}=s_{t}+a_{t}\times E
E
h_{t}
e_{t}
t
h_{t-1}
t-1
z_{t}
r_{t}
\tilde{h}_{t}
h_{t}
\displaystyle z_{t}=\sigma(W_{z}[h_{t-1},e_{t}]+b_{z}),
\displaystyle z_{t}=\sigma(W_{z}[h_{t-1},e_{t}]+b_{z}),
\displaystyle r_{t}=\sigma(W_{r}[h_{t-1},e_{t}]+b_{r}),
\displaystyle r_{t}=\sigma(W_{r}[h_{t-1},e_{t}]+b_{r}),
\displaystyle\tilde{h}_{t}=tanh(W_{h}[r_{t}\odot h_{t-1},e_{t}]+b_{h}),
\displaystyle\tilde{h}_{t}=tanh(W_{h}[r_{t}\odot h_{t-1},e_{t}]+b_{h}),
\displaystyle h_{t}=(1-z_{t})\odot h_{t-1}+z_{t}\odot\tilde{h}_{t}
\displaystyle h_{t}=(1-z_{t})\odot h_{t-1}+z_{t}\odot\tilde{h}_{t}
W_{z}
W_{r}
W_{h}
b_{z}
b_{r}
b_{h}
\sigma
\odot
[h_{t-1},x_{t}]
h_{t-1}
x_{t}
u_{s}
u_{s}=\frac{1}{N_{s}}\sum_{j=1}^{N_{s}}h_{i}
N_{s}
h_{t}
\displaystyle a_{t,j}=h_{t}W_{a,j},
\displaystyle a_{t,j}=h_{t}W_{a,j},
\displaystyle\alpha_{t,j}=\frac{exp(a_{t,j})}{\sum_{i=1}^{N_{s}}exp(a_{i,j})},
\displaystyle\alpha_{t,j}=\frac{exp(a_{t,j})}{\sum_{i=1}^{N_{s}}exp(a_{i,j})},
\displaystyle u_{c,j}=\sum_{i=1}^{N_{s}}\alpha_{t,j}h_{t},
\displaystyle u_{c,j}=\sum_{i=1}^{N_{s}}\alpha_{t,j}h_{t},
W_{a,j}
j
a_{t,j}
h_{t}
W_{a,j}
\alpha_{t,j}=[\alpha_{1,j},\alpha_{2,j},...,\alpha_{N_{s},j}]
u_{c,j}
p
\displaystyle p_{j}=\sigma(W_{p,j}u_{c,j}+b_{p,j}),
\displaystyle p_{j}=\sigma(W_{p,j}u_{c,j}+b_{p,j}),
\displaystyle p=mean(stack(\sum_{j=1}^{N_{c}}p_{j}))
\displaystyle p=mean(stack(\sum_{j=1}^{N_{c}}p_{j}))
W_{p,j}
b_{p,j}
N_{c}
u_{c,j}
u_{c,j}
p_{j}
\displaystyle r_{s,j}=p_{j}u_{c,j},
\displaystyle r_{s,j}=p_{j}u_{c,j},
\displaystyle r=max(stack(\sum_{j=1}^{N_{c}}r_{s,j}))
\displaystyle r=max(stack(\sum_{j=1}^{N_{c}}r_{s,j}))
sim=\sigma(u_{s}r)
L_{CI}=-\alpha_{CI}(1-p)^{\gamma}\log(p)
\alpha_{CI}
\gamma
\gamma\geq 0
L_{KT}=\sum_{t=1}^{T}(\alpha_{KT}\log(p)+(1-\alpha_{KT})\log(1-p))
sim
L_{RR}=\sum_{t=1}^{T}(\alpha_{RR}\log(sim)+(1-\alpha_{RR})\log(1-sim))
L=L_{KT}+\lambda_{RR}L_{RR}+\lambda_{CI}L_{CI}
\lambda_{RR}
\lambda_{CI}
sim
