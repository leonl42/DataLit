S\geq\lVert\bm{\theta}_{\star}\rVert_{2}
\bm{\theta}_{\star}\in{\mathbb{R}}^{d}
S
S\geq d
S
S
d
T
S
\sqrt{dT}+d^{3}\kappa(T)^{2}
dS^{\frac{3}{2}}\sqrt{\frac{T}{\kappa_{\star}(T)}}+\min\left\{d^{2}S^{3}\kappa%
_{\mathcal{X}}(T),R_{\mathcal{X}}(T)\right\}
dS^{\frac{5}{2}}\sqrt{\frac{T}{\kappa_{\star}(T)}}+\min\left\{d^{2}S^{4}\kappa%
_{\mathcal{X}}(T),R_{\mathcal{X}}(T)\right\}
dS\sqrt{\frac{T}{\kappa_{\star}(T)}}+d^{2}S^{6}\kappa(T)
dS\sqrt{\frac{T}{\kappa_{\star}(T)}}+\min\left\{d^{2}S^{2}\kappa_{\mathcal{X}}%
(T),R_{\mathcal{X}}(T)\right\}
dK^{\frac{3}{4}}S\sqrt{\kappa(T)T}
dK^{\frac{5}{4}}S^{\frac{3}{2}}\left(\sqrt{T}+dK^{\frac{5}{4}}S\kappa(T)\right)
d\sqrt{KS\kappa(T)T}
d\sqrt{K}S\left(\sqrt{T}+dK^{\frac{3}{2}}\sqrt{S}\kappa(T)\right)
\kappa_{\star}(T)
\kappa_{\mathcal{X}}(T)
\kappa(T)
d
T
K
S
R_{{\mathcal{X}}}(T)
\kappa_{\mathcal{X}}(T)
|{\mathcal{X}}|<\infty
\kappa_{\star}(T)
\kappa_{\mathcal{X}}(T)
\kappa(T)
d
T
K
S
R_{{\mathcal{X}}}(T)
\kappa_{\mathcal{X}}(T)
|{\mathcal{X}}|<\infty
t
{\mathcal{X}}_{t}\subset{\mathbb{R}}^{d}
{\bm{x}}_{t}\in{\mathcal{X}}_{t}
r_{t}\sim\mathrm{Bernoulli}(\mu(\langle{\bm{x}}_{t},\bm{\theta}_{\star}\rangle))
\bm{\theta}_{\star}\in{\mathbb{R}}^{d}
\mu(z)=(1+e^{-z})^{-1}
\mathrm{Reg}^{B}(T):=\sum_{t=1}^{T}\left\{\mu(\langle{\bm{x}}_{t,\star},\bm{%
\theta}_{\star}\rangle)-\mu(\langle{\bm{x}}_{t},\bm{\theta}_{\star}\rangle)%
\right\},
{\bm{x}}_{t,\star}:=\operatorname*{arg\,max}_{{\bm{x}}\in{\mathcal{X}}_{t}}\mu%
(\langle{\bm{x}},\bm{\theta}_{\star}\rangle)
t
\bm{x}\in{\mathbb{R}}^{d}
{\mathcal{C}}_{t}
\bm{\theta}_{\star}
\max_{\bm{\theta}\in{\mathcal{C}}_{t}}\langle\bm{x},\bm{\theta}\rangle
{\mathcal{C}}_{t}
\displaystyle{\mathcal{C}}_{t}=\left\{\bm{\theta}:\|{\bm{\theta}}\|_{2}\leq S,%
\bar{\mathcal{L}}_{t}({\bm{\theta}})-\bar{\mathcal{L}}_{t}(\widehat{\bm{\theta%
}}_{t})\leq\beta_{t}(\delta)^{2}\right\}
\displaystyle{\mathcal{C}}_{t}=\left\{\bm{\theta}:\|{\bm{\theta}}\|_{2}\leq S,%
\bar{\mathcal{L}}_{t}({\bm{\theta}})-\bar{\mathcal{L}}_{t}(\widehat{\bm{\theta%
}}_{t})\leq\beta_{t}(\delta)^{2}\right\}
\bar{\mathcal{L}}_{t}
\widehat{\bm{\theta}}_{t}
t
\beta_{t}
t
{\mathcal{C}}_{t}
\bar{\mathcal{L}}_{t}
\beta_{t}(\delta)^{2}={\mathcal{O}}(dS^{3}\log(t))
\beta_{t}^{2}={\mathcal{O}}(d\log(t)+S)
{\mathcal{O}}(dS\log(t))
S
\sqrt{S}
S
S^{4}
\kappa
\sqrt{S}
\sqrt{K}
A\lesssim B
A\leq cB
c
n
[n]:=\{1,2,\cdots,n\}
\Delta_{>0}^{K}
(K-1)
{\mathcal{B}}^{d}(S)
d
S
{\mathcal{B}}^{K\times d}(S)
S
{\mathbb{R}}^{K\times d}
{\bm{A}}
{\bm{B}}
\lambda_{\min}({\bm{A}})
\lambda_{\max}({\bm{A}})
{\bm{A}}
\succeq
{\bm{A}}\succeq{\bm{B}}
{\bm{A}}-{\bm{B}}
\text{Categorical}(\bm{\mu})
(K+1)
\{0,1,\ldots,K\}
\bm{\mu}:=[\mu_{i}]_{i\in[K]}\in[0,1]^{K}
\mu_{i}\in{\mathbb{R}}
i\in[K]
\mu_{0}=1-\sum_{i}\mu_{i}
\mathrm{KL}(\bm{\mu}_{1},\bm{\mu}_{2})
\text{Categorical}(\bm{\mu}_{1})
\text{Categorical}(\bm{\mu}_{2})
s\geq 1
{\mathcal{F}}_{s}:=\sigma\left(\left\{{\bm{x}}_{1},r_{1},\cdots,{\bm{x}}_{s},r%
_{s},{\bm{x}}_{s+1}\right\}\right)
{\mathcal{X}}_{t}\subseteq{\mathcal{B}}^{d}(1)
t\geq 1
\bm{\theta}_{\star}\in{\mathcal{B}}^{d}(S)
S>0
\displaystyle\kappa_{\star}(T)\!:=\!\frac{1}{\frac{1}{T}\sum_{t=1}^{T}\dot{\mu%
}({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})},\ \kappa_{{\mathcal{X}}}%
(T)\!:=\!\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\frac{1}{\dot{\mu}({%
\bm{x}}^{\intercal}\bm{\theta}_{\star})},
\displaystyle\kappa_{\star}(T)\!:=\!\frac{1}{\frac{1}{T}\sum_{t=1}^{T}\dot{\mu%
}({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})},\ \kappa_{{\mathcal{X}}}%
(T)\!:=\!\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\frac{1}{\dot{\mu}({%
\bm{x}}^{\intercal}\bm{\theta}_{\star})},
\displaystyle\text{and~{}~{}}\kappa(T):=\max_{t\in[T]}\max_{{\bm{x}}\in{%
\mathcal{X}}_{t}}\max_{\bm{\theta}\in{\mathcal{B}}^{d}(S)}\frac{1}{\dot{\mu}({%
\bm{x}}^{\intercal}\bm{\theta})}~{}.\hskip 50.00008pt
\displaystyle\text{and~{}~{}}\kappa(T):=\max_{t\in[T]}\max_{{\bm{x}}\in{%
\mathcal{X}}_{t}}\max_{\bm{\theta}\in{\mathcal{B}}^{d}(S)}\frac{1}{\dot{\mu}({%
\bm{x}}^{\intercal}\bm{\theta})}~{}.\hskip 50.00008pt
S
\bm{\theta}_{\star}
1-\delta
\widehat{\bm{\theta}}_{t}
\widehat{\bm{\theta}}_{t}:=\operatorname*{arg\,min}_{\lVert\bm{\theta}\rVert_{%
2}\leq S}\sbr{{\mathcal{L}}_{t}(\bm{\theta})\triangleq\sum_{s=1}^{t-1}\ell_{s}%
(\bm{\theta})}~{},
\ell_{s}
s
\ell_{s}(\bm{\theta}):=-r_{s}\log\mu(\langle{\bm{x}}_{s},\bm{\theta}\rangle)-(%
1-r_{s})\log(1-\mu(\langle{\bm{x}}_{s},\bm{\theta}\rangle)).
{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})%
\leq\beta_{t}(\delta)^{2}
{\mathcal{L}}_{t}
\beta_{t}(\delta)
\widehat{\bm{\theta}}_{t}
{\mathcal{B}}^{d}(S)
\widehat{\bm{\theta}}_{t}
\displaystyle{\mathbb{P}}\left[\forall t\geq 1,\ \bm{\theta}_{\star}\in{%
\mathcal{C}}_{t}(\delta)\right]\geq 1-\delta,
\displaystyle{\mathbb{P}}\left[\forall t\geq 1,\ \bm{\theta}_{\star}\in{%
\mathcal{C}}_{t}(\delta)\right]\geq 1-\delta,
\displaystyle{\mathcal{C}}_{t}(\delta)=\left\{\bm{\theta}\in{\mathcal{B}}^{d}(%
S):{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})%
\leq\beta_{t}(\delta)^{2}\right\},
\displaystyle{\mathcal{C}}_{t}(\delta)
\displaystyle=\left\{\bm{\theta}\in{\mathcal{B}}^{d}(S):{\mathcal{L}}_{t}(\bm{%
\theta})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})\leq\beta_{t}(\delta)^{2}%
\right\},
\displaystyle\beta_{t}(\delta)=\sqrt{10d\log\left(\frac{St}{4d}+e\right)+2((e-%
2)+S)\log\frac{1}{\delta}}.
\displaystyle\beta_{t}(\delta)
\displaystyle=\sqrt{10d\log\left(\frac{St}{4d}+e\right)+2((e-2)+S)\log\frac{1}%
{\delta}}.
\beta_{t}(\delta)={\mathcal{O}}(\sqrt{dS^{3}\log t})
{\mathcal{O}}(\sqrt{(d+S)\log t})
d
S
S
\bm{\theta}^{\prime}
{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\bm{\theta}^{\prime})\leq{%
\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})\leq%
\beta_{t}(\delta)^{2}
{\mathcal{L}}_{t}(\bm{\theta})
\bm{\theta}_{\star}\in{\mathcal{C}}_{t}(\delta)
\widehat{\bm{\theta}}_{t}
\beta_{t}(\delta)^{2}
S
r_{s}=\mu(\langle{\bm{x}}_{s},\bm{\theta}_{\star}\rangle)+\xi_{s},
\xi_{s}
\ell_{s}
\bm{\theta}
\ell_{s}(\bm{\theta}_{\star})=\ell_{s}(\bm{\theta})+\xi_{s}\langle{\bm{x}}_{s}%
,\bm{\theta}-\bm{\theta}_{\star}\rangle-\mathrm{KL}(\mu_{s}(\bm{\theta}_{\star%
}),\mu_{s}(\bm{\theta})).
\bm{\theta}
\{\tilde{\bm{\theta}}_{s}\}
\tilde{\bm{\theta}}_{s}
{\bm{x}}
\ell_{s}
\sum_{s=1}^{t}\ell_{s}(\bm{\theta}_{\star})-\ell_{s}(\widehat{\bm{\theta}}_{t}%
)\leq\mathrm{Reg}^{O}(t)+\zeta_{1}(t)-\zeta_{2}(t),
\mathrm{Reg}^{O}(t):=\sum_{s=1}^{t}\ell_{s}(\tilde{\bm{\theta}}_{s})-\sum_{s=1%
}^{t}\ell_{s}(\widehat{\bm{\theta}}_{t})
t
\zeta_{1}(t):=\sum_{s=1}^{t}\xi_{s}\langle{\bm{x}}_{s},\bm{\theta}_{\star}-%
\tilde{\bm{\theta}}_{s}\rangle
\zeta_{2}(t):=\sum_{s=1}^{t}\mathrm{KL}(\mu_{s}(\bm{\theta}_{\star}),\mu_{s}(%
\tilde{\bm{\theta}}_{s}))
\mathrm{Reg}^{O}(t)
S
\mathrm{Reg}^{O}(t)\leq 10d\log\left(e+\frac{St}{2d}\right).
S
\hat{{\bm{z}}}_{s}=(\hat{z}_{0},\hat{z}_{1})
{\bm{x}}_{s}
s
\tilde{\bm{\theta}}_{s}\in{\mathcal{B}}^{d}(S)
\bm{\sigma}(\widehat{{\bm{z}}}_{s})=\bm{\sigma}\left((\langle{\bm{x}}_{s},%
\tilde{\bm{\theta}}_{s}\rangle)\right)
\bm{\sigma}:{\mathbb{R}}^{1}\rightarrow\Delta_{>0}^{2}
\bm{\sigma}(z_{1})=\left(\frac{1}{1+e^{z_{1}}},\frac{e^{z_{1}}}{1+e^{z_{1}}}\right)
(K+1)
\zeta_{1}(t)
{\mathcal{F}}_{s}=\sigma\left(\left\{{\bm{x}}_{1},r_{1},\cdots,{\bm{x}}_{s},r_%
{s},{\bm{x}}_{s+1}\right\}\right)
{\bm{x}}_{s}
\tilde{\bm{\theta}}_{s}
{\mathcal{F}}_{s-1}
\xi_{s}
{\mathcal{F}}_{s-1}
\displaystyle|\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{\theta}_{%
\star}\rangle|\leq 2S,
\displaystyle|\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{\theta}_{%
\star}\rangle|
\displaystyle\leq 2S,
\displaystyle\mathbb{E}[\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm%
{\theta}_{\star}\rangle|{\mathcal{F}}_{s-1}]=0,
\displaystyle\mathbb{E}[\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm%
{\theta}_{\star}\rangle|{\mathcal{F}}_{s-1}]
\displaystyle=0,
\mathbb{E}[\xi_{s}^{2}\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde{\bm{%
\theta}}_{s}\rangle^{2}|{\mathcal{F}}_{s-1}]=\dot{\mu}({\bm{x}}_{s}^{\intercal%
}\bm{\theta}_{\star})\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{\theta}_{%
\star}\rangle^{2}.
t\geq 1
X_{1},\cdots,X_{t}
\max_{s}|X_{s}|\leq R
{\mathcal{F}}_{s}
\sigma
(X_{1},\cdots,X_{s})
\delta\in(0,1)
\eta\in[0,1/R]
1-\delta
\sum_{s=1}^{t}X_{s}\leq(e-2)\eta\sum_{s=1}^{t}\mathbb{E}[X_{s}^{2}|{\mathcal{F%
}}_{s-1}]+\frac{1}{\eta}\log\frac{1}{\delta},\quad\forall t\geq 1.
Z_{0}=1
Z_{t}=Z_{t-1}\cdot\exp(\lambda X_{t}-(e-2)\lambda^{2}\operatorname{\mathbb{E}}%
[X_{t}^{2}\mid{\mathcal{F}}_{t-1}]),\forall t\geq 1
(Z_{t})_{t=0}^{\infty}
\eta\in\left[0,\frac{1}{2S}\right]
1-\delta
t\geq 1
\zeta_{1}(t)\!\leq\!(e-2)\eta\!\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal%
}\bm{\theta}_{\star})\langle{\bm{x}}_{s},\bm{\theta}_{\star}\!-\!\tilde{\bm{%
\theta}}_{s}\rangle^{2}\!+\!\frac{1}{\eta}\log\frac{1}{\delta}.
\zeta_{2}(t)
m:{\mathcal{Z}}\rightarrow{\mathbb{R}}
D_{m}(\cdot,\cdot)
D_{m}({\bm{z}}_{1},{\bm{z}}_{2})=m({\bm{z}}_{1})-m({\bm{z}}_{2})-\nabla m({\bm%
{z}}_{2})^{\intercal}({\bm{z}}_{1}-{\bm{z}}_{2})
{\mathcal{Z}}={\mathbb{R}}
D_{m}(z_{1},z_{2})=\int_{z_{2}}^{z_{1}}m^{\prime\prime}(z)(z_{1}-z)dz.
m(z):=\log(1+e^{z})
\mu(z)=\frac{1}{1+e^{-z}}
\mathrm{KL}(\mu(z_{2}),\mu(z_{1}))=D_{m}(z_{1},z_{2})
m^{\prime\prime}(z)=\dot{\mu}(z)
\displaystyle\mathrm{KL}(\mu_{t}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star}))%
,\mu({\bm{x}}_{s}^{\intercal}\tilde{\bm{\theta}}_{s}))
\displaystyle\mathrm{KL}(\mu_{t}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star}))%
,\mu({\bm{x}}_{s}^{\intercal}\tilde{\bm{\theta}}_{s}))
\displaystyle=D_{m}({\bm{x}}_{s}^{\intercal}\tilde{\bm{\theta}}_{s},{\bm{x}}_{%
s}^{\intercal}\bm{\theta}_{\star})
\displaystyle=D_{m}({\bm{x}}_{s}^{\intercal}\tilde{\bm{\theta}}_{s},{\bm{x}}_{%
s}^{\intercal}\bm{\theta}_{\star})
\displaystyle=\int_{{\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star}}^{{\bm{x}}_{s}%
^{\intercal}\tilde{\bm{\theta}}_{s}}\dot{\mu}(z)({\bm{x}}_{s}^{\intercal}%
\tilde{\bm{\theta}}_{s}-z)dz
\displaystyle=\int_{{\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star}}^{{\bm{x}}_{s}%
^{\intercal}\tilde{\bm{\theta}}_{s}}\dot{\mu}(z)({\bm{x}}_{s}^{\intercal}%
\tilde{\bm{\theta}}_{s}-z)dz
\displaystyle=\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde{\bm{\theta}}_{s}%
\rangle^{2}\int_{0}^{1}(1-v)\dot{\mu}({\bm{x}}_{s}^{\intercal}(\tilde{\bm{%
\theta}}_{s}+(1-v)\bm{\theta}_{\star}))dv
\displaystyle=\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde{\bm{\theta}}_{s}%
\rangle^{2}\int_{0}^{1}(1-v)\dot{\mu}({\bm{x}}_{s}^{\intercal}(\tilde{\bm{%
\theta}}_{s}+(1-v)\bm{\theta}_{\star}))dv
\displaystyle\overset{(*)}{\geq}\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde%
{\bm{\theta}}_{s}\rangle^{2}\frac{\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta%
}_{\star})}{2+|{\bm{x}}_{s}^{\intercal}(\bm{\theta}_{\star}-\tilde{\bm{\theta}%
}_{s})|}
\displaystyle\overset{(*)}{\geq}\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde%
{\bm{\theta}}_{s}\rangle^{2}\frac{\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta%
}_{\star})}{2+|{\bm{x}}_{s}^{\intercal}(\bm{\theta}_{\star}-\tilde{\bm{\theta}%
}_{s})|}
\displaystyle\geq\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde{\bm{\theta}}_{%
s}\rangle^{2}\frac{\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})}{2+2%
S},
\displaystyle\geq\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde{\bm{\theta}}_{%
s}\rangle^{2}\frac{\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})}{2+2%
S},
(*)
f
|\ddot{\mu}|\leq\dot{\mu}
{\mathcal{Z}}\subset{\mathbb{R}}
z_{1},z_{2}\in{\mathcal{Z}}
\int_{0}^{1}(1-v)\dot{f}(z_{1}+v(z_{2}-z_{1}))dv\geq\frac{\dot{f}(z_{1})}{2+|z%
_{1}-z_{2}|}.
\zeta_{2}(t)\geq\frac{1}{2+2S}\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}%
\bm{\theta}_{\star})\langle{\bm{x}}_{s},\bm{\theta}_{\star}-\tilde{\bm{\theta}%
}_{s}\rangle^{2}.
\eta=\frac{1}{2(e-2)+2S}<\frac{1}{2S}
-\frac{1}{2+2S}+\frac{e-2}{2(e-2)+2S}<0
t=1,\dots,T
\widehat{\bm{\theta}}_{t}\leftarrow\operatorname*{arg\,min}_{\lVert\bm{\theta}%
\rVert_{2}\leq S}{\mathcal{L}}_{t}(\bm{\theta})
({\bm{x}}_{t},\bm{\theta}_{t})\leftarrow\operatorname*{arg\,max}_{{\bm{x}}\in{%
\mathcal{X}}_{t},\bm{\theta}\in{\mathcal{C}}_{t}(\delta)}\mu(\langle{\bm{x}},%
\bm{\theta}\rangle)
{\mathcal{C}}_{t}(\delta)
{\bm{x}}_{t}
r_{t}
{\mathcal{C}}_{t}(\delta)
{\mathcal{L}}_{t}
\mu(\cdot)
({\bm{x}}_{t},\bm{\theta}_{t})\in\operatorname*{arg\,max}_{{\bm{x}}\in{%
\mathcal{X}}_{t},\bm{\theta}\in{\mathcal{C}}_{t}(\delta)}\langle{\bm{x}},\bm{%
\theta}\rangle.
1-\delta
\mathrm{Reg}^{B}(T)\lesssim dS\sqrt{\frac{T}{\kappa_{\star}(T)}}+\min\left\{d^%
{2}S^{2}\kappa_{\mathcal{X}}(T),R_{\mathcal{X}}(T)\right\},
R_{\mathcal{X}}(T):=S\sum_{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{%
\theta}_{\star})\mathds{1}[{\bm{x}}_{t}\in{\mathcal{X}}_{-}(t)]
\log\frac{1}{\delta}
{\mathcal{X}}_{-}(t)
t
\widetilde{{\mathcal{O}}}(\sqrt{\kappa(T)T})
\widetilde{{\mathcal{O}}}(\sqrt{T}+\kappa(T))
\lambda_{t}=d\log\frac{t}{\delta}
S
S
\lambda_{t}=\frac{d}{S}\log\frac{1+\frac{St}{d}}{\delta}
\widetilde{{\mathcal{O}}}\left(dS^{\frac{3}{2}}\sqrt{\frac{T}{\kappa_{\star}(T%
)}}+\min\left\{d^{2}S^{3}\kappa_{\mathcal{X}}(T),R_{\mathcal{X}}(T)\right\}\right)
S
\widetilde{{\mathcal{O}}}\left(dS\sqrt{\frac{T}{\kappa_{\star}(T)}}+d^{2}S^{6}%
\kappa(T)\right)
\Omega(1)
dS\sqrt{\frac{T}{\kappa_{\star}(T)}}
\sqrt{S}
\min\{d^{2}S^{2}\kappa_{\mathcal{X}}(T),R_{\mathcal{X}}(T)\}
S
S^{4}
\kappa(T)
{\mathcal{O}}(\kappa d^{2})
\kappa_{\mathcal{X}}(T)
S
S
{\mathcal{O}}(\sqrt{(d+S)\log t})
{\mathcal{O}}(\sqrt{d\log t})
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\bm{\theta}_{\star}
\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{\theta}_{\star})}
{\bm{H}}_{t}(\bm{\theta}_{\star})
\bm{\theta}_{\star}
{\bm{H}}_{t}(\bm{\theta}_{\star}):=\sum_{s=1}^{t-1}\dot{\mu}({\bm{x}}_{s}^{%
\intercal}\bm{\theta}_{\star}){\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}%
{\bm{I}}_{d},
\lambda_{t}>0
{\bm{H}}_{t}
{\bm{H}}_{t}^{-1}
\lambda_{t}
\lambda_{t}
\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{\theta}_{\star})}
S
\varepsilon
S
S
\bm{\theta}
\bm{\theta}_{\star}
\lambda_{t}=\frac{1}{4S^{2}(2+2S)}
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
1-\delta
\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{\theta}_{\star})%
}^{2}\lesssim\gamma_{t}(\delta)^{2}\triangleq S^{2}\left(d\log\left(e+\frac{St%
}{d}\right)+\log\frac{1}{\delta}\right).
1-\delta
{\mathcal{L}}_{t}(\bm{\theta}_{\star})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}%
_{t})\leq\beta_{t}(\delta)^{2}
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
{\mathcal{L}}_{t}(\bm{\theta})
\bm{\theta}_{\star}
{\mathcal{L}}_{t}(\bm{\theta})={\mathcal{L}}_{t}(\bm{\theta}_{\star})+\nabla{%
\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{\theta}-\bm{\theta}_{%
\star})+\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}_{t}(%
\bm{\theta}_{\star},\bm{\theta})-\lambda_{t}{\bm{I}}}^{2},
\lambda_{t}>0
\displaystyle\widetilde{\alpha}({\bm{x}},\bm{\theta}_{1},\bm{\theta}_{2}):=%
\int_{0}^{1}(1-v)\dot{\mu}\left({\bm{x}}^{\intercal}(\bm{\theta}_{1}+v(\bm{%
\theta}_{2}-\bm{\theta}_{1}))\right)dv
\displaystyle\widetilde{\alpha}({\bm{x}},\bm{\theta}_{1},\bm{\theta}_{2})
\displaystyle:=\int_{0}^{1}(1-v)\dot{\mu}\left({\bm{x}}^{\intercal}(\bm{\theta%
}_{1}+v(\bm{\theta}_{2}-\bm{\theta}_{1}))\right)dv
\displaystyle\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{1},\bm{\theta}_{2}):=\sum_{%
s=1}^{t-1}\widetilde{\alpha}({\bm{x}}_{s},\bm{\theta}_{1},\bm{\theta}_{2}){\bm%
{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}{\bm{I}}_{d}.
\displaystyle\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{1},\bm{\theta}_{2})
\displaystyle:=\sum_{s=1}^{t-1}\widetilde{\alpha}({\bm{x}}_{s},\bm{\theta}_{1}%
,\bm{\theta}_{2}){\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}{\bm{I}}_{d}.
\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{1},\bm{\theta}_{2})\succeq\frac{1}{2+2S}%
{\bm{H}}_{t}(\bm{\theta}_{1})
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{%
\theta}_{\star})}^{2}
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{%
\theta}_{\star})}^{2}
\displaystyle\lesssim S\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(%
\bm{\theta}_{\star}-\bm{\theta})+\lambda_{t}\lVert\bm{\theta}-\bm{\theta}_{%
\star}\rVert_{2}^{2}\right)
\displaystyle\lesssim S\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(%
\bm{\theta}_{\star}-\bm{\theta})+\lambda_{t}\lVert\bm{\theta}-\bm{\theta}_{%
\star}\rVert_{2}^{2}\right)
{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})\leq{\mathcal{L}}_{t}(\bm{\theta}_%
{\star})
\lambda_{t}=\frac{1}{4S^{2}(2+2S)}
{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})\leq{\mathcal{L}}_{t}(\bm{\theta}_%
{\star})
\lambda_{t}=\frac{1}{4S^{2}(2+2S)}
{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})\leq{\mathcal{L}}_{t}(\bm{\theta}_%
{\star})
\lambda_{t}=\frac{1}{4S^{2}(2+2S)}
\displaystyle\lesssim S\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(%
\widehat{\bm{\theta}}_{t})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{%
\intercal}(\bm{\theta}_{\star}-\bm{\theta})\right)
\displaystyle\lesssim S\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(%
\widehat{\bm{\theta}}_{t})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{%
\intercal}(\bm{\theta}_{\star}-\bm{\theta})\right)
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\displaystyle\lesssim S\beta_{t}(\delta)^{2}+S\nabla{\mathcal{L}}_{t}(\bm{%
\theta}_{\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}),
\displaystyle\lesssim S\beta_{t}(\delta)^{2}+S\nabla{\mathcal{L}}_{t}(\bm{%
\theta}_{\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}),
1-\delta
\lambda_{t}
t
\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{\theta}_{\star}-%
\bm{\theta})
\bm{\theta}_{\star}-\bm{\theta}\in{\mathcal{B}}^{d}(2S)
\varepsilon
{\mathcal{B}}^{d}(2S)
t
{\mathcal{X}}_{t}
{\bm{x}}_{t}\in{\mathcal{X}}
r_{t}=\bm{\rho}^{\intercal}{\bm{y}}_{t}
\bm{\rho}\in{\mathbb{R}}^{K}
{\bm{y}}_{t}=(y_{t,1},\cdots,y_{t,K})\in\{0,1\}^{K}
\lVert{\bm{y}}_{t}\rVert_{1}\leq 1
y_{s,k}=1
k
s
y_{t,0}:=1-\lVert{\bm{y}}_{t}\rVert_{1}
(y_{0},{\bm{y}}_{t})
{\mathbb{P}}[{\bm{y}}_{t}=\bm{\delta}_{k}|{\bm{x}}_{t}]=\begin{cases}\mu_{k}({%
\bm{x}}_{t},\bm{\Theta}_{\star})&\quad k>0,\\
1-\sum_{j=1}^{K}\mu_{j}({\bm{x}}_{t},\bm{\Theta}_{\star})&\quad k=0,\end{cases}
\bm{\delta}_{k}
K
k
\bm{\delta}_{0}:={\bm{0}}
{\bm{y}}_{t}=\bm{\delta}_{0}
K
\mu_{k}({\bm{x}}_{t},\bm{\Theta}_{\star}):=\frac{\exp\left(\langle{\bm{x}}_{t}%
,(\bm{\theta}_{\star}^{(k)})\rangle\right)}{1+\sum_{j=1}^{K}\exp\left(\langle{%
\bm{x}}_{t},(\bm{\theta}_{\star}^{(j)})\rangle\right)}
\left\{\bm{\theta}_{\star}^{(j)}\right\}_{j=1}^{K}\subset{\mathbb{R}}^{d}
K\times d
\bm{\Theta}_{\star}:=[\bm{\theta}_{\star}^{(1)},\cdots,\bm{\theta}_{\star}^{(K%
)}]^{\intercal}\in{\mathbb{R}}^{K\times d}
\bm{\mu}({\bm{x}}_{t},\bm{\Theta}_{\star}):=[\mu_{t}(\bm{\theta}_{\star}^{(1)}%
),\cdots,\mu_{t}(\bm{\theta}_{\star}^{(K)})]^{\intercal}
\mathrm{Reg}^{B}(T):=\sum_{t=1}^{T}\bm{\rho}^{\intercal}\left(\bm{\mu}({\bm{x}%
}_{t,\star},\bm{\Theta}_{\star})-\bm{\mu}({\bm{x}}_{t},\bm{\Theta})\right),
{\bm{x}}_{t,\star}:=\operatorname*{arg\,max}_{{\bm{x}}\in{\mathcal{X}}}\bm{%
\rho}^{\intercal}\bm{\mu}({\bm{x}},\bm{\Theta}_{\star})
{\bm{A}}({\bm{x}},\bm{\Theta}):=\mathrm{diag}(\bm{\mu}({\bm{x}},\bm{\Theta}))-%
\bm{\mu}({\bm{x}},\bm{\Theta})\bm{\mu}({\bm{x}},\bm{\Theta})^{\intercal}.
{\mathcal{X}}_{t}\subseteq{\mathcal{B}}^{d}(1)
t\geq 1
S,R>0
\bm{\Theta}_{\star}\in{\mathcal{B}}^{K\times d}(S)
\bm{\rho}\in{\mathcal{B}}^{d}(R)
\displaystyle\kappa(T):=\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_%
{\bm{\Theta}\in{\mathcal{B}}^{K\times d}(S)}\frac{1}{\lambda_{\min}\left({\bm{%
A}}({\bm{x}},\bm{\Theta})\right)}.
\displaystyle\kappa(T):=\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_%
{\bm{\Theta}\in{\mathcal{B}}^{K\times d}(S)}\frac{1}{\lambda_{\min}\left({\bm{%
A}}({\bm{x}},\bm{\Theta})\right)}.
\widehat{\bm{\Theta}}_{t}:=\operatorname*{arg\,min}_{\bm{\Theta}\in{\mathcal{B%
}}^{K\times d}(S)}{\mathcal{L}}_{t}(\bm{\Theta})\triangleq\sum_{s=1}^{t-1}\ell%
_{s}(\bm{\Theta}),
\ell_{s}
s
\ell_{s}(\bm{\Theta}):=-\sum_{k=0}^{K}y_{s,k}\log\mu_{k}({\bm{x}}_{s},\bm{%
\Theta}),
\mu_{0}({\bm{x}}_{s},\bm{\Theta}):=1-\sum_{j=1}^{K}\mu_{j}({\bm{x}}_{0},\bm{%
\Theta})
K=1
\displaystyle{\mathbb{P}}\left[\forall t\geq 1,\ \bm{\Theta}_{\star}\in{%
\mathcal{C}}_{t}(\delta)\right]\geq 1-\delta,
\displaystyle{\mathbb{P}}\left[\forall t\geq 1,\ \bm{\Theta}_{\star}\in{%
\mathcal{C}}_{t}(\delta)\right]\geq 1-\delta,
\displaystyle{\mathcal{C}}_{t}(\delta)\!=\!\left\{\bm{\Theta}\in{\mathcal{B}}^%
{K\times d}(S):{\mathcal{L}}_{t}(\bm{\Theta})-{\mathcal{L}}_{t}(\widehat{\bm{%
\Theta}}_{t})\leq\beta_{t}(\delta)^{2}\right\},
\displaystyle{\mathcal{C}}_{t}(\delta)
\displaystyle\!=\!\left\{\bm{\Theta}\in{\mathcal{B}}^{K\times d}(S):{\mathcal{%
L}}_{t}(\bm{\Theta})-{\mathcal{L}}_{t}(\widehat{\bm{\Theta}}_{t})\leq\beta_{t}%
(\delta)^{2}\right\},
\displaystyle\beta_{t}(\delta)^{2}\!=\!5dK^{\prime}\log\left(e+\frac{St}{dK^{%
\prime}}\right)+2((e-2)+\sqrt{6K}S)\log\frac{1}{\delta},
\displaystyle\beta_{t}(\delta)^{2}
\displaystyle\!=\!5dK^{\prime}\log\left(e+\frac{St}{dK^{\prime}}\right)+2((e-2%
)+\sqrt{6K}S)\log\frac{1}{\delta},
K^{\prime}=K+1
t=1,\dots,T
\widehat{\bm{\Theta}}_{t}\leftarrow\operatorname*{arg\,min}_{\lVert\bm{\Theta}%
\rVert_{2}\leq S}{\mathcal{L}}_{t}(\bm{\Theta})
{\bm{x}}_{t}\leftarrow\operatorname*{arg\,max}_{{\bm{x}}\in{\mathcal{X}}_{t}}%
\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}},\widehat{\bm{\Theta}}_{t})+\epsilon_{t}%
({\bm{x}})
\epsilon_{t}({\bm{x}})=\sqrt{2\kappa(T)}RL\gamma_{t}(\delta)\lVert{\bm{x}}%
\rVert_{{\bm{V}}_{t}^{-1}}
{\bm{x}}_{t}
r_{t}
{\mathcal{M}}_{1}(\bm{\Theta})\leftarrow{\mathcal{B}}^{K\times d}(S)
t=1,\dots,T
\widehat{\bm{\Theta}}_{t}\leftarrow\operatorname*{arg\,min}_{\bm{\Theta}\in{%
\mathcal{M}}_{t}}{\mathcal{L}}_{t}(\bm{\Theta})
{\bm{x}}_{t}\leftarrow\operatorname*{arg\,max}_{{\bm{x}}\in{\mathcal{X}}_{t}}%
\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}},\widehat{\bm{\Theta}}_{t})+\overline{%
\epsilon}_{t}({\bm{x}})
\overline{\epsilon}_{t}({\bm{x}})
{\bm{x}}_{t}
r_{t}
{\mathcal{M}}_{t+1}\leftarrow{\mathcal{M}}_{t}\cap\left\{\bm{\Theta}:\exists%
\bm{\Theta}^{\prime}_{t}\in\mathrm{min}({\mathcal{C}}_{t}(\delta))\text{ s.t. %
}{\bm{A}}({\bm{x}}_{t},\bm{\Theta})\succeq{\bm{A}}({\bm{x}}_{t},\bm{\Theta}^{%
\prime}_{t}\right\}
\mathrm{min}({\mathcal{C}}_{t}(\delta))
{\mathcal{C}}_{t}(\delta)
{\bm{A}}({\bm{x}}_{t},\bm{\Theta})
S=5
S=5
S=10
S=10
S=5
S=5
S=10
S=10
\mathrm{Reg}^{B}(T)
t=4000
\mathrm{Reg}^{B}(T)
t=4000
{\mathcal{C}}_{t}(\delta)
\kappa(T)
S
1-\delta
\displaystyle\mathrm{Reg}^{B}(T)\lesssim Rd\sqrt{KS\kappa(T)T},
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim Rd\sqrt{KS\kappa(T)T},
\displaystyle\mathrm{Reg}^{B}_{imp}(T)\lesssim Rd\sqrt{K}S\left(\sqrt{T}+dK^{3%
/2}\sqrt{S}\kappa(T)\right).
\displaystyle\mathrm{Reg}^{B}_{imp}(T)
\displaystyle\lesssim Rd\sqrt{K}S\left(\sqrt{T}+dK^{3/2}\sqrt{S}\kappa(T)%
\right).
d,K,S,\kappa(T),T
S
\lambda=\frac{dK^{3/2}}{S}\log\frac{1+\frac{ST}{dK}}{\delta}
\widetilde{{\mathcal{O}}}\left(dK^{3/4}S\sqrt{\kappa(T)T}\right)
\widetilde{{\mathcal{O}}}\left(dK^{5/4}S^{3/2}\left(\sqrt{T}+dK^{5/4}S\kappa(T%
)\right)\right)
\widetilde{{\mathcal{O}}}(dK)
d
K
\lambda
\widetilde{{\mathcal{O}}}(dK^{3/4})
\widetilde{{\mathcal{O}}}(d\sqrt{K})
S
\sqrt{S}
\widetilde{{\mathcal{O}}}\left(dS\sqrt{K\kappa(T)T}\right)
\widetilde{{\mathcal{O}}}\left(dKS\left(\sqrt{ST}+d\kappa(T)\right)\right)
dK\gtrsim S
dK\lesssim S
S
dK
\widetilde{{\mathcal{O}}}\left(dS^{3/2}\sqrt{K\kappa(T)T}+d^{2}KS^{3}\kappa(T)\right)
\widetilde{{\mathcal{O}}}\left(dKS^{3/2}\sqrt{T}+d^{2}KS^{3}\kappa(T)\right)
{\mathcal{O}}(1)
\sqrt{S}
\sqrt{K}
T=4000
d=2
|{\mathcal{A}}|=20
\delta=0.05
{\color[rgb]{0,0,1}\bm{\theta}_{\star}}=\frac{S-1}{\sqrt{d}}\bm{1}
S\in\{5,10\}
t
\lambda=10
10
t=4000
{\color[rgb]{1,0,0}\widehat{\bm{\theta}}}
{\color[rgb]{0,0,1}\bm{\theta}_{\star}}
S=5
S
S
K
-\|\widehat{\bm{\theta}}_{T+1}-\bm{\theta}^{\star}\|^{2}_{{\bm{V}}_{T}}
{\bm{V}}_{T}:=\lambda{\bm{I}}+\sum_{t=1}^{T}{\bm{x}}_{t}{\bm{x}}_{t}^{\intercal}
\widehat{\bm{\theta}}_{T+1}
T+1
\widehat{\bm{\theta}}_{T+1}
\sum_{t=1}^{T}\ell_{t}(\bm{\theta}_{t})-\ell_{t}(\bm{\theta}^{\star})\leq B_{T}
\ell_{t}
\bm{\theta}_{t}
t
B_{T}
\bm{\theta}^{\star}
\bm{\theta}^{\star}
\hat{y}_{t}
y_{t}
\{\widehat{\bm{\theta}}_{t}\}
\widehat{\bm{\theta}}_{t}
{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\{\widehat{\bm{\theta}}_{s}\}%
_{s=1}^{t})
{\mathcal{L}}_{t}(\cdot)
{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}_{t})
K+1
{\mathcal{O}}(1)
{\mathcal{Q}}_{t}
{\mathcal{Q}}_{t}
X_{n}
\lambda>0
{\mathbb{P}}\left[\sup_{n\geq 0}X_{n}\geq\lambda\right]\leq\frac{\mathbb{E}[X_%
{0}]}{\lambda}
\tilde{\bm{\theta}}_{s}
\widetilde{\bm{\Theta}}_{s}
\bm{\sigma}:{\mathbb{R}}^{K}\rightarrow\Delta_{>0}^{K+1}
\bm{\sigma}({\bm{z}})_{k}=\frac{e^{z_{k}}}{1+\sum_{k^{\prime}\in[K]}e^{z_{k^{%
\prime}}}}
k\in[K]
\bm{\sigma}({\bm{z}})_{0}=\frac{1}{1+\sum_{k^{\prime}\in[K]}e^{z_{k^{\prime}}}}
{\bm{x}}\in{\mathcal{B}}^{d}(1)
\hat{{\bm{z}}}\in{\mathbb{R}}^{K+1}
\bm{\Theta}=[\bm{\theta}^{(1)}|\cdots|\bm{\theta}^{(K)}]^{\intercal}\in{%
\mathcal{B}}^{K\times d}(\sqrt{K}S)
\bm{\sigma}(\hat{{\bm{z}}})=\bm{\sigma}\left((\langle{\bm{x}},\bm{\theta}^{(1)%
}\rangle,\cdots,\langle{\bm{x}},\bm{\theta}^{(K)}\rangle)\right)
\mu=0
P_{t}
{\mathcal{S}}:=\left({\mathcal{B}}^{d}(S)\right)^{\otimes K}
K\times d
S
\bm{\sigma}({\bm{z}})_{k^{\prime}}=\frac{e^{z_{k^{\prime}}}}{\sum_{l\in\{0\}%
\cup[K]}e^{z_{l}}}
k^{\prime}\in\{0\}\cup[K+1]
e^{z_{0}}
z_{k}=\langle{\bm{x}},\bm{\theta}^{(k)}\rangle
{\mathcal{S}}
B=S/2
\left({\mathcal{B}}^{d}(S/2)\right)^{\otimes(K+1)}
B=S/2
\bm{\sigma}(\hat{{\bm{z}}})=\mathbb{E}_{\bm{\Theta}\sim P_{t}}\left[\bm{\sigma%
}(\bm{\Theta}{\bm{x}})\right].
F:{\mathcal{S}}\rightarrow\Delta^{K+1}_{>0}
F(\bm{\Theta})=\bm{\sigma}(\bm{\Theta}{\bm{x}})
({\mathcal{X}},P)
\sigma
Y\subset{\mathcal{H}}
{\mathcal{H}}
F:{\mathcal{X}}\rightarrow Y
X
{\mathcal{X}}
\mathbb{E}[F(X)]\in Y
\mathrm{conv}\left(F({\mathcal{S}})\right)\subseteq F({\mathcal{B}}^{K\times d%
}(\sqrt{K}S))
\mathrm{conv}(\cdot)
\bm{\sigma}(\hat{{\bm{z}}})=\mathbb{E}[F(\bm{\Theta})]\in F({\mathcal{B}}^{K%
\times d}(\sqrt{K}S))
\bm{\Theta}\in{\mathcal{B}}^{K\times d}(\sqrt{K}S)
\bm{\sigma}(\hat{{\bm{z}}})=F(\bm{\Theta})
\mathbb{E}[F(X)]
e\triangleq\mathbb{E}[F(X)]\not\in Y
\{e\}
Y
v\in{\mathcal{H}}
\langle v,F(x)\rangle<\langle v,e\rangle,\quad\forall x\in{\mathcal{X}}.
\int_{\mathcal{X}}\langle v,F(x)\rangle dP(x)=\left\langle v,\int_{\mathcal{X}%
}F(x)dP(x)\right\rangle=\langle v,e\rangle<\langle v,e\rangle,
\bm{\Theta}_{1},\bm{\Theta}_{2}\in{\mathcal{S}}
\lambda\in[0,1]
\lambda F(\bm{\Theta}_{1})+(1-\lambda)F(\bm{\Theta}_{2})\in F({\mathcal{B}}^{K%
\times d}(\sqrt{K}S))
{\bm{p}}=(p_{1},\cdots,p_{K})^{\intercal}
\bm{\Theta}=[\bm{\theta}^{(1)}|\cdots|\bm{\theta}^{(K)}]^{\intercal}
k\in[K]
\frac{\exp\left(\langle{\bm{x}},\bm{\theta}^{(k)}\rangle\right)}{1+\sum_{k^{%
\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}^{(k^{\prime})}\rangle%
\right)}=p_{k}.
\alpha_{k}:=\exp\left(\langle{\bm{x}},\bm{\theta}^{(k)}\rangle\right)
\underbrace{\begin{bmatrix}1-p_{1}&-p_{1}&\cdots&-p_{1}\\
-p_{2}&1-p_{2}&\cdots&-p_{2}\\
\vdots&\vdots&\vdots&\vdots\\
-p_{K}&-p_{K}&\cdots&1-p_{K}\end{bmatrix}}_{\triangleq{\bm{C}}_{K}}\begin{%
bmatrix}\alpha_{1}\\
\alpha_{2}\\
\vdots\\
\alpha_{K}\end{bmatrix}=\begin{bmatrix}p_{1}\\
p_{2}\\
\vdots\\
p_{K}\end{bmatrix}.
{\bm{C}}_{K}^{-1}=\frac{1}{p_{0}}{\bm{p}}\bm{1}^{\intercal}+{\bm{I}}_{K},
p_{0}=1-\sum_{k=1}^{K}p_{k}
\alpha_{k}^{*}=\frac{p_{k}}{p_{0}}>0.
{\bm{x}}^{\intercal}\bm{\theta}^{(k)}=\log\alpha_{k}^{*}
k\in[K]
\bm{\theta}^{(k)}=\frac{\log\alpha_{k}^{*}}{\lVert{\bm{x}}\rVert_{2}}{\bm{x}}
\bm{\Theta}
\lambda F(\bm{\Theta}_{1})+(1-\lambda)F(\bm{\Theta}_{2})=F(\bm{\Theta})
\lVert\bm{\Theta}\rVert_{F}^{2}=\sum_{k\in[K]}\left(\log\alpha_{k}^{*}\right)^%
{2},
p_{k}=\lambda\frac{\exp\left(\langle{\bm{x}},\bm{\theta}_{1}^{(k)}\rangle%
\right)}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{1}^{(%
k^{\prime})}\rangle\right)}+(1-\lambda)\frac{\exp\left(\langle{\bm{x}},\bm{%
\theta}_{2}^{(k)}\rangle\right)}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{%
\bm{x}},\bm{\theta}_{2}^{(k^{\prime})}\rangle\right)}.
\displaystyle\frac{p_{k}}{p_{0}}=\frac{\lambda\frac{\exp\left(\langle{\bm{x}},%
\bm{\theta}_{1}^{(k)}\rangle\right)}{1+\sum_{k^{\prime}\in[K]}\exp\left(%
\langle{\bm{x}},\bm{\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)\frac%
{\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k)}\rangle\right)}{1+\sum_{k^{%
\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k^{\prime})}\rangle%
\right)}}{\lambda\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},%
\bm{\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)\frac{1}{1+\sum_{k^{%
\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k^{\prime})}\rangle%
\right)}}
\displaystyle\frac{p_{k}}{p_{0}}
\displaystyle=\frac{\lambda\frac{\exp\left(\langle{\bm{x}},\bm{\theta}_{1}^{(k%
)}\rangle\right)}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{%
\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)\frac{\exp\left(\langle{%
\bm{x}},\bm{\theta}_{2}^{(k)}\rangle\right)}{1+\sum_{k^{\prime}\in[K]}\exp%
\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k^{\prime})}\rangle\right)}}{\lambda%
\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{1}^{(%
k^{\prime})}\rangle\right)}+(1-\lambda)\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp%
\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k^{\prime})}\rangle\right)}}
\bm{\Theta}_{i}\in{\mathcal{S}}
\left\lVert\bm{\theta}_{i}^{(k)}\right\rVert_{2}\leq S
k\in[K]
\bm{\Theta}_{i}\in{\mathcal{S}}
\left\lVert\bm{\theta}_{i}^{(k)}\right\rVert_{2}\leq S
k\in[K]
\bm{\Theta}_{i}\in{\mathcal{S}}
\left\lVert\bm{\theta}_{i}^{(k)}\right\rVert_{2}\leq S
k\in[K]
\displaystyle\leq\frac{\lambda\frac{e^{S}}{1+\sum_{k^{\prime}\in[K]}\exp\left(%
\langle{\bm{x}},\bm{\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)\frac%
{e^{S}}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k%
^{\prime})}\rangle\right)}}{\lambda\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp\left%
(\langle{\bm{x}},\bm{\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)%
\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(%
k^{\prime})}\rangle\right)}}
\displaystyle\leq\frac{\lambda\frac{e^{S}}{1+\sum_{k^{\prime}\in[K]}\exp\left(%
\langle{\bm{x}},\bm{\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)\frac%
{e^{S}}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(k%
^{\prime})}\rangle\right)}}{\lambda\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp\left%
(\langle{\bm{x}},\bm{\theta}_{1}^{(k^{\prime})}\rangle\right)}+(1-\lambda)%
\frac{1}{1+\sum_{k^{\prime}\in[K]}\exp\left(\langle{\bm{x}},\bm{\theta}_{2}^{(%
k^{\prime})}\rangle\right)}}
\displaystyle=e^{S},
\displaystyle=e^{S},
\displaystyle\lVert\bm{\Theta}\rVert_{F}^{2}\leq KS^{2}.
\displaystyle\lVert\bm{\Theta}\rVert_{F}^{2}
\displaystyle\leq KS^{2}.
{\mathcal{L}}_{t}(\bm{\theta}):=\sum_{s=1}^{t}\ell_{s}(\bm{\theta})
t
\displaystyle\widetilde{\alpha}({\bm{x}},\bm{\theta}_{1},\bm{\theta}_{2}):=%
\int_{0}^{1}(1-v)\dot{\mu}\left({\bm{x}}^{\intercal}(\bm{\theta}_{1}+v(\bm{%
\theta}_{2}-\bm{\theta}_{1}))\right)dv
\displaystyle\widetilde{\alpha}({\bm{x}},\bm{\theta}_{1},\bm{\theta}_{2})
\displaystyle:=\int_{0}^{1}(1-v)\dot{\mu}\left({\bm{x}}^{\intercal}(\bm{\theta%
}_{1}+v(\bm{\theta}_{2}-\bm{\theta}_{1}))\right)dv
\displaystyle\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{1},\bm{\theta}_{2}):=\sum_{%
s=1}^{t-1}\widetilde{\alpha}({\bm{x}}_{s},\bm{\theta}_{1},\bm{\theta}_{2}){\bm%
{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}{\bm{I}}_{d}
\displaystyle\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{1},\bm{\theta}_{2})
\displaystyle:=\sum_{s=1}^{t-1}\widetilde{\alpha}({\bm{x}}_{s},\bm{\theta}_{1}%
,\bm{\theta}_{2}){\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}{\bm{I}}_{d}
\displaystyle{\bm{H}}_{t}(\bm{\theta}):=\sum_{s=1}^{t-1}\dot{\mu}({\bm{x}}_{s}%
^{\intercal}\bm{\theta}){\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}{\bm{I%
}}_{d},
\displaystyle{\bm{H}}_{t}(\bm{\theta})
\displaystyle:=\sum_{s=1}^{t-1}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}){%
\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}+\lambda_{t}{\bm{I}}_{d},
\lambda_{t}>0
\kappa_{\star}(T):=\frac{1}{\frac{1}{T}\sum_{t=1}^{T}\dot{\mu}({\bm{x}}_{t,%
\star}^{\intercal}\bm{\theta}_{\star})},\ \kappa_{{\mathcal{X}}}(T):=\max_{t%
\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\frac{1}{\dot{\mu}({\bm{x}}^{%
\intercal}\bm{\theta}_{\star})},\ \kappa(T):=\max_{t\in[T]}\max_{{\bm{x}}\in{%
\mathcal{X}}_{t}}\max_{\bm{\theta}\in{\mathcal{B}}^{d}(S)}\frac{1}{\dot{\mu}({%
\bm{x}}^{\intercal}\bm{\theta})},
{\bm{x}}_{t,\star}=\operatorname*{arg\,max}_{{\bm{x}}\in{\mathcal{X}}_{t}}\mu(%
\langle{\bm{x}},\bm{\theta}_{\star}\rangle)
t
A\lesssim B
A\leq cB
c
\mathrm{Reg}^{B}(T)\lesssim R_{leading}(T)+R_{log}(T)+R_{detr}(T),
1-\delta
\displaystyle R_{leading}(T):=\left(dS\log\left(e+\frac{ST}{d}\right)+\sqrt{d}%
S\log\frac{1}{\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(T)}},
\displaystyle R_{leading}(T)
\displaystyle:=\left(dS\log\left(e+\frac{ST}{d}\right)+\sqrt{d}S\log\frac{1}{%
\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(T)}},
\displaystyle R_{log}(T):=d^{2}S^{2}\left(\log\left(e+\frac{ST}{d}\right)%
\right)^{2}+dS^{2}\left(\log\frac{1}{\delta}\right)^{2},
\displaystyle R_{log}(T)
\displaystyle:=d^{2}S^{2}\left(\log\left(e+\frac{ST}{d}\right)\right)^{2}+dS^{%
2}\left(\log\frac{1}{\delta}\right)^{2},
\displaystyle R_{detr}(T):=\min\left\{\kappa_{\mathcal{X}}(T)R_{log}(T),S\sum_%
{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})\mathds{1}[{\bm%
{x}}_{t}\in{\mathcal{X}}_{-}(t)]\right\},
\displaystyle R_{detr}(T)
\displaystyle:=\min\left\{\kappa_{\mathcal{X}}(T)R_{log}(T),S\sum_{t=1}^{T}\mu%
({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})\mathds{1}[{\bm{x}}_{t}\in{%
\mathcal{X}}_{-}(t)]\right\},
{\mathcal{X}}_{-}(t)
t
\lambda_{t}=\frac{d}{S}\log\frac{St}{d\delta}
\mathrm{Reg}^{B}(T)\leq R_{leading}(T)+R_{log}(T)+R_{detr}(T),
1-\delta
\displaystyle R_{leading}(T)\lesssim dS^{\frac{3}{2}}(\log T)\left(\log\left(1%
+\frac{ST}{d}\right)+\log\frac{1}{\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(%
T)}},
\displaystyle R_{leading}(T)
\displaystyle\lesssim dS^{\frac{3}{2}}(\log T)\left(\log\left(1+\frac{ST}{d}%
\right)+\log\frac{1}{\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(T)}},
\displaystyle R_{log}(T)\lesssim d^{2}S^{3}\left(\log T\right)^{2}\left(\log%
\left(1+\frac{ST}{d}\right)+\log\frac{1}{\delta}\right)^{2},
\displaystyle R_{log}(T)
\displaystyle\lesssim d^{2}S^{3}\left(\log T\right)^{2}\left(\log\left(1+\frac%
{ST}{d}\right)+\log\frac{1}{\delta}\right)^{2},
\displaystyle R_{detr}(T)\lesssim\min\left\{\kappa_{\mathcal{X}}(T)R_{log}(T),%
S\sum_{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})\mathds{1%
}[{\bm{x}}_{t}\in{\mathcal{X}}_{-}(t)]\right\}.
\displaystyle R_{detr}(T)
\displaystyle\lesssim\min\left\{\kappa_{\mathcal{X}}(T)R_{log}(T),S\sum_{t=1}^%
{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})\mathds{1}[{\bm{x}}_{%
t}\in{\mathcal{X}}_{-}(t)]\right\}.
\lambda_{t}=\frac{d}{S}\log\frac{St}{d\delta}
\mathrm{Reg}^{B}(T)\leq R_{leading}(T)+R_{log}(T)+R_{detr}(T),
1-\delta
\displaystyle R_{leading}(T)\lesssim dS^{\frac{5}{2}}(\log T)\left(\log\left(1%
+\frac{ST}{d}\right)+\log\frac{1}{\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(%
T)}},
\displaystyle R_{leading}(T)
\displaystyle\lesssim dS^{\frac{5}{2}}(\log T)\left(\log\left(1+\frac{ST}{d}%
\right)+\log\frac{1}{\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(T)}},
\displaystyle R_{log}(T)\lesssim d^{2}S^{4}\left(\log T\right)^{2}\left(\log%
\left(1+\frac{ST}{d}\right)+\log\frac{1}{\delta}\right)^{2},
\displaystyle R_{log}(T)
\displaystyle\lesssim d^{2}S^{4}\left(\log T\right)^{2}\left(\log\left(1+\frac%
{ST}{d}\right)+\log\frac{1}{\delta}\right)^{2},
\displaystyle R_{detr}(T)\lesssim\min\left\{\kappa_{\mathcal{X}}(T)R_{log}(T),%
S\sum_{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})\mathds{1%
}[{\bm{x}}_{t}\in{\mathcal{X}}_{-}(t)]\right\}.
\displaystyle R_{detr}(T)
\displaystyle\lesssim\min\left\{\kappa_{\mathcal{X}}(T)R_{log}(T),S\sum_{t=1}^%
{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})\mathds{1}[{\bm{x}}_{%
t}\in{\mathcal{X}}_{-}(t)]\right\}.
1-\delta
\mathrm{Reg}^{B}(T)\lesssim dS\log\frac{1}{\delta}\sqrt{\frac{T}{\kappa_{\star%
}(T)}}+d^{2}S^{6}\kappa\left(\log\frac{1}{\delta}\right)^{2}.
1-\delta
\mathrm{Reg}^{B}(T)\lesssim\min\left\{\sqrt{d\frac{T}{\kappa_{\star}}\log\frac%
{|{\mathcal{X}}|}{\delta}},\frac{d}{\kappa_{\star}\Delta}\log\frac{|{\mathcal{%
X}}|}{\delta}\right\}+d^{2}\kappa\log\frac{|{\mathcal{X}}|}{\delta},
\Delta:=\min_{{\bm{x}}\in{\mathcal{X}}\setminus\{{\bm{x}}_{\star}\}}\mu({\bm{x%
}}_{\star}^{\intercal}\bm{\theta}_{\star})-\mu({\bm{x}}^{\intercal}\bm{\theta}%
_{\star})
S
{\bm{x}}_{1},\cdots,{\bm{x}}_{T}\in{\mathcal{B}}^{d}(1)
{\bm{V}}_{t}:=\lambda{\bm{I}}+\sum_{s=1}^{t-1}{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}
{\mathcal{H}}_{T}:=\left\{t\in[T]:\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}%
^{2}>1\right\}
\left|{\mathcal{H}}_{T}\right|\leq\frac{2d}{\log(2)}\log\left(1+\frac{1}{%
\lambda\log(2)}\right).
{\bm{x}}_{1},\cdots,{\bm{x}}_{T}\in{\mathcal{B}}^{d}(1)
{\bm{V}}_{t}:=\lambda{\bm{I}}+\sum_{s=1}^{t-1}{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}
\sum_{t=1}^{T}\min\left\{1,\lVert{\bm{x}}_{t}\rVert^{2}_{{\bm{V}}_{t}^{-1}}%
\right\}\leq 2d\log\left(1+\frac{T}{d\lambda}\right).
\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
1
\max\left(1,\frac{1}{\lambda}\right)
S^{3}
S
\mathrm{Reg}^{B}(T)=\underbrace{\sum_{t=1}^{T}\dot{\mu}({\bm{x}}_{t}^{%
\intercal}\bm{\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm%
{\theta}_{\star}}_{\triangleq R_{1}(T)}+\underbrace{\sum_{t=1}^{T}\tilde{%
\vartheta}_{t}\left\{({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm{\theta}_%
{\star}\right\}^{2}}_{\triangleq R_{2}(T)},
\vartheta_{t}=\int_{0}^{1}(1-v)\ddot{\mu}\left({\bm{x}}_{t}^{\intercal}\bm{%
\theta}_{\star}+v({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm{\theta}_{%
\star}\right)dv.
R_{1}(T)
\tilde{{\bm{x}}}_{t}:=\sqrt{\dot{\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{%
\star})}{\bm{x}}_{t}
{\mathcal{H}}_{T}:=\left\{t\in[T]:\lVert\tilde{{\bm{x}}}_{t}\rVert_{\widetilde%
{{\bm{V}}}_{t-1}^{-1}}^{2}>1\right\}
{\bm{H}}_{t}(\bm{\theta}_{\star})=\lambda{\bm{I}}+\sum_{s=1}^{t-1}\tilde{{\bm{%
x}}}_{s}\tilde{{\bm{x}}}_{s}^{\intercal}
1-\delta
\displaystyle R_{1}(T)=\sum_{t\in{\mathcal{H}}_{T}}\dot{\mu}({\bm{x}}_{t}^{%
\intercal}\bm{\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm%
{\theta}_{\star}+\sum_{t\not\in{\mathcal{H}}_{T}}\dot{\mu}({\bm{x}}_{t}^{%
\intercal}\bm{\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm%
{\theta}_{\star}
\displaystyle R_{1}(T)
\displaystyle=\sum_{t\in{\mathcal{H}}_{T}}\dot{\mu}({\bm{x}}_{t}^{\intercal}%
\bm{\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm{\theta}_{%
\star}+\sum_{t\not\in{\mathcal{H}}_{T}}\dot{\mu}({\bm{x}}_{t}^{\intercal}\bm{%
\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_{t})^{\intercal}\bm{\theta}_{\star}
\displaystyle\leq 2S|{\mathcal{H}}_{T}|+\sum_{t\not\in{\mathcal{H}}_{T}}\dot{%
\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_%
{t})^{\intercal}\bm{\theta}_{\star}
\displaystyle\leq 2S|{\mathcal{H}}_{T}|+\sum_{t\not\in{\mathcal{H}}_{T}}\dot{%
\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})({\bm{x}}_{t,\star}-{\bm{x}}_%
{t})^{\intercal}\bm{\theta}_{\star}
\displaystyle\lesssim dS\log S+\sum_{t\not\in{\mathcal{H}}_{T}}\dot{\mu}({\bm{%
x}}_{t}^{\intercal}\bm{\theta}_{\star})\lVert{\bm{x}}_{t}\rVert_{{\bm{H}}_{t}^%
{-1}(\bm{\theta}_{\star})}\lVert\bm{\theta}_{t}-\bm{\theta}_{\star}\rVert_{{%
\bm{H}}_{t}(\bm{\theta}_{\star})}
\displaystyle\lesssim dS\log S+\sum_{t\not\in{\mathcal{H}}_{T}}\dot{\mu}({\bm{%
x}}_{t}^{\intercal}\bm{\theta}_{\star})\lVert{\bm{x}}_{t}\rVert_{{\bm{H}}_{t}^%
{-1}(\bm{\theta}_{\star})}\lVert\bm{\theta}_{t}-\bm{\theta}_{\star}\rVert_{{%
\bm{H}}_{t}(\bm{\theta}_{\star})}
\displaystyle\lesssim dS\log S+\sum_{t\not\in{\mathcal{H}}_{T}}\gamma_{t}(%
\delta)\sqrt{\dot{\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\lVert%
\tilde{{\bm{x}}}_{t}\rVert_{{\bm{H}}_{t}^{-1}(\bm{\theta}_{\star})}
\displaystyle\lesssim dS\log S+\sum_{t\not\in{\mathcal{H}}_{T}}\gamma_{t}(%
\delta)\sqrt{\dot{\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\lVert%
\tilde{{\bm{x}}}_{t}\rVert_{{\bm{H}}_{t}^{-1}(\bm{\theta}_{\star})}
\displaystyle\leq dS\log S+\gamma_{T}(\delta)\sqrt{\sum_{t\not\in{\mathcal{H}}%
_{T}}\dot{\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\sqrt{\sum_{t\not%
\in{\mathcal{H}}_{T}}\lVert\tilde{{\bm{x}}}_{t}\rVert_{{\bm{H}}_{t}^{-1}(\bm{%
\theta}_{\star})}^{2}}
\displaystyle\leq dS\log S+\gamma_{T}(\delta)\sqrt{\sum_{t\not\in{\mathcal{H}}%
_{T}}\dot{\mu}({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\sqrt{\sum_{t\not%
\in{\mathcal{H}}_{T}}\lVert\tilde{{\bm{x}}}_{t}\rVert_{{\bm{H}}_{t}^{-1}(\bm{%
\theta}_{\star})}^{2}}
\displaystyle\leq dS\log S+\gamma_{T}(\delta)\sqrt{\sum_{t=1}^{T}\dot{\mu}({%
\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\sqrt{\sum_{t=1}^{T}\min\left\{1,%
\lVert\tilde{{\bm{x}}}_{t}\rVert_{{\bm{H}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}%
\right\}}
\displaystyle\leq dS\log S+\gamma_{T}(\delta)\sqrt{\sum_{t=1}^{T}\dot{\mu}({%
\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\sqrt{\sum_{t=1}^{T}\min\left\{1,%
\lVert\tilde{{\bm{x}}}_{t}\rVert_{{\bm{H}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}%
\right\}}
\displaystyle\lesssim dS\log S+\gamma_{T}(\delta)\sqrt{\sum_{t=1}^{T}\dot{\mu}%
({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\sqrt{d\log\left(1+\frac{ST}{d}%
\right)}
\displaystyle\lesssim dS\log S+\gamma_{T}(\delta)\sqrt{\sum_{t=1}^{T}\dot{\mu}%
({\bm{x}}_{t}^{\intercal}\bm{\theta}_{\star})}\sqrt{d\log\left(1+\frac{ST}{d}%
\right)}
\displaystyle\lesssim dS\log S+\gamma_{T}(\delta)\left(\sqrt{\frac{T}{\kappa_{%
\star}(T)}}+\sqrt{\mathrm{Reg}^{B}(T)}\right)\sqrt{d\log\left(1+\frac{ST}{d}%
\right)}
\displaystyle\lesssim dS\log S+\gamma_{T}(\delta)\left(\sqrt{\frac{T}{\kappa_{%
\star}(T)}}+\sqrt{\mathrm{Reg}^{B}(T)}\right)\sqrt{d\log\left(1+\frac{ST}{d}%
\right)}
\displaystyle\lesssim\sqrt{d}S\left(\sqrt{d}\log\left(e+\frac{ST}{d}\right)+%
\log\frac{1}{\delta}\right)\left(\sqrt{\frac{T}{\kappa_{\star}(T)}}+\sqrt{%
\mathrm{Reg}^{B}(T)}\right).
\displaystyle\lesssim\sqrt{d}S\left(\sqrt{d}\log\left(e+\frac{ST}{d}\right)+%
\log\frac{1}{\delta}\right)\left(\sqrt{\frac{T}{\kappa_{\star}(T)}}+\sqrt{%
\mathrm{Reg}^{B}(T)}\right).
R_{2}(T)
R_{2}(T)\lesssim\underbrace{dS^{2}\left(d\left(\log\left(e+\frac{ST}{d}\right)%
\right)^{2}+\left(\log\frac{1}{\delta}\right)^{2}\right)}_{\triangleq R_{log}(%
T)}\kappa_{\mathcal{X}}(T)
R_{2}(T)\lesssim S\sum_{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_%
{\star})\mathds{1}[{\bm{x}}_{t}\in{\mathcal{X}}_{-}(t)]+R_{log}(T).
b,c\geq 0
x\in{\mathbb{R}}
x^{2}\leq bx+c
x^{2}\leq 2(b^{2}+c)
\displaystyle\mathrm{Reg}^{B}(T)\lesssim\sqrt{d}S\left(\sqrt{d}\log\left(e+%
\frac{ST}{d}\right)+\log\frac{1}{\delta}\right)\sqrt{\mathrm{Reg}^{B}(T)}+%
\underbrace{\sqrt{d}S\left(\sqrt{d}\log\left(e+\frac{ST}{d}\right)+\log\frac{1%
}{\delta}\right)\sqrt{\frac{T}{\kappa_{\star}(T)}}}_{\triangleq R_{leading}(T)}
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim\sqrt{d}S\left(\sqrt{d}\log\left(e+\frac{ST}{d}\right)+%
\log\frac{1}{\delta}\right)\sqrt{\mathrm{Reg}^{B}(T)}+\underbrace{\sqrt{d}S%
\left(\sqrt{d}\log\left(e+\frac{ST}{d}\right)+\log\frac{1}{\delta}\right)\sqrt%
{\frac{T}{\kappa_{\star}(T)}}}_{\triangleq R_{leading}(T)}
\displaystyle\quad+R_{log}(T)+\underbrace{\min\left\{\kappa_{\mathcal{X}}(T)R_%
{log}(T),S\sum_{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})%
\mathds{1}[{\bm{x}}_{t}\in{\mathcal{X}}_{-}(t)]\right\}}_{\triangleq R_{detr}(%
T)},
\displaystyle\quad+R_{log}(T)+\underbrace{\min\left\{\kappa_{\mathcal{X}}(T)R_%
{log}(T),S\sum_{t=1}^{T}\mu({\bm{x}}_{t,\star}^{\intercal}\bm{\theta}_{\star})%
\mathds{1}[{\bm{x}}_{t}\in{\mathcal{X}}_{-}(t)]\right\}}_{\triangleq R_{detr}(%
T)},
\mathrm{Reg}^{B}(T)\lesssim R_{leading}(T)+R_{log}(T)+R_{detr}(T).
\ell_{s}(\mu):=-r_{s}\log\mu-(1-r_{s})\log(1-\mu)
\ell_{s}^{\prime}(\mu)=-\frac{r_{s}}{\mu}+\frac{1-r_{s}}{1-\mu},\quad\ell_{s}^%
{\prime\prime}(\mu)=\frac{r_{s}}{\mu^{2}}+\frac{1-r_{s}}{(1-\mu)^{2}}.
\displaystyle\ell_{s}(\mu_{s})-\ell_{s}(\mu^{\star})=\ell_{s}^{\prime}(\mu^{%
\star})(\mu_{s}-\mu^{\star})+\int_{\mu^{\star}}^{\mu_{s}}\ell_{s}^{\prime%
\prime}(z)(\mu_{s}-z)dz
\displaystyle\ell_{s}(\mu_{s})-\ell_{s}(\mu^{\star})
\displaystyle=\ell_{s}^{\prime}(\mu^{\star})(\mu_{s}-\mu^{\star})+\int_{\mu^{%
\star}}^{\mu_{s}}\ell_{s}^{\prime\prime}(z)(\mu_{s}-z)dz
\displaystyle=\frac{\mu^{\star}-r_{s}}{\mu^{\star}(1-\mu^{\star})}(\mu_{s}-\mu%
^{\star})+\int_{\mu^{\star}}^{\mu_{s}}\left(\frac{r_{s}}{z^{2}}+\frac{1-r_{s}}%
{(1-z)^{2}}\right)(\mu_{s}-z)dz
\displaystyle=\frac{\mu^{\star}-r_{s}}{\mu^{\star}(1-\mu^{\star})}(\mu_{s}-\mu%
^{\star})+\int_{\mu^{\star}}^{\mu_{s}}\left(\frac{r_{s}}{z^{2}}+\frac{1-r_{s}}%
{(1-z)^{2}}\right)(\mu_{s}-z)dz
\displaystyle=-\xi_{s}\frac{\mu_{s}-\mu^{\star}}{\mu^{\star}(1-\mu^{\star})}+%
\int_{\mu^{\star}}^{\mu_{s}}\left(\frac{r_{s}}{z^{2}}+\frac{1-r_{s}}{(1-z)^{2}%
}\right)(\mu_{s}-z)dz,
\displaystyle=-\xi_{s}\frac{\mu_{s}-\mu^{\star}}{\mu^{\star}(1-\mu^{\star})}+%
\int_{\mu^{\star}}^{\mu_{s}}\left(\frac{r_{s}}{z^{2}}+\frac{1-r_{s}}{(1-z)^{2}%
}\right)(\mu_{s}-z)dz,
\mu^{\star}-r_{s}=-\xi_{s}
\displaystyle\int_{\mu^{\star}}^{\mu_{s}}\left(\frac{r_{s}}{z^{2}}+\frac{1-r_{%
s}}{(1-z)^{2}}\right)(\mu_{s}-z)dz
\displaystyle\int_{\mu^{\star}}^{\mu_{s}}\left(\frac{r_{s}}{z^{2}}+\frac{1-r_{%
s}}{(1-z)^{2}}\right)(\mu_{s}-z)dz
\displaystyle=r_{s}\left\{\frac{\mu_{s}}{\mu^{\star}}-1-\log\frac{\mu_{s}}{\mu%
^{\star}}\right\}+(1-r_{s})\left\{\frac{1-\mu_{s}}{1-\mu^{\star}}-1-\log\frac{%
1-\mu_{s}}{1-\mu^{\star}}\right\}
\displaystyle=r_{s}\left\{\frac{\mu_{s}}{\mu^{\star}}-1-\log\frac{\mu_{s}}{\mu%
^{\star}}\right\}+(1-r_{s})\left\{\frac{1-\mu_{s}}{1-\mu^{\star}}-1-\log\frac{%
1-\mu_{s}}{1-\mu^{\star}}\right\}
\displaystyle=-1+\left\{r_{s}\frac{\mu_{s}}{\mu^{\star}}+(1-r_{s})\frac{1-\mu_%
{s}}{1-\mu^{\star}}\right\}-\left\{r_{s}\log\frac{\mu_{s}}{\mu^{\star}}+(1-r_{%
s})\log\frac{1-\mu_{s}}{1-\mu^{\star}}\right\}
\displaystyle=-1+\left\{r_{s}\frac{\mu_{s}}{\mu^{\star}}+(1-r_{s})\frac{1-\mu_%
{s}}{1-\mu^{\star}}\right\}-\left\{r_{s}\log\frac{\mu_{s}}{\mu^{\star}}+(1-r_{%
s})\log\frac{1-\mu_{s}}{1-\mu^{\star}}\right\}
\displaystyle\overset{(*)}{=}-1+\left\{\mu_{s}+\xi_{s}\frac{\mu_{s}}{\mu^{%
\star}}+(1-\mu_{s})-\xi_{s}\frac{1-\mu_{s}}{1-\mu^{\star}}\right\}-\left\{\mu^%
{\star}\log\frac{\mu_{s}}{\mu^{\star}}+(1-\mu^{\star})\log\frac{1-\mu_{s}}{1-%
\mu^{\star}}+\xi_{s}\log\frac{\mu_{s}}{\mu^{\star}}-\xi_{s}\log\frac{1-\mu_{s}%
}{1-\mu^{\star}}\right\}
\displaystyle\overset{(*)}{=}-1+\left\{\mu_{s}+\xi_{s}\frac{\mu_{s}}{\mu^{%
\star}}+(1-\mu_{s})-\xi_{s}\frac{1-\mu_{s}}{1-\mu^{\star}}\right\}-\left\{\mu^%
{\star}\log\frac{\mu_{s}}{\mu^{\star}}+(1-\mu^{\star})\log\frac{1-\mu_{s}}{1-%
\mu^{\star}}+\xi_{s}\log\frac{\mu_{s}}{\mu^{\star}}-\xi_{s}\log\frac{1-\mu_{s}%
}{1-\mu^{\star}}\right\}
\displaystyle=\xi_{s}\frac{\mu_{s}-\mu^{\star}}{\mu^{\star}(1-\mu^{\star})}+%
\mathrm{KL}(\mu^{\star},\mu_{s})+\xi_{s}\left(\log\frac{\mu^{\star}}{1-\mu^{%
\star}}-\log\frac{\mu_{s}}{1-\mu_{s}}\right),
\displaystyle=\xi_{s}\frac{\mu_{s}-\mu^{\star}}{\mu^{\star}(1-\mu^{\star})}+%
\mathrm{KL}(\mu^{\star},\mu_{s})+\xi_{s}\left(\log\frac{\mu^{\star}}{1-\mu^{%
\star}}-\log\frac{\mu_{s}}{1-\mu_{s}}\right),
(*)
r_{s}=\mu^{\star}+\xi_{s}
\mu_{s}
\mu^{\star}
\displaystyle\ell_{s}(\mu_{s})-\ell_{s}(\mu^{\star})=\mathrm{KL}(\mu^{\star},%
\mu_{s})+\xi_{s}\left(\langle{\bm{x}}_{s},\bm{\theta}^{\star}\rangle-\langle{%
\bm{x}}_{s},\bm{\theta}_{s}\rangle\right)
\displaystyle\ell_{s}(\mu_{s})-\ell_{s}(\mu^{\star})
\displaystyle=\mathrm{KL}(\mu^{\star},\mu_{s})+\xi_{s}\left(\langle{\bm{x}}_{s%
},\bm{\theta}^{\star}\rangle-\langle{\bm{x}}_{s},\bm{\theta}_{s}\rangle\right)
\displaystyle=\mathrm{KL}(\mu^{\star},\mu_{s})+\xi_{s}\langle{\bm{x}}_{s},\bm{%
\theta}^{\star}-\bm{\theta}_{s}\rangle.
\displaystyle=\mathrm{KL}(\mu^{\star},\mu_{s})+\xi_{s}\langle{\bm{x}}_{s},\bm{%
\theta}^{\star}-\bm{\theta}_{s}\rangle.
\displaystyle 0=\sum_{s=1}^{t}\left\{\ell_{s}(\tilde{\bm{\theta}}_{s})-\ell_{s%
}(\bm{\theta}_{\star})-\mathrm{KL}(\mu_{s}(\bm{\theta}_{\star}),\mu_{s}(\tilde%
{\bm{\theta}}_{s}))+\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{%
\theta}_{\star}\rangle\right\}
\displaystyle 0
\displaystyle=\sum_{s=1}^{t}\left\{\ell_{s}(\tilde{\bm{\theta}}_{s})-\ell_{s}(%
\bm{\theta}_{\star})-\mathrm{KL}(\mu_{s}(\bm{\theta}_{\star}),\mu_{s}(\tilde{%
\bm{\theta}}_{s}))+\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{%
\theta}_{\star}\rangle\right\}
\displaystyle=\sum_{s=1}^{t}\left\{\ell_{s}(\tilde{\bm{\theta}}_{s})-\ell_{s}(%
\widehat{\bm{\theta}}_{t})+\ell_{s}(\widehat{\bm{\theta}}_{t})-\ell_{s}(\bm{%
\theta}^{\star})-\mathrm{KL}(\mu_{s}(\bm{\theta}^{\star}),\mu_{s}(\tilde{\bm{%
\theta}}_{s}))+\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{\theta}_%
{\star}\rangle\right\}
\displaystyle=\sum_{s=1}^{t}\left\{\ell_{s}(\tilde{\bm{\theta}}_{s})-\ell_{s}(%
\widehat{\bm{\theta}}_{t})+\ell_{s}(\widehat{\bm{\theta}}_{t})-\ell_{s}(\bm{%
\theta}^{\star})-\mathrm{KL}(\mu_{s}(\bm{\theta}^{\star}),\mu_{s}(\tilde{\bm{%
\theta}}_{s}))+\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{\theta}_%
{\star}\rangle\right\}
\displaystyle=\sum_{s=1}^{t}\left\{\ell_{s}(\widehat{\bm{\theta}}_{t})-\ell_{s%
}(\bm{\theta}^{\star})-\mathrm{KL}(\mu_{s}(\bm{\theta}^{\star}),\mu_{s}(\tilde%
{\bm{\theta}}_{s}))+\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{%
\theta}_{\star}\rangle\right\}+\mathrm{Reg}^{O}(T).
\displaystyle=\sum_{s=1}^{t}\left\{\ell_{s}(\widehat{\bm{\theta}}_{t})-\ell_{s%
}(\bm{\theta}^{\star})-\mathrm{KL}(\mu_{s}(\bm{\theta}^{\star}),\mu_{s}(\tilde%
{\bm{\theta}}_{s}))+\xi_{s}\langle{\bm{x}}_{s},\tilde{\bm{\theta}}_{s}-\bm{%
\theta}_{\star}\rangle\right\}+\mathrm{Reg}^{O}(T).
\displaystyle D_{m}(z_{1},z_{2})=m(z_{1})-m(z_{2})-m^{\prime}(z_{2})(z_{1}-z_{%
2})
\displaystyle D_{m}(z_{1},z_{2})
\displaystyle=m(z_{1})-m(z_{2})-m^{\prime}(z_{2})(z_{1}-z_{2})
\displaystyle=\log(1+e^{z_{1}})-\log(1+e^{z_{2}})-\frac{e^{z_{2}}}{1+e^{z_{2}}%
}(z_{1}-z_{2})
\displaystyle=\log(1+e^{z_{1}})-\log(1+e^{z_{2}})-\frac{e^{z_{2}}}{1+e^{z_{2}}%
}(z_{1}-z_{2})
\displaystyle=\log\frac{e^{z_{2}}}{1+e^{z_{2}}}-\log\frac{e^{z_{1}}}{1+e^{z_{1%
}}}+\left(1-\frac{e^{z_{2}}}{1+e^{z_{2}}}\right)(z_{1}-z_{2})
\displaystyle=\log\frac{e^{z_{2}}}{1+e^{z_{2}}}-\log\frac{e^{z_{1}}}{1+e^{z_{1%
}}}+\left(1-\frac{e^{z_{2}}}{1+e^{z_{2}}}\right)(z_{1}-z_{2})
\displaystyle=\log\mu_{2}-\log\mu_{1}+(1-\mu_{2})\log\frac{\mu_{1}(1-\mu_{2})}%
{\mu_{2}(1-\mu_{1})}
\displaystyle=\log\mu_{2}-\log\mu_{1}+(1-\mu_{2})\log\frac{\mu_{1}(1-\mu_{2})}%
{\mu_{2}(1-\mu_{1})}
\displaystyle=\mu_{2}\log\frac{\mu_{2}}{\mu_{1}}+(1-\mu_{2})\log\frac{1-\mu_{2%
}}{1-\mu_{1}}=\mathrm{KL}(\mu_{2},\mu_{1}).
\displaystyle=\mu_{2}\log\frac{\mu_{2}}{\mu_{1}}+(1-\mu_{2})\log\frac{1-\mu_{2%
}}{1-\mu_{1}}=\mathrm{KL}(\mu_{2},\mu_{1}).
1-\delta
{\mathcal{L}}_{t}(\bm{\theta}_{\star})-{\mathcal{L}}_{t}(\widehat{\bm{\theta}}%
_{t})\leq\beta_{t}(\delta)^{2}
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
{\mathcal{L}}_{t}(\bm{\theta})
\bm{\theta}_{\star}
\displaystyle{\mathcal{L}}_{t}(\bm{\theta})={\mathcal{L}}_{t}(\bm{\theta}_{%
\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{\theta}-%
\bm{\theta}_{\star})+\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{%
\bm{G}}}(\bm{\theta}_{\star},\bm{\theta})-\lambda_{t}{\bm{I}}}^{2}
\displaystyle{\mathcal{L}}_{t}(\bm{\theta})
\displaystyle={\mathcal{L}}_{t}(\bm{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})^{\intercal}(\bm{\theta}-\bm{\theta}_{\star})+\lVert\bm{%
\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}(\bm{\theta}_{\star},%
\bm{\theta})-\lambda_{t}{\bm{I}}}^{2}
\displaystyle={\mathcal{L}}_{t}(\bm{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})^{\intercal}(\bm{\theta}-\bm{\theta}_{\star})+\lVert\bm{%
\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}(\bm{\theta}_{\star},%
\bm{\theta})}^{2}-\lambda_{t}\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{2}^{%
2}.
\displaystyle={\mathcal{L}}_{t}(\bm{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})^{\intercal}(\bm{\theta}-\bm{\theta}_{\star})+\lVert\bm{%
\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}(\bm{\theta}_{\star},%
\bm{\theta})}^{2}-\lambda_{t}\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{2}^{%
2}.
\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{1},\bm{\theta}_{2})\succeq\frac{1}{2+2S}%
{\bm{H}}_{t}(\bm{\theta}_{1})
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{%
\theta}_{\star})}^{2}\leq(2+2S)\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{%
\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{%
\theta}_{\star})}^{2}
\displaystyle\leq(2+2S)\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde%
{{\bm{G}}}_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}
\displaystyle=(2+2S)\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\bm%
{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm%
{\theta}_{\star}-\bm{\theta})+\lambda_{t}\lVert\bm{\theta}-\bm{\theta}_{\star}%
\rVert_{2}^{2}\right)
\displaystyle=(2+2S)\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\bm%
{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm%
{\theta}_{\star}-\bm{\theta})+\lambda_{t}\lVert\bm{\theta}-\bm{\theta}_{\star}%
\rVert_{2}^{2}\right)
\displaystyle\leq(2+2S)\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(%
\widehat{\bm{\theta}}_{t})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{%
\intercal}(\bm{\theta}_{\star}-\bm{\theta})+\lambda_{t}\lVert\bm{\theta}-\bm{%
\theta}_{\star}\rVert_{2}^{2}\right)
\displaystyle\leq(2+2S)\left({\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(%
\widehat{\bm{\theta}}_{t})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{%
\intercal}(\bm{\theta}_{\star}-\bm{\theta})+\lambda_{t}\lVert\bm{\theta}-\bm{%
\theta}_{\star}\rVert_{2}^{2}\right)
\displaystyle\leq 1+(2+2S)\beta_{t}(\delta)^{2}+(2+2S)\nabla{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}),\quad\text{w%
.p. at least $1-\delta$},
1-\delta
\displaystyle\leq 1+(2+2S)\beta_{t}(\delta)^{2}+(2+2S)\nabla{\mathcal{L}}_{t}(%
\bm{\theta}_{\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}),\quad\text{w%
.p. at least $1-\delta$},
1-\delta
\lambda_{t}=\frac{1}{4S^{2}(2+2S)}
\lambda_{t}
\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{\theta}_{\star}-%
\bm{\theta})
{\mathcal{B}}_{d}(2S)
d
2S
{\bm{v}}\in{\mathcal{B}}_{d}(2S)
\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}{\bm{v}}=\sum_{s=1}^{t%
}(\mu({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})-r_{s}){\bm{x}}_{s}^{%
\intercal}{\bm{v}}=\sum_{s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}},
\xi_{s}:=\mu({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})-r_{s}
\xi_{s}
{\mathcal{F}}_{s-1}=\sigma\left(\{{\bm{x}}_{1},r_{1},\cdots,{\bm{x}}_{s-1},r_{%
s-1},{\bm{x}}_{s}\}\right)
\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}}
|\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}}|\leq 2S
\mathbb{E}[(\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}})^{2}|{\mathcal{F}}_{s-1}]=%
\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})({\bm{x}}_{s}^{\intercal%
}{\bm{v}})^{2}
\eta\in\left[0,\frac{1}{2S}\right]
{\mathbb{P}}\left[\sum_{s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}}\leq(e-%
2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})({%
\bm{x}}_{s}^{\intercal}{\bm{v}})^{2}+\frac{1}{\eta}\log\frac{1}{\delta}\right]%
\geq 1-\delta.
\varepsilon_{t}\in(0,1)
\varepsilon_{t}<\varepsilon_{t+1}
\hat{\mathcal{B}}_{\varepsilon_{t}}
\varepsilon_{t}
{\mathcal{B}}_{d}(2S)
\forall{\bm{v}}\in{\mathcal{B}}_{d}(2S),\ \exists{\bm{w}}({\bm{v}})\in\hat{%
\mathcal{B}}_{\varepsilon_{t}}:\lVert{\bm{v}}-{\bm{w}}({\bm{v}})\rVert_{2}\leq%
\varepsilon_{t}.
|\hat{\mathcal{B}}_{\varepsilon_{t}}|\leq\left(\frac{5S}{\varepsilon_{t}}%
\right)^{d}
t\geq 1
{\bm{v}}\in\hat{\mathcal{B}}_{\varepsilon_{t}}
\delta_{t}=\left(\frac{\varepsilon_{t}}{5S}\right)^{d}\frac{\delta}{t}
\eta\in[0,2S]
1-\delta
\sum_{s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}}\leq(e-2)\eta\sum_{s=1}^{%
t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star})({\bm{x}}_{s}^{%
\intercal}{\bm{v}})^{2}+\frac{d}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{%
\eta}\log\frac{1}{\delta},\quad\forall{\bm{v}}\in\hat{\mathcal{B}}(\varepsilon%
_{t}),\ \forall t\geq 1.
{\bm{v}}_{t}\in\hat{\mathcal{B}}_{\varepsilon_{t}}
\lVert(\bm{\theta}_{\star}-\bm{\theta})-{\bm{v}}_{t}\rVert_{2}\leq\varepsilon_%
{t}
\displaystyle\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{%
\theta}_{\star}-\bm{\theta})
\displaystyle\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{%
\theta}_{\star}-\bm{\theta})
\displaystyle=\sum_{s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}}_{t}+\sum_{%
s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}\left((\bm{\theta}_{\star}-\bm{\theta})%
-{\bm{v}}_{t}\right)
\displaystyle=\sum_{s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}{\bm{v}}_{t}+\sum_{%
s=1}^{t}\xi_{s}{\bm{x}}_{s}^{\intercal}\left((\bm{\theta}_{\star}-\bm{\theta})%
-{\bm{v}}_{t}\right)
1-\delta
1-\delta
1-\delta
\displaystyle\leq(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{%
\theta}_{\star})({\bm{x}}_{s}^{\intercal}{\bm{v}}_{t})^{2}+\frac{d}{\eta}\log%
\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle\leq(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{%
\theta}_{\star})({\bm{x}}_{s}^{\intercal}{\bm{v}}_{t})^{2}+\frac{d}{\eta}\log%
\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle=(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{%
\theta}_{\star})({\bm{x}}_{s}^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}))^{2%
}+(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star}%
)\left(({\bm{x}}_{s}^{\intercal}{\bm{v}}_{t})^{2}-({\bm{x}}_{s}^{\intercal}(%
\bm{\theta}_{\star}-\bm{\theta}))^{2}\right)+\frac{d}{\eta}\log\frac{5S}{%
\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle=(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{%
\theta}_{\star})({\bm{x}}_{s}^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}))^{2%
}+(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^{\intercal}\bm{\theta}_{\star}%
)\left(({\bm{x}}_{s}^{\intercal}{\bm{v}}_{t})^{2}-({\bm{x}}_{s}^{\intercal}(%
\bm{\theta}_{\star}-\bm{\theta}))^{2}\right)+\frac{d}{\eta}\log\frac{5S}{%
\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle\overset{(*)}{\leq}(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^%
{\intercal}\bm{\theta}_{\star})({\bm{x}}_{s}^{\intercal}(\bm{\theta}_{\star}-%
\bm{\theta}))^{2}+\frac{(e-2)\eta}{4}(4S\varepsilon_{t}+\varepsilon_{t}^{2})t+%
\frac{d}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta%
}+\varepsilon_{t}t
\displaystyle\overset{(*)}{\leq}(e-2)\eta\sum_{s=1}^{t}\dot{\mu}({\bm{x}}_{s}^%
{\intercal}\bm{\theta}_{\star})({\bm{x}}_{s}^{\intercal}(\bm{\theta}_{\star}-%
\bm{\theta}))^{2}+\frac{(e-2)\eta}{4}(4S\varepsilon_{t}+\varepsilon_{t}^{2})t+%
\frac{d}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta%
}+\varepsilon_{t}t
\displaystyle=(e-2)\eta\lVert\bm{\theta}_{\star}-\bm{\theta}\rVert_{{\bm{H}}_{%
t}(\bm{\theta}_{\star})}^{2}+\frac{d}{\eta}\log\frac{5S}{\varepsilon_{t}}+%
\frac{1}{\eta}\log\frac{1}{\delta}+\left(\frac{(e-2)}{4}\left(4S\eta+%
\varepsilon_{t}\eta\right)+1\right)\varepsilon_{t}t.
\displaystyle=(e-2)\eta\lVert\bm{\theta}_{\star}-\bm{\theta}\rVert_{{\bm{H}}_{%
t}(\bm{\theta}_{\star})}^{2}+\frac{d}{\eta}\log\frac{5S}{\varepsilon_{t}}+%
\frac{1}{\eta}\log\frac{1}{\delta}+\left(\frac{(e-2)}{4}\left(4S\eta+%
\varepsilon_{t}\eta\right)+1\right)\varepsilon_{t}t.
(*)
\dot{\mu}\leq\frac{1}{4}
({\bm{x}}_{s}^{\intercal}{\bm{a}})^{2}-({\bm{x}}_{s}^{\intercal}{\bm{b}})^{2}=%
2{\bm{x}}_{s}^{\intercal}{\bm{b}}{\bm{x}}_{s}^{\intercal}({\bm{b}}-{\bm{a}})+(%
{\bm{x}}_{s}^{\intercal}({\bm{a}}-{\bm{b}}))^{2}\leq 4S\varepsilon_{t}+%
\varepsilon_{t}^{2}
{\bm{a}},{\bm{b}}\in\hat{\mathcal{B}}_{\varepsilon_{t}}
\eta=\frac{1}{2(e-2)(2+2S)}<\frac{1}{2S}
\varepsilon_{t}=\frac{d}{t}
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{%
\theta}_{\star})}^{2}\lesssim dS^{2}\log\left(e+\frac{St}{d}\right)+S^{2}\log%
\frac{1}{\delta}.
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{{\bm{H}}_{t}(\bm{%
\theta}_{\star})}^{2}\lesssim dS^{2}\log\left(e+\frac{St}{d}\right)+S^{2}\log%
\frac{1}{\delta}.
{\bm{A}}({\bm{x}},\bm{\Theta}):=\mathrm{diag}(\bm{\mu}({\bm{x}},\bm{\Theta}))-%
\bm{\mu}({\bm{x}},\bm{\Theta})\bm{\mu}({\bm{x}},\bm{\Theta})^{\intercal}
\displaystyle{\bm{H}}_{t}(\bm{\Theta}):=\lambda{\bm{I}}_{Kd}+\sum_{s=1}^{t-1}{%
\bm{A}}({\bm{x}}_{s},\bm{\Theta})\otimes{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}
\displaystyle{\bm{H}}_{t}(\bm{\Theta})
\displaystyle:=\lambda{\bm{I}}_{Kd}+\sum_{s=1}^{t-1}{\bm{A}}({\bm{x}}_{s},\bm{%
\Theta})\otimes{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal}
\displaystyle{\bm{B}}({\bm{x}},\bm{\Theta}_{1},\bm{\Theta}_{2}):=\int_{0}^{1}{%
\bm{A}}({\bm{x}},\bm{\Theta}_{1}+v(\bm{\Theta}_{2}-\bm{\Theta}_{1}))dv,
\displaystyle{\bm{B}}({\bm{x}},\bm{\Theta}_{1},\bm{\Theta}_{2})
\displaystyle:=\int_{0}^{1}{\bm{A}}({\bm{x}},\bm{\Theta}_{1}+v(\bm{\Theta}_{2}%
-\bm{\Theta}_{1}))dv,
\displaystyle{\bm{G}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2}):=\lambda{\bm{I}}_{%
Kd}+\sum_{s=1}^{t-1}{\bm{B}}({\bm{x}}_{s},\bm{\Theta}_{1},\bm{\Theta}_{2})%
\otimes{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal},
\displaystyle{\bm{G}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2})
\displaystyle:=\lambda{\bm{I}}_{Kd}+\sum_{s=1}^{t-1}{\bm{B}}({\bm{x}}_{s},\bm{%
\Theta}_{1},\bm{\Theta}_{2})\otimes{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal},
\displaystyle\widetilde{{\bm{B}}}({\bm{x}},\bm{\Theta}_{1},\bm{\Theta}_{2}):=%
\int_{0}^{1}(1-v){\bm{A}}({\bm{x}},\bm{\Theta}_{1}+v(\bm{\Theta}_{2}-\bm{%
\Theta}_{1}))dv,
\displaystyle\widetilde{{\bm{B}}}({\bm{x}},\bm{\Theta}_{1},\bm{\Theta}_{2})
\displaystyle:=\int_{0}^{1}(1-v){\bm{A}}({\bm{x}},\bm{\Theta}_{1}+v(\bm{\Theta%
}_{2}-\bm{\Theta}_{1}))dv,
\displaystyle\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2}):=%
\lambda{\bm{I}}_{Kd}+\sum_{s=1}^{t-1}\widetilde{{\bm{B}}}({\bm{x}}_{s},\bm{%
\Theta}_{1},\bm{\Theta}_{2})\otimes{\bm{x}}_{s}{\bm{x}}_{s}^{\intercal},
\displaystyle\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2})
\displaystyle:=\lambda{\bm{I}}_{Kd}+\sum_{s=1}^{t-1}\widetilde{{\bm{B}}}({\bm{%
x}}_{s},\bm{\Theta}_{1},\bm{\Theta}_{2})\otimes{\bm{x}}_{s}{\bm{x}}_{s}^{%
\intercal},
\displaystyle{\bm{V}}_{t}:=2\kappa(T)\lambda{\bm{I}}_{d}+\sum_{s=1}^{t-1}{\bm{%
x}}_{s}{\bm{x}}_{s}^{\intercal},
\displaystyle{\bm{V}}_{t}
\displaystyle:=2\kappa(T)\lambda{\bm{I}}_{d}+\sum_{s=1}^{t-1}{\bm{x}}_{s}{\bm{%
x}}_{s}^{\intercal},
\lambda>0
\displaystyle\kappa(T)=\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{%
\bm{\Theta}\in{\mathcal{B}}^{K\times d}(S)}\frac{1}{\lambda_{\min}\left({\bm{A%
}}({\bm{x}},\bm{\Theta})\right)},
\displaystyle\kappa(T)
\displaystyle=\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{\bm{%
\Theta}\in{\mathcal{B}}^{K\times d}(S)}\frac{1}{\lambda_{\min}\left({\bm{A}}({%
\bm{x}},\bm{\Theta})\right)},
\displaystyle L_{T}=\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{\bm%
{\Theta}\in{\mathcal{B}}^{K\times d}(S)}\lambda_{\max}\left({\bm{A}}({\bm{x}},%
\bm{\Theta})\right),
\displaystyle L_{T}
\displaystyle=\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{\bm{%
\Theta}\in{\mathcal{B}}^{K\times d}(S)}\lambda_{\max}\left({\bm{A}}({\bm{x}},%
\bm{\Theta})\right),
\displaystyle M_{T}\geq\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{%
\bm{\Theta}\in{\mathcal{B}}^{K\times d}(S)}\max_{k\in[K]}\left|\lambda_{\max}%
\left(\nabla^{2}\mu_{k}({\bm{x}},\bm{\Theta})\right)\right|,
\displaystyle M_{T}
\displaystyle\geq\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{\bm{%
\Theta}\in{\mathcal{B}}^{K\times d}(S)}\max_{k\in[K]}\left|\lambda_{\max}\left%
(\nabla^{2}\mu_{k}({\bm{x}},\bm{\Theta})\right)\right|,
\displaystyle M_{T}^{\prime}\geq\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{%
t}}\max_{\bm{\Theta}\in{\mathcal{B}}^{K\times d}(S)}\max_{k,k^{\prime}\in[K]}%
\left|\lambda_{\max}\left(\nabla[{\bm{A}}({\bm{x}},\bm{\Theta})_{k,k^{\prime}}%
]\right)\right|.
\displaystyle M_{T}^{\prime}
\displaystyle\geq\max_{t\in[T]}\max_{{\bm{x}}\in{\mathcal{X}}_{t}}\max_{\bm{%
\Theta}\in{\mathcal{B}}^{K\times d}(S)}\max_{k,k^{\prime}\in[K]}\left|\lambda_%
{\max}\left(\nabla[{\bm{A}}({\bm{x}},\bm{\Theta})_{k,k^{\prime}}]\right)\right|.
A\lesssim B
A\leq cB
c
{\bm{y}}_{s}=\bm{\mu}({\bm{x}}_{s},\bm{\Theta}_{\star})+\bm{\xi}_{s},
\bm{\xi}_{s}
{\bm{y}}_{s}=(y_{s,1},\cdots,y_{s,K})\in\{0,1\}^{K}
\bm{\Theta},\bm{\Theta}_{\star}\in{\mathbb{R}}^{K\times d}
\ell_{s}(\bm{\Theta}_{\star})=\ell_{s}(\bm{\Theta})-\mathrm{KL}(\bm{\mu}({\bm{%
x}}_{s},\bm{\Theta}_{\star}),\bm{\mu}({\bm{x}}_{s},\bm{\Theta}))+\bm{\xi}^{%
\intercal}(\bm{\Theta}-\bm{\Theta}_{\star}){\bm{x}}_{s}.
\{\widetilde{\bm{\Theta}}_{s}\}\subset{\mathcal{B}}^{K\times d}(\sqrt{K}S)
\sum_{s=1}^{t}\ell_{s}(\bm{\Theta}_{\star})-\ell_{s}(\widehat{\bm{\Theta}}_{t}%
)\leq\mathrm{Reg}^{O}(t)+\zeta_{1}(t)-\zeta_{2}(t),
\zeta_{1}(t):=\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{%
s}-\bm{\Theta}_{\star}){\bm{x}}_{s},\quad\zeta_{2}(t):=\sum_{s=1}^{t}\mathrm{%
KL}(\bm{\mu}({\bm{x}}_{s},\bm{\Theta}_{\star}),\bm{\mu}({\bm{x}}_{s},%
\widetilde{\bm{\Theta}}_{s})).
\mathrm{Reg}^{O}(T)
\mathrm{Reg}^{O}(t)\leq 5d(K+1)\log\left(e+\frac{St}{d(K+1)}\right).
S
\zeta_{1}(t)
{\mathcal{F}}_{s-1}
\sigma
({\bm{x}}_{1},{\bm{y}}_{1},\cdots,{\bm{x}}_{s-1},{\bm{y}}_{s-1},{\bm{x}}_{s})
{\bm{x}}_{s}
\widetilde{\bm{\Theta}}_{s}
{\mathcal{F}}_{s-1}
\bm{\xi}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{%
x}}_{s}
{\mathcal{F}}_{s-1}
|\bm{\xi}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm%
{x}}_{s}|\leq 2\sqrt{K}S
\displaystyle\mathbb{E}\left[\left(\bm{\xi}_{s}^{\intercal}(\widetilde{\bm{%
\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}\right)^{2}|{\mathcal{F}}_{s-1}%
\right]={\bm{x}}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{%
\star})^{\intercal}\mathbb{E}[\bm{\xi}_{s}\bm{\xi}_{s}^{\intercal}|{\mathcal{F%
}}_{s-1}](\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}
\displaystyle\mathbb{E}\left[\left(\bm{\xi}_{s}^{\intercal}(\widetilde{\bm{%
\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}\right)^{2}|{\mathcal{F}}_{s-1}\right]
\displaystyle={\bm{x}}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}%
_{\star})^{\intercal}\mathbb{E}[\bm{\xi}_{s}\bm{\xi}_{s}^{\intercal}|{\mathcal%
{F}}_{s-1}](\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}
\displaystyle={\bm{x}}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}%
_{\star})^{\intercal}\underbrace{\left(\mathrm{diag}(\{\mu_{k}((\bm{\theta}_{%
\star}^{(k)})^{\intercal}{\bm{x}}_{s})\}_{k=1}^{K})-\bm{\mu}_{s}\bm{\mu}_{s}^{%
\intercal}\right)}_{\triangleq{\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{\star})}(%
\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}\triangleq\sigma_{%
s}^{2}.
\displaystyle={\bm{x}}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}%
_{\star})^{\intercal}\underbrace{\left(\mathrm{diag}(\{\mu_{k}((\bm{\theta}_{%
\star}^{(k)})^{\intercal}{\bm{x}}_{s})\}_{k=1}^{K})-\bm{\mu}_{s}\bm{\mu}_{s}^{%
\intercal}\right)}_{\triangleq{\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{\star})}(%
\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}\triangleq\sigma_{%
s}^{2}.
\eta\in\left[0,\frac{1}{2\sqrt{K}S}\right]
{\mathbb{P}}\left[\zeta_{1}(t)=\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}(%
\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}\leq(e-2)\eta\sum_%
{s=1}^{t}\sigma_{s}^{2}+\frac{1}{\eta}\log\frac{1}{\delta},\quad\forall t\geq 1%
\right]\geq 1-\delta.
\zeta_{2}(t)
m({\bm{z}}):=\log\left(1+\sum_{k=1}^{K}e^{z_{k}}\right)
\bm{\mu}({\bm{z}})=(\mu_{1},\cdots,\mu_{K})
\mu_{k}:=\frac{e^{z_{k}}}{1+\sum_{k=1}^{K}e^{z_{i}}}
\mathrm{KL}(\bm{\mu}({\bm{z}}^{(2)}),\bm{\mu}({\bm{z}}^{(1)}))=D_{m}({\bm{z}}^%
{(1)},{\bm{z}}^{(2)})
f:{\mathbb{R}}^{d}\rightarrow{\mathbb{R}}
\varphi_{{\bm{x}},{\bm{u}}}(t):=f({\bm{x}}+t{\bm{u}})
{\bm{x}}\in\mathrm{dom}(f)
{\bm{u}}\in{\mathbb{R}}^{d}
f
M_{f}
{\bm{x}},{\bm{u}}
|\varphi_{{\bm{x}},{\bm{u}}}^{\prime\prime\prime}(t)|\leq M_{f}\varphi_{{\bm{x%
}},{\bm{u}}}^{\prime\prime}(t)\lVert{\bm{u}}\rVert_{2},\quad\forall t\in{%
\mathbb{R}},M_{f}>0.
f:{\mathbb{R}}^{d}\rightarrow{\mathbb{R}}
M_{f}
{\mathcal{Z}}\subset{\mathbb{R}}^{d}
{\bm{z}}_{1},{\bm{z}}_{2}\in{\mathcal{Z}}
\int_{0}^{1}(1-v)\nabla^{2}f({\bm{z}}_{1}+v({\bm{z}}_{2}-{\bm{z}}_{1}))dv%
\succeq\frac{1}{2+M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2}}\nabla^{2}f({%
\bm{z}}_{1}).
m
\sqrt{6}
\displaystyle\mathrm{KL}(\bm{\mu}_{\star},\tilde{\bm{\mu}})=D_{m}(\widetilde{%
\bm{\Theta}}_{s}{\bm{x}}_{s},\bm{\Theta}_{\star}{\bm{x}}_{s})
\displaystyle\mathrm{KL}(\bm{\mu}_{\star},\tilde{\bm{\mu}})
\displaystyle=D_{m}(\widetilde{\bm{\Theta}}_{s}{\bm{x}}_{s},\bm{\Theta}_{\star%
}{\bm{x}}_{s})
\displaystyle={\bm{x}}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}%
_{\star})^{\intercal}\left\{\int_{0}^{1}(1-v)\nabla^{2}m(\bm{\Theta}_{\star}{%
\bm{x}}_{s}+v(\widetilde{\bm{\Theta}}_{s}{\bm{x}}_{s}-\bm{\Theta}_{\star}{\bm{%
x}}_{s}))dv\right\}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}
\displaystyle={\bm{x}}_{s}^{\intercal}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}%
_{\star})^{\intercal}\left\{\int_{0}^{1}(1-v)\nabla^{2}m(\bm{\Theta}_{\star}{%
\bm{x}}_{s}+v(\widetilde{\bm{\Theta}}_{s}{\bm{x}}_{s}-\bm{\Theta}_{\star}{\bm{%
x}}_{s}))dv\right\}(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}
\displaystyle\geq\frac{1}{2+\sqrt{6}\lVert(\widetilde{\bm{\Theta}}_{s}-\bm{%
\Theta}_{\star}){\bm{x}}_{s}\rVert_{2}}{\bm{x}}_{s}^{\intercal}(\widetilde{\bm%
{\Theta}}_{s}-\bm{\Theta}_{\star})^{\intercal}\nabla^{2}m(\bm{\Theta}_{\star}{%
\bm{x}}_{s})(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}
\displaystyle\geq\frac{1}{2+\sqrt{6}\lVert(\widetilde{\bm{\Theta}}_{s}-\bm{%
\Theta}_{\star}){\bm{x}}_{s}\rVert_{2}}{\bm{x}}_{s}^{\intercal}(\widetilde{\bm%
{\Theta}}_{s}-\bm{\Theta}_{\star})^{\intercal}\nabla^{2}m(\bm{\Theta}_{\star}{%
\bm{x}}_{s})(\widetilde{\bm{\Theta}}_{s}-\bm{\Theta}_{\star}){\bm{x}}_{s}
\displaystyle\geq\frac{1}{2+2\sqrt{6K}S}\sigma_{s}^{2},
\displaystyle\geq\frac{1}{2+2\sqrt{6K}S}\sigma_{s}^{2},
\zeta_{2}(t)\geq\frac{1}{2+2\sqrt{6K}S}\sum_{s=1}^{t}\sigma_{s}^{2}.
\eta=\frac{1}{2(e-2)+2\sqrt{6K}S}<\frac{1}{2\sqrt{K}S}
-\frac{1}{2+2\sqrt{6K}S}+\frac{e-2}{2(e-2)+2\sqrt{6K}S}<0
1-\delta
\displaystyle\mathrm{Reg}^{B}(T)\lesssim L_{T}R\sqrt{d\sqrt{K}S}\left(\sqrt{d%
\sqrt{K}\log\left(e+\frac{ST}{dK}\right)}+\sqrt{\log\frac{1}{\delta}}\right)%
\sqrt{\kappa(T)T\log\left(1+\frac{ST}{dK\kappa(T)}\right)}
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim L_{T}R\sqrt{d\sqrt{K}S}\left(\sqrt{d\sqrt{K}\log\left(e+%
\frac{ST}{dK}\right)}+\sqrt{\log\frac{1}{\delta}}\right)\sqrt{\kappa(T)T\log%
\left(1+\frac{ST}{dK\kappa(T)}\right)}
\displaystyle=\widetilde{{\mathcal{O}}}\left(Rd\sqrt{KS\kappa(T)T}\right),
\displaystyle=\widetilde{{\mathcal{O}}}\left(Rd\sqrt{KS\kappa(T)T}\right),
\displaystyle\mathrm{Reg}_{imp}^{B}(T)\lesssim R\sqrt{d}K^{\frac{1}{4}}S\sqrt{%
\left(d\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)%
\log\left(1+\frac{S^{2}T}{d}\right)T}
\displaystyle\mathrm{Reg}_{imp}^{B}(T)
\displaystyle\lesssim R\sqrt{d}K^{\frac{1}{4}}S\sqrt{\left(d\sqrt{K}\log\left(%
e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)\log\left(1+\frac{S^{2}T}{d}%
\right)T}
\displaystyle\quad+RdK^{\frac{3}{2}}S^{\frac{3}{2}}\max\{M_{T},M_{T}^{\prime}%
\}\left(d\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)%
\log\left(1+\frac{ST}{dK\kappa(T)}\right)\kappa(T)
\displaystyle\quad+RdK^{\frac{3}{2}}S^{\frac{3}{2}}\max\{M_{T},M_{T}^{\prime}%
\}\left(d\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)%
\log\left(1+\frac{ST}{dK\kappa(T)}\right)\kappa(T)
\displaystyle=\widetilde{{\mathcal{O}}}\left(RdS\sqrt{KT}+Rd^{2}K^{2}S^{\frac{%
3}{2}}\kappa(T)\right).
\displaystyle=\widetilde{{\mathcal{O}}}\left(RdS\sqrt{KT}+Rd^{2}K^{2}S^{\frac{%
3}{2}}\kappa(T)\right).
\lambda=\frac{dK^{\frac{3}{2}}}{S}\left(\log\left(1+\frac{ST}{dK}\right)+\log%
\frac{1}{\delta}\right)
1-\delta
\displaystyle\mathrm{Reg}^{B}(T)\lesssim L_{T}RdK^{\frac{3}{4}}S\left(\log%
\left(1+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)\sqrt{\max\left(\frac{%
S}{dK^{\frac{3}{4}}\log\frac{ST}{dK\delta}},\kappa(T)\right)T}
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim L_{T}RdK^{\frac{3}{4}}S\left(\log\left(1+\frac{ST}{dK}%
\right)+\log\frac{1}{\delta}\right)\sqrt{\max\left(\frac{S}{dK^{\frac{3}{4}}%
\log\frac{ST}{dK\delta}},\kappa(T)\right)T}
\displaystyle=\widetilde{{\mathcal{O}}}\left(RdK^{\frac{3}{4}}S\sqrt{\kappa(T)%
T}\right),
\displaystyle=\widetilde{{\mathcal{O}}}\left(RdK^{\frac{3}{4}}S\sqrt{\kappa(T)%
T}\right),
\displaystyle\mathrm{Reg}_{imp}^{B}(T)\lesssim RdK^{\frac{5}{4}}S^{\frac{3}{2}%
}\left(\log\left(1+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)\sqrt{T}
\displaystyle\mathrm{Reg}_{imp}^{B}(T)
\displaystyle\lesssim RdK^{\frac{5}{4}}S^{\frac{3}{2}}\left(\log\left(1+\frac{%
ST}{dK}\right)+\log\frac{1}{\delta}\right)\sqrt{T}
\displaystyle\ +Rd^{2}K^{2}S^{2}(M_{T}^{\prime}\sqrt{KS}+M_{T})\left(\left(%
\log\left(1+\frac{ST}{dK}\right)\right)^{2}+\left(\log\frac{1}{\delta}\right)^%
{2}\right)\max\left(\frac{S}{dK^{\frac{3}{2}}\log\frac{ST}{dK\delta}},\kappa(T%
)\right)
\displaystyle\ +Rd^{2}K^{2}S^{2}(M_{T}^{\prime}\sqrt{KS}+M_{T})\left(\left(%
\log\left(1+\frac{ST}{dK}\right)\right)^{2}+\left(\log\frac{1}{\delta}\right)^%
{2}\right)\max\left(\frac{S}{dK^{\frac{3}{2}}\log\frac{ST}{dK\delta}},\kappa(T%
)\right)
\displaystyle=\widetilde{{\mathcal{O}}}\left(RdK^{\frac{5}{4}}S^{\frac{3}{2}}%
\sqrt{T}+Rd^{2}K^{\frac{5}{2}}S^{\frac{5}{2}}\kappa(T)\right).
\displaystyle=\widetilde{{\mathcal{O}}}\left(RdK^{\frac{5}{4}}S^{\frac{3}{2}}%
\sqrt{T}+Rd^{2}K^{\frac{5}{2}}S^{\frac{5}{2}}\kappa(T)\right).
\lambda=\frac{dK}{S}\log\frac{1}{\delta}
1-\delta
\displaystyle\mathrm{Reg}^{B}(T)\lesssim R\min\left\{dS\sqrt{K\kappa(T)T},dKS^%
{\frac{3}{2}}\sqrt{T}+d^{2}KS\kappa(T)\sqrt{\log\frac{1+\frac{T}{d}}{\delta}%
\log\left(1+\frac{T}{d}\right)}\right\}\sqrt{\log\frac{1+\frac{T}{d}}{\delta}%
\log\left(1+\frac{T}{d}\right)}
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim R\min\left\{dS\sqrt{K\kappa(T)T},dKS^{\frac{3}{2}}\sqrt{%
T}+d^{2}KS\kappa(T)\sqrt{\log\frac{1+\frac{T}{d}}{\delta}\log\left(1+\frac{T}{%
d}\right)}\right\}\sqrt{\log\frac{1+\frac{T}{d}}{\delta}\log\left(1+\frac{T}{d%
}\right)}
\displaystyle=\widetilde{{\mathcal{O}}}\left(R\min\left\{dS\sqrt{K\kappa(T)T},%
dKS^{\frac{3}{2}}\sqrt{T}+d^{2}KS\kappa(T)\right\}\right).
\displaystyle=\widetilde{{\mathcal{O}}}\left(R\min\left\{dS\sqrt{K\kappa(T)T},%
dKS^{\frac{3}{2}}\sqrt{T}+d^{2}KS\kappa(T)\right\}\right).
dK\gtrsim S
\lambda=dKS
1-\delta
\mathrm{Reg}^{B}(T)\lesssim RdKS^{\frac{3}{2}}\left(\sqrt{T\log\left(1+\frac{T%
\tilde{L}}{dKS}\right)}+dS^{\frac{3}{2}}\kappa(T)\log\left(1+\frac{T}{dKS%
\kappa(T)}\right)\right),
\tilde{L}
\mathrm{Reg}^{B}(T)\lesssim RdS^{\frac{3}{2}}\sqrt{K\kappa(T)T\log\left(1+%
\frac{T}{d^{2}KS\kappa(T)}\right)}+Rd^{2}KS^{3}\kappa(T)\log\left(1+\frac{T}{%
dKS\kappa(T)}\right),
\log\frac{1}{\delta}
dK\gtrsim S
S
dK
\bm{\Theta}
\bm{\theta}
\bm{\theta}=\mathrm{vec}(\bm{\Theta}^{\intercal})=\begin{bmatrix}\bm{\theta}^{%
(1)}\\
\vdots\\
\bm{\theta}^{(K)}\end{bmatrix}\in{\mathbb{R}}^{Kd\times 1}
\bm{\theta}^{(k)}\in{\mathbb{R}}^{d}
k
\bm{\Theta}
\left(\bm{\theta}^{(k)}\right)^{\intercal}
\lambda=\frac{K}{4S^{2}}
\bm{\Theta}\in{\mathcal{C}}_{t}(\delta)
1-\delta
\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{%
\Theta}_{\star},\bm{\Theta})}^{2}\lesssim\gamma_{t}(\delta)^{2}\triangleq dKS%
\log\left(e+\frac{St}{dK}\right)+\sqrt{K}S\log\frac{1}{\delta}+dKL_{T},
dKL_{T}
\epsilon_{t}({\bm{x}})
{\bm{x}}\in{\mathcal{X}}_{t}
t\in[T]
\Delta({\bm{x}},\bm{\Theta}_{t}):=\left|\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}%
,\bm{\Theta}_{\star})-\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}},\bm{\Theta}_{t})%
\right|\leq\epsilon_{t}({\bm{x}}),
{\bm{x}}_{t}=\operatorname*{arg\,max}_{{\bm{x}}\in{\mathcal{X}}_{t}}\bm{\rho}^%
{\intercal}\bm{\mu}({\bm{x}},\bm{\Theta}_{t})+\epsilon_{t}({\bm{x}}).
\displaystyle\mathrm{Reg}^{B}(T)=\sum_{t=1}^{T}\left\{\bm{\rho}^{\intercal}\bm%
{\mu}({\bm{x}}_{t,\star},\bm{\Theta}_{\star})-\bm{\rho}^{\intercal}\bm{\mu}({%
\bm{x}}_{t},\bm{\Theta}_{\star})\right\}
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle=\sum_{t=1}^{T}\left\{\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}_{t,%
\star},\bm{\Theta}_{\star})-\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}_{t},\bm{%
\Theta}_{\star})\right\}
\displaystyle\leq\sum_{t=1}^{T}\left\{\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}_{%
t,\star},\bm{\Theta}_{t})+\epsilon_{t}({\bm{x}}_{t,\star})-\bm{\rho}^{%
\intercal}\bm{\mu}({\bm{x}}_{t},\bm{\Theta}_{\star})\right\}
\displaystyle\leq\sum_{t=1}^{T}\left\{\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}_{%
t,\star},\bm{\Theta}_{t})+\epsilon_{t}({\bm{x}}_{t,\star})-\bm{\rho}^{%
\intercal}\bm{\mu}({\bm{x}}_{t},\bm{\Theta}_{\star})\right\}
\displaystyle\leq\sum_{t=1}^{T}\left\{\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}_{%
t},\bm{\Theta}_{t})+\epsilon_{t}({\bm{x}}_{t})-\bm{\rho}^{\intercal}\bm{\mu}({%
\bm{x}}_{t},\bm{\Theta}_{\star})\right\}
\displaystyle\leq\sum_{t=1}^{T}\left\{\bm{\rho}^{\intercal}\bm{\mu}({\bm{x}}_{%
t},\bm{\Theta}_{t})+\epsilon_{t}({\bm{x}}_{t})-\bm{\rho}^{\intercal}\bm{\mu}({%
\bm{x}}_{t},\bm{\Theta}_{\star})\right\}
\displaystyle\leq 2\sum_{t=1}^{T}\epsilon_{t}({\bm{x}}_{t}).
\displaystyle\leq 2\sum_{t=1}^{T}\epsilon_{t}({\bm{x}}_{t}).
\bm{\mu}({\bm{x}},\bm{\Theta}_{1})-\bm{\mu}({\bm{x}},\bm{\Theta}_{1})=\left[{%
\bm{B}}({\bm{x}},\bm{\Theta}_{1},\bm{\Theta}_{2})\otimes{\bm{x}}^{\intercal}%
\right](\bm{\theta}_{1}-\bm{\theta}_{2}).
\sqrt{\kappa T}
\bm{\Theta}\in{\mathcal{C}}_{t}(\delta)
{\bm{x}}\in{\mathcal{X}}_{t}
1-\delta
\Delta({\bm{x}},\bm{\Theta})\leq\epsilon_{t}({\bm{x}}):=\sqrt{2\kappa(T)}RL_{T%
}\gamma_{t}(\delta)\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}.
\displaystyle\Delta({\bm{x}},\bm{\Theta})\leq R\left\lVert\left[{\bm{B}}({\bm{%
x}},\bm{\Theta}_{\star},\bm{\Theta})\otimes{\bm{x}}^{\intercal}\right](\bm{%
\theta}_{\star}-\bm{\theta})\right\rVert_{2}
\displaystyle\Delta({\bm{x}},\bm{\Theta})
\displaystyle\leq R\left\lVert\left[{\bm{B}}({\bm{x}},\bm{\Theta}_{\star},\bm{%
\Theta})\otimes{\bm{x}}^{\intercal}\right](\bm{\theta}_{\star}-\bm{\theta})%
\right\rVert_{2}
\displaystyle\leq R\left\lVert\left[{\bm{B}}({\bm{x}},\bm{\Theta}_{\star},\bm{%
\Theta})\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}%
_{\star},\bm{\Theta})^{-1/2}\right\rVert_{2}\left\lVert\bm{\theta}_{\star}-\bm%
{\theta}\right\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{\star},\bm{\Theta})}
\displaystyle\leq R\left\lVert\left[{\bm{B}}({\bm{x}},\bm{\Theta}_{\star},\bm{%
\Theta})\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}%
_{\star},\bm{\Theta})^{-1/2}\right\rVert_{2}\left\lVert\bm{\theta}_{\star}-\bm%
{\theta}\right\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{\star},\bm{\Theta})}
\displaystyle\overset{(*)}{\leq}RL_{T}\sqrt{\lambda_{\max}\left(\left[{\bm{I}}%
_{K}\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{%
\star},\bm{\Theta})^{-1}\left[{\bm{I}}_{K}\otimes{\bm{x}}\right]\right)}\left%
\lVert\bm{\theta}_{\star}-\bm{\theta}\right\rVert_{\widetilde{{\bm{G}}}_{t}(%
\bm{\Theta}_{\star},\bm{\Theta})}
\displaystyle\overset{(*)}{\leq}RL_{T}\sqrt{\lambda_{\max}\left(\left[{\bm{I}}%
_{K}\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{%
\star},\bm{\Theta})^{-1}\left[{\bm{I}}_{K}\otimes{\bm{x}}\right]\right)}\left%
\lVert\bm{\theta}_{\star}-\bm{\theta}\right\rVert_{\widetilde{{\bm{G}}}_{t}(%
\bm{\Theta}_{\star},\bm{\Theta})}
\displaystyle\leq RL_{T}\sqrt{2\kappa\lambda_{\max}\left(\left[{\bm{I}}_{K}%
\otimes{\bm{x}}^{\intercal}\right]\left[{\bm{I}}_{K}\otimes{\bm{V}}_{t}^{-1}%
\right]\left[{\bm{I}}_{K}\otimes{\bm{x}}\right]\right)}\left\lVert\bm{\theta}_%
{\star}-\bm{\theta}\right\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{\star},%
\bm{\Theta})}
\displaystyle\leq RL_{T}\sqrt{2\kappa\lambda_{\max}\left(\left[{\bm{I}}_{K}%
\otimes{\bm{x}}^{\intercal}\right]\left[{\bm{I}}_{K}\otimes{\bm{V}}_{t}^{-1}%
\right]\left[{\bm{I}}_{K}\otimes{\bm{x}}\right]\right)}\left\lVert\bm{\theta}_%
{\star}-\bm{\theta}\right\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{\star},%
\bm{\Theta})}
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\bm{\theta}\in{\mathcal{C}}_{t}(\delta)
\displaystyle=\sqrt{2\kappa(T)}RL_{T}\gamma_{t}(\delta)\lVert{\bm{x}}\rVert_{{%
\bm{V}}_{t}^{-1}},
\displaystyle=\sqrt{2\kappa(T)}RL_{T}\gamma_{t}(\delta)\lVert{\bm{x}}\rVert_{{%
\bm{V}}_{t}^{-1}},
(*)
{\mathcal{H}}_{T}:=\left\{t\in[T]:\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}%
^{2}>1\right\}
\displaystyle\mathrm{Reg}^{B}(T)\lesssim\sum_{t=1}^{T}\epsilon_{t}({\bm{x}}_{t})
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim\sum_{t=1}^{T}\epsilon_{t}({\bm{x}}_{t})
\displaystyle\leq\sqrt{\kappa(T)}RL_{T}\gamma_{T}(\delta)\left(\frac{|{%
\mathcal{H}}_{T}|}{\lambda\kappa(T)}+\sum_{t\not\in{\mathcal{H}}_{T}}\lVert{%
\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}\right)
\displaystyle\leq\sqrt{\kappa(T)}RL_{T}\gamma_{T}(\delta)\left(\frac{|{%
\mathcal{H}}_{T}|}{\lambda\kappa(T)}+\sum_{t\not\in{\mathcal{H}}_{T}}\lVert{%
\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}\right)
\displaystyle\lesssim\sqrt{\kappa(T)}RL_{T}\gamma_{T}(\delta)\left(\frac{S^{2}%
}{\kappa(T)K}\log\frac{S^{2}}{\kappa(T)K}+\sqrt{(T-|{\mathcal{H}}_{T}|)\sum_{t%
\not\in{\mathcal{H}}_{T}}\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}^{2}}\right)
\displaystyle\lesssim\sqrt{\kappa(T)}RL_{T}\gamma_{T}(\delta)\left(\frac{S^{2}%
}{\kappa(T)K}\log\frac{S^{2}}{\kappa(T)K}+\sqrt{(T-|{\mathcal{H}}_{T}|)\sum_{t%
\not\in{\mathcal{H}}_{T}}\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}^{2}}\right)
\displaystyle\overset{(*)}{\lesssim}\sqrt{\kappa(T)}RL_{T}\gamma_{T}(\delta)%
\sqrt{T\sum_{t\in[T]}\min\left\{1,\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}%
^{2}\right\}}
\displaystyle\overset{(*)}{\lesssim}\sqrt{\kappa(T)}RL_{T}\gamma_{T}(\delta)%
\sqrt{T\sum_{t\in[T]}\min\left\{1,\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}^{-1}}%
^{2}\right\}}
\displaystyle\lesssim RL_{T}\gamma_{T}(\delta)\sqrt{d\kappa(T)T\log\left(1+%
\frac{ST}{dK\kappa(T)}\right)},
\displaystyle\lesssim RL_{T}\gamma_{T}(\delta)\sqrt{d\kappa(T)T\log\left(1+%
\frac{ST}{dK\kappa(T)}\right)},
(*)
\kappa(T)
S
T
\gamma_{T}(\delta)
\displaystyle\mathrm{Reg}^{B}(T)\lesssim L_{T}R\sqrt{dKS\log\left(e+\frac{ST}{%
dK}\right)+\sqrt{K}S\log\frac{1}{\delta}}\sqrt{d\kappa(T)T\log\left(1+\frac{ST%
}{dK\kappa(T)}\right)}
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim L_{T}R\sqrt{dKS\log\left(e+\frac{ST}{dK}\right)+\sqrt{K}%
S\log\frac{1}{\delta}}\sqrt{d\kappa(T)T\log\left(1+\frac{ST}{dK\kappa(T)}%
\right)}
\displaystyle\lesssim L_{T}R\sqrt{d\sqrt{K}S}\left(\sqrt{d\sqrt{K}\log\left(e+%
\frac{ST}{dK}\right)}+\sqrt{\log\frac{1}{\delta}}\right)\sqrt{\kappa(T)T\log%
\left(1+\frac{ST}{dK\kappa(T)}\right)}.
\displaystyle\lesssim L_{T}R\sqrt{d\sqrt{K}S}\left(\sqrt{d\sqrt{K}\log\left(e+%
\frac{ST}{dK}\right)}+\sqrt{\log\frac{1}{\delta}}\right)\sqrt{\kappa(T)T\log%
\left(1+\frac{ST}{dK\kappa(T)}\right)}.
\sqrt{T}+\kappa
t\in[T]
{\bm{x}}\in{\mathcal{X}}_{t}
\left\{\bm{\Theta}_{t,h}\right\}_{h\in[N_{t}]}\subset{\mathcal{C}}_{t}(\delta)%
\cap{\mathcal{B}}^{K\times d}(S)
N_{t}
{\mathcal{C}}_{t}(\delta)\cap{\mathcal{B}}^{K\times d}(S)
{\mathcal{M}}_{t}(\delta):=\left\{\bm{\Theta}\in{\mathbb{R}}^{K\times d}:%
\forall s\in[t-1]\ \exists i(s)\in[N_{s}]\ \text{s.t.}\ {\bm{A}}({\bm{x}}_{s},%
\bm{\Theta})\succeq{\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{s,i(s)})\right\},
{\mathcal{W}}_{t}(\delta):={\mathcal{C}}_{t}(\delta)\cap{\mathcal{M}}_{t}(\delta)
\bm{\Theta}_{1},\bm{\Theta}_{2}\in{\mathcal{W}}_{t}(\delta)
t\in[T]
1-\delta
\bm{\mu}({\bm{x}},\bm{\Theta}_{1})-\bm{\mu}({\bm{x}},\bm{\Theta}_{2})\leq\left%
[{\bm{A}}({\bm{x}},\bm{\Theta}_{2})\otimes{\bm{x}}^{\intercal}\right](\bm{%
\theta}_{1}-\bm{\theta}_{2})+2\kappa(T)M_{T}\gamma_{t}(\delta)^{2}\lVert{\bm{x%
}}\rVert^{2}_{{\bm{V}}_{t}^{-1}}\bm{1},
\leq
\displaystyle M_{T}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}%
\right](\bm{\theta}_{1}-\bm{\theta}_{2})\right\rVert_{2}^{2}\leq M_{T}\left%
\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}%
_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2})^{-1/2}\right\lVert_{2}^{2}\left\lVert\bm%
{\theta}_{1}-\bm{\theta}_{2}\right\rVert_{\widetilde{{\bm{G}}}(\bm{\Theta}_{1}%
,\bm{\Theta}_{2})}^{2}
\displaystyle M_{T}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}%
\right](\bm{\theta}_{1}-\bm{\theta}_{2})\right\rVert_{2}^{2}
\displaystyle\leq M_{T}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal%
}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2})^{-1/2}\right%
\lVert_{2}^{2}\left\lVert\bm{\theta}_{1}-\bm{\theta}_{2}\right\rVert_{%
\widetilde{{\bm{G}}}(\bm{\Theta}_{1},\bm{\Theta}_{2})}^{2}
\displaystyle\leq M_{T}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal%
}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2})^{-1/2}\right%
\lVert_{2}^{2}\gamma_{t}(\delta)^{2}
\displaystyle\leq M_{T}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal%
}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{1},\bm{\Theta}_{2})^{-1/2}\right%
\lVert_{2}^{2}\gamma_{t}(\delta)^{2}
\displaystyle\overset{(*)}{\leq}2\kappa(T)M_{T}\gamma_{t}(\delta)^{2}\lVert{%
\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
\displaystyle\overset{(*)}{\leq}2\kappa(T)M_{T}\gamma_{t}(\delta)^{2}\lVert{%
\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
\widetilde{{\bm{G}}}_{t}
{\bm{G}}_{t}
(*)
\Delta({\bm{x}},\bm{\Theta}_{t})\leq\overline{\epsilon}_{t}({\bm{x}},\bm{%
\Theta}_{t}):=R\sqrt{2+2\sqrt{6}S}\gamma_{t}(\delta)\left\lVert\left[{\bm{A}}(%
{\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{%
\Theta}_{t})^{-1/2}\right\rVert_{2}+2\kappa(T)M_{T}\left(\sum_{k=1}^{K}\rho_{k%
}\right)\gamma_{t}(\delta)^{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}.
\displaystyle\Delta({\bm{x}},\bm{\Theta}_{t})\leq R\left\lVert\left[{\bm{A}}({%
\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}}^{\intercal}\right](\bm{\theta}_{\star}%
-\bm{\theta}_{t})\right\rVert_{2}+2\kappa(T)M_{T}\left(\sum_{k=1}^{K}\rho_{k}%
\right)\gamma_{t}(\delta)^{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
\displaystyle\Delta({\bm{x}},\bm{\Theta}_{t})
\displaystyle\leq R\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t})\otimes{%
\bm{x}}^{\intercal}\right](\bm{\theta}_{\star}-\bm{\theta}_{t})\right\rVert_{2%
}+2\kappa(T)M_{T}\left(\sum_{k=1}^{K}\rho_{k}\right)\gamma_{t}(\delta)^{2}%
\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
\displaystyle\leq R\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t})\otimes{%
\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{\star},\bm{%
\Theta}_{t})^{-1/2}\right\lVert_{2}\left\lVert\bm{\theta}_{\star}-\bm{\theta}_%
{t}\right\rVert_{\widetilde{{\bm{G}}}(\bm{\Theta}_{\star},\bm{\Theta}_{t})}+2%
\kappa(T)M_{T}\left(\sum_{k=1}^{K}\rho_{k}\right)\gamma_{t}(\delta)^{2}\lVert{%
\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
\displaystyle\leq R\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t})\otimes{%
\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}_{\star},\bm{%
\Theta}_{t})^{-1/2}\right\lVert_{2}\left\lVert\bm{\theta}_{\star}-\bm{\theta}_%
{t}\right\rVert_{\widetilde{{\bm{G}}}(\bm{\Theta}_{\star},\bm{\Theta}_{t})}+2%
\kappa(T)M_{T}\left(\sum_{k=1}^{K}\rho_{k}\right)\gamma_{t}(\delta)^{2}\lVert{%
\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2}
\displaystyle\leq R\gamma_{t}(\delta)\left\lVert\left[{\bm{A}}({\bm{x}},\bm{%
\Theta})\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}%
_{\star},\bm{\Theta}_{t})^{-1/2}\right\lVert_{2}+2\kappa(T)M_{T}\left(\sum_{k=%
1}^{K}\rho_{k}\right)\gamma_{t}(\delta)^{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^%
{-1}}^{2}
\displaystyle\leq R\gamma_{t}(\delta)\left\lVert\left[{\bm{A}}({\bm{x}},\bm{%
\Theta})\otimes{\bm{x}}^{\intercal}\right]\widetilde{{\bm{G}}}_{t}(\bm{\Theta}%
_{\star},\bm{\Theta}_{t})^{-1/2}\right\lVert_{2}+2\kappa(T)M_{T}\left(\sum_{k=%
1}^{K}\rho_{k}\right)\gamma_{t}(\delta)^{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^%
{-1}}^{2}
\displaystyle\leq R\sqrt{2+2\sqrt{6}S}\gamma_{t}(\delta)\left\lVert\left[{\bm{%
A}}({\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(%
\bm{\Theta}_{t})^{-1/2}\right\lVert_{2}+2\kappa(T)M_{T}\left(\sum_{k=1}^{K}%
\rho_{k}\right)\gamma_{t}(\delta)^{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^%
{2},
\displaystyle\leq R\sqrt{2+2\sqrt{6}S}\gamma_{t}(\delta)\left\lVert\left[{\bm{%
A}}({\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(%
\bm{\Theta}_{t})^{-1/2}\right\lVert_{2}+2\kappa(T)M_{T}\left(\sum_{k=1}^{K}%
\rho_{k}\right)\gamma_{t}(\delta)^{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^%
{2},
\displaystyle\leq R\sqrt{2+2\sqrt{6}S}\gamma_{t}(\delta)\left\lVert\left[{\bm{%
A}}({\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(%
\bm{\Theta}_{t})^{-1/2}\right\lVert_{2}+2\kappa(T)M_{T}\gamma_{t}(\delta)^{2}%
\sqrt{RK}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2},
\displaystyle\leq R\sqrt{2+2\sqrt{6}S}\gamma_{t}(\delta)\left\lVert\left[{\bm{%
A}}({\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(%
\bm{\Theta}_{t})^{-1/2}\right\lVert_{2}+2\kappa(T)M_{T}\gamma_{t}(\delta)^{2}%
\sqrt{RK}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}^{2},
\widetilde{{\bm{G}}}_{t}
{\bm{G}}_{t}
\widetilde{{\bm{G}}}_{t}
{\bm{G}}_{t}
{\bm{A}}({\bm{x}},\bm{\Theta}_{t})={\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})+{\bm{U%
}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})
{\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})\in{\mathbb{R}}^{K\times K}
{\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})_{ij}:={\bm{x}}^{\intercal%
}(\bm{\Theta}_{t}-\bm{\Theta}_{t,h})\int_{0}^{1}\nabla\left[{\bm{A}}\left({\bm%
{x}},v\bm{\Theta}_{t}+(1-v)\bm{\Theta}_{t,h}\right)_{ij}\right]dv,\quad\forall
i%
,j\in[K]
\lambda_{\max}\left({\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})\right%
)\leq M_{T}^{\prime}K\sqrt{2\kappa(T)}\gamma_{t}(\delta)\lVert{\bm{x}}\rVert_{%
{\bm{V}}_{t}^{-1}}.
\displaystyle\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}%
}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}
\displaystyle\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t})\otimes{\bm{x}%
}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+\left\lVert\left[{\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+\left\lVert\left[{\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+\left\lVert{\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})\right\rVert_{%
2}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(%
\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+\left\lVert{\bm{U}}({\bm{x}},\bm{\Theta}_{t},\bm{\Theta}_{t,h})\right\rVert_{%
2}\left\lVert\left[{\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(%
\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+\sqrt{2\kappa(T)}M_{T}^{\prime}K\gamma_{t}(\delta)\left\lVert\left[{\bm{I}}_{%
K}\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right%
\rVert_{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+\sqrt{2\kappa(T)}M_{T}^{\prime}K\gamma_{t}(\delta)\left\lVert\left[{\bm{I}}_{%
K}\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right%
\rVert_{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}
\displaystyle\overset{(*)}{\leq}\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}%
_{t,h})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}%
\right\rVert_{2}+2M_{T}^{\prime}K\kappa(T)\gamma_{t}(\delta)\left\lVert\left[{%
\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}\right]({\bm{I}}_{K}\otimes{\bm{V}}_{t})%
^{-1/2}\right\rVert_{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}
\displaystyle\overset{(*)}{\leq}\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}%
_{t,h})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}%
\right\rVert_{2}+2M_{T}^{\prime}K\kappa(T)\gamma_{t}(\delta)\left\lVert\left[{%
\bm{I}}_{K}\otimes{\bm{x}}^{\intercal}\right]({\bm{I}}_{K}\otimes{\bm{V}}_{t})%
^{-1/2}\right\rVert_{2}\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}^{-1}}
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+2M_{T}^{\prime}K\kappa(T)\gamma_{t}(\delta)\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}%
^{-1}}^{2},
\displaystyle\leq\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,h})\otimes{%
\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}\right\rVert_{2}%
+2M_{T}^{\prime}K\kappa(T)\gamma_{t}(\delta)\lVert{\bm{x}}\rVert_{{\bm{V}}_{t}%
^{-1}}^{2},
(*)
{\bm{I}}_{K}\otimes{\bm{V}}_{t}\preceq 2\kappa(T){\bm{G}}_{t}(\bm{\Theta}_{1},%
\bm{\Theta}_{2})
t\in[T]
s\in[t-1]
i(s)\in[N_{s}]
{\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{t})\succeq{\bm{A}}({\bm{x}}_{s},\bm{\Theta}%
_{s,i(s)})
{\bm{H}}_{t}(\bm{\Theta}_{t})\succeq{\bm{L}}_{t}:=\lambda{\bm{I}}_{Kd}+\sum_{s%
=1}^{t-1}\sum_{k=1}^{K}\tilde{{\bm{x}}}_{s,k}\tilde{{\bm{x}}}_{s,k}^{\intercal},
\tilde{{\bm{x}}}_{s,k}:={\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{s,i(s)})_{k}\otimes%
{\bm{x}}_{s}\in{\mathbb{R}}^{Kd\times 1}
\lVert\tilde{{\bm{x}}}_{s,k}\rVert_{2}=\left\lVert{\bm{A}}({\bm{x}}_{s},\bm{%
\Theta}_{s,i(s)})_{k}\right\rVert_{2}\lVert{\bm{x}}_{s}\rVert_{2}\leq\lVert{%
\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{s,i(s)})\rVert_{2}\leq 1
\displaystyle\sum_{t=1}^{T}\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,i%
(t)})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}%
\right\rVert_{2}=\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert{\bm{A}}({\bm{x}%
}_{t},\bm{\Theta}_{t,i(t)})_{k}\otimes{\bm{x}}_{t}\right\rVert_{{\bm{H}}_{t}^{%
-1}(\bm{\theta}_{\star})}^{2}}
\displaystyle\sum_{t=1}^{T}\left\lVert\left[{\bm{A}}({\bm{x}},\bm{\Theta}_{t,i%
(t)})\otimes{\bm{x}}^{\intercal}\right]{\bm{H}}_{t}(\bm{\Theta}_{t})^{-1/2}%
\right\rVert_{2}
\displaystyle=\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert{\bm{A}}({\bm{x}}_{%
t},\bm{\Theta}_{t,i(t)})_{k}\otimes{\bm{x}}_{t}\right\rVert_{{\bm{H}}_{t}^{-1}%
(\bm{\theta}_{\star})}^{2}}
\displaystyle=\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t%
,k}\right\rVert_{{\bm{H}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}
\displaystyle=\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t%
,k}\right\rVert_{{\bm{H}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}
\displaystyle\leq\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}%
_{t,k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}.
\displaystyle\leq\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}%
_{t,k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}.
\left\{{\bm{x}}_{t,k}\right\}_{t\in[T],k\in[K]}\subset{\mathcal{B}}^{d}(1)
{\bm{V}}_{t}:=\lambda{\bm{I}}+\sum_{s=1}^{t-1}\sum_{k=1}^{K}{\bm{x}}_{s,k}{\bm%
{x}}_{s,k}^{\intercal}
{\mathcal{H}}_{T}:=\left\{t\in[T]:\sum_{k=1}^{K}\lVert{\bm{x}}_{t,k}\rVert_{{%
\bm{V}}_{t}^{-1}}^{2}>1\right\}
|{\mathcal{H}}_{T}|\leq\frac{2d}{\log(2)}\log\left(1+\frac{K}{\lambda\log(2)}%
\right).
\left\{{\bm{x}}_{t,k}\right\}_{t\in[T],k\in[K]}\subset{\mathcal{B}}^{d}(1)
{\bm{V}}_{t}:=\lambda{\bm{I}}+\sum_{s=1}^{t-1}\sum_{k=1}^{K}{\bm{x}}_{s,k}{\bm%
{x}}_{s,k}^{\intercal}
\sum_{t=1}^{T}\min\left\{1,\sum_{k=1}^{K}\left\lVert{\bm{x}}_{t,k}\right\rVert%
_{{\bm{V}}_{t}^{-1}}^{2}\right\}\leq 2d\log\left(1+\frac{KT}{d\lambda}\right)
\displaystyle\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t,%
k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}=\sum_{t\in{%
\mathcal{H}}_{T}}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t,k}\right%
\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}+\sum_{t\not\in{\mathcal{H%
}}_{T}}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t,k}\right\rVert_{{\bm%
{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}
\displaystyle\sum_{t=1}^{T}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t,%
k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}
\displaystyle=\sum_{t\in{\mathcal{H}}_{T}}\sqrt{\sum_{k=1}^{K}\left\lVert%
\tilde{{\bm{x}}}_{t,k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2%
}}+\sum_{t\not\in{\mathcal{H}}_{T}}\sqrt{\sum_{k=1}^{K}\left\lVert\tilde{{\bm{%
x}}}_{t,k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}}
\lambda=\frac{K}{S^{2}}
\lambda=\frac{K}{S^{2}}
\lambda=\frac{K}{S^{2}}
\displaystyle\lesssim dS\log(1+S^{2})+\sqrt{T\sum_{t=1}^{T}\min\left\{1,\sum_{%
k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t,k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{%
\theta}_{\star})}^{2}\right\}}
\displaystyle\lesssim dS\log(1+S^{2})+\sqrt{T\sum_{t=1}^{T}\min\left\{1,\sum_{%
k=1}^{K}\left\lVert\tilde{{\bm{x}}}_{t,k}\right\rVert_{{\bm{L}}_{t}^{-1}(\bm{%
\theta}_{\star})}^{2}\right\}}
\displaystyle\lesssim dS\log(1+S^{2})+\sqrt{dT\log\left(1+\frac{S^{2}T}{d}%
\right)}
\displaystyle\lesssim dS\log(1+S^{2})+\sqrt{dT\log\left(1+\frac{S^{2}T}{d}%
\right)}
S
\sqrt{T}
\displaystyle\mathrm{Reg}^{B}(T)\lesssim\sum_{t=1}^{T}\overline{\epsilon}_{t}(%
{\bm{x}}_{t},\bm{\Theta}_{t})
\displaystyle\mathrm{Reg}^{B}(T)
\displaystyle\lesssim\sum_{t=1}^{T}\overline{\epsilon}_{t}({\bm{x}}_{t},\bm{%
\Theta}_{t})
\displaystyle\lesssim\sqrt{RK}\kappa(T)\gamma_{T}(\delta)^{2}\left(M_{T}+M_{T}%
^{\prime}\sqrt{RKS}\right)\sum_{t=1}^{T}\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}%
^{-1}}^{2}+R\sqrt{S}\gamma_{T}(\delta)\sqrt{dT\log\left(1+\frac{S^{2}T}{d}%
\right)}
\displaystyle\lesssim\sqrt{RK}\kappa(T)\gamma_{T}(\delta)^{2}\left(M_{T}+M_{T}%
^{\prime}\sqrt{RKS}\right)\sum_{t=1}^{T}\lVert{\bm{x}}_{t}\rVert_{{\bm{V}}_{t}%
^{-1}}^{2}+R\sqrt{S}\gamma_{T}(\delta)\sqrt{dT\log\left(1+\frac{S^{2}T}{d}%
\right)}
\displaystyle\lesssim\sqrt{RK}\kappa(T)\gamma_{T}(\delta)^{2}\left(M_{T}+M_{T}%
^{\prime}\sqrt{RKS}\right)\left(\frac{dS^{2}}{K\kappa(T)}\log\left(1+\frac{S}{%
K\kappa(T)}\right)+d\log\left(1+\frac{ST}{dK\kappa(T)}\right)\right)
\displaystyle\lesssim\sqrt{RK}\kappa(T)\gamma_{T}(\delta)^{2}\left(M_{T}+M_{T}%
^{\prime}\sqrt{RKS}\right)\left(\frac{dS^{2}}{K\kappa(T)}\log\left(1+\frac{S}{%
K\kappa(T)}\right)+d\log\left(1+\frac{ST}{dK\kappa(T)}\right)\right)
\displaystyle\quad+R\sqrt{S}\gamma_{T}(\delta)\sqrt{dT\log\left(1+\frac{S^{2}T%
}{d}\right)}
\displaystyle\quad+R\sqrt{S}\gamma_{T}(\delta)\sqrt{dT\log\left(1+\frac{S^{2}T%
}{d}\right)}
\displaystyle\overset{(*)}{\lesssim}R\sqrt{d}K^{\frac{1}{4}}S\sqrt{\left(d%
\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)\log\left(%
1+\frac{S^{2}T}{d}\right)T}
\displaystyle\overset{(*)}{\lesssim}R\sqrt{d}K^{\frac{1}{4}}S\sqrt{\left(d%
\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)\log\left(%
1+\frac{S^{2}T}{d}\right)T}
\displaystyle\quad+RdK^{\frac{3}{2}}S^{\frac{3}{2}}\max\{M_{T},M_{T}^{\prime}%
\}\left(d\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)%
\log\left(1+\frac{ST}{dK\kappa(T)}\right)\kappa(T),
\displaystyle\quad+RdK^{\frac{3}{2}}S^{\frac{3}{2}}\max\{M_{T},M_{T}^{\prime}%
\}\left(d\sqrt{K}\log\left(e+\frac{ST}{dK}\right)+\log\frac{1}{\delta}\right)%
\log\left(1+\frac{ST}{dK\kappa(T)}\right)\kappa(T),
(*)
\kappa(T)=\Theta(e^{S})
\ell(\bm{\mu})=-y_{0}\log\left(1-\sum_{k=1}^{K}\mu_{k}\right)-\sum_{k=1}^{K}y_%
{k}\log\mu_{k}
\bm{\mu}=(\mu_{1},\cdots,\mu_{K})
\mu_{0}(\bm{\mu})=\mu_{0}=1-\sum_{k=1}^{K}\mu_{k}
\mu_{0}^{\star}=\mu_{0}(\bm{\mu}^{\star})
k\neq k^{\prime}\in[K]
\partial_{k}\ell(\bm{\mu})=\frac{y_{0}}{\mu_{0}}-\frac{y_{k}}{\mu_{k}},\quad%
\partial_{kk}\ell(\bm{\mu})=\frac{y_{0}}{\mu_{0}^{2}}+\frac{y_{k}}{\mu_{k}^{2}%
},\quad\partial_{kk^{\prime}}\ell(\bm{\mu})=\frac{y_{0}}{\mu_{0}^{2}}.
\alpha
\displaystyle\ell(\bm{\mu})-\ell(\bm{\mu}^{\star})=\nabla\ell(\bm{\mu}^{\star}%
)^{\intercal}(\bm{\mu}-\bm{\mu}^{\star})+2\sum_{|\alpha|=2}\frac{(\bm{\mu}-\bm%
{\mu}^{\star})^{\alpha}}{\alpha!}\int_{0}^{1}(1-t)\partial^{\alpha}\ell(\bm{%
\mu}^{\star}+t(\bm{\mu}-\bm{\mu}^{\star}))dt
\displaystyle\ell(\bm{\mu})-\ell(\bm{\mu}^{\star})
\displaystyle=\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{%
\star})+2\sum_{|\alpha|=2}\frac{(\bm{\mu}-\bm{\mu}^{\star})^{\alpha}}{\alpha!}%
\int_{0}^{1}(1-t)\partial^{\alpha}\ell(\bm{\mu}^{\star}+t(\bm{\mu}-\bm{\mu}^{%
\star}))dt
\displaystyle=\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{%
\star})+\sum_{k=1}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{0}^{1}(1-t)\left\{%
\frac{y_{0}}{(\mu^{\star}_{0}+t(\mu_{0}-\mu^{\star}_{0}))^{2}}+\frac{y_{k}}{(%
\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{2}}\right\}dt
\displaystyle=\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{%
\star})+\sum_{k=1}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{0}^{1}(1-t)\left\{%
\frac{y_{0}}{(\mu^{\star}_{0}+t(\mu_{0}-\mu^{\star}_{0}))^{2}}+\frac{y_{k}}{(%
\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{2}}\right\}dt
\displaystyle\quad+2\sum_{1\leq k<k^{\prime}\leq K}(\mu_{k}-\mu^{\star}_{k})(%
\mu_{k^{\prime}}-\mu^{\star}_{k^{\prime}})\int_{0}^{1}(1-t)\frac{y_{0}}{(\mu^{%
\star}_{0}+t(\mu_{0}-\mu^{\star}_{0}))^{2}}dt
\displaystyle\quad+2\sum_{1\leq k<k^{\prime}\leq K}(\mu_{k}-\mu^{\star}_{k})(%
\mu_{k^{\prime}}-\mu^{\star}_{k^{\prime}})\int_{0}^{1}(1-t)\frac{y_{0}}{(\mu^{%
\star}_{0}+t(\mu_{0}-\mu^{\star}_{0}))^{2}}dt
\displaystyle=\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{%
\star})+\sum_{k=1}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{0}^{1}(1-t)\frac{y_{k%
}}{(\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{2}}dt
\displaystyle=\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{%
\star})+\sum_{k=1}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{0}^{1}(1-t)\frac{y_{k%
}}{(\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{2}}dt
\displaystyle\quad+\left(\sum_{k=1}^{K}(\mu_{k}-\mu^{\star}_{k})\right)^{2}%
\int_{0}^{1}(1-t)\frac{y_{0}}{(\mu^{\star}_{0}+t(\mu_{0}-\mu^{\star}_{0}))^{2}%
}dt
\displaystyle\quad+\left(\sum_{k=1}^{K}(\mu_{k}-\mu^{\star}_{k})\right)^{2}%
\int_{0}^{1}(1-t)\frac{y_{0}}{(\mu^{\star}_{0}+t(\mu_{0}-\mu^{\star}_{0}))^{2}%
}dt
\displaystyle=\underbrace{\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-%
\bm{\mu}^{\star})}_{(a)}+\underbrace{\sum_{k=0}^{K}(\mu_{k}-\mu^{\star}_{k})^{%
2}\int_{0}^{1}(1-t)\frac{y_{k}}{(\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{%
2}}dt}_{(b)}.
\displaystyle=\underbrace{\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-%
\bm{\mu}^{\star})}_{(a)}+\underbrace{\sum_{k=0}^{K}(\mu_{k}-\mu^{\star}_{k})^{%
2}\int_{0}^{1}(1-t)\frac{y_{k}}{(\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{%
2}}dt}_{(b)}.
\displaystyle\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{\star%
})=\sum_{k=1}^{K}\left(\frac{y_{0}}{\mu_{0}^{\star}}-\frac{y_{k}}{\mu_{k}^{%
\star}}\right)(\mu_{k}-\mu^{\star}_{k})
\displaystyle\nabla\ell(\bm{\mu}^{\star})^{\intercal}(\bm{\mu}-\bm{\mu}^{\star})
\displaystyle=\sum_{k=1}^{K}\left(\frac{y_{0}}{\mu_{0}^{\star}}-\frac{y_{k}}{%
\mu_{k}^{\star}}\right)(\mu_{k}-\mu^{\star}_{k})
\displaystyle=\sum_{k=1}^{K}\left(\frac{y_{0}}{\mu_{0}^{\star}}(\mu_{k}-\mu_{k%
}^{\star})-\frac{y_{k}}{\mu_{k}^{\star}}\mu_{k}+y_{k}\right).
\displaystyle=\sum_{k=1}^{K}\left(\frac{y_{0}}{\mu_{0}^{\star}}(\mu_{k}-\mu_{k%
}^{\star})-\frac{y_{k}}{\mu_{k}^{\star}}\mu_{k}+y_{k}\right).
\displaystyle\sum_{k=0}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{0}^{1}(1-t)\frac%
{y_{k}}{(\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{2}}dt=\sum_{k=0}^{K}(\mu%
_{k}-\mu^{\star}_{k})^{2}\int_{\mu_{k}^{\star}}^{\mu_{k}}\left(1-\frac{v-\mu^{%
\star}_{k}}{\mu_{k}-\mu^{\star}_{k}}\right)\frac{y_{k}}{v^{2}}\frac{1}{\mu_{k}%
-\mu^{\star}_{k}}dv
\displaystyle\sum_{k=0}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{0}^{1}(1-t)\frac%
{y_{k}}{(\mu^{\star}_{k}+t(\mu_{k}-\mu^{\star}_{k}))^{2}}dt
\displaystyle=\sum_{k=0}^{K}(\mu_{k}-\mu^{\star}_{k})^{2}\int_{\mu_{k}^{\star}%
}^{\mu_{k}}\left(1-\frac{v-\mu^{\star}_{k}}{\mu_{k}-\mu^{\star}_{k}}\right)%
\frac{y_{k}}{v^{2}}\frac{1}{\mu_{k}-\mu^{\star}_{k}}dv
\displaystyle=\sum_{k=0}^{K}y_{k}\int_{\mu_{k}^{\star}}^{\mu_{k}}\frac{\mu_{k}%
-v}{v^{2}}dv
\displaystyle=\sum_{k=0}^{K}y_{k}\int_{\mu_{k}^{\star}}^{\mu_{k}}\frac{\mu_{k}%
-v}{v^{2}}dv
\displaystyle=\sum_{k=0}^{K}y_{k}\left\{\frac{\mu_{k}}{\mu_{k}^{\star}}-1-\log%
\frac{\mu_{k}}{\mu_{k}^{\star}}\right\}.
\displaystyle=\sum_{k=0}^{K}y_{k}\left\{\frac{\mu_{k}}{\mu_{k}^{\star}}-1-\log%
\frac{\mu_{k}}{\mu_{k}^{\star}}\right\}.
\sum_{k=0}^{K}y_{k}=\sum_{k=0}^{K}\mu_{k}=\sum_{k=0}^{K}\mu_{k}^{\star}=1
y_{k}=\mu_{k}^{\star}+\xi_{k}
k\in[K]
\xi_{0}=-\sum_{k=1}^{K}\xi_{k}
y_{0}=\mu_{0}^{\star}+\xi_{0}
\displaystyle\ell(\bm{\mu})-\ell(\bm{\mu}^{\star})=y_{0}\left\{\frac{\mu_{0}}{%
\mu_{0}^{\star}}-1-\log\frac{\mu_{0}}{\mu_{0}^{\star}}\right\}+\sum_{k=1}^{K}%
\left\{\frac{y_{0}}{\mu_{0}^{\star}}(\mu_{k}-\mu_{k}^{\star})-y_{k}\log\frac{%
\mu_{k}}{\mu_{k}^{\star}}\right\}
\displaystyle\ell(\bm{\mu})-\ell(\bm{\mu}^{\star})
\displaystyle=y_{0}\left\{\frac{\mu_{0}}{\mu_{0}^{\star}}-1-\log\frac{\mu_{0}}%
{\mu_{0}^{\star}}\right\}+\sum_{k=1}^{K}\left\{\frac{y_{0}}{\mu_{0}^{\star}}(%
\mu_{k}-\mu_{k}^{\star})-y_{k}\log\frac{\mu_{k}}{\mu_{k}^{\star}}\right\}
\displaystyle=\frac{y_{0}}{\mu_{0}^{\star}}\sum_{k=0}^{K}\mu_{k}-y_{0}+y_{0}%
\log\frac{\mu_{0}^{\star}}{\mu_{0}}+\sum_{k=1}^{K}\left\{-\frac{y_{0}}{\mu_{0}%
^{\star}}\mu_{k}^{\star}+y_{k}\log\frac{\mu_{k}^{\star}}{\mu_{k}}\right\}
\displaystyle=\frac{y_{0}}{\mu_{0}^{\star}}\sum_{k=0}^{K}\mu_{k}-y_{0}+y_{0}%
\log\frac{\mu_{0}^{\star}}{\mu_{0}}+\sum_{k=1}^{K}\left\{-\frac{y_{0}}{\mu_{0}%
^{\star}}\mu_{k}^{\star}+y_{k}\log\frac{\mu_{k}^{\star}}{\mu_{k}}\right\}
\displaystyle=\frac{y_{0}}{\mu_{0}^{\star}}-\frac{y_{0}}{\mu_{0}^{\star}}\sum_%
{k=1}^{K}\mu_{k}^{\star}-y_{0}+\sum_{k=0}^{K}y_{k}\log\frac{\mu_{k}^{\star}}{%
\mu_{k}}
\displaystyle=\frac{y_{0}}{\mu_{0}^{\star}}-\frac{y_{0}}{\mu_{0}^{\star}}\sum_%
{k=1}^{K}\mu_{k}^{\star}-y_{0}+\sum_{k=0}^{K}y_{k}\log\frac{\mu_{k}^{\star}}{%
\mu_{k}}
\displaystyle=\sum_{k=0}^{K}\mu_{k}^{\star}\log\frac{\mu_{k}^{\star}}{\mu_{k}}%
+\sum_{k=0}^{K}\xi_{k}\log\frac{\mu_{k}^{\star}}{\mu_{k}}
\displaystyle=\sum_{k=0}^{K}\mu_{k}^{\star}\log\frac{\mu_{k}^{\star}}{\mu_{k}}%
+\sum_{k=0}^{K}\xi_{k}\log\frac{\mu_{k}^{\star}}{\mu_{k}}
\displaystyle=\sum_{k=0}^{K}\mu_{k}^{\star}\log\frac{\mu_{k}^{\star}}{\mu_{k}}%
+\sum_{k=0}^{K}\xi_{k}\log\frac{\mu_{k}^{\star}}{\mu_{k}}
\displaystyle=\sum_{k=0}^{K}\mu_{k}^{\star}\log\frac{\mu_{k}^{\star}}{\mu_{k}}%
+\sum_{k=0}^{K}\xi_{k}\log\frac{\mu_{k}^{\star}}{\mu_{k}}
\displaystyle=\mathrm{KL}(\bm{\mu}^{\star},\bm{\mu})+\sum_{k=1}^{K}\xi_{k}%
\left(\log\frac{\mu_{k}^{\star}}{\mu_{0}^{\star}}-\log\frac{\mu_{k}}{\mu_{0}}\right)
\displaystyle=\mathrm{KL}(\bm{\mu}^{\star},\bm{\mu})+\sum_{k=1}^{K}\xi_{k}%
\left(\log\frac{\mu_{k}^{\star}}{\mu_{0}^{\star}}-\log\frac{\mu_{k}}{\mu_{0}}\right)
\displaystyle\overset{(*)}{=}\mathrm{KL}(\bm{\mu}^{\star},\bm{\mu})+\sum_{k=1}%
^{K}\xi_{k}\langle{\bm{x}}_{t},\bm{\theta}_{\star}^{(k)}-\bm{\theta}_{t}^{(k)}\rangle,
\displaystyle\overset{(*)}{=}\mathrm{KL}(\bm{\mu}^{\star},\bm{\mu})+\sum_{k=1}%
^{K}\xi_{k}\langle{\bm{x}}_{t},\bm{\theta}_{\star}^{(k)}-\bm{\theta}_{t}^{(k)}\rangle,
(*)
\bm{\mu}^{\star}
\bm{\mu}
\mu_{k}^{(i)}=\mu_{k}({\bm{z}}^{(i)})
C_{k}^{(i)}:=1+\sum_{j\neq k}e^{z_{j}^{(i)}}
\mu,C
z
\mu_{k}^{(i)}=\frac{e^{z_{k}^{(i)}}}{C_{k}^{(i)}+e^{z_{k}^{(i)}}},\quad z_{k}^%
{(i)}=\frac{\mu_{k}^{(i)}C_{k}^{(i)}}{1-\mu_{k}^{(i)}}.
\displaystyle D_{m}({\bm{z}}^{(1)},{\bm{z}}^{(2)})
\displaystyle D_{m}({\bm{z}}^{(1)},{\bm{z}}^{(2)})
\displaystyle=m({\bm{z}}^{(1)})-m({\bm{z}}^{(2)})-\nabla m({\bm{z}}^{(2)})^{%
\intercal}({\bm{z}}^{(1)}-{\bm{z}}^{(2)})
\displaystyle=m({\bm{z}}^{(1)})-m({\bm{z}}^{(2)})-\nabla m({\bm{z}}^{(2)})^{%
\intercal}({\bm{z}}^{(1)}-{\bm{z}}^{(2)})
\displaystyle=\log\left(1+\sum_{k=1}^{K}e^{z^{(1)}_{k}}\right)-\log\left(1+%
\sum_{k=1}^{K}e^{z^{(2)}_{k}}\right)-\sum_{k=1}^{K}\frac{e^{z^{(2)}_{k}}}{1+%
\sum_{k=1}^{K}e^{z^{(2)}_{k}}}(z^{(1)}_{k}-z^{(2)}_{k})
\displaystyle=\log\left(1+\sum_{k=1}^{K}e^{z^{(1)}_{k}}\right)-\log\left(1+%
\sum_{k=1}^{K}e^{z^{(2)}_{k}}\right)-\sum_{k=1}^{K}\frac{e^{z^{(2)}_{k}}}{1+%
\sum_{k=1}^{K}e^{z^{(2)}_{k}}}(z^{(1)}_{k}-z^{(2)}_{k})
\displaystyle=\log\frac{1-\sum_{k=1}^{K}\mu_{k}^{(2)}}{1-\sum_{k=1}^{K}\mu_{k}%
^{(1)}}-\sum_{k=1}^{K}\mu_{k}^{(2)}\log\frac{\mu_{k}^{(1)}(1-\mu_{k}^{(2)})C_{%
k}^{(1)}}{\mu_{k}^{(2)}(1-\mu_{k}^{(1)})C_{k}^{(2)}}
\displaystyle=\log\frac{1-\sum_{k=1}^{K}\mu_{k}^{(2)}}{1-\sum_{k=1}^{K}\mu_{k}%
^{(1)}}-\sum_{k=1}^{K}\mu_{k}^{(2)}\log\frac{\mu_{k}^{(1)}(1-\mu_{k}^{(2)})C_{%
k}^{(1)}}{\mu_{k}^{(2)}(1-\mu_{k}^{(1)})C_{k}^{(2)}}
\displaystyle=\left(1-\sum_{k=1}^{K}\mu_{k}^{(2)}\right)\log\frac{1-\sum_{k=1}%
^{K}\mu_{k}^{(2)}}{1-\sum_{k=1}^{K}\mu_{k}^{(1)}}+\sum_{k=1}^{K}\mu_{k}^{(2)}%
\log\frac{\mu_{k}^{(2)}}{\mu_{k}^{(1)}}+\sum_{k=1}^{K}\mu_{k}^{(2)}\left\{\log%
\frac{1-\sum_{j=1}^{K}\mu_{j}^{(2)}}{1-\sum_{j=1}^{K}\mu_{j}^{(1)}}-\log\frac{%
(1-\mu_{k}^{(2)})C_{k}^{(1)}}{(1-\mu_{k}^{(1)})C_{k}^{(2)}}\right\}
\displaystyle=\left(1-\sum_{k=1}^{K}\mu_{k}^{(2)}\right)\log\frac{1-\sum_{k=1}%
^{K}\mu_{k}^{(2)}}{1-\sum_{k=1}^{K}\mu_{k}^{(1)}}+\sum_{k=1}^{K}\mu_{k}^{(2)}%
\log\frac{\mu_{k}^{(2)}}{\mu_{k}^{(1)}}+\sum_{k=1}^{K}\mu_{k}^{(2)}\left\{\log%
\frac{1-\sum_{j=1}^{K}\mu_{j}^{(2)}}{1-\sum_{j=1}^{K}\mu_{j}^{(1)}}-\log\frac{%
(1-\mu_{k}^{(2)})C_{k}^{(1)}}{(1-\mu_{k}^{(1)})C_{k}^{(2)}}\right\}
\displaystyle=\mathrm{KL}(\bm{\mu}({\bm{z}}^{(2)}),\bm{\mu}({\bm{z}}^{(1)}))+%
\sum_{k=1}^{K}\mu_{k}^{(2)}\left\{\log\frac{\sum_{j=1}^{K}e^{z_{j}^{(1)}}}{%
\sum_{j=1}^{K}e^{z_{j}^{(2)}}}-\log\frac{C^{(1)}_{k}+e^{z_{k}^{(1)}}}{C^{(2)}_%
{k}+e^{z_{k}^{(2)}}}\right\}
\displaystyle=\mathrm{KL}(\bm{\mu}({\bm{z}}^{(2)}),\bm{\mu}({\bm{z}}^{(1)}))+%
\sum_{k=1}^{K}\mu_{k}^{(2)}\left\{\log\frac{\sum_{j=1}^{K}e^{z_{j}^{(1)}}}{%
\sum_{j=1}^{K}e^{z_{j}^{(2)}}}-\log\frac{C^{(1)}_{k}+e^{z_{k}^{(1)}}}{C^{(2)}_%
{k}+e^{z_{k}^{(2)}}}\right\}
\displaystyle=\mathrm{KL}(\bm{\mu}({\bm{z}}^{(2)}),\bm{\mu}({\bm{z}}^{(1)})).
\displaystyle=\mathrm{KL}(\bm{\mu}({\bm{z}}^{(2)}),\bm{\mu}({\bm{z}}^{(1)})).
{\bm{z}}_{1},{\bm{z}}_{2}
\nabla^{2}f({\bm{z}}_{1}+v({\bm{z}}_{2}-{\bm{z}}_{1}))\succeq e^{-M_{f}\lVert{%
\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2}v}\nabla^{2}f({\bm{z}}_{1}).
(1-v)
[0,1]
v
\displaystyle\int_{0}^{1}(1-v)\nabla^{2}f({\bm{z}}_{1}+v({\bm{z}}_{2}-{\bm{z}}%
_{1}))dv\succeq\int_{0}^{1}(1-v)e^{-M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert%
_{2}v}\nabla^{2}f({\bm{z}}_{1})dv
\displaystyle\int_{0}^{1}(1-v)\nabla^{2}f({\bm{z}}_{1}+v({\bm{z}}_{2}-{\bm{z}}%
_{1}))dv
\displaystyle\succeq\int_{0}^{1}(1-v)e^{-M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}%
\rVert_{2}v}\nabla^{2}f({\bm{z}}_{1})dv
\displaystyle=\left(\frac{1}{M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2}}+%
\frac{\exp(-M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2})-1}{(M_{f}\lVert{%
\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2})^{2}}\right)\nabla^{2}f({\bm{z}}_{1})
\displaystyle=\left(\frac{1}{M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2}}+%
\frac{\exp(-M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2})-1}{(M_{f}\lVert{%
\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2})^{2}}\right)\nabla^{2}f({\bm{z}}_{1})
\displaystyle\succeq\frac{1}{2+M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2}}%
\nabla^{2}f({\bm{z}}_{1}),
\displaystyle\succeq\frac{1}{2+M_{f}\lVert{\bm{z}}_{1}-{\bm{z}}_{2}\rVert_{2}}%
\nabla^{2}f({\bm{z}}_{1}),
\frac{1}{z}+\frac{e^{-z}-1}{z^{2}}\geq\frac{1}{2+z}
z\geq 0
1-\delta
{\mathcal{L}}_{t}(\bm{\Theta}_{\star})-{\mathcal{L}}_{t}(\widehat{\bm{\Theta}}%
_{t})\leq\beta_{t}(\delta)^{2}
\bm{\Theta}\in{\mathcal{C}}_{t}(\delta)
\bm{\theta}=\mathrm{vec}(\bm{\Theta}^{\intercal})
{\mathcal{L}}_{t}(\bm{\theta})
\bm{\theta}_{\star}
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}%
_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}={\mathcal{L}}_{t}(\bm{\theta})-{%
\mathcal{L}}_{t}(\bm{\theta}_{\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{%
\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta})+\lambda\lVert\bm{\theta}-%
\bm{\theta}_{\star}\rVert_{2}^{2}
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}%
_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}
\displaystyle={\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\bm{\theta}_{%
\star})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{\theta}_{%
\star}-\bm{\theta})+\lambda\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{2}^{2}
\displaystyle\leq{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\widehat{\bm%
{\theta}}_{t})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{%
\theta}_{\star}-\bm{\theta})+\lambda\lVert\bm{\theta}-\bm{\theta}_{\star}%
\rVert_{2}^{2}
\displaystyle\leq{\mathcal{L}}_{t}(\bm{\theta})-{\mathcal{L}}_{t}(\widehat{\bm%
{\theta}}_{t})+\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{%
\theta}_{\star}-\bm{\theta})+\lambda\lVert\bm{\theta}-\bm{\theta}_{\star}%
\rVert_{2}^{2}
\displaystyle\leq K+\beta_{t}(\delta)^{2}+\nabla{\mathcal{L}}_{t}(\bm{\theta}_%
{\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}),\quad\text{w.p. at least%
 $1-\delta$},
1-\delta
\displaystyle\leq K+\beta_{t}(\delta)^{2}+\nabla{\mathcal{L}}_{t}(\bm{\theta}_%
{\star})^{\intercal}(\bm{\theta}_{\star}-\bm{\theta}),\quad\text{w.p. at least%
 $1-\delta$},
1-\delta
\lambda=\frac{K}{4S^{2}}
\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}{\bm{v}}=\sum_{s=1}^{t%
}\left[\left(\bm{\mu}({\bm{x}}_{s},\bm{\Theta}_{\star})-{\bm{y}}_{s}\right)%
\otimes{\bm{x}}_{s}\right]^{\intercal}{\bm{v}}=\sum_{s=1}^{t}\bm{\xi}_{s}^{%
\intercal}\mathrm{vec}^{-1}({\bm{v}}){\bm{x}}_{s}
\mathrm{vec}^{-1}
\bm{\xi}_{s}:=\bm{\mu}({\bm{x}}_{s},\bm{\Theta}_{\star})-{\bm{y}}_{s}
{\mathcal{B}}^{dK}(2S)
dK
2S
{\bm{v}}\in{\mathcal{B}}^{dK}(2S)
\bm{\xi}_{s}^{\intercal}\mathrm{vec}^{-1}({\bm{v}}){\bm{x}}_{s}
\displaystyle\left|\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^{-1}({\bm{v}}){%
\bm{x}}_{s}\right)\right|\leq 2S,
\displaystyle\left|\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^{-1}({\bm{v}}){%
\bm{x}}_{s}\right)\right|
\displaystyle\leq 2S,
\displaystyle\mathbb{E}\left[\left(\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^%
{-1}({\bm{v}}){\bm{x}}_{s}\right)\right)^{2}\Big{|}{\mathcal{F}}_{s-1}\right]=%
\lVert\mathrm{vec}^{-1}({\bm{v}}){\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}%
_{s})}^{2}.
\displaystyle\mathbb{E}\left[\left(\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^%
{-1}({\bm{v}}){\bm{x}}_{s}\right)\right)^{2}\Big{|}{\mathcal{F}}_{s-1}\right]
\displaystyle=\lVert\mathrm{vec}^{-1}({\bm{v}}){\bm{x}}_{s}\rVert_{{\bm{A}}_{%
\star}({\bm{x}}_{s})}^{2}.
{\bm{A}}_{\star}({\bm{x}}_{s}):={\bm{A}}({\bm{x}}_{s},\bm{\Theta}_{\star})
\eta\in\left[0,\frac{1}{2S}\right]
{\mathbb{P}}\left[\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^{-1%
}({\bm{v}}){\bm{x}}_{s}\right)\leq(e-2)\eta\sum_{s=1}^{t}\lVert\mathrm{vec}^{-%
1}({\bm{v}}){\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}+\frac{1}{%
\eta}\log\frac{1}{\delta}\right]\geq 1-\delta.
\varepsilon
{\bm{v}}_{t}
\lVert{\bm{v}}_{t}\rVert_{2}\leq 2S
\lVert(\bm{\theta}_{\star}-\bm{\theta})-{\bm{v}}_{t}\rVert_{2}\leq\varepsilon_%
{t}
\displaystyle\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{%
\theta}_{\star}-\bm{\theta})
\displaystyle\nabla{\mathcal{L}}_{t}(\bm{\theta}_{\star})^{\intercal}(\bm{%
\theta}_{\star}-\bm{\theta})
\mathrm{vec}^{-1}
\mathrm{vec}^{-1}
\mathrm{vec}^{-1}
\displaystyle=\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^{-1}({%
\bm{v}}_{t}){\bm{x}}_{s}\right)+\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}\left(%
\mathrm{vec}^{-1}((\bm{\theta}_{\star}-\bm{\theta})-{\bm{v}}_{t}){\bm{x}}_{s}\right)
\displaystyle=\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}\left(\mathrm{vec}^{-1}({%
\bm{v}}_{t}){\bm{x}}_{s}\right)+\sum_{s=1}^{t}\bm{\xi}_{s}^{\intercal}\left(%
\mathrm{vec}^{-1}((\bm{\theta}_{\star}-\bm{\theta})-{\bm{v}}_{t}){\bm{x}}_{s}\right)
1-\delta
1-\delta
1-\delta
\displaystyle\leq(e-2)\eta\sum_{s=1}^{t}\lVert\mathrm{vec}^{-1}({\bm{v}}_{t}){%
\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}+\frac{dK}{\eta}\log%
\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle\leq(e-2)\eta\sum_{s=1}^{t}\lVert\mathrm{vec}^{-1}({\bm{v}}_{t}){%
\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}+\frac{dK}{\eta}\log%
\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle=(e-2)\eta\left\{\sum_{s=1}^{t}\lVert\mathrm{vec}^{-1}(\bm{\theta%
}_{\star}-\bm{\theta}){\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}+%
\sum_{s=1}^{t}\left(\lVert\mathrm{vec}^{-1}({\bm{v}}_{t}){\bm{x}}_{s}\rVert_{{%
\bm{A}}_{\star}({\bm{x}}_{s})}^{2}-\lVert\mathrm{vec}^{-1}\left(\bm{\theta}_{%
\star}-\bm{\theta}\right){\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{%
2}\right)\right\}
\displaystyle=(e-2)\eta\left\{\sum_{s=1}^{t}\lVert\mathrm{vec}^{-1}(\bm{\theta%
}_{\star}-\bm{\theta}){\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}+%
\sum_{s=1}^{t}\left(\lVert\mathrm{vec}^{-1}({\bm{v}}_{t}){\bm{x}}_{s}\rVert_{{%
\bm{A}}_{\star}({\bm{x}}_{s})}^{2}-\lVert\mathrm{vec}^{-1}\left(\bm{\theta}_{%
\star}-\bm{\theta}\right){\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{%
2}\right)\right\}
\displaystyle\quad+\frac{dK}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta%
}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle\quad+\frac{dK}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta%
}\log\frac{1}{\delta}+\varepsilon_{t}t
\displaystyle\overset{(*)}{\leq}(e-2)\eta\sum_{s=1}^{t}\left\lVert(\bm{\Theta}%
_{\star}-\bm{\Theta}){\bm{x}}_{s}\right\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}%
^{2}+(e-2)\eta L\left(4S+\varepsilon_{t}\right)\varepsilon_{t}t+\frac{dK}{\eta%
}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon%
_{t}t
\displaystyle\overset{(*)}{\leq}(e-2)\eta\sum_{s=1}^{t}\left\lVert(\bm{\Theta}%
_{\star}-\bm{\Theta}){\bm{x}}_{s}\right\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}%
^{2}+(e-2)\eta L\left(4S+\varepsilon_{t}\right)\varepsilon_{t}t+\frac{dK}{\eta%
}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\varepsilon%
_{t}t
\displaystyle\overset{(**)}{=}(e-2)\eta\lVert\bm{\theta}_{\star}-\bm{\theta}%
\rVert_{{\bm{H}}_{t}(\bm{\theta}_{\star})}^{2}+\frac{dK}{\eta}\log\frac{5S}{%
\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\left((e-2)L\left(4S\eta+%
\varepsilon_{t}\eta\right)+1\right)\varepsilon_{t}t
\displaystyle\overset{(**)}{=}(e-2)\eta\lVert\bm{\theta}_{\star}-\bm{\theta}%
\rVert_{{\bm{H}}_{t}(\bm{\theta}_{\star})}^{2}+\frac{dK}{\eta}\log\frac{5S}{%
\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+\left((e-2)L\left(4S\eta+%
\varepsilon_{t}\eta\right)+1\right)\varepsilon_{t}t
{\bm{H}}_{t}(\bm{\theta}_{\star})\preceq(2+2\sqrt{6}S)\widetilde{{\bm{G}}}_{t}%
(\bm{\theta}_{\star},\bm{\theta})
{\bm{H}}_{t}(\bm{\theta}_{\star})\preceq(2+2\sqrt{6}S)\widetilde{{\bm{G}}}_{t}%
(\bm{\theta}_{\star},\bm{\theta})
{\bm{H}}_{t}(\bm{\theta}_{\star})\preceq(2+2\sqrt{6}S)\widetilde{{\bm{G}}}_{t}%
(\bm{\theta}_{\star},\bm{\theta})
\displaystyle\leq(e-2)(2+2\sqrt{6}S)\eta\lVert\bm{\theta}_{\star}-\bm{\theta}%
\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}+\frac{%
dK}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+%
\left((e-2)L\left(4S\eta+\varepsilon_{t}\eta\right)+1\right)\varepsilon_{t}t,
\displaystyle\leq(e-2)(2+2\sqrt{6}S)\eta\lVert\bm{\theta}_{\star}-\bm{\theta}%
\rVert_{\widetilde{{\bm{G}}}_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}+\frac{%
dK}{\eta}\log\frac{5S}{\varepsilon_{t}}+\frac{1}{\eta}\log\frac{1}{\delta}+%
\left((e-2)L\left(4S\eta+\varepsilon_{t}\eta\right)+1\right)\varepsilon_{t}t,
(*)
\displaystyle\lVert{\bm{C}}{\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}%
^{2}-\lVert{\bm{D}}{\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}=%
\lVert{\bm{D}}{\bm{x}}_{s}+({\bm{C}}-{\bm{D}}){\bm{x}}_{s}\rVert_{{\bm{A}}_{%
\star}({\bm{x}}_{s})}^{2}-\lVert{\bm{D}}{\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({%
\bm{x}}_{s})}^{2}
\displaystyle\lVert{\bm{C}}{\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}%
^{2}-\lVert{\bm{D}}{\bm{x}}_{s}\rVert_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}
\displaystyle=\lVert{\bm{D}}{\bm{x}}_{s}+({\bm{C}}-{\bm{D}}){\bm{x}}_{s}\rVert%
_{{\bm{A}}_{\star}({\bm{x}}_{s})}^{2}-\lVert{\bm{D}}{\bm{x}}_{s}\rVert_{{\bm{A%
}}_{\star}({\bm{x}}_{s})}^{2}
\displaystyle=2{\bm{x}}_{s}^{\intercal}{\bm{D}}^{\intercal}{\bm{A}}_{\star}({%
\bm{x}}_{s})({\bm{C}}-{\bm{D}}){\bm{x}}_{s}+{\bm{x}}_{s}^{\intercal}({\bm{C}}-%
{\bm{D}})^{\intercal}{\bm{A}}_{\star}({\bm{x}}_{s})({\bm{C}}-{\bm{D}}){\bm{x}}%
_{s}
\displaystyle=2{\bm{x}}_{s}^{\intercal}{\bm{D}}^{\intercal}{\bm{A}}_{\star}({%
\bm{x}}_{s})({\bm{C}}-{\bm{D}}){\bm{x}}_{s}+{\bm{x}}_{s}^{\intercal}({\bm{C}}-%
{\bm{D}})^{\intercal}{\bm{A}}_{\star}({\bm{x}}_{s})({\bm{C}}-{\bm{D}}){\bm{x}}%
_{s}
L
L
L
\displaystyle\leq 2\lVert{\bm{D}}^{\intercal}{\bm{A}}_{\star}({\bm{x}}_{s})({%
\bm{C}}-{\bm{D}}){\bm{x}}_{s}\rVert_{2}+L\varepsilon_{t}^{2}
\displaystyle\leq 2\lVert{\bm{D}}^{\intercal}{\bm{A}}_{\star}({\bm{x}}_{s})({%
\bm{C}}-{\bm{D}}){\bm{x}}_{s}\rVert_{2}+L\varepsilon_{t}^{2}
\displaystyle\leq 2\lVert{\bm{D}}^{\intercal}\rVert_{2}\lVert{\bm{A}}_{\star}(%
{\bm{x}}_{s})\rVert_{2}\lVert({\bm{C}}-{\bm{D}})\rVert_{2}+L\varepsilon_{t}^{2}
\displaystyle\leq 2\lVert{\bm{D}}^{\intercal}\rVert_{2}\lVert{\bm{A}}_{\star}(%
{\bm{x}}_{s})\rVert_{2}\lVert({\bm{C}}-{\bm{D}})\rVert_{2}+L\varepsilon_{t}^{2}
L
L
L
\displaystyle\leq 2L\lVert{\bm{D}}^{\intercal}\rVert_{F}\lVert({\bm{C}}-{\bm{D%
}})\rVert_{F}+L\varepsilon_{t}^{2}
\displaystyle\leq 2L\lVert{\bm{D}}^{\intercal}\rVert_{F}\lVert({\bm{C}}-{\bm{D%
}})\rVert_{F}+L\varepsilon_{t}^{2}
\displaystyle\leq L\left(4S+\varepsilon_{t}\right)\varepsilon_{t}
\displaystyle\leq L\left(4S+\varepsilon_{t}\right)\varepsilon_{t}
{\bm{C}},{\bm{D}}\in{\mathbb{R}}^{d\times K}
\lVert{\bm{C}}\rVert_{F},\lVert{\bm{D}}\rVert_{F}\leq 2S
\lVert{\bm{C}}-{\bm{D}}\rVert_{F}\leq\varepsilon_{t}
(**)
\bm{\theta}=\mathrm{vec}(\bm{\Theta}^{\intercal})
\displaystyle\bm{\theta}^{\intercal}({\bm{A}}\otimes{\bm{x}}{\bm{x}}^{%
\intercal})\bm{\theta}=\mathrm{vec}(\bm{\Theta}^{\intercal})^{\intercal}({\bm{%
A}}\otimes{\bm{x}}{\bm{x}}^{\intercal})\mathrm{vec}(\bm{\Theta}^{\intercal})
\displaystyle\bm{\theta}^{\intercal}({\bm{A}}\otimes{\bm{x}}{\bm{x}}^{%
\intercal})\bm{\theta}
\displaystyle=\mathrm{vec}(\bm{\Theta}^{\intercal})^{\intercal}({\bm{A}}%
\otimes{\bm{x}}{\bm{x}}^{\intercal})\mathrm{vec}(\bm{\Theta}^{\intercal})
\displaystyle\overset{(a)}{=}\mathrm{vec}(\bm{\Theta}^{\intercal})^{\intercal}%
\mathrm{vec}\left({\bm{x}}{\bm{x}}^{\intercal}\bm{\Theta}^{\intercal}{\bm{A}}^%
{\intercal}\right)
\displaystyle\overset{(a)}{=}\mathrm{vec}(\bm{\Theta}^{\intercal})^{\intercal}%
\mathrm{vec}\left({\bm{x}}{\bm{x}}^{\intercal}\bm{\Theta}^{\intercal}{\bm{A}}^%
{\intercal}\right)
\displaystyle\overset{(a)}{=}\mathrm{vec}(\bm{\Theta}^{\intercal})^{\intercal}%
\left({\bm{A}}\bm{\Theta}\otimes{\bm{x}}\right){\bm{x}}
\displaystyle\overset{(a)}{=}\mathrm{vec}(\bm{\Theta}^{\intercal})^{\intercal}%
\left({\bm{A}}\bm{\Theta}\otimes{\bm{x}}\right){\bm{x}}
\displaystyle\overset{(b)}{=}{\bm{x}}^{\intercal}\left(\bm{\Theta}^{\intercal}%
{\bm{A}}^{\intercal}\otimes{\bm{x}}^{\intercal}\right)\mathrm{vec}(\bm{\Theta}%
^{\intercal})
\displaystyle\overset{(b)}{=}{\bm{x}}^{\intercal}\left(\bm{\Theta}^{\intercal}%
{\bm{A}}^{\intercal}\otimes{\bm{x}}^{\intercal}\right)\mathrm{vec}(\bm{\Theta}%
^{\intercal})
\displaystyle\overset{(a)}{=}{\bm{x}}^{\intercal}\mathrm{vec}({\bm{x}}^{%
\intercal}\bm{\Theta}^{\intercal}{\bm{A}}\bm{\Theta})
\displaystyle\overset{(a)}{=}{\bm{x}}^{\intercal}\mathrm{vec}({\bm{x}}^{%
\intercal}\bm{\Theta}^{\intercal}{\bm{A}}\bm{\Theta})
\displaystyle={\bm{x}}^{\intercal}\bm{\Theta}^{\intercal}{\bm{A}}\bm{\Theta}{%
\bm{x}},
\displaystyle={\bm{x}}^{\intercal}\bm{\Theta}^{\intercal}{\bm{A}}\bm{\Theta}{%
\bm{x}},
(a)
({\bm{C}}\otimes{\bm{D}})\mathrm{vec}({\bm{E}})=\mathrm{vec}({\bm{D}}{\bm{E}}{%
\bm{C}}^{\intercal})
(b)
({\bm{C}}\otimes{\bm{D}})^{\intercal}={\bm{C}}^{\intercal}\otimes{\bm{D}}^{\intercal}
\eta=\frac{1}{2(e-2)(2+2\sqrt{6}S)}<\frac{1}{2S}
\varepsilon_{t}=\frac{dK}{t}
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}%
_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}\lesssim dKS\log\left(e+\frac{St}{dK%
}\right)+\sqrt{K}S\log\frac{1}{\delta}+dKL.
\displaystyle\lVert\bm{\theta}-\bm{\theta}_{\star}\rVert_{\widetilde{{\bm{G}}}%
_{t}(\bm{\theta}_{\star},\bm{\theta})}^{2}\lesssim dKS\log\left(e+\frac{St}{dK%
}\right)+\sqrt{K}S\log\frac{1}{\delta}+dKL.
\displaystyle\det({\bm{V}}_{t+1})=\det\left({\bm{V}}_{t}+\sum_{k=1}^{K}{\bm{x}%
}_{t,k}{\bm{x}}_{t,k}^{\intercal}\right)
\displaystyle\det({\bm{V}}_{t+1})
\displaystyle=\det\left({\bm{V}}_{t}+\sum_{k=1}^{K}{\bm{x}}_{t,k}{\bm{x}}_{t,k%
}^{\intercal}\right)
\displaystyle=\det({\bm{V}}_{t})\det\left({\bm{I}}+\sum_{k=1}^{K}{\bm{V}}_{t}^%
{-\frac{1}{2}}{\bm{x}}_{t,k}\left({\bm{V}}_{t}^{-\frac{1}{2}}{\bm{x}}_{t,k}%
\right)^{\intercal}\right)
\displaystyle=\det({\bm{V}}_{t})\det\left({\bm{I}}+\sum_{k=1}^{K}{\bm{V}}_{t}^%
{-\frac{1}{2}}{\bm{x}}_{t,k}\left({\bm{V}}_{t}^{-\frac{1}{2}}{\bm{x}}_{t,k}%
\right)^{\intercal}\right)
\displaystyle\overset{(*)}{\geq}\det({\bm{V}}_{t})\left(1+\sum_{k=1}^{K}\left%
\lVert{\bm{x}}_{t,k}\right\rVert_{{\bm{V}}_{t}^{-1}}^{2}\right),
\displaystyle\overset{(*)}{\geq}\det({\bm{V}}_{t})\left(1+\sum_{k=1}^{K}\left%
\lVert{\bm{x}}_{t,k}\right\rVert_{{\bm{V}}_{t}^{-1}}^{2}\right),
(*)
{\bm{A}}=[{\bm{a}}_{1}\cdots{\bm{a}}_{K}]
\det({\bm{I}}+{\bm{A}}{\bm{A}}^{\intercal})\geq 1+\mathrm{tr}({\bm{A}}{\bm{A}}%
^{\intercal})=1+\sum_{k=1}^{K}\lVert{\bm{a}}_{k}\rVert^{2}
2\log(1+z)\geq z
z\in[0,1]
\displaystyle\sum_{t=1}^{T}\min\left\{1,\sum_{k=1}^{K}\left\lVert{\bm{x}}_{t,k%
}\right\rVert_{{\bm{V}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}\right\}\leq 2\sum_{%
t=1}^{T}\log\left(1+\sum_{k=1}^{K}\left\lVert{\bm{x}}_{t,k}\right\rVert_{{\bm{%
V}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}\right)
\displaystyle\sum_{t=1}^{T}\min\left\{1,\sum_{k=1}^{K}\left\lVert{\bm{x}}_{t,k%
}\right\rVert_{{\bm{V}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}\right\}
\displaystyle\leq 2\sum_{t=1}^{T}\log\left(1+\sum_{k=1}^{K}\left\lVert{\bm{x}}%
_{t,k}\right\rVert_{{\bm{V}}_{t}^{-1}(\bm{\theta}_{\star})}^{2}\right)
\displaystyle\leq 2\left(\log\det({\bm{V}}_{T})-d\log\lambda\right)
\displaystyle\leq 2\left(\log\det({\bm{V}}_{T})-d\log\lambda\right)
\displaystyle\overset{(*)}{\leq}2d\log\left(1+\frac{KT}{d\lambda}\right),
\displaystyle\overset{(*)}{\leq}2d\log\left(1+\frac{KT}{d\lambda}\right),
(*)
\lVert{\bm{x}}_{t,k}\rVert\leq 1
\det({\bm{V}}_{T})\leq\left(\frac{d\lambda+KT}{d}\right)^{d}
{\bm{A}}{\bm{A}}^{\intercal}
\lambda_{1}\geq\cdots\geq\lambda_{m}\geq 0
m=\min\{d,K\}
\det({\bm{I}}+{\bm{A}}{\bm{A}}^{\intercal})=\prod_{k=1}^{m}(1+\lambda_{k})\geq
1%
+\sum_{k=1}^{m}\lambda_{k}=1+\mathrm{tr}({\bm{A}}{\bm{A}}^{\intercal})=1+%
\mathrm{tr}\left(\sum_{k=1}^{K}{\bm{a}}_{k}{\bm{a}}_{k}^{\intercal}\right)=1+%
\sum_{k=1}^{K}\lVert{\bm{a}}_{k}\rVert^{2}.
{\bm{M}}_{T}:=\lambda{\bm{I}}+\sum_{t\in{\mathcal{H}}_{T}}\sum_{k=1}^{K}{\bm{x%
}}_{t,k}{\bm{x}}_{t,k}^{\intercal}
\lambda_{1}\geq\cdots\geq\lambda_{d}\geq 0
\sum_{t\in{\mathcal{H}}_{T}}\sum_{k=1}^{K}{\bm{x}}_{t,k}{\bm{x}}_{t,k}^{\intercal}
\displaystyle\det({\bm{M}}_{T})=\prod_{i=1}^{d}(\lambda+\lambda_{i})
\displaystyle\det({\bm{M}}_{T})
\displaystyle=\prod_{i=1}^{d}(\lambda+\lambda_{i})
\displaystyle\leq\left(\sum_{i=1}^{d}\frac{\lambda+\lambda_{i}}{d}\right)^{d}
\displaystyle\leq\left(\sum_{i=1}^{d}\frac{\lambda+\lambda_{i}}{d}\right)^{d}
\displaystyle\leq\left(\lambda+\frac{1}{d}\mathrm{tr}\left(\sum_{t\in{\mathcal%
{H}}_{T}}\sum_{k=1}^{K}{\bm{x}}_{t,k}{\bm{x}}_{t,k}^{\intercal}\right)\right)^%
{d}
\displaystyle\leq\left(\lambda+\frac{1}{d}\mathrm{tr}\left(\sum_{t\in{\mathcal%
{H}}_{T}}\sum_{k=1}^{K}{\bm{x}}_{t,k}{\bm{x}}_{t,k}^{\intercal}\right)\right)^%
{d}
\displaystyle\leq\left(\lambda+\frac{K|{\mathcal{H}}_{T}|}{d}\right)^{d}.
\displaystyle\leq\left(\lambda+\frac{K|{\mathcal{H}}_{T}|}{d}\right)^{d}.
\det({\bm{M}}_{T})\geq\lambda^{d}\prod_{t\in{\mathcal{H}}_{T}}\left(1+\sum_{k=%
1}^{K}\lVert{\bm{x}}_{t,k}\rVert_{{\bm{M}}_{t}^{-1}}^{2}\right)\geq\lambda^{d}%
\prod_{t\in{\mathcal{H}}_{T}}\left(1+\sum_{k=1}^{K}\lVert{\bm{x}}_{t,k}\rVert_%
{{\bm{V}}_{t}^{-1}}^{2}\right)\geq\lambda^{d}2^{|{\mathcal{H}}_{T}|}.
|{\mathcal{H}}_{T}|\leq\frac{d}{\log(2)}\log\left(1+\frac{K|{\mathcal{H}}_{T}|%
}{\lambda d}\right).
