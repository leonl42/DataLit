(x_{\mathrm{target}},y_{\mathrm{target}})
y_{\mathrm{target}}
y_{\mathrm{adversarial}}
S_{\mathrm{po}}
S_{\mathrm{ca}}
S_{\mathrm{cl}}
S_{\mathrm{cpc}}=S_{\mathrm{cl}}+S_{\mathrm{po}}+S_{\mathrm{ca}}
S_{\mathrm{cpc}}
\theta_{\mathrm{cpc}}
S_{\mathrm{ca}}
\theta_{\mathrm{cp}}
S_{\mathrm{cp}}=S_{\mathrm{cl}}+S_{\mathrm{po}}
S_{\mathrm{cl}}
\theta_{\mathrm{cpc}}
y_{\text{target}}
x_{\text{target}}
\theta_{\mathrm{cp}}
y_{\mathrm{adversarial}}
x_{\text{target}}
\lvert S_{\mathrm{po}}\rvert\ll\lvert S_{\mathrm{cl}}\rvert
\lvert S_{\mathrm{ca}}\rvert\ll\lvert S_{\mathrm{cl}}\rvert
b_{p}\vcentcolon={}\tfrac{\left\lvert S_{\mathrm{po}}\right\rvert}{\left\lvert
S%
_{\mathrm{cl}}\right\rvert}\times 100
b_{c}\vcentcolon={}\tfrac{\left\lvert S_{\mathrm{ca}}\right\rvert}{\left\lvert
S%
_{\mathrm{cl}}\right\rvert}\times 100
\varepsilon
\ell_{\infty}
\varepsilon\leq 16
0
255
(\varepsilon,b_{c},b_{p})
S_{\mathrm{cp}}=S_{\mathrm{cl}}+S_{\mathrm{po}}
y_{\mathrm{adversarial}}
y_{\mathrm{target}}
x_{\mathrm{target}}
S_{\mathrm{cp}}
N_{1}
(x^{i},y^{i})_{i\leq N_{1}}
P
i=1
P
S_{\mathrm{po}}
\Delta^{i}
x^{i}
\displaystyle\min_{\Delta\in\Gamma}\ell\left(f(x_{\mathrm{target}},\theta(%
\Delta)),y_{\mathrm{adversarial}}\right)\quad\text{where}\quad\theta(\Delta)%
\in\operatorname*{arg\,min}_{\theta}\frac{1}{N}\sum_{i\leq N}\ell(f(x^{i}+%
\Delta^{i},\theta),y^{i}),
\displaystyle\min_{\Delta\in\Gamma}\ell\left(f(x_{\mathrm{target}},\theta(%
\Delta)),y_{\mathrm{adversarial}}\right)\quad\text{where}\quad\theta(\Delta)%
\in\operatorname*{arg\,min}_{\theta}\frac{1}{N}\sum_{i\leq N}\ell(f(x^{i}+%
\Delta^{i},\theta),y^{i}),
\Gamma\vcentcolon={}\left\{\Delta:\|\Delta\|_{\infty}\leq\varepsilon%
\leavevmode\nobreak\ \text{and}\leavevmode\nobreak\ \Delta^{i}=0\leavevmode%
\nobreak\ \text{for all}\leavevmode\nobreak\ i>P\right\}
S_{\mathrm{cpc}}=S_{\mathrm{cl}}+S_{\mathrm{po}}+S_{\mathrm{ca}}
S_{\mathrm{cl}}
x_{\mathrm{target}}
S_{\mathrm{cpc}}
N_{2}
(x^{j},y^{j})_{j\leq N_{2}}
C
j=N_{2}-C+1
N_{2}
S_{\mathrm{ca}}
\Delta^{j}
x^{j}
\Delta
\displaystyle\min_{\Delta\in\Gamma}\ell\left(f(x_{\mathrm{target}},\theta(%
\Delta)),y_{\mathrm{target}}\right)\quad\text{where}\quad\theta(\Delta)\in%
\operatorname*{arg\,min}_{\theta}\frac{1}{N_{2}}\sum_{j\leq N_{2}}\ell(f(x^{j}%
+\Delta^{j},\theta),y^{j}),
\displaystyle\min_{\Delta\in\Gamma}\ell\left(f(x_{\mathrm{target}},\theta(%
\Delta)),y_{\mathrm{target}}\right)\quad\text{where}\quad\theta(\Delta)\in%
\operatorname*{arg\,min}_{\theta}\frac{1}{N_{2}}\sum_{j\leq N_{2}}\ell(f(x^{j}%
+\Delta^{j},\theta),y^{j}),
\Gamma\vcentcolon={}\left\{\Delta:\|\Delta\|_{\infty}\leq\varepsilon%
\leavevmode\nobreak\ \text{and}\leavevmode\nobreak\ \Delta^{j}=0\leavevmode%
\nobreak\ \text{for all}\leavevmode\nobreak\ j\leq N_{2}-C\right\}
\Delta
y_{\mathrm{adversarial}}
\Delta
\theta
\displaystyle\nabla_{\theta}(\ell(f(x_{\mathrm{target}},\theta),y_{\mathrm{%
adversarial}}))\approx\frac{1}{P}\sum_{i=1}^{P}\nabla_{\theta}\ell\left(f(x^{i%
}+\Delta^{i},\theta),y^{i}\right).
\displaystyle\nabla_{\theta}(\ell(f(x_{\mathrm{target}},\theta),y_{\mathrm{%
adversarial}}))\approx\frac{1}{P}\sum_{i=1}^{P}\nabla_{\theta}\ell\left(f(x^{i%
}+\Delta^{i},\theta),y^{i}\right).
S_{\mathrm{cl}}+S_{\mathrm{po}}
y_{\mathrm{adversarial}}
\Delta
\theta
\theta_{\mathrm{cl}}
-
S_{\mathrm{cl}}
\displaystyle\phi(\Delta,\theta)=1-\frac{\left\langle\nabla_{\theta}\ell\left(%
f(x_{\mathrm{target}},\theta),y_{\mathrm{adversarial}}\right),\sum_{i=1}^{P}%
\nabla_{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\right\rangle}{\|\nabla_{%
\theta}\ell\left(f(x_{\mathrm{target}},\theta),y_{\mathrm{adversarial}}\right)%
\|\|\sum_{i=1}^{P}\nabla_{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\|},
\displaystyle\phi(\Delta,\theta)=1-\frac{\left\langle\nabla_{\theta}\ell\left(%
f(x_{\mathrm{target}},\theta),y_{\mathrm{adversarial}}\right),\sum_{i=1}^{P}%
\nabla_{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\right\rangle}{\|\nabla_{%
\theta}\ell\left(f(x_{\mathrm{target}},\theta),y_{\mathrm{adversarial}}\right)%
\|\|\sum_{i=1}^{P}\nabla_{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\|},
y\in\left\{-1,1\right\}
\ell(f(x,\theta),y)=-yf(x,\theta)
S_{\mathrm{po}}
S_{\mathrm{ca}}
(x^{i},y^{i})\in S_{\mathrm{po}}
(x^{i},-y^{i})
S_{\mathrm{ca}}
b_{p}=b_{c}
\theta
\displaystyle\sum_{(x,y)\in S_{\mathrm{cpc}}}\ell(f(x,\theta),y)=-{\sum_{(x,y)%
\in S_{\mathrm{cl}}}yf(x,\theta)-\sum_{i=1}^{P}\left(y^{i}f(x^{i},\theta)+(-y^%
{i})f(x^{i},\theta)\right)}=\sum_{(x,y)\in S_{\mathrm{cl}}}\ell(f(x,\theta),y).
\displaystyle\sum_{(x,y)\in S_{\mathrm{cpc}}}\ell(f(x,\theta),y)=-{\sum_{(x,y)%
\in S_{\mathrm{cl}}}yf(x,\theta)-\sum_{i=1}^{P}\left(y^{i}f(x^{i},\theta)+(-y^%
{i})f(x^{i},\theta)\right)}=\sum_{(x,y)\in S_{\mathrm{cl}}}\ell(f(x,\theta),y).
\nabla_{\theta}\sum_{S_{\mathrm{cpc}}}\ell(f(x,\theta),y)=\nabla_{\theta}\sum_%
{S_{\mathrm{cl}}}\ell(f(x,\theta),y)
\theta
S_{\mathrm{cpc}}
S_{\mathrm{cl}}
(x^{i},-y^{i})
y=+1
y=-1
(\varepsilon,b_{p},b_{c})
(8,0.2\%,0.2\%)
\pm
\pm
(16,0.2\%,0.2\%)
\pm 0.03
\pm 0.02
(8,0.2\%,0.4\%)
\pm 0.01
\pm 0.02
(16,0.2\%,0.4\%)
\pm 0.03
\pm
(\varepsilon,b_{p},b_{c})
10
k\in\{0,\dots,9\}
(\varepsilon,b_{p},b_{c})
10
k\in\{0,\dots,9\}
\Delta
y_{\mathrm{target}}
\Delta
\theta
\displaystyle\nabla_{\theta}(\ell(f(x_{\mathrm{target}},\theta),y_{\mathrm{%
target}}))\approx\frac{1}{C}\sum_{i=1}^{C}\nabla_{\theta}\ell\left(f(x^{i}+%
\Delta^{i},\theta),y^{i}\right).
\displaystyle\nabla_{\theta}(\ell(f(x_{\mathrm{target}},\theta),y_{\mathrm{%
target}}))\approx\frac{1}{C}\sum_{i=1}^{C}\nabla_{\theta}\ell\left(f(x^{i}+%
\Delta^{i},\theta),y^{i}\right).
\theta
\theta_{\mathrm{cp}}
S_{\mathrm{cp}}=S_{\mathrm{cl}}+S_{\mathrm{po}}
\displaystyle\psi(\Delta,\theta)=1-\frac{\left\langle\nabla_{\theta}\ell\left(%
f(x_{\mathrm{target}},\theta),y_{\mathrm{target}}\right),\sum_{i=1}^{C}\nabla_%
{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\right\rangle}{\|\nabla_{\theta}%
\ell\left(f(x_{\mathrm{target}},\theta),y_{\mathrm{target}}\right)\|\|\sum_{i=%
1}^{C}\nabla_{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\|}.
\displaystyle\psi(\Delta,\theta)=1-\frac{\left\langle\nabla_{\theta}\ell\left(%
f(x_{\mathrm{target}},\theta),y_{\mathrm{target}}\right),\sum_{i=1}^{C}\nabla_%
{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\right\rangle}{\|\nabla_{\theta}%
\ell\left(f(x_{\mathrm{target}},\theta),y_{\mathrm{target}}\right)\|\|\sum_{i=%
1}^{C}\nabla_{\theta}\ell(f(x_{i}+\Delta_{i},\theta),y_{i})\|}.
f(\cdot\leavevmode\nobreak\ ;\theta_{\mathrm{cp}})
S_{\mathrm{cl}}+S_{\mathrm{po}}
(x_{\mathrm{target}},y_{\mathrm{target}})
C
\varepsilon
R
M
S_{\mathrm{ca}}=\left\{x^{j},y^{j}\right\}_{j=1}^{C}
C
y_{\mathrm{target}}
r=1,\dots R
\Delta
\|\Delta\|_{\infty}\leq\varepsilon
k=1,\dots,M
\psi(\Delta,\theta_{\mathrm{cp}})
S_{\mathrm{ca}}
\Delta
\psi
\Gamma
R
\Delta_{*}
\psi(\Delta_{*},\theta_{\mathrm{cp}})
S_{\mathrm{ca}}=\left\{x^{j}+\Delta_{*}^{j},y^{j}\right\}_{j=1}^{C}
0.1
R
R\leq 10
\Delta
\|\Delta\|_{\infty}\leq\varepsilon
M
\psi(\Delta,\theta_{\mathrm{cp}})
\psi
\Delta
\Delta
\Gamma
\|\Delta\|_{\infty}\leq\varepsilon
R
\Delta_{*}
\psi(\Delta_{\star},\theta_{\mathrm{cp}})
R=1
M=250
K
K\in\left\{3,5,8,10\right\}
S_{\mathrm{cp}}=S_{\mathrm{cl}}+S_{\mathrm{po}}
y_{\mathrm{adversarial}}
S_{\mathrm{cpc}}=S_{\mathrm{po}}+S_{\mathrm{cl}}+S_{\mathrm{ca}}
y_{\mathrm{target}}
10
32\times 32
(\varepsilon,b_{p},b_{c})
(8,0.2\%,0.2\%)
\pm
\pm
(16,0.2\%,0.2\%)
\pm 0.03
\pm 0.02
(8,0.2\%,0.4\%)
\pm 0.01
\pm 0.02
(16,0.2\%,0.4\%)
\pm 0.03
\pm
(\varepsilon,b_{p},b_{c})
(\varepsilon,b_{p},b_{c})
10
y=+1
y=-1
(
)
(
)
(\varepsilon,b_{p},b_{c})
b_{p}=b_{c}=0.2\%)
S_{\mathrm{cl}}
70\%
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
(\varepsilon,b_{p},b_{c})
30\%
\approx 90\%
\varepsilon
b_{p}
b_{c}
5
5
(\varepsilon,b_{p},b_{c})
50\%
(a)
(a)
(a)
(a)
(b)
(b)
(b)
(b)
(c)
(c)
(c)
(c)
b_{p}
b_{c}
(d)
(d)
(d)
(d)
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\{
\}
f(\cdot;\theta_{\mathrm{clean}})
S_{\mathrm{cl}}
(x_{\mathrm{target}},y_{\mathrm{target}})
y_{\mathrm{adversarial}}
P
\varepsilon
R
M
S_{\mathrm{po}}=\left\{x^{i},y^{i}\right\}_{i=1}^{P}
P
y_{\mathrm{adversarial}}
r=1,\dots R
\Delta
\|\Delta\|_{\infty}\leq\varepsilon
k=1,\dots,M
\phi(\Delta,\theta_{\mathrm{clean}})
S_{\mathrm{po}}
\Delta
\phi
\Gamma
R
\Delta_{*}
\phi(\Delta_{*},\theta_{\mathrm{clean}})
S_{\mathrm{po}}=\left\{x^{i}+\Delta_{*}^{i},y^{i}\right\}_{i=1}^{P}
\ell(f(x,\theta),y)=\max\{0,1-yf(x,\theta)\}
\mathrm{Scikit}
\mathrm{learn}
\ell_{2}
1
b_{p}=b_{c}=0.2\%)
(\varepsilon,b_{p},b_{c})
K=10
k\in\{0,\dots,9\}
S_{\mathrm{cl}}
70\%
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
\ell(f(x,\theta),y)=-\log(\text{Pr}\left(y=f(x,\theta)\right))
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
\varepsilon=16,b_{p}=0.6\%,b_{c}=0.6\%
\varepsilon
b_{p}
b_{c}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
224\times 224
10
(
)
224\times 224
(\varepsilon,b_{p},b_{c})
\gamma=0.9
\Delta
b_{p}=b_{c}=4.2\%
\varepsilon=16
\Delta
b_{p}=b_{c}=4.2\%
\varepsilon=16
\Delta
10000005
b_{p}=b_{c}=6.6\%
\varepsilon=16
\Delta
10000005
b_{p}=b_{c}=6.6\%
\varepsilon=16
\Delta
\varepsilon=8
\Delta
\varepsilon=8
\Delta
\varepsilon=8
b_{p}=0.2,b_{c}=0.4
\Delta
\varepsilon=8
b_{p}=0.2,b_{c}=0.4
\Delta
\varepsilon=16
b_{p}=0.2,b_{c}=0.4
\Delta
\varepsilon=16
b_{p}=0.2,b_{c}=0.4
b_{p}
b_{c}
b_{p}=1\%
b_{c}=\{0.5,1,1.5\}\%
b_{p}
b_{c}
\varepsilon=16
\varepsilon=16
b_{p}
b_{c}
\varepsilon=16
\varepsilon=16
\varepsilon=16
\varepsilon=16
\varepsilon=16,b_{p}=b_{c}=1\%
50\%
50\%
\text{Uniform}(-10,10)
1\leq k\leq 5
2000000000
\varepsilon=16
b_{p}=b_{c}=1\%
2000000000
\varepsilon=16
b_{p}=b_{c}=1\%
\displaystyle\theta_{final}=\theta_{\mathrm{initial}}+\sum_{e=1}^{E}\sum_{b=1}%
^{B}\Delta_{\theta_{e,b}}
\displaystyle\theta_{final}=\theta_{\mathrm{initial}}+\sum_{e=1}^{E}\sum_{b=1}%
^{B}\Delta_{\theta_{e,b}}
\Delta_{\theta_{e,b}}
b
e
SB
\displaystyle\theta_{\mathrm{updated}}=\theta_{\mathrm{initial}}+\sum_{e=1}^{E%
}\sum_{b=1}^{B}\Delta_{\theta_{e,b}}-\sum_{sb=1}^{S}B\Delta_{\theta_{sb}}=%
\theta_{\mathrm{initial}}-\sum_{sb=1}^{S}B\Delta_{\theta_{sb}}.
\displaystyle\theta_{\mathrm{updated}}=\theta_{\mathrm{initial}}+\sum_{e=1}^{E%
}\sum_{b=1}^{B}\Delta_{\theta_{e,b}}-\sum_{sb=1}^{S}B\Delta_{\theta_{sb}}=%
\theta_{\mathrm{initial}}-\sum_{sb=1}^{S}B\Delta_{\theta_{sb}}.
\varepsilon
b_{p}
b_{c}
\pm 0.047
\pm 0.060
\pm 0.046
\pm 0.046
\varepsilon
b_{p}
b_{c}
b_{p}
b_{c}
\ell_{\infty}
\varepsilon=7
\varepsilon
b_{p}
b_{c}
\pm 0.012
\pm 0.021
\pm 0.002
\pm 0.002
