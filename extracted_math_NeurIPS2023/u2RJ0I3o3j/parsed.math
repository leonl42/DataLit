G_{1}
G_{2}
1
1
G_{1}
G_{2}
{G=(V,E,\zeta)}
V
E\subseteq V\times V
\zeta:V\to{\mathbb{C}}
{\mathbb{C}}={\mathbb{R}}^{d}
d
G
G
G
\textsc{BlockCut}(G)
G
G
\textsc{Spqr}(G)
G
\sigma^{G}
G
\textsc{Spqr}(G)
\pi^{G}
G
\sigma_{u}^{G}
G
u
\pi_{u}^{G}
G
u
\Gamma=(V,E,\zeta)
\textsc{root}(\Gamma)
\Gamma
d_{u}
u
u
\chi(u)=\{v|(u,v)\in E,d_{v}=d_{u}+1\}
u
u
k\geq 0
j+1
j
0\leq j\leq k
\Gamma
u
\Gamma
u
u
\Gamma_{u}
\Gamma_{u}
u
u
\Gamma
\Gamma_{u}
{G=(V,E,\zeta)}
{G^{\prime}=(V^{\prime},E^{\prime},\zeta^{\prime})}
f:V\to V^{\prime}
\zeta(u)=\zeta^{\prime}(f(u))
u\in V
(u,v)\in E
(f(u),f(v))\in E^{\prime}
u,v\in V
\xi
{G=(V,E,\zeta)}
\xi(G)
V
G
G^{\prime}
f
G
G^{\prime}
u\in V
\xi(G)(u)=\xi(G^{\prime})(f(u))
\xi
\xi(G)=\xi(G^{\prime})
G
G^{\prime}
\xi
\xi^{\prime}
G
\{\!\{\xi^{\prime}(G)(u)\mid u\in V\}\!\}
\xi
G
G^{\prime}
\xi(G)\neq\xi(G^{\prime})
\xi
G
G^{\prime}
G
G^{\prime}
\xi
{G=(V,E,\zeta)}
u\in V
\zeta(u)={\bm{h}}_{u}^{(0)}
{\bm{h}}^{(\ell)}_{u}
0\leq\ell\leq L
\displaystyle{\bm{h}}_{u}^{(\ell+1)}\coloneqq\phi\left({\bm{h}}_{u}^{(\ell)},%
\psi({\bm{h}}_{u}^{(\ell)},\{\!\!\{{\bm{h}}_{v}^{(\ell)}|~{}v\in N_{u}\}\!\!\}%
)\right),
\displaystyle{\bm{h}}_{u}^{(\ell+1)}\coloneqq\phi\left({\bm{h}}_{u}^{(\ell)},%
\psi({\bm{h}}_{u}^{(\ell)},\{\!\!\{{\bm{h}}_{v}^{(\ell)}|~{}v\in N_{u}\}\!\!\}%
)\right),
\phi
\psi
N_{u}
u
{\bm{z}}^{(L)}
G
{\bm{z}}^{(L)}_{G}
\mathsf{C}^{2}
k
k
k>1
\Sigma\cup{\mathbb{N}}
"("
")"
","
G=(V,E,\zeta)
G
\delta=\textsc{BlockCut}(G)
u\in\delta
G
G
\delta
u
B
\textsc{code}(\delta_{u})=\textsc{BiCode}(B)
u
u
\textsc{code}((\{u\},\{\}))
u
\delta
G
\delta_{\textsc{root}(\delta)}
B
\gamma=\textsc{Spqr}(B)
S
P
Q
R
\gamma
\theta(C,C^{\prime})
C
C^{\prime}\in\chi(C)
C
C^{\prime}
B
P
Q
S
R
T
\omega
\omega[i]
i
\kappa
u=\omega[i]
\kappa[i]=1+|\{\kappa[j]\mid j<i\}|
\omega[i]
u
\kappa[i]=\kappa[\min\{j\mid\omega[i]=\omega[j]\}]
\omega=\langle v_{1},v_{3},v_{2},v_{3},v_{1}\rangle
\kappa=\langle 1,2,3,2,1\rangle
k
\kappa
\textsc{TriCode}(T)=\left(\kappa[1],\textsc{code}((\{\omega[1]\},\{\}))),%
\ldots,(\kappa[k],\textsc{code}((\{\omega[k]\},\{\}))\right)
G=(V,E,\zeta)
{\bm{h}}_{u}^{(0)}=\zeta(u)
u\in V
1\leq\ell\leq L
\widehat{{\bm{h}}}_{C}^{(\ell)}
\sigma^{G}
\widetilde{{\bm{h}}}_{B}^{(\ell)}
B\in\pi^{G}
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}
\delta=\textsc{BlockCut}(G)
u\in V
{\bm{h}}_{u}^{(\ell)}
\displaystyle\widehat{{\bm{h}}}_{C}^{(\ell)}=\textsc{TriEnc}\big{(}C,\{({\bm{h%
}}_{u}^{(\ell-1)},u)|~{}u\in C\}\big{)}
\displaystyle\widehat{{\bm{h}}}_{C}^{(\ell)}
\displaystyle=\textsc{TriEnc}\big{(}C,\{({\bm{h}}_{u}^{(\ell-1)},u)|~{}u\in C%
\}\big{)}
\displaystyle\widetilde{{\bm{h}}}_{B}^{(\ell)}=\textsc{BiEnc}\big{(}B,\{(%
\widehat{{\bm{h}}}_{C}^{(\ell)},C)|~{}C\in\sigma^{B}\}\big{)}
\displaystyle\widetilde{{\bm{h}}}_{B}^{(\ell)}
\displaystyle=\textsc{BiEnc}\big{(}B,\{(\widehat{{\bm{h}}}_{C}^{(\ell)},C)|~{}%
C\in\sigma^{B}\}\big{)}
\displaystyle\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}=\textsc{CutEnc}%
\big{(}\delta_{u},\{({\bm{h}}_{v}^{(\ell-1)},v)|~{}v\in V\},\{(\widetilde{{\bm%
{h}}}_{B}^{(\ell)},B)|~{}B\in\pi^{G}\}\big{)}
\displaystyle\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}
\displaystyle=\textsc{CutEnc}\big{(}\delta_{u},\{({\bm{h}}_{v}^{(\ell-1)},v)|~%
{}v\in V\},\{(\widetilde{{\bm{h}}}_{B}^{(\ell)},B)|~{}B\in\pi^{G}\}\big{)}
\displaystyle{\bm{h}}_{u}^{(\ell)}=\phi\big{(}{\bm{h}}_{u}^{(\ell-1)},\{\!\!\{%
{\bm{h}}_{v}^{(\ell-1)}|~{}v\in N_{u}\}\!\!\},\{\!\!\{{\bm{h}}_{v}^{(\ell-1)}|%
~{}v\in V\}\!\!\},\{\!\!\{\widehat{{\bm{h}}}_{T}^{(\ell)}|~{}T\in\sigma_{u}^{G%
}\}\!\!\},\{\!\!\{\widetilde{{\bm{h}}}_{B}^{(\ell)}|~{}B\in\pi_{u}^{G}\}\!\!\}%
,\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\big{)}
\displaystyle{\bm{h}}_{u}^{(\ell)}
\displaystyle=\phi\big{(}{\bm{h}}_{u}^{(\ell-1)},\{\!\!\{{\bm{h}}_{v}^{(\ell-1%
)}|~{}v\in N_{u}\}\!\!\},\{\!\!\{{\bm{h}}_{v}^{(\ell-1)}|~{}v\in V\}\!\!\},\{%
\!\!\{\widehat{{\bm{h}}}_{T}^{(\ell)}|~{}T\in\sigma_{u}^{G}\}\!\!\},\{\!\!\{%
\widetilde{{\bm{h}}}_{B}^{(\ell)}|~{}B\in\pi_{u}^{G}\}\!\!\},\macc@depth\char 1%
\relax\frozen@everymath{\macc@group}\macc@set@skewchar\macc@nested@a 111{}_{%
\delta_{u}}^{(\ell)}\big{)}
\phi
{\bm{z}}_{G}^{(L)}
C
{\bm{h}}_{u}^{(\ell-1)}
u
C
\omega
\kappa
\displaystyle\widehat{{\bm{h}}}_{C}^{(\ell)}=\textsc{MLP}\left(\sum_{i=1}^{|%
\omega|}\textsc{MLP}\left({\bm{h}}^{(\ell-1)}_{\omega[i]}\|{\bm{p}}_{\kappa[i]%
}\|{\bm{p}}_{i}\right)\right),
\displaystyle\widehat{{\bm{h}}}_{C}^{(\ell)}=\textsc{MLP}\left(\sum_{i=1}^{|%
\omega|}\textsc{MLP}\left({\bm{h}}^{(\ell-1)}_{\omega[i]}\|{\bm{p}}_{\kappa[i]%
}\|{\bm{p}}_{i}\right)\right),
{\bm{p}}_{x}\in\mathbb{R}^{d}
\kappa
\textsc{Spqr}(G)
S
P
Q
R
S
P
Q
R
B
{\bm{h}}_{C}^{(\ell)}
C
\gamma=\textsc{Spqr}(B)
\theta(C,C^{\prime})
C
C^{\prime}\in\chi(C)
\gamma_{C}
C
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{C}}^{(\ell)}=\textsc{MLP}\left(%
\widehat{{\bm{h}}}_{C}^{(\ell)}+\sum_{C^{\prime}\in\chi(C)}\textsc{MLP}\left(%
\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}^{(\ell)}\|{\bm{p}}_{\theta(C,C^{%
\prime})}\right)\right).
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{C}}^{(\ell)}=\textsc{MLP}\left(%
\widehat{{\bm{h}}}_{C}^{(\ell)}+\sum_{C^{\prime}\in\chi(C)}\textsc{MLP}\left(%
\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}^{(\ell)}\|{\bm{p}}_{\theta(C,C^{%
\prime})}\right)\right).
C
\gamma_{C}
\gamma
B
\widetilde{{\bm{h}}}_{B}^{(\ell)}=\widetilde{{\bm{h}}}_{\gamma_{\textsc{root}(%
\gamma)}}^{(\ell)}
\delta_{u}
\delta
\widetilde{{\bm{h}}}_{B}^{(\ell)}
B
{\bm{h}}^{(\ell-1)}_{u}
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}=\mathbf{0}^{d(\ell)}
u
\displaystyle\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}=\textsc{MLP}\left%
({\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\chi(u)}\textsc{MLP}\left(\widetilde{{\bm{h%
}}}_{B}^{(\ell)}+\sum_{v\in\chi(B)}\macc@depth\char 1\relax\frozen@everymath{%
\macc@group}\macc@set@skewchar\macc@nested@a 111{}_{\delta_{v}}^{(\ell)}\right%
)\right).
\displaystyle\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}=\textsc{MLP}\left%
({\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\chi(u)}\textsc{MLP}\left(\widetilde{{\bm{h%
}}}_{B}^{(\ell)}+\sum_{v\in\chi(B)}\macc@depth\char 1\relax\frozen@everymath{%
\macc@group}\macc@set@skewchar\macc@nested@a 111{}_{\delta_{v}}^{(\ell)}\right%
)\right).
{\bm{h}}_{u}^{(\ell)}
u
\displaystyle{\bm{h}}_{u}^{(\ell)}=f^{(\ell)}\Big{(}g_{1}^{(\ell)}\big{(}{\bm{%
h}}_{u}^{(\ell-1)}+\sum_{v\in N_{u}}{\bm{h}}_{v}^{(\ell-1)}\big{)}~{}\|~{}g_{2%
}^{(\ell)}\big{(}\sum_{v\in V}{\bm{h}}_{v}^{(\ell-1)}\big{)}~{}\|
\displaystyle{\bm{h}}_{u}^{(\ell)}=f^{(\ell)}\Big{(}
\displaystyle g_{1}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{v\in N_{u}}{%
\bm{h}}_{v}^{(\ell-1)}\big{)}~{}\|~{}g_{2}^{(\ell)}\big{(}\sum_{v\in V}{\bm{h}%
}_{v}^{(\ell-1)}\big{)}~{}\|
\displaystyle g_{3}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{C\in\sigma_{u%
}^{G}}\widehat{{\bm{h}}}_{C}^{(\ell)}\big{)}~{}~{}\|~{}g_{4}^{(\ell)}\big{(}{%
\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\pi_{u}^{G}}\widetilde{{\bm{h}}}_{B}^{(\ell)}%
\big{)}~{}\|~{}\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\Big{)},
\displaystyle g_{3}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{C\in\sigma_{u%
}^{G}}\widehat{{\bm{h}}}_{C}^{(\ell)}\big{)}~{}~{}\|~{}g_{4}^{(\ell)}\big{(}{%
\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\pi_{u}^{G}}\widetilde{{\bm{h}}}_{B}^{(\ell)}%
\big{)}~{}\|~{}\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\Big{)},
f^{(\ell)}
g_{i}^{(\ell)}
\displaystyle{\bm{z}}_{G}=\textsc{MLP}\left(\big{\|}_{\ell=1}^{L}\Big{(}\sum_{%
u\in V^{G}}{\bm{h}}_{u}^{(\ell)}\Big{)}\right).
\displaystyle{\bm{z}}_{G}=\textsc{MLP}\left(\big{\|}_{\ell=1}^{L}\Big{(}\sum_{%
u\in V^{G}}{\bm{h}}_{u}^{(\ell)}\Big{)}\right).
G_{1}=(V_{1},E_{1},\zeta_{1})
G_{2}=(V_{2},E_{2},\zeta_{2})
L=\lceil\log_{2}(\max\{|V_{1}|,|V_{2}|\})\rceil+1
{\bm{z}}_{G_{1}}^{(L)}\neq{\bm{z}}_{G_{2}}^{(L)}
G_{1}
G_{2}
G=(V,E,\zeta)
B,B^{\prime}
G
C
C^{\prime}
G
\widetilde{{\bm{h}}}_{B}\neq\widetilde{{\bm{h}}}_{B^{\prime}}
B
B^{\prime}
\widehat{{\bm{h}}}_{C}\neq\widehat{{\bm{h}}}_{C^{\prime}}
C
C^{\prime}
G=(V,E,\zeta)
n
\delta=\textsc{BlockCut}(G)
L=\lceil\log_{2}(n)\rceil+1
\delta_{u}
u
\mathcal{O}(|V|d^{2})
\mathcal{O}(|V|^{2})
50.0\mbox{\tiny$\pm 0.00$}
98.0\mbox{\tiny$\pm 1.85$}
\color[rgb]{.5,.5,.5}\mathbf{99.7}\mbox{\tiny$\pm 0.004$}
\mathbf{100}\mbox{\tiny$\pm 0.00$}
\pm 0.00
\mathbf{100}
\pm 0.00
\mathbf{100}
\pm 0.00
11.1\%
\text{QM9}_{\text{CC}}
\text{QM9}_{\text{CC}}
[0.06,0.16]
[0,1]
\text{QM9}_{\text{CC}}
\text{QM9}_{\text{CC}}
\pm 0.0000
\pm 0.0012
\pm 0.0018
\color[rgb]{.5,.5,.5}{\mathbf{0.0038}}
\pm 0.0010
\mathbf{0.0023}\mbox{\tiny$\pm 0.0004$}
\text{QM9}_{\text{CC}}
[0,1]
75.58\mbox{\tiny$\pm 0.97$}
77.07\mbox{\tiny$\pm 1.40$}
79.05\mbox{\tiny$\pm 1.32$}
78.00\mbox{\tiny$\pm 1.42$}
\color[rgb]{.5,.5,.5}{\mathbf{80.39}}\mbox{\tiny$\pm 0.90$}
\mathbf{80.94}\mbox{\tiny$\pm 0.57$}
78.80\mbox{\tiny$\pm 0.82$}
80.04\mbox{\tiny$\pm 0.50$}
k=5
k=10
2.64\mbox{\tiny$\pm 0.11$}
2.54\mbox{\tiny$\pm 0.09$}
2.68\mbox{\tiny$\pm 0.11$}
2.73\mbox{\tiny$\pm 0.07$}
\color[rgb]{.5,.5,.5}{\mathbf{2.16}}\mbox{\tiny$\pm 0.08$}
2.21\mbox{\tiny$\pm 0.21$}
\mathbf{1.97}\mbox{\tiny$\pm 0.03$}
4.67\mbox{\tiny$\pm 0.52$}
2.28\mbox{\tiny$\pm 0.04$}
4.65\mbox{\tiny$\pm 0.44$}
2.32\mbox{\tiny$\pm 0.16$}
1.74\mbox{\tiny$\pm 0.05$}
\color[rgb]{.5,.5,.5}{\mathbf{1.66}}\mbox{\tiny$\pm 0.06$}
\mathbf{1.63}\mbox{\tiny$\pm 0.01$}
1.42\mbox{\tiny$\pm 0.01$}
1.26\mbox{\tiny$\pm 0.02$}
1.48\mbox{\tiny$\pm 0.03$}
1.43\mbox{\tiny$\pm 0.02$}
\color[rgb]{.5,.5,.5}{\mathbf{1.19}}\mbox{\tiny$\pm 0.04$}
1.20\mbox{\tiny$\pm 0.08$}
\mathbf{1.15}\mbox{\tiny$\pm 0.01$}
1.50\mbox{\tiny$\pm 0.09$}
1.34\mbox{\tiny$\pm 0.04$}
1.53\mbox{\tiny$\pm 0.07$}
1.41\mbox{\tiny$\pm 0.03$}
\color[rgb]{.5,.5,.5}{\mathbf{1.13}}\mbox{\tiny$\pm 0.01$}
1.20\mbox{\tiny$\pm 0.06$}
\mathbf{1.06}\mbox{\tiny$\pm 0.02$}
2.27\mbox{\tiny$\pm 0.09$}
1.96\mbox{\tiny$\pm 0.04$}
2.31\mbox{\tiny$\pm 0.06$}
2.08\mbox{\tiny$\pm 0.05$}
\color[rgb]{.5,.5,.5}{\mathbf{1.76}}\mbox{\tiny$\pm 0.03$}
1.77\mbox{\tiny$\pm 0.06$}
\mathbf{1.73}\mbox{\tiny$\pm 0.02$}
15.63\mbox{\tiny$\pm 1.40$}
12.61\mbox{\tiny$\pm 0.37$}
52.39\mbox{\tiny$\pm 42.5$}
15.76\mbox{\tiny$\pm 1.17$}
\color[rgb]{.5,.5,.5}{\mathbf{10.59}}\mbox{\tiny$\pm 0.35$}
10.63\mbox{\tiny$\pm 1.01$}
\mathbf{10.53}\mbox{\tiny$\pm 0.55$}
12.93\mbox{\tiny$\pm 1.81$}
5.03\mbox{\tiny$\pm 0.36$}
14.87\mbox{\tiny$\pm 2.88$}
5.98\mbox{\tiny$\pm 0.43$}
3.16\mbox{\tiny$\pm 0.06$}
\mathbf{2.58}\mbox{\tiny$\pm 0.13$}
\color[rgb]{.5,.5,.5}{\mathbf{2.81}}\mbox{\tiny$\pm 0.16$}
5.88\mbox{\tiny$\pm 1.01$}
2.21\mbox{\tiny$\pm 0.12$}
7.61\mbox{\tiny$\pm 0.46$}
2.19\mbox{\tiny$\pm 0.25$}
1.10\mbox{\tiny$\pm 0.03$}
\mathbf{0.89}\mbox{\tiny$\pm 0.05$}
\color[rgb]{.5,.5,.5}{\mathbf{0.95}}\mbox{\tiny$\pm 0.04$}
18.71\mbox{\tiny$\pm 23.36$}
2.32\mbox{\tiny$\pm 0.18$}
6.86\mbox{\tiny$\pm 0.53$}
2.11\mbox{\tiny$\pm 0.10$}
1.09\mbox{\tiny$\pm 0.05$}
\mathbf{0.93}\mbox{\tiny$\pm 0.03$}
\color[rgb]{.5,.5,.5}{\mathbf{0.94}}\mbox{\tiny$\pm 0.04$}
5.62\mbox{\tiny$\pm 0.81$}
2.26\mbox{\tiny$\pm 0.19$}
7.64\mbox{\tiny$\pm 0.92$}
2.27\mbox{\tiny$\pm 0.29$}
1.10\mbox{\tiny$\pm 0.03$}
\mathbf{0.92}\mbox{\tiny$\pm 0.03$}
\mathbf{0.92}\mbox{\tiny$\pm 0.04$}
5.38\mbox{\tiny$\pm 0.75$}
2.04\mbox{\tiny$\pm 0.24$}
6.54\mbox{\tiny$\pm 0.36$}
2.07\mbox{\tiny$\pm 0.07$}
1.04\mbox{\tiny$\pm 0.04$}
\mathbf{0.83}\mbox{\tiny$\pm 0.05$}
\color[rgb]{.5,.5,.5}{\mathbf{0.88}}\mbox{\tiny$\pm 0.04$}
3.53\mbox{\tiny$\pm 0.37$}
1.86\mbox{\tiny$\pm 0.03$}
4.11\mbox{\tiny$\pm 0.27$}
2.03\mbox{\tiny$\pm 0.14$}
1.34\mbox{\tiny$\pm 0.03$}
\color[rgb]{.5,.5,.5}{\mathbf{1.23}}\mbox{\tiny$\pm 0.06$}
\mathbf{1.20}\mbox{\tiny$\pm 0.06$}
1.05\mbox{\tiny$\pm 0.11$}
0.80\mbox{\tiny$\pm 0.04$}
1.48\mbox{\tiny$\pm 0.87$}
0.73\mbox{\tiny$\pm 0.04$}
0.53\mbox{\tiny$\pm 0.02$}
\color[rgb]{.5,.5,.5}{\mathbf{0.52}}\mbox{\tiny$\pm 0.02$}
\mathbf{0.45}\mbox{\tiny$\pm 0.01$}
0.278\mbox{\tiny$\pm 0.003$}
0.387\mbox{\tiny$\pm 0.015$}
0.252\mbox{\tiny$\pm 0.014$}
0.088\mbox{\tiny$\pm 0.002$}
0.320\mbox{\tiny$\pm 0.032$}
0.188\mbox{\tiny$\pm 0.004$}
0.320\mbox{\tiny$\pm 0.032$}
0.140\mbox{\tiny$\pm 0.006$}
0.101\mbox{\tiny$\pm 0.010$}
\mathbf{0.115}\mbox{\tiny$\pm 0.003$}
\color[rgb]{.5,.5,.5}{\mathbf{0.079}}\mbox{\tiny$\pm 0.006$}
\mathbf{0.022}\mbox{\tiny$\pm 0.002$}
0.102\mbox{\tiny$\pm 0.003$}
0.151\mbox{\tiny$\pm 0.006$}
0.036\mbox{\tiny$\pm 0.002$}
\color[rgb]{.5,.5,.5}{\mathbf{0.124}}\mbox{\tiny$\pm 0.004$}
\mathbf{0.076}\mbox{\tiny$\pm 0.003$}
\color[rgb]{.5,.5,.5}{\mathbf{0.028}}\mbox{\tiny$\pm 0.002$}
K\subseteq{\mathbb{R}}^{d}
d\in{\mathbb{N}}^{+}
S
x\in S
\Psi(S,x):S\to\{1,\ldots,|S|\}
x
S
S
g:{\mathbb{P}}(S)\to[0,1]
M\subseteq S
\displaystyle g(M)=\frac{1}{1+\sum_{x\in M}\Psi(S,x)|S|^{\Psi(M,x)}},
\displaystyle g(M)=\frac{1}{1+\sum_{x\in M}\Psi(S,x)|S|^{\Psi(M,x)}},
g(M_{1})\neq g(M_{2})
M_{1}\neq M_{2}\subseteq S
G=(V,E,\zeta)
B,B^{\prime}
G
C
C^{\prime}
G
\widetilde{{\bm{h}}}_{B}\neq\widetilde{{\bm{h}}}_{B^{\prime}}
B
B^{\prime}
\widehat{{\bm{h}}}_{C}\neq\widehat{{\bm{h}}}_{C^{\prime}}
C
C^{\prime}
{\bm{h}}_{u}
{\bm{h}}_{u}=\zeta(u)
\zeta:V\to{\mathbb{R}}^{d}
C
{\bm{h}}_{u}
u
C
\omega
\kappa
\displaystyle\widehat{{\bm{h}}}_{C}=\textsc{MLP}\left(\sum_{i=1}^{|\omega|}%
\textsc{MLP}\left({\bm{h}}_{\omega[i]}\|{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i}%
\right)\right).
\displaystyle\widehat{{\bm{h}}}_{C}=\textsc{MLP}\left(\sum_{i=1}^{|\omega|}%
\textsc{MLP}\left({\bm{h}}_{\omega[i]}\|{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i}%
\right)\right).
\omega
n=4(|V|+|E|+1)
\omega
\kappa
\mathcal{F}
\mathcal{M}
G
\bullet
\mathcal{F}=\{\!\!\{\textsc{code}(C)\mid C\in\sigma^{G}\}\!\!\}
G
\bullet
\mathcal{M}=\{\!\!\{\widehat{{\bm{h}}}_{C}\mid C\in\sigma^{G}\}\!\!\}
G
\rho
\mathcal{F}
\mathcal{M}
C
\rho(\widehat{{\bm{h}}}_{C})=\textsc{code}(C)\text{ and }\rho^{-1}(\textsc{%
code}(C))=\widehat{{\bm{h}}}_{C}.
\rho
\displaystyle\widehat{{\bm{h}}}_{C}\neq\widehat{{\bm{h}}}_{C^{\prime}}
\displaystyle\widehat{{\bm{h}}}_{C}
\displaystyle\neq\widehat{{\bm{h}}}_{C^{\prime}}
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle\rho^{-1}(\textsc{code}(C))\neq\rho^{-1}(\textsc{code}(C^{\prime}))
\displaystyle\rho^{-1}(\textsc{code}(C))
\displaystyle\neq\rho^{-1}(\textsc{code}(C^{\prime}))
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle\textsc{code}(C)\neq\textsc{code}(C^{\prime})
\displaystyle\textsc{code}(C)
\displaystyle\neq\textsc{code}(C^{\prime})
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle C\emph{ and }C^{\prime}\emph{ are non-isomorphic}.
\displaystyle C\emph{ and }C^{\prime}
\displaystyle\emph{ are non-isomorphic}.
C
\displaystyle\textsc{code}(C)=\textsc{TriCode}(C)=\left(\kappa[1],\textsc{code%
}((\{\omega[1]\},\{\}))),\ldots,(\kappa[k],\textsc{code}((\{\omega[k]\},\{\}))\right)
\displaystyle\textsc{code}(C)=\textsc{TriCode}(C)=
\displaystyle\left(\kappa[1],\textsc{code}((\{\omega[1]\},\{\}))),\ldots,(%
\kappa[k],\textsc{code}((\{\omega[k]\},\{\}))\right)
\displaystyle=\left(\kappa[1],\zeta(\omega[1])),\ldots,(\kappa[k],\zeta(\omega%
[k])\right).
\displaystyle=
\displaystyle\left(\kappa[1],\zeta(\omega[1])),\ldots,(\kappa[k],\zeta(\omega[%
k])\right).
\displaystyle S_{C}=\left\{\left(\zeta(\omega[i]),\kappa[i],i\right)\mid 1\leq
i%
\leq|\omega|\right\},
\displaystyle S_{C}=\left\{\left(\zeta(\omega[i]),\kappa[i],i\right)\mid 1\leq
i%
\leq|\omega|\right\},
C
S_{C}
C
\textsc{code}(C)
C
g
[0,1]
g
\displaystyle g(S_{C})=\phi\left(\sum_{x\in S_{C}}f(x)\right),
\displaystyle g(S_{C})=\phi\left(\sum_{x\in S_{C}}f(x)\right),
\phi:{\mathbb{R}}^{d^{\prime}}\rightarrow[0,1]
f(x)\in{\mathbb{R}}^{d^{\prime}}
S_{C}
\displaystyle g(S_{C})=\phi\left(\sum_{i=1}^{|\omega|}f\left(\left(\zeta(%
\omega[i]),\kappa[i],i\right)\right)\right).
\displaystyle g(S_{C})=\phi\left(\sum_{i=1}^{|\omega|}f\left(\left(\zeta(%
\omega[i]),\kappa[i],i\right)\right)\right).
\omega
i
\zeta(\omega[i])={\bm{h}}_{\omega[i]}
{\bm{p}}_{\kappa[i]}
{\bm{p}}_{i}
\kappa[i]
i
\mu
i
\displaystyle((\zeta(\omega[i])),\kappa[i],i)=\mu({\bm{h}}_{\omega[i]}\|{\bm{p%
}}_{\kappa[i]}\|{\bm{p}}_{i}).
\displaystyle((\zeta(\omega[i])),\kappa[i],i)=\mu({\bm{h}}_{\omega[i]}\|{\bm{p%
}}_{\kappa[i]}\|{\bm{p}}_{i}).
\displaystyle g(S_{C})=\phi\left(\sum_{i=1}^{|\omega|}f\left(\left(\zeta(%
\omega[i]),\kappa[i],i\right)\right)\right)
\displaystyle g(S_{C})
\displaystyle=\phi\left(\sum_{i=1}^{|\omega|}f\left(\left(\zeta(\omega[i]),%
\kappa[i],i\right)\right)\right)
\displaystyle=\phi\left(\sum_{i=1}^{|\omega|}f\left(\mu({\bm{h}}_{\omega[i]}\|%
{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i})\right)\right)
\displaystyle=\phi\left(\sum_{i=1}^{|\omega|}f\left(\mu({\bm{h}}_{\omega[i]}\|%
{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i})\right)\right)
\displaystyle=\phi\left(\sum_{i=1}^{|\omega|}(f\circ\mu)({\bm{h}}_{\omega[i]}%
\|{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i})\right).
\displaystyle=\phi\left(\sum_{i=1}^{|\omega|}(f\circ\mu)({\bm{h}}_{\omega[i]}%
\|{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i})\right).
(f\circ\mu)
\phi
\rho
\mathcal{F}
\mathcal{M}
C
\textsc{code}(C)
S_{C}
\widehat{{\bm{h}}}_{C}
g
\widehat{{\bm{h}}}_{C}=g(S_{C})
g
B
\widehat{{\bm{h}}}_{C}
C
\gamma=\textsc{Spqr}(B)
\widehat{{\bm{h}}}_{C}
\theta(C,C^{\prime})
C
C^{\prime}\in\chi(C)
\gamma_{C}
C
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{C}}=\textsc{MLP}\left(\widehat{{\bm%
{h}}}_{C}+\sum_{C^{\prime}\in\chi(C)}\textsc{MLP}\left(\widetilde{{\bm{h}}}_{%
\gamma_{C^{\prime}}}\|{\bm{p}}_{\theta(C,C^{\prime})}\right)\right).
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{C}}=\textsc{MLP}\left(\widehat{{\bm%
{h}}}_{C}+\sum_{C^{\prime}\in\chi(C)}\textsc{MLP}\left(\widetilde{{\bm{h}}}_{%
\gamma_{C^{\prime}}}\|{\bm{p}}_{\theta(C,C^{\prime})}\right)\right).
C
\gamma_{C}
\gamma
B
\widetilde{{\bm{h}}}_{B}=\widetilde{{\bm{h}}}_{\gamma_{\textsc{root}(\gamma)}}
\gamma
C
\gamma
\gamma_{C}
\textsc{code}(\gamma_{C})=\textsc{TriCode}(C)
C
C
\theta
C
\textsc{code}(\gamma_{C})
\chi(u)
\textsc{code}(\gamma_{C^{\prime}})
C^{\prime}\in\chi(C)
x[1],\dots,x[|\chi(C)|]
\gamma_{C}
\displaystyle\textsc{code}(\gamma_{C})=\left(\textsc{TriCode}(C),(\theta(C,x[1%
]),\textsc{code}(\gamma_{x[1]})),\ldots,(\theta(C,x[|x|]),\textsc{code}(\gamma%
_{x[|x|]})))\right)
\displaystyle\textsc{code}(\gamma_{C})=\left(\textsc{TriCode}(C),(\theta(C,x[1%
]),\textsc{code}(\gamma_{x[1]})),\ldots,(\theta(C,x[|x|]),\textsc{code}(\gamma%
_{x[|x|]})))\right)
\mathcal{F}
\mathcal{M}
G
\gamma
\bullet
\mathcal{F}=\{\!\!\{\textsc{code}(\gamma_{C})\mid C\in\gamma\}\!\!\}
\bullet
\mathcal{M}=\{\!\!\{\widetilde{{\bm{h}}}_{\gamma_{C}}\mid C\in\gamma\}\!\!\}
\rho
\mathcal{F}
\mathcal{M}
C
\gamma
\rho(\widetilde{{\bm{h}}}_{\gamma_{C}})=\textsc{code}(\gamma_{C})\emph{ and }%
\rho^{-1}(\textsc{code}(\gamma_{C}))=\widetilde{{\bm{h}}}_{\gamma_{C}}
\rho
\displaystyle\widetilde{{\bm{h}}}_{B}\neq\widetilde{{\bm{h}}}_{B^{\prime}}
\displaystyle\widetilde{{\bm{h}}}_{B}
\displaystyle\neq\widetilde{{\bm{h}}}_{B^{\prime}}
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{\textsc{root}}(B)}\neq\widetilde{{%
\bm{h}}}_{\gamma_{\textsc{root}}(B^{\prime})}
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{\textsc{root}}(B)}
\displaystyle\neq\widetilde{{\bm{h}}}_{\gamma_{\textsc{root}}(B^{\prime})}
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle\rho^{-1}(\textsc{code}(\textsc{root}(B)))\neq\rho^{-1}(\textsc{%
code}(\textsc{root}(B^{\prime})))
\displaystyle\rho^{-1}(\textsc{code}(\textsc{root}(B)))
\displaystyle\neq\rho^{-1}(\textsc{code}(\textsc{root}(B^{\prime})))
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle\textsc{code}(\textsc{root}(B))\neq\textsc{code}(\textsc{root}(B^%
{\prime}))
\displaystyle\textsc{code}(\textsc{root}(B))
\displaystyle\neq\textsc{code}(\textsc{root}(B^{\prime}))
\displaystyle\Leftrightarrow
\displaystyle\Leftrightarrow
\displaystyle B\emph{ and }B^{\prime}\emph{ are non-isomorphic}.
\displaystyle B\emph{ and }B^{\prime}
\displaystyle\emph{ are non-isomorphic}.
\textsc{code}(\gamma_{C})
C
\gamma
\displaystyle S_{C}=\{\!\!\{\left\{\textsc{TriCode}(C)\right\}\}\!\!\}\cup%
\left\{\!\!\{(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}}))\mid C^{%
\prime}\in\chi(C)\}\!\!\right\}
\displaystyle S_{C}=\{\!\!\{\left\{\textsc{TriCode}(C)\right\}\}\!\!\}\cup%
\left\{\!\!\{(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}}))\mid C^{%
\prime}\in\chi(C)\}\!\!\right\}
g
[0,1]
g
\displaystyle g(S_{C})=\phi\left(\sum_{x\in S}f(x)\right),
\displaystyle g(S_{C})=\phi\left(\sum_{x\in S}f(x)\right),
\phi:{\mathbb{R}}^{d^{\prime}}\rightarrow[0,1]
f(x)\in{\mathbb{R}}^{d^{\prime}}
S_{C}
\displaystyle g(S_{C})=\phi\left(f(\textsc{TriCode}(C))+\sum_{C^{\prime}\in%
\chi(C)}f\left(\left(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}})%
\right)\right)\right).
\displaystyle g(S_{C})=\phi\left(f(\textsc{TriCode}(C))+\sum_{C^{\prime}\in%
\chi(C)}f\left(\left(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}})%
\right)\right)\right).
C^{\prime}\in\chi(C)
\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}
\textsc{code}(\gamma_{C})
{\bm{p}}_{\theta(C,C^{\prime})}
\theta(C,C^{\prime})
\mu
\displaystyle(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}}))=\mu({%
\bm{p}}_{\theta(C,C^{\prime})}\|\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}),
\displaystyle(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}}))=\mu({%
\bm{p}}_{\theta(C,C^{\prime})}\|\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}),
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}=\textsc{code}(\gamma_{%
C^{\prime}})\text{ for any }C^{\prime}\in\chi(C).
\displaystyle\widetilde{{\bm{h}}}_{\gamma_{C^{\prime}}}=\textsc{code}(\gamma_{%
C^{\prime}})\text{ for any }C^{\prime}\in\chi(C).
\mu
C
g
f^{\prime}(x)\in{\mathbb{R}}^{d^{\prime}}
\displaystyle g(S_{C})=\phi\left(f(\{\textsc{TriCode}(C)\})+\sum_{C^{\prime}%
\in\chi(C)}f\left(\left(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}}%
)\right)\right)\right)
\displaystyle g(S_{C})
\displaystyle=\phi\left(f(\{\textsc{TriCode}(C)\})+\sum_{C^{\prime}\in\chi(C)}%
f\left(\left(\theta(C,C^{\prime}),\textsc{code}(\gamma_{C^{\prime}})\right)%
\right)\right)
\displaystyle=\phi\left(\widehat{{\bm{h}}}_{C}+\sum_{C^{\prime}\in\chi(C)}f^{%
\prime}\left(\mu\left({\bm{p}}_{\theta(C,C^{\prime})}\|\widetilde{{\bm{h}}}_{%
\gamma_{C^{\prime}}}\right)\right)\right)
\displaystyle=\phi\left(\widehat{{\bm{h}}}_{C}+\sum_{C^{\prime}\in\chi(C)}f^{%
\prime}\left(\mu\left({\bm{p}}_{\theta(C,C^{\prime})}\|\widetilde{{\bm{h}}}_{%
\gamma_{C^{\prime}}}\right)\right)\right)
\displaystyle=\phi\left(\widehat{{\bm{h}}}_{C}+\sum_{C^{\prime}\in\chi(C)}(f^{%
\prime}\circ\mu)\left({\bm{p}}_{\theta(C,C^{\prime})}\|\widetilde{{\bm{h}}}_{%
\gamma_{C^{\prime}}}\right)\right).
\displaystyle=\phi\left(\widehat{{\bm{h}}}_{C}+\sum_{C^{\prime}\in\chi(C)}(f^{%
\prime}\circ\mu)\left({\bm{p}}_{\theta(C,C^{\prime})}\|\widetilde{{\bm{h}}}_{%
\gamma_{C^{\prime}}}\right)\right).
f(\textsc{TriCode}(C))
f
(f^{\prime}\circ\mu)
\phi
\rho
\mathcal{F}
\mathcal{M}
C
\gamma
\rho(\widetilde{{\bm{h}}}_{\gamma_{C}})=\textsc{code}(\gamma_{C})\emph{ and }%
\rho^{-1}(\textsc{code}(\gamma_{C}))=\widetilde{{\bm{h}}}_{\gamma_{C}}.
\gamma
C
\widetilde{{\bm{h}}}_{\gamma_{C}}=\phi(\widehat{{\bm{h}}}_{C})
\textsc{code}(\gamma_{C})=\{\textsc{TriCode}(C)\}
C
g
C
\gamma
G=(V,E,\zeta)
n
\delta=\textsc{BlockCut}(G)
L=\lceil\log_{2}(n)\rceil+1
\delta_{u}
u
\delta_{u}
u
\delta=\textsc{BlockCut}(G)
u
B
u
\chi(u)
B
\chi(B)
\displaystyle{\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}}_{\delta_{u}}^{(\ell)}=\textsc{MLP}%
\left({\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\chi(u)}\textsc{MLP}\left(\widetilde{{%
\bm{h}}}_{B}^{(\ell)}+\sum_{v\in\chi(B)}{\macc@depth\char 1\relax%
\frozen@everymath{\macc@group}\macc@set@skewchar\macc@nested@a 111{}}_{\delta_%
{v}}^{(\ell)}\right)\right).
\displaystyle{\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}}_{\delta_{u}}^{(\ell)}=\textsc{MLP}%
\left({\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\chi(u)}\textsc{MLP}\left(\widetilde{{%
\bm{h}}}_{B}^{(\ell)}+\sum_{v\in\chi(B)}{\macc@depth\char 1\relax%
\frozen@everymath{\macc@group}\macc@set@skewchar\macc@nested@a 111{}}_{\delta_%
{v}}^{(\ell)}\right)\right).
\delta
B
\delta
\delta_{B}
\textsc{code}(\delta_{B})=\textsc{BiCode}(B)
\delta
B
\delta
\textsc{code}(\{\{u\},\{\}\}):=\textsc{code}(\delta_{u})
u\in\chi(B)
\textsc{code}(\delta_{B})=\textsc{BiCode}(B)
u
\delta
u
\chi(u)
\textsc{code}(\delta_{B})
B\in\chi(u)
x[1],\dots,x[|\chi(u)|]
\delta_{u}
\displaystyle\textsc{code}(\delta_{u})=\left(\textsc{code}(\delta_{x[1]})),%
\ldots,\textsc{code}(\delta_{x[|x|]})\right)
\displaystyle\textsc{code}(\delta_{u})=\left(\textsc{code}(\delta_{x[1]})),%
\ldots,\textsc{code}(\delta_{x[|x|]})\right)
n
u
{\bm{h}}_{u}^{L}
\delta_{u}
\lambda
\lambda(\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(L)})=\textsc{code}(%
\delta_{u})\emph{ and }\lambda^{-1}(\textsc{code}(\delta_{u}^{(L)}))=%
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(L)}
u
L
\delta_{u}
\rho
\rho({\bm{h}}_{u}^{(L)})=\textsc{code}(\delta_{u})\emph{ and }\rho^{-1}(%
\textsc{code}(\delta_{u}^{(L)}))={\bm{h}}_{u}^{(L)}
u
L
\delta_{u}
\delta_{u}
u
\displaystyle{\bm{h}}_{u}^{(\ell)}=f^{(\ell)}\Big{(}g_{1}^{(\ell)}\big{(}{\bm{%
h}}_{u}^{(\ell-1)}+\sum_{v\in N_{u}}{\bm{h}}_{v}^{(\ell-1)}\big{)}~{}\|~{}g_{2%
}^{(\ell)}\big{(}\sum_{v\in V}{\bm{h}}_{v}^{(\ell-1)}\big{)}~{}\|
\displaystyle{\bm{h}}_{u}^{(\ell)}=f^{(\ell)}\Big{(}
\displaystyle g_{1}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{v\in N_{u}}{%
\bm{h}}_{v}^{(\ell-1)}\big{)}~{}\|~{}g_{2}^{(\ell)}\big{(}\sum_{v\in V}{\bm{h}%
}_{v}^{(\ell-1)}\big{)}~{}\|
\displaystyle g_{3}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{C\in\sigma_{u%
}^{G}}\widehat{{\bm{h}}}_{C}^{(\ell)}\big{)}~{}~{}\|~{}g_{4}^{(\ell)}\big{(}{%
\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\pi_{u}^{G}}\widetilde{{\bm{h}}}_{B}^{(\ell)}%
\big{)}~{}\|~{}\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\Big{)},
\displaystyle g_{3}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{C\in\sigma_{u%
}^{G}}\widehat{{\bm{h}}}_{C}^{(\ell)}\big{)}~{}~{}\|~{}g_{4}^{(\ell)}\big{(}{%
\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\pi_{u}^{G}}\widetilde{{\bm{h}}}_{B}^{(\ell)}%
\big{)}~{}\|~{}\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\Big{)},
L
L=1
1
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(1)}
u
\delta_{u}
{\bm{h}}_{u}^{(\ell)}
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(1)}
L>1
(L-1)
L
L
u
{\bm{h}}_{u}^{(L-1)}
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(L)}
{\bm{h}}_{u}^{(L-1)}
{\bm{h}}_{u}^{(L)}
\delta_{u}
u
\delta_{u}
L
\{\!\!\{(\widetilde{{\bm{h}}}_{B},\{\!\!\{{\bm{h}}_{v}|v\in\chi(B)\}\!\!\})~{}%
|~{}B\in\chi(u)\}\!\!\}
v\in\chi^{2}(u)
(L-1)
L
\textsc{BiCode}(B)
B\in\chi(u)
u
B\in\chi(u)
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(L)}
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(L)}
L=O(n)
\lceil\log_{2}(n)\rceil+1
u
\delta_{u}
u
{\bm{h}}_{u}^{(L)}
\delta_{u}
\lambda
\lambda(\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(L)})=\textsc{code}(%
\delta_{u})\emph{ and }\lambda^{-1}(\textsc{code}(\delta_{u}^{(L)}))=%
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}^{(L)}
u
2^{(L-1)}
\delta_{u}
\rho
\rho({\bm{h}}_{u}^{(L)})=\textsc{code}(\delta_{u})\emph{ and }\rho^{-1}(%
\textsc{code}(\delta_{u}^{(L)}))={\bm{h}}_{u}^{(L)}
u
2^{(L-1)}
\delta_{u}
L=1
2^{(L-1)}=2^{0}=L
L>1
(L-1)
L
L
u
2^{(L-1)}
\delta_{u}
u=v_{0}
v_{1}\in\chi^{2}(u)
2^{(L-1)}
v_{2}\in\chi^{2}(v_{1})
u=v_{0},v_{1},\dots,v_{k}
v_{i+1}
v_{i}
0\leq i<k
u=v_{0},v_{1},\dots,v_{k}
(L-1)
v_{0},...,v_{k}
v_{k}
u=v_{0}
v_{k}
v_{i}
v_{i+1}
v_{i+1}
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{v_{i+1}}}^{(L)}
v_{i}
u
\lceil\log_{2}(n)\rceil+1
G_{1}=(V_{1},E_{1},\zeta_{1})
G_{2}=(V_{2},E_{2},\zeta_{2})
L=\lceil\log_{2}(\max\{|V_{1}|,|V_{2}|\})\rceil+1
{\bm{z}}_{G_{1}}^{(L)}\neq{\bm{z}}_{G_{2}}^{(L)}
G_{1}
G_{2}
{\bm{z}}_{G_{1}}^{(L)}\neq{\bm{z}}_{G_{2}}^{(L)}
G_{1}
G_{2}
\textsc{root}(\delta_{1})
\textsc{root}(\delta_{2})
\displaystyle{\bm{z}}_{G}^{(L)}=\textsc{MLP}\left(\sum_{u\in V^{G}}\textsc{MLP%
}({\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}}^{(L)}_{\delta_{u}})\right).
\displaystyle{\bm{z}}_{G}^{(L)}=\textsc{MLP}\left(\sum_{u\in V^{G}}\textsc{MLP%
}({\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}}^{(L)}_{\delta_{u}})\right).
\textsc{Cut}(G)=\{\!\!\{\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(L)}|~{}u\in V^{G}\}\!\!\}
\textsc{Cut}(G)
|V_{\delta_{1}}|\leq|V_{\delta_{2}}|
\textsc{root}(\delta_{2})
\delta_{2}
{\bm{h}}_{\textsc{root}(\delta_{2})}
L
\delta_{2}
\delta_{1}
{\bm{h}}_{\textsc{root}(\delta_{2})}\notin\textsc{Cut}(G_{1})
\textsc{Cut}(G_{1})\neq\textsc{Cut}(G_{2})
\textsc{Cut}(G)
{\bm{z}}_{G_{1}}^{(L)}\neq{\bm{z}}_{G_{2}}^{(L)}
\textsc{root}(\delta_{1})
\textsc{root}(\delta_{2})
\displaystyle{\bm{z}}_{G}=\textsc{MLP}\left(\sum_{u\in V^{G}}\textsc{MLP}(\big%
{(}{\bm{h}}_{u}^{(L-1)}+\sum_{B\in\pi_{u}^{G}}\widetilde{{\bm{h}}}_{B}^{(L)}%
\big{)})\right).
\displaystyle{\bm{z}}_{G}=\textsc{MLP}\left(\sum_{u\in V^{G}}\textsc{MLP}(\big%
{(}{\bm{h}}_{u}^{(L-1)}+\sum_{B\in\pi_{u}^{G}}\widetilde{{\bm{h}}}_{B}^{(L)}%
\big{)})\right).
\textsc{Bc}(G)=\{({\bm{h}}_{u}^{(L-1)},\{\!\!\{\widetilde{{\bm{h}}}_{B}^{(L)}~%
{}|~{}B\in\pi_{u}^{G}\}\!\!\})|~{}u\in V^{G}\}
\widetilde{{\bm{h}}}_{B}^{(L)}
B
\textsc{Bc}(G_{1})\neq\textsc{Bc}(G_{2})
|V_{\delta_{1}}|\leq|V_{\delta_{2}}|
{\bm{h}}_{\textsc{root}(\delta_{2})}
G_{2}
u
({\bm{h}}_{u}^{(L-1)},\{\!\!\{\widetilde{{\bm{h}}}_{B}^{(L)}~{}|~{}B\in\pi_{u}%
^{G}\}\!\!\})\in\textsc{Bc}(G_{2}),
{\bm{h}}_{\textsc{root}(\delta_{2})}\in\{\!\!\{\widetilde{{\bm{h}}}_{B}^{(L)}~%
{}|~{}B\in\pi_{u}^{G}\}\!\!\}
{\bm{h}}_{\textsc{root}(\delta_{2})}
\delta_{2}
\delta_{2}
\delta_{1}
\textsc{Bc}(G_{1})
\textsc{Bc}(G_{1})\neq\textsc{Bc}(G_{2})
{\bm{z}}_{G_{1}}^{(L)}\neq{\bm{z}}_{G_{2}}^{(L)}
\textsc{root}(\delta_{1})
\textsc{root}(\delta_{2})
G_{1}
G_{2}
\textsc{root}(\delta_{1})
\pi_{u}^{G}
u
\chi^{\delta}(C)
\delta
\textsc{root}(\delta_{1})
|\pi_{u}^{G_{1}}|=|\chi^{\delta_{1}}(u)|
u
\delta_{1}
\delta_{2}
|\pi_{u}^{G}|=|\chi^{\delta}(u)|+1
v
u
v\in\pi_{u}^{G_{1}}
v\notin\chi^{\delta}(u)
[1,0]^{\top}
[0,|\chi_{u}|]^{\top}
u
[|\pi_{u}^{G}|-|\chi^{\delta}(u)|-1,0]^{\top}
\textsc{root}(\delta_{1})
{\bm{h}}_{\textsc{root}(\delta_{u})}=[-1,0]^{\top}
u
{\bm{h}}_{u}=[0,0]^{\top}
u
{\bm{h}}_{u}=[0,0]^{\top}
|\pi_{u}^{G}|=1
\macc@depth\char 1\relax\frozen@everymath{\macc@group}\macc@set@skewchar%
\macc@nested@a 111{}_{\delta_{u}}=[0,0]^{\top}
{\bm{z}}_{G_{1}}=[-1,0]^{\top}
{\bm{z}}_{G_{2}}=[0,0]^{\top}
{\bm{z}}_{G_{1}}^{(L)}\neq{\bm{z}}_{G_{2}}^{(L)}
G=(V,E,\zeta)
O(|V|^{2})
G
|V|
G
|\pi^{G}|
|V|-1
G
2|V|-2
B
B
2|V|-2
2|V|-2
2|V|-2
e_{C}
V
|E|\leq 3|V|-6
2|V|-2
O(V)
O(e_{C}\cdot d)=O(|V|d^{2})
d
O(e_{C}d)
O(|\sigma^{G}|d^{2})
O((e_{c}+|\sigma^{G}|)d^{2})=O(|V|d^{2})
O(|\sigma^{G}|d^{2})=O(|V|d^{2})
O(|V|d^{2})
O(|E|d)
O(|V|d^{2})
O(|V|d)
O(|V|d)
2|V|-2
O(|V|)
O(|V|d^{2})
O(|V|d^{2})
d^{2}
O(|V|^{2})
\bm{0.076}\pm
\color[rgb]{.5,.5,.5}{\mathbf{0.079}}\pm
\color[rgb]{.5,.5,.5}{\mathbf{0.079}}\pm
\pm
\pm
\pm
\bullet
0.003
\bullet
0.003
\bullet
0.023
\bullet
0.021
\bullet
0.016
\text{QM9}_{\text{CC}}
\displaystyle\widehat{{\bm{h}}}_{C}^{(\ell)}=\textsc{MLP}\Big{(}\sum_{i=1}^{|%
\omega|}\textsc{MLP}({\bm{h}}^{(\ell-1)}_{\omega[i]}\|\hat{{\bm{h}}}^{(\ell-1)%
}_{\omega[i],\omega[(i+1)\%|w|]}\|{\bm{p}}_{\kappa[i]}\|{\bm{p}}_{i}))\Big{)},%
\text{ and}
\displaystyle\widehat{{\bm{h}}}_{C}^{(\ell)}=\textsc{MLP}
\displaystyle\Big{(}\sum_{i=1}^{|\omega|}\textsc{MLP}({\bm{h}}^{(\ell-1)}_{%
\omega[i]}\|\hat{{\bm{h}}}^{(\ell-1)}_{\omega[i],\omega[(i+1)\%|w|]}\|{\bm{p}}%
_{\kappa[i]}\|{\bm{p}}_{i}))\Big{)},\text{ and}
\displaystyle{\bm{h}}_{u}^{(\ell)}=f^{(\ell)}\Big{(}g_{1}^{(\ell)}\big{(}{\bm{%
h}}_{u}^{(\ell-1)}+\sum_{v\in N_{u}}g_{5}^{(\ell)}({\bm{h}}_{v}^{(\ell-1)}\|{%
\bm{h}}_{v,u}^{(\ell-1)})\big{)}~{}\|~{}g_{2}^{(\ell)}\big{(}\sum_{v\in V}{\bm%
{h}}_{v}^{(\ell-1)}\big{)}
\displaystyle{\bm{h}}_{u}^{(\ell)}=f^{(\ell)}\Big{(}
\displaystyle g_{1}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{v\in N_{u}}g_%
{5}^{(\ell)}({\bm{h}}_{v}^{(\ell-1)}\|{\bm{h}}_{v,u}^{(\ell-1)})\big{)}~{}\|~{%
}g_{2}^{(\ell)}\big{(}\sum_{v\in V}{\bm{h}}_{v}^{(\ell-1)}\big{)}
\displaystyle g_{3}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\pi_{u}^{%
G}}\widetilde{{\bm{h}}}_{B}^{(\ell)}\big{)}~{}\|~{}g_{4}^{(\ell)}\big{(}{\bm{h%
}}_{u}^{(\ell-1)}+\sum_{C\in\sigma_{u}^{G}}\widehat{{\bm{h}}}_{C}^{(\ell)}\big%
{)}~{}~{}\|~{}\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\Big{)},
\displaystyle g_{3}^{(\ell)}\big{(}{\bm{h}}_{u}^{(\ell-1)}+\sum_{B\in\pi_{u}^{%
G}}\widetilde{{\bm{h}}}_{B}^{(\ell)}\big{)}~{}\|~{}g_{4}^{(\ell)}\big{(}{\bm{h%
}}_{u}^{(\ell-1)}+\sum_{C\in\sigma_{u}^{G}}\widehat{{\bm{h}}}_{C}^{(\ell)}\big%
{)}~{}~{}\|~{}\macc@depth\char 1\relax\frozen@everymath{\macc@group}%
\macc@set@skewchar\macc@nested@a 111{}_{\delta_{u}}^{(\ell)}\Big{)},
\hat{{\bm{h}}}_{i,j}={\bm{h}}_{i,j}
(i,j)\in E
\mathbf{1}^{d}
\text{QM9}_{\text{CC}}
\text{QM9}_{\text{CC}}
10^{-3}
10^{-3}
\{10^{-3};10^{-4}\}
\{2,3\}
\{0,0.25,0.5,0.66
10^{-3}
\{10^{-3},5\times 10^{-4}\}
\{64,128\}
\{10^{-3},5\times 10^{-4},10^{-4}\}
