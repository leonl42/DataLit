K
i
(x_{i},y_{i})
x_{i}=(x_{i}^{(num)},x_{i}^{(cat)})\in\mathbb{X}
y_{i}\in\mathbb{Y}
D=\{X,Y\}
n
X=\{x_{i}\}_{i=1}^{n}
Y=\{y_{i}\}_{i=1}^{n}
D_{train}
D_{val}
D_{test}
\mathbb{Y}=\{0,1\}
\mathbb{Y}=\{1,...,c\}
\mathbb{Y}=\mathbb{R}
F(\cdot;\theta):\mathbb{X}\to\mathbb{Y}
D_{train}
p
q
\mathbb{S}\in\mathbb{R}^{d}
p=\sum_{i=1}^{n}a_{i}\delta_{x_{i}}
q=\sum_{j=1}^{m}b_{j}\delta_{y_{j}}
\bm{a}\in\sum^{n}
\bm{b}\in\sum^{m}
\sum^{n}
\mathbb{R}^{n}
p
q
\displaystyle\text{OT}(p,q)=\min_{\textbf{T}\in\Pi(p,q)}\langle\textbf{T},%
\textbf{C}\rangle,
\displaystyle\text{OT}(p,q)=\min_{\textbf{T}\in\Pi(p,q)}\langle\textbf{T},%
\textbf{C}\rangle,
\langle\cdot,\cdot\rangle
\textbf{C}\in\mathbb{R}^{n\times m}_{\geq 0}
C_{ij}=Distance(x_{i},y_{j})
\textbf{T}\in\mathbb{R}^{n\times m}_{\geq 0}
\Pi(p,q):=\{\textbf{T}|\sum_{i=1}^{n}T_{ij}=b_{j},\sum_{j=1}^{m}T_{ij}=a_{i}\}
\langle\textbf{T},\textbf{C}\rangle
F(\cdot;\theta)
\mathcal{B}=\{\beta_{k}\}_{k=1}^{K}\in\mathbb{R}^{K\times d}
K
\beta_{k}
k
d
\mathcal{B}
r=\{r^{k}\}_{k=1}^{K}\in\mathbb{R}^{K\times 1}
\sum_{k=1}^{K}r^{k}\beta_{k}
F(\cdot;\theta)
F(\cdot;\theta)
G_{h}(G_{f}(\cdot;\theta_{f});\theta_{h})
G_{f}(\cdot;\theta_{f})
G_{h}(\cdot;\theta_{h})
\theta_{f}
\theta_{h}
F(\cdot;\theta)
\min\mathcal{L}_{task}(X,Y)=\min_{\theta_{f},\theta_{h}}\mathcal{L}(G_{h}\left%
(G_{f}(X;\theta_{f});\theta_{h}\right),Y),
\mathcal{L}
G_{f}(X;\theta_{f})
\displaystyle\min_{C\in\mathbb{R}^{K\times d}}\frac{1}{n}\sum_{i=1}^{n}\min_{%
\tilde{y_{i}}\in\{0,1\}^{K}}\|G_{f}(x_{i};\theta_{f})-\tilde{y_{i}}^{\mathrm{T%
}}C\|,\ \text{ subject to }\tilde{y_{i}}^{\mathrm{T}}\textbf{1}_{K}=1,
\displaystyle\min_{C\in\mathbb{R}^{K\times d}}\frac{1}{n}\sum_{i=1}^{n}\min_{%
\tilde{y_{i}}\in\{0,1\}^{K}}\|G_{f}(x_{i};\theta_{f})-\tilde{y_{i}}^{\mathrm{T%
}}C\|,\ \text{ subject to }\tilde{y_{i}}^{\mathrm{T}}\textbf{1}_{K}=1,
\textbf{1}_{K}\in\mathbb{R}^{K}
\tilde{y_{i}}
C
C
\mathcal{B}
F(\cdot;\theta)
\mathcal{B}
F(\cdot;\theta)
F(\cdot;\theta)
i
G_{f}(x_{i};\theta_{f})
\phi(\cdot;\gamma)
\gamma
r_{i}
\phi(G_{f}(x_{i};\theta_{f});\gamma)
i
Q_{i}=\sum_{k=1}^{K}r_{i}^{k}\delta_{\beta_{k}}
i
G_{f}(x_{i};\theta_{f})
P_{i}=\delta_{G_{f}(x_{i};\theta_{f})}
G_{f}(x_{i};\theta_{f})
P_{i}
P_{i}
Q_{i}
\beta_{k}
\displaystyle\min\mathcal{L}_{projecting}(X,\mathcal{B})=\min\frac{1}{n}\sum_{%
i=1}^{n}\text{OT}(P_{i},Q_{i})=\min_{\theta_{f},\gamma,\mathcal{B}}\frac{1}{n}%
\sum_{i=1}^{n}\min_{\textbf{T}_{i}\in\Pi(P_{i},Q_{i})}\langle\textbf{T}_{i},%
\textbf{C}_{i}\rangle,
\displaystyle\min\mathcal{L}_{projecting}(X,\mathcal{B})=\min\frac{1}{n}\sum_{%
i=1}^{n}\text{OT}(P_{i},Q_{i})=\min_{\theta_{f},\gamma,\mathcal{B}}\frac{1}{n}%
\sum_{i=1}^{n}\min_{\textbf{T}_{i}\in\Pi(P_{i},Q_{i})}\langle\textbf{T}_{i},%
\textbf{C}_{i}\rangle,
F(\cdot;\theta)
\displaystyle\min\mathcal{L}_{task}(X,Y)=\min_{\theta_{f},\theta_{h},\gamma,%
\mathcal{B}}\frac{1}{n}\sum_{i=1}^{n}\mathcal{L}(G_{h}(\sum_{k=1}^{K}r_{i}^{k}%
\beta_{k};\theta_{h}),y_{i}),
\displaystyle\min\mathcal{L}_{task}(X,Y)=\min_{\theta_{f},\theta_{h},\gamma,%
\mathcal{B}}\frac{1}{n}\sum_{i=1}^{n}\mathcal{L}(G_{h}(\sum_{k=1}^{K}r_{i}^{k}%
\beta_{k};\theta_{h}),y_{i}),
\mathcal{B}
t
t=1+\log(n_{b})
n_{b}
\displaystyle\mathcal{L}_{diversifying}(X)=-\sum_{i=1}^{n_{b}}\sum_{j=1}^{n_{b%
}}\textbf{1}\{y_{i},y_{j}\in\text{positive pair}\}\log{\frac{\exp{(\cos(r_{i},%
r_{j}))}}{\sum_{i=1}^{n_{b}}\sum_{j=1}^{n_{b}}\exp{(\cos(r_{i},r_{j}))}}}
\displaystyle\mathcal{L}_{diversifying}(X)=-\sum_{i=1}^{n_{b}}\sum_{j=1}^{n_{b%
}}\textbf{1}\{y_{i},y_{j}\in\text{positive pair}\}\log{\frac{\exp{(\cos(r_{i},%
r_{j}))}}{\sum_{i=1}^{n_{b}}\sum_{j=1}^{n_{b}}\exp{(\cos(r_{i},r_{j}))}}}
\displaystyle\min\mathcal{L}_{orthogonalization}(\mathcal{B})=\min(\frac{\|M\|%
_{1}}{\|M\|_{2}^{2}}+\max(0,|K-\|M\|_{1}|)),
\displaystyle\min\mathcal{L}_{orthogonalization}(\mathcal{B})=\min(\frac{\|M\|%
_{1}}{\|M\|_{2}^{2}}+\max(0,|K-\|M\|_{1}|)),
M\in[0,1]^{K\times K}
M_{ij}=\|\cos(\beta_{i},\beta_{j})\|_{1}
\frac{\|M\|_{1}}{\|M\|_{2}^{2}}
M
M_{ij}=\|\cos(\beta_{i},\beta_{j})\|_{1}
\beta_{i}
\beta_{j}
\|M\|_{1}\to K
K
M_{ii}=\|\cos(\beta_{i},\beta_{i})\|_{1}=1,\forall i\in\{1,2,...,K\}
M_{ij}=\|\cos(\beta_{i},\beta_{j})\|_{1},\forall i,j\in\{1,2,...,K\},i\neq j
F(\cdot;\theta)
\mathcal{B}
K
K
\log(N)
N
\phi(\cdot;\gamma)
F(\cdot;\theta)
\theta
\alpha=0.05
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
F(\cdot;\theta)
(\beta_{i},\beta_{j})
\|\cos(\beta_{i},\beta_{j})\|_{1}
D=\{X,Y\}
F(\cdot;\theta)=G_{h}\left(G_{f}(\cdot;\theta_{f});\theta_{h}\right)
\phi(\cdot;\gamma)
F(\cdot;\theta)
\min\mathcal{L}_{task}(X,Y)=\min_{\theta_{f},\theta_{h}}\mathcal{L}(G_{h}\left%
(G_{f}(X;\theta_{f});\theta_{h}\right),Y)
\mathcal{B}=\{\beta_{k}\}_{k=1}^{K}\in\mathbb{R}^{K\times d}
G_{f}(X;\theta_{f})
F(\cdot;\theta)=G_{h}\left(G_{f}(\cdot;\theta_{f});\theta_{h}\right)
\mathcal{B},\theta_{f},\theta_{h},\gamma
n_{b}
D
i\leftarrow 1
n_{b}
i
P_{i}=\delta_{G_{f}(x_{i};\theta_{f})}
i
r_{i}=\phi(G_{f}(x_{i};\theta_{f});\gamma)
i
Q_{i}=\sum_{k=1}^{K}r_{i}^{k}\delta_{\beta_{k}}
P_{i}
Q_{i}
\text{OT}(P_{i},Q_{i})=\min_{\textbf{T}_{i}\in\Pi(P_{i},Q_{i})}\langle\textbf{%
T}_{i},\textbf{C}_{i}\rangle
\mathcal{L}_{projecting}(X,\mathcal{B})=\frac{1}{n_{b}}\sum_{i=1}^{n_{b}}\text%
{OT}(P_{i},Q_{i})=\frac{1}{n_{b}}\sum_{i=1}^{n_{b}}\min_{\textbf{T}_{i}\in\Pi(%
P_{i},Q_{i})}\langle\textbf{T}_{i},\textbf{C}_{i}\rangle
\mathcal{L}_{task}(X,Y)=\frac{1}{n_{b}}\sum_{i=1}^{n_{b}}\mathcal{L}(G_{h}(%
\sum_{k=1}^{K}r_{i}^{k}\beta_{k};\theta_{h}),y_{i})
\mathcal{L}_{diversifying}(X)=-\sum_{i=1}^{n_{b}}\sum_{j=1}^{n_{b}}\textbf{1}%
\{y_{i},y_{j}\in\text{positive pair}\}\log{\frac{\exp{(\cos(r_{i},r_{j}))}}{%
\sum_{i=1}^{n_{b}}\sum_{j=1}^{n_{b}}\exp{(\cos(r_{i},r_{j}))}}}
\mathcal{L}_{orthogonalization}(\mathcal{B})=(\frac{\|M\|_{1}}{\|M\|_{2}^{2}}+%
\max(0,|K-\|M\|_{1}|))
\mathcal{B},\theta_{f},\theta_{h},\gamma
\mathcal{O}=\mathcal{L}_{task}+\mathcal{L}_{projecting}+\mathcal{L}_{%
diversifying}+\mathcal{L}_{orthogonalization}
G_{f},G_{h},\phi,\mathcal{B}
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
n
n^{2}\log(n)/\epsilon^{2}
\epsilon
x_{i}
G_{f}(x_{i};\theta_{f})
P_{i}
Q_{i}
O(K^{2}\log(K)/\epsilon^{2})
K
K
K
\log(N)
N
\displaystyle\mathcal{O}=\mathcal{L}_{task}(X,Y)+\mathcal{L}_{projecting}(X,%
\mathcal{B})+\mathcal{L}_{diversifying}(X)+\mathcal{L}_{orthogonalization}(%
\mathcal{B}).
\displaystyle\mathcal{O}=\mathcal{L}_{task}(X,Y)+\mathcal{L}_{projecting}(X,%
\mathcal{B})+\mathcal{L}_{diversifying}(X)+\mathcal{L}_{orthogonalization}(%
\mathcal{B}).
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
K
\log(N)
N
\uparrow
\uparrow
\downarrow
P_{i}
Q_{i}
P_{i}
Q_{i}
P_{i}
Q_{i}
\mathcal{B}
i
G_{f}(x_{i};\theta_{f})
P_{i}=\delta_{G_{f}(x_{i};\theta_{f})}
Q_{i}=\sum_{k=1}^{K}r_{i}^{k}\delta_{\beta_{k}}
r_{i}
G_{f}(x_{i};\theta_{f})
P_{i}
P_{i}
Q_{i}
\beta_{k}
P_{i}
Q_{i}
P_{i}
Q_{i}
\text{OT}(P_{i},Q_{i})=\min_{\textbf{T}_{i}\in\Pi(P_{i},Q_{i})}\langle\textbf{%
T}_{i},\textbf{C}_{i}\rangle
C_{ik}=1-\cos(G_{f}(x_{i};\theta_{f}),\beta_{k})
P_{i}
Q_{i}
\mathcal{L}_{projecting}(X,\mathcal{B})
\min\mathcal{L}_{projecting}(X,\mathcal{B})=\min\frac{1}{n}\sum_{i=1}^{n}\text%
{OT}(P_{i},Q_{i})=\min_{\theta_{f},\gamma,\mathcal{B}}\frac{1}{n}\sum_{i=1}^{n%
}\min_{\textbf{T}_{i}\in\Pi(P_{i},Q_{i})}\langle\textbf{T}_{i},\textbf{C}_{i}\rangle
\theta_{f},\gamma,\mathcal{B}
