\dagger
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
a_{t}
x_{t}
y_{t}
x_{t}
x_{t-1}
a_{t-1}
x_{t}
y_{t}
z_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
a_{t}
x_{t}
y_{t}
x_{t}
x_{t-1}
a_{t-1}
x_{t}
y_{t}
z_{t}
\mathcal{M}\triangleq(\mathcal{S},\mathcal{A},\Omega,R,T,O,\gamma)
\mathcal{S}
\mathcal{A}
\Omega
R:S\times A\rightarrow\mathbb{R}
T:S\times A\rightarrow\Delta(S)
O:S\times A\rightarrow\Delta(\Omega)
\gamma\in[0,1]
\Delta(S)
S
\left\{\left\langle o_{t},a_{t},r_{t}\right\rangle\right\}_{t=1}^{T}
\mathbf{s_{t}}=\{s^{ar}_{t},s^{\bar{a}r}_{t},s^{a\bar{r}}_{t},s^{\bar{a}\bar{r%
}}_{t}\}
s^{ar}_{t}
a_{t-1}
s^{ar}_{t}
r_{t}
s^{\bar{a}r}_{t}
a_{t-1}
s^{\bar{a}r}_{t}
r_{t}
s^{a\bar{r}}_{t}
a_{t-1}
s^{a\bar{r}}_{t}
r_{t}
s^{\bar{a}\bar{r}}_{t}
a_{t-1}
s^{\bar{a}\bar{r}}_{t}
r_{t}
s^{ar}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{r}_{t}:=(s^{ar}_{t}
s^{\bar{a}r}_{t}),s^{\bar{r}}_{t}:=(s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}),s^{a}_{t}:=(s^{a\bar{r}}_{t}
s^{a\bar{r}}_{t})
s^{\bar{a}}_{t}:=(s^{\bar{a}r}_{t}
s^{\bar{a}\bar{r}}_{t})
s^{r}_{t}
r_{t+\tau}
\tau>0
R_{t}=\sum_{t^{\prime}=t}\gamma^{t^{\prime}-t}r_{t^{\prime}}
s^{r}_{t}\subseteq\mathbf{s_{t}}
s_{i,t}\in s^{r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},s^{r}_{t-1}
s^{a}_{t}
a_{t-1}
s^{a}_{t}\subseteq\mathbf{s_{t}}
s_{i,t}\in s^{a}_{t}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s^{ar}_{t},s^{\bar{a}r}_{t},s^{a\bar{r}}_{t}
s^{r}_{t}
s^{a}_{t}
s_{i,t}\in s^{ar}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},s^{r}_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{\bar{a}r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},s^{r}_{t-1}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{a\bar{r}}_{t}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}R_{t}|a_{t-1:t},s^{r}_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{\bar{a}\bar{r}}_{t}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}R_{t}|a_{t-1:t},s^{r}_{t-1}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}a_{t-1}|\mathbf{s_{t-1}}
s^{ar}_{t}
s^{\bar{a}r}_{t}
\mathbf{s}_{t}
o_{t}
R_{t}
[o_{t},R_{t}]=f(s^{r}_{t},s^{\bar{r}}_{t},\eta_{t}),
\begin{array}[]{ccc}o_{t}&=&f_{1}(s^{r}_{t},s^{\bar{r}}_{t}),\\
R_{t}&=&f_{2}(s^{r}_{t},\eta_{t}).\end{array}
s^{r}_{t}
r_{t:T}
s_{i,t}\in\mathbf{s}_{t}
r_{t+\tau}
\tau>0
s^{r}_{t}
s^{r}_{t}
R_{t}
\eta_{t}
s^{r}_{t}
R_{t}
\mathbf{s_{t}}
h(\cdot)
\mathbf{s_{t}}
\mathbf{\hat{s}_{t}}
\mathbf{\hat{s}_{t}}=h(\mathbf{s_{t}})
{\tilde{\mathbf{s}}}_{t}:=(s^{r}_{t},s^{\bar{r}}_{t},\eta_{t})
|s|
s
d_{s_{r}}:=|s^{r}_{t}|
d_{s_{\bar{r}}}:=|s_{t}^{\bar{r}}|
d_{\tilde{s}}:=|{\tilde{\mathbf{s}}}_{t}|
d_{o}:=|o_{t}|
d_{R}:=|R_{t}|
{\mathcal{F}}
{\mathbf{J}}_{f}({\mathbf{s}}_{t})
\hat{{\mathcal{F}}}
{\mathbf{J}}_{\hat{f}}(\hat{{\mathbf{s}}}_{t})
{\mathcal{T}}
{\mathbf{T}}({\mathbf{s}}_{t})
{\mathbf{J}}_{\hat{f}}(\hat{{\mathbf{s}}}_{t})={\mathbf{J}}_{f}({\mathbf{s}}_{%
t}){\mathbf{T}}({\mathbf{s}})
T
{\mathcal{T}}
\mathcal{D}\subseteq\{1,\cdots,d_{\tilde{s}}\}
\mathbb{R}_{\mathcal{D}}^{d_{\tilde{s}}}
\mathbb{R}_{\mathcal{D}}^{d_{\tilde{s}}}:=\{z\in\mathbb{R}^{d_{\tilde{s}}}|i%
\notin\mathcal{D}\Longrightarrow z_{i}=0\}
\mathbb{R}_{\mathcal{D}}^{d_{\tilde{s}}}
\mathbb{R}^{d_{\tilde{s}}}
\mathcal{D}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
o_{t}
r_{t}
a_{t}
f
i\in\{1,\dots,d_{o}+d_{R}\}
j\in{\mathcal{F}}_{i,:}
\{{\tilde{\mathbf{s}}}_{t}^{(l)}\}_{l=1}^{|{\mathcal{F}}_{i,:}|}
\text{span}\{{\mathbf{J}}_{f}({\tilde{\mathbf{s}}}_{t}^{(l)})_{i,:}\}_{l=1}^{|%
{\mathcal{F}}_{i,:}|}=\mathbb{R}_{{\mathcal{F}}_{i,:}}^{d_{\tilde{s}}}
T
{\mathbf{J}}_{\hat{f}}^{-1}(\hat{{\tilde{\mathbf{s}}}}_{t}){\mathbf{J}}_{f}({%
\tilde{\mathbf{s}}}_{t})
\big{[}{\mathbf{J}}_{f}({\tilde{\mathbf{s}}}_{t}^{(l)})T\big{]}_{j,:}\in%
\mathbb{R}_{\hat{{\mathcal{F}}}_{i,:}}^{d_{\tilde{s}}}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
A1
f
f_{1}
f_{2}
f
f_{2}
A2
\begin{array}[]{ll}\left\{\begin{array}[]{ll}\textit{Observation Model: }&p_{%
\theta}\left(o_{t}\,|\ \mathbf{s_{t}}\right)\\
\textit{Reward Model: }&p_{\theta}\left(r_{t}\,|\ s^{r}_{t}\right)\\
\textit{Transition Model: }&p_{\gamma}\left(\mathbf{s_{t}}\,|\ \mathbf{s_{t-1}%
},a_{t-1}\right)\\
\textit{Representation Model: }&q_{\phi}\left(\mathbf{s_{t}}\,|\ o_{t},\mathbf%
{s_{t-1}},a_{t-1}\right)\\
\end{array}\right.\end{array}
\theta
\gamma
\phi
a_{t-1}
\mathbf{s_{t}}
o_{t}
o_{t}
\mathbf{s_{t}}
r_{t}
s^{r}_{t}
\begin{array}[]{ll}\textit{\ \ \small{Disentangled Transition Model:}}&\textit%
{\ \ \small{Disentangled Representation Model:}}\\
\left\{\begin{array}[]{l}p_{\gamma_{1}}\left(s^{ar}_{t}\,|\ s^{r}_{t-1},a_{t-1%
}\right)\\
p_{\gamma_{2}}\left(s^{\bar{a}r}_{t}\,|\ s^{r}_{t-1}\right)\\
p_{\gamma_{3}}\left(s^{a\bar{r}}_{t}\,|\ \mathbf{s_{t-1}},a_{t-1}\right)\\
p_{\gamma_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ \mathbf{s_{t-1}}\right)\end{%
array}\right.&\left\{\begin{array}[]{l}q_{\phi_{1}}\left(s^{ar}_{t}\,|\ o_{t},%
s^{r}_{t-1},a_{t-1}\right)\\
q_{\phi_{2}}\left(s^{\bar{a}r}_{t}\,|\ o_{t},s^{r}_{t-1}\right)\\
q_{\phi_{3}}\left(s^{a\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}},a_{t-1}\right)\\
q_{\phi_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}}\right)\end%
{array}\right.\end{array}
p_{\gamma}=p_{\gamma_{1}}\cdot p_{\gamma_{2}}\cdot p_{\gamma_{3}}\cdot p_{%
\gamma_{4}}
q_{\phi}=q_{\phi_{1}}\cdot q_{\phi_{2}}\cdot q_{\phi_{3}}\cdot q_{\phi_{4}}
\mathbf{s_{t-1}}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{r}_{t-1}
s^{\bar{r}}_{t-1}
s^{\bar{r}}_{t}
\mathbf{s_{t-1}}
s^{\bar{r}}_{t}
s^{ar}_{t}
s^{a\bar{r}}_{t}
a_{t-1}
h^{*}_{t}
s^{*}_{t}
s^{r}_{t}
h^{*}_{t}
s^{*}_{t}
s^{r}_{t}
\mathcal{J}_{\mathrm{O}}^{t}=\ln p_{\theta}\left(o_{t}\mid\mathbf{s_{t}}\right%
)\quad\mathcal{J}_{\mathrm{R}}^{t}=\ln p_{\theta}\left(r_{t}\mid s^{r}_{t}%
\right)\quad\mathcal{J}_{\mathrm{D}}^{t}=-\mathrm{KL}\left(q_{\phi}\|p_{\gamma%
})\right).
\mathcal{J}_{\mathrm{D}}^{t}
\mathcal{J}_{\mathrm{D}}^{t}=-\beta_{1}\cdot\mathrm{KL}\left(q_{\phi_{1}}\|p_{%
\gamma_{1}}\right)-\beta_{2}\cdot\mathrm{KL}\left(q_{\phi_{2}}\|p_{\gamma_{2}}%
\right)-\beta_{3}\cdot\mathrm{KL}\left(q_{\phi_{3}}\|p_{\gamma_{3}}\right)-%
\beta_{4}\cdot\mathrm{KL}\left(q_{\phi_{4}}\|p_{\gamma_{4}}\right).
s^{r}_{t}
R_{t}
a_{t-1:t}
s^{r}_{t-1}
I(s^{r}_{t},R_{t}|a_{t-1:t},s^{r}_{t-1})
s^{r}_{t}
I(s^{r}_{t},R_{t}|a_{t-1:t},s^{r}_{t-1})
I(s^{\bar{r}}_{t},R_{t}|a_{t-1:t},s^{r}_{t-1})
s^{\bar{r}}_{t}
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})-I(s^{\bar{r}}_{t};R%
_{t}\,|\ a_{t-1:t},s^{r}_{t-1}).
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})-I(s^{\bar{r}}_{t};R%
_{t}\,|\ a_{t-1:t},s^{r}_{t-1}).
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})=I(R_{t};s^{r}_{t},a%
_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t},s^{r}_{t-1}),
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})
\displaystyle=I(R_{t};s^{r}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t},s^{r}%
_{t-1}),
\displaystyle I(s^{\bar{r}}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})=I(R_{t};s^{%
\bar{r}}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t},s^{r}_{t-1}).
\displaystyle I(s^{\bar{r}}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})
\displaystyle=I(R_{t};s^{\bar{r}}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t}%
,s^{r}_{t-1}).
\mathcal{J}_{\mathrm{RS}}^{t}=\lambda_{1}\cdot\big{\{}I_{\alpha_{1}}(R_{t};s^{%
r}_{t},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))-I_{\alpha_{2}}(R_{t};s^{\bar{r}}_{t%
},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))\big{\}}.
\alpha
\mathbf{sg}
s^{r}_{t-1}
s^{a}_{t}
s^{\bar{a}}_{t}
\mathcal{J}_{\mathrm{AS}}^{t}=\lambda_{2}\cdot\big{\{}I_{\alpha_{3}}(a_{t-1};s%
^{a}_{t},\mathbf{sg}(\mathbf{s_{t-1}}))-I_{\alpha_{4}}(a_{t-1};s^{\bar{a}}_{t}%
,\mathbf{sg}(\mathbf{s_{t-1}}))\big{\}}.
s^{r}_{t}
s^{\bar{r}}_{t}
s^{a}_{t}
s^{\bar{a}}_{t}
\mathcal{J}_{\mathrm{TOTAL}}=\mathrm{E}_{q_{\phi}}\left(\sum_{t}\left(\mathcal%
{J}_{\mathrm{O}}^{t}+\mathcal{J}_{\mathrm{R}}^{t}+\mathcal{J}_{\mathrm{D}}^{t}%
+\mathcal{J}_{\mathrm{RS}}^{t}+\mathcal{J}_{\mathrm{AS}}^{t}\right)\right)+%
\text{ const }.
s^{r}_{t}
R^{2}
s^{*}_{t}
\hat{s}^{*}_{t}
\hat{s}^{*}_{t}
s^{*}_{t}
*\in\{ar,\bar{a}r,a\bar{r},\bar{a}\bar{r}\}
R^{2}=1
R^{2}
>0.9
x_{t},y_{t}
x_{t},y_{t}
z_{t}
R^{2}
R^{2}
R^{2}
\rightarrow
R^{2}
\rightarrow
R^{2}
R^{2}
R^{2}
\rightarrow
R^{2}
\rightarrow
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{r}_{t}
s^{r}_{t}
s^{r}_{t}
s^{r}_{t}
s^{ar}_{t}
s^{\bar{r}}_{t}
s^{r}_{t}+s^{a\bar{r}}_{t}
\mathbf{s_{t}}
s^{a\bar{r}}_{t}
s^{a\bar{r}}_{t}
s^{r}_{t}
s^{r}_{t}
r_{t+\tau}
\tau\geq 0
R_{t}
s^{r}_{t}\subseteq\mathbf{s_{t}}
s_{i,t}\in s^{r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},s^{r}_{t-1}
p
\mathbf{V}
G
(A,B,C)
B
A
C
p(A,C|B)=p(A|B)p(C|B)
s_{i,t}
s^{r}_{t}
r_{t+\tau}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},\mathbf{s}_{t-1}
s_{i,t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},\mathbf{s}_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},s^{r}_{t-1}
s^{r}_{t}
s_{i,t}
s^{r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},\mathbf{s}_{t-1}
s_{i,t}
R_{t}
a_{t-1:t}
\mathbf{s}_{t-1}
s_{i,t}
r_{t+\tau}
a_{t-1:t}
\mathbf{s}_{t-1}
s_{i,t}
R_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},\mathbf{s}_{t-1}
s_{i,t}\in s^{r}_{t}
s_{i,t}
r_{t+\tau}
a_{t-1:t}
\mathbf{s}_{t-1}
s_{i,t}
R_{t}
s_{i,t}
R_{t}
a_{t-1:t}
\mathbf{s}_{t-1}
s_{i,t}
r_{t+\tau}
s_{i,t}\in s^{r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},\mathbf{s}_{t-1}
r_{t+\tau}
r_{t+\tau}
a_{t-1:t}
\mathbf{s}_{t-1}
s_{i,t}
R_{t}
r_{t+\tau}
a_{t-1:t}
s^{r}_{t-1}
s_{i,t}
R_{t}
s_{i,t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},\mathbf{s}_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp R_{t+1}|a_{t-1:t},s^{r}_{t-1}
s_{i,t}
s^{r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1:t},s^{r}_{t-1}
s_{i,t}
s^{r}_{t}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}R_{t}|a_{t-1:t},s^{r}_{t-1}
s^{r}_{t}
s^{a}_{t}
a_{t-1}
s^{a}_{t}\subseteq\mathbf{s_{t}}
s_{i,t}\in s^{a}_{t}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}
s^{a}_{t}
a_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s^{a}_{t}
s_{i,t}
s^{a}_{t}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}
a_{t-1}
\mathbf{s}_{t-1}
s_{i,t}
a_{t-1}
\mathbf{s}_{t-1}
s_{i,t}
a_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{a}_{t}
s_{i,t}
a_{t-1}
\mathbf{s}_{t-1}
s_{i,t}
a_{t-1}
s_{i,t}
a_{t-1}
\mathbf{s}_{t-1}
s_{i,t}
a_{t-1}
s_{i,t}
s^{a}_{t}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}
s^{a}_{t}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}a_{t-1}|\mathbf{s_{t-1}}
s^{a}_{t}
s^{ar}_{t},s^{\bar{a}r}_{t},s^{a\bar{r}}_{t}
s^{r}_{t}
s^{a}_{t}
s_{i,t}\in s^{ar}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1},s^{r}_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{\bar{a}r}_{t}
s_{i,t}\not\!\perp\!\!\!\perp R_{t}|a_{t-1},s^{r}_{t-1}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{a\bar{r}}_{t}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}R_{t}|a_{t-1},s^{r}_{t-1}
s_{i,t}\not\!\perp\!\!\!\perp a_{t-1}|\mathbf{s_{t-1}}
s_{i,t}\in s^{\bar{a}\bar{r}}_{t}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}R_{t}|a_{t-1},s^{r}_{t-1}
s_{i,t}\mathchoice{\mathrel{\hbox to0.0pt{$\displaystyle\perp$\hss}\mkern 2.0%
mu{\displaystyle\perp}}}{\mathrel{\hbox to0.0pt{$\textstyle\perp$\hss}\mkern 2%
.0mu{\textstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptstyle\perp$\hss}\mkern 2%
.0mu{\scriptstyle\perp}}}{\mathrel{\hbox to0.0pt{$\scriptscriptstyle\perp$\hss%
}\mkern 2.0mu{\scriptscriptstyle\perp}}}a_{t-1}|\mathbf{s_{t-1}}
\mathbf{s}_{t}
o_{t}
R_{t}
[o_{t},R_{t}]=f(s^{r}_{t},s^{\bar{r}}_{t},\eta_{t}),
\begin{array}[]{ccc}o_{t}&=&f_{1}(s^{r}_{t},s^{\bar{r}}_{t}),\\
R_{t}&=&f_{2}(s^{r}_{t},\eta_{t}).\end{array}
s^{r}_{t}
r_{t:T}
s_{i,t}\in\mathbf{s}_{t}
r_{t+\tau}
\tau>0
s^{r}_{t}
s^{r}_{t}
R_{t}
\eta_{t}
s^{r}_{t}
R_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
o_{t}
r_{t}
a_{t}
f
i\in\{1,\dots,d_{o}+d_{R}\}
j\in{\mathcal{F}}_{i,:}
\{{\tilde{\mathbf{s}}}_{t}^{(l)}\}_{l=1}^{|{\mathcal{F}}_{i,:}|}
\text{span}\{{\mathbf{J}}_{f}({\tilde{\mathbf{s}}}_{t}^{(l)})_{i,:}\}_{l=1}^{|%
{\mathcal{F}}_{i,:}|}=\mathbb{R}_{{\mathcal{F}}_{i,:}}^{d_{\tilde{s}}}
T
{\mathbf{J}}_{\hat{f}}^{-1}(\hat{{\tilde{\mathbf{s}}}}_{t}){\mathbf{J}}_{f}({%
\tilde{\mathbf{s}}}_{t})
\big{[}{\mathbf{J}}_{f}({\tilde{\mathbf{s}}}_{t}^{(l)})T\big{]}_{j,:}\in%
\mathbb{R}_{\hat{{\mathcal{F}}}_{i,:}}^{d_{\tilde{s}}}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
A1
f
f_{1}
f_{2}
f
f_{2}
A2
s^{a}_{t}=s^{ar}_{t}\cup s^{a\bar{r}}_{t}
a_{t}
s^{ar}_{t}
s^{a\bar{r}}_{t}
s^{r}_{t}=s^{ar}_{t}\cup s^{\bar{a}r}_{t}
R_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{ar}_{t}
s^{ar}_{t}\cup s^{a\bar{r}}_{t}
s^{ar}_{t}\cup s^{\bar{a}r}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{a}_{t}
t
h:=f^{-1}\circ\hat{f}
\hat{\textbf{s}}=h(\textbf{s}),
h=f^{-1}\circ\hat{f}
\hat{f}:\mathcal{S}\rightarrow\mathcal{X}
f^{-1}
\hat{f}
h
h^{-1}
h(\cdot)
\mathcal{S}
J_{h^{-1}}=\begin{bmatrix}A:=\frac{\partial s^{\bar{a}}}{\partial\hat{s}^{\bar%
{a}}}&B:=\frac{\partial s^{\bar{a}}}{\partial\hat{s}^{a}}\\
C:=\frac{\partial s^{a}}{\partial\hat{s}^{\bar{a}}}&D:=\frac{\partial s^{a}}{%
\partial\hat{s}^{a}}\end{bmatrix}
h^{-1}
J_{h^{-1}}
s^{a}
a
s^{\bar{a}}
a
C=0
J_{h^{-1}}
C
D
h_{a}^{{}^{\prime}-1}
h_{a}^{{}^{\prime}-1}
h_{a}^{-1}
s^{a}
s_{t}^{r}
[o_{t},R_{t}]=f(s_{t}^{r},s_{t}^{\bar{r}},\eta_{t}),
\begin{array}[]{ccc}o_{t}&=&f_{1}(s_{t}^{r},s_{t}^{\bar{r}}),\\
R_{t}&=&f_{2}(s_{t}^{r},\eta_{t}).\end{array}
s_{t}^{r}
s_{t}^{r}
r_{t+1:T}
\eta_{t}
s_{t}^{r}
R_{t}
t
f
f_{1}
f_{2}
{\tilde{\mathbf{s}}}=(s^{r},s^{\bar{r}},\eta)
s^{r}
d_{s^{r}}
s^{\bar{r}}
d_{s^{\bar{r}}}
{\tilde{\mathbf{s}}}
d_{\tilde{s}}
o
d_{o}
R_{t}
d_{R}
{\mathcal{F}}
{\mathbf{J}}_{f}({\mathbf{s}})
\hat{{\mathcal{F}}}
{\mathbf{J}}_{\hat{f}}(\hat{{\mathbf{s}}})
{\mathcal{T}}
{\mathbf{T}}({\mathbf{s}})
T
{\mathcal{T}}
h:=\hat{f}^{-1}\circ f
\hat{f}=f\circ h^{-1}({\tilde{\mathbf{s}}})
{\mathbf{J}}_{\hat{f}}(\hat{{\tilde{\mathbf{s}}}})={\mathbf{J}}_{f}({\tilde{%
\mathbf{s}}})\cdot{\mathbf{J}}_{h^{-1}}(h({\tilde{\mathbf{s}}})).
i\in\{1,\dots,d_{o}+d_{R}\}
\{{\tilde{\mathbf{s}}}^{(l)}\}_{l=1}^{|{\mathcal{F}}_{i,:}|}
\text{span}(\{{\mathbf{J}}_{f}({\tilde{\mathbf{s}}}^{(l)})_{i,:}\}_{l=1}^{|{%
\mathcal{F}}_{i,:}|})={\mathtt{R}}^{d_{\tilde{s}}}_{{\mathcal{F}}_{i,:}}
\{{\mathbf{J}}_{f}({\tilde{\mathbf{s}}}^{(l)})_{i,:}\}_{l=1}^{|{\mathcal{F}}_{%
i,:}|}
{\mathtt{R}}^{d_{\tilde{s}}}_{{\mathcal{F}}_{i,:}}
j_{0}\in{\mathcal{F}}_{i,:}
e_{j_{0}}\in{\mathtt{R}}^{d_{\tilde{s}}}_{{\mathcal{F}}_{i,:}}
e_{j_{0}}=\sum_{l\in{\mathcal{F}}_{i,:}}\alpha_{l}\cdot{\mathbf{J}}_{g}({%
\tilde{\mathbf{s}}}^{(l)})_{i,:},
\alpha_{l}\in{\mathtt{R}}
T
\displaystyle T_{j_{0},:}=e_{j_{0}}^{\top}T=\sum_{l\in{\mathcal{F}}_{i,:}}%
\alpha_{l}\cdot{\mathbf{J}}_{g}({\tilde{\mathbf{s}}}^{(l)})_{i,:}T\in{\mathtt{%
R}}^{d_{{\tilde{s}}}}_{\hat{{\mathcal{F}}}_{i,:}},
\displaystyle T_{j_{0},:}=e_{j_{0}}^{\top}T=\sum_{l\in{\mathcal{F}}_{i,:}}%
\alpha_{l}\cdot{\mathbf{J}}_{g}({\tilde{\mathbf{s}}}^{(l)})_{i,:}T\in{\mathtt{%
R}}^{d_{{\tilde{s}}}}_{\hat{{\mathcal{F}}}_{i,:}},
\in
{\mathtt{R}}^{d_{{\tilde{s}}}}_{\hat{{\mathcal{F}}}_{i,:}}
\displaystyle\forall j\in{\mathcal{F}}_{i,:},T_{j,:}\in{\mathtt{R}}^{d_{{%
\tilde{s}}}}_{\hat{{\mathcal{F}}}_{i,:}}.
\displaystyle\forall j\in{\mathcal{F}}_{i,:},T_{j,:}\in{\mathtt{R}}^{d_{{%
\tilde{s}}}}_{\hat{{\mathcal{F}}}_{i,:}}.
\displaystyle\forall(i,j)\in{\mathcal{F}},\quad\{i\}\times T_{j,:}\subset\hat{%
{\mathcal{F}}}.
\displaystyle\forall(i,j)\in{\mathcal{F}},\quad\{i\}\times T_{j,:}\subset\hat{%
{\mathcal{F}}}.
\hat{s}^{r}
s^{\bar{r}}
\eta
T_{i,j}=0
i\in\{1,\dots,d_{s^{r}}\}
j\in\{d_{s^{r}}+1,\dots,d_{{\tilde{s}}}\}
\hat{s}^{r}
s^{\bar{r}}
\exists(j_{s^{r}},j_{s^{\bar{r}}})\in{\mathcal{T}}
j_{s^{r}}\in\{1,\dots,d_{s^{r}}\}
j_{s^{\bar{r}}}\in\{d_{s^{r}}+1,\dots,d_{s^{r}}+d_{s^{\bar{r}}}\}
i_{r}\in\{d_{o}+1,\dots,d_{o}+d_{R}\}
(i_{r},j_{s^{\bar{r}}})\in{\mathcal{F}}
\displaystyle\{i_{r}\}\times{\mathcal{T}}_{j_{s^{\bar{r}}},:}\in\hat{{\mathcal%
{F}}}\implies(i_{r},j_{s^{\bar{r}}})\in\hat{{\mathcal{F}}}.
\displaystyle\{i_{r}\}\times{\mathcal{T}}_{j_{s^{\bar{r}}},:}\in\hat{{\mathcal%
{F}}}\implies(i_{r},j_{s^{\bar{r}}})\in\hat{{\mathcal{F}}}.
\hat{f}_{2}
[{\mathbf{J}}_{\hat{f}_{2}}]_{i_{r},j_{s^{\bar{r}}}}=0
(i_{r},j_{s^{\bar{r}}})
\hat{s}^{r}
s^{\bar{r}}
\hat{s}^{r}
\eta
\hat{s}_{r}
(s^{\bar{r}},\eta)
\hat{s}^{r}
s^{r}
(\hat{s}^{\bar{r}},\hat{\eta})
s_{r}
s^{r}
\hat{s}^{r}
s_{t}^{ar}
s^{a}
s^{r}
\begin{array}[]{ccc}\hat{s}^{r}&=&h_{r}(s^{r}),\\
\hat{s}^{a}&=&h_{a}(s^{a}),\\
\end{array}
h_{a}
h_{r}
s^{ar}
\hat{s}^{ar}=h_{r}(s^{r})_{1:d_{s^{ar}}}=h_{a}(s^{a})_{1:d_{s^{ar}}}.
\tilde{h}_{r}:=h_{r}(\cdot)_{1:d_{s^{ar}}}
\tilde{h}_{a}:=h_{a}(\cdot)_{1:d_{s^{ar}}}
s^{\bar{a}r}
s^{a\bar{r}}
\exists l\in\{1,\cdots,d_{s^{\bar{a}r}}\}
{s^{r}}^{*}\in\mathcal{S}^{r}
\frac{\partial\tilde{h}_{r}}{\partial s_{l}^{\bar{a}r}}({s^{r}}^{*})\neq 0
h
\frac{\partial\tilde{h}_{r}}{\partial s_{l}^{\bar{a}r}}\neq 0
{s^{r}}^{*}
\exists\eta>0,s.t.,s_{l}^{\bar{a}r}\rightarrow\tilde{h}_{r}({s^{ar}}^{*},({s_{%
-l}^{\bar{a}r}}^{*},{s_{l}^{\bar{a}r}}^{*}))\text{ is strictly monotonic on }(%
{s_{l}^{\bar{a}r}}^{*}-\eta,{s_{l}^{\bar{a}r}}^{*}+\eta),
s_{-l}^{\bar{a}r}
s^{\bar{a}r}
l
\psi:\mathcal{S}^{ar}\times\mathcal{S}^{\bar{a}r}\times\mathcal{S}^{a\bar{r}}%
\rightarrow{\mathtt{R}}_{\geq 0}
\psi(s^{ar},s^{\bar{a}r},s^{a\bar{r}}):=|\tilde{h}_{r}(s^{r})-\tilde{h}_{a}(s^%
{a})|.
\psi>0
({s^{ar}}^{*},{s^{\bar{a}r}}^{*},{s^{a\bar{r}}}^{*})
{s^{\bar{a}r}}^{*}
\mathcal{S}^{\bar{a}r}
\psi({s^{ar}}^{*},{s^{\bar{a}r}}^{*},{s^{a\bar{r}}}^{*})>0
\psi({s^{ar}}^{*},{s^{\bar{a}r}}^{*},{s^{a\bar{r}}}^{*})=0
\psi({s^{ar}}^{*},{s^{\bar{a}r}}^{*},{s^{a\bar{r}}}^{*})
\psi>0
\forall s_{l}^{\bar{a}r}\in({s_{l}^{ar}}^{*},{s_{l}^{ar}}^{*}+\eta)
\psi({s^{ar}}^{*},({s_{-l}^{\bar{a}r}}^{*},s_{l}^{\bar{a}r}),{s^{a\bar{r}}}^{*%
})>0
({s^{ar}}^{*},{s^{\bar{a}r}}^{*^{\prime}},{s^{a\bar{r}}}^{*})
\psi({s^{ar}}^{*},{s^{\bar{a}r}}^{*^{\prime}},{s^{a\bar{r}}}^{*})>0
{s^{\bar{a}r}}^{*^{\prime}}={s^{\bar{a}r}}^{*}
{s_{l}^{\bar{a}r}}^{*^{\prime}}\in({s_{l}^{ar}}^{*},{s_{l}^{ar}}^{*}+\eta),{s_%
{-l}^{ar}}^{*^{\prime}}={s_{-l}^{ar}}^{*}
\psi
{\mathtt{R}}_{>0}
\mathcal{U}\in\mathcal{S}^{ar}\times\mathcal{S}^{\bar{a}r}\times\mathcal{S}^{a%
\bar{r}}
({s^{ar}}^{*},{s^{\bar{a}r}}^{*^{\prime}},{s^{a\bar{r}}}^{*})\in\mathcal{U}
\mathcal{U}
\mathcal{U}
\mathcal{U}
p_{s^{ar},s^{\bar{a}r},s^{a\bar{r}}}
\mathcal{S}^{ar}\times\mathcal{S}^{\bar{a}r}\times\mathcal{S}^{a\bar{r}}
\mathtt{P}_{p}[\mathcal{U}]>0
\psi>0
\hat{h}_{r}(s^{r})
s^{\bar{a}r}
\hat{h}_{a}(s^{a})
s^{a\bar{r}}
\hat{h}_{r}
\hat{h}_{a}
h_{r}
h_{a}
h_{r}(h_{a})
s^{ar}
\hat{s}^{ar}
s^{ar}
s_{t}^{\bar{a}r}
s_{t}^{a\bar{r}}
s_{t}^{\bar{a}\bar{r}}
s^{\bar{a}r}
s^{a\bar{r}}
s_{r}
s^{ar}
s^{\bar{a}r}
s^{a}
s^{ar}
s^{a\bar{r}}
s^{ar}
s^{\bar{a}r}
s^{a\bar{r}}
s^{\bar{a}\bar{r}}
\begin{array}[]{ll}\left\{\begin{array}[]{ll}\textit{Observation Model: }&p_{%
\theta}\left(o_{t}\,|\ \mathbf{s_{t}}\right)\\
\textit{Reward Model: }&p_{\theta}\left(r_{t}\,|\ s^{r}_{t}\right)\\
\textit{Transition Model: }&p_{\gamma}\left(\mathbf{s_{t}}\,|\ \mathbf{s_{t-1}%
},a_{t-1}\right)\\
\textit{Representation Model: }&q_{\phi}\left(\mathbf{s_{t}}\,|\ o_{t},\mathbf%
{s_{t-1}},a_{t-1}\right)\\
\end{array}\right.\end{array}
\begin{array}[]{ll}\textit{\ \ \small{Disentangled Transition Model:}}&\textit%
{\ \ \small{Disentangled Representation Model:}}\\
\left\{\begin{array}[]{l}p_{\gamma_{1}}\left(s^{ar}_{t}\,|\ s^{r}_{t-1},a_{t-1%
}\right)\\
p_{\gamma_{2}}\left(s^{\bar{a}r}_{t}\,|\ s^{r}_{t-1}\right)\\
p_{\gamma_{3}}\left(s^{a\bar{r}}_{t}\,|\ \mathbf{s_{t-1}},a_{t-1}\right)\\
p_{\gamma_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ \mathbf{s_{t-1}}\right)\end{%
array}\right.&\left\{\begin{array}[]{l}q_{\phi_{1}}\left(s^{ar}_{t}\,|\ o_{t},%
s^{r}_{t-1},a_{t-1}\right)\\
q_{\phi_{2}}\left(s^{\bar{a}r}_{t}\,|\ o_{t},s^{r}_{t-1}\right)\\
q_{\phi_{3}}\left(s^{a\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}},a_{t-1}\right)\\
q_{\phi_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}}\right)\end%
{array}\right.\end{array}
\max I\left(\mathbf{s_{1:T}};\left(o_{1:T},r_{1:T}\right)\mid a_{1:T}\right)-%
\beta\ \cdot I\left(\mathbf{s_{1:T}},i_{1:T}\mid a_{1:T}\right),
\beta
i_{t}
p(o_{t}|i_{t})=\delta(o_{t}-\bar{o}_{t})
\displaystyle I\left(\mathbf{s_{1:T}};\left(o_{1:T},r_{1:T}\right)\mid a_{1:T}\right)
\displaystyle I\left(\mathbf{s_{1:T}};\left(o_{1:T},r_{1:T}\right)\mid a_{1:T}\right)
\displaystyle=\mathrm{E}_{q\left(o_{1:T},r_{1:T},\mathbf{s_{1:T}},a_{1:T}%
\right)}\left(\sum_{t}\ln p\left(o_{1:T},r_{1:T}\mid\mathbf{s_{1:T}},a_{1:T}%
\right)-\ln p\left(o_{1:T},r_{1:T}\mid a_{1:T}\right)\}\right)
\displaystyle=
\displaystyle\mathrm{E}_{q\left(o_{1:T},r_{1:T},\mathbf{s_{1:T}},a_{1:T}\right%
)}\left(\sum_{t}\ln p\left(o_{1:T},r_{1:T}\mid\mathbf{s_{1:T}},a_{1:T}\right)-%
\ln p\left(o_{1:T},r_{1:T}\mid a_{1:T}\right)\}\right)
\displaystyle\pm\mathrm{E}\left(\sum_{t}\ln p\left(o_{1:T},r_{1:T}\mid\mathbf{%
s_{1:T}},a_{1:T}\right)\right)
\displaystyle\pm\mathrm{E}\left(\sum_{t}\ln p\left(o_{1:T},r_{1:T}\mid\mathbf{%
s_{1:T}},a_{1:T}\right)\right)
\displaystyle\geq\mathrm{E}\left(\sum_{t}\ln p\left(o_{1:T},r_{1:T}\mid\mathbf%
{s_{1:T}},a_{1:T}\right)\right)-\mathrm{KL}\left(p\left(o_{1:T},r_{1:T}\mid%
\mathbf{s_{1:T}},a_{1:T}\right)\|\prod_{t}p_{\theta}\left(o_{t}\mid s_{t}%
\right)p_{\theta}\left(r_{t}\mid s^{r}_{t}\right)\right)
\displaystyle\geq
\displaystyle\mathrm{E}\left(\sum_{t}\ln p\left(o_{1:T},r_{1:T}\mid\mathbf{s_{%
1:T}},a_{1:T}\right)\right)-\mathrm{KL}\left(p\left(o_{1:T},r_{1:T}\mid\mathbf%
{s_{1:T}},a_{1:T}\right)\|\prod_{t}p_{\theta}\left(o_{t}\mid s_{t}\right)p_{%
\theta}\left(r_{t}\mid s^{r}_{t}\right)\right)
\displaystyle=\mathrm{E}\left(\sum_{t}\ln p_{\theta}\left(o_{t}\mid\mathbf{s_{%
t}}\right)+\ln p_{\theta}\left(r_{t}\mid s^{r}_{t}\right)\right).
\displaystyle=
\displaystyle\mathrm{E}\left(\sum_{t}\ln p_{\theta}\left(o_{t}\mid\mathbf{s_{t%
}}\right)+\ln p_{\theta}\left(r_{t}\mid s^{r}_{t}\right)\right).
\mathcal{J}_{\mathrm{O}}^{t}=\ln p_{\theta}\left(o_{t}\mid\mathbf{s_{t}}\right%
)\quad\mathcal{J}_{\mathrm{R}}^{t}=\ln p_{\theta}\left(r_{t}\mid s^{r}_{t}\right)
\displaystyle I\left(\mathbf{s_{1:T}};i_{1:T}\mid a_{1:T}\right)
\displaystyle I\left(\mathbf{s_{1:T}};i_{1:T}\mid a_{1:T}\right)
\displaystyle=\mathrm{E}_{q\left(o_{1:T},r_{1:T},\mathbf{s_{1:T}},a_{1:T},i_{1%
:T}\right)}\left(\sum_{t}\ln q\left(\mathbf{s_{t}}\mid\mathbf{s_{t-1}},a_{t-1}%
,i_{t}\right)-\ln p\left(\mathbf{s_{t}}\mid\mathbf{s_{t-1}},a_{t-1}\right)\right)
\displaystyle=
\displaystyle\mathrm{E}_{q\left(o_{1:T},r_{1:T},\mathbf{s_{1:T}},a_{1:T},i_{1:%
T}\right)}\left(\sum_{t}\ln q\left(\mathbf{s_{t}}\mid\mathbf{s_{t-1}},a_{t-1},%
i_{t}\right)-\ln p\left(\mathbf{s_{t}}\mid\mathbf{s_{t-1}},a_{t-1}\right)\right)
\displaystyle=\mathrm{E}\left(\sum_{t}\ln q_{\phi}\left(\mathbf{s_{t}}\mid%
\mathbf{s_{t-1}},a_{t-1},o_{t}\right)-\ln p\left(\mathbf{s_{t}}\mid\mathbf{s_{%
t-1}},a_{t-1}\right)\right)
\displaystyle=
\displaystyle\mathrm{E}\left(\sum_{t}\ln q_{\phi}\left(\mathbf{s_{t}}\mid%
\mathbf{s_{t-1}},a_{t-1},o_{t}\right)-\ln p\left(\mathbf{s_{t}}\mid\mathbf{s_{%
t-1}},a_{t-1}\right)\right)
\displaystyle\leq\mathrm{E}\left(\sum_{t}\ln q_{\phi}\left(\mathbf{s_{t}}\mid%
\mathbf{s_{t-1}},a_{t-1},o_{t}\right)-\ln p_{\gamma}\left(\mathbf{s_{t}}\mid%
\mathbf{s_{t-1}},a_{t-1}\right)\right)
\displaystyle\leq
\displaystyle\mathrm{E}\left(\sum_{t}\ln q_{\phi}\left(\mathbf{s_{t}}\mid%
\mathbf{s_{t-1}},a_{t-1},o_{t}\right)-\ln p_{\gamma}\left(\mathbf{s_{t}}\mid%
\mathbf{s_{t-1}},a_{t-1}\right)\right)
\displaystyle=\mathrm{E}\left(\sum_{t}\mathrm{KL}\left(q_{\phi}\left(\mathbf{s%
_{t}}\mid\mathbf{s_{t-1}},a_{t-1},o_{t}\right)\|p_{\gamma}\left(\mathbf{s_{t}}%
\mid\mathbf{s_{t-1}},a_{t-1}\right)\right)\right).
\displaystyle=
\displaystyle\mathrm{E}\left(\sum_{t}\mathrm{KL}\left(q_{\phi}\left(\mathbf{s_%
{t}}\mid\mathbf{s_{t-1}},a_{t-1},o_{t}\right)\|p_{\gamma}\left(\mathbf{s_{t}}%
\mid\mathbf{s_{t-1}},a_{t-1}\right)\right)\right).
p_{\gamma}=p_{\gamma_{1}}\cdot p_{\gamma_{2}}\cdot p_{\gamma_{3}}\cdot p_{%
\gamma_{4}}
q_{\phi}=q_{\phi_{1}}\cdot q_{\phi_{2}}\cdot q_{\phi_{3}}\cdot q_{\phi_{4}}
\displaystyle\mathrm{KL}(q_{\phi}\|p_{\gamma})=\mathrm{KL}(q_{\phi_{1}}\cdot q%
_{\phi_{2}}\cdot q_{\phi_{3}}\cdot q_{\phi_{4}}\|p_{\gamma_{1}}\cdot p_{\gamma%
_{2}}\cdot p_{\gamma_{3}}\cdot p_{\gamma_{4}})
\displaystyle\mathrm{KL}(q_{\phi}\|p_{\gamma})
\displaystyle=\mathrm{KL}(q_{\phi_{1}}\cdot q_{\phi_{2}}\cdot q_{\phi_{3}}%
\cdot q_{\phi_{4}}\|p_{\gamma_{1}}\cdot p_{\gamma_{2}}\cdot p_{\gamma_{3}}%
\cdot p_{\gamma_{4}})
\displaystyle=E_{q_{\phi}}\left(\ln\frac{q_{\phi_{1}}}{p_{\gamma_{1}}}+ln\frac%
{q_{\phi_{2}}}{p_{\gamma_{2}}}+ln\frac{q_{\phi_{3}}}{p_{\gamma_{3}}}+ln\frac{q%
_{\phi_{4}}}{p_{\gamma_{4}}}\right)
\displaystyle=E_{q_{\phi}}\left(\ln\frac{q_{\phi_{1}}}{p_{\gamma_{1}}}+ln\frac%
{q_{\phi_{2}}}{p_{\gamma_{2}}}+ln\frac{q_{\phi_{3}}}{p_{\gamma_{3}}}+ln\frac{q%
_{\phi_{4}}}{p_{\gamma_{4}}}\right)
\displaystyle=\mathrm{KL}(q_{\phi_{1}}\|p_{\gamma_{1}})+\mathrm{KL}(q_{\phi_{2%
}}\|p_{\gamma_{2}})+\mathrm{KL}(q_{\phi_{3}}\|p_{\gamma_{3}})+\mathrm{KL}(q_{%
\phi_{4}}\|p_{\gamma_{4}})
\displaystyle=\mathrm{KL}(q_{\phi_{1}}\|p_{\gamma_{1}})+\mathrm{KL}(q_{\phi_{2%
}}\|p_{\gamma_{2}})+\mathrm{KL}(q_{\phi_{3}}\|p_{\gamma_{3}})+\mathrm{KL}(q_{%
\phi_{4}}\|p_{\gamma_{4}})
\mathcal{J}_{\mathrm{D}}^{t}=-\beta_{1}\cdot\mathrm{KL}\left(q_{\phi_{1}}\|p_{%
\gamma_{1}}\right)-\beta_{2}\cdot\mathrm{KL}\left(q_{\phi_{2}}\|p_{\gamma_{2}}%
\right)-\beta_{3}\cdot\mathrm{KL}\left(q_{\phi_{3}}\|p_{\gamma_{3}}\right)-%
\beta_{4}\cdot\mathrm{KL}\left(q_{\phi_{4}}\|p_{\gamma_{4}}\right).
s^{r}_{t}
R_{t}
a_{t-1:t}
s^{r}_{t-1}
I(s^{r}_{t},R_{t}|a_{t-1:t},s^{r}_{t-1})
a_{t}
s^{r}_{t}
a_{t}
I(s^{r}_{t},R_{t}|a_{t-1},s^{r}_{t-1})
s^{r}_{t}
I(s^{r}_{t},R_{t}|a_{t-1:t},s^{r}_{t-1})
I(s^{\bar{r}}_{t},R_{t}|a_{t-1:t},s^{r}_{t-1})
s^{\bar{r}}_{t}
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})-I(s^{\bar{r}}_{t};R%
_{t}\,|\ a_{t-1:t},s^{r}_{t-1}).
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})-I(s^{\bar{r}}_{t};R%
_{t}\,|\ a_{t-1:t},s^{r}_{t-1}).
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})=I(R_{t};s^{r}_{t},a%
_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t},s^{r}_{t-1}),
\displaystyle I(s^{r}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})
\displaystyle=I(R_{t};s^{r}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t},s^{r}%
_{t-1}),
\displaystyle I(s^{\bar{r}}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})=I(R_{t};s^{%
\bar{r}}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t},s^{r}_{t-1}).
\displaystyle I(s^{\bar{r}}_{t};R_{t}\,|\,a_{t-1:t},s^{r}_{t-1})
\displaystyle=I(R_{t};s^{\bar{r}}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};a_{t-1:t}%
,s^{r}_{t-1}).
I(R_{t};s^{r}_{t},a_{t-1:t},s^{r}_{t-1})-I(R_{t};s^{\bar{r}}_{t},a_{t-1:t},s^{%
r}_{t-1}).
\displaystyle I(X;Y)=D_{KL}(p(x,y)\|p(x)p(y))
\displaystyle I(X;Y)
\displaystyle=D_{KL}(p(x,y)\|p(x)p(y))
\displaystyle=\sup_{T\in\mathcal{T}}{\mathbb{E}}_{p(x,y)}[T(x,y)]-\log{\mathbb%
{E}_{p(x)p(y)}}[e^{T(x,y)}].
\displaystyle=\sup_{T\in\mathcal{T}}{\mathbb{E}}_{p(x,y)}[T(x,y)]-\log{\mathbb%
{E}_{p(x)p(y)}}[e^{T(x,y)}].
T
(x,y)
\alpha
x
y
\mathcal{J}_{\mathrm{RS}}^{t}=\lambda_{1}\cdot\big{\{}I_{\alpha_{1}}(R_{t};s^{%
r}_{t},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))-I_{\alpha_{2}}(R_{t};s^{\bar{r}}_{t%
},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))\big{\}}.
s^{r}_{t-1}
s^{a}_{t}
s^{\bar{a}}_{t}
I(s^{a}_{t};a_{t-1}\,|\ \mathbf{s_{t-1}})-I(s^{\bar{a}}_{t},a_{t-1}|\mathbf{s_%
{t-1}}),
\mathcal{J}_{\mathrm{AS}}^{t}=\lambda_{2}\cdot\big{\{}I_{\alpha_{3}}(a_{t-1};s%
^{a}_{t},\mathbf{sg}(\mathbf{s_{t-1}}))-I_{\alpha_{4}}(a_{t-1};s^{\bar{a}}_{t}%
,\mathbf{sg}(\mathbf{s_{t-1}}))\big{\}}.
\alpha_{1},\alpha_{2},\alpha_{3},\alpha_{4}
s^{r}_{t}
s^{\bar{r}}_{t}
s^{a}_{t}
s^{\bar{a}}_{t}
\displaystyle\mathcal{J}_{\mathrm{TOTAL}}=\max_{\phi,\theta,\gamma,\alpha_{1},%
\alpha_{3}}\min_{\alpha_{2}\alpha_{4}}\mathrm{E}_{q_{\phi}}\left(\sum_{t}\left%
(\mathcal{J}_{\mathrm{O}}^{t}+\mathcal{J}_{\mathrm{R}}^{t}+\mathcal{J}_{%
\mathrm{D}}^{t}+\mathcal{J}_{\mathrm{RS}}^{t}+\mathcal{J}_{\mathrm{AS}}^{t}%
\right)\right)+\text{ const }
\displaystyle\mathcal{J}_{\mathrm{TOTAL}}
\displaystyle=\max_{\phi,\theta,\gamma,\alpha_{1},\alpha_{3}}\min_{\alpha_{2}%
\alpha_{4}}\mathrm{E}_{q_{\phi}}\left(\sum_{t}\left(\mathcal{J}_{\mathrm{O}}^{%
t}+\mathcal{J}_{\mathrm{R}}^{t}+\mathcal{J}_{\mathrm{D}}^{t}+\mathcal{J}_{%
\mathrm{RS}}^{t}+\mathcal{J}_{\mathrm{AS}}^{t}\right)\right)+\text{ const }
\displaystyle=\max_{\phi,\theta,\gamma,\alpha_{1},\alpha_{3}}\min_{\alpha_{2},%
\alpha_{4}}\mathbb{E}_{q_{\phi}}\big{\{}\log p_{\theta}(o_{t}\,|\ \mathbf{s_{t%
}})+\log p_{\theta}(r_{t}\,|\ s^{r}_{t})
\displaystyle=\max_{\phi,\theta,\gamma,\alpha_{1},\alpha_{3}}\min_{\alpha_{2},%
\alpha_{4}}\mathbb{E}_{q_{\phi}}\big{\{}\log p_{\theta}(o_{t}\,|\ \mathbf{s_{t%
}})+\log p_{\theta}(r_{t}\,|\ s^{r}_{t})
\displaystyle\ \ \ \ \ \ \ -\sum_{i=1}^{4}\beta_{i}\cdot\text{KL}\big{(}q_{%
\phi_{i}}\|p_{\gamma_{i}}\big{)}+\lambda_{1}\cdot(I_{\alpha_{1}}-I_{\alpha_{2}%
})+\lambda_{2}\cdot(I_{\alpha_{3}}-I_{\alpha_{4}})\big{\}}+\text{ const }.
\displaystyle\ \ \ \ \ \ \ -\sum_{i=1}^{4}\beta_{i}\cdot\text{KL}\big{(}q_{%
\phi_{i}}\|p_{\gamma_{i}}\big{)}+\lambda_{1}\cdot(I_{\alpha_{1}}-I_{\alpha_{2}%
})+\lambda_{2}\cdot(I_{\alpha_{3}}-I_{\alpha_{4}})\big{\}}+\text{ const }.
\displaystyle\mathcal{J}_{\mathrm{O}}^{t}=\ln p_{\theta}\left(o_{t}\mid\mathbf%
{s_{t}}\right),\quad\mathcal{J}_{\mathrm{R}}^{t}=\ln p_{\theta}\left(r_{t}\mid
s%
^{r}_{t}\right),\quad\mathcal{J}_{\mathrm{D}}^{t}=-\mathrm{KL}\left(q_{\phi}\|%
p_{\gamma})\right),
\displaystyle\mathcal{J}_{\mathrm{O}}^{t}=\ln p_{\theta}\left(o_{t}\mid\mathbf%
{s_{t}}\right),\quad\mathcal{J}_{\mathrm{R}}^{t}=\ln p_{\theta}\left(r_{t}\mid
s%
^{r}_{t}\right),\quad\mathcal{J}_{\mathrm{D}}^{t}=-\mathrm{KL}\left(q_{\phi}\|%
p_{\gamma})\right),
\displaystyle\mathcal{J}_{\mathrm{RS}}^{t}=\lambda_{1}\cdot\big{\{}I_{\alpha_{%
1}}(R_{t};s^{r}_{t},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))-I_{\alpha_{2}}(R_{t};s%
^{\bar{r}}_{t},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))\big{\}},
\displaystyle\mathcal{J}_{\mathrm{RS}}^{t}=\lambda_{1}\cdot\big{\{}I_{\alpha_{%
1}}(R_{t};s^{r}_{t},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))-I_{\alpha_{2}}(R_{t};s%
^{\bar{r}}_{t},a_{t-1:t},\mathbf{sg}(s^{r}_{t-1}))\big{\}},
\displaystyle\mathcal{J}_{\mathrm{AS}}^{t}=\lambda_{2}\cdot\big{\{}I_{\alpha_{%
3}}(a_{t-1};s^{a}_{t},\mathbf{sg}(\mathbf{s_{t-1}}))-I_{\alpha_{4}}(a_{t-1};s^%
{\bar{a}}_{t},\mathbf{sg}(\mathbf{s_{t-1}}))\big{\}},
\displaystyle\mathcal{J}_{\mathrm{AS}}^{t}=\lambda_{2}\cdot\big{\{}I_{\alpha_{%
3}}(a_{t-1};s^{a}_{t},\mathbf{sg}(\mathbf{s_{t-1}}))-I_{\alpha_{4}}(a_{t-1};s^%
{\bar{a}}_{t},\mathbf{sg}(\mathbf{s_{t-1}}))\big{\}},
\displaystyle\mathcal{J}^{t}_{D_{1}}=-\beta_{1}\cdot\mathrm{KL}(q_{\phi_{1}}%
\left(s^{ar}_{t}\,|\ o_{t},s^{r}_{t-1},a_{t-1}\right)\|p_{\gamma_{1}}\left(s^{%
ar}_{t}\,|\ s^{r}_{t-1},a_{t-1}\right))
\displaystyle\mathcal{J}^{t}_{D_{1}}
\displaystyle=-\beta_{1}\cdot\mathrm{KL}(q_{\phi_{1}}\left(s^{ar}_{t}\,|\ o_{t%
},s^{r}_{t-1},a_{t-1}\right)\|p_{\gamma_{1}}\left(s^{ar}_{t}\,|\ s^{r}_{t-1},a%
_{t-1}\right))
\displaystyle\mathcal{J}^{t}_{D_{2}}=-\beta_{2}\cdot\mathrm{KL}(q_{\phi_{2}}%
\left(s^{\bar{a}r}_{t}\,|\ o_{t},s^{r}_{t-1}\right)\|p_{\gamma_{2}}\left(s^{%
\bar{a}r}_{t}\,|\ s^{r}_{t-1}\right))
\displaystyle\mathcal{J}^{t}_{D_{2}}
\displaystyle=-\beta_{2}\cdot\mathrm{KL}(q_{\phi_{2}}\left(s^{\bar{a}r}_{t}\,|%
\ o_{t},s^{r}_{t-1}\right)\|p_{\gamma_{2}}\left(s^{\bar{a}r}_{t}\,|\ s^{r}_{t-%
1}\right))
\displaystyle\mathcal{J}^{t}_{D_{3}}=-\beta_{3}\cdot\mathrm{KL}(q_{\phi_{3}}%
\left(s^{a\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}},a_{t-1}\right)\|p_{\gamma_{3%
}}\left(s^{a\bar{r}}_{t}\,|\ \mathbf{s_{t-1}},a_{t-1}\right))
\displaystyle\mathcal{J}^{t}_{D_{3}}
\displaystyle=-\beta_{3}\cdot\mathrm{KL}(q_{\phi_{3}}\left(s^{a\bar{r}}_{t}\,|%
\ o_{t},\mathbf{s_{t-1}},a_{t-1}\right)\|p_{\gamma_{3}}\left(s^{a\bar{r}}_{t}%
\,|\ \mathbf{s_{t-1}},a_{t-1}\right))
\displaystyle\mathcal{J}^{t}_{D_{4}}=-\beta_{4}\cdot\mathrm{KL}(q_{\phi_{4}}%
\left(s^{\bar{a}\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}}\right)\|p_{\gamma_{4}}%
\left(s^{\bar{a}\bar{r}}_{t}\,|\ \mathbf{s_{t-1}}\right)).
\displaystyle\mathcal{J}^{t}_{D_{4}}
\displaystyle=-\beta_{4}\cdot\mathrm{KL}(q_{\phi_{4}}\left(s^{\bar{a}\bar{r}}_%
{t}\,|\ o_{t},\mathbf{s_{t-1}}\right)\|p_{\gamma_{4}}\left(s^{\bar{a}\bar{r}}_%
{t}\,|\ \mathbf{s_{t-1}}\right)).
I_{\alpha_{1}}
\mathcal{J}_{\mathrm{RS}}^{t}
R_{t}
s^{r}_{t-1}
(s^{r}_{t-1},a_{t-1:t})
\mathcal{J}^{t}_{\mathrm{R}}
r_{t}
s^{r}_{t}
R_{t}
I_{\alpha_{2}}
\mathcal{J}_{\mathrm{RS}}^{t}
s^{\bar{r}}_{t}
s^{\bar{r}}_{t}
R_{t}
(s^{r}_{t-1},a_{t-1:t})
s^{\bar{r}}_{t}
R_{t}
(s^{r}_{t-1},a_{t-1:t})
s^{r}_{t-1},a_{t-1:t}
s^{r}_{t-1}
s^{\bar{r}}_{t}
R_{t}
s^{\bar{r}}_{t}
R_{t}
s^{\bar{r}}_{t}
I_{\alpha_{2}}
I_{\alpha_{3}}
I_{\alpha_{4}}
\mathcal{J}_{\mathrm{AS}}^{t}
s^{a}_{t}
(a_{t-1},\mathbf{s_{t-1}})
s^{\bar{a}}_{t}
s^{ar}_{t}
s^{a\bar{r}}_{t}
a_{t-1}
s^{a}_{t}
a_{t-1}
s^{\bar{a}r}_{t}
s^{\bar{a}\bar{r}}_{t}
a_{t-1}
s^{a}_{t}
a_{t-1}
\mathcal{J}_{\mathrm{RS}}^{t}
\mathcal{J}_{\mathrm{AS}}^{t}
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
(\beta_{1},\beta_{2},\beta_{3},\beta_{4})
\beta_{1}
\beta_{2}
\beta_{3}
\beta_{4}
\tau\geq 1
\tau=1
\begin{array}[]{ll}\begin{array}[]{ll}\left\{\begin{array}[]{ll}\textit{%
Observation Model: }&p_{\theta}\left(o_{t}\,|\ \mathbf{s_{t}}\right)\\
\textit{Reward Model: }&p_{\theta}\left(r_{t}\,|\ s^{r}_{t}\right)\\
\textit{Transition Model: }&p_{\gamma}\left(\mathbf{s_{t}}\,|\ \mathbf{s_{t-%
\tau:t-1}},a_{t-\tau:t-1}\right)\\
\end{array}\right.&\textit{Transition}:\left\{\begin{array}[]{l}p_{\gamma_{1}}%
\left(s^{ar}_{t}\,|\ s^{r}_{t-\tau:t-1},a_{t-\tau:t-1}\right)\\
p_{\gamma_{2}}\left(s^{\bar{a}r}_{t}\,|\ s^{r}_{t-\tau:t-1}\right)\\
p_{\gamma_{3}}\left(s^{a\bar{r}}_{t}\,|\ \mathbf{s_{t-\tau:t-1}},a_{t-\tau:t-1%
}\right)\\
p_{\gamma_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ \mathbf{s_{t-\tau:t-1}}\right)%
\end{array}\right.\par\end{array}\end{array}\vspace{-5.5pt}
\mathbf{s_{t}}
s^{ar}_{t}=s^{\bar{a}r}_{t}=s^{a\bar{r}}_{t}=s^{\bar{a}\bar{r}}_{t}=2
a_{t}
\tau=2
p_{\theta}\left(o_{t},|\ \mathbf{s_{t}}\right)
p_{\theta}\left(r_{t},|\ s^{r}_{t}\right)
r_{t}
p_{\gamma_{1}}
p_{\gamma_{2}}
p_{\gamma_{3}}
p_{\gamma_{4}}
\sigma=0.1
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Ctrl}\mkern-1.5mu}\mkern 1.5mu+%
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Rew}\mkern-1.5mu}\mkern 1.5mu
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Ctrl}\mkern-1.5mu}\mkern 1.5mu+%
\textbf{Rew}
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Ctrl}\mkern-1.5mu}\mkern 1.5mu+%
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Rew}\mkern-1.5mu}\mkern 1.5mu
\textbf{Ctrl}+\textbf{Rew}
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Ctrl}\mkern-1.5mu}\mkern 1.5mu+%
\textbf{Rew}
\textbf{Ctrl}+\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Rew}\mkern-1.5mu}%
\mkern 1.5mu
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Ctrl}\mkern-1.5mu}\mkern 1.5mu+%
\mkern 1.5mu\overline{\mkern-1.5mu\textbf{Rew}\mkern-1.5mu}\mkern 1.5mu
s^{*}_{t}
R_{t}
(s_{t-1},a_{t-1:t})
s^{a\bar{r}}_{t}
s^{*}_{t}
R_{t}
(s_{t-1},a_{t-1:t})
s^{a\bar{r}}_{t}
\beta_{1}=\beta_{2}=\beta_{3}=\beta_{4}=0.003
\lambda_{1}
\lambda_{2}
J^{t}_{\mathrm{RS}}
J^{t}_{\mathrm{AS}}
J^{t}_{\mathrm{RS}}
I_{\alpha_{1}}-I_{\alpha_{2}}
J^{t}_{\mathrm{AS}}
I_{\alpha_{3}}-I_{\alpha_{4}}
s^{ar}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{ar}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{ar}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{ar}_{t}
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
o_{1:T}
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\hat{s}_{1:T}
\times
\times
\times
\times
\times
\times
\mathbf{\hat{o}}_{1:T}
\times
\times
\hat{s}_{1:T}
\times
\times
\times
\times
s^{ar}_{t}
s^{r}_{1:T},a_{1:T}
\times
\times
s^{r}_{t}
s^{ar}_{t}
\times
\times
s^{ar}_{t}
s^{\bar{a}r}_{t}
s^{r}_{1:T}
\times
\times
s^{r}_{t}
s^{\bar{a}r}_{t}
\times
\times
s^{\bar{a}r}_{t}
s^{a\bar{r}}_{t}
\mathbf{s_{1:T}},a_{1:T}
\times
\times
s^{a\bar{r}}_{t}
\times
\times
s^{a\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
\mathbf{s_{1:T}}
\times
\times
s^{\bar{a}\bar{r}}_{t}
\times
\times
s^{\bar{a}\bar{r}}_{t}
I_{\alpha_{1}}-I_{\alpha_{2}}
I_{\alpha_{3}}-I_{\alpha_{4}}
I_{\alpha_{2}}
I_{\alpha_{2}}
s^{\bar{r}}_{t}
s^{\bar{a}}_{t}
\beta_{1}=\beta_{2}=\beta_{3}=\beta_{4}=0.1
\lambda_{1}=\lambda_{2}=0.1
64\times 64
\beta_{1}=\beta_{2}=2
\beta_{3}=\beta_{4}=0.25
\lambda_{1}=\lambda_{2}=0.1
\mathcal{J}^{t}_{RS}
\mathcal{J}^{t}_{AS}
s^{r}_{t}
s^{r}_{t}
\beta_{1}=\beta_{2}=\beta_{3}=\beta_{4}=1
\beta_{1}=\beta_{2}=1
\beta_{3}=\beta_{4}=0.25
\beta_{1}=\beta_{2}=2
\beta_{3}=\beta_{4}=0.25
\beta_{1}=\beta_{2}=1
\beta_{3}=\beta_{4}=0.25
\lambda_{1}=\lambda_{2}=0.1
\lambda_{1}=\lambda_{2}=0
[3,96,96]
[32,47,47]
[64,22,22]
[128,10,10]
[256,4,4]
[256,2,2]
[1024]
(96\times 96)
(64\times 64)
(96\times 96)
(64\times 64)
[\texttt{input\_size}]
[1024,1,1]
[128,3,3]
[128,9,9]
[64,21,21]
[32,46,46]
[3,96,96]
(96\times 96)
(64\times 64)
(96\times 96)
(64\times 64)
J^{t}_{RS}
J^{t}_{AS}
I_{\alpha_{1}}-I_{\alpha_{2}}
I_{\alpha_{3}}-I_{\alpha_{4}}
I_{\alpha_{3}}-I_{\alpha_{4}}
s^{a}_{t}
s^{a}_{t}
s^{r}_{t}=(s^{ar}_{t},s^{\bar{a}r}_{t})
s^{\bar{a}\bar{r}}_{t}
s^{\bar{a}\bar{r}}_{t}
s^{\bar{r}}_{t}=(s^{a\bar{r}}_{t},s^{\bar{a}\bar{r}}_{t})
s^{r}_{t}
s^{ar}_{t}
s^{r}_{t}
s^{\bar{r}}_{t}
s^{r}_{t}
x_{t}
y_{t}
r_{y_{t}}
r_{x_{t}}
s^{\bar{a}r}_{t}
x_{t}
x_{t}
z_{t}
y_{t}
z_{t},
\begin{array}[]{ll}\text{\ \ Prior:}&\text{\ \ Posterior:}\\
\left\{\begin{array}[]{l}p_{\gamma_{1}}\left(s^{ar}_{t}\,|\ s^{r}_{t-1},a_{t-1%
}\right)\\
p_{\gamma_{2}}\left(s^{\bar{a}r}_{t}\,|\ s^{r}_{t-1}\right)\\
p_{\gamma_{3}}\left(s^{a\bar{r}}_{t}\,|\ \mathbf{s_{t-1}},a_{t-1}\right)\\
p_{\gamma_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ \mathbf{s_{t-1}}\right)\end{%
array}\right.&\left\{\begin{array}[]{l}q_{\phi_{1}}\left(s^{ar}_{t}\,|\ o_{t},%
s^{r}_{t-1},a_{t-1}\right)\\
q_{\phi_{2}}\left(s^{\bar{a}r}_{t}\,|\ o_{t},s^{r}_{t-1}\right)\\
q_{\phi_{3}}\left(s^{a\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}},a_{t-1}\right)\\
q_{\phi_{4}}\left(s^{\bar{a}\bar{r}}_{t}\,|\ o_{t},\mathbf{s_{t-1}}\right)\end%
{array}\right.\end{array}
\begin{array}[]{ll}\text{\ \ Prior:}&\text{\ \ Posterior:}\\
\left\{\begin{array}[]{l}p_{\gamma_{1}}\left(x_{t}\,|\ x_{t-1},a_{t-1}\right)%
\\
p_{\gamma_{2}}\left(y_{t}\,|\ y_{t-1}\right)\\
p_{\gamma_{3}}\left(z_{t}\,|\ x_{t},y_{t},z_{t-1}\right)\end{array}\right.&%
\left\{\begin{array}[]{l}p_{\phi_{1}}\left(x_{t}\,|\ x_{t-1},y_{t-1},z_{t-1},o%
_{t},a_{t-1}\right)\\
p_{\phi_{2}}\left(y_{t}\,|\ x_{t-1},y_{t-1},z_{t-1},o_{t},a_{t-1}\right)\\
p_{\phi_{3}}\left(z_{t}\,|\ x_{t},y_{t},o_{t},a_{t-1}\right)\end{array}\right.%
\end{array}
x_{t}
y_{t}
s^{r}_{t-1}
s^{ar}_{t}
s^{\bar{a}r}_{t}
y_{t}
a_{t-1}
x_{t}
z_{t-1}
z_{t-1}
x_{t}
\mathcal{J}^{t}_{\mathrm{RS}}
\mathcal{J}^{t}_{\mathrm{AS}}
