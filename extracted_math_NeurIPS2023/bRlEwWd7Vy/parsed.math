\varphi
\varphi
\chi^{2}
\mathsf{D}
p
\displaystyle\braces{q:\mathsf{D}(p,q)\leq\varepsilon},
\displaystyle\braces{q:\mathsf{D}(p,q)\leq\varepsilon},
\varepsilon>0
\varepsilon
\mathsf{D}
p
q
\varepsilon
\mathsf{D}
\varphi
f
\mathsf{D}
\mathsf{D}
\mathsf{D}
\varphi
M
M
\varphi
\chi^{2}
\varphi
\varphi
\chi^{2}
\varepsilon
\mathsf{D}
\mathsf{D}
\chi^{2}
\varphi
\varphi
\varphi
\chi^{2}
\varphi
\chi^{2}
f:\mathcal{X}\to\mathbb{R}
\mathcal{X}\subseteq\mathbb{R}^{d}
f
t
\mathbf{x}_{t}\in\mathcal{X}
y_{t}=f(\mathbf{x}_{t})+\eta_{t}
\eta_{t}\sim\mathcal{N}(0,\sigma^{2}_{f})
\sigma^{2}_{f}
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}f(\mathbf{x}).
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}f(\mathbf{x}).
\mathcal{X}
\mathcal{C}
f:\mathcal{X}\times\mathcal{C}\to\mathbb{R}
\mathcal{X}
t
\mathbf{x}_{t}\in\mathcal{X}
c_{t}\in\mathcal{C}
f(\mathbf{x}_{t},c_{t})+\eta_{t}
c_{t}
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\E_{c\sim p}[f(\mathbf{x},c)],
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\E_{c\sim p}[f(\mathbf{x},c)],
p
f
f
\left\{\mathbf{x}_{i},f(\mathbf{x}_{i})\right\}
\displaystyle f(\mathbf{x})\sim\text{GP}\left(m(\mathbf{x}),k(\mathbf{x},%
\mathbf{x}^{\prime})\right),
\displaystyle f(\mathbf{x})\sim\text{GP}\left(m(\mathbf{x}),k(\mathbf{x},%
\mathbf{x}^{\prime})\right),
m\left(\mathbf{x}\right)
k\left(\mathbf{x},\mathbf{x}^{\prime}\right)
m(\mathbf{x})=\mathbb{E}\left[f(\mathbf{x})\right]
k(\mathbf{x},\mathbf{x}^{\prime})=\mathbb{E}\left[(f(\mathbf{x})-m(\mathbf{x})%
)(f(\mathbf{x}^{\prime})-m(\mathbf{x}^{\prime}))^{T}\right]
f_{*}=f\left(\mathbf{x}_{*}\right)
\mathbf{x}_{*}
p\bigl{(}f_{*}\mid\mathbf{x}_{*},[\mathbf{x}_{1}...\mathbf{x}_{N}],[y_{1},...y%
_{N}]\bigr{)}\sim\mathcal{N}\left(\mu\left(\mathbf{x}_{*}\right),\sigma^{2}%
\left(\mathbf{x}_{*}\right)\right)
\displaystyle\mu\left(\mathbf{x}_{*}\right)=\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{%
-1}\mathbf{y},
\displaystyle\mu\left(\mathbf{x}_{*}\right)=
\displaystyle\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{-1}\mathbf{y},
\displaystyle\sigma^{2}\left(\mathbf{x}_{*}\right)=k_{**}-\mathbf{k}_{*,N}%
\mathbf{K}_{N,N}^{-1}\mathbf{k}_{*,N}^{T}
\displaystyle\sigma^{2}\left(\mathbf{x}_{*}\right)=
\displaystyle k_{**}-\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{-1}\mathbf{k}_{*,N}^{T}
k_{**}=k\left(\mathbf{x}_{*},\mathbf{x}_{*}\right)
\mathbf{k}_{*,N}=[k\left(\mathbf{x}_{*},\mathbf{x}_{i}\right)]_{\forall i\leq N}
\bm{K}_{N,N}=\left[k\left(\mathbf{x}_{i},\mathbf{x}_{j}\right)\right]_{\forall
i%
,j\leq N}
\Delta(\mathcal{C})
\mathcal{C}
\mathsf{D}:\Delta(\mathcal{C})\times\Delta(\mathcal{C})\to\mathbb{R}
\Delta(p,q)\geq 0
p=q
p,q\in\Delta(\mathcal{C})
h:\mathcal{C}\to\mathbb{R}
p\in\Delta(\mathcal{C})
\displaystyle\sup_{q\in B_{\varepsilon,\mathsf{D}}(p)}\E_{q(c)}[h(c)],
\displaystyle\sup_{q\in B_{\varepsilon,\mathsf{D}}(p)}\E_{q(c)}[h(c)],
B_{\varepsilon,\mathsf{D}}(p)=\braces{q\in\Delta(\mathcal{C}):\mathsf{D}(p,q)%
\leq\varepsilon}
q
\varepsilon
p
\mathsf{D}
\mathcal{C}
\mathsf{D}
\varphi
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\varepsilon,D}(p)}\E%
_{c\sim q}[f(\mathbf{x},c)],
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\varepsilon,D}(p)}\E%
_{c\sim q}[f(\mathbf{x},c)],
p
\mathsf{D}
O(n^{2})
n
\mathsf{D}
\phi
\chi^{2}
\phi
\varphi
\phi
\phi:\mathbb{R}\to(-\infty,\infty]
\phi(1)=0
\phi
p,q\in\Delta(\mathcal{C})
\displaystyle\mathsf{D}_{\phi}(p,q)=\E_{q(c)}\left[\phi\bracket{\frac{dp}{dq}(%
c)}\right]
\displaystyle\mathsf{D}_{\phi}(p,q)=\E_{q(c)}\left[\phi\bracket{\frac{dp}{dq}(%
c)}\right]
dp/dq
p\ll q
\mathsf{D}_{\varphi}(p,q)=+\infty
\phi
\phi(u)=(u-1)^{2}
\chi^{2}
\phi(u)=\card{u-1}
\phi(u)=u\log u
\chi^{2}
t\geq 1
\phi
\phi
\displaystyle B_{\phi}^{t}(p_{t}):=\braces{q\in\Delta(\mathcal{C}):\mathsf{D}_%
{\phi}(q,p_{t})\leq\varepsilon_{t}},
\displaystyle B_{\phi}^{t}(p_{t}):=\braces{q\in\Delta(\mathcal{C}):\mathsf{D}_%
{\phi}(q,p_{t})\leq\varepsilon_{t}},
p_{t}=\frac{1}{t}\sum_{s=1}^{t}\delta_{c_{s}}
\varepsilon_{t}
t
p_{t}
\varphi
p,q
B_{\varphi}^{t}
\varphi
\varphi
\varphi
\varphi
\phi^{\star}(u)=\sup_{u^{\prime}\in\operatorname{dom}_{\phi}}\bracket{u\cdot u%
^{\prime}-\phi(u^{\prime})}
\varphi
\phi:\mathbb{R}\to(-\infty,\infty]
\phi(1)=0
f
\epsilon>0
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X},\lambda\geq 0,b\in%
\mathbb{R}}\bracket{b-\lambda\epsilon_{t}-\lambda\E_{p_{t}(c)}\left[\varphi^{%
\star}\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X},\lambda\geq 0,b\in%
\mathbb{R}}\bracket{b-\lambda\epsilon_{t}-\lambda\E_{p_{t}(c)}\left[\varphi^{%
\star}\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]}.
\varphi
f
\lambda\geq 0
b\in\mathbb{R}
1
\mathcal{C}
\phi
b
\lambda
\chi^{2}
\phi(u)=(u-1)^{2}
f
\varepsilon_{t}
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p_{t})}\E_%
{c\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p_{t}(c%
)}[f(\mathbf{x},c)]-\sqrt{\varepsilon_{t}\cdot\operatorname{Var}_{p_{t}(c)}[f(%
\mathbf{x},c)]}}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p_{t})}\E_%
{c\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p_{t}(c%
)}[f(\mathbf{x},c)]-\sqrt{\varepsilon_{t}\cdot\operatorname{Var}_{p_{t}(c)}[f(%
\mathbf{x},c)]}}.
\chi^{2}
\varphi
\mathsf{D}_{\varphi}
\chi^{2}
\chi^{2}
\varphi
\varphi(u)=\card{u-1}
f
\varepsilon_{t}
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p_{t})}\E_%
{c\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p_{t}(c%
)}[f(\mathbf{x},c)]-\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C}}f(%
\mathbf{x},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x},c)}}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p_{t})}\E_%
{c\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p_{t}(c%
)}[f(\mathbf{x},c)]-\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C}}f(%
\mathbf{x},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x},c)}}.
\chi^{2}
\varphi
\varphi
\phi
\mathbf{x}_{t}
c_{t}\sim q
y_{t}=f(\mathbf{x}_{t},c_{t})+\eta_{t}
\eta_{t}\sim\mathcal{N}(0,\sigma^{2}_{f})
\sigma^{2}_{f}
\varphi
\varphi
T
D_{0}
\eta
t=1,\dots,T
D_{t-1}
\mathbf{x}_{t}=\arg\max\alpha(\mathbf{x})
\chi^{2}
\alpha(\mathbf{x}):=\alpha^{\chi^{2}}(\mathbf{x})
\alpha(\mathbf{x}):=\alpha^{TV}(\mathbf{x})
c_{t}\sim q
y_{t}=f(\mathbf{x}_{t},c_{t})+\eta_{t}
D_{t}=D_{t-1}\cup\left(\mathbf{x}_{t},c_{t},y_{t}\right)
t
\{\mathbf{x}_{i},y_{i}\}_{i=1}^{t-1}
\displaystyle\mathbf{x}_{t}=\arg\max_{\mathbf{x}\in\mathcal{X}}\alpha(\mathbf{%
x}).
\displaystyle\mathbf{x}_{t}=\arg\max_{\mathbf{x}\in\mathcal{X}}\alpha(\mathbf{%
x}).
\chi^{2}
\displaystyle\alpha^{\chi^{2}}(\mathbf{x}):=\frac{1}{|C|}\sum_{c}\left[\mu_{t}%
(\mathbf{x},c)+\sqrt{\beta_{t}}\sigma_{t}(\mathbf{x},c)\right]-\sqrt{\frac{%
\epsilon_{t}}{|C|}\sum_{c}\big{(}\mu_{t}(\mathbf{x},c)-\bar{\mu_{t}}\big{)}^{2}}
\displaystyle\alpha^{\chi^{2}}(\mathbf{x}):=
\displaystyle\frac{1}{|C|}\sum_{c}\left[\mu_{t}(\mathbf{x},c)+\sqrt{\beta_{t}}%
\sigma_{t}(\mathbf{x},c)\right]-\sqrt{\frac{\epsilon_{t}}{|C|}\sum_{c}\big{(}%
\mu_{t}(\mathbf{x},c)-\bar{\mu_{t}}\big{)}^{2}}
\beta_{t}
\bar{\mu_{t}}=\frac{1}{|C|}\sum_{c}\mu_{t}(\mathbf{x},c)
c\sim q
q
\displaystyle\alpha^{TV}(\mathbf{x}):=\frac{1}{|C|}\sum_{c}\left[\mu_{t}(%
\mathbf{x},c)+\sqrt{\beta_{t}}\sigma_{t}(\mathbf{x},c)\right]-\frac{\epsilon_{%
t}}{2}\big{(}\max\mu_{t}(\mathbf{x},c)-\min\mu_{t}(\mathbf{x},c)\big{)}.
\displaystyle\alpha^{TV}(\mathbf{x}):=
\displaystyle\frac{1}{|C|}\sum_{c}\left[\mu_{t}(\mathbf{x},c)+\sqrt{\beta_{t}}%
\sigma_{t}(\mathbf{x},c)\right]-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(%
\mathbf{x},c)-\min\mu_{t}(\mathbf{x},c)\big{)}.
|C|
q
t
|C|
\epsilon=\{0.5,1\}
\epsilon=\{0.5,1\}
\epsilon\rightarrow 0
\epsilon\rightarrow 0
f(\mathbf{x},c)
\mathbf{x}_{t}
\epsilon
f(\mathbf{x},c)
\mathbf{x}_{t}
\epsilon
O(t^{-1/2})
\varphi
\varphi
R_{T}
\varphi
\displaystyle R_{T}(\varphi)=\sum_{t=1}^{T}\inf_{q\in B_{\phi}^{t}}\E_{q(c)}[f%
(\mathbf{x}_{t}^{\ast},c)]-\inf_{q\in B_{\phi}^{t}}\E_{q(c)}[f(\mathbf{x}_{t},%
c)],
\displaystyle R_{T}(\varphi)=\sum_{t=1}^{T}\inf_{q\in B_{\phi}^{t}}\E_{q(c)}[f%
(\mathbf{x}_{t}^{\ast},c)]-\inf_{q\in B_{\phi}^{t}}\E_{q(c)}[f(\mathbf{x}_{t},%
c)],
\mathbf{x}_{t}^{\ast}=\arg\max_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{%
\varepsilon,\phi}^{t}}\E_{q(c)}[f(\mathbf{x},c)]
\bm{K}_{t}
D_{t}=\braces{(\mathbf{x}_{i},c_{i})}_{i=1}^{t}\subset\mathcal{X}\times%
\mathcal{C}
\gamma_{t}=\max_{D\subset\mathcal{X}\times\mathcal{C}:\card{D}=t}\log\det%
\bracket{\mathbf{I}_{t}+\sigma^{-2}_{f}\bm{K}_{t}}
\bm{K}_{t}=\left[k\left([\mathbf{x}_{i},c_{i}],[\mathbf{x}_{j},c_{j}]\right)%
\right]_{\forall i,j\leq t}
\sigma^{2}_{f}
\varphi
M=\sup_{(\mathbf{x},c)\in\mathcal{X}\times\mathcal{C}}\card{f(\mathbf{x},c)}<\infty
f
k
\varphi:\mathbb{R}\to(-\infty,\infty]
\varphi(1)=0
\Gamma_{\varphi}:[0,\infty)\to\mathbb{R}
\operatorname{TV}(p,q)\leq\Gamma_{\varphi}(\mathsf{D}_{\varphi}(p,q))
\displaystyle R_{T}(\varphi)\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+%
\sigma^{-2}_{f})}+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\Gamma_{%
\varphi}(\varepsilon_{t}),
\displaystyle R_{T}(\varphi)\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+%
\sigma^{-2}_{f})}+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\Gamma_{%
\varphi}(\varepsilon_{t}),
1-\delta
\beta_{t}=2||f||^{2}_{k}+300\gamma_{t}\ln^{3}(t/\delta)
\gamma_{t}
\sigma_{f}
f
\gamma_{T}
\mathcal{X}\times\mathcal{C}\subset\mathbb{R}^{d+1}
\gamma_{T}\leq\mathcal{O}\left(\log(T)^{d+2}\right)
\nu>1
\gamma_{T}\leq\mathcal{O}\left(T^{\frac{(d+1)(d+2)}{2\nu+(d+1)(d+2)}}(\log T)\right)
\varepsilon_{t}=0
\Gamma_{\varphi}
\Gamma_{\varphi}(0)=0
\varepsilon_{t}=\Gamma_{\varphi}^{-1}\bracket{\frac{1}{\sqrt{t}+\sqrt{t+1}}}
\sum_{t=1}^{T}\varepsilon_{t}\leq\sqrt{T}
\Gamma_{\varphi}
\varphi
D_{\varphi}
\Gamma_{\varphi}(t)=t
\chi^{2}
\operatorname{KL}
\Gamma_{\chi^{2}}(b)=2\sqrt{\frac{b}{1+b}}
\Gamma_{\operatorname{KL}}(b)=1-\exp(-b)
30
|C|=30
c\stackrel{{\scriptstyle\textrm{iid}}}{{\sim}}q
\mathbf{x}_{t}
c_{t}
c_{t}
\mathbf{x}_{t}=\argmax_{\mathbf{x}}\mu(\mathbf{x})+\beta_{t}\sigma(\mathbf{x})
\mathbf{x}_{t}=\argmax_{\mathbf{x}}\argmin_{c}\mu(\mathbf{x},c)+\beta_{t}%
\sigma(\mathbf{x},c)
d
c
d-1
\mathbf{x}
\argmax_{\mathbf{x}}f(\mathbf{x},\cdot)
\argmax_{\mathbf{x}}f(\mathbf{x},\cdot)
15
\epsilon_{t}\in\{0.5,1\}
\mathbf{x}^{*}
\mathbf{x}_{t}
\epsilon_{t}\rightarrow 0
\epsilon
\epsilon_{t}
\chi^{2}
\chi^{2}
\chi^{2}
\chi^{2}
|C|
|C|
5
10
\chi^{2}
c
(r_{x},r_{y})\in[-5,5]^{2}
r_{t}\in[1,30]
|C|\in\{30,100,500\}
|C|
\chi^{2}
|C|
100
500
|C|
|C|
\varphi
\varphi
\varphi
f
x
c
f
f
\left\{(\mathbf{x}_{i},f(\mathbf{x}_{i})\right\}
\displaystyle f(\mathbf{x})\sim\text{GP}\left(m(\mathbf{x}),k(\mathbf{x},%
\mathbf{x}^{\prime})\right),
\displaystyle f(\mathbf{x})\sim\text{GP}\left(m(\mathbf{x}),k(\mathbf{x},%
\mathbf{x}^{\prime})\right),
m\left(\mathbf{x}\right)
k\left(\mathbf{x},\mathbf{x}^{\prime}\right)
m(\mathbf{x})=\mathbb{E}\left[f(\mathbf{x})\right]
k(\mathbf{x},\mathbf{x}^{\prime})=\mathbb{E}\left[(f(\mathbf{x})-m(\mathbf{x})%
)(f(\mathbf{x}^{\prime})-m(\mathbf{x}^{\prime}))^{T}\right]
f_{*}=f\left(\mathbf{x}_{*}\right)
\mathbf{x}_{*}
p\bigl{(}f_{*}\mid\mathbf{x}_{*},[\mathbf{x}_{1}...\mathbf{x}_{N}],[y_{1},...y%
_{N}]\bigr{)}\sim\mathcal{N}\left(\mu\left(\mathbf{x}_{*}\right),\sigma^{2}%
\left(\mathbf{x}_{*}\right)\right)
\displaystyle\mu\left(\mathbf{x}_{*}\right)=\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{%
-1}\mathbf{y},
\displaystyle\mu\left(\mathbf{x}_{*}\right)=
\displaystyle\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{-1}\mathbf{y},
\displaystyle\sigma^{2}\left(\mathbf{x}_{*}\right)=k_{**}-\mathbf{k}_{*,N}%
\mathbf{K}_{N,N}^{-1}\mathbf{k}_{*,N}^{T}
\displaystyle\sigma^{2}\left(\mathbf{x}_{*}\right)=
\displaystyle k_{**}-\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{-1}\mathbf{k}_{*,N}^{T}
k_{**}=k\left(\mathbf{x}_{*},\mathbf{x}_{*}\right)
\mathbf{k}_{*,N}=[k\left(\mathbf{x}_{*},\mathbf{x}_{i}\right)]_{\forall i\leq N}
\bm{K}_{N,N}=\left[k\left(\mathbf{x}_{i},\mathbf{x}_{j}\right)\right]_{\forall
i%
,j\leq N}
x
c
\mathbf{x}\in\mathbb{R}^{d}
c\in\mathbb{R}
[\mathbf{x},c]\in\mathbb{R}^{d+1}
\displaystyle f([\mathbf{x},c])\sim\text{GP}\left(m([\mathbf{x},c]),k([\mathbf%
{x},c],[\mathbf{x}^{\prime},c^{\prime}])\right),
\displaystyle f([\mathbf{x},c])\sim\text{GP}\left(m([\mathbf{x},c]),k([\mathbf%
{x},c],[\mathbf{x}^{\prime},c^{\prime}])\right),
m\left([\mathbf{x},c]\right)
k\left([\mathbf{x},c],[\mathbf{x}^{\prime},c^{\prime}]\right)
f_{*}=f\left([\mathbf{x}_{*},c_{*}]\right)
[\mathbf{x}_{*},c_{*}]
p\bigl{(}f_{*}\mid[\mathbf{x}_{*},c_{*}],...\bigr{)}\sim\mathcal{N}\left(\mu%
\left([\mathbf{x}_{*},c_{*}]\right),\sigma^{2}\left([\mathbf{x}_{*},c_{*}]%
\right)\right)
\displaystyle\mu\left([\mathbf{x}_{*},c_{*}]\right)=\mathbf{k}_{*,N}\mathbf{K}%
_{N,N}^{-1}\mathbf{y},
\displaystyle\mu\left([\mathbf{x}_{*},c_{*}]\right)=
\displaystyle\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{-1}\mathbf{y},
\displaystyle\sigma^{2}\left([\mathbf{x}_{*},c_{*}]\right)=k_{**}-\mathbf{k}_{%
*,N}\mathbf{K}_{N,N}^{-1}\mathbf{k}_{*,N}^{T}
\displaystyle\sigma^{2}\left([\mathbf{x}_{*},c_{*}]\right)=
\displaystyle k_{**}-\mathbf{k}_{*,N}\mathbf{K}_{N,N}^{-1}\mathbf{k}_{*,N}^{T}
k_{**}=k\left([\mathbf{x}_{*},c_{*}],[\mathbf{x}_{*},c_{*}]\right)
\mathbf{k}_{*,N}=[k\left([\mathbf{x}_{*},c_{*}],[\mathbf{x}_{i},c_{i}]\right)]%
_{\forall i\leq N}
\bm{K}_{N,N}=\left[k\left([\mathbf{x}_{i},c_{i}],[\mathbf{x}_{j},c_{j}]\right)%
\right]_{\forall i,j\leq N}
\sigma
\mathcal{C}
\mathcal{C}
\Delta(\mathcal{C})
\mathcal{C}
\phi:\mathbb{R}\to(-\infty,\infty]
\phi(1)=0
\epsilon>0
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{q(c%
)}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X},\lambda\geq 0,b\in\mathbb{R%
}}\bracket{b-\lambda\epsilon_{t}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}%
\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{q(c%
)}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X},\lambda\geq 0,b\in\mathbb{R%
}}\bracket{b-\lambda\epsilon_{t}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}%
\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]}.
\mathbf{x}\in\mathcal{X}
\lambda\geq 0
\mathsf{D}_{\varphi}(p,q)\leq\varepsilon
\displaystyle\inf_{q\in B_{\phi}^{t}(p)}\E_{q(c)}[f(\mathbf{x},c)]=\inf_{q\in%
\Delta(\mathcal{C})}\sup_{\lambda\geq 0}\bracket{\E_{q(c)}[f(\mathbf{x},c)]-%
\lambda\bracket{\varepsilon_{t}-\mathsf{D}_{\varphi}(q,p_{t})}}
\displaystyle\inf_{q\in B_{\phi}^{t}(p)}\E_{q(c)}[f(\mathbf{x},c)]
\displaystyle=\inf_{q\in\Delta(\mathcal{C})}\sup_{\lambda\geq 0}\bracket{\E_{q%
(c)}[f(\mathbf{x},c)]-\lambda\bracket{\varepsilon_{t}-\mathsf{D}_{\varphi}(q,p%
_{t})}}
\displaystyle\stackrel{{\scriptstyle(1)}}{{=}}\sup_{\lambda\geq 0}\inf_{q\in%
\Delta(\mathcal{C})}\bracket{\E_{q(c)}[f(\mathbf{x},c)]-\lambda\bracket{%
\varepsilon_{t}-\mathsf{D}_{\varphi}(q,p_{t})}}
\displaystyle\stackrel{{\scriptstyle(1)}}{{=}}\sup_{\lambda\geq 0}\inf_{q\in%
\Delta(\mathcal{C})}\bracket{\E_{q(c)}[f(\mathbf{x},c)]-\lambda\bracket{%
\varepsilon_{t}-\mathsf{D}_{\varphi}(q,p_{t})}}
\displaystyle=\sup_{\lambda\geq 0}\bracket{-\lambda\varepsilon_{t}-\sup_{q\in%
\Delta(\mathcal{C})}\bracket{\E_{q(c)}[-f(\mathbf{x},c)]-\lambda\mathsf{D}_{%
\varphi}(q,p_{t})}}
\displaystyle=\sup_{\lambda\geq 0}\bracket{-\lambda\varepsilon_{t}-\sup_{q\in%
\Delta(\mathcal{C})}\bracket{\E_{q(c)}[-f(\mathbf{x},c)]-\lambda\mathsf{D}_{%
\varphi}(q,p_{t})}}
\displaystyle\stackrel{{\scriptstyle(2)}}{{=}}\sup_{\lambda\geq 0}\bracket{-%
\lambda\varepsilon_{t}-\inf_{b\in\mathbb{R}}\bracket{\lambda\E_{p_{t}(c)}\left%
[\varphi^{\star}\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]-b}}
\displaystyle\stackrel{{\scriptstyle(2)}}{{=}}\sup_{\lambda\geq 0}\bracket{-%
\lambda\varepsilon_{t}-\inf_{b\in\mathbb{R}}\bracket{\lambda\E_{p_{t}(c)}\left%
[\varphi^{\star}\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]-b}}
\displaystyle=\sup_{\lambda\geq 0,b\in\mathbb{R}}\bracket{b-\lambda\epsilon_{t%
}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}\bracket{\frac{b-f(\mathbf{x},c)}{%
\lambda}}\right]}
\displaystyle=\sup_{\lambda\geq 0,b\in\mathbb{R}}\bracket{b-\lambda\epsilon_{t%
}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}\bracket{\frac{b-f(\mathbf{x},c)}{%
\lambda}}\right]}
(1)
\mathbf{x}\in\mathcal{X}
q\mapsto\E_{q(c)}[f(\mathbf{x},c)]
\varphi
q\mapsto\mathsf{D}_{\varphi}(q,p_{t})
\mathcal{C}
\Delta(\mathcal{C})
(2)
\varphi
\varphi^{\star}(u)=\sup_{u^{\prime}}\bracket{uu^{\prime}-\varphi(u^{\prime})}
h:\mathcal{C}\to\mathbb{R}
\varphi:\mathbb{R}\to(-\infty,\infty]
\varphi(1)=0
\displaystyle\sup_{q\in\Delta(\mathcal{C})}\bracket{\E_{q(c)}[h(c)]-\lambda%
\mathsf{D}_{\varphi}(q,p)}=\inf_{b\in\mathbb{R}}\bracket{\lambda\E_{p_{t}(c)}%
\left[\varphi^{\star}\bracket{\frac{b+h(c)}{\lambda}}\right]-b},
\displaystyle\sup_{q\in\Delta(\mathcal{C})}\bracket{\E_{q(c)}[h(c)]-\lambda%
\mathsf{D}_{\varphi}(q,p)}=\inf_{b\in\mathbb{R}}\bracket{\lambda\E_{p_{t}(c)}%
\left[\varphi^{\star}\bracket{\frac{b+h(c)}{\lambda}}\right]-b},
p\in\Delta(\mathcal{C})
\lambda>0
\varphi^{\star}
\chi^{2}
\phi(u)=(u-1)^{2}
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p_{t}(c)}%
[f(\mathbf{x},c)]-\sqrt{\varepsilon_{t}\operatorname{Var}_{p_{t}(c)}[f(\mathbf%
{x},c)]}}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p_{t}(c)}%
[f(\mathbf{x},c)]-\sqrt{\varepsilon_{t}\operatorname{Var}_{p_{t}(c)}[f(\mathbf%
{x},c)]}}.
(\lambda\varphi)^{\star}(u)=\frac{u^{2}}{4\lambda}+u
\displaystyle\sup_{b\in\mathbb{R}}\bracket{b-\E_{p_{t}(c)}\left[\frac{(b-f(%
\mathbf{x},c))^{2}}{4\lambda}+b-f(\mathbf{x},c)\right]}=\sup_{b\in\mathbb{R}}%
\bracket{\E_{p_{t}(c)}\left[f(\mathbf{x},c)\right]-\E_{p_{t}(c)}\left[\left(b-%
f(\mathbf{x},c)\right)^{2}\right]}
\displaystyle\sup_{b\in\mathbb{R}}\bracket{b-\E_{p_{t}(c)}\left[\frac{(b-f(%
\mathbf{x},c))^{2}}{4\lambda}+b-f(\mathbf{x},c)\right]}
\displaystyle=\sup_{b\in\mathbb{R}}\bracket{\E_{p_{t}(c)}\left[f(\mathbf{x},c)%
\right]-\E_{p_{t}(c)}\left[\left(b-f(\mathbf{x},c)\right)^{2}\right]}
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\frac{1}{4\lambda}\inf_{b\in%
\mathbb{R}}\E_{p_{t}(c)}\left[\left(b-f(\mathbf{x},c)\right)^{2}\right]
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\frac{1}{4\lambda}\inf_{b\in%
\mathbb{R}}\E_{p_{t}(c)}\left[\left(b-f(\mathbf{x},c)\right)^{2}\right]
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\frac{1}{4\lambda}\operatorname{%
Var}_{p_{t}(c)}[f(\mathbf{x},c)].
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\frac{1}{4\lambda}\operatorname{%
Var}_{p_{t}(c)}[f(\mathbf{x},c)].
\displaystyle\inf_{q\in B_{\phi}^{t}(p)}\E_{c\sim q}[f(\mathbf{x},c)]=\sup_{%
\lambda\geq 0,b\in\mathbb{R}}\bracket{b-\lambda\epsilon_{t}-\lambda\E_{p_{t}(c%
)}\left[\varphi^{\star}\bracket{\frac{b-f(\mathbf{x},c)}{\lambda}}\right]}
\displaystyle\inf_{q\in B_{\phi}^{t}(p)}\E_{c\sim q}[f(\mathbf{x},c)]
\displaystyle=\sup_{\lambda\geq 0,b\in\mathbb{R}}\bracket{b-\lambda\epsilon_{t%
}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}\bracket{\frac{b-f(\mathbf{x},c)}{%
\lambda}}\right]}
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\inf_{\lambda\geq 0}\bracket{%
\lambda\varepsilon_{t}+\frac{1}{4\lambda}\operatorname{Var}_{p_{t}(c)}[f(%
\mathbf{x},c)]}
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\inf_{\lambda\geq 0}\bracket{%
\lambda\varepsilon_{t}+\frac{1}{4\lambda}\operatorname{Var}_{p_{t}(c)}[f(%
\mathbf{x},c)]}
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\sqrt{\varepsilon_{t}%
\operatorname{Var}_{p_{t}(c)}[f(\mathbf{x},c)]}.
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\sqrt{\varepsilon_{t}%
\operatorname{Var}_{p_{t}(c)}[f(\mathbf{x},c)]}.
\varphi(u)=\card{u-1}
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p(c)}[f(%
\mathbf{x},c)]-\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C}}f(%
\mathbf{x},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x},c)}}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X}}\bracket{\E_{p(c)}[f(%
\mathbf{x},c)]-\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C}}f(%
\mathbf{x},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x},c)}}.
\varphi
(\lambda\varphi)^{\star}(u)=0
\card{u}\leq\lambda
+\infty
\lambda
\card{b-f(\mathbf{x},c)}
c\in\mathcal{C}
b\in\mathbb{R}
\lambda\geq 0
\displaystyle\sup_{b\in\mathbb{R}}\sup_{\lambda\geq 0}\bracket{b-\lambda%
\varepsilon_{t}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}\bracket{\frac{b-f(%
\mathbf{x},c)}{\lambda}}\right]}
\displaystyle\sup_{b\in\mathbb{R}}\sup_{\lambda\geq 0}\bracket{b-\lambda%
\varepsilon_{t}-\lambda\E_{p_{t}(c)}\left[\varphi^{\star}\bracket{\frac{b-f(%
\mathbf{x},c)}{\lambda}}\right]}
\displaystyle=\sup_{b\in\mathbb{R}}\bracket{\E_{p_{t}(c)}[f(\mathbf{x},c)]-%
\sup_{c\in\mathcal{C}}\card{b-f(\mathbf{x},c)}\varepsilon_{t}}
\displaystyle=\sup_{b\in\mathbb{R}}\bracket{\E_{p_{t}(c)}[f(\mathbf{x},c)]-%
\sup_{c\in\mathcal{C}}\card{b-f(\mathbf{x},c)}\varepsilon_{t}}
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\inf_{b\in\mathbb{R}}\sup_{c\in%
\mathcal{C}}\card{b-f(\mathbf{x},c)}\varepsilon_{t}.
\displaystyle=\E_{p_{t}(c)}[f(\mathbf{x},c)]-\inf_{b\in\mathbb{R}}\sup_{c\in%
\mathcal{C}}\card{b-f(\mathbf{x},c)}\varepsilon_{t}.
A\subset\mathbb{R}
\overline{a},\underline{a}\in A
\displaystyle\inf_{b\in\mathbb{R}}\sup_{a\in A}\card{b-a}=\frac{1}{2}\card{%
\overline{a}-\underline{a}}.
\displaystyle\inf_{b\in\mathbb{R}}\sup_{a\in A}\card{b-a}=\frac{1}{2}\card{%
\overline{a}-\underline{a}}.
b\in\mathbb{R}
\sup_{a\in A}\card{b-a}=\max\bracket{\card{\overline{a}-b},\card{\underline{a}%
-b}}
b=\frac{\overline{a}+\underline{a}}{2}
A=\braces{f(\mathbf{x},c):c\in\mathcal{C}}
\delta\in(0,1)
\epsilon_{t}
\sigma_{f}
\beta_{t}=2||f||^{2}_{k}+300\gamma_{t}\ln^{3}(t/\delta)
\displaystyle P\Bigl{(}\forall T,\forall\mathbf{x},\bigl{|}\mu_{T}(\mathbf{x})%
-f(\mathbf{x})\bigr{|}\leq\beta_{T}^{\frac{1}{2}}\sigma_{T}(\mathbf{x})\Bigr{)%
}\geq 1-\delta.
\displaystyle P\Bigl{(}\forall T,\forall\mathbf{x},\bigl{|}\mu_{T}(\mathbf{x})%
-f(\mathbf{x})\bigr{|}\leq\beta_{T}^{\frac{1}{2}}\sigma_{T}(\mathbf{x})\Bigr{)%
}\geq 1-\delta.
\varphi
\Gamma_{\varphi}
M=\sup_{(\mathbf{x},c)\in\mathcal{X}\times\mathcal{C}}\card{f(\mathbf{x},c)}
f
\varphi(u)=\card{u-1}
\displaystyle R_{T}(\varphi)\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+%
\sigma_{f}^{-2})}+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon%
_{t},
\displaystyle R_{T}(\varphi)\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+%
\sigma_{f}^{-2})}+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon%
_{t},
\sigma_{f}
\displaystyle\mu_{t}(\mathbf{x},c)=k_{t}([\mathbf{x},c])^{\intercal}\bracket{%
\bm{K}_{t}+\mathbf{I}_{t}\sigma^{2}_{f}}^{-1}y_{t}
\displaystyle\mu_{t}(\mathbf{x},c)
\displaystyle=k_{t}([\mathbf{x},c])^{\intercal}\bracket{\bm{K}_{t}+\mathbf{I}_%
{t}\sigma^{2}_{f}}^{-1}y_{t}
\displaystyle\sigma_{t}(\mathbf{x},c)^{2}=k([\mathbf{x},c],[\mathbf{x},c])-k_{%
t}([\mathbf{x},c])^{\intercal}\bracket{\bm{K}_{t}+\mathbf{I}_{t}\sigma^{2}_{f}%
}^{-1}k_{t}([\mathbf{x},c]),
\displaystyle\sigma_{t}(\mathbf{x},c)^{2}
\displaystyle=k([\mathbf{x},c],[\mathbf{x},c])-k_{t}([\mathbf{x},c])^{%
\intercal}\bracket{\bm{K}_{t}+\mathbf{I}_{t}\sigma^{2}_{f}}^{-1}k_{t}([\mathbf%
{x},c]),
\bm{K}_{t}=\left[k\left([\mathbf{x}_{i},c_{i}],[\mathbf{x}_{j},c_{j}]\right)%
\right]_{\forall i,j\leq t}
t
\displaystyle r_{t}=\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}%
\E_{q(c)}[f(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq%
\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle r_{t}=
\displaystyle\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)%
}[f(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t%
}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\stackrel{{\scriptstyle(1)}}{{\leq}}\E_{p_{t}(c)}[f(\mathbf{x}^{*%
},c)-\mu(\mathbf{x}^{*},c)]+\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\inf_{q:%
\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\stackrel{{\scriptstyle(1)}}{{\leq}}\E_{p_{t}(c)}[f(\mathbf{x}^{*%
},c)-\mu(\mathbf{x}^{*},c)]+\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\inf_{q:%
\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\stackrel{{\scriptstyle(2)}}{{\leq}}\sqrt{\beta_{t}}\E_{p_{t}(c)}%
[\sigma_{t}(\mathbf{x}^{*},c)]]+\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\inf_{q:%
\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\stackrel{{\scriptstyle(2)}}{{\leq}}\sqrt{\beta_{t}}\E_{p_{t}(c)}%
[\sigma_{t}(\mathbf{x}^{*},c)]]+\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\inf_{q:%
\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle=\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)]+\E_{%
p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq%
\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle=\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)]+\E_{%
p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq%
\varepsilon_{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\stackrel{{\scriptstyle(3)}}{{=}}\sqrt{\beta_{t}}\E_{p_{t}(c)}[%
\sigma_{t}(\mathbf{x}^{*},c)]+\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\E_{p_{t}(c%
)}[f(\mathbf{x}_{t},c)]+\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C%
}}f(\mathbf{x}_{t},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)}
\displaystyle\stackrel{{\scriptstyle(3)}}{{=}}\sqrt{\beta_{t}}\E_{p_{t}(c)}[%
\sigma_{t}(\mathbf{x}^{*},c)]+\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]-\E_{p_{t}(c%
)}[f(\mathbf{x}_{t},c)]+\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C%
}}f(\mathbf{x}_{t},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)}
\displaystyle=\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)]+\E_{%
p_{t}(c)}[\mu(\mathbf{x}^{*},c)-f(\mathbf{x}_{t},c)]+\frac{\varepsilon_{t}}{2}%
\bracket{\sup_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)-\inf_{c\in\mathcal{C}}f(%
\mathbf{x}_{t},c)}
\displaystyle=\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)]+\E_{%
p_{t}(c)}[\mu(\mathbf{x}^{*},c)-f(\mathbf{x}_{t},c)]+\frac{\varepsilon_{t}}{2}%
\bracket{\sup_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)-\inf_{c\in\mathcal{C}}f(%
\mathbf{x}_{t},c)}
\displaystyle\stackrel{{\scriptstyle(4)}}{{\leq}}\sqrt{\beta_{t}}\E_{p_{t}(c)}%
[\sigma_{t}(\mathbf{x}_{t},c)]+\E_{p_{t}(c)}[\mu(\mathbf{x}_{t},c)-f(\mathbf{x%
}_{t},c)]+\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C}}f(\mathbf{x}%
_{t},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)}
\displaystyle\stackrel{{\scriptstyle(4)}}{{\leq}}\sqrt{\beta_{t}}\E_{p_{t}(c)}%
[\sigma_{t}(\mathbf{x}_{t},c)]+\E_{p_{t}(c)}[\mu(\mathbf{x}_{t},c)-f(\mathbf{x%
}_{t},c)]+\frac{\varepsilon_{t}}{2}\bracket{\sup_{c\in\mathcal{C}}f(\mathbf{x}%
_{t},c)-\inf_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)}
\displaystyle\qquad+\frac{\epsilon_{t}}{2}\E_{p_{t}(c)}\bigl{[}\max\mu_{t}(%
\mathbf{x}^{*},c)-\min\mu_{t}(\mathbf{x}^{*},c)\bigr{]}
\displaystyle\qquad+\frac{\epsilon_{t}}{2}\E_{p_{t}(c)}\bigl{[}\max\mu_{t}(%
\mathbf{x}^{*},c)-\min\mu_{t}(\mathbf{x}^{*},c)\bigr{]}
\displaystyle\stackrel{{\scriptstyle(5)}}{{\leq}}2\sqrt{\beta_{t}}\E_{p_{t}(c)%
}[\sigma_{t}(\mathbf{x}_{t},c)]+\varepsilon_{t}\bigl{(}2M+\sqrt{\beta_{t}}%
\bigr{)},
\displaystyle\stackrel{{\scriptstyle(5)}}{{\leq}}2\sqrt{\beta_{t}}\E_{p_{t}(c)%
}[\sigma_{t}(\mathbf{x}_{t},c)]+\varepsilon_{t}\bigl{(}2M+\sqrt{\beta_{t}}%
\bigr{)},
(1)
p_{t}
\E_{q(c)}[\mu(\mathbf{x}^{*},c)]
(2)
\card{f(\mathbf{x},c)-\mu(\mathbf{x},c)}\leq\sqrt{\beta_{t}}\sigma_{t}(\mathbf%
{x},c)
x,c\in\mathcal{X}\times\mathcal{C}
1-\delta
(3)
(4)
\mathbf{x}_{t}
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x}_{t},c)+\sqrt{\beta_{t}}\sigma%
_{t}(\mathbf{x}_{t},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x}_{t}%
,c)-\min\mu_{t}(\mathbf{x}_{t},c)\big{)}\Bigl{]}\geq
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x}_{t},c)+\sqrt{\beta_{t}}\sigma%
_{t}(\mathbf{x}_{t},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x}_{t}%
,c)-\min\mu_{t}(\mathbf{x}_{t},c)\big{)}\Bigl{]}\geq
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x},c)+\sqrt{\beta_{t}}\sigma_{t}%
(\mathbf{x},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x},c)-\min\mu_%
{t}(\mathbf{x},c)\big{)}\Bigr{]},
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x},c)+\sqrt{\beta_{t}}\sigma_{t}%
(\mathbf{x},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x},c)-\min\mu_%
{t}(\mathbf{x},c)\big{)}\Bigr{]},
\mathbf{x}\in\mathcal{X}
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x}_{t},c)+\sqrt{\beta_{t}}\sigma%
_{t}(\mathbf{x}_{t},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x}_{t}%
,c)-\min\mu_{t}(\mathbf{x}_{t},c)\big{)}\Bigr{]}\geq
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x}_{t},c)+\sqrt{\beta_{t}}\sigma%
_{t}(\mathbf{x}_{t},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x}_{t}%
,c)-\min\mu_{t}(\mathbf{x}_{t},c)\big{)}\Bigr{]}\geq
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x}^{*},c)+\sqrt{\beta_{t}}\sigma%
_{t}(\mathbf{x}^{*},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x}^{*}%
,c)-\min\mu_{t}(\mathbf{x}^{*},c)\big{)}\Bigr{]}.
\displaystyle\E_{p_{t}(c)}\Bigl{[}\mu(\mathbf{x}^{*},c)+\sqrt{\beta_{t}}\sigma%
_{t}(\mathbf{x}^{*},c)-\frac{\epsilon_{t}}{2}\big{(}\max\mu_{t}(\mathbf{x}^{*}%
,c)-\min\mu_{t}(\mathbf{x}^{*},c)\big{)}\Bigr{]}.
\displaystyle\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]+\sqrt{\beta_{t}}\E_{p_{t}(c)%
}[\sigma_{t}(\mathbf{x}^{*},c)]\leq\,\,\E_{p_{t}(c)}[\mu(\mathbf{x}_{t},c)]+%
\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}_{t},c)]
\displaystyle\E_{p_{t}(c)}[\mu(\mathbf{x}^{*},c)]+\sqrt{\beta_{t}}\E_{p_{t}(c)%
}[\sigma_{t}(\mathbf{x}^{*},c)]\leq
\displaystyle\,\,\E_{p_{t}(c)}[\mu(\mathbf{x}_{t},c)]+\sqrt{\beta_{t}}\E_{p_{t%
}(c)}[\sigma_{t}(\mathbf{x}_{t},c)]
\displaystyle+\frac{\epsilon_{t}}{2}\E_{p_{t}(c)}\bigl{[}\max\mu_{t}(\mathbf{x%
}^{*},c)-\min\mu_{t}(\mathbf{x}^{*},c)\bigr{]}.
\displaystyle+\frac{\epsilon_{t}}{2}\E_{p_{t}(c)}\bigl{[}\max\mu_{t}(\mathbf{x%
}^{*},c)-\min\mu_{t}(\mathbf{x}^{*},c)\bigr{]}.
(5)
\card{f(\mathbf{x},c)-\mu(\mathbf{x},c)}\leq\beta_{t}\sigma_{t}(\mathbf{x},c)
[\mathbf{x},c]\in[\mathcal{X}\times\mathcal{C}]
\E_{p_{t}(c)}\bigl{[}\sup_{c\in\mathcal{C}}f(\mathbf{x}_{t},c)-\inf_{c\in%
\mathcal{C}}f(\mathbf{x}_{t},c)\bigr{]}\leq 2M
\E_{p_{t}(c)}\bigl{[}\max\mu_{t}(\mathbf{x}^{*},c)-\min\mu_{t}(\mathbf{x}^{*},%
c)\bigr{]}\leq 2[M+\sqrt{\beta_{t}}\sigma_{t}(\mathbf{x}^{*},c)]\leq 2[M+\sqrt%
{\beta_{t}}]
M=\sup_{(\mathbf{x},c)\in\mathcal{X}\times\mathcal{C}}\card{f(\mathbf{x},c)}
\sigma_{t}(\mathbf{x},c)\leq 1,\forall[\mathbf{x},c]
\displaystyle\gamma_{T}:=\max_{\{(\mathbf{x}_{t},c_{t})\}_{t=1}^{T}}\log\det(%
\mathbf{I}_{t}+\sigma^{-2}_{f}\bm{K}_{T}).
\displaystyle\gamma_{T}:=\max_{\{(\mathbf{x}_{t},c_{t})\}_{t=1}^{T}}\log\det(%
\mathbf{I}_{t}+\sigma^{-2}_{f}\bm{K}_{T}).
\bm{K}_{T}
D_{T}=\braces{[\mathbf{x}_{i},c_{i}]}_{i=1}^{T}\subset[\mathcal{X}\times%
\mathcal{C}]
T
\gamma_{T}
\forall\mathbf{x},c\in\mathcal{X\times C},\sum_{t=1}^{T}\sigma_{t-1}^{2}(%
\mathbf{x},c)\leq\frac{2}{\log(1+\sigma^{-2}_{f})}\gamma_{T}
\sigma_{f}
2\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}_{t},c)]
\displaystyle\sum_{t=1}^{T}4\beta_{t}\E_{p_{t}(c)}[\sigma^{2}_{t}(\mathbf{x}_{%
t},c)]\leq\frac{8\beta_{T}\gamma_{T}}{\log(1+\sigma_{f}^{-2})}
\displaystyle\sum_{t=1}^{T}4\beta_{t}\E_{p_{t}(c)}[\sigma^{2}_{t}(\mathbf{x}_{%
t},c)]\leq\frac{8\beta_{T}\gamma_{T}}{\log(1+\sigma_{f}^{-2})}
\displaystyle\sum_{t=1}^{T}2\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x%
},c)]\leq\sqrt{\frac{8T\beta_{T}\gamma_{T}}{\log(1+\sigma_{f}^{-2})}}
\displaystyle\sum_{t=1}^{T}2\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x%
},c)]\leq\sqrt{\frac{8T\beta_{T}\gamma_{T}}{\log(1+\sigma_{f}^{-2})}}
T
\displaystyle R_{T}(\varphi)\leq 2\sum_{t=1}^{T}\sqrt{\beta_{t}}\E_{p_{t}(c)}[%
\sigma_{t}(\mathbf{x},c)]+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}%
\varepsilon_{t}
\displaystyle R_{T}(\varphi)
\displaystyle\leq 2\sum_{t=1}^{T}\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(%
\mathbf{x},c)]+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq 2\sqrt{\beta_{T}}\sum_{t=1}^{T}\max_{c}[\sigma_{t}(\mathbf{x%
},c)]+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq 2\sqrt{\beta_{T}}\sum_{t=1}^{T}\max_{c}[\sigma_{t}(\mathbf{x%
},c)]+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq 2\sqrt{\beta_{T}}\max_{q\in\braces{p_{1},\ldots,p_{T}}}\sum_%
{t=1}^{T}\E_{q(c)}[\sigma_{t}(\mathbf{x},c)]+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{%
)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq 2\sqrt{\beta_{T}}\max_{q\in\braces{p_{1},\ldots,p_{T}}}\sum_%
{t=1}^{T}\E_{q(c)}[\sigma_{t}(\mathbf{x},c)]+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{%
)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq 2\sqrt{\beta_{T}}\max_{q\in\braces{p_{1},\ldots,p_{T}}}\E_{q%
(c)}\left[\sum_{t=1}^{T}\sigma_{t}(\mathbf{x},c)\right]+\bigl{(}2M+\sqrt{\beta%
_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq 2\sqrt{\beta_{T}}\max_{q\in\braces{p_{1},\ldots,p_{T}}}\E_{q%
(c)}\left[\sum_{t=1}^{T}\sigma_{t}(\mathbf{x},c)\right]+\bigl{(}2M+\sqrt{\beta%
_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+\sigma_{f}^{-2})}+%
\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
\displaystyle\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+\sigma_{f}^{-2})}+%
\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\varepsilon_{t}
T>0
\displaystyle\sum_{t=1}^{T}\bracket{\frac{1}{\sqrt{t}+\sqrt{t+1}}}=\sqrt{T+1}-%
1\leq\sqrt{T},
\displaystyle\sum_{t=1}^{T}\bracket{\frac{1}{\sqrt{t}+\sqrt{t+1}}}=\sqrt{T+1}-%
1\leq\sqrt{T},
\displaystyle\frac{1}{\sqrt{t}+\sqrt{t+1}}=\sqrt{t+1}-\sqrt{t},
\displaystyle\frac{1}{\sqrt{t}+\sqrt{t+1}}=\sqrt{t+1}-\sqrt{t},
\varphi
M=\sup_{(\mathbf{x},c)\in\mathcal{X}\times\mathcal{C}}\card{f(\mathbf{x},c)}<\infty
f
k
\varphi:\mathbb{R}\to(-\infty,\infty]
\varphi(1)=0
\Gamma_{\varphi}:[0,\infty)\to\mathbb{R}
\operatorname{TV}(p,q)\leq\Gamma_{\varphi}(\mathsf{D}_{\varphi}(p,q))
\displaystyle R_{T}(\varphi)\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+%
\sigma^{-2}_{f})}+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\Gamma_{%
\varphi}(\varepsilon_{t}),
\displaystyle R_{T}(\varphi)\leq\frac{\sqrt{8T\beta_{T}\gamma_{T}}}{\log(1+%
\sigma^{-2}_{f})}+\bigl{(}2M+\sqrt{\beta_{T}}\bigr{)}\sum_{t=1}^{T}\Gamma_{%
\varphi}(\varepsilon_{t}),
1-\delta
\beta_{t}=2||f||^{2}_{k}+300\gamma_{t}\ln^{3}(t/\delta)
\gamma_{t}
\sigma_{f}
\displaystyle\braces{q\in\Delta(\mathcal{C}):\mathsf{D}_{\varphi}(q,p_{t})\leq%
\varepsilon_{t}}\subseteq\braces{q\in\Delta(\mathcal{C}):\operatorname{TV}(q,p%
_{t})\leq\Gamma_{\varphi}(\varepsilon_{t})},
\displaystyle\braces{q\in\Delta(\mathcal{C}):\mathsf{D}_{\varphi}(q,p_{t})\leq%
\varepsilon_{t}}\subseteq\braces{q\in\Delta(\mathcal{C}):\operatorname{TV}(q,p%
_{t})\leq\Gamma_{\varphi}(\varepsilon_{t})},
\Gamma_{\varphi}
\displaystyle\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)%
}[f(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t%
}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t}}\E_{q(c)%
}[f(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_{t%
}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\leq\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)^{2%
}+\mu(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_%
{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\leq\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)^{2%
}+\mu(\mathbf{x}^{*},c)]-\inf_{q:\mathsf{D}_{\varphi}(q,p_{t})\leq\varepsilon_%
{t}}\E_{q(c)}[f(\mathbf{x}_{t},c)]
\displaystyle\leq\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)^{2%
}+\mu(\mathbf{x}^{*},c)]-\inf_{q:\operatorname{TV}(q,p_{t})\leq\Gamma_{\varphi%
}(\varepsilon_{t})}\E_{q(c)}[f(\mathbf{x}_{t},c)].
\displaystyle\leq\sqrt{\beta_{t}}\E_{p_{t}(c)}[\sigma_{t}(\mathbf{x}^{*},c)^{2%
}+\mu(\mathbf{x}^{*},c)]-\inf_{q:\operatorname{TV}(q,p_{t})\leq\Gamma_{\varphi%
}(\varepsilon_{t})}\E_{q(c)}[f(\mathbf{x}_{t},c)].
\Gamma_{\varphi}(\varepsilon_{t})
\phi
\chi
\phi(u)=u\log u
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X},\lambda\geq 0}\bracket%
{-\lambda\epsilon_{t}-\lambda\log\E_{p_{t}(c)}\left[\exp\bracket{\frac{-f(%
\mathbf{x},c)}{\lambda}}\right]}.
\displaystyle\sup_{\mathbf{x}\in\mathcal{X}}\inf_{q\in B_{\phi}^{t}(p)}\E_{c%
\sim q}[f(\mathbf{x},c)]=\sup_{\mathbf{x}\in\mathcal{X},\lambda\geq 0}\bracket%
{-\lambda\epsilon_{t}-\lambda\log\E_{p_{t}(c)}\left[\exp\bracket{\frac{-f(%
\mathbf{x},c)}{\lambda}}\right]}.
\varphi^{\star}
\varphi^{\star}(t)=\exp(t-1)
\lambda=1
\displaystyle\sup_{b\in\mathbb{R}}\bracket{b-\E_{p_{t}(c)}\left[\exp\bracket{b%
-f(\mathbf{x},c)-1}\right]}=\sup_{b\in\mathbb{R}}\bracket{b-\exp\bracket{b}%
\cdot A},
\displaystyle\sup_{b\in\mathbb{R}}\bracket{b-\E_{p_{t}(c)}\left[\exp\bracket{b%
-f(\mathbf{x},c)-1}\right]}=\sup_{b\in\mathbb{R}}\bracket{b-\exp\bracket{b}%
\cdot A},
A=\E_{p_{t}(c)}\left[\exp\bracket{-f(\mathbf{x},c)-1}\right]
b=-\log A
\displaystyle\sup_{b\in\mathbb{R}}\bracket{b-\E_{p_{t}(c)}\left[\exp\bracket{b%
-f(\mathbf{x},c)-1}\right]}=\log\E_{p_{t}(c)}\left[\exp(-f(\mathbf{x},c))%
\right].
\displaystyle\sup_{b\in\mathbb{R}}\bracket{b-\E_{p_{t}(c)}\left[\exp\bracket{b%
-f(\mathbf{x},c)-1}\right]}=\log\E_{p_{t}(c)}\left[\exp(-f(\mathbf{x},c))%
\right].
(\lambda\varphi)^{\star}(u)=\lambda\varphi^{\star}(u/\lambda)
\lambda>0
b\in\mathbb{R}
\varphi
\lambda\geq 0
\mathcal{X}
\Gamma_{\textrm{KL}}(t)=1-\exp(-t)
\chi^{2}
\lambda
\lambda=1
\lambda=5
\lambda
\chi^{2}
\lambda
\lambda=1
\lambda=5
\lambda
\phi
\chi^{2}
\{\mathbf{x}_{i},y_{i}\}_{i=1}^{t-1}
t
\mathbf{x}_{t}
\displaystyle\mathbf{x}_{t}=\arg\max_{\mathbf{x}\in\mathcal{X}}\alpha(\mathbf{%
x}).
\displaystyle\mathbf{x}_{t}=\arg\max_{\mathbf{x}\in\mathcal{X}}\alpha(\mathbf{%
x}).
\displaystyle\alpha^{KL}(\mathbf{x}):=-\lambda\epsilon_{t}-\lambda\log\E_{p_{t%
}(c)}\left[\exp\bracket{\frac{-\frac{1}{|C|}\sum_{c}\left[\mu_{t}(\mathbf{x},c%
)+\sqrt{\beta_{t}}\sigma_{t}(\mathbf{x},c)\right]}{\lambda}}\right]
\displaystyle\alpha^{KL}(\mathbf{x})
\displaystyle:=-\lambda\epsilon_{t}-\lambda\log\E_{p_{t}(c)}\left[\exp\bracket%
{\frac{-\frac{1}{|C|}\sum_{c}\left[\mu_{t}(\mathbf{x},c)+\sqrt{\beta_{t}}%
\sigma_{t}(\mathbf{x},c)\right]}{\lambda}}\right]
c\sim q
q
c\sim q
\chi^{2}
\chi^{2}
\chi^{2}
\epsilon_{t}
\epsilon_{t}
\chi^{2}
\epsilon_{t}
\lim_{t\rightarrow\infty},\epsilon_{t}=0
\epsilon_{t}
\lim_{t\rightarrow\infty},\epsilon_{t}=0
\epsilon=\{0.5,1\}
\epsilon=\{0.5,1\}
\epsilon=\{0.5,1\}
\epsilon=\{0.5,1\}
\epsilon\rightarrow 0
\epsilon\rightarrow 0
f(\mathbf{x},c)
\mathbf{x}_{t}
\epsilon
\epsilon_{t}
\epsilon_{t}
\epsilon_{t}
f(\mathbf{x},c)
\mathbf{x}_{t}
\epsilon
\epsilon_{t}
\epsilon_{t}
\epsilon_{t}
\varphi
\varepsilon_{t}
p_{t}
\varphi
P
