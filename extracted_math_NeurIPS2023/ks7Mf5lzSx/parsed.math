k
12.7\%
k
42.7\%
3.9\%
30\%
k
k
k
\mathcal{S}\times T
T=\{t_{1},t_{2},...,t_{T}\}
\mathcal{S}=\{s_{(0,0)},...,s_{(M,N)}\}
M\times N
F
S\times T
F_{t}\in\mathbb{R}^{T}
F_{s}\in\mathbb{R}^{M\times N}
F_{st}\in\mathbb{R}^{M\times N\times T}
y\in\mathbb{R}^{M\times N\times T}
\mathcal{S}\times T
y(s,t)>0
(s,t)
F
y
\{t_{1},t_{2},..,t_{n}\}
k
\{s_{1},...,s_{K}\}\in S
t_{n+1}
k
F
y
s\in\mathcal{S}
t\in T
\displaystyle\text{NDCG}_{t}=\frac{1}{Z_{t}}\sum_{s\in\mathcal{S}_{t}}\frac{2^%
{y_{s}}-1}{\log_{2}(1+\text{r}(s))},
\displaystyle\text{NDCG}_{t}=\frac{1}{Z_{t}}\sum_{s\in\mathcal{S}_{t}}\frac{2^%
{y_{s}}-1}{\log_{2}(1+\text{r}(s))},
y_{s}
s
\text{r}(s)
s
\mathcal{S}_{t}
Z_{t}
t
\bar{g}(\mathbf{w};\mathbf{x},\mathcal{S}_{t})=\sum_{s^{\prime}\in\mathcal{S}_%
{t}}\ell(h_{t}(s^{\prime};\mathbf{w})-h_{t}(\mathbf{s};\mathbf{w})),
r(s)
\ell()
\ell(x)=\max(0,x+c)^{2}
\mathbf{w}
L(\mathbf{w})
\max_{\mathbf{w}\in\mathbb{R}^{d}}L(\mathbf{w}):=\frac{1}{|T|}\sum_{t=1}^{T}%
\sum_{s\in\mathcal{S}^{+}_{t}}\frac{2^{y^{t}_{s}}-1}{Z_{t}\log_{2}(\bar{g}(%
\mathbf{w};\mathbf{x}^{t}_{s},\mathcal{S}_{t})+1)}.
\mathbf{s}^{t}\in S^{+}_{t}
F_{ST}
F_{T}
\displaystyle Z_{1}=\text{tanh}(\alpha E_{1}W_{1})
\displaystyle Z_{1}=\text{tanh}(\alpha E_{1}W_{1})
\displaystyle Z_{2}=\text{tanh}(\alpha E_{2}W_{2})
\displaystyle Z_{2}=\text{tanh}(\alpha E_{2}W_{2})
\displaystyle\mathcal{A}_{dynamic}=\text{ReLU}(\text{tanh}(\alpha(Z_{1}Z_{2}^{%
T}-Z_{2}Z_{1}^{T})))
\displaystyle\mathcal{A}_{dynamic}=\text{ReLU}(\text{tanh}(\alpha(Z_{1}Z_{2}^{%
T}-Z_{2}Z_{1}^{T})))
\displaystyle\beta=\text{sigmoid}(F_{T}W_{3})
\displaystyle\beta=\text{sigmoid}(F_{T}W_{3})
\displaystyle\mathcal{A}=\beta\mathcal{A}_{dynamic}+(1-\beta)\mathcal{A}_{static}
\displaystyle\mathcal{A}=\beta\mathcal{A}_{dynamic}+(1-\beta)\mathcal{A}_{static}
W_{1}
W_{2}
W_{3}
E_{1}
E_{2}
F_{ST}
\mathcal{A}_{dynamic}
\alpha
\mathcal{A}_{static}
i
j
a_{ij}=\frac{\sum_{t}(y_{i}-\bar{y_{i}})(y_{j}-\bar{y_{j}})}{\sqrt{\sum_{t}(y_%
{i}-\bar{y_{i}})^{2}(y_{j}-\bar{y_{j}})^{2}}}
\mathcal{A}
\mathcal{A}_{dynamic}
\mathcal{A}_{static}
\beta
F_{T}
\beta
y
\text{L-NDCG}=\frac{1}{T{|\mathcal{S}_{t}|}}\sum_{t=1}^{T}\sum_{s^{t}\in%
\mathcal{S}_{t}}\sum_{\hat{s}\in\mathcal{N}(s^{t})}\frac{2^{y^{t}_{\hat{s}}}-1%
}{Z^{t}_{\mathcal{N}(s^{t})}\log_{2}(r(\hat{s},\mathcal{N}(s^{t}))+1)}.
\mathcal{N}(s^{t})
\mathcal{N}
s^{t}
\mathcal{N}
R
\mathcal{N}
\max_{\mathbf{w}\in\mathbb{R}^{d}}L(\mathbf{w}):=\frac{1}{T{|\mathcal{S}^{+}_{%
t}|}}\sum_{t=1}^{T}\sum_{s^{t}\in\mathcal{S}^{+}_{t}}\sum_{\hat{s}\in\mathcal{%
N}(s^{t})}\frac{2^{y^{t}_{\hat{s}}}-1}{Z^{t}_{\mathcal{N}(s^{t})}\log_{2}(\bar%
{g}(\mathbf{w};\mathbf{x}^{t}_{\hat{s}},\mathcal{N}(s^{t}))+1)}.
g(\mathbf{w};\mathbf{x}^{t}_{\hat{s}},\mathcal{N}(s^{t}))
\mathcal{N}(s^{t})
Loss=(1-\sigma)\textsc{NDCG}+\sigma\textsc{L-NDCG}
\sigma
F
y
\sigma
\lambda
f_{\theta}{}
P
\{p_{1},p_{2},...,p_{l}\}\in L
\hat{y}
f_{\theta}(x)
loss_{NDCG}
\textbf{WeightedLoss}(y,\hat{y},P)
loss_{local}
\textbf{LocalWeightedLoss}(y,\hat{y},P)
loss_{hybrid}
(1-\sigma)\cdot loss_{NDCG}+\sigma\cdot loss_{local}
s\in\mathcal{S}
E_{s}
\frac{1}{T}\sum_{t}{\frac{2^{|y_{s}^{t}-\hat{y_{s}^{t}}|}-1}{log_{2}{(1+r(y_{s%
}^{t}))}}}
E_{s^{\prime}}^{*}=\sum\limits_{s}\frac{E_{s}}{{2\pi}\lambda^{2}}e^{-\frac{x^{%
2}}{2\lambda^{2}}}
s\in\mathcal{S}
x=dist(s^{\prime},s)
\textbf{normorlize}(E^{\prime})
\nabla f(\theta)
loss_{hybrid}
\theta
\nabla f(\theta)
f_{\theta}{}
F
y
\sigma
\lambda
y
\hat{y}
Loss_{NDCG}
\{p_{1},p_{2},...,p_{s}\}\in\mathcal{S}
\displaystyle E_{s}=\frac{1}{T}\sum_{t}{\frac{2^{|y_{s}^{t}-\hat{y_{s}^{t}}|}-%
1}{log_{2}{(1+r(y_{s}^{t}))}}}
\displaystyle E_{s}=\frac{1}{T}\sum_{t}{\frac{2^{|y_{s}^{t}-\hat{y_{s}^{t}}|}-%
1}{log_{2}{(1+r(y_{s}^{t}))}}}
r()
i
|y_{s}^{t}-\hat{y_{s}^{t}}|
E_{l}
s
r(y_{s}^{t})
\lambda
E^{*}
P
\sum_{s}P_{s}=1
\nabla f(\theta)
loss_{hybrid}
\theta
f_{\theta}{}
h_{t}(s;\mathbf{w}),\forall s\in\mathcal{S}_{t}^{+}\cup\mathcal{S}_{t}
\nabla h_{t}(s;\mathbf{w}),\forall s\in\mathcal{S}_{t}^{+}\cup\mathcal{S}_{t}
S=\sum_{t\in T}(|\mathcal{S}_{t}^{+}|\mathcal{N}{(s)}+|\mathcal{S}_{t}|)d\leq O%
(TSd)
d
local_{NDCG}
\bar{g}(\mathbf{w};\mathbf{x},\mathcal{S}_{t})
\sum_{t\in T}|\mathcal{S}_{t}^{+}||\mathcal{S}_{t}|\leq O(TS^{2})
\sum_{t\in T}|\mathcal{S}_{t}^{+}|\mathcal{N}^{2}{(s)}\leq O(TS\mathcal{N}^{2}%
{(s)})
\mathcal{N}^{2}{(s)}
O(TSd+TS^{2})
12.7\%
7.8\%
4.2\%
500
\times
500
64\times 80
K\in[30,40,50]
\beta
\beta
\alpha=0.05
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=0.5
\times 10^{-3}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\times 10^{-3}
\sigma
\sigma
\sigma=0
\sigma=0
\sigma
\sigma
\sigma=0.0
\sigma=0.05
\sigma=0.1
\sigma=0.2
\sigma=0.3
\sigma=0.0
\sigma=0.05
\sigma=0.1
\sigma=0.2
\sigma=0.3
d
\hat{K}(d)=\lambda_{j}^{-1}\sum_{i\neq j}I(d_{ij}\leq d)/n,
\lambda
j
I()
d_{ij}
d
n
i
F_{T}
F_{S}
F_{ST}
s
t
\mathcal{S}
s
T
t
F_{T}
F_{S}
F_{S}T
Z
a
\text{r}()
\mathcal{N}
\alpha=0.0001
\beta_{1}=0.9
\beta_{2}=0.999
\epsilon=10^{-8}
\sigma
0
0.05
0.1
0.2
0.3
R
80\%
\times
128\times 64
[0,1]
32\times 32
\beta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=0.5
\times 10^{-3}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\times 10^{-3}
\sigma
\sigma
0.05
\sigma=0.05
\sigma=0.1
\sigma
\sigma=0.0
\sigma=0.05
\sigma=0.1
\sigma=0.2
\sigma=0.3
25^{th},2021.
25^{th},2021.
d
\hat{K}(d)=\lambda_{j}^{-1}\sum_{i\neq j}I(d_{ij}\leq d)/n,
\lambda
j
I()
d_{ij}
d
n
i
25^{th}
147
50
