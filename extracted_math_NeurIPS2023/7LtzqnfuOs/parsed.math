\langle\mathcal{A},\mathcal{S},\mathcal{U},\mathcal{Z},P,O,r,\gamma\rangle
a\in\mathcal{A}:=\{1,\dots,n\}
s\in\mathcal{S}
\mathcal{U}
{\mathcal{U}^{a}}
\boldsymbol{u}\in\mathcal{U}
s
\boldsymbol{u}
P:\mathcal{S}\times\mathcal{U}\times\mathcal{S}\rightarrow[0,1]
\boldsymbol{z}=\{z^{1},...,z^{n}\}
O:\mathcal{S}\times\mathcal{A}\rightarrow\mathcal{Z}
r:\mathcal{S}\times\mathcal{U}\rightarrow\mathbb{R}
\gamma
\tau^{a}
z^{a}
R_{t}=\sum_{t=0}^{\infty}\gamma^{t}r_{t}
Q_{\text{tot}}(s,\boldsymbol{u})=\mathbb{E}_{\boldsymbol{\pi}}\left[R_{t}|s,%
\boldsymbol{u}\right],
\boldsymbol{\pi}=\{\pi_{1},\dots,\pi_{n}\}
Q_{\text{tot}}
Q_{a}
\arg\max_{u^{a}}Q_{\text{tot}}(s,\boldsymbol{u})=\arg\max_{u^{a}}Q_{a}\left(%
\tau^{a},u^{a}\right),\quad\forall a\in\mathcal{A}.
\underset{\boldsymbol{\pi}}{\arg\max}\,Q_{\text{tot}}(s,\boldsymbol{u}),
\boldsymbol{u}=\{u^{1},\dots,u^{n}\}
u^{a}\sim\pi_{a}(\tau^{a})
a
Q^{\text{alter}}_{a}(\tau^{a},\cdot)
\tau^{a}
Q_{\text{tot}}^{\text{alter}}(s,\boldsymbol{u})
\boldsymbol{u}
s
\pi^{\text{ego}}_{a}
\boldsymbol{\pi}^{\text{ego}}(\boldsymbol{u}\mid s)=\prod_{a=1}^{n}\pi^{\text{%
ego}}_{a}(u^{a}\mid\tau^{a})
Q_{\text{tot}}(s,\boldsymbol{u})
\boldsymbol{U}^{\text{ego}}
\boldsymbol{\pi}^{\text{ego}}
\displaystyle\underset{\boldsymbol{\pi}^{\text{ego}}}{\arg\max}\,Q_{\text{tot}%
}^{\text{alter}}(s,\boldsymbol{u}^{\text{ego}}),\qquad\text{s.t.}\quad%
\boldsymbol{u}^{\text{ego}}\in\boldsymbol{U}^{\text{ego}},
\displaystyle\underset{\boldsymbol{\pi}^{\text{ego}}}{\arg\max}\,Q_{\text{tot}%
}^{\text{alter}}(s,\boldsymbol{u}^{\text{ego}}),\qquad\text{s.t.}\quad%
\boldsymbol{u}^{\text{ego}}\in\boldsymbol{U}^{\text{ego}},
\boldsymbol{U}^{\text{ego}}:=\{\boldsymbol{u}_{i}^{\text{ego}}\sim\boldsymbol{%
\pi}^{\text{ego}}(s)\}_{i=1}^{M}
s
M
\boldsymbol{U}^{\text{ego}}
M
\boldsymbol{\pi}^{\text{ego}}
M
M
M
\boldsymbol{u}^{\star}=\underset{\boldsymbol{u}^{\text{ego}}}{\arg\max}\,Q_{%
\text{tot}}^{\text{alter}}(s,\boldsymbol{u}^{\text{ego}})
\boldsymbol{u}^{\text{ego }}\in\boldsymbol{U}^{\text{ego}}
\mathcal{L}_{\text{ego}}=-\log\boldsymbol{\pi}^{\text{ego}}(\boldsymbol{u}^{%
\star}\mid s).
\boldsymbol{u}^{\star}
-\sum_{a=1}^{n}\log\pi^{\text{ego}}_{a}({u^{a}}^{\star}\mid\tau^{a})
\boldsymbol{Q}^{\text{alter}}
\boldsymbol{\pi}^{\text{ego}}
\mathcal{L}=\left(y_{\text{tot}}-Q_{\text{tot}}\left(s_{t},\boldsymbol{u}_{t}%
\right)\right)^{2},
y_{\text{tot }}=r_{t}+\gamma\max_{\boldsymbol{u}_{t+1}}Q_{\text{tot}}^{-}\left%
(s_{t+1},\boldsymbol{u}_{t+1}\right)
Q^{-}_{\text{tot}}
\boldsymbol{U}^{\text{ego}}
Q^{\text{alter}}_{\text{tot}}
\mathcal{L}_{\text{alter}}=(y^{\text{alter}}_{\text{tot}}-Q_{\text{tot}}^{%
\text{alter}}(s_{t},\boldsymbol{u}_{t}))^{2},
y=r_{t}+\gamma\mathbb{E}_{\boldsymbol{\pi}^{\text{ego}}}[(Q^{\text{alter}}_{%
\text{tot}})^{-}(s_{t+1},\boldsymbol{u}_{t+1})]
\boldsymbol{U}^{\text{ego}}
\mathbb{E}_{\boldsymbol{\pi}^{\text{ego}}}
[(Q^{\text{alter}}_{\text{tot}})^{-}(s_{t+1},\boldsymbol{u}_{t+1})]
\frac{1}{M}\sum_{i=1}^{M}(Q^{\text{alter}}_{\text{tot}})^{-}(s_{t+1},%
\boldsymbol{u}^{\text{ego}}_{i})
\boldsymbol{u}^{\text{ego}}_{i}\in\boldsymbol{U}^{\text{ego}}
s_{t+1}
Q^{\text{alter}}_{\text{tot}}
M
Q^{\text{alter}}_{\text{tot}}
(s,\boldsymbol{u})
(s^{\prime},\boldsymbol{u}^{\prime})
\boldsymbol{u}
s
\mathcal{L}_{\text{recon}}(s,\boldsymbol{u})=\operatorname{MSE}(s,s^{\prime})+%
\sum_{a=1}^{n}\operatorname{CE}(u^{a},(u^{a})^{\prime}),
\operatorname{MSE}(\cdot)
\operatorname{CE}(\cdot)
\mathcal{L}_{\text{recon}}
\boldsymbol{u}
\hat{\boldsymbol{\pi}}^{\text{ego}}
\boldsymbol{\pi}^{\text{ego}}
\displaystyle\pi^{\text{ego}}_{a}(\tau^{a})=\operatorname{Softmax}(f(\tau^{a})),
\displaystyle\pi^{\text{ego}}_{a}(\tau^{a})
\displaystyle=\operatorname{Softmax}(f(\tau^{a})),
\displaystyle\hat{\pi}^{\text{ego}}_{a}(\tau^{a})=\operatorname{Softmin}(f(%
\tau^{a})),
\displaystyle\hat{\pi}^{\text{ego}}_{a}(\tau^{a})
\displaystyle=\operatorname{Softmin}(f(\tau^{a})),
f(\cdot)
\pi^{\text{ego}}_{a}
\hat{\pi}^{\text{ego}}_{a}
\pi^{\text{ego}}_{a}
\hat{\boldsymbol{U}}^{\text{ego}}:=\{\hat{\boldsymbol{u}}_{i}^{\text{ego}}\sim%
\hat{\boldsymbol{\pi}}^{\text{ego}}(s)\}_{i=1}^{M}
M
s
\hat{\boldsymbol{u}}^{\star}
s
\hat{\boldsymbol{u}}^{\star}=\underset{\hat{\boldsymbol{u}}^{\text{ego}}}{\arg%
\max}\,\mathcal{L}_{\text{recon}}(s,\hat{\boldsymbol{u}}^{\text{ego}}),
\hat{\boldsymbol{u}}^{\text{ego}}\in\hat{\boldsymbol{U}}^{\text{ego}}
\hat{\boldsymbol{u}}^{\star}
\boldsymbol{\pi}^{\text{ego}}
\mathcal{L}_{\text{ego}}=-\big{(}\log\boldsymbol{\pi}^{\text{ego}}(\boldsymbol%
{u}^{\star}\mid s)+\lambda\log\boldsymbol{\pi}^{\text{ego}}(\hat{\boldsymbol{u%
}}^{\star}\mid s)\big{)},
\lambda\in[0,1]
\lambda
M
k
k\in[0,8)
(A,A)
k
k\geq 0
(A,C)
k
(A,C)
(B,B)
k
k=7.5
k=0
(A,C)
(C,A)
k=0
(B,B)
M
\lambda_{\text{init}}
M
M
M
M
M=1
M
M
M
M
\lambda_{\text{init}}
\lambda_{\text{init}}
\lambda_{\text{init}}
\lambda_{\text{end}}
\lambda_{\text{init}}
\lambda_{\text{end}}
\lambda_{\text{init}}
\lambda_{\text{init}}=0
\lambda_{\text{init}}
\lambda_{\text{init}}
M
\lambda_{\text{init}}
M
{(u^{a})}^{\ast}
s
\boldsymbol{u}^{\ast}=\{{(u^{1})}^{\ast},\dots,{(u^{n})}^{\ast}\}
\boldsymbol{u}^{\ast}
\displaystyle p(\boldsymbol{u}^{\ast})=1-(1-\boldsymbol{\pi}^{\text{ego}}(%
\boldsymbol{u}^{\ast}|s))^{M}
\displaystyle p(\boldsymbol{u}^{\ast})
\displaystyle=1-(1-\boldsymbol{\pi}^{\text{ego}}(\boldsymbol{u}^{\ast}|s))^{M}
\displaystyle=1-(1-\prod_{i=1}^{n}\pi_{a}^{\text{ego}}({(u^{a})}^{\ast}|\tau^{%
a}))^{M},
\displaystyle=1-(1-\prod_{i=1}^{n}\pi_{a}^{\text{ego}}({(u^{a})}^{\ast}|\tau^{%
a}))^{M},
\pi_{a}^{\text{ego}}(\cdot|\cdot)\in(0,1)
(1-\boldsymbol{\pi}^{\text{ego}}(\boldsymbol{u}^{\ast}|s))^{M}\in(0,1)
M
p(\boldsymbol{u}^{\ast})
M
\boldsymbol{U}^{\text{ego}}:=\{\boldsymbol{u}_{i}^{\text{ego}}\sim\boldsymbol{%
\pi}^{\text{ego}}(s)\}_{i=1}^{M}
\hat{\boldsymbol{U}}^{\text{ego}}:=\{\hat{\boldsymbol{u}}_{i}^{\text{ego}}\sim%
\hat{\boldsymbol{\pi}}^{\text{ego}}(s)\}_{i=1}^{M}
\boldsymbol{u}^{\star}=\underset{\boldsymbol{u}^{\text{ego}}}{\arg\max}\,Q_{%
\text{tot}}^{\text{alter}}(s,\boldsymbol{u}^{\text{ego}})
\hat{\boldsymbol{u}}^{\star}=\underset{\hat{\boldsymbol{u}}^{\text{ego}}}{\arg%
\max}\,\mathcal{L}_{\text{recon}}(s,\hat{\boldsymbol{u}}^{\text{ego}})
\boldsymbol{U}^{\text{ego}}:=\{\boldsymbol{u}_{i}^{\text{ego}}\sim\boldsymbol{%
\pi}^{\text{ego}}(s)\}_{i=1}^{M}
\hat{\boldsymbol{U}}^{\text{ego}}:=\{\hat{\boldsymbol{u}}_{i}^{\text{ego}}\sim%
\hat{\boldsymbol{\pi}}^{\text{ego}}(s)\}_{i=1}^{M}
\boldsymbol{u}^{\star}=\underset{\boldsymbol{u}^{\text{ego}}}{\arg\max}\,Q_{%
\text{tot}}^{\text{alter}}(s,\boldsymbol{u}^{\text{ego}})
\hat{\boldsymbol{u}}^{\star}=\underset{\hat{\boldsymbol{u}}^{\text{ego}}}{\arg%
\max}\,\mathcal{L}_{\text{recon}}(s,\hat{\boldsymbol{u}}^{\text{ego}})
\operatorname{Softmin}
M
\gamma
\lambda_{\text{init}}
s_{1}
\boldsymbol{z}_{1}=\{z^{1}_{1},z^{2}_{1},\dots,z^{n}_{1}\}
t\leftarrow 1
T-1
a\leftarrow 1
n
u^{a}_{t}
\pi^{\text{ego}}_{a}
\boldsymbol{u}_{t}=\{u_{t}^{1},\dots,u_{t}^{n}\}
r_{t+1}
\boldsymbol{z}_{t+1}
s_{t+1}
\mathcal{D}
\mathcal{B}\sim
\mathcal{D}
\boldsymbol{U}^{\text{ego}}:=\{\boldsymbol{u}_{i}^{\text{ego}}\sim\boldsymbol{%
\pi}^{\text{ego}}(s)\}_{i=1}^{M}
\mathcal{B}
\hat{\pi}^{\text{ego}}_{a}
\hat{\boldsymbol{U}}^{\text{ego}}:=\{\hat{\boldsymbol{u}}_{i}^{\text{ego}}\sim%
\hat{\boldsymbol{\pi}}^{\text{ego}}(s)\}_{i=1}^{M}
M
s
\mathcal{B}
\boldsymbol{u}^{\star}
s
\mathcal{B}
\epsilon
\epsilon
\epsilon
\alpha
\epsilon
\gamma
M
\lambda_{\text{init}}
\lambda_{\text{end}}
u^{i}\in\{0,1,\dots,100\}
Q_{i}(u^{i})=\frac{u^{i}}{100},\quad\forall i\in\{1,2\}.
R
R(u^{1},u^{2})=\sin\big{(}2\pi Q_{1}(u^{1})\big{)}+\exp\big{(}Q_{2}(u^{2})\big%
{)}.
Q_{\text{tot}}
\boldsymbol{u}
Q_{i}
R
Q_{\text{tot}}
x
y
Q_{\text{tot}}
x
y
Q_{\text{tot}}
Q_{\text{tot}}
Q_{\text{tot}}
Q_{\text{tot}}
Q_{\text{tot}}
Q_{i}
k
k
k
k
k
k
\mathcal{U}=\left\{\frac{2j}{K-1}-1\right\}_{j=0}^{K-1}
\mathcal{U}=[-1,1]
K
K=31
31^{17}\approx 2.26\times 10^{25}
