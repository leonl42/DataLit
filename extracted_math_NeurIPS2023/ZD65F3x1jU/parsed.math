\boldsymbol{\beta}
\beta
\displaystyle\mathcal{L}_{\beta-VAE}=\max_{\boldsymbol{\theta},\boldsymbol{%
\phi}}\hskip 5.69054pt\mathbb{E}_{\mathbf{x}_{n}\sim p_{\text{data}}}[\mathbb{%
E}_{q_{\boldsymbol{\phi}}(\mathbf{z}_{n}|\mathbf{x}_{n})}[\log p_{\boldsymbol{%
\theta}}(\mathbf{x}_{n}|\mathbf{z}_{n})]
\displaystyle\mathcal{L}_{\beta-VAE}=
\displaystyle\max_{\boldsymbol{\theta},\boldsymbol{\phi}}\hskip 5.69054pt%
\mathbb{E}_{\mathbf{x}_{n}\sim p_{\text{data}}}[\mathbb{E}_{q_{\boldsymbol{%
\phi}}(\mathbf{z}_{n}|\mathbf{x}_{n})}[\log p_{\boldsymbol{\theta}}(\mathbf{x}%
_{n}|\mathbf{z}_{n})]
\displaystyle-\beta\mathcal{D}_{KL}\left(q_{\boldsymbol{\phi}}(\mathbf{z}_{n}|%
\mathbf{x}_{n})||p(\mathbf{z})\right)],
\displaystyle-\beta\mathcal{D}_{KL}\left(q_{\boldsymbol{\phi}}(\mathbf{z}_{n}|%
\mathbf{x}_{n})||p(\mathbf{z})\right)],
\mathbf{X}=\left\{\mathbf{x}_{n}\right\}_{n=1}^{N}
\mathbf{Z}=\left\{\mathbf{z}_{n}\right\}_{n=1}^{N}
N
p_{\boldsymbol{\theta}}(\mathbf{x}_{n}|\mathbf{z}_{n})
q_{\boldsymbol{\phi}}(\mathbf{z}_{n}|\mathbf{x}_{n})
\boldsymbol{\theta}
\boldsymbol{\phi}
\mathcal{D}_{KL}(\cdot||\cdot)
p(\mathbf{z})
\mathbf{z}
p(\mathbf{z})
\beta\geq 1
\mathbf{Y}=\{y_{ij}\}_{(i,j)\in\mathcal{J}}
\mathcal{J}\subseteq\{(i,j)|i,j\in\{1,\ldots,N\}\}
y_{ij}
y_{ij}\in\{0,1\}
0
1
y_{ij}
\mathbf{x}_{i}
\mathbf{x}_{j}
\mathbf{X}
\mathbf{Y}
\mathbf{x}_{n}
\mathbf{z}_{n}
\mathbf{z}
\mathbf{z}=[\mathbf{z}^{(u)},\mathbf{z}^{(v)}]
\mathbf{z}^{(u)}
d^{(u)}
\mathbf{z}^{(v)}
d^{(v)}
y_{ij}
\mathbf{x}_{i}
\mathbf{x}_{j}
\mathbf{z}^{(u)}
p(y_{ij}|\mathbf{z}_{i},\mathbf{z}_{j})=p(y_{ij}|\mathbf{z}_{i}^{(u)},\mathbf{%
z}_{j}^{(u)})
\adjustbox{width=.95center}{p_{\boldsymbol{\theta}}(\mathbf{X},\mathbf{Y}|%
\mathbf{Z})=\prod_{n=1}^{N}p_{\boldsymbol{\theta}}(\mathbf{x}_{n}|\mathbf{z}_{%
n})\prod_{(i,j)\in\mathcal{J}}p(y_{ij}|\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{%
j}).}
p_{\boldsymbol{\theta}}(\mathbf{x}_{n}|\mathbf{z}_{n})
p(y_{ij}|\mathbf{z}_{i}^{(u)},\mathbf{z}_{j}^{(u)})
y_{ij}
i
j
y_{ij}
\adjustbox{width=center}{p\left(y_{ij}|\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{%
j}\right)=\frac{1}{\mathcal{C}}\left(g(\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{%
j})\right)^{y_{ij}}\left(1-g(\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{j})\right)%
^{1-y_{ij}},}
\mathcal{C}
g(\cdot,\cdot)
\mathbf{z}_{i}^{(u)}
\mathbf{z}_{j}^{(u)}
y_{ij}
g
y_{ij}
1
g
\mathcal{C}=1
y_{ij}
0
1
\adjustbox{width=.8center}{\begin{aligned} \mathcal{C}&=\int_{0}^{1}\left(g(%
\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{j})\right)^{y_{ij}}\left(1-g(\mathbf{z}%
^{(u)}_{i},\mathbf{z}^{(u)}_{j})\right)^{1-y_{ij}}dy_{ij}\\
&=\frac{2g(\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{j})-1}{\log\left(g(\mathbf{z%
}^{(u)}_{i},\mathbf{z}^{(u)}_{j})\right)-\log\left(1-g(\mathbf{z}^{(u)}_{i},%
\mathbf{z}^{(u)}_{j})\right)}.\end{aligned}}
g
\adjustbox{width=.8center}{g\left(\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{j}%
\right)=\sigma\left(\eta_{1}\left(\eta_{2}-||\mathbf{z}_{i}^{(u)}-\mathbf{z}_{%
j}^{(u)}||_{2}^{2}\right)\right),}
\eta_{1}
\eta_{2}
\sigma(\cdot)
\eta_{1}\rightarrow\infty
g(\mathbf{z}^{(u)}_{i},\mathbf{z}^{(u)}_{j})
||\mathbf{z}_{i}^{(u)}-\mathbf{z}_{j}^{(u)}||_{2}^{2}
\eta_{2}
\sigma(\cdot)
||\mathbf{z}_{i}^{(u)}-\mathbf{z}_{j}^{(u)}||_{2}^{2}
y_{ij}
p(\mathbf{X},\mathbf{Y}|\mathbf{Z})
p(\mathbf{X},\mathbf{Y}|\mathbf{Z})
q(\mathbf{Z}|\mathbf{X})
q(\mathbf{Z}|\mathbf{X})
p(y_{ij}|\mathbf{z}_{i}^{(u)},\mathbf{z}_{j}^{(u)})
y_{ij}
\eta_{2}=2
||\mathbf{z}_{i}^{(u)}-\mathbf{z}_{j}^{(u)}||_{2}^{2}
y_{ij}
\eta_{1}
p(y_{ij}|\mathbf{z}_{i}^{(u)},\mathbf{z}_{j}^{(u)})
y_{ij}
\eta_{2}=2
||\mathbf{z}_{i}^{(u)}-\mathbf{z}_{j}^{(u)}||_{2}^{2}
y_{ij}
\eta_{1}
\mathbf{z}^{(u)}
\mathbf{z}^{(u)}
\beta
q_{\boldsymbol{\phi}}(\mathbf{z}^{(u)}_{n}|\mathbf{x}_{n})
p(\mathbf{z}^{(u)})
\mathbf{z}^{(v)}
\adjustbox{width=.75center}{\begin{aligned} \mathcal{R}=&\ -\mathbb{E}_{%
\mathbf{x}_{n}\sim p_{\text{data}}}\left[\beta\mathcal{D}_{KL}\left(q_{\phi}(%
\mathbf{z}^{(u)}_{n}|\mathbf{x}_{n})||p(\mathbf{z}^{(u)})\right)\right]\\
&\ -\mathbb{E}_{\mathbf{x}_{n}\sim p_{\text{data}}}\left[\mathcal{D}_{KL}\left%
(q_{\phi}(\mathbf{z}^{(v)}_{n}|\mathbf{x}_{n})||p(\mathbf{z}^{(v)})\right)%
\right],\end{aligned}}
\beta\geq 1
\adjustbox{width=center}{\begin{aligned} \mathcal{L}=&\max_{\boldsymbol{\theta%
},\boldsymbol{\phi}}\hskip 5.69054pt\mathbb{E}_{\mathbf{x}_{n}\sim p_{\text{%
data}}}\left[\mathbb{E}_{q_{\boldsymbol{\phi}}(\mathbf{z}_{n}|\mathbf{x}_{n})}%
[\log p_{\boldsymbol{\theta}}(\mathbf{x}_{n}|\mathbf{z}_{n})]\right]\\
&+\mathbb{E}_{(i,j)\in\mathcal{J}}\left[\mathbb{E}_{q_{\phi}(\mathbf{z}_{i},%
\mathbf{z}_{j}|\mathbf{x}_{i},\mathbf{x}_{j})}\left[\log p\left(y_{ij}|\mathbf%
{z}_{i}^{(u)},\mathbf{z}_{j}^{(u)}\right)\right]\right]+\mathcal{R},\end{%
aligned}}
p\left(y_{ij}|\mathbf{z}_{i}^{(u)},\mathbf{z}_{j}^{(u)}\right)
\mathcal{R}
q(\cdot|\cdot)
\mathbf{Y}
\mathbf{x}_{n}
\boldsymbol{\theta}
\boldsymbol{\phi}
\beta
\beta
\mathbf{z}
\mathbf{z}^{(u)}
\mathbf{z}^{(v)}
\mathbf{z}^{(u)}
\mathbf{z}^{(u)}
\mathbf{z}^{(u)}
60,000
10,000
28\times 28\times 1
60,000
10,000
28\times 28\times 1
1,903
513
64\times 64\times 1
69,131
17,237
64\times 64\times 3
14,016
3,552
64\times 64\times 3
0.01\%
y_{ij}=\mathds{1}(t_{i}=t_{j})
t_{i}
t_{j}
i
j
\mathds{1}
y_{ij}=exp(-\delta(t_{i},t_{j})^{2}/\sigma^{2})
\delta
\delta(350^{\circ},20^{\circ})=30^{\circ}
\beta
\beta
t
\mathcal{I}(\cdot,\cdot)
\mathbf{z}^{(u)}
t
\mathcal{I}(\mathbf{z}^{(u)};t)
\mathcal{I}(\mathbf{z}^{(v)}_{\cdot d};t)
d\in\{1\ldots d^{(v)}\}
\small\frac{1}{\mathcal{H}(t)}\left(\mathcal{I}(\mathbf{z}^{(u)};t)-\max_{d\in%
\{1\ldots d^{(v)}\}}\mathcal{I}(\mathbf{z}^{(v)}_{\cdot d};t)\right),
\mathcal{H}(\cdot)
\mathcal{I}(\cdot,\cdot)
\mathcal{H}(\cdot)
\mathbf{z}^{(u)}
d^{(u)}
\mathbf{z}^{(u)}
\mathbf{z}^{(v)}
\mathbf{z}^{(u)}
\mathbf{z}^{(v)}
d^{(u)}
\mathbf{z}^{(u)}
\mathbf{z}^{(v)}
40\%
\mathbf{z}^{(u)}
5
5
\kappa
R^{2}
\mathbf{z}^{(u)}
d^{(u)}
\beta
2
\mathbf{0.68}
0.01
0.03
0.33
0.04
0.01
2
\mathbf{0.52}
0.11
0.28
0.36
0.19
0.01
1
\mathbf{0.42}
0.02
0.07
0.06
0.29
2
\mathbf{0.37}
0.02
0.15
0.11
0.08
2
\mathbf{0.41}
0.02
0.22
0.15
0.16
\beta
\kappa
\mathbf{.969}
.494
.326
.704
.260
.030
\mathbf{.857}
.389
.460
.613
.482
.003
R^{2}
\mathbf{.968}
.397
.760
.699
.692
\mathbf{.912}
.155
.357
.224
.196
\mathbf{.584}
.391
.418
.177
.110
\mathbf{z}^{(u)}
\mathbf{z}^{(u)}
4
9
\mathbf{z}=[\mathbf{z}^{(u)},\mathbf{z}^{(v)}]
\mathbf{z}^{(v)}
\mathbf{z}^{(u)}
\mathbf{z}^{(u)}
\beta
\mathbf{z}^{(u)}
\beta
\beta
R^{2}
\text{FEV}_{1}
\boldsymbol{\kappa}
\mathbf{z}^{(u)}\in\mathbb{R}
\text{FEV}_{1}
R^{2}
\kappa
\beta
\beta
\mathbf{z}^{(u)}
\beta
\beta
5
\log p_{\boldsymbol{\theta}}(\mathbf{X},\mathbf{Y}|\mathbf{Z})
\beta
2
10
\beta
\beta
\eta_{1}
\eta_{2}
\eta_{2}=2
\eta_{1}
\eta_{1}=1e3
\eta_{2}
\eta_{1}
\eta_{2}
\eta_{1}\geq 1e3
\eta_{2}\geq 1.
\eta_{1}=1e3
\eta_{2}=2
1e-4
1e-4
\gamma
\gamma
\gamma
\epsilon\sim\mathcal{N}(0,\gamma)
\gamma\leq 0.1
0
1
