\triangleright
D=\{x^{i},y^{i}\}_{i=1}^{N}
x^{i}
y^{i}=\{y^{i}_{m}\}_{m=1}^{M^{i}}
N
M^{i}
i
y^{i}_{m}=\{(b^{i}_{m},c^{i}_{m},k^{i}_{m})\}
b^{i}_{m}\in\mathbb{R}^{4}
c^{i}_{m}\in\{1,...,J\}
k^{i}_{m}\in\{1,...,K\}
J
K
i
\theta_{O}
P
\hat{y}=\{(\hat{b}_{n},\hat{p}_{n})\}_{n=1}^{P}
x
\hat{b}_{n}\in\mathbb{R}^{4}
\hat{p}_{n}\in[0,1]^{J}
\mathcal{L_{D}}=\frac{1}{H}\sum^{H}_{n=1}\gamma_{n}\mathcal{L}(\mathfrak{b}_{n%
},\rho_{n},\hat{y})\,\,,
\gamma_{n}
\mathfrak{b}_{n}
\rho_{n}
H
\mathcal{L}
\hat{y}_{m}^{*}
y_{m}
\hat{y}_{m}^{*}=\operatorname*{arg\,min}_{\hat{y}_{n}\in\hat{y}}\mathcal{L}_{%
match}(\hat{y}_{n},y_{m})\,\,,
\mathcal{L}_{match}(\hat{y}_{n},y_{m})=-\hat{p}_{n(c_{m})}+\lambda_{1}\mathcal%
{L}_{IoU}(\hat{b}_{n},b_{m})+\lambda_{2}||\hat{b}_{n}-b_{m}||_{1}\,\,.
\lambda_{1},\lambda_{2}\in\mathbb{R}
\mathcal{L}_{IoU}
p(\epsilon_{m}|k_{m}=k,\bm{\mu},\bm{\sigma})=\mathcal{N}({\mu}^{k},{\sigma}^{k%
})\,\,,
\epsilon_{m}\in\mathbb{R}^{4}
\bm{\mu}
\bm{\sigma}
{\mu}^{k}
{\sigma}^{k}
\epsilon_{m}
k
\mu^{k}_{0}
\upsilon^{k}_{0}
\beta^{k}_{0}
\epsilon_{m}=\Big{[}\begin{matrix}\hat{b}_{m(1)}^{*}-b_{m(1)},&&\hat{b}_{m(2)}%
^{*}-b_{m(2)},&&\hat{b}_{m(3)}^{*}\div b_{m(3)},&&\hat{b}_{m(4)}^{*}\div b_{m(%
4)}\end{matrix}\Big{]}\,\,,
\hat{b}_{m}^{*}
b_{m}
\tilde{\mu}^{k}=\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\,\,,
\tilde{\upsilon}^{k}=\upsilon^{k}_{0}+\frac{M^{k}}{2}\,\,,
\tilde{\beta}^{k}=\beta^{k}_{0}+\frac{M^{k}(\bar{\epsilon}^{k}-\mu^{k}_{0})(%
\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}}{2(M^{k}+1)}+\frac{1}{2}\sum_{m=1}^{M}%
\text{1}[k_{m}=k](\epsilon_{m}-\bar{\epsilon}^{k})(\epsilon_{m}-\bar{\epsilon}%
^{k})^{\top}\,\,,
M^{k}
k
\bar{\epsilon}^{k}
\epsilon_{m}
k
\text{1}[\cdot]
\mu^{k}=\tilde{\mu}^{k}
b_{m}:=(b_{m}+\begin{bmatrix}\mu^{k}_{(1)},&\mu^{k}_{(2)},&0,&0\end{bmatrix})%
\odot\begin{bmatrix}1,&1,&\mu^{k}_{(3)},&\mu^{k}_{(4)}\end{bmatrix}\,.
P^{k}=1\oslash diag(\sigma^{k})
\oslash
\sigma^{k}=\tilde{\beta}^{k}/\tilde{\upsilon}^{k}
P^{k}
\{\mathfrak{b}_{n}\}_{n=1}^{H}
\mathfrak{b}_{n}=\frac{\sum_{(b,k)\in\kappa_{n}}P^{k}\odot b}{\sum_{(b,k)\in%
\kappa_{n}}P^{k}}\,\,.
H
\kappa_{n}
n
\gamma_{n}
K
c_{m}
p(c_{m}|k_{m}=k,t_{m}=j,\bm{\pi})={\pi}^{k}_{j,c_{m}}\,\,,
\bm{\pi}
{\pi}^{k}\in\mathbb{R}^{J\times J}
k
t_{m}
{\pi}^{k}_{j}
k
t_{m}=j
{\alpha}^{k}_{0j}=\{\alpha^{k}_{0j,1},...,\alpha^{k}_{0j,J}\}
\pi^{k}_{j}|\alpha^{k}_{0j}\sim Dir(\alpha^{k}_{0j})
\rho_{n,j}=\exp\left(\ln\hat{p}_{n,j}+\sum_{(c,k)\in\tilde{\kappa}_{n}}\mathbb%
{E}_{\pi^{k}_{j}}\ln\pi^{k}_{j,c}\right)\,\,,
\tilde{\kappa}_{n}
n
\hat{p}_{n,j}
j
n
\theta_{O}
\bm{\mu}
\bm{\upsilon}
\bm{\beta}
\bm{\alpha}
\mathcal{L_{D}}
\theta_{O}
\lambda_{1},\lambda_{2}
\bm{\mu}_{0}
\bm{\upsilon}_{0}
\bm{\beta}_{0}
\bm{\alpha_{0}}
K
K=1,000
K
K=1,000
K
K=1,000
K
K\geq 100
K>50
K
50\%
K
K=25
K\geq 100
K
K=25
K\geq 100
K
(y_{m},\hat{y}_{m}^{*})_{m=1}^{M}
M
y_{m}
b_{m}\in\mathbb{R}^{4}
k_{m}\in\{1,...,K\}
\hat{y}_{m}^{*}
\hat{b}_{m}^{*}\in\mathbb{R}^{4}
p(\epsilon_{m}|k_{m}=k,\bm{\mu},\bm{\sigma})=\mathcal{N}({\mu}^{k},{\sigma}^{k%
})\,\,,
\epsilon_{m}\in\mathbb{R}^{4}
\bm{\mu}
\bm{\sigma}
{\mu}^{k}
{\sigma}^{k}
\epsilon_{m}
k
\mu^{k}_{0}
\upsilon^{k}_{0}
\beta^{k}_{0}
\displaystyle\mathcal{NG}({\mu}^{k},{\sigma}^{k}|\mu^{k}_{0},\upsilon^{k}_{0},%
\beta^{k}_{0})\stackrel{{\scriptstyle\text{def}}}{{=}}\mathcal{N}(\mu^{k}|\mu^%
{k}_{0},\sigma^{k})\mathcal{G}((\sigma^{k})^{-1}|\upsilon^{k}_{0},\beta^{k}_{0})
\displaystyle\mathcal{NG}({\mu}^{k},{\sigma}^{k}|\mu^{k}_{0},\upsilon^{k}_{0},%
\beta^{k}_{0})
\displaystyle\stackrel{{\scriptstyle\text{def}}}{{=}}\mathcal{N}(\mu^{k}|\mu^{%
k}_{0},\sigma^{k})\mathcal{G}((\sigma^{k})^{-1}|\upsilon^{k}_{0},\beta^{k}_{0})
\displaystyle=\frac{1}{(2\pi)^{2}}\frac{1}{\sqrt{|\sigma^{k}|}}\exp\left(-%
\frac{1}{2}(\mu^{k}-\mu^{k}_{0})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\mu^{k}_{0})\right)
\displaystyle=\frac{1}{(2\pi)^{2}}\frac{1}{\sqrt{|\sigma^{k}|}}\exp\left(-%
\frac{1}{2}(\mu^{k}-\mu^{k}_{0})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\mu^{k}_{0})\right)
\displaystyle\quad\times\frac{|\beta^{k}_{0}|^{\upsilon^{k}_{0}}}{\Gamma(%
\upsilon^{k}_{0})}\frac{1}{|\sigma^{k}|^{\upsilon^{k}_{0}-\frac{5}{2}}}\exp%
\left(-tr(\beta^{k}_{0}(\sigma^{k})^{-1})\right)\,\,.
\displaystyle\quad\times\frac{|\beta^{k}_{0}|^{\upsilon^{k}_{0}}}{\Gamma(%
\upsilon^{k}_{0})}\frac{1}{|\sigma^{k}|^{\upsilon^{k}_{0}-\frac{5}{2}}}\exp%
\left(-tr(\beta^{k}_{0}(\sigma^{k})^{-1})\right)\,\,.
\mathcal{NG}
\mathcal{N}
\mathcal{G}
|\cdot|
tr(\cdot)
\Gamma
\mathbf{E}
(\epsilon_{m},k_{m})
\mathbf{M}_{0}
\mathbf{U}_{0}
\mathbf{B}_{0}
\mu^{k}_{0}
\upsilon^{k}_{0}
\beta^{k}_{0}
\mathbf{E}
\displaystyle\ln\,p(\mathbf{E}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})=%
\underbrace{\int q(\bm{\mu},\bm{\sigma})\ln\frac{p(\mathbf{E},\bm{\mu},\bm{%
\sigma}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})}{q(\bm{\mu},\bm{\sigma})%
}\mathop{}\!\mathrm{d}\bm{\mu}\mathop{}\!\mathrm{d}\bm{\sigma}\,}_{\mathcal{L}%
_{b}(q(\bm{\mu},\bm{\sigma}))}
\displaystyle\ln\,p(\mathbf{E}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})
\displaystyle=\underbrace{\int q(\bm{\mu},\bm{\sigma})\ln\frac{p(\mathbf{E},%
\bm{\mu},\bm{\sigma}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})}{q(\bm{\mu}%
,\bm{\sigma})}\mathop{}\!\mathrm{d}\bm{\mu}\mathop{}\!\mathrm{d}\bm{\sigma}\,}%
_{\mathcal{L}_{b}(q(\bm{\mu},\bm{\sigma}))}
\displaystyle\quad+\underbrace{\int q(\bm{\mu},\bm{\sigma})\ln\frac{q(\bm{\mu}%
,\bm{\sigma})}{p(\bm{\mu},\bm{\sigma}|\mathbf{E},\mathbf{M}_{0},\mathbf{U}_{0}%
,\mathbf{B}_{0})}\mathop{}\!\mathrm{d}\bm{\mu}\mathop{}\!\mathrm{d}\bm{\sigma}%
\,}_{KL(q(\bm{\mu},\bm{\sigma})||p(\bm{\mu},\bm{\sigma}))}\,\,,
\displaystyle\quad+\underbrace{\int q(\bm{\mu},\bm{\sigma})\ln\frac{q(\bm{\mu}%
,\bm{\sigma})}{p(\bm{\mu},\bm{\sigma}|\mathbf{E},\mathbf{M}_{0},\mathbf{U}_{0}%
,\mathbf{B}_{0})}\mathop{}\!\mathrm{d}\bm{\mu}\mathop{}\!\mathrm{d}\bm{\sigma}%
\,}_{KL(q(\bm{\mu},\bm{\sigma})||p(\bm{\mu},\bm{\sigma}))}\,\,,
q(\bm{\mu},\bm{\sigma})
\bm{\mu}
\bm{\sigma}
KL
p(\mathbf{E},\bm{\mu},\bm{\sigma}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0}%
)=p(\mathbf{E}|\bm{\mu},\bm{\sigma})p(\bm{\mu},\bm{\sigma}|\mathbf{M}_{0},%
\mathbf{U}_{0},\mathbf{B}_{0})\,\,.
\mathcal{L}_{b}(q(\bm{\mu},\bm{\sigma}))
\displaystyle\mathcal{L}_{b}(q(\bm{\mu},\bm{\sigma}))=-\int q(\bm{\mu},\bm{%
\sigma})\ln\frac{q(\bm{\mu},\bm{\sigma})}{p(\mathbf{E},\bm{\mu},\bm{\sigma}|%
\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})}\mathop{}\!\mathrm{d}\bm{\mu}%
\mathop{}\!\mathrm{d}\bm{\sigma}
\displaystyle\mathcal{L}_{b}(q(\bm{\mu},\bm{\sigma}))
\displaystyle=-\int q(\bm{\mu},\bm{\sigma})\ln\frac{q(\bm{\mu},\bm{\sigma})}{p%
(\mathbf{E},\bm{\mu},\bm{\sigma}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})%
}\mathop{}\!\mathrm{d}\bm{\mu}\mathop{}\!\mathrm{d}\bm{\sigma}
\displaystyle=-KL(q(\bm{\mu},\bm{\sigma})||p(\mathbf{E},\bm{\mu},\bm{\sigma}|%
\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0}))\,\,.
\displaystyle=-KL(q(\bm{\mu},\bm{\sigma})||p(\mathbf{E},\bm{\mu},\bm{\sigma}|%
\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0}))\,\,.
\mathcal{L}_{b}
q(\bm{\mu},\bm{\sigma})
p(\mathbf{E},\bm{\mu},\bm{\sigma}|\mathbf{M}_{0},\allowbreak\mathbf{U}_{0},%
\mathbf{B}_{0})
\displaystyle\ln\ q(\bm{\mu},\bm{\sigma})=\ln p(\mathbf{E},\bm{\mu},\bm{\sigma%
}|\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})
\displaystyle\ln\ 
\displaystyle q(\bm{\mu},\bm{\sigma})=\ln p(\mathbf{E},\bm{\mu},\bm{\sigma}|%
\mathbf{M}_{0},\mathbf{U}_{0},\mathbf{B}_{0})
\displaystyle\;\;\,\mathrel{\stackunder{\stackon{$=$}{$\scriptstyle C$}}{$%
\scriptstyle\lx@cref{creftype~refnum}{eq:box_joint},\lx@cref{creftype~refnum}{%
eq:gaussgamma}$}}\sum_{k=1}^{K}\ln\frac{1}{\sqrt{|\sigma^{k}|}}\frac{1}{|%
\sigma^{k}|^{\upsilon^{k}_{0}+\frac{M^{k}}{2}-\frac{5}{2}}}\exp\left(-tr(\beta%
^{k}_{0}(\sigma^{k})^{-1})
\displaystyle\;\;\,\mathrel{\stackunder{\stackon{$=$}{$\scriptstyle C$}}{$%
\scriptstyle\lx@cref{creftype~refnum}{eq:box_joint},\lx@cref{creftype~refnum}{%
eq:gaussgamma}$}}\sum_{k=1}^{K}\ln\frac{1}{\sqrt{|\sigma^{k}|}}\frac{1}{|%
\sigma^{k}|^{\upsilon^{k}_{0}+\frac{M^{k}}{2}-\frac{5}{2}}}\exp\left(-tr(\beta%
^{k}_{0}(\sigma^{k})^{-1})
\displaystyle\qquad\qquad\quad\exp\Bigg{(}-\frac{1}{2}\Big{[}(\mu^{k}-\mu^{k}_%
{0})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\mu^{k}_{0})
\displaystyle\qquad\qquad\quad\exp\Bigg{(}-\frac{1}{2}\Big{[}(\mu^{k}-\mu^{k}_%
{0})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\mu^{k}_{0})
\displaystyle\qquad\qquad\qquad+\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-%
\mu^{k})^{\top}(\sigma^{k})^{-1}(\epsilon_{m}-\mu^{k})\Big{]}\Bigg{)}\,\,,
\displaystyle\qquad\qquad\qquad+\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-%
\mu^{k})^{\top}(\sigma^{k})^{-1}(\epsilon_{m}-\mu^{k})\Big{]}\Bigg{)}\,\,,
\text{1}[\cdot]
M^{k}:=\sum_{m=1}^{M}\text{1}[k_{m}=k]
k
\stackrel{{\scriptstyle C}}{{=}}
\epsilon_{m}
k
\bar{\epsilon}^{k}=\frac{1}{M^{k}}\sum_{m=1}^{M}\text{1}[k_{m}=k]\epsilon_{m}%
\,\,.
\displaystyle\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-\mu^{k})^{\top}(%
\sigma^{k})^{-1}(\epsilon_{m}-\mu^{k})
\displaystyle\sum_{m=1}^{M}
\displaystyle\text{1}[k_{m}=k](\epsilon_{m}-\mu^{k})^{\top}(\sigma^{k})^{-1}(%
\epsilon_{m}-\mu^{k})
\displaystyle=\sum_{m=1}^{M}\text{1}[k_{m}=k][(\epsilon_{m}-\bar{\epsilon}^{k}%
)-(\mu^{k}-\bar{\epsilon}^{k})]^{\top}(\sigma^{k})^{-1}[(\epsilon_{m}-\bar{%
\epsilon}^{k})-(\mu^{k}-\bar{\epsilon}^{k})]
\displaystyle=\sum_{m=1}^{M}\text{1}[k_{m}=k][(\epsilon_{m}-\bar{\epsilon}^{k}%
)-(\mu^{k}-\bar{\epsilon}^{k})]^{\top}(\sigma^{k})^{-1}[(\epsilon_{m}-\bar{%
\epsilon}^{k})-(\mu^{k}-\bar{\epsilon}^{k})]
\displaystyle=\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-\bar{\epsilon}^{k})%
^{\top}(\sigma^{k})^{-1}(\epsilon_{m}-\bar{\epsilon}^{k})+M^{k}(\mu^{k}-\bar{%
\epsilon}^{k})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\bar{\epsilon}^{k})\,\,.
\displaystyle=\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-\bar{\epsilon}^{k})%
^{\top}(\sigma^{k})^{-1}(\epsilon_{m}-\bar{\epsilon}^{k})+M^{k}(\mu^{k}-\bar{%
\epsilon}^{k})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\bar{\epsilon}^{k})\,\,.
\displaystyle(\mu^{k}-\mu^{k}_{0}){}^{\top}(\sigma^{k})^{-1}(\mu^{k}-\mu^{k}_{%
0})+M^{k}(\mu^{k}-\bar{\epsilon}^{k})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\bar{%
\epsilon}^{k})
\displaystyle(\mu^{k}-\mu^{k}_{0})
{}^{\top}(\sigma^{k})^{-1}(\mu^{k}-\mu^{k}_{0})+M^{k}(\mu^{k}-\bar{\epsilon}^{%
k})^{\top}(\sigma^{k})^{-1}(\mu^{k}-\bar{\epsilon}^{k})
\displaystyle=(M^{k}+1)\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}%
}{M^{k}+1}\right)^{\top}(\sigma^{k})^{-1}\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}%
\bar{\epsilon}^{k}}{M^{k}+1}\right)
\displaystyle=(M^{k}+1)\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}%
}{M^{k}+1}\right)^{\top}(\sigma^{k})^{-1}\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}%
\bar{\epsilon}^{k}}{M^{k}+1}\right)
\displaystyle\quad+\frac{M^{k}(\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}(\sigma^{%
k})^{-1}(\bar{\epsilon}^{k}-\mu^{k}_{0})}{M^{k}+1}\,\,.
\displaystyle\quad+\frac{M^{k}(\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}(\sigma^{%
k})^{-1}(\bar{\epsilon}^{k}-\mu^{k}_{0})}{M^{k}+1}\,\,.
\displaystyle\ln\ q(\bm{\mu},\bm{\sigma})\stackrel{{\scriptstyle C}}{{=}}\sum_%
{k=1}^{K}\ln\frac{1}{\sqrt{|\sigma^{k}}|}\frac{1}{|\sigma^{k}|^{\upsilon^{k}_{%
0}+\frac{M^{k}}{2}-\frac{5}{2}}}\exp\left(-tr(\beta^{k}_{0}(\sigma^{k})^{-1})\right)
\displaystyle\ln\ q(\bm{\mu},\bm{\sigma})
\displaystyle\stackrel{{\scriptstyle C}}{{=}}\sum_{k=1}^{K}\ln\frac{1}{\sqrt{|%
\sigma^{k}}|}\frac{1}{|\sigma^{k}|^{\upsilon^{k}_{0}+\frac{M^{k}}{2}-\frac{5}{%
2}}}\exp\left(-tr(\beta^{k}_{0}(\sigma^{k})^{-1})\right)
\displaystyle\qquad\ \exp\Bigg{(}-\frac{1}{2}\Bigg{[}(M^{k}+1)\left(\mu^{k}-%
\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\right)^{\top}(\sigma^{k})^%
{-1}\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\right)
\displaystyle\qquad\ \exp\Bigg{(}-\frac{1}{2}\Bigg{[}(M^{k}+1)\left(\mu^{k}-%
\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\right)^{\top}(\sigma^{k})^%
{-1}\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\right)
\displaystyle\qquad\quad+\frac{M^{k}(\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}(%
\sigma^{k})^{-1}(\bar{\epsilon}^{k}-\mu^{k}_{0})}{M^{k}+1}
\displaystyle\qquad\quad+\frac{M^{k}(\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}(%
\sigma^{k})^{-1}(\bar{\epsilon}^{k}-\mu^{k}_{0})}{M^{k}+1}
\displaystyle\qquad\quad+\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-\bar{%
\epsilon}^{k})^{\top}(\sigma^{k})^{-1}(\epsilon_{m}-\bar{\epsilon}^{k})\Bigg{]%
}\Bigg{)}
\displaystyle\qquad\quad+\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{m}-\bar{%
\epsilon}^{k})^{\top}(\sigma^{k})^{-1}(\epsilon_{m}-\bar{\epsilon}^{k})\Bigg{]%
}\Bigg{)}
\displaystyle\stackrel{{\scriptstyle C}}{{=}}\sum_{k=1}^{K}\ln\frac{1}{\sqrt{|%
\sigma^{k}}|}\exp\Bigg{(}-\frac{1}{2}(M^{k}+1)\left(\mu^{k}-\frac{\mu^{k}_{0}+%
M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\right)^{\top}(\sigma^{k})^{-1}
\displaystyle\stackrel{{\scriptstyle C}}{{=}}\sum_{k=1}^{K}\ln\frac{1}{\sqrt{|%
\sigma^{k}}|}\exp\Bigg{(}-\frac{1}{2}(M^{k}+1)\left(\mu^{k}-\frac{\mu^{k}_{0}+%
M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\right)^{\top}(\sigma^{k})^{-1}
\displaystyle\qquad\qquad\qquad\qquad\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}\bar%
{\epsilon}^{k}}{M^{k}+1}\right)\Bigg{)}
\displaystyle\qquad\qquad\qquad\qquad\left(\mu^{k}-\frac{\mu^{k}_{0}+M^{k}\bar%
{\epsilon}^{k}}{M^{k}+1}\right)\Bigg{)}
\displaystyle\qquad\times\frac{1}{|\sigma^{k}|^{\upsilon^{k}_{0}+\frac{M^{k}}{%
2}-\frac{5}{2}}}\exp\Bigg{(}-tr\Bigg{(}\bigg{[}\beta^{k}_{0}+\frac{M^{k}(\bar{%
\epsilon}^{k}-\mu^{k}_{0})(\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}}{2(M^{k}+1)}
\displaystyle\qquad\times\frac{1}{|\sigma^{k}|^{\upsilon^{k}_{0}+\frac{M^{k}}{%
2}-\frac{5}{2}}}\exp\Bigg{(}-tr\Bigg{(}\bigg{[}\beta^{k}_{0}+\frac{M^{k}(\bar{%
\epsilon}^{k}-\mu^{k}_{0})(\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}}{2(M^{k}+1)}
\displaystyle\qquad\quad+\frac{1}{2}\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{%
m}-\bar{\epsilon}^{k})(\epsilon_{m}-\bar{\epsilon}^{k})^{\top}\bigg{]}(\sigma^%
{k})^{-1}\Bigg{)}\Bigg{)}\,\,.
\displaystyle\qquad\quad+\frac{1}{2}\sum_{m=1}^{M}\text{1}[k_{m}=k](\epsilon_{%
m}-\bar{\epsilon}^{k})(\epsilon_{m}-\bar{\epsilon}^{k})^{\top}\bigg{]}(\sigma^%
{k})^{-1}\Bigg{)}\Bigg{)}\,\,.
q(\bm{\mu},\bm{\sigma})
q(\bm{\mu},\bm{\sigma})=\prod_{k=1}^{K}\mathcal{NG}({\mu}^{k},{\sigma}^{k}|%
\tilde{\mu}^{k},\tilde{\upsilon}^{k},\tilde{\beta}^{k})\,\,,
\tilde{\mu}^{k}=\frac{\mu^{k}_{0}+M^{k}\bar{\epsilon}^{k}}{M^{k}+1}\,\,,
\tilde{\upsilon}^{k}=\upsilon^{k}_{0}+\frac{M^{k}}{2}\,\,,
\tilde{\beta}^{k}=\beta^{k}_{0}+\frac{M^{k}(\bar{\epsilon}^{k}-\mu^{k}_{0})(%
\bar{\epsilon}^{k}-\mu^{k}_{0})^{\top}}{2(M^{k}+1)}+\frac{1}{2}\sum_{m=1}^{M}%
\text{1}[k_{m}=k](\epsilon_{m}-\bar{\epsilon}^{k})(\epsilon_{m}-\bar{\epsilon}%
^{k})^{\top}\,\,.
\mu^{k}=\tilde{\mu}^{k}
\sigma^{k}=\tilde{\beta}^{k}/\tilde{\upsilon}^{k}
\{(c_{m},k_{m})\}_{m=1}^{M_{n}}
c_{m}\in\{1,...,J\}
k_{m}\in\{1,...,K\}
n
\hat{y}_{n}
\hat{y}_{n}
\hat{p}_{n}\in[0,1]^{J}
M_{n}
n
p(c_{m}|k_{m}=k,t_{m}=j,\bm{\pi})={\pi}^{k}_{j,c_{m}}\,\,,
\bm{\pi}
{\pi}^{k}\in\mathbb{R}^{J\times J}
k
t_{m}
\pi_{j}^{k}
k
t_{m}=j
n
p(t_{n}|x,\theta_{O})
\bm{\pi}
n
\rho_{n,j}:=q(t_{n}=j)
{\alpha}^{k}_{0j}=\{\alpha^{k}_{0j,1},\allowbreak...,\alpha^{k}_{0j,J}\}
\pi^{k}_{j}|\alpha^{k}_{0j}\sim Dir(\alpha^{k}_{0j})
\mathbf{c}
(c_{m},k_{m})
\mathbf{t}
t_{n}
\mathbf{A}_{0}
\alpha_{0j}^{k}
\mathbf{c}
\displaystyle\ln\,p(\mathbf{c}|x,\mathbf{A}_{0},\theta_{O})=\underbrace{\int q%
(\mathbf{t},\bm{\pi})\ln\frac{p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0%
},\theta_{O})}{q(\mathbf{t},\bm{\pi})}\mathop{}\!\mathrm{d}\mathbf{t}\mathop{}%
\!\mathrm{d}\bm{\pi}}_{\mathcal{L}_{c}(q,\theta_{O})}
\displaystyle\ln\,p(\mathbf{c}|x,\mathbf{A}_{0},\theta_{O})
\displaystyle=\underbrace{\int q(\mathbf{t},\bm{\pi})\ln\frac{p(\mathbf{c},%
\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})}{q(\mathbf{t},\bm{\pi})}%
\mathop{}\!\mathrm{d}\mathbf{t}\mathop{}\!\mathrm{d}\bm{\pi}}_{\mathcal{L}_{c}%
(q,\theta_{O})}
\displaystyle\quad+\underbrace{\int q(\mathbf{t},\bm{\pi})\ln\frac{q(\mathbf{t%
},\bm{\pi})}{p(\mathbf{t},\bm{\pi}|\mathbf{c},x,\mathbf{A}_{0},\theta_{O})}%
\mathop{}\!\mathrm{d}\mathbf{t}\mathop{}\!\mathrm{d}\bm{\pi}}_{KL(q(\mathbf{t}%
,\bm{\pi})||p(\mathbf{t},\bm{\pi}))}\,\,,
\displaystyle\quad+\underbrace{\int q(\mathbf{t},\bm{\pi})\ln\frac{q(\mathbf{t%
},\bm{\pi})}{p(\mathbf{t},\bm{\pi}|\mathbf{c},x,\mathbf{A}_{0},\theta_{O})}%
\mathop{}\!\mathrm{d}\mathbf{t}\mathop{}\!\mathrm{d}\bm{\pi}}_{KL(q(\mathbf{t}%
,\bm{\pi})||p(\mathbf{t},\bm{\pi}))}\,\,,
q(\mathbf{t},\bm{\pi})
\mathbf{t}
\bm{\pi}
\mathcal{L}_{c}(q,\theta_{O})
q(\mathbf{t},\bm{\pi})=q(\mathbf{t})q(\bm{\pi})
\mathcal{L}_{c}(q,\theta_{O})=\int q(\mathbf{t})q(\bm{\pi})\ln p(\mathbf{c},%
\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})\mathop{}\!\mathrm{d}\mathbf{t%
}\mathop{}\!\mathrm{d}\bm{\pi}\\
-\int q(\mathbf{t})\ln q(\mathbf{t})\mathop{}\!\mathrm{d}\mathbf{t}-\int q(\bm%
{\pi})\ln q(\bm{\pi})\mathop{}\!\mathrm{d}\bm{\pi}\,.
\mathcal{L}_{c}(q,\theta_{O})
p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})=p(\mathbf{c}|%
\mathbf{t},\bm{\pi})p(\mathbf{t}|x,\theta_{O})p(\bm{\pi}|\mathbf{A}_{0})\,\,.
\mathcal{L}_{c}
q(\bm{\pi})
q(\bm{\pi})
\displaystyle\ln\tilde{p}_{\bm{\pi}}(\mathbf{c},\mathbf{t},\bm{\pi}):=\int q(%
\mathbf{t})\ln p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})%
\mathop{}\!\mathrm{d}\mathbf{t}
\displaystyle\ln\tilde{p}_{\bm{\pi}}(\mathbf{c},\mathbf{t},\bm{\pi}):
\displaystyle=\int q(\mathbf{t})\ln p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf%
{A}_{0},\theta_{O})\mathop{}\!\mathrm{d}\mathbf{t}
\displaystyle\stackrel{{\scriptstyle C}}{{=}}\mathbb{E}_{q(\mathbf{t})}\ln p(%
\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})\,\,,
\displaystyle\stackrel{{\scriptstyle C}}{{=}}\mathbb{E}_{q(\mathbf{t})}\ln p(%
\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})\,\,,
\displaystyle\mathcal{L}_{c}(q(\bm{\pi}))\stackrel{{\scriptstyle C}}{{=}}-\int
q%
(\bm{\pi})\ln\frac{q(\bm{\pi})}{\tilde{p}_{\bm{\pi}}(\mathbf{c},\mathbf{t},\bm%
{\pi})}\mathop{}\!\mathrm{d}\bm{\pi}
\displaystyle\mathcal{L}_{c}(q(\bm{\pi}))
\displaystyle\stackrel{{\scriptstyle C}}{{=}}-\int q(\bm{\pi})\ln\frac{q(\bm{%
\pi})}{\tilde{p}_{\bm{\pi}}(\mathbf{c},\mathbf{t},\bm{\pi})}\mathop{}\!\mathrm%
{d}\bm{\pi}
\displaystyle\stackrel{{\scriptstyle C}}{{=}}-KL(q(\bm{\pi})||\tilde{p}_{\bm{%
\pi}}(\mathbf{c},\mathbf{t},\bm{\pi}))\,\,.
\displaystyle\stackrel{{\scriptstyle C}}{{=}}-KL(q(\bm{\pi})||\tilde{p}_{\bm{%
\pi}}(\mathbf{c},\mathbf{t},\bm{\pi}))\,\,.
\mathcal{L}_{c}(q(\bm{\pi}))
q(\bm{\pi})
\tilde{p}_{\bm{\pi}}(\mathbf{c},\mathbf{t},\bm{\pi})
\displaystyle\ln\ q(\bm{\pi})\stackrel{{\scriptstyle C}}{{=}}\ \mathbb{E}_{q(%
\mathbf{t})}\ln p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})
\displaystyle\ln\ 
\displaystyle q(\bm{\pi})\stackrel{{\scriptstyle C}}{{=}}\ \mathbb{E}_{q(%
\mathbf{t})}\ln p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})
\displaystyle\quad\mathrel{\stackunder{\stackon{$=$}{$\scriptstyle C$}}{$%
\scriptstyle\lx@cref{creftype~refnum}{eq:joint}$}}\mathbb{E}_{q(\mathbf{t})}%
\ln p(\mathbf{c}|\mathbf{t},\bm{\pi})p(\bm{\pi}|\mathbf{A}_{0})
\displaystyle\quad\mathrel{\stackunder{\stackon{$=$}{$\scriptstyle C$}}{$%
\scriptstyle\lx@cref{creftype~refnum}{eq:joint}$}}\mathbb{E}_{q(\mathbf{t})}%
\ln p(\mathbf{c}|\mathbf{t},\bm{\pi})p(\bm{\pi}|\mathbf{A}_{0})
\displaystyle\qquad\stackrel{{\scriptstyle C}}{{=}}\sum_{k=1}^{K}\sum_{j=1}^{J%
}\sum_{l=1}^{J}\ln\pi^{k}_{j,l}\Bigg{(}\alpha^{k}_{0j,l}+\sum_{n=1}^{H}\sum_{(%
c,k^{\prime})\in\tilde{\kappa}_{n}}\text{1}[c=l]\text{1}[k^{\prime}=k]q(t_{n}=%
j)-1\Bigg{)}\,.
\displaystyle\qquad\stackrel{{\scriptstyle C}}{{=}}\sum_{k=1}^{K}\sum_{j=1}^{J%
}\sum_{l=1}^{J}\ln\pi^{k}_{j,l}\Bigg{(}\alpha^{k}_{0j,l}+\sum_{n=1}^{H}\sum_{(%
c,k^{\prime})\in\tilde{\kappa}_{n}}\text{1}[c=l]\text{1}[k^{\prime}=k]q(t_{n}=%
j)-1\Bigg{)}\,.
H
\tilde{\kappa}_{n}
n
\text{1}[\cdot]
q(\bm{\pi})
q(\bm{\pi})=\prod_{k=1}^{K}\prod_{j=1}^{J}Dir(\pi_{j}^{k}|\tilde{\alpha}_{j}^{%
k})\,\,,
\tilde{\alpha}^{k}_{j,l}=\alpha^{k}_{0j,l}+\sum_{n=1}^{H}\sum_{(c,k^{\prime})%
\in\tilde{\kappa}_{n}}\text{1}[c=l]\text{1}[k^{\prime}=k]\,q(t_{n}=j)\,\,.
\mathcal{L}_{c}
q(\mathbf{t})
q(\mathbf{t})
q(\mathbf{t})
\displaystyle\ln\ q(\mathbf{t})\stackrel{{\scriptstyle C}}{{=}}\ \mathbb{E}_{q%
(\bm{\pi})}\ln p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})
\displaystyle\ln
\displaystyle\ q(\mathbf{t})\stackrel{{\scriptstyle C}}{{=}}\ \mathbb{E}_{q(%
\bm{\pi})}\ln p(\mathbf{c},\mathbf{t},\bm{\pi}|x,\mathbf{A}_{0},\theta_{O})
\displaystyle\quad\mathrel{\stackunder{\stackon{$=$}{$\scriptstyle C$}}{$%
\scriptstyle\lx@cref{creftype~refnum}{eq:joint}$}}\mathbb{E}_{q(\bm{\pi})}\ln p%
(\mathbf{c}|\mathbf{t},\bm{\pi})p(\mathbf{t}|x,\theta_{O})
\displaystyle\quad\mathrel{\stackunder{\stackon{$=$}{$\scriptstyle C$}}{$%
\scriptstyle\lx@cref{creftype~refnum}{eq:joint}$}}\mathbb{E}_{q(\bm{\pi})}\ln p%
(\mathbf{c}|\mathbf{t},\bm{\pi})p(\mathbf{t}|x,\theta_{O})
\displaystyle\qquad\stackrel{{\scriptstyle C}}{{=}}\sum_{n=1}^{H}\sum_{j=1}^{J%
}\text{1}[t_{n}=j]\left(\sum_{(c,k)\in\tilde{\kappa}_{n}}\mathbb{E}_{\pi^{k}_{%
j}}[\ln\pi^{k}_{j,c}]+\ln p(t_{n}=j|x,\theta_{O})\right)\,\,.
\displaystyle\qquad\stackrel{{\scriptstyle C}}{{=}}\sum_{n=1}^{H}\sum_{j=1}^{J%
}\text{1}[t_{n}=j]\left(\sum_{(c,k)\in\tilde{\kappa}_{n}}\mathbb{E}_{\pi^{k}_{%
j}}[\ln\pi^{k}_{j,c}]+\ln p(t_{n}=j|x,\theta_{O})\right)\,\,.
q(\pi^{k}_{j})
\mathbb{E}_{\pi^{k}_{j}}\ln\pi^{k}_{j,c}=\Psi(\tilde{\alpha}^{k}_{j,c})-\Psi%
\left(\sum^{J}_{l=1}\tilde{\alpha}^{k}_{j,l}\right)\,\,,
\Psi
p(a)
\ln p(a)=\sum_{i}\text{1}[a=i]\ln p(a=i)
q(t)
q(t)=\prod_{n=1}^{H}q(t_{n})\,\,,
n
\rho_{n,j}:=q(t_{n}=j)
\rho_{n,j}=\exp\left(\ln\hat{p}_{n,j}+\sum_{(c,k)\in\tilde{\kappa}_{n}}\mathbb%
{E}_{\pi^{k}_{j}}\ln\pi^{k}_{j,c}\right)\,\,,
\hat{p}_{n,j}:=p(t_{n}=j|x,\theta_{O})
j
n
x=\left\{x^{i}\in\mathbb{R}^{I_{w}\times I_{h}}\right\}_{i=1}^{N}
I_{w}
I_{h}
N
y=\left\{y^{i}=\big{\{}y^{i}_{m}=(b^{i}_{m},c^{i}_{m},k^{i}_{m})\right\}_{m=1}%
^{M^{i}}\big{\}}_{i=1}^{N}
y^{i}_{m}
b^{i}_{m}\in\mathbb{R}^{4}
c^{i}_{m}\in\{1,...,J\}
k^{i}_{m}\in\{1,...,K\}
m
i
M^{i}
i
T\in\mathbb{Z}^{+}
\textit{OD}_{\theta_{O}}(\cdot):\mathbb{R}^{I_{w}\times I_{h}}\to O^{P}
\theta_{O}
O=\mathbb{R}^{4}\times[0,1]^{J}
P
\bm{\mu}_{0}
\bm{\upsilon}_{0}
\bm{\beta}_{0}
\bm{\alpha}_{0}
t\leftarrow 1
t\leq T
\hat{y}\leftarrow\emptyset
\mathfrak{b}\leftarrow\emptyset
\rho\leftarrow\emptyset
i=1
N
\hat{y}^{i}\leftarrow
\textit{OD}_{\theta_{O}}(x^{i})
\mathfrak{b}^{i}\leftarrow
\rho^{i}\leftarrow
\hat{y}:=\hat{y}\cup\hat{y}^{i}
\mathfrak{b}:=\mathfrak{b}\cup\mathfrak{b}^{i}
\rho:=\rho\cup\rho^{i}
\theta_{O}
q(\bm{\mu},\bm{\sigma})
\mathcal{L}_{b}
q(\bm{\pi})
\mathcal{L}_{c}
5e^{-5}
1
2
4
6
5
3
7
9
10
8
8
\{\tilde{y}_{n}\}_{n=1}^{G}
\tilde{y}_{n}=\{(s_{n},t_{n})\}
G
s_{n}
t_{n}
n
\mathcal{C}\in\mathbb{R}^{(J+1)\times(J+1)}
J+1
k
\mathbf{C}_{k}
\mathcal{C}
\mathbf{C}_{k}\sim Dir(\mathcal{C})
\mathbf{C}_{k}
k
b_{m}
\hat{r}
\hat{o}
s_{n}
\textit{IoU}(s_{n},\hat{r})\odot\hat{o}
\odot
k
k
\mathcal{C}\in\mathbb{R}^{(J+1)\times(J+1)}
J
x=\left\{x^{i}\in\mathbb{R}^{I_{w}\times I_{h}}\right\}_{i=1}^{N}
I_{w}
I_{h}
N
\tilde{y}=\big{\{}\tilde{y}^{i}=\left\{\tilde{y}^{i}_{n}=(s^{i}_{n},t^{i}_{n})%
\right\}_{n=1}^{G^{i}}\big{\}}_{i=1}^{N}
\tilde{y}^{i}_{n}
s^{i}_{n}\in\mathbb{R}^{4}
t^{i}_{n}\in\{1,...,J\}
n
i
G^{i}
i
\textit{RPN}(\cdot):\mathbb{R}^{I_{w}\times I_{h}}\to R^{L}
R=\mathbb{R}^{4}\times[0,1]
L
k
\mathfrak{c}_{k}\in[0,1]
\mathbf{C}_{k}\sim Dir(\mathcal{C})
\mathcal{C}
\mathbf{C}_{k}
I\leftarrow
N,\mathfrak{c}_{k}
\mathfrak{c}_{k}N
y\leftarrow\emptyset
i
I
y^{i}\leftarrow\emptyset
\hat{r},\hat{o}\leftarrow
x^{i}
n=1
G^{i}
c^{i}_{n}\sim Categorical(\mathbf{C}_{k(t^{i}_{n})})
c^{i}_{n}=J+1
J+1
p^{i}_{n}\leftarrow
s^{i}_{n},\hat{r}
\odot\ \hat{o}
p^{i}_{n}:=\frac{p^{i}_{n}}{\lVert p^{i}_{n}\rVert_{1}}
p^{i}_{n}
l\sim Categorical(p^{i}_{n})
b^{i}_{n}\leftarrow\hat{r}_{l}
y^{i}:=y^{i}\cup\{(b^{i}_{n},c^{i}_{n},k)\}
c^{i}_{n}\sim Categorical(\mathbf{C}_{k(J+1)})
c^{i}_{n}\neq J+1
l\sim Categorical(\frac{\hat{o}}{\lVert\hat{o}\rVert_{1}})
b^{i}_{n}\leftarrow\hat{r}_{l}
y^{i}:=y^{i}\cup\{(b^{i}_{n},c^{i}_{n},k)\}
y:=y\cup y^{i}
y
\mathbf{C}_{k}
k
K
\mathcal{C}
\mathbf{C}
\mathcal{C}
\mathcal{C}
\bm{\mu}
\bm{\upsilon}
\bm{\beta}
\bm{\alpha}
\pi^{k}
\pi^{k}
\text{C1}<\text{C3}<\text{C4}<\text{C2}
\pi^{k}
\bm{\mu}
\bm{\upsilon}
\bm{\beta}
\bm{\alpha}
\pi^{k}
\pi^{k}
\bm{\mu}
\bm{\upsilon}
\bm{\beta}
\bm{\alpha}
\pi^{k}
\bm{\mu}
\bm{\upsilon}
\bm{\beta}
\bm{\alpha}
\bm{\mu}
\bm{\upsilon}
\bm{\beta}
\bm{\alpha}
