\times
\times
T_{1}-T_{2}
\times
\times
\displaystyle\lambda^{*}=\underset{\lambda}{\mathrm{argmin}}\;L_{meta}(D_{meta%
};\theta^{*}(\lambda))
\displaystyle\lambda^{*}
\displaystyle=\underset{\lambda}{\mathrm{argmin}}\;L_{meta}(D_{meta};\theta^{*%
}(\lambda))
\displaystyle s.t.\;\;\theta^{*}(\lambda)=\underset{\theta}{\mathrm{argmin}}\;%
L_{base}(D_{base};\theta,\lambda)
\displaystyle s.t.\;\;\theta^{*}(\lambda)
\displaystyle=\underset{\theta}{\mathrm{argmin}}\;L_{base}(D_{base};\theta,\lambda)
\lambda\;(\text{respectively, }\theta)
D_{meta}\;(D_{base})
L_{meta}\;(L_{base})
D_{meta}
\lambda
\dim(\lambda)\gg 1
\displaystyle\frac{\partial L_{meta}}{\partial\lambda}={\color[rgb]{.5,0,.5}%
\underbrace{\frac{\partial\theta^{*}}{\partial\lambda}}_{\text{best-response %
Jacobian}}}\cdot\hskip 11.38109pt{\color[rgb]{0,.5,.5}\underbrace{\frac{%
\partial L_{meta}}{\partial\theta^{*}}}_{\text{direct gradient}}}
\displaystyle\frac{\partial L_{meta}}{\partial\lambda}={\color[rgb]{.5,0,.5}%
\underbrace{\frac{\partial\theta^{*}}{\partial\lambda}}_{\text{best-response %
Jacobian}}}\cdot\hskip 11.38109pt{\color[rgb]{0,.5,.5}\underbrace{\frac{%
\partial L_{meta}}{\partial\theta^{*}}}_{\text{direct gradient}}}
u
\displaystyle{\color[rgb]{.5,0,.5}\frac{\partial\theta^{*}}{\partial\lambda}}=%
-{\color[rgb]{0.85,0.0,0.0}\underbrace{\frac{\partial u}{\partial\lambda}}_{%
\text{meta Jacobian}}}\cdot\hskip 5.69054pt\bigg{(}{\color[rgb]{0.0,0.0,0.85}%
\underbrace{\frac{\partial u}{\partial\theta^{*}}}_{\text{base Jacobian}}}%
\bigg{)}^{-1}\quad\quad\text{where}\;\begin{cases}\,\theta^{*}=\underset{t%
\rightarrow\infty}{\lim}\;\theta_{t}\\[6.45831pt]
\,\theta_{t}=\theta_{t-1}-u(\theta_{t-1};\lambda)\end{cases}
\displaystyle{\color[rgb]{.5,0,.5}\frac{\partial\theta^{*}}{\partial\lambda}}=%
-{\color[rgb]{0.85,0.0,0.0}\underbrace{\frac{\partial u}{\partial\lambda}}_{%
\text{meta Jacobian}}}\cdot\hskip 5.69054pt\bigg{(}{\color[rgb]{0.0,0.0,0.85}%
\underbrace{\frac{\partial u}{\partial\theta^{*}}}_{\text{base Jacobian}}}%
\bigg{)}^{-1}\quad\quad\text{where}\;\begin{cases}\,\theta^{*}=\underset{t%
\rightarrow\infty}{\lim}\;\theta_{t}\\[6.45831pt]
\,\theta_{t}=\theta_{t-1}-u(\theta_{t-1};\lambda)\end{cases}
\theta^{*}
u
\theta^{*}
u
\dim(\theta)
n_{b}
\mathcal{O}(n_{b}^{3})
\big{(}{\color[rgb]{0,0,1}\frac{\partial u}{\partial\theta^{*}}}\big{)}^{-1}{%
\color[rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}
\displaystyle\frac{\partial L_{meta}}{\partial\lambda}=-{\color[rgb]{%
0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}\cdot\bigg{(}{\color[rgb]{%
0.0,0.0,0.85}\frac{\partial u}{\partial\theta^{*}}}\bigg{)}^{-1}\cdot{\color[%
rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}\approx-{\color[rgb]%
{0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}\cdot{\color[rgb]{0,.5,.5}%
\frac{\partial L_{meta}}{\partial\theta^{*}}}
\displaystyle\frac{\partial L_{meta}}{\partial\lambda}=-{\color[rgb]{%
0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}\cdot\bigg{(}{\color[rgb]{%
0.0,0.0,0.85}\frac{\partial u}{\partial\theta^{*}}}\bigg{)}^{-1}\cdot{\color[%
rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}\approx-{\color[rgb]%
{0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}\cdot{\color[rgb]{0,.5,.5}%
\frac{\partial L_{meta}}{\partial\theta^{*}}}
T_{1}-T_{2}
u
u=\frac{\partial L_{base}}{\partial\theta}
\theta
\theta^{*}
\frac{\partial L_{meta}}{\partial\lambda}
\lambda^{*}
u
\frac{\partial\mathcal{L}_{base}}{\partial\theta^{*}}=0
\theta^{*}
\displaystyle{\color[rgb]{0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}={%
\color[rgb]{0.91,0.41,0.17}\frac{\partial g_{base}}{\partial\lambda}}\cdot{%
\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}={\color[rgb]{%
0.91,0.41,0.17}\frac{\partial^{2}L_{base}}{\partial\lambda\partial\theta^{*}}}%
\cdot{\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}
\displaystyle{\color[rgb]{0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}={%
\color[rgb]{0.91,0.41,0.17}\frac{\partial g_{base}}{\partial\lambda}}\cdot{%
\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}
\displaystyle={\color[rgb]{0.91,0.41,0.17}\frac{\partial^{2}L_{base}}{\partial%
\lambda\partial\theta^{*}}}\cdot{\color[rgb]{1,0,1}\frac{\partial u}{\partial g%
_{base}}}
\displaystyle\implies\frac{\partial L_{meta}}{\partial\lambda}\approx-{\color[%
rgb]{0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}\cdot{\color[rgb]{0,.5,.5%
}\frac{\partial L_{meta}}{\partial\theta^{*}}}=-{\color[rgb]{0.91,0.41,0.17}%
\frac{\partial^{2}L_{base}}{\partial\lambda\partial\theta^{*}}}\cdot{\color[%
rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}\cdot{\color[rgb]{0,.5,.5}%
\frac{\partial L_{meta}}{\partial\theta^{*}}}
\displaystyle\implies\frac{\partial L_{meta}}{\partial\lambda}\approx-{\color[%
rgb]{0.85,0.0,0.0}\frac{\partial u}{\partial\lambda}}\cdot{\color[rgb]{0,.5,.5%
}\frac{\partial L_{meta}}{\partial\theta^{*}}}=
\displaystyle-{\color[rgb]{0.91,0.41,0.17}\frac{\partial^{2}L_{base}}{\partial%
\lambda\partial\theta^{*}}}\cdot{\color[rgb]{1,0,1}\frac{\partial u}{\partial g%
_{base}}}\cdot{\color[rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}
g_{base}
\frac{\partial L_{base}}{\partial\theta^{*}}
u
{\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}
u
\mathcal{O}(n_{b})
{\color[rgb]{0.91,0.41,0.17}\frac{\partial^{2}L_{base}}{\partial\lambda%
\partial\theta^{*}}}
\displaystyle\frac{\partial L_{meta}}{\partial\lambda}\approx-{\color[rgb]{%
0.91,0.41,0.17}\frac{\partial^{2}L_{base}}{\partial\lambda\partial\theta^{*}}}%
\cdot\bigg{(}{\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}\cdot{%
\color[rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}\bigg{)}%
\approx-\frac{\frac{\partial L_{base}(\theta^{+},\lambda)}{\partial\lambda}-%
\frac{\partial L_{base}(\theta^{-},\lambda)}{\partial\lambda}}{2\epsilon}
\displaystyle\frac{\partial L_{meta}}{\partial\lambda}\approx-{\color[rgb]{%
0.91,0.41,0.17}\frac{\partial^{2}L_{base}}{\partial\lambda\partial\theta^{*}}}%
\cdot\bigg{(}{\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}\cdot{%
\color[rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}\bigg{)}%
\approx-\frac{\frac{\partial L_{base}(\theta^{+},\lambda)}{\partial\lambda}-%
\frac{\partial L_{base}(\theta^{-},\lambda)}{\partial\lambda}}{2\epsilon}
\theta^{\pm}=\theta^{*}\pm\epsilon v
v={\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}\cdot{\color[rgb]{%
0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}
\epsilon=\frac{\alpha}{\|v\|_{2}}
\alpha=1.0
{\color[rgb]{0,.5,.5}\frac{\partial L_{meta}}{\partial\theta^{*}}}
\theta^{*}
v
\theta
v
\theta_{t+1}=\theta_{t}-\epsilon v
{\color[rgb]{1,0,1}\frac{\partial u}{\partial g_{base}}}
\displaystyle\lambda^{*}=(\lambda_{r}^{*},\lambda_{c}^{*})=\underset{\lambda_{%
r},\lambda_{c}}{\mathrm{argmin}}\;\mathcal{L}(D_{clean};\theta^{*}(\lambda_{r}%
,\lambda_{c}))
\displaystyle\lambda^{*}=(\lambda_{r}^{*},\lambda_{c}^{*})=\underset{\lambda_{%
r},\lambda_{c}}{\mathrm{argmin}}\;\mathcal{L}(D_{clean};\theta^{*}(\lambda_{r}%
,\lambda_{c}))
\displaystyle\text{s.t. }\theta^{*}(\lambda_{r},\lambda_{c})=\;\underset{%
\theta}{\mathrm{argmin}}\;\frac{1}{|D_{noisy}|}\sum_{(x,y)\in D_{noisy}}w(%
\mathcal{L};\lambda_{r})\cdot\mathcal{L}(f(x;\theta),c(x,y;\lambda_{c}))
\displaystyle\text{s.t. }\theta^{*}(\lambda_{r},\lambda_{c})=\;
\displaystyle\underset{\theta}{\mathrm{argmin}}\;\frac{1}{|D_{noisy}|}\sum_{(x%
,y)\in D_{noisy}}w(\mathcal{L};\lambda_{r})\cdot\mathcal{L}(f(x;\theta),c(x,y;%
\lambda_{c}))
w(\cdot;\lambda_{r})
c(\cdot;\lambda_{c})
D_{clean}
\displaystyle\lambda^{*}=\underset{\lambda}{\mathrm{argmin}}\;\mathcal{L}_{ft}%
(D_{ft};\theta^{*}(\lambda))
\displaystyle\lambda^{*}
\displaystyle=\underset{\lambda}{\mathrm{argmin}}\;\mathcal{L}_{ft}(D_{ft};%
\theta^{*}(\lambda))
\displaystyle\text{s.t. }\theta^{*}(\lambda)=\underset{\theta}{\mathrm{argmin}%
}\;\mathcal{L}_{ft}(D_{ft};\theta)+\frac{1}{|D_{pt}|}\sum_{x\in D_{pt}}w(x;%
\lambda)\cdot\mathcal{L}_{pt}(x;\theta)
\displaystyle\text{s.t. }\theta^{*}(\lambda)
\displaystyle=\underset{\theta}{\mathrm{argmin}}\;\mathcal{L}_{ft}(D_{ft};%
\theta)+\frac{1}{|D_{pt}|}\sum_{x\in D_{pt}}w(x;\lambda)\cdot\mathcal{L}_{pt}(%
x;\theta)
\mathcal{L}_{ft}
\mathcal{L}_{ft}
D_{ft}
D_{pt}
w(\cdot;\lambda)
\displaystyle\lambda^{*}=\underset{\lambda}{\mathrm{argmin}}\;\mathcal{L}(D_{%
train};\theta^{*}(\lambda))
\displaystyle\lambda^{*}
\displaystyle=\underset{\lambda}{\mathrm{argmin}}\;\mathcal{L}(D_{train};%
\theta^{*}(\lambda))
\displaystyle\text{s.t. }\theta^{*}(\lambda)=\underset{\theta}{\mathrm{argmin}%
}\;\frac{1}{|D_{train}|}\sum_{(x,y)\in D_{train}}w(\mathcal{L},\,\mathcal{U};%
\lambda)\cdot\mathcal{L}(x,y;\theta)
\displaystyle\text{s.t. }\theta^{*}(\lambda)
\displaystyle=\underset{\theta}{\mathrm{argmin}}\;\frac{1}{|D_{train}|}\sum_{(%
x,y)\in D_{train}}w(\mathcal{L},\,\mathcal{U};\lambda)\cdot\mathcal{L}(x,y;\theta)
w(\cdot;\lambda)
\mathcal{L}
\mathcal{U}
(x,y)
\times
\alpha
\alpha
\alpha
\alpha
\mathcal{U}
m
v
\gamma
\displaystyle\frac{\partial u_{adam}}{\partial g}=\frac{\partial u}{\partial g%
}\bigg{(}\gamma\frac{\beta_{1}m+(1-\beta_{1})g}{\sqrt{\beta_{1}v+(1-\beta_{1})%
g^{2}}+\epsilon}\bigg{)}
\displaystyle\frac{\partial u_{adam}}{\partial g}
\displaystyle=\frac{\partial u}{\partial g}\bigg{(}\gamma\frac{\beta_{1}m+(1-%
\beta_{1})g}{\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}+\epsilon}\bigg{)}
\displaystyle=\gamma\frac{(1-\beta_{1})\beta_{2}v-(1-\beta_{1})\beta_{2}mg+(1-%
\beta_{1})\epsilon\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}}{\sqrt{\beta_{1}v+(1-%
\beta_{1})g^{2}}\big{(}\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}+e\big{)}^{2}}
\displaystyle=\gamma\frac{(1-\beta_{1})\beta_{2}v-(1-\beta_{1})\beta_{2}mg+(1-%
\beta_{1})\epsilon\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}}{\sqrt{\beta_{1}v+(1-%
\beta_{1})g^{2}}\big{(}\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}+e\big{)}^{2}}
\displaystyle\approx\gamma\frac{(1-\beta_{1})\beta_{2}v-(1-\beta_{1})\beta_{2}%
mg}{\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}\big{(}\sqrt{\beta_{1}v+(1-\beta_{1})g%
^{2}}+e\big{)}^{2}}\quad\quad(\text{because}\;\,\epsilon\ll 1)
\displaystyle\approx\gamma\frac{(1-\beta_{1})\beta_{2}v-(1-\beta_{1})\beta_{2}%
mg}{\sqrt{\beta_{1}v+(1-\beta_{1})g^{2}}\big{(}\sqrt{\beta_{1}v+(1-\beta_{1})g%
^{2}}+e\big{)}^{2}}\quad\quad(\text{because}\;\,\epsilon\ll 1)
L_{2}
\frac{\partial L_{meta}}{\partial\lambda}
\lambda^{*}
\displaystyle\lambda^{*}=\arg\min_{\lambda}\|X^{\prime}w^{*}(\lambda)-y^{%
\prime}\|^{2}
\displaystyle\lambda^{*}
\displaystyle=\arg\min_{\lambda}\|X^{\prime}w^{*}(\lambda)-y^{\prime}\|^{2}
\displaystyle w^{*}(\lambda)=\arg\min_{w}\|Xw-y\|^{2}+\beta\|w-\lambda\|^{2}
\displaystyle w^{*}(\lambda)
\displaystyle=\arg\min_{w}\|Xw-y\|^{2}+\beta\|w-\lambda\|^{2}
g_{\lambda}
\lambda^{*}
=X^{T}X+\beta I
g_{\lambda}=\beta(X^{T}X+\beta I)^{-1}(X\textquoteright^{T}X\textquoteright w^%
{*}-X\textquoteright^{T}y\textquoteright)
w^{*}=(X^{T}X+\beta I)^{-1}(X^{T}y+\beta\lambda)
\lambda^{*}=(A^{T}A)^{-1}A^{T}b
A=\beta X\textquoteright(X^{T}X+\beta I)^{-1},\,b=y\textquoteright-X%
\textquoteright(X^{T}X+\beta I)^{-1}X^{T}y
\beta=0.1
\beta
g_{\lambda}
g_{SAMA}
\lambda_{t}
\lambda^{*}
t
\cos(g_{\lambda},g_{approx})
g_{\lambda}
g_{approx}
\|\lambda_{t}-\lambda^{*}\|_{2}
\lambda_{t}
\lambda
t
\cos(g_{\lambda},g_{approx})
g_{\lambda}
g_{approx}
\|\lambda_{t}-\lambda^{*}\|_{2}
\lambda_{t}
\lambda
t
T_{1}-T_{2}
T_{1}-T_{2}
