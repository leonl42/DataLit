{\mathcal{M}}\coloneqq({\mathcal{S}},{\mathcal{A}},r,T,\rho,\gamma)
{\mathcal{S}}
{\mathcal{A}}
T(s^{\prime}|s,a)
r(s,a)
\rho(s_{0})
\gamma
h_{t}=(s_{0},a_{0},r_{0},s_{1},a_{1},\dots,s_{t})
s(h_{t})\coloneqq s_{t}
\pi
J_{{\mathcal{M}}}(\pi)=\mathbb{E}_{\pi}[\sum_{t\geq 0}\gamma^{t}r(s_{t},a_{t})]
h_{t}
s_{t}
\pi
a
h
Q_{{\mathcal{M}}}^{\pi}(h_{t},a_{t})=\mathbb{E}_{\pi}[\sum_{t^{\prime}=0}^{%
\infty}\gamma^{t^{\prime}}r(s_{t+t^{\prime}},a_{t+t^{\prime}})|h,a]
J_{\mathcal{M}}(\pi_{\theta})
Q^{\pi}
\nabla_{\theta}J_{{\mathcal{M}}}(\pi_{\theta})=\mathbb{E}_{h\sim\pi}[\nabla_{%
\theta}\mathbb{E}_{a\sim\pi_{\theta}(\cdot|h)}[Q_{{\mathcal{M}}}^{\pi}(h,a)]].
\pi_{\theta}(a|s_{t})
\pi_{\theta}(a|h_{t})
{\mathcal{D}}=\{\tau_{i}\}_{i=1}^{n}
\pi_{\beta}
{\mathcal{M}}^{*}
J_{{\mathcal{M}}^{*}}(\pi)
\pi_{\theta}(a|h_{t})
{\mathcal{M}}^{*}
{\mathcal{D}}
{\mathcal{M}}^{*}
{\mathcal{D}}
P({\mathcal{M}})
P({\mathcal{M}}|{\mathcal{D}})\propto P({\mathcal{M}})P({\mathcal{D}}|{%
\mathcal{M}})
\vspace{-0.5em}J_{\text{Bayes}}(\pi)\coloneqq\mathbb{E}_{{\mathcal{M}}\sim P({%
\mathcal{M}}|{\mathcal{D}})}[J_{{\mathcal{M}}}(\pi)],
{\mathcal{M}}_{po}
{\mathcal{M}}\sim P({\mathcal{M}}|{\mathcal{D}})
{\mathcal{M}}
({\mathcal{D}},p({\mathcal{M}}))
P({\mathcal{M}}|{\mathcal{D}})
P(Q_{\mathcal{M}}^{\pi}|{\mathcal{D}})
Q_{{\mathcal{M}}}^{\pi}
\pi(\cdot|s)
{\bm{b}}(h)
h
{\bm{b}}(h)({\mathcal{M}})=\frac{P({\mathcal{M}}|h,{\mathcal{D}})}{P({\mathcal%
{M}}|{\mathcal{D}})}.
\pi(\cdot|h_{t})=\pi(\cdot|s_{t},{\bm{b}}(h_{t}))
{\bm{b}}(h)
\pi(\cdot|s,{\bm{b}})
{\bm{b}}
{\bm{b}}
\pi_{\theta}(\cdot|s,{\bm{b}})
\theta
\pi_{\theta}(\cdot|s,{\bm{b}})
Q_{\mathcal{M}}^{\pi}
\displaystyle\nabla_{\theta}J_{\text{Bayes}}(\pi_{\theta})=\mathbb{E}_{h\sim%
\pi}[\nabla_{\theta}\mathbb{E}_{a\sim\pi_{\theta}(\cdot|s(h),{\bm{b}}(h))}[
\displaystyle\nabla_{\theta}J_{\text{Bayes}}(\pi_{\theta})
\displaystyle=\mathbb{E}_{h\sim\pi}[\nabla_{\theta}\mathbb{E}_{a\sim\pi_{%
\theta}(\cdot|s(h),{\bm{b}}(h))}[
\displaystyle{\color[rgb]{0,0,0}\mathbb{E}_{{\mathcal{M}}\sim P({\mathcal{M}}|%
{\mathcal{D}})}[}{\color[rgb]{0,0,0}{\bm{b}}(h)({\mathcal{M}})}Q_{\mathcal{M}}%
^{\pi}(h,a){\color[rgb]{0,0,0}]}].
\displaystyle{\color[rgb]{0,0,0}\mathbb{E}_{{\mathcal{M}}\sim P({\mathcal{M}}|%
{\mathcal{D}})}[}{\color[rgb]{0,0,0}{\bm{b}}(h)({\mathcal{M}})}Q_{\mathcal{M}}%
^{\pi}(h,a){\color[rgb]{0,0,0}]}].
{\color[rgb]{0,0,0}P({\mathcal{M}}|{\mathcal{D}})}
{\color[rgb]{0,0,0}{\bm{b}}(h)({\mathcal{M}})}
h
\pi
{\mathcal{M}}
Q_{\mathcal{M}}^{\pi}(h,a)
h_{t}
(s_{t},{\bm{b}}(h_{t}))
\begin{split}Q_{{\mathcal{M}}}^{\pi}(s,{\bm{b}},a)&=r(s,a)+\gamma\mathbb{E}_{%
\begin{subarray}{c}s^{\prime}\sim{\mathcal{M}}\\
a\sim\pi\end{subarray}}\left[Q_{{\mathcal{M}}}^{\pi}(s^{\prime},{\bm{b}}^{%
\prime},a)\right]\end{split}
{\bm{b}}^{\prime}\coloneqq\operatorname{BeliefUpdate}({\bm{b}},(s,a,r,s))
(s,a,r,s^{\prime})
\operatorname{BeliefUpdate}({\bm{b}},(s,a,r,s))({\mathcal{M}})\propto p_{%
\mathcal{M}}(r,s^{\prime}|s,a){\bm{b}}({\mathcal{M}})
{\bm{b}}
{\bm{b}}^{\prime}
{\bm{b}}
{\bm{b}}
{\mathcal{D}}
n
\pi(\cdot|s,{\bm{b}}):{\mathcal{S}}\times\Delta_{n}\to\Delta({\mathcal{A}})
\{\hat{Q}_{1},\dots\hat{Q}_{n}\}
\hat{Q}_{k}(s,{\bm{b}},a):{\mathcal{S}}\times\Delta_{n}\times{\mathcal{A}}\to%
\mathbb{R}
\pi
(s,a,r,s^{\prime})\sim{\mathcal{D}}
{\bm{b}}\sim p({\bm{b}})
{\bm{b}}^{\prime}=\text{BeliefUpdate}({\bm{b}},(s,a,r,s^{\prime}))
{\bm{b}}\to{\bm{b}}^{\prime}
\min{\mathcal{L}}(\hat{Q}_{k})\coloneqq(\hat{Q}_{k}(s,{\bm{b}},a)-(r+\gamma%
\mathbb{E}_{a^{\prime}\sim\pi(\cdot|s^{\prime},{\bm{b}}^{\prime})}[\hat{Q}_{k}%
(s^{\prime},{\bm{b}}^{\prime},a^{\prime})]|))^{2}~{}~{}~{}\forall k\in\{1,%
\dots n\}\vspace{-0.2em}
\pi(\cdot|s,{\bm{b}})
{\bm{b}}
\max_{\pi(\cdot|s,{\bm{b}})}\mathbb{E}_{a_{\pi}\sim\pi}[\sum_{k}{\bm{b}}_{k}%
\hat{Q}_{k}(s,{\bm{b}},a_{\pi})]
P(Q_{\mathcal{M}}^{\pi}|{\mathcal{D}})
\{\hat{Q}_{1},\dots\hat{Q}_{n}\}
\hat{Q}_{k}
\pi
{\mathcal{M}}_{k}\sim p({\mathcal{M}}|{\mathcal{D}})
{\bm{b}}
n
{\bm{b}}_{0}=[\frac{1}{n}\dots\frac{1}{n}]^{\top}
{\bm{b}}\in\mathbb{R}^{n}
n
{\bm{b}}_{k}\coloneqq{\bm{b}}({\mathcal{M}}_{k})
\hat{Q}_{k}
\pi(a|s,{\bm{b}})
s
{\bm{b}}
\pi
{\bm{b}}\to{\bm{b}}^{\prime}
(s,a,r,s^{\prime})
(s,a,r,s^{\prime})
\operatorname{BeliefUpdate}({\bm{b}},(s,a,r,s))
\log P_{{\mathcal{M}}}(s^{\prime},r|s,a)
-\log P_{{\mathcal{M}}}(s^{\prime},r|s,a)
(s,a,r,s^{\prime})
{\mathcal{M}}
\log\hat{P}_{{\mathcal{M}}}(\cdot)
\begin{split}\log\hat{P}_{{\mathcal{M}}_{k}}&(s^{\prime},r|s,a)=-\big{|}\hat{Q%
}_{k}(s,{\bm{b}},a)\\
&-(r+\gamma\mathbb{E}_{a^{\prime}\sim\pi}[\hat{Q}_{k}(s^{\prime},{\bm{b}},a^{%
\prime})])\big{|}^{2}\end{split}
\log\hat{P}_{{\mathcal{M}}_{k}}
(V(s^{\prime}),r)
{\mathcal{M}}_{k}
(s^{\prime},r)
P_{{\mathcal{M}}_{k}}
(s^{\prime},r)
{\mathcal{M}}_{k}
\hat{Q}_{k}(s,{\bm{b}},a)
(s,a,r,s^{\prime})
{\bm{b}}^{\prime}=\operatorname{BeliefUpdate}({\bm{b}},(s,a,r,s))
\begin{split}{\mathcal{L}}_{\text{critic}}(\hat{Q}_{k})&=\mathbb{E}_{\begin{%
subarray}{c}(s,a,r,s^{\prime})\sim{\mathcal{D}}\\
{\bm{b}}\sim p({\bm{b}})\end{subarray}}\big{[}\big{(}\hat{Q}_{k}(s,{\bm{b}},a)%
\\
&-(r+\gamma\mathbb{E}_{a^{\prime}\sim\pi(\cdot|s^{\prime},{\bm{b}}^{\prime})}[%
\hat{Q}_{k}(s^{\prime},{\bm{b}}^{\prime},a^{\prime})]|)\big{)}^{2}\big{]}.\end%
{split}
{\bm{b}}\sim p({\bm{b}})
s
{\bm{b}}
s
{\bm{b}}
{\mathcal{L}}_{\text{actor}}(\pi)=-\mathbb{E}_{\begin{subarray}{c}s\sim{%
\mathcal{D}}\\
{\bm{b}}\sim p({\bm{b}})\end{subarray}}\big{[}\mathbb{E}_{a\sim\pi_{\theta}(%
\cdot|s,{\bm{b}})}[\sum_{k}{\bm{b}}_{k}\hat{Q}_{k}(s,{\bm{b}},a)]\big{]}.
{\bm{b}}
s
s_{0}=
{\bm{b}}_{0}=[\frac{1}{n},\dots,\frac{1}{n}]^{\top}
t=0,1,\dots
a_{t}\sim\pi(\cdot|s_{t},{\bm{b}}_{t})
r_{t},s_{t+1}\leftarrow
a_{t}
{\bm{b}}_{t+1}=\operatorname{BeliefUpdate}({\bm{b}}_{t},(s_{t},a_{t},r_{t},s_{%
t+1}))
\{\hat{Q}_{1},\dots\hat{Q}_{n}\}
{\bm{b}}(h)
\pi(\cdot|s,{\bm{b}})
{\bm{b}}
{\bm{b}}
{\bm{b}}\to{\bm{b}}^{\prime}
{\bm{b}}
N
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
64\times 64
N_{\text{train}}
\approx~{}5\times 10^{5}
79\%
\pm 0.02
\pm.02
\pm 0.01
\pm 0.03
\pm 0.02
\pm 0.02
\pm 0.01
\pm 0.04
\pm 0.00
\pm 0.04
\pm 0.01
\pm 0.04
n
n
{\bm{b}}={\bm{e}}_{k}
k
\hat{Q}_{k}
{\bm{b}}
{\bm{b}}
{\bm{b}}
{\bm{b}}
(\overline{{\mathcal{S}}},{\mathcal{A}},{\mathcal{O}},\overline{P},O,r,\rho,\gamma)
\overline{{\mathcal{S}}}
{\mathcal{A}}
{\mathcal{O}}
\overline{P}(\overline{s}^{\prime}|\overline{s},a)
O
o_{t}=O(\overline{s}_{t})
r(\overline{s},a)
\rho(\overline{s})
\gamma
p(\overline{s}|h)
{\mathcal{M}}_{po}
\pi
J_{{\mathcal{M}}_{po}}(\pi)=J_{\text{Bayes}}(\pi)
P({\mathcal{M}}|{\mathcal{D}})
{\mathcal{S}}
{\mathcal{A}}
{\mathcal{M}}_{po}
\overline{{\mathcal{S}}}={\mathcal{S}}\times\mathbf{M}
\overline{s}\coloneqq(s,{\mathcal{M}})
{\mathcal{A}}
\overline{P}((s^{\prime},{\mathcal{M}}^{\prime})|(s,{\mathcal{M}}),a)=\delta({%
\mathcal{M}}={\mathcal{M}}^{\prime})P_{{\mathcal{M}}}(s^{\prime}|s,a)
{\mathcal{M}}
O((s,{\mathcal{M}}))=s
r((s,{\mathcal{M}}),a)=r_{\mathcal{M}}(s,a)
\rho((s,{\mathcal{M}}))=P({\mathcal{M}}|{\mathcal{D}})\rho_{{\mathcal{M}}}(s)
n\in\mathbb{N}
({\mathcal{D}},p({\mathcal{M}}))
n
J_{Bayes}(\pi_{\text{adaptive}}^{*})=-2n
J_{Bayes}(\pi_{\text{markov}}^{*})\leq-\frac{1}{2}n^{2}
O(n)
O(n^{2})
{\mathcal{M}}_{1},{\mathcal{M}}_{2}
\{-n,\dots,0,\dots,n\}
0
k
k-1
k+1
-1
{\mathcal{M}}_{1}
n
{\mathcal{M}}_{2}
-n
\gamma=1
p({\mathcal{M}}_{1}|{\mathcal{D}})=p({\mathcal{M}}_{2}|{\mathcal{D}})=\frac{1}%
{2}
p({\mathcal{M}})
p({\mathcal{M}}_{1})=p({\mathcal{M}}_{2})=\frac{1}{2}
n
-n
J_{Bayes}(\pi)=-\frac{1}{2}(T_{\pi}(n)+T_{\pi}(-n)
T_{\pi}(n)
\pi
n
T_{\pi}(-n)
p({\mathcal{M}}|{\mathcal{D}})
n
2n
{\mathcal{M}}_{1}
n
3n
J_{Bayes}(\pi_{\text{adaptive}}^{*})=\frac{1}{2}(-n)+\frac{1}{2}(-3n)=-2n
\pi(a|n)
p_{n}=\pi(\text{right}|n)
q_{n}=1-p_{n}
\ell_{n}=\frac{p_{n}}{q_{n}}
T_{\pi}(n)+T_{\pi}(-n)
T_{n,0}
T_{-n,0}
T_{n,0}
\pi
0
n
T_{-n,0}
T_{n,0}<T_{-n,0}
T_{n,0}=\underbrace{\mathbb{E}[\text{Time to reach n from 0}]}_{T_{0\to n}}+%
\underbrace{\mathbb{E}[\text{Time to reach 0 from n}]}_{T_{n\to 0}}.
p_{n}
q_{n}
T_{0\to n}
T_{n\to 0}
\displaystyle T_{0\to n}\geq\sum_{j=0}^{n-1}\sum_{k=j+1}^{n-1}\prod_{i=j}^{k}%
\ell_{i}
\displaystyle T_{0\to n}
\displaystyle\geq\sum_{j=0}^{n-1}\sum_{k=j+1}^{n-1}\prod_{i=j}^{k}\ell_{i}
\displaystyle T_{n\to 0}=\sum_{j=0}^{n-1}\sum_{k=j+1}^{n-1}\prod_{i=j}^{k}\ell%
_{i}^{-1}
\displaystyle T_{n\to 0}
\displaystyle=\sum_{j=0}^{n-1}\sum_{k=j+1}^{n-1}\prod_{i=j}^{k}\ell_{i}^{-1}
T_{n,0}=T_{n\to 0}+T_{0\to n}
\displaystyle T_{n,0}=T_{n\to 0}+T_{0\to n}\geq\sum_{j=0}^{n-1}\sum_{k=j+1}^{n%
-1}\left(\prod_{i=j}^{k}\ell_{i}\right)+\left(\prod_{i=j}^{k}\ell_{i}\right)^{%
-1}
\displaystyle T_{n,0}=T_{n\to 0}+T_{0\to n}
\displaystyle\geq\sum_{j=0}^{n-1}\sum_{k=j+1}^{n-1}\left(\prod_{i=j}^{k}\ell_{%
i}\right)+\left(\prod_{i=j}^{k}\ell_{i}\right)^{-1}
T_{0\to n}+T_{n\to 0}
\ell_{i}=1
p_{i}=q_{i}=\frac{1}{2}
i
n^{2}
T_{\pi}(n)+T_{\pi}(-n)
J_{Bayes}(\pi_{\text{markov}}^{*})\leq-\frac{1}{2}n^{2}
\pi(\cdot|s,{\bm{b}})
(s,{\bm{b}})
\overline{s}
\overline{s}\coloneqq(s,{\mathcal{M}})
s
{\mathcal{M}}
P(\overline{s}|h)
P(\overline{s}|h)
(s(h),{\bm{b}}(h))
\displaystyle P_{{\mathcal{M}}_{po}}(\overline{s}|h)=P_{{\mathcal{M}}_{po}}(s,%
{\mathcal{M}}|h)=P_{{\mathcal{M}}_{po}}(s|h)P_{{\mathcal{M}}_{po}}({\mathcal{M%
}}|h,s)
\displaystyle P_{{\mathcal{M}}_{po}}(\overline{s}|h)=P_{{\mathcal{M}}_{po}}(s,%
{\mathcal{M}}|h)
\displaystyle=P_{{\mathcal{M}}_{po}}(s|h)P_{{\mathcal{M}}_{po}}({\mathcal{M}}|%
h,s)
\displaystyle=\delta(s=s(h))P({\mathcal{M}}|h,{\mathcal{D}})
\displaystyle=\delta(s=s(h))P({\mathcal{M}}|h,{\mathcal{D}})
\displaystyle=\delta(s=s(h)){\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{%
\mathcal{D}}).
\displaystyle=\delta(s=s(h)){\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{%
\mathcal{D}}).
(s(h),{\bm{b}}(h))
P(\overline{s}|h)
{\bm{b}}(h)
P({\mathcal{M}}|h,{\mathcal{D}})
(s(h),{\bm{b}}(h))
J_{\text{Bayes}}(\pi_{\theta})=J_{{\mathcal{M}}_{po}}(\pi_{\theta})
\displaystyle\nabla_{\theta}J_{\text{Bayes}}(\pi_{\theta})=\mathbb{E}_{h\sim%
\pi}[\nabla_{\theta}\mathbb{E}_{a\sim\pi_{\theta}(\cdot|h)}[Q_{{\mathcal{M}}_{%
po}}^{\pi}(h,a)]],
\displaystyle\nabla_{\theta}J_{\text{Bayes}}(\pi_{\theta})=\mathbb{E}_{h\sim%
\pi}[\nabla_{\theta}\mathbb{E}_{a\sim\pi_{\theta}(\cdot|h)}[Q_{{\mathcal{M}}_{%
po}}^{\pi}(h,a)]],
Q_{{\mathcal{M}}_{po}}^{\pi}(h,a)
\pi
Q_{{\mathcal{M}}_{po}}^{\pi}(h,a)=\mathbb{E}_{{\mathcal{M}}\sim P({\mathcal{M}%
}|{\mathcal{D}})}[{\bm{b}}(h)({\mathcal{M}})Q_{\mathcal{M}}^{\pi}(h,a)]
p_{{\mathcal{M}}}^{\pi}(\tau)
(s_{0},a_{0},r_{0},s_{1},a_{1},\dots)
\pi
{\mathcal{M}}
p_{{\mathcal{M}}_{po}}^{\pi}(\tau)=\mathbb{E}_{{\mathcal{M}}\sim P({\mathcal{M%
}}|{\mathcal{D}})}[p_{\mathcal{M}}(\tau)]
T
h\coloneqq(s_{0},a_{0},r_{0},s_{1},\dots s_{T})
\pi
Q_{{\mathcal{M}}_{po}}^{\pi}(h,a)
\displaystyle Q_{{\mathcal{M}}_{po}}^{\pi}(h,a)=\mathbb{E}_{\tau\sim p_{{%
\mathcal{M}}_{po}}^{\pi}}\left[\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}|h=h,a=a\right]
\displaystyle Q_{{\mathcal{M}}_{po}}^{\pi}(h,a)
\displaystyle=\mathbb{E}_{\tau\sim p_{{\mathcal{M}}_{po}}^{\pi}}\left[\sum_{t=%
T}^{\infty}\gamma^{t-T}r_{t}|h=h,a=a\right]
\displaystyle=\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}_{po}}^{\pi}(\tau|h)d\tau
\displaystyle=\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}_{po}}^{\pi}(\tau|h)d\tau
\displaystyle=\int\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}}^{\pi}(\tau|h)P({\mathcal{M}}|{\mathcal{D}},h)d{\mathcal{M}}~{}d\tau
\displaystyle=\int\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}}^{\pi}(\tau|h)P({\mathcal{M}}|{\mathcal{D}},h)d{\mathcal{M}}~{}d\tau
\displaystyle=\int\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}}^{\pi}(\tau|h){\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{\mathcal%
{D}})d{\mathcal{M}}~{}d\tau
\displaystyle=\int\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}}^{\pi}(\tau|h){\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{\mathcal%
{D}})d{\mathcal{M}}~{}d\tau
\displaystyle=\int\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}}^{\pi}(\tau|h){\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{\mathcal%
{D}})d{\mathcal{M}}~{}d\tau
\displaystyle=\int\int\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)p_{{%
\mathcal{M}}}^{\pi}(\tau|h){\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{\mathcal%
{D}})d{\mathcal{M}}~{}d\tau
\displaystyle=\int\underbrace{\mathbb{E}_{\tau\sim p_{\mathcal{M}}^{\pi}}\left%
[\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)|h=h,a=a\right]}_{Q_{%
\mathcal{M}}^{\pi}(h,a)}{\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{\mathcal{D}%
})d{\mathcal{M}}~{}d\tau
\displaystyle=\int\underbrace{\mathbb{E}_{\tau\sim p_{\mathcal{M}}^{\pi}}\left%
[\left(\sum_{t=T}^{\infty}\gamma^{t-T}r_{t}\right)|h=h,a=a\right]}_{Q_{%
\mathcal{M}}^{\pi}(h,a)}{\bm{b}}(h)({\mathcal{M}})P({\mathcal{M}}|{\mathcal{D}%
})d{\mathcal{M}}~{}d\tau
\displaystyle=\mathbb{E}_{{\mathcal{M}}\sim P({\mathcal{M}}|{\mathcal{D}})}[{%
\bm{b}}(h)Q_{\mathcal{M}}^{\pi}(h,a)]
\displaystyle=\mathbb{E}_{{\mathcal{M}}\sim P({\mathcal{M}}|{\mathcal{D}})}[{%
\bm{b}}(h)Q_{\mathcal{M}}^{\pi}(h,a)]
T
h\coloneqq(s_{0},a_{0},r_{0},s_{1},\dots,s_{T})
{\bm{b}}_{t}
t
\pi
{\mathcal{M}}
a
Q_{\mathcal{M}}^{\pi}(h,a)=\mathbb{E}_{\pi,{\mathcal{M}}}[\sum_{t=T}^{\infty}%
\gamma^{t-T}r_{t}|h=h,a_{T}=a].
s_{T+1}\perp h~{}|~{}\left(s_{T},a_{T}\right)
{\mathcal{M}}
a_{T+1}\perp h~{}|~{}\left(s_{T},{\bm{b}}_{T}\right)
a_{T+1}
s_{T+1}
{\bm{b}}_{T+1}
\pi
{\bm{b}}_{T+1}
s_{T}
a_{T}
{\bm{b}}_{T}
h
s_{T}
{\bm{b}}_{T}
Q_{\mathcal{M}}^{\pi}(h,a)
h
s_{T}
{\bm{b}}_{T}
Q_{\mathcal{M}}^{\pi}(h,a)=Q_{\mathcal{M}}^{\pi}(s(h),{\bm{b}}(h),a).
Q_{\mathcal{M}}^{\pi}(h,a)
\displaystyle Q_{\mathcal{M}}^{\pi}(h,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}%
\sim P_{\mathcal{M}}(\cdot|s,a)}[\mathbb{E}_{a^{\prime}\sim\pi(\cdot|h\cup(s,a%
,r,s^{\prime})}[Q_{\mathcal{M}}^{\pi}(h\cup(s,a,r,s^{\prime}),a^{\prime})]]
\displaystyle Q_{\mathcal{M}}^{\pi}(h,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}%
\sim P_{\mathcal{M}}(\cdot|s,a)}[\mathbb{E}_{a^{\prime}\sim\pi(\cdot|h\cup(s,a%
,r,s^{\prime})}[Q_{\mathcal{M}}^{\pi}(h\cup(s,a,r,s^{\prime}),a^{\prime})]]
Q_{\mathcal{M}}^{\pi}
\pi
s
{\bm{b}}
\displaystyle Q_{\mathcal{M}}^{\pi}(s,{\bm{b}},a)=r(s,a)+\gamma\mathbb{E}_{s^{%
\prime}\sim P_{\mathcal{M}}(\cdot|s,a)}[\mathbb{E}_{a^{\prime}\sim\pi(\cdot|s^%
{\prime},{\bm{b}}^{\prime})}[Q_{\mathcal{M}}^{\pi}(s^{\prime},{\bm{b}}^{\prime%
},a^{\prime})]]
\displaystyle Q_{\mathcal{M}}^{\pi}(s,{\bm{b}},a)=r(s,a)+\gamma\mathbb{E}_{s^{%
\prime}\sim P_{\mathcal{M}}(\cdot|s,a)}[\mathbb{E}_{a^{\prime}\sim\pi(\cdot|s^%
{\prime},{\bm{b}}^{\prime})}[Q_{\mathcal{M}}^{\pi}(s^{\prime},{\bm{b}}^{\prime%
},a^{\prime})]]
{32\times 32\times 3}
(x,y)
T=50
\pi(a|s,{\bm{b}})=\operatorname*{arg\,max}_{a}\sum_{k}{\bm{b}}_{k}\hat{Q}_{k}(%
s,{\bm{b}},a)
Q
\operatorname*{arg\,max}_{a}{\bm{b}}_{k}\hat{Q}_{k}(s,{\bm{b}},a)
\pi(a|s)=\operatorname*{arg\,max}\text{mean}(\{\hat{Q}_{k}(s,a)\}_{k})-\beta%
\text{std}(\{\hat{Q}_{k}(s,a)\}_{k})
\gamma
p({\bm{b}})
{\bm{b}}
64\times 64\times 3
15
200
1000
\gamma
10^{6}
p({\bm{b}})
n
n=2
K
n
n
K
Q
\pi(\cdot|s,{\bm{b}})=\sum_{i=1}^{K}{\bm{b}}_{i}\pi_{i}(\cdot|s)
p({\bm{b}})=\text{SymmetricDirichlet}(.01)
K
n
n
\{n_{1},\dots n_{K}\}
n
\max_{i}n_{i}
\{Q_{1},\dots Q_{\max_{i}n_{i}}\}
K
i
Q_{i}^{\text{SAC-n}}
Q_{i}^{\text{SAC-n}}=\min\{Q_{1}^{i},\ldots,Q_{n_{i}}^{i}\}
n
n
10
20
500
N-2
n
n
\{2,\dots,N\}
N
n
N
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
