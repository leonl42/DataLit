X
Y
\pi_{\hat{\theta}}
\hat{\theta}
x
\pi_{\hat{\theta}}
\pi_{\phi}
\pi_{\hat{\theta}}
\phi
\hat{\theta}
R(\mu,\hat{y},y)
\mu,\hat{y},y
\mathcal{J}(\phi)=\mathbb{E}_{({x},{y})}[R({\mu},{\hat{y}},{y})-\beta\text{log%
}(\frac{\pi_{\phi}({x})}{\pi_{\hat{\theta}}({x})})],
\phi
\hat{\theta}
\beta
\pi_{\phi}
\mathcal{J}(\phi)
\phi
\mathcal{J}(\phi)
\nabla_{\phi}\mathbb{E}_{({x},{y})}[R({\mu},{\hat{y}},{y})]=\mathbb{E}_{({x},{%
y})}[R(\mu,\hat{y},y)\nabla_{\phi}\text{log}\pi_{\phi}(\mu,\hat{y}|x)]
R(\mu,\hat{y},y)
\pi_{\phi}
\pi_{\phi}
\pi_{\phi}
\pi_{\hat{\theta}}
\text{Diag}|\mathcal{F}|=\text{Diag}(\textbf{1}\oslash\nabla_{\phi}\text{log}(%
\pi_{\phi})\nabla_{\phi}\text{log}(\pi_{\phi})^{T}).
\phi=\phi+\eta(\sum_{s}((\text{Diag}|\mathcal{F}|)R(\mu,\hat{y},y)\nabla_{\phi%
}\text{log}\pi_{\phi}(\mu_{s},\hat{y}_{s}|x))-\beta\nabla_{\phi}\text{log}(%
\frac{\pi_{\phi}({x})}{\pi_{\hat{\theta}}({x})})),
s
x
D(\mathbf{p}|\boldsymbol{\alpha})
\mathbf{p}
S_{K}=\{\mathbf{p}|\sum_{k=1}^{K}p_{k}=1,p_{k}\geq 0\}
K
D(\mathbf{p}|\boldsymbol{\alpha})=\begin{cases}\frac{1}{B(\boldsymbol{\alpha})%
}\prod_{i=1}^{K}p_{i}^{\alpha_{i}-1}&\text{if }\mathbf{p}\in S_{K},\\
0&\text{otherwise },\end{cases}
B(\boldsymbol{\alpha})
\boldsymbol{\alpha}
\pi_{{\hat{\theta}}}(x)+1
{\alpha_{k}}/{\sum_{k}({\alpha_{k}})}
\sum_{k}({\alpha_{k}})
D(\mathbf{p}|\boldsymbol{\alpha})
\text{log}(\text{Categorical}(y|p))
\mathbf{p}
{L}_{\text{pretrain}}(\theta)=\int(\sum_{i=1}^{K}-y_{i}\text{log}(p_{i}))\frac%
{1}{B(\boldsymbol{\alpha})}\prod_{i=1}^{K}(p_{i})^{\alpha_{i}-1}d\mathbf{p}.
L_{\text{pretrain}}
\hat{\theta}\in\text{argmin}{L_{\text{pretrain}}(\theta)}
\pi_{\hat{\theta}}
-ln(\text{ECE})
\triangleright
E_{s}
E_{r}
\eta
R({\mu},{\hat{y}},{y})
\pi_{\theta}
e=0,1,\ldots,E_{s}
L_{\text{pretrain}}(\theta)
\theta\leftarrow\theta-\eta\nabla_{\theta}L_{\text{pretrain}}(\theta)
\hat{\theta}
\pi_{\phi}
\hat{\theta}
e=0,1,\ldots,E_{r}
\text{Diag}|\mathcal{F}|=\text{Diag}(\textbf{1}\oslash\nabla_{\phi}\text{log}(%
\pi_{\phi})\nabla_{\phi}\text{log}(\pi_{\phi})^{T})
\phi\leftarrow\phi+\eta(\sum_{s}((\text{Diag}|\mathcal{F}|)R(\mu,\hat{y},y)%
\nabla_{\phi}\text{log}\pi_{\phi}(\mu_{s},\hat{y}_{s}|x))-\beta\nabla_{\phi}%
\text{log}(\frac{\pi_{\phi}({x})}{\pi_{\hat{\theta}}({x})}))
\pi_{\phi}
256\times 256
\pm
\pm
\downarrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\downarrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\pm 0.31
\pm 0.19
\pm 0.43
\pm 0.22
\pm 0.03
\pm 0.44
\pm 0.22
\pm 0.62
\pm 0.17
\pm 0.04
\pm 0.37
\pm 0.12
\pm 0.23
\pm 0.11
\pm 0.06
\pm 0.54
\pm 0.27
\pm 0.85
\pm 0.10
\pm 0.07
\pm 0.58
\pm 0.53
\pm 0.50
\pm 0.12
\pm 0.05
\pm 0.42
\pm 0.40
\pm 0.77
\pm 0.04
\pm 0.03
\pm 0.62
\pm 0.34
\pm 1.22
\pm 0.31
\pm 0.04
\pm 0.91
\pm 0.53
\pm 0.93
\pm 0.22
\pm 0.07
\pm 1.12
\pm 0.65
\pm 0.61
\pm 0.25
\pm 0.10
\pm 1.15
\pm 0.61
\pm 0.88
\pm 0.40
\pm 0.08
\pm 0.88
\pm 0.25
\pm 0.54
\pm 0.19
\pm 0.03
3.25\%
0.83\%
\beta
\beta
