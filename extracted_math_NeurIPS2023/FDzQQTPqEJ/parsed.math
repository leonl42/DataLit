\mathbb{X}
\mu
\bm{t}(\bm{x})
\sigma
\bm{b}\neq\bm{0}
k_{\sigma,\bm{t},\mu}
\mathbb{R}^{d}
\Phi_{\bm{C},\bm{0}}
\operatorname{Id}(\bm{x})
\operatorname{erf}
(\cdot)_{+}^{p},p\in\mathbb{N}
\operatorname{LReLU}
\operatorname{GELU}
\cos
\mathbb{R}^{d}
\Phi_{\bm{C},\bm{m}}
\frac{\bm{x}}{\|\bm{x}\|_{2}}
\exp
\mathbb{S}^{d-1}
\operatorname{Id}(\bm{x})
\mathbb{R}^{d}
\Phi_{\bm{C},\bm{m}}
\{0,1,2,\ldots\}
(x!)^{-1}\nu
\mathbb{R}^{d}
\Phi_{\bm{C},\bm{m}}
\operatorname{Id}(\bm{x})
\cos
[0,1]^{d}
\Phi^{-1}(\bm{x})
\mathbb{R}^{d}
\Phi_{\bm{C},\bm{m}}
\operatorname{Id}(\bm{x})
\operatorname{Snake_{a}}
\operatorname{z}(\bm{V},\bm{\Theta})
k_{\sigma,\bm{t},\mu}
\operatorname{z}(\bm{V},\bm{\Theta})=\operatorname{Tr}(\bm{V}^{\top}\bm{V}\bm{%
K}_{\bm{\Theta}})
\bm{K}_{\bm{\Theta}}
k_{\sigma,\bm{t},\mu}
\Phi_{\bm{C},\bm{m}}
\bm{m}
\bm{C}
\nu
\bm{b}\neq\bm{0}
\bm{b}=\bm{0}
\sigma(\cdot)=\exp(\cdot/2)
\mu
\bm{t}
\operatorname{z}(\bm{V},\bm{\Theta})
k_{\sigma,\bm{t},\mu}
\operatorname{z}(\bm{V},\bm{\Theta})=\operatorname{Tr}(\bm{V}^{\top}\bm{V}\bm{%
K}_{\bm{\Theta}})
\bm{K}_{\bm{\Theta}}
k_{\sigma,\bm{t},\mu}
\Phi_{\bm{C},\bm{m}}
\bm{m}
\bm{C}
\nu
\bm{b}\neq\bm{0}
\bm{b}=\bm{0}
\sigma(\cdot)=\exp(\cdot/2)
\mu
\bm{t}
(\Omega,\mathcal{F},\mu)
\Omega\subseteq\mathbb{R}^{d}
\mathcal{F}
\mu
\bm{V}\in\mathbb{R}^{m\times n}
\bm{W}\in\mathbb{R}^{n\times D}
\bm{b}\in\mathbb{R}^{n}
\bm{f}:\mathbb{R}^{D}\to\mathbb{R}^{m}
\sigma
\mathbb{X}\in\mathcal{F}
P
p
\mu
2
\bm{f}
\displaystyle P(d\bm{x};\bm{V},\bm{\Theta})\triangleq\frac{\mu(d\bm{x})}{%
\operatorname{z}(\bm{V},\bm{\Theta})}\big{\|}\bm{f}\left(\bm{t}(\bm{x});\bm{V}%
,\bm{\Theta}\right)\big{\|}_{2}^{2},\quad\bm{f}(\bm{t};\bm{V},\bm{\Theta})=\bm%
{V}\sigma(\bm{W}\bm{t}+\bm{b}),\,\bm{\Theta}=(\bm{W},\bm{b}),
\displaystyle P(d\bm{x};\bm{V},\bm{\Theta})\triangleq\frac{\mu(d\bm{x})}{%
\operatorname{z}(\bm{V},\bm{\Theta})}\big{\|}\bm{f}\left(\bm{t}(\bm{x});\bm{V}%
,\bm{\Theta}\right)\big{\|}_{2}^{2},\quad\bm{f}(\bm{t};\bm{V},\bm{\Theta})=\bm%
{V}\sigma(\bm{W}\bm{t}+\bm{b}),\,\bm{\Theta}=(\bm{W},\bm{b}),
\operatorname{z}(\bm{V},\bm{\Theta})\triangleq\int_{\mathbb{X}}\big{\|}\bm{f}%
\left(\bm{t}(\bm{x});\bm{V},\bm{\Theta}\right)\big{\|}_{2}^{2}\mu(d\bm{x})
\mu
\bm{t}:\mathbb{X}\to\mathbb{R}^{D}
\bm{t}
\bm{t}
d
D
\sigma
(\bm{V},\bm{\Theta})
\mathbb{X}
\texttt{SNEFY}_{\mathbb{X},\bm{t},\sigma,\mu}
\bm{\mathsf{x}}
(\bm{V},\bm{\Theta})
\bm{\mathsf{x}}\sim\texttt{SNEFY}_{\mathbb{X},\bm{t},\sigma,\mu}(\bm{V},\bm{%
\Theta})
\bm{\mathsf{x}}\sim P(\cdot;\bm{V},\bm{\Theta})
\operatorname{z}(\bm{V},\bm{\Theta})
\displaystyle\operatorname{z}(\bm{V},\bm{\Theta})\triangleq\int_{\mathbb{X}}%
\big{\|}\bm{f}\left(\bm{t}(\bm{x});\bm{V},\bm{\Theta}\right)\big{\|}_{2}^{2}%
\mu(d\bm{x}),\quad\bm{f}(\bm{t};\bm{V},\bm{\Theta})=\bm{V}\sigma(\bm{W}\bm{t}+%
\bm{b}),\quad\bm{\Theta}=(\bm{W},\bm{b}).
\displaystyle\operatorname{z}(\bm{V},\bm{\Theta})
\displaystyle\triangleq\int_{\mathbb{X}}\big{\|}\bm{f}\left(\bm{t}(\bm{x});\bm%
{V},\bm{\Theta}\right)\big{\|}_{2}^{2}\mu(d\bm{x}),\quad\bm{f}(\bm{t};\bm{V},%
\bm{\Theta})=\bm{V}\sigma(\bm{W}\bm{t}+\bm{b}),\quad\bm{\Theta}=(\bm{W},\bm{b}).
\sigma
t
\mu
\mathbb{X}
a
\bm{a}
\bm{A}
\mathsf{a}
\bm{\mathsf{a}}
(0,\ldots,0)
\bm{0}
\bm{I}
\bm{w}_{i}
i
\bm{W}
\bm{v}_{\cdot,i}
i
\bm{V}
b_{i}
i
\bm{b}
\bm{\Theta}=(\bm{W},\bm{b})\in\mathbb{R}^{n\times(D+1)}
\bm{\theta}_{i}=(\bm{w}_{i},b_{i})\in\mathbb{R}^{D+1}
i
\bm{\Theta}
\Phi_{\bm{C},\bm{m}}
\bm{m}
\bm{C}
\Phi_{\bm{C}}=\Phi_{\bm{C},\bm{0}}
\Phi=\Phi_{\bm{I},\bm{0}}
\bm{f}:\mathbb{R}^{D}\to\mathbb{R}^{m}
\displaystyle\bm{f}(\bm{t};\bm{V},\bm{\Theta})=\bm{V}\sigma(\bm{W}\bm{t}+\bm{b})
\displaystyle\bm{f}(\bm{t};\bm{V},\bm{\Theta})=\bm{V}\sigma(\bm{W}\bm{t}+\bm{b})
\sigma
\bm{W}\in\mathbb{R}^{n\times D}
\bm{b}\in\mathbb{R}^{n}
\bm{V}\in\mathbb{R}^{m\times n}
\sigma
\bm{\theta}_{i}=(\bm{w}_{i},b_{i})
\bm{x}
k_{\sigma,\operatorname{Id},\Phi_{\bm{I}}}
\displaystyle k_{\sigma,\operatorname{Id},\Phi_{\bm{I}}}(\bm{\theta}_{i},\bm{%
\theta}_{j})\triangleq\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\sigma\big{(}\bm{w}_{%
i}^{\top}\bm{\mathsf{x}}+b_{i}\big{)}\sigma\big{(}\bm{w}_{j}^{\top}\bm{\mathsf%
{x}}+b_{j}\big{)}\big{]},\quad\bm{\mathsf{x}}\sim\mathcal{N}\big{(}\bm{0},\bm{%
I}\big{)}.
\displaystyle k_{\sigma,\operatorname{Id},\Phi_{\bm{I}}}(\bm{\theta}_{i},\bm{%
\theta}_{j})
\displaystyle\triangleq\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\sigma\big{(}\bm{w}_%
{i}^{\top}\bm{\mathsf{x}}+b_{i}\big{)}\sigma\big{(}\bm{w}_{j}^{\top}\bm{%
\mathsf{x}}+b_{j}\big{)}\big{]},\quad\bm{\mathsf{x}}\sim\mathcal{N}\big{(}\bm{%
0},\bm{I}\big{)}.
b_{i}=b_{j}=0
b_{i}=b_{j}=0
\sigma
\bm{t}
\bm{b}\neq\bm{0}
\bm{t}
\mu
\Phi
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})\triangleq%
\int_{\mathbb{X}}\sigma\big{(}\bm{w}_{i}^{\top}\bm{t}(\bm{x})+b_{i}\big{)}%
\sigma\big{(}\bm{w}_{j}^{\top}\bm{t}(\bm{x})+b_{j}\big{)}\mu(d\bm{x}).
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle\triangleq\int_{\mathbb{X}}\sigma\big{(}\bm{w}_{i}^{\top}\bm{t}(%
\bm{x})+b_{i}\big{)}\sigma\big{(}\bm{w}_{j}^{\top}\bm{t}(\bm{x})+b_{j}\big{)}%
\mu(d\bm{x}).
\bm{V}
\bm{V}
\bm{\Theta}=(\bm{W},\bm{b})
\bm{\theta}_{i},\bm{\theta}_{j}
\bm{\Theta}
\bm{V}
\displaystyle\operatorname{z}(\bm{V},\bm{\Theta})=\operatorname{Tr}\big{(}\bm{%
V}^{\top}\bm{V}\bm{K}_{\bm{\Theta}}\big{)}
\displaystyle\operatorname{z}(\bm{V},\bm{\Theta})
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\bm{K}_{\bm{\Theta}}%
\big{)}
k_{\sigma,\bm{t},\mu}
\bm{K}_{\bm{\Theta}}
ij
k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle P(d\bm{x};\bm{V},\bm{\Theta})=\frac{\operatorname{Tr}\big{(}\bm{%
V}^{\top}\bm{V}\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})\big{)}}{\operatorname{%
Tr}\big{(}\bm{V}^{\top}\bm{V}\bm{K}_{\bm{\Theta}}\big{)}}\mu(d\bm{x})=\frac{%
\operatorname{vec}(\bm{V}^{\top}\bm{V})^{\top}\operatorname{vec}(\widetilde{%
\bm{K}_{\bm{\Theta}}}(\bm{x}))}{\operatorname{vec}(\bm{V}^{\top}\bm{V})^{\top}%
\operatorname{vec}(\bm{K}_{\bm{\Theta}})}\mu(d\bm{x}),
\displaystyle P(d\bm{x};\bm{V},\bm{\Theta})
\displaystyle=\frac{\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\widetilde{\bm{%
K}_{\bm{\Theta}}}(\bm{x})\big{)}}{\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}%
\bm{K}_{\bm{\Theta}}\big{)}}\mu(d\bm{x})=\frac{\operatorname{vec}(\bm{V}^{\top%
}\bm{V})^{\top}\operatorname{vec}(\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x}))}{%
\operatorname{vec}(\bm{V}^{\top}\bm{V})^{\top}\operatorname{vec}(\bm{K}_{\bm{%
\Theta}})}\mu(d\bm{x}),
\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})
ij
\sigma(\bm{w}_{i}^{\top}\bm{t}(\bm{x})+b_{i})\sigma(\bm{w}_{j}^{\top}\bm{t}(%
\bm{x})+b_{j})^{\top}
\operatorname{Tr}\big{(}\bm{\sigma}^{\top}\bm{V}^{\top}\bm{V}\bm{\sigma}\big{)%
}=\operatorname{Tr}\big{(}\bm{V}\bm{\sigma}\bm{\sigma}^{\top}\bm{V}^{\top}\big%
{)}=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\bm{\sigma}\bm{\sigma}^{\top}%
\big{)}
\bm{t}(\bm{x})
\bm{\Theta}
k_{\sigma,\bm{t},\mu}
k_{\sigma,\bm{t},\mu}
(\sigma,\bm{t},\mu)
\mathcal{O}(d)
d
\operatorname{z}(\bm{V},\bm{\bm{\Theta}})
\mathcal{O}(m^{2}n+dn^{2})
n
m
\bm{V}
\operatorname{vec}(\bm{V}^{\top}\bm{V})
1
\bm{V}
\bm{M}\triangleq\bm{V}^{\top}\bm{V}
\min(m,n)
(\bm{M},\bm{\Theta})
\sigma
\bm{t}=\operatorname{Id}
\bm{b}=\bm{0}
k_{\sigma,\bm{t},\mu}
\sigma
\bm{t}
\mu
\Phi_{\bm{C},\bm{m}}
\Phi
k_{\sigma,\operatorname{Id},\Phi_{\bm{C},\bm{m}}}(\bm{\theta}_{i},\bm{\theta}_%
{j})=k_{\sigma,\operatorname{Id},\Phi}(\mathcal{T}\bm{\theta}_{i},\mathcal{T}%
\bm{\theta}_{j})
\mathcal{T}\bm{\Theta}=(\bm{W}\bm{A},\bm{b}+\bm{W}\bm{m})
\mathcal{T}\bm{\theta}_{i}=(\bm{w}_{i}^{\top}\bm{A},b_{i}+\bm{w}_{i}^{\top}\bm%
{m})
\bm{A}
\bm{C}=\bm{A}\bm{A}^{\top}
\bm{b}\neq\bm{0}
k_{\cos,\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})=\frac{\cos|b_%
{i}-b_{j}|}{2}\exp\big{(}\frac{-\|\bm{w}_{j}-\bm{w}_{j}\|^{2}}{2}\big{)}+\frac%
{\cos|b_{i}+b_{j}|}{2}\exp\big{(}\frac{-\|\bm{w}_{j}+\bm{w}_{j}\|^{2}}{2}\big{%
)}.
k_{\sin,\operatorname{Id},\Phi}
\sigma=\exp
\text{proj}_{\mathbb{S}^{d-1}}(\bm{x})\triangleq\bm{x}/\|\bm{x}\|
k_{\exp,\text{proj}_{\mathbb{S}^{d-1}},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})=%
\exp(b_{i}+b_{j})\frac{\Gamma(d/2)2^{d/2-1}I_{d/2-1}\big{(}\|\bm{w}_{i}+\bm{w}%
_{j}\|\big{)}}{\|\bm{w}_{i}+\bm{w}_{j}\|^{d/2-1}},
I_{p}
p
d=3
k_{\exp,\text{proj}_{\mathbb{S}^{2}},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})=%
\exp(b_{i}+b_{j})\frac{\left(e^{\left\|\bm{w}_{i}+\bm{w}_{j}\right\|}-e^{-%
\left\|\bm{w}_{i}+\bm{w}_{j}\right\|}\right)}{2\left\|\bm{w}_{i}+\bm{w}_{j}%
\right\|}.
\text{Snake}_{a}
\text{Snake}_{a}(z)=z+\frac{1}{a}\sin^{2}(az)=z-\frac{1}{2a}\cos(2az)+\frac{1}%
{2a}.
\text{Snake}_{a}
a
a=1
\text{Snake}_{a}(\cdot)-\frac{1}{2a}
k_{\operatorname{Id},\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})=%
\bm{w}_{i}^{\top}\bm{w}_{j}+b_{i}b_{j}
\operatorname{Snake_{a}}
k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},\operatorname{Id},\Phi}(\bm{%
\theta}_{i},\bm{\theta}_{j})
\displaystyle\frac{1}{4a^{2}}k_{\cos,\operatorname{Id},\Phi}(2a\bm{\theta}_{i}%
,2a\bm{\theta}_{j})+\bm{w}_{j}^{\top}\bm{w}_{j}\Big{(}\sin(2ab_{j})e^{-2a^{2}%
\|\bm{w}_{j}\|^{2}}+\sin(2ab_{i})e^{-2a^{2}\|\bm{w}_{i}\|^{2}}\Big{)}
\displaystyle\frac{1}{4a^{2}}k_{\cos,\operatorname{Id},\Phi}(2a\bm{\theta}_{i}%
,2a\bm{\theta}_{j})+\bm{w}_{j}^{\top}\bm{w}_{j}\Big{(}\sin(2ab_{j})e^{-2a^{2}%
\|\bm{w}_{j}\|^{2}}+\sin(2ab_{i})e^{-2a^{2}\|\bm{w}_{i}\|^{2}}\Big{)}
\displaystyle\phantom{{}={}}-\frac{b_{i}}{2a}\cos(2ab_{j})e^{-2a^{2}\|\bm{w}_{%
j}\|^{2}}-\frac{b_{j}}{2a}\cos(2ab_{i})e^{-2a^{2}\|\bm{w}_{i}\|^{2}}+k_{%
\operatorname{Id},\operatorname{Id},\Phi}(\bm{\theta}_{i}^{(1)},\bm{\theta}_{j%
}^{(1)}).
\displaystyle\phantom{{}={}}-\frac{b_{i}}{2a}\cos(2ab_{j})e^{-2a^{2}\|\bm{w}_{%
j}\|^{2}}-\frac{b_{j}}{2a}\cos(2ab_{i})e^{-2a^{2}\|\bm{w}_{i}\|^{2}}+k_{%
\operatorname{Id},\operatorname{Id},\Phi}(\bm{\theta}_{i}^{(1)},\bm{\theta}_{j%
}^{(1)}).
\operatorname{Snake_{a}}
k_{\operatorname{Snake_{a}},\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta%
}_{j})
\displaystyle\frac{1}{2a}\Big{(}b_{i}-\frac{1}{2a}\cos(2ab_{i})\exp(-2a^{2}\|%
\bm{w}_{i}\|^{2})+b_{j}-\frac{1}{2a}\cos(2ab_{j})\exp(-2a^{2}\|\bm{w}_{j}\|^{2%
})\Big{)}
\displaystyle\frac{1}{2a}\Big{(}b_{i}-\frac{1}{2a}\cos(2ab_{i})\exp(-2a^{2}\|%
\bm{w}_{i}\|^{2})+b_{j}-\frac{1}{2a}\cos(2ab_{j})\exp(-2a^{2}\|\bm{w}_{j}\|^{2%
})\Big{)}
\displaystyle\phantom{{}={}}+k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},%
\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})+\frac{1}{4a^{2}}.
\displaystyle\phantom{{}={}}+k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},%
\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})+\frac{1}{4a^{2}}.
\mu
\nu
\frac{d\mu}{d\nu}:\Omega\to[0,\infty)
p(\cdot\mid\bm{V},\bm{\Theta})
\nu
p(\bm{x}\mid\bm{V},\bm{\Theta})=\underbrace{\frac{d\mu}{d\nu}(\bm{x})}_{\text{%
Independent of $\bm{V},\bm{\Theta}$}}\times\underbrace{\frac{\big{\|}\bm{f}%
\left(\bm{t}(\bm{x});\bm{V},\bm{\Theta}\right)\big{\|}_{2}^{2}}{\operatorname{%
z}(\bm{V},\bm{\Theta})}.}_{\text{Depends on $\bm{x}$ only through $\bm{t}(\bm{%
x})$}}
\bm{V},\bm{\Theta}
\bm{x}
\bm{t}(\bm{x})
\bm{t}
\bm{V},\bm{\Theta}
\sigma(u)=\exp(u/2)
\bm{b}
\bm{V}
\exp(b_{i})
\bm{x}
v_{i}
\displaystyle P(d\bm{x};\bm{V},\bm{W})=\frac{1}{\operatorname{Tr}(\bm{V}^{\top%
}\bm{V}\bm{K}_{\bm{\Theta}}\big{)}}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{v}_{\cdot,i%
}^{\top}\bm{v}_{\cdot,j}\exp\left(\frac{1}{2}(\bm{w}_{i}+\bm{w}_{j})^{\top}\bm%
{t}(\bm{x})\right)\mu(d\bm{x}),
\displaystyle P(d\bm{x};\bm{V},\bm{W})
\displaystyle=\frac{1}{\operatorname{Tr}(\bm{V}^{\top}\bm{V}\bm{K}_{\bm{\Theta%
}}\big{)}}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{v}_{\cdot,i}^{\top}\bm{v}_{\cdot,j}%
\exp\left(\frac{1}{2}(\bm{w}_{i}+\bm{w}_{j})^{\top}\bm{t}(\bm{x})\right)\mu(d%
\bm{x}),
P_{e}\left(\cdot;\frac{1}{2}(\bm{w}_{i}+\bm{w}_{j})\right)
P_{e}
\displaystyle P_{e}(d\bm{x};\bm{w})=\frac{1}{\operatorname{z}_{e}(\bm{w})}\exp%
\big{(}\bm{w}^{\top}\bm{t}(\bm{x})\big{)}\mu(d\bm{x}),\quad\operatorname{z}_{e%
}(\bm{w})=\int_{\mathbb{X}}\exp\big{(}\bm{w}^{\top}\bm{t}(\bm{x})\big{)}\mu(d%
\bm{x}).
\displaystyle P_{e}(d\bm{x};\bm{w})=\frac{1}{\operatorname{z}_{e}(\bm{w})}\exp%
\big{(}\bm{w}^{\top}\bm{t}(\bm{x})\big{)}\mu(d\bm{x}),
\displaystyle\quad\operatorname{z}_{e}(\bm{w})=\int_{\mathbb{X}}\exp\big{(}\bm%
{w}^{\top}\bm{t}(\bm{x})\big{)}\mu(d\bm{x}).
n=m=1
v_{11}^{2}
\mu
\mathbb{X}
\bm{t}
\bm{w}_{1}
\operatorname{z}_{e}(\bm{w}_{1})
m>1
n>1
\bm{V}^{\top}\bm{V}
\bm{V}^{\top}\bm{V}
\min(m,n)
m>1
n>1
\bm{V}^{\top}\bm{V}
\bm{V}
n
\bm{K}_{\bm{\Theta}}
\operatorname{z}_{e}(\bm{w})
\displaystyle k_{\exp(\cdot/2),\bm{t},\mu}(\bm{w}_{i},\bm{w}_{j})=%
\operatorname{z}_{e}\left(\frac{1}{2}(\bm{w}_{i}+\bm{w}_{j})\right).
\displaystyle k_{\exp(\cdot/2),\bm{t},\mu}(\bm{w}_{i},\bm{w}_{j})=
\displaystyle\operatorname{z}_{e}\left(\frac{1}{2}(\bm{w}_{i}+\bm{w}_{j})%
\right).
\bm{w}_{i}
P_{e}
\sigma(u)=\exp(u/2)
\Psi=\log\operatorname{z}(\bm{V},\bm{\Theta})
\text{Then}\quad\sum_{i=1}^{n}\frac{\partial\Psi}{\partial\bm{w}_{i}}=\mathbb{%
E}\left[\bm{t}\left(\mathsf{x}\right)\right]\quad\text{and}\quad\sum_{i=1}^{n}%
\sum_{j=1}^{n}\frac{\partial^{2}\Psi}{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}=%
\mathbb{E}\left[\bm{t}\left(\mathsf{x}\right)\bm{t}\left(\mathsf{x}\right)^{%
\top}\right]-\mathbb{E}\left[\bm{t}\left(\mathsf{x}\right)\right]\mathbb{E}%
\left[\bm{t}\left(\mathsf{x}\right)\right]^{\top}.
\bm{\mathsf{x}}=(\bm{\mathsf{x}}_{1},\bm{\mathsf{x}}_{2})
\texttt{SNEFY}{}_{\mathbb{X}_{1}\times\mathbb{X}_{2},\bm{t},\sigma,\mu}
\bm{V}
\bm{\Theta}=(\left[\bm{W_{1}},\bm{W_{2}}\right],\bm{b})
\mu(d\bm{x})=\mu_{1}(d\bm{x}_{1})\mu_{2}(d\bm{x}_{2})
\bm{t}(\bm{x})=\big{(}\bm{t}_{1}(\bm{x}_{1}),\bm{t}_{2}(\bm{x}_{2})\big{)}
\bm{\mathsf{x}}_{1}
\bm{\mathsf{x}}_{2}=\bm{x}_{2}
\texttt{SNEFY}{}_{\mathbb{X}_{1},\bm{t}_{1},\sigma,\mu_{1}}
\bm{V}
\bm{\Theta}_{1\mid 2}\triangleq(\bm{W_{1}},\bm{W_{2}}\bm{t}_{2}(\bm{x}_{2})+%
\bm{b})
\bm{x}_{2}
\sigma
\bm{t}_{2}
\bm{t}_{2}
\sigma
\sigma=\exp(\cdot/2)
\sigma
\bm{\mathsf{x}}=(\bm{\mathsf{x}}_{1},\bm{\mathsf{x}}_{2})
\texttt{SNEFY}{}_{\mathbb{X}_{1}\times\mathbb{X}_{2},\bm{t},\sigma,\mu}
\bm{V}
\bm{\Theta}=(\left[\bm{W_{1}},\bm{W_{2}}\right],\bm{b})
\mu(d\bm{x})=\mu_{1}(d\bm{x}_{1})\mu_{2}(d\bm{x}_{2})
\bm{t}(\bm{x})=\big{(}\bm{t}_{1}(\bm{x}_{1}),\bm{t}_{2}(\bm{x}_{2})\big{)}
\bm{\mathsf{x}}_{1}
\displaystyle P_{1}(d\bm{x}_{1})=\frac{\operatorname{Tr}\big{(}\bm{V}^{\top}%
\bm{V}\widetilde{\bm{C}}_{\bm{\bm{\Theta}}}(\bm{x}_{1})\big{)}}{\operatorname{%
z}(\bm{V},\bm{\Theta})}\mu_{1}(d\bm{x}_{1}),
\displaystyle P_{1}(d\bm{x}_{1})
\displaystyle=\frac{\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\widetilde{\bm{%
C}}_{\bm{\bm{\Theta}}}(\bm{x}_{1})\big{)}}{\operatorname{z}(\bm{V},\bm{\Theta}%
)}\mu_{1}(d\bm{x}_{1}),
\widetilde{C}(\bm{x}_{1})_{ij}=k_{\sigma,\bm{t}_{2},\mu_{2}}\Big{(}\big{(}\bm{%
w}_{2i},\bm{w}_{1i}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{i}\big{)},\big{(}\bm{w}_{2%
j},\bm{w}_{1j}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\big{)}\Big{)}
\bm{\mathsf{x}}
\texttt{SNEFY}_{\mathbb{R}^{2},\operatorname{Id},\operatorname{Snake_{a}},\Phi}
n=100
m=1
v_{ij}\sim\mathcal{N}(0,1/n)
w_{ij}\sim\mathcal{N}(0,4)
\bm{b}=\bm{0}
50
\mathbb{R}^{d}
1.00
\mathbb{X}
\texttt{SNEFY}{}_{\mathbb{S}^{2},\operatorname{Id},\exp,d\bm{x}}
n=m=30
\texttt{SNEFY}_{\mathbb{R}^{2},\operatorname{Id},\operatorname{Snake_{a}},\Phi}
n=100
m=1
v_{ij}\sim\mathcal{N}(0,1/n)
w_{ij}\sim\mathcal{N}(0,4)
\bm{b}=\bm{0}
50
\mathbb{R}^{d}
1.00
\mathbb{X}
\texttt{SNEFY}{}_{\mathbb{S}^{2},\operatorname{Id},\exp,d\bm{x}}
n=m=30
\bm{\psi}:\mathbb{X}\to\mathbb{H}
\mathbb{H}
\mathbb{S}(\mathbb{H})
\bm{A}:\mathbb{H}\to\mathbb{H}
\displaystyle h_{\bm{A}}(\bm{x})=\left\langle\bm{\psi}(\bm{x}),\bm{A}\bm{\psi}%
(\bm{x})\right\rangle_{\mathbb{H}}
\displaystyle h_{\bm{A}}(\bm{x})=\left\langle\bm{\psi}(\bm{x}),\bm{A}\bm{\psi}%
(\bm{x})\right\rangle_{\mathbb{H}}
\bm{A}\in\mathbb{S}(\mathbb{H})
\bm{A}
\bm{\psi}
\operatorname{Tr}\Big{(}\bm{A}\int_{\mathbb{X}}\bm{\psi}(\bm{x})\otimes\bm{%
\psi}(\bm{x})\mu(d\bm{x})\Big{)}
\operatorname{z}(\bm{V},\bm{\Theta})=\operatorname{Tr}(\bm{V}^{\top}\bm{V}\bm{%
K}_{\bm{\Theta}})
\bm{A}
\bm{V}^{\top}\bm{V}
\int_{\mathbb{X}}\bm{\psi}(\bm{x})\otimes\bm{\psi}(\bm{x})\mu(d\bm{x})
\bm{K}_{\bm{\Theta}}=\int_{\mathbb{X}}\sigma(\bm{W}\bm{t}(\bm{x})+\bm{b})%
\sigma(\bm{W}\bm{t}(\bm{x})+\bm{b})^{\top}\mu(d\bm{x})
\bm{A}
\{\bm{x}_{\ell}\}_{\ell=1}^{N}
n
N
\displaystyle h_{\bm{M}}(\bm{x})=[\kappa(\bm{x},\bm{x}_{1}),\ldots,\ldots,%
\kappa(\bm{x},\bm{x}_{N})]^{\top}\bm{M}[\kappa(\bm{x},\bm{x}_{1}),\ldots,%
\ldots,\kappa(\bm{x},\bm{x}_{N})]
\displaystyle h_{\bm{M}}(\bm{x})=[\kappa(\bm{x},\bm{x}_{1}),\ldots,\ldots,%
\kappa(\bm{x},\bm{x}_{N})]^{\top}\bm{M}[\kappa(\bm{x},\bm{x}_{1}),\ldots,%
\ldots,\kappa(\bm{x},\bm{x}_{N})]
\bm{M}\in\mathbb{R}^{N\times N}
\kappa(\bm{x}_{i},\bm{x}_{j})=\left\langle\bm{\psi}(\bm{x}_{i}),\bm{\psi}(\bm{%
x})\right\rangle_{\mathbb{H}}
\int\kappa(\bm{x}_{i},\bm{x})\kappa(\bm{x},\bm{x}_{j})\mu(d\bm{x})
\kappa
\mu
\kappa
\mu
\bm{w}_{i}
\kappa
\bm{\psi}
\kappa
\bm{M}
\kappa
\bm{W}
\bm{\psi}
\bm{V}
\bm{\psi}
\sigma=\cos
\bm{t}=\operatorname{Id}
\mathbb{X}=\mathbb{R}^{d}
m=1
n=50
0
16
1,2,4
8
-1.59\pm 0.02
-1.60\pm 0.02
-3.29\pm 0.02
-1.59\pm 0.04
-1.57\pm 0.03
-1.59\pm 0.02
-1.68\pm 0.24
-1.57\pm 0.03
241
66817
4
50
19281
85857
19044
19090
1200.84\pm 109.77
541.11\pm 12.20
606.35\pm 20.29
629.11\pm 14.57
2844.09\pm 254.02
1867.26\pm 167.75
2226.37\pm 174.80
2276.78\pm 211.15
-1.92\pm 0.03
-2.42\pm 0.22
-3.55\pm 0.01
-2.07\pm 0.07
-1.92\pm 0.04
-1.96\pm 0.04
-2.22\pm 0.30
-1.93\pm 0.03
241
66817
4
50
19281
85857
19044
19090
643.80\pm 150.84
166.35\pm 20.59
52.63\pm 3.96
73.52\pm 5.47
2272.15\pm 281.76
1533.30\pm 158.90
1660.77\pm 169.02
1673.54\pm 166.84
-2.41\pm 0.05
-2.62\pm 0.01
-3.26\pm 0.01
-2.67\pm 0.03
-2.34\pm 0.10
-2.36\pm 0.14
-2.51\pm 0.22
-2.31\pm 0.04
241
66817
4
50
19281
85857
19044
19090
997.73\pm 107.80
409.77\pm 19.37
416.23\pm 18.11
433.82\pm 16.06
2654.22\pm 269.14
1774.06\pm 182.25
2045.65\pm 170.80
2070.60\pm 177.06
\pm
\pm
\pm
\pm
50
\bm{V}
\bm{V}
n=m=1
1.38\pm 9.64\times 10^{-3}
1.46\pm 0.016
2.34\pm 0.26
111.18\pm 2.58
109.12\pm 0.80
61.88\pm 0.33
\pm
\bm{V}
\mathsf{x}_{1}\in\mathbb{R}
\bm{x}_{2}\in\mathbb{R}^{5}
\bm{x}_{2}
\sigma=\operatorname{Snake_{a}}
\bm{t}=\operatorname{Id}
\mathbb{X}=\mathbb{R}
[2^{5}n,2^{4}n,2^{3}n,2^{2}n,2n]
m=n/2
\bm{t}_{2}
\downarrow
n=32
-2.195\pm 0.024
495.720\pm 22.561
179748
n=16
-2.172\pm 0.034
404.291\pm 57.605
46356
n=8
-2.108\pm 0.089
390.870\pm 16.028
12300
L=4
-2.156\pm 0.018
202.1290\pm 10.380
1413
L=2
-2.163\pm 0.024
155.090\pm 15.809
1155
L=1
-2.171\pm 0.012
122.304\pm 1.194
1026
-2.148
391.867
74309\times 6
\pm
\pm
\mathbb{R}^{74309\times 6}
256
q
74557\times 6
1-q
\sigma
\mathbb{X}
r
\mathcal{O}\big{(}r\log_{2}|\mathbb{X}|+rd\log_{2}\frac{2}{\rho}\big{)}
\rho
d
\bm{t}_{2}
\sigma(\cdot)=\exp(i\cdot)
k_{\exp(i\cdot),\operatorname{Id},\mu}
\bm{V}
\cos
\sin
\mu
L
\mathcal{O}(n^{2L})
\sigma
\mathcal{O}(n^{2})
\mathcal{O}(N^{3})
\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})
ij
\sigma(\bm{w}_{i}^{\top}\bm{t}(\bm{x})+b_{i})\sigma(\bm{w}_{j}^{\top}\bm{t}(%
\bm{x})+b_{j})^{\top}
\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\widetilde{\bm{K}_{\bm{\Theta}}}(%
\bm{x})\big{)}
\displaystyle\big{\|}\bm{V}\sigma(\bm{W}\bm{t}(\bm{x})+\bm{b})\big{\|}_{2}^{2}%
=\sum_{i=1}^{m}\sum_{j_{1}=1}^{n}\sum_{j_{2}=1}^{n}v_{ij_{1}}v_{ij_{2}}\sigma%
\big{(}\bm{w}_{j_{1}}^{\top}\bm{t}(x)+b_{j_{1}}\big{)}\sigma\big{(}\bm{w}_{j_{%
2}}^{\top}\bm{t}(x)+b_{j_{2}}\big{)}
\displaystyle\big{\|}\bm{V}\sigma(\bm{W}\bm{t}(\bm{x})+\bm{b})\big{\|}_{2}^{2}
\displaystyle=\sum_{i=1}^{m}\sum_{j_{1}=1}^{n}\sum_{j_{2}=1}^{n}v_{ij_{1}}v_{%
ij_{2}}\sigma\big{(}\bm{w}_{j_{1}}^{\top}\bm{t}(x)+b_{j_{1}}\big{)}\sigma\big{%
(}\bm{w}_{j_{2}}^{\top}\bm{t}(x)+b_{j_{2}}\big{)}
\displaystyle=\sum_{j_{1}=1}^{n}\sum_{j_{2}=1}^{n}\bm{v}_{\cdot,j_{1}}^{\top}%
\bm{v}_{\cdot,j_{2}}\sigma\big{(}\bm{w}_{j_{1}}^{\top}\bm{t}(x)+b_{j_{1}}\big{%
)}\sigma\big{(}\bm{w}_{j_{2}}^{\top}\bm{t}(x)+b_{j_{2}}\big{)}
\displaystyle=\sum_{j_{1}=1}^{n}\sum_{j_{2}=1}^{n}\bm{v}_{\cdot,j_{1}}^{\top}%
\bm{v}_{\cdot,j_{2}}\sigma\big{(}\bm{w}_{j_{1}}^{\top}\bm{t}(x)+b_{j_{1}}\big{%
)}\sigma\big{(}\bm{w}_{j_{2}}^{\top}\bm{t}(x)+b_{j_{2}}\big{)}
\displaystyle=\langle\bm{V}^{\top}\bm{V},\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{%
x})\rangle_{F}
\displaystyle=\langle\bm{V}^{\top}\bm{V},\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{%
x})\rangle_{F}
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\widetilde{\bm{K}_{%
\bm{\Theta}}}(\bm{x})\big{)},
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\widetilde{\bm{K}_{%
\bm{\Theta}}}(\bm{x})\big{)},
\bm{v}_{\cdot,j_{1}}
j_{1}
\bm{V}
\langle\cdot,\cdot\rangle_{F}
\displaystyle\operatorname{z}(\bm{V},\bm{\Theta})=\int_{\mathbb{X}}\big{\|}\bm%
{V}\sigma(\bm{W}\bm{t}(\bm{x})+\bm{b})\big{\|}_{2}^{2}\mu(d\bm{x})
\displaystyle\operatorname{z}(\bm{V},\bm{\Theta})
\displaystyle=\int_{\mathbb{X}}\big{\|}\bm{V}\sigma(\bm{W}\bm{t}(\bm{x})+\bm{b%
})\big{\|}_{2}^{2}\mu(d\bm{x})
\displaystyle=\int_{\mathbb{X}}\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}%
\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})\big{)}\mu(d\bm{x})
\displaystyle=\int_{\mathbb{X}}\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}%
\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})\big{)}\mu(d\bm{x})
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\int_{\mathbb{X}}%
\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})\mu(d\bm{x})\big{)}
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\int_{\mathbb{X}}%
\widetilde{\bm{K}_{\bm{\Theta}}}(\bm{x})\mu(d\bm{x})\big{)}
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\bm{K}_{\bm{\Theta}}%
\big{)}.
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\bm{K}_{\bm{\Theta}}%
\big{)}.
\sum_{i=1}^{n}\frac{\partial\Psi}{\partial\bm{w}_{i}}=\frac{1}{\operatorname{z%
}}\sum_{i=1}^{n}\frac{\partial\operatorname{z}}{\partial\bm{w}_{i}}
\displaystyle\operatorname{z}=\sum_{i,j}\bm{v_{\cdot,i}}^{\top}\bm{v_{\cdot,j}%
}\int\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})\right)\exp\left(%
\frac{1}{2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right),
\displaystyle\operatorname{z}
\displaystyle=
\displaystyle\sum_{i,j}\bm{v_{\cdot,i}}^{\top}\bm{v_{\cdot,j}}\int\exp\left(%
\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})\right)\exp\left(\frac{1}{2}\bm{w}_{%
j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right),
\displaystyle\frac{\partial\operatorname{z}}{\partial\bm{w}_{i}}=\|\bm{v_{%
\cdot,i}}\|^{2}\int\bm{t}(\bm{x})\exp\left(\bm{w}_{i}^{\top}\bm{t}(\bm{x})%
\right)\mu\left(d\bm{x}\right)+\bm{v_{\cdot,i}}^{\top}\sum_{j\neq i}\bm{v_{%
\cdot,j}}\int\bm{t}(\bm{x})\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x}%
)\right)\exp\left(\frac{1}{2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d%
\bm{x}\right)=\bm{v_{\cdot,i}}^{\top}\sum_{j}\bm{v_{\cdot,j}}\int\bm{t}(\bm{x}%
)\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})\right)\exp\left(\frac{1}%
{2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right).
\displaystyle\frac{\partial\operatorname{z}}{\partial\bm{w}_{i}}
\displaystyle=
\displaystyle\|\bm{v_{\cdot,i}}\|^{2}\int\bm{t}(\bm{x})\exp\left(\bm{w}_{i}^{%
\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right)
\displaystyle+\bm{v_{\cdot,i}}^{\top}\sum_{j\neq i}\bm{v_{\cdot,j}}\int\bm{t}(%
\bm{x})\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})\right)\exp\left(%
\frac{1}{2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right)
\displaystyle=
\displaystyle\bm{v_{\cdot,i}}^{\top}\sum_{j}\bm{v_{\cdot,j}}\int\bm{t}(\bm{x})%
\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})\right)\exp\left(\frac{1}{%
2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right).
i
\sum_{i=1}^{n}\frac{\partial\Psi}{\partial\bm{w}_{i}}=\int\bm{t}(\bm{x})P(d\bm%
{x})
\displaystyle\sum_{i,j}\frac{\partial^{2}\Psi}{\partial\bm{w}_{i}\bm{w}_{j}^{%
\top}}=\frac{1}{\operatorname{z}}\sum_{i,j}\frac{\partial^{2}\operatorname{z}}%
{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}-\left(\frac{1}{\operatorname{z}}\sum_{i}%
\frac{\partial\operatorname{z}}{\partial\bm{w}_{i}}\right)\left(\frac{1}{%
\operatorname{z}}\sum_{j}\frac{\partial\operatorname{z}}{\partial\bm{w}_{j}^{%
\top}}\right)
\displaystyle\sum_{i,j}\frac{\partial^{2}\Psi}{\partial\bm{w}_{i}\bm{w}_{j}^{%
\top}}
\displaystyle=
\displaystyle\frac{1}{\operatorname{z}}\sum_{i,j}\frac{\partial^{2}%
\operatorname{z}}{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}-\left(\frac{1}{%
\operatorname{z}}\sum_{i}\frac{\partial\operatorname{z}}{\partial\bm{w}_{i}}%
\right)\left(\frac{1}{\operatorname{z}}\sum_{j}\frac{\partial\operatorname{z}}%
{\partial\bm{w}_{j}^{\top}}\right)
\frac{\partial^{2}\operatorname{z}}{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}=%
\begin{cases}\frac{1}{2}\bm{v_{\cdot,i}}^{\top}\bm{v_{\cdot,j}}\int\bm{t}(\bm{%
x})\bm{t}(\bm{x})^{\top}\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})%
\right)\exp\left(\frac{1}{2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})\right)\mu\left(d%
\bm{x}\right),&\text{if $i\neq j$,}\\
\|\bm{v_{\cdot,i}}\|^{2}\int\bm{t}(\bm{x})\bm{t}(\bm{x})^{\top}\exp\left(\bm{w%
}_{i}^{\top}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right)&\\
\qquad+\frac{1}{2}\bm{v_{\cdot,i}}^{\top}\sum_{r\neq i}\bm{v_{\cdot,j}}\int\bm%
{t}(\bm{x})\bm{t}(\bm{x})^{\top}\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}\bm{t}(%
\bm{x})\right)\exp\left(\frac{1}{2}\bm{w}_{r}^{\top}\bm{t}(\bm{x})\right)\mu%
\left(d\bm{x}\right),&\text{if $i=j$.}\end{cases}
i\neq j
i=j
\displaystyle\frac{1}{\operatorname{z}}\sum_{i,j}\frac{\partial^{2}%
\operatorname{z}}{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}=\frac{1}{\operatorname{%
z}}\sum_{i=1}^{n}\left(\frac{\partial^{2}\operatorname{z}}{\partial\bm{w}_{i}%
\bm{w}_{i}^{\top}}+\sum_{j\neq i}\frac{\partial^{2}\operatorname{z}}{\partial%
\bm{w}_{i}\bm{w}_{j}^{\top}}\right)=\frac{1}{\operatorname{z}}\sum_{i,j}\bm{v_%
{i}}^{\top}\bm{v_{j}}\int\bm{t}(\bm{x})\bm{t}(\bm{x})^{\top}\exp\left(\frac{1}%
{2}\bm{w}_{i}^{\top}\bm{t}(\bm{x})\right)\exp\left(\frac{1}{2}\bm{w}_{j}^{\top%
}\bm{t}(\bm{x})\right)\mu\left(d\bm{x}\right)=\int\bm{t}(\bm{x})\bm{t}(\bm{x})%
^{\top}P(d\bm{x}),
\displaystyle\frac{1}{\operatorname{z}}\sum_{i,j}\frac{\partial^{2}%
\operatorname{z}}{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}
\displaystyle=
\displaystyle\frac{1}{\operatorname{z}}\sum_{i=1}^{n}\left(\frac{\partial^{2}%
\operatorname{z}}{\partial\bm{w}_{i}\bm{w}_{i}^{\top}}+\sum_{j\neq i}\frac{%
\partial^{2}\operatorname{z}}{\partial\bm{w}_{i}\bm{w}_{j}^{\top}}\right)
\displaystyle=
\displaystyle\frac{1}{\operatorname{z}}\sum_{i,j}\bm{v_{i}}^{\top}\bm{v_{j}}%
\int\bm{t}(\bm{x})\bm{t}(\bm{x})^{\top}\exp\left(\frac{1}{2}\bm{w}_{i}^{\top}%
\bm{t}(\bm{x})\right)\exp\left(\frac{1}{2}\bm{w}_{j}^{\top}\bm{t}(\bm{x})%
\right)\mu\left(d\bm{x}\right)
\displaystyle=
\displaystyle\int\bm{t}(\bm{x})\bm{t}(\bm{x})^{\top}P(d\bm{x}),
\mathbb{E}\left[\bm{t}\left(\mathsf{x}\right)\right]
\bm{W}
\bm{t}(\bm{x})
\{\bm{\mathsf{x}}_{\ell}\}_{\ell=1}^{N}
\sigma(u)=\exp(\frac{1}{2}u)
\bm{W}
\bm{m}=\mathbb{E}\left[\bm{t}\left(\bm{\mathsf{x}}\right)\right]
\bm{m}
\hat{\bm{m}}=\frac{1}{N}\sum_{\ell=1}^{N}\bm{t}(\bm{x}_{\ell})
\sum_{\ell=1}^{N}\log p(\bm{x}_{\ell};\bm{V},\bm{\Theta})=\text{const}+\sum_{%
\ell=1}^{N}\log\|\bm{f}(\bm{t}(\bm{x}_{\ell});\bm{V},\bm{\Theta})\|^{2}_{2}-N\Psi
\{\bm{w}_{i}^{\ast}\}_{i=1}^{n}
\bm{W}
\sum_{\ell=1}^{N}\frac{\partial\log\|\bm{f}(\bm{t}(\bm{x}_{\ell});\bm{V},\bm{%
\Theta})\|^{2}_{2}}{\partial\bm{w}_{i}^{\ast}}=N\frac{\partial\Psi}{\partial%
\bm{w}_{i}^{\ast}},\quad i=1,\ldots,n.
\sum_{i=1}^{n}\frac{\partial\log\|\bm{f}(\bm{t}(\bm{x}_{\ell});\bm{V},\bm{%
\Theta})\|^{2}_{2}}{\partial\bm{w}_{i}}=\bm{t}(\bm{x}_{\ell}),
i
N
\{\bm{w}_{i}^{\ast}\}_{i=1}^{n}
\{\bm{w}_{i}^{\ast}\}_{i=1}^{n}
\hat{\bm{m}}
\bm{\mathsf{x}}
\displaystyle P(d\bm{x};\bm{V},\bm{\Theta})\propto\Big{\|}\bm{V}\sigma\big{(}%
\bm{W}_{1}\bm{t}_{1}(\bm{x}_{1})+\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}\big{)%
}\Big{\|}_{2}^{2}\mu(d\bm{x}).
\displaystyle P(d\bm{x};\bm{V},\bm{\Theta})\propto\Big{\|}\bm{V}\sigma\big{(}%
\bm{W}_{1}\bm{t}_{1}(\bm{x}_{1})+\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}\big{)%
}\Big{\|}_{2}^{2}\mu(d\bm{x}).
\bm{\mathsf{x}}_{1}
\bm{\mathsf{x}}_{2}=\bm{x}_{2}
\bm{\mathsf{x}}_{2}
\bm{x}_{1}
\displaystyle P_{1}\Big{(}d\bm{x}_{1}\mid\bm{x}_{2};\bm{V},\big{(}\bm{W}_{1},%
\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}\big{)}\Big{)}\propto\Big{(}\bm{V}%
\sigma\big{(}\bm{W}_{1}\bm{t}_{1}(\bm{x}_{1})+\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})%
+\bm{b}\big{)}\Big{)}^{2}\mu_{1}(d\bm{x}_{1}).
\displaystyle P_{1}\Big{(}d\bm{x}_{1}\mid\bm{x}_{2};\bm{V},\big{(}\bm{W}_{1},%
\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}\big{)}\Big{)}\propto\Big{(}\bm{V}%
\sigma\big{(}\bm{W}_{1}\bm{t}_{1}(\bm{x}_{1})+\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})%
+\bm{b}\big{)}\Big{)}^{2}\mu_{1}(d\bm{x}_{1}).
\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}
\bm{x}_{1}
\bm{\mathsf{x}}_{1}
\bm{x}_{2}
\displaystyle P_{1}(d\bm{x}_{1})=\frac{1}{\operatorname{z}(\bm{V},\bm{\Theta})%
}\underbrace{\Bigg{(}\int_{\mathbb{X}_{2}}\Big{\|}\bm{V}\sigma\big{(}\bm{W}_{1%
}\bm{t}_{1}(\bm{x}_{1})+\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}\big{)}\Big{\|}%
_{2}^{2}\mu_{2}(d\bm{x}_{2})\Bigg{)}}_{\triangleq\operatorname{z}_{2}}\mu_{1}(%
d\bm{x}_{1}).
\displaystyle P_{1}(d\bm{x}_{1})
\displaystyle=\frac{1}{\operatorname{z}(\bm{V},\bm{\Theta})}\underbrace{\Bigg{%
(}\int_{\mathbb{X}_{2}}\Big{\|}\bm{V}\sigma\big{(}\bm{W}_{1}\bm{t}_{1}(\bm{x}_%
{1})+\bm{W}_{2}\bm{t}_{2}(\bm{x}_{2})+\bm{b}\big{)}\Big{\|}_{2}^{2}\mu_{2}(d%
\bm{x}_{2})\Bigg{)}}_{\triangleq\operatorname{z}_{2}}\mu_{1}(d\bm{x}_{1}).
\operatorname{z}_{2}
\operatorname{z}(\bm{V},\bm{\Theta})
\displaystyle\operatorname{z}_{2}=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}%
\widetilde{\bm{C}}_{\bm{\bm{\Theta}}}(\bm{x}_{1})\big{)},\quad\text{where}
\displaystyle\operatorname{z}_{2}
\displaystyle=\operatorname{Tr}\big{(}\bm{V}^{\top}\bm{V}\widetilde{\bm{C}}_{%
\bm{\bm{\Theta}}}(\bm{x}_{1})\big{)},\quad\text{where}
\displaystyle\widetilde{C}_{ij}(\bm{x}_{1})=\int_{\mathbb{X}_{2}}\sigma\big{(}%
\bm{w}_{1i}^{\top}\bm{t}_{1}(\bm{x}_{1})+\bm{w}_{2i}^{\top}\bm{t}_{2}(\bm{x}_{%
2})+b_{i}\big{)}\sigma\big{(}\bm{w}_{1j}^{\top}\bm{t}_{1}(\bm{x}_{1})+\bm{w}_{%
2j}^{\top}\bm{t}_{2}(\bm{x}_{2})+b_{j}\big{)}\mu_{2}(d\bm{x}_{2})
\displaystyle\widetilde{C}_{ij}(\bm{x}_{1})
\displaystyle=\int_{\mathbb{X}_{2}}\sigma\big{(}\bm{w}_{1i}^{\top}\bm{t}_{1}(%
\bm{x}_{1})+\bm{w}_{2i}^{\top}\bm{t}_{2}(\bm{x}_{2})+b_{i}\big{)}\sigma\big{(}%
\bm{w}_{1j}^{\top}\bm{t}_{1}(\bm{x}_{1})+\bm{w}_{2j}^{\top}\bm{t}_{2}(\bm{x}_{%
2})+b_{j}\big{)}\mu_{2}(d\bm{x}_{2})
\displaystyle=k_{\sigma,\bm{t}_{2},\mu_{2}}\Big{(}\big{(}\bm{w}_{2i},\bm{w}_{1%
i}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{i}\big{)},\big{(}\bm{w}_{2j},\bm{w}_{1j}^{%
\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\big{)}\Big{)}.
\displaystyle=k_{\sigma,\bm{t}_{2},\mu_{2}}\Big{(}\big{(}\bm{w}_{2i},\bm{w}_{1%
i}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{i}\big{)},\big{(}\bm{w}_{2j},\bm{w}_{1j}^{%
\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\big{)}\Big{)}.
\bm{\mathsf{x}}
\bm{m}
\bm{C}
\bm{\mathsf{x}}\stackrel{{\scriptstyle d}}{{=}}\bm{A}\bm{\mathsf{z}}+\bm{m}
\bm{\mathsf{z}}
\bm{\mathsf{z}}
\displaystyle k_{\sigma,\operatorname{Id},\Phi_{\bm{C},\bm{m}}}(\bm{\theta}_{i%
},\bm{\theta}_{j})=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\sigma(\bm{w}_{i}^{\top}%
\bm{\mathsf{x}}+b_{i})\sigma(\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j})\big{]}
\displaystyle k_{\sigma,\operatorname{Id},\Phi_{\bm{C},\bm{m}}}(\bm{\theta}_{i%
},\bm{\theta}_{j})
\displaystyle=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\sigma(\bm{w}_{i}^{\top}\bm{%
\mathsf{x}}+b_{i})\sigma(\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j})\big{]}
\displaystyle=\mathbb{E}_{\bm{\mathsf{z}}}\big{[}\sigma(\bm{w}_{i}^{\top}\bm{A%
}\bm{\mathsf{z}}+\bm{w}_{i}^{\top}\bm{m}+b_{i})\sigma(\bm{w}_{j}^{\top}\bm{A}%
\bm{\mathsf{z}}+\bm{w}_{j}^{\top}\bm{m}+b_{j})\big{]}
\displaystyle=\mathbb{E}_{\bm{\mathsf{z}}}\big{[}\sigma(\bm{w}_{i}^{\top}\bm{A%
}\bm{\mathsf{z}}+\bm{w}_{i}^{\top}\bm{m}+b_{i})\sigma(\bm{w}_{j}^{\top}\bm{A}%
\bm{\mathsf{z}}+\bm{w}_{j}^{\top}\bm{m}+b_{j})\big{]}
\displaystyle=k_{\sigma,\operatorname{Id},\Phi}(\mathcal{T}\bm{\theta}_{i},%
\mathcal{T}\bm{\theta}_{j}).
\displaystyle=k_{\sigma,\operatorname{Id},\Phi}(\mathcal{T}\bm{\theta}_{i},%
\mathcal{T}\bm{\theta}_{j}).
\mathsf{z}
m
v^{2}
\displaystyle\mathbb{E}e^{i{\mathsf{z}}}=\mathbb{E}[\cos({\mathsf{z}})]+i%
\mathbb{E}[\sin({\mathsf{z}})]=e^{im-\frac{1}{2}v^{2}}
\displaystyle\mathbb{E}e^{i{\mathsf{z}}}=\mathbb{E}[\cos({\mathsf{z}})]+i%
\mathbb{E}[\sin({\mathsf{z}})]
\displaystyle=e^{im-\frac{1}{2}v^{2}}
\displaystyle=(\cos\mu+i\sin m)e^{-\frac{1}{2}v^{2}}
\displaystyle=(\cos\mu+i\sin m)e^{-\frac{1}{2}v^{2}}
\displaystyle\implies\mathbb{E}[\cos({\mathsf{z}})]=\cos(m)e^{-\frac{1}{2}v^{2%
}}.
\displaystyle\implies\mathbb{E}[\cos({\mathsf{z}})]
\displaystyle=\cos(m)e^{-\frac{1}{2}v^{2}}.
\displaystyle k_{\cos,\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})%
=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\cos(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i%
})\cos(\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j})\big{]},\quad\bm{\mathsf{x}}\sim%
\mathcal{N}\big{(}\bm{0},\bm{I}\big{)}
\displaystyle k_{\cos,\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\cos(\bm{w}_{i}^{\top}\bm{%
\mathsf{x}}+b_{i})\cos(\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j})\big{]},\quad\bm%
{\mathsf{x}}\sim\mathcal{N}\big{(}\bm{0},\bm{I}\big{)}
\displaystyle=\frac{1}{2}\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\cos\big{(}(\bm{w}%
_{i}-\bm{w}_{j})^{\top}\bm{\mathsf{x}}+(b_{i}-b_{j})\big{)}+\cos\big{(}(\bm{w}%
_{i}+\bm{w}_{j})^{\top}\bm{\mathsf{x}}+(b_{i}+b_{j})\big{)}\big{]}
\displaystyle=\frac{1}{2}\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\cos\big{(}(\bm{w}%
_{i}-\bm{w}_{j})^{\top}\bm{\mathsf{x}}+(b_{i}-b_{j})\big{)}+\cos\big{(}(\bm{w}%
_{i}+\bm{w}_{j})^{\top}\bm{\mathsf{x}}+(b_{i}+b_{j})\big{)}\big{]}
\displaystyle=\frac{1}{2}\cos|b_{i}-b_{j}|\exp\big{(}-\frac{1}{2}\|\bm{w}_{i}-%
\bm{w}_{j}\|^{2}\big{)}+\cos|b_{i}+b_{j}|\exp\big{(}-\frac{1}{2}\|\bm{w}_{i}+%
\bm{w}_{j}\|^{2}\big{)}.
\displaystyle=\frac{1}{2}\cos|b_{i}-b_{j}|\exp\big{(}-\frac{1}{2}\|\bm{w}_{i}-%
\bm{w}_{j}\|^{2}\big{)}+\cos|b_{i}+b_{j}|\exp\big{(}-\frac{1}{2}\|\bm{w}_{i}+%
\bm{w}_{j}\|^{2}\big{)}.
\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i}
\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j}
\sigma=\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a}
\displaystyle\phantom{{}={}}k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},%
\operatorname{Id}}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle\phantom{{}={}}k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},%
\operatorname{Id}}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\underbrace{\frac{1}{4a^{2}}\mathbb{E}_{\bm{\mathsf{x}}}\big{[}%
\cos\big{(}2a(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i})\big{)}\cos\big{(}2a(\bm{%
w}_{j}^{\top}\bm{\mathsf{x}}+b_{j})\big{)}\big{]}}_{\text{Kernel~{}\ref{kernel%
:cos}}}-\underbrace{\frac{1}{2a}\mathbb{E}_{\bm{\mathsf{x}}}\big{[}(\bm{w}_{i}%
^{\top}\bm{\mathsf{x}}+b_{i})\cos\big{(}2a(\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_%
{j})\big{)}\big{]}}_{\triangleq A}-
\displaystyle=\underbrace{\frac{1}{4a^{2}}\mathbb{E}_{\bm{\mathsf{x}}}\big{[}%
\cos\big{(}2a(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i})\big{)}\cos\big{(}2a(\bm{%
w}_{j}^{\top}\bm{\mathsf{x}}+b_{j})\big{)}\big{]}}_{\text{Kernel~{}\ref{kernel%
:cos}}}-\underbrace{\frac{1}{2a}\mathbb{E}_{\bm{\mathsf{x}}}\big{[}(\bm{w}_{i}%
^{\top}\bm{\mathsf{x}}+b_{i})\cos\big{(}2a(\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_%
{j})\big{)}\big{]}}_{\triangleq A}-
\displaystyle\phantom{{}={}}\underbrace{\frac{1}{2a}\mathbb{E}_{\bm{\mathsf{x}%
}}\big{[}\cos\big{(}2a(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i})\big{)}(\bm{w}_{%
j}^{\top}\bm{\mathsf{x}}+b_{j})\big{]}}_{\triangleq B}+\underbrace{\mathbb{E}_%
{\bm{\mathsf{x}}}\big{[}(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i})(\bm{w}_{j}^{%
\top}\bm{\mathsf{x}}+b_{j})\big{]}}_{\text{Kernel~{}\ref{kernel:linear}}}.
\displaystyle\phantom{{}={}}\underbrace{\frac{1}{2a}\mathbb{E}_{\bm{\mathsf{x}%
}}\big{[}\cos\big{(}2a(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i})\big{)}(\bm{w}_{%
j}^{\top}\bm{\mathsf{x}}+b_{j})\big{]}}_{\triangleq B}+\underbrace{\mathbb{E}_%
{\bm{\mathsf{x}}}\big{[}(\bm{w}_{i}^{\top}\bm{\mathsf{x}}+b_{i})(\bm{w}_{j}^{%
\top}\bm{\mathsf{x}}+b_{j})\big{]}}_{\text{Kernel~{}\ref{kernel:linear}}}.
A
B
A
B
A
A
\displaystyle A=\frac{1}{2a}\mathbb{E}\big{[}(z_{1}+b_{i})\cos(z_{2}+2ab_{j})%
\big{]},\quad(z_{1},z_{2})^{\top}\sim\mathcal{N}\Bigg{(}\begin{pmatrix}0\\
0\end{pmatrix},\begin{pmatrix}\bm{w}_{i}^{\top}\bm{w}_{i}&2a\bm{w}_{i}^{\top}%
\bm{w}_{j}\\
2a\bm{w}_{j}^{\top}\bm{w}_{i}&4a^{2}\bm{w}_{j}^{\top}\bm{w}_{j}\end{pmatrix}%
\Bigg{)}
\displaystyle A
\displaystyle=\frac{1}{2a}\mathbb{E}\big{[}(z_{1}+b_{i})\cos(z_{2}+2ab_{j})%
\big{]},\quad(z_{1},z_{2})^{\top}\sim\mathcal{N}\Bigg{(}\begin{pmatrix}0\\
0\end{pmatrix},\begin{pmatrix}\bm{w}_{i}^{\top}\bm{w}_{i}&2a\bm{w}_{i}^{\top}%
\bm{w}_{j}\\
2a\bm{w}_{j}^{\top}\bm{w}_{i}&4a^{2}\bm{w}_{j}^{\top}\bm{w}_{j}\end{pmatrix}%
\Bigg{)}
\displaystyle=\frac{1}{2a}\mathbb{E}\big{[}z_{1}\cos(z_{2}+2ab_{j})\big{]}+%
\frac{b_{i}}{2a}\mathbb{E}\big{[}\cos(z_{2}+2ab_{j})\big{]}
\displaystyle=\frac{1}{2a}\mathbb{E}\big{[}z_{1}\cos(z_{2}+2ab_{j})\big{]}+%
\frac{b_{i}}{2a}\mathbb{E}\big{[}\cos(z_{2}+2ab_{j})\big{]}
\displaystyle=-\bm{w}_{i}^{\top}\bm{w}_{j}\mathbb{E}\big{[}\sin(z_{2}+2ab_{j})%
\big{]}+\frac{b_{i}}{2a}\mathbb{E}\big{[}\cos(z_{2}+2ab_{j})\big{]}
\displaystyle=-\bm{w}_{i}^{\top}\bm{w}_{j}\mathbb{E}\big{[}\sin(z_{2}+2ab_{j})%
\big{]}+\frac{b_{i}}{2a}\mathbb{E}\big{[}\cos(z_{2}+2ab_{j})\big{]}
\displaystyle=-\bm{w}_{i}^{\top}\bm{w}_{j}\sin(2ab_{j})\exp(-2a^{2}\|\bm{w}_{j%
}\|^{2})+\frac{b_{i}}{2a}\cos(2ab_{j})\exp(-2a^{2}\|\bm{w}_{j}\|^{2}).
\displaystyle=-\bm{w}_{i}^{\top}\bm{w}_{j}\sin(2ab_{j})\exp(-2a^{2}\|\bm{w}_{j%
}\|^{2})+\frac{b_{i}}{2a}\cos(2ab_{j})\exp(-2a^{2}\|\bm{w}_{j}\|^{2}).
\displaystyle\phantom{{}={}}k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},%
\operatorname{Id}}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle\phantom{{}={}}k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},%
\operatorname{Id}}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\frac{1}{4a^{2}}k_{\cos,\operatorname{Id}}(2a\bm{\theta}_{i},2a%
\bm{\theta}_{j})+\bm{w}_{i}^{\top}\bm{w}_{j}\Big{(}\sin(2ab_{j})\exp(-2a^{2}\|%
\bm{w}_{j}\|^{2})+\sin(2ab_{i})\exp(-2a^{2}\|\bm{w}_{i}\|^{2})\Big{)}
\displaystyle=\frac{1}{4a^{2}}k_{\cos,\operatorname{Id}}(2a\bm{\theta}_{i},2a%
\bm{\theta}_{j})+\bm{w}_{i}^{\top}\bm{w}_{j}\Big{(}\sin(2ab_{j})\exp(-2a^{2}\|%
\bm{w}_{j}\|^{2})+\sin(2ab_{i})\exp(-2a^{2}\|\bm{w}_{i}\|^{2})\Big{)}
\displaystyle\phantom{{}={}}-\frac{b_{i}}{2a}\cos(2ab_{j})\exp(-2a^{2}\|\bm{w}%
_{j}\|^{2})-\frac{b_{j}}{2a}\cos(2ab_{i})\exp(-2a^{2}\|\bm{w}_{i}\|^{2})+k_{%
\operatorname{Id},\operatorname{Id}}(\bm{\theta}_{i}^{(1)},\bm{\theta}_{j}^{(1%
)}).
\displaystyle\phantom{{}={}}-\frac{b_{i}}{2a}\cos(2ab_{j})\exp(-2a^{2}\|\bm{w}%
_{j}\|^{2})-\frac{b_{j}}{2a}\cos(2ab_{i})\exp(-2a^{2}\|\bm{w}_{i}\|^{2})+k_{%
\operatorname{Id},\operatorname{Id}}(\bm{\theta}_{i}^{(1)},\bm{\theta}_{j}^{(1%
)}).
\sigma=\operatorname{Snake_{a}}
\operatorname{Snake_{a}}(\cdot)=\Big{(}\operatorname{Snake_{a}}(\cdot)-\frac{1%
}{2a}\Big{)}+\frac{1}{2a}
\Big{(}\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a}\Big{)}
\displaystyle\phantom{{}={}}k_{\operatorname{Snake_{a}},\operatorname{Id}}(\bm%
{\theta}_{i},\bm{\theta}_{j})
\displaystyle\phantom{{}={}}k_{\operatorname{Snake_{a}},\operatorname{Id}}(\bm%
{\theta}_{i},\bm{\theta}_{j})
\displaystyle=k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},\operatorname{Id%
}}(\bm{\theta}_{i},\bm{\theta}_{j})+\frac{1}{4a^{2}}+
\displaystyle=k_{\operatorname{Snake_{a}}(\cdot)-\frac{1}{2a},\operatorname{Id%
}}(\bm{\theta}_{i},\bm{\theta}_{j})+\frac{1}{4a^{2}}+
\displaystyle\phantom{{}={}}\frac{1}{2a}\Big{(}b_{i}-\frac{1}{2a}\cos(2ab_{i})%
\exp(-2a^{2}\|\bm{w}_{i}\|^{2})+b_{j}-\frac{1}{2a}\cos(2ab_{j})\exp(-2a^{2}\|%
\bm{w}_{j}\|^{2})\Big{)}.
\displaystyle\phantom{{}={}}\frac{1}{2a}\Big{(}b_{i}-\frac{1}{2a}\cos(2ab_{i})%
\exp(-2a^{2}\|\bm{w}_{i}\|^{2})+b_{j}-\frac{1}{2a}\cos(2ab_{j})\exp(-2a^{2}\|%
\bm{w}_{j}\|^{2})\Big{)}.
\sigma(u)=\exp(u/2)
\sigma(u)=\exp(u)
\mathbb{R}^{d}
\bm{\mathsf{x}}\sim\mathcal{N}(0,\bm{I})
\bm{\mathsf{x}}/\|\bm{\mathsf{x}}\|
\displaystyle k_{\exp,\text{proj}_{\mathbb{S}^{d-1}},\Phi}(\bm{\theta}_{i},\bm%
{\theta}_{j})=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\exp\big{(}\bm{w}_{i}^{\top}%
\bm{\mathsf{x}}/\|\bm{\mathsf{x}}\|+b_{i}+\bm{w}_{j}^{\top}\bm{\mathsf{x}}/\|%
\bm{\mathsf{x}}\|+b_{j}\big{)}\big{]},\quad\bm{\mathsf{x}}\sim\mathcal{N}\big{%
(}\bm{0},\bm{I}\big{)}
\displaystyle k_{\exp,\text{proj}_{\mathbb{S}^{d-1}},\Phi}(\bm{\theta}_{i},\bm%
{\theta}_{j})
\displaystyle=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\exp\big{(}\bm{w}_{i}^{\top}%
\bm{\mathsf{x}}/\|\bm{\mathsf{x}}\|+b_{i}+\bm{w}_{j}^{\top}\bm{\mathsf{x}}/\|%
\bm{\mathsf{x}}\|+b_{j}\big{)}\big{]},\quad\bm{\mathsf{x}}\sim\mathcal{N}\big{%
(}\bm{0},\bm{I}\big{)}
\displaystyle=\exp(b_{i}+b_{j})\int_{\mathbb{S}^{d-1}}\exp\left((\bm{w}_{i}+%
\bm{w}_{j})^{\top}\bm{x}\right)d\bm{x}\frac{\Gamma(d/2)}{2\pi^{d/2}}
\displaystyle=\exp(b_{i}+b_{j})\int_{\mathbb{S}^{d-1}}\exp\left((\bm{w}_{i}+%
\bm{w}_{j})^{\top}\bm{x}\right)d\bm{x}\frac{\Gamma(d/2)}{2\pi^{d/2}}
\displaystyle=\frac{\exp(b_{i}+b_{j})\Gamma(d/2)}{2\pi^{d/2}}\int_{\mathbb{S}^%
{d-1}}\exp\left(\|\bm{w}_{i}+\bm{w}_{j}\|\bm{a}^{\top}\bm{x}\right)d\bm{x},%
\quad\text{where $\bm{a}$ is a unit vector}
\bm{a}
\displaystyle=\frac{\exp(b_{i}+b_{j})\Gamma(d/2)}{2\pi^{d/2}}\int_{\mathbb{S}^%
{d-1}}\exp\left(\|\bm{w}_{i}+\bm{w}_{j}\|\bm{a}^{\top}\bm{x}\right)d\bm{x},%
\quad\text{where $\bm{a}$ is a unit vector}
\bm{a}
\displaystyle=\frac{\exp(b_{i}+b_{j})\Gamma(d/2)}{2\pi^{d/2}}\frac{(2\pi)^{d/2%
}I_{d/2-1}\big{(}\|\bm{w}_{i}+\bm{w}_{j}\|\big{)}}{\|\bm{w}_{i}+\bm{w}_{j}\|^{%
d/2-1}}
\displaystyle=\frac{\exp(b_{i}+b_{j})\Gamma(d/2)}{2\pi^{d/2}}\frac{(2\pi)^{d/2%
}I_{d/2-1}\big{(}\|\bm{w}_{i}+\bm{w}_{j}\|\big{)}}{\|\bm{w}_{i}+\bm{w}_{j}\|^{%
d/2-1}}
\displaystyle=\exp(b_{i}+b_{j})\frac{\Gamma(d/2)2^{d/2-1}I_{d/2-1}\big{(}\|\bm%
{w}_{i}+\bm{w}_{j}\|\big{)}}{\|\bm{w}_{i}+\bm{w}_{j}\|^{d/2-1}},
\displaystyle=\exp(b_{i}+b_{j})\frac{\Gamma(d/2)2^{d/2-1}I_{d/2-1}\big{(}\|\bm%
{w}_{i}+\bm{w}_{j}\|\big{)}}{\|\bm{w}_{i}+\bm{w}_{j}\|^{d/2-1}},
I_{p}
p
p=1/2
I_{1/2}(z)=\sqrt{\frac{2}{\pi z}}\sinh(z)=\big{(}\exp(z)-\exp(-z)\big{)}\sqrt{%
\frac{1}{2\pi z}}
d=3
\Gamma(3/2)=\frac{\sqrt{\pi}}{2}
\displaystyle k_{\exp,\text{proj}_{\mathbb{S}^{2}},\Phi}(\bm{\theta}_{i},\bm{%
\theta}_{j})=\exp(b_{i}+b_{j})\frac{\left(e^{\left\|\bm{w}_{i}+\bm{w}_{j}%
\right\|}-e^{-\left\|\bm{w}_{i}+\bm{w}_{j}\right\|}\right)}{2\left\|\bm{w}_{i}%
+\bm{w}_{j}\right\|}.
\displaystyle k_{\exp,\text{proj}_{\mathbb{S}^{2}},\Phi}(\bm{\theta}_{i},\bm{%
\theta}_{j})
\displaystyle=\exp(b_{i}+b_{j})\frac{\left(e^{\left\|\bm{w}_{i}+\bm{w}_{j}%
\right\|}-e^{-\left\|\bm{w}_{i}+\bm{w}_{j}\right\|}\right)}{2\left\|\bm{w}_{i}%
+\bm{w}_{j}\right\|}.
k_{\exp,\text{proj}_{\mathbb{S}^{d-1}},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})=%
k_{\exp,\operatorname{Id},\nu}(\bm{\theta}_{i},\bm{\theta}_{j})
\nu
\mathbb{S}^{d-1}
\bm{\mathsf{x}}
\bm{\mathsf{x}}/\|\bm{\mathsf{x}}\|
\texttt{SNEFY}{}_{\exp,\operatorname{Id},\nu}
\bm{V}^{\top}\bm{V}
k_{\exp,\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})=\exp(b_{i}+b_%
{j})\exp\big{(}\frac{1}{2}\|\bm{w}_{i}+\bm{w}_{j}\|^{2}\big{)}.
\displaystyle k_{\exp,\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})%
=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\exp\big{(}\bm{w}_{i}^{\top}\bm{\mathsf{x}%
}+b_{i}+\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j}\big{)}\big{]},\quad\bm{\mathsf{%
x}}\sim\mathcal{N}\big{(}\bm{0},\bm{I}\big{)}
\displaystyle k_{\exp,\operatorname{Id},\Phi}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\exp\big{(}\bm{w}_{i}^{\top}%
\bm{\mathsf{x}}+b_{i}+\bm{w}_{j}^{\top}\bm{\mathsf{x}}+b_{j}\big{)}\big{]},%
\quad\bm{\mathsf{x}}\sim\mathcal{N}\big{(}\bm{0},\bm{I}\big{)}
\displaystyle=\exp(b_{i}+b_{j})\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\exp\big{(}(%
\bm{w}_{i}+\bm{w}_{j})^{\top}\bm{\mathsf{x}}\big{)}\big{]}
\displaystyle=\exp(b_{i}+b_{j})\mathbb{E}_{\bm{\mathsf{x}}}\big{[}\exp\big{(}(%
\bm{w}_{i}+\bm{w}_{j})^{\top}\bm{\mathsf{x}}\big{)}\big{]}
\displaystyle=\exp(b_{i}+b_{j})\exp\big{(}\frac{1}{2}\|\bm{w}_{i}+\bm{w}_{j}\|%
^{2}\big{)}.
\displaystyle=\exp(b_{i}+b_{j})\exp\big{(}\frac{1}{2}\|\bm{w}_{i}+\bm{w}_{j}\|%
^{2}\big{)}.
\mathbb{X}=\{0,1,2,\ldots\}
t(x)=x
\mu(dx)=1/x!\,\nu(dx)
\nu
\displaystyle p(x;\bm{V},\bm{w})=\frac{1}{\operatorname{Tr}\left(\bm{V}^{\top}%
\bm{V}\bm{K}_{\bm{\Theta}}\right)}\frac{1}{x!}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{%
v}_{.,i}^{\top}\bm{v}_{.,j}\exp\left((w_{i}+w_{j})x\right)
\displaystyle p(x;\bm{V},\bm{w})
\displaystyle=\frac{1}{\operatorname{Tr}\left(\bm{V}^{\top}\bm{V}\bm{K}_{\bm{%
\Theta}}\right)}\frac{1}{x!}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{v}_{.,i}^{\top}\bm%
{v}_{.,j}\exp\left((w_{i}+w_{j})x\right)
\displaystyle=\frac{1}{\operatorname{Tr}\left(\bm{V}^{\top}\bm{V}\bm{K}_{\bm{%
\Theta}}\right)}\frac{1}{x!}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{v}_{.,i}^{\top}\bm%
{v}_{.,j}(\lambda_{i}\lambda_{j})^{x},\quad x=0,1,2,\ldots
\displaystyle=\frac{1}{\operatorname{Tr}\left(\bm{V}^{\top}\bm{V}\bm{K}_{\bm{%
\Theta}}\right)}\frac{1}{x!}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{v}_{.,i}^{\top}\bm%
{v}_{.,j}(\lambda_{i}\lambda_{j})^{x},\quad x=0,1,2,\ldots
\lambda_{i}=e^{w_{i}}
(\lambda_{i},\lambda_{j})
\mu(dx)=(x!)^{-1}\,\nu(dx)
\nu
k_{\exp,\operatorname{Id},(x!)^{-1}\nu}(\bm{\theta}_{i},\bm{\theta}_{j})=\exp%
\Big{(}b_{i}+b_{j}\Big{)}\exp\big{(}\exp(w_{i}+w_{j})\big{)}.
\displaystyle k_{\exp,\operatorname{Id},(x!)^{-1}\nu}(\bm{\theta}_{i},\bm{%
\theta}_{j})=\sum_{x=0}^{\infty}\frac{1}{x!}\exp\Big{(}w_{i}x+w_{j}x+b_{i}+b_{%
j}\Big{)}
\displaystyle k_{\exp,\operatorname{Id},(x!)^{-1}\nu}(\bm{\theta}_{i},\bm{%
\theta}_{j})
\displaystyle=\sum_{x=0}^{\infty}\frac{1}{x!}\exp\Big{(}w_{i}x+w_{j}x+b_{i}+b_%
{j}\Big{)}
\displaystyle=\exp\Big{(}b_{i}+b_{j}\Big{)}\sum_{x=0}^{\infty}\frac{1}{x!}\exp%
\Big{(}w_{i}x+w_{j}x\Big{)}
\displaystyle=\exp\Big{(}b_{i}+b_{j}\Big{)}\sum_{x=0}^{\infty}\frac{1}{x!}\exp%
\Big{(}w_{i}x+w_{j}x\Big{)}
\exp\big{(}\exp(w_{i}+w_{j})\big{)}
\lambda_{i}=\exp(w_{i})
k_{\exp,\operatorname{Id},(x!)^{-1}\nu}(\bm{\theta}_{i},\bm{\theta}_{j})=\exp%
\Big{(}b_{i}+b_{j}\Big{)}\exp\big{(}\lambda_{i}\lambda_{j}\big{)}.
\mathbb{X}=\mathbb{R}^{d}
\bm{t}(\bm{x})=(x_{1},\ldots,x_{d},x_{1}^{2},\ldots,x_{d}^{2})
D=2d
\mu(d\bm{x})=d\bm{x}
\sigma(\cdot)=\exp(\cdot/2)
r
\bm{f}:\mathbb{R}^{D}\to\mathbb{R}^{m}
f_{r}(\bm{t}(\bm{x});\bm{V},\bm{\Theta})=\sum_{i=1}^{n}v_{ri}\exp\left(\frac{1%
}{2}\left(\sum_{\ell=1}^{d}w_{i\ell}x_{\ell}+\sum_{\ell=1}^{d}\tilde{w}_{i\ell%
}x_{\ell}^{2}\right)\right),
\tilde{w}_{i\ell}=w_{i,d+\ell}
\tilde{w}_{e\ell}<0
\sigma_{i\ell}^{2}=-\frac{1}{2\tilde{w}_{i\ell}}
\mu_{i\ell}=-\frac{w_{i\ell}}{2\tilde{w}_{i\ell}}
\exp\left(-\sum_{\ell=1}^{d}\frac{\mu_{i\ell}^{2}}{4\sigma_{i\ell}^{2}}\right)
\bm{V}
f_{r}(\bm{t}(\bm{x});\bm{V},\bm{\Theta})=\sum_{i=1}^{n}v_{ri}\exp\left(-\sum_{%
\ell=1}^{d}\frac{(x_{\ell}-\mu_{i\ell})^{2}}{4\sigma_{i\ell}^{2}}\right).
\sigma_{i\ell}^{2}=\sigma_{i}^{2}
f_{r}\left(\bm{t}(\bm{x});\bm{V},\bm{\Theta}\right)=\sum_{i=1}^{n}v_{ri}\exp%
\left(-\frac{\left\|\bm{x}-\bm{\mu}_{i}\right\|^{2}}{4\sigma_{i}^{2}}\right),%
\quad\bm{x}\in\mathbb{R}^{d},
\bm{\mu}_{i}\in\mathbb{R}^{d}
\sigma_{i}^{2}>0
4
\sigma_{i}^{2}
\bm{f}
\mu
p(\bm{x};\bm{V},\bm{\Theta})=\frac{1}{\operatorname{Tr}\left(\bm{V}^{\top}\bm{%
V}\bm{K}_{\bm{\Theta}}\right)}\sum_{i=1}^{n}\sum_{j=1}^{n}\bm{v}_{.,i}^{\top}%
\bm{v}_{.,j}\exp\left(-\frac{\left\|\bm{x}-\bm{\mu}_{i}\right\|^{2}}{4\sigma_{%
i}^{2}}\right)\exp\left(-\frac{\left\|\bm{x}-\bm{\mu}_{j}\right\|^{2}}{4\sigma%
_{j}^{2}}\right).
n=1
\mathcal{N}\left(\bm{\mu}_{1},\sigma_{1}^{2}I\right)
\bm{t^{(2)}}(\bm{x})=(x_{1},\ldots,x_{d},x_{1}^{2},\ldots,x_{d}^{2})
D=2d
\bm{W}=[\bm{W}_{[:,1:d]},\tilde{\bm{W}}]
\tilde{\bm{W}}<0
\mu(d\bm{x})=d\bm{x}
k_{\exp,\bm{t^{(2)}},d\bm{x}}(\bm{\theta}_{i},\bm{\theta}_{j})=\pi^{d/2}\exp(b%
_{i}+b_{j})\prod_{l=1}^{d}\exp\Big{(}-\frac{(w_{il}+w_{jl})^{2}}{4(\tilde{w}_{%
il}+\tilde{w}_{jl})}\Big{)}\frac{1}{\sqrt{-(\tilde{w}_{il}+\tilde{w}_{jl})}}
\displaystyle k_{\exp,\bm{t^{(2)}},d\bm{x}}(\bm{\theta}_{i},\bm{\theta}_{j})=%
\int_{\mathbb{R}^{d}}\exp\Big{(}\bm{w}_{i,1:d}^{\top}\bm{x}+\tilde{\bm{w}}_{i}%
^{\top}\bm{x}^{2}+b_{1}+\bm{w}_{j,1:d}^{\top}\bm{x}+\tilde{\bm{w}}_{j}^{\top}%
\bm{x}^{2}+b_{j}\Big{)}\,d\bm{x}
\displaystyle k_{\exp,\bm{t^{(2)}},d\bm{x}}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\int_{\mathbb{R}^{d}}\exp\Big{(}\bm{w}_{i,1:d}^{\top}\bm{x}+%
\tilde{\bm{w}}_{i}^{\top}\bm{x}^{2}+b_{1}+\bm{w}_{j,1:d}^{\top}\bm{x}+\tilde{%
\bm{w}}_{j}^{\top}\bm{x}^{2}+b_{j}\Big{)}\,d\bm{x}
\displaystyle=(2\pi)^{d/2}\exp(b_{i}+b_{j})\prod_{l=1}^{d}\exp\Big{(}-\frac{(w%
_{il}+w_{jl})^{2}}{4(\tilde{w}_{il}+\tilde{w}_{jl})}\Big{)}\frac{1}{\sqrt{-2(%
\tilde{w}_{il}+\tilde{w}_{jl})}}.
\displaystyle=(2\pi)^{d/2}\exp(b_{i}+b_{j})\prod_{l=1}^{d}\exp\Big{(}-\frac{(w%
_{il}+w_{jl})^{2}}{4(\tilde{w}_{il}+\tilde{w}_{jl})}\Big{)}\frac{1}{\sqrt{-2(%
\tilde{w}_{il}+\tilde{w}_{jl})}}.
\bm{K}_{\bm{\Theta}}
\bm{\mu}_{i},\sigma^{2}_{i}
\displaystyle[{\bm{K}_{\bm{\Theta}}}]_{ij}=\exp(b_{i}+b_{j})\int_{\mathbb{R}^{%
d}}\exp\left(-\frac{\left\|\bm{x}-\bm{\mu}_{i}\right\|^{2}}{4\sigma_{i}^{2}}%
\right)\exp\left(-\frac{\left\|\bm{x}-\bm{\mu}_{j}\right\|^{2}}{4\sigma_{j}^{2%
}}\right)d\bm{x}
\displaystyle[{\bm{K}_{\bm{\Theta}}}]_{ij}=
\displaystyle\exp(b_{i}+b_{j})\int_{\mathbb{R}^{d}}\exp\left(-\frac{\left\|\bm%
{x}-\bm{\mu}_{i}\right\|^{2}}{4\sigma_{i}^{2}}\right)\exp\left(-\frac{\left\|%
\bm{x}-\bm{\mu}_{j}\right\|^{2}}{4\sigma_{j}^{2}}\right)d\bm{x}
\displaystyle{}=\exp(b_{i}+b_{j})\left(\frac{4\pi\sigma_{i}^{2}\sigma_{j}^{2}}%
{\sigma_{i}^{2}+\sigma_{j}^{2}}\right)^{d/2}\exp\left(-\frac{\left\|\bm{\mu}_{%
i}-\bm{\mu}_{j}\right\|^{2}}{4\left(\sigma_{i}^{2}+\sigma_{j}^{2}\right)}%
\right).
\displaystyle{}=
\displaystyle\exp(b_{i}+b_{j})\left(\frac{4\pi\sigma_{i}^{2}\sigma_{j}^{2}}{%
\sigma_{i}^{2}+\sigma_{j}^{2}}\right)^{d/2}\exp\left(-\frac{\left\|\bm{\mu}_{i%
}-\bm{\mu}_{j}\right\|^{2}}{4\left(\sigma_{i}^{2}+\sigma_{j}^{2}\right)}\right).
\mathbb{X}=(0,\infty)
\bm{t}(x)=(\log x,-x)
\sigma=\exp
\bm{W}=[\bm{W}_{[:,1:d]},\tilde{\bm{W}}]
\bm{W}_{[:,1:d]}>-1
\tilde{\bm{W}}>0
\mu(d\bm{x})=d\bm{x}
k_{\exp,\bm{t},d\bm{x}}(\bm{\theta}_{i},\bm{\theta}_{j})=\exp(b_{i}+b_{j})%
\frac{\Gamma\left(w_{i1}+w_{j1}+1\right)}{\left(w_{i2}+w_{j2}\right)^{w_{i1}+w%
_{j1}+1}}.
\mathbb{X}=\Delta^{D-1}
(D-1)
\bm{x}\in[0,1]^{D}
\sum_{i=1}^{D}x_{i}=1
\sigma=\exp
\bm{t}(\bm{x})=(\log x_{1},\ldots,\log x_{D})
\mu(d\bm{x})=d\bm{x}
\bm{W}>-1
k_{\exp,\bm{t},d\bm{x}}(\bm{\theta}_{i},\bm{\theta}_{j})=\exp(b_{i}+b_{j})%
\frac{\prod_{d=1}^{D}\Gamma(w_{id}+w_{jd}+1)}{\Gamma\left(D+\sum_{d=1}^{D}w_{%
id}+w_{jd}\right)}.
\bm{M}
n\times n
P(d\bm{x};\bm{M},\bm{\Theta})=\frac{1}{\operatorname{z}(\bm{M},\bm{\Theta})}%
\sigma\left(\bm{W}\bm{t}(\bm{x})+\bm{b}\right)^{\top}\bm{M}\sigma\left(\bm{W}%
\bm{t}(\bm{x})+\bm{b}\right)\mu\left(d\bm{x}\right).
\bm{M}=\bm{V}^{\top}\bm{V}
m\times n
\bm{V}
m\leq n
\displaystyle\sigma\left(\bm{W}\bm{t}(\bm{x})+\bm{b}\right)^{\top}\bm{M}\sigma%
\left(W\bm{t}(\bm{x})+\bm{b}\right)=\left\|\bm{V}\sigma\left(\bm{W}\bm{t}(\bm{%
x})+\bm{b}\right)\right\|^{2}=\sum_{i=1}^{m}\left(\sum_{j=1}^{n}v_{ij}\sigma%
\left(\bm{w}_{j}^{\top}\bm{t}(\bm{x})+b_{j}\right)\right)^{2},
\displaystyle\sigma\left(\bm{W}\bm{t}(\bm{x})+\bm{b}\right)^{\top}\bm{M}\sigma%
\left(W\bm{t}(\bm{x})+\bm{b}\right)
\displaystyle=
\displaystyle\left\|\bm{V}\sigma\left(\bm{W}\bm{t}(\bm{x})+\bm{b}\right)\right%
\|^{2}=\sum_{i=1}^{m}\left(\sum_{j=1}^{n}v_{ij}\sigma\left(\bm{w}_{j}^{\top}%
\bm{t}(\bm{x})+b_{j}\right)\right)^{2},
\bm{V}
\bm{v}_{\cdot j}
j
\bm{V}
\sum_{j=1}^{n}\sum_{l=1}^{n}\bm{v}_{\cdot j}^{\top}\bm{v}_{\cdot l}k_{\sigma,%
\bm{t},\mu}(\bm{\theta}_{j},\bm{\theta}_{l})=\sum_{j=1}^{n}\sum_{l=1}^{n}m_{jl%
}k_{\sigma,\bm{t},\mu}(\bm{\theta}_{j},\bm{\theta}_{l})=\operatorname{Tr}(\bm{%
M}\bm{K}_{\bm{\Theta}})
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})=\int%
\sigma\big{(}\bm{w}_{i}^{\top}\bm{t}(\bm{x})+b_{i}\big{)}\sigma\big{(}\bm{w}_{%
j}^{\top}\bm{t}(\bm{x})+b_{j}\big{)}\mu(d\bm{x}).
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})=\int%
\sigma\big{(}\bm{w}_{i}^{\top}\bm{t}(\bm{x})+b_{i}\big{)}\sigma\big{(}\bm{w}_{%
j}^{\top}\bm{t}(\bm{x})+b_{j}\big{)}\mu(d\bm{x}).
\sigma=\exp(\cdot/2)
\bm{\mathsf{x}}=(\bm{\mathsf{x}}_{1},\bm{\mathsf{x}}_{2})
\texttt{SNEFY}{}_{\mathbb{X}_{1}\times\mathbb{X}_{2},\bm{t},\exp(\cdot/2),\mu}
\bm{V}
\bm{\Theta}=(\left[\bm{W_{1}},\bm{W_{2}}\right],\bm{b})
\mu(d\bm{x})=\mu_{1}(d\bm{x}_{1})\mu_{2}(d\bm{x}_{2})
\bm{t}(\bm{x})=\big{(}\bm{t}_{1}(\bm{x}_{1}),\bm{t}_{2}(\bm{x}_{2})\big{)}
\bm{\mathsf{x}}_{1}
\texttt{SNEFY}{}_{\mathbb{X}_{1},\bm{t}_{1},\exp(\cdot/2),\mu_{1}}
\tilde{\bm{V}}
\bm{\Theta}=(\bm{W_{1}},\bm{b})
\tilde{\bm{V}}\in\mathbb{R}^{m\times n}
\bm{V}
\displaystyle k_{\exp\left(\cdot/2\right),\bm{t},\mu}(\bm{\theta}_{i},\bm{%
\theta}_{j})=\exp\left(\frac{1}{2}\left(b_{i}+b_{j}\right)\right)\operatorname%
{z}_{e}\left(\frac{1}{2}\left(\bm{w}_{i}+\bm{w}_{j}\right)\right),
\displaystyle k_{\exp\left(\cdot/2\right),\bm{t},\mu}(\bm{\theta}_{i},\bm{%
\theta}_{j})=\exp\left(\frac{1}{2}\left(b_{i}+b_{j}\right)\right)\operatorname%
{z}_{e}\left(\frac{1}{2}\left(\bm{w}_{i}+\bm{w}_{j}\right)\right),
\operatorname{z}_{e}
\bm{t}
\mu
\displaystyle P_{1}(d\bm{x}_{1};\bm{M},\bm{\Theta})=\frac{\operatorname{Tr}(%
\bm{M}\bm{C}_{\Theta}\left(\bm{x}_{1}\right))}{\operatorname{Tr}(\bm{M}\bm{K}_%
{\bm{\Theta}})}\mu_{1}(d\bm{x}_{1}),
\displaystyle P_{1}(d\bm{x}_{1};\bm{M},\bm{\Theta})
\displaystyle=\frac{\operatorname{Tr}(\bm{M}\bm{C}_{\Theta}\left(\bm{x}_{1}%
\right))}{\operatorname{Tr}(\bm{M}\bm{K}_{\bm{\Theta}})}\mu_{1}(d\bm{x}_{1}),
[\bm{C}_{\Theta}(\bm{x}_{1})]_{ij}=k_{\sigma,\bm{t}_{2},\mu_{2}}\Big{(}\big{(}%
\bm{w}_{2i},\bm{w}_{1i}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{i}\big{)},\big{(}\bm{w%
}_{2j},\bm{w}_{1j}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\big{)}\Big{)}
\sigma=\exp\left(\cdot/2\right)
[\bm{C}_{\Theta}(\bm{x}_{1})]_{ij}=\operatorname{z}_{e,2}\left(\frac{1}{2}%
\left(\bm{w}_{2i}+\bm{w}_{2j}\right)\right)\exp\left(\frac{1}{2}\left(\bm{w}_{%
1i}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{i}\right)\right)\exp\left(\frac{1}{2}\left%
(\bm{w}_{1j}^{\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\right)\right),
\operatorname{z}_{e,2}
\bm{t}_{2}
\mu_{2}
\displaystyle\operatorname{Tr}(\bm{M}\bm{C}_{\Theta}\left(\bm{x}_{1}\right))=%
\sum_{i=1}^{n}\sum_{j=1}^{n}\Big{\{}m_{ij}\operatorname{z}_{e,2}\left(\frac{1}%
{2}\left(\bm{w}_{2i}+\bm{w}_{2j}\right)\right)
\displaystyle\operatorname{Tr}(\bm{M}\bm{C}_{\Theta}\left(\bm{x}_{1}\right))=
\displaystyle\sum_{i=1}^{n}\sum_{j=1}^{n}\Big{\{}m_{ij}\operatorname{z}_{e,2}%
\left(\frac{1}{2}\left(\bm{w}_{2i}+\bm{w}_{2j}\right)\right)
\displaystyle\qquad\qquad\cdot\exp\left(\frac{1}{2}\left(\bm{w}_{1i}^{\top}\bm%
{t}_{1}(\bm{x}_{1})+b_{i}\right)\right)\exp\left(\frac{1}{2}\left(\bm{w}_{1j}^%
{\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\right)\right)\Big{\}}
\displaystyle\qquad\qquad\cdot\exp\left(\frac{1}{2}\left(\bm{w}_{1i}^{\top}\bm%
{t}_{1}(\bm{x}_{1})+b_{i}\right)\right)\exp\left(\frac{1}{2}\left(\bm{w}_{1j}^%
{\top}\bm{t}_{1}(\bm{x}_{1})+b_{j}\right)\right)\Big{\}}
\displaystyle=\exp\left(\frac{1}{2}\left(\bm{W}_{1}^{\top}\bm{t}_{1}(\bm{x}_{1%
})+\bm{b}\right)\right)^{\top}\tilde{\bm{M}}\exp\left(\frac{1}{2}\left(\bm{W}_%
{1}^{\top}\bm{t}_{1}(\bm{x}_{1})+\bm{b}\right)\right)
\displaystyle=
\displaystyle\exp\left(\frac{1}{2}\left(\bm{W}_{1}^{\top}\bm{t}_{1}(\bm{x}_{1}%
)+\bm{b}\right)\right)^{\top}\tilde{\bm{M}}\exp\left(\frac{1}{2}\left(\bm{W}_{%
1}^{\top}\bm{t}_{1}(\bm{x}_{1})+\bm{b}\right)\right)
\tilde{\bm{M}}=\bm{M}\circ\bm{Z}_{e,2}
[\bm{Z}_{e,2}]_{i,j}=\operatorname{z}_{e,2}\left(\frac{1}{2}\left(\bm{w}_{2i}+%
\bm{w}_{2j}\right)\right).
\tilde{\bm{M}}
\tilde{\bm{V}}
\tilde{\bm{M}}=\tilde{\bm{V}}^{\top}\tilde{\bm{V}}
20
1
100
20000
10^{-3}
2^{10}
\mathbb{X}=\mathbb{R}^{2}
\bm{t}
\cos
[2,256,256,1]
0.1
n=50
m=1
10
-1.59\pm 0.03
-1.76\pm 0.02
-3.29\pm 0.01
-1.57\pm 0.03
1431
68007
1194
1240
1352.19\pm 134.30
615.57\pm 24.35
730.21\pm 23.60
753.16\pm 31.41
-1.92\pm 0.02
-1.94\pm 0.03
-3.37\pm 0.01
-2.00\pm 0.06
1431
68007
1194
1240
798.13\pm 196.89
291.03\pm 29.46
162.64\pm 17.19
186.65\pm 21.10
-2.35\pm 0.04
-2.31\pm 0.02
-3.16\pm 0.01
-2.43\pm 0.04
1431
68007
1194
1240
1134.90\pm 133.10
502.32\pm 24.51
528.50\pm 24.51
559.12\pm 30.90
-1.58\pm 0.02
-1.59\pm 0.03
-1.62\pm 0.03
-1.58\pm 0.02
2621
69197
2384
2430
1453.05\pm 147.67
700.98\pm 32.94
831.40\pm 49.24
855.04\pm 53.01
-1.91\pm 0.04
-2.07\pm 0.04
-2.66\pm 0.05
-1.96\pm 0.04
2621
69197
2384
2430
899.77\pm 196.54
363.91\pm 36.62
267.23\pm 32.05
289.96\pm 33.71
-2.35\pm 0.04
-2.32\pm 0.03
-2.80\pm 0.02
-2.36\pm 0.03
2621
69197
2384
2430
1255.92\pm 168.80
579.02\pm 23.70
637.73\pm 34.04
658.98\pm 37.69
-1.58\pm 0.03
-1.60\pm 0.07
-1.60\pm 0.03
-1.57\pm 0.03
5001
71577
4764
4810
1616.21\pm 152.61
851.29\pm 33.63
1005.16\pm 30.59
1026.76\pm 28.21
-1.92\pm 0.04
-1.99\pm 0.03
-2.14\pm 0.16
-1.94\pm 0.04
5001
71577
4764
4810
1035.64\pm 142.39
514.02\pm 47.98
455.58\pm 41.19
480.15\pm 44.61
-2.33\pm 0.02
-2.31\pm 0.03
-2.59\pm 0.12
-2.32\pm 0.04
5001
71577
4764
4810
1410.36\pm 141.04
749.10\pm 52.05
813.92\pm 27.20
833.36\pm 30.77
-1.60\pm 0.02
-1.58\pm 0.02
-1.61\pm 0.08
-1.58\pm 0.03
9761
76337
9524
9570
2036.15\pm 205.52
1198.04\pm 102.71
1399.74\pm 65.78
1423.17\pm 82.84
-1.91\pm 0.03
-1.97\pm 0.05
-2.16\pm 0.29
-1.93\pm 0.03
9761
76337
9524
9570
1405.27\pm 144.72
839.23\pm 92.99
838.62\pm 82.98
862.25\pm 81.09
-2.34\pm 0.06
-2.37\pm 0.17
-2.49\pm 0.16
-2.33\pm 0.07
9761
76337
9524
9570
1795.38\pm 186.62
1071.50\pm 109.12
1201.29\pm 71.76
1218.31\pm 70.36
10610
\texttt{SNEFY}{}_{\mathbb{S}^{2},\exp,\operatorname{Id},d\bm{x}}
m=n=30
\bm{V}
\bm{V}^{\top}\bm{V}
\bm{V}
20000
\operatorname{Snake_{a}}
a=10
\tanh
100
256
\sigma
\bm{V}
\bm{V}\in\mathbb{C}^{m\times n}
\displaystyle\big{\|}\bm{f}\left(\bm{t}(\bm{x});\bm{V},\bm{\Theta}\right)\big{%
\|}_{2}^{2}=\left\|\bm{V}\sigma\left(\bm{W}\bm{t}(\bm{x})+\bm{b}\right)\right%
\|^{2}=\sum_{r=1}^{m}\left|\sum_{j=1}^{n}v_{rj}\sigma\left(\bm{w}_{j}^{\top}%
\bm{t}(\bm{x})+b_{j}\right)\right|^{2}.
\displaystyle\big{\|}\bm{f}\left(\bm{t}(\bm{x});\bm{V},\bm{\Theta}\right)\big{%
\|}_{2}^{2}
\displaystyle=
\displaystyle\left\|\bm{V}\sigma\left(\bm{W}\bm{t}(\bm{x})+\bm{b}\right)\right%
\|^{2}=\sum_{r=1}^{m}\left|\sum_{j=1}^{n}v_{rj}\sigma\left(\bm{w}_{j}^{\top}%
\bm{t}(\bm{x})+b_{j}\right)\right|^{2}.
\sigma(u)=\exp(iu)
\bm{t}(\bm{x})=\bm{x}
\displaystyle\sum_{r=1}^{m}\left|\sum_{j=1}^{n}v_{rj}\exp\left(i\left(\bm{w}_{%
j}^{\top}\bm{x}+b_{j}\right)\right)\right|^{2}=\sum_{r=1}^{m}\sum_{j=1}^{n}%
\sum_{l=1}^{n}v_{rj}\bar{v}_{rl}e^{i\left(\bm{w}_{j}^{\top}\bm{x}+b_{j}\right)%
}e^{-i\left(\bm{w}_{l}^{\top}\bm{x}+b_{l}\right)}=\sum_{r=1}^{m}\sum_{j=1}^{n}%
\sum_{l=1}^{n}v_{rj}\bar{v}_{rl}e^{i\left(b_{j}-b_{l}\right)}e^{i\left(\left(%
\bm{w}_{j}-\bm{w}_{l}\right)^{\top}\bm{x}\right)}.
\displaystyle\sum_{r=1}^{m}\left|\sum_{j=1}^{n}v_{rj}\exp\left(i\left(\bm{w}_{%
j}^{\top}\bm{x}+b_{j}\right)\right)\right|^{2}
\displaystyle=
\displaystyle\sum_{r=1}^{m}\sum_{j=1}^{n}\sum_{l=1}^{n}v_{rj}\bar{v}_{rl}e^{i%
\left(\bm{w}_{j}^{\top}\bm{x}+b_{j}\right)}e^{-i\left(\bm{w}_{l}^{\top}\bm{x}+%
b_{l}\right)}
\displaystyle=
\displaystyle\sum_{r=1}^{m}\sum_{j=1}^{n}\sum_{l=1}^{n}v_{rj}\bar{v}_{rl}e^{i%
\left(b_{j}-b_{l}\right)}e^{i\left(\left(\bm{w}_{j}-\bm{w}_{l}\right)^{\top}%
\bm{x}\right)}.
\sigma=\exp
\bm{V}
n=1
\mu
\operatorname{Tr}(\bm{V}^{H}\bm{V}\bm{K}_{\bm{\Theta}})
[\bm{K}_{\bm{\Theta}}]_{jl}=k_{\exp(i\cdot),\operatorname{Id},\mu}(\bm{w}_{j},%
\bm{w}_{l})=\int e^{i\left(\left(\bm{w}_{j}-\bm{w}_{l}\right)^{\top}\bm{x}%
\right)}\mu(d\bm{x})=:\kappa(\bm{w}_{j}-\bm{w}_{l}),
\kappa
\mu
\mu
\mu
\bm{V}
\kappa
\mu
\kappa
\bm{V}
\cos
\sin
\sum_{r=1}^{m}\left|\sum_{j=1}^{n}v_{rj}\exp\left(i\left(\bm{w}_{j}^{\top}\bm{%
x}+b_{j}\right)\right)\right|^{2}=\left\|\bm{V}\cos\left(\bm{W}\bm{x}+\bm{b}%
\right)\right\|^{2}+\left\|\bm{V}\sin\left(\bm{W}\bm{x}+\bm{b}\right)\right\|^%
{2}.
\mathbb{X}
h(x)
\mu
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})=\sum_{\bm%
{x}\in\mathbb{X}}\sigma\big{(}\bm{w}_{1}^{\top}\bm{t}(\bm{x})+b_{1}\big{)}%
\sigma\big{(}\bm{w}_{2}^{\top}\bm{t}(\bm{x})+b_{2}\big{)}h(\bm{x}).
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\sum_{\bm{x}\in\mathbb{X}}\sigma\big{(}\bm{w}_{1}^{\top}\bm{t}(%
\bm{x})+b_{1}\big{)}\sigma\big{(}\bm{w}_{2}^{\top}\bm{t}(\bm{x})+b_{2}\big{)}h%
(\bm{x}).
\sigma=\cos
C_{x}=h(x)
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})=\frac{1}{%
2}\sum_{x=0}^{\infty}C_{x}\Big{(}\cos\big{(}t(x)(w_{1}-w_{2})+(b_{1}-b_{2})%
\big{)}+\cos\big{(}t(x)(w_{1}+w_{2})+(b_{1}+b_{2})\big{)}\Big{)}
\displaystyle k_{\sigma,\bm{t},\mu}(\bm{\theta}_{i},\bm{\theta}_{j})
\displaystyle=\frac{1}{2}\sum_{x=0}^{\infty}C_{x}\Big{(}\cos\big{(}t(x)(w_{1}-%
w_{2})+(b_{1}-b_{2})\big{)}+\cos\big{(}t(x)(w_{1}+w_{2})+(b_{1}+b_{2})\big{)}%
\Big{)}
C_{x}=\frac{2(-1)^{x+1}}{\pi x}
x\geq 1
C_{x}=0
t(x)=2\pi x
w_{1}-w_{2}
w_{1}+w_{2}
b_{1}-b_{2}
b_{1}+b_{2}
\mathbb{X}=\mathbb{R}^{d}
\mu(d\mathbf{x})=\frac{1}{2}\big{(}\Phi(\mathbf{x})+\delta(\mathbf{x})\big{)}%
\,d\mathbf{x}
\sigma
\mathbf{t}
\mathbf{t}
\sigma
\displaystyle k_{\sigma,\mathbf{t},\mu}(\mathbf{\theta}_{i},\mathbf{\theta}_{j%
})=\frac{1}{2}\Big{(}\int_{\mathbb{X}}\sigma\big{(}\mathbf{W}_{i}^{\top}%
\mathbf{t}(\mathbf{x})+b_{i}\big{)}\sigma\big{(}\mathbf{W}_{j}^{\top}\mathbf{t%
}(\mathbf{x})+b_{j}\big{)}\delta(\mathbf{x})d\mathbf{x}+
\displaystyle k_{\sigma,\mathbf{t},\mu}(\mathbf{\theta}_{i},\mathbf{\theta}_{j})
\displaystyle=\frac{1}{2}\Big{(}\int_{\mathbb{X}}\sigma\big{(}\mathbf{W}_{i}^{%
\top}\mathbf{t}(\mathbf{x})+b_{i}\big{)}\sigma\big{(}\mathbf{W}_{j}^{\top}%
\mathbf{t}(\mathbf{x})+b_{j}\big{)}\delta(\mathbf{x})d\mathbf{x}+
\displaystyle\phantom{{}=\frac{1}{2}\Big{(}}\int_{\mathbb{X}}\sigma\big{(}%
\mathbf{W}_{i}^{\top}\mathbf{t}(\mathbf{x})+b_{i}\big{)}\sigma\big{(}\mathbf{W%
}_{j}^{\top}\mathbf{t}(\mathbf{x})+b_{j}\big{)}\Phi(\mathbf{x})d\mathbf{x}\Big%
{)}
\displaystyle\phantom{{}=\frac{1}{2}\Big{(}}\int_{\mathbb{X}}\sigma\big{(}%
\mathbf{W}_{i}^{\top}\mathbf{t}(\mathbf{x})+b_{i}\big{)}\sigma\big{(}\mathbf{W%
}_{j}^{\top}\mathbf{t}(\mathbf{x})+b_{j}\big{)}\Phi(\mathbf{x})d\mathbf{x}\Big%
{)}
\displaystyle=\frac{1}{2}\Big{(}\sigma\big{(}\mathbf{W}_{i}^{\top}\mathbf{t}(%
\mathbf{0})+b_{i}\big{)}\sigma\big{(}\mathbf{W}_{j}^{\top}\mathbf{t}(\mathbf{0%
})+b_{j}\big{)}+k_{\sigma,\mathbf{t},\Phi}(\mathbf{\theta}_{i},\mathbf{\theta}%
_{j})\Big{)},
\displaystyle=\frac{1}{2}\Big{(}\sigma\big{(}\mathbf{W}_{i}^{\top}\mathbf{t}(%
\mathbf{0})+b_{i}\big{)}\sigma\big{(}\mathbf{W}_{j}^{\top}\mathbf{t}(\mathbf{0%
})+b_{j}\big{)}+k_{\sigma,\mathbf{t},\Phi}(\mathbf{\theta}_{i},\mathbf{\theta}%
_{j})\Big{)},
