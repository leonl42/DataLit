X_{\text{out}}
Y_{\text{in}}
X_{\text{out}}
Y_{\text{in}}
X_{\text{in}}
X_{\text{out}}
Y_{\text{in}}
S_{c}(\cdot)
z_{i}
\bm{z}
\frac{\partial S_{c}(\bm{z})}{\partial z_{i}}
\mathcal{X}
\mathcal{Y}_{\text{in}}=\{1,2,...,C\}
c
S_{c}(\cdot)
x_{\text{out}}
\mathcal{X}
\mathcal{X}_{\text{out}}
\mathcal{Y}_{\text{in}}
\Delta(x)
x
\mathcal{G}(x)=\begin{cases}\text{out},&\text{if}\quad\Delta(x)>\gamma\\
\text{in},&\text{if}\quad\Delta(x)\leq\gamma\\
\end{cases}
x
\gamma
c
S_{c}(\cdot)
k
l
\bm{A}^{kl}\in\mathbb{R}^{W\times H}
A^{kl}_{ij}
\text{Grad}_{ij}=\frac{\partial S_{c}(\bm{A}^{kl})}{\partial A^{kl}_{ij}}
\bm{M}\in\mathbb{R}^{W\times H}
\bm{A}\in\mathbb{R}^{K\times W\times H}
K
\alpha_{ij}
M_{ij}
\alpha_{ij}=\text{ReLU}(\sum_{k=1}^{K}w_{k}A^{k}_{ij}),\quad\text{where}\quad w%
_{k}=\frac{\partial g(\bm{A})}{\partial A^{k}_{ij}}=\frac{1}{W\times H}\sum^{W%
}_{i=1}\sum^{H}_{j=1}\frac{\partial S_{c}(\bm{A})}{\partial A^{k}_{ij}}\quad
w_{k}
g(\bm{A})
\bm{A}
w_{k}
\frac{\partial S_{c}(\bm{A})}{\partial A^{k}_{ij}}
c
S_{c}(\bm{z})
\bm{z}=[z_{1},...,z_{n}]
P
S_{c}(\bm{0})
\bm{z}
S_{c}(\bm{0})=S_{c}(\bm{z})+\sum^{P}_{p=1}\sum_{i=1}^{n}\frac{1}{p!}\frac{%
\partial^{p}S_{c}(\bm{z})}{\partial(z_{i})^{p}}(z_{i})^{p}+\frac{1}{2!}\frac{%
\partial^{2}S_{c}(\bm{z})}{\partial z_{1}\partial z_{2}}z_{1}z_{2}+...+R_{P}(%
\bm{z})
R_{P}(\bm{z})
P
\bm{\kappa}=[\kappa_{1},...,\kappa_{n}]\in\mathbb{N}^{n}
\kappa_{i}\in\mathbb{N}
z_{i}
\kappa_{i}=1
z_{i}
c
\bm{z}
|S_{c}(\bm{z})-S_{c}(\bm{0})|=|\sum_{p=1}^{P}\sum_{\bm{\kappa}\in\Omega,|\bm{%
\kappa}|=p}\mathcal{C}(\bm{\kappa})\cdot\frac{\partial^{\kappa_{1}+\cdots+%
\kappa_{n}}S_{c}(\bm{z})}{\partial^{\kappa_{1}}z_{1}\cdots\partial^{\kappa_{n}%
}z_{n}}(z_{1})^{\kappa_{1}}\cdots(z_{n})^{\kappa_{n}}+R_{P}(\bm{z})|\\

\mathcal{C(\bm{\kappa})}
\bm{\kappa}
z_{i}
c
\alpha_{i}
z_{i}
z_{i}
S_{c}(\bm{z})
\phi_{i}(\bm{\kappa})
\psi_{i}(\bm{\kappa})
\phi_{i}(\bm{\kappa})
z_{i}
\bm{\kappa}=[0,\cdots,\kappa_{i},\cdots,0]\in\Omega_{\phi}
\kappa_{i}>0
\psi_{i}(\bm{\kappa})
z_{i}
\bm{\kappa}\in\Omega_{\psi}
\kappa_{i}>0
\alpha_{i}=\sum_{p=1}^{P}\sum_{\bm{\kappa}\in\Omega_{\phi},|\bm{\kappa}|=p}%
\omega_{i,\bm{\kappa}}\phi_{i}(\bm{\kappa})+\sum_{p=1}^{P}\sum_{\bm{\kappa}\in%
\Omega_{\psi},|\bm{\kappa}|=p}\omega_{i,\bm{\kappa}}\psi_{i}(\bm{\kappa})
\omega_{i,\bm{\kappa}}
\alpha_{i}
\bm{z}
z_{i}\in\bm{z}
\frac{\partial S_{c}(\bm{z})}{\partial z_{i}}
\alpha_{i}=0
\bm{z}
z_{i}
z_{i}
z_{i}
\frac{\partial S_{c}(\bm{z})}{\partial z_{i}}=0\Rightarrow\frac{\partial^{%
\kappa_{1}+\cdots+\kappa_{n}}S_{c}(\bm{z})}{\partial^{\kappa_{1}}z_{1}\cdots%
\partial^{\kappa_{n}}z_{n}}=0,\kappa_{i}>0\Rightarrow\phi_{i}(\bm{\kappa})=%
\psi_{i}(\bm{\kappa})=0\Rightarrow\alpha_{i}=0
\mathbf{\bm{\kappa}}=[0,...,\kappa_{i}=1,...0]
\kappa_{j}=0
j\neq i
S_{c}(\bm{A})
c=\text{argmax}_{c_{i}\in C}S_{c_{i}}(\bm{A})
\text{log}(\text{softmax}(\cdot))
\frac{\partial\mathcal{S}(\bm{A})}{\partial A^{k}_{ij}}=\frac{\partial\sum_{c%
\in C}\text{log softmax}(S_{c}(\bm{A}))}{\partial A^{k}_{ij}}
A^{k}_{ij}
\bm{A}\in\mathbb{R}^{K\times W\times H}
S_{c}(\bm{A})=\Psi(\bm{A}_{\text{last}},\Theta_{\Psi})
\Psi(\cdot)
\bm{A}_{\text{last}}\in\mathbb{R}^{1\times W_{\text{last}}\times H_{\text{last%
}}}
\Phi(\cdot)
\bm{A}_{\text{last}}=\Phi(\bm{A},\Theta_{\Phi})
\bm{A}_{\text{last}}
\bm{A}^{k}\in\mathbb{R}^{1\times W\times H}
k
\bm{A}
\nabla\bm{A}_{\text{last}}
\nabla\bm{A}^{k}
\displaystyle\nabla\bm{A}^{k}=\frac{\partial\Phi(\bm{A},\Theta_{\Phi})}{%
\partial\bm{A}^{k}}
\displaystyle\nabla\bm{A}^{k}=\frac{\partial\Phi(\bm{A},\Theta_{\Phi})}{%
\partial\bm{A}^{k}}
\displaystyle\nabla\bm{A}_{\text{last}}=\frac{\partial\mathcal{S}(\bm{A}_{%
\text{last}})}{\partial\bm{A}_{\text{last}}}=\frac{\partial\sum_{c\in C}\text{%
log softmax}(S_{c}(\bm{A}_{\text{last}}))}{\partial\bm{A}_{\text{last}}}
\displaystyle\nabla\bm{A}_{\text{last}}=\frac{\partial\mathcal{S}(\bm{A}_{%
\text{last}})}{\partial\bm{A}_{\text{last}}}=\frac{\partial\sum_{c\in C}\text{%
log softmax}(S_{c}(\bm{A}_{\text{last}}))}{\partial\bm{A}_{\text{last}}}
k
l
\bm{A}^{kl}\in\mathbb{R}^{1\times W\times H}
\bm{A}^{kl}
\mathbb{E}[\epsilon|\bm{A}^{kl}]=\frac{1}{W\times H}\mid\{A^{kl}_{ij}\quad|%
\quad\frac{\partial S_{c}(\bm{A}^{kl})}{\partial A^{kl}_{ij}}\neq 0\}\mid
\bm{A}_{\text{last}}
\mathbb{E}[\epsilon|\bm{A}^{kl}]=\frac{\mathbb{E}_{\text{inner}}[\epsilon|\bm{%
A}^{kl}]}{\sqrt{\mathbb{E}_{\text{output}}[\epsilon|\bm{A}_{\text{last}}]}}=%
\frac{\mid\frac{1}{W\times H}\sum_{g^{kl}\in\nabla\bm{A}^{kl}}g^{kl}\mid}{\mid%
\frac{1}{W_{\text{last}}\times H_{\text{last}}}\sum_{g_{\text{last}}\in\nabla%
\bm{A}_{\text{last}}}g_{\text{last}}\mid^{\frac{1}{2}}}
L
K_{l}
\bm{\Lambda}\in\mathbb{R}^{L\times K_{m}}
K_{m}=\text{max}\{K_{i}|1\leq i\leq L\}
\Lambda_{ij}=0
j>K_{i}
K_{m}=K_{L}
\|\bm{\Lambda}\|_{F}
\|\bm{\Lambda}\|_{F}=\VNiceMatrix\mathbb{E}[\epsilon|\bm{A}^{1,1}]&\cdots%
\mathbb{E}[\epsilon|\bm{A}^{1,K_{1}}]0\cdots 0\\
\Vdots\Vdots\Vdots\\
\mathbb{E}[\epsilon|\bm{A}^{L,1}]\cdots\mathbb{E}[\epsilon|\bm{A}^{L,K_{1}}]%
\Cdots\Cdots\mathbb{E}[\epsilon|\bm{A}^{L,K_{m}}]_{F}=\sqrt{\sum_{i}^{L}\sum_{%
j}^{K_{m}}(\mathbb{E}[\epsilon|\bm{A}^{i,j}])^{2}}
x
f_{\theta}
\Delta(x)
\{S_{c}(x)|c\in C\}
f_{\theta}(x)
\frac{\partial S_{c}(\bm{A}^{kl})}{\partial A^{kl}_{ij}}
\mathbb{E}[\epsilon|\bm{A}^{kl}]
\|\bm{\Lambda}\|_{F}
\|\bm{\Lambda}\|_{F}
\Delta(x)
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
11.32\%
\|\bm{\Lambda}\|_{F}
\bm{\Lambda}
p
\bm{\Lambda$}.
\bm{\Lambda$}.
\mathbb{E}_{\text{inner}}[\epsilon|\bm{A}^{kl}]
\mathbb{E}_{\text{output}}[\epsilon|\bm{A}^{kl}]
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\checkmark
\checkmark
