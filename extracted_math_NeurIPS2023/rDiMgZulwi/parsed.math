L
f_{\theta}(x):=h_{L}(x)
h_{0}(x)=x
h_{l+1}(x)=\phi(\mathbf{W}_{l}h_{l}(x)+\mathbf{b}_{l})
\phi
\theta=\{\theta_{L},\dots,\theta_{1}\}
\theta_{l}=\{\mathbf{W}_{l},\mathbf{b}_{l}\}
l
f_{\theta}
\tau
p_{\tau}
(x,y)
T
t\in\left((\tau-1)T,\tau T\right]
J_{\tau}(\theta)=\mathbb{E}_{(x,y)\sim p_{\tau}}\big{[}\ell(f_{\theta}(x),y)%
\big{]},
\ell
t
\theta^{(t+1)}=\theta^{(t)}-\alpha\nabla_{\theta}J_{\tau(t)}(\theta)\big{|}_{%
\theta=\theta^{(t)}}
\tau(t)=\lfloor t/T\rfloor
J_{\tau(t)}
(x_{t},y_{t})\sim p_{\tau}
t=\tau T
T
\tau
J_{\tau}(\theta^{(\tau T)})
\tau
h_{l+1}=\texttt{ReLU}(\theta_{l}h_{l})
\mathbf{J}_{l}=\frac{\partial h_{l+1}}{\partial h_{l}}=\mathbf{D}_{l}\theta_{l}
\mathbf{D}_{l}=\text{Diag}(\texttt{ReLU}^{\prime}([\theta_{l}h_{l}]_{1}),%
\ldots,\texttt{ReLU}^{\prime}([\theta_{l}h_{l}]_{d}))
\texttt{ReLU}^{\prime}(x)
x>0
x<0
x=0
\theta_{l}
\mathbf{D}_{l}
\sigma_{d}(\theta_{l})\leq\cdots\leq\sigma_{1}(\theta_{l})
\sigma_{d}(\mathbf{D}_{l})\leq\cdots\leq\sigma_{1}(\mathbf{D}_{l})
\sigma_{d}(\mathbf{D}_{l})\sigma_{i}(\theta_{l})<\sigma_{i}(\mathbf{J}_{l})<%
\sigma_{1}(\mathbf{D}_{l})\sigma_{i}(\theta_{l})
i\in\{1,\dotso,d\}
\theta_{l}
\mathbf{D}_{l}
\kappa(\mathbf{J}_{l})=\nicefrac{{\sigma_{1}(\mathbf{J}_{l})}}{{\sigma_{d}(%
\mathbf{J}_{l})}}
\theta_{l}
\mathbf{D}_{l}
\kappa(\theta_{l})
\kappa(\mathbf{D}_{l})
\kappa(\theta_{l})/\kappa(\mathbf{D}_{l})\leq\kappa(\mathbf{J}_{l})\leq\kappa(%
\theta_{l})\kappa(\mathbf{D}_{l})
f_{\theta}(x)=\theta_{2}\texttt{ReLU}(\theta_{1}x)
x\in\mathbb{R}^{2}
\mathbb{R}
x=(1,0)^{\top}
y=0
f_{\theta}(x)=y
\theta_{1}=\begin{bmatrix}1&0\\
0&a\end{bmatrix}
\theta_{2}=(0,a)
a\geq 0
x=(0,1)^{\top}
y=1
\ell(f_{\theta}(x),y)=\frac{1}{2}(y-\ell(f_{\theta}(x))^{2}
(x,y)
\nabla_{\theta_{2}}\ell(f_{\theta}(x),y)=(f_{\theta}(x)-y)\texttt{ReLU}(\theta%
_{1}x)=(a^{2}-1)(0,a)^{\top}
\nabla_{\theta_{1}}\ell(f_{\theta}(x),y)=(f_{\theta}(x)-y)x\texttt{ReLU}^{%
\prime}(\theta_{1}x)^{\top}=(a^{2}-1)\begin{bmatrix}0&0\\
0&a\end{bmatrix}
\Theta(a)
\theta_{1}
\kappa=1/a
\Theta(1/a)=\Theta(\kappa)
\mathbf{G}=[\mathbf{g}_{1},\ldots,\mathbf{g}_{m}]
\text{rank}(\mathbf{G})=|\{i:\sigma_{i}(\mathbf{G})>0\}|
\nicefrac{{\sigma_{1}(\mathbf{G})}}{{\sigma_{m}(\mathbf{G})}}
\text{erank}(\mathbf{G})=\sum\bar{\sigma}_{i}(\mathbf{G})\log\bar{\sigma}_{i}(%
\mathbf{G})
\bar{\sigma}_{i}(\mathbf{G})=\nicefrac{{\sigma_{i}(\mathbf{G})}}{{\sum_{i}%
\sigma_{i}(\mathbf{G})}}
(x_{i},y_{i})
\theta_{l}\in\mathbb{R}^{d\times d}
l
\mathbf{G}_{l,i}=\nabla_{\theta_{l}}\ell(f_{\theta}(x_{i}),y_{i})=\delta_{l,i}%
h_{l-1,i}^{\top}
\delta_{l,i}=\theta_{l+1}^{\top}\delta_{l+1,i}\mathbf{D}_{l,i}
\delta_{L,i}=\nicefrac{{\partial\ell(f_{\theta}(x_{i}),y_{i})}}{{\partial f_{%
\theta}}}
\mathbf{D}_{l,i}=\text{Diag}(\phi^{\prime}([\theta_{l}h_{l,i}]_{1}),\dotso,%
\phi^{\prime}([\theta_{l}h_{l,i}]_{d}))
\mathbf{g}_{l,i}=\text{vec}(\mathbf{G}_{l,i})=(\mathbf{I}_{d}\otimes\theta_{l+%
1}^{\top})\mathbf{v}_{l,i}
\mathbf{I}_{d}
d\times d
{\mathbf{v}_{1,i}=\text{vec}(\delta_{l+1,i}\mathbf{D}_{l,i}h_{l-1,i}^{\top})%
\in\mathbb{R}^{d^{2}}}
\mathbf{G}_{l}=[\mathbf{g}_{l,1},\mathbf{g}_{l,2},\dotso,\mathbf{g}_{l,m}]=(%
\mathbf{I}_{d}\otimes\theta_{l+1}^{\top})\mathbf{V}_{l}
\mathbf{V}_{l}=[\mathbf{v}_{l,1},\mathbf{v}_{l,2},\dotso,\mathbf{v}_{l,m}]
\mathbf{G}_{l}
\text{rank}(\mathbf{G}_{l})<\min\{\text{rank}(\mathbf{I}_{d}\otimes\theta_{l+1%
}^{\top}),\text{rank}(\mathbf{V}_{l})\}=\min\{d\,\text{rank}(\theta_{l+1}^{%
\top}),\text{rank}(\mathbf{V}_{l})\}.
\theta_{l+1}
\sqrt{t}
t
\|\mathbf{\theta}\|_{F}^{2}=\sum_{i}\sum_{j}[\theta]_{ij}^{2}=\sum_{i}\sigma_{%
i}(\theta)^{2}
\|\theta_{l}\|_{F}\leq\sqrt{\text{rank}(\theta_{l})}\sigma_{1}(\theta_{l})
\sigma_{1}(\theta_{l})
l
\sqrt{t}
\theta_{l}
\sigma_{d}(\mathbf{D}_{l})\sigma_{1}(\theta_{l})\leq\sigma_{1}(\mathbf{J}_{l})
\mathcal{R}_{\tau(t)}(\theta,s)
\theta
\tau(t)
s
J_{\tau(t)}(\theta)
J^{\lambda}_{\tau(t)}(\theta)=J_{\tau(t)}(\theta)+\lambda\mathcal{R}_{\tau(t)}%
(\theta,s)
\lambda
\sqrt{t}
\mathcal{R}_{\tau(t)}(\theta,\varnothing)=\|\theta\|^{2}
\mathcal{R}_{\tau(t)}(\theta,\theta^{(0)})=\|\theta-\theta^{(0)}\|^{2}
\theta_{l}
l
\mathbf{W}_{l}
\mathbf{b}_{l}
\theta_{l}=[\mathbf{W}_{l}|\mathbf{b}_{l}]
\tilde{h}_{l}=[h_{l},\mathbf{1}]
f_{\theta}
h_{l+1}(x)=\phi(\mathbf{W}_{l}h_{l}(x)+\mathbf{b}_{l})=\phi(\theta_{l}\tilde{h%
}_{l})
\theta_{l}
\sigma_{1}(\theta_{l})=\sigma_{1}([\mathbf{W}_{l}|\mathbf{b}_{l}])\leq\sigma_{%
1}(\mathbf{W}_{l})+\sigma_{1}(\mathbf{b}_{l})
\mathbf{W}_{l}
\mathbf{b}_{l}
\mathcal{R}_{\tau(t)}(\theta_{l})=\sum_{l\in\text{layers}}\left((\sigma_{1}(%
\mathbf{W}_{l})^{k}-1)^{2}+\left(\sigma_{1}(\mathbf{b}_{l})^{k}\right)^{2}%
\right)=\sum_{l\in\text{layers}}\left((\sigma_{1}(\mathbf{W}_{l})^{k}-1)^{2}+%
\|\mathbf{b}_{l}\|_{2}^{2k}\right).
k
k=2
k
1
x_{1}=[0,1]^{\top}
x_{2}=[1,0]^{\top}
y_{1}=y_{2}=1
f_{w_{2},w_{1}}(x)=w_{2}\texttt{ReLU}(w_{1}x)
w_{1}=\begin{bmatrix}-1&c\\
\nicefrac{{1}}{{c}}&-1\end{bmatrix}
w_{2}=[\nicefrac{{1}}{{c}},c]\in\mathbb{R}^{1\times 2}
c
w_{1}
w_{1}
c
\|w_{1}\|_{2}:=\sigma_{max}(w_{1})=c+\nicefrac{{1}}{{c}}
c
y_{1}^{\prime}=0
c
\displaystyle w_{1}^{\prime}(x_{1})=\begin{bmatrix}-1&c\\
\nicefrac{{1}}{{c}}&-1\end{bmatrix}-\alpha\left(\underbrace{\begin{bmatrix}0&%
\nicefrac{{1}}{{c}}\\
0&0\end{bmatrix}}_{\nabla_{w_{1}}\ell_{1}}\right),\hskip 28.45274ptw_{2}^{%
\prime}(x_{1})=[\nicefrac{{1}}{{c}},c]-\alpha\left(\underbrace{[c,0]}_{\nabla_%
{w_{2}}\ell_{1}}\right),
\displaystyle w_{1}^{\prime}(x_{1})=\begin{bmatrix}-1&c\\
\nicefrac{{1}}{{c}}&-1\end{bmatrix}-\alpha\left(\underbrace{\begin{bmatrix}0&%
\nicefrac{{1}}{{c}}\\
0&0\end{bmatrix}}_{\nabla_{w_{1}}\ell_{1}}\right),\hskip 28.45274ptw_{2}^{%
\prime}(x_{1})=[\nicefrac{{1}}{{c}},c]-\alpha\left(\underbrace{[c,0]}_{\nabla_%
{w_{2}}\ell_{1}}\right),
\ell_{1}=\ell(f_{w_{2},w_{1}}(x_{1}),y^{\prime}_{1})
\alpha
x_{1}
w_{2}
\|\nabla_{w_{2}}\ell(f_{w_{2},w_{1}}(x_{1}),y_{1}^{\prime})\|^{2}=c
w_{1}
\|\nabla_{w_{1}}\ell(f_{w_{2},w_{1}}(x_{1}),y_{1}^{\prime})\|^{2}=\nicefrac{{1%
}}{{c}}
w_{2}
w_{1}
y_{2}
c\approx 1
\texttt{ReLU}(x)=\max(x,0)
f_{\theta}(x)=\theta_{2}\phi(\theta_{1}x)
\theta_{1}\in\mathbb{R}^{d\times d_{in}}
\theta_{2}\in\mathbb{R}^{d_{out}\times d}
\phi
J(\theta)=\frac{1}{2}\mathbb{E}_{(x,y)\sim p}\left[(y-f_{\theta}(x))^{2}\right]
\nabla_{\theta_{2}}J(\theta)=(y-f)\phi(\theta_{1}x)^{\intercal}
\nabla_{\theta_{1}}J(\theta)=\theta_{2}^{\intercal}(f-y)\phi^{\prime}(\theta_{%
1}x)x^{\intercal}
\theta_{1}
\theta_{2}
x
\phi(\theta_{1}x)=0
h_{l+1}=\phi(\theta_{l}h_{l})
\frac{2}{L}
L
i
k
h^{l}_{i}=\phi\left(\sum_{j=1}^{d_{l-1}}\theta^{l}_{ij}h^{l-1}_{j,k}\right)=0
\sigma^{(1)}(\theta_{l})\approx 1
\theta\in\mathbb{R}^{d_{l}\times d_{l-1}}
\nicefrac{{1}}{{\sqrt{d_{l}}}}\|\theta_{l}\|_{1}<\|\theta_{l}\|_{2}
\|\theta_{l}\|_{1}=\max_{1\leq j\leq d_{l}}\sum_{i=1}^{d_{l}}|[\theta_{l}]_{ij}|
\sum_{i=1}^{d_{l}}|[\theta_{l}]_{ij}|<\sqrt{d_{l}}
j
\sqrt{t}
\gamma\in\mathbb{R}^{d}
f(z)=\gamma\circ z=\text{Diag}(\gamma)z
\sigma_{max}(\text{Diag}(\gamma))=\max_{i}|\gamma_{i}|
\left(\log\left(\sum_{i}\exp(|\gamma_{i}|)\right)-1\right)^{2}
k\times k
d_{in}
d_{out}
d_{out}\times(k\cdot k\cdot d_{in})
0.001
[0.005,0.001,0.0005]
[0.01,0.001,0.0001]
0.0001
0.001
1e-4
2
256
10,000
1
k
k
k=1,2,4,8
k=2
k
k=1,2,4,8
k=2
