x^{\text{adv}}
x
\ell^{\text{adv}}
\mathcal{F}^{c}_{\theta}
x
\mathcal{F}^{f}_{\theta}
\ell
x^{\text{adv}}
x
\ell^{\text{adv}}
\mathcal{F}^{c}_{\theta}
x
\mathcal{F}^{f}_{\theta}
\ell
D_{\text{train}}
{\{{x}^{i},{y}^{i}\}}_{i=1}^{N}
{x}^{i}\in X
{y}^{i}\in Y
D_{f}
D_{\text{train}}
D_{r}=D_{\text{train}}\setminus D_{f}
\mathcal{M}_{\theta}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
\mathcal{F}^{f}_{\theta}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
\mathcal{F}^{c}_{\theta}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
\theta
D_{\text{train}}
\mathcal{M}_{\theta}
\mathcal{F}^{c}_{\theta}\circ\mathcal{F}^{f}_{\theta}
x^{\text{adv}}
x
\ell^{\text{adv}}
\ell
\mathcal{F}^{f}_{\theta}
D_{f}
x^{t+1}=\Pi(x^{t}+(\epsilon\cdot sign(\nabla_{x}\mathcal{L}({x},{y},\theta))),
\theta
\nabla_{x}\mathcal{L}
\mathcal{L}
x
x^{t}
\Pi
x^{t+1}
{t}
x^{t+1}
x^{\text{adv}}
\mathcal{F}^{c}_{\theta}
D_{f}
\ell^{t+1}=\Pi(\ell^{t}+(\epsilon\ \cdot sign(\nabla_{\ell}\mathcal{L}(\ell,{y%
},\theta))),
\ell
\mathcal{F}^{f}_{\theta}
\ell
\mathcal{F}^{c}_{\theta}
\ell
\ell^{\text{adv}}
{D_{f}}
\mathcal{F}^{c}_{\theta}
{\mathcal{F}^{c}_{\theta}}
\mathcal{M}_{\theta}
{D_{f}}
\mathcal{F}^{c}_{\theta}
{D_{f}}
\small\mathcal{M}_{\theta^{*}}=\mathcal{F}_{\theta^{*}}^{c}\circ\mathcal{F}^{f%
}_{\theta},
\theta^{*}
D_{f}
{\mathcal{F}^{c}_{\theta}}
\mathcal{S}_{\theta}
\mathcal{S}_{\theta}
\mathcal{T}_{\theta}
D_{f}
\ell_{f}
\mathcal{F}_{\theta}^{f}
\ell_{f}
\ell^{\text{adv}}_{f}
\mathcal{T}_{\theta}
\ell_{f}
\ell^{\text{adv}}_{f}
\mathcal{S}_{\theta}
\mathcal{T}_{\theta}
\mathcal{S}_{\theta}
y_{f}
\mathcal{T}_{\theta}
\mathcal{L}_{CE}=\begin{cases}\text{C}E(\mathcal{S}_{\theta}(\ell_{f}),y_{f}^{%
\text{adv}})&\text{if }y_{\mathcal{S}_{\theta}}=y_{f}\\
\text{C}E(\mathcal{S}_{\theta}(\ell_{f}),y_{\mathcal{S}_{\theta}})&\text{%
otherwise},\end{cases}
y_{\mathcal{S}_{\theta}}
\mathcal{S}_{\theta}(\ell_{f})
y_{f}^{\text{adv}}
Z
\textnormal{Z}=\begin{cases}\sigma(\mathcal{T}_{\theta}(\ell_{f}^{\text{adv}})%
)&\text{if }y_{\mathcal{S}_{\theta}}=y_{f}\\
\sigma(\mathcal{S}_{\theta}(\ell_{f}))&\text{otherwise},\end{cases}
\sigma
\mathcal{T}_{\theta}
\mathcal{S}_{\theta}
\mathcal{F}^{c}_{\theta}
\mathcal{L}_{DI}=\text{KL}\left(\sigma(\cfrac{\mathcal{S}_{\theta}(\ell_{f})}{%
T}),\sigma(\cfrac{\textnormal{Z}}{T})\right),
\mathcal{T}_{\theta}
\mathcal{L}_{DI}
\mathcal{S}_{\theta}
\mathcal{T}_{\theta}
D_{f}
T
T
\mathcal{S}_{\theta}
\mathcal{T}_{\theta}
T
\mathcal{L}_{CE}
\mathcal{L}_{DI}
\mathcal{L}=(1-\alpha)\cdot\mathcal{L}_{CE}+\alpha\cdot T^{2}\cdot\mathcal{L}_%
{DI},
\alpha
\mathcal{L}_{CE}
\mathcal{L}_{DI}
\alpha
\mathcal{L}_{CE}
\mathcal{L}_{DI}
\alpha
T^{2}
\mathcal{F}^{f}_{\theta}
\mathcal{F}^{c}_{\theta}
D_{f}
\eta
\alpha
{T}
{E}
\mathcal{M}_{\theta^{*}}
\mathcal{S}_{\theta}\leftarrow\mathcal{F}^{c}_{\theta}
\theta^{*}\leftarrow\theta
e
E
\mathcal{T}_{\theta^{*}}\leftarrow\mathcal{S}_{\theta^{*}}
{\mathcal{L}}\leftarrow(1-\alpha)\cdot{\mathcal{L}}_{CE}+\alpha\cdot T^{2}%
\cdot\mathcal{L}_{DI}
\theta^{*}\leftarrow\theta^{*}-\eta\cdot\mathcal{L}
\mathcal{F}^{c}_{\theta^{*}}\circ\mathcal{F}^{f}(X_{f})!=Y_{f}
\mathcal{M}_{\theta^{*}}\leftarrow\mathcal{F}^{c}_{\theta^{*}}\circ\mathcal{F}%
^{f}_{\theta}
\mathcal{M}_{\theta^{*}}
\mathcal{T}_{\theta}
D_{f}
\mathcal{M}_{\theta^{*}}
\mathcal{F}^{f}_{\theta}
\mathcal{F}^{c}_{\theta^{*}}
D_{r}\uparrow
D_{f}\downarrow
D_{tr}\uparrow
D_{tf}\downarrow
D_{r}\uparrow
D_{f}\downarrow
D_{tr}\uparrow
D_{tf}\downarrow
D_{r}\uparrow
D_{f}\downarrow
D_{tr}\uparrow
D_{tf}\downarrow
D_{r}\uparrow
D_{f}\downarrow
D_{tr}\uparrow
D_{tf}\downarrow
D_{\text{train}}
D_{r}
D_{f}
D_{r}
D_{f}
D_{f}
D_{f}
D_{f}
10^{-4}
\alpha
T
D_{f}
D_{r}
D_{tf}
D_{tr}
D_{f}
D_{f}
D_{r}
{\text{US}(\text{acc}_{r},\text{acc}_{f})}=\cfrac{\exp(\cfrac{\text{acc}_{r}}{%
100})+\exp(1-\cfrac{\text{acc}_{f}}{100})-2}{2\cdot(\exp(1)-1)},
\text{acc}_{r}
\text{acc}_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
{D_{f}}
sec
sec
D_{f}
D_{tf}
D_{r}
D_{tr}
\alpha
\alpha
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{f}
{D_{tr}}
{D_{tf}}
{D_{f}}
{D_{f}}
{D_{f}}
{D_{f}}
{D_{tr}}
{D_{tf}}
\alpha
{D_{tr}}
{D_{tf}}
\alpha
\alpha
D_{f}
D_{r}
{D_{tf}}
{D_{tr}}
\alpha
{D_{tf}}
\alpha
\alpha
\alpha
{D_{f}}
{D_{f}}
{D_{f}}
\mathcal{M}_{\theta}
\{(x_{1},y_{1}),...,(x_{N},y_{N})\}
\text{ACC}=100\cdot\cfrac{\sum^{N}_{i=1}\delta(\sigma(\mathcal{M}_{\theta}(x_{%
i})),y_{i})}{\text{N}},
\delta(\cdot,\cdot)
\text{US}_{r}=\text{exp}(\cfrac{\text{acc}_{r}}{100}),
\text{acc}_{r}
\text{US}_{f}=\text{exp}(1-\cfrac{\text{acc}_{f}}{100}),
\text{acc}_{f}
\text{US}_{r}
\text{US}_{f}
min-max
\alpha
\alpha
\alpha
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
T
T
D_{r}
D_{f}
D_{tr}
D_{tf}
x
T^{x}
x
T^{x}
x
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
\displaystyle\text{US}(\text{acc}_{r},\text{acc}_{f})=\cfrac{\cfrac{\text{US}_%
{r}+\text{US}_{f}}{2}-\text{exp}(0)}{\text{exp}(1)-\text{exp}(0)}
\displaystyle\text{US}(\text{acc}_{r},\text{acc}_{f})
\displaystyle=\cfrac{\cfrac{\text{US}_{r}+\text{US}_{f}}{2}-\text{exp}(0)}{%
\text{exp}(1)-\text{exp}(0)}
\displaystyle=\cfrac{\text{US}_{r}+\text{US}_{f}-2\cdot\exp(0)}{2\cdot(\exp(1)%
-\exp(0))}
\displaystyle=\cfrac{\text{US}_{r}+\text{US}_{f}-2\cdot\exp(0)}{2\cdot(\exp(1)%
-\exp(0))}
\displaystyle=\cfrac{\exp(\cfrac{\text{acc}_{r}}{100})+\exp(1-\cfrac{\text{acc%
}_{f}}{100})-2}{2\cdot(\exp(1)-1)}
\displaystyle=\cfrac{\exp(\cfrac{\text{acc}_{r}}{100})+\exp(1-\cfrac{\text{acc%
}_{f}}{100})-2}{2\cdot(\exp(1)-1)}
\alpha
\alpha
\mathcal{L}
\mathcal{L}_{CE}
\alpha
\mathcal{L}_{DI}
\alpha
T
T
T
D_{tr}
T^{x}
T
x
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tr}
D_{tf}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
D_{r}
D_{f}
D_{tr}
D_{tf}
