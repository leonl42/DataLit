\boldsymbol{x}\in\mathbb{R}^{D}
\boldsymbol{z}\in\mathbb{R}^{d}
p_{\boldsymbol{\theta}}(\boldsymbol{z},\boldsymbol{x}):=p_{\boldsymbol{\alpha}%
}(\boldsymbol{z})p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z}),~{}p_{%
\boldsymbol{\alpha}}(\boldsymbol{z}):=\frac{1}{Z_{{\boldsymbol{\alpha}}}}\exp%
\left(f_{\boldsymbol{\alpha}}(\boldsymbol{z})\right)p_{0}(\boldsymbol{z}),
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
{\boldsymbol{\alpha}}
p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z})
{\boldsymbol{\beta}}
{\boldsymbol{\theta}}=({\boldsymbol{\alpha}},{\boldsymbol{\beta}})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
Z_{\boldsymbol{\alpha}}
p_{0}(\boldsymbol{z})
p_{0}
p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z})=\mathcal{N}(g_{%
\boldsymbol{\beta}}(\boldsymbol{z}),\sigma^{2}\mathbf{I}_{D})
g_{\boldsymbol{\beta}}
\sigma^{2}
l_{2}
\boldsymbol{x}
{\boldsymbol{\alpha}},{\boldsymbol{\beta}}
\delta_{\boldsymbol{\alpha}}(\boldsymbol{x}):=\mathbb{E}_{p_{\boldsymbol{%
\theta}}(\boldsymbol{z}|\boldsymbol{x})}\left[\nabla_{\boldsymbol{\alpha}}f_{%
\boldsymbol{\alpha}}(\boldsymbol{z})\right]-\mathbb{E}_{p_{\boldsymbol{\alpha}%
}(\boldsymbol{z})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(%
\boldsymbol{z})\right],~{}\delta_{\boldsymbol{\beta}}(\boldsymbol{x}):=\mathbb%
{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})}\left[\nabla_{%
\boldsymbol{\beta}}\log p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z})%
\right].
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})
\pi(\boldsymbol{z})
\boldsymbol{z}_{t+1}=\boldsymbol{z}_{t}+\frac{s^{2}}{2}\nabla_{\boldsymbol{z}_%
{t}}\log\pi(\boldsymbol{z}_{t})+s\boldsymbol{w}_{t},~{}t=0,1,...,T-1,~{}%
\boldsymbol{w}_{t}\sim\mathcal{N}({\boldsymbol{0}},\mathbf{I}_{d}),
s
\boldsymbol{z}_{0}\sim\mathcal{N}({\boldsymbol{0}},\mathbf{I}_{d})
s
\boldsymbol{z}_{t}
\pi
t\to\infty
\pi(\boldsymbol{z})
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}
{\boldsymbol{\phi}}
\lambda_{s}=\log[\beta_{s}^{2}/\sigma_{s}^{2}]
s
\beta_{s}
\sigma_{s}^{2}
s
\boldsymbol{z}_{0}
\mathbb{R}^{d}
q(\boldsymbol{z}|\boldsymbol{z}_{0})
q(\boldsymbol{z}_{s}|\boldsymbol{z}_{0})=\mathcal{N}(\boldsymbol{z}_{s};\beta_%
{s}\boldsymbol{z}_{0},\sigma_{s}^{2}\mathbf{I}_{d}),\quad q(\boldsymbol{z}_{s}%
^{\prime}|\boldsymbol{z}_{s})=\mathcal{N}(\boldsymbol{z}_{s}^{\prime};(\beta_{%
s^{\prime}}/\beta_{s})\boldsymbol{z}_{s},\sigma_{s^{\prime}|s}^{2}\mathbf{I}_{%
d}),
0\leq s<s^{\prime}\leq S
\sigma^{2}_{s^{\prime}|s}=(1-e^{\lambda_{s^{\prime}}-\lambda_{s}})\sigma_{s}^{2}
q(\boldsymbol{z}_{s}|\boldsymbol{z}_{s^{\prime}},\boldsymbol{z}_{0})=\mathcal{%
N}(\boldsymbol{z}_{s};\tilde{\boldsymbol{\mu}}_{s|s^{\prime}}(\boldsymbol{z}_{%
s^{\prime}},\boldsymbol{z}_{0}),\tilde{\sigma}^{2}_{s|{s^{\prime}}}\mathbf{I}_%
{d})
q_{\boldsymbol{\phi}}(\boldsymbol{z}_{s}|\boldsymbol{z}_{s^{\prime}})
\boldsymbol{z}_{S}\sim\mathcal{N}({\boldsymbol{0}},\mathbf{I}_{d})
\displaystyle\tilde{\boldsymbol{\mu}}_{s|s^{\prime}}(\boldsymbol{z}_{s^{\prime%
}},\boldsymbol{z}_{0})=e^{\lambda_{s^{\prime}}-\lambda_{s}}(\alpha_{s}/\alpha_%
{s^{\prime}})\boldsymbol{z}_{s^{\prime}}+(1-e^{\lambda_{s^{\prime}}-\lambda_{s%
}})\alpha_{s}\boldsymbol{z}_{0},\quad\tilde{\sigma}^{2}_{s|s^{\prime}}=(1-e^{%
\lambda_{s^{\prime}}-\lambda_{s}})\sigma_{s}^{2},
\displaystyle\tilde{\boldsymbol{\mu}}_{s|s^{\prime}}(\boldsymbol{z}_{s^{\prime%
}},\boldsymbol{z}_{0})
\displaystyle=e^{\lambda_{s^{\prime}}-\lambda_{s}}(\alpha_{s}/\alpha_{s^{%
\prime}})\boldsymbol{z}_{s^{\prime}}+(1-e^{\lambda_{s^{\prime}}-\lambda_{s}})%
\alpha_{s}\boldsymbol{z}_{0},\quad\tilde{\sigma}^{2}_{s|s^{\prime}}=(1-e^{%
\lambda_{s^{\prime}}-\lambda_{s}})\sigma_{s}^{2},
\displaystyle\boldsymbol{z}_{s}=\tilde{\boldsymbol{\mu}}_{s|s^{\prime}}(%
\boldsymbol{z}_{s^{\prime}},\hat{\boldsymbol{z}}_{0})+\sqrt{(\tilde{\sigma}^{2%
}_{s|s^{\prime}})^{1-\gamma}(\sigma^{2}_{s^{\prime}|s})^{\gamma})}{\boldsymbol%
{\epsilon}},
\displaystyle\boldsymbol{z}_{s}
\displaystyle=\tilde{\boldsymbol{\mu}}_{s|s^{\prime}}(\boldsymbol{z}_{s^{%
\prime}},\hat{\boldsymbol{z}}_{0})+\sqrt{(\tilde{\sigma}^{2}_{s|s^{\prime}})^{%
1-\gamma}(\sigma^{2}_{s^{\prime}|s})^{\gamma})}{\boldsymbol{\epsilon}},
\boldsymbol{\epsilon}
\hat{\boldsymbol{z}}_{0}
\boldsymbol{z}_{0}
{\boldsymbol{\phi}}
\gamma
\boldsymbol{z}_{0}
\mathbb{E}_{{\boldsymbol{\epsilon}},\lambda}\left[\|{\boldsymbol{\epsilon}}(%
\boldsymbol{z}_{\lambda})-{\boldsymbol{\epsilon}}\|_{2}^{2}\right],
{\boldsymbol{\epsilon}}\sim\mathcal{N}({\boldsymbol{0}},\mathbf{I}_{d})
\lambda
p(\lambda)
s\in[0,S]
\boldsymbol{z}_{t}
\boldsymbol{z}_{t+1}
\boldsymbol{z}_{S}
\boldsymbol{z}_{s}
\boldsymbol{z}_{0}
\LARGE\cdots
\LARGE\cdots
\boldsymbol{x}
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{s}|\boldsymbol{z}_{S},\boldsymbol{%
x})
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{0}|\boldsymbol{z}_{s},\boldsymbol{%
x})
{\boldsymbol{\phi}}_{k}
\pi_{t+1}={\mathcal{K}}\pi_{t}
t=0,...,T-1
{\boldsymbol{\phi}}_{k+1}
k=0,...,K-1
{\boldsymbol{\phi}}_{k+1}
T
{\boldsymbol{\phi}}_{k}
{\boldsymbol{\phi}}_{k+1}
T
{\boldsymbol{\phi}}_{k}
\pi_{0}(\boldsymbol{z})
t
\pi_{t}(\boldsymbol{z})
\pi(\boldsymbol{z})
{\mathcal{K}}(\boldsymbol{z}|\boldsymbol{z}^{\prime})
\boldsymbol{z}_{0}
\pi_{0}(\boldsymbol{z})
\boldsymbol{z}_{t}
t
\boldsymbol{z}_{t-1}
\pi_{t}(\boldsymbol{z})={\mathcal{K}}\pi_{t-1}(\boldsymbol{z})
{\mathcal{K}}\pi_{t-1}(\boldsymbol{z}):=\int{\mathcal{K}}(\boldsymbol{z}|%
\boldsymbol{z}^{\prime})\pi_{t-1}(\boldsymbol{z}^{\prime})d\boldsymbol{z}^{\prime}
\pi_{t}={\mathcal{K}}_{t}\pi_{0}
{\mathcal{K}}_{t}
t
\pi
\pi(\boldsymbol{z}):=\int{\mathcal{K}}(\boldsymbol{z}|\boldsymbol{z}^{\prime})%
\pi(\boldsymbol{z}^{\prime})d\boldsymbol{z}^{\prime},\forall\boldsymbol{z}
{\mathcal{Q}}=\{q_{\boldsymbol{\phi}}\}
{\boldsymbol{\phi}}
\mathcal{K}
q_{{\boldsymbol{\phi}}^{*}}
\pi
T
q_{\boldsymbol{\phi}}
q_{{\boldsymbol{\phi}}_{k}}\leftarrow\operatorname*{arg\,min}_{q_{\boldsymbol{%
\phi}}\in{\mathcal{Q}}}{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k-1},T}||q_{%
\boldsymbol{\phi}}],~{}q_{{\boldsymbol{\phi}}_{k-1},T}:={\mathcal{K}}_{T}q_{{%
\boldsymbol{\phi}}_{k-1}},~{}q_{\boldsymbol{\phi}_{0}}\approx\pi_{0},~{}k=0,..%
.,K-1.
{\mathcal{D}}[\cdot||\cdot]
\pi
T
q_{{\boldsymbol{\phi}}_{k-1}}
{\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}
q_{{\boldsymbol{\phi}}_{k-1}}
q_{{\boldsymbol{\phi}}_{k}}
q_{\boldsymbol{\phi}}
\pi
{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k}}||\pi]\leq{\mathcal{D}}[q_{{%
\boldsymbol{\phi}}_{k-1}}||\pi]
{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k-1},T}||q_{\boldsymbol{\phi}}]
q_{{\boldsymbol{\phi}}_{k-1}}
q_{{\boldsymbol{\phi}}_{k}}
q_{{\boldsymbol{\phi}}_{k-1},T}
q_{T}
\displaystyle\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}{\mathcal{D}}[q_{%
T}||q_{\boldsymbol{\phi}}]=\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}-{%
\mathcal{H}}(q_{T})+{\mathcal{H}}(q_{T},q_{\boldsymbol{\phi}})=\operatorname*{%
arg\,min}_{q_{\boldsymbol{\phi}}}-\mathbb{E}_{q_{T}}\left[\log q_{\boldsymbol{%
\phi}}\right],
\displaystyle\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}{\mathcal{D}}[q_{%
T}||q_{\boldsymbol{\phi}}]
\displaystyle=\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}-{\mathcal{H}}(q%
_{T})+{\mathcal{H}}(q_{T},q_{\boldsymbol{\phi}})=\operatorname*{arg\,min}_{q_{%
\boldsymbol{\phi}}}-\mathbb{E}_{q_{T}}\left[\log q_{\boldsymbol{\phi}}\right],
{\mathcal{H}}
q_{\boldsymbol{\phi}}
q_{\boldsymbol{\phi}}
\{q_{T}\}
q_{\boldsymbol{\phi}}
q_{T}
{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k}}||\pi]\leq{\mathcal{D}}[q_{{%
\boldsymbol{\phi}}_{k-1}}||\pi]
\pi(\boldsymbol{z})
q_{\boldsymbol{\phi}}
q_{T}
q_{T}
{\boldsymbol{\epsilon}}
\log q_{\boldsymbol{\phi}}
q_{\boldsymbol{\phi}}
\displaystyle{\boldsymbol{\phi}}_{k-1}^{(i+1)}\leftarrow{\boldsymbol{\phi}}_{k%
-1}^{(i)}-\eta\nabla_{\boldsymbol{\phi}}\mathbb{E}_{{\boldsymbol{\epsilon}},%
\lambda}\left[\|{\boldsymbol{\epsilon}}(\boldsymbol{z}_{\lambda})-{\boldsymbol%
{\epsilon}}\|_{2}^{2}\right],~{}{\boldsymbol{\phi}}_{k}^{(0)}\leftarrow{%
\boldsymbol{\phi}}_{k-1}^{(M)},~{}i=0,1,...,M-1
\displaystyle{\boldsymbol{\phi}}_{k-1}^{(i+1)}\leftarrow{\boldsymbol{\phi}}_{k%
-1}^{(i)}-\eta\nabla_{\boldsymbol{\phi}}\mathbb{E}_{{\boldsymbol{\epsilon}},%
\lambda}\left[\|{\boldsymbol{\epsilon}}(\boldsymbol{z}_{\lambda})-{\boldsymbol%
{\epsilon}}\|_{2}^{2}\right],~{}{\boldsymbol{\phi}}_{k}^{(0)}\leftarrow{%
\boldsymbol{\phi}}_{k-1}^{(M)},~{}i=0,1,...,M-1
{\boldsymbol{\epsilon}}\sim\mathcal{N}(0,\mathbf{I}_{d})
\lambda
p(\lambda)
\eta
M
q_{\boldsymbol{\phi}}
M
N
\{\boldsymbol{x}_{i}\}_{i=1}^{N}
p_{\text{data}}(\boldsymbol{x})
p_{\boldsymbol{\theta}}
{\mathcal{L}}({\boldsymbol{\theta}})=\frac{1}{N}\sum_{i=1}^{N}\log p_{%
\boldsymbol{\theta}}\left(\boldsymbol{x}_{i}\right)
{\mathcal{L}}({\boldsymbol{\theta}})
\boldsymbol{x}_{i}
\displaystyle\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(%
\boldsymbol{x}_{i})=\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}_{i}|%
\boldsymbol{x}_{i})}\left[\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{%
\theta}}(\boldsymbol{z}_{i},\boldsymbol{x}_{i})\right]
\displaystyle\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(%
\boldsymbol{x}_{i})
\displaystyle=\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}_{i}|%
\boldsymbol{x}_{i})}\left[\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{%
\theta}}(\boldsymbol{z}_{i},\boldsymbol{x}_{i})\right]
\displaystyle=(\underbrace{\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}_%
{i}|\boldsymbol{x}_{i})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{%
\alpha}}(\boldsymbol{z}_{i})\right]-\mathbb{E}_{p_{\boldsymbol{\alpha}}(%
\boldsymbol{z}_{i})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(%
\boldsymbol{z}_{i})\right]}_{\delta_{\boldsymbol{\alpha}}(\boldsymbol{x}_{i})}%
,\underbrace{\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}_{i}|%
\boldsymbol{x}_{i})}\left[\nabla_{\boldsymbol{\beta}}\log p_{\boldsymbol{\beta%
}}(\boldsymbol{x}_{i}|\boldsymbol{z}_{i})\right]}_{\delta_{\boldsymbol{\beta}}%
(\boldsymbol{x}_{i})}).
\displaystyle=(\underbrace{\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}_%
{i}|\boldsymbol{x}_{i})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{%
\alpha}}(\boldsymbol{z}_{i})\right]-\mathbb{E}_{p_{\boldsymbol{\alpha}}(%
\boldsymbol{z}_{i})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(%
\boldsymbol{z}_{i})\right]}_{\delta_{\boldsymbol{\alpha}}(\boldsymbol{x}_{i})}%
,\underbrace{\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}_{i}|%
\boldsymbol{x}_{i})}\left[\nabla_{\boldsymbol{\beta}}\log p_{\boldsymbol{\beta%
}}(\boldsymbol{x}_{i}|\boldsymbol{z}_{i})\right]}_{\delta_{\boldsymbol{\beta}}%
(\boldsymbol{x}_{i})}).
\left[\boldsymbol{z}_{i}|\boldsymbol{x}_{i}\right]\sim{\mathcal{K}}_{T,%
\boldsymbol{z}_{i}|\boldsymbol{x}_{i}}q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{%
z}_{i}|\boldsymbol{x}_{i}),~{}\boldsymbol{z}_{i}\sim{\mathcal{K}}_{T,%
\boldsymbol{z}_{i}}q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i}),
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i})
{\boldsymbol{\phi}}_{k}
{\mathcal{K}}_{T,\boldsymbol{z}_{i}|\boldsymbol{x}_{i}}
{\mathcal{K}}_{T,\boldsymbol{z}_{i}}
q_{{\boldsymbol{\phi}}_{k}}
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})
T
q_{{\boldsymbol{\phi}}_{k}}
p_{\boldsymbol{\theta}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
p_{\boldsymbol{\alpha}}(\boldsymbol{z}_{i})
{\boldsymbol{\theta}}=({\boldsymbol{\alpha}},{\boldsymbol{\beta}})
q_{{\boldsymbol{\phi}}_{k}}
q_{{\boldsymbol{\phi}}_{k+1}}
p_{\boldsymbol{\theta}}
q_{\boldsymbol{\phi}}
q_{\boldsymbol{\phi}}(\boldsymbol{z}_{i})
\mathcal{N}(0,\mathbf{I}_{d})
{\mathcal{K}}_{T,\boldsymbol{z}_{i}|\boldsymbol{x}_{i}}q_{{\boldsymbol{\phi}}_%
{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
({\boldsymbol{\alpha}},{\boldsymbol{\beta}},{\boldsymbol{\phi}})
\eta=(\eta_{\boldsymbol{\alpha}},\eta_{\boldsymbol{\beta}},\eta_{\boldsymbol{%
\phi}})
\{\boldsymbol{x}^{(i)}\}_{i=1}^{N}
p_{\rm uncond}
\left({\boldsymbol{\theta}}^{(K)}=\{{\boldsymbol{\alpha}}^{(K)},{\boldsymbol{%
\beta}}^{(K)}\},{\boldsymbol{\phi}}^{(K)}\right)
k=0:K-1
\{\boldsymbol{x}^{(i)}\}_{i=1}^{B}
\boldsymbol{x}^{(i)}
\boldsymbol{z}_{+}^{(i)}
\boldsymbol{z}_{-}^{(i)}
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
\boldsymbol{x}^{(i)}
\boldsymbol{z}_{-}^{(i)}
\pi(\boldsymbol{z}_{i})=p_{{\boldsymbol{\alpha}}^{(k)}}(\boldsymbol{z}_{i})
\boldsymbol{x}^{(i)}
\boldsymbol{z}_{+}^{(i)}
\pi(\boldsymbol{z}_{i})=p_{{\boldsymbol{\beta}}^{(k)}}(\boldsymbol{z}_{i}|%
\boldsymbol{x}_{i})
{\boldsymbol{\theta}}^{(k)}
{\boldsymbol{\alpha}}^{(k)}
{\boldsymbol{\beta}}^{(k)}
\{\boldsymbol{z}_{+}^{(i)}\}_{i=1}^{B}
\{\boldsymbol{z}_{-}^{(i)}\}_{i=1}^{B}
{\boldsymbol{\phi}}^{(k)}
{\boldsymbol{\phi}}^{(k)}
p_{\rm uncond}
\{\boldsymbol{z}_{+}^{(i)}\}_{i=1}^{B}
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i})
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
\boldsymbol{x}_{i}
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i})
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i})
\emptyset
\boldsymbol{\epsilon}
p_{\rm uncond}=0.2
q_{{\boldsymbol{\phi}}_{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
100
M=6
T=30
T=60
s=0.1
{\mathcal{K}}_{T,\boldsymbol{z}_{i}|\boldsymbol{x}_{i}}q_{{\boldsymbol{\phi}}_%
{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
T=10
\downarrow
\downarrow
4
\downarrow
\downarrow
4
{\rm CE}^{*}
256\times 256
\downarrow
\downarrow
\downarrow
\downarrow
100
10\%
64
0.3s
100
0.2s
1.0s
8.0s
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
200
2500
60
200
2500
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
p_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{z}|\boldsymbol{x})
\boldsymbol{x}
p_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{z}|\boldsymbol{x})%
\propto p_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{x},%
\boldsymbol{z})\approx p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z})p_%
{\boldsymbol{\alpha}}(\boldsymbol{z})|_{\boldsymbol{z}\sim{\mathcal{K}}_{T,%
\boldsymbol{z}|\boldsymbol{x}}q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol%
{x})}
{\mathcal{K}}_{T,\boldsymbol{z}|\boldsymbol{x}}q_{\boldsymbol{\phi}}(%
\boldsymbol{z}|\boldsymbol{x})
\uparrow
\uparrow
0.095\pm 0.03
0.138\pm 0.04
0.147\pm 0.03
0.138\pm 0.02
0.102\pm 0.03
0.281\pm 0.04
0.401\pm 0.06
0.402\pm 0.06
0.290\pm 0.04
0.342\pm 0.03
\sigma
0.287\pm 0.02
0.443\pm 0.03
0.514\pm 0.03
0.347\pm 0.02
0.307\pm 0.03
0.336\pm 0.01
0.630\pm 0.02
0.619\pm 0.01
0.463\pm 0.01
0.413\pm 0.01
0.531\pm 0.02
0.729\pm 0.02
0.742\pm 0.01
0.620\pm 0.02
0.499\pm 0.01
\textbf{0.684}\pm\textbf{0.02}
\textbf{0.911}\pm\textbf{0.01}
\textbf{0.939}\pm\textbf{0.02}
\textbf{0.801}\pm\textbf{0.01}
\textbf{0.705}\pm\textbf{0.01}
\mathcal{N}(0,\mathbf{I}_{d})
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}
{\boldsymbol{\epsilon}}
q_{\boldsymbol{\phi}}
{\mathcal{D}}[{\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}||q_{\boldsymbol{%
\phi}}]
{\mathcal{K}}_{T}
T
q_{{\boldsymbol{\phi}}_{k-1}}
s
T
{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k}}||\pi]\leq{\mathcal{D}}[q_{{%
\boldsymbol{\phi}}_{k-1}}||\pi]
\pi
{\mathcal{D}}[\pi_{t+T}||\pi]\leq{\mathcal{D}}[\pi_{t}||\pi]
\pi_{t}
\pi_{t+T}
\boldsymbol{z}
t
(t+T)
\displaystyle{\mathcal{D}}[\pi_{t}||\pi]=\mathbb{E}_{\pi_{t}(\boldsymbol{z}_{t%
})}\left[\log\frac{\pi_{t}(\boldsymbol{z}_{t})}{\pi(\boldsymbol{z}_{t})}\right%
]=\mathbb{E}_{\pi_{t}(\boldsymbol{z}_{t}),{\mathcal{K}}(\boldsymbol{z}_{t+1}|z%
_{t})}\left[\log\frac{\pi_{t}(\boldsymbol{z}_{t}){\mathcal{K}}(\boldsymbol{z}_%
{t+1}|z_{t})}{\pi(\boldsymbol{z}_{t}){\mathcal{K}}(\boldsymbol{z}_{t+1}|z_{t})%
}\right]
\displaystyle{\mathcal{D}}[\pi_{t}||\pi]
\displaystyle=\mathbb{E}_{\pi_{t}(\boldsymbol{z}_{t})}\left[\log\frac{\pi_{t}(%
\boldsymbol{z}_{t})}{\pi(\boldsymbol{z}_{t})}\right]=\mathbb{E}_{\pi_{t}(%
\boldsymbol{z}_{t}),{\mathcal{K}}(\boldsymbol{z}_{t+1}|z_{t})}\left[\log\frac{%
\pi_{t}(\boldsymbol{z}_{t}){\mathcal{K}}(\boldsymbol{z}_{t+1}|z_{t})}{\pi(%
\boldsymbol{z}_{t}){\mathcal{K}}(\boldsymbol{z}_{t+1}|z_{t})}\right]
\displaystyle\stackrel{{\scriptstyle(i)}}{{=}}\mathbb{E}_{\pi_{t+1}(%
\boldsymbol{z}_{t+1}),{\mathcal{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|z_%
{t+1})}\left[\log\frac{{\mathcal{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|z%
_{t+1})\pi_{t+1}(\boldsymbol{z}_{t+1})}{{\mathcal{K}^{\prime}}_{\pi}(%
\boldsymbol{z}_{t}|z_{t+1})\pi(\boldsymbol{z}_{t+1})}\right]
\displaystyle\stackrel{{\scriptstyle(i)}}{{=}}\mathbb{E}_{\pi_{t+1}(%
\boldsymbol{z}_{t+1}),{\mathcal{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|z_%
{t+1})}\left[\log\frac{{\mathcal{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|z%
_{t+1})\pi_{t+1}(\boldsymbol{z}_{t+1})}{{\mathcal{K}^{\prime}}_{\pi}(%
\boldsymbol{z}_{t}|z_{t+1})\pi(\boldsymbol{z}_{t+1})}\right]
\displaystyle={\mathcal{D}}[\pi_{t+1}||\pi]+\mathbb{E}_{\pi_{t+1}(\boldsymbol{%
z}_{t+1})}{\mathcal{D}}[{\mathcal{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|%
z_{t+1})||{\mathcal{K}^{\prime}}_{\pi}(\boldsymbol{z}_{t}|z_{t+1})]
\displaystyle={\mathcal{D}}[\pi_{t+1}||\pi]+\mathbb{E}_{\pi_{t+1}(\boldsymbol{%
z}_{t+1})}{\mathcal{D}}[{\mathcal{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|%
z_{t+1})||{\mathcal{K}^{\prime}}_{\pi}(\boldsymbol{z}_{t}|z_{t+1})]
\displaystyle\stackrel{{\scriptstyle(ii)}}{{\geq}}{\mathcal{D}}[\pi_{t+1}||\pi],
\displaystyle\stackrel{{\scriptstyle(ii)}}{{\geq}}{\mathcal{D}}[\pi_{t+1}||\pi],
\mathcal{K}
\mathcal{K}^{\prime}
[\boldsymbol{z}_{t},\boldsymbol{z}_{t+1}]
\pi_{t}(\boldsymbol{z}_{t}){\mathcal{K}}(\boldsymbol{z}_{t+1}|z_{t})={\mathcal%
{K}^{\prime}}_{\pi_{t+1}}(\boldsymbol{z}_{t}|z_{t+1})\pi_{t+1}(\boldsymbol{z}_%
{t+1})
\pi(\boldsymbol{z}_{t}){\mathcal{K}}(\boldsymbol{z}_{t+1}|z_{t})={\mathcal{K}^%
{\prime}}_{\pi}(\boldsymbol{z}_{t}|z_{t+1})\pi(\boldsymbol{z}_{t+1})
{\mathcal{D}}[\pi_{t+T}||\pi]\leq{\mathcal{D}}[\pi_{t}||\pi]
\pi_{t}\to\pi
t\to\infty
q_{\boldsymbol{\phi}}
q_{{\boldsymbol{\phi}}_{k}}\leftarrow\operatorname*{arg\,min}_{q_{\boldsymbol{%
\phi}}\in{\mathcal{Q}}}{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k-1},T}||q_{%
\boldsymbol{\phi}}],~{}q_{{\boldsymbol{\phi}}_{k-1},T}:={\mathcal{K}}_{T}q_{{%
\boldsymbol{\phi}}_{k-1}},~{}q_{\boldsymbol{\phi}_{0}}\approx\pi_{0},~{}k=0,..%
.,K-1.
\{q_{\boldsymbol{\phi}}\}
q_{{\boldsymbol{\phi}}_{k-1},T}
q_{\boldsymbol{\phi}_{0}}\approx\pi_{0}
q_{{\boldsymbol{\phi}}_{k}}\approx{\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}
{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k}}||\pi]\leq{\mathcal{D}}[q_{{%
\boldsymbol{\phi}}_{k-1}}||\pi]
k=1,...,K
{\mathcal{D}}[q_{{\boldsymbol{\phi}}_{k-1},T}||q_{\boldsymbol{\phi}}]
q_{{\boldsymbol{\phi}}_{k-1}}
q_{{\boldsymbol{\phi}}_{k}}
q_{{\boldsymbol{\phi}}_{k}}
q_{T}:={\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}
\{q_{T}\}
\displaystyle\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}{\mathcal{D}}[q_{%
T}||q_{\boldsymbol{\phi}}]=\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}-{%
\mathcal{H}}(q_{T})+{\mathcal{H}}(q_{T},q_{\boldsymbol{\phi}})=\operatorname*{%
arg\,min}_{q_{\boldsymbol{\phi}}}-\mathbb{E}_{q_{T}}\left[\log q_{\boldsymbol{%
\phi}}\right]
\displaystyle\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}{\mathcal{D}}[q_{%
T}||q_{\boldsymbol{\phi}}]
\displaystyle=\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}-{\mathcal{H}}(q%
_{T})+{\mathcal{H}}(q_{T},q_{\boldsymbol{\phi}})=\operatorname*{arg\,min}_{q_{%
\boldsymbol{\phi}}}-\mathbb{E}_{q_{T}}\left[\log q_{\boldsymbol{\phi}}\right]
\displaystyle\leq\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}\mathbb{E}_{{%
\boldsymbol{\epsilon}},\lambda}\left[\|{\boldsymbol{\epsilon}}_{\boldsymbol{%
\phi}}(\boldsymbol{z}_{\lambda})-{\boldsymbol{\epsilon}}\|_{2}^{2}\right]%
\approx\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}\frac{1}{N}\sum_{j=1}^{%
N}\left[\|{\boldsymbol{\epsilon}}_{\boldsymbol{\phi}}(\boldsymbol{z}_{j,%
\lambda_{j}})-{\boldsymbol{\epsilon}}_{j}\|_{2}^{2}\right],
\displaystyle\leq\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}\mathbb{E}_{{%
\boldsymbol{\epsilon}},\lambda}\left[\|{\boldsymbol{\epsilon}}_{\boldsymbol{%
\phi}}(\boldsymbol{z}_{\lambda})-{\boldsymbol{\epsilon}}\|_{2}^{2}\right]%
\approx\operatorname*{arg\,min}_{q_{\boldsymbol{\phi}}}\frac{1}{N}\sum_{j=1}^{%
N}\left[\|{\boldsymbol{\epsilon}}_{\boldsymbol{\phi}}(\boldsymbol{z}_{j,%
\lambda_{j}})-{\boldsymbol{\epsilon}}_{j}\|_{2}^{2}\right],
\boldsymbol{z}_{\lambda}
q(\boldsymbol{z}_{\lambda}|\boldsymbol{z}_{0})=\mathcal{N}(\boldsymbol{z}_{%
\lambda};\beta_{\lambda}\boldsymbol{z}_{0},\sigma_{\lambda}^{2}\mathbf{I}_{d})
\boldsymbol{z}_{0}\sim q_{T}
{\boldsymbol{\epsilon}}\sim\mathcal{N}({\boldsymbol{0}},\mathbf{I}_{d})
\lambda
p(\lambda)
q_{\boldsymbol{\phi}}
\displaystyle{\boldsymbol{\phi}}_{k-1}^{(i+1)}\leftarrow{\boldsymbol{\phi}}_{k%
-1}^{(i)}-\eta\nabla_{\boldsymbol{\phi}}\frac{1}{N}\sum_{j=1}^{N}\left[\|{%
\boldsymbol{\epsilon}}_{\boldsymbol{\phi}}(\boldsymbol{z}_{j,\lambda_{j}}){%
\boldsymbol{\epsilon}}_{j}\|_{2}^{2}\right],~{}{\boldsymbol{\phi}}_{k}^{(0)}%
\leftarrow{\boldsymbol{\phi}}_{k-1}^{(M)},~{}i=0,1,...,M-1.
\displaystyle{\boldsymbol{\phi}}_{k-1}^{(i+1)}\leftarrow{\boldsymbol{\phi}}_{k%
-1}^{(i)}-\eta\nabla_{\boldsymbol{\phi}}\frac{1}{N}\sum_{j=1}^{N}\left[\|{%
\boldsymbol{\epsilon}}_{\boldsymbol{\phi}}(\boldsymbol{z}_{j,\lambda_{j}}){%
\boldsymbol{\epsilon}}_{j}\|_{2}^{2}\right],~{}{\boldsymbol{\phi}}_{k}^{(0)}%
\leftarrow{\boldsymbol{\phi}}_{k-1}^{(M)},~{}i=0,1,...,M-1.
{\boldsymbol{\phi}}
q_{T}={\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}
{\boldsymbol{\phi}}_{k}=\left({\boldsymbol{\phi}}_{k-1},\tilde{\boldsymbol{%
\phi}}\right)
\tilde{\boldsymbol{\phi}}
{\mathcal{K}}_{T}
q_{\boldsymbol{\phi}}
q_{{\boldsymbol{\phi}}_{k-1}}
{\mathcal{L}}(\tilde{\boldsymbol{\phi}})=\frac{1}{N}\sum_{j=1}^{N}\log p_{%
\tilde{\boldsymbol{\phi}}}(\hat{\boldsymbol{z}}_{j}|\boldsymbol{z}_{j})
\{\boldsymbol{z}_{j}\}
q_{{\boldsymbol{\phi}}_{k-1}}
\{\hat{\boldsymbol{z}}_{j}\}
{\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}
\tilde{\boldsymbol{\phi}}
\tilde{\boldsymbol{\phi}}^{*}
\sqrt{N}\left(\tilde{\boldsymbol{\phi}}-\tilde{\boldsymbol{\phi}}^{*}\right)%
\to\mathcal{N}\left(0,{\mathcal{I}}\left(\tilde{\boldsymbol{\phi}}^{*}\right)^%
{-1}\right),
{\mathcal{I}}\left(\tilde{\boldsymbol{\phi}}^{*}\right)=\mathbb{E}_{\hat{%
\boldsymbol{z}},\boldsymbol{z}}\left[-\nabla^{2}\log p_{\tilde{\boldsymbol{%
\phi}}}(\hat{\boldsymbol{z}}|\boldsymbol{z})\right]
N
\tilde{\boldsymbol{\phi}}
\tilde{\boldsymbol{\phi}}
{\mathcal{K}}_{T}q_{{\boldsymbol{\phi}}_{k-1}}
q_{{\boldsymbol{\phi}}_{k-1}}
T=30
M=6
{\boldsymbol{\theta}}
\displaystyle\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(%
\boldsymbol{x})=\frac{1}{p_{\boldsymbol{\theta}}(\boldsymbol{x})}\nabla_{%
\boldsymbol{\theta}}\int_{\boldsymbol{z}}p_{\boldsymbol{\theta}}(\boldsymbol{x%
},\boldsymbol{z})d\boldsymbol{z}=\int_{\boldsymbol{z}}\frac{p_{\boldsymbol{%
\theta}}(\boldsymbol{x},\boldsymbol{z})}{p_{\boldsymbol{\theta}}(\boldsymbol{x%
})}\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(\boldsymbol{x},%
\boldsymbol{z})d\boldsymbol{z}
\displaystyle\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(%
\boldsymbol{x})
\displaystyle=\frac{1}{p_{\boldsymbol{\theta}}(\boldsymbol{x})}\nabla_{%
\boldsymbol{\theta}}\int_{\boldsymbol{z}}p_{\boldsymbol{\theta}}(\boldsymbol{x%
},\boldsymbol{z})d\boldsymbol{z}=\int_{\boldsymbol{z}}\frac{p_{\boldsymbol{%
\theta}}(\boldsymbol{x},\boldsymbol{z})}{p_{\boldsymbol{\theta}}(\boldsymbol{x%
})}\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(\boldsymbol{x},%
\boldsymbol{z})d\boldsymbol{z}
\displaystyle=\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x%
})}\left[\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(\boldsymbol{%
z},\boldsymbol{x})\right]
\displaystyle=\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x%
})}\left[\nabla_{\boldsymbol{\theta}}\log p_{\boldsymbol{\theta}}(\boldsymbol{%
z},\boldsymbol{x})\right]
\displaystyle=(\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{%
x})}\left[\nabla_{\boldsymbol{\alpha}}\log p_{\boldsymbol{\alpha}}(\boldsymbol%
{z})\right],\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})%
}\left[\nabla_{\boldsymbol{\beta}}\log p_{\boldsymbol{\beta}}(\boldsymbol{x}|%
\boldsymbol{z})\right])
\displaystyle=(\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{%
x})}\left[\nabla_{\boldsymbol{\alpha}}\log p_{\boldsymbol{\alpha}}(\boldsymbol%
{z})\right],\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})%
}\left[\nabla_{\boldsymbol{\beta}}\log p_{\boldsymbol{\beta}}(\boldsymbol{x}|%
\boldsymbol{z})\right])
\displaystyle=(\underbrace{\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|%
\boldsymbol{x})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(%
\boldsymbol{z})\right]-\mathbb{E}_{p_{\boldsymbol{\alpha}}(\boldsymbol{z})}%
\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(\boldsymbol{z})%
\right]}_{\delta_{\boldsymbol{\alpha}}(\boldsymbol{x})},\underbrace{\mathbb{E}%
_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})}\left[\nabla_{%
\boldsymbol{\beta}}\log p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z})%
\right]}_{\delta_{\boldsymbol{\beta}}(\boldsymbol{x})}).
\displaystyle=(\underbrace{\mathbb{E}_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|%
\boldsymbol{x})}\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(%
\boldsymbol{z})\right]-\mathbb{E}_{p_{\boldsymbol{\alpha}}(\boldsymbol{z})}%
\left[\nabla_{\boldsymbol{\alpha}}f_{\boldsymbol{\alpha}}(\boldsymbol{z})%
\right]}_{\delta_{\boldsymbol{\alpha}}(\boldsymbol{x})},\underbrace{\mathbb{E}%
_{p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})}\left[\nabla_{%
\boldsymbol{\beta}}\log p_{\boldsymbol{\beta}}(\boldsymbol{x}|\boldsymbol{z})%
\right]}_{\delta_{\boldsymbol{\beta}}(\boldsymbol{x})}).
{\boldsymbol{\theta}}
{\boldsymbol{\theta}}
\displaystyle\boldsymbol{z}_{t+1}=\boldsymbol{z}_{t}+\frac{s^{2}}{2}\nabla_{%
\boldsymbol{z}_{t}}\underbrace{\left(f_{\boldsymbol{\alpha}}(\boldsymbol{z}_{t%
})-\frac{1}{2}\|\boldsymbol{z}_{t}\|_{2}^{2}\right)}_{\log p_{\boldsymbol{%
\alpha}}(\boldsymbol{z}_{t})}+s\boldsymbol{w}_{t},
\displaystyle\boldsymbol{z}_{t+1}
\displaystyle=\boldsymbol{z}_{t}+\frac{s^{2}}{2}\nabla_{\boldsymbol{z}_{t}}%
\underbrace{\left(f_{\boldsymbol{\alpha}}(\boldsymbol{z}_{t})-\frac{1}{2}\|%
\boldsymbol{z}_{t}\|_{2}^{2}\right)}_{\log p_{\boldsymbol{\alpha}}(\boldsymbol%
{z}_{t})}+s\boldsymbol{w}_{t},
\displaystyle\boldsymbol{z}_{t+1}=\boldsymbol{z}_{t}+\frac{s^{2}}{2}\nabla_{%
\boldsymbol{z}_{t}}\underbrace{\left(-\frac{\|\boldsymbol{x}-g_{\boldsymbol{%
\beta}}(\boldsymbol{z}_{t})\|_{2}^{2}}{2\sigma^{2}}+f_{\boldsymbol{\alpha}}(%
\boldsymbol{z}_{t})-\frac{1}{2}\|\boldsymbol{z}_{t}\|_{2}^{2}\right)}_{\log p_%
{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})=\log p_{\boldsymbol{%
\theta}}(\boldsymbol{x},\boldsymbol{z})+C}+s\boldsymbol{w}_{t},
\displaystyle\boldsymbol{z}_{t+1}
\displaystyle=\boldsymbol{z}_{t}+\frac{s^{2}}{2}\nabla_{\boldsymbol{z}_{t}}%
\underbrace{\left(-\frac{\|\boldsymbol{x}-g_{\boldsymbol{\beta}}(\boldsymbol{z%
}_{t})\|_{2}^{2}}{2\sigma^{2}}+f_{\boldsymbol{\alpha}}(\boldsymbol{z}_{t})-%
\frac{1}{2}\|\boldsymbol{z}_{t}\|_{2}^{2}\right)}_{\log p_{\boldsymbol{\theta}%
}(\boldsymbol{z}|\boldsymbol{x})=\log p_{\boldsymbol{\theta}}(\boldsymbol{x},%
\boldsymbol{z})+C}+s\boldsymbol{w}_{t},
t=0,1,...,T
\boldsymbol{z}_{0}\sim q_{{\boldsymbol{\phi}}}(\boldsymbol{z}|\boldsymbol{x})
\boldsymbol{z}_{0}\sim q_{{\boldsymbol{\phi}}}(\boldsymbol{z})
\boldsymbol{w}_{t}\sim\mathcal{N}({\boldsymbol{0}},\mathbf{I}_{d})
p_{\boldsymbol{\theta}}(\boldsymbol{x},\boldsymbol{z})
\boldsymbol{x}
p_{\boldsymbol{\theta}}(\boldsymbol{z}|\boldsymbol{x})\propto p_{\boldsymbol{%
\theta}}(\boldsymbol{x},\boldsymbol{z})=p_{\boldsymbol{\beta}}(\boldsymbol{x}|%
\boldsymbol{z})p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}
\boldsymbol{z}
\in\{8,100,128,7168\}
\in\{200,512\}
\in\{200,512\}
n
n
n
n
\boldsymbol{z}
8
4
2
\boldsymbol{z}
8
4
2
1
\boldsymbol{z}
8
4
2
\boldsymbol{z}
16
8
4
4
2
1
\boldsymbol{z}
8
4
2
\boldsymbol{z}
\boldsymbol{z}
\boldsymbol{z}
\boldsymbol{z}
t
1
128
128
128
\boldsymbol{z}
\boldsymbol{z},\boldsymbol{z}_{\text{ctx}},\boldsymbol{z}_{t}
\boldsymbol{z}
\boldsymbol{z}
\boldsymbol{z}
\boldsymbol{z}
\boldsymbol{z},\boldsymbol{z}_{\text{ctx}},t
n
n
n
n
\boldsymbol{x}
1
2
4
8
\boldsymbol{x}
1
2
4
8
8
\boldsymbol{x}
1
2
4
8
\boldsymbol{x}
1
2
4
4
8
8
8
\boldsymbol{x}
1
2
4
8
100
M=6
T=30
T=60
s=0.1
{\mathcal{K}}_{T,\boldsymbol{z}_{i}|\boldsymbol{x}_{i}}q_{{\boldsymbol{\phi}}_%
{k}}(\boldsymbol{z}_{i}|\boldsymbol{x}_{i})
T=10
T=100
100
\beta_{1}=0.5
\beta_{2}=0.999
\beta_{1}=0.5
\beta_{2}=0.999
0.99
128
[-1,1]
l_{2}
l_{2}
1,000
3,000
\mathcal{N}(0,\mathbf{I}_{d})
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
\mathcal{N}(0,\mathbf{I}_{d})
p_{\boldsymbol{\alpha}}(\boldsymbol{z})
f_{\boldsymbol{\alpha}}(\boldsymbol{z})
60
q_{\boldsymbol{\phi}}
q_{\boldsymbol{\phi}}
10\%
64
0.3s
100
0.2s
1.0s
8.0s
