G
V
E
X\in\mathbb{R}^{|V|\times d}
|V|
d
A\in\mathcal{R^{+}}^{|V|\times|V|}
a_{i,j}
v_{i}
v_{j}
G=(V,E)=(X,A)
x_{i}^{\prime}=\gamma(h_{i},x_{i});
h_{i}=\oplus(\{m_{ij}|j\in\mathcal{N}(i)\});
m_{ij}=\phi(x_{i},x_{j},e_{ij})
\gamma
\phi
\oplus
x_{i}^{\prime}
h_{i}
m_{ij}
e_{ij}
i
j
Pool(\cdot)
G^{\prime}
G
G^{\prime}=Pool(G)=(V^{\prime},E^{\prime})=(X^{\prime},A^{\prime})
V^{\prime}
E^{\prime}
X^{\prime}
A^{\prime}
|V^{\prime}|=1
S=\{S_{1},\ldots,S_{K}\}
S_{j}={\{s_{i}^{j}|i\in[1,N]\}}
j
X^{\prime}=RED(S,G)
A^{\prime}=CON(S,G)
g(\cdot)
k
h=g(X,A)
\hat{i}=topk(h)
X^{\prime}=(X\odot h)(\hat{i},:)
A^{\prime}=A(\hat{i},\hat{i})
topk(\cdot)
\hat{i}
k
(\hat{i},:)
\hat{i}
(\hat{i},\hat{i})
\hat{i}
\hat{i}
S
G
f(\cdot)
G^{\prime}
S=f(X,A)
X^{\prime}=S^{T}X
A^{\prime}=S^{T}AS
g(\cdot)
f(\cdot)
S
A^{\prime}
G=(X,A)
S
f(\cdot)
g(\cdot)
f(\cdot)
G^{\prime}=(X^{\prime},A^{\prime})
S\in\mathcal{R}^{|V|\times|V|}
f(\cdot)
A^{*}=I_{N}+A
s_{ij}
i
j
a_{ij}
S
S
A
S=f(X,A)
X^{*}=S^{T}X
h=g(X^{*},A)
\hat{i}=topk(h)
X^{\prime}=(X^{*}\odot h)(\hat{i},:)
S^{\prime}=S(:,\hat{i})
A^{\prime}={S^{\prime}}^{T}AS^{\prime}
(:,i)
\hat{i}
(\hat{i},:)
g(\cdot)
h
h
g(\cdot)
A^{\prime}
s_{i,i}
S
f(\cdot)
g(\cdot)
f(\cdot)
f(\cdot)=I_{N}
f(\cdot)
f(\cdot)
S\in\mathcal{R}^{|V|\times|V|}
f(\cdot)
A^{*}=I_{N}+A
s_{ij}
i
j
a_{ij}
f(\cdot)
S
v(\cdot)
f(\cdot)
S
v(\cdot)
v(\cdot)
i
X^{*}=v(X,A)
h=g(X^{*},A)
\hat{i}=topk(h)
X^{\prime}=(X^{*}\odot h)(\hat{i},:)
A^{\prime}=ones(A+A^{T}A+A^{2}+A^{T}A^{2})(\hat{i},\hat{i})
ones(\cdot)
A
A^{\prime}=ones(A+A^{2}+A^{3})(\hat{i},\hat{i})
v(\cdot)
v(\cdot)
v(\cdot)
v(\cdot)
g(\cdot)
G
A
L=D-A
D
X
H^{*}=LX
h^{*}_{i,j}
H^{*}
h^{*}_{i,j}=x_{i,j}*d_{i}-\sum_{k\in\mathbf{N}(i)}x_{k,j}
d_{i}
i
\mathbf{N}(i)
i
\tilde{h^{*}_{i}}
i
\tilde{h^{*}_{i}}=\tilde{x_{i}}*d_{i}-\sum_{k\in\mathbf{N}(i)}\tilde{x_{k}}
\tilde{x_{i}}
i
N(i)
d_{i}
\tilde{h^{*}_{i}}=\sum_{k\in\mathbf{N}(i)}(\tilde{x_{i}}-\tilde{x_{k}})
L
X
H^{*}
\tilde{h^{*}_{i}}
i
\tilde{w}
g^{*}
i
g^{*}(\tilde{x_{i}})=(\sum_{k\in\mathbf{N}(i)}(\tilde{x_{i}}-\tilde{x_{k}}))%
\tilde{w}^{T}
g^{*}(\cdot)
g^{*}(\cdot)
x_{0}
x^{\prime}_{0}
x_{0}-x_{3}
x_{0}-x_{2}
g^{*}(\cdot)
x_{0}
x^{\prime}_{0}
x_{0}-x_{3}
x_{0}-x_{2}
(\tilde{x_{i}}-\tilde{x_{k}})
X\in\mathcal{R}^{N\times F_{1}}
L
X
L=XW^{T}+\tilde{b}
W\in\mathcal{R}^{F_{2}\times F_{1}}
\tilde{b}\in\mathcal{R}^{1\times F_{2}}
N
F_{1}
F_{2}
g
h_{i}
x_{i}
h_{i}=L_{s}(L_{f_{d}}(\sum_{k\in\mathbf{N}(i)}L_{d}(\tilde{x_{i}}-\tilde{x_{k}%
}))+L_{x}(\tilde{x_{i}}))
L_{s}
i
L_{d}
L_{f_{d}}
i
x_{i}
L_{x}
L_{s}
h_{i}
i
L
L
g(\cdot)=\text{LCSMP}(\cdot)
h=\text{LCSMP}(X,A)
\hat{i}=topk(h)
X^{\prime}=(X\odot h)(\hat{i},:)
A^{\prime}=ones(A+A^{2}+A^{3})(\hat{i},\hat{i})
(\cdot)
\text{LCSMP}(\tilde{x_{i}})=L_{s}(L_{f_{d}}(\sum_{k\in\mathbf{N}(i)}L_{d}(%
\tilde{x_{i}}-\tilde{x_{k}}))+L_{x}(\tilde{x_{i}}))
v(\cdot)
v(\cdot)
v(\cdot)
\text{readout}(X)=\text{concat}(\text{global\_mean}(X),\text{global\_max}(X))
(\cdot)
X
(\cdot)
X
(\cdot)
\text{GNN}_{h}
\text{GNN}_{h}^{c}
\text{GNN}_{p}
\text{GNN}_{p}^{c}
v(\cdot)=\text{(}GCN)(\cdot)
v(\cdot)
\text{GNN}_{h}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{lcpool}^{*}
\pm
\pm
\pm
\pm
\pm
\pm
\text{GNN}_{h}^{c}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{lcpool}^{*}
\pm
\pm
\pm
\pm
\pm
\pm
\text{GNN}_{p}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{lcpool}^{*}
\pm
\pm
\pm
\pm
\pm
\pm
\text{GNN}_{p}^{c}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{lcpool}^{*}
\pm
\pm
\pm
\pm
\pm
\pm
\text{GNN}_{h}
\text{GNN}_{h}^{c}
\text{GNN}_{p}
\text{GNN}_{p}^{c}
S
A
(\hat{i},:)
\hat{i}
(:,\hat{i})
\hat{i}
(\hat{i},\hat{i})
\hat{i}
\hat{i}
{S(:,\hat{i})}^{T}A(S(:,\hat{i}))=(S^{T}AS)(\hat{i},\hat{i})
A^{\prime}=(S^{T}AS)(\hat{i},\hat{i})
p
q
n
m
n
p
m
q
m
n
s^{t}_{p,n}
a_{n,m}
s_{m,q}
s^{t}
S^{T}
H=S^{T}AS
h_{p,q}
p
q
s_{i,i}
p
q
p
q
p
q
f(\cdot)=I_{N}
X^{*}=X
h=g(X^{*},A)=g(X,A)
\hat{i}=topk(h)
X^{\prime}=(X^{*}\odot h)(\hat{i},;)=(X\odot h)(\hat{i},;)
A^{\prime}={I_{N}(\hat{i},:)}^{T}A(I_{N}(:,\hat{i}))=(I_{N}^{T}AI_{N})(\hat{i}%
,\hat{i})=A(\hat{i},\hat{i})
S
I_{N}+A
A^{\prime}=ones(S^{\prime T}AS^{\prime})
A^{\prime}=ones(S^{\prime T}AS^{\prime})=ones({S(:,\hat{i})}^{T}A(S(:,\hat{i})%
))=ones((S^{T}AS)(\hat{i},\hat{i}))
S
I_{N}+A
A^{\prime}=ones((I_{N}+A)^{T}A(I_{N}+A)(\hat{i},\hat{i}))
A^{\prime}=ones((I_{N}^{T}AI_{N}+A^{T}AI_{N}+I_{N}^{T}AA+A^{T}AA)(\hat{i},\hat%
{i}))=ones((A+A^{T}A+A^{2}+A^{T}A^{2})(\hat{i},\hat{i}))
A^{\prime}=ones(A+A^{T}A+A^{2}+A^{T}A^{2})(\hat{i},\hat{i})
S
X^{*}
S=f(X,A)
X^{*}=S^{T}X
v(\cdot)
X^{*}=v(X,A)
v(\cdot)
A
A^{T}=A
A^{\prime}=ones(A+A^{T}A+A^{2}+A^{T}A^{2})(\hat{i},\hat{i})=ones(A+2*A^{2}+A^{%
3})(\hat{i},\hat{i})
ones(\cdot)
A^{\prime}=ones(A+2*A^{2}+A^{3})(\hat{i},\hat{i})=ones(A+A^{2}+A^{3})(\hat{i},%
\hat{i}))
50
500
32
0.0005
128
[128]
[256,128]
