\mathcal{C}_{1}
\mathcal{C}_{2}
\mathcal{C}_{1}
\mathcal{C}_{2}
\mathcal{B}_{1}
\mathcal{B}_{2}
\mathcal{B}_{2}
\mathcal{B}_{1}
\bm{x}
\bm{h}\textrm{=}f(\bm{x})
\{g_{i}\}_{i\textrm{=}1}^{n}
\bm{x}
\bm{h}\textrm{=}f(\bm{x})
\{g_{i}\}_{i\textrm{=}1}^{n}
\lambda
\mathcal{L}\!=\!\mathcal{L}_{\textrm{classification}}+\lambda\,\mathcal{L}_{%
\textrm{diversity}}
\displaystyle\mathcal{L}_{\textrm{diversity}}=\Sigma_{\bm{x}\in\textrm{Tr}}%
\leavevmode\nobreak\ \Sigma_{i\textrm{=}1}^{n}\leavevmode\nobreak\ \Sigma_{j%
\textrm{=}i+1}^{n}\leavevmode\nobreak\ \nabla_{\bm{h}}\,g_{i}(\bm{h}).\nabla_{%
\bm{h}}\,g_{j}(\bm{h}),\quad\text{with}\,\,\,\bm{h}=f(\bm{x}).
\displaystyle\mathcal{L}_{\textrm{diversity}}=\Sigma_{\bm{x}\in\textrm{Tr}}%
\leavevmode\nobreak\ \Sigma_{i\textrm{=}1}^{n}\leavevmode\nobreak\ \Sigma_{j%
\textrm{=}i+1}^{n}\leavevmode\nobreak\ \nabla_{\bm{h}}\,g_{i}(\bm{h}).\nabla_{%
\bm{h}}\,g_{j}(\bm{h}),\quad\text{with}\,\,\,\bm{h}=f(\bm{x}).
g
\nabla_{\bm{h}}\,g(\cdot)
\bm{h}
n
\lambda
10^{3}
\times
\times
10^{3}\!.\,24
y\in\mathbb{R}
\bm{x}
\bm{x}\!=\![\bm{x}_{\mathrm{inv}}\,;\,\bm{x}_{\mathrm{spu}}]
\bm{x}_{\mathrm{inv}}\!\in\!\mathbb{R}^{d_{\mathrm{inv}}}
\bm{x}_{\mathrm{spu}}\!\in\!\mathbb{R}^{d_{\mathrm{spu}}}
y^{e}=\bm{\gamma}^{\top}\bm{x}_{\mathrm{inv}}^{e}+{\epsilon}_{\mathrm{inv}}
\bm{x}_{\mathrm{spu}}^{e}=y^{e}\mathbf{1^{s}}+\bm{\alpha}^{e}\circ\bm{\epsilon%
}_{\mathrm{spu}}
e\in\{e_{\mathrm{ID}},\,e_{\mathrm{OOD}}\}
\mathbf{1^{s}}
\circ
{\epsilon}_{\mathrm{inv}}
\bm{\epsilon}_{\mathrm{spu}}
\operatorname{Var}{({\epsilon}_{\mathrm{inv}})}\!>\!0
\operatorname{Var}({\epsilon_{\mathrm{spu},i}})\!>\!0
\forall\,i\!\in\![1,d_{\mathrm{spu}}]
\bm{\gamma}\!\in\!\mathbb{R}^{d_{\mathrm{inv}}}
\bm{\alpha}^{e}
\Phi
\bm{x}
\Phi\!\in\!\{0,\!1\}^{d_{\mathrm{inv}}+d_{\mathrm{spu}}}
\hat{d}_{\mathrm{inv}}
\hat{d}_{\mathrm{spu}}
(\hat{d}_{\mathrm{inv}}\!+\!\hat{d}_{\mathrm{spu}})=\hat{d}=||\Phi_{\hat{d}}||%
_{1}
\Phi_{\hat{d}}
[x_{\mathrm{inv},1},\,...,\,x_{\mathrm{inv},\hat{d}_{\mathrm{inv}}},\,x_{%
\mathrm{spu},1},\,...,\,x_{\mathrm{spu},\hat{d}_{\mathrm{spu}}}]
\mathbb{E}^{\text{ID}}
\mathbb{E}^{\text{OOD}}
\bm{\beta}
\bm{\beta}_{\hat{d}}=\mathbb{E}[\Phi_{\hat{d}}(\bm{x})^{\top}\Phi_{\hat{d}}(%
\bm{x})]\leavevmode\nobreak\ \mathbb{E}[\Phi_{\hat{d}}(\bm{x})^{\top}y]
\mathbb{E}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\bm{\beta}_{\hat{d}}]^{2}
\Phi_{\hat{d}}
\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}})
\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})
\Phi_{\hat{d}}
\Phi_{\hat{d}+1}
\bm{\alpha}
\displaystyle\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}+1})-\mathcal{L}_{\mathrm{%
ID}}(\Phi_{\hat{d}})=\mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}%
\bm{\beta}^{\mathrm{ID}}_{\hat{d}}]^{2}-\mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{%
d}+1}(\bm{x})^{\top}\bm{\beta}^{\mathrm{ID}}_{\hat{d}+1}]^{2}<0
\displaystyle\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}+1})-\mathcal{L}_{\mathrm{%
ID}}(\Phi_{\hat{d}})
\displaystyle=\mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\bm{%
\beta}^{\mathrm{ID}}_{\hat{d}}]^{2}-\mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{d}+1%
}(\bm{x})^{\top}\bm{\beta}^{\mathrm{ID}}_{\hat{d}+1}]^{2}<0
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})-\mathcal{L}_{\mathrm%
{OOD}}(\Phi_{\hat{d}})=\mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}}(\bm{x})^{%
\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}}]^{2}-\mathbb{E}^{\mathrm{OOD}}[y-\Phi%
_{\hat{d}+1}(\bm{x})^{\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}+1}]^{2}>0\,.
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})-\mathcal{L}_{\mathrm%
{OOD}}(\Phi_{\hat{d}})
\displaystyle=\mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\bm{%
\beta}^{\mathrm{OOD}}_{\hat{d}}]^{2}-\mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}%
+1}(\bm{x})^{\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}+1}]^{2}>0\,.
\mathrel{\mathchoice{\mathrel{}\mathrel{\mathop{\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@}\limits^{\hbox%
{\set@color$\scriptstyle\,\hskip 147.00027pt$}}}\mathrel{\mathchar 0\relax%
\symAMSa 04B}{}}{\mathrel{}\mathrel{\mathop{\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@}\limits^{\hbox%
{\set@color$\scriptstyle\,\hskip 147.00027pt$}}}\mathrel{\mathchar 0\relax%
\symAMSa 04B}{}}{\mathrel{}\mathrel{\mathop{\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@}\limits^{\hbox%
{\set@color$\scriptscriptstyle\,\hskip 105.0pt$}}}\mathrel{\mathchar 0\relax%
\symAMSa 04B}{}}{\mathrel{}\mathrel{\mathop{\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@%
\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@\dabar@}\limits%
^{\hbox{\set@color$\scriptstyle\,\hskip 147.00027pt$}}}\mathrel{\mathchar 0%
\relax\symAMSa 04B}{}}}
\,\mathrel{\mathchoice{\mkern 2.0mu\clipbox{{.50pt}000}{$\displaystyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$\textstyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$\scriptstyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$%
\scriptscriptstyle\vphantom{+}{\rightarrow}$}}}
\,\mathrel{\mathchoice{\mkern 2.0mu\clipbox{{.50pt}000}{$\displaystyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$\textstyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$\scriptstyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$%
\scriptscriptstyle\vphantom{+}{\rightarrow}$}}}
\,\mathrel{\mathchoice{\mkern 2.0mu\clipbox{{.50pt}000}{$\displaystyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$\textstyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$\scriptstyle%
\vphantom{+}{\rightarrow}$}}{\mkern 2.0mu\clipbox{{.50pt}000}{$%
\scriptscriptstyle\vphantom{+}{\rightarrow}$}}}\;
\mathcal{C}_{1}
\mathcal{B}_{1}
\displaystyle\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}+1})\leavevmode\nobreak\ %
\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \,-\leavevmode%
\nobreak\ \mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}})\leavevmode\nobreak\ %
\leavevmode\nobreak\ \leavevmode\nobreak\ \,=\leavevmode\nobreak\ \leavevmode%
\nobreak\ \mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\bm{\beta}^{%
\mathrm{ID}}_{\hat{d}}]^{2}\leavevmode\nobreak\ -\leavevmode\nobreak\ \mathbb{%
E}^{\mathrm{ID}}[y-\Phi_{\hat{d}+1}(\bm{x})^{\top}\bm{\beta}^{\mathrm{ID}}_{%
\hat{d}+1}]^{2}\leavevmode\nobreak\ \leavevmode\nobreak\ <\leavevmode\nobreak%
\ \leavevmode\nobreak\ 0
\displaystyle\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}+1})\leavevmode\nobreak\ %
\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \,-\leavevmode%
\nobreak\ \mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}})\leavevmode\nobreak\ %
\leavevmode\nobreak\ \leavevmode\nobreak\ \,
\displaystyle=\leavevmode\nobreak\ \leavevmode\nobreak\ \mathbb{E}^{\mathrm{ID%
}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\bm{\beta}^{\mathrm{ID}}_{\hat{d}}]^{2}%
\leavevmode\nobreak\ -\leavevmode\nobreak\ \mathbb{E}^{\mathrm{ID}}[y-\Phi_{%
\hat{d}+1}(\bm{x})^{\top}\bm{\beta}^{\mathrm{ID}}_{\hat{d}+1}]^{2}\leavevmode%
\nobreak\ \leavevmode\nobreak\ <\leavevmode\nobreak\ \leavevmode\nobreak\ 0
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})\leavevmode\nobreak\ %
-\leavevmode\nobreak\ \mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})=\leavevmode%
\nobreak\ \leavevmode\nobreak\ \mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}}(\bm{%
x})^{\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}}]^{2}\leavevmode\nobreak\ -%
\leavevmode\nobreak\ \mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}+1}(\bm{x})^{%
\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}+1}]^{2}\leavevmode\nobreak\ %
\leavevmode\nobreak\ >\leavevmode\nobreak\ \leavevmode\nobreak\ 0
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})\leavevmode\nobreak\ %
-\leavevmode\nobreak\ \mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})
\displaystyle=\leavevmode\nobreak\ \leavevmode\nobreak\ \mathbb{E}^{\mathrm{%
OOD}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}}]^{2}%
\leavevmode\nobreak\ -\leavevmode\nobreak\ \mathbb{E}^{\mathrm{OOD}}[y-\Phi_{%
\hat{d}+1}(\bm{x})^{\top}\bm{\beta}^{\mathrm{OOD}}_{\hat{d}+1}]^{2}\leavevmode%
\nobreak\ \leavevmode\nobreak\ >\leavevmode\nobreak\ \leavevmode\nobreak\ 0
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})\leavevmode\nobreak\ %
-\leavevmode\nobreak\ \mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})=\leavevmode%
\nobreak\ \leavevmode\nobreak\ Q_{1}+Q_{2}+Q_{3}
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})\leavevmode\nobreak\ %
-\leavevmode\nobreak\ \mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})
\displaystyle=\leavevmode\nobreak\ \leavevmode\nobreak\ Q_{1}+Q_{2}+Q_{3}
Q_{1}
Q_{2}
Q_{3}
\displaystyle Q_{1}\leavevmode\nobreak\ \leavevmode\nobreak\ =\leavevmode%
\nobreak\ \leavevmode\nobreak\ \mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}}(\bm{%
x})^{\top}\beta^{\mathrm{OOD}}_{\hat{d}}]^{2}\leavevmode\nobreak\ -\leavevmode%
\nobreak\ \mathbb{E}[y-\Phi_{\hat{d}+1}(\bm{x})^{\top}\beta^{\mathrm{OOD}}_{%
\hat{d}+1}]^{2}
\displaystyle Q_{1}\leavevmode\nobreak\ \leavevmode\nobreak\ =\leavevmode%
\nobreak\ \leavevmode\nobreak\ 
\displaystyle\mathbb{E}^{\mathrm{OOD}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\beta^{%
\mathrm{OOD}}_{\hat{d}}]^{2}\leavevmode\nobreak\ -\leavevmode\nobreak\ \mathbb%
{E}[y-\Phi_{\hat{d}+1}(\bm{x})^{\top}\beta^{\mathrm{OOD}}_{\hat{d}+1}]^{2}
\displaystyle Q_{2}\leavevmode\nobreak\ \leavevmode\nobreak\ =\leavevmode%
\nobreak\ \leavevmode\nobreak\ \sum_{i=1}^{\hat{d}}\Biggr{[}\,\big{(}\mathbb{E%
}^{\mathrm{OOD}}[\Phi_{\hat{d}}(\bm{x})y]^{\top}\bm{v}_{i}^{\mathrm{OOD},\hat{%
d}}\big{)}^{2}\leavevmode\nobreak\ \big{(}\lambda_{i}^{\mathrm{OOD},\hat{d}}%
\big{)}\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}^{\mathrm{ID},\hat{d}}}%
-\frac{1}{\lambda_{i}^{\mathrm{OOD},\hat{d}}}\Big{)}^{2}
\displaystyle Q_{2}\leavevmode\nobreak\ \leavevmode\nobreak\ =\leavevmode%
\nobreak\ \leavevmode\nobreak\ 
\displaystyle\sum_{i=1}^{\hat{d}}\Biggr{[}\,\big{(}\mathbb{E}^{\mathrm{OOD}}[%
\Phi_{\hat{d}}(\bm{x})y]^{\top}\bm{v}_{i}^{\mathrm{OOD},\hat{d}}\big{)}^{2}%
\leavevmode\nobreak\ \big{(}\lambda_{i}^{\mathrm{OOD},\hat{d}}\big{)}%
\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}^{\mathrm{ID},\hat{d}}}-\frac{%
1}{\lambda_{i}^{\mathrm{OOD},\hat{d}}}\Big{)}^{2}
\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \,%
-\big{(}\mathbb{E}^{\mathrm{OOD}}[\Phi_{\hat{d}}(\bm{x})y]^{\top}\bm{v}_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ \big{(}\lambda_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}%
^{\mathrm{ID},\hat{d}+1}}-\frac{1}{\lambda_{i}^{\mathrm{OOD},\hat{d}+1}}\Big{)%
}^{2}\Biggr{]}
\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \,%
-\big{(}\mathbb{E}^{\mathrm{OOD}}[\Phi_{\hat{d}}(\bm{x})y]^{\top}\bm{v}_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ \big{(}\lambda_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}%
^{\mathrm{ID},\hat{d}+1}}-\frac{1}{\lambda_{i}^{\mathrm{OOD},\hat{d}+1}}\Big{)%
}^{2}\Biggr{]}
\displaystyle Q_{3}\leavevmode\nobreak\ \leavevmode\nobreak\ =\leavevmode%
\nobreak\ \leavevmode\nobreak\ \big{(}\mathbb{E}^{\mathrm{OOD}}[\Phi_{\hat{d}+%
1}(\bm{x})y]^{\top}\bm{v}_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}\big{)}^{2}%
\leavevmode\nobreak\ \frac{((\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}\;-\;(\alpha%
_{\hat{d}+1}^{\mathrm{OOD}})^{2})^{2}}{(\lambda_{\hat{d}+1}^{\mathrm{ID},\hat{%
d}+1})^{2}\leavevmode\nobreak\ \lambda_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}}%
\quad>\quad 0.
\displaystyle Q_{3}\leavevmode\nobreak\ \leavevmode\nobreak\ =\leavevmode%
\nobreak\ \leavevmode\nobreak\ 
\displaystyle\big{(}\mathbb{E}^{\mathrm{OOD}}[\Phi_{\hat{d}+1}(\bm{x})y]^{\top%
}\bm{v}_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ %
\frac{((\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}\;-\;(\alpha_{\hat{d}+1}^{\mathrm%
{OOD}})^{2})^{2}}{(\lambda_{\hat{d}+1}^{\mathrm{ID},\hat{d}+1})^{2}\leavevmode%
\nobreak\ \lambda_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}}\quad>\quad 0.
((\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}-(\alpha_{\hat{d}+1}^{\mathrm{OOD}})^{2%
})^{2}
\displaystyle|(\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}-(\alpha_{\hat{d}+1}^{%
\mathrm{OOD}})^{2}|\quad>\quad\sqrt{\frac{(\lambda_{\hat{d}+1}^{\mathrm{ID},%
\hat{d}+1})^{2}\lambda_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}}{\big{(}\mathbb{E}%
^{\mathrm{OOD}}[\Phi(\bm{x})y]^{\top}\bm{v}_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+%
1}\big{)}^{2}}\leavevmode\nobreak\ \leavevmode\nobreak\ \left|Q_{1}+Q_{2}%
\right|}\;,
\displaystyle|(\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}-(\alpha_{\hat{d}+1}^{%
\mathrm{OOD}})^{2}|\quad>\quad\sqrt{\frac{(\lambda_{\hat{d}+1}^{\mathrm{ID},%
\hat{d}+1})^{2}\lambda_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}}{\big{(}\mathbb{E}%
^{\mathrm{OOD}}[\Phi(\bm{x})y]^{\top}\bm{v}_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+%
1}\big{)}^{2}}\leavevmode\nobreak\ \leavevmode\nobreak\ \left|Q_{1}+Q_{2}%
\right|}\;,
Q_{3}>|Q_{1}+Q_{2}|
\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}+1})-\mathcal{L}_{\mathrm{OOD}}(\Phi_{%
\hat{d}})\leavevmode\nobreak\ >\leavevmode\nobreak\ 0
\bm{x}_{\hat{d}}:=\Phi_{\hat{d}}({\bm{m}{x}})[\bm{x}_{\mathrm{inv},1},\,...,\,%
\bm{x}_{\mathrm{inv},\hat{d}_{\mathrm{inv}}},\,\bm{x}_{\mathrm{spu},1},\,...,%
\,\bm{x}_{\mathrm{spu},\hat{d}_{\mathrm{spu}}}]
\hat{d}
\bm{x}_{\hat{d}+1}:=\Phi_{\hat{d}+1}({\bm{m}{x}})
\bm{x}_{\mathrm{spu},\hat{d}_{\mathrm{spu}}+1}
\bm{x}_{\hat{d}}
[\lambda_{1}^{\hat{d}},\lambda_{2}^{\hat{d}},...,\lambda_{\hat{d}}^{\hat{d}}]
\mathbb{E}[\bm{x}^{\top}_{\hat{d}}\bm{x}_{\hat{d}}]
[\bm{v}_{1}^{\hat{d}},\bm{v}_{2}^{\hat{d}},...,\bm{v}_{\hat{d}}^{\hat{d}}]
\mathbb{E}[\bm{x}_{\hat{d}}^{\intercal}\,\bm{v}_{i}^{\hat{d}}]
\displaystyle\big{|}\,\mathbb{E}^{e}[\bm{x}_{\hat{d}}^{\intercal}\,\bm{v}_{i}^%
{\hat{d}}]\,\big{|}>0,\leavevmode\nobreak\ \leavevmode\nobreak\ \forall%
\leavevmode\nobreak\ e\!\in\!\{e_{\mathrm{ID}},\,e_{\mathrm{OOD}}\},%
\leavevmode\nobreak\ i\!\in\![d].
\displaystyle\big{|}\,\mathbb{E}^{e}[\bm{x}_{\hat{d}}^{\intercal}\,\bm{v}_{i}^%
{\hat{d}}]\,\big{|}>0,\leavevmode\nobreak\ \leavevmode\nobreak\ \forall%
\leavevmode\nobreak\ e\!\in\!\{e_{\mathrm{ID}},\,e_{\mathrm{OOD}}\},%
\leavevmode\nobreak\ i\!\in\![d].
0
\beta^{\mathrm{ID}}
\beta^{\mathrm{OOD}}
\displaystyle\beta^{\mathrm{ID}}_{\hat{d}}=\operatorname*{arg\,min}_{\beta}%
\mathbb{E}^{\mathrm{ID}}(y-\bm{x}_{\hat{d}}^{\top}\beta)^{2}
\displaystyle\beta^{\mathrm{ID}}_{\hat{d}}=
\displaystyle\operatorname*{arg\,min}_{\beta}\mathbb{E}^{\mathrm{ID}}(y-\bm{x}%
_{\hat{d}}^{\top}\beta)^{2}
\displaystyle\beta^{\mathrm{OOD}}_{\hat{d}}=\operatorname*{arg\,min}_{\beta}%
\mathbb{E}^{\mathrm{OOD}}(y-\bm{x}_{\hat{d}}^{\top}\beta)^{2}
\displaystyle\beta^{\mathrm{OOD}}_{\hat{d}}=
\displaystyle\operatorname*{arg\,min}_{\beta}\mathbb{E}^{\mathrm{OOD}}(y-\bm{x%
}_{\hat{d}}^{\top}\beta)^{2}
\bm{x}_{\mathrm{spu},\hat{d}_{\mathrm{spu}}+1}
\beta^{\mathrm{ID}}
\displaystyle\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}})=\mathbb{E}^{\mathrm{ID}%
}(y-\bm{x}^{\top}_{\hat{d}}\beta^{\mathrm{ID}})
\displaystyle\mathcal{L}_{\mathrm{ID}}(\Phi_{\hat{d}})=
\displaystyle\mathbb{E}^{\mathrm{ID}}(y-\bm{x}^{\top}_{\hat{d}}\beta^{\mathrm{%
ID}})
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})=\mathbb{E}^{\mathrm{%
OOD}}(y-\bm{x}^{\top}_{\hat{d}}\beta^{\mathrm{ID}})
\displaystyle\mathcal{L}_{\mathrm{OOD}}(\Phi_{\hat{d}})=
\displaystyle\mathbb{E}^{\mathrm{OOD}}(y-\bm{x}^{\top}_{\hat{d}}\beta^{\mathrm%
{ID}})
\displaystyle=\underbrace{\mathbb{E}^{\mathrm{OOD}}(y-\bm{x}^{\top}_{\hat{d}}%
\beta^{\mathrm{ID}})-\mathbb{E}^{\mathrm{OOD}}(y-\bm{x}^{\top}_{\hat{d}}\beta^%
{\mathrm{OOD}})}_{\xi_{1}^{\hat{d}}}+\underbrace{\mathbb{E}^{\mathrm{OOD}}(y-%
\bm{x}^{\top}_{\hat{d}}\beta^{\mathrm{OOD}})}_{\xi_{2}^{\hat{d}}}
\displaystyle=
\displaystyle\underbrace{\mathbb{E}^{\mathrm{OOD}}(y-\bm{x}^{\top}_{\hat{d}}%
\beta^{\mathrm{ID}})-\mathbb{E}^{\mathrm{OOD}}(y-\bm{x}^{\top}_{\hat{d}}\beta^%
{\mathrm{OOD}})}_{\xi_{1}^{\hat{d}}}+\underbrace{\mathbb{E}^{\mathrm{OOD}}(y-%
\bm{x}^{\top}_{\hat{d}}\beta^{\mathrm{OOD}})}_{\xi_{2}^{\hat{d}}}
y
\bm{x}_{\hat{d}}
\displaystyle{\mathcal{L}}_{\mathrm{ID}}(\Phi_{\hat{d}})=\mathbb{E}^{\mathrm{%
ID}}\big{[}y-\bm{x}_{\hat{d}}\mathbb{E}^{\mathrm{ID}}[\bm{x}^{\top}_{\hat{d}}%
\bm{x}_{\hat{d}}]^{-1}\mathbb{E}^{\mathrm{ID}}[\bm{x}_{\hat{d}}y]\big{]}^{2}=%
\mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\beta^{\mathrm{ID}}_{%
\hat{d}}]^{2},
\displaystyle{\mathcal{L}}_{\mathrm{ID}}(\Phi_{\hat{d}})=\mathbb{E}^{\mathrm{%
ID}}\big{[}y-\bm{x}_{\hat{d}}\mathbb{E}^{\mathrm{ID}}[\bm{x}^{\top}_{\hat{d}}%
\bm{x}_{\hat{d}}]^{-1}\mathbb{E}^{\mathrm{ID}}[\bm{x}_{\hat{d}}y]\big{]}^{2}=%
\mathbb{E}^{\mathrm{ID}}[y-\Phi_{\hat{d}}(\bm{x})^{\top}\beta^{\mathrm{ID}}_{%
\hat{d}}]^{2},
\displaystyle{\mathcal{L}}_{\mathrm{ID}}(\Phi_{\hat{d}+1})=\mathbb{E}^{\mathrm%
{ID}}[y-\bm{x}_{\hat{d}+1}^{\top}\beta^{\mathrm{ID}}_{\hat{d}+1}]^{2}.
\displaystyle{\mathcal{L}}_{\mathrm{ID}}(\Phi_{\hat{d}+1})=\mathbb{E}^{\mathrm%
{ID}}[y-\bm{x}_{\hat{d}+1}^{\top}\beta^{\mathrm{ID}}_{\hat{d}+1}]^{2}.
\bm{x}_{\mathrm{spu},\hat{d}_{\mathrm{spu}+1}}
\bm{x}_{\hat{d}}
\bm{x}_{\hat{d}+1}
\bm{x}_{\hat{d}}
\displaystyle{\mathcal{L}}_{\mathrm{ID}}(\Phi_{\hat{d}})-{\mathcal{L}}_{%
\mathrm{ID}}(\Phi_{\hat{d}+1})=\mathbb{E}^{\mathrm{ID}}[y-\bm{x}_{\hat{d}}^{%
\top}\beta^{\mathrm{ID}}_{\hat{d}}]^{2}-\mathbb{E}^{\mathrm{ID}}[y-\bm{x}_{%
\hat{d}+1}^{\top}\beta^{\mathrm{ID}}_{\hat{d}+1}]^{2}>0,
\displaystyle{\mathcal{L}}_{\mathrm{ID}}(\Phi_{\hat{d}})-{\mathcal{L}}_{%
\mathrm{ID}}(\Phi_{\hat{d}+1})=\mathbb{E}^{\mathrm{ID}}[y-\bm{x}_{\hat{d}}^{%
\top}\beta^{\mathrm{ID}}_{\hat{d}}]^{2}-\mathbb{E}^{\mathrm{ID}}[y-\bm{x}_{%
\hat{d}+1}^{\top}\beta^{\mathrm{ID}}_{\hat{d}+1}]^{2}>0,
\displaystyle\xi_{2}^{\hat{d}}-\xi_{2}^{\hat{d}+1}=\mathbb{E}^{\mathrm{OOD}}[y%
-\bm{x}_{\hat{d}}^{\top}\beta^{\mathrm{OOD}}_{\hat{d}}]^{2}-\mathbb{E}^{%
\mathrm{OOD}}[y-\bm{x}_{\hat{d}+1}^{\top}\beta^{\mathrm{OOD}}_{\hat{d}+1}]^{2}%
>0.
\displaystyle\xi_{2}^{\hat{d}}-\xi_{2}^{\hat{d}+1}=\mathbb{E}^{\mathrm{OOD}}[y%
-\bm{x}_{\hat{d}}^{\top}\beta^{\mathrm{OOD}}_{\hat{d}}]^{2}-\mathbb{E}^{%
\mathrm{OOD}}[y-\bm{x}_{\hat{d}+1}^{\top}\beta^{\mathrm{OOD}}_{\hat{d}+1}]^{2}%
>0.
\displaystyle\xi_{1}^{\hat{d}}=\sum_{i}^{\hat{d}}(\mathbb{E}^{\mathrm{OOD}}[%
\bm{x}^{\top}_{\hat{d}}y]^{\intercal}\bm{v}_{i}^{\mathrm{OOD},{\hat{d}}})^{2}%
\lambda_{i}^{\mathrm{OOD}}(\frac{1}{\lambda_{i}^{\mathrm{IID},\hat{d}}}-\frac{%
1}{\lambda_{i}^{\mathrm{OOD,\hat{d}}}})^{2}.
\displaystyle\xi_{1}^{\hat{d}}=\sum_{i}^{\hat{d}}(\mathbb{E}^{\mathrm{OOD}}[%
\bm{x}^{\top}_{\hat{d}}y]^{\intercal}\bm{v}_{i}^{\mathrm{OOD},{\hat{d}}})^{2}%
\lambda_{i}^{\mathrm{OOD}}(\frac{1}{\lambda_{i}^{\mathrm{IID},\hat{d}}}-\frac{%
1}{\lambda_{i}^{\mathrm{OOD,\hat{d}}}})^{2}.
\displaystyle\lambda_{i}^{\mathrm{IID},\hat{d}}-\lambda^{\mathrm{OOD},\hat{d}}%
_{i}=(\alpha_{i}^{\mathrm{IID}})^{2}-(\alpha_{i}^{\mathrm{OOD}})^{2}.
\displaystyle\lambda_{i}^{\mathrm{IID},\hat{d}}-\lambda^{\mathrm{OOD},\hat{d}}%
_{i}=(\alpha_{i}^{\mathrm{IID}})^{2}-(\alpha_{i}^{\mathrm{OOD}})^{2}.
\displaystyle\xi_{1}^{\hat{d}+1}-\xi_{1}^{\hat{d}+1}=\sum_{i=1}^{\hat{d}}%
\Biggr{[}\,\big{(}\mathbb{E}^{\mathrm{OOD}}[\bm{x}_{\hat{d}}y]^{\top}\bm{v}_{i%
}^{\mathrm{OOD},\hat{d}}\big{)}^{2}\leavevmode\nobreak\ \big{(}\lambda_{i}^{%
\mathrm{OOD},\hat{d}}\big{)}\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}^{%
\mathrm{ID},\hat{d}}}-\frac{1}{\lambda_{i}^{\mathrm{OOD},\hat{d}}}\Big{)}^{2}
\displaystyle\xi_{1}^{\hat{d}+1}-\xi_{1}^{\hat{d}+1}=
\displaystyle\sum_{i=1}^{\hat{d}}\Biggr{[}\,\big{(}\mathbb{E}^{\mathrm{OOD}}[%
\bm{x}_{\hat{d}}y]^{\top}\bm{v}_{i}^{\mathrm{OOD},\hat{d}}\big{)}^{2}%
\leavevmode\nobreak\ \big{(}\lambda_{i}^{\mathrm{OOD},\hat{d}}\big{)}%
\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}^{\mathrm{ID},\hat{d}}}-\frac{%
1}{\lambda_{i}^{\mathrm{OOD},\hat{d}}}\Big{)}^{2}
\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \,%
-\big{(}\mathbb{E}^{\mathrm{OOD}}[\bm{x}_{\hat{d}+1}y]^{\top}\bm{v}_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ \big{(}\lambda_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}%
^{\mathrm{ID},\hat{d}+1}}-\frac{1}{\lambda_{i}^{\mathrm{OOD},\hat{d}+1}}\Big{)%
}^{2}\Biggr{]}
\displaystyle\leavevmode\nobreak\ \leavevmode\nobreak\ \leavevmode\nobreak\ \,%
-\big{(}\mathbb{E}^{\mathrm{OOD}}[\bm{x}_{\hat{d}+1}y]^{\top}\bm{v}_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ \big{(}\lambda_{i}^{%
\mathrm{OOD},\hat{d}+1}\big{)}\leavevmode\nobreak\ \Big{(}\frac{1}{\lambda_{i}%
^{\mathrm{ID},\hat{d}+1}}-\frac{1}{\lambda_{i}^{\mathrm{OOD},\hat{d}+1}}\Big{)%
}^{2}\Biggr{]}
\displaystyle+\big{(}\mathbb{E}^{\mathrm{OOD}}[\bm{x}_{\hat{d}+1}y]^{\top}\bm{%
v}_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ \frac{(%
(\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}\;-\;(\alpha_{\hat{d}+1}^{\mathrm{OOD}})%
^{2})^{2}}{(\lambda_{\hat{d}+1}^{\mathrm{ID},\hat{d}+1})^{2}\leavevmode%
\nobreak\ \lambda_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}}.
\displaystyle+\big{(}\mathbb{E}^{\mathrm{OOD}}[\bm{x}_{\hat{d}+1}y]^{\top}\bm{%
v}_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}\big{)}^{2}\leavevmode\nobreak\ \frac{(%
(\alpha_{\hat{d}+1}^{\mathrm{ID}})^{2}\;-\;(\alpha_{\hat{d}+1}^{\mathrm{OOD}})%
^{2})^{2}}{(\lambda_{\hat{d}+1}^{\mathrm{ID},\hat{d}+1})^{2}\leavevmode%
\nobreak\ \lambda_{\hat{d}+1}^{\mathrm{OOD},\hat{d}+1}}.
