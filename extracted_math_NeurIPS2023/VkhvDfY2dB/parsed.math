\epsilon-
t\geq 0
s_{t}\in\mathcal{S}
a_{t}\in\mathcal{A}
r_{t}
s_{t+1}\sim p(s_{t+1}|s_{t},a_{t})
t=0
s_{0}\sim\rho(s_{0})
a_{t}\sim\pi(\cdot|s_{t})
\pi
\displaystyle J=E_{s_{0}\sim\rho,a_{t}\sim\pi(\cdot|s_{t})}\big{[}\sum_{t=0}^{%
\infty}r_{t}\gamma^{t}\big{]},
\displaystyle J=E_{s_{0}\sim\rho,a_{t}\sim\pi(\cdot|s_{t})}\big{[}\sum_{t=0}^{%
\infty}r_{t}\gamma^{t}\big{]},
\gamma\in(0,1]
s
Q^{\pi}(s,a)
a
\pi
Q^{\pi}(s,a)=E_{a_{t}\sim\pi(\cdot|s_{t})}\big{[}\sum_{t=0}^{\infty}r_{t}%
\gamma^{t}|s_{0}=s,a_{0}=a\big{]}.
Q^{\pi}(s_{t},a_{t})
Q^{\pi}(s_{t},a_{t})=E[r_{t}+\gamma Q^{\pi}(s_{t+1},a_{t+1})],\ \forall(s_{t},%
a_{t}).
\pi^{\ast}=\arg\max_{\pi}J
Q^{\ast}(s,a)
Q^{\ast}(s,a)
Q^{\ast}(s_{t},a_{t})=E\big{[}r_{t}+\gamma\max_{a}Q^{\ast}(s_{t+1},a)\big{]},%
\ \forall(s_{t},a_{t}).
\mathcal{T}^{\ast}Q(s_{t},a_{t})\coloneqq E[r_{t}+\gamma\max_{a^{\prime}}Q(s_{%
t+1},a^{\prime})].
\gamma\in(0,1)
Q^{(0)}(s,a)
Q^{(t+1)}(s,a)\leftarrow T^{\ast}Q^{(t)}(s,a)
Q^{(t)}(s,a)\rightarrow Q^{\ast}(s,a)
t\rightarrow\infty
Q_{\theta}(s,a)
\theta
(s,a)
\theta
Q_{\theta}(s,a)\approx Q^{\ast}(s,a)
\Pi
Q(s,a)\in R^{|\mathcal{S}|\times|\mathcal{A}|}
Q_{\theta}(s,a)
Q_{\theta}(s,a)
Q^{(t)}(s,a)
Q^{(t+1)}(s,a)\leftarrow\Pi\mathcal{T}^{\ast}Q^{(t)}(s,a)
Q_{\theta}(s,a)
Q_{\theta}(s,a)
Q^{\pi}(s,a)
\pi
(s_{t},a_{t})
\pi
R^{\pi}(s_{t},a_{t})=\sum_{t^{\prime}\geq t}r_{t^{\prime}}\gamma^{t^{\prime}-t}
Q^{\pi}(s,a)=E[R^{\pi}(s,a)]
Z^{\pi}(s,a)
R^{\pi}(s,a)
Z^{\pi}(s_{t},a_{t})=_{D}r_{t}+\gamma Z^{\pi}(s_{t+1},\pi(s_{t+1})),
=_{D}
=_{D}
=
\mathcal{H}^{\pi}
\pi
\mathcal{H}^{\pi}Z(s_{t},a_{t})\coloneqq r_{t}+\gamma Z(s_{t+1},\pi(s_{t+1})).
\mathcal{H}^{\pi}
\mathcal{H}^{\ast}
\mathcal{H}^{\ast}Z\coloneqq\mathcal{H}^{\pi^{\ast}}Z,\ \ \text{for some %
optimal policy}\ \pi^{\ast}.
\gamma\in(0,1)
Z^{(0)}(s,a)
Z^{(t+1)}(s,a)\leftarrow\mathcal{H}^{\ast}Z^{(t)}(s,a)
E[Z^{(t)}(s,a)]\rightarrow Q^{\ast}(s,a)
Z^{(t)}(s,a)
Z_{\theta}(s,a)
Z^{\pi}(s,a)
\theta
D(Z_{1},Z_{2})
Z_{1}
Z_{2}
\Pi
\Pi Z\coloneqq\arg\min_{Z_{\theta}}D(Z,Z_{\theta}).
\Pi
Z
Z_{\theta}
Z
Z
Z^{(t+1)}(s,a)\leftarrow\Pi\mathcal{H}^{\ast}Z^{(t)}(s,a)
(s,a)
(s_{t},a_{t})
a^{\prime}=\arg\max_{a}E[Z_{\theta}(s_{t+1},a)],
Z_{\theta}(s_{t},a_{t})
\displaystyle\min_{\theta}D(r_{t}+\gamma Z_{\theta}(s_{t+1},a^{\prime}),Z_{%
\theta}(s_{t},a_{t})).
\displaystyle\min_{\theta}D(r_{t}+\gamma Z_{\theta}(s_{t+1},a^{\prime}),Z_{%
\theta}(s_{t},a_{t})).
x_{i}\sim r_{t}+\gamma Z_{\theta}(s_{t+1},a^{\prime}),1\leq i\leq N
\hat{Z}=\sum_{i=1}^{N}\frac{1}{N}\delta(x-x_{i})
\delta(x-x_{i})
1
x=x_{i}
D(\hat{Z},Z_{\theta})
\epsilon-
Z(s,a)
(s,a)
Z_{\theta}(s,a)
\theta
\hat{Z}
\hat{Z}=\sum_{i=1}^{N}\frac{1}{N}\delta(x-x_{i})
\displaystyle KL[\hat{Z}||Z_{\theta}]=\sum_{i=1}^{N}\frac{1}{N}\log\frac{\frac%
{1}{N}}{Z_{\theta}(x_{i})}=-\frac{1}{N}\sum_{i=1}^{N}\log Z_{\theta}(x_{i}),
\displaystyle KL[\hat{Z}||Z_{\theta}]=\sum_{i=1}^{N}\frac{1}{N}\log\frac{\frac%
{1}{N}}{Z_{\theta}(x_{i})}=-\frac{1}{N}\sum_{i=1}^{N}\log Z_{\theta}(x_{i}),
-\log N
\theta
\theta\sim q_{\phi}(\theta)
\phi
\displaystyle\min_{\phi}E_{\theta\sim q_{\phi}(\theta)}[-\sum_{i=1}^{N}\log Z_%
{\theta}(x_{i})]-H(q_{\phi}(\theta)),
\displaystyle\min_{\phi}E_{\theta\sim q_{\phi}(\theta)}[-\sum_{i=1}^{N}\log Z_%
{\theta}(x_{i})]-H(q_{\phi}(\theta)),
H(q_{\phi}(\theta))
q_{\phi}(\theta)
\Pi\mathcal{H}^{\ast}
\theta\sim q_{\phi}(\theta)
\theta
\theta
p(\theta)\propto 1
\{x_{i}\}_{i=1}^{N}
p(\theta|\{x_{i}\}_{i=1}^{N})\propto p(\theta)p(\{x_{i}\}_{i=1}^{N}|\theta)
p(\{x_{i}\}_{i=1}^{N}|\theta)=\Pi_{i}p(x_{i}|\theta)
p(x_{i}|\theta)=Z_{\theta}(x_{i})
\displaystyle\min_{\phi}KL[q_{\phi}(\theta)||p(\theta|\{x_{i}\}_{i=1}^{N})].
\displaystyle\min_{\phi}KL[q_{\phi}(\theta)||p(\theta|\{x_{i}\}_{i=1}^{N})].
q_{\phi}(\theta)
p(\theta|\{x_{i}\}_{i=1}^{N})
p(\theta|\{x_{i}\}_{i=1}^{N})
q_{\phi}(\theta)
\theta
Z_{\theta}(s,a)
s_{t}
\theta\sim q_{\phi}(\theta)
a_{t}=\arg\max_{a}E[Z_{\theta}(s_{t},a)]
Z_{\theta}(s,a)
\theta
q_{\phi}(\theta)
\phi
\theta\sim q_{\phi}(\theta)
s_{t}
a_{t}=\arg\max_{a}E[Z_{\theta}(s_{t},a)]
s_{t+1}
r_{t}
s_{t},a_{t}
a^{\prime}=\arg\max_{a}E[r_{t}+\gamma Z_{\theta}(s_{t+1},a)]
r_{t}+\gamma Z_{\theta}(s_{t+1},a^{\prime})
\hat{Z}
\phi
Z_{\theta}(s,a)
Z_{\theta}(s,a)
\gamma
1
Z_{\theta}(s,a)
Q_{\theta}(s,a)
\sigma
\displaystyle\min_{\theta}\frac{1}{N}\sum_{i=1}^{N}\frac{(Q_{\theta}(s,a)-x_{i%
})^{2}}{2\sigma^{2}}.
\displaystyle\min_{\theta}\frac{1}{N}\sum_{i=1}^{N}\frac{(Q_{\theta}(s,a)-x_{i%
})^{2}}{2\sigma^{2}}.
E[Z_{\theta}(s,a)]=Q_{\theta}(s,a)
\displaystyle\min_{\phi}E_{\theta\sim q_{\phi}(\theta)}[\sum_{i=1}^{N}\frac{(Q%
_{\theta}(s,a)-x_{i})^{2}}{2\sigma^{2}}]-H(q_{\phi}(\theta)).
\displaystyle\min_{\phi}E_{\theta\sim q_{\phi}(\theta)}[\sum_{i=1}^{N}\frac{(Q%
_{\theta}(s,a)-x_{i})^{2}}{2\sigma^{2}}]-H(q_{\phi}(\theta)).
\tau
\alpha
\sigma^{2}
\phi,\phi^{-}
B\leftarrow\{\}
counter\leftarrow 0
e=1,2,3...E
counter\leftarrow counter+1
\theta\sim q_{\phi}(\theta)
s_{t}
a_{t}=\arg\max_{a}Q_{\theta}(s_{t},a)
s_{t+1}
r_{t}
\{s_{t},a_{t},r_{t},s_{t+1}\}
B
N
\theta_{j}^{-}\sim q_{\phi^{-}}(\theta^{-})
N
D=\{s_{j},a_{j},r_{j},s_{j}^{\prime}\}
B
x_{j}\sim r_{j}+\gamma Z_{\theta_{j}^{-}}(s_{j}^{\prime},a^{\prime})
j
D
a^{\prime}
Q_{\theta^{-}}(s_{j}^{\prime},a)
\Delta\phi
\phi\leftarrow\phi-\alpha\Delta\phi
counter\ \text{mod}\ \tau=0
\phi^{-}\leftarrow\phi
q_{\phi}(\theta)
\phi
q_{\phi^{-}}(\theta^{-})
\phi^{-}
\theta^{-}\sim q_{\phi^{-}}(\theta^{-})
B
\pi_{\theta_{p}}(s)
\theta_{p}
Q_{\theta}(s,a)
\theta
\displaystyle\nabla_{\theta_{p}}J=E[\sum_{t}\nabla_{a}Q^{\pi}(s,a)|_{a=\pi_{%
\theta_{p}}(s_{t})}\nabla_{\theta_{p}}\pi_{\theta_{p}}(s_{t})]
\displaystyle\nabla_{\theta_{p}}J
\displaystyle=E[\sum_{t}\nabla_{a}Q^{\pi}(s,a)|_{a=\pi_{\theta_{p}}(s_{t})}%
\nabla_{\theta_{p}}\pi_{\theta_{p}}(s_{t})]
\displaystyle\approx E[\sum_{t}\nabla_{a}Q_{\theta}(s,a)|_{a=\pi_{\theta_{p}}(%
s_{t})}\nabla_{\theta_{p}}\pi_{\theta_{p}}(s_{t})],
\displaystyle\approx E[\sum_{t}\nabla_{a}Q_{\theta}(s,a)|_{a=\pi_{\theta_{p}}(%
s_{t})}\nabla_{\theta_{p}}\pi_{\theta_{p}}(s_{t})],
Q^{\pi}(s,a)
Q_{\theta}(s,a)
Q_{\theta}(s,a)
\theta\sim q_{\phi}(\theta)
\hat{\theta}\sim q_{\phi}(\theta)
Q_{\hat{\theta}}(s,a)
\theta_{p}
\phi
\pi_{\theta_{p}}
Z_{\theta}(s,a)
q_{\phi}(\theta)
a\in\mathcal{A}
a
a
Z_{\theta}(a)
\mu_{a}
Z_{\theta}=\mathcal{N}(\mu_{a},\sigma^{2})
q_{\phi}(\mu)
p(\mu)
Z_{\theta}(a)
p(\mu|\{x_{i}\})
q_{\phi}(\mu)=p(\mu|\{x_{i}\})
a_{t}=\arg\max_{a}\mu(a)
\mu\sim q_{\phi}(\mu)=p(\mu|\{x_{i}\})
Z_{\theta}(s,a)\sim\mathcal{N}(Q_{\theta}(s,a),\sigma^{2})
q_{\phi}(\theta)
q_{\phi}(\theta)
p(\theta|\{x_{i}\})
Z_{\theta}(s,a)
\sigma^{2}
\sigma\rightarrow 0
\sigma
\theta
q_{\phi}(\theta)=\delta(\theta-\phi)
\theta
\theta
q_{\phi}(\theta)=\delta(\theta-\phi)
Z_{\theta}(s,a)
Z_{\theta}(s,a)
\epsilon-
N
N+9
\{\text{left},\text{right}\}
s_{i},1\leq i\leq N
s_{1},s_{N}
s_{1}
r=\frac{1}{1000}
s_{N}
r=1
s_{2}
s_{1}
s_{N}
2^{N-2}
N
s_{N}
s_{N}
N
N
r=1
r=0
r=-1
r=0
N
N=10
N=50
N=100
N=100
s_{2}
s_{N}
N=10
N=10
N=50
N=50
N=100
N=100
N=10
N=50
N=100
N=128
s_{i}
c_{i}=1
s_{i}
c_{i}=0
c_{i}
20
N=10
N=50
N=100
N=128
s_{i}
c_{i}=1
s_{i}
c_{i}=0
c_{i}
20
1
0
10
30
20
20
10
30
20
20
10
30
q_{\phi}(\theta)
\theta
\mu_{\theta}
\sigma_{\theta}
\sigma_{\theta}=\log(1+\exp(-\rho_{\theta}))
\rho_{\theta}
\rho_{\theta}
\theta
\rho_{\theta}
\rho
\rho\in[-1,-10]
\sigma^{2}
\sigma
\log_{10}\sigma\in[-1,-8]
\rho,\sigma
\rho
\sigma
\rho,\sigma
\sigma
\rho
\epsilon=0.1
\alpha\in\{10^{-3},10^{-4},10^{-5}\}
\rho
\rho
\sigma
\sigma
