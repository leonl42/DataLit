h_{cont}
h_{comp}
h_{comp}
h_{cont}
h_{mix}
h_{cont}
h_{cont}
h_{comp}
h_{mix}
R^{n}
h_{cont}
h_{comp}
h_{cont}
h_{cont}
i
e_{i}\in R^{m}
m
K
L
e\in R^{K\times m}
h_{cont}
h_{cont}\in R^{m}
h_{cont}
e^{K\times m}
h_{cont}
\begin{split}e_{o_{j}}&=\text{Discretize}(h_{cont}),\\
\text{where }o_{i}&=\mathop{\arg\min}_{j\in\{1,...,K\}}\|h_{cont}-e_{j}\|^{2}_%
{2},\end{split}
e_{j}
j
e
h_{cont}
h_{cont}
\mathop{\arg\min}
O=\text{RMSNorm}(\text{ReLU}(f(Q,K))),
Q=h_{cont}W_{Q}
K=eW_{K}
f
O
e
h_{comp}
h_{cont}
\mathop{\arg\min}
O\in R^{K}
h_{comp}
g(O,e)=OV
V=eW_{V}
h_{cont}
h_{comp}
h_{cont}
h_{mix}
h_{cont}
h_{cont}
h_{cont}
h_{comp}
x
N
i
x_{i}
h_{cont}^{i}
h_{comp}^{i}
H_{comp}=\{h_{comp}^{0},h_{comp}^{1},...,h_{comp}^{N}\}
H_{cont}=\{h_{cont}^{0},h_{cont}^{1},...,h_{cont}^{N}\}
h_{cont}^{0}
h_{comp}^{0}
H_{comp}
H_{cont}
H=\{h_{mix}^{0},h_{mix}^{1},...,h_{mix}^{N}\}
h_{m}ix^{i}
x_{i}
\begin{split}H&=\text{self-attention}([h_{comp},h_{cont}])\\
H&=\frac{1}{2}(H[:,:N,:]+H[:,N:,:])\end{split}
h_{cont}
h_{comp}
H
H
h_{cont}
h_{comp}
h_{mix}
x_{i}
i
N
e\in R^{K\times m}
O_{i}\in R^{K}
s_{i}\in R^{K}
\{0,1\}
x_{i}
s_{ij}=1
j
x_{i}
s_{ij}=0
L_{GD}
L_{GD}(x_{i})=\sum_{x_{i}\in x}\frac{sum((1-s_{i})\odot O_{i})}{sum(1-s_{i})}+%
L_{1}(O_{i})
h_{comp}
h_{mix}
h_{comp}
h_{cont}
sg
\beta\in[0,1)
\ell_{rc}=\|H_{comp}-sg(H_{cont})\|_{2}^{2}+\beta\|sg(H_{comp})-H_{cont}\|_{2}%
^{2}
h_{cont}
h_{comp}
h_{mix}
\ell_{ss}=\text{Ptask}(H_{comp})+\text{Ptask}(H_{cont})+\text{Ptask}(H)
H_{nu}=H_{cont}-H_{comp}
H_{nu}
\ell_{nm}=exp(-\text{Entropy}(H_{nu}))+exp(-\text{Ptask}(H_{nu}))
L_{SC}=\ell_{rc}+\ell_{ss}+\ell_{nm}
L=L_{task}+L_{GD}+L_{SC}
L_{task}
{}_{\text{cont}}
{}_{\text{comp}}
{}_{\text{mix}}
[CLS]
(A,B)
A
B
A
h_{comp}
h_{cont}
x_{i}
i
N
e\in R^{K\times m}
O_{i}\in R^{K}
s_{i}\in R^{K}
\{0,1\}
x_{i}
s_{ij}=1
j
x_{i}
s_{ij}=0
L_{GD}
L_{GD}(x_{i})=\sum_{x_{i}}\frac{sum((1-s_{i})\odot O_{i})}{sum(1-s_{i})}+L_{1}%
(O_{i})
sg
\beta=0.1
\ell_{rc}=\|h_{comp}-sg(h_{cont})\|_{2}^{2}+\beta\|sg(h_{comp})-h_{cont}\|_{2}%
^{2}
\begin{split}\ell_{ss}&=MLM(h_{comp})+MLM(h_{cont})\\
&+NSP(h_{comp})+NSP(h_{cont})\\
&+NSP(h_{mix})+NSP(h_{mix})\end{split}
H_{nu}=h_{cont}-h_{comp}
H_{nu}
\begin{split}\ell_{nm}&=exp(-Entropy(H_{nu}))\\
&+exp(-MLM(h_{cont}))+exp(-NSP(h_{comp}))\end{split}
L_{SC}=\ell_{rc}+\ell_{ss}+\ell_{nm}
L=L_{task}+L_{GD}+L_{SC}
L_{task}
A
B
A
\{10\%,30\%,50\%,70\%,90\%\}
\{1e^{-5},2e^{-5},3e^{-5},4e^{-5},5e^{-5}\}
\{256,128,64,32\}
4
