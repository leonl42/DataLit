\mathscr{X}
\mathscr{Y}=[L]\stackrel{{\scriptstyle.}}{{=}}\{1,2,\ldots,L\}
\mathbb{P}
\mathscr{X}\times\mathscr{Y}
S=\{(x_{n},y_{n})\}_{n\in[N]}
\mathbb{P}
h\colon\mathscr{X}\to{\mathscr{Y}}
R(h)=\mathbb{P}(y\neq h(x))
h
h(x)=\operatorname*{argmax}_{{y}^{\prime}\in\mathscr{Y}}f_{{y}^{\prime}}(x)
f\colon\mathscr{X}\to\mathbb{R}^{L}
f_{y}(x)=w_{y}^{\top}\Phi(x)
w_{y}
\Phi
p\colon\mathscr{X}\to\Delta^{L}
p_{y}(x)\propto\exp(f_{y}(x))
x\in\mathscr{X}
x\in\mathscr{X}
K
K
K\geq 2
p^{(1)},\ldots,p^{(K)}\colon\mathscr{X}\to\Delta^{L}
c^{(1)},\ldots,c^{(K-1)}\in[0,1]
x\in\mathscr{X}
k=1,2,\ldots,K-1
\max_{y^{\prime}}p^{(k)}_{y^{\prime}}(x)>c^{(k)}
\hat{y}=\operatorname*{argmax}_{y^{\prime}}p^{(k)}_{y^{\prime}}(x)
\hat{y}=\operatorname*{argmax}_{y^{\prime}}p^{(K)}_{y^{\prime}}(x)
\gamma(x)\stackrel{{\scriptstyle.}}{{=}}\max_{y^{\prime}}p(y^{\prime}\mid x)
K
\gamma(x)
K=2
h^{(1)},h^{(2)}\colon\mathscr{X}\to\mathscr{Y}
K>2
p^{(1)},p^{(2)}
i\in\{1,2\}
p_{y^{\prime}}^{(i)}(x)
y^{\prime}
x
h^{(i)}(x)\stackrel{{\scriptstyle.}}{{=}}\arg\max_{y^{\prime}}p_{y^{\prime}}^{%
(i)}(x)
r\colon\mathscr{X}\to\{0,1\}
h^{(1)}
r(x)=0
h^{(2)}
r(x)=1
h^{(2)}
h^{(2)}
c>0
r
h^{(2)}
\min_{r}\mathbb{P}(y\neq h^{(1)}(x),r(x)=0)+\mathbb{P}(y\neq h^{(2)}(x),r(x)=1%
)\quad\text{subject to}\quad\mathbb{P}(r(x)=1)\leq\tau,
\tau\in[0,1]
h^{(2)}
\tau
\eqref{eq:constrained_opt}
\tau
c\geq 0
\eqref{eq:constrained_opt}
\displaystyle R(r;h^{(1)},h^{(2)})=\mathbb{P}(y\neq h^{(1)}(x),r(x)=0)+\mathbb%
{P}(y\neq h^{(2)}(x),r(x)=1)+c\cdot\mathbb{P}(r(x)=1).
\displaystyle R(r;h^{(1)},h^{(2)})=\mathbb{P}(y\neq h^{(1)}(x),r(x)=0)+\mathbb%
{P}(y\neq h^{(2)}(x),r(x)=1)+c\cdot\mathbb{P}(r(x)=1).
c
c
(\tau,E)
\tau
E
{(c,c\cdot\tau+E):c\in[0,1]}
(c,R)
c
R
{(d,R-C\cdot d):d\in[0,1]}
R(r;h^{(1)},h^{(2)})
r\colon\mathscr{X}\to\{0,1\}
\eta_{y^{\prime}}(x)\stackrel{{\scriptstyle.}}{{=}}\mathbb{P}(y^{\prime}|x)
\displaystyle r^{*}(x)=\boldsymbol{1}\left[\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(%
x)}(x)>c\right],
\displaystyle r^{*}(x)
\displaystyle=\boldsymbol{1}\left[\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)>c%
\right],
h
\eta_{h(x)}(x)=\mathbb{P}(y=h(x)|x)
h
x
y
x
\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)
h^{(2)}
h^{(2)}
\eta
r
r^{*}
\alpha(x)\stackrel{{\scriptstyle.}}{{=}}\eta_{h_{1}(x)}(x)-\eta_{h_{2}(x)}(x)+c
r
R(r;h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})=\mathbb{E}_{x}[(\boldsymbol{1}(r%
(x)=1)-\boldsymbol{1}(\alpha(x)<0))\cdot\alpha(x)].
r^{*}
\hat{r}
\eta_{y^{\prime}}(x)=\mathbb{E}_{y\mid x}\left[\boldsymbol{1}[y=y^{\prime}]\right]
(x,y)
y
\hat{\eta}_{y^{\prime}}(x)=\boldsymbol{1}[y^{\prime}=y]
\displaystyle\hat{r}_{01}(x)\stackrel{{\scriptstyle.}}{{=}}\boldsymbol{1}\left%
[\boldsymbol{1}[y=h^{(2)}(x)]-\boldsymbol{1}[y=h^{(1)}(x)]>c\right].
\displaystyle\hat{r}_{01}(x)
\displaystyle\stackrel{{\scriptstyle.}}{{=}}\boldsymbol{1}\left[\boldsymbol{1}%
[y=h^{(2)}(x)]-\boldsymbol{1}[y=h^{(1)}(x)]>c\right].
c
y\neq h^{(1)}(x)
y=h^{(2)}(x)
y
\hat{r}_{{\rm 01}}
\displaystyle\text{ }\hat{r}_{{\rm prob}}(x)\stackrel{{\scriptstyle.}}{{=}}%
\boldsymbol{1}\left[p_{y}^{(2)}(x)-p_{y}^{(1)}(x)>c\right].
\displaystyle\text{ }\hat{r}_{{\rm prob}}(x)
\displaystyle\stackrel{{\scriptstyle.}}{{=}}\boldsymbol{1}\left[p_{y}^{(2)}(x)%
-p_{y}^{(1)}(x)>c\right].
p_{y}^{(2)}(x)
x
y
\hat{\eta}_{h^{(i)}(x)}(x)=\max_{y^{\prime}}p^{(i)}_{y^{\prime}}(x)
p^{(i)}
\mathbb{P}(y|x)\approx p_{y}^{(i)}(x)
i\in\{1,2\}
(x,y)
\eta_{h^{(i)}(x)}(x)=\mathbb{P}(h^{(i)}(x)|x)\approx p^{(i)}(h^{(i)}(x)|x)=%
\max_{y^{\prime}}p_{y^{\prime}}^{(i)}(x)
\displaystyle\text{ }\hat{r}_{{\rm rel}}(x)\stackrel{{\scriptstyle.}}{{=}}1%
\left[\max_{y^{\prime\prime}}p_{y^{\prime\prime}}^{(2)}(x)-\max_{y^{\prime}}p_%
{y^{\prime}}^{(1)}(x)>c\right].
\displaystyle\text{ }\hat{r}_{{\rm rel}}(x)
\displaystyle\stackrel{{\scriptstyle.}}{{=}}1\left[\max_{y^{\prime\prime}}p_{y%
^{\prime\prime}}^{(2)}(x)-\max_{y^{\prime}}p_{y^{\prime}}^{(1)}(x)>c\right].
h^{(1)}
h^{(2)}
r
c=0
K>2
p^{(1)},p^{(2)}
c^{(1)}>0
\hat{r}_{\rm conf}(x)=\boldsymbol{1}\left[\max_{y^{\prime}}p^{(1)}_{y^{\prime}%
}(x)<c^{(1)}\right].
r_{\rm conf}(x)\stackrel{{\scriptstyle.}}{{=}}\boldsymbol{1}\left[\eta_{h^{(1)%
}}(x)<c^{(1)}\right]
x,x^{\prime}\in\mathscr{X}
\eta_{h^{(1)}}(x)\leq\eta_{h^{(1)}}(x^{\prime})
\eta_{h^{(1)}}(x)-\eta_{h^{(2)}}(x)\leq\eta_{h^{(1)}}(x^{\prime})-\eta_{h^{(2)%
}}(x^{\prime})
\eta_{h^{(1)}}(x)
\eta_{h^{(1)}}(x)-\eta_{h^{(2)}}(x)
x\in\mathscr{X}
r_{\rm conf}
r_{\rm conf}
c^{(1)}
h^{(2)}
\eta_{h_{2}(x)}(x)
x\in\mathscr{X}
h^{(2)}
h^{(2)}
h^{(2)}
h^{(1)}
\mathscr{X}_{\rm good}\subset\mathscr{X}
h^{(2)}
\eta_{h^{(2)}(x)}\approx 1
x\in\mathscr{X}_{\rm good}
h^{(2)}
\mathscr{X}_{\rm bad}\stackrel{{\scriptstyle.}}{{=}}\mathscr{X}\setminus%
\mathscr{X}_{\rm good}
\eta_{h^{(2)}(x)}\approx 1/L
x\in\mathscr{X}_{\rm bad}
\eta_{h^{(1)}(x)}
x\in\mathscr{X}_{\rm bad}
h^{(2)}
h^{(1)}
x\in\mathscr{X}_{\rm good}
h^{(2)}
h^{(1)}
x\in\mathscr{X}_{\rm bad}\subset\mathscr{X}
x\in\mathscr{X}_{\rm bad}
h^{(1)},h^{(2)}
\eta_{h^{(1)}(x)}(x),\eta_{h^{(2)}(x)}(x)=1/L
\eta_{h^{(1)}(x)}(x)
x
h^{(2)}
\mathbb{P}(y\mid x)
p^{(1)}
z
1[y=h^{(2)}(x)]-1[y=h^{(1)}(x)]
g(x)>c
p^{(2)}_{y}(x)-p^{(1)}_{y}(x)
g(x)>c
\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x)
g(x)-\max_{y^{\prime}}p^{(1)}_{y^{\prime}}(x)>c
g(x)
\{(x_{i},z_{i})\}_{i=1}^{n}
z
(x,y)\in\mathscr{X}\times\mathscr{Y}
g(x)
\{(x_{i},z_{i})\}_{i=1}^{n}
z
(x,y)\in\mathscr{X}\times\mathscr{Y}
h^{(2)}
h^{(2)}
p^{(1)}
S_{\rm{val}}\stackrel{{\scriptstyle.}}{{=}}\{(x_{i},z^{(1)}_{i})\}
z_{i}^{(1)}=1[y=h^{(2)}(x_{i})]-1[y=h^{(1)}(x_{i})]
\min_{g\colon\mathscr{X}\to\mathbb{R}}\frac{1}{|S_{\rm{val}}|}\sum_{(x_{i},z^{%
(1)}_{i})\in S_{\rm val}}\ell(z^{(1)}_{i},g(x_{i})),
\ell
g(x)
z^{(2)}_{i}=p_{y}^{(2)}(x_{i})-p_{y}^{(1)}(x_{i})
z^{(3)}_{i}=\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x_{i})
p^{(2)}
p^{(2)}
p^{(2)}_{y^{\prime}}(x)=\mathbb{P}(y^{\prime}\mid x)
\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x)
\max_{y^{\prime}}\mathbb{P}(y^{\prime}\mid x)
\mathbb{P}(y\mid x)
p^{(1)}
p^{(1)}
\mathbb{P}(y\mid x)
p^{(2)}
p^{(2)}
z\stackrel{{\scriptstyle.}}{{=}}\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x)
z
\mathbb{E}[(z-\mathbb{E}[z])^{2}]
z
\mathbb{E}[z]
r^{*}=1[g^{*}(x)>c]
g^{*}(x)=\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)
S_{\rm val}
z^{(1)}_{i}
\hat{g}
\frac{1}{|S_{\rm{val}}|}\sum_{(x_{i},z_{i})\in S_{\rm val}}(z_{i}-g(x_{i}))^{2}
\mathcal{G}
\hat{r}(x)=1[\hat{g}(x)>c]
\mathcal{N}(\mathcal{G},\epsilon)
\mathcal{G}
\infty
g\in\mathcal{G}
(z-g(x))^{2}\leq B,\forall(x,z)
\tilde{g}
\mathbb{E}\left[(z-g(x))^{2}\right]
\mathcal{G}
z=1[y=h^{(2)}(x)]-1[y=h^{(1)}(x)]
\delta\in(0,1)
1-\delta
S_{\rm val}
\hat{r}
\displaystyle R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle\leq\,2\cdot\Bigg{(}\underbrace{\mathbb{E}_{x}\left[(\tilde{g}(x)%
-g^{*}(x))^{2}\right]}_{\text{Approximation error}}+\underbrace{4\cdot\inf_{%
\epsilon>0}\left\{B\sqrt{\frac{2\cdot\log\mathcal{N}(\mathcal{G},\epsilon)}{|S%
_{\rm val}|}}\right\}\,+\,\mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{|S_{\rm
val%
}|}}\right)}_{\text{Estimation error}}\Bigg{)}^{1/2}.
\displaystyle\leq\,2\cdot\Bigg{(}\underbrace{\mathbb{E}_{x}\left[(\tilde{g}(x)%
-g^{*}(x))^{2}\right]}_{\text{Approximation error}}+\underbrace{4\cdot\inf_{%
\epsilon>0}\left\{B\sqrt{\frac{2\cdot\log\mathcal{N}(\mathcal{G},\epsilon)}{|S%
_{\rm val}|}}\right\}\,+\,\mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{|S_{\rm
val%
}|}}\right)}_{\text{Estimation error}}\Bigg{)}^{1/2}.
h^{(2)}(x)
y
h^{(1)}
h^{(1)}
r
h^{(1)}
h^{(2)}
h^{(2)}
h^{(2)}
h^{(1)}
h^{(2)}
h^{(2)}
h^{(2)}
h^{(1)}
h^{(2)}
h^{(1)}
h^{(2)}
c
h^{(2)}
h^{(2)}
h^{(2)}
K>2
h^{(1)}
h^{(2)}
g\colon\mathscr{X}\to\mathbb{R}
g(x)=\mathrm{MLP}(p^{(1)}(x))
p^{(1)}(x)\in\Delta_{L}
g
g
g
p^{(1)}
h^{(2)}
\mathbb{P}(y\mid x)
L_{\rm noise}\in\{0,10,25\}
L_{\rm noise}=0
h^{(1)}
h^{(2)}
h^{(2)}
h\in\{100,50,25\}
100-h
h=100
h^{(1)}
h^{(2)}
h
h^{(2)}
\displaystyle R(r;h^{(1)},h^{(2)})
\displaystyle R(r;h^{(1)},h^{(2)})
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x),r(x)=0)+\mathbb{P}(y\neq h^{(2)}(x),%
r(x)=1)+c\cdot\mathbb{P}(r(x)=1)
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x),r(x)=0)+\mathbb{P}(y\neq h^{(2)}(x),%
r(x)=1)+c\cdot\mathbb{P}(r(x)=1)
\displaystyle=\mathbb{E}\left[1[y\neq h^{(1)}(x)]\cdot 1[r(x)=0]+1[y\neq h^{(2%
)}(x)]\cdot 1[r(x)=1]+c1[r(x)=1]\right]
\displaystyle=\mathbb{E}\left[1[y\neq h^{(1)}(x)]\cdot 1[r(x)=0]+1[y\neq h^{(2%
)}(x)]\cdot 1[r(x)=1]+c1[r(x)=1]\right]
\displaystyle=\mathbb{E}\left[1[y\neq h^{(1)}(x)]\cdot\left(1-1[r(x)=1]\right)%
+1[y\neq h^{(2)}(x)]\cdot 1[r(x)=1]+c1[r(x)=1]\right]
\displaystyle=\mathbb{E}\left[1[y\neq h^{(1)}(x)]\cdot\left(1-1[r(x)=1]\right)%
+1[y\neq h^{(2)}(x)]\cdot 1[r(x)=1]+c1[r(x)=1]\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}\left[-1[y\neq h^{(1)}(x)%
]\cdot 1[r(x)=1]+1[y\neq h^{(2)}(x)]\cdot 1[r(x)=1]+c1[r(x)=1]\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}\left[-1[y\neq h^{(1)}(x)%
]\cdot 1[r(x)=1]+1[y\neq h^{(2)}(x)]\cdot 1[r(x)=1]+c1[r(x)=1]\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1[r(x)=1]\mathbb{E}_{%
y|x}\left[1[y\neq h^{(2)}(x)]-1[y\neq h^{(1)}(x)]+c\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1[r(x)=1]\mathbb{E}_{%
y|x}\left[1[y\neq h^{(2)}(x)]-1[y\neq h^{(1)}(x)]+c\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1[r(x)=1]\mathbb{E}_{%
y|x}\left[1[y=h^{(1)}(x)]-1[y=h^{(2)}(x)]+c\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1[r(x)=1]\mathbb{E}_{%
y|x}\left[1[y=h^{(1)}(x)]-1[y=h^{(2)}(x)]+c\right]
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1[r(x)=1]\cdot\left[%
\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)+c\right],
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1[r(x)=1]\cdot\left[%
\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)+c\right],
\eta_{y^{\prime}}(x)\stackrel{{\scriptstyle.}}{{=}}\mathbb{P}(y=y^{\prime}\mid
x)
\displaystyle r(x)=1\iff\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)+c<0
\displaystyle r(x)=1
\displaystyle\iff\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)+c<0
\displaystyle\iff\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)>c.
\displaystyle\iff\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)>c.
h^{(1)},h^{(2)}
r^{*}
\alpha(x)\stackrel{{\scriptstyle.}}{{=}}\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}%
(x)+c
r^{*}
\displaystyle R(r^{*};h^{(1)},h^{(2)})=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}%
_{x}1\left[r^{*}(x)=1\right]\cdot\alpha(x).
\displaystyle R(r^{*};h^{(1)},h^{(2)})
\displaystyle=\mathbb{P}(y\neq h^{(1)}(x))+\mathbb{E}_{x}1\left[r^{*}(x)=1%
\right]\cdot\alpha(x).
r
\displaystyle R(r;h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle R(r;h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle=\mathbb{E}_{x}\left[1\left[r(x)=1\right]-1\left[\alpha(x)<0%
\right]\right]\cdot\alpha(x).
\displaystyle=\mathbb{E}_{x}\left[1\left[r(x)=1\right]-1\left[\alpha(x)<0%
\right]\right]\cdot\alpha(x).
h^{(1)},h^{(2)}\colon\mathscr{X}\to[L]
r_{1},r_{2}:\mathscr{X}\to\{0,1\}
\mathbb{E}\left(r_{1}(x)\beta(x)\right)=\mathbb{E}\left(r_{2}(x)\beta(x)\right)
\beta(x)\stackrel{{\scriptstyle.}}{{=}}\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)
r
\displaystyle A(r)=\mathbb{E}_{(x,y)}\left[\boldsymbol{1}[h^{(1)}(x)=y]\cdot(1%
-r(x))+\boldsymbol{1}[h^{(2)}(x)=y]\cdot r(x)\right]
\displaystyle A(r)
\displaystyle=\mathbb{E}_{(x,y)}\left[\boldsymbol{1}[h^{(1)}(x)=y]\cdot(1-r(x)%
)+\boldsymbol{1}[h^{(2)}(x)=y]\cdot r(x)\right]
\displaystyle=\mathbb{P}(h^{(1)}(x)=y)+\mathbb{E}\left[r(x)\cdot\left(%
\boldsymbol{1}[h^{(2)}(x)=y]-\boldsymbol{1}[h^{(1)}(x)=y]\right)\right]
\displaystyle=\mathbb{P}(h^{(1)}(x)=y)+\mathbb{E}\left[r(x)\cdot\left(%
\boldsymbol{1}[h^{(2)}(x)=y]-\boldsymbol{1}[h^{(1)}(x)=y]\right)\right]
\displaystyle=\mathbb{P}(h^{(1)}(x)=y)+\mathbb{E}_{x}r(x)\mathbb{E}_{y|x}\left%
[\boldsymbol{1}[h^{(2)}(x)=y]-\boldsymbol{1}[h^{(1)}(x)=y]\right]
\displaystyle=\mathbb{P}(h^{(1)}(x)=y)+\mathbb{E}_{x}r(x)\mathbb{E}_{y|x}\left%
[\boldsymbol{1}[h^{(2)}(x)=y]-\boldsymbol{1}[h^{(1)}(x)=y]\right]
\displaystyle=\mathbb{P}(h^{(1)}(x)=y)+\mathbb{E}_{x}r(x)\cdot\left(\eta_{h^{(%
2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)\right).
\displaystyle=\mathbb{P}(h^{(1)}(x)=y)+\mathbb{E}_{x}r(x)\cdot\left(\eta_{h^{(%
2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)\right).
r_{1},r_{2}
A(r_{1})=A(r_{2})\iff\mathbb{E}\left(r_{1}(x)\beta(x)\right)=\mathbb{E}\left(r%
_{2}(x)\beta(x)\right)
\beta(x)\stackrel{{\scriptstyle.}}{{=}}\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)
\displaystyle r_{\mathrm{conf}}(x)=\boldsymbol{1}\left[\eta_{h^{(1)}(x)}(x)<c^%
{\prime}\right],
\displaystyle r_{\mathrm{conf}}(x)
\displaystyle=\boldsymbol{1}\left[\eta_{h^{(1)}(x)}(x)<c^{\prime}\right],
\displaystyle r^{*}(x)=\boldsymbol{1}\left[\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(%
x)}(x)<c\right].
\displaystyle r^{*}(x)
\displaystyle=\boldsymbol{1}\left[\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)<c%
\right].
\eta_{i}(x)
\eta_{h^{(i)}(x)}(x)
z\stackrel{{\scriptstyle.}}{{=}}\eta_{1}(x)
z^{*}\stackrel{{\scriptstyle.}}{{=}}\eta_{1}(x)-\eta_{2}(x)
x\sim\mathbb{P}_{x}
\rho(c^{\prime})\stackrel{{\scriptstyle.}}{{=}}\mathbb{E}\left(\boldsymbol{1}%
\left[\eta_{1}(x)<c^{\prime}\right]\right)=\mathbb{P}\left(\eta_{1}(x)<c^{%
\prime}\right)
c^{\prime}
\rho^{*}(c)\stackrel{{\scriptstyle.}}{{=}}\mathbb{E}(\boldsymbol{1}\left[\eta_%
{1}(x)-\eta_{2}(x)<c\right]).
\gamma_{\alpha},\gamma_{\alpha}^{*}
\alpha
z
z^{*}
\rho(\gamma_{\alpha})=\rho^{*}(\gamma_{\alpha}^{*})=\alpha
A(r,c^{\prime})
r
c^{\prime}
r_{\mathrm{conf}}
\{(\rho(c^{\prime}),A(r_{\mathrm{conf}},c^{\prime}))\mid c^{\prime}\in[0,1]\}
\{(\alpha,A(r_{\mathrm{conf}},\gamma_{\alpha}))\mid\alpha\in[0,1]\}
\{(\alpha,A(r^{*},\gamma_{\alpha}^{*})\mid\alpha\in[0,1]\}
A(r_{\mathrm{conf}},\gamma_{\alpha})=A(r^{*},\gamma_{\alpha}^{*})
\alpha\in[0,1]
\displaystyle\mathbb{E}\left(\boldsymbol{1}[\eta_{1}(x)<\gamma_{\alpha}]\cdot%
\beta(x)\right)=\mathbb{E}\left(\boldsymbol{1}[\eta_{1}(x)-\eta_{2}(x)<\gamma_%
{\alpha}^{*}]\cdot\beta(x)\right),
\displaystyle\mathbb{E}\left(\boldsymbol{1}[\eta_{1}(x)<\gamma_{\alpha}]\cdot%
\beta(x)\right)
\displaystyle=\mathbb{E}\left(\boldsymbol{1}[\eta_{1}(x)-\eta_{2}(x)<\gamma_{%
\alpha}^{*}]\cdot\beta(x)\right),
\beta(x)\stackrel{{\scriptstyle.}}{{=}}\eta_{2}(x)-\eta_{1}(x)
\eta_{1}(x)
\eta_{1}(x)-\eta_{2}(x)
x\in\mathscr{X}
x\in\mathscr{X}
\alpha\in[0,1]
\eta_{1}(x)<\gamma_{\alpha}\iff\eta_{1}(x)-\eta_{2}(x)<\gamma_{\alpha}^{*}
\hat{r}
R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})\leq 2\sqrt{\mathbb{E}_{x}%
\left[(\hat{g}(x)-g^{*}(x))^{2}\right]}.
\hat{r}
\displaystyle R(\hat{r};h^{(1)},h^{(2)})=\mathbb{E}\left[1[y\neq h^{(1)}(x),%
\hat{g}(x)\leq c]+1[y\neq h^{(2)}(x),\hat{g}(x)>c]+c\cdot 1[\hat{g}(x)>c]\right]
\displaystyle R(\hat{r};h^{(1)},h^{(2)})
\displaystyle=\mathbb{E}\left[1[y\neq h^{(1)}(x),\hat{g}(x)\leq c]+1[y\neq h^{%
(2)}(x),\hat{g}(x)>c]+c\cdot 1[\hat{g}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(1-\eta_{h^{(1)}(x)}(x))\cdot 1[\hat{g}(x)%
\leq c]+(1-\eta_{h^{(2)}(x)}(x)+c)\cdot 1[\hat{g}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(1-\eta_{h^{(1)}(x)}(x))\cdot 1[\hat{g}(x)%
\leq c]+(1-\eta_{h^{(2)}(x)}(x)+c)\cdot 1[\hat{g}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)+c%
)\cdot 1[\hat{g}(x)>c]\right]+\mathbb{E}_{x}\left[1-\eta_{h^{(1)}(x)}(x)\right]
\displaystyle=\mathbb{E}_{x}\left[(\eta_{h^{(1)}(x)}(x)-\eta_{h^{(2)}(x)}(x)+c%
)\cdot 1[\hat{g}(x)>c]\right]+\mathbb{E}_{x}\left[1-\eta_{h^{(1)}(x)}(x)\right]
\displaystyle=\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]+%
\mathbb{E}_{x}\left[1-\eta_{h^{(1)}(x)}(x)\right].
\displaystyle=\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]+%
\mathbb{E}_{x}\left[1-\eta_{h^{(1)}(x)}(x)\right].
\hat{r}
\displaystyle R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle=\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]\,-%
\,\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[g^{*}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]\,-%
\,\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[g^{*}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]\,-%
\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[g^{*}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]\,-%
\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[g^{*}(x)>c]\right]
\displaystyle\hskip 28.45274pt\,+\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[%
g^{*}(x)>c]\right]\,-\,\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[g^{*}(x)>c]%
\right].
\displaystyle\hskip 28.45274pt\,+\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[%
g^{*}(x)>c]\right]\,-\,\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[g^{*}(x)>c]%
\right].
(-\hat{g}(x)+c)\cdot 1[g^{\prime}(x)>c]
g^{\prime}(x)=\hat{g}(x)
(-\hat{g}(x)+c)\cdot 1[g^{*}(x)>c]\geq(-\hat{g}(x)+c)\cdot 1[\hat{g}(x)>c]
\displaystyle R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle R(\hat{r};h^{(1)},h^{(2)})-R(r^{*};h^{(1)},h^{(2)})
\displaystyle\leq\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]%
\,-\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[\hat{g}(x)>c]\right]
\displaystyle\leq\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[\hat{g}(x)>c]\right]%
\,-\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[\hat{g}(x)>c]\right]
\displaystyle\hskip 28.45274pt\,+\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[%
g^{*}(x)>c]\right]\,-\,\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[g^{*}(x)>c]\right]
\displaystyle\hskip 28.45274pt\,+\,\mathbb{E}_{x}\left[(-\hat{g}(x)+c)\cdot 1[%
g^{*}(x)>c]\right]\,-\,\mathbb{E}_{x}\left[(-g^{*}(x)+c)\cdot 1[g^{*}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))\cdot 1[\hat{g}(x)>c]%
\right]\,+\,\mathbb{E}_{x}\left[(g^{*}(x)-\hat{g}(x))\cdot 1[g^{*}(x)>c]\right]
\displaystyle=\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))\cdot 1[\hat{g}(x)>c]%
\right]\,+\,\mathbb{E}_{x}\left[(g^{*}(x)-\hat{g}(x))\cdot 1[g^{*}(x)>c]\right]
\displaystyle\leq\mathbb{E}_{x}\left[|\hat{g}(x)-g^{*}(x)|\cdot(1[\hat{g}(x)>c%
]\,+\,1[g^{*}(x)>c])\right]
\displaystyle\leq\mathbb{E}_{x}\left[|\hat{g}(x)-g^{*}(x)|\cdot(1[\hat{g}(x)>c%
]\,+\,1[g^{*}(x)>c])\right]
\displaystyle\leq 2\cdot\mathbb{E}_{x}\left[|\hat{g}(x)-g^{*}(x)|\right]
\displaystyle\leq 2\cdot\mathbb{E}_{x}\left[|\hat{g}(x)-g^{*}(x)|\right]
\displaystyle\leq 2\cdot\mathbb{E}_{x}\left[\sqrt{(\hat{g}(x)-g^{*}(x))^{2}}\right]
\displaystyle\leq 2\cdot\mathbb{E}_{x}\left[\sqrt{(\hat{g}(x)-g^{*}(x))^{2}}\right]
\displaystyle\leq 2\cdot\sqrt{\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))^{2}%
\right]},
\displaystyle\leq 2\cdot\sqrt{\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))^{2}%
\right]},
\sqrt{\cdot}
g
\displaystyle{R}_{\rm sq}(g)=\mathbb{E}\left[(z-g(x))^{2}\right],
\displaystyle{R}_{\rm sq}(g)
\displaystyle=\mathbb{E}\left[(z-g(x))^{2}\right],
z=1[y=h^{(2)}(x)]-1[y=h^{(1)}(x)].
g:\mathscr{X}\rightarrow\mathbb{R}
\mathbb{E}[z|x]=\eta_{h^{(2)}(x)}(x)-\eta_{h^{(1)}(x)}(x)=g^{*}(x)
\hat{g}
\frac{1}{|S_{\rm{val}}|}\sum_{(x_{i},z_{i})\in S_{\rm val}}(z_{i}-g(x_{i}))^{2}
\mathcal{G}
S_{\rm{val}}
z_{i}=1[y_{i}=h^{(2)}(x_{i})]-1[y_{i}=h^{(1)}(x_{i})]
\mathcal{N}(\mathcal{G},\epsilon)
\mathcal{G}
\infty
g\in\mathcal{G}
(z-g(x))^{2}\leq B,\forall(x,z)
\tilde{g}
\mathbb{E}\left[(z-g(x))^{2}\right]
\mathcal{G}
z=1[y=h^{(2)}(x)]-1[y=h^{(1)}(x)]
\delta\in(0,1)
1-\delta
S_{\rm val}
\displaystyle\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))^{2}\right]
\displaystyle\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))^{2}\right]
\displaystyle\leq\,\underbrace{\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}%
\right]}_{\text{Approximation error}}+\underbrace{4\cdot\inf_{\epsilon>0}\left%
\{B\sqrt{\frac{2\cdot\log\mathcal{N}(\mathcal{G},\epsilon)}{|S_{\rm val}|}}%
\right\}\,+\,\mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{|S_{\rm val}|}}%
\right)}_{\text{Estimation error}}.
\displaystyle\leq\,\underbrace{\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}%
\right]}_{\text{Approximation error}}+\underbrace{4\cdot\inf_{\epsilon>0}\left%
\{B\sqrt{\frac{2\cdot\log\mathcal{N}(\mathcal{G},\epsilon)}{|S_{\rm val}|}}%
\right\}\,+\,\mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{|S_{\rm val}|}}%
\right)}_{\text{Estimation error}}.
1-\delta
S_{\rm val}
g\in\mathcal{G}
\displaystyle\left|R_{\rm sq}(g)-\hat{R}_{\rm sq}(g)\right|\,\leq\,2\cdot\inf_%
{\epsilon>0}\left\{\epsilon+B\sqrt{\frac{2\cdot\log\mathcal{N}(\mathcal{G},%
\epsilon)}{|S_{\rm val}|}}\right\}\,+\,\mathcal{O}\left(\sqrt{\frac{\log(1/%
\delta)}{|S_{\rm val}|}}\right).
\displaystyle\left|R_{\rm sq}(g)-\hat{R}_{\rm sq}(g)\right|\,\leq\,2\cdot\inf_%
{\epsilon>0}\left\{\epsilon+B\sqrt{\frac{2\cdot\log\mathcal{N}(\mathcal{G},%
\epsilon)}{|S_{\rm val}|}}\right\}\,+\,\mathcal{O}\left(\sqrt{\frac{\log(1/%
\delta)}{|S_{\rm val}|}}\right).
g
\displaystyle R_{\rm sq}(g)=\mathbb{E}_{x}\left[\mathbb{E}_{z|x}\left[(z-g(x))%
^{2}\right]\right]
\displaystyle R_{\rm sq}(g)
\displaystyle=\mathbb{E}_{x}\left[\mathbb{E}_{z|x}\left[(z-g(x))^{2}\right]\right]
\displaystyle=\mathbb{E}_{x}\left[\mathbb{E}_{z|x}\left[z^{2}\right]-2\cdot%
\mathbb{E}_{z|x}\left[z\right]\cdot g(x)+g(x)^{2}\right]
\displaystyle=\mathbb{E}_{x}\left[\mathbb{E}_{z|x}\left[z^{2}\right]-2\cdot%
\mathbb{E}_{z|x}\left[z\right]\cdot g(x)+g(x)^{2}\right]
\displaystyle=\mathbb{E}_{x}\left[\mathbb{E}_{z|x}\left[z\right]-2\cdot\mathbb%
{E}_{z|x}\left[z\right]\cdot g(x)+g(x)^{2}\right]+\mathbb{E}\left[z^{2}-z\right]
\displaystyle=\mathbb{E}_{x}\left[\mathbb{E}_{z|x}\left[z\right]-2\cdot\mathbb%
{E}_{z|x}\left[z\right]\cdot g(x)+g(x)^{2}\right]+\mathbb{E}\left[z^{2}-z\right]
\displaystyle=\mathbb{E}_{x}\left[(\mathbb{E}_{z|x}\left[z\right]-g(x))^{2}%
\right]+\mathbb{E}\left[z^{2}-z\right]
\displaystyle=\mathbb{E}_{x}\left[(\mathbb{E}_{z|x}\left[z\right]-g(x))^{2}%
\right]+\mathbb{E}\left[z^{2}-z\right]
\displaystyle=\mathbb{E}_{x}\left[(g^{*}(x)-g(x))^{2}\right]+\mathbb{E}\left[z%
^{2}-z\right].
\displaystyle=\mathbb{E}_{x}\left[(g^{*}(x)-g(x))^{2}\right]+\mathbb{E}\left[z%
^{2}-z\right].
g
g
\displaystyle R_{\rm sq}(g)-R_{\rm sq}(g^{*})=\mathbb{E}_{x}\left[(g(x)-g^{*}(%
x))^{2}\right].
\displaystyle R_{\rm sq}(g)-R_{\rm sq}(g^{*})=\mathbb{E}_{x}\left[(g(x)-g^{*}(%
x))^{2}\right].
\displaystyle\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))^{2}\right]=R_{\rm sq}(%
\hat{g})-R_{\rm sq}(g^{*})
\displaystyle\mathbb{E}_{x}\left[(\hat{g}(x)-g^{*}(x))^{2}\right]
\displaystyle=R_{\rm sq}(\hat{g})-R_{\rm sq}(g^{*})
\displaystyle=R_{\rm sq}(\hat{g})-R_{\rm sq}(\tilde{g})+R_{\rm sq}(\tilde{g})-%
R_{\rm sq}(g^{*})
\displaystyle=R_{\rm sq}(\hat{g})-R_{\rm sq}(\tilde{g})+R_{\rm sq}(\tilde{g})-%
R_{\rm sq}(g^{*})
\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}R_{\rm sq}(\hat{g})-R_{\rm sq}(%
\tilde{g})+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}\right]
\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}R_{\rm sq}(\hat{g})-R_{\rm sq}(%
\tilde{g})+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}\right]
\displaystyle=R_{\rm sq}(\hat{g})-\hat{R}_{\rm sq}(\tilde{g})+\hat{R}_{\rm sq}%
(\tilde{g})-R_{\rm sq}(\tilde{g})+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^%
{2}\right]
\displaystyle=R_{\rm sq}(\hat{g})-\hat{R}_{\rm sq}(\tilde{g})+\hat{R}_{\rm sq}%
(\tilde{g})-R_{\rm sq}(\tilde{g})+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^%
{2}\right]
\displaystyle\stackrel{{\scriptstyle(b)}}{{\leq}}R_{\rm sq}(\hat{g})-\hat{R}_{%
\rm sq}(\hat{g})+\hat{R}_{\rm sq}(\tilde{g})-R_{\rm sq}(\tilde{g})+\mathbb{E}_%
{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}\right]
\displaystyle\stackrel{{\scriptstyle(b)}}{{\leq}}R_{\rm sq}(\hat{g})-\hat{R}_{%
\rm sq}(\hat{g})+\hat{R}_{\rm sq}(\tilde{g})-R_{\rm sq}(\tilde{g})+\mathbb{E}_%
{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}\right]
\displaystyle\leq|R_{\rm sq}(\hat{g})-\hat{R}_{\rm sq}(\hat{g})|+|\hat{R}_{\rm
sq%
}(\tilde{g})-R_{\rm sq}(\tilde{g})|+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x)%
)^{2}\right]
\displaystyle\leq|R_{\rm sq}(\hat{g})-\hat{R}_{\rm sq}(\hat{g})|+|\hat{R}_{\rm
sq%
}(\tilde{g})-R_{\rm sq}(\tilde{g})|+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x)%
)^{2}\right]
\displaystyle\leq 2\cdot\sup_{g\in\mathcal{G}}\,|{R}_{\rm sq}(g)-\hat{R}_{\rm
sq%
}(g)|+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}\right],
\displaystyle\leq 2\cdot\sup_{g\in\mathcal{G}}\,|{R}_{\rm sq}(g)-\hat{R}_{\rm
sq%
}(g)|+\mathbb{E}_{x}\left[(\tilde{g}(x)-g^{*}(x))^{2}\right],
(a)
(b)
\hat{g}
\hat{R}_{\rm sq}
\mathcal{G}
h^{(1)}
h^{(2)}
8\times
8\times
8\times
8\times
8\times
h^{(1)}
h^{(2)}
g\colon\mathscr{X}\to\mathbb{R}
p^{(1)}(x)\in\Delta_{L}
L
v(p^{(1)}(x))\in\mathbb{R}^{D}
g(x)=\mathrm{MLP}(v(p^{(1)}(x)))
v
D=L+11
p^{(1)}(x)
p^{(1)}(x)
\arg\max_{y^{\prime}}p^{(1)}_{y^{\prime}}
L
\mathrm{FC}_{K}
K
\mathrm{FC}_{K,f}
K
f
\displaystyle g(x)=(\mathrm{FC}_{1}\circ\mathrm{FC}_{2^{4},\mathrm{ReLU}}\circ%
\mathrm{FC}_{2^{6},\mathrm{ReLU}}\circ v\circ p^{(1)})(x),
\displaystyle g(x)=(\mathrm{FC}_{1}\circ\mathrm{FC}_{2^{4},\mathrm{ReLU}}\circ%
\mathrm{FC}_{2^{6},\mathrm{ReLU}}\circ v\circ p^{(1)})(x),
g
g
\mathbb{P}(y\neq h^{(1)}(x)\land y=h^{(2)}(x)\mid x\in\mathscr{X}_{q})
q\in[0,1]
\mathscr{X}_{q}\stackrel{{\scriptstyle.}}{{=}}\{x\in\mathscr{X}\colon\max_{y^{%
\prime}}p^{(1)}_{y^{\prime}}(x)=q\}
q
q
10
h_{1}(x)\neq y\land h_{2}(x)=y
h_{1}(x)\neq y\land h_{2}(x)=y
h^{(1)}
h^{(1)}
h^{(2)}
h^{(1)}
h^{(2)}
h^{(1)}
h^{(2)}
h^{(2)}
h^{(2)}
h^{(1)}
h^{(2)}
\mathbb{P}(y=h^{(2)}(x))
x
\mathbb{P}(y=h^{(2)}(x))\sim 1
\mathbb{P}(y=h^{(2)}(x))\sim\frac{1}{L-\text{\#non-dog classes}}
y
p^{(1)}
p^{(2)}
\max_{y^{\prime}}p^{(1)}_{y^{\prime}}(x),\max_{y^{\prime}}p^{(2)}_{y^{\prime}}%
(x),\max_{y^{\prime\prime}}p^{(2)}_{y^{\prime\prime}}(x)-\max_{y^{\prime}}p^{(%
1)}_{y^{\prime}}(x),p^{(2)}_{y}(x)-p^{(1)}_{y}(x)
p^{(2)}_{y}(x)-p^{(1)}_{y}(x)
p^{(1)}
p^{(2)}
p^{(1)}
p^{(2)}
\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x)
\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x)
p^{(2)}
\max_{y^{\prime\prime}}p^{(2)}_{y^{\prime\prime}}(x)-\max_{y^{\prime}}p^{(1)}_%
{y^{\prime}}(x)
p_{y}^{(2)}(x)
(x,y)
\max_{y^{\prime}}p^{(1)}_{y^{\prime}}(x)
\max_{y^{\prime}}p^{(2)}_{y^{\prime}}(x)
K
h^{(1)},\ldots,h^{(K)}
K-1
k
h^{(k)}
h^{(k+1)}
K
h^{(1)},\ldots,h^{(K)}
c^{(1)},\ldots,c^{(K)}\in[0,1]
0=c^{(1)}\leq c^{(2)}\leq\ldots\leq c^{(K)}
s\colon\mathscr{X}\to[K]
K
x\in\mathscr{X}
R(s;h^{(1)},\ldots,h^{(K)})\stackrel{{\scriptstyle.}}{{=}}\mathbb{P}(y\neq h^{%
(s(x))}(x))+\mathbb{E}{}{[c^{(s(x))}]}.
s^{*}(x)=\underset{k\in[K]}{\operatorname*{argmin}}\,\mathbb{P}{(y\neq h^{(k)}%
(x))}+c^{(k)}.
\displaystyle R(s;{h}^{(1)},\ldots,h^{(K)})=\mathbb{P}(y\neq h^{(s(x))}(x))+%
\lambda\cdot\mathbb{E}{}{c^{(s(x))}}
\displaystyle R(s;{h}^{(1)},\ldots,h^{(K)})
\displaystyle=\mathbb{P}(y\neq h^{(s(x))}(x))+\lambda\cdot\mathbb{E}{}{c^{(s(x%
))}}
\displaystyle=\mathbb{E}_{x}{\mathbb{E}_{y\mid x}{1(y\neq h^{(s(x))}(x))}+%
\lambda\cdot c^{(s(x))}}.
\displaystyle=\mathbb{E}_{x}{\mathbb{E}_{y\mid x}{1(y\neq h^{(s(x))}(x))}+%
\lambda\cdot c^{(s(x))}}.
s
x\in\mathscr{X}
\displaystyle s^{*}(x)=\underset{k\in[K]}{\operatorname*{argmin}}\,\mathbb{E}_%
{y\mid x}{1(y\neq h^{(k)}(x))}+\lambda\cdot c^{(k)}.
\displaystyle s^{*}(x)
\displaystyle=\underset{k\in[K]}{\operatorname*{argmin}}\,\mathbb{E}_{y\mid x}%
{1(y\neq h^{(k)}(x))}+\lambda\cdot c^{(k)}.
K=2
K>2
h^{(k)}
r^{(k)}
\bar{h}^{(k)}
