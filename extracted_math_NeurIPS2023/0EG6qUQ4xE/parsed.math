x_{0}
x_{0}
x_{0}
x_{0}
x_{0}
q(x_{t}|x_{t-1})
x_{0}
p_{\theta}(x_{t-1}|x_{t})
f_{\theta}
x_{0}\sim q(x)
x_{1},...,x_{T}
q(x_{t}|x_{t-1})=\mathcal{N}(x_{t};\sqrt{1-\beta_{t}}x_{t-1},\beta_{t}\mathbf{%
I}),
\beta_{t}\in(0,1)
\beta_{t}
x_{0}
x_{t}
x_{0}
q(x_{t}|x_{0})=\mathcal{N}(x_{t};\sqrt{\bar{\alpha}_{t}}x_{0},\sqrt{1-\bar{%
\alpha}_{t}}\mathbf{I}),
\alpha_{t}=1-\beta_{t}
\bar{\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i}
q(x_{t-1}|x_{t})
\beta_{t}
p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t},t),\Sigma_{%
\theta}(x_{t},t)),
\mu_{\theta}(x_{t},t)
\Sigma_{\theta}(x_{t},t)
f_{\theta}
p(x_{T})=\mathcal{N}(x_{T};0,\mathbf{I})
p_{\theta}(x_{t-1}|x_{t})
x_{0}
x_{0}
\displaystyle\begin{aligned} \mathcal{L}_{\rm vlb}=&\mathbb{E}_{q}[\underbrace%
{D_{\rm KL}(q(x_{t}|x_{0})||p_{\theta}(x_{T}))}_{\mathcal{L}_{T}}]-\underbrace%
{\log p_{\theta}(x_{0}|x_{1})}_{\mathcal{L}_{0}}\\
&+\mathbb{E}_{q}[\sum_{t=2}^{T}\underbrace{D_{\rm KL}(q(x_{t-1}|x_{t},x_{0})||%
p_{\theta}(x_{t-1}|x_{t}))}_{\mathcal{L}_{t-1}}].\end{aligned}
\displaystyle\begin{aligned} \mathcal{L}_{\rm vlb}=&\mathbb{E}_{q}[\underbrace%
{D_{\rm KL}(q(x_{t}|x_{0})||p_{\theta}(x_{T}))}_{\mathcal{L}_{T}}]-\underbrace%
{\log p_{\theta}(x_{0}|x_{1})}_{\mathcal{L}_{0}}\\
&+\mathbb{E}_{q}[\sum_{t=2}^{T}\underbrace{D_{\rm KL}(q(x_{t-1}|x_{t},x_{0})||%
p_{\theta}(x_{t-1}|x_{t}))}_{\mathcal{L}_{t-1}}].\end{aligned}
\mathcal{L}_{t-1}
x_{0}
q(x_{t-1}|x_{t},x_{0})
\mathcal{L}_{\rm simple}
\mathcal{L}_{\rm simple}=\sum_{t=1}^{T}\mathbb{E}_{q}\big{[}||\mu_{t}(x_{t},x_%
{0})-\mu_{\theta}(x_{t},t)||^{2}\big{]},
\mu_{t}
q(x_{t-1}|x_{t},x_{0})
f_{\theta}
\mu_{t}
x_{t}
t
\epsilon_{t}
x_{0}
\mathcal{Y}_{T}
p(\mathcal{Y}|c)=\prod_{t=0}^{T-1}\prod_{i=1}^{n}p(y_{i}|\hat{\mathcal{Y}}_{t+%
1},c,t),
\mathcal{Y}
y_{i}
\hat{\mathcal{Y}}_{t+1}
t+1
c
t
\cdot
\cdot
x\in 1,...,K
[\mathbf{Q}_{t}]_{ij}=q(x_{t}=j|x_{t-1}=i)
x
q(x_{t}|x_{t-1})={\rm Cat}(x_{t};\bm{p}=x_{t-1}\mathbf{Q}_{t}),
x
{\rm Cat}(\cdot)
x
x_{t}
q(x_{t}|x_{0})={\rm Cat}(x_{t};\bm{p}=x_{0}\bar{\mathbf{Q}}_{t}),
\bar{\mathbf{Q}}_{t}=\prod_{i=1}^{t}\mathbf{Q}_{i}
q(x_{t-1}|x_{t},x_{0})
q(x_{t-1}|x_{t},x_{0})={\rm Cat}\big{(}x_{t-1};\bm{p}=\frac{x_{t}{\mathbf{Q}_{%
t}^{\top}}\odot x_{0}\bar{\mathbf{Q}}_{t-1}}{x_{0}\bar{\mathbf{Q}}_{t}x_{t}^{%
\top}}\big{)},
\odot
\mathcal{L}_{\rm vlb}
q
p_{\theta}
\mathbf{Q}_{t}
\beta_{t}
q_{\phi}(x_{0}|w)=\mathcal{N}({\rm EMB}(w),\sigma_{0}\mathbf{I})
{\rm EMB}(w)
w
p_{\theta}(w|x_{0})=\prod_{i=1}^{n}p_{\theta}(w_{i}|x_{0})
p_{\theta}(w_{i}|x_{i})
\mathcal{L}_{\rm vlb}^{{}^{\prime}}=\mathbb{E}_{q}[\mathcal{L}_{\rm vlb}+\log q%
_{\phi}(x_{0}|w)-\log p_{\theta}(w|x_{0})],
\displaystyle\begin{aligned} \mathcal{L}_{\rm simple}^{{}^{\prime}}=&\mathbb{E%
}_{q}[\mathcal{L}_{\rm simple}+||{\rm EMB}(w)-\mu_{\theta}(x_{1},t_{1})||^{2}%
\\
&-\log p_{\theta}(w|x_{0})].\end{aligned}
\displaystyle\begin{aligned} \mathcal{L}_{\rm simple}^{{}^{\prime}}=&\mathbb{E%
}_{q}[\mathcal{L}_{\rm simple}+||{\rm EMB}(w)-\mu_{\theta}(x_{1},t_{1})||^{2}%
\\
&-\log p_{\theta}(w|x_{0})].\end{aligned}
V
w
\tilde{\bm{w}}\in\{-K,+K\}^{|V|}
\tilde{w}_{(i)}=\left\{\begin{array}[]{cc}+K\quad{\rm when}\quad w=V_{(i)}\\
-K\quad{\rm when}\quad w\neq V_{(i)}\end{array}\right..
\mathcal{L}=\mathbb{E}_{x_{0},\epsilon,t}(||\epsilon-\hat{\epsilon}_{\theta}(x%
_{t},c)||^{2}_{2}),
\epsilon
c
A(\cdot)
A(x)={\rm softmax}(\frac{\mathbf{Q}\mathbf{K}^{\top}}{\sqrt{d}})\mathbf{V},
x
\mathbf{Q}
\mathbf{K}
\mathbf{V}
d
\beta
\beta_{t}
t
\beta_{t}
10^{-4}
0.02
\bar{\alpha}_{t}=\frac{f(t)}{f(0)}
f(t)=\cos(\frac{t/T+s}{1+s}\cdot\frac{\pi}{2})^{2}
\beta_{t}=(T-t+1)^{-1}
\bar{\alpha}_{t}=1-\sqrt{t/T+s}
x_{0}
\mu_{t}
x_{0}
\mu_{t}
q(x_{t-1}|x_{0},x_{t})
x_{0}
x_{0}
\mu_{t}
x_{0}
\mathcal{L}_{\rm simple}=\sum_{t=1}^{T}\mathbb{E}_{q}[||f_{\theta}(x_{t},t)-x_%
{0}||^{2}],
f_{\theta}
x_{0}
\mathcal{L}_{\rm round}=-\log p_{\theta}({w}|x_{0})
w
x_{0}
p_{\theta}({w}|x_{0})
x_{0}
w
\mathcal{L}_{\rm anchor}=-\log p_{\theta}({w}|\hat{x}_{0})
\mathcal{L}_{\rm round}
\hat{x}_{0}
x_{0}
\hat{x}_{0}
{w}
\bm{v}_{t}=[v_{t}^{(1)},v_{t}^{(2)}]
v_{t}^{(1)}\sim{\rm Bernouli}(\lambda_{t}^{(1)})
v_{t}^{(2)}\sim{\rm Bernouli}(\lambda_{t}^{(2)})
t
\mathcal{L}_{t}=\mathbb{E}[-\lambda_{t-1}^{(2)}\sum_{n=1}^{N}(1-b_{t,n})x_{0,n%
}^{\top}\log f(x_{t,n};\theta)],
b_{t}=1
x_{t}=x_{0}
0
f(x_{t},\theta)
x_{0}
c
c
c
c
c
p_{\theta}({x}_{t-1}|{x}_{t})=\mathcal{N}(x_{t-1};\mu_{\theta}+s\nabla\log p(c%
|x_{t-1}),\Sigma_{\theta}),
\nabla\log p(c|x_{t-1})
s
c
c
c
c
c
c
c
d
p
d^{\prime}
p
f_{\theta}(x_{t},t)
f_{\theta}(x_{t},t)
x_{t}
t
\tilde{x}_{0}
x_{t}
\tilde{x}_{0}
\tilde{x}_{0}
\hat{x}_{0}=f_{\theta}(x_{0},\emptyset,t)
\tilde{x}_{0}
B
t
\mathcal{L}_{\rm vlb}=\mathbb{E}_{t\sim p_{t}}\big{[}\frac{\mathcal{L}_{t}}{p_%
{t}}\big{]},p_{t}\propto\sqrt{\mathbb{E}[\mathcal{L}_{t}^{2}]},\sum_{t=0}^{T-1%
}p_{t}=1.
