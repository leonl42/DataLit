\eta
\psi
\eta
\psi
\eta
\psi
\times
\times
\eta
\psi
4\times 4
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\mathcal{M}=\langle\mathcal{S},\mathcal{A},p,\mu\rangle
\mathcal{S}
\mathcal{A}
p
p(s,a,s^{\prime})=\mathbb{P}(s^{\prime}|s,a)
\mu
s
\mu(s)
\tau=(s_{1},a_{1},...,a_{h-1},s_{h})
h
\pi
\tau_{h}=(s_{1},a_{1},...,a_{h-1},s_{h})
h
s_{t}
\boldsymbol{e}_{s_{t}}
\tau
\boldsymbol{\xi}_{\gamma,\tau}=\sum_{t=1}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}.
\gamma:\mathbb{N}\to[0,1]
\mathbb{N}
\sum_{t=1}^{h}\gamma(t)=1
\boldsymbol{\xi}_{\tau,\gamma}
\gamma(t)=\frac{1}{h}
t
\pi^{*}
\pi^{*}\in\arg\max_{\pi}H\big{(}\mathbb{E}_{\tau}\big{[}\boldsymbol{\xi}_{%
\gamma,\tau}\big{]}\big{)}
\pi
H(\boldsymbol{p})=-\sum_{i}\boldsymbol{p}_{i}\log\boldsymbol{p}_{i}
\boldsymbol{p}
\eta
\psi
\eta
\psi
\tau=(s_{1},a_{1},...,s_{T-1},a_{T-1},s_{T},...a_{h-1},s_{h})
T
T-1
\tau_{:T-1}=(s_{1},a_{1},...,s_{T-1})
T
\tau_{T:}=(s_{T},a_{T}...,a_{h-1},s_{h})
\displaystyle\boldsymbol{\xi}_{\gamma,\tau}=\sum_{t=1}^{T-1}\gamma(t)%
\boldsymbol{e}_{s_{t}}+\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}.
\displaystyle\boldsymbol{\xi}_{\gamma,\tau}
\displaystyle=\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}+\sum_{t=T}^{h}%
\gamma(t)\boldsymbol{e}_{s_{t}}.
\tau_{:T}
T
a_{T}
\pi
\tau_{:T}
a_{T}\in\mathcal{A}
\displaystyle\mathbb{E}_{\tau,\pi}\Big{[}\boldsymbol{\xi}_{\gamma,\tau}\Big{|}%
\tau_{:T},a_{T}\Big{]}
\displaystyle\mathbb{E}_{\tau,\pi}\Big{[}\boldsymbol{\xi}_{\gamma,\tau}\Big{|}%
\tau_{:T},a_{T}\Big{]}
\displaystyle=\mathbb{E}_{\tau,\pi}\Bigg{[}\sum_{t=1}^{T-1}\gamma(t)%
\boldsymbol{e}_{s_{t}}+\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Big{|}%
\tau_{:T},a_{T}\Bigg{]}
\displaystyle=\mathbb{E}_{\tau,\pi}\Bigg{[}\sum_{t=1}^{T-1}\gamma(t)%
\boldsymbol{e}_{s_{t}}+\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Big{|}%
\tau_{:T},a_{T}\Bigg{]}
\displaystyle=\underbrace{\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}}_{=%
\boldsymbol{\eta}(\tau_{:T-1})}+\underbrace{\mathbb{E}_{\tau_{T+1:},\pi}\Bigg{%
[}\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}%
}_{=\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})},
\displaystyle=\underbrace{\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}}_{=%
\boldsymbol{\eta}(\tau_{:T-1})}+\underbrace{\mathbb{E}_{\tau_{T+1:},\pi}\Bigg{%
[}\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}%
}_{=\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})},
\boldsymbol{\eta}(\tau_{:T-1})
\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})
\boldsymbol{\eta}
\boldsymbol{\psi}^{\pi}
\gamma
T
T
\boldsymbol{\xi}_{\gamma,\tau}
\boldsymbol{\eta}(\tau_{:T-1})
\lambda
\gamma
\boldsymbol{\eta}(\tau_{:T})
\boldsymbol{\eta}(\tau_{:T-1})
\eta
\psi
\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})=\mathbb{E}_{\tau_{T+1:},\pi}\left[%
\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\middle|\tau_{:T},a_{T}\right].
\tau_{:T}
\pi
\tau_{:T}
\tau_{:T}
a_{T}
T
\pi
\pi
\tau_{:T}
\eta
\psi
Q_{\text{expl}}
a_{T}
\displaystyle Q_{\text{expl}}(\tau_{:T},a_{T})=H\left(\boldsymbol{\eta}(\tau_{%
:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})\right),
\displaystyle Q_{\text{expl}}(\tau_{:T},a_{T})=H\left(\boldsymbol{\eta}(\tau_{%
:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})\right),
\pi
\tau_{:T}
\tau_{:T}
\boldsymbol{\psi}_{\boldsymbol{\theta}}
\boldsymbol{\psi}_{\boldsymbol{\theta}}
\boldsymbol{y}(\tau_{:T+1},a^{\prime}_{T+1})=\boldsymbol{e}_{s_{T}}+\gamma(T+1%
)\boldsymbol{\psi_{\theta}}(\tau_{:T+1},a^{\prime}_{T+1}),
\tau_{:T+1}
a_{T}
s_{T+1}
\tau_{:T}
\displaystyle a^{\prime}_{T+1}=\arg\max_{a\in\mathcal{A}}Q_{\text{expl}}(\tau_%
{:T+1},a).
\displaystyle a^{\prime}_{T+1}=\arg\max_{a\in\mathcal{A}}Q_{\text{expl}}(\tau_%
{:T+1},a).
\pi
\boldsymbol{\psi}_{\boldsymbol{\theta}}
\mathcal{L}_{SR}
\displaystyle\mathcal{L}_{SR}=||\boldsymbol{\psi}_{\boldsymbol{\theta}}(\tau_{%
:T},a_{T})-\boldsymbol{y}(\tau_{:T+1},a^{\prime}_{T+1})||^{2},
\displaystyle\mathcal{L}_{SR}
\displaystyle=||\boldsymbol{\psi}_{\boldsymbol{\theta}}(\tau_{:T},a_{T})-%
\boldsymbol{y}(\tau_{:T+1},a^{\prime}_{T+1})||^{2},
\boldsymbol{y}(\tau_{:T+1},a^{\prime}_{T+1})
Q_{\text{expl}}
\eta
\psi
\pi_{\mu}(\tau)
\mu
\boldsymbol{\psi}_{\theta}(\tau,a)
\tau
a
a^{\prime}_{T+1}=\pi_{\mu}(\tau_{:T+1})
\displaystyle\boldsymbol{y}=\boldsymbol{e}_{s_{T}}+\gamma(T+1)\boldsymbol{\psi%
}_{\theta}(\tau_{:T+1},a^{\prime}_{T+1}).
\displaystyle\boldsymbol{y}=\boldsymbol{e}_{s_{T}}+\gamma(T+1)\boldsymbol{\psi%
}_{\theta}(\tau_{:T+1},a^{\prime}_{T+1}).
\mathcal{L}_{SR}
\displaystyle\nabla_{\mu}J(\pi_{\mu})=\mathbb{E}_{\tau\sim\rho}\Big{[}\sum_{i}%
z_{i}\nabla_{\mu}\pi_{\mu}(\tau)\nabla_{a}\boldsymbol{\psi}_{i}(\tau,a)\big{|}%
_{a=\pi_{\mu}(\tau)}\Big{]},
\displaystyle\nabla_{\mu}J(\pi_{\mu})=\mathbb{E}_{\tau\sim\rho}\Big{[}\sum_{i}%
z_{i}\nabla_{\mu}\pi_{\mu}(\tau)\nabla_{a}\boldsymbol{\psi}_{i}(\tau,a)\big{|}%
_{a=\pi_{\mu}(\tau)}\Big{]},
z_{i}=-\log[\boldsymbol{\eta}(\tau_{:-1})_{i}+\boldsymbol{\psi}(\tau,\pi_{\mu}%
(\tau))_{i}]-1
i
z_{i}
\infty
z_{i}
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
5\times 5
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\psi(.)
T=7,14
\eta
\psi
5\times 5
(s,a)
\boldsymbol{\eta}
T
\eta
\psi
\psi(.)
T=7,14
\eta
\psi
5\times 5
(s,a)
\boldsymbol{\eta}
T
\gamma(t)=\frac{1}{h}
15
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
20
50
5\times 5
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
5\times 5
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\boldsymbol{\eta}
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
h
\psi^{\pi}(\tau_{:T},a)
\pi
\tau_{:T}
\eta
\psi
H\left(\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},a)\right)
\eta
\psi
\eta
\psi
\tau_{h},a
\boldsymbol{\psi}^{\pi}(\tau_{:h},a)\leftarrow\boldsymbol{e}_{s_{h}}
t=h,...,2
\tau_{:t},a
\pi(\tau_{:t})\leftarrow\arg\max_{a}H\left(\boldsymbol{\eta}(\tau_{:t-1})+%
\boldsymbol{\psi}^{\pi}(\tau_{:t},a)\right)
\boldsymbol{\psi}^{\pi}(\tau_{:t-1},a)\leftarrow\boldsymbol{e}_{s_{t-1}}+%
\gamma(t)\boldsymbol{\psi}^{\pi}(\tau_{:t},\pi(\tau_{:t}))
\pi
\pi(\tau)=\arg\max_{a}H(\boldsymbol{\eta}(\tau_{:-1})+\boldsymbol{\psi}(\tau,a))
\boldsymbol{\eta}
\boldsymbol{\psi}^{\pi}
\tau
a_{T}
T
\displaystyle\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},%
a_{T})=\underbrace{\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}}_{=%
\boldsymbol{\eta}(\tau_{:T-1})}+\underbrace{\mathbb{E}_{\tau_{T+1:},\pi}\Bigg{%
[}\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}%
}_{=\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})}
\displaystyle\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},%
a_{T})
\displaystyle=\underbrace{\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}}_{=%
\boldsymbol{\eta}(\tau_{:T-1})}+\underbrace{\mathbb{E}_{\tau_{T+1:},\pi}\Bigg{%
[}\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}%
}_{=\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})}
\displaystyle=\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}+\mathbb{E}_{\tau%
_{T+1:},\pi}\Bigg{[}\gamma(T)\boldsymbol{e}_{s_{T}}+\sum_{t=T+1}^{h}\gamma(t)%
\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}
\displaystyle=\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}+\mathbb{E}_{\tau%
_{T+1:},\pi}\Bigg{[}\gamma(T)\boldsymbol{e}_{s_{T}}+\sum_{t=T+1}^{h}\gamma(t)%
\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}
\displaystyle=\sum_{t=1}^{T}\gamma(t)\boldsymbol{e}_{s_{t}}+\mathbb{E}_{\tau_{%
T+1:},\pi}\Bigg{[}\sum_{t=T+1}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_%
{:T},a_{T}\Bigg{]}
\displaystyle=\sum_{t=1}^{T}\gamma(t)\boldsymbol{e}_{s_{t}}+\mathbb{E}_{\tau_{%
T+1:},\pi}\Bigg{[}\sum_{t=T+1}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_%
{:T},a_{T}\Bigg{]}
\displaystyle=\boldsymbol{\eta}(\tau_{:T})+\mathbb{E}_{\tau_{T+1:},\pi}\left[%
\boldsymbol{\psi}^{\pi}(\tau_{:T+1},\pi(\tau_{:T+1}))\middle|\tau_{:T},a_{T}\right]
\displaystyle=\boldsymbol{\eta}(\tau_{:T})+\mathbb{E}_{\tau_{T+1:},\pi}\left[%
\boldsymbol{\psi}^{\pi}(\tau_{:T+1},\pi(\tau_{:T+1}))\middle|\tau_{:T},a_{T}\right]
\pi^{*}
t
\tau_{:t}
t\leq h
\pi^{*}(\tau_{:t})\in\arg\max_{\pi}H(\boldsymbol{\eta}(\tau_{:t-1})+%
\boldsymbol{\psi}^{\pi}(\tau_{:t},\pi(\tau_{:t}))).
h
h
\pi_{t}
k
\tau_{:k}
t\leq k\leq h
\pi_{t}\in\arg\max_{\pi}H(\boldsymbol{\eta}(\tau_{:{k-1}})+\boldsymbol{\psi}^{%
\pi}(\tau_{:k},\pi(\tau_{:k}))).
\pi_{t}
t
h
\tau
t=1
t=h
\pi
h
\pi
h
\max_{\pi}H(\boldsymbol{\eta}(\tau_{:h-1})+\boldsymbol{\psi}^{\pi}(\tau_{:h},%
\pi(\tau_{:h})))=H(\boldsymbol{\eta}(\tau_{:h-1})+\gamma(h)\boldsymbol{e}_{s_{%
h}}).
t>1
\pi_{t}
H(\boldsymbol{\eta}(\tau_{:{k-1}})+\boldsymbol{\psi}^{\pi_{t}}(\tau_{:k},\pi_{%
t}(\tau_{:k})))
t\leq k\leq h
t-1
a
\displaystyle H(\boldsymbol{\eta}(\tau_{:t-2})+\boldsymbol{\psi}^{\pi_{t}}(%
\tau_{:t-1},a))=H(\boldsymbol{\eta}(\tau_{:t-2})+\gamma(t-1)\boldsymbol{e}_{s_%
{t-1}}+\mathbb{E}\left[\boldsymbol{\psi}^{\pi_{t}}(\tau_{:t},\pi_{t}(\tau_{:t}%
)\middle|s_{t-1},a\right])
\displaystyle H(\boldsymbol{\eta}(\tau_{:t-2})+\boldsymbol{\psi}^{\pi_{t}}(%
\tau_{:t-1},a))
\displaystyle=H(\boldsymbol{\eta}(\tau_{:t-2})+\gamma(t-1)\boldsymbol{e}_{s_{t%
-1}}+\mathbb{E}\left[\boldsymbol{\psi}^{\pi_{t}}(\tau_{:t},\pi_{t}(\tau_{:t})%
\middle|s_{t-1},a\right])
\displaystyle=H(\boldsymbol{\eta}(\tau_{:t-1})+\mathbb{E}\left[\boldsymbol{%
\psi}^{\pi_{t}}(\tau_{:t},\pi_{t}(\tau_{:t}))\middle|s_{t-1},a\right])
\displaystyle=H(\boldsymbol{\eta}(\tau_{:t-1})+\mathbb{E}\left[\boldsymbol{%
\psi}^{\pi_{t}}(\tau_{:t},\pi_{t}(\tau_{:t}))\middle|s_{t-1},a\right])
\displaystyle=H(\mathbb{E}\left[\boldsymbol{\eta}(\tau_{:t-1})+\boldsymbol{%
\psi}^{\pi_{t}}(\tau_{:t},\pi_{t}(\tau_{:t}))\middle|s_{t-1},a\right]).
\displaystyle=H(\mathbb{E}\left[\boldsymbol{\eta}(\tau_{:t-1})+\boldsymbol{%
\psi}^{\pi_{t}}(\tau_{:t},\pi_{t}(\tau_{:t}))\middle|s_{t-1},a\right]).
\pi_{t}
\pi_{t-1}
\pi_{t}
t
\pi_{t-1}(\tau_{:t-1})=\arg\max_{a}H(\boldsymbol{\eta}(\tau_{:t-2})+%
\boldsymbol{\psi}^{\pi_{t}}(\tau_{:t-1},a)),
t-1\leq k\leq h
\pi_{t-1}\in\arg\max_{\pi}H(\boldsymbol{\eta}(\tau_{:{k-1}})+\boldsymbol{\psi}%
^{\pi}(\tau_{:k},\pi(\tau_{:k}))).
\eta
\psi
\eta
\psi
\boldsymbol{\eta}
\boldsymbol{\psi}^{\pi}
\displaystyle\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},%
a_{T})=\underbrace{\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}}_{=%
\boldsymbol{\eta}(\tau_{:T-1})}+\underbrace{\mathbb{E}_{\tau_{T+1:},\pi}\Bigg{%
[}\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}%
}_{=\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})}
\displaystyle\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}^{\pi}(\tau_{:T},%
a_{T})
\displaystyle=\underbrace{\sum_{t=1}^{T-1}\gamma(t)\boldsymbol{e}_{s_{t}}}_{=%
\boldsymbol{\eta}(\tau_{:T-1})}+\underbrace{\mathbb{E}_{\tau_{T+1:},\pi}\Bigg{%
[}\sum_{t=T}^{h}\gamma(t)\boldsymbol{e}_{s_{t}}\Bigg{|}\tau_{:T},a_{T}\Bigg{]}%
}_{=\boldsymbol{\psi}^{\pi}(\tau_{:T},a_{T})}
\pi
\eta
\psi
\pi_{\mu}(\tau)
\tau
a\in\mathcal{A}
\tau_{:T}
\boldsymbol{\psi}_{\theta}(\tau,a)
\displaystyle Q_{\theta,\text{expl}}(\tau_{:T},a_{T})=H\left(\boldsymbol{\eta}%
(\tau_{:T-1})+\boldsymbol{\psi}_{\theta}(\tau_{:T},a_{T})\right),
\displaystyle Q_{\theta,\text{expl}}(\tau_{:T},a_{T})=H\left(\boldsymbol{\eta}%
(\tau_{:T-1})+\boldsymbol{\psi}_{\theta}(\tau_{:T},a_{T})\right),
a^{\prime}_{T+1}=\pi_{\mu}(\tau_{:T+1})
\displaystyle\boldsymbol{y}=\boldsymbol{e}_{s_{T}}+\gamma(T+1)\boldsymbol{\psi%
}_{\theta}(\tau_{:T+1},a^{\prime}_{T+1}).
\displaystyle\boldsymbol{y}=\boldsymbol{e}_{s_{T}}+\gamma(T+1)\boldsymbol{\psi%
}_{\theta}(\tau_{:T+1},a^{\prime}_{T+1}).
\mathcal{L}_{SR}
\displaystyle\mathcal{L}_{SR}=||\boldsymbol{\psi}_{\boldsymbol{\theta}}(\tau_{%
:T},a_{T})-\boldsymbol{y}(\tau_{:T+1},a^{\prime}_{T+1}).||^{2}
\displaystyle\mathcal{L}_{SR}
\displaystyle=||\boldsymbol{\psi}_{\boldsymbol{\theta}}(\tau_{:T},a_{T})-%
\boldsymbol{y}(\tau_{:T+1},a^{\prime}_{T+1}).||^{2}
\mu
\pi_{\mu}
\mu
J(\pi_{\mu})=\mathbb{E}_{\tau\sim\rho}[H(\boldsymbol{\eta}(\tau_{:-1})+%
\boldsymbol{\psi}(\tau,\pi_{\mu}(\tau))]
\nabla_{\mu}J(\pi_{\mu})=\mathbb{E}_{\tau\sim\rho}\Big{[}\sum_{i}z_{i}\nabla_{%
\mu}\pi_{\mu}(\tau)\nabla_{a}\boldsymbol{\psi}_{i}(\tau,a)\big{|}_{a=\pi_{\mu}%
(\tau)}\Big{]}.
z_{i}=-\log[\boldsymbol{\eta}(\tau_{:-1})_{i}+\boldsymbol{\psi}(\tau,\pi_{\mu}%
(\tau))_{i}]-1
H
\rho
T
\displaystyle H(\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}(\tau_{:T},a_{%
T}))=-\sum_{i}(\boldsymbol{\eta}(\tau_{:T-1})_{i}+\boldsymbol{\psi}(\tau_{:T},%
a_{T})_{i})\log((\boldsymbol{\eta}(\tau_{:T-1})_{i}+\boldsymbol{\psi}(\tau_{:T%
},a_{T})_{i}),
\displaystyle H(\boldsymbol{\eta}(\tau_{:T-1})+\boldsymbol{\psi}(\tau_{:T},a_{%
T}))
\displaystyle=-\sum_{i}(\boldsymbol{\eta}(\tau_{:T-1})_{i}+\boldsymbol{\psi}(%
\tau_{:T},a_{T})_{i})\log((\boldsymbol{\eta}(\tau_{:T-1})_{i}+\boldsymbol{\psi%
}(\tau_{:T},a_{T})_{i}),
a_{T}=\pi_{\mu}(\tau_{:T})
\boldsymbol{\eta}_{i}=\boldsymbol{\eta}(\tau_{:T-1})_{i}
\boldsymbol{\psi}_{i}=\boldsymbol{\psi}(\tau_{:T},a_{T})_{i}
i
\mu
\displaystyle\nabla_{\mu}H(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})=-%
\nabla_{\mu}\sum_{i}(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})\log(%
\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})
\displaystyle\nabla_{\mu}H(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})
\displaystyle=-\nabla_{\mu}\sum_{i}(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i%
})\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})
\displaystyle=-\sum_{i}[\nabla_{\mu}(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{%
i})\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})]
\displaystyle=-\sum_{i}[\nabla_{\mu}(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{%
i})\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})]
\displaystyle=-\sum_{i}[\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})%
\nabla_{\mu}(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})+(\boldsymbol{\eta}_{%
i}+\boldsymbol{\psi}_{i})\nabla_{\mu}\log(\boldsymbol{\eta}_{i}+\boldsymbol{%
\psi}_{i})]
\displaystyle=-\sum_{i}[\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})%
\nabla_{\mu}(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})+(\boldsymbol{\eta}_{%
i}+\boldsymbol{\psi}_{i})\nabla_{\mu}\log(\boldsymbol{\eta}_{i}+\boldsymbol{%
\psi}_{i})]
\displaystyle=-\sum_{i}[\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})%
\nabla_{\mu}\boldsymbol{\psi}_{i}+\nabla_{\mu}\boldsymbol{\psi}_{i}
\displaystyle=-\sum_{i}[\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})%
\nabla_{\mu}\boldsymbol{\psi}_{i}+\nabla_{\mu}\boldsymbol{\psi}_{i}
\displaystyle=-\sum_{i}[\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})+1]%
\nabla_{\mu}\boldsymbol{\psi}_{i}
\displaystyle=-\sum_{i}[\log(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})+1]%
\nabla_{\mu}\boldsymbol{\psi}_{i}
i
\displaystyle\nabla_{\mu}\boldsymbol{\psi}_{i}=\nabla_{\mu}\pi_{\mu}(\tau_{:T}%
)\nabla_{a}\boldsymbol{\psi}(\tau_{:T},a)_{i}|_{a=\pi_{\mu}(\tau_{:T})}
\displaystyle\nabla_{\mu}\boldsymbol{\psi}_{i}=\nabla_{\mu}\pi_{\mu}(\tau_{:T}%
)\nabla_{a}\boldsymbol{\psi}(\tau_{:T},a)_{i}|_{a=\pi_{\mu}(\tau_{:T})}
\nabla_{\mu}H(\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})=-\sum_{i}[\log(%
\boldsymbol{\eta}_{i}+\boldsymbol{\psi}_{i})+1]\nabla_{\mu}\pi_{\mu}(\tau_{:T}%
)\nabla_{a}\boldsymbol{\psi}(\tau_{:T},a)_{i}|_{a=\pi_{\mu}(\tau_{:T})}.
\displaystyle\nabla_{\mu}J(\pi_{\mu})=\mathbb{E}_{\tau\sim\rho}[\nabla_{\mu}H(%
\boldsymbol{\eta}(\tau_{:-1})+\boldsymbol{\psi}(\tau,\pi_{\mu}(\tau))]
\displaystyle\nabla_{\mu}J(\pi_{\mu})
\displaystyle=\mathbb{E}_{\tau\sim\rho}[\nabla_{\mu}H(\boldsymbol{\eta}(\tau_{%
:-1})+\boldsymbol{\psi}(\tau,\pi_{\mu}(\tau))]
\displaystyle=-\mathbb{E}_{\tau\sim\rho}\left[\sum_{i}[\log(\boldsymbol{\eta}_%
{i}+\boldsymbol{\psi}_{i})+1]\nabla_{\mu}\pi_{\mu}(\tau_{:T})\nabla_{a}%
\boldsymbol{\psi}(\tau_{:T},a)_{i}|_{a=\pi_{\mu}(\tau_{:T})}\right].
\displaystyle=-\mathbb{E}_{\tau\sim\rho}\left[\sum_{i}[\log(\boldsymbol{\eta}_%
{i}+\boldsymbol{\psi}_{i})+1]\nabla_{\mu}\pi_{\mu}(\tau_{:T})\nabla_{a}%
\boldsymbol{\psi}(\tau_{:T},a)_{i}|_{a=\pi_{\mu}(\tau_{:T})}\right].
\eta
\psi
\boldsymbol{\psi}_{\boldsymbol{\theta}}
\tau
\boldsymbol{\psi}_{\boldsymbol{\theta}}
\tau_{:T}
\eta
\psi
\eta
\psi
\theta
\mathcal{B}=\{\}
\boldsymbol{\eta}
\gamma
h
\tau_{exp}=\{s_{1},a_{1},..,s_{h}\}
\pi_{\theta}
\mathcal{B}
\mathcal{B}\cup\tau_{exp}
\tau=(s_{1},..a_{l-1},s_{l})
\sim
\mathcal{B}
l\in\{2,..,h\}
a^{\prime}
\arg\max_{a\in\mathcal{A}}H(\boldsymbol{\eta}(\tau)+\boldsymbol{\psi}_{\theta}%
(\tau,a))
\boldsymbol{y}=\boldsymbol{e}_{s_{l-1}}+\gamma(l)\boldsymbol{\psi}_{\theta}(%
\tau,a^{\prime})
||\boldsymbol{y}
\boldsymbol{\psi}_{\theta}(\tau_{:l-1},a_{l-1})||_{2}^{2}
a\in\mathcal{A}
\eta
\psi
\eta
\psi
\eta
\psi
\theta_{1}
\theta_{2}
\mu
\mathcal{B}=\{\}
\theta_{targ,1}=\theta_{1}
\theta_{targ,2}=\theta_{2}
\mu_{targ}\leftarrow\mu
\boldsymbol{\eta}
\gamma
h
\tau_{exp}=\{s_{1},a_{1},..,s_{h}\}
\pi_{\mu_{targ}}
\mathcal{B}
\mathcal{B}\cup\tau_{exp}
j
\tau=(s_{1},..a_{l-1},s_{l})
\sim
\mathcal{B}
l\in\{2,..,h\}
a^{\prime}=clip(\pi_{\mu_{targ}}(\tau_{:l})+clip(\epsilon,-c,c),a_{Low},a_{%
High}),\epsilon\sim\mathcal{N}(0,1)
\arg\min_{k\in\{1,2\}}
H
\boldsymbol{\eta}(\tau_{:l-1})
\boldsymbol{\psi}_{\theta_{k}}(\tau_{:l-1},a^{\prime}))
\boldsymbol{y}
\boldsymbol{e}_{s_{l}}
\gamma(l)
\boldsymbol{\psi}_{\theta_{i}}(\tau_{:l-1},a^{\prime})
||\boldsymbol{y}
\boldsymbol{\psi}_{\theta_{i}}(\tau_{:l-1},a_{l-1})||_{2}^{2}
i=1,2
\sum_{i}
z_{i}
\nabla_{a}
\boldsymbol{\psi}_{\theta_{1}}(\tau_{:l},a)
|_{a=\pi(\tau_{:l})}
\nabla_{\mu}
\pi_{\mu}(\tau_{:l})
z_{i}=-\log(\boldsymbol{\eta}(\tau_{:l})_{i}
\boldsymbol{\psi}_{\theta_{1}}(\tau_{:l},\pi_{\mu}(\tau_{:l}))_{i})+1
\theta_{targ,i}
\leftarrow
\rho\theta_{targ,i}+(1-\rho)\theta_{i}
i=1,2
\mu_{targ}\leftarrow\rho\mu_{targ}+(1-\rho)\mu
\eta
\psi
\eta
\psi
\eta
\psi
\alpha
\gamma
\alpha
\gamma
\gamma
\gamma
\tau_{:T}
i
\tau^{(i)}
\tau^{(1)}
15
\tau^{(2)}
\tau^{(3)}
T
\gamma(t)=\frac{\alpha^{T-t}}{Z}
\alpha
Z=\Sigma_{t=0}^{T}\alpha^{T-t}+\Sigma_{t=T}^{h}\alpha^{t-T}
\gamma
\gamma(t)=\frac{\alpha^{t-T}}{Z}
\gamma
\alpha=0.9,1.0
\tau^{(1)}
\tau^{(2)}
\tau^{(3)}
\tau^{(2)}
\tau^{(3)}
\alpha
\alpha=0.9
\gamma
\tau^{(3)}
\tau^{(2)}
\tau^{(1)}
\gamma
\alpha
5\times 5
5\times 5
h
h
h
h
h
\eta
\psi
\alpha
\gamma
\eta
\psi
\alpha\in\{0.9,0.95,0.98,0.99\}
\{64,128,256,512\}
\eta
\psi
\alpha\in\{0.9,0.95,0.98,0.99\}
\{64,128,256,512\}
\alpha
\gamma
\eta
\psi
\alpha\in\{0.9,0.95,0.98,0.99\}
\{64,128,256,512\}
\eta
\psi
\alpha\in\{0.9,0.95,0.98,0.99\}
\{64,128,256,512\}
\eta\psi
\eta
\psi
5\times 5
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\eta
\psi
\alpha
\alpha
\gamma
\alpha
\gamma
\alpha
\gamma
\alpha
\alpha
\alpha
\alpha=0.9
\alpha=0.95
\alpha
\eta
\alpha
\alpha
\alpha\neq 0.95
\alpha=0.95
\alpha
\eta
\psi
\eta
\psi
\eta
\psi
