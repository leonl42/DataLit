\bullet
\blacktriangle
\bullet
\blacktriangle
\varepsilon\!\!=\!\!1.0
\varepsilon\!\!=\!\!1.0
\varepsilon\!\!=\!\!0.1
\varepsilon\!\!=\!\!0.1
\varepsilon\!\!=\!\!0.05
\varepsilon\!\!=\!\!0.05
\bullet
\blacktriangle
K\!\!\!=\!\!50
\varepsilon
1/K\!\!=\!\!0.02
\bullet
\blacktriangle
K\!\!\!=\!\!50
\varepsilon
1/K\!\!=\!\!0.02
\bm{\mathbf{X}}
V
\bm{\mathbf{x}}
K
k
\bm{\mathbf{\beta}}_{k}\!\!\in\!\!\mathbb{R}^{V}
\bm{\mathbf{\beta}}\!\!=\!\!(\bm{\mathbf{\beta}}_{1},\dots,\bm{\mathbf{\beta}}%
_{K})\!\!\in\!\!\mathbb{R}^{V\times K}
\bm{\mathbf{\theta}}\!\in\!\Delta_{K}
\Delta_{K}
\Delta_{K}\!\!=\!\!\left\{\bm{\mathbf{\theta}}\in\mathbb{R}_{+}^{K}|\sum_{k=1}%
^{K}\!\theta_{k}\!\!=\!\!1\right\}
\bm{\mathbf{\beta}}\!\!=\!\!\bm{\mathbf{W}}^{\top}\bm{\mathbf{T}}
\bm{\mathbf{W}}\!\!=\!\!(\bm{\mathbf{w}}_{1},\dots,\bm{\mathbf{w}}_{V})\!\!\in%
\!\!\mathbb{R}^{D\times V}
V
\bm{\mathbf{T}}\!\!=\!\!(\bm{\mathbf{t}}_{1},\dots,\bm{\mathbf{t}}_{K})\!\!\in%
\!\!\mathbb{R}^{D\times K}
K
D
\bm{\mathbf{W}}
\bm{\mathbf{\theta}}
\bm{\mathbf{x}}
\bm{\mathbf{X}}
\bm{\mathbf{s}}
n_{\text{epoch}}
\Theta
\bm{\mathbf{W}}
\bm{\mathbf{T}}
1
n_{\text{epoch}}
(\bm{\mathbf{x}}^{(1)},\bm{\mathbf{x}}^{(2)},\dots,\bm{\mathbf{x}}^{(N)})
\bm{\mathbf{X}}
C_{jk}=\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}\quad\forall\;j,k
\bm{\mathbf{M}}=\exp(-\bm{\mathbf{C}}/\epsilon)
\bm{\mathbf{b}}\leftarrow\bm{\mathbf{\mathds{1}}}_{K}
\bm{\mathbf{a}}\leftarrow\frac{1}{V}\frac{\bm{\mathbf{\mathds{1}}}_{V}}{\bm{%
\mathbf{M}}\bm{\mathbf{b}}}
\bm{\mathbf{b}}\leftarrow\frac{\bm{\mathbf{s}}}{\bm{\mathbf{M}}^{\top}\bm{%
\mathbf{a}}}
\bm{\mathbf{\pi}}_{\varepsilon}^{*}\leftarrow\mathrm{diag}(\bm{\mathbf{a}})\bm%
{\mathbf{M}}\mathrm{diag}(\bm{\mathbf{b}})
\mathcal{L}_{\text{TM}}+\lambda_{\text{\scriptsize{ECR{}}}}\mathcal{L}_{\text{%
\scriptsize{ECR{}}}}
\Theta
\bm{\mathbf{W}}
\bm{\mathbf{T}}
\bm{\mathbf{w}}_{j}
\bullet
\bm{\mathbf{t}}_{k}
\blacktriangle
\pi_{\epsilon,jk}^{*}
\bm{\mathbf{t}}_{k}
n_{k}
\bm{\mathbf{w}}_{1}
\bm{\mathbf{w}}_{2}
\bm{\mathbf{t}}_{1}
\bm{\mathbf{t}}_{3}
\bm{\mathbf{t}}_{5}
\bm{\mathbf{w}}_{j}
\bullet
\bm{\mathbf{t}}_{k}
\blacktriangle
\pi_{\epsilon,jk}^{*}
\bm{\mathbf{t}}_{k}
n_{k}
\bm{\mathbf{w}}_{1}
\bm{\mathbf{w}}_{2}
\bm{\mathbf{t}}_{1}
\bm{\mathbf{t}}_{3}
\bm{\mathbf{t}}_{5}
\displaystyle\min_{\bm{\mathbf{W}},\bm{\mathbf{T}},\bm{\mathbf{p}}}\sum_{j=1}^%
{V}\sum_{k=1}^{K}\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}p_{jk},
\displaystyle\min_{\bm{\mathbf{W}},\bm{\mathbf{T}},\bm{\mathbf{p}}}\sum_{j=1}^%
{V}\sum_{k=1}^{K}\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}p_{jk},
\displaystyle\text{where}\quad p_{jk}=\frac{e^{-\|\bm{\mathbf{w}}_{j}-\bm{%
\mathbf{t}}_{k}\|^{2}/\tau}}{\sum_{k^{\prime}=1}^{K}e^{-\|\bm{\mathbf{w}}_{j}-%
\bm{\mathbf{t}}_{k^{\prime}}\|^{2}/\tau}}.
\displaystyle\text{where}\quad p_{jk}=\frac{e^{-\|\bm{\mathbf{w}}_{j}-\bm{%
\mathbf{t}}_{k}\|^{2}/\tau}}{\sum_{k^{\prime}=1}^{K}e^{-\|\bm{\mathbf{w}}_{j}-%
\bm{\mathbf{t}}_{k^{\prime}}\|^{2}/\tau}}.
p_{jk}
\bm{\mathbf{w}}_{j}
\bm{\mathbf{t}}_{k}
\bm{\mathbf{w}}_{j}
\tau
\sum_{j=1}^{V}\sum_{k=1}^{K}-p_{jk}\log p_{jk}
K
V
\bm{\mathbf{t}}_{k}
n_{k}
s_{k}\!\!=\!\!n_{k}/V
\bm{\mathbf{s}}\!=\!(s_{1},\dots,s_{K})^{\top}\!\!\in\!\!\Delta_{K}
n_{k}\!\!=\!\!V/K
\bm{\mathbf{s}}\!\!=\!\!(1/K,\dots,1/K)^{\top}
\bm{\mathbf{s}}
\bm{\mathbf{t}}_{k}
\bm{\mathbf{w}}_{j}
\gamma\!\!=\!\!\sum_{j=1}^{V}\frac{1}{V}\delta_{\bm{\mathbf{w}}_{j}}
\phi\!\!=\!\!\sum_{k=1}^{K}s_{k}\delta_{\bm{\mathbf{t}}_{k}}
\delta_{x}
x
\gamma
\phi
\displaystyle\operatorname*{arg\,min}_{\bm{\mathbf{\pi}}\in\mathbb{R}_{+}^{V%
\times K}}\mathcal{L}_{\text{\scriptsize{OT}}_{\varepsilon}}(\gamma,\phi),%
\quad\mathcal{L}_{\text{\scriptsize{OT}}_{\varepsilon}}(\gamma,\phi)=
\displaystyle\operatorname*{arg\,min}_{\bm{\mathbf{\pi}}\in\mathbb{R}_{+}^{V%
\times K}}\mathcal{L}_{\text{\scriptsize{OT}}_{\varepsilon}}(\gamma,\phi),%
\quad\mathcal{L}_{\text{\scriptsize{OT}}_{\varepsilon}}(\gamma,\phi)=
\displaystyle\sum_{j=1}^{V}\!\sum_{k=1}^{K}\!\|\bm{\mathbf{w}}_{j}\!-\!\bm{%
\mathbf{t}}_{k}\|^{2}\pi_{jk}+\sum_{j=1}^{V}\!\sum_{k=1}^{K}\varepsilon\pi_{jk%
}(\log(\pi_{jk})\!-\!1)
\displaystyle\sum_{j=1}^{V}\!\sum_{k=1}^{K}\!\|\bm{\mathbf{w}}_{j}\!-\!\bm{%
\mathbf{t}}_{k}\|^{2}\pi_{jk}+\sum_{j=1}^{V}\!\sum_{k=1}^{K}\varepsilon\pi_{jk%
}(\log(\pi_{jk})\!-\!1)
\displaystyle\text{s.t.}\quad\bm{\mathbf{\pi}}\bm{\mathbf{\mathds{1}}}_{K}=%
\frac{1}{V}\bm{\mathbf{\mathds{1}}}_{V}\quad\text{and}\quad\bm{\mathbf{\pi}}^{%
\top}\bm{\mathbf{\mathds{1}}}_{V}=\bm{\mathbf{s}}.
\displaystyle\text{s.t.}\quad\bm{\mathbf{\pi}}\bm{\mathbf{\mathds{1}}}_{K}=%
\frac{1}{V}\bm{\mathbf{\mathds{1}}}_{V}\quad\text{and}\quad\bm{\mathbf{\pi}}^{%
\top}\bm{\mathbf{\mathds{1}}}_{V}=\bm{\mathbf{s}}.
\mathcal{L}_{\text{\scriptsize{OT}}_{\varepsilon}}
\varepsilon
\bm{\mathbf{\pi}}_{\varepsilon}^{*}
\bm{\mathbf{w}}_{j}
\bm{\mathbf{t}}_{k}
C_{jk}\!\!=\!\!\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}
\bm{\mathbf{C}}\!\!\in\!\!\mathbb{R}^{V\times K}
\bm{\mathbf{w}}_{j}
\frac{1}{V}
\bm{\mathbf{t}}_{k}
s_{k}
\bm{\mathbf{\mathds{1}}}_{K}
\bm{\mathbf{\mathds{1}}}_{V}
K
V
{\pi}_{jk}
\bm{\mathbf{w}}_{j}
\bm{\mathbf{t}}_{k}
\bm{\mathbf{\pi}}\!\!\in\!\!\mathbb{R}_{+}^{V\times K}
\bm{\mathbf{\pi}}_{\varepsilon}^{*}
\bm{\mathbf{w}}_{j}
\bm{\mathbf{t}}_{k}
\pi^{*}_{\varepsilon,jk}
\displaystyle\mathcal{L}_{\text{\scriptsize{ECR{}}}}=\sum_{j=1}^{V}\sum_{k=1}^%
{K}\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}\pi^{*}_{\varepsilon,jk},\quad\quad
\displaystyle\mathcal{L}_{\text{\scriptsize{ECR{}}}}=\sum_{j=1}^{V}\sum_{k=1}^%
{K}\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}\pi^{*}_{\varepsilon,jk},\quad\quad
\displaystyle\text{where}\,\,\bm{\mathbf{\pi}}_{\varepsilon}^{*}\!=\!\mathrm{%
sinkhorn}(\gamma,\phi,\varepsilon)\!\approx\!\operatorname*{arg\,min}_{\bm{%
\mathbf{\pi}}\in\mathbb{R}_{+}^{V\times K}}\mathcal{L}_{\text{\scriptsize{OT}}%
_{\varepsilon}}(\gamma,\phi).
\displaystyle\text{where}\,\,\bm{\mathbf{\pi}}_{\varepsilon}^{*}\!=\!\mathrm{%
sinkhorn}(\gamma,\phi,\varepsilon)\!\approx\!\operatorname*{arg\,min}_{\bm{%
\mathbf{\pi}}\in\mathbb{R}_{+}^{V\times K}}\mathcal{L}_{\text{\scriptsize{OT}}%
_{\varepsilon}}(\gamma,\phi).
\bm{\mathbf{\pi}}_{\varepsilon}^{*}
\bm{\mathbf{\pi}}_{\varepsilon}^{*}
\bm{\mathbf{C}}
\pi^{*}_{\varepsilon,jk}
C_{jk}
\bm{\mathbf{w}}_{j}
\bm{\mathbf{t}}_{k}
\bm{\mathbf{\pi}}_{\varepsilon}^{*}
\bm{\mathbf{\pi}}^{*}_{\varepsilon}
\bm{\mathbf{\pi}}^{*}_{\varepsilon}
\varepsilon\!\rightarrow\!0
\varepsilon
\bm{\mathbf{w}}_{j}
\frac{1}{V}
\bm{\mathbf{t}}_{k}
s_{k}
\bm{\mathbf{\pi}}^{*}_{\varepsilon}
n_{k}
\bm{\mathbf{t}}_{k}
n_{k}\!\!\times\!\!\frac{1}{V}\!\!=\!\!s_{k}
\bm{\mathbf{\pi}}^{*}_{\varepsilon}
\bm{\mathbf{r}}
p(\bm{\mathbf{r}})\!=\!\mathcal{LN}(\bm{\mathbf{\mu}}_{0},\bm{\mathbf{\Sigma}}%
_{0})
\bm{\mathbf{\mu}}_{0}
\bm{\mathbf{\Sigma}}_{0}
\bm{\mathbf{\mu}}\!=\!f_{\bm{\mathbf{\mu}}}(\bm{\mathbf{x}})
\bm{\mathbf{\Sigma}}\!=\!\mathrm{diag}(f_{\bm{\mathbf{\Sigma}}}(\bm{\mathbf{x}%
}))
q_{\Theta}(\bm{\mathbf{r}}|\bm{\mathbf{x}})\!=\!\mathcal{N}(\bm{\mathbf{\mu}},%
\bm{\mathbf{\Sigma}})
\Theta
f_{\bm{\mathbf{\mu}}}
f_{\bm{\mathbf{\Sigma}}}
\bm{\mathbf{r}}\!=\!\bm{\mathbf{\mu}}+\bm{\mathbf{\Sigma}}^{1/2}\bm{\mathbf{%
\epsilon}}
\bm{\mathbf{\epsilon}}\sim\mathcal{N}(0,\bm{\mathbf{I}})
\bm{\mathbf{\theta}}
\bm{\mathbf{\theta}}\!=\!\mathrm{softmax}(\bm{\mathbf{r}})
\bm{\mathbf{\beta}}\in\mathbb{R}^{V\times K}
\bm{\mathbf{\beta}}
\bm{\mathbf{\beta}}
\bm{\mathbf{\beta}}
\bm{\mathbf{\beta}}
\bm{\mathbf{\pi}}^{*}_{\varepsilon}
\bm{\mathbf{\pi}}^{*}_{\varepsilon}
\bm{\mathbf{\beta}}
\beta_{jk}=\frac{e^{-\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k}\|^{2}/\tau}}{%
\sum_{k^{\prime}=1}^{K}e^{-\|\bm{\mathbf{w}}_{j}-\bm{\mathbf{t}}_{k^{\prime}}%
\|^{2}/\tau}}
\tau
\bm{\mathbf{\theta}}
\bm{\mathbf{\beta}}
\mathrm{Multi}(\mathrm{softmax}(\bm{\mathbf{\beta}}\bm{\mathbf{\theta}}))
N
(\bm{\mathbf{x}}^{(1)},\dots,\bm{\mathbf{x}}^{(N)})
\displaystyle\mathcal{L}_{\text{\scriptsize{TM}}}=\frac{1}{N}\sum_{i=1}^{N}-(%
\bm{\mathbf{x}}^{(i)})^{\top}\log(\mathrm{softmax}(\bm{\mathbf{\beta}}\bm{%
\mathbf{\theta}}^{(i)}))
\displaystyle\mathcal{L}_{\text{\scriptsize{TM}}}
\displaystyle=\frac{1}{N}\sum_{i=1}^{N}-(\bm{\mathbf{x}}^{(i)})^{\top}\log(%
\mathrm{softmax}(\bm{\mathbf{\beta}}\bm{\mathbf{\theta}}^{(i)}))
\displaystyle+\mathrm{KL}\left[q_{\Theta}(\bm{\mathbf{r}}^{(i)}|\bm{\mathbf{x}%
}^{(i)})\|p(\bm{\mathbf{r}}^{(i)})\right].
\displaystyle+\mathrm{KL}\left[q_{\Theta}(\bm{\mathbf{r}}^{(i)}|\bm{\mathbf{x}%
}^{(i)})\|p(\bm{\mathbf{r}}^{(i)})\right].
\mathcal{L}_{\text{TM}}
\mathcal{L}_{\text{\scriptsize{ECR{}}}}
\min_{\Theta,\bm{\mathbf{W}},\bm{\mathbf{T}}}\mathcal{L}_{\text{\scriptsize{TM%
}}}+\lambda_{\text{\scriptsize{ECR{}}}}\;\mathcal{L}_{\text{\scriptsize{ECR{}}}}
\lambda_{\text{\scriptsize{ECR{}}}}
K
K
K
K
K
K
K
K
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
K\!\!=\!\!50
K\!\!=\!\!100
{\ddagger}
C_{V}
K\!\!=\!\!50
K\!\!=\!\!100
{\ddagger}
K
K
K
K
K
K
K
K
K\!\!=\!\!50
K\!\!=\!\!100
{\ddagger}
K\!\!=\!\!50
K\!\!=\!\!100
{\ddagger}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
{\ddagger}
C_{V}
C_{V}
{\ddagger}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
K
K
K
K
K
K
K
K
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
K\!\!=\!\!10,20,30,40,60,70,80,90
C_{V}
K\!\!=\!\!10,20,30,40,60,70,80,90
K
K
K
K
K
K
K
K
K\!\!=\!\!10,20,30,40,60,70,80,90
K\!\!=\!\!10,20,30,40,60,70,80,90
\bullet
\blacktriangle
\bullet
\blacktriangle
\varepsilon
\mu_{0,k}=0
\Sigma_{0,kk}=(K-1)/(\alpha K)
\alpha
\alpha
1.0
K\!\!=\!\!50,100
K\!\!=\!\!10,20,30,40,60,70,80,90
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
C_{V}
K\!\!=\!\!50
K\!\!=\!\!50
