\mathcal{D}
N
\{\bm{x}_{i}\}_{i=1}^{N}
\bm{I}_{k}\in\mathbb{R}^{K}
K
I_{kk}=1
\bm{t}_{k}\in\mathbb{R}^{V}
\mathcal{D}
V
\bm{z}_{j}\in\mathbb{R}^{K}
\bm{x}_{j}\in\mathbb{R}^{V}
X
Z
\{\bm{x}_{i}\}_{i=1}^{N}
\bm{x}_{i}\in X
\{\bm{z}_{j}\}_{j=1}^{M}
\bm{z}_{j}\in Z
G
Z
X
E
X
Z
X
Z
G
E
X
Z
G
Z\rightarrow X
E
X\rightarrow Z
D_{X}
D_{Z}
G
E
E
G
E
E
\bm{x}_{i}\in\mathbb{R}^{V}
\bm{z}_{i}\in\mathbb{R}^{K}
\bm{x}_{i}\in X
i
\displaystyle\hat{d}_{ij}=\frac{d_{ij}}{\sum_{j}d_{ij}}\cdot\log\frac{N}{1+%
\sum_{n=1}^{N}\mathbbm{1}(d_{nj}\neq 0)},
\displaystyle\hat{d}_{ij}
\displaystyle=\frac{d_{ij}}{\sum_{j}d_{ij}}\cdot\log\frac{N}{1+\sum_{n=1}^{N}%
\mathbbm{1}(d_{nj}\neq 0)},
\displaystyle x_{ij}=\frac{\hat{d}_{ij}}{\sum_{v}\hat{d}_{iv}},
\displaystyle x_{ij}
\displaystyle=\frac{\hat{d}_{ij}}{\sum_{v}\hat{d}_{iv}},
d_{ij}
j
i
\mathbbm{1}(\cdot)
\bm{d}_{i}
G
[\,\operatorname{\text{Linear}}(V,H)
\rightarrow
\operatorname{\text{LeakyReLU}}(0.1)
\rightarrow
\operatorname{\text{BN}}
\rightarrow
\operatorname{\text{Linear}}(H,K)
\rightarrow
\operatorname{\text{Softmax}}\,]
\operatorname{\text{Linear}}(I,J)
I
J
H
\operatorname{\text{Softmax}}
G
E
\mathcal{D}
G
G
G
\bm{z}_{j}\in\mathbb{R}^{K}
\bm{x}_{j}\in\mathbb{R}^{V}
\bm{z}_{j}
\bm{z}_{j}
\bm{A}\in\mathbb{R}^{K}
\bm{A}_{k}=\alpha
1\leq k\leq K
\bm{z}_{j}
\bm{z}_{j}
Z
X
[\,\operatorname{\text{Linear}}(K,H)
\rightarrow
\operatorname{\text{LeakyReLU}}(0.1)
\rightarrow
\operatorname{\text{BN}}
\rightarrow
\operatorname{\text{Linear}}(H,V)
\rightarrow
\operatorname{\text{Softmax}}\,]
\operatorname{\text{Softmax}}
G
E
G
E
X
G
Z
E
G
E
G
D_{X}
\bm{x}\sim p_{\text{data}}(\bm{x})
G
G(\bm{z})
D_{X}
G
D_{X}
\bm{x}
G
X
G
D_{X}
\displaystyle\mathcal{L}_{\text{adv}}(G,D_{X})={}\mathbb{E}_{\bm{x}\sim p_{%
\text{data}}(\bm{x})}[D_{X}(\bm{x})]-
\displaystyle\mathcal{L}_{\text{adv}}(G,D_{X})={}
\displaystyle\mathbb{E}_{\bm{x}\sim p_{\text{data}}(\bm{x})}[D_{X}(\bm{x})]-
\displaystyle\mathbb{E}_{\bm{z}\sim p_{\text{data}}(\bm{z})}[D_{X}(G(\bm{z}))],
\displaystyle\mathbb{E}_{\bm{z}\sim p_{\text{data}}(\bm{z})}[D_{X}(G(\bm{z}))],
D
\mathcal{L}_{\text{adv}}(G,D_{X})
G
E
D_{Z}
\displaystyle\mathcal{L}_{\text{adv}}(E,D_{Z})={}\mathbb{E}_{\bm{z}\sim p_{%
\text{data}}(\bm{z})}[D_{Z}(\bm{z})]-
\displaystyle\mathcal{L}_{\text{adv}}(E,D_{Z})={}
\displaystyle\mathbb{E}_{\bm{z}\sim p_{\text{data}}(\bm{z})}[D_{Z}(\bm{z})]-
\displaystyle\mathbb{E}_{\bm{x}\sim p_{\text{data}}(\bm{x})}[D_{Z}(E(\bm{x}))].
\displaystyle\mathbb{E}_{\bm{x}\sim p_{\text{data}}(\bm{x})}[D_{Z}(E(\bm{x}))].
D_{X}
D_{Z}
[\,\operatorname{\text{Linear}}(S,H)
\rightarrow
\operatorname{\text{LeakyReLU}}(0.1)
\rightarrow
\operatorname{\text{BN}}
\rightarrow
\operatorname{\text{Linear}}(H,1)\,]
S
V
D_{X}
K
D_{Z}
\bm{x}\rightarrow E(\bm{x})\rightarrow G(E(\bm{x}))\approx\bm{x}
\bm{z}\rightarrow G(\bm{z})\rightarrow E(G(\bm{z}))\approx\bm{z}
\overrightarrow{\mathcal{L}_{\text{cyc}}}(G,E)
\overleftarrow{\mathcal{L}_{\text{cyc}}}(G,E)
\displaystyle\overrightarrow{\mathcal{L}_{\text{cyc}}}(G,E)=\mathbb{E}_{\bm{x}%
\sim p_{\text{data}}(\bm{x})}[\lVert G(E(\bm{x}))-\bm{x}\rVert_{1}],
\displaystyle\overrightarrow{\mathcal{L}_{\text{cyc}}}(G,E)=\mathbb{E}_{\bm{x}%
\sim p_{\text{data}}(\bm{x})}[\lVert G(E(\bm{x}))-\bm{x}\rVert_{1}],
\displaystyle\overleftarrow{\mathcal{L}_{\text{cyc}}}(G,E)=\mathbb{E}_{\bm{z}%
\sim p_{\text{data}}(\bm{z})}[\lVert E(G(\bm{z}))-\bm{z}\rVert_{1}],
\displaystyle\overleftarrow{\mathcal{L}_{\text{cyc}}}(G,E)=\mathbb{E}_{\bm{z}%
\sim p_{\text{data}}(\bm{z})}[\lVert E(G(\bm{z}))-\bm{z}\rVert_{1}],
\lVert\cdot\rVert_{1}
\mathcal{L}(G,E,D_{X},D_{Z})=\\
\mathcal{L}_{\text{adv}}(G,D_{X})+\mathcal{L}_{\text{adv}}(E,D_{Z})+\\
\lambda_{1}\overrightarrow{\mathcal{L}_{\text{cyc}}}(G,E)+\lambda_{2}%
\overleftarrow{\mathcal{L}_{\text{cyc}}}(G,E),
\lambda_{1}
\lambda_{2}
\overrightarrow{\mathcal{L}_{\text{cyc}}}(G,E)
\overleftarrow{\mathcal{L}_{\text{cyc}}}(G,E)
E
\bm{x}
\bm{z}
\bm{x}
C
\bm{x}
\bm{y}
\bm{x}
E
\bm{z}
\bm{z}
C
\bm{y}
{\mathcal{L}_{\text{cls}}}(E,C)=\\
-\mathbb{E}_{(\bm{x},\bm{y})\sim p_{\text{data}}(\bm{x},\bm{y})}[\bm{y}\log C(%
E(\bm{x}))],
L
\bm{y}
[\,\operatorname{\text{Linear}}(K,H)
\rightarrow
\operatorname{\text{LeakyReLU}}(0.1)
\rightarrow
\operatorname{\text{BN}}
\rightarrow
\operatorname{\text{Linear}}(H,L)
\rightarrow
\operatorname{\text{Softmax}}\,]
\mathcal{L}\text{sup}(G,E,D_{X},D_{Z},C)=\\
\mathcal{L}(G,E,D_{X},D_{Z})+\lambda_{3}\mathcal{L}_{\text{cls}}(E,C).
\beta_{1}
0.0001
0.5
G
E
D_{X}
D_{Z}
0.001
0.9
C
100
0.01
D_{X}
D_{Z}
G
E
D_{X}
D_{Z}
5
G
E
E
C
\lambda_{1}
\lambda_{2}
\mathcal{L}_{\text{adv}}(G,D_{X})
\overrightarrow{\mathcal{L}_{\text{cyc}}}(G,E)
\lambda_{1}
\lambda_{1}=\hat{\lambda}_{1}\frac{\lVert\partial\mathcal{L}_{\text{adv}}(G,D_%
{X})/\partial G(\bm{z})\rVert_{2}}{\lVert\partial\overrightarrow{\mathcal{L}_{%
\text{cyc}}}(G,E)/\partial G(\bm{z})\rVert_{2}},
\hat{\lambda}_{1}
\lVert\cdot\rVert_{2}
\mathcal{L}_{\text{adv}}(E,D_{Z})
\overleftarrow{\mathcal{L}_{\text{cyc}}}(G,E)
\mathcal{L}_{\text{adv}}(E,D_{Z})
\mathcal{L}_{\text{cls}}(E,C)
\hat{\lambda}_{2}
\hat{\lambda}_{3}
\hat{\lambda}_{1}
\hat{\lambda}_{2}
\hat{\lambda}_{3}
2
0.2
1
0.0770
0.1841
0.2292
0.2356
0.2145
0.1949
\bm{0.2444}
-
-
-
-0.5368
0.1255
0.3330
0.3749
0.3230
0.0451
\bm{0.3879}
-
-
-
-0.1461
0.0155
0.0806
0.0952
0.0814
-0.0290
\bm{0.0956}
-
-
-
0.0715
0.1483
0.2203
0.2108
0.1960
0.2064
\bm{0.2285}
-
-
-
-0.5188
-0.0651
0.2576
0.2312
0.1974
0.2150
\bm{0.2752}
-
-
-
-0.1225
-0.0193
0.0655
0.0608
0.0533
0.0592
\bm{0.0808}
-
-
-
0.1385
0.2653
0.2928
0.2355
0.2756
0.3010
\bm{0.3410}
0.2216
0.2966
\bm{0.3568}
-0.2970
0.2149
0.3397
0.3749
0.3516
0.2369
\bm{0.4327}
0.2581
0.1834
\bm{0.4981}
-0.1171
0.0212
0.1100
0.0951
0.1033
0.0661
\bm{0.1434}
0.0685
0.0526
\bm{0.1661}
0.1115
0.1776
0.1833
0.1991
0.1862
0.1777
\bm{0.2082}
0.1771
0.1811
\bm{0.2248}
-0.0632
0.0709
0.2572
0.2962
0.2816
0.2120
\bm{0.3137}
0.2621
0.2443
\bm{0.3563}
-0.0495
-0.0439
0.0379
0.0555
0.0637
0.0426
\bm{0.0656}
0.0554
0.0486
\bm{0.0709}
100,000
n
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\Delta
\downarrow
0.871
0.906
0.909
0.918
0.922
0.871
0.905
0.922
0.051
0.949
\bm{0.951}
0.948
0.920
0.900
0.900
0.934
0.951
0.051
\bm{0.951}
\bm{0.951}
\bm{0.953}
\bm{0.936}
\bm{0.928}
\bm{0.928}
\bm{0.944}
\bm{0.953}
\bm{0.025}
0.529
0.572
0.563
0.608
0.613
0.529
0.577
0.613
0.084
0.523
0.576
0.598
\bm{0.617}
0.610
0.523
0.585
0.617
0.094
\bm{0.642}
\bm{0.628}
\bm{0.616}
\bm{0.617}
\bm{0.616}
\bm{0.616}
\bm{0.624}
\bm{0.642}
\bm{0.026}
\Delta
\Delta
2.5\%
\Delta
20
100
0.025
0.026
