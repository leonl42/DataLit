\{w_{t}\}_{t=1}^{T}
T
\{h_{t}\}_{t=1}^{T}
h_{t}=\textrm{rnn}(x_{t},h_{(t-1)})
h_{t}
x_{t}
\{\alpha_{t}\}_{t=1}^{T}
t
\alpha_{t}
x_{t}
h_{t}
x_{t}
\alpha_{t}
x_{t}
\displaystyle\begin{gathered}e_{t}=\mathrm{emb}(x_{t})\\
h_{t}=\mathrm{rnn}(e_{t})\end{gathered}\begin{gathered}\alpha_{t}=\mathrm{attn%
}(h_{t})\\
s=\sum\alpha_{i}h_{i}\end{gathered}
\displaystyle\begin{gathered}e_{t}=\mathrm{emb}(x_{t})\\
h_{t}=\mathrm{rnn}(e_{t})\end{gathered}
\displaystyle\begin{gathered}\alpha_{t}=\mathrm{attn}(h_{t})\\
s=\sum\alpha_{i}h_{i}\end{gathered}
\mathrm{attn}
s
h^{\mathit{cat}}_{t}=[\mathrm{rnn}(e_{t});e_{t}]
[\cdot;\cdot]
h^{\mathit{res}}_{t}=e_{t}+\mathrm{rnn}(e_{t})
\mathcal{L}_{\mathit{tying}}=\frac{\delta}{T}\sum_{i}^{T}\left\lVert h_{t}-e_{%
t}\right\rVert_{2}^{2}
\delta
[1,10,20,30]
\delta
\displaystyle\hat{x_{t}}=\mathrm{mask}(x_{t})
\displaystyle\hat{x_{t}}
\displaystyle=\mathrm{mask}(x_{t})
\displaystyle\hat{e}_{t}=\mathrm{emb}(\hat{x}_{t})
\displaystyle\hat{e}_{t}
\displaystyle=\mathrm{emb}(\hat{x}_{t})
\displaystyle\hat{h}_{t}=\mathrm{rnn}(\hat{e}_{t})
\displaystyle\hat{h}_{t}
\displaystyle=\mathrm{rnn}(\hat{e}_{t})
\hat{h}_{t}
150
128
p_{\mathit{mlm}}
\eta
p_{\mathit{mlm}}
0.15
\eta
p_{\mathit{mlm}}
a
b
\mathcal{L}=\mathrm{TVD}(\hat{y}_{a},\hat{y}_{b})-\lambda\mathrm{JSD}(\alpha_{%
a},\alpha_{b})
\lambda
\displaystyle\mathrm{TVD}(\hat{y}_{a},\hat{y}_{b})=\frac{1}{2}\sum_{i=1}^{%
\left|\mathcal{Y}\right|}\left|y_{ai}-y_{bi}\right|
\displaystyle\mathrm{TVD}(\hat{y}_{a},\hat{y}_{b})
\displaystyle=\frac{1}{2}\sum_{i=1}^{\left|\mathcal{Y}\right|}\left|y_{ai}-y_{%
bi}\right|
\displaystyle\mathrm{JSD}(\alpha_{a},\alpha_{b})=\frac{1}{2}(\mathrm{KL}[%
\alpha_{a}||\bar{\alpha}]+\mathrm{KL}[\alpha_{b}||\bar{\alpha}])
\displaystyle\mathrm{JSD}(\alpha_{a},\alpha_{b})
\displaystyle=\frac{1}{2}(\mathrm{KL}[\alpha_{a}||\bar{\alpha}]+\mathrm{KL}[%
\alpha_{b}||\bar{\alpha}])
\bar{\alpha}=\frac{\alpha_{a}+\alpha_{b}}{2}
e_{t}
h_{t}
k=1000
k-
\frac{3}{4}
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
\alpha
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\mathbf{84.2}
-2.8
-5.0
83.7
-1.9
-4.7
83.5
\mathbf{-7.0}
\mathbf{-18.0}
82.8
-5.9
-15.6
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
\mathbf{84.3}
-2.6
-6.5
84.1
-3.4
-7.4
83.5
\mathbf{-9.9}
\mathbf{-20.0}
82.7
-3.0
-5.4
\mathbf{95.9}
-2.3
-3.9
\mathbf{95.9}
-1.5
-2.6
95.0
\mathbf{-3.3}
\mathbf{-14.6}
95.2
-1.5
-6.6
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
95.9
-2.3
-3.8
\mathbf{96.1}
-1.9
-3.0
95.4
\mathbf{-3.0}
\mathbf{-12.2}
95.4
-2.0
-5.3
90.9
-9.8
-14.1
91.3
-25.0
-28.2
91.4
-39.7
-43.2
\mathbf{91.5}
\mathbf{-76.3}
\mathbf{-66.0}
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
\mathbf{91.1}
-35.2
-36.8
91.0
-40.4
-37.1
90.9
-37.0
-42.8
89.1
\mathbf{-79.6}
\mathbf{-72.8}
\mathbf{88.3}
-10.0
-13.4
\mathbf{88.3}
-10.2
-14.0
87.1
\mathbf{-56.2}
\mathbf{-43.3}
87.5
-22.8
-26.5
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
\mathbf{88.2}
-18.6
-22.9
87.9
-17.2
-20.8
87.2
\mathbf{-57.7}
\mathbf{-45.3}
87.8
-15.3
-18.5
92.4
-21.6
-22.4
\mathbf{92.8}
-19.3
-22.2
91.3
-31.4
-27.6
89.7
\mathbf{-35.0}
\mathbf{-37.7}
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
\mathbf{92.7}
-10.2
-14.4
92.4
-15.2
-17.2
91.0
\mathbf{-91.0}
\mathbf{-59.7}
90.7
-37.8
-33.9
\Delta
\Delta
0
x_{t}
h_{t}
\sim
2.324
\mathbf{5.062}
4.870
3.662
2.435
\mathbf{4.289}
4.216
3.808
1.940
\mathbf{5.467}
4.075
3.845
2.078
\mathbf{4.518}
4.177
3.980
1.566
\mathbf{4.345}
3.985
3.677
1.828
\mathbf{3.843}
3.784
3.458
2.455
4.998
\mathbf{5.186}
3.728
2.682
\mathbf{4.366}
4.434
3.885
3.711
\mathbf{5.253}
4.239
4.016
3.780
\mathbf{4.477}
3.950
3.921
\begin{split}p_{\mathit{logit}}&=W_{d}(\sum_{i=1}^{T}\alpha_{i}h_{i})+b_{d}\\
&=\sum_{i=1}^{T}\alpha_{i}(W_{d}h_{i}+b_{d})\\
&=\sum_{i=1}^{T}\alpha_{i}\hat{p}_{t}\end{split}
\hat{p}_{t}
0.712
0.685
\mathbf{0.586}
0.630
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
0.693
0.701
\mathbf{0.600}
0.664
0.887
0.822
\mathbf{0.615}
0.695
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
0.862
0.876
\mathbf{0.646}
0.698
0.811
0.551
0.577
\mathbf{0.514}
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
0.687
0.755
0.516
\mathbf{0.482}
0.625
0.609
\mathbf{0.533}
0.562
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
0.590
0.608
\mathbf{0.539}
0.553
0.568
0.547
0.531
\mathbf{0.515}
\mathchoice{\mathbin{\vbox{\hbox{\scalebox{0.5}{$\displaystyle\bullet$}}}}}{%
\mathbin{\vbox{\hbox{\scalebox{0.5}{$\textstyle\bullet$}}}}}{\mathbin{\vbox{%
\hbox{\scalebox{0.5}{$\scriptstyle\bullet$}}}}}{\mathbin{\vbox{\hbox{\scalebox%
{0.5}{$\scriptscriptstyle\bullet$}}}}}
0.542
0.534
0.515
\mathbf{0.519}
300
150
1\mathrm{e}{-3}
5
32
1\mathrm{e}{-5}
0.15
\eta
\{0.1,0.3,1,3,5\}
\delta
\{10,20,30\}
\eta
\delta
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
1
\mathbf{84.2}
-2.8
-5.0
83.7
-1.9
-4.7
83.5
\mathbf{-7.0}
\mathbf{-18.0}
82.8
-5.9
-15.6
2
84.2
-1.0
-1.2
\mathbf{84.5}
-0.8
-4.6
84.1
-3.7
\mathbf{-14.5}
84.4
\mathbf{-3.8}
-5.9
3
84.2
-0.7
-0.7
83.3
-1.3
-1.3
\mathbf{84.6}
-2.7
-13.9
82.3
\mathbf{-7.3}
\mathbf{-18.0}
\mathbf{95.9}
-2.3
-3.9
\mathbf{95.9}
-1.5
-2.6
95.0
\mathbf{-3.3}
\mathbf{-14.6}
95.2
-1.5
-6.6
2
95.7
-0.3
-0.3
\mathbf{95.9}
-1.4
-2.0
95.5
\mathbf{-3.7}
\mathbf{-14.8}
95.6
-1.6
-3.8
3
\mathbf{95.9}
-0.0
-0.1
95.7
-1.0
-1.6
95.4
-2.0
-12.8
95.8
\mathbf{-13.2}
\mathbf{-62.5}
90.9
-9.8
-14.1
91.3
-25.0
-28.2
91.4
-39.7
-43.2
\mathbf{91.5}
\mathbf{-76.3}
\mathbf{-66.0}
2
93.7
-0.9
-5.6
\mathbf{94.0}
-6.3
-11.9
92.8
-17.5
-25.5
89.8
\mathbf{-31.6}
\mathbf{-35.0}
3
\mathbf{92.0}
0.0
0.0
91.5
-30.2
-35.7
89.0
\mathbf{-30.3}
\mathbf{-39.3}
88.5
-17.9
-17.4
\mathbf{88.3}
-10.0
-13.4
\mathbf{88.3}
-10.2
-14.0
87.1
\mathbf{-56.2}
\mathbf{-43.3}
87.5
-22.8
-26.5
2
88.4
-3.1
-3.8
\mathbf{88.9}
-7.2
-9.1
87.6
\mathbf{-51.2}
\mathbf{-41.1}
87.4
-14.5
-21.7
3
88.5
-1.2
-1.4
\mathbf{88.8}
-5.7
-7.8
87.9
-7.6
-21.3
87.1
\mathbf{-87.1}
\mathbf{-84.5}
\Delta
\Delta
\mathrm{Attention}(q,K,V)=\mathrm{softmax}(\frac{qK^{T}}{\sqrt{d_{k}}})V
q
K
V
\mathrm{Attention}(H)=\mathrm{softmax}(\frac{L_{q}(H)}{\sqrt{d_{k}}})H
L_{q}
L_{q}
\sqrt{5}
0.5
0.5
