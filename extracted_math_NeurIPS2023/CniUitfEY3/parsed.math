t
t+1
t
t+1
\tau
\tau
M
K
N
T
\tau
T
N
T
\tau\leq T
t+1
t+1
K
t
d_{s}
d_{cci}
\mathbf{MultiheadAttention(\cdot)}:
\mathbb{R}^{((\tau+1)\times N)\times d_{s}}\rightarrow\mathbb{R}^{d_{s}}
\phi(\cdot):
\mathbb{R}^{d_{s}}\rightarrow\mathbb{R}^{d_{\mathsf{cci}}}
\mathsf{cci}\in\mathbb{R}^{d_{\mathsf{cci}}}
N
T
M
\{g_{1},\dots,g_{M}\}
g_{i}(\cdot):\mathbb{R}^{d_{\mathsf{cci}}+d_{s}}\rightarrow\mathbb{R}^{d_{s}}
g_{i}(\cdot)
\psi(\cdot):
\mathbb{R}^{d_{\mathsf{cci}}+d_{s}}\rightarrow\mathbb{R}^{M}
s_{t}^{i}
s_{t}^{i}
s_{t}^{i}
N
\tau
t
s^{1:N}_{\tau^{*}:t}=\{s^{1}_{t-\tau+1},s^{2}_{t-\tau+1},\dots,s^{N}_{t-\tau+1%
},\dots,s^{1}_{t},s^{2}_{t},\dots,s^{N}_{t}\}
\tau^{*}=t-\tau+1
s^{\prime 1:N}_{t+1}
0<n\leq N
n-1
t+1
s^{\prime 1}_{t+1},\dots,s^{\prime n-1}_{t+1}
s^{n}_{t}
s^{\prime 1:N}_{t}
s^{1:N}_{\tau^{*}:t+1}
s^{\prime 1:N}_{t}
\mathbf{MultiheadAttention(\cdot)}
s^{1:N}_{\tau^{*}:t+1}
\phi(\cdot)
\mathsf{cci}
\mathsf{cci}=\phi(\mathbf{MultiheadAttention}(s^{1:N}_{\tau^{*}:t+1}))
s^{n}_{t}
\psi(\cdot)
\mathsf{cci}
s^{n}_{t}
\pi_{1:M}
M
\mathsf{Gumbel\text{-}softmax}
\psi
\pi_{1:M}=\mathsf{Gumbel\text{-}softmax}(\psi(\mathsf{cci},s^{n}_{t}))
s^{n}_{t}
\Delta s^{n}_{t}
s^{n}_{t}
t
t+1
\Delta s^{n}_{t}
k=\mathrm{argmax}(\pi_{1:M})
\Delta s^{n}_{t}=g_{k}(\mathsf{cci},s^{n}_{t})
s^{n}_{t+1}
s^{\prime n}_{t+1}
s^{n}_{t+1}
\displaystyle s^{\prime n}_{t+1}=s^{n}_{t}+\Delta s^{n}_{t}
\displaystyle s^{\prime n}_{t+1}=s^{n}_{t}+\Delta s^{n}_{t}
t
s^{\prime 1:N}_{t+1}
\mathcal{H}_{1}
\mathcal{H}_{2}
\mathcal{H}_{3}
\mathcal{H}_{1}
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
0.46
1.12
3.05
\mathsf{null}
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\mathcal{H}_{2}
96.8\%
94.3\%
3.1\%
65.0\%
68.1\%
t=1
t=2
t=3
t=5
t
t+1
t
t+1
\mathcal{H}_{2}
\mathcal{H}_{3}
\mathsf{null}
\text{RSM}_{!2}
\text{RSM}_{!3}
\text{RSM}_{\bar{k}}
\text{RSM}_{p}
\downarrow
\mathbf{{}_{\bar{k}}}
\mathbf{{}_{\bar{k}}}
\mathcal{H}_{3}
\mathbf{{}_{\bar{k}}}
k
\pi
\psi(\cdot)
N
N
M
\tau
T
K
d_{s}
d_{cci}
s^{1:N}_{\tau^{*}:t}=\{s^{1}_{t-\tau+1},s^{2}_{t-\tau+1},\dots,s^{N}_{t-\tau+1%
},\dots,s^{1}_{t},s^{2}_{t},\dots,s^{N}_{t}\}\in\mathbb{R}^{(\tau\times N)%
\times d_{s}}
\tau^{*}=t-\tau+1
N
\tau
t
s^{1:N}_{T+1:T+K}
N
K
T+1
T+K
\mathsf{cci}\in\mathbb{R}^{d_{cci}}
s^{n}_{t}\in\mathbb{R}^{d_{s}}
n^{th}
t
p\in\mathbb{R}^{M}
M
\Delta s^{n}_{t}\in\mathbb{R}^{d_{s}}
n
t
t+1
\mathbf{W_{q}}
\mathbf{W_{k}}
\mathbf{W_{v}}:
\mathbb{R}^{d_{s}}\rightarrow\mathbb{R}^{d_{s}}
s^{1:N}_{\tau^{*}:t}
\mathbf{MultiheadAttention(\cdot)}:
\mathbb{R}^{((\tau+1)\times N)\times d_{s}}\rightarrow\mathbb{R}^{d_{s}}
s^{1:N}_{\tau^{*}:t}
\phi(\cdot):
\mathbb{R}^{d_{s}}\rightarrow\mathbb{R}^{d_{\mathsf{cci}}}
\mathbf{MultiheadAttention(\cdot)}
\psi(\cdot):
\mathbb{R}^{d_{\mathsf{cci}}+d_{s}}\rightarrow\mathbb{R}^{M}
M
M
g_{j}(\cdot):
\mathbb{R}^{d_{cci}+d_{s}}\rightarrow\mathbb{R}^{d_{s}},j\in\{1\dots M\}
t
[T\dots t+K)
s^{1:N}_{\tau^{*}:t}=\mathrm{concat}(s^{1:N}_{\tau^{*}:t},s^{1:N}_{t})\in%
\mathbb{R}^{((\tau+1)\times N)\times d_{s}}
s_{t}^{n}
s^{1:N}_{t}
n\in{1\dots N}
\mathsf{cci}=\phi(\mathbf{MultiheadAttention}(\mathbf{W_{q}}(s^{1:N}_{\tau^{*}%
:{t+1}}),\ \mathbf{W_{k}}(s^{1:N}_{\tau^{*}:t+1}),\ \mathbf{W_{v}}(s^{1:N}_{%
\tau^{*}:t+1})))
s^{n}_{t}
p=\mathsf{Gumbel\text{-}max}(\psi(\mathrm{concat}(\mathsf{cci},s^{n}_{t}))
s^{n}_{t}
p
\Delta s^{n,j}_{t}=g_{j}(\mathrm{concat}(\mathsf{cci},s^{n}_{t}))*p^{j}
\forall j\in\{1,\dots,M\}
\Delta s^{n}_{t}=\sum_{j=1}^{M}\Delta s^{n,j}_{t}
s^{n}_{t+1}
s^{n}_{t+1}=s^{n}_{t}+\Delta s^{n}_{t}
s^{1:N}_{T+1:T+K}
K
V
K
V
T
V-T
V
T
\mathsf{2\times 10^{-4}}
\times
\times
\times
\times
N
d_{s}
T
\tau
K
V
\lambda
M
\psi(\cdot)
n
s^{n}_{T+k}
s^{*n}_{T+k}
\mathcal{L}_{S}=\frac{1}{K\cdot N}\sum^{K}_{k=1}\sum^{N}_{n=1}{\|s^{n}_{T+k}-s%
^{*n}_{T+k}\|}^{2}
f_{dec}
x_{T+k}
\mathcal{L}_{I}
\mathcal{L}_{I}=\frac{1}{K}\sum^{K}_{k=1}{\|f_{dec}(s_{T+k})-x_{T+k}\|}^{2}
\mathcal{L}=\mathcal{L}_{S}+\lambda\mathcal{L}_{I}
s^{*n}_{T+k}
f_{dec}(\cdot)
\tau\times N
\psi(\cdot)
2\times d_{s}
\psi(\cdot)
\psi
\psi
\psi(\cdot)
M
\psi(\cdot)
\psi(\cdot)
2\times d_{s}
M
\psi(\cdot)
\psi(\cdot)
5\times 5
\mathsf{UP}
\mathsf{RIGHT}
\mathsf{DOWN}
\mathsf{LEFT}
\mathsf{LEFT}
N
N
s^{*1:N}_{t+1}
s^{1:N}_{t+1}
\tilde{s}^{1:N}_{t}
\displaystyle H=\mathsf{MSE}(s^{1:N}_{t+1},s^{*1:N}_{t+1}),\quad\tilde{H}=%
\mathsf{MSE}(\tilde{s}^{1:N}_{t},s^{*1:N}_{t+1})
\displaystyle H=\mathsf{MSE}(s^{1:N}_{t+1},s^{*1:N}_{t+1}),\quad\tilde{H}=%
\mathsf{MSE}(\tilde{s}^{1:N}_{t},s^{*1:N}_{t+1})
\displaystyle Contrastive\ Loss:\mathcal{L}=H+\mathsf{max}(0,1-\tilde{H})
\displaystyle Contrastive\ Loss:\mathcal{L}=H+\mathsf{max}(0,1-\tilde{H})
\mathsf{BCE}
\mathsf{Decoder}
\mathcal{L}_{1}
\mathcal{L}_{2}
\mathcal{L}_{1}
x^{{}^{\prime}}_{t}
s^{1:N}_{t}
\mathsf{Decoder}
x_{t}
\mathcal{L}_{2}
x^{{}^{\prime}}_{t+1}
s^{1:N}_{t+1}
\mathsf{Decoder}
x_{t+1}
\displaystyle x^{\prime}_{t}=\mathsf{Decoder}(s^{1:N}_{t}),\quad x^{\prime 1:N%
}_{t+1}=\mathsf{Decoder}(s^{\prime 1:N}_{t+1})
\displaystyle x^{\prime}_{t}=\mathsf{Decoder}(s^{1:N}_{t}),\quad x^{\prime 1:N%
}_{t+1}=\mathsf{Decoder}(s^{\prime 1:N}_{t+1})
\displaystyle\mathcal{L}_{1}=\mathsf{BCE}(x^{\prime}_{t},x_{t}),\quad\mathcal{%
L}_{2}=\mathsf{BCE}(x^{\prime}_{t+1},x_{t+1})
\displaystyle\mathcal{L}_{1}=\mathsf{BCE}(x^{\prime}_{t},x_{t}),\quad\mathcal{%
L}_{2}=\mathsf{BCE}(x^{\prime}_{t+1},x_{t+1})
\displaystyle BCE\ Loss:\mathcal{L}_{Decoder}=\mathcal{L}_{1}+\mathcal{L}_{2}
\displaystyle BCE\ Loss:\mathcal{L}_{Decoder}=\mathcal{L}_{1}+\mathcal{L}_{2}
\mathsf{RIGHT}
\mathsf{UP}
\mathsf{LEFT}
\mathsf{DOWN}
\mathsf{UP}
\rightarrow
\mathsf{UP}
\mathsf{10\times 10}
\mathsf{Encoder}
\mathsf{3}\times\mathsf{50}\times\mathsf{50}
\mathsf{SlotDecoder}
