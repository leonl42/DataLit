\bullet
\bullet
\bullet
\bullet
x_{1:i-1}=\{x_{1},x_{2},...x_{i-1}\}
1
i-1
x_{i}
i
p(x_{i}|x_{1:i-1})=\int_{\mathcal{Z}}p(x_{i}|x_{1:i-1},z)p(z|x_{1:i-1})\,dz,
\mathcal{Z}
p(z|x_{1:i-1})
z
\mathcal{Z}
x_{1:i-1}
p(x_{i}|x_{1:i-1},z)
x_{i}
x_{1:i-1}
z
p(x_{i}|x_{1:i-1})
\mathcal{Z}
x_{1:i-1}
z^{*}
R=\{r_{1},r_{2},...,r_{n}\}
r_{i}
p(x_{i}|R,x_{1:i-1})
\displaystyle p(x_{i}|R,x_{1:i-1})=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z%
|R,x_{1:i-1})\,dz
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i%
-1})\,dz+p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1}).
\displaystyle=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i%
-1})\,dz+p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1}).
z^{*}
z^{*}
\displaystyle p(x_{i}|R,x_{1:i-1})=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z%
|R,x_{1:i-1})\,dz
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
r_{i}
R
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}%
\approx\textrm{log}\frac{\prod_{i=1}^{n}O(1)p(r_{i}|z)}{\prod_{i=1}^{n}O(1)p(r%
_{i}|z^{*})}
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle\approx\textrm{log}\frac{\prod_{i=1}^{n}O(1)p(r_{i}|z)}{\prod_{i=%
1}^{n}O(1)p(r_{i}|z^{*})}
\displaystyle\rightarrow n*\frac{1}{n}\sum_{i=1}^{n}log\frac{p(r_{i}|z)}{p(r_{%
i}|z*)}=n*\mathbb{E}_{r\sim P_{r}}\left[log\frac{p(r|z)}{p(r|z^{*})}\right]
\displaystyle\rightarrow n*\frac{1}{n}\sum_{i=1}^{n}log\frac{p(r_{i}|z)}{p(r_{%
i}|z*)}=n*\mathbb{E}_{r\sim P_{r}}\left[log\frac{p(r|z)}{p(r|z^{*})}\right]
\displaystyle\propto p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=p_{R}(r)%
\textrm{log}\frac{p_{R}(r)}{p(r|z^{*})}-p_{R}(r)\textrm{log}\frac{p_{R}(r)}{p(%
r|z)}
\displaystyle\propto p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=p_{R}(r)%
\textrm{log}\frac{p_{R}(r)}{p(r|z^{*})}-p_{R}(r)\textrm{log}\frac{p_{R}(r)}{p(%
r|z)}
\displaystyle=-(\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{Distribution%
 Completion: Benefit}}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_{\textbf{%
Distribution Contradiction: Detriment}}),
\displaystyle=-(\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{Distribution%
 Completion: Benefit}}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_{\textbf{%
Distribution Contradiction: Detriment}}),
p_{R}(\cdot)
p(\cdot)
v(z)
p_{R}(r)
p(r|z)
z
\mathcal{Z}
x_{i}
x_{i}
r
p_{R}(r)
p_{R}(r)
p(r|z)
x_{i}
x_{i}
p_{R}(r)
z^{*}
p(r|z^{*})
p(r|z^{*})
z^{*}
p(r|z^{*})
p_{R}(r)
p(r|z^{*})
p_{R}(r)
x_{i}
\mathcal{D}=\|p(x_{i}|R,x_{1:i-1})-p_{R}(x_{i}|x_{1:i-1})\|_{1}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
x_{i}
x_{1:i-1}
\mathcal{D}
\displaystyle\|\Phi\|_{1}-\sqrt{2\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))}\leq%
\mathcal{D}\leq\|\Phi\|_{1}+\sqrt{2\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))},
\displaystyle\|\Phi\|_{1}-\sqrt{2\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))}
\displaystyle\leq\mathcal{D}\leq\|\Phi\|_{1}+\sqrt{2\textnormal{KL}(p_{R}(r)\|%
p(r|z^{*}))},
\displaystyle\Phi\approx\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1%
},z)\textnormal{exp}\left[-(\underbrace{\textnormal{KL}(p_{R}(r)\|p(r|z))}_{%
\textnormal{{benefit}}}-\underbrace{\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))}_{%
\textnormal{{detriment}}}\right]p(z)\,dz,
\displaystyle\Phi\approx\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1%
},z)\textnormal{exp}
\displaystyle\left[-(\underbrace{\textnormal{KL}(p_{R}(r)\|p(r|z))}_{%
\textnormal{{benefit}}}-\underbrace{\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))}_{%
\textnormal{{detriment}}}\right]p(z)\,dz,
\alpha
\mathcal{D}
\frac{1}{\mathcal{D}}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\frac{1}{D}
\underbrace{\textnormal{KL}(p_{R}(r)\|p(r|z))}_{\textnormal{{benefit}}}-%
\underbrace{\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))}_{\textnormal{{detriment}}}%
\propto\frac{1}{\mathcal{D}}.
x_{i}
R
x_{i}
\frac{1}{D}
\frac{1}{D}
\frac{1}{D}
x_{i}
\mathcal{M}=\|p(x_{i}|R,x_{1:i-1})-p(x_{i}|x_{1:i-1})\|_{1}
p(x_{i}|R,x_{1:i-1})
p(x_{i}|x_{1:i-1})
\frac{1}{\mathcal{M}}
\frac{1}{\mathcal{D}}=\frac{1}{\mathcal{M}}
\frac{1}{\mathcal{D}}
\frac{1}{\mathcal{M}}
\displaystyle J=\begin{cases}\textnormal{KL}(p_{R}(r)\|p(r|z))<\textnormal{KL}%
(p_{R}(r)\|p(r|z^{*}))\text{, detriment outweighs benefit.}&\text{if }\frac{1}%
{\mathcal{D}}<\frac{1}{\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))=\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 detriment is equal to benefit.}&\text{if }\frac{1}{\mathcal{D}}=\frac{1}{%
\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))>\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 benefit outweighs detriment.}&\text{if }\frac{1}{\mathcal{D}}>\frac{1}{%
\mathcal{M}}\end{cases}
\displaystyle J=\begin{cases}\textnormal{KL}(p_{R}(r)\|p(r|z))<\textnormal{KL}%
(p_{R}(r)\|p(r|z^{*}))\text{, detriment outweighs benefit.}&\text{if }\frac{1}%
{\mathcal{D}}<\frac{1}{\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))=\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 detriment is equal to benefit.}&\text{if }\frac{1}{\mathcal{D}}=\frac{1}{%
\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))>\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 benefit outweighs detriment.}&\text{if }\frac{1}{\mathcal{D}}>\frac{1}{%
\mathcal{M}}\end{cases}
\frac{1}{\mathcal{D}}
\frac{1}{\mathcal{M}}
p(x_{i}|R,x_{1:i-1})
p(x_{i}|x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\frac{1}{\mathcal{D}}
\frac{1}{\mathcal{M}}
\frac{1}{\mathcal{D}}
\frac{1}{\mathcal{M}}
p(x_{i}|R,x_{1:i-1})
p(x_{i}|x_{1:i-1})
x_{1:i-1}
p_{R}(x_{i}|x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
x_{i}
x_{i}
x_{i}
R
R
x_{1:i-1}
R
p_{R}(x_{i}|x_{1:i-1})
x_{i}
x_{i}
R
x_{i}
R
0
5
5
23
x_{i}
R
24
32
x_{i}
R
x_{1:i-1}
\phi
\phi(h_{i}^{l})
h_{i}^{l}
x_{i}
l
l
\phi(h_{i}^{l-1})
\phi(h_{i}^{l})
C=\textrm{JSD}(\phi(h_{i}^{l-1})\|\phi(h_{i}^{l}))
l
\displaystyle D^{l}=|\textrm{JSD}(\phi(\tilde{h}_{i}^{l-1})\|\phi(\tilde{h}_{i%
}^{l}))-\textrm{JSD}(\phi(h_{i}^{l-1})\|\phi(h_{i}^{l}))|,
\displaystyle D^{l}=|\textrm{JSD}(\phi(\tilde{h}_{i}^{l-1})\|\phi(\tilde{h}_{i%
}^{l}))-\textrm{JSD}(\phi(h_{i}^{l-1})\|\phi(h_{i}^{l}))|,
\tilde{h}_{i}^{l-1}
\tilde{h}_{i}^{l}
h_{i}^{l-1}
h_{i}^{l}
D^{l}
0
23
24
32
p(x_{i}|R,x_{1:i-1})
f(l)
x_{i}
g(l)
l
\displaystyle l^{*}=\lfloor\frac{1}{2}(\arg\max_{l}f(l)+\min\{l:g(l)>a\})\rfloor.
\displaystyle l^{*}=\lfloor\frac{1}{2}(\arg\max_{l}f(l)+\min\{l:g(l)>a\})\rfloor.
l
f(l)
l
g(l)
a
l^{*}
R=[rt_{1},rt_{2},...,rt_{m}]
rt
R
x_{i}
l^{*}
p_{R}(x_{i}|x_{1:i-1})
R
x_{1:i-1}
x_{i}
x_{i}
\displaystyle Att=\textrm{softmax}\left(\frac{(\tilde{h}_{i}^{l^{*}}W_{q})(%
\tilde{h}_{1:m}^{l^{*}}W_{k})^{T}}{\sqrt{d_{k}}}\right),WordSim=\textrm{%
softmax}\left((x_{i}^{l^{\prime}-l^{*}}A)(rt_{1:m}^{l^{*}}A)^{T}\right),
\displaystyle Att
\displaystyle=\textrm{softmax}\left(\frac{(\tilde{h}_{i}^{l^{*}}W_{q})(\tilde{%
h}_{1:m}^{l^{*}}W_{k})^{T}}{\sqrt{d_{k}}}\right),WordSim=\textrm{softmax}\left%
((x_{i}^{l^{\prime}-l^{*}}A)(rt_{1:m}^{l^{*}}A)^{T}\right),
W_{q}
W_{k}
\tilde{h}_{i}^{l^{*}}
x_{i}
\tilde{h}_{1:m}^{l^{*}}
R
A
x_{i}^{l^{\prime}-l^{*}}
l^{*}
l^{\prime}
rt_{1:m}^{l^{*}}
R
\displaystyle p_{R}(x_{i}|x_{1:i-1})=\textrm{softmax}\left(Att\odot WordSim%
\right),\odot\textnormal{ is element-wise multiplication.}
\displaystyle p_{R}(x_{i}|x_{1:i-1})=\textrm{softmax}\left(Att\odot WordSim%
\right),\odot\textnormal{ is element-wise multiplication.}
\textnormal{Sim}(p(x_{i}|R,x_{1:i-1}),p_{R}(x_{i}|x_{1:i-1}))
\textnormal{Sim}(p(x_{i}|R,x_{1:i-1}),p(x_{i}|x_{1:i-1}))
\textnormal{Sim}(\cdot,\cdot)
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
p(x_{i}|x_{1:i-1})
p(x_{i}|R,x_{1:i-1})
\mathbf{w}_{RAG}=\frac{1}{\sum p^{\prime}}\sum_{(p^{\prime},\mathbf{w})\in%
\mathbb{V}}p^{\prime}\mathbf{w}
\mathbb{V}
p^{\prime}
p(x_{i}|R,x_{1:i-1})
\mathbf{w}
\mathbf{w}_{LLM}
p(x_{i}|x_{1:i-1})
\mathbf{w}_{IR}
p_{R}(x_{i}|x_{1:i-1})
\displaystyle\textnormal{Sim}(p(x_{i}|R,x_{1:i-1}),p_{R}(x_{i}|x_{1:i-1}))=%
\textrm{cos}(\mathbf{w}_{RAG},\mathbf{w}_{IR})
\displaystyle\textnormal{Sim}(p(x_{i}|R,x_{1:i-1}),p_{R}(x_{i}|x_{1:i-1}))
\displaystyle=\textrm{cos}(\mathbf{w}_{RAG},\mathbf{w}_{IR})
\displaystyle\textnormal{Sim}(p(x_{i}|R,x_{1:i-1}),p(x_{i}|x_{1:i-1}))=\textrm%
{cos}(\mathbf{w}_{RAG},\mathbf{w}_{LLM})
\displaystyle\textnormal{Sim}(p(x_{i}|R,x_{1:i-1}),p(x_{i}|x_{1:i-1}))
\displaystyle=\textrm{cos}(\mathbf{w}_{RAG},\mathbf{w}_{LLM})
x_{i}
s=\begin{cases}{\color[rgb]{0.0,0.69,0.0}\textrm{benefit win}}&\text{if }%
\textrm{cos}(\mathbf{w}_{RAG},\mathbf{w}_{IR})\geq\textrm{cos}(\mathbf{w}_{RAG%
},\mathbf{w}_{LLM}),\\
{\color[rgb]{1,0,0}\textrm{detriment win}}&\text{if }\textrm{cos}(\mathbf{w}_{%
RAG},\mathbf{w}_{IR})<\textrm{cos}(\mathbf{w}_{RAG},\mathbf{w}_{LLM}),\end{cases}
0\%
100\%
0\%
100\%
x_{1:i-1}
R
x_{i}
R
x_{i}
x
i
x_{1:i-1}
x_{i}
x_{1:i-1}
a
b
b
x_{i}
a
1
a
x_{i}
b
0
0\%
100\%
\leq 0.05
+
\leq 0.05
+
2
l^{*}
0
32
\displaystyle p(x_{i}|R,x_{1:i-1})=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z%
|R,x_{1:i-1})\,dz
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)p(%
z)}{p(R,x_{1:i-1})}\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)p(%
z)}{p(R,x_{1:i-1})}\,dz
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz,\textrm{\quad$p(R,x_{1:i-1})$ is a constant so we drop it}
p(R,x_{1:i-1})
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz,\textrm{\quad$p(R,x_{1:i-1})$ is a constant so we drop it}
p(R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)}{%
p(R,x_{1:i-1}|z^{*})}p(z)\,dz,\textrm{\quad$\frac{1}{p(R,x_{1:i-1}|z^{*})}$ is%
 a constant so we add it}
\frac{1}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)}{%
p(R,x_{1:i-1}|z^{*})}p(z)\,dz,\textrm{\quad$\frac{1}{p(R,x_{1:i-1}|z^{*})}$ is%
 a constant so we add it}
\frac{1}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
p(R,x_{1:i-1}|z)
v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle p(R,x_{1:i-1}|z)=p(x_{1:i-1}|R,z)p(R|z)
\displaystyle p(R,x_{1:i-1}|z)=p(x_{1:i-1}|R,z)p(R|z)
z
h
\displaystyle p(x_{1:i-1}|R,z)p(R|z)=\sum_{h}p(x_{1:i-1}|h,z)p(h|R,z)p(R|z),
\displaystyle p(x_{1:i-1}|R,z)p(R|z)
\displaystyle=\sum_{h}p(x_{1:i-1}|h,z)p(h|R,z)p(R|z),
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle v(z)
\displaystyle=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\textrm{log}\frac{\sum_{h}p(x_{1:i-1}|h,z)p(h|R,z)}{\sum_{h}p(x_%
{1:i-1}|h,z^{*})p(h|R,z^{*})}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}.
\displaystyle=\textrm{log}\frac{\sum_{h}p(x_{1:i-1}|h,z)p(h|R,z)}{\sum_{h}p(x_%
{1:i-1}|h,z^{*})p(h|R,z^{*})}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}.
x
h
p(x|h,z^{*})>c_{1}>0
r
R
h^{d}
h
h
h^{d}
0\leq c_{2}\leq p(h^{d}|h,z)\leq c_{3}
\displaystyle v(z)\leq\textrm{log}\frac{\sum_{h}1\cdot p(h|R,z)}{\sum_{h}c_{1}%
\cdot p(h|R,z^{*})}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}
\displaystyle v(z)
\displaystyle\leq\textrm{log}\frac{\sum_{h}1\cdot p(h|R,z)}{\sum_{h}c_{1}\cdot
p%
(h|R,z^{*})}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}
\displaystyle=\textrm{log}\frac{\sum_{h}1\cdot p(h|R,z)}{\sum_{h}c_{1}\cdot p(%
h|R,z^{*})}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}
\displaystyle=\textrm{log}\frac{\sum_{h}1\cdot p(h|R,z)}{\sum_{h}c_{1}\cdot p(%
h|R,z^{*})}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}
\displaystyle=-\textrm{log}{c_{1}}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}
\displaystyle=-\textrm{log}{c_{1}}+\textrm{log}\frac{p(R|z)}{p(R|z^{*})}
\displaystyle=-\textrm{log}{c_{1}}+\textrm{log}\frac{\prod_{i=1}^{n}p(r_{i}|r_%
{1:i-1},z)}{\prod_{i=1}^{n}p(r_{i}|r_{1:i-1},z^{*})}.
\displaystyle=-\textrm{log}{c_{1}}+\textrm{log}\frac{\prod_{i=1}^{n}p(r_{i}|r_%
{1:i-1},z)}{\prod_{i=1}^{n}p(r_{i}|r_{1:i-1},z^{*})}.
\displaystyle p(R,x_{1:i-1}|z)=p(x_{1:i-1}|R,z)p(R|z)\approx\prod_{i=1}^{n}O(1%
)p(r_{i}|r_{1:i-1},z)
\displaystyle p(R,x_{1:i-1}|z)=p(x_{1:i-1}|R,z)p(R|z)\approx\prod_{i=1}^{n}O(1%
)p(r_{i}|r_{1:i-1},z)
\displaystyle\prod_{i=1}^{n}O(1)p(r_{i}|r_{1:i-1},z)=\prod_{i=1}^{n}\sum_{h_{i%
-1}^{d}\in\mathcal{D}}p(r_{i}|h_{i-1}^{d},z)p(h_{i-1}^{d}|r_{1:i-1},z),
\displaystyle\prod_{i=1}^{n}O(1)p(r_{i}|r_{1:i-1},z)=\prod_{i=1}^{n}\sum_{h_{i%
-1}^{d}\in\mathcal{D}}p(r_{i}|h_{i-1}^{d},z)p(h_{i-1}^{d}|r_{1:i-1},z),
r_{i}
R
h_{i-1}^{d}
r_{i-1}
r_{i}
R
p(h_{i-1}^{d}|r_{1:i-1},z)=O(1)
\prod_{i=1}^{n}O(1)p(r_{i}|z)
p(R,x_{1:i-1}|z)\approx\prod_{i=1}^{n}O(1)p(r_{i}|z)
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}%
\approx\textrm{log}\frac{\prod_{i=1}^{n}O(1)p(r_{i}|z)}{\prod_{i=1}^{n}O(1)p(r%
_{i}|z^{*})}
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle\approx\textrm{log}\frac{\prod_{i=1}^{n}O(1)p(r_{i}|z)}{\prod_{i=%
1}^{n}O(1)p(r_{i}|z^{*})}
\displaystyle\rightarrow O(1)+n*\frac{1}{n}\sum_{i=1}^{n}log\frac{p(r_{i}|z)}{%
p(r_{i}|z*)}=O(1)+n*\mathbb{E}_{r\sim P_{r}}\left[log\frac{p(r_{i}|z)}{p(r_{i}%
|z^{*})}\right]
\displaystyle\rightarrow O(1)+n*\frac{1}{n}\sum_{i=1}^{n}log\frac{p(r_{i}|z)}{%
p(r_{i}|z*)}=O(1)+n*\mathbb{E}_{r\sim P_{r}}\left[log\frac{p(r_{i}|z)}{p(r_{i}%
|z^{*})}\right]
\displaystyle\propto p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=p_{R}(r)%
\textrm{log}\frac{p_{R}(r)}{p(r|z^{*})}-p_{R}(r)\textrm{log}\frac{p_{R}(r)}{p(%
r|z)}
\displaystyle\propto p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=p_{R}(r)%
\textrm{log}\frac{p_{R}(r)}{p(r|z^{*})}-p_{R}(r)\textrm{log}\frac{p_{R}(r)}{p(%
r|z)}
\displaystyle=-(\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{benefit},%
\textrm{denote as }\Omega}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_{%
\textbf{detriment},\textrm{denote as }\Upsilon}),
\displaystyle=-(\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{benefit},%
\textrm{denote as }\Omega}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_{%
\textbf{detriment},\textrm{denote as }\Upsilon}),
p_{R}(\cdot)
p(\cdot)
v(z)
v(z)
v(z)
v(z)\to-\infty
v(z)
\to 0
z\neq z^{*}
z
p(x_{i}|R,x_{1:i-1})
z=z^{*}
r(z^{*})
=1
z^{*}
v(z)
v(z)\to+\infty
v(z)
\to+\infty
z\neq z^{*}
z=z^{*}
r(z^{*})
=1
z
z^{*}
v(z)
\displaystyle p(x_{i}|R,x_{1:i-1})=\underbrace{\int_{\mathcal{Z}-\{{z}^{*}\}}p%
(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz}_{\textrm{denote as }\Phi}+%
\underbrace{p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1})}_{\textrm{denote as%
 }\Lambda}.
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\underbrace{\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
p(z|R,x_{1:i-1})\,dz}_{\textrm{denote as }\Phi}+\underbrace{p(x_{i}|R,x_{1:i-1%
},z^{*})p(z^{*}|R,x_{1:i-1})}_{\textrm{denote as }\Lambda}.
z^{*}
h
\Lambda
\displaystyle p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1})=\sum_{h}p(x_{i}|x%
_{1:i-1},h,z^{*})p(h|R,x_{1:i-1}.z^{*})p(z^{*}|R,x_{1:i-1}).
\displaystyle p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1})
\displaystyle=\sum_{h}p(x_{i}|x_{1:i-1},h,z^{*})p(h|R,x_{1:i-1}.z^{*})p(z^{*}|%
R,x_{1:i-1}).
p(z^{*}|R,x_{1:i-1})
\beta
\displaystyle p(x_{i}|R,x_{1:i-1})=\Phi+\beta\sum_{h}p(x_{i}|x_{1:i-1},h,z^{*}%
)p(h|R,x_{1:i-1}.z^{*})
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\Phi+\beta\sum_{h}p(x_{i}|x_{1:i-1},h,z^{*})p(h|R,x_{1:i-1}.z^{*})
\displaystyle p_{R}(x_{i}|x_{1:i-1})=\sum_{h}p(x_{i}|x_{1:i-1},h,z^{*})p_{R}(h%
|x_{1:i-1})
\displaystyle p_{R}(x_{i}|x_{1:i-1})
\displaystyle=\sum_{h}p(x_{i}|x_{1:i-1},h,z^{*})p_{R}(h|x_{1:i-1})
\displaystyle p_{R}(h|x_{1:i-1})\propto p(x_{1:i-1}|h,z^{*})p_{R}(h)
\displaystyle p_{R}(h|x_{1:i-1})
\displaystyle\propto p(x_{1:i-1}|h,z^{*})p_{R}(h)
\displaystyle p(h|R,x_{1:i-1},z^{*})\propto p(x_{1:i-1}|h,z^{*})p(h|R,z^{*})
\displaystyle p(h|R,x_{1:i-1},z^{*})
\displaystyle\propto p(x_{1:i-1}|h,z^{*})p(h|R,z^{*})
p(x_{i}|x_{1:i-1},h,z^{*})p(x_{1:i-1}|h,z^{*})
W\in\mathbb{R}^{|\mathcal{X}|\times|\mathcal{H}|}
x_{i}\in\mathcal{X}
h\in\mathcal{H}
p(h|R,z^{*})
B
p_{R}(h)
u\in\mathbb{R}^{|\mathcal{H}|}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\displaystyle\|p(x_{i}|R,x_{1:i-1})-p_{R}(x_{i}|x_{1:i-1})\|_{1}=\|\Phi+\beta
WB%
-Wu\|_{1}.
\displaystyle\|p(x_{i}|R,x_{1:i-1})-p_{R}(x_{i}|x_{1:i-1})\|_{1}=\|\Phi+\beta
WB%
-Wu\|_{1}.
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\displaystyle\|\Phi\|_{1}-\|\beta WB-Wu\|_{1}\leq\|\Phi+\beta WB-Wu\|_{1}\leq%
\|\Phi\|_{1}+\|\beta WB-Wu\|_{1}.
\displaystyle\|\Phi\|_{1}-\|\beta WB-Wu\|_{1}\leq\|\Phi+\beta WB-Wu\|_{1}\leq%
\|\Phi\|_{1}+\|\beta WB-Wu\|_{1}.
\|\beta WB-Wu\|_{1}
\displaystyle\|\beta WB-Wu\|_{1}=\sum_{i=1}^{|\mathcal{X}|}|W_{i}^{T}(\beta B-%
u)|_{i}
\displaystyle\|\beta WB-Wu\|_{1}
\displaystyle=\sum_{i=1}^{|\mathcal{X}|}|W_{i}^{T}(\beta B-u)|_{i}
\displaystyle=\sum_{i=1}^{|\mathcal{X}|}|\sum_{j=1}^{|\mathcal{H}|}W_{ij}(%
\beta B-u)_{j}|
\displaystyle=\sum_{i=1}^{|\mathcal{X}|}|\sum_{j=1}^{|\mathcal{H}|}W_{ij}(%
\beta B-u)_{j}|
\displaystyle\leq\sum_{i=1}^{|\mathcal{X}|}\sum_{j=1}^{|\mathcal{H}|}W_{ij}|(%
\beta B-u)_{j}|
\displaystyle\leq\sum_{i=1}^{|\mathcal{X}|}\sum_{j=1}^{|\mathcal{H}|}W_{ij}|(%
\beta B-u)_{j}|
\displaystyle=\sum_{j=1}^{|\mathcal{H}|}(\sum_{i=1}^{|\mathcal{X}|}W_{ij})|(%
\beta B-u)_{j}|
\displaystyle=\sum_{j=1}^{|\mathcal{H}|}(\sum_{i=1}^{|\mathcal{X}|}W_{ij})|(%
\beta B-u)_{j}|
\displaystyle=\sum_{j=1}^{|\mathcal{H}|}|(\beta B-u)_{j}|
\displaystyle=\sum_{j=1}^{|\mathcal{H}|}|(\beta B-u)_{j}|
\displaystyle=\|\beta B-u\|_{1}
\displaystyle=\|\beta B-u\|_{1}
\displaystyle\|\beta B-u\|_{1}=2TV(p_{R}(\cdot),\beta p(\cdot|R,z^{*}))\text{%
\quad TV is Total Variation Distance.}
\displaystyle\|\beta B-u\|_{1}
\displaystyle=2TV(p_{R}(\cdot),\beta p(\cdot|R,z^{*}))\text{\quad TV is Total %
Variation Distance.}
\displaystyle\leq 2\beta TV(p_{R}(\cdot),p(\cdot|R,z^{*}))
\displaystyle\leq 2\beta TV(p_{R}(\cdot),p(\cdot|R,z^{*}))
\displaystyle\leq\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|R,z^{*}))}\text{\quad
Pinsker%
's Inequality.}
\displaystyle\leq\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|R,z^{*}))}\text{\quad
Pinsker%
's Inequality.}
\displaystyle\leq\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|z^{*}))}
\displaystyle\leq\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|z^{*}))}
\displaystyle\approx\sqrt{2\text{KL}(p_{R}(r)\|p(r|z^{*}))},
\displaystyle\approx\sqrt{2\text{KL}(p_{R}(r)\|p(r|z^{*}))},
r
R
\text{KL}(p_{R}(r)\|p(r|z^{*}))
\displaystyle\|\Phi+\beta WB-Wu\|_{1}\leq\|\Phi\|_{1}+\sqrt{2\text{KL}(p_{R}(r%
)\|p(r|z^{*}))}
\displaystyle\|\Phi+\beta WB-Wu\|_{1}\leq\|\Phi\|_{1}+\sqrt{2\text{KL}(p_{R}(r%
)\|p(r|z^{*}))}
0\leq\|\beta WB-Wu\|_{1}\leq 2\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|z^{*}))}
\|\Phi+\beta WB-Wu\|_{1}\geq\|\Phi\|_{1}-\|\beta WB-Wu\|_{1}
\|\Phi+\beta WB-Wu\|_{1}
\displaystyle\left[\|\Phi\|_{1}-\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|z^{*}))%
},\|\Phi\|_{1}\right],
\displaystyle\left[\|\Phi\|_{1}-\sqrt{2\text{KL}(p_{R}(\cdot)\|p(\cdot|z^{*}))%
},\|\Phi\|_{1}\right],
\mathcal{D}=\|p(x_{i}|R,x_{1:i-1})-p_{R}(x_{i}|x_{1:i-1})\|_{1}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\mathcal{D}
\displaystyle\|\Phi\|_{1}-\sqrt{2\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_%
{\textbf{detriment}}}\leq\mathcal{D}\leq\|\Phi\|_{1}+\sqrt{2\underbrace{\text{%
KL}(p_{R}(r)\|p(r|z^{*}))}_{\textbf{detriment}}},
\displaystyle\|\Phi\|_{1}-\sqrt{2\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_%
{\textbf{detriment}}}\leq\mathcal{D}\leq\|\Phi\|_{1}+\sqrt{2\underbrace{\text{%
KL}(p_{R}(r)\|p(r|z^{*}))}_{\textbf{detriment}}},
\text{KL}(p_{R}(r)\|p(r|z)
\Omega
\text{KL}(p_{R}(r)\|p(r|z^{*})
\Upsilon
\displaystyle p(x_{i}|R,x_{1:i-1})=\underbrace{\int_{\mathcal{Z}-\{{z}^{*}\}}p%
(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz}_{\textrm{denote as }\Phi}+%
\underbrace{p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1})}_{\textrm{denote as%
 }\Lambda}.
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\underbrace{\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
p(z|R,x_{1:i-1})\,dz}_{\textrm{denote as }\Phi}+\underbrace{p(x_{i}|R,x_{1:i-1%
},z^{*})p(z^{*}|R,x_{1:i-1})}_{\textrm{denote as }\Lambda}.
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)p(%
z)}{p(R,x_{1:i-1})}\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)p(%
z)}{p(R,x_{1:i-1})}\,dz
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz,\textrm{\quad$p(R,x_{1:i-1})$ is a constant so we drop it}
p(R,x_{1:i-1})
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz,\textrm{\quad$p(R,x_{1:i-1})$ is a constant so we drop it}
p(R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)}{%
p(R,x_{1:i-1}|z^{*})}p(z)\,dz,\textrm{\quad$\frac{1}{p(R,x_{1:i-1}|z^{*})}$ is%
 a constant so we add it}
\frac{1}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)}{%
p(R,x_{1:i-1}|z^{*})}p(z)\,dz,\textrm{\quad$\frac{1}{p(R,x_{1:i-1}|z^{*})}$ is%
 a constant so we add it}
\frac{1}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}%
\approx-\left[\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{benefit},%
\textrm{denote as }\Omega}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_{%
\textbf{detriment},\textrm{denote as }\Upsilon}\right]
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle\approx-\left[\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{%
benefit},\textrm{denote as }\Omega}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*})%
)}_{\textbf{detriment},\textrm{denote as }\Upsilon}\right]
\Phi
\displaystyle\Phi=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_%
{1:i-1})\,dz
\displaystyle\Phi
\displaystyle=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i%
-1})\,dz
\displaystyle=\frac{p(R,x_{1:i-1}|z^{*})}{p(R,x_{1:i-1})}\int_{\mathcal{Z}-\{{%
z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,dz
\displaystyle=\frac{p(R,x_{1:i-1}|z^{*})}{p(R,x_{1:i-1})}\int_{\mathcal{Z}-\{{%
z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,dz
\displaystyle=\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(v(z))p(z)\,dz,\quad(\text{$p(R,x_{1:i-1}|z^{*})$ and ${p(R,x_{1:i%
-1})}$ are constants})
p(R,x_{1:i-1}|z^{*})
{p(R,x_{1:i-1})}
\displaystyle=\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(v(z))p(z)\,dz,\quad(\text{$p(R,x_{1:i-1}|z^{*})$ and ${p(R,x_{1:i%
-1})}$ are constants})
p(R,x_{1:i-1}|z^{*})
{p(R,x_{1:i-1})}
\displaystyle\approx\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(-(\Omega-\Upsilon))p(z)\,dz\quad\textrm{ (Equation~{}\ref{eq4})}.
\displaystyle\approx\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(-(\Omega-\Upsilon))p(z)\,dz\quad\textrm{ (Equation~{}\ref{eq4})}.
\frac{1}{\mathcal{D}}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\mathcal{D}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\frac{1}{\mathcal{D}}
\text{KL}(p_{R}(r)\|p(r|z)-\text{KL}(p_{R}(r)\|p(r|z^{*})
\text{KL}(p_{R}(r)\|p(r|z)
\Omega
\text{KL}(p_{R}(r)\|p(r|z^{*})
\Upsilon
\displaystyle p(x_{i}|R,x_{1:i-1})=\underbrace{\int_{\mathcal{Z}-\{{z}^{*}\}}p%
(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz}_{\textrm{denote as }\Phi}+%
\underbrace{p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1})}_{\textrm{denote as%
 }\Lambda}.
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\underbrace{\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
p(z|R,x_{1:i-1})\,dz}_{\textrm{denote as }\Phi}+\underbrace{p(x_{i}|R,x_{1:i-1%
},z^{*})p(z^{*}|R,x_{1:i-1})}_{\textrm{denote as }\Lambda}.
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)p(%
z)}{p(R,x_{1:i-1})}\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)p(%
z)}{p(R,x_{1:i-1})}\,dz
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz,\textrm{\quad$p(R,x_{1:i-1})$ is a constant so we drop it}
p(R,x_{1:i-1})
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz,\textrm{\quad$p(R,x_{1:i-1})$ is a constant so we drop it}
p(R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)}{%
p(R,x_{1:i-1}|z^{*})}p(z)\,dz,\textrm{\quad$\frac{1}{p(R,x_{1:i-1}|z^{*})}$ is%
 a constant so we add it}
\frac{1}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\frac{p(R,x_{1:i-1}|z)}{%
p(R,x_{1:i-1}|z^{*})}p(z)\,dz,\textrm{\quad$\frac{1}{p(R,x_{1:i-1}|z^{*})}$ is%
 a constant so we add it}
\frac{1}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}%
\approx-\left[\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{benefit},%
\textrm{denote as }\Omega}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*}))}_{%
\textbf{detriment},\textrm{denote as }\Upsilon}\right]
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle\approx-\left[\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{%
benefit},\textrm{denote as }\Omega}-\underbrace{\text{KL}(p_{R}(r)\|p(r|z^{*})%
)}_{\textbf{detriment},\textrm{denote as }\Upsilon}\right]
\Phi
\displaystyle\Phi=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_%
{1:i-1})\,dz
\displaystyle\Phi
\displaystyle=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i%
-1})\,dz
\displaystyle=\frac{p(R,x_{1:i-1}|z^{*})}{p(R,x_{1:i-1})}\int_{\mathcal{Z}-\{{%
z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,dz
\displaystyle=\frac{p(R,x_{1:i-1}|z^{*})}{p(R,x_{1:i-1})}\int_{\mathcal{Z}-\{{%
z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,dz
\displaystyle=\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(v(z))p(z)\,dz,\quad(\text{$p(R,x_{1:i-1}|z^{*})$ and ${p(R,x_{1:i%
-1})}$ are constants})
p(R,x_{1:i-1}|z^{*})
{p(R,x_{1:i-1})}
\displaystyle=\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(v(z))p(z)\,dz,\quad(\text{$p(R,x_{1:i-1}|z^{*})$ and ${p(R,x_{1:i%
-1})}$ are constants})
p(R,x_{1:i-1}|z^{*})
{p(R,x_{1:i-1})}
\displaystyle\approx\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(-(\Omega-\Upsilon))p(z)\,dz\quad\textrm{ (Equation~{}\ref{eq4})}.
\displaystyle\approx\alpha\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)%
\textrm{exp}(-(\Omega-\Upsilon))p(z)\,dz\quad\textrm{ (Equation~{}\ref{eq4})}.
\displaystyle\|\Phi\|_{1}-\sqrt{2\Upsilon}\approx\alpha\|\int_{\mathcal{Z}-\{{%
z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(-(\Omega-\Upsilon))p(z)\,dz\|_{1}-%
\sqrt{2\Upsilon}
\displaystyle\|\Phi\|_{1}-\sqrt{2\Upsilon}
\displaystyle\approx\alpha\|\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},%
z)\textrm{exp}(-(\Omega-\Upsilon))p(z)\,dz\|_{1}-\sqrt{2\Upsilon}
\displaystyle\propto\text{exp}(-(\Omega-\Upsilon))-\sqrt{2\Upsilon}
\displaystyle\propto\text{exp}(-(\Omega-\Upsilon))-\sqrt{2\Upsilon}
\displaystyle\|\Phi\|_{1}+\sqrt{2\Upsilon}\propto\text{exp}(-(\Omega-\Upsilon)%
)+\sqrt{2\Upsilon}
\displaystyle\|\Phi\|_{1}+\sqrt{2\Upsilon}
\displaystyle\propto\text{exp}(-(\Omega-\Upsilon))+\sqrt{2\Upsilon}
\Omega
\Upsilon
\Omega
\Upsilon
\Omega
\Omega-\Upsilon
\Upsilon
\text{exp}(-(\Omega-\Upsilon))+\sqrt{2\Upsilon}
\text{exp}(-(\Omega-\Upsilon))-\sqrt{2\Upsilon}
\Upsilon
\Omega-\Upsilon
\Upsilon
\Omega-\Upsilon
\Omega
\text{exp}(-(\Omega-\Upsilon))+\sqrt{2\Upsilon}
\text{exp}(-(\Omega-\Upsilon))-\sqrt{2\Upsilon}
\Omega
\Omega-\Upsilon
\mathcal{D}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\frac{1}{D}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\underbrace{\text{KL}(p_{R}(r)\|p(r|z))}_{\textbf{benefit}}-\underbrace{\text{%
KL}(p_{R}(r)\|p(r|z^{*}))}_{\textbf{detriment}}\propto\frac{1}{\mathcal{D}}.
\frac{1}{D}
\displaystyle J=\begin{cases}\textnormal{KL}(p_{R}(r)\|p(r|z))<\textnormal{KL}%
(p_{R}(r)\|p(r|z^{*}))\text{, detriment outweighs benefit.}&\text{if }\frac{1}%
{\mathcal{D}}<\frac{1}{\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))=\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 detriment is equal to benefit.}&\text{if }\frac{1}{\mathcal{D}}=\frac{1}{%
\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))>\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 benefit outweighs detriment.}&\text{if }\frac{1}{\mathcal{D}}>\frac{1}{%
\mathcal{M}}\end{cases}
\displaystyle J=\begin{cases}\textnormal{KL}(p_{R}(r)\|p(r|z))<\textnormal{KL}%
(p_{R}(r)\|p(r|z^{*}))\text{, detriment outweighs benefit.}&\text{if }\frac{1}%
{\mathcal{D}}<\frac{1}{\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))=\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 detriment is equal to benefit.}&\text{if }\frac{1}{\mathcal{D}}=\frac{1}{%
\mathcal{M}}\\
\textnormal{KL}(p_{R}(r)\|p(r|z))>\textnormal{KL}(p_{R}(r)\|p(r|z^{*}))\text{,%
 benefit outweighs detriment.}&\text{if }\frac{1}{\mathcal{D}}>\frac{1}{%
\mathcal{M}}\end{cases}
\frac{1}{\mathcal{M}}
p(x_{i}|R,x_{1:i-1})
p(x_{i}|x_{1:i-1})
\frac{1}{\mathcal{D}}
p(x_{i}|R,x_{1:i-1})
p_{R}(x_{i}|x_{1:i-1})
\displaystyle\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))=0,
\displaystyle\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))=0,
\displaystyle p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=0,
\displaystyle p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=0,
p_{R}(r)
0
\displaystyle\textrm{log}\frac{p(r|z)}{p(r|z*)}=0,
\displaystyle\textrm{log}\frac{p(r|z)}{p(r|z*)}
\displaystyle=0,
\displaystyle\frac{p(r|z)}{p(r|z*)}=1,
\displaystyle\frac{p(r|z)}{p(r|z*)}
\displaystyle=1,
\displaystyle p(r|z)=p(r|z^{*}),
\displaystyle p(r|z)
\displaystyle=p(r|z^{*}),
z^{*}
z
\displaystyle p(x_{i}|x_{1:i-1})=p_{R}(x_{i}|x_{1:i-1}),
\displaystyle p(x_{i}|x_{1:i-1})=p_{R}(x_{i}|x_{1:i-1}),
\displaystyle\|p(x_{i}|R,x_{1:i-1})-p(x_{i}\|x_{1:i-1})\|_{1}=\|p(x_{i}|R,x_{1%
:i-1})-p_{R}(x_{i}\|x_{1:i-1})\|_{1},
\displaystyle\|p(x_{i}|R,x_{1:i-1})-p(x_{i}\|x_{1:i-1})\|_{1}=\|p(x_{i}|R,x_{1%
:i-1})-p_{R}(x_{i}\|x_{1:i-1})\|_{1},
\frac{1}{\mathcal{D}}=\frac{1}{\mathcal{M}}
\frac{1}{\mathcal{D}}=\frac{1}{\mathcal{M}}
\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))=0
\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))
\frac{1}{\mathcal{D}}
\frac{1}{\mathcal{D}}>\frac{1}{\mathcal{M}}
\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))>0
\frac{1}{\mathcal{D}}<\frac{1}{\mathcal{M}}
\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))<0
\displaystyle f(x)=W_{0}x,
\displaystyle f(x)=W_{0}x,
W_{0}
\mathbf{x_{i}}\in\mathbb{R}^{d_{in}}
\mathbf{e_{i}}\in\mathbb{R}^{d_{out}}
i\in[1,N]
\displaystyle W^{\prime}=W_{0}+\Delta W=W_{0}+\sum_{i}^{N}\mathbf{e_{i}}%
\otimes\mathbf{x_{i}}.
\displaystyle W^{\prime}=W_{0}+\Delta W=W_{0}+\sum_{i}^{N}\mathbf{e_{i}}%
\otimes\mathbf{x_{i}}.
\displaystyle\text{LinearAttn}(V,K,\mathbf{q})=\sum_{i}\mathbf{v}_{i}(\mathbf{%
k}^{T}_{i}\mathbf{q}).
\displaystyle\text{LinearAttn}(V,K,\mathbf{q})=\sum_{i}\mathbf{v}_{i}(\mathbf{%
k}^{T}_{i}\mathbf{q}).
\mathbf{x}_{N+1}
\displaystyle f^{\prime}(x)=(W_{0}+\Delta W)\mathbf{x}_{N+1}
\displaystyle f^{\prime}(x)
\displaystyle=(W_{0}+\Delta W)\mathbf{x}_{N+1}
\displaystyle=(W_{0}+\sum_{i}^{N}\mathbf{e}_{i}\otimes\mathbf{x}_{i})\mathbf{x%
}_{N+1}
\displaystyle=(W_{0}+\sum_{i}^{N}\mathbf{e}_{i}\otimes\mathbf{x}_{i})\mathbf{x%
}_{N+1}
\displaystyle=W_{0}\mathbf{x}_{N+1}+\sum_{i}^{N}(\mathbf{e}_{i}\otimes\mathbf{%
x}_{i})\mathbf{x}_{N+1}
\displaystyle=W_{0}\mathbf{x}_{N+1}+\sum_{i}^{N}(\mathbf{e}_{i}\otimes\mathbf{%
x}_{i})\mathbf{x}_{N+1}
\displaystyle=W_{0}\mathbf{x}_{N+1}+\sum_{i}^{N}\mathbf{e}_{i}\otimes(\mathbf{%
x}_{i}^{T}\mathbf{x}_{N+1})
\displaystyle=W_{0}\mathbf{x}_{N+1}+\sum_{i}^{N}\mathbf{e}_{i}\otimes(\mathbf{%
x}_{i}^{T}\mathbf{x}_{N+1})
\displaystyle=W_{0}\mathbf{x}_{N+1}+\text{LinearAttn}(E,\mathbf{x}_{1:N},%
\mathbf{x}_{N+1})
\displaystyle=W_{0}\mathbf{x}_{N+1}+\text{LinearAttn}(E,\mathbf{x}_{1:N},%
\mathbf{x}_{N+1})
\displaystyle f_{ICL}(\mathbf{q})=\text{Attn}(V,K,\mathbf{q})
\displaystyle f_{ICL}(\mathbf{q})
\displaystyle=\text{Attn}(V,K,\mathbf{q})
\displaystyle=W_{V}[B^{\prime}:B]\text{softmax}\left(\frac{W_{K}[B^{\prime}:B]%
^{T}\mathbf{q}}{\sqrt{d}}\right),
\displaystyle=W_{V}[B^{\prime}:B]\text{softmax}\left(\frac{W_{K}[B^{\prime}:B]%
^{T}\mathbf{q}}{\sqrt{d}}\right),
\mathbf{q}=W_{Q}\mathbf{b}
\mathbf{b}
t
W_{Q}
W_{K}
W_{v}
B^{\prime}
X
\mathbf{b}
\displaystyle f_{ICL}(\mathbf{q})\approx W_{V}[B^{\prime}:B](W_{K}[B^{\prime}:%
B])^{T}\mathbf{q}
\displaystyle f_{ICL}(\mathbf{q})
\displaystyle\approx W_{V}[B^{\prime}:B](W_{K}[B^{\prime}:B])^{T}\mathbf{q}
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+W_{V}X^{\prime}(W_{K}B^{\prime})^{T%
}\mathbf{q}
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+W_{V}X^{\prime}(W_{K}B^{\prime})^{T%
}\mathbf{q}
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+\text{LinearAttn}(W_{V}B^{\prime},W%
_{K}B^{\prime},\mathbf{q})
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+\text{LinearAttn}(W_{V}B^{\prime},W%
_{K}B^{\prime},\mathbf{q})
\displaystyle f_{ICL}(\mathbf{q})\approx W_{V}B(W_{K}X)^{T}\mathbf{q}+\text{%
LinearAttn}(W_{V}B^{\prime},W_{K}B^{\prime},\mathbf{q})
\displaystyle f_{ICL}(\mathbf{q})
\displaystyle\approx W_{V}B(W_{K}X)^{T}\mathbf{q}+\text{LinearAttn}(W_{V}B^{%
\prime},W_{K}B^{\prime},\mathbf{q})
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+\sum_{i}W_{V}\mathbf{b}^{\prime}_{i%
}\left((W_{K}\mathbf{b}^{\prime}_{i})^{T}\mathbf{q}\right)
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+\sum_{i}W_{V}\mathbf{b}^{\prime}_{i%
}\left((W_{K}\mathbf{b}^{\prime}_{i})^{T}\mathbf{q}\right)
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+\sum_{i}\left((W_{V}\mathbf{b}^{%
\prime}_{i})\otimes(W_{K}\mathbf{b}^{\prime}_{i})\right)\mathbf{q}.
\displaystyle=W_{V}B(W_{K}B)^{T}\mathbf{q}+\sum_{i}\left((W_{V}\mathbf{b}^{%
\prime}_{i})\otimes(W_{K}\mathbf{b}^{\prime}_{i})\right)\mathbf{q}.
W_{V}B(W_{K}B)^{T}
W_{0}
B
W_{V}\mathbf{b}_{i}^{\prime}
\mathbf{e}_{i}
W_{K}\mathbf{b}_{i}
\displaystyle W_{V}\mathbf{b}_{i}^{\prime}=\mathbf{e}_{i}
\displaystyle W_{V}\mathbf{b}_{i}^{\prime}
\displaystyle=\mathbf{e}_{i}
\displaystyle W_{K}\mathbf{b}_{i}^{\prime}=x_{i}.
\displaystyle W_{K}\mathbf{b}_{i}^{\prime}
\displaystyle=x_{i}.
\mathcal{L}
e_{i}=-\eta\frac{\partial\mathcal{L}}{\partial y_{i}}
\eta
y_{i}=W_{i}x_{i}
W_{i}
t
\displaystyle\mathbf{e}_{i}=-\eta\frac{\partial\mathcal{L}}{\partial y_{i}}=-%
\eta\frac{\partial\mathcal{L}}{\partial W_{i}x_{i}}
\displaystyle\mathbf{e}_{i}=-\eta\frac{\partial\mathcal{L}}{\partial y_{i}}
\displaystyle=-\eta\frac{\partial\mathcal{L}}{\partial W_{i}x_{i}}
\displaystyle=-\eta\frac{\partial\mathcal{L}}{\partial W_{i}W_{K}\mathbf{b}_{i%
}^{\prime}}.
\displaystyle=-\eta\frac{\partial\mathcal{L}}{\partial W_{i}W_{K}\mathbf{b}_{i%
}^{\prime}}.
\displaystyle-\eta\frac{\partial\mathcal{L}}{\partial W_{i}W_{K}\mathbf{b}^{%
\prime}_{i}}=W_{V}\mathbf{b}_{i}^{\prime}.
\displaystyle-\eta\frac{\partial\mathcal{L}}{\partial W_{i}W_{K}\mathbf{b}^{%
\prime}_{i}}=W_{V}\mathbf{b}_{i}^{\prime}.
\mathcal{L}
\displaystyle\mathcal{L}=-\frac{1}{\eta}\int W_{V}\mathbf{b}_{i}^{\prime}\,d(W%
_{i}W_{K}\mathbf{b}_{i}^{\prime})
\displaystyle\mathcal{L}=-\frac{1}{\eta}\int W_{V}\mathbf{b}_{i}^{\prime}\,d(W%
_{i}W_{K}\mathbf{b}_{i}^{\prime})
b_{i}
\displaystyle p(x_{i}|R,x_{1:i-1})=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z%
|R,x_{1:i-1})\,dz
\displaystyle p(x_{i}|R,x_{1:i-1})
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i-1})\,dz
\displaystyle=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i%
-1})\,dz+p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1}).
\displaystyle=\int_{\mathcal{Z}-\{{z}^{*}\}}p(x_{i}|R,x_{1:i-1},z)p(z|R,x_{1:i%
-1})\,dz+p(x_{i}|R,x_{1:i-1},z^{*})p(z^{*}|R,x_{1:i-1}).
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz
\displaystyle\propto\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)p(R,x_{1:i-1}|z)p(%
z)\,dz
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle=\int_{\mathcal{Z}}p(x_{i}|R,x_{1:i-1},z)\textrm{exp}(v(z))p(z)\,%
dz,\quad v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}%
\approx\textrm{log}\frac{\prod_{i=1}^{n}O(1)p(r_{i}|z)}{\prod_{i=1}^{n}O(1)p(r%
_{i}|z^{*})}
\displaystyle v(z)=\textrm{log}\frac{p(R,x_{1:i-1}|z)}{p(R,x_{1:i-1}|z^{*})}
\displaystyle\approx\textrm{log}\frac{\prod_{i=1}^{n}O(1)p(r_{i}|z)}{\prod_{i=%
1}^{n}O(1)p(r_{i}|z^{*})}
\displaystyle\rightarrow O(1)+n*\frac{1}{n}\sum_{i=1}^{n}log\frac{p(r_{i}|z)}{%
p(r_{i}|z*)}=O(1)+n*\mathbb{E}_{r\sim P_{r}}\left[log\frac{p(r_{i}|z)}{p(r_{i}%
|z^{*})}\right]
\displaystyle\rightarrow O(1)+n*\frac{1}{n}\sum_{i=1}^{n}log\frac{p(r_{i}|z)}{%
p(r_{i}|z*)}=O(1)+n*\mathbb{E}_{r\sim P_{r}}\left[log\frac{p(r_{i}|z)}{p(r_{i}%
|z^{*})}\right]
\displaystyle\propto p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=p_{R}(r)%
\textrm{log}\frac{p_{R}(r)}{p(r|z^{*})}-p_{R}(r)\textrm{log}\frac{p_{R}(r)}{p(%
r|z)}
\displaystyle\propto p_{R}(r)\textrm{log}\frac{p(r|z)}{p(r|z^{*})}=p_{R}(r)%
\textrm{log}\frac{p_{R}(r)}{p(r|z^{*})}-p_{R}(r)\textrm{log}\frac{p_{R}(r)}{p(%
r|z)}
\displaystyle=-(\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))),
\displaystyle=-(\text{KL}(p_{R}(r)\|p(r|z))-\text{KL}(p_{R}(r)\|p(r|z^{*}))),
p_{R}(r)
p(r|z)
p(r|z^{*})
p_{R}(r)
p(r|z)
p(r|z^{*})
r
z^{*}
\text{KL}(p_{R}(r)\|p(r|z^{*})
p_{R}(r)
p(r|z^{*})
v(z)
z
z^{*}
p_{R}(r)
p_{R}(r)
r
p_{R}(r)
\geq 0.5
<0.5
