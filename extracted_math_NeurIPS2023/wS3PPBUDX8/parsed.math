\mathcal{L}_{p}
\mathcal{L}_{p}
\mathcal{L}_{2}
\mathcal{L}_{2}
C:[0,1]^{n}\rightarrow\mathcal{Y}
n
\mathcal{Y}
x_{\text{ori}}\in[0,1]^{n}
y_{\text{tar}}\in\mathcal{Y}
x_{\text{adv}}
x_{\text{ori}}
\text{min }\mathcal{D}(x_{\text{ori}},x_{\text{adv}})\quad\text{ s.t. }C(x_{%
\text{adv}})=y_{\text{tar}}\text{ and }x_{\text{adv}}\in[0,1]^{n}
\mathcal{D}
\mathcal{L}_{1}
\mathcal{L}_{2}
\mathcal{L}_{\infty}
\mathcal{L}(x_{\text{adv}},y_{\text{tar}}):=c_{1}\,\mathcal{D}(x_{\text{ori}},%
x_{\text{adv}})+c_{2}\,f(x_{\text{adv}},y_{\text{tar}})
\text{min }\mathcal{L}(x_{\text{adv}},y_{\text{tar}})\quad\text{ s.t. }x_{%
\text{adv}}\in[0,1]^{n}
c_{1}
c_{2}
f
f
f
E_{\theta}
\theta
x
p_{\theta}(x)=\frac{\exp(-E_{\theta}(x))}{Z_{\theta}}
Z_{\theta}=\int\exp(-E_{\theta}(x))\mathrm{d}x
1
x_{0}
\beta_{1},\dots,\beta_{T}
q(x_{1:T}|x_{0})=\prod_{t=1}^{T}q(x_{t}|x_{t-1}),
q(x_{t}|x_{t-1}):=\mathcal{N}(x_{t};\sqrt{1-\beta_{t}}\,x_{t-1},\beta_{t}I)
\mathcal{N}
\beta_{t}\in(0,1)
x_{T}
q(x_{T})=\mathcal{N}(x_{T};0,I)
\alpha_{t}:=1-\beta_{t}
t
\bar{\alpha}_{t}:=\prod_{s=1}^{t}\alpha_{s}
q(x_{t}|x_{0})=\mathcal{N}(x_{t};\sqrt{\bar{\alpha}_{t}}\,x_{0},(1-\bar{\alpha%
}_{t})I)
q(x_{t-1}|x_{t})
p_{\theta}(x_{t-1}|x_{t}):=\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t},t),\Sigma_{%
\theta}(x_{t},t))
q(x_{t-1}|x_{t})
\mu_{\theta}
\Sigma_{\theta}
\mu_{\theta}(x_{t},t)
\Sigma_{\theta}(x_{t},t)
\mu_{\theta}(x_{t})
\Sigma_{\theta}(x_{t})
x\sim p_{\text{vic}}(\cdot|y_{\text{tar}})
x\sim p_{\text{vic}}(\cdot|y_{\text{tar}})
x\sim p_{\text{dis}}(\cdot|x_{\text{ori}})
p_{\text{dis}}
t(x)
t\sim\mathcal{T}
x\sim p_{\text{adv}}(\cdot|x_{\text{ori}},y_{\text{tar}})
p_{\text{dis}}
p_{\text{vic}}(\cdot|y_{\text{tar}})
p_{\text{dis}}(\cdot|x_{\text{ori}})
\mathcal{D}
\mathcal{L}_{2}
t(x_{\text{ori}})
t\sim\mathcal{T}
\mathcal{T}
p_{\text{adv}}(\cdot|x_{\text{ori}},y_{\text{tar}})\propto\exp(-c_{1}\,%
\mathcal{D}(x_{\text{ori}},x_{\text{adv}}))\exp(-c_{2}\,f(x_{\text{adv}},y_{%
\text{tar}}))
\mathcal{D}
\mathcal{L}_{2}
f
f_{\text{CE}}
x_{\text{ori}}
y_{\text{tar}}
c_{1}
10^{-3}
c_{2}
10^{-2}
p_{\text{vic}}(\cdot|y_{\text{tar}})
p_{\text{dis}}(\cdot|x_{\text{ori}})
\mathcal{D}
\mathcal{L}_{2}
t(x_{\text{ori}})
t\sim\mathcal{T}
\mathcal{T}
p_{\text{adv}}(\cdot|x_{\text{ori}},y_{\text{tar}})\propto\exp(-c_{1}\,%
\mathcal{D}(x_{\text{ori}},x_{\text{adv}}))\exp(-c_{2}\,f(x_{\text{adv}},y_{%
\text{tar}}))
\mathcal{D}
\mathcal{L}_{2}
f
f_{\text{CE}}
x_{\text{ori}}
y_{\text{tar}}
c_{1}
10^{-3}
c_{2}
10^{-2}
p_{\text{adv}}
p_{\text{adv}}(x_{\text{adv}}|x_{\text{ori}},y_{\text{tar}})\propto p_{\text{%
vic}}(x_{\text{adv}}|y_{\text{tar}})\,p_{\text{dis}}(x_{\text{adv}}|x_{\text{%
ori}})
p_{\text{vic}}
y_{\text{tar}}
p_{\text{dis}}
p_{\text{dis}}
x_{\text{adv}}
x_{\text{ori}}
p_{\text{vic}}(x_{\text{adv}}|y_{\text{tar}})\propto\exp(-c_{2}\,f(x_{\text{%
adv}},y_{\text{tar}}))
p_{\text{dis}}(x_{\text{adv}}|x_{\text{ori}})\propto\exp(-c_{1}\,\mathcal{D}(x%
_{\text{ori}},x_{\text{adv}}))
p_{\text{adv}}
p_{\text{vic}}
p_{\text{dis}}
p_{\text{adv}}
p_{\text{dis}}
p_{\text{vic}}
p_{\text{vic}}
f
p_{\text{vic}}
p_{\text{vic}}
p_{\text{dis}}
\mathcal{D}(x_{\text{ori}},x_{\text{adv}})
x_{\text{adv}}
x_{\text{ori}}
x_{\text{ori}}
p_{\text{dis}}
\mathcal{D}
\mathcal{L}_{2}
p_{\text{dis}}
x_{\text{ori}}
c_{1}
p_{\text{dis}}
\mathcal{D}
\mathcal{L}_{2}
c_{1}
x_{\text{ori}}
x_{\text{ori}}
p_{\text{adv}}
p_{\text{vic}}
p_{\text{dis}}
p_{\text{vic}}
p_{\text{dis}}
p_{\text{vic}}
p_{\text{dis}}
p_{\text{adv}}
p_{\text{dis}}
p_{\text{vic}}
p_{\text{dis}}
\mathcal{D}
p_{\text{dis}}
p_{\text{dis}}(\cdot|x_{\text{ori}})
x_{\text{ori}}
p_{\text{dis}}
p_{\text{dis}}
\mathcal{D}
p_{\text{dis}}
c_{1}=1
c
c_{2}
p_{\text{dis}}(\cdot|x_{\text{ori}})
x_{\text{ori}}
\mathcal{T}
x_{\text{ori}}
\{t_{1}(x_{\text{ori}}),t_{2}(x_{\text{ori}}),\dots\}
t_{i}
\mathcal{T}
p_{\text{dis}}
\mathcal{T}
p_{\text{dis}}
\mathcal{T}
x_{\text{ori}}
x_{\text{ori}}
p_{\text{vic}}\propto\exp(c\,f(x_{\text{adv}},y_{\text{tar}}))
f
g_{\phi}:[0,1]^{n}\rightarrow\mathbb{R}^{|\mathcal{Y}|}
\phi
n
\mathcal{Y}
g_{\phi}
f
\displaystyle f_{\text{CE}}(x,y_{\text{tar}}):=-g_{\phi}(x)[y_{\text{tar}}]+%
\log\sum_{y}\exp(g_{\phi}(x)[y])=-\log\sigma(g_{\phi}(x))[y_{\text{tar}}]
\displaystyle f_{\text{CE}}(x,y_{\text{tar}})
\displaystyle:=-g_{\phi}(x)[y_{\text{tar}}]+\log\sum_{y}\exp(g_{\phi}(x)[y])=-%
\log\sigma(g_{\phi}(x))[y_{\text{tar}}]
\sigma
f
f
f_{\text{CW}}(x,y_{\text{tar}}):=\max(\max_{y\neq y_{\text{tar}}}g_{\phi}(x)[y%
]-g_{\phi}(x)[y_{\text{tar}}],0).
f_{\text{CW}}
f_{\text{CE}}
p_{\text{dis}}
p_{\text{adv}}
p_{\text{vic}}
p_{\text{dis}}
s=\nabla\log p_{\text{adv}}(x_{\text{adv}}|x_{\text{ori}},y_{\text{tar}})
p_{\text{dis}}
p_{\text{dis}}(\cdot|x_{\text{ori}})
x_{\text{ori}}
x_{\text{ori}}
E_{\theta}
p_{\text{adv}}(x_{\text{adv}}|x_{\text{ori}},y_{\text{tar}})\propto e^{-cf(x_{%
\text{adv}},y_{\text{tar}})}e^{-E_{\theta}(x_{\text{adv}})}
\nabla_{x_{\text{adv}}}\log p_{\text{adv}}(x_{\text{adv}}|x_{\text{ori}},y_{%
\text{tar}})=-c\nabla_{x_{\text{adv}}}f(x_{\text{adv}},y_{\text{tar}})-\nabla_%
{x_{\text{adv}}}E_{\theta}(x_{\text{adv}})
x_{\text{ori}}
y_{\text{tar}}
p_{\theta_{\text{ori}}}(x_{t-1}|x_{t}):=\mathcal{N}(x_{t-1};\mu_{\theta_{\text%
{ori}}}(x_{t}),\Sigma_{\theta_{\text{ori}}}(x_{t}))
t-1
\theta_{\text{ori}}
x_{\text{ori}}
p_{\text{dis}}(\cdot|x_{\text{ori}})
\theta_{\text{ori}}
\theta
x_{0}=x_{\text{adv}}
\displaystyle p_{\text{adv}}(x_{0}|x_{\text{ori}},y_{\text{tar}})\propto p_{%
\text{vic}}(x_{0}|y_{\text{tar}})p_{\text{dis}}(x_{0}|x_{\text{ori}})=p_{\text%
{vic}}(x_{0}|y_{\text{tar}})\int p(x_{T})\prod_{t=1}^{T}p_{\theta}(x_{t-1}|x_{%
t})dx_{1\dots T}
\displaystyle p_{\text{adv}}(x_{0}|x_{\text{ori}},y_{\text{tar}})\propto p_{%
\text{vic}}(x_{0}|y_{\text{tar}})p_{\text{dis}}(x_{0}|x_{\text{ori}})=p_{\text%
{vic}}(x_{0}|y_{\text{tar}})\int p(x_{T})\prod_{t=1}^{T}p_{\theta}(x_{t-1}|x_{%
t})dx_{1\dots T}
p(x_{T})
N(0,I)
p_{\text{vic}}(x|y_{\text{tar}})\propto\exp(-cf(x,y_{\text{tar}}))
x_{0}
p_{\text{vic}}
\int p(x_{T})\prod_{t=1}^{T}p_{\text{vic}}(x_{0}|y_{\text{tar}})^{1/T}p_{%
\theta}(x_{t-1}|x_{t})dx_{1\dots T}
x_{0}
x_{t-1}
x_{0}
x_{t}
\hat{x}_{0|t}=\frac{1}{\sqrt{\bar{\alpha}_{t}}}(x_{t}-\sqrt{1-\bar{\alpha}_{t}%
}\,\epsilon_{\theta}(x_{t}))
\epsilon_{\theta}(x_{t})
\epsilon_{\theta}(x_{t})=\frac{\sqrt{1-\bar{\alpha}_{t}}}{\beta_{t}}(x_{t}-%
\sqrt{\alpha_{t}}\,\mu_{\theta}(x_{t}))
\int p(x_{T})\prod_{t=1}^{T}p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}%
p_{\theta}(x_{t-1}|x_{t})dx_{1\dots T}
x_{t-1}
p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}p_{\theta}(x_{t-1}|x_{t})
p_{\text{vic}}(x|y_{\text{tar}})\propto\exp(-cf(x,y_{\text{tar}}))
p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t}),\Sigma_{%
\theta}(x_{t}))
\displaystyle p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}p_{\theta}(x_{%
t-1}|x_{t})\approx\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t})+\frac{c}{T}\Sigma_{%
\theta}(x_{t})g,\Sigma_{\theta}(x_{t}))
\displaystyle p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}p_{\theta}(x_{%
t-1}|x_{t})\approx\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t})+\frac{c}{T}\Sigma_{%
\theta}(x_{t})g,\Sigma_{\theta}(x_{t}))
g=-\nabla_{x_{t-1}}f(\hat{x}_{0|t},y_{\text{tar}})|_{x_{t-1}=\mu_{\theta}(x_{t%
})}
\hat{x}_{0|t}
\nabla_{x_{t-1}}f(\hat{x}_{0|t},y_{\text{tar}})|_{x_{t-1}=\mu_{\theta}(x_{t})}%
\approx\nabla_{x_{t-1}}f(\hat{x}_{0|t},y_{\text{tar}})|_{x_{t-1}=x_{t}}
p_{\text{adv}}
L_{2}
L_{2}
p_{\text{dis}}(\cdot|x_{\text{ori}})
x_{\text{ori}}
x_{\text{ori}}
\{t_{1}(x_{\text{ori}}),t_{2}(x_{\text{ori}}),\dots\}
t_{i}
\mathcal{T}
p_{\text{vic}}
f_{\text{CW}}
f
p_{\text{dis}}
f_{\text{CW}}
p_{\text{vic}}
20\times 10\times 9=1800
x_{\text{ori}}
c=5
c=10
c=20
x_{\text{ori}}
p_{\text{dis}}(\cdot|x_{\text{ori}})
p_{\theta}(x_{t-1}|x_{t})
x_{\text{ori}}
f_{\text{CE}}
f
c=5
c=10
c=20
c=5
c=10
c=20
x_{\text{ori}}
f_{\text{CW}}
f_{\text{CE}}
x_{\text{ori}}
x_{\text{ori}}
p_{\text{vic}}(x_{\text{adv}}|y_{\text{tar}})\propto\exp(-c_{2}\,f(x_{\text{%
adv}},y_{\text{tar}}))
p_{\text{dis}}(x_{\text{adv}}|x_{\text{ori}})\propto\exp(-c_{1}\,\mathcal{D}(x%
_{\text{ori}},x_{\text{adv}}))
p_{\text{adv}}
{x}_{0}\sim p_{0},\quad{x}_{t+1}=\Pi_{[0,1]^{n}}\left({x}_{t}-\frac{\epsilon^{%
2}}{2}\nabla_{x}\mathcal{L}({x}_{t},y_{\text{tar}})+\epsilon{z}_{t}\right),%
\quad{z}_{t}\sim\mathcal{N}(0,I)
\Pi{[0,1]^{n}}
[0,1]^{n}
p_{\text{gibbs}}
\displaystyle p_{\text{gibbs}}(x_{\text{adv}}|y_{\text{tar}})\propto\exp(-%
\mathcal{L}(x_{\text{adv}},y_{\text{tar}}))
\displaystyle p_{\text{gibbs}}(x_{\text{adv}}|y_{\text{tar}})
\displaystyle\propto\exp(-\mathcal{L}(x_{\text{adv}},y_{\text{tar}}))
\displaystyle\propto\exp(-c_{1}\,\mathcal{D}(x_{\text{ori}},x_{\text{adv}})-c_%
{2}\,f(x_{\text{adv}},y_{\text{tar}}))
\displaystyle\propto\exp(-c_{1}\,\mathcal{D}(x_{\text{ori}},x_{\text{adv}})-c_%
{2}\,f(x_{\text{adv}},y_{\text{tar}}))
\displaystyle\propto\exp(-c_{1}\,\mathcal{D}(x_{\text{ori}},x_{\text{adv}}))%
\exp(-c_{2}\,f(x_{\text{adv}},y_{\text{tar}}))
\displaystyle\propto\exp(-c_{1}\,\mathcal{D}(x_{\text{ori}},x_{\text{adv}}))%
\exp(-c_{2}\,f(x_{\text{adv}},y_{\text{tar}}))
\displaystyle\propto p_{\text{dis}}(x_{\text{adv}}|x_{\text{ori}})\,p_{\text{%
vic}}(x_{\text{adv}}|y_{\text{tar}})
\displaystyle\propto p_{\text{dis}}(x_{\text{adv}}|x_{\text{ori}})\,p_{\text{%
vic}}(x_{\text{adv}}|y_{\text{tar}})
p_{\text{adv}}
p_{\text{vic}}(x|y_{\text{tar}})\propto\exp(-cf(x,y_{\text{tar}}))
p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t}),\Sigma_{%
\theta}(x_{t}))
p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}p_{\theta}(x_{t-1}|x_{t})%
\approx\mathcal{N}\left(\mu_{\theta}(x_{t})+\frac{c}{T}\Sigma_{\theta}(x_{t})g%
,\Sigma_{\theta}(x_{t})\right)
g=-\nabla_{x_{t-1}}f(\hat{x}_{0|t},y_{\text{tar}})|_{x_{t-1}=\mu_{\theta}(x_{t%
})}
\hat{x}_{0|t}
\mu=\mu_{\theta}(x_{t})
\Sigma=\Sigma_{\theta}(x_{t})
\lVert\Sigma\rVert\rightarrow 0
\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})
\Sigma^{-1}
\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})
x_{t-1}=\mu
\hat{x}_{0|t}
x_{t-1}
\displaystyle\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})\approx\log p_{%
\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})|_{x_{t-1}=\mu}+(x_{t-1}-\mu)\nabla_{%
x_{t-1}}\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})|_{x_{t-1}=\mu}
\displaystyle\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})
\displaystyle\approx\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})|_{x_{t-1%
}=\mu}+(x_{t-1}-\mu)\nabla_{x_{t-1}}\log p_{\text{vic}}(\hat{x}_{0|t}|y_{\text%
{tar}})|_{x_{t-1}=\mu}
\displaystyle=C_{1}+(x_{t-1}-\mu)\nabla_{x_{t-1}}(-cf(\hat{x}_{0|t},y_{\text{%
tar}}))|_{x_{t-1}=\mu}
\displaystyle=C_{1}+(x_{t-1}-\mu)\nabla_{x_{t-1}}(-cf(\hat{x}_{0|t},y_{\text{%
tar}}))|_{x_{t-1}=\mu}
\displaystyle=C_{1}+(x_{t-1}-\mu)cg
\displaystyle=C_{1}+(x_{t-1}-\mu)cg
C_{1}
g=-\nabla_{x_{t-1}}f(\hat{x}_{0|t},y_{\text{tar}})|_{x_{t-1}=\mu_{\theta}(x_{t%
})}
\displaystyle\log(p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}p_{\theta}%
(x_{t-1}|x_{t}))=\log p_{\theta}(x_{t-1}|x_{t})+\frac{1}{T}\log p_{\text{vic}}%
(\hat{x}_{0|t}|y_{\text{tar}})
\displaystyle\log(p_{\text{vic}}(\hat{x}_{0|t}|y_{\text{tar}})^{1/T}p_{\theta}%
(x_{t-1}|x_{t}))
\displaystyle=\log p_{\theta}(x_{t-1}|x_{t})+\frac{1}{T}\log p_{\text{vic}}(%
\hat{x}_{0|t}|y_{\text{tar}})
\displaystyle\approx-\frac{1}{2}(x_{t-1}-\mu)^{T}\Sigma^{-1}(x_{t-1}-\mu)+%
\frac{c}{T}(x_{t-1}-\mu)g+C_{2}
\displaystyle\approx-\frac{1}{2}(x_{t-1}-\mu)^{T}\Sigma^{-1}(x_{t-1}-\mu)+%
\frac{c}{T}(x_{t-1}-\mu)g+C_{2}
\displaystyle=-\frac{1}{2}(x_{t-1}-\mu-\frac{c}{T}\Sigma g)^{T}\Sigma^{-1}(x_{%
t-1}-\mu-\frac{c}{T}\Sigma g)+\frac{c^{2}}{2T^{2}}g^{T}\Sigma g+C_{2}
\displaystyle=-\frac{1}{2}(x_{t-1}-\mu-\frac{c}{T}\Sigma g)^{T}\Sigma^{-1}(x_{%
t-1}-\mu-\frac{c}{T}\Sigma g)+\frac{c^{2}}{2T^{2}}g^{T}\Sigma g+C_{2}
\displaystyle=-\frac{1}{2}(x_{t-1}-\mu-\frac{c}{T}\Sigma g)^{T}\Sigma^{-1}(x_{%
t-1}-\mu-\frac{c}{T}\Sigma g)+C_{3}
\displaystyle=-\frac{1}{2}(x_{t-1}-\mu-\frac{c}{T}\Sigma g)^{T}\Sigma^{-1}(x_{%
t-1}-\mu-\frac{c}{T}\Sigma g)+C_{3}
\mu+\frac{c}{T}\Sigma g
\Sigma
g
x_{0}\sim p_{0},\quad{x}_{t+1}={x}_{t}-\frac{\epsilon^{2}}{2}\nabla_{x}g({x}_{%
t})+\epsilon z_{t},\quad z_{t}\sim\mathcal{N}(0,I)
p_{0}
\nabla_{x}g
{x}_{t}
p(x)\propto\exp(-g(x))
g
g
E_{\theta}
\mathcal{L}_{\text{EBM}}=\mathbb{E}_{x\sim p_{d}}[-\log p_{\theta}(x)]=\mathbb%
{E}_{x\sim p_{d}}[E_{\theta}(x)]-\log Z_{\theta}
p_{d}
\displaystyle\nabla_{\theta}\mathcal{L}_{\text{EBM}}=\mathbb{E}_{x\sim p_{d}}[%
\nabla_{\theta}E_{\theta}(x)]-\nabla_{\theta}\log Z_{\theta}
\displaystyle\nabla_{\theta}\mathcal{L}_{\text{EBM}}
\displaystyle=\mathbb{E}_{x\sim p_{d}}[\nabla_{\theta}E_{\theta}(x)]-\nabla_{%
\theta}\log Z_{\theta}
\displaystyle=\mathbb{E}_{x\sim p_{d}}[\nabla_{\theta}E_{\theta}(x)]-\mathbb{E%
}_{x\sim p_{\theta}}[\nabla_{\theta}E_{\theta}(x)]
\displaystyle=\mathbb{E}_{x\sim p_{d}}[\nabla_{\theta}E_{\theta}(x)]-\mathbb{E%
}_{x\sim p_{\theta}}[\nabla_{\theta}E_{\theta}(x)]
\nabla_{\theta}\mathcal{L}_{\text{EBM}}
p_{d}
p_{\theta}
L_{\text{vlb}}:=L_{0}+L_{1}+\ldots+L_{T-1}+L_{T}
L_{0}:=-\log p_{\theta}(x_{0}|x_{1}),\;\;\;L_{t-1}:=D_{KL}(q(x_{t-1}|x_{t},x_{%
0})||p_{\theta}(x_{t-1}|x_{t})),\;\;\;L_{T}:=D_{KL}(q(x_{T}|x_{0})||p(x_{T}))
\Sigma_{\theta}=\sigma_{t}^{2}I
\sigma_{t}=\beta_{t}
\sigma_{t}=\tilde{\beta}_{t}
\tilde{\beta}_{t}:=\frac{1-\bar{\alpha}_{t-1}}{1-\bar{\alpha}_{t}}\beta_{t}
\mu_{\theta}(x_{t},t)=\frac{1}{\sqrt{\alpha_{t}}}\left(x_{t}-\frac{\beta_{t}}{%
\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{\theta}(x_{t},t)\right)
L_{\text{simple}}
L_{\text{simple}}=E_{t,x_{0},\epsilon}\left[\lVert\epsilon-\epsilon_{\theta}(x%
_{t},t)\rVert^{2}\right]
\Sigma_{\theta}(x_{t},t)=\exp(v\log\beta_{t}+(1-v)\log\tilde{\beta}_{t})
\Sigma_{\theta}
L_{\text{simple}}
L_{\text{hybrid}}=L_{\text{simple}}+\lambda L_{\text{vlb}}
p_{\text{adv}}
E_{\theta}
x_{\text{ori}}
f
y_{\text{tar}}
T
\epsilon
c
x
x\sim N(0,I)
t=1
T
z\sim N(0,I)
x=x-\frac{\epsilon^{2}}{2}\left(c\nabla_{x}f(x,y_{\text{tar}})+\nabla_{x}E_{%
\theta}(x)\right)+\epsilon z
p_{\text{adv}}
(\mu_{\theta},\Sigma_{\theta})
f
x_{\text{ori}}
y_{\text{tar}}
T
\beta_{1},\dots,\beta_{T}
\alpha_{1},\dots,\alpha_{T}
\bar{\alpha}_{1},\dots,\bar{\alpha}_{T}
c
x_{0}
x_{T}\sim N(0,I)
t=T
1
\epsilon_{\theta}(x_{t})=\frac{\sqrt{1-\bar{\alpha}_{t}}}{\beta_{t}}(x_{t}-%
\sqrt{\alpha_{t}}\mu_{\theta}(x_{t}))
\hat{x}_{0|t}=\frac{1}{\sqrt{\bar{\alpha}_{t}}}(x_{t}-\sqrt{1-\bar{\alpha}_{t}%
}\,\epsilon_{\theta}(x_{t}))
x_{t-1}\sim\mathcal{N}(\mu_{\theta}(x_{t})-\frac{c}{T}\Sigma_{\theta}(x_{t})%
\nabla_{x_{t}}f(\hat{x}_{0|t},y_{\text{tar}}),\Sigma_{\theta}(x_{t}))
\mathcal{P}_{\text{sou}}
\mathcal{P}_{\text{tar}}
x_{\text{ori}}
t_{\text{TPS}}(x_{\text{ori}},\mathcal{P}_{\text{sou}},\mathcal{P}_{\text{tar}})
x_{\text{ori}}
5\times 5
\mathcal{P}_{\text{sou}}
\mathcal{P}_{\text{tar}}
x_{\text{ori}}
5\times 5
\mathcal{P}_{\text{sou}}
\mathcal{P}_{\text{tar}}
x_{\text{ori}}
x_{\text{ori}}
t(x_{\text{ori}})
t(x_{\text{ori}})
x_{\text{ori}}
5\times 5
\mathcal{P}_{\text{sou}}=\{(x^{(i)},y^{(i)})\}_{i=1}^{5\times 5}
\mathcal{P}_{\text{tar}}=\{(x^{(i)}+\epsilon_{x}^{(i)},y^{(i)}+\epsilon_{y}^{(%
i)})\}_{i=1}^{5\times 5}
\epsilon_{x}^{(i)},\epsilon_{y}^{(i)}\sim\mathcal{N}(0,\sigma^{2})
x_{\text{ori}}
\mathcal{P}_{\text{sou}}
\mathcal{P}_{\text{tar}}
\sigma
p_{\text{adv}}(\cdot|x_{\text{ori}},y_{\text{tar}})
N
M
\kappa
N
E
E(\cdot;x_{\text{ori}})
x_{\text{ori}}
g_{\phi}
g_{\psi}
M
N
\kappa
N
x
x=\emptyset
0\leq i<M
x_{\text{adv}}\sim p_{\text{adv}}(\cdot;x_{\text{ori}},y_{\text{tar}})
\arg\max_{y}g_{\phi}(x_{\text{adv}})[y]=y_{\text{tar}}
x=x\cup\{x_{\text{adv}}\}
x
\sigma(g_{\psi}(x_{i}))[y_{\text{ori}}]
i\in\{1,\dots,|x|\}
x=(x_{i})_{i=1}^{\lfloor\kappa|x|\rfloor}
\kappa
x
x
E(x_{i};x_{\text{ori}})
i\in\{1,\dots,|x|\}
x=(x_{i})_{i=1}^{N}
N
x
x_{\text{ori}}
T^{\prime}
T
p_{\text{adv}}
(\mu_{\theta},\Sigma_{\theta})
f
x_{\text{ori}}
y_{\text{tar}}
T
T^{\prime}
\beta_{1},\dots,\beta_{T}
\alpha_{1},\dots,\alpha_{T}
\bar{\alpha}_{1},\dots,\bar{\alpha}_{T}
c
x_{0}
x_{T^{\prime}}\sim N(\sqrt{\bar{\alpha}_{T^{\prime}}}x_{\text{ori}},(1-\bar{%
\alpha}_{T^{\prime}})I)
t=T^{\prime}
1
\epsilon_{\theta}(x_{t})=\frac{\sqrt{1-\bar{\alpha}_{t}}}{\beta_{t}}(x_{t}-%
\sqrt{\alpha_{t}}\mu_{\theta}(x_{t}))
\hat{x}_{0|t}=\frac{1}{\sqrt{\bar{\alpha}_{t}}}(x_{t}-\sqrt{1-\bar{\alpha}_{t}%
}\,\epsilon_{\theta}(x_{t}))
x_{t-1}\sim\mathcal{N}(\mu_{\theta}(x_{t})-\frac{c}{T}\Sigma_{\theta}(x_{t})%
\nabla_{x_{t}}f(\hat{x}_{0|t},y_{\text{tar}}),\Sigma_{\theta}(x_{t}))
