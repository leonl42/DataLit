\theta\in\Theta
p(y\,|\,x,\theta)
\theta
\mathbf{x}:=(x_{i})_{i=1}^{n}
\mathbf{y}:=(y_{i})_{i=1}^{n}
x_{i}\in{\mathcal{X}}
y_{i}\in{\mathcal{Y}}
\pi_{0}(\theta)
\displaystyle\pi_{\mathbf{x}}(\theta):=\frac{\pi_{0}(\theta)}{Z(\mathbf{y}\,|%
\,\mathbf{x})}\prod_{i=1}^{n}p(y_{i}\,|\,x_{i},\theta),\quad Z(\mathbf{y}\,|\,%
\mathbf{x}):=\int_{\Theta}\prod_{i=1}^{n}p(y_{i}\,|\,x_{i},\theta)\pi_{0}(%
\mathrm{d}\theta).
\displaystyle\pi_{\mathbf{x}}(\theta):=\frac{\pi_{0}(\theta)}{Z(\mathbf{y}\,|%
\,\mathbf{x})}\prod_{i=1}^{n}p(y_{i}\,|\,x_{i},\theta),\quad Z(\mathbf{y}\,|\,%
\mathbf{x}):=\int_{\Theta}\prod_{i=1}^{n}p(y_{i}\,|\,x_{i},\theta)\pi_{0}(%
\mathrm{d}\theta).
n
\mathbf{u}=(u_{j})_{j=1}^{m}
m\ll n
\tilde{\mathbf{y}}:=(\tilde{y}_{j})_{j=1}^{m}
\pi_{\mathbf{x}}(\theta)
\displaystyle\pi_{\mathbf{u}}(\theta)=\frac{\pi_{0}(\theta)}{Z(\tilde{\mathbf{%
y}}\,|\,\mathbf{u})}\prod_{j=1}^{m}p(\tilde{y}_{j}\,|\,u_{j},\theta),\quad Z(%
\tilde{\mathbf{y}}\,|\,\mathbf{u}):=\int_{\Theta}\prod_{j=1}^{m}p(\tilde{y}_{j%
}\,|\,u_{j},\theta)\pi_{0}(\mathrm{d}\theta).
\displaystyle\pi_{\mathbf{u}}(\theta)=\frac{\pi_{0}(\theta)}{Z(\tilde{\mathbf{%
y}}\,|\,\mathbf{u})}\prod_{j=1}^{m}p(\tilde{y}_{j}\,|\,u_{j},\theta),\quad Z(%
\tilde{\mathbf{y}}\,|\,\mathbf{u}):=\int_{\Theta}\prod_{j=1}^{m}p(\tilde{y}_{j%
}\,|\,u_{j},\theta)\pi_{0}(\mathrm{d}\theta).
D
\tilde{\mathbf{y}}
\displaystyle\mathbf{u}^{*}=\operatorname*{arg\,min}_{\mathbf{u}}\,\,D(\pi_{%
\mathbf{x}},\pi_{\mathbf{u}}).
\displaystyle\mathbf{u}^{*}=\operatorname*{arg\,min}_{\mathbf{u}}\,\,D(\pi_{%
\mathbf{x}},\pi_{\mathbf{u}}).
\displaystyle D_{\mathrm{KL}}[\pi_{\mathbf{x}}\|\pi_{\mathbf{u}}]=\log Z(%
\tilde{\mathbf{y}}\,|\,\mathbf{u})-\log Z(\mathbf{y}\,|\,\mathbf{x})
\displaystyle D_{\mathrm{KL}}[\pi_{\mathbf{x}}\|\pi_{\mathbf{u}}]
\displaystyle=\log Z(\tilde{\mathbf{y}}\,|\,\mathbf{u})-\log Z(\mathbf{y}\,|\,%
\mathbf{x})
\displaystyle\quad+\mathbb{E}_{\pi_{\mathbf{x}}}\bigg{[}\sum_{i=1}^{n}\log p(y%
_{i}\,|\,x_{i},\theta)\bigg{]}-\mathbb{E}_{\pi_{\mathbf{x}}}\bigg{[}\sum_{j=1}%
^{m}\log p(\tilde{y}_{j}\,|\,u_{j},\theta)\bigg{]}.
\displaystyle\quad+\mathbb{E}_{\pi_{\mathbf{x}}}\bigg{[}\sum_{i=1}^{n}\log p(y%
_{i}\,|\,x_{i},\theta)\bigg{]}-\mathbb{E}_{\pi_{\mathbf{x}}}\bigg{[}\sum_{j=1}%
^{m}\log p(\tilde{y}_{j}\,|\,u_{j},\theta)\bigg{]}.
\mathbf{u}
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\pi_{\mathbf{x}}\|\pi_{\mathbf%
{u}}]=\mathbb{E}_{\pi_{\mathbf{u}}}\bigg{[}\nabla_{\mathbf{u}}\sum_{j=1}^{m}%
\log p(\tilde{y}_{j}\,|\,u_{j},\theta)\bigg{]}-\nabla_{\mathbf{u}}\mathbb{E}_{%
\pi_{\mathbf{x}}}\bigg{[}\sum_{j=1}^{m}\log p(\tilde{y}_{j}|u_{j},\theta))%
\bigg{]}
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\pi_{\mathbf{x}}\|\pi_{\mathbf%
{u}}]=\mathbb{E}_{\pi_{\mathbf{u}}}\bigg{[}\nabla_{\mathbf{u}}\sum_{j=1}^{m}%
\log p(\tilde{y}_{j}\,|\,u_{j},\theta)\bigg{]}-\nabla_{\mathbf{u}}\mathbb{E}_{%
\pi_{\mathbf{x}}}\bigg{[}\sum_{j=1}^{m}\log p(\tilde{y}_{j}|u_{j},\theta))%
\bigg{]}
\pi_{\mathbf{x}}
\pi_{\mathbf{u}}
q_{\mathbf{u}}(\theta)
q_{\mathbf{x}}(\theta)
\pi_{\mathbf{x}}
\pi_{\mathbf{u}}
\displaystyle q_{\mathbf{u}}(\theta)={\mathcal{N}}(\theta;\mu_{\mathbf{u}},%
\Sigma_{\mathbf{u}}),\quad q_{\mathbf{x}}(\theta)={\mathcal{N}}(\theta;\mu_{%
\mathbf{x}},\Sigma_{\mathbf{x}}),
\displaystyle q_{\mathbf{u}}(\theta)={\mathcal{N}}(\theta;\mu_{\mathbf{u}},%
\Sigma_{\mathbf{u}}),\quad q_{\mathbf{x}}(\theta)={\mathcal{N}}(\theta;\mu_{%
\mathbf{x}},\Sigma_{\mathbf{x}}),
\mu_{\mathbf{u}}
\mu_{\mathbf{x}}
\mathbf{u}
\mathbf{x}
\Sigma_{\mathbf{u}}
\Sigma_{\mathbf{x}}
\mu_{\mathbf{u}}
\displaystyle\frac{\nabla_{\mathbf{u}}}{S}\sum_{s=1}^{S}\left(\sum_{j=1}^{m}%
\log p\Big{(}\tilde{y}_{j}\,|\,u_{j},\texttt{sg}(\mu_{\mathbf{u}})+\Sigma_{%
\mathbf{u}}^{1/2}\varepsilon_{\mathbf{u}}^{(s)}\Big{)}-\sum_{j=1}^{m}\log p%
\Big{(}\tilde{y}_{j}\,|\,u_{j},\mu_{\mathbf{x}}+\Sigma_{\mathbf{x}}^{1/2}%
\varepsilon_{\mathbf{x}}^{(s)}\Big{)}\right).
\displaystyle\frac{\nabla_{\mathbf{u}}}{S}\sum_{s=1}^{S}\left(\sum_{j=1}^{m}%
\log p\Big{(}\tilde{y}_{j}\,|\,u_{j},\texttt{sg}(\mu_{\mathbf{u}})+\Sigma_{%
\mathbf{u}}^{1/2}\varepsilon_{\mathbf{u}}^{(s)}\Big{)}-\sum_{j=1}^{m}\log p%
\Big{(}\tilde{y}_{j}\,|\,u_{j},\mu_{\mathbf{x}}+\Sigma_{\mathbf{x}}^{1/2}%
\varepsilon_{\mathbf{x}}^{(s)}\Big{)}\right).
\varepsilon_{\mathbf{u}}^{(s)}
\varepsilon_{\mathbf{x}}^{(s)}
S
\mu_{\mathbf{u}}
\mu_{\mathbf{x}}
\mu_{\mathbf{u}}
\mu_{\mathbf{x}}
\mathbf{u}
\theta_{0}
\mu_{\mathbf{u}}
\mu_{\mathbf{x}}
\theta_{0}
\pi_{0}(\theta)
g_{\theta}:{\mathcal{X}}\to\mathbb{R}^{d}
\theta
h:\Theta\to({\mathcal{X}}\to\mathbb{R}^{d})
\theta
g_{\theta}
\nu_{0}(f)=h_{*}\pi_{0}(f):=\pi_{0}(h^{-1}(f))
\nu_{\mathbf{x}}(f)=h_{*}\pi_{\mathbf{x}}(f)
\nu_{\mathbf{u}}(f)=h_{*}\pi_{\mathbf{u}}(f)
\displaystyle\mathbf{u}^{*}=\operatorname*{arg\,min}_{\mathbf{u}}\,\,D(\nu_{%
\mathbf{x}},\nu_{\mathbf{u}}).
\displaystyle\mathbf{u}^{*}=\operatorname*{arg\,min}_{\mathbf{u}}\,\,D(\nu_{%
\mathbf{x}},\nu_{\mathbf{u}}).
\displaystyle\mathbf{u}^{*}=\operatorname*{arg\,min}_{\mathbf{u}}\,\,D_{%
\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}].
\displaystyle\mathbf{u}^{*}=\operatorname*{arg\,min}_{\mathbf{u}}\,\,D_{%
\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}].
\mathbf{u}
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\mathbb{E}_{[\nu_{\mathbf{u}}%
]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{%
\mathbf{u}})],
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\mathbb{E}_{[\nu_{\mathbf{u}}%
]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{%
\mathbf{u}})],
[\nu_{\mathbf{x}}]_{\mathbf{u}}
[\nu_{\mathbf{u}}]_{\mathbf{u}}
\nu_{\mathbf{x}}
\nu_{\mathbf{u}}
\mathbf{f}_{\mathbf{u}}:=(f(u_{j}))_{j=1}^{m}
p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})=\prod_{j=1}^{m}p(\tilde{y}_{%
j}\,|\,f(u_{j}))
[\nu_{\mathbf{x}}]_{\mathbf{u}}
[\nu_{\mathbf{u}}]_{\mathbf{u}}
g_{\theta}
\displaystyle\tilde{g}_{\theta}(\cdot)=g_{\mu_{\mathbf{x}}}(\cdot)+{\mathcal{J%
}}_{\mu_{\mathbf{x}}}(\cdot)(\theta-\mu_{\mathbf{x}}),
\displaystyle\tilde{g}_{\theta}(\cdot)=g_{\mu_{\mathbf{x}}}(\cdot)+{\mathcal{J%
}}_{\mu_{\mathbf{x}}}(\cdot)(\theta-\mu_{\mathbf{x}}),
\mu_{\mathbf{x}}=\mathbb{E}_{\pi_{\mathbf{x}}}[\theta]
{\mathcal{J}}_{\mu_{\mathbf{x}}}(\cdot)
g_{\theta}
\mu_{\mathbf{x}}
\nu_{\mathbf{x}}
\tilde{\nu}_{\mathbf{x}}:=\tilde{h}_{*}\pi_{\mathbf{x}}
\tilde{h}(\theta)=\tilde{g}_{\theta}
[\tilde{\nu}_{\mathbf{x}}]_{\mathbf{u}}
{}_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}\Big{(}\mathbf{f}_{%
\mathbf{u}}\,|\,g_{\mu_{\mathbf{x}}}(\mathbf{u}),{\mathcal{J}}_{\mu_{\mathbf{x%
}}}(\mathbf{u})\Sigma_{\mathbf{x}}{\mathcal{J}}_{\mu_{\mathbf{x}}}(\mathbf{u})%
^{\top}\Big{)},
\displaystyle{}_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}\Big{(}%
\mathbf{f}_{\mathbf{u}}\,|\,g_{\mu_{\mathbf{x}}}(\mathbf{u}),{\mathcal{J}}_{%
\mu_{\mathbf{x}}}(\mathbf{u})\Sigma_{\mathbf{x}}{\mathcal{J}}_{\mu_{\mathbf{x}%
}}(\mathbf{u})^{\top}\Big{)},
\Sigma_{\mathbf{x}}=\mathrm{Cov}_{\pi_{\mathbf{x}}}(\theta)
{}_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}\Big{(}\mathbf{f}_{%
\mathbf{u}}\,|\,g_{\mu_{\mathbf{u}}}(\mathbf{u}),{\mathcal{J}}_{\mu_{\mathbf{u%
}}}(\mathbf{u})\Sigma_{\mathbf{u}}{\mathcal{J}}_{\mu_{\mathbf{u}}}(\mathbf{u})%
^{\top}\Big{)},
\displaystyle{}_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}\Big{(}%
\mathbf{f}_{\mathbf{u}}\,|\,g_{\mu_{\mathbf{u}}}(\mathbf{u}),{\mathcal{J}}_{%
\mu_{\mathbf{u}}}(\mathbf{u})\Sigma_{\mathbf{u}}{\mathcal{J}}_{\mu_{\mathbf{u}%
}}(\mathbf{u})^{\top}\Big{)},
\mu_{\mathbf{u}}:=\mathbb{E}_{\pi_{\mathbf{u}}}[\theta]
\Sigma_{\mathbf{u}}:=\mathrm{Cov}_{\pi_{\mathbf{u}}}(\theta)
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\tilde{\nu}_{\mathbf{x}}]_{\mathbf{u}}}%
[\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\mathbb{E}_{[\tilde{%
\nu}_{\mathbf{u}}]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}%
\,|\,\mathbf{f}_{\mathbf{u}})],
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\tilde{\nu}_{\mathbf{x}}]_{\mathbf{u}}}%
[\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\mathbb{E}_{[\tilde{%
\nu}_{\mathbf{u}}]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}%
\,|\,\mathbf{f}_{\mathbf{u}})],
\mu_{\mathbf{x}}
\Sigma_{\mathbf{x}}
\pi_{\mathbf{x}}
q_{\mathbf{x}}(\theta)
\tilde{h}_{*}q_{\mathbf{x}}
{\mathcal{J}}_{\mathbb{E}_{q_{\mathbf{x}}}[\theta]}(\mathbf{u})
\mathbf{u}
\displaystyle[\tilde{\nu}_{\mathbf{x}}]_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})%
\approx q_{\mathbf{x}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}(\mathbf{f}_{%
\mathbf{u}}\,|\,g_{\hat{\mu}_{\mathbf{x}}}(\mathbf{u}),\hat{\Psi}_{\mathbf{x}}),
\displaystyle[\tilde{\nu}_{\mathbf{x}}]_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})%
\approx q_{\mathbf{x}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}(\mathbf{f}_{%
\mathbf{u}}\,|\,g_{\hat{\mu}_{\mathbf{x}}}(\mathbf{u}),\hat{\Psi}_{\mathbf{x}}),
\displaystyle[\tilde{\nu}_{\mathbf{u}}]_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})%
\approx q_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}(\mathbf{f}_{%
\mathbf{u}}\,|\,g_{\hat{\mu}_{\mathbf{u}}}(\mathbf{u}),\hat{\Psi}_{\mathbf{u}}),
\displaystyle[\tilde{\nu}_{\mathbf{u}}]_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})%
\approx q_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})={\mathcal{N}}(\mathbf{f}_{%
\mathbf{u}}\,|\,g_{\hat{\mu}_{\mathbf{u}}}(\mathbf{u}),\hat{\Psi}_{\mathbf{u}}),
(\hat{\mu}_{\mathbf{x}},\hat{\Psi}_{\mathbf{x}})
(\hat{\mu}_{\mathbf{u}},\hat{\Psi}_{\mathbf{u}})
\mathbf{x}
\theta_{\mathbf{x}}
\mathbf{u}
\theta_{\mathbf{u}}
\hat{\mu}_{\mathbf{x}}
\hat{\mu}_{\mathbf{u}}
\mathbf{u}
\hat{\Psi}_{\mathbf{x}}
\hat{\Psi}_{\mathbf{u}}
K
\displaystyle\theta^{(0)}_{\mathbf{x}}=\theta_{\mathbf{x}},\quad\theta_{%
\mathbf{x}}^{(t)}=\texttt{opt}(\theta_{\mathbf{x}}^{(t-1)},(\mathbf{x},\mathbf%
{y})),\quad\hat{\mu}_{\mathbf{x}}=g_{{\color[rgb]{0.72,0,0}\texttt{sg}({\theta%
_{\mathbf{x}}^{(0)}})}}(\mathbf{u}),
\displaystyle\theta^{(0)}_{\mathbf{x}}=\theta_{\mathbf{x}},\quad\theta_{%
\mathbf{x}}^{(t)}=\texttt{opt}(\theta_{\mathbf{x}}^{(t-1)},(\mathbf{x},\mathbf%
{y})),\quad\hat{\mu}_{\mathbf{x}}=g_{{\color[rgb]{0.72,0,0}\texttt{sg}({\theta%
_{\mathbf{x}}^{(0)}})}}(\mathbf{u}),
\displaystyle\hat{\Psi}_{\mathbf{x}}:={\color[rgb]{0.72,0,0}\texttt{sg}\Bigg{(%
}\mathrm{diag}\Bigg{(}\frac{1}{K}\sum_{k=1}^{K}g^{2}_{\theta_{\mathbf{x}}^{(k)%
}}(\mathbf{u})-\bigg{(}\frac{1}{K}\sum_{k=1}^{K}g_{\theta_{\mathbf{x}}^{(k)}}(%
\mathbf{u})\bigg{)}^{2}\Bigg{)}\Bigg{)}},
\displaystyle\hat{\Psi}_{\mathbf{x}}:={\color[rgb]{0.72,0,0}\texttt{sg}\Bigg{(%
}\mathrm{diag}\Bigg{(}\frac{1}{K}\sum_{k=1}^{K}g^{2}_{\theta_{\mathbf{x}}^{(k)%
}}(\mathbf{u})-\bigg{(}\frac{1}{K}\sum_{k=1}^{K}g_{\theta_{\mathbf{x}}^{(k)}}(%
\mathbf{u})\bigg{)}^{2}\Bigg{)}\Bigg{)}},
\texttt{opt}(\theta,\mathbf{x})
\theta
\mathbf{x}
\mathrm{diag}(\cdot)
(\hat{\mu}_{\mathbf{u}},\hat{\Psi}_{\mathbf{u}})
(\mathbf{u},\tilde{\mathbf{y}})
(\mathbf{x},\mathbf{y})
\displaystyle\hbox to0.0pt{$\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[%
\nu_{\mathbf{x}}|\nu_{\mathbf{u}}]\approx-\nabla_{\mathbf{u}}\mathbb{E}_{q_{%
\mathbf{x}}(\mathbf{f}_{\mathbf{u}})}[\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}%
_{\mathbf{u}})]+\mathbb{E}_{q_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})}\Big{[}%
\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})\Big{%
]}$\hss}
\displaystyle\hbox to0.0pt{$\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[%
\nu_{\mathbf{x}}|\nu_{\mathbf{u}}]\approx-\nabla_{\mathbf{u}}\mathbb{E}_{q_{%
\mathbf{x}}(\mathbf{f}_{\mathbf{u}})}[\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}%
_{\mathbf{u}})]+\mathbb{E}_{q_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})}\Big{[}%
\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})\Big{%
]}$\hss}
\displaystyle=-\nabla_{\mathbf{u}}\mathbb{E}_{p(\varepsilon_{\mathbf{x}})}[%
\log p(\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{x}}+\hat{\Psi}_{\mathbf{x}}^{%
1/2}\varepsilon_{\mathbf{x}})]+\mathbb{E}_{p(\varepsilon_{\mathbf{u}})}\Big{[}%
\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{u}}+\hat{%
\Psi}_{\mathbf{u}}^{1/2}\varepsilon_{\mathbf{u}})\Big{]}
\displaystyle=-\nabla_{\mathbf{u}}\mathbb{E}_{p(\varepsilon_{\mathbf{x}})}[%
\log p(\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{x}}+\hat{\Psi}_{\mathbf{x}}^{%
1/2}\varepsilon_{\mathbf{x}})]+\mathbb{E}_{p(\varepsilon_{\mathbf{u}})}\Big{[}%
\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{u}}+\hat{%
\Psi}_{\mathbf{u}}^{1/2}\varepsilon_{\mathbf{u}})\Big{]}
\displaystyle\approx\frac{1}{S}\sum_{s=1}^{S}\bigg{(}-\nabla_{\mathbf{u}}\log p%
\Big{(}\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{x}}+\hat{\Psi}_{\mathbf{x}}^{%
1/2}\varepsilon_{\mathbf{x}}^{(s)}\Big{)}+\nabla_{\mathbf{u}}\log p\Big{(}%
\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{u}}+\hat{\Psi}_{\mathbf{u}}^{1/2}%
\varepsilon_{\mathbf{u}}^{(s)}\Big{)}\bigg{)},
\displaystyle\approx\frac{1}{S}\sum_{s=1}^{S}\bigg{(}-\nabla_{\mathbf{u}}\log p%
\Big{(}\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{x}}+\hat{\Psi}_{\mathbf{x}}^{%
1/2}\varepsilon_{\mathbf{x}}^{(s)}\Big{)}+\nabla_{\mathbf{u}}\log p\Big{(}%
\tilde{\mathbf{y}}\,|\,\hat{\mu}_{\mathbf{u}}+\hat{\Psi}_{\mathbf{u}}^{1/2}%
\varepsilon_{\mathbf{u}}^{(s)}\Big{)}\bigg{)},
p(\varepsilon_{\mathbf{x}})
p(\varepsilon_{\mathbf{u}})
(\varepsilon_{\mathbf{x}}^{(s)})_{s=1}^{S}
(\varepsilon_{\mathbf{u}}^{(s)})_{s=1}^{S}
{\mathcal{A}}
\{{\mathcal{E}}^{(a)}:a\in{\mathcal{A}}\}
\{\pi_{0}^{(a)}:a\in{\mathcal{A}}\}
\mathbf{u}
m
i=1,\dots,N
\mathbf{g}\leftarrow 0
a\in{\mathcal{A}}
\mathbf{x}
\theta_{\mathbf{x}}\in{\mathcal{E}}^{(a)}
\theta_{0}\sim\pi_{0}^{(a)}(\theta)
\theta_{t}\leftarrow\texttt{opt}(\theta_{t-1},(\mathbf{u},\tilde{\mathbf{y}}))
\mathbf{u}
\theta_{\mathbf{u}}
\hat{\mu}_{\mathbf{x}}
\hat{\mu}_{\mathbf{u}}
\hat{\Psi}_{\mathbf{x}}
\hat{\Psi}_{\mathbf{u}}
\mathbf{g}^{(a)}
\mathbf{g}\leftarrow\mathbf{g}+\mathbf{g}^{(a)}
\mathbf{u}
\mathbf{g}
{\mathcal{O}}(Sp)
S
p
{\mathcal{O}}(Sd)
d
m\in\{1,10,50\}
\uparrow
\scriptstyle{\pm 0.74}
\scriptstyle{\pm 1.06}
\scriptstyle{\pm 1.62}
\scriptstyle{\pm 0.75}
\scriptstyle{\pm 0.31}
\downarrow
\scriptstyle{\pm 0.03}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.27}
\scriptstyle{\pm 0.04}
\uparrow
\scriptstyle{\pm 0.34}
\scriptstyle{\pm 0.66}
\scriptstyle{\pm 0.61}
\scriptstyle{\pm 0.35}
\scriptstyle{\pm 0.34}
\downarrow
\scriptstyle{\pm 0.03}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.02}
\uparrow
\scriptstyle{\pm 0.46}
\scriptstyle{\pm 0.38}
\scriptstyle{\pm 0.32}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.17}
\downarrow
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.05}
\uparrow
\scriptstyle{\pm 0.47}
\scriptstyle{\pm 0.31}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.08}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.12}
\downarrow
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.01}
\uparrow
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.60}
\scriptstyle{\pm 0.33}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.45}
\scriptstyle{\pm 0.32}
\downarrow
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.24}
\scriptstyle{\pm 0.03}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.02}
\uparrow
\scriptstyle{\pm 0.76}
\scriptstyle{\pm 0.31}
\scriptstyle{\pm 0.35}
\scriptstyle{\pm 0.68}
\scriptstyle{\pm 0.51}
\scriptstyle{\pm 0.31}
\downarrow
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.05}
\uparrow
\downarrow
\uparrow
\downarrow
\displaystyle D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}]=\int\log%
\frac{\mathrm{d}\nu_{\mathbf{x}}}{\mathrm{d}\nu_{\mathbf{u}}}(f)\mathrm{d}\nu_%
{\mathbf{x}}(f).
\displaystyle D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}]=\int\log%
\frac{\mathrm{d}\nu_{\mathbf{x}}}{\mathrm{d}\nu_{\mathbf{u}}}(f)\mathrm{d}\nu_%
{\mathbf{x}}(f).
\displaystyle D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}]=\int\log%
\frac{\mathrm{d}\nu_{\mathbf{x}}}{\mathrm{d}\nu_{0}}(f)\mathrm{d}\nu_{\mathbf{%
x}}(f)-\int\log\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)\mathrm{%
d}\nu_{\mathbf{x}}(f).
\displaystyle D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}]=\int\log%
\frac{\mathrm{d}\nu_{\mathbf{x}}}{\mathrm{d}\nu_{0}}(f)\mathrm{d}\nu_{\mathbf{%
x}}(f)-\int\log\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)\mathrm{%
d}\nu_{\mathbf{x}}(f).
\mathbf{u}
\displaystyle\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)=\frac{p(%
\tilde{\mathbf{y}}\,|\,f,\mathbf{u})}{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})},
\displaystyle\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)=\frac{p(%
\tilde{\mathbf{y}}\,|\,f,\mathbf{u})}{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})},
p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u}):=\prod_{j=1}^{m}p(\tilde{y}_{j}\,|\,u_{%
j},f)
\displaystyle p(\tilde{\mathbf{y}}|\mathbf{u})=\int p(\tilde{\mathbf{y}}|f,%
\mathbf{u})\mathrm{d}\nu_{0}(f).
\displaystyle p(\tilde{\mathbf{y}}|\mathbf{u})=\int p(\tilde{\mathbf{y}}|f,%
\mathbf{u})\mathrm{d}\nu_{0}(f).
\rho_{A}:({\mathcal{X}}\to\mathbb{R}^{d})\to(A\to\mathbb{R}^{d})
f
A\subseteq{\mathcal{X}}
\mathbf{u}
\displaystyle\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)=\frac{%
\mathrm{d}[\nu_{\mathbf{u}}]_{\mathbf{u}}}{\mathrm{d}[\nu_{0}]_{\mathbf{u}}}(%
\rho_{\mathbf{u}}(f))=\frac{p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})}%
{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})},
\displaystyle\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)=\frac{%
\mathrm{d}[\nu_{\mathbf{u}}]_{\mathbf{u}}}{\mathrm{d}[\nu_{0}]_{\mathbf{u}}}(%
\rho_{\mathbf{u}}(f))=\frac{p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})}%
{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})},
[\cdot]_{\mathbf{u}}
\mathbf{u}
\rho_{\mathbf{u}}(f):=\mathbf{f}_{\mathbf{u}}:=(f(u_{j}))_{j=1}^{m}
\mathbf{u}
\displaystyle\int\log\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)%
\mathrm{d}\nu_{\mathbf{x}}(f)=\int\log\frac{\mathrm{d}[\nu_{\mathbf{u}}]_{%
\mathbf{u}}}{\mathrm{d}[\nu_{0}]_{\mathbf{u}}}(\mathbf{f}_{\mathbf{u}})\mathrm%
{d}[\nu_{\mathbf{x}}]_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})
\displaystyle\int\log\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)%
\mathrm{d}\nu_{\mathbf{x}}(f)
\displaystyle=\int\log\frac{\mathrm{d}[\nu_{\mathbf{u}}]_{\mathbf{u}}}{\mathrm%
{d}[\nu_{0}]_{\mathbf{u}}}(\mathbf{f}_{\mathbf{u}})\mathrm{d}[\nu_{\mathbf{x}}%
]_{\mathbf{u}}(\mathbf{f}_{\mathbf{u}})
\displaystyle=\int\log\frac{p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})}%
{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})}\mathrm{d}[\nu_{\mathbf{x}}]_{\mathbf{u}%
}(\mathbf{f}_{\mathbf{u}})
\displaystyle=\int\log\frac{p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})}%
{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})}\mathrm{d}[\nu_{\mathbf{x}}]_{\mathbf{u}%
}(\mathbf{f}_{\mathbf{u}})
\displaystyle=\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(\tilde{%
\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]-\log p(\tilde{\mathbf{y}}\,|\,%
\mathbf{u}).
\displaystyle=\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(\tilde{%
\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]-\log p(\tilde{\mathbf{y}}\,|\,%
\mathbf{u}).
\mathbf{u}
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\nabla_{\mathbf{u}}\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{u}).
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\nabla_{\mathbf{u}}\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{u}).
\displaystyle\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{u})=%
\nabla_{\mathbf{u}}\log\int p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u})\mathrm{d}%
\nu_{0}(f)
\displaystyle\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{u})
\displaystyle=\nabla_{\mathbf{u}}\log\int p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\mathrm{d}\nu_{0}(f)
\displaystyle=\int\frac{\nabla_{\mathbf{u}}p(\tilde{\mathbf{y}}\,|\,f,\mathbf{%
u})}{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})}\mathrm{d}\nu_{0}(f)
\displaystyle=\int\frac{\nabla_{\mathbf{u}}p(\tilde{\mathbf{y}}\,|\,f,\mathbf{%
u})}{p(\tilde{\mathbf{y}}\,|\,\mathbf{u})}\mathrm{d}\nu_{0}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\frac{p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u})}{p(\tilde{\mathbf{y}}\,|\,%
\mathbf{u})}\mathrm{d}\nu_{0}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\frac{p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u})}{p(\tilde{\mathbf{y}}\,|\,%
\mathbf{u})}\mathrm{d}\nu_{0}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)\mathrm{d}\nu_{0}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\frac{\mathrm{d}\nu_{\mathbf{u}}}{\mathrm{d}\nu_{0}}(f)\mathrm{d}\nu_{0}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\mathrm{d}\nu_{\mathbf{u}}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,f,\mathbf{u%
})\mathrm{d}\nu_{\mathbf{u}}(f)
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_%
{\mathbf{u}})\mathrm{d}[\nu_{\mathbf{u}}]_{\mathbf{u}}(f)=\mathbb{E}_{[\nu_{%
\mathbf{u}}]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,%
\mathbf{f}_{\mathbf{u}})].
\displaystyle=\int\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_%
{\mathbf{u}})\mathrm{d}[\nu_{\mathbf{u}}]_{\mathbf{u}}(f)=\mathbb{E}_{[\nu_{%
\mathbf{u}}]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,%
\mathbf{f}_{\mathbf{u}})].
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\mathbb{E}_{[\nu_{\mathbf{u}}%
]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{%
\mathbf{u}})].
\displaystyle\nabla_{\mathbf{u}}D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf%
{u}}]=-\nabla_{\mathbf{u}}\mathbb{E}_{[\nu_{\mathbf{x}}]_{\mathbf{u}}}[\log p(%
\tilde{\mathbf{y}}\,|\,\mathbf{f}_{\mathbf{u}})]+\mathbb{E}_{[\nu_{\mathbf{u}}%
]_{\mathbf{u}}}[\nabla_{\mathbf{u}}\log p(\tilde{\mathbf{y}}\,|\,\mathbf{f}_{%
\mathbf{u}})].
O(n^{3})
O(n^{2})
n
O(m^{3})
O(m^{2})
m
m\ll n
Z=\{z_{1},\ldots,z_{m}\}
q(\mathbf{f}_{\text{tr}},\mathbf{f}_{z})
p(\mathbf{f}_{\text{tr}},\mathbf{f}_{z}|\mathbf{y}_{\text{tr}})
p(\mathbf{f}_{\text{tr}}|\mathbf{f}_{z})
q(\mathbf{f}_{z})
Z
q(\mathbf{f}_{z})
p(y_{\text{te}}|x_{\text{te}},D_{\text{tr}})
D_{\mathrm{KL}}[\nu_{\mathbf{x}}\|\nu_{\mathbf{u}}]
\mathbf{x}
\theta_{\mathbf{x}}
T
\theta_{\mathbf{u}}
\gamma
\lambda_{\mathbf{x}}
\lambda_{\mathbf{u}}
\mathbf{x}
\mathbf{u}
N
\alpha
B
T
\gamma
\lambda_{\mathbf{x}}
\lambda_{\mathbf{u}}
N
\alpha
B
\displaystyle\begin{cases}\Delta\theta=v\\
\Delta v=-\eta\nabla\tilde{U}(x)-\alpha v+{\mathcal{N}}(0,2d).\end{cases}
\displaystyle\begin{cases}\Delta\theta=v\\
\Delta v=-\eta\nabla\tilde{U}(x)-\alpha v+{\mathcal{N}}(0,2d).\end{cases}
\eta=0.03
\alpha=0.1
d=0.01/m
m
\uparrow
\scriptstyle{\pm 0.90}
\scriptstyle{\pm 0.96}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.88}
\scriptstyle{\pm 0.43}
\downarrow
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.74}
\scriptstyle{\pm 0.60}
\uparrow
\scriptstyle{\pm 0.34}
\scriptstyle{\pm 1.73}
\scriptstyle{\pm 1.22}
\scriptstyle{\pm 1.18}
\scriptstyle{\pm 0.78}
\downarrow
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.04}
\uparrow
\scriptstyle{\pm 0.36}
\scriptstyle{\pm 1.55}
\scriptstyle{\pm 3.37}
\scriptstyle{\pm 1.63}
\scriptstyle{\pm 1.30}
\downarrow
\scriptstyle{\pm 0.00}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.07}
\uparrow
\downarrow
6.2\times 10^{4}
3.2\times 10^{5}
1.1\times 10^{7}
1.04\scriptstyle{\pm 0.10}
1.37\scriptstyle{\pm 0.13}
2.59\scriptstyle{\pm 0.86}
1.5\scriptstyle{\pm 0.15}
3.29\scriptstyle{\pm 0.51}
8.38\scriptstyle{\pm 0.48}
37.26\scriptstyle{\pm 1.65}
50.48\scriptstyle{\pm 1.39}
60.75\scriptstyle{\pm 0.26}
33.69\scriptstyle{\pm 2.73}
55.07\scriptstyle{\pm 1.30}
66.03\scriptstyle{\pm 0.21}
35.45\scriptstyle{\pm 0.31}
62.33\scriptstyle{\pm 0.34}
71.23\scriptstyle{\pm 0.17}
