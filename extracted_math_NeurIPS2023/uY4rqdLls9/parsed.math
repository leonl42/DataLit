p(x,z)=p(z)\prod_{n=1}^{N}p(x_{n}\mid z)
x_{1},\ldots,x_{N}
q_{w}(z)
p(z\mid x)
z\in\mathbb{R}^{d}
w
q_{w}(z)
p(z\mid x)
f(w)=-\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{E}}_{q_{w}(\textsf{z})}\bigg{[}N\log p(x_{\mathsf{n}}\mid\textsf{z})+%
\log p(\textsf{z})\bigg{]}-\mathbb{H}(w),
\mathbb{H}(w)
q_{w}
s(\epsilon)
{\mathcal{T}_{w}(\epsilon)}
\upepsilon\sim s
{\mathcal{T}_{w}(\epsilon)}\sim q_{w}
f(w)=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}f(w;\mathsf{n},\epsilon),
f(w;n,\epsilon)=-N\log p(x_{n}\mid\mathcal{T}_{w}(\epsilon))-\log p(\mathcal{T%
}_{w}(\epsilon))\\
-\mathbb{H}(w).
n
\epsilon
g_{\mathtt{naive}}(w;n,\epsilon)=\nabla f(w;n,\epsilon).
\log p
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n},\upepsilon}[\nabla f(w;\mathsf%
{n},\upepsilon)]
\operatornamewithlimits{\mathbb{V}}[\textsf{z}]=\mathrm{tr}\ \mathbb{C}[%
\textsf{z}]
n
\epsilon
f(w;n)=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}f(w;n,\upepsilon)
n
f(w;\epsilon)=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}f(w;\mathsf{n},\epsilon)
\epsilon
\nabla f(w;\mathsf{n},\upepsilon)
\nabla f(w;\upepsilon)
\nabla f(w;\mathsf{n})
f(w;\upepsilon)
\nabla f(w;n)
\nabla f(w;\epsilon)
n
\epsilon
g_{\mathtt{joint}}
n
\epsilon
g_{\mathtt{joint}}
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n},\upepsilon}[\nabla f(w;\mathsf%
{n},\upepsilon)]
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n})]
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\upepsilon)]
4.04\times 10^{4}
2.02\times 10^{4}
1.16\times 10^{4}
9.16\times 10^{4}
8.61\times 10^{4}
2.07\times 10^{3}
4.21\times 10^{8}
3.21\times 10^{8}
1.75\times 10^{4}
1.69\times 10^{10}
1.68\times 10^{10}
3.73\times 10^{7}
9.96\times 10^{7}
9.59\times 10^{7}
8.56\times 10^{4}
1.78\times 10^{9}
1.69\times 10^{9}
1.75\times 10^{6}
5\times 10^{-4}
1\times 10^{-2}
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n})]
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\upepsilon)]
5\times 10^{-4}
1\times 10^{-2}
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n})]
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\upepsilon)]
f(w)=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}f(w;\upepsilon)
\epsilon
c(w;\upepsilon)
g(w;\epsilon)=\nabla f(w;\epsilon)+c(w;\epsilon).
c(w;\epsilon)\approx\nabla f(w)-\nabla f(w;\epsilon)
\tilde{f}\approx f
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\tilde{f}(w,\upepsilon)
c(w;\epsilon)=\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;%
\upxi)-\nabla\tilde{f}(w;\epsilon)
g(w;\epsilon)=\nabla f(w;\epsilon)+\operatornamewithlimits{\mathbb{E}}_{\upxi}%
\nabla\tilde{f}(w;\upxi)-\nabla\tilde{f}(w;\epsilon).
\tilde{f}
f
\tilde{f}
f(w;n,\epsilon)
n
\epsilon
\tilde{f}(w;n,\epsilon)
f(w;n,\epsilon)
n
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;n,\upxi)-\nabla%
\tilde{f}(w;n,\epsilon)
g_{\mathtt{cv}}(w;n,\epsilon)=\nabla f(w;n,\epsilon)\\
+\underbrace{\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;n,%
\upxi)-\nabla\tilde{f}(w;n,\epsilon)}_{\text{zero mean control variate }c_{%
\mathtt{cv}}(w;n,\epsilon)}.
\tilde{f}(w;n,\epsilon)
n
\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{cv}}]=\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[%
\nabla f(w;n,\epsilon)-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)]\\
+\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n})].
\tilde{f}
f
f(w)=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}f(w;\mathsf{n})
\mathsf{n}
\{1,\ldots,N\}
n
N
\mathsf{n}
\nabla f(w;\mathsf{n})
w^{n}
f(w;n)
w\leftarrow w-\lambda\left(\nabla f(w;n)+\operatornamewithlimits{\mathbb{E}}_{%
\mathsf{m}}\nabla f(w^{\mathsf{m}};\mathsf{m})-\nabla f(w^{n};n)\right),
\lambda
m
N
\nabla f(w;n)
g(w;n)=\nabla f(w;n)+\underbrace{\operatornamewithlimits{\mathbb{E}}_{\mathsf{%
m}}\nabla f(w^{\mathsf{m}};\mathsf{m})-\nabla f(w^{n};n)}_{\text{zero mean %
control variate}}.
w^{m}\approx w
f(w;n,\epsilon)
\epsilon
g_{\mathtt{inc}}(w;n,\epsilon)=\nabla f_{n}(w;n,\epsilon)\\
+\underbrace{\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{%
\mathsf{m}};\mathsf{m},\epsilon)-\nabla f(w^{n};n,\epsilon)}_{\text{zero mean %
control variate}~{}c_{\mathtt{inc}}(w;n,\epsilon)}.
\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{inc}}]=\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[%
\nabla f(w;\mathsf{n},\upepsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},%
\upepsilon)]\\
+\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\upepsilon)].
w^{n}
\epsilon
g_{\mathtt{inc}}
\nabla f(w^{\mathsf{n}};n,\epsilon)
\epsilon
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)
g_{\mathtt{inc}}
\beta\in(0,1)
g_{\mathtt{ens}}(w;n,\epsilon)=\nabla f(w;n,\epsilon)\\
+\underbrace{\beta c_{\mathtt{cv}}(w;n,\epsilon)+(1-\beta)c_{\mathtt{inc}}(w;n%
,\epsilon)}_{\text{zero mean control variate}~{}c_{\mathtt{ens}}(w;n,\epsilon)}.
c_{\mathtt{cv}}
c_{\mathtt{inc}}
\tilde{f}(w;n,\epsilon)=f(w;n,\epsilon)
w^{n}=w
n
\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{ens}}]=\beta^{2}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla{f}(w;\mathsf{n})]+(1-%
\beta)^{2}\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;%
\upepsilon)].
g_{\mathtt{ens}}
c_{\mathtt{inc}}
g_{\mathtt{inc}}
\mathtt{naive}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathsf{n}
\epsilon
\tilde{f}(w;n,\epsilon)
f(w;n,\epsilon)
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\nabla\tilde{f}(w;n,\upepsilon)
n
f
s(\epsilon)
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla\tilde{f}(w;n,%
\upepsilon)]
W=\{w^{1},\ldots,w^{N}\}
w^{n}\in\mathbb{R}^{D}
x_{1},\cdots,x_{N}
G
\tilde{f}
\epsilon
G=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}\nabla\tilde{f}(w^{\mathsf{n}};\mathsf{n},\upepsilon)
W
\mathtt{naive}
w
w^{n}
W
w
\tilde{f}
\nabla f(w;n,\epsilon)
\nabla\tilde{f}(w^{n};n,\epsilon)
G
\nabla\tilde{f}(w^{n};n,\epsilon)
g_{\mathtt{joint}}(w;n,\epsilon)=\nabla f(w;n,\epsilon)\\
+\underbrace{\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w^{\mathsf{m}};%
\mathsf{m},\upxi)-\nabla\tilde{f}(w^{n};n,\epsilon)}_{\text{zero mean control %
variate }}.
G=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}\nabla\tilde{f}(w^{\mathsf{n}};\mathsf{n},\upepsilon)
w^{n}
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\nabla\tilde{f}(w;n,\upepsilon)
\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{joint}}]=%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}[\nabla f(w;\mathsf%
{n},\upepsilon)-\nabla\tilde{f}(w^{\mathsf{n}};\mathsf{n},\upepsilon)].
g_{\mathtt{joint}}
\tilde{f}
f
w^{n}
w
\Theta(ND)
W
\Theta(D)
\lambda
f(w;n,\epsilon)
\tilde{f}(w;n,\epsilon)
\epsilon
\displaystyle w
\displaystyle W=\{w^{1},\ldots,w^{N}\}
\mathtt{naive}
\parbox{13.00806pt}{$G$}\leftarrow\operatornamewithlimits{\mathbb{E}}_{\mathsf%
{m}}\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{m},\upxi)
\triangleright
\mathsf{m}
\upxi
\displaystyle n
\displaystyle\epsilon
\displaystyle\parbox{13.00806pt}{$g$}\leftarrow\nabla f(w;n,\epsilon)
\smash{\displaystyle\parbox{13.00806pt}{$c$}\leftarrow\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{m}}\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla%
\tilde{f}(w^{\mathsf{m}};\mathsf{m},\upxi)-\nabla\tilde{f}(w^{\mathsf{n}};n,%
\epsilon)}
\triangleright
\smash{\displaystyle\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w^{\mathsf{m}};%
\mathsf{m},\upxi)=G}
\displaystyle\parbox{13.00806pt}{$G$}\leftarrow G+\tfrac{1}{N}%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\bigl{(}\nabla\tilde{f}(w;n,\upxi)-%
\nabla\tilde{f}(w^{\mathsf{n}};n,\upxi)\bigr{)}
\triangleright
\upxi
\parbox{13.00806pt}{$w^{n}$}\leftarrow w
\displaystyle\parbox{13.00806pt}{$w$}\leftarrow w-\lambda(g+c)
\triangleright
g+c
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{joint}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{inc}
\mathtt{joint}
\mathtt{joint}
\epsilon
\epsilon
c_{\mathtt{cv}}
n
\epsilon
\mathtt{joint}
208
170K
14
85K
\log p
\mathtt{joint}
\mathtt{naive}
\mathtt{joint}
\bm{x}_{1},\ldots,\bm{x}_{N}\in\mathbb{R}^{D}
\bm{W}\in\mathbb{R}^{D\times K}
\displaystyle\mathsf{\bm{W}}_{ij}\sim\mathcal{N}(0,1),1\leq i\leq D,1\leq j%
\leq K,
\displaystyle\mathsf{\bm{W}}_{ij}\sim\mathcal{N}(0,1),1\leq i\leq D,1\leq j%
\leq K,
\displaystyle\bm{\mathsf{x}}_{n}\sim\mathcal{N}(\bm{0},\mathsf{\bm{W}}\mathsf{%
\bm{W}}^{\top}+\mathrm{diag}(\mathbf{\lambda}^{2})).
\displaystyle\bm{\mathsf{x}}_{n}\sim\mathcal{N}(\bm{0},\mathsf{\bm{W}}\mathsf{%
\bm{W}}^{\top}+\mathrm{diag}(\mathbf{\lambda}^{2})).
\mathsf{\bm{W}}
K=16
\mathbf{\lambda}=\mathbf{1}
N
M
(x_{n,1},x_{n,2},y_{n})
x_{n,1}
x_{n,2}
y_{n}\in\{0,1\}
y_{n}=1
x_{n,1}
\theta_{m}\in\mathbb{R},m=1,\ldots,M
\displaystyle\uptheta_{m}\sim\mathcal{N}(0,1),
\displaystyle\uptheta_{m}\sim\mathcal{N}(0,1),
\displaystyle\mathsf{y}_{n}\sim\mathrm{Bernoulli}(\mathrm{logit}^{-1}(\mathsf{%
\uptheta}_{x_{n,1}}-\mathsf{\uptheta}_{x_{n,2}})).
\displaystyle\mathsf{y}_{n}\sim\mathrm{Bernoulli}(\mathrm{logit}^{-1}(\mathsf{%
\uptheta}_{x_{n,1}}-\mathsf{\uptheta}_{x_{n,2}})).
169405
5525
N
M
m
\bm{x}_{n}\in\{0,1\}^{18}
y_{n}\in\{1,\ldots,5\}
\mathsf{\bm{Z}}_{m}\in\mathbb{R}^{18\times 5},m=1,\ldots,M
\displaystyle\mathsf{\bm{\upmu}}_{ij}\sim\mathcal{N}(0,1),\mathsf{\bm{\upsigma%
}}_{ij}\sim\mathcal{N}(0,1),1\leq i\leq 18,1\leq j\leq 5
\displaystyle\mathsf{\bm{\upmu}}_{ij}\sim\mathcal{N}(0,1),\mathsf{\bm{\upsigma%
}}_{ij}\sim\mathcal{N}(0,1),1\leq i\leq 18,1\leq j\leq 5
\displaystyle\mathsf{\bm{Z}}_{m}\sim\mathcal{N}(\mathsf{\bm{\upmu}},\exp%
\mathsf{\bm{\upsigma}}),
\displaystyle\mathsf{\bm{Z}}_{m}\sim\mathcal{N}(\mathsf{\bm{\upmu}},\exp%
\mathsf{\bm{\upsigma}}),
\displaystyle\mathsf{y}_{n}\sim\mathrm{Categorical}\left(\mathrm{softmax}(\bm{%
x}_{n}^{\top}\mathsf{\bm{Z}}_{m})\right).
\displaystyle\mathsf{y}_{n}\sim\mathrm{Categorical}\left(\mathrm{softmax}(\bm{%
x}_{n}^{\top}\mathsf{\bm{Z}}_{m})\right).
100,000
943
q_{w}(z)=\mathcal{N}(\bm{\mu},\mathrm{diag}(\bm{\sigma}^{2}))
w=(\bm{\mu},\log\bm{\sigma})
\bm{\mu}
\log\bm{\sigma}
\bm{0}
\mathtt{joint}
\mathtt{cv}
\tilde{f}(w;n,\epsilon)
\bm{\mu}
\bm{\mu}
\mathtt{joint}
g_{\mathtt{joint}}
\mathtt{naive}
g_{\mathtt{naive}}
\mathtt{cv}
g_{\mathtt{cv}}
\mathtt{inc}
g_{\mathtt{inc}}
\mathtt{inc}
10^{-3}
10^{-1}
10^{-5}
10^{-2}
\mathsf{B}
\mathtt{inc}
\mathtt{joint}
|\mathsf{B}|=5
|\mathsf{B}|=100
5000
\mathtt{inc}
\mathtt{cv}
\mathtt{naive}
\mathtt{joint}
\mathtt{inc}
\mathtt{joint}
\mathtt{inc}
\mathtt{joint}
q_{w}(z)
\mathtt{joint}
\mathtt{inc}
\mathtt{joint}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{cv}
\mathtt{naive}
\mathtt{joint}
\nabla f
\mathtt{naive}
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n},\upepsilon}[\nabla f(w;\mathsf%
{n},\upepsilon)]
\mathtt{cv}
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n})]
\mathtt{inc}
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\upepsilon)]
\mathtt{joint}
0
\mathtt{naive}
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\upepsilon)]
\mathtt{cv}
0
\mathtt{inc}
\mathtt{naive}
\mathtt{inc}
w^{n}
\mathtt{joint}
4
\mathtt{inc}
\mathtt{naive}
\mathtt{inc}
w^{n}
\mathtt{joint}
4
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{inc}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
f(w;n,\epsilon)
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
G
\Theta(N)
\mathtt{inc}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n},\upepsilon}f(w;\mathsf{n},\upepsilon)
W=\{w^{1},\ldots,w^{N}\}
\bar{w}_{k}=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}w^{\mathsf{n}}_{k}
k
k_{th}
\bar{w}_{k}
n
\epsilon
n_{th}
W
w_{n}^{k+1}=(1-\alpha)w_{n}^{k}+\alpha(\bar{w}_{k}-\gamma\nabla f(\bar{w}_{k};%
\epsilon,n)).
\bar{w}_{k}
\bar{w}_{k+1}=\bar{w}_{k}+\frac{1}{N}w_{n}^{k+1}-\frac{1}{N}w_{n}^{k}.
\displaystyle\bar{w}_{k+1}=\bar{w}_{k}+\frac{1}{N}w_{n}^{k+1}-\frac{1}{N}w_{n}%
^{k}
\displaystyle\bar{w}_{k+1}
\displaystyle=\bar{w}_{k}+\frac{1}{N}w_{n}^{k+1}-\frac{1}{N}w_{n}^{k}
\displaystyle=\bar{w}_{k}+\frac{1}{N}\left[(1-\alpha)w_{n}^{k}+\alpha(\bar{w}_%
{k}-\gamma\nabla f(\bar{w}_{k};\epsilon,n))-w_{n}^{k}\right]
\displaystyle=\bar{w}_{k}+\frac{1}{N}\left[(1-\alpha)w_{n}^{k}+\alpha(\bar{w}_%
{k}-\gamma\nabla f(\bar{w}_{k};\epsilon,n))-w_{n}^{k}\right]
\displaystyle=\bar{w}_{k}-\frac{\alpha}{N}\left[\gamma\nabla f(\bar{w}_{k};%
\epsilon,n)+w_{n}^{k}-\bar{w}_{k}\right]
\displaystyle=\bar{w}_{k}-\frac{\alpha}{N}\left[\gamma\nabla f(\bar{w}_{k};%
\epsilon,n)+w_{n}^{k}-\bar{w}_{k}\right]
\displaystyle=\bar{w}_{k}-\frac{\alpha}{N}\left[\gamma\nabla f(\bar{w}_{k};%
\epsilon,n)-(\bar{w}_{k}-w_{n}^{k})\right]
\displaystyle=\bar{w}_{k}-\frac{\alpha}{N}\left[\gamma\nabla f(\bar{w}_{k};%
\epsilon,n)-(\bar{w}_{k}-w_{n}^{k})\right]
\alpha\gamma/N
B=\{n_{b}\}
\displaystyle\bar{w}_{k+1}=\bar{w}_{k}+\sum_{n_{b}\in B}\left[\frac{1}{N}w_{n_%
{b}}^{k+1}-\frac{1}{N}w_{n_{b}}^{k}\right]
\displaystyle\bar{w}_{k+1}
\displaystyle=\bar{w}_{k}+\sum_{n_{b}\in B}\left[\frac{1}{N}w_{n_{b}}^{k+1}-%
\frac{1}{N}w_{n_{b}}^{k}\right]
\displaystyle=\bar{w}_{k}-\frac{\alpha|B|}{N}\left[\gamma%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}_{b}}\nabla f(\bar{w}_{k};%
\epsilon,\mathsf{n}_{b})-\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}_{b}}(%
\bar{w}_{k}-w_{\mathsf{n}_{b}}^{k})\right]
\displaystyle=\bar{w}_{k}-\frac{\alpha|B|}{N}\left[\gamma%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}_{b}}\nabla f(\bar{w}_{k};%
\epsilon,\mathsf{n}_{b})-\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}_{b}}(%
\bar{w}_{k}-w_{\mathsf{n}_{b}}^{k})\right]
\frac{\alpha|B|\gamma}{N}
\{\gamma_{0},\gamma_{1},\ldots\}
\{\frac{\alpha|B|}{N}\gamma_{0},\frac{\alpha|B|}{N}\gamma_{1},\ldots\}.
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}(\bar{w}_{k}-w_{\mathsf{n}}^{k%
})=0
\mathtt{joint}
\mathtt{joint}
\lambda
f(w;n,\epsilon)
\tilde{f}(w;n,\epsilon)
\epsilon
K
\displaystyle\tilde{w}
\tilde{f}
\tilde{w}
\displaystyle\parbox{13.00806pt}{$\bar{g}$}\leftarrow\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{m}}\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla%
\tilde{f}(\tilde{w};\mathsf{m},\upxi)
w_{0}\leftarrow\tilde{w}
k=1,2,\cdots,K
\displaystyle n
\displaystyle\epsilon
\displaystyle\parbox{13.00806pt}{$g$}\leftarrow\nabla f(w;n,\epsilon)
\smash{\displaystyle\parbox{13.00806pt}{$c$}\leftarrow\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{m}}\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla%
\tilde{f}(\tilde{w};\mathsf{m},\upxi)-\nabla\tilde{f}(\tilde{w};n,\epsilon)}
\triangleright
\smash{\displaystyle\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(\tilde{w};\mathsf{m%
},\upxi)=\bar{g}}
\displaystyle\parbox{13.00806pt}{$w_{k}$}\leftarrow w_{k-1}-\lambda(g+c)
\triangleright
g+c
\tilde{w}\leftarrow w_{K}
\mathtt{joint}
\mathtt{joint}
O(ND)
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
O(ND)
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
g_{\mathtt{cv}},g_{\mathtt{inc}}
g_{\mathtt{ens}}
g_{\mathtt{cv}}
\mathtt{cv}
g_{\mathtt{cv}}(w;n,\epsilon)=\nabla f(w;n,\epsilon)+\underbrace{%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;n,\upxi)-\nabla%
\tilde{f}(w;n,\epsilon)}_{c_{\mathtt{cv}}(w;n,\epsilon)},
\tilde{f}
f
\epsilon
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{cv}}]=%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{V}}_{\upepsilon}g_{\mathtt{cv}}+\operatornamewithlimits{\mathbb{V}}_{%
\mathsf{n}}\operatornamewithlimits{\mathbb{E}}_{\upepsilon}g_{\mathtt{cv}}.
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{cv}}]
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}g_{\mathtt{cv}}+%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}g_{\mathtt{cv}}.
\displaystyle\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}g_{\mathtt{cv}}=%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{V}}_{\upepsilon}[\nabla f(w;\mathsf{n},\upepsilon)+%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)%
-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)]
\displaystyle\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}g_{\mathtt{cv}}
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)+\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;%
\mathsf{n},\upxi)-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)],
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)],
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)
\epsilon
\displaystyle\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}g_{\mathtt{cv}}=%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},\upepsilon)+%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)%
-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)]
\displaystyle\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}g_{\mathtt{cv}}
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)+\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;%
\mathsf{n},\upxi)-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}\left[%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)]+\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)%
]-\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla\tilde{f}(w;\mathsf{n%
},\upepsilon)]\right]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}\left[%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)]+\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)%
]-\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla\tilde{f}(w;\mathsf{n%
},\upepsilon)]\right]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)+\nabla\tilde{f}(w;\mathsf{n})-\nabla\tilde{f}(w;\mathsf{n})]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)+\nabla\tilde{f}(w;\mathsf{n})-\nabla\tilde{f}(w;\mathsf{n})]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}[\nabla f(w;\mathsf{n},%
\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;%
\mathsf{n})].
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;%
\mathsf{n})].
\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{cv}}]=\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{n}}\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[%
\nabla f(w;n,\epsilon)-\nabla\tilde{f}(w;\mathsf{n},\upepsilon)]+%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n})]
g_{\mathtt{inc}}
\mathtt{inc}
g_{\mathtt{inc}}(w;n,\epsilon)=\nabla f_{n}(w;n,\epsilon)+\underbrace{%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)-\nabla f(w^{n};n,\epsilon)}_{c_{\mathtt{inc}}(w;n,%
\epsilon)}.
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{inc}}]=%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\operatornamewithlimits{%
\mathbb{V}}_{\mathsf{n}}g_{\mathtt{inc}}+\operatornamewithlimits{\mathbb{V}}_{%
\upepsilon}\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}g_{\mathtt{inc}}.
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{inc}}]
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}g_{\mathtt{inc}}+%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{n}}g_{\mathtt{inc}}.
\displaystyle\operatornamewithlimits{\mathbb{E}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}g_{\mathtt{inc}}=%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\operatornamewithlimits{%
\mathbb{V}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},\upepsilon)+%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)]
\displaystyle\operatornamewithlimits{\mathbb{E}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}g_{\mathtt{inc}}
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},%
\upepsilon)+\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{%
\mathsf{m}};\mathsf{m},\epsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n},%
\upepsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)],
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla f(w;\mathsf{n},%
\upepsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)],
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)
n
\displaystyle\operatornamewithlimits{\mathbb{V}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}g_{\mathtt{inc}}=%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon}\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},\upepsilon)+%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)]
\displaystyle\operatornamewithlimits{\mathbb{V}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}g_{\mathtt{inc}}
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},%
\upepsilon)+\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{%
\mathsf{m}};\mathsf{m},\epsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}\left[%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\nabla f_{n}(w;\mathsf{n},%
\upepsilon)+\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)-\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\nabla f(%
w^{\mathsf{n}};\mathsf{n},\upepsilon)\right]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}\left[%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\nabla f_{n}(w;\mathsf{n},%
\upepsilon)+\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{\mathsf{m}};%
\mathsf{m},\epsilon)-\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}\nabla f(%
w^{\mathsf{n}};\mathsf{n},\upepsilon)\right]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}\left[%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},%
\upepsilon)]+\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{%
\mathsf{m}};\mathsf{m},\epsilon)-\operatornamewithlimits{\mathbb{E}}_{\mathsf{%
n}}\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)\right]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}\left[%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},%
\upepsilon)]+\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}\nabla f(w^{%
\mathsf{m}};\mathsf{m},\epsilon)-\operatornamewithlimits{\mathbb{E}}_{\mathsf{%
n}}\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)\right]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},%
\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}[\nabla f_{n}(w;\mathsf{n},%
\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;%
\upepsilon)],
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;%
\upepsilon)],
\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{inc}}]=\operatornamewithlimits{%
\mathbb{E}}_{\upepsilon}\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[%
\nabla f(w;\mathsf{n},\upepsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},%
\upepsilon)]+\operatornamewithlimits{\mathbb{V}}_{\upepsilon}[\nabla f(w;%
\upepsilon)].
g_{\mathtt{ens}}
g_{\mathtt{ens}}
g_{\mathtt{ens}}(w;n,\epsilon)=\nabla f(w;n,\epsilon)+\underbrace{\beta c_{%
\mathtt{cv}}(w;n,\epsilon)+(1-\beta)c_{\mathtt{inc}}(w;n,\epsilon)}_{c_{%
\mathtt{ens}}(w;n,\epsilon)},
f=\tilde{f}
w=w^{n},\forall n
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{ens}}]=%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}[\nabla f(w;\mathsf%
{n},\upepsilon)+\beta c_{\mathtt{cv}}(n,\upepsilon)+(1-\beta)c_{\mathtt{inc}}(%
\mathsf{n},\upepsilon)]
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{ens}}]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}[%
\nabla f(w;\mathsf{n},\upepsilon)+\beta c_{\mathtt{cv}}(n,\upepsilon)+(1-\beta%
)c_{\mathtt{inc}}(\mathsf{n},\upepsilon)]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\bigg%
{[}\nabla f(w;\mathsf{n},\upepsilon)+\beta\left(\operatornamewithlimits{%
\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)-\nabla\tilde{f}(w;%
\mathsf{n},\upepsilon)\right)+
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\bigg%
{[}\nabla f(w;\mathsf{n},\upepsilon)+\beta\left(\operatornamewithlimits{%
\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{n},\upxi)-\nabla\tilde{f}(w;%
\mathsf{n},\upepsilon)\right)+
\displaystyle\qquad\qquad\qquad\qquad(1-\beta)\left(\nabla%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}f(w^{\mathsf{m}};\mathsf{m},%
\upepsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)\right)\bigg{]}
\displaystyle\qquad\qquad\qquad\qquad(1-\beta)\left(\nabla%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}f(w^{\mathsf{m}};\mathsf{m},%
\upepsilon)-\nabla f(w^{\mathsf{n}};\mathsf{n},\upepsilon)\right)\bigg{]}
\tilde{f}
f
w^{n}
w
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{ens}}]=%
\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\bigg{[}\nabla f(w;%
\mathsf{n},\upepsilon)+\beta\left(\operatornamewithlimits{\mathbb{E}}_{\upxi}%
\nabla{f}(w;\mathsf{n},\upxi)-\nabla{f}(w;\mathsf{n},\upepsilon)\right)+
\displaystyle\operatornamewithlimits{\mathbb{V}}[g_{\mathtt{ens}}]
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\bigg%
{[}\nabla f(w;\mathsf{n},\upepsilon)+\beta\left(\operatornamewithlimits{%
\mathbb{E}}_{\upxi}\nabla{f}(w;\mathsf{n},\upxi)-\nabla{f}(w;\mathsf{n},%
\upepsilon)\right)+
\displaystyle\qquad\qquad\qquad\qquad(1-\beta)\left(\nabla%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}f(w;\mathsf{m},\upepsilon)-%
\nabla f(w;\mathsf{n},\upepsilon)\right)\bigg{]}
\displaystyle\qquad\qquad\qquad\qquad(1-\beta)\left(\nabla%
\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}f(w;\mathsf{m},\upepsilon)-%
\nabla f(w;\mathsf{n},\upepsilon)\right)\bigg{]}
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\bigg%
{[}\nabla f(w;\mathsf{n},\upepsilon)+\beta\left(\nabla{f}(w;\mathsf{n})-\nabla
f%
(w;\mathsf{n},\upepsilon)\right)+(1-\beta)\left(f(w;\upepsilon)-f(w;\mathsf{n}%
,\upepsilon)\right)\bigg{]}
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\bigg%
{[}\nabla f(w;\mathsf{n},\upepsilon)+\beta\left(\nabla{f}(w;\mathsf{n})-\nabla
f%
(w;\mathsf{n},\upepsilon)\right)+(1-\beta)\left(f(w;\upepsilon)-f(w;\mathsf{n}%
,\upepsilon)\right)\bigg{]}
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\Bigg%
{[}\beta\nabla f(w;\mathsf{n})+(1-\beta)\nabla f(w;\upepsilon)\Bigg{]}
\displaystyle=\operatornamewithlimits{\mathbb{V}}_{\upepsilon,\mathsf{n}}\Bigg%
{[}\beta\nabla f(w;\mathsf{n})+(1-\beta)\nabla f(w;\upepsilon)\Bigg{]}
\displaystyle=\beta^{2}\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla%
{f}(w;\mathsf{n})]+(1-\beta)^{2}\operatornamewithlimits{\mathbb{V}}_{%
\upepsilon}[\nabla f(w;\upepsilon)].
\displaystyle=\beta^{2}\operatornamewithlimits{\mathbb{V}}_{\mathsf{n}}[\nabla%
{f}(w;\mathsf{n})]+(1-\beta)^{2}\operatornamewithlimits{\mathbb{V}}_{%
\upepsilon}[\nabla f(w;\upepsilon)].
\nabla{f}(w;n)
\nabla{f}(w;\epsilon)
\{7.5\times 10^{-3},5\times 10^{-3},2.5\times 10^{-3},1\times 10^{-3},5\times 1%
0^{-4},1\times 10^{-4},5\times 10^{-5},2.5\times 10^{-5},1\times 10^{-5}\}
\{1\times 10^{-1},5\times 10^{-2},1\times 10^{-2},5\times 10^{-3},1\times 10^{%
-3}\}
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
\alpha=0.9
\gamma
\gamma
\{5\times 10^{-2},2.5\times 10^{-2},1\times 10^{-2},5\times 10^{-3},2.5\times 1%
0^{-3},1\times 10^{-3},5\times 10^{-4},1\times 10^{-4},5\times 10^{-5},1\times
1%
0^{-5}\}
\gamma
\{5\times 10^{-2},2.5\times 10^{-2},1\times 10^{-2},5\times 10^{-3},1\times 10%
^{-3},1\times 10^{-4},1\times 10^{-5}\}
\gamma
\{1\times 10^{-2},5\times 10^{-3},1\times 10^{-3},1\times 10^{-4},1\times 10^{%
-5},1\times 10^{-6},1\times 10^{-7}\}
\gamma
\{2.5\times 10^{-3},1\times 10^{-3},5\times 10^{-4},1\times 10^{-4}\}
\lambda
f(w;n,\epsilon)
\tilde{f}(w;n,\epsilon)
\epsilon
\displaystyle w
\displaystyle W=\{w^{1},\ldots,w^{N}\}
\mathtt{naive}
\parbox{13.00806pt}{$G$}\leftarrow\operatornamewithlimits{\mathbb{E}}_{\mathsf%
{m}}\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w;\mathsf{m},\upxi)
\triangleright
\mathsf{m}
\upxi
\displaystyle n
\displaystyle\epsilon
\displaystyle\parbox{13.00806pt}{$g$}\leftarrow\nabla f(w;n,\epsilon)
\smash{\displaystyle\parbox{13.00806pt}{$c$}\leftarrow\operatornamewithlimits{%
\mathbb{E}}_{\mathsf{m}}\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla%
\tilde{f}(w^{\mathsf{m}};\mathsf{m},\upxi)-\nabla\tilde{f}(w^{\mathsf{n}};n,%
\epsilon)}
\triangleright
\smash{\displaystyle\operatornamewithlimits{\mathbb{E}}_{\mathsf{m}}%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\nabla\tilde{f}(w^{\mathsf{m}};%
\mathsf{m},\upxi)=G}
\displaystyle\parbox{13.00806pt}{$G$}\leftarrow G+\tfrac{1}{N}%
\operatornamewithlimits{\mathbb{E}}_{\upxi}\bigl{(}\nabla\tilde{f}(w;n,\upxi)-%
\nabla\tilde{f}(w^{\mathsf{n}};n,\upxi)\bigr{)}
\triangleright
\upxi
\parbox{13.00806pt}{$w^{n}$}\leftarrow w
\displaystyle\parbox{13.00806pt}{$w$}\leftarrow w-\lambda(g+c)
\triangleright
g+c
\displaystyle f(w)=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}f(w;\mathsf{n},\upepsilon),
\displaystyle f(w)=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}f(w;\mathsf{n},\upepsilon),
\displaystyle f(w;n,\epsilon):=\mathcal{L}\left(y_{n},\phi(x_{n};w,\epsilon)\right)
\displaystyle f(w;n,\epsilon):=\mathcal{L}\left(y_{n},\phi(x_{n};w,\epsilon)\right)
\displaystyle\phi(x_{n};w,\epsilon)=w(\epsilon\odot x_{n}),
\displaystyle\phi(x_{n};w,\epsilon)=w(\epsilon\odot x_{n}),
x_{n}\in\mathbb{R}^{D},y_{n}\in\mathbb{R}^{K},w\in\mathbb{R}^{K\times D}
\epsilon\in\mathbb{R}^{D}
\mathcal{N}(\bm{1},\sigma\mathbb{I})
\odot
\mathcal{L}
\epsilon=1
\tilde{f}(w;n,\epsilon)=f(w;n,1)+(\epsilon-1)^{\top}\nabla_{\epsilon}f(w;n,1)+%
\frac{1}{2}(\epsilon-1)^{\top}\nabla^{2}_{\epsilon}f(w;n,1)(\epsilon-1),
\epsilon
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\tilde{f}(w;n,\upepsilon)=f(w;%
n,1)+\frac{\sigma^{2}}{2}\mathrm{tr}\left(\nabla^{2}_{\epsilon}f(w;n,1)\right).
0.05
\mathtt{joint}
\mathtt{inc}
0.05
\mathtt{joint}
\mathtt{inc}
g_{\mathtt{naive}}
g_{\mathtt{cv}}
g_{\mathtt{joint}}
\sigma=0.5
g_{\mathtt{joint}}
w=(\bm{\mu},\log\bm{\sigma})
\displaystyle f(w)=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}f(w;\mathsf{n},\epsilon),
\displaystyle f(w)
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\mathsf{n}}%
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}f(w;\mathsf{n},\epsilon),
\displaystyle\text{where}\ f(w;n,\epsilon)=-N\log p(x_{n}\mid\mathcal{T}_{w}(%
\epsilon))-\log p(\mathcal{T}_{w}(\epsilon))-\mathbb{H}(w),\quad\mathcal{T}_{w%
}(\epsilon)=\bm{\mu}+\epsilon\odot\bm{\sigma},
\displaystyle\text{where}\ f(w;n,\epsilon)
\displaystyle=-N\log p(x_{n}\mid\mathcal{T}_{w}(\epsilon))-\log p(\mathcal{T}_%
{w}(\epsilon))-\mathbb{H}(w),\quad\mathcal{T}_{w}(\epsilon)=\bm{\mu}+\epsilon%
\odot\bm{\sigma},
\epsilon
f(w;n,\epsilon)
k_{n}(z)=N\log p(x_{n}\mid z)+\log p(z)
z_{0}=\mathcal{T}_{w}(0)
z_{0}=\mathrm{stop\_gradient}\left(\mathcal{T}_{w}(0)\right)
z_{0}
w
\small\tilde{f}(w;n,\epsilon)=k_{n}(z_{0})+({\mathcal{T}_{w}(\epsilon)}-z_{0})%
^{\top}\nabla k_{n}(z_{0})+\frac{1}{2}({\mathcal{T}_{w}(\epsilon)}-z_{0})^{%
\top}\nabla^{2}k_{n}(z_{0})({\mathcal{T}_{w}(\epsilon)}-z_{0})+\mathbb{H}(w),
\displaystyle\nabla_{w}{\tilde{f}(w;n,\epsilon)}=\left[\frac{\partial\left({%
\mathcal{T}_{w}(\epsilon)}-z_{0}\right)}{\partial w}\right]^{\top}\left[\nabla
k%
_{n}(z_{0})+\nabla^{2}k_{n}(z_{0})(\bm{\mu}+\epsilon\odot\bm{\sigma}-\bm{\mu}+%
\bm{0}\odot\bm{\sigma})\right]+\nabla_{w}\mathbb{H}(w),
\displaystyle\nabla_{w}{\tilde{f}(w;n,\epsilon)}
\displaystyle=\left[\frac{\partial\left({\mathcal{T}_{w}(\epsilon)}-z_{0}%
\right)}{\partial w}\right]^{\top}\left[\nabla k_{n}(z_{0})+\nabla^{2}k_{n}(z_%
{0})(\bm{\mu}+\epsilon\odot\bm{\sigma}-\bm{\mu}+\bm{0}\odot\bm{\sigma})\right]%
+\nabla_{w}\mathbb{H}(w),
\displaystyle=\left[\frac{\partial\left({\mathcal{T}_{w}(\epsilon)}\right)}{%
\partial w}\right]^{\top}\left[\nabla k_{n}(z_{0})+\nabla^{2}k_{n}(z_{0})(%
\epsilon\odot\bm{\sigma})\right]+\nabla_{w}\mathbb{H}(w),
\displaystyle=\left[\frac{\partial\left({\mathcal{T}_{w}(\epsilon)}\right)}{%
\partial w}\right]^{\top}\left[\nabla k_{n}(z_{0})+\nabla^{2}k_{n}(z_{0})(%
\epsilon\odot\bm{\sigma})\right]+\nabla_{w}\mathbb{H}(w),
\frac{\partial\left({\mathcal{T}_{w}(\epsilon)}\right)}{\partial w}
\bm{\mu}
\bm{\sigma}
\bm{\mu}
\frac{\partial\left({\mathcal{T}_{w}(\epsilon)}-z_{0}\right)}{\partial\bm{\mu}%
}=\bm{I}
\epsilon
\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\nabla_{\bm{\mu}}{\tilde{f}(w;%
n,\upepsilon)}=\nabla k_{n}(z_{0})+\nabla_{\bm{\mu}}\mathbb{H}(w)
\bm{\sigma}
\displaystyle\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\nabla_{\bm{%
\sigma}}{\tilde{f}(w;n,\upepsilon)}=\operatornamewithlimits{\mathbb{E}}_{%
\upepsilon}{\left[\mathrm{diag}(\upepsilon)\left[\nabla k_{n}(z_{0})+\nabla^{2%
}k_{n}(z_{0})(\upepsilon\odot\bm{\sigma})\right]\right]}+\nabla_{\bm{\sigma}}%
\mathbb{H}(w),
\displaystyle\operatornamewithlimits{\mathbb{E}}_{\upepsilon}\nabla_{\bm{%
\sigma}}{\tilde{f}(w;n,\upepsilon)}
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}{\left[\mathrm{%
diag}(\upepsilon)\left[\nabla k_{n}(z_{0})+\nabla^{2}k_{n}(z_{0})(\upepsilon%
\odot\bm{\sigma})\right]\right]}+\nabla_{\bm{\sigma}}\mathbb{H}(w),
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}{\left[%
\upepsilon\odot\nabla k_{n}(z_{0})+\nabla^{2}k_{n}(z_{0})(\upepsilon^{2}\odot%
\bm{\sigma})\right]}+\nabla_{\bm{\sigma}}\mathbb{H}(w),
\displaystyle=\operatornamewithlimits{\mathbb{E}}_{\upepsilon}{\left[%
\upepsilon\odot\nabla k_{n}(z_{0})+\nabla^{2}k_{n}(z_{0})(\upepsilon^{2}\odot%
\bm{\sigma})\right]}+\nabla_{\bm{\sigma}}\mathbb{H}(w),
\displaystyle=\mathrm{diag}\left(\nabla^{2}k_{n}(z_{0})\right)\odot\bm{\sigma}%
+\nabla_{\bm{\sigma}}\mathbb{H}(w),
\displaystyle=\mathrm{diag}\left(\nabla^{2}k_{n}(z_{0})\right)\odot\bm{\sigma}%
+\nabla_{\bm{\sigma}}\mathbb{H}(w),
g_{\mathtt{cv}}(w;n,\epsilon)
g_{\mathtt{joint}}(w;n,\epsilon)
\bm{\mu}
\bm{\mu}
\bm{\mu}
\bm{\mu}_{\rm mcmc}
\bm{\sigma}^{2}_{\rm mcmc}
1\times 10^{-4}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
\mathtt{joint}
\epsilon
\mathtt{joint}
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
\mathtt{joint}
\epsilon
\mathtt{naive}
\mathtt{cv}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{joint}
\mathtt{naive}
\mathtt{joint}
\mathtt{joint}
-2.5\times 10^{4}
\mathtt{joint}
\mathtt{joint}
-2.5\times 10^{4}
\mathtt{joint}
