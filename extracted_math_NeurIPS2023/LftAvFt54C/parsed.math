\mathcal{M}=(\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R},\gamma,\mu_{0})
\mathcal{S}
\mathcal{A}
\mathcal{P}:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\rightarrow[0,1]
s
s^{\prime}
\mathcal{R}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
a
s
\gamma\in[0,1]
\mu_{0}
\tau=\{(s_{t},a_{t})\}_{t=0}^{T}
R(\tau)
R(\tau)=\sum_{t=0}^{T}\gamma^{k}r(s_{k},a_{k})
T
\pi:\mathcal{S}\rightarrow\mathcal{A}
\pi
\rho_{\pi}:\mathcal{S}\times\mathcal{A}\rightarrow[0,1]
\mathcal{D}_{e}
\pi_{e}
\pi_{\theta}
\rho_{\pi_{\theta}}
\rho_{\pi_{e}}
\displaystyle\min_{\theta}\max_{\psi}\;\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[%
\log D_{\psi}(s,a)]
\displaystyle\min_{\theta}\max_{\psi}\;
\displaystyle\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[\log D_{\psi}(s,a)]
\displaystyle+\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\log(1-D_{\psi}(s,a))].
\displaystyle+\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\log(1-D_{\psi}(s,a))].
\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\log(1-D_{\psi}(s,a))]
-\log(1-D_{\psi}(s,a))
\pi_{\theta}
\mathcal{D}_{e}
\mathcal{D}_{e}
\rho_{\pi_{\widehat{\theta}}}
\rho_{\pi_{\theta}}
\rho_{\pi_{e}}
\displaystyle\rho_{\pi_{e}}(s,a)=(1-\alpha)\rho_{\pi_{\epsilon}}(s,a)+\alpha%
\rho_{\pi_{\widehat{\theta}}}(s,a),
\displaystyle\rho_{\pi_{e}}(s,a)=(1-\alpha)\rho_{\pi_{\epsilon}}(s,a)+\alpha%
\rho_{\pi_{\widehat{\theta}}}(s,a),
\alpha\in[0,1]
\rho_{\pi_{\widehat{\theta}}}
\rho_{\pi_{\epsilon}}
\mathcal{D}_{e}
\pi_{\epsilon}
g:(s,a)\mapsto\mathbb{R}
\mathcal{D}_{e}
\phi:{\mathbb{R}\times\{\pm{1}\}}\mapsto\mathbb{R}
g
\displaystyle R_{\pi_{e}}(g)=\;(1-\alpha)\mathbb{E}_{(s,a)\sim\rho_{\pi_{%
\epsilon}}}[\phi(g(s,a))]
\displaystyle R_{\pi_{e}}(g)=\;
\displaystyle(1-\alpha)\mathbb{E}_{(s,a)\sim\rho_{\pi_{\epsilon}}}[\phi(g(s,a))]
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\widehat{\theta}}}}[-\phi(%
g(s,a))].
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\widehat{\theta}}}}[-\phi(%
g(s,a))].
\pi_{\epsilon}
\pi_{\widehat{\theta}}
\pi_{\theta}
(1-\alpha)\rho_{\pi_{\epsilon}}
(\rho_{\pi_{e}}-\alpha\rho_{\pi_{\widehat{\theta}}})
\pi_{\theta}
{\pi_{\widehat{\theta}}}
R_{\pi_{e}}
\pi_{\theta}
\pi_{e}
g
R_{\pi_{e}}(g)
\displaystyle\min_{g}R_{\pi_{e}}(g)=\mathcal{T}\{0,\mathbb{E}_{(s,a)\sim\rho_{%
\pi_{e}}}[\phi(g(s,a))]
\displaystyle\min_{g}R_{\pi_{e}}(g)=\mathcal{T}
\displaystyle\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[\phi(g(s,a))]
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\phi(g(s,a))]\}
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\phi(g(s,a))]\}
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[-\phi(g(s,a))],
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[-\phi(g(s,a))],
\mathcal{T}\{\cdot\}
\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[\phi(g(s,a))]-\alpha\mathbb{E}_{(s,a)\sim%
\rho_{\pi_{\theta}}}[\phi(g(s,a))]
\mathbb{E}_{(s,a)\sim\rho_{\pi_{\epsilon}}}[\phi(g(s,a))]
\pi_{\theta}
g
\mathcal{J}(\theta,g)
\displaystyle\max_{\theta}\min_{g}\mathcal{J}(g,\theta)=\mathcal{T}\{0,\mathbb%
{E}_{(s,a)\sim\rho_{\pi_{e}}}[\phi(g(s,a))]
\displaystyle\max_{\theta}\min_{g}\mathcal{J}(g,\theta)=\mathcal{T}
\displaystyle\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[\phi(g(s,a))]
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\phi(g(s,a))]\}
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[\phi(g(s,a))]\}
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[-\phi(g(s,a))].
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[-\phi(g(s,a))].
\phi
\phi(g)
\phi(g)
f
\phi:{\mathbb{R}\times\{\pm{1}\}}\mapsto\mathbb{R}
f
I_{f}
\displaystyle\min_{g}R_{\pi_{e}}(g,\phi)=-I_{f}(\mu,\nu)=-\int_{s,a}\mu(s,a)f(%
\frac{\mu(s,a)}{\nu(s,a)})dsda,
\displaystyle\min_{g}R_{\pi_{e}}(g,\phi)=-I_{f}(\mu,\nu)=-\int_{s,a}\mu(s,a)f(%
\frac{\mu(s,a)}{\nu(s,a)})dsda,
\mu=\rho_{\pi_{e}}-\alpha\rho_{\pi_{\theta}}
\nu=\alpha\rho_{\pi_{\theta}}
f:[0,\infty]\rightarrow\mathbb{R}\cup\{\infty\}
f
\min_{g}R_{\pi_{e}}(g)
\displaystyle\max_{T}\min\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[T(s,a)]
\displaystyle\max_{T}
\displaystyle\min\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[T(s,a)]
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[T(s,a)]\}-\alpha%
\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}f^{\ast}[T(s,a)].
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[T(s,a)]\}-\alpha%
\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}f^{\ast}[T(s,a)].
T(s,a)
g
f
f
f(u)=-(u+1)\log\frac{u+1}{2}+u\log u
f^{\ast}(t)=-1-\log(1-\exp(t))
T(s,a)
\log[D(s,a)]
\displaystyle\min_{\theta}\max_{\psi}\ \mathcal{J}(\theta,\psi)=\min\{0,%
\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}\log[D_{\psi}(s,a)]
\displaystyle\min_{\theta}\max_{\psi}\ \mathcal{J}(\theta,\psi)=
\displaystyle\min\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}\log[D_{\psi}(s,a)]
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}\log[D_{\psi}(s,a%
)]\}
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}\log[D_{\psi}(s,a%
)]\}
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}\log[1-D_{\psi}(s%
,a)].
\displaystyle+\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}\log[1-D_{\psi}(s%
,a)].
f
f
f
f
f(u)=\frac{1}{2}|u-1|
f^{\ast}(t)=t
r_{\psi}(s,a)=T(s,a)
\displaystyle\max_{\psi}\min\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{E}}}[r_{\psi}(%
s,a)]
\displaystyle\max_{\psi}
\displaystyle\min\{0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{E}}}[r_{\psi}(s,a)]
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)]\}%
-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)].
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)]\}%
-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)].
r_{\psi}
r_{\psi}
\displaystyle\min_{\theta}\max_{\psi}\min\big{\{}0,\mathbb{E}_{(s,a)\sim\rho_{%
\pi_{e}}}[r_{\psi}(s,a)]-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{%
\psi}(s,a)]\big{\}}
\displaystyle\min_{\theta}\max_{\psi}\min
\displaystyle\big{\{}0,\mathbb{E}_{(s,a)\sim\rho_{\pi_{e}}}[r_{\psi}(s,a)]-%
\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)]\big{\}}
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)]+%
\lambda\Psi(r_{\psi}),
\displaystyle-\alpha\mathbb{E}_{(s,a)\sim\rho_{\pi_{\theta}}}[r_{\psi}(s,a)]+%
\lambda\Psi(r_{\psi}),
r_{\psi}
\Psi(r_{\psi})=-\mathbb{E}_{(s,a)\sim\rho_{\hat{\pi}}}(||\nabla r_{\psi}(\hat{%
s},\hat{a})||_{2}-1)^{2}
\mathcal{D}_{e}=\{s_{i},a_{i}\}_{i=1}^{n}\sim\rho_{\pi_{e}}
N
\pi_{\theta}
D_{\psi}
D_{\psi}
\pi_{\theta}
\{s^{\theta},a^{\theta}\}\sim\rho_{\pi_{\theta}}
\{s^{e},a^{e}\}\sim\mathcal{D}_{e}
D_{\psi}
\mathcal{J}(\theta,\psi)
\pi_{\theta}
-\log[1-D_{\psi}(s,a)]
\rho_{\pi_{\widehat{\theta}}}
\rho_{\pi_{e}}
\rho_{\pi_{\theta}}
\pi_{\epsilon}
\pi_{\epsilon}
\pi_{\theta}
\pi_{\widehat{\theta}}
\pi_{\epsilon}
\pi_{\theta}
\pi_{\theta}
D_{\psi}^{\ast}(s,a)
\displaystyle D_{\psi}^{\ast}(s,a)=\frac{\rho_{\pi_{\epsilon}}(s,a)}{\rho_{\pi%
_{\epsilon}}(s,a)+\frac{1-\alpha}{\alpha}\rho_{\pi_{\theta}}(s,a)},
\displaystyle D_{\psi}^{\ast}(s,a)=\frac{\rho_{\pi_{\epsilon}}(s,a)}{\rho_{\pi%
_{\epsilon}}(s,a)+\frac{1-\alpha}{\alpha}\rho_{\pi_{\theta}}(s,a)},
D_{\psi}^{\ast}(s,a)
\pi_{\theta}
\displaystyle C+(1-\alpha)KL(\rho_{\pi_{\epsilon}}||\rho_{\pi_{e}})+\alpha KL(%
\rho_{\pi_{\theta}}||\rho_{\pi_{e}}),
\displaystyle C+(1-\alpha)KL(\rho_{\pi_{\epsilon}}||\rho_{\pi_{e}})+\alpha KL(%
\rho_{\pi_{\theta}}||\rho_{\pi_{e}}),
C=(1-\alpha)\log(1-\alpha)+\alpha\log\alpha
\rho_{\pi_{\theta}}=\rho_{\pi_{\epsilon}}=\rho_{\pi_{e}}
(1-\alpha)\log(1-\alpha)+\alpha\log\alpha
D_{\psi}^{\ast}(s,a)
\alpha
\rho_{\pi_{\theta}}=\rho_{\pi_{e}}
\pi_{e}
\pi_{\theta}
\pi_{\theta}
p_{p}(x)
p_{u}(x)
\mathcal{X}_{p}=\{x_{i}^{P}\}_{i=1}^{n_{p}}\sim p_{p}(x)
\mathcal{X}_{u}=\{x_{i}^{U}\}_{i=1}^{n_{u}}\sim p_{u}(x)
g(x)
\mathcal{X}_{p}
\mathcal{X}_{u}
\rho_{\pi_{\widehat{\theta}}}
p_{p}
\rho_{\pi_{e}}
p_{u}
\pi_{o}
\mathcal{D}_{o}
\pi_{n}
\mathcal{D}_{n}
\pi_{n}
\pi_{n}
\xi
a^{\ast}
\pi_{o}
\pi_{n}
\pi_{n}
a\sim\mathcal{N}(a^{\ast},\xi^{2})
\xi=[0.25,0.4,0.6]
\mathcal{D}_{e}
\mathcal{D}_{o}
\mathcal{D}_{n}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha
\alpha
\alpha
\alpha
\alpha=0.3,0.5,0.7,0.5-0.7
\alpha
\alpha
\alpha
\alpha=0.7
\alpha
f
D_{\psi}
\mathcal{D}_{o}
\mathcal{D}_{n}
\mathcal{D}_{e}
D_{\psi}
\mathcal{D}_{o}
\mathcal{D}_{n}
\mathcal{D}_{e}
\mathcal{D}_{e}
\mathcal{D}_{o}
\mathcal{D}_{n}
\mathcal{D}_{o}
\mathcal{D}_{n}
\mathcal{D}_{o}
\mathcal{D}_{n}
\mathcal{D}_{n}
\mathcal{D}_{o}
\mathcal{D}_{e}
\mathcal{D}_{o}
\mathcal{D}_{o}
\mathcal{D}_{o}
\mathcal{D}_{o}
\mathcal{D}_{u}
