\sim
\leftrightarrow
\leftrightarrow
\mathbf{V}=[\mathbf{v}_{1},\cdots,\mathbf{v}_{L}]^{T}
\mathbf{E}
A
\mathbf{V}=[\mathbf{v}_{1},\cdots,\mathbf{v}_{L}]^{T}
\mathbf{E}
A
X
Y=\{y_{1},y_{2},\cdots,y_{M}\}
\displaystyle P_{\theta}(Y|X)=\sum_{A\in\Gamma}P_{\theta}(Y,A|X)
\displaystyle P_{\theta}(Y|X)
\displaystyle=\sum_{A\in\Gamma}P_{\theta}(Y,A|X)
\displaystyle=\sum_{A\in\Gamma}P_{\theta}(A|X)P_{\theta}(Y|A,X),
\displaystyle=\sum_{A\in\Gamma}P_{\theta}(A|X)P_{\theta}(Y|A,X),
A=\{a_{1},a_{2},\cdots,a_{M}\}
\Gamma
Y
\mathbf{G}=\{\mathbf{g}_{1},\cdots,\mathbf{g}_{L}\}
L
L
\lambda
N
\lambda
\mathbf{V}=[\mathbf{v}_{1},\cdots,\mathbf{v}_{L}]^{T}
[\mathbf{v}_{1},\cdots,\mathbf{v}_{L}]=\text{Transformer-Blocks}(\mathbf{g}_{1%
},\cdots,\mathbf{g}_{L}).
A
\displaystyle P_{\theta}(A|X)=\prod_{i=1}^{M-1}P_{\theta}(a_{i+1}|a_{i},X)=%
\prod_{i=1}^{M-1}\mathbf{E}_{a_{i},a_{i+1}},
\mathbf{E}\in\mathbb{R}^{L\times L}
\displaystyle\mathbf{E}=\text{softmax}(\frac{\mathbf{Q}\mathbf{K}^{T}}{\sqrt{d%
}}),
\displaystyle\mathbf{Q}=\mathbf{V}\mathbf{W}_{\text{Q}},\quad\mathbf{K}=%
\mathbf{V}\mathbf{W}_{\text{K}},
d
\mathbf{W}_{\text{Q}}
\mathbf{W}_{\text{K}}
\mathbf{E}
\mathbf{E}
\mathbf{V}
A
\displaystyle P_{\theta}(Y|A,X)=\prod_{i=1}^{M}P_{\theta}(y_{i}|a_{i},X)=\prod%
_{i=1}^{M}\text{softmax}(\mathbf{W}_{\text{P}}\mathbf{v}_{a_{i}}),
\displaystyle P_{\theta}(Y|A,X)=\prod_{i=1}^{M}P_{\theta}(y_{i}|a_{i},X)=\prod%
_{i=1}^{M}\text{softmax}(\mathbf{W}_{\text{P}}\mathbf{v}_{a_{i}}),
\mathbf{W}_{\text{P}}
\mathbf{v}_{a_{i}}
i
A
\displaystyle\mathbf{P}=\text{softmax}(\mathbf{V}\mathbf{W}_{\text{P}}^{T}),
\displaystyle\mathbf{P}=\text{softmax}(\mathbf{V}\mathbf{W}_{\text{P}}^{T}),
\mathbf{P}\in\mathbb{R}^{L\times|\mathbb{V}|}
L
P_{\theta}(y_{i}|a_{i},X)=\mathbf{P}_{a_{i},y_{i}}
\mathbf{P}
\log P(Y|X)
A
\displaystyle{\mathcal{L}}=-\log P_{\theta}(Y|X)=-\log\sum_{A\in\Gamma}P_{%
\theta}(Y,A|X),
\displaystyle{\mathcal{L}}=-\log P_{\theta}(Y|X)=-\log\sum_{A\in\Gamma}P_{%
\theta}(Y,A|X),
\Gamma
1=a_{1}<\cdots<a_{M}=L
{\mathcal{L}}
\displaystyle\frac{\partial}{\partial\theta}{\mathcal{L}}=\sum_{A\in\Gamma}w_{%
A}\left(\frac{\partial}{\partial\theta}{\mathcal{L}}_{A}\right),
\displaystyle\frac{\partial}{\partial\theta}{\mathcal{L}}=\sum_{A\in\Gamma}w_{%
A}\left(\frac{\partial}{\partial\theta}{\mathcal{L}}_{A}\right),
\displaystyle{\mathcal{L}}_{A}=-\log P_{\theta}(Y,A|X),
\displaystyle{\mathcal{L}}_{A}
\displaystyle=-\log P_{\theta}(Y,A|X),
\displaystyle w_{A}=\frac{P_{\theta}(Y,A|X)}{\sum_{A^{\prime}\in\Gamma}P_{%
\theta}(Y,A^{\prime}|X)}.
\displaystyle w_{A}
\displaystyle=\frac{P_{\theta}(Y,A|X)}{\sum_{A^{\prime}\in\Gamma}P_{\theta}(Y,%
A^{\prime}|X)}.
{\mathcal{L}}_{A}
Y
A
w_{A}
{\mathcal{L}}_{A}
Y
A
A
Y
{\mathcal{L}}_{A}
A
A
w_{A}
w_{A}
v_{20}
w_{A}
A=\{a_{1},a_{2},\cdots,a_{5}\}
a_{2}=20
w_{A}
A
{\mathcal{L}}
A
u
Y_{\leq i}
f_{i,u}
u
v
v<u
f_{i,u}
f_{i-1,v}
f_{i,u}
{\mathcal{L}}=-\log f_{M,L}
\mathcal{O}(ML^{2})
\mathcal{O}(M)
\displaystyle{\mathcal{L}}_{\text{glancing}}=-\log P_{\theta}(Y|X,Z),
\displaystyle{\mathcal{L}}_{\text{glancing}}
\displaystyle=-\log P_{\theta}(Y|X,Z),
Z=[z_{1},\cdots,z_{L}]
P_{\theta}(Y|X,Z)
\hat{A}=\operatorname*{arg\,max}_{A\in\Gamma}P_{\theta}(Y,A|X)
Z
t=\tau\sum_{i=1}^{M}[y_{i}\neq\hat{y}_{i}]
\hat{y}_{i}=\operatorname*{arg\,max}P_{\theta}(\cdot|a_{i},X)
\tau\in[0,1]
Z
L
\mathbf{E}\in\mathbb{R}^{L\times L}
\mathbf{P}\in\mathbb{R}^{L\times|\mathbb{V}|}
\mathbf{E}:=\mathbf{E}\otimes[\mathbf{P}
]
\mathbf{E}
\mathbf{P}
\mathbf{E}
\otimes
\textit{tokens}:=\mathbf{P}
\textit{edges}:=\mathbf{E}
i:=1
\textit{output}:=
1
i:=
i
i
i=L
P_{\theta}(Y,A|X)
\displaystyle P_{\theta}(y_{1}|a_{1},X)\prod_{i=2}^{M}P_{\theta}(a_{i}|a_{i-1}%
,X)P_{\theta}(y_{i}|a_{i},X),
\displaystyle P_{\theta}(y_{1}|a_{1},X)\prod_{i=2}^{M}P_{\theta}(a_{i}|a_{i-1}%
,X)P_{\theta}(y_{i}|a_{i},X),
a_{i}
y_{i}
\displaystyle y^{*}_{i},a^{*}_{i}=\operatorname*{arg\,max}P_{\theta}(y_{i}|a_{%
i},X)P_{\theta}(a_{i}|a_{i-1},X),
\displaystyle y^{*}_{i},a^{*}_{i}=\operatorname*{arg\,max}P_{\theta}(y_{i}|a_{%
i},X)P_{\theta}(a_{i}|a_{i-1},X),
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\downarrow
\#
M
M
\approx
\pm.25
\pm.08
\pm.18
\pm.06
\pm.12
\pm.11
\pm.12
\pm.09
\pm.21
\pm.05
\pm.24
\pm.06
\pm.13
\pm.13
\pm.20
\pm.14
\pm.15
\pm.07
\pm.18
\pm.03
\pm.21
\pm.12
\pm.10
\pm.16
5
\pm.12
\pm.07
\pm.20
\pm.06
\pm.17
\pm.05
\pm.06
\pm.18
n
Y^{*}
\displaystyle\frac{1}{|Y|^{\alpha}}\left[\log P_{\theta}(Y|X)+\gamma\log P_{n%
\text{-gram}}(Y)\right],
\displaystyle\frac{1}{|Y|^{\alpha}}\left[\log P_{\theta}(Y|X)+\gamma\log P_{n%
\text{-gram}}(Y)\right],
\alpha,\gamma
Y
P_{\theta}(Y|X)
\lambda
200,100,50
\text{bs}=1
\lambda
200,100,50
\text{bs}=1
\lambda
\lambda
\lambda
\lambda
\leftrightarrow
\leftrightarrow
5\cdot 10^{-4}
\lambda=8
\tau
\gamma
\alpha
[1,1.4]
\sim
L
\lambda
\lambda
\lambda
\lambda
\lambda=2
\lambda
\lambda=8
{\mathcal{L}}
t=[0.4,0.6,0.8,1]
t=[0.4,0.6,0.8,1]
p=0.8
p
\lambda=4
(1,1)
(M,L)
M
L
P(Y,A|X)
f_{i,u}
(1,1)
(i,u)
f_{3,4}
A_{1}
A_{2}
{\mathcal{L}}
-\log f_{M,L}
(1,1)
(M,L)
M
L
P(Y,A|X)
f_{i,u}
(1,1)
(i,u)
f_{3,4}
A_{1}
A_{2}
{\mathcal{L}}
-\log f_{M,L}
M
L
Y
\mathbf{E}\in\mathbb{R}^{L\times L}
\mathbf{P}\in\mathbb{R}^{L\times|\mathbb{V}|}
f\in\mathbb{R}^{M\times L}
f[1,1]:=1
i=2,3,\cdots,M
f[i,:]:=\mathbf{P}[:,y_{i}]\otimes(f[i-1,:]\times\mathbf{E})
\otimes
\times
{\mathcal{L}}=-\log f[M,L]
A
\mathcal{O}(ML^{2})
M
L
M\times L
(1,1)
(M,L)
A=\{a_{1},\cdots,a_{M}\}
1=a_{1}<\cdots<a_{M}=L
(1,a_{1}),(2,a_{2}),\cdots,(M,a_{M})
A
P_{\theta}(Y,A|X)
\displaystyle P_{\theta}(Y,A|X)=\prod_{j=1}^{M}P_{\theta}(y_{j}|a_{j},X)\prod_%
{j=2}^{M}P_{\theta}(a_{j}|a_{j-1},X)
\displaystyle P_{\theta}(Y,A|X)
\displaystyle=\prod_{j=1}^{M}P_{\theta}(y_{j}|a_{j},X)\prod_{j=2}^{M}P_{\theta%
}(a_{j}|a_{j-1},X)
\displaystyle=\prod_{j=1}^{M}\mathbf{P}_{a_{j},y_{j}}\prod_{j=2}^{M}\mathbf{E}%
_{a_{j-1},a_{j}}.
\displaystyle=\prod_{j=1}^{M}\mathbf{P}_{a_{j},y_{j}}\prod_{j=2}^{M}\mathbf{E}%
_{a_{j-1},a_{j}}.
\mathbf{P}_{a_{j},y_{j}}
(j,a_{j})
\mathbf{E}_{a_{j-1},a_{j}}
(j-1,a_{j-1})
(j,a_{j})
f_{i,u}
(1,1)
(i,u)
(i,u)
(i-1,v)
v\in[1,u)
f_{i,u}
f_{i-1,v}
\displaystyle f_{i,u}=\mathbf{P}_{u,y_{i}}\sum_{v=1}^{u-1}f_{i-1,v}\ \mathbf{E%
}_{v,u}\quad(2\leq i\leq M,1\leq u\leq L),
\displaystyle f_{1,1}=\mathbf{P}_{1,y_{1}};\quad\quad\quad\quad f_{1,u}=0\quad%
(2\leq u\leq L).
{\mathcal{L}}=-\log f_{M,L}
\mathcal{O}(M)
\alpha=1
\gamma=0
\alpha=1
\gamma=0
[\langle\text{s}\rangle,\text{Yes}]
\{v_{1},v_{2}\}
\{v_{1},v_{3}\}
P(Y|X)
P(Y,A|X)
B
s_{i}(B)
i
P(Y|X)
\sum_{i=1}^{L}s_{i}(B)
10
200
5
\langle v,t\rangle
L
\mathbf{E}\in\mathbb{R}^{L\times L}
\mathbf{P}\in\mathbb{R}^{L\times|\mathbb{V}|}
i\in[1,L]
B
s_{i}(B):=0
B
i
\mathcal{G}_{1},\cdots,\mathcal{G}_{L}
L
i
B_{init}
\mathcal{G}_{1}
s_{1}(B_{init}):=1
i=1,2,\cdots,L-1
\mathcal{G}_{i}
\mathcal{G}_{i}
\mathcal{G}_{i}
B
\mathcal{G}_{i}
\langle v,t\rangle
B
v
t
B^{\prime}=B+\{t\}
\mathcal{G}_{v}
s_{v}(B^{\prime}):=s_{v}(B^{\prime})+s_{i}(B)\times\mathbf{P}_{v,t}\times%
\mathbf{E}_{i,v}
\mathcal{G}_{L}
\lambda=4
>0.5
\frac{1}{\lambda}=25\%
<0.5
>0.5
<0.2
<0.2
