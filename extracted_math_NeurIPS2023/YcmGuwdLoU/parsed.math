i
(\mathbf{p}_{i},\mathbf{u}_{i})
\mathbf{p}_{i}
(x,y,\theta)
\mathbf{u}_{i}
\mathbf{c}_{i}
\mathbf{l}_{i}
N_{\text{MP}}
N_{\text{TL}}
N_{\text{AG}}
t=0
\{T_{\text{h}}-1,\dots,0\}
\{1,\dots,T_{\text{f}}\}
(\mathbf{p}_{i}^{\text{MP}},\mathbf{l}_{i}^{\text{MP}},\mathbf{c}_{i}^{\text{%
MP}}),i\in\{1,\dots,N_{\text{MP}}\}
\mathbf{p}_{i}^{\text{MP}}\in\mathbb{R}^{3}
\mathbf{l}_{i}^{\text{MP}}\in\mathbb{R}^{N_{\text{node}}\times 4}
N_{\text{node}}
\mathbf{p}_{i}^{\text{MP}}
\mathbf{c}_{i}^{\text{MP}}\in\mathbb{R}^{C_{\text{MP}}}
C_{\text{MP}}
(\mathbf{p}_{i}^{\text{AG}},\mathbf{l}_{i}^{\text{AG}},\mathbf{c}_{i}^{\text{%
AG}}),i\in\{1,\dots,N_{\text{AG}}\}
\mathbf{p}_{i}^{\text{AG}}\in\mathbb{R}^{3}
\mathbf{l}_{i}^{\text{AG}}\in\mathbb{R}^{T_{\text{h}}\times(6+3)}
\mathbf{p}_{i}^{\text{AG}}
\mathbf{c}_{i}^{\text{AG}}\in\mathbb{R}^{6}
(\mathbf{l}_{i}^{\text{MP}},\mathbf{c}_{i}^{\text{MP}})
\mathbf{u}_{i}^{\text{MP}}\in\mathbb{R}^{D}
(\mathbf{l}_{i}^{\text{AG}},\mathbf{c}_{i}^{\text{AG}})
\mathbf{u}_{i}^{\text{AG}}\in\mathbb{R}^{D}
D
t=0
(\mathbf{p}_{i}^{\text{TL}},\mathbf{c}_{i}^{\text{TL}}),i\in\{1,\dots,N_{\text%
{TL}}\}
\mathbf{p}_{i}^{\text{TL}}\in\mathbb{R}^{3}
\mathbf{c}_{i}^{\text{TL}}\in\mathbb{R}^{C_{\text{TL}}}
C_{\text{TL}}
\mathbf{c}_{i}^{\text{TL}}
\mathbf{u}_{i}^{\text{TL}}\in\mathbb{R}^{D}
(\mathbf{p}_{i},\mathbf{u}_{i}),i\in\{1,\dots,N\}
N=N_{\text{MP}}+N_{\text{AG}}+N_{\text{TL}}
N
\kappa^{K}_{i}(d_{i1},\dots,d_{iN})\subseteq\{1,\dots,N\}
K
i
d_{ij}
i
j
\mathbf{r}_{ij}=(x_{ij},y_{ij},\theta_{ij})
j
i
\mathbf{p}_{j}
\mathbf{p}_{i}
\mathbf{r}_{ij}
\displaystyle\text{RPE}(\mathbf{r}_{ij})=\text{concat}(\text{PE}(x_{ij}),\text%
{PE}(y_{ij}),\text{AE}(\theta_{ij})),
\displaystyle\text{RPE}(\mathbf{r}_{ij})
\displaystyle=\text{concat}(\text{PE}(x_{ij}),\text{PE}(y_{ij}),\text{AE}(%
\theta_{ij})),
\displaystyle\text{PE}_{2i}(x)=\sin(x\cdot\omega^{\frac{2i}{D}}),\,\text{PE}_{%
2i+1}(x)=\cos(x\cdot\omega^{\frac{2i}{D}}),
\displaystyle\text{PE}_{2i}(x)
\displaystyle=\sin(x\cdot\omega^{\frac{2i}{D}}),\,\text{PE}_{2i+1}(x)=\cos(x%
\cdot\omega^{\frac{2i}{D}}),
\displaystyle\text{AE}_{2i}(\theta)=\sin\left(\theta\cdot(i+1)\right),\,\text{%
AE}_{2i+1}(\theta)=\cos\left(\theta\cdot(i+1)\right),\,i\in\{0,\dots,D/2-1\},
\displaystyle\text{AE}_{2i}(\theta)
\displaystyle=\sin\left(\theta\cdot(i+1)\right),\,\text{AE}_{2i+1}(\theta)=%
\cos\left(\theta\cdot(i+1)\right),\,i\in\{0,\dots,D/2-1\},
\omega
\mathbf{z}_{i}
i
K
\kappa_{i}^{K}
\displaystyle\mathbf{z}_{i}=\textsc{Knarpe}\left(\mathbf{u}_{i},\mathbf{u}_{j}%
,\mathbf{r}_{ij}\mid j\in\kappa_{i}^{K}\right)=\sum_{j\in\kappa_{i}^{K}}\alpha%
_{ij}\left(\mathbf{u}_{j}\mathbf{W}^{v}+\mathbf{b}^{v}{+\text{RPE}(\mathbf{r}_%
{ij})\mathbf{\hat{W}}^{v}+\mathbf{\hat{b}}^{v}}\right),
\displaystyle\mathbf{z}_{i}
\displaystyle=\textsc{Knarpe}\left(\mathbf{u}_{i},\mathbf{u}_{j},\mathbf{r}_{%
ij}\mid j\in\kappa_{i}^{K}\right)=\sum_{j\in\kappa_{i}^{K}}\alpha_{ij}\left(%
\mathbf{u}_{j}\mathbf{W}^{v}+\mathbf{b}^{v}{+\text{RPE}(\mathbf{r}_{ij})%
\mathbf{\hat{W}}^{v}+\mathbf{\hat{b}}^{v}}\right),
\displaystyle\alpha_{ij}=\frac{\exp(e_{ij})}{\sum_{k\in\kappa_{i}^{K}}\exp(e_{%
ik})},\quad e_{ij}=\frac{(\mathbf{u}_{i}\mathbf{W}^{q}+\mathbf{b}^{q})(\mathbf%
{u}_{j}\mathbf{W}^{k}+\mathbf{b}^{k}{+\text{RPE}(\mathbf{r}_{ij})\mathbf{\hat{%
W}}^{k}+\mathbf{\hat{b}}^{k}})}{\sqrt{D}},
\displaystyle\alpha_{ij}
\displaystyle=\frac{\exp(e_{ij})}{\sum_{k\in\kappa_{i}^{K}}\exp(e_{ik})},\quad
e%
_{ij}=\frac{(\mathbf{u}_{i}\mathbf{W}^{q}+\mathbf{b}^{q})(\mathbf{u}_{j}%
\mathbf{W}^{k}+\mathbf{b}^{k}{+\text{RPE}(\mathbf{r}_{ij})\mathbf{\hat{W}}^{k}%
+\mathbf{\hat{b}}^{k}})}{\sqrt{D}},
\alpha_{ij}
e_{ij}
W^{\{q,k,v\}},b^{\{q,k,v\}}
\hat{W}^{\{k,v\}},\hat{b}^{\{k,v\}}
N_{\text{AC}}
N_{\text{AG}}\cdot N_{\text{AC}}
\mathbf{\hat{z}}_{i}^{\text{AG}},i\in\{1,\dots,N_{\text{AG}}\cdot N_{\text{AC}}\}
K
K
\gamma_{\text{TL}}
\gamma_{\text{AG}}
\gamma_{\text{AC}}
\mathbf{\hat{z}}_{i}^{\text{AG}},i\in\{1,\dots,N_{\text{AG}}\cdot N_{\text{AC}}\}
(\mu_{x},\mu_{y},\sigma_{x},\sigma_{y},\rho)
N_{\text{MP}}=1024
N_{\text{TL}}=40
N_{\text{AG}}=64
N_{\text{node}}=20
K=36
\gamma_{\text{TL}}=2
\gamma_{\text{AG}}=4
\gamma_{\text{AC}}=10
N_{\text{AC}}=6
\uparrow
\uparrow
\downarrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\lambda_{\text{AC}}
\downarrow
\uparrow
\checkmark
\times
\checkmark
\times
1.145\pm 0.016
0.399\pm 0.010
\times
\times
\times
\checkmark
1.161\pm 0.006
0.397\pm 0.007
\checkmark
\checkmark
\times
\checkmark
1.156\pm 0.014
0.391\pm 0.002
\checkmark
\checkmark
\times
\times
1.169\pm 0.013
0.387\pm 0.012
\times
\times
\times
\checkmark
1.158\pm 0.093
0.386\pm 0.041
\times
\times
\times
\checkmark
1.212\pm 0.019
0.378\pm 0.014
\checkmark
\times
\checkmark
\times
1.687\pm 0.046
0.246\pm 0.005
\mathbf{\hat{z}}_{i}^{\text{AG}},i\in\{1,\dots,N_{\text{AG}}\cdot N_{\text{AC}}\}
p_{k},k\in\{1,\dots,6\}
(\mu_{x}^{t},\mu_{y}^{t},\log\sigma_{x}^{t},\log\sigma_{y}^{t},\rho^{t},v_{x}^%
{t},v_{y}^{t},\theta^{t},s^{t}),t\in\{1,\dots,T_{f}\}
x,y
x,y
x,y
(\hat{x},\hat{y},\hat{v}_{x},\hat{v}_{y},\hat{\theta},\hat{s})
L_{\text{pos}}=-\log\mathcal{N}(\hat{x},\hat{y}\mid\mu_{x},\mu_{y},\sigma_{x},%
\sigma_{y},\rho).
L_{\text{rot}}=-\cos(\hat{\theta}-\theta).
L_{\text{vel}}=\mathcal{L}_{\delta}(\hat{v}_{x}-v_{x})+\mathcal{L}_{\delta}(%
\hat{v}_{y}-v_{y})+\mathcal{L}_{\delta}(\hat{s}-s),
\mathcal{L}_{\delta}
\delta=1
L_{\text{traj}}=L_{\text{pos}}+L_{\text{rot}}+L_{\text{vel}},
\hat{k}
\hat{k}
L_{\text{conf}}=-\log\frac{\exp(p_{\hat{k}})}{\sum_{i=1}^{6}\exp(p_{i})}.
L=L_{\text{traj}}+L_{\text{conf}}.
D
\omega
B
M
src=q
N
tgt=k=v
K
D
B
M
src=q
N
tgt=k=v
K
D
q
k
v
q
k
v
\downarrow
\uparrow
k,v
\times
\times
\checkmark
1.143\pm 0.039
0.401\pm 0.007
q,k,v
\times
\times
\checkmark
1.140\pm 0.021
0.396\pm 0.009
q,k,v
\times
\checkmark
1.144\pm 0.036
0.397\pm 0.006
k,v
\checkmark
\times
1.138\pm 0.026
0.395\pm 0.006
q,k,v
\checkmark
\checkmark
1.133\pm 0.024
0.396\pm 0.006
\uparrow
\uparrow
\downarrow
\downarrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
\downarrow
