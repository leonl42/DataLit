\dagger
\dagger
\mathbf{J}\in\mathbb{R}^{18}
\mathbf{J}^{u}\in\mathbb{R}^{4}
\mathbf{b}=[\mathbf{b}_{p},\mathbf{b}_{q}]
\mathbf{b}_{p}\in\mathbb{R}^{3}
\mathbf{b}_{q}\in\mathbb{R}^{4}
\mathcal{A}\subseteq\mathbb{R}^{18}
\tau_{\mathbf{b}}=\{\mathbf{b}_{1},\mathbf{b}_{2},...,\mathbf{b}_{T}\}
T
t
\mathbf{b}_{t}
O\sim p_{O}(O)
\tau_{\mathbf{b}}\sim p_{\tau_{\mathbf{b}}}(\tau_{\mathbf{b}}|O)
O
\mathbf{b}_{T}
\mathbf{J}^{*}
[\mathbf{J}^{*},\mathbf{b}_{T}]
O
\tau_{\mathbf{b}}
O
\pi(\mathbf{a}|\cdot)
\mathbf{J}
o
H_{t}=[\mathbf{b}_{t-k},\mathbf{b}_{t-k+1},...,\mathbf{b}_{t}]
k
o
H_{t}=[\mathbf{b}_{t-4},...,\mathbf{b}_{t}]
\mathbf{J}^{u}\in\mathbb{R}^{4}
\pi(\mathbf{a}|\mathbf{J},o,H)
O\sim p_{O}(O)
\tau_{\mathbf{b}}\sim p_{\tau_{\mathbf{b}}}(\tau_{\mathbf{b}}|O)
\pi^{*}=\arg\max_{\pi}\mathbb{E}_{O\sim p_{O}(O),\tau_{\mathbf{b}}\sim p_{\tau%
_{\mathbf{b}}}(\tau_{\mathbf{b}}|O),\atop\mathbf{a}_{t}\sim\pi(\cdot|\mathbf{J%
}_{t},o_{t},H_{t})}\left[\mathbbm{1}(\text{success})\right]
O\sim p_{O}(O)
\tau_{\mathbf{b}}\sim p_{\tau_{\mathbf{b}}}(\tau_{\mathbf{b}}|O)
\pi_{p}^{\theta}(\mathbf{a}^{p}_{t}|\mathbf{J}_{t},o_{t},\mathbf{b}_{t})
\mathbf{a}^{p}_{t}
\pi_{r}^{\phi}(\mathbf{a}^{s}_{t},\mathbf{a}^{r}_{t}|\mathbf{J}_{t},o_{t},H_{t})
\mathbf{a}_{t}
\mathbf{a}^{r}_{t}
\pi^{\theta,\phi}(\mathbf{a}_{t}|\mathbf{J}_{t},o_{t},H_{t})
\displaystyle\mathbf{a}^{p}_{t}\sim\pi_{p}^{\theta}(\mathbf{a}^{p}_{t}|\mathbf%
{J}_{t},o_{t},\mathbf{b}_{t}),\ (\mathbf{a}^{s}_{t},\mathbf{a}^{r}_{t})\sim\pi%
_{r}^{\phi}(\mathbf{a}^{s}_{t},\mathbf{a}^{r}_{t}|\mathbf{J}_{t},o_{t},H_{t})
\displaystyle\mathbf{a}^{p}_{t}\sim\pi_{p}^{\theta}(\mathbf{a}^{p}_{t}|\mathbf%
{J}_{t},o_{t},\mathbf{b}_{t}),\ (\mathbf{a}^{s}_{t},\mathbf{a}^{r}_{t})\sim\pi%
_{r}^{\phi}(\mathbf{a}^{s}_{t},\mathbf{a}^{r}_{t}|\mathbf{J}_{t},o_{t},H_{t})
\displaystyle\pi^{\theta,\phi}(\cdot|\mathbf{J}_{t},o_{t},H_{t})=\mathbf{a}^{p%
}_{t}\odot\mathbf{a}^{s}_{t}+\mathbf{a}^{r}_{t}
\displaystyle\pi^{\theta,\phi}(\cdot|\mathbf{J}_{t},o_{t},H_{t})=\mathbf{a}^{p%
}_{t}\odot\mathbf{a}^{s}_{t}+\mathbf{a}^{r}_{t}
\pi_{p}^{\theta}
\pi_{r}^{\phi}
\pi_{p}^{\theta}
\pi_{p}^{\theta}
\pi_{r}^{\phi}
\pi_{p}^{\theta}
\pi_{r}^{\phi}
\pi_{p}^{\theta}
\pi_{r}^{\phi}
\pi_{p}^{\theta}
\pi_{r}^{\phi}
\pi_{p}^{\theta}
(\mathbf{J}_{t},o_{t},\mathbf{b}_{t})
p_{\textrm{success}}(\mathbf{J}|o_{t},\mathbf{b}_{t})
\mathbf{a}^{p}=\pi_{p}^{\theta}(\cdot|\mathbf{J},o,\mathbf{b})=\nabla_{\mathbf%
{J}}\log p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
o
\mathbf{b}
\nabla_{\mathbf{J}}\log p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
\nabla_{\mathbf{J}}\log p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
\pi_{p}^{\theta}
\nabla_{\mathbf{J}}\log p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
\nabla_{\mathbf{J}}\log p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
\mathcal{D}_{\textrm{success}}=\{(\mathbf{J}^{*}_{i},o^{*}_{i},\mathbf{b}^{*}_%
{i})\}_{i=1}^{N}
\mathbf{J}^{*}_{i}
(o^{*}_{i},\mathbf{b}^{*}_{i})
\{\mathbf{x}_{i}\sim p(\mathbf{x})\}_{i=1}^{N}
p(\mathbf{x})
\nabla_{\mathbf{x}}\log p(\mathbf{x})
\mathbf{s}_{\omega}(\mathbf{x}):\mathbb{R}^{|\mathcal{X}|}\rightarrow\mathbb{R%
}^{|\mathcal{X}|}
\nabla_{\mathbf{x}}\log p(\mathbf{x})
q_{\sigma}(\widetilde{\mathbf{x}}|\mathbf{x})
\mathcal{N}(0,\sigma^{2}I)
\mathcal{L}(\omega)=\mathbb{E}_{\widetilde{\mathbf{x}}\sim q_{\sigma},\mathbf{%
x}\sim p(\mathbf{x})}\left[||\mathbf{s}_{\omega}(\widetilde{\mathbf{x}})-%
\nabla_{\widetilde{\mathbf{x}}}\log q_{\sigma}(\widetilde{\mathbf{x}}|\mathbf{%
x})||^{2}_{2}\right]
\nabla_{\widetilde{\mathbf{x}}}\log q_{\sigma}(\widetilde{\mathbf{x}}|\mathbf{%
x})=\frac{1}{\sigma^{2}}(\mathbf{x}-\widetilde{\mathbf{x}})
\mathbf{s}_{\omega}^{*}(\mathbf{x})=\nabla_{\mathbf{x}}\log p(\mathbf{x})
\mathbf{x}
\nabla_{\mathbf{J}}\log p_{\textrm{success}}(\mathbf{J}|o,\mathbf{b})
\pi_{p}^{\theta}
\mathcal{L}(\theta)=\mathbb{E}_{\widetilde{\mathbf{J}}\sim q_{\sigma}(%
\widetilde{\mathbf{J}}|\mathbf{J}^{*}),\atop(\mathbf{J}^{*},o^{*},\mathbf{b}^{%
*})\sim\mathcal{D}_{\textrm{success}}}\left[\left\|\pi_{p}^{\theta}(\cdot|%
\widetilde{\mathbf{J}},o^{*},\mathbf{b}^{*})-\frac{\mathbf{J}^{*}-\widetilde{%
\mathbf{J}}}{\sigma^{2}}\right\|^{2}_{2}\right]
\frac{\mathbf{J}^{*}-\widetilde{\mathbf{J}}}{\sigma^{2}}
\widetilde{\mathbf{J}}
\mathbf{J}^{*}
\pi_{p}^{\theta}
\pi_{p}^{\theta}
\pi_{r}^{\phi}
\pi_{r}^{\phi}
\mathbf{a}^{s}
\mathbf{a}^{r}
\mathbf{a}^{s}
\mathbf{a}^{s}
\pi_{r}^{\phi}(\mathbf{a}^{r}_{t}|\mathbf{J}_{t},o_{t},H_{t})
H_{t}
o
\mathbf{J}_{t}
\mathbf{a}^{p}
\pi^{\theta,\phi}
\theta
J(\phi)=\mathbb{E}_{O\sim p_{O}(O),\tau_{\mathbf{b}}\sim p_{\tau_{\mathbf{b}}}%
(\tau_{\mathbf{b}}|O),\atop\mathbf{a}_{t}\sim{\color[rgb]{1,0,0}\pi^{\theta,%
\phi}}(\cdot|\mathbf{J}_{t},o_{t},H_{t})}\left[\sum\limits_{t=0}^{T}\gamma^{t}%
r_{t}\right]
\gamma>0
r_{t}
t
\mathbf{a}^{p}_{t}
\displaystyle\begin{split}r_{t}&=(1-d_{t})\cdot(r_{\text{sim}}+r_{\text{h}})+d%
_{t}\cdot\lambda_{s},\ d_{t}=\mathbbm{1}(\text{success, }t=T)\\
\ r_{\text{sim}}&=\lambda_{a}\cdot\left\langle\frac{\mathbf{a}^{p}}{||\mathbf{%
a}^{p}||_{2}},\mathbf{J}_{t}-\mathbf{J}_{t-1}\right\rangle,r_{\text{h}}=%
\lambda_{h}\cdot\Delta h\end{split}
\displaystyle\begin{split}r_{t}&=(1-d_{t})\cdot(r_{\text{sim}}+r_{\text{h}})+d%
_{t}\cdot\lambda_{s},\ d_{t}=\mathbbm{1}(\text{success, }t=T)\\
\ r_{\text{sim}}&=\lambda_{a}\cdot\left\langle\frac{\mathbf{a}^{p}}{||\mathbf{%
a}^{p}||_{2}},\mathbf{J}_{t}-\mathbf{J}_{t-1}\right\rangle,r_{\text{h}}=%
\lambda_{h}\cdot\Delta h\end{split}
\lambda_{a},\lambda_{h},\lambda_{s}>0
\Delta h
d_{t}
r_{\text{sim}}
\mathbf{a}^{p}_{t}
\mathbf{J}\in\mathbb{R}^{18}
o\in\mathbb{R}^{3\times 1024}
\mathbf{b}\in\text{SE}(3)
o_{\mathbf{b}}
o_{\mathbf{b}}
\mathbf{J}
t\in[0,1]
\mathbf{J}_{t}\in\mathbb{R}^{18}
\mathbf{J}^{u}_{t}\in\mathbb{R}^{4}
o_{t}\in\mathbb{R}^{3\times 1024}
H_{t}=[\mathbf{b}_{t},...,\mathbf{b}_{t-4}],\ \mathbf{b}_{i}\in\text{SE}(3)
f_{o_{\mathbf{b}}}\in\mathbb{R}^{512}
\mathbf{a}^{p}_{t}=\pi_{p}^{\theta}(\mathbf{J}_{t},o_{t},\mathbf{b}_{t})
\mathbf{J}
H
r_{\text{h}}
\downarrow
\downarrow
\downarrow
\downarrow
2.621_{\pm 0.415}
0.589_{\pm 0.038}
2.537_{\pm 0.296}
0.543_{\pm 0.040}
2.745_{\pm 0.168}
0.594_{\pm 0.045}
2.771_{\pm 0.254}
0.563_{\pm 0.039}
2.653_{\pm 0.030}
0.572_{\pm 0.002}
2.596_{\pm 0.119}
0.520_{\pm 0.011}
2.443_{\pm 0.042}
0.548_{\pm 0.027}
2.534_{\pm 0.101}
0.515_{\pm 0.022}
\textbf{2.131}_{\pm 0.138}
\textbf{0.449}_{\pm 0.020}
\textbf{2.127}_{\pm 0.165}
\textbf{0.428}_{\pm 0.029}
\mathbf{a}^{r}
\mathbf{a}^{s}
\mathbf{a}^{s}
\mathbf{a}^{p}
\mathbf{a}^{r}
56.50\%
\mathbf{a}^{p}
\mathbf{a}^{r}
\mathbf{a}^{p}
\mathbf{a}^{p}
\mathbf{a}^{p}
\mathbf{a}^{p}\odot\mathbf{a}^{s}
\mathbf{a}^{p}\odot\mathbf{a}^{s}+\mathbf{a}^{r}
\delta_{a}
A_{target}
\delta_{a}
\pi
A_{target}
p1
p2
c
c
p1
c
p2
\mathbf{J}
\mathbf{J}^{u}
\mathbf{b}
o
\mathbf{J}
\mathbf{s}_{\omega}(\mathbf{J}|o^{*},\mathbf{b}^{*},t)
\mathcal{L}(\omega)=\mathbb{E}_{t\sim\mathcal{U}(\epsilon,T)}\left\{\mathbb{E}%
_{\widetilde{\mathbf{J}}\sim q_{\sigma(t)}(\widetilde{\mathbf{J}}|\mathbf{J}),%
\atop(\mathbf{J}^{*},o^{*},\mathbf{b}^{*})\sim\mathcal{D}_{\textrm{success}}}%
\lambda(t)\left[\left\|\mathbf{s}_{\omega}(\widetilde{\mathbf{J}},|o^{*},%
\mathbf{b}^{*},t)-\frac{1}{\sigma^{2}(t)}(\mathbf{J}-\widetilde{\mathbf{J}})%
\right\|^{2}_{2}\right]\right\}
T=1
\epsilon=10^{-5}
\lambda(t)=\sigma^{2}(t)
\sigma(t)=1-e^{-\frac{1}{2}t^{2}(\beta_{max}-\beta_{min})-t\beta_{min}}
\beta_{max}=10,\beta_{min}=0.1
\mathbf{s}_{\omega}^{*}(\mathbf{J}|o^{*},\mathbf{b}^{*},t)=\nabla_{\mathbf{x}}%
\log q_{\sigma(t)}(\mathbf{J}|o^{*},\mathbf{b}^{*})
q_{\sigma(t)}(\mathbf{J}|o^{*},\mathbf{b}^{*})
q_{\sigma(t)}(\mathbf{J}|o^{*},\mathbf{b}^{*})=\int q_{\sigma(t)}(\widetilde{%
\mathbf{J}}|\mathbf{J})p_{\textrm{success}}(\mathbf{J}|o^{*},\mathbf{b}^{*})d%
\mathbf{J}
\mathbf{s}_{\omega}
\pi_{p}^{\theta}(\cdot|\mathbf{J},o^{*},\mathbf{b}^{*})=\mathbf{s}_{\omega}(%
\mathbf{J}|o^{*},\mathbf{b}^{*},0.005)
\displaystyle\ r_{\text{sim}}=\lambda_{a}\cdot\left\langle\frac{\mathbf{a}^{p}%
}{|\mathbf{a}^{p}|},\mathbf{J}_{t}-\mathbf{J}_{t-1}\right\rangle
\displaystyle\ r_{\text{sim}}=\lambda_{a}\cdot\left\langle\frac{\mathbf{a}^{p}%
}{|\mathbf{a}^{p}|},\mathbf{J}_{t}-\mathbf{J}_{t-1}\right\rangle
r_{\text{sim}}
\lambda_{s}=1.0
\lambda_{a}=0.09
\lambda_{h}=0.5
nsteps
noptepochs
mini\_batch\_size
gamma
r_{\text{h}}
\mathbf{a}^{s}
\mathbf{a}^{p}
\mathbf{a}^{p}\odot\mathbf{a}^{s}
\mathbf{a}^{p}
\mathbf{a}^{s}
\mathbf{a}^{p}
\mathbf{a}^{s}
\mathbf{a}^{p}
\mathbf{a}^{p}
\mathbf{a}^{p}\odot\mathbf{a}^{s}
\mathbf{a}^{p}
\mathbf{a}^{p}\odot\mathbf{a}^{s}
r_{\text{sim}}
r_{\text{sim}}
r_{\text{sim}}
r_{sim}
{a^{p}}\odot{a^{s}}+{a^{r}}
a^{p}
\frac{a^{p}}{{\parallel{a^{p}}\parallel}2}
J_{t}
J_{t-1}
J
r_{sim}
J_{t}
J_{t-1}
r_{\text{sim}}
r_{\text{sim}}
r_{\text{sim}}
r_{\text{sim}}
r_{sim}
r_{sim}
r_{sim}
r_{sim}
r_{sim}
