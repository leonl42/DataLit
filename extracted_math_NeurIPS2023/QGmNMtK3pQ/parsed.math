\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\mathcal{D}_{\text{init}}
\mathcal{D}_{\text{on}}
{\bm{\theta}_{\text{init}}^{0}},\mathcal{A}_{\text{init}},\mathcal{A}_{\text{%
on}}
\mathcal{L}_{\text{test}}
\mathcal{D}_{\text{init}}
\mathcal{D}_{\text{on}}
{\bm{\theta}_{\text{init}}^{0}},\mathcal{A}_{\text{init}},\mathcal{A}_{\text{%
on}}
\mathcal{L}_{\text{test}}
\mathcal{L}_{\text{test}}
\mathcal{D}_{\text{test}}
\mathbf{f}(\mathbf{x};\bm{\theta})\in\mathbb{R}^{2}
\bm{\theta}\in\mathbb{R}^{d}
\mathbf{x}
\mathbf{y}\in\{[1,0]^{\top},[0,1]^{\top}\}
[1,0]^{\top}
[0,1]^{\top}
\mathcal{L}(\mathcal{D};\bm{\theta})=-\mathbb{E}_{p_{\mathcal{D}}(\mathbf{x},%
\mathbf{y})}\Big{[}\mathbf{y}^{\top}\log\big{[}\text{Softmax}\big{(}\mathbf{f}%
(\mathbf{x};\bm{\theta})\big{)}\big{]}\Big{]},
\mathcal{D}=\{(\mathbf{x}_{i},\mathbf{y}_{i})\}_{i=1}^{N}
p_{\mathcal{D}}(\mathbf{x},\mathbf{y})
\mathcal{D}
\text{Softmax}(\cdot)
1^{\mathrm{st}}
\Gamma
\mathcal{V}\in\Gamma
\mathcal{V}
\mathcal{V}
\mathcal{V}
\mathcal{D}_{\text{init}}
\mathcal{D}_{\text{init}}
\mathcal{V}
\mathcal{V}
\mathcal{D}_{\text{on}}
\mathcal{D}_{\text{test}}
\mathcal{L}_{\text{test}}
\mathcal{L}_{\text{meta}}
\mathcal{D}_{\text{test}}
\mathcal{V}
\Gamma-\{\mathcal{V}\}
\tau
\tau
\mathcal{V}\in\Gamma
\Gamma
\mathcal{M}=\{{\bm{\theta}_{\text{init}}^{0}},\mathcal{A}_{\text{init}},%
\mathcal{A}_{\text{on}}\}
\mathcal{M}^{*}
\Gamma
\mathcal{V}
\mathcal{D}_{\text{init}}
\mathcal{V}
k
1,...,K_{\text{init}}
\bm{\theta}_{\text{init}}^{k}=\bm{\theta}_{\text{init}}^{k-1}-\bm{\alpha}_{%
\text{init}}^{k}\odot\nabla_{\bm{\theta}_{\text{init}}^{k-1}}\mathcal{L}(%
\mathcal{D}_{\text{init}};\bm{\theta}_{\text{init}}^{k-1})
\mathcal{D}_{\text{on}}
\mathcal{V}
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
k\in{1,...,K_{\text{on}}}
\bm{\theta}_{\text{on}}^{k}=\bm{\theta}_{\text{on}}^{k-1}-\bm{\alpha}_{\text{%
on}}^{k}\odot\nabla_{\bm{\theta}_{\text{on}}^{k-1}}\mathcal{L}(\mathcal{D}_{%
\text{on}};\bm{\theta}_{\text{on}}^{k-1})
\bm{\theta}_{\text{on}}^{0}=\bm{\theta}_{\text{init}}^{K_{\text{init}}}
\mathcal{D}_{\text{test}}
\mathcal{V}
\Gamma-\{\mathcal{V}\}
\tau=(\mathcal{D}_{\text{init}},\mathcal{D}_{\text{on}},\mathcal{D}_{\text{%
test}},\{\bm{\theta}_{\text{init}}^{k}\}_{k=1}^{K_{\text{init}}},\{\bm{\theta}%
_{\text{on}}^{k}\}_{k=1}^{K_{\text{on}}})
\mathcal{L}_{\text{meta}}
\tau
\mathcal{M}\leftarrow\text{optimize}(\mathcal{M},\nabla_{\mathcal{M}}\mathcal{%
L}_{\text{meta}})
\mathcal{M}
\mathcal{M}
{\bm{\theta}_{\text{init}}^{0}}\in\mathbb{R}^{d}
\alpha
\mathcal{A}_{\text{init}}=\{\bm{\alpha}_{\text{init}}^{k}\in\mathbb{R}^{d}\}^{%
K_{\text{init}}}_{k=1}
\mathcal{A}_{\text{on}}=\{\bm{\alpha}_{\text{on}}^{k}\in\mathbb{R}^{d}\}^{K_{%
\text{on}}}_{k=1}
K_{\text{init}}
K_{\text{on}}
\mathcal{M}=\{{\bm{\theta}_{\text{init}}^{0}},\mathcal{A}_{\text{init}},%
\mathcal{A}_{\text{on}}\}
\mathcal{D}_{\text{init}}
\mathcal{V}
\mathcal{D}_{\text{init}}
{\bm{\theta}_{\text{init}}^{0}}
K_{\text{init}}
\bm{\theta}_{\text{init}}^{k}=\bm{\theta}_{\text{init}}^{k-1}-\bm{\alpha}_{%
\text{init}}^{k}\odot\nabla_{\bm{\theta}_{\text{init}}^{k-1}}\mathcal{L}(%
\mathcal{D}_{\text{init}};\bm{\theta}_{\text{init}}^{k-1}),
k=1,\dots,K_{\text{init}}
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
\mathcal{D}_{\text{on}}
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
\mathcal{D}_{\text{on}}
\mathcal{D}_{\text{init}}
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
K_{\text{on}}
\bm{\theta}_{\text{on}}^{k}=\bm{\theta}_{\text{on}}^{k-1}-\bm{\alpha}_{\text{%
on}}^{k}\odot\nabla_{\bm{\theta}_{\text{on}}^{k-1}}\mathcal{L}(\mathcal{D}_{%
\text{on}};\bm{\theta}_{\text{on}}^{k-1}),
\bm{\theta}_{\text{on}}^{0}=\bm{\theta}_{\text{init}}^{K_{\text{init}}}
k=1,\dots,K_{\text{on}}
\bm{\theta}_{\text{on}}^{K_{\text{on}}}
\mathcal{D}_{\text{test}}=\mathcal{D}_{\text{test}}^{\text{std}}\cup\mathcal{D%
}_{\text{test}}^{\text{hard}}
\mathcal{D}_{\text{test}}^{\text{std}}
\mathcal{V}
\mathcal{D}_{\text{test}}^{\text{hard}}
\Gamma-\{\mathcal{V}\}
\mathcal{D}_{\text{test}}^{\text{std}}
\mathcal{V}
\mathcal{D}_{\text{test}}^{\text{std}}
\mathcal{D}_{\text{init}}
\mathcal{D}_{\text{test}}^{\text{std}}
\mathcal{D}_{\text{test}}^{\text{hard}}
\Gamma-\{\mathcal{V}\}
\mathcal{D}_{\text{test}}^{\text{hard}}
\bm{\theta}
\mathcal{D}_{\text{test}}
\mathcal{L}_{\text{test}}(\mathcal{D}_{\text{test}};\bm{\theta})=\mathcal{L}(%
\mathcal{D}_{\text{test}}^{\text{std}};\bm{\theta})+\gamma\mathcal{L}_{\text{%
tri}}(\mathcal{D}_{\text{test}};\bm{\theta})
\gamma
\displaystyle\mathcal{L}_{\text{tri}}(\mathcal{D}_{\text{test}};\bm{\theta})=
\displaystyle\mathcal{L}_{\text{tri}}(\mathcal{D}_{\text{test}};\bm{\theta})=
\displaystyle\hskip 11.38092pt\mathbb{E}_{p_{\mathcal{D}_{\text{test}}}(%
\mathbf{x},\mathbf{x}^{+},\mathbf{x}^{-})}\Big{[}\big{(}\xi+\Delta(\mathbf{x},%
\mathbf{x}^{+};\bm{\theta})-\Delta(\mathbf{x},\mathbf{x}^{-};\bm{\theta})\big{%
)}_{+}\Big{]},
\displaystyle\hskip 11.38092pt\mathbb{E}_{p_{\mathcal{D}_{\text{test}}}(%
\mathbf{x},\mathbf{x}^{+},\mathbf{x}^{-})}\Big{[}\big{(}\xi+\Delta(\mathbf{x},%
\mathbf{x}^{+};\bm{\theta})-\Delta(\mathbf{x},\mathbf{x}^{-};\bm{\theta})\big{%
)}_{+}\Big{]},
p_{\mathcal{D}_{\text{test}}}(\mathbf{x},\mathbf{x}^{+},\mathbf{x}^{-})
(\mathbf{x},\mathbf{x}^{+},\mathbf{x}^{-})
\mathcal{D}_{\text{test}}
(\cdot)_{+}=\vcentcolon\max(0,\cdot)
\xi
\Delta(\mathbf{x}_{1},\mathbf{x}_{2};\bm{\theta})
L_{2}
\displaystyle\Delta(\mathbf{x}_{1},\mathbf{x}_{2};\bm{\theta})\vcentcolon=%
\left|\left|\frac{\mathbf{f}(\mathbf{x}_{1};\bm{\theta})}{\|\mathbf{f}(\mathbf%
{x}_{1};\bm{\theta})\|^{2}}-\frac{\mathbf{f}(\mathbf{x}_{2};\bm{\theta})}{\|%
\mathbf{f}(\mathbf{x}_{2};\bm{\theta})\|^{2}}\right|\right|^{2}.
\displaystyle\Delta(\mathbf{x}_{1},\mathbf{x}_{2};\bm{\theta})\vcentcolon=%
\left|\left|\frac{\mathbf{f}(\mathbf{x}_{1};\bm{\theta})}{\|\mathbf{f}(\mathbf%
{x}_{1};\bm{\theta})\|^{2}}-\frac{\mathbf{f}(\mathbf{x}_{2};\bm{\theta})}{\|%
\mathbf{f}(\mathbf{x}_{2};\bm{\theta})\|^{2}}\right|\right|^{2}.
(\mathbf{x},\mathbf{x}^{+})\sim\mathcal{D}_{\text{test}}^{\text{std}}
\mathbf{x}^{-}\sim\mathcal{D}_{\text{test}}^{\text{hard}}
\tau=(\mathcal{D}_{\text{init}},\mathcal{D}_{\text{on}},\mathcal{D}_{\text{%
test}},\{\bm{\theta}_{\text{init}}^{k}\}_{k=1}^{K_{\text{init}}},\{\bm{\theta}%
_{\text{on}}^{k}\}_{k=1}^{K_{\text{on}}})
\displaystyle\mathcal{L}_{\text{meta}}(\mathcal{M})=
\displaystyle\mathcal{L}_{\text{meta}}
\displaystyle(\mathcal{M})=
\displaystyle\mathbb{E}_{p(\tau)}\big{[}\mathcal{L}_{\text{test}}(\mathcal{D}_%
{\text{test}};\bm{\theta}_{\text{init}}^{K_{\text{init}}})+\mathcal{L}_{\text{%
test}}(\mathcal{D}_{\text{test}};\bm{\theta}_{\text{on}}^{K_{\text{on}}})\big{%
]},
\displaystyle\mathbb{E}_{p(\tau)}\big{[}\mathcal{L}_{\text{test}}(\mathcal{D}_%
{\text{test}};\bm{\theta}_{\text{init}}^{K_{\text{init}}})+\mathcal{L}_{\text{%
test}}(\mathcal{D}_{\text{test}};\bm{\theta}_{\text{on}}^{K_{\text{on}}})\big{%
]},
p(\tau)
\mathcal{V}
\Gamma
\mathcal{M}
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
\bm{\theta}_{\text{on}}^{K_{\text{on}}}
\mathcal{M}
\mathcal{L}_{\text{meta}}
\mathcal{M}
\begin{split}&\nabla_{\mathcal{M}}\mathcal{L}_{\text{meta}}=\mathbb{E}_{p(\tau%
)}\bigg{[}\frac{\partial\mathcal{L}_{\text{test}}(\mathcal{D}_{\text{test}};%
\bm{\theta}_{\text{init}}^{K_{\text{init}}})}{\partial\bm{\theta}_{\text{init}%
}^{K_{\text{init}}}}\frac{\partial\bm{\theta}_{\text{init}}^{K_{\text{init}}}}%
{\partial\mathcal{M}}\\
&\hskip 14.22636pt+\frac{\partial\mathcal{L}_{\text{test}}(\mathcal{D}_{\text{%
test}};\bm{\theta}_{\text{on}}^{K_{\text{on}}})}{\partial\bm{\theta}_{\text{on%
}}^{K_{\text{on}}}}\bigg{\{}\frac{\partial\bm{\theta}_{\text{on}}^{K_{\text{on%
}}}}{\partial\mathcal{M}}+\frac{\partial\bm{\theta}_{\text{on}}^{K_{\text{on}}%
}}{\partial\bm{\theta}_{\text{init}}^{K_{\text{init}}}}\frac{\partial\bm{%
\theta}_{\text{init}}^{K_{\text{init}}}}{\partial\mathcal{M}}\bigg{\}}\bigg{]}%
\end{split}
\mathcal{M}
1\times 1
\mathcal{B}=\{\bm{\beta}^{l}\}_{l=1}^{L}
L
\mathcal{B}
\mathcal{B}
\bm{\beta}^{l}
l^{\text{th}}
\bm{\beta}^{l}
\begin{split}\textstyle\mathcal{L}_{\text{lasso}}&(\mathcal{D},\mathcal{B};\bm%
{\theta})=\textstyle\lambda\sum_{l=1}^{L}\big{\|}\bm{\beta}^{l}\big{\|}_{1}\\
+&\textstyle\mathbb{E}_{p_{\mathcal{D}}(\mathbf{x})}\Big{[}\sum_{l\in\mathcal{%
S}}\big{\|}F^{l}(\mathbf{x};\bm{\theta})-F^{l}_{\mathcal{B}}(\mathbf{x};\bm{%
\theta})\big{\|}_{2}\Big{]},\end{split}
\lambda
\mathcal{S}
F^{l}(\mathbf{x};\bm{\theta})
l^{\text{th}}
F^{l}_{\mathcal{B}}(\mathbf{x};\bm{\theta})
\mathcal{B}
F^{0}(\mathbf{x};\bm{\theta})=F^{0}_{\mathcal{B}}(\mathbf{x};\bm{\theta})=%
\mathbf{x}
F^{l+1}(\mathbf{x};\bm{\theta})=\sigma\big{(}\text{Conv}(F^{l}(\mathbf{x};\bm{%
\theta});\bm{\theta}^{l})\big{)}
l^{\text{th}}
\bm{\theta}^{l}
\sigma(\cdot)
F^{l+1}_{\mathcal{B}}(\mathbf{x};\bm{\theta})=\bm{\beta}^{l+1}\odot\sigma\big{%
(}\text{Conv}(F^{l}_{\mathcal{B}}(\mathbf{x};\bm{\theta});\bm{\theta}^{l})\big%
{)}.
\mathcal{D}
\tau
\begin{split}&\textstyle\mathcal{L}_{\text{ep}}(\tau,\mathcal{B})=\mathcal{L}_%
{\text{lasso}}(\mathcal{D}_{\text{init}},\mathcal{B};\bm{\theta}_{\text{init}}%
^{K_{\text{init}}})\\
&\textstyle\hskip 5.69046pt+\sum_{k=1}^{K_{\text{on}}}\mathcal{L}_{\text{lasso%
}}(\mathcal{D}_{\text{on}},\mathcal{B};\bm{\theta}_{\text{on}}^{k})+\mathcal{L%
}_{\text{lasso}}(\mathcal{D}_{\text{test}},\mathcal{B};\bm{\theta}_{\text{on}}%
^{K_{\text{on}}}).\end{split}
\mathcal{B}
\mathcal{L}_{\text{lasso}}
\mathcal{D}_{\text{on}}
\mathcal{D}_{\text{test}}^{\text{hard}}
{\bm{\theta}_{\text{init}}^{0}}
\mathcal{A}_{\text{init}}
\mathcal{A}_{\text{on}}
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\mathcal{B}
\mathcal{B}
\mathcal{D}_{\text{init}}
\bm{\theta}
\Psi(\mathcal{D}_{\text{init}};\bm{\theta},\bm{\phi})=\{\psi^{l}(\mathcal{D}_{%
\text{init}};\bm{\theta},\bm{\phi})\}_{l=1}^{L}
\psi^{l}(\mathcal{D}_{\text{init}};\bm{\theta},\bm{\phi})
\bm{\beta}^{l}
l^{\text{th}}
\bm{\phi}\in\mathbb{R}^{c}
\psi^{l}(\mathcal{D}_{\text{init}};\bm{\theta},\bm{\phi})=\frac{1}{N}\sum_{i=1%
}^{N}\text{MLP}\big{(}\text{AvgPool}\big{(}F^{l}(\mathbf{x}_{i};\bm{\theta})%
\big{)};\bm{\phi}^{l}\big{)}
\text{MLP}(\cdot;\bm{\phi}^{l})
\bm{\phi}^{l}
l^{\text{th}}
\text{AvgPool}(\cdot)
N
\mathcal{D}_{\text{init}}
\bm{\theta}
\bm{\phi}
\Psi(\mathcal{D}_{\text{init}};\bm{\theta},\bm{\phi})
\displaystyle\mathcal{L}_{\text{prune}}(\bm{\phi})=\mathbb{E}_{p(\tau)}\Big{[}%
\mathcal{L}_{\text{ep}}\big{(}\tau,\Psi(\mathcal{D}_{\text{init}};\bm{\theta}_%
{\text{init}}^{K_{\text{init}}},\bm{\phi})\big{)}\Big{]},
\displaystyle\mathcal{L}_{\text{prune}}(\bm{\phi})=\mathbb{E}_{p(\tau)}\Big{[}%
\mathcal{L}_{\text{ep}}\big{(}\tau,\Psi(\mathcal{D}_{\text{init}};\bm{\theta}_%
{\text{init}}^{K_{\text{init}}},\bm{\phi})\big{)}\Big{]},
\mathcal{B}
\Psi(\mathcal{D}_{\text{init}};\bm{\theta}_{\text{init}}^{K_{\text{init}}},\bm%
{\phi})
p(\tau)
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
\Psi(\mathcal{D}_{\text{init}};\bm{\theta}_{\text{init}}^{K_{\text{init}}},\bm%
{\phi})
\bm{\theta}_{\text{init}}^{K_{\text{init}}}
3\times 3
\mathbf{x}
\mathbf{f}(\mathbf{x};\bm{\theta})
{\bm{\theta}_{\text{init}}^{0}}
{\bm{\theta}_{\text{init}}^{0}}
\bm{\theta}_{\text{init}}^{k}=\bm{\theta}_{\text{init}}^{k-1}
\bm{\theta}_{\text{on}}^{k}=\bm{\theta}_{\text{on}}^{k-1}
\mathcal{S}
K_{\text{init}}
K_{\text{on}}
\mathcal{D}_{\text{init}}
\mathcal{D}_{\text{test}}^{\mathrm{std}}
\mathcal{D}_{\text{on}}
10^{-4}
5\times 10^{-5}
\mathcal{D}_{\text{on}}
\mathcal{D}_{\text{test}}^{\text{hard}}
K_{\text{init}}
K_{\text{on}}
K_{\text{init}}
K_{\text{on}}
K_{\text{init}}
K_{\text{on}}
50\pm{5}
49\pm{6}
12
\mathcal{B}
