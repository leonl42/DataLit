\approx 20\times
f=4
x
\mathbf{z}
L_{2}
L_{1}
E
G
\mathcal{Z}={z_{k}}_{k=1}^{K}\in\mathbb{R}^{K\times d}
K
d
x\in\mathbb{R}^{3\times H\times W}
\textbf{z}=E(x)\in\mathbb{R}^{d\times\frac{H}{f}\times\frac{W}{f}}
\textbf{z}_{q}
Q(\cdot)
z_{ij}
z_{k}
\textbf{z}_{q}=Q(\textbf{z})=\left(\operatorname*{argmin}_{z_{k}\in\mathcal{Z}%
}||z_{ij}-z_{k}||_{2}^{2}\right)\in\mathbb{R}^{d\times\frac{H}{f}\times\frac{W%
}{f}}
\tilde{x}=G(z_{q})
E
G
\mathcal{Z}
\mathcal{L}=||x-\tilde{x}||_{1}+||\phi(x)-\phi(\tilde{x})||_{1}+[\log D(x)+%
\log(1-D(\tilde{x}))]+\\
||\text{sg}(E(x))-\textbf{z}_{q}||_{2}^{2}+||\text{sg}(\textbf{z}_{q})-E(x)||_%
{2}^{2}
\text{sg}(\cdot)
\phi(\cdot)
\mathcal{Z}
f=4
32
K=8192
1024
{\textbf{z}_{t}}_{t=0}^{t=1}
\textbf{z}_{0}
\textbf{z}_{t}
t
d\textbf{z}_{t}=f(\textbf{z}_{t},t),dt+g(t)d\textbf{w}_{t}
f(\cdot,\cdot)
g(\cdot)
\textbf{w}_{t}
\textbf{z}_{t}
p(\textbf{z}_{t})
\textbf{z}_{1}\sim\mathcal{N}(z_{1},0,I)
d\textbf{z}_{t}=[f(\textbf{z}_{t},t)-\frac{1}{2}g^{2}(t)\nabla_{\textbf{z}}%
\log p(\textbf{z}_{t})]dt+g(t)d\bar{\textbf{{w}}}_{t}
\bar{\textbf{{w}}}_{t}
dt
d\textbf{z}_{t}=[f(\textbf{z}_{t},t)-g^{2}(t)\nabla_{\textbf{z}}\log p(\textbf%
{z}_{t})]dt
\nabla_{\textbf{z}}\log p(\textbf{z}_{t})
s_{\theta}(\textbf{z}_{t},t)
\lambda
\min_{\theta}\mathbb{E}_{t\sim\mathbb{U}[0,1]}(\lambda(t)||\nabla_{\textbf{z}}%
\log p(\textbf{z}_{t})-s_{\theta}(\textbf{z}_{t},t)||_{2}^{2})
\textbf{z}^{d}
\textbf{x}^{d}
p(\textbf{z}_{0}|\textbf{z}^{d})
\textbf{z}_{0}
\textbf{x}^{d}
\textbf{z}^{d}
d\textbf{z}_{t}=[f(\textbf{z}_{t},t)-g^{2}(t)\nabla_{\textbf{z}}\log p(\textbf%
{z}_{t}|\textbf{z}^{d})]dt
\nabla_{\textbf{z}}\log p(\textbf{z}_{t}|\textbf{z}^{d})
\nabla_{\textbf{z}}\log p(\textbf{z}_{t}|\textbf{z}^{d})
\nabla_{\textbf{z}}\log p(\textbf{z}_{t}|\textbf{z}^{d})=\nabla_{\textbf{z}}%
\log p(\textbf{z}_{t})+\nabla_{\textbf{z}}\log p(\textbf{z}^{d}|\textbf{z}_{t})
\nabla_{\textbf{z}}\log p(\textbf{z}_{t})
\nabla_{\textbf{z}}\log p(\textbf{z}^{d}|\textbf{z}_{t})
\textbf{z}^{d}
\textbf{z}_{t}
\min_{\theta}\mathbb{E}_{{\begin{subarray}{c}t\sim\mathbb{U}[0,1]\\
\textbf{z}^{d}\sim p(\textbf{z}^{d})\end{subarray}}}(\lambda(t)||\nabla_{z}%
\log p(\textbf{z}_{t})]-s_{\theta}(\textbf{z}_{t},\textbf{z}^{d},t)||_{2}^{2})
\textbf{z}^{d}
f(\textbf{z}_{t},t)=0
g(t)=\sqrt{2}t
p(\textbf{z}_{t})
p(\textbf{z}_{0})*\mathcal{N}(0,t^{2}I)
*
p(\textbf{z}_{0})
d\textbf{z}_{t}=-ts_{\theta}(\textbf{z}_{t},\textbf{z}^{d},t)
\hat{\textbf{z}}_{0}
x^{d}
\hat{\textbf{z}}_{0}
\times 32
\times 32
f_{\phi}
f_{\phi}
L_{1}
f_{\phi}
\mathcal{L}_{IRN}=\alpha L_{1}(f_{\phi}(\textbf{x}^{d}),\textbf{x})+D_{cos}(f_%
{arc}(f_{\phi}(\textbf{x}^{d})),f_{arc}(\textbf{x}))
D_{cos}
f_{arc}
\mathcal{L}_{arc}
\textbf{x}^{id}
\textbf{z}^{id}
\textbf{x}^{id}
\nabla_{{\hat{\textbf{z}}}_{0,t}}\mathcal{L}_{arc}
\mathcal{L}_{arc}
\hat{\textbf{z}}_{0,t}
\textbf{x}^{id}
\hat{\textbf{z}}_{0,t}
t
M_{l}\in\mathbb{R}^{d\times\frac{H}{f}\times\frac{W}{f}}
f_{M}
\hat{\textbf{z}}^{c}_{t}
M_{l}
f_{M}
\hat{\textbf{z}}_{0,t}
M_{l}
M_{l}
512\times 512
512\times 512
\downarrow
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
1024\times 1024
512\times 512
x^{d}=((x\otimes k)\downarrow_{s}+n_{\sigma})_{q}
x
x^{d}
k
n_{\sigma}
s
q
\sigma
\sigma
s
q
16\rightarrow 512
16\rightarrow 512
\downarrow
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\downarrow
\times 32
512\times 512
16\times 16
\downarrow
\downarrow
\uparrow
\uparrow
M_{l}
512\times 512
3\times 128\times 128
\times 1,\times 2,\times 3
f=32
f=4
f=32
16\times 16
f=4
f=32
f=4
M_{l}
\uparrow
\uparrow
\uparrow
