t
\mu_{t}
F
\boldsymbol{x}_{t}
\boldsymbol{x}_{t}
\boldsymbol{k}
\mu_{t}=F(\boldsymbol{x}_{t};\boldsymbol{k})
y_{t}
\mu_{t}
\boldsymbol{y}
y_{t}
\mu_{t}=F(\boldsymbol{x}_{t}^{\mathsf{T}}\boldsymbol{k})
\boldsymbol{x}_{t}
F
\boldsymbol{x}_{t}
g_{t}
\mu_{t}=g_{t}\cdot F(\boldsymbol{x}_{t};\boldsymbol{k})
\boldsymbol{g}
g_{t}=\exp(h_{t})
\boldsymbol{h}=\left[h_{t}\right]
\boldsymbol{h}
\boldsymbol{h}\;\sim\;\mathcal{N}\left(\boldsymbol{0},\boldsymbol{C}(%
\boldsymbol{\theta})\right)
\boldsymbol{C}(\boldsymbol{\theta})
\boldsymbol{h}
\boldsymbol{\theta}
\boldsymbol{C}(\boldsymbol{\theta})
\boldsymbol{X}=\left[\boldsymbol{x}_{t}\right]
\boldsymbol{y}
\boldsymbol{h}
\boldsymbol{k}
F
p(\boldsymbol{h},\boldsymbol{\theta},\boldsymbol{k}|\boldsymbol{X},\boldsymbol%
{y})\approx q_{k}(\boldsymbol{k}|\boldsymbol{X},\boldsymbol{y})\cdot q_{h,%
\theta}(\boldsymbol{h},\boldsymbol{\theta}|\boldsymbol{X},\boldsymbol{y})
q
\boldsymbol{X}
\boldsymbol{y}
q(\boldsymbol{k})
q(\boldsymbol{h},\boldsymbol{\theta})
F
\boldsymbol{h}
\boldsymbol{\theta}
\boldsymbol{\hat{\theta}}=\operatorname*{arg\,max}_{\boldsymbol{\theta}}p(%
\boldsymbol{X},\boldsymbol{y}|\boldsymbol{\theta},\boldsymbol{k})
\boldsymbol{h}
\boldsymbol{\hat{\theta}}
h
q(\boldsymbol{k})
\boldsymbol{\hat{\theta}}
\boldsymbol{\theta}
\boldsymbol{h}
\mathcal{LJ}=\log p(\boldsymbol{h},\boldsymbol{\theta},\boldsymbol{k};%
\boldsymbol{X},\boldsymbol{y})
\boldsymbol{h}
q(\boldsymbol{k})
\boldsymbol{\hat{\theta}}
\mathbb{E}_{q(\boldsymbol{k}),\boldsymbol{\hat{\theta}}}\left[\mathcal{LJ}%
\right]\;=\;-\boldsymbol{\boldsymbol{\hat{\nu}}}^{\mathsf{T}}\exp(\boldsymbol{%
h})\,+\,\boldsymbol{y}^{\mathsf{T}}\boldsymbol{h}-\frac{1}{2}\,\boldsymbol{h}^%
{\mathsf{T}}\boldsymbol{C}(\boldsymbol{\hat{\theta}})^{-1}\boldsymbol{h}\,+\,%
\mathrm{const}
\boldsymbol{\hat{\nu}}
\hat{\nu}_{t}=\mathbb{E}_{q(\boldsymbol{k})}\left[F(\boldsymbol{x}_{t};%
\boldsymbol{k})\right]
q(\boldsymbol{k})
\boldsymbol{h}
T
T\approx 10^{5}
7\times 10^{5}
\boldsymbol{h}
O(T^{3})
\boldsymbol{h}
\boldsymbol{C}
\boldsymbol{h}
\boldsymbol{C}
\boldsymbol{\theta}
\boldsymbol{h}
\boldsymbol{C}=\boldsymbol{Q}^{\mathsf{T}}\boldsymbol{L}\boldsymbol{Q}
\boldsymbol{P}
(T^{*}\times T)
\boldsymbol{P}^{\mathsf{T}}
\boldsymbol{R}=\boldsymbol{P}\boldsymbol{Q}
\boldsymbol{Q}
\boldsymbol{h}
\boldsymbol{Q}
\boldsymbol{R}
T^{*}
\boldsymbol{h^{*}}
\boldsymbol{h}
\boldsymbol{h}=\boldsymbol{R}^{\mathsf{T}}\boldsymbol{h^{*}}=\boldsymbol{Q}^{%
\mathsf{T}}\boldsymbol{P}^{\mathsf{T}}\boldsymbol{h^{*}}
O(T\log T\,+\,(T^{*})^{3})
\boldsymbol{h^{*}}
\displaystyle\mathcal{LP}_{\boldsymbol{h^{*}}}\;=\;-\boldsymbol{\hat{\nu}}^{%
\mathsf{T}}\exp\left(\boldsymbol{R}^{\mathsf{T}}\boldsymbol{h^{*}}\right)\,+\,%
\boldsymbol{y}^{\mathsf{T}}\boldsymbol{R}^{\mathsf{T}}\boldsymbol{h^{*}}\,-\,%
\frac{1}{2}\,\boldsymbol{h^{*}}^{\mathsf{T}}\boldsymbol{\left(\boldsymbol{L^{*%
}}\right)^{-1}}\boldsymbol{h^{*}}
\displaystyle\mathcal{LP}_{\boldsymbol{h^{*}}}\;
\displaystyle=\;-\boldsymbol{\hat{\nu}}^{\mathsf{T}}\exp\left(\boldsymbol{R}^{%
\mathsf{T}}\boldsymbol{h^{*}}\right)\,+\,\boldsymbol{y}^{\mathsf{T}}%
\boldsymbol{R}^{\mathsf{T}}\boldsymbol{h^{*}}\,-\,\frac{1}{2}\,\boldsymbol{h^{%
*}}^{\mathsf{T}}\boldsymbol{\left(\boldsymbol{L^{*}}\right)^{-1}}\boldsymbol{h%
^{*}}
\displaystyle\frac{\partial\mathcal{LP}_{\boldsymbol{h^{*}}}}{\partial%
\boldsymbol{h^{*}}}\;=\;\boldsymbol{R}\left(\boldsymbol{y}-\boldsymbol{\mu}%
\right)\,-\,\boldsymbol{\left(\boldsymbol{L^{*}}\right)^{-1}}\boldsymbol{h^{*}}
\displaystyle\frac{\partial\mathcal{LP}_{\boldsymbol{h^{*}}}}{\partial%
\boldsymbol{h^{*}}}\;
\displaystyle=\;\boldsymbol{R}\left(\boldsymbol{y}-\boldsymbol{\mu}\right)\,-%
\,\boldsymbol{\left(\boldsymbol{L^{*}}\right)^{-1}}\boldsymbol{h^{*}}
\displaystyle\frac{\partial^{2}\mathcal{LP}_{\boldsymbol{h^{*}}}}{\partial%
\boldsymbol{h^{*}}\,\partial{\boldsymbol{h^{*}}}^{\mathsf{T}}}\;=\;-%
\boldsymbol{R}\,\mathrm{diag}\left(\boldsymbol{\mu}\right)\boldsymbol{R}^{%
\mathsf{T}}\,-\,\boldsymbol{\left(\boldsymbol{L^{*}}\right)^{-1}}
\displaystyle\frac{\partial^{2}\mathcal{LP}_{\boldsymbol{h^{*}}}}{\partial%
\boldsymbol{h^{*}}\,\partial{\boldsymbol{h^{*}}}^{\mathsf{T}}}\;
\displaystyle=\;-\boldsymbol{R}\,\mathrm{diag}\left(\boldsymbol{\mu}\right)%
\boldsymbol{R}^{\mathsf{T}}\,-\,\boldsymbol{\left(\boldsymbol{L^{*}}\right)^{-%
1}}
\boldsymbol{\mu}=\boldsymbol{\hat{\nu}}\,\odot\,\exp(\boldsymbol{R}^{\mathsf{T%
}}\boldsymbol{h^{*}})
\odot
\boldsymbol{L^{*}}=\boldsymbol{R}\boldsymbol{C}\boldsymbol{R}^{\mathsf{T}}=%
\boldsymbol{P}\boldsymbol{L}\boldsymbol{P}^{\mathsf{T}}
\boldsymbol{h^{*}}
q(\boldsymbol{h^{*}}|\boldsymbol{\theta})
\mu_{t}\geq 0
\boldsymbol{h^{*}}
q(\boldsymbol{h^{*}}|\boldsymbol{\theta})=\mathcal{N}(\boldsymbol{\hat{h}^{*}}%
,\boldsymbol{\Lambda^{*}})
q(\boldsymbol{h}|\boldsymbol{\theta})=\mathcal{N}(\boldsymbol{\hat{h}},%
\boldsymbol{\Lambda})=\mathcal{N}(\boldsymbol{R}^{\mathsf{T}}\boldsymbol{\hat{%
h}^{*}},\boldsymbol{R}^{\mathsf{T}}\boldsymbol{\Lambda^{*}}\boldsymbol{R})
\boldsymbol{\Lambda}
(T\times T)
q(\boldsymbol{h^{*}})
q(\boldsymbol{h})
t^{\prime}
\hat{\nu}_{t^{\prime}}=y_{t^{\prime}}=0
h_{t^{\prime}}
\boldsymbol{h}
T
-\boldsymbol{Q}\,\mathrm{diag}\left(\boldsymbol{\mu}\right)\,\boldsymbol{Q}^{%
\mathsf{T}}
\boldsymbol{\mu}
\theta
\boldsymbol{h}
\boldsymbol{\theta}
\boldsymbol{L}
\boldsymbol{\theta}
\boldsymbol{h}
\boldsymbol{L}
f(i)
\boldsymbol{\theta}=\{\sigma^{2},\rho\}
\left[\boldsymbol{L}\right]_{ii}\;=\;\exp\left(-\frac{f(i)^{2}}{2\sigma^{2}}\,%
-\,\rho\right)
\boldsymbol{h^{*}}
\boldsymbol{\theta}=\{F_{c},\rho\}
\left[\boldsymbol{L}\right]_{ii}\;=\;\left\{\begin{array}[]{lr}e^{-\rho}\sum_{%
n=0}^{3}(-1)^{n}a_{n}\cos\left(\pi n(1+f(i)/F_{c})\right)&\;:\;f(i)\leq F_{c}%
\\
0&\;:\;f(i)>F_{c}\end{array}\right.
\boldsymbol{a}=[0.35875,0.48829,0.14128,0.01168]^{\mathsf{T}}
\boldsymbol{h}
\boldsymbol{h}
\boldsymbol{\theta}
\boldsymbol{h}
\boldsymbol{\theta}
\boldsymbol{\theta}
\boldsymbol{\hat{\theta}}
k
q(\boldsymbol{h},\boldsymbol{\theta})
q(\boldsymbol{k})
\boldsymbol{k}
\displaystyle\mathcal{LJ}\;=\;-F(\boldsymbol{x}_{t};\boldsymbol{k})^{\mathsf{T%
}}\exp(\boldsymbol{h})\,+\,\boldsymbol{y}^{\mathsf{T}}\log{F(\boldsymbol{x}_{t%
};\boldsymbol{k})}\,+\,\log p(\boldsymbol{k})\,+\,\mathrm{const}
\displaystyle\mathcal{LJ}\;=\;-F(\boldsymbol{x}_{t};\boldsymbol{k})^{\mathsf{T%
}}\exp(\boldsymbol{h})\,+\,\boldsymbol{y}^{\mathsf{T}}\log{F(\boldsymbol{x}_{t%
};\boldsymbol{k})}\,+\,\log p(\boldsymbol{k})\,+\,\mathrm{const}
q(\boldsymbol{h},\boldsymbol{\theta})
\exp(\boldsymbol{h})
q(\boldsymbol{h},\boldsymbol{\theta})
\displaystyle\mathbb{E}_{q(\boldsymbol{h},\boldsymbol{\theta})}\left[\exp(%
\boldsymbol{h})\right]\;=\;\exp\left(\boldsymbol{\hat{h}}+\frac{1}{2}\,\mathrm%
{diag}\,\boldsymbol{\Lambda}\right)\;=\;\exp\left(\boldsymbol{\hat{h}}+\frac{1%
}{2}\,\left((\boldsymbol{R}^{\mathsf{T}}\boldsymbol{\Lambda^{*}})\odot%
\boldsymbol{R}^{\mathsf{T}}\right)\boldsymbol{1}\right)
\displaystyle\mathbb{E}_{q(\boldsymbol{h},\boldsymbol{\theta})}\left[\exp(%
\boldsymbol{h})\right]\;=\;\exp\left(\boldsymbol{\hat{h}}+\frac{1}{2}\,\mathrm%
{diag}\,\boldsymbol{\Lambda}\right)\;=\;\exp\left(\boldsymbol{\hat{h}}+\frac{1%
}{2}\,\left((\boldsymbol{R}^{\mathsf{T}}\boldsymbol{\Lambda^{*}})\odot%
\boldsymbol{R}^{\mathsf{T}}\right)\boldsymbol{1}\right)
\boldsymbol{\Lambda}
\boldsymbol{R}^{\mathsf{T}}\boldsymbol{\Lambda^{*}}
\boldsymbol{\Lambda^{*}}
\boldsymbol{R}^{\mathsf{T}}
\boldsymbol{P}^{\mathsf{T}}
\boldsymbol{k}
F
\mathbb{E}_{q(\boldsymbol{h},\boldsymbol{\theta})}\left[\mathcal{LJ}\right]
\boldsymbol{k}
q(\boldsymbol{h},\boldsymbol{\theta})
q(\boldsymbol{k})
q(\boldsymbol{k})
q(\boldsymbol{h},\boldsymbol{\theta})
x
f(x)
K
\boldsymbol{k}
\boldsymbol{k_{\mathrm{true}}}
\boldsymbol{\theta_{\mathrm{true}}}
\boldsymbol{h_{\mathrm{true}}}
\boldsymbol{y}
T
\boldsymbol{k}
\boldsymbol{h}
\boldsymbol{\theta}
\boldsymbol{\theta}
q(\boldsymbol{h})
\boldsymbol{\hat{h}}
q(\boldsymbol{h})
\boldsymbol{h_{\mathrm{true}}}
\mathrm{sim}(\boldsymbol{\hat{h}},\boldsymbol{h_{\mathrm{true}}})=100\times(1-%
\mathrm{Var}(\boldsymbol{\hat{h}}-\boldsymbol{h_{\mathrm{true}}})/\mathrm{Var}%
(\boldsymbol{h_{\mathrm{true}}}))
1/4
1/2
1
4
1/4
1
4
q(\boldsymbol{h}|\boldsymbol{\theta})
\boldsymbol{\theta}
\boldsymbol{h^{*}}
\boldsymbol{\theta}
q(\boldsymbol{h})
\boldsymbol{\hat{h}}
q(\boldsymbol{h})
\boldsymbol{h_{\mathrm{true}}}
\mathrm{sim}(\boldsymbol{\hat{h}},\boldsymbol{h_{\mathrm{true}}})=100\times(1-%
\mathrm{Var}(\boldsymbol{\hat{h}}-\boldsymbol{h_{\mathrm{true}}})/\mathrm{Var}%
(\boldsymbol{h_{\mathrm{true}}}))
1/4
1/2
1
4
1/4
1
4
q(\boldsymbol{h}|\boldsymbol{\theta})
\boldsymbol{\theta}
\boldsymbol{h^{*}}
\boldsymbol{\hat{h}}
\boldsymbol{h_{\mathrm{true}}}
\boldsymbol{h_{\mathrm{true}}}
\boldsymbol{\hat{h}}
\boldsymbol{\hat{\theta}}
\boldsymbol{\theta_{\mathrm{true}}}
\boldsymbol{\theta}
\boldsymbol{h}
O(T\log T+(T^{*})^{3})
\boldsymbol{\theta}
\boldsymbol{\theta}
\boldsymbol{h^{*}}
\boldsymbol{h^{*}}
\boldsymbol{\theta}
\boldsymbol{k}
\boldsymbol{k}
\boldsymbol{\hat{h}}
\boldsymbol{k}
\boldsymbol{k}
\boldsymbol{\hat{h}}
\boldsymbol{k}
\nu_{t^{\prime}}=y_{t^{\prime}}=0
\boldsymbol{h}
\boldsymbol{\hat{\theta}}
r=0.6
\boldsymbol{\hat{\theta}}
r=0.6
\boldsymbol{\hat{\theta}}
