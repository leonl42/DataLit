r=r^{ext}+\beta r^{int}
r^{ext}
{r^{int}}
\beta
(\mathcal{S},\mathcal{A},r,f,\gamma)
\mathcal{A}
\mathcal{S}
s_{t}\in\mathcal{S}
a_{t}\in\mathcal{A}
r
r(s_{t},a_{t})
(s_{t},a_{t})
f(s_{t+1}|s_{t},a_{t})
s_{t+1}
\gamma\in[0,1)
\pi
\begin{split}\pi=\mathop{\arg\max}\limits_{\pi}\mathbb{E}_{\pi,f}[\sum_{t=0}^{%
\infty}\gamma^{t}r(s_{t},a_{t})]\end{split}
a_{t}\sim\pi(a_{t}|s_{t}),s_{t+1}\sim f(s_{t+1}|s_{t},a_{t})
\hat{f}(s_{t+1}|s_{t},a_{t})
r_{m}(s_{t},a_{t})
r_{e}(s_{t},a_{t})
(s_{t},a_{t})
\begin{split}\pi=\mathop{\arg\max}\limits_{\pi}\mathbb{E}_{\pi,\hat{f}}[\sum_{%
t=0}^{H}\gamma^{t}r(s_{t},a_{t})]=\mathop{\arg\max}\limits_{\pi}\mathbb{E}_{%
\pi}[\underbrace{r_{m}(s_{0},a_{0})+\sum_{\tau=1}^{H-1}\gamma^{\tau}r_{m}(\hat%
{f}(s_{\tau}|s_{\tau-1},a_{\tau-1}),\pi(s_{\tau}))]}_{\text{total reward of %
trajectory}}\end{split}
H
H
J
J_{model}
J_{env}
J_{model}
J_{env}
s_{0}
s_{0}
\delta(s_{0},a_{1})
\delta(s_{0},a_{2})
\delta(s_{0},a_{12})
a_{7}
a_{6}
s_{0}
s_{0}
\delta(s_{0},a_{1})
\delta(s_{0},a_{2})
\delta(s_{0},a_{12})
a_{7}
a_{6}
(s_{t},a_{t})
\epsilon_{r}(s_{t},a_{t})
\epsilon_{r_{max}}
\mathcal{S}
\mathcal{A}
\epsilon_{m}=max_{t}[D_{TV}(p(s_{t+1}|s_{t},a_{t})||\hat{p}(s_{t+1}|s_{t},a_{t%
}))]
\delta(s_{0},a_{0})
(s_{0},a_{0})
\begin{split}Error_{TREE}=J_{env}[\delta(s_{0},a_{0})]-J_{model}[\delta(s_{0},%
a_{0})]\leq\underbrace{\frac{(1-\gamma^{H})\epsilon_{r_{max}}}{1-\gamma}}_{%
\text{reward estimation gap}}+\underbrace{\frac{2r_{max}(\gamma-\gamma^{H})%
\epsilon_{m}}{1-\gamma}}_{\text{model error}}\end{split}
\square
\gamma
H
r_{max}
\mathcal{S}
\mathcal{A}
(s,a)
\hat{p}(\cdot|s_{t},a_{t})
r^{int}=\mathcal{H}(\hat{p}(\cdot|s,a))=\frac{k}{2}(ln2\pi+1)+\frac{1}{2}ln|%
\Sigma_{\hat{p}(\cdot|s,a)}|
k
\Sigma_{\hat{p}(\cdot|s,a)}
H
J(\delta)=\sum_{t=0}^{H-1}\gamma^{t}[r_{m}(s_{t},a_{t})+\beta(\frac{k}{2}(ln2%
\pi+1)+\frac{1}{2}ln|\Sigma_{\hat{p}(\cdot|s_{t},a_{t})}|)]
s_{t}\sim\hat{p}(\cdot|s_{t-1},a_{t-1})
\beta
r_{m}
e
\beta
\beta=f(e)=min(max(\beta_{min}+\frac{e-e_{min}}{e_{max}-e_{min}},\beta_{min}),%
\beta_{max})
\beta_{max}
\beta_{min}
\beta
e_{max}
e_{min}
e
\beta
e_{min}
\beta
\beta_{min}
e
\beta_{max}
\theta
\phi
\mathbb{D}
\alpha
e
\emph{i}^{th}
\mu=\mu_{0}
\Sigma=\sigma_{0}^{2}\emph{{I}}
K
\beta
\mu^{{}^{\prime}}
\Sigma^{{}^{\prime}}
k
\mu=(1-\alpha)\mu+\alpha\mu^{{}^{\prime}},\Sigma=(1-\alpha)\Sigma+\alpha\Sigma%
^{{}^{\prime}}
\mathbb{D}\leftarrow\mathbb{D}\cup\{s_{t},a_{t},s_{t+1},r_{t}\}
\theta
\phi
\mathbb{D}
\theta
s_{t}
a_{t}
\hat{p}(s_{t+1}|s_{t},a_{t})=\mathcal{N}(\mu_{\theta}(s_{t},a_{t}),\Sigma_{%
\theta}(s_{t},a_{t}))
loss=\sum_{n=1}^{N}[\mu_{\theta}(s_{n},a_{n})-s_{n+1}]^{\top}\Sigma_{\theta}^{%
-1}(s_{n},a_{n})[\mu_{\theta}(s_{n},a_{n})-s_{n+1}]+logdet\Sigma_{\theta}(s_{n%
},a_{n})
\mu=\mu_{0}
\Sigma=\sigma_{0}^{2}\emph{{I}}
K
H
K
\beta
k
\beta_{min}
\beta_{max}
e_{min}
e_{max}
\mathbf{18469.6\pm 3727.6}
\mathbf{3440.8\pm 277.3}
\mathbf{3543.9\pm 576.7}
\mathbf{4387.6\pm 580.8}
5521.7\pm 919.2
1382.9\pm 246.8
1197.9\pm 975.8
2772.7\pm 966.8
1084.6\pm 336.8
679.8\pm 34.4
206.4\pm 130.2
2333.4\pm 859.4
2142.0\pm 973.2
814.4\pm 130.2
918.8\pm 152.2
3284.2\pm 595.2
9619.4\pm 685.0
2729.4\pm 93.4
2574.0\pm 87.8
1348.2\pm 438.2
16105.4\pm 3849.2
\mathbf{4373.6\pm 159.8}
\mathbf{4711.7\pm 613.6}
\mathbf{4697.3\pm 725.4}
\mathbf{18884.2\pm 1967.0}
3252.7\pm 186.2
3979.5\pm 603.4
3742.8\pm 632.4
780k
700k
750k
590k
300k
320k
250k
330k
240k
50k
200k
280k
400k
100k
360k
300k
120k
430k
400k
250k
(s_{t},a_{t})
\epsilon_{r}(s_{t},a_{t})
\epsilon_{r_{max}}
\mathcal{S}
\mathcal{A}
\epsilon_{m}=max_{t}[D_{TV}(p(s_{t+1}|s_{t},a_{t})||\hat{p}(s_{t+1}|s_{t},a_{t%
}))]
\delta(s_{0},a_{0})
(s_{0},a_{0})
\begin{split}Error_{TREE}=J_{env}[\delta(s_{0},a_{0})]-J_{model}[\delta(s_{0},%
a_{0})]\leq\underbrace{\frac{(1-\gamma^{H})\epsilon_{r_{max}}}{1-\gamma}}_{%
\text{reward estimation gap}}+\underbrace{\frac{2r_{max}(\gamma-\gamma^{H})%
\epsilon_{m}}{1-\gamma}}_{\text{model error}}\end{split}
\hat{f}
\hat{p}(s_{t+1}|s_{t},a_{t})
p(s_{t+1}|s_{t},a_{t})
p_{\pi}(a_{t}|s_{t})
\displaystyle J_{env}[\delta(s_{0},a_{0})]-J_{model}[\delta(s_{0},a_{0})]
\displaystyle J_{env}[\delta(s_{0},a_{0})]-J_{model}[\delta(s_{0},a_{0})]
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}[p(s_{t},a_{t})r_{e}(s_{t},a_{t})-\hat{p}(s_{t},a_{t})r_{m}%
(s_{t},a_{t})]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}[p(s_{t},a_{t})r_{e}(s_{t},a_{t})-\hat{p}(s_{t},a_{t})r_{m}%
(s_{t},a_{t})]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}[p(s_{t}|s_{t-1},a_{t-1})p_{\pi}(a_{t}|s_{t})r_{e}(s_{t},a_%
{t})}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}[p(s_{t}|s_{t-1},a_{t-1})p_{\pi}(a_{t}|s_{t})r_{e}(s_{t},a_%
{t})}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad-{\hat{p}(s_{t}|s_{t-1},a_{t-1})p_{\pi}(a_{t}|s_{t})r_{m}(s_{t}%
,a_{t})]}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad-{\hat{p}(s_{t}|s_{t-1},a_{t-1})p_{\pi}(a_{t}|s_{t})r_{m}(s_{t}%
,a_{t})]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_%
{t})}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_%
{t})}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad-{\hat{p}(s_{t}|s_{t-1},a_{t-1})r_{m}(s_{t},a_{t})]}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad-{\hat{p}(s_{t}|s_{t-1},a_{t-1})r_{m}(s_{t},a_{t})]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_%
{t})-\hat{p}(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_{t})}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_%
{t})-\hat{p}(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_{t})}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad{+\hat{p}(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_{t})-\hat{p}(s_{t%
}|s_{t-1},a_{t-1})r_{m}(s_{t},a_{t})]}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad{+\hat{p}(s_{t}|s_{t-1},a_{t-1})r_{e}(s_{t},a_{t})-\hat{p}(s_{t%
}|s_{t-1},a_{t-1})r_{m}(s_{t},a_{t})]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[[p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t%
}|s_{t-1},a_{t-1})]r_{e}(s_{t},a_{t})}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[[p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t%
}|s_{t-1},a_{t-1})]r_{e}(s_{t},a_{t})}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad{+\hat{p}(s_{t}|s_{t-1},a_{t-1})[r_{e}(s_{t},a_{t})-r_{m}(s_{t}%
,a_{t})]]}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\quad\quad\quad{+\hat{p}(s_{t}|s_{t-1},a_{t-1})[r_{e}(s_{t},a_{t})-r_{m}(s_{t}%
,a_{t})]]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t}%
|s_{t-1},a_{t-1})]r_{e}(s_{t},a_{t})}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t}%
|s_{t-1},a_{t-1})]r_{e}(s_{t},a_{t})}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad{+\sum^{H-%
1}_{t=1}\sum_{s_{t},a_{t}}\gamma^{t}p_{\pi}(a_{t}|s_{t})\hat{p}(s_{t}|s_{t-1},%
a_{t-1})[r_{e}(s_{t},a_{t})-r_{m}(s_{t},a_{t})]}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad{+\sum^{H-%
1}_{t=1}\sum_{s_{t},a_{t}}\gamma^{t}p_{\pi}(a_{t}|s_{t})\hat{p}(s_{t}|s_{t-1},%
a_{t-1})[r_{e}(s_{t},a_{t})-r_{m}(s_{t},a_{t})]}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t}%
|s_{t-1},a_{t-1})]r_{e}(s_{t},a_{t})}
\displaystyle=r_{e}(s_{0},a_{0})-r_{m}(s_{0},a_{0})+\sum^{H-1}_{t=1}\sum_{s_{t%
},a_{t}}{\gamma^{t}p_{\pi}(a_{t}|s_{t})[p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t}%
|s_{t-1},a_{t-1})]r_{e}(s_{t},a_{t})}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad{+\sum^{H-%
1}_{t=1}\gamma^{t}E_{s_{t}\sim\hat{p},a_{t}\sim\pi}[r_{e}(s_{t},a_{t})-r_{m}(s%
_{t},a_{t})]}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad{+\sum^{H-%
1}_{t=1}\gamma^{t}E_{s_{t}\sim\hat{p},a_{t}\sim\pi}[r_{e}(s_{t},a_{t})-r_{m}(s%
_{t},a_{t})]}
\displaystyle\leq\epsilon_{r_{max}}+\sum^{H-1}_{t=1}\gamma^{t}r_{max}\sum_{s_{%
t}}|p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t}|s_{t-1},a_{t-1})|+\sum^{H-1}_{t=1}%
\gamma^{t}\epsilon_{r_{max}}\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad
\displaystyle\leq\epsilon_{r_{max}}+\sum^{H-1}_{t=1}\gamma^{t}r_{max}\sum_{s_{%
t}}|p(s_{t}|s_{t-1},a_{t-1})-\hat{p}(s_{t}|s_{t-1},a_{t-1})|+\sum^{H-1}_{t=1}%
\gamma^{t}\epsilon_{r_{max}}\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad
\displaystyle=\epsilon_{r_{max}}+\sum^{H-1}_{t=1}\gamma^{t}r_{max}2D_{TV}(p(s_%
{t}|s_{t-1},a_{t-1})||\hat{p}(s_{t}|s_{t-1},a_{t-1}))+\sum^{H-1}_{t=1}\gamma^{%
t}\epsilon_{r_{max}}
\displaystyle=\epsilon_{r_{max}}+\sum^{H-1}_{t=1}\gamma^{t}r_{max}2D_{TV}(p(s_%
{t}|s_{t-1},a_{t-1})||\hat{p}(s_{t}|s_{t-1},a_{t-1}))+\sum^{H-1}_{t=1}\gamma^{%
t}\epsilon_{r_{max}}
\displaystyle\leq\epsilon_{r_{max}}+\sum^{H-1}_{t=1}{\gamma^{t}[2r_{max}%
\epsilon_{m}+\epsilon_{r_{max}}]}
\displaystyle\leq\epsilon_{r_{max}}+\sum^{H-1}_{t=1}{\gamma^{t}[2r_{max}%
\epsilon_{m}+\epsilon_{r_{max}}]}
\displaystyle=\epsilon_{r_{max}}+\frac{\gamma[2r_{max}\epsilon_{m}+\epsilon_{r%
_{max}}](1-\gamma^{H-1})}{1-\gamma}
\displaystyle=\epsilon_{r_{max}}+\frac{\gamma[2r_{max}\epsilon_{m}+\epsilon_{r%
_{max}}](1-\gamma^{H-1})}{1-\gamma}
\displaystyle=\frac{(1-\gamma^{H})\epsilon_{r_{max}}}{1-\gamma}+\frac{2r_{max}%
(\gamma-\gamma^{H})\epsilon_{m}}{1-\gamma}
\displaystyle=\frac{(1-\gamma^{H})\epsilon_{r_{max}}}{1-\gamma}+\frac{2r_{max}%
(\gamma-\gamma^{H})\epsilon_{m}}{1-\gamma}
\square
18
6
1000
28
8
1000
17
6
1000
17
6
1000
38.9\pm 11.0
\mathbf{28.4\pm 33.9}
\mathbf{185.1\pm 23.8}
\mathbf{-56.7\pm 18.3}
\mathbf{200.2\pm 0.6}
17.9\pm 20.6
-15.3\pm 29.5
134.8\pm 114.4
-91.6\pm 23.1
199.3\pm 1.2
\mathbf{41.6\pm 18.4}
-75.6\pm 8.8
173.5\pm 2.5
-58.4\pm 23.3
78.0\pm 166.6
31,6\pm 9.7
-68.1\pm 6.7
177.3\pm 1.9
-98.5\pm 12.6
160.1\pm 69.1
14.5\pm 5.6
-193.3\pm 11.7
162.7\pm 7.6
-147.2\pm 5.1
14.4\pm 18.6
-13.8\pm 16.1
-394.4\pm 1.4
-132.6\pm 410.1
-104.2\pm 11.3
-1.9\pm 155.9
38.0\pm 1.5
-95.3\pm 8.9
163.4\pm 8.0
-227.9\pm 8.3
86.5\pm 7.8
21.5\pm 23.9
-64.3\pm 6.9
161.4\pm 14.4
-203\pm 56.3
196.0\pm 3.1
23.0\pm 17.3
-52.9\pm 2.0
168.2\pm 9.5
-233.8\pm 57.1
199.4\pm 0.4
\mathbf{-20.7\pm 10.9}
\mathbf{-0.1\pm 0.3}
1396.2\pm 372.2
-7.3\pm 2.1
-42.8\pm 29.1
-52.4\pm 43.6
-615.2\pm 804.9
-13.2\pm 5.2
-29.4\pm 16.7
-240.4\pm 7.2
1132.7\pm 274.6
\mathbf{-4.1\pm 0.1}
-38.9\pm 6.1
-126.2\pm 86.6
1272.5\pm 500.9
13.4\pm 0.2
-646.3\pm 457.8
-74.6\pm 97.8
-768.5\pm 200.9
-19.8\pm 0.9
-62.5\pm 27.9
-194.5\pm 0.8
-1729.9\pm 1611.1
-13.2\pm 5.9
-174.5\pm 13.6
-40.8\pm 21.0
-103.8\pm 1028.0
-17.2\pm 0.9
-431.9\pm 173.6
-224.5\pm 0.4
\mathbf{2245.3\pm 232.4}
-14.0\pm 0.9
-147.3\pm 34.8
-0.2\pm 0.1
726.4\pm 675.5
-6.4\pm 0.5
\beta_{max}
\beta_{max}
\beta_{min}
e_{min}
e_{max}
\beta_{max}
\beta_{max}
\beta_{max}
\beta_{max}
\beta_{max}
\beta_{max}
\beta_{max}
K
H
k
\alpha
\beta_{min}
\beta_{max}
e_{min}
e_{max}
e_{min}
e_{max}
