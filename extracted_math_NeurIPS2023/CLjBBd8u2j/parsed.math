\mathcal{P}
\mathcal{I}_{0}
a_{i}
\mathcal{I}_{0}
u_{i}(\mathcal{I}_{0},\mathcal{P})
w_{i}
\mathcal{D}
\Omega(\mathcal{I}_{k},\mathcal{P})
\mathcal{P}
\mathcal{I}_{0}
a_{i}
\mathcal{I}_{0}
u_{i}(\mathcal{I}_{0},\mathcal{P})
w_{i}
\mathcal{D}
\Omega(\mathcal{I}_{k},\mathcal{P})
\mathcal{I}
\mathcal{P}
\mathcal{I}
\mathcal{P}
\mathcal{P}
\mathcal{M}
\displaystyle\mathbf{x}=\{x_{0},x_{1},\dots x_{n}\}=\mathcal{M}(\mathbf{x}\mid%
\mathcal{P},D_{exempler},\mathcal{T}),
\displaystyle\mathbf{x}=\{x_{0},x_{1},\dots x_{n}\}=\mathcal{M}(\mathbf{x}\mid%
\mathcal{P},D_{exempler},\mathcal{T}),
\mathbf{x}
n
D_{exemplar}
\mathcal{T}
\mathbf{x}
{x}_{i}=\{a_{i},p_{i}\}
a_{i}
p_{i}
\mathcal{P}
\mathcal{P}:\textit{`a cat and a dog'}
\displaystyle\mathcal{M}(\mathbf{x}\mid\mathcal{P}:\textit{`a cat and a dog'},%
D_{exempler},\mathcal{T})=\left[\{\textit{`there is a cat'},\textit{`a cat'}\}%
,\{\textit{`there is a dog',`a dog'}\}\right].
\displaystyle\mathcal{M}(\mathbf{x}\mid\mathcal{P}:\textit{`a cat and a dog'},%
D_{exempler},\mathcal{T})=\left[\{\textit{`there is a cat'},\textit{`a cat'}\}%
,\{\textit{`there is a dog',`a dog'}\}\right].
\mathcal{I}
\mathcal{I}
a_{i},i=1,\dots n
a^{q}_{i}
\mathcal{V}
u_{i}(\mathcal{I},a_{i})
\displaystyle u_{i}(\mathcal{I},a_{i})=\frac{\exp{(\alpha_{i}/\tau)}}{\exp{(%
\alpha_{i}/\tau)}+\exp{(\beta_{i}/\tau)}},\ \textit{where}\quad\alpha_{i}=%
\mathcal{V}(\textit{`yes'}\mid\mathcal{I},a^{q}_{i}),\quad\beta_{i}=\mathcal{V%
}(\textit{`no'}\mid\mathcal{I},a^{q}_{i}),
\displaystyle u_{i}(\mathcal{I},a_{i})=\frac{\exp{(\alpha_{i}/\tau)}}{\exp{(%
\alpha_{i}/\tau)}+\exp{(\beta_{i}/\tau)}},\ \textit{where}\quad\alpha_{i}=%
\mathcal{V}(\textit{`yes'}\mid\mathcal{I},a^{q}_{i}),\quad\beta_{i}=\mathcal{V%
}(\textit{`no'}\mid\mathcal{I},a^{q}_{i}),
\alpha_{i},\beta_{i}
\mathcal{V}
\mathcal{I}
a^{q}_{i}
\tau
\mathcal{P}
a_{i}
p_{i}
\mathcal{P}
a_{i}
p_{i}
u_{i}(\mathcal{I},a_{i})
\Omega(\mathcal{I},\mathcal{P})
\mathcal{I}
\mathcal{P}
\displaystyle\Omega(\mathcal{I},\mathcal{P})=\frac{\sum_{i}\lambda_{i}(%
\mathcal{P},a_{i})\ u_{i}(\mathcal{I}_{k},a_{i})}{\sum_{i}\lambda_{i}(\mathcal%
{P},a_{i})},
\displaystyle\Omega(\mathcal{I},\mathcal{P})=\frac{\sum_{i}\lambda_{i}(%
\mathcal{P},a_{i})\ u_{i}(\mathcal{I}_{k},a_{i})}{\sum_{i}\lambda_{i}(\mathcal%
{P},a_{i})},
\lambda_{i}(\mathcal{P},a_{i})
a_{i}
\mathcal{P}
\lambda_{i}=1\forall i
\lambda_{i}
u_{i}(\mathcal{I},a_{i})
\mathcal{P}
\mathcal{I}
u_{i}(\mathcal{I},q_{i})
\Omega(\mathcal{I},\mathcal{P})
a_{i}
w_{i}
w_{i}
a_{i}
\mathcal{P}
\displaystyle\text{CLIP}(\mathcal{P})=\mathcal{W}(\mathcal{P},\{\text{CLIP}(p_%
{i}),w_{i}\}_{i=1}^{n}))
\displaystyle\text{CLIP}(\mathcal{P})=\mathcal{W}(\mathcal{P},\{\text{CLIP}(p_%
{i}),w_{i}\}_{i=1}^{n}))
\mathcal{W}
p_{i}
a_{i}
w_{i}
p_{i}
\mathcal{P}
z_{t}
a_{i}
\displaystyle z_{t}=z_{t}-\alpha\nabla_{z_{t}}\mathcal{L}(z_{t},\{w_{i}\}_{i=1%
}^{n})),\ \mbox{where}\ \quad\mathcal{L}(z_{t},\{w_{i}\}_{i=1}^{n})=\sum_{i}w_%
{i}(1-\text{max}\ G(\mathcal{A}^{t}_{i})),
\displaystyle z_{t}=z_{t}-\alpha\nabla_{z_{t}}\mathcal{L}(z_{t},\{w_{i}\}_{i=1%
}^{n})),\ \mbox{where}\ \quad\mathcal{L}(z_{t},\{w_{i}\}_{i=1}^{n})=\sum_{i}w_%
{i}(1-\text{max}\ G(\mathcal{A}^{t}_{i})),
\alpha
\mathcal{A}^{t}_{i}
a_{i}
G
w_{i}
k\in[1,5]
\Omega(\mathcal{I}_{k},\mathcal{P})
u_{i}(\mathcal{I}_{k},\mathcal{P})
\mathcal{I}_{k+1}
\displaystyle\mathcal{I}_{k+1}=\mathcal{D}(\mathcal{P},\{w^{k+1}_{i}\}_{i=1}^{%
n}));\ \mbox{where}\quad w_{i}^{k+1}=\begin{cases}w_{i}^{k}+\Delta,\ \text{if}%
\quad i=\text{argmin}_{l}\ u_{l}(\mathcal{I},\mathcal{P})\\
w_{i}^{k}\quad\text{otherwise}\end{cases},
\displaystyle\mathcal{I}_{k+1}=\mathcal{D}(\mathcal{P},\{w^{k+1}_{i}\}_{i=1}^{%
n}));\ \mbox{where}\quad w_{i}^{k+1}=\begin{cases}w_{i}^{k}+\Delta,\ \text{if}%
\quad i=\text{argmin}_{l}\ u_{l}(\mathcal{I},\mathcal{P})\\
w_{i}^{k}\quad\text{otherwise}\end{cases},
\mathcal{D}
\Delta
\Omega(\mathcal{I}_{k},\mathcal{P})
\mathcal{I}^{\star}
\displaystyle\mathcal{I}^{\star}=\text{argmax}_{\mathcal{I}_{k}}\Omega(%
\mathcal{I}_{k},\mathcal{P}).
\displaystyle\mathcal{I}^{\star}=\text{argmax}_{\mathcal{I}_{k}}\Omega(%
\mathcal{I}_{k},\mathcal{P}).
N\in[2,5]
N=2
\mathcal{P}
\mathcal{I}
\Omega(\mathcal{I},\mathcal{P})
\uparrow
\downarrow
4-10
512\times 512
\alpha_{cfg}=7.5
\mathcal{P}
a_{i}
p_{i}
\mathcal{P}
a_{i}
p_{i}
K=5
0.8
\Omega(\mathcal{I}_{k},\mathcal{P})
w_{i}=1\forall i
\gamma_{i}=0\forall i
\Delta
0.1
1.0
\mathcal{I}^{\star}
\displaystyle\mathcal{I}^{\star}=\text{argmax}_{\mathcal{I}_{k}}\Omega(%
\mathcal{I}_{k},\mathcal{P}).
\displaystyle\mathcal{I}^{\star}=\text{argmax}_{\mathcal{I}_{k}}\Omega(%
\mathcal{I}_{k},\mathcal{P}).
\mathcal{P}
\mathcal{I}
\mathcal{P},\mathcal{I}
\mathcal{M}
\mathcal{V}
\mathcal{D}
\mathcal{T}
\tau=0.9
\triangleright
\mathbf{x}=\{x_{0},x_{1},\dots x_{n}\}=\mathcal{M}(\mathbf{x}\mid\mathcal{P},%
\mathcal{D}_{exempler},\mathcal{T}),\quad\textit{where}\ \ x_{i}=\{a_{i},p_{i}%
,a^{q}_{i}\}
\triangleright
u_{i}(\mathcal{I},a_{i})=\frac{\exp{(\alpha_{i}/\tau)}}{\exp{(\alpha_{i}/\tau)%
}+\exp{(\beta_{i}/\tau)}},\ \textit{where}\quad\alpha_{i}=\mathcal{V}(\textit{%
`yes'}\mid\mathcal{I},a^{q}_{i}),\quad\beta_{i}=\mathcal{V}(\textit{`no'}\mid%
\mathcal{I},a^{q}_{i})
\triangleright
\Omega(\mathcal{I},\mathcal{P})={\sum_{i}\lambda_{i}(\mathcal{P},a_{i})\ u_{i}%
(\mathcal{I},a_{i})}/{\sum_{i}\lambda_{i}(\mathcal{P},a_{i})},
\Omega(\mathcal{I},\mathcal{P})
\mathcal{P}
p_{i}
a^{q}_{i}
\mathcal{I}^{\star}
\mathcal{P}
\mathcal{D}
\mathcal{V}
\mathcal{W}
K=5
\Omega_{max}=0.8
\Delta_{w}=0.1
\Delta_{\gamma}=1.0
\alpha=10
t_{0}=20
\triangleright
w^{0}_{i}=1\ \forall i
\gamma^{0}_{i}=0\ \forall i
\triangleright
0\leq k<K
\triangleright
y_{prompt}=\mathcal{W}(\mathcal{P},\{\text{CLIP}(p_{i}),w^{k}_{i}\}_{i=1}^{n}))
\triangleright
z_{T}\sim\mathcal{N}(0,\bm{I})
0<t\leq T
\_,\mathcal{A}_{i}^{t}=\mathcal{D}(z_{t},y_{prompt},t)
t\geq T-t_{0}
\triangleright
\mathcal{L}(z_{t},\{\gamma^{k}_{i}\}_{i=1}^{n})=\sum_{i}\gamma^{k}_{i}(1-\text%
{max}\ G(\mathcal{A}^{t}_{i}))
z_{t}=z_{t}-\alpha\nabla_{z_{t}}\mathcal{L}(z_{t},\{\gamma^{k}_{i}\}_{i=1}^{n}))
z_{t-1}=\textsc{ReverseDiff}(z_{t},t\rightarrow t-1\mid y_{prompt})
\triangleright
\mathcal{I}_{k}=x_{0}=\textsc{Decoder}(z_{0})
\Omega(\mathcal{I}_{k},\mathcal{P}),\{u_{i}(\mathcal{I}_{k},\mathcal{P})\}_{i}%
^{n}=\textsc{DA-Score}(\mathcal{I}_{k},\{a^{q}_{i}\}_{i})
\triangleright
\Omega(\mathcal{I}_{k},\mathcal{P})\geq\Omega_{max}
\mathcal{I}^{\star}=\mathcal{I}_{k}
\triangleright
w_{i}^{k+1}=\begin{cases}w_{i}^{k}+\Delta_{w},\ \text{if}\quad i=\text{argmin}%
_{l}\ u_{l}(\mathcal{I}_{k},\mathcal{P})\\
w_{i}^{k}\quad\text{otherwise}\end{cases}
\gamma_{i}^{k+1}=\begin{cases}\gamma_{i}^{k}+\Delta_{\gamma},\ \text{if}\quad i%
=\text{argmin}_{l}\ u_{l}(\mathcal{I}_{k},\mathcal{P})\\
\gamma_{i}^{k}\quad\text{otherwise}\end{cases}
\triangleright
\mathcal{I}^{\star}=\text{argmax}_{\mathcal{I}_{k}}\Omega(\mathcal{I}_{k},%
\mathcal{P})
N
\mathcal{P}
512\times 512
