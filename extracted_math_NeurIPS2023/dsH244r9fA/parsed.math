{\pi_{e}}
{\pi_{b}}
{\pi_{e}}
{\pi_{b}}
{\pi_{e}}
\frac{{\pi_{e}}(a|s)}{{\pi_{b}}(a|s)}
{\pi_{b}}(a|s)
\mathcal{D}
\mathcal{D}
\mathcal{S}
\mathcal{A}
P
R
L
\gamma
d_{0}
\pi
\mathcal{S}
\mathcal{A},
H\coloneqq(S_{0},A_{0},R_{0},S_{1},\dotsc,S_{L-1},A_{L-1},R_{L-1})
g(H)\coloneqq\sum_{t=0}^{L-1}\gamma^{t}R_{t}
H
v(\pi)\coloneqq\mathbf{E}[g(H)|H\sim\pi]
\pi
S_{0}
L
{\pi_{e}}
m
\mathcal{D}\coloneqq\{H_{i},{\pi_{b}}^{(i)}\}_{i=1}^{m}
H_{i}\sim{\pi_{b}}^{(i)}
\forall\{H_{i},{\pi_{b}}^{(i)}\}\in\mathcal{D}
{\pi_{b}}^{(i)}
\mathcal{D}
\operatorname{OPE}
\mathcal{D}
v({\pi_{e}})
\mathbf{E}_{\mathcal{D}}[(\operatorname{OPE}({\pi_{e}},\mathcal{D})-v({\pi_{e}%
}))^{2}]
{\pi_{b}}
m
v({\pi_{e}})
\operatorname{IS}({\pi_{e}},\mathcal{D})\coloneqq\frac{1}{m}\sum_{i=1}^{m}g(H^%
{(i)})\prod_{t=0}^{L-1}\frac{\pi_{e}(A_{t}^{(i)}|S_{t}^{(i)})}{{\pi_{b}}^{(i)}%
(A_{t}^{(i)}|S_{t}^{(i)})}.
\operatorname{OIS}
\frac{{\pi_{e}}(A|S)}{{\pi_{b}}(A|S)}
A
S
\operatorname{OIS}
v({\pi_{e}})
{\pi_{b}}
{\pi_{e}}
{\pi_{b}}
\operatorname{OIS}
{\pi_{e}}
\operatorname{OIS}
\operatorname{OIS}
\operatorname{OIS}
{\pi_{b}}
\operatorname{OIS}
\operatorname{OIS}
{\pi_{b}}
\operatorname{OIS}
\mathcal{D}
v({\pi_{e}})
\operatorname{OIS}
\mathcal{D}
h
v({\pi_{e}})
h
g(h)
\operatorname{OIS}
g(h)
\Pr(h|{\pi_{e}})
{\pi_{e}}
\operatorname{OIS}
\operatorname{OIS}
\operatorname{RIS}
\mathcal{D}
\mathcal{D}
{\pi_{b}}
\mathcal{D}
{\pi_{\mathcal{D}}}
{\pi_{b}}
\operatorname{OIS}
{\pi_{b}}
{\pi_{e}}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
{\pi_{e}}
\mathcal{D}
\Pi^{n}
\pi\in\Pi^{n}
n
\pi:\mathcal{S}^{n+1}\times\mathcal{A}^{n}\rightarrow[0,1]
H_{t-n:t}
S_{t-n},A_{t-n},...S_{t-1},A_{t-1},S_{t}
t-n<0
H_{t-n:t}
t
\operatorname{RIS}(n)
\Pi^{n}
\mathcal{D}
{\pi_{\mathcal{D}}}^{(n)}:=\operatorname*{\arg\!\max}_{\pi\in\Pi^{n}}\sum_{H%
\in\mathcal{D}}\sum_{t=0}^{L-1}\log\pi(a|H_{t-n:t}).
\operatorname{RIS}(n)
{\pi_{\mathcal{D}}}^{(n)}
{\pi_{b}}
\operatorname{RIS}(n)({\pi_{e}},\mathcal{D}):=\frac{1}{m}\sum_{i=1}^{m}g(H_{i}%
)\prod_{t=0}^{L-1}\frac{{\pi_{e}}(A_{t}|S_{t})}{{\pi_{\mathcal{D}}}^{(n)}(A_{t%
}|H_{t-n:t})}
\operatorname{OIS}
\frac{{\pi_{e}}(A_{t}|S_{t})}{{\pi_{\mathcal{D}}}^{(n)}(S_{t}|H_{t-n:t})}
\operatorname{RIS}(n)
A_{t}
S_{t}
H_{t-n:t}
\operatorname{RIS}(n)
{\pi_{\mathcal{D}}}^{(n)}
\mathcal{D}
\operatorname{RIS}
|\mathcal{S}|
|\mathcal{A}|
\mathcal{H}
{\pi_{b}}
\mathcal{D}
h\in\mathcal{H}
c(h_{i:j})
h_{i:j}
\mathcal{D}
c(h_{i:j},a)
a
h_{i:j}
\mathcal{D}
\operatorname{RIS}(n)
{\pi_{\mathcal{D}}}(a|h_{i-n:i}):=\frac{c(h_{i-n:i},a)}{c(h_{i-n:i})}.
\operatorname{OIS}
\operatorname{RIS}
\underbrace{\frac{1}{m}\sum_{i=1}^{m}\frac{w_{\pi_{e}}(h_{i})}{w_{\pi}(h_{i})}%
g(h_{i})}_{(i)}=\underbrace{\sum_{h\in\mathcal{H}}\frac{c(h)}{m}\frac{w_{\pi_{%
e}}(h)}{w_{\pi}(h)}g(h)}_{(ii)}
w_{\pi}(h)
\prod_{t=0}^{L-1}\pi(a_{t}|s_{t})
\operatorname{OIS}
\pi\coloneqq{\pi_{b}}
\operatorname{RIS}(n)
\pi\coloneqq{\pi_{\mathcal{D}}}^{(n)}
{\pi_{\mathcal{D}}}^{(L-1)}
{\pi_{b}}
\Pr(H|{\pi_{\mathcal{D}}}^{(L-1)})=\frac{c(H)}{m}
\mathbf{E}\left[\frac{w_{\pi_{e}}(H)}{w_{\pi}(H)}g(H)|H\sim{\pi_{\mathcal{D}}}%
^{(L-1)}\right].
\operatorname{OIS}
\operatorname{RIS}
{\pi_{b}}
w_{\pi}:=w_{\pi_{\mathcal{D}}}^{(L-1)}
\operatorname{RIS}(L-1)
v({\pi_{e}})
\mathbf{E}[\frac{\Pr(H|{\pi_{e}})}{\Pr(H|\pi)}g(h)|H\sim\pi]=\mathbf{E}[g(H)|H%
\sim{\pi_{e}}]=v({\pi_{e}})
w_{\pi}:=w_{\pi_{b}}
v({\pi_{e}})
{\pi_{\mathcal{D}}}^{(L-1)}={\pi_{b}}
w_{\pi}
w_{{\pi_{\mathcal{D}}}^{(n)}}
n<L-1
v({\pi_{e}})
\Pr(h|{\pi_{b}})=\prod_{t=0}^{L-1}{\pi_{b}}(a_{t}|s_{t})
\frac{c(h)}{m}=\prod_{t=0}^{L-1}{\pi_{\mathcal{D}}}^{(0)}(a_{t}|s_{t})
w_{{\pi_{\mathcal{D}}}^{(n)}}
n<L-1
w_{\pi_{b}}
{\pi_{\mathcal{D}}}^{(n)}
\mathcal{D}
{\pi_{b}}
\operatorname{RIS}(0)
\operatorname{OIS}
\operatorname{RIS}(n)
\operatorname{OIS}
n
\operatorname{RIS}
\operatorname{OIS}
\mathcal{D}
{\pi_{b}}
\mathcal{D}
\operatorname{RIS}(L-1)
\operatorname{RIS}(L-1)
\operatorname{RIS}
n
\operatorname{RIS}(n)
{\pi_{b}}\in\Pi^{n}
n
{\pi_{b}}\in\Pi^{n}
\operatorname{RIS}
\operatorname{OIS}
o(n)
o_{p}(1)
\operatorname{RIS}
\operatorname{REG}
\operatorname{OIS}
\operatorname{REG}
\operatorname{RIS}(L-1)
\operatorname{REG}
\operatorname{REG}
\operatorname{RIS}(L-1)
{\pi_{\mathcal{D}}}
\mathcal{D}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
{\pi_{\mathcal{D}}}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
v({\pi_{e}})
\operatorname{RIS}
{\pi_{\mathcal{D}}}
{\pi_{b}}
{\pi_{\mathcal{D}}}
\mathcal{D}
\operatorname{RIS}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
\mathcal{D}
{\pi_{\mathcal{D}}}
\mathcal{D}
\operatorname{RIS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{RIS}
\mathcal{D}
n
{\operatorname{MSE}}
\operatorname{RIS}(n)
{\pi_{\mathcal{D}}}
4\times 4
\operatorname{RIS}
{\pi_{b}}
\operatorname{RIS}
\operatorname{RIS}(L-1)
\operatorname{REG}
\operatorname{RIS}
{\pi_{b}}
x
y
{\pi_{\mathcal{D}}}
2
64
\tanh
{\pi_{e}}
{\pi_{b}}
s_{0}
s_{1}
s_{5}
5
2
L=5
0
n
n+1
n
a_{1}
0.5
5
2
L=5
0
n
n+1
n
a_{1}
0.5
\operatorname{RIS}
\operatorname{RIS}(0)
\operatorname{RIS}
\operatorname{OIS}
{\operatorname{MSE}}
100
\operatorname{RIS}
\operatorname{OIS}
{\pi_{\mathcal{D}}}
\mathcal{D}
{\pi_{\mathcal{D}}}
\mathcal{D}
\mathcal{D}_{\mathtt{train}}
\mathcal{D}_{\mathtt{train}}
\mathcal{D}
(s,a)
\mathcal{D}
\mathcal{D}_{\mathtt{train}}
\mathcal{D}_{\mathtt{train}}
\mathcal{D}
{\pi_{b}}
\mathcal{D}
{\pi_{b}}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{OIS}
\operatorname{OIS}
{\pi_{b}}
\mathcal{D}
{\pi_{\mathcal{D}}}
\mathcal{D}
\mathcal{D}
\operatorname{OIS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{RIS}
\operatorname{OIS}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
\operatorname{OIS}
\mathcal{D}
\operatorname{RIS}
\operatorname{OIS}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
\operatorname{OIS}
\mathcal{D}
n
\operatorname{REG}
\operatorname{RIS}(4)
1\times 10^{-31}
n
\operatorname{REG}
\operatorname{RIS}(4)
1\times 10^{-31}
\operatorname{RIS}(n)
n
n
n
L
n
\operatorname{OIS}
\operatorname{RIS}
\operatorname{REG}
\operatorname{RIS}
n=0,3,4
200
n
\operatorname{REG}
\operatorname{REG}
\operatorname{RIS}(4)
\operatorname{RIS}(3)
\operatorname{REG}
\operatorname{RIS}(4)
\operatorname{RIS}(0)
\operatorname{OIS}
\operatorname{RIS}
\operatorname{REG}
\operatorname{OIS}
RIS(L-1)
\operatorname{REG}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
\operatorname{OIS}
200
\operatorname{IS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{IS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{RIS}
\operatorname{RIS}
\operatorname{IS}
{\pi_{\mathcal{D}}}
\operatorname{OIS}
\operatorname{OIS}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
400
\operatorname{RIS}
\operatorname{IS}
200
\operatorname{RIS}
\operatorname{RIS}
\operatorname{RIS}
\operatorname{OIS}
\approx 25
\operatorname{OIS}
\operatorname{OIS}
{\pi_{\mathcal{D}}}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
{\operatorname{MSE}}
{\operatorname{MSE}}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
{\operatorname{MSE}}
{\operatorname{MSE}}
\operatorname{RIS}
\operatorname{OIS}
{\pi_{\mathcal{D}}}
{\pi_{\mathcal{D}}}
{\operatorname{MSE}}
\operatorname{RIS}
\operatorname{RIS}
v({\pi_{e}})
{\pi_{\mathcal{D}}}
\operatorname{RIS}
\mathcal{D}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
v({\pi_{e}})
\operatorname{RIS}
\operatorname{RIS}
{\operatorname{MSE}}
{\operatorname{MSE}}
\operatorname{RIS}
\operatorname{OIS}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
\operatorname{RIS}
\operatorname{REG}
\operatorname{REG}
\operatorname{RIS}
\operatorname{REG}
\operatorname{RIS}
\operatorname{RIS}
\operatorname{REG}
\operatorname{REG}
{\operatorname{MSE}}
\operatorname{REG}
\operatorname{REG}
{\pi_{\mathcal{D}}}
\operatorname{IS}
\operatorname{RIS}
{\pi_{b}}
\operatorname{IS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
n
\operatorname{RIS}(n)
\operatorname{OIS}
{\pi_{\mathcal{D}}}
\operatorname{REG}
\operatorname{RIS}
n
L
{\pi_{b}}\in\Pi
{\pi_{b}}\not\in\Pi
\operatorname{RIS}
{\pi_{b}}
\mathcal{D}
\operatorname{RIS}
\operatorname{RIS}
\operatorname{RIS}
v({\pi_{e}})
\operatorname{RIS}
\widehat{{\mathcal{L}}}(\pi|{\mathcal{D}})
{\mathcal{L}}(\pi)
{\pi_{b}}
{\pi_{b}}
\pi
\widehat{{\mathcal{L}}}(\pi|{\mathcal{D}})
{\mathcal{L}}(\pi)
{\pi_{\mathcal{D}}}=\displaystyle\operatorname*{\arg\!\max}_{\pi}\widehat{{%
\mathcal{L}}}(\pi|{\mathcal{D}})
{\pi_{b}}
\operatorname{RIS}
\operatorname{OIS}
v({\pi_{e}})
\Pi
\operatorname{RIS}
\Pi
\hat{v}(\pi)
v(\pi)
\hat{v}(\pi)
v(\pi)
{\mathcal{L}}(\pi)
\widehat{{\mathcal{L}}}(\pi|{\mathcal{D}})
v(\pi)
\hat{v}(\pi)
(\Omega,\mathcal{F},\mu)
D_{m}:\Omega\rightarrow\mathcal{D}
D_{m}(\omega)
m
\omega\in\Omega
d_{\pi_{b}}
{\pi_{b}}
{\mathcal{L}}(\pi)=\mathbf{E}\left[\log\pi(A|S)\middle|S\sim d_{\pi_{b}},A\sim%
{\pi_{b}}\right]
D_{m}(\omega)
\widehat{{\mathcal{L}}}(\pi|D_{m}(\omega))=\frac{1}{mL}\sum_{H\in D_{m}(\omega%
)}\sum_{t=0}^{L-1}\log\pi(A_{t}^{H}|S_{t}^{H}).
S_{t}^{H}
A_{t}^{H}
t
H
s,a
\log\pi(a|s)
\widehat{{\mathcal{L}}}(\pi|D_{m}(\omega))
{\mathcal{L}}(\pi)
\pi\in\Pi
\widehat{{\mathcal{L}}}(\pi|D_{m}(\omega))\xrightarrow{a.s.}{\mathcal{L}}(\pi)
{\pi_{b}}
\pi
\pi\in\Pi
\pi\in\Pi
{\pi_{b}}
\pi\in\Pi
{\pi_{b}}
{\mathcal{L}}
\widehat{{\mathcal{L}}}
f:M\rightarrow\mathbb{R}
(M,d)
K
\{M_{1},M_{2},...\}
f
K
\{(M_{i},d_{i})\}_{i=1}^{\infty}
\delta
(M,d)
X\subset M
\delta
(M,d)
\max_{y\in M}\min_{x\in X}d(x,y)\leq\delta
\Pi
d_{\Pi}
D_{m}(\omega)
\Pi
\Pi^{\mathcal{L}}\coloneqq\{\Pi^{\mathcal{L}}_{1},\Pi^{\mathcal{L}}_{2},...\}
\Pi^{\widehat{{\mathcal{L}}}}\coloneqq\{\Pi^{\widehat{{\mathcal{L}}}}_{1},\Pi^%
{\widehat{{\mathcal{L}}}}_{2},...\}
{\mathcal{L}}
\widehat{{\mathcal{L}}}(\cdot|D_{m}(\omega))
\Pi^{\mathcal{L}}
\Pi^{\widehat{{\mathcal{L}}}}
K
\widehat{K}
i\in\mathbb{N}_{>0}
\delta>0
\delta
\Pi^{\mathcal{L}}_{i}
\Pi^{\widehat{{\mathcal{L}}}}_{i}
{\pi_{b}}=\operatorname*{\arg\!\max}_{\pi\in\Pi}{\mathcal{L}}(\pi)
{\pi_{\mathcal{D}}}=\operatorname*{\arg\!\max}_{\pi\in\Pi}\widehat{{\mathcal{L%
}}}(\pi|D_{m}(\omega)).
D_{\mathtt{KL}})
{\pi_{b}}
{\pi_{\mathcal{D}}}
s
\delta_{\mathtt{KL}}(s)=D_{\mathtt{KL}}({\pi_{b}}(\cdot|s),{\pi_{\mathcal{D}}}%
(\cdot|s))
\mathbf{E}_{d_{\pi_{b}}}[\delta_{\mathtt{KL}}(s)]\xrightarrow{a.s.}0
\Delta(\pi,\omega)=|\widehat{{\mathcal{L}}}(\pi|D_{m}(\omega))-{\mathcal{L}}(%
\pi)|
\pi\in\Pi
\epsilon>0
\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in\Omega:\Delta(\pi,\omega)<%
\epsilon\}\right)=1.
\Pi
\pi\in\Pi
\epsilon>0
\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in\Omega:\forall\pi\in\Pi,\Delta%
(\pi,\omega)<\epsilon\}\right)=1.
C(\delta)
\delta
\Pi
\delta
C(\delta)
\delta
\pi\in C(\delta)
\delta>0
\epsilon>0
\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in\Omega:\forall\pi\in C(\delta)%
,\Delta(\pi,\omega)<\epsilon\}\right)=1.
\pi\not\in C(\delta)
\delta
\exists\pi^{\prime}\in\Pi_{i}^{\mathcal{L}},d(\pi,\pi^{\prime})\leq\delta
{\mathcal{L}}
\Pi^{\mathcal{L}}_{i}
|{\mathcal{L}}(\pi)-{\mathcal{L}}(\pi^{\prime})|\leq K\delta
|\widehat{{\mathcal{L}}}(\pi|D_{m}(\omega))-\widehat{{\mathcal{L}}}(\pi^{%
\prime}|D_{m}(\omega))|\leq\widehat{K}\delta
|\widehat{{\mathcal{L}}}(\pi|D_{m}(\omega))-{\mathcal{L}}(\pi)|\leq|\widehat{{%
\mathcal{L}}}(\pi|D_{m}(\omega))-{\mathcal{L}}(\pi^{\prime})|+K\delta\leq|%
\widehat{{\mathcal{L}}}(\pi^{\prime}|D_{m}(\omega))-{\mathcal{L}}(\pi^{\prime}%
)|+(\widehat{K}+K)\delta
\delta>0
\displaystyle\left(\forall\pi\in C(\delta),\Delta(\pi,\omega)\leq\epsilon%
\right)\rightarrow
\displaystyle\left(\forall\pi\in C(\delta),\Delta(\pi,\omega)\leq\epsilon%
\right)\rightarrow
\displaystyle\left(\forall\pi\in\Pi,\Delta(\pi,\omega)<\epsilon+(K+\widehat{K}%
)\delta\right).
\displaystyle\left(\forall\pi\in\Pi,\Delta(\pi,\omega)<\epsilon+(K+\widehat{K}%
)\delta\right).
\delta>0
\epsilon>0
\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in\Omega:\forall\pi\in\Pi,\Delta%
(\pi,\omega)<\epsilon+(K+\widehat{K})\delta\}\right)=1
\delta\coloneqq\epsilon/(K+\widehat{K})
\epsilon^{\prime}=2\epsilon
\epsilon^{\prime}>0
\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in\Omega:\forall\pi\in\Pi,\Delta%
(\pi,\omega)<\epsilon^{\prime}\}\right)=1
\forall\pi\in\Pi,\Delta(\pi,\omega)<\epsilon^{\prime}
\Delta({\pi_{b}},\omega)<\epsilon^{\prime}
\Delta({\pi_{\mathcal{D}}},\omega)<\epsilon^{\prime}
\Delta
\displaystyle{\mathcal{L}}({\pi_{\mathcal{D}}})\stackrel{{\scriptstyle(a)}}{{%
\leq}}{\mathcal{L}}({\pi_{b}})
\displaystyle{\mathcal{L}}({\pi_{\mathcal{D}}})\stackrel{{\scriptstyle(a)}}{{%
\leq}}
\displaystyle{\mathcal{L}}({\pi_{b}})
\displaystyle\stackrel{{\scriptstyle(b)}}{{<}}\widehat{{\mathcal{L}}}({\pi_{b}%
}|D_{m}(\omega))+\epsilon^{\prime}
\displaystyle\stackrel{{\scriptstyle(b)}}{{<}}
\displaystyle\widehat{{\mathcal{L}}}({\pi_{b}}|D_{m}(\omega))+\epsilon^{\prime}
\displaystyle\stackrel{{\scriptstyle(c)}}{{\leq}}\widehat{{\mathcal{L}}}({\pi_%
{\mathcal{D}}}|D_{m}(\omega))+\epsilon^{\prime}
\displaystyle\stackrel{{\scriptstyle(c)}}{{\leq}}
\displaystyle\widehat{{\mathcal{L}}}({\pi_{\mathcal{D}}}|D_{m}(\omega))+%
\epsilon^{\prime}
\displaystyle\stackrel{{\scriptstyle(d)}}{{\leq}}{\mathcal{L}}({\pi_{\mathcal{%
D}}})+2\epsilon^{\prime}
\displaystyle\stackrel{{\scriptstyle(d)}}{{\leq}}
\displaystyle{\mathcal{L}}({\pi_{\mathcal{D}}})+2\epsilon^{\prime}
{\pi_{b}}
{\mathcal{L}}
{\pi_{\mathcal{D}}}
\widehat{{\mathcal{L}}}(\cdot|D_{m}(\omega))
|{\mathcal{L}}({\pi_{\mathcal{D}}})-{\mathcal{L}}({\pi_{b}})|<2\epsilon^{\prime}
\forall\epsilon^{\prime}>0,\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in%
\Omega:|{\mathcal{L}}({\pi_{\mathcal{D}}})-{\mathcal{L}}({\pi_{b}})|<2\epsilon%
^{\prime}\}\right)=1
\epsilon^{\prime\prime}\coloneqq 2\epsilon^{\prime}
\forall\epsilon^{\prime\prime}>0,\Pr\left(\liminf_{m\rightarrow\infty}\{\omega%
\in\Omega:|{\mathcal{L}}({\pi_{\mathcal{D}}})-{\mathcal{L}}({\pi_{b}})|<%
\epsilon^{\prime\prime}\}\right)=1
{\mathcal{L}}({\pi_{\mathcal{D}}})-{\mathcal{L}}({\pi_{b}})=\mathbf{E}_{d_{\pi%
_{b}}}[\delta_{\mathtt{KL}}(s)]
\forall\epsilon>0,\Pr\left(\liminf_{n\rightarrow\infty}\{\omega\in\Omega:|-%
\mathbf{E}_{d_{\pi_{b}}}[\delta_{\mathtt{KL}}(s)]|<\epsilon\}\right)=1
\forall\epsilon>0,\Pr\left(\liminf_{m\rightarrow\infty}\{\omega\in\Omega:%
\mathbf{E}_{d_{\pi_{b}}}[\delta_{\mathtt{KL}}(s)]|<\epsilon\}\right)=1,
\mathbf{E}_{d_{\pi_{b}}}[\delta_{\mathtt{KL}}(s)]\xrightarrow{a.s.}0
\operatorname{RIS}(n)
v({\pi_{e}})
\operatorname{RIS}(n)({\pi_{e}},\mathcal{D})\xrightarrow{a.s.}v({\pi_{e}})
\operatorname{RIS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{OIS}
v({\pi_{e}})
\operatorname{RIS}
v({\pi_{e}})
\forall n
\operatorname{RIS}(n)
\Pi_{\boldsymbol{\theta}}^{n}
{\pi_{\boldsymbol{\theta}}}(\cdot|s_{t-n},a_{t-n},\dots,s_{t})
\exists\tilde{{\boldsymbol{\theta}}}
\pi_{\tilde{{\boldsymbol{\theta}}}}\in\Pi_{\boldsymbol{\theta}}^{n}
\pi_{\tilde{{\boldsymbol{\theta}}}}={\pi_{b}}
{\operatorname{Var}}_{A}({\operatorname{RIS}(n)({\pi_{e}},\mathcal{D})})\leq{%
\operatorname{Var}}_{A}({\operatorname{IS}({\pi_{e}},\mathcal{D},{\pi_{b}})})
{\operatorname{Var}}_{A}
n
\operatorname{OIS}
v={\mathbf{E}_{p}\left[f(x)\right]}
p
f
q(\cdot|\tilde{{\boldsymbol{\theta}}})
v
\tilde{v}=\frac{1}{m}\sum_{i=1}^{m}\frac{p(x_{i})}{q(x_{i},\tilde{{\boldsymbol%
{\theta}}})}f(x_{i})
\hat{v}=\frac{1}{m}\sum_{i=1}^{m}\frac{p(x_{i})}{q(x_{i},\hat{{\boldsymbol{%
\theta}}})}f(x_{i})
\hat{{\boldsymbol{\theta}}}
\tilde{{\boldsymbol{\theta}}}
m
q(\cdot|\tilde{{\boldsymbol{\theta}}})
\hat{v}
\tilde{v}
{\operatorname{Var}}_{A}({\hat{v}})\leq{\operatorname{Var}}_{A}(\tilde{v})
{\operatorname{Var}}_{A}
\tilde{{\boldsymbol{\theta}}}
\Pr(h;{\boldsymbol{\theta}})=p(h)w_{\boldsymbol{\theta}}(h)
p(h)=d_{0}(s_{0})\prod_{t=1}^{L-1}P(s_{t}|s_{t-1},a_{t-1})
w_{\boldsymbol{\theta}}(h)=\prod_{t=0}^{L-1}{\pi_{\boldsymbol{\theta}}}(a_{t}|%
s_{t-n},a_{t-n},\dots,s_{t})
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\sum_{t=0}^{L-1}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t-n},a_{t%
-n},\dots,s_{t})=\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\log\Pr(h;{\boldsymbol{\theta}})
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\sum_{t=0}^{L-1}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t-n},a_{t%
-n},\dots,s_{t})=\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\log\Pr(h;{\boldsymbol{\theta}})
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\sum_{t=0}^{L-1}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t-n},a_{t%
-n},\dots,s_{t})
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\sum_{t=0}^{L-1}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t-n},a_{t%
-n},\dots,s_{t})
\displaystyle=\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\sum_{t=0}^{L-1}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t-n},a_{t%
-n},\dots,s_{t})+\underbrace{\log d(s_{0})+\sum_{t=1}^{L-1}\log P(s_{t}|s_{t-1%
},a_{t-1})}_{\text{const w.r.t. ${\boldsymbol{\theta}}$}}
{\boldsymbol{\theta}}
\displaystyle=
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\sum_{t=0}^{L-1}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t-n},a_{t%
-n},\dots,s_{t})+\underbrace{\log d(s_{0})+\sum_{t=1}^{L-1}\log P(s_{t}|s_{t-1%
},a_{t-1})}_{\text{const w.r.t. ${\boldsymbol{\theta}}$}}
{\boldsymbol{\theta}}
\displaystyle=\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\log w_{\boldsymbol{\theta}}(h)+\log p(h)
\displaystyle=
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\log w_{\boldsymbol{\theta}}(h)+\log p(h)
\displaystyle{\boldsymbol{\theta}}=\operatorname*{\arg\!\max}_{\boldsymbol{%
\theta}}\sum_{h\in\mathcal{D}}\log\Pr(h;\theta)
\displaystyle{\boldsymbol{\theta}}=
\displaystyle\operatorname*{\arg\!\max}_{\boldsymbol{\theta}}\sum_{h\in%
\mathcal{D}}\log\Pr(h;\theta)
\Pi_{\boldsymbol{\theta}}^{n}
{\pi_{\boldsymbol{\theta}}}(\cdot|s_{t-n},a_{t-n},\dots,s_{t})
{\boldsymbol{\theta}}
\exists{\boldsymbol{\theta}}\in\Pi_{\boldsymbol{\theta}}^{n}
{\pi_{\boldsymbol{\theta}}}={\pi_{b}}
{\operatorname{Var}}_{A}({\operatorname{RIS}(n)({\pi_{e}},\mathcal{D})})\leq{%
\operatorname{Var}}_{A}({\operatorname{IS}({\pi_{e}},\mathcal{D},{\pi_{b}})})
{\operatorname{Var}}_{A}
f(h)=g(h)
p(h)=\Pr(h|{\pi_{e}})
q(h|{\boldsymbol{\theta}})=\Pr(h|{\pi_{\boldsymbol{\theta}}})
\displaystyle\hat{{\boldsymbol{\theta}}}=\operatorname*{\arg\!\max}_{{%
\boldsymbol{\theta}}\in\Pi_{\boldsymbol{\theta}}}\sum_{h\in\mathcal{D}}\sum_{t%
=0}^{L}\log{\pi_{\boldsymbol{\theta}}}(a_{t}|s_{t})
\tilde{{\boldsymbol{\theta}}}
\pi_{\tilde{{\boldsymbol{\theta}}}}={\pi_{b}}
\Pr(h|\tilde{{\boldsymbol{\theta}}})
h
{\pi_{b}}
n>0
\pi_{\tilde{{\boldsymbol{\theta}}}}\in\Pi^{n}
A_{t}\sim\pi_{\tilde{{\boldsymbol{\theta}}}}
A_{t}\sim{\pi_{b}}
s_{t}
\exists{\pi_{\boldsymbol{\theta}}}\in\Pi^{n}
\forall s_{t-n},a_{t-n},\dots a_{t-1}
\pi_{\tilde{{\boldsymbol{\theta}}}}(a_{t}|s_{t})={\pi_{\boldsymbol{\theta}}}(a%
_{t}|s_{t-n},a_{t-n},\dots,s_{t}),
s_{t}
\operatorname{RIS}(L-1)
\operatorname{REG}
\operatorname{REG}
RIS(L-1)
\displaystyle\Pr(h|\pi)=d_{0}(s_{0})\pi(a_{0}|s_{0})P(s_{1}|s_{0},a_{0})\cdots
P%
(s_{L-1}|s_{L-2},a_{L-2})\pi(a_{L-1}|s_{L-1}).
\mathcal{H}
{\pi_{b}}
L
s_{0},a_{0},...s_{L-1},a_{L-1}
\hat{r}(a,\mathcal{D})
\mathtt{REG}({\pi_{e}},\mathcal{D})=\sum_{a\in\mathcal{A}}{\pi_{e}}(a)\hat{r}(%
a,\mathcal{D}).
\hat{g}(h,\mathcal{D})
\mathtt{REG}({\pi_{e}},\mathcal{D})=\sum_{h\in\mathcal{H}}\Pr(h|{\pi_{e}})\hat%
{g}(h,\mathcal{D}).
\Pr(h|{\pi_{e}})
d_{0}
P
\operatorname{RIS}(L-1)
c(h)
h
\mathcal{D}
\operatorname{REG}
\displaystyle\mathtt{REG}({\pi_{e}},\mathcal{D})=\sum_{h\in\mathcal{H}}\Pr(h|{%
\pi_{e}})\hat{g}(h,\mathcal{D})
\displaystyle\mathtt{REG}({\pi_{e}},\mathcal{D})=
\displaystyle\sum_{h\in\mathcal{H}}\Pr(h|{\pi_{e}})\hat{g}(h,\mathcal{D})
\displaystyle=\frac{1}{m}\sum_{h\in\mathcal{H}}c(h)\frac{\Pr(h|{\pi_{e}})}{c(h%
)/m}\hat{g}(h,\mathcal{D})
\displaystyle=
\displaystyle\frac{1}{m}\sum_{h\in\mathcal{H}}c(h)\frac{\Pr(h|{\pi_{e}})}{c(h)%
/m}\hat{g}(h,\mathcal{D})
\displaystyle=\frac{1}{m}\sum_{i=1}^{m}\frac{\Pr(h_{i}|{\pi_{e}})}{c(h_{i})/m}%
g(h_{i})
\displaystyle=
\displaystyle\frac{1}{m}\sum_{i=1}^{m}\frac{\Pr(h_{i}|{\pi_{e}})}{c(h_{i})/m}g%
(h_{i})
L-1
\displaystyle\mathtt{REG}({\pi_{e}},\mathcal{D})=\frac{1}{m}\sum_{i=1}^{m}%
\frac{\Pr(h_{i}|{\pi_{e}})}{c(h_{i})/m}g(h_{i})
\displaystyle\mathtt{REG}({\pi_{e}},\mathcal{D})=
\displaystyle\frac{1}{m}\sum_{i=1}^{m}\frac{\Pr(h_{i}|{\pi_{e}})}{c(h_{i})/m}g%
(h_{i})
\displaystyle=\frac{1}{m}\sum_{i=1}^{m}\frac{\Pr(h_{i}|{\pi_{e}})}{\frac{c(s_{%
0})}{m}\frac{c(s_{0},a_{0})}{c(s_{0})}\cdots\frac{c(h_{i})}{c(h_{i}/a_{L-1})}}%
g(h_{i})
\displaystyle=
\displaystyle\frac{1}{m}\sum_{i=1}^{m}\frac{\Pr(h_{i}|{\pi_{e}})}{\frac{c(s_{0%
})}{m}\frac{c(s_{0},a_{0})}{c(s_{0})}\cdots\frac{c(h_{i})}{c(h_{i}/a_{L-1})}}g%
(h_{i})
\displaystyle=\frac{1}{m}\sum_{i=1}^{m}\frac{d_{0}(s_{0}){\pi_{e}}(a_{0}|s_{0}%
)P(s_{1}|s_{0},a_{0})\cdots P(s_{L-1}|s_{L-2},a_{L-2}){\pi_{e}}(a_{L-1}|s_{L-1%
})}{\hat{d}(s_{0}){\pi_{\mathcal{D}}}(a_{0}|s_{0})\hat{P}(s_{1}|s_{0},a_{0})%
\cdots\hat{P}(s_{L-1}|h_{0:L-1}){\pi_{\mathcal{D}}}(a_{L-1}|h_{i:j})}g(h_{i}).
\displaystyle=
\displaystyle\frac{1}{m}\sum_{i=1}^{m}\frac{d_{0}(s_{0}){\pi_{e}}(a_{0}|s_{0})%
P(s_{1}|s_{0},a_{0})\cdots P(s_{L-1}|s_{L-2},a_{L-2}){\pi_{e}}(a_{L-1}|s_{L-1}%
)}{\hat{d}(s_{0}){\pi_{\mathcal{D}}}(a_{0}|s_{0})\hat{P}(s_{1}|s_{0},a_{0})%
\cdots\hat{P}(s_{L-1}|h_{0:L-1}){\pi_{\mathcal{D}}}(a_{L-1}|h_{i:j})}g(h_{i}).
L-1
L-1
L-1
\operatorname{RIS}(L-1)
L-1
{\operatorname{MSE}}
\operatorname{REG}
{\operatorname{MSE}}
\operatorname{RIS}(L-1)
\operatorname{RIS}
n
{\operatorname{MSE}}
\operatorname{RIS}
n
\operatorname{RIS}
\operatorname{REG}
\operatorname{RIS}
\operatorname{REG}
\operatorname{RIS}
\mathcal{D}
R:\mathcal{A}\rightarrow\mathbb{R}
L=1
{\pi_{b}}
{\pi_{e}}
[0,1]
v({\pi_{e}})=\int_{0}^{1}R(a){\pi_{e}}(a)da
m
{\pi_{b}}
\frac{1}{m}\sum_{i=1}^{m}\frac{{\pi_{e}}(a_{i})}{{\pi_{b}}(a_{i})}R(a_{i}).
\operatorname{OIS}
a_{i}
a_{0}<=a_{i}<=a_{m}
R(a_{i})
[0,1]
[0,1]
m
\bar{R}_{\operatorname{OIS}}
\bar{R}_{\operatorname{OIS}}(a)=R(a_{i})
a
i^{\text{th}}
\int_{0}^{1}\bar{R}_{\operatorname{OIS}}(a)da
R
\pi
[0,1]
0.25
\pi
0.5
\pi
0.5
\bar{R}^{\star}
R
\pi
[0.5,1]
0.75
R
[0.25,1]
\bar{R}^{\star}
\bar{R}_{\operatorname{OIS}}
\bar{R}_{\operatorname{RIS}}
\bar{R}^{\star}
10
200
R
\pi
[0,1]
0.25
\pi
0.5
\pi
0.5
\bar{R}^{\star}
R
\pi
[0.5,1]
0.75
R
[0.25,1]
\bar{R}^{\star}
\bar{R}_{\operatorname{OIS}}
\bar{R}_{\operatorname{RIS}}
\bar{R}^{\star}
10
200
\bar{R}_{\operatorname{OIS}}(a)
R(a){\pi_{e}}(a)
\displaystyle\lim_{m\rightarrow\infty}\bar{R}_{\operatorname{OIS}}(a)=R(a){\pi%
_{e}}(a)
\bar{R}_{\operatorname{OIS}}
R
{\pi_{e}}
R
\bar{R}^{\star}
\int_{0}^{1}\bar{R}^{\star}(a)da
v({\pi_{e}})
\bar{R}^{\star}
{\pi_{e}}
R
\bar{R}^{\star}
\operatorname{OIS}
\bar{R}
\bar{R}_{\operatorname{OIS}}
R
R
[a,b]
0.5
\bar{R}^{\star}
R
[a,b]
[0,1]
\bar{R}_{\operatorname{OIS}}
\operatorname{OIS}
\bar{R}^{\star}
10
200
R
{\pi_{e}}
\operatorname{OIS}
\operatorname{RIS}
R
\bar{R}_{\operatorname{RIS}}
\bar{R}^{\star}
10
200
\bar{R}_{\operatorname{RIS}}
\bar{R}^{\star}
\bar{R}_{\operatorname{OIS}}
\operatorname{RIS}
\operatorname{OIS}
R
{\operatorname{MSE}}
\operatorname{OIS}
R
L=5
{\pi_{b}}
a_{0}
p=0.6
{\pi_{e}}
a_{0}
1-p=0.4
a_{0}
a_{1}
0.5
1
a_{0}
0
{\pi_{b}}
P
s_{0}
s_{1}
s_{5}
a_{1}
0.5
a_{1}
0.5
4\times 4
100
(3,3)
-10
(1,1)
1
(1,3)
-1
(0,0)
\gamma=1
L=100
1
\theta_{sa}
s
a
a
s
\pi(a|s)=\frac{e^{\theta_{sa}}}{\sum_{a^{\prime}\in\mathcal{A}}e^{\theta_{sa^{%
\prime}}}}
{\pi_{b}}
{\pi_{e}}
\operatorname{RIS}
\operatorname{RIS}
x
y
x
y
L=20
\mathbf{s}_{t}
\mathbf{a}_{t}
\mathbf{s}_{t+1}=A\cdot\mathbf{s}_{t}+B\cdot\mathbf{a}_{t}+\mathbf{\epsilon}_{t}
\mathbf{\epsilon}_{t}\sim\mathcal{N}(0,I)
A
B=\begin{bmatrix}0.5&0\\
0&0.5\\
1&0\\
0&1\end{bmatrix}.
{\pi_{\mathcal{D}}}
0.5
{\pi_{b}}
0.6
2
64
{\pi_{e}}
{\pi_{b}}
{\pi_{e}}
{\pi_{b}}
30
{\pi_{e}}
20
{\pi_{b}}
\tanh
\operatorname{RIS}
\mu(s)
\sigma
m
\operatorname{RIS}
{\mathcal{L}}=\sum_{i=1}^{m}0.5((a_{i}-\mu(s_{i}))/e^{\sigma})^{2}+\sigma
{\mathcal{L}}
\mu
1\times 10^{-3}
0.02
\operatorname{RIS}
{\pi_{\mathcal{D}}}
0
1
2
3
64
400
{\pi_{\mathcal{D}}}
80
\operatorname{OIS}
\operatorname{RIS}
\operatorname{WIS}
\operatorname{PDIS}
\operatorname{DR}
P
r
\operatorname{PDIS}
\operatorname{WDR}
\operatorname{DR}
\operatorname{WDR}
\mathcal{D}
5
\operatorname{IS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{PDIS}
\operatorname{WIS}
\operatorname{IS}
\operatorname{WDR}
\operatorname{DR}
\operatorname{OIS}
\operatorname{RIS}
\operatorname{IS}
\operatorname{WIS}
\operatorname{WDR}
\operatorname{RIS}
\operatorname{DR}
\operatorname{PDIS}
\operatorname{RIS}
\operatorname{OIS}
\operatorname{RIS}
\operatorname{WIS}
\operatorname{OIS}
\operatorname{WIS}
100
\operatorname{RIS}
\operatorname{OIS}
\operatorname{RIS}
\operatorname{WIS}
\operatorname{OIS}
\operatorname{WIS}
100
{\operatorname{MSE}}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
{\operatorname{MSE}}
\operatorname{RIS}
{\pi_{\mathcal{D}}}
\operatorname{RIS}
200
{\pi_{\mathcal{D}}}
\operatorname{RIS}
200
