p\left(\theta|x\right)
\theta
x
p\left(x|\theta\right)
x
\theta
\{\left(\theta_{i},x_{i}\right)\}_{i=1}^{N}
p\left(\theta\right)
\hat{p}\left(\theta|x\right)
\theta
x
p\left(\theta|x\right)
p\left(\theta\right)
p\left(\theta|x\right)
p\left(\theta|x\right)
\hat{p}\left(\theta|x\right)
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
1-\alpha
1-\alpha
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right):=%
\operatorname*{arg\,min}_{\Theta}|\Theta|~{}~{}\text{s.t.}~{}~{}\int_{\theta%
\in\Theta}\hat{p}\left(\theta|x\right)\mathrm{d}\theta=1-\alpha,
|\Theta|:=\int_{\Theta}\mathrm{d}\mu
\Theta
\mu
p(\theta,x)
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
\textrm{ECP}\left(\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1%
-\alpha\right)\right):=\mathbb{E}_{p(\theta,x)}\left[\mathds{1}\left[\theta\in%
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)%
\right]\right],
\mathds{1}\left[\cdot\right]
p\left(\theta,x\right)
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
(\theta^{*},x^{*})
\hat{p}\left(\theta|x\right)
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha_{\textrm{%
HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)\right):=\{\theta\mid\hat{p}(\theta%
|x^{*})\geqslant\hat{p}(\theta^{*}|x^{*})\},
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right):=\int\hat{p}\left(%
\theta|x\right)\mathds{1}\left[\hat{p}(\theta|x^{*})<\hat{p}(\theta^{*}|x^{*})%
\right]\textrm{d}\theta.
1-\alpha_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)=\int_{\Theta_{%
\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha_{\textrm{HPDR}}%
\left(\hat{p},\theta^{*},x^{*}\right)\right)}\hat{p}(\theta|x)d\theta=\\
\int_{\{\theta\mid\hat{p}(\theta|x^{*})\geqslant\hat{p}(\theta^{*}|x^{*})\}}%
\hat{p}\left(\theta|x\right)\textrm{d}\theta=\\
\int\hat{p}\left(\theta|x\right)\mathds{1}\left[\hat{p}(\theta|x^{*})\geqslant%
\hat{p}(\theta^{*}|x^{*})\right]\textrm{d}\theta,
\int\hat{p}\left(\theta|x\right)\mathds{1}\left[\hat{p}(\theta|x^{*})\geqslant%
\hat{p}(\theta^{*}|x^{*})\right]+\int\hat{p}\left(\theta|x\right)\mathds{1}%
\left[\hat{p}(\theta|x^{*})<\hat{p}(\theta^{*}|x^{*})\right]=1
\hat{p}\left(\theta|x\right)
\textrm{ECP}\left(\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1%
-\alpha\right)\right)=\mathbb{E}_{p(\theta,x)}\left[\mathds{1}\left[\alpha_{%
\textrm{HPDR}}\left(\hat{p},\theta,x\right)\geqslant\alpha\right]\right]
\textrm{ECP}\left(\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1%
-\alpha\right)\right)
1-\alpha
1-\alpha
\alpha
p\left(\theta|x\right)
p\left(\theta\right)
p^{*}\left(\theta|x\right):=\operatorname*{arg\,max}_{\hat{p}\left(\theta|x%
\right)}\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x%
\right)\right]~{}~{}\text{s.t.}~{}~{}\forall\alpha\,\textrm{ECP}\left(\Theta_{%
\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)\right)=1-\alpha
\textrm{ECP}\left(\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1%
-\alpha\right)\right)
1-\alpha
\frac{1}{M}\sum_{i=1}^{M}\lvert(1-\alpha_{i})-\textrm{ECP}\left(\Theta_{\hat{p%
}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha_{i}\right)\right)\rvert,
\frac{1}{M}\sum_{i=1}^{M}\max\left((1-\alpha_{i})-\textrm{ECP}\left(\Theta_{%
\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha_{i}\right)\right),%
0\right),
\{\alpha_{i}\}_{i=1}^{M}
\forall_{i}\,0<\alpha_{i}<1
\alpha=0
\alpha=1
p\left(\theta,x\right)
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta,x\right)
(0,1)
\hat{\alpha}^{L}_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right):=\frac{1%
}{L}\sum_{j=1}^{L}\mathds{1}\left[\hat{p}(\theta_{j}|x^{*})<\hat{p}(\theta^{*}%
|x^{*})\right],
\theta_{1},...,\theta_{L}
\hat{p}\left(\theta|x\right)
1/L
[0,L]
\hat{p}\left(\theta|x\right)=p\left(\theta|x\right)\ \forall(\theta,x)\sim p%
\left(\theta,x\right)
L\rightarrow\infty
\hat{\alpha}^{\infty}_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta,x\right)
\mathbb{E}_{p(\theta,x)}\left[\mathds{1}\left[1-\alpha_{\textrm{HPDR}}\left(%
\hat{p},\theta,x\right)\leqslant 1-\alpha\right]\right]
\frac{1}{N}\sum_{i=1}^{N}\mathds{1}\left[1-\alpha_{\textrm{HPDR}}\left(\hat{p}%
,\theta_{i},x_{i}\right)\leqslant 1-\alpha\right],
1-\alpha
1-\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)
1-\alpha
1-\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)
[0,1]
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)
B
\beta\in\mathcal{B}
\hat{\mathcal{B}}=\{\beta_{i}|i=1,\dots,N\}
B
D_{N}=\sup_{\beta\in\mathcal{B}}|F_{N}(\beta)-F(\beta)|,
F_{N}
B
\hat{\mathcal{B}}
F
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta,x\right)
{(\theta,x)\sim p(\theta,x)}
F_{N}
{\hat{\mathcal{A}}:=\{\hat{\alpha}^{L}_{\textrm{HPDR}}\left(\hat{p},\theta_{i}%
,x_{i}\right)|(x_{i},\theta_{i})\sim p(x,\theta),i=1,\dots,N\}}
F
\hat{\mathcal{A}}
D_{N}\rightarrow 0
N\rightarrow\infty
F
D_{N}\rightarrow 0
F
D_{N}
D_{N}
F_{N}(\alpha)
F(\alpha)
F_{N}(\alpha)=\sum_{i}\mathds{1}\left[\alpha_{i}\leq\alpha\right]/N
\alpha_{i}\in\hat{\mathcal{A}}
F(\alpha)=\alpha
D_{N}
\alpha_{k}
\sum_{k}(F_{N}(\alpha_{k})-\alpha_{k})^{2}
F_{N}(\alpha_{k})
\alpha_{k}
\hat{\mathcal{A}}
\left(\alpha_{i}|i:=1\dots N\right)
\alpha_{i}
i
F_{N}(\alpha_{i})
i/N
F(\alpha_{i})=\alpha_{i}
\sum_{i}(i/N-\alpha_{i})^{2}
F(\alpha_{i})
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)
\hat{\alpha}^{L}_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)
\theta_{j}
\hat{p}\left(\theta|x\right)
\hat{\alpha}^{L}_{\textrm{HPDR}}\left(\hat{p},\theta,x\right)
\hat{\alpha}^{L,IS}_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)=\frac%
{\sum_{j=1}^{L}\hat{p}(\theta_{j}|x^{*})/I(\theta_{j})\mathds{1}\left[\hat{p}(%
\theta_{j}|x^{*})<\hat{p}(\theta^{*}|x^{*})\right]}{\sum_{j=1}^{L}\hat{p}(%
\theta_{j}|x^{*})/I(\theta_{j})}.
\theta_{j}
I(\theta)
I(\theta_{j})
\frac{1}{N}\sum_{i}^{N}\log\hat{p}(\theta_{i}|x_{i})+\lambda\frac{1}{N}\sum_{i%
}^{N}\left(\operatorname{index}\left(\hat{\alpha}^{L,IS}_{\textrm{HPDR}}\left(%
\hat{p},\theta_{i},x_{i}\right)\right)/N-\hat{\alpha}^{L,IS}_{\textrm{HPDR}}%
\left(\hat{p},\theta_{i},x_{i}\right)\right)^{2},
\operatorname{index}(\cdot)
\{\hat{\alpha}^{L,IS}_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)\mid
i%
=1,\dots,N\}
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta^{*},x^{*}\right)
\max(\cdot;0)
L
\lambda
\{\left(\theta_{i},x_{i}\right)\}_{i=1}^{N}
\hat{p}\left(\theta|x\right)
L
I(\theta)
R
i\leftarrow 1
N
p_{i}\leftarrow\hat{p}(\theta_{i}|x_{i})
j\leftarrow 1
L
\theta_{i}^{j}\sim I(\theta)
p_{i}^{j}\leftarrow\hat{p}(\theta_{i}^{j}|x_{i})
\hat{\alpha}^{L,IS}_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)%
\leftarrow\frac{\sum_{j=1}^{L}p_{i}^{j}/I(\theta_{i}^{j})\mathds{1}\left[p_{i}%
^{j}<p_{i}\right]}{\sum_{j=1}^{L}p_{i}^{j}/I(\theta_{i}^{j})}
\left(\alpha_{i}|i=1,\ldots,N\right)\leftarrow\operatorname{sort}(\{\hat{%
\alpha}^{L,IS}_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)|i=1,\ldots%
,N\})
R\leftarrow\frac{1}{N}\sum_{i}^{N}\left(i/N-\alpha_{i}\right)^{2}
p\left(\theta\right)
\lambda
5
L
16
\hat{p}\left(\theta|x\right)
[0.05;0.95]
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
\hat{p}\left(\theta|x\right)
[0.05;0.95]
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
[0.05;0.95]
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
\lambda
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\lambda
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
L
\mathcal{O}\left(N\textrm{dim}(\theta)L\right)
N
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
L
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\lambda
\lambda=5
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\lambda
\lambda
L
L
\lambda
L
\lambda
L
\mathcal{U}[0,1]
D_{N}=\sup_{\alpha}|\max(F_{N}(\alpha)-F(\alpha),0)|,
F_{N}(\alpha)
\{\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)\}_{i}^{N}
F(\alpha)
D_{N}=0
\forall_{\alpha}\,\alpha\geqslant\sum_{j=1}^{N}\mathds{1}\left[\alpha_{\textrm%
{HPDR}}\left(\hat{p},\theta_{j},x_{j}\right)\leqslant\alpha\right]/N.
N\rightarrow\infty
\forall_{\alpha}\,\sum_{j=1}^{N}\mathds{1}\left[\alpha_{\textrm{HPDR}}\left(p,%
\theta_{j},x_{j}\right)\leqslant\alpha\right]\geqslant\sum_{j=1}^{N}\mathds{1}%
\left[\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{j},x_{j}\right)\leqslant%
\alpha\right].
\hat{p}\left(\theta|x\right)
\forall_{\alpha}\,\exists_{j}\,\alpha_{\textrm{HPDR}}\left(p,\theta_{j},x_{j}%
\right)\leqslant\alpha~{}\&~{}\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{j},x%
_{j}\right)>\alpha,
\forall_{\alpha}\,\exists_{j}\,\alpha_{\textrm{HPDR}}\left(p,\theta_{j},x_{j}%
\right)<\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{j},x_{j}\right).
\alpha_{\textrm{HPDR}}\left(\cdot,\theta_{j},x_{j}\right)
\forall_{\alpha}\,\exists_{j}\,\sum_{k=1}^{L}\mathds{1}\left[\hat{p}(\theta^{*%
}_{(j)k}|x_{j})<\hat{p}(\theta_{j}|x_{j})\right]<\sum_{k=1}^{L}\mathds{1}\left%
[\hat{p}(\theta_{(j)k}|x_{j})<\hat{p}(\theta_{j}|x_{j})\right],
\theta^{*}_{(j)k}
p\left(\theta|x\right)
\theta_{(j)k}
\hat{p}\left(\theta|x\right)
\forall_{\alpha}\,\exists_{j}\,\exists_{k}\,\hat{p}(\theta^{*}_{(j)k}|x_{j})%
\geqslant\hat{p}(\theta_{j}|x_{j})~{}\&~{}\hat{p}(\theta_{(j)k}|x_{j})<\hat{p}%
(\theta_{j}|x_{j}),
\forall_{\alpha}\,\exists_{j}\,\exists_{k}\,\hat{p}(\theta^{*}_{(j)k}|x_{j})>%
\hat{p}(\theta_{(j)k}|x_{j}).
\hat{p}\left(\theta|x\right)
\alpha_{\textrm{HPDR}}\left(\hat{p},\theta_{i},x_{i}\right)
L+1
[0,1]
F_{L}(x)=\begin{cases}0,&x<0\\
\lfloor xL\rfloor/L,&0\leqslant x<1\\
1,&x\geqslant 1\end{cases}
F(x)=\begin{cases}0,&x<0\\
x,&0\leqslant x<1\\
1,&x\geqslant 1\end{cases}
0\leqslant x<1
\left|F(x)-F_{L}(x)\right|=\left|x-\lfloor xL\rfloor/L\right|=\left|xL-\lfloor
xL%
\rfloor\right|/L<1/L,
\lfloor\cdot\rfloor
L\rightarrow\infty
\lim_{L\rightarrow\infty}\left|F(x)-F_{L}(x)\right|=\lim_{L\rightarrow\infty}1%
/L=0,
F_{L}(x)
F(x)
\alpha_{1},\ldots,\alpha_{N}
G
0
D_{N}=\sup_{\alpha}|F_{N}(\alpha)-F(\alpha)|\overset{a.s.}{\to}0.
D_{N}=\sup_{\alpha}|F_{N}(\alpha)-G(\alpha)|\overset{a.s.}{\to}0.
\sup_{\alpha}|F_{N}(\alpha)-F(\alpha)|+\sup_{\alpha}|F_{N}(\alpha)-G(\alpha)|>%
\sup_{\alpha}|G(\alpha)-F(\alpha)|,
\sup_{\alpha}|G(\alpha)-F(\alpha)|\overset{a.s.}{\to}0,
N
G=F
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\hat{p}\left(\theta|x\right)
[0.05;0.95]
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
\hat{p}\left(\theta|x\right)
[0.05;0.95]
\Theta_{\hat{p}\left(\theta|x\right)}^{\textrm{HPDR}}\left(1-\alpha\right)
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
1-\alpha=0.9
N=1000
\sigma_{1}=0.7
\sigma_{2}=0.2
\sigma_{1}=0.9
\sigma_{2}=0.4
N=1000
\sigma_{1}=0.7
\sigma_{2}=0.2
\sigma_{1}=0.9
\sigma_{2}=0.4
N=1000
500
128
0.001
\mathbb{E}_{p\left(\theta,x\right)}\left[\log\hat{p}\left(\theta|x\right)\right]
\hat{p}(\cdot|x^{*})
x^{*}
