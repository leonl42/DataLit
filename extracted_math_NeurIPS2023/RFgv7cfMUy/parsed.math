\times
\times
\sim 60
t_{i}
t_{i}
A
B
BA
W
BA
W
X
d
d
BA
r
d
r
r\ll d
\times
\times
L
\boldsymbol{X}\in\mathbb{R}^{n\times d}
\boldsymbol{Q}^{(i)}=\boldsymbol{X}\boldsymbol{W}^{(i)}_{Q},\boldsymbol{K}^{(i%
)}=\boldsymbol{X}\boldsymbol{W}^{(i)}_{K},\boldsymbol{V}^{(i)}=\boldsymbol{X}%
\boldsymbol{W}^{(i)}_{V}
\boldsymbol{H}^{(i)}=[\mathrm{Softmax}(\boldsymbol{Q}^{(i)}\boldsymbol{K}^{(i)%
T}/\sqrt{d_{h}})\boldsymbol{V}^{(i)}]
\mathrm{MHSA}(\boldsymbol{X})=\text{Concat}[\boldsymbol{H}^{(1)},..,%
\boldsymbol{H}^{(i)},..,\boldsymbol{H}^{(h)}]\boldsymbol{W}_{o}
\boldsymbol{W}_{O}
\in\mathbb{R}^{d\times d}
\boldsymbol{W}_{Q,K,V}
\in\mathbb{R}^{d\times d_{h}}
d_{h}
\boldsymbol{W_{FFN1}}
\boldsymbol{W_{FFN2}}
\sigma
\mathrm{FFN}(\boldsymbol{X})=\sigma(\boldsymbol{XW_{FFN1}})\boldsymbol{W_{FFN2}}
\boldsymbol{X}^{\prime}=\mathrm{LayerNorm}(\boldsymbol{X}+\mathrm{MHSA}(%
\boldsymbol{X}))
\boldsymbol{Y}=\mathrm{LayerNorm}(\boldsymbol{X}^{\prime}+\mathrm{FFN}(%
\boldsymbol{X}^{\prime}))
A
B
W
\boldsymbol{Y}=\boldsymbol{XW}+\alpha\boldsymbol{XAB}.
\alpha
d\times r
r
r
S
\boldsymbol{Y}=\boldsymbol{XW}+\alpha\boldsymbol{XASB},
\boldsymbol{A}\in\mathbb{R}^{d\times r}
\boldsymbol{S}\in\mathbb{R}^{r\times r}
\boldsymbol{B}\in\mathbb{R}^{r\times d}
\boldsymbol{A}
\boldsymbol{B}
\boldsymbol{S}
r^{2}\ \ll 2\times d\times r
d
2\times d\times r\times L
A
b
n
X
\boldsymbol{B}\times n\times d
\boldsymbol{A}
d
\boldsymbol{S}
\boldsymbol{A}
\boldsymbol{B}\times n\times r
\boldsymbol{A}
\boldsymbol{B}
BA
r
\boldsymbol{A}
\boldsymbol{B}
\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V}=SVD(\boldsymbol{W})
\boldsymbol{A}=\boldsymbol{U}[:,:r]\boldsymbol{\Sigma}[:r,:r],\quad\boldsymbol%
{B}=\boldsymbol{V}[:,:r]^{\mathrm{T}}.
\boldsymbol{B}
\mathbb{R}^{r}
\boldsymbol{S}
\boldsymbol{S}
I_{r}
d-r
\boldsymbol{W}
\boldsymbol{B}
r(t)=\begin{cases}\mathrm{int}(r-\frac{t}{t_{i}}),&\text{$t\leq t_{i}$}\\
0&\text{ $t\geq t_{i}$}\end{cases}
t\geq t_{i}
t_{i}
\boldsymbol{B}
r\times d
r-
E^{l}_{r}
r=32
l
E^{l}_{T}
l
\boldsymbol{W_{Q}}
\boldsymbol{W_{K}}
\boldsymbol{W_{FFN1}}
\boldsymbol{W_{FFN2}}
\boldsymbol{W_{V}}
R_{S}
S
R_{S}=\{r_{1},...,r_{S}\}
r_{1}<r_{2}<r_{S}
r_{T}
l
\nu_{l}
\nu_{l}=\frac{{E^{l}_{r_{S}}}-{E^{l}_{r_{1}}}}{E^{l}_{r_{T}}}
\nu_{l}
r_{S}
\frac{1}{S}
r_{S-1}
\frac{1}{S}
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
r
r
r
r_{T}
\boldsymbol{W_{Q}}
\boldsymbol{W_{K}}
\boldsymbol{W_{V}}
\boldsymbol{W_{FFN1}}
\boldsymbol{W_{FFN2}}
r_{T}
R_{S}=\{16,24,32,40,48\}
\times
\times
\times
\times
R_{S}
t_{i}
\times
1.32\times
r
r_{T}
\boldsymbol{W_{Q}}
\boldsymbol{W_{K}}
\boldsymbol{W_{V}}
\boldsymbol{W_{FFN1}}
\boldsymbol{W_{FFN2}}
t_{i}
r
R_{S}=\{16,24,32,40,48\}
\times
\uparrow
\downarrow
r=16
r
r_{T}
R_{S}
\{32,48,64,80,96\}
\sim 11.5\times
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
r
r
r_{T}
\boldsymbol{W}
r
I_{r}
r
r
r
r
\uparrow
\downarrow
r
r
t_{i}
t_{i}
t_{i}
r\times d
r\times r
t_{i}
t_{i}
\nu
t_{i}
\uparrow
\boldsymbol{A}
\boldsymbol{B}
L
t_{i}
T
\#\mathrm{Params}=\sum_{l=1}^{L}[\frac{t_{i}}{T}\times\frac{\mathrm{NP}(PMB_{l%
})}{2}+\mathrm{NP}(LDA_{l})]
\mathrm{NP}(\boldsymbol{X})
\boldsymbol{X}
PMB_{l}
LDA_{l}
l
