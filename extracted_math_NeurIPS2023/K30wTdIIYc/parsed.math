z
\bm{w}
\bm{x}
\|\bm{M}-\bm{M}^{0}\|
\bm{M}
\bm{M}^{0}
\text{rank}(\bm{M}-\bm{M}^{0})=r^{\prime}
r^{\prime}
\|\text{HE}(\bm{M})-\text{HE}(\bm{M}^{0})\|=0
\text{HE}(\cdot)
\bm{W}=\{\bm{w}_{1},\cdots,\bm{w}_{n}\}\in\mathbb{R}^{d\times n}
\bm{w}_{i}\in\mathbb{R}^{d}
i
\bm{W}^{0}
\bm{z}\in\mathbb{R}^{n}
\bm{z}=\bm{W}^{\top}\bm{x}
\bm{x}\in\mathbb{R}^{d}
\footnotesize\min_{\bm{W}}\left\|\text{HE}(\bm{W})-\text{HE}(\bm{W}^{0})\right%
\|~{}~{}\Leftrightarrow~{}~{}\min_{\bm{W}}\bigg{\|}\sum_{i\neq j}\|\hat{\bm{w}%
}_{i}-\hat{\bm{w}}_{j}\|^{-1}-\sum_{i\neq j}\|\hat{\bm{w}}^{0}_{i}-\hat{\bm{w}%
}^{0}_{j}\|^{-1}\bigg{\|}
\hat{\bm{w}}_{i}:=\bm{w}_{i}/\|\bm{w}_{i}\|
i
\bm{W}
\text{HE}(\bm{W}):=\sum_{i\neq j}\|\hat{\bm{w}}_{i}-\hat{\bm{w}}_{j}\|^{-1}
\bm{W}
\bm{W}^{0}
\bm{W}=\bm{R}\bm{W}^{0}
\bm{R}\in\mathbb{R}^{d\times d}
1
-1
\bm{R}\in\mathbb{R}^{d\times d}
\bm{W}^{0}\in\mathbb{R}^{d\times n}
\bm{z}=(\bm{W}^{0})^{\top}\bm{x}
\footnotesize\bm{z}=\bm{W}^{\top}\bm{x}=(\bm{R}\cdot\bm{W}^{0})^{\top}\bm{x},~%
{}~{}~{}\text{s.t.}~{}\bm{R}^{\top}\bm{R}=\bm{R}\bm{R}^{\top}=\bm{I}
\bm{W}
\bm{I}
\bm{W}^{0}
\bm{R}
\bm{R}
r
r=1
r
r=1
\bm{R}=(\bm{I}+\bm{Q})(I-\bm{Q})^{-1}
\bm{Q}
\bm{Q}=-\bm{Q}^{\top}
1
\bm{R}
d
\bm{R}
r
\footnotesize\bm{R}=\text{diag}(\bm{R}_{1},\bm{R}_{2},\cdots,\bm{R}_{r})=%
\begin{bmatrix}\bm{R}_{1}\in\text{O}(\frac{d}{r})&&\\
&\ddots&\\
&&\bm{R}_{r}\in\text{O}(\frac{d}{r})\end{bmatrix}\in\text{O}(d)
\text{O}(d)
d
\bm{R}\in\mathbb{R}^{d\times d}
\bm{R}_{i}\in\mathbb{R}^{d/r\times d/r},\forall i
r=1
d\times d
d(d-1)/2
\mathcal{O}(d^{2})
r
d(d/r-1)/2
\mathcal{O}(d^{2}/r)
\bm{R}_{i}=\bm{R}_{j},\forall i\neq j
\mathcal{O}(d^{2}/r^{2})
\bm{R}
r^{\prime}
r^{\prime}(d+n)
r
r^{\prime}
d
r=r^{\prime}=\alpha d
0<\alpha\leq 1
\mathcal{O}(d^{2}+dn)
\mathcal{O}(d)
128\times 128
2,048
r^{\prime}=8
960
r=8
\footnotesize\bm{z}=\bm{W}^{\top}\bm{x}=(\bm{R}\cdot\bm{W}^{0})^{\top}\bm{x},~%
{}~{}~{}\text{s.t.}~{}\bm{R}^{\top}\bm{R}=\bm{R}\bm{R}^{\top}=\bm{I},~{}\left%
\lVert\bm{R}-\bm{I}\right\rVert\leq\epsilon
\epsilon
\epsilon
\bm{R}=(\bm{I}+\bm{Q})(I-\bm{Q})^{-1}
\bm{R}\approx\bm{I}+2\bm{Q}+\mathcal{O}(\bm{Q}^{2})
\epsilon
\epsilon
\|\bm{R}-\bm{I}\|\leq\epsilon
\|\bm{Q}-\bm{0}\|\leq\epsilon^{\prime}
\bm{0}
\epsilon^{\prime}
\epsilon
\bm{Q}
\bm{R}
\bm{Q}
\epsilon
\epsilon
\epsilon
\epsilon
\bm{z}=(\bm{R}\bm{W}^{0}\bm{D})^{\top}\bm{x}
\bm{z}=(\bm{D}\bm{R}\bm{W}^{0})^{\top}\bm{x}
\bm{D}=\text{diag}(s_{1},\cdots,s_{n})\in\mathbb{R}^{n\times n}
s_{1},\cdots,s_{n}
\bm{R}
\bm{D}
\bm{R}
\bm{R}
\bm{R}
\bm{z}=(\bm{R}\bm{W}^{0})^{\top}\bm{x}=(\bm{W}^{0}+(\bm{R}-\bm{I})\bm{W}^{0})^%
{\top}\bm{x}
(\bm{R}-\bm{I})\bm{W}^{0}
\bm{W}^{0}
\bm{R}-\bm{I}
r^{\prime}
r
\bm{R}
\bm{W}^{0}
\bm{W}=\bm{R}\bm{W}^{0}
\epsilon
\uparrow
\uparrow
\uparrow
\uparrow
\ell_{2}
\ell_{2}
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
\mathbb{E}_{\bm{x},\bm{c},\bm{\epsilon},\bm{\epsilon}^{\prime},t}[w_{t}\|\hat{%
\bm{x}}_{\theta}(\alpha_{t}\bm{x}+\sigma_{t}\bm{\epsilon},\bm{c})-\bm{x}\|^{2}%
_{2}+\lambda w_{t^{\prime}}\|\hat{\bm{x}}_{\theta}(\alpha_{t^{\prime}}\bm{x}_{%
\text{pr}}+\sigma_{t^{\prime}}\bm{\epsilon}^{\prime},\bm{c}_{\text{pr}})-\bm{x%
}_{\text{pr}}\|^{2}_{2}],
\bm{c}_{\text{pr}}
\bm{W}_{q}
\bm{W}_{k}
\bm{W}_{v}
\bm{W}_{o}
6\times 10^{-5}
\epsilon=6\times 10^{-5}
8
4
1\times 10^{-5}
4
16
\epsilon=1\times 10^{-3}
\ell_{2}
r
r
r
r
r
r=4
r=4
r=2
r=4
r=8
r=16
\uparrow
\uparrow
\uparrow
N\times 1
N
\downarrow
r=4
r=4
\bm{R}
r
\downarrow
r=4
r=4
1\times 10^{-5}
\epsilon=1\times 10^{-5}
1\times 10^{-4}
1
4
