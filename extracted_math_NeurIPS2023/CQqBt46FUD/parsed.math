x
z
p(z|\theta)
\theta
z
\gamma
p_{\gamma}(x|z)
p_{\gamma}(z,\theta|x)
\mathcal{L}[q(\theta;\eta)q(z;\omega),\gamma]=\mathbb{E}_{q(\theta;\eta)q(z;%
\omega)}\bigg{[}\log\frac{p(\theta)p(z|\theta)p_{\gamma}(x|z)}{q(\theta;\eta)q%
(z;\omega)}\bigg{]}\leq\log p_{\gamma}(x).
q(\theta;\eta)q(z;\omega)\approx p_{\gamma}(z,\theta|x)
\eta,\omega
q(z;\omega)=\exp\{\langle\omega,t(z)\rangle-\log Z(\omega)\},\hskip 28.45274%
ptZ(\omega)=\int_{z}\exp\{\langle\omega,t(z)\rangle\}\;dz.
t(z)
Z(\omega)
p_{\gamma}(x|z)
\eta,\omega
x
q(z;\omega)
q(\theta;\eta)
\omega
q(z;\omega)
x
\phi
q_{\phi}(z|x)
x
q(\theta)
q(z)\propto p_{0}(z;\eta)p_{\gamma}(x|z)
p_{0}(z;\eta)\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(z|\theta)]\}
z
p_{\gamma}(x|z)
\ell(z)=p_{\gamma}(x|z)
\hat{\ell}_{\phi}(z|x)
q_{\phi}(z|x;\eta)=\operatorname*{\arg\max}_{q(z)}\hat{\mathcal{L}}[q(\theta;%
\eta)q(z),\phi]=\operatorname*{\arg\max}_{q(z)}\mathbb{E}_{q(\theta;\eta)q(z)}%
\bigg{[}\log\frac{p(\theta)p(z|\theta){\hat{\ell}_{\phi}(z|x)}}{q(\theta;\eta)%
q(z)}\bigg{]}.
\hat{\mathcal{L}}[\cdot,\phi]
q_{\phi}(z|x;\eta)\propto p_{0}(z;\eta)\hat{\ell}_{\phi}(z|x)
\hat{\ell}_{\phi}(z|x)
p(z|\theta)
\hat{\ell}_{\phi}(z|x)
\mathcal{L}[q(\theta;\eta)q_{\phi}(z|x;\eta),\gamma]
\hat{\ell}_{\phi}
\ell
\hat{\mathcal{L}}
\mathcal{L}
q_{\phi}(z|x;\eta)
q(\theta;\eta)
\eta
\lambda=\texttt{encode}(x;\phi)
\hat{\ell}_{\phi}(z|x)
(\mu_{1},\ldots,\mu_{M})\leftarrow
(\eta,\lambda)
m\leftarrow 1
M
\omega_{m}\leftarrow\texttt{MF}(\mu_{-m};\eta)
\mu_{m}\leftarrow
\omega_{m};\eta,\lambda
\omega=\texttt{concat}(\omega_{1},\ldots,\omega_{M})
q_{\phi}(z|x)
q(z)
M
M=2
q_{\phi}(z|x)
q(z)
M
M=2
\theta
z\sim\mathcal{N}(0,I)
\hat{\ell}_{\phi}(z\mid\mu=\mu(x;\phi),\tau=\tau(x;\phi))\propto\mathcal{N}(z;%
\mu,\textnormal{diag}(\tau^{-1}))
\mu
\tau
q_{\phi}(z|x)=\mathcal{N}(z;\frac{\tau}{\tau+1}\mu,\textnormal{diag}((\tau+1)^%
{-1}))
z_{t}\sim\mathcal{N}(A_{t}z_{t-1}+b_{t},Q_{t})
z_{1}\sim\mathcal{N}(\mu_{1},\Sigma_{1})
q(z;\omega)
q(z;\omega)=q(z_{1})\prod_{t=2}^{T}q(z_{t}|z_{t-1})=\exp\Big{\{}\langle\omega_%
{1},t(z_{1})\rangle+\sum_{t=2}^{T}\langle\omega_{t},t(z_{t-1},z_{t})\rangle-%
\log Z(\omega)\Big{\}},
\omega=\texttt{concat}(\omega_{t})
p(z|\theta)
z_{t}
p_{\gamma}(x|z)=\prod_{t}p_{\gamma}(x_{t}|z_{t})
A_{t},b_{t},Q_{t}
p(z|\theta)
q(\theta)
z
q_{\phi}(z|x;\eta)
T
p(z|\theta)
q(z)
z
z
\mathcal{F}
q(z;\omega)=\exp\Big{\{}\sum_{f\in\mathcal{F}}\langle\omega_{f},t(z_{f})%
\rangle-\log Z(\omega)\Big{\}}.
q_{\phi}(z|x;\eta)
\{z_{m}\}_{m=1}^{M}
z_{m}
q_{\phi}(z_{m}|x;\eta)
\hat{\mathcal{L}}[q(\theta;\eta)\prod_{m}q(z_{m}),\phi]
q_{\phi}(z_{m}|x;\eta)
q_{\phi}(z|x;\eta)
m
\omega
\omega_{m}=\texttt{MF}(\mu_{-m};\eta),\hskip 28.45274pt\mu_{m}=\texttt{BP}(%
\omega_{m};\eta,\phi,x).
\mu_{m}
m
m
\mu_{-m}
\hat{\mathcal{L}}[q(\theta)\prod_{m}q(z_{m})]
q_{\phi}(z_{m}|x;\eta)
\phi
p_{\gamma}(x|z)
z
z_{m}
k_{m}
k\sim\textnormal{Cat}(\pi)
z\sim\mathcal{N}(\mu_{k},\Sigma_{k})
p_{\gamma}(x|z)
z
q_{\phi}(z|x;\eta)q_{\phi}(k|x;\eta)
q_{\phi}(z|x;\eta)
q_{\phi}(k|x)
k_{1}\sim\textnormal{Cat}(\pi_{0}),k_{t}\sim\textnormal{Cat}(\pi_{k_{t-1}})
z_{0}\sim\mathcal{N}(\mu_{0},\Sigma_{0}),z_{t}\sim\mathcal{N}(A_{k_{t}}z_{t-1}%
+b_{k_{t}},Q_{k_{t}})
t
k_{t}
q_{\phi}(z|x;\eta)q_{\phi}(k|x;\eta)
k_{tj}=1
j
t
k_{tj}=0
\bar{\theta}_{j}=\mathbb{E}_{q(\theta;\eta)}[\theta_{j}]
j
\omega_{k_{tj}}
\omega_{z_{t},z_{t+1}}
\omega_{z_{t},z_{t+1}}=\sum_{j}\mathbb{E}_{q}[k_{tj}]\bar{\theta}_{j},\qquad%
\qquad\omega_{k_{tj}}=\langle\bar{\theta}_{j},\mathbb{E}_{q}[t(z_{t-1},z_{t})]\rangle.
q_{\phi}(z|x)
z\sim q_{\phi}(z|x;\eta)
\frac{\partial\omega}{\partial\eta}
\frac{\partial\omega}{\partial\phi}
\eta
\phi
\omega^{(1)},\ldots,\omega^{(L)}
\omega
\omega^{(L)}
\frac{\partial\omega^{(L)}}{\partial\eta}=\bigg{(}\frac{\partial g(\omega;\eta%
,\phi,x)}{\partial\omega}\bigg{)}^{-1}\frac{\partial g(\omega;\eta,\phi,x)}{%
\partial\eta},\hskip 28.45274ptg(\omega)=\omega-\texttt{MF}(\texttt{BP}(\omega%
;\eta,\phi,x);\eta).
m
g(\omega)=0
D
K
\omega
O(K+D^{2})
T
\frac{\partial g}{\partial\omega}
O(T(D^{2}+K))
O(T^{2}D^{2}K)
B=1
B=32
B=64
B=128
K=50
D=16
T=250
B
L=10
K=50
D=16
T=250
B
L=10
(I-A)v^{\prime}
A^{-1}v
\displaystyle\textit{Richardson:}\frac{\partial\omega^{(L)}}{\partial\eta}
\displaystyle\frac{\partial\omega^{(L)}}{\partial\eta}
\displaystyle\approx-\sum_{j=0}^{J}\bigg{(}I-\frac{\partial g(\omega^{(L)};%
\eta,\phi,x)}{\partial\omega}\bigg{)}^{j}\frac{\partial g(\omega^{(L)};\eta,%
\phi,x)}{\partial\eta}.
\displaystyle\approx-\sum_{j=0}^{J}\bigg{(}I-\frac{\partial g(\omega^{(L)};%
\eta,\phi,x)}{\partial\omega}\bigg{)}^{j}\frac{\partial g(\omega^{(L)};\eta,%
\phi,x)}{\partial\eta}.
\displaystyle\textit{Unrolled:}\frac{\partial\omega^{(L)}}{\partial\eta}
\displaystyle\frac{\partial\omega^{(L)}}{\partial\eta}
\displaystyle\approx-\sum_{\ell=0}^{L}\bigg{[}\prod_{i=\ell}^{L}\bigg{(}I-%
\frac{\partial g(\omega^{(i)};\eta,\phi,x)}{\partial\omega}\bigg{)}\bigg{]}%
\frac{\partial g(\omega^{(\ell)};\eta,\phi,x)}{\partial\eta}.
\displaystyle\approx-\sum_{\ell=0}^{L}\bigg{[}\prod_{i=\ell}^{L}\bigg{(}I-%
\frac{\partial g(\omega^{(i)};\eta,\phi,x)}{\partial\omega}\bigg{)}\bigg{]}%
\frac{\partial g(\omega^{(\ell)};\eta,\phi,x)}{\partial\eta}.
J
\omega^{(L)}
g(\omega)
J\to\infty
\omega^{(L)}
J=L
J=50
J=L
\phi
\eta
L
90^{\text{th}}
L
90^{\text{th}}
F_{\eta}
q(\theta;\eta)
F_{\eta}=\mathbb{E}_{q(\theta;\eta)}\big{[}\big{(}\nabla_{\eta}q(\theta;\eta)%
\big{)}\cdot\big{(}\nabla_{\eta}q(\theta;\eta)\big{)}^{T}\big{]}.
q(z)
q(\theta;\eta)
\mathcal{L}
\hat{\mathcal{L}}
\mu_{\eta}
q(\theta;\eta)
\frac{\partial\mu}{\partial\eta}=F_{\eta}
\frac{\partial\mathcal{L}}{\partial\eta}F_{\eta}^{-1}=\frac{\partial\mathcal{L%
}}{\partial\mu}\frac{\partial\mu}{\partial\eta}F_{\eta}^{-1}=\frac{\partial%
\mathcal{L}}{\partial\mu},\hskip 42.67912pt\frac{\partial\mathcal{L}}{\partial%
\mu}=\overbrace{\eta_{0}+\mathbb{E}_{q_{\phi}(z|x;\eta)}[t(z)]-\eta}^{%
\textnormal{SVI update}}+\overbrace{\frac{\partial\mathcal{L}}{\partial\omega}%
\cdot\frac{\partial\omega}{\partial\eta}{}}^{\textnormal{correction term}}.
\omega
\mathcal{L}
\frac{\partial\mathcal{L}}{\partial\omega}=0
\frac{\partial\omega}{\partial\eta}
\eta
\tilde{\eta}
\eta
\eta=\texttt{Softplus}\{\tilde{\eta}\}=\log(1+e^{\tilde{\eta}})
\frac{\partial\mathcal{L}}{\partial\tilde{\eta}}F_{\tilde{\eta}}^{-1}=\frac{%
\partial\mathcal{L}}{\partial\mu}\cdot\frac{\partial\eta}{\partial\tilde{\eta}%
}^{-T}=\bigg{(}\frac{\partial\tilde{\eta}}{\partial\eta}\cdot\nabla_{\mu}%
\mathcal{L}\bigg{)}^{T}.
\eta\rightarrow\mu
\tilde{\eta}\rightarrow\eta
\tilde{\eta}\rightarrow\eta
\eta\rightarrow\tilde{\eta}
q(\theta)
\hat{\theta}
p_{\gamma}(x|z)
\hat{\ell}_{\phi}(z_{t}|x_{t};\eta)
t
z_{t}
z_{t}
T=500
T=50
T=500
T=50
p(x_{t}|z,x_{t-1})
x
z
z
q(z_{t}|x_{1:T})
p(x_{t+1}|x_{1:t},z_{1:t+1})
p(z_{t+1}|x_{1:t},z_{1:t})
\hat{\theta}
q(\theta)
p(z|\theta)
q(z)
K
\log_{2}K
K
(\downarrow)
\log p(x)\geq
(\uparrow)
(\downarrow)
12.3\pm 0.2
7.9\pm 0.2
7.5\pm 0.2
2.8\pm 0.02
34.6\pm 0.7
28.8\pm 0.2
25.8\pm 0.3
6.71\pm 0.12
34.0\pm 0.3
19.3\pm 0.2
21.9\pm 0.2
7.90\pm 0.13
33.7\pm 0.4
12.38\pm 0.12
8.97\pm 0.08
3.27\pm 0.05
65.2\pm 1.4
18.3\pm 0.2
15.5\pm 0.2
6.24\pm 0.09
2.82
421\pm 11
234\pm 9
228\pm 5
113\pm 5
62.7\pm 0.7
43.5\pm 0.7
24.2\pm 0.6
14.2\pm 0.3
136\pm 6
46.7\pm 1.7
33.3\pm 1.1
9.0\pm 0.3
144\pm 3
88\pm 3
89\pm 2
34.0\pm 1.4
22\pm 3
22.6\pm 0.3
17.15\pm 0.14
13.8\pm 0.2
9.61\pm 0.15
7.5\pm 0.2
8.14\pm 0.12
4.88\pm 0.08
18.6\pm 0.2
15.0\pm 0.2
15.2\pm 0.2
7.6\pm 0.12
1.56
19.1\pm 0.3
17.9\pm 0.2
16.6\pm 0.3
7.2\pm 0.3
20.0\pm 0.4
17.2\pm 0.3
14.9\pm 0.3
9.5\pm 0.2
17.8\pm 0.2
17.21\pm 0.11
13.2\pm 0.4
10.1\pm 0.2
1.88
10.0\pm 0.2
12.0\pm 0.3
8.2\pm 0.2
5.7\pm 0.4
1.94
23.6\pm 0.3
19.4\pm 0.5
17.4\pm 0.3
12.7\pm 0.4
1.55
12.9\pm 0.2
10.8\pm 0.2
10.8\pm 0.14
7.7\pm 0.05
16.6\pm 0.2
12.8\pm 0.2
11.3\pm 0.2
8.2\pm 0.2
15.51\pm 0.13
10.07\pm 0.11
9.02\pm 0.18
6.29\pm 0.13
84
T=250
513
T=50
q(z_{t})
x_{t}
x_{\textnormal{obs}}
q(z_{\textnormal{obs}})
p(z_{\textnormal{missing}}|z_{\textnormal{obs}},\theta)
p(z|\theta)
z_{\textnormal{missing}}
z_{\textnormal{obs}}
p(x|z)
100
T=250
100
T=250
p_{\theta_{k}}(k_{t}\mid z_{t-1},k_{t-1})=\text{Cat}(\mathbf{\lambda}_{\theta_%
{k}}(z_{t-1},k_{t-1}))
p_{\theta_{z}}(z_{t}\mid z_{t-1},k_{t})=\mathcal{N}(\mathbf{\mu}_{\theta_{z}}(%
z_{t-1},k_{t}),\mathbf{\sigma}_{\theta_{z}})
p_{\gamma}(x_{t}\mid z_{t})=\mathcal{N}(\mathbf{\mu}_{\gamma}(z_{t}),\mathbf{%
\sigma}_{\theta_{x}})
\mathbf{\lambda}_{\theta_{k}}(z_{t-1},k_{t-1})
\mathbf{\mu}_{\theta_{z}}(z_{t-1},k_{t})
\mathbf{\mu}_{\gamma}(z_{t})
\sigma_{\theta_{z}}
\sigma_{\theta_{x}}
\mathbf{\mu}_{\theta_{x}}(z_{t})
\mathbf{\lambda}_{\theta_{k}}(z_{t-1},k_{t-1})
\mathbf{\mu}_{\theta_{z}}(z_{t-1},k_{t})
\mathbf{\lambda}(\cdot)
\mathbf{\mu}(\cdot)
q_{\phi_{k}}(k_{t}\mid x_{t:T},z_{t-1},k_{t-1})=\text{Cat}(\mathbf{\lambda}_{%
\phi_{k}}(g_{\phi}(x_{t:T}),z_{t-1},k_{t-1}))
q_{\phi_{z}}(z_{t}\mid x_{t:T},z_{t-1},k_{t})=\mathcal{N}(\mathbf{\mu}_{\phi_{%
z}}(g_{\phi}(x_{t:T}),z_{t-1},k_{t}),\sigma_{\phi_{z}})
g_{\phi}(x_{t:T})
\mathbf{\lambda}_{\phi_{k}}(\cdot)
\mathbf{\mu}_{\phi_{k}}(\cdot)
\mathbf{\lambda}_{\theta_{k}}(\cdot)
\mathbf{\mu}_{\theta_{k}}(\cdot)
g_{\phi}(x_{t:T})
k_{t}
p_{\theta_{k}}(k_{t}\mid z_{t-1},k_{t-1})
q_{\phi_{k}}(k_{t}\mid x_{t:T},z_{t-1},k_{t-1})
1.
0.02
D=16
B=128
10^{-3}
10^{-4}
\eta
q(\theta)
p(z|.)
p(z|.)
x_{\textnormal{missing}},x_{\textnormal{obs}}
x_{\textnormal{obs}}=x_{0.0-0.2}\cup x_{0.8-1.0}
x_{\textnormal{missing}}=x_{0.2-0.8}
x_{\textnormal{obs}}
q(z_{\textnormal{obs}})
\hat{\ell}_{\phi}(z_{\textnormal{obs}}|x_{\textnormal{obs}})
z_{\textnormal{obs}}
z
z
p(z_{0.2-0.8}|z_{0.0-0.2})
z_{\textnormal{missing}}\cup z_{\textnormal{obs}}
z
z_{0.2-0.8}
x
h_{t}
z_{t}
q_{\phi}(z|x)
\hat{\ell}_{\phi}(z|x)
x_{0.0-0.2}
x_{0.8-1.0}
q(k_{0.0-0.2})
q(k_{0.8-1.0})
k_{0.2},k_{0.8}
p(k_{0.2-0.8}|k_{0.2},k_{0.8})
0.0-0.8,
0.2-1.0
z
0.0-0.8
p(k)
z
\texttt{BP}(.)
\gamma
\eta
q(\theta;\eta)
\tilde{\eta}
\eta
F_{\eta}
\eta
g(\omega;\eta,\phi,x)
k
z
\hat{\ell}_{\phi}(z|x)
\mathcal{L}
\hat{\mathcal{L}}
\texttt{MF}(.)
\mu
q(z)
\mathbb{E}_{q(z)}[t(z)]
\mu_{m}
q(z_{m})
\mu_{-m}
\omega_{-m}
\mu_{\eta}
q(\theta)
\mathbb{E}_{q(\theta)}[t(\theta)]
\omega
q(z)
q(z;\eta)
q_{\phi}(z|x;\eta)
\prod_{m}q_{\phi}(z_{m}|x;\eta)
\omega_{m}
\prod_{m}q_{\phi}(z_{m}|x;\eta)
\omega=\cup_{m}\omega_{m}
\omega_{-m}
\mu_{-m}
\omega_{-m}
\omega_{-m}=\cup_{n\neq m}\omega_{n}
\omega^{*}(x,\eta,\phi)
q(z)
\hat{\mathcal{L}}
p_{0}(z;\eta)
p_{0}(z;\eta)\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(z|\theta)]\}
\phi
q(\theta;\eta),q(z;\omega)
\theta
z
q_{\phi}(z|x),q_{\phi}(z|x;\eta)
z
q_{\phi}(z_{m}|x;\eta)
z_{m}\subseteq z
t(.)
\theta
\mathcal{V}
x
z
KL
\mathcal{F}
q(z)
\lambda_{\phi}(x)
\hat{\ell}_{\phi}(z|x)
r_{t},R_{t}
\lambda_{\phi}(x)=\{r_{t},-1/2R_{t}\}
\theta_{\textnormal{trans}}
K
h_{0},J_{0}
p(z_{1}|\theta)
\omega_{t}
t
t
h_{1,t},J_{11,t},J_{12,t},J_{22,t},h_{2,t}
\omega_{t}
m_{z_{i},\omega_{i}}(z_{i})
z_{i}
\omega_{i}
m_{\omega_{i},z_{i}}(z_{i})
\omega_{i}
z_{i}
f_{t|t},F_{t|t}
m_{z_{t},\omega_{t+1}}(z_{t})
t
t
f_{t+1|t},F_{t+1|t}
m_{\omega_{t+1},z_{t+1}}(z_{t+1})
t+1
t
f_{t|T},F_{t|T}
q(z_{t})
t
\textnormal{ker}(.)
f_{t}(z_{t-1},z_{t}),\phi_{.,t},\Phi_{..,t}
g_{t}(z_{t-1}),\gamma_{t},\Gamma_{t}
e_{t}(z_{t},z_{t+1}),\epsilon_{t},E_{t}
\otimes
\oplus
\hat{\mathcal{L}}[\dots]
\texttt{MF}(.)
z\in\mathcal{Z}
t(z):\mathcal{Z}\rightarrow\mathbb{R}^{n}
p(z;\eta)=\exp\{\langle\eta,t(z)\rangle-\log Z(\eta)\}
\eta\in\mathbb{R}^{n}
\log Z(\eta)
\log Z(\eta)=\log\int_{z}\exp\{\langle\eta,t(z)\rangle\}dx
z
t(z)
\eta
\eta\in H
H
\nabla_{\eta}\log Z(\eta))=\mathbb{E}_{p(z;\eta)}[t(z)]
\displaystyle\nabla_{\eta}\log Z(\eta)=\frac{1}{\int_{z}\exp\{\langle\eta,t(z)%
\rangle\}dx}\int_{z}t(z)\exp\{\langle\eta,t(z)\rangle\}dx
\displaystyle\nabla_{\eta}\log Z(\eta)
\displaystyle=\frac{1}{\int_{z}\exp\{\langle\eta,t(z)\rangle\}dx}\int_{z}t(z)%
\exp\{\langle\eta,t(z)\rangle\}dx
\displaystyle=\int_{z}t(z)\exp\{\langle\eta,t(z)\rangle-\log Z(\eta)\}=\mathbb%
{E}_{p(z;\eta)}[t(z)]
\displaystyle=\int_{z}t(z)\exp\{\langle\eta,t(z)\rangle-\log Z(\eta)\}=\mathbb%
{E}_{p(z;\eta)}[t(z)]
p(z;\eta_{1}),p(z;\eta_{2})
\eta_{1}
\eta_{2}
\displaystyle\textnormal{KL}(p(z;\eta_{1})\;\|\;p(z;\eta_{2})))\vcentcolon=%
\mathbb{E}_{p(z;\eta_{1})}\Big{[}\log\frac{p(z;\eta_{1})}{p(z;\eta_{2})}\Big{]}
\displaystyle\textnormal{KL}(p(z;\eta_{1})\;\|\;p(z;\eta_{2})))\vcentcolon=
\displaystyle\mathbb{E}_{p(z;\eta_{1})}\Big{[}\log\frac{p(z;\eta_{1})}{p(z;%
\eta_{2})}\Big{]}
\displaystyle=\langle\eta_{1}-\eta_{2},\mathbb{E}_{p(z;\eta_{1})}[t(z)]\rangle%
-\log Z(\eta_{1})+\log Z(\eta_{2})
\displaystyle=
\displaystyle\langle\eta_{1}-\eta_{2},\mathbb{E}_{p(z;\eta_{1})}[t(z)]\rangle-%
\log Z(\eta_{1})+\log Z(\eta_{2})
p(\theta;\eta)
p(\theta;\eta)=\exp\{\langle\eta,t(\theta)\rangle-\log Z(\eta)\}
p(z|\theta)
p(\theta;\eta)
p(z|\theta)=\exp\{\langle t(\theta),(t(z),1)\rangle-c\}=\exp\{\langle\hat{t}(%
\theta),t(z)\rangle-\log Z(\hat{t}(\theta))\}
\hat{t}(\theta)
\textnormal{dim}(t(z))
t(\theta)
c
t(\theta)
t(z)
p(\theta),p(z)
p(\theta)
p(z|\theta)
t(z)
p(z;\mu,\Sigma)
\eta=\begin{bmatrix}\Sigma^{-1}\mu\\
-\frac{1}{2}\Sigma^{-1}\end{bmatrix}\qquad t(x)=\begin{bmatrix}x\\
xx^{T}\end{bmatrix}
\log Z(\eta)=\frac{1}{2}\mu^{T}\Sigma^{-1}\mu+\frac{1}{2}\log|\Sigma|+\frac{n}%
{2}\log(2\pi)
t(\mu,\Sigma)=\begin{bmatrix}-\frac{1}{2}\Sigma^{-1}\\
\Sigma^{-1}\mu\\
-\frac{1}{2}\mu^{T}\Sigma^{-1}\mu\\
-\frac{1}{2}\log|\Sigma|\end{bmatrix}
p(z),
p(\theta|z)\propto\exp\{\langle t(\theta),\eta+(t(z),1)\rangle\}
p(\theta|z)\propto p(\theta)p(z|\theta)
t(\theta)
z
\mathcal{V}
z
\mathcal{F}
\mathcal{V}
z_{f}\subseteq z,f\in\mathcal{F}
p(z;\eta)=\exp\{\langle\eta,t(z)\rangle-\log Z(\eta)\}=\exp\Big{\{}\sum_{f\in%
\mathcal{F}}\langle\eta_{f},t(z_{f})\rangle-\log Z(\eta)\Big{\}}
\eta
\eta_{f}
t(z_{f})
q(a)
l[q(a)q(b)]=\mathbb{E}_{q(a)q(b)}\bigg{[}\log\frac{f(a,b)}{q(a)q(b)}\bigg{]}
f(a,b)
q(b)
\operatorname*{\arg\max}_{q(b)}l[q(a)q(b)]\propto\exp\{\mathbb{E}_{q(a)}[\log f%
(a,b)]\}
\tilde{p}(b)
\tilde{p}(b)\propto\exp\{\mathbb{E}_{q(a)}[\log f(a,b)]\}
q(b)
\displaystyle\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(a)q(b)}\bigg{[}\log%
\frac{f(a,b)}{q(b)}\bigg{]}=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}[%
\mathbb{E}_{q(a)}[\log f(a,b)]-\log q(b)]
\displaystyle\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(a)q(b)}\bigg{[}\log%
\frac{f(a,b)}{q(b)}\bigg{]}
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}[\mathbb{E}_{q(a%
)}[\log f(a,b)]-\log q(b)]
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}[\log\exp\mathbb%
{E}_{q(a)}[\log f(a,b)]-\log q(b)]
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}[\log\exp\mathbb%
{E}_{q(a)}[\log f(a,b)]-\log q(b)]
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}\bigg{[}\log%
\frac{\exp\{\mathbb{E}_{q(a)}[\log f(a,b)]\}}{q(b)}\bigg{]}
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}\bigg{[}\log%
\frac{\exp\{\mathbb{E}_{q(a)}[\log f(a,b)]\}}{q(b)}\bigg{]}
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}\bigg{[}\log%
\frac{\tilde{p}(b)}{q(b)}+\textnormal{const}\bigg{]}
\displaystyle=\operatorname*{\arg\max}_{q(b)}\mathbb{E}_{q(b)}\bigg{[}\log%
\frac{\tilde{p}(b)}{q(b)}+\textnormal{const}\bigg{]}
\displaystyle=\operatorname*{\arg\max}_{q(b)}-\textnormal{KL}(q(b)\;\|\;\tilde%
{p}(b))=\tilde{p}(b)
\displaystyle=\operatorname*{\arg\max}_{q(b)}-\textnormal{KL}(q(b)\;\|\;\tilde%
{p}(b))=\tilde{p}(b)
\displaystyle\operatorname*{\arg\max}_{q(z)}\hat{\mathcal{L}}[q(\theta;\eta)q(%
z);\phi]=\mathbb{E}_{q(\theta;\eta)q(z)}\bigg{[}\log\frac{p(\theta)p(z|\theta)%
\hat{\ell}_{\phi}(z|x)}{q(\theta;\eta)q(z)}\bigg{]}
\displaystyle\operatorname*{\arg\max}_{q(z)}\hat{\mathcal{L}}[q(\theta;\eta)q(%
z);\phi]
\displaystyle=\mathbb{E}_{q(\theta;\eta)q(z)}\bigg{[}\log\frac{p(\theta)p(z|%
\theta)\hat{\ell}_{\phi}(z|x)}{q(\theta;\eta)q(z)}\bigg{]}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(\theta)\cdot p(z|%
\theta)\cdot\hat{\ell}_{\phi}(z|x)]\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(\theta)\cdot p(z|%
\theta)\cdot\hat{\ell}_{\phi}(z|x)]\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(\theta)]+\mathbb{%
E}_{q(\theta;\eta)}[\log p(z|\theta)]+\log\hat{\ell}_{\phi}(z|x)\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(\theta)]+\mathbb{%
E}_{q(\theta;\eta)}[\log p(z|\theta)]+\log\hat{\ell}_{\phi}(z|x)\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(z|\theta)]+\log%
\hat{\ell}_{\phi}(z|x)\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(z|\theta)]+\log%
\hat{\ell}_{\phi}(z|x)\}
\hat{\ell}_{\phi}(z|x)
p(z|\theta)
\lambda_{\phi}(x)
\hat{\ell}_{\phi}(z|x)=\exp\{\langle\lambda_{\phi}(x),t(z)\rangle\}
\displaystyle\operatorname*{\arg\max}_{q(z)}\hat{\mathcal{L}}[q(\theta;\eta)q(%
z);\phi]\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(z|\theta)]+\log\hat{%
\ell}_{\phi}(z|x)\}
\displaystyle\operatorname*{\arg\max}_{q(z)}\hat{\mathcal{L}}[q(\theta;\eta)q(%
z);\phi]
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\log p(z|\theta)]+\log%
\hat{\ell}_{\phi}(z|x)\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\langle t(\theta),t(z)%
\rangle]+\langle\lambda_{\phi}(x),t(z)\rangle\}
\displaystyle\propto\exp\{\mathbb{E}_{q(\theta;\eta)}[\langle t(\theta),t(z)%
\rangle]+\langle\lambda_{\phi}(x),t(z)\rangle\}
\displaystyle=\exp\{\langle\mathbb{E}_{q(\theta;\eta)}[t(\theta)]+\lambda_{%
\phi}(x),t(z)\rangle\}
\displaystyle=\exp\{\langle\mathbb{E}_{q(\theta;\eta)}[t(\theta)]+\lambda_{%
\phi}(x),t(z)\rangle\}
q(z)
p(z|\theta)
\omega=\mathbb{E}_{q(\theta;\eta)}[t(\theta)]+\lambda_{\phi}(x)
p(z_{1})=\mathcal{N}(\mu_{0},\Sigma_{0})
p(z_{t}|z_{t-1})=\mathcal{N}(A_{t}z_{t-1}+b_{t},\Sigma_{t})
A,b,\Sigma
t
p(z|\theta)=p(z_{1})\prod_{t=2}^{T}p(z_{t}|z_{t-1})=\exp\Big{\{}\langle t(%
\theta_{1}),t(z_{1})\rangle+\sum_{t=2}^{T}\langle t(\theta_{t}),t(z_{t-1},z_{t%
})\rangle-\log Z(t(\theta))\Big{\}}
t(z_{1}),t(\theta_{1})
t=2,\dots,T
t(z_{t-1},z_{t})=\begin{bmatrix}z_{t-1}\\
z_{t-1}z_{t-1}^{T}\\
z_{t-1}z_{t}^{T}\\
z_{t}z_{t}^{T}\\
z_{t}\end{bmatrix},\;\;\;t(\theta_{t})=\begin{bmatrix}-A_{t}^{T}Q_{t}^{-1}b_{t%
}\\
-\frac{1}{2}A_{t}^{T}Q_{t}^{-1}A_{t}\\
A_{t}^{T}Q_{t}^{-1}\\
-\frac{1}{2}Q_{t}^{-1}\\
Q_{t}^{-1}b_{t}\end{bmatrix}
t(\theta_{t})
t(\theta_{t+1})
z_{t}
\hat{\ell}_{\phi}(z|x)=\exp\bigg{\{}\sum_{t}\bigg{\langle}\begin{bmatrix}r_{t}%
\\
-\frac{1}{2}R_{t}\end{bmatrix},\begin{bmatrix}z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
p(z|\theta)
z_{m}\subset z,m\in\mathcal{M}
\langle t(\theta),t(z_{t-1},z_{t})\rangle=\langle t(\theta,z_{t-1}),t(z_{t})%
\rangle=\langle t(\theta,z_{t}),t(z_{t-1})\rangle
q(z_{m})
q(z_{-m})
q(a)=q(\theta)\prod_{-m}q(z_{m})
q(b)=q(z_{m})
\operatorname*{\arg\max}_{q(z_{m})}\hat{\mathcal{L}}[q(\theta;\eta)\prod_{m}q(%
z_{m});\phi]\propto\exp\{\mathbb{E}_{q(\theta;\eta)q(z_{-m})}[\log p(z|\theta)%
]+\log\hat{\ell}_{\phi}(z|x)\}
z_{f,m}=z_{f}\cap z_{m}
z_{f,-m}=z_{f}\cap z_{m}^{C}
\displaystyle\mathbb{E}_{q(\theta;\eta)q(z_{-m})}[\log p(z|\theta)]\propto%
\mathbb{E}_{q(\theta;\eta)q(z_{-m})}\Big{[}\sum_{f\in\mathcal{F}}\langle t(%
\theta_{f}),t(z_{f})\rangle\Big{]}
\displaystyle\mathbb{E}_{q(\theta;\eta)q(z_{-m})}[\log p(z|\theta)]
\displaystyle\propto\mathbb{E}_{q(\theta;\eta)q(z_{-m})}\Big{[}\sum_{f\in%
\mathcal{F}}\langle t(\theta_{f}),t(z_{f})\rangle\Big{]}
\displaystyle=\mathbb{E}_{q(\theta;\eta)q(z_{-m})}\Big{[}\sum_{f\in\mathcal{F}%
}\langle t(\theta_{f},z_{f,-m}),t(z_{f,m})\rangle\Big{]}
\displaystyle=\mathbb{E}_{q(\theta;\eta)q(z_{-m})}\Big{[}\sum_{f\in\mathcal{F}%
}\langle t(\theta_{f},z_{f,-m}),t(z_{f,m})\rangle\Big{]}
\displaystyle=\sum_{f\in\mathcal{F}}\langle\mathbb{E}_{q(\theta;\eta)q(z_{-m})%
}[t(\theta_{f},z_{f,-m})],t(z_{f,m})\rangle
\displaystyle=\sum_{f\in\mathcal{F}}\langle\mathbb{E}_{q(\theta;\eta)q(z_{-m})%
}[t(\theta_{f},z_{f,-m})],t(z_{f,m})\rangle
z_{f,-m},\theta_{f}
\mathbb{E}_{q(\theta;\eta)q(z_{-m})}[t(\theta_{f},z_{f,-m})]=\texttt{MF}(%
\mathbb{E}_{q(\theta;\eta)}[t(\theta_{f})],\mathbb{E}_{q(z_{-m})}[t(z_{f,-m})])
\texttt{MF}(.)
\theta_{f},z_{f,-m}
t(\theta_{f},z_{f,-m})
p(k_{2})=\textnormal{Cat}(\pi_{0})
p(k_{t})=\textnormal{Cat}(\pi_{k_{t-1}})
p(z_{1})=\mathcal{N}(\mu_{0},\Sigma_{0})
p(k_{2})=\textnormal{Cat}(\pi_{0})
p(z_{t}|z_{t-1})=\mathcal{N}(A_{k_{t}}z_{t-1}+b_{k_{t}},\Sigma_{k_{t}})
z_{1}
k_{2}
p(k_{t}|k_{t-1})
\pi_{ij}
1\{(k_{t}=i)\&(k_{t+1}=j)\}
i,j=1,\dots,K
p(z_{t}|z_{t-1},k_{t})
p(z_{t}|z_{t-1})
p(z_{t}|z_{t-1},k_{t})=\exp\{\langle t(\theta_{k_{t}}),t(z_{t-1},z_{t})\rangle%
-\log Z(t(\theta_{k_{t}}))\}
k_{t}
t(\theta_{\textnormal{trans}})
k
t(\theta_{k})
\log Z(\theta_{\textnormal{trans}})
\log Z(\theta_{k})
p(z_{t}|z_{t-1},k_{t})=\exp\{\langle t(\theta_{\textnormal{trans}}),t(k_{t})%
\cdot t(z_{t-1},z_{t})^{T}\rangle+\langle-\log Z(t(\theta_{\textnormal{trans}}%
)),t(k_{t})\rangle\}
t(k_{t})
t(\theta)
q(z)q(k)
\langle t(\theta_{\textnormal{trans}}),t(k_{t})\cdot t(z_{t-1},z_{t})^{T}\rangle
\displaystyle\exp\{\langle t(\theta_{\textnormal{trans}}),t(k_{t})\cdot t(z_{t%
-1},z_{t})^{T}\rangle\}=\exp\{\langle t(z_{t-1},z_{t}),t(\theta_{\textnormal{%
trans}})^{T}\cdot t(k_{t})\rangle\}
\displaystyle\exp\{\langle t(\theta_{\textnormal{trans}}),t(k_{t})\cdot t(z_{t%
-1},z_{t})^{T}\rangle\}=
\displaystyle\exp\{\langle t(z_{t-1},z_{t}),t(\theta_{\textnormal{trans}})^{T}%
\cdot t(k_{t})\rangle\}
\displaystyle=\exp\{\langle t(k_{t}),t(\theta_{\textnormal{trans}})\cdot t(z_{%
t-1},z_{t})\rangle\}
\displaystyle=
\displaystyle\exp\{\langle t(k_{t}),t(\theta_{\textnormal{trans}})\cdot t(z_{t%
-1},z_{t})\rangle\}
q(k)
p(k_{2})
p(k_{t}|k_{t-1})
\langle-\log Z(t(\theta_{\textnormal{trans}})),t(k_{t})\rangle
z_{t-1},z_{t}
\langle\mathbb{E}_{q(\theta;\eta)}[t(\theta_{\textnormal{trans}})]\cdot\mathbb%
{E}_{q(z)}[t(z_{t-1},z_{t})],t(k_{t})\rangle
t
p(z_{1})
\langle\mathbb{E}_{q(\theta;\eta)}[t(\theta_{\textnormal{trans}})]^{T}\cdot%
\mathbb{E}_{q(k_{t})}[t(k_{t})],t(z_{t-1},z_{t})\rangle
t(k_{t})
k_{t}
\mathbb{E}_{q(k_{t})}[t(k_{t})]
k_{t}
t(z_{t-1},z_{t})
t(\theta_{\textnormal{trans}})
\mathbb{E}_{q(z)}[t(z)]
t
\mathbb{E}_{q(\theta)}[t(\theta_{\textnormal{trans}})]\cdot\mathbb{E}_{q(z)}[t%
(z_{t-1},z_{t})]
q(k)
t(k_{t})
\mathbb{E}_{q(k)}[t(k)]
t
\mathbb{E}_{q(\theta)}[t(\theta_{\textnormal{trans}})]^{T}\cdot\mathbb{E}_{q(k%
)}[t(k_{t})]
q(z)
t(z_{t-1},z_{t})
\dots
z_{1}\sim\mathcal{N}(\mu_{0},\Sigma_{0}),\;\;\;z_{t}\sim\mathcal{N}(A_{t}z_{t-%
1}+b_{t},Q_{t})
q(z;\omega)
\omega_{0}=\begin{bmatrix}h_{0}\\
-\frac{1}{2}J_{0}\end{bmatrix}\;\;t(z_{1})=\begin{bmatrix}z_{1}\\
z_{1}z_{1}^{T}\end{bmatrix}\;\;
h_{0},-\frac{1}{2}J_{0}
t(z_{t},z_{t+1})=\begin{bmatrix}z_{t}\\
z_{t}z_{t}^{T}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}z_{t+1}^{T}\\
z_{t+1}\end{bmatrix},\;\;\;\omega_{t+1}=\begin{bmatrix}-h_{1,t}\\
-\frac{1}{2}J_{11,t}\\
J_{12,t}\\
-\frac{1}{2}J_{22,t}\\
h_{2,t}\end{bmatrix}=\begin{bmatrix}-\mathbb{E}[A_{t}^{T}Q_{t}^{-1}b_{t}]\\
-\frac{1}{2}\mathbb{E}[A_{t}^{T}Q_{t}^{-1}A_{t}]\\
\mathbb{E}[A_{t}^{T}Q_{t}^{-1}]\\
-\frac{1}{2}\mathbb{E}[Q_{t}^{-1}]\\
\mathbb{E}[Q_{t}^{-1}b_{t}]\end{bmatrix}
\mathbb{E}_{q(k_{t})}[t(k_{t})]
\lambda_{t}=\begin{bmatrix}r_{t}\\
-\frac{1}{2}R_{t}\end{bmatrix}\;\;t(z_{t})=\begin{bmatrix}z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\;\;
\hat{A}_{t},\hat{Q}_{t},\hat{b}_{t}
\begin{bmatrix}-\hat{A}_{t}^{T}\hat{Q}_{t}^{-1}\hat{b}_{t}\\
-\frac{1}{2}\hat{A}_{t}^{T}\hat{Q}_{t}^{-1}\hat{A}_{t}\\
\hat{A}_{t}^{T}\hat{Q}_{t}^{-1}\\
-\frac{1}{2}\hat{Q}_{t}^{-1}\\
\hat{Q}_{t}^{-1}\hat{b}_{t}\end{bmatrix}=\begin{bmatrix}-h_{1,t}\\
-\frac{1}{2}J_{11,t}\\
J_{12,t}\\
-\frac{1}{2}J_{22,t}\\
h_{2,t}\end{bmatrix}
q(z_{t})
\log Z
q(z_{t})
z_{t}
q(z_{t})\propto m_{\omega_{t},z_{t}}(z_{t})\cdot m_{\omega_{t+1},z_{t}}(z_{t})%
\cdot m_{\lambda_{t},z_{t}}(z_{t})
m_{\omega,z}(z)
\omega
z
m_{z,\omega}(z)
m_{.,.}(z_{t})
m_{z_{t},\omega_{t+1}}(z_{t})=m_{\omega_{t},z_{t}}(z_{t})\cdot m_{\lambda_{t},%
z_{t}}(z_{t})
m_{\omega_{t},z_{t}}(z_{t})=\int_{z_{t-1}}m_{z_{t-1},\omega_{t}}(z_{t-1})\cdot%
\exp\{\langle\omega_{t},t(z_{t-1},z_{t})\rangle\}d{z_{t-1}}
J_{t|t},h_{t|t}
m_{z_{t},\omega_{t+1}}(z_{t})
\omega_{1:t}
\lambda_{1:t}
t
J_{t+1|f},h_{t+1|f}
m_{\omega_{t+1},z_{t+1}}(z_{t+1})
z_{t+1}
t
J_{t|T},h_{t|T}
q(z_{t})
-\frac{1}{2}J_{.|.},h_{.|.}
\omega_{t}
\lambda_{t}
\displaystyle F_{1|1}=J_{0}+R_{1}
\displaystyle F_{1|1}
\displaystyle=J_{0}+R_{1}
\displaystyle f_{1|1}=h_{0}+r_{1}
\displaystyle f_{1|1}
\displaystyle=h_{0}+r_{1}
\displaystyle\log Z=0
\displaystyle\log Z
\displaystyle=0
t=1,\dots,T-1
\displaystyle P_{t}=F_{t|t}+J_{11,t}
\displaystyle P_{t}
\displaystyle=F_{t|t}+J_{11,t}
\displaystyle F_{t+1|t}=J_{22,t}-J_{12,t}^{T}\cdot P_{t}^{-1}\cdot J_{12,t}
\displaystyle F_{t+1|t}
\displaystyle=J_{22,t}-J_{12,t}^{T}\cdot P_{t}^{-1}\cdot J_{12,t}
\displaystyle f_{t+1|t}=h_{2,t}+J_{12,t}^{T}\cdot P_{t}^{-1}\cdot(f_{t|t}-h_{1%
,t})
\displaystyle f_{t+1|t}
\displaystyle=h_{2,t}+J_{12,t}^{T}\cdot P_{t}^{-1}\cdot(f_{t|t}-h_{1,t})
\displaystyle\log Z=\log Z+\frac{1}{2}\Big{(}(f_{t|t}-h_{1,t})^{T}P_{t}^{-1}(f%
_{t|t}-h_{1,t})-\log|P_{t}|\Big{)}
\displaystyle\log Z
\displaystyle=\log Z+\frac{1}{2}\Big{(}(f_{t|t}-h_{1,t})^{T}P_{t}^{-1}(f_{t|t}%
-h_{1,t})-\log|P_{t}|\Big{)}
\displaystyle F_{t+1|t+1}=F_{t+1|t}+R_{t+1}
\displaystyle F_{t+1|t+1}
\displaystyle=F_{t+1|t}+R_{t+1}
\displaystyle f_{t+1|t+1}=f_{t+1|t}+r_{t+1}
\displaystyle f_{t+1|t+1}
\displaystyle=f_{t+1|t}+r_{t+1}
\log Z=\log Z+\frac{1}{2}\Big{(}f_{T|T}^{T}F_{T|T}^{-1}F_{T|T}-\log|F_{T|T}|%
\Big{)}
t=T-1,\dots,1
\displaystyle C_{t}=F_{t+1|T}-F_{t+1|t}+J_{22,t}
\displaystyle C_{t}
\displaystyle=F_{t+1|T}-F_{t+1|t}+J_{22,t}
\displaystyle F_{t|T}=F_{t|t}+J_{11,t}-J_{12,t}\cdot C_{t}^{-1}\cdot J_{12,t}^%
{T}
\displaystyle F_{t|T}
\displaystyle=F_{t|t}+J_{11,t}-J_{12,t}\cdot C_{t}^{-1}\cdot J_{12,t}^{T}
\displaystyle f_{t|T}=f_{t|t}-h_{1,t}+J_{12,t}C_{t}^{-1}(f_{t+1|T}-f_{t+1|t}+h%
_{2,t})
\displaystyle f_{t|T}
\displaystyle=f_{t|t}-h_{1,t}+J_{12,t}C_{t}^{-1}(f_{t+1|T}-f_{t+1|t}+h_{2,t})
\mathcal{N}
z_{T}\sim\mathcal{N}\Big{(}f_{T|T},-\frac{1}{2}F_{T|T}\Big{)}
\texttt{for }t=T-1,\dots,1\;\;\;\;\;z_{t}\sim\mathcal{N}\Big{(}f_{t|t}+J_{12,t%
}z_{t+1}-h_{1,t},-\frac{1}{2}(F_{t|t}+J_{11,t})\Big{)}
f_{t|T},F_{t|T}
\log Z
x_{1:T}
\displaystyle\Sigma_{i}=F_{t|T}^{-1}
\displaystyle\Sigma_{i}
\displaystyle=F_{t|T}^{-1}
\displaystyle\mu_{i}=\Sigma_{i}f_{t|T}
\displaystyle\mu_{i}
\displaystyle=\Sigma_{i}f_{t|T}
\displaystyle E[z_{i}]=\mu_{i}
\displaystyle E[z_{i}]
\displaystyle=\mu_{i}
\displaystyle E[z_{i}z_{i}^{T}]=\Sigma_{i}+\mu_{i}\mu_{i}^{T}
\displaystyle E[z_{i}z_{i}^{T}]
\displaystyle=\Sigma_{i}+\mu_{i}\mu_{i}^{T}
\displaystyle E[z_{i}z_{i+1}^{T}]=\Sigma_{i}J_{12,t}C_{t}^{-1}+\mu_{i}\mu_{i+1%
}^{T}
\displaystyle E[z_{i}z_{i+1}^{T}]
\displaystyle=\Sigma_{i}J_{12,t}C_{t}^{-1}+\mu_{i}\mu_{i+1}^{T}
\int_{z_{t}}\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}f_{t|t}\\
-\frac{1}{2}F_{t|t}\end{bmatrix},\begin{bmatrix}z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}+\bigg{\langle}\begin{bmatrix}-\frac{%
1}{2}J_{11,t}\\
J_{12,t}\\
-\frac{1}{2}J_{22,t}\\
-h_{1,t}\\
h_{2,t}\end{bmatrix},\begin{bmatrix}z_{t}z_{t}^{T}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}z_{t+1}^{T}\\
z_{t}\\
z_{t+1}\end{bmatrix}\bigg{\rangle}\bigg{\}}dz_{t}
=\exp\bigg{\{}\Big{\langle}\begin{bmatrix}-\frac{1}{2}J_{22,t}\\
h_{2,t}\end{bmatrix},\begin{bmatrix}z_{t+1}z_{t+1}^{T}\\
z_{t+1}\end{bmatrix}\Big{\rangle}\bigg{\}}\int_{z_{t}}\exp\bigg{\{}\bigg{%
\langle}\begin{bmatrix}f_{t|t}+J_{12,t}z_{t+1}-h_{1,t}\\
-\frac{1}{2}(F_{t|t}+J_{11,t})\end{bmatrix},\begin{bmatrix}z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}dz_{t}
=\exp\bigg{\{}\Big{\langle}\begin{bmatrix}-\frac{1}{2}J_{22,t}\\
h_{2,t}\end{bmatrix},\begin{bmatrix}z_{t+1}z_{t+1}^{T}\\
z_{t+1}\end{bmatrix}\Big{\rangle}+\log Z(f_{t|t}-h_{1,t}+J_{12,t}z_{t+1},F_{t|%
t}+J_{11,t})\bigg{\}}
\frac{1}{2}(f_{t|t}-h_{1,t}+J_{12,t}z_{t+1})^{T}(F_{t|t}+J_{11,t})^{-1}(f_{t|t%
}-h_{1,t}+J_{12,t}z_{t+1})-\frac{1}{2}\log|F_{t|t}+J_{11,t}|
P_{t}=F_{t|t}+J_{11,t}
\frac{1}{2}(f_{t|t}-h_{1,t})^{T}P_{t}^{-1}(f_{t|t}-h_{1,t})-\frac{1}{2}\log|P_%
{t}|
z_{t+1}^{T}J_{12,t}^{T}P_{t}^{-1}(f_{t|t}-h_{1,t})
\frac{1}{2}z_{t+1}^{T}J_{12,t}^{T}P_{t}^{-1}J_{12,t}z_{t+1}
\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}h_{2,t}+J_{12,t}^{T}P_{t}^{-1}(f_{t|%
t}-h_{1,t})\\
-\frac{1}{2}(J_{22,t}-J_{12,t}^{T}P_{t}^{-1}J_{12,t})\end{bmatrix},\begin{%
bmatrix}z_{t+1}\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}+\frac{1}{2}(f_{t|t}-h_{1,t})^{T}%
P_{t}^{-1}(f_{t|t}-h_{1,t})-\frac{1}{2}\log|P_{t}|\bigg{\}}
\log Z
\exp\{\langle\eta,t(z)\rangle\}
\log Z
q(z_{t})\propto m_{\omega_{t+1},z_{t}}(z_{t})\cdot m_{z_{t},\omega_{t+1}}(z_{t})
\displaystyle q(z_{t})\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot m_{\omega_{t+%
1},z_{t}}(z_{t})
\displaystyle q(z_{t})
\displaystyle\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot m_{\omega_{t+1},z_{t}}%
(z_{t})
\displaystyle\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot\int m_{z_{t+1},\omega_%
{t+1}}(z_{t+1})\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1})\rangle\}dz_{t+1}
\displaystyle\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot\int m_{z_{t+1},\omega_%
{t+1}}(z_{t+1})\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1})\rangle\}dz_{t+1}
\displaystyle=m_{z_{t},\omega_{t+1}}(z_{t})\cdot\int(m_{\omega_{t+2},z_{t+1}}(%
z_{t+1})\cdot m_{\lambda_{t+1},z_{t+1}}(z_{t+1}))\cdot\exp\{\langle\omega_{t+1%
},t(z_{t},z_{t+1})\rangle\}dz_{t+1}
\displaystyle=m_{z_{t},\omega_{t+1}}(z_{t})\cdot\int(m_{\omega_{t+2},z_{t+1}}(%
z_{t+1})\cdot m_{\lambda_{t+1},z_{t+1}}(z_{t+1}))\cdot\exp\{\langle\omega_{t+1%
},t(z_{t},z_{t+1})\rangle\}dz_{t+1}
\displaystyle\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot\int\frac{q(z_{t+1})}{m%
_{\omega_{t+1},z_{t+1}}(z_{t+1})}\cdot\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1%
})\rangle\}dz_{t+1}
\displaystyle\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot\int\frac{q(z_{t+1})}{m%
_{\omega_{t+1},z_{t+1}}(z_{t+1})}\cdot\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1%
})\rangle\}dz_{t+1}
\int\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}J_{11,t}\\
J_{12,t}\\
-\frac{1}{2}J_{22,t}\\
-h_{1,t}\\
h_{2,t}\end{bmatrix},\begin{bmatrix}z_{t}z_{t}^{T}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}z_{t+1}^{T}\\
z_{t}\\
z_{t+1}\end{bmatrix}\bigg{\rangle}+\bigg{\langle}\begin{bmatrix}f_{t+1|T}-f_{t%
+1|t}\\
-\frac{1}{2}(F_{t+1|T}-F_{t+1|t})\end{bmatrix},\begin{bmatrix}z_{t+1}\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}dz_{t+1}
=\exp\bigg{\{}\Big{\langle}\begin{bmatrix}-\frac{1}{2}J_{11,t}\\
-h_{1,t}\end{bmatrix},\begin{bmatrix}z_{t}z_{t}^{T}\\
z_{t}\end{bmatrix}\Big{\rangle}\bigg{\}}\int_{z_{t+1}}\exp\bigg{\{}\bigg{%
\langle}\begin{bmatrix}f_{t+1|T}-f_{t+1|t}+h_{2,t}+J_{12,t}^{T}z_{t}\\
-\frac{1}{2}(F_{t+1|T}-F_{t+1|t}+J_{22,t})\end{bmatrix},\begin{bmatrix}z_{t+1}%
\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}dz_{t+1}
=\exp\bigg{\{}\Big{\langle}\begin{bmatrix}-\frac{1}{2}J_{11,t}\\
-h_{1,t}\end{bmatrix},\begin{bmatrix}z_{t}z_{t}^{T}\\
z_{t}\end{bmatrix}\Big{\rangle}+\log Z(f_{t+1|T}-f_{t+1|t}+h_{2,t}+J_{12,t}^{T%
}z_{t},F_{t+1|T}-F_{t+1|t}+J_{22,t})\bigg{\}}
C_{t}=F_{t+1|T}-F_{t+1|t}+J_{22,t}
\frac{1}{2}(f_{t+1|T}-f_{t+1|t}+h_{2,t}+J_{12,t}^{T}z_{t})^{T}C_{t}^{-1}(f_{t+%
1|T}-f_{t+1|t}+h_{2,t}+J_{12,t}^{T}z_{t})-\frac{1}{2}\log|C_{t}|
z_{t}^{T}J_{12,t}C_{t}^{-1}(f_{t+1|T}-f_{t+1|t}+h_{2,t})
\frac{1}{2}z_{t}^{T}J_{12,t}C_{t}^{-1}J_{12,t}^{T}z_{t}
J_{11,t}
h_{1,t}
q(z_{t}|z_{t+1})\propto m_{z_{t},\omega_{t+1}}(z_{t})\cdot\exp\{\langle\omega_%
{t+1},t(z_{t},z_{t+1})\rangle\}
\textnormal{ker}(\exp\{\langle\eta,t(z)\rangle-c\})=\exp\{\langle\eta,t(z)\rangle\}
\textnormal{ker}(f(z))\propto f(z)
\displaystyle g_{t}(z_{t-1})=\textnormal{ker}\Big{(}\int_{z_{t}}\exp\{\langle t%
(\theta_{t}),t(z_{t-1},z_{t})\rangle\}\cdot\exp\{\langle\lambda_{t},t(z_{t})%
\rangle\}dz_{t}\Big{)}
\displaystyle g_{t}(z_{t-1})
\displaystyle=\textnormal{ker}\Big{(}\int_{z_{t}}\exp\{\langle t(\theta_{t}),t%
(z_{t-1},z_{t})\rangle\}\cdot\exp\{\langle\lambda_{t},t(z_{t})\rangle\}dz_{t}%
\Big{)}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(J_{11,t}-%
J_{12,t}(R_{t}+J_{22,t})^{-1}J_{12,t}^{T})\\
-h_{1,t}+J_{12,t}(R_{t}+J_{22,t})^{-1}(r_{t}+h_{2})\end{bmatrix},\begin{%
bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(J_{11,t}-%
J_{12,t}(R_{t}+J_{22,t})^{-1}J_{12,t}^{T})\\
-h_{1,t}+J_{12,t}(R_{t}+J_{22,t})^{-1}(r_{t}+h_{2})\end{bmatrix},\begin{%
bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Gamma_{t}%
\\
\gamma_{t}\end{bmatrix},\begin{bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Gamma_{t}%
\\
\gamma_{t}\end{bmatrix},\begin{bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\end{bmatrix}\bigg{\rangle}\bigg{\}}
g_{t}(z_{t-1})
\Gamma_{t},\gamma_{t}
t=1
\Gamma_{1}=0
\gamma_{1}=0
g_{1}(z_{0})=1
f_{t}(z_{t-1},z_{t})
\displaystyle f_{t}(z_{t-1},z_{t})=\exp\{\langle t(\theta_{t}),t(z_{t-1},z_{t}%
)\rangle\}\cdot\exp\{\langle\lambda_{t},t(z_{t})\rangle\}/g_{t}(z_{t-1})
\displaystyle f_{t}(z_{t-1},z_{t})
\displaystyle=\exp\{\langle t(\theta_{t}),t(z_{t-1},z_{t})\rangle\}\cdot\exp\{%
\langle\lambda_{t},t(z_{t})\rangle\}/g_{t}(z_{t-1})
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(J_{11,t}-%
\Gamma_{t})\\
-(h_{1,t}-\gamma_{t})\\
J_{12,t}\\
h_{2,t}+r_{t}\\
-\frac{1}{2}(J_{22,t}+R_{t})\end{bmatrix},\begin{bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\\
z_{t-1}z_{t}^{T}\\
z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(J_{11,t}-%
\Gamma_{t})\\
-(h_{1,t}-\gamma_{t})\\
J_{12,t}\\
h_{2,t}+r_{t}\\
-\frac{1}{2}(J_{22,t}+R_{t})\end{bmatrix},\begin{bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\\
z_{t-1}z_{t}^{T}\\
z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Phi_{11,t%
}\\
-\phi_{1,t}\\
\Phi_{12,t}\\
\phi_{2,t}\\
-\frac{1}{2}\Phi_{22,t}\end{bmatrix},\begin{bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\\
z_{t-1}z_{t}^{T}\\
z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Phi_{11,t%
}\\
-\phi_{1,t}\\
\Phi_{12,t}\\
\phi_{2,t}\\
-\frac{1}{2}\Phi_{22,t}\end{bmatrix},\begin{bmatrix}z_{t-1}z_{t-1}^{T}\\
z_{t-1}\\
z_{t-1}z_{t}^{T}\\
z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
f_{1}(z_{0},z_{1})=f_{1}(z_{1})
\Phi_{11,1}=\Phi_{12,1}=0
\phi_{1,1}=0
z_{0}
\phi_{2,t}=h_{0}+r_{1}
\Phi_{22,t}=J_{0}+R_{1}
h_{0},J_{0}
p(z_{1})
(f_{i},g_{i})\otimes(f_{j},g_{j})=(f_{ij},g_{ij})
f_{ij}(a,c)=\textnormal{ker}\bigg{(}\frac{\int g_{j}(b)f_{j}(b,c)f_{i}(a,b)db}%
{\int g_{j}(b)f_{i}(a,b)db}\bigg{)}
g_{ij}(a)=\textnormal{ker}\Big{(}g_{i}(a)\int g_{j}(b)f_{i}(a,b)db\Big{)}
\otimes
(f_{i},g_{i})\times(f_{j},g_{j})=(\hat{f}_{ij},\hat{g}_{ij})
f_{ij}(a,c)=\frac{\int g_{j}(b)f_{j}(b,c)f_{i}(a,b)db}{\int g_{j}(b)f_{i}(a,b)db}
g_{ij}(a)=g_{i}(a)\int g_{j}(b)f_{i}(b|a)db
c_{1},c_{2},c_{3},c_{4}
c_{5},c_{6}
(c_{1}f_{i},c_{2}g_{i})\times(c_{3}f_{j},c_{4}g_{j})=(c_{5}\hat{f}_{ij},c_{6}%
\hat{g}_{ij})
\displaystyle((f_{i},g_{i})\otimes(f_{j},g_{j}))\otimes(f_{k},g_{k})=(\ker(%
\hat{f}_{ij}),\ker(\hat{g}_{ij}))\otimes(f_{k},g_{k})
\displaystyle((f_{i},g_{i})\otimes(f_{j},g_{j}))\otimes(f_{k},g_{k})
\displaystyle=(\ker(\hat{f}_{ij}),\ker(\hat{g}_{ij}))\otimes(f_{k},g_{k})
\displaystyle=(c_{1}\hat{f}_{ij},c_{2}\hat{g}_{ij})\otimes(f_{k},g_{k})
\displaystyle=(c_{1}\hat{f}_{ij},c_{2}\hat{g}_{ij})\otimes(f_{k},g_{k})
\displaystyle=\ker\Big{(}(c_{1}\hat{f}_{ij},c_{2}\hat{g}_{ij})\times(f_{k},g_{%
k})\Big{)}
\displaystyle=\ker\Big{(}(c_{1}\hat{f}_{ij},c_{2}\hat{g}_{ij})\times(f_{k},g_{%
k})\Big{)}
\displaystyle=\ker\Big{(}(\hat{f}_{ij},\hat{g}_{ij})\times(f_{k},g_{k})\Big{)}
\displaystyle=\ker\Big{(}(\hat{f}_{ij},\hat{g}_{ij})\times(f_{k},g_{k})\Big{)}
\displaystyle(f_{i},g_{i})\otimes((f_{j},g_{j})\otimes(f_{k},g_{k}))=\ker\Big{%
(}(f_{i},g_{i})\times(\hat{f}_{jk},\hat{g}_{jk})\Big{)}
\displaystyle(f_{i},g_{i})\otimes((f_{j},g_{j})\otimes(f_{k},g_{k}))
\displaystyle=\ker\Big{(}(f_{i},g_{i})\times(\hat{f}_{jk},\hat{g}_{jk})\Big{)}
\displaystyle=\ker\Big{(}(\hat{f}_{ij},\hat{g}_{ij})\times(f_{k},g_{k})\Big{)}
\displaystyle=\ker\Big{(}(\hat{f}_{ij},\hat{g}_{ij})\times(f_{k},g_{k})\Big{)}
\displaystyle=((f_{i},g_{i})\otimes((f_{j},g_{j}))\otimes(f_{k},g_{k})
\displaystyle=((f_{i},g_{i})\otimes((f_{j},g_{j}))\otimes(f_{k},g_{k})
\times
a_{i}=(f_{i},g_{i})
a_{1}\otimes a_{2}\otimes\dots\otimes a_{t}=(f_{1:t},g_{1:t})
f_{1:t}(z_{t})=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}f_{t|t}\\
-\frac{1}{2}F_{t|t}\end{bmatrix},\begin{bmatrix}z_{t}\\
z_{t}z_{t}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
f_{t|t},F_{t|t}
(((((a_{1}\otimes a_{2})\otimes a_{3})\otimes\dots)\otimes a_{t}
\otimes
g_{1}(z_{0})=1
z_{0}
\Gamma_{1}=0,\gamma_{1}=0
g_{ij}(z_{0})
g_{i}(a)
a
g_{ij}(a)
f_{1}(z_{0},z_{1})=f_{1}(z_{1})
\Phi_{11,1}=\Phi_{12,1}=0
\phi_{1,1}=0
f_{1:t}(z_{0},z_{t})
f_{i}(a,b)
a
f_{ij}(a,c)
f_{1:t}(z_{0},z_{t})=f_{1:t}(z_{t})
f_{1:t}(z_{t})=m_{z_{t},\omega}(z_{t})
t=1
f_{1:1}(z_{1})=m_{z_{1},\omega}(z_{1})
\displaystyle f_{1:t+1}(z_{t+1})=\ker\bigg{(}\frac{\int_{z_{t}}g_{t+1}(z_{t})f%
_{t+1}(z_{t+1})m_{z_{t},\omega}(z_{t})dz_{t}}{\int g_{t+1}(z_{t})f_{1:t}(z_{t}%
)dz_{t}}\bigg{)}
\displaystyle f_{1:t+1}(z_{t+1})
\displaystyle=\ker\bigg{(}\frac{\int_{z_{t}}g_{t+1}(z_{t})f_{t+1}(z_{t+1})m_{z%
_{t},\omega}(z_{t})dz_{t}}{\int g_{t+1}(z_{t})f_{1:t}(z_{t})dz_{t}}\bigg{)}
\displaystyle=\ker\bigg{(}\int_{z_{t}}g_{t+1}(z_{t})f_{t+1}(z_{t+1})m_{z_{t},%
\omega}(z_{t})dz_{t}\bigg{)}
\displaystyle=\ker\bigg{(}\int_{z_{t}}g_{t+1}(z_{t})f_{t+1}(z_{t+1})m_{z_{t},%
\omega}(z_{t})dz_{t}\bigg{)}
\displaystyle=\ker\bigg{(}\int_{z_{t}}\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1%
})\rangle\}\cdot\exp\{\langle\lambda_{t+1},t(z_{t+1})\rangle\}\cdot m_{z_{t},%
\omega}(z_{t})dz_{t}\bigg{)}
\displaystyle=\ker\bigg{(}\int_{z_{t}}\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1%
})\rangle\}\cdot\exp\{\langle\lambda_{t+1},t(z_{t+1})\rangle\}\cdot m_{z_{t},%
\omega}(z_{t})dz_{t}\bigg{)}
\displaystyle=\ker\bigg{(}\exp\{\langle\lambda_{t+1},t(z_{t+1})\rangle\}\cdot%
\int_{z_{t}}\exp\{\langle t(\theta_{t+1}),t(z_{t},z_{t+1})\rangle\}\cdot m_{z_%
{t},\omega}(z_{t})dz_{t}\bigg{)}
\displaystyle=\ker\bigg{(}\exp\{\langle\lambda_{t+1},t(z_{t+1})\rangle\}\cdot%
\int_{z_{t}}\exp\{\langle t(\theta_{t+1}),t(z_{t},z_{t+1})\rangle\}\cdot m_{z_%
{t},\omega}(z_{t})dz_{t}\bigg{)}
\displaystyle=\ker\bigg{(}\exp\{\langle\lambda_{t+1},t(z_{t+1})\rangle\}\cdot m%
_{z_{t+1},\omega}(z_{t+1})\bigg{)}=m_{z_{t+1},\omega_{t+1}}(z_{t+1})
\displaystyle=\ker\bigg{(}\exp\{\langle\lambda_{t+1},t(z_{t+1})\rangle\}\cdot m%
_{z_{t+1},\omega}(z_{t+1})\bigg{)}=m_{z_{t+1},\omega_{t+1}}(z_{t+1})
(f_{i},f_{j})\otimes(g_{i},g_{j})
f_{i},f_{j},g_{i},g_{j}
f_{i}(a,b)=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Phi_{11,i}\\
-\phi_{1,i}\\
\Phi_{12,i}\\
\phi_{2,i}\\
-\frac{1}{2}\Phi_{22,i}\end{bmatrix},\begin{bmatrix}aa^{T}\\
a\\
ab^{T}\\
b\\
bb^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}},\quad\quad f_{j}(b,c)=\exp\bigg{\{}%
\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Phi_{11,j}\\
-\phi_{1,j}\\
\Phi_{12,j}\\
\phi_{2,j}\\
-\frac{1}{2}\Phi_{22,j}\end{bmatrix},\begin{bmatrix}bb^{T}\\
b\\
bc^{T}\\
c\\
cc^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
g_{i}(a)=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}\Gamma_{i}\\
\gamma_{i}\end{bmatrix},\begin{bmatrix}aa^{T}\\
a\end{bmatrix}\bigg{\rangle}\bigg{\}},\quad\quad g_{j}(b)=\exp\bigg{\{}\bigg{%
\langle}\begin{bmatrix}-\frac{1}{2}\Gamma_{j}\\
\gamma_{j}\end{bmatrix},\begin{bmatrix}bb^{T}\\
b\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle C_{ij}=\Gamma_{j}+\Phi_{22,i}
\displaystyle C_{ij}
\displaystyle=\Gamma_{j}+\Phi_{22,i}
\displaystyle\Gamma_{ij}=(\Phi_{11,i}-\Phi_{12,i}C_{ij}^{-1}\Phi_{12,i}^{T})
\displaystyle\Gamma_{ij}
\displaystyle=(\Phi_{11,i}-\Phi_{12,i}C_{ij}^{-1}\Phi_{12,i}^{T})
\displaystyle\gamma_{ij}=-\phi_{1,i}+\Phi_{12,i}C_{ij}^{-1}(\gamma_{j}+\phi_{2%
,i})
\displaystyle\gamma_{ij}
\displaystyle=-\phi_{1,i}+\Phi_{12,i}C_{ij}^{-1}(\gamma_{j}+\phi_{2,i})
\displaystyle P_{ij}=\Gamma_{j}+\Phi_{22,i}+\Phi_{11,i}
\displaystyle P_{ij}
\displaystyle=\Gamma_{j}+\Phi_{22,i}+\Phi_{11,i}
(f_{ij},g_{ij})=(f_{i},g_{i})\otimes(f_{j},g_{j})
f_{ij}(a,c)=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(\Phi_{11,i}%
-\Phi_{12,i}P_{ij}^{-1}\Phi_{12,i}^{T}-\Gamma_{ij})\\
-(\phi_{1,i}-\Phi_{12,i}P_{ij}^{-1}(\phi_{2,i}-\phi_{1,j}+\gamma_{j})+\gamma_{%
ij})\\
\Phi_{12,i}P_{ij}^{-1}\Phi_{12,j}\\
\phi_{2,j}+\Phi_{12,j}^{T}P_{ij}^{-1}(\phi_{2,i}-\phi_{1,j}+\gamma_{j})\\
-\frac{1}{2}(\Phi_{22,j}-\Phi_{12,j}^{T}P_{ij}^{-1}\Phi_{12,j})\end{bmatrix},%
\begin{bmatrix}aa^{T}\\
a\\
ac^{T}\\
c\\
cc^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
g_{ij}(c)=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(\Gamma_{i}+%
\Gamma_{ij})\\
\gamma_{i}+\gamma_{ij}\end{bmatrix},\begin{bmatrix}cc^{T}\\
c\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle e_{t}(z_{t},z_{t+1})=\frac{m_{z_{t},\omega_{t+1}}(z_{t})}{m_{%
\omega_{t+1},z_{t+1}}(z_{t+1})}\cdot\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1})\rangle\}
\displaystyle e_{t}(z_{t},z_{t+1})
\displaystyle=\frac{m_{z_{t},\omega_{t+1}}(z_{t})}{m_{\omega_{t+1},z_{t+1}}(z_%
{t+1})}\cdot\exp\{\langle\omega_{t+1},t(z_{t},z_{t+1})\rangle\}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(J_{11,t}+%
F_{t|t})\\
-(h_{1,t}-f_{t|t})\\
J_{12,t}\\
h_{2,t}+r_{t+1}-h_{t+1|t+1}\\
-\frac{1}{2}(J_{22,t}+R_{t+1}-J_{t+1|t+1})\end{bmatrix},\begin{bmatrix}z_{t}z_%
{t}^{T}\\
z_{t}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(J_{11,t}+%
F_{t|t})\\
-(h_{1,t}-f_{t|t})\\
J_{12,t}\\
h_{2,t}+r_{t+1}-h_{t+1|t+1}\\
-\frac{1}{2}(J_{22,t}+R_{t+1}-J_{t+1|t+1})\end{bmatrix},\begin{bmatrix}z_{t}z_%
{t}^{T}\\
z_{t}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}E_{11,t}\\
-\epsilon_{1,t}\\
E_{12,t}\\
\epsilon_{2,t}\\
-\frac{1}{2}E_{22,t}\end{bmatrix},\begin{bmatrix}z_{t}z_{t}^{T}\\
z_{t}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}E_{11,t}\\
-\epsilon_{1,t}\\
E_{12,t}\\
\epsilon_{2,t}\\
-\frac{1}{2}E_{22,t}\end{bmatrix},\begin{bmatrix}z_{t}z_{t}^{T}\\
z_{t}\\
z_{t}z_{t+1}^{T}\\
z_{t+1}\\
z_{t+1}z_{t+1}^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
e_{T}(z_{T},z_{T+1})=e_{T}(z_{T})
E_{11,T}=J_{T|T},\epsilon_{1,T}=-h_{T|T}
z_{T+1}
\oplus
e_{ij}(a,c)=e_{i}(a,b)\oplus e_{j}(b,c)=\ker\bigg{(}\int_{b}e_{i}(a,b)e_{j}(b,%
c)db\bigg{)}
\displaystyle D_{ij}=E_{22,i}+E_{11,j}
\displaystyle D_{ij}
\displaystyle=E_{22,i}+E_{11,j}
\displaystyle e_{ij}(a,c)=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{%
2}(E_{11,i}-E_{12,i}D_{ij}^{-1}E_{12,i}^{T})\\
-(\epsilon_{1,i}-E_{12,i}D_{ij}^{-1}(\epsilon_{2,i}-\epsilon_{1,j}))\\
E_{12,i}D_{ij}^{-1}E_{12,j}\\
\epsilon_{2,j}+E_{12,j}^{T}D_{ij}^{-1}(\epsilon_{2,i}-\epsilon_{1,j})\\
-\frac{1}{2}(E_{22,j}-E_{12,j}^{T}D_{ij}^{-1}E_{12,j})\end{bmatrix},\begin{%
bmatrix}aa^{T}\\
a\\
ac^{T}\\
c\\
cc^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
\displaystyle e_{ij}(a,c)
\displaystyle=\exp\bigg{\{}\bigg{\langle}\begin{bmatrix}-\frac{1}{2}(E_{11,i}-%
E_{12,i}D_{ij}^{-1}E_{12,i}^{T})\\
-(\epsilon_{1,i}-E_{12,i}D_{ij}^{-1}(\epsilon_{2,i}-\epsilon_{1,j}))\\
E_{12,i}D_{ij}^{-1}E_{12,j}\\
\epsilon_{2,j}+E_{12,j}^{T}D_{ij}^{-1}(\epsilon_{2,i}-\epsilon_{1,j})\\
-\frac{1}{2}(E_{22,j}-E_{12,j}^{T}D_{ij}^{-1}E_{12,j})\end{bmatrix},\begin{%
bmatrix}aa^{T}\\
a\\
ac^{T}\\
c\\
cc^{T}\end{bmatrix}\bigg{\rangle}\bigg{\}}
e_{t}\oplus(e_{t+1}\oplus(e_{t+1}\oplus\dots(e_{T-1}\oplus e_{T})))))=q(z_{t})
e_{T}(z_{t})=q(z_{T})
\oplus
e_{t}(z_{t})=q(z_{t})
e_{t-1}(z_{t-1})=q(z_{t-1})
k_{2}
\pi_{ij}
\omega_{t}(k)
\mathbb{E}_{q(\theta)}[t(\theta)]
\omega_{t}(k)
\alpha_{1}(k)=\mathbb{E}[\log\pi_{k}]+\omega_{1}(k)
\texttt{for }t=2,\dots,T\;\;\;\alpha_{t}(k)=\omega_{t}(k)+\texttt{logsumexp}_{%
i=1}^{K}\big{[}\mathbb{E}[\log\pi_{ik}]+\alpha_{t-1}(i)\big{]}
\log Z=\texttt{logsumexp}_{k=1}^{K}\alpha_{T}(k)
\beta_{T}(k)=0
\texttt{for }t=T-1,\dots,1\;\;\;\beta_{t}(k)=\texttt{logsumexp}_{j=1}^{K}\big{%
[}\omega_{t+1}(j)+\mathbb{E}[\log\pi_{kj}]+\beta_{t+1}(j)\big{]}
\alpha_{t}(k)+\log\beta_{t}(k)
\log Z
-\mathcal{L}[q(\theta)q(z),\gamma]=\overbrace{\textnormal{KL}(q(\theta)\;\|\;p%
(\theta)))}^{\textnormal{Prior KL}}+\overbrace{\mathbb{E}_{q(\theta)}%
\textnormal{KL}(q(z)\;\|\;p(z|\theta))}^{\textnormal{Local KL}}-\overbrace{%
\mathbb{E}_{q(z)}[p_{\gamma}(x|z)]}^{\textnormal{Reconstruction}}
p(\theta),p(z|\theta),q(\theta;\eta),q_{\phi}(z|x;\eta)
\mathbb{E}_{q(z)}[p_{\gamma}(x|z)]
q(z)
x
z
q(z)
\omega
\displaystyle\mathbb{E}_{q(\theta)}\textnormal{KL}(q(z)\;\|\;p(z|\theta))=%
\mathbb{E}_{q(\theta)}[\langle\omega-t(\theta),E_{q(z)}t(z)\rangle-\log Z(%
\omega)+\log Z(t(\theta))]
\displaystyle\mathbb{E}_{q(\theta)}\textnormal{KL}(q(z)\;\|\;p(z|\theta))
\displaystyle=\mathbb{E}_{q(\theta)}[\langle\omega-t(\theta),E_{q(z)}t(z)%
\rangle-\log Z(\omega)+\log Z(t(\theta))]
\displaystyle=\langle\omega-\mathbb{E}_{q(\theta)}[t(\theta)],E_{q(z)}t(z)%
\rangle-\log Z(\omega)+\log\mathbb{E}_{q(\theta)}[Z(t(\theta))]
\displaystyle=\langle\omega-\mathbb{E}_{q(\theta)}[t(\theta)],E_{q(z)}t(z)%
\rangle-\log Z(\omega)+\log\mathbb{E}_{q(\theta)}[Z(t(\theta))]
\displaystyle=\langle\lambda_{\phi}(x),E_{q(z)}t(z)\rangle-\log Z(\omega)+\log%
\mathbb{E}_{q(\theta)}[Z(t(\theta))]
\displaystyle=\langle\lambda_{\phi}(x),E_{q(z)}t(z)\rangle-\log Z(\omega)+\log%
\mathbb{E}_{q(\theta)}[Z(t(\theta))]
\log q(z)
p(z|\theta)
q(z)
x
z
z_{t}z_{t+1}^{T}
z_{t}z_{t}^{T}
t(z)
\lambda_{\phi}(x)
z_{t}
z_{ti}^{2}
i
t(z)
\langle\lambda_{\phi}(x),\mathbb{E}_{q(z)}t(z)\rangle
2TD
T
D
q(z)
p(z|\theta)
\textnormal{KL}(q(z)\;\|\;p(z|\theta))=\sum_{m=1}^{M}\textnormal{KL}(q(z_{m})%
\;\|\;p(z_{m}|z_{<m},\theta))
q(z_{m})
p(z_{m}|z_{<m},\theta)
z_{>m}
q(k)q(z)
k
z
p(\theta)p(k|\theta)p(z|k,\theta)
\textnormal{KL}(q(z)\;\|\;p(z|k,\theta))
\textnormal{KL}(q(k)\;\|\;p(k|\theta))
q(z)
q(k)
p(k|\theta)
p(k|\theta)
q(k)
\mathbb{E}_{q(\theta)}[t(\theta_{\textnormal{trans}})]\cdot\mathbb{E}_{q(z)}[t%
(z_{t-1},z_{t})]
k
t
-\hat{\mathcal{L}}[q(\theta)q(z),\phi]=\overbrace{\textnormal{KL}(q(\theta)\;%
\|\;p(\theta)))}^{\textnormal{Prior KL}}+\overbrace{\mathbb{E}_{q(\theta)}%
\textnormal{KL}(q(z)\;\|\;p(z|\theta))}^{\textnormal{Local KL}}-\langle\lambda%
_{\phi}(x),\mathbb{E}_{q(z)}t(z)\rangle
\eta
\mu_{\eta}=\mathbb{E}_{q(\theta;\eta)}[t(\theta)]
\frac{\partial\mathcal{L}}{\partial\eta}=\frac{\partial\mathcal{L}}{\partial%
\mu_{\eta}}\frac{\partial\mu_{\eta}}{\partial\eta}+\frac{\partial\mathcal{L}}{%
\partial\eta}_{\texttt{detach}(\mu_{\eta})}
\frac{\partial\mathcal{L}}{\partial\eta}_{\texttt{detach}(\mu_{\eta})}
\eta
\mu_{\eta}
\eta
\mu_{\eta}
\frac{\partial\mathcal{L}}{\partial\eta}_{\texttt{detach}(\mu_{\eta})}=0
q(z)
\eta
\mu_{\eta}
q(\theta)
p(z|\theta)
q(\theta)
\eta
\eta_{0}
p(\theta)
\textnormal{KL}(q(\theta)\;\|\;p(\theta))=\langle\eta-\eta_{0},\mu_{\eta}%
\rangle-\log Z(\eta)+\log Z(\eta_{0})
\displaystyle\frac{\partial}{\partial\eta}\textnormal{KL}(q(\theta)\;\|\;p(%
\theta))=\frac{\partial\textnormal{KL}(q(\theta)\;\|\;p(\theta))}{\partial\mu_%
{\eta}}\frac{\partial\mu_{\eta}}{\partial\eta}+\mu_{\eta}-\frac{\partial}{%
\partial\eta}\log Z(\eta)
\displaystyle\frac{\partial}{\partial\eta}\textnormal{KL}(q(\theta)\;\|\;p(%
\theta))
\displaystyle=\frac{\partial\textnormal{KL}(q(\theta)\;\|\;p(\theta))}{%
\partial\mu_{\eta}}\frac{\partial\mu_{\eta}}{\partial\eta}+\mu_{\eta}-\frac{%
\partial}{\partial\eta}\log Z(\eta)
\displaystyle=\frac{\partial\textnormal{KL}(q(\theta)\;\|\;p(\theta))}{%
\partial\mu_{\eta}}\frac{\partial\mu_{\eta}}{\partial\eta}=(\eta-\eta_{0})%
\frac{\partial\mu_{\eta}}{\partial\eta}
\displaystyle=\frac{\partial\textnormal{KL}(q(\theta)\;\|\;p(\theta))}{%
\partial\mu_{\eta}}\frac{\partial\mu_{\eta}}{\partial\eta}=(\eta-\eta_{0})%
\frac{\partial\mu_{\eta}}{\partial\eta}
\eta
\mu_{\eta}
\frac{\partial\mathcal{L}}{\partial\eta}=\frac{\partial\mathcal{L}}{\partial%
\mu_{\eta}}\frac{\partial\mu_{\eta}}{\partial\eta}
\frac{\partial\mu_{\eta}}{\partial\eta}
\eta\rightarrow\mu_{\eta}
q(\theta;\eta)
\eta
\eta
F_{\eta}=\mathbb{E}_{q(\theta)}\bigg{[}\bigg{(}\frac{\partial\log q(\theta)}{%
\partial\eta}\bigg{)}^{T}\cdot\bigg{(}\frac{\partial\log q(\theta)}{\partial%
\eta}\bigg{)}\bigg{]}
\frac{\partial\log q(\theta)}{\partial\eta}=t(\theta)-\mathbb{E}_{q(\theta)}[t%
(\theta)]
q(\theta)
\displaystyle F_{\eta}=\mathbb{E}_{q(\theta)}\big{[}(t(\theta)-\mathbb{E}_{q(%
\theta)}[t(\theta)])^{T}\cdot(t(\theta)-\mathbb{E}_{q(\theta)}[t(\theta)])\big%
{]}
\displaystyle F_{\eta}
\displaystyle=\mathbb{E}_{q(\theta)}\big{[}(t(\theta)-\mathbb{E}_{q(\theta)}[t%
(\theta)])^{T}\cdot(t(\theta)-\mathbb{E}_{q(\theta)}[t(\theta)])\big{]}
\displaystyle=\textnormal{Var}_{q(\theta)}[t(\theta)]
\displaystyle=\textnormal{Var}_{q(\theta)}[t(\theta)]
\textnormal{Var}_{q(\theta)}[t(\theta)]=\frac{\partial^{2}}{\partial\eta^{2}}%
\log Z(\eta)=\frac{\partial}{\partial\eta}\mathbb{E}_{q(\theta)}[t(\theta)]
F_{\eta}=\frac{\partial\mu_{\eta}}{\partial\eta}
\eta=f(\tilde{\eta})
\tilde{\eta}
f
\displaystyle F_{\tilde{\eta}}=\mathbb{E}_{q(\theta)}\bigg{[}\bigg{(}\frac{%
\partial\log q(\theta)}{\partial\tilde{\eta}}\bigg{)}^{T}\cdot\bigg{(}\frac{%
\partial\log q(\theta)}{\partial\tilde{\eta}}\bigg{)}\bigg{]}
\displaystyle F_{\tilde{\eta}}
\displaystyle=\mathbb{E}_{q(\theta)}\bigg{[}\bigg{(}\frac{\partial\log q(%
\theta)}{\partial\tilde{\eta}}\bigg{)}^{T}\cdot\bigg{(}\frac{\partial\log q(%
\theta)}{\partial\tilde{\eta}}\bigg{)}\bigg{]}
\displaystyle=\mathbb{E}_{q(\theta)}\bigg{[}\bigg{(}\frac{\partial\log q(%
\theta)}{\partial\eta}\cdot\frac{\partial{\eta}}{\partial\tilde{\eta}}\bigg{)}%
^{T}\cdot\bigg{(}\frac{\partial\log q(\theta)}{\partial\eta}\cdot\frac{%
\partial\eta}{\partial\tilde{\eta}}\bigg{)}\bigg{]}
\displaystyle=\mathbb{E}_{q(\theta)}\bigg{[}\bigg{(}\frac{\partial\log q(%
\theta)}{\partial\eta}\cdot\frac{\partial{\eta}}{\partial\tilde{\eta}}\bigg{)}%
^{T}\cdot\bigg{(}\frac{\partial\log q(\theta)}{\partial\eta}\cdot\frac{%
\partial\eta}{\partial\tilde{\eta}}\bigg{)}\bigg{]}
\displaystyle=\frac{\partial{\eta}}{\partial\tilde{\eta}}^{T}\cdot\mathbb{E}_{%
q(\theta)}\bigg{[}\bigg{(}\frac{\partial\log q(\theta)}{\partial\eta}\bigg{)}^%
{T}\cdot\bigg{(}\frac{\partial\log q(\theta)}{\partial\eta}\bigg{)}\bigg{]}%
\cdot\frac{\partial\eta}{\partial\tilde{\eta}}
\displaystyle=\frac{\partial{\eta}}{\partial\tilde{\eta}}^{T}\cdot\mathbb{E}_{%
q(\theta)}\bigg{[}\bigg{(}\frac{\partial\log q(\theta)}{\partial\eta}\bigg{)}^%
{T}\cdot\bigg{(}\frac{\partial\log q(\theta)}{\partial\eta}\bigg{)}\bigg{]}%
\cdot\frac{\partial\eta}{\partial\tilde{\eta}}
\displaystyle=\frac{\partial{\eta}}{\partial\tilde{\eta}}^{T}\cdot F_{\eta}%
\cdot\frac{\partial\eta}{\partial\tilde{\eta}}
\displaystyle=\frac{\partial{\eta}}{\partial\tilde{\eta}}^{T}\cdot F_{\eta}%
\cdot\frac{\partial\eta}{\partial\tilde{\eta}}
\frac{\partial\mathcal{L}}{\partial\tilde{\eta}}F_{\tilde{\eta}}^{-1}=\bigg{(}%
\frac{\partial\mathcal{L}}{\partial\mu}\cdot\frac{\partial\mu}{\partial\eta}%
\cdot\frac{\partial\eta}{\partial\tilde{\eta}}\bigg{)}\cdot\bigg{(}\frac{%
\partial\eta}{\partial\tilde{\eta}}^{-1}\cdot F_{\eta}^{-1}\cdot\frac{\partial%
\eta}{\partial\tilde{\eta}}^{-T}\bigg{)}=\frac{\partial\mathcal{L}}{\partial%
\mu}\cdot\frac{\partial\eta}{\partial\tilde{\eta}}^{-T}=\bigg{(}\frac{\partial%
\tilde{\eta}}{\partial\eta}\cdot\nabla_{\mu}\mathcal{L}\bigg{)}^{T}
\tilde{\eta}\rightarrow\eta
p(x;\eta)=\exp\{\langle\eta,t(x)\rangle-\log Z(\eta)\}
\eta
t(x)
\mathbb{E}_{p(x;\eta)}[t(x)]
\log Z(\eta)
n\times n
\eta=\begin{bmatrix}\phantom{2\cdot}S_{ii}|i=1,\dots,n\\
2\cdot S_{ij}|i<j\phantom{,\dots,n}\end{bmatrix}\qquad t(x)=\begin{bmatrix}%
\phantom{x_{i}}x_{i}^{2}|i=1,\dots,n\\
x_{i}x_{j}|i<j\phantom{,\dots,n}\end{bmatrix}
\langle\eta,t(x)\rangle=\sum_{i=1}^{n}\sum_{j=1}^{n}S_{ij}x_{i}x_{j}
S\otimes xx^{T}
x
x_{i}
\eta=\begin{bmatrix}S\end{bmatrix}\qquad t(x)=\begin{bmatrix}xx^{T}\end{bmatrix}
\tilde{\eta}\rightarrow\eta
\mathbb{R}^{n}
n
\mathbb{R}^{n\times m}
n\times m
\mathbb{R}_{+}^{n}
n
\eta=\texttt{Softplus}(\tilde{\eta})
\mathbb{R}_{>m}^{n}
n
m
\eta=\texttt{Softplus}(\tilde{\eta})
\Delta^{n-1}
n
\eta=\texttt{Softmax}(\tilde{\eta})
S_{++}^{n}
n\times n
\tilde{\eta}
S=\texttt{diag}(\sigma)\cdot R\cdot\texttt{diag}(\sigma)
\sigma\in\mathbb{R}_{+}^{n}
R
x\sim\mathcal{N}(\mu,\Sigma)
x,\mu\in\mathbb{R}^{n}
\Sigma\in S_{++}^{n}
p(x;\mu,\Sigma)
\eta=\begin{bmatrix}\Sigma^{-1}\mu\\
-\frac{1}{2}\Sigma^{-1}\end{bmatrix}\qquad t(x)=\begin{bmatrix}x\\
xx^{T}\end{bmatrix}\qquad\mathbb{E}_{p(x;\mu,\Sigma)}[t(x)]=\begin{bmatrix}\mu%
\\
\mu\mu^{T}+\Sigma\\
\end{bmatrix}
\log Z(\eta)=\frac{1}{2}\mu^{T}\Sigma^{-1}\mu+\frac{1}{2}\log|\Sigma|+\frac{n}%
{2}\log(2\pi)
\pi\approx 3.14
\mu,\Sigma\sim\textnormal{NIW}(S,m,\lambda,\nu)
\mu,m\in\mathbb{R}^{n}
\Sigma,S\in S_{++}^{n}
\lambda\in\mathbb{R}_{+}
\nu\in\mathbb{R}_{>{n-1}}
p(\mu,\Sigma;S,m,\lambda,\nu)
\eta=\begin{bmatrix}S+\lambda mm^{T}\\
\lambda m\\
\lambda\\
\nu+n+2\end{bmatrix}\qquad t(\mu,\Sigma)=\begin{bmatrix}-\frac{1}{2}\Sigma^{-1%
}\\
\Sigma^{-1}\mu\\
-\frac{1}{2}\mu^{T}\Sigma^{-1}\mu\\
-\frac{1}{2}\log|\Sigma|\end{bmatrix}\qquad\mathbb{E}[t(\mu,\Sigma)]=\begin{%
bmatrix}-\frac{1}{2}\nu S^{-1}\\
\nu S^{-1}m\\
-\frac{1}{2}(n/\lambda+\nu m^{T}S^{-1}m)\\
\frac{1}{2}(n\log 2-\log|S|+\Sigma_{i=0}^{n-1}\psi(\frac{\nu-i}{2}))\end{bmatrix}
\psi
\log Z(\eta)=\frac{\nu}{2}\cdot(n\log 2-\log|S|)+\log\Gamma_{n}\Big{(}\frac{%
\nu}{2}\Big{)}+\frac{n}{2}(\log(2\pi)-\log\lambda)
\Gamma_{n}
X,\Sigma\sim\textnormal{MNIW}(S,M,V,\nu)
X,M\in\mathbb{R}^{n\times m}
\Sigma,S\in S_{++}^{n}
V\in S_{++}^{m}
\nu\in\mathbb{R}_{>{n-1}}
p(X,\Sigma;S,M,V,\nu)
\eta=\begin{bmatrix}S+MVM^{T}\\
MV\\
V\\
\nu+n+m+1\end{bmatrix}\hskip 11.38109ptt(X,\Sigma)=\begin{bmatrix}-\frac{1}{2}%
\Sigma^{-1}\\
\Sigma^{-1}X\\
-\frac{1}{2}X^{T}\Sigma^{-1}X\\
-\frac{1}{2}\log|\Sigma|\end{bmatrix}\hskip 11.38109pt\mathbb{E}[t(X,\Sigma)]=%
\begin{bmatrix}-\frac{1}{2}\nu S^{-1}\\
\nu S^{-1}M\\
-\frac{1}{2}(nV^{-1}+\nu M^{T}S^{-1}M)\\
n\log 2-\log|S|+\Sigma_{i=0}^{n-1}\psi(\frac{\nu-i}{2})\end{bmatrix}
\psi
\log Z(\eta)=\frac{\nu}{2}\cdot(n\log 2-\log|S|)+\log\Gamma_{n}\Big{(}\frac{%
\nu}{2}\Big{)}-\frac{n}{2}|V|+\frac{n\cdot m}{2}\log(2\pi)
\Gamma_{n}
X\in\mathbb{R}^{n\times n+1}=[A|b]
z_{t+1}\sim\mathcal{N}(Az_{t}+b,\Sigma)
