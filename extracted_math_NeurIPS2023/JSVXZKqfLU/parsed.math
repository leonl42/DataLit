\beta
\beta=1.0
\beta=0
\beta\approx 2
\beta=0.5
L_{2}
\mathcal{M=(S,A,P,\mathit{r},\gamma)}
\mathcal{S}
\mathcal{A}
\mathcal{P:S\times A\times S}\rightarrow[0,1]
\mathcal{P}(s^{\prime}|s,a)
s^{\prime}
s
a
\pi:S\rightarrow A
\mathcal{\mathit{r}}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
\mathcal{R}_{t}=\mathbb{E}[\sum_{k=0}^{\mathit{t}}\gamma^{k}\mathcal{\mathit{r%
}}_{t+k+1}]
t
\gamma\in\left[0,1\right]
\mathit{r_{t}}
\mathcal{\mathit{r_{t}^{\text{e}}}}
\mathcal{\mathit{r_{t}^{\text{i}}}}
f_{\theta}
\phi(s_{t})=f_{\theta}(s_{t})
\theta
g_{\theta}
\phi(s_{t})
\phi(s_{t+1})
g_{\theta}
\hat{a}_{t}
\hat{a}_{t}=g(\phi(s_{t}),\phi(s_{t+1}))
g_{\theta}
L_{I}=CrossEntropy(\hat{a}_{t},a_{t})
\hat{a}_{t}
a_{t}
h
\phi(s_{t})
a_{t}
h
\hat{\phi}(s_{t+1})
\hat{\phi}(s_{t+1})=h(\phi(s_{t}),a_{t})
g_{\theta}
L_{F}=||\hat{\phi}(s_{t+1})-\phi(s_{t+1})||_{2}^{2}
\hat{\phi}(s_{t+1})
\phi(s_{t+1})
\phi(s_{t})
\phi(s_{t+1})
f_{\theta}
g_{\theta}
r^{\text{i}}_{t}
\hat{\phi}(s_{t+1})
\phi(s_{t+1})
\varepsilon_{t+1}
z_{t+1}
\phi(s_{t})
\phi(s_{t+1})
f_{\theta}
g_{\theta}
r^{\text{i}}_{t}
\hat{\phi}(s_{t+1})
\phi(s_{t+1})
\varepsilon_{t+1}
z_{t+1}
f_{\theta}
s_{t}
s_{t+1}
f_{\theta}
\phi(s_{t})
\phi(s_{t+1})
g_{\theta}
\displaystyle\hat{a}_{t}=g_{\theta}(\phi(s_{t}),\phi(s_{t+1})),
\displaystyle\hat{a}_{t}=g_{\theta}(\phi(s_{t}),\phi(s_{t+1})),
\hat{a}_{t}
L_{I}
\displaystyle L_{I}=CrossEntropy(\hat{a}_{t},a_{t}).
\displaystyle L_{I}=CrossEntropy(\hat{a}_{t},a_{t}).
\phi(s_{t+1})
\hat{\phi}(s_{t+1})
\phi(s_{t+1})
\phi(s_{t+1})
a_{t}
q_{\lambda}
y
\displaystyle q_{\lambda}(z_{t+1}|\textbf{x},y):=q_{\lambda}(z_{t+1}|\phi(s_{t%
+1}),a_{t}),\quad z_{t+1}\sim\mathcal{N}(\mu_{t+1},\sigma_{t+1}),
\displaystyle q_{\lambda}(z_{t+1}|\textbf{x},y):=q_{\lambda}(z_{t+1}|\phi(s_{t%
+1}),a_{t}),\quad z_{t+1}\sim\mathcal{N}(\mu_{t+1},\sigma_{t+1}),
z_{t+1}
\mu_{t+1}
\sigma^{2}_{t+1}
q_{\lambda}
z_{t+1}
a_{t}
p_{\psi}
\hat{\phi}(s_{t+1})
\displaystyle p_{\psi}(\hat{\phi}(s_{t+1})|z_{t+1},a_{t}).
\displaystyle p_{\psi}(\hat{\phi}(s_{t+1})|z_{t+1},a_{t}).
r^{\text{i}}_{t}
L_{2}
\hat{\phi}(s_{t+1})
\phi(s_{t+1})
\displaystyle r^{\text{i}}_{t}=\lVert\hat{\phi}(s_{t+1})-\phi(s_{t+1})\rVert_{%
2}.
\displaystyle r^{\text{i}}_{t}=\lVert\hat{\phi}(s_{t+1})-\phi(s_{t+1})\rVert_{%
2}.
p_{\psi}
\hat{\phi}(s_{t+1})
a_{t}
q_{\lambda}
p_{\psi}
L_{recon}
L_{KL}
\displaystyle L_{recon}=BinaryCrossEntropy(\hat{\phi}(s_{t+1}),\phi(s_{t+1})).
\displaystyle L_{recon}=BinaryCrossEntropy(\hat{\phi}(s_{t+1}),\phi(s_{t+1})).
\displaystyle L_{KL}=KL(q_{\lambda}(z_{t+1}|\phi(s_{t+1}),a_{t})||p_{\psi}(z_{%
t+1}|\phi(s_{t+1}))).
\displaystyle L_{KL}=KL(q_{\lambda}(z_{t+1}|\phi(s_{t+1}),a_{t})||p_{\psi}(z_{%
t+1}|\phi(s_{t+1}))).
z_{t+1}\sim\mathcal{N}(\mu_{t+1},\sigma_{t+1})
\displaystyle z_{t+1}=\mu_{t+1}+\varepsilon_{t+1}\sigma_{t+1},
\displaystyle z_{t+1}=\mu_{t+1}+\varepsilon_{t+1}\sigma_{t+1},
\varepsilon_{t+1}
\varepsilon_{(1:t)}=(\varepsilon_{1},\cdots,\varepsilon_{i},\cdots,\varepsilon%
_{t})
\varepsilon_{i},\varepsilon_{j}\in\varepsilon_{(1:t)}
\beta=0
|\hat{\varepsilon}_{(1:t)}(f)^{2}|
\hat{\varepsilon}_{(1:t)}(f)
\varepsilon_{(1:t)}
\varepsilon_{(1:t)}
\beta
|\hat{\varepsilon}_{(1:t)}(f)^{2}|\propto f^{-\beta}
\beta
\varepsilon_{(1:t)}
\beta>0
\varepsilon_{i},\varepsilon_{j}\in\varepsilon_{(1:t)}
\beta<0
\varepsilon_{i},\varepsilon_{j}\in\varepsilon_{(1:t)}
\varepsilon_{t+1}
z_{t+1}
\hat{\phi}(s_{t+1})
p_{\psi}
z_{t+1}
a_{t}
\hat{\phi}(s_{(1:t)})=(\hat{\phi}(s_{1}),\cdots,\hat{\phi}(s_{t}))
\beta
\beta\neq 0
\beta<0
\beta\geq 0
\beta>0
\beta\leq 0
\beta<0
\beta>0
\beta>0
\beta<0
\beta
\beta
\beta
\varepsilon_{(1:t)}
\beta=-1.0
\beta=2.0
N\times N
SXRY
X
Y
SXNY
X
Y
\beta
\beta
8\times 8
8\times 8
16\times 16
16\times 16
8\times 8
8\times 8
16\times 16
16\times 16
8\times 8
8\times 8
16\times 16
16\times 16
\beta
\beta\in\left\{-1.0~{}\text{(blue noise)},0~{}\text{(white noise)},0.5,1.0~{}%
\text{(pink noise)},2.0~{}\text{(red noise)}\right\}
\varepsilon_{(1:t)}
\beta
\beta
\beta=-1.0
\beta=0
\beta=2.0
\beta=2.0
16\times 16
8\times 8
\beta=0
\beta=2.0
\beta=-1.0
\beta=-1.0
\beta=2.0
\beta=0
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
\beta=2.0
\beta=-1.0
\beta=-1.0
\beta
16\times 16
16\times 16
16\times 16
\beta=2.0
\beta=-1.0
\beta=-1.0
\beta
8\times 8
8\times 8
16\times 16
16\times 16
8\times 8
8\times 8
8\times 8
8\times 8
16\times 16
16\times 16
16\times 16
16\times 16
\beta=2.0
\beta=2.0
\beta=2.0
\beta=-1.0
16\times 16
16\times 16
16\times 16
\beta=2.0
\beta=-1.0
\beta=-1.0
\beta=2.0
\beta=-1.0
16\times 16
\beta=2.0
\beta=-1.0
\beta
\beta
8\times 8
\beta=-1.0
\beta=2.0
8\times 8
16\times 16
\beta=2.0
\beta=-1.0
\beta=2.0
8\times 8
16\times 16
8\times 8
8\times 8
16\times 16
16\times 16
8\times 8
8\times 8
16\times 16
16\times 16
\beta=2.0
\beta=-1.0
8\times 8
8\times 8
\beta=2.0
\beta=-1.0
8\times 8
\beta=-1.0
8\times 8
\beta=2.0
\beta=-1.0
16\times 16
\beta=2.0
\beta=2.0
\beta=-1.0
\beta=2.0
\beta=-1.0
\beta=2.0
\beta=-1.0
\beta=2.0
\beta=-1.0
\beta=-1.0
\beta=2.0
8\times 8
8\times 8
16\times 16
16\times 16
\times
\times
8\times 8
16\times 16
\hat{x}
x
q_{\lambda}
p_{\psi}
q_{\lambda}
x
z
p_{\psi}
\hat{x}
z
X=\{x_{1},...,x_{N}\}
N
x\in X
z
P(x,z)
x\in X
\log P(x)=\sum_{i=1}^{N}\log P(x_{i}).
q_{\lambda}(z|x)
L_{\lambda,\psi}=E_{P(z|x)}[\log q_{\lambda}(x|z)]-KL(q_{\lambda}(z|x)||p_{%
\psi}(z))).
q_{\lambda}(z|x)
E_{P(z|x)}[\log q_{\lambda}(x|z)]
\hat{x}
z
q_{\lambda}(z|x)
KL(q_{\lambda}(z|x)||p_{\psi}(z)))
q_{\lambda}(z|x)
p_{\psi}(z)
s
a
L_{\lambda,\psi}=E_{P(z|s,a)}[\log q_{\lambda}(a|s,z)]-KL(q_{\lambda}(z|s,a)||%
p_{\psi}(z|s)).
\beta
\beta
\varepsilon_{(1:t)}
t=1000
\beta
\beta<0
\beta
\beta>0
\beta
\beta
\beta
\beta=0
\beta=0
\beta
\beta
\beta
\beta
\beta
N\text{ := Number of rollouts}
N_{update}\text{ := Number of update steps,}
K\text{ := Length of a rollout}
B_{i}\text{ := Batch in }i\text{-th rollout}
R^{I}_{i}\text{ := Intrinsic return in }i\text{-th rollout}
A^{I}_{i}\text{ := Intrinsic advantage in }i\text{-th rollout}
R^{E}_{i}\text{ := Extrinsic return in }i\text{-th rollout}
A^{E}_{i}\text{ := Extrinsic advantage in }i\text{-th rollout}
\beta\text{ := Color parameter}
f_{\theta}\text{ := Embedding network}
g_{\theta}\text{ := Inverse network}
q_{\lambda}\text{ := Encoder}
p_{\psi}\text{ := Decoder}
L_{recon}\text{ := Reconstruction loss}
L_{KL}\text{ := KL divergence loss}
L_{PPO}\text{ := PPO loss}
L_{I}\text{ := Inverse loss}
t\leftarrow 1
s_{1}\sim p(\emptyset)
i=1
N
\varepsilon_{(1:K)}\leftarrow
K,\beta
K
\beta
j=1
K
a_{t}\sim\pi(a_{t}|s_{t})
a_{t}
s_{t+1},r^{\text{e}}_{t}\sim p(s_{t+1},r^{\text{e}}_{t}|s_{t},a_{t})
\phi(s_{t+1})\sim f_{\theta}(s_{t+1})
f_{\theta}
\hat{\phi}(s_{t+1})\sim p_{\psi}(q_{\lambda}({\phi}(s_{t+1}),a_{t}),a_{t})
\hat{\phi}(s_{t+1})
\varepsilon_{t+1}
r^{\text{i}}_{t}\leftarrow\lVert\hat{\phi}(s_{t+1})-\phi(s_{t+1})\rVert_{2}
B_{i}\leftarrow\{s_{t},s_{t+1},a_{t},r^{\text{e}}_{t},r^{\text{i}}_{t},\,\hat{%
\phi}(s_{t+1}),\phi(s_{t+1})\}\cup B_{i}
B_{i}
t\leftarrow t+1
r^{\text{i}}_{i}\leftarrow\text{Normalize}(B_{i})
B_{i}
A^{I}_{i}\leftarrow\text{Intrinsic\_Advantage\_Return($B_{i}$)}
B_{i}
R^{I}_{i}\leftarrow\text{Intrinsic\_Return($B_{i}$)}
B_{i}
A^{E}_{i}\leftarrow\text{Extrinsic\_Advantage\_Return($B_{i}$)}
B_{i}
R^{E}_{i}\leftarrow\text{Extrinsic\_Return($B_{i}$)}
B_{i}
A_{i}\leftarrow A^{I}_{i}+A^{E}_{i}
R_{i}\leftarrow R^{I}_{i}+R^{E}_{i}
j=1
N_{update}
\pi\leftarrow\text{Update($\pi,L_{PPO}(B_{i},R_{i},A_{i})$)}
\pi,L_{PPO}(B_{i},R_{i},A_{i})
L_{PPO}
f_{\theta},g_{\theta}\leftarrow
f_{\theta},g_{\theta},L_{I}(B_{i})
L_{I}
q_{\lambda},p_{\psi}\leftarrow
q_{\lambda},p_{\psi},L_{recon,KL}(B_{i})
L_{recon}
L_{KL}
8\times 8
16\times 16
8\times 8
16\times 16
84\times 84
x\mapsto x/255
\left\{1,3,5\right\}
\lambda
8\times 8
4\times 4
3\times 3
3\times 3
1\times 1
2\times 2
3\times 3
\beta\in\{-1.0,0.0,0.5,1.0,2.0\}
\beta
\beta
\beta\neq 0
\beta=0
16\times 16
\beta
8\times 8
8\times 8
8\times 8
8\times 8
8\times 8
8\times 8
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
\beta
\beta=2.0
\beta=-1.0
\beta=-1.0
8\times 8
8\times 8
8\times 8
8\times 8
8\times 8
8\times 8
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
16\times 16
\beta
\beta
16\times 16
\beta>0
\beta<0
\beta=0
\beta=2.0
\beta=-1.0
16\times 16
16\times 16
\beta
\beta
16\times 16
\beta>0
\beta<0
\beta=0
\beta=2.0
\beta=-1.0
\beta
\beta>0
\beta<0
\beta>0
\beta=2.0
\beta<0
\beta<0
\beta
\beta
\beta\neq 0
\beta=0
\beta=2.0
\beta=-1.0
\beta=0
\beta=1.0
\beta=2.0
\beta=-1.0
\beta=1.0
\beta
\beta
\beta=2.0
\beta=-1.0
\beta=2.0
\beta=-1.0
8\times 8
16\times 16
8\times 8
8\times 8
16\times 16
16\times 16
8\times 8
8\times 8
16\times 16
16\times 16
