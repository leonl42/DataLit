k(x,x^{\prime})=k(x+a,x^{\prime}+a)
\tau=x-x^{\prime}
x
\tau
f(x)
\displaystyle f(x)\sim\mathcal{GP}(m(x),k(x,x^{\prime})),
\displaystyle f(x)\sim\mathcal{GP}(m(x),k(x,x^{\prime})),
m(x)
\mathbf{E}[f(x)]=m(x)
k(x,x^{\prime})
\operatorname{\textbf{cov}}[f(x),f(x^{\prime})]=k(x,x^{\prime})
x
x^{\prime}
x_{1},\ldots,x_{N}
f_{i}=f(x_{i})
\displaystyle\begin{pmatrix}f_{1},&\ldots,&f_{N}\end{pmatrix}^{T}\sim\mathcal{%
N}(\boldsymbol{m},\mathbf{K})\,,
\displaystyle\begin{pmatrix}f_{1},&\ldots,&f_{N}\end{pmatrix}^{T}\sim\mathcal{%
N}(\boldsymbol{m},\mathbf{K})\,,
\mathbf{K}
\mathbf{K}_{ij}=k(x_{i},x_{j})
\boldsymbol{m}
m_{i}=m(x_{i})
k(x,x^{\prime})
\displaystyle k_{\text{RBF}}(x,x^{\prime})=\sigma_{f}^{2}\exp\left(-\frac{(x-x%
^{\prime})^{2}}{2\ell^{2}}\right)\,,
\displaystyle k_{\text{RBF}}(x,x^{\prime})=\sigma_{f}^{2}\exp\left(-\frac{(x-x%
^{\prime})^{2}}{2\ell^{2}}\right)\,,
\sigma_{f}
\ell
\tau=x-x^{\prime}
m(x)
m(x)\equiv 0
k(\tau)=k(x-x^{\prime})=k(x,x^{\prime})
k
S
\displaystyle k(\tau)=\int S(s)e^{2\pi is\tau}ds
\displaystyle k(\tau)
\displaystyle=\int S(s)e^{2\pi is\tau}ds
\displaystyle S(s)=\int k(\tau)e^{-2\pi is\tau}d\tau\,.
\displaystyle S(s)
\displaystyle=\int k(\tau)e^{-2\pi is\tau}d\tau\,.
S(s)=\sum_{i}\delta(s-s_{i})
k_{\text{SS}}(\tau)=\frac{1}{Q}\sum_{i=1}^{Q}\cos(2\pi s_{i}^{T}\tau)
\displaystyle S_{\text{SM}}(s)=\sum_{i}w_{i}^{2}[\mathcal{N}(s|\mu_{i},\sigma_%
{i}^{2})+\mathcal{N}(s|-\mu_{i},\sigma_{i}^{2})]/2\,,
\displaystyle S_{\text{SM}}(s)=\sum_{i}w_{i}^{2}[\mathcal{N}(s|\mu_{i},\sigma_%
{i}^{2})+\mathcal{N}(s|-\mu_{i},\sigma_{i}^{2})]/2\,,
\displaystyle k_{\text{SM}}(\tau)=\sum_{i}w_{i}^{2}\exp(-2\pi^{2}\sigma_{i}^{2%
}\tau)\cos(2\pi\mu_{i}\tau)\,.
\displaystyle k_{\text{SM}}(\tau)=\sum_{i}w_{i}^{2}\exp(-2\pi^{2}\sigma_{i}^{2%
}\tau)\cos(2\pi\mu_{i}\tau)\,.
\mu
\ell
w
x
\displaystyle\log w_{i}(x)\sim\mathcal{GP}(0,k_{w}(x,x^{\prime})),
\displaystyle\log w_{i}(x)\sim\mathcal{GP}(0,k_{w}(x,x^{\prime})),
\displaystyle\log\ell_{i}(x)\sim\mathcal{GP}(0,k_{\ell}(x,x^{\prime})),
\displaystyle\log\ell_{i}(x)\sim\mathcal{GP}(0,k_{\ell}(x,x^{\prime})),
\displaystyle\operatorname{logit}\mu_{i}(x)\sim\mathcal{GP}(0,k_{\mu}(x,x^{%
\prime})).
\displaystyle\operatorname{logit}\mu_{i}(x)\sim\mathcal{GP}(0,k_{\mu}(x,x^{%
\prime})).
w(x)
\ell(x)
\operatorname{logit}\mu(x)=\log\frac{\mu}{F_{N}-\mu}
F_{N}
[-1,1]
x
S(s,x)=\sum_{q}w_{q}^{2}(x)\mathcal{N}(s\mid\mu_{q}(x),\ell_{q}^{-2}(x))
[-1,1]
x
S(s,x)=\sum_{q}w_{q}^{2}(x)\mathcal{N}(s\mid\mu_{q}(x),\ell_{q}^{-2}(x))
\displaystyle k_{\text{Gibbs},i}(x,x^{\prime})=\sqrt{\frac{2\ell_{i}(x)\ell_{i%
}(x^{\prime})}{\ell_{i}(x)^{2}+\ell_{i}(x^{\prime})^{2}}}\exp\left(-\frac{(x-x%
^{\prime})^{2}}{\ell_{i}(x)^{2}+\ell_{i}(x^{\prime})^{2}}\right)\;,
\displaystyle k_{\text{Gibbs},i}(x,x^{\prime})=\sqrt{\frac{2\ell_{i}(x)\ell_{i%
}(x^{\prime})}{\ell_{i}(x)^{2}+\ell_{i}(x^{\prime})^{2}}}\exp\left(-\frac{(x-x%
^{\prime})^{2}}{\ell_{i}(x)^{2}+\ell_{i}(x^{\prime})^{2}}\right)\;,
\displaystyle k_{\text{GSM}}(x,x^{\prime})=\sum_{i=1}^{Q}w_{i}(x)w_{i}(x^{%
\prime})k_{\text{Gibbs},i}(x,x^{\prime})\cos(2\pi(\mu_{i}(x)x-\mu_{i}(x^{%
\prime})x^{\prime}))\;.
\displaystyle k_{\text{GSM}}(x,x^{\prime})=\sum_{i=1}^{Q}w_{i}(x)w_{i}(x^{%
\prime})k_{\text{Gibbs},i}(x,x^{\prime})\cos(2\pi(\mu_{i}(x)x-\mu_{i}(x^{%
\prime})x^{\prime}))\;.
w(x)w(x^{\prime})
\mu(x),\mu(x^{\prime})
\ell(x),\ell(x^{\prime})
\displaystyle\mathbf{h}_{1}=a(\mathbf{W}_{1}x+\mathbf{b}_{1})
\displaystyle\mathbf{h}_{1}
\displaystyle=a(\mathbf{W}_{1}x+\mathbf{b}_{1})
\displaystyle\mathbf{y}=a(\mathbf{W}_{2}\mathbf{h}_{1}+\mathbf{b}_{2})
\displaystyle\mathbf{y}
\displaystyle=a(\mathbf{W}_{2}\mathbf{h}_{1}+\mathbf{b}_{2})
\mathbf{h}_{1}
x
\mathbf{y}
\mathbf{y}=\text{NN}(x)
\displaystyle\operatorname{softplus}(x)=\log(1+\exp(x))
\displaystyle\operatorname{softplus}(x)=\log(1+\exp(x))
\displaystyle\mathbf{w}(x)=\text{NN}_{w}(x)
\displaystyle\mathbf{w}(x)=\text{NN}_{w}(x)
\displaystyle\boldsymbol{\ell}(x)=\text{NN}_{\ell}(x)
\displaystyle\boldsymbol{\ell}(x)=\text{NN}_{\ell}(x)
\displaystyle\boldsymbol{\mu}(x)=\text{NN}_{\mu}(x)\,,
\displaystyle\boldsymbol{\mu}(x)=\text{NN}_{\mu}(x)\,,
Q
\mathbf{w}
\boldsymbol{\ell}
\boldsymbol{\mu}
\displaystyle k_{\text{GSM}}(x,x^{\prime})=\sum_{i=1}^{Q}w_{i}(x)w_{i}(x^{%
\prime})\sqrt{\frac{2\ell_{i}(x)\ell_{i}(x^{\prime})}{\ell_{i}(x)^{2}+\ell_{i}%
(x^{\prime})^{2}}}\exp\left(-\frac{(x-x^{\prime})^{2}}{\ell_{i}(x)^{2}+\ell_{i%
}(x^{\prime})^{2}}\right)
\displaystyle k_{\text{GSM}}(x,x^{\prime})=\sum_{i=1}^{Q}
\displaystyle w_{i}(x)w_{i}(x^{\prime})\sqrt{\frac{2\ell_{i}(x)\ell_{i}(x^{%
\prime})}{\ell_{i}(x)^{2}+\ell_{i}(x^{\prime})^{2}}}\exp\left(-\frac{(x-x^{%
\prime})^{2}}{\ell_{i}(x)^{2}+\ell_{i}(x^{\prime})^{2}}\right)
\displaystyle\times\cos\left(2\pi(\mu_{i}(x)x-\mu_{i}(x^{\prime})x^{\prime})\right)
\displaystyle\times\cos\left(2\pi(\mu_{i}(x)x-\mu_{i}(x^{\prime})x^{\prime})\right)
w_{i}(x),\mu_{i}(x),\ell_{i}(x)
\displaystyle k_{\text{SM}}(x,x^{\prime})=\sum_{i=1}^{Q}w_{i}^{2}\exp(-2\pi^{2%
}(x-x^{\prime})^{2}\sigma_{i}^{2})\cos(2\pi\mu_{i}(x-x^{\prime}))\,,
\displaystyle k_{\text{SM}}(x,x^{\prime})
\displaystyle=\sum_{i=1}^{Q}w_{i}^{2}\exp(-2\pi^{2}(x-x^{\prime})^{2}\sigma_{i%
}^{2})\cos(2\pi\mu_{i}(x-x^{\prime}))\,,
w_{i}
\mu_{i}
\sigma_{i}^{2}
\displaystyle w_{i}(x)\equiv w_{i},\qquad\mu_{i}(x)\equiv\mu_{i},\qquad\ell_{i%
}(x)\equiv\frac{1}{2\pi\sigma_{i}},
\displaystyle w_{i}(x)\equiv w_{i},\qquad\mu_{i}(x)\equiv\mu_{i},\qquad\ell_{i%
}(x)\equiv\frac{1}{2\pi\sigma_{i}},
\displaystyle k_{\text{GSM}}(x,x^{\prime})=\sum_{i=1}^{Q}w_{i}^{2}\sqrt{\frac{%
2/(2\pi\sigma_{i})^{2}}{2/(2\pi\sigma_{i})^{2}}}\exp\left(-\frac{(x-x^{\prime}%
)^{2}}{2(1/(2\pi\sigma_{i}))^{2}}\right)\cos(2\pi(\mu_{i}x-\mu_{i}x^{\prime}))
\displaystyle k_{\text{GSM}}(x,x^{\prime})
\displaystyle=\sum_{i=1}^{Q}w_{i}^{2}\sqrt{\frac{2/(2\pi\sigma_{i})^{2}}{2/(2%
\pi\sigma_{i})^{2}}}\exp\left(-\frac{(x-x^{\prime})^{2}}{2(1/(2\pi\sigma_{i}))%
^{2}}\right)\cos(2\pi(\mu_{i}x-\mu_{i}x^{\prime}))
\displaystyle=\sum_{i=1}^{Q}w_{i}^{2}\exp\left(-2\pi^{2}\sigma_{i}^{2}(x-x^{%
\prime})^{2}\right)\cos(2\pi\mu_{i}(x-x^{\prime}))=k_{\text{SM}}(x,x^{\prime}).
\displaystyle=\sum_{i=1}^{Q}w_{i}^{2}\exp\left(-2\pi^{2}\sigma_{i}^{2}(x-x^{%
\prime})^{2}\right)\cos(2\pi\mu_{i}(x-x^{\prime}))=k_{\text{SM}}(x,x^{\prime}).
k_{w},k_{\mu},k_{\ell}
\displaystyle k(x,x^{\prime})={\sigma}(x){\sigma}(x^{\prime})\sqrt{\frac{2\ell%
(x)\ell(x^{\prime})}{\ell(x)^{2}+\ell(x^{\prime})^{2}}}\exp\left(-\frac{(x-x^{%
\prime})^{2}}{\ell(x)^{2}+\ell(x^{\prime})^{2}}\right).
\displaystyle k(x,x^{\prime})={\sigma}(x){\sigma}(x^{\prime})\sqrt{\frac{2\ell%
(x)\ell(x^{\prime})}{\ell(x)^{2}+\ell(x^{\prime})^{2}}}\exp\left(-\frac{(x-x^{%
\prime})^{2}}{\ell(x)^{2}+\ell(x^{\prime})^{2}}\right).
Q=1
\mu(x)\equiv 0
\displaystyle C^{\text{NS}}(\mathbf{x}_{i},\mathbf{x}_{j})=|\Sigma_{i}|^{1/4}|%
\Sigma_{j}|^{1/4}|(\Sigma_{i}+\Sigma_{j})/2|^{-1/2}R^{\text{S}}(\sqrt{Q_{ij}})
\displaystyle C^{\text{NS}}(\mathbf{x}_{i},\mathbf{x}_{j})
\displaystyle=|\Sigma_{i}|^{1/4}|\Sigma_{j}|^{1/4}|(\Sigma_{i}+\Sigma_{j})/2|^%
{-1/2}R^{\text{S}}(\sqrt{Q_{ij}})
\displaystyle Q_{ij}=(\mathbf{x}_{i}-\mathbf{x}_{j})^{T}((\Sigma_{i}+\Sigma_{j%
})/2)^{-1}(\mathbf{x}_{i}-\mathbf{x}_{j})
\displaystyle Q_{ij}
\displaystyle=(\mathbf{x}_{i}-\mathbf{x}_{j})^{T}((\Sigma_{i}+\Sigma_{j})/2)^{%
-1}(\mathbf{x}_{i}-\mathbf{x}_{j})
R^{\text{S}}(\cdot)
\Sigma_{i}
\Sigma_{j}
N
(\mathbf{x}_{j},y_{j})_{j=1}^{N}
\mathbf{y}\in\mathbb{R}^{N}
\displaystyle y_{j}=f(\mathbf{x}_{j})+\varepsilon_{j},\qquad\varepsilon_{j}%
\sim\mathcal{N}(0,\sigma_{n}^{2})
\displaystyle y_{j}
\displaystyle=f(\mathbf{x}_{j})+\varepsilon_{j},\qquad\varepsilon_{j}\sim%
\mathcal{N}(0,\sigma_{n}^{2})
\displaystyle f(\mathbf{x})\sim\mathcal{GP}(0,k(\mathbf{x},\mathbf{x}^{\prime}%
\mid{\boldsymbol{\theta}})),
\displaystyle f(\mathbf{x})
\displaystyle\sim\mathcal{GP}(0,k(\mathbf{x},\mathbf{x}^{\prime}\mid{%
\boldsymbol{\theta}})),
\displaystyle p(\mathbf{y}\mid\mathbf{f})=\mathcal{N}(\mathbf{y}\mid\mathbf{f}%
,\sigma_{n}^{2}\boldsymbol{I})\,.
\displaystyle p(\mathbf{y}\mid\mathbf{f})=\mathcal{N}(\mathbf{y}\mid\mathbf{f}%
,\sigma_{n}^{2}\boldsymbol{I})\,.
{\boldsymbol{\theta}}
\mathbf{f}
\displaystyle\log p(\mathbf{y}\mid{\boldsymbol{\theta}})=\log\mathbf{E}_{p(%
\mathbf{f})}[p(\mathbf{y}\mid\mathbf{f})]
\displaystyle\log p(\mathbf{y}\mid{\boldsymbol{\theta}})=\log\mathbf{E}_{p(%
\mathbf{f})}[p(\mathbf{y}\mid\mathbf{f})]
\mathcal{O}(N^{3})
N\times N
\mathbf{K}
\mathbf{u}
\displaystyle p(\mathbf{y},\mathbf{f},\mathbf{u}\mid{\boldsymbol{\theta}})=p(%
\mathbf{y}\mid\mathbf{f})p(\mathbf{f}\mid\mathbf{u},{\boldsymbol{\theta}})p(%
\mathbf{u}\mid{\boldsymbol{\theta}})
\displaystyle p(\mathbf{y},\mathbf{f},\mathbf{u}\mid{\boldsymbol{\theta}})=p(%
\mathbf{y}\mid\mathbf{f})p(\mathbf{f}\mid\mathbf{u},{\boldsymbol{\theta}})p(%
\mathbf{u}\mid{\boldsymbol{\theta}})
\mathbf{u}
\mathbf{z}
\displaystyle p(\mathbf{u}\mid{\boldsymbol{\theta}})=\mathcal{N}(\mathbf{u}%
\mid 0,\mathbf{K}_{\mathbf{z}\mathbf{z}}),
\displaystyle p(\mathbf{u}\mid{\boldsymbol{\theta}})=\mathcal{N}(\mathbf{u}%
\mid 0,\mathbf{K}_{\mathbf{z}\mathbf{z}}),
\mathbf{K}_{\mathbf{z}\mathbf{z}}
{\boldsymbol{\theta}}
\mu(x)
\ell(x)
w(x)
p(\mathbf{u}\mid\mathbf{y})
q(\mathbf{u})=\mathcal{N}(\mathbf{u}\mid\boldsymbol{m},{\boldsymbol{S}})
\boldsymbol{m}
{\boldsymbol{S}}
\displaystyle\log p(\mathbf{y}\mid\mathbf{u})\geq\mathbf{E}_{p(\mathbf{f}\mid%
\mathbf{u})}[\log p(\mathbf{y}\mid\mathbf{f})].
\displaystyle\log p(\mathbf{y}\mid\mathbf{u})\geq\mathbf{E}_{p(\mathbf{f}\mid%
\mathbf{u})}[\log p(\mathbf{y}\mid\mathbf{f})].
\displaystyle\log p(\mathbf{y}\mid{\boldsymbol{\theta}})\geq\mathbf{E}_{q(%
\mathbf{u})}[\log p(\mathbf{y}\mid\mathbf{u},{\boldsymbol{\theta}})]-{%
\operatorname{KL}({q(\mathbf{u})}||{p(\mathbf{u}\mid{\boldsymbol{\theta}})})}
\displaystyle\log p(\mathbf{y}\mid{\boldsymbol{\theta}})\geq\mathbf{E}_{q(%
\mathbf{u})}[\log p(\mathbf{y}\mid\mathbf{u},{\boldsymbol{\theta}})]-{%
\operatorname{KL}({q(\mathbf{u})}||{p(\mathbf{u}\mid{\boldsymbol{\theta}})})}
q(\mathbf{u})
\displaystyle\log p(\mathbf{y}\mid{\boldsymbol{\theta}})\geq\mathbf{E}_{q(%
\mathbf{u})}[\log p(\mathbf{y}\mid\mathbf{u},{\boldsymbol{\theta}})]-{%
\operatorname{KL}({q(\mathbf{u})}||{p(\mathbf{u}\mid{\boldsymbol{\theta}})})}
\displaystyle\log p(\mathbf{y}\mid{\boldsymbol{\theta}})
\displaystyle\geq\mathbf{E}_{q(\mathbf{u})}[\log p(\mathbf{y}\mid\mathbf{u},{%
\boldsymbol{\theta}})]-{\operatorname{KL}({q(\mathbf{u})}||{p(\mathbf{u}\mid{%
\boldsymbol{\theta}})})}
\displaystyle\geq\mathbf{E}_{q(\mathbf{u})}[\mathbf{E}_{p(\mathbf{f}\mid%
\mathbf{u},{\boldsymbol{\theta}})}[\log p(\mathbf{y}\mid\mathbf{f})]]-{%
\operatorname{KL}({q(\mathbf{u})}||{p(\mathbf{u}\mid{\boldsymbol{\theta}})})}
\displaystyle\geq\mathbf{E}_{q(\mathbf{u})}[\mathbf{E}_{p(\mathbf{f}\mid%
\mathbf{u},{\boldsymbol{\theta}})}[\log p(\mathbf{y}\mid\mathbf{f})]]-{%
\operatorname{KL}({q(\mathbf{u})}||{p(\mathbf{u}\mid{\boldsymbol{\theta}})})}
\boldsymbol{m}
{\boldsymbol{S}}
\mathbf{z}
{\boldsymbol{\theta}}
{\boldsymbol{S}}
{\boldsymbol{S}}=\mathbf{L}\mathbf{L}^{T}
\mathbf{L}
\mu(x)
\ell(x)
w(x)
\mathbf{z}
\mathbf{u}
x
\displaystyle\mu(x)=\mathbf{K}_{x\mathbf{z}}\mathbf{K}_{\mathbf{z}\mathbf{z}}^%
{-1}\mathbf{u}_{\boldsymbol{\mu}}
\displaystyle\mu(x)
\displaystyle=\mathbf{K}_{x\mathbf{z}}\mathbf{K}_{\mathbf{z}\mathbf{z}}^{-1}%
\mathbf{u}_{\boldsymbol{\mu}}
\displaystyle\ell(x)=\mathbf{K}_{x\mathbf{z}}\mathbf{K}_{\mathbf{z}\mathbf{z}}%
^{-1}\mathbf{u}_{\boldsymbol{\ell}}
\displaystyle\ell(x)
\displaystyle=\mathbf{K}_{x\mathbf{z}}\mathbf{K}_{\mathbf{z}\mathbf{z}}^{-1}%
\mathbf{u}_{\boldsymbol{\ell}}
\displaystyle w(x)=\mathbf{K}_{x\mathbf{z}}\mathbf{K}_{\mathbf{z}\mathbf{z}}^{%
-1}\mathbf{u}_{\mathbf{w}}\,,
\displaystyle w(x)
\displaystyle=\mathbf{K}_{x\mathbf{z}}\mathbf{K}_{\mathbf{z}\mathbf{z}}^{-1}%
\mathbf{u}_{\mathbf{w}}\,,
\boldsymbol{U}=\{\mathbf{u}_{\boldsymbol{\mu}},\mathbf{u}_{\boldsymbol{\ell}},%
\mathbf{u}_{\mathbf{w}}\}
\mathbf{z}
\boldsymbol{m}
q(\mathbf{u}\mid\boldsymbol{m},{\boldsymbol{S}})
{\boldsymbol{\theta}}=\{\boldsymbol{m},{\boldsymbol{S}},\boldsymbol{U},\sigma_%
{n}^{2}\}
{\boldsymbol{\theta}}=\{\boldsymbol{m},{\boldsymbol{S}},\mathbf{W},\mathbf{b},%
\sigma_{n}^{2}\}
\mathbf{W}
\mathbf{b}
Q\in\{1,2,3\}
M=100
N
D
N
D
\log p(\mathbf{y})
\pm
\pm
\pm
N=9568
\pm
\pm
\pm
D=4
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N=45730
\pm
\pm
\pm
D=9
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N=391
\pm
\pm
\pm
D=1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N=1599
\pm
\pm
\pm
D=1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N=6220
\pm
\pm
\pm
D=1
\pm
\pm
\pm
\pm
\pm
\pm
