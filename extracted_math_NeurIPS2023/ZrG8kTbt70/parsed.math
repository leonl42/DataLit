x_{i}
f_{\phi}(x_{i})
x_{i}
f_{\phi}(x_{i})
\mathcal{D}=\{(x_{i},y_{i})\}_{i=1}^{N}
x_{i}\in X
y_{i}\in\{1,\ldots,C\}
\mathbb{P}(y\mid x_{i})
x_{i}
f_{\phi}(\cdot):X\rightarrow\mathbb{R}^{C}
C
\mathbb{P}(y\mid x_{i})
f_{\phi}({x}_{i})
x_{i}
\mathbf{p}_{1\sim K}
\mathcal{D}
\mathbf{p}_{k}
\mathcal{D}
\mathbf{p}_{k}
x_{i}
\mathbb{P}(y\mid x_{i},\mathcal{D})=\sum_{k=1}^{K}\underbrace{\mathbb{P}(y\mid%
\mathbf{p}_{k},\mathcal{D})}_{\begin{subarray}{c}\text{Prototype}\\
\text{Prediction}\end{subarray}}\underbrace{\mathbb{P}(\mathbf{p}_{k}\mid x_{i%
})}_{\begin{subarray}{c}\text{Prototype}\\
\text{Importance}\end{subarray}}
\mathbb{P}(y\mid x_{i},\mathcal{D})
x_{i}
D
f_{\phi}(x_{i})\in\mathbb{R}^{D}
\mathbf{p}_{k}
d(\cdot,\cdot)
\mathbf{p}_{k}
x_{i}
\mathbb{P}(\mathbf{p}_{k}\mid x_{i})\propto\operatorname{exp}(-d(f_{\phi}(x_{i%
}),\mathbf{p}_{k}))
d(\cdot,\cdot)
c
\mathcal{D}_{c}\in\mathcal{D}
c
\mathbf{p}_{c}=\frac{1}{\left|\mathcal{D}_{c}\right|}\sum_{\left(x_{i},y_{i}%
\right)\in\mathcal{D}_{c}}f_{\phi}(x_{i})
f_{\phi}(x_{i})
\mathbb{P}(y=c\mid x_{i})=\frac{\exp(-d(f_{\phi}(x_{i}),\mathbf{p}_{c}))}{\sum%
_{c^{\prime}}\exp(-d(f_{\phi}(x_{i}),\mathbf{p}_{c^{\prime}}))}
P
\mathbf{p}_{k}
c
n
c
f_{\phi}(x_{i})
\phi
\mathbf{p}_{c}=\operatorname{Aggr}([f_{\phi}({x}_{1}),\ldots,f_{\phi}({x}_{n})])
C
K
P^{c}
c
x_{i}\in\mathcal{D}_{c}
f_{\phi}(x_{i})
P^{c}
\lambda
f_{\phi}(x_{i})
\lambda
\lambda=2\sigma\log\left(\frac{\alpha}{\left(1+\frac{\rho}{\sigma}\right)^{d/2%
}}\right)
\sigma
\phi
\rho
\alpha
C
\phi
|P_{max}|
C
\mathbf{p}_{k}
C
\mathbf{p}_{k}
\mathbf{p}_{k}
\mathbf{l}_{k}\in\mathbb{R}^{C}
C
\mathbb{P}(y=c\mid\mathbf{p}_{k},\mathcal{D})=\operatorname{softmax}_{c}(l_{kc%
});~{}~{}\mathbf{l}_{k}=[l_{k,1},\ldots,l_{k,C}]
\mathbf{p}_{k}
l_{k,y_{i}}
\mathbf{l}_{k}
y_{i}
\beta
l_{k,c},c\in\{1,\ldots,C\}\backslash y_{i}
-\beta
\mathbf{l}_{k}
\mathbf{p}_{k}
l_{k,y_{i}}
y_{i}
[0,+\infty)
(-\infty,0]
z_{i,k}
\mathbb{P}(\mathbf{p}_{k}\mid x_{i})=z_{i,k}=\frac{\mathcal{N}(f_{\phi}(x_{i})%
;\mathbf{p}_{k},\sigma_{k})}{\sum_{k^{\prime}}\mathcal{N}(f_{\phi}(x_{i});%
\mathbf{p}_{k^{\prime}},\sigma_{k^{\prime}})}
\mathbf{p}_{k}
c
f_{\phi}(x_{i})
\mathbf{p}_{k}\in P
\mathcal{D}=(x_{i},y_{i})
y_{i}\in\{1,\ldots,C\}
\mathbf{p}_{k}
\mathbb{P}(y\mid\mathbf{p}_{1\sim K},x_{i})
B_{r}\in D
\lambda
x_{i}\in B_{r}
k\in\{1,\ldots,K\}
x_{i}
d_{i,k}=d(f_{\phi}(x_{i}),\mathbf{p}_{k})
\mathbf{p}_{k}\in P^{y_{i}}
d_{i,k}=+\infty
\mathbf{p}_{k}\notin P^{y_{i}}
\operatorname{min}_{k}d_{i,k}>\lambda
K+1
\mathbf{p}_{K+1}
f_{\phi}(x_{i})
K
\operatorname{min}_{k}d_{i,k}>\lambda
K+1
\mathbf{p}_{K+1}
f_{\phi}(x_{i})
K
z_{i,k}
\mathbf{p}_{k}
f_{\phi}({x}_{i})
f_{\phi}(x_{i})
z_{i,k}
f_{\phi}(x_{i})
\mathbf{p}_{k}
O(N|P_{max}|)
z_{i,k}
z_{i,k}
f_{\phi}(x_{i})
\phi
\delta
z_{i,k},i\in[T-\delta,T]
T
\mathbb{P}(\mathbf{p}_{k}\mid x_{i})
\varepsilon
\frac{1}{\delta}\sum_{i}\omega(i,T,\delta)z_{i,k}<\varepsilon
\varepsilon
\mathbf{p}_{k}
f_{\phi}(x_{i}),i\in[T-\delta,T]
\omega(i,T,\delta)=\frac{1}{\delta}(i-T+\delta)
T
T
f_{\phi}(x_{i})
T
M
\mathbf{p}_{k}
\omega(i,T,\delta)
\mathbf{p}_{k}
\lambda
P
\lambda
f_{\phi}(x_{i})
P
\mathcal{L}_{div}=\sum_{j=1}^{K}\sum_{k=j+1}^{K}\max\left(0,\lambda-\left\|%
\mathbf{p}_{j}-\mathbf{p}_{k}\right\|_{2}\right)^{2}
y_{i}
N_{reg}\in\mathbb{N}^{*}
n
\mathbf{l}_{k}
y_{i}
\hat{y}_{i}
\hat{y}_{i}=\sum_{k}z_{i,k}\mathbf{l}_{k}
\mathcal{L}
\mathcal{L}_{0}
\mathcal{L}_{div}
\rho_{d}
\displaystyle\mathcal{L}_{0}=\begin{cases}\frac{1}{N}\sum_{i=1}^{N}\sum_{k=1}^%
{K}-y_{i,k}\log(\hat{y}_{i,k})&\text{(classification)}\\
\frac{1}{N}\sum_{i=1}^{N}(y_{i}-\hat{y}_{i})^{2}&\text{(regression)}\end{cases}
\displaystyle\mathcal{L}_{0}
\displaystyle=\begin{cases}\frac{1}{N}\sum_{i=1}^{N}\sum_{k=1}^{K}-y_{i,k}\log%
(\hat{y}_{i,k})&\text{(classification)}\\
\frac{1}{N}\sum_{i=1}^{N}(y_{i}-\hat{y}_{i})^{2}&\text{(regression)}\end{cases}
\displaystyle\mathcal{L}=\mathcal{L}_{0}+\rho_{d}\mathcal{L}_{div}
\displaystyle\mathcal{L}
\displaystyle=\mathcal{L}_{0}+\rho_{d}\mathcal{L}_{div}
\mathbf{p}_{k}
\mathbf{p}_{k}
\mathbf{p}_{k}
\mathbf{p}_{k}
\tau
\{x_{i}\mid\|\mathbf{p}_{k}-f_{\phi}(x_{i})\|_{2}<\tau\}
n=8
\alpha
\{1,0.5,0.1,0.05,0.01\}
\rho_{d}
\{1e-4,1e-5,1e-6\}
\epsilon
\{1e-3,3e-3,1e-2\}
\alpha=0.1
\rho_{d}=1e-5
\epsilon=1e-3
[1e-5,2e-5,3e-5,5e-5,1e-4]
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\leq
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
O(N|P_{max}|+NM)
O(N|P_{max}|)
O(NM)
O(N^{2}|P_{max}|)
\mathbf{p}_{k}
\mathcal{L}_{div}
\mathcal{L}_{div}
