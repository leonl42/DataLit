<
>
{\mathbf{x}}\in{\mathbb{R}}^{D}
\mathcal{Y}=\{1,\dots,N\}
N
\small p_{\bm{\theta}}(y|{\mathbf{x}})=\frac{\text{exp}({[f_{\bm{\theta}}({%
\mathbf{x}})]}_{y})}{\sum_{i\in\mathcal{Y}}{\text{exp}({[f_{\bm{\theta}}({%
\mathbf{x}})]}_{i})}},\;\;\;\text{for all }y\in\mathcal{Y},
f_{\bm{\theta}}({\mathbf{x}}):{\mathbb{R}}^{D}\rightarrow{\mathbb{R}}^{N}
\bm{\theta}
{\mathbf{x}}
N
[\cdot]_{i}
i^{\text{th}}
{\mathbf{x}}
y^{+}
\mathcal{L}_{CE}(\bm{\theta};{\mathbf{x}},y^{+})=-\text{log}(p_{\bm{\theta}}(y%
^{+}|{\mathbf{x}}))
{\mathbf{x}}
\hat{y}=\operatorname*{arg\,max}_{y\in\mathcal{Y}}p_{\bm{\theta}}(y|{\mathbf{x%
}})
{\mathbf{x}}\in\mathcal{X}\subseteq{\mathbb{R}}^{D}
Z(\bm{\theta})
\small p_{\bm{\theta}}({\mathbf{x}})=\frac{\exp(-E_{\bm{\theta}}({\mathbf{x}})%
)}{Z({\mathbf{\theta}})},\;\;\;\;Z(\bm{\theta})=\int_{{\mathbf{x}}\in\mathcal{%
X}}\text{exp}(-E_{\bm{\theta}}({\mathbf{x}}))
E_{\bm{\theta}}({\mathbf{x}}):{\mathbb{R}}^{D}\rightarrow{\mathbb{R}}
{\mathbf{x}}
E_{\bm{\theta}}
\bm{\theta}
{\mathbf{x}}
N
{\mathbf{x}}
y
{\mathbf{x}}
N
{\mathbf{x}}
y
{\mathbf{x}}\in{\mathbb{R}}^{D}
\mathcal{Y}
y
{\mathbf{x}}
\small p_{\bm{\theta}}(y|{\mathbf{x}})=\frac{\text{exp}(-E_{\bm{\theta}}({%
\mathbf{x}},y))}{Z(\bm{\theta};{\mathbf{x}})},Z(\bm{\theta};{\mathbf{x}})=\sum%
_{y^{\prime}\in\mathcal{Y}}\text{exp}(-E_{\bm{\theta}}({\mathbf{x}},y^{\prime}))
E_{\bm{\theta}}({\mathbf{x}},y):({\mathbb{R}}^{D},{\mathbb{N}})\rightarrow{%
\mathbb{R}}
({\mathbf{x}},y)
Z(\bm{\theta};{\mathbf{x}})
E_{\bm{\theta}}
p_{D}
\mathcal{L}_{\text{ML}}(\bm{\theta})=\mathbb{E}_{(x,y)\sim p_{D}}[-\text{log}p%
_{\bm{\theta}}(y|{\mathbf{x}})]
\small\mathcal{L}_{\text{ML}}(\bm{\theta})=\mathbb{E}_{({\mathbf{x}},y)\sim p_%
{D}}\left[E_{\bm{\theta}}({\mathbf{x}},y)+\log(\sum_{y^{\prime}\in\mathcal{Y}}%
e^{-E_{\bm{\theta}}({\mathbf{x}},y^{\prime})})\right].
{\mathbf{x}}
y
{\mathbf{x}}
y^{\prime}
{\mathbf{x}}
{\mathbf{x}}
\hat{y}=\operatorname*{arg\,min}_{y^{\prime}\in\mathcal{Y}}E_{{\mathbf{\theta}%
}}({\mathbf{x}},y^{\prime})
y^{\prime}
{\mathbf{x}}
\small\mathcal{L}_{\text{CD}}(\bm{\theta};{\mathbf{x}},y)=\mathbb{E}_{({%
\mathbf{x}},y)\sim p_{D}}\left[E_{\bm{\theta}}({\mathbf{x}},y)-E_{\bm{\theta}}%
({\mathbf{x}},y^{-})\right],
y
{\mathbf{x}}
y^{-}
\mathcal{Y}_{B}
y^{-}\neq y
\mathcal{Y_{B}}
{\mathbf{x}}
{\mathbf{x}}
y
E_{\theta}({\mathbf{x}},y):({\mathbb{R}}^{D},{\mathbb{N}})\rightarrow{\mathbb{%
R}}
y
{\mathbf{x}}
y
{\mathbf{x}}
y
y
{\mathbf{x}}
{\mathbf{x}}
y
{\mathbf{x}}
f({\mathbf{x}})
y
g(y)
G
{\mathbf{x}}
y
m({\mathbf{x}},y)=G(f({\mathbf{x}}),g(y)).
E_{\theta}({\mathbf{x}},y)
g({\mathbf{y}})
{\mathbf{x}}
{\mathbf{x}}
y
\mathcal{Y}
\hat{y}=\arg\min_{y^{\prime}}E_{\theta}({\mathbf{x}},y^{\prime})
y^{\prime}\in\mathcal{Y}
E_{\theta}
\theta
{\mathbf{x}}
y
{\mathbf{x}}
y
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
1e^{-4}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
y
i
\mathcal{L}_{\text{SBC\_CD}}({\mathbf{x}},y)=-[f_{\bm{\theta}}({\mathbf{x}})]_%
{y}+[f_{\bm{\theta}}({\mathbf{x}})]_{i}
\pm
\pm
\pm
50.99\%
53.12\%
{\mathbf{x}}
y
{\mathbf{x}}
y
{\mathbf{x}}
y
y
\mathcal{U}(0,1)
y
y
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
T_{9}
T_{9}
T_{1}
T_{9}
T_{10}
T_{10}
T_{9}
T_{10}
T_{9}
T_{10}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
5
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
h=400
h=400
h=1000
h=1000
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
X\%
y
X
X\%
y
X
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
k
k=1000
k=2000
\mathcal{L}_{\text{CD current}}(\bm{\theta};{\mathbf{x}},y)
\mathcal{L}_{\text{CD replay}}(\bm{\theta};{\mathbf{x}},y)
\mathcal{L}_{\text{CD}}(\bm{\theta};{\mathbf{x}},y)=\mathcal{L}_{\text{CD %
current}}(\bm{\theta};{\mathbf{x}},y)+\mathcal{L}_{\text{CD replay}}(\bm{%
\theta};{\mathbf{x}},y).
1e^{-4}
32\times 32
2,348,545
2,349,032
5,221,377
5,221,352
33,468,417
33,465,320
h=256
50,000
82.81\%
42.19\%
h
h
32\times 32\times 3
32\times 32\times 3
{\mathbf{x}}
y
\begin{split}p_{\bm{\theta}}({\mathbf{x}},y)&=\frac{\text{exp}(-E_{\bm{\theta}%
}({\mathbf{x}},y))}{Z(\bm{\theta})},\\
Z(\bm{\theta})&=\sum_{{\mathbf{x}}^{\prime}\in\mathcal{X},y^{\prime}\in%
\mathcal{Y}}\text{exp}(-E_{\bm{\theta}}({\mathbf{x}}^{\prime},y^{\prime}))\end%
{split}
E_{\bm{\theta}}({\mathbf{x}},y):({\mathbb{R}}^{D},{\mathbb{N}})\rightarrow{%
\mathbb{R}}
({\mathbf{x}},y)
Z(\bm{\theta})
E_{\bm{\theta}}
p_{D}
\small\mathcal{L}_{\text{ML}}(\bm{\theta})=\mathbb{E}_{(x,y)\sim p_{D}}[-\text%
{log}p_{\bm{\theta}}({\mathbf{x}},y)].
\small\mathcal{L}_{\text{ML}}(\bm{\theta})=\mathbb{E}_{({\mathbf{x}},y)\sim p_%
{D}}\left[E_{\bm{\theta}}({\mathbf{x}},y)+\log(\sum_{{\mathbf{x}}^{\prime}\in%
\mathcal{X},y^{\prime}\in\mathcal{Y}}e^{-E_{\bm{\theta}}({\mathbf{x}}^{\prime}%
,y^{\prime})})\right].
{\mathbf{x}}
y
{\mathbf{x}}^{\prime}
y^{\prime}
{\mathbf{x}}
{\mathbf{x}}
\hat{y}=\operatorname*{arg\,min}_{y^{\prime}\in\mathcal{Y}}E_{{\mathbf{\theta}%
}}({\mathbf{x}},y^{\prime}),
{\mathbf{x}}
{\mathbf{x}}^{\prime}
y^{\prime}
\small\mathcal{L}_{\text{CD}}(\bm{\theta};{\mathbf{x}},y)=\mathbb{E}_{({%
\mathbf{x}},y)\sim p_{D}}\left[E_{\bm{\theta}}({\mathbf{x}},y)-E_{\bm{\theta}}%
({\mathbf{x}}^{\prime},y^{\prime})\right],
y
{\mathbf{x}}
\hat{y}
{\mathbf{x}}
\mathcal{Y}
{\mathbf{x}}
y\in\mathcal{Y}
\hat{y}=\arg\min_{y^{\prime}}E_{\theta}({\mathbf{x}},y^{\prime}),\;\;\;y^{%
\prime}\in\mathcal{Y},
E_{\theta}
\theta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
