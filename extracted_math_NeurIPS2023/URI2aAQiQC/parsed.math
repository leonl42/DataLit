L
L^{{}^{\prime}}
L
L^{{}^{\prime}}
27.82
6
U_{t}
t
U_{\rm thr}
S_{t}
\small\begin{split}S_{t}=\begin{cases}1,&\text{if $U_{t}\geq$ $U_{\rm thr}$;}%
\\
0,&\text{if $U_{t}<$ $U_{\rm thr}$.}\end{cases}\end{split}
U_{t}\geq
U_{\rm thr}
U_{t}<
U_{\rm thr}
\small\begin{split}U_{t}=I_{t}+\beta U_{t-1}-S_{t-1}U_{\mathrm{thr}},\quad I_{%
t}=WX_{t}\end{split}
X_{t}
t
W
I_{t}
\beta
U_{t-1}
t-1
S_{t-1}U_{\mathrm{thr}}
\displaystyle S\approx\frac{1}{\pi}\arctan(\frac{\pi}{2}\alpha U)+\frac{1}{2}
\displaystyle S\approx\frac{1}{\pi}\arctan(\frac{\pi}{2}\alpha U)+\frac{1}{2}
S
\small\begin{split}\frac{\partial S}{\partial U}&=\frac{\alpha}{2}\frac{1}{(1+%
(\frac{\pi}{2}\alpha U)^{2})}\end{split}
\alpha
2
\small\begin{split}\operatorname{SSA}\left(Q_{s},K_{s},V_{s}\right)&=\mathcal{%
SN}(\operatorname{BN}(\operatorname{Linear}(Q_{s}K_{s}^{T}V_{s}*\tau)))\\
Q_{s}=\mathcal{SN}_{Q}\left(\operatorname{BN}\left(X_{s}W_{Q}\right)\right),%
\quad K_{s}&=\mathcal{SN}_{K}\left(\operatorname{BN}\left(X_{s}W_{K}\right)%
\right),\quad V_{s}=\mathcal{SN}_{V}\left(\operatorname{BN}\left(X_{s}W_{V}%
\right)\right)\end{split}
\mathcal{SN}
X_{s}\in\mathbb{R}^{T\times L\times D}
T
\operatorname{BN}
\tau
Q_{s},K_{s},V_{s}
0
1
W_{Q},W_{K},W_{V}
\operatorname{Linear}
Q_{s}K_{s}^{T}
D\times D
D
N\times N
D\times D
N
T
2
L_{fea}^{i}
T
2
L_{fea}^{i}
TM
SM
TM
SM
L_{fea}
TM
SM
F_{sm}
T\times N\times D
F_{tm}
N\times D
T
D
L
F_{sm}
0
1
F_{tm}
F_{tm}
F_{sm}
TM
SM
TM
SM
\small F_{tm}^{{}^{\prime}}=F_{tm},\quad F_{sm}^{{}^{\prime}}=\operatorname{%
LayerNorm}(\operatorname{MLP}(\sum_{t}^{T}(F_{sm}^{t})))\\

B
B
M
\lceil\frac{B}{M}\rceil
B>M
i
L_{fea}^{i}=||F_{tm}^{{}^{\prime}}-F_{sm}^{{}^{\prime}}||_{2}
E_{tm}
E_{sm}
L_{fea}^{i}=||E_{tm}-\operatorname{MLP}(E_{sm})||_{2}
1
L_{1}
\small L_{1}=\sigma_{1}\sum_{i}L_{fea}^{i}+\sigma_{2}L_{emb}
\sigma_{1}
\sigma_{2}
2
1
\operatorname{[MASK]}
p_{mask}
p_{pos}
n
p_{ng}
n
\{1,2,...,5\}
L_{logits}=\sum_{i}^{c}p_{i}log\left(\frac{p_{i}}{q_{i}}\right)
c
p_{i}
q_{i}
L_{ce}=-\sum_{i}^{c}\hat{q}_{i}log\left(q_{i}\right)
\hat{q}_{i}
L_{2}
2
L_{2}=\lambda_{1}\sum_{i}L_{fea}^{i}+\lambda_{2}L_{emb}+\lambda_{3}L_{logits}+%
\lambda_{4}L_{ce}
\lambda_{1}
\lambda_{2}
\lambda_{3}
\lambda_{4}
6
2
5
12
U_{thr}
1.0
0.25
\beta=0.9
\tau
0.125
T
4
256
4
4
\alpha
2
1
128
5e^{-4}
5e^{-3}
\sigma_{1}
\sigma_{2}
2
32
5e^{-5}
p_{mask}=p_{pos}=0.1
p_{ng}=0.25
\lambda_{1}=0.1
\lambda_{2}=0.1
\lambda_{3}=1.0
\lambda_{4}=0.1
6
2
6
10
6
10
77.41
\pm 0.22
83.25
\pm 0.16
94.00
\pm 0.22
45.48
\pm 0.16
86.74
\pm 0.15
88.49
\pm 0.16
79.23
87.63
\pm 0.18
92.31
\pm 0.17
95.90
\pm 0.16
50.41
\pm 0.13
89.48
\pm 0.16
90.27
\pm 0.13
\bm{84.33}
75.45
\pm 0.51
80.91
\pm 0.34
90.60
\pm 0.32
41.63
\pm 0.44
85.02
\pm 0.22
86.66
\pm 0.17
76.71
76.38
\pm 0.43
81.55
\pm 0.28
91.80
\pm 0.29
42.02
\pm 0.45
85.45
\pm 0.29
86.93
\pm 0.20
77.36
\bm{80.69}
\pm 0.44
\bm{85.39}
\pm 0.36
\bm{93.00}
\pm 0.33
\bm{46.11}
\pm 0.40
\bm{86.36}
\pm 0.28
\bm{89.66}
\pm 0.21
\bm{80.20}
6
5.42\%
3.49\%
4.13\%
5
6
6
6
\bf G
\bf mJ
\bf\%
22.46
103.38
\bf 70.49\%\downarrow
89.48
28.47
30.51
86.36
22.46
103.38
\bf 71.08\%\downarrow
90.27
27.81
29.90
89.66
22.23
102.24
\bf 72.58\%\downarrow
87.63
26.94
28.03
80.69
22.23
102.24
\bf 72.09\%\downarrow
92.31
27.46
28.54
85.39
22.23
102.24
\bf 73.63\%\downarrow
95.90
25.92
26.96
93.00
22.23
102.24
\bf 73.27\%\downarrow
50.41
26.01
27.33
46.11
27.82\%
3
4
5
9
3
4
5
9
80.69
85.39
93.00
46.11
76.30
--
1
76.04
82.26
91.80
42.16
73.07
-3.23
2
75.91
82.26
91.90
42.58
73.14
-3.16
2
80.22
84.90
92.20
44.84
75.54
-0.76
L_{fea}
78.35
83.48
92.20
43.57
74.40
-1.90
L_{emb}
79.67
83.10
92.00
43.48
74.56
-1.74
L_{logits}
76.19
82.64
91.90
42.35
73.27
-3.03
L_{ce}
80.43
85.23
93.00
45.86
76.13
-0.17
1
2
3.20\%
76.30
73.27
L_{logits}
2
75.54
76.30
T
{6,12,18}
\beta
T=4
8
12
4
\beta
\beta
\beta
L
\small\begin{split}\frac{\partial L}{\partial W}=\sum_{t}\frac{\partial L_{t}}%
{\partial W}=\sum_{i}\sum_{j\leq i}\frac{\partial L_{i}}{\partial W_{j}}\frac{%
\partial W_{j}}{\partial W}\end{split}
i
j
L_{t}
t
W_{0}=W_{1}=\cdots=W
\frac{\partial W_{j}}{\partial W}=1
\small\begin{split}\frac{\partial L}{\partial W}&=\sum_{i}\sum_{j\leq i}\frac{%
\partial L_{i}}{\partial W_{j}}\\
\end{split}
\small\begin{split}\frac{\partial L}{\partial W}&=\sum_{i}\sum_{j\leq i}\frac{%
\partial L_{i}}{\partial S_{i}}\frac{\partial S_{i}}{\partial U_{i}}\frac{%
\partial U_{i}}{\partial W_{j}}\\
&=\sum_{i}\frac{\partial L_{i}}{\partial S_{i}}\frac{\partial S_{i}}{\partial U%
_{i}}\sum_{j\leq i}\frac{\partial U_{i}}{\partial W_{j}}\end{split}
\frac{\partial L_{i}}{\partial S_{i}}
i
S_{i}
\frac{\partial S_{i}}{\partial U_{i}}
\sum_{j\leq i}\frac{\partial U_{i}}{\partial W_{j}}
\small\sum_{j\leq i}\frac{\partial U_{i}}{\partial W_{j}}=\frac{\partial U_{i}%
}{\partial W_{i}}+\sum_{j\leq i-1}\frac{\partial U_{i}}{\partial W_{j}}
\frac{\partial U_{i}}{\partial W_{i}}=X_{i}
\small\frac{\partial L}{\partial W}=\sum_{i}\underbrace{\frac{\partial L_{i}}{%
\partial S_{i}}\frac{\partial S_{i}}{\partial U_{i}}}_{\text{constant}}\left(%
\underbrace{\frac{\partial U_{i}}{\partial W_{j}}}_{\text{constant}}+\sum_{j%
\leq i-1}\frac{\partial U_{i}}{\partial W_{j}}\right)
\frac{\partial U_{i}}{\partial W_{j}}
\small\frac{\partial U_{i}}{\partial W_{j}}=\frac{\partial U_{i}}{\partial U_{%
i-1}}\frac{\partial U_{i-1}}{\partial W_{j}}
\frac{\partial U_{i}}{\partial U_{i-1}}
\beta
\small\frac{\partial L}{\partial W}=\sum_{i}\underbrace{\frac{\partial L_{i}}{%
\partial S_{i}}\frac{\partial S_{i}}{\partial U_{i}}}_{\text{constant}}\left(%
\underbrace{\frac{\partial U_{i}}{\partial W_{j}}}_{\text{constant}}+\sum_{j%
\leq i-1}\underbrace{\frac{\partial U_{i}}{\partial U_{i-1}}}_{\text{constant}%
}\frac{\partial U_{i-1}}{\partial W_{j}}\right)
\frac{\partial U_{i-1}}{\partial W_{j}}
W
W=W-\eta\frac{\partial L}{\partial W}
\eta
\bf 5
5
11,855
5
\bf 2
5
2
7,000
12,000
*
10
*
10
92.31
89.80
69.31
90.70
83.82/83.41
90.51
60.00
89.41
80.91
80.62
47.29^{*}
56.23^{*}
64.91/63.69
0.00^{*}
-5.28^{*}
0.00^{*}
85.39
81.98
57.47
66.37
71.42/70.95
68.17
16.86^{*}
18.73^{*}
l
\displaystyle Energy(l)=E_{AC}\times SOPs(l)
\displaystyle Energy(l)=E_{AC}\times SOPs(l)
b
\displaystyle Energy(b)=E_{MAC}\times FLOPs(b)
\displaystyle Energy(b)=E_{MAC}\times FLOPs(b)
b
E_{MAC}=4.6pJ
E_{AC}=0.9pJ
1
=10^{3}
=10^{12}
l
\displaystyle SOPs(l)=T\times\gamma\times FLOPs(l)
\displaystyle SOPs(l)=T\times\gamma\times FLOPs(l)
T
\gamma
l
\displaystyle E_{SpikeBERT}=E_{MAC}\times EMB^{1}_{emb}+E_{AC}\times\left(\sum%
_{m=1}^{M}\text{SOP}_{\text{SNN FC}}^{m}+\sum_{n=1}^{N}\text{SOP}_{\text{SSA}}\right)
\displaystyle E_{SpikeBERT}=E_{MAC}\times EMB^{1}_{emb}+
\displaystyle E_{AC}\times\left(\sum_{m=1}^{M}\text{SOP}_{\text{SNN FC}}^{m}+%
\sum_{n=1}^{N}\text{SOP}_{\text{SSA}}\right)
EMB^{1}_{emb}
m
l
E_{AC}
3
3
109.0
22.46
103.38
90.27
109.0
27.81
29.90
71.08\%\downarrow
89.66
67.0
11.30
52.01
49.69\%\downarrow
89.72
52.2
7.60
34.98
66.16\%\downarrow
89.40
109.0
22.46
103.38
89.48
109.0
28.47
30.51
70.49\%\downarrow
86.36
67.0
11.30
52.01
49.69\%\downarrow
88.70
52.2
7.60
34.98
66.16\%\downarrow
87.41
109.0
22.23
102.24
92.31
109.0
27.46
28.54
72.09\%\downarrow
85.39
67.0
11.30
52.01
49.13\%\downarrow
91.60
52.2
7.60
34.98
65.78\%\downarrow
90.40
T
T
