\Delta
\Delta
\Delta
(\bm{x}^{i},y^{i},\bm{a}^{i})_{i=1}^{n}\sim\mathcal{P}_{m}
\mathcal{P}
\bm{x}^{i}\in\mathbf{X}
y^{i}\in Y
\bm{a}^{i}=(a^{i}_{1},\ldots,a^{i}_{k})
a^{i}_{j}\in A_{j}
\bm{x}^{i}
``\bm{x}_{a_{j}}"
``\bm{x}"
a_{j}\in A_{j}
y^{i}
\bm{x}^{i}
c(h(\bm{x}))
h:\bm{X}\rightarrow\bm{Z}
\bm{\bm{x}}
\bm{z}:=h(\bm{x})
c:\bm{Z}\rightarrow Y
\bm{Z}
y
c\in\mathcal{C}
c(h(x))
y
X
X
X
x
X
Y
\mathcal{P}
P(X|do(A))
A
P(X|do(A))
\mathcal{P}
A,C,S
X
Y
U
x
Y
P(X|do(A))
A
Y
C
Y
S
Y
\mathcal{V}=C\cup S
V
P(Y|do(A))
A
Y
P(Y|X)
P(X|do(A))
C
S
P(Y|do(S))
P(Y|do(C))
\mathcal{A}=\{a_{1},\ldots,a_{k}\}
TE_{\bm{a}_{i}}
a\in\mathcal{A}
Y
Y
\mathbb{E}_{X}(\mathbb{E}(Y|X,a=1)-\mathbb{E}(Y|X,a=0))
a\in\mathcal{A}
\mathcal{}=\{TE_{a_{1}},\ldots,TE_{a_{k}}\}
\mathcal{A}=\{a_{1},\ldots,a_{k}\}
\mathcal{L}_{AutoACER}\coloneqq\mathbb{E}_{(\bm{x},y)\sim\mathcal{P}}\Big{[}%
\mathcal{L}_{task}\Big{(}c(h(\bm{x})),y\Big{)}+R\cdot\mathcal{L}_{Reg}\Big{(}%
\bm{x},y\Big{)}\Big{]}
R
\mathcal{P}
\mathcal{L}_{task}(c(h(\bm{x})),y)
h
c
y
\bm{x}
\mathcal{L}_{Reg}
a_{i}
\mathcal{L}_{Reg}\coloneqq\sum_{i=\{1,2,\ldots,|\mathcal{A}|\}}\mathbb{E}_{(%
\bm{x}_{a_{i}^{\prime}})\sim\mathcal{Q}(\bm{x}_{a_{i}})}\Big{[}\Big{(}c(h(\bm{%
x})_{a_{i}})-c(h(\bm{x}_{a_{i}}^{\prime}))\Big{)}-TE_{a_{i}}\Big{]}^{2}
\bm{x}_{a_{i}^{\prime}}\sim\mathcal{Q}(\bm{x}_{c_{i}})
\mathcal{Q}\coloneqq\mathbb{P}(\bm{x}_{c_{i}^{\prime}}|\bm{x}_{c_{i}})
\bm{x}_{c_{i}^{\prime}}
\bm{x}_{c_{i}}
c_{i}^{\prime}
c_{i}
\mathcal{A}=\{ca_{1},\ldots,ca_{K},sp_{1},\ldots,sp_{J}\}
ca_{k}
sp_{j}
\bm{X}
\bm{Z}
h:\bm{X}\rightarrow\bm{Z}
c
\bm{z}
\bm{z}
c(\bm{z})=\sum_{k=1}^{K}\bm{w}_{ca_{k}}\cdot\bm{z}_{ca_{k}}+\sum_{j=1}^{J}\bm{%
w}_{sp_{j}}\cdot\bm{z}_{sp_{j}}
\mathcal{L}_{task}(\theta;(\bm{x},y_{m}))
``c"
y_{m}
\bm{z}
y
``a"
a\in\mathcal{A}
\{0,1\}
a\in\mathcal{A}
Y
TE_{a}=\mathbb{E}(Y|do(a)=1)-\mathbb{E}(Y|do(a)=0)=P(y=1|do(a)=1)-P(y=1|do(a)=0)
\hat{TE}_{a}\in[-1,1]
``sp"
TE_{sp}=0
``ca"
|TE_{ca}|>0
\mathcal{L}_{Reg}
\mathcal{L}_{Reg}\coloneqq\sum_{k=\{1,2,\ldots,K\}}\lambda_{ca_{k}}\lVert\bm{w%
}_{ca_{k}}\rVert_{p}+\sum_{j=\{1,2,\ldots,J\}}\lambda_{sp_{j}}\lVert\bm{w}_{sp%
_{j}}\rVert_{p}
\lambda_{ca_{k}}\coloneqq 1/{|TE_{ca_{k}}|}
\lambda_{sp_{j}}\coloneqq 1/{|TE_{sp_{j}}|}
\bm{z}_{ca_{k}}
\bm{z}_{sp_{j}}
|\cdot|
\lVert\bm{w}\rVert_{p}
L_{p}
\bm{w}
|TE_{(\cdot)}|\in[0,1]
\lambda_{(\cdot)}=1/|TE_{(\cdot)}|\geq 1
TE_{(\cdot)}
\hat{TE}_{(\cdot)}
\lambda_{(\cdot)}=1/|\hat{TE}_{(\cdot)}|
[S]
\{1,\ldots,S\}
\bm{z}=[\bm{z}_{ca_{1}},\ldots,\bm{z}_{ca_{K}},\bm{z}_{sp_{1}},\ldots,\bm{z}_{%
sp_{J}}]
c^{des}(\bm{z})=\sum_{k=1}^{K}\bm{w}^{des}_{ca_{k}}\cdot\bm{z}_{ca_{k}}
\bm{z}_{ca_{k}}
c^{mm}(\bm{z})=\sum_{k=1}^{K}\bm{w}^{mm}_{ca_{k}}\cdot\bm{z}_{ca_{k}}+\sum_{j=%
1}^{J}\bm{w}^{mm}_{sp_{j}}\cdot\bm{z}_{sp_{j}}
\bm{w}_{sp_{j}}^{mm}\neq\bm{0}
\forall j\in[J]
\bm{w}_{sp_{j}}^{mm}\neq\bm{0}
\forall j\in[J]
j\in[J]
\bm{w}_{sp_{j}}^{mm}\neq\bm{0}
1
\sum_{k=1}^{K}\lVert\bm{w}^{mm}_{ca_{k}}\rVert^{2}_{p=2}+\sum_{j=1}^{J}\lVert%
\bm{w}^{mm}_{sp_{j}}\rVert^{2}_{p=2}=\sum_{k=1}^{K}\lVert\bm{w}^{des}_{ca_{k}}%
\rVert^{2}_{p=2}=1
\operatorname{mean}\left(\left\{\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\cdot%
\eta_{k,j}\right\}_{k\in[K],j\in[J]}\right)<\frac{J}{K}
\eta_{k,j}=\frac{\lVert\bm{w}^{des}_{ca_{k}}\rVert-\lVert\bm{w}^{mm}_{ca_{k}}%
\rVert_{p}}{\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}}
\mathcal{L}_{AutoACER}(c^{des}\big{(}\bm{z})\big{)}<\mathcal{L}_{AutoACER}\big%
{(}c^{mm}(\bm{z})\big{)}
c^{des}(\bm{z})
c^{mm}(\bm{z})
c^{des}(\bm{z})
\mathcal{L}_{AutoACER}
J=1
K=1
p=2
\lambda_{ca_{1}}<\lambda_{sp_{1}}\implies|\hat{TE}_{ca_{1}}|>|\hat{TE}_{sp_{1}}|
c(\bm{z})
\lambda
\lambda_{sp_{j}}>\Big{(}\frac{K}{J}\eta_{k,j}\Big{)}\lambda_{ca_{k}}\implies|%
\hat{TE}_{sp_{j}}|<\Big{(}\frac{K}{J}\eta_{k,j}\Big{)}|\hat{TE}_{ca_{k}}|
\forall k\in[K]
j\in[J]
c^{des}(\bm{z})
c^{mm}(\bm{z})
\mathcal{L}_{AutoACER}
``R"
c^{mm}(\bm{z})
c^{des}(\bm{z})
c^{mm}(\bm{z})
c^{des}(\bm{z})
c^{des}(\bm{z})
c^{mm}(\bm{z})
\mathcal{L}_{AutoACER}
c^{des}(\bm{z})
\bm{z}_{sp_{1}}
\bm{z}_{ca_{1}}
c^{des}(\bm{z})
\mathcal{L}_{AutoACER}
\mathcal{L}_{AutoACER}
1
y_{m}
3
4
XOR
0^{\degree}
90^{\degree}
C
S
x
A
y_{m}
y_{c_{sp}}
(\kappa)
s
t
\kappa\coloneqq Pr(s=t)={\sum_{i=1}^{N}\mathbf{1}[s=t]}/{N}
N
\mathbf{1}[\cdot]
1
0
s=1
t=1
s=0
t=0
\kappa\in[0.5,1]
\kappa=0.5
\kappa=1
TE_{a}=0
``a"
y\in\{0,1\}
a\in\{0,1\}
2\times 2
(y,a)
(y=1,a=1)
(y=0,a=0)
S_{maj}
(y=1,a=0)
(y=0,a=1)
S_{min}
S_{maj}
S_{min}
\frac{Acc(S_{min})+Acc(S_{maj})}{2}
Acc(S_{maj})
Acc(S_{min})
\Delta
\bm{x}_{a}
(\bm{x}_{a^{\prime}})\sim\mathcal{Q}(\bm{x}_{a})
A=a
A=a^{\prime}
\Delta
a
\kappa
\kappa
\kappa
\kappa
\kappa
\kappa
\kappa
\kappa<0.8
\kappa
\kappa
>=0.9
0
0
(\kappa)
\Delta
\kappa
\Delta
\Delta
\Delta
\Delta
\Delta
\kappa
\Delta
\Delta
\Delta
\Delta
\kappa
\Delta
\kappa\geq 0.8
\Delta
\kappa
\kappa
\Delta
\Delta
\Delta
\Delta
\bm{x}
y
(X,Y,A)
A
X
Y
A
A
Y
TE_{A}=\mathbb{E}[Y|do(A)=1]-\mathbb{E}[Y|do(A)=0]
X
Direct\coloneqq TE_{A}=\mathbb{E}_{X}\Big{[}\mathbb{E}[Y|X,A=1]-\mathbb{E}[Y|X%
,A=0]\Big{]}
X
g(X,A)\coloneqq\mathbb{E}[Y|X,A]
TE_{A}=\mathbb{E}[\alpha_{0}(X,A)\cdot g(X,A)]
\alpha_{0}(X,A)
g(X,A)=\mathbb{E}[Y|X,A]
g(X,A)=\mathbb{E}(Y|\alpha_{0}(X,A))
\alpha_{0}(X,A)
\mathbb{E}(Y|\alpha_{0}(X,A))
(X,A)
\alpha_{0}(X,A)
g(X,A)
(X,A)
Z
\alpha_{0}(X,A)
g(X,A)
g(X,A)
\text{RieszLoss}=\text{REGloss}+R_{1}\cdot\text{RRloss}+R_{2}\cdot\text{L2%
RegLoss},
R_{1}
R_{2}
Riesz\coloneqq\mathbb{E}_{X}[g(X,A=1)-g(X,A=0)]
DebiasedRiesz\coloneqq\mathbb{E}_{X}\Big{[}\big{(}g(X,A=1)-g(X,A=0)\big{)}+%
\alpha(X,A)(Y-g(X,A))\Big{]}
Riesz
DebiasedRiesz
h:\bm{X}\rightarrow\bm{Z}
\bm{x}
\bm{z}
c:\bm{Z}\rightarrow Y
\bm{Z}
y
c(\bm{z})=\bm{w}\cdot\bm{z}
c(\bm{z})=0
1
-1
c(\bm{z}<0
-1
+1
\bm{z}
y
\mathcal{M}_{c}(\bm{z})=\frac{y\cdot c(\bm{z})}{\lVert\bm{w}\rVert_{2}}
\lVert\bm{w}\rVert_{2}
\bm{z}
\mathcal{L}_{mm}\left(c(Z),Y\right)=(-1)~{}\min_{i}\dfrac{y^{i}c(\bm{z}^{i})}{%
\lVert c(\bm{z})\rVert_{2}}
i
A
Y
P(Y|do(A))
A
A
Y
TE_{A}=\mathbb{E}[Y|do(A)=1]-\mathbb{E}[Y|do(A)=0]
P(Y|do(A))
\displaystyle P(Y|do(A))=\sum_{X}\sum_{U}P(Y,X,U|do(A))
\displaystyle P(Y|do(A))
\displaystyle=\sum_{X}\sum_{U}P(Y,X,U|do(A))
\displaystyle=\sum_{X}\sum_{U}\Bigg{\{}P(U)P(X|U,do(A))P(Y|X)\Bigg{\}}
\displaystyle=\sum_{X}\sum_{U}\Bigg{\{}P(U)P(X|U,do(A))P(Y|X)\Bigg{\}}
\displaystyle=\sum_{X}P(Y|X)\Bigg{\{}\sum_{U}P(U)P(X|U,do(A))\Bigg{\}}
\displaystyle=\sum_{X}P(Y|X)\Bigg{\{}\sum_{U}P(U)P(X|U,do(A))\Bigg{\}}
\displaystyle=\sum_{X}P(Y|X)P(X|do(A))
\displaystyle=\sum_{X}P(Y|X)P(X|do(A))
P(X|do(A))
P(Y,X,A)
P(Y|do(A))
\mathcal{V}=\{C,S\}
P(Y|do(A))
A\in\mathcal{V}
A=C
\displaystyle P(Y|do(C))=\sum_{S}P(Y,S|do(C))
\displaystyle P(Y|do(C))
\displaystyle=\sum_{S}P(Y,S|do(C))
\displaystyle=\sum_{S}P(S|do(C))P(Y|S,C)=\sum_{S}P(S)P(Y|S,C)
\displaystyle=\sum_{S}P(S|do(C))P(Y|S,C)=\sum_{S}P(S)P(Y|S,C)
\displaystyle=\sum_{\mathcal{V}\setminus A}P(\mathcal{V}\setminus A)P(Y|%
\mathcal{V})
\displaystyle=\sum_{\mathcal{V}\setminus A}P(\mathcal{V}\setminus A)P(Y|%
\mathcal{V})
A=S
\displaystyle P(Y|do(S))=\sum_{C}P(Y,C|do(S))=\sum_{C}P(C|do(S))P(Y|C,do(S))
\displaystyle P(Y|do(S))
\displaystyle=\sum_{C}P(Y,C|do(S))=\sum_{C}P(C|do(S))P(Y|C,do(S))
\displaystyle=\sum_{C}P(C)P(Y|C,S)\quad\quad\quad\quad\because(Y\perp S|C)
\displaystyle=\sum_{C}P(C)P(Y|C,S)\quad\quad\quad\quad\because(Y\perp S|C)
\displaystyle=\sum_{\mathcal{V}\setminus A}P(\mathcal{V}\setminus A)P(Y|%
\mathcal{V})
\displaystyle=\sum_{\mathcal{V}\setminus A}P(\mathcal{V}\setminus A)P(Y|%
\mathcal{V})
P(Y|do(A))=\sum_{\mathcal{V}\setminus A}P(\mathcal{V}\setminus A)P(Y|\mathcal{%
V})
A\in\mathcal{V}
U
X
C,S
x
X=[C,S,x]
A
x
X=[A,x]
A
Y
A
A
Y
x
S
C
A
x
A\rightarrow U\rightarrow Y
N
Y
N
Y
X
|P(Y|\Gamma_{N}(X),U_{Y})-P(Y|X,U_{Y})|_{TV}=0
\Gamma_{N}
N
N
C
X=[x,C,S]
\Gamma_{C}(X)=[x,S]
U_{Y}=\phi
\displaystyle|P(Y|x,S)-P(Y|x,C,S)|_{TV}\neq 0
\displaystyle|P(Y|x,S)-P(Y|x,C,S)|_{TV}\neq 0
x,C,S
P(Y|x,S)\neq P(Y|x,C,S)
C\not\perp Y|S,x
C
S
\Gamma_{S}(X)=[x,C]
\displaystyle|P(Y|x,C)-P(Y|x,C,S)|_{TV}=0
\displaystyle|P(Y|x,C)-P(Y|x,C,S)|_{TV}=0
x,C,S
P(Y|x,C)=P(Y|x,C,S)
S\perp Y|C,x
S
N=A
X=[x,A]
\Gamma_{A}(X)=[x]
A
Y
\displaystyle|P(Y|x)-P(Y|x,A)|_{TV}\neq 0
\displaystyle|P(Y|x)-P(Y|x,A)|_{TV}\neq 0
x,A
A\not\perp Y|x\implies P(Y|x)\neq P(Y|x,A)
(x,A,Y)
A
\mathcal{A}=\{ca_{1},\ldots,ca_{K},sp_{1},\ldots,sp_{J}\}
\bm{z}
[\bm{z}_{ca_{1}},\ldots,\bm{z}_{ca_{K}},\bm{z}_{sp_{1}},\ldots,\bm{z}_{sp_{J}}]
\bm{z}_{ca_{k}}\in\mathbb{R}^{d_{k}}
``ca_{k}"
\bm{z}_{sp_{j}}\in\mathbb{R}^{d_{j}}
``sp_{j}"
d_{k}
d_{j}
\bm{z}_{ca_{k}}
\bm{z}_{sp_{j}}
\mathcal{L}_{AutoACER}\big{(}c(h(\bm{x}))\big{)}\coloneqq\mathcal{L}_{mm}\big{%
(}c(h(\bm{x})),y\big{)}+R\cdot\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}_{ca_{%
k}}\rVert_{p}+\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}_{sp_{j}}\rVert_{p}
\lVert\cdot\rVert_{p}
L_{p}
c(h(\bm{x}))
c(\bm{z})
\bm{z}
\bm{x}
\bm{z}=h(\bm{x})
R\geq 0
\mathcal{L}_{AutoACER}(c^{des}\big{(}\bm{z})\big{)}<\mathcal{L}_{AutoACER}\big%
{(}c^{mm}(\bm{z})\big{)}
\operatorname{mean}\left(\left\{\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\cdot%
\eta_{k,j}\right\}_{k\in[K],j\in[J]}\right)<\frac{J}{K}
\mathcal{L}_{AutoACER}(c^{des}\big{(}\bm{z})\big{)}<\mathcal{L}_{AutoACER}\big%
{(}c^{mm}(\bm{z})\big{)}
R\geq 0
\displaystyle\mathcal{L}_{mm}\big{(}c^{des}(\bm{z}),y\big{)}+R\cdot\Bigg{\{}%
\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Bigg{\}}<
\displaystyle\mathcal{L}_{mm}\big{(}c^{des}(\bm{z}),y\big{)}
\displaystyle+R\cdot\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{des}_%
{ca_{k}}\rVert_{p}\Bigg{\}}<
\displaystyle\mathcal{L}_{mm}\big{(}c^{mm}(\bm{z}),y\big{)}+R\cdot\Bigg{\{}%
\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}+\sum_{j=1}^%
{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}}
\displaystyle\mathcal{L}_{mm}\big{(}c^{mm}(\bm{z}),y\big{)}+R\cdot\Bigg{\{}%
\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}+\sum_{j=1}^%
{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}}
\mathcal{L}_{mm}\big{(}c(\bm{z}),y\big{)}=(-1)\cdot\min_{i}\big{\{}\frac{y^{i}%
c(\bm{z}^{i}))}{\lVert c(\bm{z})\rVert_{2}}\big{\}}
\bm{z}^{i}
\bm{x}^{i}
y^{i}
\lVert c(\bm{z})\rVert_{2}
c(\bm{z})
c^{des}(\bm{z})
c^{mm}(\bm{z})
1
\displaystyle(-1)\cdot\min_{i}\Big{\{}y^{i}c^{des}(\bm{z}^{i})\Big{\}}+R\cdot%
\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}%
\Bigg{\}}<
\displaystyle(-1)\cdot
\displaystyle\min_{i}\Big{\{}y^{i}c^{des}(\bm{z}^{i})\Big{\}}+R\cdot\Bigg{\{}%
\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Bigg{\}}<
\displaystyle(-1)\cdot\min_{j}\Big{\{}y^{j}c^{mm}(\bm{z}^{j})\Big{\}}+R\cdot%
\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}+%
\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}}
\displaystyle(-1)\cdot\min_{j}\Big{\{}y^{j}c^{mm}(\bm{z}^{j})\Big{\}}+R\cdot%
\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}+%
\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}}
\displaystyle R\cdot\underbrace{\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}%
\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}-\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Big%
{]}+\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}%
}}_{LHS-term1}>
\displaystyle R\cdot
\displaystyle\underbrace{\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert%
\bm{w}^{mm}_{ca_{k}}\rVert_{p}-\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Big{]}+%
\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}}}_{%
LHS-term1}>
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\min_{j}\Big{\{}y^{j}c^{mm}(\bm{z}^{j})\Big{\}}-\min_{i}\Big{\{}y^{i}c^{des}(%
\bm{z}^{i})\Big{\}}
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad%
\min_{j}\Big{\{}y^{j}c^{mm}(\bm{z}^{j})\Big{\}}-\min_{i}\Big{\{}y^{i}c^{des}(%
\bm{z}^{i})\Big{\}}
0
R>0
R>\frac{\min_{j}\Big{\{}y^{j}c^{mm}(\bm{z}^{j})\Big{\}}-\min_{i}\Big{\{}y^{i}c%
^{des}(\bm{z}^{i})\Big{\}}}{\Bigg{\{}\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}%
\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}-\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Big%
{]}+\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}\Bigg{\}}}
\operatorname{mean}\left(\left\{\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\cdot%
\eta_{k,j}\right\}_{k\in[K],j\in[J]}\right)<\frac{J}{K}
\displaystyle\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{mm}_{ca_{k}}%
\rVert_{p}-\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Big{]}>(-1)\cdot\sum_{j=1}^{J%
}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}
\displaystyle\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{mm}_{ca_{k}}%
\rVert_{p}-\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}\Big{]}
\displaystyle>(-1)\cdot\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}%
}\rVert_{p}
\displaystyle\implies\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{des}_{%
ca_{k}}\rVert_{p}-\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}\Big{]}<\sum_{j=1}^{J}%
\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}
\displaystyle\implies\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{des}_{%
ca_{k}}\rVert_{p}-\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}\Big{]}
\displaystyle<\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}
\lambda_{(\cdot)}=1/|\hat{TE}_{(\cdot)}|
|\hat{TE}_{(\cdot)}|\in[0,1]
\lambda_{(\cdot)}>0
\bm{w}_{sp_{j}}^{mm}\neq\bm{0}\implies\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}>0
p
\Big{(}
\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}-%
\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}\Big{]}\leq 0\Big{)}
\sum_{j=1}^{J}\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}\rVert_{p}>0
\forall j\in[J],\>\>\lambda_{sp_{j}}>0
\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}>0
\Big{(}
\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{des}_{ca_{k}}\rVert_{p}-%
\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}\Big{]}>0\Big{)}
j\in[J]
\lambda_{sp_{j}}>0
\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}>0
\displaystyle\sum_{j=1}^{J}\frac{\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}%
\rVert_{p}}{\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{des}_{ca_{k}}%
\rVert_{p}-\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}\Big{]}}>1
\displaystyle\sum_{j=1}^{J}\frac{\lambda_{sp_{j}}\lVert\bm{w}^{mm}_{sp_{j}}%
\rVert_{p}}{\sum_{k=1}^{K}\lambda_{ca_{k}}\Big{[}\lVert\bm{w}^{des}_{ca_{k}}%
\rVert_{p}-\lVert\bm{w}^{mm}_{ca_{k}}\rVert_{p}\Big{]}}
\displaystyle>1
\displaystyle\sum_{j=1}^{J}\frac{1}{\sum_{k=1}^{K}\big{(}\frac{\lambda_{ca_{k}%
}}{\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert\bm{w}_{ca_{k}}^{des}\rVert_{p}-%
\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}}%
\big{)}}>1
\displaystyle\sum_{j=1}^{J}\frac{1}{\sum_{k=1}^{K}\big{(}\frac{\lambda_{ca_{k}%
}}{\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert\bm{w}_{ca_{k}}^{des}\rVert_{p}-%
\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}}%
\big{)}}
\displaystyle>1
\displaystyle\frac{1}{\sum_{j=1}^{J}\Bigg{\{}\underbrace{\frac{1}{\sum_{k=1}^{%
K}\big{(}\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert%
\bm{w}_{ca_{k}}^{des}\rVert_{p}-\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert%
\bm{w}_{sp_{j}}^{mm}\rVert_{p}}\big{)}}}_{\text{LHS-term 3}}\Bigg{\}}}\cdot J<J
\displaystyle\frac{1}{\sum_{j=1}^{J}\Bigg{\{}\underbrace{\frac{1}{\sum_{k=1}^{%
K}\big{(}\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert%
\bm{w}_{ca_{k}}^{des}\rVert_{p}-\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert%
\bm{w}_{sp_{j}}^{mm}\rVert_{p}}\big{)}}}_{\text{LHS-term 3}}\Bigg{\}}}\cdot J
\displaystyle<J
>0
j
\displaystyle\sum_{j=1}^{J}\sum_{k=1}^{K}\frac{\big{(}\frac{\lambda_{ca_{k}}}{%
\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert\bm{w}_{ca_{k}}^{des}\rVert_{p}-%
\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}}%
\big{)}}{J\cdot K}<\frac{J}{K}
\displaystyle\sum_{j=1}^{J}\sum_{k=1}^{K}\frac{\big{(}\frac{\lambda_{ca_{k}}}{%
\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert\bm{w}_{ca_{k}}^{des}\rVert_{p}-%
\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}}%
\big{)}}{J\cdot K}<\frac{J}{K}
\mathcal{L}_{AutoACER}(c^{des}\big{(}\bm{z})\big{)}<\mathcal{L}_{AutoACER}\big%
{(}c^{mm}(\bm{z})\big{)}
\big{(}\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\big{)}\big{(}\frac{\lVert\bm{%
w}_{ca_{k}}^{des}\rVert_{p}-\lVert\bm{w}_{ca_{k}}^{mm}\rVert_{p}}{\lVert\bm{w}%
_{sp_{j}}^{mm}\rVert_{p}}\big{)}
J/K
J/K
\lambda
\displaystyle\big{(}\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\big{)}\eta_{k,j}%
<\frac{J}{K}
\displaystyle\big{(}\frac{\lambda_{ca_{k}}}{\lambda_{sp_{j}}}\big{)}\eta_{k,j}
\displaystyle<\frac{J}{K}
\displaystyle\hat{TE}_{sp_{j}}\big{(}\frac{K}{J}\eta_{k,j}\big{)}<\hat{TE}_{ca%
_{k}}
\displaystyle\hat{TE}_{sp_{j}}\big{(}\frac{K}{J}\eta_{k,j}\big{)}
\displaystyle<\hat{TE}_{ca_{k}}
\eta_{k,j}=\big{(}\frac{\lVert\bm{w}_{ca_{k}}^{des}\rVert_{p}-\lVert\bm{w}_{ca%
_{k}}^{mm}\rVert_{p}}{\lVert\bm{w}_{sp_{j}}^{mm}\rVert_{p}}\big{)}
p=2
K=1
J=1
c^{des}(\bm{z})=\bm{w}^{des}_{ca,1}\cdot\bm{z}_{ca,1}=\bm{w}^{des}_{ca}\cdot%
\bm{z}_{ca}
``1"
c^{s}(\bm{z})=\bm{w}^{s}_{ca}\cdot\bm{z}_{ca}+\bm{w}^{s}_{sp}\cdot\bm{z}_{sp}
\bm{z}_{sp}
\bm{w}_{sp}^{s}\neq 0
\lambda_{ca}\cdot\eta<\lambda_{sp}
\mathcal{L}_{AutoACER}(c^{des}(\bm{z}))<\mathcal{L}_{AutoACER}(c^{s}(\bm{z}))
\eta=\frac{\lVert\bm{w}_{ca}^{des}\rVert_{2}-\lVert\bm{w}_{ca}^{s}\rVert_{2}}{%
\lVert\bm{w}_{sp}^{s}\rVert_{2}}
1
\lVert\bm{w}_{ca}^{s}\rVert_{2}^{2}+\lVert\bm{w}_{sp}^{s}\rVert_{2}^{2}=1
\lVert\bm{w}_{ca}^{des}\rVert_{2}=1
\lVert\bm{w}_{ca}^{s}\rVert=\theta\in[0,1)
\lVert\bm{w}_{sp}^{s}\rVert=\sqrt{1-\theta^{2}}
\eta
\displaystyle\eta(\theta)=\frac{1-\theta}{\sqrt{1-\theta^{2}}}
\displaystyle\eta(\theta)
\displaystyle=\frac{1-\theta}{\sqrt{1-\theta^{2}}}
\displaystyle=\sqrt{\frac{1-\theta}{1+\theta}}\quad\quad(\theta\neq 1)
\displaystyle=\sqrt{\frac{1-\theta}{1+\theta}}\quad\quad(\theta\neq 1)
\eta(\theta)
\theta\in[0,1)
\eta_{max}=1
\theta=0
\lambda_{ca}\cdot\eta_{max}<\lambda_{sp}\implies\lambda_{ca}<\lambda_{sp}
\mathcal{L}_{AutoACER}(c^{des}(\bm{z}))<\mathcal{L}_{AutoACER}(c^{s}(\bm{z}))
c^{s}(\bm{z})
\lambda_{ca}<\lambda_{sp}
c^{des}(\bm{z})
c^{s}(\bm{z})
c^{\psi}(\bm{z})\neq c^{des}(\bm{z})
\displaystyle\mathcal{L}_{AutoACER}(c^{des}(\bm{z}))=\mathcal{L}_{mm}(c^{des}(%
\bm{z}))+R\cdot\Big{\{}\lambda_{ca}\lVert\bm{w}_{ca}^{des}\rVert_{2}\Big{\}}=%
\mathcal{L}_{mm}(c^{des}(\bm{z}))+R\lambda_{ca}\cdot 1
\displaystyle\mathcal{L}_{AutoACER}(c^{des}(\bm{z}))=\mathcal{L}_{mm}(c^{des}(%
\bm{z}))+R\cdot\Big{\{}\lambda_{ca}\lVert\bm{w}_{ca}^{des}\rVert_{2}\Big{\}}=%
\mathcal{L}_{mm}(c^{des}(\bm{z}))+R\lambda_{ca}\cdot 1
\displaystyle\mathcal{L}_{AutoACER}(c^{\psi}(\bm{z}))=\mathcal{L}_{mm}(c^{\psi%
}(\bm{z}))+R\cdot\Big{\{}\lambda_{ca}\lVert\bm{w}_{ca}^{\psi}\rVert_{2}\Big{\}%
}=\mathcal{L}_{mm}(c^{\psi}(\bm{z}))+R\lambda_{ca}\cdot 1
\displaystyle\mathcal{L}_{AutoACER}(c^{\psi}(\bm{z}))=\mathcal{L}_{mm}(c^{\psi%
}(\bm{z}))+R\cdot\Big{\{}\lambda_{ca}\lVert\bm{w}_{ca}^{\psi}\rVert_{2}\Big{\}%
}=\mathcal{L}_{mm}(c^{\psi}(\bm{z}))+R\lambda_{ca}\cdot 1
\mathcal{L}_{mm}(c^{des}(\bm{z}))<\mathcal{L}_{mm}(c^{\psi}(\bm{z}))
c^{\psi}(\bm{z})
\mathcal{L}_{AutoACER}
P(Y|\text{casual},\text{confound})
Y
P(Y|\text{casual},\text{confound})
Y
Y=0
Y=1
Y
P(\text{causal}=0)=P(\text{causal}=1)=0.5
P(\text{confound}=0)=P(\text{confound}=1)=0.5
P(\text{spurious}|\text{confound})=\kappa
U
A
\kappa=P(\text{spurious}|\text{confound})
\bm{x}_{a^{\prime}}\sim\mathcal{Q}(\bm{x}_{a})
A=a
A=a^{\prime}
3
4
3
4
P(\text{color}|\text{digit})=0.5
Y
0^{\degree}
90^{\degree}
P(\text{rotation}|\text{color, digit})
\kappa=P(\text{rotation}|\text{color, digit})
C
S
x
X
\bm{x}_{a^{\prime}}\sim\mathcal{Q}(\bm{x}_{a})
A=a
A=a^{\prime}
\bm{x}_{a^{\prime}}\sim\mathcal{Q}(\bm{x}_{a})
A=a
A=a^{\prime}
\geq 0.5
\bm{x}
\kappa
y
a
0
1
(y,a)
(y=1,a=1)
(y=0,a=0)
S_{maj}
y
S_{min}
(y=1,a=0)
(y=0,a=1)
\kappa=Pr(y=a)
\kappa
\kappa\coloneqq\frac{|S_{maj}|}{|S_{maj}|+|S_{min}|}
\kappa
\{0.5,0.6,0.7,0.8,0.9,0.99\}
S_{maj}
S_{min}
S_{maj}
\kappa
S_{min}
\kappa
|S_{maj}|+|S_{min}|
\kappa
Y
\mathbb{E}[Y|X,A]
Y
(X,A)
\mathbb{E}[Y|X,A]
\Big{[}Y-g(X,A)\Big{]}^{2}+R\cdot\text{L2loss}
g(X,A)
Y
(X,A)
R\in\{0.0,0.1,1.0,10.0,100.0,200.0,1000.0\}
R\in\{0.0,10.0,100.0,1000.0\}
R\in\{0.0,1.0,10.0,100.0,200.0,1000.0\}
R_{1}
1
R_{2}
R_{2}\in\{0.0,0.1,1.0,10.0,100.0,200.0,1000.0\}
R_{2}\in\{0.0,10.0,100.0,200.0,1000.0\}
R_{2}\in\{0.0,1.0,10.0,100.0,200.0,1000.0\}
g(X,A)
Y
(X,A)
\mathcal{L}_{task}
\{-1.0,-0.5,-0.1,0.0,0.1,0.3,0.5,1.0\}
\{-1.0,-0.7,-0.5,-0.3,-0.1,0.0,0.1,0.3,0.5,0.7,1.0\}
\mathcal{L}_{Reg}
R
R
\{1,10,100,1000\}
\text{accuracy of model}=\frac{\sum_{i=1}^{N}\mathds{1}(f(\bm{x}_{i})=y_{i})}{N}
\mathds{1(\cdot)}
1
0
f
\bm{x}_{i}
y_{i}
\text{selection criteria}=\frac{\text{Majority Group Accuracy}+\text{Minority %
Group Accuracy + (1-$\Delta$Prob)}}{3}
\Delta
\mathcal{A}
\alpha
\alpha\subset\mathcal{A}
Y
\alpha
\alpha
\alpha
R
\{1,10,100,1000\}
\{4,8\}
\lambda_{up}
\lambda_{up}
\{2,4,8\}
\{2,4\}
R^{e}
w=1.0
\lambda
\{1e15,5e15\}
\{1e14\}
\{1e14,5e14,1e15\}
\kappa
0
0
(\kappa\leq 0.7)
\kappa
\kappa
\kappa
\kappa
0
0
(\kappa\leq 0.7)
\kappa
\kappa
\kappa
\kappa
\kappa
0
\kappa
\Delta
\kappa
0
\kappa
\Delta
\kappa
\kappa
\kappa
\kappa
\kappa
\kappa
\kappa
0
0
\kappa
\kappa=0.99
\kappa
\kappa
0
0
\kappa
\kappa=0.99
\kappa
\kappa
\kappa
0
P(X|do(A))
\mathcal{Q}\coloneqq P(\bm{x}_{a^{\prime}}|\bm{x}_{a})
\kappa
0
P(X|do(A))
\mathcal{Q}\coloneqq P(\bm{x}_{a^{\prime}}|\bm{x}_{a})
\kappa
\kappa
\kappa<0.7
\kappa>0.8
\kappa\leq 0.9
\kappa=0.99
\kappa
\kappa<0.7
\kappa>0.8
\kappa\leq 0.9
\kappa=0.99
\Delta
\Delta
\Delta
0
\kappa\leq 0.9
\Delta
\Delta
\Delta
0
\kappa\leq 0.9
\kappa
\kappa\leq 0.7
\kappa>0.7
\kappa
\kappa
\Delta
\Delta
\kappa<0.9
\Delta
\kappa
\Delta
\Delta
\Delta
\Delta
\kappa
\Delta
\Delta
\Delta
\Delta
\kappa
\Delta
\kappa
\kappa
\kappa
\kappa
\Delta
\Delta
\Delta
\kappa
\Delta
\kappa
\kappa
\kappa
\kappa
\Delta
\Delta
\Delta
\kappa
\Delta
\Delta
\Delta
\Delta
\kappa
\Delta
\Delta
\Delta
\kappa
\Delta
\leq 0.10
0
\kappa
\Delta
\leq 0.10
0
\kappa
\Delta
R
\kappa=0.99
R=10
\Delta
1
\Delta
\kappa
\Delta
R
\kappa=0.99
R=10
\Delta
1
\Delta
\kappa
\Delta
R
\kappa=0.99
R
\Delta
\kappa
\Delta
R
\kappa=0.99
R
\Delta
\kappa
\Delta
R
\kappa
\Delta
\kappa
\Delta
R
\kappa
\Delta
\cdot
\cdot
\kappa
\Delta
\Delta
\cdot
\cdot
\kappa
\Delta
\Delta
\cdot
\cdot
\kappa
\Delta
\Delta
\cdot
\cdot
\kappa
\Delta
\Delta
\cdot
\cdot
\kappa
\Delta
\cdot
\cdot
\kappa
\Delta
\Delta
\Delta
\Delta
\kappa
\Delta
\Delta
>0.5
\Delta
\Delta
