\alpha
\alpha
t
\alpha<t
t
t
w
w
w
Z
M
w
z,m:\mathbb{R}{[0,\infty]}\mapsto\mathbb{R}{[0,1]}
Z
M
z(|a|)<z(|b|)
|a|>|b|
Z
m(|a|)>m(|b|)
|a|>|b|
M
z(w)+m(w)=1
w
z(w)=\begin{cases}1&\text{if $w=0$}\\
0&\text{if $|w|=\infty$}\\
\frac{1}{2}&\text{if $|w|=t$}\\
\end{cases}
w=0
|w|=\infty
|w|=t
w\in R_{[0,1]}
t=0.6
w\in R_{[0,1]}
t=0.6
z(w),m(w)
Z
M
t
Z
M
z(w),m(w)
Z
M
t
Z
M
t\in\mathbb{R}_{\geq 0}
z(t)=m(t)=0.5
Z
M
m(w)
w
topK(X,k)/bottomK(X,k)
k
X
abs(X)
n(X)
t
r\in[0,1)
W
r
W
t
W
t
m(w)
w
\hat{w}
\tau
t
\hat{w}
t
t
r
z
m
t
W
w
W
t
\hat{w}
\hat{w}
\hat{w}=m(w)\cdot w=\frac{e^{\frac{w^{2}}{\tau}}}{e^{\frac{w^{2}}{\tau}}+e^{%
\frac{t^{2}}{\tau}}}\cdot w
w,\Delta w
\Delta w=m(w)\Delta\hat{w}+2\frac{w^{2}}{\tau}m(w)\{1-m(w)\}\Delta\hat{w}
\frac{w^{2}}{\tau}m(w)\{1-m(w)\}\geq 0
m(w)\approx 0
{\Delta w}\approx 0
m(w)\approx 1
{\Delta w}\approx\Delta\hat{w}
m(w)\approx 0.5
m_{w}(1-m_{w})
{\Delta w}
w
\tau
t
w_{4}
w_{\{0,1,2,3\}}
w_{2}
w_{2}
\times e6
N
M
M
M
t
s=16
\epsilon=0.015
\times e6
\times e6
\diamondsuit
\diamondsuit
abs(W)
\%
\%
\beta
beta\leq\epsilon
\tau:1e^{-4},\epsilon:0.015
\beta:1.0
\tau:1e^{-4},\epsilon:0.015
\tau:1e^{-4},\epsilon:0.015
\beta:1.0
\tau:1e^{-4},\epsilon:0.015
\tau:1e^{-4},\epsilon:0.015
\beta:1.0
\tau:1e^{-4},\epsilon:0.015
\beta:1.0
\tau:1e^{-4},\epsilon:0.015
\beta:1.0
\tau:1e^{-4},\epsilon:0.015
\beta
beta\leq\epsilon
msec
msec
\epsilon,s,r,W=[W_{0},W_{1},...]
e
[0,1,2,s)
[W_{0},W_{2},...]
W
W_{p}=topK(-abs(W),r\cdot n(W))
[r_{0},r_{1},...]=[\frac{n(W_{p}\cap W_{0})}{n(W_{0})},\frac{n(W_{p}\cap W_{1}%
)}{n(W_{1})},...]
e
[s,s+1,s+2,...]
[\hat{r_{0}},\hat{r_{1}},...]=min(1,\epsilon\cdot(e-s))\cdot[r_{0},r_{1},...]
i\in\{0,1,...\}
W_{h}=topK(abs(W_{i}),(1-\hat{r_{i}})\cdot n(W_{i}))
W_{l}=bottomK(abs(W_{i}),\hat{r_{i}}\cdot n(W)_{i})
t_{i}=0.5\{min(W_{h})+max(W_{l})\}
i\in\{0,1,...\}
[Z_{i},M_{i}]=softmax(\frac{[t_{i}^{2}\mathbb{J},W_{i}\circ W_{i}]}{\tau})
\hat{W}_{i}
M_{i}\circ W_{i}
\hat{W}_{i}
W
W_{i}=\lfloor{M_{i}}\rceil\circ W_{i},\forall i\in\{0,1,..\}
t
r
t
0
r
\epsilon
r
r
r
r
r
s
r\cdot n(W)
t_{i}
O(W)
topK
W
block\_size=128
n\_layer=3
\Delta
\tau
\tau
\tau
\tau
\tau
\tau
\tau
\tau=1e-4
\tau
\tau
\tau
\tau
