\sim
\sim
g_{i}
g_{i}^{(j)}
g_{i}^{(j)}=(\mathcal{V},E)
\mathcal{V}=\{v_{1},\cdots,v_{z}\}
E=\{(v,v^{\prime})|(v,v^{\prime})\in\mathcal{V}\times\mathcal{V}\}
\mathcal{V}(g_{i}^{(j)}),E(g_{i}^{(j)})
g_{i}^{(j)}
g_{i}=\langle g_{i}^{(1)}\cdots g_{i}^{(j)}\cdots g_{i}^{(m)}\rangle
g_{i}^{(1)}
g_{i}
L_{i}
g_{i}=\langle g_{i}^{(1)}\cdots g_{i}^{(m)}\rangle
g_{i}^{\prime}=\langle g_{i}^{(k)}\cdots g_{i}^{(m^{\prime})}\rangle
1\leq k\leq m^{\prime}\leq m
\mathcal{G}=\{g_{1},\cdots,g_{n}\}
\mathcal{G}
t
\bm{x}_{j}\in\bm{X}
q-t+1
\bm{x}_{j}^{(1)}
\bm{x}_{j}^{(q-t+1)}
\bm{X}
(q-t+1)\times n
\bm{\Omega}=[\varphi_{1},\cdots,\varphi_{(q-t+1)\times n}]
\varphi_{j}\in\bm{\Omega}
\bm{s}_{(j,k)}
\bm{x}_{j}
\varphi_{k}
t\ll q
(q-t+1)\times n
\bm{\Omega}
\bm{x}_{j}\in\bm{X}
\bm{\Omega}
\bm{s}_{i}=[s_{i,1},\cdots,s_{(i,(q-t+1)\times n)}]
\bm{x}_{j}^{\prime}s
s_{i,j}
\bm{x}_{j}
\varphi_{j}\in\bm{\Omega}
s_{i,j}=d_{(\bm{x}_{i},\varphi_{j})}
\bm{X}
\bm{S}=[\bm{s}_{1},\bm{s}_{2},\cdots,\bm{s}_{n}]\in\mathbb{R}^{(q-t+1)\times n%
,n}
\bm{s}_{j}
\bm{x}_{j}
\bm{\Omega}
g_{i}
v
v^{\prime}
g_{i}^{(j)}
ID(\mathcal{V})
ID(E)
\displaystyle ID(\mathcal{V})=\{id(v)|v\in\cup_{g_{i}^{(j)}\in g_{i}}\mathcal{%
V}(g_{i}^{(j)})\},
\displaystyle ID(\mathcal{V})=\{id(v)|v\in\cup_{g_{i}^{(j)}\in g_{i}}\mathcal{%
V}(g_{i}^{(j)})\},
\displaystyle ID(E)=\{(id(v),id(v^{\prime}))|(v,v^{\prime})\in\cup_{g_{i}^{(j)%
}\in g_{i}}E(g_{i}^{(j)})\}.
\displaystyle ID(E)=\{(id(v),id(v^{\prime}))|(v,v^{\prime})\in\cup_{g_{i}^{(j)%
}\in g_{i}}E(g_{i}^{(j)})\}.
v+^{(j,k)}_{u}
\neg\exists v\in\mathcal{V}(g_{i}^{(j)})~{}s.t.~{}id(v)=u
\exists v^{\prime}\in\mathcal{V}(g_{i}^{(j+1)})~{}s.t.~{}id(v^{\prime})=u\}
v-^{(j,k)}_{u}
\exists v\in\mathcal{V}(g_{i}^{k})~{}s.t.~{}id(v)=u
\neg\exists(v_{1},v_{2})\in E(g_{i}^{(k)})~{}s.t.~{}(id(v_{1})=u)\vee(id(v_{2}%
)=u)
\neg\exists v^{\prime}\in\mathcal{V}(g_{i}^{k+1})~{}s.t.~{}id(v^{\prime})=u\}
e+_{(u_{1},u_{2})}^{(j,k)}
\neg\exists(v_{1},v_{2})\in E(g_{i}^{(j)}),\exists v_{1}\in\mathcal{V}(g_{i}^{%
(j)}),
\exists v_{2}\in\mathcal{V}(g_{i}^{(j)})~{}s.t.(id(v_{1})=u_{1})\wedge(id(v_{2%
})=u_{2})
\exists(v_{1}^{\prime},v_{2}^{\prime})\in E(g_{i}^{(j+1)})s.t.(id(v_{1}^{%
\prime}=u_{1})\wedge(id(v_{2}^{\prime}=u_{2})
e-_{(u_{1},u_{2})}^{(j,k)}
\neg\exists(v_{1},v_{2})\in E(g_{i}^{(j)}),s.t.(id(v_{1})=u_{1})\wedge(id(v_{2%
})=u_{2})
\neg\exists(v_{1}^{\prime},v_{2}^{\prime})\in E(g_{i}^{(j+1)}),\exists v_{1}^{%
\prime}\in\mathcal{V}(g_{i}^{j+1}),
\exists v_{2}^{\prime}\in\mathcal{V}(g_{i}^{(j+1)})~{}s.t.(id(v_{1}^{\prime}=u%
_{1})\wedge(id(v_{2}^{\prime}=u_{2})
*
k
①
②
③
④
⑤
①
②
③
④
⑤
g_{i}^{(k)}
g_{i}^{(k+1)}
op_{g_{i}}^{k}
op_{g_{i}}^{k}=\langle op_{g_{i}}^{(k,1)}\cdots op_{g_{i}}^{(k,l_{k})}\rangle
l_{k}
op_{g_{i}}^{k}
v+,e+,e-,v-
g_{i}=\langle g_{i}^{(1)}\cdots g_{i}^{(m)}\rangle
ts(g_{i})=\langle op_{g_{i}}^{1}\cdots op_{g_{i}}^{(m-1)}\rangle,
ts(g_{i}^{\prime})=\langle op_{g_{i}^{\prime}}^{1}\cdots op_{g_{i}^{\prime}}^{%
(m^{\prime}-1)}\rangle
ts(g_{i})
ts(g_{i}^{\prime})\subseteq ts(g_{i}),m^{\prime}\leq m
\forall op_{g_{i}^{\prime}}^{k^{\prime}}\in ts(g_{i}^{\prime}),1\leq k^{\prime%
}\leq m^{\prime}-1,\exists op_{g_{i}}^{k}\in ts(g_{i}),1\leq k\leq m-1;op_{g_{%
i}^{\prime}}^{k^{\prime}}=op_{g_{i}}^{k}
g_{i}
g_{i}^{(1)}
g_{i}^{(2)}
op_{g_{i}}^{1}=\langle e-_{(1,2)}^{(1,1)}v-_{1}^{(1,2)}\rangle
(1,1)
(1,2)
g_{i}^{(1)}
g_{i}^{(2)}
e-
v-
(1,2)
1
op_{g_{i}}^{2}=\langle v+_{5}^{(2,1)}e+_{(2,5)}^{(2,2)}e+_{(3,5)}^{(2,3)}\rangle
\langle g_{i}^{(1)}g_{i}^{(2)}g_{i}^{(3)}\rangle
\langle e-^{(1,1)}_{(1,2)}v-^{(1,2)}_{1}v+^{(2,1)}_{5}e+^{(2,2)}_{(2,5)}e+^{(2%
,3)}_{(3,5)}\rangle
\langle v-^{(1,2)}_{1}e+^{(2,2)}_{(2,5)}e+^{(2,3)}_{(3,5)}\rangle
e+^{(2,3)}_{(3,5)}
ts(g_{i})
ts(g_{j})
Sim(ts(g_{i}),ts(g_{j}))
ts(g_{i})=\langle op_{g_{i}}^{1}\cdots op_{g_{i}}^{(m-1)}\rangle,1\leq k\leq m-1
op_{g_{i}}^{k}=\langle op_{g_{i}}^{(k,1)}\cdots op_{g_{i}}^{(k,l_{k})}\rangle
l_{k}
op_{g_{i}}^{k}
Sim(ts(g_{i}),ts(g_{j}))=\sum\limits_{k,v}\sum\limits_{p=1}^{l_{k}}\sum\limits%
_{q=1}^{l_{v}}\hbar_{(i,j)}^{(k,p),(v,q)}
\hbar_{(i,j)}^{(k,p),(v,q)}=I(op_{g_{i}}^{(k,p)}=op_{g_{j}}^{(v,q)})
I(\cdot)
l_{k}
op_{g_{i}}^{k}
m,m^{\prime}
g_{i}
g_{i}^{\prime}
\mathcal{V},\emph{E}
\mathcal{V}_{v+}
\mathcal{V}_{v-}
{E}_{e+}
{E}_{e-}
v+^{(j,k)}_{u}
u
g_{i}^{(j)}
g_{i}^{(j+1)}
v-^{(j,k)}_{u}
u
g_{i}^{(j)}
g_{i}^{(j+1)}
e+^{(j,k)}_{(u_{1},u_{2})}
u_{1}
u_{2}
g_{i}^{(j)}
g_{i}^{(j+1)}
e-^{(j,k)}_{u}
u_{1}
u_{2}
g_{i}^{(j)}
g_{i}^{(j+1)}
*
k
\langle v+^{(2,1)}_{5}e+^{(2,2)}_{(2,5)}e+^{(2,3)}_{(3,5)}\rangle
ts(g_{i})
\langle v+^{(2,1)}_{5}e+^{(2,2)}_{(1,5)}e+^{(2,3)}_{(2,5)}e+^{(2,4)}_{(2,8)}\rangle
ts(g_{t})
Sim(ts(g_{i}),ts(g_{t}))=2
e+^{(2,3)}_{(2,5)}=e+^{(2,2)}_{(2,5)}
\mathcal{G}
\mathcal{G}
g^{(j)},g^{(i)}
\displaystyle v+^{(j,k)}_{u_{1}}\prec e+^{(j,k^{\prime})}_{(u_{1},u_{2})},e+^{%
(j,k)}_{(u_{1},u_{2})}\prec e-^{(j,k^{\prime})}_{(u_{1},u_{2})},e-^{(j,k)}_{(u%
_{1},u_{2})}\prec v-^{(j,k^{\prime})}_{u_{1}}
\displaystyle v+^{(j,k)}_{u_{1}}\prec e+^{(j,k^{\prime})}_{(u_{1},u_{2})},e+^{%
(j,k)}_{(u_{1},u_{2})}\prec e-^{(j,k^{\prime})}_{(u_{1},u_{2})},e-^{(j,k)}_{(u%
_{1},u_{2})}\prec v-^{(j,k^{\prime})}_{u_{1}}
k<k^{\prime}
v+^{(j,k)}_{u},v-^{(j,k)}_{u},e+_{(u_{1},u_{2})}^{(j,k)},e-_{(u_{1},u_{2})}^{(%
j,k)}
v+_{1}^{(1,1)}\prec v+_{2}^{(1,2)}
g_{i}^{(1)}
\mathcal{G}
l
\mathcal{G}^{\prime}
D\leftarrow
\mathcal{G}
D
cSet\leftarrow\emptyset
l
l
t
D
S^{l}_{t}\leftarrow
l
t
cSet\leftarrow cSet\bigcup\mathcal{S}_{t}^{l}
\leftarrow
cSet
D
g_{i}
\mathcal{G}
g_{i}^{\prime}\leftarrow
g_{i}
\mathcal{G}^{\prime}=\mathcal{G}^{\prime}\bigcup g_{i}^{\prime}
\mathcal{G}^{\prime}
t_{i}=\{t_{i}^{(1)},\cdots,t_{i}^{(m)}\}
g_{i}
K_{t_{i}}^{(j)}=N_{n}(g_{i}^{(j)})+N_{e}(g_{i}^{(j)})
N_{n}(g_{i}^{(j)})
N_{e}(g_{i}^{(j)})
g_{i}^{(j)}
j
1\leq j\leq m
g_{i}^{(1)},g_{i}^{(2)},\cdots,g_{i}^{(m)}
7,5,\cdots,6
\{7,5,\cdots,6\}
K_{t_{i}}^{(j)}
\mathcal{G}
l
\mathcal{G}
K_{t_{i}}^{(j)}
N_{n}(g_{i}^{(j)})
N_{e}(g_{i}^{(j)})
\mathcal{G}
\mathcal{G}^{\prime}
ts
ts\leftarrow\emptyset
g_{i}\in\mathcal{G}^{\prime}
g_{i}^{(j)}\in g_{i}
g_{i}^{(j)}
\mathcal{V}_{v+},\mathcal{V}_{v-},E_{e+},E_{e-}
k\leftarrow 1
v
\mathcal{V}_{v+}
ts\leftarrow ts\bigcup{v+}^{(j,k++)}_{id(v)}
(v,v^{\prime})
E_{e+}
ts\leftarrow ts\bigcup{e+}^{(j,k++)}_{(id(v),id(v^{\prime}))}
(v,v^{\prime})
E_{e-}
ts\leftarrow ts\bigcup{e-}^{(j,k++)}_{(id(v),id(v^{\prime}))}
v
\mathcal{V}_{v-}
ts\leftarrow ts\bigcup{v-}^{(j,k++)}_{id(v)}
ts
\mathcal{G}
n
l
L_{t}
g_{t}
graph\_shapelt\leftarrow\emptyset
candidates\leftarrow
(\mathcal{G},l)
max\_sim\leftarrow 0
ts\leftarrow
candidates
ts_{i}\in ts
d_{i}\leftarrow\sum_{j}Sim(ts_{i},ts_{j}),ts_{j}\in ts(i\neq j)
d_{i}>max\_sim
max\_sim\leftarrow d_{i}
graph\_shapelets\leftarrow ts_{i}
ts(g_{t})\leftarrow
g_{t}
graph\_shapelet
graph\_shapelets
Sim(graph\_shapelet,g_{t})
L_{t}
L_{t}
\mathcal{G}=\{g_{i}|g_{i}=\langle g_{i}^{(1)}\cdots g_{i}^{(m)}\}
ts(\mathcal{G})=\{ts(g_{i})|g_{i}\in\mathcal{G}\}
\mathcal{G}
<g_{i}^{(2)}g_{i}^{(3)}>
<v+_{5}^{(2,1)},e+_{(2,5)}^{(2,2)},e+_{(3,5)}^{(3,3)}>
<e+_{(2,5)}^{(2,2)},v+_{5}^{(2,1)},e+_{(3,5)}^{(3,3)}>
\langle g_{i}^{(2)}g_{i}^{(3)}\rangle
(2,5)
(3,5)
g_{i}^{(2)}
g_{i}^{(3)}
v+^{(2,1)}_{5},e+^{(2,2)}_{(2,5)},e+^{(2,3)}_{(3,5)}
m
l
r
n
m
n
l
O(ml*n)
O(mrl*n)
N
\alpha
\alpha/2
\alpha
p
\alpha=4
p=0.1
g_{0}^{(0)}
g_{0}^{(0)}
g_{0}
g_{0}^{(0)}
\beta=1.5
g_{0}^{(1)},\cdots,g_{0}^{(i)}
g^{(j)}
\mathcal{G}
|V|=(1\sim 20)
1
50
\sigma
\mathcal{G}=\{g_{i}|g_{i}=\langle g_{i}^{(1)}\cdots g_{i}^{(m_{i})}\rangle\}
\sigma
g^{\prime}
\sigma=\frac{|\{g_{i}|g_{i}\in\mathcal{G},ts(g^{\prime})\sqsubseteq ts(g_{i})%
\}|}{|\mathcal{G}|}~{}for~{}subsequences,
\sigma=\frac{|\{g_{i}|g_{i}\in\mathcal{G},g^{\prime}\sqsubseteq g_{i}\}|}{|%
\mathcal{G}|}~{}for~{}subgraphs.
