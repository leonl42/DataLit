\mathcal{D}_{i}=\{(\textbf{x}_{k}^{i},y_{k}^{i})\}_{k=1}^{m_{i}}
i=1,...,N
f
t
\bm{\theta}_{i}^{t}
\mathcal{D}_{i}
\nabla\bm{\theta}_{i}^{t}
\bm{\theta}_{i}^{t}
\bm{\theta}_{i}^{t}
\displaystyle\bm{\theta}_{G}^{t+1}\leftarrow\bm{\theta}_{G}^{t}-\frac{\alpha_{%
\bm{\theta}}}{N}\sum_{i=1}^{N}\nabla\bm{\theta}_{i}^{t},
\displaystyle\bm{\theta}_{G}^{t+1}\leftarrow\bm{\theta}_{G}^{t}-\frac{\alpha_{%
\bm{\theta}}}{N}\sum_{i=1}^{N}\nabla\bm{\theta}_{i}^{t},
\alpha_{\bm{\theta}}
\bm{\theta}_{G}^{t+1}
g_{\bm{\phi}}
f_{\bm{\theta}}
\mathcal{D}_{v}=\{(\textbf{x}_{k}^{v},y_{k}^{v})\}_{k=1}^{m_{v}}
\mathcal{D}_{i}
\mathcal{D}_{v}
\bm{\theta}_{i}^{t}
\bm{\omega}^{t}
g_{\bm{\phi}}(\bm{\theta}^{t})=\bm{\omega^{t}}
\textbf{S}^{t}=[s_{1}^{t},...,s_{n}^{t}]
s_{i}^{t}\in\{0,1\}
\bm{\theta_{i}^{t}}
P(s_{i}^{t}=1)=\bm{\omega}_{i}^{t}
\bm{\theta_{i}^{t}}
r
\mathcal{D}_{v}
\bm{\theta}_{G}
\textbf{S}^{t}
r(\textbf{S}^{t})
\displaystyle r(\textbf{S}^{t})=\frac{1}{m_{v}}\sum_{k=1}^{m_{v}}L_{v}\left(f_%
{\bm{\theta}_{G}}(\textbf{x}_{k}^{v}),y_{k}^{v}\right)-\delta,
\displaystyle r(\textbf{S}^{t})=\frac{1}{m_{v}}\sum_{k=1}^{m_{v}}L_{v}\left(f_%
{\bm{\theta}_{G}}(\textbf{x}_{k}^{v}),y_{k}^{v}\right)-\delta,
L_{v}
\mathcal{D}_{v}
\delta
L_{v}
T>0
\displaystyle\bm{\theta}_{G}^{t+1}\leftarrow\bm{\theta}_{G}^{t}-\frac{\alpha_{%
\bm{\theta}}}{\sum_{i=1}^{N}s_{i}^{t}}\sum_{i=1}^{N}s_{i}^{t}\nabla\bm{\theta}%
_{i}^{t}.
\displaystyle\bm{\theta}_{G}^{t+1}\leftarrow\bm{\theta}_{G}^{t}-\frac{\alpha_{%
\bm{\theta}}}{\sum_{i=1}^{N}s_{i}^{t}}\sum_{i=1}^{N}s_{i}^{t}\nabla\bm{\theta}%
_{i}^{t}.
g_{\bm{\phi}}
\displaystyle J(\bm{\phi})=\mathbb{E}_{\textbf{S}^{t}\sim\pi_{\bm{\phi}}(\bm{%
\theta}^{t},\cdot)}r(\textbf{S}^{t}),
\displaystyle J(\bm{\phi})
\displaystyle=\mathbb{E}_{\textbf{S}^{t}\sim\pi_{\bm{\phi}}(\bm{\theta}^{t},%
\cdot)}r(\textbf{S}^{t}),
\pi_{\bm{\phi}}(\bm{\theta}^{t},\cdot)
\bm{\phi}
\textbf{S}^{t}
p(\textbf{S}^{t}|\bm{\phi})=\prod_{i=1}^{n}[{\bm{\omega}_{i}^{t}}^{s_{i}^{t}}%
\cdot(1-{\bm{\omega}_{i}^{t}})^{1-s_{i}^{t}}]
\displaystyle\nabla_{\bm{\phi}}p(\textbf{S}^{t}|\bm{\phi})=p(\textbf{S}^{t}|%
\bm{\phi})\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm{\phi}),
\displaystyle\nabla_{\bm{\phi}}p(\textbf{S}^{t}|\bm{\phi})=p(\textbf{S}^{t}|%
\bm{\phi})\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm{\phi}),
\displaystyle\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm{\phi})=\sum_{i=1}^{n}%
s_{i}^{t}\nabla_{\bm{\phi}}\log\bm{\omega}^{t}_{i}+(1-s_{i}^{t})\nabla_{\bm{%
\phi}}\log(1-\bm{\omega}^{t}_{i}).
\displaystyle\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm{\phi})=\sum_{i=1}^{n}%
s_{i}^{t}\nabla_{\bm{\phi}}\log\bm{\omega}^{t}_{i}+(1-s_{i}^{t})\nabla_{\bm{%
\phi}}\log(1-\bm{\omega}^{t}_{i}).
\displaystyle\nabla_{\bm{\phi}}J(\bm{\phi})=\mathbb{E}_{\textbf{S}^{t}\sim\pi_%
{\bm{\phi}}(\bm{\theta}^{t},\cdot)}\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm%
{\phi})r(\textbf{S}^{t}).
\displaystyle\nabla_{\bm{\phi}}J(\bm{\phi})=\mathbb{E}_{\textbf{S}^{t}\sim\pi_%
{\bm{\phi}}(\bm{\theta}^{t},\cdot)}\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm%
{\phi})r(\textbf{S}^{t}).
\bm{\phi}
\alpha
\displaystyle\bm{\phi}^{t+1}\leftarrow\bm{\phi}^{t}+\alpha_{\bm{\phi}}\sum_{i=%
1}^{n}r(\bm{S}^{t})\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm{\phi})|_{\bm{%
\phi}^{t}}.
\displaystyle\bm{\phi}^{t+1}\leftarrow\bm{\phi}^{t}+\alpha_{\bm{\phi}}\sum_{i=%
1}^{n}r(\bm{S}^{t})\nabla_{\bm{\phi}}\log p(\textbf{S}^{t}|\bm{\phi})|_{\bm{%
\phi}^{t}}.
\alpha_{\bm{\theta}},\alpha_{\bm{\phi}}>0
T>0
\bm{\theta_{G}^{0}},\bm{\phi^{0}}
\delta
t=1,2,...
c=1,2,...,N
c
\bm{\theta}^{t-1}_{G}
\bm{\theta}^{t-1}_{c}
c
\bm{\theta_{c}^{t}}
\bm{\theta}^{t}=[\bm{\theta}_{1}^{t},...,\bm{\theta}_{N}^{t}]
\bm{\omega}^{t}=g_{\bm{\phi}}(\bm{\theta}^{t})
\textbf{S}^{t}\sim Ber(\bm{\omega}^{t})
\bm{\theta_{G}^{t-1}}
r(\textbf{S}^{t})
\bm{\phi}^{t}
\bm{\phi}^{t}
\delta\leftarrow\frac{T-1}{T}\delta+\frac{1}{T}L_{v}(f_{\bm{\theta}_{G}}(%
\textbf{x}^{v}),y^{v})
\geq 50
f_{\bm{\theta}}
max\_words=1000
max\_len=150
\alpha_{\bm{\phi}}=10^{-5}
\alpha_{\bm{\theta}}=0.1
\bm{\phi}
