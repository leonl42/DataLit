15.7\%
\displaystyle{\displaystyle P(o_{1:T}\ |\ o_{0},G)}
\displaystyle P(r_{0:T}\ |\ o_{0:T},G)
\displaystyle P(a_{0:T}\ |\ o_{0:T},r_{0:T},G)
G
o_{0}
\mathcal{M}:=(\mathcal{O},\mathcal{S},\mathcal{A},\mathcal{G},\mathcal{P},%
\mathcal{R},\mathcal{E},\gamma,p_{0}(s),T)
\mathcal{O}
\mathcal{S}
\mathcal{A}
\mathcal{G}
\mathcal{P}:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\rightarrow[0,1]
\mathcal{R}:\mathcal{G}\times\mathcal{S}\times\mathcal{A}\mapsto\mathbb{R}
a
s
\mathcal{E}=P(o|s)
o
s
\gamma
p_{0}\left(s_{0}\right)
T
\pi^{*}
\eta_{\mathcal{M}}:=\mathbb{E}_{G\sim\mathcal{G},a_{t}\sim\pi\left(\cdot\mid s%
_{t},g\right),s_{t+1}\sim\mathcal{P}\left(\cdot\mid s_{t},a_{t}\right),}\left[%
\sum_{t=0}^{T}\gamma^{t}r\left(s_{t},a_{t},G\right)\right].
\pi
p_{\text{data}}(\textbf{x}|\textbf{c})
D
p(x_{1},\ldots,x_{n})
p(\mathbf{x})=\prod_{i=1}^{n}p(x_{i}|\mathbf{x}_{<i})
x_{i}
x_{1},\ldots,x_{i-1}
x_{i}
q(\boldsymbol{x}_{k+1}|\boldsymbol{x}_{k}):=\mathcal{N}(\boldsymbol{x}_{k+1};%
\sqrt{\alpha_{k}}\boldsymbol{x}_{k},(1-\alpha_{k})I)
q(\boldsymbol{x}_{0})
\mathcal{N}(0,I)
K
p_{\theta}(\boldsymbol{x}_{k-1}|\boldsymbol{x}_{k}):=\mathcal{N}(\boldsymbol{x%
}_{k-1}|\mu_{\theta}(\boldsymbol{x}_{k},k),\Sigma_{k})
\mathcal{N}(0,I)
p_{\theta}(\boldsymbol{x}_{k-1}|\boldsymbol{x}_{k})
K
\boldsymbol{x}_{0}
\epsilon_{\theta}\left(\boldsymbol{x}_{k},\textbf{c},k\right)
\epsilon_{\theta}\left(\boldsymbol{x}_{k},k\right)
\epsilon_{\theta}\left(\boldsymbol{x}_{k},k\right)+\omega\left(\epsilon_{%
\theta}\left(\boldsymbol{x}_{k},\textbf{c},k\right)-\epsilon_{\theta}\left(%
\boldsymbol{x}_{k},k\right)\right)
\omega
P(s_{t+1}|s_{t},a_{t})
P(r_{t}|s_{t},a_{t},G)
P(o_{t}|s_{t})
o_{t}
s_{t}
o_{t}
t
G
G
\mathcal{D}
G
\displaystyle\tau=\left(G,o_{0},a_{0},r_{0},\ldots,o_{t},a_{t},r_{t},\ldots,o_%
{T},a_{T},r_{T}\right).
\displaystyle\tau=\left(G,o_{0},a_{0},r_{0},\ldots,o_{t},a_{t},r_{t},\ldots,o_%
{T},a_{T},r_{T}\right).
P_{\text{data}}(a_{0:T},o_{1:T},r_{0:T}|o_{0},G)
G\in\mathcal{G}
o_{0}\in\mathcal{O}
\displaystyle P_{\text{data}}\left(a_{0:T},o_{1:T},r_{0:T}\mid o_{0},G\right)%
\approx\prod_{t=1}^{T}P_{\theta}(o_{t}|\tau_{<t})\prod_{t=0}^{T}P_{\theta}(r_{%
t}|o_{t},\tau_{<t})\prod_{t=0}^{T}P_{\theta}(a_{t}|o_{t},r_{t},\tau_{<t})
\displaystyle P_{\text{data}}\left(a_{0:T},o_{1:T},r_{0:T}\mid o_{0},G\right)%
\approx\prod_{t=1}^{T}P_{\theta}(o_{t}|\tau_{<t})\prod_{t=0}^{T}P_{\theta}(r_{%
t}|o_{t},\tau_{<t})\prod_{t=0}^{T}P_{\theta}(a_{t}|o_{t},r_{t},\tau_{<t})
\tau_{<t}
t
\theta
\displaystyle P_{\text{data}}\left(a_{0:T},o_{1:T},r_{0:T}\mid o_{0},G\right)%
\approx\underbrace{P_{\theta_{1}}\left(o_{1:T}\mid o_{0},G\right)}_{\text{%
observation module}}\cdot\underbrace{P_{\theta_{2}}\left(r_{0:T}\mid o_{0:T},G%
\right)}_{\text{reward module}}\cdot\underbrace{P_{\theta_{3}}\left(a_{0:T}%
\mid o_{0:T},r_{0:T},G\right)}_{\text{action module}}.
\displaystyle P_{\text{data}}\left(a_{0:T},o_{1:T},r_{0:T}\mid o_{0},G\right)%
\approx\underbrace{P_{\theta_{1}}\left(o_{1:T}\mid o_{0},G\right)}_{\text{%
observation module}}\cdot\underbrace{P_{\theta_{2}}\left(r_{0:T}\mid o_{0:T},G%
\right)}_{\text{reward module}}\cdot\underbrace{P_{\theta_{3}}\left(a_{0:T}%
\mid o_{0:T},r_{0:T},G\right)}_{\text{action module}}.
\theta_{1},\theta_{2},\theta_{3}
t
t
\displaystyle\hat{o}_{t+1:T}\sim P_{\theta_{1}}\left(o_{t+1:T}\mid o_{0:t},G\right)
\displaystyle\hat{o}_{t+1:T}
\displaystyle\sim P_{\theta_{1}}\left(o_{t+1:T}\mid o_{0:t},G\right)
\displaystyle\hat{r}_{t+1:T}\sim P_{\theta_{2}}\left(r_{t+1:T}\mid r_{0:t},o_{%
0:t},\hat{o}_{t+1:T},G\right)
\displaystyle\hat{r}_{t+1:T}
\displaystyle\sim P_{\theta_{2}}\left(r_{t+1:T}\mid r_{0:t},o_{0:t},\hat{o}_{t%
+1:T},G\right)
\displaystyle\hat{a}_{t}\sim P_{\theta_{3}}\left(a_{t}\mid a_{0:t-1},o_{0:t},%
\hat{o}_{t+1:T},r_{0:t},\hat{r}_{t+1:T},G\right)
\displaystyle\hat{a}_{t}
\displaystyle\sim P_{\theta_{3}}\left(a_{t}\mid a_{0:t-1},o_{0:t},\hat{o}_{t+1%
:T},r_{0:t},\hat{r}_{t+1:T},G\right)
P_{\theta_{1}}\left(o_{t+1:T}\mid o_{0:t},G\right)=\prod_{i=t+1}^{T}P_{\theta_%
{1}}\left(o_{i}\mid o_{<i},G\right).
t
(\geq 0.95\cdot\max)
(\geq 0.95\cdot\max)
\pm 26.4
\pm 11.3
\pm 12.2
\pm 3.1
\pm 2.6
\pm 17.4
\pm 21.2
\pm 2.4
\pm 2.7
\pm 11.8
\pm 14.5
\pm 43.4
\pm 13.4
\pm 6.4
\pm 21.0
\pm 16.3
\pm 14.5
\pm 12.2
\pm 1.8
\pm 4.2
\pm 14.5
\pm 14.3
\pm 3.7
\pm 3.4
\pm 11.3
\pm 20.1
\pm 33.1
\pm 21.8
\pm 5.8
\pm 12.3
(\geq 0.95\cdot\max)
(\geq 0.95\cdot\max)
55.2
86.7
86.8
53.3
90.6
\pm 2.5
79.8
\pm 0.3
52.5
91.5
105.4
\pm 2.8
\pm 3.2
101.9
95.6
\pm 2.3
\pm 0.1
42.6
44.0
42.6
42.1
\pm 5.1
44.2
\pm 0.4
52.9
66.3
58.5
67.6
61.1
79.3
\pm 7.2
58.5
76.6
\pm 4.2
75.3
78.3
72.5
74.0
79.0
77.8
\pm 5.3
\pm 0.3
36.6
36.6
41.9
40.2
39.3
\pm 1.5
42.2
41.1
\pm 0.1
18.1
94.7
82.7
91.5
93.6
\pm 3.7
96.8
89.5
\pm 4.2
26.0
73.9
77.2
66.6
49.8
75
\pm 3.1
61.2
\pm 1.5
51.9
77.0
77.6
74.7
72.9
75.3
74.3
15.7\%
(\geq 0.95\cdot\max)
(\geq 0.95\cdot\max)
42.1
80.8
19.07
82.2
\pm 0.8
51.1
105.2
61.6
32.7
70.7
\pm 0.4
51.3
51.7
74.8
82.4
94.1
\pm 8.5
43.3
42.7
40.3
\pm 0.3
36.4
55.7
38.1
57.7
\pm 3.9
39.4
64.2
28.5
53.2
55.7
\pm 4.2
2.1
35.5
39.8
39.3
40.3
\pm 1.2
24.3
78.3
22.1
80.9
\pm 2.6
23.8
45.3
10.2
58.4
58.7
\pm 1.8
34.9
47.9
53.0
42.0
64.2
\pm 3.9
\pm 4.3
\pm 4.1
\pm 3.7
\pm 3.3
\pm 4.2
\pm 1.7
\pm 2.2
\pm 3.1
\pm 4.4
\pm 3.7
\pm 3.5
\pm 3.5
\pm 2.5
\pm 3.0
\pm 3.9
\pm 2.7
\pm 4.1
\pm 1.3
\pm 3.4
\pm 2.1
\pm 3.9
\pm 4.3
\pm 4.1
\pm 5.2
\pm 3.2
\pm 3.7
\pm 4.4
\pm 3.3
\pm 4.1
93.2\pm 10.7
90.3\pm 9.1
102.9\pm 8.1
111.3\pm 12.2
102.6\pm 3.9
115.2\pm 8.0
t
P(a_{t}|o_{t},o_{t+1})
\boldsymbol{x}_{K}(\tau)
\boldsymbol{x}_{0}(\tau)
\boldsymbol{x}_{k}(\tau)
\boldsymbol{x}_{k-1}(\tau)
\hat{\epsilon}:=\epsilon_{\theta}\left(\boldsymbol{x}_{k}(\tau),\varnothing,k%
\right)+\omega\left(\epsilon_{\theta}\left(\boldsymbol{x}_{k}(\tau),G,k\right)%
-\epsilon_{\theta}\left(\boldsymbol{x}_{k}(\tau),\varnothing,k\right)\right)
G
\tau_{obs}=\left[\begin{array}[]{llll}o_{0}&o_{1}&\ldots&o_{T}\end{array}\right]
o_{0}
\tau_{rew}=\left[\begin{array}[]{llll}o_{0}&o_{1}&\ldots&o_{T}\\
r_{0}&r_{1}&\ldots&r_{T}\end{array}\right]
{o_{0},o_{1},...,o_{T}}
{r_{0},r_{1},...,r_{T}}
{o_{0},o_{1},...,o_{T}}
\tau_{act}=\left[\begin{array}[]{llll}o_{0}&o_{1}&\ldots&o_{T}\\
r_{0}&r_{1}&\ldots&r_{T}\\
a_{0}&a_{1}&\ldots&a_{T}\end{array}\right]
3e^{-4}
2e^{6}
43.3\pm 2.2
59.0\pm 2.3
68.7\pm 8.3
52.3\pm 5.5
52.5\pm 7.4
\textbf{68.0}\pm\textbf{3.4}
34.0\pm 0.9
73.1\pm 4.6
76.7\pm 7.9
31.6\pm 5.14
24.2\pm 3.1
\textbf{81.1}\pm\textbf{6.9}
51.1\pm 1.3
105.2\pm 1.0
61.6\pm 3.3
32.7\pm 2.4
70.7\pm 4.7
\textbf{110.9}\pm\textbf{0.4}
14.6\pm 2.4
\textbf{40.4}\pm\textbf{3.2}
15.0\pm 4.1
8.7\pm 0.2
29.5\pm 1.7
38.9\pm 6.2
35.7\pm 1.7
69.4\pm 2.8
55.5\pm 5.9
31.3\pm 3.3
44.2\pm 4.2
\textbf{74.7}\pm\textbf{4.2}
\pm 4.2
\pm 3.4
\pm 0.3
\pm 1.2
\pm 0.4
\pm 2.8
\pm 3.5
\pm 1.3
\pm 4.2
\pm 7.3
\pm 0.3
\pm 0.7
32.1\pm 0.1
\textbf{41.1}\pm\textbf{0.1}
