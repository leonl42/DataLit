X=\{x_{1},x_{2},...,x_{N}\}
N
X
H=\{h_{1},h_{2},...,h_{N}\}
L_{\mathrm{alm}}(X)=\sum_{n=1}^{N}\log p(x_{n}|x_{1},...,x_{n-1};\theta),
\theta
n
n
X
\Pi=\{\pi_{1},\pi_{2},...,\pi_{K}\}
X
K
X_{\Pi}
X
X_{-\Pi}
\begin{split}L_{\mathrm{mlm}}(X_{\Pi}|X_{-\Pi})=\frac{1}{K}\sum_{k=1}^{K}\log p%
(x_{\pi_{k}}|X_{-\Pi};\theta).\end{split}
M=\{m_{1},m_{2},...,m_{N}\}
X=\{x_{1},x_{2},...,x_{N}\}
m_{n}=1
x_{n}
m_{n}=0
\Pi=\{\pi_{1},\pi_{2},...,\pi_{K}\}
m_{\pi_{k}}=1
\pi_{k}\in\Pi
M
X_{\Pi}
X_{-\Pi}
M
\begin{split}L_{\mathrm{pmlm}}(&X_{\Pi}|X;\theta)\\
=&\mathbb{E}_{M|X}[\log p(X_{\Pi}|X_{-\Pi})]\\
=&\sum_{M}[\log p(X_{\Pi}|X_{-\Pi};\theta)]p(M|X)\\
\end{split}
\log p(X_{\Pi}|X_{-\Pi};\theta)
M
M
X
p(M|X)=p(M)=r^{K}(1-r)^{N-K},
r
r
r
p(r)
p(M)
\begin{split}p(M)=\alpha_{M}=&\int p(M|r)p(r)dr\\
=&\int r^{K}(1-r)^{N-K}p(r)dr\\
\end{split}
\begin{split}&L_{\mathrm{pmlm}}(X_{\Pi}|X;\theta)\\
&=\sum_{M}[\log p(X_{\Pi}|X_{-\Pi};\theta)]\alpha_{M}\\
&=\sum_{M}\frac{\alpha_{M}}{K}\sum_{k=1}^{K}\log p(x_{\pi_{k}}|X_{-\Pi};\theta%
)\end{split}
M
p(r)=\left\{\begin{aligned} 1&,0\leq r\leq 1\\
0&,\text{otherwise.}\end{aligned}\right.
\small L_{\mathrm{aplm}}(X)=\mathbb{E}_{\sigma}\left[\sum_{t=1}^{N}\log p(x_{%
\sigma_{t}}|x_{\sigma_{1}},\ldots,x_{\sigma_{t-1}};\theta)\right],
\sigma
S=\{s_{1},s_{2},...,s_{N}\}
S
U=\{1,2,...,N\}
U
n
U
S
n
x_{n}
n
S
x_{n}
S(n)\leftarrow x_{n}
n
U
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
N
p(r)
p(M)
\small\begin{split}p(M)&=\int r^{K}(1-r)^{N-K}p(r)d(r)\\
&=\int_{0}^{1}r^{K}(1-r)^{N-K}d(r)\\
&=B(N-K+1,K+1)\\
&=\frac{\Gamma(N-K+1)\Gamma(K+1)}{\Gamma(N+2)}\\
&=\frac{(N-K)!K!}{(N+1)!}\\
\end{split}
B(\cdot)
\Gamma(\cdot)
\small\begin{split}L_{\mathrm{pmlm}}(&X_{\Pi}|X;\theta)\\
=&\sum_{M}[\frac{1}{K}\sum_{k=1}^{K}\log p(x_{\pi_{k}}|X_{-\Pi};\theta)]\frac{%
(N-K)!K!}{(N+1)!}\\
=&\frac{\sum_{M}\sum_{k=1}^{K}(N-K)!(K-1)!\log p(x_{\pi_{k}}|X_{-\Pi};\theta)}%
{(N+1)!}\end{split}
\small\begin{split}L_{\mathrm{aplm}}(X)&=\mathbb{E}_{\sigma}\left[\sum_{t=1}^{%
N}\log p(x_{\sigma_{t}}|x_{\sigma_{1}},\ldots,x_{\sigma_{t-1}};\theta)\right]%
\\
&=\frac{\sum_{\sigma}[\sum_{t=1}^{N}\log p(x_{\sigma_{t}}|x_{\sigma_{1}},%
\ldots,x_{\sigma_{t-1}};\theta)]}{C}\end{split}
C
p(x_{\sigma_{t}}|x_{\sigma_{1}},\ldots,x_{\sigma_{t-1}};\theta)
p(x_{\sigma_{t}}|X_{-\Pi^{\sigma}_{t}};\theta)
\Pi^{\sigma}_{t}=X-\{\sigma_{1},\sigma_{2},...,\sigma_{t-1}\}
K
\Pi^{\sigma}_{t}
\Pi^{\sigma}_{t}
|\Pi^{\sigma}_{t}|=K=N-t+1
\small\begin{split}&L_{\mathrm{aplm}}(X)\\
=&\frac{1}{C}\sum_{\sigma}[\log p(X_{\Pi^{\sigma}_{t+1}}|X_{-\Pi^{\sigma}_{t+1%
}};\theta)+\log p(x_{\sigma_{t}}|X_{-\Pi^{\sigma}_{t}};\theta)\\
&+\log p(X_{-\Pi^{\sigma}_{t}};\theta)]\end{split}
\log p(x_{\sigma_{t}}|X_{-\Pi^{\sigma}_{t}})
\Pi^{\sigma}_{t+1}
-\Pi^{\sigma}_{t}
\Pi^{\sigma}_{t+1}
-\Pi^{\sigma}_{t}
|\Pi^{\sigma}_{t+1}|
|-\Pi^{\sigma}_{t}|
\small\begin{split}\mathrm{permutation}(\Pi^{\sigma}_{t+1})=|\Pi^{\sigma}_{t+1%
}|!=(N-K)!\\
\mathrm{permutation}(-\Pi^{\sigma}_{t})=|-\Pi^{\sigma}_{t}|!=(K-1)!\end{split}
\log p(x_{\sigma_{t}}|X_{-\Pi^{\sigma}_{t}})
(N-K)!(K-1)!
C=(N+1)!
