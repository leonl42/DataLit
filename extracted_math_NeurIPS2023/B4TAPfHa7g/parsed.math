\pi_{\theta}
\pi_{\theta_{old}}
\theta
\pi_{\theta}
\gamma\in\left(0,1\right)
T
\hat{A}_{t}
L^{CPI}\left(\theta\right)=\hat{\mathbb{E}}_{t}\left[\frac{\pi_{\theta}\left(a%
_{t}|s_{t}\right)}{\pi_{\theta_{old}}\left(a_{t}|s_{t}\right)}\hat{A}_{t}\right]
\hat{A}_{t}
\left(s_{t},a_{t}\right)
\pi_{\theta_{old}}
\hat{\mathbb{E}}_{t}\left[\cdot\right]
\tilde{\theta}=\mathrm{argmax\;}L^{CPI}\left(\theta\right)
\theta=\alpha\theta_{old}+(1-\alpha)\text{$\tilde{\theta}$}
\alpha
\theta_{old}
\frac{\pi_{\theta}\left(a_{t}|s_{t}\right)}{\pi_{\theta_{old}}\left(a_{t}|s_{t%
}\right)}
\tau_{t}\left(\theta\right)
L^{KL}\left(\theta\right)=\hat{\mathbb{E}}_{t}\left[\tau_{t}\left(\theta\right%
)\hat{A}_{t}-\beta KL\left[\pi_{\theta_{old}}\left(\cdot|s_{t}\right),\pi_{%
\theta}\left(\cdot|s_{t}\right)\right]\right]
\beta
\displaystyle L^{TRPO}\left(\theta\right)=\hat{\mathbb{E}}_{t}\left[\tau_{t}%
\left(\theta\right)\hat{A}_{t}\right]
\displaystyle L^{TRPO}\left(\theta\right)
\displaystyle=\hat{\mathbb{E}}_{t}\left[\tau_{t}\left(\theta\right)\hat{A}_{t}\right]
\displaystyle\mathrm{st\>\,}\delta\geq KL\left[\pi_{\theta_{old}}\left(\cdot|s%
_{t}\right),\pi_{\theta}\left(\cdot|s_{t}\right)\right]
\displaystyle\mathrm{st\>\,}\delta
\displaystyle\geq KL\left[\pi_{\theta_{old}}\left(\cdot|s_{t}\right),\pi_{%
\theta}\left(\cdot|s_{t}\right)\right]
\delta
L^{PPO}
\hat{\mathbb{E}}_{t}\left[\min\left(\tau_{t}\left(\theta\right)\hat{A}_{t},%
\mathrm{clip}\left(\tau_{t}\left(\theta\right),1-\epsilon,1+\epsilon\right)%
\hat{A}_{t}\right)\right]
\epsilon
\theta
\theta_{old}
\theta_{old}
\theta_{old}
\theta_{old}
\theta_{old}
\theta
\theta_{old}
\theta
\theta
\theta_{old}
\theta
\theta_{old}
\mathcal{M}
\pi_{\theta_{old}}
T
K
B
\psi_{old}\leftarrow\theta_{old}
\theta\leftarrow\theta_{old}
iteration=1,2,...
\pi_{\theta_{old}}
T
\hat{A}_{1}
\hat{A}_{T}
epoch=1,2,...K
batch=1,2,...T/B
\psi
\psi_{old}
\theta
\theta_{old}
\theta
\varphi
L^{MCPO}
\mathbf{if}
D\left(\theta,\psi\right)>D\left(\theta_{old},\psi\right)
\mathbf{then}
\theta
\mathcal{M}
\mathbf{if}
|\mathcal{M}|>N
\mathbf{then}
\mathcal{M}
\psi_{old}\leftarrow\psi
\theta_{old}\leftarrow\theta
\psi
M
\left\{\theta_{i}\right\}_{i=1}^{M}
\psi
\psi=\sum_{i=1}^{M}f_{\varphi}(v)_{i}\theta_{i}
f_{\varphi}
\varphi
M
v
\theta
\theta_{old}
\psi_{old}
f_{\varphi}
\mathcal{M}
\mathcal{M}
N
\theta
\mathcal{M}
\mathcal{M}
\theta
\mathcal{M}
\theta
D\left(a,b\right)=\hat{\mathbb{E}}_{t}\left[KL\left[\pi_{a}\left(\cdot|s_{t}%
\right),\pi_{b}\left(\cdot|s_{t}\right)\right]\right]
\pi_{a}
\pi_{b}
\theta
\mathcal{M}
D(\theta,\psi)\geq D(\theta_{old},\psi)
D(\theta_{old},\psi)
\psi
\theta
\psi
\theta_{old}
\theta
\theta_{old}
\psi
\theta
\theta_{old}
\psi
\theta
\displaystyle L_{1}(\theta)=\hat{\mathbb{E}}_{t}\left[\tau_{t}(\theta)\hat{A}_%
{t}\right]
\displaystyle L_{1}(\theta)=
\displaystyle\hat{\mathbb{E}}_{t}\left[\tau_{t}(\theta)\hat{A}_{t}\right]
\displaystyle-\beta\hat{\mathbb{E}}_{t}\bigg{[}\left(1-\alpha_{t}\left(\cdot|s%
_{t}\right)\right)KL\left[\pi_{\theta_{old}}\left(\cdot|s_{t}\right),\pi_{%
\theta}\left(\cdot|s_{t}\right)\right]
\displaystyle-\beta\hat{\mathbb{E}}_{t}\bigg{[}\left(1-\alpha_{t}\left(\cdot|s%
_{t}\right)\right)KL\left[\pi_{\theta_{old}}\left(\cdot|s_{t}\right),\pi_{%
\theta}\left(\cdot|s_{t}\right)\right]
\displaystyle\ \ \ \ \ \ \ \ +\alpha_{t}\left(\cdot|s_{t}\right)KL\left[\pi_{%
\psi}\left(\cdot|s_{t}\right),\pi_{\theta}\left(\cdot|s_{t}\right)\right]\bigg%
{]}
\displaystyle\ \ \ \ \ \ \ \ +\alpha_{t}\left(\cdot|s_{t}\right)KL\left[\pi_{%
\psi}\left(\cdot|s_{t}\right),\pi_{\theta}\left(\cdot|s_{t}\right)\right]\bigg%
{]}
\beta
\alpha_{t}
\theta
\psi
\theta
\theta_{old}
t
\psi
\theta_{old}
\psi
\alpha
\beta
\alpha_{t}
\psi
\theta_{old}
\alpha_{t}\left(\cdot|s_{t}\right)=\frac{\exp(R_{t}(\psi))}{\exp(R_{t}(\psi))+%
\exp(R_{t}(\theta_{old}))}
R_{t}(\psi)
R_{t}(\theta_{old})
\psi
\theta_{old}
R_{t}(\cdot)
R_{t}(\cdot)=\tau_{t}(\cdot)\hat{A}_{t}
s_{t}
\beta
\beta_{min}
\beta_{max}
0<\beta_{min}<\beta_{max}
\beta=\begin{cases}\beta_{max}&\text{if }\,D(\theta_{old},\theta)>D(\theta_{%
old},\psi)\\
\beta_{min}&\text{otherwise}\end{cases}
D(\cdot,\cdot)
\beta
\theta
\theta_{old}
d_{targ}
\beta
D\left(\theta_{old},\theta\right)>d_{targ}
\beta
\psi
\beta
\beta
\varphi
f_{\varphi}
L_{2}(\varphi)=\mathbb{\hat{E}}_{t}\left[R_{t}(\psi_{\varphi})\right]
\psi_{\varphi}
\psi_{\varphi}
\psi
\varphi
\varphi
\frac{\mathcal{\partial L}_{2}}{\partial\varphi}
f_{\varphi}
\psi
\mathcal{M}
d_{targ}=0.01
\beta=0.1
\epsilon=0.3
\beta_{0}=2
\alpha_{0}=1
N=5
N=10
N=40
L^{MCPO}=L_{1}(\theta)+L_{2}(\varphi)
\theta
\psi
\beta_{max}=10
\beta_{min}=0.01
N
\epsilon
\beta
N
N
N
\mathcal{M}
\psi
\mathcal{M}
\theta_{j}
\theta_{old}
\psi
\psi
\theta_{old}
\psi
\theta_{old}
\mathcal{M}
j^{*}=\mathrm{argmax_{j}}\,f_{\varphi}\left(v_{context}\right)_{j}
\mathcal{M}
\theta_{j}
\theta_{old}
\psi
\psi
\theta_{old}
\psi
\theta_{old}
\mathcal{M}
j^{*}=\mathrm{argmax_{j}}\,f_{\varphi}\left(v_{context}\right)_{j}
\theta_{old}
\psi
\mathcal{M}
\theta_{j}
\mathcal{M}
10
\mathcal{M}
\psi
\psi
\psi
N=40
\psi
\psi
\mathcal{M}
\psi
\psi
\mathcal{M}
(j^{*}>35)
\psi
\psi
\mathcal{M}
(j^{*}\sim 25)
N=40
\alpha_{t}
\alpha_{t}
N=10
\beta
N
\psi
N
N=10
N=10
\psi
\alpha_{t}=0
\alpha_{t}=0.5
\psi
\alpha_{t}=1.0
\beta
\beta
\beta
\beta
\mathcal{M}
\mathcal{M}
\mathcal{M}
\mathcal{M}
\psi
\psi
v_{context}
\psi
\psi
\psi
N=10
N
\beta
\beta
\beta_{max}=10
\beta_{min}=0.01
N
p=0.5
N
\mathrm{softmax}
N
v_{context}
\displaystyle\hat{A}_{t}=\frac{1}{N_{actor}}\sum_{i}^{N_{actor}}\sum_{k=0}^{T-%
t-1}\left(\gamma\lambda\right)^{k}\left(V_{target}-V\left(s_{t+k}^{i}\right)\right)
\displaystyle\hat{A}_{t}
\displaystyle=\frac{1}{N_{actor}}\sum_{i}^{N_{actor}}\sum_{k=0}^{T-t-1}\left(%
\gamma\lambda\right)^{k}\left(V_{target}-V\left(s_{t+k}^{i}\right)\right)
\gamma
N_{actor}
V_{target}=r_{t+k}^{i}+\gamma V\left(s_{t+k+1}^{i}\right)
N_{actor}
\displaystyle L=L^{MCPO}-c_{1}\hat{\mathbb{E}}_{t}\left(V_{\theta}\left(s_{t}%
\right)-V_{target}\left(s_{t}\right)\right)^{2}
\displaystyle L
\displaystyle=L^{MCPO}-c_{1}\hat{\mathbb{E}}_{t}\left(V_{\theta}\left(s_{t}%
\right)-V_{target}\left(s_{t}\right)\right)^{2}
\displaystyle+c_{2}\hat{\mathbb{E}}_{t}\left[-\log\left(\pi_{\theta}\left(%
\cdot|s_{t}\right)\right)\right]
\displaystyle+c_{2}\hat{\mathbb{E}}_{t}\left[-\log\left(\pi_{\theta}\left(%
\cdot|s_{t}\right)\right)\right]
c_{1}
c_{2}
V_{\theta}
\theta
D\left(\theta,\psi_{old}\right)
\theta
\psi_{old}
D\left(\theta_{old},\psi_{old}\right)
\theta_{old}
\psi_{old}
D\left(\theta_{old},\theta\right)
\theta_{old}
\theta
\hat{\mathbb{E}}_{t}\left[R_{t}\left(\psi_{old}\right)\right]
\psi_{old}
\hat{\mathbb{E}}_{t}\left[R_{t}\left(\theta_{old}\right)\right]
\theta_{old}
\hat{\mathbb{E}}_{t}\left[R_{t}\left(\theta\right)\right]
\theta
\hat{\mathbb{E}}_{t}\left[-\log\left(\pi_{\psi_{old}}\left(\cdot|s_{t}\right)%
\right)\right]
\psi_{old}
\hat{\mathbb{E}}_{t}\left[-\log\left(\pi_{\theta_{old}}\left(\cdot|s_{t}\right%
)\right)\right]
\theta_{old}
\hat{\mathbb{E}}_{t}\left[-\log\left(\pi_{\theta}\left(\cdot|s_{t}\right)%
\right)\right]
\theta
\hat{\mathbb{E}}_{t}\left(V_{\psi_{old}}\left(s_{t}\right)-V_{target}\left(s_{%
t}\right)\right)^{2}
\psi_{old}
\hat{\mathbb{E}}_{t}\left(V_{\theta_{old}}\left(s_{t}\right)-V_{target}\left(s%
_{t}\right)\right)^{2}
\theta_{old}
\hat{\mathbb{E}}_{t}\left(V_{\theta}\left(s_{t}\right)-V_{target}\left(s_{t}%
\right)\right)^{2}
\theta
\left\{32/8/4,64/4/2,32/3/1\right\}
\mathit{\mathtt{X}}
\checked
\mathit{\mathtt{X}}
\checked
\mathit{\mathtt{X}}
\checked
d_{targ}=0.003
d_{targ}=0.01
d_{targ}=0.03
\beta=0.01
\beta=0.1
\beta=1
\epsilon=0.1
\epsilon=0.2
\epsilon=0.3
\beta_{0}=0.5
\beta_{0}=1
\beta_{0}=2
\alpha_{0}=0.1
\alpha_{0}=1
\alpha_{0}=5
N=5
N=10
N=40
\epsilon
\beta
d_{targ}
\beta
\beta
\beta_{0}
\beta_{0}
\beta_{0}
\beta_{0}\in\left\{0.5,1,2\right\}
\beta_{0}
\eta_{0}
\alpha_{0}
\epsilon_{\eta}
\epsilon_{\alpha}
\alpha_{0}
\alpha_{0}
\alpha_{0}\in\left\{0.1,1,5\right\}
N
\beta_{min}
\beta_{max}
N\in\left\{5,10,40\right\}
\beta_{min}=0.01
\beta_{max}=10
N
N
N>40
N=5
N=10
N_{actor}
N=40
\beta=10
\epsilon\in\left\{0.5,0.8\right\}
T
3\times 10^{-4}
3\times 10^{-4}
3\times 10^{-4}
3\times 10^{-4}
3\times 10^{-4}
K
B
\gamma
\lambda
N_{actor}
c_{1}
c_{2}
d_{targ}=0.01
\beta=0.1
\epsilon=0.2
\beta_{0}=0.5
\alpha_{0}=1
N=10
16
\epsilon\in\left\{0.1,0.2,0.3\right\}
\epsilon
\epsilon=0.2
\epsilon\in\left\{0.2,0.5,0.8\right\}
\delta=0.01
\delta\in\left\{0.005,0.01\right\}
\delta=0.005
\psi
N\in\left\{5,40\right\}
\beta_{0}\in\left\{0.5,1,2\right\}
T
3\times 10^{-4}
2.5\times 10^{-4}
K
B
\gamma
\lambda
N_{actor}
c_{1}
c_{2}
32
N=10
\epsilon=0.2
\delta=0.01
\alpha_{0}=5
N=10
\alpha_{t}
\psi
\theta_{old}
\alpha_{t}
\psi
\theta_{old}
N=10
\psi
\displaystyle L_{1}\left(\theta\right)=\hat{\mathbb{E}}_{t}\left[\tau_{t}\left%
(\theta\right)\hat{A}_{t}\right]
\displaystyle L_{1}\left(\theta\right)
\displaystyle=\hat{\mathbb{E}}_{t}\left[\tau_{t}\left(\theta\right)\hat{A}_{t}\right]
\displaystyle-\beta\hat{\mathbb{E}}_{t}\left[KL\left[\pi_{\theta_{old}}\left(%
\cdot|s_{t}\right),\pi_{\theta}\left(\cdot|s_{t}\right)\right]\right]
\displaystyle-\beta\hat{\mathbb{E}}_{t}\left[KL\left[\pi_{\theta_{old}}\left(%
\cdot|s_{t}\right),\pi_{\theta}\left(\cdot|s_{t}\right)\right]\right]
\beta
\beta
\alpha=0
\alpha=0.5
\alpha=0.5
\alpha=1.0
\alpha=1.0
\beta
\beta
\beta_{i}=1.0-\frac{i}{T_{total}}
T_{total}
i
\beta
\beta
\beta
\beta
d_{targ}=0.03
\mathcal{M}
\mathcal{M}
\psi
\psi=\sum_{j}^{\left|\mathcal{M}\right|}\theta_{j}
L_{1}
L_{2}
\theta_{old}
\psi
L_{1}
L_{1}
\displaystyle L_{1\theta_{old}}\left(\theta\right)=L_{\theta_{old}}\left(%
\theta\right)
\displaystyle L_{1\theta_{old}}\left(\theta\right)
\displaystyle=L_{\theta_{old}}\left(\theta\right)
\displaystyle-C_{1}D_{KL}^{max}\left(\theta_{old},\theta\right)
\displaystyle-C_{1}D_{KL}^{max}\left(\theta_{old},\theta\right)
\displaystyle-C_{2}D_{KL}^{max}\left(\psi,\theta\right)
\displaystyle-C_{2}D_{KL}^{max}\left(\psi,\theta\right)
L_{\theta_{old}}\left(\theta\right)=\eta\left(\pi_{\theta_{old}}\right)+\sum_{%
s}\rho_{\pi_{\theta_{old}}}\left(s\right)\sum_{a}\pi_{\theta}\left(a|s\right)A%
_{\pi_{\theta_{old}}}\left(s,a\right)
\eta\left(\theta\right)
D_{KL}^{max}\left(a,b\right)=\max_{s}KL\left[\pi_{a}\left(\cdot|s\right),\pi_{%
b}\left(\cdot|s\right)\right]
C_{1}=\frac{4\max_{s,a}\left|A_{\pi}\left(s,a\right)\right|\gamma}{\left(1-%
\gamma\right)^{2}}
C_{2}>0
\rho_{\pi_{\theta_{old}}}
\pi_{\theta_{old}}
L_{1\theta_{old}}\left(\theta\right)\leq L_{\theta_{old}}\left(\theta\right)-C%
_{1}D_{KL}^{max}\left(\theta_{old},\theta\right)
\eta\left(\theta\right)
L_{1}
\eta\left(\theta\right)
L_{1}
L_{1\theta_{old}}
L_{1}
L_{2}
L_{2}
L_{2\theta_{old}}\left(\psi\right)=L_{\theta_{old}}\left(\psi\right)-C_{1}D_{%
KL}^{max}\left(\theta_{old},\psi\right)
L_{2}
KL
\psi
\theta_{old}
L_{\theta_{old}}\left(\psi\right)
L_{2\theta_{old}}\left(\psi\right)
\psi
L_{2\theta_{old}}\left(\psi\right)\geq L_{2\theta_{old}}\left(\theta_{old}%
\right)=L_{\theta_{old}}\left(\theta_{old}\right)
\displaystyle\eta\left(\theta\right)\geq L_{1\theta_{old}}\left(\theta\right)
\displaystyle\eta\left(\theta\right)
\displaystyle\geq L_{1\theta_{old}}\left(\theta\right)
\displaystyle\eta\left(\theta_{old}\right)=L_{\theta_{old}}\left(\theta_{old}%
\right)\leq L_{2\theta_{old}}\left(\psi\right)
\displaystyle\eta\left(\theta_{old}\right)
\displaystyle=L_{\theta_{old}}\left(\theta_{old}\right)\leq L_{2\theta_{old}}%
\left(\psi\right)
\displaystyle=L_{\theta_{old}}\left(\psi\right)-C_{1}D_{KL}^{max}\left(\theta_%
{old},\psi\right)
\displaystyle=L_{\theta_{old}}\left(\psi\right)-C_{1}D_{KL}^{max}\left(\theta_%
{old},\psi\right)
\displaystyle=L_{1\theta_{old}}\left(\psi\right)
\displaystyle=L_{1\theta_{old}}\left(\psi\right)
\eta\left(\theta\right)-\eta\left(\theta_{old}\right)\geq L_{1\theta_{old}}%
\left(\theta\right)-L_{1\theta_{old}}\left(\psi\right)
L_{1\theta_{old}}\left(\theta\right)
\eta\left(\theta\right)
L_{2}
L_{2}^{*}=\hat{\mathbb{E}}_{t}\left[R_{t}\left(\psi_{\varphi}\right)-C_{1}KL%
\left[\pi_{\theta_{old}}\left(\cdot|s_{t}\right),\pi_{\psi}\left(\cdot|s_{t}%
\right)\right]\right]
C_{1}
L_{2}^{*}
L_{2}=\hat{\mathbb{E}}_{t}\left[R_{t}\left(\psi_{\varphi}\right)\right]
