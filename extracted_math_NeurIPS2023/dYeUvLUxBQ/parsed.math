S_{1}
\rightarrow
S_{2}
S_{1}
\rightarrow
S_{3}
S_{3}
\rightarrow
S_{4}
S_{2}
\rightarrow
S_{4}
S_{4}
\rightarrow
S_{4}
t
\boldsymbol{x}^{t}=\sum\nolimits_{\tau=1}^{T}{\left\{w_{i,j}^{\tau}\right\}%
\boldsymbol{x}^{t-\tau}}+\boldsymbol{e}
\boldsymbol{x}^{t}
t
\boldsymbol{x}^{t-\tau}
t-\tau
\left\{w_{i,j}^{\tau}\right\}
t-\tau
w_{i,j}^{\tau}
i
j
\tau
T
\boldsymbol{e}
i
j
\tau
i
j
\tau
w_{i,j}^{\tau}\neq 0
N
T
\boldsymbol{X}
=
\left[\boldsymbol{X}_{1},\boldsymbol{X}_{2},\cdots,\boldsymbol{X}_{N}\right]
\in
\mathbb{R}^{N\times T}
f
t
\boldsymbol{X}_{[\![1,N]\!]\backslash\left\{i\right\}}^{1:t},\boldsymbol{X}_{i%
}^{1:t-1}\xrightarrow{f}\tilde{\boldsymbol{X}}_{i}^{t},~{}~{}1\leqslant t\leqslant
T
\tilde{\boldsymbol{X}}_{i}^{t}
i
t
\boldsymbol{X}_{[\![1,N]\!]\backslash\left\{i\right\}}^{1:t}
\boldsymbol{X}_{i}^{1:t-1}
i
N
\mathcal{G}
=
\left(V,E\right)
V
N
E
e_{i,j}
\in
E
d(e_{i,j})
i
j
d(e_{i,j})
\boldsymbol{X}
\in
\mathbb{R}^{N\times T}
\boldsymbol{X}_{i}
\in
\mathbb{R}^{1\times T}
d
d>T
\boldsymbol{X}_{emb}=\boldsymbol{X}\times\boldsymbol{W}_{emb}+\boldsymbol{b}_{emb}
\boldsymbol{W}_{emb}\in\mathbb{R}^{T\times d}
\boldsymbol{b}_{emb}
\boldsymbol{X}_{emb}\in\mathbb{R}^{N\times d}
N
\boldsymbol{Q}
\boldsymbol{K}
\boldsymbol{V}
\boldsymbol{\mathcal{K}}
\in
\mathbb{R}^{N\times N\times T}
T
\boldsymbol{X}_{1}
\boldsymbol{X}_{1}
t
\boldsymbol{X}_{1}
=
\left[\boldsymbol{X}_{1}^{1},\cdots,\boldsymbol{X}_{1}^{T}\right]
T
\left[\boldsymbol{0}^{1},\cdots,\boldsymbol{0}^{T},\boldsymbol{X}_{1}^{1},%
\cdots,\boldsymbol{X}_{1}^{T}\right]
\boldsymbol{\mathcal{K}}_{1}
t
\hat{\boldsymbol{X}}_{1}^{t}=\boldsymbol{\mathcal{K}}_{1}\cdot\left[%
\boldsymbol{0}^{t+1},\boldsymbol{0}^{T},\boldsymbol{X}_{1}^{1},\cdots,%
\boldsymbol{X}_{1}^{t}\right]/t
\hat{\boldsymbol{X}}_{1}^{t}
\in
\mathbb{R}^{1\times N\times 1}
\left[\boldsymbol{0}^{t+1},\boldsymbol{0}^{T},\boldsymbol{X}_{1}^{1},\cdots,%
\boldsymbol{X}_{1}^{t}\right]
t
\hat{\boldsymbol{X}}
=
\left[\hat{\boldsymbol{X}}_{1},\cdots,\hat{\boldsymbol{X}}_{N}\right]\in%
\mathbb{R}^{N\times N\times T}
\hat{\boldsymbol{X}}_{i,j}\in\mathbb{R}^{1\times 1\times T}
i
j
i
j
\hat{\boldsymbol{X}}_{i,i}
\left[\hat{\boldsymbol{X}}_{i,i}^{1},\cdots,\hat{\boldsymbol{X}}_{i,i}^{T}%
\right]\xrightarrow{shift}\left[\boldsymbol{0},\hat{\boldsymbol{X}}_{i,i}^{1},%
\cdots,\hat{\boldsymbol{X}}_{i,i}^{T-1}\right]
\boldsymbol{Q}
\boldsymbol{K}
\boldsymbol{V}
\boldsymbol{Q}=\boldsymbol{X}_{emb}\times\boldsymbol{W}_{Q}+\boldsymbol{b}_{Q}%
,\boldsymbol{K}=\boldsymbol{X}_{emb}\times\boldsymbol{W}_{K}+\boldsymbol{b}_{K%
},\boldsymbol{V}=\hat{\boldsymbol{X}}
\boldsymbol{W}_{Q},\boldsymbol{W}_{K}\in\mathbb{R}^{d\times d_{QK}}
\boldsymbol{b}_{Q},\boldsymbol{b}_{K}
d_{QK}
\boldsymbol{V}
\boldsymbol{A}=\underset{\boldsymbol{\mathcal{A}}}{\underbrace{\mathrm{soft}%
\max\left(\frac{\boldsymbol{Q}\times\boldsymbol{K}^{T}}{\tau\cdot\sqrt{d_{QK}}%
}\odot\boldsymbol{M}\right)}}\times\boldsymbol{V}
\boldsymbol{M}
\in
\mathbb{R}^{N\times N}
L_{1}
\tau
\boldsymbol{\mathcal{A}}\in\mathbb{R}^{N\times N}
\boldsymbol{A}\in\mathbb{R}^{N\times T}
\boldsymbol{A}_{i,t}=\sum\nolimits_{j=1}^{N}{\boldsymbol{\mathcal{A}}_{ij}%
\cdot\boldsymbol{V}_{j,i,t}}
h
h
\boldsymbol{Att}=\left[\boldsymbol{A}^{\left(1\right)},\cdots\boldsymbol{A}^{%
\left(h\right)}\right]\times\boldsymbol{W}_{O}
\boldsymbol{A}^{\left(\cdot\right)}
\in
\mathbb{R}^{N\times T}
\boldsymbol{W}_{O}
\in
\mathbb{R}^{h}
h
\boldsymbol{Att}\in\mathbb{R}^{N\times T}
FFN\left(\boldsymbol{Att}\right)=\mathrm{Linear}\left(\mathrm{leakyReLU}\left(%
\mathrm{Linear}\left(\boldsymbol{Att}\right)\right)\right)
d_{FFN}
\tilde{\boldsymbol{X}}
\in
\mathbb{R}^{N\times T}
\mathcal{L}
L1
\begin{split}\mathcal{L}\left(\varTheta\right)&=\frac{\sum{\left(\tilde{%
\boldsymbol{X}}^{[\![1,T]\!]\backslash\left\{1\right\}}-\boldsymbol{X}^{[\![1,%
T]\!]\backslash\left\{1\right\}}\right)^{2}}}{N\cdot T}\\
&+\lambda_{\boldsymbol{\mathcal{K}}}\cdot\left\|\boldsymbol{\mathcal{K}}\right%
\|_{1}+\lambda_{\boldsymbol{M}}\cdot\left\|\boldsymbol{M}\right\|_{1}\end{split}
\varTheta
\tilde{\boldsymbol{X}}^{[\![1,T]\!]\backslash\left\{1\right\}}
\boldsymbol{X}^{[\![1,T]\!]\backslash\left\{1\right\}}
\left\|\cdot\right\|_{1}
L1
\lambda_{\boldsymbol{\mathcal{K}}}
\lambda_{\boldsymbol{M}}
\boldsymbol{\mathcal{K}}
\boldsymbol{M}
f(\boldsymbol{x})
\boldsymbol{x}
\boldsymbol{R}^{(L)}
=
f(\boldsymbol{x})
\boldsymbol{R}
f(\boldsymbol{x})
\boldsymbol{x}
\boldsymbol{R}^{(L)}
=
f(\boldsymbol{x})
\boldsymbol{R}
f\left(\boldsymbol{x}\right)
f\left(\boldsymbol{x}\right)=\sum_{d\in V_{L}}{\boldsymbol{R}_{d}^{\left(L%
\right)}}=\cdots=\sum_{d\in V_{l}}{\boldsymbol{R}_{d}^{\left(l\right)}}=\cdots%
=\sum_{d\in V_{1}}{\boldsymbol{R}_{d}^{\left(1\right)}}
V_{l}
l
\boldsymbol{R}_{d}^{(l)}
d
l
V
f\left(\boldsymbol{x}\right)=f\left(\boldsymbol{x}_{0}\right)+\sum_{d=1}^{V}{%
\underset{\boldsymbol{R}_{d}}{\underbrace{\left.\frac{\partial f}{\partial%
\boldsymbol{x}_{\left(d\right)}}\right|_{\boldsymbol{x}=\boldsymbol{x}_{0}}%
\cdot\left(\boldsymbol{x}_{\left(d\right)}-\boldsymbol{x}_{0\left(d\right)}%
\right)}}}+\boldsymbol{\varepsilon}
\boldsymbol{x}_{0}
\boldsymbol{x}
f(\boldsymbol{x}_{0})=0
\boldsymbol{x}_{\left(d\right)}-\boldsymbol{x}_{0\left(d\right)}
d
\boldsymbol{R}_{d}
d
\boldsymbol{\varepsilon}
\boldsymbol{x}_{0}
\boldsymbol{x}
f(\boldsymbol{x})
\theta
x
\theta
\boldsymbol{x}_{0}
f(\boldsymbol{x}_{0})
=
0
\boldsymbol{x}-\boldsymbol{x}_{0}
\boldsymbol{x}_{0}
\boldsymbol{x}
\boldsymbol{x}_{0}
\boldsymbol{x}
\boldsymbol{x}_{0}
\boldsymbol{x}
j
\begin{cases}\sum_{i}{\boldsymbol{x}_{0\left(i\right)}\cdot\boldsymbol{W}_{i,j%
}}+\boldsymbol{b}_{j}=0\\
{\boldsymbol{x}_{0}}_{\left(i\right)}=\boldsymbol{x}_{\left(i\right)}+r\cdot%
\boldsymbol{v}_{i},r\in\mathbb{R}\,\,i\in V\\
\end{cases}
\boldsymbol{x}_{0\left(i\right)}
\boldsymbol{x}_{\left(i\right)}
\boldsymbol{x}_{0}
\boldsymbol{x}
i
\boldsymbol{W}_{i,j}
\boldsymbol{b}_{j}
\boldsymbol{v}_{i}
\boldsymbol{v}
r
\boldsymbol{x}-\boldsymbol{x}_{0}
\boldsymbol{R}_{i}^{(l)}=\sum_{j}{\frac{\boldsymbol{v}_{i}\cdot\boldsymbol{W}_%
{i,j}}{\sum_{i\prime}{\boldsymbol{v}_{i\prime}\cdot\boldsymbol{W}_{i\prime,j}}%
}\cdot}\boldsymbol{R}_{j}^{(l+1)}
\boldsymbol{R}^{(l)}_{i}
i
\boldsymbol{R}^{(l+1)}_{j}
j
\boldsymbol{v}_{i}
=
\boldsymbol{x}_{(i)}
\boldsymbol{x}
\boldsymbol{R}_{i}^{(l)}=\sum_{j}{\frac{\boldsymbol{x}_{\left(i\right)}\cdot%
\boldsymbol{W}_{i,j}}{\sum_{i\prime}{\boldsymbol{x}_{\left(i\prime\right)}%
\cdot\boldsymbol{W}_{i\prime,j}}}\cdot}\boldsymbol{R}_{j}^{(l+1)}
\boldsymbol{R}_{i}^{(l)}
\boldsymbol{R}_{j}^{(l+1)}
\boldsymbol{x}_{\left(i\right)}\cdot\boldsymbol{W}_{i,j}
\boldsymbol{R}_{i}^{(l)}=\sum_{j}{\frac{\boldsymbol{x}_{\left(i\right)}\cdot%
\boldsymbol{W}_{i,j}}{\sum_{i\prime}{\boldsymbol{x}_{\left(i\prime\right)}%
\cdot\boldsymbol{W}_{i\prime,j}}+\boldsymbol{b}_{j}}}\cdot\boldsymbol{R}_{j}^{%
(l+1)}
\boldsymbol{R}_{\left[\boldsymbol{b}_{j}\right]}^{(l)}=\sum_{j}{\frac{%
\boldsymbol{b}_{j}}{\sum_{i\prime}{\boldsymbol{x}_{\left(i\prime\right)}\cdot%
\boldsymbol{W}_{i\prime,j}}+\boldsymbol{b}_{j}}}\cdot\boldsymbol{R}_{j}^{(l+1)}
\boldsymbol{R}_{\left[\boldsymbol{b}_{j}\right]}^{(l)}
\boldsymbol{R}^{(l+1)}_{j}
\boldsymbol{R}_{\left[\boldsymbol{b}_{j}\right]}^{(l)}
\boldsymbol{R}_{i}^{(l)}
\sum_{i\prime}{\boldsymbol{x}_{\left(i\prime\right)}\cdot\boldsymbol{W}_{i%
\prime,j}}+\boldsymbol{b}_{j}
j
l
f^{(l)}(\boldsymbol{x})_{j}
\boldsymbol{W}_{i,j}
j
i
\partial f^{\left(l\right)}\left(\boldsymbol{x}\right)_{j}/\partial\boldsymbol%
{x}_{\left(i\right)}
\boldsymbol{R}_{i}^{\left(l\right)}=\sum_{j}{\boldsymbol{x}_{\left(i\right)}%
\cdot\frac{\partial f^{\left(l\right)}\left(\boldsymbol{x}\right)_{j}}{%
\partial\boldsymbol{x}_{\left(i\right)}}\cdot\frac{\boldsymbol{R}_{j}^{\left(l%
+1\right)}}{f^{\left(l\right)}\left(\boldsymbol{x}\right)_{j}}}
\boldsymbol{R}_{i}^{\left(l\right)}
i
l
f^{(l)}
\boldsymbol{A}\in\mathbb{R}^{N\times K}
\boldsymbol{B}\in\mathbb{R}^{K\times M}
\left(\boldsymbol{A}\times\boldsymbol{B}\right)\in\mathbb{R}^{N\times M}
\begin{cases}{R_{n,k}^{\boldsymbol{A}}}^{\left(l\right)}=\sum_{m}{\boldsymbol{%
A}_{n,k}\cdot\frac{\partial\left(\boldsymbol{A}\times\boldsymbol{B}\right)_{n,%
m}}{\partial\boldsymbol{A}_{n,k}}\cdot\frac{R_{n,m}^{\left(l-1\right)}}{\sum_{%
k\prime}{\boldsymbol{A}_{n,k\prime}\cdot\boldsymbol{B}_{k\prime,m}}}}\\
{R_{k,m}^{\boldsymbol{B}}}^{\left(l\right)}=\sum_{n}{\boldsymbol{B}_{k,m}\cdot%
\frac{\partial\left(\boldsymbol{A}\times\boldsymbol{B}\right)_{n,m}}{\partial%
\boldsymbol{B}_{k,m}}\cdot\frac{R_{n,m}^{\left(l-1\right)}}{\sum_{k\prime}{%
\boldsymbol{A}_{n,k\prime}\cdot\boldsymbol{B}_{k\prime,m}}}}\\
\end{cases}
R_{n,m}^{\left(l-1\right)}
\left(\boldsymbol{A}\times\boldsymbol{B}\right)_{n,m}
l-1
{R_{n,k}^{\boldsymbol{A}}}^{\left(l\right)}
{R_{k,m}^{\boldsymbol{B}}}^{\left(l\right)}
\boldsymbol{A}_{n,k}
\boldsymbol{B}_{k,m}
l
\boldsymbol{\mathcal{A}}
\boldsymbol{\mathcal{K}}
\boldsymbol{\mathcal{A}}
\boldsymbol{\mathcal{K}}
i
\boldsymbol{R}^{\left(L\right)}
\left[\boldsymbol{0}^{1},\cdots,\boldsymbol{0}^{i-1},\boldsymbol{1}^{i},%
\boldsymbol{0}^{i+1},\cdots,\boldsymbol{0}^{N}\right]
\boldsymbol{S}_{d}^{\left(l\right)}=\mathbb{E}_{h}\left(\left|\boldsymbol{%
\nabla}f_{d}^{\left(l\right)}\right|\odot\boldsymbol{R}_{d}^{\left(l\right)}%
\right)^{+}
\boldsymbol{S}_{d}^{(l)}
\boldsymbol{\nabla}f_{d}^{\left(l\right)}
\boldsymbol{R}_{d}^{\left(l\right)}
d
l
(\cdot)^{+}
\mathbb{E}_{h}
\boldsymbol{\mathcal{A}}
\boldsymbol{\mathcal{K}}
\boldsymbol{\mathcal{A}}
\boldsymbol{\mathcal{K}}
QK
i
\boldsymbol{S}^{\left(\boldsymbol{\mathcal{A}}\right)}\left[i\right]\in\mathbb%
{R}^{N\times N}
\boldsymbol{S}^{\left(\boldsymbol{\mathcal{K}}\right)}\left[i\right]\in\mathbb%
{R}^{N\times N\times T}
i
\boldsymbol{S}^{\left(\boldsymbol{\mathcal{A}}\right)}\left[i\right]_{i,:}
\boldsymbol{S}^{\left(\boldsymbol{\mathcal{K}}\right)}\left[i\right]_{:,i,:}
\boldsymbol{S}^{\left(\boldsymbol{\mathcal{A}}\right)}\left[i\right]_{i,:}
n
m
\boldsymbol{S}^{\left(\boldsymbol{\mathcal{A}}\right)}\left[i\right]_{i,j}\in%
\mathrm{Top}\left[{{m}/{n}}\right]
j
i
e_{j,i}
m/n\in\left[0,1\right]
m/n
j
d\left(e_{j,i}\right)=T-\underset{t}{\mathrm{argmax}}\left(\boldsymbol{S}^{%
\left(\boldsymbol{\mathcal{K}}\right)}\left[i\right]_{j,i,t}\right)
\frac{d\boldsymbol{x}_{t,i}}{dt}=(\boldsymbol{x}_{t,i+1}-\boldsymbol{x}_{t,i-2%
})\cdot\boldsymbol{x}_{t,i-1}-\boldsymbol{x}_{t,i}+F
\boldsymbol{x}_{t,i}
i
t
F
F\in\left[30,40\right]
d_{QK}
=
d
=
256
h
=
4
d_{FFN}
=
256
m/n
=
1/2
T
=
16
\tau
=
1
\lambda_{\boldsymbol{\mathcal{K}}}
\lambda_{\boldsymbol{M}}
=
10^{-4}
\tau
=
100
\lambda_{\boldsymbol{\mathcal{K}}}
\lambda_{\boldsymbol{M}}
=
10^{-10}
d_{QK}
=
d
=
512
h
=
8
d_{FFN}
=
512
\tau
=
10
\lambda_{\boldsymbol{\mathcal{K}}}
\lambda_{\boldsymbol{M}}
=
5\times 10^{-4}
m/n
=
2/3
T
=
32
d_{QK}
=
d
=
256
h
=
4
d_{FFN}
=
512
\tau
=
100
m/n
=
1/2
T
=
32
\lambda_{\boldsymbol{\mathcal{K}}}
\lambda_{\boldsymbol{M}}
=
0
S_{3}
S_{4}
S_{4}
\rightarrow
S_{3}
m/s
