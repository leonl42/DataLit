\pi_{0}
\pi_{0}
\pi_{0}(.|\bm{s})
\mathcal{M}=\langle\mathcal{S},\mathcal{A},R,P,T\rangle
T
\mathcal{S}
\mathcal{A}
R
P
t
\bm{s}_{t}\in\mathcal{S}
\bm{a}_{t}\sim\pi(.|\bm{s}_{t}),\ \bm{a}_{t}\in\mathcal{A}
r_{t}\in\mathbb{R}
\bm{s}_{t+1}
P(\bm{s}_{t},\bm{a}_{t},\bm{s}_{t+1})
\pi
J(\pi)=\mathbb{E}_{\pi,\mathcal{M}}[\sum_{t=0}^{T}R(\bm{s}_{t},\bm{a}_{t})]
V^{\pi}(s)=\mathbb{E}_{\pi,\mathcal{M}}[\sum_{t=0}^{T}R(\bm{s}_{t},\bm{a}_{t})%
|\bm{s}_{0}=s]
\pi
s
Q^{\pi}(s,a)=\mathbb{E}_{\pi,\mathcal{M}}[\sum_{t=0}^{T}R(\bm{s}_{t},\bm{a}_{t%
})|s_{0}=\bm{s},\bm{a}_{0}=a]
\pi
a
s
s
H^{\pi}(s)=\mathbb{E}_{\pi(.|s)}[-\log\pi(.|s)]
s
D_{s}^{KL}(\pi||\pi^{\prime})=\mathbb{E}_{\pi(.|s)}\left[\log\frac{\pi(.|s)}{%
\pi^{\prime}(.|s)}\right]
H_{s}^{X}(\pi||\pi^{\prime})=-\mathbb{E}_{\pi(.|s)}\left[\log\pi^{\prime}(.|s)\right]
\mathcal{O}_{t}
\bm{a}_{t}
\bm{s}_{t}
\mathbb{P}(\mathcal{O}_{t}|\bm{s}_{t},\bm{a}_{t})\propto\exp R(\bm{s}_{t},\bm{%
a}_{t})
\mathbb{P}(\bm{a}_{t}|\bm{s}_{t},\mathcal{O}_{1:T})
\mathcal{O}_{1:T}
\mathcal{O}_{1:T}
\mathcal{O}_{t}
\displaystyle\beta_{t}^{\pi_{0}}(\bm{s}_{t},\bm{a}_{t}):=\mathbb{P}(\mathcal{O%
}_{t:T}|\bm{s}_{t},\bm{a}_{t}),
\displaystyle\beta_{t}^{\pi_{0}}(\bm{s}_{t},\bm{a}_{t})
\displaystyle:=\mathbb{P}(\mathcal{O}_{t:T}|\bm{s}_{t},\bm{a}_{t}),
\displaystyle\beta_{t}^{\pi_{0}}(\bm{s}_{t}):=\mathbb{P}(\mathcal{O}_{t:T}|\bm%
{s}_{t})
\displaystyle\beta_{t}^{\pi_{0}}(\bm{s}_{t})
\displaystyle:=\mathbb{P}(\mathcal{O}_{t:T}|\bm{s}_{t})
\displaystyle=\mathbb{E}_{\bm{a}_{t}\sim\pi_{0}(.|\bm{s}_{t})}\left[\beta_{t}^%
{\pi_{0}}(\bm{s}_{t},\bm{a}_{t})\right],
\displaystyle=\mathbb{E}_{\bm{a}_{t}\sim\pi_{0}(.|\bm{s}_{t})}\left[\beta_{t}^%
{\pi_{0}}(\bm{s}_{t},\bm{a}_{t})\right],
\mathbb{P}(\bm{a}_{t}|\bm{s}_{t})
\pi^{*}:=\mathbb{P}(\bm{a}_{t}|\bm{s}_{t},\mathcal{O}_{1:T})
\pi_{0}
\beta_{t}^{\pi_{0}}(\bm{s}_{t})=\mathbb{E}_{\bm{a}_{t}\sim\mathcal{U}_{%
\mathcal{A}}}\left[\pi_{0}(\bm{a}_{t}|\bm{s}_{t})\beta_{t}^{\pi_{0}}(\bm{s}_{t%
},\bm{a}_{t})\right]
\displaystyle V^{\pi_{0}}(\bm{s}_{t})=\mathbb{E}_{\bm{a}_{t}\sim\mathcal{U}_{%
\mathcal{A}}}\left[\log\pi_{0}(\bm{a}_{t}|\bm{s}_{t})+\log\beta_{t}^{\pi_{0}}(%
\bm{s}_{t},\bm{a}_{t})\right]
\displaystyle V^{\pi_{0}}(\bm{s}_{t})=\mathbb{E}_{\bm{a}_{t}\sim\mathcal{U}_{%
\mathcal{A}}}\left[\log\pi_{0}(\bm{a}_{t}|\bm{s}_{t})+Q^{\pi}_{0}(\bm{a}_{t}|%
\bm{s}_{t})\right]
\mathcal{U}_{\mathcal{A}}
\log\pi_{0}(\bm{a}_{t}|\bm{s}_{T})
B^{ER}(\bm{s}_{t},\bm{a}_{t}):=\log\pi_{0}(\bm{a}_{t}|\bm{s}_{t})
\ell_{\pi_{0}}(\theta,\bm{s}_{t})
\mathbb{E}_{\pi,\mathcal{M}}\left[\sum_{t=1}^{T}-\nabla_{\theta}\log\pi_{%
\theta}(\bm{a}|\bm{s}_{t})\widehat{R}_{t}+\nabla_{\theta}\ell_{\pi_{0}}(\pi_{%
\theta},\bm{s}_{t})\right],
\widehat{R}_{t}
\theta
-\ell_{\pi_{0}}(\pi_{\theta},\bm{s}_{t+1})
\ell_{\pi_{0}}(\pi_{\theta},\bm{s}_{t})=H^{X}_{\bm{s}_{t}}(\pi||\pi_{0})
B^{E2R}(\bm{s}_{t},\bm{a}_{t}):=\log\pi_{0}(\bm{a}_{t+1}|\bm{s}_{t+1})
\pi_{0}
V^{\pi_{0}}
\mathcal{S}
\omega_{\pi_{0}}:\mathcal{S}\mapsto[0,1]
\displaystyle B_{t}^{AE2R}=\omega_{\pi_{0}}(\bm{s}_{t+1})\log\pi_{0}(\bm{a}_{t%
+1},\bm{s}_{t+1}),
\displaystyle\ell^{AE2R}_{\pi_{0}}(\pi,\bm{s}_{t})=\omega_{\pi_{0}}(\bm{s}_{t}%
)H^{X}_{\bm{s}_{t}}(\pi||\pi_{0}).
\begin{split}&\mathcal{L}_{V}(\phi)=\\
&\quad\mathbb{E}_{\bm{s}_{t}\sim\mathcal{B}}\left[V_{\phi}(\bm{s}_{t})-(R(\bm{%
s}_{t},\bm{a}_{t})+B_{t}+\gamma V_{\phi}(\bm{s}_{t+1}))\right]^{2},\end{split}
\phi
\mathcal{B}
B_{t}
\omega_{\pi_{0}}(.)
\psi
\mathcal{L}_{V}
\psi
\mathcal{L}_{\omega}(\psi)
\omega
\begin{split}&\mathcal{L}^{AE2R}_{\omega}(\psi)=\\
&\quad\mathbb{E}_{\bm{s}_{t}\sim\mathcal{B}}\left[E_{t}(\phi)-\omega_{\psi}(%
\bm{s}_{t+1})\log\pi_{0}(\bm{a}_{t+1},\bm{s}_{t+1})\right]^{2},\end{split}
E_{t}(\phi):=V_{\phi}(\bm{s}_{t})-R(\bm{s}_{t},\bm{a}_{t})-\gamma V_{\phi}(\bm%
{s}_{t+1})
\ell_{\pi_{0}}
B_{t}
\tau_{t}=(s_{0},a_{0},\dots,s_{t},a_{t})
\ell_{\pi_{0}}(\theta,\tau_{t})
B_{t}=-\ell_{\pi_{0}}(\theta,\tau_{t})
r_{\pi_{0}}
A
A_{\pi_{0}}
\pi_{0}
r_{\pi_{0}}=\frac{A_{\pi_{0}}-A}{A}
0
95\%
0
95\%
\widehat{R}_{t}
50\%
15\%
30\%
50\%
\pm
1.96
\pm
1.96
0.432\pm 0.001
0.298\pm 0.001
0.439\pm 0.001
0.299\pm 0.001
0.461\pm 0.001
0.308\pm 0.001
\omega
0.5
\omega
\mathcal{L}(\theta,\psi,\phi)=\mathcal{L}_{\pi}(\theta)+\mathcal{L}_{V}(\phi)+%
C_{\omega}\mathcal{L}_{\omega}(\psi),
\mathcal{L}_{\pi}
C_{\omega}
\{1.0,0.3,0.03,0.003\}
C_{\omega}
C_{\omega}
C_{\omega}
C_{\omega}
C_{\omega}=1.0
\mathcal{L}_{\pi}(\theta)
\ell_{\pi_{0}}(\theta)
\lambda_{\pi}\geq 0,\lambda_{V}\geq 0,\lambda_{\omega}\geq 0
\theta
\phi
\psi
\mathcal{B}\leftarrow\emptyset
a_{t}\sim\pi_{\theta}(s_{t})
s_{t+1}\sim p(s_{t},a_{t})
\mathcal{B}\leftarrow\mathcal{B}\cup\{(s_{t},a_{t},r_{t},s_{t+1})\}
\theta
B^{AE2R}
\ell^{AE2R}
\phi\leftarrow\phi-\lambda_{V}\hat{\nabla}_{\phi}\mathcal{L}_{V}^{AE2R}(\phi)
\psi\leftarrow\psi-\lambda_{\omega}\hat{\nabla}_{\psi}\mathcal{L}_{\omega}^{AE%
2R}(\psi)
0.01
0.1
\tau
\pi_{0}(\bm{a}|\bm{s})=\frac{\exp\left(Q(\bm{s},\bm{a})/\tau\right)}{\sum_{\bm%
{a}^{\prime}\in\mathcal{A}}\exp\left(Q(\bm{s},\bm{a}^{\prime})/\tau\right)}.
\tau=1
r_{\pi_{0}}
r_{\pi_{0}}
r_{\pi_{0}}
\pi_{0}
r_{\pi_{0}}
\pi_{0}
r_{\pi_{0}}
\times 10^{-3}
\mathbf{36\ (25,50)}
29\ (21,40)
28\ (19,40)
25(17,35)
\mathbf{11\ (4,19)}
6\ (0,13)
10\ (3,18)
\mathbf{11(4,19)}
-38\ (-51,-28)
-36\ (-47,-27)
\mathbf{-11\ (-17,-5)}
-14\ (-21,-8)
-144\ (-172,-119)
-203\ (-237,-172)
\mathbf{-59\ (-72,-48)}
-74\ (-91,-61)
-74\ (-94,-57)
-38\ (-50,-27)
\mathbf{-11\ (-19,-4)}
-16\ (-24,-8)
-108\ (-130,-88)
-101\ (-125,-80)
-46\ (-57,-36)
\mathbf{-41\ (-53,-31)}
-269\ (-303,-237)
-248\ (-283,-216)
\mathbf{-90\ (-106,-76)}
-133\ (-156,-112)
r_{\pi_{0}}
r_{\pi_{0}}
\epsilon
3\times 10^{-4}
\lambda
0.273\pm 0.153
0.006\pm 0.023
-22\pm 15
-1.0\pm 11
-1.7\pm 62
0.6\pm 12
0.024\pm 0.030
0.009\pm 0.027
-13\pm 6.4
-2.6\pm 3.9
-0.2\pm 4.9
0.1\pm 1.7
0.026\pm 0.036
0.009\pm 0.024
-6.7\pm 1.9
-2.3\pm 1.2
1.7\pm 0.3
0.10\pm 0.08
0.423\pm 0.051
0.014\pm 0.029
-21\pm 20
1.4\pm 17
459\pm 1580
18\pm 520
0.033\pm 0.037
0.004\pm 0.029
-14\pm 5.3
-2.2\pm 3.1
0.87\pm 3.4
0.076\pm 1.2
\ell_{\pi_{0}}(\theta)
\ell_{\pi_{0}}(\theta)
\ell_{\pi_{0}}(\theta)
