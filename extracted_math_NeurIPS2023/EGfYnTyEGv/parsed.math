N
N
Q
Q
Q
\lambda
Q(\sigma
\sigma
N
n
n
n
n
n
n
\lambda
n
n
n
n=1,3,5
n=3
n=1,5
n=5
n=6
n
n=30
n=
4
15
3
5
30
n
N
N
Q
k
s_{k}\in\mathcal{S}
a_{k}\in\mathcal{A}
\pi:\mathcal{S}\to\mathcal{A}
a_{k}=\pi(s_{k})
r(s_{k},a_{k})\in\mathcal{R}
r_{k}
R_{k}=\sum_{t=k}^{\infty}\gamma^{t-k}r_{t}
0<\gamma<1
R_{k}
Q(s_{k},a_{k})=\mathbb{E}[R_{k}|s_{k},a_{k}],
\pi
Q(s_{k},a_{k})
y=r_{k}+\gamma Q(s_{k+1},a_{k+1})
\theta
L\left(\theta\right)=\mathbb{E}_{s\sim p_{\pi},a\sim\pi}[(y-Q(s_{k},a_{k}))^{2%
}].
Q
\displaystyle\nabla_{\theta}Q(s_{k},a_{k})
\displaystyle\nabla_{\theta}Q(s_{k},a_{k})
\displaystyle=\mathbb{E}_{s\sim p_{\pi}}\left[\left.\nabla_{a}Q^{\pi}(s_{k},a_%
{k})\right|_{a_{k}=\pi(s_{k})}\nabla_{\theta}\pi(s_{k})\right].
\displaystyle=\mathbb{E}_{s\sim p_{\pi}}\left[\left.\nabla_{a}Q^{\pi}(s_{k},a_%
{k})\right|_{a_{k}=\pi(s_{k})}\nabla_{\theta}\pi(s_{k})\right].
Q
Q_{\theta_{j}}(s_{k},a_{k})
j=1,2
Q
Q
y
y=r_{k}+\gamma\min_{j=1,2}Q_{\theta_{j}}(s_{k+1},a_{k+1}).
Q
Q
L\left(\theta_{j}\right)
L\left(\theta_{j}\right)=\mathbb{E}_{s\sim p_{\pi},a\sim\pi}[(y-Q_{\theta_{j}}%
(s_{k},a_{k}))^{2}].
r_{k}
n
n
Q
Q\left(s_{k},a_{k}\right)=r_{k}+\gamma Q\left(s_{k+1},a_{k+1}\right).
n
n
n
Q\left(s_{k},a_{k}\right)
n
Q\left(s_{k},a_{k}\right)=\sum_{t=k}^{k+n-1}\gamma^{t-k}r_{t}+\gamma^{n}Q(s_{k%
+n},a_{k+n}).
n
n
n
n
r_{avg}=\frac{1}{n}(\sum_{t=k}^{k+n-1}r_{t}),
Q(s_{k},a_{k})=r_{avg}+\gamma Q(s_{k+1},a_{k+1}).
N
G(s_{k:k+N-1},a_{k:k+N-1})\in\mathbf{R}
G_{k}
N
G_{k}=\sum_{t=k}^{k+N-1}\gamma^{t-k}r_{t},
r_{k}
k
r^{\prime}
r_{k}
N
N
G^{\prime}
\displaystyle G^{\prime}=\sum_{t=k}^{k+N-1}\gamma^{t-k}r^{\prime}=\frac{\gamma%
^{N}-1}{\gamma-1}r^{\prime}.
\displaystyle G^{\prime}
\displaystyle=\sum_{t=k}^{k+N-1}\gamma^{t-k}r^{\prime}=\frac{\gamma^{N}-1}{%
\gamma-1}r^{\prime}.
r^{\prime}
\displaystyle r^{\prime}=G_{k}*\frac{\gamma-1}{\gamma^{N}-1}.
\displaystyle r^{\prime}
\displaystyle=G_{k}*\frac{\gamma-1}{\gamma^{N}-1}.
r^{\prime}
N
k
(k+N-1)
\mathbb{D}^{\prime}
T
[0,1,2...,T]
\mathbb{D}^{\prime}
N
s_{0}
s_{T}
N
N
T
r^{\prime}
k
N
T
k+N-1\leq T
r^{\prime}
N
r^{\prime}=(\sum_{t=k}^{k+N-1}\gamma^{t-k}r_{t})*\frac{\gamma-1}{\gamma^{N}-1}.
k+N-1>T
r^{\prime}
N
r^{\prime}
r^{\prime}=(\sum_{t=k}^{T}\gamma^{t-k}r_{t})*\frac{\gamma-1}{\gamma^{T-k+1}-1}.
r^{\prime}
r^{\prime}
(s_{k},a_{k},s_{k+1})
(s_{k},a_{k},r^{\prime},s_{k+1})
\mathbb{D}
Q
\displaystyle Q_{i+1}(s_{k},a_{k})=r^{\prime}+\gamma^{n}Q_{i}(s_{k+n},\pi_{i}(%
s_{k+n})),
\displaystyle Q_{i+1}(s_{k},a_{k})
\displaystyle=r^{\prime}+\gamma^{n}Q_{i}(s_{k+n},\pi_{i}(s_{k+n})),
\displaystyle\pi_{i}(s_{k})=arg\max_{a_{k}}Q_{i}(s_{k},a_{k}),
\displaystyle\pi_{i}(s_{k})
\displaystyle=arg\max_{a_{k}}Q_{i}(s_{k},a_{k}),
i
n
n
Q
Q_{i+1}(s_{k},a_{k})=r^{\prime}+\gamma^{n}\max_{a_{k+n}}Q_{i}(s_{k+n},a_{k+n}).
n
n
Q
N
n
Q
r^{\prime}
r_{k}
n=1
N>>1
Q
n
5
5
1000
5
N
N=50,100
n=1
n=1
0<\gamma<1
Q
N
r_{k}
r^{\prime}
\displaystyle var[Q_{i+1}(s_{k},a_{k})]=var[r_{k}]+var[\gamma Q_{i}(s_{k+1},a_%
{k+1})]
\displaystyle var[Q_{i+1}(s_{k},a_{k})]
\displaystyle=var[r_{k}]+var[\gamma Q_{i}(s_{k+1},a_{k+1})]
\displaystyle+2cov[r_{k},\gamma Q_{i}(s_{k+1},a_{k+1})].
\displaystyle+2cov[r_{k},\gamma Q_{i}(s_{k+1},a_{k+1})].
\displaystyle var[\mathbb{Q}_{i+1}(s_{k},a_{k})]=var[r^{\prime}]+var[\gamma%
\mathbb{Q}_{i}(s_{k+1},a_{k+1})]
\displaystyle var[\mathbb{Q}_{i+1}(s_{k},a_{k})]
\displaystyle=var[r^{\prime}]+var[\gamma\mathbb{Q}_{i}(s_{k+1},a_{k+1})]
\displaystyle+2cov[r^{\prime},\gamma\mathbb{Q}_{i}(s_{k+1},a_{k+1})].
\displaystyle+2cov[r^{\prime},\gamma\mathbb{Q}_{i}(s_{k+1},a_{k+1})].
\{r_{k}\}
\mathbb{D}
Q_{i}(s_{k+1},a_{k+1})
i
cov(r_{k},r_{j\neq k})=0,
cov(r_{k},Q_{i}(s_{k+1},a_{k+1}))=0.
\{r_{k}\}
Q_{i}(s_{k+1},a_{k+1})
(s_{k+1},a_{k+1})
Q
Q
{Q_{i}}
\mathbb{Q}_{i}
Q_{0}=var[Q_{0}]=0
\mathbb{Q}_{0}=var[\mathbb{Q}_{0}]=0
\{r_{k}\}
\mathbb{D}
\{r_{k}\}
\mathbb{B}
var[r_{k}]\leq\mathbb{B}
\psi
\psi=(\frac{\gamma-1}{\gamma^{N}-1})^{2}(\frac{\gamma^{2N}-1}{\gamma^{2}-1}).
Q
{var[Q_{i+1}]}
var[\mathbb{Q}_{i+1}]
var[Q_{i+1}(s_{k},a_{k})]\leq\sum_{t=1}^{i+1}(\gamma^{t-1})^{2}\mathbb{B},
var[\mathbb{Q}_{i+1}(s_{k},a_{k})]\leq\psi\sum_{t=1}^{i+1}(\gamma^{t-1})^{2}%
\mathbb{B}.
i=0
\displaystyle var[Q_{1}(s_{k},a_{k})]=var[r_{k}],
\displaystyle var[Q_{1}(s_{k},a_{k})]
\displaystyle=var[r_{k}],
\displaystyle var[\mathbb{Q}_{1}(s_{k},a_{k})]=var[r^{\prime}].
\displaystyle var[\mathbb{Q}_{1}(s_{k},a_{k})]
\displaystyle=var[r^{\prime}].
var[Q_{1}(s_{k},a_{k})]\leq\mathbb{B}
var[r_{k}]\leq\mathbb{B}
var[r^{\prime}]
\displaystyle var[r^{\prime}]=var[\frac{\gamma-1}{\gamma^{N}-1}\sum_{t=k}^{k+N%
-1}\gamma^{t-k}r_{t}]
\displaystyle var[r^{\prime}]=var[\frac{\gamma-1}{\gamma^{N}-1}\sum_{t=k}^{k+N%
-1}\gamma^{t-k}r_{t}]
\displaystyle=(\frac{\gamma-1}{\gamma^{N}-1})^{2}var[\sum_{t=k}^{k+N-1}\gamma^%
{t-k}r_{t}]
\displaystyle=(\frac{\gamma-1}{\gamma^{N}-1})^{2}var[\sum_{t=k}^{k+N-1}\gamma^%
{t-k}r_{t}]
\displaystyle=(\frac{\gamma-1}{\gamma^{N}-1})^{2}\sum_{l=k}^{k+N-1}\sum_{t=k}^%
{k+N-1}(\gamma^{t-k})^{2}cov(r_{t},r_{l})
\displaystyle=(\frac{\gamma-1}{\gamma^{N}-1})^{2}\sum_{l=k}^{k+N-1}\sum_{t=k}^%
{k+N-1}(\gamma^{t-k})^{2}cov(r_{t},r_{l})
\displaystyle=(\frac{\gamma-1}{\gamma^{N}-1})^{2}\sum_{t=k}^{k+N-1}(\gamma^{t-%
k})^{2}var[r_{t}]
\displaystyle=(\frac{\gamma-1}{\gamma^{N}-1})^{2}\sum_{t=k}^{k+N-1}(\gamma^{t-%
k})^{2}var[r_{t}]
\displaystyle\leq(\frac{\gamma-1}{\gamma^{N}-1})^{2}(\frac{\gamma^{2N}-1}{%
\gamma^{2}-1})\mathbb{B},
\displaystyle\leq(\frac{\gamma-1}{\gamma^{N}-1})^{2}(\frac{\gamma^{2N}-1}{%
\gamma^{2}-1})\mathbb{B},
\displaystyle var[\mathbb{Q}_{1}(s_{k},a_{k})]\leq\psi\mathbb{B}.
\displaystyle var[\mathbb{Q}_{1}(s_{k},a_{k})]\leq\psi\mathbb{B}.
i=0
i=l-1
l=1,2,...
i=l
\displaystyle var[Q_{l+1}(s_{k},a_{k})]=var[r_{k}]+var[\gamma Q_{l}(s_{k+1},a_%
{k+1})]
\displaystyle var[Q_{l+1}(s_{k},a_{k})]
\displaystyle=var[r_{k}]+var[\gamma Q_{l}(s_{k+1},a_{k+1})]
\displaystyle\leq\mathbb{B}+\gamma^{2}\sum_{t=1}^{l}(\gamma^{t-1})^{2}\mathbb{B}
\displaystyle\leq\mathbb{B}+\gamma^{2}\sum_{t=1}^{l}(\gamma^{t-1})^{2}\mathbb{B}
\displaystyle=\sum_{t=1}^{l+1}(\gamma^{t-1})^{2}\mathbb{B}.
\displaystyle=\sum_{t=1}^{l+1}(\gamma^{t-1})^{2}\mathbb{B}.
\displaystyle var[\mathbb{Q}_{l+1}(s_{k},a_{k})]=var[r^{\prime}]+var[\gamma%
\mathbb{Q}_{i}(s_{k+1},a_{k+1})]
\displaystyle var[\mathbb{Q}_{l+1}(s_{k},a_{k})]
\displaystyle=var[r^{\prime}]+var[\gamma\mathbb{Q}_{i}(s_{k+1},a_{k+1})]
\displaystyle\leq\psi\mathbb{B}+\gamma^{2}\psi\sum_{t=1}^{l}(\gamma^{t-1})^{2}%
\mathbb{B}
\displaystyle\leq\psi\mathbb{B}+\gamma^{2}\psi\sum_{t=1}^{l}(\gamma^{t-1})^{2}%
\mathbb{B}
\displaystyle=\psi\sum_{t=1}^{l+1}(\gamma^{t-1})^{2}\mathbb{B}.
\displaystyle=\psi\sum_{t=1}^{l+1}(\gamma^{t-1})^{2}\mathbb{B}.
\psi
\psi
\psi
\psi=(\frac{\gamma-1}{\gamma^{N}-1})^{2}(\frac{\gamma^{2N}-1}{\gamma^{2}-1})
N
\psi={(\gamma-1)}^{2}(\frac{-1}{\gamma^{2}-1})=\frac{1-\gamma}{1+\gamma}
\gamma^{2}-1=(\gamma-1)(\gamma+1)
\gamma^{2N}-1=(\gamma^{N}-1)(\gamma^{N}+1)
\psi=(\frac{\gamma-1}{\gamma+1})(1+\frac{2}{\gamma^{N}-1})
\psi
N
r_{k}
\mathbb{D}^{\prime}
n
n
n=5
N=5
r^{\prime}
N=5
n=1
n=100
n
n=100
[0,500]
Q
\frac{std(Q)}{Q}\%
N
N
N
Q
N
Q
Q
[0,500]
[0,500]
n=1
N
N=5,50,100
n=1
N
N=5,50,100
N
(N=5,50,100)
N
[0,500]
N=50
N=100
N=5
N=100
N=50
N=1000
N
N=50
N=100
n
n
n
N
n
Q
n=5
Q
Q
Q
\mathbb{D}^{\prime}
N
50
100
N
Q
N
n
Q
T=1000
8\times 10^{5}
1\times 10^{4}
(0-4)
\mathcal{N}(0,0.1)
1\times 10^{4}
s_{m}
(s_{m}+100)
a_{i},i=0,1,2,...7
s_{a_{i}}
s_{a_{i}}=s_{m}+i
s_{a_{i}}
Q
10^{-3}
k
(s,a,r,s^{\prime})
(s,a,r^{\prime},s^{\prime})
\mathbb{D}
\epsilon\sim\mathcal{N}(0,0.2)
(-0.5,0.5)
d
d=2
d
\tau=0.005
\mathcal{N}(0,0.1)
\mathcal{N}(0,0.2)
\pm 0.5
\gamma
\tau
p_{\pi}(s)
8
N
\mathbb{A}
N
N
n
n
\mathbb{D}
\mathbb{D}^{\prime}
N
\mathbb{T}
\mathbb{A}
\mathbb{D}
\mathbb{D}^{\prime}
\mathbb{T}
s_{0}
\mathbb{D}^{\prime}
T
a_{k}
s_{k}
\mathbb{A}
a_{k}
s_{k+1}
r_{k}
(s_{k},a_{k},r_{k},s_{k+1})
\mathbb{D}^{\prime}
k+N-1\leq T
(s_{0}^{\prime},a_{0}^{\prime},r_{0}^{\prime},s_{1}^{\prime})
\mathbb{D}^{\prime}
r^{\prime}
(s_{0}^{\prime},a_{0}^{\prime},r^{\prime},s_{1}^{\prime})
\mathbb{D}
(s_{0}^{\prime},a_{0}^{\prime},r_{0}^{\prime},s_{1}^{\prime})
\mathbb{D}^{\prime}
r^{\prime}
r^{\prime}
n
\mathbb{A}
\mathbb{D}
n
Q_{\theta}(s_{k},a_{k})
Q(s_{k},a_{k})
Q
\theta
Q(s_{k},a_{k})
Q(s_{k},a_{k})=\mathbb{E}_{s\sim p_{\pi},a\sim\pi}[r_{k}+\gamma\max_{a}Q(s_{k+%
1},a)]
\pi=arg\max_{a}Q(s_{k},a)
p_{\pi}(s)
y=\mathbb{E}_{s\sim p_{\pi},a\sim\pi}[r_{k}+\gamma\max_{a}Q(s_{k+1},a)]
L\left(\theta\right)=\mathbb{E}_{s\sim p_{\pi},a\sim\pi}[(y-Q(s_{k},a_{k}))^{2}]
L(\theta)
L(\theta)
\displaystyle\nabla_{\theta}L\left(\theta\right)=\mathbb{E}_{s\sim p_{\pi},a%
\sim\pi_{i}}[(r_{k}
\displaystyle\nabla_{\theta}L\left(\theta\right)
\displaystyle=\mathbb{E}_{s\sim p_{\pi},a\sim\pi_{i}}[(r_{k}
\displaystyle+\gamma\max_{a}Q(s_{k+1},a)
\displaystyle+\gamma\max_{a}Q(s_{k+1},a)
\displaystyle-Q(s_{k},a_{k}))\nabla_{\theta}Q(s_{k},a_{k})].
\displaystyle-Q(s_{k},a_{k}))\nabla_{\theta}Q(s_{k},a_{k})].
n
n
R_{n}=\sum_{t=k}^{t=k+n-1}\gamma^{t-k}r_{t}
n
y=\mathbb{E}_{s\sim p_{\pi},a\sim\pi}[R_{n}+\gamma^{n}\max_{a}Q(s_{k+n},a)
V(s_{k})
T
V(s_{k})
A_{k}
\displaystyle\hat{A}_{k}=\delta_{k}+(\gamma\lambda)\delta_{k+1}+\cdots+\cdots+%
(\gamma\lambda)^{T-k+1}\delta_{T-1},
\displaystyle\hat{A}_{k}
\displaystyle=\delta_{k}+(\gamma\lambda)\delta_{k+1}+\cdots+\cdots+(\gamma%
\lambda)^{T-k+1}\delta_{T-1},
\displaystyle\delta_{k}=r_{k}+\gamma V\left(s_{k+1}\right)-V\left(s_{k}\right),
\displaystyle\delta_{k}
\displaystyle=r_{k}+\gamma V\left(s_{k+1}\right)-V\left(s_{k}\right),
\lambda
n
n
\displaystyle\left(\mathcal{T}_{\pi}^{N}Q\right)\left(\mathbf{x}_{0},\mathbf{a%
}_{0}\right)=r\left(\mathbf{x}_{0},\mathbf{a}_{0}\right)+\mathbb{E}[\sum_{n=1}%
^{N-1}\gamma^{n}r\left(\mathbf{x}_{n},\mathbf{a}_{n}\right)
\displaystyle\left(\mathcal{T}_{\pi}^{N}Q\right)\left(\mathbf{x}_{0},\mathbf{a%
}_{0}\right)
\displaystyle=r\left(\mathbf{x}_{0},\mathbf{a}_{0}\right)+\mathbb{E}[\sum_{n=1%
}^{N-1}\gamma^{n}r\left(\mathbf{x}_{n},\mathbf{a}_{n}\right)
\displaystyle+\gamma^{N}Q\left(\mathbf{x}_{N},\pi\left(\mathbf{x}_{N}\right)%
\right)\mid\mathbf{x}_{0},\mathbf{a}_{0}]
\displaystyle+\gamma^{N}Q\left(\mathbf{x}_{N},\pi\left(\mathbf{x}_{N}\right)%
\right)\mid\mathbf{x}_{0},\mathbf{a}_{0}]
\left(\mathcal{T}_{\pi}^{N}Q\right)\left(\mathbf{x}_{0},\mathbf{a}_{0}\right)
Q
n
Q
\frac{std(Q)}{Q}\%
n
N
(N=5,50,100)
Q
N
Q
Q
n=100
N
(N=5,50,100)
N
N
N=100
N=100
N
N
N
N
