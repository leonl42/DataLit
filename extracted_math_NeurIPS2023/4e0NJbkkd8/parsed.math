1/\sqrt{N}
N
\ell_{\infty}
\pi
d^{\pi}
\pi
\mu
w^{\pi}=d^{\pi}/\mu
\ell_{\infty}
w^{\pi}
C^{\pi}_{\ell_{\infty}}=\|w^{\pi}\|_{\infty}
\ell_{\infty}
C^{\pi}_{\ell_{\infty}}
\pi
\mu(a|s)
\ell_{\infty}
\ell_{\infty}
\ell_{\infty}
C^{\pi}_{\text{Bellman}}
O\left(\frac{1}{\sqrt{N}}\right)
\ell_{\infty}
\ell_{2}
O\left(\frac{1}{\sqrt{N}}\right)
\ell_{\infty}
O\left(\frac{1}{\sqrt{N}\text{gap}(Q^{\star})}\right)
\ell_{\infty}
O\left(\frac{1}{N^{1/6}}\right)
C^{\pi}_{\text{Bellman}}
O\left(\frac{1}{N^{1/3}}\right)
\ell_{\infty}
O\left(\frac{1}{\sqrt{N}}\right)
\ell_{\infty}
O\left(\frac{1}{\sqrt{N}}\right)
\ell_{2}
O\left(\frac{1}{\sqrt{N}}\right)
1/\sqrt{N}
1/N^{1/3}
1/\sqrt{N}
\ell_{\infty}
\ell_{2}
\ell_{\infty}
C^{\pi}_{\ell_{\infty}}=\|w^{\pi}\|_{\infty}
C^{\pi}_{\ell_{2}}=\|w^{\pi}\|_{2,\mu}
\|\cdot\|_{2,\mu}
\mu
w^{\pi}
(C^{\pi}_{\ell_{2}})^{2}=\mathbb{E}_{d^{\pi}}[w^{\pi}(s,a)]
\ell_{2}
C^{\pi}_{\text{Bellman}}
C^{\pi}_{\ell_{\infty}}
\mathcal{F}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{2}}
C^{\pi}_{\text{Bellman}}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{2}}
C^{\pi}_{\text{Bellman}}
\pi
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{2}}
\mathcal{F}
C^{\pi}_{\ell_{2}}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\text{Bellman}}
\mathcal{F}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{2}}
C^{\pi}_{\text{Bellman}}
\pi
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{2}}
\mathcal{F}
C^{\pi}_{\ell_{2}}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\text{Bellman}}
\mathcal{F}
C^{\pi}_{\ell_{\infty}}
\Delta(\mathcal{X})
\mathcal{X}
\textsf{Unif}(\mathcal{X})
\mathcal{X}
\|\cdot\|_{2,\mu}=\sqrt{\mathbb{E}_{\mu}[(\cdot)^{2}]}
\mu
x\lesssim y
c>0
x\leq cy
x\gtrsim y
y\lesssim x
x\asymp y
x\lesssim y
y\lesssim x
O(\cdot)
\tilde{O}(\cdot)
M=(\mathcal{S},\mathcal{A},P,R,\gamma,\rho)
\mathcal{S}
\mathcal{A}
P:\mathcal{S}\times\mathcal{A}\to\Delta(\mathcal{S})
R:\mathcal{S}\times\mathcal{A}\to\Delta([0,1])
r:\mathcal{S}\times\mathcal{A}\to[0,1]
\gamma\in[0,1)
\rho:\mathcal{S}\to[0,1]
\mathcal{A}
\mathcal{S}
\pi:\mathcal{S}\to\Delta(\mathcal{A})
\pi
d^{\pi}:\mathcal{S}\times\mathcal{A}\to[0,1]
d^{\pi}(s,a)\coloneqq(1-\gamma)\sum_{t=0}^{\infty}\gamma^{t}P_{t}(s_{t}=s,a_{t%
}=a;\pi)
P_{t}(s_{t}=s,a_{t}=a;\pi)
(s,a)
t
s_{0}\sim\rho(\cdot)
\pi
d^{\pi}(s)=\sum_{a\in\mathcal{A}}d^{\pi}(s,a)
\mathbb{E}_{\pi}[\cdot]
\mathbb{E}_{(s,a)\sim d^{\pi}}[\cdot]
\mathbb{E}_{s\sim d^{\pi}}[\cdot]
\pi
V^{\pi}(s)\coloneqq\mathbb{E}\left[\sum_{t=0}^{\infty}\gamma^{t}r_{t}\;|\;s_{0%
}=s,a_{t}\sim\pi(\cdot|s_{t}),\;\forall\;t\geq 0\right]
s\in\mathcal{S}
r_{t}=R(s_{t},a_{t})
Q
(s,a)
Q^{\pi}(s,a)\coloneqq\mathbb{E}\left[\sum_{t=0}^{\infty}\gamma^{t}r_{t}\;|\;s_%
{0}=s,a_{0}=a,a_{t}\sim\pi(\cdot|s_{t}),\;\forall\;t>0\right].
J(\pi)\coloneqq(1-\gamma)\mathbb{E}_{s\sim\rho}[V^{\pi}(s)]=\mathbb{E}_{(s,a)%
\sim d^{\pi}}[r(s,a)]
\pi
\pi^{\star}
V^{\star}\coloneqq V^{\pi^{\star}},Q^{\star}\coloneqq Q^{\pi^{\star}}
Q
\mathcal{S}
\mathcal{S}
\mathcal{F}\subseteq\{f:\mathcal{S}\times\mathcal{A}\rightarrow[0,V_{\max}]\}
\mathcal{W}\subseteq\{w:\mathcal{S}\times\mathcal{A}\rightarrow[0,B_{w}]\}
\mathcal{W}
\Pi\subseteq\{\pi:\mathcal{S}\rightarrow\Delta(\mathcal{A})\}
f\in\mathcal{F}
\pi\in\Pi
f(s,\pi)=\sum_{a\in\mathcal{A}}\pi(a|s)f(s,a)
s\in\mathcal{S}
\mathcal{T}^{\pi}:{\mathbb{R}}^{\mathcal{S}\times\mathcal{A}}\to{\mathbb{R}}^{%
\mathcal{S}\times\mathcal{A}}
\displaystyle(\mathcal{T}^{\pi}f)(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim
P%
(\cdot|s,a)}[f(s^{\prime},\pi)].
\displaystyle(\mathcal{T}^{\pi}f)(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim
P%
(\cdot|s,a)}[f(s^{\prime},\pi)].
f
Q
\pi
\epsilon_{\mathcal{F}}\geq 0
\pi\in\Pi
\min_{f\in\mathcal{F}}\max_{\text{admissible }\nu}\|f-\mathcal{T}^{\pi}f\|_{2,%
\nu}^{2}\leq\epsilon_{\mathcal{F}}
\nu
\nu\in\{d^{\pi}|\pi\in\Pi\}
\|f-\mathcal{T}^{\pi}f\|_{2,\nu}
\nu
f\approx Q^{\pi}
\pi
Q^{\pi}
\mathcal{F}
\epsilon_{\mathcal{F}}=0
Q^{\pi}\in\mathcal{F}
\pi\in\Pi
\mathcal{D}=\{(s_{i},a_{i},r_{i},s_{i}^{\prime})\}_{i=1}^{N}
r_{i}\sim R(s_{i},a_{i})
s_{i}^{\prime}\sim P(\cdot\mid s_{i},a_{i})
(s_{i},a_{i})
\mu\in\Delta(\mathcal{S}\times\mathcal{A})
\mu
\mu
\mu\in\Pi
\hat{\pi}
J(\hat{\pi})
f
(s,a,r,s^{\prime})
\mathcal{D}
\mathbb{E}_{\mathcal{D}}[f]=\frac{1}{N}\sum_{(s_{i},a_{i},r_{i},s^{\prime}_{i}%
)\in\mathcal{D}}f(s_{i},a_{i},r_{i},s^{\prime}_{i})
\pi
\pi
w^{\pi}(s,a)\coloneqq\frac{d^{\pi}(s,a)}{\mu(s,a)}.
\pi
\ell_{2}
\ell_{2}
\pi
C^{\pi}_{\ell_{2}}=\left\|w^{\pi}\right\|_{2,\mu}=\left\|d^{\pi}/\mu\right\|_{%
2,\mu}.
\frac{d^{\pi}(s,a)}{\mu(s,a)}
s\in\mathcal{S}
a\in\mathcal{A}
\pi
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{\infty}
\ell_{\infty}
C^{\pi}_{\ell_{\infty}}=\left\|d^{\pi}/\mu\right\|_{\infty}
C^{\pi}_{\text{Bellman}}=\max_{f\in\mathcal{F}}\frac{\|f-\mathcal{T}^{\pi}f\|_%
{2,d^{\pi}}^{2}}{\|f-\mathcal{T}^{\pi}f\|_{2,\mu}^{2}}
(C^{\pi}_{\ell_{2}})^{2}\leq C^{\pi}_{\ell_{\infty}}
C^{\pi}_{\ell_{2}}\leq C^{\pi}_{\ell_{\infty}}
(C^{\pi}_{\ell_{2}})^{2}\leq C^{\pi}_{\text{Bellman}}
C^{\pi}_{\ell_{2}}\leq C^{\pi}_{\text{Bellman}}
\ell_{2}
\ell_{\infty}
\mathbb{E}_{d^{\pi}}[w^{\pi}(s,a)]
w^{\pi}(s,a)
s\in\mathcal{S}
a\in\mathcal{A}
C^{\pi}_{\ell_{2}}
C^{\pi}_{\ell_{\infty}}
\ell_{\infty}
\ell_{2}
\mu(a_{1})=1-\epsilon^{2},\quad\mu(a_{2})=\epsilon^{2}
\epsilon>0
\pi
\pi(a_{1})=d^{\pi}(a_{1})=1-\epsilon,\quad\pi(a_{2})=d^{\pi}(a_{2})=\epsilon.
w^{\pi}(a_{1})=\frac{1-\epsilon}{1-\epsilon^{2}}\leq 1
w^{\pi}(a_{2})=\frac{1}{\epsilon}
C^{\pi}_{\ell_{2}}\leq\sqrt{2}
C^{\pi}_{\ell_{\infty}}=\frac{1}{\epsilon}
\mathcal{F}
\mathcal{F}
C^{\pi}_{\text{Bellman}}
C^{\pi}_{\ell_{\infty}}
C^{\pi}_{{\ell_{2}}}
\mathcal{W}
\ell_{2}
\ell_{2}
\mathcal{W}
\|w\|_{2,\mu}\leq C^{\star}_{{\ell_{2}}}
w\in\mathcal{W}
w^{\pi}
w^{\pi}\in\mathcal{W}
\pi\in\Pi
C^{\star}_{\ell_{2}}
w^{\pi}\in\mathcal{W}
\pi\in\Pi
\mathcal{W}
\displaystyle\hat{\pi}^{*}\in\text{arg\,max}_{\pi\in\Pi}f^{\pi}(s_{0},\pi),%
\quad f^{\pi}\in\text{arg\,min}_{f\in\mathcal{F}}\mathbb{E}_{\mu}[((f-\mathcal%
{T}^{\pi}f)(s,a))^{2}],
\displaystyle\hat{\pi}^{*}\in\text{arg\,max}_{\pi\in\Pi}f^{\pi}(s_{0},\pi),%
\quad f^{\pi}\in\text{arg\,min}_{f\in\mathcal{F}}\mathbb{E}_{\mu}[((f-\mathcal%
{T}^{\pi}f)(s,a))^{2}],
s_{0}
f(s,\pi)=\sum_{a\in\mathcal{A}}\pi(a|s)f(s,a).
\pi
f\in\mathcal{F}
\beta\geq 0
f^{\pi}\in\text{arg\,min}_{f\in\mathcal{F}}f(s_{0},\pi)+\beta\mathbb{E}_{\mu}[%
((f-\mathcal{T}^{\pi}f)(s,a))^{2}].
\pi
\beta\geq 0
\displaystyle\begin{split}&\hat{\pi}^{*}\in\text{arg\,max}_{\pi\in\Pi}\mathbb{%
E}_{\mu}[f^{\pi}(s,\pi)-f^{\pi}(s,a)],\\
&f^{\pi}\in\text{arg\,min}_{f\in\mathcal{F}}\mathbb{E}_{\mu}[f(s,\pi)-f(s,a)]+%
\beta\mathbb{E}_{\mu}[((f-\mathcal{T}^{\pi}f)(s,a))^{2}].\end{split}
\displaystyle\begin{split}&\hat{\pi}^{*}\in\text{arg\,max}_{\pi\in\Pi}\mathbb{%
E}_{\mu}[f^{\pi}(s,\pi)-f^{\pi}(s,a)],\\
&f^{\pi}\in\text{arg\,min}_{f\in\mathcal{F}}\mathbb{E}_{\mu}[f(s,\pi)-f(s,a)]+%
\beta\mathbb{E}_{\mu}[((f-\mathcal{T}^{\pi}f)(s,a))^{2}].\end{split}
w(s,a)
\displaystyle\hat{\pi}^{\star}\in\arg\max_{\pi\in\Pi}\mathcal{L}_{\mu}(\pi,f^{%
\pi}),\ \ \ \ \ \text{s.t.}\ \ f^{\pi}\in\arg\min_{f\in\mathcal{F}}\mathcal{L}%
_{\mu}(\pi,f)+\beta\mathcal{E}_{\mu}(\pi,f),
\displaystyle\hat{\pi}^{\star}\in\arg\max_{\pi\in\Pi}\mathcal{L}_{\mu}(\pi,f^{%
\pi}),\ \ \ \ \ \text{s.t.}\ \ f^{\pi}\in\arg\min_{f\in\mathcal{F}}\mathcal{L}%
_{\mu}(\pi,f)+\beta\mathcal{E}_{\mu}(\pi,f),
\displaystyle\mathcal{L}_{\mu}(\pi,f)=\mathbb{E}_{\mu}[f(s,\pi)-f(s,a)],
\displaystyle\mathcal{L}_{\mu}(\pi,f)=\mathbb{E}_{\mu}[f(s,\pi)-f(s,a)],
\displaystyle\mathcal{E}_{\mu}(\pi,f)=\max_{w\in\mathcal{W}}|\mathbb{E}_{\mu}[%
w(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|.
\displaystyle\mathcal{E}_{\mu}(\pi,f)=\max_{w\in\mathcal{W}}|\mathbb{E}_{\mu}[%
w(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|.
w
\mu\cdot w
w\in\mathcal{W}
\mathbb{E}_{\mathcal{D}}\left[(f(s,a)-r-\gamma f(s^{\prime},\pi))^{2}\right]-%
\min_{g\in\mathcal{F}}\mathbb{E}_{\mathcal{D}}\left[(g(s,a)-r-\gamma f(s^{%
\prime},\pi))^{2}\right]
1/\sqrt{N}
1/\sqrt{N}
\mu
\displaystyle\hat{\pi}\in\arg\max_{\pi\in\Pi}\mathcal{L}_{\mathcal{D}}(\pi,f^{%
\pi}),\ \ \ \ \ \text{s.t.}\ \ f^{\pi}\in\arg\min_{f\in\mathcal{F}}\mathcal{L}%
_{\mathcal{D}}(\pi,f)+\beta\mathcal{E}_{\mathcal{D}}(\pi,f),
\displaystyle\hat{\pi}\in\arg\max_{\pi\in\Pi}\mathcal{L}_{\mathcal{D}}(\pi,f^{%
\pi}),\ \ \ \ \ \text{s.t.}\ \ f^{\pi}\in\arg\min_{f\in\mathcal{F}}\mathcal{L}%
_{\mathcal{D}}(\pi,f)+\beta\mathcal{E}_{\mathcal{D}}(\pi,f),
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi,f)=\mathbb{E}_{\mathcal{D}}[f(s,\pi%
)-f(s,a)],
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi,f)=\mathbb{E}_{\mathcal{D}}[f(s,\pi%
)-f(s,a)],
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f)=\max_{w\in\mathcal{W}}\left|%
\mathbb{E}_{\mathcal{D}}[w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))]\right|.
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f)=\max_{w\in\mathcal{W}}\left|%
\mathbb{E}_{\mathcal{D}}[w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))]\right|.
\mathcal{D}=\{(s_{i},a_{i},r_{i},s^{\prime}_{i})\}_{i=1}^{N}
\mathcal{F}
\mathcal{W}
\pi_{1}:
\beta
k=1,2,\ldots,K
f_{k}\leftarrow\arg\min_{f\in\mathcal{F}}\mathcal{L}_{\mathcal{D}}(\pi_{k},f)+%
\beta\mathcal{E}_{\mathcal{D}}(\pi_{k},f)
\mathcal{L}_{\mathcal{D}}
\mathcal{E}_{\mathcal{D}}
\pi_{k+1}\leftarrow\textsf{PO}(\pi_{k},f_{k},\mathcal{D})
\bar{\pi}=\textsf{Unif}\left(\left\{\pi_{k}\right\}_{k=1}^{K}\right)
k
\pi_{k}
\pi_{k+1}
f_{1},f_{2},\ldots,f_{K}\in\mathcal{F}
f_{k}:\mathcal{S}\times\mathcal{A}\to[0,V_{\max}],\forall k\in[K]
\pi_{1},\pi_{2},\ldots,\pi_{K}
\pi\in\Pi
\epsilon^{\pi}_{\text{opt}}\triangleq\frac{1}{K}\sum_{k=1}^{K}\mathbb{E}_{\pi}%
[f_{k}(s,\pi)-f_{k}(s,\pi_{k})]=o(1).
\pi_{k+1}(a|s)\propto\pi_{k}(a|s)\exp(\eta f_{k}(s,a))
\eta=\sqrt{\frac{\log|\mathcal{A}|}{2V_{\max}^{2}K}}
\pi
\min_{f\in\mathcal{F}}\max_{w\in\mathcal{W}}
\min_{f\in\mathcal{F}}\max_{g\in\mathcal{F}}
\mathcal{W}
\mathcal{F}
\mathcal{F}
\mathcal{W}
\mathcal{F}
\mathcal{F}\times\mathcal{W}
\mathcal{F}\times\mathcal{F}
N
\pi\in\Pi
1-\delta
\displaystyle J(\pi)-J(\bar{\pi})\leq O\left(\epsilon_{\text{stat}}+C^{\star}_%
{\ell_{2}}\sqrt{\epsilon_{\mathcal{F}}}\right)+\epsilon^{\pi}_{\text{opt}},
\displaystyle J(\pi)-J(\bar{\pi})\leq O\left(\epsilon_{\text{stat}}+C^{\star}_%
{\ell_{2}}\sqrt{\epsilon_{\mathcal{F}}}\right)+\epsilon^{\pi}_{\text{opt}},
\epsilon_{\text{stat}}\asymp V_{\max}C^{\star}_{\ell_{2}}\sqrt{\frac{\log(|%
\mathcal{F}||\Pi||\mathcal{W}|/\delta)}{N}}+\frac{V_{\max}B_{w}\log(|\mathcal{%
F}||\Pi||\mathcal{W}|/\delta)}{N},
\bar{\pi}
\beta=2
\epsilon_{\mathcal{F}}=0
\pi=\pi^{\star}
\bar{\pi}
O(1/\sqrt{N})
N
K
O(1/N^{1/3})
O(1/\sqrt{N})
\ell_{2}
\pi\in\Pi
w^{\pi}=d^{\pi}/\mu
\mathcal{W}
w^{\mu}=d^{\mu}/\mu=\mu/\mu\equiv 1
\mathcal{W}
\mathcal{F}
\mathcal{F}
f\in\mathcal{F}
\pi\in\Pi
\mathcal{T}^{\pi}f\in\mathcal{F}
\mathbb{E}_{\mathcal{D}}\left[(f(s,a)-r-\gamma f(s^{\prime},\pi))^{2}\right]-%
\min_{g\in\mathcal{F}}\mathbb{E}_{\mathcal{D}}\left[(g(s,a)-r-\gamma f(s^{%
\prime},\pi))^{2}\right]
\ell_{2}
\min_{g\in\mathcal{F}}\mathbb{E}_{\mathcal{D}}\left[(g(s,a)-r-\gamma f(s^{%
\prime},\pi))^{2}\right]
\beta
\beta=o(\sqrt{N})
1-\delta
\displaystyle J(\mu)-J(\bar{\pi})\lesssim(\beta+1)(\epsilon_{\text{stat}}+C_{%
\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}}})+\epsilon^{\pi}_{\text{opt}},
\displaystyle J(\mu)-J(\bar{\pi})\lesssim(\beta+1)(\epsilon_{\text{stat}}+C_{%
\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}}})+\epsilon^{\pi}_{\text{opt}},
\epsilon_{\text{stat}}\asymp V_{\max}C^{\star}_{\ell_{2}}\sqrt{\frac{\log(|%
\mathcal{F}||\Pi||\mathcal{W}|/\delta)}{N}}+\frac{V_{\max}B_{w}\log(|\mathcal{%
F}||\Pi||\mathcal{W}|/\delta)}{N},
\bar{\pi}
\beta\geq 0
l_{2}
O(1/N^{1/3})
\ell_{2}
\|f-\mathcal{T}^{\pi}f\|_{2,\mu}
\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)(s,a)]
\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)(s,a)]
\|f-\mathcal{T}^{\pi}f\|_{2,\mu}
\beta=\Theta(N^{2/3})
\displaystyle\mathcal{E}_{\mu}(\pi,f)=\|f-\mathcal{T}^{\pi}f\|_{2,\mu}^{2}%
\quad\text{ and }\quad\mathcal{E}_{\mathcal{D}}(\pi,f)=\mathcal{L}(f,f,\pi,%
\mathcal{D})-\min_{g\in\mathcal{F}}\mathcal{L}(g,f,\pi,\mathcal{D}),
\displaystyle\mathcal{E}_{\mu}(\pi,f)=\|f-\mathcal{T}^{\pi}f\|_{2,\mu}^{2}%
\quad\text{ and }\quad\mathcal{E}_{\mathcal{D}}(\pi,f)=\mathcal{L}(f,f,\pi,%
\mathcal{D})-\min_{g\in\mathcal{F}}\mathcal{L}(g,f,\pi,\mathcal{D}),
\mathcal{L}(g,f,\pi,\mathcal{D})=\mathbb{E}_{\mathcal{D}}[(g(s,a)-r-\gamma f(s%
^{\prime},\pi))^{2}]
Q^{\pi}\in\mathcal{F}
\pi\in\Pi
\mathcal{T}^{\pi}f\in\mathcal{F}
\pi\in\Pi
f\in\mathcal{F}
\beta=\Theta(N^{2/3})
\Omega(1/N^{1/3})
\pi,\hat{\pi}\in\Pi
f:\mathcal{S}\times\mathcal{A}\to{\mathbb{R}}
J(\pi)-J(\hat{\pi})
\displaystyle\mathbb{E}_{\mu}[(f-\mathcal{T}^{\hat{\pi}}f)(s,a)]+\mathbb{E}_{%
\pi}[(\mathcal{T}^{\hat{\pi}}f-f)(s,a)]+\mathbb{E}_{\pi}[f(s,\pi)-f(s,\hat{\pi%
})]+\mathcal{L}_{\mu}(\hat{\pi},f)-\mathcal{L}_{\mu}(\hat{\pi},Q^{\hat{\pi}}).
\displaystyle\mathbb{E}_{\mu}[(f-\mathcal{T}^{\hat{\pi}}f)(s,a)]+\mathbb{E}_{%
\pi}[(\mathcal{T}^{\hat{\pi}}f-f)(s,a)]+\mathbb{E}_{\pi}[f(s,\pi)-f(s,\hat{\pi%
})]+\mathcal{L}_{\mu}(\hat{\pi},f)-\mathcal{L}_{\mu}(\hat{\pi},Q^{\hat{\pi}}).
f
\hat{\pi}
\mu
d^{\pi}
Q^{\pi}
\epsilon_{\mathcal{F}}=0
\bar{\pi}
J(\pi)-J(\bar{\pi})=\frac{1}{K}\sum_{k=1}^{K}(J(\pi)-J(\pi_{k}))
\displaystyle\frac{1}{K}\sum_{k=1}^{K}(\underbrace{\mathbb{E}_{\mu}[(f_{k}-%
\mathcal{T}^{\pi_{k}}f_{k})(s,a)]}_{(a)}+\underbrace{\mathbb{E}_{\pi}[(%
\mathcal{T}^{\pi_{k}}f_{k}-f_{k})(s,a)]}_{(b)}
\displaystyle\frac{1}{K}\sum_{k=1}^{K}(\underbrace{\mathbb{E}_{\mu}[(f_{k}-%
\mathcal{T}^{\pi_{k}}f_{k})(s,a)]}_{(a)}+\underbrace{\mathbb{E}_{\pi}[(%
\mathcal{T}^{\pi_{k}}f_{k}-f_{k})(s,a)]}_{(b)}
\displaystyle+\underbrace{\mathbb{E}_{\pi}[f_{k}(s,\pi)-f_{k}(s,\pi_{k})]}_{(c%
)}+\underbrace{\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{%
\pi_{k}})}_{(d)}).
\displaystyle+\underbrace{\mathbb{E}_{\pi}[f_{k}(s,\pi)-f_{k}(s,\pi_{k})]}_{(c%
)}+\underbrace{\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{%
\pi_{k}})}_{(d)}).
\mathcal{E}_{\mu}(\pi,f)=\mathcal{E}_{\mathcal{D}}(\pi,f)\pm\epsilon_{\text{%
stat}}
\mathcal{L}_{\mu}(\pi,f)=\mathcal{L}_{\mathcal{D}}(\pi,f)\pm\epsilon_{\text{%
stat}}
\pi\in\Pi
f\in\mathcal{F}
d^{\pi}/\mu\in\mathcal{W}
(a)+(b)\leq 2\mathcal{E}_{\mu}(\pi_{k},f_{k})\leq 2\mathcal{E}_{\mathcal{D}}(%
\pi_{k},f_{k})+O(\epsilon_{\text{stat}})
\displaystyle(a)+(b)+(d)\leq\mathcal{L}_{\mu}(\pi_{k},f_{k})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{k})+O(\epsilon_{\text{stat}})-\mathcal{L}_{\mu}(\pi_{k%
},Q^{\pi_{k}})
\displaystyle(a)+(b)+(d)\leq
\displaystyle\mathcal{L}_{\mu}(\pi_{k},f_{k})+2\mathcal{E}_{\mathcal{D}}(\pi_{%
k},f_{k})+O(\epsilon_{\text{stat}})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})
\displaystyle\leq\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{k})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{k})+O(\epsilon_{\text{stat}})-\mathcal{L}_{\mathcal{D}%
}(\pi_{k},Q^{\pi_{k}})
\displaystyle\leq
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{k})+2\mathcal{E}_{\mathcal{D%
}}(\pi_{k},f_{k})+O(\epsilon_{\text{stat}})-\mathcal{L}_{\mathcal{D}}(\pi_{k},%
Q^{\pi_{k}})
\displaystyle\leq\mathcal{L}_{\mathcal{D}}(\pi_{k},Q^{\pi_{k}})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},Q^{\pi_{k}})+O(\epsilon_{\text{stat}})-\mathcal{L}_{%
\mathcal{D}}(\pi_{k},Q^{\pi_{k}})
\displaystyle\leq
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{k},Q^{\pi_{k}})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},Q^{\pi_{k}})+O(\epsilon_{\text{stat}})-\mathcal{L}_{%
\mathcal{D}}(\pi_{k},Q^{\pi_{k}})
\displaystyle\leq O(\epsilon_{\text{stat}})+2\mathcal{E}_{\mu}(\pi_{k},Q^{\pi_%
{k}})=O(\epsilon_{\text{stat}}),
\displaystyle\leq
\displaystyle O(\epsilon_{\text{stat}})+2\mathcal{E}_{\mu}(\pi_{k},Q^{\pi_{k}}%
)=O(\epsilon_{\text{stat}}),
f_{k}
Q^{\pi}
\pi
\displaystyle J(\pi)-J(\bar{\pi})\leq O(\epsilon_{\text{stat}})+\epsilon^{\pi}%
_{\text{opt}}.
\displaystyle J(\pi)-J(\bar{\pi})\leq O(\epsilon_{\text{stat}})+\epsilon^{\pi}%
_{\text{opt}}.
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f)=\max_{w\in\mathcal{W}}\left|%
\mathbb{E}_{\mathcal{D}}[w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))]\right|.
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f)=\max_{w\in\mathcal{W}}\left|%
\mathbb{E}_{\mathcal{D}}[w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))]\right|.
\mathcal{E}_{\mathcal{D}}(\pi,f)
w
\mathcal{W}=[0,C_{\infty}]^{\mathcal{S}\times\mathcal{A}}
\displaystyle\mathcal{E}_{\mathcal{D}}^{\text{app}}(\pi,f)=C_{\infty}\max\{%
\mathbb{E}_{\mathcal{D}}[(f(s,a)-r-\gamma f(s^{\prime},\pi))_{+}],\mathbb{E}_{%
\mathcal{D}}[(r+\gamma f(s^{\prime},\pi)-f(s,a))_{+}]\},
\displaystyle\mathcal{E}_{\mathcal{D}}^{\text{app}}(\pi,f)=C_{\infty}\max\{%
\mathbb{E}_{\mathcal{D}}[(f(s,a)-r-\gamma f(s^{\prime},\pi))_{+}],\mathbb{E}_{%
\mathcal{D}}[(r+\gamma f(s^{\prime},\pi)-f(s,a))_{+}]\},
(\cdot)_{+}=\max\{\cdot,0\}
C_{\infty}
\displaystyle\frac{1}{2}\left(2\mathcal{E}_{\mathcal{D}}^{\text{app}}(\pi,f)+%
\beta\mathbb{E}_{\mathcal{D}}[((f-\mathcal{T}^{\pi}f)(s,a))^{2}]\right)
\displaystyle\frac{1}{2}\left(2\mathcal{E}_{\mathcal{D}}^{\text{app}}(\pi,f)+%
\beta\mathbb{E}_{\mathcal{D}}[((f-\mathcal{T}^{\pi}f)(s,a))^{2}]\right)
\beta\mathbb{E}_{\mathcal{D}}[((f-\mathcal{T}^{\pi}f)(s,a))^{2}]
\beta
C_{\infty}
\{1,2,5,10,20,50,100,200\}
\beta
C_{\infty}
\beta
1/\sqrt{N}
\ell_{2}
\ell_{p}
\ell_{\infty}
\mu(a|s)
\ell_{\infty}
\ell_{\infty}
\ell_{\infty}
\ell_{\infty}
\ell_{2}
\ell_{2}
\ell_{\infty}
\displaystyle(C^{\pi}_{\ell_{2}})^{2}=\|w^{\pi}\|_{2,\mu}^{2}=\mathbb{E}_{\mu}%
[(w^{\pi}(s,a))^{2}]\leq\mathbb{E}_{\mu}\left[C^{\pi}_{\ell_{\infty}}\frac{d^{%
\pi}(s,a)}{\mu(s,a)}\right]=C^{\pi}_{\ell_{\infty}}\mathbb{E}_{\mu}\left[\frac%
{d^{\pi}(s,a)}{\mu(s,a)}\right]=C^{\pi}_{\ell_{\infty}},
\displaystyle(C^{\pi}_{\ell_{2}})^{2}=\|w^{\pi}\|_{2,\mu}^{2}=\mathbb{E}_{\mu}%
[(w^{\pi}(s,a))^{2}]\leq\mathbb{E}_{\mu}\left[C^{\pi}_{\ell_{\infty}}\frac{d^{%
\pi}(s,a)}{\mu(s,a)}\right]=C^{\pi}_{\ell_{\infty}}\mathbb{E}_{\mu}\left[\frac%
{d^{\pi}(s,a)}{\mu(s,a)}\right]=C^{\pi}_{\ell_{\infty}},
\displaystyle C^{\pi}_{\ell_{2}}=\|w^{\pi}\|_{2,\mu}\leq\|w^{\pi}\|_{\infty}=C%
^{\pi}_{\infty}.
\displaystyle C^{\pi}_{\ell_{2}}=\|w^{\pi}\|_{2,\mu}\leq\|w^{\pi}\|_{\infty}=C%
^{\pi}_{\infty}.
\pi
s\in\mathcal{S},a\in\mathcal{A}
f\in\mathcal{F}
(f-\mathcal{T}^{\pi}f)(s,a)
(s,a)
C^{\pi}_{\text{Bellman}}
\displaystyle\max_{f\in\mathcal{F}}\frac{\|f-\mathcal{T}^{\pi}f\|_{2,d^{\pi}}^%
{2}}{\|f-\mathcal{T}^{\pi}f\|_{2,\mu}^{2}}\leq C^{\pi}_{\text{Bellman}}
\displaystyle\max_{f\in\mathcal{F}}\frac{\|f-\mathcal{T}^{\pi}f\|_{2,d^{\pi}}^%
{2}}{\|f-\mathcal{T}^{\pi}f\|_{2,\mu}^{2}}\leq C^{\pi}_{\text{Bellman}}
\displaystyle\Longrightarrow\max_{s,a}\frac{(f-\mathcal{T}^{\pi}f)^{2}(s,a)d^{%
\pi}(s,a)}{(f-\mathcal{T}^{\pi}f)^{2}(s,a)\mu(s,a)}\leq C^{\pi}_{\text{Bellman}}
\displaystyle\Longrightarrow
\displaystyle\max_{s,a}\frac{(f-\mathcal{T}^{\pi}f)^{2}(s,a)d^{\pi}(s,a)}{(f-%
\mathcal{T}^{\pi}f)^{2}(s,a)\mu(s,a)}\leq C^{\pi}_{\text{Bellman}}
\displaystyle\Longrightarrow\max_{s,a}\frac{d^{\pi}(s,a)}{\mu(s,a)}\leq C^{\pi%
}_{\text{Bellman}},
\displaystyle\Longrightarrow
\displaystyle\max_{s,a}\frac{d^{\pi}(s,a)}{\mu(s,a)}\leq C^{\pi}_{\text{%
Bellman}},
\ell_{\infty}
\ell_{2}
\displaystyle\sum_{s,a}\left(\frac{d^{\pi}(s,a)}{\mu(s,a)}\right)^{2}\mu(s,a)=%
\mathbb{E}_{d^{\pi}}\left[\frac{d^{\pi}(s,a)}{\mu(s,a)}\right]\leq(C^{\pi}_{%
\ell_{2}})^{2}.
\displaystyle\sum_{s,a}\left(\frac{d^{\pi}(s,a)}{\mu(s,a)}\right)^{2}\mu(s,a)=%
\mathbb{E}_{d^{\pi}}\left[\frac{d^{\pi}(s,a)}{\mu(s,a)}\right]\leq(C^{\pi}_{%
\ell_{2}})^{2}.
1-\delta
f\in\mathcal{F}
\pi\in\Pi
\displaystyle|\mathcal{E}_{\mu}(\pi,f)-\mathcal{E}_{\mathcal{D}}(\pi,f)|\leq%
\epsilon_{\text{stat}}.
\displaystyle|\mathcal{E}_{\mu}(\pi,f)-\mathcal{E}_{\mathcal{D}}(\pi,f)|\leq%
\epsilon_{\text{stat}}.
f\in\mathcal{F}
\pi\in\Pi
w^{*}_{\pi,f}=\arg\max_{w\in\mathcal{W}}\mathcal{E}_{\mu}(\pi,f)=\arg\max_{w%
\in\mathcal{W}}|\mathbb{E}_{\mu}[w(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|
\hat{w}_{\pi,f}=\arg\max_{w\in\mathcal{W}}\mathcal{E}_{\mathcal{D}}(\pi,f)=%
\arg\max_{w\in\mathcal{W}}\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal%
{D}}w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle\mathcal{E}_{\mu}(\pi,f)-\mathcal{E}_{\mathcal{D}}(\pi,f)
\displaystyle\mathcal{E}_{\mu}(\pi,f)-\mathcal{E}_{\mathcal{D}}(\pi,f)
\displaystyle=|\mathbb{E}_{\mu}[w^{*}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]%
|-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}\hat{w}_{\pi,f}(s,a)%
(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle=
\displaystyle|\mathbb{E}_{\mu}[w^{*}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|%
-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}\hat{w}_{\pi,f}(s,a)(%
f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle=|\mathbb{E}_{\mu}[w^{*}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]%
|-|\mathbb{E}_{\mu}[\hat{w}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|
\displaystyle=
\displaystyle|\mathbb{E}_{\mu}[w^{*}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|%
-|\mathbb{E}_{\mu}[\hat{w}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|
\displaystyle+|\mathbb{E}_{\mu}[\hat{w}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a%
)]|-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}\hat{w}_{\pi,f}(s,%
a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle+|\mathbb{E}_{\mu}[\hat{w}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a%
)]|-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}\hat{w}_{\pi,f}(s,%
a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle\geq 0-\epsilon_{\text{stat}}=-\epsilon_{\text{stat}},
\displaystyle\geq
\displaystyle 0-\epsilon_{\text{stat}}=-\epsilon_{\text{stat}},
w^{*}_{\pi,f}
\displaystyle\mathcal{E}_{\mu}(\pi,f)-\mathcal{E}_{\mathcal{D}}(\pi,f)
\displaystyle\mathcal{E}_{\mu}(\pi,f)-\mathcal{E}_{\mathcal{D}}(\pi,f)
\displaystyle=|\mathbb{E}_{\mu}[w^{*}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]%
|-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}w^{*}_{\pi,f}(s,a)(f%
(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle=
\displaystyle|\mathbb{E}_{\mu}[w^{*}_{\pi,f}(s,a)(f-\mathcal{T}^{\pi}f)(s,a)]|%
-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}w^{*}_{\pi,f}(s,a)(f(%
s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle+\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}w^{*}_{%
\pi,f}(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle+\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}w^{*}_{%
\pi,f}(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}\hat{w}_%
{\pi,f}(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle-\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}\hat{w}_%
{\pi,f}(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle\leq\epsilon_{\text{stat}}+0=\epsilon_{\text{stat}},
\displaystyle\leq
\displaystyle\epsilon_{\text{stat}}+0=\epsilon_{\text{stat}},
\hat{w}_{\pi,f}
f_{\pi}
\pi
f_{\pi}
Q
\pi
Q
1-\delta
\pi\in\Pi
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f_{\pi})\leq C_{\ell_{2}}^{\star}%
\sqrt{\epsilon_{\mathcal{F}}}+\epsilon_{\text{stat}}.
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f_{\pi})\leq C_{\ell_{2}}^{\star}%
\sqrt{\epsilon_{\mathcal{F}}}+\epsilon_{\text{stat}}.
f_{\pi}=\arg\min_{f\in\mathcal{F}}\max_{\text{admissible }\nu}\|f-\mathcal{T}^%
{\pi}f\|_{2,\nu}^{2}
\displaystyle\mathcal{E}_{\mu}(\pi,f_{\pi})=\max_{w\in\mathcal{W}}|\mathbb{E}_%
{\mu}[w(s,a)(f_{\pi}-\mathcal{T}^{\pi}f_{\pi})(s,a)]|
\displaystyle\mathcal{E}_{\mu}(\pi,f_{\pi})=
\displaystyle\max_{w\in\mathcal{W}}|\mathbb{E}_{\mu}[w(s,a)(f_{\pi}-\mathcal{T%
}^{\pi}f_{\pi})(s,a)]|
\displaystyle\leq\max_{w\in\mathcal{W}}\|w\|_{2,\mu}\|f_{\pi}-\mathcal{T}^{\pi%
}f_{\pi}\|_{2,\mu}
\displaystyle\leq
\displaystyle\max_{w\in\mathcal{W}}\|w\|_{2,\mu}\|f_{\pi}-\mathcal{T}^{\pi}f_{%
\pi}\|_{2,\mu}
\displaystyle\leq C^{\star}_{{\ell_{2}}}\sqrt{\epsilon_{\mathcal{F}}},
\displaystyle\leq
\displaystyle C^{\star}_{{\ell_{2}}}\sqrt{\epsilon_{\mathcal{F}}},
f_{\pi}
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f_{\pi})\leq\mathcal{E}_{\mu}(\pi,f%
_{\pi})+\epsilon_{\text{stat}}=C_{\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}%
}}+\epsilon_{\text{stat}}.
\displaystyle\mathcal{E}_{\mathcal{D}}(\pi,f_{\pi})\leq\mathcal{E}_{\mu}(\pi,f%
_{\pi})+\epsilon_{\text{stat}}=C_{\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}%
}}+\epsilon_{\text{stat}}.
1-\delta
f\in\mathcal{F}
\pi\in\Pi
w\in\mathcal{W}
\displaystyle\left|\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]\right|-%
\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}w(s,a)(f(s,a)-r-\gamma
f%
(s^{\prime},\pi))\right|\right|
\displaystyle\left|\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]\right|-%
\left|\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in\mathcal{D}}w(s,a)(f(s,a)-r-\gamma
f%
(s^{\prime},\pi))\right|\right|
\displaystyle\leq O\left(V_{\max}C^{\star}_{\ell_{2}}\sqrt{\frac{\log(|%
\mathcal{F}||\Pi||\mathcal{W}|/\delta)}{N}}+\frac{V_{\max}B_{w}\log(|\mathcal{%
F}||\Pi||\mathcal{W}|/\delta)}{N}\right)\triangleq\epsilon_{\text{stat}}.
\displaystyle\leq
\displaystyle O\left(V_{\max}C^{\star}_{\ell_{2}}\sqrt{\frac{\log(|\mathcal{F}%
||\Pi||\mathcal{W}|/\delta)}{N}}+\frac{V_{\max}B_{w}\log(|\mathcal{F}||\Pi||%
\mathcal{W}|/\delta)}{N}\right)\triangleq\epsilon_{\text{stat}}.
\displaystyle\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]-\frac{1}{N}\sum_{%
(s,a,r,s^{\prime})\in\mathcal{D}}w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
\displaystyle\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]-\frac{1}{N}\sum_{%
(s,a,r,s^{\prime})\in\mathcal{D}}w(s,a)(f(s,a)-r-\gamma f(s^{\prime},\pi))\right|
f\in\mathcal{F}
\pi\in\Pi
w\in\mathcal{W}
\displaystyle\mathbb{E}_{\mu}\left[\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in%
\mathcal{D}}(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right]
\displaystyle\mathbb{E}_{\mu}\left[\frac{1}{N}\sum_{(s,a,r,s^{\prime})\in%
\mathcal{D}}(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right]
\displaystyle=\mathbb{E}_{(s,a)\sim\mu,r\sim r(s,a),s^{\prime}\sim P(\cdot|s,a%
)}\left[(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right]
\displaystyle=
\displaystyle\mathbb{E}_{(s,a)\sim\mu,r\sim r(s,a),s^{\prime}\sim P(\cdot|s,a)%
}\left[(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right]
\displaystyle=\mathbb{E}_{(s,a)\sim\mu}\mathbb{E}_{r\sim r(s,a),s^{\prime}\sim
P%
(\cdot|s,a)}\left[(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)|s,a\right]
\displaystyle=
\displaystyle\mathbb{E}_{(s,a)\sim\mu}\mathbb{E}_{r\sim r(s,a),s^{\prime}\sim P%
(\cdot|s,a)}\left[(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)|s,a\right]
\displaystyle=\mathbb{E}_{(s,a)\sim\mu}[(f(s,a)-\mathcal{T}^{\pi}f(s,a))w(s,a)].
\displaystyle=
\displaystyle\mathbb{E}_{(s,a)\sim\mu}[(f(s,a)-\mathcal{T}^{\pi}f(s,a))w(s,a)].
1-\delta
\displaystyle\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]-\frac{1}{N}\sum_{%
(s,a,r,s^{\prime})\in\mathcal{D}}(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right|
\displaystyle\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]-\frac{1}{N}\sum_{%
(s,a,r,s^{\prime})\in\mathcal{D}}(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right|
\displaystyle\leq O\left(\sqrt{\frac{\mathsf{Var}_{\mu}[(f-\mathcal{T}^{\pi}f)%
w]\log(1/\delta)}{N}}+\frac{V_{\max}B_{w}\log(1/\delta)}{N}\right).
\displaystyle\leq
\displaystyle O\left(\sqrt{\frac{\mathsf{Var}_{\mu}[(f-\mathcal{T}^{\pi}f)w]%
\log(1/\delta)}{N}}+\frac{V_{\max}B_{w}\log(1/\delta)}{N}\right).
\displaystyle\mathsf{Var}_{\mu}[(f-\mathcal{T}^{\pi}f)w]\leq\mathbb{E}_{\mu}[(%
f-\mathcal{T}^{\pi}f)^{2}w^{2}]\leq O(V_{\max}^{2}\|w\|_{2,\mu}^{2})\leq O(V_{%
\max}^{2}(C^{\star}_{\ell_{2}})^{2}),
\displaystyle\mathsf{Var}_{\mu}[(f-\mathcal{T}^{\pi}f)w]\leq\mathbb{E}_{\mu}[(%
f-\mathcal{T}^{\pi}f)^{2}w^{2}]\leq O(V_{\max}^{2}\|w\|_{2,\mu}^{2})\leq O(V_{%
\max}^{2}(C^{\star}_{\ell_{2}})^{2}),
\displaystyle\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]-\frac{1}{N}\sum_{%
(s,a,r,s^{\prime})\in\mathcal{D}}(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right|
\displaystyle\left|\mathbb{E}_{\mu}[(f-\mathcal{T}^{\pi}f)w]-\frac{1}{N}\sum_{%
(s,a,r,s^{\prime})\in\mathcal{D}}(f(s,a)-r-\gamma f(s^{\prime},\pi))w(s,a)\right|
\displaystyle\leq O\left(V_{\max}C^{\star}_{\ell_{2}}\sqrt{\frac{\log(1/\delta%
)}{N}}+\frac{V_{\max}B_{w}\log(1/\delta)}{N}\right),
\displaystyle\leq
\displaystyle O\left(V_{\max}C^{\star}_{\ell_{2}}\sqrt{\frac{\log(1/\delta)}{N%
}}+\frac{V_{\max}B_{w}\log(1/\delta)}{N}\right),
1-\delta
f\in\mathcal{F}
\pi\in\Pi
\displaystyle\left|\mathcal{L}_{\mu}(\pi,f)-\mathcal{L}_{\mathcal{D}}(\pi,f)%
\right|\leq O\left(V_{\max}\sqrt{\frac{\log(|\mathcal{F}||\Pi|/\delta)}{N}}%
\right)\leq\epsilon_{\text{stat}}
\displaystyle\left|\mathcal{L}_{\mu}(\pi,f)-\mathcal{L}_{\mathcal{D}}(\pi,f)%
\right|\leq O\left(V_{\max}\sqrt{\frac{\log(|\mathcal{F}||\Pi|/\delta)}{N}}%
\right)\leq\epsilon_{\text{stat}}
\epsilon_{\text{stat}}
\mathbb{E}_{\mu}[\mathcal{L}_{\mathcal{D}}(\pi,f)]=\mathcal{L}_{\mu}(\pi,f)
|f(s,\pi)-f(s,a)|\leq O(V_{\max})
f
\pi
f\in\mathcal{F}
\pi\in\Pi
1-\delta
\displaystyle\left|\mathcal{L}_{\mu}(\pi,f)-\mathcal{L}_{\mathcal{D}}(\pi,f)%
\right|\leq O\left(V_{\max}\sqrt{\frac{\log(|\mathcal{F}||\Pi|/\delta)}{N}}%
\right).
\displaystyle\left|\mathcal{L}_{\mu}(\pi,f)-\mathcal{L}_{\mathcal{D}}(\pi,f)%
\right|\leq O\left(V_{\max}\sqrt{\frac{\log(|\mathcal{F}||\Pi|/\delta)}{N}}%
\right).
f\in\mathcal{F}
\pi\in\Pi
\bar{\pi}
\displaystyle J(\pi)-J(\bar{\pi})=\frac{1}{K}\sum_{k=1}^{K}(J(\pi)-J(\pi_{k}))
\displaystyle J(\pi)-J(\bar{\pi})=\frac{1}{K}\sum_{k=1}^{K}(J(\pi)-J(\pi_{k}))
\displaystyle=\frac{1}{K}\sum_{k=1}^{K}(\underbrace{\mathbb{E}_{\mu}[(f_{k}-%
\mathcal{T}^{\pi_{k}}f_{k})(s,a)]}_{(a)}+\underbrace{\mathbb{E}_{\pi}[(%
\mathcal{T}^{\pi_{k}}f_{k}-f_{k})(s,a)]}_{(b)}
\displaystyle=
\displaystyle\frac{1}{K}\sum_{k=1}^{K}(\underbrace{\mathbb{E}_{\mu}[(f_{k}-%
\mathcal{T}^{\pi_{k}}f_{k})(s,a)]}_{(a)}+\underbrace{\mathbb{E}_{\pi}[(%
\mathcal{T}^{\pi_{k}}f_{k}-f_{k})(s,a)]}_{(b)}
\displaystyle\qquad\qquad+\underbrace{\mathbb{E}_{\pi}[f_{k}(s,\pi)-f_{k}(s,%
\pi_{k})]}_{(c)}+\underbrace{\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu%
}(\pi_{k},Q^{\pi_{k}})}_{(d)}).
\displaystyle\qquad\qquad+\underbrace{\mathbb{E}_{\pi}[f_{k}(s,\pi)-f_{k}(s,%
\pi_{k})]}_{(c)}+\underbrace{\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu%
}(\pi_{k},Q^{\pi_{k}})}_{(d)}).
\delta
1/2
d^{\pi}/\mu\in\mathcal{W}
(a)+(b)\leq 2\mathcal{E}_{\mu}(\pi_{k},f_{k})\leq 2\mathcal{E}_{\mathcal{D}}(%
\pi_{k},f_{k})+2\epsilon_{\text{stat}}
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})-\mathcal{L}_{\mu}(\pi_{k}%
,f_{\pi_{k}})|\leq\|f_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,\mu}+\|f%
_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,d^{\pi_{k}}}\leq O(\sqrt{%
\epsilon_{\mathcal{F}}}),
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})-\mathcal{L}_{\mu}(\pi_{k}%
,f_{\pi_{k}})|\leq\|f_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,\mu}+\|f%
_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,d^{\pi_{k}}}\leq O(\sqrt{%
\epsilon_{\mathcal{F}}}),
f_{\pi_{k}}\triangleq\arg\min_{f\in\mathcal{F}}\max_{\text{admissible }\nu}\|f%
-\mathcal{T}^{\pi}f\|_{2,\nu}^{2}
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mathcal{D}}(\pi_{%
k},f_{k})|\ +\ |\mathcal{L}_{\mu}(\pi_{k},f_{\pi_{k}})-\mathcal{L}_{\mathcal{D%
}}(\pi_{k},f_{\pi_{k}})|\leq O(\epsilon_{\text{stat}}).
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mathcal{D}}(\pi_{%
k},f_{k})|\ +\ |\mathcal{L}_{\mu}(\pi_{k},f_{\pi_{k}})-\mathcal{L}_{\mathcal{D%
}}(\pi_{k},f_{\pi_{k}})|\leq O(\epsilon_{\text{stat}}).
\displaystyle(a)+(b)+(d)\leq\mathcal{L}_{\mu}(\pi_{k},f_{k})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{k})+2\epsilon_{\text{stat}}-\mathcal{L}_{\mu}(\pi_{k},%
f_{\pi_{k}})+O(\sqrt{\epsilon_{\mathcal{F}}})
\displaystyle(a)+(b)+(d)\leq
\displaystyle\mathcal{L}_{\mu}(\pi_{k},f_{k})+2\mathcal{E}_{\mathcal{D}}(\pi_{%
k},f_{k})+2\epsilon_{\text{stat}}-\mathcal{L}_{\mu}(\pi_{k},f_{\pi_{k}})+O(%
\sqrt{\epsilon_{\mathcal{F}}})
\displaystyle\leq\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{k})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{k})+O(\epsilon_{\text{stat}})-\mathcal{L}_{\mathcal{D}%
}(\pi_{k},f_{\pi_{k}})+O(\sqrt{\epsilon_{\mathcal{F}}})
\displaystyle\leq
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{k})+2\mathcal{E}_{\mathcal{D%
}}(\pi_{k},f_{k})+O(\epsilon_{\text{stat}})-\mathcal{L}_{\mathcal{D}}(\pi_{k},%
f_{\pi_{k}})+O(\sqrt{\epsilon_{\mathcal{F}}})
\displaystyle\leq\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{\pi_{k}})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{\pi_{k}})+O(\epsilon_{\text{stat}})-\mathcal{L}_{%
\mathcal{D}}(\pi_{k},f_{\pi_{k}})+O(\sqrt{\epsilon_{\mathcal{F}}})
\displaystyle\leq
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{\pi_{k}})+2\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{\pi_{k}})+O(\epsilon_{\text{stat}})-\mathcal{L}_{%
\mathcal{D}}(\pi_{k},f_{\pi_{k}})+O(\sqrt{\epsilon_{\mathcal{F}}})
\displaystyle\leq O(\epsilon_{\text{stat}}+C^{\star}_{\ell_{2}}\sqrt{\epsilon_%
{\mathcal{F}}}).
\displaystyle\leq
\displaystyle O(\epsilon_{\text{stat}}+C^{\star}_{\ell_{2}}\sqrt{\epsilon_{%
\mathcal{F}}}).
f_{k}
\displaystyle J(\pi)-J(\bar{\pi})\leq O(\epsilon_{\text{stat}}+C^{\star}_{\ell%
_{2}}\sqrt{\epsilon_{\mathcal{F}}})+\epsilon^{\pi}_{\text{opt}}.
\displaystyle J(\pi)-J(\bar{\pi})\leq O(\epsilon_{\text{stat}}+C^{\star}_{\ell%
_{2}}\sqrt{\epsilon_{\mathcal{F}}})+\epsilon^{\pi}_{\text{opt}}.
\bar{\pi}
\displaystyle J(\mu)-J(\bar{\pi})=\frac{1}{K}\sum_{k=1}^{K}(J(\mu)-J(\pi_{k}))
\displaystyle J(\mu)-J(\bar{\pi})=\frac{1}{K}\sum_{k=1}^{K}(J(\mu)-J(\pi_{k}))
\displaystyle=\frac{1}{K}\sum_{k=1}^{K}(\underbrace{\mathbb{E}_{\mu}[(f_{k}-%
\mathcal{T}^{\pi_{k}}f_{k})(s,a)]}_{(a)}+\underbrace{\mathbb{E}_{\mu}[(%
\mathcal{T}^{\pi_{k}}f_{k}-f_{k})(s,a)]}_{(b)}
\displaystyle=
\displaystyle\frac{1}{K}\sum_{k=1}^{K}(\underbrace{\mathbb{E}_{\mu}[(f_{k}-%
\mathcal{T}^{\pi_{k}}f_{k})(s,a)]}_{(a)}+\underbrace{\mathbb{E}_{\mu}[(%
\mathcal{T}^{\pi_{k}}f_{k}-f_{k})(s,a)]}_{(b)}
\displaystyle\qquad\qquad+\underbrace{\mathbb{E}_{\pi}[f_{k}(s,\mu)-f_{k}(s,%
\pi_{k})]}_{(c)}+\underbrace{\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu%
}(\pi_{k},Q^{\pi_{k}})}_{(d)}).
\displaystyle\qquad\qquad+\underbrace{\mathbb{E}_{\pi}[f_{k}(s,\mu)-f_{k}(s,%
\pi_{k})]}_{(c)}+\underbrace{\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu%
}(\pi_{k},Q^{\pi_{k}})}_{(d)}).
\delta
1/2
(a)+(b)=0
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})-\mathcal{L}_{\mu}(\pi_{k}%
,f_{\pi_{k}})|\leq\|f_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,\mu}+\|f%
_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,d^{\pi_{k}}}\leq O(\sqrt{%
\epsilon_{\mathcal{F}}}),
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})-\mathcal{L}_{\mu}(\pi_{k}%
,f_{\pi_{k}})|\leq\|f_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,\mu}+\|f%
_{\pi_{k}}-\mathcal{T}^{\pi_{k}}f_{\pi_{k}}\|_{2,d^{\pi_{k}}}\leq O(\sqrt{%
\epsilon_{\mathcal{F}}}),
f_{\pi_{k}}\triangleq\arg\min_{f\in\mathcal{F}}\max_{\text{admissible }\nu}\|f%
-\mathcal{T}^{\pi}f\|_{2,\nu}^{2}
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mathcal{D}}(\pi_{%
k},f_{k})|\ +\ |\mathcal{L}_{\mu}(\pi_{k},f_{\pi_{k}})-\mathcal{L}_{\mathcal{D%
}}(\pi_{k},f_{\pi_{k}})|\leq O(\epsilon_{\text{stat}}).
\displaystyle|\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mathcal{D}}(\pi_{%
k},f_{k})|\ +\ |\mathcal{L}_{\mu}(\pi_{k},f_{\pi_{k}})-\mathcal{L}_{\mathcal{D%
}}(\pi_{k},f_{\pi_{k}})|\leq O(\epsilon_{\text{stat}}).
\displaystyle\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi%
_{k}})
\displaystyle\mathcal{L}_{\mu}(\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi%
_{k}})
\displaystyle\leq\mathcal{L}_{\mu}(\pi_{k},f_{k})+\beta\mathcal{E}_{\mathcal{D%
}}(\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})
\displaystyle\leq
\displaystyle\mathcal{L}_{\mu}(\pi_{k},f_{k})+\beta\mathcal{E}_{\mathcal{D}}(%
\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})
\displaystyle(\mathcal{E}_{\mathcal{D}}(\cdot,\cdot)\geq 0)
\displaystyle(\mathcal{E}_{\mathcal{D}}(\cdot,\cdot)\geq 0)
\displaystyle\leq\mathcal{L}_{\mu}(\pi_{k},f_{k})+\beta\mathcal{E}_{\mathcal{D%
}}(\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})-\beta\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{\pi_{k}})
\displaystyle\leq
\displaystyle\mathcal{L}_{\mu}(\pi_{k},f_{k})+\beta\mathcal{E}_{\mathcal{D}}(%
\pi_{k},f_{k})-\mathcal{L}_{\mu}(\pi_{k},Q^{\pi_{k}})-\beta\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{\pi_{k}})
\displaystyle+\beta C_{\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}}}+\beta%
\epsilon_{\text{stat}}
\displaystyle+\beta C_{\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}}}+\beta%
\epsilon_{\text{stat}}
\displaystyle(\text{\lx@cref{creftypecap~refnum}{lem:empirical_bellman_error_o%
f_Q_function}})
\displaystyle(\text{\lx@cref{creftypecap~refnum}{lem:empirical_bellman_error_o%
f_Q_function}})
\displaystyle\lesssim\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{k})+\beta\mathcal{E}%
_{\mathcal{D}}(\pi_{k},f_{k})-\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{\pi_{k}})-%
\beta\mathcal{E}_{\mathcal{D}}(\pi_{k},f_{\pi_{k}})
\displaystyle\lesssim
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{k})+\beta\mathcal{E}_{%
\mathcal{D}}(\pi_{k},f_{k})-\mathcal{L}_{\mathcal{D}}(\pi_{k},f_{\pi_{k}})-%
\beta\mathcal{E}_{\mathcal{D}}(\pi_{k},f_{\pi_{k}})
\displaystyle+(\beta+1)(\epsilon_{\text{stat}}+C_{\ell_{2}}^{\star}\sqrt{%
\epsilon_{\mathcal{F}}})
\displaystyle+(\beta+1)(\epsilon_{\text{stat}}+C_{\ell_{2}}^{\star}\sqrt{%
\epsilon_{\mathcal{F}}})
\displaystyle(\eqref{eq:bounded_L_mu_of_Q_and_f_pi},\eqref{eq:bounded_L_mu_L_D})
\displaystyle(\eqref{eq:bounded_L_mu_of_Q_and_f_pi},\eqref{eq:bounded_L_mu_L_D})
\displaystyle\leq(\beta+1)(\epsilon_{\text{stat}}+C_{\ell_{2}}^{\star}\sqrt{%
\epsilon_{\mathcal{F}}}).
\displaystyle\leq
\displaystyle(\beta+1)(\epsilon_{\text{stat}}+C_{\ell_{2}}^{\star}\sqrt{%
\epsilon_{\mathcal{F}}}).
\displaystyle(\text{Optimality of }f_{k})
\displaystyle(\text{Optimality of }f_{k})
\displaystyle J(\mu)-J(\bar{\pi})\lesssim(\beta+1)(\epsilon_{\text{stat}}+C_{%
\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}}})+\epsilon^{\pi}_{\text{opt}}.
\displaystyle J(\mu)-J(\bar{\pi})\lesssim(\beta+1)(\epsilon_{\text{stat}}+C_{%
\ell_{2}}^{\star}\sqrt{\epsilon_{\mathcal{F}}})+\epsilon^{\pi}_{\text{opt}}.
\text{Bern}(p)
p
\text{Bin}(n,p)
n
p
a_{1},a_{2}
\beta=\tilde{\Theta}(N^{\alpha})
\alpha>\frac{1}{2}
\beta=\Theta(N^{2/3})
\Delta=\min\{\beta/N,1/10\}
r(a_{1})=1/2+\Delta
r(a_{2})=\text{Bern}(1/2)
\Pi=\{\pi_{1},\pi_{2}\}
\pi_{1}(a_{1})=1,\pi_{1}(a_{2})=0
\pi_{2}(a_{1})=0,\pi_{2}(a_{2})=1
\mathcal{F}=\{f_{1},f_{2}\}
f_{1}(a_{1})=1/2+\Delta,f_{1}(a_{2})=1/2
f_{2}(a_{1})=1/2+\Delta
f_{2}(a_{2})=1/2+2\Delta
\mu
\mu(a_{2})=\frac{1}{N\Delta^{2}}
\mu(a_{1})=1-\mu(a_{2})
\pi
f
Q^{\pi}=\mathcal{T}^{\pi}f=r
\displaystyle\hat{\pi}\in\arg\max_{\pi\in\Pi}\mathbb{E}_{\mu}[f^{\pi}(\pi)-f^{%
\pi}(a)],
\displaystyle\hat{\pi}\in\arg\max_{\pi\in\Pi}\mathbb{E}_{\mu}[f^{\pi}(\pi)-f^{%
\pi}(a)],
\displaystyle\text{s.t.}f^{\pi}\in\arg\min_{f\in\mathcal{F}}\mathbb{E}_{\mu}[f%
(\pi)-f(a)]+\beta\mathbb{E}_{\mu}[((f-r)(a))^{2}],
\displaystyle f^{\pi}\in\arg\min_{f\in\mathcal{F}}\mathbb{E}_{\mu}[f(\pi)-f(a)%
]+\beta\mathbb{E}_{\mu}[((f-r)(a))^{2}],
\mathbb{P}_{\mu}(a=a_{1})=\mathbb{P}_{\mathcal{D}}(a=a_{1})
\hat{r}(a_{2})\geq\frac{1}{2}+\frac{2}{\sqrt{N\mu(a_{2})}}=\frac{1}{2}+2\Delta
f^{\pi_{1}}
f^{\pi_{2}}
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{1},f_{1})=\mathbb{E}_{\mu}[f_{1}(%
\pi_{1})-f_{1}(a)]=f_{1}(\pi_{1})-\mu(a_{1})f_{1}(a_{1})-\mu(a_{2})f_{1}(a_{2})
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{1},f_{1})=
\displaystyle\mathbb{E}_{\mu}[f_{1}(\pi_{1})-f_{1}(a)]=f_{1}(\pi_{1})-\mu(a_{1%
})f_{1}(a_{1})-\mu(a_{2})f_{1}(a_{2})
\displaystyle=\mu(a_{2})(f_{1}(a_{1})-f_{1}(a_{2}))=\frac{1}{N\Delta},
\displaystyle=
\displaystyle\mu(a_{2})(f_{1}(a_{1})-f_{1}(a_{2}))=\frac{1}{N\Delta},
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{1},f_{2})=\mathbb{E}_{\mu}[f_{2}(%
\pi_{1})-f_{2}(a)]=f_{2}(\pi_{1})-\mu(a_{1})f_{2}(a_{1})-\mu(a_{2})f_{2}(a_{2})
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{1},f_{2})=
\displaystyle\mathbb{E}_{\mu}[f_{2}(\pi_{1})-f_{2}(a)]=f_{2}(\pi_{1})-\mu(a_{1%
})f_{2}(a_{1})-\mu(a_{2})f_{2}(a_{2})
\displaystyle=\mu(a_{2})(f_{2}(a_{1})-f_{2}(a_{2}))=-\frac{1}{N\Delta},
\displaystyle=
\displaystyle\mu(a_{2})(f_{2}(a_{1})-f_{2}(a_{2}))=-\frac{1}{N\Delta},
\displaystyle\beta\mathcal{E}_{\mathcal{D}}(\pi_{1},f_{1})=\beta\mathbb{E}_{%
\mu}[((f_{1}-r)(a))^{2}]=\beta\mu(a_{2})\left(\frac{1}{2}\right)^{2}=\frac{%
\beta\mu(a_{2})}{4},
\displaystyle\beta\mathcal{E}_{\mathcal{D}}(\pi_{1},f_{1})=
\displaystyle\beta\mathbb{E}_{\mu}[((f_{1}-r)(a))^{2}]=\beta\mu(a_{2})\left(%
\frac{1}{2}\right)^{2}=\frac{\beta\mu(a_{2})}{4},
\displaystyle\beta\mathcal{E}_{\mathcal{D}}(\pi_{1},f_{2})=\beta\mathbb{E}_{%
\mu}[((f_{2}-r)(a))^{2}]
\displaystyle\beta\mathcal{E}_{\mathcal{D}}(\pi_{1},f_{2})=
\displaystyle\beta\mathbb{E}_{\mu}[((f_{2}-r)(a))^{2}]
\displaystyle=\beta\mu(a_{2})\left(\hat{r}(a_{2})\left(\frac{1}{2}-2\Delta%
\right)^{2}+(1-\hat{r}(a_{2}))\left(\frac{1}{2}+2\Delta\right)^{2}\right)
\displaystyle=
\displaystyle\beta\mu(a_{2})\left(\hat{r}(a_{2})\left(\frac{1}{2}-2\Delta%
\right)^{2}+(1-\hat{r}(a_{2}))\left(\frac{1}{2}+2\Delta\right)^{2}\right)
\displaystyle\leq\beta\mu(a_{2})\left(\left(\frac{1}{2}+2\Delta\right)\left(%
\frac{1}{2}-2\Delta\right)^{2}+\left(\frac{1}{2}-2\Delta\right)\left(\frac{1}{%
2}+2\Delta\right)^{2}\right)
\displaystyle\leq
\displaystyle\beta\mu(a_{2})\left(\left(\frac{1}{2}+2\Delta\right)\left(\frac{%
1}{2}-2\Delta\right)^{2}+\left(\frac{1}{2}-2\Delta\right)\left(\frac{1}{2}+2%
\Delta\right)^{2}\right)
\displaystyle\leq\beta\mu(a_{2})\left(\left(\frac{1}{2}\right)^{2}-\left(2%
\Delta\right)^{2}\right)
\displaystyle\leq
\displaystyle\beta\mu(a_{2})\left(\left(\frac{1}{2}\right)^{2}-\left(2\Delta%
\right)^{2}\right)
\displaystyle=\frac{\beta\mu(a_{2})}{4}-4\frac{\beta}{N}.
\displaystyle=
\displaystyle\frac{\beta\mu(a_{2})}{4}-4\frac{\beta}{N}.
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{2},f_{1})=\mathbb{E}_{\mu}[f_{1}(%
\pi_{2})-f_{1}(a)]=f_{1}(\pi_{2})-\mu(a_{1})f_{1}(a_{1})-\mu(a_{2})f_{1}(a_{2})
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{2},f_{1})=
\displaystyle\mathbb{E}_{\mu}[f_{1}(\pi_{2})-f_{1}(a)]=f_{1}(\pi_{2})-\mu(a_{1%
})f_{1}(a_{1})-\mu(a_{2})f_{1}(a_{2})
\displaystyle=\mu(a_{1})(f_{1}(a_{2})-f_{1}(a_{1}))=-\left(1-\frac{1}{N\Delta^%
{2}}\right)\Delta,
\displaystyle=
\displaystyle\mu(a_{1})(f_{1}(a_{2})-f_{1}(a_{1}))=-\left(1-\frac{1}{N\Delta^{%
2}}\right)\Delta,
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{2},f_{2})=\mathbb{E}_{\mu}[f_{2}(%
\pi_{2})-f_{2}(a)]=f_{2}(\pi_{2})-\mu(a_{1})f_{2}(a_{1})-\mu(a_{2})f_{2}(a_{2})
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{2},f_{2})=
\displaystyle\mathbb{E}_{\mu}[f_{2}(\pi_{2})-f_{2}(a)]=f_{2}(\pi_{2})-\mu(a_{1%
})f_{2}(a_{1})-\mu(a_{2})f_{2}(a_{2})
\displaystyle=\mu(a_{1})(f_{2}(a_{2})-f_{2}(a_{1}))=\left(1-\frac{1}{N\Delta^{%
2}}\right)\Delta,
\displaystyle=
\displaystyle\mu(a_{1})(f_{2}(a_{2})-f_{2}(a_{1}))=\left(1-\frac{1}{N\Delta^{2%
}}\right)\Delta,
\displaystyle\beta\mathcal{E}_{\mu}(\pi_{2},f_{1})=\beta\mathcal{E}_{\mathcal{%
D}}(\pi_{1},f_{1})=\frac{\beta\mu(a_{2})}{4},
\displaystyle\beta\mathcal{E}_{\mu}(\pi_{2},f_{1})=\beta\mathcal{E}_{\mathcal{%
D}}(\pi_{1},f_{1})=\frac{\beta\mu(a_{2})}{4},
\displaystyle\beta\mathcal{E}_{\mu}(\pi_{2},f_{2})=\beta\mathcal{E}_{\mathcal{%
D}}(\pi_{1},f_{2})\leq\frac{\beta\mu(a_{2})}{4}-4\frac{\beta}{N}.
\displaystyle\beta\mathcal{E}_{\mu}(\pi_{2},f_{2})=\beta\mathcal{E}_{\mathcal{%
D}}(\pi_{1},f_{2})\leq\frac{\beta\mu(a_{2})}{4}-4\frac{\beta}{N}.
\beta/N\geq\Delta
\mathcal{L}_{\mathcal{D}}(\pi_{2},f_{1})+\beta\mathcal{E}_{\mathcal{D}}(\pi_{2%
},f_{1})>\mathcal{L}_{\mathcal{D}}(\pi_{2},f_{2})+\beta\mathcal{E}_{\mathcal{D%
}}(\pi_{2},f_{2})
f^{\pi_{2}}=f_{2}
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{2},f^{\pi_{2}})=\mathcal{L}_{%
\mathcal{D}}(\pi_{2},f_{2})>\frac{\Delta}{2}\geq\frac{1}{N\Delta}=|\mathcal{L}%
_{\mathcal{D}}(\pi_{1},f^{\pi_{1}})|,
\displaystyle\mathcal{L}_{\mathcal{D}}(\pi_{2},f^{\pi_{2}})=\mathcal{L}_{%
\mathcal{D}}(\pi_{2},f_{2})>\frac{\Delta}{2}\geq\frac{1}{N\Delta}=|\mathcal{L}%
_{\mathcal{D}}(\pi_{1},f^{\pi_{1}})|,
\hat{\pi}^{=}\pi_{2}
J(\pi_{1})-J(\hat{\pi}^{)}=r(\pi_{1})-r(\pi_{2})=\Delta\gg\tilde{\Omega}(1/%
\sqrt{N})
\alpha>1/2
O(1/\sqrt{N})
\beta=\Theta(N^{2/3})
J(\pi_{1})-J(\hat{\pi})=\Delta=\Omega(1/N^{1/3})
X\sim\text{Bin}(n,\frac{1}{2})
\mu=\frac{n}{2}
t\in[0,\frac{1}{8}]
c_{1},c_{2}
\displaystyle\Pr\left(X\geq\mu+nt\right)\geq c_{1}e^{-c_{2}t^{2}n}.
\displaystyle\Pr\left(X\geq\mu+nt\right)\geq c_{1}e^{-c_{2}t^{2}n}.
\beta
C_{\infty}
\beta
C_{\infty}
\beta
C_{\infty}
\{1,2,5,10,20,50,100,200\}
\beta
C_{\infty}
\beta
C_{\infty}
\beta
C_{\infty}
\beta
C_{\infty}
\beta
C_{\infty}
