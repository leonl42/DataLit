\mathcal{D}
\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{D})
\mathcal{V}
\mathcal{E}
\mathcal{D}
e_{ij}\in\mathcal{E}
d_{ij}\in\mathcal{D}
v_{i}
v_{j}
e_{ij}
d_{ij}
{\bm{H}}^{(l)}=[\bm{h}^{(l)}_{1},\bm{h}^{(l)}_{2},...,\bm{h}^{(l)}_{n}]
l
\bm{h}^{(l)}_{i}\in\mathcal{R}^{d}
i
(l+1)
\displaystyle{\rm MHA}({{\bm{H}}}^{(l)})=\mathop{\|}_{t=1}^{k}{\rm head}^{t}({%
{\bm{H}}}^{(l)}_{t})
\displaystyle{\rm head}^{t}({{\bm{H}}}^{(l)}_{t})={\bm{V}}^{(l)}_{t}\cdot{\rm
softmax%
}(\frac{{\bm{K}}^{(l)\top}_{t}{\bm{Q}}^{(l)}_{t}}{\sqrt{d/k}})
\displaystyle{\bm{Q}}^{(l)}_{t}={\bm{W}}^{(l)}_{Q,t}{{\bm{H}}}^{(l)}_{t},\ \ %
\ \ {\bm{K}}^{(l)}_{t}={\bm{W}}^{(l)}_{K,t}{{\bm{H}}}^{(l)}_{t},\ \ \ \ {\bm{V%
}}^{(l)}_{t}={\bm{W}}^{(l)}_{V,t}{{\bm{H}}}^{(l)}_{t},
{\bm{W}}_{Q,t},{\bm{W}}_{K,t},{\bm{W}}_{V,t}
k
\|
{\bm{h}}_{e}
e\in\mathcal{E}
e_{ij}
y\in\mathcal{Y}
d_{ij}
v_{i}
v_{j}
\mathcal{Y}=\{
\}
e_{ij}
v_{i}
v_{j}
d_{ij}
v_{i}
v_{j}
\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{D})
\mathcal{E}_{train}\subseteq\mathcal{E}
e_{ij}\in\mathcal{E}\backslash\mathcal{E}_{train}
y\in\mathcal{Y}
d_{ij}\in\mathcal{D}
v_{i},v_{j}\in\mathcal{V}
{\bm{h}}_{v_{i}}
v_{i}\in\mathcal{V}
v_{i}
v_{j}
d_{ij}
e_{ij}
v_{i}
v_{j}
{\bm{h}}_{v_{i}}
{\bm{h}}_{v_{j}}
\mathcal{G}=(\mathcal{V},\mathcal{E},\mathcal{D})
\mathcal{E}_{train}\subseteq\mathcal{E}
v_{i},v_{j}\in\mathcal{V}
e_{ij}\notin\mathcal{E}_{train}
e_{ij}\in\mathcal{E}
d_{ij}
e_{ij}=(v_{i},v_{j})
d_{ij}
{\bm{H}}^{(l)}_{e_{ij}}\in\mathcal{R}^{d\times n}
d_{ij}
l
l\geq 1
v_{i}
v_{j}
\bm{z}^{(l)}_{v_{i}}
\bm{z}^{(l)}_{v_{j}}\in\mathcal{R}^{d}
\displaystyle\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}=\bm{\bm{z}}^{(l)}_{v_{i}}%
\mathop{\|}\bm{z}^{(l)}_{v_{j}}\mathop{\|}{\bm{H}}^{(l)}_{e_{ij}}.
\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}
e_{ij}
d_{ij}
v_{i}
v_{j}
\displaystyle{\rm MHA}({\bm{H}}^{(l)}_{e_{ij}},\widetilde{{\bm{H}}}^{(l)}_{e_{%
ij}})=\mathop{\|}_{t=1}^{k}{\rm head}^{t}({\bm{H}}^{(l)}_{e_{ij},t},\widetilde%
{{\bm{H}}}^{(l)}_{e_{ij},t}),
\displaystyle{\bm{Q}}^{(l)}_{t}={\bm{W}}^{(l)}_{Q,t}{\bm{H}}^{(l)}_{e_{ij},t},%
\ \ \ \ {\bm{K}}^{(l)}_{t}={\bm{W}}^{(l)}_{K,t}\widetilde{{\bm{H}}}^{(l)}_{e_{%
ij},t},\ \ \ \ {\bm{V}}^{(l)}_{t}={\bm{W}}^{(l)}_{V,t}\widetilde{{\bm{H}}}^{(l%
)}_{e_{ij},t}.
{\bm{K}}
{\bm{V}}
{\bm{Q}}
(l+1)
\displaystyle{\bm{H}}^{(l)^{\prime}}_{e_{ij}}={\rm Normalize}({\bm{H}}^{(l)}_{%
e_{ij}}+{\rm MHA}({\bm{H}}^{(l)}_{e_{ij}},\widetilde{{\bm{H}}}^{(l)}_{e_{ij}})),
\displaystyle{\bm{H}}^{(l+1)}_{e_{ij}}={\rm Normalize}({\bm{H}}^{(l)^{\prime}}%
_{e_{ij}}+{\rm FFN}({\bm{H}}^{(l)^{\prime}}_{e_{ij}})),
{\rm Normalize}(\cdot)
L
e_{ij}
{{\bm{h}}}_{e_{ij}}={\bm{H}}^{(L)}_{e_{ij}}[{\rm CLS}]
{\bm{z}}^{(l)}_{v_{i}}
\bm{z}^{(0)}_{v_{i}}
\displaystyle{\bm{z}}^{(l)}_{v_{i}}={\bm{W}}^{(l)}_{n}{\bm{z}}^{(0)}_{v_{i}},
{\bm{W}}^{(l)}_{n}\in\mathcal{R}^{d\times d^{\prime}}
l
{\bm{z}}^{(0)}_{v_{i}}\in\mathbb{R}^{64}
{\bm{z}}^{(l)}_{v_{i}}\in\mathbb{R}^{768}
{\bm{z}}^{(l)}_{v_{i}}
v_{i}
{{\bm{h}}}_{v_{i}}
\displaystyle{{\bm{h}}}_{v_{i}}={\rm AGG}(\{{{\bm{h}}}_{e_{ij}}|e_{ij}\in%
\mathcal{N}_{e}(v_{i})\}),
\mathcal{N}_{e}(v_{i})
v_{i}
{\rm AGG}(\cdot)
\rm mean(\cdot)
\rm max(\cdot)
{\rm AGG}(\cdot)
\displaystyle\alpha_{e_{ij},v_{i}}={\rm softmax}({{\bm{h}}}^{\top}_{e_{ij}}{%
\bm{W}}_{s}{\bm{z}}^{(0)}_{v_{i}}),\ \ \ \ {{\bm{h}}}_{v_{i}}=\sum_{e_{ij}\in%
\mathcal{N}_{e}(v_{i})}\alpha_{e_{ij},v_{i}}{{\bm{h}}}_{e_{ij}},
{\bm{W}}_{s}\in\mathcal{R}^{d\times d^{\prime}}
\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}
\displaystyle\widetilde{{\bm{H}}}^{(l)}_{e_{ij}|v_{i}}=\bm{z}^{(l)}_{v_{i}}%
\mathop{\|}\bm{z}^{(l)}_{v_{j}}\mathop{\|}\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}%
\mathop{\|}{\bm{H}}^{(l)}_{e_{ij}},
\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}
e_{ij}
v_{i}
\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}
\mathcal{N}_{e}(v_{i})
\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}
e_{is}\in\mathcal{N}_{e}(v_{i})
e_{ij}
l
{\bm{h}}^{(l)}_{e_{is}}={\bm{H}}^{(l)}_{e_{is}}[{\rm CLS}]
\bar{{\bm{h}}}^{(l)}_{e_{is}|v_{i}}
\mathcal{N}_{e}(v_{i})
\displaystyle\left[...,\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}},...,\bar{{\bm{h}}}^%
{(l)}_{e_{is}|v_{i}},...\right]={\rm MHA}\left(\left[...,{{\bm{h}}}^{(l)}_{e_{%
ij}},...,{{\bm{h}}}^{(l)}_{e_{is},...}\right]\right).
\left[...,{{\bm{h}}}^{(l)}_{e_{ij}},...,{{\bm{h}}}^{(l)}_{e_{is},...}\right]
l
v_{i}
\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}
v_{i}
\mathcal{N}_{e}(v_{i})
\displaystyle\bm{a}^{(l-1)}_{ij}={\rm PROP}^{(l)}\left({\bm{h}}^{(l-1)}_{i},{%
\bm{h}}^{(l-1)}_{j}\right),\big{(}\forall j\in\mathcal{N}(i)\big{)};\ \ {\bm{h%
}}^{(l)}_{i}={\rm AGG}^{(l)}\left({\bm{h}}^{(l-1)}_{i},\{\bm{a}^{(l-1)}_{ij}|j%
\in\mathcal{N}(i)\}\right).
{\rm PROP}^{(l)}
{\rm AGG}^{(l)}
\displaystyle\mathcal{L}_{e}=-\sum_{e_{ij}}\bm{y}_{e_{ij}}^{\top}\text{log}%
\hat{\bm{y}}_{e_{ij}}+(1-\bm{y}_{e_{ij}})^{\top}\text{log}(1-\hat{\bm{y}}_{e_{%
ij}}),
\hat{\bm{y}}_{e_{ij}}=f({{\bm{h}}}_{e_{ij}})
e_{ij}
f(\cdot)
\displaystyle\mathcal{L}_{n}=\sum_{v\in\mathcal{V}}\sum_{u\in\mathcal{N}_{n}(v%
)}-\text{log}\frac{\text{exp}({\bm{h}}^{\top}_{v}{\bm{h}}_{u})}{\text{exp}({%
\bm{h}}^{\top}_{v}{\bm{h}}_{u})+\sum_{u^{\prime}}\text{exp}({\bm{h}}^{\top}_{v%
}{\bm{h}}_{u^{\prime}})}.
\mathcal{N}_{n}(v)
v
u^{\prime}
N
P
\mathcal{O}(P^{2})
\mathcal{O}(NP^{2}+N^{2})
N^{2}\ll NP^{2}
\mathcal{O}(NP^{2})
{\bm{z}}_{i}
L=12,d=768
d^{\prime}
(\epsilon,\beta_{1},\beta_{2})=(\text{1e-8},0.9,0.999)
\Delta
\Delta
\Delta
\{h_{v}|v\in\mathcal{V}\}
\{h_{e}|e\in\mathcal{E}\}
|\mathcal{N}_{e}(v)|
|\mathcal{N}_{e}(v)|
|\mathcal{N}_{e}(v)|
|\mathcal{N}_{e}(v)|
\mathcal{O}(NP^{2}+N^{2})\sim\mathcal{O}(NP^{2})
N\ll P
e_{ij}
d_{ij}
v_{i}
v_{j}
{{\bm{H}}}^{(0)}_{e_{ij}}
d_{ij}
{\bm{h}}_{e_{ij}}
e_{ij}
{{\bm{H}}}^{(0)^{\prime}}_{e_{ij}}\leftarrow{\rm Normalize}({\bm{H}}^{(0)}_{e_%
{ij}}+{\rm MHA}^{(0)}({\bm{H}}^{(0)}_{e_{ij}}))
{\bm{H}}^{(1)}_{e_{ij}}\leftarrow{\rm Normalize}({{\bm{H}}}^{(0)^{\prime}}_{e_%
{ij}}+{\rm FFN}^{(0)}({{\bm{H}}}^{(0)^{\prime}}_{e_{ij}}))
v_{i}
v_{j}
{\bm{z}}^{(0)}_{v_{i}}\leftarrow{\rm Embedding}(v_{i})
{\bm{z}}^{(0)}_{v_{j}}\leftarrow{\rm Embedding}(v_{j})
l=1,...,L
l
{\bm{z}}^{(l)}_{v_{i}}\leftarrow{\bm{W}}^{(l)}_{n}{\bm{z}}^{(0)}_{v_{i}}
{\bm{z}}^{(l)}_{v_{j}}\leftarrow{\bm{W}}^{(l)}_{n}{\bm{z}}^{(0)}_{v_{j}}
(l+1)
\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}=\bm{\bm{z}}^{(l)}_{v_{i}}\mathop{\|}\bm{z}%
^{(l)}_{v_{j}}\mathop{\|}{\bm{H}}^{(l)}_{e_{ij}}
{\bm{H}}^{(l)^{\prime}}_{e_{ij}}\leftarrow{\rm Normalize}({\bm{H}}^{(l)}_{e_{%
ij}}+{\rm MHA}_{asy}^{(l)}({\bm{H}}^{(l)}_{e_{ij}},\widetilde{{\bm{H}}}^{(l)}_%
{e_{ij}}))
{\bm{H}}^{(l+1)}_{e_{ij}}\leftarrow{\rm Normalize}({\bm{H}}^{(l)^{\prime}}_{e_%
{ij}}+{\rm FFN}^{(l)}({\bm{H}}^{(l)^{\prime}}_{e_{ij}}))
{\bm{h}}_{e_{ij}}\leftarrow{\bm{H}}^{(L+1)}_{e_{ij}}[{\rm CLS}]
v_{i}
\mathcal{N}_{e}(v_{i})
\mathcal{N}_{n}(v_{i})
{{\bm{H}}}^{(0)}_{e_{ij}}
d_{ij}
e_{ij}\in\mathcal{N}_{e}(v_{i})
{\bm{h}}_{v_{i}}
v_{i}
e_{ij}\in{N}_{e}(v_{i})
{{\bm{H}}}^{(0)^{\prime}}_{e_{ij}}\leftarrow{\rm Normalize}({\bm{H}}^{(0)}_{e_%
{ij}}+{\rm MHA}^{(0)}({\bm{H}}^{(0)}_{e_{ij}}))
{\bm{H}}^{(1)}_{e_{ij}}\leftarrow{\rm Normalize}({{\bm{H}}}^{(0)^{\prime}}_{e_%
{ij}}+{\rm FFN}^{(0)}({{\bm{H}}}^{(0)^{\prime}}_{e_{ij}}))
u\in{N}_{n}(v_{i})\cup\{v_{i}\}
{\bm{z}}^{(0)}_{u}\leftarrow{\rm Embedding}(u)
l=1,...,L
l
u\in{N}_{n}(v_{i})\cup\{v_{i}\}
{\bm{z}}^{(l)}_{u}\leftarrow{\bm{W}}^{(l)}_{n}{\bm{z}}^{(0)}_{u}
l
e_{ij}\in N_{e}(v_{i})
{\bm{h}}^{(l)}_{e_{ij}}\leftarrow{\bm{H}}^{(l)}_{e_{ij}}[{\rm CLS}]
\left[\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}},...,\bar{{\bm{h}}}^{(l)}_{e_{is}|v_{%
i}}\right]\leftarrow\text{MHA}^{(l)}_{g}\left(\left[{{\bm{h}}}^{(l)}_{e_{ij}},%
...,{{\bm{h}}}^{(l)}_{e_{is}}\right]\right)
(l+1)
e_{ij}\in N_{e}(v_{i})
\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}\leftarrow\bm{\bm{z}}^{(l)}_{i}\mathop{\|}%
\bm{z}^{(l)}_{j}\mathop{\|}\bar{{\bm{h}}}^{(l)}_{e_{ij}|v_{i}}\mathop{\|}{\bm{%
H}}^{(l)}_{e_{ij}}
{\bm{H}}^{(l)^{\prime}}_{e_{ij}}\leftarrow{\rm Normalize}({\bm{H}}^{(l)}_{e_{%
ij}}+{\rm MHA}_{asy}^{(l)}({\bm{H}}^{(l)}_{e_{ij}},\widetilde{{\bm{H}}}^{(l)}_%
{e_{ij}}))
{\bm{H}}^{(l+1)}_{e_{ij}}\leftarrow{\rm Normalize}({\bm{H}}^{(l)^{\prime}}_{e_%
{ij}}+{\rm FFN}^{(l)}({\bm{H}}^{(l)^{\prime}}_{e_{ij}}))
e_{ij}\in N_{e}(v_{i})
{\bm{h}}_{e_{ij}|v_{i}}\leftarrow{\bm{H}}^{(L+1)}_{e_{ij}}[{\rm v_{j}}]
{{\bm{h}}}_{v_{i}}=\text{AGG}(\{{{\bm{h}}}_{e_{ij}|v_{i}}|e_{ij}\in N_{e}(v_{i%
})\})
{\bm{h}}_{v_{i}}
e_{i}j
u
i
i
\Delta
\Delta
\Delta
|N_{e}(v)|
|N_{e}(v)|
|N_{e}(v)|
|N_{e}(v)|
R^{d\times 2}
R^{d\times l}
l
2:l
\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}
l
2:l
\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}
l
2:l
\widetilde{{\bm{H}}}^{(l)}_{e_{ij}}
l
\epsilon
k
