m\in\mathcal{Z}^{+}
m+1
m
m
r\leq m
r=m
s_{x_{i}}
x_{i}
\odot
s_{x_{i}}
x_{i}
Q
s_{x_{i}}
x_{i}
\odot
s_{x_{i}}
x_{i}
Q
k
\mathbb{R}^{k}
\displaystyle\mathcal{L}({f})=-2\cdot\mathrm{\mathbb{E}}_{x,x^{+}}\left[f(x)^{%
\top}f(x^{+})\right]+\mathrm{\mathbb{E}}_{x,x^{-}}\big{[}\left(f(x)^{\top}f(x^%
{-})\right)^{2}\big{]},
\displaystyle\mathcal{L}({f})=-2\cdot\mathrm{\mathbb{E}}_{x,x^{+}}\left[f(x)^{%
\top}f(x^{+})\right]+\mathrm{\mathbb{E}}_{x,x^{-}}\big{[}\left(f(x)^{\top}f(x^%
{-})\right)^{2}\big{]},
(x,x^{+})
(x,x^{-})
f
\mathbb{R}^{k}
h
(x,x^{+})
h
p(x|h)p(x^{+}|h)/p(x)p(x^{+})
(x,x^{+})
h=\bar{x}
x^{+}
x
x^{+}
x
\beta
(X_{1},X_{2})
(x,x+)
x
X_{2}
(x,x^{+})
p(\cdot|x)
x^{+}
x
x_{0}
x_{0},\dots,x_{T},\cdots
x_{t}
p(\cdot|x_{t-1})
\rho_{\lfloor k/2\rfloor}
\alpha
T
x_{0}
x_{T}
x_{0}
x_{1}
x_{0}
x_{T}
x_{0}
x_{1}
\rho_{\lfloor k/2\rfloor}
\overline{\mathcal{X}}
\bar{x}\in\overline{\mathcal{X}}
r
y:\overline{\mathcal{X}}\rightarrow[r]
\mathcal{P}_{\overline{\mathcal{X}}}
\overline{\mathcal{X}}
\overline{\mathcal{X}}
\mathbb{R}^{d}
\overline{\mathcal{X}}
\bar{x}\in\overline{\mathcal{X}}
\mathcal{A}(\cdot|\bar{x})
\bar{x}
\mathcal{A}(\cdot|\bar{x})
\mathcal{X}
\mathcal{A}(\cdot|\bar{x})
\bar{x}\in\overline{\mathcal{X}}
\overline{\mathcal{X}}
\mathcal{X}
N=|\mathcal{X}|
N
f:\mathcal{X}\rightarrow\mathbb{R}^{k}
B\in\mathbb{R}^{k\times r}
g_{f,B}(x)=\operatorname*{arg\,max}_{i\in[r]}(f(x)^{\top}B)_{i}
x
\arg\max
\bar{x}
\displaystyle\bar{g}_{f,B}(\bar{x}):=\operatorname*{arg\,max}_{i\in[r]}\Pr_{x%
\sim\mathcal{A}(\cdot|\bar{x})}\left[g_{f,B}(x)=i\right].
\displaystyle\bar{g}_{f,B}(\bar{x}):=\operatorname*{arg\,max}_{i\in[r]}\Pr_{x%
\sim\mathcal{A}(\cdot|\bar{x})}\left[g_{f,B}(x)=i\right].
\displaystyle\mathcal{E}(f,B):=\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal%
{X}}}}[y(\bar{x})\neq\bar{g}_{f,B}(\bar{x})].
\displaystyle\mathcal{E}(f,B):=\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal%
{X}}}}[y(\bar{x})\neq\bar{g}_{f,B}(\bar{x})].
\displaystyle\mathcal{E}(f):=\min_{B\in\mathbb{R}^{k\times r}}\mathcal{E}(f,B)%
=\min_{B\in\mathbb{R}^{k\times r}}\Pr_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}}}[y(\bar{x})\neq\bar{g}_{f,B}(\bar{x})].
\displaystyle\mathcal{E}(f):=\min_{B\in\mathbb{R}^{k\times r}}\mathcal{E}(f,B)%
=\min_{B\in\mathbb{R}^{k\times r}}\Pr_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}}}[y(\bar{x})\neq\bar{g}_{f,B}(\bar{x})].
G(\mathcal{X},w)
\mathcal{X}
w
x,x^{\prime}\in\mathcal{X}
w_{xx^{\prime}}
x
x^{\prime}
\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}}
\displaystyle w_{xx^{\prime}}:=\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{%
\overline{\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\mathcal{A}(x^{\prime}|%
\bar{x})\right]
\displaystyle w_{xx^{\prime}}:=\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{%
\overline{\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\mathcal{A}(x^{\prime}|%
\bar{x})\right]
\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}=1
x
x^{\prime}
x
x^{\prime}
w_{xx^{\prime}}
x
x^{\prime}
w_{xx^{\prime}}
x
x^{\prime}
x
x^{\prime}
\ell_{2}
\ell_{2}
w_{xx^{\prime}}
x
x^{\prime}
w_{xx^{\prime}}>0
\mathcal{N}(0,\sigma^{2}\cdot I_{d\times d})
\sigma
\sigma\sqrt{d}
\ell_{2}
\epsilon
k
w_{x}=\sum_{x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}
x
x
\displaystyle\overline{A}:={D}^{-1/2}{A}{D}^{-1/2}
\displaystyle\overline{A}:={D}^{-1/2}{A}{D}^{-1/2}
{A}\in\mathbb{R}^{N\times N}
A_{xx^{\prime}}=w_{xx^{\prime}}
{D}\in\mathbb{R}^{N\times N}
{D}_{xx}=w_{x}
A
D
(x,x^{\prime})\in\mathcal{X}\times\mathcal{X}
N
x\in\mathcal{X}
\gamma_{1},\gamma_{2},\cdots,\gamma_{k}
k
\overline{A}
{{v}}_{1},{{v}}_{2},\cdots,{{v}}_{k}
F^{*}=[{{v}}_{1},{{v}}_{2},\cdots,{{v}}_{k}]\in\mathbb{R}^{N\times k}
u_{x}^{*}\in\mathbb{R}^{k}
x
F^{*}
u_{x}^{*}
x
G(\mathcal{X},w)
u_{x}^{*}
k
x
F^{*}
F^{*}
u_{x}^{*}
f(x)
f\in\mathcal{F}
\mathcal{F}
f
F^{*}
f
F
u_{x}
x
F
F
\displaystyle\min_{F\in\mathbb{R}^{N\times k}}\mathcal{L}_{\textup{mf}}({{F}})%
:=\left\lVert\overline{A}-{F}{F}^{\top}\right\rVert_{F}^{2}.
\displaystyle\min_{F\in\mathbb{R}^{N\times k}}\mathcal{L}_{\textup{mf}}({{F}})%
:=\left\lVert\overline{A}-{F}{F}^{\top}\right\rVert_{F}^{2}.
\widehat{F}
\mathcal{L}_{\textup{mf}}({F})
\overline{A}
R\in\mathbb{R}^{k\times k}
\widehat{F}=F^{*}\cdot\textup{diag}([\sqrt{\gamma_{1}},\dots,\sqrt{\gamma_{k}}%
])R
F\in\mathbb{R}^{N\times k}
B\in\mathbb{R}^{k\times r}
D\in\mathbb{R}^{N\times N}
Q\in\mathbb{R}^{k\times k}
\widetilde{F}=D\cdot F\cdot Q
\tilde{B}=Q^{-1}B
\widetilde{F}
B
F
\displaystyle\mathcal{E}(F)=\mathcal{E}(\widetilde{F}).
\displaystyle\mathcal{E}(F)=\mathcal{E}(\widetilde{F}).
\mathcal{E}{(F)}
F
D=\textup{diag}(s)
s_{x}>0
x\in\mathcal{X}
u_{x},\tilde{u}_{x}\in\mathbb{R}^{k}
x
F
\widetilde{F}
g_{u,B}(x)=\operatorname*{arg\,max}_{i\in[r]}(u_{x}^{\top}B)_{i}
x\in\overline{\mathcal{X}}
u_{x}
B
\widetilde{B}=Q^{-1}B
g_{\tilde{u},\widetilde{B}}(x)=\operatorname*{arg\,max}_{i\in[r]}(s_{x}\cdot u%
_{x}^{\top}B)_{i}
s_{x}>0
u_{x}^{\top}B
g_{\tilde{u},\widetilde{B}}(x)=g_{u,B}(x)
x\in\mathcal{X}
\mathcal{L}_{\textup{mf}}({F})
F
u_{x}
F
FF^{\top}
u_{x}^{\top}u_{x^{\prime}}
\mathcal{L}_{\textup{mf}}({F})
N^{2}
u_{x}^{\top}u_{x^{\prime}}
u_{x}
w_{x}^{1/2}f(x)
f
\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}}
x\sim\mathcal{A}(\cdot|\bar{x})
x^{+}\sim\mathcal{A}(\cdot|\bar{x})
(x,x^{+})
\bar{x}^{\prime}\sim\mathcal{P}_{\overline{\mathcal{X}}}
x^{-}\sim\mathcal{A}(\cdot|\bar{x}^{\prime})
\bar{x},x,x^{+}
(x,x^{-})
x
x^{-}
u_{x}
x
F
u_{x}=w_{x}^{1/2}f(x)
f
\mathcal{L}_{\textup{mf}}({F})
f
\displaystyle\mathcal{L}_{\textup{mf}}({F})=\mathcal{L}({f})+\textup{const}
\displaystyle\mathcal{L}_{\textup{mf}}({F})
\displaystyle=\mathcal{L}({f})+\textup{const}
\displaystyle\textup{where }~{}\mathcal{L}({f})\triangleq-2\cdot\mathrm{%
\mathbb{E}}_{x,x^{+}}\big{[}f(x)^{\top}f(x^{+})\big{]}+\mathrm{\mathbb{E}}_{x,%
x^{-}}\left[\left(f(x)^{\top}f(x^{-})\right)^{2}\right]
\displaystyle~{}\mathcal{L}({f})\triangleq-2\cdot\mathrm{\mathbb{E}}_{x,x^{+}}%
\big{[}f(x)^{\top}f(x^{+})\big{]}+\mathrm{\mathbb{E}}_{x,x^{-}}\left[\left(f(x%
)^{\top}f(x^{-})\right)^{2}\right]
\mathcal{L}_{\textup{mf}}({F})
\displaystyle\mathcal{L}_{\textup{mf}}({{F}})=\sum_{x,x^{\prime}\in\mathcal{X}%
}\left(\frac{w_{xx^{\prime}}}{\sqrt{w_{x}w_{x^{\prime}}}}-u_{x}^{\top}u_{x^{%
\prime}}\right)^{2}
\displaystyle\mathcal{L}_{\textup{mf}}({{F}})
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}\left(\frac{w_{xx^{\prime}}}{%
\sqrt{w_{x}w_{x^{\prime}}}}-u_{x}^{\top}u_{x^{\prime}}\right)^{2}
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}\left(\frac{w_{xx^{\prime}}^{2}%
}{w_{x}w_{x^{\prime}}}-2\cdot w_{xx^{\prime}}\cdot f(x)^{\top}f(x^{\prime})+w_%
{x}w_{x^{\prime}}\cdot\left(f(x)^{\top}f(x^{\prime})\right)^{2}\right)
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}\left(\frac{w_{xx^{\prime}}^{2}%
}{w_{x}w_{x^{\prime}}}-2\cdot w_{xx^{\prime}}\cdot f(x)^{\top}f(x^{\prime})+w_%
{x}w_{x^{\prime}}\cdot\left(f(x)^{\top}f(x^{\prime})\right)^{2}\right)
f
w_{xx^{\prime}}
(x,x^{\prime})
w_{x}
x
\displaystyle-f(x)^{\top}f(x^{+})+\log\left(\exp\left(f(x)^{\top}f(x^{+})%
\right)+\sum_{i=1}^{n}\exp\left(f(x)^{\top}f(x_{i})\right)\right)\,.
\displaystyle-f(x)^{\top}f(x^{+})+\log\left(\exp\left(f(x)^{\top}f(x^{+})%
\right)+\sum_{i=1}^{n}\exp\left(f(x)^{\top}f(x_{i})\right)\right)\,.
x
x^{+}
x_{1},\cdots,x_{n}
f(x)^{\top}f(x^{+})
f(x)^{\top}f(x_{i})
G
m
S
G=(\mathcal{X},w)
S\subseteq\mathcal{X}
S
\displaystyle\phi_{G}(S):=\frac{\sum_{x\in S,x^{\prime}\notin S}w_{xx^{\prime}%
}}{\sum_{x\in S}w_{x}}.
\displaystyle\phi_{G}(S):=\frac{\sum_{x\in S,x^{\prime}\notin S}w_{xx^{\prime}%
}}{\sum_{x\in S}w_{x}}.
S
\phi_{G}(S)=1
w_{x}
i\in\mathbb{Z}^{+}
i
i
i
G=(\mathcal{X},w)
i\in[2,|\mathcal{X}|]
i
\displaystyle\rho_{i}:=\min_{S_{1},\cdots,S_{i}}\max\{\phi_{G}(S_{1}),\dots,%
\phi_{G}(S_{i})\}
\displaystyle\rho_{i}:=\min_{S_{1},\cdots,S_{i}}\max\{\phi_{G}(S_{1}),\dots,%
\phi_{G}(S_{i})\}
S_{1},\cdots,S_{i}
\mathcal{X}
\rho_{i}
i
3\leq i\leq|\mathcal{X}|
S_{1},\cdots,S_{i}
\mathcal{X}
S_{i-1}^{\prime}:=S_{i}\cup S_{i-1}
\phi_{G}(S_{i-1}^{\prime})=\frac{\sum_{x\in S_{i-1}^{\prime},x^{\prime}\notin S%
_{i-1}^{\prime}}w_{xx^{\prime}}}{\sum_{x\in S_{i-1}^{\prime}}w_{x}}\leq\frac{%
\sum_{j=i-1}^{i}\sum_{x\in S_{j},x^{\prime}\notin S_{j}}w_{xx^{\prime}}}{\sum_%
{j=i-1}^{i}\sum_{x\in S_{j}}w_{x}}\leq\max\{\phi_{G}(S_{i-1}),\phi_{G}(S_{i})\}
S_{1},\cdots,S_{i-2},S_{i-1}^{\prime}
i-1
\mathcal{X}
\rho_{i-1}\leq\max\{\phi_{G}(S_{1}),\cdots,\phi_{G}(S_{i-2}),\phi_{G}(S_{i-1}^%
{\prime})\}\leq\max\{\phi_{G}(S_{1}),\cdots,\phi_{G}(S_{i})\}=\rho_{i}
r
\rho_{r}\approx 0
r
\mathcal{X}
i>r
\rho_{i}
i=|\mathcal{X}|=N
S_{j}
\rho_{N}=1
\rho_{i}
i
m
\rho_{m+1}\geq\rho
m
\rho
m
m
\rho_{m+1}
\rho_{m}
m+1
m
\rho
\rho_{m+1}
\rho
\rho_{m+1}
\gamma_{i}
i
\overline{A}
\gamma_{1}=1
\gamma_{2m}\leq 1-\Omega(\rho^{2}/\log{m})
\gamma_{1}
\gamma_{2m}
\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}}
y(\bar{x})
x\sim\mathcal{A}(\cdot|\bar{x})
g
y(\bar{x})
x
\alpha
g(x)=y(\bar{x})
1-\alpha
\alpha
O(\alpha)
r
O(\alpha)
\rho
\alpha
\rho
\alpha
\rho
\alpha
\sigma\sqrt{d}
\alpha
\rho^{2}
\alpha
\mathcal{F}
\mathcal{X}
\mathbb{R}^{k}
\mathcal{L}({f})
\mathcal{F}
k\geq 2r
\alpha>0
\mathcal{F}
{f^{*}_{\textup{pop}}}\in\mathcal{F}
\mathcal{L}({f})
\displaystyle\mathcal{E}({f^{*}_{\textup{pop}}})\leq\widetilde{O}\left(\alpha/%
\rho^{2}_{\lfloor k/2\rfloor}\right).
\displaystyle\mathcal{E}({f^{*}_{\textup{pop}}})\leq\widetilde{O}\left(\alpha/%
\rho^{2}_{\lfloor k/2\rfloor}\right).
k>2m
\mathcal{E}({f^{*}_{\textup{pop}}})\leq\widetilde{O}\left(\alpha/\rho^{2}\right)
\widetilde{O}(\cdot)
k
\alpha=0
\alpha
k
\rho_{\lfloor k/2\rfloor}
k
k
\sqrt{\alpha}
\rho_{k}
k>2m
\alpha\ll\rho^{2}\leq\rho^{2}_{m+1}
\alpha/\rho^{2}
k/2
k
\rho
\mu
p
\mathbb{R}^{d}
\displaystyle h_{\mu}:=\inf_{S\subset\mathbb{R}^{d}}\frac{\int_{\partial S}p(x%
)dx}{\min\{\int_{S}p(x)dx,\int_{\mathbb{R}^{d}\backslash S}p(x)dx\}}.
\displaystyle h_{\mu}:=\inf_{S\subset\mathbb{R}^{d}}\frac{\int_{\partial S}p(x%
)dx}{\min\{\int_{S}p(x)dx,\int_{\mathbb{R}^{d}\backslash S}p(x)dx\}}.
S
\mathbb{R}^{d}\backslash S
S
\partial S
\rho
\mathcal{P}_{\overline{\mathcal{X}}}
m
P_{1},\cdots,P_{m}
\mathbb{R}^{d}
\mathcal{N}(0,\sigma^{2}\cdot I_{d\times d})
\displaystyle\lim_{\sigma\rightarrow 0^{+}}\frac{\rho_{m+1}}{\sigma}\gtrsim%
\min_{i\in[m]}h_{P_{i}}
\displaystyle\lim_{\sigma\rightarrow 0^{+}}\frac{\rho_{m+1}}{\sigma}\gtrsim%
\min_{i\in[m]}h_{P_{i}}
\rho_{m+1}
\sigma
P_{i}
\Omega(1)
\mathcal{P}_{\overline{\mathcal{X}}}
\rho\gtrsim\sigma
\kappa>0
\kappa
\mathcal{P}_{\overline{\mathcal{X}}}
r\leq d
P_{1},\cdots,P_{r}
P_{i}
\kappa
\kappa
\frac{1}{\kappa}\left\lVert f(x)-f(y)\right\rVert_{2}\leq\left\lVert x-y\right%
\rVert_{2}\leq\kappa\left\lVert f(x)-f(y)\right\rVert_{2}
Q:\mathbb{R}^{d^{\prime}}\rightarrow\mathbb{R}^{d}
z\in\mathbb{R}^{d^{\prime}}
d^{\prime}\leq d
\displaystyle x\sim P_{i}\iff x=Q(z),z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{%
\prime}}\cdot I_{d^{\prime}\times d^{\prime}}).
\displaystyle x\sim P_{i}\iff x=Q(z),z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{%
\prime}}\cdot I_{d^{\prime}\times d^{\prime}}).
\bar{x}
\bar{x}+\xi
\xi\sim\mathcal{N}(0,\frac{\sigma^{2}}{d}\cdot I_{d\times d})
0<\sigma\lesssim\frac{1}{\sqrt{d}}
\min_{i\neq j}\left\lVert\mu_{i}-\mu_{j}\right\rVert_{2}\gtrsim\frac{\kappa%
\cdot\sqrt{\log d}}{\sqrt{d^{\prime}}}
\bar{y}(x)
i
x
\bar{y}(x):=\arg\max_{i}P_{i}(x)
y(x)=\bar{y}(x)
r^{\prime}\leq r
y(x)\in[r^{\prime}]
\pi(\bar{y}(x))
\pi
[r]
[r^{\prime}]
\Omega(1)
\gtrsim\frac{\kappa\cdot\sqrt{\log d}}{\sqrt{d^{\prime}}}
x
x
r
r^{\prime}
k\geq 2r+2
\alpha\leq\frac{1}{\textup{poly}(d)}
\rho_{\lfloor k/2\rfloor}\gtrsim\frac{\sigma}{\kappa\sqrt{d}}
\mathcal{E}({f^{*}_{\textup{pop}}})\leq\widetilde{O}\left(\frac{\kappa^{2}}{%
\sigma^{2}\cdot\textup{poly}(d)}\right)
\sigma
1/\kappa
d,\sigma,\kappa
r
\bar{y}(x)
r
\{\bar{x}_{1},\bar{x}_{2},\cdots,\bar{x}_{n_{\rm{pre}}}\}
\bar{x}_{i}\sim\mathcal{P}_{\overline{\mathcal{X}}}
\displaystyle\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f}):=-\frac{2}{n}\sum_{i=%
1}^{{n_{\rm{pre}}}}\mathrm{\mathbb{E}}_{{x}\sim\mathcal{A}(\cdot|\bar{x}_{i})%
\atop{x}^{+}\sim\mathcal{A}(\cdot|\bar{x}_{i})}\left[f({x})^{\top}f(x^{+})%
\right]+\frac{1}{{n_{\rm{pre}}}({n_{\rm{pre}}}-1)}\sum_{i\neq j}\mathrm{%
\mathbb{E}}_{{x}\sim\mathcal{A}(\cdot|\bar{x}_{i})\atop{x}^{-}\sim\mathcal{A}(%
\cdot|\bar{x}_{j})}\left[\left(f({x})^{\top}f({x}^{-})\right)^{2}\right].
\displaystyle\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f}):=-\frac{2}{n}\sum_{i=%
1}^{{n_{\rm{pre}}}}\mathrm{\mathbb{E}}_{{x}\sim\mathcal{A}(\cdot|\bar{x}_{i})%
\atop{x}^{+}\sim\mathcal{A}(\cdot|\bar{x}_{i})}\left[f({x})^{\top}f(x^{+})%
\right]+\frac{1}{{n_{\rm{pre}}}({n_{\rm{pre}}}-1)}\sum_{i\neq j}\mathrm{%
\mathbb{E}}_{{x}\sim\mathcal{A}(\cdot|\bar{x}_{i})\atop{x}^{-}\sim\mathcal{A}(%
\cdot|\bar{x}_{j})}\left[\left(f({x})^{\top}f({x}^{-})\right)^{2}\right].
\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})
\mathcal{L}({f})
\mathcal{F}
\mathcal{X}
\mathbb{R}^{k}
\mathcal{F}
n
\widehat{\mathcal{R}}_{n}(\mathcal{F}):=\max_{x_{1},\cdots,x_{n}\in\mathcal{X}%
}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F},i\in[k]}\frac{1}{n}%
\left(\sum_{j=1}^{n}\sigma_{j}f_{i}(x_{j})\right)\right],
\sigma
\{-1,1\}^{n}
f_{i}(z)
i
f(z)
{f^{*}_{\textup{pop}}}\in\mathcal{F}
\mathcal{L}({f})
{\kappa}>0
\left\lVert f(x)\right\rVert_{\infty}\leq{\kappa}
f\in\mathcal{F}
x\in\mathcal{X}
{f^{*}_{\textup{pop}}}\in\mathcal{F}
\mathcal{L}({f})
{n_{\rm{pre}}}
{\hat{f}_{\textup{emp}}}\in\mathcal{F}
\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})
1-\delta
\displaystyle\mathcal{L}({{\hat{f}_{\textup{emp}}}})\leq\mathcal{L}({{f^{*}_{%
\textup{pop}}}})+c_{1}\cdot\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F%
})+c_{2}\cdot\left(\sqrt{\frac{\log 2/\delta}{{n_{\rm{pre}}}}}+{\delta}\right),
\displaystyle\mathcal{L}({{\hat{f}_{\textup{emp}}}})\leq\mathcal{L}({{f^{*}_{%
\textup{pop}}}})+c_{1}\cdot\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F%
})+c_{2}\cdot\left(\sqrt{\frac{\log 2/\delta}{{n_{\rm{pre}}}}}+{\delta}\right),
c_{1}\lesssim k^{2}{\kappa}^{2}+k{\kappa}
c_{2}\lesssim k{\kappa}^{2}+k^{2}{\kappa}^{4}
\widehat{\mathcal{R}}_{n}(\mathcal{F})=\sqrt{{R}/{n}}
R
\mathcal{F}
\mathcal{F}
\kappa
O(1)
\epsilon
O(k^{4}R/\epsilon^{2})
\mathcal{F}
\mathcal{F}
\rho>0
\alpha>0
k\geq\max\{4r+2,2m\}
1-\delta
{\hat{f}_{\textup{emp}}}\in\mathcal{F}
\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})
\displaystyle\mathcal{E}({\hat{f}_{\textup{emp}}})\lesssim\frac{\alpha}{\rho^{%
2}}\cdot\log k+\frac{ck}{\Delta_{\gamma}^{2}}\left(\widehat{\mathcal{R}}_{{n_{%
\rm{pre}}}/2}(\mathcal{F})+\sqrt{\frac{\log 2/\delta}{{n_{\rm{pre}}}}}+{\delta%
}\right),
\displaystyle\mathcal{E}({\hat{f}_{\textup{emp}}})\lesssim\frac{\alpha}{\rho^{%
2}}\cdot\log k+\frac{ck}{\Delta_{\gamma}^{2}}\left(\widehat{\mathcal{R}}_{{n_{%
\rm{pre}}}/2}(\mathcal{F})+\sqrt{\frac{\log 2/\delta}{{n_{\rm{pre}}}}}+{\delta%
}\right),
c\lesssim(k\kappa+k\kappa^{2}+1)^{2}
\Delta_{\gamma}:=\gamma_{\lfloor{3k}/4\rfloor}-\gamma_{k}
\lfloor{3k}/4\rfloor
k
\Delta_{\gamma}
1-\gamma_{k}
\rho^{2}
\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F})=\sqrt{{2R}/{{n_{\rm{pre}%
}}}}
\kappa\leq O(1)
\epsilon
O(m^{6}R/\epsilon^{2}\rho^{4})
\mathcal{F}
(z,y(\bar{x}))
z\in\mathbb{R}^{k}
x\sim\mathcal{A}(\cdot|\bar{x})
y(\bar{x})\in[r]
\bar{x}
B\in\mathbb{R}^{k\times r}
\ell((z,y(\bar{x})),B):=\sum_{i=1}^{r}\min\big{\{}\left(B^{\top}z-\vec{y}(\bar%
{x})\right)_{i}^{2},1\big{\}},
\vec{y}(\bar{x})
y(\bar{x})
r
1
y(\bar{x})
0
{n_{\rm{down}}}
B
\{(\bar{x}_{i},y(\bar{x}_{i}))\}_{i=1}^{n_{\rm{down}}}
\bar{x}_{i}\sim\mathcal{P}_{\overline{\mathcal{X}}}
y(\bar{x}_{i})
{x}_{i}\sim\mathcal{A}(\cdot|\bar{x}_{i})
i\in[{n_{\rm{down}}}]
C_{k}>0
\widehat{B}
\displaystyle\widehat{B}\in\operatorname*{arg\,min}_{\left\lVert B\right\rVert%
_{F}\leq C_{k}}\sum_{i=1}^{n_{\rm{down}}}\ell(({\hat{f}_{\textup{emp}}}(x_{i})%
,y(\bar{x}_{i})),B).
\displaystyle\widehat{B}\in\operatorname*{arg\,min}_{\left\lVert B\right\rVert%
_{F}\leq C_{k}}\sum_{i=1}^{n_{\rm{down}}}\ell(({\hat{f}_{\textup{emp}}}(x_{i})%
,y(\bar{x}_{i})),B).
C_{k}>0
C_{k}\geq\frac{2(k+1)}{\gamma_{k}}
1-\delta
{\hat{f}_{\textup{emp}}}\in\mathcal{F}
\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})
\widehat{B}
\displaystyle\mathcal{E}({\hat{f}_{\textup{emp}}},\widehat{B})\lesssim\frac{%
\alpha}{\rho_{\lfloor k/2\rfloor}^{2}}\cdot\log k+\frac{ck}{\Delta_{\gamma}^{2%
}}\left(\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F})+\sqrt{\frac{\log
2%
/\delta}{{n_{\rm{pre}}}}}+{\delta}\right)+\left(rC_{k}\sqrt{\frac{k}{{n_{\rm{%
down}}}}}+\sqrt{\frac{\log 1/\delta}{{n_{\rm{down}}}}}\right).
\displaystyle\mathcal{E}({\hat{f}_{\textup{emp}}},\widehat{B})\lesssim\frac{%
\alpha}{\rho_{\lfloor k/2\rfloor}^{2}}\cdot\log k+\frac{ck}{\Delta_{\gamma}^{2%
}}\left(\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F})+\sqrt{\frac{\log
2%
/\delta}{{n_{\rm{pre}}}}}+{\delta}\right)+\left(rC_{k}\sqrt{\frac{k}{{n_{\rm{%
down}}}}}+\sqrt{\frac{\log 1/\delta}{{n_{\rm{down}}}}}\right).
\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F})=\sqrt{{2R}/{{n_{\rm{pre}%
}}}}
R
O(\epsilon)
k
\frac{\alpha}{\rho_{\lfloor k/2\rfloor}^{2}}\cdot\log k\leq\epsilon
\textup{poly}(k,\frac{1}{\Delta_{\gamma}},R,\frac{1}{\epsilon})
\textup{poly}(k,r,\frac{1}{\gamma_{k}},\frac{1}{\epsilon})
r<k
\Delta_{\gamma}
1-\gamma_{k}
\rho^{2}
\rho
d
\frac{1}{\Delta_{\gamma}}
\textup{poly}(d)
\gamma_{k}\approx 1
\frac{1}{\gamma_{k}}
{n_{\rm{pre}}}=\textup{poly}(k,d,R,\frac{1}{\epsilon})
{n_{\rm{down}}}=\textup{poly}(r,k,\frac{1}{\epsilon})
R
\mathcal{F}
N
\mathcal{X}
w_{x}
x\in\mathcal{X}
x
x
w_{x}=\frac{1}{N}
x\in\mathcal{X}
g:\mathcal{X}\rightarrow\{0,1\}
g
\alpha
g
{{v}}_{1},{{v}}_{2},\cdots,{{v}}_{k}
k
\overline{A}
u_{x}^{*}
x
x
F^{*}=[{{v}}_{1},{{v}}_{2},\cdots,{{v}}_{k}]\in\mathbb{R}^{N\times k}
F^{*}
F_{\textup{pop}}^{*}\in\mathbb{R}^{N\times k}
F_{\textup{pop}}^{*}=D\cdot F^{*}\cdot R
D
R
F^{*}
{g}
\vec{g}\in\{0,1\}^{N}
g
\vec{g}_{x}=g(x)
b
F^{*}b
b
\displaystyle F^{*}b\approx\vec{g}
\displaystyle F^{*}b\approx\vec{g}
\mathcal{L}\triangleq{I}-\overline{A}
v_{i}
k
\mathcal{L}
\lambda_{i}=1-\gamma_{i}
L
\vec{g}^{\top}L\vec{g}
\vec{g}
\displaystyle\vec{g}^{\top}\mathcal{L}\vec{g}=\frac{1}{2}\cdot\sum_{x,x^{%
\prime}\in\mathcal{X}}\frac{w_{xx^{\prime}}}{\sqrt{w_{x}w_{x^{\prime}}}}\left(%
\vec{g}_{x}-\vec{g}_{x^{\prime}}\right)^{2}
\displaystyle\vec{g}^{\top}\mathcal{L}\vec{g}
\displaystyle=\frac{1}{2}\cdot\sum_{x,x^{\prime}\in\mathcal{X}}\frac{w_{xx^{%
\prime}}}{\sqrt{w_{x}w_{x^{\prime}}}}\left(\vec{g}_{x}-\vec{g}_{x^{\prime}}%
\right)^{2}
(x,x^{+})
w
w_{x}=1/N
\displaystyle\vec{g}^{\top}\mathcal{L}\vec{g}=\frac{N}{2}\cdot\mathrm{\mathbb{%
E}}_{x,x^{+}}[\left(\vec{g}_{x}-\vec{g}_{x^{+}}\right)^{2}],
\displaystyle\vec{g}^{\top}\mathcal{L}\vec{g}
\displaystyle=\frac{N}{2}\cdot\mathrm{\mathbb{E}}_{x,x^{+}}[\left(\vec{g}_{x}-%
\vec{g}_{x^{+}}\right)^{2}],
\mathrm{\mathbb{E}}_{x,x^{+}}[\left(\vec{g}_{x}-\vec{g}_{x^{+}}\right)^{2}]
g
\displaystyle\vec{g}^{\top}\mathcal{L}\vec{g}\leq N\alpha
\displaystyle\vec{g}^{\top}\mathcal{L}\vec{g}\leq N\alpha
\alpha=0
g(x)=g(x^{+})
(x,x^{+})
\vec{g}^{\top}\mathcal{L}\vec{g}=\frac{N}{2}\cdot\mathrm{\mathbb{E}}_{x,x^{+}}%
[\left(\vec{g}_{x}-\vec{g}_{x^{+}}\right)^{2}]=0
\vec{g}
L
\lambda_{k+1}\leq\dots\lambda_{N}
v_{k+1},\dots,v_{N}
\Pi\triangleq\sum_{i=1}^{k}v_{i}v_{i}^{\top}
\Pi_{\perp}\triangleq\sum_{i=k+1}^{N}v_{i}v_{i}^{\top}
k
N-k
\vec{g}
\Pi_{\perp}
\displaystyle N\alpha\geq\vec{g}^{\top}\mathcal{L}\vec{g}=\left(\Pi\vec{g}+\Pi%
_{\perp}\vec{g}\right)^{\top}\mathcal{L}\left(\Pi\vec{g}+\Pi_{\perp}\vec{g}%
\right)\geq\left(\Pi_{\perp}\vec{g}\right)^{\top}\mathcal{L}\left(\Pi_{\perp}%
\vec{g}\right)\geq\lambda_{k+1}\left\lVert\Pi_{\perp}\vec{g}\right\rVert_{2}^{%
2},
\displaystyle N\alpha\geq\vec{g}^{\top}\mathcal{L}\vec{g}=\left(\Pi\vec{g}+\Pi%
_{\perp}\vec{g}\right)^{\top}\mathcal{L}\left(\Pi\vec{g}+\Pi_{\perp}\vec{g}%
\right)\geq\left(\Pi_{\perp}\vec{g}\right)^{\top}\mathcal{L}\left(\Pi_{\perp}%
\vec{g}\right)\geq\lambda_{k+1}\left\lVert\Pi_{\perp}\vec{g}\right\rVert_{2}^{%
2},
\|(\Pi\vec{g})^{\top}L\Pi\vec{g}\|_{2}^{2}
\Pi_{\perp}L\Pi=0
\Pi_{\perp}
\lambda_{k+1}
\Pi\vec{g}
v_{1},\dots,v_{k}
F^{*}
b\in\mathbb{R}^{k}
\Pi\vec{g}=F^{*}b
\displaystyle\|\vec{g}-F^{*}b\|_{2}^{2}=\left\lVert\Pi_{\perp}\vec{g}\right%
\rVert_{2}^{2}\leq\frac{N\alpha}{\lambda_{k+1}}
\displaystyle\|\vec{g}-F^{*}b\|_{2}^{2}=\left\lVert\Pi_{\perp}\vec{g}\right%
\rVert_{2}^{2}\leq\frac{N\alpha}{\lambda_{k+1}}
\lambda_{k+1}\gtrsim\rho_{\lceil k/2\rceil}^{2}
\displaystyle\frac{1}{N}\|\vec{g}-F^{*}b\|_{2}^{2}\leq{\alpha}/{\rho_{\lceil k%
/2\rceil}^{2}}
\displaystyle\frac{1}{N}\|\vec{g}-F^{*}b\|_{2}^{2}\leq{\alpha}/{\rho_{\lceil k%
/2\rceil}^{2}}
F^{*}b
\vec{g}
\mathbbm{1}\left[F^{*}b>1/2\right]
\vec{g}
F^{*}b
f
f
\sqrt{\mu}
\mu>0
384
384
N
f
\{\bar{x}_{i}\}_{i=1}^{N}
i\in\{1,\cdots,N\}
{x}_{i}=\textup{aug}(\bar{x}_{i})
{x}^{\prime}_{i}=\textup{aug}(\bar{x}_{i})
z_{i}=f({x}_{i})
z_{i}^{\prime}=f({x}_{i}^{\prime})
\mathcal{L}=-\frac{2}{N}\sum_{i=1}^{N}z_{i}^{\top}z_{i}^{\prime}+\frac{1}{N(N-%
1)}\sum_{i\neq j}(z_{i}^{\top}z_{j}^{\prime})^{2}
f
\mathcal{L}
f(\cdot)
\mu=1
\mu=3
\mu=10
\mu=10
\mu\in\{1,3,10\}
G=(\mathcal{X},w)
\mathcal{L}={I}-{D}^{-1/2}{A}{D}^{-1/2}
{A}
{A}_{xx^{\prime}}=w_{xx^{\prime}}
{D}
{D}_{xx}=w_{x}
\mathcal{L}=I-\overline{A}
\overline{A}
\lambda_{i}
i
\mathcal{L}
1-\lambda_{i}
i
\overline{A}
\hat{y}:\mathcal{X}\rightarrow[r]
\displaystyle\phi^{\hat{y}}:=\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right].
\displaystyle\phi^{\hat{y}}:=\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right].
\displaystyle\Delta(y,\hat{y}):=\Pr_{x\sim\mathcal{P}_{\overline{\mathcal{X}}}%
,\tilde{x}\sim\mathcal{A}(\cdot|x)}\left(\hat{y}(\tilde{x})\neq y(x)\right).
\displaystyle\Delta(y,\hat{y}):=\Pr_{x\sim\mathcal{P}_{\overline{\mathcal{X}}}%
,\tilde{x}\sim\mathcal{A}(\cdot|x)}\left(\hat{y}(\tilde{x})\neq y(x)\right).
\displaystyle\mathcal{L}({f}):=\mathrm{\mathbb{E}}_{x_{1}\sim\mathcal{P}_{%
\overline{\mathcal{X}}},x_{2}\sim\mathcal{P}_{\overline{\mathcal{X}}},\atop x%
\sim\mathcal{A}(\cdot|x_{1}),x^{+}\sim\mathcal{A}(\cdot|x_{1}),x^{\prime}\sim%
\mathcal{A}(\cdot|x_{2})}\left[-2\cdot f(x)^{\top}f(x^{+})+\left(f(x)^{\top}f(%
x^{\prime})\right)^{2}\right].
\displaystyle\mathcal{L}({f}):=\mathrm{\mathbb{E}}_{x_{1}\sim\mathcal{P}_{%
\overline{\mathcal{X}}},x_{2}\sim\mathcal{P}_{\overline{\mathcal{X}}},\atop x%
\sim\mathcal{A}(\cdot|x_{1}),x^{+}\sim\mathcal{A}(\cdot|x_{1}),x^{\prime}\sim%
\mathcal{A}(\cdot|x_{2})}\left[-2\cdot f(x)^{\top}f(x^{+})+\left(f(x)^{\top}f(%
x^{\prime})\right)^{2}\right].
\mathcal{X}
{f^{*}_{\textup{pop}}}\in\arg\min_{f:\mathcal{X}\rightarrow\mathbb{R}^{k}}%
\mathcal{L}({f})
\mathcal{L}({f})
k\in\mathcal{Z}^{+}
k^{\prime}\geq r
k+1=(1+\zeta)k^{\prime}
\zeta\in(0,1)
k^{\prime}\in\mathcal{Z}^{+}
{B}^{*}\in\mathbb{R}^{r\times k}
c
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B}^%
{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]\leq c\cdot\left(%
\textup{poly}(1/\zeta)\cdot\log(k+1)\cdot\frac{\phi^{\hat{y}}}{\rho_{k^{\prime%
}}^{2}}+\Delta(y,\hat{y})\right),
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B}^%
{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]\leq c\cdot\left(%
\textup{poly}(1/\zeta)\cdot\log(k+1)\cdot\frac{\phi^{\hat{y}}}{\rho_{k^{\prime%
}}^{2}}+\Delta(y,\hat{y})\right),
\vec{{y}}(\bar{x})
{y}(\bar{x})
\rho_{k^{\prime}}
m
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y%
(\bar{x})\right)\leq 2c\cdot\left(\textup{poly}(1/\zeta)\cdot\log(k+1)\cdot%
\frac{\phi^{\hat{y}}}{\rho_{k^{\prime}}^{2}}+\Delta(y,\hat{y})\right).
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y%
(\bar{x})\right)\leq 2c\cdot\left(\textup{poly}(1/\zeta)\cdot\log(k+1)\cdot%
\frac{\phi^{\hat{y}}}{\rho_{k^{\prime}}^{2}}+\Delta(y,\hat{y})\right).
\lambda_{i}
i
B^{*}
\left\lVert{B}^{*}\right\rVert_{F}\leq 1/(1-\lambda_{k})
\lambda_{1},\lambda_{2},\cdots,\lambda_{k},\lambda_{k+1}
k+1
L
\lambda_{k+1}
\mathcal{X}
{f^{*}_{\textup{pop}}}\in\arg\min_{f:\mathcal{X}\rightarrow\mathbb{R}^{k}}
\mathcal{L}({f})
k\in\mathcal{Z}^{+}
\hat{y}:\mathcal{X}\rightarrow[r]
{B}^{*}\in\mathbb{R}^{r\times k}
\left\lVert{B}^{*}\right\rVert_{F}\leq 1/(1-\lambda_{k})
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B}^%
{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]\leq\frac{\phi^{\hat{%
y}}}{\lambda_{k+1}}+4\Delta(y,\hat{y}),
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B}^%
{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]\leq\frac{\phi^{\hat{%
y}}}{\lambda_{k+1}}+4\Delta(y,\hat{y}),
\vec{{y}}(\bar{x})
{y}(\bar{x})
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y%
(\bar{x})\right)\leq\frac{2\phi^{\hat{y}}}{\lambda_{k+1}}+8\Delta(y,\hat{y}).
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y%
(\bar{x})\right)\leq\frac{2\phi^{\hat{y}}}{\lambda_{k+1}}+8\Delta(y,\hat{y}).
\lambda_{k+1}
G=(V,w)
|V|=N
t\in[N]
\zeta>0
(1+\zeta)t\in[N]
S_{1},S_{2},\cdots,S_{t}
V
\displaystyle\phi_{G}(S_{i})\lesssim\textup{poly}({1}/{\zeta})\sqrt{\lambda_{(%
1+\zeta)t}\log t},
\displaystyle\phi_{G}(S_{i})\lesssim\textup{poly}({1}/{\zeta})\sqrt{\lambda_{(%
1+\zeta)t}\log t},
\phi_{G}(\cdot)
G=(\mathcal{X},w)
(1+\zeta)t=k+1
t=k^{\prime}
S_{1},\cdots,S_{k^{\prime}}\subset\mathcal{X}
\phi_{G}(S_{i})\lesssim\textup{poly}(1/\zeta)\sqrt{\lambda_{k+1}\log{(k+1)}}
\forall i\in[k^{\prime}]
\rho_{k^{\prime}}\leq\max_{i\in[k^{\prime}]}\phi_{G}(S_{i})\lesssim\textup{%
poly}(1/\zeta)\sqrt{\lambda_{k+1}\log{(k+1)}}
\frac{1}{\lambda_{k+1}}\lesssim\textup{poly}(1/\zeta)\cdot{log(k+1)}\cdot\frac%
{1}{\rho_{k^{\prime}}^{2}}
\phi^{\hat{y}}
\Delta(y,\hat{y})
G=(\mathcal{X},w)
r
S_{1},S_{2},\cdots,S_{r}
g
\hat{y}
\displaystyle\Delta(y,\hat{y})\leq\alpha
\displaystyle\Delta(y,\hat{y})\leq\alpha
\displaystyle\phi^{\hat{y}}=\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]\leq 2\alpha.
\displaystyle\phi^{\hat{y}}=\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]\leq 2\alpha.
\hat{y}:\mathcal{X}\rightarrow[r]
x\in\mathcal{X}
\hat{y}(x)
x
x\in S_{\hat{y}(x)}
\Delta(y,\hat{y})\leq\alpha
\displaystyle\phi^{\hat{y}}=\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]
\displaystyle\phi^{\hat{y}}=
\displaystyle\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\mathbbm{1}\left[%
\hat{y}(x)\neq\hat{y}(x^{\prime})\right]
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}\mathrm{\mathbb{E}}_{\bar{x}%
\sim\mathcal{P}_{\overline{\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\mathcal{%
A}(x^{\prime}|\bar{x})\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})%
\right]\right]
\displaystyle=
\displaystyle\sum_{x,x^{\prime}\in\mathcal{X}}\mathrm{\mathbb{E}}_{\bar{x}\sim%
\mathcal{P}_{\overline{\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\mathcal{A}(x%
^{\prime}|\bar{x})\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})%
\right]\right]
\displaystyle\leq\sum_{x,x^{\prime}\in\mathcal{X}}\mathrm{\mathbb{E}}_{\bar{x}%
\sim\mathcal{P}_{\overline{\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\mathcal{%
A}(x^{\prime}|\bar{x})\cdot\left(\mathbbm{1}\left[\hat{y}(x)\neq y(\bar{x})%
\right]+\mathbbm{1}\left[\hat{y}(x^{\prime})\neq y(\bar{x})\right]\right)\right]
\displaystyle\leq
\displaystyle\sum_{x,x^{\prime}\in\mathcal{X}}\mathrm{\mathbb{E}}_{\bar{x}\sim%
\mathcal{P}_{\overline{\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\mathcal{A}(x%
^{\prime}|\bar{x})\cdot\left(\mathbbm{1}\left[\hat{y}(x)\neq y(\bar{x})\right]%
+\mathbbm{1}\left[\hat{y}(x^{\prime})\neq y(\bar{x})\right]\right)\right]
\displaystyle=2\cdot\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\cdot\mathbbm{1}\left[\hat{y}(x)\neq
y%
(\bar{x})\right]\right]
\displaystyle=
\displaystyle 2\cdot\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}}}\left[\mathcal{A}(x|\bar{x})\cdot\mathbbm{1}\left[\hat{y}(x)\neq
y%
(\bar{x})\right]\right]
\displaystyle=2\cdot\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},x\sim%
\mathcal{A}(\cdot|\bar{x})}\left(x\notin S_{y(\bar{x})}\right)=2\alpha.
\displaystyle=
\displaystyle 2\cdot\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},x\sim%
\mathcal{A}(\cdot|\bar{x})}\left(x\notin S_{y(\bar{x})}\right)=2\alpha.
\hat{y}(x)\neq\hat{y}(x^{\prime})
\hat{y}(x)\neq y(\bar{x})
\hat{y}(x^{\prime})\neq y(\bar{x})
S_{1},S_{2},\cdots,S_{r}
\mathcal{X}
g
\hat{y}:\mathcal{X}\rightarrow[r]
x\in\mathcal{X}
\hat{y}(x)
x
x\in S_{\hat{y}(x)}
k^{\prime}=\lfloor\frac{k}{2}\rfloor
\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|%
\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y(\bar{x})\right)%
\lesssim\log(k)\cdot\frac{\phi^{\hat{y}}}{\rho_{\lfloor k/2\rfloor}^{2}}+%
\Delta(y,\hat{y}).
\phi^{\hat{y}}\leq 2\alpha
\Delta(y,\hat{y})\leq\alpha
\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|%
\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y(\bar{x})\right)%
\lesssim\frac{\alpha}{\rho_{\lfloor k/2\rfloor}^{2}}\cdot\log(k).
\bar{g}_{{f^{*}_{\textup{pop}}},{B}^{*}}(\bar{x})\neq y(\bar{x})
\bar{x}
y(\bar{x})
\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}}}\left(\bar{g}_{{f^{*}_{%
\textup{pop}}},{B}^{*}}(\bar{x})\neq y(\bar{x})\right)\leq 2\Pr_{\bar{x}\sim%
\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left(g%
_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y(\bar{x})\right)\lesssim\frac{%
\alpha}{\rho_{\lfloor k/2\rfloor}^{2}}\cdot\log(k)
L
\mathcal{L}({f})
\mathcal{L}
\mathcal{X}
\mathcal{L}
G
N=|\mathcal{X}|
{{v}}_{i}
i
\mathcal{L}
\lambda_{i}
R({u}):=\frac{{u}^{\top}\mathcal{L}{u}}{{u}^{\top}{u}}
{u}\in\mathbb{R}^{N}
k\in\mathcal{Z}^{+}
k<N
\lambda_{k+1}>0
{{b}}\in\mathbb{R}^{k}
\left\lVert{b}\right\rVert_{2}\leq\left\lVert{u}\right\rVert_{2}
\displaystyle\left\lVert u-\sum_{i=1}^{k}{{b}}_{i}{{v}}_{i}\right\rVert_{2}^{2%
}\leq\frac{R({u})}{\lambda_{k+1}}\left\lVert{u}\right\rVert_{2}^{2}.
\displaystyle\left\lVert u-\sum_{i=1}^{k}{{b}}_{i}{{v}}_{i}\right\rVert_{2}^{2%
}\leq\frac{R({u})}{\lambda_{k+1}}\left\lVert{u}\right\rVert_{2}^{2}.
{u}
\displaystyle{u}=\sum_{i=1}^{N}\zeta_{i}{{v}}_{i}.
\displaystyle{u}=\sum_{i=1}^{N}\zeta_{i}{{v}}_{i}.
\displaystyle R({u})=\frac{\sum_{i=1}^{N}\lambda_{i}\zeta_{i}^{2}}{\left\lVert%
{u}\right\rVert_{2}^{2}}.
\displaystyle R({u})=\frac{\sum_{i=1}^{N}\lambda_{i}\zeta_{i}^{2}}{\left\lVert%
{u}\right\rVert_{2}^{2}}.
{{b}}\in\mathbb{R}^{k}
{{b}}_{i}=\zeta_{i}
\left\lVert{{b}}\right\rVert_{2}^{2}\leq\left\lVert{u}\right\rVert_{2}^{2}
\displaystyle\left\lVert{u}-\sum_{i=1}^{k}{{b}}_{i}{{v}}_{i}\right\rVert_{2}^{%
2}=\sum_{i=k+1}^{N}\zeta_{i}^{2}\leq\frac{R({u})}{\lambda_{k+1}}\left\lVert{u}%
\right\rVert_{2}^{2},
\displaystyle\left\lVert{u}-\sum_{i=1}^{k}{{b}}_{i}{{v}}_{i}\right\rVert_{2}^{%
2}=\sum_{i=k+1}^{N}\zeta_{i}^{2}\leq\frac{R({u})}{\lambda_{k+1}}\left\lVert{u}%
\right\rVert_{2}^{2},
R({u})
{u}
\hat{y}
\hat{y}
i\in[r]
u_{i}^{\hat{y}}(x):=\sqrt{w_{x}}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]
{u}_{i}^{\hat{y}}
\mathbb{R}^{N}
\displaystyle\phi_{i}^{\hat{y}}:=\frac{\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^%
{\prime}}\cdot\mathbbm{1}\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)%
\text{ or }(\hat{y}(x)\neq i\land\hat{y}(x^{\prime})=i)\right]}{\sum_{x\in%
\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]}.
\displaystyle\phi_{i}^{\hat{y}}:=\frac{\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^%
{\prime}}\cdot\mathbbm{1}\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)%
\text{ or }(\hat{y}(x)\neq i\land\hat{y}(x^{\prime})=i)\right]}{\sum_{x\in%
\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]}.
\displaystyle R(u_{i}^{\hat{y}})=\frac{1}{2}\phi_{i}^{\hat{y}}.
\displaystyle R(u_{i}^{\hat{y}})=\frac{1}{2}\phi_{i}^{\hat{y}}.
f
\mathcal{X}\rightarrow\mathbb{R}
u(x):=\sqrt{w_{x}}\cdot f(x)
{u}\in\mathbb{R}^{N}
u
{A}
{A}_{xx^{\prime}}=w_{xx^{\prime}}
{D}
{D}_{xx}=w_{x}
\displaystyle{u}^{\top}\mathcal{L}{u}=\left\lVert{u}\right\rVert_{2}^{2}-{u}^{%
\top}{D}^{-1/2}{A}{D}^{-1/2}{u}
\displaystyle{u}^{\top}\mathcal{L}{u}
\displaystyle=\left\lVert{u}\right\rVert_{2}^{2}-{u}^{\top}{D}^{-1/2}{A}{D}^{-%
1/2}{u}
\displaystyle=\sum_{x\in\mathcal{X}}w_{x}f(x)^{2}-\sum_{x,x^{\prime}\in%
\mathcal{X}}w_{xx^{\prime}}f(x)f(x^{\prime})
\displaystyle=\sum_{x\in\mathcal{X}}w_{x}f(x)^{2}-\sum_{x,x^{\prime}\in%
\mathcal{X}}w_{xx^{\prime}}f(x)f(x^{\prime})
\displaystyle=\frac{1}{2}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot%
\left(f(x)-f(x^{\prime})\right)^{2}.
\displaystyle=\frac{1}{2}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot%
\left(f(x)-f(x^{\prime})\right)^{2}.
\displaystyle R({u})=\frac{{u}^{\top}\mathcal{L}{u}}{{u}^{\top}{u}}
\displaystyle R({u})
\displaystyle=\frac{{u}^{\top}\mathcal{L}{u}}{{u}^{\top}{u}}
\displaystyle=\frac{1}{2}\cdot\frac{\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{%
\prime}}\cdot\left(f(x)-f(x^{\prime})\right)^{2}}{\sum_{x\in\mathcal{X}}w_{x}%
\cdot f(x)^{2}}.
\displaystyle=\frac{1}{2}\cdot\frac{\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{%
\prime}}\cdot\left(f(x)-f(x^{\prime})\right)^{2}}{\sum_{x\in\mathcal{X}}w_{x}%
\cdot f(x)^{2}}.
f(x)=\mathbbm{1}\left[\hat{y}(x)=i\right]
\mathcal{L}({f})
{f}:\mathcal{X}\rightarrow\mathbb{R}^{k}
{{F}}\in\mathbb{R}^{N\times k}
x
\sqrt{w_{x}}\cdot{f}(x)
{{F}}
\mathcal{L}_{\textup{mf}}({{F}})
f
\mathcal{L}({f})
\displaystyle\mathcal{L}_{\textup{mf}}({{F}})=\left\lVert({I}-\mathcal{L})-{F}%
{F}^{\top}\right\rVert_{F}^{2}
\displaystyle\mathcal{L}_{\textup{mf}}({{F}})
\displaystyle=\left\lVert({I}-\mathcal{L})-{F}{F}^{\top}\right\rVert_{F}^{2}
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}\left(\frac{w_{xx^{\prime}}}{%
\sqrt{w_{x}w_{x^{\prime}}}}-\sqrt{w_{x}w_{x^{\prime}}}f(x)^{\top}f(x^{\prime})%
\right)^{2}
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}\left(\frac{w_{xx^{\prime}}}{%
\sqrt{w_{x}w_{x^{\prime}}}}-\sqrt{w_{x}w_{x^{\prime}}}f(x)^{\top}f(x^{\prime})%
\right)^{2}
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}w_{x}w_{x^{\prime}}\left(f(x)^{%
\top}f(x^{\prime})\right)^{2}-2\sum_{x,x^{\prime}\in\mathcal{X}}{w_{xx^{\prime%
}}}f(x)^{\top}f(x^{\prime})+\left\lVert{I}-\mathcal{L}\right\rVert_{F}^{2}.
\displaystyle=\sum_{x,x^{\prime}\in\mathcal{X}}w_{x}w_{x^{\prime}}\left(f(x)^{%
\top}f(x^{\prime})\right)^{2}-2\sum_{x,x^{\prime}\in\mathcal{X}}{w_{xx^{\prime%
}}}f(x)^{\top}f(x^{\prime})+\left\lVert{I}-\mathcal{L}\right\rVert_{F}^{2}.
\displaystyle\mathcal{L}({f}):=-2\cdot\mathrm{\mathbb{E}}_{x,x^{+}}\left[f(x)^%
{\top}f(x^{+})\right]+\mathrm{\mathbb{E}}_{x,x^{-}}\left[\left(f(x)^{\top}f(x^%
{-})\right)^{2}\right],
\displaystyle\mathcal{L}({f}):=-2\cdot\mathrm{\mathbb{E}}_{x,x^{+}}\left[f(x)^%
{\top}f(x^{+})\right]+\mathrm{\mathbb{E}}_{x,x^{-}}\left[\left(f(x)^{\top}f(x^%
{-})\right)^{2}\right],
(x,x^{+})
(x,x^{-})
\displaystyle\mathcal{L}({f})=-2\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime%
}}\cdot f(x)^{\top}f(x^{\prime})+\sum_{x,x^{\prime}\in\mathcal{X}}w_{x}w_{x^{%
\prime}}\cdot\left(f(x)^{\top}f(x^{\prime})\right)^{2}.
\displaystyle\mathcal{L}({f})
\displaystyle=-2\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot f(x)^{%
\top}f(x^{\prime})+\sum_{x,x^{\prime}\in\mathcal{X}}w_{x}w_{x^{\prime}}\cdot%
\left(f(x)^{\top}f(x^{\prime})\right)^{2}.
{I}-{L}
{L}
\mathcal{L}({f})
\mathcal{L}
f:\mathcal{X}\rightarrow\mathbb{R}^{k}
B\in\mathbb{R}^{k\times k}
g_{f,B}
x\in\mathcal{X}
y\in[k]
\displaystyle\left\lVert\vec{y}-Bf(x)\right\rVert_{2}^{2}\geq\frac{1}{2}\cdot%
\mathbbm{1}\left[y\neq g_{f,B}(x)\right],
\displaystyle\left\lVert\vec{y}-Bf(x)\right\rVert_{2}^{2}\geq\frac{1}{2}\cdot%
\mathbbm{1}\left[y\neq g_{f,B}(x)\right],
\vec{y}
y
y\neq g_{f,B}(x)
g_{f,B}
y^{\prime}\neq y
(Bf(x))_{y^{\prime}}\geq(Bf(x))_{y}
\displaystyle\left\lVert\vec{y}-Bf(x)\right\rVert_{2}^{2}\geq\left(1-(Bf(x))_{%
y}\right)^{2}+(Bf(x))_{y^{\prime}}^{2}
\displaystyle\left\lVert\vec{y}-Bf(x)\right\rVert_{2}^{2}
\displaystyle\geq\left(1-(Bf(x))_{y}\right)^{2}+(Bf(x))_{y^{\prime}}^{2}
\displaystyle\geq\frac{1}{2}\left(1-(Bf(x))_{y}+(Bf(x))_{y^{\prime}}\right)^{2}
\displaystyle\geq\frac{1}{2}\left(1-(Bf(x))_{y}+(Bf(x))_{y^{\prime}}\right)^{2}
\displaystyle\geq\frac{1}{2},
\displaystyle\geq\frac{1}{2},
\ell_{2}
y
y^{\prime}
(Bf(x))_{y^{\prime}}\geq(Bf(x))_{y}
y\neq g_{f,B}(x)
y=g_{f,B}(x)
{F}_{\textup{sc}}=[{{v}}_{1},{{v}}_{2},\cdots,{{v}}_{k}]
k
\mathcal{L}
i\in[r]
u_{i}^{\hat{y}}(x):=\sqrt{w_{x}}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]
{u}_{i}^{\hat{y}}
\mathbb{R}^{N}
{{b}}_{i}\in\mathbb{R}^{k}
\left\lVert{{b}}_{i}\right\rVert_{2}\leq\left\lVert{u}_{i}^{\hat{y}}\right%
\rVert_{2}
\displaystyle\left\lVert{u}_{i}^{\hat{y}}-{F}_{\textup{sc}}{b}_{i}\right\rVert%
_{2}^{2}\leq\frac{R({u}_{i}^{\hat{y}})}{\lambda_{k+1}}\left\lVert{u}_{i}^{\hat%
{y}}\right\rVert_{2}^{2}.
\displaystyle\left\lVert{u}_{i}^{\hat{y}}-{F}_{\textup{sc}}{b}_{i}\right\rVert%
_{2}^{2}
\displaystyle\leq\frac{R({u}_{i}^{\hat{y}})}{\lambda_{k+1}}\left\lVert{u}_{i}^%
{\hat{y}}\right\rVert_{2}^{2}.
\displaystyle R({u}_{i}^{\hat{y}})=\frac{1}{2}\phi_{i}^{\hat{y}}=\frac{1}{2}%
\cdot\frac{\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot\mathbbm{1}%
\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)\text{ or }(\hat{y}(x)\neq i%
\land\hat{y}(x^{\prime})=i)\right]}{\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm{1%
}\left[\hat{y}(x)=i\right]}.
\displaystyle R({u}_{i}^{\hat{y}})=\frac{1}{2}\phi_{i}^{\hat{y}}=\frac{1}{2}%
\cdot\frac{\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot\mathbbm{1}%
\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)\text{ or }(\hat{y}(x)\neq i%
\land\hat{y}(x^{\prime})=i)\right]}{\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm{1%
}\left[\hat{y}(x)=i\right]}.
\displaystyle\left\lVert{u}_{i}^{\hat{y}}-{F}_{\textup{sc}}{{b}}_{i}\right%
\rVert_{2}^{2}\leq\frac{\phi_{i}^{\hat{y}}}{2\lambda_{k+1}}\cdot\sum_{x\in%
\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]
\displaystyle\left\lVert{u}_{i}^{\hat{y}}-{F}_{\textup{sc}}{{b}}_{i}\right%
\rVert_{2}^{2}
\displaystyle\leq\frac{\phi_{i}^{\hat{y}}}{2\lambda_{k+1}}\cdot\sum_{x\in%
\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]
\displaystyle=\frac{1}{2\lambda_{k+1}}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{%
\prime}}\cdot\mathbbm{1}\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)%
\text{ or }(\hat{y}(x)\neq i\land\hat{y}(x^{\prime})=i)\right].
\displaystyle=\frac{1}{2\lambda_{k+1}}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{%
\prime}}\cdot\mathbbm{1}\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)%
\text{ or }(\hat{y}(x)\neq i\land\hat{y}(x^{\prime})=i)\right].
{U}=[{u}_{1}^{\hat{y}},\cdots,{u}_{r}^{\hat{y}}]
{u}_{i}^{\hat{y}}
u:\mathcal{X}\rightarrow\mathbb{R}^{r}
{B}\in\mathbb{R}^{N\times k}
{B}^{\top}=[{{b}}_{1},\cdots,{{b}}_{r}]
i\in[r]
\phi^{\hat{y}}
\displaystyle\left\lVert{U}-{F}_{\textup{sc}}{B}^{\top}\right\rVert_{F}^{2}%
\leq\frac{1}{2\lambda_{k+1}}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]=\frac{\phi^{%
\hat{y}}}{2\lambda_{k+1}},
\displaystyle\left\lVert{U}-{F}_{\textup{sc}}{B}^{\top}\right\rVert_{F}^{2}%
\leq\frac{1}{2\lambda_{k+1}}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}%
\cdot\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]=\frac{\phi^{%
\hat{y}}}{2\lambda_{k+1}},
\displaystyle\left\lVert{B}\right\rVert_{F}^{2}=\sum_{i=1}^{r}\left\lVert{{b}}%
_{i}\right\rVert_{2}^{2}\leq\sum_{i=1}^{r}\left\lVert{u}_{i}^{\hat{y}}\right%
\rVert_{2}^{2}=\sum_{x\in\mathcal{X}}w_{x}=1.
\displaystyle\left\lVert{B}\right\rVert_{F}^{2}=\sum_{i=1}^{r}\left\lVert{{b}}%
_{i}\right\rVert_{2}^{2}\leq\sum_{i=1}^{r}\left\lVert{u}_{i}^{\hat{y}}\right%
\rVert_{2}^{2}=\sum_{x\in\mathcal{X}}w_{x}=1.
{f^{*}_{\textup{pop}}}
\mathcal{L}({f})
{F}^{*}
\sqrt{w_{x}}\cdot{f^{*}_{\textup{pop}}}(x)
x
\mathcal{L}_{\textup{mf}}({F})
\displaystyle{F}^{*}={F}_{\textup{sc}}{D}_{\lambda}{Q},
\displaystyle{F}^{*}={F}_{\textup{sc}}{D}_{\lambda}{Q},
{Q}
\displaystyle{D}_{\lambda}=\begin{bmatrix}\sqrt{1-\lambda_{1}}&&&\\
&\sqrt{1-\lambda_{2}}&&\\
&&\cdots&\\
&&&\sqrt{1-\lambda_{k}}\end{bmatrix}.
\displaystyle{D}_{\lambda}=\begin{bmatrix}\sqrt{1-\lambda_{1}}&&&\\
&\sqrt{1-\lambda_{2}}&&\\
&&\cdots&\\
&&&\sqrt{1-\lambda_{k}}\end{bmatrix}.
\displaystyle{B}^{*}={B}{D}_{\lambda}^{-1}{Q}^{-1},
\displaystyle{B}^{*}={B}{D}_{\lambda}^{-1}{Q}^{-1},
\vec{{y}}(\bar{x})
{y}(\bar{x})
\vec{\hat{y}}({x})
\hat{y}({x})
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B}^%
{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B}^%
{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]
\displaystyle\leq 2\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{\hat{y}}%
({x})-{B}^{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]+2\mathrm{%
\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{A%
}(\cdot|\bar{x})}\left[\left\lVert\vec{\hat{y}}({x})-\vec{y}(\bar{x})\right%
\rVert_{2}^{2}\right]
\displaystyle\leq
\displaystyle 2\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal%
{X}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{\hat{y}}({x})-{B%
}^{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]+2\mathrm{\mathbb{E%
}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|%
\bar{x})}\left[\left\lVert\vec{\hat{y}}({x})-\vec{y}(\bar{x})\right\rVert_{2}^%
{2}\right]
w_{x}
x
w_{x}
x
w_{x}
x
\displaystyle=2\sum_{{x}\in\mathcal{X}}w_{{x}}\cdot\left\lVert\vec{\hat{y}}({x%
})-{B}^{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}+4\Delta(y,\hat{y})
\displaystyle=
\displaystyle 2\sum_{{x}\in\mathcal{X}}w_{{x}}\cdot\left\lVert\vec{\hat{y}}({x%
})-{B}^{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}+4\Delta(y,\hat{y})
\displaystyle=2\left\lVert{U}-{F}^{*}{{B}^{*}}^{\top}\right\rVert_{F}^{2}+4%
\Delta(y,\hat{y})
\displaystyle=
\displaystyle 2\left\lVert{U}-{F}^{*}{{B}^{*}}^{\top}\right\rVert_{F}^{2}+4%
\Delta(y,\hat{y})
{B}^{*}
{B}^{*}
{B}^{*}
\displaystyle=2\left\lVert{U}-{F}_{\textup{sc}}{B}^{\top}\right\rVert_{F}^{2}+%
4\Delta(y,\hat{y})
\displaystyle=
\displaystyle 2\left\lVert{U}-{F}_{\textup{sc}}{B}^{\top}\right\rVert_{F}^{2}+%
4\Delta(y,\hat{y})
\displaystyle\leq\frac{\phi^{\hat{y}}}{\lambda_{k+1}}+4\Delta(y,\hat{y}).
\displaystyle\leq
\displaystyle\frac{\phi^{\hat{y}}}{\lambda_{k+1}}+4\Delta(y,\hat{y}).
{x}\in\mathcal{X}
\displaystyle\left\lVert\vec{{y}}(\bar{x})-{B}^{*}{f^{*}_{\textup{pop}}}({x})%
\right\rVert_{2}^{2}\geq\frac{1}{2}\cdot\mathbbm{1}\left[g_{{f^{*}_{\textup{%
pop}}},{B}^{*}}({x})\neq{y}(\bar{x})\right].
\displaystyle\left\lVert\vec{{y}}(\bar{x})-{B}^{*}{f^{*}_{\textup{pop}}}({x})%
\right\rVert_{2}^{2}\geq\frac{1}{2}\cdot\mathbbm{1}\left[g_{{f^{*}_{\textup{%
pop}}},{B}^{*}}({x})\neq{y}(\bar{x})\right].
\mathcal{X}
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y%
(\bar{x})\right)
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{f^{*}_{\textup{pop}}},{B}^{*}}({x})\neq y%
(\bar{x})\right)
\displaystyle\leq 2\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(%
\bar{x})-{B}^{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]
\displaystyle\leq
\displaystyle 2\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal%
{X}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-{B%
}^{*}{f^{*}_{\textup{pop}}}({x})\right\rVert_{2}^{2}\right]
\displaystyle\leq\frac{2\phi^{\hat{y}}}{\lambda_{k+1}}+8\Delta(y,\hat{y}).
\displaystyle\leq
\displaystyle\frac{2\phi^{\hat{y}}}{\lambda_{k+1}}+8\Delta(y,\hat{y}).
B^{*}
\displaystyle\left\lVert B^{*}\right\rVert_{F}^{2}=Tr\left(B^{*}{B^{*}}^{\top}%
\right)=Tr\left({B}D_{\lambda}^{-2}{B}^{\top}\right)\leq\frac{1}{1-\lambda_{k}%
}\left\lVert{B}\right\rVert_{F}^{2}=\frac{1}{1-\lambda_{k}}.
\displaystyle\left\lVert B^{*}\right\rVert_{F}^{2}=Tr\left(B^{*}{B^{*}}^{\top}%
\right)=Tr\left({B}D_{\lambda}^{-2}{B}^{\top}\right)\leq\frac{1}{1-\lambda_{k}%
}\left\lVert{B}\right\rVert_{F}^{2}=\frac{1}{1-\lambda_{k}}.
B_{\sigma}
\sigma
S_{1},S_{2},\cdots,S_{m+1}
i\in[m+1]
\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}]\leq\frac{1}{2}
j\in[m]
\displaystyle\rho_{m+1}\geq\phi_{G}(S_{i})\geq\min_{j\in[m]}\frac{\Pr_{{x}\sim
P%
_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{\sigma}}[{x}+\xi\in S_{i}\land{x}+%
\xi^{\prime}\notin S_{i}]}{\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S%
_{i}]}.
\displaystyle\rho_{m+1}\geq\phi_{G}(S_{i})\geq\min_{j\in[m]}\frac{\Pr_{{x}\sim
P%
_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{\sigma}}[{x}+\xi\in S_{i}\land{x}+%
\xi^{\prime}\notin S_{i}]}{\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S%
_{i}]}.
x\in\mathbb{R}^{d}
P(S_{i}|x)
\Pr_{\xi\sim B_{\sigma}}(x+\xi\in S_{i})
\displaystyle R:=\left\{x\bigg{|}\Pr(S_{i}|x)\geq\frac{2}{3}\right\}.
\displaystyle R:=\left\{x\bigg{|}\Pr(S_{i}|x)\geq\frac{2}{3}\right\}.
\int_{x\notin R}P_{j}(x)P(S_{i}|x)dx\geq\frac{1}{2}\Pr_{{x}\sim P_{j},\xi\sim B%
_{\sigma}}[{x}+\xi\in S_{i}]
\displaystyle\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{\sigma}%
}[{x}+\xi\in S_{i}\land{x}+\xi^{\prime}\notin S_{i}]\geq\int_{x\notin R}P_{j}(%
x)P(S_{i}|x)(1-P(S_{i}|x))dx
\displaystyle\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{\sigma}%
}[{x}+\xi\in S_{i}\land{x}+\xi^{\prime}\notin S_{i}]
\displaystyle\geq\int_{x\notin R}P_{j}(x)P(S_{i}|x)(1-P(S_{i}|x))dx
\displaystyle\geq\frac{1}{6}\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S%
_{i}],
\displaystyle\geq\frac{1}{6}\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S%
_{i}],
1/6
\int_{x\notin R}P_{j}(x)P(S_{i}|x)dx<\frac{1}{2}\Pr_{{x}\sim P_{j},\xi\sim B_{%
\sigma}}[{x}+\xi\in S_{i}]
\displaystyle\int_{x\in R}P_{j}(x)P(S_{i}|x)dx=\Pr_{{x}\sim P_{j},\xi\sim B_{%
\sigma}}[{x}+\xi\in S_{i}]-\int_{x\notin R}P_{j}(x)P(S_{i}|x)dx\geq\frac{1}{2}%
\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}],
\displaystyle\int_{x\in R}P_{j}(x)P(S_{i}|x)dx=\Pr_{{x}\sim P_{j},\xi\sim B_{%
\sigma}}[{x}+\xi\in S_{i}]-\int_{x\notin R}P_{j}(x)P(S_{i}|x)dx\geq\frac{1}{2}%
\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}],
\displaystyle\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}]\leq 2%
\int_{x\in R}P(S_{i}|x)P_{j}(x)dx\leq 2\int_{x\in R}P_{j}(x)dx.
\displaystyle\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}]\leq 2%
\int_{x\in R}P(S_{i}|x)P_{j}(x)dx\leq 2\int_{x\in R}P_{j}(x)dx.
\displaystyle N(R):=\left\{x\bigg{|}\left\lVert x-a\right\rVert_{2}\leq\frac{%
\sigma}{6}\text{ for some }a\in R\right\}.
\displaystyle N(R):=\left\{x\bigg{|}\left\lVert x-a\right\rVert_{2}\leq\frac{%
\sigma}{6}\text{ for some }a\in R\right\}.
\sigma^{2}\cdot\mathcal{I}_{d\times d}
\frac{\sigma}{6}
\frac{1}{6}
x\in N(R)
P(S_{i}|x)\geq\frac{2}{3}-\frac{1}{6}=\frac{1}{2}
\displaystyle\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{\sigma}%
}[{x}+\xi\in S_{i}\land{x}+\xi^{\prime}\notin S_{i}]\geq\int_{x\in N(R)%
\backslash R}P_{j}(x)P(S_{i}|x)(1-P(S_{i}|x))dx
\displaystyle\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{\sigma}%
}[{x}+\xi\in S_{i}\land{x}+\xi^{\prime}\notin S_{i}]
\displaystyle\geq\int_{x\in N(R)\backslash R}P_{j}(x)P(S_{i}|x)(1-P(S_{i}|x))dx
\displaystyle\geq\frac{1}{6}\int_{x\in N(R)\backslash R}P_{j}(x)dx.
\displaystyle\geq\frac{1}{6}\int_{x\in N(R)\backslash R}P_{j}(x)dx.
\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}]\leq\frac{1}{2}
R
\int_{x\in R}P_{j}(x)dx\leq\frac{3}{4}
\displaystyle\int_{x\in R}P_{j}(x)dx\leq\frac{3}{4}\leq 3\int_{x\notin R}P_{j}%
(x)dx.
\displaystyle\int_{x\in R}P_{j}(x)dx\leq\frac{3}{4}\leq 3\int_{x\notin R}P_{j}%
(x)dx.
\displaystyle\frac{\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{%
\sigma}}[{x}+\xi\in S_{i}\land{x}+\xi^{\prime}\notin S_{i}]}{\Pr_{{x}\sim P_{j%
},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}]}\geq\frac{1}{36}\frac{\int_{x\in N(R)%
\backslash R}P_{j}(x)P(S_{i}|x)dx}{\min\{\int_{x\in R}P_{j}(x)dx,\int_{x\in R}%
P_{j}(x)dx\}}.
\displaystyle\frac{\Pr_{{x}\sim P_{j},\xi\sim B_{\sigma},\xi^{\prime}\sim B_{%
\sigma}}[{x}+\xi\in S_{i}\land{x}+\xi^{\prime}\notin S_{i}]}{\Pr_{{x}\sim P_{j%
},\xi\sim B_{\sigma}}[{x}+\xi\in S_{i}]}\geq\frac{1}{36}\frac{\int_{x\in N(R)%
\backslash R}P_{j}(x)P(S_{i}|x)dx}{\min\{\int_{x\in R}P_{j}(x)dx,\int_{x\in R}%
P_{j}(x)dx\}}.
\displaystyle\lim_{\sigma\rightarrow 0^{+}}\frac{1}{\sigma}\cdot\frac{\int_{x%
\in N(R)\backslash R}P_{j}(x)P(S_{i}|x)dx}{\min\{\int_{x\in R}P_{j}(x)dx,\int_%
{x\in R}P_{j}(x)dx\}}\geq\frac{1}{6}h_{P_{j}},
\displaystyle\lim_{\sigma\rightarrow 0^{+}}\frac{1}{\sigma}\cdot\frac{\int_{x%
\in N(R)\backslash R}P_{j}(x)P(S_{i}|x)dx}{\min\{\int_{x\in R}P_{j}(x)dx,\int_%
{x\in R}P_{j}(x)dx\}}\geq\frac{1}{6}h_{P_{j}},
\sigma\rightarrow 0^{+}
\displaystyle\frac{\rho_{m+1}}{\sigma}\geq\frac{1}{216}\min_{j\in[m]}h_{P_{j}},
\displaystyle\frac{\rho_{m+1}}{\sigma}\geq\frac{1}{216}\min_{j\in[m]}h_{P_{j}},
\alpha
\alpha\leq\frac{1}{\textup{poly}(d^{\prime})}
z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{\prime}}\cdot I_{d^{\prime}\times d^{%
\prime}})
j\neq i
\displaystyle\Pr_{z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{\prime}}\cdot I_{d^{%
\prime}\times d^{\prime}})}\left((z-\mu_{i})^{\top}\left(\frac{\mu_{j}-\mu_{i}%
}{\left\lVert\mu_{j}-\mu_{i}\right\rVert_{2}}\right)\lesssim\frac{\sqrt{\log d%
}}{\sqrt{d^{\prime}}}\right)\geq 1-\frac{1}{\textup{poly}(d)}.
\displaystyle\Pr_{z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{\prime}}\cdot I_{d^{%
\prime}\times d^{\prime}})}\left((z-\mu_{i})^{\top}\left(\frac{\mu_{j}-\mu_{i}%
}{\left\lVert\mu_{j}-\mu_{i}\right\rVert_{2}}\right)\lesssim\frac{\sqrt{\log d%
}}{\sqrt{d^{\prime}}}\right)\geq 1-\frac{1}{\textup{poly}(d)}.
\xi\sim\mathcal{N}(0,\frac{1}{d}\cdot I_{d\times d})
\sigma\leq\frac{1}{\sqrt{d}}
\displaystyle\Pr_{\xi\sim\mathcal{N}(0,\frac{\sigma^{2}}{d}\cdot I_{d^{\prime}%
\times d^{\prime}})}\left(\left\lVert\xi\right\rVert_{2}\lesssim\frac{\sqrt{%
\log d}}{\sqrt{d}}\right)\geq 1-\frac{1}{\textup{poly}(d)}.
\displaystyle\Pr_{\xi\sim\mathcal{N}(0,\frac{\sigma^{2}}{d}\cdot I_{d^{\prime}%
\times d^{\prime}})}\left(\left\lVert\xi\right\rVert_{2}\lesssim\frac{\sqrt{%
\log d}}{\sqrt{d}}\right)\geq 1-\frac{1}{\textup{poly}(d)}.
\left\lVert Q^{-1}(Q(z)+\xi)-z\right\rVert_{2}\leq\kappa\left\lVert\xi\right\rVert
\left\lVert\mu_{i}-\mu_{j}\right\rVert\gtrsim\kappa\frac{\sqrt{\log d}}{\sqrt{%
d}}
\left\lVert\mu_{i}-\mu_{j}\right\rVert\gtrsim\kappa\frac{\sqrt{\log d}}{\sqrt{%
d^{\prime}}}
\displaystyle\Pr_{z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{\prime}}\cdot I_{d^{%
\prime}\times d^{\prime}}),\xi\sim\mathcal{N}(0,\frac{\sigma^{2}}{d}\cdot I_{d%
^{\prime}\times d^{\prime}})}\left(P_{i}(z)>P_{j}(Q^{-1}(Q(z)+\xi))\right)\geq
1%
-\frac{1}{\textup{poly}(d)}.
\displaystyle\Pr_{z\sim\mathcal{N}(\mu_{i},\frac{1}{d^{\prime}}\cdot I_{d^{%
\prime}\times d^{\prime}}),\xi\sim\mathcal{N}(0,\frac{\sigma^{2}}{d}\cdot I_{d%
^{\prime}\times d^{\prime}})}\left(P_{i}(z)>P_{j}(Q^{-1}(Q(z)+\xi))\right)\geq
1%
-\frac{1}{\textup{poly}(d)}.
r\leq d
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}({y}({x})\neq y(\bar{x}))\geq 1-\frac{1}{\textup{%
poly}(d)}.
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}({y}({x})\neq y(\bar{x}))\geq 1-\frac{1}{\textup{%
poly}(d)}.
m
k^{\prime}>r
\tau>0
\displaystyle\rho_{k^{\prime}}\geq\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-%
\frac{2c_{\sigma}\tau+\tau^{2}}{2{\sigma}^{2}/d}\right),
\displaystyle\rho_{k^{\prime}}\geq\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-%
\frac{2c_{\sigma}\tau+\tau^{2}}{2{\sigma}^{2}/d}\right),
\displaystyle c_{\sigma}:={\sigma}\cdot\Phi_{d}^{-1}(\frac{2}{3})
\displaystyle c_{\sigma}:={\sigma}\cdot\Phi_{d}^{-1}(\frac{2}{3})
\Phi_{d}(z):=\Pr_{\xi\sim\mathcal{N}(0,\frac{1}{d}I_{d\times d})}(\left\lVert%
\xi\right\rVert_{2}\leq z)
\displaystyle c_{\tau/\kappa}:=\min_{p\in[0,\frac{3}{4}]}\frac{\Phi(\Phi^{-1}(%
p)+{\tau\sqrt{d}/\kappa})}{p}-1
\displaystyle c_{\tau/\kappa}:=\min_{p\in[0,\frac{3}{4}]}\frac{\Phi(\Phi^{-1}(%
p)+{\tau\sqrt{d}/\kappa})}{p}-1
\Phi(z):=\int_{-\infty}^{z}\frac{e^{-u^{2}/2}}{\sqrt{2\pi}}du.
\alpha
C>0
d\geq C
1-\Phi_{d}(\sqrt{\frac{3}{2}})\leq\frac{1}{3}
\Phi_{d}^{-1}(\frac{2}{3})\leq\sqrt{\frac{3}{2}}
d\leq C
d
\Phi_{d}^{-1}(\frac{2}{3})\lesssim 1
\tau=\sigma/d
\rho_{k^{\prime}}\gtrsim\frac{\sigma}{\kappa\sqrt{d}}
k^{\prime}=\lfloor k/2\rfloor
L_{2}
S\subseteq\mathbb{R}^{d}
x\in\mathbb{R}^{d}
\Pr(S|x):=\Pr_{\tilde{x}\sim\mathcal{A}(\cdot|x)}(\tilde{x}\in S)\geq\frac{2}{3}
x^{\prime}
\left\lVert x-x^{\prime}\right\rVert_{2}\leq\tau
\displaystyle\Pr(S|x^{\prime})\geq\frac{1}{3}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}}\right),
\displaystyle\Pr(S|x^{\prime})\geq\frac{1}{3}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}}\right),
\displaystyle c_{\sigma}:={\sigma}\cdot\Phi_{d}^{-1}(\frac{2}{3}),
\displaystyle c_{\sigma}:={\sigma}\cdot\Phi_{d}^{-1}(\frac{2}{3}),
\Phi_{d}(z):=\Pr_{\xi\sim\mathcal{N}(0,\frac{1}{d}\cdot I_{d\times d})}(\left%
\lVert\xi\right\rVert_{2}\leq z)
\displaystyle\Pr(S|x)=\mathrm{\mathbb{E}}_{\xi\sim\mathcal{N}(0,\frac{{\sigma}%
^{2}}{d}\cdot I_{d\times d})}\left[\mathbbm{1}\left[x+\xi\in S\right]\right].
\displaystyle\Pr(S|x)=\mathrm{\mathbb{E}}_{\xi\sim\mathcal{N}(0,\frac{{\sigma}%
^{2}}{d}\cdot I_{d\times d})}\left[\mathbbm{1}\left[x+\xi\in S\right]\right].
c_{\sigma}
\displaystyle\Pr_{\xi\sim\mathcal{N}(0,\frac{{\sigma}^{2}}{d}\cdot I_{d\times d%
})}(\left\lVert\xi\right\rVert_{2}\leq c_{\sigma})=\frac{2}{3}.
\displaystyle\Pr_{\xi\sim\mathcal{N}(0,\frac{{\sigma}^{2}}{d}\cdot I_{d\times d%
})}(\left\lVert\xi\right\rVert_{2}\leq c_{\sigma})=\frac{2}{3}.
\Pr(S|x)\geq\frac{2}{3}
\displaystyle\mathrm{\mathbb{E}}_{\xi\sim\mathcal{N}(0,\frac{{\sigma}^{2}}{d}%
\cdot I_{d\times d})}\left[P(S|x+\xi)\cdot\mathbbm{1}\left[\left\lVert\xi%
\right\rVert_{2}\leq c_{\sigma}\right]\right]\geq\frac{1}{3}.
\displaystyle\mathrm{\mathbb{E}}_{\xi\sim\mathcal{N}(0,\frac{{\sigma}^{2}}{d}%
\cdot I_{d\times d})}\left[P(S|x+\xi)\cdot\mathbbm{1}\left[\left\lVert\xi%
\right\rVert_{2}\leq c_{\sigma}\right]\right]\geq\frac{1}{3}.
\displaystyle\Pr(S|x^{\prime})=\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e%
^{-\frac{\left\lVert\xi\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|x^{\prime}+%
\xi)d\xi
\displaystyle\Pr(S|x^{\prime})
\displaystyle=\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{\left%
\lVert\xi\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|x^{\prime}+\xi)d\xi
\displaystyle=\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{\left%
\lVert\xi+x-x^{\prime}\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|x+\xi)d\xi
\displaystyle=\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{\left%
\lVert\xi+x-x^{\prime}\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|x+\xi)d\xi
\displaystyle\geq\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{\left%
\lVert\xi+x-x^{\prime}\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|x+\xi)\cdot%
\mathbbm{1}\left[\left\lVert\xi\right\rVert_{2}\leq c_{\sigma}\right]d\xi
\displaystyle\geq\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{\left%
\lVert\xi+x-x^{\prime}\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|x+\xi)\cdot%
\mathbbm{1}\left[\left\lVert\xi\right\rVert_{2}\leq c_{\sigma}\right]d\xi
\displaystyle\geq\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{2c_{%
\sigma}\tau+\tau^{2}+\left\lVert\xi\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|%
x+\xi)\cdot\mathbbm{1}\left[\left\lVert\xi\right\rVert_{2}\leq c_{\sigma}%
\right]d\xi
\displaystyle\geq\frac{1}{(2\pi{\sigma}^{2}/d)^{d/2}}\int_{\xi}e^{-\frac{2c_{%
\sigma}\tau+\tau^{2}+\left\lVert\xi\right\rVert_{2}^{2}}{2{\sigma}^{2}/d}}P(S|%
x+\xi)\cdot\mathbbm{1}\left[\left\lVert\xi\right\rVert_{2}\leq c_{\sigma}%
\right]d\xi
\displaystyle=e^{-\frac{2c_{\sigma}\tau+\tau^{2}}{2{\sigma}^{2}/d}}\cdot%
\mathrm{\mathbb{E}}_{\xi\sim\mathcal{N}(0,\frac{{\sigma}^{2}}{d}I_{d\times d})%
}\left[P(S|x+\xi)\cdot\mathbbm{1}\left[\left\lVert\xi\right\rVert_{2}\leq c_{%
\sigma}\right]\right]
\displaystyle=e^{-\frac{2c_{\sigma}\tau+\tau^{2}}{2{\sigma}^{2}/d}}\cdot%
\mathrm{\mathbb{E}}_{\xi\sim\mathcal{N}(0,\frac{{\sigma}^{2}}{d}I_{d\times d})%
}\left[P(S|x+\xi)\cdot\mathbbm{1}\left[\left\lVert\xi\right\rVert_{2}\leq c_{%
\sigma}\right]\right]
\displaystyle\geq\frac{1}{3}\cdot\exp\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{2{%
\sigma}^{2}/d}\right).
\displaystyle\geq\frac{1}{3}\cdot\exp\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{2{%
\sigma}^{2}/d}\right).
S_{1},\cdots,S_{k^{\prime}}
\rho_{k^{\prime}}
k^{\prime}>r
t\in[k^{\prime}]
i\in[r]
\displaystyle\Pr_{x\sim P_{i},\tilde{x}\sim\mathcal{A}(\cdot|x)}(\tilde{x}\in S%
_{t})\leq\frac{1}{2}.
\displaystyle\Pr_{x\sim P_{i},\tilde{x}\sim\mathcal{A}(\cdot|x)}(\tilde{x}\in S%
_{t})\leq\frac{1}{2}.
t=1
\displaystyle\rho_{k^{\prime}}=\max_{i\in[k^{\prime}]}\phi_{G}(S_{i})\geq\phi_%
{G}(S_{1})\geq\min_{j\in[r]}\frac{\mathrm{\mathbb{E}}_{x\sim P_{j}}\left[\Pr(S%
_{1}|x)(1-\Pr(S_{1}|x))\right]}{\mathrm{\mathbb{E}}_{x\sim P_{j}}\left[\Pr(S_{%
1}|x)\right]},
\displaystyle\rho_{k^{\prime}}
\displaystyle=\max_{i\in[k^{\prime}]}\phi_{G}(S_{i})\geq\phi_{G}(S_{1})\geq%
\min_{j\in[r]}\frac{\mathrm{\mathbb{E}}_{x\sim P_{j}}\left[\Pr(S_{1}|x)(1-\Pr(%
S_{1}|x))\right]}{\mathrm{\mathbb{E}}_{x\sim P_{j}}\left[\Pr(S_{1}|x)\right]},
\displaystyle\Pr(S|x):=\Pr_{\tilde{x}\sim\mathcal{A}(\cdot|x)}(\tilde{x}\in S).
\displaystyle\Pr(S|x):=\Pr_{\tilde{x}\sim\mathcal{A}(\cdot|x)}(\tilde{x}\in S).
j=1
\displaystyle\frac{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S%
_{1}|x))\right]}{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)\right]}%
\geq\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{%
2{\sigma}^{2}/d}\right).
\displaystyle\frac{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S%
_{1}|x))\right]}{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)\right]}%
\geq\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{%
2{\sigma}^{2}/d}\right).
\displaystyle R:=\left\{x\bigg{|}\Pr(S_{1}|x)\geq\frac{2}{3}\right\}.
\displaystyle R:=\left\{x\bigg{|}\Pr(S_{1}|x)\geq\frac{2}{3}\right\}.
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)\right]=\int_{%
x}P_{1}(x)\Pr(S_{1}|x)dx
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)\right]
\displaystyle=\int_{x}P_{1}(x)\Pr(S_{1}|x)dx
\displaystyle=\int_{x\in R}P_{1}(x)\Pr(S_{1}|x)dx+\int_{x\notin R}P_{1}(x)\Pr(%
S_{1}|x)dx.
\displaystyle=\int_{x\in R}P_{1}(x)\Pr(S_{1}|x)dx+\int_{x\notin R}P_{1}(x)\Pr(%
S_{1}|x)dx.
\int_{x\notin R}P_{1}(x)\Pr(S_{1}|x)dx\geq\frac{1}{2}\mathrm{\mathbb{E}}_{x%
\sim P_{1}}\left[\Pr(S_{1}|x)\right]
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S_{1}|x%
))\right]\geq\int_{x\notin R}P_{1}(x)\Pr(S_{1}|x)(1-\Pr(S_{1}|x))dx
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S_{1}|x%
))\right]
\displaystyle\geq\int_{x\notin R}P_{1}(x)\Pr(S_{1}|x)(1-\Pr(S_{1}|x))dx
\displaystyle\geq\frac{1}{3}\int_{x\notin R}P_{1}(x)\Pr(S_{1}|x)dx
\displaystyle\geq\frac{1}{3}\int_{x\notin R}P_{1}(x)\Pr(S_{1}|x)dx
\displaystyle\geq\frac{1}{6}\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x%
)\right].
\displaystyle\geq\frac{1}{6}\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x%
)\right].
\int_{x\in R}P_{1}(x)\Pr(S_{1}|x)dx\geq\frac{1}{2}\mathrm{\mathbb{E}}_{x\sim P%
_{1}}\left[\Pr(S_{1}|x)\right]
R
\displaystyle N(R):=\left\{x\bigg{|}\left\lVert x-a\right\rVert_{2}\leq\tau%
\text{ for some }a\in R\right\}.
\displaystyle N(R):=\left\{x\bigg{|}\left\lVert x-a\right\rVert_{2}\leq\tau%
\text{ for some }a\in R\right\}.
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S_{1}|x%
))\right]\geq\int_{x\in N(R)\backslash R}P_{1}(x)\Pr(S_{1}|x)(1-\Pr(S_{1}|x))dx
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S_{1}|x%
))\right]
\displaystyle\geq\int_{x\in N(R)\backslash R}P_{1}(x)\Pr(S_{1}|x)(1-\Pr(S_{1}|%
x))dx
\displaystyle\geq\frac{1}{9}\cdot\exp\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{2{%
\sigma}^{2}/d}\right)\cdot\int_{x\in N(R)\backslash R}P_{1}(x)dx,
\displaystyle\geq\frac{1}{9}\cdot\exp\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{2{%
\sigma}^{2}/d}\right)\cdot\int_{x\in N(R)\backslash R}P_{1}(x)dx,
\displaystyle\int_{x\in R}P_{1}(x)dx\leq\frac{3}{2}\int_{x\in R}P_{1}(x)\Pr(S_%
{1}|x)dx\leq\frac{3}{2}\int_{x}P_{1}(x)\Pr(S_{1}|x)dx\leq\frac{3}{4},
\displaystyle\int_{x\in R}P_{1}(x)dx\leq\frac{3}{2}\int_{x\in R}P_{1}(x)\Pr(S_%
{1}|x)dx\leq\frac{3}{2}\int_{x}P_{1}(x)\Pr(S_{1}|x)dx\leq\frac{3}{4},
\widetilde{R}:=Q^{-1}(R)
R
\displaystyle\widetilde{N}(\widetilde{R}):=\left\{x^{\prime}\in\mathbb{R}^{d^{%
\prime}}\bigg{|}\left\lVert x^{\prime}-a\right\rVert_{2}\leq\frac{\tau}{\kappa%
}\text{ for some }a\in\widetilde{R}\right\}
\displaystyle\widetilde{N}(\widetilde{R}):=\left\{x^{\prime}\in\mathbb{R}^{d^{%
\prime}}\bigg{|}\left\lVert x^{\prime}-a\right\rVert_{2}\leq\frac{\tau}{\kappa%
}\text{ for some }a\in\widetilde{R}\right\}
Q
\kappa
\widetilde{N}(\widetilde{R})\subseteq Q^{-1}\left(N(R)\right)
\displaystyle\int_{x\in{N}(R)\backslash R}P_{1}(x)dx\geq c_{\tau/\kappa}\int_{%
x\in R}P_{1}(x)dx,
\displaystyle\int_{x\in{N}(R)\backslash R}P_{1}(x)dx\geq c_{\tau/\kappa}\int_{%
x\in R}P_{1}(x)dx,
\displaystyle c_{\tau/\kappa}:=\min_{0\leq p\leq 3/4}\frac{\Phi(\Phi^{-1}(p)+%
\tau\sqrt{d}/\kappa)}{p}-1,
\displaystyle c_{\tau/\kappa}:=\min_{0\leq p\leq 3/4}\frac{\Phi(\Phi^{-1}(p)+%
\tau\sqrt{d}/\kappa)}{p}-1,
\Phi(\cdot)
\displaystyle\Phi(z):=\int_{-\infty}^{z}\frac{e^{-u^{2}/2}}{\sqrt{2\pi}}du.
\displaystyle\Phi(z):=\int_{-\infty}^{z}\frac{e^{-u^{2}/2}}{\sqrt{2\pi}}du.
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S_{1}|x%
))\right]\geq\frac{c_{\tau/\kappa}}{9}\cdot\exp\left(-\frac{2c_{\sigma}\tau+%
\tau^{2}}{2{\sigma}^{2}/d}\right)\cdot\int_{x\in R}P_{1}(x)dx
\displaystyle\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S_{1}|x%
))\right]
\displaystyle\geq\frac{c_{\tau/\kappa}}{9}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\cdot\int_{x\in R}P_{1}(x)dx
\displaystyle\geq\frac{c_{\tau/\kappa}}{9}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\cdot\int_{x\in R}P_{1}(x)\Pr(S_{1}|x)dx
\displaystyle\geq\frac{c_{\tau/\kappa}}{9}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\cdot\int_{x\in R}P_{1}(x)\Pr(S_{1}|x)dx
\displaystyle\geq\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\cdot\mathrm{\mathbb{E}}_{x\sim P_{1}}%
\left[\Pr(S_{1}|x)\right].
\displaystyle\geq\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_{\sigma}%
\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\cdot\mathrm{\mathbb{E}}_{x\sim P_{1}}%
\left[\Pr(S_{1}|x)\right].
\displaystyle\frac{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S%
_{1}|x))\right]}{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)\right]}%
\geq\min\left\{\frac{1}{6},\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_%
{\sigma}\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\right\}
\displaystyle\frac{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)(1-\Pr(S%
_{1}|x))\right]}{\mathrm{\mathbb{E}}_{x\sim P_{1}}\left[\Pr(S_{1}|x)\right]}
\displaystyle\geq\min\left\{\frac{1}{6},\frac{c_{\tau/\kappa}}{18}\cdot\exp%
\left(-\frac{2c_{\sigma}\tau+\tau^{2}}{2{\sigma}^{2}/d}\right)\right\}
\displaystyle=\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_{\sigma}\tau+%
\tau^{2}}{2{\sigma}^{2}/d}\right).
\displaystyle=\frac{c_{\tau/\kappa}}{18}\cdot\exp\left(-\frac{2c_{\sigma}\tau+%
\tau^{2}}{2{\sigma}^{2}/d}\right).
\widehat{\mathcal{X}}=\{\bar{x}_{1},\bar{x}_{2},\cdots,\bar{x}_{n}\}
n
\mathcal{P}_{\overline{\mathcal{X}}}
\hat{\mathcal{P}}_{\mathcal{X}}
\widehat{\mathcal{X}}
\hat{P}_{\bar{x},\bar{x}^{\prime}}
(\bar{x}_{i},\bar{x}_{j})
i\neq j
f
\displaystyle\widehat{\mathcal{L}}_{n}({f}):=-2\mathrm{\mathbb{E}}_{\bar{x}%
\sim\hat{\mathcal{P}}_{\mathcal{X}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}%
^{\prime}\sim\mathcal{A}(\cdot|\bar{x})}\left[f({x})^{\top}f({x}^{\prime})%
\right]+\mathrm{\mathbb{E}}_{(\bar{x},\bar{x}^{\prime})\sim\hat{P}_{\bar{x},%
\bar{x}^{\prime}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime}\sim%
\mathcal{A}(\cdot|\bar{x}^{\prime})}\left[\left(f({x})^{\top}f({x}^{\prime})%
\right)^{2}\right].
\displaystyle\widehat{\mathcal{L}}_{n}({f}):=-2\mathrm{\mathbb{E}}_{\bar{x}%
\sim\hat{\mathcal{P}}_{\mathcal{X}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}%
^{\prime}\sim\mathcal{A}(\cdot|\bar{x})}\left[f({x})^{\top}f({x}^{\prime})%
\right]+\mathrm{\mathbb{E}}_{(\bar{x},\bar{x}^{\prime})\sim\hat{P}_{\bar{x},%
\bar{x}^{\prime}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime}\sim%
\mathcal{A}(\cdot|\bar{x}^{\prime})}\left[\left(f({x})^{\top}f({x}^{\prime})%
\right)^{2}\right].
\widehat{\mathcal{L}}_{n}({f})
\widehat{\mathcal{L}}_{n}({f})
\mathcal{L}({f})
\displaystyle\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}}\left[\widehat{%
\mathcal{L}}_{n}({f})\right]=\mathcal{L}({f}).
\displaystyle\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}}\left[\widehat{%
\mathcal{L}}_{n}({f})\right]=\mathcal{L}({f}).
\displaystyle\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}}\left[\widehat{%
\mathcal{L}}_{n}({f})\right]=-2\cdot\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}%
}\left[\mathrm{\mathbb{E}}_{\bar{x}\sim\hat{\mathcal{P}}_{\mathcal{X}},\atop{x%
}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime}\sim\mathcal{A}(\cdot|\bar{x})}%
\left[f({x})^{\top}f({x}^{\prime})\right]\right]+\mathrm{\mathbb{E}}_{\widehat%
{\mathcal{X}}}\left[\mathrm{\mathbb{E}}_{(\bar{x},\bar{x}^{\prime})\sim\hat{P}%
_{\bar{x},\bar{x}^{\prime}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime%
}\sim\mathcal{A}(\cdot|\bar{x}^{\prime})}\left[\left(f({x})^{\top}f({x}^{%
\prime})\right)^{2}\right]\right]
\displaystyle\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}}\left[\widehat{%
\mathcal{L}}_{n}({f})\right]
\displaystyle=-2\cdot\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}}\left[\mathrm{%
\mathbb{E}}_{\bar{x}\sim\hat{\mathcal{P}}_{\mathcal{X}},\atop{x}\sim\mathcal{A%
}(\cdot|\bar{x}),{x}^{\prime}\sim\mathcal{A}(\cdot|\bar{x})}\left[f({x})^{\top%
}f({x}^{\prime})\right]\right]+\mathrm{\mathbb{E}}_{\widehat{\mathcal{X}}}%
\left[\mathrm{\mathbb{E}}_{(\bar{x},\bar{x}^{\prime})\sim\hat{P}_{\bar{x},\bar%
{x}^{\prime}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime}\sim\mathcal{%
A}(\cdot|\bar{x}^{\prime})}\left[\left(f({x})^{\top}f({x}^{\prime})\right)^{2}%
\right]\right]
\displaystyle=-2\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime}\sim\mathcal{%
A}(\cdot|\bar{x})}\left[f({x})^{\top}f({x}^{\prime})\right]+\mathrm{\mathbb{E}%
}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},\bar{x}^{\prime}\sim%
\mathcal{P}_{\overline{\mathcal{X}}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x%
}^{\prime}\sim\mathcal{A}(\cdot|\bar{x}^{\prime})}\left[\left(f({x})^{\top}f({%
x}^{\prime})\right)^{2}\right]=\mathcal{L}({f}).
\displaystyle=-2\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{%
\mathcal{X}}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x}^{\prime}\sim\mathcal{%
A}(\cdot|\bar{x})}\left[f({x})^{\top}f({x}^{\prime})\right]+\mathrm{\mathbb{E}%
}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},\bar{x}^{\prime}\sim%
\mathcal{P}_{\overline{\mathcal{X}}},\atop{x}\sim\mathcal{A}(\cdot|\bar{x}),{x%
}^{\prime}\sim\mathcal{A}(\cdot|\bar{x}^{\prime})}\left[\left(f({x})^{\top}f({%
x}^{\prime})\right)^{2}\right]=\mathcal{L}({f}).
\widehat{\mathcal{X}}
\pi:[n]\rightarrow[n]
S=\{(z_{i},z_{i}^{+},z_{i}^{\prime})\}_{i=1}^{n/2}
\displaystyle z_{i}\sim\mathcal{A}(\cdot|\bar{x}_{\pi(2i-1)}),
\displaystyle z_{i}\sim\mathcal{A}(\cdot|\bar{x}_{\pi(2i-1)}),
\displaystyle z_{i}^{+}\sim\mathcal{A}(\cdot|\bar{x}_{\pi(2i-1)}),
\displaystyle z_{i}^{+}\sim\mathcal{A}(\cdot|\bar{x}_{\pi(2i-1)}),
\displaystyle z_{i}^{\prime}\sim\mathcal{A}(\cdot|\bar{x}_{\pi(2i)}).
\displaystyle z_{i}^{\prime}\sim\mathcal{A}(\cdot|\bar{x}_{\pi(2i)}).
S
\displaystyle\widehat{\mathcal{L}}_{S}({f}):=\frac{1}{n/2}\sum_{i=1}^{n/2}%
\left[\left(f(z_{i})^{\top}f(z_{i}^{\prime})\right)^{2}-2f(z_{i})^{\top}f(z_{i%
}^{+})\right].
\displaystyle\widehat{\mathcal{L}}_{S}({f}):=\frac{1}{n/2}\sum_{i=1}^{n/2}%
\left[\left(f(z_{i})^{\top}f(z_{i}^{\prime})\right)^{2}-2f(z_{i})^{\top}f(z_{i%
}^{+})\right].
\widehat{\mathcal{L}}_{S}({f})
\widehat{\mathcal{L}}_{n}({f})
\widehat{\mathcal{X}}
S
\displaystyle\mathrm{\mathbb{E}}_{S}\left[\widehat{\mathcal{L}}_{S}({f})\right%
]=\widehat{\mathcal{L}}_{f}({.})
\displaystyle\mathrm{\mathbb{E}}_{S}\left[\widehat{\mathcal{L}}_{S}({f})\right%
]=\widehat{\mathcal{L}}_{f}({.})
\widehat{\mathcal{L}}_{S}({f})
\widehat{\mathcal{L}}_{n}({f})
\mathcal{F}
\mathcal{X}
\mathbb{R}^{k}
\left\lVert f(x)\right\rVert_{\infty}\leq{\kappa}
x\in\mathcal{X}
i\in[k]
f_{i}:\mathcal{X}\rightarrow\mathbb{R}
f_{i}(x)
i
f(x)
\mathcal{F}_{i}
f_{i}
f\in\mathcal{F}
n\in\mathcal{Z}^{+}
\widehat{\mathcal{R}}_{n}(\mathcal{F}_{i})
\mathcal{F}_{i}
n
\displaystyle\widehat{\mathcal{R}}_{n}(\mathcal{F}_{i}):=\max_{\{x_{1},x_{2},%
\cdots,x_{n}\}}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}%
}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(x_{j})\right)\right],
\displaystyle\widehat{\mathcal{R}}_{n}(\mathcal{F}_{i}):=\max_{\{x_{1},x_{2},%
\cdots,x_{n}\}}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}%
}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(x_{j})\right)\right],
x_{1},x_{2},\cdots,x_{m}
\mathcal{X}
\sigma
\{-1,1\}^{n}
n
\{(z_{i},z_{i}^{+},z_{i}^{\prime})\}_{i=1}^{n}
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(\left(f(z_{j})^{\top}f(z_{j}^{\prime}%
)\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})\right)\right)\right]\leq(16k^{2}{%
\kappa}^{2}+16k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{n}(\mathcal{%
F}_{i}).
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(\left(f(z_{j})^{\top}f(z_{j}^{\prime}%
)\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})\right)\right)\right]\leq(16k^{2}{%
\kappa}^{2}+16k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{n}(\mathcal{%
F}_{i}).
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(\left(f(z_{j})^{\top}f(z_{j}^{\prime}%
)\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})\right)\right)\right]
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(\left(f(z_{j})^{\top}f(z_{j}^{\prime}%
)\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})\right)\right)\right]
\displaystyle\leq\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left%
(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(f(z_{j})^{\top}f(z_{j}^{\prime})%
\right)^{2}\right)\right]+2\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in%
\mathcal{F}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f(z_{j})^{\top}f(z_{j}^{+%
})\right)\right]
\displaystyle\leq
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(f(z_{j})^{\top}f(z_{j}^{\prime})%
\right)^{2}\right)\right]+2\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in%
\mathcal{F}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f(z_{j})^{\top}f(z_{j}^{+%
})\right)\right]
\displaystyle\leq 2k{\kappa}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in%
\mathcal{F}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f(z_{j})^{\top}f(z_{j}^{%
\prime})\right)\right]+2\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F%
}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f(z_{j})^{\top}f(z_{j}^{+})\right)\right]
\displaystyle\leq
\displaystyle 2k{\kappa}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F%
}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f(z_{j})^{\top}f(z_{j}^{\prime})%
\right)\right]+2\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f(z_{j})^{\top}f(z_{j}^{+})\right)\right]
\displaystyle\leq(2k^{2}{\kappa}+2k)\max_{z_{1},z_{2},\cdots,z_{n}\atop z_{1}^%
{\prime},z_{2}^{\prime},\cdots,z_{n}^{\prime}}\max_{i\in[k]}\mathrm{\mathbb{E}%
}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}%
\sigma_{j}f_{i}(z_{j})f_{i}(z_{j}^{\prime})\right)\right],
\displaystyle\leq
\displaystyle(2k^{2}{\kappa}+2k)\max_{z_{1},z_{2},\cdots,z_{n}\atop z_{1}^{%
\prime},z_{2}^{\prime},\cdots,z_{n}^{\prime}}\max_{i\in[k]}\mathrm{\mathbb{E}}%
_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}%
\sigma_{j}f_{i}(z_{j})f_{i}(z_{j}^{\prime})\right)\right],
z_{1},z_{2}\cdots z_{n}
z_{1}^{\prime},z_{2}^{\prime},\cdots,z_{n}^{\prime}
\mathcal{X}
i\in[k]
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}%
\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j})f_{i}(z_{j}^{\prime})%
\right)\right]
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}%
\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j})f_{i}(z_{j}^{\prime})%
\right)\right]
\displaystyle\leq\frac{1}{2}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in%
\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(f_{i}(z_{j})+f_%
{i}(z_{j}^{\prime})\right)^{2}\right)\right]+\frac{1}{2}\mathrm{\mathbb{E}}_{%
\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}%
\sigma_{j}\left(f_{i}(z_{j})-f_{i}(z_{j}^{\prime})\right)^{2}\right)\right]
\displaystyle\leq
\displaystyle\frac{1}{2}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in%
\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(f_{i}(z_{j})+f_%
{i}(z_{j}^{\prime})\right)^{2}\right)\right]+\frac{1}{2}\mathrm{\mathbb{E}}_{%
\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}%
\sigma_{j}\left(f_{i}(z_{j})-f_{i}(z_{j}^{\prime})\right)^{2}\right)\right]
\displaystyle\leq 4{\kappa}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in%
\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j})\right)%
\right]+4{\kappa}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{%
i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j}^{\prime})\right)\right],
\displaystyle\leq
\displaystyle 4{\kappa}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in%
\mathcal{F}_{i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j})\right)%
\right]+4{\kappa}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{%
i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j}^{\prime})\right)\right],
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(\left(f(z_{j})^{\top}f(z_{j}^{\prime}%
)\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})\right)\right)\right]
\displaystyle\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f\in\mathcal{F}}\left(%
\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}\left(\left(f(z_{j})^{\top}f(z_{j}^{\prime}%
)\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})\right)\right)\right]
\displaystyle\leq(16k^{2}{\kappa}^{2}+16k{\kappa})\max_{z_{1},z_{2},\cdots,z_{%
n}}\max_{i\in[k]}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{%
i}}\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j})\right)\right].
\displaystyle\leq
\displaystyle(16k^{2}{\kappa}^{2}+16k{\kappa})\max_{z_{1},z_{2},\cdots,z_{n}}%
\max_{i\in[k]}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{f_{i}\in\mathcal{F}_{i}}%
\left(\frac{1}{n}\sum_{j=1}^{n}\sigma_{j}f_{i}(z_{j})\right)\right].
\mathrm{\mathbb{E}}_{S}[\widehat{\mathcal{L}}_{S}({f})]=\mathcal{L}({f})
S
\widehat{\mathcal{X}}
S
\widehat{\mathcal{X}}
n
S
n
\left(f(z_{j})^{\top}f(z_{j}^{\prime})\right)^{2}-2f(z_{j})^{\top}f(z_{j}^{+})
[-2k{\kappa}^{2},2k{\kappa}^{2}+k^{2}{\kappa}^{4}]
1-\delta^{2}/4
\widehat{\mathcal{X}}
S
f\in\mathcal{F}
\displaystyle\mathcal{L}({f})\leq\widehat{\mathcal{L}}_{S}({f})+(32k^{2}{%
\kappa}^{2}+32k{\kappa})\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}%
(\mathcal{F}_{i})+(4k{\kappa}^{2}+k^{2}{\kappa}^{4})\cdot\sqrt{\frac{4\log 2/%
\delta}{{n_{\rm{pre}}}}}.
\displaystyle\mathcal{L}({f})\leq\widehat{\mathcal{L}}_{S}({f})+(32k^{2}{%
\kappa}^{2}+32k{\kappa})\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}%
(\mathcal{F}_{i})+(4k{\kappa}^{2}+k^{2}{\kappa}^{4})\cdot\sqrt{\frac{4\log 2/%
\delta}{{n_{\rm{pre}}}}}.
1-\delta/2
\widehat{\mathcal{X}}
1-\delta/2
S
\widehat{\mathcal{X}}
\mathcal{L}({f})
\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})
[-2k{\kappa}^{2},2k{\kappa}^{2}+k^{2}{\kappa}^{4}]
1-{\delta}/{2}
\widehat{\mathcal{X}}
f\in\mathcal{F}
\displaystyle\mathcal{L}({f})\leq\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})+(%
32k^{2}{\kappa}^{2}+32k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{%
\rm{pre}}}/2}(\mathcal{F}_{i})+(4k{\kappa}^{2}+k^{2}{\kappa}^{4})\cdot\left(%
\sqrt{\frac{4\log 2/\delta}{{n_{\rm{pre}}}}}+\frac{\delta}{2}\right).
\displaystyle\mathcal{L}({f})\leq\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})+(%
32k^{2}{\kappa}^{2}+32k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{%
\rm{pre}}}/2}(\mathcal{F}_{i})+(4k{\kappa}^{2}+k^{2}{\kappa}^{4})\cdot\left(%
\sqrt{\frac{4\log 2/\delta}{{n_{\rm{pre}}}}}+\frac{\delta}{2}\right).
1-{\delta}/2
\widehat{\mathcal{X}}
f\in\mathcal{F}
\displaystyle\mathcal{L}({f})\geq\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})-(%
32k^{2}{\kappa}^{2}+32k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{%
\rm{pre}}}/2}(\mathcal{F}_{i})+(4k{\kappa}^{2}+k^{2}{\kappa}^{4})\cdot\left(%
\sqrt{\frac{4\log 2/\delta}{{n_{\rm{pre}}}}}+\frac{\delta}{2}\right).
\displaystyle\mathcal{L}({f})\geq\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})-(%
32k^{2}{\kappa}^{2}+32k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{%
\rm{pre}}}/2}(\mathcal{F}_{i})+(4k{\kappa}^{2}+k^{2}{\kappa}^{4})\cdot\left(%
\sqrt{\frac{4\log 2/\delta}{{n_{\rm{pre}}}}}+\frac{\delta}{2}\right).
1-\delta
\displaystyle\mathcal{L}({\hat{f}})\leq\mathcal{L}({f^{*}_{\mathcal{F}}})+(64k%
^{2}{\kappa}^{2}+64k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{\rm%
{pre}}}/2}(\mathcal{F}_{i})+(8k{\kappa}^{2}+2k^{2}{\kappa}^{4})\cdot\left(%
\sqrt{\frac{4\log 2/\delta}{{n_{\rm{pre}}}}}+\frac{\delta}{2}\right),
\displaystyle\mathcal{L}({\hat{f}})\leq\mathcal{L}({f^{*}_{\mathcal{F}}})+(64k%
^{2}{\kappa}^{2}+64k{\kappa})\cdot\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{\rm%
{pre}}}/2}(\mathcal{F}_{i})+(8k{\kappa}^{2}+2k^{2}{\kappa}^{4})\cdot\left(%
\sqrt{\frac{4\log 2/\delta}{{n_{\rm{pre}}}}}+\frac{\delta}{2}\right),
\hat{f}
\widehat{\mathcal{L}}_{{n_{\rm{pre}}}}({f})
\mathcal{F}
f^{*}_{\mathcal{F}}
\mathcal{L}({f})
\mathcal{F}
c_{1}=64k^{2}{\kappa}^{2}+64k{\kappa}
c_{2}=16k{\kappa}^{2}+4k^{2}{\kappa}^{4}
\max_{i\in[k]}\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F}_{i})=%
\widehat{\mathcal{R}}_{{n_{\rm{pre}}}/2}(\mathcal{F})
\mathcal{X}
\mathbb{R}^{d}
\left\lVert x\right\rVert_{2}\leq{C_{x}}
x\in\mathcal{X}
\mathcal{F}
l
\displaystyle\left\{x\rightarrow P_{{\kappa}}(W_{l}\sigma(W_{l-1}\sigma(\cdots%
\sigma(W_{1}x)))):\left\lVert W_{i}\right\rVert_{F}\leq{C_{w,i}}\right\}
\displaystyle\left\{x\rightarrow P_{{\kappa}}(W_{l}\sigma(W_{l-1}\sigma(\cdots%
\sigma(W_{1}x)))):\left\lVert W_{i}\right\rVert_{F}\leq{C_{w,i}}\right\}
\sigma(\cdot)
P_{{\kappa}}(\cdot)
[-{\kappa},{\kappa}]
{\kappa}>0
{C_{w,i}}
i
W_{l}
k
W_{1}
d
1-\delta
2{n_{\rm{pre}}}
\displaystyle\mathcal{L}({\hat{f}})\leq\mathcal{L}_{\mathcal{F}}^{*}+c_{1}%
\cdot\frac{{C_{x}}{C_{w}}\sqrt{l}}{\sqrt{{n_{\rm{pre}}}}}+c_{2}\cdot\left(%
\sqrt{\frac{\log 1/\delta}{{n_{\rm{pre}}}}}+{\delta}\right),
\displaystyle\mathcal{L}({\hat{f}})\leq\mathcal{L}_{\mathcal{F}}^{*}+c_{1}%
\cdot\frac{{C_{x}}{C_{w}}\sqrt{l}}{\sqrt{{n_{\rm{pre}}}}}+c_{2}\cdot\left(%
\sqrt{\frac{\log 1/\delta}{{n_{\rm{pre}}}}}+{\delta}\right),
\hat{f}
\widehat{\mathcal{L}}_{2{n_{\rm{pre}}}}({f})
\mathcal{F}
\mathcal{L}_{\mathcal{F}}^{*}
\mathcal{L}({f})
f\in\mathcal{F}
{C_{w}}:=\prod_{i=1}^{l}{C_{w,i}}
c_{1}\lesssim k^{2}{\kappa}^{2}+k{\kappa}
c_{2}\lesssim k{\kappa}^{2}+k^{2}{\kappa}^{4}
\displaystyle\mathcal{F}_{\textup{real}}\triangleq\left\{x\rightarrow\widehat{%
W}_{l}\sigma(W_{l-1}\sigma(\cdots\sigma(W_{1}x))):\left\lVert W_{i}\right%
\rVert_{F}\leq{C_{w,i}}\right\}
\displaystyle\mathcal{F}_{\textup{real}}\triangleq\left\{x\rightarrow\widehat{%
W}_{l}\sigma(W_{l-1}\sigma(\cdots\sigma(W_{1}x))):\left\lVert W_{i}\right%
\rVert_{F}\leq{C_{w,i}}\right\}
\sigma(\cdot)
{C_{w,i}}
i
W_{l}
k
\widehat{W}_{1}
\displaystyle\widehat{\mathcal{R}}_{{n_{\rm{pre}}}}\left(\mathcal{F}_{\textup{%
real}}\right)\leq\frac{{C_{x}}(\sqrt{2\log(2)l}+1){C_{w}}}{\sqrt{{n_{\rm{pre}}%
}}}.
\displaystyle\widehat{\mathcal{R}}_{{n_{\rm{pre}}}}\left(\mathcal{F}_{\textup{%
real}}\right)\leq\frac{{C_{x}}(\sqrt{2\log(2)l}+1){C_{w}}}{\sqrt{{n_{\rm{pre}}%
}}}.
\displaystyle\mathcal{F}_{\textup{real+proj}}\triangleq\left\{x\rightarrow P_{%
{\kappa}}(\widehat{W}_{l}\sigma(W_{l-1}\sigma(\cdots\sigma(W_{1}x)))):\left%
\lVert W_{i}\right\rVert_{F}\leq{C_{w,i}}\right\},
\displaystyle\mathcal{F}_{\textup{real+proj}}\triangleq\left\{x\rightarrow P_{%
{\kappa}}(\widehat{W}_{l}\sigma(W_{l-1}\sigma(\cdots\sigma(W_{1}x)))):\left%
\lVert W_{i}\right\rVert_{F}\leq{C_{w,i}}\right\},
P_{{\kappa}}(\cdot)
[-{C_{w}},{C_{w}}]
P_{{\kappa}}(\cdot)
1
\displaystyle\widehat{\mathcal{R}}_{{n_{\rm{pre}}}}\left(\mathcal{F}_{\textup{%
real+proj}}\right)\leq\frac{{C_{x}}(\sqrt{2\log(2)l}+1){C_{w}}}{\sqrt{{n_{\rm{%
pre}}}}}.
\displaystyle\widehat{\mathcal{R}}_{{n_{\rm{pre}}}}\left(\mathcal{F}_{\textup{%
real+proj}}\right)\leq\frac{{C_{x}}(\sqrt{2\log(2)l}+1){C_{w}}}{\sqrt{{n_{\rm{%
pre}}}}}.
i\in[k]
f_{i}:\mathcal{X}\rightarrow\mathbb{R}
f_{i}(x)
i
f(x)
\mathcal{F}_{i}
f_{i}
f\in\mathcal{F}
\mathcal{F}
\mathcal{F}_{i}=\mathcal{F}_{\textup{real+proj}}
i\in[k]
\displaystyle\mathcal{L}({\hat{f}})\leq\mathcal{L}_{\mathcal{F}}^{*}+c_{1}%
\cdot\frac{{C_{x}}(\sqrt{2\log(2)l}+1){C_{w}}}{\sqrt{{n_{\rm{pre}}}}}+c_{2}%
\cdot\left(\sqrt{\frac{\log 2/\delta}{{n_{\rm{pre}}}}}+{\delta}\right),
\displaystyle\mathcal{L}({\hat{f}})\leq\mathcal{L}_{\mathcal{F}}^{*}+c_{1}%
\cdot\frac{{C_{x}}(\sqrt{2\log(2)l}+1){C_{w}}}{\sqrt{{n_{\rm{pre}}}}}+c_{2}%
\cdot\left(\sqrt{\frac{\log 2/\delta}{{n_{\rm{pre}}}}}+{\delta}\right),
c_{1}
k\geq 4r+2
\alpha>0
\gamma_{i}
i
\epsilon>0
{\hat{f}_{\textup{emp}}}\in\mathcal{F}
\mathcal{L}({{\hat{f}_{\textup{emp}}}})<\mathcal{L}({{f^{*}_{\textup{pop}}}})+\epsilon
\displaystyle\mathcal{E}({\hat{f}_{\textup{emp}}})\lesssim\frac{\alpha}{\rho_{%
\lfloor k/2\rfloor}^{2}}\cdot\log k+\frac{k\epsilon}{\Delta_{\gamma}^{2}},
\displaystyle\mathcal{E}({\hat{f}_{\textup{emp}}})\lesssim\frac{\alpha}{\rho_{%
\lfloor k/2\rfloor}^{2}}\cdot\log k+\frac{k\epsilon}{\Delta_{\gamma}^{2}},
\Delta_{\gamma}:=\gamma_{\lfloor{3k}/4\rfloor}-\gamma_{k}
\lfloor{3k}/4\rfloor
k
\widehat{B}\in\mathbb{R}^{k\times r}
\displaystyle\left\lVert\widehat{{B}}\right\rVert_{F}\leq\frac{2(k+1)}{1-%
\lambda_{k}}.
\displaystyle\left\lVert\widehat{{B}}\right\rVert_{F}\leq\frac{2(k+1)}{1-%
\lambda_{k}}.
\epsilon
\hat{f}_{\textup{mf}}
\epsilon
\mathcal{L}_{\textup{mf}}
\displaystyle\mathcal{L}_{\textup{mf}}({\widehat{F}_{\textup{mf}}})\leq\min_{F%
}\mathcal{L}_{\textup{mf}}({F})+\epsilon,
\displaystyle\mathcal{L}_{\textup{mf}}({\widehat{F}_{\textup{mf}}})\leq\min_{F%
}\mathcal{L}_{\textup{mf}}({F})+\epsilon,
\widehat{F}_{\textup{mf}}
\hat{f}_{\textup{mf}}
\hat{f}
\epsilon
\mathcal{L}
\displaystyle\mathcal{L}({\hat{f}})\leq\min_{f}\mathcal{L}({f})+\epsilon.
\displaystyle\mathcal{L}({\hat{f}})\leq\min_{f}\mathcal{L}({f})+\epsilon.
\mathcal{X}
\lambda_{i}
i
\hat{f}\in\arg\min_{f:\mathcal{X}\rightarrow\mathbb{R}^{k}}
\epsilon
\mathcal{L}({f})
k\in\mathcal{Z}^{+}
\hat{y}:\mathcal{X}\rightarrow[r]
\widehat{{B}}\in\mathbb{R}^{r\times k}
\left\lVert\widehat{{B}}\right\rVert_{F}\leq\frac{2(k+1)}{1-\lambda_{k}}
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-%
\widehat{B}{\hat{f}_{\textup{emp}}}({x})\right\rVert_{2}^{2}\right]\lesssim%
\min_{1\leq k^{\prime}\leq k}\left(\frac{\phi^{\hat{y}}}{\lambda_{k^{\prime}+1%
}}+\frac{k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\right)+%
\Delta(y,\hat{y}),
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\left\lVert\vec{{y}}(\bar{x})-%
\widehat{B}{\hat{f}_{\textup{emp}}}({x})\right\rVert_{2}^{2}\right]\lesssim%
\min_{1\leq k^{\prime}\leq k}\left(\frac{\phi^{\hat{y}}}{\lambda_{k^{\prime}+1%
}}+\frac{k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\right)+%
\Delta(y,\hat{y}),
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq y(\bar{x})%
\right)\lesssim\min_{1\leq k^{\prime}\leq k}\left(\frac{\phi^{\hat{y}}}{%
\lambda_{k^{\prime}+1}}+\frac{k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{%
\prime}})^{2}}\right)+\Delta(y,\hat{y}),
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq y(\bar{x})%
\right)\lesssim\min_{1\leq k^{\prime}\leq k}\left(\frac{\phi^{\hat{y}}}{%
\lambda_{k^{\prime}+1}}+\frac{k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{%
\prime}})^{2}}\right)+\Delta(y,\hat{y}),
\phi^{\hat{y}}
\Delta(y,\hat{y})
k^{\prime}=\lfloor\frac{3}{4}k\rfloor
\hat{y}:\mathcal{X}\rightarrow[r]
\widehat{{B}}\in\mathbb{R}^{r\times k}
\displaystyle\Pr_{x\sim\mathcal{P}_{\overline{\mathcal{X}}},\tilde{x}\sim%
\mathcal{A}(\cdot|x)}\left(g_{\hat{f},\widehat{{B}}}(\tilde{x})\neq y(x)\right%
)\lesssim\frac{\phi^{\hat{y}}}{\lambda_{\lfloor\frac{3}{4}k\rfloor+1}}+\frac{k%
\epsilon}{(\lambda_{k+1}-\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}+\Delta(y,%
\hat{y}).
\displaystyle\Pr_{x\sim\mathcal{P}_{\overline{\mathcal{X}}},\tilde{x}\sim%
\mathcal{A}(\cdot|x)}\left(g_{\hat{f},\widehat{{B}}}(\tilde{x})\neq y(x)\right%
)\lesssim\frac{\phi^{\hat{y}}}{\lambda_{\lfloor\frac{3}{4}k\rfloor+1}}+\frac{k%
\epsilon}{(\lambda_{k+1}-\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}+\Delta(y,%
\hat{y}).
S_{1},S_{2},\cdots,S_{r}
\mathcal{X}
g
\hat{y}:\mathcal{X}\rightarrow[r]
x\in\mathcal{X}
\hat{y}(x)
x
x\in S_{\hat{y}(x)}
\phi^{\hat{y}}\leq 2\alpha
\Delta(y,\hat{y})\leq\alpha
(1+\zeta)t=\lfloor\frac{3}{4}k\rfloor+1
t=\lfloor\frac{k}{2}\rfloor
\zeta\geq 0.5
S_{1},\cdots,S_{\lfloor\frac{k}{2}\rfloor}\subset\mathcal{X}
\phi_{G}(S_{i})\lesssim\sqrt{\lambda_{\lfloor\frac{3}{4}k\rfloor+1}\log{(k)}}
\forall i\in[\lfloor\frac{k}{2}\rfloor]
\rho_{\lfloor\frac{k}{2}\rfloor}\lesssim\sqrt{\lambda_{\lfloor\frac{3}{4}k%
\rfloor+1}\log{(k)}}
\frac{1}{\lambda_{\lfloor\frac{3}{4}k\rfloor+1}}\lesssim\frac{log(k)}{\rho_{%
\lfloor\frac{k}{2}\rfloor}^{2}}
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq y(\bar{x})%
\right)\lesssim\frac{\alpha}{\rho_{\lfloor\frac{k}{2}\rfloor}^{2}}\cdot\log(k)%
+\frac{k\epsilon}{(\lambda_{k+1}-\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq y(\bar{x})\right)
\displaystyle\lesssim\frac{\alpha}{\rho_{\lfloor\frac{k}{2}\rfloor}^{2}}\cdot%
\log(k)+\frac{k\epsilon}{(\lambda_{k+1}-\lambda_{\lfloor\frac{3}{4}k\rfloor})^%
{2}}
\displaystyle\lesssim\frac{\alpha}{\rho_{\lfloor\frac{k}{2}\rfloor}^{2}}\cdot%
\log(k)+\frac{k\epsilon}{(\lambda_{k}-\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2%
}}.
\displaystyle\lesssim\frac{\alpha}{\rho_{\lfloor\frac{k}{2}\rfloor}^{2}}\cdot%
\log(k)+\frac{k\epsilon}{(\lambda_{k}-\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2%
}}.
\bar{g}_{\hat{f},\widehat{{B}}}(\bar{x})\neq y(\bar{x})
\bar{x}
y(\bar{x})
\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}}}\left(\bar{g}_{\hat{f},%
\widehat{{B}}}\neq y(\bar{x})\right)\leq 2\Pr_{\bar{x}\sim\mathcal{P}_{%
\overline{\mathcal{X}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},%
\widehat{{B}}}({x})\neq y(\bar{x})\right)
{f}:\mathcal{X}\rightarrow\mathbb{R}^{k}
{{F}}\in\mathbb{R}^{N\times k}
x
\sqrt{w_{x}}\cdot{f}(x)
{{F}}
\epsilon
\mathcal{L}_{\textup{mf}}({{F}})
f
\epsilon
\mathcal{L}({f})
\epsilon
\mathcal{L}_{\textup{mf}}
\lambda_{i}
i
\mathcal{L}
{v}_{i}
F\in\mathbb{R}^{N\times k}
\epsilon
\mathcal{L}_{\textup{mf}}
\Pi_{f}{v}_{i}
{v}_{i}
F
b\in\mathbb{R}^{k}
\left\lVert b\right\rVert\leq\left\lVert F\right\rVert_{F}/(1-\lambda_{i})
\displaystyle\left\lVert\Pi_{f}{v}_{i}-Fb\right\rVert_{2}^{2}\leq\frac{%
\epsilon}{(1-\lambda_{i})^{2}}.
\displaystyle\left\lVert\Pi_{f}{v}_{i}-Fb\right\rVert_{2}^{2}\leq\frac{%
\epsilon}{(1-\lambda_{i})^{2}}.
F
\displaystyle\left\lVert F\right\rVert^{2}_{F}\leq 2(k+\epsilon).
\displaystyle\left\lVert F\right\rVert^{2}_{F}\leq 2(k+\epsilon).
\overline{A}-\Pi_{f}\overline{A}
\Pi_{f}\overline{A}-FF^{\top}
\displaystyle\left\lVert\overline{A}-FF^{\top}\right\rVert_{F}^{2}=\left\lVert%
\overline{A}-\Pi_{f}\overline{A}\right\rVert_{F}^{2}+\left\lVert\Pi_{f}%
\overline{A}-FF^{\top}\right\rVert_{F}^{2}.
\displaystyle\left\lVert\overline{A}-FF^{\top}\right\rVert_{F}^{2}
\displaystyle=\left\lVert\overline{A}-\Pi_{f}\overline{A}\right\rVert_{F}^{2}+%
\left\lVert\Pi_{f}\overline{A}-FF^{\top}\right\rVert_{F}^{2}.
\Pi_{f}\overline{A}
k
\left\lVert\overline{A}-\Pi_{f}\overline{A}\right\rVert_{F}^{2}\geq\min_{F}%
\mathcal{L}_{\textup{mf}}({F})
\epsilon
\left\lVert\overline{A}-FF^{\top}\right\rVert_{F}^{2}\leq\min_{F}\mathcal{L}_{%
\textup{mf}}({F})+\epsilon
\displaystyle\left\lVert\Pi_{f}\overline{A}-FF^{\top}\right\rVert_{F}^{2}\leq\epsilon.
\displaystyle\left\lVert\Pi_{f}\overline{A}-FF^{\top}\right\rVert_{F}^{2}\leq\epsilon.
\overline{A}=\sum_{i=1}^{N}(1-\lambda_{i})v_{i}v_{i}^{\top}
v_{i}=\frac{1}{1-\lambda_{i}}\overline{A}{v}_{i}
\displaystyle\Pi_{f}{v}_{i}=\frac{1}{1-\lambda_{i}}\Pi_{f}(\overline{A}v_{i})=%
\frac{1}{1-\lambda_{i}}FF^{\top}v_{i}+\frac{1}{1-\lambda_{i}}(\Pi_{f}\overline%
{A}-FF^{\top})v_{i}.
\displaystyle\Pi_{f}{v}_{i}=\frac{1}{1-\lambda_{i}}\Pi_{f}(\overline{A}v_{i})=%
\frac{1}{1-\lambda_{i}}FF^{\top}v_{i}+\frac{1}{1-\lambda_{i}}(\Pi_{f}\overline%
{A}-FF^{\top})v_{i}.
b=\frac{1}{1-\lambda_{i}}F^{\top}v_{i}
\displaystyle\left\lVert\Pi_{f}v_{i}-Fb\right\rVert_{2}^{2}=\frac{1}{(1-%
\lambda_{i})^{2}}\left\lVert(\Pi_{f}\overline{A}-FF^{\top})v_{i}\right\rVert_{%
2}^{2}
\displaystyle\left\lVert\Pi_{f}v_{i}-Fb\right\rVert_{2}^{2}
\displaystyle=\frac{1}{(1-\lambda_{i})^{2}}\left\lVert(\Pi_{f}\overline{A}-FF^%
{\top})v_{i}\right\rVert_{2}^{2}
\displaystyle\leq\frac{1}{(1-\lambda_{i})^{2}}\left\lVert\Pi_{f}\overline{A}-%
FF^{\top}\right\rVert_{F}^{2}
\displaystyle\leq\frac{1}{(1-\lambda_{i})^{2}}\left\lVert\Pi_{f}\overline{A}-%
FF^{\top}\right\rVert_{F}^{2}
\displaystyle\leq\frac{\epsilon}{(1-\lambda_{i})^{2}}.
\displaystyle\leq\frac{\epsilon}{(1-\lambda_{i})^{2}}.
F
\displaystyle\left\lVert\Pi_{f}\overline{A}\right\rVert_{F}^{2}=\operatorname{%
Tr}(\overline{A}^{2}\Pi_{f})\leq\operatorname{Tr}(\Pi_{f})=k,
\displaystyle\left\lVert\Pi_{f}\overline{A}\right\rVert_{F}^{2}=\operatorname{%
Tr}(\overline{A}^{2}\Pi_{f})\leq\operatorname{Tr}(\Pi_{f})=k,
\overline{A}^{2}
1
\left\lVert\Pi_{f}\overline{A}-FF^{\top}\right\rVert_{F}^{2}\leq\epsilon
\displaystyle\left\lVert FF^{\top}\right\rVert_{F}\leq\sqrt{k}+\sqrt{\epsilon}.
\displaystyle\left\lVert FF^{\top}\right\rVert_{F}\leq\sqrt{k}+\sqrt{\epsilon}.
FF^{\top}
k
FF^{\top}=U\Sigma U^{\top}
U\in\mathbb{R}^{N\times k}
\Sigma\in\mathbb{R}{k\times k}
\displaystyle\left\lVert F\right\rVert_{F}^{2}=\operatorname{Tr}(FF^{\top})=%
\operatorname{Tr}(\Sigma)\leq\sqrt{k}\sqrt{\operatorname{Tr}(\Sigma^{2})}=%
\sqrt{k}\left\lVert FF^{\top}\right\rVert_{F}\leq k+\sqrt{k\epsilon}\leq 2(k+%
\epsilon).
\displaystyle\left\lVert F\right\rVert_{F}^{2}=\operatorname{Tr}(FF^{\top})=%
\operatorname{Tr}(\Sigma)\leq\sqrt{k}\sqrt{\operatorname{Tr}(\Sigma^{2})}=%
\sqrt{k}\left\lVert FF^{\top}\right\rVert_{F}\leq k+\sqrt{k\epsilon}\leq 2(k+%
\epsilon).
\lambda_{i}
i
\mathcal{L}
{v}_{i}
F\in\mathbb{R}^{N\times k}
\epsilon
\mathcal{L}_{\textup{mf}}
\Pi_{f}^{\perp}{v}_{i}
{v}_{i}
F
i\leq k
\displaystyle\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}\leq\frac{%
\epsilon}{(\lambda_{k+1}-\lambda_{i})^{2}}.
\displaystyle\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}\leq\frac{%
\epsilon}{(\lambda_{k+1}-\lambda_{i})^{2}}.
\overline{A}=I-L
\overline{A}_{i}
i
\overline{A}
\widehat{A}
FF^{\top}
\widehat{A}_{i}
i
\widehat{A}
z_{1},\cdots,z_{k}
F
\widehat{A}
F
\widehat{A}
span\{z_{1},\cdots,z_{k}\}
z_{k+1},\cdots,z_{N}
z_{1},\cdots,z_{k}
\mathbb{R}^{N}
\Pi_{f}
\Pi_{f}^{\perp}
\sum_{j=1}^{k}z_{j}z_{j}^{\top}
\sum_{j=k+1}^{N}z_{j}z_{j}^{\top}
v\in\mathbb{R}^{N}
\Pi_{f}v
\Pi_{f}^{\perp}v
v
F
\mathcal{L}_{\textup{mf}}({F})
\displaystyle\mathcal{L}_{\textup{mf}}({F})=\left\lVert\overline{A}-\widehat{A%
}\right\rVert_{F}^{2}=\sum_{j=1}^{N}\left\lVert\overline{A}_{j}-\widehat{A}_{j%
}\right\rVert_{2}^{2}\geq\sum_{j=1}^{N}\left\lVert\overline{A}_{j}-\Pi_{f}%
\overline{A}_{j}\right\rVert_{2}^{2}
\displaystyle\mathcal{L}_{\textup{mf}}({F})
\displaystyle=\left\lVert\overline{A}-\widehat{A}\right\rVert_{F}^{2}=\sum_{j=%
1}^{N}\left\lVert\overline{A}_{j}-\widehat{A}_{j}\right\rVert_{2}^{2}\geq\sum_%
{j=1}^{N}\left\lVert\overline{A}_{j}-\Pi_{f}\overline{A}_{j}\right\rVert_{2}^{2}
\displaystyle=\sum_{j=1}^{N}\left\lVert\overline{A}_{j}-\left(\sum_{t=1}^{k}z_%
{t}z_{t}^{\top}\right)\overline{A}_{j}\right\rVert_{2}^{2}=\sum_{j=1}^{N}\left%
\lVert\left(\sum_{t=k+1}^{N}z_{t}z_{t}^{\top}\right)\overline{A}_{j}\right%
\rVert_{2}^{2}
\displaystyle=\sum_{j=1}^{N}\left\lVert\overline{A}_{j}-\left(\sum_{t=1}^{k}z_%
{t}z_{t}^{\top}\right)\overline{A}_{j}\right\rVert_{2}^{2}=\sum_{j=1}^{N}\left%
\lVert\left(\sum_{t=k+1}^{N}z_{t}z_{t}^{\top}\right)\overline{A}_{j}\right%
\rVert_{2}^{2}
\displaystyle=\left\lVert\left(\sum_{t=k+1}^{N}z_{t}z_{t}^{\top}\right)%
\overline{A}\right\rVert_{F}^{2}=\left\lVert\Pi_{f}^{\perp}\overline{A}\right%
\rVert_{F}^{2}.
\displaystyle=\left\lVert\left(\sum_{t=k+1}^{N}z_{t}z_{t}^{\top}\right)%
\overline{A}\right\rVert_{F}^{2}=\left\lVert\Pi_{f}^{\perp}\overline{A}\right%
\rVert_{F}^{2}.
\mathcal{L}_{\textup{mf}}({F})
\widehat{A}_{j}
z_{1},\cdots,z_{k}
\Pi_{f}\overline{A}_{j}
\overline{A}_{j}
z_{1},\cdots z_{d}
\Pi_{f}^{\perp}
\displaystyle\left\lVert\Pi_{f}^{\perp}\overline{A}\right\rVert_{F}^{2}=Tr%
\left(\overline{A}^{\top}{\Pi_{f}^{\perp}}^{\top}\Pi_{f}^{\perp}\overline{A}%
\right)=Tr\left(\overline{A}^{\top}\Pi_{f}^{\perp}\overline{A}\right)=Tr\left(%
\overline{A}\overline{A}^{\top}\Pi_{f}^{\perp}\right).
\displaystyle\left\lVert\Pi_{f}^{\perp}\overline{A}\right\rVert_{F}^{2}=Tr%
\left(\overline{A}^{\top}{\Pi_{f}^{\perp}}^{\top}\Pi_{f}^{\perp}\overline{A}%
\right)=Tr\left(\overline{A}^{\top}\Pi_{f}^{\perp}\overline{A}\right)=Tr\left(%
\overline{A}\overline{A}^{\top}\Pi_{f}^{\perp}\right).
\displaystyle\mathcal{L}_{\textup{mf}}({F})\geq Tr\left(\overline{A}\overline{%
A}^{\top}\Pi_{f}^{\perp}\right)=Tr\left(\sum_{j=1}^{N}(1-\lambda_{j})^{2}{v}_{%
j}{v}_{j}^{\top}\sum_{t=k+1}^{N}z_{t}z_{t}^{\top}\right)=\sum_{j=1}^{N}\sum_{t%
=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{j},z_{t}\rangle^{2}.
\displaystyle\mathcal{L}_{\textup{mf}}({F})\geq Tr\left(\overline{A}\overline{%
A}^{\top}\Pi_{f}^{\perp}\right)=Tr\left(\sum_{j=1}^{N}(1-\lambda_{j})^{2}{v}_{%
j}{v}_{j}^{\top}\sum_{t=k+1}^{N}z_{t}z_{t}^{\top}\right)=\sum_{j=1}^{N}\sum_{t%
=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{j},z_{t}\rangle^{2}.
S_{j}\triangleq\sum_{t=1}^{j}\sum_{l=k+1}^{d}\langle{v}_{t},z_{l}\rangle^{2}
j\in[N]
\lambda_{d+1}=1
\displaystyle\sum_{j=1}^{N}\sum_{t=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{j},z%
_{t}\rangle^{2}=\sum_{j=1}^{N}\left((1-\lambda_{j})^{2}-(1-\lambda_{j+1})^{2}%
\right)S_{j}.
\displaystyle\sum_{j=1}^{N}\sum_{t=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{j},z%
_{t}\rangle^{2}=\sum_{j=1}^{N}\left((1-\lambda_{j})^{2}-(1-\lambda_{j+1})^{2}%
\right)S_{j}.
S_{j}\geq 0
i\leq j\leq k
S_{j}\geq\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}
\displaystyle\sum_{j=1}^{N}\sum_{t=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{j},z%
_{t}\rangle^{2}\geq\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\sum_{j=k+1}^{N}\left((1-%
\lambda_{j})^{2}-(1-\lambda_{j+1})^{2}\right)S_{j},
\displaystyle\sum_{j=1}^{N}\sum_{t=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{j},z%
_{t}\rangle^{2}\geq\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\sum_{j=k+1}^{N}\left((1-%
\lambda_{j})^{2}-(1-\lambda_{j+1})^{2}\right)S_{j},
S_{j}
0
j<k
S_{j}
\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}
i\leq j\leq k
S_{j}
j\geq k+1
\displaystyle S_{N}=\sum_{t=1}^{N}\sum_{l=k+1}^{N}\langle{v}_{t},z_{l}\rangle^%
{2}=\sum_{l=k+1}^{N}\sum_{t=1}^{N}\langle{v}_{t},z_{l}\rangle^{2}=\sum_{l=k+1}%
^{N}\left\lVert z_{l}\right\rVert_{2}^{2}=N-k,
\displaystyle S_{N}=\sum_{t=1}^{N}\sum_{l=k+1}^{N}\langle{v}_{t},z_{l}\rangle^%
{2}=\sum_{l=k+1}^{N}\sum_{t=1}^{N}\langle{v}_{t},z_{l}\rangle^{2}=\sum_{l=k+1}%
^{N}\left\lVert z_{l}\right\rVert_{2}^{2}=N-k,
\displaystyle S_{j+1}-S_{j}=\sum_{l=k+1}^{N}\langle{v}_{j+1},z_{l}\rangle^{2}%
\leq\sum_{l=1}^{N}\langle{v}_{j+1},z_{l}\rangle^{2}=1,
\displaystyle S_{j+1}-S_{j}=\sum_{l=k+1}^{N}\langle{v}_{j+1},z_{l}\rangle^{2}%
\leq\sum_{l=1}^{N}\langle{v}_{j+1},z_{l}\rangle^{2}=1,
S_{j}\geq j-k
j\geq k+1
\displaystyle\ \ \sum_{j=1}^{N}\sum_{t=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{%
j},z_{t}\rangle^{2}
\displaystyle\ \ \sum_{j=1}^{N}\sum_{t=k+1}^{N}(1-\lambda_{j})^{2}\langle{v}_{%
j},z_{t}\rangle^{2}
\displaystyle\geq\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\sum_{j=k+1}^{N}\left((1-%
\lambda_{j})^{2}-(1-\lambda_{j+1})^{2}\right)(j-k)
\displaystyle\geq\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\sum_{j=k+1}^{N}\left((1-%
\lambda_{j})^{2}-(1-\lambda_{j+1})^{2}\right)(j-k)
\displaystyle=\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\sum_{j=k+1}^{N}(1-\lambda_{j%
})^{2}
\displaystyle=\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\sum_{j=k+1}^{N}(1-\lambda_{j%
})^{2}
\displaystyle=\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\min_{F\in\mathbb{R}^{N\times
k%
}}\mathcal{L}_{\textup{mf}}({F}),
\displaystyle=\left((1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}\right)\left%
\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}+\min_{F\in\mathbb{R}^{N\times
k%
}}\mathcal{L}_{\textup{mf}}({F}),
\displaystyle\mathcal{L}_{\textup{mf}}({F})\geq\left((1-\lambda_{i})^{2}-(1-%
\lambda_{k+1})^{2}\right)\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}%
+\min_{F\in\mathbb{R}^{N\times k}}\mathcal{L}_{\textup{mf}}({F}),
\displaystyle\mathcal{L}_{\textup{mf}}({F})\geq\left((1-\lambda_{i})^{2}-(1-%
\lambda_{k+1})^{2}\right)\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}%
+\min_{F\in\mathbb{R}^{N\times k}}\mathcal{L}_{\textup{mf}}({F}),
\displaystyle\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}\leq\frac{%
\epsilon}{(1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}}\leq\frac{\epsilon}{(%
\lambda_{k+1}-\lambda_{i})^{2}}.
\displaystyle\left\lVert\Pi_{f}^{\perp}{v}_{i}\right\rVert_{2}^{2}\leq\frac{%
\epsilon}{(1-\lambda_{i})^{2}-(1-\lambda_{k+1})^{2}}\leq\frac{\epsilon}{(%
\lambda_{k+1}-\lambda_{i})^{2}}.
\mathcal{L}
G=(\mathcal{X},w)
|\mathcal{X}|=N
f:\mathcal{X}\rightarrow\mathbb{R}^{k}
\epsilon
\mathcal{L}_{\textup{mf}}({f})
F
f
F_{i}
i
F
R({u}):=\frac{{u}^{\top}\mathcal{L}{u}}{{u}^{\top}{u}}
{u}\in\mathbb{R}^{N}
k\in\mathcal{Z}^{+}
k<N
{{b}}\in\mathbb{R}^{k}
\displaystyle\left\lVert{u}-Fb\right\rVert_{2}^{2}\leq\min_{1\leq k^{\prime}%
\leq k}\left(\frac{3R(u)}{\lambda_{k^{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(%
\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\right)\left\lVert u\right\rVert_{2}^{%
2}.
\displaystyle\left\lVert{u}-Fb\right\rVert_{2}^{2}\leq\min_{1\leq k^{\prime}%
\leq k}\left(\frac{3R(u)}{\lambda_{k^{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(%
\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\right)\left\lVert u\right\rVert_{2}^{%
2}.
b
\displaystyle\left\lVert b\right\rVert_{2}\leq\frac{2(k+1)}{1-\lambda_{k}}%
\left\lVert u\right\rVert_{2}.
\displaystyle\left\lVert b\right\rVert_{2}\leq\frac{2(k+1)}{1-\lambda_{k}}%
\left\lVert u\right\rVert_{2}.
k^{\prime}
p_{v}(u)
u
{v}_{1},\cdots,{v}_{k^{\prime}}
p_{v}(u)=\sum_{i=1}^{k^{\prime}}\rho_{i}{v}_{i}
i\in[k^{\prime}]
b_{i}
b=\sum_{i=1}^{k^{\prime}}\rho_{i}b_{i}
p_{{v},f}(u)
p_{v}(u)
f_{1},\cdots,f_{k}
\displaystyle\left\lVert u-Fb\right\rVert_{2}^{2}\leq 3\left\lVert u-p_{v}(u)%
\right\rVert_{2}^{2}+3\left\lVert p_{v}(u)-p_{{v},f}(u)\right\rVert_{2}^{2}+3%
\left\lVert p_{{v},f}(u)-Fb\right\rVert_{2}^{2}.
\displaystyle\left\lVert u-Fb\right\rVert_{2}^{2}\leq 3\left\lVert u-p_{v}(u)%
\right\rVert_{2}^{2}+3\left\lVert p_{v}(u)-p_{{v},f}(u)\right\rVert_{2}^{2}+3%
\left\lVert p_{{v},f}(u)-Fb\right\rVert_{2}^{2}.
\displaystyle\left\lVert u-p_{v}(u)\right\rVert_{2}^{2}\leq\frac{R(u)}{\lambda%
_{k^{\prime}+1}}\left\lVert u\right\rVert_{2}^{2}.
\displaystyle\left\lVert u-p_{v}(u)\right\rVert_{2}^{2}\leq\frac{R(u)}{\lambda%
_{k^{\prime}+1}}\left\lVert u\right\rVert_{2}^{2}.
\displaystyle\left\lVert p_{v}(u)-p_{{v}f}(u)\right\rVert_{2}^{2}=\left\lVert%
\Pi_{f}^{\perp}p_{v}(u)\right\rVert_{2}^{2}
\displaystyle\left\lVert p_{v}(u)-p_{{v}f}(u)\right\rVert_{2}^{2}
\displaystyle=\left\lVert\Pi_{f}^{\perp}p_{v}(u)\right\rVert_{2}^{2}
\displaystyle=\left\lVert\sum_{i=1}^{k^{\prime}}\Pi_{f}^{\perp}{v}_{i}{v}_{i}^%
{\top}u\right\rVert_{2}^{2}
\displaystyle=\left\lVert\sum_{i=1}^{k^{\prime}}\Pi_{f}^{\perp}{v}_{i}{v}_{i}^%
{\top}u\right\rVert_{2}^{2}
\displaystyle\leq\left(\sum_{i=1}^{k^{\prime}}\left\lVert\Pi_{f}^{\perp}{v}_{i%
}\right\rVert_{2}^{2}\right)\cdot\left(\sum_{i=1}^{k^{\prime}}({v}_{i}^{\top}u%
)^{2}\right)
\displaystyle\leq\left(\sum_{i=1}^{k^{\prime}}\left\lVert\Pi_{f}^{\perp}{v}_{i%
}\right\rVert_{2}^{2}\right)\cdot\left(\sum_{i=1}^{k^{\prime}}({v}_{i}^{\top}u%
)^{2}\right)
\displaystyle\leq\frac{k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}}%
)^{2}}\left\lVert u\right\rVert_{2}^{2},
\displaystyle\leq\frac{k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}}%
)^{2}}\left\lVert u\right\rVert_{2}^{2},
\displaystyle\left\lVert p_{{v},f}(u)-Fb\right\rVert_{2}^{2}=\left\lVert\sum_{%
i=1}^{k^{\prime}}\rho_{i}(\Pi_{f}v_{i}-Fb_{i})\right\rVert_{2}^{2}
\displaystyle\left\lVert p_{{v},f}(u)-Fb\right\rVert_{2}^{2}
\displaystyle=\left\lVert\sum_{i=1}^{k^{\prime}}\rho_{i}(\Pi_{f}v_{i}-Fb_{i})%
\right\rVert_{2}^{2}
\displaystyle\leq k^{\prime}\sum_{i=1}^{k^{\prime}}\rho_{i}^{2}\left\lVert\Pi_%
{f}v_{i}-Fb_{i}\right\rVert_{2}^{2}
\displaystyle\leq k^{\prime}\sum_{i=1}^{k^{\prime}}\rho_{i}^{2}\left\lVert\Pi_%
{f}v_{i}-Fb_{i}\right\rVert_{2}^{2}
\displaystyle\leq\frac{k^{\prime}\epsilon}{(1-\lambda_{k^{\prime}})^{2}}\left%
\lVert u\right\rVert_{2}^{2},
\displaystyle\leq\frac{k^{\prime}\epsilon}{(1-\lambda_{k^{\prime}})^{2}}\left%
\lVert u\right\rVert_{2}^{2},
b
\displaystyle\left\lVert b\right\rVert_{2}^{2}=\left\lVert\sum_{i=1}^{k^{%
\prime}}\rho_{i}b_{i}\right\rVert_{2}^{2}\leq k^{\prime}\sum_{i=1}^{k^{\prime}%
}\rho_{i}^{2}\left\lVert b_{i}\right\rVert_{2}^{2}\leq\frac{k^{\prime}\left%
\lVert u\right\rVert_{2}^{2}}{(1-\lambda_{k^{\prime}})^{2}}\left\lVert F\right%
\rVert_{F}^{2}\leq\frac{2k^{\prime}(k+1)}{(1-\lambda_{k^{\prime}})^{2}}\left%
\lVert u\right\rVert_{2}^{2}.
\displaystyle\left\lVert b\right\rVert_{2}^{2}=\left\lVert\sum_{i=1}^{k^{%
\prime}}\rho_{i}b_{i}\right\rVert_{2}^{2}\leq k^{\prime}\sum_{i=1}^{k^{\prime}%
}\rho_{i}^{2}\left\lVert b_{i}\right\rVert_{2}^{2}\leq\frac{k^{\prime}\left%
\lVert u\right\rVert_{2}^{2}}{(1-\lambda_{k^{\prime}})^{2}}\left\lVert F\right%
\rVert_{F}^{2}\leq\frac{2k^{\prime}(k+1)}{(1-\lambda_{k^{\prime}})^{2}}\left%
\lVert u\right\rVert_{2}^{2}.
\widehat{F}\in\mathbb{R}^{N\times k}
x
\sqrt{w_{x}}\cdot\hat{f}(x)
\widehat{F}
\epsilon
\mathcal{L}_{\textup{mf}}({F})
i\in[r]
u_{i}(x)=\mathbbm{1}\left[\hat{y}(x)=i\right]\cdot\sqrt{w_{x}}
u:\mathcal{X}\rightarrow\mathbb{R}^{k}
u(x)
u_{i}
i
b_{i}\in\mathbb{R}^{k}
\displaystyle\left\lVert u_{i}-\widehat{F}b_{i}\right\rVert_{2}^{2}\leq\min_{1%
\leq k^{\prime}\leq k}\left(\frac{3R(u_{i})}{\lambda_{k^{\prime}+1}}+\frac{6k^%
{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\right)\left\lVert u%
_{i}\right\rVert_{2}^{2}
\displaystyle\left\lVert u_{i}-\widehat{F}b_{i}\right\rVert_{2}^{2}\leq\min_{1%
\leq k^{\prime}\leq k}\left(\frac{3R(u_{i})}{\lambda_{k^{\prime}+1}}+\frac{6k^%
{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\right)\left\lVert u%
_{i}\right\rVert_{2}^{2}
U=[u_{1},\cdots,u_{r}]
\widehat{B}^{\top}=[b_{1},\cdots,b_{r}]
i\in[r]
\displaystyle\left\lVert U-\widehat{F}\widehat{B}^{\top}\right\rVert_{F}^{2}%
\leq\sum_{i=1}^{r}\min_{1\leq k^{\prime}\leq k}\left(\frac{3R(u_{i})}{\lambda_%
{k^{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}}%
)^{2}}\right)\left\lVert u_{i}\right\rVert_{2}^{2}
\displaystyle\left\lVert U-\widehat{F}\widehat{B}^{\top}\right\rVert_{F}^{2}
\displaystyle\leq\sum_{i=1}^{r}\min_{1\leq k^{\prime}\leq k}\left(\frac{3R(u_{%
i})}{\lambda_{k^{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda%
_{k^{\prime}})^{2}}\right)\left\lVert u_{i}\right\rVert_{2}^{2}
\displaystyle\leq\min_{1\leq k^{\prime}\leq k}\sum_{i=1}^{r}\left(\frac{3R(u_{%
i})}{\lambda_{k^{\prime}+1}}\left\lVert u_{i}\right\rVert_{2}^{2}+\frac{6k^{%
\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\left\lVert u_{i}%
\right\rVert_{2}^{2}\right).
\displaystyle\leq\min_{1\leq k^{\prime}\leq k}\sum_{i=1}^{r}\left(\frac{3R(u_{%
i})}{\lambda_{k^{\prime}+1}}\left\lVert u_{i}\right\rVert_{2}^{2}+\frac{6k^{%
\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2}}\left\lVert u_{i}%
\right\rVert_{2}^{2}\right).
\displaystyle\sum_{i=1}^{r}R(u_{i})\left\lVert u_{i}\right\rVert_{2}^{2}=\sum_%
{i=1}^{r}\frac{1}{2}\phi_{i}^{\hat{y}}\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm%
{1}\left[\hat{y}(x)=i\right]
\displaystyle\sum_{i=1}^{r}R(u_{i})\left\lVert u_{i}\right\rVert_{2}^{2}
\displaystyle=\sum_{i=1}^{r}\frac{1}{2}\phi_{i}^{\hat{y}}\sum_{x\in\mathcal{X}%
}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]
\displaystyle=\frac{1}{2}\sum_{i=1}^{r}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^%
{\prime}}\cdot\mathbbm{1}\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)%
\text{ or }(\hat{y}(x)\neq i\land\hat{y}(x^{\prime})=i)\right]
\displaystyle=\frac{1}{2}\sum_{i=1}^{r}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^%
{\prime}}\cdot\mathbbm{1}\left[(\hat{y}(x)=i\land\hat{y}(x^{\prime})\neq i)%
\text{ or }(\hat{y}(x)\neq i\land\hat{y}(x^{\prime})=i)\right]
\displaystyle=\frac{1}{2}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot%
\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]=\frac{1}{2}\phi^{%
\hat{y}},
\displaystyle=\frac{1}{2}\sum_{x,x^{\prime}\in\mathcal{X}}w_{xx^{\prime}}\cdot%
\mathbbm{1}\left[\hat{y}(x)\neq\hat{y}(x^{\prime})\right]=\frac{1}{2}\phi^{%
\hat{y}},
\displaystyle\sum_{i=1}^{r}\left\lVert u_{i}\right\rVert_{2}^{2}=\sum_{i=1}^{r%
}\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]=\sum_{x%
\in\mathcal{X}}w_{x}=1.
\displaystyle\sum_{i=1}^{r}\left\lVert u_{i}\right\rVert_{2}^{2}=\sum_{i=1}^{r%
}\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[\hat{y}(x)=i\right]=\sum_{x%
\in\mathcal{X}}w_{x}=1.
\displaystyle\left\lVert U-\widehat{F}\widehat{B}^{\top}\right\rVert_{F}^{2}%
\leq\min_{1\leq k^{\prime}\leq k}\left(\frac{3\phi^{\hat{y}}}{2\lambda_{k^{%
\prime}+1}}+\frac{3k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2%
}}\right).
\displaystyle\left\lVert U-\widehat{F}\widehat{B}^{\top}\right\rVert_{F}^{2}%
\leq\min_{1\leq k^{\prime}\leq k}\left(\frac{3\phi^{\hat{y}}}{2\lambda_{k^{%
\prime}+1}}+\frac{3k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{2%
}}\right).
u(x)
g_{\hat{f},\widehat{B}}(x)\neq\hat{y}(x)
\left\lVert u(x)-\widehat{B}\hat{f}(x)\right\rVert_{2}^{2}\geq\frac{w_{x}}{2}
\displaystyle\sum_{x\in\mathcal{X}}\frac{1}{2}w_{x}\cdot\mathbbm{1}\left[g_{%
\hat{f},\widehat{B}}(x)\neq\hat{y}(x)\right]\leq\sum_{x\in\mathcal{X}}\left%
\lVert u(x)-\widehat{B}\hat{f}(x)\right\rVert_{2}^{2}=\left\lVert U-\widehat{F%
}\widehat{B}^{\top}\right\rVert_{F}^{2}.
\displaystyle\sum_{x\in\mathcal{X}}\frac{1}{2}w_{x}\cdot\mathbbm{1}\left[g_{%
\hat{f},\widehat{B}}(x)\neq\hat{y}(x)\right]\leq\sum_{x\in\mathcal{X}}\left%
\lVert u(x)-\widehat{B}\hat{f}(x)\right\rVert_{2}^{2}=\left\lVert U-\widehat{F%
}\widehat{B}^{\top}\right\rVert_{F}^{2}.
\mathcal{X}
\displaystyle\Pr_{x\sim\mathcal{X}}(g_{\hat{f},\widehat{B}}(x)\neq\hat{y}(x))=%
\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[g_{\hat{f},\widehat{B}}(x)%
\neq\hat{y}(x)\right]
\displaystyle\Pr_{x\sim\mathcal{X}}(g_{\hat{f},\widehat{B}}(x)\neq\hat{y}(x))=%
\sum_{x\in\mathcal{X}}w_{x}\cdot\mathbbm{1}\left[g_{\hat{f},\widehat{B}}(x)%
\neq\hat{y}(x)\right]
\displaystyle\leq 2\cdot\left\lVert U-\hat{f}\widehat{B}^{\top}\right\rVert_{F%
}^{2}\leq\min_{1\leq k^{\prime}\leq k}\left(\frac{3\phi^{\hat{y}}}{\lambda_{k^%
{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{%
2}}\right).
\displaystyle\leq 2\cdot\left\lVert U-\hat{f}\widehat{B}^{\top}\right\rVert_{F%
}^{2}\leq\min_{1\leq k^{\prime}\leq k}\left(\frac{3\phi^{\hat{y}}}{\lambda_{k^%
{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{\prime}})^{%
2}}\right).
\Pr(x)=w_{x}
\Delta(y,\hat{y})
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq y(\bar{x})%
\right)\leq\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq\hat{y}({x}%
)\right)+\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{%
A}(\cdot|\bar{x})}\left(y(\bar{x})\neq\hat{y}({x})\right)
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq y(\bar{x})\right)
\displaystyle\leq\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{\hat{f},\widehat{{B}}}({x})\neq\hat{y}({x}%
)\right)+\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim\mathcal{%
A}(\cdot|\bar{x})}\left(y(\bar{x})\neq\hat{y}({x})\right)
\displaystyle\leq\min_{1\leq k^{\prime}\leq k}\left(\frac{3\phi^{\hat{y}}}{%
\lambda_{k^{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{%
\prime}})^{2}}\right)+\Delta(y,\hat{y}).
\displaystyle\leq\min_{1\leq k^{\prime}\leq k}\left(\frac{3\phi^{\hat{y}}}{%
\lambda_{k^{\prime}+1}}+\frac{6k^{\prime}\epsilon}{(\lambda_{k+1}-\lambda_{k^{%
\prime}})^{2}}\right)+\Delta(y,\hat{y}).
\widehat{B}
\displaystyle\left\lVert\widehat{B}\right\rVert_{F}\leq\frac{2(k+1)}{1-\lambda%
_{k}}\sqrt{\sum_{i=1}^{r}\left\lVert u_{i}\right\rVert_{2}^{2}}=\frac{2(k+1)}{%
1-\lambda_{k}}.
\displaystyle\left\lVert\widehat{B}\right\rVert_{F}\leq\frac{2(k+1)}{1-\lambda%
_{k}}\sqrt{\sum_{i=1}^{r}\left\lVert u_{i}\right\rVert_{2}^{2}}=\frac{2(k+1)}{%
1-\lambda_{k}}.
{\hat{f}_{\textup{emp}}}
\epsilon=\mathcal{L}({{\hat{f}_{\textup{emp}}}})-\mathcal{L}({{f^{*}_{\textup{%
pop}}}})
y_{i}
y(\bar{x}_{i})
z_{i}={\hat{f}_{\textup{emp}}}(x_{i})
\{(z_{i},y_{i})\}_{i=1}^{n_{\rm{down}}}
(z_{i},y_{i})
\displaystyle\widehat{\mathcal{R}}_{{n_{\rm{down}}}}(\ell):=\mathrm{\mathbb{E}%
}_{\{(z_{i},y_{i})\}_{i=1}^{n_{\rm{down}}}}\mathrm{\mathbb{E}}_{\sigma}\left[%
\sup_{\left\lVert{B}\right\rVert_{F}\leq C_{k}}\frac{1}{{n_{\rm{down}}}}\left[%
\sum_{i=1}^{{n_{\rm{down}}}}\sigma_{i}\ell((z_{i},y_{i}),{B})\right]\right]
\displaystyle\widehat{\mathcal{R}}_{{n_{\rm{down}}}}(\ell):=
\displaystyle\mathrm{\mathbb{E}}_{\{(z_{i},y_{i})\}_{i=1}^{n_{\rm{down}}}}%
\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{\left\lVert{B}\right\rVert_{F}\leq C_{%
k}}\frac{1}{{n_{\rm{down}}}}\left[\sum_{i=1}^{{n_{\rm{down}}}}\sigma_{i}\ell((%
z_{i},y_{i}),{B})\right]\right]
\displaystyle\leq 2r\mathrm{\mathbb{E}}_{\{(z_{i},y_{i})\}_{i=1}^{n_{\rm{down}%
}}}\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{\left\lVert{b}\right\rVert_{2}\leq C%
_{k}}\frac{1}{{n_{\rm{down}}}}\left[\sum_{i=1}^{{n_{\rm{down}}}}\sigma_{i}w^{%
\top}z_{i}\right]\right]
\displaystyle\leq
\displaystyle 2r\mathrm{\mathbb{E}}_{\{(z_{i},y_{i})\}_{i=1}^{n_{\rm{down}}}}%
\mathrm{\mathbb{E}}_{\sigma}\left[\sup_{\left\lVert{b}\right\rVert_{2}\leq C_{%
k}}\frac{1}{{n_{\rm{down}}}}\left[\sum_{i=1}^{{n_{\rm{down}}}}\sigma_{i}w^{%
\top}z_{i}\right]\right]
\displaystyle\leq 2rC_{k}\sqrt{\frac{\mathrm{\mathbb{E}}[\left\lVert z_{i}%
\right\rVert^{2}]}{{n_{\rm{down}}}}}\leq 2rC_{k}\sqrt{\frac{2(k+\epsilon)}{{n_%
{\rm{down}}}}},
\displaystyle\leq
\displaystyle 2rC_{k}\sqrt{\frac{\mathrm{\mathbb{E}}[\left\lVert z_{i}\right%
\rVert^{2}]}{{n_{\rm{down}}}}}\leq 2rC_{k}\sqrt{\frac{2(k+\epsilon)}{{n_{\rm{%
down}}}}},
\ell_{\sigma}
2
\widehat{B}^{*}
\left\lVert\widehat{B}^{*}\right\rVert_{F}\leq C_{k}
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\ell\left(({\hat{f}_{\textup{emp}}%
}({x}),y(\bar{x})),\widehat{B}^{*}\right)\right]\lesssim\frac{\alpha}{\rho_{%
\lfloor\frac{k}{2}\rfloor}^{2}}\cdot\log(k)+\frac{k\epsilon}{(\lambda_{k}-%
\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}.
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\ell\left(({\hat{f}_{\textup{emp}}%
}({x}),y(\bar{x})),\widehat{B}^{*}\right)\right]\lesssim\frac{\alpha}{\rho_{%
\lfloor\frac{k}{2}\rfloor}^{2}}\cdot\log(k)+\frac{k\epsilon}{(\lambda_{k}-%
\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}.
\widehat{{B}}
\sum_{i=1}^{n_{\rm{down}}}\ell\left((z_{i},y_{i}),{B}\right)
\left\lVert{{B}}\right\rVert_{F}\leq C_{k}
1-\delta
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\ell\left(({\hat{f}_{\textup{emp}}%
}({x}),y(\bar{x})),\widehat{{B}}\right)\right]\lesssim\frac{\alpha}{\rho_{%
\lfloor\frac{k}{2}\rfloor}^{2}}\cdot\log(k)+\frac{k\epsilon}{(\lambda_{k}-%
\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}+\frac{rC_{k}\sqrt{k+\epsilon}}{%
\sqrt{{n_{\rm{down}}}}}+\sqrt{\frac{\log 1/\delta}{{n_{\rm{down}}}}}.
\displaystyle\mathrm{\mathbb{E}}_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X%
}}},{x}\sim\mathcal{A}(\cdot|\bar{x})}\left[\ell\left(({\hat{f}_{\textup{emp}}%
}({x}),y(\bar{x})),\widehat{{B}}\right)\right]\lesssim\frac{\alpha}{\rho_{%
\lfloor\frac{k}{2}\rfloor}^{2}}\cdot\log(k)+\frac{k\epsilon}{(\lambda_{k}-%
\lambda_{\lfloor\frac{3}{4}k\rfloor})^{2}}+\frac{rC_{k}\sqrt{k+\epsilon}}{%
\sqrt{{n_{\rm{down}}}}}+\sqrt{\frac{\log 1/\delta}{{n_{\rm{down}}}}}.
y(\bar{x})\neq g_{{\hat{f}_{\textup{emp}}},\widehat{{B}}}({x})
\ell\left(({\hat{f}_{\textup{emp}}}({x}),y(\bar{x})),\widehat{{B}}\right)\geq%
\frac{1}{2}
\epsilon<1
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{\hat{f}_{\textup{emp}}},\widehat{{B}}}({x%
})\neq y(\bar{x})\right)\lesssim\frac{\alpha}{\rho_{\lfloor\frac{k}{2}\rfloor}%
^{2}}\cdot\log(k)+\frac{k\epsilon}{(\lambda_{k}-\lambda_{\lfloor\frac{3}{4}k%
\rfloor})^{2}}+\frac{rC_{k}\sqrt{k}}{\sqrt{{n_{\rm{down}}}}}+\sqrt{\frac{\log 1%
/\delta}{{n_{\rm{down}}}}}.
\displaystyle\Pr_{\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}},{x}\sim%
\mathcal{A}(\cdot|\bar{x})}\left(g_{{\hat{f}_{\textup{emp}}},\widehat{{B}}}({x%
})\neq y(\bar{x})\right)\lesssim\frac{\alpha}{\rho_{\lfloor\frac{k}{2}\rfloor}%
^{2}}\cdot\log(k)+\frac{k\epsilon}{(\lambda_{k}-\lambda_{\lfloor\frac{3}{4}k%
\rfloor})^{2}}+\frac{rC_{k}\sqrt{k}}{\sqrt{{n_{\rm{down}}}}}+\sqrt{\frac{\log 1%
/\delta}{{n_{\rm{down}}}}}.
\bar{g}_{{\hat{f}_{\textup{emp}}},\widehat{{B}}}
\bar{g}
\epsilon>1
1
\epsilon
\epsilon
\mathcal{X}
\mathcal{X}
\mathbb{R}^{d}
d>0
\mathcal{X}
\mathcal{X}=\mathbb{R}^{d}
\mathcal{X}
\mathbb{R}^{d}
\mu
dx
d\mu
w_{xx^{\prime}}
w:\mathcal{X}\times\mathcal{X}\rightarrow\mathbb{R}
w(x,x^{\prime})
x
x^{\prime}
\bar{x}\sim\mathcal{P}_{\overline{\mathcal{X}}}
w
u\in\mathcal{X}
w(u)\triangleq\int w(u,z)dz
w
u\in\mathcal{X}
w(u)=\int w(u,z)dz<\infty
B>0
u,v\in\mathcal{X}
\frac{w(u,v)}{w(u)}\leq B\cdot w(v)
B
B
L_{2}(\mathbb{R}^{d})
L_{2}
L_{2}(\mathbb{R}^{d})\triangleq\{f:\mathbb{R}^{d}\rightarrow\mathbb{R}\ |\ %
\int f(z)^{2}dz<\infty\}
f,g\in L_{2}(\mathbb{R}^{d})
\langle f,g\rangle\triangleq\int f(z)g(z)dz
\ell_{2}(\mathbb{R}^{d})
\mathcal{X}
H:L_{2}(\mathbb{R}^{d})\rightarrow L_{2}(\mathbb{R}^{d})
f\in L_{2}(\mathbb{R}^{d})
H
H(f)(u)=\lambda f(u)
u\in\mathcal{X}
\lambda\in\mathbb{R}
L:L_{2}(\mathbb{R}^{d})\rightarrow L_{2}(\mathbb{R}^{d})
u\in\mathcal{X}
f\in L_{2}(\mathbb{R}^{d})
\displaystyle L(f)(u)=f(u)-\int\frac{w(u,v)}{\sqrt{w(u)w(v)}}f(v)dv.
\displaystyle L(f)(u)=f(u)-\int\frac{w(u,v)}{\sqrt{w(u)w(v)}}f(v)dv.
\{f_{i}\}_{i=1}^{\infty}
L_{2}(\mathbb{R}^{d})
L(f_{i})=\lambda_{i}f_{i}
\lambda_{i}\in[0,1]
\lambda_{i}\leq\lambda_{i+1}
i\geq 0
k(u,v)\triangleq\frac{w(u,v)}{\sqrt{w(u)w(v)}}
\displaystyle\int k(u,v)^{2}dudv=\int\frac{w(u,v)^{2}}{w(u)w(v)}dudv\leq B\int
w%
(u,v)dudv=B<\infty.
\displaystyle\int k(u,v)^{2}dudv=\int\frac{w(u,v)^{2}}{w(u)w(v)}dudv\leq B\int
w%
(u,v)dudv=B<\infty.
I
L-I
L-I
L
\{f_{i}\}_{i=1}^{\infty}
L_{2}(\mathbb{R}^{d})
L(f_{i})=\lambda_{i}f_{i}
\displaystyle\lambda_{i}=\langle f_{i},L(f_{i})\rangle=\langle f_{i},f_{i}%
\rangle-\int\frac{w(u,v)}{\sqrt{w(u)w(v)}}f_{i}(u)f_{i}(v)dudv.
\displaystyle\lambda_{i}=\langle f_{i},L(f_{i})\rangle=\langle f_{i},f_{i}%
\rangle-\int\frac{w(u,v)}{\sqrt{w(u)w(v)}}f_{i}(u)f_{i}(v)dudv.
w(u,v)\geq 0
\langle f_{i},f_{i}\rangle=1
\lambda_{i}\leq 1
\displaystyle\int\frac{w(u,v)}{\sqrt{w(u)w(v)}}f_{i}(u)f_{i}(v)dudv\leq\sqrt{%
\int f_{i}(u)^{2}\frac{w(u,v)}{w(u)}dudv\cdot\int f_{i}(v)^{2}\frac{w(u,v)}{w(%
v)}dudv}=\langle f_{i},f_{i}\rangle,
\displaystyle\int\frac{w(u,v)}{\sqrt{w(u)w(v)}}f_{i}(u)f_{i}(v)dudv
\displaystyle\leq\sqrt{\int f_{i}(u)^{2}\frac{w(u,v)}{w(u)}dudv\cdot\int f_{i}%
(v)^{2}\frac{w(u,v)}{w(v)}dudv}=\langle f_{i},f_{i}\rangle,
\lambda_{i}\geq 0
\mathcal{X}
u_{x}
u(x):\mathbb{R}^{d}\rightarrow\mathbb{R}
L_{2}(\mathbb{R}^{d})
f(x)=w(x)^{1/2}u(x)
L_{2}(w)
\mathcal{L}_{\textup{mf}}({f})=\langle u,Lu\rangle_{L_{2}(\mathbb{R}^{d})}=%
\langle f,Lf\rangle_{L_{2}(w)}
