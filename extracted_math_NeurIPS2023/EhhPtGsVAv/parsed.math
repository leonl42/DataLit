f
f
f
f
f
state
s
s
f
1
0
f
f
f
f
f
\mathbf{state}
\mathbf{s}
f
s
\langle\mathcal{S},\mathcal{G},\mathcal{A},P,r,\gamma,\mu_{0},\rho_{g}\rangle
\mathcal{S}
\mathcal{A}
P:\mathcal{S}\times\mathcal{A}\longmapsto\Delta(\mathcal{S})
\Delta(\cdot)
\gamma\in[0,1)
\mu_{0}
\mathcal{G}\subset\mathcal{S}
\rho_{g}:\Delta(\mathcal{G})
s_{0}
g
\mu_{0}
\rho_{g}
r:\mathcal{S}\times\mathcal{G}\longmapsto\mathbb{R}
r(s^{\prime},g)=1
s^{\prime}=g
r(s^{\prime},g)=0
s^{\prime}\in\mathcal{B}(g,r)
\mathcal{B}(g,r)
g
r
\tau
(s_{0},a_{0},s_{1},\ldots,s_{T-1},a_{T-1},s_{T})
H_{g}(s)
H_{g}(s):=\sum_{t=0}^{T}\left[\gamma^{t}r(s_{t+1},g)|s_{0}=s\right]
T
T
\pi:\mathcal{S}\times\mathcal{G}\longmapsto\Delta(\mathcal{A})
\mathbb{E}_{\pi,s_{0}}[H_{g}(s_{0})]
\pi^{*}=\operatorname*{arg\,max}_{\pi_{\theta}\in\Pi}\mathbb{E}_{\pi,s_{0}}[H_%
{g}(s_{0})]
\Pi
\theta\in\Theta
p_{\theta}(\tau;g)=\Pi_{t=0}^{T}p(s_{t}|s_{t-1},a_{t-1})\pi_{\theta}(a_{t}|s_{%
t};g)
\eta_{\tau}(s)
s
\tau
\displaystyle p_{\theta}(s;g)=\frac{\int p_{\theta}(\tau;g)\eta_{\tau}(s)d\tau%
}{Z}
\displaystyle p_{\theta}(s;g)
\displaystyle=\frac{\int p_{\theta}(\tau;g)\eta_{\tau}(s)d\tau}{Z}
\displaystyle=\frac{\int\Pi p(s_{t+1}|s_{t},a_{t})\pi_{\theta}(a_{t}|s_{t};g)%
\eta_{\tau}(s)}{\int\int\Pi p(s_{t+1}|s_{t},a_{t})\pi_{\theta}(a_{t}|s_{t};g)%
\eta_{\tau}(s)d\tau ds}d\tau.
\displaystyle=\frac{\int\Pi p(s_{t+1}|s_{t},a_{t})\pi_{\theta}(a_{t}|s_{t};g)%
\eta_{\tau}(s)}{\int\int\Pi p(s_{t+1}|s_{t},a_{t})\pi_{\theta}(a_{t}|s_{t};g)%
\eta_{\tau}(s)d\tau ds}d\tau.
g
p_{g}:\Delta(\mathcal{S})
p_{g}=\delta(g)
p_{\theta}(s;g)
p_{g}
p_{\theta}
p_{\pi}
p_{\theta}
\pi
\theta
g
f
f
D_{f}(P||Q)=\int_{P>0}P(x)f\Big{(}\frac{Q(x)}{P(x)}\Big{)}dx-f^{\prime}(\infty%
)Q[P(x)=0]),\vspace{4pt}
f
f(1)=0
f^{\prime}(\infty)
\infty
f
Q=0
P=0
f
f
f^{\prime}(\infty)
f
D_{f}(P||Q)
f(u)
f^{\prime}(u)
f^{\prime}(\infty)
\int P(x)\log\frac{P(x)}{Q(x)}dx
u\log u
1+\log{u}
\int Q(x)\log\frac{Q(x)}{P(x)}dx
-\log{u}
-\frac{1}{u}
0
\frac{1}{2}\int P(x)\log\frac{2P(x)}{P(x)+Q(x)}+
Q(x)\log\frac{2Q(x)}{P(x)+Q(x)}dx
u\log u-
(1+u)\log\frac{1+u}{2}
\log\frac{2u}{1+u}
\log 2
\chi^{2}
\frac{1}{2}\int Q(x)(\frac{P(x)}{Q(x)}-1)^{2}dx
\frac{1}{2}(u-1)^{2}
u
f
D_{f}(P||Q)
f
f^{\prime}
f
f(1)=0
f
D_{f}(P||Q)
f
f^{\prime}
f
f(1)=0
p_{\theta}(s)
p_{g}(s)
p_{E}(s,a)
p_{\pi}(s,a)
p_{E}(s,a)
f
p_{\pi}(\tau)
p^{*}(\tau)\propto e^{r(\tau)}
f
f
J(\theta)=D_{f}(p_{\theta}(s)||p_{g}(s))
J(\theta)
J(\theta)
J(\theta)
\theta
J(\theta)
\nabla_{\theta}J(\theta)=\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{[}\Big{[%
}\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\Big{]}\Big{[}\sum_%
{t=1}^{T}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Big{]}%
\Bigg{]}.
-f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}
J^{RL}(\theta)=\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[}-f^{\prime}\Big{(%
}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Big{]}
J^{RL}(\theta)
\nabla_{\theta}J(\theta)
f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}
p_{g}(s_{t})=0
f
\eta_{\tau}(s)
\mathbbm{E}_{p_{\theta}}[\eta_{\tau}(g)]
f
\eta_{\tau}(g)
J(\theta)
\epsilon
\epsilon
f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{\epsilon}\Big{)}
p_{\theta}(s_{t})
J(\theta)
\pi_{\theta^{\prime}}
f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}
\nabla_{\theta}J(\theta)=\mathbbm{E}_{s_{t},a_{t}\sim p_{\theta^{\prime}}(s_{t%
},a_{t})}\Big{[}\min(r_{\theta}(s_{t})F_{\theta^{\prime}}(s_{t}),clip(r_{%
\theta}(s_{t}),1-{\epsilon},1+{\epsilon})F_{\theta^{\prime}}(s_{t}))\Big{]}%
\vspace{4pt}
\pi_{\theta}
G
B
i=1
B\leftarrow[]
j=1
g
p_{g}(s)
\tau:g
p_{\theta}(s)
\tau
f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}
s
\tau
B\leftarrow B+\{\tau:g\}
j=1
\theta\leftarrow\theta-\alpha\nabla_{\theta}J(\theta)
f
f
r_{\theta}(t)=\frac{\pi_{\theta}(a_{t}|s_{t})}{\pi_{\theta^{\prime}}(a_{t}|s_{%
t})}
F_{\theta^{\prime}}(s_{t})=\sum_{t^{\prime}=t}^{T}\gamma^{t^{\prime}}f^{\prime%
}\Big{(}\frac{p_{\theta^{\prime}}(s_{t})}{p_{g}(s_{t})}\Big{)}
\gamma
f^{\prime}\Big{(}\frac{p_{\theta^{\prime}}(s_{t})}{p_{g}(s_{t})}\Big{)}
f
f
fkl
f
rkl
J(\theta)
f
D_{f}(p_{\pi}||p_{g})
f
f(1)=0
f^{\prime}(\infty)
f
f
f^{\prime}(\infty)
f
f^{\prime}(\infty)
f
f
f^{\prime}(\infty)
rkl
tv
js
f=u\log{u}
f^{\prime}(\infty)
\log{p_{g}(s)}
fkl
\log{p_{g}(s)}
\chi^{2}
fkl
fkl
\mathbf{\pi}
fkl
\mathbf{state}
\mathbf{s}
\mathbf{sa}
s
s
\pi
\pi
\pi
s
\pi
s
\pi
s
s
fkl
\pi
p_{g}(s)
p_{g}(s)=e^{f(s;g)}
{f(s;g)}
fkl
\min D_{FKL}(p_{\theta},p_{g})=\max\mathbbm{E}_{p_{\theta}}[f(s;g)]-\mathbbm{E%
}_{p_{\theta}}[\log{p_{\theta}}].
f(s;g)
f(s;g)
-||s-g||^{2}_{2}
f(s;g)
s=g
f
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
p_{g}
p_{\theta}
f
f^{\prime}(x)
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f
p_{\theta}(s)
p_{g}(s)
p_{\theta}
(f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)}))
fkl
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f=u\log{u}
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)}
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f=u\log{u}
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)}
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f
f
f
1
0
(x,y)
fkl
fkl
rkl
rkl
f
f
fkl
rkl
f
f
f
f
fkl
f
fkl
fkl
fkl
fkl
fkl
fkl
fkl
fkl
fkl
fkl
fkl
f
f
f
f
f
fkl
\chi^{2}
f
f
fkl
\chi^{2}
fkl
\chi^{2}
fkl
\chi^{2}
f
f
f
s
f
f
f
f
f
f
J(\theta)
J(\theta)
\mathcal{D}
\pi\in\Pi
\pi^{*}
p_{\pi}\in\mathcal{D}
\pi^{*}\implies p_{\pi^{*}}(g)\geq p_{\pi}(g),\forall\text{ }p_{\pi}\in%
\mathcal{D}
\pi^{*}
p_{\pi^{*}}
r(s)=\begin{cases}1&s=g,\\
0&\text{otherwise}.\end{cases}
\pi
R_{\pi}
\displaystyle R_{\pi}=\mathbbm{E}_{p_{\pi}}[r(s)]
\displaystyle R_{\pi}
\displaystyle=\mathbbm{E}_{p_{\pi}}[r(s)]
\displaystyle=p_{\pi}(g).
\displaystyle=p_{\pi}(g).
R_{\pi^{*}}\geq R_{\pi},\forall\pi\in\Pi
p_{\pi^{*}}(g)\geq p_{\pi}(g),\forall p_{\pi}\in\mathcal{D}
p_{\pi}(s)
p_{g}(s)
p_{\pi}(s)
J(\theta)
p_{\pi}(g)
D_{f}(p_{\pi}(\cdot)||p_{g}(\cdot))
p_{\pi}(g)\forall f
f^{\prime}(\infty)
p_{g}(s)=1
s=g
0
f
p_{\pi}
p_{g}
\displaystyle D_{f}(p_{\pi}||p_{g})=\sum_{p_{g}>0}\Big{[}p_{g}(s)f\Big{(}\frac%
{p_{\pi}(s)}{p_{g}(s)}\Big{)}\Big{]}+f^{\prime}(\infty)p_{\pi}[p_{g}=0]
\displaystyle D_{f}(p_{\pi}||p_{g})
\displaystyle=\sum_{p_{g}>0}\Big{[}p_{g}(s)f\Big{(}\frac{p_{\pi}(s)}{p_{g}(s)}%
\Big{)}\Big{]}+f^{\prime}(\infty)p_{\pi}[p_{g}=0]
\displaystyle=f(p_{\pi}(g))+f^{\prime}(\infty)(1-p_{\pi}(g)).
\displaystyle=f(p_{\pi}(g))+f^{\prime}(\infty)(1-p_{\pi}(g)).
\mathcal{F}=D_{f}(p_{\pi}||p_{g})
\mathcal{F}
p_{\pi}(g)
\mathcal{F}^{\prime}=f^{\prime}(p_{\pi}(g))-f^{\prime}(\infty)
f
f
f^{\prime}(x)\leq f^{\prime}(y),\forall x\leq y
f^{\prime}(\infty)
\mathcal{F}^{\prime}\leq 0
\mathcal{F}=D_{f}(p_{\pi}||p_{g})
p_{\pi}(g)
\pi_{1}
\pi_{2}
R_{\pi}=\mathbbm{E}_{p_{\pi}}[r(s)]=p_{\pi}(g)
\pi_{1}
\pi_{2}
p_{\pi^{*}}
D_{f}(p_{\pi}||p_{g})
f
f(1)=0
f^{\prime}(\infty)
f
f
fkl
\log{p_{g}(s)}
fkl
f=u\log{u}
J(\theta)=D_{f}(p_{\pi}||p_{g})
\displaystyle D_{f}(p_{\pi}||p_{g})=\mathbbm{E}_{p_{\pi}}\Big{[}\log\frac{p_{%
\pi}}{p_{g}}\Big{]}
\displaystyle D_{f}(p_{\pi}||p_{g})
\displaystyle=\mathbbm{E}_{p_{\pi}}\Big{[}\log\frac{p_{\pi}}{p_{g}}\Big{]}
\displaystyle=-\Big{[}\mathbbm{E}_{p_{\pi}}[\log p_{g}]-\mathbbm{E}_{p_{\pi}}[%
\log p_{\pi}]\Big{]}
\displaystyle=-\Big{[}\mathbbm{E}_{p_{\pi}}[\log p_{g}]-\mathbbm{E}_{p_{\pi}}[%
\log p_{\pi}]\Big{]}
\displaystyle=-\Big{[}\mathbbm{E}_{p_{\pi}}[\log p_{g}]+\mathcal{H}(p_{\pi})%
\Big{]}
\displaystyle=-\Big{[}\mathbbm{E}_{p_{\pi}}[\log p_{g}]+\mathcal{H}(p_{\pi})%
\Big{]}
\mathcal{H}(p_{\pi})
D_{f}(p_{\pi}||p_{g})
r(s)=\log p_{g}(s)
p_{\pi}
\chi^{2}
f(u)=(u-1)^{2}
\chi^{2}
D_{f}(p_{\pi}||p_{g})
D_{FKL}(p_{\pi}||p_{g})-1
D_{\chi^{2}}
D_{FKL}
f=(u-1)^{2}
D_{f}(p_{\pi}||p_{g})
\displaystyle D_{f}(p_{\pi}||p_{g})=\int p_{g}(s)\Big{(}\frac{p_{\pi}(s)}{p_{g%
}(s)}-1\Big{)}^{2}ds
\displaystyle D_{f}(p_{\pi}||p_{g})
\displaystyle=\int p_{g}(s)\Big{(}\frac{p_{\pi}(s)}{p_{g}(s)}-1\Big{)}^{2}ds
\displaystyle=\int p_{g}(s)\Big{(}\Big{(}\frac{p_{\pi}(s)}{p_{g}(s)}\Big{)}^{2%
}-2\frac{p_{\pi}(s)}{p_{g}(s)}+1\Big{)}ds
\displaystyle=\int p_{g}(s)\Big{(}\Big{(}\frac{p_{\pi}(s)}{p_{g}(s)}\Big{)}^{2%
}-2\frac{p_{\pi}(s)}{p_{g}(s)}+1\Big{)}ds
\displaystyle=\int p_{\pi}(s)\frac{p_{\pi}(s)}{p_{g}(s)}-2p_{\pi}(s)+p_{g}(s)ds
\displaystyle=\int p_{\pi}(s)\frac{p_{\pi}(s)}{p_{g}(s)}-2p_{\pi}(s)+p_{g}(s)ds
\displaystyle=\int p_{\pi}(s)\frac{p_{\pi}(s)}{p_{g}(s)}ds-1
\displaystyle=\int p_{\pi}(s)\frac{p_{\pi}(s)}{p_{g}(s)}ds-1
\displaystyle=\mathbbm{E}_{p_{\pi}(s)}\Big{[}\frac{p_{\pi}(s)}{p_{g}(s)}\Big{]%
}-1
\displaystyle=\mathbbm{E}_{p_{\pi}(s)}\Big{[}\frac{p_{\pi}(s)}{p_{g}(s)}\Big{]%
}-1
x>\text{log }x
\displaystyle\implies\mathbbm{E}_{p_{\pi}(s)}[x]>\mathbbm{E}_{p_{\pi}(s)}[%
\text{log }x]
\displaystyle\implies\mathbbm{E}_{p_{\pi}(s)}[x]>\mathbbm{E}_{p_{\pi}(s)}[%
\text{log }x]
\displaystyle\implies\mathbbm{E}_{p_{\pi}(s)}\Big{[}\frac{p_{\pi}(s)}{p_{g}(s)%
}\Big{]}>\mathbbm{E}_{p_{\pi}(s)}\Big{[}\text{log }\frac{p_{\pi}(s)}{p_{g}(s)}%
\Big{]}
\displaystyle\implies\mathbbm{E}_{p_{\pi}(s)}\Big{[}\frac{p_{\pi}(s)}{p_{g}(s)%
}\Big{]}>\mathbbm{E}_{p_{\pi}(s)}\Big{[}\text{log }\frac{p_{\pi}(s)}{p_{g}(s)}%
\Big{]}
\displaystyle\implies\mathbbm{E}_{p_{\pi}(s)}\Big{[}\frac{p_{\pi}(s)}{p_{g}(s)%
}\Big{]}-1>\mathbbm{E}_{p_{\pi}(s)}\Big{[}\text{log }\frac{p_{\pi}(s)}{p_{g}(s%
)}\Big{]}-1
\displaystyle\implies\mathbbm{E}_{p_{\pi}(s)}\Big{[}\frac{p_{\pi}(s)}{p_{g}(s)%
}\Big{]}-1>\mathbbm{E}_{p_{\pi}(s)}\Big{[}\text{log }\frac{p_{\pi}(s)}{p_{g}(s%
)}\Big{]}-1
D_{KL}(p_{\pi}||p_{g})-1
-1
D_{KL}(p_{\pi}||p_{g})
J(\theta)
\nabla_{\theta}J(\theta)=\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}%
\Bigg{[}\Big{[}\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\Big{%
]}\Big{[}\sum_{t=1}^{T}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}%
\Big{)}\Big{]}\Bigg{]}.
\displaystyle p_{\theta}(s)\propto\int p(\tau)\Pi_{t=1}^{T}\pi_{\theta}(s_{t})%
\eta_{\tau}(s)d\tau
\displaystyle p_{\theta}(s)
\displaystyle\propto\int p(\tau)\Pi_{t=1}^{T}\pi_{\theta}(s_{t})\eta_{\tau}(s)d\tau
\displaystyle\implies p_{\theta}(s)\propto\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau
\displaystyle\implies p_{\theta}(s)
\displaystyle\propto\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_%
{\tau}(s)d\tau
\displaystyle\implies p_{\theta}(s)=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau}{\int\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau ds}
\displaystyle\implies p_{\theta}(s)=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau}{\int\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau ds}
\displaystyle\implies p_{\theta}(s)=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau}{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{%
\theta}(s_{t})}\int\eta_{\tau}(s)dsd\tau}
\displaystyle\implies p_{\theta}(s)=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau}{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{%
\theta}(s_{t})}\int\eta_{\tau}(s)dsd\tau}
\displaystyle\implies p_{\theta}(s)=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau}{T\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{%
\theta}(s_{t})}d\tau}
\displaystyle\implies p_{\theta}(s)=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi%
_{\theta}(s_{t})}\eta_{\tau}(s)d\tau}{T\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{%
\theta}(s_{t})}d\tau}
\displaystyle\implies p_{\theta}(s)=\frac{f(s)}{Z}
\displaystyle\implies p_{\theta}(s)=\frac{f(s)}{Z}
f(s)=\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_{\tau}(s)d\tau
Z=T\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}d\tau
\pi_{\theta}(s^{*})
\displaystyle\frac{df(s)}{d\pi_{\theta}(s^{*})}=\frac{\int p(\tau)e^{\sum_{t=1%
}^{T}\log\pi_{\theta}(s_{t})}\eta_{\tau}(s)\eta_{\tau}(s^{*})d\tau}{\pi_{%
\theta}(s^{*})}
\displaystyle\frac{df(s)}{d\pi_{\theta}(s^{*})}=\frac{\int p(\tau)e^{\sum_{t=1%
}^{T}\log\pi_{\theta}(s_{t})}\eta_{\tau}(s)\eta_{\tau}(s^{*})d\tau}{\pi_{%
\theta}(s^{*})}
\displaystyle\frac{dZ}{d\pi_{\theta}(s^{*})}=\frac{T\int p(\tau)e^{\sum_{t=1}^%
{T}\log\pi_{\theta}(s_{t})}\eta_{\tau}(s^{*})d\tau}{\pi_{\theta}(s^{*})}
\displaystyle\frac{dZ}{d\pi_{\theta}(s^{*})}
\displaystyle=\frac{T\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta%
_{\tau}(s^{*})d\tau}{\pi_{\theta}(s^{*})}
\displaystyle=\frac{Tf(s^{*})}{\pi_{\theta}(s^{*})}
\displaystyle=\frac{Tf(s^{*})}{\pi_{\theta}(s^{*})}
\frac{dp_{\theta}(s)}{\pi_{\theta}(s^{*})}
\frac{df(s)}{d\pi_{\theta}(s^{*})}
\frac{dZ}{d\pi_{\theta}(s^{*})}
\displaystyle\frac{dp_{\theta}(s)}{\pi_{\theta}(s^{*})}=\frac{Z\frac{df(s)}{d%
\pi_{\theta}(s^{*})}-f(s)\frac{dZ}{d\pi_{\theta}(s^{*})}}{Z^{2}}
\displaystyle\frac{dp_{\theta}(s)}{\pi_{\theta}(s^{*})}
\displaystyle=\frac{Z\frac{df(s)}{d\pi_{\theta}(s^{*})}-f(s)\frac{dZ}{d\pi_{%
\theta}(s^{*})}}{Z^{2}}
\displaystyle=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_%
{\tau}(s)\eta_{\tau}(s^{*})d\tau}{Z\pi_{\theta}(s^{*})}-\frac{f(s)}{Z}T\frac{f%
(s^{*})}{Z\pi_{\theta}(s^{*})}
\displaystyle=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_%
{\tau}(s)\eta_{\tau}(s^{*})d\tau}{Z\pi_{\theta}(s^{*})}-\frac{f(s)}{Z}T\frac{f%
(s^{*})}{Z\pi_{\theta}(s^{*})}
\displaystyle=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_%
{\tau}(s)\eta_{\tau}(s^{*})d\tau}{Z\pi_{\theta}(s^{*})}-\frac{T}{\pi_{\theta}(%
s^{*})}p_{\theta}(s)p_{\theta}(s^{*})
\displaystyle=\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_%
{\tau}(s)\eta_{\tau}(s^{*})d\tau}{Z\pi_{\theta}(s^{*})}-\frac{T}{\pi_{\theta}(%
s^{*})}p_{\theta}(s)p_{\theta}(s^{*})
\frac{dp_{\theta}(s)}{d\theta}
\displaystyle\frac{dp_{\theta}(s)}{d\theta}=\int\frac{dp_{\theta}(s)}{\pi_{%
\theta}(s^{*})}\frac{d\pi_{\theta}(s^{*})}{d\theta}ds^{*}
\displaystyle\frac{dp_{\theta}(s)}{d\theta}
\displaystyle=\int\frac{dp_{\theta}(s)}{\pi_{\theta}(s^{*})}\frac{d\pi_{\theta%
}(s^{*})}{d\theta}ds^{*}
\displaystyle=\int\Big{(}\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s%
_{t})}\eta_{\tau}(s)\eta_{\tau}(s^{*})d\tau}{Z\pi_{\theta}(s^{*})}-\frac{T}{%
\pi_{\theta}(s^{*})}p_{\theta}(s)p_{\theta}(s^{*})\Big{)}\frac{d\pi_{\theta}(s%
^{*})}{d\theta}ds^{*}
\displaystyle=\int\Big{(}\frac{\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s%
_{t})}\eta_{\tau}(s)\eta_{\tau}(s^{*})d\tau}{Z\pi_{\theta}(s^{*})}-\frac{T}{%
\pi_{\theta}(s^{*})}p_{\theta}(s)p_{\theta}(s^{*})\Big{)}\frac{d\pi_{\theta}(s%
^{*})}{d\theta}ds^{*}
\displaystyle=\frac{1}{Z}\int\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{%
t})}\eta_{\tau}(s)\eta_{\tau}(s^{*})\frac{\nabla_{\theta}\pi_{\theta}(s^{*})}{%
\pi_{\theta}(s^{*})}ds^{*}d\tau-Tp_{\theta}(s)\int p_{\theta}(s^{*})\frac{%
\nabla_{\theta}\pi_{\theta}(s^{*})}{\pi_{\theta}(s^{*})}ds^{*}
\displaystyle=\frac{1}{Z}\int\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{%
t})}\eta_{\tau}(s)\eta_{\tau}(s^{*})\frac{\nabla_{\theta}\pi_{\theta}(s^{*})}{%
\pi_{\theta}(s^{*})}ds^{*}d\tau-Tp_{\theta}(s)\int p_{\theta}(s^{*})\frac{%
\nabla_{\theta}\pi_{\theta}(s^{*})}{\pi_{\theta}(s^{*})}ds^{*}
\displaystyle=\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}%
\eta_{\tau}(s)\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})d\tau-Tp_{%
\theta}(s)\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{\theta}\log\pi_{\theta}(s)]
\displaystyle=\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}%
\eta_{\tau}(s)\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})d\tau-Tp_{%
\theta}(s)\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{\theta}\log\pi_{\theta}(s)]
L(\theta)=D_{f}(p_{\theta}(s)||p_{g}(s))=\int p_{g}(s)f\Big{(}\frac{p_{\theta}%
(s)}{p_{g}(s)}\Big{)}ds
L(\theta)
\displaystyle\nabla_{\theta}L(\theta)=\int p_{g}(s)f^{\prime}\Big{(}\frac{p_{%
\theta}(s)}{p_{g}(s)}\Big{)}\Big{(}\frac{\nabla_{\theta}p_{\theta}(s)}{p_{g}(s%
)}\Big{)}ds
\displaystyle\nabla_{\theta}L(\theta)
\displaystyle=\int p_{g}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big%
{)}\Big{(}\frac{\nabla_{\theta}p_{\theta}(s)}{p_{g}(s)}\Big{)}ds
\displaystyle=\int\nabla p_{\theta}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_%
{g}(s)}\Big{)}ds
\displaystyle=\int\nabla p_{\theta}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_%
{g}(s)}\Big{)}ds
\displaystyle=\int f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}\Big{%
(}\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_{\tau}(%
s)\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})d\tau
\displaystyle=\int f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}\Big{%
(}\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}\eta_{\tau}(%
s)\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})d\tau
\displaystyle\qquad-Tp_{\theta}(s)\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{%
\theta}\log\pi_{\theta}(s)]\Big{)}ds
\displaystyle\qquad-Tp_{\theta}(s)\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{%
\theta}\log\pi_{\theta}(s)]\Big{)}ds
\displaystyle=\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}%
\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\int\eta_{\tau}(s)f^{%
\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}dsd\tau
\displaystyle=\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}%
\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\int\eta_{\tau}(s)f^{%
\prime}\Big{(}\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}dsd\tau
\displaystyle\qquad-\int Tp_{\theta}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p%
_{g}(s)}\Big{)}\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{\theta}\log\pi_{%
\theta}(s)]ds
\displaystyle\qquad-\int Tp_{\theta}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p%
_{g}(s)}\Big{)}\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{\theta}\log\pi_{%
\theta}(s)]ds
\displaystyle=\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}%
\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}%
\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}d\tau
\displaystyle=\frac{1}{Z}\int p(\tau)e^{\sum_{t=1}^{T}\log\pi_{\theta}(s_{t})}%
\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}%
\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}d\tau
\displaystyle\qquad-T\int p_{\theta}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p%
_{g}(s)}\Big{)}\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{\theta}\log\pi_{%
\theta}(s)]ds
\displaystyle\qquad-T\int p_{\theta}(s)f^{\prime}\Big{(}\frac{p_{\theta}(s)}{p%
_{g}(s)}\Big{)}\mathbbm{E}_{s\sim p_{\theta}(s)}[\nabla_{\theta}\log\pi_{%
\theta}(s)]ds
\displaystyle=\frac{1}{T}\int p_{\theta}(\tau)\sum_{t=1}^{T}\nabla_{\theta}%
\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}%
{p_{g}(s_{t})}\Big{)}d\tau
\displaystyle=\frac{1}{T}\int p_{\theta}(\tau)\sum_{t=1}^{T}\nabla_{\theta}%
\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}%
{p_{g}(s_{t})}\Big{)}d\tau
\displaystyle\qquad-T\mathbbm{E}_{s\sim p_{\theta}(s)}\Big{[}f^{\prime}\Big{(}%
\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}\Big{]}\mathbbm{E}_{s\sim p_{\theta}(s)}[%
\nabla_{\theta}\log\pi_{\theta}(s)]
\displaystyle\qquad-T\mathbbm{E}_{s\sim p_{\theta}(s)}\Big{[}f^{\prime}\Big{(}%
\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}\Big{]}\mathbbm{E}_{s\sim p_{\theta}(s)}[%
\nabla_{\theta}\log\pi_{\theta}(s)]
\displaystyle=\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{[}\sum_{%
t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}\Big{(}%
\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Bigg{]}
\displaystyle=\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{[}\sum_{%
t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}\Big{(}%
\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Bigg{]}
\displaystyle\qquad-T\mathbbm{E}_{s\sim p_{\theta}(s)}\Big{[}f^{\prime}\Big{(}%
\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}\Big{]}\mathbbm{E}_{s\sim p_{\theta}(s)}[%
\nabla_{\theta}\log\pi_{\theta}(s)]
\displaystyle\qquad-T\mathbbm{E}_{s\sim p_{\theta}(s)}\Big{[}f^{\prime}\Big{(}%
\frac{p_{\theta}(s)}{p_{g}(s)}\Big{)}\Big{]}\mathbbm{E}_{s\sim p_{\theta}(s)}[%
\nabla_{\theta}\log\pi_{\theta}(s)]
\displaystyle=\frac{1}{T}\Bigg{[}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{%
[}\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}%
\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Bigg{]}
\displaystyle=\frac{1}{T}\Bigg{[}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{%
[}\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}%
\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Bigg{]}
\displaystyle\qquad-\mathbbm{E}_{s\sim p_{\theta}(s)}\Big{[}\sum_{t=1}^{T}f^{%
\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Big{]}\mathbbm{E}_%
{\tau\sim p_{\theta}(\tau)}[\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t%
})]\Bigg{]}
\displaystyle\qquad-\mathbbm{E}_{s\sim p_{\theta}(s)}\Big{[}\sum_{t=1}^{T}f^{%
\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Big{]}\mathbbm{E}_%
{\tau\sim p_{\theta}(\tau)}[\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t%
})]\Bigg{]}
\displaystyle=\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{[}\sum_{%
t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}\Big{(}%
\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Bigg{]}
\displaystyle=\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Bigg{[}\sum_{%
t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\sum_{t=1}^{T}f^{\prime}\Big{(}%
\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Bigg{]}
\mathbbm{E}_{p_{\theta}}[\eta_{\tau}(g)]
p^{g}
f
D_{f}(p_{\theta}||p_{g})=\sum_{p_{g}>0}\big{[}p_{g}(s)f(\frac{p_{\theta}(s)}{p%
_{g}(s)})\big{]}+f^{\prime}(\infty)p_{\theta}[p_{g}=0]=\sum_{p_{g}>0}\big{[}p_%
{g}(s)f(\frac{p_{\theta}(s)}{p_{g}(s)})\big{]}+f^{\prime}(\infty)(1-p_{\theta}%
(g))
\theta
\displaystyle\nabla_{\theta}L(\theta)=\big{(}f^{\prime}(p_{\theta}(g))-f^{%
\prime}(\infty)\big{)}\nabla_{\theta}p_{\theta}(s)
\displaystyle\nabla_{\theta}L(\theta)
\displaystyle=\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)\big{)}\nabla%
_{\theta}p_{\theta}(s)
\displaystyle=\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)\big{)}\Big{(%
}\frac{1}{T}\int p_{\theta}(\tau)\eta_{\tau}(g)\sum_{t=1}^{T}\nabla_{\theta}%
\log\pi_{\theta}(s_{t})d\tau-Tp_{\theta}(s)\mathbbm{E}_{s\sim p_{\theta}(s)}[%
\nabla_{\theta}log\pi_{\theta}(s)]\Big{)}
\displaystyle=\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)\big{)}\Big{(%
}\frac{1}{T}\int p_{\theta}(\tau)\eta_{\tau}(g)\sum_{t=1}^{T}\nabla_{\theta}%
\log\pi_{\theta}(s_{t})d\tau-Tp_{\theta}(s)\mathbbm{E}_{s\sim p_{\theta}(s)}[%
\nabla_{\theta}log\pi_{\theta}(s)]\Big{)}
\displaystyle=\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)\big{)}\Big{(%
}\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[}\eta_{\tau}(g)\sum_{%
t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\Big{]}
\displaystyle=\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)\big{)}\Big{(%
}\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[}\eta_{\tau}(g)\sum_{%
t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s_{t})\Big{]}
\displaystyle\qquad-p_{\theta}(g)\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[%
}\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s)\Big{]}\Big{)}
\displaystyle\qquad-p_{\theta}(g)\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[%
}\sum_{t=1}^{T}\nabla_{\theta}\log\pi_{\theta}(s)\Big{]}\Big{)}
\displaystyle=\frac{1}{T}\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)%
\big{)}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[}\sum_{t=1}^{T}\nabla_{%
\theta}\log\pi_{\theta}(s_{t})\eta_{\tau}(g)\Big{]}
\displaystyle=\frac{1}{T}\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)%
\big{)}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}\Big{[}\sum_{t=1}^{T}\nabla_{%
\theta}\log\pi_{\theta}(s_{t})\eta_{\tau}(g)\Big{]}
\big{(}f^{\prime}(p_{\theta}(g))-f^{\prime}(\infty)\big{)}
p_{\theta}(g)
\mathbbm{E}_{p_{\theta}}[\eta_{\tau}(g)]
\nabla_{\theta}L(\theta)
L(\theta)
\mathbbm{E}_{p_{\theta}}[\eta_{\tau}(g)]
\theta^{\prime}
\nabla_{\theta}J(\theta)=\mathbbm{E}_{\tau\sim p_{\theta^{\prime}}(\tau)}\Bigg%
{[}\frac{\pi_{\theta}(\tau)}{\pi_{\theta^{\prime}}(\tau)}\Big{[}\sum_{t=1}^{T}%
\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\Big{]}\Big{[}\sum_{t=1}^{T}f^{%
\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}\Big{]}\Bigg{]}.
t
t^{\prime}\rightarrow[t,T]
\gamma
\sum_{t^{\prime}=t}^{T}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}%
\Big{)}
\nabla_{\theta}J(\theta)=\mathbbm{E}_{s_{t},a_{t}\sim p_{\theta^{\prime}}(s_{t%
},a_{t})}\Bigg{[}\frac{\pi_{\theta}(a_{t}|s_{t})}{\pi_{\theta^{\prime}}(a_{t}|%
s_{t})}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\sum_{t^{\prime}=t}^{T}%
\gamma^{t^{\prime}}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big%
{)}\Bigg{]}.
\pi_{\theta^{{}^{\prime}}}
\sum_{t^{\prime}=t}^{T}\gamma^{t^{\prime}}f^{\prime}\Big{(}\frac{p_{\theta}(s_%
{t})}{p_{g}(s_{t})}\Big{)}
f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t})}\Big{)}
f^{\prime}\Big{(}\frac{p_{\theta^{\prime}}(s_{t})}{p_{g}(s_{t})}\Big{)}
\theta^{\prime}
\theta
D_{KL}(p_{\theta^{\prime}}||p_{\theta})
\nabla_{\theta}J(\theta)=\mathbbm{E}_{s_{t},a_{t}\sim p_{\theta^{\prime}}(s_{t%
},a_{t})}\Big{[}\min(r_{\theta}(s_{t})F_{\theta^{\prime}}(s_{t}),clip(r_{%
\theta}(s_{t}),1-{\epsilon},1+{\epsilon})F_{\theta^{\prime}}(s_{t}))\Big{]},
r_{\theta}(s_{t})=\frac{\nabla_{\theta}\pi_{\theta}(a_{t}|s_{t})}{\pi_{\theta^%
{\prime}}(s_{a}t|s_{t})}
F_{\theta^{\prime}}(s_{t})=\sum_{t^{\prime}=t}^{T}\gamma^{t^{\prime}}f^{\prime%
}\Big{(}\frac{p_{\theta^{\prime}}(s_{t})}{p_{g}(s_{t})}\Big{)}
\eta_{\tau}(s)=\sum_{t=1}^{T}\gamma^{t}\mathbbm{1}_{s_{t}=s}
\int\eta_{\tau}(s)f(s)ds=\sum_{t=1}^{T}f(s_{t})
\int\eta_{\tau}(s)f(s)ds=\sum_{t=1}^{T}\gamma^{t}f(s_{t})
\nabla_{\theta}J(\theta)=\frac{1}{T}\mathbbm{E}_{\tau\sim p_{\theta}(\tau)}%
\Bigg{[}\Big{[}\sum_{t=1}^{T}\gamma^{t}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s%
_{t})\Big{]}\Big{[}\sum_{t=1}^{T}\gamma^{t}f^{\prime}\Big{(}\frac{p_{\theta}(s%
_{t})}{p_{g}(s_{t})}\Big{)}\Big{]}\Bigg{]}.
\nabla_{\theta}J(\theta)=\mathbbm{E}_{s_{t},a_{t}\sim p_{\theta}(s_{t},a_{t})}%
\Big{[}\gamma^{t}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\sum_{t^{\prime}=%
t}^{T}\gamma^{t^{\prime}}f^{\prime}\Big{(}\frac{p_{\theta}(s_{t})}{p_{g}(s_{t}%
)}\Big{)}\Big{]}.
f
x
y
1
0
f
f
fkl
rkl
(-0.21,0)
0.02
[-1,1]
1
f
f
fkl
-10
5
\chi^{2}
-600
-50
fkl
\chi^{2}
\chi^{2}
\chi^{2}
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f
fkl
rkl
js
\chi^{2}
f
f^{\prime}(\frac{p_{\theta}(s)}{p_{g}(s)})
f
fkl
rkl
js
\chi^{2}
f
[-1,1]
f
1
0
