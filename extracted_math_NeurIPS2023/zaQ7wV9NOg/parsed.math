d
\epsilon
\tilde{\mathcal{O}}(d^{2}/\epsilon^{3})
\tilde{\Theta}(d^{2})
d
\tilde{\mathcal{O}}({\mathrm{poly}}(d)/\epsilon^{11})
\epsilon
d
\tilde{\mathcal{O}}(1/\epsilon^{11})
\tilde{\mathcal{O}}(d^{3}/\epsilon^{3})
\tilde{\Theta}(d^{2}/\epsilon^{2})
\times
\times
\tilde{\mathcal{O}}(d^{2}/\epsilon^{2}+d^{\geq 4}/\epsilon)
\checkmark
\times
\tilde{\mathcal{O}}({\mathrm{poly}}(d)/\epsilon^{11})
\checkmark
\checkmark
\tilde{\mathcal{O}}(d^{3}/\epsilon^{3})
\checkmark
\checkmark
\tilde{\mathcal{O}}(d^{2}/\epsilon^{3})
\checkmark
\checkmark
\tilde{\mathcal{O}}(d^{2}/\epsilon^{3})
\epsilon
d
d
\tilde{\Theta}(d^{2}/\epsilon^{2})
\tilde{\mathcal{O}}(d^{2}/\epsilon^{2}+d^{\geq 4}/\epsilon)
d
\epsilon
d
\epsilon
m
m=1
\tilde{\mathcal{O}}(d^{2}/\epsilon^{4})
\sqrt{d}
\tilde{\mathcal{O}}(d^{3}/\epsilon^{2})
\tilde{\Theta}(d^{2}/\epsilon^{2})
\tilde{\mathcal{O}}(d^{2}/\epsilon^{2}+d^{\geq 4}/\epsilon)
\epsilon
\epsilon^{-1}
(\mathcal{S},\mathcal{A},\mathbb{P},R,H)
\mathcal{S}
\mathcal{A}
\mathbb{P}=\{\mathbb{P}_{h}\}_{h\in[H]}
\mathbb{P}_{h}(s^{\prime}\mid s,a)
s^{\prime}
a
s
h
R=\{R_{h}\}_{h\in[H]}
R_{h}(s,a)
a
s
h
H
s_{1}
h^{\rm th}
s_{h}
a_{h}
r_{h}(s_{h},a_{h})
\mathbb{E}[r_{h}(s_{h},a_{h})\mid s_{h},a_{h}]=R_{h}(s_{h},a_{h})\,.
s_{h+1}\sim\mathbb{P}_{h}(\cdot\mid s_{h},a_{h})\,.
r_{H}
\mathbb{P}
R
d
\{\phi_{h}\}_{h\in[H]}\subseteq(\mathcal{S}\times\mathcal{A}\rightarrow\mathbb%
{R}^{d})
\{\psi_{h}\}_{h\in[H]}\subseteq(\mathcal{S}\rightarrow\mathbb{R}^{d})
\{w^{\star}_{h}\}_{h\in[H]}\subseteq\mathbb{R}^{d}
\{\phi_{h}\}_{h\in[H]}
\{\psi_{h}\}_{h\in[H]}
\{\phi_{h}\}_{h\in[H]}
(s,a,s^{\prime})\in\mathcal{S}\times\mathcal{A}\times\mathcal{S}
\displaystyle\mathbb{P}_{h}(s^{\prime}\mid s,a)=\langle\phi_{h}(s,a),\psi_{h}(%
s^{\prime})\rangle,
\displaystyle\mathbb{P}_{h}(s^{\prime}\mid s,a)
\displaystyle=\langle\phi_{h}(s,a),\psi_{h}(s^{\prime})\rangle,
\displaystyle R_{h}(s,a)=\langle\phi_{h}(s,a),w^{\star}_{h}\rangle.
\displaystyle R_{h}(s,a)
\displaystyle=\langle\phi_{h}(s,a),w^{\star}_{h}\rangle.
\max_{h,s,a}\|\phi_{h}(s,a)\|_{2}\leq 1,\quad\max_{h}\|w^{\star}_{h}\|_{2}\leq%
\sqrt{d},
V_{h+1}:\mathcal{S}\rightarrow[0,1]
\left\|\int_{s\in\mathcal{S}}V_{h+1}(s)\psi_{h+1}(s)ds\right\|_{2}\leq\sqrt{d}.
\{\phi_{h}\}_{h\in[H]}
\{\psi_{h}\}_{h\in[H]}
\{w^{\star}_{h}\}_{h\in[H]}
\pi=\{\pi_{h}\}_{h\in[H]}
\pi_{h}(\cdot\mid s)\in\Delta_{\mathcal{A}}
s
h
\pi
\{V^{\pi}_{h}\}_{h\in[H]}\subseteq(\mathcal{S}\rightarrow\mathbb{R})
V_{h}^{\pi}(s)
\pi
s
h
s^{\prime}_{h+1}\sim\mathbb{P}_{h}(\cdot\mid s^{\prime}_{h},a^{\prime}_{h})
V^{\pi}_{h}(s)=\mathbb{E}\left[\sum_{h^{\prime}=h}^{H}r_{h^{\prime}}(s_{h^{%
\prime}},a_{h^{\prime}})\mid s_{h}=s,a_{h^{\prime}}\sim\pi_{h^{\prime}}(s_{h^{%
\prime}}),s^{\prime}_{h+1}\sim\mathbb{P}_{h}(\cdot\mid s^{\prime}_{h},a^{%
\prime}_{h})\right],
\pi
\{Q^{\pi}_{h}\}_{h\in[H]}\subseteq(\mathcal{S}\times\mathcal{A}\rightarrow%
\mathbb{R})
Q_{h}^{\pi}(s,a)
\pi
a
s
h
\displaystyle Q^{\pi}_{h}(s,a)=\mathbb{E}\Biggl{[}\sum_{h^{\prime}=h}^{H}r_{h^%
{\prime}}(s_{h^{\prime}},a_{h^{\prime}})\mid(s_{h},a_{h})=(s,a),a_{h^{\prime}}%
\sim\pi_{h^{\prime}}(s_{h^{\prime}}),s^{\prime}_{h+1}\sim\mathbb{P}_{h}(\cdot%
\mid s^{\prime}_{h},a^{\prime}_{h})\Biggr{]}.
\displaystyle Q^{\pi}_{h}(s,a)=\mathbb{E}\Biggl{[}\sum_{h^{\prime}=h}^{H}r_{h^%
{\prime}}(s_{h^{\prime}},a_{h^{\prime}})\mid(s_{h},a_{h})=(s,a),a_{h^{\prime}}%
\sim\pi_{h^{\prime}}(s_{h^{\prime}}),s^{\prime}_{h+1}\sim\mathbb{P}_{h}(\cdot%
\mid s^{\prime}_{h},a^{\prime}_{h})\Biggr{]}.
\pi^{\star}=\{\pi^{\star}_{h}\}_{h\in[H]}
\pi^{\star}\in{\rm argmax}_{\pi}V^{\pi}_{h}(s)
(s,h)\in\mathcal{S}\times[H]
V^{\star}_{h}=V^{\pi^{\star}}_{h}
Q^{\star}_{h}=Q^{\pi^{\star}}_{h}
\epsilon
\pi
V^{\pi}_{1}(s_{1})\geq V^{\star}_{1}(s_{1})-\epsilon
s_{1}
s_{1}
\pi^{k}
\mathcal{D}^{k}
m
m
\mathcal{D}^{k}
\pi^{k}
\{\overline{Q}^{k}_{h}\}_{h\in[H]}
\pi^{k}
\pi_{h}^{k}(\cdot\mid s)
\overline{Q}^{k}_{h}(s,\cdot)
\pi_{h}^{k+1}(\cdot\mid s)
(h,s)
\pi^{k}_{h}(\cdot\mid s)\propto\exp(\eta\sum_{t=1}^{k-1}\overline{Q}_{h}^{t}(s%
,\cdot))
\{\{\overline{Q}_{h}^{t}\}_{h\in[H]}\}_{t\in[K]}
\pi^{k}_{h}(\cdot\mid s)
\sum_{t=1}^{k-1}\overline{Q}_{h}^{t}(s,a)
a
k
K
m
N
\eta
(h,s)\in[H]\times\mathcal{S}
\pi^{1}_{h}(\cdot\mid s)={\rm Uniform}(\mathcal{A})
k=1,\ldots,K
k\equiv 1(\mbox{mod }m)
\mathcal{D}^{k}\leftarrow
\{N
\stackrel{{\scriptstyle\text{i.i.d.}}}{{\sim}}\pi^{k}\}
\mathcal{D}^{k}\leftarrow\mathcal{D}^{k-1}
\{\overline{Q}^{k}_{h}\}_{h\in[H]}\leftarrow\textsc{OPE}(\pi^{k},\mathcal{D}^{%
k})
(h,s)\in[H]\times\mathcal{S}
\pi^{k+1}_{h}(\cdot\mid s)\propto\pi^{k}_{h}(\cdot\mid s)\cdot\exp(\eta\cdot%
\overline{Q}_{h}^{k}(s,\cdot))
\pi^{\rm out}
\{\pi^{k}\}_{k\in[K]}
m
\eta
m\leq(\eta H^{2})^{-1}
1-\delta
\textsc{OPE}(\pi^{k},\mathcal{D}^{k})
\{\overline{Q}^{k}_{h}\}_{h\in[H]}\subseteq(\mathcal{S}\times\mathcal{A}%
\rightarrow[0,H])
k\in[K]
(s,a,h)\in\mathcal{S}\times\mathcal{A}\times[H]
\overline{Q}_{h}^{k}(s,a)\geq(\mathcal{T}^{\pi^{k}}_{h}\overline{Q}_{h+1}^{k})%
(s,a)
(\mathcal{T}^{\pi}_{h}f)(s,a)=R_{h}(s,a)+\mathbb{E}\left[f(s^{\prime},a^{%
\prime})\mid s^{\prime}\sim\mathbb{P}_{h}(\cdot\mid s,a),a^{\prime}\sim\pi_{h+%
1}(s^{\prime})\right].
L\in\mathbb{R}^{+}
\overline{V}_{1}^{k}(s_{1})-V_{1}^{\pi^{k}}(s_{1})\leq\sqrt{(L/N)\times\log^{2%
}(NKL/\delta)},
\overline{V}_{1}^{k}(s_{1})=\mathbb{E}\left[\overline{Q}_{1}^{k}(s_{1},a_{1})%
\mid a_{1}\sim\pi^{k}(s_{1})\right].
\pi^{k}
s_{1}
\sqrt{1/N}
N
\pi^{k}
\pi^{k}
m\leq(\eta H^{2})^{-1}
L
\displaystyle K=\Theta\left(\frac{H^{4}\log|\mathcal{A}|}{\epsilon^{2}}\right)%
,\quad N=\Theta\left(\frac{L\log^{2}(LK/\delta)}{\epsilon^{2}}\right),\eta=%
\Theta\left(\frac{\epsilon}{H^{3}}\right),\quad\quad m\leq\Theta\left(\frac{H}%
{\epsilon}\right),
\displaystyle K=\Theta\left(\frac{H^{4}\log|\mathcal{A}|}{\epsilon^{2}}\right)%
,\quad N=\Theta\left(\frac{L\log^{2}(LK/\delta)}{\epsilon^{2}}\right),
\displaystyle\eta=\Theta\left(\frac{\epsilon}{H^{3}}\right),\quad\quad m\leq%
\Theta\left(\frac{H}{\epsilon}\right),
1/2
\pi^{\rm out}
\mathcal{O}(\epsilon)
m
m=1
\frac{\text{\# iteration}}{\text{period of sampling}}\times\text{batch size}=%
\frac{K}{m}\times N=\tilde{\Theta}\left(\frac{LH^{4}}{\epsilon^{4}}\right),
m=[H/\epsilon]
\frac{\text{\# iteration}}{\text{period of sampling}}\times\text{batch size}=%
\frac{K}{m}\times N=\tilde{\Theta}\left(\frac{LH^{3}}{\epsilon^{3}}\right),
H/\epsilon
d
\delta\in(0,1)
\log(1/\delta)
\log(1/\delta)
\epsilon
\mathcal{D}
\pi
(\pi,\mathcal{D})
(\pi,\mathcal{D})
\alpha
\mathcal{D}
H
\mathcal{D}_{1},\ldots,\mathcal{D}_{H}
(\hat{\mathbb{P}}_{h},\hat{R}_{h})
h
\mathcal{D}_{h}
\overline{V}_{H+1}(s)\leftarrow 0
s\in\mathcal{S}
h=H:1
(s,a)\in\mathcal{S}\times\mathcal{A}
~{}\quad J_{h}(s,a)\leftarrow\sum_{(s_{h},a_{h})\in\mathcal{D}_{h}}\mathbf{1}(%
(s_{h},a_{h})=(s,a))
\vspace{-2mm}\begin{cases}\overline{Q}_{h}(s,a)=\min\big{\{}H-h+1,~{}\mathbb{E%
}_{s^{\prime}\sim\hat{\mathbb{P}}_{h}(s,a)}[\overline{V}_{h+1}(s^{\prime})]+%
\hat{R}_{h}(s,a)+b_{h}(s,a)\big{\}}\\
\overline{V}_{h}(s)=\mathbb{E}_{a\sim\pi_{h}(\cdot\mid s)}\left[\overline{Q}_{%
h}(s,a)\right]\end{cases}
b_{h}(s,a)=\alpha({J_{h}(s,a)+1})^{-1/2}
\{\overline{Q}_{h}\}_{h=1}^{H}
\alpha=\Theta\left(H\sqrt{\log(KH|\mathcal{S}||\mathcal{A}|)}\right)
L=SAH^{3}
\epsilon
(KN/m)=\tilde{\mathcal{O}}(H^{6}|\mathcal{S}||\mathcal{A}|/\epsilon^{3})
\tilde{\mathcal{O}}(H^{3}|\mathcal{S}||\mathcal{A}|/\epsilon^{2})
\textsc{OPE}(\pi,\mathcal{D})
\textsc{OPE}(\pi,\mathcal{D})
\alpha
\lambda
\mathcal{D}
H
\mathcal{D}_{1},\ldots,\mathcal{D}_{H}
\overline{V}_{H+1}(s)\leftarrow 0
s\in\mathcal{S}
h=H:1
\Sigma_{h}=\sum_{(s_{h},a_{h})\in\mathcal{D}_{h}}\phi_{h}(s_{h},a_{h})\phi_{h}%
(s_{h},a_{h})^{\rm T}
\begin{cases}\overline{Q}_{h}(s,a)={\rm Truncate}_{[0,H]}\big{(}\langle\hat{%
\theta}_{h},\phi_{h}(s,a)\rangle+b_{h}(s,a)\big{)}\\
\overline{V}_{h}(s)=\mathbb{E}_{a\sim\pi_{h}(\cdot\mid s)}\left[\overline{Q}_{%
h}(s,a)\right]\vspace{-2mm}\end{cases}
~{}\qquad b_{h}(s,a):=\alpha\times\|\phi_{h}(s,a)\|_{(\Sigma_{h}+\lambda%
\mathbf{I}_{d\times d})^{-1}}
\{\overline{Q}_{h}\}_{h=1}^{H}
\overline{Q}
Q^{\pi}
\pi
H
1
\overline{Q}_{h}
\overline{V}_{h+1}
\overline{V}_{h+1}:\mathcal{S}\rightarrow\mathbb{R}
\overline{\theta}_{h}\in\mathbb{R}^{d}
\langle\phi_{h}(s,a),\overline{\theta}_{h}\rangle=R_{h}(s,a)+\mathbb{E}_{s^{%
\prime}\sim\mathbb{P}_{h}(\cdot\mid s,a)}[\overline{V}_{h+1}(s^{\prime})]
(s,a)\in\mathcal{S}\times\mathcal{A}
b_{h}(s,a)
\hat{\theta}_{h}
\overline{\theta}_{h}
\overline{Q}_{h}(s,a)\geq(\mathcal{T}_{h}^{\pi}\overline{Q}_{h+1})(s,a)
(s,a,h)
\displaystyle\hat{\theta}_{h}={\rm argmin}_{\theta}\sum_{(s_{h},a_{h},r_{h},s_%
{h+1})\in\mathcal{D}_{h}}\bigg{(}\phi_{h}(s_{h},a_{h})^{\rm T}\theta-r_{h}-%
\overline{V}_{h+1}(s_{h+1})\bigg{)}^{2}+\lambda\|\theta\|_{2}^{2}.
\displaystyle\hat{\theta}_{h}={\rm argmin}_{\theta}\sum_{(s_{h},a_{h},r_{h},s_%
{h+1})\in\mathcal{D}_{h}}\bigg{(}\phi_{h}(s_{h},a_{h})^{\rm T}\theta-r_{h}-%
\overline{V}_{h+1}(s_{h+1})\bigg{)}^{2}+\lambda\|\theta\|_{2}^{2}.
\lambda=1
\alpha=\Theta\left(H\sqrt{d\log(KN)}\right)
L=d^{2}H^{3}
(KN/m)=\tilde{\mathcal{O}}(d^{2}H^{6}/\epsilon^{3})
\epsilon
d
\sqrt{d}
(\pi,\mathcal{D})
(\pi,\mathcal{D})
\beta
\mathcal{D}
H
\mathcal{D}_{1},\ldots,\mathcal{D}_{H}
\overline{V}_{H+1}(s)\leftarrow 0
s\in\mathcal{S}
h=H:1
(s,a)\in\mathcal{S}\times\mathcal{A}
\mathcal{B}_{h}=\{f_{h}\in\mathcal{F}_{h}:~{}\mathcal{L}_{h}(\mathcal{D}_{h},f%
_{h})\leq\min_{g_{h}\in\mathcal{F}_{h}}\mathcal{L}_{h}(\mathcal{D}_{h},g_{h})+%
\beta\}\vspace{-2mm}
\mathcal{L}_{h}(\mathcal{D}_{h},\zeta)=\sum_{(s_{h},a_{h},r_{h},s_{h+1})\in%
\mathcal{D}_{h}}\left(\zeta(s_{h},a_{h})-r_{h}-\overline{V}_{h+1}(s_{h+1})%
\right)^{2}\vspace{-4mm}
\begin{cases}\overline{Q}_{h}(s,a)=\sup_{f_{h}\in\mathcal{B}_{h}}f_{h}(s,a)\\
\overline{V}_{h}(s)=\mathbb{E}_{a\sim\pi_{h}(\cdot\mid s)}\left[\overline{Q}_{%
h}(s,a)\right]\end{cases}
\{\overline{Q}_{h}\}_{h=1}^{H}
\mathcal{F}=\mathcal{F}_{1}\times\cdots\times\mathcal{F}_{H}
\mathcal{F}_{h}\subseteq(\mathcal{S}\times\mathcal{A}\rightarrow[0,H])
h\in[H]
\mathcal{B}_{h}
\mathcal{T}_{h}^{\pi}\overline{Q}_{h+1}
\mathcal{B}_{h}
f_{h}\in\mathcal{F}_{h}
\mathcal{D}_{h}
\beta
\beta=0
\mathcal{B}_{h}
\mathcal{B}_{h}
(s,a)\in\mathcal{S}\times\mathcal{A}
\overline{Q}_{h}(s,a)
\mathcal{B}_{h}
h\in[H]
V_{h+1}:\mathcal{S}\rightarrow[0,H]
\mathcal{T}_{h}V_{h+1}\in\mathcal{F}_{h}
[\mathcal{T}_{h}V_{h+1}](s,a)=R_{h}(s,a)+\mathbb{E}[V_{h+1}(s^{\prime})\mid s^%
{\prime}\sim\mathbb{P}_{h}(\cdot\mid s,a)]
\mathcal{T}_{h}
V_{h+1}
\mathcal{F}_{h}
\mathcal{F}
\mathcal{G}
\mathcal{X}
\mathbb{R}
\epsilon>0
\epsilon
\mathcal{G}
d_{E}(\mathcal{G},\epsilon)
L\in\mathbb{N}^{+}
x_{1},\ldots,x_{L}\in\mathcal{X}
g_{1},g_{1}^{\prime},\ldots,g_{L},g_{L}^{\prime}\in\mathcal{G}
l\in[L]
\sum_{i<l}(g_{l}(x_{i})-g_{l}^{\prime}(x_{i}))^{2}\leq\epsilon
g_{l}(x_{l})-g_{l}^{\prime}(x_{l})\geq\epsilon
d_{E}(\mathcal{G},\epsilon)
\mathcal{G}
\epsilon
\beta=\Theta\left(H^{2}\log(|\mathcal{F}|NK/\delta)\right)
L=H^{3}\log(|\mathcal{F}|)\max_{h}d_{E}(\mathcal{F}_{h},1/N)
(KN/m)=\tilde{\mathcal{O}}(d_{E}\log(|\mathcal{F}|)H^{6}/\epsilon^{3})
\epsilon
d
d
d
1/\epsilon
1/\epsilon
\pi^{\rm out}
\{\pi^{k}\}_{k\in[K]}
\displaystyle\mathbb{E}\left[V^{\star}_{1}(s_{1})-V_{1}^{\pi^{\rm out}}(s_{1})\right]
\displaystyle\mathbb{E}\left[V^{\star}_{1}(s_{1})-V_{1}^{\pi^{\rm out}}(s_{1})\right]
\displaystyle=\frac{1}{K}\sum_{k=1}^{K}\left[V_{1}^{\star}(s_{1})-V_{1}^{\pi^{%
k}}(s_{1})\right]
\displaystyle=\frac{1}{K}\sum_{k=1}^{K}\left[V_{1}^{\star}(s_{1})-V_{1}^{\pi^{%
k}}(s_{1})\right]
\displaystyle=\underbrace{\frac{1}{K}\sum_{k=1}^{K}\left[V_{1}^{\star}(s_{1})-%
\overline{V}_{1}^{k}(s_{1})\right]}_{\rm\textbf{Term (I)}}+\underbrace{\frac{1%
}{K}\sum_{k=1}^{K}\left[\overline{V}_{1}^{k}(s_{1})-V_{1}^{\pi^{k}}(s_{1})%
\right]}_{\rm\textbf{ Term (II)}}.
\displaystyle=\underbrace{\frac{1}{K}\sum_{k=1}^{K}\left[V_{1}^{\star}(s_{1})-%
\overline{V}_{1}^{k}(s_{1})\right]}_{\rm\textbf{Term (I)}}+\underbrace{\frac{1%
}{K}\sum_{k=1}^{K}\left[\overline{V}_{1}^{k}(s_{1})-V_{1}^{\pi^{k}}(s_{1})%
\right]}_{\rm\textbf{ Term (II)}}.
\pi
k\in[K]
\displaystyle V_{1}^{\pi}(s_{1})-\overline{V}_{1}^{k}(s_{1})
\displaystyle V_{1}^{\pi}
\displaystyle(s_{1})-\overline{V}_{1}^{k}(s_{1})
\displaystyle=\sum_{h=1}^{H}\mathbb{E}_{s_{h}\sim\pi}\left[\langle\pi_{h}(%
\cdot\mid s_{h})-\pi^{k}_{h}(\cdot\mid s_{h}),\overline{Q}^{k}_{h}(s_{h},\cdot%
)\rangle\right]
\displaystyle=
\displaystyle\sum_{h=1}^{H}\mathbb{E}_{s_{h}\sim\pi}\left[\langle\pi_{h}(\cdot%
\mid s_{h})-\pi^{k}_{h}(\cdot\mid s_{h}),\overline{Q}^{k}_{h}(s_{h},\cdot)%
\rangle\right]
\displaystyle-\sum_{h=1}^{H}\mathbb{E}_{(s_{h},a_{h})\sim\pi}\Biggl{[}%
\overline{Q}_{h}^{k}(s_{h},a_{h})-(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}%
^{k})(s_{h},a_{h})\Biggr{]}.
\displaystyle-\sum_{h=1}^{H}\mathbb{E}_{(s_{h},a_{h})\sim\pi}\Biggl{[}%
\overline{Q}_{h}^{k}(s_{h},a_{h})-(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}%
^{k})(s_{h},a_{h})\Biggr{]}.
\pi=\pi^{\star}
\displaystyle{\rm Term(I)}=\frac{1}{K}\sum_{k=1}^{K}\left[V_{1}^{\star}(s_{1})%
-\overline{V}_{1}^{k}(s_{1})\right]
\displaystyle{\rm Term(I)}=\frac{1}{K}\sum_{k=1}^{K}\left[V_{1}^{\star}(s_{1})%
-\overline{V}_{1}^{k}(s_{1})\right]
\displaystyle\leq H\max_{h,s}\left[\frac{1}{K}\sum_{k=1}^{K}\left\langle\pi_{h%
}^{\star}(\cdot\mid s)-\pi^{k}_{h}(\cdot\mid s),\overline{Q}^{k}_{h}(s,\cdot)%
\right\rangle\right]+H\max_{h,s,a}\Biggl{[}(\mathcal{T}_{h}^{\pi^{k}}\overline%
{Q}_{h+1}^{k}-\overline{Q}_{h}^{k})(s,a)\Biggr{]}
\displaystyle\leq H\max_{h,s}\left[\frac{1}{K}\sum_{k=1}^{K}\left\langle\pi_{h%
}^{\star}(\cdot\mid s)-\pi^{k}_{h}(\cdot\mid s),\overline{Q}^{k}_{h}(s,\cdot)%
\right\rangle\right]+H\max_{h,s,a}\Biggl{[}(\mathcal{T}_{h}^{\pi^{k}}\overline%
{Q}_{h+1}^{k}-\overline{Q}_{h}^{k})(s,a)\Biggr{]}
\displaystyle\leq\mathcal{O}\left(\frac{H\log|\mathcal{A}|}{\eta K}+\eta H^{3}%
\right)+H\max_{h,s,a}\Biggl{[}(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k}%
-\overline{Q}_{h}^{k})(s,a)\Biggr{]},
\displaystyle\leq\mathcal{O}\left(\frac{H\log|\mathcal{A}|}{\eta K}+\eta H^{3}%
\right)+H\max_{h,s,a}\Biggl{[}(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k}%
-\overline{Q}_{h}^{k})(s,a)\Biggr{]},
{\rm Term(I)}\leq\mathcal{O}\left(\frac{H\log|\mathcal{A}|}{\eta K}+\eta H^{3}%
\right).
{\rm Term(II)}\leq H\sqrt{(L/N)\times\log(NKL/\delta)}.
K
N
\eta
L
\overline{Q}_{h}^{k}
\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k}
\lambda
\alpha
1-\delta
(k,h,s,a)\in[K]\times[H]\times\mathcal{S}\times\mathcal{A}
\displaystyle 0\leq(\overline{Q}_{h}^{k}-\mathcal{T}_{h}^{\pi^{k}}\overline{Q}%
_{h+1}^{k})(s,a)\leq 2b_{h}^{k}(s,a),
\displaystyle 0\leq(\overline{Q}_{h}^{k}-\mathcal{T}_{h}^{\pi^{k}}\overline{Q}%
_{h+1}^{k})(s,a)\leq 2b_{h}^{k}(s,a),
\{b_{h}^{k}\}_{h\in[H]}
\textsc{OPE}(\pi^{k},\mathcal{D}^{k})
\sqrt{d}
m
h\in[H]
\overline{V}^{k}
\pi^{k}
\overline{V}_{1}^{k}(s_{1})-V_{1}^{\pi^{k}}(s_{1})=\sum_{h=1}^{H}\mathbb{E}_{%
\pi^{k}}[(\overline{Q}_{h}^{k}-\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k}%
)(s_{h},a_{h})]\leq 2\sum_{h=1}^{H}\mathbb{E}_{\pi^{k}}[b_{h}^{k}(s_{h},a_{h})].
t_{k}
k^{\rm th}
\{\pi^{k}\}_{k\in[K]}
\pi^{k}
\pi^{t_{k}}
\eta
m
\eta m\leq 1/H^{2}
k\in\mathbb{N^{+}}
f:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}^{+}
\mathbb{E}_{\pi^{k}}[f(s_{h},a_{h})]=\Theta\left(\mathbb{E}_{\pi^{t_{k}}}[f(s_%
{h},a_{h})]\right).
b_{h}^{k}=b_{h}^{t_{k}}
\overline{V}_{1}^{k}(s_{1})-V_{1}^{\pi^{k}}(s_{1})\leq\mathcal{O}\bigg{(}\max_%
{k\in[K]}\sum_{h=1}^{H}\mathbb{E}_{\pi^{t_{k}}}[b_{h}^{k}(s_{h},a_{h})]\bigg{)%
}=\mathcal{O}\bigg{(}\max_{k\in[K]}\sum_{h=1}^{H}\mathbb{E}_{\pi^{t_{k}}}[b_{h%
}^{t_{k}}(s_{h},a_{h})]\bigg{)}.
b_{h}^{t_{k}}
\mathcal{D}^{t_{k}}
\pi^{t_{k}}
\pi^{t_{k}}
N
\pi
\lambda\geq 1
\{(s_{h}^{n},a_{h}^{n})\}_{n=1}^{N}
\pi
\Sigma_{h}=\sum_{i=1}^{N}\phi_{h}(s_{h}^{i},a_{h}^{i})\phi_{h}^{\rm T}(s_{h}^{%
i},a_{h}^{i})
1-\delta
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\big{[}\|\phi_{h}(s_{h},a_{h})\|%
_{(\Sigma_{h}+\lambda\mathbf{I}_{d\times d})^{-1}}\big{]}=\mathcal{O}\left(%
\sqrt{\frac{d\log(N/\delta)}{N}}\right).
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\big{[}\|\phi_{h}(s_{h},a_{h})\|%
_{(\Sigma_{h}+\lambda\mathbf{I}_{d\times d})^{-1}}\big{]}=\mathcal{O}\left(%
\sqrt{\frac{d\log(N/\delta)}{N}}\right).
b_{h}^{k}
1-\delta
k\in[K]
\sum_{h=1}^{H}\mathbb{E}_{\pi^{t_{k}}}[b_{h}^{k}(s_{h},a_{h})]={\mathcal{O}}%
\left(Hd\sqrt{\frac{H\log^{2}(NKH/\delta)}{N}}\right)
|\mathcal{D}_{h}^{k}|=N/H
\overline{V}_{1}^{k}(s_{1})-V_{1}^{\pi^{k}}(s_{1})\leq{\mathcal{O}}\left(\sqrt%
{\frac{d^{2}H^{3}\log^{2}(KNH/\delta)}{N}}\right).
L=d^{2}H^{3}
\alpha
1-\delta
(k,h,s,a)\in[K]\times[H]\times\mathcal{S}\times\mathcal{A}
\displaystyle 0\leq(\overline{Q}_{h}^{k}-\mathcal{T}_{h}^{\pi^{k}}\overline{Q}%
_{h+1}^{k})(s,a)\leq 2b_{h}^{k}(s,a),
\displaystyle 0\leq(\overline{Q}_{h}^{k}-\mathcal{T}_{h}^{\pi^{k}}\overline{Q}%
_{h+1}^{k})(s,a)\leq 2b_{h}^{k}(s,a),
\{b_{h}^{k}\}_{h\in[H]}
\textsc{OPE}(\pi^{k},\mathcal{D}^{k})
\pi
\{(s_{h}^{n},a_{h}^{n})\}_{n=1}^{N}
\pi
J_{h}(s,a)=\sum_{i=1}^{N}\mathbf{1}((s_{h}^{i},a_{h}^{i})=(s,a))
1-\delta
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[\sqrt{\frac{1}{J_{h}(s,a)+%
1}}\right]=\mathcal{O}\left(\sqrt{\frac{SA\log(N/\delta)}{N}}\right).
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[\sqrt{\frac{1}{J_{h}(s,a)+%
1}}\right]=\mathcal{O}\left(\sqrt{\frac{SA\log(N/\delta)}{N}}\right).
c
1-\delta
(k,h,s,a)\in[K]\times[H]\times\mathcal{S}\times\mathcal{A}
\begin{aligned} 0\leq(\overline{Q}_{h}^{k}-\mathcal{T}_{h}^{\pi^{k}}\overline{%
Q}_{h+1}^{k})(s,a)\leq b_{h}(s,a,\mathcal{D}_{h}^{k}):=\end{aligned}\left(%
\begin{aligned} &\sup_{f_{h},f_{h}^{\prime}\in\mathcal{F}_{h}}f_{h}(s,a)-f_{h}%
^{\prime}(s,a)\\
\text{ s.t. }&\sum_{(s_{h},a_{h})\in\mathcal{D}_{h}^{k}}(f_{h}(s_{h},a_{h})-f_%
{h}^{\prime}(s_{h},a_{h}))^{2}\leq c\beta\end{aligned}\right).
\pi
\mathcal{D}_{h}=\{(s_{h}^{n},a_{h}^{n})\}_{n=1}^{N}
\pi
1-\delta
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[b_{h}(s,a,\mathcal{D}_{h})%
\right]=\mathcal{O}\left(H\sqrt{\frac{d_{E}(1/N,\mathcal{F}_{h})\beta}{N}}+H%
\sqrt{\frac{\log(1/\delta)}{N}}\right).
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[b_{h}(s,a,\mathcal{D}_{h})%
\right]=\mathcal{O}\left(H\sqrt{\frac{d_{E}(1/N,\mathcal{F}_{h})\beta}{N}}+H%
\sqrt{\frac{\log(1/\delta)}{N}}\right).
(k,h)\in[K]\times[H]
\overline{Q}_{h}^{k}
\overline{Q}_{h}^{k}(s,a)={\rm Truncate}_{[0,H-h+1]}\big{(}\langle\hat{\theta}%
_{h}^{k},\phi_{h}(s,a)\rangle+b_{h}^{k}(s,a)\big{)},
\hat{\theta}_{h}^{k}={\rm argmin}_{\theta}\sum_{(s_{h},a_{h},r_{h},s_{h+1})\in%
\mathcal{D}_{h}^{k}}\bigg{(}\phi_{h}(s_{h},a_{h})^{\rm T}\theta-r_{h}-%
\overline{V}_{h+1}^{k}(s_{h+1})\bigg{)}^{2}+\lambda\|\theta\|_{2}^{2},
b_{h}^{k}(s,a)=\alpha\times\|\phi_{h}(s,a)\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I%
}_{d\times d})^{-1}},\quad\text{and}\quad\Sigma_{h}^{k}=\sum_{(s_{h},a_{h})\in%
\mathcal{D}_{h}^{k}}\phi(s_{h},a_{h})(\phi(s_{h},a_{h}))^{\rm T}.
\theta_{h}^{k}
\|\theta_{h}^{k}\|_{2}\leq H\sqrt{d}
\langle\phi_{h}(s,a),\theta_{h}^{k}\rangle=R_{h}(s,a)+\mathbb{E}_{s^{\prime}%
\sim\mathbb{P}(\cdot\mid s,a)}\left[\overline{V}_{h+1}^{k}(s^{\prime})\right]%
\quad\text{for all }(s,a)\in\mathcal{S}\times\mathcal{A}.
(s,a)
\left|\langle\phi_{h}(s,a),\theta_{h}^{k}-\hat{\theta}_{h}^{k}\rangle\right|%
\leq b_{h}^{k}(s,a).
\{(s_{h}^{i},a_{h}^{i},r_{h}^{i},s_{h+1}^{i})\}_{i=1}^{M}
\mathcal{D}_{h}^{k}
\displaystyle\left|\langle\phi_{h}(s,a),\hat{\theta}_{h}^{k}-\theta_{h}^{k}%
\rangle\right|
\displaystyle\left|\langle\phi_{h}(s,a),\hat{\theta}_{h}^{k}-\theta_{h}^{k}%
\rangle\right|
\displaystyle=\bigg{|}\bigg{\langle}\phi_{h}(s,a)~{},~{}(\Sigma_{h}^{k}+%
\lambda\mathbf{I}_{d\times d})^{-1}\times
\displaystyle=
\displaystyle\bigg{|}\bigg{\langle}\phi_{h}(s,a)~{},~{}(\Sigma_{h}^{k}+\lambda%
\mathbf{I}_{d\times d})^{-1}\times
\displaystyle\left(\sum_{i=1}^{M}\phi_{h}(s_{h}^{i},a_{h}^{i})\left(r_{h}^{i}+%
\overline{V}_{h+1}^{k}(s_{h+1}^{i})-\phi_{h}(s_{h}^{i},a_{h}^{i})^{\rm T}%
\theta^{k}_{h}\right)-\lambda\theta_{h}^{k}\right)\bigg{\rangle}\bigg{|}
\displaystyle\left(\sum_{i=1}^{M}\phi_{h}(s_{h}^{i},a_{h}^{i})\left(r_{h}^{i}+%
\overline{V}_{h+1}^{k}(s_{h+1}^{i})-\phi_{h}(s_{h}^{i},a_{h}^{i})^{\rm T}%
\theta^{k}_{h}\right)-\lambda\theta_{h}^{k}\right)\bigg{\rangle}\bigg{|}
\displaystyle\leq\|\phi_{h}(s,a)\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I}_{d\times
d%
})^{-1}}\times
\displaystyle\leq
\displaystyle\|\phi_{h}(s,a)\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I}_{d\times d})%
^{-1}}\times
\displaystyle\left(\left\|\sum_{i=1}^{M}\phi_{h}(s_{h}^{i},a_{h}^{i})\left(r_{%
h}^{i}+\overline{V}_{h+1}^{k}(s_{h+1}^{i})-\phi_{h}(s_{h}^{i},a_{h}^{i})^{\rm T%
}\theta^{k}_{h}\right)\right\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I}_{d\times d})%
^{-1}}+H\sqrt{d}\right),
\displaystyle\left(\left\|\sum_{i=1}^{M}\phi_{h}(s_{h}^{i},a_{h}^{i})\left(r_{%
h}^{i}+\overline{V}_{h+1}^{k}(s_{h+1}^{i})-\phi_{h}(s_{h}^{i},a_{h}^{i})^{\rm T%
}\theta^{k}_{h}\right)\right\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I}_{d\times d})%
^{-1}}+H\sqrt{d}\right),
\|\lambda\theta_{h}^{k}\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I}_{d\times d})^{-1}%
}\leq\sqrt{\lambda}\|\theta_{h}^{k}\|_{2}\leq H\sqrt{d}.
\sqrt{d}
\mathcal{D}_{h}^{k}
\overline{V}_{h+1}^{k}
\pi^{t_{k}}
t_{k}
k^{\rm th}
\mathcal{D}^{t_{k}}
H
\{\mathcal{D}_{h}^{t_{k}}\}_{h=1}^{H}
\{\mathcal{D}_{h^{\prime}}^{t_{k}}\}_{h^{\prime}=h+1}^{H}
\{\pi_{h^{\prime}}^{l}\}_{h^{\prime}=h+1}^{H}
l\in[t_{k},t_{k}+m-1]
\{\overline{V}_{h+1}^{l}\}_{l=t_{k}}^{t_{k}+m-1}
\overline{V}_{h+1}^{k}
\mathcal{D}_{h}^{t_{k}}=\mathcal{D}_{h}^{k}
\pi^{t_{k}}
1-\delta
(k,h)\in[K]\times[H]
\left\|\sum_{i=1}^{M}\phi_{h}(s_{h}^{i},a_{h}^{i})\left(r_{h}^{i}+\overline{V}%
_{h+1}^{k}(s_{h+1}^{i})-\phi_{h}(s_{h}^{i},a_{h}^{i})^{\rm T}\theta^{k}_{h}%
\right)\right\|_{(\Sigma_{h}^{k}+\lambda\mathbf{I}_{d\times d})^{-1}}\leq%
\mathcal{O}\left(H\sqrt{d\log(MKH/\delta)}\right).
c>0
\pi,\hat{\pi}
\hat{\pi}_{h}(a\mid s)\propto\pi_{h}(a\mid s)\times\exp(L_{h}(s,a))
\{L_{h}(s,a)\}_{h\in[H]}
\mathcal{S}\times\mathcal{A}
[-1/H,1/H]
\tau_{H}:=(s_{1},a_{1},\ldots,s_{H},a_{H})\in(\mathcal{S}\times\mathcal{A})^{H}
\mathbb{P}^{\hat{\pi}}(\tau_{H})\leq c\times\mathbb{P}^{\pi}(\tau_{H}).
\pi
\hat{\pi}
\pi
(h,s,a)
\displaystyle\hat{\pi}_{h}(a\mid s)=\frac{\pi_{h}(a\mid s)\times\exp(L_{h}(s,a%
))}{\sum_{a^{\prime}}\pi_{h}(a^{\prime}\mid s)\times\exp(L_{h}(s,a^{\prime}))}
\displaystyle\hat{\pi}_{h}(a\mid s)
\displaystyle=\frac{\pi_{h}(a\mid s)\times\exp(L_{h}(s,a))}{\sum_{a^{\prime}}%
\pi_{h}(a^{\prime}\mid s)\times\exp(L_{h}(s,a^{\prime}))}
\displaystyle\leq\frac{\pi_{h}(a\mid s)\times\exp(1/H)}{\sum_{a^{\prime}}\pi_{%
h}(a^{\prime}\mid s)\exp(-1/H)}
\displaystyle\leq\frac{\pi_{h}(a\mid s)\times\exp(1/H)}{\sum_{a^{\prime}}\pi_{%
h}(a^{\prime}\mid s)\exp(-1/H)}
\displaystyle=\pi_{h}(a\mid s)\times\exp(2/H)\leq\pi_{h}(a\mid s)\times\left(1%
+\frac{\mathcal{O}(1)}{H}\right).
\displaystyle=\pi_{h}(a\mid s)\times\exp(2/H)\leq\pi_{h}(a\mid s)\times\left(1%
+\frac{\mathcal{O}(1)}{H}\right).
\tau_{H}:=(s_{1},a_{1},\ldots,s_{H},a_{H})
\displaystyle\mathbb{P}^{\hat{\pi}}(\tau_{H})=\left(\prod_{h=1}^{H-1}\mathbb{P%
}_{h}(s_{h+1}\mid s_{h},a_{h})\right)\times\left(\prod_{h=1}^{H}\hat{\pi}_{h}(%
a_{h}\mid s_{h})\right)
\displaystyle\mathbb{P}^{\hat{\pi}}(\tau_{H})=
\displaystyle\left(\prod_{h=1}^{H-1}\mathbb{P}_{h}(s_{h+1}\mid s_{h},a_{h})%
\right)\times\left(\prod_{h=1}^{H}\hat{\pi}_{h}(a_{h}\mid s_{h})\right)
\displaystyle\leq\left(\prod_{h=1}^{H-1}\mathbb{P}_{h}(s_{h+1}\mid s_{h},a_{h}%
)\right)\times\left(\prod_{h=1}^{H}\pi_{h}(a_{h}\mid s_{h})\right)\times\left(%
1+\frac{\mathcal{O}(1)}{H}\right)^{H}
\displaystyle\leq
\displaystyle\left(\prod_{h=1}^{H-1}\mathbb{P}_{h}(s_{h+1}\mid s_{h},a_{h})%
\right)\times\left(\prod_{h=1}^{H}\pi_{h}(a_{h}\mid s_{h})\right)\times\left(1%
+\frac{\mathcal{O}(1)}{H}\right)^{H}
\displaystyle=\mathcal{O}(1)\times\left(\prod_{h=1}^{H-1}\mathbb{P}_{h}(s_{h+1%
}\mid s_{h},a_{h})\right)\times\left(\prod_{h=1}^{H}\pi_{h}(a_{h}\mid s_{h})%
\right)=\mathcal{O}(1)\times\mathbb{P}^{\pi}(\tau_{H}).
\displaystyle=
\displaystyle\mathcal{O}(1)\times\left(\prod_{h=1}^{H-1}\mathbb{P}_{h}(s_{h+1}%
\mid s_{h},a_{h})\right)\times\left(\prod_{h=1}^{H}\pi_{h}(a_{h}\mid s_{h})%
\right)=\mathcal{O}(1)\times\mathbb{P}^{\pi}(\tau_{H}).
\mu,\nu
\mathcal{X}
\|\mu/\nu\|_{\infty}\leq\alpha
f:\mathcal{X}\rightarrow\mathbb{R}^{+}
\mathbb{E}_{\mu}[f(x)]\leq\alpha\mathbb{E}_{\nu}[f(x)]
\mathbb{E}_{\mu}[f(x)]=\int_{x}f(x)\mu(x)dx\leq\int_{x}f(x)(\alpha\nu(x))dx=%
\alpha\mathbb{E}_{\nu}[f(x)].
\pi^{k}_{h}(\cdot\mid s)\propto\pi^{t_{k}}_{h}(\cdot\mid s)\times\exp\left(%
\eta\sum_{i=t_{k}}^{k-1}\overline{Q}_{h}^{i}(s,\cdot)\right).
\eta
m
\eta m\leq 1/H^{2}
\left|\eta\sum_{i=t_{k}}^{k-1}\overline{Q}_{h}^{i}(s,\cdot)\right|\leq\eta(k-t%
_{k})H\leq\eta mH\leq 1/H.
\hat{\pi}=\pi^{k}
\pi=\pi^{t_{k}}
\tau_{H}\in(\mathcal{S}\times\mathcal{A})^{H}
\mathbb{P}^{\pi^{k}}(\tau_{H})\leq c\times\mathbb{P}^{\pi^{t_{k}}}(\tau_{H}).
\mathcal{X}=(\mathcal{S}\times\mathcal{A})^{H}
\mu=\mathbb{P}^{\pi^{k}}
\nu=\mathbb{P}^{\pi^{t_{k}}}
f:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}^{+}
\mathbb{E}_{\pi^{k}}[f(s_{h},a_{h})]=\mathcal{O}\left(\mathbb{E}_{\pi^{t_{k}}}%
[f(s_{h},a_{h})]\right).
\mathbb{E}_{\pi^{t_{k}}}[f(s_{h},a_{h})]=\mathcal{O}\left(\mathbb{E}_{\pi^{k}}%
[f(s_{h},a_{h})]\right)
\phi^{i}_{h}:=\phi_{h}(s_{h}^{i},a_{h}^{i})
\Sigma_{h}^{n}=\sum_{i=1}^{n-1}\phi_{h}^{i}(\phi_{h}^{i})^{\rm T}
n\in[N]
1-\delta
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\big{[}\|\phi_{h}(s_{h},a_{h})\|%
_{(\Sigma_{h}+\lambda\mathbf{I}_{d\times d})^{-1}}\big{]}
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\big{[}\|\phi_{h}(s_{h},a_{h})\|%
_{(\Sigma_{h}+\lambda\mathbf{I}_{d\times d})^{-1}}\big{]}
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{(s_{h},a_{h})\sim\pi}%
\big{[}\|\phi_{h}(s_{h},a_{h})\|_{(\Sigma_{h}^{n}+\lambda\mathbf{I}_{d\times d%
})^{-1}}\big{]}
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{(s_{h},a_{h})\sim\pi}%
\big{[}\|\phi_{h}(s_{h},a_{h})\|_{(\Sigma_{h}^{n}+\lambda\mathbf{I}_{d\times d%
})^{-1}}\big{]}
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\|\phi_{h}^{n}\|_{(\Sigma_{h}^{n}+%
\lambda\mathbf{I}_{d\times d})^{-1}}+\mathcal{O}\left(\sqrt{\frac{\log(1/%
\delta)}{N}}\right)
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\|\phi_{h}^{n}\|_{(\Sigma_{h}^{n}+%
\lambda\mathbf{I}_{d\times d})^{-1}}+\mathcal{O}\left(\sqrt{\frac{\log(1/%
\delta)}{N}}\right)
\displaystyle\leq\mathcal{O}\left(\sqrt{\frac{d\log N}{N}}\right)+\mathcal{O}%
\left(\sqrt{\frac{\log(1/\delta)}{N}}\right),
\displaystyle\leq\mathcal{O}\left(\sqrt{\frac{d\log N}{N}}\right)+\mathcal{O}%
\left(\sqrt{\frac{\log(1/\delta)}{N}}\right),
\Sigma_{h}^{n}\preceq\Sigma_{h}
\lambda=1
(k,h)\in[K]\times[H]
\overline{Q}_{h}^{k}
\overline{Q}_{h}^{k}(s,a)=\min\big{\{}H-h+1,~{}\mathbb{E}_{s^{\prime}\sim\hat{%
\mathbb{P}}_{h}^{k}(s,a)}[\overline{V}_{h+1}^{k}(s^{\prime})]+\hat{R}_{h}^{k}(%
s,a)+b_{h}^{k}(s,a)\big{\}}
\hat{\mathbb{P}}_{h}^{k}
\hat{\mathbb{R}}_{h}^{k}
h
\mathcal{D}_{h}^{k}
b_{h}^{k}(s,a)=\alpha({J_{h}^{k}(s,a)+1})^{-1/2}
J_{h}^{k}(s,a)=\sum_{(s_{h},a_{h})\in\mathcal{D}_{h}^{k}}\mathbf{1}((s_{h},a_{%
h})=(s,a))
(s,a)
\left|\left(\mathbb{E}_{s^{\prime}\sim\hat{\mathbb{P}}_{h}^{k}(s,a)}[\overline%
{V}_{h+1}^{k}(s^{\prime})]-\mathbb{E}_{s^{\prime}\sim\mathbb{P}_{h}(s,a)}[%
\overline{V}_{h+1}^{k}(s^{\prime})]\right)+\left(\hat{R}_{h}^{k}(s,a)-R_{h}(s,%
a)\right)\right|\leq b_{h}^{k}(s,a).
\{\overline{V}_{h+1}^{l}\}_{l=t_{k}}^{t_{k}+m-1}
\mathcal{D}_{h}^{t_{k}}=\mathcal{D}_{h}^{k}
\pi^{t_{k}}
\overline{V}_{h+1}^{k}
\hat{\mathbb{P}}_{h}^{k}
1-\delta
(k,h,s,a)\in[K]\times[H]\times\mathcal{S}\times\mathcal{A}
\displaystyle\left|\left(\mathbb{E}_{s^{\prime}\sim\hat{\mathbb{P}}_{h}^{k}(s,%
a)}[\overline{V}_{h+1}^{k}(s^{\prime})]-\mathbb{E}_{s^{\prime}\sim\mathbb{P}_{%
h}(s,a)}[\overline{V}_{h+1}^{k}(s^{\prime})]\right)+\left(\hat{R}_{h}^{k}(s,a)%
-R_{h}(s,a)\right)\right|
\displaystyle\left|\left(\mathbb{E}_{s^{\prime}\sim\hat{\mathbb{P}}_{h}^{k}(s,%
a)}[\overline{V}_{h+1}^{k}(s^{\prime})]-\mathbb{E}_{s^{\prime}\sim\mathbb{P}_{%
h}(s,a)}[\overline{V}_{h+1}^{k}(s^{\prime})]\right)+\left(\hat{R}_{h}^{k}(s,a)%
-R_{h}(s,a)\right)\right|
\displaystyle\leq\mathcal{O}\left(H\sqrt{\frac{\log(KNHSA/\delta)}{J_{h}^{k}(s%
,a)+1}}\right).
\displaystyle\leq\mathcal{O}\left(H\sqrt{\frac{\log(KNHSA/\delta)}{J_{h}^{k}(s%
,a)+1}}\right).
J_{h}^{n}(s,a)=\sum_{i=1}^{n-1}\mathbf{1}((s_{h}^{i},a_{h}^{i})=(s,a))
n\in[N]
1-\delta
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[\sqrt{\frac{1}{J_{h}(s,a)+%
1}}\right]
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[\sqrt{\frac{1}{J_{h}(s,a)+%
1}}\right]
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{(s_{h},a_{h})\sim\pi}%
\left[\sqrt{\frac{1}{J_{h}^{n}(s,a)+1}}\right]
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{(s_{h},a_{h})\sim\pi}%
\left[\sqrt{\frac{1}{J_{h}^{n}(s,a)+1}}\right]
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\sqrt{\frac{1}{J_{h}^{n}(s_{h}^{n},a%
_{h}^{n})+1}}+\mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{N}}\right)
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\sqrt{\frac{1}{J_{h}^{n}(s_{h}^{n},a%
_{h}^{n})+1}}+\mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{N}}\right)
\displaystyle\leq\mathcal{O}\left(\sqrt{\frac{SA\log N}{N}}\right)+\mathcal{O}%
\left(\sqrt{\frac{\log(1/\delta)}{N}}\right),
\displaystyle\leq\mathcal{O}\left(\sqrt{\frac{SA\log N}{N}}\right)+\mathcal{O}%
\left(\sqrt{\frac{\log(1/\delta)}{N}}\right),
J_{h}^{n}(s,a)\leq J_{h}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
\mathcal{D}_{h}^{k}
\overline{V}_{h+1}^{k}
\pi^{t_{k}}
t_{k}
k+1
\mathcal{B}_{h}^{k}
c
1-\delta
k\in[K]
h\in[H]
\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k}\in\mathcal{B}_{h}^{k}
f_{h}\in\mathcal{B}_{h}^{k}
\sum_{(s_{h},a_{h})\in\mathcal{D}_{h}^{k}}(f_{h}(s_{h},a_{h})-\mathcal{T}_{h}^%
{\pi^{k}}\overline{Q}_{h+1}^{k}(s_{h},a_{h}))^{2}\leq c\beta
\bar{\mathcal{B}}_{h}^{k}=\{f_{h}\in\mathcal{F}_{h}:~{}\sum_{(s_{h},a_{h})\in%
\mathcal{D}_{h}^{k}}(f_{h}(s_{h},a_{h})-(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}%
_{h+1}^{k})(s_{h},a_{h}))^{2}\leq c\beta\}.
\overline{Q}_{h}^{k}
\displaystyle(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k})(s,a)\leq\sup_{f%
_{h}\in\mathcal{B}_{h}^{k}}f_{h}(s,a)=\overline{Q}_{h}^{k}(s,a)
\displaystyle(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_{h+1}^{k})(s,a)\leq\sup_{f%
_{h}\in\mathcal{B}_{h}^{k}}f_{h}(s,a)=\overline{Q}_{h}^{k}(s,a)
\displaystyle\overline{Q}_{h}^{k}(s,a)-(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_%
{h+1}^{k})(s,a)\leq\sup_{f_{h},f^{\prime}_{h}\in\mathcal{B}^{k}_{h}}(f_{h}(s,a%
)-f_{h}^{\prime}(s,a))\leq\sup_{f_{h},f^{\prime}_{h}\in\bar{\mathcal{B}}^{k}_{%
h}}(f_{h}(s,a)-f_{h}^{\prime}(s,a)),
\displaystyle\overline{Q}_{h}^{k}(s,a)-(\mathcal{T}_{h}^{\pi^{k}}\overline{Q}_%
{h+1}^{k})(s,a)\leq\sup_{f_{h},f^{\prime}_{h}\in\mathcal{B}^{k}_{h}}(f_{h}(s,a%
)-f_{h}^{\prime}(s,a))\leq\sup_{f_{h},f^{\prime}_{h}\in\bar{\mathcal{B}}^{k}_{%
h}}(f_{h}(s,a)-f_{h}^{\prime}(s,a)),
\bar{\mathcal{B}}_{h}^{k}\subset\mathcal{B}_{h}^{k}
b_{h}(s,a,\mathcal{D}_{h}):=\left(\begin{aligned} &\sup_{f_{h},f_{h}^{\prime}%
\in\mathcal{F}_{h}}f_{h}(s,a)-f_{h}^{\prime}(s,a)\\
\text{ s.t. }&\sum_{(s_{h},a_{h})\in\mathcal{D}_{h}}(f_{h}(s_{h},a_{h})-f_{h}^%
{\prime}(s_{h},a_{h}))^{2}\leq c\beta\end{aligned}\right),
b_{h}(s,a,\mathcal{D}_{h})\leq b_{h}(s,a,\underline{\mathcal{D}}_{h})
\underline{\mathcal{D}}_{h}\subseteq\mathcal{D}_{h}
\mathcal{D}_{h}^{(n)}=\{(s_{h}^{i},a_{h}^{i})\}_{i=1}^{n}
1-\delta
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[b_{h}(s,a,\mathcal{D}_{h})%
\right]\leq\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[b_{%
h}(s,a,\mathcal{D}_{h}^{(n-1)})\right]
\displaystyle\mathbb{E}_{(s_{h},a_{h})\sim\pi}\left[b_{h}(s,a,\mathcal{D}_{h})\right]
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{(s_{h},a_{h})\sim\pi}%
\left[b_{h}(s,a,\mathcal{D}_{h}^{(n-1)})\right]
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}b_{h}(s_{h}^{n},a_{h}^{n},\mathcal{D%
}_{h}^{(n-1)})+\mathcal{O}\left(H\sqrt{\frac{\log(1/\delta)}{N}}\right)
\displaystyle\leq\frac{1}{N}\sum_{n=1}^{N}b_{h}(s_{h}^{n},a_{h}^{n},\mathcal{D%
}_{h}^{(n-1)})+\mathcal{O}\left(H\sqrt{\frac{\log(1/\delta)}{N}}\right)
\displaystyle\leq\mathcal{O}\left(H\sqrt{\frac{d_{E}(1/N,\mathcal{F}_{h})\beta%
}{N}}+H\sqrt{\frac{\log(1/\delta)}{N}}\right),
\displaystyle\leq\mathcal{O}\left(H\sqrt{\frac{d_{E}(1/N,\mathcal{F}_{h})\beta%
}{N}}+H\sqrt{\frac{\log(1/\delta)}{N}}\right),
