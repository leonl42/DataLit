\beta
\beta
\cO(1/n)
(1-\gamma)^{-6}
H^{5}
H^{3}
Q
5
0.1
H=5
(\cH,\cS,\cA,r,p)
\cH=\{0,\dots,H-1\}
\cS=\cS_{0}\cup\cdots\cup\cS_{H-1}
\cA=\bigcup_{s\in\cS}\cA_{s}
r:\cS\times\cA\to\mathbb{R}
p:\cS\times\cA\to\Delta(\cS)
p(\cS_{h+1}|s,a)=1
h<H-1
s\in\cS_{h}
a\in\cA_{s}
\Delta(D)
D
\pi=(\pi_{h})_{h=0}^{H-1}
\pi_{h}:\cS_{h}\to\Delta(\cA)
h\in\mathcal{H}
\pi_{h}(\cA_{s}|s)=1
s\in\cS_{h}
h
\pi
V_{h}^{\pi_{(h)}}(\mu_{h}):=\mathbb{E}_{\mu_{h}}^{\pi_{(h)}}\Big{[}\sum_{k=h}^%
{H-1}r(S_{k},A_{k})\Big{]},\quad h\in\cH,
\mu_{h}
\pi_{(h)}=(\pi_{k})_{k=h}^{H-1}
\pi
h
H-1
\mathbb{E}_{\mu_{h}}^{\pi_{(h)}}
S_{h}\sim\mu_{h}
A_{k}\sim\pi_{k}(\cdot|S_{k})
S_{k+1}\sim p(\cdot|S_{k},A_{k})
h\leq k<H-1
V_{0}
0
\pi_{0},...,\pi_{H-1}
V_{0}
h
h
d_{h}=\sum_{s\in\cS_{h}}|\cA_{s}|
\pi_{h}
\pi
\pi^{\theta}(a|s_{h})=\frac{\exp(\theta(s_{h},a))}{\sum_{a^{\prime}}\exp(%
\theta(s_{h},a^{\prime}))},\quad\theta=(\theta(s_{h},a))_{s_{h}\in\cS^{[\cH]},%
a\in\cA_{s_{h}}}\in\mathbb{R}^{\sum_{h}d_{h}},
\cS^{[\cH]}
\cS^{[\cH]}
0
\hat{\pi}^{\ast}\approx\pi^{\ast}
\gt^{(0)}\in\mathbb{R}^{\sum_{h}d_{h}}
\eta>0
N
\mu
n=0,\dots,N-1
\gt^{(n+1)}=\gt^{(n)}+\eta\,\nabla_{\gt}V_{0}^{\pi^{\gt^{(n)}}}(\mu)\big{|}_{%
\gt^{(n)}}
\hat{\pi}^{\ast}=\pi^{\gt^{(N)}}
J(\theta,\mu):=V_{0}^{\pi^{\gt}}(\mu)=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_%
{h=0}^{H-1}r(S_{h},A_{h})\Big{]}
\rho_{\mu}^{\pi^{\theta}}(s)=\sum_{h=0}^{H-1}\bbP_{\mu}^{\pi^{\theta}}(S_{h}=s)
\cS
d_{\mu}^{\pi^{\theta}}(s)=\frac{1}{H}\rho_{\mu}^{\pi^{\theta}}(s)
J^{\ast}(\mu)=\sup_{\gt}J(\theta,\mu)
J^{\ast}(\mu)=V_{0}^{\ast}(\mu)=\sup_{\pi\text{: Policy}}V_{0}^{\pi}(\mu)
H
\gt_{0},\dots,\gt_{H-1}
\gt_{h}\in\mathbb{R}^{d_{h}}
(\pi^{\gt_{h}})_{h=0}^{H-1}
h
\gt_{h}
h\in\cH
\pi^{\gt_{h}}(a|s)=\frac{\exp(\gt_{h}(s,a))}{\sum_{a^{\prime}\in\cA}\exp(\gt_{%
h}(s,a^{\prime}))},\quad\gt_{h}=(\gt_{h}(s,a))_{s\in\cS_{h},a\in\cA_{s}}\in%
\mathbb{R}^{d_{h}}.
(\gt_{0},\dots,\gt_{H-1})
\gt
\gt_{h}(s_{h},a)=\gt(s_{h},a)
s_{h}\in\cS_{h}\subset\cS^{[\cH]}
\gt_{H-1}
V_{H-1}
\hat{\pi}^{\ast}\approx\pi^{\ast}
\gt^{(0)}=(\gt_{0}^{(0)},\dots,\gt_{H-1}^{(0)})\in\Theta
h=H-1,\dots,0
\eta_{h}
N_{h}
\mu_{h}
n=0,\dots,N_{h}-1
\gt_{h}^{(n+1)}=\gt_{h}^{(n)}+\eta_{h}\nabla_{\gt_{h}}V_{h}^{(\pi^{\gt_{h}},%
\hat{\pi}^{\ast}_{(h+1)})}(\mu_{h})\big{|}_{\gt_{h}^{(n)}}
\hat{\pi}_{h}^{\ast}=\pi^{\gt_{h}^{(N_{h})}}
\tilde{\pi}
J_{h}
h
h
(\pi^{\gt_{h}},\tilde{\pi}_{(h+1)}):=(\pi^{\gt_{h}},\tilde{\pi}_{h+1},\dots,%
\tilde{\pi}_{H-1})
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h}):=V_{h}^{(\pi^{\gt_{h}},\tilde{\pi}_%
{(h+1)})}(\mu_{h})=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt_{h}},\tilde{\pi}_{(h+1)})}%
\Big{[}\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}.
h
\tilde{\pi}_{(h+1)}
J_{h}
\gt_{h}
h
\gt_{h}^{\ast}
J_{h}(\cdot,\tilde{\pi}_{(h+1)},\delta_{s})
s\in\cS_{h}
\delta_{s}
s
\gt_{h}
\tilde{\pi}_{(h+1)}=\hat{\pi}^{\ast}_{(h+1)}
\nabla J(\gt,\mu)=\sum_{s_{h}\in\cS^{[\cH]}}\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{%
h})\sum_{a\in\cA_{s_{h}}}\pi^{\gt}(a|s_{h})\nabla\log(\pi^{\gt}(a|s_{h}))Q_{h}%
^{\pi^{\gt}}(s_{h},a),
Q
Q
\tilde{\rho}
Q_{h}^{\pi^{\gt}}
Q_{h}^{\pi^{\gt}}\approx Q_{h}^{\ast}
[0,R^{\ast}]
R^{\ast}>0
\cS^{[H]}
H
\beta
\beta=H^{2}R^{\ast}(2-\frac{1}{|\cA|})
\lVert\nabla J(\theta,\mu)\rVert_{2}\geq\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{%
\theta}(a^{\ast}(s_{h})|s_{h})}{\sqrt{|\cS^{[\cH]}|}}\Big{\lVert}\frac{d_{\mu}%
^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}\Big{\rVert}_{\infty}^{-1}(J^{\ast}(\mu)%
-J(\theta,\mu)).
\pi^{\ast}
\cS^{[\cH]}
a^{*}(s_{h})=\textrm{argmax}_{a\in\cA_{s_{h}}}\pi^{\ast}(a|s_{h})
s_{h}
\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}\Big{\rVert}_{%
\infty}:=\max_{s\in\cS}\frac{d_{\mu}^{\pi^{\ast}}(s)}{d_{\mu}^{\pi^{\theta}}(s)}
\gt
\cS_{h}=\cS
\min_{s\in\cS}\pi^{\gt}(a_{h}^{*}(s)|s)
\gt
c=c(\gt^{(0)})=\inf_{n}\min_{s\in\cS}\pi^{\gt^{(n)}}(a_{h}^{*}(s)|s)>0
\mu
\mu(s)>0
s\in\cS
\eta=\frac{1}{5H^{2}R^{\ast}}
(\theta^{(n)})
\theta^{(0)}
\epsilon>0
N=\frac{10H^{5}R^{\ast}|\cS|}{c^{2}\epsilon}\Big{\lVert}\frac{d_{\mu}^{\pi^{%
\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}
V_{0}^{\ast}(\mu)-V_{0}^{\pi^{\theta^{(N)}}}(\mu)\leq\epsilon.
(1-\gamma)^{-1}
H
H
(1-\gamma)^{-1}
c
H
\gamma
J_{h}
h\in\cH
h
\tilde{\pi}
\beta
J_{h}
\gamma=0
J_{h}
\gt_{h}
\beta_{h}=2(H-h)R^{\ast}
\lVert\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})\rVert_{2}\geq\min_{s%
\in\cS_{h}}\pi^{\gt_{h}}(a_{h}^{*}(s)|s)(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_%
{h})-J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})).
\beta
H
\min_{s\in\cS}\pi^{\gt_{h}}(a_{h}^{*}(s)|s)
\gt_{h}
\gamma=0
c_{h}=\inf_{n\geq 0}\min_{s\in\cS_{h}}\pi^{\gt_{h}^{(n)}}(a_{h}^{*}(s)|s)>0
c_{h}
h\in\mathcal{H}
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
0<\eta_{h}\leq\frac{1}{2(H-h)R^{*}}
\gt_{h}^{(0)}\in\cR^{d_{h}}
c_{h}=\frac{1}{|\cA|}>0
c
c>0
c_{h}>0
h
\beta
h\in\mathcal{H}
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
\eta_{h}=\frac{1}{2(H-h)R^{*}}
(\gt_{h}^{(n)})
\gt_{h}^{(0)}
\tilde{\pi}
\epsilon>0
N_{h}=\frac{4(H-h)R^{*}}{c_{h}^{2}\epsilon}
V_{h}^{(\pi_{h}^{\ast},\tilde{\pi}_{(h+1)})}(\mu_{h})-V_{h}^{(\pi^{\gt_{h}^{(N%
_{h})}},\tilde{\pi}_{(h+1)})}(\mu_{h})\leq\epsilon
\gt_{h}^{(0)}
c_{h}
\frac{1}{|\mathcal{A}|}
h
h
H
\mu_{h}
\mu
\cS_{0}
\frac{\epsilon}{H}
h
\epsilon
h\in\cH
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
\eta_{h}=\frac{1}{2(H-h)R^{*}}
\epsilon>0
N_{h}=\frac{4(H-h)HR^{*}}{c_{h}^{2}\epsilon}\big{\lVert}\frac{1}{\mu_{h}}\big{%
\rVert}_{\infty}
\hat{\pi}^{\ast}=(\pi^{\gt_{0}^{(N_{0})}},\dots,\pi^{\gt_{H-1}^{(N_{H-1})}})
s\in\cS_{0}
V_{0}^{\ast}(s)-V_{0}^{\hat{\pi}^{\ast}}(s)\leq\epsilon.
\gt_{h}^{(0)}
c_{h}
\frac{1}{|\mathcal{A}|}
c_{h}
c
\sum_{h}N_{h}
H^{3}
H^{5}
\frac{\epsilon}{H}
2
2
\gt
|\cS^{[H]}|=|\cS|H
\cO(\frac{1}{n})
p
c
c_{h}
c
c_{h}
\tau
\tau_{h}
\{\tau\geq n\}
\{\tau_{h}\geq n\}
\{\tau\geq n\}
\delta>0
\bbP(\tau\leq n)<\delta
+/-\infty
K
(s_{h}^{i},a_{h}^{i})_{h=0}^{H-1}
i=1,\dots,K
s_{0}^{i}\sim\mu
a_{h}^{i}\sim\pi^{\gt}(\cdot|s_{h}^{i})
s_{h}^{i}\sim p(\cdot|s_{h-1}^{i},a_{h-1}^{i})
0<h<H
\widehat{\nabla}J^{K}(\gt,\mu)=\frac{1}{K}\sum_{i=1}^{K}\sum_{h=0}^{H-1}\nabla%
\log(\pi^{\gt}(a_{h}^{i}|s_{h}^{i}))\hat{R}_{h}^{i},
\hat{R}_{h}^{i}=\sum_{k=h}^{H-1}r(s_{k}^{i},a_{k}^{i})
h
(s_{h}^{i},a_{h}^{i})
{\pi}^{\gt}
\bar{\gt}^{(n+1)}=\bar{\gt}^{(n)}+\eta\widehat{\nabla}J^{K}(\bar{\gt}^{(n)},%
\mu).
\mu
\mu(s)>0
s\in\cS
\hat{\pi}^{\ast}=\pi^{\bar{\gt}^{(N)}}
\delta,\epsilon>0
N\geq\big{(}\frac{21|\cS|H^{5}R^{\ast}}{\epsilon\delta c^{2}}\big{)}^{2}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{4}
\eta=\frac{1}{5H^{2}R^{\ast}\sqrt{N}}
K\geq\frac{10\max\{R^{\ast},1\}^{2}N^{3}}{c^{2}\delta^{2}}
\bbP\big{(}V_{0}^{\ast}(\mu)-V_{0}^{\hat{\pi}^{\ast}}(\mu)<\epsilon\big{)}>1-%
\delta\,.
h
K_{h}
(s_{k}^{i},a_{k}^{i})_{k=h}^{H-1}
i=1,\dots,K_{h}
s_{h}^{i}\sim\mu_{h}
a_{h}^{i}\sim\pi^{\gt}
a_{k}^{i}\sim\tilde{\pi}_{k}
h<k<H
\widehat{\nabla}J_{h}^{K}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})=\frac{1}{K_{h}}\sum%
_{i=1}^{K_{h}}\nabla\log(\pi^{\gt}(a_{h}^{i}|s_{h}^{i}))\hat{R}_{h}^{i},
\hat{R}_{h}^{i}=\sum_{k=h}^{H-1}r(s_{k}^{i},a_{k}^{i})
h
(s_{h}^{i},a_{h}^{i})
\tilde{\pi}
\gt_{h}
\bar{\gt}_{h}^{(n+1)}=\bar{\gt}_{h}^{(n)}+\eta_{h}\widehat{\nabla}J_{h}^{K_{h}%
}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}).
h\in\mathcal{H}
\mu_{h}
\mu_{h}(s)>0
h\in\cH
s\in\cS_{h}
\hat{\pi}^{\ast}=(\pi^{\bar{\gt}_{0}^{(N_{0})}},\dots,\pi^{\bar{\gt}_{H-1}^{(N%
_{H-1})}})
\delta,\epsilon>0
N_{h}\geq\Big{(}\frac{12(H-h)R^{\ast}H^{2}\big{\lVert}\frac{1}{\mu_{h}}\big{%
\rVert}_{\infty}}{\delta c_{h}^{2}\epsilon}\Big{)}^{2}
\eta_{h}=\frac{1}{2(H-h)R^{\ast}\sqrt{N_{h}}}
K_{h}\geq\frac{5N_{h}^{3}H^{2}}{c_{h}^{2}\delta^{2}}
\bbP\Big{(}\forall s\in\cS_{0}:V_{0}^{\ast}(s)-V_{0}^{\hat{\pi}^{\ast}}(s)<%
\epsilon\Big{)}>1-\delta.
N
N
c_{h}
c
H^{10}
H^{30}
H^{7}
H^{20}
\cO(1/n)
c
\cS^{[\cH]}
\cS^{[\cH]}
\cS_{h}=\{s^{1},\dots,s^{L_{h}}\}
\cD_{h}=\cS_{h}\times\{h\}=\{s_{h}^{1},\dots,s_{h}^{L_{h}}\}
h=0,\dots,H-1
\cS^{[\cH]}:=\cD_{0}\uplus\dots\uplus\cD_{H-1}
h
(s,a)\in\cS_{h}\times\cA_{s}
\displaystyle Q_{h}^{\pi_{(h+1)}}(s,a):=r(s,a)+\sum_{s^{\prime}\in\cS_{h+1}}p(%
s^{\prime}|s,a)V_{h+1}^{\pi_{(h+1)}}(s^{\prime}),\quad h\leq H-2,
\displaystyle Q_{h}^{\pi_{(h+1)}}(s,a):=r(s,a)+\sum_{s^{\prime}\in\cS_{h+1}}p(%
s^{\prime}|s,a)V_{h+1}^{\pi_{(h+1)}}(s^{\prime}),\quad h\leq H-2,
V_{h}^{\pi}(s)=V_{h}^{\pi}(\delta_{s})
h
s\in\cS_{h}
Q_{h}
\pi_{h}
H-1
Q_{H-1}(s,a):=r(s,a)
h
\displaystyle A_{h}^{\pi_{(h)}}(s,a):=Q_{h}^{\pi_{(h+1)}}(s,a)-V_{h}^{\pi_{(h)%
}}(s),\quad s\in\cS_{h},a\in\cA_{s}.
\displaystyle A_{h}^{\pi_{(h)}}(s,a):=Q_{h}^{\pi_{(h+1)}}(s,a)-V_{h}^{\pi_{(h)%
}}(s),\quad s\in\cS_{h},a\in\cA_{s}.
\pi_{(h)}
\pi
V_{h}
Q_{h}
A_{h}
h
\cS^{[\cH]}
V
|\cS^{[\cH]}|
Q
A
|\cS^{[\cH]}|\times|\cA|
s_{h}\in\cS^{[\cH]}
h
V^{\pi^{\gt}}(s_{h}):=V_{h}^{\pi^{\gt}}(s_{h})
h
Q
A
\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h}):=\bbP_{\mu}^{\pi^{\gt}}(S_{h}=s_{h}),
s_{h}\in\cS^{[\cH]}
\tilde{d}_{\mu}^{\pi^{\gt}}=\frac{1}{H}\tilde{\rho}_{\mu}^{\pi^{\gt}}
\sum_{s_{h}\in\cS^{[\cH]}}\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})=\sum_{s\in\cS}%
{\rho}_{\mu}^{\pi^{\gt}}(s)=H
h\in\cH
\pi
\pi^{\prime}
s\in\cS_{h}
\displaystyle V_{h}^{\pi}(s)-V_{h}^{\pi^{\prime}}(s)=\sum\limits_{k=h}^{H-1}%
\mathbb{E}_{S_{h}=s}^{\pi}\Big{[}A_{k}^{\pi^{\prime}}(S_{k},A_{k})\Big{]}.
\displaystyle V_{h}^{\pi}(s)-V_{h}^{\pi^{\prime}}(s)=\sum\limits_{k=h}^{H-1}%
\mathbb{E}_{S_{h}=s}^{\pi}\Big{[}A_{k}^{\pi^{\prime}}(S_{k},A_{k})\Big{]}.
\displaystyle V_{h}^{\pi}(s)-V_{h}^{\pi^{\prime}}(s)=\mathbb{E}_{S_{h}=s}^{\pi%
_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}-V_{h}^{\pi^{\prime}%
}(s)
\displaystyle V_{h}^{\pi}(s)-V_{h}^{\pi^{\prime}}(s)
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})\Big{]}-V_{h}^{\pi^{\prime}}(s)
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})+\sum\limits_{k=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})-\sum\limits_{k%
=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}-V_{h}^{\pi^{\prime}}(s)
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})+\sum\limits_{k=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})-\sum\limits_{k%
=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}-V_{h}^{\pi^{\prime}}(s)
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})+\sum\limits_{k=h+1}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})-\sum\limits_%
{k=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})+\sum\limits_{k=h+1}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})-\sum\limits_%
{k=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})+\sum\limits_{k=h}^{H-2}V_{k+1}^{\pi^{\prime}}(S_{k+1})-\sum%
\limits_{k=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}r(%
S_{k},A_{k})+\sum\limits_{k=h}^{H-2}V_{k+1}^{\pi^{\prime}}(S_{k+1})-\sum%
\limits_{k=h}^{H-1}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}%
\big{(}r(S_{k},A_{k})+V_{k+1}^{\pi^{\prime}}(S_{k+1})-V_{k}^{\pi^{\prime}}(S_{%
k})\big{)}\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}%
\big{(}r(S_{k},A_{k})+V_{k+1}^{\pi^{\prime}}(S_{k+1})-V_{k}^{\pi^{\prime}}(S_{%
k})\big{)}\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}A_%
{k}^{\pi^{\prime}}(S_{k},A_{k})\Big{]}
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}\sum\limits_{k=h}^{H-1}A_%
{k}^{\pi^{\prime}}(S_{k},A_{k})\Big{]}
\displaystyle=\sum\limits_{k=h}^{H-1}\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}A_%
{k}^{\pi^{\prime}}(S_{k},A_{k})\Big{]},
\displaystyle=\sum\limits_{k=h}^{H-1}\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}A_%
{k}^{\pi^{\prime}}(S_{k},A_{k})\Big{]},
r(S_{k},A_{k})+V_{k+1}^{\pi^{\prime}}(S_{k+1})=Q_{k}^{\pi^{\prime}}(S_{k},A_{k})
V_{H}\equiv 0
Q_{H-1}\equiv r
J(\gt,\mu)
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})
J(\gt,\mu)
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle J^{\ast}(\mu)-J(\gt,\mu)=\mathbb{E}_{\mu}^{\pi^{\ast}}\Big{[}%
\sum\limits_{h=0}^{H-1}A_{h}^{\pi^{\gt}}(S_{h},A_{h})\Big{]}=\sum_{s_{h}\in\cS%
^{[\cH]}}\tilde{\rho}_{\mu}^{\pi^{\ast}}(s_{h})A_{h}^{\pi^{\gt}}(s_{h},a^{\ast%
}(s_{h}))
\displaystyle J^{\ast}(\mu)-J(\gt,\mu)=\mathbb{E}_{\mu}^{\pi^{\ast}}\Big{[}%
\sum\limits_{h=0}^{H-1}A_{h}^{\pi^{\gt}}(S_{h},A_{h})\Big{]}=\sum_{s_{h}\in\cS%
^{[\cH]}}\tilde{\rho}_{\mu}^{\pi^{\ast}}(s_{h})A_{h}^{\pi^{\gt}}(s_{h},a^{\ast%
}(s_{h}))
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu)-J_{h}(\gt_{h},\tilde{\pi}_%
{(h+1)},\mu_{h})=\mathbb{E}_{\mu}^{\pi^{\ast}}\Big{[}A_{h}^{(\pi^{\gt},\tilde{%
\pi}_{(h+1)})}(S_{h},A_{h})\Big{]}.
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu)-J_{h}(\gt_{h},\tilde{\pi}_%
{(h+1)},\mu_{h})=\mathbb{E}_{\mu}^{\pi^{\ast}}\Big{[}A_{h}^{(\pi^{\gt},\tilde{%
\pi}_{(h+1)})}(S_{h},A_{h})\Big{]}.
h\in\cH
\pi
\pi^{\prime}
\pi_{(h+1)}=\pi^{\prime}_{(h+1)}
\displaystyle V_{h}^{\pi}(s)-V_{h}^{\pi^{\prime}}(s)=\mathbb{E}_{S_{h}=s}^{\pi%
_{(h)}}\Big{[}A_{h}^{\pi^{\prime}}(S_{h},A_{h})\Big{]}.
\displaystyle V_{h}^{\pi}(s)-V_{h}^{\pi^{\prime}}(s)=\mathbb{E}_{S_{h}=s}^{\pi%
_{(h)}}\Big{[}A_{h}^{\pi^{\prime}}(S_{h},A_{h})\Big{]}.
k>h
\displaystyle\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}A_{k}^{\pi^{\prime}}(S_{k}%
,A_{k})\Big{]}
\displaystyle\mathbb{E}_{S_{h}=s}^{\pi_{(h)}}\Big{[}A_{k}^{\pi^{\prime}}(S_{k}%
,A_{k})\Big{]}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi_{(h+1)}}\Big{[}Q_{k}^{\pi^{\prime}}(S_{%
k},A_{k})-V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi_{(h+1)}}\Big{[}Q_{k}^{\pi^{\prime}}(S_{%
k},A_{k})-V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}Q_{k}^{\pi^{%
\prime}}(S_{k},A_{k})-V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}Q_{k}^{\pi^{%
\prime}}(S_{k},A_{k})-V_{k}^{\pi^{\prime}}(S_{k})\Big{]}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\Big{(}\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}\mathbb{%
E}_{S_{k}}^{\pi^{\prime}}[Q_{k}^{\pi^{\prime}}(S_{k},A_{k})]\Big{]}-\mathbb{E}%
_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}V_{k}^{\pi^{\prime}}(S_{k})%
\Big{]}\Big{)}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\Big{(}\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}\mathbb{%
E}_{S_{k}}^{\pi^{\prime}}[Q_{k}^{\pi^{\prime}}(S_{k},A_{k})]\Big{]}-\mathbb{E}%
_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}V_{k}^{\pi^{\prime}}(S_{k})%
\Big{]}\Big{)}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\Big{(}\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}V_{k}^{%
\pi^{\prime}}(S_{k})\Big{]}-\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+%
1)}}\Big{[}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}\Big{)}
\displaystyle=\sum_{a\in\cA}\pi_{h}(a|s)\sum_{s^{\prime}\in\cS}p(s^{\prime}|s,%
a)\Big{(}\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+1)}}\Big{[}V_{k}^{%
\pi^{\prime}}(S_{k})\Big{]}-\mathbb{E}_{S_{h+1}=s^{\prime}}^{\pi^{\prime}_{(h+%
1)}}\Big{[}V_{k}^{\pi^{\prime}}(S_{k})\Big{]}\Big{)}
\displaystyle=0.
\displaystyle=0.
\pi^{\gt}
\cS^{[\cH]}
J(\gt,\mu)
\displaystyle\nabla J(\gt,\mu)=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{%
H}\nabla\log(\pi^{\gt}(A_{h}|S_{h}))Q_{h}^{\pi^{\gt}}(S_{h},A_{h})\Big{]}
\displaystyle\nabla J(\gt,\mu)
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H}\nabla\log(\pi^%
{\gt}(A_{h}|S_{h}))Q_{h}^{\pi^{\gt}}(S_{h},A_{h})\Big{]}
\displaystyle=\sum_{s_{h}\in\cS^{[\cH]}}\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})%
\sum_{a\in\cA_{s_{h}}}\pi^{\gt}(a|s_{h})\nabla\log(\pi^{\gt}(a|s_{h}))Q_{h}^{%
\pi^{\gt}}(s_{h},a_{h}).
\displaystyle=\sum_{s_{h}\in\cS^{[\cH]}}\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})%
\sum_{a\in\cA_{s_{h}}}\pi^{\gt}(a|s_{h})\nabla\log(\pi^{\gt}(a|s_{h}))Q_{h}^{%
\pi^{\gt}}(s_{h},a_{h}).
\tau=(s_{0},a_{0},\dots,s_{H-1},a_{H-1})
\pi^{\gt}
\mu
\displaystyle p_{\mu}^{\pi^{\gt}}(\tau)=\mu(s_{h})\pi^{\gt}(a_{0}|s_{0})\prod_%
{k=1}^{H-1}p(s_{k}|s_{k-1},a_{k-1})\pi^{\gt}(a_{k}|s_{k}).
\displaystyle p_{\mu}^{\pi^{\gt}}(\tau)=\mu(s_{h})\pi^{\gt}(a_{0}|s_{0})\prod_%
{k=1}^{H-1}p(s_{k}|s_{k-1},a_{k-1})\pi^{\gt}(a_{k}|s_{k}).
\displaystyle\nabla\log(p_{\mu}^{\pi^{\gt}}(\tau))=\nabla\Big{(}\log(\mu(s_{h}%
))+\log(\pi^{\gt}(a_{0}|s_{0}))
\displaystyle\nabla\log(p_{\mu}^{\pi^{\gt}}(\tau))
\displaystyle=\nabla\Big{(}\log(\mu(s_{h}))+\log(\pi^{\gt}(a_{0}|s_{0}))
\displaystyle\quad+\sum_{k=1}^{H-1}\log(p(s_{k}|s_{k-1},a_{k-1}))+\log(\pi^{%
\gt}(a_{k}|s_{k}))\Big{)}
\displaystyle\quad+\sum_{k=1}^{H-1}\log(p(s_{k}|s_{k-1},a_{k-1}))+\log(\pi^{%
\gt}(a_{k}|s_{k}))\Big{)}
\displaystyle=\nabla\sum_{k=0}^{H-1}\log(\pi^{\gt}(a_{k}|s_{k})),
\displaystyle=\nabla\sum_{k=0}^{H-1}\log(\pi^{\gt}(a_{k}|s_{k})),
\log
\cW
0
H-1
\cW
\displaystyle\begin{split}\nabla J(\gt,\mu)&=\nabla\sum_{\tau\in\cW}p_{\mu}^{%
\pi^{\gt}}(\tau)\sum_{k=0}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{\mu}^{\pi^{\gt}}(\tau)\nabla\log(p_{\mu}^{\pi^{\gt}}(%
\tau))\sum_{k=0}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{\mu}^{\pi^{\gt}}(\tau)\sum_{h=0}^{H-1}\nabla\log(\pi^{%
\gt}(a_{h}|s_{h}))\sum_{k=0}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{\mu}^{\pi^{\gt}}(\tau)\sum_{h=0}^{H-1}\nabla\log(\pi^{%
\gt}(a_{h}|s_{h}))\sum_{k=h}^{H-1}r(s_{k},a_{k})\\
&=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h%
}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}\\
&=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h%
}|S_{h}))\mathbb{E}_{S_{h}}^{\pi^{\gt}}\Big{[}\sum_{k=h}^{H-1}r(S_{k},A_{k})%
\big{|}S_{h},A_{h}\Big{]}\Big{]}\\
&=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h%
}|S_{h}))\,Q_{h}^{\pi^{\gt}}(S_{h},A_{h})\Big{]}.\end{split}
\displaystyle\begin{split}\nabla J(\gt,\mu)&=\nabla\sum_{\tau\in\cW}p_{\mu}^{%
\pi^{\gt}}(\tau)\sum_{k=0}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{\mu}^{\pi^{\gt}}(\tau)\nabla\log(p_{\mu}^{\pi^{\gt}}(%
\tau))\sum_{k=0}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{\mu}^{\pi^{\gt}}(\tau)\sum_{h=0}^{H-1}\nabla\log(\pi^{%
\gt}(a_{h}|s_{h}))\sum_{k=0}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{\mu}^{\pi^{\gt}}(\tau)\sum_{h=0}^{H-1}\nabla\log(\pi^{%
\gt}(a_{h}|s_{h}))\sum_{k=h}^{H-1}r(s_{k},a_{k})\\
&=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h%
}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}\\
&=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h%
}|S_{h}))\mathbb{E}_{S_{h}}^{\pi^{\gt}}\Big{[}\sum_{k=h}^{H-1}r(S_{k},A_{k})%
\big{|}S_{h},A_{h}\Big{]}\Big{]}\\
&=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h%
}|S_{h}))\,Q_{h}^{\pi^{\gt}}(S_{h},A_{h})\Big{]}.\end{split}
k<h
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_{%
h}))r(S_{k},A_{k})\Big{]}=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\mathbb{E}_{\mu}^%
{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\Big{|}S_{0},A_{0},\dots S%
_{h-1},A_{h-1},S_{h}\Big{]}r(S_{k},A_{k})\Big{]}
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_{%
h}))r(S_{k},A_{k})\Big{]}=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\mathbb{E}_{\mu}^%
{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\Big{|}S_{0},A_{0},\dots S%
_{h-1},A_{h-1},S_{h}\Big{]}r(S_{k},A_{k})\Big{]}
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_{%
h}))\Big{|}S_{0},A_{0},\dots S_{h-1},A_{h-1},S_{h}\Big{]}
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_{%
h}))\Big{|}S_{0},A_{0},\dots S_{h-1},A_{h-1},S_{h}\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_%
{h}))\Big{|}S_{h}\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\nabla\log(\pi^{\gt}(A_{h}|S_%
{h}))\Big{|}S_{h}\Big{]}
\displaystyle=\sum_{a\in\cA_{S_{h}}}\pi^{\gt}(a|S_{h})\nabla\log(\pi^{\gt}(A_{%
h}|S_{h}))
\displaystyle=\sum_{a\in\cA_{S_{h}}}\pi^{\gt}(a|S_{h})\nabla\log(\pi^{\gt}(A_{%
h}|S_{h}))
\displaystyle=\nabla\Big{(}\sum_{a\in\cA_{S_{h}}}\pi^{\gt}(a|S_{h})\Big{)}=0.
\displaystyle=\nabla\Big{(}\sum_{a\in\cA_{S_{h}}}\pi^{\gt}(a|S_{h})\Big{)}=0.
\tilde{\pi}
h\in\cH
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})
\displaystyle\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})=\mathbb{E}_{%
S_{h}=s,A_{h}\sim\pi^{\gt_{h}}(\cdot|s)}[\nabla\log(\pi^{\gt}(A_{h}|S_{h}))Q_{%
h}^{\tilde{\pi}}(S_{h},A_{h})].
\displaystyle\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})=\mathbb{E}_{%
S_{h}=s,A_{h}\sim\pi^{\gt_{h}}(\cdot|s)}[\nabla\log(\pi^{\gt}(A_{h}|S_{h}))Q_{%
h}^{\tilde{\pi}}(S_{h},A_{h})].
\tau=(s_{h},a_{h},\dots,s_{H-1},a_{H-1})
(\pi^{\gt},\tilde{\pi}_{(h+1)})=(\pi^{\gt},\tilde{\pi}_{h+1},\dots,\tilde{\pi}%
_{H-1})
\delta_{s}
\displaystyle p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)=\delta_{s}(s_{h})%
\pi^{\gt}(a_{h}|s_{h})\prod_{k=h+1}^{H-1}p(s_{k}|s_{k-1},a_{k-1})\tilde{\pi}_{%
k}(a_{k}|s_{k}).
\displaystyle p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)=\delta_{s}(s_{h})%
\pi^{\gt}(a_{h}|s_{h})\prod_{k=h+1}^{H-1}p(s_{k}|s_{k-1},a_{k-1})\tilde{\pi}_{%
k}(a_{k}|s_{k}).
\displaystyle\nabla\log(p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau))=\nabla%
\Big{(}\log(\delta_{s}(s_{h}))+\log(\pi^{\gt}(a_{h}|s_{h}))
\displaystyle\nabla\log(p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau))
\displaystyle=\nabla\Big{(}\log(\delta_{s}(s_{h}))+\log(\pi^{\gt}(a_{h}|s_{h}))
\displaystyle\quad+\sum_{k=h+1}^{H-1}\log(p(s_{k}|s_{k-1},a_{k-1}))+\log(%
\tilde{\pi}_{k}(a_{k}|s_{k}))\Big{)}
\displaystyle\quad+\sum_{k=h+1}^{H-1}\log(p(s_{k}|s_{k-1},a_{k-1}))+\log(%
\tilde{\pi}_{k}(a_{k}|s_{k}))\Big{)}
\displaystyle=\nabla\log(\pi^{\gt}(a_{h}|s_{h})),
\displaystyle=\nabla\log(\pi^{\gt}(a_{h}|s_{h})),
\log
\cW
h
H-1
\cW
s\in\cS_{h}
\displaystyle\begin{split}\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})%
&=\nabla\sum_{\tau\in\cW}p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)\sum_{k=%
h}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)\nabla\log(p_{%
s}^{A.4\pi^{\gt},\tilde{\pi}_{(h+1)})})\sum_{k=h}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)\nabla\log(\pi%
^{\gt}(a_{h}|s_{h}))\sum_{k=h}^{H-1}r(s_{k},a_{k})\\
&=\mathbb{E}_{S_{h}=s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}\Big{[}\nabla\log(\pi^%
{\gt}(A_{h}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}\\
&=\mathbb{E}_{S_{h}=s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}\Big{[}\nabla\log(\pi^%
{\gt}(A_{h}|S_{h}))\mathbb{E}_{S_{h}}^{\tilde{\pi}}\Big{[}\sum_{k=h}^{H-1}r(S_%
{k},A_{k})\big{|}S_{h},A_{h}\Big{]}\Big{]}\\
&=\mathbb{E}_{S_{h}=s,A_{h}\sim\pi^{\gt}(\cdot|s)}\Big{[}\nabla\log(\pi^{\gt}(%
A_{h}|S_{h}))\,Q_{h}^{\tilde{\pi}}(S_{h},A_{h})\Big{]}.\end{split}
\displaystyle\begin{split}\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})%
&=\nabla\sum_{\tau\in\cW}p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)\sum_{k=%
h}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)\nabla\log(p_{%
s}^{A.4\pi^{\gt},\tilde{\pi}_{(h+1)})})\sum_{k=h}^{H-1}r(s_{k},a_{k})\\
&=\sum_{\tau\in\cW}p_{s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(\tau)\nabla\log(\pi%
^{\gt}(a_{h}|s_{h}))\sum_{k=h}^{H-1}r(s_{k},a_{k})\\
&=\mathbb{E}_{S_{h}=s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}\Big{[}\nabla\log(\pi^%
{\gt}(A_{h}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}\\
&=\mathbb{E}_{S_{h}=s}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}\Big{[}\nabla\log(\pi^%
{\gt}(A_{h}|S_{h}))\mathbb{E}_{S_{h}}^{\tilde{\pi}}\Big{[}\sum_{k=h}^{H-1}r(S_%
{k},A_{k})\big{|}S_{h},A_{h}\Big{]}\Big{]}\\
&=\mathbb{E}_{S_{h}=s,A_{h}\sim\pi^{\gt}(\cdot|s)}\Big{[}\nabla\log(\pi^{\gt}(%
A_{h}|S_{h}))\,Q_{h}^{\tilde{\pi}}(S_{h},A_{h})\Big{]}.\end{split}
s\in\cS_{h}
a\in\cA_{s}
\displaystyle\pi^{\theta}(a|s)=\frac{e^{\theta(s,a)}}{\sum_{a^{\prime}\in\cA}e%
^{\theta(s,a^{\prime})}},
\displaystyle\pi^{\theta}(a|s)=\frac{e^{\theta(s,a)}}{\sum_{a^{\prime}\in\cA}e%
^{\theta(s,a^{\prime})}},
\theta\in\mathbb{R}^{d_{h}}
\displaystyle\frac{\partial\log(\pi^{\theta}(a|s))}{\partial\theta(a^{\prime},%
s^{\prime})}=\mathbf{1}_{\{s=s^{\prime}\}}(\mathbf{1}_{\{a=a^{\prime}\}}-\pi^{%
\theta}(a^{\prime}|s^{\prime})).
\displaystyle\frac{\partial\log(\pi^{\theta}(a|s))}{\partial\theta(a^{\prime},%
s^{\prime})}=\mathbf{1}_{\{s=s^{\prime}\}}(\mathbf{1}_{\{a=a^{\prime}\}}-\pi^{%
\theta}(a^{\prime}|s^{\prime})).
\displaystyle\nabla\log(\pi^{\theta}(a|s))=\Big{(}\mathbf{1}_{\{s=s^{\prime}\}%
}(\mathbf{1}_{\{a=a^{\prime}\}}-\pi^{\theta}(a^{\prime}|s^{\prime}))\Big{)}_{s%
^{\prime}\in\cS_{h},a^{\prime}\in\cA_{s^{\prime}}}\quad\in\mathbb{R}^{d_{h}}.
\displaystyle\nabla\log(\pi^{\theta}(a|s))=\Big{(}\mathbf{1}_{\{s=s^{\prime}\}%
}(\mathbf{1}_{\{a=a^{\prime}\}}-\pi^{\theta}(a^{\prime}|s^{\prime}))\Big{)}_{s%
^{\prime}\in\cS_{h},a^{\prime}\in\cA_{s^{\prime}}}\quad\in\mathbb{R}^{d_{h}}.
\displaystyle\frac{\partial J(\theta,\mu)}{\partial\theta(s_{h},a)}=\tilde{%
\rho}_{\mu}^{\pi^{\theta}}(s_{h})\pi^{\theta}(a|s_{h})A_{h}^{\pi^{\theta}}(s_{%
h},a),
\displaystyle\frac{\partial J(\theta,\mu)}{\partial\theta(s_{h},a)}=\tilde{%
\rho}_{\mu}^{\pi^{\theta}}(s_{h})\pi^{\theta}(a|s_{h})A_{h}^{\pi^{\theta}}(s_{%
h},a),
s_{h}\in\cS^{[\cH]}
a\in\cA_{s_{h}}
s_{h}\in\cS^{[\cH]}
a\in\cA_{s_{h}}
\displaystyle\frac{\partial J(\theta,\mu)}{\partial\theta(s_{h},a)}=\mathbb{E}%
_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\frac{\partial}{\partial\theta(s_{%
h},a)}\log(\pi^{\theta}(A_{h}|S_{h}))Q_{h}^{\pi^{\theta}}(S_{h},A_{h})\Big{]}
\displaystyle\frac{\partial J(\theta,\mu)}{\partial\theta(s_{h},a)}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\frac{%
\partial}{\partial\theta(s_{h},a)}\log(\pi^{\theta}(A_{h}|S_{h}))Q_{h}^{\pi^{%
\theta}}(S_{h},A_{h})\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\mathbf{1}%
_{\{S_{h}=s_{h}\}}\bigl{(}\mathbf{1}_{\{A_{h}=a\}}-\pi^{\theta}(a|s_{h})\bigr{%
)}Q_{h}^{\pi^{\theta}}(S_{h},A_{h})\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\mathbf{1}%
_{\{S_{h}=s_{h}\}}\bigl{(}\mathbf{1}_{\{A_{h}=a\}}-\pi^{\theta}(a|s_{h})\bigr{%
)}Q_{h}^{\pi^{\theta}}(S_{h},A_{h})\Big{]}
\displaystyle=\bbP_{\mu}^{\pi^{\theta}}(S_{h}=s_{h})\sum_{a^{\prime}}\pi^{%
\theta}(a^{\prime}|s_{h})\bigl{(}\mathbf{1}_{\{a^{\prime}=a\}}-\pi^{\theta}(a|%
s_{h})\bigr{)}Q_{h}^{\pi^{\theta}}(s_{h},a^{\prime})
\displaystyle=\bbP_{\mu}^{\pi^{\theta}}(S_{h}=s_{h})\sum_{a^{\prime}}\pi^{%
\theta}(a^{\prime}|s_{h})\bigl{(}\mathbf{1}_{\{a^{\prime}=a\}}-\pi^{\theta}(a|%
s_{h})\bigr{)}Q_{h}^{\pi^{\theta}}(s_{h},a^{\prime})
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\theta}}(s_{h})\Bigl{(}\pi^{\theta}(a|s%
_{h})Q^{\pi^{\theta}}(s_{h},a)-\sum_{a^{\prime}}\pi^{\theta}(a^{\prime}|s_{h})%
\pi^{\theta}(a|s_{h})Q_{h}^{\pi^{\theta}}(s_{h},a^{\prime})\Bigr{)}
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\theta}}(s_{h})\Bigl{(}\pi^{\theta}(a|s%
_{h})Q^{\pi^{\theta}}(s_{h},a)-\sum_{a^{\prime}}\pi^{\theta}(a^{\prime}|s_{h})%
\pi^{\theta}(a|s_{h})Q_{h}^{\pi^{\theta}}(s_{h},a^{\prime})\Bigr{)}
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\theta}}(s_{h})\pi^{\theta}(a|s_{h})A_{%
h}^{\pi^{\theta}}(s_{h},a).
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\theta}}(s_{h})\pi^{\theta}(a|s_{h})A_{%
h}^{\pi^{\theta}}(s_{h},a).
h\in\cH
\displaystyle\frac{\partial J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})}{\partial%
\gt(s,a)}=\mu_{h}(s)\pi^{\gt}(a|s)A_{h}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(s,a),
\displaystyle\frac{\partial J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})}{\partial%
\gt(s,a)}=\mu_{h}(s)\pi^{\gt}(a|s)A_{h}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(s,a),
s\in\cS_{h}
a\in\cA_{s}
\displaystyle\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})=\nabla\mathbb{E}_{s%
\sim\mu_{h}}[J_{h}(\theta,\tilde{\pi}_{(h+1)},\delta_{s})]
\displaystyle\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle=\nabla\mathbb{E}_{s\sim\mu_{h}}[J_{h}(\theta,\tilde{\pi}_{(h+1)}%
,\delta_{s})]
\displaystyle=\sum_{s\in\cS}\mu_{h}(s)\nabla J_{h}(\theta,\tilde{\pi}_{(h+1)},%
\delta_{s})
\displaystyle=\sum_{s\in\cS}\mu_{h}(s)\nabla J_{h}(\theta,\tilde{\pi}_{(h+1)},%
\delta_{s})
\displaystyle=\sum_{s\in\cS}\mu_{h}(s)\mathbb{E}_{S_{h}=s,A_{h}\sim\pi^{\gt}(%
\cdot|s)}[\nabla\log(\pi^{\gt}(A_{h}|S_{h}))Q_{h}^{\tilde{\pi}}(S_{h},A_{h})].
\displaystyle=\sum_{s\in\cS}\mu_{h}(s)\mathbb{E}_{S_{h}=s,A_{h}\sim\pi^{\gt}(%
\cdot|s)}[\nabla\log(\pi^{\gt}(A_{h}|S_{h}))Q_{h}^{\tilde{\pi}}(S_{h},A_{h})].
\displaystyle\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle=\sum_{s\in\cS}\mu_{h}(s)\mathbb{E}_{S_{h}=s,A_{h}\sim\pi^{\gt}(%
\cdot|s)}\Big{[}\Big{(}\mathbf{1}_{\{S_{h}=s^{\prime}\}}(\mathbf{1}_{\{A_{h}=a%
^{\prime}\}}-\pi^{\theta}(a^{\prime}|s^{\prime}))\Big{)}_{s^{\prime}\in\cS_{h}%
,a^{\prime}\in\cA_{s^{\prime}}}Q_{h}^{\tilde{\pi}}(S_{h},A_{h})\Big{]}
\displaystyle=\sum_{s\in\cS}\mu_{h}(s)\mathbb{E}_{S_{h}=s,A_{h}\sim\pi^{\gt}(%
\cdot|s)}\Big{[}\Big{(}\mathbf{1}_{\{S_{h}=s^{\prime}\}}(\mathbf{1}_{\{A_{h}=a%
^{\prime}\}}-\pi^{\theta}(a^{\prime}|s^{\prime}))\Big{)}_{s^{\prime}\in\cS_{h}%
,a^{\prime}\in\cA_{s^{\prime}}}Q_{h}^{\tilde{\pi}}(S_{h},A_{h})\Big{]}
\displaystyle=\Big{(}\sum_{s\in\cS}\mu_{h}(s)\sum_{a\in\cA_{s}}\pi^{\gt}(a|s)%
\mathbf{1}_{\{s=s^{\prime}\}}(\mathbf{1}_{\{a=a^{\prime}\}}-\pi^{\theta}(a^{%
\prime}|s^{\prime}))Q_{h}^{\tilde{\pi}}(s,a)\Big{)}_{s^{\prime}\in\cS_{h},a^{%
\prime}\in\cA_{s^{\prime}}}
\displaystyle=\Big{(}\sum_{s\in\cS}\mu_{h}(s)\sum_{a\in\cA_{s}}\pi^{\gt}(a|s)%
\mathbf{1}_{\{s=s^{\prime}\}}(\mathbf{1}_{\{a=a^{\prime}\}}-\pi^{\theta}(a^{%
\prime}|s^{\prime}))Q_{h}^{\tilde{\pi}}(s,a)\Big{)}_{s^{\prime}\in\cS_{h},a^{%
\prime}\in\cA_{s^{\prime}}}
\displaystyle=\Big{(}\mu_{h}(s^{\prime})\pi^{\gt}(a^{\prime}|s^{\prime})Q_{h}^%
{\tilde{\pi}}(s^{\prime},a^{\prime})-\mu_{h}(s^{\prime})\pi^{\theta}(a^{\prime%
}|s^{\prime})\sum_{a\in\cA_{s}}\pi^{\gt}(a|s^{\prime})Q_{h}^{\tilde{\pi}}(s^{%
\prime},a)\Big{)}_{s^{\prime}\in\cS_{h},a^{\prime}\in\cA_{s^{\prime}}}
\displaystyle=\Big{(}\mu_{h}(s^{\prime})\pi^{\gt}(a^{\prime}|s^{\prime})Q_{h}^%
{\tilde{\pi}}(s^{\prime},a^{\prime})-\mu_{h}(s^{\prime})\pi^{\theta}(a^{\prime%
}|s^{\prime})\sum_{a\in\cA_{s}}\pi^{\gt}(a|s^{\prime})Q_{h}^{\tilde{\pi}}(s^{%
\prime},a)\Big{)}_{s^{\prime}\in\cS_{h},a^{\prime}\in\cA_{s^{\prime}}}
\displaystyle=\Big{(}\mu_{h}(s^{\prime})\pi^{\gt}(a^{\prime}|s^{\prime})(Q_{h}%
^{\tilde{\pi}}(s^{\prime},a^{\prime})-V_{h}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(%
s^{\prime}))\Big{)}_{s^{\prime}\in\cS_{h},a^{\prime}\in\cA_{s^{\prime}}}
\displaystyle=\Big{(}\mu_{h}(s^{\prime})\pi^{\gt}(a^{\prime}|s^{\prime})(Q_{h}%
^{\tilde{\pi}}(s^{\prime},a^{\prime})-V_{h}^{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(%
s^{\prime}))\Big{)}_{s^{\prime}\in\cS_{h},a^{\prime}\in\cA_{s^{\prime}}}
\displaystyle=\Big{(}\mu_{h}(s^{\prime})\pi^{\gt}(a^{\prime}|s^{\prime})A_{h}^%
{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(s^{\prime},a^{\prime})\Big{)}_{s^{\prime}\in%
\cS_{h},a^{\prime}\in\cA_{s^{\prime}}},
\displaystyle=\Big{(}\mu_{h}(s^{\prime})\pi^{\gt}(a^{\prime}|s^{\prime})A_{h}^%
{(\pi^{\gt},\tilde{\pi}_{(h+1)})}(s^{\prime},a^{\prime})\Big{)}_{s^{\prime}\in%
\cS_{h},a^{\prime}\in\cA_{s^{\prime}}},
\sum_{a\in\cA_{s}}\pi^{\gt}(a|s^{\prime})Q_{h}^{\tilde{\pi}}(s^{\prime},a)=J_{%
h}(\gt,\tilde{\pi}_{(h+1)},\delta_{s^{\prime}})=V_{h}^{(\pi^{\gt},\tilde{\pi}_%
{(h+1)})}(s^{\prime})
J(\gt,\mu)
\gt
\beta=H^{2}R^{\ast}(2-\frac{1}{|\cA|})
\frac{R^{\ast}}{(1-\gamma)^{2}}\big{(}2-\frac{1}{|\cA|}\big{)}
\frac{1}{1-\gamma}
H
J
\tau=(s_{0},a_{0},s_{1},\dots,s_{H-1},a_{H-1})
\pi^{\theta}
p_{\mu}^{\theta}
\displaystyle\nabla J(\theta,\mu)=\nabla\Big{(}\sum_{\tau}p_{\mu}^{\theta}(%
\tau)\sum_{h=0}^{H-1}r(s_{h},a_{h})\Big{)}
\displaystyle\nabla J(\theta,\mu)
\displaystyle=\nabla\Big{(}\sum_{\tau}p_{\mu}^{\theta}(\tau)\sum_{h=0}^{H-1}r(%
s_{h},a_{h})\Big{)}
\displaystyle=\sum_{\tau}p_{\mu}^{\theta}(\tau)\Big{(}\sum_{h=0}^{H-1}\nabla%
\log(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})\Big{)}
\displaystyle=\sum_{\tau}p_{\mu}^{\theta}(\tau)\Big{(}\sum_{h=0}^{H-1}\nabla%
\log(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})\Big{)}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\nabla\log%
(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})\Big{]}.
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\nabla\log%
(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})\Big{]}.
\displaystyle\nabla^{2}J(\theta,\mu)=\nabla\Big{(}\sum_{\tau}p_{\mu}^{\theta}(%
\tau)\big{(}\sum_{h=0}^{H-1}\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H%
-1}r(s_{h},a_{h})\big{)}\Big{)}
\displaystyle\nabla^{2}J(\theta,\mu)
\displaystyle=\nabla\Big{(}\sum_{\tau}p_{\mu}^{\theta}(\tau)\big{(}\sum_{h=0}^%
{H-1}\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})\big{)%
}\Big{)}
\displaystyle=\underbrace{\sum_{\tau}p_{\mu}^{\theta}(\tau)\Big{(}\big{(}\sum_%
{h=0}^{H-1}\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\big{)}\big{(}\sum_{h=0}^{H-1}%
\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\big{)}^{T}\sum_{h=0}^{H-1}r(s_{h},a_{h})%
\Big{)}}_{(1)}
\displaystyle=\underbrace{\sum_{\tau}p_{\mu}^{\theta}(\tau)\Big{(}\big{(}\sum_%
{h=0}^{H-1}\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\big{)}\big{(}\sum_{h=0}^{H-1}%
\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\big{)}^{T}\sum_{h=0}^{H-1}r(s_{h},a_{h})%
\Big{)}}_{(1)}
\displaystyle+\underbrace{\sum_{\tau}p_{\mu}^{\theta}(\tau)\Big{(}\sum_{h=0}^{%
H-1}\nabla^{2}\log(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})%
\Big{)}}_{(2)}.
\displaystyle+\underbrace{\sum_{\tau}p_{\mu}^{\theta}(\tau)\Big{(}\sum_{h=0}^{%
H-1}\nabla^{2}\log(\pi^{\theta}(a_{h}|s_{h}))\sum_{h=0}^{H-1}r(s_{h},a_{h})%
\Big{)}}_{(2)}.
\displaystyle||(2)||\leq\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}%
\lVert\nabla^{2}\log(\pi^{\theta}(a_{h}|s_{h}))\rVert\Big{]}HR^{\ast}
\displaystyle||(2)||
\displaystyle\leq\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\sum_{h=0}^{H-1}\lVert%
\nabla^{2}\log(\pi^{\theta}(a_{h}|s_{h}))\rVert\Big{]}HR^{\ast}
\displaystyle=HR^{\ast}\sum_{h=0}^{H-1}\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}%
\lVert\nabla^{2}\log(\pi^{\theta}(a_{h}|s_{h}))\rVert\Big{]}.
\displaystyle=HR^{\ast}\sum_{h=0}^{H-1}\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}%
\lVert\nabla^{2}\log(\pi^{\theta}(a_{h}|s_{h}))\rVert\Big{]}.
\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\lVert\nabla^{2}\log(\pi^{\theta}(a_{h}|%
s_{h}))\rVert\Big{]}\leq 1
\displaystyle||(2)||\leq H^{2}R^{\ast}.
\displaystyle||(2)||
\displaystyle\leq H^{2}R^{\ast}.
\displaystyle||(1)||\leq\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\lVert\sum_{h=0}%
^{H-1}\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\rVert^{2}\Big{]}HR^{\ast}
\displaystyle||(1)||
\displaystyle\leq\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}\lVert\sum_{h=0}^{H-1}%
\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\rVert^{2}\Big{]}HR^{\ast}
\displaystyle=HR^{\ast}\sum_{h=0}^{H-1}\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}%
\lVert\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\rVert^{2}\Big{]}
\displaystyle=HR^{\ast}\sum_{h=0}^{H-1}\mathbb{E}_{\mu}^{\pi^{\theta}}\Big{[}%
\lVert\nabla\log(\pi^{\theta}(a_{h}|s_{h}))\rVert^{2}\Big{]}
\displaystyle\leq H^{2}R^{\ast}\big{(}1-\frac{1}{|\cA|}\big{)},
\displaystyle\leq H^{2}R^{\ast}\big{(}1-\frac{1}{|\cA|}\big{)},
\displaystyle\lVert\nabla^{2}J(\theta,\mu)\rVert\leq H^{2}R^{\ast}\big{(}2-%
\frac{1}{|\cA|}\big{)}.
\displaystyle\lVert\nabla^{2}J(\theta,\mu)\rVert\leq H^{2}R^{\ast}\big{(}2-%
\frac{1}{|\cA|}\big{)}.
\displaystyle\lVert\nabla J(\theta,\mu)\rVert_{2}\geq\frac{\min_{s_{h}\in\cS^{%
[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{h})}{\sqrt{|\cS^{[\cH]}|}}\Big{\lVert}%
\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}\Big{\rVert}_{\infty}^{-1}(%
J^{\ast}(\mu)-J(\theta,\mu)).
\displaystyle\lVert\nabla J(\theta,\mu)\rVert_{2}\geq\frac{\min_{s_{h}\in\cS^{%
[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{h})}{\sqrt{|\cS^{[\cH]}|}}\Big{\lVert}%
\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}\Big{\rVert}_{\infty}^{-1}(%
J^{\ast}(\mu)-J(\theta,\mu)).
\displaystyle\lVert\nabla J(\theta,\mu)\rVert_{2}=\Big{[}\sum_{s_{h}\in\cS^{[%
\cH]}}\sum_{a}\Bigl{(}\frac{\partial V_{0}^{\pi^{\theta}}(\mu)}{\partial\theta%
(s_{h},a)}\Bigr{)}^{2}\Big{]}^{1/2}
\displaystyle\lVert\nabla J(\theta,\mu)\rVert_{2}
\displaystyle=\Big{[}\sum_{s_{h}\in\cS^{[\cH]}}\sum_{a}\Bigl{(}\frac{\partial V%
_{0}^{\pi^{\theta}}(\mu)}{\partial\theta(s_{h},a)}\Bigr{)}^{2}\Big{]}^{1/2}
\displaystyle\geq\Big{[}\sum_{s_{h}\in\cS^{[\cH]}}\Bigl{(}\frac{\partial V_{0}%
^{\pi^{\theta}}(\mu)}{\partial\theta(s_{h},a^{\ast}(s_{h}))}\Bigr{)}^{2}\Big{]%
}^{1/2}
\displaystyle\geq\Big{[}\sum_{s_{h}\in\cS^{[\cH]}}\Bigl{(}\frac{\partial V_{0}%
^{\pi^{\theta}}(\mu)}{\partial\theta(s_{h},a^{\ast}(s_{h}))}\Bigr{)}^{2}\Big{]%
}^{1/2}
\displaystyle\geq\frac{1}{\sqrt{|\cS^{[\cH]}|}}\sum_{s_{h}\in\cS^{[\cH]}}\Big{%
|}\frac{\partial V_{0}^{\pi^{\theta}}(\mu)}{\partial\theta(s_{h},a^{\ast}(s_{h%
}))}\Big{|}
\displaystyle\geq\frac{1}{\sqrt{|\cS^{[\cH]}|}}\sum_{s_{h}\in\cS^{[\cH]}}\Big{%
|}\frac{\partial V_{0}^{\pi^{\theta}}(\mu)}{\partial\theta(s_{h},a^{\ast}(s_{h%
}))}\Big{|}
\displaystyle=\frac{1}{\sqrt{|\cS^{[\cH]}|}}\sum_{s_{h}\in\cS^{[\cH]}}\tilde{%
\rho}_{\mu}^{\pi^{\theta}}(s_{h})\pi^{\theta}(a^{\ast}(s_{h})|s_{h})|A^{\pi^{%
\theta}}(s_{h},a^{\ast}(s_{h}))|
\displaystyle=\frac{1}{\sqrt{|\cS^{[\cH]}|}}\sum_{s_{h}\in\cS^{[\cH]}}\tilde{%
\rho}_{\mu}^{\pi^{\theta}}(s_{h})\pi^{\theta}(a^{\ast}(s_{h})|s_{h})|A^{\pi^{%
\theta}}(s_{h},a^{\ast}(s_{h}))|
\displaystyle\geq\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|%
s_{h})}{\sqrt{|\cS^{[\cH]}|}}\sum_{s_{h}\in\cS^{[\cH]}}\tilde{\rho}_{\mu}^{\pi%
^{\ast}}(s_{h})\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}%
\Big{\rVert}_{\infty}^{-1}A^{\pi^{\theta}}(s_{h},a^{\ast}(s_{h}))
\displaystyle\geq\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|%
s_{h})}{\sqrt{|\cS^{[\cH]}|}}\sum_{s_{h}\in\cS^{[\cH]}}\tilde{\rho}_{\mu}^{\pi%
^{\ast}}(s_{h})\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}%
\Big{\rVert}_{\infty}^{-1}A^{\pi^{\theta}}(s_{h},a^{\ast}(s_{h}))
\displaystyle=\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{%
h})}{\sqrt{|\cS^{[\cH]}|}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi%
^{\theta}}}\Big{\rVert}_{\infty}^{-1}\underbrace{\sum_{s_{h}\in\cS^{[\cH]}}%
\rho_{\mu}^{\pi^{\ast}}(s_{h})A^{\pi^{\theta}}(s_{h},a^{\ast}(s_{h}))}_{=%
\mathbb{E}_{\mu}^{\pi^{\ast}}[\sum_{h=0}^{H-1}A_{h}^{\pi^{\theta}}(S_{h},A_{h}%
)]}
\displaystyle=\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{%
h})}{\sqrt{|\cS^{[\cH]}|}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi%
^{\theta}}}\Big{\rVert}_{\infty}^{-1}\underbrace{\sum_{s_{h}\in\cS^{[\cH]}}%
\rho_{\mu}^{\pi^{\ast}}(s_{h})A^{\pi^{\theta}}(s_{h},a^{\ast}(s_{h}))}_{=%
\mathbb{E}_{\mu}^{\pi^{\ast}}[\sum_{h=0}^{H-1}A_{h}^{\pi^{\theta}}(S_{h},A_{h}%
)]}
\displaystyle=\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{%
h})}{\sqrt{||\cS^{[\cH]}|}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{%
\pi^{\theta}}}\Big{\rVert}_{\infty}^{-1}(J^{\ast}(\mu)-J(\theta,\mu)).
\displaystyle=\frac{\min_{s_{h}\in\cS^{[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{%
h})}{\sqrt{||\cS^{[\cH]}|}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{%
\pi^{\theta}}}\Big{\rVert}_{\infty}^{-1}(J^{\ast}(\mu)-J(\theta,\mu)).
\Big{\lVert}\frac{\tilde{\rho}_{\mu}^{\pi^{\ast}}}{\tilde{\rho}_{\mu}^{\pi^{%
\theta}}}\Big{\rVert}_{\infty}=\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}%
^{\pi^{\theta}}}\Big{\rVert}_{\infty}
\gt
d_{\mu}^{\pi^{\theta}}(s)\geq\frac{1}{H}\mu(s)
\gt
d_{\mu}^{\pi^{\theta}}(s)=\frac{1}{H}\sum_{h=0}^{H-1}\bbP_{\mu}^{\pi^{\gt}}(S_%
{h}=s)\geq\frac{1}{H}\mu(s).
\displaystyle\lVert\nabla J(\theta,\mu)\rVert_{2}\geq\frac{\min_{s_{h}\in\cS^{%
[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{h})}{H\sqrt{|\cS|H}}\Big{\lVert}\frac{d%
_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-1}(J^{\ast}(\mu)-J(\theta,\mu%
)).
\displaystyle\lVert\nabla J(\theta,\mu)\rVert_{2}\geq\frac{\min_{s_{h}\in\cS^{%
[\cH]}}\pi^{\theta}(a^{\ast}(s_{h})|s_{h})}{H\sqrt{|\cS|H}}\Big{\lVert}\frac{d%
_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-1}(J^{\ast}(\mu)-J(\theta,\mu%
)).
\sum_{s\in\cS}\sum_{h=0}^{H-1}\bbP_{\mu}^{\pi^{\gt}}(S_{h}=s)=\sum_{s_{h}\in%
\cS_{h}}\bbP(S_{h}=s_{h})
\mu
\gt
\mu
s_{h}
\cS_{0}
\mu
\mu(s)>0
s\in\cS
0<\eta\leq\frac{1}{5H^{2}R^{\ast}}
(\theta^{(n)})
\theta^{(0)}\in\cR^{\sum_{h}d_{h}}
c=c(\gt^{(0)})=\inf_{n}\min_{s_{h}\in\cS^{[\cH]}}\pi^{\gt^{(n)}}(a^{\ast}(s_{h%
})|s_{h})>0.
\mu
J(\gt,\mu)
s_{h}\in\cS^{[\cH]}
\displaystyle\Delta^{*}(s_{h})=Q^{\infty}(s_{h},a_{h}^{*}(s))-\max\limits_{a%
\neq a^{*}(s_{h})}Q^{\infty}(s_{h},a)>0,\quad\textrm{and}\quad\Delta^{*}=\min%
\limits_{s_{h}\in\cS^{[\cH]}}\Delta^{*}(s_{h})>0,
\displaystyle\Delta^{*}(s_{h})=Q^{\infty}(s_{h},a_{h}^{*}(s))-\max\limits_{a%
\neq a^{*}(s_{h})}Q^{\infty}(s_{h},a)>0,\quad\textrm{and}\quad\Delta^{*}=\min%
\limits_{s_{h}\in\cS^{[\cH]}}\Delta^{*}(s_{h})>0,
Q^{\infty}
Q
s_{h}\in\cS^{[\cH]}
\displaystyle\cR_{1}(s_{h})=\Big{\{}\gt:\frac{\partial J(\gt)}{\partial\gt(s_{%
h},a^{*}(s_{h}))}\geq\frac{\partial J(\gt)}{\partial\gt(s_{h},a)},\,\textrm{%
for all }a\neq a^{*}(s_{h})\Big{\}},
\displaystyle\cR_{1}(s_{h})=\Big{\{}\gt:\frac{\partial J(\gt)}{\partial\gt(s_{%
h},a^{*}(s_{h}))}\geq\frac{\partial J(\gt)}{\partial\gt(s_{h},a)},\,\textrm{%
for all }a\neq a^{*}(s_{h})\Big{\}},
\displaystyle\cR_{2}(s_{h})=\Big{\{}\gt:Q^{\pi^{\gt}}(s_{h},a^{*}(s_{h}))\geq Q%
^{\infty}(s_{h},a^{*}(s_{h}))-\frac{\Delta^{*}(s_{h})}{2}\Big{\}},
\displaystyle\cR_{2}(s_{h})=\Big{\{}\gt:Q^{\pi^{\gt}}(s_{h},a^{*}(s_{h}))\geq Q%
^{\infty}(s_{h},a^{*}(s_{h}))-\frac{\Delta^{*}(s_{h})}{2}\Big{\}},
\displaystyle\cR_{3}(s_{h})=\Big{\{}\gt^{(n)}:V^{\pi^{\gt^{(n)}}}(s_{h})\geq Q%
^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-\frac{\Delta^{*}(s_{h})}{2},\textrm{ %
for all }n\geq 1\textrm{ large enough}\Big{\}}.
\displaystyle\cR_{3}(s_{h})=\Big{\{}\gt^{(n)}:V^{\pi^{\gt^{(n)}}}(s_{h})\geq Q%
^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-\frac{\Delta^{*}(s_{h})}{2},\textrm{ %
for all }n\geq 1\textrm{ large enough}\Big{\}}.
c(s_{h})=\frac{|\cA|HR^{*}}{\Delta^{*}(s_{h})}-1
\displaystyle N_{c}(s_{h})=\Big{\{}\gt:\pi^{\gt}(a_{h}^{*}(s_{h})|s_{h})\geq%
\frac{c(s_{h})}{c(s_{h})+1}\Big{\}}.
\displaystyle N_{c}(s_{h})=\Big{\{}\gt:\pi^{\gt}(a_{h}^{*}(s_{h})|s_{h})\geq%
\frac{c(s_{h})}{c(s_{h})+1}\Big{\}}.
\cR(s_{h})=\cR_{1}(s_{h})\cap\cR_{2}(s_{h})\cap\cR_{3}(s_{h})
\gt^{(n)}\in\cR(s_{h})\Rightarrow\gt^{(n+1)}\in\cR(s_{h})
\pi^{\gt^{(n+1)}}(a^{*}(s_{h})|s_{h})\geq\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})
\cN_{c}(s_{h})\cap\cR_{2}(s_{h})\cap\cR_{3}(s_{h})\subseteq\cR_{1}(s_{h})\cap%
\cR_{2}(s_{h})\cap\cR_{3}(s_{h})
s_{h}\in\cS^{[\cH]}
n_{0}(s_{h})\geq 1
\theta^{(n_{0}(s_{h}))}\in\cN_{c}(s_{h})\cap\cR_{2}(s_{h})\cap\cR_{3}(s_{h})%
\subseteq\cR_{1}(s_{h})\cap\cR_{2}(s_{h})\cap\cR_{3}(s_{h})
\inf_{n\geq 1}\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})=\min_{1\leq n\leq n_{0}(s_{h%
})}\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})
n_{0}=\max_{s_{h}\in\cS^{[\cH]}}n_{0}(s_{h})
\displaystyle\inf_{n\geq 1}\min_{s\in\cS^{[\cH]}}\pi^{\gt^{(n)}}(a^{*}(s_{h})|%
s_{h})=\min_{1\leq n\leq n_{0}}\min_{s_{h}\in\cS^{[\cH]}}\pi^{\gt^{(n)}}(a^{*}%
(s_{h})|s_{h})>0.
\displaystyle\inf_{n\geq 1}\min_{s\in\cS^{[\cH]}}\pi^{\gt^{(n)}}(a^{*}(s_{h})|%
s_{h})=\min_{1\leq n\leq n_{0}}\min_{s_{h}\in\cS^{[\cH]}}\pi^{\gt^{(n)}}(a^{*}%
(s_{h})|s_{h})>0.
\gt^{(n)}\in\cR(s_{h})
a\neq a^{*}(s_{h})
\gt^{(n+1)}\in\cR_{3}(s_{h})
\cR_{3}(s_{h})
\gt^{(n+1)}\in\cR_{2}(s_{h})
\displaystyle Q^{\pi^{\gt^{(n+1)}}}(s_{h},a^{\ast}(s_{h}))=Q_{h}^{\pi^{\gt^{(n%
+1)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle Q^{\pi^{\gt^{(n+1)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle=Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle=Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))+Q_{h}^{\pi^{\gt^{%
(n+1)}}}(s_{h},a^{\ast}(s_{h}))-Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle=Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))+Q_{h}^{\pi^{\gt^{%
(n+1)}}}(s_{h},a^{\ast}(s_{h}))-Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle=Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))+r(s_{h},a^{\ast}(%
s_{h}))+\sum_{s^{\prime}\cS^{[\cH]}}p(s^{\prime}|s_{h},a^{\ast}(s_{h}))V_{h+1}%
^{\pi^{\gt^{(n+1)}}}(s^{\prime})
\displaystyle=Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))+r(s_{h},a^{\ast}(%
s_{h}))+\sum_{s^{\prime}\cS^{[\cH]}}p(s^{\prime}|s_{h},a^{\ast}(s_{h}))V_{h+1}%
^{\pi^{\gt^{(n+1)}}}(s^{\prime})
\displaystyle-r(s_{h},a^{\ast}(s_{h}))-\sum_{s^{\prime}\cS^{[\cH]}}p(s^{\prime%
}|s_{h},a^{\ast}(s_{h}))V_{h+1}^{\pi^{\gt^{(n)}}}(s^{\prime})
\displaystyle-r(s_{h},a^{\ast}(s_{h}))-\sum_{s^{\prime}\cS^{[\cH]}}p(s^{\prime%
}|s_{h},a^{\ast}(s_{h}))V_{h+1}^{\pi^{\gt^{(n)}}}(s^{\prime})
\displaystyle=Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))+\sum_{s^{\prime}%
\cS^{[\cH]}}p(s^{\prime}|s_{h},a^{\ast}(s_{h}))\Big{(}V_{h+1}^{\pi^{\gt^{(n+1)%
}}}(s^{\prime})-V_{h+1}^{\pi^{\gt^{(n)}}}(s^{\prime})\Big{)}
\displaystyle=Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))+\sum_{s^{\prime}%
\cS^{[\cH]}}p(s^{\prime}|s_{h},a^{\ast}(s_{h}))\Big{(}V_{h+1}^{\pi^{\gt^{(n+1)%
}}}(s^{\prime})-V_{h+1}^{\pi^{\gt^{(n)}}}(s^{\prime})\Big{)}
\displaystyle\geq Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))=Q^{\pi^{\gt^{%
(n)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle\geq Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))=Q^{\pi^{\gt^{%
(n)}}}(s_{h},a^{\ast}(s_{h}))
\displaystyle\geq Q^{\infty}(s_{h},a^{*}(s_{h}))-\frac{\Delta^{*}(s_{h})}{2},
\displaystyle\geq Q^{\infty}(s_{h},a^{*}(s_{h}))-\frac{\Delta^{*}(s_{h})}{2},
V^{\pi^{\gt^{(n+1)}}}(s^{\prime})
n
s^{\prime}\in\cS^{[\cH]}
\gt^{(n)}\in\cR_{2}(s_{h})
\gt^{(n+1)}\in\cR_{1}(s_{h})
\displaystyle Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))-Q^{\pi^{\gt^{(n)}}}(s%
_{h},a)\geq\frac{\Delta^{\ast}(s_{h})}{2},
\displaystyle Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))-Q^{\pi^{\gt^{(n)}}}(s%
_{h},a)\geq\frac{\Delta^{\ast}(s_{h})}{2},
a\neq a^{\ast}(s_{h})
\displaystyle Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))-Q^{\pi^{\gt^{(n)}}}(s%
_{h},a)
\displaystyle Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))-Q^{\pi^{\gt^{(n)}}}(s%
_{h},a)
\displaystyle=Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))-Q^{\infty}(s_{h},a^{%
\ast}(s_{h}))+Q^{\infty}(s_{h},a^{\ast}(s_{h}))-Q^{\pi^{\gt^{(n)}}}(s_{h},a)
\displaystyle=Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))-Q^{\infty}(s_{h},a^{%
\ast}(s_{h}))+Q^{\infty}(s_{h},a^{\ast}(s_{h}))-Q^{\pi^{\gt^{(n)}}}(s_{h},a)
\displaystyle\geq-\frac{\Delta^{\ast}(s_{h})}{2}+Q^{\infty}(s_{h},a^{\ast}(s_{%
h}))-Q^{\infty}(s_{h},a)+Q^{\infty}(s_{h},a)-Q^{\pi^{\gt^{(n)}}}(s_{h},a)
\displaystyle\geq-\frac{\Delta^{\ast}(s_{h})}{2}+Q^{\infty}(s_{h},a^{\ast}(s_{%
h}))-Q^{\infty}(s_{h},a)+Q^{\infty}(s_{h},a)-Q^{\pi^{\gt^{(n)}}}(s_{h},a)
\displaystyle\geq-\frac{\Delta^{\ast}(s_{h})}{2}+\Delta^{\ast}(s_{h})+\sum_{s^%
{\prime}\in\cS^{[\cH]}}p(s^{\prime}|s_{h},a)(V^{\infty}(s^{\prime})-V^{\pi^{%
\gt^{(n)}}}(s^{\prime}))
\displaystyle\geq-\frac{\Delta^{\ast}(s_{h})}{2}+\Delta^{\ast}(s_{h})+\sum_{s^%
{\prime}\in\cS^{[\cH]}}p(s^{\prime}|s_{h},a)(V^{\infty}(s^{\prime})-V^{\pi^{%
\gt^{(n)}}}(s^{\prime}))
\displaystyle\geq\frac{\Delta^{\ast}(s_{h})}{2}.
\displaystyle\geq\frac{\Delta^{\ast}(s_{h})}{2}.
\gt^{(n)}\in\cR_{2}(s)
\Delta^{\ast}(s_{h})
V^{\pi^{\gt^{(n)}}}(s^{\prime})
s^{\prime}
V^{\infty}
a\neq a^{\ast}(s_{h})
\displaystyle\begin{split}&\quad\,\,\frac{\partial J(\gt^{(n)})}{\partial\gt(s%
_{h},a^{*}(s_{h}))}\geq\frac{\partial J(\gt^{(n)})}{\partial\gt(s_{h},a)}\\
&\Leftrightarrow\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})\big{(}Q_{h}^{\pi^{\gt^{(n)%
}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(n)}}}(s_{h})\big{)}\geq\pi^{\gt^{(n)%
}}(a|s)\big{(}Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a)-V_{h}^{\pi^{\gt^{(n)}}}(s_{h})%
\big{)}.\end{split}
\displaystyle\begin{split}&\quad\,\,\frac{\partial J(\gt^{(n)})}{\partial\gt(s%
_{h},a^{*}(s_{h}))}\geq\frac{\partial J(\gt^{(n)})}{\partial\gt(s_{h},a)}\\
&\Leftrightarrow\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})\big{(}Q_{h}^{\pi^{\gt^{(n)%
}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(n)}}}(s_{h})\big{)}\geq\pi^{\gt^{(n)%
}}(a|s)\big{(}Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a)-V_{h}^{\pi^{\gt^{(n)}}}(s_{h})%
\big{)}.\end{split}
\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})\geq\pi^{\gt^{(n)}}(a|s_{h})
\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})<\pi^{\gt^{(n)}}(a|s_{h})
a)
\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})\geq\pi^{\gt^{(n)}}(a|s_{h})
\gt^{(n)}(s_{h},a^{*}(s_{h}))\geq\gt^{(n)}(s_{h},a)
\displaystyle\gt^{(n+1)}(s,a^{*}(s_{h}))=\gt^{(n)}(s,a^{*}(s_{h}))+\eta\frac{%
\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))}
\displaystyle\gt^{(n+1)}(s,a^{*}(s_{h}))
\displaystyle=\gt^{(n)}(s,a^{*}(s_{h}))+\eta\frac{\partial J(\gt^{(n)})}{%
\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))}
\displaystyle\geq\gt^{(n)}(s,a)+\eta\frac{\partial J(\gt^{(n)})}{\partial\gt^{%
(n)}(s_{h},a)}
\displaystyle\geq\gt^{(n)}(s,a)+\eta\frac{\partial J(\gt^{(n)})}{\partial\gt^{%
(n)}(s_{h},a)}
\displaystyle=\gt^{(n+1)}(s,a),
\displaystyle=\gt^{(n+1)}(s,a),
\pi^{\gt^{(n+1)}}(a^{*}(s_{h})|s_{h})\geq\pi^{\gt^{(n+1)}}(a|s_{h})
\displaystyle Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{(%
n+1)}}}(s_{h},a)\geq\frac{\Delta^{\ast}(s_{h})}{2}\geq 0,
\displaystyle Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{(%
n+1)}}}(s_{h},a)\geq\frac{\Delta^{\ast}(s_{h})}{2}\geq 0,
\displaystyle Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(%
n+1)}}}(s_{h})\geq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a)-V_{h}^{\pi^{\gt^{(n+1)}}%
}(s_{h}).
\displaystyle Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(%
n+1)}}}(s_{h})\geq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a)-V_{h}^{\pi^{\gt^{(n+1)}}%
}(s_{h}).
\displaystyle\pi^{\gt^{(n+1)}}(a^{*}(s_{h})|s_{h})\big{(}Q_{h}^{\pi^{\gt^{(n+1%
)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(n+1)}}}(s_{h})\big{)}\geq\pi_{t}^{%
\gt^{(n+1)}}(a|s_{h})\big{(}Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a)-V_{h}^{\pi^{\gt%
^{(n+1)}}}(s_{h})\big{)},
\displaystyle\pi^{\gt^{(n+1)}}(a^{*}(s_{h})|s_{h})\big{(}Q_{h}^{\pi^{\gt^{(n+1%
)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(n+1)}}}(s_{h})\big{)}\geq\pi_{t}^{%
\gt^{(n+1)}}(a|s_{h})\big{(}Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a)-V_{h}^{\pi^{\gt%
^{(n+1)}}}(s_{h})\big{)},
\displaystyle\frac{\partial J(\gt^{(n+1)})}{\partial\gt^{(n+1)}(s,a^{*}(s_{h})%
)}\geq\frac{\partial J(\gt^{(n+1)})}{\partial\gt^{(n+1)}(s_{h},a)}.
\displaystyle\frac{\partial J(\gt^{(n+1)})}{\partial\gt^{(n+1)}(s,a^{*}(s_{h})%
)}\geq\frac{\partial J(\gt^{(n+1)})}{\partial\gt^{(n+1)}(s_{h},a)}.
\gt^{(n+1)}\in\cR_{1}(s_{h})
b)
\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})<\pi^{\gt^{(n)}}(a|s_{h})
\gt^{(n)}\in\cR_{1}(s_{h})
\displaystyle\begin{split}&\quad\,\,\frac{\partial J(\gt^{(n)})}{\partial\gt^{%
(n)}(s_{h},a^{*}(s_{h}))}\geq\frac{\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_%
{h},a)}\\
&\Leftrightarrow Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{%
(n)}}}(s_{h},a)\geq\Big{(}1-\frac{\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})}{\pi^{%
\gt^{(n)}}(a|s_{h})}\Big{)}\big{(}Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-%
V_{h}^{\pi^{\gt^{(n)}}}(s_{h})\big{)}\\
&\Leftrightarrow Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{%
(n)}}}(s_{h},a)\geq\big{(}1-\exp(\gt^{(n)}(s_{h},a^{*}(s_{h}))-\gt^{(n)}(s_{h}%
,a)\big{)}\big{(}Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{%
(n)}}}(s_{h})\big{)}.\end{split}
\displaystyle\begin{split}&\quad\,\,\frac{\partial J(\gt^{(n)})}{\partial\gt^{%
(n)}(s_{h},a^{*}(s_{h}))}\geq\frac{\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_%
{h},a)}\\
&\Leftrightarrow Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{%
(n)}}}(s_{h},a)\geq\Big{(}1-\frac{\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h})}{\pi^{%
\gt^{(n)}}(a|s_{h})}\Big{)}\big{(}Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-%
V_{h}^{\pi^{\gt^{(n)}}}(s_{h})\big{)}\\
&\Leftrightarrow Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{%
(n)}}}(s_{h},a)\geq\big{(}1-\exp(\gt^{(n)}(s_{h},a^{*}(s_{h}))-\gt^{(n)}(s_{h}%
,a)\big{)}\big{(}Q_{h}^{\pi^{\gt^{(n)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{%
(n)}}}(s_{h})\big{)}.\end{split}
\theta^{(n)}\in\cR_{1}(s_{h})
\cR_{1}(s_{h})
\displaystyle\gt^{(n+1)}(s_{h},a^{*}(s_{h}))-\gt^{(n+1)}(s_{h},a)
\displaystyle\gt^{(n+1)}(s_{h},a^{*}(s_{h}))-\gt^{(n+1)}(s_{h},a)
\displaystyle=\gt^{(n)}(s_{h},a^{*}(s_{h}))+\eta\frac{\partial J(\gt^{(n)})}{%
\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))}-\gt^{(n)}(s_{h},a)-\eta\frac{\partial J%
(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a)}
\displaystyle=\gt^{(n)}(s_{h},a^{*}(s_{h}))+\eta\frac{\partial J(\gt^{(n)})}{%
\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))}-\gt^{(n)}(s_{h},a)-\eta\frac{\partial J%
(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a)}
\displaystyle\geq\gt^{(n)}(s_{h},a^{*}(s_{h}))-\gt^{(n)}(s_{h},a)
\displaystyle\geq\gt^{(n)}(s_{h},a^{*}(s_{h}))-\gt^{(n)}(s_{h},a)
\big{(}1-\exp(\gt^{(n+1)}(s_{h},a^{*}(s_{h}))-\gt^{(n+1)}(s_{h},a))\big{)}\leq%
\big{(}1-\exp(\gt^{(n)}(s_{h},a^{*}(s_{h}))-\gt^{(n)}(s_{h},a))\big{)}<1
b)
\gt^{(n+1)}\in\cR_{3}(s_{h})
V_{h}^{\pi^{\gt^{(n+1)}}}(s_{h})\geq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{%
h}))-\frac{\Delta^{*}(s)}{2}
\displaystyle Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(%
n+1)}}}(s_{h})\leq\frac{\Delta^{*}(s)}{2}\leq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},%
a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a),
\displaystyle Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(%
n+1)}}}(s_{h})\leq\frac{\Delta^{*}(s)}{2}\leq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},%
a^{*}(s_{h}))-Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a),
\displaystyle\big{(}1-\exp(\gt^{(n+1)}(s,a_{h}^{*}(s))-\gt^{(n+1)}(s,a))\big{)%
}\Big{[}Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(n+1)}}%
}(s_{h})\Big{]}
\displaystyle\big{(}1-\exp(\gt^{(n+1)}(s,a_{h}^{*}(s))-\gt^{(n+1)}(s,a))\big{)%
}\Big{[}Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-V_{h}^{\pi^{\gt^{(n+1)}}%
}(s_{h})\Big{]}
\displaystyle\leq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{%
\gt^{(n+1)}}}(s_{h},a),
\displaystyle\leq Q_{h}^{\pi^{\gt^{(n+1)}}}(s_{h},a^{*}(s_{h}))-Q_{h}^{\pi^{%
\gt^{(n+1)}}}(s_{h},a),
\gt^{(n+1)}\in\cR_{1}(s_{h})
\displaystyle\pi^{\gt^{(n+1)}}(a^{*}(s_{h})|s_{h})
\displaystyle\pi^{\gt^{(n+1)}}(a^{*}(s_{h})|s_{h})
\displaystyle=\frac{\exp(\gt^{(n+1)}(s_{h},a^{*}(s_{h})))}{\sum\limits_{a\in%
\cA}\exp(\gt^{(n+1)}(s_{h},a))}
\displaystyle=\frac{\exp(\gt^{(n+1)}(s_{h},a^{*}(s_{h})))}{\sum\limits_{a\in%
\cA}\exp(\gt^{(n+1)}(s_{h},a))}
\displaystyle=\frac{\exp(\gt^{(n)}(s_{h},a^{*}(s_{h}))+\eta\frac{\partial J(%
\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))})}{\sum\limits_{a\in\cA}\exp%
(\gt^{(n)}(s_{h},a)+\eta\frac{\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a%
)})}
\displaystyle=\frac{\exp(\gt^{(n)}(s_{h},a^{*}(s_{h}))+\eta\frac{\partial J(%
\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))})}{\sum\limits_{a\in\cA}\exp%
(\gt^{(n)}(s_{h},a)+\eta\frac{\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a%
)})}
\displaystyle\geq\frac{\exp(\gt^{(n)}(s_{h},a^{*}(s_{h})))\exp(\eta\frac{%
\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))})}{\sum\limits_{a%
\in\cA}\exp(\gt^{(n)}(s_{h},a))\exp(\eta\frac{\partial J(\gt^{(n)})}{\partial%
\gt^{(n)}(s_{h},a^{*}(s_{h}))})}
\displaystyle\geq\frac{\exp(\gt^{(n)}(s_{h},a^{*}(s_{h})))\exp(\eta\frac{%
\partial J(\gt^{(n)})}{\partial\gt^{(n)}(s_{h},a^{*}(s_{h}))})}{\sum\limits_{a%
\in\cA}\exp(\gt^{(n)}(s_{h},a))\exp(\eta\frac{\partial J(\gt^{(n)})}{\partial%
\gt^{(n)}(s_{h},a^{*}(s_{h}))})}
\displaystyle=\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h}),
\displaystyle=\pi^{\gt^{(n)}}(a^{*}(s_{h})|s_{h}),
\gt^{(n)}\in\cR_{1}(s_{h})
\gt\in\cN_{c}(s_{h})\cap\cR_{2}(s_{h})\cap\cR_{3}(s_{h})
a)
\pi^{\gt}(a^{*}(s_{h})|s_{h})\geq\max\limits_{a\in\cA}\pi^{\gt}(a|s_{h})
a\neq a^{*}(s_{h})
\displaystyle\frac{\partial J(\gt)}{\partial\gt(s_{h},a^{*}(s_{h}))}
\displaystyle\frac{\partial J(\gt)}{\partial\gt(s_{h},a^{*}(s_{h}))}
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})\pi^{\gt}(a^{*}(s_{h})|s_{h%
})A^{\pi^{\gt}}(s_{h},a^{*}(s_{h}))
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})\pi^{\gt}(a^{*}(s_{h})|s_{h%
})A^{\pi^{\gt}}(s_{h},a^{*}(s_{h}))
\displaystyle\geq\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})\pi^{\gt}(a|s_{h})A^{\pi%
^{\gt}}(s_{h},a)
\displaystyle\geq\tilde{\rho}_{\mu}^{\pi^{\gt}}(s_{h})\pi^{\gt}(a|s_{h})A^{\pi%
^{\gt}}(s_{h},a)
\displaystyle=\frac{\partial J(\gt)}{\partial\gt(s_{h},a)}.
\displaystyle=\frac{\partial J(\gt)}{\partial\gt(s_{h},a)}.
A^{\pi^{\gt}}(s_{h},a^{*}(s_{h}))-A^{\pi^{\gt}}(s_{h},a)=Q^{\pi^{\gt}}(s_{h},a%
^{*}(s_{h}))-Q^{\pi^{\gt}}(s_{h},a)\geq\frac{\Delta^{\ast}(s_{h})}{2}>0
\gt\in\cR_{1}(s_{h})
b)
\pi^{\gt}(a^{*}(s_{h})|s_{h})<\max\limits_{a\in\cA}\pi^{\gt}(a|s_{h})
\gt\in\cN_{c}(s_{h})
a\neq a^{*}(s_{h})
\pi^{\gt}(a^{*}(s_{h})|s_{h})<\pi^{\gt}(a|s_{h})
\displaystyle\pi^{\gt}(a^{*}(s_{h})|s_{h})+\pi^{\gt}(a|s_{h})>\frac{2c(s_{h})}%
{c(s_{h})+1}=\frac{\frac{2|\cA|HR^{*}}{\Delta^{*}(s)}-2}{\frac{|\cA|HR^{*}}{%
\Delta^{*}(s)}}=2-\frac{2\Delta^{*}(s)}{|\cA|HR^{*}}\geq 2-\frac{2}{|\cA|}\geq
1,
\displaystyle\pi^{\gt}(a^{*}(s_{h})|s_{h})+\pi^{\gt}(a|s_{h})>\frac{2c(s_{h})}%
{c(s_{h})+1}=\frac{\frac{2|\cA|HR^{*}}{\Delta^{*}(s)}-2}{\frac{|\cA|HR^{*}}{%
\Delta^{*}(s)}}=2-\frac{2\Delta^{*}(s)}{|\cA|HR^{*}}\geq 2-\frac{2}{|\cA|}\geq
1,
\Delta^{*}(s)\leq HR^{*}
|\cA|\geq 2
\pi^{\theta}
\pi^{\gt^{(n)}}(a^{\ast}(s_{h})|s_{h})\to 1
n\to\infty
N_{0}(s_{h})>0
\pi^{\gt^{(n)}}(a^{\ast}(s_{h})|s_{h})\geq\frac{c(s_{h})}{c(s_{h})+1}
n\geq N_{0}(s_{h})
\gt^{(n)}\in N_{c}(s_{h})
n\geq N_{0}(s_{h})
Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))\to Q^{\infty}(s_{h},a^{\ast}(s_{h}))
n\to\infty
N_{1}(s_{h})
\gt^{(n)}\in\cR_{2}(s_{h})
n\geq N_{1}(s_{h})
Q^{\pi^{\gt^{(n)}}}(s_{h},a^{\ast}(s_{h}))\to Q^{\infty}(s_{h},a^{\ast}(s_{h})%
)=V^{\infty}(s_{h})
V^{\pi^{\gt^{(n)}}}(s_{h})\to V^{\infty}(s_{h})
n\to\infty
N_{2}(s_{h})
\gt^{(n)}\in\cR_{3}(s_{h})
n\geq N_{2}(s_{h})
n_{0}(s_{h})=\max\{N_{0}(s_{h}),N_{1}(s_{h}),N_{2}(s_{h})\}
\displaystyle J^{\ast}(\mu)-J(\theta^{(n)},\mu)=V_{0}^{\ast}(\mu)-V_{0}^{\pi^{%
\theta^{(n)}}}(\mu)\leq\frac{10H^{5}R^{\ast}|\cS|}{c^{2}n}\Big{\lVert}\frac{d_%
{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2},
\displaystyle J^{\ast}(\mu)-J(\theta^{(n)},\mu)=V_{0}^{\ast}(\mu)-V_{0}^{\pi^{%
\theta^{(n)}}}(\mu)\leq\frac{10H^{5}R^{\ast}|\cS|}{c^{2}n}\Big{\lVert}\frac{d_%
{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2},
\beta
f:\mathbb{R}^{d}\to\mathbb{R}
\displaystyle f(y)\leq f(x)+\nabla f(x)^{T}(y-x)+\frac{\beta}{2}\lVert y-x%
\rVert^{2}.
\displaystyle f(y)\leq f(x)+\nabla f(x)^{T}(y-x)+\frac{\beta}{2}\lVert y-x%
\rVert^{2}.
-f
\beta
\displaystyle-f(y)\leq-f(x)-\nabla f(x)^{T}(y-x)+\frac{\beta}{2}\lVert y-x%
\rVert^{2},
\displaystyle-f(y)\leq-f(x)-\nabla f(x)^{T}(y-x)+\frac{\beta}{2}\lVert y-x%
\rVert^{2},
\displaystyle f(y)\geq f(x)+\nabla f(x)^{T}(y-x)-\frac{\beta}{2}\lVert y-x%
\rVert^{2}.
\displaystyle f(y)\geq f(x)+\nabla f(x)^{T}(y-x)-\frac{\beta}{2}\lVert y-x%
\rVert^{2}.
\displaystyle x_{k+1}=x_{k}+\alpha\nabla f(x_{k})
\displaystyle x_{k+1}=x_{k}+\alpha\nabla f(x_{k})
\displaystyle f(x_{k+1})\geq f(x_{k})+\nabla f(x_{k})^{T}(x_{k+1}-x_{k})-\frac%
{\beta}{2}\lVert x_{k+1}-x_{k}\rVert^{2}
\displaystyle f(x_{k+1})
\displaystyle\geq f(x_{k})+\nabla f(x_{k})^{T}(x_{k+1}-x_{k})-\frac{\beta}{2}%
\lVert x_{k+1}-x_{k}\rVert^{2}
\displaystyle=f(x_{k})+\alpha\lVert\nabla f(x_{k})\rVert^{2}-\frac{\beta\alpha%
^{2}}{2}\lVert\nabla f(x_{k})\rVert^{2}
\displaystyle=f(x_{k})+\alpha\lVert\nabla f(x_{k})\rVert^{2}-\frac{\beta\alpha%
^{2}}{2}\lVert\nabla f(x_{k})\rVert^{2}
\displaystyle=f(x_{k})+\Big{(}\alpha-\frac{\beta\alpha^{2}}{2}\Big{)}\lVert%
\nabla f(x_{k})\rVert^{2}.
\displaystyle=f(x_{k})+\Big{(}\alpha-\frac{\beta\alpha^{2}}{2}\Big{)}\lVert%
\nabla f(x_{k})\rVert^{2}.
f^{\ast}
f
\displaystyle f^{\ast}-f(x_{k+1})\leq f^{\ast}-f(x_{k})-\Big{(}\alpha-\frac{%
\beta\alpha^{2}}{2}\Big{)}\lVert\nabla f(x_{k})\rVert^{2}.
\displaystyle f^{\ast}-f(x_{k+1})
\displaystyle\leq f^{\ast}-f(x_{k})-\Big{(}\alpha-\frac{\beta\alpha^{2}}{2}%
\Big{)}\lVert\nabla f(x_{k})\rVert^{2}.
b>0
\lVert\nabla f(x_{k})\rVert>b(f^{\ast}-f(x_{k}))
k\geq 0
\displaystyle f^{\ast}-f(x_{k+1})\leq f^{\ast}-f(x_{k})-\Big{(}\alpha-\frac{%
\beta\alpha^{2}}{2}\Big{)}b^{2}(f^{\ast}-f(x_{k}))^{2}.
\displaystyle f^{\ast}-f(x_{k+1})
\displaystyle\leq f^{\ast}-f(x_{k})-\Big{(}\alpha-\frac{\beta\alpha^{2}}{2}%
\Big{)}b^{2}(f^{\ast}-f(x_{k}))^{2}.
\alpha\leq\frac{1}{\beta}
\displaystyle f^{\ast}-f(x_{k+1})\leq f^{\ast}-f(x_{k})-\frac{\alpha c^{2}}{2}%
(f^{\ast}-f(x_{k}))^{2}.
\displaystyle f^{\ast}-f(x_{k+1})
\displaystyle\leq f^{\ast}-f(x_{k})-\frac{\alpha c^{2}}{2}(f^{\ast}-f(x_{k}))^%
{2}.
f^{\ast}-f(x_{1})\leq\frac{2}{\alpha b^{2}}
f^{\ast}-f(x_{n})\leq\frac{2}{\alpha b^{2}n}
J(\gt,\mu)
\alpha=\eta=5H^{2}R^{\ast}
b=\frac{c}{\sqrt{|\cS|H}H}\lVert\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\rVert^{-1}
b
d_{\mu}^{\pi^{\theta}}(s)\geq\frac{1}{H}\mu(s)
\gt
J^{\ast}(\mu)-J(\gt^{(0)},\mu)\leq\frac{2H^{2}R^{\ast}5H^{2}H|\cS|}{c^{2}}\Big%
{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}.
c<1
\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}>1
\displaystyle J^{\ast}(\mu)-J(\gt^{(n)},\mu)\leq\frac{10H^{5}R^{\ast}|\cS|}{c^%
{2}n}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}.
\displaystyle J^{\ast}(\mu)-J(\gt^{(n)},\mu)\leq\frac{10H^{5}R^{\ast}|\cS|}{c^%
{2}n}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}.
(1-\gamma)^{-6}
3
\frac{8}{(1-\gamma)^{3}}
(1-\gamma)^{3}/8
(1-\gamma)^{-3}
(1-\gamma)^{3}/8
2
\rho
\mu
\mu
(1-\gamma)^{-5}
H^{2}R^{\ast}
H^{2}
H^{2}
H
|\cS^{[\cH]}|=|\cS|H
c
H
\gamma
(d_{n})_{n\in\N_{0}}
d_{n+1}\leq d_{n}-qd_{n}^{2}
q>0
d_{0}<\frac{1}{q}
d_{n}\leq\frac{1}{qn}
\displaystyle\frac{1}{d_{n+1}}\geq\frac{1}{d_{n}}+\frac{qd_{n}}{d_{n+1}}\geq%
\frac{1}{d_{n}}+q,
\displaystyle\frac{1}{d_{n+1}}\geq\frac{1}{d_{n}}+\frac{qd_{n}}{d_{n+1}}\geq%
\frac{1}{d_{n}}+q,
d_{n}d_{n+1}
\displaystyle\frac{1}{d_{n}}=\frac{1}{d_{0}}+\sum_{k=0}^{n-1}\frac{1}{d_{k+1}}%
-\frac{1}{d_{k}}\geq\frac{1}{d_{0}}+nq.
\displaystyle\frac{1}{d_{n}}=\frac{1}{d_{0}}+\sum_{k=0}^{n-1}\frac{1}{d_{k+1}}%
-\frac{1}{d_{k}}\geq\frac{1}{d_{0}}+nq.
\displaystyle d_{n}\leq\frac{1}{nq+\frac{1}{d_{0}}}\leq\frac{1}{q(n+1)}\leq%
\frac{1}{qn}.
\displaystyle d_{n}\leq\frac{1}{nq+\frac{1}{d_{0}}}\leq\frac{1}{q(n+1)}\leq%
\frac{1}{qn}.
h\in\cH
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})
\gt_{h}
\beta_{h}=2(H-h)R^{\ast}
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})
\gamma=0
[0,R^{\ast}(H-h)]
\pi^{\gt_{h}}
\displaystyle\mathbb{E}_{A\sim\pi^{\gt_{h}}}\Big{[}||\nabla\log\pi^{\gt_{h}}(A%
|s)||_{2}^{2}\Big{]}\leq 1-\frac{1}{|\cA_{s}|}\leq 1\quad\forall s\in\cS
\displaystyle\mathbb{E}_{A\sim\pi^{\gt_{h}}}\Big{[}||\nabla\log\pi^{\gt_{h}}(A%
|s)||_{2}^{2}\Big{]}\leq 1-\frac{1}{|\cA_{s}|}\leq 1\quad\forall s\in\cS
\displaystyle\mathbb{E}_{A\sim\pi^{\gt_{h}}}\Big{[}||\nabla^{2}\log\pi^{\gt_{h%
}}(A|s)||_{2}\Big{]}\leq 1,
\displaystyle\mathbb{E}_{A\sim\pi^{\gt_{h}}}\Big{[}||\nabla^{2}\log\pi^{\gt_{h%
}}(A|s)||_{2}\Big{]}\leq 1,
\beta_{h}=2(H-h)R^{\ast}
J_{h}
\displaystyle\lVert\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})\rVert_{2}%
\geq\min_{s\in\cS_{h}}\pi^{\gt_{h}}(a_{h}^{*}(s)|s)(J_{h}^{\ast}(\tilde{\pi}_{%
(h+1)},\mu_{h})-J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})).
\displaystyle\lVert\nabla J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})\rVert_{2}%
\geq\min_{s\in\cS_{h}}\pi^{\gt_{h}}(a_{h}^{*}(s)|s)(J_{h}^{\ast}(\tilde{\pi}_{%
(h+1)},\mu_{h})-J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})).
\pi_{h}^{\ast}
J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})=V_{h}^{(\pi_{h}^{\ast},\tilde{\pi}_{%
(h+1)})}(\mu_{h})
\displaystyle\Big{\lVert}\frac{\partial J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_%
{h})}{\partial\gt_{h}}\Big{\rVert}_{2}
\displaystyle\Big{\lVert}\frac{\partial J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_%
{h})}{\partial\gt_{h}}\Big{\rVert}_{2}
\displaystyle=\Big{\lVert}\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\frac{\partial J_%
{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})}{\partial\gt_{h}}\Big{\rVert}_{2}
\displaystyle=\Big{\lVert}\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\frac{\partial J_%
{h}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})}{\partial\gt_{h}}\Big{\rVert}_{2}
\displaystyle=\Big{[}\sum_{s^{\prime}\in\cS_{h}}\sum\limits_{a^{\prime}\in\cA_%
{s^{\prime}}}\Big{(}\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\frac{\partial J_{h}(%
\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})}{\partial\gt_{h}(s^{\prime},a^{\prime}%
)}\Big{)}^{2}\Big{]}^{\frac{1}{2}}
\displaystyle=\Big{[}\sum_{s^{\prime}\in\cS_{h}}\sum\limits_{a^{\prime}\in\cA_%
{s^{\prime}}}\Big{(}\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\frac{\partial J_{h}(%
\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})}{\partial\gt_{h}(s^{\prime},a^{\prime}%
)}\Big{)}^{2}\Big{]}^{\frac{1}{2}}
\displaystyle\geq\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\Big{|}\frac{\partial J_{h%
}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})}{\partial\gt_{h}(s,a_{h}^{*}(s))}%
\Big{|}
\displaystyle\geq\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\Big{|}\frac{\partial J_{h%
}(\gt_{h},\tilde{\pi}_{(h+1)},\delta_{s})}{\partial\gt_{h}(s,a_{h}^{*}(s))}%
\Big{|}
\displaystyle=\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\pi^{\gt_{h}}(a_{h}^{*}(s)|s)%
A_{h}^{(\pi^{\gt_{h}},\tilde{\pi}_{(h+1)})}(s,a_{h}^{*}(s))
\displaystyle=\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\pi^{\gt_{h}}(a_{h}^{*}(s)|s)%
A_{h}^{(\pi^{\gt_{h}},\tilde{\pi}_{(h+1)})}(s,a_{h}^{*}(s))
\displaystyle=\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\pi^{\gt_{h}}(a_{h}^{*}(s)|s)%
\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\gt_{h},\tilde{\pi}_%
{(h+1)},\delta_{s})\Big{)}
\displaystyle=\sum\limits_{s\in\cS_{h}}\mu_{h}(s)\pi^{\gt_{h}}(a_{h}^{*}(s)|s)%
\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\gt_{h},\tilde{\pi}_%
{(h+1)},\delta_{s})\Big{)}
\displaystyle\geq\min_{s\in\cS_{h}}\pi^{\gt_{h}}(a_{h}^{*}(s)|s)\Big{(}J_{h}^{%
\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})%
\Big{)}.
\displaystyle\geq\min_{s\in\cS_{h}}\pi^{\gt_{h}}(a_{h}^{*}(s)|s)\Big{(}J_{h}^{%
\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})%
\Big{)}.
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
0<\eta_{h}\leq\frac{1}{2(H-h)R^{*}}
(\gt_{h}^{(n)})
\gt_{h}^{(0)}\in\cR^{d_{h}}
\tilde{\pi}
c_{h}=c_{h}(\gt_{h}^{(n)})=\inf_{n\geq 0}\min_{s\in\cS_{h}}\pi^{\gt_{h}^{(n)}}%
(a_{h}^{*}(s)|s)>0.
h
\gt_{n}
\gt_{h}^{(n)}
J_{h}(\gt)
J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})
\tilde{\pi}
\mu_{h}
J_{h}^{\ast}
J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})
J_{h,s}(\gt)
s\in\cS_{h}
J_{h,s}(\gt)=J_{h}(\gt,\tilde{\pi}_{(h+1)},\delta_{s})
\displaystyle J_{h,s}(\gt_{h})=\sum_{a\in\cA_{s}}\pi^{\theta_{h}}(a|s)Q_{h}^{%
\tilde{\pi}}(s,a),
\displaystyle J_{h,s}(\gt_{h})=\sum_{a\in\cA_{s}}\pi^{\theta_{h}}(a|s)Q_{h}^{%
\tilde{\pi}}(s,a),
Q_{h}^{\tilde{\pi}}(s,a)
\gt
\tilde{\pi}
Q_{h}
s\in\cS_{h}
\displaystyle\Delta^{*}(s)=Q_{h}(s,a_{h}^{*}(s))-\max\limits_{a\neq a_{h}^{*}(%
s)}Q_{h}(s,a)>0,\quad\textrm{and}\quad\Delta^{*}=\min\limits_{s\in\cS_{h}}%
\Delta^{*}(s)>0.
\displaystyle\Delta^{*}(s)=Q_{h}(s,a_{h}^{*}(s))-\max\limits_{a\neq a_{h}^{*}(%
s)}Q_{h}(s,a)>0,\quad\textrm{and}\quad\Delta^{*}=\min\limits_{s\in\cS_{h}}%
\Delta^{*}(s)>0.
\displaystyle\cR_{h}^{1}(s)=\{\theta:\frac{\partial J_{h,s}(\gt)}{\partial\gt(%
s,a_{h}^{\ast}(s))}\geq\frac{\partial J_{h,s}(\gt)}{\partial\gt(s,a)}\forall a%
\neq a_{h}^{\ast}(s)\}
\displaystyle\cR_{h}^{1}(s)=\{\theta:\frac{\partial J_{h,s}(\gt)}{\partial\gt(%
s,a_{h}^{\ast}(s))}\geq\frac{\partial J_{h,s}(\gt)}{\partial\gt(s,a)}\forall a%
\neq a_{h}^{\ast}(s)\}
\displaystyle\cR_{h}^{2}(s)=\{\theta:\pi^{\theta}(a_{h}^{\ast}(s)|s)\geq\pi^{%
\theta}(a|s)\forall a\neq a_{h}^{\ast}(s)\}
\displaystyle\cR_{h}^{2}(s)=\{\theta:\pi^{\theta}(a_{h}^{\ast}(s)|s)\geq\pi^{%
\theta}(a|s)\forall a\neq a_{h}^{\ast}(s)\}
\displaystyle\cN_{h}(s)=\{\theta:\pi^{\theta}(a_{h}^{\ast}(s)|s)\geq\frac{c_{h%
}(s)}{c_{h}(s)+1}\},
\displaystyle\cN_{h}(s)=\{\theta:\pi^{\theta}(a_{h}^{\ast}(s)|s)\geq\frac{c_{h%
}(s)}{c_{h}(s)+1}\},
c_{h}(s)=\frac{|\cA|(H-h)R^{\ast}}{\Delta_{h}^{\ast}(s)}-1
\Delta_{h}^{\ast}(s)=Q_{h}(s,a^{\ast}(s))-\max_{a\neq a^{\ast}}Q_{h}(s,a)
\gt_{n}\in\cR_{h}^{1}(s)\Rightarrow\gt_{n+1}\in\cR_{h}^{1}(s)
\gt_{n}\in\cR_{h}^{1}(s)
\pi^{\gt_{n+1}}(a_{h}^{\ast}(s)|s)\geq\pi^{\gt_{n}}(a_{h}^{\ast}(s)|s)
\cN_{h}(s)\subseteq\cR_{h}^{2}(s)\subseteq\cR_{h}^{1}(s)
\gt_{n}\in\cR_{h}^{1}(s)
a\neq a_{h}^{*}(s)
\displaystyle\begin{split}&\quad\,\,\frac{\partial J_{h,s}(\gt_{n})}{\partial%
\gt(s,a_{h}^{*}(s))}\geq\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt(s,a)}\\
&\Leftrightarrow\pi^{\gt_{n}}(a_{h}^{*}(s)|s)\big{(}Q_{h}(s,a_{h}^{*}(s))-J_{h%
,s}(\gt_{n})\big{)}\geq\pi^{\gt_{n}}(a|s)\big{(}Q_{h}(s,a)-J_{h,s}(\gt_{n})%
\big{)}.\end{split}
\displaystyle\begin{split}&\quad\,\,\frac{\partial J_{h,s}(\gt_{n})}{\partial%
\gt(s,a_{h}^{*}(s))}\geq\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt(s,a)}\\
&\Leftrightarrow\pi^{\gt_{n}}(a_{h}^{*}(s)|s)\big{(}Q_{h}(s,a_{h}^{*}(s))-J_{h%
,s}(\gt_{n})\big{)}\geq\pi^{\gt_{n}}(a|s)\big{(}Q_{h}(s,a)-J_{h,s}(\gt_{n})%
\big{)}.\end{split}
\pi^{\gt_{n}}(a_{h}^{*}(s)|s)\geq\pi^{\gt_{n}}(a|s)
\pi^{\gt_{n}}(a_{h}^{*}(s)|s)<\pi^{\gt_{n}}(a|s)
a)
\pi^{\gt_{n}}(a_{h}^{*}(s)|s)\geq\pi^{\gt_{n}}(a|s)
\gt_{n}(s,a_{h}^{*}(s))\geq\gt_{n}(s,a)
\displaystyle\gt_{n+1}(s,a_{h}^{*}(s))=\gt_{n}(s,a_{h}^{*}(s))+\eta_{h}\mu_{h}%
(s)\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))}
\displaystyle\gt_{n+1}(s,a_{h}^{*}(s))
\displaystyle=\gt_{n}(s,a_{h}^{*}(s))+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}%
(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))}
\displaystyle\geq\gt_{n}(s,a)+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}(\gt_{n}%
)}{\partial\gt_{n}(s,a)}
\displaystyle\geq\gt_{n}(s,a)+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}(\gt_{n}%
)}{\partial\gt_{n}(s,a)}
\displaystyle=\gt_{n+1}(s,a),
\displaystyle=\gt_{n+1}(s,a),
\pi^{\gt_{n+1}}(a_{h}^{*}(s)|s)\geq\pi^{\gt_{n+1}}(a|s)
a_{h}^{*}(s)
\displaystyle\pi_{t}^{\gt_{n+1}}(a_{h}^{*}(s)|s)\big{(}Q_{h}(s,a_{h}^{*}(s))-J%
_{h,s}(\gt_{n+1})\big{)}\geq\pi_{t}^{\gt_{n+1}}(a|s)\big{(}Q_{h}(s,a)-J_{h,s}(%
\gt_{n+1})\big{)},
\displaystyle\pi_{t}^{\gt_{n+1}}(a_{h}^{*}(s)|s)\big{(}Q_{h}(s,a_{h}^{*}(s))-J%
_{h,s}(\gt_{n+1})\big{)}\geq\pi_{t}^{\gt_{n+1}}(a|s)\big{(}Q_{h}(s,a)-J_{h,s}(%
\gt_{n+1})\big{)},
\displaystyle\frac{\partial J_{h,s}(\gt_{n+1})}{\partial\gt_{n+1}(s,a_{h}^{*}(%
s))}\geq\frac{\partial J_{h,s}(\gt_{n+1})}{\partial\gt_{n+1}(s,a)}.
\displaystyle\frac{\partial J_{h,s}(\gt_{n+1})}{\partial\gt_{n+1}(s,a_{h}^{*}(%
s))}\geq\frac{\partial J_{h,s}(\gt_{n+1})}{\partial\gt_{n+1}(s,a)}.
\gt_{n+1}\in\cR_{h}^{1}(s)
b)
\pi^{\gt_{n}}(a_{h}^{*}(s)|s)<\pi^{\gt_{n}}(a|s)
\gt_{n}\in\cR_{h}^{1}(s)
\displaystyle\begin{split}&\quad\,\,\frac{\partial J_{h,s}(\gt_{n})}{\partial%
\gt_{n}(s,a_{h}^{*}(s))}\geq\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s%
,a)}\\
&\Leftrightarrow Q_{h}(s,a_{h}^{*}(s))-Q_{h}(s,a)\geq\Big{(}1-\frac{\pi^{\gt_{%
n}}(a_{h}^{*}(s)|s)}{\pi^{\gt_{n}}(a|s)}\Big{)}\big{(}Q_{h}(s,a_{h}^{*}(s))-J_%
{h,s}(\gt_{n})\big{)}\\
&\Leftrightarrow Q_{h}(s,a_{h}^{*}(s))-Q_{h}(s,a)\geq\big{(}1-\exp(\gt_{n}(s,a%
_{h}^{*}(s))-\gt_{n}(s,a)\big{)}\big{(}Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n})%
\big{)}.\end{split}
\displaystyle\begin{split}&\quad\,\,\frac{\partial J_{h,s}(\gt_{n})}{\partial%
\gt_{n}(s,a_{h}^{*}(s))}\geq\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s%
,a)}\\
&\Leftrightarrow Q_{h}(s,a_{h}^{*}(s))-Q_{h}(s,a)\geq\Big{(}1-\frac{\pi^{\gt_{%
n}}(a_{h}^{*}(s)|s)}{\pi^{\gt_{n}}(a|s)}\Big{)}\big{(}Q_{h}(s,a_{h}^{*}(s))-J_%
{h,s}(\gt_{n})\big{)}\\
&\Leftrightarrow Q_{h}(s,a_{h}^{*}(s))-Q_{h}(s,a)\geq\big{(}1-\exp(\gt_{n}(s,a%
_{h}^{*}(s))-\gt_{n}(s,a)\big{)}\big{(}Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n})%
\big{)}.\end{split}
\theta^{(n)}\in\cR_{h}^{1}(s)
\cR_{h}^{1}(s)
\displaystyle\gt_{n+1}(s,a_{h}^{*}(s))-\gt_{n+1}(s,a)
\displaystyle\gt_{n+1}(s,a_{h}^{*}(s))-\gt_{n+1}(s,a)
\displaystyle=\gt_{n}(s,a_{h}^{*}(s))+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}%
(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))}-\gt_{n}(s,a)-\eta_{h}\mu_{h}(s)%
\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a)}
\displaystyle=\gt_{n}(s,a_{h}^{*}(s))+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}%
(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))}-\gt_{n}(s,a)-\eta_{h}\mu_{h}(s)%
\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a)}
\displaystyle\geq\gt_{n}(s,a_{h}^{*}(s))-\gt_{n}(s,a)
\displaystyle\geq\gt_{n}(s,a_{h}^{*}(s))-\gt_{n}(s,a)
\big{(}1-\exp(\gt_{n+1}(s,a_{h}^{*}(s))-\gt_{n+1}(s,a))\big{)}\leq\big{(}1-%
\exp(\gt_{n}(s,a_{h}^{*}(s))-\gt_{n}(s,a))\big{)}<1
b)
\displaystyle Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n+1})\leq Q_{h}(s,a_{h}^{*}(s%
))-J_{h,s}(\gt_{n}),
\displaystyle Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n+1})\leq Q_{h}(s,a_{h}^{*}(s%
))-J_{h,s}(\gt_{n}),
\Delta^{*}(s)
\displaystyle\big{(}1-\exp(\gt_{n+1}(s,a_{h}^{*}(s))-\gt_{n+1}(s,a))\big{)}%
\Big{[}Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n+1})\Big{]}
\displaystyle\big{(}1-\exp(\gt_{n+1}(s,a_{h}^{*}(s))-\gt_{n+1}(s,a))\big{)}%
\Big{[}Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n+1})\Big{]}
\displaystyle\leq\big{(}1-\exp(\gt_{n}(s,a_{h}^{*}(s))-\gt_{n}(s,a))\big{)}%
\Big{[}Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n})\Big{]}
\displaystyle\leq\big{(}1-\exp(\gt_{n}(s,a_{h}^{*}(s))-\gt_{n}(s,a))\big{)}%
\Big{[}Q_{h}(s,a_{h}^{*}(s))-J_{h,s}(\gt_{n})\Big{]}
\displaystyle\leq Q_{h}(s,a_{h}^{*}(s))-Q_{h}(s,a),
\displaystyle\leq Q_{h}(s,a_{h}^{*}(s))-Q_{h}(s,a),
\gt_{n+1}\in\cR_{1}(s)
\gt_{n}\in\cR_{h}^{1}(s)
\displaystyle\pi^{\gt_{n+1}}(a_{h}^{*}(s)|s)
\displaystyle\pi^{\gt_{n+1}}(a_{h}^{*}(s)|s)
\displaystyle=\frac{\exp(\gt_{n+1}(s,a_{h}^{*}(s)))}{\sum\limits_{a\in\cA}\exp%
(\gt_{n+1}(s,a))}
\displaystyle=\frac{\exp(\gt_{n+1}(s,a_{h}^{*}(s)))}{\sum\limits_{a\in\cA}\exp%
(\gt_{n+1}(s,a))}
\displaystyle=\frac{\exp(\gt_{n}(s,a_{h}^{*}(s))+\eta_{h}\mu_{h}(s)\frac{%
\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))})}{\sum\limits_{a%
\in\cA_{s}}\exp(\gt_{n}(s,a)+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}(\gt_{n})%
}{\partial\gt_{n}(s,a)})}
\displaystyle=\frac{\exp(\gt_{n}(s,a_{h}^{*}(s))+\eta_{h}\mu_{h}(s)\frac{%
\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))})}{\sum\limits_{a%
\in\cA_{s}}\exp(\gt_{n}(s,a)+\eta_{h}\mu_{h}(s)\frac{\partial J_{h,s}(\gt_{n})%
}{\partial\gt_{n}(s,a)})}
\displaystyle\geq\frac{\exp(\gt_{n}(s,a_{h}^{*}(s)))\exp(\eta_{h}\mu_{h}(s)%
\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))})}{\sum%
\limits_{a\in\cA_{s}}\exp(\gt_{n}(s,a))\exp(\eta_{h}\mu_{h}(s)\frac{\partial J%
_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))})}
\displaystyle\geq\frac{\exp(\gt_{n}(s,a_{h}^{*}(s)))\exp(\eta_{h}\mu_{h}(s)%
\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))})}{\sum%
\limits_{a\in\cA_{s}}\exp(\gt_{n}(s,a))\exp(\eta_{h}\mu_{h}(s)\frac{\partial J%
_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a_{h}^{*}(s))})}
\displaystyle=\pi^{\gt_{n}}(a_{h}^{*}(s)|s),
\displaystyle=\pi^{\gt_{n}}(a_{h}^{*}(s)|s),
\gt_{n}\in\cR_{h}^{1}(s)
\theta_{n}\in\cR_{h}^{2}(s)
a^{\ast}(s)
\displaystyle\quad\pi^{\gt_{n}}(a^{\ast}(s)|s)(Q_{h}(s,a_{h}^{\ast}(s))-J_{h,s%
}(\gt_{n}))\geq\pi^{\gt_{n}}(a|s)(Q_{h}(s,a)-J_{h,s}(\gt_{n}))
\displaystyle\quad\pi^{\gt_{n}}(a^{\ast}(s)|s)(Q_{h}(s,a_{h}^{\ast}(s))-J_{h,s%
}(\gt_{n}))\geq\pi^{\gt_{n}}(a|s)(Q_{h}(s,a)-J_{h,s}(\gt_{n}))
\displaystyle\Leftrightarrow\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s%
,a^{\ast}(s))}\geq\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a)}.
\displaystyle\Leftrightarrow\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s%
,a^{\ast}(s))}\geq\frac{\partial J_{h,s}(\gt_{n})}{\partial\gt_{n}(s,a)}.
\gt_{n}\in\cR_{h}^{1}(s)
\gt_{n}\in\cN_{h}(s)
a\neq a_{h}^{*}(s)
\pi^{\gt}(a_{h}^{*}(s)|s)<\pi^{\gt}(a|s)
\displaystyle\pi^{\gt}(a_{h}^{*}(s)|s)+\pi^{\gt}(a|s)>\frac{2c(s)}{c(s)+1}=%
\frac{\frac{2|\cA|(H-h)R^{*}}{\Delta_{h}^{*}(s)}-2}{\frac{|\cA|(H-h)R^{*}}{%
\Delta_{h}^{*}(s)}}=2-\frac{2\Delta_{h}^{*}(s)}{|\cA|(H-h)R^{*}}\geq 2-\frac{2%
}{|\cA|}\geq 1,
\displaystyle\pi^{\gt}(a_{h}^{*}(s)|s)+\pi^{\gt}(a|s)>\frac{2c(s)}{c(s)+1}=%
\frac{\frac{2|\cA|(H-h)R^{*}}{\Delta_{h}^{*}(s)}-2}{\frac{|\cA|(H-h)R^{*}}{%
\Delta_{h}^{*}(s)}}=2-\frac{2\Delta_{h}^{*}(s)}{|\cA|(H-h)R^{*}}\geq 2-\frac{2%
}{|\cA|}\geq 1,
\Delta^{*}(s)\leq(H-h)R^{*}
|\cA|\geq 2
\pi^{\theta}
J_{h}
\gamma=0
t_{0}
\gt\in\cN_{h}(s)
s\in\cS
\displaystyle\inf_{n}\min_{s}\pi^{\gt_{n}}(a^{\ast}(s)|s)=\min_{0\leq n\leq t_%
{0}}\min_{s}\pi^{\gt_{n}}(a^{\ast}(s)|s)>0.
\displaystyle\inf_{n}\min_{s}\pi^{\gt_{n}}(a^{\ast}(s)|s)=\min_{0\leq n\leq t_%
{0}}\min_{s}\pi^{\gt_{n}}(a^{\ast}(s)|s)>0.
\gt_{0}\in\cR_{h}^{2}(s)
s\in\cS_{h}
\gt_{n}\in\cR_{h}^{1}(s)
n\geq 0
\displaystyle c_{h}=\inf_{n}\min_{s}\pi^{\gt_{h}^{(n)}}(a^{\ast}(s)|s)=\min_{s%
}\pi^{\gt_{h}^{(0)}}(a^{\ast}(s)|s)=\frac{1}{|\cA|}.
\displaystyle c_{h}=\inf_{n}\min_{s}\pi^{\gt_{h}^{(n)}}(a^{\ast}(s)|s)=\min_{s%
}\pi^{\gt_{h}^{(0)}}(a^{\ast}(s)|s)=\frac{1}{|\cA|}.
c_{h}
c
a^{\ast}(s)
\pi^{\ast}_{h}
\tilde{\pi}_{(h+1)}
h
\gt
\pi^{\ast}
\min_{s_{h}\in\cS^{[\cH]}}\pi^{\gt}(a^{\ast}(s_{h})|s_{h})
s_{h}
V_{h}^{(\pi_{h}^{\ast},\tilde{\pi}_{(h+1)})}(\mu_{h})=J_{h}^{\ast}(\tilde{\pi}%
_{(h+1)},\mu_{h})
V_{h}^{(\pi^{\gt_{h}^{(n)}},\tilde{\pi}_{(h+1)})}(\mu_{h})=J_{h}(\gt_{h}^{(n)}%
,\tilde{\pi}_{(h+1)},\mu_{h})
J_{h}
\pi_{h}^{\ast}
J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(n)},\tilde{\pi}_{(h+%
1)},\mu_{h})\leq\frac{4(H-h)R^{\ast}}{c_{h}^{2}n},
J_{h}(\gt_{h},\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(0)},%
\tilde{\pi}_{(h+1)},\mu_{h})\leq\frac{1}{q}.
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(0)},%
\tilde{\pi}_{(h+1)},\mu_{h})\leq\frac{1}{q}.
q=\frac{\alpha b^{2}}{2}
\alpha=\eta_{h}=\frac{1}{\beta_{h}}
b=c_{h}
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(0)},%
\tilde{\pi}_{(h+1)},\mu_{h})\leq(H-h)R^{\ast}\leq\frac{4(H-h)R^{\ast}}{c_{h}^{%
2}}=\frac{2\beta_{h}}{c_{h}^{2}}=\frac{1}{q}
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(0)},%
\tilde{\pi}_{(h+1)},\mu_{h})\leq(H-h)R^{\ast}\leq\frac{4(H-h)R^{\ast}}{c_{h}^{%
2}}=\frac{2\beta_{h}}{c_{h}^{2}}=\frac{1}{q}
\tilde{\pi}=\hat{\pi}^{\ast}
\displaystyle J_{h}(\gt_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})=V_{h}^{%
\hat{\pi}^{\ast}}(s).
\displaystyle J_{h}(\gt_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})=V_{h}^{%
\hat{\pi}^{\ast}}(s).
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(N_{h})%
},\tilde{\pi}_{(h+1)},\mu_{h})\leq\frac{4(H-h)R^{*}}{c_{h}^{2}N_{h}}.
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(N_{h})%
},\tilde{\pi}_{(h+1)},\mu_{h})\leq\frac{4(H-h)R^{*}}{c_{h}^{2}N_{h}}.
s\in\cS_{h}
\displaystyle\begin{split}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(%
\gt_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})&=\sum_{s^{\prime}\in\cS_{h}}%
\mu_{h}(s^{\prime})\frac{\delta_{s}(s^{\prime})}{\mu_{h}(s^{\prime})}J_{h}^{%
\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h,s}(\gt_{h}^{(N_{h})},\tilde{\pi}_{(%
h+1)},\delta_{s})\\
&\leq\Big{\lVert}\frac{1}{\mu_{h}}\Big{\rVert}_{\infty}\big{(}J_{h}^{\ast}(%
\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{%
h})\big{)}\\
&\leq\frac{4(H-h)R^{*}}{c_{h}^{2}N_{h}}\Big{\lVert}\frac{1}{\mu_{h}}\Big{%
\rVert}_{\infty},\end{split}
\displaystyle\begin{split}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(%
\gt_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})&=\sum_{s^{\prime}\in\cS_{h}}%
\mu_{h}(s^{\prime})\frac{\delta_{s}(s^{\prime})}{\mu_{h}(s^{\prime})}J_{h}^{%
\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h,s}(\gt_{h}^{(N_{h})},\tilde{\pi}_{(%
h+1)},\delta_{s})\\
&\leq\Big{\lVert}\frac{1}{\mu_{h}}\Big{\rVert}_{\infty}\big{(}J_{h}^{\ast}(%
\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{%
h})\big{)}\\
&\leq\frac{4(H-h)R^{*}}{c_{h}^{2}N_{h}}\Big{\lVert}\frac{1}{\mu_{h}}\Big{%
\rVert}_{\infty},\end{split}
\Big{\lVert}\frac{1}{\mu_{h}}\Big{\rVert}_{\infty}=\max_{s\in\cS_{h}}\frac{1}{%
\mu_{h}(s)}>0
N_{h}=\frac{4(H-h)HR^{*}}{c_{h}^{2}\epsilon}\Big{\lVert}\frac{1}{\mu_{h}}\Big{%
\rVert}_{\infty}
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\gt_{h}^{(N_{%
h})},\tilde{\pi}_{(h+1)},\delta_{s})\leq\frac{\epsilon}{H}
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\gt_{h}^{(N_{%
h})},\tilde{\pi}_{(h+1)},\delta_{s})\leq\frac{\epsilon}{H}
s\in\cS_{h}
h=H-1
s\in\cS_{H-1}
\displaystyle V_{H-1}^{\ast}(s)-V_{H-1}^{\hat{\pi}^{\ast}}(s)=J_{H-1}^{\ast}(%
\delta_{s})-J_{H-1}(\gt_{H-1}^{(N_{H-1})},\delta_{s})\leq\frac{\epsilon}{H}.
\displaystyle V_{H-1}^{\ast}(s)-V_{H-1}^{\hat{\pi}^{\ast}}(s)=J_{H-1}^{\ast}(%
\delta_{s})-J_{H-1}(\gt_{H-1}^{(N_{H-1})},\delta_{s})\leq\frac{\epsilon}{H}.
\tilde{\pi}
s\in\cS_{h}
\displaystyle V_{h}^{\ast}(s)-V_{h}^{\hat{\pi}^{\ast}}(s)\leq\frac{\epsilon(H-%
h)}{H}.
\displaystyle V_{h}^{\ast}(s)-V_{h}^{\hat{\pi}^{\ast}}(s)\leq\frac{\epsilon(H-%
h)}{H}.
s\in\cS_{h-1}
\displaystyle\begin{split}J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})&=\max_{%
a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)V_{h}^{%
\ast}(s)-\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)(V_{h}^{\ast}(s)-V_{h}^{%
\hat{\pi}^{\ast}}(s))\Bigr{)}\\
&\geq\max_{a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|%
s,a)V_{h}^{\ast}(s)\Bigr{)}-\frac{\epsilon(H-h)}{H}\\
&=V_{h-1}^{\ast}(s)-\frac{\epsilon(H-h)}{H},\end{split}
\displaystyle\begin{split}J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})&=\max_{%
a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)V_{h}^{%
\ast}(s)-\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)(V_{h}^{\ast}(s)-V_{h}^{%
\hat{\pi}^{\ast}}(s))\Bigr{)}\\
&\geq\max_{a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|%
s,a)V_{h}^{\ast}(s)\Bigr{)}-\frac{\epsilon(H-h)}{H}\\
&=V_{h-1}^{\ast}(s)-\frac{\epsilon(H-h)}{H},\end{split}
s\in\cS_{h-1}
\displaystyle\begin{split}V_{h-1}^{\ast}(s)-V_{h-1}^{\hat{\pi}^{\ast}}(s)&=V_{%
h-1}^{\ast}(s)-J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})+J_{h-1}^{\ast}(%
\tilde{\pi}_{(h)},\delta_{s})-V_{h-1}^{\hat{\pi}^{\ast}}(s)\\
&\leq\frac{\epsilon(H-h)}{H}+\frac{\epsilon}{H}\\
&=\frac{\epsilon(H-(h-1))}{H}.\end{split}
\displaystyle\begin{split}V_{h-1}^{\ast}(s)-V_{h-1}^{\hat{\pi}^{\ast}}(s)&=V_{%
h-1}^{\ast}(s)-J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})+J_{h-1}^{\ast}(%
\tilde{\pi}_{(h)},\delta_{s})-V_{h-1}^{\hat{\pi}^{\ast}}(s)\\
&\leq\frac{\epsilon(H-h)}{H}+\frac{\epsilon}{H}\\
&=\frac{\epsilon(H-(h-1))}{H}.\end{split}
h=0
s\in\cS_{0}
\displaystyle V_{0}^{\ast}(s)-V_{0}^{\hat{\pi}^{\ast}}(s)\leq\epsilon.
\displaystyle V_{0}^{\ast}(s)-V_{0}^{\hat{\pi}^{\ast}}(s)\leq\epsilon.
\gt_{n}=\gt^{(n)}
\mu
\mu(s)>0
s\in\cS
0<\eta\leq\frac{1}{5H^{2}R^{\ast}}
(\theta^{(n)})
\theta^{(0)}\in\cR^{\sum_{h}d_{h}}
s_{h}\in\cS^{[\cH]}
V^{\pi^{\gt^{(n)}}}(s_{h})\to V^{\ast}(s_{h})
n\to\infty
V_{0}^{\pi^{\gt^{(n)}}}(s)\to V_{0}^{\ast}(s)
n\to\infty
s\in\cS_{0}
J(\gt)
J^{\ast}
J(\gt,\mu)
J^{\ast}(\mu)
0<\eta\leq\frac{1}{H^{2}R^{\ast}5}\leq\frac{1}{H^{2}R^{\ast}\big{(}2-\frac{1}{%
|\cA|}\big{)}}=\frac{1}{\beta}
V^{\pi^{\gt_{n+1}}}(s_{h})\geq V^{\pi^{\gt_{n}}}(s_{h})
Q^{\pi^{\gt_{n+1}}}(s_{h},a)\geq Q^{\pi^{\gt_{n}}}(s_{h},a)
s_{h}\in\cS^{[\cH]}
a\in\cA
V^{\infty}(s)
Q^{\infty}(s,a)
\displaystyle\lim\limits_{n\to\infty}V^{\pi^{\gt_{n}}}(s)=V^{\infty}(s)<\infty.
\displaystyle\lim\limits_{n\to\infty}V^{\pi^{\gt_{n}}}(s)=V^{\infty}(s)<\infty.
\displaystyle\lim\limits_{n\to\infty}Q^{\pi^{\gt_{n}}}(s,a)=Q^{\infty}(s,a)<\infty.
\displaystyle\lim\limits_{n\to\infty}Q^{\pi^{\gt_{n}}}(s,a)=Q^{\infty}(s,a)<\infty.
V_{h}^{\pi^{\gt_{n}}}(s)\leq V_{h}^{\pi^{\gt_{n+1}}}(s)
s\in\cS
h
V_{h}^{\infty}(s)
V_{h}^{\pi^{\gt_{n}}}(s)\to V_{h}^{\infty}
n\to\infty
\displaystyle Q_{h}^{\pi^{\gt}}(s,a)=r(s,a)+\sum_{s^{\prime}\in\cS}p(s^{\prime%
}|s,a)V_{h+1}^{\pi^{\gt}}(s^{\prime}),
\displaystyle Q_{h}^{\pi^{\gt}}(s,a)=r(s,a)+\sum_{s^{\prime}\in\cS}p(s^{\prime%
}|s,a)V_{h+1}^{\pi^{\gt}}(s^{\prime}),
V_{H}\equiv 0
\displaystyle V_{h}^{\pi^{\gt_{n+1}}}(s)-V_{h}^{\pi^{\gt_{n}}}(s)=\mathbb{E}_{%
S_{h}=s}^{\pi^{\gt_{n+1}}}\Big{[}\sum_{t=h}^{H-1}A_{t}^{\pi^{\gt_{n}}}(S_{t},A%
_{t})\Big{]}
\displaystyle V_{h}^{\pi^{\gt_{n+1}}}(s)-V_{h}^{\pi^{\gt_{n}}}(s)
\displaystyle=\mathbb{E}_{S_{h}=s}^{\pi^{\gt_{n+1}}}\Big{[}\sum_{t=h}^{H-1}A_{%
t}^{\pi^{\gt_{n}}}(S_{t},A_{t})\Big{]}
\displaystyle=\sum_{s_{l}\in\cS^{[\cH]}}\tilde{\rho}_{s,h}^{\pi^{\gt_{n+1}}}(s%
_{l})\sum_{a\in\cA}\pi^{\gt_{n+1}}(a|s_{l})A^{\pi^{\gt_{n}}}(s_{l},a),
\displaystyle=\sum_{s_{l}\in\cS^{[\cH]}}\tilde{\rho}_{s,h}^{\pi^{\gt_{n+1}}}(s%
_{l})\sum_{a\in\cA}\pi^{\gt_{n+1}}(a|s_{l})A^{\pi^{\gt_{n}}}(s_{l},a),
\tilde{\rho}_{s,h}^{\pi^{\gt_{n+1}}}(s_{l}):=\sum_{t=h}^{H-1}\bbP_{S_{h}=s}^{%
\pi^{\gt_{n+1}}}(S_{t}=s_{l})
h
H-1
\cS^{[\cH]}
\tilde{\rho}_{s,h}^{\pi^{\gt_{n+1}}}(s_{l})=0
l<h
\sum_{a\in\cA}\pi^{\gt_{n+1}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a)\geq\sum_{a\in%
\cA}\pi^{\gt_{n}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a)
s_{h}\in\cS^{[\cH]}
\sum_{a\in\cA}\pi^{\gt_{n}}(a|s)A^{\pi^{\gt_{n}}}(s,a)=0
\displaystyle F_{s_{h}}(\gt^{s_{h}}):=\sum_{a\in\cA}\pi^{\gt^{s_{h}}}(a|s_{h})%
c(s_{h},a)\quad s_{h}\in\cS^{[\cH]},
\displaystyle F_{s_{h}}(\gt^{s_{h}}):=\sum_{a\in\cA}\pi^{\gt^{s_{h}}}(a|s_{h})%
c(s_{h},a)\quad s_{h}\in\cS^{[\cH]},
\gt^{s_{h}}=(\gt(s_{h},a))_{a\in\cA}\in\mathbb{R}^{|\cA|}
c(s_{h},a)=A_{h}^{\pi^{\gt_{n}}}(s_{h},a)
\gt_{n}
\gt^{s_{h}}
F
A^{\pi^{\gt_{n}}}
\displaystyle\frac{\partial F_{s_{h}}(\gt^{s_{h}})}{\partial\gt(s_{h},a)}\Big{%
|}_{\gt_{n}^{s_{h}}}=\pi^{\gt_{s_{h}}^{(n)}}(a|s_{h})A_{h}^{\pi^{\gt_{n}}}(s_{%
h},a).
\displaystyle\frac{\partial F_{s_{h}}(\gt^{s_{h}})}{\partial\gt(s_{h},a)}\Big{%
|}_{\gt_{n}^{s_{h}}}=\pi^{\gt_{s_{h}}^{(n)}}(a|s_{h})A_{h}^{\pi^{\gt_{n}}}(s_{%
h},a).
F_{s_{h}}(\gt_{s_{h}})
5HR^{\ast}
s_{h}
\displaystyle\gt_{n+1}(s_{h},a)=\gt_{n}(s_{h},a)+\eta\frac{\partial V^{\pi^{%
\gt_{n}}}(\mu)}{\partial\gt_{n}(s_{h},a)}
\displaystyle\gt_{n+1}(s_{h},a)
\displaystyle=\gt_{n}(s_{h},a)+\eta\frac{\partial V^{\pi^{\gt_{n}}}(\mu)}{%
\partial\gt_{n}(s_{h},a)}
\displaystyle=\gt_{n}(s_{h},a)+\eta\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})%
\pi^{\gt_{n}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a)
\displaystyle=\gt_{n}(s_{h},a)+\eta\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})%
\pi^{\gt_{n}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a)
\displaystyle=\gt_{n}(s_{h},a)+\eta\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})%
\frac{\partial F_{s_{h}}(\gt_{s_{h}})}{\partial\gt_{n}(s_{h},a)}\Big{|}_{\gt_{%
n}^{s_{h}}}.
\displaystyle=\gt_{n}(s_{h},a)+\eta\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})%
\frac{\partial F_{s_{h}}(\gt_{s_{h}})}{\partial\gt_{n}(s_{h},a)}\Big{|}_{\gt_{%
n}^{s_{h}}}.
\eta\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})=\eta Hd_{\mu}^{\pi^{\gt_{n}}}(s_%
{h})
d_{\mu}^{\pi^{\gt_{n}}}(s_{h})
\eta\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\leq\frac{1}{5HR^{\ast}}
\eta\leq\frac{1}{H^{2}R^{\ast}5}
5HR^{\ast}
F_{s_{h}}
\displaystyle\sum_{a\in\cA}\pi^{\gt_{n+1}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a)%
\geq\sum_{a\in\cA}\pi^{\gt_{n}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a).
\displaystyle\sum_{a\in\cA}\pi^{\gt_{n+1}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a)%
\geq\sum_{a\in\cA}\pi^{\gt_{n}}(a|s_{h})A^{\pi^{\gt_{n}}}(s_{h},a).
0<\eta\leq\frac{1}{5H^{2}R^{\ast}}
\displaystyle\Delta=\min_{\{(s_{h},a)\in(\cS H)\times\cA\,:\,A^{\infty}(s_{h},%
a)\neq 0\}}|A^{\infty}(s_{h},a)|
\displaystyle\Delta=\min_{\{(s_{h},a)\in(\cS H)\times\cA\,:\,A^{\infty}(s_{h},%
a)\neq 0\}}|A^{\infty}(s_{h},a)|
A^{\infty}(s_{h},a)=Q^{\infty}(s_{h},a)-V^{\infty}(s_{h})
s_{h}\in\cS^{[\cH]}
\displaystyle I_{0}^{s_{h}}=\{a\in\cA\,|\,Q^{\infty}(s_{h},a)=V^{\infty}(s_{h}%
)\},
\displaystyle I_{0}^{s_{h}}=\{a\in\cA\,|\,Q^{\infty}(s_{h},a)=V^{\infty}(s_{h}%
)\},
\displaystyle I_{+}^{s_{h}}=\{a\in\cA\,|\,Q^{\infty}(s_{h},a)>V^{\infty}(s_{h}%
)\},
\displaystyle I_{+}^{s_{h}}=\{a\in\cA\,|\,Q^{\infty}(s_{h},a)>V^{\infty}(s_{h}%
)\},
\displaystyle I_{-}^{s_{h}}=\{a\in\cA\,|\,Q^{\infty}(s_{h},a)<V^{\infty}(s_{h}%
)\}.
\displaystyle I_{-}^{s_{h}}=\{a\in\cA\,|\,Q^{\infty}(s_{h},a)<V^{\infty}(s_{h}%
)\}.
I_{+}^{s_{h}}
V^{\infty}(s_{h})=V^{\ast}(s_{h})
N_{1}>0
n>N_{1}
s_{h}\in\cS^{[\cH]}
\displaystyle A^{\gt_{n}}(s_{h},a)<-\frac{\Delta}{4}\textrm{ for }a\in I_{-}^{%
s_{h}};\quad A^{\gt_{n}}(s_{h},a)>\frac{\Delta}{4}\textrm{ for }a\in I_{+}^{s_%
{h}}.
\displaystyle A^{\gt_{n}}(s_{h},a)<-\frac{\Delta}{4}\textrm{ for }a\in I_{-}^{%
s_{h}};\quad A^{\gt_{n}}(s_{h},a)>\frac{\Delta}{4}\textrm{ for }a\in I_{+}^{s_%
{h}}.
s_{h}\in\cS^{[\cH]}
V^{\pi^{\gt_{n}}}(s_{h})\to V^{\infty}(s_{h})
n\to\infty
\cS
N_{1}>0
n>N_{1}
s_{h}\in\cS^{[\cH]}
\displaystyle V^{\pi^{\gt_{n}}}(s_{h})>V^{\infty}(s_{h})-\frac{\Delta}{4}.
\displaystyle V^{\pi^{\gt_{n}}}(s_{h})>V^{\infty}(s_{h})-\frac{\Delta}{4}.
n>N_{1}
s_{h}\in\cS^{[\cH]}
a\in I_{-}^{s_{h}}
\Delta
\displaystyle A^{\gt_{n}}(s_{h},a)=Q^{\gt_{n}}(s_{h},a)-V^{\pi^{\gt_{n}}}(s_{h%
})\leq Q^{\infty}(s_{h},a)-V^{\infty}(s_{h})+\frac{\Delta}{4}\leq-\Delta+\frac%
{\Delta}{4}<-\frac{\Delta}{4}.
\displaystyle A^{\gt_{n}}(s_{h},a)
\displaystyle=Q^{\gt_{n}}(s_{h},a)-V^{\pi^{\gt_{n}}}(s_{h})\leq Q^{\infty}(s_{%
h},a)-V^{\infty}(s_{h})+\frac{\Delta}{4}\leq-\Delta+\frac{\Delta}{4}<-\frac{%
\Delta}{4}.
n>N_{1}
s_{h}\in\cS^{[\cH]}
a\in I_{+}^{s_{h}}
\Delta
\displaystyle A_{h}^{\gt_{n}}(s,a)=Q^{\gt_{n}}(s_{h},a)-V^{\pi^{\gt_{n}}}(s_{h%
})\geq Q^{\infty}(s,a)-\frac{\Delta}{4}-V^{\infty}(s_{h})\geq\Delta-\frac{%
\Delta}{4}>\frac{\Delta}{4}.
\displaystyle A_{h}^{\gt_{n}}(s,a)
\displaystyle=Q^{\gt_{n}}(s_{h},a)-V^{\pi^{\gt_{n}}}(s_{h})\geq Q^{\infty}(s,a%
)-\frac{\Delta}{4}-V^{\infty}(s_{h})\geq\Delta-\frac{\Delta}{4}>\frac{\Delta}{%
4}.
\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}\to 0
n\to\infty
s_{h}\in\cS^{[\cH]}
a\in\cA_{s}
a\in I_{+}^{s_{h}}\cup I_{-}^{s_{h}}
\pi^{\gt_{n}}(a|s_{h})\to 0
\sum_{a\in I_{0}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})\to 1
n\to\infty
\beta
f:\mathbb{R}^{d}\to\mathbb{R}
\lVert\nabla f(x^{k})\rVert\to 0
k\to\infty
x^{k+1}=x^{k}-\eta\nabla f(x^{k})
\eta<\frac{1}{\beta}
J(\cdot)
H^{2}R^{\ast}(2-\frac{1}{|\cA|})
\eta<\frac{1}{5H^{2}R^{\ast}}
\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}\to 0
n\to\infty
s_{h}\in\cS^{[\cH]}
a\in\cA_{s}
\displaystyle\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}=\tilde{\rho}%
_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a|s_{h})A^{\gt_{n}}(s_{h},a),
\displaystyle\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}=\tilde{\rho}%
_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a|s_{h})A^{\gt_{n}}(s_{h},a),
|A^{\gt_{n}}(s_{h},a)|>\frac{\Delta}{4}
n>N_{1}
a\in I_{+}^{s_{h}}\cup I_{-}^{s_{h}}
\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})>0
\mu
\pi^{\gt_{n}}(a|s)\to 0
n\to\infty
a\in I_{+}^{s_{h}}\cup I_{-}^{s_{h}}
\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}\to 0
n\to\infty
\sum_{a\in I_{0}^{s}}\pi^{\gt_{n}}(a|s_{h})\to 1
n\to\infty
\sum_{a\in\cA_{s}}\pi^{\gt_{n}}(a|s_{h})=1
\displaystyle\lim_{n\to\infty}\sum_{a\in I_{0}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})=%
\lim_{n\to\infty}\Bigl{(}\sum_{a\in\cA}\pi^{\gt_{n}}(a|s_{h})-\sum_{a\in I_{+}%
^{s_{h}}\cup I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})\Bigr{)}
\displaystyle\lim_{n\to\infty}\sum_{a\in I_{0}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})
\displaystyle=\lim_{n\to\infty}\Bigl{(}\sum_{a\in\cA}\pi^{\gt_{n}}(a|s_{h})-%
\sum_{a\in I_{+}^{s_{h}}\cup I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})\Bigr{)}
\displaystyle=1-\sum_{a\in I_{+}^{s_{h}}\cup I_{-}^{s_{h}}}\lim_{n\to\infty}%
\pi^{\gt_{n}}(a|s_{h})
\displaystyle=1-\sum_{a\in I_{+}^{s_{h}}\cup I_{-}^{s_{h}}}\lim_{n\to\infty}%
\pi^{\gt_{n}}(a|s_{h})
\displaystyle=1.
\displaystyle=1.
a\in I_{+}^{s_{h}}
(\gt_{n}(s_{h},a))_{n\geq 0}
n>N_{1}
a\in I_{-}^{s_{h}}
(\gt_{n}(s_{h},a))_{n\geq 0}
n>N_{1}
n>N_{1}
\displaystyle A_{h}^{\gt_{n}}(s_{h},a)>0\,\textrm{ for }a\in I_{+}^{s_{h}};%
\quad A_{h}^{\gt_{n}}(s_{h},a)<0\,\textrm{ for }a\in I_{-}^{s_{h}},
\displaystyle A_{h}^{\gt_{n}}(s_{h},a)>0\,\textrm{ for }a\in I_{+}^{s_{h}};%
\quad A_{h}^{\gt_{n}}(s_{h},a)<0\,\textrm{ for }a\in I_{-}^{s_{h}},
\displaystyle\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}=\tilde{\rho}%
_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{n}}(s_{h},a).
\displaystyle\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}=\tilde{\rho}%
_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{n}}(s_{h},a).
\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})>0
\mu(s)>0
n>N_{1}
\displaystyle\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}>0\,\textrm{ %
for }a\in I_{+}^{s_{h}};\quad\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},%
a)}<0\,\textrm{ for }a\in I_{-}^{s_{h}}.
\displaystyle\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a)}>0\,\textrm{ %
for }a\in I_{+}^{s_{h}};\quad\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},%
a)}<0\,\textrm{ for }a\in I_{-}^{s_{h}}.
a\in I_{+}^{s_{h}}
\gt_{n+1}(s_{h},a)-\gt_{n}(s_{h},a)=\eta\frac{\partial J(\gt_{n})}{\partial\gt%
(s_{h},a)}>0,
(\gt_{n}(s_{h},a))_{n\geq 0}
n>N_{1}
a\in I_{-}^{s_{h}}
\gt_{n+1}(s_{h},a)-\gt_{n}(s_{h},a)=\eta\frac{\partial J(\gt_{n})}{\partial\gt%
_{n}(s_{h},a)}<0,
(\gt_{n}(s_{h},a))_{n\geq 0}
n>N_{1}
s_{h}\in\cS^{[\cH]}
I_{+}^{s_{h}}\neq\emptyset
\displaystyle\max_{a\in I_{0}^{s_{h}}}\gt_{n}(s_{h},a)\to\infty\quad\textrm{ %
and }\quad\min_{a\in\cA}\gt_{n}(s_{h},a)\to-\infty\quad\textrm{ for }n\to\infty.
\displaystyle\max_{a\in I_{0}^{s_{h}}}\gt_{n}(s_{h},a)\to\infty\quad\textrm{ %
and }\quad\min_{a\in\cA}\gt_{n}(s_{h},a)\to-\infty\quad\textrm{ for }n\to\infty.
I_{+}^{s_{h}}\neq\emptyset
a_{+}\in I_{+}^{s_{h}}
\pi^{\gt_{n}}(a_{+}|s_{h})\to 0
n\to\infty
\displaystyle\frac{\exp(\gt_{n}(s_{h},a_{+}))}{\sum\limits_{a\in\cA}\exp(\gt_{%
n}(s_{h},a))}\to 0,\,\textrm{ for }n\to\infty.
\displaystyle\frac{\exp(\gt_{n}(s_{h},a_{+}))}{\sum\limits_{a\in\cA}\exp(\gt_{%
n}(s_{h},a))}\to 0,\,\textrm{ for }n\to\infty.
\gt_{n}(s_{h},a_{+})
n>N_{1}
\exp(\gt_{n}(s_{h},a_{+}))
n>N_{1}
\displaystyle\sum\limits_{a\in\cA}\exp(\gt_{n}(s_{h},a))\to\infty,\,\textrm{ %
for }n\to\infty.
\displaystyle\sum\limits_{a\in\cA}\exp(\gt_{n}(s_{h},a))\to\infty,\,\textrm{ %
for }n\to\infty.
\displaystyle\sum\limits_{a\in I_{0}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})\to 1,\,%
\textrm{ for }n\to\infty,
\displaystyle\sum\limits_{a\in I_{0}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})\to 1,\,%
\textrm{ for }n\to\infty,
\displaystyle\sum\limits_{a\in I_{0}^{s_{h}}}\frac{\exp(\gt_{n}(s_{h},a))}{%
\sum\limits_{a^{\prime}\in\cA}\exp(\gt_{n}(s_{h},a^{\prime}))}\to 1,\,\textrm{%
 for }n\to\infty.
\displaystyle\sum\limits_{a\in I_{0}^{s_{h}}}\frac{\exp(\gt_{n}(s_{h},a))}{%
\sum\limits_{a^{\prime}\in\cA}\exp(\gt_{n}(s_{h},a^{\prime}))}\to 1,\,\textrm{%
 for }n\to\infty.
\sum\limits_{a^{\prime}\in\cA}\exp(\gt_{n}(s_{h},a^{\prime}))\to\infty
\displaystyle\sum\limits_{a\in I_{0}^{s_{h}}}\exp(\gt_{n}(s_{h},a))\to\infty,%
\,\textrm{ for }n\to\infty
\displaystyle\sum\limits_{a\in I_{0}^{s_{h}}}\exp(\gt_{n}(s_{h},a))\to\infty,%
\,\textrm{ for }n\to\infty
\displaystyle\max_{a\in I_{0}^{s_{h}}}\gt_{n}(s_{h},a)\to\infty,\,\textrm{ for%
 }n\to\infty.
\displaystyle\max_{a\in I_{0}^{s_{h}}}\gt_{n}(s_{h},a)\to\infty,\,\textrm{ for%
 }n\to\infty.
\displaystyle\sum\limits_{a\in\cA}\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s%
_{h},a)}=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\sum\limits_{a\in\cA}\pi^{%
\gt_{n}}(a|s_{h})(Q_{h}^{\pi^{\gt_{n}}}(s_{h},a)-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle\sum\limits_{a\in\cA}\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s%
_{h},a)}
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\sum\limits_{a\in\cA}%
\pi^{\gt_{n}}(a|s_{h})(Q_{h}^{\pi^{\gt_{n}}}(s_{h},a)-V_{h}^{\pi^{\gt_{n}}}(s_%
{h}))
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})(\mathbb{E}_{S_{h}=s}^{%
\pi^{\gt_{n}}}[Q_{h}^{\pi^{\gt_{n}}}(s_{h},a)]-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})(\mathbb{E}_{S_{h}=s}^{%
\pi^{\gt_{n}}}[Q_{h}^{\pi^{\gt_{n}}}(s_{h},a)]-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})(V_{h}^{\pi^{\gt_{n}}}(%
s_{h})-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})(V_{h}^{\pi^{\gt_{n}}}(%
s_{h})-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle=0.
\displaystyle=0.
\sum_{a\in\cA}\gt_{n}(s_{h},a)=\sum_{a\in\cA}\gt_{0}(s_{h},a):=c
n>0
\displaystyle\min_{a\in\cA}\gt_{n}(s_{h},a)<\sum\limits_{a\in\cA}\gt_{n}(s_{h}%
,a)-\max_{a\in\cA}\gt_{n}(s_{h},a)=-\max_{a\in\cA}\gt_{n}(s_{h},a)+c.
\displaystyle\min_{a\in\cA}\gt_{n}(s_{h},a)<\sum\limits_{a\in\cA}\gt_{n}(s_{h}%
,a)-\max_{a\in\cA}\gt_{n}(s_{h},a)=-\max_{a\in\cA}\gt_{n}(s_{h},a)+c.
\max_{a\in\cA}\gt_{n}(s_{h},a)\to\infty
\max_{a\in I_{0}^{s_{h}}}\gt_{n}(s_{h},a)\to\infty
\min_{a\in\cA}\gt_{n}(s_{h},a)\to-\infty
n\to\infty
a_{+}\in I_{+}^{s_{h}}
a\in I_{0}^{s_{h}}
n>N_{1}
\pi^{\gt_{n}}(a|s_{h})\leq\pi^{\gt_{n}}(a_{+}|s_{h})
m>n
\pi^{\gt_{m}}(a|s_{h})\leq\pi^{\gt_{m}}(a_{+}|s_{h})
a\in I_{0}^{s}
n>0
\pi^{\gt_{n}}(a|{s_{h}})\leq\pi^{\gt_{n}}(a_{+}|{s_{h}})
\pi^{\gt_{n+1}}(a|{s_{h}})\leq\pi^{\gt_{n+1}}(a_{+}|{s_{h}})
\displaystyle\frac{\partial J_{h}(\gt_{n})}{\partial\gt_{n}({s_{h}},a)}=\tilde%
{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a|s_{h})(Q_{h}^{\pi^{\gt_{n}}%
}(s_{h},a)-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle\frac{\partial J_{h}(\gt_{n})}{\partial\gt_{n}({s_{h}},a)}
\displaystyle=\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a|s_{h})(%
Q_{h}^{\pi^{\gt_{n}}}(s_{h},a)-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle\leq\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a_{+}|%
s_{h})(Q_{h}^{\pi^{\gt_{n}}}(s_{h},a_{+})-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle\leq\tilde{\rho}_{\mu}^{\pi^{\gt_{n}}}(s_{h})\pi^{\gt_{n}}(a_{+}|%
s_{h})(Q_{h}^{\pi^{\gt_{n}}}(s_{h},a_{+})-V_{h}^{\pi^{\gt_{n}}}(s_{h}))
\displaystyle=\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a_{+})},
\displaystyle=\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s_{h},a_{+})},
\displaystyle Q_{h}^{\pi^{\gt_{n}}}(s_{h},a_{+})\geq Q_{h}^{\infty}(s_{h},a_{+%
})-\frac{\Delta}{4}
\displaystyle Q_{h}^{\pi^{\gt_{n}}}(s_{h},a_{+})
\displaystyle\geq Q_{h}^{\infty}(s_{h},a_{+})-\frac{\Delta}{4}
\displaystyle\geq Q_{h}^{\infty}(s_{h},a)+\Delta-\frac{\Delta}{4}
\displaystyle\geq Q_{h}^{\infty}(s_{h},a)+\Delta-\frac{\Delta}{4}
\displaystyle>Q_{h}^{\pi^{\gt_{n}}}(s_{h},a).
\displaystyle>Q_{h}^{\pi^{\gt_{n}}}(s_{h},a).
\Delta
a\in I_{0}^{s_{h}}
\pi^{\gt_{n}}(a|s_{h})\leq\pi^{\gt_{n}}(a_{+}|s_{h})
\gt_{n}(s_{h},a)\leq\gt_{n}(s_{h},a_{+})
\displaystyle\gt_{n+1}(s_{h},a)=\gt_{n}(s_{h},a)+\eta\frac{\partial J(\gt_{n})%
}{\partial\gt_{n}(s_{h},a)}\leq\gt(s_{h},a_{+})+\eta\frac{\partial J(\gt_{n})}%
{\partial\gt_{n}(s_{h},a_{+})}=\gt_{n+1}(s_{h},a_{+}).
\displaystyle\gt_{n+1}(s_{h},a)
\displaystyle=\gt_{n}(s_{h},a)+\eta\frac{\partial J(\gt_{n})}{\partial\gt_{n}(%
s_{h},a)}\leq\gt(s_{h},a_{+})+\eta\frac{\partial J(\gt_{n})}{\partial\gt_{n}(s%
_{h},a_{+})}=\gt_{n+1}(s_{h},a_{+}).
a_{+}\in I_{+}^{s_{h}}
\displaystyle B_{0}^{s_{h}}(a_{+})=\{a\in I_{0}^{s_{h}}|\pi^{\gt_{n}}(a_{+}|s_%
{h})\leq\pi^{\gt_{n}}(a|s_{h})\textrm{ for all }l>0\}
\displaystyle B_{0}^{s_{h}}(a_{+})=\{a\in I_{0}^{s_{h}}|\pi^{\gt_{n}}(a_{+}|s_%
{h})\leq\pi^{\gt_{n}}(a|s_{h})\textrm{ for all }l>0\}
I_{0}^{s_{h}}
\bar{B}_{0}^{s_{h}}(a_{+})=I_{0}^{s_{h}}\setminus B_{0}^{s_{h}}(a_{+})
I_{+}^{s_{h}}\neq\emptyset
a_{+}\in I_{+}^{s_{h}}
B_{0}^{s_{h}}(a_{+})\neq\emptyset
\displaystyle\sum\limits_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})\to 1%
,\,\textrm{ as }n\to\infty.
\displaystyle\sum\limits_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})\to 1%
,\,\textrm{ as }n\to\infty.
\displaystyle\max_{a\in B_{0}^{s_{h}}(a_{+})}\gt_{n}(s_{h},a)\to\infty,\,%
\textrm{ for }n\to\infty.
\displaystyle\max_{a\in B_{0}^{s_{h}}(a_{+})}\gt_{n}(s_{h},a)\to\infty,\,%
\textrm{ for }n\to\infty.
a_{+}\in I_{+}^{s_{h}}
a\in\bar{B}_{0}^{s_{h}}(a_{+})
\bar{B}_{0}^{s_{h}}(a_{+})
n^{\prime}>N_{1}
\pi^{\gt_{n^{\prime}}}(a_{+}|s_{h})\geq\pi^{\gt_{n^{\prime}}}(a|s_{h})
n\geq n^{\prime}
\pi^{\gt_{n}}(a_{+}|s_{h})\geq\pi^{\gt_{n}}(a|s_{h})
\pi^{\gt_{n}}(a_{+}|s_{h})\to 0
n\to\infty
\pi^{\gt_{n}}(a|s_{h})\to 0
n\to\infty
a\in\bar{B}_{0}^{s_{h}}(a_{+})
\sum_{a\in I_{0}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})\to 1
n\to\infty
B_{0}^{s_{h}}(a_{+})\neq\emptyset
\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})\to 1
n\to\infty
s_{h}\in\cS\times\cH
I_{+}^{s_{h}}\neq\emptyset
a_{+}\in I_{+}^{s_{h}}
N_{a_{+}}
n>N_{a_{+}}
\displaystyle\pi^{\gt_{n}}(a_{+}|s_{h})>\pi^{\gt_{n}}(a|s_{h})\,\textrm{ for %
all }a\in\bar{B}_{0}^{s_{h}}(a_{+}).
\displaystyle\pi^{\gt_{n}}(a_{+}|s_{h})>\pi^{\gt_{n}}(a|s_{h})\,\textrm{ for %
all }a\in\bar{B}_{0}^{s_{h}}(a_{+}).
a\in\bar{B}_{0}^{s_{h}}(a_{+})
n_{a}
\displaystyle\pi^{\gt_{n}}(a_{+}|s_{h})>\pi^{\gt_{n}}(a|s_{h})\,\textrm{ for %
all }a\in\bar{B}_{0}^{s_{h}}(a_{+})
\displaystyle\pi^{\gt_{n}}(a_{+}|s_{h})>\pi^{\gt_{n}}(a|s_{h})\,\textrm{ for %
all }a\in\bar{B}_{0}^{s_{h}}(a_{+})
n>n_{a}
N_{a_{+}}=\max_{a\in\bar{B}_{0}^{s_{h}}(a_{+})}n_{a}
I_{+}^{s_{h}}\neq\emptyset
a\in I_{+}^{s_{h}}
\gt_{n}(s_{h},a)
n\to\infty
a\in I_{-}^{s_{h}}
\gt_{n}(s_{h},a)\to-\infty
n\to\infty
\gt_{n}(s_{h},a)
a\in I_{+}^{s_{h}}
n>N_{1}
n>N_{1}
\gt_{n}(s_{h},a)\geq\gt_{N_{1}}(s_{h},a)
a\in I_{-}^{s_{h}}
\gt_{n}(s_{h},a)
n>N_{1}
b
\lim\limits_{n\to\infty}\gt_{n}(s_{h},a)=b
\gt_{n}(s_{h},a)>b
n>N_{1}
a^{\prime}\in\cA
\gt_{n}(s_{h},a^{\prime})\to-\infty
n\to\infty
\delta>0
\gt_{N_{1}}(s_{h},a^{\prime})\geq b-\delta
n>N_{1}
\displaystyle\tau(n)=\max\{k\in(N_{1},n]:\gt_{k}(s_{h},a^{\prime})\geq b-%
\delta\}.
\displaystyle\tau(n)=\max\{k\in(N_{1},n]:\gt_{k}(s_{h},a^{\prime})\geq b-%
\delta\}.
\displaystyle\cT^{(n)}=\Big{\{}\tau(n)<n^{\prime}<n:\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}\leq 0\Big{\}},
\displaystyle\cT^{(n)}=\Big{\{}\tau(n)<n^{\prime}<n:\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}\leq 0\Big{\}},
n^{\prime}
(\tau(n),n)
\gt_{n^{\prime}}(s_{h},a^{\prime})
Z_{n}:=\sum_{n^{\prime}\in\cT^{(n)}}\frac{\partial J(\gt_{n^{\prime}})}{%
\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}
\displaystyle Z_{n}=\sum_{n^{\prime}\in\cT^{(n)}}\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}
\displaystyle Z_{n}
\displaystyle=\sum_{n^{\prime}\in\cT^{(n)}}\frac{\partial J(\gt_{n^{\prime}})}%
{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}
\displaystyle\leq\sum_{n^{\prime}=\tau(n)+1}^{n-1}\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}
\displaystyle\leq\sum_{n^{\prime}=\tau(n)+1}^{n-1}\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}
\displaystyle\leq\sum_{n^{\prime}=\tau(n)}^{n-1}\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}+\Big{|}\frac{\partial J%
(\gt_{\tau(n)})}{\partial\gt_{\tau(n)}(s_{h},a^{\prime})}\Big{|}.
\displaystyle\leq\sum_{n^{\prime}=\tau(n)}^{n-1}\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}+\Big{|}\frac{\partial J%
(\gt_{\tau(n)})}{\partial\gt_{\tau(n)}(s_{h},a^{\prime})}\Big{|}.
\displaystyle\Big{|}\frac{\partial J(\gt_{\tau(n)})}{\partial\gt_{\tau(n)}(s_{%
h},a^{\prime})}\Big{|}=\tilde{\rho}_{\mu}^{\pi^{\gt_{\tau(n)}}}(s_{h})\pi^{\gt%
_{\tau(n)}}(a^{\prime}|s_{h})|A_{h}^{\gt_{\tau(n)}}(s_{h},a^{\prime})|\leq H^{%
2}R^{*}.
\displaystyle\Big{|}\frac{\partial J(\gt_{\tau(n)})}{\partial\gt_{\tau(n)}(s_{%
h},a^{\prime})}\Big{|}=\tilde{\rho}_{\mu}^{\pi^{\gt_{\tau(n)}}}(s_{h})\pi^{\gt%
_{\tau(n)}}(a^{\prime}|s_{h})|A_{h}^{\gt_{\tau(n)}}(s_{h},a^{\prime})|\leq H^{%
2}R^{*}.
\displaystyle Z_{n}\leq\sum_{n^{\prime}=\tau(n)}^{n-1}\frac{\partial J(\gt_{n^%
{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}+H^{2}R^{*}
\displaystyle Z_{n}
\displaystyle\leq\sum_{n^{\prime}=\tau(n)}^{n-1}\frac{\partial J(\gt_{n^{%
\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})}+H^{2}R^{*}
\displaystyle=\frac{1}{\eta}(\gt_{n}(s_{h},a^{\prime})-\gt_{\tau(n)}(s_{h},a^{%
\prime}))+H^{2}R^{*}
\displaystyle=\frac{1}{\eta}(\gt_{n}(s_{h},a^{\prime})-\gt_{\tau(n)}(s_{h},a^{%
\prime}))+H^{2}R^{*}
\displaystyle\leq\frac{1}{\eta}(\gt_{n}(s_{h},a^{\prime})-b+\delta)+H^{2}R^{*}.
\displaystyle\leq\frac{1}{\eta}(\gt_{n}(s_{h},a^{\prime})-b+\delta)+H^{2}R^{*}.
\gt_{n}(s_{h},a^{\prime})\to-\infty
n\to\infty
Z_{n}\to-\infty
n\to\infty
a\in I_{-}^{s_{h}}
|A_{h}^{\gt_{n}}(s_{h},a)|\geq\frac{\Delta}{4}
n>N_{1}
n^{\prime}\in\cT^{(n)}
\displaystyle\Bigg{|}\frac{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^%
{\prime}}(s_{h},a)}}{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{%
\prime}}(s_{h},a^{\prime})}}\Bigg{|}=\Bigg{|}\frac{\pi^{\gt_{n^{\prime}}}(a|s_%
{h})A_{h}^{\gt_{n^{\prime}}}(s_{h},a)}{\pi^{\gt_{n^{\prime}}}(a^{\prime}|s_{h}%
)A_{h}^{\gt_{n^{\prime}}}(s_{h},a^{\prime})}\Bigg{|}
\displaystyle\Bigg{|}\frac{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^%
{\prime}}(s_{h},a)}}{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{%
\prime}}(s_{h},a^{\prime})}}\Bigg{|}
\displaystyle=\Bigg{|}\frac{\pi^{\gt_{n^{\prime}}}(a|s_{h})A_{h}^{\gt_{n^{%
\prime}}}(s_{h},a)}{\pi^{\gt_{n^{\prime}}}(a^{\prime}|s_{h})A_{h}^{\gt_{n^{%
\prime}}}(s_{h},a^{\prime})}\Bigg{|}
\displaystyle\geq\frac{\pi^{\gt_{n^{\prime}}}(a|s_{h})}{\pi^{\gt_{n^{\prime}}}%
(a^{\prime}|s_{h})}\frac{\Delta}{4HR^{*}}
\displaystyle\geq\frac{\pi^{\gt_{n^{\prime}}}(a|s_{h})}{\pi^{\gt_{n^{\prime}}}%
(a^{\prime}|s_{h})}\frac{\Delta}{4HR^{*}}
\displaystyle=\exp(\gt_{n^{\prime}}(s_{h},a)-\gt_{n^{\prime}}(s_{h},a^{\prime}%
))\frac{\Delta}{4HR^{*}}
\displaystyle=\exp(\gt_{n^{\prime}}(s_{h},a)-\gt_{n^{\prime}}(s_{h},a^{\prime}%
))\frac{\Delta}{4HR^{*}}
\displaystyle\geq\exp(b-(b-\delta))\frac{\Delta}{4HR^{*}}
\displaystyle\geq\exp(b-(b-\delta))\frac{\Delta}{4HR^{*}}
\displaystyle=\exp(\delta)\frac{\Delta}{4HR^{*}},
\displaystyle=\exp(\delta)\frac{\Delta}{4HR^{*}},
\gt_{n^{\prime}}(s_{h},a^{\prime})\leq b-\delta
n^{\prime}>\tau(n)
\gt_{n^{\prime}}(s_{h},a)>b
n^{\prime}>N_{1}
\cT^{(n)}
n^{\prime}\in\cT^{(n)}
n>N_{1}
\cT^{(n)}\neq\emptyset
\displaystyle\frac{1}{\eta}\Big{(}\gt_{N_{1}}(s_{h},a)-\gt_{n}(s_{h},a)\Big{)}%
=\sum_{n^{\prime}=N_{1}+1}^{n-1}\frac{\partial J(\gt_{n^{\prime}})}{\partial%
\gt_{n^{\prime}}(s_{h},a)}
\displaystyle\frac{1}{\eta}\Big{(}\gt_{N_{1}}(s_{h},a)-\gt_{n}(s_{h},a)\Big{)}
\displaystyle=\sum_{n^{\prime}=N_{1}+1}^{n-1}\frac{\partial J(\gt_{n^{\prime}}%
)}{\partial\gt_{n^{\prime}}(s_{h},a)}
\displaystyle\leq\sum_{n^{\prime}\in\cT^{(n)}}\frac{\partial J(\gt_{n^{\prime}%
})}{\partial\gt_{n^{\prime}}(s_{h},a)}
\displaystyle\leq\sum_{n^{\prime}\in\cT^{(n)}}\frac{\partial J(\gt_{n^{\prime}%
})}{\partial\gt_{n^{\prime}}(s_{h},a)}
\displaystyle\leq\exp(\delta)\frac{\Delta}{4HR^{*}}\sum_{n^{\prime}\in\cT^{(n)%
}}\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime%
})}
\displaystyle\leq\exp(\delta)\frac{\Delta}{4HR^{*}}\sum_{n^{\prime}\in\cT^{(n)%
}}\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime%
})}
\displaystyle=\exp(\delta)\frac{\Delta}{4HR^{*}}Z_{n},
\displaystyle=\exp(\delta)\frac{\Delta}{4HR^{*}}Z_{n},
\gt_{n^{\prime}}(s_{h},a)
n^{\prime}>N_{1}
\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a)}<0
n^{\prime}\in\{N_{1}+1,\dots,n-1\}
\displaystyle\Bigg{|}\frac{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^%
{\prime}}(s_{h},a)}}{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{%
\prime}}(s_{h},a^{\prime})}}\Bigg{|}\geq\exp(\delta)\frac{\Delta}{4HR^{*}}.
\displaystyle\Bigg{|}\frac{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^%
{\prime}}(s_{h},a)}}{\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{%
\prime}}(s_{h},a^{\prime})}}\Bigg{|}\geq\exp(\delta)\frac{\Delta}{4HR^{*}}.
\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a)}<0
\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a^{\prime})%
}<0
n^{\prime}\in\cT^{(n)}
Z_{n}\to-\infty
\gt_{n}(s_{h},a)\to\infty
n\to\infty
\gt_{n}(s_{h},a)
n>N_{1}
s\in\cS^{[\cH]}
I_{+}^{s_{h}}\neq\emptyset
a_{+}\in I_{+}^{s_{h}}
\displaystyle\sum_{a\in B_{0}^{s_{h}}(a_{+})}\gt_{n}(s_{h},a)\to\infty,\quad%
\textrm{ for }\,n\to\infty.
\displaystyle\sum_{a\in B_{0}^{s_{h}}(a_{+})}\gt_{n}(s_{h},a)\to\infty,\quad%
\textrm{ for }\,n\to\infty.
a_{+}\in I_{+}^{s_{h}}
a\in B_{0}^{s_{h}}(a_{+})
B_{0}^{s_{h}}(a_{+})
\displaystyle\pi^{\gt_{n}}(a_{+}|s_{h})\leq\pi^{\gt_{n}}(a|s_{h})
\displaystyle\pi^{\gt_{n}}(a_{+}|s_{h})\leq\pi^{\gt_{n}}(a|s_{h})
n>0
\gt_{n}(s_{h},a_{+})\leq\gt_{n}(s_{h},a)
n>0
\gt_{n}(s_{h},a_{+})
\gt_{n}(s_{h},a)
n\to\infty
\displaystyle\max_{\{a\in B_{0}^{s_{h}}(a_{+})\}}\gt_{n}(s_{h},a)\to\infty,%
\quad\textrm{ for }\,n\to\infty
\displaystyle\max_{\{a\in B_{0}^{s_{h}}(a_{+})\}}\gt_{n}(s_{h},a)\to\infty,%
\quad\textrm{ for }\,n\to\infty
I_{+}^{s_{h}}=\emptyset
s_{h}\in\cS^{[\cH]}
s_{h}\in\cS^{[\cH]}
I_{+}^{s_{h}}\neq\emptyset
a_{+}\in I_{+}^{s_{h}}
\displaystyle\sum_{a\in B_{0}^{s_{h}}(a_{+})}\gt_{n}(s_{h},a)\to\infty,\quad%
\textrm{ for }\,n\to\infty.
\displaystyle\sum_{a\in B_{0}^{s_{h}}(a_{+})}\gt_{n}(s_{h},a)\to\infty,\quad%
\textrm{ for }\,n\to\infty.
a\in I_{-}^{s_{h}}
\displaystyle\frac{\pi^{\gt_{n}}(a|s_{h})}{\pi^{\gt_{n}}(a_{+}|s_{h})}=\exp(%
\underbrace{\gt_{n}(s_{h},a)}_{\to-\infty}-\underbrace{\gt_{n}(s_{h},a_{+})}_{%
\text{bounded from below}})\to 0,\quad n\to\infty.
\displaystyle\frac{\pi^{\gt_{n}}(a|s_{h})}{\pi^{\gt_{n}}(a_{+}|s_{h})}=\exp(%
\underbrace{\gt_{n}(s_{h},a)}_{\to-\infty}-\underbrace{\gt_{n}(s_{h},a_{+})}_{%
\text{bounded from below}})\to 0,\quad n\to\infty.
N_{2}>N_{1}
n>N_{2}
\displaystyle\frac{\pi^{\gt_{n}}(a|s_{h})}{\pi^{\gt_{n}}(a_{+}|s_{h})}<\frac{%
\Delta}{16|\cA|HR^{*}},
\displaystyle\frac{\pi^{\gt_{n}}(a|s_{h})}{\pi^{\gt_{n}}(a_{+}|s_{h})}<\frac{%
\Delta}{16|\cA|HR^{*}},
n>N_{2}
\displaystyle-HR^{*}\sum_{a\in I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})>-\frac{%
\Delta}{16}\pi^{\gt_{n}}(a_{+}|s_{h}).
\displaystyle-HR^{*}\sum_{a\in I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})>-\frac{%
\Delta}{16}\pi^{\gt_{n}}(a_{+}|s_{h}).
I_{-}^{s_{h}}=\emptyset
a\in\bar{B}_{0}^{s_{h}}(a_{+})\subseteq I_{0}^{s_{h}}
I_{0}^{s_{h}}
A_{h}^{\gt_{n}}(s_{h},a)\to A_{h}^{\infty}(s_{h},a)=0
n\to\infty
n\geq N_{a_{+}}
\displaystyle 1<\frac{\pi^{\gt_{n}}(a_{+}|s_{h})}{\pi^{\gt_{n}}(a|s_{h})}.
\displaystyle 1<\frac{\pi^{\gt_{n}}(a_{+}|s_{h})}{\pi^{\gt_{n}}(a|s_{h})}.
N_{3}>\max\{N_{2},N_{a_{+}}\}
n\geq N_{3}
\displaystyle|A_{h}^{\gt_{n}}(s_{h},a)|<\frac{\pi^{\gt_{n}}(a_{+}|s_{h})}{\pi^%
{\gt_{n}}(a|s_{h})}\frac{\Delta}{16|\cA|}.
\displaystyle|A_{h}^{\gt_{n}}(s_{h},a)|<\frac{\pi^{\gt_{n}}(a_{+}|s_{h})}{\pi^%
{\gt_{n}}(a|s_{h})}\frac{\Delta}{16|\cA|}.
\displaystyle\sum_{a\in\bar{B}_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})|A_{h}%
^{\gt_{n}}(s_{h},a)|<\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}
\displaystyle\sum_{a\in\bar{B}_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})|A_{h}%
^{\gt_{n}}(s_{h},a)|<\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}
\displaystyle-\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}<\sum_{a\in\bar{B}_{0%
}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s)A_{h}^{\gt_{n}}(s_{h},a)<\pi^{\gt_{n}}(a_{+%
}|s_{h})\frac{\Delta}{16},
\displaystyle-\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}<\sum_{a\in\bar{B}_{0%
}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s)A_{h}^{\gt_{n}}(s_{h},a)<\pi^{\gt_{n}}(a_{+%
}|s_{h})\frac{\Delta}{16},
n>N_{3}
n>N_{3}
\displaystyle 0=\sum_{a\in\cA}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{n}}(s_{h},a)
\displaystyle 0
\displaystyle=\sum_{a\in\cA}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{n}}(s_{h},a)
\displaystyle=\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt%
_{n}}(s_{h},a)+\sum_{a\in\bar{B}_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h%
}^{\gt_{n}}(s_{h},a)
\displaystyle=\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt%
_{n}}(s_{h},a)+\sum_{a\in\bar{B}_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h%
}^{\gt_{n}}(s_{h},a)
\displaystyle\quad+\sum_{a\in I_{+}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{%
n}}(s_{h},a)+\sum_{a\in I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{n}}(s_%
{h},a)
\displaystyle\quad+\sum_{a\in I_{+}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{%
n}}(s_{h},a)+\sum_{a\in I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt_{n}}(s_%
{h},a)
\displaystyle>\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt%
_{n}}(s_{h},a)-\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}+\pi^{\gt_{n}}(a_{+}%
|s_{h})\frac{\Delta}{4}-HR^{*}\sum_{a\in I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})
\displaystyle>\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt%
_{n}}(s_{h},a)-\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}+\pi^{\gt_{n}}(a_{+}%
|s_{h})\frac{\Delta}{4}-HR^{*}\sum_{a\in I_{-}^{s_{h}}}\pi^{\gt_{n}}(a|s_{h})
\displaystyle\geq\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{%
\gt_{n}}(s_{h},a)-\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}+\pi^{\gt_{n}}(a_%
{+}|s)\frac{\Delta}{4}-\frac{\Delta}{16}\pi^{\gt_{n}}(a_{+}|s_{h})
\displaystyle\geq\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{%
\gt_{n}}(s_{h},a)-\pi^{\gt_{n}}(a_{+}|s_{h})\frac{\Delta}{16}+\pi^{\gt_{n}}(a_%
{+}|s)\frac{\Delta}{4}-\frac{\Delta}{16}\pi^{\gt_{n}}(a_{+}|s_{h})
\displaystyle>\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt%
_{n}}(s_{h},a),
\displaystyle>\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n}}(a|s_{h})A_{h}^{\gt%
_{n}}(s_{h},a),
n>N_{3}
\displaystyle\infty\,\overset{n\to\infty}{\longleftarrow}\sum_{a\in B_{0}^{s_{%
h}}(a_{+})}(\gt_{n}(s,a)-\gt_{N_{3}}(s_{h},a))
\displaystyle\infty\,\overset{n\to\infty}{\longleftarrow}
\displaystyle\sum_{a\in B_{0}^{s_{h}}(a_{+})}(\gt_{n}(s,a)-\gt_{N_{3}}(s_{h},a))
\displaystyle=\eta\sum_{n^{\prime}=N_{3}}^{n}\sum_{a\in B_{0}^{s_{h}}(a_{+})}%
\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a)}
\displaystyle=\eta\sum_{n^{\prime}=N_{3}}^{n}\sum_{a\in B_{0}^{s_{h}}(a_{+})}%
\frac{\partial J(\gt_{n^{\prime}})}{\partial\gt_{n^{\prime}}(s_{h},a)}
\displaystyle=\eta\sum_{n^{\prime}=N_{3}}^{n}\tilde{\rho}_{\mu}^{\pi^{\gt_{n^{%
\prime}}}}(s_{h})\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n^{\prime}}}(a|s_{h%
})A_{h}^{\gt_{n^{\prime}}}(s_{h},a),
\displaystyle=\eta\sum_{n^{\prime}=N_{3}}^{n}\tilde{\rho}_{\mu}^{\pi^{\gt_{n^{%
\prime}}}}(s_{h})\sum_{a\in B_{0}^{s_{h}}(a_{+})}\pi^{\gt_{n^{\prime}}}(a|s_{h%
})A_{h}^{\gt_{n^{\prime}}}(s_{h},a),
\sum_{a\in B_{0}^{s}(a_{+})}\pi^{\gt_{n}}(a|s)A_{h}^{\gt_{n}}(s,a)<0
n>N_{3}
K>0
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\widehat{\nabla}J^{K}(\gt,\mu)]=%
\nabla J(\gt,\mu)
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\widehat{\nabla}J^{K}(\gt,\mu)]=%
\nabla J(\gt,\mu)
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\lVert\widehat{\nabla}J^{K}(\gt,\mu)%
-\nabla J(\gt,\mu)\rVert^{2}]\leq\frac{3H^{4}\max\{R^{\ast},1\}^{4}}{K}=:\frac%
{\xi}{K}
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\lVert\widehat{\nabla}J^{K}(\gt,\mu)%
-\nabla J(\gt,\mu)\rVert^{2}]\leq\frac{3H^{4}\max\{R^{\ast},1\}^{4}}{K}=:\frac%
{\xi}{K}
\widehat{\nabla}J^{K}
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\widehat{\nabla}J^{K}(\gt,\mu)]
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\widehat{\nabla}J^{K}(\gt,\mu)]
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\frac{1}{K}\sum_{i=1}^{K}\sum%
_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h}^{i}|S_{h}^{i}))\hat{R}_{h}^{i}\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\frac{1}{K}\sum_{i=1}^{K}\sum%
_{h=0}^{H-1}\nabla\log(\pi^{\gt}(A_{h}^{i}|S_{h}^{i}))\hat{R}_{h}^{i}\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(%
\pi^{\gt}(A_{h}|S_{h}))\hat{R}_{h}\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(%
\pi^{\gt}(A_{h}|S_{h}))\hat{R}_{h}\Big{]}
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(%
\pi^{\gt}(A_{h}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]},
\displaystyle=\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\nabla\log(%
\pi^{\gt}(A_{h}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]},
i=1,\dots,K
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\widehat{\nabla}J^{K}(\gt,\mu)]=%
\nabla J(\gt,\mu).
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\widehat{\nabla}J^{K}(\gt,\mu)]=%
\nabla J(\gt,\mu).
\displaystyle\lVert\nabla J(\gt,\mu)\rVert=\Big{(}\sum_{s\in\cS^{[\cH]}}\sum_{%
a\in\cA}(Hd_{\mu}^{\pi^{\gt}}(s)\pi^{\gt}(a|s)A^{\pi^{\gt}}(s,a))^{2}\Big{)}^{%
\frac{1}{2}}
\displaystyle\lVert\nabla J(\gt,\mu)\rVert
\displaystyle=\Big{(}\sum_{s\in\cS^{[\cH]}}\sum_{a\in\cA}(Hd_{\mu}^{\pi^{\gt}}%
(s)\pi^{\gt}(a|s)A^{\pi^{\gt}}(s,a))^{2}\Big{)}^{\frac{1}{2}}
\displaystyle\leq H^{2}R^{\ast}\Big{(}\sum_{s\in\cS^{[\cH]}}\sum_{a\in\cA}(d_{%
\mu}^{\pi^{\gt}}(s)\pi^{\gt}(a|s))^{2}\Big{)}^{\frac{1}{2}}
\displaystyle\leq H^{2}R^{\ast}\Big{(}\sum_{s\in\cS^{[\cH]}}\sum_{a\in\cA}(d_{%
\mu}^{\pi^{\gt}}(s)\pi^{\gt}(a|s))^{2}\Big{)}^{\frac{1}{2}}
\displaystyle\leq H^{2}(R^{\ast})^{2},
\displaystyle\leq H^{2}(R^{\ast})^{2},
\pi^{\gt}(\cdot|s)\leq 1
d_{\mu}^{\pi^{\gt}}(s)\leq 1
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\lVert\widehat{\nabla}J^{1}(\gt,\mu)%
\rVert]\leq\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\lVert\nabla\log%
(\pi^{\gt}(A_{h}|S_{h}))\rVert|\hat{R}_{h}|\Big{]}
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\lVert\widehat{\nabla}J^{1}(\gt,\mu)\rVert]
\displaystyle\leq\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\sum_{h=0}^{H-1}\lVert%
\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\rVert|\hat{R}_{h}|\Big{]}
\displaystyle\leq H^{2}R^{\ast}\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\lVert\nabla%
\log(\pi^{\gt}(A_{h}|S_{h}))\rVert\Big{]}
\displaystyle\leq H^{2}R^{\ast}\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\lVert\nabla%
\log(\pi^{\gt}(A_{h}|S_{h}))\rVert\Big{]}
\displaystyle\leq H^{2}R^{\ast},
\displaystyle\leq H^{2}R^{\ast},
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\lVert\widehat{\nabla}J^{K}(\gt,\mu)%
-\nabla J(\gt,\mu)\rVert^{2}]
\displaystyle\mathbb{E}_{\mu}^{\pi^{\gt}}[\lVert\widehat{\nabla}J^{K}(\gt,\mu)%
-\nabla J(\gt,\mu)\rVert^{2}]
\displaystyle\leq\frac{1}{K}\mathbb{E}_{\mu}^{\pi^{\gt}}\Bigl{[}\lVert\widehat%
{\nabla}J^{1}(\gt,\mu)-\nabla J(\gt,\mu)\rVert^{2}\Bigr{]}
\displaystyle\leq\frac{1}{K}\mathbb{E}_{\mu}^{\pi^{\gt}}\Bigl{[}\lVert\widehat%
{\nabla}J^{1}(\gt,\mu)-\nabla J(\gt,\mu)\rVert^{2}\Bigr{]}
\displaystyle\leq\frac{1}{K}\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\lVert\widehat{%
\nabla}J^{1}(\gt)\rVert^{2}+2\lVert\widehat{\nabla}J^{1}(\gt,\mu)\rVert\lVert%
\nabla J(\gt)\rVert+\lVert\nabla J(\gt,\mu)\rVert^{2}\Big{]}
\displaystyle\leq\frac{1}{K}\mathbb{E}_{\mu}^{\pi^{\gt}}\Big{[}\lVert\widehat{%
\nabla}J^{1}(\gt)\rVert^{2}+2\lVert\widehat{\nabla}J^{1}(\gt,\mu)\rVert\lVert%
\nabla J(\gt)\rVert+\lVert\nabla J(\gt,\mu)\rVert^{2}\Big{]}
\displaystyle\leq\frac{1}{K}\Bigl{[}H^{4}(R^{\ast})^{2}+H^{4}(R^{\ast})^{2}+H^%
{4}(R^{\ast})^{4}\Bigr{]}.
\displaystyle\leq\frac{1}{K}\Bigl{[}H^{4}(R^{\ast})^{2}+H^{4}(R^{\ast})^{2}+H^%
{4}(R^{\ast})^{4}\Bigr{]}.
\xi=3H^{4}\max\{R^{\ast},1\}^{4}\geq H^{4}(R^{\ast})^{2}+H^{4}(R^{\ast})^{2}+H%
^{4}(R^{\ast})^{4}
\displaystyle\bar{\gt}^{(n+1)}=\bar{\gt}^{(n)}+\eta\widehat{\nabla}J^{K}(\bar{%
\gt}^{(n)},\mu).
\displaystyle\bar{\gt}^{(n+1)}=\bar{\gt}^{(n)}+\eta\widehat{\nabla}J^{K}(\bar{%
\gt}^{(n)},\mu).
(\gt^{(n)})_{n\geq 0}
\gt^{(0)}=\bar{\gt}^{(0)}
\eta
(\bar{\gt}_{h}^{(n)})_{n\geq 0}
(\cF^{(n)})_{n\geq 0}
c=\inf_{n}\min_{s_{h}\in\cS^{[\cH]}}\pi^{\gt_{n}}(a^{\ast}(s_{h})|s_{h})
0
\displaystyle\tau:=\min\{n\geq 0:\lVert\gt^{(n)}-\bar{\gt}^{(n)}\rVert_{2}\geq%
\frac{c}{4}\}.
\displaystyle\tau:=\min\{n\geq 0:\lVert\gt^{(n)}-\bar{\gt}^{(n)}\rVert_{2}\geq%
\frac{c}{4}\}.
\tau
(\bar{\gt}^{(n)})_{n\geq 0}
(\gt^{(n)})_{n\geq 0}
c
\tau
(\cF^{(n)})_{n\geq 0}
\{n\leq\tau\}
\lVert\gt^{(n)}-\bar{\gt}^{(n)}\rVert_{2}\leq\frac{c_{h}}{4}
\sqrt{2}
\gt\mapsto\pi^{\gt}(a^{\ast}(s)|s)
\min_{0\leq n\leq\tau}\min_{s\in\cS}\pi^{\bar{\gt}^{(n)}}(a^{\ast}(s)|s)\geq%
\frac{c}{2}>0
\pi^{\gt}(a|s)
\sqrt{2}
\gt\in\mathbb{R}^{d}
s,a
\displaystyle\frac{\partial\pi^{\gt}(a|s)}{\partial\gt(s^{\prime},a^{\prime})}%
=\mathbf{1}_{s^{\prime}=s}\Big{[}\frac{\mathbf{1}_{a^{\prime}=a}\exp(\gt(s,a))%
\big{(}\sum_{\tilde{a}\in\cA_{s}}\exp(\gt(s,\tilde{a}))\big{)}-\exp(\gt(s,a))%
\exp(\gt(s,a^{\prime}))}{\big{(}\sum_{\tilde{a}\in\cA_{s}}\exp(\gt(s,\tilde{a}%
))\big{)}^{2}}\Big{]}
\displaystyle\frac{\partial\pi^{\gt}(a|s)}{\partial\gt(s^{\prime},a^{\prime})}
\displaystyle=\mathbf{1}_{s^{\prime}=s}\Big{[}\frac{\mathbf{1}_{a^{\prime}=a}%
\exp(\gt(s,a))\big{(}\sum_{\tilde{a}\in\cA_{s}}\exp(\gt(s,\tilde{a}))\big{)}-%
\exp(\gt(s,a))\exp(\gt(s,a^{\prime}))}{\big{(}\sum_{\tilde{a}\in\cA_{s}}\exp(%
\gt(s,\tilde{a}))\big{)}^{2}}\Big{]}
\displaystyle=\mathbf{1}_{s^{\prime}=s}\Big{[}\mathbf{1}_{a^{\prime}=a}\pi^{%
\gt}(a|s)-\pi^{\gt}(a|s)\pi^{\gt}(a^{\prime}|s)\Big{]}.
\displaystyle=\mathbf{1}_{s^{\prime}=s}\Big{[}\mathbf{1}_{a^{\prime}=a}\pi^{%
\gt}(a|s)-\pi^{\gt}(a|s)\pi^{\gt}(a^{\prime}|s)\Big{]}.
\displaystyle\lVert\nabla\pi^{\gt}(a|s)\rVert_{2}=\sqrt{\sum_{\tilde{a}\in\cA_%
{s}}\Bigl{(}\mathbf{1}_{a^{\prime}=a}\pi^{\gt}(a|s)-\pi^{\gt}(a|s)\pi^{\gt}(a^%
{\prime}|s)\Bigr{)}^{2}}
\displaystyle\lVert\nabla\pi^{\gt}(a|s)\rVert_{2}
\displaystyle=\sqrt{\sum_{\tilde{a}\in\cA_{s}}\Bigl{(}\mathbf{1}_{a^{\prime}=a%
}\pi^{\gt}(a|s)-\pi^{\gt}(a|s)\pi^{\gt}(a^{\prime}|s)\Bigr{)}^{2}}
\displaystyle\leq\sqrt{\pi^{\gt}(a|s)^{2}-2\pi^{\gt}(a|s)^{3}+\sum_{\tilde{a}%
\in\cA_{s}}\pi^{\gt}(a^{\prime}|s)^{2}\pi^{\gt}(a|s)^{2}}
\displaystyle\leq\sqrt{\pi^{\gt}(a|s)^{2}-2\pi^{\gt}(a|s)^{3}+\sum_{\tilde{a}%
\in\cA_{s}}\pi^{\gt}(a^{\prime}|s)^{2}\pi^{\gt}(a|s)^{2}}
\displaystyle\leq\sqrt{2}.
\displaystyle\leq\sqrt{2}.
\mu
\mu(s)>0
s\in\cS
(\bar{\gt}^{(n)})_{n\geq 0}
\min_{0\leq n\leq\tau}\min_{s\in\cS_{h}}\pi^{\bar{\gt}^{(n)}}(a^{\ast}(s)|s)%
\geq\frac{c}{2}
n\leq\tau
\sqrt{2}
\displaystyle\pi^{\bar{\gt}^{(n)}}(a^{\ast}(s)|s)\geq\pi^{\gt^{(n)}}(a^{\ast}(%
s)|s)-|\pi^{\gt^{(n)}}(a^{\ast}(s)|s)-\pi^{\bar{\gt}^{(n)}}(a^{\ast}(s)|s)|
\displaystyle\pi^{\bar{\gt}^{(n)}}(a^{\ast}(s)|s)
\displaystyle\geq\pi^{\gt^{(n)}}(a^{\ast}(s)|s)-|\pi^{\gt^{(n)}}(a^{\ast}(s)|s%
)-\pi^{\bar{\gt}^{(n)}}(a^{\ast}(s)|s)|
\displaystyle\geq\pi^{\gt^{(n)}}(a^{\ast}(s)|s)-\sqrt{2}\lVert\bar{\gt}^{(n)}-%
\gt^{(n)}\rVert_{2}
\displaystyle\geq\pi^{\gt^{(n)}}(a^{\ast}(s)|s)-\sqrt{2}\lVert\bar{\gt}^{(n)}-%
\gt^{(n)}\rVert_{2}
\displaystyle>\frac{c}{2}>0,
\displaystyle>\frac{c}{2}>0,
\{n\leq\tau\}
\mu
\mu(s)>0
s\in\cS
(\bar{\gt}^{(n)})_{n\geq 0}
K^{(n)}\geq\frac{9}{8}\frac{c^{2}\max\{R^{\ast},1\}^{2}(1-\frac{1}{2\sqrt{N}})%
}{N^{3/2}|\cS|H^{19}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_%
{\infty}^{-2}n^{2}
N\geq 1
\eta=\frac{1}{5H^{2}R^{\ast}\sqrt{N}}
\displaystyle\mathbb{E}\big{[}(J^{\ast}(\mu)-J(\bar{\theta}^{(n)},\mu))\mathbf%
{1}_{\{n\leq\tau\}}\big{]}\leq\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}{\sqrt{%
N}}(1-\frac{1}{2\sqrt{N}})n}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{%
\rVert}_{\infty}^{2}.
\displaystyle\mathbb{E}\big{[}(J^{\ast}(\mu)-J(\bar{\theta}^{(n)},\mu))\mathbf%
{1}_{\{n\leq\tau\}}\big{]}\leq\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}{\sqrt{%
N}}(1-\frac{1}{2\sqrt{N}})n}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{%
\rVert}_{\infty}^{2}.
\mu
J
J^{\ast}
\beta
J
\displaystyle J(\bar{\gt}^{(n+1)})\geq J(\bar{\theta}^{(n)})+\big{(}\nabla J(%
\bar{\theta}^{(n)})\big{)}^{T}(\bar{\gt}^{(n+1)}-\bar{\gt}^{(n)})-\frac{\beta}%
{2}\lVert\bar{\gt}^{(n+1)}-\bar{\gt}^{(n)}\rVert^{2}.
\displaystyle J(\bar{\gt}^{(n+1)})
\displaystyle\geq J(\bar{\theta}^{(n)})+\big{(}\nabla J(\bar{\theta}^{(n)})%
\big{)}^{T}(\bar{\gt}^{(n+1)}-\bar{\gt}^{(n)})-\frac{\beta}{2}\lVert\bar{\gt}^%
{(n+1)}-\bar{\gt}^{(n)}\rVert^{2}.
\displaystyle J(\bar{\gt}^{(n+1)})\geq J(\bar{\theta}^{(n)})+\eta\bigl{(}%
\nabla J(\bar{\theta}^{(n)})\bigr{)}^{T}\widehat{\nabla}J^{K}(\bar{\theta}^{(n%
)})-\frac{\beta\eta^{2}}{2}\lVert\widehat{\nabla}J^{K}(\bar{\theta}^{(n)})%
\rVert^{2}
\displaystyle J(\bar{\gt}^{(n+1)})
\displaystyle\geq J(\bar{\theta}^{(n)})+\eta\bigl{(}\nabla J(\bar{\theta}^{(n)%
})\bigr{)}^{T}\widehat{\nabla}J^{K}(\bar{\theta}^{(n)})-\frac{\beta\eta^{2}}{2%
}\lVert\widehat{\nabla}J^{K}(\bar{\theta}^{(n)})\rVert^{2}
\displaystyle=J(\bar{\theta}^{(n)})+\eta\bigl{(}\nabla J(\bar{\theta}^{(n)})%
\bigr{)}^{T}\nabla J(\bar{\theta}^{(n)})+\eta\bigl{(}\nabla J(\bar{\theta}^{(n%
)})\bigr{)}^{T}\bigl{(}\widehat{\nabla}J^{K}(\bar{\theta}^{(n)})-\nabla J(\bar%
{\theta}^{(n)})\bigr{)}
\displaystyle=J(\bar{\theta}^{(n)})+\eta\bigl{(}\nabla J(\bar{\theta}^{(n)})%
\bigr{)}^{T}\nabla J(\bar{\theta}^{(n)})+\eta\bigl{(}\nabla J(\bar{\theta}^{(n%
)})\bigr{)}^{T}\bigl{(}\widehat{\nabla}J^{K}(\bar{\theta}^{(n)})-\nabla J(\bar%
{\theta}^{(n)})\bigr{)}
\displaystyle\quad-\frac{\beta\eta^{2}}{2}\lVert\bigl{(}\widehat{\nabla}J^{K}(%
\bar{\theta}^{(n)})-\nabla J(\bar{\theta}^{(n)})\bigr{)}+\nabla J(\bar{\theta}%
^{(n)})\rVert^{2}.
\displaystyle\quad-\frac{\beta\eta^{2}}{2}\lVert\bigl{(}\widehat{\nabla}J^{K}(%
\bar{\theta}^{(n)})-\nabla J(\bar{\theta}^{(n)})\bigr{)}+\nabla J(\bar{\theta}%
^{(n)})\rVert^{2}.
\displaystyle J(\bar{\gt}^{(n+1)})\geq J(\bar{\theta}^{(n)},)+\big{(}\eta-%
\frac{\beta\eta^{2}}{2}\big{)}\lVert\nabla J(\bar{\theta}^{(n)})\rVert^{2}+%
\big{(}\eta-\beta\eta^{2}\big{)}\langle\nabla J(\bar{\theta}^{(n)}),\phi_{n}%
\rangle-\frac{\beta\eta^{2}}{2}\lVert\phi_{n}\rVert^{2},
\displaystyle J(\bar{\gt}^{(n+1)})
\displaystyle\geq J(\bar{\theta}^{(n)},)+\big{(}\eta-\frac{\beta\eta^{2}}{2}%
\big{)}\lVert\nabla J(\bar{\theta}^{(n)})\rVert^{2}+\big{(}\eta-\beta\eta^{2}%
\big{)}\langle\nabla J(\bar{\theta}^{(n)}),\phi_{n}\rangle-\frac{\beta\eta^{2}%
}{2}\lVert\phi_{n}\rVert^{2},
\phi_{n}:=\widehat{\nabla}J^{K}(\bar{\theta}^{(n)})-\nabla J(\bar{\theta}^{(n)})
\cF_{n}
\displaystyle E\Bigl{[}J(\bar{\gt}^{(n+1)})|\cF_{n}\Bigr{]}\geq J(\bar{\theta}%
^{(n)})+\Big{(}\eta-\frac{\beta\eta^{2}}{2}\Big{)}\lVert\nabla J(\bar{\theta}^%
{(n)})\rVert^{2}-\frac{\beta\eta^{2}\xi}{2K_{n}}.
\displaystyle E\Bigl{[}J(\bar{\gt}^{(n+1)})|\cF_{n}\Bigr{]}\geq J(\bar{\theta}%
^{(n)})+\Big{(}\eta-\frac{\beta\eta^{2}}{2}\Big{)}\lVert\nabla J(\bar{\theta}^%
{(n)})\rVert^{2}-\frac{\beta\eta^{2}\xi}{2K_{n}}.
J^{\ast}
\{n+1\leq\tau\}
\displaystyle\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\gt}^{(n+1)}))\mathbf{1}_{\{n+1%
\leq\tau\}}\Big{]}
\displaystyle\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\gt}^{(n+1)}))\mathbf{1}_{\{n+1%
\leq\tau\}}\Big{]}
\displaystyle=\mathbb{E}\Big{[}\mathbb{E}\Bigl{[}(J^{\ast}-J(\bar{\gt}^{(n+1)}%
))|\cF_{n}\Bigr{]}\mathbf{1}_{\{n+1\leq\tau\}}\Big{]}
\displaystyle=\mathbb{E}\Big{[}\mathbb{E}\Bigl{[}(J^{\ast}-J(\bar{\gt}^{(n+1)}%
))|\cF_{n}\Bigr{]}\mathbf{1}_{\{n+1\leq\tau\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}\Big{(}J^{\ast}-\mathbb{E}\Bigl{[}J(\bar{\gt%
}^{(n+1)})|\cF_{n}\Bigr{]}\Big{)}\mathbf{1}_{\{n\leq\tau\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}\Big{(}J^{\ast}-\mathbb{E}\Bigl{[}J(\bar{\gt%
}^{(n+1)})|\cF_{n}\Bigr{]}\Big{)}\mathbf{1}_{\{n\leq\tau\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\Big{(}\eta-\frac{\beta\eta^{2}}{2}\Big{)}\mathbb{E}\Big%
{[}\lVert\nabla J(\bar{\theta}^{(n)})\rVert^{2}\mathbf{1}_{\{n\leq\tau\}}\Big{%
]}+\frac{\beta\eta^{2}\xi}{2K_{n}}
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\Big{(}\eta-\frac{\beta\eta^{2}}{2}\Big{)}\mathbb{E}\Big%
{[}\lVert\nabla J(\bar{\theta}^{(n)})\rVert^{2}\mathbf{1}_{\{n\leq\tau\}}\Big{%
]}+\frac{\beta\eta^{2}\xi}{2K_{n}}
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\eta(1-\frac{1}{2\sqrt{N}})\mathbb{E}\Big{[}\lVert\nabla
J%
(\bar{\theta}^{(n)})\rVert^{2}\mathbf{1}_{\{n\leq\tau\}}\Big{]}+\frac{\beta%
\eta^{2}\xi}{2K_{n}},
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\eta(1-\frac{1}{2\sqrt{N}})\mathbb{E}\Big{[}\lVert\nabla
J%
(\bar{\theta}^{(n)})\rVert^{2}\mathbf{1}_{\{n\leq\tau\}}\Big{]}+\frac{\beta%
\eta^{2}\xi}{2K_{n}},
\{n+1\leq\tau_{h}\}=\{\tau_{h}\leq n\}^{C}
\cF_{n}
\mathbf{1}_{\{n+1\leq\tau_{h}\}}\leq\mathbf{1}_{\{n\leq\tau_{h}\}}
\min_{0\leq n\leq\tau}\min_{s\in\cS}\pi^{\bar{\theta}^{(n)}}(a^{\ast}(s)|s)%
\geq\frac{c}{2}
\displaystyle\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\gt}^{(n+1)}))\mathbf{1}_{\{n+1%
\leq\tau\}}\Big{]}
\displaystyle\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\gt}^{(n+1)}))\mathbf{1}_{\{n+1%
\leq\tau\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}\Big{\rVert}_{\infty%
}^{-2}\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{\{n\leq\tau%
\}}\Big{]}^{2}+\frac{\beta\eta^{2}\xi}{2K_{n}}
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{d_{\mu}^{\pi^{\theta}}}\Big{\rVert}_{\infty%
}^{-2}\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{\{n\leq\tau%
\}}\Big{]}^{2}+\frac{\beta\eta^{2}\xi}{2K_{n}}
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H^{3}}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-2}\mathbb{E}%
\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{\{n\leq\tau\}}\Big{]}^{2}+%
\frac{\beta\eta^{2}\xi}{2K_{n}},
\displaystyle\leq\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{%
\{n\leq\tau\}}\Big{]}-\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H^{3}}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-2}\mathbb{E}%
\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{\{n\leq\tau\}}\Big{]}^{2}+%
\frac{\beta\eta^{2}\xi}{2K_{n}},
d_{\mu}^{\pi^{\theta}}(s)\geq\frac{1}{H}\mu(s)
d_{n}:=\mathbb{E}\Big{[}(J^{\ast}-J(\bar{\theta}^{(n)}))\mathbf{1}_{\{n\leq%
\tau\}}\Big{]}
\displaystyle d_{n+1}\leq d_{n}-\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H%
^{3}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-2}d_{%
n}^{2}+\frac{\beta\eta^{2}\xi}{2K_{n}}.
\displaystyle d_{n+1}\leq d_{n}-\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H%
^{3}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-2}d_{%
n}^{2}+\frac{\beta\eta^{2}\xi}{2K_{n}}.
w:=\eta(1-\frac{1}{2\sqrt{N}})\frac{c^{2}}{|\cS|H^{3}}\Big{\lVert}\frac{d_{\mu%
}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-2}
B=\frac{\beta\eta^{2}\xi}{2}>0
\displaystyle d_{n+1}\leq d_{n}(1-wd_{n})+\frac{B}{K_{n}}.
\displaystyle d_{n+1}\leq d_{n}(1-wd_{n})+\frac{B}{K_{n}}.
w>0
\mu(s)>0
s\in\cS
K_{n}
\displaystyle\frac{9}{4}wBn^{2}=\frac{9}{8}\frac{c^{2}\eta^{3}\beta(1-\frac{1}%
{2\sqrt{N}})\xi}{|\cS|H^{3}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{%
\rVert}_{\infty}^{-2}n^{2}
\displaystyle\frac{9}{4}wBn^{2}=\frac{9}{8}\frac{c^{2}\eta^{3}\beta(1-\frac{1}%
{2\sqrt{N}})\xi}{|\cS|H^{3}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{%
\rVert}_{\infty}^{-2}n^{2}
\displaystyle\leq\frac{9}{8}\frac{c^{2}\eta^{2}(1-\frac{1}{2\sqrt{N}})\xi}{%
\sqrt{N}|\cS|H^{3}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{%
\infty}^{-2}n^{2}\leq\frac{9}{8}\frac{c^{2}\max\{R^{\ast},1\}^{2}(1-\frac{1}{2%
\sqrt{N}})}{N^{3/2}|\cS|H^{19}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}%
\Big{\rVert}_{\infty}^{-2}n^{2}\leq K_{n}.
\displaystyle\leq\frac{9}{8}\frac{c^{2}\eta^{2}(1-\frac{1}{2\sqrt{N}})\xi}{%
\sqrt{N}|\cS|H^{3}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{%
\infty}^{-2}n^{2}\leq\frac{9}{8}\frac{c^{2}\max\{R^{\ast},1\}^{2}(1-\frac{1}{2%
\sqrt{N}})}{N^{3/2}|\cS|H^{19}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}%
\Big{\rVert}_{\infty}^{-2}n^{2}\leq K_{n}.
\eta=\frac{1}{5H^{2}R^{\ast}\sqrt{N}}
\displaystyle\frac{4}{3w}=\frac{4|\cS|H^{3}}{3\eta(1-\frac{1}{2\sqrt{N}})c^{2}%
}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}=\frac{2%
0|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}{\sqrt{N}}(1-\frac{1}{2\sqrt{N}})}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}.
\displaystyle\frac{4}{3w}=\frac{4|\cS|H^{3}}{3\eta(1-\frac{1}{2\sqrt{N}})c^{2}%
}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}=\frac{2%
0|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}{\sqrt{N}}(1-\frac{1}{2\sqrt{N}})}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}.
\displaystyle d_{1}\leq HR^{\ast}\leq\frac{4}{3w}\leq\frac{4}{3w\cdot 1},
\displaystyle d_{1}\leq HR^{\ast}\leq\frac{4}{3w}\leq\frac{4}{3w\cdot 1},
c\leq 1
\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}\geq 1
\frac{1}{\sqrt{N}}(1-\frac{1}{2\sqrt{N}})<1
N\geq 1
d_{n}\leq\frac{4}{3wn}
\displaystyle d_{n+1}\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{n}}.
\displaystyle d_{n+1}\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{n}}.
f(x)=x-wx^{2}
[0,\frac{1}{2w}]
d_{n}\leq\frac{1}{4wn}\leq\frac{1}{2w}
\displaystyle d_{n+1}\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{n}}
\displaystyle d_{n+1}
\displaystyle\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{n}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{B}{K_{n}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{B}{K_{n}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{4B}{9wBn^{2}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{4B}{9wBn^{2}}
\displaystyle=\frac{4}{3wn}-\frac{12}{9wn^{2}}
\displaystyle=\frac{4}{3wn}-\frac{12}{9wn^{2}}
\displaystyle=\frac{4}{3w}\Big{(}\frac{1}{n}-\frac{1}{n^{2}}\Big{)}
\displaystyle=\frac{4}{3w}\Big{(}\frac{1}{n}-\frac{1}{n^{2}}\Big{)}
\displaystyle\leq\frac{4}{3wn},
\displaystyle\leq\frac{4}{3wn},
K_{n}\geq\frac{9}{4}wBn^{2}
\displaystyle d_{n}\leq\frac{4}{3wn}=\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}%
{\sqrt{N}}(1-\frac{1}{2\sqrt{N}})n}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu%
}\Big{\rVert}_{\infty}^{2}.
\displaystyle d_{n}\leq\frac{4}{3wn}=\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}%
{\sqrt{N}}(1-\frac{1}{2\sqrt{N}})n}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu%
}\Big{\rVert}_{\infty}^{2}.
\{\tau\leq n\}
\delta
K
\mu
\mu(s)>0
s\in\cS
(\bar{\gt}^{(n)})_{n\geq 0}
\delta>0
K\geq\frac{10\max\{R^{\ast},1\}^{2}n^{3}}{c^{2}\delta^{2}}
\eta=\frac{1}{\sqrt{n}5H^{2}R^{\ast}}
\bbP(\tau\leq n)<\delta
\tau
\displaystyle\bbP(\tau\leq n)=\bbP(\max_{0\leq t\leq n}\lVert\gt^{(t)}-\bar{%
\gt}^{(t)}\rVert\geq\frac{c_{h}}{4}),
\displaystyle\bbP(\tau\leq n)=\bbP(\max_{0\leq t\leq n}\lVert\gt^{(t)}-\bar{%
\gt}^{(t)}\rVert\geq\frac{c_{h}}{4}),
\lVert\gt^{(t)}-\bar{\gt}^{(t)}\rVert
\displaystyle\lVert\bar{\gt}^{(t)}-{\gt}^{(t)}\rVert=\lVert\bar{\gt}^{(0)}+%
\sum_{k=1}^{t-1}\eta\widehat{\nabla}J^{K}(\bar{\gt}^{(k)},\mu)-(\gt^{(0)}+\sum%
_{k=1}^{t-1}\eta\nabla J({\gt}^{(k)},\mu))\rVert
\displaystyle\lVert\bar{\gt}^{(t)}-{\gt}^{(t)}\rVert
\displaystyle=\lVert\bar{\gt}^{(0)}+\sum_{k=1}^{t-1}\eta\widehat{\nabla}J^{K}(%
\bar{\gt}^{(k)},\mu)-(\gt^{(0)}+\sum_{k=1}^{t-1}\eta\nabla J({\gt}^{(k)},\mu))\rVert
\displaystyle\leq\sum_{k=1}^{t-1}\eta\lVert\widehat{\nabla}J^{K}(\bar{\gt}^{(k%
)},\mu)-\nabla J(\gt^{(k)},\mu)\rVert
\displaystyle\leq\sum_{k=1}^{t-1}\eta\lVert\widehat{\nabla}J^{K}(\bar{\gt}^{(k%
)},\mu)-\nabla J(\gt^{(k)},\mu)\rVert
\displaystyle\leq\eta\sum_{k=1}^{t-1}(\lVert\widehat{\nabla}J^{K}(\bar{\gt}^{(%
k)},\mu)-\nabla J(\bar{\gt}^{(k)},\mu)\rVert+\lVert\nabla J(\bar{\gt}^{(k)},%
\mu)-\nabla J(\gt^{(k)},\mu)\rVert).
\displaystyle\leq\eta\sum_{k=1}^{t-1}(\lVert\widehat{\nabla}J^{K}(\bar{\gt}^{(%
k)},\mu)-\nabla J(\bar{\gt}^{(k)},\mu)\rVert+\lVert\nabla J(\bar{\gt}^{(k)},%
\mu)-\nabla J(\gt^{(k)},\mu)\rVert).
\phi_{k}^{K}=\widehat{\nabla}J^{K}(\bar{\gt}^{(k)},\mu)-\nabla J(\bar{\gt}^{(k%
)},\mu)
\beta
\nabla J(\gt)
\displaystyle\lVert\gt^{(t)}-\bar{\gt}^{(t)}\rVert\leq\eta\sum_{k=1}^{t-1}(%
\lVert\phi_{k}^{K}\rVert+\beta\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert)
\displaystyle\lVert\gt^{(t)}-\bar{\gt}^{(t)}\rVert
\displaystyle\leq\eta\sum_{k=1}^{t-1}(\lVert\phi_{k}^{K}\rVert+\beta\lVert\gt^%
{(k)}-\bar{\gt}^{(k)}\rVert)
\displaystyle=\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k=1}%
^{t-1}\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert.
\displaystyle=\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k=1}%
^{t-1}\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert.
\displaystyle\lVert\gt^{(t)}-\bar{\gt}^{(t)}\rVert\leq\eta\sum_{k=1}^{t-1}%
\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k=1}^{t-1}\lVert\gt^{(k)}-\bar{\gt}^{(%
k)}\rVert
\displaystyle\lVert\gt^{(t)}-\bar{\gt}^{(t)}\rVert
\displaystyle\leq\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k%
=1}^{t-1}\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert
\displaystyle\leq\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k%
=1}^{t-2}\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert+\eta\beta\Bigl{(}\eta\sum_{k=1}%
^{t-2}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k=1}^{t-2}\lVert\gt^{(k)}-\bar{%
\gt}^{(k)}\rVert\Bigr{)}
\displaystyle\leq\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k%
=1}^{t-2}\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert+\eta\beta\Bigl{(}\eta\sum_{k=1}%
^{t-2}\lVert\phi_{k}^{K}\rVert+\eta\beta\sum_{k=1}^{t-2}\lVert\gt^{(k)}-\bar{%
\gt}^{(k)}\rVert\Bigr{)}
\displaystyle=\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta^{2}\beta\sum_{%
k=1}^{t-2}\lVert\phi_{k}^{K}\rVert+(1+\eta\beta)\eta\beta\sum_{k=1}^{t-2}%
\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert
\displaystyle=\eta\sum_{k=1}^{t-1}\lVert\phi_{k}^{K}\rVert+\eta^{2}\beta\sum_{%
k=1}^{t-2}\lVert\phi_{k}^{K}\rVert+(1+\eta\beta)\eta\beta\sum_{k=1}^{t-2}%
\lVert\gt^{(k)}-\bar{\gt}^{(k)}\rVert
\displaystyle=\eta\lVert\phi_{t-1}^{K}\rVert+\eta(1+\eta\beta)\sum_{k=1}^{t-2}%
\lVert\phi_{k}^{K}\rVert+(1+\eta\beta)\eta\beta\sum_{k=1}^{t-2}\lVert\gt^{(k)}%
-\bar{\gt}^{(k)}\rVert
\displaystyle=\eta\lVert\phi_{t-1}^{K}\rVert+\eta(1+\eta\beta)\sum_{k=1}^{t-2}%
\lVert\phi_{k}^{K}\rVert+(1+\eta\beta)\eta\beta\sum_{k=1}^{t-2}\lVert\gt^{(k)}%
-\bar{\gt}^{(k)}\rVert
\displaystyle\leq\sum_{k=1}^{t-1}\eta(1+\eta\beta)^{t-k-1}\lVert\phi_{k}^{K}\rVert.
\displaystyle\leq\sum_{k=1}^{t-1}\eta(1+\eta\beta)^{t-k-1}\lVert\phi_{k}^{K}\rVert.
\displaystyle\bbP(\tau\leq n)=\bbP(\max_{0\leq t\leq n}\lVert\gt^{(t)}-\bar{%
\gt}^{(t)}\rVert\geq\frac{c}{4})
\displaystyle\bbP(\tau\leq n)
\displaystyle=\bbP(\max_{0\leq t\leq n}\lVert\gt^{(t)}-\bar{\gt}^{(t)}\rVert%
\geq\frac{c}{4})
\displaystyle\leq\bbP(\sum_{k=1}^{n-1}\eta(1+\eta\beta)^{n-k-1}\lVert\phi_{k}^%
{K}\rVert\geq\frac{c_{h}}{4})
\displaystyle\leq\bbP(\sum_{k=1}^{n-1}\eta(1+\eta\beta)^{n-k-1}\lVert\phi_{k}^%
{K}\rVert\geq\frac{c_{h}}{4})
\displaystyle\leq\frac{4\sum_{k=1}^{n-1}\eta(1+\eta\beta)^{n-k-1}\mathbb{E}[%
\lVert\phi_{k}^{K}\rVert]}{c}
\displaystyle\leq\frac{4\sum_{k=1}^{n-1}\eta(1+\eta\beta)^{n-k-1}\mathbb{E}[%
\lVert\phi_{k}^{K}\rVert]}{c}
\displaystyle\leq\frac{4n\eta(1+\eta\beta)^{n-1}\sqrt{\frac{\xi}{K}}}{c},
\displaystyle\leq\frac{4n\eta(1+\eta\beta)^{n-1}\sqrt{\frac{\xi}{K}}}{c},
\mathbb{E}[\lVert\phi_{k}^{K}\rVert]\leq\sqrt{\mathbb{E}[\lVert\phi_{k}^{K}%
\rVert^{2}]}\leq\sqrt{\frac{\xi}{K}}
\eta=\frac{1}{\sqrt{n}5H^{2}R^{\ast}}<\frac{1}{\sqrt{n}\beta}
\displaystyle\bbP(\tau\leq n)\leq\frac{4n\frac{1}{\sqrt{n}5H^{2}R^{\ast}}(1+%
\frac{1}{\sqrt{n}\beta}\beta)^{n-1}\sqrt{\frac{\xi}{K}}}{c}
\displaystyle\bbP(\tau\leq n)
\displaystyle\leq\frac{4n\frac{1}{\sqrt{n}5H^{2}R^{\ast}}(1+\frac{1}{\sqrt{n}%
\beta}\beta)^{n-1}\sqrt{\frac{\xi}{K}}}{c}
\displaystyle=\frac{4\sqrt{n}(1+\frac{1}{\sqrt{n}})^{n-1}\sqrt{C_{h}}}{5H^{2}R%
^{\ast}c\sqrt{K}}\leq\frac{4\sqrt{n}n\sqrt{\xi}}{5H^{2}R^{\ast}c\sqrt{K}},
\displaystyle=\frac{4\sqrt{n}(1+\frac{1}{\sqrt{n}})^{n-1}\sqrt{C_{h}}}{5H^{2}R%
^{\ast}c\sqrt{K}}\leq\frac{4\sqrt{n}n\sqrt{\xi}}{5H^{2}R^{\ast}c\sqrt{K}},
f(x)=(1+\frac{1}{\sqrt{x}})^{x-1}\leq x
x\geq 1
\bbP(\tau<n)<\delta
\displaystyle\frac{16n^{3}\xi}{25H^{4}(R^{\ast})^{2}c^{2}\delta^{2}}=\frac{16n%
^{3}H^{4}\max\{R^{\ast},1\}^{4}3}{25H^{4}(R^{\ast})^{2}c^{2}\delta^{2}}\leq%
\frac{48\max\{R^{\ast},1\}^{2}n^{3}}{5c^{2}\delta^{2}}\leq\frac{10\max\{R^{%
\ast},1\}^{2}n^{3}}{c^{2}\delta^{2}}=K.
\displaystyle\frac{16n^{3}\xi}{25H^{4}(R^{\ast})^{2}c^{2}\delta^{2}}=\frac{16n%
^{3}H^{4}\max\{R^{\ast},1\}^{4}3}{25H^{4}(R^{\ast})^{2}c^{2}\delta^{2}}\leq%
\frac{48\max\{R^{\ast},1\}^{2}n^{3}}{5c^{2}\delta^{2}}\leq\frac{10\max\{R^{%
\ast},1\}^{2}n^{3}}{c^{2}\delta^{2}}=K.
J^{\ast}(\mu)=V_{0}^{\ast}(\mu)
J(\bar{\gt}^{(N)},\mu)=V_{0}^{\pi^{\bar{\gt}^{(N)}}}(\mu)
\tau
\displaystyle\bbP\Big{(}(J^{\ast}(\mu)-J(\bar{\gt}^{(N)},\mu))\geq\epsilon\Big%
{)}\leq\bbP\Big{(}\{\tau\geq N\}\cap\{(J^{\ast}(\mu)-J(\bar{\gt}^{(N)},\mu))%
\geq\epsilon\}\Big{)}
\displaystyle\bbP\Big{(}(J^{\ast}(\mu)-J(\bar{\gt}^{(N)},\mu))\geq\epsilon\Big%
{)}
\displaystyle\leq\bbP\Big{(}\{\tau\geq N\}\cap\{(J^{\ast}(\mu)-J(\bar{\gt}^{(N%
)},\mu))\geq\epsilon\}\Big{)}
\displaystyle\quad+\bbP\Big{(}\{\tau\leq N\}\cap\{(J^{\ast}(\mu)-J(\bar{\gt}^{%
(N)},\mu))\geq\epsilon\}\Big{)}
\displaystyle\quad+\bbP\Big{(}\{\tau\leq N\}\cap\{(J^{\ast}(\mu)-J(\bar{\gt}^{%
(N)},\mu))\geq\epsilon\}\Big{)}
\displaystyle\leq\frac{\mathbb{E}\Big{[}(J^{\ast}(\mu)-J(\bar{\gt}^{(N)},\mu))%
\mathbf{1}_{\{\tau\geq N\}}\Big{]}}{\epsilon}+\bbP(\tau\leq N)
\displaystyle\leq\frac{\mathbb{E}\Big{[}(J^{\ast}(\mu)-J(\bar{\gt}^{(N)},\mu))%
\mathbf{1}_{\{\tau\geq N\}}\Big{]}}{\epsilon}+\bbP(\tau\leq N)
\displaystyle\leq\frac{1}{\epsilon}\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}{%
\sqrt{N}}(1-\frac{1}{2\sqrt{N}})N}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}%
\Big{\rVert}_{\infty}^{2}+\frac{\delta}{2}
\displaystyle\leq\frac{1}{\epsilon}\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\frac{1}{%
\sqrt{N}}(1-\frac{1}{2\sqrt{N}})N}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}%
\Big{\rVert}_{\infty}^{2}+\frac{\delta}{2}
\displaystyle\leq\frac{\delta}{2}+\frac{\delta}{2}
\displaystyle\leq\frac{\delta}{2}+\frac{\delta}{2}
\displaystyle=\delta,
\displaystyle=\delta,
N
\displaystyle\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\sqrt{N}(1-\frac{1}{2\sqrt{N}})}%
\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}\leq\frac%
{\delta}{2}
\displaystyle\frac{20|\cS|H^{5}R^{\ast}}{c^{2}\sqrt{N}(1-\frac{1}{2\sqrt{N}})}%
\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}
\displaystyle\leq\frac{\delta}{2}
N\geq\big{(}\frac{20|\cS|H^{5}R^{\ast}}{\epsilon\delta c^{2}}\Big{\lVert}\frac%
{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{2}+\frac{1}{2}\big{)}^{2}
N\geq\big{(}\frac{21|\cS|H^{5}R^{\ast}}{\epsilon\delta c^{2}}\big{)}^{2}\Big{%
\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{4}
\eta
\displaystyle\max\Big{\{}\frac{9}{8}\frac{c^{2}\max\{R^{\ast},1\}^{2}(1-\frac{%
1}{2\sqrt{N}})}{N^{3/2}|\cS|H^{19}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu%
}\Big{\rVert}_{\infty}^{-2}n^{2},\frac{10\max\{R^{\ast},1\}^{2}N^{3}}{c^{2}%
\delta^{2}}\Big{\}}=\frac{10\max\{R^{\ast},1\}^{2}N^{3}}{c^{2}\delta^{2}},
\displaystyle\max\Big{\{}\frac{9}{8}\frac{c^{2}\max\{R^{\ast},1\}^{2}(1-\frac{%
1}{2\sqrt{N}})}{N^{3/2}|\cS|H^{19}}\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu%
}\Big{\rVert}_{\infty}^{-2}n^{2},\frac{10\max\{R^{\ast},1\}^{2}N^{3}}{c^{2}%
\delta^{2}}\Big{\}}=\frac{10\max\{R^{\ast},1\}^{2}N^{3}}{c^{2}\delta^{2}},
n\leq N
c<1
\Big{\lVert}\frac{d_{\mu}^{\pi^{\ast}}}{\mu}\Big{\rVert}_{\infty}^{-2}<1
h\in\cH
K_{h}>0
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\widehat%
{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})]=\nabla J_{h}(\gt,%
\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\widehat%
{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})]=\nabla J_{h}(\gt,%
\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\lVert%
\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_{h}(%
\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}]\leq\frac{5(H-h)^{2}(R^{\ast})^{2}}%
{K_{h}}=:\frac{\psi_{h}}{K}.
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\lVert%
\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_{h}(%
\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}]\leq\frac{5(H-h)^{2}(R^{\ast})^{2}}%
{K_{h}}=:\frac{\psi_{h}}{K}.
\widehat{\nabla}J_{h}^{K}
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\widehat%
{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})]
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\widehat%
{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})]
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\frac{1}{K_{h}}\sum_{i=1}^{K_{h}}\nabla\log(\pi^{\gt}(A_{t}^{i}|S_{t}^{i}))%
\hat{R}_{h}^{i}\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\frac{1}{K_{h}}\sum_{i=1}^{K_{h}}\nabla\log(\pi^{\gt}(A_{t}^{i}|S_{t}^{i}))%
\hat{R}_{h}^{i}\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\nabla\log(\pi^{\gt}(A_{h}^{1}|S_{h}^{1}))\hat{R}_{h}^{1}\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\nabla\log(\pi^{\gt}(A_{h}^{1}|S_{h}^{1}))\hat{R}_{h}^{1}\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]},
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]},
i=1,\dots,K_{h}
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\widehat%
{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu)]
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}[\widehat%
{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu)]
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\nabla\log(\pi^{\gt}(A_{1}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\nabla\log(\pi^{\gt}(A_{1}|S_{h}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{]}
\displaystyle=\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h}).
\displaystyle=\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h}).
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Bigl{[}%
\lVert\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_%
{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}\Bigr{]}
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Bigl{[}%
\lVert\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_%
{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}\Bigr{]}
\displaystyle\leq\frac{1}{K_{h}}\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})%
_{(h+1)})}\Bigl{[}\lVert\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\hat{Q}_{h}(S_{h},A_%
{h})-\nabla J_{h}(\gt)\rVert^{2}\Bigr{]}
\displaystyle\leq\frac{1}{K_{h}}\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})%
_{(h+1)})}\Bigl{[}\lVert\nabla\log(\pi^{\gt}(A_{h}|S_{h}))\hat{Q}_{h}(S_{h},A_%
{h})-\nabla J_{h}(\gt)\rVert^{2}\Bigr{]}
\displaystyle=\frac{1}{K_{h}}\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(%
h+1)})}\Big{[}\sum_{s\in\cS_{h}}\sum_{a\in\cA_{s}}\Big{(}\mathbf{1}_{s=S_{h}}(%
\mathbf{1}_{a=A_{h}}-\pi^{\theta}(a|s))\sum_{k=h}^{H-1}r(S_{k},A_{k})
\displaystyle=\frac{1}{K_{h}}\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(%
h+1)})}\Big{[}\sum_{s\in\cS_{h}}\sum_{a\in\cA_{s}}\Big{(}\mathbf{1}_{s=S_{h}}(%
\mathbf{1}_{a=A_{h}}-\pi^{\theta}(a|s))\sum_{k=h}^{H-1}r(S_{k},A_{k})
\displaystyle\quad-\mu_{h}(s)\pi^{\theta}(a|s)A_{h}^{(\pi^{\gt},(\tilde{\pi})_%
{(h+1)})}(s,a)\Big{)}^{2}\Big{]},
\displaystyle\quad-\mu_{h}(s)\pi^{\theta}(a|s)A_{h}^{(\pi^{\gt},(\tilde{\pi})_%
{(h+1)})}(s,a)\Big{)}^{2}\Big{]},
\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})
\nabla J_{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Bigl{[}%
\lVert\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_%
{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}\Bigr{]}
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Bigl{[}%
\lVert\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_%
{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}\Bigr{]}
\displaystyle\leq\frac{1}{K_{h}}\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})%
_{(h+1)})}\Big{[}\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\gt}(a|S_{h}))^{%
2}\Big{(}\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}
\displaystyle\leq\frac{1}{K_{h}}\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})%
_{(h+1)})}\Big{[}\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\gt}(a|S_{h}))^{%
2}\Big{(}\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}
\displaystyle\quad-2\,\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\gt}(a|S_{h%
}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\mu_{h}(s)\pi^{\gt}(a|S_{h})A_{h}^{(\pi^{\gt}%
,(\tilde{\pi})_{(h+1)})}(S_{h},a)
\displaystyle\quad-2\,\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\gt}(a|S_{h%
}))\sum_{k=h}^{H-1}r(S_{k},A_{k})\mu_{h}(s)\pi^{\gt}(a|S_{h})A_{h}^{(\pi^{\gt}%
,(\tilde{\pi})_{(h+1)})}(S_{h},a)
\displaystyle\quad+\sum_{s\in\cS_{h}}\sum_{a\in\cA_{s}}\mu_{h}(s)^{2}\pi^{\gt}%
(a|s)^{2}A_{h}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}(s,a)^{2}\Big{]}.
\displaystyle\quad+\sum_{s\in\cS_{h}}\sum_{a\in\cA_{s}}\mu_{h}(s)^{2}\pi^{\gt}%
(a|s)^{2}A_{h}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}(s,a)^{2}\Big{]}.
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\theta}(a|S_{h}))^{2}\Big{(}\sum_%
{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}\Big{]}
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\theta}(a|S_{h}))^{2}\Big{(}\sum_%
{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\ \Big{(}\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}\Big{]}-2\mathbb{E}_{\mu_{h}%
}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}\pi^{\theta}(A_{h}|S_{h})\Big{(}%
\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}\Big{]}
\displaystyle=\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\ \Big{(}\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}\Big{]}-2\mathbb{E}_{\mu_{h}%
}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}\pi^{\theta}(A_{h}|S_{h})\Big{(}%
\sum_{k=h}^{H-1}r(S_{k},A_{k})\Big{)}^{2}\Big{]}
\displaystyle\quad+\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}%
\Big{[}\sum_{a\in\cA_{s}}\pi^{\theta}(a|S_{h})^{2}\Big{(}\sum_{k=h}^{H-1}r(S_{%
k},A_{k})\Big{)}^{2}\Big{]}
\displaystyle\quad+\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}%
\Big{[}\sum_{a\in\cA_{s}}\pi^{\theta}(a|S_{h})^{2}\Big{(}\sum_{k=h}^{H-1}r(S_{%
k},A_{k})\Big{)}^{2}\Big{]}
\displaystyle\leq((H-h)R^{\ast})^{2}-0+((H-h)R^{\ast})^{2}
\displaystyle\leq((H-h)R^{\ast})^{2}-0+((H-h)R^{\ast})^{2}
\displaystyle=2((H-h)R^{\ast})^{2},
\displaystyle=2((H-h)R^{\ast})^{2},
\pi^{\gt}
A_{h}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}(S_{h},a)
\displaystyle 2\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\theta}(a|S_{h}))\sum_{k=h}^{H-1}%
r(S_{k},A_{k})\mu_{h}(s)\pi^{\theta}(a|S_{h})\big{|}A_{h}^{(\pi^{\gt},(\tilde{%
\pi})_{(h+1)})}(S_{h},a)\big{|}\Big{]}
\displaystyle 2\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\sum_{a\in\cA_{s}}(\mathbf{1}_{a=A_{h}}-\pi^{\theta}(a|S_{h}))\sum_{k=h}^{H-1}%
r(S_{k},A_{k})\mu_{h}(s)\pi^{\theta}(a|S_{h})\big{|}A_{h}^{(\pi^{\gt},(\tilde{%
\pi})_{(h+1)})}(S_{h},a)\big{|}\Big{]}
\displaystyle\leq 2\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}%
\Big{[}\sum_{a\in\cA_{s}}1\cdot(H-h)R^{\ast}\cdot 1\cdot\pi^{\theta}(a|S_{h})%
\cdot(H-h)R^{\ast}\Big{]}
\displaystyle\leq 2\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}%
\Big{[}\sum_{a\in\cA_{s}}1\cdot(H-h)R^{\ast}\cdot 1\cdot\pi^{\theta}(a|S_{h})%
\cdot(H-h)R^{\ast}\Big{]}
\displaystyle=2((H-h)R^{\ast})^{2}.
\displaystyle=2((H-h)R^{\ast})^{2}.
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\sum_{s\in\cS_{h}}\sum_{a\in\cA_{s}}\mu_{h}(s)^{2}\pi^{\theta}(a|s)^{2}A_{h}^{%
(\pi^{\gt},(\tilde{\pi})_{(h+1)})}(s,a)^{2}\Big{]}\leq((H-h)R^{\ast})^{2}.
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Big{[}%
\sum_{s\in\cS_{h}}\sum_{a\in\cA_{s}}\mu_{h}(s)^{2}\pi^{\theta}(a|s)^{2}A_{h}^{%
(\pi^{\gt},(\tilde{\pi})_{(h+1)})}(s,a)^{2}\Big{]}\leq((H-h)R^{\ast})^{2}.
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Bigl{[}%
\lVert\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_%
{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}\Bigr{]}\leq\frac{5((H-h)R^{\ast%
})^{2}}{K_{h}}.
\displaystyle\mathbb{E}_{\mu_{h}}^{(\pi^{\gt},(\tilde{\pi})_{(h+1)})}\Bigl{[}%
\lVert\widehat{\nabla}J_{h}^{K_{h}}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})-\nabla J_%
{h}(\gt,\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}\Bigr{]}\leq\frac{5((H-h)R^{\ast%
})^{2}}{K_{h}}.
(\bar{\gt}_{h}^{(n)})_{n\geq 0}
(\gt_{h}^{(n)})_{n\geq 0}
\displaystyle\gt_{h}^{(n+1)}=\gt_{h}^{(n)}+\eta_{h}\nabla J_{h}(\gt_{h}^{(n)},%
\tilde{\pi}_{(h+1)},\mu_{h})
\displaystyle\gt_{h}^{(n+1)}=\gt_{h}^{(n)}+\eta_{h}\nabla J_{h}(\gt_{h}^{(n)},%
\tilde{\pi}_{(h+1)},\mu_{h})
\gt_{h}^{(0)}=\bar{\gt}_{h}^{(0)}
\eta_{h}
(\bar{\gt}_{h}^{(n)})_{n\geq 0}
(\cF_{h}^{(n)})_{n\geq 0}
c_{h}=\min_{n\geq 0}\min_{s\in\cS}\pi^{\gt_{h}^{(n)}}(a^{\ast}(s)|s)
0
\displaystyle\tau_{h}:=\min\{n\geq 0:\lVert\gt_{h}^{(n)}-\bar{\gt}_{h}^{(n)}%
\rVert_{2}\geq\frac{c_{h}}{4}\}.
\displaystyle\tau_{h}:=\min\{n\geq 0:\lVert\gt_{h}^{(n)}-\bar{\gt}_{h}^{(n)}%
\rVert_{2}\geq\frac{c_{h}}{4}\}.
\tau_{h}
(\cF_{h}^{(n)})_{n\geq 0}
\sqrt{2}
\gt\mapsto\pi^{\gt}(a^{\ast}(s)|s)
\min_{0\leq n\leq\tau_{h}}\min_{s\in\cS}\pi^{\bar{\gt}_{h}^{(n)}}(a^{\ast}(s)|%
s)\geq\frac{c_{h}}{2}>0
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
(\bar{\gt_{h}^{(n)}})_{n\geq 0}
\min_{0\leq n\leq\tau_{h}}\min_{s\in\cS_{h}}\pi^{\bar{\gt}_{h}^{(n)}}(a^{\ast}%
(s)|s)\geq\frac{c_{h}}{2}
n\leq\tau
\sqrt{2}
\displaystyle\pi^{\bar{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)\geq\pi^{{\gt}_{h}^{(n)}}%
(a^{\ast}(s)|s)-|\pi^{{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)-\pi^{\bar{\gt}_{h}^{(n)}%
}(a^{\ast}(s)|s)|
\displaystyle\pi^{\bar{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)
\displaystyle\geq\pi^{{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)-|\pi^{{\gt}_{h}^{(n)}}(a%
^{\ast}(s)|s)-\pi^{\bar{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)|
\displaystyle\geq\pi^{{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)-\sqrt{2}\lVert\bar{\gt}_%
{h}^{(n)}-{\gt}_{h}^{(n)}\rVert_{2}
\displaystyle\geq\pi^{{\gt}_{h}^{(n)}}(a^{\ast}(s)|s)-\sqrt{2}\lVert\bar{\gt}_%
{h}^{(n)}-{\gt}_{h}^{(n)}\rVert_{2}
\displaystyle>\frac{c_{h}}{2}>0,
\displaystyle>\frac{c_{h}}{2}>0,
\{n\leq\tau_{h}\}
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
(\bar{\gt_{h}^{(n)}})_{n\geq 0}
K_{h}^{(n)}\geq\frac{45c_{h}^{2}}{64N_{h}^{\frac{3}{2}}}(1-\frac{1}{2\sqrt{N_{%
h}}})n^{2}
N_{h}\geq 1
\eta_{h}=\frac{1}{2(H-h)R^{\ast}\sqrt{N_{h}}}
\mathbb{E}\big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h%
}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_{h}\}}\big{]}\leq%
\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3(1-\frac{1}{2\sqrt{N_{h}}})c_{h}^{2}n}.
\beta_{h}
\displaystyle\mathbb{E}\Bigl{[}J(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu%
_{h})|\cF_{h}^{(n)}\Bigr{]}
\displaystyle\mathbb{E}\Bigl{[}J(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu%
_{h})|\cF_{h}^{(n)}\Bigr{]}
\displaystyle\geq J(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h})+\Big{(}%
\eta_{h}-\frac{\beta_{h}\eta_{h}^{2}}{2}\Big{)}\lVert\nabla J(\bar{\gt}_{h}^{(%
n)},\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}-\frac{\beta_{h}\eta_{h}^{2}\psi_{h}%
}{2K_{h}^{(n)}}.
\displaystyle\geq J(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h})+\Big{(}%
\eta_{h}-\frac{\beta_{h}\eta_{h}^{2}}{2}\Big{)}\lVert\nabla J(\bar{\gt}_{h}^{(%
n)},\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}-\frac{\beta_{h}\eta_{h}^{2}\psi_{h}%
}{2K_{h}^{(n)}}.
\{n+1\leq\tau_{h}\}
\{n+1\leq\tau_{h}\}=\{\tau_{h}\leq n\}^{C}
\cF_{n}
\mathbf{1}_{\{n+1\leq\tau_{h}\}}\leq\mathbf{1}_{\{n\leq\tau_{h}\}}
\displaystyle\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}%
(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n+1\leq\tau_%
{h}\}}\Big{]}
\displaystyle\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}%
(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n+1\leq\tau_%
{h}\}}\Big{]}
\displaystyle=\mathbb{E}\Big{[}\mathbb{E}\Bigl{[}(J_{h}^{\ast}(\tilde{\pi}_{(h%
+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h}))|\cF_{h%
}^{(n)}\Bigr{]}\mathbf{1}_{\{n+1\leq\tau_{h}\}}\Big{]}
\displaystyle=\mathbb{E}\Big{[}\mathbb{E}\Bigl{[}(J_{h}^{\ast}(\tilde{\pi}_{(h%
+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h}))|\cF_{h%
}^{(n)}\Bigr{]}\mathbf{1}_{\{n+1\leq\tau_{h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_%
{h})-\mathbb{E}\Bigl{[}J_{h}(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h}%
)|\cF_{h}^{(n)}\Bigr{]}\Big{)}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_%
{h})-\mathbb{E}\Bigl{[}J_{h}(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h}%
)|\cF_{h}^{(n)}\Bigr{]}\Big{)}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J%
_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_%
{h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J%
_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_%
{h}\}}\Big{]}
\displaystyle\quad-\Big{(}\eta_{h}-\frac{\beta_{h}\eta_{h}^{2}}{2}\Big{)}%
\mathbb{E}\Big{[}\lVert\nabla J_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},%
\mu_{h})\rVert^{2}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big{]}+\frac{\beta_{h}\eta_{h%
}^{2}\psi_{h}}{2K_{h}^{(n)}}
\displaystyle\quad-\Big{(}\eta_{h}-\frac{\beta_{h}\eta_{h}^{2}}{2}\Big{)}%
\mathbb{E}\Big{[}\lVert\nabla J_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},%
\mu_{h})\rVert^{2}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big{]}+\frac{\beta_{h}\eta_{h%
}^{2}\psi_{h}}{2K_{h}^{(n)}}
\displaystyle=\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h%
}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_{h}%
\}}\Big{]}
\displaystyle=\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h%
}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_{h}%
\}}\Big{]}
\displaystyle\quad-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\mathbb{E}%
\Big{[}\lVert\nabla J_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h})%
\rVert^{2}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big{]}+\frac{5(H-h)R^{\ast}}{2K_{h}^{%
(n)}N_{h}}.
\displaystyle\quad-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\mathbb{E}%
\Big{[}\lVert\nabla J_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h})%
\rVert^{2}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big{]}+\frac{5(H-h)R^{\ast}}{2K_{h}^{%
(n)}N_{h}}.
\lVert\nabla J_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h})\rVert^{2}%
\geq\min_{s\in\cS}\pi^{\theta_{n}}(a^{\ast}(s|s))^{2}(J_{h}^{\ast}(\tilde{\pi}%
_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))^{2}
\min_{0\leq n\leq\tau_{h}}\min_{s\in\cS}\pi^{\bar{\gt}_{h}^{(n)}}(a^{\ast}(s|s%
))^{2}\geq\frac{c_{h}}{2}>0
\displaystyle\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}%
(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h})\mathbf{1}_{\{n+1\leq\tau_{%
h}\}}\Big{]}
\displaystyle\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}%
(\bar{\gt}_{h}^{(n+1)},\tilde{\pi}_{(h+1)},\mu_{h})\mathbf{1}_{\{n+1\leq\tau_{%
h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J%
_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_%
{h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J%
_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_%
{h}\}}\Big{]}
\displaystyle\quad-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\mathbb{E}%
\Big{[}\min_{s\in\cS}\pi^{\theta_{n}}(a^{\ast}(s|s))^{2}(J_{h}^{\ast}(\tilde{%
\pi}_{(h+1)},\mu_{h})-J_{h}(\theta_{n}))^{2}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big%
{]}+\frac{5(H-h)R^{\ast}}{2K_{h}^{(n)}N_{h}},
\displaystyle\quad-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\mathbb{E}%
\Big{[}\min_{s\in\cS}\pi^{\theta_{n}}(a^{\ast}(s|s))^{2}(J_{h}^{\ast}(\tilde{%
\pi}_{(h+1)},\mu_{h})-J_{h}(\theta_{n}))^{2}\mathbf{1}_{\{n\leq\tau_{h}\}}\Big%
{]}+\frac{5(H-h)R^{\ast}}{2K_{h}^{(n)}N_{h}},
\displaystyle\leq\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J%
_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_%
{h}\}}\Big{]}
\displaystyle\leq\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J%
_{h}(\bar{\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_%
{h}\}}\Big{]}
\displaystyle\quad-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\frac{c_{h}^%
{2}}{4}\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_{h}\}}\Big%
{]}^{2}+\frac{5(H-h)R^{\ast}}{2K_{h}^{(n)}N_{h}},
\displaystyle\quad-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\frac{c_{h}^%
{2}}{4}\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_{h}\}}\Big%
{]}^{2}+\frac{5(H-h)R^{\ast}}{2K_{h}^{(n)}N_{h}},
d_{n}:=\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(n)},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{n\leq\tau_{h}\}}\Big%
{]}
\displaystyle d_{n+1}\leq d_{n}-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)%
}\frac{c_{h}^{2}}{4}d_{n}^{2}+\frac{5(H-h)R^{\ast}}{2K_{h}^{(n)}N_{h}}.
\displaystyle d_{n+1}\leq d_{n}-\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)%
}\frac{c_{h}^{2}}{4}d_{n}^{2}+\frac{5(H-h)R^{\ast}}{2K_{h}^{(n)}N_{h}}.
w:=\eta_{h}\Big{(}1-\frac{1}{2\sqrt{N_{h}}}\Big{)}\frac{c_{h}^{2}}{4}>0
B=\frac{5(H-h)R^{\ast}}{2N_{h}}>0
\displaystyle d_{n+1}\leq d_{n}(1-wd_{n})+\frac{B}{K_{h}^{(n)}}
\displaystyle d_{n+1}\leq d_{n}(1-wd_{n})+\frac{B}{K_{h}^{(n)}}
\eta_{h}
\displaystyle K_{h}^{(n)}\geq\frac{45c_{h}^{2}}{64N_{h}^{\frac{3}{2}}}(1-\frac%
{1}{2\sqrt{N_{h}}})n^{2}=\frac{9}{4}wBn^{2},
\displaystyle K_{h}^{(n)}\geq\frac{45c_{h}^{2}}{64N_{h}^{\frac{3}{2}}}(1-\frac%
{1}{2\sqrt{N_{h}}})n^{2}=\frac{9}{4}wBn^{2},
\displaystyle d_{1}\leq(H-h)R^{\ast}\leq\frac{1}{\eta_{h}}\leq\frac{4}{3w}\leq%
\frac{4}{3w\cdot 1},
\displaystyle d_{1}\leq(H-h)R^{\ast}\leq\frac{1}{\eta_{h}}\leq\frac{4}{3w}\leq%
\frac{4}{3w\cdot 1},
c_{h}\leq 1
\frac{1}{\sqrt{N_{h}}}(1-\frac{1}{2\sqrt{N_{h}}})<1
N_{h}\geq 1
d_{n}\leq\frac{4}{3wn}
d_{n+1}
\displaystyle d_{n+1}\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{h}^{(n)}}.
\displaystyle d_{n+1}\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{h}^{(n)}}.
f(x)=x-wx^{2}
[0,\frac{1}{2w}]
d_{n}\leq\frac{1}{4wn}\leq\frac{1}{2w}
d_{n}-wd_{n}^{2}\leq\frac{4}{3wn}
\displaystyle d_{n+1}\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{h}^{(n)}}
\displaystyle d_{n+1}
\displaystyle\leq d_{n}-wd_{n}^{2}+\frac{B}{K_{h}^{(n)}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{B}{K_{n}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{B}{K_{n}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{4B}{9wBn^{2}}
\displaystyle\leq\frac{4}{3wn}-\frac{16}{9wn^{2}}+\frac{4B}{9wBn^{2}}
\displaystyle=\frac{4}{3wn}-\frac{12}{9wn^{2}}
\displaystyle=\frac{4}{3wn}-\frac{12}{9wn^{2}}
\displaystyle=\frac{4}{3w}\Big{(}\frac{1}{n}-\frac{1}{n^{2}}\Big{)}
\displaystyle=\frac{4}{3w}\Big{(}\frac{1}{n}-\frac{1}{n^{2}}\Big{)}
\displaystyle\leq\frac{4}{3w(n+1)},
\displaystyle\leq\frac{4}{3w(n+1)},
K_{h}^{(n)}\geq\frac{9}{4}wBn^{2}
\displaystyle d_{n}\leq\frac{4}{3wn}=\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3(1-%
\frac{1}{2\sqrt{N_{h}}})c_{h}^{2}n}.
\displaystyle d_{n}\leq\frac{4}{3wn}=\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3(1-%
\frac{1}{2\sqrt{N_{h}}})c_{h}^{2}n}.
\{\tau\leq n\}
\delta
K_{h}
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
(\bar{\gt_{h}^{(n)}})_{n\geq 0}
\delta>0
K_{h}\geq\frac{5n^{3}}{c_{h}^{2}\delta^{2}}
\eta_{h}=\frac{1}{\sqrt{n}\beta_{h}}
\bbP(\tau_{h}\leq n)<\delta
\displaystyle\bbP(\tau_{h}\leq n)=\bbP(\max_{0\leq t\leq n}\lVert\gt_{h}^{(n)}%
-\bar{\gt}_{h}^{(n)}\rVert\geq\frac{c_{h}}{4})
\displaystyle\bbP(\tau_{h}\leq n)
\displaystyle=\bbP(\max_{0\leq t\leq n}\lVert\gt_{h}^{(n)}-\bar{\gt}_{h}^{(n)}%
\rVert\geq\frac{c_{h}}{4})
\displaystyle\leq\frac{4n\eta_{h}(1+\eta_{h}\beta_{h})^{n-1}\sqrt{\frac{\psi_{%
h}}{K_{h}}}}{c_{h}},
\displaystyle\leq\frac{4n\eta_{h}(1+\eta_{h}\beta_{h})^{n-1}\sqrt{\frac{\psi_{%
h}}{K_{h}}}}{c_{h}},
\psi_{h}
\eta_{h}=\frac{1}{\sqrt{n}\beta_{h}}=\frac{1}{2(H-h)R^{\ast}\sqrt{n}}
\displaystyle\bbP(\tau_{h}\leq n)\leq\frac{4n\frac{1}{\sqrt{n}\beta_{h}}(1+%
\frac{1}{\sqrt{n}\beta_{h}}\beta_{h})^{n-1}\sqrt{\frac{\xi_{h}}{K_{h}}}}{c_{h}}
\displaystyle\bbP(\tau_{h}\leq n)
\displaystyle\leq\frac{4n\frac{1}{\sqrt{n}\beta_{h}}(1+\frac{1}{\sqrt{n}\beta_%
{h}}\beta_{h})^{n-1}\sqrt{\frac{\xi_{h}}{K_{h}}}}{c_{h}}
\displaystyle=\frac{4\sqrt{n}(1+\frac{1}{\sqrt{n}})^{n-1}\sqrt{\psi_{h}}}{%
\beta_{h}c_{h}\sqrt{K_{h}}}
\displaystyle=\frac{4\sqrt{n}(1+\frac{1}{\sqrt{n}})^{n-1}\sqrt{\psi_{h}}}{%
\beta_{h}c_{h}\sqrt{K_{h}}}
\displaystyle\leq\frac{2n\sqrt{n}\sqrt{\psi_{h}}}{\beta_{h}c_{h}\sqrt{K_{h}}}=%
\frac{n\sqrt{5n}}{c_{h}\sqrt{K_{h}}},
\displaystyle\leq\frac{2n\sqrt{n}\sqrt{\psi_{h}}}{\beta_{h}c_{h}\sqrt{K_{h}}}=%
\frac{n\sqrt{5n}}{c_{h}\sqrt{K_{h}}},
f(x)=(1+\frac{1}{\sqrt{x}})^{x-1}\leq x
x\geq 1
\bbP(\tau_{h}<n)<\delta
\displaystyle K_{h}\geq\frac{5n^{3}}{c_{h}^{2}\delta^{2}}.
\displaystyle K_{h}\geq\frac{5n^{3}}{c_{h}^{2}\delta^{2}}.
\mu_{h}
\mu_{h}(s)>0
s\in\cS_{h}
(\bar{\gt_{h}^{(n)}})_{n\geq 0}
\delta,\epsilon>0
N_{h}\geq\big{(}\frac{12(H-h)R^{\ast}}{\epsilon\delta c_{h}^{2}}\big{)}^{2}
\eta_{h}=\frac{1}{2(H-h)R^{\ast}\sqrt{N_{h}}}
K_{h}=\frac{5N_{h}^{3}}{c_{h}^{2}\delta^{2}}
\bbP\big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(N_{%
h})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\epsilon\big{)}\leq\delta
\tau_{h}
\displaystyle\bbP\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\epsilon\Big{)}
\displaystyle\bbP\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\epsilon\Big{)}
\displaystyle\leq\bbP\Big{(}\{\tau_{h}\geq{N_{h}}\}\cap\{J_{h}^{\ast}(\tilde{%
\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h%
})\geq\epsilon\}\Big{)}
\displaystyle\leq\bbP\Big{(}\{\tau_{h}\geq{N_{h}}\}\cap\{J_{h}^{\ast}(\tilde{%
\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h%
})\geq\epsilon\}\Big{)}
\displaystyle\quad+\bbP\Big{(}\{\tau_{h}\leq{N_{h}}\}\cap\{J_{h}^{\ast}(\tilde%
{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{%
h})\geq\epsilon\}\Big{)}
\displaystyle\quad+\bbP\Big{(}\{\tau_{h}\leq{N_{h}}\}\cap\{J_{h}^{\ast}(\tilde%
{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{%
h})\geq\epsilon\}\Big{)}
\displaystyle\leq\frac{\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_%
{h})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{%
\tau_{h}\geq{N_{h}}\}}\Big{]}}{\epsilon}+\bbP(\tau_{h}\leq{N_{h}})
\displaystyle\leq\frac{\mathbb{E}\Big{[}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_%
{h})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h}))\mathbf{1}_{\{%
\tau_{h}\geq{N_{h}}\}}\Big{]}}{\epsilon}+\bbP(\tau_{h}\leq{N_{h}})
\displaystyle\leq\frac{1}{\epsilon}\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3(1-%
\frac{1}{2\sqrt{N_{h}}})c_{h}^{2}n}+\frac{\delta}{2}
\displaystyle\leq\frac{1}{\epsilon}\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3(1-%
\frac{1}{2\sqrt{N_{h}}})c_{h}^{2}n}+\frac{\delta}{2}
\displaystyle\leq\frac{\delta}{2}+\frac{\delta}{2}
\displaystyle\leq\frac{\delta}{2}+\frac{\delta}{2}
\displaystyle=\delta,
\displaystyle=\delta,
N_{h}
\displaystyle\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3\epsilon(1-\frac{1}{2\sqrt{N_%
{h}}})c_{h}^{2}n}\leq\frac{11\sqrt{N_{h}}(H-h)R^{\ast}}{\epsilon(1-\frac{1}{2%
\sqrt{N_{h}}})c_{h}^{2}n}\leq\frac{\delta}{2}
\displaystyle\frac{32\sqrt{N_{h}}(H-h)R^{\ast}}{3\epsilon(1-\frac{1}{2\sqrt{N_%
{h}}})c_{h}^{2}n}
\displaystyle\leq\frac{11\sqrt{N_{h}}(H-h)R^{\ast}}{\epsilon(1-\frac{1}{2\sqrt%
{N_{h}}})c_{h}^{2}n}\leq\frac{\delta}{2}
N_{h}\geq\big{(}\frac{11(H-h)R^{\ast}}{\epsilon\delta c_{h}^{2}}+\frac{1}{2}%
\big{)}^{2}
N_{h}\geq\big{(}\frac{12(H-h)R^{\ast}}{\epsilon\delta c_{h}^{2}}\big{)}^{2}
K_{h}
\displaystyle\max\Big{\{}\frac{45c_{h}^{2}}{64N_{h}^{\frac{3}{2}}}(1-\frac{1}{%
2\sqrt{N_{h}}})n^{2},\frac{5N_{h}^{3}}{c_{h}^{2}\delta^{2}}\Big{\}}=\frac{5N_{%
h}^{3}}{c_{h}^{2}\delta^{2}},
\displaystyle\max\Big{\{}\frac{45c_{h}^{2}}{64N_{h}^{\frac{3}{2}}}(1-\frac{1}{%
2\sqrt{N_{h}}})n^{2},\frac{5N_{h}^{3}}{c_{h}^{2}\delta^{2}}\Big{\}}=\frac{5N_{%
h}^{3}}{c_{h}^{2}\delta^{2}},
n\leq N_{h}
(1-\frac{1}{2\sqrt{N_{h}}})<1
c_{h}<1
\tilde{\pi}=\hat{\pi}^{\ast}
\displaystyle J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})=V_%
{h}^{\hat{\pi}^{\ast}}(s).
\displaystyle J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})=V_%
{h}^{\hat{\pi}^{\ast}}(s).
\displaystyle\bbP\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\frac{\epsilon}{H\Big{%
\lVert}\frac{1}{\mu_{h}}\Big{\rVert}_{\infty}}\Big{)}\leq\frac{\delta}{H},
\displaystyle\bbP\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\bar{%
\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\frac{\epsilon}{H\Big{%
\lVert}\frac{1}{\mu_{h}}\Big{\rVert}_{\infty}}\Big{)}\leq\frac{\delta}{H},
N_{h}
\eta_{h}
K_{h}
s\in\cS_{h}
\delta_{s}
s
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\bar{\gt}_{h}%
^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})\leq\Big{\lVert}\frac{1}{\mu_{h}}%
\Big{\rVert}_{\infty}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^%
{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h}))\quad\textrm{a.s.}
\displaystyle J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\bar{\gt}_{h}%
^{(N_{h})},\tilde{\pi}_{(h+1)},\delta_{s})\leq\Big{\lVert}\frac{1}{\mu_{h}}%
\Big{\rVert}_{\infty}(J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^%
{(N_{h})},\tilde{\pi}_{(h+1)},\mu_{h}))\quad\textrm{a.s.}
h\in\cH
\displaystyle\begin{split}&\bbP\Big{(}\exists s\in\cS_{h}:J_{h}^{\ast}(\tilde{%
\pi}_{(h+1)},\delta_{s})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},%
\delta_{s})\geq\frac{\epsilon}{H}\Big{)}\\
&\leq\bbP\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(N_{h%
})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\frac{\epsilon}{H\Big{\lVert}\frac{1}{\mu_%
{h}}\Big{\rVert}_{\infty}}\Big{)}\leq\frac{\delta}{H}.\end{split}
\displaystyle\begin{split}&\bbP\Big{(}\exists s\in\cS_{h}:J_{h}^{\ast}(\tilde{%
\pi}_{(h+1)},\delta_{s})-J_{h}(\bar{\gt}_{h}^{(N_{h})},\tilde{\pi}_{(h+1)},%
\delta_{s})\geq\frac{\epsilon}{H}\Big{)}\\
&\leq\bbP\Big{(}J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\mu_{h})-J_{h}(\gt_{h}^{(N_{h%
})},\tilde{\pi}_{(h+1)},\mu_{h})\geq\frac{\epsilon}{H\Big{\lVert}\frac{1}{\mu_%
{h}}\Big{\rVert}_{\infty}}\Big{)}\leq\frac{\delta}{H}.\end{split}
A_{h}:=\{J_{h}^{\ast}(\tilde{\pi}_{(h+1)},\delta_{s})-J_{h}(\bar{\gt}_{h}^{(N_%
{h})},\tilde{\pi}_{(h+1)},\delta_{s})<\frac{\epsilon}{H},\,\forall s\in\cS_{h}\}
\bbP(A_{h}^{C})\leq\frac{\delta}{H}
h=H-1
\displaystyle\bbP\Big{(}\exists s\in\cS_{h}:V_{H-1}^{\ast}(s)-V_{H-1}^{\hat{%
\pi}^{\ast}}(s)\geq\frac{\epsilon}{H}\Big{)}
\displaystyle\bbP\Big{(}\exists s\in\cS_{h}:V_{H-1}^{\ast}(s)-V_{H-1}^{\hat{%
\pi}^{\ast}}(s)\geq\frac{\epsilon}{H}\Big{)}
\displaystyle=\bbP\Big{(}\exists s\in\cS_{h}:J_{H-1}^{\ast}(\delta_{s})-J_{H-1%
}(\bar{\gt}_{h}^{(N_{h})},\delta_{s})\geq\frac{\epsilon}{H}\Big{)}\leq\frac{%
\delta}{H}.
\displaystyle=\bbP\Big{(}\exists s\in\cS_{h}:J_{H-1}^{\ast}(\delta_{s})-J_{H-1%
}(\bar{\gt}_{h}^{(N_{h})},\delta_{s})\geq\frac{\epsilon}{H}\Big{)}\leq\frac{%
\delta}{H}.
0<h<H
\displaystyle\bbP\Big{(}\exists s\in\cS_{h}:V_{h}^{\ast}(s)-V_{h}^{\hat{\pi}^{%
\ast}}(s)\geq\frac{\epsilon(H-h)}{H}\Big{)}\leq\frac{\delta(H-h)}{H}.
\displaystyle\bbP\Big{(}\exists s\in\cS_{h}:V_{h}^{\ast}(s)-V_{h}^{\hat{\pi}^{%
\ast}}(s)\geq\frac{\epsilon(H-h)}{H}\Big{)}\leq\frac{\delta(H-h)}{H}.
B_{h}:=\{V_{h}^{\ast}(s)-V_{h}^{\hat{\pi}^{\ast}}(s)<\frac{\epsilon(H-h)}{H},%
\forall s\in\cS_{h}\}
B_{h}
\displaystyle J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})=\max_{a\in\cA_{s}}%
\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)V_{h}^{\ast}(s)-%
\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)(V_{h}^{\ast}(s)-V_{h}^{\hat{\pi}^%
{\ast}}(s))\Bigr{)}
\displaystyle J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})
\displaystyle=\max_{a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^%
{\prime}|s,a)V_{h}^{\ast}(s)-\sum_{s^{\prime}\in\cS_{h}}p(s^{\prime}|s,a)(V_{h%
}^{\ast}(s)-V_{h}^{\hat{\pi}^{\ast}}(s))\Bigr{)}
\displaystyle>\max_{a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^%
{\prime}|s,a)V_{h}^{\ast}(s)\Bigr{)}-\frac{\epsilon(H-h)}{H}
\displaystyle>\max_{a\in\cA_{s}}\Bigl{(}r(s,a)+\sum_{s^{\prime}\in\cS_{h}}p(s^%
{\prime}|s,a)V_{h}^{\ast}(s)\Bigr{)}-\frac{\epsilon(H-h)}{H}
\displaystyle=V_{h-1}^{\ast}(s)-\frac{\epsilon(H-h)}{H}.
\displaystyle=V_{h-1}^{\ast}(s)-\frac{\epsilon(H-h)}{H}.
A_{h-1}\cap B_{h}
\displaystyle V_{h-1}^{\ast}(s)-V_{h-1}^{\hat{\pi}^{\ast}}(s)=V_{h-1}^{\ast}(s%
)-J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})+J_{h-1}^{\ast}(\tilde{\pi}_{(h)%
},\delta_{s})-V_{h-1}^{\hat{\pi}^{\ast}}(s)
\displaystyle V_{h-1}^{\ast}(s)-V_{h-1}^{\hat{\pi}^{\ast}}(s)
\displaystyle=V_{h-1}^{\ast}(s)-J_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})+J%
_{h-1}^{\ast}(\tilde{\pi}_{(h)},\delta_{s})-V_{h-1}^{\hat{\pi}^{\ast}}(s)
\displaystyle<\frac{\epsilon(H-h)}{H}+\frac{\epsilon}{H}
\displaystyle<\frac{\epsilon(H-h)}{H}+\frac{\epsilon}{H}
\displaystyle=\frac{\epsilon(H-(h-1))}{H},
\displaystyle=\frac{\epsilon(H-(h-1))}{H},
s\in\cS_{h-1}
A_{h-1}\cap B_{h}\subseteq B_{h-1}
\displaystyle\bbP\Bigl{(}\exists s\in\cS_{h-1}:V_{h-1}^{\ast}(s)-V_{h-1}^{\hat%
{\pi}^{\ast}}(s)\geq\frac{\epsilon(H-(h-1))}{H}\Bigr{)}
\displaystyle\bbP\Bigl{(}\exists s\in\cS_{h-1}:V_{h-1}^{\ast}(s)-V_{h-1}^{\hat%
{\pi}^{\ast}}(s)\geq\frac{\epsilon(H-(h-1))}{H}\Bigr{)}
\displaystyle=1-\bbP(B_{h-1})\leq 1-\bbP(A_{h-1}\cap B_{h})=\bbP(A_{h-1}^{C}%
\cup B_{h}^{C})\leq\bbP(A_{h-1}^{C})+\bbP(B_{h}^{C})
\displaystyle=1-\bbP(B_{h-1})\leq 1-\bbP(A_{h-1}\cap B_{h})=\bbP(A_{h-1}^{C}%
\cup B_{h}^{C})\leq\bbP(A_{h-1}^{C})+\bbP(B_{h}^{C})
\displaystyle=\bbP\Big{(}\exists s\in\cS_{h-1}:J_{h-1}^{\ast}(\tilde{\pi}_{(h)%
},\delta_{s})-J_{h-1}(\gt_{h-1}^{(N_{h}-1)},\tilde{\pi}_{(h)},\delta_{s})\geq%
\frac{\epsilon}{H}\Big{)}
\displaystyle=\bbP\Big{(}\exists s\in\cS_{h-1}:J_{h-1}^{\ast}(\tilde{\pi}_{(h)%
},\delta_{s})-J_{h-1}(\gt_{h-1}^{(N_{h}-1)},\tilde{\pi}_{(h)},\delta_{s})\geq%
\frac{\epsilon}{H}\Big{)}
\displaystyle\quad+\bbP\Big{(}\exists s\in\cS_{h}:V_{h}^{\ast}(s)-V_{h}^{\hat{%
\pi}^{\ast}}(s)\geq\frac{\epsilon(H-h)}{H}\Big{)}
\displaystyle\quad+\bbP\Big{(}\exists s\in\cS_{h}:V_{h}^{\ast}(s)-V_{h}^{\hat{%
\pi}^{\ast}}(s)\geq\frac{\epsilon(H-h)}{H}\Big{)}
\displaystyle\leq\frac{\delta}{H}+\frac{\delta(H-h)}{H}
\displaystyle\leq\frac{\delta}{H}+\frac{\delta(H-h)}{H}
\displaystyle=\frac{\delta(H-(h-1))}{H}.
\displaystyle=\frac{\delta(H-(h-1))}{H}.
h=0
\displaystyle\bbP\Big{(}\exists s\in\cS_{0}:V_{0}^{\ast}(s)-V_{0}^{\hat{\pi}^{%
\ast}}(s)\geq\epsilon\Big{)}\leq\delta.
\displaystyle\bbP\Big{(}\exists s\in\cS_{0}:V_{0}^{\ast}(s)-V_{0}^{\hat{\pi}^{%
\ast}}(s)\geq\epsilon\Big{)}\leq\delta.
H=5
\cS=\{1,\dots,6,\Delta\}
1,\dots,6
\Delta
\cA=\{0,1\}
1
0
p
\begin{split}p(s^{\prime}\bigm{|}s,a)&=\bbP(S_{h+1}=s^{\prime}\bigm{|}S_{h}=a,%
A_{h}=a)\\
\ &=\begin{cases}\frac{1}{6},&\text{if }s^{\prime},s\in\{0,1\dots,6\},\,a=0,\\
1,&\text{if }s^{\prime}=\Delta,\,s\in\cS,\,a=1\text{ or }s^{\prime}=s=\Delta,%
\,a=0,\\
0,&\text{otherwise.}\end{cases}\end{split}
r
\begin{split}r(s,a)=\begin{cases}s,&\text{if }s\in\{0,1\dots,6\},\,a=1,\\
0,&\text{otherwise.}\end{cases}\end{split}
1
\gt\equiv 0
V_{0}^{\pi^{\gt^{(n)}}}
V_{0}^{\ast}
V_{0}^{\pi^{\gt^{(n)}}}
V_{0}^{\ast}
V_{0}^{\ast}
x
c
0.1
\gt_{0}
V_{0}^{\pi^{\gt}}
{\epsilon}=5,1,0.5,0.25,0.12
c_{h}=0.5
N_{h}
\epsilon
\frac{1}{n}
\frac{1}{n}
\epsilon
H
