\mathcal{D}
(c,s,l)
c
s
l
\rho
\{acceptable,unacceptable\}
l
\rho
\mathcal{R}(\theta)
\rho
c
s
l
s
acceptable
\mathcal{S}_{(s,c)}=\mathcal{R}(s,c;\theta)_{acceptable}.
\mathcal{G}(\xi_{0})
\mathcal{G}(\xi_{0})
(X,Y)
X
Y
\xi_{0}
(X,Y)
(x,y)\in(X,Y)
(c,s)\in\mathcal{D}
K
\left\{\tilde{y}_{k}\right\}_{k=1}^{k=K}
\mathcal{G}(\tilde{y}_{k}|x;\xi_{0})
x\in X
\mathcal{G}(\xi_{0})
\{\mathcal{S}_{(\tilde{y}_{k},x)}\}_{k=1}^{k=K}
\rho
s
c
l
\rho
p_{i}(\rho)
\rho
\rho
l
s
c_{i}
\rho
p(s|c_{i},\rho)
\sum_{i}\log{p(s_{i}|c_{i})}=\sum_{i}\log{(\sum_{\rho}p(s_{i}|c_{i},\rho)p_{i}%
(\rho))}
p_{i}(\rho)
q(\rho|s_{i},c_{i})
i
-\sum_{i}\log{p(s_{i}|c_{i})}+\sum_{i}\sum_{\rho}q(\rho|s_{i},c_{i})\log\frac{%
p(s_{i}|c_{i},\rho)p_{i}(\rho)}{q(\rho|s_{i},c_{i})}.
s_{i}
p(s_{i}|c_{i},\rho)
q(\rho|s_{i},c_{i})
q(\rho|s_{i},c_{i})=\mathcal{R}(s_{i},c_{i}|\theta).
p(s_{i}|c_{i},\rho)
i
q(\rho|s_{i},c_{i})
\sum_{i}p(s_{i}|c_{i},\rho)=1
\rho
p(s_{i}|c_{i},\rho)=a_{i,\rho}=\frac{q(\rho|s_{i},c_{i})}{\sum_{j}q(\rho|s_{j}%
,c_{j})}.
a_{i,\rho}
s_{i}
\rho
c_{i}
-\log{p(s_{i}|c_{i})}+\sum_{i}\textsc{KL}(q(\rho|s_{i},c_{i})\|r_{i}(\rho))
r_{i}(\rho)\propto p(s_{i}|c_{i},\rho)p_{i}(\rho)
p(s_{i}|c_{i},\rho)
r_{i}(\rho)=\alpha_{i}\cdot p_{i}(\rho)p(s_{i}|c_{i},\rho)=\alpha_{i}\frac{p_{%
i}(\rho)q_{i}(\rho|s_{i},c_{i})}{\sum_{j}q_{j}(\rho|s_{j},c_{j})},
\alpha_{i}
\sum_{\rho}r_{i}(\rho)=1
q(\rho|s_{i},c_{i})
r_{i}(\rho)
\sum_{i}\textsc{KL}(q(\rho|s_{i},c_{i})\|r_{i}(\rho))=\min_{\theta}\sum_{i}%
\textsc{KL}\bigg{(}\mathcal{R}(s_{i},c_{i};\theta)\Big{\|}\alpha_{i}\cdot p_{i%
}(\rho)\vphantom{\dfrac{q(|)}{\sum_{j}q(|)}}\frac{\mathcal{R}(s_{i},c_{i};%
\theta)}{\sum_{j}\mathcal{R}(s_{j},c_{j};\theta)}\bigg{)}.
\theta
10
1000
10
1000
\mathcal{G}(\xi_{0})
\mathcal{G}(\xi_{0})
(X,Y)
\xi_{0}
x\in X
\mathcal{G}(\xi_{0})
K
\{\tilde{y}_{1},\tilde{y}_{2},\cdots,\tilde{y}_{K}\}
\mathcal{R}(\theta)
\mathcal{S}_{(\tilde{y}_{k},x)}
\tilde{y}_{k}
\tilde{y}_{1}^{{}^{\prime}},\tilde{y}_{2}^{{}^{\prime}},\cdots,\tilde{y}_{K}^{%
{}^{\prime}}
\mathcal{S}_{(\tilde{y}_{i}^{{}^{\prime}},x)}>\mathcal{S}_{(\tilde{y}_{j}^{{}^%
{\prime}},x)}
\forall~{}{i<j}
\mathcal{G}(\xi)
\mathcal{L}^{r}=\sum_{i}\sum_{j>i}max(0,\mathbf{P}(\tilde{y}_{j}^{{}^{\prime}}%
;\xi)-\mathbf{P}(\tilde{y}_{i}^{{}^{\prime}};\xi)+\lambda_{ij}),
\lambda_{ij}
\lambda
\lambda_{ij}=\lambda*(j-i)
\mathbf{P}(\tilde{y}_{i}^{{}^{\prime}};\xi)
\mathbf{P}(\tilde{y}^{{}^{\prime}};\xi)=\frac{\sum_{t=1}^{|\tilde{y}^{{}^{%
\prime}}|}\log\mathcal{G}(\tilde{y}^{{}^{\prime}}_{t}|x,\tilde{y}^{{}^{\prime}%
}_{<t};\xi)}{|\tilde{y}^{{}^{\prime}}|^{\alpha}},
\alpha
\mathcal{L}^{c}=-\lambda\frac{1}{|y|}\sum_{t=1}^{|y|}\log{\mathcal{G}(y_{t}|x,%
y_{<t};\xi)}+\mathcal{L}^{r}.
\mathcal{L}^{c}
\xi
1
31
17
2\sim 4
\{acceptable,unacceptable\}
\mathcal{G}(\xi_{0})
l_{m}
\mathcal{L}(\theta)=-\mathbbm{E}_{(c,s,l_{m})\sim\mathcal{D}}[p_{l}(l_{m})\log%
(\mathcal{R}^{l_{m}}(c,s;{\theta}))].
p_{l}(l_{m})
l_{m}
l
\mathcal{L}(\theta)=\mathbbm{E}_{(c,s,l)\sim\mathcal{D}}\|\mathcal{R}(c,s;%
\theta)-l\|^{2}.
K
10
p<0.01
p<0.01
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{w/oA}}
{}_{\text{d-PM}}
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{w/oA}}
{}_{\text{d-PM}}
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{w/oA}}
{}_{\text{d-PM}}
{}_{\text{d-PM}}
{}_{\text{w/oA}}
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{d-PM}}
100
1\sim 5
1\sim 5
1\sim 5
1\sim 5
1\sim 5
<1\%
5\%\sim 25\%
\sim 50\%
75\%\sim 90\%
>99\%
{}_{\text{d-PM}}
{\dagger}
p<0.01
{\dagger}
p<0.01
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
99
38
\beta
n=3
p=0.9
acceptable
\beta
unacceptable
(1-\beta)
K
5
100
K
K
K
K
5
10
15
20
K
20\%
0
0.2
n_{\text{layer}}^{\text{BERT}}
d^{\text{BERT}}
\mathtt{L}_{\texttt{idx}}
|\mathtt{L}_{\texttt{idx}}|
z=[\mathtt{L}_{\texttt{idx}};c;s]
z_{t}
t
h=[h^{\text{prefix}},h^{c},h^{s}]
h_{t}
t
h^{c}
h^{s}
h^{\text{prefix}}
A_{\theta_{1}}
\theta_{1}
|\mathtt{L}_{\texttt{idx}}|\times d^{\text{dim}}
d^{\text{dim}}=n_{\text{layer}}^{\text{BERT}}\times d^{\text{BERT}}
h_{t}
t
h_{t}=\left\{\begin{aligned} &A_{\theta_{1}}[t,:]&\text{if}~{}t<|\mathtt{L}_{%
\texttt{idx}}|,\\
&\text{BERT}(z_{t},h_{<t})&\text{otherwise}.\\
\end{aligned}\right.
s
acceptable
unacceptable
\theta_{2}
\theta=(\theta_{1},\theta_{2})
10
160
5\times 10^{-4}
15
acceptable
unacceptable
9:1
34.93\%
acceptable
unacceptable
1\sim 5
<1\%
5\%\sim 25\%
\sim 50\%
75\%\sim 90\%
>99\%
\beta
acceptable
\beta
unacceptable
(1-\beta)
1\times 10^{-3}
3\times 10^{-5}
32
12
0
1
13
42
1024
1\times 10^{-4}
0
1
13
42
1024
0
1
13
42
1024
{\dagger}
p<0.01
{\dagger}
p<0.01
{\dagger}
p<0.01
{\dagger}
p<0.01
p=0.9
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{major}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
{}_{\text{soft}}
{}_{\text{d-PM}}
3\sim 4
2\sim 3
40
