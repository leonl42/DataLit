p(x|\xi)
\xi
y
p(y|\xi)
\hat{x}
y
\xi
p(x|\xi)
\xi
y
p(y|\xi)
\hat{x}
y
\xi
\xi
x
p(x|\xi)
y
p(y|\xi)
y
\xi
L\in\mathbb{N}
c_{x}
c_{\xi}
n
\{(x,\xi)_{i}\}_{i=1}^{n}
x\in\mathbb{R}^{d_{x}}
\xi\in\mathbb{R}^{d_{\xi}}
d_{x}=c_{x}L^{3}
d_{\xi}=c_{\xi}L^{3}
L=64
16^{3}
x
\xi
\sigma
E_{\rm lig}
E_{\rm poc}
U
\hat{x}=\mathbbm{1}_{\geq.1}(\hat{x})
x
\xi
\sigma
E_{\rm lig}
E_{\rm poc}
U
\hat{x}=\mathbbm{1}_{\geq.1}(\hat{x})
X
\Xi
\mathbb{R}^{d_{x}}
\mathbb{R}^{d_{\xi}}
p(x,\xi)
\Xi=\xi
\nabla_{y}\log p(y|\xi)
p(y|\xi)
p(x|\xi)
p(y|\xi)=\int p(y|x)p(x|\xi)dx,
p(y|x)=\frac{1}{(2\pi\sigma^{2})^{d_{x}/2}}\exp\Bigl{(}-\frac{\|y-x\|^{2}}{2%
\sigma^{2}}\Bigr{)},
Y|x\sim\mathscr{N}(x,\sigma^{2}I_{d_{x}})
x
y
\xi
p(y|x,\xi)=p(y|x)
\hat{x}(y|\xi)
X
(y,\xi)
g(\cdot|\xi)
g(y|\xi)=\nabla_{y}\log p(y|\xi).
\hat{x}(y|\xi)=\mathbb{E}[X|y,\xi]
\hat{x}(y|\xi)=\frac{\int xp(y|x)p(x|\xi)dx}{\int p(y|x)p(x|\xi)dx}.
\hat{x}(y|\xi)=y+\sigma^{2}g(y|\xi).
\sigma^{2}\nabla_{y}p(y|x)=(x-y)p(y|x).
p(x|\xi)
x
\nabla_{y}
x
\sigma^{2}\nabla_{y}p(y|\xi)=\int xp(y|x)p(x|\xi)dx-yp(y|\xi).
p(y|\xi)
\nabla_{y}\log p(y|\xi)
p(x|\xi)
p(y|\xi)
p(x|\xi)
p(y|\xi)
\hat{x}_{\theta}(y|\xi)=U_{\theta_{3}}(E_{\rm lig}(y;\theta_{1})+E_{\rm poc}(%
\xi;\theta_{2})),
\hat{x}_{\theta}:\mathbb{R}^{d_{x}}\times\mathbb{R}^{d_{\xi}}\rightarrow%
\mathbb{R}^{d_{x}}
\theta=(\theta_{1},\theta_{2},\theta_{3})
E_{\rm lig}
E_{\rm poc}
y
\xi
\mathbb{R}^{d_{e}}
d_{e}=c_{e}L^{3}
U
\Delta k=100
\Delta k=100
(x,\xi)
\mathscr{N}(0,\sigma^{2}I_{d_{x}})
y=x+\sigma\,\varepsilon,\ \varepsilon\sim\mathscr{N}(0,I_{d_{x}})
(y,\xi)
x
\mathcal{L}(\theta)=\mathbb{E}_{\begin{subarray}{c}(x,\xi)\sim p(x,\xi),\\
\varepsilon\sim\mathscr{N}(0,I_{d_{x}})\end{subarray}}\big{\|}\hat{x}_{\theta}%
(x+\sigma\varepsilon|\xi)-x\big{\|}^{2}.
g_{\theta}(y|\xi)=\frac{1}{\sigma^{2}}(\hat{x}_{\theta}(y|\xi)-y).
\hat{x}_{\theta}
g_{\theta}
\sigma
\xi
\delta
\gamma
K
\widehat{x}
y_{0}\sim\mathscr{N}(0,\sigma^{2}I_{d_{x}})+\mathscr{U}_{d_{x}}(0,1)
v_{0}\leftarrow 0
k=0,\dots,K-1
y_{k+1}\leftarrow y_{k}+\frac{\delta}{2}v_{k}
g\leftarrow g_{\theta}(y_{k+1}|\xi)
v_{k+1}\leftarrow v_{k}+\frac{\delta}{2}g
\varepsilon\sim\mathscr{N}(0,I_{d_{x}})
v_{k+1}\leftarrow{\rm e}^{-\gamma\delta}v_{k+1}+\frac{\delta}{2}g+\sqrt{\left(%
1-{\rm e}^{-2\gamma\delta}\right)}\varepsilon
y_{k+1}\leftarrow y_{k+1}+\frac{\delta}{2}v_{k+1}
\hat{x}\leftarrow\hat{x}_{\theta}(y_{K}|\xi)
p(y|\xi)
\begin{split}dv_{t}&=-\gamma v_{t}dt+g_{\theta}(y_{t}|\xi)dt+\sqrt{2\gamma}\,%
dB_{t},\\
dy_{t}&=v_{t}dt,\end{split}
(dB_{t})_{t\geq 0}
\mathbb{R}^{d_{x}}
\gamma
y_{k}
K
\hat{x}_{K}=\hat{x}_{\theta}(y_{K}|\xi)
\uparrow
\downarrow
\uparrow
\downarrow
\downarrow
\downarrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K
\hat{x}
\xi
\delta
\hat{x}_{k+1}\leftarrow\hat{x}_{\theta}(y_{k+1}|\xi)
\Delta k
\Delta k=100
<30\%
\mathbb{R}^{7\times 64\times 64\times 64}
\mathbb{R}^{4\times 64\times 64\times 64}
[-1,1]
[0,2\pi)
\hat{x}_{i,k}
\xi_{i}
\hat{x}_{i,k}
\xi_{i}
E_{\rm lig}
E_{\rm poc}
c_{e}=16
\mathbb{R}^{d_{e}},d_{e}=c_{e}\times 64^{3}
3\times 3\times 3
d_{x}=7\times 64^{3}
\sigma=0.9
\sigma=1.0
10^{-5}
10^{-2}
\beta_{1}=.9
\beta_{2}=.999
.999
K=500
\delta=\sigma/2
\gamma=1/\delta
1
102.5
205.8
161.9
188.3
5.1
5.3
4.2
5.8
15.4
10.8
7.1
4.7
\sigma=.9
\sigma=1.0
\sigma=0.9
V_{a}(d,r_{a})=\text{exp}\Big{(}-\frac{d^{2}}{(.93\cdot r_{a})^{2}}\Big{)},
V_{a}
a
r_{a}
d
r_{a}=.5
\text{Occ}_{i,j,k}=1-\prod_{n=1}^{N_{a}}\big{(}1-V_{a_{n}}(\|C_{i,j,k}-x_{n}\|%
,r_{a_{n}})\big{)},
\{a_{n}\}_{n=1}^{N_{a}}
C_{i,j,k}
x_{n}
n
64^{3}
.25
d_{x}=7\times 64\times 64\times 64
d_{z}=4\times 64\times 64\times 64
\pi
y_{0}
y_{400}
y_{400}
\hat{x}_{500}
50
50
0.1
0
\sigma=0.9
\sigma=0.9
\downarrow
\downarrow
\downarrow
\downarrow
\hat{x}_{i,k}
\xi_{i}
\hat{x}_{i,k}
\xi_{i}
\hat{x}_{i,k}
\xi_{i}
\hat{x}_{i,k}
\xi_{i}
