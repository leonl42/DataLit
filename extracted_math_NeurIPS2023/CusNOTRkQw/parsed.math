3.08\%
\bm{\mu}_{l}(\mathcal{T};\bm{p})
\bm{\sigma^{2}}_{l}(\mathcal{T};\bm{p})
\bm{\hat{\mu}}_{l}
\bm{\hat{\sigma}^{2}}_{l}
\blacktriangle_{1}
\rightarrow
\blacktriangle_{2}
\mathcal{T}
\bm{p}
l
\bm{\mu}_{l}(\mathcal{T};\bm{p})
\bm{\sigma^{2}}_{l}(\mathcal{T};\bm{p})
\bm{\hat{\mu}}_{l}
\bm{\hat{\sigma}^{2}}_{l}
\blacktriangle_{1}
\rightarrow
\blacktriangle_{2}
\mathcal{T}
\bm{p}
l
3.08\%
1.82\%
8
10
\mathcal{F}_{v}
\mathcal{F}_{t}
{\theta}_{\mathtt{CLIP}}=\{\theta_{v},\theta_{t}\}
{X}
M
\bm{\tilde{X}}_{0}=\{{\textsc{cls}},\bm{e}_{1},\bm{e}_{2},\ldots,\bm{e}_{M}\}
e_{i}
i^{th}
\mathcal{F}_{v}
\bm{\tilde{f}_{v}}=\mathcal{F}_{v}(\bm{\tilde{X}}_{0},\theta_{v})
{y}
\bm{\tilde{Y}}_{0}=\{{\textsc{sos}},\bm{t}_{1},\bm{t}_{2},\ldots,\bm{t}_{L},%
\bm{c}_{k},{\textsc{eos}}\}
{\bm{t}_{l}|_{l=1}^{L}}
\bm{c}_{k}
{\mathcal{F}_{t}}
\bm{\tilde{Y}}
\bm{\tilde{f}_{t}}=\mathcal{F}_{t}(\bm{\tilde{Y}}_{0},\theta_{t})
y=\{1,2,\cdots,C\}
\bm{s_{i}}=\mathtt{sim}(\bm{\tilde{f}_{t}}\cdot\bm{\tilde{f}_{v}})
\mathtt{sim}(.)
{X}
p(y_{i}|{X})=\frac{\mathtt{exp}(\mathtt{sim}(\bm{\tilde{f}_{t}}\cdot\bm{\tilde%
{f}_{v}})\tau)}{\sum_{i=1}^{K}\mathtt{exp}(\mathtt{sim}(\bm{\tilde{f}_{t}}%
\cdot\bm{\tilde{f}_{v}})\tau)}
\tau
V
T
\bm{p_{v}}=\{\bm{p_{v}}^{1},\bm{p_{v}}^{2},\ldots,\bm{p_{v}}^{V}\}
\bm{p_{t}}
\{\bm{p_{t}}^{1},\bm{p_{t}}^{2},\ldots,\bm{p_{t}}^{T}\}
\bm{\tilde{X}^{p}}_{0}=\{{\textsc{cls}},\bm{p_{v}},\bm{e}_{1},\bm{e}_{2},%
\ldots,\bm{e}_{M}\}
\bm{\tilde{f}^{p}_{v}}
\bm{\tilde{Y}^{p}}_{0}=\{{\textsc{sos}},\bm{p_{t}},\bm{t}_{1},\bm{t}_{2},%
\ldots,\bm{t}_{L},\bm{c}_{k},{\textsc{eos}}\}
\bm{\tilde{f}^{p}_{t}}
\bm{p}
X_{\text{test}}
\bm{p}
\displaystyle\mathcal{L}_{\text{entropy}}=\text{arg}\min_{\bm{p}}-\sum_{i=1}^{%
C}\tilde{p}_{\bm{p}}(y_{i}|X_{\text{test}})\log\tilde{p}_{\bm{p}}(y_{i}|X_{%
\text{test}}),
\displaystyle\mathcal{L}_{\text{entropy}}=\text{arg}
\displaystyle\min_{\bm{p}}-\sum_{i=1}^{C}\tilde{p}_{\bm{p}}(y_{i}|X_{\text{%
test}})\log\tilde{p}_{\bm{p}}(y_{i}|X_{\text{test}}),
\tilde{p}_{\bm{p}}(y_{i}|X_{\text{test}})
X_{\text{test}}
N_{k}
{\mathcal{H}}
N_{k}
\mathcal{T}
\mathcal{D}
\displaystyle\bm{\mu}_{l}(\mathcal{T};\bm{p})=\frac{1}{N_{k}}\sum_{\mathrm{x}%
\in\mathcal{H}(X)}\bm{\tilde{X}^{p}}_{l,\mathrm{x}}\quad,
\displaystyle\bm{\mu}_{l}(\mathcal{T};\bm{p})=\frac{1}{N_{k}}\sum_{\mathrm{x}%
\in\mathcal{H}(X)}\bm{\tilde{X}^{p}}_{l,\mathrm{x}}\quad,
\displaystyle\bm{\sigma^{2}}_{l}(\mathcal{T};\bm{p})=\frac{1}{N_{k}}\sum_{%
\mathrm{x}\in\mathcal{H}(X)}\bigg{(}\bm{\tilde{X}^{p}}_{l,\mathrm{x}}-\bm{\mu}%
_{l}(\mathcal{T};\bm{p})\bigg{)}^{2},
\displaystyle\bm{\sigma^{2}}_{l}(\mathcal{T};\bm{p})=\frac{1}{N_{k}}\sum_{%
\mathrm{x}\in\mathcal{H}(X)}\bigg{(}\bm{\tilde{X}^{p}}_{l,\mathrm{x}}-\bm{\mu}%
_{l}(\mathcal{T};\bm{p})\bigg{)}^{2},
\bm{\mu}_{l}(\mathcal{T};\bm{p})
\bm{\sigma^{2}}_{l}(\mathcal{T};\bm{p})
l
\bm{\tilde{X}^{p}}_{l,\mathrm{x}}
l
\mathrm{x}
l
\displaystyle\bm{\hat{\mu}}_{l}=\bm{\mu}_{l}(\mathcal{D},{\theta}_{v})\quad%
\text{and}\quad\bm{\hat{\sigma}^{2}}_{l}=\bm{\sigma}^{2}_{l}(\mathcal{D},{%
\theta}_{v})\quad,
\displaystyle\bm{\hat{\mu}}_{l}=\bm{\mu}_{l}(\mathcal{D},{\theta}_{v})\quad%
\text{and}\quad\bm{\hat{\sigma}^{2}}_{l}=\bm{\sigma}^{2}_{l}(\mathcal{D},{%
\theta}_{v})\quad,
{\theta_{v}}
\displaystyle\mathcal{L}_{\text{align}}=\frac{1}{L}\sum_{l=1}^{L}\bigg{(}\|\bm%
{\mu}_{l}(\mathcal{T};\bm{p})-\bm{\hat{\mu}}_{l}\|_{1}+\|\bm{\sigma^{2}}_{l}(%
\mathcal{T};\bm{p})-\bm{\hat{\sigma}^{2}}_{l}\|_{1}\bigg{)}.
\displaystyle\mathcal{L}_{\text{align}}=\frac{1}{L}\sum_{l=1}^{L}\bigg{(}\|\bm%
{\mu}_{l}(\mathcal{T};\bm{p})-\bm{\hat{\mu}}_{l}\|_{1}+\|\bm{\sigma^{2}}_{l}(%
\mathcal{T};\bm{p})-\bm{\hat{\sigma}^{2}}_{l}\|_{1}\bigg{)}.
{L}_{1}
\mathcal{L}_{\text{align}}
\mathcal{L}_{\text{final}}
\bm{p}
\displaystyle\mathcal{L}_{\text{final}}=\mathcal{L}_{\text{entropy}}+\beta%
\mathcal{L}_{\text{align}}\quad,
\displaystyle\mathcal{L}_{\text{final}}=\mathcal{L}_{\text{entropy}}+\beta%
\mathcal{L}_{\text{align}}\quad,
\beta
\mathcal{L}_{\text{final}}
\mathcal{L}_{\text{entropy}}
\mathcal{L}_{\text{align}}
\mathcal{L}_{\text{entropy}}
\mathcal{L}_{\text{align}}
16
2
3
10\%
5e^{-4}
0.04
\beta
100
60.28\%
62.31\%
1.24\%
0.71\%
0.42\%
\beta
\beta=100
\beta
\beta=100
\checkmark
\text{PromptAlign}^{\dagger}
\checkmark
\checkmark
\checkmark
\text{PromptAlign}^{\dagger}
\text{PromptAlign}^{\dagger}
L_{1}
L_{2}
L_{1}
\beta
\beta
100
\beta=100
\beta
1e^{-5}
0.216s
0.197s
64
1\rightarrow 3
1\rightarrow 3
\dagger
\text{PromptAlign}^{\ddagger}
\text{PromptAlign}^{\ddagger}
\text{PromptAlign}^{\ddagger}
\text{PromptAlign}^{\ddagger}
\beta
\beta
\beta
\beta
\beta
