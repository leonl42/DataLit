\times
128\times 128
(Y,Z)
Y
Z
X=Y+G(Z)
G(Z)
H(X;\theta)
(Y,Z)
\times
(Y,Z)
Y
Z
X=Y+G(Z)
G(Z)
H(X;\theta)
(Y,Z)
\times
\times
\displaystyle p(x;\theta)=\frac{1}{\mathcal{Z}(\theta)}\exp\{-U(x;\theta)\}
\displaystyle p(x;\theta)=\frac{1}{\mathcal{Z}(\theta)}\exp\{-U(x;\theta)\}
U(x;\theta)
\theta
\mathcal{Z}(\theta)
q(x)
\operatorname*{arg\,min}_{\theta}D_{KL}(q(x)\,\|\,p(x;\theta))
\displaystyle\nabla\mathcal{L}(\theta)\approx\frac{1}{n}\sum_{i=1}^{n}\nabla_{%
\theta}U(X_{i}^{+};\theta)-\frac{1}{n}\sum_{i=1}^{n}\nabla_{\theta}U(X_{i}^{-}%
;\theta)
\displaystyle\nabla\mathcal{L}(\theta)\approx\frac{1}{n}\sum_{i=1}^{n}\nabla_{%
\theta}U(X_{i}^{+};\theta)-\frac{1}{n}\sum_{i=1}^{n}\nabla_{\theta}U(X_{i}^{-}%
;\theta)
\{X_{i}^{+}\}_{i=1}^{n}
\{X_{i}^{-}\}_{i=1}^{n}
p(x;\theta)
K
\displaystyle X^{(k+1)}=X^{(k)}-\frac{\varepsilon^{2}}{2}\nabla_{X^{(k)}}U(X^{%
(k)};\theta)+\varepsilon V_{k},
\displaystyle X^{(k+1)}=X^{(k)}-\frac{\varepsilon^{2}}{2}\nabla_{X^{(k)}}U(X^{%
(k)};\theta)+\varepsilon V_{k},
\varepsilon
V_{k}\sim N(0,I)
\{X^{-}_{i,0}\}_{i=1}^{n}
G(z)
Z\in\mathbb{R}^{m}
m
Y\in\mathbb{R}^{d}
d
U(Y,Z;\theta)=H(G(Z)+Y;\theta)
H(x;\theta)
x\in\mathbb{R}^{d}
H
\theta
H
G
Y
G(Z)
G(Z)
Y
X=G(Z)+Y
G(Z)
Y
G
G(Z)
U(G(Z);\theta)
Z
X
X
X=G(Z)+Y
(Y,Z)
q(y,z)
\theta
H(x;\theta)
\operatorname*{arg\,min}_{\theta}D_{KL}(q(y,z)||p(y,z;\theta))
\displaystyle p(y,z;\theta)=\frac{1}{\mathcal{Z}(\theta)}\exp\{-H(G(z)+y;%
\theta)\}.
\displaystyle p(y,z;\theta)=\frac{1}{\mathcal{Z}(\theta)}\exp\{-H(G(z)+y;%
\theta)\}.
\displaystyle Y^{(k+1)}=Y^{(k)}-\frac{\varepsilon_{1}^{2}}{2}\nabla_{Y^{(k)}}H%
(G(Z^{(k)})+Y^{(k)};\theta)+\varepsilon_{1}V_{k,1}
\displaystyle Y^{(k+1)}
\displaystyle=Y^{(k)}-\frac{\varepsilon_{1}^{2}}{2}\nabla_{Y^{(k)}}H(G(Z^{(k)}%
)+Y^{(k)};\theta)+\varepsilon_{1}V_{k,1}
\displaystyle Z^{(k+1)}=Z^{(k)}-\frac{\varepsilon_{2}^{2}}{2}\nabla_{Z^{(k)}}H%
(G(Z^{(k)})+Y^{(k+1)};\theta)+\varepsilon_{2}V_{k,2}
\displaystyle Z^{(k+1)}
\displaystyle=Z^{(k)}-\frac{\varepsilon_{2}^{2}}{2}\nabla_{Z^{(k)}}H(G(Z^{(k)}%
)+Y^{(k+1)};\theta)+\varepsilon_{2}V_{k,2}
z
y
p(y,z;\theta)
\theta
\displaystyle\nabla\mathcal{L}(\theta)\approx\frac{1}{n}\sum_{i=1}^{n}\nabla_{%
\theta}H(X_{i}^{+};\theta)-\frac{1}{n}\sum_{i=1}^{n}\nabla_{\theta}H(G(Z_{i}^{%
-})+Y_{i}^{-};\theta)
\displaystyle\nabla\mathcal{L}(\theta)\approx\frac{1}{n}\sum_{i=1}^{n}\nabla_{%
\theta}H(X_{i}^{+};\theta)-\frac{1}{n}\sum_{i=1}^{n}\nabla_{\theta}H(G(Z_{i}^{%
-})+Y_{i}^{-};\theta)
X_{i}^{+}
(Y_{i}^{-},Z_{i}^{-})
X_{i}^{+}
H(x;\theta)
(Y_{i}^{+},Z_{i}^{+})
G(z)
X
Y
Z
X
p_{0}(z)
Z
G
p_{0}
N(0,I)
p(y|z;\theta)=\frac{1}{\mathcal{Z}_{z}(\theta)}\exp\{-H(G(z)+y;\theta)\}
\displaystyle p(y,z;\theta)=\frac{1}{\mathcal{Z}_{z}(\theta)}\,p_{0}(z)\exp\{-%
H(G(z)+y;\theta)\}.
\displaystyle p(y,z;\theta)=\frac{1}{\mathcal{Z}_{z}(\theta)}\,p_{0}(z)\exp\{-%
H(G(z)+y;\theta)\}.
X
X=G(Z)+Y
q(y,z)=p_{0}(z)q(y|z)
(Z_{i}^{-},Y_{i}^{-})
Z_{i}^{-}
p_{0}(z)
Y_{i}^{-}|Z_{i}^{-}
p(y|z;\theta)
p(y|z;\theta)=p(y|G(z);\theta)
\theta
X_{i}^{+}
H(x;\theta)
Z_{i}^{+}
X_{i}^{+}
p_{0}(z)
Y_{0}=0
Z\sim N(0,I)
K
Y_{K}
Z
G(z)
\phi
G(z;\phi)
\theta
H(x;\theta)
\hat{Z}
X
G(z;\phi)
Z
\hat{Z}
G(z;\phi)
X_{K}
U(x;\theta)
X_{0}=G(Z_{0};\phi)
Z_{0}\sim N(0,I)
X
Z\sim N(0,I)
X|Z\sim N(G(Z;\phi),\tau^{2}I)
\tau>0
X_{K}
G(z;\phi)
Z|X_{K}
Z_{k+1}=Z_{k}-\frac{\varepsilon^{2}}{2}\left(Z_{k}+\frac{1}{2\tau^{2}}\nabla_{%
Z_{k}}\|G(Z_{k};\phi)-X_{K}\|_{2}^{2}\right)+\varepsilon V_{k}
\phi
\nabla\mathcal{L}_{G}(\phi)\approx\frac{1}{n}\sum_{i=1}^{n}\frac{1}{2\tau^{2}}%
\nabla_{\phi}\|G(Z_{K,i};\phi)-X_{K,i}\|_{2}^{2}
i
i
n
Z_{0}\sim N(0,I)
Z_{K}
Z_{K}
Z|X_{K}
Z
H(x;\theta)
Z
Y
p(Y|Z;\theta,\phi)=p(Y|G(Z;\phi);\theta)
X^{+}
X^{-}=Y+G(Z;\phi)
\theta
(X^{\prime},Z^{\prime})
\phi
(X^{\prime},Z^{\prime})
(X,Z)
H(x;\theta)
Z
Y
p(Y|Z;\theta,\phi)=p(Y|G(Z;\phi);\theta)
X^{+}
X^{-}=Y+G(Z;\phi)
\theta
(X^{\prime},Z^{\prime})
\phi
(X^{\prime},Z^{\prime})
(X,Z)
\phi_{t}
\theta_{t}
t
Z\sim N(0,I)
X|Z\sim N(G(Z;\phi),\tau^{2}I)
(X,Z)
Z\sim N(0,I)
X=Y_{K}+G(Z;\phi_{t})
Y_{K}|Z
K
p(y|z;\theta_{t},\phi_{t})\propto\exp\{-H(G(z;\phi_{t})+y;\theta_{t})\}
Y_{K}
Z
\phi
\phi_{t+1}=\operatorname*{arg\,min}_{\phi}\frac{1}{2\tau^{2}}E_{p_{0}(z)p(y|z;%
\theta_{t},\phi_{t})}\left[\|G(Z;\phi)-(Y+G(Z;\phi_{t}))\|_{2}^{2}\right].
G(Z;\phi)
X=Y+G(Z;\phi_{t})
G(Z;\phi_{t})
H(x;\theta_{t})
G(Z;\phi_{t+1})\approx Y+G(Z;\phi_{t})
Y|Z
\phi
H
G
\phi=\phi_{t}
\phi_{t+1}
G(z;\phi_{t})
G(z;\phi)
t+1
H(x;\theta_{t_{\ell}})
G(z;\phi_{t_{\ell}})
t_{1},t_{2},\dots t_{L}\leq t
H(x;\theta_{t})
G(z;\phi_{t})
(X,Z)
t_{\ell}
\{t_{1},\dots,t_{L}\}
Z\sim N(0,I)
X_{K}=Y_{K}+G(Z;\phi_{t_{\ell}})
Y|Z
H(G(Z;\phi_{t_{\ell}})+Y;\theta_{t_{\ell}})
\phi_{t}
\phi_{t_{\ell}}
(t_{\ell},Z,X_{K})
(X,Z)
n=128
n=128
\{t_{1},\dots,t_{L}\}
t
X
\phi_{t_{\ell}}
G
32\times 32
64\times 64
D
G
U(z)=D(G(z))+\frac{1}{2}\|z\|_{2}^{2}
D
G
G(z)
Y
Z
Y_{0}=0
Z_{0}\sim N(0,I)
Z
\pm
\pm
\pm
\pm
\pm
\pm
Y
Y
Y
Y
X
G(Z)
Y
Y_{0}=0
Y
Y
Y
G(Z)
G(Z)
Y
X
G(Z)
Y
Y_{0}=0
Y
Y
Y
G(Z)
G(Z)
Y
G(z)
G(z)
G(z)
Y
p_{0}(y)\propto\exp\{-\frac{1}{2\sigma^{2}}\|y\|^{2}_{2}\}
Y
G(z)
X
I
Z=I(X)
\hat{X}=G(Z)
\|\hat{X}-X\|_{2}^{2}
I(X)
m
\sqrt{m}
\|I(X)\|_{2}=\sqrt{m}
Z
\hat{X}
Z
Z
Y_{0}=0
Z_{0}\sim N(0,I)
K=100
\pm
32\times 32
\times
\times
\dagger
\dagger
32\times 32
\pm
\dagger
\dagger
64\times 64
\pm
128\times 128
\pm
\pm
32\times 32
64\times 64
128\times 128
128\times 128
\times
H(X;\theta)
\times
\sqrt{m}
m
32\times 60=1920
8\times 130=1040
\times
\times
36\times 128=4608
8\times 4\times 3\times 730=70080
15\times 1920=28800
X
X\sim Y+G(Z)
(Y,Z)
U(y,z;\theta)=H(Y+G(Z);\theta)
Y
H
Y+G(Z)
G
H
X
X=Y+G(Z)
Z\sim N(0,I)
U(Y|Z;\theta)=H(Y+G(Z);\theta)
H
Y
\times
(X,Z)
(t_{\ell},X,Z)
X=Y_{K}+G(Z;\phi_{t_{\ell}})
Y_{K}|Z
p(Y|Z,t_{\ell})\propto-\exp\{H(Y+G(Z;\phi_{t_{\ell}});\theta_{t_{\ell}})\}.
\displaystyle E_{(t_{\ell},Z,X)}[-\log p_{G}(X,Z;\phi)]=E_{(t_{\ell},Z,X)}%
\left[\frac{1}{2\tau^{2}}\|G(Z;\phi)-X\|_{2}^{2}\right]+C
\displaystyle E_{(t_{\ell},Z,X)}[-\log p_{G}(X,Z;\phi)]
\displaystyle=E_{(t_{\ell},Z,X)}\left[\frac{1}{2\tau^{2}}\|G(Z;\phi)-X\|_{2}^{%
2}\right]+C
\displaystyle\approx\frac{1}{n}\sum_{i=1}^{n}\frac{1}{2\tau^{2}}\|G(Z_{i};\phi%
)-(Y_{K,i}+G(Z_{i};\phi_{t_{\ell_{i}}}))\|_{2}^{2}+C
\displaystyle\approx\frac{1}{n}\sum_{i=1}^{n}\frac{1}{2\tau^{2}}\|G(Z_{i};\phi%
)-(Y_{K,i}+G(Z_{i};\phi_{t_{\ell_{i}}}))\|_{2}^{2}+C
n
\{(t_{\ell_{i}},Z_{i},X_{i})\}_{i=1}^{n}
\{x^{+}_{m}\}_{m=1}^{M}
U(x;\theta)
G(z;\phi)
\varepsilon
K
h_{U}
h_{G}
\theta_{0}
\phi_{0}
T
N
\theta_{T}
\phi_{T}
\{Z_{i}\}_{i=1}^{N}
N(0,I)
\{X^{-}_{i}\}_{i=1}^{N}
X_{i}^{-}=g(Z_{i};\phi_{0})
1\leq t\leq T
\{\tilde{X}^{+}_{b}\}_{b=1}^{B}
\{x^{+}_{m}\}_{m=1}^{M}
\{\tilde{Z}_{b}\}_{b=1}^{B}
N(0,I)
\{\tilde{Y}^{-}_{b,0}\}_{b=1}^{B}
\{\tilde{Y}^{-}_{b,0}\}_{b=1}^{B}
K
\{\tilde{Y}^{-}_{b,K}\}_{b=1}^{B}
\tilde{Z}_{b}
\tilde{X}_{b}^{-}=G(\tilde{Z}_{b},\phi_{t-1})+\tilde{Y}^{-}_{b,K}
\{\tilde{X}^{-}_{b}\}_{b=1}^{B}
\Delta^{(t)}_{U}
\{\tilde{X}^{+}_{b}\}_{b=1}^{B}
\{\tilde{X}^{-}_{b}\}_{b=1}^{B}
\theta_{t}
\Delta^{(t)}_{U}
h_{U}
\{i_{1},\dots,i_{B}\}\subset\{1,\dots,N\}
\{Z_{i_{b}}\}_{b=1}^{B}
\{X^{-}_{i_{b}}\}_{b=1}^{B}
\{Z_{i}\}_{i=1}^{N}
\{X^{-}_{i}\}_{i=1}^{N}
\Delta^{(t)}_{G}
\{Z_{i_{b}}\}_{b=1}^{B}
\{X^{-}_{i_{b}}\}_{b=1}^{B}
\phi_{t}
\Delta^{(t)}_{G}
h_{G}
\{Z_{i_{b}}\}_{b=1}^{B}
\{X^{-}_{i_{b}}\}_{b=1}^{B}
Z_{i_{b}}\leftarrow\tilde{Z}_{b}
X^{-}_{i_{b}}\leftarrow\tilde{X}_{b}^{-}
Y
U(z;\theta)=H(G(z);\theta)
X^{+}=G(Z^{+})
Z^{+}
Y
X^{+}
X^{+}
Z^{+}
X^{+}\approx G(Z^{+})
Y
Y
Y
Z
Y
Z
Z
\sigma
\sigma
32\times 32
32\times 32
64\times 64
64\times 64
128\times 128
128\times 128
