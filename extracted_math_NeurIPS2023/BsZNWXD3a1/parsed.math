f_{I}
g_{T}
g_{T}
g_{T}(\mathbf{T}_{i})
i
i
\mathbf{I}
p(y{=}i|\mathbf{I}){=}\frac{\exp(\langle g_{T}(\mathbf{T}_{i}),f_{I}(\mathbf{I%
})\rangle/\tau)}{\sum_{j{=}1}^{K}\exp(\langle g_{T}(\mathbf{T}_{j}),f_{I}(%
\mathbf{I})\rangle/\tau)},
\langle g_{T}(\mathbf{T}_{i}),f_{I}(\mathbf{I})\rangle
f_{I}(\mathbf{I})
g_{T}(\mathbf{T}_{i})
i
K
\tau
M
\bm{V}{{=}}\{\bm{v}_{1},\bm{v}_{2},\ldots,\bm{v}_{M}\}
\bm{T}_{i}{{=}}\{\bm{v}_{1},\bm{v}_{2},\ldots,\bm{v}_{M},\bm{c}_{i}\}
\bm{V}
\bm{c}_{i}
g_{T}(\cdot)
\bm{V}
\mathcal{L}_{\text{CE}}(\bm{V}){{=}}-\sum_{i}\bm{y}_{i}\log p(\bm{T}_{i}|\bm{I%
}),
\bm{y}_{i}
i
\bm{V}
q(\mathbf{x}_{t}|\mathbf{x}_{t-1})
t
\mathbf{x}_{0}\sim q(\mathbf{x}_{0})
\displaystyle q(\mathbf{x}_{T}|\mathbf{x}_{0}):{=}\prod_{t{=}1}^{T}q(\mathbf{x%
}_{t}|\mathbf{x}_{t-1}),
\displaystyle q(\mathbf{x}_{T}|\mathbf{x}_{0}):{=}\prod_{t{=}1}^{T}q(\mathbf{x%
}_{t}|\mathbf{x}_{t-1}),
q(\mathbf{x}_{t}|\mathbf{x}_{t-1}):{=}\mathcal{N}(\mathbf{x}_{t};\sqrt{1-\beta%
_{t}}\mathbf{x}_{t-1},\beta_{t}{\bm{I}})
\{\beta\}_{t{=}0}^{T}
\alpha_{t}{:{=}}1{-}\beta_{t}
\bar{\alpha_{t}}{:{=}}\prod_{s{=}1}^{t}\alpha_{s}
t
\bm{x}_{t}
\mathbf{x}_{t}{=}\sqrt{\bar{\alpha}_{t}}\mathbf{x}_{0}+\sqrt{1-\bar{\alpha}_{t%
}}\bm{\epsilon}
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
\mathbf{x}_{T}\sim\mathcal{N}(\mathbf{x}_{T};\textbf{0},\bm{I})
\displaystyle\mathcal{L}_{\theta}{=}\mathbb{E}_{t,\mathbf{x}_{0},\bm{\epsilon}%
}\Big{[}\|\bm{\epsilon}-\bm{\epsilon}_{\theta}(\sqrt{\bar{\alpha}_{t}}\mathbf{%
x}_{0}+\sqrt{1-\bar{\alpha}_{t}}\bm{\epsilon},t)\|^{2}\Big{]}.
\displaystyle\mathcal{L}_{\theta}{=}\mathbb{E}_{t,\mathbf{x}_{0},\bm{\epsilon}%
}\Big{[}\|\bm{\epsilon}-\bm{\epsilon}_{\theta}(\sqrt{\bar{\alpha}_{t}}\mathbf{%
x}_{0}+\sqrt{1-\bar{\alpha}_{t}}\bm{\epsilon},t)\|^{2}\Big{]}.
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
\displaystyle\mathbf{x}_{t-1}{=}\frac{1}{\sqrt{\alpha_{t}}}\Big{(}\mathbf{x}_{%
t}-\frac{1-\alpha_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\bm{\epsilon}_{\theta}(%
\mathbf{x}_{t},t)\Big{)}+\sigma_{t}\bm{\epsilon}.
\displaystyle\mathbf{x}_{t-1}{=}\frac{1}{\sqrt{\alpha_{t}}}\Big{(}\mathbf{x}_{%
t}-\frac{1-\alpha_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\bm{\epsilon}_{\theta}(%
\mathbf{x}_{t},t)\Big{)}+\sigma_{t}\bm{\epsilon}.
s_{n}
c_{n}
\mathbf{x}_{t_{n}}\approx\mathbf{x}_{t_{n+1}}+c_{n}(t_{n}-t_{n+1})\mathbf{%
\epsilon}_{\theta}(\mathbf{x}_{s_{n}},s_{n}).
s_{n}=\sqrt{t_{n}t_{n+1}}
c_{n}=1
\bm{x}
\bm{V}^{*}
\bm{x}
\bm{V}{=}\{v_{1},v_{2},\ldots,v_{M}\}
\bm{V}^{*}{=}\{v_{1}^{*},v_{2}^{*},\ldots,v_{M}^{*}\}
I
I
\bm{V}^{*}
\tilde{\bm{V}}_{T}\sim\mathcal{N}(0,\bm{I})
\bm{V}^{*}
\tilde{\bm{V}}_{t}^{*}
t
T
\tilde{\bm{V}}_{0}
t
\bm{V}_{t}^{*}
\tilde{\bm{V}}_{t}
\pi
\pi(\theta)
t
\tilde{\bm{V}}_{t}
[\texttt{CLASS}]
\mathcal{L}_{\rm{diff}}
\mathcal{L}_{\rm{CE}}
\mathcal{L}_{\text{diff}}=\left\lVert{\bm{V}}^{*}-\tilde{\bm{V}}_{\theta}\left%
(\sqrt{\bar{\alpha}_{t}}{\bm{V}}^{*}+\sqrt{1-\bar{\alpha}_{t}}\bm{\epsilon},%
\pi,t\right)\right\rVert^{2},
\tilde{\bm{V}}_{\theta}(\cdot,\cdot,\cdot)
{\bm{V}}^{*}
\pi
t
\hat{\mathbf{y}}
\tilde{\bm{V}}_{t}
\displaystyle\mathcal{L}_{\rm{final}}=\sum_{(x,y)}\Big{[}-\mathbb{E}{q_{(%
\tilde{\bm{V}}_{t}|\tilde{\bm{V}}_{t+1},\pi)}}\big{[}\log p(\mathbf{y}|\mathbf%
{x},\tilde{\bm{V}}_{t})\big{]}
\displaystyle\mathcal{L}_{\rm{final}}
\displaystyle=\sum_{(x,y)}\Big{[}-\mathbb{E}{q_{(\tilde{\bm{V}}_{t}|\tilde{\bm%
{V}}_{t+1},\pi)}}\big{[}\log p(\mathbf{y}|\mathbf{x},\tilde{\bm{V}}_{t})\big{]}
\displaystyle+\beta\left\lVert{\bm{V}}^{*}-\tilde{\bm{V}}_{\theta}\left(\sqrt{%
\bar{\alpha}_{t}}{\bm{V}}^{*}+\sqrt{1-\bar{\alpha}_{t}}\bm{\epsilon},\pi,t%
\right)\right\rVert^{2},
\displaystyle+\beta\left\lVert{\bm{V}}^{*}-\tilde{\bm{V}}_{\theta}\left(\sqrt{%
\bar{\alpha}_{t}}{\bm{V}}^{*}+\sqrt{1-\bar{\alpha}_{t}}\bm{\epsilon},\pi,t%
\right)\right\rVert^{2},
\beta
\tilde{\bm{V}_{t}^{*}}
\pi
t
\tilde{\bm{V}_{t}}
\tilde{\bm{V}}_{T}
\tilde{\bm{V}}_{t}
t
\tilde{\bm{V}}_{t-1}
\pi
t
\tilde{\bm{V}_{0}}
T
\tilde{\bm{V}_{t}^{*}}
\pi
t
\tilde{\bm{V}_{t}}
\tilde{\bm{V}}_{T}
\tilde{\bm{V}}_{t}
t
\tilde{\bm{V}}_{t-1}
\pi
t
\tilde{\bm{V}_{0}}
T
\tilde{\bm{V}}_{T}
\pi
x
\pi
\epsilon
\mathcal{N}(\textbf{0},\textbf{I})
\tilde{\bm{V}}_{T}
\pi
\epsilon
\tilde{\bm{V}}_{T-1}
\tilde{\bm{V}}_{\theta}(\tilde{\bm{V}}_{T},\pi,T)
T
\tilde{\bm{V}}_{0}{=}\tilde{\bm{V}}_{\theta}(\tilde{\bm{V}}_{1},\pi,t_{0})
\tilde{\bm{V}}_{0}
M
\tilde{\bm{V}}^{*}
\pi
t
t
\pi
\bm{V}^{*}
\pi
\epsilon
\mathcal{N}(0,I)
\bm{V}^{*}
\mathbf{V}_{t-1}
\mathbf{V}_{t}
x
y
\mathbf{c}
\{\mathbf{V}_{0},\mathbf{c}\}
x
\mathbf{V}_{t-1}
\mathbf{V}_{t}
x
y
\mathbf{c}
\{\mathbf{V}_{0},\mathbf{c}\}
x
\mathbf{V}_{t-1}
\mathbf{V}_{t}
x
y
\mathbf{c}
\{\mathbf{V}_{0},\mathbf{c}\}
x
