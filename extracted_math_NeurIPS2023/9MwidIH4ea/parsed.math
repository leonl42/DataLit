n
D=\{(x_{1},y_{1}),(x_{2},y_{2}),...,(x_{n},y_{n})\}
x_{i}
i
y_{i}
s
d
E
p
s=\operatorname{argmax}_{s}P_{LLM}(s|p,d,E),
E\subset D
|E|\ll|D|
P_{LLM}
s
E
x_{i}
\tilde{y}_{i}
\tilde{y}_{i}=f_{\theta}([s,x_{i}])
f_{\theta}(\cdot)
\theta
[\cdot,\cdot]
s_{0}
\tilde{y}_{0}=f_{\theta}([s_{0},x])
\mathcal{L}(y,\tilde{y}_{0})
y
\tilde{y}_{0}
\theta
\alpha
\nabla_{\theta}\mathcal{L}(y,\tilde{y}_{0})
\theta_{\text{new}}=\theta-\alpha\nabla_{\theta}\mathcal{L}(y,\tilde{y}_{0}).
k
H=\{(s_{0},m_{0}),(s_{1},m_{1}),...,(s_{k},m_{k})\}
t
H_{t}
j
0<j<k
l
\{s_{j+1},s_{j+2},...,s_{j+l}\}=\operatorname{argmax}_{s}P_{LLM}(s|p,d,E,H_{t}).
s_{n}
\operatorname{metric}(\cdot)
\tilde{y}_{n}=f_{\theta}([s_{n},x]),\ \ m_{n}=\operatorname{metric}(y,\tilde{y%
}_{n}),
\operatorname{metric}(\cdot)
l
H_{t}
H_{t+1}
H_{t+1}=\operatorname{sort}(H_{t}\cup\{(s_{j+1},m_{j+1}),(s_{j+2},m_{j+2}),...%
,(s_{j+l},m_{j+l})\}).
\nabla\mathcal{D}
H
\nabla\mathcal{D}
w
H
H=\{(s_{0},m_{0}),(s_{1},m_{1}),\ldots,(s_{k},m_{k})\}
w
H
i
0\leq i<k-w
\nabla\mathcal{D}_{i}=\{\{(s_{i},m_{i}),\ldots,(s_{i+w-1},m_{i+w-1})\},s_{i+w}\},
d
E
p
\cdot
\cdot
\alpha
2e^{-5}
0.01
k=50
1.0
w=5
5
d
E
H
p
