p
q
\mathcal{X}
\mathcal{Y}
N
\widehat{p}=\{x_{i}\}_{i=1}^{N}\sim p
\widehat{q}=\{x_{i}^{\prime}\}_{i=1}^{N}\sim q
u=(p+q)/2
\widehat{u}=\widehat{p}\cup\widehat{q}
\widehat{p}
\widehat{q}
\widehat{h}_{\widehat{u}}
\widehat{u}=\widehat{p}\cup\widehat{q}
\widehat{\epsilon}_{\widehat{p}}
\widehat{\epsilon}_{\widehat{q}}
\widehat{p}
\widehat{q}
\widehat{\mathcal{D}}_{\text{R}}
\widehat{p}
\widehat{q}
\widehat{h}_{\widehat{u}}
\widehat{u}=\widehat{p}\cup\widehat{q}
\widehat{\epsilon}_{\widehat{p}}
\widehat{\epsilon}_{\widehat{q}}
\widehat{p}
\widehat{q}
\widehat{\mathcal{D}}_{\text{R}}
\mathcal{T}
\mathcal{H}
l
L
|l(\cdot,\cdot)|\leq c
x\in\mathcal{X}
\|x\|\leq B
a\in\mathcal{A}
a(x)=y\in\mathcal{Y}
a(x)=x\in\mathcal{X}
l(h(x),a(x))
h\in\mathcal{H}
x\in\mathcal{X}
h(x)
x
h(x)
u
\widehat{u}
\epsilon_{u}(h)
\widehat{\epsilon}_{\widehat{u}}(h)
h\in\mathcal{H}
\displaystyle\epsilon_{u}(h)=\mathbb{E}_{x\sim u}l(h(x),a(x)),\widehat{%
\epsilon}_{\widehat{u}}(h)=\frac{1}{2N}\sum_{x\in\widehat{u}}l(h(x),a(x)).
\displaystyle\epsilon_{u}(h)
\displaystyle=\mathbb{E}_{x\sim u}l(h(x),a(x)),\widehat{\epsilon}_{\widehat{u}%
}(h)=\frac{1}{2N}\sum_{x\in\widehat{u}}l(h(x),a(x)).
h^{*}_{u}
\widehat{h}_{u}
\displaystyle h^{*}_{u}\in\arg\min_{h\in\mathcal{H}}\epsilon_{u}(h),\widehat{h%
}_{u}\in\arg\min_{h\in\mathcal{H}}\widehat{\epsilon}_{\widehat{u}}(h).
\displaystyle h^{*}_{u}\in\arg\min_{h\in\mathcal{H}}\epsilon_{u}(h),\widehat{h%
}_{u}\in\arg\min_{h\in\mathcal{H}}\widehat{\epsilon}_{\widehat{u}}(h).
\widehat{h}
h^{*}
\widehat{p}
\widehat{q}
\mathcal{H}
l
p=q
p
q
\mathcal{T}
\widehat{p}
\widehat{q}
h^{*}_{u}
u
\widehat{h}_{\widehat{u}}
\widehat{u}
\epsilon_{p}(h^{*}_{u})
\epsilon_{q}(h^{*}_{u})
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{\widehat{u}})
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{\widehat{u}})
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{\widehat{u}})
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{\widehat{u}})
\mathcal{H}
l
p
q
\mathcal{D}_{\text{R}}(p\|q)=d(\epsilon_{p}(h^{*}_{u}),\epsilon_{q}(h^{*}_{u})%
)=|\epsilon_{p}(h^{*}_{u})-\epsilon_{q}(h^{*}_{u})|.
d(\cdot,\cdot)
p=q
u=p=q
h^{*}_{u}
p
q
p\neq q
h^{*}_{u}
u
p
q
\mathcal{D}_{\text{R}}(p\|q)
\widehat{p}
\widehat{q}
\widehat{h}_{u}
\widehat{u}=\widehat{p}\cup\widehat{q}
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})
\mathcal{D}_{\text{R}}(p\|q)
\mathcal{\widehat{D}}_{\text{R}}(p\|q)
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})=d(\widehat{\epsilon%
}_{\widehat{p}}(\widehat{h}_{\widehat{u}}),\widehat{\epsilon}_{\widehat{q}}(%
\widehat{h}_{\widehat{u}}))=|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{%
\widehat{u}})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{\widehat{u}})|.
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})
\mathcal{D}_{\text{R}}(p\|q)
\widehat{h}_{u}
\widehat{u}
\widehat{h}_{u}
\widehat{p}
\widehat{q}
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})
\widehat{p}
\widehat{q}
\widehat{u}
\widehat{p}
\widehat{q}
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})
\mathcal{D}_{\text{R}}(p\|q)
\mathcal{D}_{\textup{L}}(p\|q)
\mathcal{D}_{\textup{L}}(p\|q)=\sup_{h\in\mathcal{H}}(|\epsilon_{p}(h)-%
\epsilon_{q}(h)|).
\mathcal{R}_{\mathcal{H}}^{l}(\widehat{u})
\mathcal{R}_{\mathcal{H}}^{l}(\widehat{u})\equiv\frac{1}{2N}\mathbb{E}_{%
\boldsymbol{\sigma}\sim\{\pm 1\}^{2N}}\left[\sup_{h\in\mathcal{H}}\sum_{x\in%
\widehat{u}}\sigma l(h(x),a(x))\right].
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})
\mathcal{D}_{\text{R}}(p\|q)
x\in\mathcal{X}
h\in\mathcal{H}
a\in\mathcal{A}
|l(h(x),a(x))|\leq c
1-\delta
|\mathcal{D}_{\text{R}}(p\|q)-\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|%
\widehat{q})|\leq 2\mathcal{D}_{\textup{L}}(p\|q)+2\mathcal{R}_{\mathcal{H}}^{%
l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{q})+12c\sqrt{\frac{\ln%
(8/\delta)}{N}}.
\sqrt{\textup{Var}\left[\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat%
{q})\right]}
\displaystyle\frac{34c}{\sqrt{N}}+\sqrt{2\pi}\left(2\mathcal{D}_{\textup{L}}(p%
\|q)+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l%
}(\widehat{q})\right).
\displaystyle\frac{34c}{\sqrt{N}}+\sqrt{2\pi}\left(2\mathcal{D}_{\textup{L}}(p%
\|q)+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l%
}(\widehat{q})\right).
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})
\mathcal{H}
D
\mathcal{X}
M_{1},\ldots,M_{D}
1-\delta
\displaystyle|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}%
}(\widehat{p}\|\widehat{q})|\leq 2\mathcal{D}_{\textup{L}}(p\|q)+\frac{4LB(%
\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i}}{\sqrt{N}}+12c\sqrt{\frac{\ln(8/\delta)}%
{N}}.
\displaystyle|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}%
}(\widehat{p}\|\widehat{q})|\leq 2\mathcal{D}_{\textup{L}}(p\|q)+\frac{4LB(%
\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i}}{\sqrt{N}}+12c\sqrt{\frac{\ln(8/\delta)}%
{N}}.
D_{\textup{L}}(p\|q)
1-\delta
\mathcal{D}_{\textup{L}}(p\|q)\leq\left|\epsilon_{u}(h^{*}_{u})-\epsilon_{u}(%
\widehat{h}_{u})\right|
\displaystyle|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}%
}(\widehat{p}\|\widehat{q})|\leq\frac{8LB(\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i%
}}{\sqrt{N}}+22c\sqrt{\frac{\ln(16/\delta)}{N}}.
\displaystyle|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}%
}(\widehat{p}\|\widehat{q})|\leq\frac{8LB(\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i%
}}{\sqrt{N}}+22c\sqrt{\frac{\ln(16/\delta)}{N}}.
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})
\mathcal{D}_{\textup{R}}(p\|q)
N
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})
N\rightarrow\infty
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\leq 2\mathcal{D}_%
{\textup{L}}(p\|q)+\mathcal{D}_{\textup{R}}(p\|q).
\mathcal{D}_{\textup{L}}(p||q)
\mathcal{D}_{\textup{R}}(p\|q)
\widehat{p}=\{x_{i}\}_{i=1}^{N}\sim p
\widehat{q}=\{x_{i}^{\prime}\}_{i=1}^{N}\sim q
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})
\mathcal{D}_{\textup{R}}(p\|q)
p\neq q
p\neq q
p\neq q
p=q
\widehat{p}
\widehat{q}
p\neq q
\alpha\in[0,1]
p\neq q
\widehat{p}
\widehat{q}
\widehat{p}
\widehat{q}
Z
\{(\widehat{p}^{z},\widehat{q}^{z})\}_{z=1}^{Z}
\widehat{p}
\widehat{q}
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})
p=q
\widehat{p}
\widehat{q}
\widehat{p}
\widehat{q}
1
p\neq q
0
\alpha
p\neq q
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})
\alpha
\mathcal{G}=\{\mathcal{\widehat{D}}_{\textup{R}}(\widehat{p}^{z}\|\widehat{q}^%
{z})\}_{z=1}^{Z}
K
(\widehat{p},\widehat{q})
\alpha=0.05
Z=100
K=100
p
q
N=200
p
q
N=200
\epsilon_{p}(h_{p})
\epsilon_{q}(h_{q})
|\epsilon_{p}(h_{p})-\epsilon_{q}(h_{q})|
h_{p}=h_{q}\in\mathcal{H}
h_{p}\in\arg\min_{h\in\mathcal{H}}\epsilon_{p}(h)
h_{q}\in\arg\min_{h\in\mathcal{H}}\epsilon_{q}(h)
h_{p}=h_{q}\in\arg\min_{h\in\mathcal{H}}\epsilon_{\frac{p+q}{2}}(h)
p
q
p
q
\pm
\alpha=0.05
N
\pm
\alpha=0.05
N
{\scriptsize\pm\text{0.007}}
{\scriptsize\pm\text{0.019}}
{\scriptsize\pm\text{0.012}}
{\scriptsize\pm\text{0.041}}
{\scriptsize\pm\text{0.691}}
{\scriptsize\pm\text{0.041}}
{\scriptsize\pm\text{0.022}}
{\scriptsize\pm\text{0.026}}
{\scriptsize\pm\text{0.025}}
{\scriptsize\pm\text{0.044}}
{\scriptsize\pm\text{0.038}}
{\scriptsize\pm\text{0.066}}
{\scriptsize\pm\text{0.015}}
{\scriptsize\pm\text{0.032}}
{\scriptsize\pm\text{0.049}}
{\scriptsize\pm\text{0.037}}
{\scriptsize\pm\text{0.029}}
{\scriptsize\pm\text{0.070}}
{\scriptsize\pm\text{0.014}}
{\scriptsize\pm\text{0.017}}
{\scriptsize\pm\text{0.058}}
{\scriptsize\pm\text{0.045}}
{\scriptsize\pm\text{0.020}}
{\scriptsize\pm\text{0.050}}
{\scriptsize\pm\text{0.050}}
{\scriptsize\pm\text{0.012}}
{\scriptsize\pm\text{0.022}}
{\scriptsize\pm\text{0.018}}
{\scriptsize\pm\text{0.013}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\text{0.013}}
{\scriptsize\pm\text{0.035}}
{\scriptsize\pm\text{0.050}}
{\scriptsize\pm\text{0.047}}
{\scriptsize\pm\text{0.024}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\text{0.020}}
{\scriptsize\pm\text{0.040}}
{\scriptsize\pm\text{0.015}}
{\scriptsize\pm\text{0.010}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
\pm
\alpha=0.05
\pm
\alpha=0.05
{\scriptsize\pm\text{0.118}}
{\scriptsize\pm\text{0.064}}
{\scriptsize\pm\text{0.066}}
{\scriptsize\pm\text{0.135}}
{\scriptsize\pm\text{0.147}}
{\scriptsize\pm\text{0.090}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.097}}
{\scriptsize\pm\textbf{0.160}}
{\scriptsize\pm\textbf{0.040}}
\alpha=0.05
\alpha=0.05
N=5000
N=1000
0
\alpha=0.05
\alpha=0.05
0.5\%
1\%
2\%
5\%
N=1000
N=5000
0.2
20\%
\mathcal{B}
\mathcal{B}_{c}
\mathcal{B}_{n}
\gamma\in[0,1]
\min_{h\in\mathcal{H}}\widehat{\epsilon}_{\mathcal{B}_{c}}(h)-\widehat{%
\epsilon}_{\mathcal{B}_{n}}(h)
l
128
200
\gamma
0.1
0.7
0.1
0.2
\gamma\in[0.2,0.5]
\gamma=0.5
\gamma\leq 0.5
\gamma\geq 0.5
\gamma
\gamma
1.5\times 10^{-3}
\gamma
1-\delta
h\in\mathcal{H}
\left|\epsilon_{u}(h)-\widehat{\epsilon}_{\widehat{u}}(h)\right|\leq 2\mathcal%
{R}_{H}^{l}(\widehat{u})+4c\sqrt{\frac{\ln(4/\delta)}{N}}.
1-\delta
h\in\mathcal{H}
\epsilon_{u}(\widehat{h}_{u})-\epsilon_{u}(h^{*}_{u})\leq 2\mathcal{R}_{H}^{l}%
(\widehat{u})+5c\sqrt{\frac{\ln(8/\delta)}{N}}.
l(\cdot,\cdot)
\mathcal{R}(l\circ\mathcal{H}\circ\widehat{u})\leq L\mathcal{R}(\mathcal{H}%
\circ\widehat{u}),
\mathcal{R}_{\mathcal{H}}^{l}(\widehat{u})=\frac{1}{2N}\mathbb{E}_{\boldsymbol%
{\sigma}\sim\{\pm 1\}^{2N}}\left[\sup_{h\in\mathcal{H}}\sum_{x\in\widehat{u}}%
\sigma_{i}h(x_{i})\right].
\mathcal{H}
D
\mathcal{X}
M_{1},\ldots,M_{d}
\mathbb{E}_{\sigma\in\{\pm 1\}^{N}}\left[\sup_{h\in\mathcal{H}}\sum_{i=1}^{N}%
\sigma_{i}h(x_{i})\right]\leq\sqrt{N}B(\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i}.
x\in\mathcal{X}
h\in\mathcal{H}
a\in\mathcal{A}
|l(h(x),a(x))|\leq c
1-\delta
\displaystyle|\mathcal{D}_{\text{R}}(p\|q)-\mathcal{\widehat{D}}_{\text{R}}(%
\widehat{p}\|\widehat{q})|\leq 2\mathcal{D}_{\textup{L}}(p\|q)+2\mathcal{R}_{%
\mathcal{H}}^{l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{q})+12c%
\sqrt{\frac{\ln(8/\delta)}{N}}.
\displaystyle|\mathcal{D}_{\text{R}}(p\|q)-\mathcal{\widehat{D}}_{\text{R}}(%
\widehat{p}\|\widehat{q})|\leq 2\mathcal{D}_{\textup{L}}(p\|q)+2\mathcal{R}_{%
\mathcal{H}}^{l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{q})+12c%
\sqrt{\frac{\ln(8/\delta)}{N}}.
\displaystyle|\mathcal{D}_{\text{R}}(p\|q)-\mathcal{\widehat{D}}_{\text{R}}(%
\widehat{p}\|\widehat{q})|
\displaystyle|\mathcal{D}_{\text{R}}(p\|q)-\mathcal{\widehat{D}}_{\text{R}}(%
\widehat{p}\|\widehat{q})|
\displaystyle=\left||\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})|-|%
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat%
{p}}(\widehat{h}_{u})|\right|
\displaystyle=
\displaystyle\left||\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})|-|\widehat%
{\epsilon}_{\widehat{q}}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{p}}(%
\widehat{h}_{u})|\right|
\displaystyle\leq\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u},)-%
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})+\widehat{\epsilon}_{\widehat%
{p}}(\widehat{h}_{u})\right|
\displaystyle\leq
\displaystyle\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u},)-\widehat{%
\epsilon}_{\widehat{q}}(\widehat{h}_{u})+\widehat{\epsilon}_{\widehat{p}}(%
\widehat{h}_{u})\right|
\displaystyle=\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})+\widehat{%
\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})+%
\epsilon_{p}(\widehat{h}_{u})-\epsilon_{q}(\widehat{h}_{u})+\epsilon_{q}(%
\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle=
\displaystyle\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})+\widehat{%
\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})+%
\epsilon_{p}(\widehat{h}_{u})-\epsilon_{q}(\widehat{h}_{u})+\epsilon_{q}(%
\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle\leq\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})\right|+%
\left|\epsilon_{p}(\widehat{h}_{u})-\epsilon_{q}(\widehat{h}_{u})\right|+\left%
|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u%
})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}%
(\widehat{h}_{u})\right|
\displaystyle\leq
\displaystyle\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})\right|+%
\left|\epsilon_{p}(\widehat{h}_{u})-\epsilon_{q}(\widehat{h}_{u})\right|+\left%
|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u%
})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}%
(\widehat{h}_{u})\right|
\displaystyle\leq 2\mathcal{D}_{\text{L}}(p\|q)+\left|\widehat{\epsilon}_{%
\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})\right|+\left|%
\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u}%
)\right|.
\displaystyle\leq
\displaystyle 2\mathcal{D}_{\text{L}}(p\|q)+\left|\widehat{\epsilon}_{\widehat%
{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})\right|+\left|\epsilon_{q}(%
\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|.
\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{%
h}_{u})\right|
\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{%
h}_{u})\right|
\sqrt{\textup{Var}\left[\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat%
{q})\right]}
\displaystyle\frac{34c}{\sqrt{N}}+\sqrt{2\pi}\left(2\mathcal{D}_{\textup{L}}(p%
\|q)+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l%
}(\widehat{q})\right).
\displaystyle\frac{34c}{\sqrt{N}}+\sqrt{2\pi}\left(2\mathcal{D}_{\textup{L}}(p%
\|q)+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l%
}(\widehat{q})\right).
\mathcal{C}=2\mathcal{D}_{\text{L}}(p\|q)+2\mathcal{R}_{\mathcal{H}}^{l}(%
\widehat{p})+2\mathcal{R}_{\mathcal{H}}^{l}(\widehat{q})
\displaystyle\text{Var}\left[\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|%
\widehat{q})\right]\leq\mathbb{E}\left[\left(\mathcal{D}_{\textup{R}}(p\|q)-%
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\right)^{2}\right]
\displaystyle\text{Var}\left[\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|%
\widehat{q})\right]\leq
\displaystyle\mathbb{E}\left[\left(\mathcal{D}_{\textup{R}}(p\|q)-\widehat{%
\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\right)^{2}\right]
\displaystyle=\int_{t=0}^{\infty}\text{Pr}\left[\left|\mathcal{D}_{\textup{R}}%
(p\|q)-\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\right|\geq%
\sqrt{t}\right]dt
\displaystyle=
\displaystyle\int_{t=0}^{\infty}\text{Pr}\left[\left|\mathcal{D}_{\textup{R}}(%
p\|q)-\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\right|\geq%
\sqrt{t}\right]dt
\displaystyle\overset{s=\sqrt{t}}{=}\int_{s=0}^{\infty}\text{Pr}\left[\left|%
\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}%
\|\widehat{q})\right|\geq s\right]2sds
\displaystyle\overset{s=\sqrt{t}}{=}
\displaystyle\int_{s=0}^{\infty}\text{Pr}\left[\left|\mathcal{D}_{\textup{R}}(%
p\|q)-\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\right|\geq s%
\right]2sds
\displaystyle\leq\int_{s=0}^{\mathcal{C}}2sds+\int_{s=0}^{\infty}\text{Pr}%
\left[\left|\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})-%
\mathcal{D}_{\textup{R}}(p\|q)\right|\geq\mathcal{C}+s\right]2(\mathcal{C}+s)ds
\displaystyle\leq
\displaystyle\int_{s=0}^{\mathcal{C}}2sds+\int_{s=0}^{\infty}\text{Pr}\left[%
\left|\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})-\mathcal{D}%
_{\textup{R}}(p\|q)\right|\geq\mathcal{C}+s\right]2(\mathcal{C}+s)ds
\displaystyle\leq\mathcal{C}^{2}+16\int_{s=0}^{\infty}(\mathcal{C}+s)e^{\frac{%
-Ns^{2}}{144c^{2}}}ds
\displaystyle\leq
\displaystyle\mathcal{C}^{2}+16\int_{s=0}^{\infty}(\mathcal{C}+s)e^{\frac{-Ns^%
{2}}{144c^{2}}}ds
\displaystyle=\mathcal{C}^{2}+16\mathcal{C}\int_{s=0}^{\infty}e^{\frac{-Ns^{2}%
}{144c^{2}}}ds+16\int_{s=0}^{\infty}se^{\frac{-Ns^{2}}{144c^{2}}}ds
\displaystyle=
\displaystyle\mathcal{C}^{2}+16\mathcal{C}\int_{s=0}^{\infty}e^{\frac{-Ns^{2}}%
{144c^{2}}}ds+16\int_{s=0}^{\infty}se^{\frac{-Ns^{2}}{144c^{2}}}ds
\displaystyle\overset{t=\frac{s}{c}\sqrt{\frac{N}{144}}}{=}\mathcal{C}^{2}+16%
\mathcal{C}c\sqrt{\frac{a}{N}}\int_{t=0}^{\infty}e^{-t^{2}}dt+\frac{2304c^{2}}%
{N}\int_{s=0}^{\infty}te^{-t^{2}}dt
\displaystyle\overset{t=\frac{s}{c}\sqrt{\frac{N}{144}}}{=}
\displaystyle\mathcal{C}^{2}+16\mathcal{C}c\sqrt{\frac{a}{N}}\int_{t=0}^{%
\infty}e^{-t^{2}}dt+\frac{2304c^{2}}{N}\int_{s=0}^{\infty}te^{-t^{2}}dt
\displaystyle=\mathcal{C}^{2}+96\mathcal{C}c\sqrt{\frac{\pi}{N}}+\frac{1152c^{%
2}}{N}
\displaystyle=
\displaystyle\mathcal{C}^{2}+96\mathcal{C}c\sqrt{\frac{\pi}{N}}+\frac{1152c^{2%
}}{N}
\displaystyle\leq\left(\frac{34c}{\sqrt{N}}+\mathcal{C}\sqrt{2\pi}\right)^{2},
\displaystyle\leq
\displaystyle\left(\frac{34c}{\sqrt{N}}+\mathcal{C}\sqrt{2\pi}\right)^{2},
\text{Pr}\left[\left|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{%
\textup{R}}(\widehat{p}\|\widehat{q})\right|\geq\mathcal{C}+s\right]\leq 8e^{%
\frac{-Ns^{2}}{144c^{2}}},
\mathcal{H}
D
\mathcal{X}
M_{1},\ldots,M_{D}
1-\delta
|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}%
\|\widehat{q})|\leq 2\mathcal{D}_{\textup{L}}(p\|q)+\frac{4LB(\sqrt{2D\ln 2}+1%
)\prod_{i=1}^{D}M_{i}}{\sqrt{N}}+12c\sqrt{\frac{\ln(8/\delta)}{N}}.
1-\delta
\mathcal{D}_{\textup{L}}(p\|q)\leq\left|\epsilon_{u}(h^{*}_{u})-\epsilon_{u}(%
\widehat{h}_{u})\right|
|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}%
\|\widehat{q})|\leq\frac{8LB(\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i}}{\sqrt{N}}+%
22c\sqrt{\frac{\ln(16/\delta)}{N}}.
\displaystyle|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}%
}(\widehat{p}\|\widehat{q})|
\displaystyle|\mathcal{D}_{\textup{R}}(p\|q)-\widehat{\mathcal{D}}_{\textup{R}%
}(\widehat{p}\|\widehat{q})|
\displaystyle\leq\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})+%
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u}%
)\right|+\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(%
\widehat{h}_{u})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}%
_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle\leq
\displaystyle\left|\epsilon_{q}(h^{*}_{u})-\epsilon_{p}(h^{*}_{u})+\widehat{%
\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})\right|+%
\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{%
h}_{u})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{%
\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle=\max\left(\left|\epsilon_{q}(h^{*})-\epsilon_{p}(h^{*})+\epsilon%
_{p}(\widehat{h})-\epsilon_{q}(\widehat{h})\right|,\left|\left(\epsilon_{q}(h^%
{*})+\epsilon_{p}(h^{*})\right)-\left(\epsilon_{p}(\widehat{h})-\epsilon_{q}(%
\widehat{h})\right)\right|\right)
\displaystyle=
\displaystyle\max\left(\left|\epsilon_{q}(h^{*})-\epsilon_{p}(h^{*})+\epsilon_%
{p}(\widehat{h})-\epsilon_{q}(\widehat{h})\right|,\left|\left(\epsilon_{q}(h^{%
*})+\epsilon_{p}(h^{*})\right)-\left(\epsilon_{p}(\widehat{h})-\epsilon_{q}(%
\widehat{h})\right)\right|\right)
\displaystyle+\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon%
_{p}(\widehat{h}_{u})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{%
\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle+\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon%
_{p}(\widehat{h}_{u})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{%
\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle\leq 2\max\left(D_{\text{L}}(p\|q),\left|\epsilon_{u}(h^{*})-%
\epsilon_{u}(\widehat{h})\right|\right)+\left|\widehat{\epsilon}_{\widehat{p}}%
(\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})\right|+\left|\epsilon_{q}(%
\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle\leq
\displaystyle 2\max\left(D_{\text{L}}(p\|q),\left|\epsilon_{u}(h^{*})-\epsilon%
_{u}(\widehat{h})\right|\right)+\left|\widehat{\epsilon}_{\widehat{p}}(%
\widehat{h}_{u})-\epsilon_{p}(\widehat{h}_{u})\right|+\left|\epsilon_{q}(%
\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{u})\right|
\displaystyle\leq 2\left|\epsilon_{u}(h^{*})-\epsilon_{u}(\widehat{h})\right|+%
\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{%
h}_{u})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{%
\widehat{q}}(\widehat{h}_{u})\right|.
\displaystyle\leq
\displaystyle 2\left|\epsilon_{u}(h^{*})-\epsilon_{u}(\widehat{h})\right|+%
\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{%
h}_{u})\right|+\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{%
\widehat{q}}(\widehat{h}_{u})\right|.
\mathcal{D}_{\text{L}}(p\|q)\leq\left|\epsilon_{u}(h^{*}_{u})-\epsilon_{u}(%
\widehat{h}_{u})\right|
\left|\epsilon_{u}(h^{*})-\epsilon_{u}(\widehat{h})\right|
\left|\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{u})-\epsilon_{p}(\widehat{%
h}_{u})\right|
\left|\epsilon_{q}(\widehat{h}_{u})-\widehat{\epsilon}_{\widehat{q}}(\widehat{%
h}_{u})\right|
N\rightarrow\infty
\widehat{\mathcal{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})\leq 2\mathcal{D}_%
{\textup{L}}(p\|q)+\mathcal{D}_{\textup{R}}(p\|q).
\delta\in(0,1)
\frac{4LB(\sqrt{2D\ln 2}+1)\prod_{i=1}^{D}M_{i}}{\sqrt{N}}+12c\sqrt{\frac{\ln(%
8/\delta)}{N}}\rightarrow 0,
N\rightarrow\infty
\widehat{p}
\widehat{q}
\mathcal{T}
\mathcal{H}
l
\widehat{u}=\widehat{p}\cup\widehat{q}
\widehat{h}_{u}\in\arg\min_{h\in\mathcal{H}}\widehat{\epsilon}_{\widehat{u}}(h)
\widehat{\epsilon}_{\widehat{p}}(\widehat{h}_{\widehat{u}})
\widehat{\epsilon}_{\widehat{q}}(\widehat{h}_{\widehat{u}})
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})=|\widehat{\epsilon}%
_{\widehat{p}}(\widehat{h}_{\widehat{u}})-\widehat{\epsilon}_{\widehat{q}}(%
\widehat{h}_{\widehat{u}})|
\mathcal{\widehat{D}}_{\text{R}}(\widehat{p}\|\widehat{q})
\widehat{p}
\widehat{q}
\mathcal{\widehat{D}}_{\textup{R}}(\cdot\|\cdot)
\alpha
K
Z
k=1
K
z=1
Z
z==1
(\widehat{p}^{1},\widehat{q}^{1})=(\widehat{p},\widehat{q})
(\widehat{p}^{z},\widehat{q}^{z})
\widehat{p}
\widehat{q}
\mathcal{\widehat{D}}_{\textup{R}}(\widehat{p}^{z}\|\widehat{q}^{z})
\mathcal{G}=\{\mathcal{\widehat{D}}_{\textup{R}}(\widehat{p}^{z}\|\widehat{q}^%
{z})\}_{z=1}^{Z}
r_{k}=\left(\text{$\mathcal{\widehat{D}}_{\textup{R}}(\widehat{p}\|\widehat{q}%
)$ is in the top $\alpha$-quantile among $\mathcal{G}$}\right)
\mathcal{\widehat{D}}_{\textup{R}}(\widehat{p}\|\widehat{q})
\alpha
\mathcal{G}
\frac{\sum_{k=1}^{K}r_{k}}{K}
\sqrt{\frac{1}{J}\sum_{j=1}^{J}\left(\mu_{p}(T_{j})-\mu_{q}(T_{j})\right)^{2}}
\mu_{p}(t)=\int k(x,t)dp(x)
k(x,t)=\exp(-\|x-y\|^{2}/\gamma^{2})
T\text{\, is drawn from an absolutely continuous distribution.}
\sqrt{\frac{1}{2J}\sum_{j=1}^{2}\left(z_{p}^{\sin}(T_{j})-z_{p}^{\sin}(T_{j})%
\right)^{2}+\left(z_{p}^{\cos}(T_{j})-z_{p}^{\cos}(T_{j})\right)^{2}}
z_{p}^{\sin}(t)=\int\kappa(x)\sin(x^{T}t)dp(x)
z_{p}^{\cos}(t)=\int\kappa(x)\cos(x^{T}t)dp(x)
\kappa(x)\text{\, is the Fourier transform of a kernel.}
\frac{1}{|\hat{p}_{\text{te}}|}\sum_{x\in\hat{p}_{\text{te}}}f_{w}(x)-\frac{1}%
{|\hat{q}_{\text{te}}|}\sum_{x^{\prime}\in\hat{q}_{\text{te}}}f_{w}(x^{\prime})
I:\hat{p}_{\text{tr}},\hat{p}_{\text{te}}\sim p,\hat{q}_{\text{tr}},\hat{q}_{%
\text{te}}\sim q
f_{w}\text{\, is a binary classifier to separate \,}\hat{p}_{\text{tr}}\text{%
\, and\,}\hat{q}_{\text{tr}}
p
q
0
1
g_{w}(x,y)=\mathbb{I}\left[\mathbb{I}\left(f_{w}(x)>\frac{1}{2}\right)=y\right]
\frac{1}{|\hat{p}_{\text{te}}|+|\hat{q}_{\text{te}}|}\sum_{x\in\hat{p}_{\text{%
te}}}g_{w}(x,0)+\sum_{x^{\prime}\in\hat{q}_{\text{te}}}g_{w}(x^{\prime},1)
\sqrt{\mathbb{E}\left[k(x,x^{\prime})+k(y,y^{\prime})-2k(x,y)\right]}
x,x\sim p,y,y^{\prime}\sim q
k(x,y)\text{\, is a simple kernal.}
\sqrt{\mathbb{E}\left[k_{w}(x,x^{\prime})+k_{w}(y,y^{\prime})-2k_{w}(x,y)%
\right]}
x,x\sim p,y,y^{\prime}\sim q
k_{w}(x,y)=[(1-\epsilon)k_{1}(\phi_{w}(x),\phi_{w}(y))+\epsilon]k_{2}(x,y)
\phi_{w}\text{\, is deep network with parameters \,}w
k_{1}(x,y)=\exp(-\|x-y\|^{2}/\gamma_{1}^{2})
k_{2}(x,y)=\exp(-\|x-y\|^{2}/\gamma_{2}^{2})
\phi(\epsilon_{u}(h^{*}_{u})-\epsilon_{p}(h^{*}_{p}),\epsilon_{u}(h^{*}_{u})-%
\epsilon_{q}(h^{*}_{q}))
h^{*}_{u}\in\arg\min_{h\in\mathcal{H}}\epsilon_{u}(h)
h^{*}_{q}\in\arg\min_{h\in\mathcal{H}}\epsilon_{q}(h)
\epsilon_{u}(h)=\mathbb{E}_{x\sim u}l(h(x),a(x))
\epsilon_{q}(h)=\mathbb{E}_{x\sim q}l(h(x),a(x))
\phi(\theta,\lambda)=\frac{\theta+\lambda}{2}\text{\, or \,}\max(\theta,\lambda)
|\epsilon_{p}(h^{*}_{u})-\epsilon_{q}(h^{*}_{u})|
\alpha=0.05
\alpha=0.05
\alpha=0.05
\alpha=0.01
\alpha=0.05
\alpha=0.01
\pm
\alpha=0.05
N
\pm
\alpha=0.05
N
{\scriptsize\pm\text{0.050}}
{\scriptsize\pm\text{0.032}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\text{0.018}}
{\scriptsize\pm\text{0.021}}
{\scriptsize\pm\text{0.008}}
{\scriptsize\pm\text{0.017}}
{\scriptsize\pm\text{0.019}}
{\scriptsize\pm\text{0.037}}
{\scriptsize\pm\text{0.039}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\text{0.031}}
{\scriptsize\pm\text{0.047}}
{\scriptsize\pm\text{0.012}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\text{0.010}}
{\scriptsize\pm\text{0.017}}
{\scriptsize\pm\text{0.021}}
{\scriptsize\pm\text{0.015}}
{\scriptsize\pm\text{0.016}}
{\scriptsize\pm\text{0.044}}
{\scriptsize\pm\text{0.004}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\scriptsize\pm\textbf{0.000}}
{\tiny\pm\textbf{0.000}}
\alpha=0.05
\alpha=0.05
