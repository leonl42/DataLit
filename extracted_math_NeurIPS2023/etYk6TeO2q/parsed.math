X(t_{u})
t_{u}
X(t_{u})\to X(t_{u}+1)\to X(t_{u}+2)\small\to\!\cdots\!\to X(t_{o})
X(t_{o})
t_{o}
\mathbf{X}(t):=\left[X_{1}(t),...,X_{d}(t)\right]
d
t=1,...,T
X_{i}(t)=f_{i}(\mathbf{PA}_{i}(t-1),N_{i}),
f_{i}
\mathbf{PA}_{i}
X_{i}
N_{i}
f_{i}
\mathbf{PA}_{i}
k
\mathbf{X}(1),\mathbf{X}(k+1),...,\mathbf{X}(\lfloor\frac{T}{k}\rfloor k+1)
k=2
t_{1},t_{3},t_{5}
t_{2},t_{4}
A(t_{1})\to M(t_{3})
A(t_{3})\leftrightarrow M(t_{3})
A(t_{1})\to A(t_{2})\to M(t_{3})
A(t_{3})\leftarrow A(t_{2})\to M(t_{3})
k=2
t_{1},t_{3},t_{5}
t_{2},t_{4}
A(t_{1})\to M(t_{3})
A(t_{3})\leftrightarrow M(t_{3})
A(t_{1})\to A(t_{2})\to M(t_{3})
A(t_{3})\leftarrow A(t_{2})\to M(t_{3})
G:=(\mathbf{V},\mathbf{E})
\mathbf{V}:=\{\mathbf{X}(t)\}_{t=1}^{T}
\mathbf{E}
X_{i}(t-1)\to X_{j}(t)
X_{i}\in\mathbf{PA}_{j}
\mathbb{P}(\mathbf{X}(1),...,\mathbf{X}(T))
\mathbf{A},\mathbf{B},\mathbf{Z}\subseteq\mathbf{V}
\mathbf{A}\perp\!\!\!\perp\mathbf{B}|\mathbf{Z}\Leftrightarrow\mathbf{A}\perp%
\!\!\!\perp_{G}\mathbf{B}|\mathbf{Z}
\perp\!\!\!\perp_{G}
G
G:=(\mathbf{V},\mathbf{E})
\mathbf{V}:=\mathbf{X}
\mathbf{E}
X_{i}\to X_{j}(i\neq j)
X_{i}\in\mathbf{PA}_{j}
t=1,k+1,...,\lfloor\frac{T}{k}\rfloor k+1
\mathbf{V}:=\{\mathbf{X}(t)\}_{t=1}^{T}
\mathbf{O}:=\{\mathbf{X}(1),...,\mathbf{X}(\lfloor\frac{T}{k}\rfloor k+1)\}
\mathbf{L}:=\mathbf{V}\backslash\mathbf{O}
\mathbf{An}(A)
A
G
\mathbf{V}
M_{G}
\mathbf{O}
M_{G}
A,B\in\mathbf{O}
p
A,B\in\mathbf{O}
\mathbf{L}
p
\mathbf{L}
p
A
B
\mathbf{L}
G
A\to B
M_{G}
A\in\mathbf{An}(B)
G
A\leftarrow B
M_{G}
B\in\mathbf{An}(A)
G
A\leftrightarrow B
M_{G}
A\not\in\mathbf{An}(B)
B\not\in\mathbf{An}(A)
G
A\to B
A
B
A\leftrightarrow B
U
A
B
M
A\to B
A\to M\to B
A\to B
a\mapsto\mathbb{P}(B|A=a)
L
\mathrm{TV}(\mathbb{P}(B|A=a),\mathbb{P}(B|A=a^{\prime}))\leq L|a-a^{\prime}|.
A\to B
\mathbb{P}(B|A)
g
E\{g(b)|a\}=0\,\,\text{almost surely}\,\,\text{if and only if}\,\,g(b)=0\,\,%
\text{almost surely}.
f_{i}
N_{i}
A
B
M
M
M^{\prime}
A\perp\!\!\!\perp_{G}M^{\prime}|M
A\to B
pr(b|a)\sim pr(m^{\prime}|a)
A\not\to B
A\to B
pr(b|a)
pr(m^{\prime}|a)
X_{i}(t)
X_{i}(t-1)
X_{i}\in\mathbf{PA}_{i}
i=1,...,d
\mathbf{O}
\mathbb{P}(\mathbf{O})
A(t_{3})\leftrightarrow M(t_{3})
A(t_{3})\leftrightarrow M(t_{3})
A(t_{3})\leftarrow A(t_{2})\to M(t_{3})
A(t_{3})
M(t_{3})
A(t_{1})\to M(t_{3})
\to
p_{AB}
A
B
l
A,V_{1},...,V_{l},B
p_{AB_{1}},p_{AB_{2}}
c_{AB}
A
B
(r,q)
U
p_{UA}
U
A
r
p_{UB}
U
B
q
p_{UA}
p_{UB}
A
B
l
A
B
(r,q)
A
B
l
A
B
(r,q)
A(t)\to B(t+k)
A
B
A\to B
A
B
A(t+k)\leftrightarrow B(t+k)
A(t+1)
A(t+k)\small\leftarrow\!\cdots\!\leftarrow A(t+1)\small\to\!\cdots\!\to B(t+k)
U(t+1)
A(t+k)\small\leftarrow\!\cdots\!\leftarrow U(t+1)\small\to\!\cdots\!\to B(t+k)
A
B
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
A\to B
A
B
l\leq k-2
A
B
l=k-1
(r\leq k-2,q\leq k-2)
k-1
A(t)\to B(t+k)
A\to B
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
A\to B
A\small\to\!\cdots\!\to B
A(t_{1})\to M(t_{2})\to B(t_{3})
A
B
M(t_{2})
M(t_{3})
A(t)
B(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\mathbf{M}(t+1)
A(t+1)
M_{i}(t+1)
M_{i}\neq B
A(t)\to M_{i}(t+k)
M_{i}
B
M_{i}
B
B(t)\to V_{1}(t+k),V_{1}(t)\to V_{2}(t+k),...,V_{l}(t)\to M_{i}(t+k)
\mathbf{S}(t)
A(t)
B(t+k)
S_{i}(t)
S_{i}\neq A
S_{i}(t)\to B(t+k)
S_{i}(t)\to M_{j}(t+k)
M_{j}\in\mathbf{M}
A\to B
A\small\to\!\cdots\!\to B
A(t_{1})\to M(t_{2})\to B(t_{3})
M(t_{2})
M(t_{3})
A\to B
A\small\to\!\cdots\!\to B
A(t_{1})\to M(t_{2})\to B(t_{3})
M(t_{2})
M(t_{3})
A\to B
A(t)\to B(t+k),A(t+k)\leftrightarrow B(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k)
\mathbf{M}(t+k)
\mathbf{M}(t+1)
A\to B
\mathbf{M}(t+k)
\mathbf{M}(t+1)
\mathbf{S}(t)
A(t)\perp\!\!\!\perp_{G}\mathbf{M}(t+k)|\mathbf{M}(t+1),\mathbf{S}(t)
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
\to
\dashrightarrow
*\!\!\to
G=(\mathbf{V},\mathbf{E})
A
B
A*\!\!\to B\in\mathbf{E}
t=1,k+1,...,\lfloor\frac{T}{k}\rfloor k+1
A,B
A*\!\!\to B
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
G_{0}
G=G_{0}
A*\!\!\to B
A
B
l\leq k-2
A
B
l\leq k-1
A
B
(r\leq k-2,q\leq k-2)
\exists\,
A\to B
A*\!\!\to B
A(t)\perp\!\!\!\perp_{G}B(t+k)|\mathbf{M}(t+1),\mathbf{S}(t)
A*\!\!\to B
A\to B
G
G
k
\mathrm{F}_{1}
\mathrm{F}_{1}:=2\cdot\frac{\mathrm{precision}\cdot\mathrm{recall}}{\mathrm{%
precision}+\mathrm{recall}}
0.05
\mathrm{causallearn}
5
0.3
X_{i}(t)=\sum_{j\in\mathbf{PA}_{i}}f_{ij}(X_{j}(t-1))+N_{i}
f_{ij}
\{linear,sin,tanh,sqrt\}
N_{i}
\{uniform,gauss.,exp.,gamma\}
k=\{2,3,4,5\}
n=\{600,800,1000,1200\}
d=\{5,15,25,35,45\}
100
\mathrm{F}_{1}
F_{1}
F_{1}
k
k
A\beta
{tau}
90
n=558
90
8
\{Hip.,Amy.,Tem.,Cin.,Ins.,Fro.,Par.,Occ.\}
A(t_{1})\to A(t_{3})
A(t_{1})\to A(t_{2})\to A(t_{3})
A(t_{1})\to M(t_{3})
A(t_{1})\to A(t_{2})\to M(t_{3})
A(t_{1})\to M(t_{2})\to M(t_{3})
A(t_{1})\to B(t_{3})
A(t_{1})\to M(t_{2})\to B(t_{3})
M(t_{1})\to M(t_{3})
M(t_{1})\to M(t_{2})\to M(t_{3})
M(t_{1})\to B(t_{3})
M(t_{1})\to M(t_{2})\to B(t_{3})
M(t_{1})\to B(t_{2})\to B(t_{3})
B(t_{1})\to B(t_{3})
B(t_{1})\to B(t_{2})\to B(t_{3})
A(t_{3})\leftrightarrow M(t_{3})
A(t_{3})\leftarrow A(t_{2})\to M(t_{3})
M(t_{3})\leftrightarrow B(t_{3})
M(t_{3})\leftarrow M(t_{2})\to B(t_{3})
A\to B
A
B
A\leftrightarrow B
U
A
B
A\leftrightarrow B
p
\mathbf{L}
A
B
A\not\in\mathbf{An}(B)
B\not\in\mathbf{An}(A)
p
r
p
p
r-1
p
U_{1},...,U_{r}
C_{1},...,C_{r-1}
p=A\small\leftarrow\!\cdots\!\leftarrow U_{1}\small\to\!\cdots\!\to C_{1}%
\small\leftarrow\!\cdots\!\leftarrow\cdots\small\to\!\cdots\!\to C_{h-1}\small%
\leftarrow\!\cdots\!\leftarrow U_{h}\small\to\!\cdots\!\to B
C_{i}
p
A
B
A
B
i=1,...,r-1
C_{i}\in\mathbf{An}(B)
U_{i}
A\small\leftarrow\!\cdots\!\leftarrow C_{i-1}\small\leftarrow\!\cdots\!%
\leftarrow U_{i}\small\to\!\cdots\!\to C_{i}\small\to\!\cdots\!\to B
U_{r}
A\small\leftarrow\!\cdots\!\leftarrow C_{r-1}\small\leftarrow\!\cdots\!%
\leftarrow U_{r}\small\to\!\cdots\!\to B
\mathbf{O}
\mathbb{P}(\mathbf{O})
t
t+\tau
\tau\geq 0
A(t),B(t+\tau)
\tau\geq 0
p=A(t),V_{1},...,V_{r},B(t+\tau)
\exists\,V_{i}
p
time(V_{i})\geq t+\tau
p
time\geq t+\tau
p
time\geq t+\tau
\forall\,V_{i},time(V_{i})\leq t+\tau
V_{j}
p
time(V_{j})=t+\tau
V_{j-1},V_{j+1}
time(V_{j-1})=time(V_{j+1})=t+\tau-1
V_{j-1},V_{j},V_{j+1}
V_{j-1}(t+\tau-1)\to V_{j}(t+\tau)\leftarrow V_{j+1}(t+\tau+1)
V_{j}(t+\tau)
p
time=t+\tau
\exists\,V_{i},time(V_{i})>t+\tau
j:=\arg\max_{i}time(V_{i})
t^{*}:=time(V_{j})
t^{*}>t+\tau
V_{j-1},V_{j},V_{j+1}
V_{j-1}(t^{*}-1)\to V_{j}(t^{*})\leftarrow V_{j+1}(t^{*}-1)
V_{j}(t^{*})
p
time>t+\tau
\to
\leftrightarrow
k
A(t)\to B(t+k)
A(t_{1})
B(t_{2})
t_{2}>t_{1}
t_{2}=t_{1}+k
A(t_{1})
B(t_{2})
p=A(t_{1}),V_{1},...,V_{r},B(t_{2})
t_{2}\neq t_{1}+k
t_{2}\geq t_{1}+2k
1
V_{i}
p
time(V_{i})=t_{1}+k,time(V_{i+1})=t_{1}+k+1
V_{i}(t_{1}+k)
V_{i}(t_{1}+k)\to V_{i+1}(t_{1}+k+1)
V_{i}(t_{1}+k)
p
A(t),B(t+k)
A(t)\leftrightarrow B(t+k)
A(t)\leftrightarrow B(t+k)
p=A(t),V_{1},...,V_{r},B(t+k)
A(t),B(t+k)
A(t)\not\in\mathbf{An}(B(t+k))
B(t+k)
A(t)
\exists\,V_{i}
time(V_{i})\geq t+k
\forall\,V_{i}
time(V_{i})<t+k
time(V_{i})>t
\forall\,V_{i}
time(V_{i})<t+k
\exists\,V_{j}
time(V_{j})\leq t
A(t),B(t+k)
\exists\,V_{i}
time(V_{i})\geq t+k
p
time\geq t+k
A(t)
B(t+k+1)
p
\forall\,V_{i}
time(V_{i})<t+k
time(V_{i})>t
time(V_{i})=t+1,..,t+k-1
A(t)\in\mathbf{An}(B(t+k))
A(t)\leftrightarrow B(t+k)
k=2
p=A(t)\to V_{1}(t+1)\to B(t+2)
A(t)\in\mathbf{An}(B(t+k))
k\geq 3
\leftarrow
\to
A(t)\in\mathbf{An}(B(t+k))
A(t)\small\to\!\cdots\!\to V_{i-1}(t_{i}+1)
\leftarrow
V_{i}(t_{i})
i\geq 3
V_{i-1}(t_{i}+1)
A(t)
p
V_{i-1}(t_{i}+1)
B(t+k)
A(t)\in\mathbf{An}(B(t+k))
\forall\,V_{i}
time(V_{i})<t+k
\exists\,V_{j}
time(V_{j})\leq t
\forall\,V_{i},t\leq time(V_{i})<t+k
V_{j}
p
time(V_{j})=t
V_{j-1}(t+1)\leftarrow V_{j}(t)\to V_{j+1}(t+1)
V_{j}(t)
p
\forall\,V_{i},time(V_{i})<t+k
\exists\,V_{i}
time(V_{i})<t
p=A(t),...,V_{i}(t-\tau),...,B(t+k)
\tau>0
V_{j}
p
V_{i}(t-\tau)
B(t+k)
time(V_{j})=t
time(V_{j+1}=t+1
V_{j}(t)
p
A(t),B(t+k)
A(t)\in\mathbf{An}(B(t+k))
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
A\to B
A
B
l\leq k-2
A
B
l=k-1
(r\leq k-2,q\leq k-2)
A\to B
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
A\to B
p_{1}=A(t)\to A(t+1)\small\to\!\cdots\!\to A(t+k-1)\to B(t+k)
A(t)
B(t+k)
A(t)\to B(t+k)
p_{2}=A(t+k)\leftarrow A(t+k-1)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
A(t)\to B(t+k)
A
B
0\leq l\leq k-1
l=0
A\to B
A(t)\to B(t+k)
A(t)\to V_{1}(t+1)\small\to\!\cdots\!\to V_{k-1}(t+k-1)\to B(t+k)
V_{i}
V_{i}=A
r
0\leq r\leq k-1
A
B
l=k-r-1
0\leq l\leq k-1
A(t+k)\leftrightarrow B(t+k)
A
B
B
A
p
A
B
0\leq l\leq k-2
l=0
A\to B
c
A
B
(r\leq k-2,q\leq k-2)
A(t+k)\leftrightarrow B(t+k)
U
A(t+k)
B(t+k)
t+1\leq time(U)\leq t+k-1
U=A
U=B
A
B
0\leq l\leq k-2
U\neq A
U\neq B
A
B
(r\leq k-2,q\leq k-2)
U
A(t+k)
B(t+k)
t+1\leq time(U)\leq t+k-1
time(U)\leq t
time(U)\geq t+k
time(U)\leq t
U
A
t
time(U)\geq t+k
U
A
U
U
t+1
t+k-1
A,B
\mathbf{M}
A
M_{i}\neq B
A(t)\to M_{i}(t+k)
M_{i}
B
M_{i}
B
B(t)\to V_{1}(t+k),V_{1}(t)\to V_{2}(t+k),...,V_{l}(t)\to M_{i}(t+k)
\mathbf{S}
S_{i}\neq A
S_{i}(t)\to B(t+k)
S_{i}(t)\to M_{j}(t+k)
M_{j}\in\mathbf{M}
A\to B
A(t)\to B(t+k),A(t+k)\leftrightarrow B(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k)
\mathbf{M}(t+k)
\mathbf{M}(t+1)
\Rightarrow
A\to B
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
p=A(t)\to B(t+1)\small\to\!\cdots\!\to B(t+k)
A(t)
B(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
B\not\in\mathbf{M}
\Leftarrow
A(t)\to B(t+k)
A(t+k)\leftrightarrow B(t+k)
A\to B
p_{AB}
A
B
0<l\leq k-2
p_{AB}
A
B
l=k-1
c_{AB}
A
B
(r\leq k-2,q\leq k-2)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k)
A\to B
A\to B
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t)
B(t+k)
A(t)
B(t+k)
p=A(t),V_{1},...,V_{l},B(t+k)
\exists\,V_{i},time(V_{i})\geq t+k
\forall\,V_{i},time(V_{i})<t+k
\exists\,V_{j}
time(V_{j})\leq t
\forall\,V_{i},t<time(V_{i})<t+k
A\to B
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\exists\,V_{i},time(V_{i})\geq t+k
time\geq t+k
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\forall\,V_{i},time(V_{i})<t+k
\exists\,V_{j}
time(V_{j})\leq t
V_{j}
V_{j}(t)\to V_{j+1}(t+1)\to V_{j+2}(t+2)\to\!\cdots
k=2
V_{j+2}
B(t+2)
V_{j}(t)
B(t+k)
V_{j}\in\mathbf{S}
time\geq t+2
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\forall\,V_{i},t<time(V_{i})<t+k
A(t)\to V_{1}(t+1)\to V_{2}(t+2)\to\!\cdots
V_{1}(t+1)
B(t+k)
V_{1}\in\mathbf{M}
A(t)\to V_{1}(t+1)
A(t)\to V_{1}(t+k)
V_{1}
B
V_{1}\not\in\mathbf{De}(B)
V_{i}\in\mathbf{M}
time\geq t+2
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k)
A(t)\perp\!\!\!\perp B(t+k)|\mathbf{M}(t+1)\cup\mathbf{S}(t)
A(t),B(t+k),\mathbf{M}(t+1),\mathbf{M}(t+k)
A(t),B(t+k),\mathbf{M}(t+1),\mathbf{M}(t+k)
A(t),B(t+k),\mathbf{M}(t+1),\mathbf{M}(t+k)
A(t)\to\mathbf{M}(t+1)
A
\mathbf{M}
\mathbf{M}(t+1)\to\mathbf{M}(t+k)
\mathbf{M}(t+1)\to B(t+k)
B
\mathbf{M}
\mathbf{M}(t+1)\leftrightarrow B(t+1)
\mathbf{M}(t+1)\to B(t+k)
\mathbf{M}(t+k)\leftrightarrow B(t+k)
A(t)\perp\!\!\!\perp\mathbf{M}(t+k)|\mathbf{M}(t+1),\mathbf{S}(t)
A(t)\to B(t+k)
\mathbf{M}(t+k)
A(t)\perp\!\!\!\perp\mathbf{M}(t+k)|\mathbf{M}(t+1),\mathbf{S}(t)
\mathbf{M}(t+k)
\mathbf{M}(t+1)
A(t)
Z_{i}(t+k)\in\mathbf{M}(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t+1)
A\not\to B
A(t),V_{1},...,V_{l},Z_{i}(t+k)
A(t)
Z_{i}(t+k)
\exists\,V_{i},time(V_{i})\geq t+k
time\geq t+k
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\forall\,V_{i},time(V_{i})<t+k
\exists\,V_{j}
time(V_{j})\leq t
V_{j}
V_{j}(t)\to V_{j+1}(t+1)\to V_{j+2}(t+2)\to\!\cdots
V_{j}(t)
Z_{i}(t+k)
V_{j}(t)\in\mathbf{S}(t)
V_{j+2}(t+2)
Z_{i}(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
\forall\,V_{i},t<time(V_{i})<t+k
A(t)\to V_{1}(t+1)\to V_{2}(t+2)\to\!\cdots
V_{1}(t1)
Z_{i}(t+k)
V_{1}(t+1)\in\mathbf{M}(t+1)
V_{1}\neq B
A\to V_{1}
V_{1}\not\in\mathbf{De}(B)
V_{1}\in\mathbf{De}(B)
V_{1}
Z_{i}
Z_{i}\in\mathbf{De}(B)
\mathbf{M}
V_{1}(t1)
Z_{i}(t+k)
time\geq t+2
\mathbf{M}(t+1)\cup\mathbf{S}(t)
A\to B
p=A(t)\to B(t+1),V_{1},...,V_{l},Z_{i}(t+k)
\mathbf{M}(t+1)\cup\mathbf{S}(t)
Z_{i}\not\in\mathbf{De}(B)
p
B(t+1)
\leftarrow
p
B(t+1)
time\geq t+2
\mathbf{M}(t+1)\cup\mathbf{S}(t)
d
\mathrm{prob.}
d
\mathrm{prob.}
