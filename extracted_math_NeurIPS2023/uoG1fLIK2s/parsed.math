\mathcal{X}
\mathcal{A}
\mathcal{S}
\tau=(s_{0},s_{1},\ldots,s_{T})
x=s_{T}\in\mathcal{X}
(a_{1},\ldots a_{T-1})
a_{t}
s_{t}\rightarrow s_{t+1}
P_{F}(s^{\prime}|s)
a
s
s^{\prime}
x
P_{F}(\cdot|\cdot)
\mathcal{E}:\mathcal{X}\rightarrow\mathbb{R}
P^{\top}_{F}(x)\propto\exp(-\mathcal{E}(x)),
P^{\top}_{F}(x)
x
x=s_{T}
P_{F}(s^{\prime}|s)
P_{B}(s|s^{\prime})
F(\cdot):\mathcal{S}\rightarrow\mathbb{R}^{+}
\mathcal{L}_{\text{DB}}(s,s^{\prime})=\left(\log F(s)+\log P_{F}(s^{\prime}|s)%
-\log F(s^{\prime})-P_{B}(s|s^{\prime})\right)^{2},
F(s)
s_{T}=x
\exp(-\mathcal{E}(x))
P_{F}(s^{\prime}|s)
P_{B}(s|s^{\prime})
Z
\mathcal{L}_{\text{TB}}=\left(\log Z+\sum^{T-1}_{t=0}\log P_{F}(s_{t+1}|s_{t})%
-\mathcal{E}(x)-\sum^{T-1}_{t=0}\log P_{B}(s_{t}|s_{t+1})\right)^{2}.
F(\cdot)
P_{F}(s^{\prime}|s),P_{B}(s^{\prime}|s)
Z
s_{U}\rightarrow s_{U+1}\cdots\rightarrow s_{U+L}
\mathcal{L}_{\text{subTB}}=\left(\log F(s_{U})+\sum^{U+L-1}_{t=U}\log P_{F}(s_%
{t+1}|s_{t})-\log F(s_{U+L})-\sum^{U+L-1}_{t=U}\log P_{B}(s_{t}|s_{t+1})\right%
)^{2}.
\mathcal{E}:\mathcal{X}\rightarrow\mathbb{R}
\displaystyle\mathcal{L}_{\text{FL}}(s,s^{\prime})=(\log\tilde{F}(s)+\log P_{F%
}(s^{\prime}|s)-\mathcal{E}(s)+\mathcal{E}(s^{\prime})-\log\tilde{F}(s^{\prime%
})-\log P_{B}(s|s^{\prime}))^{2},
\displaystyle\mathcal{L}_{\text{FL}}(s,s^{\prime})=(\log\tilde{F}(s)+\log P_{F%
}(s^{\prime}|s)-\mathcal{E}(s)+\mathcal{E}(s^{\prime})-\log\tilde{F}(s^{\prime%
})-\log P_{B}(s|s^{\prime}))^{2},
\tilde{F}(s)=F(s)\exp{(\mathcal{E}(s))}
\mathcal{E}(s^{\prime})-\mathcal{E}(s)
s
s^{\prime}
\mathcal{X}
\mathcal{E}(s)
s
P_{F}(\cdot|\cdot)
\downarrow
\downarrow
\{A,B,C,D,E\}
-1
0
0
\mathcal{E}
\phi_{\theta}
\mathcal{E}(x)\approx\Phi_{\theta}(\tau)=\sum^{T-1}_{t=0}\phi_{\theta}(s_{t}%
\rightarrow s_{t+1}),
\tau=(s_{0},s_{1},\ldots,s_{T})
x=s_{T}
s_{t}\rightarrow s_{t+1}
P_{F},P_{B}
F
\displaystyle\mathcal{L}_{\text{LED}}(s,s^{\prime})=(\log\tilde{F}(s)+\log P_{%
F}(s^{\prime}|s)+\phi_{\theta}(s\rightarrow s^{\prime})-\log\tilde{F}(s^{%
\prime})-\log P_{B}(s|s^{\prime}))^{2}.
\displaystyle\mathcal{L}_{\text{LED}}(s,s^{\prime})=(\log\tilde{F}(s)+\log P_{%
F}(s^{\prime}|s)+\phi_{\theta}(s\rightarrow s^{\prime})-\log\tilde{F}(s^{%
\prime})-\log P_{B}(s|s^{\prime}))^{2}.
(s_{0},\ldots,s_{u}=s,s_{u+1}=s^{\prime})
\mathcal{E}(s),\mathcal{E}(s^{\prime})
\sum_{t=0}^{u}\phi(s_{t})
\sum_{t=0}^{u+1}\phi(s_{t})
\mathcal{E}(x)=\Phi_{\theta}(\tau)
\tau
x
\phi_{\theta}(s\rightarrow s^{\prime})=\mathcal{E}(s^{\prime})-\mathcal{E}(s)
\phi_{\theta}
\mathcal{E}(x)-\Phi_{\theta}(\tau)
\phi_{\theta}
\tau=(s_{0},\ldots,s_{T}=x)
\phi_{\theta}
\mathcal{E}(x)\approx\Phi_{\theta}(\tau)
\ell_{\text{LS}}(\tau)=\mathbb{E}_{\bm{z}\sim\operatorname{Bern}(\lambda)}%
\left[\left(\frac{1}{T}\mathcal{E}(s_{T})-\frac{1}{C}\sum^{T-1}_{t=0}z_{t}\phi%
_{\theta}(s_{t}\rightarrow s_{t+1})\right)^{2}\right].
T
\bm{z}
z_{t}=0
1-\lambda
T
C=\sum^{T-1}_{t=0}z_{t}
\lambda=1
\ell_{\text{LS}}(\tau)=0
\tau
\lambda<1
\mathcal{B}
P_{F},P_{B}
\tilde{F}
\phi_{\theta}
\phi_{\theta}
\ell_{\text{ED}}
\{\tau_{b}\}_{b=1}^{B_{1}}
P_{F}
\mathcal{B}\leftarrow\mathcal{B}\cup\{\tau_{b}\}_{b=1}^{B_{1}}
n=1,\ldots,N
\{\tau_{b}\}_{b=1}^{B_{2}}
\mathcal{B}
\phi_{\theta}
\ell_{\text{LS}}
\{\tau_{b}\}_{b=1}^{B_{2}}
\phi_{\theta}(s_{i},a_{i})
(s_{i},a_{i})\in\tau
P_{F},P_{B},\tilde{F}
\mathcal{L}_{\text{LED}}
\tau
\phi_{\theta}(s_{i},a_{i})
(s_{i},a_{i})\in\tau
100
15
100
30
20
50
18.5
\downarrow
\downarrow
\downarrow
\downarrow
\mathrel{\text{\rotatebox[origin={c}]{45.0}{$\vrule height=0.0pt,width=0.0pt%
\rightarrow$}}}
\mathrel{\text{\rotatebox[origin={c}]{45.0}{$\vrule height=0.0pt,width=0.0pt%
\rightarrow$}}}
100
100
\lambda=1
\phi_{\theta}:\mathcal{X}\rightarrow\mathbb{R}
\phi_{\theta}(s\rightarrow s^{\prime})=\phi_{\theta}(s^{\prime})-\phi_{\theta}%
(s)
\phi_{\theta}(s_{t}\rightarrow s_{t+1})
(s_{0},a_{0},\ldots,s_{t},a_{t})
(s_{0},a_{0},\ldots,s_{t+1},a_{t+1})
\mathcal{L}_{\text{LED}}
\phi_{\theta}(s\rightarrow s^{\prime})=\phi_{\theta}(s^{\prime})-\phi_{\theta}%
(s)
\log\hat{F}(s)=-\phi_{\theta}(s)+\log\tilde{F}(s)
\mathcal{L}_{\text{LED}}
\mathcal{L}_{\text{LED}}(s,s^{\prime})=\left(\log\hat{F}(s)+\log P_{F}(s^{%
\prime}|s)-\log\hat{F}(s^{\prime})-P_{B}(s|s^{\prime})\right)^{2}.
-\mathcal{E}(x)+\Phi_{\theta}(\tau)=-\mathcal{E}(x)+\phi_{\theta}(x)
\log\hat{F}(x)=-\mathcal{E}(x),
\displaystyle\mathcal{L}_{\text{LED-subTB}}=
\displaystyle\mathcal{L}_{\text{LED-subTB}}=
\displaystyle\left(\log\tilde{F}(s_{U})+\sum^{V-1}_{t=U}\log P_{F}(s_{t+1}|s_{%
t})+\sum^{V-1}_{t=U}\phi_{\theta}(s_{t}\rightarrow s_{t+1})-\log\tilde{F}(s_{V%
})-\sum^{V-1}_{t=U}\log P_{B}(s_{t}|s_{t+1})\right)^{2},
\displaystyle\left(\log\tilde{F}(s_{U})+\sum^{V-1}_{t=U}\log P_{F}(s_{t+1}|s_{%
t})+\sum^{V-1}_{t=U}\phi_{\theta}(s_{t}\rightarrow s_{t+1})-\log\tilde{F}(s_{V%
})-\sum^{V-1}_{t=U}\log P_{B}(s_{t}|s_{t+1})\right)^{2},
s_{U}\rightarrow s_{U+1}\cdots\rightarrow s_{V}
\phi_{\theta}(s\rightarrow s^{\prime})=\mathcal{E}(s^{\prime})-\mathcal{E}(s)
0.001
10\%
10
20\%
15
10
75\%
30
B_{1}=32
16
1\mathrm{e}{-4}
0.01
B_{2}
B_{1}
N=8
N
8
100
2000
7.5
B_{1}=4
256
5\mathrm{e}{-4}
8.0
0.05
1\mathrm{e}{-4}
8
4
B_{1}=16
128
1\mathrm{e}{-4}
3.0
0.01
1\mathrm{e}{-2}
20
30
0.25
B_{1}=16
256
0.001
