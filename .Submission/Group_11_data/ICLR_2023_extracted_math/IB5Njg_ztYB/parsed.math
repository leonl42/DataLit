('1', '\\mathrm{NHMe_2}')
('1', '\\mathrm{HT_{2A}}')
('1', '\\varphi_\\mathcal{R}')
('2.0.0', 'c')
('2.0.0', 'c')
('3.0', 'a')
('3.0', 'r')
('3.0', 'b')
('3.0', '\\mathcal{P}')
('3.0', '\\mathcal{R}')
('3.0', '\\mathcal{R}')
('3.0', '\\mathcal{R}_{3D}')
('3.0', '\\mathcal{R}_{2D}')
('3.0', '\\mathcal{P}')
('3.0', '\\mathcal{R}_{3D}')
('3.0', '\\mathcal{P}')
('3.0', 'M')
('3.0', 'N')
('3.0', '\\mathcal{P}')
('3.0', '\\mathcal{R}')
('3.1', '\\mathcal{P}')
('3.1', '\\mathcal{R}_{3D}')
('3.1', '\\equiv')
('3.1', '\\begin{aligned}\n    \\mathbf{h}^{(0)}_i &= \\mathrm{Emb}(a_i)\\\\\n    \\mathbf{m}_{ij} &= \\mathrm{concat}\\left\\{\\mathrm{Erbf}(||r_i - r_j||), \\mathrm{Emb}(b_{ij})\\right\\}\\label{eq:echnet-concat}\\\\\n    \\mathbf{h}^{(l)}_i &= \\mathbf{h}^{(l-1)}_i + \\sum_{k \\in N(i) \\backslash j} \\mathbf{h}^{(l-1)}_k \\odot \\Phi^{(l)}(\\mathbf{m}_{ki}),\\quad l = 1,...,L\n\\end{aligned}')
('3.1', '\\mathrm{Erbf}(\\cdot)')
('3.1', '\\mathrm{Emb(\\cdot)}')
('3.1', '\\mathrm{concat(\\cdot)}')
('3.1', '\\Phi')
('3.1', 'L')
('3.1', 'b_{ij}')
('3.1', 'i')
('3.1', 'j')
('3.1', '\\mathbf{h}^{(l)}_i')
('3.1', 'i')
('3.1', 'l^\\mathrm{th}')
('3.1', '\\mathbf{m}_{ij}')
('3.1', 'i')
('3.1', 'j')
('3.2', '\\mathcal{R}_{3D}')
('3.2', 'p_{Z}')
('3.2', 'f_\\theta:\\mathbf{z}\\in \\mathbb{R}^D \\rightarrow \\mathbf{x}\\in \\mathbb{R}^D')
('3.2', '\\theta')
('3.2', 'f')
('3.2', 'D')
('3.2', '\\mathbf{z}')
('3.2', '\\mathbf{x}')
('3.2', '\\mathbf{z} \\sim p_{Z}')
('3.2', '\\mathbf{x}')
('3.2', '\\mathbf{x}')
('3.2', '\\label{eq:flow_basic}\n    \\log p_{X}(\\mathbf{x}) = \\log p_{Z}\\left(f_\\theta^{-1}(\\mathbf{x})\\right) + \\log \\left|\\text{det}\\frac{\\partial f_\\theta^{-1}(\\mathbf{x})}{\\partial \\mathbf{x}}\\right|.')
('3.2', '\\mathbf{x}_i')
('3.2', 'i')
('3.2', '\\mathbf{x}')
('3.2', '\\mathbf{x}_i')
('3.2', '\\mathbf{x}_{1...i-1}')
('3.2', 'f_\\theta^{-1}')
('3.2', '\\label{eq:flow-paradigm}\n    \\mathbf{x}_i = \\sigma_i(\\mathbf{x}_{1...i-1})\\odot \\mathbf{z}_i + \\mu_i(\\mathbf{x}_{1...i-1}), \\quad i=1...D,')
('3.2', '\\odot')
('3.2', '\\sigma_i(\\cdot) \\in \\mathbb{R}')
('3.2', '\\mu_i(\\cdot) \\in \\mathbb{R}')
('3.2', '\\mathbf{x}_{1...i-1}')
('3.2', '\\label{eq:flow-derivative}\n    \\mathbf{z}_i=\\frac{\\mathbf{x}_i - \\mu_i}{\\sigma_i}, \\quad\n    \\text{det}\\frac{\\partial f_\\theta^{-1}(\\mathbf{x})}{\\partial \\mathbf{x}}=\\prod_{i=1}^D\\frac{1}{\\sigma_i}.')
('4', '\\mathcal{R}_{3D}')
('4', '\\mathcal{P}')
('4', '\\mathcal{R}_{3D}')
('4', '\\mathcal{R}_{2D}')
('4.0', '\\mathcal{R}_{2D}')
('4.0.0', '\\mathcal{R}_{2D}')
('4.0.0', '\\mathcal{R}_{2D}')
('4.0.0', '\\mathbf{h}_\\mathrm{root}')
('4.0.0', '\\mathcal{R}_{2D}')
('4.0.0', '\\label{eq:var-parameterization}\n    ({\\bm{\\mu}}_{{\\mathcal{R}}_{2D}}, {\\bm{\\Sigma}}_{{\\mathcal{R}}_{2D}}) = \\varphi_{\\mathcal{R}_{2D}} = \\mathrm{MLP}(\\mathbf{h}_\\mathrm{root}).')
('4.0.0', '{\\bm{\\mu}}_{{\\mathcal{R}}_{2D}}')
('4.0.0', '{\\bm{\\Sigma}}_{{\\mathcal{R}}_{2D}}')
('4.0.0', '\\mathcal{N}({\\bm{\\mu}}_{{\\mathcal{R}}_{2D}}, {\\bm{\\Sigma}}_{{\\mathcal{R}}_{2D}})')
('4.0.0', '\\mathbf{h}_\\mathrm{root}')
('4.0.1', '\\mathbf{h}_\\mathrm{root}')
('4.0.1', 'i')
('4.0.1', 'j')
('4.0.1', '\\mathbf{m}_{ij}')
('4.0.1', '\\mathbf{m}_{i j}=\\mathrm{GRU}(\\mathbf{x}_i,\\left\\{\\mathbf{m}_{k i}\\right\\}_{k \\in N(i) \\backslash j}).')
('4.0.1', '\\begin{aligned}\n    \\mathbf{s}_{ij} &=& \\sum\\nolimits_{k \\in N(i) \\backslash j} \\mathbf{m}_{ki}, \\\\\n    \\mathbf z_{ij} &=& \\sigma(\\mathbf W^z \\mathbf x_i + \\mathbf U^z \\mathbf{s}_{ij} + \\mathbf{b}^z), \\\\\n    \\mathbf{r}_{ki} &=& \\sigma(\\mathbf W^r \\mathbf x_i + \\mathbf U^r \\mathbf{m}_{ki} + \\mathbf{b}^r), \\\\\n    \\widetilde{\\mathbf{m}}_{ij} &=& \\tanh(\\mathbf W \\mathbf x_i + \\mathbf U \\sum_{k \\in N(i) \\backslash j} \\mathbf{r}_{ki} \\odot \\mathbf{m}_{ki}), \\\\\n    \\mathbf{m}_{ij} &=& (1 - \\mathbf z_{ij}) \\odot \\mathbf{s}_{ij} + \\mathbf z_{ij} \\odot \\widetilde{\\mathbf{m}}_{ij},\n\\end{aligned}')
('4.0.1', '\\mathbf{x}_i')
('4.0.1', 'i')
('4.0.1', '\\mathbf{h}_i')
('4.0.1', '\\mathbf{h}_i = \\mathbf{W}^o \\mathbf{x}_i+\\sum_{k \\in N(i)} \\mathbf{U}^o \\mathbf{m}_{k i}.')
('4.0.2', '\\varphi_{\\mathcal{R}_{2D}} = ({\\bm{\\mu}}_{{\\mathcal{R}}_{2D}}, {\\bm{\\Sigma}}_{{\\mathcal{R}}_{2D}})')
('4.0.2', '\\mathcal{N}(\\mathbf{0}, \\mathcal{I})')
('4.1', '\\mathcal R')
('4.1.0', '\\mathcal R')
('4.1.0', 'i = 4')
('4.1.0', '\\mathcal{G}_i')
('4.1.0', '\\mathcal{P}')
('4.1.0', '\\mathcal R_{1:i-1}')
('4.1.0', '\\mathcal G_i = \\tau(\\mathcal P \\cup \\mathcal R_{1:i-1}),')
('4.1.0', '\\tau(\\cdot)')
('4.1.0', '\\tau')
('4.1.0', '\\mathcal G_i')
('4.1.0', '\\tau(\\mathcal P)')
('4.1.0', '\\mathbf{\\tilde e}_{1:M},\\mathbf{e}_{1:i-1} = \\mathrm{Echnet}(\\mathcal G_i). \\label{eq:encode-subgraph}')
('4.1.0', 'f_i')
('4.1.0', 'f_i')
('4.1.0', '(d, \\theta, \\phi)')
('4.1.0', 'a_i')
('4.1.0', 'b_{1:i-1, i}')
('4.1.0', '\\mathbf{x}_i^\\mathrm{(pos)} = (d_i, \\theta_i, \\phi_i)')
('4.1.0', '\\mathbf{z}_i^\\mathrm{(node)}')
('4.1.0', '\\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)}')
('4.1.0', '\\mathbf{z}_i^\\mathrm{(pos)}')
('4.1.0', '\\mathcal N({\\bm{\\mu}}_{{\\mathcal{R}}}, {\\bm{\\Sigma}}_{{\\mathcal{R}}})')
('4.1.0', '\\left[\\mathbf{z}_i^{\\text {(node)}} ; \\mathbf{z}_{1: i-1, i}^{\\text {(bond)}} ; \\mathbf{z}_i^{\\text {(pos)}}\\right] \\sim \\mathcal{N}\\left(\\boldsymbol{\\mu}_{\\mathcal{R}}, \\boldsymbol{\\Sigma}_{\\mathcal{R}}\\right).')
('4.1.0', '\\mathcal{N}\\left(\\boldsymbol{\\mu}_{\\mathcal{R}}, \\boldsymbol{\\Sigma}_{\\mathcal{R}}\\right)')
('4.1.0', '\\mathbf{z}^{\\text {(bond)}}')
('4.1.0', '(i-1)')
('4.1.0', 'i')
('4.1.0', '(i-1)')
('4.1.0', '\\mathcal{F}_i')
('4.1.0', '\\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)},\\ \\mathbf{x}_i^\\mathrm{(pos)} = \\mathcal{F}_i\\left(\\mathbf{z}_i^\\mathrm{(node)}, \\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)},\\ \\mathbf{z}_i^\\mathrm{(pos)} ;\\mathbf{e}_{1:i-1}\\right).\n    \\label{eq:flow_forward}')
('4.1.1', '\\mathcal{F}_i')
('4.1.1', '\\begin{aligned}\n    \\mu_i^\\mathrm{(node)}, \\sigma_i^\\mathrm{(node)} &= \\text{Node-MLP}(\\mathbf{e}_{f_i})\\label{eq:node_mlp},\\\\\n    \\mathbf{x}_i^\\mathrm{(node)} &= \\sigma_i^\\mathrm{(node)} \\odot \\mathbf{z}_i^\\mathrm{(node)} + \\mu_i^\\mathrm{(node)},\\\\\n    \\mu_{1:i-1, i}^\\mathrm{(bond)}, \\sigma_{1:i-1, i}^\\mathrm{(bond)} &= \\text{Bond-MLP}(\\mathbf{e}_{1:i-1}, \\mathbf{x}_i^\\mathrm{(node)})\\label{eq:bond_mlp},\\\\\n    \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)} &= \\sigma_{1:i-1, i}^\\mathrm{(bond)} \\odot \\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)} + \\mu_{1:i-1, i}^\\mathrm{(bond)},\\\\\n    \\mu_i^\\mathrm{(pos)}, \\sigma_i^\\mathrm{(pos)} &= \\text{Position-MLP}(\\mathbf{e}_{f_i}, \\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)})\\label{eq:position_mlp},\\\\\n    \\mathbf{x}_i^\\mathrm{(pos)} &= \\sigma_i^\\mathrm{(pos)} \\odot \\mathbf{z}_i^\\mathrm{(pos)} + \\mu_i^\\mathrm{(pos)}, \\label{eq:pos-flow}\n\\end{aligned}')
('4.1.1', '\\mathbf{e}_{f_i}')
('4.1.1', 'f_i')
('4.1.1', '\\odot')
('4.1.1', '\\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)}')
('4.1.1', '\\ \\mathbf{x}_i^\\mathrm{(pos)}')
('4.1.1', '\\sigma, \\mu')
('4.1.1', 'a, b, d, \\theta, \\phi')
('4.1.1', '\\sigma')
('4.1.1', '\\mu')
('4.1.1', 'a_i, b_{1:i-1, i}, d_i, \\theta_i')
('4.1.1', '\\phi_i')
('4.1.1', 'i')
('4.1.1', 'f_i')
('4.1.2', 'p (x)')
('4.1.2', '\\mathcal{L}_\\mathrm{flow}')
('4.1.2', '\\mathcal{L}_\\mathrm{KL}')
('4.1.2', '\\mathcal{L}_\\mathrm{total} = \\mathcal{L}_\\mathrm{flow} + \\beta \\mathcal{L}_\\mathrm{KL},')
('4.1.2', '\\beta')
('4.1.2', '\\begin{aligned}\n    \\mathrm{maximize\\quad} & p_{X_i}({\\mathbf{x}}_i)\\ ,\\label{eq:maximize_p}\\\\\n    \\mathrm{subject\\ to\\quad} & D_\\mathrm{KL}(X_i ||\\hat X_i) < \\xi,  \\label{eq:subject_KL} \n    %= D_{\\mathrm{KL}}(\\hat{Z}||Z) < \\tau, \n\\end{aligned}')
('4.1.2', '\\xi')
('4.1.2', '\\mathcal{F}_i')
('4.1.2', 'i = 1...N')
('4.1.2', '\\begin{aligned}\n    \\mathcal{L}_\\mathrm{KL}^b\n    & = D_\\mathrm{KL}(X_i ||\\hat X_i) \\\\\n    &= D_\\mathrm{KL}(\\mathcal{F}_i(Z) || \\mathcal{F}_i(\\hat Z) ) \\\\\n    &= D_\\mathrm{KL}(Z ||\\hat Z)\\\\\n    &= D_\\mathrm{KL}(\\mathcal{N}({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}) || \\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{I})),\n\\end{aligned}')
('4.1.2', 'b')
('4.1.2', '\\mathbf{z}_i^\\mathrm{(node)}, \\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)},\\ \\mathbf{z}_i^\\mathrm{(pos)} = \\mathcal{F}_i^{-1}\\left(\\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)},\\ \\mathbf{x}_i^\\mathrm{(pos)} ;\\mathbf{e}_{1:i-1}\\right).')
('4.1.2', '\\mathbf{z}_i')
('4.1.2', '\\begin{aligned}\n\\label{eq:flow_train_1}\n\\mathbf{z}_i^\\mathrm{(node)} &= \\left(\\mathbf{x}_i^\\mathrm{(node)} - \\mu_i^\\mathrm{(node)}\\right) \\odot \\frac{1}{\\sigma_i^\\mathrm{(node)}}\\\\\n\\label{eq:flow_train_2}\n\\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)} &= \\left(\\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)} - \\mu_{1:i-1, i}^\\mathrm{(bond)}\\right) \\odot \\frac{1}{\\sigma_{1:i-1, i}^\\mathrm{(bond)}}\\\\\n\\label{eq:flow_train_3}\n\\mathbf{z}_i^\\mathrm{(pos)} &= \\left(\\mathbf{x}_i^\\mathrm{(pos)} - \\mu_i^\\mathrm{(pos)}\\right) \\odot \\frac{1}{\\sigma_i^\\mathrm{(pos)}}, \n\\end{aligned}')
('4.1.2', '\\sigma_i')
('4.1.2', '\\mu_i')
('4.1.2', 'i')
('4.1.2', 'b')
('4.1.2', '\\sim')
('4.1.2', '\\begin{aligned}\n\\mathcal{L}_i^\\mathrm{(node)}  &= -\\log(\\operatorname{Prod}(\\mathcal N(\\mathbf{z}_i^\\mathrm{(node)}|{\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}))) -\\log(\\operatorname{Prod}(\\frac{1}{\\sigma_i^\\mathrm{(node)}})) \\\\\n\\mathcal{L}_{1:i-1, i}^\\mathrm{(bond)}  &= -\\log(\\operatorname{Prod}(\\mathcal N(\\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)}|{\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}))) -\\log(\\operatorname{Prod}(\\frac{1}{\\sigma_{1:i-1, i}^\\mathrm{(bond)}})) \\\\\n\\mathcal{L}_i^\\mathrm{(pos)}  &= -\\log(\\operatorname{Prod}(\\mathcal N(\\mathbf{z}_i^\\mathrm{(pos)}|{\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}))) -\\log(\\operatorname{Prod}(\\frac{1}{\\sigma_i^\\mathrm{(pos)}})) \\\\\n\\mathcal{L}^{i, b}_\\mathrm{flow} &= \\mathcal{L}_i^\\mathrm{(node)} + \\mathcal{L}_{1:i-1, i}^\\mathrm{(bond)} + \\mathcal{L}_i^\\mathrm{(pos)}. \n\\end{aligned}')
('4.1.2', 'i')
('4.1.2', 'b')
('4.1.2', '\\mathcal{L}_\\mathrm{focal}^{i, b} = \n\\begin{cases}\n\\frac{1}{M} \\sum_{j = 1}^M \\mathrm{BCELoss}(\\tilde{y}_j, \\Hat{\\tilde{y}}_j), & \\text{if\\ } i = 1; \\\\\n\\frac{1}{i-1} \\sum_{j = 1}^{i-1} \\mathrm{BCELoss}({y}_j, \\Hat{{y}}_j), & \\text{if\\ } i > 1,  \\\\\n\\end{cases}')
('4.1.2', '\\mathrm{BCELoss(\\cdot)}')
('4.1.2', 'y_j')
('4.1.2', 'j')
('4.1.2', '\\hat{y}_j')
('4.1.2', '\\tilde{y}_j')
('4.1.2', 'j')
('4.1.2', '\\beta')
('4.1.2', '\\mathcal{L}^{b}_\\mathrm{total} = \\frac{1}{N}\\sum_{i=1}^{N}(\\mathcal{L}^{i, b}_\\mathrm{flow} + \\mathcal{L}^{i, b}_\\mathrm{focal}) + \\beta \\mathcal{L}_\\mathrm{KL}^b.')
('4.2', '\\rho')
('4.2.0', '\\rho')
('4.2.0', '\\{{\\mathcal{R}}_{a}\\}_{a\\in I}')
('4.2.0', 'I')
('4.2.0', '({\\bm{\\mu}}_\\rho, {\\bm{\\Sigma}}_\\rho) = \\frac{1}{|I|} \\sum_{a\\in I}({\\bm{\\mu}}_{{\\mathcal{R}}_a}, {\\bm{\\Sigma}}_{{\\mathcal{R}}_a}).')
('4.2.0.0', 'f')
('4.2.0.0', 'f: ({\\bm{\\mu}}_{{\\mathcal{R}}_a}, {\\bm{\\Sigma}}_{{\\mathcal{R}}_a}) \\mapsto ||\\rho||.')
('4.2.0.0', 'f')
('4.2.0.0', '||\\rho||')
('4.2.0.0', '({\\bm{\\mu}}_\\rho, {\\bm{\\Sigma}}_\\rho) = \\mathop{\\mathrm{argmax}}_{{\\bm{\\mu}}, {\\bm{\\Sigma}}} f({\\bm{\\mu}}, {\\bm{\\Sigma}}).')
('4.2.0.0', '\\uparrow')
('4.2.0.0', '\\uparrow')
('4.2.0.0', '\\uparrow')
('4.2.0.0', '\\uparrow')
('4.2.0.0', '\\uparrow')
('4.2.0.0', '\\uparrow')
('4.2.0.0', '\\downarrow')
('5', '\\mathcal{N}(\\mathbf{0}, \\mathcal{I})')
('5.0', '1')
('5.0', '-')
('5.0', '1')
('5.0', '-')
('5.0', '\\varphi_{\\mathcal{R}_\\mathrm{2D}}')
('5.0', '\\varphi_{\\mathcal{R}_\\mathrm{2D}}')
('5.0', '\\mathcal{N}(\\mathbf{0}, \\mathcal{I})')
('5.1', '\\rho')
('5.1', '\\rho')
('5.1', '\\rho')
('5.1', '\\rho')
('5.1', '\\epsilon_{\\textrm{HOMO}}/\\mathrm{eV}')
('5.1', 'U_0/\\mathrm{eV}')
('5.1', 'U/\\mathrm{eV}')
('5.1', 'H/\\mathrm{eV}')
('5.1', 'G/\\mathrm{eV}')
('5.2', '\\mathcal{N}({\\bm{\\mu}}_\\rho, {\\bm{\\Sigma}}_\\rho)')
('5.2', '\\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{I})')
('5.2', '\\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{I})')
('5.3', '\\epsilon_{\\textrm{HOMO}}/\\mathrm{eV}')
('5.3', 'U_0/\\mathrm{eV}')
('5.3', 'U/\\mathrm{eV}')
('5.3', 'U/\\mathrm{eV}')
('5.3', 'U/\\mathrm{eV}')
('5.3', '\\mathcal{N}({\\bm{\\mu}}_\\rho, {\\bm{\\Sigma}}_\\rho)')
('5.3', '\\varphi_\\rho')
('7.1', '\\mathbf{h}_\\mathrm{root}')
('7.1', '({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}) = \\varphi_\\mathcal{R} = \\mathrm{MLP}(\\mathbf{h}_\\mathrm{root}).')
('7.1', '34\\times 1')
('7.1', '{\\bm{\\mu}}_{\\mathcal{R}}')
('7.1', '{\\bm{\\Sigma}}_{\\mathcal{R}}')
('7.1', '\\mathcal{N}({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}})')
('7.1', '(d, \\theta, \\phi)')
('7.1', '\\mathcal{N}({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}})')
('8', '\\beta')
('8', '\\beta')
('8', '\\beta')
('8', '>')
('8', '\\mathcal{O}(n^3)')
('8', '\\mathcal{O}(n^2)')
('8', '\\beta = 0.1')
('8', '3\\sigma')
('9', '\\eta')
('9', 'B')
('9', 'T')
('9', '\\beta_\\mathrm{min}, \\beta_\\mathrm{max}')
('9', '\\operatorname{Prod}(\\cdot)')
('9', '\\theta')
('9', '\\beta = \\beta_\\mathrm{min} + (\\beta_\\mathrm{max} - \\beta_\\mathrm{min})\\ \\mathrm{sin^2}\\left(\\pi\\frac{t}{T}\\right)')
('9', 'M')
('9', 'N')
('9', '\\mathcal{P} = (\\tilde{V}, \\tilde{E} )')
('9', '\\tilde{V} = \\left\\{\\left(\\tilde a_i, \\tilde r_i\\right)\\right\\}_{i=1}^{M}')
('9', '\\tilde{E} = \\{\\tilde b_{ij}\\}_{i, j = 1}^{M}')
('9', '\\mathcal{R} = ({V}, {E} )')
('9', '{V} = \\left\\{\\left(a_i, r_i\\right)\\right\\}_{i=1}^{N}')
('9', '{E} = \\{b_{ij}\\}_{i, j = 1}^{N}')
('9', '\\mathcal R')
('9', '({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}) = \\text{JT-Encoder}(\\mathcal R)')
('9', 'Z\\sim\\mathcal N({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}})')
('9', '\\mathcal G_i := \\tau(\\mathcal P \\cup \\mathcal R_{1:i-1})')
('9', 'f_i :=')
('9', '\\boldsymbol{\\hat{y}} = \\text{one-hot}_M(f_i)')
('9', '\\boldsymbol{y}')
('9', '1:M')
('9', 'f_i := i - 1')
('9', '\\boldsymbol{\\hat{y}} = \\text{one-hot}_{i-1}(f_i)')
('9', '\\boldsymbol{y}')
('9', '1:i-1')
('9', '\\mathbf{\\tilde e}_{1:M}, \\mathbf{e}_{1:i-1} = \\mathrm{Echnet}(\\mathcal G_i)')
('9', '\\mathbf{x}_i^\\mathrm{(node)} = a_i + \\mathbf u,\\ \\mathbf u\\sim \\mathcal U[0,1)^{d^\\mathrm{(node)}}')
('9', '\\mu_i^\\mathrm{(node)}, \\sigma_i^\\mathrm{(node)} = \\text{Node-MLP}(\\mathbf{e}_{f_i})')
('9', '\\mathbf{z}_i^\\mathrm{(node)} = \\left(\\mathbf{x}_i^\\mathrm{(node)} - \\mu_i^\\mathrm{(node)}\\right) \\odot \\frac{1}{\\sigma_i^\\mathrm{(node)}}')
('9', '\\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)} = b_{1:i-1, i} + \\mathbf u,\\ \\mathbf u\\sim \\mathcal U[0,1)^{(i-1)\\times {d^\\mathrm{(bond)}}}')
('9', '\\mu_{1:i-1, i}^\\mathrm{(bond)}, \\sigma_{1:i-1, i}^\\mathrm{(bond)} = \\text{Bond-MLP}(\\mathbf{e}_{1:i-1}, \\mathbf{x}_i^\\mathrm{(node)})')
('9', '\\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)} = \\left(\\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)} - \\mu_{1:i-1, i}^\\mathrm{(bond)}\\right) \\odot \\frac{1}{\\sigma_{1:i-1, i}^\\mathrm{(bond)}}')
('9', '\\mathbf{x}_i^\\mathrm{(pos)} = \n                \\mathrm{Spherize}(\\boldsymbol{r}_i; f_i, c_i, e_i)')
('9', '\\mu_i^\\mathrm{(pos)}, \\sigma_i^\\mathrm{(pos)} = \\text{Position-MLP}(\\mathbf{e}_{f_i}, \\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)})')
('9', '\\mathbf{z}_i^\\mathrm{(pos)} = \\left(\\mathbf{x}_i^\\mathrm{(pos)} - \\mu_i^\\mathrm{(pos)}\\right) \\odot \\frac{1}{\\sigma_i^\\mathrm{(pos)}}')
('9', '\\mathcal{L}_i^\\mathrm{(node)}  = -\\log(\\operatorname{Prod}(\\mathcal N(\\mathbf{z}_i^\\mathrm{(node)}|{\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}))) -\\log(\\operatorname{Prod}(\\frac{1}{\\sigma_i^\\mathrm{(node)}}))')
('9', '\\mathcal{L}_{1:i-1, i}^\\mathrm{(bond)}  = -\\log(\\operatorname{Prod}(\\mathcal N(\\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)}|{\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}))) -\\log(\\operatorname{Prod}(\\frac{1}{\\sigma_{1:i-1, i}^\\mathrm{(bond)}}))')
('9', '\\mathcal{L}_i^\\mathrm{(pos)}  = -\\log(\\operatorname{Prod}(\\mathcal N(\\mathbf{z}_i^\\mathrm{(pos)}|{\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}}))) -\\log(\\operatorname{Prod}(\\frac{1}{\\sigma_i^\\mathrm{(pos)}}))')
('9', '\\mathcal{L}^{i, b}_\\mathrm{flow} = \\mathcal{L}_i^\\mathrm{(node)} + \\mathcal{L}_{1:i-1, i}^\\mathrm{(bond)} + \\mathcal{L}_i^\\mathrm{(pos)}')
('9', '\\mathcal{L}_\\mathrm{focal}^{i,b} = \\mathrm{BCELoss}(\\boldsymbol{y}, \\boldsymbol{\\hat{y}})')
('9', '\\mathcal{L}_\\mathrm{KL}^b = D_\\mathrm{KL}(\\mathcal N({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}})||\\mathcal N(\\mathbf{0},\\boldsymbol{I}))')
('9', '\\mathcal{L}^{b}_\\mathrm{total} = \\frac{1}{N}\\sum_{i=1}^{N}\\left(\\mathcal{L}^{i, b}_\\mathrm{flow} + \\mathcal{L}^{i, b}_\\mathrm{focal}\\right) + \\beta \\mathcal{L}_\\mathrm{KL}^b')
('9', '\\theta \\leftarrow \\text{ADAM} (\\sum_{b=1}^{B}\\mathcal{L}^{b}_\\mathrm{total}, \\theta, \\eta)')
('9', 'T')
('9', 'B')
('9', 'N')
('9', '({\\bm{\\mu}}_\\rho, {\\bm{\\Sigma}}_\\rho)')
('9', '\\rho')
('9', '(\\mathbf{0},\\boldsymbol{I})')
('9', 'M')
('9', '\\mathcal{P} = (\\tilde{V}, \\tilde{E} )')
('9', '\\tilde{V} = \\left\\{\\left(\\tilde a_i, \\tilde r_i\\right)\\right\\}_{i=1}^{M}')
('9', '\\tilde{E} = \\{\\tilde b_{ij}\\}_{i, j = 1}^{M}')
('9', '\\mathrm{LigGen}_t\\leftarrow [\\ ]')
('9', '\\mathcal{R} := ({V}, {E} )')
('9', '\\mathcal G_i := \\tau(\\mathcal P \\cup \\mathcal R_{1:i-1}')
('9', 'f_i')
('9', '\\mathbf{\\tilde e}_{1:M},\\mathbf{e}_{1:i-1} = \\mathrm{Echnet}(\\mathcal G_i)')
('9', '\\left[\\mathbf{z}_i^{\\text {(node)}} ; \\mathbf{z}_{1: i-1, i}^{\\text {(bond)}} ; \\mathbf{z}_i^{\\text {(pos)}}\\right] \\sim \\mathcal{N}\\left(\\boldsymbol{\\mu}_{\\mathcal{R}}, \\boldsymbol{\\Sigma}_{\\mathcal{R}}\\right)')
('9', '\\mu_i^\\mathrm{(node)}, \\sigma_i^\\mathrm{(node)} = \\text{Node-MLP}(\\mathbf{e}_{f_i})')
('9', '\\mathbf{x}_i^\\mathrm{(node)} = \\sigma_i^\\mathrm{(node)} \\odot \\mathbf{z}_i^\\mathrm{(node)} + \\mu_i^\\mathrm{(node)}')
('9', '\\mu_{1:i-1, i}^\\mathrm{(bond)}, \\sigma_{1:i-1, i}^\\mathrm{(bond)} = \\text{Bond-MLP}(\\mathbf{e}_{1:i-1}, \\mathbf{x}_i^\\mathrm{(node)})')
('9', '\\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)} = \\sigma_{1:i-1, i}^\\mathrm{(bond)} \\odot \\mathbf{z}_{1:i-1, i}^\\mathrm{(bond)} + \\mu_{1:i-1, i}^\\mathrm{(bond)}')
('9', '\\mu_i^\\mathrm{(pos)}, \\sigma_i^\\mathrm{(pos)} = \\text{Position-MLP}(\\mathbf{e}_{f_i}, \\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)})')
('9', '\\mathbf{x}_i^\\mathrm{(pos)} = \\sigma_i^\\mathrm{(pos)} \\odot \\mathbf{z}_i^\\mathrm{(pos)} + \\mu_i^\\mathrm{(pos)}')
('9', '(a_i, \\boldsymbol{r}_i)')
('9', '(\\mathbf{x}_i^\\mathrm{(node)}, \\mathbf{x}_i^\\mathrm{(pos)})')
('9', 'b_{1:i-1, i}')
('9', '\\mathbf{x}_{1:i-1, i}^\\mathrm{(bond)}')
('9', 'V.\\mathrm{append}(\\{(a_i, r_i)\\}); E.\\mathrm{append}(\\{b_{1:i-1, i}\\})')
('9', '\\mathrm{LigGen}_t.\\mathrm{append}(\\mathcal{R})')
('9', '[\\mathrm{LigGen}_1, \\mathrm{LigGen}_2, ..., \\mathrm{LigGen}_T]')
('10', '\\mathrm{HT_{2A}}')
('10', '\\mathrm{NHMe_2}')
('11.0', 'i')
('11.0', 'i>1')
('11.0', '(i-1)')
('11.1', 'f')
('11.1', 'c')
('11.1', 'e')
('11.1', '(\\boldsymbol{r}_f, \\boldsymbol{r}_c, \\boldsymbol{r}_e)')
('11.1', 'i')
('11.1', '(d_i, \\theta_i, \\phi_i)')
('11.1', '\\boldsymbol{r}_i')
('11.1', 'i')
('11.1', '\\boldsymbol{n}_1')
('11.1', '(\\boldsymbol{r}_f, \\boldsymbol{r}_c, \\boldsymbol{r}_i)')
('11.1', '\\boldsymbol{n}_2')
('11.1', '(\\boldsymbol{r}_f, \\boldsymbol{r}_c, \\boldsymbol{r}_e)')
('11.1', '\\begin{cases}\nd_i = \\left\\|\\boldsymbol{r}_i-\\boldsymbol{r}_f\\right\\|_2,  & d_i \\ge 0 \\\\\n\\theta_i = \\left \\langle \\boldsymbol{r}_i - \\boldsymbol{r}_f, \\boldsymbol{r}_c - \\boldsymbol{r}_f \\right \\rangle,  & \\theta_i \\in[0, \\pi] \\\\ \n\\phi_i = \\left \\langle \\boldsymbol{n}_1, \\boldsymbol{n}_2 \\right \\rangle,  & \\phi_i \\in[-\\pi, \\pi]\n\\end{cases}')
('11.1', 'i')
('11.1', '(x_i, y_i, z_i) = \\boldsymbol{r}_i = \\boldsymbol{r}_f+\\frac{d_i (\\boldsymbol{r}_c-\\boldsymbol{r}_f)\\cos \\theta_i}{\\left\\|\\boldsymbol{r}_c-\\boldsymbol{r}_f\\right\\|_2^2}+\\frac{d_i (\\boldsymbol{r}_{e, {{\\phi}_i}}-\\boldsymbol{r}_{e, c f})\\sin \\theta_i}{\\left\\|\\boldsymbol{r}_{e, {{\\phi}_i}}-\\boldsymbol{r}_{e, c f}\\right\\|_2^2},')
('11.1', '\\boldsymbol{r}_{e, c f}')
('11.1', 'e')
('11.1', '(\\boldsymbol{r}_f, \\boldsymbol{r}_c)')
('11.1', '\\boldsymbol{r}_{e, \\phi_i}')
('11.1', 'e')
('11.1', '(\\boldsymbol{r}_f, \\boldsymbol{r}_c, \\boldsymbol{r}_e)')
('11.1', '(\\boldsymbol{r}_f, \\boldsymbol{r}_c)')
('11.1', '\\phi_i')
('11.1', 'h: (d_i, \\theta_i, \\phi_i) \\mapsto (x_i, y_i, z_i)')
('11.1', 'Q \\in \\mathbb{R}^{3 \\times 3}')
('11.1', '\\boldsymbol{b} \\in \\mathbb{R}^3')
('11.1', '\\begin{aligned}\n& h\\left(d_i, \\theta_i, \\phi_i ; Q \\boldsymbol{r}_f+\\boldsymbol{b}, Q \\boldsymbol{r}_c+\\boldsymbol{b}, Q \\boldsymbol{r}_e+\\boldsymbol{b}\\right) \\label{eq:Cartesian-LHS}\\\\\n= & Q \\boldsymbol{r}_f+\\boldsymbol{b}+\\frac{d_i \\cos \\theta_i\\left(Q \\boldsymbol{r}_c-Q \\boldsymbol{r}_f\\right)}{\\left\\|Q \\boldsymbol{r}_c-Q \\boldsymbol{r}_f\\right\\|_2^2}+\\frac{d_i \\sin \\theta_i\\left(Q \\boldsymbol{r}_{e, \\phi_i}-Q \\boldsymbol{r}_{e, c f}\\right)}{\\left\\|Q \\boldsymbol{r}_{e, \\phi_i}-Q \\boldsymbol{r}_{e, c f}\\right\\|_2^2} \\\\\n= & Q \\boldsymbol{r}_f+\\boldsymbol{b}+Q \\frac{d_i \\cos \\theta_i\\left(\\boldsymbol{r}_c-\\boldsymbol{r}_f\\right)}{\\left\\|\\boldsymbol{r}_c-\\boldsymbol{r}_f\\right\\|_2^2}+Q \\frac{d_i \\sin \\theta_i\\left(\\boldsymbol{r}_{e, \\phi_i}-\\boldsymbol{r}_{e, c f}\\right)}{\\left\\|\\boldsymbol{r}_{e, \\phi_i}-\\boldsymbol{r}_{e, c f}\\right\\|_2^2} \\\\\n= & Q\\left[\\boldsymbol{r}_f+\\frac{d_i \\cos \\theta_i\\left(\\boldsymbol{r}_c-\\boldsymbol{r}_f\\right)}{\\left\\|\\boldsymbol{r}_c-\\boldsymbol{r}_f\\right\\|_2^2}+\\frac{d_i \\sin \\theta_i\\left(\\boldsymbol{r}_{e, \\phi_i}-\\boldsymbol{r}_{e, c f}\\right)}{\\left\\|\\boldsymbol{r}_{e, \\phi_i}-\\boldsymbol{r}_{e, c f}\\right\\|_2^2}\\right]+\\boldsymbol{b} \\\\\n= & Q h\\left(d_i, \\theta_i, \\phi_i ; \\boldsymbol{r}_f, \\boldsymbol{r}_c, \\boldsymbol{r}_e\\right)+\\boldsymbol{b} .\\label{eq:Cartesian-RHS}\n\\end{aligned}')
('11.2', 'i')
('11.2', 'i = 1, ..., N')
('11.2', 'Q \\in \\mathbb{R}^{3 \\times 3}')
('11.2', '\\boldsymbol{b} \\in \\mathbb{R}^3')
('11.2', 'p\\left(Q \\boldsymbol{r}_i+\\boldsymbol{b} \\mid A_i, B_i, R_i Q^T+\\boldsymbol{1b}^T\\right)=p\\left(\\boldsymbol{r}_i \\mid A_i, B_i, R_i\\right),\n    \\label{eq:theorem-equivariance-gen}')
('11.2', 'A_i')
('11.2', 'B_i')
('11.2', 'R_i')
('11.2', '\\boldsymbol{1^\\circ}')
('11.2', '(d_i, \\theta_i, \\phi_i)')
('11.2', '(d_i, \\theta_i, \\phi_i) = g(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i),')
('11.2', 'g')
('11.2', 'A_i, B_i, R_i')
('11.2', 'g')
('11.2', 'g(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i Q^T+\\boldsymbol{1b}^T) = g(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i). \\label{eq:scs-invariant}')
('11.2', '\\boldsymbol{2^\\circ}')
('11.2', '\\begin{aligned}\n    & h\\left(g(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i Q^T+\\boldsymbol{1b}^T) ; Q \\boldsymbol{r}_f+\\boldsymbol{b}, Q \\boldsymbol{r}_c+\\boldsymbol{b}, Q \\boldsymbol{r}_e+\\boldsymbol{b}\\right) \\\\\n    = & Q h\\left(g(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i) ; \\boldsymbol{r}_f, \\boldsymbol{r}_c, \\boldsymbol{r}_e\\right)+\\boldsymbol{b} .\n\\end{aligned}')
('11.2', 'g^r := h\\circ g')
('11.2', 'g^r')
('11.2', 'f, c, e')
('11.2', 'g^r(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i Q^T+\\boldsymbol{1b}^T) = Qg^r(\\mathbf{z}^a_i, \\mathbf{z}^b_{1:i-1, i}, z^d_i, z^\\theta_i, z^\\phi_i; A_i, B_i, R_i) + \\boldsymbol{b} = Q\\boldsymbol{r}_i + \\boldsymbol{b}. \\label{eq:Cartesian-Equivariant}')
('11.2', '\\boldsymbol{3^\\circ}')
('11.2', '[\\mathbf{z}^a_i; \\mathbf{z}^b_{1:i-1, i}; z^d_i; z^\\theta_i; z^\\phi_i]\\sim \\mathcal N({\\bm{\\mu}}_{\\mathcal{R}}, {\\bm{\\Sigma}}_{\\mathcal{R}})')
('12', '\\mathcal{O}(n^5)')
('12', 'n')
('12', '\\sim 50\\times')
