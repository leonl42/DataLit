('1', '\\mathbf{z}_t')
('1', '\\mathbf{x}_t')
('2.1', '\\mathbf{x}')
('2.1', '\\mathbf{z}')
('2.1', '\\mathbf{x}')
('2.1', '\\mathbf{z}')
('2.1', '\\mathbf{x}_t')
('2.1', '\\mathbf{z}_t')
('3', 'O')
('3', '\\mathbf{x}_{1:O} = [\n\\mathbf{x}_1, \\ldots, \\mathbf{x}_O]')
('3', 'G')
('3', '\\mathbf{x}_{O+1:O+G} = [\\mathbf{x}_{O+1}, \\ldots \\mathbf{x}_{O+G}]')
('3', '\\mathbf{x}_{1:O}')
('3', '\\mathbf{x}_t \\in \\mathbb{R}^{J\\times3}')
('3', 'J')
('3', 't')
('3', '\\mathbf{z}')
('3.0', '\\mathbf{x}_t')
('3.0', '\\mathbf{z}_t')
('3.0', '\\mathbf{x}_{1:O}')
('3.0', '\\mathbf{z}')
('3.0', '\\mathbf{x}_{1:T} = [\\mathbf{x}_t]_{t=1}^{T}')
('3.0', '\\mathbf{z}_{1:T} = [\\mathbf{z}_t]_{t=1}^{T}')
('3.0', 'T=O+G')
('3.0', '\\mathbf{z}_{1:T}')
('3.0', '\\mathbf{w}')
('3.0', '\\mathbf{w}')
('3.0', '\\begin{aligned}\n    p_{\\boldsymbol{\\theta}}(\\mathbf{x}_{1:T}, \\mathbf{z}_{1:T}, \\mathbf{w}) &= \\prod_{t=1}^{T} p_{\\boldsymbol{\\theta}}(\\mathbf{x}_{t}, \\mathbf{z}_{t}, \\mathbf{w}| \\mathbf{x}_{1:t-1},\\mathbf{z}_{1:t-1}) \\\\\n    &= p_{\\boldsymbol{\\theta}_{\\mathbf{w}}}(\\mathbf{w}) \\prod_{t=1}^{T} p_{\\boldsymbol{\\theta}_{\\mathbf{x}}}(\\mathbf{x}_{t} | \\mathbf{x}_{1:t-1},\\mathbf{z}_t, \\mathbf{w}) p_{\\boldsymbol{\\theta}_{\\mathbf{z}}}(\\mathbf{z}_{t} | \\mathbf{x}_{t-1},\\mathbf{z}_{1:t-1}, \\mathbf{w}),\n\\label{eq:dvae_generation}\n\\end{aligned}')
('3.0', '\\boldsymbol{\\theta} = \\boldsymbol{\\theta}_\\mathbf{w}\\cup \\boldsymbol{\\theta}_\\mathbf{z}\\cup \\boldsymbol{\\theta}_\\mathbf{x}')
('3.0', '\\boldsymbol{\\phi}=\\boldsymbol{\\phi}_\\mathbf{w}\\cup\\boldsymbol{\\phi}_\\mathbf{z}')
('3.0', 'q_{\\boldsymbol{\\phi}}(\\mathbf{z}_{1:T}, \\mathbf{w}| \\mathbf{x}_{1:T}) = q_{\\boldsymbol{\\phi}_{\\mathbf{w}}}(\\mathbf{w}| \\mathbf{x}_{1:T}) \\prod_{t=1}^T q_{\\boldsymbol{\\phi}_{\\mathbf{z}}}(\\mathbf{z}_t | \\mathbf{x}_{1:T}, \\mathbf{w}).\n\\label{eq:dvae_inference}')
('3.0', '\\mathcal{L}(\\boldsymbol{\\theta},\\boldsymbol{\\phi}; \\mathbf{x}_{1:T}) = \\mathbb{E}_{q_{\\boldsymbol{\\phi}}(\\mathbf{z}_{1:T},\\mathbf{w}| \\mathbf{x}_{1:T})} \\left[ \\ln p_{\\boldsymbol{\\theta}}(\\mathbf{x}_{1:T},\\mathbf{z}_{1:T},\\mathbf{w}) - \\ln q_{\\boldsymbol{\\phi}}(\\mathbf{z}_{1:T},\\mathbf{w}| \\mathbf{x}_{1:T}) \\right].\n\\label{eq:dvae_elbo}')
('3.0', '\\mathbf{x}_t')
('3.0', 'f')
('3.0', 'f_\\textsc{E}')
('3.0', 'f_\\textsc{d}')
('3.0', '\\mathbf{x}_{1:T}')
('3.0', '\\mathbf{z}_{1:T}')
('3.0', '\\mathbf{w}')
('3.0', '\\mathbf{z}')
('3.0.0', '\\mathbf{x}_{1:T}')
('3.0.0', '\\mathbf{z}_{1:T}')
('3.0.0', 'f_\\textsc{d}')
('3.0.0', '\\mathbf{x}')
('3.0.0', '\\mathbf{z}')
('3.0.0', '\\mathbf{z}_t')
('3.0.0', '\\mathbf{x}_t')
('3.0.0', 'p_{\\boldsymbol{\\theta}_{\\mathbf{x}}}(\\mathbf{x}_{t} | \\mathbf{x}_{1:t-1},\\mathbf{z}_t, \\mathbf{w}) = \\mathcal{N} (\\mathbf{x}_t;\\; \\boldsymbol{\\mu}_{\\boldsymbol{\\boldsymbol{\\theta}}_{\\mathbf{x}}, t}, \\mathbf{I})')
('3.0.0', 'p_{\\boldsymbol{\\theta}_{\\mathbf{z}}}(\\mathbf{z}_{t} | \\mathbf{x}_{t-1},\\mathbf{z}_{1:t-1}, \\mathbf{w}) = \\mathcal{N} (\\mathbf{z}_t;\\; \\boldsymbol{\\mu}_{\\boldsymbol{\\boldsymbol{\\theta}}_{\\mathbf{z}}, t}, \\boldsymbol{\\Sigma}_{\\boldsymbol{\\theta}_{\\mathbf{z}}, t})')
('3.0.0', '\\begin{aligned}\n\\boldsymbol{\\mu}_{\\boldsymbol{\\boldsymbol{\\theta}}_{\\mathbf{x}}, t} &= \\textrm{MaskedMultiHead} \\left(Q_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{x}}},t}, K_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{x}}}}, V_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{x}}}}\\right), \\\\\nQ_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{x}}},t} &= \\left[ \\begin{tabular}{c} $\\mathbf{z}_t$ \\\\ $\\mathbf{w}$ \\end{tabular} \\right], K_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{x}}}} = V_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{x}}}} = [f_\\textsc{d}(\\mathbf{x}_1), \\ldots, f_\\textsc{d}(\\mathbf{x}_{T})],\\\\\n\\left[ \\begin{tabular}{c} \n$\\boldsymbol{\\mu}_{\\boldsymbol{\\theta}_{\\mathbf{z}}, t}$ \\\\\n$\\boldsymbol{\\Sigma}_{\\boldsymbol{\\theta}_{\\mathbf{z}}, t}$ \\end{tabular} \\right]  &= \\textrm{MaskedMultiHead} \\left(Q_{\\boldsymbol{\\theta}_{\\mathbf{z}}, t}, K_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{z}}}}, V_{\\boldsymbol{\\theta}_{\\mathbf{z}}}\\right), \\\\\nQ_{\\boldsymbol{\\theta}_{\\mathbf{z}}, t} &= \\left[ \\begin{tabular}{c} $f_\\textsc{d}(\\mathbf{x}_{t-1})$ \\\\ $\\mathbf{w}$ \\end{tabular} \\right], K_{\\boldsymbol{\\boldsymbol{\\theta}_{\\mathbf{z}}}} = V_{\\boldsymbol{\\theta}_{\\mathbf{z}}} = [\\mathbf{z}_1, \\ldots, \\mathbf{z}_{T}],\n\\end{aligned}')
('3.0.0', '\\mathbf{z}_{t}')
('3.0.0', '\\mathbf{x}_{t}')
('3.0.0', 'p_{\\boldsymbol{\\theta}_{\\mathbf{w}}}(\\mathbf{w}) = \\mathcal{N}(\\mathbf{w};\\mathbf{0},\\mathbf{I})')
('3.0.0', '\\mathbf{0}')
('3.0.0', '\\mathbf{I}')
('3.0.1', '\\mathbf{w}')
('3.0.1', '\\mathbf{z}_{1:T}')
('3.0.1', '\\mathbf{x}_{1:T}')
('3.0.1', 'T')
('3.0.1', '\\mathbf{w}')
('3.0.1', '\\boldsymbol{\\mu}_{\\boldsymbol{\\boldsymbol{\\phi}_{\\mathbf{w}}}}')
('3.0.1', '\\boldsymbol{\\Sigma}_{\\boldsymbol{\\boldsymbol{\\phi}_{\\mathbf{w}}}}')
('3.0.1', 'q_{\\boldsymbol{\\phi}_{\\mathbf{w}}}(\\mathbf{w}| \\mathbf{x}_{1:T}) = \\mathcal{N}(\\mathbf{w};\\; \\boldsymbol{\\mu}_{\\boldsymbol{\\boldsymbol{\\phi}_{\\mathbf{w}}}}, \\boldsymbol{\\Sigma}_{\\boldsymbol{\\boldsymbol{\\phi}_{\\mathbf{w}}}})')
('3.0.1', 'q_{\\boldsymbol{\\phi}_\\mathbf{z}}(\\mathbf{z}_t | \\mathbf{x}_{1:T}, \\mathbf{w}) = \\mathcal{N} (\\mathbf{z}_t;\\; \\boldsymbol{\\mu}_{\\boldsymbol{\\phi}_{\\mathbf{z}}, t}, \\boldsymbol{\\Sigma}_{\\boldsymbol{\\phi}_{\\mathbf{z}}, t})')
('3.0.1', '\\begin{aligned}\n\\left[ \\begin{tabular}{c} \n$\\boldsymbol{\\mu}_{\\boldsymbol{\\phi}_{\\mathbf{z}}, t}$ \\\\\n$\\boldsymbol{\\Sigma}_{\\boldsymbol{\\phi}_{\\mathbf{z}}, t}$ \\end{tabular} \\right]  &= \\textrm{MultiHead}\\left(Q_{\\boldsymbol{\\phi}_{\\mathbf{z}}, t}, K_{\\boldsymbol{\\boldsymbol{\\phi}_{\\mathbf{z}}}}, V_{\\boldsymbol{\\phi}_{\\mathbf{z}}}\\right), \\\\\nQ_{\\boldsymbol{\\phi}_{\\mathbf{z}}, t} &= \\left[ \\begin{tabular}{ccc} \n    $f_\\textsc{E}(\\mathbf{x}_t)$ \\\\\n    $\\mathbf{w},$ \\end{tabular} \\right] , K_{\\boldsymbol{\\boldsymbol{\\phi}_{\\mathbf{z}}}} = V_{\\boldsymbol{\\phi}_{\\mathbf{z}}} = \\left[ \\begin{tabular}{ccc} \n    $f_\\textsc{E}(\\mathbf{x}_1),$ & $\\ldots,$ & $f_\\textsc{E}(\\mathbf{x}_T)$  \\\\\n    $\\mathbf{w}$ & $\\ldots,$ & $\\mathbf{w}$ \\end{tabular} \\right].\n\\end{aligned}')
('3.0.2', 'f')
('3.0.2', 'J')
('3.1.0', 'L_2')
('3.1.0', 'K')
('3.1.0', '\\{\\hat{\\mathbf{x}}_{1:T}^k\\}_{k=1}^K')
('3.1.0', '\\mathcal{L}_{\\textsc{r}} = \\min_{k} || \\hat{\\mathbf{x}}_{1:T}^k - \\mathbf{x}_{1:T}||^2, \\qquad \\mathcal{L}_{\\textsc{mm}} = \\frac{1}{M}\\sum_{m=1}^M \\min_{k} || \\hat{\\mathbf{x}}_{1:T}^k - \\mathbf{x}_{1:T}^m||^2,\n    \\label{eq:recon}')
('3.1.0', '\\mathbf{x}_{1:T}')
('3.1.0', '\\mathbf{x}_{1:T}^m')
('3.1.0', '\\begin{aligned}\n    \\mathcal{L}_{\\textsc{kl-z}} &= \\frac{1}{T}\\sum_{t=1}^T D_{KL} ( q_{\\boldsymbol{\\phi}_{\\mathbf{z}}}(\\mathbf{z}_t | \\mathbf{x}_{1:T}, \\mathbf{w}) || p_{\\boldsymbol{\\theta}_{\\mathbf{z}}}(\\mathbf{z}_{t} | \\mathbf{x}_{t-1}, \\mathbf{z}_{1:t-1}, \\mathbf{w}))\\\\\n    \\mathcal{L}_{\\textsc{kl-w}} &= D_{KL} ( q_{\\boldsymbol{\\phi}_{\\mathbf{w}}}(\\mathbf{w}| \\mathbf{x}_{1:T}) || p_{\\boldsymbol{\\theta}_{\\mathbf{w}}}(\\mathbf{w})).\n\\label{eq:loss_kl}\n\\end{aligned}')
('3.1.0', '\\mathcal{L}_{\\textsc{elbo}} = \\lambda_{\\textsc{r}}\\mathcal{L}_{\\textsc{r}} + \\lambda_{\\textsc{mm}}\\mathcal{L}_{\\textsc{mm}} + \\lambda_{\\textsc{kl-z}}\\mathcal{L}_{\\textsc{kl-z}} + \\lambda_{\\textsc{kl-w}}\\mathcal{L}_{\\textsc{kl-w}}.')
('3.1.1', "\\mathcal{L}_{\\textsc{div}} = \\sum_{p\\in\\{l,u\\}}\\lambda_{\\textsc{div-}p}\\frac{2}{K(K-1)} \\sum_{k=1}^K \\sum_{k'=k+1}^K \\exp\\left(-\\frac{|| \\hat{\\mathbf{x}}_{1:T}^{k,p} - \\hat{\\mathbf{x}}_{1:T}^{k',p} ||_1}{\\alpha_p}\\right),\n\\label{eq:loss_div}")
('3.1.1', 'l')
('3.1.1', 'u')
('3.1.1', '\\alpha_p')
('3.1.2', '\\mathcal{L}_{\\textsc{l}}')
('3.1.2', '\\mathcal{L}_{\\textsc{a}}')
('3.1.2', '\\mathcal{L}_{\\textsc{nf}}')
('3.1.2', '\\mathcal{L} = \\mathcal{L}_{\\textsc{elbo}} + \\mathcal{L}_{\\textsc{div}} + \\lambda_{\\textsc{l}}\\mathcal{L}_{\\textsc{l}} + \\lambda_{\\textsc{a}}\\mathcal{L}_{\\textsc{a}} + \\lambda_{\\textsc{nf}}\\mathcal{L}_{\\textsc{nf}}.\n\\label{eq:loss_tot}')
('3.2', 'O')
('3.2', '\\mathbf{x}_{1:O}')
('3.2', 'G')
('3.2', '\\mathbf{x}_{O+1:O+G}')
('3.2', '\\mathbf{x}_{1:T}')
('3.2', 'T=O+G')
('3.2', 'O')
('3.2', 'O')
('3.2', '\\mathbf{x}_{1:O}')
('3.2', '\\hat{\\mathbf{x}}_{O+1:O+G}')
('3.2', '0\\%')
('3.2', '100\\%')
('3.2', 'O')
('3.2', '\\mathbf{z}_{1:O}')
('3.2', '\\mathbf{w}')
('3.2', 'G')
('3.2', '\\hat{\\mathbf{x}}_{O+1:O+G}')
('3.2', 'p_{\\boldsymbol{\\theta}_{\\mathbf{x}}}(\\mathbf{x}_{t} | \\mathbf{x}_{1:t-1},\\mathbf{z}_t, \\mathbf{w})')
('3.2', 'p_{\\boldsymbol{\\theta}_{\\mathbf{z}}}(\\mathbf{z}_{t} | \\mathbf{x}_{t-1},\\mathbf{z}_{1:t-1}, \\mathbf{w})')
('3.2', '\\mathbf{z}_{O+1:O+G}')
('3.2', '\\mathbf{w}')
('4.0.1', 'L2')
('4.0.1', '\\frac{1}{K(K-1)}\\sum_{i=1}^K \\sum_{j\\neq i}^K \\|\\hat{\\mathbf{x}}^i_{O+1:O+G} - \\hat{\\mathbf{x}}^j_{O+1:O+G}\\|_2')
('4.0.1', 'L2')
('4.0.1', '\\frac{1}{G}\\min_k \\|\\hat{\\mathbf{x}}^k_{O+1:O+G} - \\mathbf{x}_{O+1:O+G}\\|')
('4.0.1', '\\min_k \\|\\hat{\\mathbf{x}}^k_{O+G} - \\mathbf{x}_{O+G}\\|')
('4.1', '\\mathbf{z}_t')
('4.1', '\\mathbf{w}')
('4.1', '\\mathbf{z}_t')
('4.1', '\\mathbf{x}_t')
('4.1', 'K=50')
('4.1', '\\mathbf{w}')
('4.1', '(\\lambda_r, \\lambda_{mm}, \\lambda_{d, l}, \\lambda_{d, u}, \\lambda_{l}, \\lambda_{a}, \\lambda_{nf}, \\lambda_z , \\lambda_w)')
('4.1', '(\\alpha_l, \\alpha_u)')
('4.1', '\\mathbf{w}')
('4.2.0', '_b')
('4.2.0', '_b')
('4.2.0', '_b')
('4.2.0', '_b')
('4.2.0', '_m')
('4.2.0', '_m')
('4.2.0', '_m')
('4.2.0', '_m')
('4.3', '\\mathbf{w}')
('4.3', '\\mathbf{w}')
('4.3', '\\mathbf{w}')
('6', '\\textrm{Att}(\\boldsymbol{Q}, \\boldsymbol{K}, \\boldsymbol{V}) = \\textrm{Softmax}\\left( \\boldsymbol{\\mathcal{M}} \\circ \\frac{\\boldsymbol{Q}\\boldsymbol{K}^T}{\\sqrt{d_k}} \\right) \\boldsymbol{V},')
('6', '\\boldsymbol{Q}, \\boldsymbol{K}, \\boldsymbol{V}')
('6', 'd_k')
('6', '\\boldsymbol{\\mathcal{M}}')
('6', '\\circ')
('6', '{\\bf x}_{1:T}')
('6', '{\\bf z}_{1:T}')
('6', 'T')
('6', '{\\bf x}_{2:T}')
('6', '{\\bf z}_{2:T}')
('6', '{\\bf x}_0')
('6', '{\\bf z}_0')
('6', 'p_{\\boldsymbol{\\theta}_{\\mathbf{x}}}(\\mathbf{x}_{t} | \\mathbf{x}_{1:T},\\mathbf{z}_t, \\mathbf{w})')
('6', 'p_{\\boldsymbol{\\theta}_{\\mathbf{x}}}(\\mathbf{x}_{t} | \\mathbf{x}_{1:t-1},\\mathbf{z}_t, \\mathbf{w})')
('6', 'p_{\\boldsymbol{\\theta}_{\\mathbf{x}}}(\\mathbf{x}_{t} | \\mathbf{x}_{t-1},\\mathbf{z}_t, \\mathbf{w})')
