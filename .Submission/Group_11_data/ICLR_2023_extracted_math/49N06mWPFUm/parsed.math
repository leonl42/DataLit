('1', '{\\mathcal{O}}(d\\log T)')
('1', 'd')
('1', '\\widetilde {\\mathcal{O}}( d\\sqrt{T}/\\Delta+ \\sqrt{dNKT})')
('1', '\\widetilde {\\mathcal{O}}(\\cdot)')
('1', 'T')
('1', 'N')
('1', 'K')
('1', '\\Delta')
('1', 'd')
('2.0', 'N')
('2.0', 'K')
('2.0', 's_{i,k}\\in\\{0,1\\}')
('2.0', 's_{i,k} = 1')
('2.0', 'i')
('2.0', 'k')
('2.0', 's \\in \\{0,1\\}^{N \\times K}')
('2.0', 'N')
('2.0', 'N\\to\\infty')
('2.0', 'T\\ll N')
('2.0', "s'")
('2.0', 'k\\in[K]')
('2.0', '\\mathbf{A}^k \\in \\mathbb{R}^{n \\times n}')
('2.0', "\\mathbb{P}(s_{i,k}' = 1|s) = \\sum_{j} \\mathbf{A}^k_{i,j} s_{j,k},\n    \\label{eq:user-content-transition}")
('2.0', "s_{i,k}'")
('2.0', 's')
('2.0', '\\mathbf{A}^k_{i,j}')
('2.0', 'j')
('2.0', 'i')
('2.0', 'k')
('2.0', 'i')
('2.0', '\\sum_{j} A^k_{i,j} s_{j,k}')
('2.0', 'i')
('2.0', 'i')
('2.0', "\\mathbb{P}(s_{i,k}' = 1|s) =  1-\\prod_{j}(1- \\mathbf{A}^k_{i,j} s_{j,k}).")
('2.0', '1-\\prod_{j}(1- \\mathbf{A}^k_{i,j} s_{j,k}) \\approx \\sum_{j} \\mathbf{A}^k_{i,j} s_{j,k}')
('2.0', 'A')
('2.0', '{\\mathcal{O}}(1/N)')
('2.0', '{\\mathcal{O}}(T/N)')
('2.0', 'T\\ll N')
('2.0', 'i')
('2.0', 'x_i \\in \\mathbb{R}^{d_1}')
('2.0', 'i\\in[N]')
('2.0', 'k')
('2.0', '\\theta_k \\in \\mathbb{R}^{d_2}')
('2.0', 'k\\in[K]')
('2.0', 'd_1\\times d_1\\times d_2')
('2.0', '{\\mathcal{T}}^* \\in \\mathbb{R}^{d_1 d_1 d_2}')
('2.0', '\\mathbf{A}_{i,j}^k = \\langle {\\mathcal{T}}^*,  x_i \\otimes x_j \\otimes \\theta_k \\rangle,')
('2.0', '\\otimes')
('2.0', '\\langle,\\rangle')
('2.0', 'N')
('2.0', 'C>0')
('2.0', '\\|\\mathbf{A}\\|_{\\infty}\\leq\\frac{C}{NK}.')
('2.0', '\\Delta>0')
('2.0', '\\sum_{i} \\mathbf{A}^k_{i,j} \\leq 1 - \\Delta')
('2.0', 'k,j')
('2.0', '{\\mathcal{O}}(1/\\Delta)')
('2.1', '{\\mathcal{S}}= \\{0,1\\}^{N \\times K}')
('2.1', '1')
('2.1', 's')
('2.1', 'a\\in\\mathcal{A}:=[N]\\times[K]')
('2.1', 's_a')
('2.1', 's_a=s+\\mathbf{1}_a')
('2.1', "\\mathbb{P}(s'|s,a) =  \\prod_{i,k} \\mathbb{P}(s_{i,k}'|s,a).")
('2.1', 'r(s,a) = \\sum_{i,k} v_{i,k}s_{i,k}')
('2.1', 'v_{i,k} \\equiv 1')
('2.1', 'r(s,a)=\\|s\\|_1')
('2.1', 'v_{i,k} \\leq 1')
('2.1', '\\pi:\\mathcal{S}\\mapsto\\mathcal{A}')
('2.1', '\\pi')
('2.1', 's')
('2.1', 'V^\\pi(s) = \\mathbb{E}^\\pi \\left[\\sum_{t=1}^\\infty \\gamma^{t-1} r(s_{t}, a_{t}) \\Big | s_1 = s \\right].')
('2.1', '1/\\Delta')
('2.1', '\\gamma = 1- o(\\Delta)')
('2.1', '\\pi^*=\\mathop{\\mathrm{argmax}}_{\\pi} V^{\\pi}(s)')
('2.1.0', '\\gamma')
('2.1.0', '\\gamma=1 - o(\\Delta)')
('2.1.0', 'o(1)')
('3', 's_{a}')
('3', 'a')
('3', '(s,a)')
('3', "s'_{i,k}")
('3', "\\textstyle\n    \\mathbb{E}[s'_{i,k} |s,a] = \\sum_{j} \\mathbf{A}^k_{i,j} (s_{a})_{j,k}=  \\left\\langle {\\mathcal{T}}^*, x_i \\otimes \\left(\\sum_{j} x_j \\cdot (s_{a})_{j,k} \\right)  \\otimes \\theta_k \\right\\rangle .")
('3', '\\phi_{i,k} (s,a) = x_i \\otimes \\left(\\sum_{j} x_j \\cdot (s_{a})_{j,k} \\right) \\otimes \\theta_k \\in \\mathbb{R}^{d_1 d_1 d_2},')
('3', '\\phi^t_{i,k} = \\phi_{i,k} (s_t,a_t)')
('3', 't')
('3', '(s_1, a_1,\\dots, s_{t-1}, a_{t-1}, s_t)')
('3', '\\widehat {{\\mathcal{T}}}_t = \\mathop{\\mathrm{argmin}}_{{\\mathcal{T}}} \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N (\\langle {\\mathcal{T}}, \\phi_{i,k}^\\tau \\rangle - (s_{\\tau+1})_{i,k})^2 + \\lambda \\| {\\mathcal{T}}\\|_2^2,')
('3', '\\| {\\mathcal{T}}\\|_2^2')
('3', '{\\mathcal{T}}')
('3', '\\widehat{{\\mathcal{T}}}_{t} = \\Sigma_{t-1}^{-1} B_{t-1},  \\label{eq:That}')
('3', '\\Sigma_{t-1} = \\lambda \\boldsymbol I + \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\phi^\\tau_{i,k}\\cdot (\\phi^\\tau_{i,k})^\\top.  \n\\qquad\n    B_{t-1} =  \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\phi^\\tau_{i,k} \\cdot (s_{\\tau+1})_{i,k}. \\label{eq:Sigma}')
('3', 'O(NK)')
('3', '\\Lambda')
('3', '\\widetilde r (s,a) = \\min\\{r(s,a), \\Lambda\\}')
('3', '\\widehat{{\\mathcal{T}}}_t')
('3', 'b_t(s,a)')
('3', '\\widetilde r')
('3', 'Q^*_{\\widehat{{\\mathcal{T}}}_t, \\widetilde r+b_t}(s,a)')
('3', '\\Lambda = \\frac{6}{\\Delta^2} \\log(4NKT^3)')
('3', '\\widehat{{\\mathcal{T}}}_t')
('3', 'b_t(s,a) = \\frac{2 \\gamma \\Lambda}{1-\\gamma} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge \\beta_t \\cdot \\| \\phi_{i,k} (s,a) \\|_{\\Sigma_{t-1}^{-1}} ) ,\n    \\label{eq:bonus}')
('3', '1 \\wedge x = \\min\\{1, x\\}')
('3', '\\begin{aligned}\n    \\beta_t =&   \\Big(\\frac{24}{\\Delta} \\sqrt{ {C_A}/{(NK)} \\cdot d \\cdot  \\log(1+NK L^2 t/(d\\lambda))} + 4 \\Big) \\log(8N^2K^2t^2/\\delta) +  \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2 \\label{eq:beta:t}\n\\end{aligned}')
('3', 'L')
('3', '\\|\\phi_{i,k}^t\\|_2')
('3', 'd = d_1^2d_2')
('3', '\\beta_t')
('3', 'Q^*_{\\widehat{{\\mathcal{T}}}_t, \\widetilde r+b_t}(s,a)')
('3', '\\widetilde Q^*(s,a)')
('3', 'Q^*_{\\widehat{{\\mathcal{T}}}_t, \\widetilde r+b_t}(s,a)')
('3.0', 't')
('3.0', "t'")
('3.0', "\\det(\\Sigma_{t'-1}) > 2 \\det(\\Sigma_{{t}-1}).")
('3.0', "Q_{t'} = Q^*_{\\widehat{{\\mathcal{T}}}_{t'}, \\widetilde r+b_{t'}}(s,a)")
('3.0', "Q_t'")
('3.0', "a = \\mathop{\\mathrm{argmax}}_{a} Q_{t'}(s,a)")
('3.0', '\\Sigma_1 = \\lambda \\boldsymbol I')
('3.0', 'B_1 = \\boldsymbol 0')
('3.0', 'Z = \\det(\\Sigma_1)')
('3.0', '\\widehat{{\\mathcal{T}}}_1')
('3.0', 'b_1(s,a)')
('3.0', 'Q_1 = Q^*_{\\widehat{{\\mathcal{T}}}_1, \\widetilde r+b_1}(s,a)')
('3.0', 'Q_1')
('3.0', 'a_1 = \\mathop{\\mathrm{argmax}}_a Q_1(s_1,a)')
('3.0', '\\Sigma_{t-1}')
('3.0', 'B_{t-1}')
('3.0', '\\widehat{{\\mathcal{T}}}_t')
('3.0', 'b_t(s,a)')
('3.0', 'Q_t = Q^*_{\\widehat{{\\mathcal{T}}}_t, \\widetilde r+b_t}(s,a)')
('3.0', 'Z = \\det(\\Sigma_{t-1})')
('3.0', 'Q_t = Q_{t-1}')
('3.0', 'Q_t')
('3.0', 'a_t = \\mathop{\\mathrm{argmax}}_a Q_t(s_t,a)')
('3.0', '{\\mathcal{T}}')
('3.0', '\\widetilde r(s,a)')
('3.0', 'b(s,a)')
('3.0', 'Q(s,a) = \\frac{\\Lambda}{1-\\gamma}')
('3.0', "Q(s,a) \\gets \\min \\{\\frac{\\Lambda}{1-\\gamma},\\widetilde r(s,a) + b(s,a) + \\gamma \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\mathcal{T}}(\\cdot |s,a)} \\max_{a'} Q(s',a') \\}")
('3.0', 'Q(s,a)')
('3.0.0', '{\\mathcal{O}}(d\\log(T))')
('3.0.0', 'T')
('3.0.0', '\\widehat{{\\mathcal{T}}}')
('4', '\\pi')
('4', '\\mathrm{Regret}(T) = \\sum_{t=1}^T \\Delta_t, \\text{ where } \\Delta_t = V^*(s_t) - V_t^\\pi(s_t),')
('4', 'V^*')
('4', 'V_t^\\pi')
('4', 'V_t^\\pi(s) = \\mathbb{E}^\\pi \\Big[\\sum_{i=0}^\\infty \\gamma^i r(s_{t+i}, a_{t+i}) | s_1, \\dots, s_{t-1}, s_t = s \\Big]')
('4', '1-\\delta')
('4', '\\mathrm{Regret}(T) \\leq \\widetilde{{\\mathcal{O}}} \\Big( \\frac{1}{\\Delta ^2(1-\\gamma)^2} \\cdot \\big(d\\sqrt{C }/\\Delta + \\sqrt{dNK} \\big) \\cdot \\sqrt{T}  \\Big) + \\mathrm{polylog}(T)\\text{-}\\mathrm{terms},')
('4', 'd = \\mathrm{dim} ({\\mathcal{T}}^*) = d_1^2d_2')
('4', '\\widetilde{{\\mathcal{O}}} \\Big( \\frac{1}{\\Delta ^2(1-\\gamma)^2} \\cdot \\big(d\\sqrt{C }/\\Delta + \\sqrt{dNK} \\big) \\cdot \\sqrt{T}  \\Big)')
('4', 'NK')
('4', '1/\\Delta^2')
('4', '\\pi')
('4', '1-p')
('4', 't\\geq 1')
('4', '\\|s_t\\|_1 \\leq   {{\\mathcal{O}}}(\\frac{1}{\\Delta^2}\\log\\frac{4t^2}{p}). \\label{eq:uc-bound}')
('4', 'NK')
('4', 't')
('4', '\\| \\widehat{{\\mathcal{T}}}_t - {\\mathcal{T}}^* \\|_{\\Sigma_{t-1}} \\leq \\beta_t')
('4', '\\beta_t')
('4', '\\widetilde{{\\mathcal{O}}}(\\sigma\\sqrt{d} + 1)')
('4', '\\sigma^2')
('4', '\\mathrm{var}[(s_{t+1})_{i,k}|s_t,a_t]')
('4', '\\begin{aligned}\n    \\mathrm{var}[(s_{t+1})_{i,k}|s_t,a_t] \\leq \\mathbb{E}[(s_{t+1})_{i,k}|s_t,a_t] = \\sum_j \\mathbf{A}^k_{i,j}(s_{ta_t})_{j,k}  \\leq \\frac{C}{NK}(\\|s_t\\|_1 + 1) \\leq \\widetilde{{\\mathcal{O}}}(\\frac{C}{NK\\Delta^2}).\n\\end{aligned}')
('4', '\\beta_t = \\widetilde{{\\mathcal{O}}}(\\sqrt{\\frac{dC}{NK}}/\\Delta+ 1)')
('4', '\\beta_t = \\widetilde{{\\mathcal{O}}}(\\sqrt{d})')
('4', '\\widetilde{\\mathrm{Regret}}(T) = \\sum_{t=1}^T(\\widetilde{V}^*(s_t) - \\widetilde{V}^\\pi_t(s_t))')
('4', '\\widetilde{V}^*')
('4', '\\widetilde{V}^\\pi_t')
('4', '\\widetilde{r}(s,a) = \\min\\{r(s,a), \\Lambda\\}')
('4', '1-1/(2NKT)')
('4', 'r(s_t,a_t) \\leq \\|s_t\\|_1 \\leq \\Lambda = \\widetilde{{\\mathcal{O}}}(1/\\Delta^2)')
('4', 't\\leq T')
('4', 'r(s_t,a_t) = \\widetilde r(s_t,a_t)')
('4', '\\mathrm{Regret}(T) \\leq \\widetilde{\\mathrm{Regret}}(T) + 1/(1-\\gamma)')
('4', "\\mathbb{P}(s'|s,a)")
('4', "\\widehat \\mathbb{P}(s'|s,a)")
('4', 'b(s,a) \\geq \\gamma \\|V\\|_\\infty \\cdot \\| \\mathbb{P}(\\cdot|s,a) - \\widehat \\mathbb{P}(\\cdot|s,a) \\|_1')
('4', "\\mathbb{P}(s'|s,a)")
('4', '\\widehat \\mathbb{P}(\\cdot|s,a)')
('4', '\\displaystyle \\mathbb{P}(\\cdot|s,a) = \\otimes _{i=1}^N\\otimes _{k=1}^K \\mathbb{P}_{i,k}(\\cdot|s,a)')
('4', '\\widehat \\mathbb{P}(\\cdot|s,a) = \\otimes _{i=1}^N\\otimes _{k=1}^K \\widehat\\mathbb{P}_{i,k}(\\cdot|s,a)')
('4', '\\| \\mathbb{P}(\\cdot|s,a) - \\widehat \\mathbb{P}(\\cdot|s,a) \\|_1 \\leq  \\sum _{i=1}^N \\sum_{k=1}^K \\| \\mathbb{P}_{i,k}(\\cdot|s,a) - \\widehat \\mathbb{P}_{i,k}(\\cdot|s,a) \\|_1.')
('4', '\\mathbb{P}_{i,k}(\\cdot|s,a)')
('4', '\\| \\mathbb{P}_{i,k}(\\cdot |s,a) - \\widehat\\mathbb{P}_{i,k}(\\cdot |s,a) \\|_1 \\leq 2(1 \\wedge |\\langle {\\mathcal{T}}^* - \\widehat{{\\mathcal{T}}} , \\phi_{i,k}(s,a) \\rangle |)')
('4', '\\begin{aligned}\n    \\widetilde{\\mathrm{Regret}}(T) \\leq  {\\mathcal{O}}\\Big\\{\\frac{1}{1-\\gamma}\\Big[  \\sum_{t=1}^T b_{t_s}(s_t,a_t) +  \\frac{2\\gamma\\Lambda}{1-\\gamma} \\sqrt{T\\log\\frac{1}{\\delta}} + \\Big( \\frac{\\Lambda}{1-\\gamma} M \\Big) \\Big] \\Big\\},\n\\end{aligned}')
('4', 'M = M(T)')
('4', 'M  = \\widetilde{{\\mathcal{O}}}(d)')
('4', '\\begin{aligned}\n    \\frac{1}{1-\\gamma} \\sum_{t=1}^T b_{t_s}(s_t,a_t) &=  \\widetilde{{\\mathcal{O}}}\\Big (\\frac{1}{(1-\\gamma)^2\\Delta^2} \\Big) \\cdot \\beta_T \\cdot \\sum_{t=1}^T \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|_{\\Sigma_{{t_s}-1}^{-1}} )\\\\\n    &\\leq \\widetilde{{\\mathcal{O}}}\\Big (\\frac{1}{(1-\\gamma)^2\\Delta^2} \\Big) \\cdot \\beta_T \\cdot  \\widetilde{{\\mathcal{O}}}(\\sqrt{dNKT} + MNK).\n\\end{aligned}')
('4', 't_s')
('4', 't')
('4', '\\beta_T')
('5.0', 'N=300')
('5.0', 'x_i \\in \\mathbb{R}^{d_1}, d_1=6')
('5.0', '\\theta_k \\in [0,1]^{d_2}, d_2=3, ||\\theta_k||_{\\infty}=1')
('5.0', 'K=4')
('5.0', '100')
('5.0', '{\\mathcal{T}}^* \\in \\mathbb{R}^{d_1d_1d_2}')
('5.0', '\\mathbf{A}^k, k \\in [K]')
('5.0', 'S')
('5.0', '|{\\mathcal{S}}|=2^{NK}')
('5.0', 's \\in \\{0,1\\}^{N \\times K}, NK=1200')
('5.0', '1200')
('5.0', 'a \\in [N] \\times [K]')
('5.0', 't')
('5.0.0', '\\gamma = 0.9, \\lambda = 1')
('5.0.0', 'b=2')
('5.0.0', 'b')
('5.0.0', 'b')
('5.0.0', '\\widehat{\\mathbf{A}}')
('5.0.0', '\\mathbf{A}^k')
('5.0.0', '\\mathbf{A}^k')
('5.0.0.0', '\\mathbf{A}')
('5.0.0.0', '{\\mathcal{T}}^*')
('6', '\\widetilde {\\mathcal{O}}( d\\sqrt{T}/\\Delta+ \\sqrt{dNKT})')
('7.0', '1-\\delta')
('7.0', 't \\geq 1')
('7.0', '\\| \\widehat{{\\mathcal{T}}}_t - {\\mathcal{T}}^* \\|_{\\Sigma_{t-1}} \\leq \\beta_t,')
('7.0', '\\beta_t =  \\Big(\\frac{24}{\\Delta} \\sqrt{ {C}/{(NK)} \\cdot d \\cdot  \\log(1+NK L^2 t/(d\\lambda))} + 4 \\Big) \\log(8N^2K^2t^2/\\delta) +  \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2.')
('7.0', 'L = \\sup \\|\\phi_{i,k}^t\\|_2')
('7.0', 'd = d_1^2d_2')
('7.0', '\\pi')
('7.0', '1-\\delta')
('7.0', 't\\geq 1')
('7.0', '\\|s_t\\|_1 \\leq \\frac{2}{\\Delta}(\\frac{2}{\\Delta}\\log \\frac{2 t^2}{ \\delta} + 1).')
('7.0', '\\{{\\mathcal{F}}_t\\}_{t=1}^\\infty')
('7.0', '\\{x_t^i,y_t^i\\}_{t\\geq 1, 1\\leq i\\leq m}')
('7.0', 'x_t^i \\in \\mathbb{R}^d')
('7.0', '{\\mathcal{F}}_t')
('7.0', 'y_t^i \\in \\mathbb{R}')
('7.0', '{\\mathcal{F}}_{t+1}')
('7.0', '{\\mathcal{F}}_t')
('7.0', '\\{y_t^1,\\cdots,y_t^m\\}')
('7.0', '|y_t^i| \\leq R, \\quad \\mathbb{E}[y_t^i|{\\mathcal{F}}_t] = \\langle {\\mathcal{T}}^*, x_t^i \\rangle,\\quad \\mathrm{var}[y_t^i|{\\mathcal{F}}_t] \\leq \\sigma^2,\\quad \\|x_t^i\\|_2 \\leq L,')
('7.0', '1-\\delta')
('7.0', 't\\geq 1')
('7.0', '\\| \\widehat{{\\mathcal{T}}}_t - {\\mathcal{T}}^* \\|_{\\Sigma_{t-1}} \\leq \\beta_t , \\quad \\Big \\| \\sum_{i=1}^m\\sum_{\\tau=1}^{t-1} x_\\tau^i (y_\\tau^i - \\langle {\\mathcal{T}}^*, x_\\tau^i \\rangle) \\Big  \\|_{\\Sigma_{t-1}^{-1}} \\leq \\beta_t - \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2.')
('7.0', '\\widehat{{\\mathcal{T}}}_t = \\Sigma_{t-1}^{-1} B_{t-1}')
('7.0', '\\Sigma_{t-1} = \\lambda I + \\sum_{i=1}^m \\sum_{\\tau=1}^{t-1} x_\\tau^i (x_\\tau^i)^\\top')
('7.0', 'B_{t-1} = \\ \\sum_{i=1}^m \\sum_{\\tau=1}^{t-1} x_\\tau^i y_\\tau^i')
('7.0', '\\beta_t = 8\\sigma \\sqrt{d\\log(1+mtL^2/(d\\lambda))\\log(4m^2t^2/\\delta)} + 4R\\log(4m^2t^2/\\delta) + \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2.')
('7.0', '\\{\\phi_{i,k}^t, (s_{t+1})_{i,k}\\}')
('7.0', '\\sigma^2')
('7.0', '\\mathrm{var}[(s_{t+1})_{i,k}|s_t,a_t]')
('7.0', '\\mathrm{var}[(s_{t+1})_{i,k}|s_t,a_t] \\leq \\mathbb{E}[(s_{t+1})_{i,k}|s_t,a_t] = \\sum_j \\mathbf{A}^k_{i,j}(s_{ta_t})_{j,k} \\leq \\frac{C}{NK} \\sum_j (s_{ta_t})_{j,k} \\leq \\frac{C}{NK}(\\|s_t\\|_1 + 1).')
('7.0', '\\mathbf{A}^k_{i,j}\\leq\\frac{C}{NK}')
('7.0', '1-\\delta/2')
('7.0', 't')
('7.0', '\\|s_t\\|_1 \\leq   \\frac{2}{\\Delta}(\\frac{2}{\\Delta}\\log \\frac{4 t^2}{ \\delta} + 1).')
('7.0', '\\mathrm{var}[(s_{t+1})_{i,k}|s_t,a_t] \\leq \\frac{C}{NK}(\\frac{2}{\\Delta}(\\frac{2}{\\Delta}\\log \\frac{4 t^2}{ \\delta} + 1)+ 1) \\leq  \\frac{C}{NK}(\\frac{3}{\\Delta})^2\\log \\frac{4 t^2}{ \\delta}.')
('7.0', 'm=NK')
('7.0', 'R=1')
('7.0', '\\sigma^2 =  \\frac{C}{NK}({3}/{\\Delta})^2\\log \\frac{4 t^2}{ \\delta}')
('7.0', '\\beta_t =   \\frac{24}{\\Delta} \\sqrt{ {C}/{(NK)} \\cdot d \\cdot \\log ({4 t^2} / { \\delta}) \\log(1+NK L^2 t/(d\\lambda))\\log(8N^2K^2t^2/\\delta)} + 4 \\log(8N^2K^2t^2/\\delta) + \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2,')
('7.1', '\\|s_t\\|_1')
('7.1', '\\mathbb{E}[(s_{t+1})_{i,k}|s_t,a_t]  = \\sum_j \\mathbf{A}^k_{i,j} (s_{ta_t})_{j,k}')
('7.1', '\\mathbb{E}[\\|s_{t+1}\\|_1  |s_t,a_t] = \\sum_{i,j,k} \\mathbf{A}^k_{i,j} (s_{ta_t})_{j,k}')
('7.1', 'k')
('7.1', 'j')
('7.1', '\\sum_{i} \\mathbf{A}^k_{i,j} \\leq 1 - \\Delta.')
('7.1', '\\mathbb{E}[\\|s_{t+1}\\|_1  |s_t,a_t] \\leq (1 - \\Delta) \\sum_{j,k} (s_{ta_t})_{j,k}  = (1-\\Delta) \\|s_{ta_t}\\|_1 \\leq  (1-\\Delta) (\\|s_{t}\\|_1 + 1), \\label{eq:s:1}')
('7.1', '(s_t,a_t)')
('7.1', '\\|s_{t+1}\\|')
('7.1', 'NK')
('7.1', '1-\\delta_t')
('7.1', '\\|s_{t+1}\\|_1 -  \\mathbb{E}[\\|s_{t+1}\\|_1  |s_t,a_t] \\leq 2(\\sqrt{\\sum_{i,k} \\mathrm{var}[ (s_{t+1})_{i,k} |s_t,a_t] \\log\\frac{1}{\\delta_t} } + \\log \\frac{1}{\\delta_t}).')
('7.1', '\\|s_{t+1}\\|_1 -  \\mathbb{E}[\\|s_{t+1}\\|_1  |s_t,a_t] \\leq 2( \\sqrt{ \\mathbb{E}[\\|s_{t+1}\\|_1  |s_t,a_t] \\log\\frac{1}{\\delta_t}}  + \\log \\frac{1}{\\delta_t}),')
('7.1', '\\begin{aligned}\n        \\|s_{t+1}\\|_1 & \\leq (1-\\Delta) (\\|s_{t}\\|_1 + 1) + 2\\sqrt{(1-\\Delta) (\\|s_{t}\\|_1 + 1) \\log\\frac{1}{\\delta_t}} + 2 \\log\\frac{1}{\\delta_t} \\\\\n        & \\leq (1-\\Delta) (\\|s_{t}\\|_1 + 1) +  \\frac{\\Delta}{2} (\\|s_{t}\\|_1 + 1)  +  \\frac{2}{\\Delta} (1-\\Delta)\\log\\frac{1}{\\delta_t} + 2 \\log\\frac{1}{\\delta_t} \\\\\n        & =  (1-\\Delta/2) (\\|s_{t}\\|_1 + 1) + \\frac{2}{\\Delta}\\log\\frac{1}{\\delta_t}  ,\n    \n\\end{aligned}')
('7.1', 'at+b/t \\geq 2\\sqrt{ab}')
('7.1', '\\delta_t = \\frac{\\delta}{2t^2}')
('7.1', '\\sum_t \\delta_t \\leq \\delta')
('7.1', 't\\geq 1')
('7.1', '1-\\delta')
('7.1', '\\|s_t\\|_1 \\leq \\frac{2}{\\Delta}(\\frac{2}{\\Delta}\\log \\frac{2 t^2}{ \\delta} + 1)')
('7.1', 't\\geq 1')
('7.1', '{\\mathcal{G}}_{t,i} = \\sigma({\\mathcal{F}}_{t}, y_t^1, \\dots,y_t^{i-1})')
('7.1', '1\\leq i \\leq m')
('7.1', '{\\mathcal{G}}_{t,i} \\subseteq {\\mathcal{G}}_{t,i+1}')
('7.1', 'i=m+1')
('7.1', '{\\mathcal{G}}_{t,m+1} = \\sigma({\\mathcal{F}}_{t}, y_t^1, \\dots,y_t^{m}) \\subseteq {\\mathcal{G}}_{t+1,1} = {\\mathcal{F}}_{t+1}')
('7.1', '{\\mathcal{G}}_{1,1} \\subseteq {\\mathcal{G}}_{1,2} \\subseteq \\dots \\subseteq {\\mathcal{G}}_{1,m} \\subseteq {\\mathcal{G}}_{2,1} \\subseteq {\\mathcal{G}}_{2,2} \\subseteq \\dots \\subseteq {\\mathcal{G}}_{2,m} \\subseteq \\dots \\subseteq  {\\mathcal{G}}_{t,1} \\subseteq {\\mathcal{G}}_{t,2} \\subseteq \\dots \\subseteq {\\mathcal{G}}_{t,m}  \\subseteq \\dots')
('7.1', 'x_t^i')
('7.1', '{\\mathcal{G}}_{t,i}')
('7.1', 'y_t^i')
('7.1', '{\\mathcal{G}}_{t,i+1}')
('7.1', 'y_t^i | {\\mathcal{G}}_{t,i} \\ =_d\\   y_t^i | {\\mathcal{F}}_{t}, y_t^1, \\dots,y_t^{i-1} \\ =_d\\  y_t^i | {\\mathcal{F}}_{t}.')
('7.1', '1-\\delta')
('7.1', 't\\geq 1')
('7.1', 'i=1,\\dots, m')
('7.1', '\\| \\widehat{{\\mathcal{T}}}_{t,i} - {\\mathcal{T}}^* \\|_{\\Sigma_{t,i}} \\leq \\beta_{t,i},')
('7.1', '\\Big \\| \\sum_{\\tau = 1}^{t-1} \\sum_{j=1}^m  x_\\tau^j (y_\\tau^j - \\langle {\\mathcal{T}}^*, x_\\tau^j \\rangle) + \\sum_{j=1}^i x_t^j (y_t^j - \\langle {\\mathcal{T}}^*, x_t^j \\rangle) \\Big  \\|_{\\Sigma_{t,i}^{-1}} \\leq \\beta_t - \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2,')
('7.1', '\\widehat{{\\mathcal{T}}}_{t,i} = \\Sigma_{t,i}^{-1} B_{t,i}, \\ \\Sigma_{t,i} = \\lambda I + \\sum_{\\tau = 1}^{t-1} \\sum_{j=1}^m x_\\tau^j (x_\\tau^j)^\\top + \\sum_{j=1}^i x_t^j(x_t^j)^\\top, B_{t,i} = \\sum_{\\tau = 1}^{t-1} \\sum_{j=1}^m x_\\tau^j y_\\tau^j + \\sum_{j=1}^i x_t^j y_t^j,')
('7.1', '\\beta_{t,i} = 8\\sigma\\sqrt{d\\log(1+ t_iL^2/(d\\lambda))\\log(4t_i^2/\\delta)} + 4 R  \\log(4t_i^2/\\delta)  + \\sqrt{\\lambda}\\|{\\mathcal{T}}^*\\|_2, \\quad t_i =m(t-1)+i.')
('7.1', 'i=m')
('8', 't_1 = 1')
('8', 's\\geq 1')
('8', 't_{s+1}')
('8', 't_{s+1} = \\min\\{t | \\det(\\Sigma_{t-1}) > 2 \\det(\\Sigma_{{t_s}-1})\\}.')
('8', 'W=\\{t_1,t_2,\\dots,t_M\\}')
('8', 'M')
('8', '1=t_1 < t_2 < \\dots < t_M \\leq T < t_{M+1}')
('8', 't_s')
('8', 't')
('8', 't_s \\leq t < t_{s+1}')
('8', 'Q_t = Q^*_{\\widehat{{\\mathcal{T}}}_{t_s}, \\widetilde r + b_{t_s}}')
('8', '\\mathrm{Regret}(T) = \\sum_{t=1}^T (V^*(s_t) - V_t^\\pi(s_t)), \\quad  \\widetilde \\mathrm{Regret}(T) = \\sum_{t=1}^T (\\widetilde V^*(s_t) - \\widetilde V_t^\\pi(s_t)),')
('8', 'V, \\mathrm{Regret}')
('8', '\\widetilde V, \\widetilde \\mathrm{Regret}')
('8', 'b_t(s,a) = \\frac{2\\Lambda\\gamma}{1-\\gamma} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge \\beta_t \\cdot \\| \\phi_{i,k} (s,a) \\|_{\\Sigma_{t-1}^{-1}} ).')
('8', '1-\\delta')
('8', '\\widetilde{Q}^*(s,a) \\leq Q_t(s,a)')
('8', 't \\geq 1')
('8', 'V(s)')
('8', '0\\leq V(s) \\leq \\Lambda/(1-\\gamma)')
('8', "\\gamma| \\mathbb{E}_{s'\\sim \\mathbb{P}(s'|s,a)} V(s') - \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_t}(s'|s,a)} V(s') | \\leq b_t(s,a).")
('8', 'T\\log(1/\\gamma)  \\geq  \\log(2NKT)')
('8', '\\pi')
('8', '\\mathrm{Regret}(T) \\leq \\widetilde{\\mathrm{Regret}}  (T) + \\frac{1}{1-\\gamma}.')
('8', 't')
('8', '1-\\delta')
('8', '\\begin{aligned}\n    \\widetilde \\mathrm{Regret}(T) \\leq \\frac{1}{1-\\gamma}\\Big[ 2 \\sum_{t=1}^T b_{t_s}(s_t,a_t) +  \\frac{2\\gamma \\Lambda}{1-\\gamma} \\sqrt{T\\log\\frac{1}{\\delta}} + \\gamma   \\Big(2\\Lambda/(1-\\gamma) + E_T \\Big) \\Big].\n\\end{aligned}')
('8', 'E_T')
('8', 'E_T = \\sum_{t=1}^T V_t(s_{t+1}) - V_{t+1}(s_{t+1}).')
('8', 'M')
('8', 'M < \\frac{1}{\\log 2} d \\log  \\Big( \\frac{d +  NKTL^2/\\lambda }{d}\\Big) + 1,')
('8', 'L = \\sup \\|\\phi_{i,k}^t\\|_2')
('8', '1-2\\delta')
('8', 'T\\log(1/\\gamma)  \\geq  \\log(2NKT)')
('8', '\\mathrm{Regret}(T) \\leq \\frac{1}{1-\\gamma}\\Big[ 2 \\sum_{t=1}^T b_{t_s}(s_t,a_t) +  \\frac{2\\gamma \\Lambda}{1-\\gamma} \\sqrt{T\\log\\frac{1}{\\delta}} + \\gamma   \\Big(2\\Lambda/(1-\\gamma) + E_T \\Big) \\Big] + \\frac{1}{1-\\gamma}.')
('8', '\\sum_{t=1}^T b_{t_s}(s_t,a_t)')
('8', 'b_{t_s}(s_t,a_t) \\leq \\frac{2\\gamma\\Lambda}{1-\\gamma}\\beta_T \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|_{\\Sigma_{t_{s}-1}^{-1}} ).')
('8', '(i,k)')
('8', '\\Sigma_{t,i,k} = \\Sigma_{t-1} + \\sum_{j=1}^{i-1}\\sum_{l=1}^K \\phi_{j,l}^t(\\phi_{j,l}^t)^\\top +  \\sum_{l=1}^k \\phi_{i,l}^t(\\phi_{i,l}^t)^\\top')
('8', 't_{s+1} = \\min \\{t| \\det(\\Sigma_{t-1}) > 2 \\det(\\Sigma_{t_s  - 1})\\}')
('8', '\\det(\\Sigma_{t_{s+1}-2}) \\leq 2\\det(\\Sigma_{t_s-1})')
('8', 't_s \\leq t < t_{s+1} - 1')
('8', '\\det(\\Sigma_{t,i,k}) \\leq \\det(\\Sigma_{t}) \\leq  \\det(\\Sigma_{t_{s+1}-2}) \\leq 2\\det(\\Sigma_{t_s-1}).')
('8', '\\| \\phi_{i,k}(s_t,a_t) \\|_{\\Sigma_{t_s - 1}^{-1}}^2 \\leq 2 \\| \\phi_{i,k}(s_t,a_t) \\|_{\\Sigma_{t,i,k-1}^{-1}}^2.')
('8', '\\begin{aligned}\n        &\\quad \\sum_{t=1}^T \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|_{\\Sigma_{t_{s}-1}^{-1}} ) \\\\\n        & = \\sum_{t +1 \\in W} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|_{\\Sigma_{t_{s}-1}^{-1}} ) +  \\sum_{t +1 \\notin W} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|_{\\Sigma_{t_{s}-1}^{-1}} )\\\\\n        & \\leq MNK +  \\sqrt{NKT \\sum_{t +1 \\notin W} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|^2_{\\Sigma_{t_{s}-1}^{-1}} )} \\\\\n        & \\leq MNK+  \\sqrt{2NKT \\sum_{t +1 \\notin W} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|^2_{\\Sigma_{t,i,k-1}^{-1}} )} \\\\\n        & \\leq MNK+  \\sqrt{2NKT \\sum_{t=1}^T \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge  \\| \\phi_{i,k} (s_t,a_t) \\|^2_{\\Sigma_{t,i,k-1}^{-1}} )} \\\\\n        & \\leq MNK+  \\sqrt{2NKT \\cdot 2d\\log\\frac{d\\lambda+NKTL^2}{d\\lambda} },\n\\end{aligned}')
('8', '\\sum_{t=1}^T b_{t_s}(s_t,a_t) \\leq \\frac{2\\gamma\\Lambda}{1-\\gamma}  \\beta_T \\Big( MNK+ \\sqrt{4NKdT \\log\\frac{d\\lambda+NKTL^2} {d\\lambda} } \\Big).')
('8', 'E_T')
('8', 'M')
('8', 'M')
('8', 'E_T')
('8', 'E_T = \\sum_{t=1}^T(V_t(s_{t+1}) - V_{t+1}(s_{t+1})) \\leq  \\frac{\\Lambda}{1-\\gamma} M.')
('8', 'E_T = \\widetilde{{\\mathcal{O}}}( \\frac{\\Lambda}{1-\\gamma} d)')
('8', 'T\\log(1/\\gamma)  \\geq  \\log(2NKT)')
('8', '\\mathrm{Regret}(T) \\leq \\widetilde{{\\mathcal{O}}} \\Big( \\frac{1}{\\Delta ^2(1-\\gamma)^2} \\cdot \\big(d\\sqrt{C }/\\Delta + \\sqrt{dNK} \\big) \\cdot \\sqrt{T}  \\Big) + \\mathrm{polylog}(T)\\text{-}\\mathrm{terms},')
('8', 'd = \\mathrm{dim} ({\\mathcal{T}}^*) = d_1^2d_2')
('8', 'T\\log(1/\\gamma)  \\leq  \\log(2NKT)')
('8.0', '\\widehat\\mathbb{P}=  \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_t}')
('8.0', '\\widehat{{\\mathcal{T}}}_t')
('8.0', '\\mathbb{P}_{i,k}(\\cdot |s,a)')
('8.0', '\\langle {\\mathcal{T}}^* , \\phi_{i,k}(s,a) \\rangle')
('8.0', '\\mathbb{P}_{i,k}(\\cdot |s,a)')
('8.0', '\\langle \\widehat{{\\mathcal{T}}}_t , \\phi_{i,k}(s,a) \\rangle')
('8.0', '\\| \\mathbb{P}_{i,k}(\\cdot |s,a) - \n        \\widehat\\mathbb{P}_{i,k}(\\cdot |s,a) \\|_1 \\leq 2(1 \\wedge |\\langle {\\mathcal{T}}^* - \\widehat{{\\mathcal{T}}}_t , \\phi_{i,k}(s,a) \\rangle |).')
('8.0', '1-\\delta')
('8.0', '\\|{\\mathcal{T}}^* - \\widehat{{\\mathcal{T}}}_t \\|_{\\Sigma_{t-1}} \\leq \\beta_t')
('8.0', 't\\geq 1')
('8.0', '\\| \\mathbb{P}_{i,k}(\\cdot |s,a) - \n        \\widehat\\mathbb{P}_{i,k}(\\cdot |s,a) \\|_1 \\leq 2(1 \\wedge \\beta_t \\cdot \\|\\phi_{i,k}(s,a)\\|_{\\Sigma_{t-1}^{-1}}).')
('8.0', '\\| \\mathbb{P}(\\cdot |s,a) - \n        \\widehat\\mathbb{P}(\\cdot |s,a) \\|_1 \\leq \\sum_{i,k} \\| \\mathbb{P}_{i,k}(\\cdot |s,a) - \n        \\widehat\\mathbb{P}_{i,k}(\\cdot |s,a) \\|_1 \\leq 2 \\sum_{i,k}(1 \\wedge \\beta_t \\cdot \\|\\phi_{i,k}(s,a)\\|_{\\Sigma_{t-1}^{-1}}).')
('8.0', '\\pi^*')
('8.0', '\\begin{aligned}\n    V^*(s_t)  - \\widetilde V^*(s_t) & =  V^*(s_t)  - \\widetilde V^{\\pi^*}(s_t) + \\widetilde V^{\\pi^*}(s_t) -  \\widetilde V^*(s_t)  \\\\\n    &\\leq V^*(s_t)  - \\widetilde V^{\\pi^*}(s_t) \\\\\n    & = \\mathbb{E}^{\\pi^*} \\Big [\\sum_{i=1}^\\infty\\gamma^{i-1} r (s_i,a_i) \\Big | s_1 =s_t \\Big] -  \\mathbb{E}^{\\pi^*} \\Big[ \\sum_{i=1}^\\infty \\gamma^{i-1} \\widetilde r (s_i,a_i)  \\Big| s_1 =s_t\\Big],\n\\end{aligned}')
('8.0', '\\widetilde V^*(s_t)')
('8.0', '\\delta_0 = 1/(2NKT)')
('8.0', '\\pi^*')
('8.0', '1-\\delta_0')
('8.0', '\\|s_i\\|_1  \\leq \\Lambda = \\frac{6}{\\Delta^2} \\log(4NKT^3)')
('8.0', '1 \\leq i \\leq T')
('8.0', '1-\\delta_0')
('8.0', 'r(s_i,a_i) = \\widetilde r (s_i,a_i)')
('8.0', '1 \\leq i \\leq T')
('8.0', '\\begin{aligned}\n    V^*(s_t)  - \\widetilde V^*(s_t) &  = \\mathbb{E}^{\\pi^*} \\Big [\\sum_{i=1}^\\infty\\gamma^{i-1} (r (s_i,a_i) -\\widetilde r (s_i,a_i))  \\Big| s_1 =s_t\\Big] \\\\\n    &= \\mathbb{E}^{\\pi^*} \\Big [\\sum_{i=1}^T \\gamma^{i-1} (r (s_i,a_i) -\\widetilde r (s_i,a_i))  \\Big| s_1 =s_t\\Big] + \\mathbb{E}^{\\pi^*} \\Big [\\sum_{i=T+1}^\\infty \\gamma^{i-1} (r (s_i,a_i) -\\widetilde r (s_i,a_i))  \\Big| s_1 =s_t\\Big] \\\\\n    &\\leq  (1-\\delta_0)\\cdot 0 + \\delta_0 \\sum_{i=1}^T \\gamma^{i-1} NK +  NK \\frac{\\gamma^{T}}{1-\\gamma} \\\\\n    & \\leq \\frac{1}{ 1-\\gamma } \\delta_0 NK + \\frac{1}{ 1-\\gamma } \\delta_0 NK = \\frac{1}{ T(1-\\gamma)},\n\\end{aligned}')
('8.0', 'T\\log(1/\\gamma)  \\geq  \\log(2NKT)')
('8.0', '\\begin{aligned}\n    V_t^\\pi(s_t)  - \\widetilde V_t^\\pi(s_t) = \\mathbb{E}^{\\pi} \\Big [\\sum_{i=0}^\\infty \\gamma^{t+i} (r (s_{t+i},a_{t+i}) - \\widetilde r (s_{t+i},a_{t+i}) )  \\Big| s_1,\\cdots, s_t \\Big] \\geq 0.\n\\end{aligned}')
('8.0', '\\mathrm{Regret}(T) \\leq \\widetilde{\\mathrm{Regret}}  (T) + \\sum_{t=1}^T [(V^*(s_t)  - \\widetilde V^*(s_t) ) - ( V_t^\\pi(s_t)  - \\widetilde V_t^\\pi(s_t))] \\leq \\widetilde{\\mathrm{Regret}}  (T) + \\frac{1}{1-\\gamma}.')
('8.0', 'V_t(s) = \\max_a Q_t(s,a)')
('8.0', '\\widetilde Q^*(s,a)\\leq Q_t(s,a)')
('8.0', '\\widetilde V^*(s) \\leq V_t(s)')
('8.0', '\\widetilde \\Delta_t =  \\widetilde V^*(s_t) - \\widetilde V_t^\\pi(s_t) \\leq V_t(s_t) - \\widetilde V_t^\\pi(s_t) = Q_t(s_t,a_t) - \\widetilde V_t^\\pi(s_t),')
('8.0', 'a_t \\in \\mathop{\\mathrm{argmax}}_a Q_t(s_t, a)')
('8.0', 'a_t')
('8.0', 'Q_t')
('8.0', 'Q^*_{\\widehat{{\\mathcal{T}}}_{t_s}, \\widetilde r+b_{t_s}}(s,a)')
('8.0', "Q^*_{\\widehat{{\\mathcal{T}}}_{t_s}, \\widetilde r+b_{t_s}}(s,a) = \\min \\{\\Lambda/(1-\\gamma),  \\widetilde r(s,a) + b_{t_s}(s,a) + \\gamma \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_{t_s}}(\\cdot|s,a)} \\max_{a'} Q^*_{\\widehat{{\\mathcal{T}}}_{t_s}, \\widetilde r+b_{t_s}}(s',a') \\}.")
('8.0', "\\begin{aligned}\n    \\widetilde \\Delta_t = & \\min\\Big \\{\\widetilde r(s_t,a_t)+b_{t_s}(s_t,a_t) + \\gamma \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_{t_s}}(\\cdot|s_t,a_t)} V_t(s') , \\Lambda /(1-\\gamma) \\Big \\} \\\\\n     & -  \\Big( \\widetilde r(s_t,a_t) + \\gamma \\mathbb{E}_{s' \\sim \\mathbb{P}(\\cdot|s_t,a_t)} \\widetilde V_{t+1}^\\pi (s')  \\Big) \\\\\n     \\leq & \\Big( \\widetilde r(s_t,a_t)+b_{t_s}(s_t,a_t) + \\gamma \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_{t_s}}(\\cdot|s_t,a_t)} V_t(s')\\Big) -  \\Big( \\widetilde r(s_t,a_t) + \\gamma \\mathbb{E}_{s' \\sim \\mathbb{P}(\\cdot|s_t,a_t)} \\widetilde V_{t+1}^\\pi (s')  \\Big) \\\\\n     = & b_{t_s}(s_t,a_t) + \\gamma \\Big( \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_{t_s}}(\\cdot|s_t,a_t)} V_t(s')-   \\mathbb{E}_{s' \\sim \\mathbb{P}(\\cdot|s_t,a_t)} \\widetilde V_{t+1}^\\pi (s') \\Big ) \\\\ \n     = & b_{t_s}(s_t,a_t) + \\gamma \\Big( \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_{t_s}}(\\cdot|s_t,a_t)} V_t(s')  -  \\mathbb{E}_{s' \\sim {\\mathbb{P}}(\\cdot|s_t,a_t)} V_t(s')\\Big) \\\\\n      & + \\gamma \\Big(  \\mathbb{E}_{s' \\sim {\\mathbb{P}}(\\cdot|s_t,a_t)} V_t(s')  -   \\mathbb{E}_{s' \\sim \\mathbb{P}(\\cdot|s_t,a_t)} \\widetilde V_{t+1}^\\pi (s') \\Big ).\n\\end{aligned}")
('8.0', "|V_t(s')|\\leq \\Lambda /(1-\\gamma)")
('8.0', "\\gamma \\Big( \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_{t_s}}(\\cdot|s_t,a_t)} V_t(s')  -  \\mathbb{E}_{s' \\sim {\\mathbb{P}}(\\cdot|s_t,a_t)} V_t(s')\\Big) \\leq b_{t_s}(s_t,a_t).")
('8.0', "\\begin{aligned}\n    & \\gamma \\Big(  \\mathbb{E}_{s' \\sim {\\mathbb{P}}(\\cdot|s_t,a_t)} V_t(s')  -   \\mathbb{E}_{s' \\sim \\mathbb{P}(\\cdot|s_t,a_t)} \\widetilde V_{t+1}^\\pi (s') \\Big ) \\\\\n    = &  \\gamma \\xi_t + \\gamma \\Big(V_t(s_{t+1}) - \\widetilde V_{t+1}^\\pi (s_{t+1})  \\Big),\n\\end{aligned}")
('8.0', "\\xi_t = \\Big(  \\mathbb{E}_{s' \\sim {\\mathbb{P}}(\\cdot|s_t,a_t)} (V_t(s') - \\widetilde V_{t+1}^\\pi (s')) - (V_t(s_{t+1}) - \\widetilde V_{t+1}^\\pi (s_{t+1})) \\Big ).")
('8.0', '\\begin{aligned}\n    \\sum_{t=1}^T \\widetilde \\Delta_t &\\leq \\sum_{t=1}^{T} \\Big(V_{t}(s_{t}) - \\widetilde V_{t}^\\pi (s_{t})  \\Big) \\\\\n    &\\leq 2 \\sum_{t=1}^T b_{t_s}(s_t,a_t) + \\gamma \\sum_{t=1}^T \\xi_t + \\gamma \\sum_{t=1}^T \\Big(V_t(s_{t+1}) - \\widetilde V_{t+1}^\\pi (s_{t+1})  \\Big). \n\\end{aligned}')
('8.0', '\\begin{aligned}\n    &\\qquad  \\sum_{t=1}^T \\Big(V_t(s_{t+1}) - \\widetilde V_{t+1}^\\pi (s_{t+1})  \\Big) \\\\\n    &= \\sum_{t=1}^T \\Big(V_{t+1}(s_{t+1}) - \\widetilde V_{t+1}^\\pi (s_{t+1})  \\Big)  + \\underbrace{\\sum_{t=1}^T\\Big( V_t(s_{t+1}) - V_{t+1}(s_{t+1}) \\Big)} _{E_T}\\\\\n    & = \\sum_{t=0}^{T-1} \\Big(V_{t+1}(s_{t+1}) - \\widetilde V_{t+1}^\\pi (s_{t+1})  \\Big) + \\Big[ V_{T+1}(s_{T+1}) -\\widetilde V_{T+1}^\\pi(s_{T+1}) - V_1(s_1) + \\widetilde V_1^\\pi(s_1) \\Big] + E_T \\\\ \n    & \\leq  \\sum_{t=1}^{T} \\Big(V_{t}(s_{t}) - \\widetilde V_{t}^\\pi (s_{t})  \\Big) + 2\\Lambda/(1-\\gamma) + E_T.\n\\end{aligned}')
('8.0', '\\{\\xi_t\\}')
('8.0', '1-\\delta')
('8.0', '\\sum_{t=1}^T \\xi_t \\leq    \\frac{2 \\Lambda}{1-\\gamma} \\sqrt{T\\log\\frac{1}{\\delta}}.')
('8.0', '\\begin{aligned}\n    \\widetilde \\mathrm{Regret}(\\pi ) &\\leq \\sum_{t=1}^{T} \\Big(V_{t}(s_{t}) -  \\widetilde V_{t}^\\pi (s_{t})  \\Big) \\\\\n    &\\leq 2 \\sum_{t=1}^T b_{t_s}(s_t,a_t) +  \\frac{2\\gamma\\Lambda}{1-\\gamma} \\sqrt{T\\log\\frac{1}{\\delta}} + \\gamma   \\Big(\\sum_{t=1}^{T} \\Big(V_{t}(s_{t}) - \\widetilde V_{t}^\\pi (s_{t})  \\Big) + 2\\Lambda/(1-\\gamma) + E_T \\Big),\n\\end{aligned}')
('8.0', '\\begin{aligned}\n    \\widetilde \\mathrm{Regret}(\\pi ) \\leq \\frac{1}{1-\\gamma}\\Big[ 2 \\sum_{t=1}^T b_{t_s}(s_t,a_t) +  \\frac{2\\gamma \\Lambda}{1-\\gamma} \\sqrt{T\\log\\frac{1}{\\delta}} + \\gamma   \\Big(2\\Lambda/(1-\\gamma) + E_T \\Big) \\Big].\n\\end{aligned}')
('8.0', '\\begin{aligned}\n        \\frac{\\det(\\Sigma_T)}{\\det(\\Sigma_0)} & \\geq \\prod_{s=1}^{M-1} \\frac{\\det(\\Sigma_{t_{s+1}-1})}{\\det(\\Sigma_{t_s-1})}> 2^{M-1}.\n    \n\\end{aligned}')
('8.0', '\\begin{aligned}\n        \\frac{\\det(\\Sigma_T)}{\\det(\\Sigma_0)} &= \\det(\\Sigma_0^{-1} \\Sigma_T)  \\leq \\Big(\\frac{\\mathrm{Tr}(\\Sigma_0^{-1}\\Sigma_T)}{d} \\Big)^d \\\\\n        & = \\Big(\\frac{\\mathrm{Tr}(\\boldsymbol I + \\lambda^{-1} \\sum_{i,k,t} \\phi_{i,k}^t (\\phi_{i,k}^t)^\\top )}{d} \\Big)^d \\\\\n        &\\leq \\Big( \\frac{d +  NKTL^2/\\lambda }{d}\\Big)^d.\n\\end{aligned}')
('8.0', 'M < \\frac{1}{\\log 2} d \\log  \\Big( \\frac{d +  NKTL^2/\\lambda }{d}\\Big) + 1')
('9', "\\mathbb{P}(s'|s,a)")
('9', "\\widehat \\mathbb{P}(s'|s,a)")
('9', '0 \\leq r(s,a) \\leq \\Lambda')
('9', 'Q^*')
('9', '{\\mathcal{M}}_{\\mathbb{P},r}')
('9', '\\widehat Q^*')
('9', '{\\mathcal{M}}_{\\widehat\\mathbb{P},r+b}')
('9', "\\widehat Q^*(s,a) = \\min\\{\\Lambda/(1-\\gamma), r(s,a)+b(s,a) + \\gamma \\mathbb{E}_{s'\\sim \\mathbb{P}(\\cdot|s,a)} \\max_{a'} \\widehat Q^*(s',a') \\}.")
('9', 'b(s,a) \\geq \\frac{\\gamma\\Lambda }{1-\\gamma}  \\| \\mathbb{P}(\\cdot|s,a) - \\widehat \\mathbb{P}(\\cdot|s,a) \\|_1,')
('9', '\\widehat Q^*(s,a) \\geq Q^*(s,a)  \\text{ for all } (s,a).')
('9', 'V(s)')
('9', '0\\leq V(s) \\leq \\Lambda/(1-\\gamma)')
('9', "\\gamma| \\mathbb{E}_{s'\\sim \\mathbb{P}(s'|s,a)} V(s') - \\mathbb{E}_{s'\\sim \\widehat \\mathbb{P}(s'|s,a)} V(s') | \\leq b(s,a).")
('9', '\\displaystyle \\mathbb{P}(\\cdot|s,a) = \\otimes _{i=1}^N  \\mathbb{P}_{i }(\\cdot|s,a)')
('9', '\\widehat \\mathbb{P}(\\cdot|s,a) = \\otimes _{i=1}^N  \\widehat\\mathbb{P}_{i }(\\cdot|s,a)')
('9', '\\| \\mathbb{P}(\\cdot|s,a) - \\widehat \\mathbb{P}(\\cdot|s,a) \\|_1 \\leq  \\sum _{i=1}^N  \\| \\mathbb{P}_{i }(\\cdot|s,a) - \\widehat \\mathbb{P}_{i }(\\cdot|s,a) \\|_1.')
('9', '\\{x_t\\}_{t=1}^T \\subseteq \\mathbb{R}^d')
('9', '\\Sigma_t = \\lambda \\boldsymbol I + \\sum_{t=1}^T x_t x_t^\\top')
('9', '\\sum_{t=1}^T (1 \\wedge \\|x_t\\|^2_{\\Sigma_{t-1}^{-1}})  \\leq 2d\\log\\frac{d\\lambda+TL^2}{d\\lambda},')
('9', 'L = \\sup \\|x_t\\|_2')
('9', 'A,B \\in \\mathbb{R}^{d\\times d}')
('9', 'A \\succeq B')
('9', 'x \\in \\mathbb{R}^d')
('9', '\\|x\\|_A^2 \\leq \\|x\\|_B^2 \\cdot \\frac{\\det(A)}{\\det(B)}.')
('10', 'K=1')
('10', 'd_2=1')
('10', 'd_1=6')
('10', '\\gamma=0.9')
('10', '\\mathbf{A}^k')
('10', '\\mathbf{A}^k')
('10', '\\textit{k}')
('10', '\\textit{k}')
('10', '{\\mathcal{T}}^*')
('11', "s'")
('11', 'k\\in[K]')
('11', '\\mathbf{A}^k \\in \\mathbb{R}^{n \\times n}')
('11', "\\mathbb{P}(s_{i,k}' = 1|s) = \\mu(\\sum_{j} \\mathbf{A}^k_{i,j} s_{j,k}),\n    \\label{eq:generalized-user-content-transition}")
('11', '\\mu: \\mathbb{R}\\to \\mathbb{R}')
('11', '\\mu(0)=0')
('11', "1/\\kappa \\leq \\mu' \\leq 1")
('11', '\\kappa \\geq 1')
('11', "s_{i,k}'")
('11', 's')
('11.0', '{\\mathcal{T}}^*')
('11.0', '\\widehat {{\\mathcal{T}}}_t = \\mathop{\\mathrm{argmin}}_{{\\mathcal{T}}} L_t({\\mathcal{T}}) \\equiv \\Big \\|  \\lambda {\\mathcal{T}}+ \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu (\\langle {\\mathcal{T}}, \\phi_{i,k}^\\tau \\rangle )  - (s_{\\tau+1})_{i,k} \\big] \\phi_{i,k}^\\tau \\Big \\|_{\\Sigma_{t-1}^{-1}}, \\label{eq:gen-That}')
('11.0', '\\phi_{i,k}^t')
('11.0', '\\Sigma_{t}')
('11.0', 'b_t(s,a)')
('11.0', 'b_t(s,a) = \\frac{4 \\kappa \\gamma \\Lambda}{1-\\gamma} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge \\beta_t \\cdot \\| \\phi_{i,k} (s,a) \\|_{\\Sigma_{t-1}^{-1}} ) ,\n    \\label{eq:gen-bonus}')
('11.0', '2\\kappa')
('11.1', '\\kappa')
('11.1', '1-\\delta')
('11.1', '\\mathrm{Regret}(T) \\leq \\widetilde{{\\mathcal{O}}} \\Big( \\frac{\\kappa}{\\Delta ^2(1-\\gamma)^2} \\cdot \\big(d\\sqrt{C }/\\Delta + \\sqrt{dNK} \\big) \\cdot \\sqrt{T}  \\Big) + \\mathrm{polylog}(T)\\text{-}\\mathrm{terms},')
('11.1', 'd = \\mathrm{dim} ({\\mathcal{T}}^*) = d_1^2d_2')
('11.2', '\\pi')
('11.2', '1-\\delta')
('11.2', 't\\geq 1')
('11.2', '\\|s_t\\|_1 \\leq \\frac{2}{\\Delta}(\\frac{2}{\\Delta}\\log \\frac{2 t^2}{ \\delta} + 1).')
('11.2', '1-\\delta')
('11.2', 't \\geq 1')
('11.2', 'L_t({\\mathcal{T}}^*) \\leq \\beta_t,')
('11.2', '\\beta_t')
('11.2', 'b_t(s,a) = \\frac{4\\kappa\\Lambda\\gamma}{1-\\gamma} \\sum_{i=1}^N \\sum_{k=1}^K (1 \\wedge \\beta_t \\cdot \\| \\phi_{i,k} (s,a) \\|_{\\Sigma_{t-1}^{-1}} ).')
('11.2', '1-\\delta')
('11.2', '\\widetilde{Q}^*(s,a) \\leq Q_t(s,a)')
('11.2', 't \\geq 1')
('11.2', 'V(s)')
('11.2', '0\\leq V(s) \\leq \\Lambda/(1-\\gamma)')
('11.2', "\\gamma| \\mathbb{E}_{s'\\sim \\mathbb{P}(s'|s,a)} V(s') - \\mathbb{E}_{s'\\sim \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_t}(s'|s,a)} V(s') | \\leq b_t(s,a).")
('11.2', '\\kappa')
('11.3', '\\mu(0)=0')
('11.3', "\\mu' \\leq 1")
('11.3', 'z>0')
('11.3', '\\mu(z) = \\mu(z) - \\mu(0) \\leq z-0 = z')
('11.3', '\\mathbb{E}[(s_{t+1})_{i,k}|s_t,a_t]  = \\mu (\\sum_j \\mathbf{A}^k_{i,j} (s_{ta_t})_{j,k}) \\leq \\sum_j \\mathbf{A}^k_{i,j} (s_{ta_t})_{j,k}.')
('11.3', '\\begin{aligned}\n        L_t({\\mathcal{T}}^*) &= \\Big\\|  \\lambda {\\mathcal{T}}^*  + \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu (\\langle {\\mathcal{T}}^*, \\phi_{i,k}^\\tau \\rangle )  - (s_{\\tau+1})_{i,k} \\big] \\phi_{i,k}^\\tau \\Big \\|_{\\Sigma_{t-1}^{-1}} \\\\\n        &\\leq \\| \\lambda {\\mathcal{T}}^*  \\| _{\\Sigma_{t-1}^{-1}} + \\Big \\|  \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu (\\langle {\\mathcal{T}}^*, \\phi_{i,k}^\\tau \\rangle )  - (s_{\\tau+1})_{i,k} \\big] \\phi_{i,k}^\\tau \\Big \\|_{\\Sigma_{t-1}^{-1}} \\\\\n        &\\leq \\| \\lambda {\\mathcal{T}}^* \\| _{\\lambda \\boldsymbol I ^{-1}} + \\Big \\|  \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu (\\langle {\\mathcal{T}}^*, \\phi_{i,k}^\\tau \\rangle )  - (s_{\\tau+1})_{i,k} \\big] \\phi_{i,k}^\\tau \\Big \\|_{\\Sigma_{t-1}^{-1}} \\\\\n        &\\leq \\sqrt{\\lambda} \\|{\\mathcal{T}}^*\\|_2 + (\\beta_t -  \\sqrt{\\lambda} \\|{\\mathcal{T}}^*\\|_2) \\\\\n        &= \\beta_t,\n    \n\\end{aligned}')
('11.3', '\\widehat\\mathbb{P}=  \\mathbb{P}_{\\widehat{{\\mathcal{T}}}_t}')
('11.3', "\\mu' \\leq 1")
('11.3', '\\begin{aligned}\n        \\| \\mathbb{P}_{i,k}(\\cdot |s,a) - \n        \\widehat\\mathbb{P}_{i,k}(\\cdot |s,a) \\|_1 &\\leq 2(1 \\wedge |\\langle {\\mathcal{T}}^* - \\widehat{{\\mathcal{T}}}_t , \\phi_{i,k}(s,a) \\rangle |)\\\\\n        &\\leq 2(1 \\wedge \\|{\\mathcal{T}}^* - \\widehat{{\\mathcal{T}}}_t \\|_{\\Sigma_{t-1}} \\cdot \\|\\phi_{i,k}(s,a)\\|_{\\Sigma_{t-1}^{-1}}).\n    \n\\end{aligned}')
('11.3', '1-\\delta')
('11.3', 'L_t({\\mathcal{T}}^*) \\leq \\beta_t')
('11.3', 'L_t(\\widehat{{\\mathcal{T}}}_t) \\leq \\beta_t')
('11.3', 't\\geq 1')
('11.3', "\\begin{aligned}\n        2\\beta_t &\\geq L_t(\\widehat{{\\mathcal{T}}}_t) + L_t({\\mathcal{T}}^*)   \\\\\n        &\\geq \\Big \\|    \\lambda \\widehat{{\\mathcal{T}}}_t  + \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu (\\langle \\widehat{{\\mathcal{T}}}_t, \\phi_{i,k}^\\tau \\rangle )  - (s_{\\tau+1})_{i,k} \\big] \\phi_{i,k}^\\tau \n            - \\lambda {\\mathcal{T}}^*  - \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu (\\langle {\\mathcal{T}}^*, \\phi_{i,k}^\\tau \\rangle )  - (s_{\\tau+1})_{i,k} \\big] \\phi_{i,k}^\\tau \n          \\Big \\|_{\\Sigma_{t-1}^{-1}} \\\\\n        &= \\Big \\| \\Big[ \\lambda \\boldsymbol I +  \\sum_{\\tau=1}^{t-1} \\sum_{k=1}^K \\sum_{i=1}^N \\big[ \\mu' (\\langle \\widetilde {{\\mathcal{T}}}, \\phi_{i,k}^\\tau \\rangle )   \\big]  \\phi_{i,k}^\\tau (\\phi_{i,k}^\\tau)^\\top \\Big]   \\cdot (\\widehat{{\\mathcal{T}}}_t - {\\mathcal{T}}^*)  \\Big \\|_{\\Sigma_{t-1}^{-1}} \\\\\n        &\\geq 1/\\kappa \\cdot\\| \\Sigma_{t-1}  \\cdot  (\\widehat{{\\mathcal{T}}}_t - {\\mathcal{T}}^*)\\|_{\\Sigma_{t-1}^{-1}} \\\\\n        &= 1/\\kappa \\cdot \\| \\widehat{{\\mathcal{T}}}_t - {\\mathcal{T}}^* \\|_{\\Sigma_{t-1} },\n    \n\\end{aligned}")
('11.3', "\\mu'(\\cdot) \\geq 1/\\kappa")
