('0.0.0', 'N')
('0.0.0', '\\#')
('0.0.0', 'n')
('0.0.0', '\\#')
('0.0.0', 'd')
('0.0.0', 'h')
('0.0.0', '\\#')
('0.0.0', 'c')
('0.0.0', '\\#')
('0.0.0.0', 'w_{jk}')
('0.0.0.0', 'jk^{th}')
('0.0.0.0', '\\mathbf{W}')
('0.0.0.0', '\\mathbf{I}_k')
('0.0.0.0', 'k \\times k')
('0.0.0.0', '\\mathbf{0}')
('0.0.0.0', '\\mathbf{1}')
('0.0.0.0', '[n]')
('0.0.0.0', '1')
('0.0.0.0', 'n')
('0.0.0.0', '\\|\\cdot\\|_2')
('0.0.0.0', '\\|\\cdot \\|_{F}')
('0.0.0.0', '\\mathbbm{1}[x\\geq0]')
('0.0.1', '{\\mathbf{X}}\\in \\mathbb{R}^{h \\times d}')
('0.0.1', 'h')
('0.0.1', 'd')
('0.0.1', '\\begin{aligned}\n\\begin{split}\n    &\\mathbf{Q}={\\mathbf{X}}\\mathbf{W}_q,  \\quad  \\mathbf{W}_q\\in \\mathbb{R}^{d \\times d} \\\\\n    &\\mathbf{K}={\\mathbf{X}}\\mathbf{W}_k, \\quad \\mathbf{W}_k\\in \\mathbb{R}^{d \\times d} \\\\\n    &\\mathbf{V}={\\mathbf{X}}\\mathbf{W}_v, \\quad \\mathbf{W}_v\\in \\mathbb{R}^{d \\times d} \n\\end{split},\n\\end{aligned}')
('0.0.1', '\\begin{aligned}\n\\label{eq:standard_transformer}\n\\begin{split}\n    & \\mathbf{A}_{s,j}=\\mathrm{softmax}\\left( \\mathbf{Q}\\mathbf{K}^{\\top} \\right) \\mathbf{V}\\\\\n    & \\mathbf{A}_o= \\mathbf{A}_{s} \\mathbf{W}_o, \\quad \\mathbf{W}_o\\in \\mathbb{R}^{d \\times d} \\\\\n    & {\\mathbf{X}}_A=\\mathrm{LayerNorm}\\left( \\mathbf{A}_o \\right) + {\\mathbf{X}}\\\\\n    & {\\mathbf{X}}_B= \\sigma\\left(  {\\mathbf{X}}_A \\mathbf{W}_1 \\right)\\mathbf{W}_2\n\\end{split},\n\\end{aligned}')
('0.0.1', '\\sigma\\left( \\cdot \\right)')
('0.0.1', '\\mathbf{A}_o')
('0.0.1', '\\mathbf{A}_o')
('0.0.2', '{\\mathbf{X}}\\in \\mathbb{R}^{n \\times d}')
('0.0.2', '\\hat{\\mathbf{Y}} \\in \\mathbb{R}^{n \\times c}')
('0.0.2', 'c')
('0.0.2', '\\begin{aligned}\n \\label{eq:attention_only}\n    \\hat{\\mathbf{Y}}=\\mathrm{softmax}\\left( {\\mathbf{X}}\\mathbf{W}_q\\mathbf{W}_k^{\\top} {\\mathbf{X}}^{\\top} \\right) {\\mathbf{X}}\\mathbf{W}_v\\mathbf{W}_o.\n\\end{aligned}')
('0.0.2', '\\{{\\mathbf{X}}_i, \\mathbf{Y}_i\\}_{i=1}^N')
('0.0.2', '{\\mathbf{X}}_i \\in \\mathbb{R}^{n \\times d}')
('0.0.2', '\\mathbf{Y}_i \\in \\mathbb{R}^{n \\times c}')
('0.0.2', '\\begin{aligned}\n \\label{eq:attention_only_obj}\n    \\min_{\\mathbf{W}_q, \\mathbf{W}_k, \\mathbf{W}_v,\\mathbf{W}_o} \\sum_{i=1}^N\\mathcal{L}\\left( \\mathrm{softmax}\\left( {\\mathbf{X}}_i \\mathbf{W}_q\\mathbf{W}_k^{\\top} {\\mathbf{X}}_i^{\\top}  \\right){\\mathbf{X}}\\mathbf{W}_v\\mathbf{W}_o,\\mathbf{Y}_i \\right)+ \\frac{\\beta}{2}   \\sum_{\\# \\in \\{q,k,v,o\\}} \\left\\| \\mathbf{W}_{\\#} \\right\\|_{F}^2,\n\\end{aligned}')
('0.0.2', '\\mathcal{L}\\left( \\cdot \\right)')
('0.0.2', '\\beta >0')
('0.0.2.0', '\\mathrm{softmax}\\left( \\cdot \\right)')
('0.0.2.0', '\\begin{aligned}\n\\text{for any } \\mathbf{U} \\in \\mathbb{R}^{n \\times n}, \\quad \\exists \\mathbf{W}\\in \\Delta \\; \\mathrm{ s.t. }\\; \\mathrm{softmax}\\left( \\mathbf{U} \\right){\\mathbf{X}}= \\mathbf{W}{\\mathbf{X}},\n\\end{aligned}')
('0.0.2.0', '\\Delta :=\\{\\mathbf{W}\\in \\mathbb{R}^{n \\times n}: \\mathbf{w}_i\\geq \\mathbf{0}, \\mathbf{1}^\\top\\mathbf{w}_i=1 , \\forall i \\in [n]\\}')
('0.0.2.0', '\\begin{aligned}\n \\label{eq:simplex_regression}\n    \\min_{\\substack{  \\mathbf{W}_{1} \\in \\Delta\\\\ \\mathbf{W}_{2} \\in \\mathbb{R}^{d \\times d}, \\mathbf{W}_{3} \\in \\mathbb{R}^{d \\times c}}} \\sum_{i=1}^N\\mathcal{L}\\left( \\mathbf{W}_{1} {\\mathbf{X}}_i \\mathbf{W}_{2} \\mathbf{W}_{3},\\mathbf{Y}_i \\right)+ \\frac{\\beta}{2}  \\left( \\left\\| \\mathbf{W}_{2} \\right\\|_{F}^2 +\\left\\| \\mathbf{W}_{3} \\right\\|_{F}^2\\right).\n\\end{aligned}')
('0.0.2.0', '\\begin{aligned}\n \\label{eq:simplex_regression_multihead}\n    \\min_{\\substack{  \\mathbf{W}_{1j} \\in \\Delta\\\\ \\mathbf{W}_{2j} \\in \\mathbb{R}^{d \\times d}, \\mathbf{W}_{3j} \\in \\mathbb{R}^{d \\times c}}} \\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{j=1}^h \\mathbf{W}_{1j} {\\mathbf{X}}_i \\mathbf{W}_{2j} \\mathbf{W}_{3j},\\mathbf{Y}_i \\right)+ \\frac{\\beta}{2}  \\left( \\sum_{j=1}^h\\left\\| \\mathbf{W}_{2j} \\right\\|_{F}^2 +\\left\\| \\mathbf{W}_{3j} \\right\\|_{F}^2\\right).\n\\end{aligned}')
('0.0.2.1', 'y_i \\in \\mathbb{R}^{}')
('0.0.2.1', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}\\in \\mathbb{R}^{d}, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j},y_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}^2 +\\left( w_{3j} \\right)^{2}\\right).\n\\end{aligned}')
('0.0.2.1', '\\mathbf{w}_{2j}')
('0.0.2.1', 'w_{3j}')
('0.0.2.1', '\\ell_1')
('0.0.2.1', '\\ell_1')
('0.0.2.1', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_scaled}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\leq 1, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j},y_i \\right) + \\beta \\left\\| \\mathbf{w}_3 \\right\\|_{1}.\n\\end{aligned}')
('0.0.2.1', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_convex}\n    \\min_{\\mathbf{Z}\\in \\mathbb{R}^{ n \\times d}}  \\frac{1}{2} \\sum_{i=1}^N\\mathcal{L}\\left(  \\mathrm{trace}\\left( \\mathbf{Z}^\\top {\\mathbf{X}}_i \\right),y_i \\right)+ \\beta \\sum_{k=1}^n \\left\\| \\mathbf{z}_{k} \\right\\|_{2}.\n\\end{aligned}')
('0.0.2.1', '\\mathbf{Z}\\in \\mathbb{R}^{n \\times d}')
('0.0.2.1', '\\ell_2')
('0.0.2.1', '\\mathbf{Z}')
('0.0.2.1', '\\ell_1')
('0.0.2.1', 'k')
('0.0.2.1', '\\left\\{ y_i \\right\\}_{i=1}^{N}')
('0.0.2.1', '\\mathbf{w}_{1j} \\in \\Delta')
('0.0.2.1', '\\mathbf{Z}\\in \\mathbb{R}^{ n \\times d}')
('0.0.2.1', '\\{\\mathbf{w}_{1j}^{*},\\mathbf{w}_{2j}^{*},w_{3j}^{*}\\}_{j=1}^h')
('0.0.2.1', '\\begin{aligned}\n    \\mathbf{w}_{1j}^{*}= \\mathbf{e}_j,\\; \\mathbf{w}_{2j}^{*}=\\frac{\\mathbf{z}_j}{\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}},\\; w_{3j}^{*}=\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}, \\forall j \\in [h],\n\\end{aligned}')
('0.0.2.1', '\\mathbf{e}_j \\in \\mathbb{R}^{n}')
('0.0.2.1', 'j^{th}')
('0.0.2.1', '\\mathbf{z}_j \\in \\mathbb{R}^{d}')
('0.0.2.1', 'j^{th}')
('0.0.2.1', '\\mathbf{Z}')
('0.0.2.1', 'h')
('0.0.2.1', 'n')
('0.0.2.1', '\\mathbf{Z}')
('0.0.2.2', 'y_i \\in \\mathbb{R}^{}')
('0.0.2.2', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}\\in \\mathbb{R}^{d}, \\mathbf{w}_{3j} \\in \\mathbb{R}^{c} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{w}_{3j}, \\mathbf{y}_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}^2 +\\left\\| \\mathbf{w}_{3j} \\right\\|_{1}^2\\right),\n\\end{aligned}')
('0.0.2.2', '\\mathbf{y}_i \\in \\mathbb{R}^{c}')
('0.0.2.2', 'c')
('0.0.2.2', '\\ell_1^2')
('0.0.2.2', '\\mathbf{w}_{3j}')
('0.0.2.2', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_convex}\n    \\min_{\\mathbf{Z}_l \\in \\mathbb{R}^{ n \\times d}}  \\sum_{i=1}^N\\sum_{l=1}^c\\mathcal{L}\\left(  \\mathrm{trace}\\left( \\mathbf{Z}_l^\\top {\\mathbf{X}}_i \\right),y_{il} \\right)+ \\beta \\sum_{l=1}^c\\sum_{k=1}^n \\left\\| \\mathbf{z}_{lk} \\right\\|_{2}.\n\\end{aligned}')
('0.0.2.2', 'l')
('0.0.2.2', 'c')
('0.0.2.2', 'c')
('0.0.2.3', '{\\mathbf{X}}')
('0.0.2.3', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_fcn}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}, \\mathbf{w}_{3j} \\in \\mathbb{R}^{c}}} \\sum_{i=1}^N\\mathcal{L}\\left( \\sigma\\left( \\sum_{j=1}^h \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\right)\\mathbf{w}_{3j} ,\\mathbf{y}_i \\right)+ \\frac{\\beta}{2}  \\left( \\sum_{j=1}^h\\left\\| \\mathbf{w}_{2j} \\right\\|_{2}^2 +\\left\\| \\mathbf{w}_{3j} \\right\\|_{1}^2\\right),\n\\end{aligned}')
('0.0.2.3', '\\sigma\\left( \\cdot \\right)')
('0.0.2.3', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_convex_fcn}\n    \\min_{\\mathbf{Z}_{jl} \\in \\mathbb{R}^{ n \\times d}}  \\sum_{i=1}^N\\sum_{l=1}^c \\mathcal{L}\\left( \\sum_{j=1}^h \\mathbbm{1}_{ij}\\mathrm{trace}\\left( \\mathbf{Z}_{jl}^\\top {\\mathbf{X}}_i \\right),y_{il} \\right)+ \\beta \\sum_{l=1}^c\\sum_{j=1}^h\\sum_{k=1}^n \\left\\| \\mathbf{z}_{jlk} \\right\\|_{2},\n\\end{aligned}')
('0.0.2.3', '\\mathbbm{1}_{ij} :=\\mathbbm{1}\\left\\{ \\mathbf{u}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{u}_{2j} \\geq 0 \\right\\}_{}^{}')
('0.0.2.3', '\\left\\{ \\mathbf{u}_{1j},\\mathbf{u}_{2j} \\right\\}_{j=1}^{h}')
('0.0.2.3', 'h')
('0.0.3', '\\beta')
('0.0.3', '\\mod 97')
('0.0.3', '\\mod 15')
('0.0.3', '99\\%')
('0.0.3', '100\\%')
('0.0.3', '10^3')
('0.0.3', '10^5')
('0.0.3', '10 \\times')
('0.0.3', 'L')
('0.0.3', '\\mod 15')
('0.0.3', '99\\%')
('0.0.3', '\\mod 15')
('0.0.3', '99\\%')
('1.0.0', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_proof}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}\\in \\mathbb{R}^{d}, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j},y_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}^2 +\\left( w_{3j} \\right)^{2}\\right),\n\\end{aligned}')
('1.0.0', '\\left\\{ \\mathbf{w}_{2j}, w_{3j} \\right\\}_{j=1}^m')
('1.0.0', '\\begin{aligned}\n \\label{eq:scaling}\n    \\bar{\\mathbf{w}}_{2j} :=\\alpha_j \\mathbf{w}_{2j},\\;  \\bar{w}_{3j} :=\\frac{w_{3j}}{\\alpha_j}.\n\\end{aligned}')
('1.0.0', '\\alpha_j >0')
('1.0.0', '\\begin{aligned}\n   \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\bar{\\mathbf{w}}_{2j} \\bar{w}_{3j}=  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j}, \n\\end{aligned}')
('1.0.0', '\\alpha_j>0')
('1.0.0', '\\begin{aligned}\n    \\sum_{j=1}^h\\left( \\left\\| \\bar{\\mathbf{w}}_{2j} \\right\\|_{2}^2 +\\left( \\bar{w}_{3j} \\right)^{2}\\right)= \\sum_{j=1}^h\\left( \\alpha_j^2\\left\\|  \\mathbf{w}_{2j} \\right\\|_{2}^2 +\\frac{\\left( w_{3j} \\right)^{2}}{\\alpha_j^2}\\right) \\geq   2\\sum_{j=1}^h\\left( \\left\\| \\mathbf{w}_{2j} \\right\\|_{2} \\left\\vert w_{3j} \\right \\vert \\right) = 2\\sum_{j=1}^h\\left( \\left\\| \\bar{\\mathbf{w}}_{2j} \\right\\|_{2} \\left\\vert \\bar{w}_{3j} \\right \\vert \\right)\n\\end{aligned}')
('1.0.0', '\\alpha_j = \\sqrt{\\frac{\\left\\vert w_{3j} \\right \\vert }{\\left\\| \\mathbf{w}_{2j} \\right\\|_{2}}}')
('1.0.0', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_proof2}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}\\in \\mathbb{R}^{d}, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j},y_i \\right) + \\beta  \\sum_{j=1}^h\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\vert w_{3j}\\vert.\n\\end{aligned}')
('1.0.0', '\\begin{aligned}\n    \\mathbf{w}_{2j}^\\prime :=\\frac{\\mathbf{w}_{2j}}{\\left\\| \\mathbf{w}_{2j} \\right\\|_{2}}, \\quad w_{3j}^{\\prime} :=w_{3j} \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}.\n\\end{aligned}')
('1.0.0', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_proof3}\n      \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}^\\prime\n      : \\left\\| \\mathbf{w}_{2j}^\\prime \\right\\|_{2}=1 \\\\ w_{3j}^\\prime \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}^\\prime w_{3j}^\\prime,y_i \\right) +  \\beta \\sum_{j=1}^{h}| w_{3j}^{\\prime}|.\n\\end{aligned}')
('1.0.0', '\\begin{aligned}\n      \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}^\\prime\n      : \\left\\| \\mathbf{w}_{2j}^\\prime \\right\\|_{2}=1 \\\\ w_{3j}^\\prime \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}^\\prime w_{3j}^\\prime,y_i \\right) +  \\beta \\left\\|  \\mathbf{w}_{3}^{\\prime} \\right\\|_{1}.\n\\end{aligned}')
('1.0.0', '\\left\\| \\mathbf{w}_{2j}^\\prime \\right\\|_{2}=1')
('1.0.0', '\\left\\| \\mathbf{w}_{2j}^\\prime \\right\\|_{2} \\leq 1')
('1.0.0', '\\left\\| \\mathbf{w}_3^\\prime \\right\\|_{1}')
('1.0.0.0', 'h')
('1.0.0.0', 'h^*')
('1.0.0.0', 'h^* \\leq N+1')
('1.0.0.0', 'N+1')
('1.0.0.0', 'h^* \\ll N+1')
('1.0.0.0', '\\mathbf{Z}^* \\in \\mathbb{R}^{n \\times d}')
('1.0.0.0', '\\begin{aligned}\n    \\mathbf{Z}^* &= \\sum_{j=1}^h \\mathbf{e}_j \\mathbf{z}_j^\\top =\\sum_{j=1}^h \\mathbf{e}_j \\frac{\\mathbf{z}_j^\\top}{\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}} \\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}\n\\end{aligned}')
('1.0.0.0', '\\mathbf{e}_j \\in \\mathbb{R}^{n}')
('1.0.0.0', 'j^{th}')
('1.0.0.0', 'h')
('1.0.0.0', 'n')
('1.0.0.0', '\\mathbf{Z}')
('1.0.0.0', '\\begin{aligned}\n\\begin{split}\n\\mathrm{trace}\\left( \\mathbf{Z}^{*^\\top} {\\mathbf{X}}_i \\right) &= \\sum_{j=1}^h \\mathbf{e}_j^\\top {\\mathbf{X}}_i\\frac{\\mathbf{z}_j}{\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}} \\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}\\\\\n &= \\sum_{j=1}^h \\mathbf{w}_{1j}^{*^\\top} {\\mathbf{X}}_i  \\mathbf{w}_{2j }^{*}w_{3j}^{*}\n\\end{split} \\implies \\mathbf{w}_{1j}^{*}= \\mathbf{e}_j,\\; \\mathbf{w}_{2j}^{*}=\\frac{\\mathbf{z}_j}{\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}},\\; w_{3j}^{*}=\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}},\n\\end{aligned}')
('1.0.0.0', '\\{\\mathbf{w}_{1j}^{*},\\mathbf{w}_{2j}^{*},w_{3j}^{*}\\}_{j=1}^h')
('1.0.0.0', '\\begin{aligned}\n\\label{eq:scaling_proof_final}\n    f\\left( \\left\\{ {\\mathbf{X}}_i,y_i \\right\\}_{i=1}^{N} \\right) &:=\\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^{{*}^\\top} {\\mathbf{X}}_i \\mathbf{w}_{2j}^{*} w_{3j}^{*},y_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{w}_{2j}^{*} \\right\\|_{2}^2 +\\left( w_{3j}^{*} \\right)^{2}\\right) \\notag \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{e}_{j}^{\\top} {\\mathbf{X}}_i \\frac{\\mathbf{z}_j}{\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}} \\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}},y_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\frac{\\mathbf{z}_j}{\\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}}} \\right\\|_{2}^2 +\\left( \\sqrt{\\left\\| \\mathbf{z}_j \\right\\|_{2}} \\right)^{2}\\right)\\notag \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{e}_{j}^{\\top} {\\mathbf{X}}_i \\mathbf{z}_j ,y_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{z}_j \\right\\|_{2} + \\left\\| \\mathbf{z}_j \\right\\|_{2}\\right)\\notag \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathrm{trace}\\left(  \\mathbf{z}_j\\mathbf{e}_{j}^{\\top}{\\mathbf{X}}_i  \\right) ,y_i \\right) + \\beta  \\sum_{j=1}^h  \\left\\| \\mathbf{z}_j \\right\\|_{2}\\notag \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left(  \\mathrm{trace}\\left(  \\mathbf{Z}^{*^\\top}{\\mathbf{X}}_i  \\right) ,y_i \\right) + \\beta  \\sum_{k=1}^n  \\left\\| \\mathbf{z}_k \\right\\|_{2},\n\\end{aligned}')
('1.0.0.0', 'h')
('1.0.0.0', 'n')
('1.0.0.0', '\\mathbf{Z}')
('1.0.0.0', '\\mathbf{Z}^*')
('1.0.0.0', '\\mathbf{Z}_l^* \\in \\mathbb{R}^{n \\times d}')
('1.0.0.0', '\\begin{aligned}\n    \\mathbf{Z}_l^* &= \\sum_{k=1}^h \\mathbf{e}_{lk} \\mathbf{z}_{lk}^\\top =\\sum_{k=1}^h \\mathbf{e}_{lk} \\frac{\\mathbf{z}_{lk}^\\top}{\\sqrt{\\left\\| \\mathbf{z}_{lk} \\right\\|_{2}}} \\sqrt{\\left\\| \\mathbf{z}_{lk} \\right\\|_{2}}.\n\\end{aligned}')
('1.0.0.0', '\\begin{aligned}\n\\begin{split}\n\\mathrm{trace}\\left( \\mathbf{Z}_l^{*^\\top} {\\mathbf{X}}_i \\right) &= \\sum_{k=1}^h \\mathbf{e}_{lk}^\\top {\\mathbf{X}}_i\\frac{\\mathbf{z}_{lk}}{\\sqrt{\\left\\| \\mathbf{z}_{lk} \\right\\|_{2}}} \\sqrt{\\left\\| \\mathbf{z}_{lk} \\right\\|_{2}}\n\\end{split} \\implies \\mathbf{w}_{1j}^{*}= \\mathbf{e}_{lk},\\; \\mathbf{w}_{2j}^{*}=\\frac{\\mathbf{z}_{lk}}{\\sqrt{\\left\\| \\mathbf{z}_{lk} \\right\\|_{2}}},\\; \\mathbf{w}_{3j}^{*}=\\mathbf{e}_l\\sqrt{\\left\\| \\mathbf{z}_{lk} \\right\\|_{2}},\n\\end{aligned}')
('1.0.0.0', '\\{\\mathbf{w}_{1j}^{*},\\mathbf{w}_{2j}^{*},\\mathbf{w}_{3j}^{*}\\}_{j=1}^{hc}')
('1.0.0.0', 'j \\in [hc]')
('1.0.0.0', 'j \\in [h]')
('1.0.0.1', '\\begin{aligned}\n %\\label{eq:simplex_regression_scalar_scaled_proof}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\leq 1, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j},y_i \\right) + \\beta \\left\\| \\mathbf{w}_3 \\right\\|_{1}.\n\\end{aligned}')
('1.0.0.1', '\\hat{\\mathbf{y}} \\in \\mathbb{R}^{N}')
('1.0.0.1', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_scaled_lagrange}\n    \\min_{\\substack{ \\hat{\\mathbf{y}} \\in \\mathbb{R}^{N}, \\mathbf{w}_{1j} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\leq 1, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left( \\hat{y}_i,y_i \\right) + \\beta \\left\\| \\mathbf{w}_3 \\right\\|_{1} \\quad \\mathrm{ s.t. } \\quad \\hat{y}_i=\\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j}, \\; \\forall i \\in [n].\n\\end{aligned}')
('1.0.0.1', '\\begin{aligned}\n    L(\\mathbf{v},\\mathbf{y}, \\mathbf{w}_3) &:=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{y}_i,y_i \\right) + \\beta \\left\\| \\mathbf{w}_3 \\right\\|_{1} + \\sum_{i=1}^N v_i  \\left( \\hat{y}_i-\\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j} \\right) \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{y}_i,y_i \\right) + \\sum_{i=1}^N v_i \\hat{y}_i + \\beta \\left\\| \\mathbf{w}_3 \\right\\|_{1} - \\sum_{i=1}^N v_i  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j}\\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{y}_i,y_i \\right) + \\sum_{i=1}^N v_i \\hat{y}_i + \\beta \\left\\| \\mathbf{w}_3 \\right\\|_{1} -\\sum_{j=1}^h \\sum_{i=1}^N v_i  \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j}\n\\end{aligned}')
('1.0.0.1', 'L(\\cdot)')
('1.0.0.1', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_dual}    \n\\max_{\\mathbf{v}\\in \\mathbb{R}^{N}} -\\mathcal{L}^*\\left( \\mathbf{v},\\mathbf{y} \\right) \\quad \\text{s.t.} \\max_{\\mathbf{w}_{1} \\in \\Delta, \\left\\| \\mathbf{w}_{2} \\right\\|_{2} \\leq  1} \\left\\vert  \\sum_{i=1}^N v_i \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2}  \\right \\vert  \\leq \\beta,\n\\end{aligned}')
('1.0.0.1', '\\mathcal{L}^*\\left( \\cdot \\right)')
('1.0.0.1', '\\mathcal{L}\\left( \\cdot \\right)')
('1.0.0.1', '\\begin{aligned}\n    \\mathcal{L}^*\\left( \\mathbf{v},\\mathbf{y} \\right) :=\\max_{\\mathbf{z} \\in \\mathbb{R}^{N}} \\mathbf{z}^\\top \\mathbf{v}- \\mathcal{L}\\left( \\mathbf{z},\\mathbf{y} \\right). \n\\end{aligned}')
('1.0.0.1', '\\begin{aligned}\n \\label{eq:dual_cons_multihead}\n    \\max_{\\mathbf{w}_{1} \\in \\Delta, \\left\\| \\mathbf{w}_{2} \\right\\|_{2} \\leq  1} \\left\\vert  \\sum_{i=1}^N v_i \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2}  \\right \\vert   &= \\max_{\\mathbf{w}_{1} \\in \\Delta} \\left\\|  \\sum_{i=1}^N v_i \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i   \\right\\|_{2} \\notag \\\\\n    & =  \\max_{\\mathbf{w}_{1} \\in \\Delta}  \\left\\| \\sum_{i=1}^N\\sum_{k=1}^n v_iw_{1k} \\mathbf{x}_{ik} \\right\\|_{2}  \\notag \\\\\n    & \\leq  \\max_{\\mathbf{w}_{1} \\in \\Delta} \\sum_{k=1}^n w_{1k}\\left\\|  \\sum_{i=1}^N v_i\\mathbf{x}_{ik} \\right\\|_{2} \\notag  \\\\\n    & =\\max_{k \\in [n]} \\left\\| \\sum_{i=1}^Nv_i\\mathbf{x}_{ik} \\right\\|_{2},\n\\end{aligned}')
('1.0.0.1', '\\mathbf{w}_{1}')
('1.0.0.1', '\\begin{aligned}\n \\label{eq:simplex_regression_scalar_multihead_dual2}    \n&d^*=\\max_{\\mathbf{v}\\in \\mathbb{R}^{N}}-\\mathcal{L}^*\\left( \\mathbf{v},\\mathbf{y} \\right)\\quad \\text{s.t.} \\max_{k \\in [h]} \\left\\| \\sum_{i=1}^Nv_i\\mathbf{x}_{ik} \\right\\|_{2}\\leq \\beta \\notag\\\\\n&=\\max_{\\mathbf{v}\\in \\mathbb{R}^{N}} -\\mathcal{L}^*\\left( \\mathbf{v},\\mathbf{y} \\right) \\quad \\text{s.t.} \\left\\| \\sum_{i=1}^Nv_i\\mathbf{x}_{ik} \\right\\|_{2}\\leq \\beta, \\forall k \\in [n].\n\\end{aligned}')
('1.0.0.1', '\\begin{aligned}\n     L(\\mathbf{v},\\mathbf{y}, \\bm{\\lambda}) &:=-\\mathcal{L}^*\\left( \\mathbf{v},\\mathbf{y} \\right)+ \\sum_{k=1}^n \\lambda_k \\left( \\beta- \\left\\| \\sum_{i=1}^Nv_i\\mathbf{x}_{ik} \\right\\|_{2} \\right)\n\\end{aligned}')
('1.0.0.1', '\\begin{aligned}\n  \\min_{\\bm{\\lambda} \\geq \\mathbf{0}}  \\max_{\\mathbf{v}\\in \\mathbb{R}^{N}}   L(\\mathbf{v},\\mathbf{y}, \\bm{\\lambda}) = -\\frac{1}{2}\\left\\| \\mathbf{v}-\\mathbf{y} \\right\\|_{2}^2 +\\frac{1}{2}\\left\\| \\mathbf{y} \\right\\|_{2}^2+ \\sum_{k=1}^n \\lambda_k \\left( \\beta- \\left\\| \\sum_{i=1}^Nv_i\\mathbf{x}_{ik} \\right\\|_{2} \\right).\n\\end{aligned}')
('1.0.0.1', '\\mathbf{r}_k \\in \\mathbb{R}^{d}')
('1.0.0.1', '\\begin{aligned}\n  \\min_{\\bm{\\lambda} \\geq \\mathbf{0}}   \\max_{\\mathbf{v}\\in \\mathbb{R}^{n}}  \\min_{\\mathbf{r}_k: \\left\\| \\mathbf{r}_k \\right\\|_{2}\\leq 1}  -\\mathcal{L}^*\\left( \\mathbf{v},\\mathbf{y} \\right)+ \\sum_{k=1}^n \\lambda_k \\left( \\beta- \\mathbf{r}_k^\\top\\sum_{i=1}^Nv_i\\mathbf{x}_{ik} \\right).\n\\end{aligned}')
('1.0.0.1', '\\mathbf{v}')
('1.0.0.1', '\\begin{aligned}\n   \\min_{\\bm{\\lambda} \\geq \\mathbf{0}}  \\min_{\\mathbf{r}_k: \\left\\| \\mathbf{r}_k \\right\\|_{2}\\leq 1}  \\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{k=1}^n \\lambda_k\\mathbf{r}_k^\\top \\mathbf{x}_{ik},y_i \\right)+ \\beta \\sum_{k=1}^n \\lambda_k .\n\\end{aligned}')
('1.0.0.1', '\\mathbf{z}_k:=\\lambda_k \\mathbf{r}_k')
('1.0.0.1', '\\begin{aligned}\n \\min_{\\mathbf{z}_k: \\left\\| \\mathbf{z}_k \\right\\|_{2}\\leq \\lambda_k}  \\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{k=1}^n \\mathbf{z}_k^\\top\\mathbf{x}_{ik},y_i \\right){2}+ \\beta \\sum_{k=1}^n \\lambda_k .\n\\end{aligned}')
('1.0.0.1', '\\lambda_k=\\left\\| \\mathbf{z}_k \\right\\|_{2}')
('1.0.0.1', '\\lambda_k>\\left\\| \\mathbf{z}_k \\right\\|_{2}')
('1.0.0.1', '\\lambda_k')
('1.0.0.1', '\\lambda_k')
('1.0.0.1', '\\begin{aligned}\n \\min_{\\mathbf{z}_k }\\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{k=1}^n \\mathbf{z}_k^\\top\\mathbf{x}_{ik},y_i \\right)+ \\beta \\sum_{k=1}^n \\left\\| \\mathbf{z}_k \\right\\|_{2},\n\\end{aligned}')
('1.0.0.2', '\\mathbf{v}')
('1.0.0.2', '\\begin{aligned}\n\\label{eq:dual_cons_multihead_bidual}\n &   p_{\\infty}^*:=\\min_{\\boldsymbol{\\mu}}\\sum_{i=1}^N\\mathcal{L}\\left(\\int_{ \\substack{  \\mathbf{w}_{1} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2} \\right\\|_{2}\\leq 1 }} \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2} d{\\mu}(\\mathbf{w}_1,\\mathbf{w}_2),y_i\\right) +\\beta \\|\\boldsymbol{\\mu}\\|_{TV}, \n\\end{aligned}')
('1.0.0.2', '\\|\\boldsymbol{\\mu}\\|_{TV}')
('1.0.0.2', '\\boldsymbol{\\mu}')
('1.0.0.2', '\\mu')
('1.0.0.2', 'd^*=p_{\\infty}^*')
('1.0.0.2', 'd^*')
('1.0.0.2', 'N+1')
('1.0.0.2', '\\begin{aligned}\n\\label{eq:dual_cons_multihead_bidual2}\n     p_{\\infty}^*&= \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\leq 1 }} \\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{j=1}^{h^*}\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} w_{3j},y_i\\right)+\\beta \\|\\mathbf{w}_{3}\\|_1\n\\end{aligned}')
('1.0.0.2', 'h^* \\leq N+1')
('1.0.0.2', 'h \\geq h^*')
('1.0.0.2', 'p^*=p_{\\infty}^*=d^*')
('1.0.0.2', 'p^*')
('1.0.0.3', '\\left\\{ \\mathbf{w}_{2j}, \\mathbf{w}_{3j} \\right\\}_{j=1}^m')
('1.0.0.3', '\\begin{aligned}\n %\\label{eq:scaling_vector}\n    \\bar{\\mathbf{w}}_{2j} :=\\alpha_j \\mathbf{w}_{2j},\\;  \\bar{\\mathbf{w}}_{3j} :=\\frac{\\mathbf{w}_{3j}}{\\alpha_j}.\n\\end{aligned}')
('1.0.0.3', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_scaled}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}: \\left\\| \\mathbf{w}_{2j} \\right\\|_{2} \\leq 1 \\\\ \\mathbf{w}_{3j} \\in \\mathbb{R}^{c} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{w}_{3j}, \\mathbf{y}_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1}.\n\\end{aligned}')
('1.0.0.3', '\\hat{\\mathbf{y}}_i \\in \\mathbb{R}^{c}, \\forall i \\in [N]')
('1.0.0.3', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_scaled_lagrange}\n    \\min_{\\substack{ \\hat{\\mathbf{y}}_i \\in \\mathbb{R}^{c }, \\mathbf{w}_{1j} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\leq 1, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\beta \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1}\\quad \\mathrm{ s.t. } \\quad \\hat{\\mathbf{y}}_i=\\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{w}_{3j}, \\; \\forall i \\in [N].\n\\end{aligned}')
('1.0.0.3', '\\begin{aligned}\n    L\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\mathbf{y},\\left\\{ \\mathbf{w}_{3j} \\right\\}_{j=1}^{h} \\right) &:=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\beta \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1} + \\sum_{i=1}^N \\mathbf{v}_i^\\top  \\left( \\hat{\\mathbf{y}}_i-\\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{w}_{3j} \\right) \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\sum_{i=1}^N \\mathbf{v}_i^\\top \\hat{\\mathbf{y}}_i + \\beta\\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1} - \\sum_{i=1}^N \\mathbf{v}_i^\\top  \\sum_{j=1}^h\\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{w}_{3j}\\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\sum_{i=1}^N \\mathbf{v}_i^\\top \\hat{\\mathbf{y}}_i + \\beta \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1} -\\sum_{j=1}^h \\sum_{i=1}^N \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{v}_i^\\top  \\mathbf{w}_{3j}\n\\end{aligned}')
('1.0.0.3', 'L(\\cdot)')
('1.0.0.3', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_dual}    \n\\max_{\\mathbf{v}_i \\in \\mathbb{R}^{c}} -\\mathcal{L}^*\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\left\\{ \\mathbf{y}_i \\right\\}_{i=1}^{N} \\right) \\quad \\text{s.t.} \\max_{\\mathbf{w}_{1} \\in \\Delta, \\left\\| \\mathbf{w}_{2} \\right\\|_{2} \\leq  1} \\left\\|  \\sum_{i=1}^N \\mathbf{v}_i \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2}  \\right\\|_{\\infty} \\leq \\beta,\n\\end{aligned}')
('1.0.0.3', '\\mathcal{L}^*\\left( \\cdot \\right)')
('1.0.0.3', '\\mathcal{L}\\left( \\cdot \\right)')
('1.0.0.3', '\\begin{aligned}\n    \\mathcal{L}^*\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\left\\{ \\mathbf{y}_i \\right\\}_{i=1}^{N} \\right) :=\\max_{\\mathbf{Z} \\in \\mathbb{R}^{N \\times c}} \\mathrm{trace}\\left( \\mathbf{Z}^\\top \\mathbf{V} \\right) - \\mathcal{L}\\left( \\mathbf{Z},\\mathbf{Y} \\right), \n\\end{aligned}')
('1.0.0.3', '\\mathbf{V}, \\mathbf{Y}\\in \\mathbb{R}^{N \\times c}')
('1.0.0.3', '\\left\\{ \\mathbf{v}_i,\\mathbf{y}_i \\right\\}_{i=1}^{N}')
('1.0.0.3', '\\begin{aligned}\n \\label{eq:dual_cons_multihead_vector}\n    \\max_{\\mathbf{w}_{1} \\in \\Delta, \\left\\| \\mathbf{w}_{2} \\right\\|_{2} \\leq  1} \\left\\|  \\sum_{i=1}^N \\mathbf{v}_i \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2}  \\right\\|_{\\infty}  &= \\max_{\\mathbf{w}_{1} \\in \\Delta}  \\max_{l \\in [c]} \\left\\|  \\sum_{i=1}^N v_{il} \\mathbf{w}_{1}^\\top {\\mathbf{X}}_i   \\right\\|_{2} \\notag \\\\\n    & =  \\max_{\\mathbf{w}_{1} \\in \\Delta}   \\max_{l \\in [c]} \\left\\| \\sum_{i=1}^N\\sum_{k=1}^n v_{il}w_{1k} \\mathbf{x}_{ik} \\right\\|_{2}  \\notag \\\\\n    & \\leq  \\max_{\\mathbf{w}_{1} \\in \\Delta} \\max_{l \\in [c]} \\sum_{k=1}^n w_{1k}\\left\\|  \\sum_{i=1}^N v_i\\mathbf{x}_{ik} \\right\\|_{2} \\notag  \\\\\n    & = \\max_{l \\in [c]} \\max_{k \\in [n]} \\left\\| \\sum_{i=1}^Nv_{il}\\mathbf{x}_{ik} \\right\\|_{2},\n\\end{aligned}')
('1.0.0.3', '\\mathbf{w}_{1}')
('1.0.0.3', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_dual2}    \n\\max_{\\mathbf{v}\\in \\mathbb{R}^{N}} -\\mathcal{L}^*\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\left\\{ \\mathbf{y}_i \\right\\}_{i=1}^{N} \\right) \\quad \\text{s.t.} \\left\\| \\sum_{i=1}^Nv_{il}\\mathbf{x}_{ik} \\right\\|_{2}\\leq \\beta, \\forall k \\in [n], \\forall l \\in [c].\n\\end{aligned}')
('1.0.0.3', '\\begin{aligned}\n    \\min_{\\mathbf{Z}_l \\in \\mathbb{R}^{ n \\times d}}  \\sum_{i=1}^N\\sum_{l=1}^c\\mathcal{L}\\left(  \\mathrm{trace}\\left( \\mathbf{Z}_l^\\top {\\mathbf{X}}_i \\right),y_{il} \\right)+ \\beta \\sum_{l=1}^c\\sum_{k=1}^n \\left\\| \\mathbf{z}_{lk} \\right\\|_{2}.\n\\end{aligned}')
('1.0.0.4', '\\left\\{ \\mathbf{w}_{2j}, \\mathbf{w}_{3j} \\right\\}_{j=1}^m')
('1.0.0.4', '\\begin{aligned}\n %\\label{eq:scaling_vector}\n    \\bar{\\mathbf{w}}_{2j} :=\\alpha_j \\mathbf{w}_{2j},\\;  \\bar{\\mathbf{w}}_{3j} :=\\frac{\\mathbf{w}_{3j}}{\\alpha_j}.\n\\end{aligned}')
('1.0.0.4', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_scaled_fcn}\n    \\min_{\\substack{  \\mathbf{w}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}: \\left\\| \\mathbf{w}_{2j} \\right\\|_{2} \\leq 1 \\\\ \\mathbf{w}_{3j} \\in \\mathbb{R}^{c} }} \\sum_{i=1}^N\\mathcal{L}\\left(  \\sum_{j=1}^h \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\right) \\mathbf{w}_{3j}, \\mathbf{y}_i \\right) + \\frac{\\beta}{2}  \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1}.\n\\end{aligned}')
('1.0.0.4', '\\hat{\\mathbf{y}}_i \\in \\mathbb{R}^{c}, \\forall i \\in [N]')
('1.0.0.4', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_scaled_lagrange_fcn}\n    \\min_{\\substack{ \\hat{\\mathbf{y}}_i \\in \\mathbb{R}^{c }, \\mathbf{w}_{1j} \\in \\Delta\\\\ \\left\\| \\mathbf{w}_{2j} \\right\\|_{2}\\leq 1, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\beta \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1}\\quad \\mathrm{ s.t. } \\quad \\hat{\\mathbf{y}}_i=\\sum_{j=1}^h \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}  \\right) \\mathbf{w}_{3j}, \\; \\forall i \\in [N].\n\\end{aligned}')
('1.0.0.4', '\\begin{aligned}\n    L\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\mathbf{y},\\left\\{ \\mathbf{w}_{3j} \\right\\}_{j=1}^{h} \\right) &:=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\beta \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1} + \\sum_{i=1}^N \\mathbf{v}_i^\\top  \\left( \\hat{\\mathbf{y}}_i-\\sum_{j=1}^h \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\right) \\mathbf{w}_{3j} \\right) \\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\sum_{i=1}^N \\mathbf{v}_i^\\top \\hat{\\mathbf{y}}_i + \\beta\\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1} - \\sum_{i=1}^N \\mathbf{v}_i^\\top  \\sum_{j=1}^h\\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\right) \\mathbf{w}_{3j}\\\\\n    &=\\sum_{i=1}^N\\mathcal{L}\\left( \\hat{\\mathbf{y}}_i,\\mathbf{y}_i \\right) + \\sum_{i=1}^N \\mathbf{v}_i^\\top \\hat{\\mathbf{y}}_i + \\beta \\sum_{j=1}^h  \\left\\| \\mathbf{w}_{3j} \\right\\|_{1} -\\sum_{j=1}^h \\sum_{i=1}^N \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}  \\right)\\mathbf{v}_i^\\top  \\mathbf{w}_{3j}\n\\end{aligned}')
('1.0.0.4', 'L(\\cdot)')
('1.0.0.4', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_dual_fcn}    \n\\max_{\\mathbf{v}_i \\in \\mathbb{R}^{c}} -\\mathcal{L}^*\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\left\\{ \\mathbf{y}_i \\right\\}_{i=1}^{N} \\right) \\quad \\text{s.t.} \\max_{\\mathbf{w}_{1j} \\in \\Delta, \\left\\| \\mathbf{w}_{2j} \\right\\|_{2} \\leq  1} \\left\\|  \\sum_{i=1}^N \\mathbf{v}_i \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}  \\right) \\right\\|_{\\infty} \\leq \\beta, \\forall j \\in [h],\n\\end{aligned}')
('1.0.0.4', '\\mathcal{L}^*\\left( \\cdot \\right)')
('1.0.0.4', '\\mathcal{L}\\left( \\cdot \\right)')
('1.0.0.4', '\\begin{aligned}\n    \\mathcal{L}^*\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\left\\{ \\mathbf{y}_i \\right\\}_{i=1}^{N} \\right) :=\\max_{\\mathbf{Z} \\in \\mathbb{R}^{N \\times c}} \\mathrm{trace}\\left( \\mathbf{Z}^\\top \\mathbf{V} \\right) - \\mathcal{L}\\left( \\mathbf{Z},\\mathbf{Y} \\right), \n\\end{aligned}')
('1.0.0.4', '\\mathbf{V}, \\mathbf{Y}\\in \\mathbb{R}^{N \\times c}')
('1.0.0.4', '\\left\\{ \\mathbf{v}_i,\\mathbf{y}_i \\right\\}_{i=1}^{N}')
('1.0.0.4', '\\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}  \\right)')
('1.0.0.4', '\\begin{aligned}\n    \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}  \\right) :=\\mathbbm{1}_{ij} \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j}, \n\\end{aligned}')
('1.0.0.4', '\\mathbbm{1}_{ij} :=\\mathbbm{1}\\left\\{ \\mathbf{u}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{u}_{2j} \\geq 0 \\right\\}_{}^{}')
('1.0.0.4', '\\left\\{ \\mathbf{u}_{1j},\\mathbf{u}_{2j} \\right\\}_{j=1}^{h}')
('1.0.0.4', '\\mathbf{u}_{1j} \\sim \\mathcal{N}(\\mathbf{0},\\mathbf{I}_n)')
('1.0.0.4', '\\mathbf{u}_{2j} \\sim \\mathcal{N}(\\mathbf{0},\\mathbf{I}_d)')
('1.0.0.4', '\\begin{aligned}\n \\label{eq:dual_cons_multihead_vector_fcn}\n   \\max_{j \\in [h]}  \\max_{\\mathbf{w}_{1j} \\in \\Delta, \\left\\| \\mathbf{w}_{2j} \\right\\|_{2} \\leq  1} \\left\\|  \\sum_{i=1}^N \\mathbf{v}_i \\sigma\\left( \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i \\mathbf{w}_{2j} \\right)  \\right\\|_{\\infty}  &= \\max_{j \\in [h]}\\max_{l \\in [c]}\\max_{\\mathbf{w}_{1j} \\in \\Delta}   \\left\\|  \\sum_{i=1}^N v_{il} \\mathbbm{1}_{ij} \\mathbf{w}_{1j}^\\top {\\mathbf{X}}_i   \\right\\|_{2} \\notag \\\\\n    & =  \\max_{j \\in [h]}   \\max_{\\mathbf{w}_{1j} \\in \\Delta} \\max_{l \\in [c]} \\left\\| \\sum_{i=1}^N\\sum_{k=1}^n v_{il}\\mathbbm{1}_{ij} w_{1jk} \\mathbf{x}_{ik} \\right\\|_{2}  \\notag \\\\\n    & \\leq  \\max_{j \\in [h]}  \\max_{\\mathbf{w}_{1j} \\in \\Delta}  \\max_{l \\in [c]} \\sum_{k=1}^n w_{1jk}\\left\\|  \\sum_{i=1}^N v_i \\mathbbm{1}_{ij} \\mathbf{x}_{ik} \\right\\|_{2} \\notag  \\\\\n    & = \\max_{j \\in [h]}  \\max_{l \\in [c]}   \\max_{k \\in [n]} \\left\\| \\sum_{i=1}^Nv_{il}\\mathbbm{1}_{ij}\\mathbf{x}_{ik} \\right\\|_{2},\n\\end{aligned}')
('1.0.0.4', '\\mathbf{w}_{1j}')
('1.0.0.4', '\\begin{aligned}\n \\label{eq:simplex_regression_vector_multihead_dual2_fcn}    \n\\max_{\\mathbf{v}\\in \\mathbb{R}^{N}} -\\mathcal{L}^*\\left( \\left\\{ \\mathbf{v}_i \\right\\}_{i=1}^{N},\\left\\{ \\mathbf{y}_i \\right\\}_{i=1}^{N} \\right) \\quad \\text{s.t.} \\left\\| \\sum_{i=1}^Nv_{il}\\mathbbm{1}_{ij}\\mathbf{x}_{ik} \\right\\|_{2}\\leq \\beta, \\forall k \\in [n], \\forall l \\in [c], \\forall j \\in [h].\n\\end{aligned}')
('1.0.0.4', '\\begin{aligned}\n    \\min_{\\mathbf{Z}_{jl} \\in \\mathbb{R}^{ n \\times d}}  \\sum_{i=1}^N\\sum_{l=1}^c \\mathcal{L}\\left( \\sum_{j=1}^h \\mathbbm{1}_{ij}\\mathrm{trace}\\left( \\mathbf{Z}_{jl}^\\top {\\mathbf{X}}_i \\right),y_{il} \\right)+ \\beta \\sum_{l=1}^c\\sum_{j=1}^h\\sum_{k=1}^n \\left\\| \\mathbf{z}_{jlk} \\right\\|_{2}.\n\\end{aligned}')
('1.0.0.5', '\\mathbf{Y}_i \\in \\mathbb{R}^{n \\times c}')
('1.0.0.5', '\\begin{aligned}\n \\label{eq:simplex_regression_matrix}\n    \\min_{\\substack{  \\mathbf{W}_{1j} \\in \\Delta\\\\ \\mathbf{W}_{2j}\\in \\mathbb{R}^{d \\times c}, w_{3j} \\in \\mathbb{R}^{} }} \\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{j=1}^h \\mathbf{W}_{1j} {\\mathbf{X}}_i \\mathbf{W}_{2j} w_{3j},\\mathbf{Y}_i \\right)+ \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{W}_{2j} \\right\\|_{1}^2 +\\left( w_{3j} \\right)^{2}\\right).\n\\end{aligned}')
('1.0.0.5', '\\begin{aligned}\n \\label{eq:simplex_regression_matrix_dual}    \n    \\max_{\\mathbf{V}_i \\in \\mathbb{R}^{n \\times c}} - \\sum_{i=1}^N \\mathcal{L}^*\\left( \\mathbf{V}_i,\\mathbf{Y}_i  \\right)\\quad \\text{s.t.} \\max_{\\mathbf{W}_{1} \\in \\Delta, \\left\\| \\mathbf{W}_{2} \\right\\|_{2} \\leq  1} \\left\\vert  \\mathrm{trace}\\left( \\sum_{i=1}^N \\mathbf{V}_i^\\top  \\mathbf{W}_{1} {\\mathbf{X}}_i \\mathbf{W}_{2}  \\right) \\right \\vert  \\leq \\beta.\n\\end{aligned}')
('1.0.0.5', '\\begin{aligned}\n \\label{eq:dual_cons_matrix}\n    \\max_{\\mathbf{W}_{1} \\in \\Delta, \\left\\| \\mathbf{W}_{2} \\right\\|_{2} \\leq  1} \\left\\vert  \\mathrm{trace}\\left( \\sum_{i=1}^N \\mathbf{V}_i^\\top  \\mathbf{W}_{1} {\\mathbf{X}}_i \\mathbf{W}_{2}  \\right) \\right \\vert    &= \\max_{\\mathbf{W}_{1} \\in \\Delta} \\left\\|  \\sum_{i=1}^N \\mathbf{v}_i^\\top \\mathbf{W}_{1} {\\mathbf{X}}_i   \\right\\|_{\\infty} \\nonumber \\\\ & = \\max_{l \\in [c]}\\max_{j \\in [d]}\\max_{\\mathbf{W}_{1} \\in \\Delta}  \\left\\vert \\sum_{i=1}^N \\mathbf{v}_{il}^\\top\\mathbf{W}_{1}\\mathbf{x}_{ij} \\right \\vert   \n\\end{aligned}')
('1.0.0.5', '\\begin{aligned}\n% \\label{eq:simplex_regression_matrix_dualv2}    \n\\max_{\\mathbf{V}_i \\in \\mathbb{R}^{n \\times c}} - \\sum_{i=1}^N \\mathcal{L}^*\\left( \\mathbf{V}_i,\\mathbf{Y}_i  \\right) \\quad \\text{s.t.} \\max_{\\mathbf{W}_{1} \\in \\Delta } \\left\\vert  \\sum_{i=1}^N \\mathbf{v}_{il}^\\top  \\mathbf{W}_{1} \\mathbf{x}_{ij}   \\right \\vert  \\leq \\beta, \\; \\forall j \\in [d], \\; \\forall l \\in [c].\n\\end{aligned}')
('1.0.0.5', '\\begin{aligned}\n \\label{eq:simplex_regression_matrix_convex}\n    \\min_{\\mathbf{Z}_{jl}^{(1)},\\mathbf{Z}_{jl}^{(2)} \\in \\mathbb{R}^{n \\times n}_+}   \\sum_{i=1}^N \\sum_{l=1}^c\\mathcal{L}\\left(   \\sum_{j=1}^d \\left( \\mathbf{Z}_{jl}^{(1)}-\\mathbf{Z}_{jl}^{(2)} \\right) \\mathbf{x}_{ij},\\mathbf{y}_{il} \\right){2}^2+ \\beta \\sum_{l=1}^c \\sum_{j=1}^d \\left( \\left\\| \\mathbf{Z}_{jl}^{(1)} \\right\\|_{1, \\infty}+ \\left\\| \\mathbf{Z}_{jl}^{(2)} \\right\\|_{1, \\infty} \\right).\n\\end{aligned}')
('1.0.0.5', '\\begin{aligned}\n %\\label{eq:simplex_regression_matrix_form2}\n    \\min_{\\substack{  \\mathbf{W}_{1j} \\in \\Delta\\\\ \\mathbf{w}_{2j}\\in \\mathbb{R}^{d }, \\mathbf{w}_{3j} \\in \\mathbb{R}^{c} }} \\sum_{i=1}^N\\mathcal{L}\\left( \\sum_{j=1}^h \\mathbf{W}_{1j} {\\mathbf{X}}_i \\mathbf{w}_{2j} \\mathbf{w}_{3j}^\\top,\\mathbf{Y}_i \\right){F}^2 + \\frac{\\beta}{2}  \\sum_{j=1}^h\\left( \\left\\| \\mathbf{w}_{2j} \\right\\|_{1}^2 +\\left\\| \\mathbf{w}_{3j} \\right\\|_{1}^2\\right),\n\\end{aligned}')
