('1', '{\\mathbf{W}}({\\mathbf{x}})')
('1', '{\\mathbf{W}}({\\mathbf{x}})')
('1', '{\\mathbf{W}}({\\mathbf{x}})')
('1', '{\\mathbf{W}}({\\mathbf{x}})')
('1', '{\\mathbf{c}}_{k}({\\mathbf{x}})')
('1', '{\\mathbf{W}}({\\mathbf{x}})')
('1', '{\\mathbf{W}}({\\mathbf{x}})')
('1', '{\\mathbf{c}}_{k}({\\mathbf{x}})')
('2', 'y({\\mathbf{x}})\\mkern 1.25mu{=}\\mkern 1.25mu{\\mathbf{W}}{\\mathbf{x}}')
('2', 'y({\\mathbf{x}})')
('2', 'c_{i}\\mkern 1.25mu{=}\\mkern 1.25muw_{i}\\,x_{i}')
('2', 'i')
('2', 'y\\mkern 1.25mu{=}\\mkern 1.25mu\\sum_{i}c_{i}')
('2', '{\\mathbf{W}}({\\mathbf{x}})')
('2', '{\\mathbf{y}}({\\mathbf{x}})\\mkern 1.25mu{=}\\mkern 1.25mu{\\mathbf{W}}({\\mathbf{x%\n}}){\\mathbf{x}}')
('3', 'L')
('3', '\\displaystyle{\\mathbf{y}}({\\mathbf{x}})=\\text{Classifier}\\circ\\textstyle\\prod_%\n{l=1}^{L}\\left(\\text{MLPBlock}_{l}\\circ\\text{AttBlock}_{l}\\right)\\,\\circ\\text{%\nTokens}({\\mathbf{x}})\\,.')
('3', '\\displaystyle{\\mathbf{y}}({\\mathbf{x}})=\\text{Classifier}\\circ\\textstyle\\prod_%\n{l=1}^{L}\\left(\\text{MLPBlock}_{l}\\circ\\text{AttBlock}_{l}\\right)\\,\\circ\\text{%\nTokens}({\\mathbf{x}})\\,.')
('3', '{\\mathbf{x}}\\in\\mathbb{R}^{(CHW)}')
('3', 'H\\mkern 1.25mu{=}\\mkern 1.25muW')
('3', 'C')
('3', '\\circ')
('3', '{\\mathbf{P}},{\\mathbf{E}}\\in\\mathbb{R}^{D\\times N}')
('3', 'N')
('3', 'D')
('3', '\\mathcal{T}')
('3', '{\\mathbf{p^{\\prime}}}({\\mathbf{p}})\\mkern 1.25mu{=}\\mkern 1.25mu{\\mathbf{W}}{%\n\\mathbf{p}}\\mkern 1.25mu{+}\\mkern 1.25mu{\\mathbf{b}}')
('3', '{\\mathbf{W}}')
('3', '{\\mathbf{b}}')
('3', '{\\mathbf{p}}')
('3', '{\\mathbf{P}}')
('3', '{\\mathbf{E}}')
('3', '{\\mathbf{y}}({\\mathbf{x}})\\in\\mathbb{R}^{M}')
('3', 'M')
('3', '{\\mathbf{y}}({\\mathbf{x}})={\\mathbf{W}}({\\mathbf{x}})\\,{\\mathbf{x}}')
('3', '{\\mathbf{W}}({\\mathbf{x}})')
('3', '\\displaystyle\\text{Tokens}\\,({\\mathbf{x}})')
('3', '\\displaystyle\\text{Tokens}\\,(')
('3', '\\displaystyle{\\mathbf{x}})')
('3', '\\displaystyle=\\;\\mathcal{T}(\\text{CNN}({\\mathbf{x}}))+{\\mathbf{E}}\\;\\;{{\\color%\n[rgb]{0.15234375,0.62109375,0.80859375}\\xrightarrow{\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle=\\;\\mathcal{T}(\\text{CNN}({\\mathbf{x}}))+{\\mathbf{E}}')
('3', '\\displaystyle\\;\\;{{\\color[rgb]{0.15234375,0.62109375,0.80859375}\\xrightarrow{%\n\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle\\text{{{\\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos Tokens%\n}}}({\\mathbf{x}})')
('3', '\\displaystyle({\\mathbf{x}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{Tokens}}({\\mathbf{x}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{Tokens}}')
('3', '\\displaystyle({\\mathbf{x}})')
('3', '\\displaystyle\\;{\\mathbf{x}}')
('3', '\\displaystyle\\;{\\mathbf{x}}')
('3', '\\displaystyle\\text{AttBlock}\\,({\\mathbf{P}})')
('3', '\\displaystyle\\text{AttBlock}\\,(')
('3', '\\displaystyle{\\mathbf{P}})')
('3', '\\displaystyle=\\;\\text{MSA}({\\mathbf{P}})+{\\mathbf{P}}\\;\\;{{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}\\xrightarrow{\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle=\\;\\text{MSA}({\\mathbf{P}})+{\\mathbf{P}}')
('3', '\\displaystyle\\;\\;{{\\color[rgb]{0.15234375,0.62109375,0.80859375}\\xrightarrow{%\n\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle\\text{{{\\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos %\nAttBlock}}}({\\mathbf{P}})')
('3', '\\displaystyle({\\mathbf{P}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{Att}}({\\mathbf{P}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{Att}}')
('3', '\\displaystyle({\\mathbf{P}})')
('3', '\\displaystyle\\;{\\mathbf{P}}')
('3', '\\displaystyle\\;{\\mathbf{P}}')
('3', '\\displaystyle\\text{MLPBlock}\\,({\\mathbf{P}})')
('3', '\\displaystyle\\text{MLPBlock}\\,(')
('3', '\\displaystyle{\\mathbf{P}})')
('3', '\\displaystyle=\\;\\text{MLP}({\\mathbf{P}})+{\\mathbf{P}}\\;\\;{{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}\\xrightarrow{\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle=\\;\\text{MLP}({\\mathbf{P}})+{\\mathbf{P}}')
('3', '\\displaystyle\\;\\;{{\\color[rgb]{0.15234375,0.62109375,0.80859375}\\xrightarrow{%\n\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle\\text{{{\\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos %\nMLPBlock}}}({\\mathbf{P}})')
('3', '\\displaystyle({\\mathbf{P}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{MLP}}({\\mathbf{P}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{MLP}}')
('3', '\\displaystyle({\\mathbf{P}})')
('3', '\\displaystyle\\;{\\mathbf{P}}')
('3', '\\displaystyle\\;{\\mathbf{P}}')
('3', '\\displaystyle\\text{Classifier}\\,({\\mathbf{P}})')
('3', '\\displaystyle\\text{Classifier}\\,(')
('3', '\\displaystyle{\\mathbf{P}})')
('3', '\\displaystyle=\\;\\text{Linear}\\circ\\text{Pool}({\\mathbf{P}})\\;\\;{{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}\\xrightarrow{\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle=\\;\\text{Linear}\\circ\\text{Pool}({\\mathbf{P}})')
('3', '\\displaystyle\\;\\;{{\\color[rgb]{0.15234375,0.62109375,0.80859375}\\xrightarrow{%\n\\hphantom{\\text{1234}}}}}\\;\\;')
('3', '\\displaystyle\\text{{{\\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos %\nClassifier}}}({\\mathbf{P}})')
('3', '\\displaystyle({\\mathbf{P}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{Class}}({\\mathbf{P}})')
('3', '\\displaystyle={\\mathbf{W}}^{\\text{Class}}')
('3', '\\displaystyle({\\mathbf{P}})')
('3', '\\displaystyle\\;{\\mathbf{P}}\\,.')
('3', '\\displaystyle\\;{\\mathbf{P}}\\,.')
('3', '\\displaystyle{\\mathbf{y}}({\\mathbf{x}})={\\mathbf{W}}^{\\text{Class}}({\\mathbf{x%\n}})\\;\\textstyle\\prod_{l=1}^{L}\\left({\\mathbf{W}}^{\\text{MLP}}_{l}({\\mathbf{x}}%\n)\\;{\\mathbf{W}}^{\\text{Att}}_{l}({\\mathbf{x}})\\right)\\,\\;{\\mathbf{W}}^{\\text{%\nTokens}}({\\mathbf{x}})\\,{\\mathbf{x}}={\\mathbf{W}}({\\mathbf{x}})\\,{\\mathbf{x}}\\,.')
('3', '\\displaystyle{\\mathbf{y}}({\\mathbf{x}})={\\mathbf{W}}^{\\text{Class}}({\\mathbf{x%\n}})\\;\\textstyle\\prod_{l=1}^{L}\\left({\\mathbf{W}}^{\\text{MLP}}_{l}({\\mathbf{x}}%\n)\\;{\\mathbf{W}}^{\\text{Att}}_{l}({\\mathbf{x}})\\right)\\,\\;{\\mathbf{W}}^{\\text{%\nTokens}}({\\mathbf{x}})\\,{\\mathbf{x}}={\\mathbf{W}}({\\mathbf{x}})\\,{\\mathbf{x}}\\,.')
('3', '{\\mathbf{W}}({\\mathbf{x}})')
('3', '{\\mathbf{W}}({\\mathbf{x}})')
('3.1', '{\\mathbf{W}}({\\mathbf{x}})')
('3.1', '{\\mathbf{x}}')
('3.1', '{\\mathbf{c}}_{k}')
('3.1', 'k')
('3.1', '\\displaystyle\\textbf{Dynamic Linear Contribution Maps:}{\\mathbf{c}}_{k}({%\n\\mathbf{x}})=\\left[{\\mathbf{W}}({\\mathbf{x}})\\right]^{T}_{k}\\odot{\\mathbf{x}}%\n\\,,\\quad\\quad\\quad')
('3.1', '\\displaystyle{\\mathbf{c}}_{k}({\\mathbf{x}})=\\left[{\\mathbf{W}}({\\mathbf{x}})%\n\\right]^{T}_{k}\\odot{\\mathbf{x}}\\,,\\quad\\quad\\quad')
('3.1', '\\odot')
('3.1', '\\times')
('3.1', '{\\mathbf{c}}')
('3.1', '{\\mathbf{W}}({\\mathbf{x}})')
('3.1', '\\displaystyle\\text{B-cos}({\\mathbf{a}};{\\mathbf{W}})=\\left(\\cos^{\\text{B}-1}({%\n\\mathbf{a}},{\\mathbf{W}})\\odot\\widehat{{\\mathbf{W}}}\\right){\\mathbf{a}}={%\n\\mathbf{W}}({\\mathbf{a}}){\\mathbf{a}}\\;.')
('3.1', '\\displaystyle\\text{B-cos}({\\mathbf{a}};{\\mathbf{W}})=\\left(\\cos^{\\text{B}-1}({%\n\\mathbf{a}},{\\mathbf{W}})\\odot\\widehat{{\\mathbf{W}}}\\right){\\mathbf{a}}={%\n\\mathbf{W}}({\\mathbf{a}}){\\mathbf{a}}\\;.')
('3.1', '\\cos')
('3.1', '\\widehat{{\\mathbf{W}}}')
('3.1', '\\odot')
('3.1', '[{\\mathbf{W}}({\\mathbf{x}})]_{k}')
('3.1', 'k')
('3.1', '{\\mathbf{W}}({\\mathbf{x}})')
('3.2', '\\displaystyle\\text{B-cos Token}\\;{\\mathbf{p}}_{i}({\\mathbf{x}})=\\mathcal{T}_{i%\n}\\circ\\text{B-cos CNN}({\\mathbf{x}})={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\mathcal{T}_{i}}{\\mathbf{W}}^{%\n\\text{CNN}}({\\mathbf{x}})}}\\,{\\mathbf{x}}={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}{\\mathbf{W}}_{i}^{\\text{Tokens}}({\\mathbf{x}}%\n)}}\\,{\\mathbf{x}}\\,.')
('3.2', '\\displaystyle\\text{B-cos Token}\\;{\\mathbf{p}}_{i}({\\mathbf{x}})=\\mathcal{T}_{i%\n}\\circ\\text{B-cos CNN}({\\mathbf{x}})={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\mathcal{T}_{i}}{\\mathbf{W}}^{%\n\\text{CNN}}({\\mathbf{x}})}}\\,{\\mathbf{x}}={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}{\\mathbf{W}}_{i}^{\\text{Tokens}}({\\mathbf{x}}%\n)}}\\,{\\mathbf{x}}\\,.')
('3.2', '{\\mathbf{p}}_{i}\\mkern 1.25mu{\\in}\\mkern 1.25mu\\mathbb{R}^{D}')
('3.2', 'i')
('3.2', '{\\mathbf{P}}')
('3.2', '\\mathcal{T}_{i}')
('3.2', '{\\mathbf{W}}^{\\mathcal{T}_{i}}')
('3.2', '{\\mathbf{W}}^{\\text{CNN}}')
('3.2', '{\\mathbf{W}}_{i}^{\\text{Tokens}}({\\mathbf{x}})\\mkern 1.25mu{=}\\mkern 1.25mu{%\n\\mathbf{W}}^{\\mathcal{T}_{i}}{\\mathbf{W}}^{\\text{CNN}}({\\mathbf{x}})')
('3.2', '{\\mathbf{E}}')
('3.3', '\\displaystyle\\text{Attention}({{{\\mathbf{P}}}};{\\mathbf{Q}},{\\mathbf{K}},{%\n\\mathbf{V}})\\;=\\;\\underbrace{\\text{softmax}\\left({\\mathbf{P}}^{T}{\\mathbf{Q}}^%\n{T}{{{\\mathbf{K}}}}{{{\\mathbf{P}}}}\\right)}_{\\text{Attention matrix ${\\mathbf{%\nA}}({{{\\mathbf{P}}}})$}}\\underbrace{\\,{\\mathbf{V}}{{{\\mathbf{P}}}}\\,\\vphantom{%\n\\text{softmax}\\left({\\mathbf{Q}}{{{\\mathbf{P}}}}{{{\\mathbf{P}}}}^{T}{\\mathbf{K%\n}}^{T}\\right)}}_{\\text{Value}({{\\mathbf{P}}})}\\;=\\;\\underbrace{{\\mathbf{A}}({{%\n{\\mathbf{P}}}})\\,{\\mathbf{V}}\\vphantom{\\text{softmax}\\left({\\mathbf{Q}}{{{%\n\\mathbf{P}}}^{T}}{{{\\mathbf{P}}}}{\\mathbf{K}}^{T}\\right)}}_{{\\mathbf{W}}({{{%\n\\mathbf{P}}}})}\\,{{{\\mathbf{P}}}}\\;\\;=\\;{\\mathbf{W}}({{{\\mathbf{P}}}}){{{%\n\\mathbf{P}}}}.')
('3.3', '{\\mathbf{A}}({{{\\mathbf{P}}}})')
('3.3', '\\displaystyle\\text{Attention}({{{\\mathbf{P}}}};{\\mathbf{Q}},{\\mathbf{K}},{%\n\\mathbf{V}})\\;')
('3.3', '\\displaystyle=\\;\\underbrace{\\text{softmax}\\left({\\mathbf{P}}^{T}{\\mathbf{Q}}^{%\nT}{{{\\mathbf{K}}}}{{{\\mathbf{P}}}}\\right)}_{\\text{Attention matrix ${\\mathbf{A%\n}}({{{\\mathbf{P}}}})$}}\\underbrace{\\,{\\mathbf{V}}{{{\\mathbf{P}}}}\\,\\vphantom{%\n\\text{softmax}\\left({\\mathbf{Q}}{{{\\mathbf{P}}}}{{{\\mathbf{P}}}}^{T}{\\mathbf{K%\n}}^{T}\\right)}}_{\\text{Value}({{\\mathbf{P}}})}\\;=\\;\\underbrace{{\\mathbf{A}}({{%\n{\\mathbf{P}}}})\\,{\\mathbf{V}}\\vphantom{\\text{softmax}\\left({\\mathbf{Q}}{{{%\n\\mathbf{P}}}^{T}}{{{\\mathbf{P}}}}{\\mathbf{K}}^{T}\\right)}}_{{\\mathbf{W}}({{{%\n\\mathbf{P}}}})}\\,{{{\\mathbf{P}}}}\\;\\;=\\;{\\mathbf{W}}({{{\\mathbf{P}}}}){{{%\n\\mathbf{P}}}}.')
('3.3', '{\\mathbf{A}}({{{\\mathbf{P}}}})')
('3.3', '{\\mathbf{Q}},{\\mathbf{K}}')
('3.3', '{\\mathbf{V}}')
('3.3', '{\\mathbf{P}}')
('3.3', 'H')
('3.3', '{\\mathbf{U}}')
('3.3', '\\displaystyle\\text{MSA}(\\widetilde{{\\mathbf{P}}})={\\mathbf{U}}\\left[{\\mathbf{W%\n}}_{1}(\\widetilde{{\\mathbf{P}}})\\widetilde{{\\mathbf{P}}},\\;{\\mathbf{W}}_{2}(%\n\\widetilde{{\\mathbf{P}}})\\widetilde{{\\mathbf{P}}},\\;...\\;,{\\mathbf{W}}_{H}(%\n\\widetilde{{\\mathbf{P}}})\\widetilde{{\\mathbf{P}}}\\right]\\quad\\text{with}\\quad%\n\\widetilde{{\\mathbf{P}}}=\\text{LayerNorm}({\\mathbf{P}})')
('3.3', '\\displaystyle\\text{MSA}(\\widetilde{{\\mathbf{P}}})={\\mathbf{U}}\\left[{\\mathbf{W%\n}}_{1}(\\widetilde{{\\mathbf{P}}})\\widetilde{{\\mathbf{P}}},\\;{\\mathbf{W}}_{2}(%\n\\widetilde{{\\mathbf{P}}})\\widetilde{{\\mathbf{P}}},\\;...\\;,{\\mathbf{W}}_{H}(%\n\\widetilde{{\\mathbf{P}}})\\widetilde{{\\mathbf{P}}}\\right]\\quad\\text{with}\\quad%\n\\widetilde{{\\mathbf{P}}}=\\text{LayerNorm}({\\mathbf{P}})')
('3.3', '{\\mathbf{P}}')
('3.3', '{\\mathbf{A}}({{\\mathbf{P}}})')
('3.3', '{\\mathbf{V}}{{\\mathbf{P}}}')
('3.3', '{\\mathbf{U}}')
('3.3', '{\\mathbf{V}}')
('3.3', '{\\mathbf{U}}')
('3.3', '{\\mathbf{U}}')
('3.3', '{\\mathbf{P}}')
('3.3', '\\displaystyle\\text{B-cos Linear}({{\\mathbf{P}}};{\\mathbf{S}})\\;=\\;\\text{MaxOut%\n}\\circ\\text{B-cos}({\\mathbf{P}};{\\mathbf{S}})\\;=\\;{\\mathbf{W}}^{{\\mathbf{S}}}(%\n{\\mathbf{P}}){\\mathbf{P}}\\quad\\text{with}\\quad{\\mathbf{S}}\\in\\{{\\mathbf{U}},{%\n\\mathbf{V}}\\}.')
('3.3', '\\displaystyle\\text{B-cos Linear}({{\\mathbf{P}}};{\\mathbf{S}})\\;=\\;\\text{MaxOut%\n}\\circ\\text{B-cos}({\\mathbf{P}};{\\mathbf{S}})\\;=\\;{\\mathbf{W}}^{{\\mathbf{S}}}(%\n{\\mathbf{P}}){\\mathbf{P}}\\quad\\text{with}\\quad{\\mathbf{S}}\\in\\{{\\mathbf{U}},{%\n\\mathbf{V}}\\}.')
('3.3', '{\\mathbf{A}}({{\\mathbf{P}}})')
('3.3', '{\\mathbf{A}}({\\mathbf{P}})')
('3.3', '\\displaystyle{\\mathbf{A}}({\\mathbf{P}};{\\mathbf{Q}},{\\mathbf{K}})=\\text{%\nsoftmax}\\left(\\widetilde{{\\mathbf{P}}}^{T}{\\mathbf{Q}}^{T}{\\mathbf{K}}%\n\\widetilde{{\\mathbf{P}}}\\right)\\quad\\text{with}\\quad\\widetilde{{\\mathbf{P}}}=%\n\\text{LayerNorm}({\\mathbf{P}})\\,.')
('3.3', '\\displaystyle{\\mathbf{A}}({\\mathbf{P}};{\\mathbf{Q}},{\\mathbf{K}})=\\text{%\nsoftmax}\\left(\\widetilde{{\\mathbf{P}}}^{T}{\\mathbf{Q}}^{T}{\\mathbf{K}}%\n\\widetilde{{\\mathbf{P}}}\\right)\\quad\\text{with}\\quad\\widetilde{{\\mathbf{P}}}=%\n\\text{LayerNorm}({\\mathbf{P}})\\,.')
('3.3', '\\displaystyle\\text{B-cos AttBlock}({{\\mathbf{P}}})={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}\\left({\\mathbf{W}}^{{\\mathbf{U}}}({\\mathbf{P}%\n}^{\\prime})\\left[{\\mathbf{A}}_{h}({\\mathbf{P}}){\\mathbf{W}}_{h}^{{\\mathbf{V}}}%\n({\\mathbf{P}})\\,\\right]_{h=1}^{H}+{\\mathbf{I}}\\right)}}{\\mathbf{P}}={{\\color[%\nrgb]{0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\text{Att}}({\\mathbf{P}})}%\n}\\;{{\\mathbf{P}}}\\;,')
('3.3', '\\displaystyle\\text{B-cos AttBlock}({{\\mathbf{P}}})={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}\\left({\\mathbf{W}}^{{\\mathbf{U}}}({\\mathbf{P}%\n}^{\\prime})\\left[{\\mathbf{A}}_{h}({\\mathbf{P}}){\\mathbf{W}}_{h}^{{\\mathbf{V}}}%\n({\\mathbf{P}})\\,\\right]_{h=1}^{H}+{\\mathbf{I}}\\right)}}{\\mathbf{P}}={{\\color[%\nrgb]{0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\text{Att}}({\\mathbf{P}})}%\n}\\;{{\\mathbf{P}}}\\;,')
('3.3', '{\\mathbf{P}}^{\\prime}=\\left[{\\mathbf{A}}_{h}({\\mathbf{P}}){\\mathbf{W}}_{h}^{{%\n\\mathbf{V}}}({\\mathbf{P}})\\,\\right]_{h=1}^{H}')
('3.3', '{\\mathbf{W}}^{U}')
('3.3', '{\\mathbf{W}}^{V}')
('3.3', '{\\mathbf{A}}_{h}({\\mathbf{P}})')
('3.3', '{\\mathbf{I}}')
('3.4', '\\displaystyle\\text{MLPBlock}({\\mathbf{P}})=\\text{Linear}_{2}\\circ\\text{GELU}%\n\\circ\\text{Linear}_{1}\\circ\\text{LayerNorm}({\\mathbf{P}})+{\\mathbf{P}}')
('3.4', '\\displaystyle\\text{MLPBlock}({\\mathbf{P}})=\\text{Linear}_{2}\\circ\\text{GELU}%\n\\circ\\text{Linear}_{1}\\circ\\text{LayerNorm}({\\mathbf{P}})+{\\mathbf{P}}')
('3.4', '\\displaystyle\\text{B-cos MLPBlock}({\\mathbf{P}})={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}\\left({\\mathbf{M}}_{2}({\\mathbf{P}})\\,{%\n\\mathbf{L}}_{2}({\\mathbf{P}})\\,{\\mathbf{M}}_{1}({\\mathbf{P}})\\,{\\mathbf{L}}_{1%\n}({\\mathbf{P}})+{\\mathbf{I}}\\right)}}{\\mathbf{P}}={{\\color[rgb]{%\n0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\text{MLP}}({\\mathbf{P}})}}\\,{%\n\\mathbf{P}}\\;.')
('3.4', '\\displaystyle\\text{B-cos MLPBlock}({\\mathbf{P}})')
('3.4', '\\displaystyle={{\\color[rgb]{0.15234375,0.62109375,0.80859375}\\left({\\mathbf{M}%\n}_{2}({\\mathbf{P}})\\,{\\mathbf{L}}_{2}({\\mathbf{P}})\\,{\\mathbf{M}}_{1}({\\mathbf%\n{P}})\\,{\\mathbf{L}}_{1}({\\mathbf{P}})+{\\mathbf{I}}\\right)}}{\\mathbf{P}}={{%\n\\color[rgb]{0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\text{MLP}}({%\n\\mathbf{P}})}}\\,{\\mathbf{P}}\\;.')
('3.4', '{\\mathbf{M}}_{i}({\\mathbf{P}})')
('3.4', '{\\mathbf{L}}_{i}({\\mathbf{P}})')
('3.4', '{\\mathbf{I}}')
('3.4', '\\displaystyle\\text{B-cos Classifier}({\\mathbf{P}})=\\text{B-cos}\\circ\\text{Pool%\n}({\\mathbf{P}})={{\\color[rgb]{0.15234375,0.62109375,0.80859375}{\\mathbf{L}}({%\n\\mathbf{P}}^{\\prime}){\\mathbf{W}}^{\\text{AvgPool}}}}{\\mathbf{P}}={{\\color[rgb]%\n{0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\text{Class}}({\\mathbf{P}})}}%\n\\,{\\mathbf{P}}\\;,')
('3.4', '\\displaystyle\\text{B-cos Classifier}({\\mathbf{P}})=\\text{B-cos}\\circ\\text{Pool%\n}({\\mathbf{P}})={{\\color[rgb]{0.15234375,0.62109375,0.80859375}{\\mathbf{L}}({%\n\\mathbf{P}}^{\\prime}){\\mathbf{W}}^{\\text{AvgPool}}}}{\\mathbf{P}}={{\\color[rgb]%\n{0.15234375,0.62109375,0.80859375}{\\mathbf{W}}^{\\text{Class}}({\\mathbf{P}})}}%\n\\,{\\mathbf{P}}\\;,')
('3.4', '{\\mathbf{L}}({\\mathbf{P}}^{\\prime})')
('3.4', '{\\mathbf{P}}^{\\prime}\\mkern 1.25mu{=}\\mkern 1.25mu\\text{Pool}({\\mathbf{P}})')
('3.5', '{\\mathbf{E}}')
('3.5', '{\\mathbf{P}}')
('3.5', '{\\mathbf{B}}_{h}^{l}')
('3.5', 'h')
('3.5', 'l')
('3.5', '\\displaystyle{\\mathbf{A}}_{\\text{add}}({\\mathbf{P}})=\\text{SM}\\left({\\mathbf{R%\n}}({\\mathbf{P}})+{\\mathbf{B}}\\right)')
('3.5', '\\displaystyle{\\mathbf{A}}_{\\text{add}}({\\mathbf{P}})')
('3.5', '\\displaystyle=\\text{SM}\\left({\\mathbf{R}}({\\mathbf{P}})+{\\mathbf{B}}\\right)')
('3.5', '\\displaystyle\\text{and}\\quad\\;{\\mathbf{A}}_{\\text{mul}}({\\mathbf{P}})=\\text{SM%\n}\\left({\\mathbf{R}}({\\mathbf{P}})\\right)\\times\\text{SM}\\left({\\mathbf{B}}%\n\\right)\\;.')
('3.5', '\\displaystyle\\text{and}\\quad\\;{\\mathbf{A}}_{\\text{mul}}({\\mathbf{P}})')
('3.5', '\\displaystyle=\\text{SM}\\left({\\mathbf{R}}({\\mathbf{P}})\\right)\\times\\text{SM}%\n\\left({\\mathbf{B}}\\right)\\;.')
('3.5', '{\\mathbf{R}}({\\mathbf{P}})\\mkern 1.25mu{=}\\mkern 1.25mu{\\mathbf{Q}}\\widetilde{%\n{\\mathbf{P}}}\\widetilde{{\\mathbf{P}}}^{T}{\\mathbf{K}}^{T}')
('3.5', '{\\mathbf{B}}')
('3.5', '{\\mathbf{B}}')
('4', '\\times')
('4', '\\in')
('4', '\\in')
('4', '2.5e^{-4}')
('4', '\\times')
('4', '\\times')
('5.1', '{\\mathbf{A}}_{\\text{mul}}')
('5.1', '{\\mathbf{A}}_{\\text{mul}}')
('5.2', '2.47')
('5.2', '\\,\\times 2.47')
('5.2', '\\,\\times 1.99')
('5.2', '\\,\\times 2.47')
('5.2', '\\,\\times 1.99')
('5.2', '1.99')
('5.2', 'k')
('5.2', '{\\mathbf{W}}({\\mathbf{x}})')
('5.2', 'k')
('5.2', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '[-p,p]')
('A1.1', 'p')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.1', '\\displaystyle{\\mathbf{W}}({\\mathbf{x}})={\\mathbf{W}}^{\\text{Class}}({\\mathbf{x%\n}})\\;\\textstyle\\prod_{l=1}^{L}\\left({\\mathbf{W}}^{\\text{MLP}}_{l}({\\mathbf{x}}%\n)\\;{\\mathbf{W}}^{\\text{Att}}_{l}({\\mathbf{x}})\\right)\\,\\;{\\mathbf{W}}^{\\text{%\nTokens}}({\\mathbf{x}})\\,.')
('A1.1', '\\displaystyle{\\mathbf{W}}({\\mathbf{x}})={\\mathbf{W}}^{\\text{Class}}({\\mathbf{x%\n}})\\;\\textstyle\\prod_{l=1}^{L}\\left({\\mathbf{W}}^{\\text{MLP}}_{l}({\\mathbf{x}}%\n)\\;{\\mathbf{W}}^{\\text{Att}}_{l}({\\mathbf{x}})\\right)\\,\\;{\\mathbf{W}}^{\\text{%\nTokens}}({\\mathbf{x}})\\,.')
('A1.1', '\\displaystyle{\\mathbf{A}}_{\\text{rollout}}({\\mathbf{x}})={\\mathbf{I}}^{\\text{%\nClass}}\\;\\textstyle\\prod_{l=1}^{L}\\left({\\mathbf{I}}^{\\text{MLP}}_{l}\\;\\bar{{%\n\\mathbf{A}}}_{l}({\\mathbf{x}})\\right)\\,\\;{\\mathbf{I}}^{\\text{Tokens}}\\,,')
('A1.1', '\\displaystyle{\\mathbf{A}}_{\\text{rollout}}({\\mathbf{x}})={\\mathbf{I}}^{\\text{%\nClass}}\\;\\textstyle\\prod_{l=1}^{L}\\left({\\mathbf{I}}^{\\text{MLP}}_{l}\\;\\bar{{%\n\\mathbf{A}}}_{l}({\\mathbf{x}})\\right)\\,\\;{\\mathbf{I}}^{\\text{Tokens}}\\,,')
('A1.1', '{\\mathbf{I}}^{\\text{layer}}')
('A1.1', '\\bar{{\\mathbf{A}}}_{l}')
('A1.1', 'l')
('A1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.2', '-v')
('A1.2', 'v')
('A1.2', 'v')
('A1.2', 'v')
('A1.3', 'k')
('A1.3', '{\\mathbf{W}}({\\mathbf{x}})')
('A1.3', 'k')
('A1.3', '{\\mathbf{W}}({\\mathbf{x}})')
('A2.2', '10^{5}')
('A2.2', '10^{0}')
('A3.1.1', 'k\\mkern 1.25mu{=}\\mkern 1.25mu1,2,4')
('A3.1.1', 's\\mkern 1.25mu{=}\\mkern 1.25mu1,2,4')
('A3.1.1', '10^{3}')
('A3.1.1', 'c\\mkern 1.25mu{=}\\mkern 1.25mu192,384,768')
('A3.1.1', 'c\\mkern 1.25mu{\\times}\\mkern 1.25muh\\mkern 1.25mu{\\times}\\mkern 1.25muw')
('A3.1.1', 'n\\mkern 1.25mu{\\times}\\mkern 1.25muc')
('A3.1.1', 'n')
('A3.1.1', '{\\mathbf{B}}\\mkern 1.25mu{\\in}\\mkern 1.25mu\\mathbb{R}^{m\\times n\\times n}')
('A3.1.1', 'm')
('A3.1.1', '{\\mathbf{B}}')
('A3.1.1', 'C\\mkern 1.25mu{=}\\mkern 1.25mu1000')
('A3.1.1', '\\gamma\\mkern 1.25mu{=}\\mkern 1.25muf/\\sqrt{c}')
('A3.1.1', 'f\\mkern 1.25mu{=}\\mkern 1.25mu15,20,25')
('A3.1.1', '\\leq 1')
('A3.1.1', 'f')
('A3.1.1', '10')
('A3.1.1', '10^{3}')
('A3.1.1', '{\\mathbf{b}}\\mkern 1.25mu{\\in}\\mkern 1.25mu\\mathbb{R}^{C}')
('A3.1.1', '\\log(0.01/0.99)')
('A3.1.1', 'C')
('A3.1.1', '[r,g,b,1\\mkern 1.25mu{-}\\mkern 1.25mur,1\\mkern 1.25mu{-}\\mkern 1.25mug,1\\mkern\n1%\n.25mu{-}\\mkern 1.25mub]')
('A3.1.1', 'r,g,b\\mkern 1.25mu{\\in}\\mkern 1.25mu[0,1]')
('A3.1.1', '{\\mathbf{W}}({\\mathbf{x}})')
('A3.2', 'n\\mkern 1.25mu{=}\\mkern 1.25mu2')
('A3.2', 'm\\mkern 1.25mu{=}\\mkern 1.25mu9')
('A3.2', '224\\mkern 1.25mu{\\times}\\mkern 1.25mu224')
('A3.2', '224\\mkern 1.25mu{\\times}\\mkern 1.25mu224')
('A3.3', '\\mkern 1.25mu{\\times}\\mkern 1.25mu')
('A3.3', '[-v,v]')
('A3.3', 'v')
('A3.3', '{\\mathbf{W}}({\\mathbf{x}})')
('A3.3', '{\\mathbf{p}}=[r,g,b,1\\mkern 1.25mu{-}\\mkern 1.25mur,1\\mkern 1.25mu{-}\\mkern 1.%\n25mug,1\\mkern 1.25mu{-}\\mkern 1.25mub]')
('A3.3', 'r,g,b\\mkern 1.25mu{\\in}\\mkern 1.25mu[0,1]')
('A3.3', '{\\mathbf{p}}')
('A3.3', '{\\mathbf{W}}({\\mathbf{x}})')
('A3.3', '\\alpha')
('A3.3', '\\alpha')
('A3.3', 'n\\mkern 1.25mu{=}\\mkern 1.25mu32')
('A3.3', '\\mkern 1.25mu{\\times}\\mkern 1.25mu')
('A3.4.1', '2\\mkern 1.25mu{\\times}\\mkern 1.25mu2')
('A3.4.1', '448\\mkern 1.25mu{\\times}\\mkern 1.25mu448')
('A3.4.1', '224\\mkern 1.25mu{\\times}\\mkern 1.25mu224')
('A3.4.2', 'r')
('A3.4.2', '(r,o)\\mkern 1.25mu{=}\\mkern 1.25mu(0,1)')
('A3.4.2', 'r')
('A3.4.2', 'o')
