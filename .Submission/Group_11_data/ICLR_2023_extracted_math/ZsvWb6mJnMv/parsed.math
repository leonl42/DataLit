('1', '1/\\sqrt{N}')
('1', 'N')
('1', '1/N^{1/6}')
('1.0.0', 'N')
('1.0.0', '{O}(1/\\sqrt{N})')
('1.0.0', 'O(1/\\sqrt{N})')
('1.0.0', '1/\\sqrt{N}')
('1.0.0', '1/N^{1/6}')
('1.0.0', 'd_w \\coloneqq \\sum_a w(a) \\mu(a) = 1')
('1.0.0', 'a')
('1.0.0', 'w')
('1.0.0', '\\mu')
('1.0.0', 'd_w = \\Omega (1)')
('1.0.0', 'd_w')
('1.0.0', 'w')
('1.0.0', '\\sum_a w(a) \\mu(a) \\neq 1')
('1.0.0', 'd_w = \\Omega(1)')
('1.0.0', 'O(1/\\sqrt{N})')
('1.0.0.0', '\\Omega(N^\\beta)')
('1.0.0.0', '\\beta > -1/2')
('1.0.0.0', 'O(1/\\sqrt{N})')
('1.0.0.1', 'd_w(s) \\coloneqq \\sum_a w(s,a) \\mu(s,a)')
('1.0.0.1', 'd^{\\pi_w}(s)')
('1.0.0.1', '\\pi_w')
('1.0.0.1', 'w')
('1.0.0.1', 'O(1/\\sqrt{N})')
('2.0', 'M = (\\mathcal{S}, \\mathcal{A}, P, R, \\rho, \\gamma)')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', 'P: \\mathcal{S}\\times \\mathcal{A}\\mapsto \\Delta(\\mathcal{S})')
('2.0', 'R: \\mathcal{S}\\times \\mathcal{A}\\mapsto \\Delta([0,1])')
('2.0', 'r: \\mathcal{S}\\times \\mathcal{A}\\mapsto [0,1]')
('2.0', '\\rho: \\mathcal{S}\\mapsto \\Delta(\\mathcal{S})')
('2.0', '\\gamma \\in [0,1)')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', '\\pi: \\mathcal{S}\\mapsto \\Delta(\\mathcal{A})')
('2.0', '\\pi')
('2.0', 'd^\\pi: \\mathcal{S}\\times \\mathcal{A}\\mapsto [0,1]')
('2.0', 'd^\\pi(s,a) \\coloneqq (1-\\gamma)\\sum_{t=0}^\\infty \\gamma^t P_t(s_t = s, a_t = a; \\pi)')
('2.0', 'P_t(s_t = s, a_t = a; \\pi)')
('2.0', '(s,a)')
('2.0', 't')
('2.0', 's_0 \\sim \\rho(\\cdot)')
('2.0', '\\pi')
('2.0', 'd^\\pi(s) = \\sum_{a \\in \\mathcal{A}} d^\\pi(s,a)')
('2.0', '\\mathbb{P}^\\pi')
('2.0', 'u: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}')
('2.0', "(\\mathbb{P}^\\pi u)(s,a) \\coloneqq \\sum_{s',a'} P(s'| s,a) \\pi(a'| s') u(s',a')")
('2.0', '\\pi')
('2.0', 'V^\\pi(s) \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}\\left[\\sum_{t=0}^\\infty \\gamma^t r_t \\; | \\; s_0 = s , a_t \\sim \\pi(\\cdot |s_t) \\; \\forall \\; t\\geq 0 \\right]')
('2.0', 's \\in \\mathcal{S}')
('2.0', 'Q^\\pi(s,a) \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}\\left[\\sum_{t=0}^\\infty \\gamma^t r_t \\; | \\; s_0 = s, a_0 = a, a_t \\sim \\pi(\\cdot |s_t) \\; \\forall \\; t\\geq 1 \\right]')
('2.0', 'J(\\pi) \\coloneqq (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s\\sim \\rho}[V^\\pi(s)] = \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim d^\\pi} [r(s,a)]')
('2.0', '\\pi')
('2.0', '\\pi^\\star')
('2.0', 'V^\\star \\coloneqq V^{\\pi^\\star}')
('2.0.0', "\\mathcal{D}= \\{(s_i,a_i,r_i,s_i')\\}_{i=1}^N")
('2.0.0', 'r_i \\sim R(s_i,a_i)')
('2.0.0', "s_i' \\sim P(\\cdot\\mid s_i,a_i)")
('2.0.0', 's_i,a_i')
('2.0.0', '\\mu \\in \\Delta(\\mathcal{S}\\times \\mathcal{A})')
('2.0.0', '\\mu(a|s)')
('2.0.0', '\\mu(a|s)')
('2.0.0', '\\hat{\\pi}')
('2.0.0', '\\pi^\\star')
('2.0.0', 'J(\\pi^\\star) - J(\\hat{\\pi})')
('2.0.0.0', 'w(s,a)')
('2.0.0.0', '\\begin{aligned}\n\\label{eq:definitions_dw_sa}\n    d_w(s,a) \\coloneqq w(s,a) \\mu(s,a), \\quad d_w(s) \\coloneqq \\sum_{a \\in \\mathcal{A}} d_w(s,a).\n\\end{aligned}')
('2.0.0.0', 'w')
('2.0.0.0', '\\begin{aligned}\n\\pi_w(a|s) = \n    \\begin{dcases}\n        \\frac{d_w(s,a)}{d_w(s)} = \\frac{w(s,a) \\mu(a|s)}{\\sum_{a \\in \\mathcal{A}} w(s,a) \\mu(a|s)} \\quad & d_w(s) > 0\\\\\n        \\frac{1}{|\\mathcal{A}|} \\quad & d_w(s) = 0\n    \\end{dcases}\n\\end{aligned}')
('2.0.0.1', '\\pi')
('2.0.0.1', 'C^\\pi')
('2.0.0.1', '\\frac{d^{\\pi}(s,a)}{\\mu(s,a)} \\leq C^\\pi')
('2.0.0.1', 's \\in \\mathcal{S}')
('2.0.0.1', 'a \\in \\mathcal{A}')
('2.0.0.1', 'C^\\star \\coloneqq C^{\\pi^\\star}')
('2.0.0.1', '\\pi^\\star')
('2.0.0.1', '\\max_\\pi C^\\pi')
('2.0.0.2', '\\mathcal{S}')
('2.0.0.2', '|\\mathcal{S}|')
('2.0.0.2', '\\Delta(\\mathcal{S})')
('2.0.0.2', '\\mathcal{S}')
('2.0.0.2', '\\mathcal{W}')
('2.0.0.2', '|\\mathcal{W}|')
('2.0.0.2', 'x \\lesssim y')
('2.0.0.2', 'c>0')
('2.0.0.2', 'x \\leq c y')
('2.0.0.2', 'x \\asymp y')
('2.0.0.2', 'c_1, c_2 > 0')
('2.0.0.2', 'c_1 |x| \\leq |y| \\leq c_2 |x|')
('2.0.0.2', 'f(x) = O(g(x))')
('2.0.0.2', 'M > 0, x_0')
('2.0.0.2', '|f(x)|\\leq M g(x)')
('2.0.0.2', 'x\\geq x_0')
('2.0.0.2', '\\operatorname{clip}(x, a, b) \\triangleq \\max\\{ a, \\min\\{x, b\\} \\}')
('2.0.0.2', 'x, a, b \\in \\mathbb{R}')
('2.0.0.2', 'f(x) = \\Omega(g(x))')
('2.0.0.2', 'M')
('2.0.0.2', 'x_0')
('2.0.0.2', '|f(x)|\\geq  M g(x)')
('2.0.0.2', 'x\\geq x_0')
('3', '\\gamma = 0')
('3', '|\\mathcal{S}| = 1')
('3', '\\mathcal{D}= \\{(a_i, r_i)\\}_{i=1}^N')
('3', 'a_i \\sim \\mu(\\cdot), r_i \\sim R(a_i)')
('3', 'd')
('3', '\\begin{aligned}\n \\label{eq:MAB-constrained-optimization-with-d}\n    \\max_{d \\geq 0} \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim d} \\left[ r(a) \\right]\n    \\qquad \\text{s.t.}  \\quad \\sum_{a} d(a) = 1.\n\\end{aligned}')
('3.0', 'w(a) = d(a)/\\mu(a)')
('3.0', 'v')
('3.0', '\\begin{aligned}\n\\label{eq:population-objective-MAB}\n    \\max_{w \\geq 0} \\min_{v}  L^{\\text{MAB}}_\\alpha(w, v) \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} \\left[ w(a)r(a) \\right] - v\\left( \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w(a)] - 1 \\right) - \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} \\left[ f\\left(w(a)\\right) \\right].\n\\end{aligned}')
('3.0', 'f')
('3.0', 'd')
('3.0', '\\mu')
('3.0', '\\alpha')
('3.0', 'w^\\star_\\alpha')
('3.0', 'v^\\star_\\alpha')
('3.0', '\\alpha = 0')
('3.0', 'w^\\star \\coloneqq w^\\star_0')
('3.0', 'v^\\star \\coloneqq v^\\star_0')
('3.0', 'w')
('3.0', 'v')
('3.0', '\\mathcal{W}\\subseteq \\mathbb{R^+}^{|\\mathcal{A}|}')
('3.0', '\\mathcal{V}\\subseteq \\mathbb{R}')
('3.0', '\\mathcal{D}= \\{(a_i, r_i)\\}_{i=1}^N')
('3.0', '\\mathcal{V}')
('3.0', '\\mathcal{W}')
('3.0', 'f(\\cdot)')
('3.0', '\\alpha')
('3.0', '\\hat w, \\hat v')
('3.0', '\\begin{aligned}\n\\label{eq:MAB-empirical-objective}\n    \\max_{w \\in \\mathcal{W}} \\min_{v \\in \\mathcal{V}} \\hat L^{\\text{MAB}}_\\alpha(w, v) \\coloneqq \\frac{1}{N}\\sum_{i=1}^N w(a_i) r_i  - v (w(a_i) - 1) - \\alpha f(w(a_i)). \n\\end{aligned}')
('3.0', '\\hat \\pi = \\pi_{\\hat w}')
('3.0', '\\alpha = 0')
('3.0', '\\mathcal{W}')
('3.0', 'w(a) = d(a)/\\mu(a) \\leq B_w')
('3.0', 'w \\in \\mathcal{W}')
('3.0', '0 \\leq w(a) \\leq B_w')
('3.0', 'w \\in \\mathcal{W}')
('3.0', '|v| \\leq B_v')
('3.0', 'v \\in \\mathcal{V}')
('3.0', 'w^\\star \\in \\mathcal{W}')
('3.0', 'v^\\star \\in \\mathcal{V}')
('3.0', '\\pi^\\star \\coloneqq \\pi_{w^\\star}')
('3.0', 'N \\geq 2')
('3.0', '\\hat \\pi')
('3.0', '\\alpha = 0')
('3.0', 'J(\\pi^\\star) - J(\\hat \\pi) = {1}/{6}')
('3.0', '\\alpha = 0')
('3.0', '\\alpha > 0')
('3.0', '\\alpha')
('3.0', 'f: \\mathbb{R} \\mapsto \\mathbb{R}')
('3.0', 'M_f')
('3.0', '|f(x)| \\leq B_f')
('3.0', "|f'(x)| \\leq B_{f'}")
('3.0', '0 \\leq w(a) \\leq B_w')
('3.0', 'w \\in \\mathcal{W}')
('3.0', '|v| \\leq B_v')
('3.0', 'v \\in \\mathcal{V}')
('3.0', '\\delta \\geq 0')
('3.0', '\\begin{aligned}\n\\label{eq:alpha-def}\n    \\alpha = \\frac{16((B_w+1)(B_v+1) + B_f)}{M_f} \\sqrt{\\frac{\\log (|\\mathcal{V}||\\mathcal{W}|/\\delta)}{N}}.\n\\end{aligned}')
('3.0', 'w^\\star_\\alpha \\in \\mathcal{W}')
('3.0', 'v^\\star_\\alpha \\in \\mathcal{V}')
('3.0', '\\pi^\\star \\coloneqq \\pi_{w^\\star}')
('3.0', '\\pi^\\star_\\alpha \\coloneqq \\pi_{w^\\star_\\alpha}')
('3.0', '\\alpha')
('3.0', '1-\\delta')
('3.0', '\\hat \\pi')
('3.0', "\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) %& \\lesssim \\alpha (B_f + f'(C^\\star) B_w) \n    % \\lesssim \\frac{(B_f + B_w(B_v+1))(B_f + f'(C^\\star) B_w)}{M_f} \\sqrt{\\frac{\\log (|\\cV||\\cW|/\\delta)}{N}}.\n    \\lesssim \\frac{(B_f + B_w(B_v+1))(B_f + B_{f'} B_w)}{M_f} \\sqrt{\\frac{\\log (|\\mathcal{V}||\\mathcal{W}|/\\delta)}{N}}.\n\\end{aligned}")
('3.0', '1/N^{1/6}')
('3.0', '\\alpha + 1/(\\alpha^{1/2} N^{1/4})')
('3.0', '\\alpha')
('3.0', '\\hat w')
('3.0', 'w^\\star_\\alpha')
('3.0', 'L^{\\text{MAB}}_\\alpha')
('3.0', '\\alpha')
('3.0', '\\alpha')
('3.0', '1/N^{1/6}')
('3.0', '(\\alpha + 1/ \\sqrt{N})/d_{\\hat w}')
('3.0', 'd_{\\hat w} = \\sum_a \\hat w(a) \\mu(a)')
('3.0', '\\alpha \\asymp 1/\\sqrt{N}')
('3.0', 'd_{\\hat w} = \\Omega(1)')
('3.0', 'd_w')
('3.0', 'w \\in \\mathcal{W}')
('3.1', '\\hat \\pi')
('3.1', '\\alpha = 0')
('3.1', '\\sum_a \\mu(a) \\hat w(a) = 1')
('3.1', '\\delta > 0')
('3.1', '\\hat \\pi')
('3.1', '1-\\delta')
('3.1', '\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) \\lesssim B_w(B_v + 1) \\sqrt{\\frac{\\log (|\\mathcal{V}||\\mathcal{W}|/\\delta)}{N}}.\n\\end{aligned}')
('3.1', '\\begin{aligned}\n\\label{eq:AL-population-objective-MAB}\n    \\max_{w \\geq 0} \\min_{v}  L^{\\text{MAB}}_{\\text{AL}}(w, v) \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} \\left[ w(a)r(a) \\right] - v\\left( \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w(a)] - 1 \\right) - \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w(a)] - 1 \\right)^2.\n\\end{aligned}')
('3.1', 'w^\\star')
('3.1', '\\mathcal{D}= \\{(a_i, r_i)\\}_{i=1}^N')
('3.1', '\\mathcal{W}')
('3.1', '\\mathcal{V}')
('3.1', '\\hat w, \\hat v')
('3.1', '\\begin{aligned}\n\\label{eq:MAB-empirical-objective-AL} \n    \\max_{w \\in \\mathcal{W}} \\min_{v \\in \\mathcal{V}} \\hat L^{\\text{MAB}}_{AL}(w, v)  \\coloneqq \\frac{1}{N}\\sum_{i=1}^N w(a_i) r_i - v (w(a_i) - 1) - \\Big(\\frac{1}{N} \\sum_{i=1}^N w(a_i) - 1\\Big)^2.\n\\end{aligned}')
('3.1', '\\hat \\pi = \\pi_{\\hat w}')
('3.1', '0 \\leq w(a) \\leq B_w')
('3.1', 'w \\in \\mathcal{W}')
('3.1', '|v| \\leq B_v')
('3.1', 'v \\in \\mathcal{V}')
('3.1', 'w^\\star \\in \\mathcal{W}')
('3.1', 'v^\\star \\in \\mathcal{V}')
('3.1', '\\pi^\\star = \\pi_{w^\\star}')
('3.1', '\\delta > 0')
('3.1', '\\hat \\pi')
('3.1', '1-\\delta')
('3.1', '\\begin{aligned}\n\\label{eq:ALM-MAB-suboptimality}\n    J(\\pi^\\star) - J(\\hat \\pi) & \\lesssim B_w^2(B_v +1) \\sqrt{\\frac{\\log (|\\mathcal{W}||\\mathcal{V}|/\\delta)}{N}}.\n\\end{aligned}')
('3.1', '\\mathcal{W}')
('3.1', '\\mathcal{V}= [0,1], \\delta = 1/N')
('3.1', 'B_w = C^\\star')
('3.1', 'J(\\pi^\\star) - J(\\hat \\pi) \\lesssim (C^\\star)^2 \\sqrt{\\log (N|\\mathcal{A}|)/N}')
('3.1', 'J(\\pi^\\star) - J(\\hat \\pi) \\lesssim \\sqrt{C^\\star \\log (N|\\mathcal{A}|)/N}')
('3.1', 'C^\\star')
('3.1', '\\hat w')
('3.1', 'd_{\\hat w} = \\Omega(1)')
('3.1', '\\mathcal{W}')
('3.1', 'd_{\\hat w}(a)/\\mu(a) = \\hat w(a) \\leq B_w')
('3.1', 'd_{\\hat w}')
('3.1', 'c')
('3.1', '\\hat \\pi(a) = d_{\\hat w}(a)/d_{\\hat w} \\leq  d_{\\hat w}(a)/c')
('3.1', '\\hat \\pi')
('3.1', '\\begin{aligned}\n    \\frac{\\hat \\pi(a)}{\\mu(a)} = \\frac{d_{\\hat w}(a)}{d_{\\hat w}} \\frac{1}{\\mu(a)} \\leq \\frac{1}{c} \\frac{d_{\\hat w}(a)}{\\mu(a)} = \n \\frac{1}{c} \\hat{w}(a)\\leq \\frac{B_w}{c},\n\\end{aligned}')
('3.1', '\\mu')
('3.1', '\\pi^\\star')
('3.1', '\\pi^\\star, \\pi^\\star_\\alpha')
('3.1', 'f')
('3.1', '\\alpha')
('4', '\\gamma = 0')
('4', '\\mathcal{D}= \\{(s_i, a_i, r_i)\\}_{i=1}^N')
('4', 's_i \\sim \\mu(\\cdot) = \\rho(\\cdot)')
('4', 'a_i \\sim \\mu(\\cdot| s_i)')
('4', 'r_i \\sim R(s_i, a_i)')
('4', '\\begin{aligned}\n \\label{eq:CB-constrained-optimization-with-d}\n    \\max_{d \\geq 0} \\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim d } \\left[ r(s, a) \\right]\n    \\qquad \\text{s.t.}  \\quad \\sum_{a} d(s, a) = \\rho(s) \\quad \\forall s \\in \\mathcal{S}.\n\\end{aligned}')
('4.0', 'w^\\star_\\alpha, v^\\star_\\alpha')
('4.0', 'f: \\mathbb{R} \\mapsto \\mathbb{R}')
('4.0', 'M_f')
('4.0', '|f(x)| \\leq B_f')
('4.0', "|f'(x)| \\leq B_{f'}")
('4.0', '0 \\leq w(s, a)\\leq B_w')
('4.0', 'w \\in \\mathcal{W}')
('4.0', '|v(s)| \\leq B_v')
('4.0', 'v \\in \\mathcal{V}')
('4.0', 'w^\\star, w^\\star_\\alpha \\in \\mathcal{W}')
('4.0', 'v^\\star, v^\\star_\\alpha \\in \\mathcal{V}')
('4.0', '\\pi^\\star, \\pi^\\star_\\alpha')
('4.0', '\\hat \\pi')
('4.0', 'N \\geq n_0')
('4.0', 'n_0')
('4.0', "\\delta, B_w, B_v, B_f, B_{f'}")
('4.0', '\\alpha \\geq 0')
('4.0', 'J(\\pi^\\star) - J(\\hat \\pi)  \\gtrsim N^\\beta')
('4.0', '\\beta > -1/2')
('4.0', '1/\\sqrt{N}')
('4.0', '\\alpha')
('4.0', '\\sum_a \\hat w(s,a) \\mu(a|s) = \\Omega(1)')
('4.1', '\\begin{aligned}\n\\label{eq:AL-population-objective-CB}\n    \\max_{w \\geq 0} \\min_{v}  L^{\\text{CB}}_{\\text{AL}}(w, v)\n    \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[ w(s,a)r(s,a) \\right] \n    - \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[v(s) (w(s,a) - 1)] - \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\mu} [(\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu(\\cdot|s)}[w(s,a)] - 1)^2]\n\\end{aligned}')
('4.1', '|\\mathcal{S}| = 1')
('4.1', '\\sum_a w(s,a) \\mu(a|s) \\approx 1')
('4.1', 'w^\\star')
('4.1', 'v^\\star(s) \\coloneqq V^\\star(s)')
('4.1', 's \\in \\mathcal{S}')
('4.1', '\\mathcal{D}= \\{(s_i, a_i, r_i)\\}_{i=1}^N')
('4.1', '\\mathcal{W}, \\mathcal{V}')
('4.1', '\\hat w, \\hat v')
('4.1', '\\begin{aligned}\n\\label{eq:CB-empirical-objective-AL}\n        \\max_{w \\in \\mathcal{W}} \\min_{v \\in \\mathcal{V}} \\hat L^{\\text{CB}}_{\\text{AL}}(w, v) \\coloneqq \\frac{1}{N}\\sum_{i=1}^N w(s_i, a_i) (r_i - v(s_i)) + v(s_i) - \\Big(\\sum_{a \\in \\mathcal{A}} w(s_i, a) \\mu(a|s_i) - 1\\Big)^2\n\\end{aligned}')
('4.1', '\\hat \\pi = \\pi_{\\hat w}')
('4.1', 'w')
('4.1', 'v')
('4.1', '0 \\leq w(s, a)\\leq B_w')
('4.1', 'w \\in \\mathcal{W}')
('4.1', 'v(s) \\leq B_v')
('4.1', 'v \\in \\mathcal{V}')
('4.1', 'w^\\star \\in \\mathcal{W}')
('4.1', 'v^\\star \\in \\mathcal{V}')
('4.1', '\\pi^\\star = \\pi_{w^\\star}')
('4.1', '\\delta \\geq 0')
('4.1', '\\hat \\pi')
('4.1', '1-\\delta')
('4.1', '\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) \\lesssim B_w^2(B_v +1) \\sqrt{\\frac{\\log (|\\mathcal{W}||\\mathcal{V}|/\\delta)}{N}}.  \n\\end{aligned}')
('5', '\\mathcal{D}_0 = \\{s_i\\}_{i=1}^{N_0}')
('5', '\\rho')
('5', "\\begin{aligned}\n\\label{eq:MDP-LP-program}\n    \\max_{d \\geq 0} \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim d} [r(s,a)] \\qquad \n    \\text{s.t.} \\quad & d(s) = (1-\\gamma) \\rho(s) + \\gamma \\sum_{s', a'} P(s|s', a') d(s', a') \\quad \\forall s \\in \\mathcal{S}. \n\\end{aligned}")
('5', 'd^\\pi')
('5', '\\pi')
('5.0', '\\begin{aligned}\n\\label{eq:MDP-population-AL-objective}\n        \\max_{w \\geq 0} \\min_{v} L^{\\text{MDP}}_{\\text{AL}} (w, v) \\coloneqq (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{\\rho} [v(s)] + \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) e_v(s,a)\\right] - \\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_w}} \\left[ \\left(\\frac{d_w(s)}{d^{\\pi_w}(s)} - 1\\right)^2 \\right],\n\\end{aligned}')
('5.0', "e_v(s,a) \\coloneqq r(s,a) + \\gamma \\sum_{s'} P(s'|s,a) v(s') - v(s)")
('5.0', 'd_{w}(s)')
('5.0', 'd^{\\pi_{w}}(s)')
('5.0', 'd^{\\pi_{w}}(s)')
('5.0', '\\hat w(s,a) = d_{\\hat w}(s,a)/\\mu(s,a) \\leq B_w')
('5.0', 'd_{\\hat w}(s,a)/d^{\\pi_{\\hat w}}(s,a) = d_{\\hat w}(s)/d^{\\pi_{\\hat w}}(s) = \\Omega(1)')
('5.0', '{d^{\\pi_{\\hat w}}(s,a)}/{\\mu(s,a)} \\lesssim B_w')
('5.0', 'd^{\\pi_w}')
('5.0', 'd_w(s)/d^{\\pi_w}(s)')
('5.1', 'f')
('5.1', 'd_w')
('5.1', 'f(x) = (x-1)^2')
('5.1', 'd_w')
('5.1', 'd^{\\pi_w}')
('5.1', 'f(x) \\coloneqq (x-1)^2')
('5.1', '\\begin{aligned}\n \\label{eq:f-divergence-variational-form}\n    - \\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_w}} \\left[ \\left(\\frac{d_w(s)}{d^{\\pi_w}(s)} - 1\\right)^2 \\right]\n    = - D_f(d_w \\| d^{\\pi_w}) = \\min_{x} \\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_w}} [f_*(x(s,a))] - \\mathop{\\mathrm{\\mathbb{E}}}_{d_w} [x(s,a)].\n\\end{aligned}')
('5.1', 'f_*')
('5.1', 'f')
('5.1', 'd_w(s,a)/d^{\\pi_w}(s,a) = d_w(s)/d^{\\pi_w}(s)')
('5.1', '\\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_w}} [f_*(x(s,a))]')
('5.1', '\\pi_w')
('5.1', 'f_*(x(s,a))')
('5.1', 'u')
('5.1', '\\begin{aligned}\n\\label{eq:Bellman_u_and_x}\n    u(s,a) \\coloneqq f_*(x(s,a)) + \\gamma (\\mathbb{P}^{\\pi_w} u)(s,a).\n\\end{aligned}')
('5.1', 'u(s,a)')
('5.1', '\\pi_w')
('5.1', 'f_*(x(s,a))')
('5.1', '\\begin{aligned}\n\\label{eq:AL-variational-form-model-based}\n    \\eqref{eq:f-divergence-variational-form} = \\min_u (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho, a \\sim \\pi_w} [u(s, a)] - \\mathop{\\mathrm{\\mathbb{E}}}_\\mu \\left[ w(s,a) f_*^{-1}\\left(u(s,a) - \\gamma  (\\mathbb{P}^{\\pi_w} u)(s,a)\\right)\\right].\n\\end{aligned}')
('5.1', '\\rho')
('5.1', '\\mu')
('5.1', '\\mathcal{D}')
('5.1', '\\mathcal{D}_0')
('5.1', '\\mathbb{P}^{\\pi_w}')
('5.1', '\\mathbb{P}^{\\pi_w}')
('5.1', '\\mathcal{D}')
('5.1', '\\mathcal{D}_0')
('5.1', '\\mathcal{D}_m')
('5.1', '\\mathcal{W}, \\mathcal{V}, \\mathcal{U}, \\mathcal{P}')
('5.1', 'f_*^{-1}(x) = 2 \\sqrt{x + 1} -2')
('5.1', "\\hat P = \\mathop{\\mathrm{arg\\,max}}_{P \\in \\mathcal{P}} \\sum_{i=1}^{N_m} \\ln P(s'_i|s_i, a_i).")
('5.1', '\\hat w, \\hat v, \\hat u')
('5.1', "\\begin{aligned}\n\\label{eq:MDP-empirical-objective-AL-model-based}\n    \\begin{split}\n        & \\max_{w \\in \\mathcal{W}} \\min_{v \\in \\mathcal{V}} \\min_{u \\in \\mathcal{U}} \\hat L^{\\text{model-based}}_{AL}(w, v)  \\coloneqq \\frac{(1-\\gamma)}{N_0}\\sum_{i=1}^{N_0} \\Big(v(s_i)  +  \\sum_a u(s_i,a) \\pi_w(a|s_i)\\Big)\\\\ \n    & \\;+ \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i) \\left[r_i + \\gamma v(s_i') - v(s_i) - f_*^{-1}\\left(u(s_i, a_i) - \\gamma (\\hat{\\mathbb{P}}^{\\pi_w} u)(s_i,a_i)\\right)  \\right] \n    \\end{split}\n\\end{aligned}")
('5.1', '\\hat \\pi = \\pi_{\\hat w}')
('5.1.0', '\\begin{aligned}\n\\label{eq:population-objective-model-based-MDP}\n    \\begin{split}\n    & \\max_{w \\geq 0} \\min_{v} \\min_{u} L_{\\text{AL}}^{\\text{model-based}}(w, v, u) \\coloneqq (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} \\left[v(s) + \\sum_a u(s,a) \\pi_w(a|s) \\right] \\\\\n    & \\quad  + \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[w(s,a) \\left(e_v(s,a) - f_*^{-1} \\left(u(s,a) - \\gamma (\\mathbb{P}^{\\pi_w} u)(s,a)\\right) \\right)\\right]\n    \\end{split}\n\\end{aligned}')
('5.1.0', 'w^\\star')
('5.1.0', 'd_{w^\\star} = d^{\\pi_{w^\\star}}')
('5.1.0', '\\mathcal{P}')
('5.1.0', "\\mathcal{D}_m = \\{ (s_i, a_i, s_i')\\}_{i=1}^{N_m}")
('5.1.0', 's_i, a_i \\sim \\mu')
('5.1.0', "s_i' \\sim P(\\cdot \\mid s_i, a_i)")
('5.1.0', '\\mathcal{D}_m')
('5.1.0', '\\mathcal{D}_0')
('5.1.0', '\\mathcal{D}')
('5.1.0', '\\mathcal{D}_m')
('5.1.0', '\\mathcal{D}')
('5.1.1', 'f_*^{-1}\\big(u(s,a) - \\gamma (P^{\\pi_w} u)(s,a)\\big)')
('5.1.1', "\\begin{aligned}\n\\label{eq:population-objective-model-free-MDP}\n    \\begin{split}\n       & \\max_{w \\geq 0} \\min_{v} \\min_{u} \\max_{\\zeta < 0} L_{\\text{AL}}^{\\text{model-free}}(w,v,u,\\zeta)= (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} \\left[v(s) + \\sum_a u(s,a) \\pi_w(a|s) \\right]   \\\\ & \\ \\ +\n    \\mathop{\\mathrm{\\mathbb{E}}}_{(s,a,s') \\sim \\mu, a' \\sim \\pi_w(\\cdot|s')} [ w(s,a) \\left( e_v(s,a) + (u(s,a) - \\gamma u(s',a'))\\zeta(s,a) +g_*(\\zeta(s,a) ) \\right) ],\n    \\end{split}\n\\end{aligned}")
('5.1.1', 'g_*(x) \\coloneqq x+2+1/x')
('5.1.1', '\\mathcal{D}')
('5.1.1', '\\mathcal{D}_0')
('5.1.1', '\\mathcal{W}, \\mathcal{V}, \\mathcal{U}, \\mathcal{Z}')
('5.1.1', 'g_*(x) = x + 2 + \\frac{1}{x}')
('5.1.1', '\\hat w, \\hat v, \\hat u, \\hat \\zeta')
('5.1.1', '\\max_{w \\in \\mathcal{W}} \\min_{v \\in \\mathcal{V}} \\min_{u \\in \\mathcal{U}} \\max_{\\zeta \\in \\mathcal{Z}} \\hat L_{\\text{AL}}^{\\text{model-free}}(w,v,u,\\zeta)')
('5.1.1', "\\begin{aligned}\n\\label{eq:MDP-empirical-objective-AL-model-free}\n    \\begin{split}\n        & \\frac{(1-\\gamma)}{N_0}\\sum_{i=1}^{N_0} v(s_i)  +  \\sum_a u(s_i,a) \\pi_w(a|s_i) + \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i) \\Big[r_i + \\gamma v(s_i') - v(s_i) \\\\\n        & \\quad +\\zeta(s_i,a_i)\\Big(u(s_i,a_i) - \\gamma \\sum_{a' \\in \\mathcal{A}} u(s'_i, a') \\pi_w(a'|s'_i )\\Big) + g_*(\\zeta(s_i,a_i) )  \\Big] \n    \\end{split}\n\\end{aligned}")
('5.1.1', '\\hat \\pi = \\pi_{\\hat w}')
('5.2', '0 \\leq w(s,a) \\leq B_w')
('5.2', 'w \\in \\mathcal{W}')
('5.2', '|v(s)| \\leq B_v')
('5.2', 'v \\in \\mathcal{V}')
('5.2', '|u(s,a)| \\leq B_u')
('5.2', 'w^\\star \\in \\mathcal{W}')
('5.2', 'v^\\star(s) = V^\\star(s) \\in \\mathcal{V}')
('5.2', '\\pi^\\star = \\pi_{w^\\star}')
('5.2', '\\tilde x_w (s,a) = \\operatorname{clip}(x^\\star_w(s,a), -B_x, B_x)')
('5.2', 'x^\\star_w')
('5.2', 'B_x = (1-\\gamma)/4')
('5.2', 'u^\\star_w')
('5.2', 'x = \\tilde x_w')
('5.2', 'u^\\star_w \\in \\mathcal{U}')
('5.2', 'w \\in \\mathcal{W}')
('5.2', 'B_u')
('5.2', '(1-\\gamma)^{-1}(B_x^2/4 + B_x) \\leq B_u \\leq \\frac{1}{2}')
('5.2', '\\delta \\geq 0')
('5.2', 'N = N_0 = N_m')
('5.2', 'P^\\star \\in \\mathcal{P}')
('5.2', '\\hat \\pi')
('5.2', '\\begin{aligned}\n        J(\\pi^\\star) - J(\\hat \\pi) \\lesssim \\frac{B_v + B_u + (1+B_v)B_w}{(1-\\gamma)^3}\\sqrt{\\frac{B_u\\log(|\\mathcal{P}||\\mathcal{U}||\\mathcal{W}||\\mathcal{V}|/\\delta) }{N}}.\n    \n\\end{aligned}')
('5.2', 'N = N_0')
('5.2', '\\zeta^\\star_{w, u} = \\mathop{\\mathrm{arg\\,max}}_{\\zeta < 0} L^{\\text{model-free}}_{AL}(w, v, u, \\zeta)')
('5.2', '\\zeta^\\star_{w^\\star, u} \\in \\mathcal{Z}')
('5.2', 'u \\in \\mathcal{U}')
('5.2', 'B_{\\zeta, L} \\leq |\\zeta(s,a)| \\leq B_{\\zeta, U}')
('5.2', '\\zeta \\in \\mathcal{Z}')
('5.2', 'B_{\\zeta, L} \\in (0, 2/(2+B_x))')
('5.2', 'B_{\\zeta, U} \\geq 2/(2-B_x)')
('5.2', 'B_{\\zeta} = \\max \\{ B_{\\zeta, U}, B_{\\zeta,L}^{-1}\\}')
('5.2', '\\hat \\pi')
('5.2', '\\begin{aligned}\n        J(\\pi^\\star) - J(\\hat \\pi) \\lesssim \\frac{B_v + B_u + (1+B_v +B_{\\zeta}(B_u+1))B_w}{(1-\\gamma)^3}\\sqrt{\\frac{\\log(|\\mathcal{U}||\\mathcal{W}||\\mathcal{V}||\\mathcal{Z}|/\\delta) }{N}}.\n    \n\\end{aligned}')
('5.2', 'u^\\star_w \\in \\mathcal{U}')
('5.2', 'w \\in \\mathcal{W}')
('5.2', '\\zeta^\\star_{w^\\star, u} \\in \\mathcal{Z}')
('5.2', 'u \\in \\mathcal{U}')
('5.3', 'A')
('5.3', 'L')
('5.3', 'B')
('5.3', 'R')
('5.3', 'C')
('5.3', '\\mu(A, L) = 1/4, \\mu(A, R) = 1/2, \\mu(B) = 1/4, \\mu(C) = 0')
('5.3', '\\pi_{w_1}')
('5.3', '\\mathcal{V}= \\{v^\\star\\}')
('5.3', '\\mathcal{W}= \\{w_1, w_2\\}')
('5.3', 'w_1')
('5.3', 'L')
('5.3', 'A')
('5.3', 'w_2')
('5.3', 'R')
('5.3', 'A')
('5.3', 'w_1(A,L) = 2, w_1(A,R) = 0')
('5.3', 'w_2(A,L) = 0, w_2(A,R) = 1')
('5.3.0', '\\alpha = 0')
('5.3.0', 'w_1')
('5.3.0', 'w_2')
('5.3.0', 'w_1')
('5.3.0', 'w_2')
('5.3.0.0', '-\\alpha \\mathop{\\mathrm{\\mathbb{E}}}_\\mu [w^2(s,a)]')
('5.3.0.0', '\\mathop{\\mathrm{\\mathbb{E}}}_\\mu[w_1^2(s,a)] > \\mathop{\\mathrm{\\mathbb{E}}}_\\mu[w_2^2(s,a)]')
('5.3.0.0', 'w_2')
('5.3.0.0', '\\pi^\\star_\\alpha')
('5.3.0.0', '\\pi^\\star_\\alpha')
('5.3.0.0', '\\mu(s,a) > 0')
('5.3.0.0', '\\mu')
('5.3.0.0', '(A,L)')
('5.3.0.0', '(A,R)')
('5.3.0.0', '\\pi^\\star_\\alpha(R|A) > 0')
('5.3.0.0', 'd^{\\pi^\\star_\\alpha}(C) > 0')
('5.3.0.0', '\\mu(C) > 0')
('5.3.0.0', '\\pi^\\star_\\alpha')
('5.3.0.1', 'w_1')
('5.3.0.1', 'w_1')
('5.3.0.1', 'w_2')
('5.3.0.1', '\\mathbb{E}_{s \\sim d^{\\pi_{2}}} \\left({d_{w_2}(C)}/{d^{\\pi_2}(C)} - 1\\right)^2 \\geq d^{\\pi_{2}}(C) > 0')
('7.0', '\\mu(a|s)')
('7.1', '1/\\sqrt{N}')
('7.1', '1/\\sqrt{N}')
('7.1', '1/N^{1/5}')
('7.1', '\\pi^\\star')
('7.1', '1/\\sqrt{\\text{gap}(Q^\\star)N}')
('7.1', 'Q^\\star')
('7.1', '1/N^{1/3}')
('8.0', '(w^\\star_\\alpha, v^\\star_\\alpha)')
('8.0', 'w^\\star_\\alpha')
('8.0', 'f')
('8.0', 'B_f')
('8.0', 'r^\\star \\coloneqq \\max_{a \\in \\mathcal{A}} r(a)')
('8.0', 'w^\\star_0 = w^\\star')
('8.0', 'w^\\star')
('8.0', 'v^\\star_\\alpha = r^\\star - c \\alpha')
('8.0', "0 \\leq c \\leq f'(C^\\star)")
('8.0', '\\pi^\\star_\\alpha \\coloneqq \\pi_{w^\\star_\\alpha}')
('8.0', 'J(\\pi^\\star) - J(\\pi^\\star_\\alpha) \\leq \\alpha B_f')
('8.0', 'w^\\star_\\alpha(a)')
('8.0', 'v^\\star_\\alpha')
('8.0', "\\begin{aligned}\n    w_\\alpha^\\star(a)=\\max\\left\\{0,(f')^{-1}\\left(\\frac{r(a)-v_\\alpha^\\star}{\\alpha}\\right)\\right\\}.\n\\end{aligned}")
('8.0', 'f')
('8.0', "f'")
('8.0', 'a^\\star')
('8.0', 'w^\\star_\\alpha(a)')
('8.0', 'w^\\star_\\alpha')
('8.0', "\\begin{aligned}\n\\label{eq:vstar-alpha-equation-MAB}\n    w_\\alpha^\\star(a^\\star)=(f')^{-1}\\left(\\frac{r^\\star -v_\\alpha^\\star(s)}{\\alpha}\\right)\\ \\Rightarrow\n    v_\\alpha^\\star=r^\\star -\\alpha f'(w_\\alpha^\\star(a^\\star)).\n\\end{aligned}")
('8.0', "f'(w_\\alpha^\\star(a^\\star))")
('8.0', 'w^\\star_\\alpha')
('8.0', '\\begin{aligned}\n    \\sum_{a \\in \\mathcal{A}} \\mu(a) w_\\alpha^\\star(a) = 1 \\Rightarrow w_\\alpha^\\star(a^\\star) \\leq \\frac{1}{\\mu(a^\\star)} \\leq C^\\star,\n\\end{aligned}')
('8.0', '\\pi^*')
('8.0', "f'")
('8.0', "f'(w^\\star_\\alpha(a^\\star)) \\leq f'(C^\\star)")
('8.0', 'v^\\star_\\alpha')
('8.0', "\\begin{aligned}\n    v^\\star_\\alpha \\geq r^\\star - \\alpha f'(C^\\star).\n\\end{aligned}")
('8.0', 'f')
('8.0', 'v^\\star_\\alpha \\leq r^\\star')
('8.0', 'w_\\alpha^\\star')
('8.0', '\\begin{aligned}\n        \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim d_{w_\\alpha^\\star}} [r(a)] - \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[f(w^\\star_\\alpha(a))] \\geq  \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim d^\\star} [r(a)] - \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[f(w^\\star(a))]\n    \n\\end{aligned}')
('8.0', 'd_{w_\\alpha^\\star}(a) = \\mu(a)w_\\alpha^\\star(a)')
('8.0', '\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w^\\star_\\alpha(a)] - 1 = \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w^\\star(a)] - 1 = 0')
('8.0', '\\pi^\\star_\\alpha')
('8.0', '\\begin{aligned}\n        J(\\pi^\\star) - J(\\pi^\\star_\\alpha) & = \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim d^\\star} [r(a)] \n        - \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim d_{w_\\alpha^\\star}} [r(a)]\\\\\n        & \\leq \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[f(w^\\star(a))] - \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[f(w^\\star_\\alpha(a))]\\\\\n        & \\leq \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[f(w^\\star(a))] \\leq \\alpha f(C^\\star) \\leq \\alpha B_f,\n    \n\\end{aligned}')
('8.0', 'f')
('8.0', 'f')
('8.1', '\\begin{aligned}\n        r(1) & = \\frac{1}{2} \\quad \\text{w.p. } 1, \\qquad r(2) \\sim \\text{Bernoulli}(1/3).\n    \n\\end{aligned}')
('8.1', '\\begin{aligned}\n        \\mu(1) = 1 - \\frac{2}{N}, \\qquad \\mu(2) = \\frac{2}{N}.\n    \n\\end{aligned}')
('8.1', 'C^\\star = 1/\\mu(1)')
('8.1', 'N > 2')
('8.1', 'N(a)')
('8.1', 'a')
('8.1', 'N(a)')
('8.1', '')
('8.1', '1-\\exp( - N \\mu(a) \\delta_u^2 /(2+\\delta_u))')
('8.1', 'N(a) \\leq (1+\\delta_u) N\\mu(a)')
('8.1', '\\delta_u > 0')
('8.1', '1-\\exp( - N \\mu(a) \\delta_l^2 /2)')
('8.1', '(1-\\delta_l) N \\mu(a) \\leq N(a)')
('8.1', '0 < \\delta_l < 1')
('8.1', '1 - \\exp\\left(-2 \\cdot \\frac{0.9^2}{2}\\right) - \\exp\\left(-2\\cdot \\frac{1.95^2}{1.95+2}\\right)  \\geq  0.4')
('8.1', '\\delta_l = 0.9')
('8.1', '\\delta_u = 1.95')
('8.1', '\\begin{aligned}\n        (1-0.9)\\cdot N\\mu(2) \\leq N(2) \\leq (1+1.95) \\cdot N \\mu(2) \\quad \\Rightarrow \\quad 1 \\leq N(2) \\leq 5.\n    \n\\end{aligned}')
('8.1', '\\mathcal{W}= \\{w_1 = (C^\\star, 0), w_2 = (0, B_w)\\}')
('8.1', '\\mathcal{V}= \\{1/2\\}')
('8.1', 'v^\\star_0 = r^\\star = 1/2')
('8.1', 'v^\\star_0 \\in \\mathcal{V}')
('8.1', 'w^\\star_0 = w^\\star = (C^\\star, 0) \\in \\mathcal{W}')
('8.1', 'w_2 = (0,B_w) \\in \\mathcal{W}')
('8.1', 'B_w')
('8.1', 'd_{w_2 } = \\sum_a w_2(a) \\mu(a) = 2B_w/N')
('8.1', 'N(a)')
('8.1', '\\frac{1}{3^5}')
('8.1', '1 \\leq N(2) \\leq 5')
('8.1', '\\hat w')
('8.1', '\\alpha = 0')
('8.1', '|\\mathcal{V}| = 1')
('8.1', '\\hat w = \\arg \\max_{w \\in \\mathcal{W}} \\hat L^{\\text{MAB}}_0(w, v = 1/2)')
('8.1', '\\begin{aligned}\n    \\hat L_0^{\\text{MAB}}(w_1, 1/2) & = \\frac{N(1)}{N} \\left[ C^\\star \\cdot \\frac{1}{2} - \\frac{1}{2} \\left(C^\\star - 1\\right) \\right] + \\frac{N(2)}{2N} = \\frac{1}{2}\\\\\n    \\hat L_0^{\\text{MAB}}(w_2, 1/2) & = \\frac{N(1)}{2N} + \\frac{N(2)}{N} \\left[ B_w - \\frac{1}{2}(B_w - 1)\\right] = \\frac{1}{2} + \\frac{N(2) B_w}{2N}\n\\end{aligned}')
('8.1', 'N(2) \\geq 1')
('8.1', '\\max_{w \\in \\mathcal{W}} \\hat L^{\\text{MAB}}_0(w, v = 1/2)')
('8.1', '\\hat w = (0,B_w)')
('8.1', '0.4 \\times 1/3^5 > 0.001')
('8.1', '\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.\n\\end{aligned}')
('8.2', 'w^\\star_\\alpha')
('8.2', '\\hat w')
('8.2', '\\delta > 0')
('8.2', '\\begin{aligned}\n\\label{eq:statistical-error-MAB}\n    \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}} \\coloneqq ((B_w + 1)(B_v + 1) + \\alpha B_f) \\sqrt{\\frac{\\log |\\mathcal{V}||\\mathcal{W}|/\\delta}{N}}.\n\\end{aligned}')
('8.2', 'w \\in \\mathcal{W}')
('8.2', 'v \\in \\mathcal{V}')
('8.2', '1-\\delta')
('8.2', '|L_\\alpha^{\\text{MAB}}(w, v) - \\hat L_\\alpha^{\\text{MAB}}(w, v)| \\leq \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}')
('8.2', 'L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, v) -  L_\\alpha^{\\text{MAB}}(\\hat w, v) \\leq 2 \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}')
('8.2', 'd_{\\hat w} = \\sum_a \\hat w(a) \\mu(a)')
('8.2', 'f')
('8.2', 'M_f')
('8.2', '\\delta > 0')
('8.2', '1-\\delta')
('8.2', '\\begin{aligned}\n    d_{\\hat w} \\geq 1 - \\sqrt{\\frac{4 \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}}{\\alpha M_f}},\n\\end{aligned}')
('8.2', '\\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}')
('8.2', '\\begin{aligned}\n    \\epsilon_{\\hat w, r} \\coloneqq \\sum_a w^\\star_\\alpha(a) \\mu(a) r(a) - \\hat w(a) \\mu(a) r(a).\n\\end{aligned}')
('8.2', 'L_\\alpha^{\\text{MAB}} (v^\\star_\\alpha, w^\\star_\\alpha) - L_\\alpha^{\\text{MAB}} (v^\\star_\\alpha, \\hat w) \\leq 2  \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}')
('8.2', '\\begin{aligned}\n\\label{eq:converted-obj-diff-bound-MAB}\n    \\epsilon_{\\hat w, r} - \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} [f(w^\\star_\\alpha (a)) - f( \\hat w (a))] + v^\\star_\\alpha  (d_{\\hat w} - 1)  \\leq 2 \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}.\n\\end{aligned}')
('8.2', 'v^\\star_\\alpha = r^\\star - \\alpha c')
('8.2', "c \\leq f'(C^\\star)")
('8.2', "\\begin{aligned}\n\\notag \n    \\epsilon_{\\hat w, r} + r^\\star  (d_{\\hat w} - 1) & \\leq 2  \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}} + \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} [f(w^\\star_\\alpha (a)) - f( \\hat w (a))] + \\alpha c (d_{\\hat w} -1)\\\\\\label{eq:bound-on-wdifference-constraint-violation-MAB}\n    & \\leq 2  \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}} + \\alpha(2  B_f + \\alpha f'(C^\\star) B_w),\n\\end{aligned}")
('8.2', '|f(x)| \\leq B_f')
('8.2', 'd_{\\hat w} \\leq B_w')
('8.2', '\\alpha = 16 \\epsilon_{\\text{stat}, 1}^{\\text{MAB}}/ M_f')
('8.2', 'd_{\\hat w} \\geq 1/2')
('8.2', 'd_{\\hat w} \\geq 1/2')
('8.2', '\\hat \\pi = \\hat w(a) \\mu(a)/ d_{\\hat w}')
('8.2', '\\hat \\pi')
('8.2', '\\pi^\\star_\\alpha')
('8.2', '\\begin{aligned}\n    J(\\pi^\\star_\\alpha) - J(\\hat\\pi)\n    & = \\sum_a w^\\star_\\alpha(a) \\mu(a) r(a)- \\frac{1}{d_{\\hat w}} \\hat w(a) \\mu(a)r(a)\\\\\n    & = \\sum_a w^\\star_\\alpha(a) \\mu(a) r(a) - \\hat w(a) \\mu(a) r(a) + \\sum_a \\left(1- \\frac{1}{d_{\\hat w}}\\right) \\hat w(a) \\mu(a) r(a)\\\\\n    & = \\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) \\sum_a \\frac{1}{d_{\\hat w}} \\hat w(a) \\mu(a) r(a)\\\\\n    &  = \\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) J(\\hat \\pi) \\\\\n    &  = \\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) J(\\pi^\\star_\\alpha) - \\left(d_{\\hat w}- 1\\right) \\left[ J(\\pi^\\star_\\alpha) - J(\\hat \\pi) \\right].\n\\end{aligned}')
('8.2', '\\epsilon_{\\text{reg}} = J(\\pi^\\star) - J(\\pi^\\star_\\alpha) =  r^\\star - J(\\pi^\\star_\\alpha)')
('8.2', 'J(\\pi^\\star_\\alpha) - J(\\hat\\pi)')
('8.2', '\\begin{aligned}\n    J(\\pi^\\star_\\alpha) - J(\\hat \\pi) & = \\frac{1}{d_{\\hat w}} \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) J(\\pi^\\star_\\alpha) \\right)\\\\\n    & = \\frac{1}{\\hat d} \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) (r^\\star - \\epsilon_{\\text{reg}}) \\right)\\\\\n    & \\leq \\frac{1}{d_{\\hat w}} \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) r^\\star\\right) - \\frac{1}{d_{\\hat w}} \\left(d_{\\hat w}- 1\\right) \\epsilon_{\\text{reg}}.\n\\end{aligned}')
('8.2', '\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) & = J(\\pi^\\star) - J(\\pi^\\star_\\alpha) + J(\\pi^\\star_\\alpha) - J(\\hat \\pi)\\\\\n    & = \\epsilon_{\\text{reg}} + J(\\pi^\\star_\\alpha) - J(\\hat \\pi)\\\\\n    & \\leq \\epsilon_{\\text{reg}} + \\frac{1}{d_{\\hat w}} \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) r^\\star\\right) - \\frac{1}{d_{\\hat w}} \\left(d_{\\hat w}- 1\\right) \\epsilon_{\\text{reg}}\\\\\n    & \\leq \\frac{1}{d_{\\hat w}} \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) r^\\star\\right) + \\frac{1}{d_{\\hat w}} \\epsilon_{\\text{reg}}.\n\\end{aligned}')
('8.2', '1/d_{\\hat w} \\leq 2')
('8.2', '\\epsilon_{\\text{reg}}')
('8.2', '\\alpha B_f')
('8.2', "\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) & \\leq \\frac{1}{d_{\\hat w}} \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) r^\\star\\right) + \\frac{1}{d_{\\hat w}} \\epsilon_{\\text{reg}}\\\\\n    & \\leq 2 \\left(\\epsilon_{\\hat w, r} + \\left(d_{\\hat w}- 1\\right) r^\\star\\right) + 2 \\alpha B_f\\\\\n    & \\leq 4 \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}} + \\alpha (4B_f + 2f'(C^\\star) B_w)) + 2 \\alpha B_f\\\\\n    & \\lesssim \\alpha (B_f + f'(C^\\star) B_w).\n\\end{aligned}")
('8.2', '\\hat L_\\alpha^{\\text{MAB}}(w, v)')
('8.2', '\\begin{aligned}\n        |w(a_i) r_i - \\alpha f(w(a_i)) - v(w(a_i) -1)| & \\leq B_w + \\alpha B_f + B_v (B_w +1)\\\\\n        & \\leq (B_w + 1)(B_v + 1) + \\alpha B_f.\n    \n\\end{aligned}')
('8.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathcal{D}} [\\hat L_\\alpha^{\\text{MAB}}(w, v)] = L_\\alpha^{\\text{MAB}}(w,v)')
('8.2', '\\mathcal{D}')
('8.2', 'w')
('8.2', 'v')
('8.2', '(\\hat w, \\hat v)')
('8.2', 'L_\\alpha^{\\text{MAB}}')
('8.2', '\\hat L_\\alpha^{\\text{MAB}}')
('8.2', 'w \\in \\mathcal{W}')
('8.2', '\\begin{aligned}\n        \\hat v_w = \\arg \\min_{v \\in \\mathcal{V}} \\hat L_\\alpha^{\\text{MAB}}(w, v)\n    \n\\end{aligned}')
('8.2', '\\begin{aligned}\n    L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, v) -  L_\\alpha^{\\text{MAB}}(\\hat w, v) & = \\underbrace{L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, v) - L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, \\hat v_{w^\\star_\\alpha})}_{\\coloneqq T_1} + \\underbrace{L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, \\hat v_{w^\\star_\\alpha}) - \\hat L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, \\hat v_{w^\\star_\\alpha})}_{\\coloneqq T_2}\\\\\n    & + \\underbrace{\\hat L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, \\hat v_{w^\\star_\\alpha}) - \\hat L_\\alpha^{\\text{MAB}}(\\hat w, \\hat v)}_{\\coloneqq T_3} + \\underbrace{\\hat L_\\alpha^{\\text{MAB}}(\\hat w, \\hat v) - \\hat L_\\alpha^{\\text{MAB}}(\\hat w, v)}_{\\coloneqq T_4}\\\\\n    & + \\underbrace{\\hat L_\\alpha^{\\text{MAB}}(\\hat w, v) - L_\\alpha^{\\text{MAB}}(\\hat w, v)}_{\\coloneqq T_5},\n\\end{aligned}')
('8.2', 'T_1 = 0')
('8.2', 'w^\\star_\\alpha')
('8.2', '\\sum_a w^\\star_\\alpha(a) \\mu(a) = 1')
('8.2', 'v_1, v_2')
('8.2', 'L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, v_1) = L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha, v_2)')
('8.2', 'T_2 \\leq \\epsilon_{\\text{stat}}')
('8.2', 'T_3 \\leq 0')
('8.2', '\\hat w = \\arg \\max_{w \\in \\mathcal{W}} \\hat L_{\\alpha}(\\hat v_w, w)')
('8.2', 'T_4 \\leq 0')
('8.2', '\\hat v = \\arg \\min_{v \\in \\mathcal{V}} \\hat L_\\alpha^{\\text{MAB}}(v, \\hat w)')
('8.2', 'T_5 \\leq \\epsilon_{\\text{stat}}')
('8.2', 'f')
('8.2', 'M_f')
('8.2', 'L_\\alpha^{\\text{MAB}}(v^\\star_\\alpha, w)')
('8.2', '\\alpha M_f')
('8.2', 'w')
('8.2', '\\|\\cdot \\|_{2, \\mu}')
('8.2', 'w^\\star_\\alpha = \\arg \\max_w L_\\alpha^{\\text{MAB}} (v^\\star, w)')
('8.2', '\\begin{aligned}\n        \\|\\hat w - w^\\star_\\alpha\\|_{2, \\mu} \\leq \\sqrt{\\frac{2(L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha,v^\\star_\\alpha) - L_\\alpha^{\\text{MAB}} (\\hat w,v^\\star_\\alpha))}{\\alpha M_f}}.\n    \n\\end{aligned}')
('8.2', 'L_\\alpha^{\\text{MAB}}(w^\\star_\\alpha,v^\\star_\\alpha) - L_\\alpha^{\\text{MAB}} (\\hat w,v^\\star_\\alpha) \\leq 2 \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}')
('8.2', '|d_{\\hat w} - 1|')
('8.2', '\\begin{aligned}\n        \\left|d_{\\hat w} - 1\\right| = \\left|\\sum_a \\hat w(a) \\mu(a) - \\sum_a w^\\star_\\alpha(a) \\mu(a) \\right| \\leq \\|\\hat w - w^\\star_\\alpha\\|_{1, \\mu} \\leq  \\|\\hat w - w^\\star_\\alpha\\|_{2, \\mu} \\leq \\sqrt{\\frac{4 \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}}{\\alpha M_f}},\n    \n\\end{aligned}')
('8.3', '\\alpha = 0')
('8.3', 'w^\\star_0 = w^\\star')
('8.3', '\\hat w')
('8.3', '\\begin{aligned}\n\\label{eq:objective-stat-error-step1}\n    L(w^\\star, v^\\star) - L(\\hat w, v^\\star) & = \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} [r(a) (w^\\star(a) - \\hat w(a))] - v^\\star \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} [w^\\star(a) - \\hat w(a)] \\lesssim \\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}.\n\\end{aligned}')
('8.3', '\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w^\\star(a)] = 1')
('8.3', '\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} [\\hat w(a)] = 1')
('8.3', '\\hat \\pi(a) = \\hat w(a) \\mu(a)/\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu}[w(a)] = \\hat w(a)')
('8.3', '\\epsilon_{\\text{stat}, \\alpha}^{\\text{MAB}}')
('8.3', '\\alpha =0')
('8.3', '\\begin{aligned}\n    J(\\pi^\\star) - J(\\hat \\pi) & = \\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu} [r(a) (w^\\star(a) - \\hat w(a))] \\lesssim B_w(B_v + 1) \\sqrt{\\frac{\\log |\\mathcal{V}||\\mathcal{W}|/\\delta}{N}},\n\\end{aligned}')
('8.3', 'B_w \\asymp B_w + 1')
('8.3', 'B_w \\geq 1')
('8.3', 'w^\\star')
('9', '1/\\sqrt{N}')
('9.0', 'w(s,a) = d(s,a)/\\mu(s,a)')
('9.0', '\\begin{aligned}\n\\label{eq:population-objective-CB}\n    & \\max_{w \\geq 0} \\min_{v}  L_\\alpha^{\\text{CB}}(w, v) \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[ w(s,a)r(s,a) \\right]  - \\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim \\mu}[v(s) (w(s,a) - 1)] - \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim \\mu} \\left[ f\\left(w(s,a)\\right) \\right],\n\\end{aligned}')
('9.0', 'w^\\star_\\alpha, v^\\star_\\alpha')
('9.0', 'w, v')
('9.0', '\\mathcal{W}, \\mathcal{V}')
('9.0', '\\mathcal{D}= \\{(s_i, a_i, r_i)\\}_{i=1}^N')
('9.0', '\\mathcal{W}, \\mathcal{V}')
('9.0', 'f(\\cdot)')
('9.0', '\\alpha')
('9.0', '\\hat w, \\hat v')
('9.0', '\\begin{aligned}\n    \\begin{split}\\label{eq:PRO-CB-empirical-objective}\n        \\max_{w \\in \\mathcal{W}} \\min_{v \\in \\mathcal{V}} \\hat L_\\alpha^{\\text{CB}}(w, v) \\coloneqq \\frac{1}{N}\\sum_{i=1}^N w(s_i, a_i) r_i - \\alpha f(w(s_i, a_i)) - v(s_i) (w(s_i, a_i) - 1). \n    \\end{split}\n\\end{aligned}')
('9.0', '\\hat \\pi = \\pi_{\\hat w}')
('9.1', '\\alpha \\geq N^{\\beta}')
('9.1', '\\beta > -1/2')
('9.1', '\\alpha \\leq \\widetilde{O}( N^{-1/2})')
('9.1', '\\alpha')
('9.1', '\\alpha')
('9.1', '\\alpha')
('9.1', '\\alpha')
('9.1', '\\rho(s)')
('9.1.0', '-\\frac{1}{2}<\\beta')
('9.1.0', '\\alpha\\ge N^\\beta')
('9.1.0', '\\alpha')
('9.1.0', '\\begin{aligned}\n        r(1) = 1 \\quad \\text{w.p. }1,\\quad r(2) = \\max\\{0,1-\\alpha\\} \\quad \\text{w.p. }1.\n    \n\\end{aligned}')
('9.1.0', 'C^\\star')
('9.1.0', 'M_f<100')
('9.1.0', 'M_f')
('9.1.0', '\\begin{aligned}\n        \\mu(1)=\\frac{M_f}{100},\\quad\\mu(2)=1-\\frac{M_f}{100}.\n    \n\\end{aligned}')
('9.1.0', '\\mathcal{W}')
('9.1.0', '\\mathcal{V}')
('9.1.0', '(w^\\star_\\alpha, v^\\star_\\alpha)')
('9.1.0', '(w^\\star, v^\\star)')
('9.1.0', '\\begin{aligned}\n        \\mathcal{W}=\\{w_\\alpha^\\star,w^\\star\\},\\quad\\mathcal{V}=\\{v_\\alpha^\\star,v^\\star\\}.\n    \n\\end{aligned}')
('9.1.0', '\\pi^\\star_\\alpha \\coloneqq \\pi_{w^\\star_\\alpha}')
('9.1.0', '\\min \\{1, \\alpha\\}')
('9.1.0', 'w^\\star_\\alpha')
('9.1.0.0', '\\pi^\\star_\\alpha')
('9.1.0.0', '\\begin{aligned}\n    J(\\pi^\\star)-J(\\pi_\\alpha^\\star)=\\pi_\\alpha^\\star(2)\\cdot(r(1)-r(2))\n    =\\mu(2) w_\\alpha^\\star(2) \\cdot \\min\\{1,\\alpha\\} = \\Omega( \\min \\{1, \\alpha\\}).\\label{eq:tmp-suboptimality}\n\\end{aligned}')
('9.1.0.0', 'w_\\alpha^\\star(2)> c')
('9.1.0.0', 'c=\\frac{1}{2}')
('9.1.0.0', '\\begin{aligned}\n    w_\\alpha^\\star(2)\\le c \\label{eq:assump-prop3}.\n\\end{aligned}')
('9.1.0.0', "\\begin{aligned}\n    w_\\alpha^\\star(2) & = \\max \\left\\{0, (f')^{-1}\\left(\\frac{r(2)-v_\\alpha^\\star}{\\alpha}\\right)\\right\\} \\ge (f')^{-1}\\left(\\frac{r(2)-v_\\alpha^\\star}{\\alpha}\\right).\n\\end{aligned}")
('9.1.0.0', "f'")
('9.1.0.0', 'f')
('9.1.0.0', 'v^\\star_\\alpha')
('9.1.0.0', "\\begin{aligned}\n    v_\\alpha^\\star\\ge r(2)-\\alpha f'(w_\\alpha^\\star(2))\\ge\n    r(1)-(r(1)-r(2))-\\alpha f'\\left(c\\right).\n\\end{aligned}")
('9.1.0.0', 'v_\\alpha^\\star')
('9.1.0.0', 'w_\\alpha^\\star(1)')
('9.1.0.0', "\\begin{aligned}\n    w_\\alpha^\\star(1)=&(f')^{-1}\\left(\\frac{r(1)-v_\\alpha^\\star}{\\alpha}\\right)\n    \\le (f')^{-1}\\left(\\frac{r(1)-r(2)}{\\alpha}+f'\\left(c\\right)\\right).\n    \\label{eq:tmp2-prop3}\n\\end{aligned}")
('9.1.0.0', 'v^\\star_\\alpha \\geq r^\\star = r(1)')
('9.1.0.0', 'f(0) = 0')
('9.1.0.0', "(f')^{-1}((r(1) - v^\\star_\\alpha) /\\alpha) \\geq 0")
('9.1.0.0', 'f')
('9.1.0.0', 'M_f')
('9.1.0.0', "\\begin{aligned}\n    &f'\\left(\\frac{1-c\\mu(2)}{\\mu(1)}\\right)-f'\\left(c\\right)\n    \\ge M_f\\left(\\frac{1-c\\mu(2)}{\\mu(1)}-c\\right)\n    =M_f\\frac{1-c}{\\mu(1)}=100(1-c)>1,\\nonumber\\\\\n    \\Rightarrow\\ & \n    \\frac{r(1)-r(2)}{\\alpha}+f'\\left(c\\right)\\le\n    1+f'\\left(c\\right)< f'\\left(\\frac{1-c\\mu(2)}{\\mu(1)}\\right).\\label{ineq:key}\n\\end{aligned}")
('9.1.0.0', "\\begin{aligned}\n    w_\\alpha^\\star(1)\\le (f')^{-1}\\left(\\frac{r(1)-r(2)}{\\alpha}+f'\\left(c\\right)\\right)\n    \\underbrace{<}_{\\text{by \\eqref{ineq:key}}}(f')^{-1}\\left(f'\\left(\\frac{1-c\\mu(2)}{\\mu(1)}\\right)\\right)=\\frac{1-c\\mu(2)}{\\mu(1)},\n\\end{aligned}")
('9.1.0.0', '\\begin{aligned}\n    w_\\alpha^\\star(1)\\mu(1)< 1-c\\mu(2)\n    \\underbrace{\\le}_{\\text{ by \\eqref{eq:assump-prop3}}} 1-w_\\alpha^\\star(2)\\mu(2)\\ \\Rightarrow\\ \n    \\sum_a w_\\alpha^\\star(a)\\mu(a)<1.\\label{eq:prop3-case1}\n\\end{aligned}')
('9.1.0.0', '(w_\\alpha^\\star,v_\\alpha^\\star)')
('9.1.0.0', 'L_\\alpha^{\\text{MAB}}')
('9.1.0.0', '\\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[w(a)]=1')
('9.1.0.0', '\\begin{aligned}\n    J(\\pi^\\star)-J(\\pi_\\alpha^\\star)=\\mu(2) w_\\alpha^\\star(2) \\cdot (r(1)-r(2)) >c\\left(1-\\frac{M_f}{100}\\right) \\min\\{1,\\alpha\\} \\gtrsim \\min\\{1,\\alpha\\}\n    \\label{eq-sub-gap}\n\\end{aligned}')
('9.1.0.1', 'w_\\alpha^\\star')
('9.1.0.1', 'w_\\alpha^\\star')
('9.1.0.1', 'w^\\star')
('9.1.0.1', '\\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[w]-1=0')
('9.1.0.1', 'L_\\alpha^{\\text{MAB}}(w_\\alpha^\\star,v)')
('9.1.0.1', 'L_\\alpha^{\\text{MAB}}(w_\\alpha,v)')
('9.1.0.1', 'v')
('9.1.0.1', 'L_\\alpha^{\\text{MAB}}(w_\\alpha^\\star,v)-L_\\alpha^{\\text{MAB}}(w^\\star,v) \\gtrsim \\alpha')
('9.1.0.1', 'L_{\\alpha}^{\\text{MAB}}')
('9.1.0.1', "\\begin{aligned}\n    &L_\\alpha^{\\text{MAB}}(w_\\alpha^\\star,\\cdot)-L_\\alpha^{\\text{MAB}}(w^\\star,\\cdot )\\nonumber\\\\\n    =& \\alpha \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[f(w^\\star(a))-f(w_\\alpha^\\star(a))]-\\mu(2) w_\\alpha^\\star(2) (r(1)-r(2))\\nonumber\\\\\n    =& \\alpha\\Bigg(\n    \\mu(1)\\Big(f(w^\\star(1))-f(w_\\alpha^\\star(1))\\Big)+\\mu(2)\\Big(f(w^\\star(2))-f(w_\\alpha^\\star(2))\\Big)\n    \\Bigg)-\\mu(2) w_\\alpha^\\star(2) (r(1)-r(2))\n    \\nonumber\\\\\n    \\ge&\\alpha\\left(\n    \\mu(1)\\Big(w^\\star(1)-w_\\alpha^\\star(1)\\Big)\\cdot f'(w_\\alpha^\\star(1))\n    -\\mu(2)f(w_\\alpha^\\star(2))\n    \\right)-\\mu(2) w_\\alpha^\\star(2) (r(1)-r(2))\\label{tmpeq:cvx}\\\\\n    =&\\alpha\\mu(2)\\left(\n    f'(w_\\alpha^\\star(1))\\cdot w_\\alpha^\\star(2)\n    -f(w_\\alpha^\\star(2))-w_\\alpha^\\star(2)\\cdot\\frac{r(1)-r(2)}{\\alpha}\n    \\right),\\label{tmpeq3}\n\\end{aligned}")
('9.1.0.1', 'f')
('9.1.0.1', 'f(w^\\star(2)) = f(0) = 0')
('9.1.0.1', '\\begin{aligned}\n    \\mu(1)\\left(w^\\star(1)-w_\\alpha^\\star(1)\\right)=\n\\mu(1)\\left(\\frac{1}{\\mu(1)}-w_\\alpha^\\star(1)\\right)\n=1-\\mu(1)w_\\alpha^\\star(1)=\\mu(2)w_\\alpha^\\star(2).\n\\end{aligned}')
('9.1.0.1', "\\begin{aligned}\n    f'(w_\\alpha^\\star(1))=\\frac{r(1)-v_\\alpha^\\star}{\\alpha}\n    =\\frac{r(1)-r(2)+\\alpha f'(w_\\alpha^\\star(2))}{\\alpha}=\\frac{r(1)-r(2)}{\\alpha}+f'(w_\\alpha^\\star(2)).\\label{tmpeq2}\n\\end{aligned}")
('9.1.0.1', "\\begin{aligned}\n    L_\\alpha^{\\text{MAB}}(w_\\alpha^\\star,\\cdot)-L_\\alpha^{\\text{MAB}}(w^\\star,\\cdot)\\ge&\\alpha\\mu(2)\\Big(\n    f'(w_\\alpha^\\star(2))\\cdot w_\\alpha^\\star(2)\n    -f(w_\\alpha^\\star(2))\n    \\Big)\\nonumber\\\\\n    \\ge&\\alpha\\mu(2)\\cdot\\frac{M_f}{2}w_\\alpha^\\star(2)^2 >\\alpha\\mu(2)\\cdot\\frac{M_f}{2} c^2 \\gtrsim \\alpha,\\label{tmpeq4}\n\\end{aligned}")
('9.1.0.1', 'f')
('9.1.0.1', 'M_f')
('9.1.0.1', 'w_\\alpha^\\star(2)>c')
('9.1.0.1', 'w^\\star_\\alpha')
('9.1.0.1', '\\delta = 0.1')
('9.1.0.1', 'v \\in \\mathcal{V}, w \\in \\mathcal{W}')
('9.1.0.1', '\\begin{aligned}\n    \\left| L_{\\alpha}^{\\text{MAB}}(w,v) - \\hat L_{\\alpha}^{\\text{MAB}}(w,v) \\right| \\lesssim 2 \\epsilon_{\\text{stat},\\alpha}^{\\text{MAB}}, \n\\end{aligned}')
('9.1.0.1', '\\epsilon_{\\text{stat},\\alpha}^{\\text{MAB}}')
('9.1.0.1', '1/\\sqrt{N}')
('9.1.0.1', "v,v'\\in\\mathcal{V}")
('9.1.0.1', "\\begin{aligned}\n    & \\hat{L}_\\alpha^{\\text{MAB}}(w_\\alpha^\\star,v)-\\hat{L}_\\alpha^{\\text{MAB}}(w^\\star,v')\\\\\n    & \\gtrsim \\alpha - \\epsilon_{\\text{stat},\\alpha}^{\\text{MAB}} \\gtrsim\n    \\alpha-(1+\\alpha)N^{-\\frac{1}{2}}\\gtrsim N^\\beta-N^{-\\frac{1}{2}}.\n\\end{aligned}")
('9.1.0.1', '\\beta > -1/2')
('9.1.0.1', 'w^\\star_\\alpha')
('9.1.0.1', '\\begin{aligned}\n    \\min_{v\\in\\mathcal{V}}\\hat{L}_\\alpha^{\\text{MAB}}(w_\\alpha^\\star,v)-\\min_{v\\in\\mathcal{V}}\\hat{L}_\\alpha^{\\text{MAB}}(w^\\star,v)>0\\ \\Rightarrow\\ \n    w_\\alpha^\\star=\\mathop{\\mathrm{arg\\,max}}_{w\\in\\mathcal{W}}\\min_{v\\in\\mathcal{V}}\\hat{L}_\\alpha^{\\text{MAB}}(w,v).\n\\end{aligned}')
('9.1.0.1', '\\pi_\\alpha^\\star')
('9.1.0.1', '\\alpha \\geq N^\\beta')
('9.1.1', '\\alpha\\le \\widetilde{O}( N^{-\\frac{1}{2}})')
('9.1.1', '\\widetilde{O}')
('9.1.1', '\\begin{aligned}\n        &\\rho(1)=N^{-\\frac{1}{4}},\\quad r(1,1)\\sim\\text{Bernoulli} \\left(\\frac{1}{2} \\right),\\ r(1,2)\\equiv\\frac{1}{3};\\\\\n        &\\rho(2)=1-N^{-\\frac{1}{4}},\\quad r(2,1)\\equiv\\frac{1}{2},\\  r(2,2)\\equiv\\frac{1}{3}.\n    \n\\end{aligned}')
('9.1.1', '\\begin{aligned}\n        &\\mu(s)=\\rho(s),\\ s=1,2.\\\\\n        &\\mu(1|1)=\\mu(1|2)=1-\\frac{2}{N},\\quad \\mu(2|1)=\\mu(2|2)=\\frac{2}{N}.\n    \n\\end{aligned}')
('9.1.1', 'w')
('9.1.1', '\\tilde w(2,a)=w_\\alpha^\\star(2,a)')
('9.1.1', '\\tilde w(1,a)=0')
('9.1.1', 'a=1,2')
('9.1.1', '\\mathcal{W}')
('9.1.1', '\\mathcal{V}')
('9.1.1', '\\begin{aligned}\n\\label{eq:W-V-class-constructions}\n        \\mathcal{W}=\\{w_\\alpha^\\star,\\tilde w\\},\\ \\mathcal{V}=\\{v_\\alpha^\\star,v^\\star\\}.\n    \n\\end{aligned}')
('9.1.1', '\\alpha\\le\\widetilde{O}( N^{-\\frac{1}{2}})')
('9.1.1', 'N')
('9.1.1', 'w_\\alpha^\\star=w^\\star')
('9.1.1', '\\mathcal{W}')
('9.1.1', 'w^\\star_\\alpha = w^\\star \\in \\mathcal{W}')
('9.1.1', 'v^\\star_\\alpha = \\mathop{\\mathrm{arg\\,min}}_{v \\in \\mathcal{V}} \\hat L^{\\text{CB}}_\\alpha (\\tilde w,v)')
('9.1.1', '\\hat L_\\alpha^{\\text{CB}}(w,v)')
('9.1.1', '\\tilde w')
('9.1.1', 'w^\\star_\\alpha')
('9.1.1', '\\tilde w')
('9.1.1', '\\pi_{\\tilde w}')
('9.1.1', 'N^{-1/4}')
('9.1.1.0', "\\begin{aligned}\n    &v_\\alpha^\\star(s)=r^\\star(s)-c(s)\\alpha,\\text{ and }\\\\\n    &w_\\alpha^\\star(s,a)=\\max\\left\\{0,(f')^{-1}\\left(\\frac{r(s,a)-v_\\alpha^\\star(s)}{\\alpha}\\right)\\right\\}=\\max\\left\\{0,(f')^{-1}\\left(c(s)-\\frac{r^\\star(s)-r(s,a)}{\\alpha}\\right)\\right\\},\n\\end{aligned}")
('9.1.1.0', "0\\le c(s)\\le f'(C^\\star)")
('9.1.1.0', 's\\in\\{1,2\\}')
('9.1.1.0', 'r^\\star(s)-r(s,2)=\\frac{1}{6}=\\Theta(1)')
('9.1.1.0', "N\\ge (6f'(C^\\star))^2")
('9.1.1.0', 'w_\\alpha^\\star(s,2)=0')
('9.1.1.0', '2')
('9.1.1.0', 'w_\\alpha^\\star(s)=w^\\star(s)=\\frac{1}{\\mu(1|s)}')
('9.1.1.0', "v_\\alpha^\\star(s)=r^\\star(s)-\\alpha f'\\left(\\frac{1}{\\mu(1|s)}\\right)")
('9.1.1.1', '\\hat{\\mu}')
('9.1.1.1', '\\hat{r}')
('9.1.1.1', '\\begin{aligned}\n\\label{eq:event-def}\n   \\mathcal{E}\\coloneqq \\left \\{ \\sum_a \\hat{\\mu}(a|s) \\tilde w(s,a)\\le 1 \\; \\text{ for } \\; s\\in\\{1,2\\} \\right\\}.\n\\end{aligned}')
('9.1.1.1', '\\tilde w(1,a) = 0')
('9.1.1.1', '\\tilde w(2,a) = w^\\star(2,a)')
('9.1.1.1', '\\begin{aligned}\n\\label{tmpeq:equiv1}\n    \\sum_a \\hat \\mu(a|2) w^\\star_\\alpha(2, a) \\leq 1 \\iff \\sum_a \\left(\\hat \\mu(a|2) - \\mu(a|2)\\right)w^\\star_\\alpha(2, a) \\leq 0.\n\\end{aligned}')
('9.1.1.1', '\\sum_a \\mu(a|2) w^\\star_\\alpha(s,2)=1')
('9.1.1.1', 'w^\\star_\\alpha = w^\\star')
('9.1.1.1', 'w^\\star_\\alpha(2,2) = 0')
('9.1.1.1', '\\begin{aligned}\n\\label{tmpeq:equiv-form-final}\n    \\mathcal{E}= \\left \\{ \\hat \\mu(1|2) - \\mu (1|2) \\leq 0 \\right\\}.\n\\end{aligned}')
('9.1.1.1', '\\hat{\\mu}(1|2)')
('9.1.1.1', '\\mu(1|2)')
('9.1.1.1', '\\mathcal{E}')
('9.1.1.1', '\\frac{1}{2}')
('9.1.1.1', '\\mathcal{E}')
('9.1.1.1', 'v_\\alpha^\\star(s) \\le r^\\star(s)= v^\\star(s)')
('9.1.1.1', '\\begin{aligned}\n    \\hat L_\\alpha^{\\text{CB}}(\\tilde w, v^\\star_\\alpha)\\le \\hat L_\\alpha^{\\text{CB}}(\\tilde w, v^\\star)\\ \\Rightarrow\\ \n    \\hat L_\\alpha^{\\text{CB}}(\\tilde w, v^\\star_\\alpha)=\\min_{v\\in\\mathcal{V}}\\hat L_\\alpha^{\\text{CB}}(\\tilde w, v).\\label{eq:argmin=v-alpha}\n\\end{aligned}')
('9.1.1.2', '\\hat L_\\alpha^{\\text{CB}}(\\cdot,v_\\alpha^\\star)')
('9.1.1.2', '\\tilde w')
('9.1.1.2', 'w^\\star_\\alpha')
('9.1.1.2', '\\tilde w(2, a) = w^\\star_\\alpha(2,a)')
('9.1.1.2', '\\begin{aligned}\n    &\\hat L_\\alpha^{\\text{CB}}(w_\\alpha^\\star, v^\\star_\\alpha) - \\hat L_\\alpha^{\\text{CB}}(\\tilde w, v^\\star_\\alpha)\\nonumber\\\\\n    = & \\hat{\\mu}(1) \\Bigg[\\hat{r}(1,1) \\hat{\\mu}(1|1)  w_\\alpha^\\star(1,1) \n    + \\alpha \n     \\hat \\mu(1|1) f(w_\\alpha^\\star(1,1))\n     + v_\\alpha^\\star(1) \\left(\\sum_{a} \\hat\\mu(a|1) \\left( w(1,a)-w_\\alpha^\\star(1,a)\\right)\\right) \\Bigg]\\nonumber\n\\end{aligned}')
('9.1.1.2', "v_\\alpha^\\star(1)=r(1,1)-\\alpha f'\\left(w_\\alpha^\\star(s_1,a_1)\\right)")
('9.1.1.2', '\\tilde w(1, a) = 0')
('9.1.1.2', 'w_\\alpha^\\star(1,1)=w^\\star(1,1)=\\frac{1}{\\mu(1|1)}')
('9.1.1.2', "\\begin{aligned}\n    &\\hat L_\\alpha^{\\text{CB}}(w_\\alpha^\\star, v^\\star_\\alpha) - \\hat L_\\alpha^{\\text{CB}}(\\tilde w, v^\\star_\\alpha)\\nonumber \\\\\n    = & \\hat{\\mu}(1) \\Bigg[\\left(\\hat{r}(1,1)-r(1,1)+\\alpha f'\\left(\\frac{1}{\\mu(1|1)}\\right)\\right)\n     \\frac{\\hat\\mu(1|1)}{\\mu(1|1)}   \n     + \\alpha \n     \\hat \\mu(1|1) f\\left(\\frac{1}{\\mu(1|1)}\\right)\n     \\Bigg]\\label{eq-exp-1}\\\\\n     = & \\hat{\\mu}(1,1) \\Bigg[\n     \\frac{\\hat{r}(1,1)-r(1,1)}{\\mu(1|1)}\n     +\\alpha\\cdot\n     \\left( \\frac{1}{\\mu(1|1)} f'\\left(\\frac{1}{\\mu(1|1)}\\right)\n     +f\\left(\\frac{1}{\\mu(1|1)}\\right)\n     \\right)\n     \\Bigg].\n     \\label{eq:case2-prop3}\n\\end{aligned}")
('9.1.1.2', '\\begin{aligned}\n    \\frac{\\hat{r}(1,1)-r(1,1)}{\\mu(1|1)} \\lesssim - N^{-3/8}.\\label{eq:cond-case2-prop3}\n\\end{aligned}')
('9.1.1.2', '\\begin{aligned}\n    \\min_{v\\in\\mathcal{V}}\\hat L_\\alpha^{\\text{CB}}(\\tilde w, v)= \\hat L_\\alpha^{\\text{CB}}(\\tilde w, v^\\star_\\alpha) > \\hat L_\\alpha^{\\text{CB}}( w_\\alpha^\\star, v^\\star_\\alpha)\n    \\ge\\min_{v\\in\\mathcal{V}}\\hat L_\\alpha^{\\text{CB}}( w_\\alpha^\\star, v),\n\\end{aligned}')
('9.1.1.2', '\\tilde w')
('9.1.1.3', '\\pi_w')
('9.1.1.3', 'w')
('9.1.1.3', '\\begin{aligned}\n    J(\\pi^\\star_\\alpha)-J(\\pi_w)=\\mu(s_1)\\pi_w(2|1) (r(1,1)-r(1,2))=\\frac{N^{-\\frac{1}{4}}}{12}\\ge \\Omega(N^\\beta),\n\\end{aligned}')
('9.1.1.3', '\\beta=-\\frac14>-\\frac12')
('9.1.1.3', '\\alpha')
('9.1.1.3', "\\mathcal{E}'")
('9.1.1.3', "\\begin{aligned}\n    \\mathcal{E}'\\coloneqq\\left\\{N(1,1)\\ge 0.1 N \\mu(1,1)\\ge 0.05 N^{\\frac{3}{4}}\\right\\}.\n\\end{aligned}")
('9.1.1.3', '\\mathcal{E}')
('9.1.1.3', "\\mathcal{E}'")
('9.1.1.3', '\\hat{r}(s_1,a_1)')
('9.1.1.3', 's_2')
('9.1.1.3', "\\mathcal{E}\\cap\\mathcal{E}'")
('9.1.1.3', '0.5\\times0.5=0.25')
('9.1.1.3', "\\begin{aligned}\n    \\Pr\\left.\\left(\\hat r(1,1) - r(1,1) \\leq - \\sqrt{\\frac{\\log(2c_1)}{c_2 N(1,1) }} \\le - c' N^{-\\frac{3}{8}}\\right|\\mathcal{E}\\cap\\mathcal{E}'\\right) \\geq 0.5,\n\\end{aligned}")
('9.1.1.3', "c'=\\sqrt{\\frac{20\\log(2c_1)}{c_2 }}")
('9.1.1.3', 'X_1,\\cdots, X_n')
('9.1.1.3', '\\frac{1}{2}')
('9.1.1.3', '\\overline{X}=\\frac{1}{n}\\sum_{i=1}^n X_i')
('9.1.1.3', 't\\in[0,\\frac{1}{8}]')
('9.1.1.3', 'c_1,c_2')
('9.1.1.3', '\\begin{aligned}\n        \\Pr\\left(\\overline{X}\\le\\mathop{\\mathrm{\\mathbb{E}}}[\\overline{X}]-t\\right)\\ge c_1 e^{-c_2 t^2n}.\n    \n\\end{aligned}')
('9.2', 'w^\\star')
('9.2', '\\hat w')
('9.2', '\\delta > 0')
('9.2', '\\begin{aligned}\n\\label{eq:statistical-error-CB}\n    \\epsilon_{\\text{stat}}^{\\text{CB}} \\coloneqq 3(B_w + 1)^2 (B_v+1) \\sqrt{\\frac{\\log (|\\mathcal{W}||\\mathcal{V}|/\\delta)}{N}}.\n\\end{aligned}')
('9.2', 'w \\in \\mathcal{W}')
('9.2', 'v \\in \\mathcal{V}')
('9.2', '1-\\delta')
('9.2', '\\left|L_{\\text{AL}}^{\\text{CB}}(w,v) - \\hat L_{\\text{AL}}^{\\text{CB}}(w,v) \\right| \\leq \\epsilon_{\\text{stat}}^{\\text{CB}}')
('9.2', 'L_{\\text{AL}}^{\\text{CB}}(w^\\star,v) - L_{\\text{AL}}^{\\text{CB}}(\\hat w,v) \\leq 2\\epsilon_{\\text{stat}}^{\\text{CB}}')
('9.2', '\\frac{d_{\\hat w}}{\\mu}(s) \\coloneqq \\sum_a \\hat w(s,a) \\mu(a|s)')
('9.2', '\\begin{aligned}\n\\label{eq:Ss-def}\n    \\mathcal{S}_s \\coloneqq \\left\\{ s \\ \\middle| \\  \\frac{d_{\\hat w}}{\\mu}(s) \\leq \\frac{1}{2} \\right\\}.\n\\end{aligned}')
('9.2', '\\delta > 0')
('9.2', '1-\\delta')
('9.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim \\mu} \\left[ (r^\\star(s) - r(s,a)) \\hat w(s,a)\\right] \\lesssim \\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', '\\sum_{s \\in \\mathcal{S}_s} \\mu(s) \\lesssim \\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', '\\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', '\\mathcal{S}_{s}')
('9.2', '\\begin{aligned}\n\\notag\n    \\sum_s \\mu(s) V^\\star(s) - \\sum_s \\mu(s) V^{\\hat \\pi}(s)\n    & = \\sum_{s \\in \\mathcal{S}_{\\text{s}}} \\mu(s) (V^\\star(s) - V^{\\hat \\pi}(s)) + \\sum_{s \\not \\in \\mathcal{S}_{\\text{s}} } \\mu(s) (V^\\star(s) - V^{\\hat \\pi}(s)),\\\\ \\label{eq:partition-bound-CB} \n    & \\lesssim \\epsilon_{\\text{stat}}^{\\text{CB}} + \\sum_{s \\not \\in \\mathcal{S}_{\\text{s}} } \\mu(s) (V^\\star(s) - V^{\\hat \\pi}(s))\\\\ \\label{eq:bound-dhatw-inSl-CB}\n    & \\leq \\epsilon_{\\text{stat}}^{\\text{CB}} + 2 \\sum_s {d_{\\hat w}(s)} (V^\\star(s) - V^{\\hat \\pi}(s))\n\\end{aligned}')
('9.2', 's \\not \\in \\mathcal{S}_{\\text{s}}')
('9.2', '\\mu(s) < 2\\hat d(s)')
('9.2', 'V^\\star(s) - V^{\\hat \\pi}(s) \\geq 0')
('9.2', '\\begin{aligned}\n    \\sum_s d_{\\hat w}(s) (V^\\star(s) - V^{\\hat \\pi}(s)) & = \\sum_{s: d_{\\hat w}(s) > 0} d_{\\hat w}(s) \\left(r^\\star(s) - \\sum_a \\hat \\pi(a|s) r(s,a) \\right)\\\\\n    & = \\sum_{s: d_{\\hat w}(s) > 0} \\sum_a d_{\\hat w}(s,a) r^\\star(s) - d_{\\hat w}(s) \\frac{\\hat w(s,a)\\mu(s,a)}{d_{\\hat w}(s)} r(s,a)\\\\\n    & = \\sum_{s: d_{\\hat w}(s) > 0} \\sum_a {\\hat w}(s,a)\\mu(s,a) r^\\star(s) - \\hat w(s,a) \\mu(s,a) r(s,a)\\\\\n    & \\leq \\sum_{s,a} \\mu(s,a) {\\hat w}(s,a) (r^\\star(s) - r(s,a)) \\lesssim \\epsilon^{\\text{CB}}_{\\text{stat}},\n\\end{aligned}')
('9.2', '\\hat \\pi')
('9.2', '(B_w +1)^2 \\asymp B_w^2')
('9.2', 'B_w \\geq 1')
('9.2', 'w^\\star(s,a^\\star) \\geq 1')
('9.2', '\\mathop{\\mathrm{\\mathbb{E}}}_\\mu \\left[\\hat L^{\\text{CB}}_{\\text{AL}}(w, v)\\right] = L^{\\text{CB}}_{\\text{AL}}(w, v)')
('9.2', '\\hat L^{\\text{CB}}_{\\text{AL}}(w, v)')
('9.2', '\\begin{aligned}\n    & \\left|w(s,a) r(s,a) - v(s) (w(s,a) - 1) - \\left( \\sum_a w(s,a) \\mu(a|s) - 1\\right)^2 \\right|\\\\\n    & \\quad \\leq B_w + B_v(B_w+1) + B_w^2\\\\\n    & \\quad \\leq 3(B_w+1)^2 (B_v+1)\n\\end{aligned}')
('9.2', 'w \\in \\mathcal{W}')
('9.2', 'v \\in \\mathcal{V}')
('9.2', '\\begin{aligned}\n\\max_{w \\geq 0} \\min_{v}  L^{\\text{CB}}(w, v) \n    &  \\;\\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim \\mu} \\left[ w(s,a)r(s,a) \\right] \n    - \\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim \\mu}[v(s) (w(s,a) - 1)],\n\\end{aligned}')
('9.2', '(w^\\star, v^\\star) \\in \\mathop{\\mathrm{arg\\,max}}_{w \\geq 0} \\mathop{\\mathrm{arg\\,min}}_{v} L^{\\text{CB}}(w,v)')
('9.2', 'w^\\star')
('9.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu(\\cdot|s)}[w^\\star(s,a)] = 1')
('9.2', 's')
('9.2', '(w^\\star, v^\\star) \\in \\mathop{\\mathrm{arg\\,max}}_{w \\geq 0} \\mathop{\\mathrm{arg\\,min}}_{v} L^{\\text{CB}}_{\\text{AL}}(w,v)')
('9.2', 'L^{\\text{CB}}_{\\text{AL}}(w^\\star, v) -  L^{\\text{CB}}_{\\text{AL}}(\\hat w, v)')
('9.2', '\\begin{aligned}\n    & L^{\\text{CB}}_{\\text{AL}}(w^\\star, v) -  L^{\\text{CB}}_{\\text{AL}}(\\hat w, v)\\\\\n    & \\quad = \\underbrace{L^{\\text{CB}}_{\\text{AL}}(w^\\star, v) - L^{\\text{CB}}_{\\text{AL}}(w^\\star, \\hat v(w^\\star))}_{\\coloneqq T_1} + \\underbrace{L^{\\text{CB}}_{\\text{AL}}(w^\\star, \\hat v(w^\\star)) - \\hat L^{\\text{CB}}_{\\text{AL}}(w^\\star, \\hat v(w^\\star))}_{\\coloneqq T_2}\\\\\n    & \\qquad+ \\underbrace{\\hat L^{\\text{CB}}_{\\text{AL}}(w^\\star, \\hat v(w^\\star)) - \\hat L^{\\text{CB}}_{\\text{AL}}(\\hat w, \\hat v)}_{\\coloneqq T_3} + \\underbrace{\\hat L^{\\text{CB}}_{\\text{AL}}(\\hat w, \\hat v) - \\hat L^{\\text{CB}}_{\\text{AL}}(\\hat w, v)}_{\\coloneqq T_4}\\\\\n    & \\qquad + \\underbrace{\\hat L^{\\text{CB}}_{\\text{AL}}(\\hat w, v) - L^{\\text{CB}}_{\\text{AL}}(\\hat w, v)}_{\\coloneqq T_5},\n\\end{aligned}')
('9.2', '\\hat v_w = \\arg \\min_{v \\in \\mathcal{V}} \\hat L^{\\text{CB}}_{\\text{AL}}(w, v).')
('9.2', 'T_1 = 0')
('9.2', 'w^\\star')
('9.2', 'T_2 \\leq \\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', 'T_3 \\leq 0')
('9.2', '\\hat w = \\arg \\max_{w \\in \\mathcal{W}} \\hat  L^{\\text{CB}}_{\\text{AL}}(\\hat v_w, w)')
('9.2', 'T_4 \\leq 0')
('9.2', '\\hat v = \\arg \\min_{v \\in \\mathcal{V}} \\hat L^{\\text{CB}}_{\\text{AL}}(v, \\hat w)')
('9.2', 'T_5 \\leq \\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', 'w^\\star')
('9.2', '\\hat w')
('9.2', '\\hat w')
('9.2', 'w^\\star')
('9.2', 'w^\\star')
('9.2', '\\begin{aligned}\n    L^{\\text{CB}}_{\\text{AL}}(w^\\star,v)\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu}[r(s,a) w^\\star(s,a)] + \\underbrace{\\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu}[v(s) (1-w^\\star(s,a))]}_{=0} - \\underbrace{  \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\mu} [(\\mathop{\\mathrm{\\mathbb{E}}}_{a \\sim \\mu(\\cdot|s)}[w(s,a)] - 1)^2]}_{=0}\\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu}[r(s,a) w^\\star(s,a)].\n\\end{aligned}')
('9.2', 'v(s) = r^\\star(s) \\coloneqq \\max_a r(s,a)')
('9.2', '\\begin{aligned}\n    & L^{\\text{CB}}_{\\text{AL}}(w^\\star, r^\\star) -  L^{\\text{CB}}_{\\text{AL}}(\\hat w, r^\\star)\\\\\n    = & \\sum_{s} \\mu(s) r^\\star(s) - \\sum_{s,a} \\mu(s,a) r(s,a) \\hat w(s,a) - \\sum_s r^\\star(s) \\left(\\mu(s) - \\sum_a \\mu(s,a) \\hat w(s,a)\\right) \\\\\n    & \\quad +   \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\mu}\\left[\\left(\\frac{d_{\\hat w}}{\\mu}(s) -1\n\\right)^2\\right]\\\\\n    = & \\sum_{s,a} \\mu(s,a) [r^\\star(s) - r(s,a)] \\hat w(s,a) +   \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\mu}\\left[\\left(\\frac{d_{\\hat w}}{\\mu}(s) -1\n\\right)^2\\right].\n\\end{aligned}')
('9.2', 'L^{\\text{CB}}_{\\text{AL}}(w^\\star, v) -  L^{\\text{CB}}_{\\text{AL}}(\\hat w, v) \\lesssim \\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', '\\begin{aligned}\n    \\sum_{s,a} \\mu(s,a) [r^\\star(s) - r(s,a)] \\hat w(s,a) +   \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\mu}\\left[\\left(\\frac{d_{\\hat w}}{\\mu}(s) -1\n\\right)^2\\right] \\lesssim \\epsilon^{\\text{CB}}_{\\text{stat}} \n\\end{aligned}')
('9.2', '\\hat w(s,a) \\geq 0')
('9.2', 'r^\\star(s) - r(s,a) \\geq 0')
('9.2', '\\epsilon^{\\text{CB}}_{\\text{stat}}')
('9.2', '\\mathcal{S}_{\\text{s}}')
('9.2', '\\begin{aligned}\n    \\epsilon^{\\text{CB}}_{\\text{stat}} \\gtrsim \\sum_s \\mu(s) \\left[\\left(\\frac{d_{\\hat w}}{\\mu}(s) - 1\\right)^2\\right]\n     \\geq \\sum_{s \\in \\mathcal{S}_{\\text{s}}} \\mu(s) \\left[\\left(\\frac{d_{\\hat w}}{\\mu}(s) - 1\\right)^2\\right]\n    \\geq \\frac{1}{4}\\sum_{s \\in \\mathcal{S}_{\\text{s}}} \\mu(s) \\gtrsim \\sum_{s \\in \\mathcal{S}_{\\text{s}}} \\mu(s),\n\\end{aligned}')
('9.2', '\\frac{d_{\\hat w}}{\\mu}(s) \\leq \\frac{1}{2}')
('9.2', '\\left(\\frac{d_{\\hat w}}{\\mu}(s) - 1\\right)^2 \\geq \\frac{1}{4}')
('9.2', '\\mathcal{S}_{\\text{s}}')
('10', '\\begin{aligned}\n\\label{eq:MDP-population-objective}\n        \\max_{w \\geq 0} \\min_{v} L^{\\text{MDP}} (w, v) \\coloneqq (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} [v(s)] + \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[w(s,a) e_v(s,a)\\right].\n\\end{aligned}')
('10', 'w^\\star(s,a) = d^{\\pi^\\star}(s,a)/\\mu(s,a)')
('10', 'v^\\star(s) = V^*(s)')
('10', '(w^\\star,v^\\star) \\in \\arg\\max_{w \\geq 0} \\arg\\min_{v} L^{\\text{MDP}}(w,v)')
('10', '\\zeta^\\star_{w,u} = \\arg \\max_{\\zeta < 0}  L_{\\text{AL}}^{\\text{model-free}} (w, v, u, \\zeta), \\ \\forall w \\in \\mathcal{W}, u \\in \\mathcal{U}')
('10', '\\zeta^\\star_w = \\zeta^\\star_{w, u^\\star_w} \\ \\forall w \\in \\mathcal{W}')
('10', 'u^\\star_w')
('10', '\\zeta^\\star = \\zeta^\\star_{w^\\star}')
('10', 'u^\\star = u^\\star_{w^\\star}')
('10.0', '\\sum_{a \\in \\mathcal{A}}')
('10.0', '|\\mathcal{A}|')
('10.0', '|\\mathcal{A}|')
('10.0', "\\sum_{s',a'} P(s'|s,a)\\pi_w(a'|s')u(s',a')")
('10.1', 'f(x) = (x-1)^2')
('10.1', 'f_*')
('10.1', '\\begin{aligned}\n\\label{eq:fenchel-conjugate}\n    f_*(x) = \\max_y ( xy-f(y) ) = \\max_y \\left( xy - y^2 + 2y - 1\\right) = \\left(\\frac{x+2}{2}\\right)^2 - 1.\n\\end{aligned}')
('10.1', '{d_w(s)}/{d^{\\pi_w}(s)} \\geq 0')
('10.1', 'x^\\star_w(s,a) \\geq - 2')
('10.1', 'x(s,a) \\geq - 2')
('10.1', 'f_*(x)')
('10.1', 'g(x) = - f_*^{-1}(x) = 2 - 2\\sqrt{x+1}')
('10.1', '[-1, +\\infty)')
('10.1', 'g\\left(u(s,a) - \\gamma \\mathbb{P}^{\\pi_w} u(s,a)\\right)')
('10.1', 'g(x)')
('10.1', 'g(x) = \\max_\\zeta x \\zeta - g_*(\\zeta)')
('10.1', 'g(x)')
('10.1', 'g_*(x) = - x - 2 - {1}/{x}')
('10.1', 'x < 0')
('10.1', '\\begin{aligned}\n    \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[w(s,a)g\\left(u(s,a) - \\gamma \\mathbb{P}^{\\pi_w} u(s,a)\\right)]\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[w(s,a)\\max_{\\zeta < 0}  \\left(u(s,a) - \\gamma (\\mathbb{P}^{\\pi_w} u)(s,a) \\right) \\zeta - g_*(\\zeta)] \\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu}[w(s,a)\\max_{\\zeta < 0}  \\left(u(s,a) - \\gamma (\\mathbb{P}^{\\pi_w} u)(s,a) \\right) \\zeta + \\zeta + 1/\\zeta + 2].\n\\end{aligned}')
('10.1', '\\zeta')
('10.1', '\\zeta: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}^-')
('10.2', 'x^\\star_w')
('10.2', 'u^\\star_w')
('10.2', '\\zeta^\\star_{w,v}')
('10.2', 'w \\in \\mathcal{W}')
('10.2', 'v \\in \\mathcal{V}')
('10.2', 'x^\\star_w(s,a) = 2{d_w(s)}/{d^{\\pi_w}(s)} - 2')
('10.2', '|u^\\star_w(s,a)| \\leq \\frac{1}{1-\\gamma}(B_x^2/4 + B_x)')
('10.2', '|\\zeta^\\star_{w,v}(s,a)| \\in \\left[\\frac{2}{2+B_x}, \\frac{2}{2-B_x}\\right]')
('10.2', '\\hat w')
('10.2', 'w^\\star')
('10.2', '\\delta > 0')
('10.2', '\\begin{aligned}\n\\label{eq:eps_model_based}\n    \\epsilon_{\\text{stat}}^{\\text{model-based}} \\coloneqq (B_u + (1+B_v) B_w) \\sqrt{\\frac{B_u\\log(|\\mathcal{P}||\\mathcal{U}||\\mathcal{W}||\\mathcal{V}|/\\delta) }{N}}.\n\\end{aligned}')
('10.2', 'w \\in \\mathcal{W}, v \\in \\mathcal{V},')
('10.2', 'u \\in \\mathcal{U}')
('10.2', '1-\\delta')
('10.2', '\\left| L_{\\text{AL}}^{\\text{model-based}}(w, v, u) - \\hat L_{\\text{AL}}^{\\text{model-based}}(w, v, u) \\right| \\leq \\epsilon_{\\text{stat}}^{\\text{model-based}}')
('10.2', 'L_{\\text{AL}}^{\\text{model-based}}(w^\\star, v^\\star, u^\\star) - L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w}) \\leq 2 \\epsilon_{\\text{stat}}^{\\text{model-based}}')
('10.2', '\\delta > 0')
('10.2', '\\begin{aligned}\n\\label{eq:eps_model_free}\n    \\epsilon_{\\text{stat}}^{\\text{model-free}} \\coloneqq (B_u + (1+B_v +B_{\\zeta}(B_u+1))B_w)\\sqrt{\\frac{\\log(|\\mathcal{U}||\\mathcal{W}||\\mathcal{V}||\\mathcal{Z}|/\\delta) }{N}} .\n\\end{aligned}')
('10.2', 'w \\in \\mathcal{W}, v \\in \\mathcal{V},')
('10.2', 'u \\in \\mathcal{U}')
('10.2', '1-\\delta')
('10.2', '\\left| L_{\\text{AL}}^{\\text{model-free}}(w, v, u) - \\hat L_{\\text{AL}}^{\\text{model-free}}(w, v, u) \\right| \\leq \\epsilon_{\\text{stat}}^{\\text{model-free}}')
('10.2', 'L_{\\text{AL}}^{\\text{model-free}}(w^\\star, v^\\star, u^\\star) - L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}) \\leq 2 \\epsilon_{\\text{stat}}^{\\text{model-free}}')
('10.2', 'd_{\\hat w}(s)')
('10.2', 'd^{\\pi_{\\hat w}}(s)')
('10.2', '\\hat w')
('10.2', '\\mathcal{S}_s \\coloneqq \\left\\{s \\ \\middle| {d_{\\hat w}(s)}  \\leq  \\frac{1}{2} {d^{\\pi_{\\hat w}}(s)} \\right\\}.')
('10.2', '\\delta > 0')
('10.2', '1-\\delta')
('10.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[-A^\\star(s,a) \\hat w(s,a) \\right] \\lesssim \\epsilon^{\\text{model-based}}_{\\text{stat}}')
('10.2', '\\sum_{s \\in \\mathcal{S}_{\\text{s}}} d^{\\pi_{\\hat w}}(s) \\lesssim (1-\\gamma)^{-2} \\epsilon^{\\text{model-based}}_{\\text{stat}}')
('10.2', '\\hat w')
('10.2', '\\mathcal{S}_s \\coloneqq \\left\\{s \\ \\middle| {d_{\\hat w}(s)}  \\leq  \\frac{1}{2} {d^{\\pi_{\\hat w}}(s)} \\right\\}.')
('10.2', '\\delta > 0')
('10.2', '1-\\delta')
('10.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[-A^\\star(s,a) \\hat w(s,a) \\right] \\lesssim \\epsilon^{\\text{model-free}}_{\\text{stat}}')
('10.2', '\\sum_{s \\in \\mathcal{S}_{\\text{s}}} d^{\\pi_{\\hat w}}(s) \\lesssim (1-\\gamma)^{-2} \\epsilon^{\\text{model-free}}_{\\text{stat}}')
('10.2', '\\begin{aligned}\n        J(\\pi^\\star) - J(\\hat \\pi) & = \\mathbb{E}_{s \\sim d^{\\hat \\pi}} \\left[ \\sum_a A^\\star (s,a) \\left(\\pi^\\star(a|s) - \\hat \\pi(a|s)\\right) \\right] = \\mathbb{E}_{s \\sim d^{\\hat \\pi}} \\left[ \\sum_a - A^\\star (s,a)  \\hat \\pi(a|s) \\right],\n    \n\\end{aligned}')
('10.2', 'd^{\\hat \\pi} = d^{\\pi_{\\hat w}}')
('10.2', '\\sum_a A^\\star (s,a) \\pi^\\star(a|s) = 0')
('10.2', '-A^\\star(s,a)')
('10.2', '\\mathcal{S}_{\\text{s}} = \\{s \\ | \\  d_{\\hat w}(s)  \\leq d^{\\hat \\pi}(s)/2\\}')
('10.2', '\\begin{aligned}\n\\notag \n        & \\mathbb{E}_{s \\sim d^{\\hat \\pi}} \\left[ \\sum_a - A^\\star (s,a)  \\hat \\pi(a|s) \\right] \\\\ \\notag \n        & \\quad = \\sum_{s \\in \\mathcal{S}_{\\text{s}}}  d^{\\hat \\pi}(s) \\left[ \\sum_a - A^\\star (s,a)  \\hat \\pi(a|s) \\right] + \\sum_{s \\not \\in \\mathcal{S}_{\\text{s}}}  d^{\\hat \\pi}(s) \\left[ \\sum_a - A^\\star (s,a)  \\hat \\pi(a|s) \\right]\\\\ \\label{eq:bound-sum-S_s}\n        & \\quad \\lesssim \\frac{1}{(1-\\gamma)^3} \\epsilon_{\\text{stat}} + \\sum_{s \\not \\in \\mathcal{S}_{\\text{s}}, d_{\\hat w}(s) \\neq 0}  \\frac{d^{\\hat \\pi}(s)}{d_{\\hat w}(s)} \\left[ \\sum_a - A^\\star (s,a)  {\\hat w(s,a) \\mu(s,a)} \\right]\\\\ \\label{eq:use-S_s-def}\n        & \\quad \\quad \\quad + \\sum_{s \\not \\in \\mathcal{S}_{\\text{s}}, d_{\\hat w}(s) = 0}  d^{\\hat \\pi}(s) \\left[ \\sum_a - \\frac{1}{|\\mathcal{A}|}A^\\star (s,a)   \\right] \\notag \\\\\n        & \\quad \\leq \\frac{1}{(1-\\gamma)^3} \\epsilon_{\\text{stat}} + 2 \\sum_{s \\not \\in \\mathcal{S}_{\\text{s}}}  \\left[ \\sum_a - A^\\star (s,a)  {\\hat w(s,a) \\mu(s,a)} \\right]\n    \n\\end{aligned}')
('10.2', '-A^\\star(s,a) \\leq 1/(1-\\gamma)')
('10.2', '\\mathcal{S}_{\\text{s}}')
('10.2', 'd^{\\hat \\pi}(s)/d_{\\hat w}(s)')
('10.2', 'd_{\\hat w}(s) = 0')
('10.2', 'd^{\\hat \\pi}(s) = 0')
('10.2', 's \\notin \\mathcal{S}_{\\text{s}}')
('10.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{s, a \\sim \\mu}[-A^\\star(s,a) \\hat w(s,a)]')
('10.2', '\\begin{aligned}\n        J(\\pi^\\star) - J(\\hat \\pi) \\lesssim \\frac{1}{(1-\\gamma)^3} \\epsilon_{\\text{stat}} + \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu}\\left[-A^\\star(s,a) \\hat w(s,a)\\right] \\lesssim \\frac{1}{(1-\\gamma)^3} \\epsilon_{\\text{stat}}.\n    \n\\end{aligned}')
('10.3.0', 'f(x) = (x-1)^2')
('10.3.0', 'f_*(x) = \\left(\\frac{x+2}{2}\\right)^2 - 1')
('10.3.0', '(s,a)')
('10.3.0', '\\begin{aligned}\n\\notag \n    & x^\\star_w(s,a) = \\arg \\max_x \\left(d_w(s) x - d^{\\pi_w}(s)\\left( \\left(\\frac{x+2}{2}\\right)^2 - 1\\right) \\right) = 2\\frac{d_w(s)}{d^{\\pi_w}(s)} - 2\\\\ \\notag \n    \\Rightarrow \\; & \\tilde x_w(s,a) = \\operatorname{clip}\\left(2\\frac{d_{w}(s)}{d^{\\pi_{w}}(s)} - 2, -B_x, B_x\\right).\n\\end{aligned}')
('10.3.0.0', 'u^\\star_w')
('10.3.0.0', '\\begin{aligned}\n    u(s,a) = f_*(\\tilde x_w(s,a)) + \\gamma (\\mathbb{P}^{\\pi_w} u)(s,a).\n\\end{aligned}')
('10.3.0.0', 'f_*(\\tilde x_w(s,a))')
('10.3.0.0', '\\begin{aligned}\n   \\left(\\frac{2-B_x}{2}\\right)^2 -1 \\leq f_*(\\tilde x_w(s,a)) \\leq \\left(\\frac{B_x+2}{2}\\right)^2 - 1.\n\\end{aligned}')
('10.3.0.0', 'u^\\star_w')
('10.3.0.0', '\\pi_w')
('10.3.0.0', 'f_*(\\tilde x_w(s,a))')
('10.3.0.0', '|u^\\star_w(s,a)| \\leq\\frac{1}{1-\\gamma} \\max\\left\\{  1 - \\left( \\frac{2-B_x}{2}\\right)^2 , \\left(\\frac{B_x+2}{2}\\right)^2 - 1 \\right\\} = \\frac{1}{1-\\gamma}(B_x^2/4 + B_x)')
('10.3.0.1', '\\zeta^\\star_{w, u}')
('10.3.0.1', "\\begin{aligned}\n    \\zeta^\\star_{w,u} = \\arg\\max_{\\zeta < 0}  \\mathop{\\mathrm{\\mathbb{E}}}_{(s,a,s') \\sim \\mu, a' \\sim \\pi_w(\\cdot|s')} [ w(s,a) \\left( (u(s,a) - \\gamma u(s',a')+1)\\zeta(s,a)  + 1/\\zeta(s,a) \\right) ].\n\\end{aligned}")
('10.3.0.1', "|\\zeta^\\star_{w,u}(s,a)| = (u(s,a) - \\gamma(\\mathbb{P}^{\\pi_w} u)(s',a')+1)^{-1/2} = (f_*(\\tilde x_w(s,a))+1)^{-1/2}")
('10.3.0.1', '\\tilde x_w(s,a) \\in [-B_x, B_x]')
('10.3.0.1', '|\\zeta^\\star_{w,u}(s,a)| \\in \\left[\\frac{2}{2+B_x}, \\frac{2}{2-B_x}\\right]')
('10.4.0', 'L_{\\text{AL}}^{\\text{model-based}} - \\hat L_{\\text{AL}}^{\\text{model-based}} = T_1 + T_2 + T_3')
('10.4.0', "\\begin{aligned}\n    T_1 & \\coloneqq (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{\\rho} \\left[v(s) + \\sum_a u(s,a) \\pi_w(a|s)\\right] - (1-\\gamma) \\frac{1}{N_0} \\sum_{i=1}^{N_0} \\left( v(s_i)  +\\sum_a u(s_i,a) \\pi_w(a|s_i)\\right)\\\\\n    T_2 & \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a)(r(s,a) + \\gamma \\sum_{s'}P(s'|s,a) v(s') - v(s))\\right] - \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i) \\left[r_i + \\gamma v(s_i') - v(s_i) \\right]\\\\\n    T_3 &: = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) \\left(f_*^{-1} \\left(u(s,a) - \\gamma P^{\\pi_w} u(s,a)\\right) \\right)\\right] - \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i) \\left[f_*^{-1}\\left(u(s_i, a_i) - \\gamma \\hat P^{\\pi_w} u(s_i,a_i)\\right)  \\right]\n\\end{aligned}")
('10.4.0', '\\begin{align}\\label{eq:T1bound-model-based}\n    |T_1| & \\lesssim (B_v + B_u) \\sqrt{\\frac{\\log |\\mathcal{V}||\\mathcal{U}|/\\delta}{N_0}},\\\\\\label{eq:T2bound-model-based}\n    |T_2| & \\lesssim (1+B_v)B_w \\sqrt{\\frac{\\log|\\mathcal{V}||\\mathcal{W}|/\\delta}{N}},\\\\\\label{eq:T3bound-model-based}\n    |T_3| & \\lesssim  B_w \\sqrt{\\frac{B_u\\log|\\mathcal{P}||\\mathcal{U}||\\mathcal{W}|/\\delta }{N}}\n\\end{align}')
('10.4.0', 'N_0 = N')
('10.4.0', 'B_w \\geq 1')
('10.4.0', 'w^\\star')
('10.4.0', '\\begin{aligned}\n    \\left| L_{\\text{AL}}^{\\text{model-based}} - \\hat L_{\\text{AL}}^{\\text{model-based}} \\right| & \\lesssim (B_v + B_u)\\sqrt{\\frac{\\log |\\mathcal{V}||\\mathcal{U}|/\\delta}{N_0}} + (1+B_v)B_w \\sqrt{\\frac{B_u\\log(|\\mathcal{P}||\\mathcal{U}||\\mathcal{W}||\\mathcal{V}|/\\delta)}{N}}\\\\\n    & \\lesssim \\epsilon_{\\text{stat}}^{\\text{model-based}}. \n\\end{aligned}')
('10.4.0.0', '|v(s)| \\leq B_v, |u(s,a)| \\leq B_u')
('10.4.0.0', 'v \\in \\mathcal{V}')
('10.4.0.0', 'u \\in \\mathcal{U}')
('10.4.0.0', 's_i')
('10.4.0.0', '|T_1|')
('10.4.0.1', 'w, v')
('10.4.0.1', "\\begin{aligned}\n    \\left|w(s,a) (r(s,a) + \\gamma v(s') - v(s)) \\right| \\leq B_w (1+ (\\gamma+1) B_v) \\leq B_w (1+\\gamma)(1+B_v). \n\\end{aligned}")
('10.4.0.1', "w(s_i, a_i) [r_i + \\gamma v(s_i') - v(s_i)]")
('10.4.0.1', '|T_2|')
('10.4.0.2', 'T_3 = T_{3,1} + T_{3,2}')
('10.4.0.2', 'T_{3,1}')
('10.4.0.2', 'T_{3,2}')
('10.4.0.2', '\\begin{aligned}\n    T_{3,1} & \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) \\left(f_*^{-1} \\left(u(s,a) - \\gamma ({\\mathbb{P}}^{\\pi_w} u)(s,a)\\right) \\right)\\right] - \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) \\left(f_*^{-1} \\left(u(s,a) - \\gamma (\\mathbb{\\hat P}^{\\pi_w} u)(s,a)\\right) \\right)\\right]\\\\\n    T_{3,2} & \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) \\left(f_*^{-1} \\left(u(s,a) - \\gamma (\\mathbb{\\hat P}^{\\pi_w} u)(s,a)\\right) \\right)\\right]\\\\\n    & \\qquad - \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i) \\left[f_*^{-1}\\left(u(s_i, a_i) - \\gamma (\\mathbb{\\hat P}^{\\pi_w} u)(s_i,a_i)\\right)  \\right]\n\\end{aligned}')
('10.4.0.2', 'f_*^{-1}(x) = 2 \\sqrt{x+1} - 2')
('10.4.0.2', 'T_{3,2}')
('10.4.0.2', '\\begin{aligned}\n\\label{eq:T_32-bound-model-based}\n    |T_{3,2}| \\lesssim B_w \\sqrt{\\frac{B_u\\log |\\mathcal{W}||\\mathcal{U}|\\delta}{N}}.\n\\end{aligned}')
('10.4.0.2', '|T_{3,1}|')
('10.4.0.2', 'b_i, x_i, y_i')
('10.4.0.2', '(s,a)')
('10.4.0.2', "\\begin{aligned}\n    b_i & = \\begin{cases}\n    1+u(s,a) \\quad & i = 0\\\\\n    \\gamma \\sum_{a'} \\pi_w(a'|s') u(s'|a') \\quad & 1 \\leq i \\leq |\\mathcal{S}|\n    \\end{cases}\\\\\n    x_i & = \\begin{cases}\n    1 \\quad & i = 0\\\\\n    P(s'|s,a)\\quad & 1 \\leq i \\leq |\\mathcal{S}|\n    \\end{cases}, \\quad \n    y_i = \\begin{cases}\n    1 \\quad & i = 0\\\\\n    P(s'|s,a)\\quad & 1 \\leq i \\leq |\\mathcal{S}|\n    \\end{cases}\n\\end{aligned}")
('10.4.0.2', 'T_{3,1}^2')
('10.4.0.2', "\\begin{aligned}\n\\notag \n    T^2_{3,1} & = \\bigg( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) \\left(f_*^{-1} \\left(u(s,a) - \\gamma \\mathbb{P}^{\\pi_w} u(s,a)\\right) \\right)\\right]  - \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a) \\left(f_*^{-1} \\left(u(s,a) - \\gamma \\mathbb{\\hat P}^{\\pi_w} u(s,a)\\right) \\right)\\right] \\bigg)^2\\\\\\notag \n    & \\lesssim B_w \\bBigg@{2.5}( \\mathop{\\mathrm{\\mathbb{E}}}_\\mu \\left[ \\sqrt{1+ u(s,a) - \\gamma \\sum_{s'} P(s'|s,a) \\sum_{a'} \\pi_w(a'|s') u(s',a')} \\right]\\\\\\notag \n    & \\quad - \\mathop{\\mathrm{\\mathbb{E}}}_\\mu \\left[ \\sqrt{1+ u(s,a) - \\gamma \\sum_{s'} \\hat P(s'|s,a) \\sum_{a'} \\pi_w(a'|s') u(s',a')} \\right] \\bBigg@{2.5})^2\\\\\\label{eq:initial-bound-T3}\n    & \\leq B^2_w B_u \\mathop{\\mathrm{\\mathbb{E}}}_\\mu \\left[ \\sum_{s'} \\left( \\sqrt{P(s'|s,a)} - \\sqrt{\\hat P(s'|s,a)}\\right)^2\\right].\n\\end{aligned}")
('10.4.0.2', 'P')
('10.4.0.2', "\\begin{aligned}\n    1+ u(s,a) - \\gamma \\sum_{s'}  P(s'|s,a) \\sum_{a'} \\pi_w(a'|s') u(s',a') \\geq 1 - B_u - \\gamma B_u \\geq 1 - 2B_u \\geq 0.\n\\end{aligned}")
('10.4.0.2', 'w \\in \\mathcal{W}')
('10.4.0.2', 'v \\in \\mathcal{V}')
('10.4.0.2', '\\begin{aligned}\n\\label{eq:T_31-bound-model-based}\n    |T_{3,1}| \\lesssim B_w \\sqrt{\\frac{B_u\\log|\\mathcal{P}||\\mathcal{U}||\\mathcal{W}|/\\delta }{N}}.\n\\end{aligned}')
('10.4.1', '\\hat v_w')
('10.4.1', '\\hat u_w')
('10.4.1', '\\begin{aligned}\n    \\hat v_w, \\hat u_w = \\mathop{\\mathrm{arg\\,min}}_{v \\in \\mathcal{V}} \\mathop{\\mathrm{arg\\,min}}_{u \\in \\mathcal{U}} \\hat L_{\\text{AL}}^{\\text{model-based}} (w, v, u)\n\\end{aligned}')
('10.4.1', '\\begin{aligned}\n    & L_{\\text{AL}}^{\\text{model-based}}(w^\\star, v^\\star, u^\\star) - L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w})\\\\\n    & \\quad = {L_{\\text{AL}}^{\\text{model-based}}(w^\\star, v^\\star, u^\\star) - L_{\\text{AL}}^{\\text{model-based}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star})} { \\quad \\coloneqq T_1}\\\\\n    & \\qquad + L_{\\text{AL}}^{\\text{model-based}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}) - \\hat L_{\\text{AL}}^{\\text{model-based}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}) \\quad \\coloneqq T_2\\\\\n    & \\qquad + \\hat L_{\\text{AL}}^{\\text{model-based}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}) - \\hat L_{\\text{AL}}^{\\text{model-based}}(\\hat w, \\hat v_{\\hat w}, \\hat u_{\\hat w}) \\quad \\coloneqq T_3\\\\\n    & \\qquad + \\hat L_{\\text{AL}}^{\\text{model-based}}(\\hat w, \\hat v_{\\hat w}, \\hat u_{\\hat w}) - \\hat L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w}) \\quad \\coloneqq T_4\\\\\n    & \\qquad + \\hat L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w}) - L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w}) \\quad \\coloneqq T_5\n\\end{aligned}')
('10.4.1', 'T_1 \\leq 0')
('10.4.1', 'v^\\star, u^\\star = \\arg \\min_{v} \\arg \\min_{u} L_{\\text{AL}}^{\\text{model-based}} (w^\\star, v, u)')
('10.4.1', 'T_2 \\leq \\epsilon^{\\text{model-based}}_{\\text{stat}}')
('10.4.1', 'T_3 \\leq 0')
('10.4.1', '\\hat w = \\arg \\max_{w \\in \\mathcal{W}} \\hat L_{\\text{AL}}^{\\text{model-based}} (w, \\hat v_{w}, \\hat u_{w})')
('10.4.1', 'T_4 \\leq 0')
('10.4.1', '\\hat v_{w}, \\hat u_{w} = \\arg \\min_{v \\in \\mathcal{V}} \\arg \\min_{u \\in \\mathcal{U}} \\hat L_{\\text{AL}}^{\\text{model-based}} (w, v, u)')
('10.4.1', 'T_5 \\leq \\epsilon^{\\text{model-based}}_{\\text{stat}}')
('10.5.0', 'L_{\\text{AL}}^{\\text{model-free}} - \\hat L_{\\text{AL}}^{\\text{model-free}} = T_1 + T_2 + T_3')
('10.5.0', "\\begin{aligned}\n    T_1 & \\coloneqq (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{\\rho} \\left[v(s) + \\sum_a u(s,a) \\pi_w(a|s)\\right] - (1-\\gamma) \\frac{1}{N_0} \\sum_{i=1}^{N_0} \\left( v(s_i)  +\\sum_a u(s_i,a) \\pi_w(a|s_i)\\right)\\\\\n    T_2 & \\coloneqq \\mathop{\\mathrm{\\mathbb{E}}}_{\\mu} \\left[w(s,a)(r(s,a) + \\gamma \\sum_{s'}P(s'|s,a) v(s') - v(s))\\right] - \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i) \\left[r_i + \\gamma v(s_i') - v(s_i) \\right]\\\\\n    T_3 &: =  \\mathop{\\mathrm{\\mathbb{E}}}_{(s,a,s') \\sim \\mu, a' \\sim \\pi_w(\\cdot|s')} [ w(s,a) \\left((u(s,a) - \\gamma u(s',a'))\\zeta(s,a) -g_\\star(\\zeta(s,a) ) \\right) ] \\\\\n    & \\qquad - \\frac{1}{N} \\sum_{i=1}^N w(s_i, a_i)\\left[\\left(u(s_i,a_i) - \\gamma \\sum_{a' \\in \\mathcal{A}} u(s'_i, a') \\pi_w(a'|s'_i )\\right)\\zeta(s_i,a_i) -g_\\star(\\zeta(s_i,a_i) )  \\right].\n\\end{aligned}")
('10.5.0', '\\begin{align}\\label{eq:T1bound-model-free}\n        |T_1| & \\lesssim (B_v + B_u) \\sqrt{\\frac{\\log (|\\mathcal{V}||\\mathcal{U}|/\\delta)}{N_0}},\\\\ \\label{eq:T2bound-model-free}\n        |T_2| & \\lesssim (1+B_v)B_w \\sqrt{\\frac{\\log (|\\mathcal{V}||\\mathcal{W}|/\\delta)}{N}},\\\\ \\label{eq:T3bound-model-free}\n        |T_3| & \\lesssim (1+B_{\\zeta}(B_u+1))B_w \\sqrt{\\frac{\\log|\\mathcal{U}||\\mathcal{W}||\\mathcal{Z}|/\\delta}{N}}.\n    \\end{align}')
('10.5.0', '|T_1|')
('10.5.0', '|T_2|')
('10.5.0', '|T_3|')
('10.5.0', 'g_\\star(x) = -x - 2 - \\frac{1}{x}, \\ \\forall x < 0')
('10.5.0', '|\\zeta(s,a)| \\in (B_{\\zeta,L}, B_{\\zeta,U})')
('10.5.0', '\\zeta \\in \\mathcal{Z}')
('10.5.0', '(s,a)')
('10.5.0', 'B_{\\zeta} \\triangleq \\max\\{ B_{\\zeta, U}, B_{\\zeta, L}^{-1} \\}')
('10.5.0', '|T_3|')
('10.5.0', "\\begin{aligned}\n\\left|w(s,a) \\left((u(s,a) - \\gamma u(s',a'))\\zeta(s,a) -g_\\star(\\zeta(s,a) ) \\right) \\right| \\leq& B_w ((1+\\gamma)B_u B_{\\zeta,U} + B_{\\zeta,U} + B_{\\zeta,L}^{-1} + 2 ).\n\\end{aligned}")
('10.5.0', '\\mathcal{W}, \\mathcal{U},')
('10.5.0', '\\mathcal{Z}')
('10.5.0', '|T_3|')
('10.5.0', 'B_w \\geq 1')
('10.5.0', 'w^\\star')
('10.5.0', '\\begin{aligned}\n    & L_{\\text{AL}}^{\\text{model-free}}(w, v, u, \\zeta) - \\hat L_{\\text{AL}}^{\\text{model-free}}(w, v, u, \\zeta) \\\\\n    & \\lesssim (B_v + B_u)\\sqrt{\\frac{\\log |\\mathcal{V}||\\mathcal{U}|/\\delta}{N_0}} + (1+B_v +B_{\\zeta}(B_u+1))B_w \\sqrt{\\frac{\\log|\\mathcal{U}||\\mathcal{W}||\\mathcal{V}||\\mathcal{Z}|/\\delta }{N}}\\\\\n    & \\lesssim \\epsilon_{\\text{stat}}^{\\text{model-free}}.\n\\end{aligned}')
('10.5.1', '\\begin{aligned}\n    \\hat v_w, \\hat u_w, \\hat \\zeta_w & = \\arg \\min_{v \\in \\mathcal{V}} \\arg \\min_{u \\in \\mathcal{U}} \\arg \\max_{\\zeta \\in \\mathcal{Z}} \\hat L_{\\text{AL}}^{\\text{model-free}} (w, v, u, \\zeta), \\quad \\forall w \\in \\mathcal{W}\\\\\n    \\hat \\zeta(w, u) & = \\arg \\max_{\\zeta \\in \\mathcal{Z}} \\hat L_{\\text{AL}}^{\\text{model-free}} (w, v, u, \\zeta) \\quad \\forall w \\in \\mathcal{W}, u \\in \\mathcal{U}\n\\end{aligned}')
('10.5.1', '\\begin{aligned}\n    & L_{\\text{AL}}^{\\text{model-free}}(w^\\star, v^\\star, u^\\star, \\zeta^\\star) - L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}, \\zeta^\\star_{\\hat w})\n    \\\\\n    & \\quad = {L_{\\text{AL}}^{\\text{model-free}}(w^\\star, v^\\star, u^\\star, \\zeta^\\star) - L_{\\text{AL}}^{\\text{model-free}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\zeta^\\star(w^\\star, \\hat u_{w^\\star}))} { \\quad \\coloneqq T_1}\\\\\n    & \\qquad + L_{\\text{AL}}^{\\text{model-free}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\zeta^\\star_{w^\\star, \\hat u_{w^\\star}}) - \\hat L_{\\text{AL}}^{\\text{model-free}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\zeta^\\star_{w^\\star, \\hat u_{w^\\star}}) { \\quad \\coloneqq T_2}\\\\\n    & \\qquad + \\hat L_{\\text{AL}}^{\\text{model-free}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\zeta^\\star_{w^\\star, \\hat u_{w^\\star}}) - \\hat L_{\\text{AL}}^{\\text{model-free}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\hat \\zeta_{w^\\star}) { \\quad \\coloneqq T_3}\\\\\n    & \\qquad + \\hat L_{\\text{AL}}^{\\text{model-free}}(w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\hat \\zeta_{w^\\star})  -\\hat L_{\\text{AL}}^{\\text{model-free}}(\\hat w, \\hat v_{\\hat w}, \\hat u_{\\hat w}, \\hat \\zeta_{\\hat w}) \\quad \\coloneqq T_4\\\\\n    & \\qquad + \\hat L_{\\text{AL}}^{\\text{model-free}}(\\hat w, \\hat v_{\\hat w}, \\hat u_{\\hat w}, \\hat \\zeta_{\\hat w}) - \\hat L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}, \\hat \\zeta_{\\hat w, u^\\star_{\\hat w}}) \\quad \\coloneqq T_5\\\\\n    & \\qquad +  \\hat L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}, \\hat \\zeta_{\\hat w, u^\\star_{\\hat w}}) - L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}, \\hat \\zeta_{\\hat w, u^\\star_{\\hat w}}) \\quad \\coloneqq T_6\\\\\n    & \\qquad +  L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}, \\hat \\zeta_{\\hat w, u^\\star_{\\hat w}}) - L_{\\text{AL}}^{\\text{model-free}}(\\hat w, v^\\star, u^\\star_{\\hat w}, \\zeta^\\star_{\\hat w}) \\quad \\coloneqq T_7\n\\end{aligned}')
('10.5.1', 'T_1 \\leq 0')
('10.5.1', 'v^\\star, u^\\star = \\arg \\min_{v, u} L_{\\text{AL}}^{\\text{model-free}} (w^\\star, v, u, \\zeta^\\star(w^\\star, u))')
('10.5.1', 'T_2 \\leq \\epsilon_{\\text{model-free}}')
('10.5.1', 'T_3 \\leq 0')
('10.5.1', '\\hat \\zeta_{w^\\star} = \\hat \\zeta_{w^\\star, \\hat u_{w^\\star}} = \\arg \\max_{\\zeta \\in \\mathcal{Z}} \\hat L_{\\text{AL}}^{\\text{model-free}} (w^\\star, \\hat v_{w^\\star}, \\hat u_{w^\\star}, \\zeta)')
('10.5.1', 'T_4 \\leq 0')
('10.5.1', '\\hat w = \\arg \\max_{w \\in \\mathcal{W}} \\hat L_{\\text{AL}}^{\\text{model-free}} (w, \\hat v_w, \\hat u_w, \\hat \\zeta_w)')
('10.5.1', 'T_5 \\leq 0')
('10.5.1', '\\hat v_{\\hat w}, \\hat u_{\\hat w} = \\arg \\min_{v \\in \\mathcal{V}, u \\in \\mathcal{U}} \\hat L_{\\text{AL}}^{\\text{model-free}} (\\hat w, v, u, \\hat \\zeta_{\\hat w, u)}')
('10.5.1', 'T_6 \\leq \\epsilon_{\\text{model-free}}')
('10.5.1', 'T_7 \\leq 0')
('10.5.1', '\\zeta^\\star_{\\hat w} = \\zeta^\\star_{\\hat w,  u^\\star_{\\hat w}} = \\arg \\max_{\\zeta < 0} L_{\\text{AL}}^{\\text{model-free}} (\\hat w, v^\\star, u^\\star_{\\hat w}, \\zeta)')
('10.6', '\\hat w = \\hat w^{\\text{model-based}}')
('10.6', 'L^{\\text{model-free}}_{AL}(w, v^\\star, u^\\star_w, \\zeta^\\star_w) = L^{\\text{model-based}}_{AL}(w, v^\\star, u^\\star_w)')
('10.6.0', 'L_{\\text{AL}}^{\\text{model-based}} (w^\\star, v^\\star, u^\\star)')
('10.6.0', 'u^\\star \\coloneqq u^\\star_{w^\\star}')
('10.6.0', '\\begin{aligned}\n\\notag \n    & L_{\\text{AL}}^{\\text{model-based}} (w^\\star, v^\\star, u^\\star)\\\\ \\notag \n    = & (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} [v^\\star(s)] + \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[w^\\star(s,a) e_{v^\\star}(s,a)\\right] - \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim d^{\\pi_{w^\\star}}} \\left(\\frac{d_{w^\\star}(s)}{d^{\\pi_{w^\\star}}(s)} - 1\\right)^2\\\\ \\label{eq:expressing-L-at-optimal-model-based-with-advantage} \n    = & (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} [V^\\star(s)] + \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[w^\\star(s,a)A^\\star(s,a)\\right]\n\\end{aligned}')
('10.6.0', 'u^\\star')
('10.6.0', 'f')
('10.6.0', 'x^\\star_w (s,a) = 2 d_w(s)/d^{\\pi_w}(s) - 2')
('10.6.0', '\\tilde x_w(s,a) = \\operatorname{clip}(x^\\star_w(s,a), -B_x, B_x)')
('10.6.0', 'x^\\star_{w^\\star}(s,a) = 0')
('10.6.0', '\\tilde x_{w^\\star}(s,a) = x^\\star_{w^\\star}(s,a)')
('10.6.0', 'u^\\star')
('10.6.0', 'f')
('10.6.0', 'v^\\star(s) = V^\\star(s)')
('10.6.0', 'v^\\star(s)')
('10.6.0', "e_{v^\\star}(s,a) = r(s,a) + \\gamma \\sum_{s'} P(s'|s,a) v^\\star(s') - v^\\star(s) = A^{\\star}(s,a)")
('10.6.0', '{d_{w^\\star}(s)} = {d^{\\pi_{w^\\star}}(s)}')
('10.6.0', 'w^\\star')
('10.6.0', '\\begin{aligned}\n    L_{\\text{AL}}^{\\text{model-based}} (w^\\star, v^\\star, u^\\star) = (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} [V^\\star(s)].\n\\end{aligned}')
('10.6.0', '(w^\\star, v^\\star, u^\\star)')
('10.6.0', '\\begin{aligned}\n\\notag \n    & L_{\\text{AL}}^{\\text{model-based}}(w^\\star, v^\\star, u^\\star) - L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w})\\\\\\notag \n    = & (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} [V^\\star(s)] - (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho} [v^\\star(s)] - \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[\\hat w(s,a) e_{v^\\star}(s,a)\\right]\\\\ \\label{eq:difference-u-part-model-based}\n    & \\quad + (1-\\gamma) \\mathop{\\mathrm{\\mathbb{E}}}_{s \\sim \\rho, a \\sim \\pi_{\\hat w}} [u^\\star_{\\hat w}(s, a)] + \\mathop{\\mathrm{\\mathbb{E}}}_\\mu \\left[ \\hat w(s,a) f_*^{-1}\\left(u^\\star_{\\hat w}(s,a) - \\gamma  (\\mathbb{P}^{\\pi_{\\hat w}} u^\\star_{\\hat w})(s,a)\\right)\\right]\\\\\\notag \n    = & - \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[\\hat w(s,a) A^\\star(s,a)\\right] - \\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_{\\hat w}}} [f_*(\\tilde x_{\\hat w}(s,a))] + \\mathop{\\mathrm{\\mathbb{E}}}_{d_{\\hat w}} [\\tilde x_{\\hat w}(s,a)]\n\\end{aligned}')
('10.6.0', 'e_{v^\\star}(s,a) = A^\\star(s,a)')
('10.6.0', 'u^\\star_{\\hat w}')
('10.6.0', '\\begin{aligned}\n\\notag \n    u^\\star_{\\hat w}(s,a) \\coloneqq f_*(\\tilde x_{\\hat w}(s,a)) + \\gamma (\\mathbb{P}^{\\pi_{\\hat w}} u^\\star_{\\hat w})(s,a),\n\\end{aligned}')
('10.6.0', 'f')
('10.6.0', '\\tilde x_{\\hat w}')
('10.6.0', 'L_{\\text{AL}}^{\\text{model-based}}(w^\\star, v^\\star, u^\\star) - L_{\\text{AL}}^{\\text{model-based}}(\\hat w, v^\\star, u^\\star_{\\hat w}) \\lesssim \\epsilon^{\\text{model-based}}_{\\text{stat}}')
('10.6.0', '\\begin{aligned}\n\\label{eq:claim1-model-based}\n    {- \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[\\hat w(s,a) A^\\star(s,a)\\right]} - {\\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_{\\hat w}}} [f_*(\\tilde x_{\\hat w}(s,a))] + \\mathop{\\mathrm{\\mathbb{E}}}_{d_{\\hat w}} [\\tilde x_{\\hat w}(s,a)]} \\lesssim \\epsilon^{\\text{model-based}}_{\\text{stat}}.\n\\end{aligned}')
('10.6.0', '\\begin{align}\\label{eq:expected_advantage_bound}\n        {- \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[\\hat w(s,a) A^\\star(s,a)\\right]} & \\lesssim \\epsilon^{\\text{model-based}}_{\\text{stat}}\\\\ \\label{eq:variational-form-bound}\n        - {\\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_{\\hat w}}} [f_*(\\tilde x_{\\hat w}(s,a))] + \\mathop{\\mathrm{\\mathbb{E}}}_{d_{\\hat w}} [\\tilde x_{\\hat w}(s,a)]} & \\lesssim \\epsilon^{\\text{model-based}}_{\\text{stat}}\n    \\end{align}')
('10.6.0', 'A^\\star(s,a) \\leq 0')
('10.6.0', 's \\in \\mathcal{S}')
('10.6.0', 'a \\in \\mathcal{A}')
('10.6.0', '\\begin{aligned}\n    - {\\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_{\\hat w}}} [f_*(\\tilde x_{\\hat w}(s,a))] + \\mathop{\\mathrm{\\mathbb{E}}}_{d_{\\hat w}} [\\tilde x_{\\hat w}(s,a)]}& = \\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_{\\hat w}}} \\left[ \\frac{d_{\\hat w}(s)}{d^{\\pi_{\\hat w}}(s)} \\tilde x_{\\hat w}(s,a)  -  f_*(\\tilde x_{\\hat w}(s,a)) \\right].\n\\end{aligned}')
('10.6.0', '\\begin{aligned}\n\\label{eq:variational-form-nonnegative}\n    \\frac{d_{w}(s)}{d^{\\pi_{w}}(s)} \\tilde x_w(s,a)  -  f_*(\\tilde x_{w}(s,a)) \\geq 0 \\quad \\forall s \\in \\mathcal{S}, w \\in \\mathcal{W}.\n\\end{aligned}')
('10.6.0.0', '\\tilde x_w')
('10.6.0.0', '1-B_x/2 \\leq \\frac{d_{w}(s)}{d^{\\pi_w}(s)}\\leq B_x/2 + 1')
('10.6.0.0', '\\tilde x_w (s,a) = \\left(2\\frac{d_w(s)}{d^{\\pi_w}(s)} - 2\\right)')
('10.6.0.0', '\\begin{aligned}\n        \\frac{d_{  w}(s)}{d^{\\pi_{  w}}(s)} \\tilde x_{  w}(s,a)  -  f_*(\\tilde x_{  w}(s,a)) = \\left( \\frac{d_{  w}(s)}{d^{\\pi_{  w}}(s)} - 1\\right)^2 \\geq 0.\n    \n\\end{aligned}')
('10.6.0.0', '\\frac{d_{w}(s)}{d^{\\pi_w}(s)}> B_x/2 + 1')
('10.6.0.0', '\\tilde x_w(s,a) = B_x')
('10.6.0.0', '\\begin{aligned}\n        \\frac{d_{w}(s)}{d^{\\pi_w}(s)} B_x - \\left( \\left(\\frac{B_x}{2}+1\\right)^2 - 1\\right) \\geq \\left(\\frac{B_x}{2}+1\\right) B_x - \\frac{B_x^2}{4} - B_x = \\frac{B_x^2}{4} \\geq 0.\n    \n\\end{aligned}')
('10.6.0.0', '\\frac{d_{w}(s)}{d^{\\pi_w}(s)} < 1 - B_x/2')
('10.6.0.0', '\\tilde x_w(s,a) = -B_x')
('10.6.0.0', '\\begin{aligned}\n\\label{eq:case3-variational-form}\n        -\\frac{d_{w}(s)}{d^{\\pi_w}(s)} B_x - \\left( \\left(1-\\frac{B_x}{2}\\right)^2 - 1\\right) \\geq \\left(\\frac{B_x}{2}-1\\right) B_x - \\frac{B_x^2}{4} + B_x = \\frac{B_x^2}{4} \\geq 0.\n    \n\\end{aligned}')
('10.6.1', '\\mathcal{S}_s')
('10.6.1', 's \\in \\mathcal{S}_s')
('10.6.1', '\\frac{d_{\\hat w}(s)}{d^{\\pi_{\\hat w}}(s)} \\leq \\frac{1}{2}')
('10.6.1', 's \\in \\mathcal{S}_s')
('10.6.1', '\\tilde x_{\\hat w}(s,a) = - B_x')
('10.6.1', '\\begin{aligned}\n\\label{eq:lowerbound-fdivergence-model-based}\n    \\frac{d_{\\hat w}(s)}{d^{\\pi_{\\hat w}}(s)} \\tilde x_{\\hat w}(s,a)  -  f_*(\\tilde x_{\\hat w}(s,a))  \\gtrsim {(1-\\gamma)^2} \\quad \\forall s \\in \\mathcal{S}_{\\text{s}}.\n\\end{aligned}')
('10.6.1', '\\begin{aligned}\n    \\epsilon^{\\text{model-based}}_{\\text{stat}} \\gtrsim & \\mathop{\\mathrm{\\mathbb{E}}}_{d_{\\hat w}} [\\tilde x_{\\hat w}(s,a)] -  \\mathop{\\mathrm{\\mathbb{E}}}_{d^{\\pi_{\\hat w}}} [f_*(\\tilde x_{\\hat w}(s,a))]\\\\\n    = & \\sum_{s} d^{\\pi_{\\hat w}}(s) \\left(\\frac{d_{\\hat w}(s)}{d^{\\pi_{\\hat w}}(s)} \\tilde x_{\\hat w}(s,a)  -  f_*(\\tilde x_{\\hat w}(s,a)) \\right)\\\\\n    \\gtrsim &\\sum_{s \\in \\mathcal{S}_{\\text{s}}} {(1-\\gamma)^2}  d^{\\pi_{\\hat w}}(s),\n\\end{aligned}')
('10.6.1', '\\sum_{s \\in \\mathcal{S}_{\\text{s}}} d^{\\pi_{\\hat w}}(s) \\lesssim (1-\\gamma)^{-2} \\epsilon_{\\text{stat}}')
('11', '\\mathcal{P}= \\{P: (\\mathcal{S}, \\mathcal{A}) \\rightarrow \\Delta(\\mathcal{S})\\}')
('11', 'P^\\star')
('11', "\\mathcal{D}_m = \\{(s_i, a_i, s'_i)\\}")
('11', "(s_i, a_i) \\overset{\\mathrm{iid}}{\\sim} \\mu, s'_i \\sim P^\\star(\\cdot |s_i, a_i)")
('11', '\\hat P')
('11', "\\begin{aligned}\n    \\hat P = \\arg \\max_{P \\in \\mathcal{P}} \\sum_{i=1}^N \\ln P(s'_i|s_i, a_i).\n\\end{aligned}")
('11', '\\delta > 0')
('11', '1-\\delta')
('11', '\\hat P')
('11', 'P^\\star')
('11', "\\begin{aligned}\n    \\mathop{\\mathrm{\\mathbb{E}}}_{s,a \\sim \\mu} \\left[\\sum_{s'} \\left(\\sqrt{\\hat P(s'|s,a)} - \\sqrt{P^\\star(s'|s,a)}\\right)^2 \\right]\\lesssim \\frac{\\log(|\\mathcal{P}|/\\delta) }{N}.\n\\end{aligned}")
('11', '0 \\leq b_i \\leq B')
('11', 'x_i, y_i \\geq 0')
('11', 'i \\in \\{0, \\dots, n\\}')
('11', '\\begin{aligned}\n\\label{eq:square-root-inequality}\n\\left(\\sqrt{\\sum_{i=0}^n b_i x_i} - \\sqrt{\\sum_{i=0}^n b_i y_i} \\right)^2 \\leq B \\sum_{i=0}^n \\left(\\sqrt{x_i} - \\sqrt{y_i} \\right)^2.\n\\end{aligned}')
('11', '\\begin{aligned}\n     \\left(\\sqrt{\\sum_{i=1}^n b_i x_i} - \\sqrt{\\sum_{i=1}^n b_i y_i} \\right)^2\n    = & \\sum_i b_i x_i + \\sum_i b_i y_i - 2 \\sqrt{\\left( \\sum_i b_i x_i\\right) \\left( \\sum_i b_i y_i\\right)}\\\\\n    \\leq & \\sum_i b_i x_i + \\sum_i b_i y_i - 2 \\sum_i b_i \\sqrt{x_i y_i}\\\\\n    = & \\sum_i (\\sqrt{b_i x_i} - \\sqrt{b_i y_i})^2\\leq  B \\sum_i \\left(\\sqrt{x_i} - \\sqrt{y_i} \\right)^2.\n\\end{aligned}')
('11', '\\mathcal{X}, \\mathcal{Y}')
('11', 'f(\\cdot, \\cdot): \\mathcal{X}\\times \\mathcal{Y}\\to \\mathbb{R}')
('11', '\\mathcal{X}_0 = \\{ x \\in \\mathcal{X}\\ | \\ \\inf_{y \\in \\mathcal{Y}} f(x,y) > -\\infty \\}')
('11', '\\mathcal{X}_0')
('11', 'x \\in \\mathcal{X}_0')
('11', 'y^*(x) \\in \\mathcal{Y}')
('11', 'f(x,y^*(x)) = \\min_{y \\in \\mathcal{Y}} f(x,y)')
('11', '\\mathcal{X}^*_{\\text{p}} = \\{ x \\in \\mathcal{X}_0 \\ | \\ x \\in \\arg \\max_{x \\in \\mathcal{X}_0} \n    f(x,y^\\star(x))\\}')
('11', '\\mathcal{X}^*_{\\text{p}}')
('11', 'A(\\cdot)')
('11', '\\mathcal{X}')
('11', '\\mathcal{X}^* = \\{ x \\in \\mathcal{X}^*_{\\text{p}} \\ | \\ A(x) = 0 \\}')
('11', '\\mathcal{X}^*')
('11', 'f^{AL}(x,y) = f(x,y) - A(x)')
('11', '\\begin{aligned}\n        x \\in \\mathcal{X}_0 \\Longleftrightarrow \\inf_{y \\in \\mathcal{Y}} f^{AL}(x,y) > -\\infty.\n    \n\\end{aligned}')
('11', 'x \\in \\mathcal{X}_0')
('11', '\\begin{aligned}\n        x \\in \\mathcal{X}^* \\Longleftrightarrow x \\in \\arg\\max_{x \\in \\mathcal{X}_0} \\min_{y \\in \\mathcal{Y}} f^{AL}(x,y).\n    \n\\end{aligned}')
('11', 'x')
('11', 'f^{AL}(x,y)')
('11', 'f(x,y)')
('11', '\\inf_{y \\in \\mathcal{Y}} f(x,y) > -\\infty \\Longleftrightarrow \\inf_{y \\in \\mathcal{Y}} f^{AL}(x,y) > -\\infty')
('11', 'x \\in \\mathcal{X}_0')
('11', '\\arg \\min_{y \\in \\mathcal{Y}} f(x, y) =  \\arg \\min_{y \\in \\mathcal{Y}} f^{AL}(x, y)')
('11', 'x \\in \\mathcal{X}_0')
('11', 'y^*(x)')
('11', 'y \\in \\mathcal{Y}')
('11', 'f(x, y^*(x)) = \\min_{y \\in \\mathcal{Y}} f(x, y)')
('11', 'x^* \\in \\mathcal{X}^*')
('11', '\\begin{aligned}\n     &f(x^*, y^*(x^*)) \\geq f(x, y^*(x)), \\  \\forall x \\in \\mathcal{X}_0.\n    \\\\\n    \\Longrightarrow & f(x^*, y^*(x^*)) - A(x^*) \\geq f(x, y^*(x)) - A(x), \\  \\forall x \\in \\mathcal{X}_0.\n    \\\\\n    \\Longrightarrow & f^{AL}(x^*, y^*(x^*))\\geq f^{AL}(x, y^*(x)), \\  \\forall x \\in \\mathcal{X}_0.\n    \\\\\n    \\Longrightarrow & \\min_{y \\in \\mathcal{Y}} f^{AL}(x^*, y)\\geq \\min_{y \\in \\mathcal{Y}} f^{AL}(x, y), \\  \\forall x \\in \\mathcal{X}_0.\n    \\\\\n     \\Longrightarrow & x^* \\in \\arg\\max_{x \\in \\mathcal{X}_0} \\min_{y \\in \\mathcal{Y}} f^{AL}(x,y).\n\\end{aligned}')
('11', 'x_0 \\in \\arg\\max_{x \\in \\mathcal{X}_0} \\min_{y \\in \\mathcal{Y}} f^{AL}(x,y)')
('11', '\\begin{aligned}\n\\label{eq:def_optimal_solution_of_f_AL}\n\\begin{split}\n     & \\min_{y \\in \\mathcal{Y}} f^{AL}(x_0, y)\\geq \\min_{y \\in \\mathcal{Y}} f^{AL}(x, y), \\  \\forall x \\in \\mathcal{X}_0. \\\\\n     \\Longrightarrow & f^{AL}(x_0, y^*(x_0))  \\geq  f^{AL}(x, y^*(x)), \\  \\forall x \\in \\mathcal{X}_0.\n\\end{split}\n\\end{aligned}')
('11', 'x^*  \\in \\mathcal{X}^* \\subseteq \\mathcal{X}_0')
('11', 'f(x^*, y^*(x^*)) \\geq f(x_0, y^*(x_0))')
('11', '-A(x^*) \\geq -A(x_0)')
('11', 'x_0 \\notin \\mathcal{X}^*')
('11', 'f(x^*, y^*(x^*)) > f(x_0, y^*(x_0))')
('11', 'x_0 \\notin \\mathcal{X}^*_{\\text{p}}')
('11', '-A(x^*) > -A(x_0)')
('11', 'x_0 \\in \\mathcal{X}^*_{\\text{p}}\\backslash \\mathcal{X}^*')
('11', '\\begin{aligned}\n    f(x^*, y^*(x^*)) - A(x^*) > f(x_0, y^*(x_0)) - A(x_0) \\Longrightarrow f^{AL}(x^*, y^*(x^*)) > f^{AL}(x_0, y^*(x_0)),\n\\end{aligned}')
('11', 'x_0 \\in \\mathcal{X}^*')
