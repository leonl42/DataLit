('2.0', '{K}')
('2.0', 't_i')
('2.0', '\\begin{aligned}\n    \\lambda(t \\mid \\mathcal{H}_{t}) = \\lim\\limits_{\\Delta t\\downarrow 0} \\frac{\\mathbb{E}[N(t+\\Delta t)-N(t) \\mid \\mathcal{H}_{t}]}{\\Delta t},\n\\end{aligned}')
('2.0', '\\mathcal{H}_{t} = \\{t_i: t_i < t\\}')
('2.0', 't')
('2.0', 'p')
('2.0.0', '[0, T]')
('2.0.0', '\\smash{\\Lambda(T) = \\int_0^T \\lambda(t) \\mathop{}\\!\\mathrm{d}t}')
('2.0.0', '[0, T]')
('2.0.0.0', '\\lambda(t \\mid \\mathcal{H}_{t})')
('2.0.0.0', 'p(t \\mid \\mathcal{H}_{t})')
('2.1', '{\\bm{x}}_0')
('2.1', 'N')
('3.0', 'T=1')
('3.0', '\\begin{aligned}\n\\label{eq:forward_step}\n    \\lambda_n(t) = \n    \\underbrace{\\alpha_n \\lambda_{n-1}(t)}_{\\text{(i) Thin}} +\n    \\underbrace{(1 - \\alpha_n) \\lambda_{\\mathrm{HPP}}\n    }_{\\text{(ii) Add}} ,\n\\end{aligned}')
('3.0', '\\lambda_{0}')
('3.0', '\\lambda_{N}')
('3.0', '\\lambda_{\\mathrm{HPP}}')
('3.0', '\\lambda_{\\mathrm{HPP}}')
('3.0', '\\begin{aligned}\n\\label{eq:forward_direct}\n    \\lambda_n(t) = \\bar{\\alpha}_n \\lambda_0(t) + (1 - \\bar{\\alpha}_n) \\lambda_{\\mathrm{HPP}} ,\n\\end{aligned}')
('3.0', '\\smash{\\bar{\\alpha}_n = \\prod_j^n \\alpha_j}')
('3.0', '\\smash{\\prod_j^{N}\\alpha_j \\to 0}')
('3.0', '{N}\\to \\infty')
('3.0', '\\alpha_n')
('3.0', '1')
('3.0', '\\lambda_n')
('3.0', '\\lambda_0')
('3.0', '\\smash{{\\bm{t}}^{(0)}}')
('3.0', '\\lambda_0')
('3.0', '\\bar\\alpha_n \\lambda_0(t)')
('3.0', '\\smash{{\\bm{t}}^{(0)}}')
('3.0', '1 - \\bar\\alpha_n')
('3.0', '\\lambda_0')
('3.0', '\\smash{\\lambda_n}')
('3.0', '\\smash{{\\bm{t}}^{(0)}}')
('3.0', '{\\bm{t}}^{(0)}')
('3.0', '{\\bm{t}}^{(n)}')
('3.0', '{\\bm{t}}^{(0)}')
('3.0', '{N}')
('3.1', '{\\bm{t}}^{(0)}')
('3.1', '{\\bm{t}}^{(n)}')
('3.1', '{\\bm{t}}^{(n-1)}')
('3.1', '{\\bm{t}}^{(n-1)} \\mid {\\bm{t}}^{(0)}, {\\bm{t}}^{(n)}')
('3.1', 'n')
('3.1', '0')
('3.1', 'n')
('3.1', '0')
('3.1', 'n-1')
('3.1', 'n')
('3.1', 'n')
('3.1', 'n')
('3.1', 'n-1')
('3.1', 'n')
('3.1', '\\lambda^{(B)}(t)=\\sum_{t_i\\in({\\bm{t}}^{(0)}\\cap{\\bm{t}}^{(n)})}\\delta_{t_i}(t)')
('3.1', 'n-1')
('3.1', 'n')
('3.1', '{\\bm{t}}^{(D)}')
('3.1', 'n-1')
('3.1', 'n')
('3.1', 'n-1')
('3.1', 'n')
('3.1', '1-p')
('3.2', 'n-1')
('3.2', 'n')
('3.2.0', '{\\bm{t}}^{(n)}')
('3.2.0', 'n')
('3.2.0', 'n')
('3.2.0', 't_0=0')
('3.2.0', '\\overline{\\bm{c}}')
('3.2.0.0', 'n')
('3.2.0.0', 'H')
('3.2.0.0', 'f')
('3.2.0.0', '\\begin{aligned}\n    \\lambda^{(A\\cup C)}_\\theta(t) =K\\sum_{j=1}^H w_j f\\left(t; \\mu_j, \\sigma_j\\right),\n\\end{aligned}')
('3.2.0.0', 'w_j = \\mathrm{Softplus}(\\mathrm{MLP}_{w}([n,\\overline{\\bm{c}}]))')
('3.2.0.0', '\\mu_j = \\mathrm{Sigmoid}(\\mathrm{MLP}_{\\mu}([n,\\overline{\\bm{c}}]))')
('3.2.0.0', '\\sigma_j=\\exp(-|\\mathrm{MLP}_{\\sigma}([n,\\overline{\\bm{c}}])|)')
('3.2.0.0', 'd')
('3.2.0.0', '\\sigma \\to 0')
('3.2.0.0', 'K')
('3.2.0.0', '\\begin{aligned}\n\\label{eq:tpp_likelihood}\n    \\mathcal{L}_\\mathrm{NLL} = -\\log p({\\bm{t}}^{(A\\cup C)}) = -\\sum_{t_i\\in{\\bm{t}}^{(A\\cup C)}} \\log \\lambda^{(A\\cup C)}_\\theta(t_i) + \\int_0^T \\lambda^{(A\\cup C)}_\\theta(t) \\mathop{}\\!\\mathrm{d}t.\n\\end{aligned}')
('3.2.0.1', 'n')
('3.3', '{\\bm{t}}^{(n=N)} \\sim \\lambda_\\mathrm{HPP}')
('3.3', '\\hat{{\\bm{t}}}^{(B)} \\sim \\sum\\limits_{t_i \\in  {\\bm{t}}^{(1)}}g_{\\theta}(t_i\\mid {\\bm{e}}_i, {\\bm{c}}_i, 1)\\delta_{t_i}(t)')
('3.3', '{\\bm{t}}\\gets  \\hat{{\\bm{t}}}^{(B)} \\cup \\hat{{\\bm{t}}}^{(A\\cup C)}')
('3.3', '{\\bm{t}}')
('3.3', '\\lambda^{(A\\cup C)}_{\\bm{\\theta}}(t)')
('3.3', '\\Lambda^{(A\\cup C)}(T) = \\int_0^T \\lambda^{(A\\cup C)}_{\\bm{\\theta}}(t) \\mathop{}\\!\\mathrm{d}t')
('3.4', 'd')
('4.0', '\\lambda(t|\\mathcal{H})')
('4.0', 'p(t|\\mathcal{H})')
('5.0.0.0', 'N=100')
('5.0.0.0', '\\lambda_{\\mathrm{HPP}}=1')
('5.1.0.0', '\\pm 0.01')
('5.2', '\\Delta T')
('5.2', 'T_s \\in [\\Delta T, T-\\Delta T]')
('5.2', '[0,T_s]')
('5.2', '[T_s,T_s+\\Delta T]')
('10', '\\begin{split}\n    \\mathcal{L}_{ELBO} = \\mathbb{E}_{q} \\Big[\\underbrace{D_{KL}\\left(q({\\bm{t}}^{(N)}\\mid{\\bm{t}}^{(0)})\\parallel p({\\bm{t}}^{(N)})\\right)}_{\\mathcal{L}_{N}}- \\underbrace{\\log p_{\\theta}({\\bm{t}}^{(0)}\\mid{\\bm{t}}^{(1)})}_{\\mathcal{L}_{0}}+\\\\ \\sum_{n=2}^{N} \\underbrace{D_{KL}\\left(q({\\bm{t}}^{(n-1)}\\mid{\\bm{t}}^{(0)},{\\bm{t}}^{(n)})\\parallel p_{\\theta}({\\bm{t}}^{(n-1)}\\mid{\\bm{t}}^{(n)})\\right)}_{\\mathcal{L}_{n}}\\Big].\n\\end{split}')
('10', '[0,T]')
('10', 'p({\\bm{t}}) =\n    \\exp\\left({-\\int_0^T \\lambda(t)\\mathop{}\\!\\mathrm{d}t}\\right) \\prod_{t_i\\in {\\bm{t}}} \\lambda(t_i).')
('10', '\\boldsymbol{\\mathcal{L}_{N}}')
('10', '\\mathcal{L}_{N}')
('10', '\\boldsymbol{\\mathcal{L}_{0}}')
('10', '\\boldsymbol{\\mathcal{L}_{n}}')
('10', '\\begin{aligned}\n    D_{KL}(q\\parallel p_{\\theta}) = \\mathbb{E}_{q}\\left[\\log (q({\\bm{t}}^{(n-1)}\\mid{\\bm{t}}^{(0)},{\\bm{t}}^{(n)}))-\\log (p_{\\theta}({\\bm{t}}^{(n-1)}\\mid{\\bm{t}}^{(n)}))\\right],\n\\end{aligned}')
('10', '\\theta')
('10', '\\mathcal{L}_{n}')
('10', 'H(q,p)')
('10', 'p')
('10', 'q')
('10', 'H(q)')
('10', 'D_{KL}')
('10', 'H(q)')
('10', '\\mathbb{E}_{q}\\left[\\log(p_{\\theta}({\\bm{t}}^{(n-1)} \\mid{\\bm{t}}^{(n)}))\\right]')
('10', 'q({\\bm{t}}^{(n-1)}\\mid{\\bm{t}}^{(0)},{\\bm{t}}^{(n)})')
('10', '\\lambda_{\\theta}^{(A\\cup C)}(t)')
('10', '{\\bm{t}}^{(0)}\\setminus{\\bm{t}}^{(n)}')
('11.0', '\\begin{aligned}\n    \\lambda_n(t) = \\alpha_n \\lambda_{n-1}(t) + (1 - \\alpha_n) \\lambda_{\\text{HPP}} . \\tag{\\ref{eq:forward_step}}\n\\end{aligned}')
('11.0', '\\begin{aligned}\n    \\lambda_1(t) &= \\alpha_1 \\lambda_0(t) + (1 - \\alpha_1) \\lambda_{\\text{HPP}} \\\\\n    &= \\left(\\prod_{j=1}^{n=1} \\alpha_j\\right) \\lambda_0 + \\left(1 - \\prod_{j=1}^{n=1} \\alpha_j\\right) \\lambda_{\\text{HPP}}.\n\\end{aligned}')
('11.0', 'n-1')
('11.0', '\\begin{aligned}\n    \\lambda_{n-1}(t) = \\left(\\prod_{j=1}^{n-1} \\alpha_j\\right) \\lambda_0(t) + \\left(1 - \\prod_{j=1}^{n-1} \\alpha_j \\right) \\lambda_{\\text{HPP}},\n\\end{aligned}')
('11.0', 'n')
('11.0', '\\begin{aligned}\n    \\lambda_n(t) &= \\alpha_n \\lambda_{n-1}(t) + (1 - \\alpha_n) \\lambda_{\\text{HPP}} \\\\\n    &= \\alpha_n \\left( \\left(\\prod_{j=1}^{n-1} \\alpha_j \\right)\\lambda_0(t) + \\left( 1 - \\prod_{j=1}^{n-1} \\alpha_j \\right) \\lambda_{\\text{HPP}} \\right) + (1 - \\alpha_n) \\lambda_{\\text{HPP}} \\\\\n    &= \\left(\\prod_{j=1}^{n} \\alpha_j\\right) \\lambda_0(t) + \\left( \\alpha_n - \\prod_{j=1}^{n} \\alpha_j \\right) \\lambda_{\\text{HPP}} + (1 - \\alpha_n) \\lambda_{\\text{HPP}} \\\\\n    &= \\left(\\prod_{j=1}^{n} \\alpha_j\\right) \\lambda_0(t) + \\left( 1 - \\prod_{j=1}^{n} \\alpha_j \\right) \\lambda_{\\text{HPP}} \\\\\n    &= \\bar\\alpha_n \\lambda_0(t) + (1 - \\bar\\alpha_n) \\lambda_{\\text{HPP}} ,\n\\end{aligned}')
('11.1', 'X_1\\sim Poisson(\\lambda_1)')
('11.1', 'X_2\\sim Poisson(\\lambda_2)')
('11.1', 'X_1\\mid X_1+X_2=k')
('11.1', 'X_1\\mid X_1+X_2=k\\sim Binomial(x_1; k, \\frac{\\lambda_1}{\\lambda_1 + \\lambda_1})')
('11.1', 'X_1')
('11.1', 'X_2')
('11.1', '\\begin{aligned}\n    P(X_1=x_1, X_2=x_2) = e^{-(\\lambda_1)}\\frac{\\lambda_1^{x_1}}{x_1!} e^{-\\lambda_2}\\frac{\\lambda_2^{x_2}}{x_2!},\n\\end{aligned}')
('11.1', 'P(X_1=x_1, X_2=x_2, Y=k)')
('11.1', 'x_1+x_2=k')
('11.1', 'Y = X_1+X_2')
('11.1', '\\lambda_1 + \\lambda_2')
('11.1', 'P(Y=k)= e^{-(\\lambda_1 + \\lambda_2)}\\frac{(\\lambda_1 + \\lambda_2)^k}{k!}')
('11.1', 'P(X_1=x_1\\mid Y=k)')
('11.1', '\\begin{aligned}\n    P(X_1=x_1\\mid Y=k) &= \\frac{P(X_1=x_1, X_2=x_2, Y=k)}{P(Y=k)}\\text{ if } x_1+x_2=k,\\\\\n    &= \\frac{e^{-\\lambda_1}\\frac{\\lambda_1^{x_1}}{x_1!}e^{-\\lambda_2}\\frac{\\lambda_2^{x_2}}{x_2!}}{e^{-(\\lambda_1 + \\lambda_2)}\\frac{(\\lambda_1 + \\lambda_2)^k}{k!}}\\text{ if } x_1+x_2=k,\\\\\n    &= \\frac{k!}{x_1!x_2!}\\frac{\\lambda_1^{x_1}\\lambda_2^{x_2}}{(\\lambda_1 + \\lambda_2)^k}\\text{ if } x_1+x_2=k,\\\\\n    & =\\frac{k!}{x_1!(k-x_1)!}\\frac{\\lambda_1^{x_1}}{(\\lambda_1 + \\lambda_2)^{x_1}}\\frac{\\lambda_2^{k-x_1}}{(\\lambda_1 + \\lambda_2)^{k-x_1}}\\text{ if } x_1+x_2=k,\\\\\n    & =\\frac{k!}{x_1!(k-x_1)!}\\left(\\frac{\\lambda_1}{(\\lambda_1 + \\lambda_2)}\\right)^{x_1}\\left(1-\\frac{\\lambda_1}{(\\lambda_1 + \\lambda_2)}\\right)^{(k-x_1)}\\text{ if } x_1+x_2=k,\n\\end{aligned}')
('11.1', 'x_2 = k-x_1')
('11.1', '\\frac{\\lambda_2}{(\\lambda_1 + \\lambda_2)} = 1- \\frac{\\lambda_1}{(\\lambda_1 + \\lambda_2)}')
('11.1', 'P(X_1=x_1\\mid Y=k)')
('11.1', 'p=\\frac{\\lambda_1}{(\\lambda_1 + \\lambda_2)}.')
('12.0', '[0,100]')
('13.0', '\\{0.01, 0.001\\}')
('13.0', '\\{8, 16\\}')
('13.0', '\\{10, 20\\}')
('13.0', '\\{2, 3\\}')
