('1', 'p(\\text{context} \\mid \\text{representations})')
('1', 'p(\\text{representations} \\mid \\text{context})')
('1', 'p(\\text{context} \\mid \\text{representations})')
('1', 'p(K_l | Q_{t, l})')
('1', 'K_l')
('1', 'Q_{t,l}')
('1', 'l')
('1', 't')
('1', 'E(K_l; Q_{t,l})')
('2.0', '{\\boldsymbol x}_0\\sim p_{data}({\\boldsymbol x}_0)')
('2.0', 'p({\\boldsymbol x}_t|{\\boldsymbol x}_0)')
('2.0', '{\\boldsymbol x}_t = \\sqrt{\\bar\\alpha_t}{\\boldsymbol x}_0 + \\sqrt{1-\\bar\\alpha_t}{\\boldsymbol z}_t,')
('2.0', '{\\boldsymbol z}_t\\sim\\mathcal{N}(0, \\boldsymbol{I})')
('2.0', 't\\in [0, 1]')
('2.0', '\\beta_t')
('2.0', 't')
('2.0', '\\bar\\alpha_t := \\prod_{i=1}^t \\alpha_t,\\, \\alpha_t := 1 - \\beta_t')
('2.0', '{\\boldsymbol \\epsilon}_{\\theta^*}')
('2.0', '\\label{eqn:train}\n    \\theta^* = \\mathop{\\mathrm{argmin}}_{\\theta} \\mathrm{E}_{{\\boldsymbol x}_t\\sim p({\\boldsymbol x}_t|{\\boldsymbol x}_0),{\\boldsymbol x}_0\\sim p_{data}({\\boldsymbol x}_0),{\\boldsymbol \\epsilon}\\sim \\mathcal{N}(0, \\mathbf{I})} \\left[\\|{\\boldsymbol \\epsilon}_{\\theta}({\\boldsymbol x}_t, t) - {\\boldsymbol \\epsilon}\\|^2_2 \\right],')
('2.0', 'q({\\boldsymbol x}_{t-1}|{\\boldsymbol x}_t, {\\boldsymbol x}_{\\theta^*}({\\boldsymbol x}_t, t))')
('2.0', '\\begin{aligned}\n\\label{eq:reverse}\n    {\\boldsymbol x}_{t-1}=\\frac{1}{\\sqrt{\\alpha_t}}\\Big{(}{\\boldsymbol x}_t-\\frac{1-\\alpha_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\boldsymbol{\\epsilon}_{\\theta^*}({\\boldsymbol x}_t,t)\\Big{)}+\\sigma_t\\boldsymbol{z}_t,\n\\end{aligned}')
('2.0', '{\\boldsymbol z}_t\\sim{\\mathcal N}(0,{\\boldsymbol I})')
('2.0', '\\sigma^2')
('2.0', '\\beta')
('2.0', '{\\boldsymbol x}_0')
('2.0', '{\\boldsymbol x}_{T}\\sim{\\mathcal N}(0,{\\boldsymbol I})')
('2.1', 'N')
('2.1', '{\\boldsymbol v}')
('2.1', '\\mathop{\\mathrm{logsumexp}}')
('2.1', '\\mathop{\\mathrm{softmax}}')
('2.1', '\\begin{aligned}\n\\mathop{\\mathrm{logsumexp}}({\\boldsymbol v},\\beta) \\coloneqq \\textstyle \\beta^{-1} \\log(\\sum_{i = 1}^N \\exp(v_i)), &\\quad\n\\mathop{\\mathrm{softmax}}({\\boldsymbol v}) \\coloneqq \\exp({\\boldsymbol v}- \\mathop{\\mathrm{logsumexp}}({\\boldsymbol v},1)).\n\\end{aligned}')
('2.1', 'v_i')
('2.1', 'i')
('2.1', '{\\boldsymbol v}')
('2.1', '{\\boldsymbol A}')
('2.1', '\\mathop{\\mathrm{logsumexp}}_i({\\boldsymbol A})')
('2.1', '\\mathop{\\mathrm{softmax}}_i({\\boldsymbol A})')
('2.1', 'i')
('2.1', '{\\boldsymbol A}')
('2.1', 'i=1')
('2.1', '\\mathop{\\mathrm{softmax}}_i({\\boldsymbol A})')
('2.1', '1')
('2.1', '{\\boldsymbol \\zeta}\\in \\mathbb{R}^d')
('2.1', 'N')
('2.1', '{\\boldsymbol X}= [{\\boldsymbol x}_1 \\dots, {\\boldsymbol x}_N] \\in \\mathbb{R}^{d \\times N}')
('2.1', '\\beta > 0')
('2.1', '\\label{eq: hopfield energy function}\n    E({\\boldsymbol \\zeta}; {\\boldsymbol X}) = \\frac{1}{2} {\\boldsymbol \\zeta}^T {\\boldsymbol \\zeta}- \\mathop{\\mathrm{logsumexp}}({\\boldsymbol X}^T {\\boldsymbol \\zeta}, \\beta).')
('2.1', '\\boldsymbol{\\mathcal E}')
('2.1', 't')
('2.1', 'f: {\\mathbb R}^d \\rightarrow {\\mathbb R}^d')
('2.1', '\\label{eq: hopfield attention}\n    {\\boldsymbol \\zeta}^{\\text{new}} = f({\\boldsymbol \\zeta}) = {\\boldsymbol X}\\mathop{\\mathrm{softmax}}(\\beta {\\boldsymbol X}^T {\\boldsymbol \\zeta})\n    % \\boldEc \\leftarrow f(\\boldEc) = X^T \\softmax(\\beta X  \\boldEc).')
('2.1', '{\\boldsymbol \\zeta}^{(t+1)} = f({\\boldsymbol \\zeta}^{(t)})')
('2.1', 'E({\\boldsymbol \\zeta}^{(t)}) \\rightarrow E({\\boldsymbol \\zeta}^*)')
('2.1', 't \\rightarrow \\infty')
('2.1', '{\\boldsymbol \\zeta}^*')
('2.1', '\\eta=1')
('2.1', '\\label{eq: hopfield gradient descent}\n    {\\boldsymbol \\zeta}\\leftarrow {\\boldsymbol \\zeta}- \\eta\\nabla_{{\\boldsymbol \\zeta}} \\mathop{\\mathrm{E}}({\\boldsymbol \\zeta}; {\\boldsymbol X}) =  {\\boldsymbol \\zeta}- \\eta({\\boldsymbol \\zeta}- {\\boldsymbol X}\\mathop{\\mathrm{softmax}}(\\beta {\\boldsymbol X}^T {\\boldsymbol \\zeta})).')
('2.1', '{\\boldsymbol y}_i, {\\boldsymbol r}_i \\in {\\mathbb R}^d')
('2.1', '{\\boldsymbol W}_K, {\\boldsymbol W}_Q \\in {\\mathbb R}^{d \\times d_H}')
('2.1', '{\\boldsymbol y}_i')
('2.1', '{\\boldsymbol r}_i')
('2.1', '{\\boldsymbol x}_i = {\\boldsymbol W}_K^T {\\boldsymbol y}_i \\in {\\mathbb R}^{d_H}')
('2.1', '{\\boldsymbol \\zeta}_i = {\\boldsymbol W}_Q^T {\\boldsymbol r}_i \\in {\\mathbb R}^{d_H}')
('2.1', '{\\boldsymbol Y}= ({\\boldsymbol y}_1, \\dots, {\\boldsymbol y}_N)^T \\in {\\mathbb R}^{N \\times d}')
('2.1', '{\\boldsymbol R}= ({\\boldsymbol r}_1, \\dots, {\\boldsymbol r}_S)^T \\in {\\mathbb R}^{S \\times d}')
('2.1', '{\\boldsymbol X}^T = {\\boldsymbol K}= {\\boldsymbol Y}{\\boldsymbol W}_K \\in {\\mathbb R}^{N \\times d_H}')
('2.1', '{\\boldsymbol Q}= {\\boldsymbol R}{\\boldsymbol W}_Q \\in {\\mathbb R}^{S \\times d_H}')
('2.1', '{\\boldsymbol X}^T = {\\boldsymbol K}')
('2.1', '{\\boldsymbol \\zeta}={\\boldsymbol q}_i')
('2.1', 'i')
('2.1', '{\\boldsymbol Q}^T= {\\boldsymbol K}^T \\mathop{\\mathrm{softmax}}_1(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T) \\in {\\mathbb R}^{d_H \\times S}')
('2.1', '{{\\boldsymbol Q}} = \\mathop{\\mathrm{softmax}}_2(\\beta {\\boldsymbol Q}{\\boldsymbol K}^T) {\\boldsymbol K}')
('2.1', '{\\boldsymbol V}\\in {\\mathbb R}^{N \\times d_V}')
('2.1', '{\\boldsymbol V}= {\\boldsymbol Y}{\\boldsymbol W}_K {\\boldsymbol W}_V = {\\boldsymbol K}{\\boldsymbol W}_V')
('2.1', '{\\boldsymbol K}')
('2.1', '\\mathop{\\mathrm{softmax}}_2')
('2.1', '\\label{eq: transformer attention}\n{\\boldsymbol Q}^{new} = \\mathop{\\mathrm{softmax}}_2 (\\beta{{\\boldsymbol Q}{\\boldsymbol K}^T}) {\\boldsymbol V},\n% Z = V^T \\softmax(\\beta K Q^T)')
('2.1', '\\beta=1/\\sqrt{d_H}')
('3.0', 'L')
('3.0', 'l')
('3.0', 't')
('3.0', '{\\boldsymbol Q}_{t,l} \\in {\\mathbb R}^{P_l^2 \\times  d_l }')
('3.0', '{\\boldsymbol K}_l \\in {\\mathbb R}^{N \\times  d_l }')
('3.0', '{\\boldsymbol V}_l \\in {\\mathbb R}^{N \\times d_l }')
('3.0', 'P_l')
('3.0', 'l')
('3.0', '{\\boldsymbol C}\\in {\\mathbb R}^{N \\times d_c}')
('3.0', '{\\boldsymbol K}_l')
('3.0', '{\\boldsymbol V}_l')
('3.0', '{\\boldsymbol W}_{K, l}, {\\boldsymbol W}_{V, l} \\in {\\mathbb R}^{d_c \\times d_l}')
('3.0', '{\\boldsymbol K}_l= {\\boldsymbol C}{\\boldsymbol W}_{K, l}')
('3.0', '{\\boldsymbol V}_l= {\\boldsymbol C}{\\boldsymbol W}_{V, l}')
('3.0', 't')
('3.0', 'l')
('3.0', '{\\boldsymbol Q}_{t, l}')
('3.0', '{\\boldsymbol K}_l')
('3.0', '{\\boldsymbol C}')
('3.0', '{\\boldsymbol Q}_{t, l}')
('3.0', '{\\boldsymbol K}')
('3.0', 'p({\\boldsymbol K}\\:\\vert\\: {\\boldsymbol Q}) = p({\\boldsymbol Q}\\:\\vert\\: {\\boldsymbol K}) p({\\boldsymbol K}) / p({\\boldsymbol Q})')
('3.0', 'p({\\boldsymbol Q}\\:\\vert\\: {\\boldsymbol K})')
('3.0', 'p({\\boldsymbol Q})')
('3.0', '{\\boldsymbol C}')
('3.0', '\\begin{split}\n\\label{eq: grad bayes rule}\n    \\nabla_{\\boldsymbol K}\\log p({\\boldsymbol K}\\:\\vert\\: {\\boldsymbol Q}) &= \\nabla_{\\boldsymbol K}\\log p({\\boldsymbol Q}\\:\\vert\\: {\\boldsymbol K}) + \\nabla_{\\boldsymbol K}\\log p({\\boldsymbol K}) = - \\big( \\nabla_{\\boldsymbol K}\\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K}) + \\nabla_{\\boldsymbol K}\\mathop{\\mathrm{E}}({\\boldsymbol K}) \\big).\n\\end{split}')
('3.0', '{\\boldsymbol K}')
('3.0', '\\label{eq: E(Q|K)}\n\\begin{split}\n    \\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K}) &= \\frac{\\alpha}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T) - \\sum_{i=1}^N \\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta),\n\\end{split}')
('3.0', '{\\boldsymbol k}_i')
('3.0', 'i')
('3.0', '{\\boldsymbol K}')
('3.0', '\\alpha \\geq 0')
('3.0', '\\mathop{\\mathrm{diag}}({\\boldsymbol A}) = \\sum_{i=1}^N A_{i,i}')
('3.0', '{\\boldsymbol A}\\in {\\mathbb R}^{N \\times N}')
('3.0', '\\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)')
('3.0', '{\\boldsymbol q}_j,j=1,\\cdots,P^2')
('3.0', '{\\boldsymbol k}_i')
('3.0', '{j^*} = \\arg \\max_j {\\boldsymbol q}_j{\\boldsymbol k}_i^T')
('3.0', '- \\mathop{\\mathrm{logsumexp}}')
('3.0', '{\\boldsymbol k}_i')
('3.0', '{\\boldsymbol q}_{j^*}')
('3.0', '{\\boldsymbol k}_i')
('3.0', '{\\boldsymbol q}_{j^*}')
('3.0', '\\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T)')
('3.0', '{\\boldsymbol k}_i')
('3.0', '\\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)')
('3.0', '{\\boldsymbol Q}')
('3.0', '\\mathop{\\mathrm{E}}({\\boldsymbol K})')
('3.0', '\\label{eq: E(K)}\n\\begin{split}\n    \\mathop{\\mathrm{E}}({\\boldsymbol K}) = \\mathop{\\mathrm{logsumexp}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T), 1 \\Big)\n          = \\log \\sum_{i=1}^N \\exp \\Big(\\frac{1}{2} {\\boldsymbol k}_i {\\boldsymbol k}_i^T \\Big).\n\\end{split}')
('3.0', '\\| {\\boldsymbol k}_i \\|')
('3.0', '\\mathop{\\mathrm{E}}({\\boldsymbol K})')
('3.0', '\\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T)')
('3.0', '{\\boldsymbol K}')
('3.0', '{\\boldsymbol C}')
('3.0', '{\\boldsymbol Q}')
('3.0', '{\\boldsymbol K}')
('3.0', '{\\boldsymbol C}')
('3.0', '\\begin{split}\n\\label{eq: grad log posterior}\n% \\nabla_K \\log p(K \\given[] Q) &= \\softmax \\big(\\beta QK^T \\big)^T Q - K \\odot \\bigg(\\alpha \\cdot \\mathbbm{1} + \\softmax \\Big(\\frac{1}{2} \\diag(KK^T) \\Big) \\bigg),\n\\nabla_{\\boldsymbol K}\\log p({\\boldsymbol K}\\:\\vert\\: {\\boldsymbol Q}) &= \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T \\big){\\boldsymbol Q}-  \\bigg(\\alpha{\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T) \\Big) \\Big) \\bigg){\\boldsymbol K},\n\\end{split}')
('3.0', '{\\boldsymbol {\\mathcal D}}(\\cdot)')
('3.0', '{\\boldsymbol C}')
('3.0', '\\label{eq: theory context update rule}\n% C_{n+1} = C_n + \\gamma \\bigg( \\softmax \\big(\\beta QK^T \\big)^TQ - K \\odot \\bigg(\\alpha \\cdot \\mathbbm{1} + \\softmax \\Big(\\frac{1}{2} \\diag(KK^T) \\Big) \\bigg) W_K^T,\n{\\boldsymbol C}_{n+1} = {\\boldsymbol C}_n + \\gamma  \\bigg( \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T \\big) {\\boldsymbol Q}-  \\bigg(\\alpha{\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T ) \\Big) \\Big) \\bigg){\\boldsymbol K}\\bigg){\\boldsymbol W}_K^T,')
('3.0', '\\gamma > 0')
('3.0', '\\alpha')
('3.0', '\\alpha=0')
('3.0', '\\gamma_{\\mathop{\\mathrm{attn}}}')
('3.0', '\\gamma_{\\mathop{\\mathrm{reg}}}')
('3.0', '\\label{eq: real context update rule}\n% C_{n+1} = C_n + \\bigg( \\gamma_{\\attn} \\underbrace{\\softmax \\big(\\beta QK^T \\big)^TQ}_{\\textbf{Attention}} - \\gamma_{\\reg} \\underbrace{K \\odot \\softmax \\Big(\\frac{1}{2} \\diag(KK^T)}_{\\textbf{Regularization}} \\Big) \\bigg) W_K^T,\n{\\boldsymbol C}_{n+1} = {\\boldsymbol C}_n + \\gamma_{\\mathop{\\mathrm{attn}}} \\underbrace{\\mathop{\\mathrm{softmax}}_2 \\big(\\beta  {\\boldsymbol K}{\\boldsymbol Q}^T \\big){\\boldsymbol Q}{\\boldsymbol W}_K^T }_{\\textbf{Attention}}  - \\gamma_{\\mathop{\\mathrm{reg}}} \\underbrace{ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T ) \\Big) \\Big) {\\boldsymbol K}{\\boldsymbol W}_K^T}_{\\textbf{Regularization}},')
('3.0', '{\\boldsymbol C}_{n+1}')
('3.0', 't')
('3.0', '{\\boldsymbol C}_{1, t}')
('3.0', '{\\boldsymbol C}_{CLIP}')
('3.0', 'n')
('3.0', '{\\boldsymbol C}_{n, t}')
('3.0', '1 \\leq n \\leq L')
('3.0', '{\\boldsymbol C}_{n+1, t}')
('3.0', '{\\boldsymbol C}_{n+1, t}')
('3.0', '(n+1)')
('3.0', '{\\boldsymbol C}_{L+1, t}')
('3.0', 't')
('3.0', 't+1')
('3.0', '{\\boldsymbol Q}_t')
('3.0', '{\\boldsymbol Q}_{t+1}')
('3.0', '{\\boldsymbol C}_{1, t+1}')
('3.0', '{\\boldsymbol C}_{CLIP}')
('3.1', '{\\boldsymbol x}')
('3.1', '{\\boldsymbol c}_1, \\dots, {\\boldsymbol c}_n')
('3.1', '{\\boldsymbol x}')
('3.1', '\\label{eq: composition example}\n    p({\\boldsymbol x}\\:\\vert\\: {\\boldsymbol c}_1, \\dots, {\\boldsymbol c}_n) = \\prod_{i} p({\\boldsymbol x}\\:\\vert\\: {\\boldsymbol c}_i) \\propto e^{- \\sum_i \\mathop{\\mathrm{E}}({\\boldsymbol x}\\:\\vert\\:{\\boldsymbol c}_i)},')
('3.1', '\\mathop{\\mathrm{E}}({\\boldsymbol x}\\:\\vert\\:{\\boldsymbol c}_i)')
('3.1', '{\\boldsymbol c}_i')
('3.1', '{\\boldsymbol C}_1')
('3.1', '{\\boldsymbol C}= \\{{\\boldsymbol C}_2, \\dots, {\\boldsymbol C}_{M}\\}')
('3.1', '{\\boldsymbol K}_{l, s}')
('3.1', 's')
('3.1', 'l')
('3.1', '{\\boldsymbol K}_{l, s} = {\\boldsymbol C}_s{\\boldsymbol W}_{K, l} , \\forall s \\in \\{1, 2, \\dots, M\\}')
('3.1', 'l')
('3.1', '{\\boldsymbol K}_s')
('3.1', '{\\boldsymbol Q}')
('3.1', '\\label{eq: query E}\n\\begin{split}\n    \\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K}_s) &= \\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol Q}{\\boldsymbol Q}^T) - \\sum_{i=1}^{P^2} \\mathop{\\mathrm{logsumexp}}({\\boldsymbol K}_s{\\boldsymbol q}_{i}^T  , \\beta),\n\\end{split}')
('3.1', '\\hat{\\mathop{\\mathrm{E}}}')
('3.1', '{\\boldsymbol C}')
('3.1', '\\label{eq: composition E}\n\\begin{split}\n    \\hat{\\mathop{\\mathrm{E}}}({\\boldsymbol Q}; \\{{\\boldsymbol K}_s\\}_{s=1}^M) &= \\frac{1}{M} \\sum_{s=1}^M \\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K}_s) \\\\\n                                &= \\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol Q}{\\boldsymbol Q}^T) - \\frac{1}{M} \\sum_{s=1}^M \\sum_{i=1}^{P^2} \\mathop{\\mathrm{logsumexp}}({\\boldsymbol K}_s {\\boldsymbol q}_{i}^T, \\beta),\n\\end{split}')
('3.1', '\\label{eq: update of composition E}\n\\begin{split}\n% Q^{new} = \\frac{1}{M} \\sum_{s=1}^{M} \\alphab_s \\softmax \\big(\\beta QK^T \\big) V,\n{\\boldsymbol Q}^{new}_{TF} = \\frac{1}{M} \\sum_{s=1}^{M} \\alpha_s \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol Q}_{TF} {\\boldsymbol K}_{TF,s}^T \\big) {\\boldsymbol V}_{TF},\n\\end{split}')
('3.1', '{\\boldsymbol Q}_{TF}')
('3.1', '{\\boldsymbol K}_{TF,s}')
('3.1', '{\\boldsymbol V}_{TF}')
('3.1', 's')
('3.1', '\\alpha_s')
('3.1', '\\alpha_s<0')
('3.1', '\\beta=1/\\sqrt{d_H}')
('3.1', '{\\boldsymbol \\epsilon}_{\\theta^*}')
('4', 'E(Q; K)')
('4.0', 'E({\\boldsymbol Q}; {\\boldsymbol K})')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('6', 'c')
('6', '{\\boldsymbol W}\\in {\\mathbb R}^{m\\times n}')
('6', '\\begin{aligned}\n\\label{eq:cW}\n\\frac{\\partial c}{\\partial {\\boldsymbol W}}= \\begin{bmatrix} \\frac{\\partial c}{\\partial w_{11} } & \\cdots &  \\frac{\\partial c}{\\partial w_{1n}}  \\\\\n \\vdots & \\ddots & \\vdots \\\\ \\frac{\\partial c}{\\partial w_{m1} }& \\cdots & \\frac{\\partial c}{\\partial w_{mn} }\\end{bmatrix} \\in {\\mathbb R}^{m\\times n} .\n\\end{aligned}')
('6', '\\begin{aligned}\n\\label{eq:ax}\n\\frac{\\partial{\\boldsymbol a}^\\top{\\boldsymbol x}}{\\partial {\\boldsymbol x}} &= \\frac{\\partial{\\boldsymbol x}^\\top{\\boldsymbol a}}{\\partial {\\boldsymbol x}} = {\\boldsymbol a}.\n\\end{aligned}')
('6', 'c')
('6', '{\\boldsymbol W}\\in {\\mathbb R}^{m\\times n}')
('6', '\\begin{aligned}\n\\frac{\\partial c}{\\partial {\\boldsymbol W}} := \\textsc{UnVec}\\left(\\frac{\\partial c}{\\partial \\textsc{Vec}({\\boldsymbol W})}\\right) \\in {\\mathbb R}^{m\\times n},\n\\end{aligned}')
('6', '\\textsc{Vec}()')
('6', '\\textsc{UnVec}()')
('6', '{\\boldsymbol x}\\in {\\mathbb R}^m')
('6', '{\\boldsymbol y}\\in {\\mathbb R}^n')
('6', '\\begin{aligned}\n\\label{eq:vec2vec}\n\\frac{\\partial {\\boldsymbol y}}{\\partial {\\boldsymbol x}}= \\begin{bmatrix} \\frac{\\partial y_1}{\\partial x_{1} } & \\cdots &  \\frac{\\partial y_n}{\\partial x_1}  \\\\\n \\vdots & \\ddots & \\vdots \\\\ \\frac{\\partial y_1}{\\partial x_m }& \\cdots & \\frac{\\partial y_n}{\\partial x_{m} }\\end{bmatrix} \\in {\\mathbb R}^{m\\times n} .\n\\end{aligned}')
('6', '\\begin{aligned}\n\\label{eq:chain}\n\\frac{\\partial c({\\boldsymbol g}({\\boldsymbol u}))}{\\partial {\\boldsymbol x}} = \\frac{\\partial {\\boldsymbol u}}{\\partial {\\boldsymbol x}}\\frac{\\partial {\\boldsymbol g}({\\boldsymbol u})}{\\partial {\\boldsymbol u}}\\frac{\\partial c({\\boldsymbol g})}{\\partial {\\boldsymbol g}}  .\n\\end{aligned}')
('6', '\\begin{aligned}\n \\textsc{Vec}({\\boldsymbol A}{\\boldsymbol B}{\\boldsymbol C})&=({\\boldsymbol C}^T\\otimes {\\boldsymbol A})\\textsc{Vec}({\\boldsymbol B}) \\label{eq:ABC}\\\\\n ({\\boldsymbol A}\\otimes {\\boldsymbol B})^T&={\\boldsymbol A}^T\\otimes {\\boldsymbol B}^T\n \n\\end{aligned}')
('6', '{\\boldsymbol x}\\in {\\mathbb R}^{N}')
('6', '\\begin{aligned}\n\\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol x}, \\beta)}{\\partial{\\boldsymbol x}}&=\\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol x})\n\\end{aligned}')
('6', '\\begin{aligned}\n\\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol x}, \\beta)}{\\partial{\\boldsymbol x}}&=\\beta^{-1}\\frac{\\partial\\log \\sum_{j=1}^{N} \\exp (\\beta x_j)}{\\partial {\\boldsymbol x}}\n=\\begin{bmatrix}\n\\frac{\\exp(\\beta x_1)}{\\sum_{j=1}^{N} \\exp(\\beta x_j) } \\\\\n\\vdots \\\\\n\\frac{\\exp(\\beta x_{P^2})}{\\sum_{j=1}^{N} \\exp(\\beta x_j) } \n\\end{bmatrix}\n\\\\\n&=\\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol x})\n\\end{aligned}')
('6', '{\\boldsymbol k}_i')
('6', 'i')
('6', '{\\boldsymbol K}\\in {\\mathbb R}^{N\\times d}')
('6', '\\begin{aligned}\n\\frac{\\partial {\\boldsymbol k}_i{\\boldsymbol k}_i^T}{\\partial{\\boldsymbol K}}=2{\\boldsymbol e}_N^i({\\boldsymbol e}_N^i)^T{\\boldsymbol K}%, &\\quad \\frac{\\partial \\kb_i\\kb_i^T}{\\partial\\vect(\\K)}=2\\kb_i^T \\otimes (\\e_N^i)^T,\n\\end{aligned}')
('6', '{\\boldsymbol e}_N^i')
('6', 'N')
('6', 'i')
('6', '{\\boldsymbol k}_i^T')
('6', '{\\boldsymbol K}^T{\\boldsymbol e}^i')
('6', '{\\boldsymbol k}_i{\\boldsymbol k}_i^T=({\\boldsymbol e}_N^i)^T{\\boldsymbol K}{\\boldsymbol K}^T{\\boldsymbol e}_N^i')
('6', '{\\boldsymbol K}^T{\\boldsymbol e}_N^i=(({\\boldsymbol e}_N^i)^T\\otimes {\\boldsymbol I}_d)\\textsc{Vec}({\\boldsymbol K}^T)')
('6', '\\frac{\\partial {\\boldsymbol K}^T{\\boldsymbol e}^i}{\\partial \\textsc{Vec}({\\boldsymbol K}^T)}=({\\boldsymbol e}_N^i \\otimes {\\boldsymbol I}_d)')
('6', '{\\boldsymbol I}_d')
('6', 'd\\times d')
('6', '\\begin{aligned}\n\\frac{\\partial {\\boldsymbol k}_i{\\boldsymbol k}_i^T}{\\partial\\textsc{Vec}({\\boldsymbol K}^T)}&=\\frac{\\partial{\\boldsymbol K}^T{\\boldsymbol e}^i}{\\partial \\textsc{Vec}({\\boldsymbol K}^T)}\\frac{\\partial {\\boldsymbol k}_i{\\boldsymbol k}_i^T}{\\partial{\\boldsymbol K}^T{\\boldsymbol e}^i}=\n2({\\boldsymbol e}_N^i \\otimes {\\boldsymbol I}_d) {\\boldsymbol K}^T{\\boldsymbol e}_N^i\n\\end{aligned}')
('6', '\\begin{aligned}\n\\textsc{UnVec}\\left(\\frac{\\partial {\\boldsymbol k}_i{\\boldsymbol k}_i^T}{\\partial\\textsc{Vec}({\\boldsymbol K}^T)}\\right)&=2\\textsc{UnVec}\\left(({\\boldsymbol e}_N^i \\otimes {\\boldsymbol I}_d) {\\boldsymbol K}^T{\\boldsymbol e}_N^i\\right)\n=2 {\\boldsymbol K}^T{\\boldsymbol e}_N^i({\\boldsymbol e}_N^i)^T\n\\end{aligned}')
('6', '\\frac{\\partial {\\boldsymbol k}_i{\\boldsymbol k}_i^T}{\\partial{\\boldsymbol K}}=2{\\boldsymbol e}_N^i({\\boldsymbol e}_N^i)^T{\\boldsymbol K}.')
('6', '\\begin{aligned}\n\\label{eq:lem1}\n\\nabla_{\\boldsymbol K}\\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)=\n{\\boldsymbol e}_N^i(\\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol Q}{\\boldsymbol k}_i^T))^T {\\boldsymbol Q}\n%\\begin{bmatrix} {\\mathbf 0}^T \\\\ \\vdots \\\\  \\softmax_2 (\\beta\\Q \\kb_i^T) \\Q \\\\ \\vdots \\\\  {\\mathbf 0}^T  \\end{bmatrix}\n\\end{aligned}')
('6', '{\\boldsymbol Q}{\\boldsymbol k}_i^T={\\boldsymbol Q}{\\boldsymbol K}^T{\\boldsymbol e}_N^i={\\boldsymbol Q}{\\boldsymbol K}^T{\\boldsymbol e}_N^i=(({\\boldsymbol e}_N^i)^T\\otimes {\\boldsymbol Q})\\textsc{Vec}({\\boldsymbol K}^T).')
('6', '\\begin{aligned}\n\\frac{\\partial {\\boldsymbol Q}{\\boldsymbol K}^T{\\boldsymbol e}^i}{\\partial \\textsc{Vec}({\\boldsymbol K}^T)}=  {\\boldsymbol e}_N^i\\otimes {\\boldsymbol Q}^T\n\\end{aligned}')
('6', '\\begin{aligned}\n\\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)}{\\partial \\textsc{Vec}({\\boldsymbol K}^T)}&=\\frac{\\partial {\\boldsymbol Q}{\\boldsymbol k}_i^T}{\\partial \\textsc{Vec}({\\boldsymbol K}^T)}\\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)}{\\partial {\\boldsymbol Q}{\\boldsymbol k}_i^T}\\\\\n&= ({\\boldsymbol e}_N^i\\otimes {\\boldsymbol Q}^T) \\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol Q}{\\boldsymbol k}_i^T)\n\\end{aligned}')
('6', '\\begin{aligned}\n\\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)}{\\partial {\\boldsymbol K}^T}  &=\\textsc{UnVec}\\left(\\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)}{\\partial \\textsc{Vec}({\\boldsymbol K}^T)}\\right) \\\\\n&=\\textsc{UnVec}\\left(({\\boldsymbol e}_N^i\\otimes {\\boldsymbol Q}^T) \\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol Q}{\\boldsymbol k}_i^T)\\right) \\\\\n&=  {\\boldsymbol Q}^T \\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol Q}{\\boldsymbol k}_i^T) ({\\boldsymbol e}_N^i)^T\n\\end{aligned}')
('6', '\\begin{aligned}\n\\frac{\\partial \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T)}{\\partial {\\boldsymbol K}} &=&2{\\boldsymbol K}\\\\\n\\frac{\\partial \\log \\sum_{i=1}^N \\exp (\\frac{1}{2} {\\boldsymbol k}_i {\\boldsymbol k}_i^T)}{\\partial {\\boldsymbol K}} &=&  \n  \\begin{bmatrix} [\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_1 & \\cdots & 0 \\\\ \\vdots & \\ddots & \\vdots \\\\ 0 & \\cdots &  [\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_N \\end{bmatrix}{\\boldsymbol K}\n\\end{aligned}')
('6', '\\mathop{\\mathrm{diag}}({\\boldsymbol A})')
('6', '{\\boldsymbol A}')
('6', '{\\boldsymbol x}_i')
('6', 'i')
('6', '{\\boldsymbol k}_i{\\boldsymbol k}_i^T/2')
('6', '[\\cdot]_i')
('6', 'i')
('6', '\\begin{aligned}\nc=\\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T)=\\sum_{i,j} K_{ij}^2\n\\end{aligned}')
('6', 'K_{ij}')
('6', '(i,j)')
('6', '\\begin{aligned}\n\\frac{\\partial c}{\\partial {\\boldsymbol K}}=2{\\boldsymbol K}.\n\\end{aligned}')
('6', '{\\boldsymbol x}')
('6', 'i')
('6', 'x_i:={\\boldsymbol k}_i{\\boldsymbol k}_i^T/2')
('6', '\\begin{aligned}\n\\frac{\\partial \\log \\sum_{i=1}^N \\exp (\\frac{1}{2} {\\boldsymbol k}_i {\\boldsymbol k}_i^T)}{\\partial {\\boldsymbol K}} &=\\sum_i \\frac{\\partial x_i}{\\partial{\\boldsymbol K}} \\frac{\\partial \\mathop{\\mathrm{logsumexp}}({\\boldsymbol x}, 1)}{\\partial x_i} \\\\\n&=  \\sum_i {\\boldsymbol e}_N^i({\\boldsymbol e}_N^i)^T{\\boldsymbol K}[\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_i  \\\\\n&=  \\sum_i {\\boldsymbol e}_N^i{\\boldsymbol k}_i[\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_i\\\\\n%\\end{align*}\n%Therefore, we have\n%\\begin{align*}\n%\\frac{\\partial \\log \\sum_{i=1}^N \\exp (\\frac{1}{2} \\kb_i \\kb_i^T)}{\\partial \\K} &=  2\\sum_i \\unvect\\left(\\kb_i^T \\otimes (\\e^i)^T[\\softmax(\\xb)]_i \\right) \\\\\n%&=2\\sum_i [\\softmax(\\xb)]_i \\e^i\\kb_i \\\\\n&=  \\begin{bmatrix} [\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_1 & \\cdots & 0 \\\\ \\vdots & \\ddots & \\vdots \\\\ 0 & \\cdots &  [\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_N \\end{bmatrix}{\\boldsymbol K}\n\\end{aligned}')
('6', '\\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K})=\\frac{\\alpha}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T) - \\sum_{i=1}^N \\mathop{\\mathrm{logsumexp}}({\\boldsymbol Q}{\\boldsymbol k}_i^T, \\beta)')
('6', 'E({\\boldsymbol K})=\\log \\sum_{i=1}^N \\exp (\\frac{1}{2} {\\boldsymbol k}_i {\\boldsymbol k}_i^T),')
('6', '\\begin{split}\n% \\nabla_K \\log p(K \\given[] Q) &= \\softmax \\big(\\beta QK^T \\big)^T Q - K \\odot \\bigg(\\alpha \\cdot \\mathbbm{1} + \\softmax \\Big(\\frac{1}{2} \\diag(KK^T) \\Big) \\bigg),\n\\nabla_{\\boldsymbol K}\\log p({\\boldsymbol K}\\:\\vert\\: {\\boldsymbol Q}) &= \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T \\big){\\boldsymbol Q}-  \\bigg( \\alpha{\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T) \\Big) \\Big) \\bigg) {\\boldsymbol K},\n\\end{split}')
('6', '{\\boldsymbol C}')
('6', '% C_{n+1} = C_n + \\gamma \\bigg( \\softmax \\big(\\beta QK^T \\big)^TQ - K \\odot \\bigg(\\alpha \\cdot \\mathbbm{1} + \\softmax \\Big(\\frac{1}{2} \\diag(KK^T) \\Big) \\bigg) W_K^T,\n{\\boldsymbol C}_{n+1} = {\\boldsymbol C}_n + \\gamma  \\bigg( \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T \\big) {\\boldsymbol Q}-  \\bigg(\\alpha{\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T ) \\Big) \\Big) \\bigg){\\boldsymbol K}\\bigg){\\boldsymbol W}_K^T,')
('6', '\\gamma > 0')
('6', '{\\boldsymbol {\\mathcal D}}(\\cdot)')
('6', '\\nabla_{\\boldsymbol K}\\log p({\\boldsymbol K}\\:\\vert\\: {\\boldsymbol Q}) = - \\big( \\nabla_{\\boldsymbol K}\\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K}) + \\nabla_{\\boldsymbol K}\\mathop{\\mathrm{E}}({\\boldsymbol K}) \\big).')
('6', '\\begin{aligned}\n    \\label{eq: grad_EQK}\n    \\nabla_{{\\boldsymbol K}} \\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K})  &= \\alpha {\\boldsymbol K}- \\sum_i {\\boldsymbol e}_N^i(\\mathop{\\mathrm{softmax}}(\\beta{\\boldsymbol Q}{\\boldsymbol k}_i^T))^T {\\boldsymbol Q}\\notag \\\\ %\\\\\\begin{bmatrix} \\softmax_2 (\\beta\\Q \\kb_1^T) \\Q \\\\  \\vdots \\\\ \\softmax_2 (\\beta\\Q \\kb_N^T) \\Q  \\end{bmatrix}  \\notag  \\\\\n    &= \\alpha {\\boldsymbol K}- \\mathop{\\mathrm{softmax}}_2(\\beta {\\boldsymbol Q}{\\boldsymbol K}^T)  {\\boldsymbol Q}\n    \n\\end{aligned}')
('6', '\\mathop{\\mathrm{E}}({\\boldsymbol K}) = \\log \\sum_{i=1}^N \\exp(\\frac{1}{2} {\\boldsymbol k}_i {\\boldsymbol k}_i^T)')
('6', '\\begin{aligned}\n            \\nabla_{{\\boldsymbol K}}  \\mathop{\\mathrm{E}}({\\boldsymbol K}) &=  \\begin{bmatrix} [\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_1 & \\cdots & 0 \\\\ \\vdots & \\ddots & \\vdots \\\\ 0 & \\cdots &  [\\mathop{\\mathrm{softmax}}({\\boldsymbol x})]_N \\end{bmatrix}{\\boldsymbol K}\n         \\\\ & ={\\boldsymbol {\\mathcal D}}\\bigg( \\mathop{\\mathrm{softmax}}\\big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T)\\big) \\bigg) {\\boldsymbol K}\n    \n\\end{aligned}')
('6', '{\\boldsymbol {\\mathcal D}}(\\cdot)')
('6', 'N')
('6', '\\mathop{\\mathrm{softmax}}')
('6', 'N \\times N')
('6', '\\mathop{\\mathrm{softmax}}')
('6', '\\begin{split}\n    % \\nabla_K \\log p(K \\given[] Q) &= \\softmax \\big(\\beta QK^T \\big)^T Q - K \\odot \\bigg(\\alpha \\cdot \\mathbbm{1} + \\softmax \\Big(\\frac{1}{2} \\diag(KK^T) \\Big) \\bigg),\n    \\nabla_{\\boldsymbol K}\\log p({\\boldsymbol K}\\:\\vert\\: {\\boldsymbol Q}) &= \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T \\big){\\boldsymbol Q}-  \\bigg( \\alpha{\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T) \\Big) \\Big) \\bigg) {\\boldsymbol K}.\n    \\end{split}')
('6', '{\\boldsymbol K}= {\\boldsymbol C}{\\boldsymbol W}_K')
('6', '{\\boldsymbol C}')
('7', 't')
('7', '{\\boldsymbol Q}{\\boldsymbol K}^T')
('7', '\\mathcal{O}(N^2)')
('7', '\\nabla_{\\boldsymbol K}E({\\boldsymbol Q}; {\\boldsymbol K})')
('7', '{\\boldsymbol C}_t \\gets {\\boldsymbol C}_{clip}')
('7', '{\\boldsymbol Q}_t, {\\boldsymbol C}_t \\gets \\text{layer}({\\boldsymbol Q}_t, {\\boldsymbol C}_t)')
('7', '{\\boldsymbol Q}_t \\gets \\text{layer}({\\boldsymbol Q}_t)')
('7', '{\\boldsymbol Q}_{t+1} \\gets {\\boldsymbol Q}_t')
('7', '{\\boldsymbol Q}_{t+1}')
('7', '{\\boldsymbol Q}, {\\boldsymbol K}, {\\boldsymbol V}\\gets {\\boldsymbol Q}{\\boldsymbol W}_q, {\\boldsymbol C}{\\boldsymbol W}_k, {\\boldsymbol C}{\\boldsymbol W}_v')
('7', '{\\boldsymbol S}= {\\boldsymbol Q}{\\boldsymbol K}^T')
('7', '{\\boldsymbol Q}\\gets \\mathop{\\mathrm{softmax}}_2(\\beta {\\boldsymbol S}){\\boldsymbol V}')
('7', '\\nabla_{\\boldsymbol K}E({\\boldsymbol Q}; {\\boldsymbol K}) = \\mathop{\\mathrm{softmax}}_2 (\\beta {\\boldsymbol S}^T){\\boldsymbol Q}')
('7', '\\nabla_{\\boldsymbol K}E({\\boldsymbol K}) = -(\\alpha {\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}(\\text{softmax}(\\frac{1}{2} \\text{diag}({\\boldsymbol K}{\\boldsymbol K}^T)))){\\boldsymbol K}')
('7', '\\Delta {\\boldsymbol C}= (\\gamma_{\\text{attn}}\\nabla_{\\boldsymbol K}E({\\boldsymbol Q};{\\boldsymbol K}) + \\gamma_{\\text{reg}} \\nabla_{\\boldsymbol K}E({\\boldsymbol K})){\\boldsymbol W}_k^T')
('7', '{\\boldsymbol C}\\gets {\\boldsymbol C}+ \\Delta {\\boldsymbol C}')
('7', '{\\boldsymbol Q}, {\\boldsymbol C}')
('7', 'M')
('7', '{\\boldsymbol Q}\\gets {\\boldsymbol Q}{\\boldsymbol W}_q')
('7', '{\\boldsymbol K}_s, {\\boldsymbol V}_s \\gets {\\boldsymbol C}_s{\\boldsymbol W}_k, {\\boldsymbol C}_s {\\boldsymbol W}_v')
('7', '{\\boldsymbol S}_s = {\\boldsymbol Q}{\\boldsymbol K}_s^T')
('7', 'Q \\gets \\frac{1}{M}\\sum_{s=1}^M \\alpha_s \\text{softmax}_2(\\beta {\\boldsymbol S}_s){\\boldsymbol V}_s')
('7', '{\\boldsymbol Q}')
('8.0', '\\alpha')
('8.0', '\\gamma_{attn}')
('8.0', '\\gamma_{reg}')
('8.0', '\\gamma_{attn}')
('8.0', '\\gamma_{reg}')
('8.0', 'C\\in \\mathrm{R}^{N\\times d_c}')
('8.0', '\\gamma_{attn}')
('8.0', '\\gamma_{reg}')
('8.0', 'N')
('8.0', '\\gamma_{\\{\\cdot\\}}')
('8.0', '\\gamma_{attn}')
('8.0', '\\gamma_{reg}')
('8.0', '\\gamma_{attn}')
('8.0', '\\gamma_{reg}')
('8.0', 't')
('8.0', '\\label{eq: lr schedule}\n\\begin{split}\n    \\text{[constant]} \\quad \\gamma(t) & = \\gamma_0 \\\\\n    \\text{[step]} \\quad \\gamma(t) & = \\gamma_0 \\cdot \\text{ReLu}(t-\\tau)\\\\\n    \\text{[exp-decay]} \\quad \\gamma(t) &= \\gamma_0\\cdot \\lambda^t \\\\\n\\end{split}')
('8.0', '\\gamma_0')
('8.0', '\\text{ReLu}(x)=0')
('8.0', 'x\\leq0')
('8.0', '\\tau')
('8.0', '\\lambda')
('8.1', '\\gamma_{attn}')
('8.1', '\\gamma_{reg}')
('8.1', '\\gamma_{attn}')
('8.1', '\\gamma_{reg}')
('8.1', '\\gamma_{attn}')
('8.1', '\\gamma_{attn}')
('8.1', '\\gamma_{attn}')
('8.2', 'M \\in \\mathbb{R}^{P_l^2 \\times P_l^2}')
('8.2', 'l')
('8.2', 'P_l^2')
('8.2', '\\label{eq: masked EBCU}\n{\\boldsymbol C}_{n+1} = {\\boldsymbol C}_n + \\gamma \\bigg( \\mathop{\\mathrm{softmax}}_2 \\big(\\beta {\\boldsymbol K}{\\boldsymbol Q}^T \\big) {\\boldsymbol M}{\\boldsymbol Q}- \\bigg(\\alpha{\\boldsymbol I}+ {\\boldsymbol {\\mathcal D}}\\Big( \\mathop{\\mathrm{softmax}}\\Big(\\frac{1}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T ) \\Big) \\Big) \\bigg){\\boldsymbol K}\\bigg){\\boldsymbol W}_K^T.')
('8.2', '{\\boldsymbol k}_i')
('8.2', '{\\boldsymbol q}_j, j=1, \\dots, P_l^2')
('8.2', '{\\boldsymbol q}_j')
('8.2', '{\\boldsymbol k}_i')
('8.2', '{\\boldsymbol k}_i')
('8.2', '\\gamma_{attn}')
('8.2', '\\gamma_{reg}')
('8.3', '{\\boldsymbol C}_1')
('8.3', 's=1')
('8.3', '{\\boldsymbol C}_{s>1}')
('8.3', '\\alpha_s')
('8.3', 's')
('8.3', '\\alpha_1=1')
('8.3', '\\alpha_{s>1}')
('8.3', '\\gamma_{attn, s}')
('8.3', '\\gamma_{reg, s}')
('8.3', 's')
('8.3', '\\gamma_{attn, 1}')
('8.3', '\\gamma_{reg, 1}')
('8.3', '\\gamma_{attn, 1}')
('8.3', '\\gamma_{reg, 1}')
('8.3', '\\gamma_{attn, (s>1)}')
('8.3', '\\gamma_{reg, (s>1)}')
('8.3', '\\alpha_s')
('8.3', '\\gamma_s')
('8.3', '\\gamma')
('8.3', '\\gamma_s')
('8.3', '\\alpha_s')
('8.3', '\\tau_s > 0')
('8.3', 's')
('8.3', '\\tau_s \\in [10, 25]')
('8.3', '\\tau_s')
('9.0', 'M_t')
('9.0', '\\triangle c_{\\text{edit}}')
('9.0', 'c + \\triangle c_{\\text{edit}}')
('9.1', '\\rightarrow')
('9.1', '\\rightarrow')
('9.1', '\\rightarrow')
('9.1', '\\rightarrow')
('9.1', '\\rightarrow')
('9.1', '\\rightarrow')
('9.3', '{\\boldsymbol C}_{main}')
('9.3', '{\\boldsymbol C}_{src}')
('9.3', '{\\boldsymbol C}_{tgt}')
('9.3', '\\rightarrow')
('9.3', '\\rightarrow')
('9.4', '\\triangle c_{\\text{edit}}')
('9.4', '\\rightarrow')
('10', '\\gamma_{attn}')
('10', '\\gamma_{reg}')
('10', '\\gamma_{attn}')
('10', '\\gamma_{reg}')
('10', '\\gamma_{attn}')
('10', '\\gamma_{reg}')
('10', '\\gamma_{attn}')
('10', '\\gamma_{reg}')
('10', '\\gamma_{reg}')
('10', '\\gamma_{attn}')
('10', '\\mathop{\\mathrm{E}}({\\boldsymbol K})')
('10', '\\gamma_{attn}')
('10', '\\gamma_{attn}=0.025')
('10', '\\gamma_{reg}=0.02')
('10', '\\mathop{\\mathrm{E}}({\\boldsymbol Q}; {\\boldsymbol K})')
('10', '\\mathop{\\mathrm{E}}({\\boldsymbol K}; {\\boldsymbol Q})')
('10', '\\hat{\\mathop{\\mathrm{E}}}({\\boldsymbol Q}; \\{{\\boldsymbol K}_s\\}_{s=1}^M)')
('10', '\\alpha_s')
('10', '\\alpha')
('10', '\\frac{\\alpha}{2} \\mathop{\\mathrm{diag}}({\\boldsymbol K}{\\boldsymbol K}^T)')
('10', '\\mathop{\\mathrm{E}}({\\boldsymbol K})')
('10', '\\| {\\boldsymbol k}_i \\|')
('10', '\\alpha')
('10', '\\alpha')
('10', '\\alpha=1')
('10', 'Q_t')
('10', 'C_T')
('10', 'T')
('10', 'C_{\\text{clip}}')
('10', 'C_T')
('10', 'C_{\\text{clip}}')
('10', '{\\boldsymbol C}')
('10', '\\alpha')
('10', '\\alpha')
('10', '\\gamma_{attn}')
('10', '\\gamma_{reg}')
