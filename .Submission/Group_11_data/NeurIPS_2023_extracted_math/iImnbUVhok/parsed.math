('1', 'h')
('1', '\\pi_0, \\pi_1')
('1', 'p_{\\texttt{LM}}(y|x, \\pi)')
('1', 'x')
('1', 'y')
('1', '\\pi')
('1', 'p_{\\tiny\\texttt{DLN-2}}(y | x) = \\sum_h p_{\\texttt{LM}}(y | h, x, \\pi_1)\\,p_{\\texttt{LM}}(h | x, \\pi_0)\\,,')
('1', 'h')
('1', 'h')
('1', 'h')
('2', 'y')
('2', 'x')
('2', '\\pi')
('2', '\\pi')
('2', 'x')
('2.0', 'x')
('2.0', 'y')
('2.0', '\\pi')
('2.0', '\\texttt{LM}')
('2.0', 'x')
('2.0', '\\pi')
('2.0', 'y')
('2.0', 'x')
('2.0', '\\pi')
('2.0', '\\texttt{LM}')
('2.0', '\\texttt{T}')
('2.0', '\\texttt{F}\\ifstrempty{}{}{()}')
('2.0', '\\texttt{F}\\ifstrempty{x,\\pi}{}{(x,\\pi)}')
('2.0', '\\{\\pi\\}\\{x\\}')
('2.0', 'x')
('2.0', '\\pi')
('2.0', '\\texttt{F}\\ifstrempty{}{}{()}')
('2.0', 'p_{\\texttt{LM}}(y | \\texttt{F}\\ifstrempty{x, \\pi}{}{(x, \\pi)})')
('2.0', 'y')
('2.0', '\\texttt{LM}')
('2.0', '\\pi')
('2.1', '\\pi')
('2.1', '\\{x, y\\}')
('2.1', 'N')
('2.1', '\\pi^1, \\ldots, \\pi^N')
('2.1', 's')
('2.1', '\\pi = \\arg\\max_{\\pi^n} s(\\pi^n)')
('2.1', '\\hat y \\sim p_{\\texttt{LM}}^t(y | c)')
('2.1', '\\log p_{\\texttt{LM}}(h | c)')
('2.1', 'N')
('2.1', 'I')
('2.1', '\\mathcal{D}')
('2.1', '\\texttt{F}\\ifstrempty{}{}{()}')
('2.1', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('2.1', '\\pi')
('2.1', 'x, y \\sim \\mathcal{D}')
('2.1', '\\hat{y} \\gets p_{\\texttt{LM}}^0(y | \\texttt{F}\\ifstrempty{x, \\pi}{}{(x, \\pi)})')
('2.1', '\\pi^1, \\ldots, \\pi^N \\sim p_{\\texttt{LM}}^{0.7}(\\pi | \\texttt{B}_\\pi\\ifstrempty{\\{x,y,\\hat{y}\\},\\pi}{}{(\\{x,y,\\hat{y}\\},\\pi)})')
('2.1', 's^1, \\ldots, s^N \\gets \\log p_{\\texttt{LM}}(y | \\texttt{F}\\ifstrempty{x, \\pi^n}{}{(x, \\pi^n)})')
('2.1', '\\pi \\gets \\arg\\max_{\\pi^n} \\{s^1, \\ldots, s^N\\}')
('2.1', '\\{x, y, \\hat y\\}')
('2.1', '\\pi')
('2.1', 'p_{\\texttt{LM}}(\\pi^n | \\texttt{B}_\\pi\\ifstrempty{\\{x, y, \\hat y\\}, \\pi}{}{(\\{x, y, \\hat y\\}, \\pi)})')
('2.1', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('2.1', 'N')
('2.1', '\\pi^1, \\ldots, \\pi^N')
('2.1', 'N')
('2.1', '\\texttt{LM}')
('2.1', '\\pi = \\arg\\max_{\\pi^n} \\log p_{\\texttt{LM}}(y | \\texttt{F}\\ifstrempty{x; \\pi^n}{}{(x; \\pi^n)})')
('3', '\\begin{aligned}\np_{\\tiny\\texttt{DLN-2}}(y | x) &= \\sum_{h} p_{\\texttt{LM}}(y | \\texttt{F}_r\\ifstrempty{h, x, \\pi_1}{}{(h, x, \\pi_1)}) p_{\\texttt{LM}}(h | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)})\n\\label{eq:two-layer}\n\\end{aligned}')
('3', 'h')
('3', 'y')
('3', 'x')
('3', '\\texttt{F}_r\\ifstrempty{}{}{()}')
('3', '\\Pi = \\{\\pi_0, \\pi_1\\}')
('3', '\\pi_0')
('3', '\\pi_1')
('3.0', '\\Pi')
('3.0', '\\Pi')
('3.0', 'q(h)')
('3.0', 'h')
('3.0', 'y')
('3.0', 'x')
('3.0', '\\begin{aligned}\n    \\log p_{\\tiny\\texttt{DLN-2}}(y|x) & \\geq \\sum_{h} q(h) \\left[\\log p_{\\texttt{LM}}(y | \\texttt{F}_r\\ifstrempty{h, x, \\pi_1}{}{(h, x, \\pi_1)})p_{\\texttt{LM}}(h | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)})\\right] + H\\left[q(h)\\right],\n\\label{eq:elbo}\n\\end{aligned}')
('3.0', '\\Pi')
('3.0', '\\pi_0')
('3.0', '\\pi_1')
('3.0', '\\begin{aligned}\n\\label{eq:prompt_update}\n\\pi_0^* = \\arg\\max_{\\pi_0} \\sum_{x,\\, h} w_h \\log p(h | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)}),\\;\\;\n\\pi_1^* = \\arg\\max_{\\pi_1} \\sum_{(x, y),\\, h} w_h \\log p(y | \\texttt{F}\\ifstrempty{h, x, \\pi_1}{}{(h, x, \\pi_1)}) \\; .\n\\end{aligned}')
('3.0', '\\pi_1')
('3.0', 'h')
('3.0', 'x')
('3.0', '\\pi_0')
('3.0', 'h')
('3.0', 'y')
('3.0', '\\Pi')
('3.0', 'q(h)')
('3.0', '\\textrm{KL}(q(h) || p(h | y, x))')
('3.0', 'q')
('3.0', 'q(h)')
('3.0', '\\texttt{LM}')
('3.0', 'y')
('3.0', '\\hat h \\sim p_{\\texttt{LM}}(h | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)})')
('3.0', 'q_\\texttt{edit}(h) = p_{\\texttt{LM}}(h | \\texttt{B}_h\\ifstrempty{\\hat h, y, \\pi_1}{}{(\\hat h, y, \\pi_1)})')
('3.0', '\\texttt{B}_h\\ifstrempty{}{}{()}')
('3.0', 'q_\\texttt{edit}')
('3.0', '\\texttt{LM}')
('3.0', '\\hat h')
('3.0', 'y')
('3.0', '\\pi_1')
('3.0', 'q_\\texttt{pri}(h) = p_{\\texttt{LM}}(h | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)})')
('3.0', 'y')
('3.0', 'q_\\texttt{pri+}(h) = p_{\\texttt{LM}}(h | \\texttt{B}_y\\ifstrempty{x, \\pi_0, y}{}{(x, \\pi_0, y)})')
('3.0', 'q_\\texttt{pri}')
('3.0', 'q_\\texttt{pri+}')
('3.0', 'q(h)')
('3.0', 'h^i')
('3.0', '\\tilde{w}^i = \\log p_{\\texttt{LM}}(y | \\texttt{F}_r\\ifstrempty{h^i, x, \\pi_1}{}{(h^i, x, \\pi_1)}) + \\log p_{\\texttt{LM}}(h^i | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)})')
('3.0', 'h_i')
('3.0', 'w_i = \\exp(\\alpha\\tilde{w}_i) / \\sum_{j} \\exp(\\alpha\\tilde{w}_j)')
('3.0', '\\alpha')
('3.0', '\\hat y \\sim p_{\\texttt{LM}}^t(c)')
('3.0', '\\log p_{\\texttt{LM}}(h | c)')
('3.0', 'N')
('3.0', 'K')
('3.0', 'I')
('3.0', '\\mathcal{D}')
('3.0', '\\texttt{F}\\ifstrempty{}{}{()}')
('3.0', '\\texttt{F}_r\\ifstrempty{}{}{()}')
('3.0', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('3.0', '\\texttt{B}_h\\ifstrempty{}{}{()}')
('3.0', '\\pi_0, \\pi_1')
('3.0', 'x, y \\sim \\mathcal{D}')
('3.0', '\\hat{h} \\gets p_{\\texttt{LM}}^0(\\texttt{F}\\ifstrempty{x,\\pi_0}{}{(x,\\pi_0)})')
('3.0', '\\hat{y} \\gets \np_{\\texttt{LM}}^0(\\texttt{F}_r\\ifstrempty{\\hat{h}, x, \\pi_1}{}{(\\hat{h}, x, \\pi_1)})')
('3.0', 'h^1, \\ldots, h^K \\sim \np_{\\texttt{LM}}^{0.7}(\\texttt{B}_h\\ifstrempty{\\hat{h}, x, y, \\pi_1, \\pi_0}{}{(\\hat{h}, x, y, \\pi_1, \\pi_0)})')
('3.0', '\\alpha^1, \\ldots, \\alpha^K \\gets \\log p_{\\texttt{LM}}(h^k | \\texttt{F}\\ifstrempty{x, \\pi_0}{}{(x, \\pi_0)})')
('3.0', '\\beta^1, \\ldots, \\beta^K \\gets \\log p_{\\texttt{LM}}(y | \\texttt{F}_r\\ifstrempty{h^k, x, \\pi_1}{}{(h^k, x, \\pi_1)})')
('3.0', 'q^k \\gets \\exp(\\alpha^k + \\beta^k) / (\\sum_k \\exp(\\alpha^k + \\beta^k))')
('3.0', 'h^* \\gets \\arg\\max_{h} \\{q^1, \\ldots, q^K\\}')
('3.0', '\\pi_0^1, \\ldots, \\pi_0^N \\sim p_{\\texttt{LM}}^{0.7}(\\texttt{B}_\\pi\\ifstrempty{\\{x,\\hat{h},h^*\\},\\pi_0}{}{(\\{x,\\hat{h},h^*\\},\\pi_0)})')
('3.0', '\\pi_1^1, \\ldots, \\pi_1^N \\sim p_{\\texttt{LM}}^{0.7}(\\texttt{B}_\\pi\\ifstrempty{\\{\\hat{h},\\hat{y},y\\},\\pi_1}{}{(\\{\\hat{h},\\hat{y},y\\},\\pi_1)})')
('3.0', 's_0^1, \\ldots, s_0^N \\gets \\sum\n_k q^k\\, \\log p_{\\texttt{LM}}(h^k | \\texttt{F}\\ifstrempty{x, \\pi_0^n}{}{(x, \\pi_0^n)})')
('3.0', 's_1^1, \\ldots, s_1^N \\gets \\sum_k q^k\\, \\log p_{\\texttt{LM}}(y | \\texttt{F}_r\\ifstrempty{h^k, x, \\pi_1^n}{}{(h^k, x, \\pi_1^n)})')
('3.0', '\\pi_0 \\gets \\arg\\max_{\\pi_0^n} \\{s_0^1, \\ldots, s_0^N\\}')
('3.0', '\\pi_1 \\gets \\arg\\max_{\\pi_1^n} \\{s_1^1, \\ldots, s_1^N\\}')
('4', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('4', 'p_{\\texttt{LM}}(\\pi)')
('4', '\\pi')
('4', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('4', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('4', '\\pi^n')
('4', '\\pi^n')
('4', '\\texttt{LM}')
('4', '\\pi')
('4', '\\pi^n')
('4', '\\pi^n')
('4', '\\pi')
('4', '\\pi^n')
('4', 'M = 5')
('4', '\\pi_0')
('4', 'h^i')
('4', '\\hat h')
('4', '\\pi_0')
('4', '\\hat h')
('4', 'r = - \\lambda\\, \\log p_{\\texttt{LM}}(\\hat h|\\texttt{F}\\ifstrempty{x, \\pi^n}{}{(x, \\pi^n)})')
('4', '\\hat y \\neq y')
('4', '\\lambda')
('4', '\\lambda')
('5.0', 'N = 20')
('5.0', 'K = 5')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm32.9')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('9.0', '|\\text{train}|')
('9.0', '|\\text{valid}|')
('9.0', '|\\text{test}|')
('9.0', '|\\text{class}|')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10', '\\pm')
('10.0', '\\pi^*')
('10.0', '\\pi_1 = \\pi^*')
('10.0', '\\pi_0')
('11.0.0', 'y')
('11.0.0', 'x')
('11.0.0.0', '\\hat h')
('11.0.0.1', '\\pi_0')
('11.1.0', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('11.1.0', 'x')
('11.1.0', 'h')
('11.1.0', 'h^*')
('11.1.0', 'y')
('11.1.0', '\\hat h')
('11.1.0', '\\hat y')
('11.1.0.0', 'q(h)')
('11.1.0.0', 'q(h)')
('11.1.0.0', 'p(h)')
('11.1.0.0', 'y')
('11.1.0.0', '\\pi_1')
('11.1.0.0', 'x')
('11.1.0.0', '\\hat h')
('11.1.0.0', 'y')
('11.1.0.0', 'p_{\\texttt{LM}}(h | x, \\pi_0)')
('11.1.0.0', 'y')
('11.1.0.0', 'q(h | x, y, \\pi_0)')
('11.1.0.0', '\\textrm{KL}(q(h) || p_{\\texttt{LM}}(h | x, \\pi_0))')
('12', '\\hat h \\sim p_{\\texttt{LM}}^t(x)')
('12', 'x')
('12', 't')
('12', '\\log p_{\\texttt{LM}}(h | x)')
('12', 'h')
('12', 'x')
('12', 'N')
('12', 'K')
('12', 'I')
('12', 'L')
('12', '\\mathcal{D}')
('12', '\\texttt{F}\\ifstrempty{}{}{()}')
('12', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('12', '\\texttt{B}_h\\ifstrempty{}{}{()}')
('12', '\\pi_l')
('12', 'x, y \\sim \\mathcal{D}')
('12', '\\hat{h}_0 \\gets x')
('12', '\\hat{h}_l, \\ldots, \\hat{h}_{L} \\gets p_{\\texttt{LM}}^0(\\texttt{F}\\ifstrempty{\\hat{h}_{l-1},\\pi_{l-1}}{}{(\\hat{h}_{l-1},\\pi_{l-1})})')
('12', '0<l\\le L')
('12', 'h^*_L \\gets y')
('12', 'h^1_l, \\ldots, h^K_l \\sim p_{\\texttt{LM}}^{0.7}(\\texttt{B}_h\\ifstrempty{\\hat{h}_{l}, h^*_{l+1}, \\pi_{l}}{}{(\\hat{h}_{l}, h^*_{l+1}, \\pi_{l})})')
('12', '\\alpha^1_l, \\ldots, \\alpha^K_l \\gets \\log p_{\\texttt{LM}}(h^k_l | \\texttt{F}\\ifstrempty{\\hat{h}_{l-1}, \\pi_{l-1}}{}{(\\hat{h}_{l-1}, \\pi_{l-1})})')
('12', '\\beta^1_l, \\ldots, \\beta^K_l \\gets \\log p_{\\texttt{LM}}(h^*_{l+1} | \\texttt{F}\\ifstrempty{h^k_l, \\pi_l}{}{(h^k_l, \\pi_l)})')
('12', 'q^k_l \\gets \\exp(\\alpha^k_l + \\beta^k_l) / (\\sum_k \\exp(\\alpha^k_l + \\beta^k_l))')
('12', 'h^*_l \\gets \\arg\\max_{h_l} \\{q^1_l, \\ldots, q^K_l\\}')
('12', '\\pi_l^1, \\ldots, \\pi_l^N \\sim p_{\\texttt{LM}}^{0.7}(\\texttt{B}_\\pi\\ifstrempty{\\{\\hat{h}_{l},\\hat{h}_{l+1},h^*_{l+1}\\},\\pi_{l}}{}{(\\{\\hat{h}_{l},\\hat{h}_{l+1},h^*_{l+1}\\},\\pi_{l})})')
('12', "s_l^1, \\ldots, s_l^N \\gets \\sum_k \\sum_{k'} q^k_l q^{k'}_{l+1}\\, \\log p_{\\texttt{LM}}(h^{k'}_{l+1} | \\texttt{F}\\ifstrempty{h^{k}_{l}, \\pi_l^n}{}{(h^{k}_{l}, \\pi_l^n)})")
('12', '\\pi_l \\gets \\arg\\max_{\\pi_l^n} \\{s_l^1, \\ldots, s_l^N\\}')
('16', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('16', '\\texttt{B}_\\pi\\ifstrempty{}{}{()}')
('16', 'h')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
('17', '\\pm')
