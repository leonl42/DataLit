('1', 'n')
('1', 'k')
('1', 'k')
('1', 'n')
('3.1', 'C')
('3.1', 'C')
('3.1', 'k+1')
('3.1', 's_{i-k}')
('3.1', 's_{i-1}')
('3.1', 's_{i}')
('3.1', 'k')
('3.1', 'c_i')
('3.1', 's_i')
('3.1', 'a_i')
('3.1', 'a_i \\sim \\pi^t_{\\rho}(a | c_i, s_i, .., s_{i-k}), \\; a \\in A_{cand}')
('3.1', '\\pi^t_{\\rho}')
('3.1', '\\rho')
('3.1', 'A_{cand}')
('3.1', 'L')
('3.1', 'L')
('3.1', 'j')
('3.1', 'j^{\\textrm{th}}')
('3.1', 'a')
('3.1', 'c_i')
('3.1', '\\mathbf{W}_1')
('3.1', '\\mathbf{b}_1')
('3.1', '\\mathbf{g}(a, c_i)')
('3.1', 'k+1')
('3.1', '\\mathbf{W}_2')
('3.1', '\\mathbf{b}_2')
('3.1', '\\mathbf{g}(s_i, .., s_{i-k})')
('3.1', '\\mathbf{g}(a, c_i)')
('3.1', "\\begin{split}\n    \\mathbf{g}(a, c_i) &= \\mathbf{W}_1 \\cdot \\textrm{FFN}(a, c_i) + \\mathbf{b}_1 \\\\\n    \\mathbf{g}(s_i, .., s_{i-k}) &= \\mathbf{W}_2 \\cdot \\textrm{Attention}(\\textrm{PE}(s_{i-k} || .. || s_{i-1} || s_{i})) + \\mathbf{b}_2 \\\\\n    \\pi^t_{\\rho}(a |c_i, s_i, .., s_{i-k}) &= \\frac{\\textrm{exp}(\\mathbf{g}(a, c_i) \\cdot \\mathbf{g}(s_i, .., s_{i-k}))}{\\sum_{a' \\in A_{cand}}{\\textrm{exp}(\\mathbf{g}(a', c_i) \\cdot \\mathbf{g}(s_i, .., s_{i-k}))}}\n\\end{split}")
('3.1', 'generic\\_tmpl =')
('3.1', 'prompt\\_tmpl = generic\\_tmpl \\; || \\;')
('3.1', '||')
('3.1', 's_{i-k}')
('3.1', 's_{i-1}')
('3.1', 's_i')
('3.1', 'l')
('3.1', 'e_i = \\{e_i^1, e_i^2, ..., e_i^l | e_i^j \\in E_{cand}\\}')
('3.1', 'E_{cand}')
('3.1', 'e_i^j \\sim \\pi^p_{\\theta}(e | s_i, .., s_{i-k}), \\; e_i^j \\in E_{cand} \\; \\textrm{for} \\; j = 1, 2, ..., l')
('3.1', '\\pi^p_{\\theta}')
('3.1', '\\theta')
('3.1', 'p_{i} = prompter(prompt\\_tmpl, e_{i}, s_{i})')
('3.1', 's_{i+1} = LLM(p_{i})')
('3.1', "\\begin{split}\n    \\mathbf{h}(e) &= \\mathbf{M}_1 \\cdot \\textrm{Attention}(e) + \\mathbf{c}_1 \\\\\n    \\mathbf{h}(s_i, .., s_{i-k}) &= \\mathbf{M}_2 \\cdot \\textrm{Attention}(\\textrm{PE}(s_{i-k} || .. || s_{i-1} || s_{i})) + \\mathbf{c}_2 \\\\\n    \\pi^p_{\\theta}(e | s_i, .., s_{i-k}) &= \\frac{\\textrm{exp}(\\mathbf{h}(e) \\cdot \\mathbf{h}(s_i, .., s_{i-k}))}{\\sum_{e' \\in E_{cand}}{\\textrm{exp}(\\mathbf{h}(e') \\cdot \\mathbf{h}(s_i, .., s_{i-k}))}}\n\\end{split}")
('3.2', '\\pi^{t}_{\\rho}')
('3.2', '\\pi^{p}_{\\theta}')
('3.2', 'r_i \\leftarrow reward(\\textrm{ToTSystem}(p_i))')
('3.2', 'r')
('3.2', 'r = +1')
('3.2', 'r = -1')
('3.2', 'P_{train}')
('3.2', 'N')
('3.2', '\\pi^t_{\\rho}(a_i | s_i, .., s_{i-k})')
('3.2', '\\pi^p_{\\theta}(e_i | s_i, .., s_{i-k})')
('3.2', 'epoch')
('3.2', '\\pi^t_{\\rho}')
('3.2', '\\pi^p_{\\theta}')
('3.2', 'N')
('3.3', 'user\\_input\\_prompt =')
('3.3', 'K')
('3.3', 'l')
('3.3', 'K')
('3.3', 'nil')
('4', 'n^2 \\times n^2')
('4', 'n \\times n')
('4.1', 'n \\times n')
('4.1', 'n')
('4.1', 'n = 3, 4, 5')
('5', 'P_{train}')
