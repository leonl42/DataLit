('2', 'f: \\mathcal{S}\\to \\mathbb{R}')
('2', 'f')
('2', '\\mathbb{R}^{|\\mathcal{S}|}')
('2', 's')
('2', 'f(s)')
('2', '\\norm{\\cdot}')
('2', '\\ell_2')
('2', '{\\left<x, y\\right>} \\doteq x^\\top y')
('2', '\\norm{\\cdot}_p')
('2', '\\ell_p')
('2', '\\norm{\\cdot}_m')
('2', '\\norm{\\cdot}^*_m')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', 'r: \\mathcal{S}\\times \\mathcal{A}\\to [-r_{max}, r_{max}]')
('2', 'r_{max}')
('2', 'p: \\mathcal{S}\\times \\mathcal{S}\\times \\mathcal{A}\\to [0, 1]')
('2', '\\gamma \\in [0, 1)')
('2', 'p_0: \\mathcal{S}\\to [0, 1]')
('2', 'S_0')
('2', 'p_0')
('2', 't')
('2', 'S_t')
('2', 'A_t \\sim \\pi(\\cdot | S_t)')
('2', '\\pi: \\mathcal{A}\\times \\mathcal{S}\\to [0, 1]')
('2', 'R_{t+1} \\doteq r(S_t, A_t)')
('2', 'S_{t+1} \\sim p(\\cdot | S_t, A_t)')
('2', 't')
('2', '\\begin{aligned}\n  G_t \\doteq \\sum_{i=0}^{\\infty} \\gamma^i R_{t+i+1},\n\\end{aligned}')
('2', 'v_\\pi')
('2', 'q_\\pi')
('2', '\\begin{aligned}\n  v_\\pi(s) &\\doteq \\mathbb{E}[G_t | S_t = s, \\pi, p], \\\\\n  q_\\pi(s, a) &\\doteq \\mathbb{E}[G_t | S_t = s, A_t = a, \\pi, p].\n\\end{aligned}')
('2', '\\pi')
('2', '\\begin{aligned}\n  J(\\pi; p_0) \\doteq \\sum_s p_0(s) v_\\pi(s).\n\\end{aligned}')
('2', 'v_\\pi')
('2', 'q_\\pi')
('2', 'q_\\pi')
('2', 'q_t \\in \\mathbb{R}^{|\\mathcal{S}\\times \\mathcal{A}|}')
('2', 'q_\\pi')
('2', 't')
('2', '\\qty{q_t}')
('2', '\\begin{aligned}\n  \\delta_t &\\doteq R_{t+1} + \\gamma q_{t}(S_{t+1}, A_{t+1}) - q_t(S_t, A_t), \\\\\n  \\label{eq on-policy sarsa}\n  q_{t+1}(s, a) &\\doteq \n  \\begin{cases}\n    q_t(s, a) + \\alpha_t \\delta_t, & (s ,a) = (S_t, A_t) \\\\\n    q_t(s, a), & (s, a) \\neq (S_t, A_t)\n  \\end{cases},\n\\end{aligned}')
('2', '\\delta_t')
('2', '\\qty{\\alpha_t}')
('2', '\\qty{q_t}')
('2', 'q_\\pi')
('2', 'q_\\pi')
('2', '\\mu')
('2', 'A_t \\sim \\mu(\\cdot |S_t)')
('2', '\\pi')
('2', '\\mu')
('2', '\\qty{q_t}')
('2', "\\begin{aligned}\n  \\delta_t \\doteq& R_{t+1} + \\gamma \\sum_{a'} \\pi(a' | S_{t+1}) q_{t}(S_{t+1}, a') - q_t(S_t, A_t), \\\\\n  \\label{eq off-policy esarsa}\n  q_{t+1}(s, a) \\doteq &\n  \\begin{cases}\n    q_t(s, a) + \\alpha_t \\delta_t, & (s ,a) = (S_t, A_t) \\\\\n    q_t(s, a), & (s, a) \\neq (S_t, A_t)\n  \\end{cases},\n\\end{aligned}")
('2', '\\pi')
('2', '\\mu')
('2', '\\pi_*')
('2', '\\forall \\pi, s')
('2', '\\begin{aligned}\n  \\label{eq optimal policy}\n  v_\\pi(s) \\leq v_{\\pi_*}(s).\n  % J(\\pi; p_0) \\leq J(\\pi_*; p_0).\n\\end{aligned}')
('2', '\\pi')
('2', '\\theta \\in \\mathbb{R}^{|\\mathcal{S}\\times \\mathcal{A}|}')
('2', "\\begin{aligned}\n  \\pi(a|s) \\doteq \\frac{\\exp(\\theta_{s,a})}{\\sum_{a'}\\exp(\\theta_{s,a'})},\n\\end{aligned}")
('2', '\\theta_{s,a}')
('2', '(s, a)')
('2', '\\theta')
('2', '\\theta')
('2', '\\begin{aligned}\n  \\label{eq on-policy pg}\n  \\theta_{t+1} \\doteq \\theta_t + \\beta_t \\nabla_{\\theta} J(\\pi_{\\theta_t}; p_0).\n\\end{aligned}')
('2', '\\qty{\\beta_t}')
('2', '\\pi_\\theta')
('2', '\\pi')
('2', '\\theta')
('2', '\\theta')
('2', '\\nabla_\\theta')
('2', 'p_0(s) > 0')
('2', 's')
('2', '\\qty{\\beta_t}')
('2', '\\qty{\\theta_t}')
('2', '\\begin{aligned}\n  \\lim_{t\\to\\infty} J(\\theta_t; p_0) = J(\\pi_*;p_0),\n\\end{aligned}')
('2', '\\nabla J(\\pi_{\\theta_t}; p_0)')
('2', '\\begin{aligned}\n  \\nabla J(\\pi_{\\theta}; p_0) \\doteq& \\frac{1}{1 - \\gamma} \\sum_s d_{\\pi_\\theta, \\gamma, p_0}(s) \\sum_a q_{\\pi_\\theta}(s, a) \\nabla \\pi_\\theta(a|s),\n\\end{aligned}')
('2', '\\begin{aligned}\n  d_{\\pi, \\gamma, p_0} \\doteq (1 - \\gamma)\\sum_{t=0}^\\infty \\gamma^t \\Pr(S_t = s | p_0, \\pi)\n\\end{aligned}')
('2', '\\begin{aligned}\n  \\label{eq on-policy ac}\n  \\theta_{t+1} \\doteq \\theta_t + \\beta_t \\gamma^t q_t(S_t, A_t) \\nabla \\log \\pi_{\\theta_t}(A_t | S_t),\n\\end{aligned}')
('2', 'q_t')
('2', '\\pi_\\theta')
('2', 'q')
('2', '\\alpha_t')
('2', '\\beta_t')
('2', 'q_t')
('2', 'q_{\\pi_{\\theta_t}}')
('2', '\\gamma^t q_t(S_t, A_t) \\nabla \\log \\pi_{\\theta_t}(A_t | S_t)')
('2', '\\nabla J(\\pi_{\\theta_t}; p_0)')
('2', 't')
('2', '\\mu_{\\theta_t}')
('2', '\\mu_\\theta')
('2', '\\pi_\\theta')
('2', '\\mu_\\theta')
('2', '\\mu')
('2', '\\pi_\\theta')
('2', '\\mu_\\theta')
('2', '\\begin{aligned}\n  \\label{eq off-policy ac}\n  \\theta_{t+1} \\doteq \\theta_t + \\beta_t \\varrho_t \\rho_t q_t(S_t, A_t) \\nabla \\log \\pi_{\\theta_t}(A_t | S_t),\n\\end{aligned}')
('2', '\\begin{aligned}\n  \\rho_t \\doteq \\frac{\\pi_{\\theta_t}(A_t | S_t)}{\\mu_{\\theta_t}(A_t | S_t)}\n\\end{aligned}')
('2', '\\begin{aligned}\n  \\varrho_t \\doteq& \\frac{d_{\\pi_{\\theta_t}, \\gamma, p_0}(s)}{d_t(s)} \\;\\text{ with }\\;\n  d_t(s) \\doteq {\\Pr(S_t = s | \\mu_{\\theta_0}, \\dots, \\mu_{\\theta_t})}\n\\end{aligned}')
('2', '\\rho_t')
('2', '\\varrho_t')
('2', '\\nabla J(\\pi_{\\theta_t}; p_0)')
('2', 'q_t')
('2', 'q_{\\pi_{\\theta_t}}')
('2', '\\rho_t')
('2', '\\varrho_t')
('2', '\\begin{aligned}\n  \\label{eq off-policy ac with mismatch}\n  \\theta_{t+1} \\doteq \\theta_t + \\beta_t \\rho_t q_t(S_t, A_t) \\nabla \\log \\pi_{\\theta_t}(A_t | S_t).\n\\end{aligned}')
('2', 'q_t')
('2', 'q_{\\pi_{\\theta_t}}')
('2', '\\varrho_t')
('2', '\\begin{aligned}\n  \\label{eq jh}\n  \\theta_{t+1} \\doteq \\theta_t + \\beta_t \\sum_s d_t(s) \\sum_{a}q_{\\pi_{\\theta_t}}(s, a) \\nabla \\pi_{\\theta_t}(a|s).\n\\end{aligned}')
('2', '\\qty{\\theta_t}')
('2', '\\begin{aligned}\n  \\lim_{t\\to\\infty} J(\\pi_{\\theta_t};p_0) = J(\\pi_*; p_0).\n\\end{aligned}')
('2', '\\pi_*')
('2', '\\inf_{s, t} d_t(s) > 0')
('3', "\\begin{aligned}\n  \\delta_t \\doteq& R_{t+1} + \\gamma \\sum_{a'} \\pi_{\\theta_t}(a' | S_{t+1}) q_{t}(S_{t+1}, a') - q_t(S_t, A_t), \\\\\n  q_{t+1}(s, a) \\doteq &\n  \\begin{cases}\n    q_t(s, a) + \\alpha_t \\delta_t, & (s ,a) = (S_t, A_t) \\\\\n    q_t(s, a), & (s, a) \\neq (S_t, A_t)\n  \\end{cases}.\n\\end{aligned}")
('3', '\\begin{aligned}\n  \\label{eq critic update with F}\n  q_{t+1} = q_t + \\alpha_t \\left(F_{\\theta_t}(q_t, S_t, A_t, S_{t+1}) - q_t\\right),\n\\end{aligned}')
('3', '\\begin{aligned}\n  F_\\theta(q, s_0, a_0, s_1)[s, a]\n  \\doteq& \\mathbb{I}_{(s_0, a_0) = (s, a)} \\delta_\\theta(q, s_0, a_0, s_1) + q(s, a),\\\\\n  \\delta_\\theta(q, s_0, a_0, s_1) \n  \\doteq& r(s_0, a_0) + \\gamma \\sum_{a_1} \\pi_{\\theta}(a_1 | s_1) q(s_1, a_1) - q(s_0, a_0).\n\\end{aligned}')
('3', '\\mathbb{I}_{statement}(\\cdot)')
('3', '\\begin{aligned}\n    \\label{eq sa iterates}\n    w_{t+1} \\doteq w_t + \\alpha_t (F_{\\theta_t}(w_t, Y_t) - w_t + \\epsilon_t).\n\\end{aligned}')
('3', '\\qty{w_t \\in \\mathbb{R}^K}')
('3', '\\qty{Y_t}')
('3', '\\mathcal{Y}')
('3', '\\qty{\\theta_t \\in \\mathbb{R}^L}')
('3', '\\qty{Y_t}')
('3', 'F_\\theta')
('3', '\\mathbb{R}^K \\times \\mathcal{Y}')
('3', '\\mathbb{R}^K')
('3', '\\theta')
('3', '\\qty{\\epsilon_t \\in \\mathbb{R}^K}')
('3', '\\epsilon_t \\equiv 0')
('3', '\\qty{\\epsilon_t}')
('3', 'F_\\theta')
('3', '\\theta')
('3', 'F')
('3', '\\qty{Y_t}')
('3', '\\qty{\\theta_t}')
('3', '\\qty{Y_t}')
('3', '\\qty{\\theta_t}')
('3', '\\qty{\\theta_t}')
('3', '\\Lambda_P \\doteq \\qty{P_{\\theta} \\in \\mathbb{R}^{|\\mathcal{Y}| \\times |\\mathcal{Y}|} | \\theta \\in \\mathbb{R}^L}')
('3', '\\begin{aligned}\n    \\Pr(Y_{t+1} = y) = P_{\\theta_{t+1}}(Y_t, y).\n\\end{aligned}')
('3', '\\bar \\Lambda_P')
('3', '\\Lambda_P')
('3', 'P \\in \\bar \\Lambda_P')
('3', 'P')
('3', 'd_\\theta')
('3', 'P_\\theta')
('3', '\\qty{Y_t}')
('3', '\\qty{\\theta_t}')
('3', '\\qty{\\theta_t}')
('3', '\\bar \\Lambda_P')
('3', 'P_\\infty \\in \\bar \\Lambda_P')
('3', '\\bar \\Lambda_P')
('3', '\\Lambda_P')
('3', '\\qty{P_n}')
('3', 'P_n \\in \\Lambda_P')
('3', '\\lim_{n\\to\\infty} P_n = P_\\infty')
('3', "P_\\infty(y, y') \\in [0, 1]")
('3', "\\begin{aligned}\n  \\sum_{y'} P_\\infty(y, y') = \\sum_{y'} \\lim_{n\\to\\infty} P_n(y, y') = \\lim_{n\\to\\infty} \\sum_{y'} P_n(y, y') = 1.\n\\end{aligned}")
('3', 'P_\\infty')
('3', 'C_0 > 0')
('3', '\\tau \\in (0, 1)')
('3', '\\theta')
('3', 'n > 0')
('3', "\\begin{aligned}\n    \\label{eq uniform mixing}\n    \\sup_{y, \\theta} \\sum_{y'} \\abs{P^n_\\theta(y, y') -  d_\\theta(y')} \\leq C_0 \\tau^n.\n\\end{aligned}")
('3', '\\theta')
('3', 'P_\\theta')
('3', '\\tau')
('3', '\\theta')
('3', '\\theta')
('3', '\\tau_\\theta')
('3', '\\theta')
('3', '\\bar \\Lambda_P')
('3', '\\Lambda_P')
('3', '\\qty{\\theta_t}')
('3', '\\qty{\\tau_{\\theta_t}}')
('3', '1')
('3', '\\bar \\Lambda_P')
('3', '\\theta \\in \\mathbb{R}^L')
('3', 'F_\\theta: \\mathbb{R}^K \\to \\mathbb{R}^K')
('3', '\\begin{aligned}\n    \\bar F_\\theta(w) \\doteq \\sum_{y \\in \\mathcal{Y}} d_\\theta(y) F_\\theta(w, y).\n\\end{aligned}')
('3', '\\kappa \\in (0, 1)')
('3', '\\norm{\\cdot}_c')
('3', "\\theta, w, w'")
('3', "\\begin{aligned}\n    \\norm{\\bar F_\\theta(w) - \\bar F_{\\theta}(w')}_c \\leq \\kappa \\norm{w - w'}_c.\n\\end{aligned}")
('3', 'w_\\theta^*')
('3', '\\bar F_\\theta')
('3', 'w_\\theta^*')
('3', '\\norm{\\cdot}_c')
('3', '\\kappa')
('3', '\\theta')
('3', "L_F, L_F', L_F'', U_F, U_F', U_F'', L_w, U_w, L_P")
('3', "w, w', y, y'")
('3', 't, k')
('3', "\\norm{F_{\\theta_t}(w, y) - F_{\\theta_t}(w', y)}_c \\leq L_F \\norm{w - w'}_c")
('3', "\\norm{F_{\\theta_t}(w, y) - F_{\\theta_k}(w, y)}_c \\leq L_F' \\norm{\\theta_t - \\theta_k}_c \\left(\\norm{w}_c + U_F'\\right)")
('3', '\\norm{F_{\\theta_t}(0, y)}_c \\leq U_F')
('3', "\\norm{\\bar F_{\\theta_t}(w) - \\bar F_{\\theta_k}(w)}_c \\leq L_F'' \\norm{\\theta_t - \\theta_k}_c (\\norm{w}_c + U_F'')")
('3', '\\norm{w^*_{\\theta_t} - w^*_{\\theta_k}}_c \\leq L_w \\norm{\\theta_t - \\theta_k}_c')
('3', '\\sup_{t} \\norm{w^*_{\\theta_t}}_c \\leq U_w')
('3', "\\abs{ P_{\\theta_t}(y, y') - P_{\\theta_k}(y, y') } \\leq L_P \\norm{\\theta_t - \\theta_k}_c")
('3', '\\mathcal{F}_t')
('3', '\\sigma')
('3', '\\qty{(w_i, Y_i, \\epsilon_i, \\theta_i)}_{0 \\leq i \\leq t-1} \\cup \\qty{w_t, \\theta_t}')
('3', '\\mathbb{E}\\left[\\epsilon_t \\mid \\mathcal{F}_t\\right] = 0, \\forall t')
('3', "U_\\epsilon, U_\\epsilon'")
('3', "\\forall t, \\norm{\\epsilon_t}_c \\leq U_\\epsilon \\norm{w_t}_c + U_\\epsilon'")
('3', '\\qty{\\alpha_t}')
('3', '\\begin{aligned}\n      \\alpha_t \\doteq \\frac{\\alpha}{(t+t_0)^{\\epsilon_\\alpha}}, \n    \n\\end{aligned}')
('3', '\\epsilon_\\alpha \\in (0.5, 1), \\alpha > 0, t_0 > 0')
('3', '\\qty{\\beta_t}')
('3', '\\begin{aligned}\n    \\beta_t \\doteq \\frac{\\beta}{(t+t_0)^{\\epsilon_\\beta}},\n    \n\\end{aligned}')
('3', '\\epsilon_\\beta \\in (\\epsilon_\\alpha, 1], \\beta \\in (0, \\alpha)')
('3', 'L_\\theta > 0')
('3', '\\forall t')
('3', '\\begin{aligned}\n      \\label{eq konda actor update}\n      \\norm{\\theta_{t+1} - \\theta_t}_c \\leq \\beta_t L_\\theta.\n    \n\\end{aligned}')
('3', '\\qty{w_t}')
('3', '\\qty{\\theta_t}')
('3', '\\qty{\\alpha_t}')
('3', '\\qty{\\beta_t}')
('3', '\\qty{\\alpha_t}')
('3', '\\qty{\\beta_t}')
('3', 't_0')
('3', '\\qty{\\alpha_t}')
('3', '\\qty{\\beta_t}')
('3', '\\begin{aligned}\n      \\epsilon_w \\in (0, \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}),\n    \n\\end{aligned}')
('3', 't_0')
('3', '\\forall t')
('3', '\\begin{aligned}\n      \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_c^2\\right] =\\mathcal{O}\\left(\\frac{1}{(t+t_0)^{\\epsilon_w}}\\right).\n    \n\\end{aligned}')
('3', '\\mathcal{O}(\\cdot)')
('3', 't_0')
('3', 't_0')
('3', 't')
('3', '\\mathcal{O}\\left(\\frac{1}{t^{\\epsilon_\\alpha}}\\right)')
('3', '2(\\epsilon_\\beta - \\epsilon_\\alpha) > \\epsilon_\\alpha')
('3', '\\mathcal{O}\\left(\\frac{1}{t^{\\epsilon_w}}\\right)')
('3', '\\mathcal{O}\\left(\\frac{1}{t^{\\epsilon_\\alpha}}\\right)')
('4', 'S_0 \\sim p_0(\\cdot)')
('4', 't \\gets 0')
('4', '\\pi_\\theta')
('4', 't')
('4', 'A_t')
('4', '\\mu_{\\theta_t}')
('4', '\\theta')
('4', '\\mu_\\theta')
('4', '\\pi_\\theta')
('4', 'R_{t+1}')
('4', 'S_{t+1}')
('4', '\\pi_{\\theta_t}')
('4', '\\theta_t')
('4', '\\Pi: \\mathbb{R}\\to \\mathbb{R}')
('4', '\\begin{aligned}\n  \\Pi(x) \\doteq \\begin{cases}\n    x, &\\abs{x} \\leq C_\\Pi \\\\\n    C_\\Pi \\frac{x}{\\abs{x}}, & \\text{otherwise} \n  \\end{cases},\n\\end{aligned}')
('4', 'C_\\Pi \\doteq \\frac{r_{max}}{1 - \\gamma}')
('4', '\\mathcal{U}_\\mathcal{A}')
('4', '\\pi_{\\theta_t}(\\cdot | S_t)')
('4', '\\lambda_t')
('4', '\\pi_\\theta')
('4', '\\lambda_t')
('4', '\\pi_\\theta')
('4', '\\lambda_t')
('4', '\\lambda_t')
('4', '\\qty{\\alpha_t}, \\qty{\\beta_t}')
('4', '\\qty{\\lambda_t}')
('4', '\\begin{aligned}\n    \\alpha_t &\\doteq \\frac{\\alpha}{(t+t_0)^{\\epsilon_\\alpha}}, \\,\n    \\beta_t \\doteq \\frac{\\beta}{(t+t_0)^{\\epsilon_\\beta}}, \\,\n    \\lambda_t \\doteq \\frac{\\lambda}{(t+t_0)^{\\epsilon_\\lambda}},\n  \n\\end{aligned}')
('4', '0.5 < \\epsilon_\\alpha < \\epsilon_\\beta \\leq 1, \\epsilon_\\lambda >0, \\alpha > \\beta > 0, \\lambda > 0, t_0 > 0')
('4', '2(1-\\epsilon_\\beta) < \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}, 0 \\leq \\epsilon_\\lambda < \\frac{1 - \\epsilon_\\beta}{2}')
('4', '\\theta_t')
('4', '\\mu_\\theta')
('4', 'L_\\mu > 0')
('4', "\\forall \\theta, \\theta', a, s")
('4', "\\begin{aligned}\n    \\norm{\\mu_\\theta(a|s) - \\mu_{\\theta'}(a|s)} &\\leq L_\\mu \\norm{\\theta - \\theta'}.\n  \n\\end{aligned}")
('4', '\\pi_\\theta')
('4', '\\pi_\\theta')
('4', 'L_\\pi > 0')
('4', "\\forall \\theta, \\theta', a, s")
('4', "\\begin{aligned}\n    \\label{eq pi lipschitz}\n    \\norm{\\pi_\\theta(a|s) - \\pi_{\\theta'}(a|s)} &\\leq L_\\pi \\norm{\\theta - \\theta'}.\n\\end{aligned}")
('4', '\\bar \\Lambda_\\mu')
('4', '\\qty{\\mu_\\theta \\mid \\theta \\in \\mathbb{R}^{|\\mathcal{S}\\times \\mathcal{A}|}}')
('4', '\\mu \\in \\bar \\Lambda_\\mu')
('4', '\\mu')
('4', '\\mu(a|s) > 0')
('4', '\\mu_\\theta')
('4', "\\mu_\\theta'")
('4', "\\begin{aligned}\n  \\label{eq mu example}\n  \\mu_\\theta(\\cdot | s) \\doteq (1 - \\epsilon) \\mathcal{U}_\\mathcal{A}+ \\epsilon \\mu_\\theta'(\\cdot | s)\n\\end{aligned}")
('4', '\\epsilon \\in (0, 1)')
('4', 'd_{\\mu} \\in \\mathbb{R}^{|\\mathcal{S}|}')
('4', '\\mu')
('4', 'd_\\mu \\in \\mathbb{R}^{|\\mathcal{S}\\times \\mathcal{A}|}')
('4', '\\mu')
('4.0', 'q_t')
('4.0', "\\begin{aligned}\n  \\bar F_\\theta(q) \\doteq \\sum_{s, a, s'} d_{\\mu_\\theta}(s) \\mu_\\theta(a|s) p(s'|s, a) F_\\theta(q, s, a, s').\n\\end{aligned}")
('4.0', '\\begin{aligned}\n  \\label{eq definition of bar f theta}\n  \\bar F_{\\theta}(q) &=  D_{\\mu_\\theta}(r + \\gamma P_{\\pi_\\theta} q - q) + q \\\\\n  &=(I - D_{\\mu_\\theta}(I - \\gamma P_{\\pi_\\theta})) q  + D_{\\mu_\\theta} r,\n\\end{aligned}')
('4.0', 'D_{\\mu_\\theta} \\in \\mathbb{R}^{{|\\mathcal{S}\\times \\mathcal{A}|}\\times {|\\mathcal{S}\\times \\mathcal{A}|}}')
('4.0', 'D_{\\mu_\\theta}((s, a), (s, a)) \\doteq d_{\\mu_\\theta}(s) \\mu_\\theta(a|s)')
('4.0', 'P_{\\pi_\\theta} \\in \\mathbb{R}^{{|\\mathcal{S}\\times \\mathcal{A}|}\\times {|\\mathcal{S}\\times \\mathcal{A}|}}')
('4.0', '\\pi_\\theta')
('4.0', "\\begin{aligned}\n  P_{\\pi_\\theta}((s, a), (s', a')) \\doteq p(s'|s, a)\\pi_\\theta(a'|s').\n\\end{aligned}")
('4.0', '\\ell_p')
('4.0', '\\kappa \\in (0, 1)')
('4.0', "\\theta, q, q' \\in \\mathbb{R}^{|\\mathcal{S}\\times \\mathcal{A}|}")
('4.0', "\\begin{aligned}\n    \\norm{\\bar F_\\theta(q) - \\bar F_\\theta(q')}_p \\leq \\kappa \\norm{q - q'}_p.\n  \n\\end{aligned}")
('4.0', 'q_{\\pi_\\theta}')
('4.0', '\\bar F_\\theta')
('4.0', '\\begin{aligned}\n    \\epsilon_q \\in (0, \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}),\n  \n\\end{aligned}')
('4.0', 't_0')
('4.0', '\\qty{q_t}')
('4.0', '\\begin{aligned}\n    \\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}^2_p\\right] = \\mathcal{O}\\left(\\frac{1}{t^{\\epsilon_q}}\\right).\n  \n\\end{aligned}')
('4.0', '\\mathcal{O}\\left(\\cdot\\right)')
('4.0', '\\begin{aligned}\n  D_{\\mu_\\theta}(\\gamma P_{\\pi_\\theta} - I).\n\\end{aligned}')
('4.0', '\\zeta > 0')
('4.0', 'x, \\theta')
('4.0', '\\begin{aligned}\n  x^\\top D_{\\mu_\\theta}(\\gamma P_{\\pi_\\theta} - I) x \\leq -\\xi \\norm{x}^2.\n\\end{aligned}')
('4.1', '\\begin{aligned}\n    \\epsilon_q \\in \\Big(2(1-\\epsilon_\\beta), \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}\\Big).\n  \n\\end{aligned}')
('4.1', 't_0')
('4.1', '\\qty{\\theta_t}')
('4.1', 't > 0')
('4.1', 'k')
('4.1', '\\qty{\\ceil{\\frac{t}{2}}, \\ceil{\\frac{t}{2}} + 1, \\dots, t}')
('4.1', '\\ceil{\\cdot}')
('4.1', '\\begin{aligned}\n    \\label{eq optimality actor sub optimality}\n    J(\\pi_{\\theta_k}; p_0) \\geq J(\\pi_*; p_0) - \\mathcal{O}\\left(\\lambda_k \\right)\n  \n\\end{aligned}')
('4.1', '\\begin{aligned}\n    \\label{eq optimality actor high prob}\n    1 - \\mathcal{O}\\left(\\frac{1}{t^{1-\\epsilon_\\beta - 2\\epsilon_\\lambda}} + \\frac{\\log^2 t}{t^{\\epsilon_\\beta- 2\\epsilon_\\lambda}} + \\frac{1}{t^{\\epsilon_q- 2\\epsilon_\\lambda }}\\right),\n  \n\\end{aligned}')
('4.1', '\\pi_*')
('4.1', '\\frac{1}{2}')
('4.1', '\\ceil{\\frac{t}{2}}')
('4.1', '\\mathcal{O}(\\cdot)')
('4.1', '\\epsilon_\\alpha')
('4.1', '\\epsilon_\\beta')
('4.1', '\\epsilon_0')
('4.1', '\\begin{aligned}\n  \\label{eq optimal lr}\n  \\epsilon_\\beta = \\frac{3}{4} + \\epsilon_0, \\,\\epsilon_\\alpha = \\frac{1}{2} + \\epsilon_0, \\,\n  \\epsilon_q = \\frac{1}{2} - \\epsilon_0.\n\\end{aligned}')
('4.1', '\\begin{aligned}\n  1 - \\mathcal{O}\\left(t^{-\\left(\\frac{1}{4} - \\epsilon_0 - 2\\epsilon_\\lambda \\right)}\\right)\n\\end{aligned}')
('4.1', '\\begin{aligned}\n  J(\\pi_{\\theta_k}; p_0) \\geq J(\\pi_*; p_0) - \\mathcal{O}\\left(k^{-\\epsilon_\\lambda} \\right).\n\\end{aligned}')
('4.1', '\\begin{aligned}\n  \\label{eq optimal reg}\n\\epsilon_\\lambda \\in (0, \\frac{1}{8})\n\\end{aligned}')
('4.1', '\\epsilon_\\lambda')
('4.1', 'p_0')
('4.1', 'p_0(s) > 0')
('4.1', 'p_0(s) > 0')
('4.1', "p_0'")
('4.1', "p_0'(s) > 0")
('4.1', "J(\\pi_\\theta; p_0')")
('4.1', 'J(\\pi_\\theta; p_0)')
('4.1', "J(\\pi_\\theta; p_0')")
('4.1', 'J(\\pi_\\theta; p_0)')
('4.1', "J(\\pi_\\theta; p_0')")
('4.1', "p_0'")
('4.1', 'p_0')
('4.1', "p_0'")
('4.1', 'p_0(s) > 0')
('4.1', 'p_0')
('4.1', '\\pi_*')
('5', '\\pi')
('5', '\\begin{aligned}\n  \\tilde v_{\\pi, \\eta}(s) \\doteq& \\mathbb{E}\\left[\\sum_{i=0}^\\infty \\gamma^{i} \\Big(r(S_{t+i}, A_{t+i}) + \\eta \\mathbb{H}\\left(\\pi(\\cdot | S_{t+i})\\right)  \\Big) \\mid S_t = s, \\pi\\right] \\\\\n  =& v_\\pi(s) + \\eta \\mathbb{E}\\left[\\sum_{i=0}^\\infty \\gamma^{i}  \\mathbb{H}\\left(\\pi(\\cdot | S_{t+i})\\right) \\mid S_t = s, \\pi\\right],\n\\end{aligned}')
('5', '\\begin{aligned}\n  \\mathbb{H}\\left(\\pi(\\cdot | s)\\right) \\doteq -\\sum_a \\pi(a|s) \\log \\pi(a|s)\n\\end{aligned}')
('5', '\\eta \\geq 0')
('5', '\\pi')
('5', "\\begin{aligned}\n  \\label{eq definition of soft q}\n  \\tilde q_{\\pi, \\eta}(s, a) \\doteq r(s, a) + \\gamma \\sum_{s'} p(s'|s, a) \\tilde v_{\\pi, \\eta}(s'),\n\\end{aligned}")
('5', "\\begin{aligned}\n  \\tilde q_{\\pi,\\eta}(s, a) = r(s, a) + \\gamma \\sum_{s', a'} p(s' | s, a) \\pi(a'|s') \\left(\\tilde q_{\\pi, \\eta}(s, a) - \\eta \\log \\pi(a'|s')\\right).\n\\end{aligned}")
('5', '\\begin{aligned}\n  \\label{eq relationship J tilde J}\n  \\tilde J_\\eta(\\pi; p_0) \\doteq& \\sum_s p_0(s) \\tilde v_{\\pi, \\eta}(s) = J(\\pi; p_0) + \\frac{\\eta}{1-\\gamma} \\sum_s d_{\\pi, \\gamma, p_0}(s) \\mathbb{H}\\left(\\pi(\\cdot | s)\\right).\n\\end{aligned}')
('5', '\\pi')
('5', '\\begin{aligned}\n  \\nabla \\tilde J_\\eta(\\pi_\\theta; p_0) = \\frac{1}{1-\\gamma} \\sum_s d_{\\pi_\\theta, \\gamma, p_0}(s)  \\sum_a \\left(\\tilde q_{\\pi_\\theta, \\eta}(s, a) - \\eta \\log \\pi_\\theta(a|s) \\right) \\nabla \\pi_\\theta(a|s).\n\\end{aligned}')
('5', '\\nabla \\tilde J_\\eta(\\pi_\\theta; p_0)')
('5', 'd_{\\pi_\\theta, \\gamma, p_0}')
('5', 'S_0 \\sim p_0(\\cdot)')
('5', 't \\gets 0')
('5', '\\Pi')
('5', '\\begin{aligned}\n  C_\\Pi \\doteq \\frac{r_{max} + \\lambda \\log {|\\mathcal{A}|}}{1-\\gamma},\n\\end{aligned}')
('5', '\\lambda_t')
('5', '\\log {|\\mathcal{A}|}')
('5', 'A_t')
('5', '\\theta_t')
('5', '\\log \\pi_{\\theta_t}(A_t|S_t)')
('5', '\\qty{\\lambda_t}')
('5', '\\pi_{\\theta_t}')
('5', '\\abs{\\log\\pi_{\\theta_t}(A_t|S_t)}')
('5', '\\qty{\\lambda_t}')
('5', '\\epsilon_\\lambda > 1 - \\epsilon_\\beta')
('5', '\\abs{\\lambda_t \\log\\pi_{\\theta_t}(A_t|S_t)}')
('5', '\\qty{\\lambda_t}')
('5', '\\eta')
('5', '\\qty{q_t}')
('5', '\\qty{q_t}')
('5', '\\theta_t')
('5', '\\lambda_t')
('5', '\\begin{aligned}\n  \\zeta_t \\doteq \\mqty[\\lambda_t \\\\ \\theta_t], \\, \\zeta \\doteq \\mqty[\\eta \\\\ \\theta].\n\\end{aligned}')
('5', '\\zeta')
('5', '\\zeta_t')
('5', '\\qty{q_t}')
('5', '\\begin{aligned}\n  q_{t+1} = q_t + \\alpha_t (F_{\\zeta_t}(q_t, S_t, A_t, S_{t+1}) - q_t),\n\\end{aligned}')
('5', '\\begin{aligned}\n  F_\\zeta(q, s_0, a_0, s_1)[s, a] &\\doteq  \\delta_\\zeta(q, s_0, a_0, s_1) \\mathbb{I}_{(s_0, a_0) = (s, a)} + q(s, a), \\\\\n  \\delta_\\zeta(q, s_0, a_0, s_1) &\\doteq r(s_0, a_0) + \\gamma \\sum_{a_1} \\pi_{\\theta}(a_1 | s_1) \\left(q(s_1, a_1) - \\eta \\log \\pi_\\theta(a_1 | s_1)\\right) - q(s_0, a_0).\n\\end{aligned}')
('5', '\\qty{q_t}')
('5', '\\ell_p')
('5', '\\begin{aligned}\n    \\epsilon_q \\in (0, \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}),\n  \n\\end{aligned}')
('5', 't_0')
('5', '\\qty{q_t}')
('5', '\\begin{aligned}\n    \\mathbb{E}\\left[\\norm{q_t - \\tilde q_{\\pi_{\\theta_t}, \\lambda_t}}^2_p\\right] = \\mathcal{O}\\left(\\frac{1}{t^{\\epsilon_q}}\\right).\n  \n\\end{aligned}')
('5', '\\zeta_t')
('5', '\\theta_t')
('5', '\\qty{\\theta_t}')
('5', '\\begin{aligned}\n    \\epsilon_q \\in \\Big(0, \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}\\Big).\n  \n\\end{aligned}')
('5', 't_0')
('5', '\\epsilon_0 > 0')
('5', "p_0'")
('5', '\\qty{\\theta_t}')
('5', 't > 0')
('5', 'k')
('5', '\\qty{\\ceil{\\frac{t}{2}}, \\ceil{\\frac{t}{2}} + 1, \\dots, t}')
('5', "\\begin{aligned}\n    \\norm{\\nabla \\tilde J_{\\lambda_k}(\\pi_{\\theta_k}; p_0')}^2 \\leq \\frac{1}{k^{\\epsilon_0}}\n  \n\\end{aligned}")
('5', '\\begin{aligned}\n    1 - \\mathcal{O}\\left(\\frac{1}{t^{1-\\epsilon_\\beta - \\epsilon_0}} + \\frac{\\log^2t}{t^{\\epsilon_\\beta-\\epsilon_0}} + \\frac{1}{t^{\\epsilon_q -\\epsilon_0}}\\right).\n  \n\\end{aligned}')
('5', '\\epsilon_0')
('5', '\\epsilon_0')
('5', '\\begin{aligned}\n    \\epsilon_q \\in \\Big(0, \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}\\Big).\n  \n\\end{aligned}')
('5', 't_0')
('5', '\\qty{\\delta_t}')
('5', '\\qty{\\theta_t}')
('5', 't > 0')
('5', 'k')
('5', '\\qty{\\ceil{\\frac{t}{2}}, \\ceil{\\frac{t}{2}} + 1, \\dots, t}')
('5', '\\begin{aligned}\n    % \\tilde J_{\\lambda_k}(\\pi_{\\theta_k}; p_0) \\geq \\tilde J_{\\lambda_k}(\\pi_{*, \\lambda_k}; p_0) - \\fO\\left(\\frac{\\delta_k}{\\lambda_k \\left(\\min_{s, a} \\pi_{\\theta_k}(a|s)\\right)^2}\\right)\n    J(\\pi_{\\theta_k}; p_0) \\geq J(\\pi_*; p_0) - \\mathcal{O}\\left(\\lambda_k\\right) - \\mathcal{O}\\left(\\frac{\\delta_k}{\\lambda_k \\left(\\min_{s, a} \\pi_{\\theta_k}(a|s)\\right)^2}\\right)\n  \n\\end{aligned}')
('5', '\\begin{aligned}\n    1 - \\frac{\\mathcal{O}\\left(t^{-(1-\\epsilon_\\beta)} + t^{-\\epsilon_\\beta} \\log^2t + t^{-\\epsilon_q}\\right)}{\\delta_t},\n  \n\\end{aligned}')
('5', '\\pi_*')
('5', '\\qty{\\delta_t}')
('5', '\\begin{aligned}\n  \\label{eq conjecture}\n  \\lim_{t\\to\\infty} \\frac{t^{-(1-\\epsilon_\\beta)} + t^{-\\epsilon_\\beta} \\log^2t + t^{-\\epsilon_q}}{\\lambda_t \\left(\\min_{s, a} \\pi_{\\theta_t}(a|s)\\right)^2} = 0.\n\\end{aligned}')
('5', '\\min_{s, a}\\pi_{\\theta_t}(a|s)')
('5', '\\lambda_t')
('5', '\\min_{s, a}\\pi_{\\theta_t}(a|s)')
('5', '\\lambda_t')
('5', '\\alpha_t')
('5', '\\beta_t')
('5', '\\min_{s, a}\\pi_{\\theta_t}(a|s)')
('5', '\\min_{s, a}\\pi_{\\theta_t}(a|s)')
('6', 'F_{\\theta_t}(w_t, Y_t)')
('6', '\\bar F(w_t)')
('6', 'F(w_t, Y_t)')
('6', '\\qty{Y_t}')
('7', '\\gamma = 0.99')
('7', 'N')
('7', 's_1')
('7', 's_i')
('7', 's_{i+1}')
('7', '0')
('7', 'i < N')
('7', 's_N')
('7', '1')
('7', '0.8 \\times \\gamma^{N-1}')
('7', '\\gamma^{N-1}')
('7', '\\begin{aligned}\n  \\mu_\\theta(\\cdot|s) \\doteq& 0.1 \\times \\frac{1}{2} + 0.9 \\times \\frac{\\exp(0.1 \\times \\theta_{s,\\cdot})}{\\exp(0.1 \\times \\theta_{s,\\texttt{solid}}) + \\exp(0.1 \\times \\theta_{s,\\texttt{dotted}})}.\n\\end{aligned}')
('7', '\\qty{\\alpha_t, \\beta_t, \\lambda_t}')
('7', '\\begin{aligned}\n  \\alpha_t &\\doteq \\frac{100 + 1}{(t + 10^5)^{0.5+0.001}}, \\\\\n  \\beta_t &\\doteq \\frac{100}{(t+10^5)^{0.75 + 0.001}}, \\\\\n  \\lambda_t &\\doteq \\frac{0.025}{(t + 10^5)^{\\epsilon_\\lambda}},\n\\end{aligned}')
('7', '\\epsilon_\\lambda')
('7', '\\qty{2^{-5}, 2^{-4}, 2^{-3}, 2^{-1}, 2}')
('7', '\\epsilon_\\lambda = 2^{-2}')
('7', '\\epsilon_\\lambda = 1')
('7', '\\epsilon_\\lambda = 2^{-1}')
('7', '\\epsilon_\\lambda = 2')
('7', '2\\times 10^6')
('7', '2 \\times 10^3')
('7', 'N \\in \\qty{6, 7}')
('7', '\\epsilon_\\lambda \\in \\qty{2^{-1}, 2}')
('7', '\\epsilon_\\lambda = 2^{-1}')
('7', '\\epsilon_\\lambda = 2')
('7', 'N')
('7', 'N')
('7', 'N \\in \\qty{8, 9}')
('7', '\\epsilon_\\lambda')
('7', '\\epsilon_\\lambda')
('7', '\\epsilon_\\lambda')
('9.0', 'P \\in \\bar \\Lambda_P')
('9.0', '\\mathbb{I}_P \\in \\qty{0, 1}^{{|\\mathcal{Y}|}\\times {|\\mathcal{Y}|}}')
('9.0', "\\begin{aligned}\n      \\mathbb{I}_P[y, y'] = \\begin{cases}\n          1, & P[y, y'] > 0 \\\\\n          0, & P[y, y'] = 0\n      \\end{cases}.\n  \n\\end{aligned}")
('9.0', 'M_P')
('9.0', "\\begin{aligned}\n      M_P(i, j) = \\frac{\\mathbb{I}_P(i, j)}{\\sum_{j'} \\mathbb{I}_P(i, j')}.\n  \n\\end{aligned}")
('9.0', 'P')
('9.0', 'M_P')
('9.0', 'M_P')
('9.0', 'P')
('9.0', 't_P > 0')
('9.0', 't \\geq t_P')
('9.0', '\\begin{aligned}\n      M^t_P(i, j) > 0\n  \n\\end{aligned}')
('9.0', 'i, j')
('9.0', 'P^t(i, j) > 0')
('9.0', 'M_P')
('9.0', 'P')
('9.0', '\\begin{aligned}\n    \\label{eq connectivity induction}\n    \\forall t \\geq 1, i, j, \\, M_P^t(i, j) > 0 \\implies P^t(i, j) > 0.\n  \n\\end{aligned}')
('9.0', 't=1')
('9.0', 't \\leq k')
('9.0', '\\begin{aligned}\n    M_P^{k+1}(i, j) = \\sum_l M_P^k(i, l) M_P(l, j) > 0,\n  \n\\end{aligned}')
('9.0', 'l')
('9.0', 'M_P^k(i, l) M_P(l, j) > 0')
('9.0', '\\begin{aligned}\n    M_P^k(i, l) > 0, M_P(l, j) > 0.\n  \n\\end{aligned}')
('9.0', '\\begin{aligned}\n    P^k(i, l) > 0, P(l, j) > 0,\n  \n\\end{aligned}')
('9.0', 'P^{k+1}(i, j) > 0')
('9.0', '\\mathcal{Y}')
('9.0', '\\qty{\\mathbb{I}_P | P \\in \\bar \\Lambda_P}')
('9.0', '2^{{|\\mathcal{Y}|}\\times {|\\mathcal{Y}|}}')
('9.0', '\\qty{M_P | P \\in \\bar \\Lambda_P}')
('9.0', '\\qty{t_P | P \\in \\bar \\Lambda_P}')
('9.0', '\\begin{aligned}\n      t_* \\doteq \\max_{P \\in \\bar \\Lambda_P}\\qty{t_P},\n  \n\\end{aligned}')
('9.0', 'P \\in \\bar \\Lambda_P')
('9.0', 'P^{t_*} (i, j) > 0')
('9.0', 't_*')
('9.0', 'P')
('9.0', '\\begin{aligned}\n      \\delta \\doteq \\inf_{P \\in \\bar \\Lambda_P, i, j} P^{t_*}(i, j) > 0.\n  \n\\end{aligned}')
('9.0', 'd_P')
('9.0', 'P')
('9.0', "\\delta'")
('9.0', "0 < \\delta' < \\delta")
('9.0', "\\begin{aligned}\n      P^{t_*}(i, j) > \\delta' \\geq \\delta' d_P(j) \n  \n\\end{aligned}")
('9.0', 'P \\in \\bar \\Lambda_P, i, j')
('9.0', 'P \\in \\bar \\Lambda_P')
('9.0', '\\Pi')
('9.0', 'd_P^\\top')
('9.0', "\\begin{aligned}\n      \\zeta \\doteq 1 - \\delta'.\n  \n\\end{aligned}")
('9.0', '\\begin{aligned}\n      Q \\doteq \\frac{P^{t_*} + \\zeta \\Pi - \\Pi}{\\zeta}\n  \n\\end{aligned}')
('9.0', '1')
('9.0', '\\begin{aligned}\n    (Q{\\textbf{1}})(i) \\doteq \\frac{1 + \\zeta - 1}{\\zeta} = 1.\n  \n\\end{aligned}')
('9.0', "\\begin{aligned}\n   Q(i, j) = \\frac{P^{t_*}(i, j) + \\zeta d_P(j) - d_P(j)}{\\zeta} \\geq \\frac{\\delta' d_P(j) + \\zeta d_P(j) - d_P(j)}{\\zeta} = 0.\n  \n\\end{aligned}")
('9.0', '\\begin{aligned}\n      \\label{eq tmp 1}\n      P^{t_*} = (1 - \\zeta)\\Pi + \\zeta Q.\n  \n\\end{aligned}')
('9.0', 'k \\geq 1')
('9.0', '\\begin{aligned}\n    \\label{eq tmp 2}\n      P^{t_*k} = (1 - \\zeta^k) \\Pi + \\zeta^k Q^k.\n  \n\\end{aligned}')
('9.0', 'k=1')
('9.0', 'k=n')
('9.0', '\\begin{aligned}\n      P^{t_*(n+1)} &= P^{t_*n}P^{t_*} \\\\\n      &= \\left((1 - \\zeta^n) \\Pi + \\zeta^n Q^n \\right) P^{t_*} \\\\\n      &= (1 - \\zeta^n) \\Pi P^{t_*} + \\zeta^n Q^n \\left((1 - \\zeta)\\Pi + \\zeta Q\\right) \\\\\n      &= (1 - \\zeta^n) \\Pi P^{t_*} + (1 - \\zeta)\\zeta^n Q^n \\Pi +  \\zeta^{n+1} Q^{n+1} \\\\\n      &= (1 - \\zeta^n) \\Pi + (1 - \\zeta)\\zeta^n Q^n \\Pi +  \\zeta^{n+1} Q^{n+1} \\\\\n      \\intertext{\\hfill (Property of invariant distribution)}\n      &= (1 - \\zeta^n) \\Pi + (1 - \\zeta)\\zeta^n \\Pi +  \\zeta^{n+1} Q^{n+1} \\\\\n      \\intertext{\\hfill ($Q\\Pi = Q1 d_P^\\top = 1 d_P^\\top = \\Pi$ for any stochastic matrix $Q$)}\n      &= (1 - \\zeta^{n+1}) \\Pi + \\zeta^{n+1} Q^{n+1},\n  \n\\end{aligned}')
('9.0', 'l \\in \\qty{0, 1, \\dots, t_* - 1}')
('9.0', 'P^l')
('9.0', '\\begin{aligned}\n      P^{t_*k + l} &= (1 - \\zeta^k) \\Pi P^l + \\zeta^k Q^kP^l \\\\\n      &=(1 - \\zeta^k) \\Pi + \\zeta^k Q^kP^l.\n  \n\\end{aligned}')
('9.0', '\\begin{aligned}\n      P^{t_*k + l} - \\Pi = \\zeta^k(Q^kP^l - \\Pi),\n  \n\\end{aligned}')
('9.0', 'i')
('9.0', '\\begin{aligned}\n      \\sum_{j} \\abs{P^{t_*k+l}(i, j) - d_P(j)} &= \\zeta^k \\sum_j \\abs{(Q^kP^l)(i, j) - d_P(j)} \\\\\n      &\\leq 2 \\zeta^k \n      \\qq{\\hfill (Boundedness of total variation)} \\\\\n      &= 2 \\zeta^{-\\frac{l}{t_*}} \\left(\\zeta^{\\frac{1}{t_*}}\\right)^{t_* k + l} \\\\\n      &\\leq 2 \\zeta^{-\\frac{t_*-1}{t_*}}\\left(\\zeta^{\\frac{1}{t_*}}\\right)^{t_* k + l}.\n  \n\\end{aligned}')
('9.0', "\\begin{aligned}\n    C_0' \\doteq 2 \\zeta^{-\\frac{t_*-1}{t_*}}, \\tau \\doteq \\zeta^{\\frac{1}{t_*}}.\n  \n\\end{aligned}")
('9.0', "C_0' > 0, \\tau \\in (0, 1)")
('9.0', 'C_0')
('9.0', '\\tau')
('9.0', 'P')
('9.0', 'n \\geq t_*')
('9.0', "\\begin{aligned}\n    \\sum_j \\abs{P^n(i, j) - d_P(j)} \\leq C_0' \\tau^n.\n  \n\\end{aligned}")
('9.0', 'n \\in \\qty{0, 1, \\dots, t_* - 1}')
('9.0', '\\begin{aligned}\n    \\sum_j \\abs{P^n(i, j) - d_P(j)} \\leq 2 \\leq \\frac{2}{\\tau^{t_*}} \\tau^n.\n  \n\\end{aligned}')
('9.0', "C_0 \\doteq \\max\\qty{C_0', \\frac{2}{\\tau^{t_*}}}")
('9.1', '\\qty{\\theta_t}')
('9.1', '\\frac{1}{2}\\norm{\\cdot}_c^2')
('9.1', '\\begin{aligned}\n  M(w) \\doteq \\inf_{u\\in\\mathbb{R}^K}\\qty{\\frac{1}{2} \\norm{u}_c^2 + \\frac{1}{2 \\xi} \\norm{w - u}_s^2},\n\\end{aligned}')
('9.1', '\\xi > 0')
('9.1', '\\norm{\\cdot}_c')
('9.1', '\\bar F_\\theta')
('9.1', '\\norm{\\cdot}_s')
('9.1', '\\frac{1}{2}\\norm{\\cdot}_s^2')
('9.1', 'L')
('9.1', '\\ell_p')
('9.1', 'p \\geq 2')
('9.1', 'l_{cs}')
('9.1', 'u_{cs}')
('9.1', '\\begin{aligned}\n  l_{cs} \\norm{w}_s \\leq \\norm{w}_c \\leq u_{cs} \\norm{w}_s\n\\end{aligned}')
('9.1', 'w')
('9.1', 'M')
('9.1', 'M(w)')
('9.1', '\\frac{L}{\\xi}')
('9.1', '\\norm{\\cdot}_s')
('9.1', '\\norm{\\cdot}_m')
('9.1', 'M(w) = \\frac{1}{2}\\norm{w}_m^2')
('9.1', '\\begin{aligned}\n            &l_{cm} = \\sqrt{(1 + \\xi l_{cs}^2)} \\\\\n            &u_{cm} = \\sqrt{(1 + \\xi u_{cs}^2)},\n        \n\\end{aligned}')
('9.1', '\\forall w')
('9.1', '\\begin{aligned}\n            l_{cm}\\norm{w}_m \\leq \\norm{w}_c \\leq u_{cm} \\norm{w}_m.\n        \n\\end{aligned}')
('9.1', "x, x'")
('9.1', "\\begin{aligned}\n    M(x') \\leq M(x) + {\\left<\\nabla M(x), x' - x\\right>} + \\frac{L}{2\\xi} \\norm{x - x'}_s^2.\n\\end{aligned}")
('9.1', "x' = w_{t+1} - w^*_{\\theta_{t+1}}")
('9.1', 'x = w_t - w^*_{\\theta_t}')
('9.1', '\\begin{aligned}\n    w_{t+1} \\doteq w_t + \\alpha_t (F_{\\theta_t}(w_t, Y_t) - w_t + \\epsilon_t),\n\\end{aligned}')
('9.1', '\\begin{aligned}\n  \\label{eq expansion of M}\n  &\\frac{1}{2} \\norm{w_{t+1} - w^*_{\\theta_{t+1}}}_m^2 \\\\\n  \\leq& \\frac{1}{2}\\norm{w_t - w^*_{\\theta_t}}_m^2 + {\\left<\\nabla M(w_t - w^*_{\\theta_t}), w_{t+1} - w_t + w^*_{\\theta_t} - w^*_{\\theta_{t+1}}\\right>} \\\\\n  &+ \\frac{L}{2\\xi} \\norm{w_{t+1} - w_t + w^*_{\\theta_t} - w^*_{\\theta_{t+1}}}^2_s \\\\\n  =&\\frac{1}{2}\\norm{w_t - w^*_{\\theta_t}}_m^2 \\\\\n  &+ \\underbrace{{\\left<\\nabla M(w_t - w^*_{\\theta_t}), w^*_{\\theta_t} - w^*_{\\theta_{t+1}}\\right>}}_{T_1} \\\\\n  &+ \\alpha_t \\underbrace{{\\left<\\nabla M(w_t - w^*_{\\theta_t}), \\bar F_{\\theta_t}(w_t) - w_t\\right>}}_{T_2} \\\\\n  &+ \\alpha_t \\underbrace{{\\left<\\nabla M(w_t - w^*_{\\theta_t}), F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)\\right>} }_{T_3} \\\\\n  &+ \\alpha_t \\underbrace{{\\left<\\nabla M(w_t - w^*_{\\theta_t}), \\epsilon_t\\right>} }_{T_4} \\\\\n  &+ \\alpha_t^2\\underbrace{\\frac{L }{\\xi}\\norm{F_{\\theta_t}(w_t, Y_t) - w_t + \\epsilon_t}_s^2}_{T_5} \\\\\n  &+ \\underbrace{\\frac{L}{\\xi} \\norm{w^*_{\\theta_t} - w^*_{\\theta_{t+1}}}_s^2}_{T_6}.\n\\end{aligned}')
('9.1', 'T_1')
('9.1', 'T_6')
('9.1', 'T_1')
('9.1', 'T_6')
('9.1', 'T_2')
('9.1', 'T_4')
('9.1', 'T_5')
('9.1', 'T_3')
('9.1', '\\begin{aligned}\n    T_3 =& {\\left<\\nabla M(w_t - w^*_{\\theta_t}), F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)\\right>} \\\\\n    =&\\underbrace{{\\left<\\nabla M(w_t - w^*_{\\theta_t}) - \\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)\\right>}}_{T_{31}} \\\\\n    &+\\underbrace{{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) + \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)\\right>}}_{T_{32}}\\\\\n    &+\\underbrace{{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) - \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}})\\right>}}_{T_{33}},\n\\end{aligned}')
('9.1', '\\begin{aligned}\n  \\label{eq definition of tau alpha t}\n    \\tau_{\\alpha_t} \\doteq \\min\\qty{n \\geq 0 \\mid C_0 \\tau^n \\leq \\alpha_t},\n\\end{aligned}')
('9.1', 'C_0')
('9.1', '\\tau')
('9.1', '\\tau_{\\alpha_t}')
('9.1', '\\alpha_t')
('9.1', 'T_{31}')
('9.1', 'T_{32}')
('9.1', 'T_{33}')
('9.1', 'T_{33}')
('9.1', '\\begin{aligned}\n  T_{33} =& {\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) - \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}})\\right>} \\\\\n  =& \\underbrace{{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})\\right>}}_{T_{331}} + \\\\\n  & \\underbrace{{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t)\\right>}}_{T_{332}} + \\\\\n  & \\underbrace{{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t}}(w_{t- \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, Y_t)\\right>}}_{T_{333}} + \\\\\n  & \\underbrace{{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_{t}}(w_{t- \\tau_{\\alpha_t}})\\right>}}_{T_{334}}.\n\\end{aligned}')
('9.1', '\\qty{\\tilde Y_t}')
('9.1', 't - \\tau_{\\alpha_t} - 1')
('9.1', '\\qty{\\tilde Y_t}')
('9.1', '\\qty{Y_t}')
('9.1', 't - \\tau_{\\alpha_t} - 1')
('9.1', '\\tilde Y_t')
('9.1', 'P_{\\theta_{t-\\tau_{\\alpha_t}}}')
('9.1', 'Y_t')
('9.1', 'P_{\\theta_{t - \\tau_{\\alpha_t}}}, P_{\\theta_{k - \\tau_{\\alpha_t} + 1}}, \\dots')
('9.1', '\\begin{aligned}\n  \\qty{\\tilde Y_t}&: \\dots \\to Y_{t-\\tau_{\\alpha_t}-1} \\underbrace{\\to}_{P_{\\theta_{t-\\tau_{\\alpha_t}}}} Y_{t-\\tau_{\\alpha_t}} \\underbrace{\\to}_{P_{\\theta_{t-\\tau_{\\alpha_t}}}} \\tilde Y_{t-\\tau_{\\alpha_t}+1} \\underbrace{\\to}_{P_{\\theta_{t-\\tau_{\\alpha_t}}}} \\tilde Y_{t-\\tau_{\\alpha_t}+2} \\to \\dots \\\\\n  \\qty{Y_t}&: \\dots \\to Y_{t-\\tau_{\\alpha_t}-1} \\underbrace{\\to}_{P_{\\theta_{t-\\tau_{\\alpha_t}}}} Y_{t-\\tau_{\\alpha_t}} \\underbrace{\\to}_{P_{\\theta_{t-\\tau_{\\alpha_t}+1}}} Y_{t-\\tau_{\\alpha_t}+1} \\underbrace{\\to}_{P_{\\theta_{t-\\tau_{\\alpha_t}+2}}} Y_{t-\\tau_{\\alpha_t}+2} \\to \\dots.\n\\end{aligned}')
('9.1', "\\begin{aligned}\n  \\alpha_{t_1, t_2} &\\doteq \\sum_{t=t_1}^{t_2} \\alpha_t, \\quad \\beta_{t_1, t_2} \\doteq \\sum_{t=t_1}^{t_2} \\beta_t  \\\\\n  \\label{eq shorthand a and b}\n  A &\\doteq U_\\epsilon + L_F + 1, \\quad B \\doteq U_F + U_\\epsilon', \\quad C \\doteq AU_w + B + A + A(1 + U_F' + U_F'').\n\\end{aligned}")
('9.1', 't_0')
('9.1', '\\begin{aligned}\n    \\tau_{\\alpha_t} &= \\mathcal{O}(\\log (t+t_0)), \\quad \\alpha_{t-\\tau_{\\alpha_t}, t-1} = \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{\\epsilon_\\alpha}}\\right), \\\\\n    \\beta_{t-\\tau_{\\alpha_t}, t-1} &= \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{\\epsilon_\\alpha}}\\right), \\quad \\frac{\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\beta_t} = \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{2\\epsilon_\\alpha - \\epsilon_\\beta}}\\right).\n  \n\\end{aligned}')
('9.1', 't_0')
('9.1', '\\begin{aligned}\n  \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\leq \\frac{1}{4A}\n\\end{aligned}')
('9.1', 't')
('9.1', 'T_1')
('9.1', '\\begin{aligned}\n      T_1 \n      \\leq \\frac{L_w L_\\theta \\beta_t}{l_{cm}} \\norm{w_t - w^*_{\\theta_t}}_m.\n  \n\\end{aligned}')
('9.1', 'T_2')
('9.1', '\\begin{aligned}\n  T_2 \\leq -(1 - \\kappa\\frac{u_{cm}}{l_{cm}}) \\norm{w_t - w^*_{\\theta_t}}_m^2.\n\\end{aligned}')
('9.1', 'T_{31}')
('9.1', '\\begin{aligned}\n      T_{31} \\leq \\frac{8L(L_wL_\\theta + 1)  \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}^2} \\left(u_{cm}^2A^2\\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2\\right).\n  \n\\end{aligned}')
('9.1', 'T_{32}')
('9.1', '\\begin{aligned}\n      T_{32} \\leq \\frac{32 L  \\alpha_{t-\\tau_{\\alpha_t}, t-1}(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}^2} \\left( u_{cm}^2A^2\\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2 \\right).\n  \n\\end{aligned}')
('9.1', 'T_{331}')
('9.1', '\\begin{aligned}\n  \\mathbb{E}\\left[T_{331}\\right]\n  \\leq & \\frac{8L \\alpha_t(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A\\xi l_{cs}^2}\\left(u_{cm}^2 A^2 \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + C^2\\right).\n\\end{aligned}')
('9.1', 'T_{332}')
('9.1', '\\begin{aligned}\n      \\mathbb{E}\\left[T_{332}\\right]\n      \\leq \\frac{8 {|\\mathcal{Y}|}L_P L_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j} L(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A \\xi l_{cs}^2} \\left(u_{cm}^2 A^2 \\mathbb{E}\\left[ \\norm{w_t - w^*_{\\theta_t}}_m^2 \\right] + C^2\\right).\n  \n\\end{aligned}')
('9.1', 'T_{333}')
('9.1', "\\begin{aligned}\n  T_{333} \\leq \\frac{8LL_F' L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} (1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A^2 \\xi l_{cs}^2}\\left(u_{cm}^2 A^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2\\right).\n  \n\\end{aligned}")
('9.1', 'T_{334}')
('9.1', "\\begin{aligned}\n  T_{334} \\leq \\frac{8LL_F'' L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1}(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A^2 \\xi l_{cs}^2}\\left(u_{cm}^2 A^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2\\right).\n  \n\\end{aligned}")
('9.1', 'T_4')
('9.1', '\\begin{aligned}\n    \\mathbb{E}\\left[T_4\\right] = 0.\n  \n\\end{aligned}')
('9.1', 'T_5')
('9.1', '\\begin{aligned}\n      T_5 \n      \\leq \\frac{2L}{\\xi l_{cs}^2}\\left(A^2 u_{cm}^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2\\right).\n  \n\\end{aligned}')
('9.1', 'T_6')
('9.1', '\\begin{aligned}\n      T_6 = \\frac{L}{\\xi} \\norm{w^*_{\\theta_t} - w^*_{\\theta_{t+1}}}_s^2 \\leq \\frac{L L_w^2 L_\\theta^2 \\beta_t^2}{\\xi l_{cs}^2}.\n  \n\\end{aligned}')
('9.1', 'u_{cm}')
('9.1', 'l_{cm}')
('9.1', '\\begin{aligned}\n  \\lim_{\\xi \\to 0} \\frac{u_{cm}}{l_{cm}} = 1.\n\\end{aligned}')
('9.1', '\\kappa < 1')
('9.1', '\\xi > 0')
('9.1', '\\begin{aligned}\n  \\psi_1 \\doteq \\frac{2}{9} (1 - \\kappa \\frac{u_{cm}}{l_{cm}})\n\\end{aligned}')
('9.1', '\\psi_1 \\in (0, 1)')
('9.1', '\\begin{aligned}\n  T_2 &\\leq -\\frac{9}{2} \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2, \\\\\n  \\label{eq simple t2}\n  \\alpha_t T_2 &\\leq -\\frac{9}{2} \\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2.\n\\end{aligned}')
('9.1', '\\psi_2')
('9.1', 'T_1')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  \\label{eq simple t1}\n  T_1 \\leq \\frac{1}{2} \\beta_t \\psi_2 \\norm{w_t - w^*_{\\theta_t}}_m.\n\\end{aligned}')
('9.1', 'T_{31}')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  T_{31} &\\leq \\frac{1}{2} \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2, \\\\\n  \\label{eq simple t31}\n  \\alpha_t T_{31} &\\leq \\frac{1}{2}\\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', 'T_{32}')
('9.1', 't_0')
('9.1', '\\begin{aligned}\n  \\beta_{t-\\tau_{\\alpha_t}, t-1} \\leq 1.\n\\end{aligned}')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  T_{32} &\\leq \\frac{1}{2} \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2} \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2, \\\\\n  \\label{eq simple t32}\n  \\alpha_t T_{32} &\\leq \\frac{1}{2}\\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', 'T_{331}')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  \\mathbb{E}\\left[T_{331}\\right] &\\leq \\frac{1}{2} \\psi_1  \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + \\frac{1}{2} \\alpha_t \\psi_2 \\\\\n  &\\leq \\frac{1}{2} \\psi_1  \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + \\frac{1}{2} \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2, \\\\\n  \\label{eq simple t331}\n  \\alpha_t \\mathbb{E}\\left[T_{331}\\right]&\\leq \\frac{1}{2}\\alpha_t \\psi_1  \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', 'T_{332}')
('9.1', '\\begin{aligned}\n  \\frac{\\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j}}{\\alpha_{t-\\tau_{\\alpha_t}, t-1}} &\\leq \\frac{\\tau_{\\alpha_t} \\tau_{\\alpha_t} \\beta_{t-\\tau_{\\alpha_t}}}{\\tau_{\\alpha_t} \\alpha_t} = \\frac{\\tau_{\\alpha_t} \\beta_{t-\\tau_{\\alpha_t}}}{\\alpha_t} =\\mathcal{O}\\left( \\frac{\\log (t+t_0)\\beta_{t-\\tau_{\\alpha_t}}}{\\alpha_t} \\right) \\\\\n  &= \\mathcal{O}\\left(\\frac{\\log (t+t_0) \\beta_t}{\\alpha_t}\\right) \\qq{(for $t_0$ sufficiently large).}\n\\end{aligned}')
('9.1', '0')
('9.1', 't_0')
('9.1', 't_0')
('9.1', '\\begin{aligned}\n  \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j} \\leq \\alpha_{t-\\tau_{\\alpha_t}, t-1}.\n\\end{aligned}')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  \\mathbb{E}\\left[T_{332}\\right]&\\leq \\frac{1}{2} \\psi_1  \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + \\frac{1}{2} \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2, \\\\\n  \\label{eq simple t332}\n  \\alpha_t\\mathbb{E}\\left[T_{332}\\right]&\\leq \\frac{1}{2}\\alpha_t \\psi_1  \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  \\label{eq simple t333}\n  \\alpha_t T_{333}&\\leq \\frac{1}{2}\\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2, \\\\\n  \\label{eq simple t334}\n  \\alpha_t T_{334}&\\leq \\frac{1}{2}\\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', 'T_5')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  \\label{eq simple t5}\n  \\alpha_t^2 T_5 &\\leq \\frac{1}{2}\\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_t^2 \\psi_2 \\\\\n  &\\leq \\frac{1}{2}\\alpha_t \\psi_1 \\norm{w_t - w^*_{\\theta_t}}_m^2 + \\frac{1}{2}\\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', 'T_6')
('9.1', '\\beta_t < \\alpha_t')
('9.1', 't_0')
('9.1', '\\psi_2')
('9.1', '\\begin{aligned}\n  \\label{eq simple t6}\n  T_6 &\\leq \\frac{1}{2}\\alpha_t\\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2.\n\\end{aligned}')
('9.1', "\\begin{aligned}\n  \\label{eq sa bound recursive}\n  &\\mathbb{E}\\left[\\norm{w_{t+1} - w^*_{\\theta_{t+1}}}_m^2\\right] \\\\ \n  \\leq& (1 - \\psi_1\\alpha_t) \\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right] + \\beta_t\\psi_2\\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m\\right] + 8 \\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2 \\\\\n  \\leq& (1 - \\psi_1\\alpha_t) \\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right] + \\beta_t\\psi_2 \\sqrt{\\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right]} + 8 \\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2\n  \\intertext{\\hfill (Jensen's inequality).}\n\\end{aligned}")
('9.1', 't')
('9.1', 't - \\tau_{\\alpha_t} \\geq 0')
('9.1', 't_0')
('9.1', 't \\geq t_0')
('9.1', 't - \\tau_{\\alpha_t} \\geq 0')
('9.1', '\\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right]')
('9.1', 't \\leq t_0')
('9.1', 't \\geq t_0')
('9.1', 'C_{t_0, w_0}')
('9.1', 't \\leq t_0')
('9.1', '\\begin{aligned}\n    \\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right] \\leq C_{{t_0}, w_0}.\n  \n\\end{aligned}')
('9.1', 't \\geq t_0')
('9.1', 't_0')
('9.1', '\\psi_3')
('9.1', '\\begin{aligned}\n  8 \\alpha_t \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\psi_2 \\leq \\psi_3 \\frac{\\log (t+t_0)}{(t+t_0)^{2\\epsilon_\\alpha}}.\n\\end{aligned}')
('9.1', '\\begin{aligned}\n  z_t \\doteq \\sqrt{\\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right]}\n\\end{aligned}')
('9.1', '\\begin{aligned}\n  z_{t+1}^2\n  \\leq& (1-\\frac{\\alpha\\psi_1}{(t+t_0)^{\\epsilon_\\alpha}})z_t^2 + \\frac{\\beta \\psi_2 {z_t}}{(t+t_0)^{\\epsilon_\\beta}} +  \\psi_3 \\frac{\\log (t+t_0)}{(t+t_0)^{2\\epsilon_\\alpha}}.\n\\end{aligned}')
('9.1', '\\forall t\\geq t_0')
('9.1', '\\begin{aligned}\n  \\label{eq final sa rate}\n  z_t \\leq \\frac{C_0}{(t+t_0)^\\epsilon},\n\\end{aligned}')
('9.1', 'C_0 > 1')
('9.1', '\\epsilon \\in (0, 1)')
('9.1', 'z_{t_0} \\leq C_{t_0, w_0}')
('9.1', '\\begin{aligned}\n  C_0 \\geq C_{t_0, w_0} (2t_0)^\\epsilon\n\\end{aligned}')
('9.1', 't=t_0')
('9.1', 't=n')
('9.1', 't=n+1')
('9.1', "\\begin{aligned}\n  &z_{n+1}^2 \\\\\n  \\leq& (1-\\frac{\\alpha\\psi_1}{(n+t_0)^{\\epsilon_\\alpha}})z_n^2 + \\frac{\\beta \\psi_2 {z_n}}{(n+t_0)^{\\epsilon_\\beta}} +  \\psi_3 \\frac{\\log (n+t_0)}{(n+t_0)^{2\\epsilon_\\alpha}} \\\\\n  \\stackrel{(i)}{\\leq}& (1-\\frac{\\alpha\\psi_1}{(n+t_0)^{\\epsilon_\\alpha}})\\frac{C_0^2}{(n+t_0)^{2\\epsilon}} + \\frac{\\beta \\psi_2 C_0}{(n+t_0)^{\\epsilon_\\beta + \\epsilon}} +  \\psi_3 \\frac{\\log (n+t_0)}{(n+t_0)^{2\\epsilon_\\alpha}} \\\\\n  =& \\frac{C_0^2}{(n+t_0)^{2\\epsilon}} - \\frac{\\alpha\\psi_1C_0^2}{(n+t_0)^{\\epsilon_\\alpha+2\\epsilon}} + \\frac{\\beta \\psi_2 C_0}{(n+t_0)^{\\epsilon_\\beta + \\epsilon}} +  \\psi_3 \\frac{\\log (n+t_0)}{(n+t_0)^{2\\epsilon_\\alpha}} \\\\\n  \\stackrel{(ii)}{\\leq}& \\frac{C_0^2}{(n+1+t_0)^{2\\epsilon}} + \\frac{2C_0^2}{(n+t_0)^{2\\epsilon + 1}} - \\frac{\\alpha\\psi_1C_0^2}{(n+t_0)^{\\epsilon_\\alpha+2\\epsilon}} + \\frac{\\beta \\psi_2 C_0}{(n+t_0)^{\\epsilon_\\beta + \\epsilon}} +  \\psi_3 \\frac{\\log (n+t_0)}{(n+t_0)^{2\\epsilon_\\alpha}} \\\\\n  \\stackrel{}{\\leq}& \\frac{C_0^2}{(n+1+t_0)^{2\\epsilon}} + \\underbrace{\\left(\\frac{2}{(n+t_0)^{2\\epsilon + 1}} - \\frac{\\alpha\\psi_1}{(n+t_0)^{\\epsilon_\\alpha+2\\epsilon}} + \\frac{\\beta \\psi_2 }{(n+t_0)^{\\epsilon_\\beta + \\epsilon}} +  \\psi_3 \\frac{\\log (n+t_0)}{(n+t_0)^{2\\epsilon_\\alpha}}\\right)}_{z_n'}C_0^2.\n\\end{aligned}")
('9.1', '\\begin{aligned}\n  x^{-2\\epsilon} \\leq (x+1)^{-2\\epsilon} + \\frac{2}{x^{2\\epsilon+1}}.\n\\end{aligned}')
('9.1', '\\begin{aligned}\n  f(x) = x^{-2\\epsilon},\n\\end{aligned}')
('9.1', '(0, +\\infty)')
('9.1', "\\begin{aligned}\n  f(x) - f(x+1) \\leq f'(x) \\left(x - (x+1)\\right).\n\\end{aligned}")
('9.1', '\\forall n')
('9.1', "\\begin{aligned}\n  z_n' \\leq 0.\n\\end{aligned}")
('9.1', '\\epsilon')
('9.1', '\\begin{aligned}\n  \\begin{cases}\n    \\epsilon_\\alpha + 2\\epsilon < 2\\epsilon + 1 \\\\\n    \\epsilon_\\alpha + 2\\epsilon < \\epsilon_\\beta + \\epsilon \\\\\n    \\epsilon_\\alpha + 2\\epsilon < 2\\epsilon_\\alpha \\\\\n  \\end{cases}\n  \\iff\n  \\begin{cases}\n    \\epsilon_\\alpha < 1 \\\\\n    \\epsilon < \\epsilon_\\beta - \\epsilon_\\alpha \\\\\n    \\epsilon < \\frac{\\epsilon_\\alpha}{2}\n  \\end{cases}\n\\end{aligned}')
('9.1', 't_0')
('9.1', '\\epsilon')
('9.1', '\\forall t\\geq t_0')
('9.1', '\\begin{aligned}\n  \\label{eq tmp 4}\n  \\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right] \\leq \\frac{C_0^2}{(t+t_0)^{2\\epsilon}}.\n\\end{aligned}')
('9.1', '\\begin{aligned}\n  \\epsilon_w \\in (0, \\min\\qty{2(\\epsilon_\\beta - \\epsilon_\\alpha), \\epsilon_\\alpha}),\n\\end{aligned}')
('9.1', 't_0')
('9.1', '\\forall t')
('9.1', '\\begin{aligned}\n  \\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_c^2\\right] =\\mathcal{O}\\left(\\frac{1}{(t+t_0)^{\\epsilon_w}}\\right),\n\\end{aligned}')
('10.0', '\\mu \\in \\bar \\Lambda_\\mu')
('10.0', '\\begin{aligned}\n    d_\\mu(s, a) > 0.\n  \n\\end{aligned}')
('10.0', '\\begin{aligned}\n      d_{\\mu, min} \\doteq \\inf_{\\mu \\in \\bar \\Lambda_\\mu, s, a} d_\\mu(s, a) > 0.\n  \n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\label{eq definition of a theta}\n      A_\\theta \\doteq I - D_{\\mu_\\theta}(I - \\gamma P_{\\pi_\\theta}),\n  \n\\end{aligned}')
('10.0', "\\begin{aligned}\n    \\bar F_\\theta(q) - \\bar F_\\theta(q') = A_\\theta(q - q').\n  \n\\end{aligned}")
('10.0', 'A_\\theta')
('10.0', 'A_\\theta')
('10.0', 'A_\\theta')
('10.0', 'A_\\theta')
('10.0', '\\kappa_0 \\doteq 1 - (1-\\gamma)d_{\\mu, min}')
('10.0', '\\begin{aligned}\n    A_\\theta(i, i) = 1 - d_{\\mu_\\theta}(i) + \\gamma d_{\\mu_\\theta}(i) P_{\\pi_\\theta}(i, i) \\geq 0;\n  \n\\end{aligned}')
('10.0', '\\begin{aligned}\n    A_\\theta(i, j) = \\gamma (D_{\\mu_\\theta}P_{\\pi_\\theta})(i, j) \\geq 0.\n  \n\\end{aligned}')
('10.0', '\\begin{aligned}\n    {\\textbf{1}}^\\top A_\\theta = {\\textbf{1}}^\\top - d_{\\mu_\\theta}^\\top + \\gamma d_{\\mu_\\theta}^\\top P_{\\pi_\\theta}. \n  \n\\end{aligned}')
('10.0', 'd_{\\mu_\\theta}^\\top P_{\\pi_\\theta}')
('10.0', '\\begin{aligned}\n    A_\\theta {\\textbf{1}} = {\\textbf{1}} - d_{\\mu_\\theta} + \\gamma d_{\\mu_\\theta} = {\\textbf{1}} - (1 - \\gamma) d_{\\mu_\\theta}.\n  \n\\end{aligned}')
('10.0', 'i')
('10.0', '\\left(A_\\theta {\\textbf{1}}\\right)(i) > 0')
('10.0', '\\begin{aligned}\n    \\left(A_\\theta {\\textbf{1}}\\right)(i) = 1 - (1-\\gamma) d_{\\mu_\\theta}(i) \\leq 1 - (1-\\gamma) d_{\\mu, min} = \\kappa_0 < 1.\n  \n\\end{aligned}')
('10.0', '\\ell_p')
('10.0', 'p > 1')
('10.0', "\\begin{aligned}\n      &\\norm{A_\\theta x}_p^p \\\\\n      =& \\sum_i \\left|\\sum_j A_\\theta(i, j)x_j\\right|^p \\\\\n      =&\\sum_i \\left(\\sum_k A_\\theta(i, k)\\right)^p \\left|\\sum_j \\frac{A_\\theta(i, j)}{\\sum_k A_\\theta(i, k)}x_j\\right|^p \\qq{(Row sum of $A_\\theta$ is strictly positive)}\\\\\n      \\leq& \\sum_i \\left(\\sum_k A_\\theta(i, k)\\right)^p \\sum_j \\frac{A_\\theta(i, j)}{\\sum_k A_\\theta(i, k)}\\left|x_j\\right|^p \\\\\n      \\intertext{\\hfill (Jensen's inequality and convexity of $\\abs{\\cdot}^p$)} \\\\\n      =& \\sum_i \\left(\\sum_k A_\\theta(i, k)\\right)^{p-1} \\sum_j {A_\\theta(i, j)}\\left|x_j\\right|^p \\\\\n      \\leq& \\sum_i \\kappa_0^{p-1} \\sum_j A_\\theta(i, j) \\left|x_j\\right|^p \\qq{(Row sum of $A_\\theta$ is smaller than $\\kappa_0$)} \\\\\n      =& \\kappa_0^{p-1} \\sum_j \\left|x_j\\right|^p \\sum_i A_\\theta(i, j) \\\\\n      \\leq& 2 \\kappa_0^{p-1} \\sum_j \\left|x_j\\right|^p,\n  \n\\end{aligned}")
('10.0', '\\begin{aligned}\n      \\norm{A_\\theta x}_p \\leq (2\\kappa_0^{p-1})^{\\frac{1}{p}} \\norm{x}_p.\n  \n\\end{aligned}')
('10.0', '\\kappa_0 < 1')
('10.0', 'p')
('10.0', '\\begin{aligned}\n    2 \\kappa_0^{p-1} < 1,\n  \n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\kappa \\doteq (2\\kappa_0^{p-1})^{\\frac{1}{p}} < 1.\n  \n\\end{aligned}')
('10.0', "\\begin{aligned}\n    \\norm{\\bar F_\\theta(q) - \\bar F_\\theta(q')}_p = \\norm{A_\\theta (q - q')}_p \\leq \\kappa \\norm{q - q'}_p,\n  \n\\end{aligned}")
('10.0', '\\bar F_\\theta')
('10.0', '\\kappa')
('10.0', '\\norm{\\cdot}_p')
('10.0', '\\theta')
('10.0', '\\begin{aligned}\n    \\bar F_\\theta(q) &= q, \\\\\n    \\iff D_{\\mu_\\theta}(r + \\gamma P_{\\pi_\\theta} q - q) &= 0, \\\\\n    \\iff r + \\gamma P_{\\pi_\\theta} q - q &=0, \\\\\n    \\iff q &= q_{\\pi_\\theta},\n  \n\\end{aligned}')
('10.1', '\\qty{q_t}')
('10.1', "\\begin{aligned}\n    \\label{eq definition of y}\n    \\mathcal{Y}&\\doteq \\qty{(s, a, s') \\mid s \\in \\mathcal{S}, a \\in \\mathcal{A}, s' \\in \\mathcal{S}, p(s'|s, a) > 0}, \\\\\n    Y_t &\\doteq (S_t, A_t, S_{t+1}), \\\\\n    P_{\\theta}((s_1, a_1, s_1'), (s_2, a_2, s_2')) &\\doteq \\begin{cases}\n      0 & s_1' \\neq s_2 \\\\\n      \\mu_\\theta(a_2|s_2) p(s_2'|s_2, a_2) & s_1' = s_2.\n    \\end{cases}\n  \n\\end{aligned}")
('10.1', 'A_{t}')
('10.1', '\\begin{aligned}\n    \\Pr(Y_{t+1} = y) = P_{\\theta_{t+1}}(Y_t, y),\n  \n\\end{aligned}')
('10.1', '\\theta')
('10.1', 'P_\\theta')
('10.1', "d_{\\mu_\\theta}(s)\\mu_\\theta(a|s)p(s'|s, a)")
('10.1', '\\norm{\\cdot}_c')
('10.1', '\\ell_p')
('10.1', '\\norm{\\cdot}_\\infty')
('10.1', '\\norm{\\cdot}')
('10.1', '\\norm{\\cdot}_p')
('10.1', 'l_{\\infty, p}, u_{\\infty, p}')
('10.1', 'l_{2, p}, u_{2, p}')
('10.1', '\\forall x')
('10.1', '\\begin{aligned}\n    l_{\\infty, p} \\norm{x}_\\infty &\\leq \\norm{x}_p \\leq u_{\\infty, p} \\norm{x}_\\infty \\\\\n    l_{2, p} \\norm{x} &\\leq \\norm{x}_p \\leq u_{2, p} \\norm{x}.\n  \n\\end{aligned}')
('10.1', 'y = (s_0, a_0, s_1)')
('10.1', "\\begin{aligned}\n    \\left(F_\\theta(q, y) - F_\\theta(q', y)\\right)(s, a) = \\begin{cases}\n      q(s, a) - q'(s, a), & (s, a) \\neq (s_0, a_0) \\\\\n      \\gamma \\sum_{a_1}\\pi_\\theta(a_1| s_1) \\left(q(s_1, a_1) - q'(s_1, a_1)\\right), &(s, a) = (s_0, a_0)\n    \\end{cases}.\n  \n\\end{aligned}")
('10.1', "\\begin{aligned}\n    \\norm{F_\\theta(q, y) - F_\\theta(q', y)}_\\infty \\leq \\norm{q - q'}_\\infty,\n  \n\\end{aligned}")
('10.1', "\\begin{aligned}\n    \\norm{F_\\theta(q, y) - F_\\theta(q', y)}_p \\leq \\frac{u_{\\infty, p}}{l_{\\infty, p}} \\norm{q - q'}_p.\n  \n\\end{aligned}")
('10.1', 'y = (s_0, a_0, s_1)')
('10.1', "\\begin{aligned}\n    \\left(F_\\theta(q, y) - F_{\\theta'}(q, y)\\right)(s, a) = \\begin{cases}\n      0, & (s, a) \\neq (s_0, a_0) \\\\\n      \\gamma \\sum_{a_1} \\left(\\pi_\\theta(a_1| s_1) - \\pi_{\\theta'}(a_1|s_1) \\right) q(s_1, a_1), &(s, a) = (s_0, a_0)\n    \\end{cases}.\n  \n\\end{aligned}")
('10.1', "\\begin{aligned}\n    \\norm{F_\\theta(q, y) - F_{\\theta'}(q, y)}_\\infty \\leq \\gamma {|\\mathcal{A}|}L_\\pi \\norm{\\theta - \\theta'}\\norm{q}_\\infty \\qq{(using \\eqref{eq pi lipschitz}),}\n  \n\\end{aligned}")
('10.1', "\\begin{aligned}\n    \\norm{F_\\theta(q, y) - F_{\\theta'}(q, y)}_p \\leq \\frac{u_{\\infty, p}\\gamma {|\\mathcal{A}|}L_\\pi}{l_{\\infty, p} l_{2, p}} \\norm{\\theta - \\theta'}_p\\norm{q}_p.\n  \n\\end{aligned}")
('10.1', 'y = (s_0, a_0, s_1)')
('10.1', '\\begin{aligned}\n    \\left(F_\\theta(0, y)\\right)(s, a) = \\begin{cases}\n      0, & (s, a) \\neq (s_0, a_0) \\\\\n      r(s_0, a_0), &(s, a) = (s_0, a_0)\n    \\end{cases}.\n  \n\\end{aligned}')
('10.1', '\\begin{aligned}\n    \\norm{F_\\theta(0, y)}_p \\leq u_{\\infty, p} \\norm{F_\\theta(0, y)}_\\infty \\leq  u_{\\infty, p}r_{max}.\n  \n\\end{aligned}')
('10.1', "\\begin{aligned}\n    \\bar F_\\theta(q) - \\bar F_{\\theta'}(q)\n    = \\left(D_{\\mu_\\theta} - D_{\\mu_{\\theta'}}\\right) r + \\gamma \\left(D_{\\mu_\\theta}P_{\\pi_\\theta} - D_{\\mu_{\\theta'} } P_{\\pi_{\\theta'}} \\right) q- \\left(D_{\\mu_\\theta} - D_{\\mu_{\\theta'}}\\right) q .\n  \n\\end{aligned}")
('10.1', 'D_{\\mu_\\theta}')
('10.1', '\\theta')
('10.1', '\\norm{D_{\\mu_\\theta}}')
('10.1', 'P_{\\pi_\\theta}')
('10.1', '\\theta')
('10.1', '\\norm{P_{\\pi_\\theta}}')
('10.1', '\\bar F_\\theta')
('10.1', '\\bar F_\\theta')
('10.1', 'q_{\\pi_\\theta}')
('10.1', "\\begin{aligned}\n    \\label{eq lipschitz continuity of q}\n    q_{\\pi_\\theta} - q_{\\pi_{\\theta'}} = \\left((I - \\gamma P_{\\pi_\\theta})^{-1} - (I - \\gamma P_{\\pi_{\\theta'}})^{-1}\\right) r.\n  \n\\end{aligned}")
('10.1', "\\begin{aligned}\n    \\norm{q_{\\pi_\\theta} - q_{\\pi_{\\theta'}}}_p \\leq \\norm{(I - \\gamma P_{\\pi_\\theta})^{-1}}_p  \\norm{\\gamma P_{\\pi_\\theta} - \\gamma P_{\\pi_{\\theta'}}}_p \\norm{(I - \\gamma P_{\\pi_{\\theta'}})^{-1}}_p \\norm{r}_p.\n  \n\\end{aligned}")
('10.1', '\\pi')
('10.1', '(I - \\gamma P_\\pi)^{-1}')
('10.1', '(I - \\gamma P_\\pi)^{-1}')
('10.1', '\\pi')
('10.1', '\\begin{aligned}\n    \\sup_{\\theta} \\norm{(I - \\gamma P_{\\pi_\\theta})^{-1}}_p < \\infty,\n  \n\\end{aligned}')
('10.1', '\\begin{aligned}\n    \\abs{q_{\\pi_\\theta}(s, a)} \\leq \\frac{r_{max}}{1 - \\gamma}.\n  \n\\end{aligned}')
('10.1', '\\epsilon_t \\equiv 0')
('10.1', '\\qty{\\theta_t}')
('10.1', '\\begin{aligned}\n    &\\norm{\\theta_{t+1} - \\theta_t} \\\\\n    =& \\beta_t \\norm{\\rho_t  \\nabla_\\theta \\log \\pi_{\\theta_t}(A_t | S_t) \\Pi (q_t(S_t, A_t)) - \\lambda_t \\nabla_{\\theta} \\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_t}(\\cdot | S_t)\\right)} \\\\\n    \\leq& \\beta_t \\left( \\norm{\\rho_t} \\norm{\\nabla_\\theta \\log \\pi_{\\theta_t}(A_t | S_t)} \\frac{r_{max}}{1 - \\gamma} + \\lambda_t \\norm{\\nabla_{\\theta} \\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_t}(\\cdot | S_t)\\right)} \\right).\n  \n\\end{aligned}')
('10.1', '\\begin{aligned}\n    \\inf_{\\theta, s, a} \\mu_{\\theta}(a|s) > 0.\n  \n\\end{aligned}')
('10.1', '\\begin{aligned}\n    \\rho_{max} \\doteq \\sup_{\\theta, s, a} \\frac{\\pi_\\theta(a|s)}{\\mu_\\theta(a|s)} < \\infty,\n  \n\\end{aligned}')
('10.1', '\\forall t,')
('10.1', '\\begin{aligned}\n    \\norm{\\rho_t} < \\infty.\n  \n\\end{aligned}')
('10.1', '\\begin{aligned}\n    \\lambda_t \\leq \\lambda.\n  \n\\end{aligned}')
('10.1', '\\norm{\\nabla_\\theta \\log \\pi_{\\theta_t}(A_t | S_t)}')
('10.1', '\\norm{\\nabla_{\\theta} \\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_t}(\\cdot | S_t)\\right)}')
('10.1', 'L_\\theta')
('10.1', '\\begin{aligned}\n    \\label{eq ltheta}\n    \\norm{\\theta_{t+1} - \\theta_t}_p \\leq \\beta_t L_\\theta,\n  \n\\end{aligned}')
('10.2', '\\begin{aligned}\n  J_\\eta(\\pi; p_0) \\doteq J(\\pi; p_0) - \\eta \\mathbb{E}_{s \\sim \\mathcal{U}_\\mathcal{S}} \\left[\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi(\\cdot |s)\\right)\\right],\n\\end{aligned}')
('10.2', '\\mathcal{U}_\\mathcal{X}')
('10.2', '\\mathcal{X}')
('10.2', 'd')
('10.2', "d'")
('10.2', "\\begin{aligned}\n    \\norm{\\nabla J_\\eta(\\pi_\\theta; d')} \\leq \\frac{\\eta}{2{|\\mathcal{S}\\times \\mathcal{A}|}},\n  \n\\end{aligned}")
('10.2', "\\begin{aligned}\n    J(\\pi_\\theta; d) \\geq J(\\pi_*; d) - \\frac{2\\eta}{1 - \\gamma} \\max_s {\\frac{d_{\\pi_*, \\gamma, d}(s)}{d'(s)}},\n  \n\\end{aligned}")
('10.2', '\\pi_*')
('10.2', '\\eta')
('10.2', "\\forall s, d'(s) > 0")
('10.2', "d=d'=p_0")
('10.2', 'p_0')
('10.2', "p_0'")
('10.2', "\\forall s, p_0'(s) > 0")
('10.2', "d=p_0, d'=p_0'")
('10.2', "J_\\eta(\\pi_\\theta; p_0')")
('10.2', "p_0'")
('10.2', '\\mathcal{U}_\\mathcal{S}')
('10.2', '\\begin{aligned}\n  d_t(s) \\doteq \\Pr(S_t = s | p_0, \\mu_{\\theta_0}, \\dots, \\mu_{\\theta_{t-1}}).\n\\end{aligned}')
('10.2', "\\begin{aligned}\n  \\frac{d_{\\pi_{\\theta}, \\gamma, p_0'}(s)}{d_t(s)} \\qq{and} \\frac{\\mathcal{U}_\\mathcal{S}(s)}{d_t(s)}.\n\\end{aligned}")
('10.2', '\\begin{aligned}\n    \\label{eq definition of new objective}\n    J_\\eta(\\pi; p_0) \\doteq J(\\pi; p_0) - \\eta \\mathbb{E}_{s \\sim \\mathcal{U}_\\mathcal{S}} \\left[\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi(\\cdot |s)\\right)\\right],\n  \n\\end{aligned}')
('10.2', '\\mathcal{U}_\\mathcal{X}')
('10.2', '\\mathcal{X}')
('10.2', "p_0'")
('10.2', '\\mathcal{S}')
('10.2', "p_0'(s) > 0")
('10.2', 's \\in \\mathcal{S}')
('10.2', "\\begin{aligned}\n    \\label{eq actor convergence shorthard}\n    J(\\theta) &\\doteq J(\\pi_\\theta; p_0'), \\\\\n    J_\\eta(\\theta) &\\doteq J_\\eta(\\pi_\\theta; p_0'), \\\\\n    d_{\\pi, \\gamma}(s) &\\doteq d_{\\pi, \\gamma, p_0'}(s),\n  \n\\end{aligned}")
('10.2', "p_0'")
('10.2', 'p_0')
('10.2', 'p_0')
('10.2', "p_0'")
('10.2', 'J(\\theta)')
('10.2', 'L_J')
('10.2', 'L_J')
('10.2', '\\norm{\\cdot}')
('10.2', 'J(\\theta)')
('10.2', 'L_J')
('10.2', '\\mathbb{E}_{s \\sim \\mathcal{U}_\\mathcal{S}} \\left[\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_\\theta(\\cdot |s)\\right)\\right]')
('10.2', 'L_{\\text{KL}}')
('10.2', 'J_\\eta(\\theta)')
('10.2', 'L_J + \\eta L_{\\text{KL}}')
('10.2', 'J_\\eta(\\theta)')
('10.2', '(L_J + \\eta L_\\text{KL})')
('10.2', '\\eta = \\lambda_t')
('10.2', "\\begin{aligned}\n    \\label{eq j lambda smooth inequality}\n    J_{\\lambda_t}(\\theta_{t+1}) \\geq& J_{\\lambda_t}(\\theta_t) + {\\left<\\nabla J_{\\lambda_t}(\\theta_t), \\theta_{t+1} - \\theta_t\\right>} - (L_J + \\lambda_t L_{\\text{KL}}) \\norm{\\theta_{t+1}-\\theta_t}^2 \\\\\n    \\geq& J_{\\lambda_t}(\\theta_t) + \\underbrace{{\\left<\\nabla J_{\\lambda_t}(\\theta_t), \\theta_{t+1} - \\theta_t\\right>}}_{M_1} - L_J' \\underbrace{\\norm{\\theta_{t+1}-\\theta_t}^2}_{M_2},\n  \n\\end{aligned}")
('10.2', "L_J' \\doteq L_J + \\lambda L_\\text{KL}")
('10.2', 'M_2')
('10.2', '\\begin{aligned}\n    M_2 \\leq \\frac{1}{l_{2,p}} \\beta_t^2 L_\\theta^2.\n  \n\\end{aligned}')
('10.2', 'M_1')
('10.2', '\\begin{aligned}\n    \\label{eq actor yt}\n    Y_t \\doteq (S_t, A_t).\n  \n\\end{aligned}')
('10.2', 'Y_t')
('10.2', 'y = (s, a)')
('10.2', '\\begin{aligned}\n    \\label{eq actor helper function}\n    \\Lambda(\\theta, y, \\eta) &\\doteq \\frac{\\pi_{\\theta}(a|s)}{\\mu_{\\theta}(a|s)} \\nabla \\log \\pi_\\theta(a|s) q_{\\pi_\\theta}(s, a) + \\frac{\\eta}{{|\\mathcal{A}|}} \\sum_{\\bar a} \\nabla \\log \\pi_\\theta(\\bar a | s) \\\\\n    \\bar \\Lambda(\\theta, \\eta) &\\doteq \\sum_{s, a} d_{\\mu_\\theta}(s) \\mu_\\theta(a|s) \\Lambda(\\theta, y, \\eta).\n  \n\\end{aligned}')
('10.2', '\\begin{aligned}\n    M_1 = &{\\left<\\nabla J_{\\lambda_t}(\\theta_t), \\theta_{t+1} - \\theta_t\\right>} \\\\\n    =&\\beta_t {\\left<\\nabla J_{\\lambda_t}(\\theta_t),  \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) \\Pi (q_t(S_t, A_t)) - \\lambda_t \\nabla \\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_t}(\\cdot | S_t)\\right) \\right>} \\\\\n    =&\\beta_t {\\left<\\nabla J_{\\lambda_t}(\\theta_t),  \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) \\Pi (q_t(S_t, A_t)) + \\frac{\\lambda_t}{{|\\mathcal{A}|}} \\sum_a \\nabla \\log \\pi_{\\theta_t}(a|S_t) \\right>} \\\\\n    =&\\beta_t {\\left<\\nabla J_{\\lambda_t}(\\theta_t),  \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) q_{\\pi_{\\theta_t}}(S_t, A_t) + \\frac{\\lambda_t}{{|\\mathcal{A}|}} \\sum_a \\nabla \\log \\pi_{\\theta_t}(a|S_t) \\right>} \\\\\n    &+ \\beta_t {\\left<\\nabla J_{\\lambda_t}(\\theta_t),  \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) \\left(\\Pi\\left(q_t(S_t, A_t)\\right) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right) \\right>} \\\\\n    =&\\beta_t \\underbrace{{\\left<\\nabla J_{\\lambda_t}(\\theta_t), \\bar \\Lambda(\\theta_t, \\lambda_t)\\right>}}_{M_{11}} + \\beta_t \\underbrace{{\\left<\\nabla J_{\\lambda_t}(\\theta_t), \\Lambda(\\theta_t, Y_t, \\lambda_t) - \\bar \\Lambda(\\theta_t, \\lambda_t)\\right>}}_{M_{12}} \\\\\n    &+ \\beta_t \\underbrace{{\\left<\\nabla J_{\\lambda_t}(\\theta_t),  \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) \\left(\\Pi\\left(q_t(S_t, A_t)\\right) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right) \\right>}}_{M_{13}}.\n  \n\\end{aligned}')
('10.2', 'M_{12}')
('10.2', "\\begin{aligned}\n    \\label{eq actor helper function 2}\n    \\Lambda'(\\theta, y, \\eta) \\doteq {\\left<\\nabla J_{\\eta}(\\theta), \\Lambda(\\theta, y, \\eta) - \\bar \\Lambda(\\theta, \\eta)\\right>}.\n  \n\\end{aligned}")
('10.2', 'C_0 > 0')
('10.2', '\\tau \\in (0, 1)')
('10.2', '\\theta')
('10.2', 'n > 0')
('10.2', "\\begin{aligned}\n    \\sup_{s, a, \\theta}\\sum_{s', a'} \\abs{P_{\\mu_\\theta}^n((s, a), (s', a')) - d_{\\mu_\\theta}(s')\\mu_{\\theta}(a'|s')} \\leq C_0 \\tau^n,\n  \n\\end{aligned}")
('10.2', "\\begin{aligned}\n    \\label{eq definition of beta t}\n    \\tau_{\\beta_t} \\doteq \\min\\qty{n \\mid \\sup_{s, a, \\theta}\\sum_{s', a'} \\abs{P_{\\mu_\\theta}^n((s, a), (s', a')) - d_{\\mu_\\theta}(s')\\mu_{\\theta}(a'|s')}  \\leq \\beta_t}.\n  \n\\end{aligned}")
('10.2', 'M_{12}')
('10.2', "\\begin{aligned}\n    M_{12} =& \\Lambda'(\\theta_t, Y_t, \\lambda_t) \\\\\n    =& \\underbrace{\\Lambda'(\\theta_t, Y_t, \\lambda_t) - \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, Y_t, \\lambda_t)}_{M_{121}} \\\\\n    &+ \\underbrace{\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, Y_t, \\lambda_t) - \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)}_{M_{122}} \\\\\n    &+ \\underbrace{\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)}_{M_{123}}.\n  \n\\end{aligned}")
('10.2', '\\tilde Y_t')
('10.2', '\\beta_t')
('10.2', '\\alpha_t')
('10.2', 't - \\tau_{\\beta_t} - 1')
('10.2', '\\qty{\\tilde Y_t}')
('10.2', '\\qty{Y_t}')
('10.2', 't - \\tau_{\\beta_t} - 1')
('10.2', '\\qty{\\tilde Y_t}')
('10.2', '\\mu_{\\theta_{t-\\tau_{\\beta_t}}}')
('10.2', '\\qty{Y_t}')
('10.2', '\\mu_{\\theta_{t-\\tau_{\\beta_t}}}')
('10.2', '\\mu_{\\theta_{t-\\tau_{\\beta_t} + 1}}')
('10.2', '\\begin{aligned}\n    \\label{eq actor tilde yt}\n    \\qty{\\tilde Y_t}&: \\dots \\to Y_{t-\\tau_{\\beta_t}-1} \\underbrace{\\to}_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}} Y_{t-\\tau_{\\beta_t}} \\underbrace{\\to}_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}} \\tilde Y_{t-\\tau_{\\beta_t}+1} \\underbrace{\\to}_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}} \\tilde Y_{t-\\tau_{\\beta_t}+2} \\to \\dots \\\\\n    \\qty{Y_t}&: \\dots \\to Y_{t-\\tau_{\\beta_t}-1} \\underbrace{\\to}_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}} Y_{t-\\tau_{\\beta_t}} \\underbrace{\\to}_{\\mu_{\\theta_{t-\\tau_{\\beta_t}+1}}} Y_{t-\\tau_{\\beta_t}+1} \\underbrace{\\to}_{\\mu_{\\theta_{t-\\tau_{\\beta_t}+2}}} Y_{t-\\tau_{\\beta_t}+2} \\to \\dots.\n\\end{aligned}')
('10.2', 'M_{11}')
('10.2', '\\chi_{11} > 0')
('10.2', '\\begin{aligned}\n  M_{11} \\geq \\chi_{11} \\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2.\n\\end{aligned}')
('10.2', 'M_{121}')
('10.2', "L_{\\Lambda'}^* > 0")
('10.2', "\\begin{aligned}\n    \\norm{M_{121}} \\leq \\frac{L_{\\Lambda'}^* L_\\theta}{l_{2, p}} \\beta_{t-\\tau_{\\beta_t}, t-1}.\n  \n\\end{aligned}")
('10.2', 'M_{122}')
('10.2', "U_{\\Lambda'}^* > 0")
('10.2', "\\begin{aligned}\n      \\norm{\\mathbb{E}\\left[M_{122}\\right]} \\leq U_{\\Lambda'}^* {|\\mathcal{S}|}{|\\mathcal{A}|}L_\\mu L_\\theta \\sum_{j=t-\\tau_{\\beta_t}}^{t-1} \\beta_{t-\\tau_{\\beta_t}, j}.\n  \n\\end{aligned}")
('10.2', 'M_{123}')
('10.2', "\\begin{aligned}\n    \\norm{\\mathbb{E}\\left[M_{123}\\right]} \\leq U_{\\Lambda'}^* \\beta_t.\n  \n\\end{aligned}")
('10.2', 'M_{13}')
('10.2', '\\rho_{max} > 0')
('10.2', '\\begin{aligned}\n    \\norm{\\mathbb{E}\\left[M_{13}\\right]}\\leq& 2\\rho_{max} \\sqrt{{|\\mathcal{S}\\times \\mathcal{A}|}}\\sqrt{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_\\infty^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right]}.\n  \n\\end{aligned}')
('10.2', 'M_{11}, M_{121}, M_{122}, M_{123}, M_{12}')
('10.2', 'M_2')
('10.2', 't_0')
('10.2', '\\begin{aligned}\n  \\label{eq asymptotic learning rates beta}\n  \\tau_{\\beta_t} &= \\mathcal{O}\\left(\\log (t+t_0)\\right), \\\\\n  \\beta_{t-\\tau_{\\beta_t}, t-1} &= \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{\\epsilon_\\beta}}\\right), \\\\\n  \\sum_{j=t-\\tau_{\\beta_t}}^{t-1} \\beta_{t-\\tau_{\\beta_t}, j} &= \\mathcal{O}\\left(\\frac{\\log^2(t+t_0)}{(t+t_0)^{\\epsilon_\\beta}}\\right).\n\\end{aligned}')
('10.2', 't_0')
('10.2', '\\chi_{12}, \\chi_{13}, \\chi_2')
('10.2', '\\begin{aligned}\n  \\mathbb{E}\\left[M_{121} + M_{122} + M_{123}\\right] &\\geq -\\chi_{12} \\frac{\\log^2(t+t_0)}{(t+t_0)^{\\epsilon_\\beta}}, \\\\\n  \\mathbb{E}\\left[M_{13}\\right] &\\geq -\\chi_{13}\\sqrt{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_p^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right]}, \\\\\n  \\mathbb{E}\\left[M_2\\right] &\\leq \\beta_t \\chi_2 \\frac{1}{(t+t_0)^{\\epsilon_\\beta}},\n\\end{aligned}')
('10.2', '\\ell_p')
('10.2', '\\begin{aligned}\n  \\label{eq actor perf recursive bound}\n  \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_{t+1})\\right] \\geq& \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right] + \\beta_t \\chi_{11} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] \\\\\n  &-\\beta_t \\chi_{12} \\frac{\\log^2(t+t_0)}{(t+t_0)^{\\epsilon_\\beta}} \\\\\n  &-\\beta_t \\chi_{13}\\sqrt{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_p^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right]} \\\\\n  &- \\beta_t \\chi_2 \\frac{1}{(t+t_0)^{\\epsilon_\\beta}}.\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] \\leq& \\frac{1}{\\chi_{11}} \\frac{1}{\\beta_t} \\left(\\mathbb{E}\\left[J_{\\lambda_t}(\\theta_{t+1})\\right] - \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right]\\right) \\\\\n  &+ \\frac{\\chi_{13}}{\\chi_{11}} \\sqrt{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_p^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right]} \\\\\n  &+ \\frac{\\chi_{12} + \\chi_2}{\\chi_{11}} \\frac{\\log^2(t+t_0)}{(t+t_0)^{\\epsilon_\\beta}}.\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\chi_3 \\doteq \\frac{1}{\\chi_{11}}, \\, \\chi_4 \\doteq \\frac{\\chi_{13}}{\\chi_{11}}, \\, \\chi_5 \\doteq \\frac{\\chi_{12} + \\chi_2}{\\chi_{11}}\n\\end{aligned}')
('10.2', '\\ceil{\\frac{t}{2}}')
('10.2', 't')
('10.2', '\\begin{aligned}\n  \\label{eq tmp 6}\n  \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla J_{\\lambda_k}(\\theta_k)}^2\\right] \\leq& \\chi_3 \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{1}{\\beta_k} \\left(\\mathbb{E}\\left[J_{\\lambda_k}(\\theta_{k+1})\\right] - \\mathbb{E}\\left[J_{\\lambda_k}(\\theta_k)\\right]\\right) \\\\\n  &+ \\chi_4 \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\sqrt{\\mathbb{E}\\left[\\norm{q_k - q_{\\pi_{\\theta_k}}}_p^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}^2\\right]} \\\\\n  &+ \\chi_5 \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{\\log^2(k+t_0)}{(k+t_0)^{\\epsilon_\\beta}}. \n\\end{aligned}')
('10.2', 'U_{J, \\lambda}')
('10.2', 't')
('10.2', '\\begin{aligned}\n    \\abs{\\mathbb{E}\\left[J_{\\lambda_t}(\\theta_{t})\\right]} \\leq U_{J, \\lambda}, \\, \\abs{\\mathbb{E}\\left[J_{\\lambda_t}(\\theta_{t+1})\\right]} \\leq U_{J, \\lambda}.\n  \n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\mathbb{E}\\left[\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{1}{\\beta_k}\\left(J_{\\lambda_k}(\\theta_{k+1}) - J_{\\lambda_k}(\\theta_k) \\right) \\right]\\leq \\frac{2U_{J, \\lambda}}{\\beta} (t+t_0)^{\\epsilon_\\beta}\n  \n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{\\log^2(k+t_0)}{(k+t_0)^{\\epsilon_\\beta}} \\leq \\log^2(t+t_0) \\int_{x=\\ceil{\\frac{t}{2}}-1}^t \\frac{1}{(x+t_0)^{\\epsilon_\\beta}} dx \\leq  \\frac{\\log^2(t+t_0)}{1-\\epsilon_\\beta} (t+t_0)^{1-\\epsilon_\\beta}\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla J_{\\lambda_k}(\\theta_k)}^2\\right] \\leq& \\frac{2\\chi_3 U_{J, \\lambda}}{\\beta} (t+t_0)^{\\epsilon_\\beta}  + \\chi_5 \\frac{\\log^2(t+t_0)}{1-\\epsilon_\\beta} (t+t_0)^{1-\\epsilon_\\beta}\\\\\n  &+ \\chi_4 \\sqrt{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{q_k - q_{\\pi_{\\theta_k}}}_p^2 \\right]} \\sqrt{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}^2\\right]}.\n\\end{aligned}')
('10.2', '\\frac{1}{t-\\ceil{\\frac{t}{2}}+1}')
('10.2', '\\begin{aligned}\n  \\underbrace{\\frac{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla J_{\\lambda_k}(\\theta_k)}^2\\right]}{t-\\ceil{\\frac{t}{2}}+1}}_{z_t} \\leq& \\frac{2\\chi_3 U_{J, \\lambda}}{\\beta} \\frac{(t+t_0)^{\\epsilon_\\beta}}{t - \\ceil{\\frac{t}{2}} + 1} + \\chi_5 \\frac{\\log^2(t+t_0)}{1-\\epsilon_\\beta} \\frac{(t+t_0)^{1-\\epsilon_\\beta}}{t - \\ceil{\\frac{t}{2}} + 1}\\\\\n  &+ \\chi_4 \\sqrt{\\underbrace{\\frac{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{q_k - q_{\\pi_{\\theta_k}}}_p^2 \\right]}{t-\\ceil{\\frac{t}{2}}+1}}_{e_t}} \\sqrt{\\frac{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}^2\\right]}{t-\\ceil{\\frac{t}{2}}+1}}.\n\\end{aligned}')
('10.2', 'E_1, E_2, E_3, E_4')
('10.2', '\\begin{aligned}\n  z_t &\\leq \\frac{E_1}{t^{1 - \\epsilon_\\beta}} + \\frac{E_2 \\log^2 t}{t^{\\epsilon_\\beta}} + 2E_3 \\sqrt{e_t}\\sqrt{z_t} \\\\\n  \\implies \\left(\\sqrt{z_t} - E_3 \\sqrt{e_t} \\right)^2 &\\leq \\frac{E_1}{t^{1 - \\epsilon_\\beta}} + \\frac{E_2 \\log^2 t}{t^{\\epsilon_\\beta}} + E_3^2 e_t \\\\\n  \\implies \\sqrt{z_t} - E_3 \\sqrt{e_t} &\\leq \\sqrt{\\frac{E_1}{t^{1 - \\epsilon_\\beta}} + \\frac{E_2 \\log^2 t}{t^{\\epsilon_\\beta}} + E_3^2 e_t} \\\\\n  &\\leq \\sqrt{\\frac{E_1}{t^{1 - \\epsilon_\\beta}} + \\frac{E_2 \\log^2 t}{t^{\\epsilon_\\beta}}}  + E_3 \\sqrt{e_t} \\\\ \n  \\implies z_t &\\leq \\frac{2E_1}{t^{1 - \\epsilon_\\beta}} + \\frac{2E_2 \\log^2 t}{t^{\\epsilon_\\beta}} + 8E_3^2 e_t.\n\\end{aligned}')
('10.2', 'E_5 > 0')
('10.2', '\\begin{aligned}\n  e_t = \\frac{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{E_5}{k^{\\epsilon_q}}}{t-\\ceil{\\frac{t}{2}}+1} \\leq \\frac{E_5 t^{1-\\epsilon_q} }{(1 - \\epsilon_q) (t - \\ceil{\\frac{t}{2}} +1)}.\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  e_t = \\mathcal{O}\\left(\\frac{1}{t^{\\epsilon_q}}\\right),\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\label{eq actor convergence stationary points}\n  \\frac{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla J_{\\lambda_k}(\\theta_k)}^2\\right] }{t-\\ceil{\\frac{t}{2}}+1} = \\mathcal{O}\\left(\\frac{1}{t^{1-\\epsilon_\\beta}} + \\frac{\\log^2t}{t^{\\epsilon_\\beta}} + \\frac{1}{t^{\\epsilon_q}}\\right).\n\\end{aligned}')
('10.2', '\\qty{\\theta_t}')
('10.2', 'd')
('10.2', "d'")
('10.2', "\\begin{aligned}\n    \\norm{\\nabla J_\\eta(\\theta; d')} \\leq \\frac{\\eta}{2{|\\mathcal{S}\\times \\mathcal{A}|}},\n  \n\\end{aligned}")
('10.2', "\\begin{aligned}\n    J(\\theta; d) \\geq J(\\pi_*; d) - \\frac{2\\eta}{1 - \\gamma} \\max_s {\\frac{d_{\\pi_*, \\gamma, d}(s)}{d'(s)}},\n  \n\\end{aligned}")
('10.2', '\\pi_*')
('10.2', "d'(s) > 0")
('10.2', 't > 0')
('10.2', 'k')
('10.2', '\\qty{\\ceil{\\frac{t}{2}}, \\ceil{\\frac{t}{2}} + 1, \\dots, t-1, t}')
('10.2', '\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}')
('10.2', 'k')
('10.2', '\\theta_k')
('10.2', '\\begin{aligned}\n  \\Pr(\\norm{\\nabla J_{\\lambda_k}(\\theta_k)} \\leq \\frac{\\lambda_t}{2 {|\\mathcal{S}\\times \\mathcal{A}|}}) =&\\Pr(\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}^2 \\leq \\frac{\\lambda_t^2}{4 {|\\mathcal{S}\\times \\mathcal{A}|}^2}) \\\\\n  \\geq& 1 - \\frac{4{|\\mathcal{S}\\times \\mathcal{A}|}^2}{\\lambda_t^2} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}^2\\right] \\\\\n  =& 1 - \\frac{4{|\\mathcal{S}\\times \\mathcal{A}|}^2}{\\lambda_t^2} \\mathbb{E}\\left[ \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_k}(\\theta_k)}^2 \\mid k\\right] \\right] \\\\\n  =& 1 - \\frac{4{|\\mathcal{S}\\times \\mathcal{A}|}^2}{\\lambda_t^2} \\frac{\\sum_{i=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla J_{\\lambda_k}(\\theta_k)}^2 \\mid k =i\\right] }{t-\\ceil{\\frac{t}{2}}+1} \\\\\n  \\geq & 1 - \\frac{1}{\\lambda_t^2}\\mathcal{O}\\left(\\frac{1}{t^{1-\\epsilon_\\beta}} + \\frac{\\log^2 t}{t^{\\epsilon_\\beta}} + \\frac{1}{t^{\\epsilon_q }}\\right)  \\qq{(Using \\eqref{eq actor convergence stationary points})} \\\\\n  \\geq& 1 - C_t,\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  C_t \\doteq \\mathcal{O}\\left(\\frac{1}{t^{1-\\epsilon_\\beta - 2\\epsilon_\\lambda}} + \\frac{\\log^2 t}{t^{\\epsilon_\\beta- 2\\epsilon_\\lambda}} + \\frac{1}{t^{\\epsilon_q- 2\\epsilon_\\lambda }}\\right).\n\\end{aligned}')
('10.2', '\\lambda_k \\geq \\lambda_t')
('10.2', '\\begin{aligned}\n  \\norm{\\nabla J_{\\lambda_k}(\\theta_k)} \\leq \\frac{\\lambda_t}{2 {|\\mathcal{S}\\times \\mathcal{A}|}} \\implies \\norm{\\nabla J_{\\lambda_k}(\\theta_k)} \\leq \\frac{\\lambda_k}{2 {|\\mathcal{S}\\times \\mathcal{A}|}}.\n\\end{aligned}')
('10.2', '\\begin{aligned}\n  \\Pr(\\norm{\\nabla J_{\\lambda_k}(\\theta_k)} \\leq \\frac{\\lambda_k}{2 {|\\mathcal{S}\\times \\mathcal{A}|}}) \\geq \\Pr(\\norm{\\nabla J_{\\lambda_k}(\\theta_k)} \\leq \\frac{\\lambda_t}{2 {|\\mathcal{S}\\times \\mathcal{A}|}}) \\geq 1 - C_t.\n\\end{aligned}')
('10.2', "d=p_0, d' = p_0', \\eta = \\lambda_k")
('10.2', "\\begin{aligned}\n  J(\\theta_k; p_0) \\geq J(\\pi_*; p_0) - 2\\frac{\\lambda_k}{1 - \\gamma} \\max_s {\\frac{d_{\\pi_*, \\gamma, p_0}(s)}{p_0'(s)}}.\n\\end{aligned}")
('10.2', '\\begin{aligned}\n  1 - C_t,\n\\end{aligned}')
('11.0', "\\begin{aligned}\n    \\mathcal{Y}&\\doteq \\qty{(s, a, s') \\mid s \\in \\mathcal{S}, a \\in \\mathcal{A}, s' \\in \\mathcal{S}, p(s'|s, a) > 0}, \\\\\n    Y_t &\\doteq (S_t, A_t, S_{t+1}), \\\\\n    P_{\\zeta}((s_1, a_1, s_1'), (s_2, a_2, s_2')) &\\doteq \\begin{cases}\n      0 & s_1' \\neq s_2 \\\\\n      \\mu_\\theta(a_2|s_2) p(s_2'|s_2, a_2) & s_1' = s_2.\n    \\end{cases}\n  \n\\end{aligned}")
('11.0', 'A_{t}')
('11.0', '\\begin{aligned}\n    \\Pr(Y_{t+1} = y) = P_{\\zeta_{t+1}}(Y_t, y),\n  \n\\end{aligned}')
('11.0', '\\zeta')
('11.0', 'P_\\zeta')
('11.0', "d_{\\mu_\\theta}(s)\\mu_\\theta(a|s)p(s'|s, a)")
('11.0', "\\begin{aligned}\n    \\bar F_\\zeta(q) =& \\sum_{s, a, s'} d_{\\mu_\\theta}(s) \\mu_\\theta(a|s)p(s'|s, a) F_\\zeta(q, s, a, s') \\\\\n    &= D_{\\mu_\\theta}\\left(r + \\gamma P_{\\pi_\\theta} \\left(q - \\eta \\log \\pi_\\theta\\right)  -  q\\right) + q \\\\\n    &= (I - D_{\\mu_\\theta}(I - \\gamma P_{\\pi_\\theta})) q + D_{\\mu_\\theta}(r - \\eta \\gamma P_{\\pi_\\theta} \\log \\pi_\\theta),\n  \n\\end{aligned}")
('11.0', '\\pi_\\theta')
('11.0', '\\mathbb{R}^{{|\\mathcal{S}\\times \\mathcal{A}|}}')
('11.0', '(s, a)')
('11.0', '\\pi_\\theta(a|s)')
('11.0', '\\log \\pi_\\theta')
('11.0', '\\pi_\\theta')
('11.0', "\\begin{aligned}\n    \\bar F_{\\zeta}(q) - \\bar F_{\\zeta}(q') = A_{\\theta} (q - q'),\n  \n\\end{aligned}")
('11.0', 'A_{\\theta}')
('11.0', '\\begin{aligned}\n      A_\\theta \\doteq I - D_{\\mu_\\theta}(I - \\gamma P_{\\pi_\\theta}).\n  \n\\end{aligned}')
('11.0', '\\kappa \\in (0, 1)')
('11.0', '\\ell_p')
('11.0', '\\forall x')
('11.0', '\\begin{aligned}\n    \\norm{A_\\theta x}_p \\leq \\kappa \\norm{x}_p,\n  \n\\end{aligned}')
('11.0', "\\begin{aligned}\n    \\norm{\\bar F_{\\zeta}(q) - \\bar F_{\\zeta}(q')}_p \\leq \\kappa \\norm{q - q'}_p.\n  \n\\end{aligned}")
('11.0', '\\begin{aligned}\n    \\bar F_\\zeta(q) &=q \\\\\n    \\iff r + \\gamma P_{\\pi_\\theta}(q - \\eta \\log \\pi_\\theta) - q &= 0 \\\\\n    \\iff q &= \\tilde q_{\\pi_\\theta, \\eta} \\qq{(Lemma 1 of \\citet{haarnoja2018soft}),}\n  \n\\end{aligned}')
('11.0', '\\norm{\\cdot}_c')
('11.0', '\\ell_p')
('11.0', 'y = (s_0, a_0, s_1)')
('11.0', "\\begin{aligned}\n    \\left(F_\\zeta(q, y) - F_\\zeta(q', y)\\right)(s, a) = \\begin{cases}\n      q(s, a) - q'(s, a), & (s, a) \\neq (s_0, a_0) \\\\\n      \\gamma \\sum_{a_1}\\pi_\\theta(a_1| s_1) \\left(q(s_1, a_1) - q'(s_1, a_1)\\right), &(s, a) = (s_0, a_0)\n    \\end{cases}.\n  \n\\end{aligned}")
('11.0', "\\begin{aligned}\n    \\norm{F_\\zeta(q, y) - F_\\zeta(q', y)}_\\infty \\leq \\norm{q - q'}_\\infty,\n  \n\\end{aligned}")
('11.0', "\\begin{aligned}\n    \\norm{F_\\zeta(q, y) - F_\\zeta(q', y)}_p \\leq \\frac{u_{\\infty, p}}{l_{\\infty, p}} \\norm{q - q'}_p.\n  \n\\end{aligned}")
('11.0', 'y = (s_0, a_0, s_1)')
('11.0', '\\begin{aligned}\n    &\\left(F_{\\zeta_t}(q, y) - F_{\\zeta_k}(q, y)\\right)(s, a) \\\\\n    =& \\begin{cases}\n      0, & (s, a) \\neq (s_0, a_0) \\\\\n      \\gamma \\sum_{a_1} \\left(\\pi_{\\theta_t}(a_1| s_1) - \\pi_{\\theta_k}(a_1|s_1) \\right) q(s_1, a_1) + \\lambda_t \\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot|s_1)\\right) - \\lambda_k \\mathbb{H}\\left(\\pi_{\\theta_k}(\\cdot|s_1)\\right), &(s, a) = (s_0, a_0)\n    \\end{cases}.\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    &\\abs{\\lambda_t \\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot|s_1)\\right) - \\lambda_k \\mathbb{H}\\left(\\pi_{\\theta_k}(\\cdot|s_1)\\right)} \\\\\n    \\leq & \\abs{\\lambda_t - \\lambda_k} \\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot | s_1)\\right) + \\lambda_k \\abs{\\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot | s_1)\\right) - \\mathbb{H}\\left(\\pi_{\\theta_k}(\\cdot | s_1)\\right)} \\\\\n    \\leq & \\abs{\\lambda_t - \\lambda_k} \\log {|\\mathcal{A}|}+ \\lambda_k \\left(\\log {|\\mathcal{A}|}+ e^{-1}\\right) \\norm{\\theta_t - \\theta_k} \\qq{(Lemma \\ref{lem softmax policy gradient})} \\\\\n    \\leq & \\left(\\log {|\\mathcal{A}|}+ \\lambda \\log {|\\mathcal{A}|}+ \\lambda e^{-1}\\right) \\norm{\\zeta_t - \\zeta_k},\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    &\\norm{F_{\\zeta_k}(q, y) - F_{\\zeta_t}(q, y)}_\\infty \\\\ \n    \\leq& \\gamma {|\\mathcal{A}|}L_\\pi \\norm{\\theta_t - \\theta_k}\\norm{q}_\\infty + \\left(\\log {|\\mathcal{A}|}+ \\lambda \\log {|\\mathcal{A}|}+ \\lambda e^{-1}\\right) \\norm{\\zeta_t - \\zeta_k} \\\\\n    \\leq& \\gamma {|\\mathcal{A}|}L_\\pi \\norm{\\zeta_t - \\zeta_k}\\norm{q}_\\infty + \\left(\\log {|\\mathcal{A}|}+ \\lambda \\log {|\\mathcal{A}|}+ \\lambda e^{-1}\\right) \\norm{\\zeta_t - \\zeta_k} \\\\\n    \\leq& \\frac{\\gamma {|\\mathcal{A}|}L_\\pi}{l_{2, p} l_{\\infty, p}} \\norm{\\zeta_t - \\zeta_k}_p \\norm{q}_p + \\frac{(\\log {|\\mathcal{A}|}+ \\lambda \\log {|\\mathcal{A}|}+ \\lambda e^{-1})}{l_{2, p}} \\norm{\\zeta_t - \\zeta_k}_p\n  \n\\end{aligned}')
('11.0', 'y = (s_0, a_0, s_1)')
('11.0', '\\begin{aligned}\n    \\left(F_{\\zeta_t}(0, y)\\right)(s, a) = \\begin{cases}\n      0, & (s, a) \\neq (s_0, a_0) \\\\\n      r(s_0, a_0) + \\gamma \\lambda_t \\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot | s_1)\\right), &(s, a) = (s_0, a_0)\n    \\end{cases}.\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    \\norm{F_{\\zeta_t}(0, y)}_p \\leq u_{\\infty, p} \\norm{F_\\theta(0, y)}_\\infty \\leq  u_{\\infty, p}\\left(r_{max} + \\gamma \\lambda \\log {|\\mathcal{A}|}\\right).\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    \\bar F_{\\zeta_t}(q) - \\bar F_{\\zeta_k}(q)\n    = \\bar F_{\\theta_t}(q) - \\bar F_{\\theta_k}(q) - \\gamma \\lambda_t D_{\\mu_{\\theta_t}} P_{\\pi_{\\theta_t}} \\log \\pi_{\\theta_t} + \\gamma \\lambda_k D_{\\mu_{\\theta_k}} P_{\\pi_{\\theta_k}} \\log \\pi_{\\theta_k},\n  \n\\end{aligned}')
('11.0', '\\bar F_\\theta')
('11.0', 'C_1')
('11.0', 'C_2')
('11.0', '\\begin{aligned}\n    \\norm{\\bar F_{\\theta_t}(q) - \\bar F_{\\theta_k}(q)}_p \\leq C_1 \\norm{\\theta_t - \\theta_k}_p \\left(\\norm{q}_p + C_2\\right) \\leq C_1 \\norm{\\zeta_t - \\zeta_k}_p \\left(\\norm{q}_p + C_2\\right).\n  \n\\end{aligned}')
('11.0', '- \\gamma \\lambda_t D_{\\mu_{\\theta_t}} P_{\\pi_{\\theta_t}} \\log \\pi_{\\theta_t} + \\gamma \\lambda_k D_{\\mu_{\\theta_k}} P_{\\pi_{\\theta_k}} \\log \\pi_{\\theta_k}')
('11.0', "\\begin{aligned}\n    \\left(P_{\\pi_\\theta} \\log \\pi_\\theta\\right)(s, a) =& \\sum_{s'} p(s'|s, a) \\sum_{a'} \\pi_\\theta(a'|s') \\log \\pi_\\theta(a'|s') \\\\\n    =& -\\sum_{s'}p(s'|s,a)\\mathbb{H}\\left(\\pi_{\\theta}(\\cdot |s')\\right).\n  \n\\end{aligned}")
('11.0', "\\mathbb{H}\\left(\\pi_\\theta(\\cdot|s')\\right)")
('11.0', '\\theta')
('11.0', '\\log {|\\mathcal{A}|}')
('11.0', 'P_{\\pi_\\theta} \\log \\pi_\\theta')
('11.0', '\\theta')
('11.0', 'D_{\\mu_\\theta}')
('11.0', '\\theta')
('11.0', 'C_3')
('11.0', 'C_4')
('11.0', "\\begin{aligned}\n    \\norm{D_{\\mu_\\theta} P_{\\pi_\\theta} \\log \\pi_\\theta} &\\leq C_3, \\\\\n    \\norm{D_{\\mu_\\theta} P_{\\pi_\\theta} \\log \\pi_\\theta - D_{\\mu_{\\theta'}} P_{\\pi_{\\theta'}} \\log \\pi_{\\theta'}} &\\leq C_4 \\norm{\\theta - \\theta'},\n  \n\\end{aligned}")
('11.0', '\\begin{aligned}\n    &\\norm{\\lambda_k D_{\\mu_{\\theta_k}} P_{\\pi_{\\theta_k}} \\log \\pi_{\\theta_k} - \\lambda_t D_{\\mu_{\\theta_t}} P_{\\pi_{\\theta_t}} \\log \\pi_{\\theta_t}} \\\\\n    \\leq & \\norm{\\lambda_k - \\lambda_t} \\norm{D_{\\mu_{\\theta_k}} P_{\\pi_{\\theta_k}} \\log \\pi_{\\theta_k}} + \\lambda_t \\norm{D_{\\mu_{\\theta_k}} P_{\\pi_{\\theta_k}} \\log \\pi_{\\theta_k} - D_{\\mu_{\\theta_t}} P_{\\pi_{\\theta_t}} \\log \\pi_{\\theta_t}} \\\\\n    \\leq &C_3 \\norm{\\lambda_k - \\lambda_t} + \\lambda C_4 \\norm{\\theta_t - \\theta_k} \\\\\n    \\leq &(C_3 + \\lambda C_4) \\norm{\\zeta_t - \\zeta_k},\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    \\norm{\\tilde q_{\\pi_{\\theta_t}, \\lambda_t} - \\tilde q_{\\pi_{\\theta_k}, \\lambda_k}}_p \\leq C_5 \\norm{\\zeta_t - \\zeta_k}_p\n  \n\\end{aligned}')
('11.0', 'C_5')
('11.0', 'C_6')
('11.0', '\\begin{aligned}\n    \\norm{\\tilde v_{\\pi_{\\theta_t}, \\lambda_t} - \\tilde v_{\\pi_{\\theta_k}, \\lambda_k}}_p \\leq C_6 \\norm{\\zeta_t - \\zeta_k}_p.\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    \\label{eq tmp 12}\n    \\tilde v_{\\pi_{\\theta_t}, \\lambda_t}(s) =& v_{\\pi_{\\theta_t}}(s) + \\lambda_t \\underbrace{\\mathbb{E}_{\\pi_{\\theta_t}}\\left[\\sum_{i=0}^\\infty \\gamma^{i}  \\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot | S_{t+i})\\right)   \\mid S_t = s\\right]}_{\\mathbb{H}_{\\theta_t}(s)}.\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    \\abs{\\mathbb{H}_{\\theta}(s)} \\leq \\frac{\\log {|\\mathcal{A}|}}{1 - \\gamma}.\n  \n\\end{aligned}')
('11.0', '\\mathbb{H}_{\\theta}(s)')
('11.0', '\\theta')
('11.0', 'p_{0, s}')
('11.0', '\\mathcal{S}')
('11.0', 's')
('11.0', 'p_{0, s}(s) = 1')
('11.0', '\\mathbb{H}_\\theta(s)')
('11.0', '\\begin{aligned}\n    \\mathbb{H}_{\\theta}(s) = \\frac{1}{1-\\gamma} \\sum_{s} d_{\\pi_\\theta, \\gamma, p_{0, s}}(s) \\mathbb{H}\\left(\\pi_\\theta(\\cdot |s)\\right).\n  \n\\end{aligned}')
('11.0', "\\begin{aligned}\n    &d_{\\pi_\\theta, \\gamma, p_{0, s}}(s'') \\\\\n    =& (1 - \\gamma) \\sum_{t=0}^\\infty \\gamma^t \\Pr(S_t=s'' | S_0 \\sim p_{0, s}) \\\\\n    =& (1 - \\gamma) p_{0, s}(s'') + (1 - \\gamma) \\sum_{t=1}^{\\infty} \\gamma^t \\Pr(S_t = s'' | S_0 \\sim p_{0, s}) \\\\\n    =& (1 - \\gamma) p_{0, s}(s'') + (1 - \\gamma) \\sum_{t=0}^{\\infty} \\gamma^{t+1} \\Pr(S_{t+1} = s'' | S_0 \\sim p_{0, s}) \\\\\n    =& (1 - \\gamma) p_{0, s}(s'') + \\gamma (1 - \\gamma) \\sum_{t=0}^{\\infty} \\gamma^t \\sum_{s'} \\Pr(S_t = s' | S_0 \\sim p_{0, s}) \\Pr(S_{t+1} = s'' | S_t = s') \\\\\n    =& (1 - \\gamma) p_{0, s}(s'') + \\gamma \\sum_{s'}\\Pr(S_{t+1} = s'' | S_t = s') d_{\\pi_\\theta, \\gamma, p_{0,s}}(s').\n  \n\\end{aligned}")
('11.0', '\\begin{aligned}\n    d_{\\pi_\\theta, \\gamma, p_{0, s}} =& (1 - \\gamma) p_{0, s} + \\gamma P_{\\pi_\\theta}^\\top d_{\\pi_\\theta, \\gamma, p_{0, s}} \\\\\n    \\implies d_{\\pi_\\theta, \\gamma, p_{0, s}} =& (1 - \\gamma) (I - \\gamma P_{\\pi_\\theta}^\\top)^{-1} p_{0, s},\n  \n\\end{aligned}')
('11.0', 'P_{\\pi_\\theta}')
('11.0', '\\pi_\\theta')
('11.0', 'd_{\\pi_\\theta, \\gamma, p_{0, s}}')
('11.0', '\\theta')
('11.0', '\\mathbb{H}\\left(\\pi_\\theta(\\cdot |s)\\right)')
('11.0', '\\theta')
('11.0', '\\mathbb{H}_{\\theta}(s)')
('11.0', '\\theta')
('11.0', "\\begin{aligned}\n    \\label{eq tmp 9}\n    \\abs{\\mathbb{H}_\\theta(s) - \\mathbb{H}_{\\theta'}(s)} \\leq C_7 \\norm{\\theta - \\theta'}.\n  \n\\end{aligned}")
('11.0', 'C_8')
('11.0', "\\begin{aligned}\n    \\label{eq tmp 10}\n    \\abs{v_{\\pi_\\theta}(s) - v_{\\pi_{\\theta'}}(s)} \\leq C_8 \\norm{\\theta - \\theta'}.\n  \n\\end{aligned}")
('11.0', '\\begin{aligned}\n    &\\abs{{\\tilde v_{\\pi_{\\theta_t}, \\lambda_t}(s) - \\tilde v_{\\pi_{\\theta_k}, \\lambda_k}}(s)} \\\\\n    \\leq& \\abs{v_{\\pi_{\\theta_t}}(s) - v_{\\pi_{\\theta_k}}(s)} + \\abs{\\lambda_t - \\lambda_k} \\abs{\\mathbb{H}_{\\theta_t}(s)} + \\lambda_k \\abs{\\mathbb{H}_{\\theta_t}(s) - \\mathbb{H}_{\\theta_k}(s)} \\\\\n    \\leq& C_8 \\norm{\\theta_t - \\theta_k} + \\abs{\\lambda_t - \\lambda_k} \\frac{\\log {|\\mathcal{A}|}}{1 - \\gamma} + \\lambda C_7 \\norm{\\theta_t - \\theta_k} \\\\\n    \\leq& \\left(C_8 + \\frac{\\log {|\\mathcal{A}|}}{1 - \\gamma} + \\lambda C_7\\right) \\norm{\\zeta_t - \\zeta_k},\n  \n\\end{aligned}')
('11.0', '\\tilde q_{\\pi, \\eta}')
('11.0', 'q_\\pi')
('11.0', "\\begin{aligned}\n    r(s, a) + \\eta \\sum_{s'}p(s'|s,a) \\mathbb{H}\\left(\\pi(\\cdot|s')\\right)\n  \n\\end{aligned}")
('11.0', '\\begin{aligned}\n    \\label{eq soft q bound}\n    \\abs{\\tilde q_{\\pi_{\\theta_t, \\lambda_t}}(s, a)} \\leq U_{\\tilde J} \\doteq \\frac{r_{max} + \\lambda \\log {|\\mathcal{A}|}}{1 - \\gamma},\n  \n\\end{aligned}')
('11.0', "\\begin{aligned}\n    \\abs{P_{\\zeta_t}(y, y') - P_{\\zeta_k}(y, y')} \\leq C_9 \\norm{\\theta_t - \\theta_k} \\leq  C_9 \\norm{\\zeta_t - \\zeta_k},\n  \n\\end{aligned}")
('11.0', 'C_9')
('11.0', '\\epsilon_t \\equiv 0')
('11.0', '\\qty{\\theta_t}')
('11.0', '\\begin{aligned}\n    \\label{eq ltheta sac detailed}\n    &\\norm{\\theta_{t+1} - \\theta_t} \\\\\n    =& \\beta_t \\norm{\\sum_a \\pi_{\\theta_t}(a|S_t)\\nabla_\\theta \\log \\pi_{\\theta_t}(a | S_t) \\Big( \\Pi \\big(q_t(S_t, a)\\big) - \\lambda_t \\log \\pi_{\\theta_t}(a | S_t)\\Big)}  \\\\\n    =& \\beta_t \\norm{\\sum_a \\nabla \\pi_{\\theta_t}(a|S_t) \\Big( \\Pi \\big(q_t(S_t, a)\\big) - \\lambda_t \\log \\pi_{\\theta_t}(a | S_t)\\Big)}  \\\\\n    \\leq& \\beta_t \\norm{\\sum_a \\nabla \\pi_{\\theta_t}(a|S_t) \\Pi \\big(q_t(S_t, a)\\big)} + \\beta_t \\lambda_t \\norm{\\sum_a \\nabla \\pi_{\\theta_t}(a|S_t)\\log \\pi_{\\theta_t}(a | S_t)}  \\\\\n    \\leq& \\beta_t 2U_{\\tilde J} + \\beta_t \\lambda_t \\norm{\\sum_a \\nabla \\pi_{\\theta_t}(a|S_t)\\log \\pi_{\\theta_t}(a | S_t)} \\qq{(\\eqref{eq soft q bound} and Lemma~\\ref{lem softmax policy gradient})}  \\\\\n    =& \\beta_t 2U_{\\tilde J} + \\beta_t \\lambda_t \\norm{\\sum_a \\nabla \\pi_{\\theta_t}(a|S_t)\\log \\pi_{\\theta_t}(a | S_t) + \\pi_{\\theta_t}(a|S_t) \\nabla \\log \\pi_{\\theta_t}(a|S_t)} \\\\\n    =& \\beta_t 2U_{\\tilde J} + \\beta_t \\lambda_t \\norm{\\nabla \\mathbb{H}\\left(\\pi_{\\theta_t}(\\cdot|S_t)\\right)} \\\\\n    \\leq& \\beta_t 2U_{\\tilde J} + \\beta_t \\lambda_t \\left(\\log {|\\mathcal{A}|}+ e^{-1}\\right) \\qq{(Lemma~\\ref{lem softmax policy gradient})} \\\\\n    \\label{eq ltheta sac}\n    \\leq& \\beta_t \\underbrace{\\left(2U_{\\tilde J} + \\lambda \\log {|\\mathcal{A}|}+ \\lambda e^{-1}\\right)}_{L_\\theta}.\n  \n\\end{aligned}')
('11.0', '\\begin{aligned}\n    &\\abs{\\lambda_{t+1} - \\lambda_t} \\\\\n    =& \\lambda\\left(\\frac{1}{(t+t_0)^{\\epsilon_\\lambda}} - \\frac{1}{(t+t_0+1)^{\\epsilon_\\lambda}}\\right) \\\\\n    =& \\lambda\\frac{ (t+t_0+1)^{\\epsilon_\\lambda} - (t+t_0)^{\\epsilon_\\lambda} }{(t+t_0)^{\\epsilon_\\lambda} (t+t_0+1)^{\\epsilon_\\lambda}} \\\\\n    =& \\lambda\\frac{ (t+t_0+1)^{\\epsilon_\\lambda} (t+t_0)^{1-\\epsilon_\\lambda} - (t+t_0) }{(t+t_0) (t+t_0+1)^{\\epsilon_\\lambda}} \\\\\n    \\leq & \\lambda\\frac{ (t+t_0+1)^{\\epsilon_\\lambda} (t+t_0+1)^{1-\\epsilon_\\lambda} - (t+t_0) }{(t+t_0) (t+t_0)^{\\epsilon_\\lambda}} \\\\\n    = & \\frac{ \\lambda }{(t+t_0)^{1 + \\epsilon_\\lambda} } \\\\\n    = & \\beta_t \\frac{ \\lambda (t+t_0)^{\\epsilon_\\beta} }{ \\beta (t+t_0)^{1 + \\epsilon_\\lambda} } \\\\\n    \\leq &\\beta_t \\frac{\\lambda}{\\beta}.\n  \n\\end{aligned}')
('11.0', 'L_\\zeta')
('11.0', '\\begin{aligned}\n    \\label{eq lzeta sac}\n    \\norm{\\zeta_{t+1} - \\zeta_t}_p \\leq \\beta_t L_\\zeta,\n  \n\\end{aligned}')
('11.1', "\\begin{aligned}\n    \\label{eq actor convergence shorthard sac}\n    J(\\theta) &\\doteq J(\\pi_\\theta; p_0'), \\\\\n    \\tilde J_\\eta(\\theta) &\\doteq \\tilde J_\\eta(\\pi_\\theta; p_0'), \\\\\n    d_{\\pi, \\gamma}(s) &\\doteq d_{\\pi, \\gamma, p_0'}(s),\n  \n\\end{aligned}")
('11.1', "p_0'")
('11.1', 'p_0')
('11.1', "\\begin{aligned}\n    \\tilde J_\\eta(\\pi_\\theta;p_0') = J(\\pi_\\theta;p_0') + \\eta \\underbrace{\\frac{1}{1-\\gamma} \\sum_{s} d_{\\pi_\\theta, \\gamma, p_0'}(s) \\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right)}_{\\mathbb{H}(\\pi_\\theta)}.\n  \n\\end{aligned}")
('11.1', 'J(\\theta)')
('11.1', 'L_J')
('11.1', 'L_J')
('11.1', '\\norm{\\cdot}')
('11.1', '\\mathbb{H}(\\pi_\\theta)')
('11.1', 'L_H')
('11.1', 'L_H')
('11.1', '\\norm{\\cdot}')
('11.1', '\\tilde J_\\eta(\\theta)')
('11.1', '(L_J + \\eta L_H)')
('11.1', '\\eta = \\lambda_t')
('11.1', "\\begin{aligned}\n    \\tilde J_{\\lambda_t}(\\theta_{t+1}) \\geq& \\tilde J_{\\lambda_t}(\\theta_t) + {\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t), \\theta_{t+1} - \\theta_t\\right>} - (L_J + \\lambda_t L_H) \\norm{\\theta_{t+1}-\\theta_t}^2 \\\\\n    \\geq& \\tilde J_{\\lambda_t}(\\theta_t) + \\underbrace{{\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t), \\theta_{t+1} - \\theta_t\\right>}}_{\\tilde M_1} - \\tilde L_J' \\underbrace{\\norm{\\theta_{t+1}-\\theta_t}^2}_{\\tilde M_2},\n  \n\\end{aligned}")
('11.1', "\\tilde L_J' \\doteq L_J + \\lambda L_H")
('11.1', '\\tilde M_2')
('11.1', '\\begin{aligned}\n    \\tilde M_2 \\leq \\frac{1}{l_{2,p}} \\beta_t^2 L_\\theta^2.\n  \n\\end{aligned}')
('11.1', '\\tilde M_1')
('11.1', 'Y_t')
('11.1', '\\tilde Y_t')
('11.1', 's')
('11.1', '\\begin{aligned}\n    \\label{eq actor helper function sac}\n    \\Lambda_1(\\theta, s, \\eta) &\\doteq \\sum_a \\pi_\\theta(s, a)  \\nabla \\log  \\pi_\\theta(a|s) \\left(\\tilde q_{\\pi_\\theta, \\eta}(s, a) - \\eta \\log \\pi_\\theta(a | s) \\right), \\\\\n    \\bar \\Lambda_1(\\theta, \\eta) &\\doteq \\sum_{s} d_{\\mu_\\theta}(s) \\Lambda(\\theta, s, \\eta).\n  \n\\end{aligned}')
('11.1', '\\begin{aligned}\n    &\\tilde M_1 \\\\\n    = &{\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t), \\theta_{t+1} - \\theta_t\\right>} \\\\\n    =&\\beta_t {\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t),  \\sum_a \\pi_{\\theta_t}(a|S_t) \\nabla \\log \\pi_{\\theta_t}(a | S_t) \\Big(\\Pi (q_t(S_t, a)) - \\lambda_t \\log \\pi_{\\theta_t}(a |S_t) \\Big)\\right>} \\\\\n    % =&\\beta_t \\indot{\\nabla \\tilde J_{\\lambda_t}(\\theta_t)}{ \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) (q_{\\pi_{\\theta_t}, \\lambda_t}(S_t, A_t) - \\lambda_t \\nabla \\log \\pi_{\\theta_t}(A_t |S_t) ) } \\\\\n    % &+\\beta_t \\indot{\\nabla \\tilde J_{\\lambda_t}(\\theta_t)}{\\rho_t \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) \\left( Z_t -  (q_{\\pi_{\\theta_t}, \\lambda_t}(S_t, A_t) - \\lambda_t \\nabla \\log \\pi_{\\theta_t}(A_t |S_t) ) \\right)} \\\\\n    =&\\beta_t \\underbrace{{\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t), \\bar \\Lambda_1(\\theta_t, \\lambda_t)\\right>}}_{\\tilde M_{11}} \\\\\n    &+ \\beta_t \\underbrace{{\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t), \\sum_a \\nabla \\pi_{\\theta_t}(a|S_t) \\Big(\\tilde q_{\\pi_{\\theta_t}, \\lambda_t}(S_t, a) - \\lambda_t \\log \\pi_{\\theta_t}(a |S_t) \\Big)  - \\bar \\Lambda_1(\\theta_t, \\lambda_t)\\right>}}_{\\tilde M_{12}} \\\\\n    &+ \\beta_t \\underbrace{{\\left<\\nabla \\tilde J_{\\lambda_t}(\\theta_t), \\sum_a \\nabla \\pi_{\\theta_t}(a | S_t) \\left( \\Pi (q_t(S_t, a)) -  \\tilde q_{\\pi_{\\theta_t}, \\lambda_t}(S_t, a) \\right)\\right>}}_{\\tilde M_{13}}.\n  \n\\end{aligned}')
('11.1', '\\tilde M_{12}')
('11.1', "\\begin{aligned}\n    \\label{eq actor helper function 2 sac}\n    \\Lambda_1'(\\theta, s, \\eta) \\doteq {\\left<\\nabla \\tilde J_{\\eta}(\\theta),  \\Lambda_1(\\theta, s, \\eta) - \\bar \\Lambda_1(\\theta, \\eta)\\right>}.\n  \n\\end{aligned}")
('11.1', '\\tilde M_{12}')
('11.1', "\\begin{aligned}\n    &\\tilde M_{12} = \\Lambda_1'(\\theta_t, S_t, \\lambda_t)  \\\\\n    =& \\underbrace{\\Lambda_1'(\\theta_t, S_t, \\lambda_t) - \\Lambda_1'(\\theta_{t-\\tau_{\\beta_t}}, S_t, \\lambda_t)}_{\\tilde M_{121}} + \\underbrace{\\Lambda_1'(\\theta_{t-\\tau_{\\beta_t}}, S_t, \\lambda_t) - \\Lambda_1'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde S_t, \\lambda_t)}_{\\tilde M_{122}} \\\\\n    &+ \\underbrace{\\Lambda_1'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde S_t, \\lambda_t)}_{\\tilde M_{123}},\n  \n\\end{aligned}")
('11.1', '\\tilde S_t')
('11.1', '\\tilde Y_t')
('11.1', '\\tilde M_{11}')
('11.1', '\\chi_{11} > 0')
('11.1', '\\begin{aligned}\n  \\tilde M_{11} \\geq \\chi_{11} \\norm{\\nabla \\tilde J_{\\lambda_t}(\\theta_t)}^2.\n\\end{aligned}')
('11.1', '\\tilde M_{121}')
('11.1', "L_{\\Lambda_1'}^* > 0")
('11.1', "\\begin{aligned}\n    \\norm{\\tilde M_{121}} \\leq L_{\\Lambda_1'}^* L_\\theta \\beta_{t-\\tau_{\\beta_t}, t-1},\n  \n\\end{aligned}")
('11.1', 'L_\\theta')
('11.1', '\\tilde M_{122}')
('11.1', "U_{\\Lambda_1'}^* > 0")
('11.1', "\\begin{aligned}\n      \\norm{\\mathbb{E}\\left[\\tilde M_{122}\\right]} \\leq U_{\\Lambda'}^* {|\\mathcal{S}|}{|\\mathcal{A}|}L_\\mu L_\\theta \\sum_{j=t-\\tau_{\\beta_t}}^{t-1} \\beta_{t-\\tau_{\\beta_t}, j}.\n  \n\\end{aligned}")
('11.1', '\\tilde M_{123}')
('11.1', "\\begin{aligned}\n    \\norm{\\mathbb{E}\\left[\\tilde M_{123}\\right]} \\leq U_{\\Lambda_1'}^* \\beta_t.\n  \n\\end{aligned}")
('11.1', '\\tilde M_{13}')
('11.1', '\\chi_{13} > 0')
('11.1', '\\begin{aligned}\n    \\norm{\\mathbb{E}\\left[\\tilde M_{13}\\right]}\\leq& \\chi_{13} \\sqrt{\\mathbb{E}\\left[\\norm{q_t - \\tilde q_{\\pi_{\\theta_t, \\lambda_t}}}_\\infty^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla \\tilde J_{\\lambda_t}(\\theta_t)}^2\\right]}.\n  \n\\end{aligned}')
('11.1', '\\chi_3, \\chi_4')
('11.1', '\\chi_5')
('11.1', '\\begin{aligned}\n  \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2\\right] \\leq& \\chi_3 \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{1}{\\beta_k} \\left(\\mathbb{E}\\left[\\tilde J_{\\lambda_k}(\\theta_{k+1})\\right] - \\mathbb{E}\\left[\\tilde J_{\\lambda_k}(\\theta_k)\\right]\\right) \\\\\n  &+ \\chi_4 \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\sqrt{\\mathbb{E}\\left[\\norm{q_k - \\tilde q_{\\pi_{\\theta_k}, \\lambda_k}}_p^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2\\right]} \\\\\n  &+ \\chi_5 \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{\\log^2(k+t_0)}{(k+t_0)^{\\epsilon_\\beta}},\n\\end{aligned}')
('11.1', '\\ell_p')
('11.1', '\\tilde J_\\eta(\\theta)')
('11.1', '\\forall t, \\theta')
('11.1', '\\begin{aligned}\n  \\abs{\\tilde J_{\\lambda_t}(\\theta)} \\leq U_{\\tilde J},\n\\end{aligned}')
('11.1', 'U_{\\tilde J}')
('11.1', '\\mathbb{H}\\left(\\pi(\\cdot|s)\\right)')
('11.1', '\\log {|\\mathcal{A}|}')
('11.1', '\\text{KL}\\left(\\mathcal{U}_{\\mathcal{A}}||\\pi(\\cdot|s)\\right)')
('11.1', '\\begin{aligned}\n  \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\frac{1}{\\beta_k}\\left(\\tilde J_{\\lambda_k}(\\theta_{k+1}) - \\tilde J_{\\lambda_k}(\\theta_k) \\right) \\leq \\frac{3\\lambda\\beta \\log {|\\mathcal{A}|}}{1-\\gamma} + \\frac{2U_{\\tilde J}}{\\beta} (t+t_0)^{\\epsilon_\\beta}\n  \n\\end{aligned}')
('11.1', '\\begin{aligned}\n  \\label{eq actor convergence stationary points sac}\n  \\frac{\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2\\right] }{t-\\ceil{\\frac{t}{2}}+1} = \\underbrace{\\mathcal{O}\\left(\\frac{1}{t^{1-\\epsilon_\\beta}} + \\frac{\\log^2t}{t^{\\epsilon_\\beta}} + \\frac{1}{t^{\\epsilon_q}}\\right)}_{\\tilde C_t}.\n\\end{aligned}')
('11.1', '\\qty{\\delta_t}')
('11.1', 't > 0')
('11.1', 'k')
('11.1', '\\qty{\\ceil{\\frac{t}{2}}, \\ceil{\\frac{t}{2}} + 1, \\dots, t-1, t}')
('11.1', '\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}')
('11.1', 'k')
('11.1', '\\theta_k')
('11.1', '\\begin{aligned}\n  \\Pr(\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\leq \\delta_t)\n  \\geq& 1 - \\frac{1}{\\delta_t} \\mathbb{E}\\left[\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2\\right] \\\\\n  =& 1 - \\frac{1}{\\delta_t} \\mathbb{E}\\left[ \\mathbb{E}\\left[\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\mid k \\right] \\right]\\\\\n  =& 1 - \\frac{1}{\\delta_t} \\frac{\\sum_{i=\\ceil{\\frac{t}{2}}}^t \\mathbb{E}\\left[\\norm{ \\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\mid k=i \\right] }{t-\\ceil{\\frac{t}{2}}+1} \\\\\n  \\geq & 1 - \\frac{1}{\\delta_t} \\tilde C_t. \\qq{(Using \\eqref{eq actor convergence stationary points sac})}\n\\end{aligned}')
('11.1', '\\delta_k \\geq \\delta_t')
('11.1', '\\begin{aligned}\n  \\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\leq \\delta_t \\implies \\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\leq \\delta_k.\n\\end{aligned}')
('11.1', '\\begin{aligned}\n  \\Pr(\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\leq \\delta_k) \\geq \\Pr(\\norm{\\nabla \\tilde J_{\\lambda_k}(\\theta_k)}^2 \\leq \\delta_t) \\geq 1 - \\frac{1}{\\delta_t} \\tilde C_t.\n\\end{aligned}')
('11.1', '\\begin{aligned}\n  \\delta_t \\doteq \\frac{1}{t^{\\epsilon_0}}\n\\end{aligned}')
('11.2', "p_0'")
('11.2', "\\forall s, p_0'(s) > 0")
('11.2', "\\begin{aligned}\n    \\label{eq tmp 16}\n    \\norm{\\nabla \\tilde J_{\\lambda_k}(\\pi_{\\theta_k}; p_0')}^2 \\leq \\delta_k\n  \n\\end{aligned}")
('11.2', '\\begin{aligned}\n    1 - \\frac{\\tilde C_t}{\\delta_t}.\n  \n\\end{aligned}')
('11.2', '\\pi_{*, \\eta}')
('11.2', '\\forall \\pi, s')
('11.2', '\\begin{aligned}\n    \\tilde v_{\\pi, \\eta}(s) \\leq \\tilde v_{\\pi_{*, \\eta}, \\eta}(s),\n  \n\\end{aligned}')
('11.2', 'd')
('11.2', "d'")
('11.2', "\\begin{aligned}\n      \\tilde J_{\\eta}(\\pi_\\theta; d) \\geq \\tilde J_{\\eta}(\\pi_{*, \\eta}; d) - \\frac{{|\\mathcal{S}|}\\norm{\\nabla \\tilde J_\\eta(\\pi_\\theta; d')}^2}{2 \\eta \\min_s d'(s) \\left(\\min_{s,a} \\pi_\\theta(a|s)\\right)^2} \\max_s \\frac{d_{\\pi_{*,\\eta}, \\gamma, d}(s)}{d_{\\pi_\\theta, \\gamma, d'}(s)}.\n    \n\\end{aligned}")
('11.2', "\\forall s, d'(s) > 0")
('11.2', "d=p_0, d'=p_0'")
('11.2', "\\begin{aligned}\n    \\tilde J_{\\lambda_k}(\\pi_{\\theta_k}; p_0) \\geq& \\tilde J_{\\lambda_k}(\\pi_{*, \\lambda_k}; p_0) - \\frac{{|\\mathcal{S}|}\\norm{\\nabla \\tilde J_{\\lambda_k}(\\pi_{\\theta_k}; p_0')}^2}{2\\lambda_k \\min_s p_0'(s) \\left(\\min_{s, a} \\pi_{\\theta_k}(a|s)\\right)^2} \\max_s \\frac{d_{\\pi_{*, \\lambda_k}, \\gamma, p_0}(s)}{d_{\\pi_{\\theta_k}, \\gamma, p_0'}(s)} \\\\\n    \\label{eq tmp 15}\n    \\geq& \\tilde J_{\\lambda_k}(\\pi_{*, \\lambda_k}; p_0) - \\frac{{|\\mathcal{S}|}\\delta_k}{2\\lambda_k \\min_s p_0'(s)\\left( \\min_{s, a} \\pi_{\\theta_k}(a|s)\\right)^2} \\frac{1}{\\frac{\\min_s p_0'(s)}{1-\\gamma}}\n  \n\\end{aligned}")
('11.2', '\\begin{aligned}\n    1 - \\frac{\\tilde C_t}{\\delta_t}.\n  \n\\end{aligned}')
('11.2', '\\begin{aligned}\n    \\max_s \\abs{\\tilde v_{\\pi_{*, \\eta}, \\eta}(s) - v_{\\pi_*}(s)} \\leq \\frac{\\eta \\log {|\\mathcal{A}|}}{1 - \\gamma},\n  \n\\end{aligned}')
('11.2', '\\begin{aligned}\n    \\abs{\\tilde J_\\eta(\\pi_{*, \\eta};p_0) - J(\\pi_*; p_0)} \\leq& \\frac{\\eta \\log {|\\mathcal{A}|}}{1 - \\gamma}, \n  \n\\end{aligned}')
('11.2', '\\begin{aligned}\n    \\label{eq tmp 13}\n    \\tilde J_\\eta(\\pi_{*, \\eta}; p_0) \\geq J(\\pi_*; p_0) - \\frac{\\eta \\log {|\\mathcal{A}|}}{1 - \\gamma}.\n  \n\\end{aligned}')
('11.2', '\\begin{aligned}\n    \\label{eq tmp 14}\n    \\tilde J_\\eta(\\pi; p_0) \\leq J(\\pi; p_0) + \\frac{\\eta \\log {|\\mathcal{A}|}}{1 - \\gamma}.\n  \n\\end{aligned}')
('11.2', "\\begin{aligned}\n    J(\\pi_{\\theta_k};p_0) \\geq J(\\pi_*; p_0) - \\frac{2\\lambda_k \\log{|\\mathcal{A}|}}{1 - \\gamma} - \\frac{(1 - \\gamma){|\\mathcal{S}|}\\delta_k}{2\\lambda_k \\left(\\min_s p_0'(s) \\min_{s, a} \\pi_{\\theta_k}(a|s)\\right)^2},\n  \n\\end{aligned}")
('12', 'f_1(x), f_2(x)')
('12', 'L_1, L_2')
('12', '\\norm{f_1(x)} \\leq U_1, \\norm{f_2(x)} \\leq U_2')
('12', 'L_1U_2 + L_2U_1')
('12', 'f(x) \\doteq f_1(x)f_2(x)')
('12', '\\begin{aligned}\n    &\\norm{f_1(x)f_2(x) - f_1(y)f_2(y)} \\\\\n    \\leq& \\norm{f_1(x)} \\norm{f_2(x) - f_2(y)} + \\norm{f_2(y)}\\norm{f_1(x) - f_1(y)} \\\\\n    \\leq& (U_1 L_2 + U_2L_1) \\norm{x-y}.\n  \n\\end{aligned}')
('12', 'f(x)')
('12', 'f(x)')
('12', 'L')
('12', '\\norm{\\cdot}_s')
('12', '\\norm{\\nabla f(x) - \\nabla f(y)}_s^* \\leq L \\norm{x - y}_s')
('12', '\\abs{f(y) - f(x) - {\\left<\\nabla f(x), y - x\\right>}} \\leq \\frac{L}{2}\\norm{x - y}^2_s')
('12', "x, x'")
('12', "\\begin{aligned}\n      {\\left<\\nabla M(x), x'\\right>} &\\leq \\norm{x}_m \\norm{x'}_m, \\\\\n      {\\left<\\nabla M(x), x\\right>} &\\geq \\norm{x}_m^2.\n  \n\\end{aligned}")
('12', 'M(x) = \\frac{1}{2} \\norm{x}_m^2')
('12', '\\begin{aligned}\n      \\nabla M(x) = \\norm{x}_m v_{x},\n  \n\\end{aligned}')
('12', 'v_{x}')
('12', '\\norm{x}_m')
('12', 'x')
('12', "\\begin{aligned}\n      {\\left<\\nabla M(x), x'\\right>} &= \\norm{x}_m {\\left<v_x, x'\\right>} \\\\\n      &\\leq \\norm{x}_m \\norm{v_x}_m^* \\norm{x'}_m \\\\\n      &\\leq \\norm{x}_m \\norm{x'}_m,\n  \n\\end{aligned}")
('12', '\\norm{v_x}_m^* \\leq 1')
('12', '\\norm{x}_m')
('12', '\\begin{aligned}\n      \\norm{x}_m \\leq \\norm{0}_m + {\\left<v_{x}, x-0\\right>},\n  \n\\end{aligned}')
('12', '\\begin{aligned}\n      {\\left<\\nabla M(x), x\\right>} &= \\norm{x}_m {\\left<v_x, x\\right>} \\geq \\norm{x}_m^2.\n  \n\\end{aligned}')
('12', 't_1 < t_2')
('12', '\\begin{aligned}\n      \\alpha_{t_1, t_2 - 1} \\leq \\frac{1}{4A},\n  \n\\end{aligned}')
('12', 't \\in [t_1, t_2]')
('12', '\\begin{aligned}\n      \\label{eq bound of xk diff1}\n      \\norm{w_t - w_{t_1}}_c &\\leq 2 \\alpha_{t_1, t_2 - 1}(A\\norm{w_{t_1}}_c + B), \\\\\n      \\label{eq bound of xk diff2}\n      \\norm{w_t - w_{t_1}}_c &\\leq 4 \\alpha_{t_1, t_2 - 1}(A \\norm{w_{t_2}}_c + B), \\\\\n      \\label{eq bound of xk diff3}\n      \\norm{w_t - w_{t_1}}_c &\\leq \\min \\qty{\\norm{w_{t_1}}_c, \\norm{w_{t_2}}_c } + \\frac{B}{A}.\n  \n\\end{aligned}')
('12', "\\begin{aligned}\n      &\\norm{w_{t+1}}_c - \\norm{w_t}_c \\\\\n      \\leq& \\norm{w_{t+1} - w_t}_c \\\\\n      \\leq& \\alpha_t \\norm{F_{\\theta_t}(w_t, Y_t) - w_t + \\epsilon_t}_c  \\\\\n      \\leq& \\alpha_t \\left( \\norm{F_{\\theta_t}(w_t, Y_t)}_c + \\norm{w_t}_c + \\norm{\\epsilon_t}_c \\right) \\\\\n      \\leq&\\alpha_t (U_F + (L_F + 1)\\norm{w_t}_c + \\norm{\\epsilon_t}_c) \\qq{(Lemma~\\ref{lem bound of fxy})} \\\\\n      \\leq&\\alpha_t (U_F + U_\\epsilon' + (U_\\epsilon + L_F + 1)\\norm{w_t}_c) \\qq{(Assumption~\\ref{assu mds})} \\\\\n      \\label{eq tmp 8}\n      \\leq& \\alpha_t (A\\norm{w_t}_c + B) \\qq{(Using \\eqref{eq shorthand a and b})}\n  \n\\end{aligned}")
('12', '\\begin{aligned}\n    \\norm{w_{t+1}}_c + \\frac{B}{A} \\leq (1 + \\alpha_t A)\\left(\\norm{w_t}_c + \\frac{B}{A}\\right),\n  \n\\end{aligned}')
('12', 't \\in (t_1, t_2]')
('12', '\\begin{aligned}\n    \\norm{w_t}_c + \\frac{B}{A} \\leq \\prod_{j=t_1}^{t-1} (1 + A\\alpha_j) \\left(\\norm{w_{t_1}}_c + \\frac{B}{A}\\right) .\n  \n\\end{aligned}')
('12', 'x \\in [0, \\frac{1}{2}]')
('12', '1 + x \\leq \\exp(x) \\leq 1 + 2x')
('12', '\\begin{aligned}\n    \\alpha_{t_1, t_2-1} \\leq \\frac{1}{4A} \n  \n\\end{aligned}')
('12', '\\begin{aligned}\n    \\prod_{j=t_1}^{t-1} (1 + A\\alpha_j) \\leq \\exp(A\\alpha_{t_1, t-1}) \\leq 1 + 2A \\alpha_{t_1, t-1}.\n  \n\\end{aligned}')
('12', 't \\in (t_1, t_2]')
('12', '\\begin{aligned}\n    \\norm{w_t}_c + \\frac{B}{A} &\\leq \\left(1 + 2A \\alpha_{t_1, t-1}\\right) \\left(\\norm{w_{t_1}}_c + \\frac{B}{A} \\right) \\\\\n    \\implies \\norm{w_t}_c & \\leq \\left(1 + 2A \\alpha_{t_1, t-1}\\right) \\norm{w_{t_1}}_c + 2B\\alpha_{t_1, t-1},\n  \n\\end{aligned}')
('12', 't \\in (t_1, t_2 - 1]')
('12', '\\begin{aligned}\n    \\norm{w_{t+1} - w_t}_c &\\leq \\alpha_t \\left(A \\norm{w_t}_c + B\\right) \\\\\n    &\\leq \\alpha_t \\left(A \\left(1 + 2A \\alpha_{t_1, t-1}\\right) \\norm{w_{t_1}}_c + 2AB\\alpha_{t_1, t-1} + B\\right) \\\\\n    &\\leq 2 \\alpha_t(A\\norm{w_{t_1}}_c + B) \\qq{(Using $\\alpha_{t_1, t-1} \\leq \\frac{1}{4A}$)}.\n  \n\\end{aligned}')
('12', 't \\in (t_1, t_2]')
('12', '\\begin{aligned}\n    \\norm{w_t - w_{t_1}}_c &\\leq \\sum_{j=t_1}^{t-1} \\norm{w_{j+1} - w_j}_c \\leq \\sum_{j=t_1}^{t-1} 2 \\alpha_j (A \\norm{w_{t_1}}_c + B) \\\\\n    &= 2 \\alpha_{t_1, t-1}(A \\norm{w_{t_1}}_c + B) \\leq 2 \\alpha_{t_1, t_2-1} (A\\norm{w_{t_1}}_c +B),\n  \n\\end{aligned}')
('12', '\\begin{aligned}\n    \\norm{w_{t_2} - w_{t_1}}_c \\leq& 2\\alpha_{t_1, t_2-1} (A\\norm{w_{t_1}}_c + B) \\\\\n    \\leq &2\\alpha_{t_1, t_2-1} (A\\norm{w_{t_1} - w_{t_2}}_c + A\\norm{w_{t_2}}_c + B) \\\\\n    \\leq& \\frac{1}{2}\\norm{w_{t_1} - w_{t_2}}_c + 2 \\alpha_{t_1, t_2 -1} (A\\norm{w_{t_2}}_c + B),\n  \n\\end{aligned}')
('12', '\\begin{aligned}\n    \\norm{w_{t_2} - w_{t_1}}_c \\leq 4\\alpha_{t_1, t_2 -1} (A\\norm{w_{t_2}}_c + B).\n  \n\\end{aligned}')
('12', 't \\in [t_1, t_2]')
('12', '\\begin{aligned}\n    \\norm{w_t - w_{t_1}}_c\\leq& 2\\alpha_{t_1, t_2-1} (A\\norm{w_{t_1}}_c + B) \\\\\n    \\leq &2\\alpha_{t_1, t_2-1} (A\\norm{w_{t_1} - w_{t_2}}_c + A\\norm{w_{t_2}}_c + B) \\\\\n    \\leq&2\\alpha_{t_1, t_2-1} \\left(A4\\alpha_{t_1, t_2 -1} (A\\norm{w_{t_2}}_c + B) + A\\norm{w_{t_2}}_c + B\\right) \\\\\n    \\leq& 4\\alpha_{t_1, t_2-1}(A\\norm{w_{t_2}}_c + B) \\qq{(Using $\\alpha_{t_1, t_2-1} \\leq \\frac{1}{4A}$)},\n  \n\\end{aligned}')
('12', '\\begin{aligned}\n    \\norm{w_t - w_{t_1}} \\leq \\norm{w_{t_1}}_c + \\frac{B}{A},\n  \n\\end{aligned}')
('12', '\\begin{aligned}\n    \\norm{w_t - w_{t_1}} \\leq \\norm{w_{t_2}}_c + \\frac{B}{A},\n  \n\\end{aligned}')
('12', "L_{\\mu}'")
('12', "\\forall \\theta, \\theta', a, s")
('12', "\\begin{aligned}\n    \\abs{d_{\\mu_\\theta}(s, a) - d_{\\mu_{\\theta'}}(s, a)} \\leq L_\\mu' \\norm{\\theta - \\theta'}.\n  \n\\end{aligned}")
('12', '\\norm{\\cdot}')
('12', '\\begin{aligned}\n    \\norm{X^{-1} - Y^{-1}} \\leq \\norm{X^{-1}} \\norm{X-Y} \\norm{Y^{-1}}.\n  \n\\end{aligned}')
('12', '\\begin{aligned}\n    \\norm{X^{-1} - Y^{-1}} &= \\norm{X^{-1}YY^{-1} - X^{-1}XY^{-1}} \\leq \\norm{X^{-1}} \\norm{X-Y} \\norm{Y^{-1}}.\n  \n\\end{aligned}')
('12', "\\begin{aligned}\n    \\label{eq softmax pg 1}\n    \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} &= \\mathbb{I}_{s=s'} \\pi_\\theta(a|s) \\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right), \\\\\n    \\label{eq softmax pg 2}\n    \\dv{\\log \\pi_\\theta(a|s)}{\\theta_{s', a'}} &= \\mathbb{I}_{s = s'}\\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right), \\\\\n    \\label{eq softmax pg 3}\n    \\dv{\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_\\theta(\\cdot | s)\\right)}{\\theta_{s', a'}} &= \\mathbb{I}_{s=s'}(\\pi_\\theta(a' | s) - \\frac{1}{{|\\mathcal{A}|}}), \\\\\n    \\label{eq softmax pg 3.5}\n    \\sum_a \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} q_{\\pi_\\theta}(s, a) &= \\mathbb{I}_{s=s'} \\pi_\\theta(a'|s){\\text{Adv}_{\\pi_\\theta}(s, a')}, \\\\\n    \\label{eq softmax pg 4}\n    \\dv{J(\\pi_\\theta; p_0)}{\\theta_{s, a}} &= \\frac{1}{1 - \\gamma} d_{\\pi_\\theta, \\gamma, p_0}(s) \\pi_\\theta(a|s) {\\text{Adv}_{\\pi_\\theta}(s, a)}, \\\\\n    \\label{eq softmax pg 5}\n    \\norm{\\nabla \\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right)} &\\leq \\log {|\\mathcal{A}|}+ e^{-1}, \\\\\n    \\label{eq softmax pg 6}\n    \\sum_a \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} \\left( \\tilde q_{\\pi_\\theta, \\eta}(s, a) - \\eta \\log \\pi_\\theta(a|s) \\right) &= \\mathbb{I}_{s=s'} \\pi_\\theta(a'|s) \\tilde \\text{Adv}_{\\pi_\\theta, \\eta}(s, a)  \\\\\n    \\label{eq softmax pg 7}\n    \\dv{\\tilde J_\\eta(\\pi_\\theta; p_0)}{\\theta_{s, a}} &= \\frac{1}{1 - \\gamma} d_{\\pi_\\theta, \\gamma, p_0}(s) \\pi_\\theta(a|s) {\\tilde \\text{Adv}_{\\pi_\\theta, \\eta}(s, a)},\n  \n\\end{aligned}")
('12', "\\begin{aligned}\n    \\tilde \\text{Adv}_{\\pi_\\theta, \\eta}(s, a) &\\doteq \\tilde q_{\\pi_\\theta, \\eta}(s, a') - \\eta \\log \\pi_{\\theta}(a'|s) -  \\tilde v_{\\pi_\\theta, \\eta}(s), \\\\\n    \\text{Adv}_{\\pi_\\theta, \\eta}(s, a) &\\doteq q_{\\pi_\\theta}(s, a) - v_{\\pi_\\theta}(s).\n  \n\\end{aligned}")
('12', 's')
('12', '\\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right)')
('12', '(4 + 8 \\log {|\\mathcal{A}|})')
('12', "\\begin{aligned}\n    \\dv{\\log \\pi_\\theta(a|s)}{\\theta_{s', a'}} = \\frac{1}{\\pi_\\theta(a|s)} \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} = \\mathbb{I}_{s = s'}\\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right).\n  \n\\end{aligned}")
('12', "\\begin{aligned}\n    \\dv{\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_\\theta(\\cdot | s)\\right)}{\\theta_{s', a'}} =& - \\frac{\\mathbb{I}_{s=s'}}{{|\\mathcal{A}|}} \\sum_a \\dv{\\log \\pi_\\theta(a|s)}{\\theta_{s', a'}}  \\\\\n    =& - \\frac{\\mathbb{I}_{s=s'}}{{|\\mathcal{A}|}} \\sum_a \\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right).\n  \n\\end{aligned}")
('12', "\\begin{aligned}\n    \\sum_a \\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right) = \\left(\\sum_a \\left(0 - \\pi_\\theta(a' | s)\\right) \\right) + 1 = 1 - {|\\mathcal{A}|}\\pi_{\\theta}(a'|s),\n  \n\\end{aligned}")
('12', "\\begin{aligned}\n    \\dv{\\text{KL}\\left(\\mathcal{U}||\\pi_\\theta(\\cdot | s)\\right)}{\\theta_{s', a'}} = \\mathbb{I}_{s=s'}(\\pi(a' | s) - \\frac{1}{{|\\mathcal{A}|}}).\n  \n\\end{aligned}")
('12', "\\begin{aligned}\n    &\\sum_a \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} q_{\\pi_\\theta}(s, a) \\\\\n    =& \\sum_a \\mathbb{I}_{s=s'} \\pi_\\theta(a|s) \\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right) q_{\\pi_\\theta}(s, a) \\\\\n    =& \\mathbb{I}_{s=s'} \\left(\\pi_\\theta(a'|s)q_{\\pi_\\theta}(s, a') + \\sum_a \\pi_\\theta(a|s) \\left(0 - \\pi_\\theta(a' | s)\\right) q_{\\pi_\\theta}(s, a) \\right) \\\\\n    =& \\mathbb{I}_{s=s'} \\left(\\pi_\\theta(a'|s)q_{\\pi_\\theta}(s, a') - \\pi_\\theta(a'|s) v_{\\pi_\\theta}(s) \\right).\n  \n\\end{aligned}")
('12', "\\begin{aligned}\n    &\\dv{\\mathbb{H}\\left(\\pi_\\theta(\\cdot |s)\\right)}{\\theta_{s', a'}} \\\\\n    =& -\\mathbb{I}_{s=s'} \\sum_a \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} \\log \\pi_\\theta(a|s) + 0 \\\\\n    =& -\\mathbb{I}_{s=s'} \\sum_a \\pi_\\theta(a|s) \\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right) \\log \\pi_\\theta(a|s) \\\\\n    =& -\\mathbb{I}_{s=s'} \\left(\\pi_\\theta(a'|s) \\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right) + \\pi_\\theta(a'|s) \\log \\pi_\\theta(a'|s) \\right),\n  \n\\end{aligned}")
('12', '\\begin{aligned}\n    \\norm{\\nabla \\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right)} \\leq \\log {|\\mathcal{A}|}+ e^{-1}.\n  \n\\end{aligned}')
('12', '\\gamma = 0')
('12', '\\rho')
('12', 's')
('12', '\\mathbb{H}\\left(\\pi_\\theta(\\cdot |s)\\right)')
('12', '(4+8\\log {|\\mathcal{A}|})')
('12', "\\begin{aligned}\n    &\\sum_a \\dv{\\pi_\\theta(a|s)}{\\theta_{s',a'}} \\left( \\tilde q_{\\pi_\\theta, \\eta}(s, a) - \\eta \\log \\pi_\\theta(a|s) \\right)\\\\\n    =& \\sum_a \\mathbb{I}_{s=s'} \\pi_\\theta(a|s) \\left(\\mathbb{I}_{a = a'} - \\pi_\\theta(a' | s)\\right) \\left( \\tilde q_{\\pi_\\theta, \\eta}(s, a) - \\eta \\log \\pi_\\theta(a|s) \\right) \\\\\n    =& \\mathbb{I}_{s=s'} \\left(\\pi_\\theta(a'|s) \\left( \\tilde q_{\\pi_\\theta, \\eta}(s, a') - \\eta \\log \\pi_\\theta(a'|s) \\right) -\\sum_a \\pi_\\theta(a|s)  \\pi_\\theta(a' | s) \\left( \\tilde q_{\\pi_\\theta, \\eta}(s, a) - \\eta \\log \\pi_\\theta(a|s) \\right) \\right) \\\\\n    =& \\mathbb{I}_{s=s'} \\pi_\\theta(a'|s) \\left(\\tilde q_{\\pi_\\theta, \\eta}(s, a') - \\eta \\log \\pi_{\\theta}(a'|s) -  \\tilde v_{\\pi_\\theta, \\eta}(s) \\right).\n  \n\\end{aligned}")
('13.0', '\\begin{aligned}\n      T_1 =&{\\left<\\nabla M(w_t - w^*_{\\theta_t}), w^*_{\\theta_t} - w^*_{\\theta_{t+1}}\\right>} \\\\\n      \\leq & \\norm{w_t - w^*_{\\theta_t}}_m \\norm{w^*_{\\theta_t} - w^*_{\\theta_{t+1}}}_m  \\qq{(Lemma \\ref{lem gradient of M})}\\\\\n      \\leq & \\norm{w_t - w^*_{\\theta_t}}_m \\frac{L_w L_\\theta \\beta_t}{l_{cm}} \\qq{(Assumptions \\ref{assu regularization}, \\ref{assu twotimescale} and Lemma \\ref{lem property of M})}.\n      % \\leq &\\frac{L_w L_\\theta \\beta_t}{l_{cm}} \\left(\\norm{w_t - w^*_{\\theta_t}}_m^2 + 1\\right) \\qq{(Using $x^2 + 1^2 \\geq 2x \\geq x \\,\\, \\forall x > 0$)}.\n  \n\\end{aligned}')
('13.1', '\\begin{aligned}\n  T_2 = &{\\left<\\nabla M(w_t - w^*_{\\theta_t}), \\bar F_{\\theta_t}(w_t) - w_t\\right>} \\\\\n  =& {\\left<\\nabla M (w_t - w^*_{\\theta_t}), \\bar F_{\\theta_t}(w_t) - \\bar F_{\\theta_t}(w^*_{\\theta_t})\\right>} - {\\left<\\nabla M(w_t - w^*_{\\theta_t}), w_t - w^*_{\\theta_t}\\right>}\n  \\intertext{\\hfill ($w^*_{\\theta_t}$ is the fixed point).}\n\\end{aligned}')
('13.1', '\\begin{aligned}\n  &{\\left<\\nabla M (w_t - w^*_{\\theta_t}), \\bar F_{\\theta_t}(w_t) - \\bar F_{\\theta_t}(w^*_{\\theta_t})\\right>} \\\\ \n  \\leq & \\norm{w_t - w^*_{\\theta_t}}_m  \\norm{\\bar F_{\\theta_t}(w_t) - \\bar F_{\\theta_t}(w^*_{\\theta_t})}_m \\qq{(Lemma \\ref{lem gradient of M})} \\\\\n  \\leq & \\norm{w_t - w^*_{\\theta_t}}_m \\frac{1}{l_{cm}} \\kappa \\norm{w_t - w^*_{\\theta_t}}_c \\\\\n  \\leq & \\frac{u_{cm} \\kappa}{l_{cm}} \\norm{w_t - w^*_{\\theta_t}}_m^2 \n\\end{aligned}')
('13.1', '\\begin{aligned}\n  {\\left<\\nabla M(w_t - w^*_{\\theta_t}), w_t - w^*_{\\theta_t}\\right>} \\geq \\norm{w_t - w^*_{\\theta_t}}^2_m.\n\\end{aligned}')
('13.2', '\\begin{aligned}\n      T_{31} = &{\\left<\\nabla M(w_t - w^*_{\\theta_t}) - \\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)\\right>} \\\\\n      \\leq &\\norm{\\nabla M(w_t - w^*_{\\theta_t}) - \\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^*\\norm{F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)}_s.\n  \n\\end{aligned}')
('13.2', '\\begin{aligned}\n  &\\norm{\\nabla M(w_t - w^*_{\\theta_t}) - \\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\\\\n  \\leq& \\frac{L}{\\xi} \\norm{w_t - w_{t-\\tau_{\\alpha_t}} + w_{\\theta_{t-\\tau_{\\alpha_t}}}^* - w_{\\theta_{t}}^*}_s \\qq{(Lemmas \\ref{lem property of M} and \\ref{lem smooth definition})} \\\\\n  \\leq& \\frac{L}{\\xi} \\norm{w_t - w_{t-\\tau_{\\alpha_t}}}_s + \\frac{L}{\\xi} \\norm{w^*_{\\theta_t} - w_{\\theta_{t-\\tau_{\\alpha_t}}}^*}_s \\\\\n  \\leq& \\frac{L}{\\xi l_{cs}} \\norm{w_t - w_{t-\\tau_{\\alpha_t}}}_c + \\frac{L}{\\xi l_{cs}} L_w L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\\\\n  \\leq& \\frac{4L \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}} (A\\norm{w_t}_c + B)+ \\frac{L}{\\xi l_{cs}} L_w L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\qq{(Lemma \\ref{lem bound of xk diff})}\\\\\n  \\leq& \\frac{4L \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}} (A\\norm{w_t - w^*_{\\theta_t}}_c + A\\norm{w^*_{\\theta_t}}_c + B)+ \\frac{L}{\\xi l_{cs}} L_w L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\\\\n  \\leq& \\frac{4L \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}} (A\\norm{w_t - w^*_{\\theta_t}}_c + A\\norm{w^*_{\\theta_t}}_c + B)+ \\frac{4L}{\\xi l_{cs}} (L_w L_\\theta + 1) \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\\\\n  \\leq& \\frac{4L (L_wL_\\theta+1) \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}} (A\\norm{w_t - w^*_{\\theta_t}}_c + AU_w + B + 1).\n\\end{aligned}')
('13.2', '\\begin{aligned}\n  &\\norm{F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)}_s \\\\\n  \\leq& \\frac{1}{l_{cs}}\\norm{F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)}_c \\\\\n  \\leq& \\frac{1}{l_{cs}}\\left(\\norm{F_{\\theta_t}(w_t, Y_t)}_c + \\norm{\\bar F_{\\theta_t}(w_t) - \\bar F_{\\theta_t}(w^*_{\\theta_t})}_c + \\norm{w^*_{\\theta_t}}_c \\right)\\\\\n  \\leq&\\frac{1}{l_{cs}}  \\left( U_F + L_F \\norm{w_t}_c + \\norm{w_t - w^*_{\\theta_t}}_c + \\norm{w^*_{\\theta_t}}_c \\right) \\qq{(Lemma~\\ref{lem bound of fxy})} \\\\\n  \\leq&\\frac{1}{l_{cs}} \\left( U_F + L_F \\norm{w_t - w^*_{\\theta_t}}_c + L_F \\norm{w^*_{\\theta_t}}_c +  \\norm{w_t - w^*_{\\theta_t}}_c + \\norm{w^*_{\\theta_t}}_c \\right) \\\\\n  \\leq&\\frac{1}{l_{cs}} \\left(A\\norm{w_t - w^*_{\\theta_t}}_c + A \\norm{w^*_{\\theta_t}}_c + B\\right).\n\\end{aligned}')
('13.2', '\\begin{aligned}\n  &{\\left<\\nabla M(w_t - w^*_{\\theta_t}) - \\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_t}), F_{\\theta_t}(w_t, Y_t) - \\bar F_{\\theta_t}(w_t)\\right>} \\\\\n  \\leq& \\frac{4L (L_wL_\\theta + 1)  \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}^2} (A\\norm{w_t - w^*_{\\theta_t}}_c + C)^2 \\\\\n  \\leq& \\frac{8L (L_wL_\\theta + 1)  \\alpha_{t-\\tau_{\\alpha_t}, t-1}}{\\xi l_{cs}^2} (A^2 u_{cm}^2\\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2),\n\\end{aligned}')
('13.3', '\\begin{aligned}\nT_{32} = &{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) + \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)\\right>} \\\\\n\\leq & \\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^*\\norm{F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) + \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)}_s \\\\\n\\leq & \\frac{1}{l_{cs}} \\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^*\\norm{F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) + \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)}_c\n  \n\\end{aligned}')
('13.3', '\\begin{aligned}\n  \\label{eq gradient bound dual norm}\n  &\\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\\\\n  =&\\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}) - \\nabla M(w^*_{\\theta_t} - w^*_{\\theta_t})}_s^*  \\\\\n  \\intertext{\\hfill (Using $\\nabla M(0) = 0$, see the proof of Lemma~\\ref{lem gradient of M})}\n  \\leq&\\frac{L}{\\xi}\\norm{(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}) - (w^*_{\\theta_t} - w^*_{\\theta_t})}_s \\qq{(Lemmas~\\ref{lem property of M} and \\ref{lem smooth definition})}\\\\\n  \\leq& \\frac{L}{\\xi} \\norm{w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_t}}_s + \\frac{L}{\\xi} \\norm{w^*_{\\theta_t} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}}_s  \\\\\n  \\leq& \\frac{L }{\\xi l_{cs}} \\norm{w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_t}}_c + \\frac{L}{\\xi l_{cs}} L_w L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\\\\n  \\leq& \\frac{L }{\\xi l_{cs}}\\left(\\norm{w_{t-\\tau_{\\alpha_t}} - w_t}_c + \\norm{w_t - w^*_{\\theta_t}}_c \\right)+ \\frac{L}{\\xi l_{cs}} L_w L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\\\\n  \\leq& \\frac{L}{\\xi l_{cs}}\\left(\\norm{w_t}_c + \\frac{B}{A} + \\norm{w_t - w^*_{\\theta_t}}_c \\right)+ \\frac{L}{\\xi l_{cs}} L_w L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\qq{(Lemma \\ref{lem bound of xk diff})} \\\\\n  \\leq& \\frac{L (1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}}\\left(\\norm{w^*_{\\theta_t}}_c + \\norm{w_t - w^*_{\\theta_t}}_c + \\frac{B}{A} + \\norm{w_t - w^*_{\\theta_t}}_c + 1\\right) \\\\\n  \\leq& \\frac{2L (1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}}\\left(U_w + \\frac{B}{A} + \\norm{w_t - w^*_{\\theta_t}}_c + 1\\right).\n\\end{aligned}')
('13.3', '\\begin{aligned}\n  &\\norm{F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) + \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)}_c \\\\\n  \\leq &\\norm{F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t)}_c + \\norm{\\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)}_c \\\\\n  \\leq& L_F \\norm{w_{t-\\tau_{\\alpha_t}} - w_t}_c + \\norm{\\sum_{y} d_{\\theta_t}(y) \\left(F_{\\theta_t}(w_{t-\\tau_{\\alpha_t}}, y) - F_{\\theta_t}(w_t, y)\\right)}_c \\\\\n  \\leq& 2L_F \\norm{w_{t-\\tau_{\\alpha_t}} - w_t}_c \\\\\n  \\leq& 2A \\norm{w_{t-\\tau_{\\alpha_t}} - w_t}_c \\\\\n  \\leq& 8A \\alpha_{t-\\tau_{\\alpha_t}, t-1} \\left(A \\norm{w_t}_c + B\\right) \\qq{(Lemma~\\ref{lem bound of xk diff})} \\\\\n  \\leq& 8A \\alpha_{t-\\tau_{\\alpha_t}, t-1} (A\\norm{w_t - w^*_{\\theta_t}}_c + A \\norm{w^*_{\\theta_t}}_c + B).\n\\end{aligned}')
('13.3', '\\begin{aligned}\n  &{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_t}), F_{\\theta_t}(w_t, Y_t) - F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}, Y_t) + \\bar F_{\\theta_t}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_t}(w_t)\\right>} \\\\\n  \\leq&\\frac{16L  \\alpha_{t-\\tau_{\\alpha_t}, t-1}(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}^2}(A\\norm{w_t - w^*_{\\theta_t}}_c + A U_w + B + A)^2 \\\\\n  \\leq&\\frac{32L  \\alpha_{t-\\tau_{\\alpha_t}, t-1}(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}^2}(u_{cm}^2A^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2) \n\\end{aligned}')
('13.4', '\\begin{aligned}\n      \\label{eq conditional independence t331}\n      &\\mathbb{E}\\left[T_{331}\\right] \\\\\n      = &\\mathbb{E}\\left[{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})\\right>}\\right] \\\\\n      =&\\mathbb{E}\\left[ \\mathbb{E}\\left[{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})\\right>} \\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\ w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}} \\right] \\right]\\\\\n      =&\\mathbb{E}\\left[ {\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), \\mathbb{E}\\left[F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})\\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\ w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}} \\right] \\right>}\\right] \\\\\n      \\leq&\\mathbb{E}\\left[ \\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\norm{\\mathbb{E}\\left[F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})\\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\ w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}} \\right] }_s \\right] \\\\\n      \\leq&\\frac{1}{l_{cs}}\\mathbb{E}\\left[ \\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\norm{\\mathbb{E}\\left[F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})\\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\ w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}} \\right] }_c \\right]\n  \n\\end{aligned}')
('13.4', '\\begin{aligned}\n  &\\norm{\\mathbb{E}\\left[F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t) - \\bar F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}) \\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}}\\right]}_c \\\\\n  =&\\norm{\\sum_y \\left(\\Pr(\\tilde Y_t = y \\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}}) - d_{\\theta_{t-\\tau_{\\alpha_t}}}(y) \\right) F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, y) }_c \\\\\n  \\leq &\\max_y \\norm{ F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, y) }_c \\sum_y \\left|\\Pr(\\tilde Y_t = y \\mid \\substack{\\theta_{t-\\tau_{\\alpha_t}} \\\\w_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}}) - d_{\\theta_{t-\\tau_{\\alpha_t}}}(y) \\right| \\\\\n  \\label{eq bound of xk-tk}\n  \\leq &\\max_y \\norm{ F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, y) }_c \\alpha_t \\qq{(Definition of $\\tau_{\\alpha_t}$)} \\\\\n  \\leq & \\alpha_t (U_F + L_F \\norm{w_{t-\\tau_{\\alpha_t}}}_c) \\qq{(Lemma \\ref{lem bound of fxy})} \\\\\n  \\leq & \\alpha_t (U_F + L_F \\norm{w_{t-\\tau_{\\alpha_t}} - w_t}_c + L_F \\norm{w_t}_c) \\\\\n  \\leq & \\alpha_t (B + A (\\norm{w_t}_c + \\frac{B}{A}) + A \\norm{w_t}_c) \\qq{(Lemma \\ref{lem bound of xk diff})} \\\\\n  \\leq & \\alpha_t (2B + (A + 1) \\norm{w_t}_c) \\\\\n  \\leq & 2\\alpha_t (B + A \\norm{w_t}_c) \\\\\n  \\leq & 2\\alpha_t (B + A \\norm{w_t - w^*_{\\theta_t}}_c + A \\norm{w^*_{\\theta_t}}_c).\n\\end{aligned}')
('13.4', '\\begin{aligned}\n  &\\mathbb{E}\\left[T_{331}\\right] \\\\\n  \\leq & \\mathbb{E}\\left[\\frac{4L  \\alpha_t(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A\\xi l_{cs}^2}\\left(AU_w + B + A\\norm{w_t - w^*_{\\theta_t}}_c + A\\right)^2\\right] \\\\\n  \\leq & \\mathbb{E}\\left[\\frac{8L \\alpha_t(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A\\xi l_{cs}^2}\\left(A^2 u_{cm}^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 +C^2\\right)\\right],\n\\end{aligned}')
('13.5', '\\begin{aligned}\n      &\\mathbb{E}\\left[T_{332}\\right] \\\\\n      = &\\mathbb{E}\\left[{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t)\\right>}\\right] \\\\\n      \\leq & \\frac{1}{l_{cs}} \\mathbb{E}\\left[\\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\norm{ \\mathbb{E}\\left[{F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, \\tilde Y_t)} \\mid \\substack{w_{t-\\tau_{\\alpha_t}} \\\\ \\theta_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}} \\right]}_s\\right] \\\\\n      \\intertext{\\hfill (Similar to \\eqref{eq conditional independence t331})}\n      \\leq& \\mathbb{E}\\Bigg[\\frac{2L(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}^2}\\left(\\norm{w^*_{\\theta_t}}_c + \\frac{B}{A} + \\norm{w_t - w^*_{\\theta_t}}_c + 1\\right) \\\\\n      &\\times 2{|\\mathcal{Y}|}L_PL_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j}(B + A \\norm{w_t - w^*_{\\theta_t}}_c + A \\norm{w^*_{\\theta_t}}_c) \\Bigg] \\\\\n      \\intertext{\\hfill (Using \\eqref{eq gradient bound dual norm} and Lemma \\ref{lem chain difference bound})}\n      \\leq & \\frac{8 {|\\mathcal{Y}|}L_P L_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j} L(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A \\xi l_{cs}^2} \\left(u_{cm}^2 A^2 \\mathbb{E}\\left[\\norm{w_t - w^*_{\\theta_t}}_m^2\\right] + C^2\\right),\n  \n\\end{aligned}')
('13.6', "\\begin{aligned}\n      T_{333} = &{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), F_{\\theta_{t}}(w_{t- \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, Y_t)\\right>}  \\\\\n      \\leq &\\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\norm{F_{\\theta_{t}}(w_{t- \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}, Y_t)}_s  \\\\\n      \\leq & \\frac{2L(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}^2}\\left(\\norm{w^*_{\\theta_t}}_c + \\frac{B}{A} + \\norm{w_t - w^*_{\\theta_t}}_c + 1\\right) \\\\\n      &\\times L_F' L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\left(\\norm{w_{t-\\tau_{\\alpha_t}}}_c + U_F' \\right) \\qq{(Using \\eqref{eq gradient bound dual norm} and Assumption \\ref{assu regularization})}.\n  \n\\end{aligned}")
('13.6', '\\begin{aligned}\n  \\label{eq tmp 3}\n  &\\norm{w_{t-\\tau_{\\alpha_t}}}_c \\\\\n  \\leq & \\norm{w_{t-\\tau_{\\alpha_t}} - w_t}_c + \\norm{w_t}_c \\\\\n  \\leq & 2\\norm{w_t}_c + \\frac{B}{A} \\qq{(Lemma \\ref{lem bound of xk diff})} \\\\\n  \\leq & 2\\norm{w_t - w^*_{\\theta_t}}_c + 2\\norm{w^*_{\\theta_t}}_c + \\frac{B}{A},\n\\end{aligned}')
('13.6', "\\begin{aligned}\n  T_{333} \\leq \\frac{8LL_F' L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} (1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{A^2 \\xi l_{cs}^2}\\left(u_{cm}^2 A^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 + (AU_x + A + B + AU_F')^2\\right),\n\\end{aligned}")
('13.7', "\\begin{aligned}\n      T_{334} = &{\\left<\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}}), \\bar F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_{t}}(w_{t- \\tau_{\\alpha_t}})\\right>}  \\\\\n      \\leq &\\norm{\\nabla M(w_{t-\\tau_{\\alpha_t}} - w^*_{\\theta_{t-\\tau_{\\alpha_t}}})}_s^* \\norm{\\bar F_{\\theta_{t}}(w_{t- \\tau_{\\alpha_t}}) - \\bar F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t- \\tau_{\\alpha_t}})}_s  \\\\\n      \\leq & \\frac{2L(1 + L_wL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1})}{\\xi l_{cs}^2}\\left(\\norm{w^*_{\\theta_t}}_c + \\frac{B}{A} + \\norm{w_t - w^*_{\\theta_t}}_c + 1\\right) \\\\\n      &\\times L_F'' L_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\left(\\norm{w_{t-\\tau_{\\alpha_t}}}_c + U_F''\\right) \\qq{(Using \\eqref{eq gradient bound dual norm} and Assumption \\ref{assu regularization})}.\n  \n\\end{aligned}")
('13.8', '\\begin{aligned}\n    &\\mathbb{E}\\left[T_4\\right] \\\\\n    =& \\mathbb{E}\\left[{\\left<\\nabla M(w_t - w^*_{\\theta_t}), \\epsilon_t\\right>} \\right] \\\\\n    =& \\mathbb{E}\\left[\\mathbb{E}\\left[{\\left<\\nabla M(w_t - w^*_{\\theta_t}), \\epsilon_t\\right>} \\mid \\mathcal{F}_t \\right] \\right] \\qq{(Tower law of expectation)} \\\\\n    =& \\mathbb{E}\\left[{\\left<\\nabla M(w_t - w^*_{\\theta_t}), \\mathbb{E}\\left[\\epsilon_t \\mid \\mathcal{F}_t \\right]\\right>} \\right] \\qq{(Conditional independence)} \\\\\n    =&0\\qq{(Assumption~\\ref{assu mds})}\n  \n\\end{aligned}')
('13.9', "\\begin{aligned}\n      T_5 =&\\frac{L }{\\xi}\\norm{F_{\\theta_t}(w_t, Y_t) - w_t + \\epsilon_t}_s^2 \\\\\n      \\leq& \\frac{L }{\\xi l_{cs}^2}\\norm{F_{\\theta_t}(w_t, Y_t) - w_t + \\epsilon_t}_c^2  \\\\\n      \\leq& \\frac{L^2 }{\\xi l_{cs}}\\left(\\norm{F_{\\theta_t}(w_t, Y_t)}_c + \\norm{w_t}_c + \\norm{\\epsilon_t}_c \\right)^2  \\\\\n      \\leq& \\frac{L }{\\xi l_{cs}^2}\\left(U_F + (L_F + 1) \\norm{w_t}_c + U_\\epsilon \\norm{w_t}_c + U_\\epsilon'\\right)^2 \\qq{(Lemma~\\ref{lem bound of fxy} and Assumption~\\ref{assu mds})} \\\\\n      \\leq& \\frac{L }{\\xi l_{cs}^2}\\left(B + A \\norm{w_t}_c\\right)^2  \\\\\n      \\leq& \\frac{L }{\\xi l_{cs}^2}\\left(B + A \\norm{w_t - w^*_{\\theta_t}}_c + A\\norm{w^*_{\\theta_t}}_c\\right)^2  \\\\\n      \\leq& \\frac{2L}{\\xi l_{cs}^2}\\left(A^2 u_{cm}^2 \\norm{w_t - w^*_{\\theta_t}}_m^2 + C^2\\right)\n  \n\\end{aligned}")
('13.9', 't')
('13.9', '\\begin{aligned}\n      \\norm{F_{\\theta_t}(w, y)}_c \\leq U_F + L_F \\norm{w}_c\n  \n\\end{aligned}')
('13.9', '\\begin{aligned}\n      \\norm{F_{\\theta_t}(w, y)}_c - \\norm{F_{\\theta_t}(0, y)}_c  &\\leq \\norm{F_{\\theta_t}(0, y) - F_{\\theta_t}(w, y)}_c \\\\\n      &\\leq L_F \\norm{w - 0}_c,\n  \n\\end{aligned}')
('13.9', '\\begin{aligned}\n      &\\norm{ \\mathbb{E}\\left[{F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t - \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t - \\tau_{\\alpha_t}}, \\tilde Y_t)} \\mid \\substack{w_{t-\\tau_{\\alpha_t}} \\\\ \\theta_{t-\\tau_{\\alpha_t}} \\\\ Y_{t-\\tau_{\\alpha_t}}} \\right]} \\\\\n      \\leq &2{|\\mathcal{Y}|}L_PL_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j}(B + A \\norm{w_t - w^*_{\\theta_t}}_c + A \\norm{w^*_{\\theta_t}}_c)\n  \n\\end{aligned}')
('13.9', '\\Pr')
('13.9', '\\mathbb{E}')
('13.9', 'w_{t-\\tau_{\\alpha_t}}, \\theta_{t-\\tau_{\\alpha_t}}, Y_{t-\\tau_{\\alpha_t}}')
('13.9', '\\Theta_t')
('13.9', '\\theta_t')
('13.9', "\\begin{aligned}\n      &\\Pr(Y_t = y') \\\\\n      =& \\sum_{y} \\int_{\\Theta_{t}} \\Pr(Y_t = y' , Y_{t-1} = y, \\theta_{t} = z) dz \\\\\n      =& \\sum_{y} \\int_{\\Theta_{t}} \\Pr(Y_t = y' \\mid Y_{t-1} = y, \\theta_{t} = z) \\Pr(Y_{t-1} = y, \\theta_{t} = z) dz \\\\\n      =& \\sum_{y} \\int_{\\Theta_{t}} P_{z}(y, y') \\Pr(Y_{t-1} = y) \\Pr(\\theta_{t} = z | Y_{t-1} = y) dz\n  \n\\end{aligned}")
('13.9', "\\begin{aligned}\n      &\\Pr(\\tilde Y_t = y') \\\\\n      =& \\sum_{y} \\Pr(\\tilde Y_{t-1} = y) P_{\\theta_{t-\\tau_{\\alpha_t}}}(y, y') \\\\\n      =& \\sum_{y} \\Pr(\\tilde Y_{t-1} = y) P_{\\theta_{t-\\tau_{\\alpha_t}}}(y, y') \\int_{\\Theta_{t}} \\Pr(\\theta_{t} = z | Y_{t-1} = y) dz \\\\\n      =& \\sum_{y} \\int_{\\Theta_{t}} \\Pr(\\tilde Y_{t-1} = y) P_{\\theta_{t-\\tau_{\\alpha_t}}}(y, y')  \\Pr(\\theta_{t} = z | Y_{t-1} = y) dz \\\\\n  \n\\end{aligned}")
('13.9', "\\begin{aligned}\n      &\\sum_{y'} \\left|\\Pr(Y_t = y') - \\Pr(\\tilde Y_t = y') \\right| \\\\\n      \\leq &\\sum_{y, y'} \\int_{\\Theta_{t}} \\left| \\Pr(Y_{t-1} = y) P_z(y, y') - \\Pr(\\tilde Y_{t-1} = y) P_{\\theta_{t-\\tau_{\\alpha_t}}}(y, y')\\right| \\Pr(\\theta_{t} = z \\mid Y_{t-1} = y) dz.\n  \n\\end{aligned}")
('13.9', 'z \\in \\Theta_{t}')
('13.9', "\\begin{aligned}\n  &\\left| \\Pr(Y_{t-1} = y) P_z(y, y') - \\Pr(\\tilde Y_{t-1} = y) P_{\\theta_{t-\\tau_{\\alpha_t}}}(y, y')\\right| \\\\\n  \\leq & \\left| \\Pr(Y_{t-1} = y) P_z(y, y') - \\Pr(\\tilde Y_{t-1} = y) P_{z}(y, y')\\right| \\\\\n  &+ \\left| \\Pr(\\tilde Y_{t-1} = y) P_z(y, y') - \\Pr(\\tilde Y_{t-1} = y) P_{\\theta_{t-\\tau_{\\alpha_t}}}(y, y')\\right| \\\\\n  \\leq & \\left| \\Pr(Y_{t-1} = y) - \\Pr(\\tilde Y_{t-1} = y) \\right| P_z(y, y') + L_PL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1} \\Pr(\\tilde Y_{t-1} = y),\n\\end{aligned}")
('13.9', "\\begin{aligned}\n  &\\sum_{y'} \\left|\\Pr(Y_t = y') - \\Pr(\\tilde Y_t = y') \\right| \\\\\n  \\leq & \\sum_y \\left| \\Pr(Y_{t-1} = y) - \\Pr(\\tilde Y_{t-1} = y) \\right| + {|\\mathcal{Y}|}L_PL_\\theta \\beta_{t-\\tau_{\\alpha_t}, t-1}.\n\\end{aligned}")
('13.9', "\\begin{aligned}\n  \\label{eq y difference two chains}\n  \\sum_{y'} \\left|\\Pr(Y_t = y') - \\Pr(\\tilde Y_t = y') \\right| \\leq {|\\mathcal{Y}|}L_PL_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1} \\beta_{t-\\tau_{\\alpha_t}, j}.\n\\end{aligned}")
('13.9', '\\begin{aligned}\n  &\\norm{ \\mathbb{E}\\left[{F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t - \\tau_{\\alpha_t}}, Y_t) -F_{\\theta_{t - \\tau_{\\alpha_t}}}(w_{t - \\tau_{\\alpha_t}}, \\tilde Y_t)} \\right]}_c \\\\\n  =& \\norm{\\sum_y \\left(\\Pr(Y_t = y) - \\Pr(\\tilde Y_t = y)\\right) F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t-\\tau_{\\alpha_t}}, y)}_c \\\\\n  \\leq &\\max_y \\norm{F_{\\theta_{t-\\tau_{\\alpha_t}}}(w_{t-\\tau_{\\alpha_t}}, y)}_c {|\\mathcal{Y}|}L_PL_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j} \\\\\n  % \\leq &(U_F + L_F \\norm{w_{t-\\tau_{\\alpha_t}}}_c) \\ny L_PL_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-2}\\beta_{t-\\tau_{\\alpha_t}, j} \\qq{(Lemma \\ref{lem bound of fxy})} \\\\\n  \\leq & 2{|\\mathcal{Y}|}L_PL_\\theta \\sum_{j=t-\\tau_{\\alpha_t}}^{t-1}\\beta_{t-\\tau_{\\alpha_t}, j}(B + A \\norm{w_t - w^*_{\\theta_t}}_c + A \\norm{w^*_{\\theta_t}}_c) \\qq{(Using \\eqref{eq bound of xk-tk}),}\n\\end{aligned}')
('13.10', '\\tau_{\\alpha_t}')
('13.10', '\\begin{aligned}\n    \\tau_{\\alpha_t} = \\ceil*{\\frac{\\log \\alpha_t - \\log C_0}{\\log \\tau}} = \\mathcal{O}(\\log (t+t_0)),\n  \n\\end{aligned}')
('13.10', '\\ceil{\\cdot}')
('13.10', '\\begin{aligned}\n    \\alpha_{t-{\\tau_{\\alpha_t}}, t-1} \\leq \\tau_{\\alpha_t} \\alpha_{t-\\tau_{\\alpha_t}} = \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0 - \\tau_{\\alpha_t})^{\\epsilon_\\alpha}}\\right) = \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{\\epsilon_\\alpha}}\\right),\n  \n\\end{aligned}')
('13.10', '\\begin{aligned}\n    \\frac{\\alpha_t \\alpha_{t-{\\tau_{\\alpha_t}}, t-1}}{\\beta_t} = \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{2\\epsilon_\\alpha - \\epsilon_\\beta}}\\right).\n  \n\\end{aligned}')
('13.10', '\\beta_t < \\alpha_t')
('13.10', 't')
('13.10', '\\begin{aligned}\n    \\beta_{t-{\\tau_{\\alpha_t}}, t-1} < \\alpha_{t-{\\tau_{\\alpha_t}}, t-1} = \\mathcal{O}\\left(\\frac{\\log (t+t_0)}{(t+t_0)^{\\epsilon_\\alpha}}\\right),\n  \n\\end{aligned}')
('13.11', "\\begin{aligned}\n    \\norm{w_{t+1}}_c \\leq& \\norm{w_t}_c + \\alpha_t \\left( \\norm{F_{\\theta_t}(w_t, Y_t)}_c + \\norm{w_t}_c + \\norm{\\epsilon_t}_c \\right) \\\\\n    \\leq& \\norm{w_t}_c + \\alpha_t \\left(U_F + L_F \\norm{w_t}_c + \\norm{w_t}_c + U_\\epsilon \\norm{w_t}_c + U_\\epsilon' \\right) \\\\\n    \\intertext{\\hfill(Lemma~\\ref{lem bound of fxy} and Assumption~\\ref{assu mds}).}\n  \n\\end{aligned}")
('13.11', 'C_{t_0, w_0}')
('13.11', 't \\leq t_0')
('13.11', '\\begin{aligned}\n    \\mathbb{E}\\left[\\norm{w_{t} - w^*_{\\theta_{t}}}_m^2\\right] \\leq C_{t_0, w_0}.\n  \n\\end{aligned}')
('13.12', "\\begin{aligned}\n    &M_{11} \\\\\n    =& \\sum_{s, a} \\left(d_{\\mu_{\\theta_t}}(s) \\pi_{\\theta_t}(a|s) \\nabla \\log \\pi_{\\theta_t}(a|s) q_{\\pi_{\\theta_t}}(s, a) +  \\frac{\\lambda_t}{{|\\mathcal{A}|}} d_{\\mu_{\\theta_t}}(s) \\nabla \\log \\pi_{\\theta_t}(a|s) \\right)^\\top \\nabla J_{\\lambda_t}(\\theta_t) \\\\\n    =& \\sum_{s', a'} \\sum_{s, a} \\left(d_{\\mu_{\\theta_t}}(s) \\dv{\\pi_{\\theta_t}(a | s)}{\\theta_{s',a'}} q_{\\pi_{\\theta_t}}(s, a) + \\frac{\\lambda_t}{{|\\mathcal{A}|}} d_{\\mu_{\\theta_t}}(s) \\dv{\\log \\pi_{\\theta_t} (a|s)}{\\theta_{s',a'}}   \\right)  \\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s',a'}} \\\\\n    =& \\sum_{s', a'} \\left( d_{\\mu_{\\theta_t}}(s') \\pi_{\\theta_t}(a'|s') \\text{Adv}_{\\pi_{\\theta_t}}(s', a') + \\frac{\\lambda_t}{{|\\mathcal{A}|}} d_{\\mu_{\\theta_t}}(s')  (1 -  {|\\mathcal{A}|}\\pi_{\\theta_t}(a'|s')) \\right) \\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s',a'}} \\\\\n    \\intertext{\\hfill (Lemma~\\ref{lem softmax policy gradient})}\n    =& \\sum_{s, a} \\left( d_{\\mu_{\\theta_t}}(s) \\pi_{\\theta_t}(a|s) \\text{Adv}_{\\pi_{\\theta_t}}(s, a) + \\lambda_t d_{\\mu_{\\theta_t}}(s) (\\frac{1}{{|\\mathcal{A}|}} - \\pi_{\\theta_t}(a|s)) \\right) \\\\\n    &\\times \\left(\\underbrace{\\frac{1}{1 - \\gamma} d_{\\pi_{\\theta_t}, \\gamma}(s) \\pi_{\\theta_t}(a|s) \\text{Adv}_{\\pi_{\\theta_t}}(s, a)}_{M_{111}} + \\underbrace{\\frac{\\lambda_t}{{|\\mathcal{S}|}} (\\frac{1}{{|\\mathcal{A}|}} - \\pi_{\\theta_t}(a | s))}_{M_{112}}\\right) \\\\\n    \\intertext{\\hfill (Lemma~\\ref{lem softmax policy gradient})}\n    =& \\sum_{s, a} \\left( \\frac{d_{\\mu_{\\theta_t}}(s)(1-\\gamma)}{d_{\\pi_{\\theta_t}, \\gamma}(s)}M_{111} + d_{\\mu_{\\theta_t}}(s) {|\\mathcal{S}|}M_{112} \\right)(M_{111} + M_{112}) \\\\\n    =& \\sum_{s, a} \\frac{d_{\\mu_{\\theta_t}}(s)(1-\\gamma)}{d_{\\pi_{\\theta_t}, \\gamma}(s)}M_{111}^2 + d_{\\mu_{\\theta_t}}(s) {|\\mathcal{S}|}M_{112}^2 + \\left(\\frac{d_{\\mu_{\\theta_t}}(s)(1-\\gamma)}{d_{\\pi_{\\theta_t}, \\gamma}(s)} + d_{\\mu_{\\theta_t}}(s) {|\\mathcal{S}|}\\right) M_{111}M_{112} \\\\\n    \\geq& \\sum_{s, a} \\underbrace{\\chi_{11} M_{111}^2 +  \\chi_{12} M_{112}^2 + \\left(\\frac{d_{\\mu_{\\theta_t}}(s)(1-\\gamma)}{d_{\\pi_{\\theta_t}, \\gamma}(s)} + d_{\\mu_{\\theta_t}}(s) {|\\mathcal{S}|}\\right) M_{111}M_{112}}_{M_{113}} \\\\\n\\end{aligned}")
('13.12', '\\begin{aligned}\n    \\chi_{11} &\\doteq \\inf_{\\theta, s} \\frac{d_{\\mu_{\\theta}}(s) (1 - \\gamma)}{d_{\\pi_{\\theta}, \\gamma}(s)}, \\\\\n    \\chi_{12} &\\doteq \\inf_{\\theta, s} {d_{\\mu_{\\theta}}(s) {|\\mathcal{S}|}}.\n\\end{aligned}')
('13.12', 'd_{\\mu_\\theta}')
('13.12', '\\theta')
('13.12', '\\begin{aligned}\n  \\chi_{11} > 0, \\, \\chi_{12} > 0.\n\\end{aligned}')
('13.12', 'M_{111}M_{112} < 0')
('13.12', '\\begin{aligned}\n  M_{113} \\geq \\chi_{11} M_{111}^2 +  \\chi_{12} M_{112}^2 \\geq \\frac{\\min\\qty{\\chi_{11}, \\chi_{12}}}{2}(M_{111}+M_{112})^2.\n\\end{aligned}')
('13.12', 'M_{111}M_{112} \\geq 0')
('13.12', '\\begin{aligned}\n  M_{113} \\geq \\chi_{11} M_{111}^2 +  \\chi_{12} M_{112}^2 + (\\chi_{11} + \\chi_{12})M_{111}M_{112} \\geq \\min\\qty{\\chi_{11}, \\chi_{12}} (M_{111}+M_{112})^2\n\\end{aligned}')
('13.12', '\\begin{aligned}\n  \\chi_1 \\doteq \\frac{\\min\\qty{\\chi_{11}, \\chi_{12}}}{2} > 0,\n\\end{aligned}')
('13.12', '\\begin{aligned}\n  M_{113} \\geq \\chi_1 (M_{111}+M_{112})^2,\n\\end{aligned}')
('13.12', '\\begin{aligned}\n  M_{11} &\\geq \\chi_1 \\sum_{s,a} (M_{111} + M_{112})^2 \\\\\n  &= \\chi_1 \\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2 \\qq{(Lemma~\\ref{lem softmax policy gradient})},\n\\end{aligned}')
('13.13', '\\Lambda(\\theta, y, \\eta)')
('13.13', 'q_{\\pi_\\theta}')
('13.13', '\\theta')
('13.13', '\\nabla \\log \\pi_\\theta(a|s)')
('13.13', '\\theta')
('13.13', '\\inf_{\\theta, a, s} \\mu_\\theta(a|s) > 0')
('13.13', '\\frac{\\pi_\\theta(a|s)}{\\mu_\\theta(a|s)}')
('13.13', 'L_\\Lambda(\\eta)')
('13.13', 'U_{\\Lambda}(\\eta)')
('13.13', 'y')
('13.13', "\\begin{aligned}\n    \\norm{\\Lambda(\\theta, y, \\eta) - \\Lambda(\\theta', y, \\eta)} &\\leq L_{\\Lambda}(\\eta) \\norm{\\theta -\\theta'}, \\\\\n    \\sup_{\\theta} \\norm{\\Lambda(\\theta, y, \\eta)} &\\leq U_{\\Lambda}(\\eta).\n  \n\\end{aligned}")
('13.13', '\\bar \\Lambda(\\theta, \\eta)')
('13.13', 'd_{\\mu_\\theta}')
('13.13', 'L_{\\bar \\Lambda}(\\eta)')
('13.13', 'U_{\\bar \\Lambda}(\\eta)')
('13.13', "\\begin{aligned}\n    \\norm{\\bar \\Lambda(\\theta, \\eta) - \\bar \\Lambda(\\theta', \\eta)} &\\leq L_{\\bar \\Lambda}(\\eta) \\norm{\\theta -\\theta'}, \\\\\n    \\sup_{\\theta} \\norm{\\bar \\Lambda(\\theta, y, \\eta)} &\\leq U_{\\bar \\Lambda}(\\eta).\n  \n\\end{aligned}")
('13.13', "\\Lambda'(\\theta, y, \\eta)")
('13.13', 'J_\\eta(\\theta)')
('13.13', 'L_J + \\eta L_\\text{KL}')
('13.13', 'L_J + \\eta L_\\text{KL}')
('13.13', '\\nabla J_\\eta(\\theta)')
('13.13', '\\nabla J_\\eta(\\theta)')
('13.13', '\\eta')
('13.13', "L_{\\Lambda'}(\\eta)")
('13.13', "U_{\\Lambda'}(\\eta)")
('13.13', 'y')
('13.13', "\\begin{aligned}\n    \\label{eq lambda prime constants}\n    \\norm{\\Lambda'(\\theta, y, \\eta) - \\Lambda'(\\theta', y, \\eta)} &\\leq L_{\\Lambda'}(\\eta) \\norm{\\theta -\\theta'}, \\\\\n    \\sup_\\theta \\norm{\\Lambda'(\\theta, y, \\eta)} &\\leq U_{\\Lambda'}(\\eta).\n  \n\\end{aligned}")
('13.13', "\\begin{aligned}\n    \\norm{M_{121}} &= \\norm{\\Lambda'(\\theta_t, Y_t, \\lambda_t) - \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, Y_t, \\lambda_t)} \\\\\n    &\\leq L_{\\Lambda'}(\\lambda_t) \\norm{\\theta_t - \\theta_{t-\\tau_{\\beta_t}}} \\\\\n    &\\leq \\frac{L_{\\Lambda'}(\\lambda_t) L_\\theta}{l_{2, p}} \\beta_{t-\\tau_{\\beta_t}, t-1} \\qq{(Using \\eqref{eq ltheta})}.\n  \n\\end{aligned}")
('13.13', '\\lambda_t \\in [0, \\lambda]')
('13.13', "L_{\\Lambda'}(\\eta)")
('13.13', '[0, \\lambda]')
('13.13', "L_{\\Lambda'}(\\eta)")
('13.13', '[0, \\lambda]')
('13.13', "L_{\\Lambda'}^*")
('13.13', "\\begin{aligned}\n    \\norm{M_{121}} \\leq \\frac{L_{\\Lambda'}^* L_\\theta}{l_{2, p}} \\beta_{t-\\tau_{\\beta_t}, t-1}.\n  \n\\end{aligned}")
('13.14', '\\begin{aligned}\n      &\\norm{\\mathbb{E}\\left[M_{122}\\right]} \\\\\n      =&\\norm{\\mathbb{E}\\left[\\mathbb{E}\\left[M_{122} \\mid \\theta_{t-\\tau_{\\beta_t}}, Y_{t-\\tau_{\\beta_t}}\\right]\\right]} \\\\\n      \\leq &\\mathbb{E}\\left[\\norm{\\mathbb{E}\\left[M_{122} \\mid \\theta_{t-\\tau_{\\beta_t}}, Y_{t-\\tau_{\\beta_t}}\\right]}\\right].\n    \n\\end{aligned}')
('13.14', '\\Pr')
('13.14', '\\mathbb{E}')
('13.14', '\\theta_{t-\\tau_{\\beta_t}}')
('13.14', 'Y_{t-\\tau_{\\beta_t}}')
('13.14', "\\begin{aligned}\n        &\\norm{\\mathbb{E}\\left[M_{122}\\right]} \\\\\n        =&\\norm{\\mathbb{E}\\left[\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, Y_t, \\lambda_t) - \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)\\right]} \\\\\n        = &\\norm{\\sum_{y} \\left(\\Pr(\\tilde Y_t = y) - \\Pr(Y_t = y)\\right) \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, y, \\lambda_t)} \\\\\n        \\leq &\\max_y \\norm{ \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, y, \\lambda_t)}\\sum_{y} \\left|\\Pr(\\tilde Y_t = y) - \\Pr(Y_t = y)\\right| \\\\\n        \\leq &U_{\\Lambda'}(\\lambda_t)\\sum_{y} \\left|\\Pr(\\tilde Y_t = y) - \\Pr(Y_t = y)\\right| \\qq{(Using \\eqref{eq lambda prime constants})} \\\\\n        \\leq &U_{\\Lambda'}(\\lambda_t) {|\\mathcal{S}|}{|\\mathcal{A}|}L_\\mu L_\\theta \\sum_{j=t-\\tau_{\\beta_t}}^{t-1} \\beta_{t-\\tau_{\\beta_t}, j} \\qq{(Similar to \\eqref{eq y difference two chains} with $L_\\theta$ defined in \\eqref{eq ltheta})}.\n    \n\\end{aligned}")
('13.14', '\\lambda_t \\in [0, \\lambda]')
('13.14', "U_{\\Lambda'}(\\eta)")
('13.14', "U_{\\Lambda'}^*")
('13.14', '[0, \\lambda]')
('13.14', "\\begin{aligned}\n      \\norm{\\mathbb{E}\\left[M_{122}\\right]} \\leq U_{\\Lambda'}^* {|\\mathcal{S}|}{|\\mathcal{A}|}L_\\mu L_\\theta \\sum_{j=t-\\tau_{\\beta_t}}^{t-1} \\beta_{t-\\tau_{\\beta_t}, j},\n    \n\\end{aligned}")
('13.15', "\\begin{aligned}\n    &\\norm{\\mathbb{E}\\left[M_{123}\\right]} \\\\\n    =&\\norm{\\mathbb{E}\\left[\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)\\right]} \\\\\n    =&\\norm{\\mathbb{E}\\left[\\mathbb{E}\\left[\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)\\mid \\theta_{t-\\tau_{\\beta_t}}, Y_{t-\\tau_{\\beta_t}}\\right]\\right]} \\\\\n    \\leq &\\mathbb{E}\\left[\\norm{\\mathbb{E}\\left[\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)\\mid \\theta_{t-\\tau_{\\beta_t}}, Y_{t-\\tau_{\\beta_t}}\\right]}\\right].\n  \n\\end{aligned}")
('13.15', '\\Pr')
('13.15', '\\mathbb{E}')
('13.15', '\\theta_{t-\\tau_{\\beta_t}}')
('13.15', 'Y_{t-\\tau_{\\beta_t}}')
('13.15', '\\tilde Y_t = (\\tilde S_t, \\tilde A_t)')
('13.15', "\\begin{aligned}\n    \\sum_{s, a} d_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}}(s) \\mu_{\\theta_{t-\\tau_{\\beta_t}}}(a|s) \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, (s, a), \\lambda_t) = 0,\n  \n\\end{aligned}")
('13.15', "\\begin{aligned}\n    &\\norm{\\mathbb{E}\\left[\\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, \\tilde Y_t, \\lambda_t)\\right]} \\\\\n    =& \\norm{\\sum_{s, a} \\left(\\Pr(\\tilde S_t = s, \\tilde A_t = a) - d_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}}(s) \\mu_{\\theta_{t-\\tau_{\\beta_t}}}(a|s)\\right) \\Lambda'(\\theta_{t-\\tau_{\\beta_t}}, (s, a), \\lambda_t)} \\\\\n    \\leq& \\sup_{s, a, \\theta} \\norm{\\Lambda'(\\theta, (s, a), \\lambda_t)} \\sum_{s, a} \\abs{\\Pr(\\tilde S_t = s, \\tilde A_t = a) - d_{\\mu_{\\theta_{t-\\tau_{\\beta_t}}}}(s) \\mu_{\\theta_{t-\\tau_{\\beta_t}}}(a|s)} \\\\\n    \\leq& U_{\\Lambda'}^* \\beta_t \\qq{(Using \\eqref{eq definition of beta t})},\n  \n\\end{aligned}")
('13.16', '\\begin{aligned}\n    &\\norm{\\mathbb{E}\\left[M_{13}\\right]} \\\\\n    =&\\norm{\\mathbb{E}\\left[{\\left<\\nabla J_{\\lambda_t}(\\theta_t),  \\rho_t  \\nabla \\log \\pi_{\\theta_t}(A_t | S_t) \\left(\\Pi\\left(q_t(S_t, A_t)\\right) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right) \\right>}\\right]} \\\\\n    \\leq & \\sum_{s, a} \\mathbb{E}\\left[\\abs{\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\rho_t  \\dv{\\log \\pi_{\\theta_t}(A_t | S_t)}{\\theta_{s, a}}  \\left(\\Pi\\left(q_t(S_t, A_t)\\right) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right)}\\right] \\\\\n    \\leq& \\sum_{s, a} \\sqrt{{\\mathbb{E}\\left[\\left(\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\right)^2\\right]}{\\mathbb{E}\\left[\\left(\\rho_t  \\dv{\\log \\pi_{\\theta_t}(A_t | S_t)}{\\theta_{s, a}}\\right)^2  \\left(\\Pi\\left(q_t(S_t, A_t)\\right) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right)^2 \\right]}},\n    \\intertext{\\hfill (Cauchy-Schwarz inequality)}\n  \n\\end{aligned}')
('13.16', "\\begin{aligned}\n    \\abs{\\dv{\\log \\pi_\\theta(a|s)}{\\theta_{s', a'}}} < 2.\n  \n\\end{aligned}")
('13.16', '\\begin{aligned}\n    \\rho_{max} \\doteq \\sup_{\\theta, s, a} \\frac{\\pi_{\\theta}(a|s)}{\\mu_\\theta(a|s)} < \\infty.\n  \n\\end{aligned}')
('13.16', '\\begin{aligned}\n    &\\norm{\\mathbb{E}\\left[M_{13}\\right]} \\\\\n    \\leq& 2\\rho_{max} \\sum_{s, a} \\sqrt{{\\mathbb{E}\\left[\\left(\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\right)^2\\right]}{\\mathbb{E}\\left[\\left(\\Pi\\left(q_t(S_t, A_t)\\right) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right)^2 \\right]}} \\\\\n    =& 2\\rho_{max} \\sum_{s, a} \\sqrt{{\\mathbb{E}\\left[\\left(\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\right)^2\\right]}{\\mathbb{E}\\left[\\left(\\Pi\\left(q_t(S_t, A_t)\\right) - \\Pi\\left(q_{\\pi_{\\theta_t}}(S_t, A_t) \\right) \\right)^2 \\right]}} \\\\\n    \\leq& 2\\rho_{max} \\sum_{s, a} \\sqrt{{\\mathbb{E}\\left[\\left(\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\right)^2\\right]}{\\mathbb{E}\\left[\\left(q_t(S_t, A_t) - q_{\\pi_{\\theta_t}}(S_t, A_t) \\right)^2 \\right]}} \\\\\n    \\intertext{\\hfill (Projection to a convex set is nonexpansive)}\n    \\leq& 2\\rho_{max} \\sum_{s, a} \\sqrt{{\\mathbb{E}\\left[\\left(\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\right)^2\\right]}{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_\\infty^2 \\right]}} \\\\\n    \\leq& 2\\rho_{max} \\sqrt{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_\\infty^2 \\right]} \\sum_{s, a} \\left( \\sqrt{{\\mathbb{E}\\left[\\left(\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s, a}}\\right)^2\\right]}{}} \\times 1 \\right) \\\\\n    \\leq& 2\\rho_{max} \\sqrt{{|\\mathcal{S}\\times \\mathcal{A}|}}\\sqrt{\\mathbb{E}\\left[\\norm{q_t - q_{\\pi_{\\theta_t}}}_\\infty^2 \\right]} \\sqrt{\\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right]},\n    \\intertext{\\hfill (Cauchy-Schwarz inequality)}\n  \n\\end{aligned}')
('13.17', '\\begin{aligned}\n    \\abs{\\dv{J_{\\lambda_t}(\\theta_t)}{\\theta_{s,a}}} \\leq \\abs{\\frac{1}{1 - \\gamma} d_{\\pi_\\theta, \\gamma, p_0}(s) \\pi_\\theta(a|s) {\\text{Adv}_{\\pi_\\theta}(s, a)}} + \\frac{\\lambda_t}{{|\\mathcal{S}|}} \\abs{\\pi_\\theta(a | s) - \\frac{1}{{|\\mathcal{A}|}}}.\n  \n\\end{aligned}')
('13.17', '\\lambda_t < \\lambda')
('13.17', '\\chi_6')
('13.17', '\\lambda')
('13.17', '\\forall t, \\theta')
('13.17', '\\begin{aligned}\n    \\norm{\\nabla J_{\\lambda_t}(\\theta)}^2 \\leq \\chi_6.\n  \n\\end{aligned}')
('13.17', '\\chi_7 > 0')
('13.17', '\\begin{aligned}\n  \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_{t+1})\\right] \\geq& \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right] + \\beta_t \\chi_{11} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] \\\\\n  &-\\underbrace{\\left(\\beta_t \\chi_{12} \\frac{\\log^2(t+t_0)}{(t+t_0)^{\\epsilon_\\beta}} +\\beta_t \\chi_{7} t^{-\\frac{\\epsilon_q}{2}} \\sqrt{\\chi_6} + \\beta_t \\chi_2 \\frac{1}{(t+t_0)^{\\epsilon_\\beta}}\\right)}_{z_t}.\n\\end{aligned}')
('13.17', '\\begin{aligned}\n  &\\mathbb{E}\\left[J_{\\lambda_{t+1}}(\\theta_{t+1})\\right] \\\\\n  \\geq& \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right] + \\beta_t \\chi_{11} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] + \\mathbb{E}\\left[J_{\\lambda_{t+1}}(\\theta_{t+1})\\right] - \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_{t+1})\\right] - z_t \\\\\n  = & \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right] + \\beta_t \\chi_{11} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] + (\\lambda_t - \\lambda_{t+1}) \\mathbb{E}_{s\\sim\\mathcal{U}_\\mathcal{S}}\\left[\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_{t+1}}(\\cdot|s)\\right)\\right] - z_t \\\\\n  \\intertext{\\hfill (Using \\eqref{eq definition of new objective})}\n  \\geq & \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right] - z_t \\qq{(Using $\\lambda_t > \\lambda_{t+1}$)}.\n\\end{aligned}')
('13.17', '\\begin{aligned}\n  \\mathbb{E}\\left[J_{\\lambda_t}(\\theta_t)\\right] \\geq \\mathbb{E}\\left[J_{\\lambda_0}(\\theta_0)\\right] - \\sum_{k=0}^t z_k \\geq \\mathbb{E}\\left[J_{\\lambda_0}(\\theta_0)\\right] - \\sum_{k=0}^\\infty z_k. \n\\end{aligned}')
('13.17', '\\epsilon_\\beta > 0.5')
('13.17', '\\begin{aligned}\n  \\sum_{t=0}^\\infty \\beta_t \\frac{\\log^2(t+t_0)}{(t+t_0)^{\\epsilon_\\beta}} = \\sum_{t=0}^\\infty \\frac{\\beta \\log^2(t+t_0)}{(t+t_0)^{2\\epsilon_\\beta}} &< \\infty, \\\\\n  \\sum_{t=0}^\\infty \\beta_t \\frac{1}{(t+t_0)^{\\epsilon_\\beta}} = \\sum_{t=0}^\\infty \\frac{\\beta }{(t+t_0)^{2\\epsilon_\\beta}} &< \\infty.\n\\end{aligned}')
('13.17', '\\epsilon_q > 2(1 - \\epsilon_\\beta)')
('13.17', '\\begin{aligned}\n  \\sum_{t=0}^\\infty \\beta_t t^{-\\frac{\\epsilon_q}{2}} < \\sum_{t=0} \\frac{\\beta}{t^{\\epsilon_\\beta + \\frac{\\epsilon_q}{2}}} < \\infty.\n\\end{aligned}')
('13.17', '\\begin{aligned}\n  \\sum_{t=0}^{\\infty} z_t < \\infty, \n\\end{aligned}')
('13.17', '\\mathbb{E}\\left[J_{\\lambda_{t+1}}(\\theta_{t+1})\\right]')
('13.17', '\\begin{aligned}\n  \\mathbb{E}\\left[J_{\\lambda_{t+1}}(\\theta_{t+1})\\right] \\leq \\frac{r_{max}}{1 - \\gamma},\n\\end{aligned}')
('13.17', '\\abs{\\mathbb{E}\\left[J_{\\lambda_{t+1}}(\\theta_{t+1})\\right]}')
('13.17', '\\begin{aligned}\n  &\\mathbb{E}\\left[J_{\\lambda_{t}}(\\theta_{t+1})\\right] \\\\\n  \\geq& \\mathbb{E}\\left[J_{\\lambda_{t-1}}(\\theta_t)\\right] + \\beta_t \\chi_{11} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] + \\mathbb{E}\\left[J_{\\lambda_{t}}(\\theta_{t})\\right] - \\mathbb{E}\\left[J_{\\lambda_{t-1}}(\\theta_{t})\\right] - z_t \\\\\n  = & \\mathbb{E}\\left[J_{\\lambda_{t-1}}(\\theta_t)\\right] + \\beta_t \\chi_{11} \\mathbb{E}\\left[\\norm{\\nabla J_{\\lambda_t}(\\theta_t)}^2\\right] + (\\lambda_{t-1} - \\lambda_{t}) \\mathbb{E}_{s\\sim\\mathcal{U}_\\mathcal{S}}\\left[\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_t}(\\cdot|s)\\right)\\right] - z_t \\\\\n  \\geq & \\mathbb{E}\\left[J_{\\lambda_{t-1}}(\\theta_t)\\right] -  z_t \\qq{(Using $\\lambda_{t-1} > \\lambda_{t}$)}.\n\\end{aligned}')
('13.17', '\\abs{\\mathbb{E}\\left[J_{\\lambda_{t}}(\\theta_{t+1})\\right]}')
('13.18', '\\begin{aligned}\n    &\\mathbb{E}\\left[\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\left(\\frac{1}{\\beta_k}J_{\\lambda_k}(\\theta_{k+1}) - \\frac{1}{\\beta_k}J_{\\lambda_k}(\\theta_k) \\right) \\right]\\\\\n    =& \\mathbb{E}\\left[\\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}J_{\\lambda_{k-1}}(\\theta_k) - \\frac{1}{\\beta_k}J_{\\lambda_k}(\\theta_k) \\right) + \\frac{1}{\\beta_t} J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} J_{\\lambda_{\\ceil{\\frac{t}{2}}-1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\right] \\\\\n    =&\\mathbb{E}\\left[ \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}J_{\\lambda_{k-1}}(\\theta_{k}) - \\frac{1}{\\beta_{k-1}} J_{\\lambda_k}(\\theta_k) + \\frac{1}{\\beta_{k-1}} J_{\\lambda_k}(\\theta_k) - \\frac{1}{\\beta_k}J_{\\lambda_k}(\\theta_k) \\right) \\right] \\\\\n    &+ \\mathbb{E}\\left[\\frac{1}{\\beta_t} J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}} - 1}} J_{\\lambda_{\\ceil{\\frac{t}{2}}- 1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\right]\\\\\n    =& \\mathbb{E}\\left[\\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}(\\lambda_k - \\lambda_{k-1}) \\mathbb{E}_{s\\sim \\mathcal{U}_\\mathcal{S}}\\left[\\text{KL}\\left(\\mathcal{U}_\\mathcal{A}||\\pi_{\\theta_k}(\\cdot |s)\\right)\\right] + \\left(\\frac{1}{\\beta_{k-1}} - \\frac{1}{\\beta_k}\\right) J_{\\lambda_k}(\\theta_k) \\right) \\right]\\\\\n    &+ \\mathbb{E}\\left[\\frac{1}{\\beta_t} J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} J_{\\lambda_{\\ceil{\\frac{t}{2}} - 1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\right]\\\\\n    % \\label{eq j lambda diff decompose}\n    \\leq &\\mathbb{E}\\left[ \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}} - \\frac{1}{\\beta_k}\\right) J_{\\lambda_k}(\\theta_k)  + \\frac{1}{\\beta_t} J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} J_{\\lambda_{\\ceil{\\frac{t}{2}} - 1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\right] \\qq{(Using $\\lambda_k < \\lambda_{k-1}$)}, \\\\\n    \\leq & \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_k} - \\frac{1}{\\beta_{k-1}} \\right) U_{J, \\lambda}  + \\frac{1}{\\beta_t} U_{J, \\lambda} + \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} U_{J, \\lambda} \\qq{\\hfill (Using $\\beta_{k-1} > \\beta_k$ and Lemma~\\ref{lem bound j lambda})} \\\\\n    = & \\frac{U_{J, \\lambda}}{\\beta_t} - \\frac{U_{J, \\lambda}}{\\beta_{\\ceil{\\frac{t}{2}}-1}} + \\frac{1}{\\beta_t} U_{J, \\lambda} + \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} U_{J, \\lambda}  \\\\\n    = & \\frac{2U_{J, \\lambda}}{\\beta} (t+t_0)^{\\epsilon_\\beta}\n\\end{aligned}')
('13.19', "\\begin{aligned}\n    &\\tilde M_{11} \\\\\n    =& \\sum_{s, a} \\left(d_{\\mu_{\\theta_t}}(s) \\pi_{\\theta_t}(a|s) \\nabla \\log \\pi_{\\theta_t}(a|s) \\left(q_{\\pi_{\\theta_t}, \\lambda_t}(s, a) - \\lambda_t \\log \\pi_{\\theta_t}(a|s) \\right)  \\right)^\\top \\nabla \\tilde J_{\\lambda_t}(\\theta_t) \\\\\n    =& \\sum_{s', a'} \\sum_{s, a} \\left(d_{\\mu_{\\theta_t}}(s) \\dv{\\pi_{\\theta_t}(a | s)}{\\theta_{s',a'}} \\left( q_{\\pi_{\\theta_t}, \\lambda_t}(s, a) - \\lambda_t \\log \\pi_{\\theta_t}(a|s) \\right) \\right)  \\dv{\\tilde J_{\\lambda_t}(\\theta_t)}{\\theta_{s',a'}} \\\\\n    =& \\sum_{s', a'} \\left( d_{\\mu_{\\theta_t}}(s') \\pi_{\\theta_t}(a'|s') \\tilde \\text{Adv}_{\\pi_{\\theta_t}}(s', a')  \\right) \\dv{\\tilde J_{\\lambda_t}(\\theta_t)}{\\theta_{s',a'}} \\qq{(Lemma~\\ref{lem softmax policy gradient})} \\\\\n    =& \\sum_{s', a'}  \\frac{(1 - \\gamma) d_{\\mu_{\\theta_t}}(s')}{d_{\\pi_{\\theta_t}, \\gamma}(s')} \\left(\\dv{\\tilde J_{\\lambda_t}(\\theta_t)}{\\theta_{s',a'}}\\right)^2 \\qq{(Lemma~\\ref{lem softmax policy gradient})} \\\\\n    \\geq & \\inf_{\\theta, s} \\frac{(1-\\gamma)d_{\\mu_\\theta}(s)}{d_{\\pi_\\theta, \\gamma}(s)} \\norm{\\nabla \\tilde J_{\\lambda_t}(\\theta_t)}^2.\n\\end{aligned}")
('13.19', 'd_{\\mu_\\theta}')
('13.19', '\\theta')
('13.19', '\\inf')
('13.20', '\\Lambda_1(\\theta, s, \\eta)')
('13.20', '\\begin{aligned}\n    &\\Lambda_1(\\theta, s, \\eta)\\\\\n    =& \\sum_a \\pi_\\theta(a|s) \\nabla \\log \\pi_\\theta(a|s) \\left(\\tilde q_{\\pi_\\theta, \\eta}(s,a) - \\eta \\log \\pi_\\theta (a|s)\\right) \\\\\n    =& \\sum_a \\nabla \\pi_\\theta(a|s) \\tilde q_{\\pi_\\theta, \\eta}(s,a) - \\eta \\sum_a \\nabla \\pi_\\theta(a|s) \\log \\pi_\\theta (a|s) \\\\\n    =& \\sum_a \\nabla \\pi_\\theta(a|s) \\tilde q_{\\pi_\\theta, \\eta}(s,a) - \\eta \\sum_a \\nabla \\pi_\\theta(a|s) \\log \\pi_\\theta (a|s) - \\eta \\nabla \\sum_a \\pi_\\theta(a|s) \\\\\n    =& \\sum_a \\nabla \\pi_\\theta(a|s) \\tilde q_{\\pi_\\theta, \\eta}(s,a) - \\eta \\sum_a \\nabla \\pi_\\theta(a|s) \\log \\pi_\\theta (a|s) - \\eta \\sum_a \\pi_\\theta(a|s) \\nabla \\log \\pi_\\theta(a|s) \\\\\n    =& \\sum_a \\nabla \\pi_\\theta(a|s) \\tilde q_{\\pi_\\theta, \\eta}(s,a) + \\eta \\nabla \\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right).\n  \n\\end{aligned}')
('13.20', '\\tilde v_{\\pi_\\theta, \\eta}(s)')
('13.20', '\\tilde q_{\\pi_\\theta, \\eta}(s, a)')
('13.20', '\\theta')
('13.20', '\\eta')
('13.20', '\\abs{\\tilde v_{\\pi_\\theta, \\eta}(s)}')
('13.20', '\\abs{\\tilde q_{\\pi_\\theta, \\eta}(s, a)}')
('13.20', '\\eta')
('13.20', '\\nabla \\pi_\\theta(a|s)')
('13.20', '\\nabla \\mathbb{H}\\left(\\pi_\\theta(\\cdot | s)\\right)')
('13.20', '\\theta')
('13.20', 'L_{\\Lambda_1}(\\eta)')
('13.20', 'U_{\\Lambda_1}(\\eta)')
('13.20', 's')
('13.20', "\\begin{aligned}\n    \\norm{\\Lambda_1(s, \\theta, \\eta) - \\Lambda_1(s, \\theta', \\eta) } &\\leq L_{\\Lambda_1}(\\eta) \\norm{\\theta -\\theta'}, \\\\\n    \\sup_{\\theta} \\norm{\\Lambda_1(s, \\theta, \\eta)} &\\leq U_{\\Lambda_1}(\\eta).\n  \n\\end{aligned}")
('13.20', '\\bar \\Lambda_1(\\theta, \\eta)')
('13.20', 'd_{\\mu_\\theta}')
('13.20', 'L_{\\bar \\Lambda_1}(\\eta)')
('13.20', 'U_{\\bar \\Lambda_1}(\\eta)')
('13.20', "\\begin{aligned}\n    \\norm{\\bar \\Lambda_1(\\theta, \\eta) - \\bar \\Lambda_1(\\theta', \\eta)} &\\leq L_{\\bar \\Lambda_1}(\\eta) \\norm{\\theta -\\theta'}, \\\\\n    \\sup_{\\theta} \\norm{\\bar \\Lambda_1(\\theta, y, \\eta)} &\\leq U_{\\bar \\Lambda_1}(\\eta).\n  \n\\end{aligned}")
('13.20', "\\Lambda_1'(\\theta, y, \\eta)")
('13.20', '\\tilde J_\\eta(\\theta)')
('13.20', 'L_J + \\eta L_H')
('13.20', 'L_J + \\eta L_H')
('13.20', '\\nabla \\tilde J_\\eta(\\theta)')
('13.20', '\\tilde \\nabla J_\\eta(\\theta)')
('13.20', '\\eta')
('13.20', "L_{\\Lambda_1'}(\\eta)")
('13.20', "U_{\\Lambda_1'}(\\eta)")
('13.20', 'y')
('13.20', "\\begin{aligned}\n    \\norm{\\Lambda_1'(\\theta, y, \\eta) - \\Lambda_1'(\\theta', y, \\eta)} &\\leq L_{\\Lambda_1'}(\\eta) \\norm{\\theta -\\theta'}, \\\\\n    \\sup_\\theta \\norm{\\Lambda_1'(\\theta, y, \\eta)} &\\leq U_{\\Lambda_1'}(\\eta).\n  \n\\end{aligned}")
('13.20', "\\begin{aligned}\n    \\norm{\\mathbb{E}\\left[\\tilde M_{121}\\right]} &= \\norm{\\Lambda_1'(\\theta_t, S_t, \\lambda_t) - \\Lambda_1'(\\theta_{t-\\tau_{\\beta_t}}, S_t, \\lambda_t)} \\\\\n    &\\leq L_{\\Lambda_1'}(\\lambda_t) \\norm{\\theta_t - \\theta_{t-\\tau_{\\beta_t}}} \\\\\n    &\\leq L_{\\Lambda_1'}(\\lambda_t) L_\\theta \\beta_{t-\\tau_{\\beta_t}, t-1} \\qq{(Using \\eqref{eq ltheta sac})}.\n  \n\\end{aligned}")
('13.20', '\\lambda_t \\in [0, \\lambda]')
('13.20', "L_{\\Lambda_1'}(\\eta)")
('13.20', '[0, \\lambda]')
('13.20', "L_{\\Lambda_1'}(\\eta)")
('13.20', '[0, \\lambda]')
('13.20', "L_{\\Lambda_1'}^*")
('13.20', "\\begin{aligned}\n    \\norm{\\mathbb{E}\\left[M_{121}\\right]} \\leq L_{\\Lambda_1'}^* L_\\theta \\beta_{t-\\tau_{\\beta_t}, t-1},\n  \n\\end{aligned}")
('13.21', '\\begin{aligned}\n    &\\sum_{k=\\ceil{\\frac{t}{2}}}^t \\left(\\frac{1}{\\beta_k}\\tilde J_{\\lambda_k}(\\theta_{k+1}) - \\frac{1}{\\beta_k}\\tilde J_{\\lambda_k}(\\theta_k) \\right) \\\\\n    =& \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}\\tilde J_{\\lambda_{k-1}}(\\theta_k) - \\frac{1}{\\beta_k}\\tilde J_{\\lambda_k}(\\theta_k) \\right) + \\frac{1}{\\beta_t} \\tilde J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} \\tilde J_{\\lambda_{\\ceil{\\frac{t}{2}}-1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\\\\n    =& \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}\\tilde J_{\\lambda_{k-1}}(\\theta_{k}) - \\frac{1}{\\beta_{k-1}} \\tilde J_{\\lambda_k}(\\theta_k) + \\frac{1}{\\beta_{k-1}} \\tilde J_{\\lambda_k}(\\theta_k) - \\frac{1}{\\beta_k}\\tilde J_{\\lambda_k}(\\theta_k) \\right) \\\\\n    &+ \\frac{1}{\\beta_t} \\tilde J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}} - 1}} \\tilde J_{\\lambda_{\\ceil{\\frac{t}{2}}- 1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\\\\n    =& \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}(\\lambda_{k-1} - \\lambda_{k}) \\frac{\\sum_s d_{\\pi_{\\theta_k}, \\gamma}(s) \\mathbb{H}\\left(\\pi_{\\theta_k}(\\cdot |s)\\right)}{1 - \\gamma}  + \\left(\\frac{1}{\\beta_{k-1}} - \\frac{1}{\\beta_k}\\right) \\tilde J_{\\lambda_k}(\\theta_k) \\right) \\\\\n    &+ \\frac{1}{\\beta_t} \\tilde J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} \\tilde J_{\\lambda_{\\ceil{\\frac{t}{2}} - 1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\\\\n    \\leq& \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_{k-1}}\\left(\\frac{\\lambda}{(k+t_0-1)^{\\epsilon_\\lambda}} - \\frac{\\lambda}{(k+t_0)^{\\epsilon_\\lambda}}\\right) \\frac{\\log {|\\mathcal{A}|}}{1-\\gamma} + \\left(\\frac{1}{\\beta_{k-1}} - \\frac{1}{\\beta_k}\\right) \\tilde J_{\\lambda_k}(\\theta_k) \\right) \\\\\n    &+ \\frac{1}{\\beta_t} \\tilde J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} \\tilde J_{\\lambda_{\\ceil{\\frac{t}{2}} - 1}}(\\theta_{\\ceil{\\frac{t}{2}}}) \\\\\n    \\overset{(i)}{\\leq} & \\sum_{k=\\ceil{\\frac{t}{2}}}^t \\left(\\frac{1}{\\beta_{k-1}(k-1+t_0)^{1+\\epsilon_\\lambda}} \\frac{\\lambda \\log {|\\mathcal{A}|}}{1-\\gamma} +  \\left(\\frac{1}{\\beta_{k-1}} - \\frac{1}{\\beta_k}\\right) \\tilde J_{\\lambda_k}(\\theta_k) \\right) \\\\\n    &+ \\frac{1}{\\beta_t} \\tilde J_{\\lambda_t}(\\theta_{t+1}) - \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} \\tilde J_{\\lambda_{\\ceil{\\frac{t}{2}} - 1}}(\\theta_{\\ceil{\\frac{t}{2}}}), \\\\\n    \\overset{(ii)}{\\leq} & \\frac{3\\lambda\\beta \\log {|\\mathcal{A}|}}{1-\\gamma} + \\sum_{k=\\ceil{\\frac{t}{2}}}^t\\left(\\frac{1}{\\beta_k} - \\frac{1}{\\beta_{k-1}} \\right) U_{\\tilde J}  + \\frac{1}{\\beta_t} U_{\\tilde J} + \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} U_{\\tilde J} \\\\\n    = & \\frac{3\\lambda\\beta \\log {|\\mathcal{A}|}}{1-\\gamma} + \\frac{U_{\\tilde J}}{\\beta_t} - \\frac{U_{\\tilde J}}{\\beta_{\\ceil{\\frac{t}{2}}-1}} + \\frac{1}{\\beta_t} U_{\\tilde J} + \\frac{1}{\\beta_{\\ceil{\\frac{t}{2}}-1}} U_{\\tilde J}  \\\\\n    = &\\frac{3\\lambda\\beta \\log {|\\mathcal{A}|}}{1-\\gamma} + \\frac{2U_{\\tilde J}}{\\beta} (t+t_0)^{\\epsilon_\\beta},\n\\end{aligned}')
('13.21', '(i)')
('13.21', '\\begin{aligned}\n  \\frac{1}{(t-1)^x} - \\frac{1}{t^x} &= \\frac{t^x - (t-1)^x}{(t-1)^x t^x} = \\frac{t^x(t-1)^{1-x} - (t-1)}{(t-1)t^x} \\\\\n  &\\leq \\frac{t^x t^{1-x} - (t-1)}{(t-1)(t-1)^x} = \\frac{1}{(t-1)^{1+x}}\n\\end{aligned}')
('13.21', '(ii)')
('13.21', '\\begin{aligned}\n  \\sum_{t=1}^\\infty \\frac{1}{t^{1+\\epsilon_\\lambda + \\epsilon_\\beta}} \\leq \\sum_{t=1}^\\infty \\frac{1}{t^{1.5}} < 3.\n\\end{aligned}')
