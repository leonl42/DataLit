('2.0', 'N')
('2.0', 'i')
('2.0', 'A^i = \\mathrm{softmax}\\left( (x W_Q^i) (x W_K^i)^T / \\sqrt{d_k} \\right) \\in \\mathbb{R}^{N \\times N}')
('2.0', 'x \\in \\mathbb{R}^{N \\times d}')
('2.0', 'W_Q^i, W_K^i \\in \\mathbb{R}^{d \\times d_k}')
('2.0', '(x W_K^i)')
('2.0', '(x W_Q^i)')
('2.0', 'H')
('2.0', '\\mathrm{MHA}(x) = \\mathrm{Concat} \\left[ A^1 (x W_V^1), \\dots, A^H (x W_V^H) \\right] W_O')
('2.0', 'W_V^i \\in \\mathbb{R}^{d \\times d_v}')
('2.0', 'W_O \\in \\mathbb{R}^{H d_v \\times d}')
('2.0', '(x W_V^i)')
('2.0', '\\mathrm{MLP}(x) =  \\sigma(x W_{1}) W_2')
('2.0', 'W_1 \\in \\mathbb{R}^{d \\times h}')
('2.0', 'W_2 \\in \\mathbb{R}^{h \\times d}')
('2.0', '\\sigma')
('2.0', '{W_{QK}}')
('2.0', '{W_{OV}}')
('2.0', '{W_{QK}}^i = W_Q^i (W_K^i)^T / \\sqrt{d_k} \\in \\mathbb{R}^{d \\times d}')
('2.0', '{W_{OV}}^i = W_V^i W_O^i \\in \\mathbb{R}^{d \\times d}')
('2.0', 'W_O')
('2.0', 'W_O = [ W_O^1, \\dots W_O^H ]')
('2.0', 'W_O^i \\in \\mathbb{R}^{d_v \\times d}')
('2.0', 'A^i = \\mathrm{softmax}\\left( x {W_{QK}}^i x^T \\right) \\hspace*{1.5cm} \\mathrm{MHA}(x) = \\sum_{i=1}^H A^i x {W_{OV}}^i')
('2.0', 'H')
('2.0', '{W_{QK}}')
('2.0', '{W_{OV}}')
('2.0', '{W_{QK}}')
('2.0', '{W_{OV}}')
('2.1', '= [ \\mathrm{h}, \\mathrm{e}, \\mathrm{l}, \\mathrm{l}, \\mathrm{o}]')
('2.1', '= [ 0, 1, 2, 3, 4 ]')
('2.1', '= [0, 3, 6, 9, 12]')
('2.1', 'N')
('2.1', 'N \\times N')
('2.1', 'p(x, y)')
('2.1', 'p(x, y) = x < y')
('2.1', 'x')
('2.1', 'y')
('2.1', '[1, 0, 2]')
('3', '\\{"\\mathrm{x}", "\\mathrm{y}"\\}')
('3', '3')
('3', '{W_{QK}}')
('3', '{W_{OV}}')
('3', '{W_{QK}}')
('3', '{W_{OV}}')
('3', 'W_q')
('3', 'W_k')
('3', 'W_o')
('3', 'W_v')
('4.0', '1')
('4.1', '1')
('5.0', 'W \\in \\mathbb{R}^{D \\times d}')
('5.0', 'D')
('5.0', 'd < D')
('5.0', 'W^T')
('5.0', 'W')
('5.0', 'W')
('5.0', 'W')
('5.0', '\\mathbb{E}_x[\\mathcal{L}_\\mathrm{out}(W, x) + \\mathcal{L}_\\mathrm{layer}(W, x)]')
('5.0', '\\begin{aligned}\n\\mathcal{L}_\\mathrm{out} = \\mathrm{loss}(f(x), \\hat{f}_W(x)); ~~\n\\mathcal{L}_\\mathrm{layer} = \\sum_{\\text{layer }i} (h_i(x) - \\hat{h}_{W, i}(x))^2\n\\end{aligned}')
('5.0', 'f(x)')
('5.0', 'x')
('5.0', '\\hat{f}_W(x)')
('5.0', 'h_i(x)')
('5.0', '\\hat{h}_{W, i}(x)')
('5.0', 'i')
('5.0', 'W \\in \\mathbb{R}^{D \\times d}')
('5.0', 'D')
('5.0', 'd \\leq D')
('5.0', 'W')
('5.0', '\\mathcal{L}_\\mathrm{out}')
('5.0', '\\mathcal{L}_\\mathrm{layer}')
('5.0', 'W')
('5.0', 'W')
('5.0', 'd')
('5.0', 'd')
('5.0', 'd=6')
('5.0', 'D=14')
('5.0', 'W^T W')
('5.0', 'd=8')
('5.0', 'W')
('5.0', '8')
('5.0', 'W')
('5.1', 'W')
('5.1', 'D=14')
('5.1', 'd=6')
('5.1', 'd')
('5.1', 'W')
('5.1', 'D')
('5.1', 'd < D')
('5.1', 'W^T W')
('5.1', 'd=8')
('5.2', '1')
('5.2', '1')
('5.2', '100\\%')
('5.2', '0.8')
('5.2', '1')
('10.0', 'L')
('10.1', '{W_{QK}}')
('10.1', '{W_{OV}}')
('11', '\\texttt{A}')
('11', '\\texttt{B}')
('11', '\\texttt{C}')
('11', '\\texttt{D}')
('11', '\\texttt{A}')
('11', '\\texttt{B}')
('11', '\\texttt{C}')
('11', '\\texttt{D}')
('12', '5 \\times 14')
('12', '1')
('12', '1')
('12', '1')
('12', '1')
('13.0', '\\tilde W_{QK}')
('13.0', 'W_{BOS}=\\beta_{BOS}x_{\\texttt{one}}x_{\\texttt{tokens:bos}}^\\intercal')
('13.0', '\\beta_{BOS}=1')
('13.0', '\\beta_{BOS}=\\frac{1}{2}')
('13.0', 'x_{\\texttt{one}}')
('13.0', 'x_{\\texttt{tokens:bos}}')
('13.0', 'T^{-1}')
('13.0', '{W_{QK}}=T^{-1}(\\tilde W_{QK} + W_{BOS})')
('13.0', "A_{ij}=\\operatorname{softmax}\\left(\\mathbf q_i^\\intercal{W_{QK}}\\vec\\mathbf k\\right)_j=\\exp(\\mathbf q_i^\\intercal{W_{QK}}\\mathbf k_j) / \\sum_{j'}\\exp(\\mathbf q_i^\\intercal{W_{QK}}\\mathbf k_{j'})")
('13.0', '1/\\#\\{\\text{selected tokens}\\}')
('13.0', '{W_{OV}}')
('13.1', '1')
('13.1', 'x = 1/(1+w)')
('13.1', 'w')
('13.1', 'w = 1/x-1')
('14', 'W')
('14', '0.1')
('14', '\\beta_1=0.9, \\beta_2=0.99')
('14', '3 \\times 10^5')
('14', '256')
('14', '10^{-3}')
('14', '10^{-6}')
('15', '{W_{QK}}')
('15', '\\tilde W_{QK}')
('15', '\\tilde W_{QK}^{{\\color{dmpurple400}\\tt not}}=-\\tilde W_{QK}')
('15', '\\beta_{BOS}^{{\\color{dmpurple400}\\tt not}}')
('15', '-\\frac{1}{2}')
('15', '\\tilde W^A_{QK},W^B_{QK}')
('15', '\\tilde W^{{\\color{dmpurple400}\\tt and}}_{QK}=\\tilde W^A_{QK} + \\tilde W^B_{QK}')
('15', '\\beta^{{\\color{dmpurple400}\\tt and}}_{BOS}')
('15', '\\frac{3}{2}')
('15', 'W^{{\\color{dmpurple400}\\tt and}}_{QK}=T^{-1}(\\tilde W^{{\\color{dmpurple400}\\tt and}}_{QK} + W^{{\\color{dmpurple400}\\tt and}}_{BOS})')
('15', '\\tilde W_{QK}^{{\\color{dmpurple400}\\tt nor}}=-\\tilde W^A_{QK}-\\tilde W^B_{QK}')
('15', '\\beta^{{\\color{dmpurple400}\\tt and}}_{BOS}')
('15', '-\\frac{1}{2}')
('15', '\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}=-(-\\tilde W^A_{QK}-\\tilde W^B_{QK})')
('15', 'T^{-1}\\gg 1')
('15', '\\tilde W^A_{QK}')
('15', '\\tilde W^B_{QK}')
('15', 'Q_A')
('15', 'K_A')
('15', 'Q_B')
('15', 'K_B')
('15', '\\tilde W^{{\\color{dmpurple400}\\tt or}}_{QK}')
('15', 'Q_A+Q_B')
('15', 'R_A+R_B')
('15', '\\beta^{{\\color{dmpurple400}\\tt or}}_{BOS}')
('15', 'T\\rightarrow 0')
('15', 'B')
('15', '\\mathbf q_B^0,\\mathbf q_B^1\\in Q_B')
('15', '\\mathbf k_B^0,\\mathbf k_B^1\\in K_B')
('15', '{\\mathbf q_B^0}^\\intercal \\tilde W^B_{QK}\\mathbf k_B^0=0')
('15', '{\\mathbf q_B^1}^\\intercal \\tilde W^B_{QK}\\mathbf k_B^1=1')
('15', '\\mathbf q_A\\in Q_A')
('15', "\\mathbf k_A,\\mathbf k'_A\\in K_A")
('15', '\\mathbf q_A+\\mathbf q_B^1')
('15', '\\mathbf k_A+\\mathbf k_B^1')
('15', "\\mathbf k'_A+\\mathbf k_B^1")
('15', "(\\mathbf q_A+\\mathbf q_B^1)^\\intercal \\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}(\\mathbf k_A+\\mathbf k_B^1)=(\\mathbf q_A+\\mathbf q_B^1)^\\intercal \\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}(\\mathbf k'_A+\\mathbf k_B^1)")
('15', "\\mathbf q_A^\\intercal \\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}\\mathbf k_A = \\mathbf q_A^\\intercal \\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}\\mathbf k'_A")
('15', '\\mathbf k=\\mathbf k_A+\\mathbf k_B^0')
('15', "\\mathbf k'=\\mathbf k'_A+\\mathbf k_B^0")
('15', '\\mathbf q=\\mathbf q_A+\\mathbf q_B^0')
('15', "\\mathbf q_A'\\in Q_A")
('15', "\\mathbf q'=\\mathbf q'_A+\\mathbf q_B^0")
('15', "\\mathbf q^\\intercal\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}\\mathbf k'-\\mathbf q^\\intercal\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}\\mathbf k={\\mathbf q_B^0}^\\intercal\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}(\\mathbf k'-\\mathbf k)=\\mathbf q'^\\intercal\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}\\mathbf k'-\\mathbf q'^\\intercal\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}\\mathbf k")
('15', '\\mathbf k_B^0')
('15', '\\mathbf k_B^0')
('15', "\\mathbf q'")
('15', '\\mathbf q')
('15', '\\mathbf k_B^0')
('15', '\\mathbf k_B^0')
('15', '\\mathbf q_A')
('15', "\\mathbf q'_A")
('15', '\\tilde W_{QK}^{{\\color{dmpurple400}\\tt or}}')
('15', '\\mathbf q_A,\\mathbf k_A,\\mathbf q_B,\\mathbf k_B')
('16', 'n')
