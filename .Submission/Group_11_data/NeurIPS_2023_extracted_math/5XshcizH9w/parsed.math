('1', '\\tau')
('1', '\\tau')
('1', '\\tau')
('1', '\\phi')
('1', '\\phi')
('1', '\\phi')
('1', '\\phi')
('1', '\\phi')
('2', '\\phi')
('2', 'X')
('2', 'Y')
('3', '\\tau')
('3', 'X,Y')
('3', '\\mathcal{A}')
('3', 'x')
('3', 'P_X')
('3', '(x,y^+)\\sim P_{Y|X}')
('3', '(x,y)\\sim P_Y')
('3', 'g_{\\theta}: \\mathcal{A} \\rightarrow \\mathbb{R}^d')
('3', 'x, y, y^+')
('3', 'f(g_{\\theta}(x),g_{\\theta}(y))')
('3', 'x')
('3', 'y')
('3', 'f(g_{\\theta}(x),g_{\\theta}(y^+))\\uparrow')
('3', '(x,y^+)\\sim P_{XY}')
('3', 'f(g_{\\theta}(x),g_{\\theta}(y))\\downarrow')
('3', '(x,y)\\sim P_XP_Y')
('3', 'P_{Y|X}')
('3', 'P_0')
('3', 'P_Y')
('3', 'Q_0')
('3', '\\mathcal{L}_{\\text{InfoNCE}}')
('3', '\\mathbb{E}_{P_0} [e^{{f\\theta (x,y^+) / \\tau}} ]')
('3', '\\mathcal{L}_{\\text{InfoNCE}} = - \\mathbb{E}_{P_X} \\big[ \\mathbb{E}_{P_0} [{f_\\theta (x,y^+) / \\tau}] - \\log {\\mathbb{E}_{Q_0}[ e^{f_\\theta(x,y) / \\tau} ]} \\big] =\n      - \\mathbb{E}_{P_X} \\mathbb{E}_{P_0} \\big [ \\log \\frac{e^{f_\\theta(x,y^+) / \\tau}}{\\mathbb{E}_{Q_0}[ e^{f_\\theta(x,y) / \\tau} ]} \\big].\n   \\label{infonce_loss}')
('3.0', '(y)')
('3.0', '\\tau')
('3.0', '\\tau^*')
('3.0', '\\tau_0')
('3.0', '\\tau')
('3.0', '\\tau')
('3.1', 'Q')
('3.1', 'Q_0')
('3.1', '\\mathcal{D}{\\phi}')
('3.1', '\\eta')
('3.1', '\\begin{aligned}\n   \\mathcal{L}_{\\text{DRO}}=\\operatorname*{max}_{{Q} }  \\mathbb{E}_Q [\\mathcal{L}(x;\\theta)] \\qquad \\emph{s.t. }D_{\\phi}({Q}||{Q}_0) \\leq \\eta,\n\\end{aligned}')
('3.1', 'D_{\\phi}({Q}||{Q}_0)')
('3.1', '\\phi')
('3.1', '\\mathcal{L}(x;\\theta)')
('3.1', 'x')
('3.1', '{Q}')
('3.1', 'P_0')
('3.1', 'Q_0')
('3.1', '\\eta')
('3.1', '\\label{cl_dro}\n   \\mathcal{L}_{\\text{CL-DRO}}^{\\phi} = -\\mathbb{E}_{P_X} \\big[ \\mathbb{E}_{P_0}[f_\\theta(x,y^+)] - \\operatorname*{max}_{Q}  \\mathbb{E}_{Q}[f_\\theta(x,y)] \\big] \\qquad \\emph{s.t. }D_{\\phi}({Q}||{Q}_0) \\leq \\eta .')
('3.1', 'L_{\\text{basic}} = - \\mathbb{E}_{P_X} \\big[ \\mathbb{E}_{P_0}[f_\\theta(x,y^+)] - \\mathbb{E}_{Q_0}[f_\\theta(x,y)] \\big ]')
('3.1', 'L_{\\text{basic}}')
('3.1', 'f_\\theta(x,y)')
('3.1', 'D_{KL}(Q||Q_0)=\\int Q \\log\\frac{Q}{Q_0} dx')
('3.1', '\\label{eq_dro}\n           \\begin{aligned}\n              \\mathcal{L}_{\\text{CL-DRO}}^{\\text{KL}} & = \\! - \\mathbb{E}_{P_X} \\big[\\mathbb{E}_{P_0}[f_\\theta(x,y^+)] - \\! \\operatorname*{min}_{\\alpha\\geq 0, \\beta} \\operatorname*{max}_{Q\\in \\mathbb{Q}} \\{ \\mathbb{E}_{Q}[f_\\theta(x,y)] -  \\alpha [D_{KL}(Q||Q_0) -\\eta] + \\beta (\\mathbb{E}_{Q_0} [\\frac{Q}{Q_0}]  - 1) \\} \\big ]\\\\\n               &= \\!- \\mathbb{E}_{P_X} \\mathbb{E}_{P_0} \\big [\\alpha^*(\\eta) \\log \\frac{e^{f_\\theta(x,y^+) / \\alpha^*(\\eta)}}{ \\mathbb{E}_{Q_0}[ e^{f_\\theta (x,y)/ \\alpha^*(\\eta)} ]} \\big] +Constant\\\\\n               &=\\alpha^*(\\eta)\\mathcal{{L}}_{\\text{InfoNCE}}+ Constant,\n           \\end{aligned}')
('3.1', '\\alpha, \\beta')
('3.1', '\\alpha^*(\\eta)')
('3.1', '\\alpha')
('3.1', '\\tau')
('3.1', 'L_{\\text{unbiased}}= - \\mathbb{E}_{P_X} \\big[\\mathbb{E}_{P_0}[f_\\theta(x,y^+)] - \\mathbb{E}_{Q^\\text{ideal}}[f_\\theta(x,y)]\\big]')
('3.1', '\\mathcal{\\widehat{L} }_{\\text{InfoNCE}}')
('3.1', 'N')
('3.1', '\\mathbb{F}')
('3.1', 'f_\\theta \\in [M_1,M_2]')
('3.1', 'Q^{\\text{ideal}}')
('3.1', 'D_{KL}(Q^{\\text{ideal}}||Q_0)\\leq \\eta')
('3.1', '1-\\rho')
('3.1', '\\mathcal{L}_{\\text{unbiased}} \\leq  \\tau \\mathcal{\\widehat{L}}_{\\text{InfoNCE}} + \\mathcal{B}(\\rho, N, \\tau),')
('3.1', '\\mathcal{B}(\\rho, N, \\tau) = \\frac{M_2\\exp \\left(({M_2-M_1})/{\\tau}\\right)}{N-1+\\exp \\left(({M_2-M_1})/{\\tau}\\right)} \\sqrt{\\frac{N}{2} \\ln(\\frac{2|\\mathbb{F}|}{\\rho})}')
('3.1', '\\mathcal{B}(\\rho, N, \\tau) \\to 0')
('3.1', 'N\\to 0')
('3.1', '\\tau')
('3.2', '\\tau')
('3.2', '\\tau')
('3.2', '\\eta')
('3.2', '\\alpha')
('3.2', '\\alpha')
('3.2', '\\tau')
('3.2', '\\begin{aligned}\n       \\label{eta_}\n         \\tau \\approx \\sqrt{{\\mathbb{V}_{Q_0}[f_\\theta(x,y)]}/{2\\eta}},\n     \n\\end{aligned}')
('3.2', '\\mathbb{V}_{Q_0}[f_\\theta(x,y)]')
('3.2', 'f_\\theta(x,y)')
('3.2', '{Q}_0')
('3.2', '\\tau')
('3.2', '\\eta')
('3.2', 'f_\\theta')
('3.2', '\\tau')
('3.2', '\\eta')
('3.2', '\\tau')
('3.2', '\\eta')
('3.2', 'D_{KL}(Q^{\\text{ideal}}||Q_0)\\leq \\eta')
('3.2', '\\tau')
('3.2', '\\tau')
('3.2', 'D_{KL}(Q^{\\text{ideal}}||Q_0)\\leq \\eta')
('3.2', '\\mathcal{B}(\\rho, N, \\tau)')
('3.2', '\\tau')
('3.2', '\\phi')
('3.2', '\\label{eq_phi}\n         \\begin{aligned}\n            \\mathcal{L}_{\\text{CL-DRO}}^{\\phi} \\approx - \\mathbb{E}_{P_X} \\big[ \\mathbb{E}_{P_0} [f_\\theta(x,y^+)] - \\big(\\mathbb{E}_{Q_0} [f_\\theta(x,y)] + \\frac{1}{2\\tau} {{\\frac{1}{\\phi^{(2)}(1)}} \\cdot \\mathbb{V}_{Q_0} [f_\\theta(x,y)] } \\big) \\big],\n         \\end{aligned}')
('3.2', '\\phi^{(2)}(1)')
('3.2', '\\phi(\\cdot)')
('3.2', '\\mathbb{V}_{Q_0} [f_\\theta]')
('3.2', 'f')
('3.2', 'Q_0')
('3.2', '\\label{eq_mw_kl}\n      \\mathcal{L}_{\\text{CL-DRO}}^{\\text{KL}} \\approx - \\mathbb{E}_{P_X} \\big[ \\mathbb{E}_{P_0} [f_\\theta(x,y^+)] - \\big(\\mathbb{E}_{Q_0} [f_\\theta(x,y)] + \\frac{1}{2\\tau} \\mathbb{V}_{Q_0} [f_\\theta(x,y)] \\big) \\big ].')
('3.2', 'L_{\\text{basic}}')
('3.2', '\\tau')
('3.2', 'Q^* = Q_0  \\frac{\\exp[{f_\\theta(x,y^+) /\\tau}]}{\\mathbb{E}_{Q_0} \\exp[{f_\\theta(x,y)/\\tau}]}')
('3.2', 'Q^*')
('3.2', '\\frac{\\exp[{f_\\theta(x,y^+)/\\tau}]}{\\mathbb{E}_{Q_0} \\exp[{f_\\theta(x,y)/\\tau}]}')
('3.2', '\\tau')
('3.2', '\\tau')
('3.2', '\\tau')
('3.3', '\\tau')
('3.3', '\\tau')
('3.3', '1')
('3.3', '0')
('3.3', '\\tau')
('3.3', '\\tau')
('3.3', 'r')
('3.3', '\\tau')
('3.3', '\\eta')
('3.3', 'D_{KL}(Q^{\\text{ideal}}||Q_0)\\leq \\eta')
('3.3', '\\tau')
('3.3', '\\tau')
('3.3', '\\tau')
('3.3', 'f_\\theta(x,y)')
('3.3', 'f_\\theta(x,y^+)')
('3.3', '\\tau')
('3.3', '\\tau')
('3.3', '\\tau')
('4', '\\phi')
('4', '\\phi')
('4', '\\phi')
('4', '\\phi')
('4', 'I_{\\phi}(X;Y) = D_{\\phi}(P(X,Y)||P(X)P(Y)) =  \\mathbb{E}_{P_X} [D_{\\phi}(P_0||Q_0) ] .')
('4', '\\phi')
('4', '\\phi')
('4', 'P')
('4', 'Q')
('4', 'P \\ll Q')
('4', '\\mathcal{F}')
('4', 'P')
('4', 'Q')
('4', '\\mathcal{L}_{\\text{CL-DRO}}^{\\phi}(P,Q)')
('4', '\\phi')
('4', '\\label{eq_tighter_vr}\n      \\begin{aligned}\n         D_{\\phi}(P||Q) & = \\operatorname*{max}_{{f}\\in \\mathcal{F}} -\\mathcal{L}_{\\text{CL-DRO}}^{\\phi}(P,Q)= \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\lambda \\in \\mathbb{R}} \\{ \\lambda + \\mathbb{E}_{Q} [\\phi^*(f-\\lambda)] \\} .\n      \\end{aligned}')
('4', '\\phi')
('4', 'D_{\\phi}(P||Q)')
('4', '\\phi^*')
('4', '\\phi')
('4', 'P')
('4', 'P_0')
('4', 'Q')
('4', 'Q_0')
('4', 'f_\\theta')
('4', '\\mathbb{E}_{P_X} [D_{\\phi}(P_0||Q_0) ]')
('4', 'I_{\\phi}(X;Y)')
('4', '\\phi')
('4', 'I_{DV}')
('4', 'D_{\\phi}(P||Q) \\coloneqq \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\{ \\mathbb{E}_P [f ] -  \\mathbb{E}_Q [\\phi^*(f)] \\}')
('4', '\\mathbb{R}')
('4', '\\mathbb{E}_P[1]=1')
('4', 'D_{\\phi}(P||Q)   \\coloneqq \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\{ \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\lambda \\in \\mathbb{R}} \\{ \\lambda + \\mathbb{E}_{Q} [\\phi^*(f-\\lambda)] \\}\\}')
('4', '\\lambda')
('4', '\\phi(x)=x\\log x - x + 1')
('4', '\\phi^*(x)=e^x-1')
('4', '\\operatorname*{min}_{\\lambda \\in \\mathbb{R}}\\{ \\lambda + \\tau \\mathbb{E}_Q [\\phi^*(\\frac{f(x,y)-\\lambda}{\\tau})] \\}')
('4', '\\lambda')
('4', '\\lambda^*= \\tau \\log \\mathbb{E}_{Q_0} [e^{f(x,y)/\\tau}]')
('4', '\\lambda^*')
('4', 'D_{\\phi}(P_0||Q_0)')
('4', '\\operatorname{max}_{{f}} \\{ \\mathbb{E}_{P_0} [f(x,y^+)] - \\tau \\log \\mathbb{E}_{Q_0} [e^{f(x,y)/\\tau}] \\}')
('4', '\\mathcal{I}_{DV}')
('4', '\\phi')
('4', '\\chi^2')
('4', '\\phi(x)=\\frac{1}{2\\sqrt{2}}(x-1)^2')
('4', '\\phi^*(x)=x+x^2')
('4', 'I_{\\tt{\\chi^2}}(X;Y)=D_{\\tt{\\chi^2}}(P_0\\,\\|\\,Q_0) = \\max_{f}~ \\{\\mathbb{E}_{P_0}[f(x,y^+)] - \\mathbb{E}_{Q_0}[f(x,y)]-\\mathbb{V}_{Q_0}[f(x,y)] \\}')
('4', '\\mathbb{V}_{Q_0}[f(x,y)]')
('4', 'f')
('4', 'Q')
('4', '\\phi')
('5.0', '\\exp[{f_\\theta(x,y)/\\tau}]')
('5.1', 'w(f_\\theta(x,y),\\mu,\\sigma)\\propto \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp[{-\\frac{1}{2}(\\frac{f_\\theta(x,y)- \\mu}{\\sigma})^2}],')
('5.1', '\\mu')
('5.1', '\\sigma')
('5.1', '\\mu')
('5.1', '\\mu')
('5.1', '\\sigma')
('5.1', '\\sigma')
('5.1', '\\mathcal{L}_{\\text{ADNCE}} = -\\mathbb{E}_{P} [f_\\theta(x,y^+)/\\tau] + \\log \\mathbb{E}_{Q_0} [ w(f_\\theta(x,y),\\mu,\\sigma) e^{f_\\theta(x,y)/\\tau}/ Z_{\\mu, \\sigma}],')
('5.1', 'Z_{\\mu, \\sigma}')
('5.1', 'w(f(x,y),\\mu,\\sigma)')
('5.1', 'Z_{\\mu, \\sigma}=\\mathbb{E}_{Q_0} [ w(f_\\theta(x,y),\\mu,\\sigma)]')
('6', '\\mu')
('6', '\\sigma')
('6', '1')
('6.0', '\\tau_0)')
('6.0', '\\tau')
('6.0', '\\tau^{*}')
('6.0', '\\tau')
('6.0', '\\alpha')
('6.0', '\\tau')
('6.0', '\\alpha')
('6.0', '\\tau')
('6.0', '\\tau')
('6.0', '\\tau_0')
('6.0', '\\tau^{*}')
('6.0', '\\alpha')
('6.1', '7')
('6.1', '\\tau^*')
('6.1', '\\tau_0')
('6.2', '\\tau^{*}')
('6.2', '\\tau^{*}')
('6.2', '\\tau_0')
('7', '\\tau')
('8.0', 'f_\\theta(x,y)')
('8.0', 'f_\\theta')
('8.0', '\\mathbb{E}_{P_X}')
('8.0', '\\phi')
('8.0', '\\phi')
('8.0', '\\phi(1)=0')
('8.0', '\\phi')
('8.0', 'Q')
('8.0', 'Q_0')
('8.0', 'D_{\\phi}(Q||Q_0) \\coloneqq \\mathbb{E}_{Q_0}[\\phi(dQ/dQ_0)]')
('8.0', 'D_{\\phi}(Q||Q_0)=\\infty')
('8.0', 'Q')
('8.0', 'Q_0')
('8.0', '\\phi(x)=x\\log x - x + 1')
('8.0', '\\phi')
('8.0', '(A, B)')
('8.0', '\\langle \\cdot, \\cdot \\rangle \\to \\mathbb{R}')
('8.0', '(A, B, \\langle \\cdot, \\cdot \\rangle)')
('8.0', 'f: \\mathbb{R} \\to \\mathbb{R}')
('8.0', 'dom f\\coloneqq \\{ x \\in \\mathbb{R}: f(x)<\\infty \\}')
('8.0', 'f')
('8.0', 'f:A\\to \\mathbb{R}')
('8.0', 'f^*:B\\to \\mathbb{R}')
('8.0', 'f^*(b) = \\sup_{a}\\{ab - f(a)\\}, \\quad b \\in B')
('8.0', '(\\Omega,\\mathcal{F})')
('8.0', '\\sigma')
('8.0', '\\mathcal{F}')
('8.0', 'L^p(\\Omega, \\mathcal{F}, P)')
('8.0', 'f:\\Omega\\to \\mathbb{R}')
('8.0', '||f||_p < \\infty')
('8.0', '\\mathcal{X} \\coloneqq L^p(\\Omega, \\mathcal{F}, P)')
('8.0', 'p\\in[1, +\\infty]')
('8.0', 'g:\\mathbb{R}\\times \\Omega \\to \\mathbb{R}')
('8.0', '\\mathcal{X}')
('8.0', '\\operatorname*{min}_{x\\in \\mathcal{X}} \\int_{\\Omega}  g(x(\\omega ), \\omega)\\,dP(\\omega) = \\int_{\\Omega} \\operatorname*{min}_{s \\in \\mathbb{R} }  g(s,\\omega)\\,dP(\\omega)')
('8.0', 'L(x,y)=Q(x,y)/Q_0(x,y)')
('8.0', '\\phi')
('8.0', 'Q')
('8.0', 'Q_0')
('8.0', 'L(.)')
('8.0', 'L(x,y)')
('8.0', 'L')
('8.0', '\\phi')
('8.0', '\\mathcal{L}_{\\text{CL-DRO}}^{\\phi} = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{max}_{L}  \\mathbb{E}_{Q_0}[f_\\theta L] \\qquad \\emph{s.t. }\\mathbb{E}_{Q_0}[{\\phi}(L)] \\leq \\eta')
('8.0', '\\mathbb{E}_{Q_0}[f_\\theta L]')
('8.0', '\\mathbb{E}_{Q_0}[{\\phi}(L)]')
('8.0', 'L')
('8.0', '\\begin{aligned}\n            \\mathcal{L}_{\\text{CL-DRO}}^{\\phi} & =  - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta} \\operatorname*{max}_{L} \\{ \\mathbb{E}_{Q_0}[f_\\theta L] -  \\alpha [ \\mathbb{E}_{Q_0}[{\\phi}(L)] -\\eta] + \\beta (\\mathbb{E}_{Q_0} [L]  - 1) \\}\\\\\n            & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta - \\beta + \\alpha \\operatorname*{max}_{L} \\{ \\mathbb{E}_{Q_0}[\\frac{f_\\theta  + \\beta}{\\alpha} L - \\phi(L)]  \\} \\big \\}\\\\\n            & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q_0}[\\operatorname*{max}_{L} \\{ \\frac{f_\\theta + \\beta}{\\alpha} L  - \\phi(L) \\}]   \\big \\}\\\\\n            & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q_0}[\\phi^* ( \\frac{f_\\theta + \\beta}{\\alpha} ) ]   \\big \\}\\\\\n        \\end{aligned}\n        \\label{kl_dro_appendix_1}')
('8.0', 'L')
('8.0', '\\phi_{KL}(x)=x\\log x - x + 1')
('8.0', '\\phi_{KL}^*(x)=e^x-1')
('8.0', '\\begin{aligned}\n            \\mathcal{L}_{\\text{CL-DRO}}^{KL} & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n                \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q_0}[\\phi^* ( \\frac{f_\\theta  + \\beta}{\\alpha} ) ]   \\big \\}\\\\\n                & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n                \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q_0}[ e^{ \\frac{f_\\theta + \\beta}{\\alpha} } - 1 ]   \\big \\}\\\\\n                & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0}  \\big \\{\n                \\alpha \\eta  + \\alpha \\log \\mathbb{E}_{Q_0}[ e^{ \\frac{f_\\theta}{\\alpha} }]   \\big \\}\\\\\n                & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0}  \\big \\{\n                \\alpha \\eta  + \\alpha \\log \\mathbb{E}_{Q_0}[ e^{ \\frac{f_\\theta}{\\alpha} }]   \\big \\}\\\\\n                &= - \\mathbb{E}_{P_0} \\big [\\alpha^* \\log \\frac{e^{f_\\theta / \\alpha^*}}{ \\mathbb{E}_{Q_0}[ e^{f_\\theta / \\alpha^*} ]} \\big] +\\alpha \\eta \\\\\n                &=\\alpha^*\\mathcal{{L}}_{\\text{InfoNCE}}+ Constant \n        \\end{aligned}')
('8.0', '\\alpha^*=\\operatorname*{\\arg\\min}_{\\alpha\\geq 0}  \\big \\{\n        \\alpha \\eta  + \\alpha \\log \\mathbb{E}_{Q_0}[ e^{ \\frac{f_\\theta}{\\alpha} }]   \\big \\}')
('8.1', 'A, B')
('8.1', '\\mathcal{D}')
('8.1', '\\mathcal{D}(A\\cup B) \\leq  \\mathcal{D}(A) + \\mathcal{D}(B)')
('8.1', 'X_1, \\cdots, X_n')
('8.1', 'X_i')
('8.1', '\\mathcal{X}')
('8.1', 'f: \\mathcal{X}_1 \\times \\cdots \\times \\mathcal{X}_n \\rightarrow \\mathbb{R}')
('8.1', '(c_1,\\ldots,c_n)')
('8.1', 'i=1,\\ldots,n')
('8.1', '\\left(x_1, \\ldots, x_n\\right),\\left(x_1^{\\prime}, \\ldots, x_n^{\\prime}\\right) \\in \\mathcal{X}_1 \\times \\cdots \\times \\mathcal{X}_n')
('8.1', 'i')
('8.1', 'x_j=x_j^{\\prime}')
('8.1', 'j \\neq i')
('8.1', '\\left|f\\left(x_1, \\ldots, x_n\\right)-f\\left(x_1^{\\prime}, \\ldots, x_n^{\\prime}\\right)\\right| \\leq c_i')
('8.1', '\\epsilon>0')
('8.1', '\\mathbb{P}(f(X_1, \\cdots, X_n )-\\mathbb{E}[f(X_1, \\cdots, X_n  )] \\geq \\epsilon) \\leq \\exp(\\frac{-2\\epsilon^2}{\\sum_{i=1}^N c_i^2})')
('8.1', 'Q^{ideal}')
('8.1', 'D_{KL}({Q}||{Q}_0) \\leq \\eta')
('8.1', '\\mathcal{L}_{unbiased}')
('8.1', '\\begin{aligned}\n       \\mathcal{L}_{unbiased}&=-\\mathbb{E}_{P_0}\\left[f_\\theta\\right]+\\mathbb{E}_{Q^{ideal}}\\left[f_\\theta\\right] \\\\\n       &\\leq -\\mathbb{E}_{P_0}\\left[f_\\theta\\right]+\\max _{D_{K L}\\left(Q \\mid\\mid Q_0\\right) \\leq \\eta} \\mathbb{E}_{Q}\\left[f_\\theta\\right] \\\\\n       &=\\mathcal{L}_{\\text{CL-DRO}}^{KL}\n      \\end{aligned}')
('8.1', '{Q^{\\text{ideal}}}, {Q^*}')
('8.1', 'N')
('8.1', '(x_i,y_i),(x_j,y_j)')
('8.1', '\\left|Q^*{(x_i, y_i)} f_\\theta(x_i, y_i)-Q^*{(x_j, y_j)} f_\\theta(x_j, y_j)\\right| \\leq \\sup _{(x, y) \\sim Q_0}\\left|Q^*{(x, y)} f_\\theta(x, y)\\right| \\leq \\frac{\\exp \\left(\\frac{1}{\\tau}\\right)}{N-1+\\exp \\left(\\frac{1}{\\tau}\\right)}')
('8.1', 'Q^*{(x, y)} f_\\theta(x, y)>0')
('8.1', 'Q^* = Q_0  \\frac{\\exp[{f_\\theta/\\tau}]}{E_{Q_0} \\exp[{f_\\theta/\\tau}]}')
('8.1', 'f_\\theta \\in [M_1,M_2]')
('8.1', '\\sup _{(x, y) \\sim Q_0}\\left|Q^*{(x, y)} f_\\theta(x, y)\\right|')
('8.1', 'f_\\theta(x, y)=M_2')
('8.1', '(x,y)')
('8.1', 'f_\\theta(x, y)=M_1')
('8.1', '\\sup _{(x, y) \\sim Q_0}\\left|Q^*{(x, y)} f_\\theta(x, y)\\right| \\leq \\frac{M_2\\exp \\left(({M_2-M_1})/{\\tau}\\right)}{N-1+\\exp \\left(({M_2-M_1})/{\\tau}\\right)}')
('8.1', '\\epsilon')
('8.1', '\\begin{aligned}\n         \\mathbb{P}[(\\mathcal{L}^{KL}_{\\text{CL-DRO}} - \\mathcal{\\tau\\widehat{L} }_{\\text{InfoNCE}}) \\geq \\epsilon] \\leq \\exp \\big (\\frac{-2\\epsilon^2}{N}   \\bigg( \\frac{N-1+\\exp (({M_2-M_1})/{\\tau})}{M_2 \\exp((M_2-M_1)/\\tau) } \\bigg)^2 \\big) \n      \\end{aligned}\n      \\label{eqn:bound}')
('8.1', 'f')
('8.1', '\\mathbb{F}=\\{f_1, f_2, \\cdots, f_{|\\mathbb{F}|} \\}')
('8.1', '\\hat{f}')
('8.1', '\\begin{aligned}\n      \\mathbb{P}[(\\mathcal{L}^{KL}_{\\text{CL-DRO}} - \\mathcal{\\tau\\widehat{L} }_{\\text{InfoNCE}}) \\geq \\epsilon] & \\leq \\sum_{f\\in{\\mathbb{F}}}\\exp \\big (\\frac{-2\\epsilon^2}{N}   \\bigg( \\frac{N-1+\\exp (({M_2-M_1})/{\\tau})}{M_2 \\exp((M_2-M_1)/\\tau) } \\bigg)^2 \\big)\\\\\n      & = |\\mathbb{F}|\\exp \\big (\\frac{-2\\epsilon^2}{N}   \\bigg( \\frac{N-1+\\exp (({M_2-M_1})/{\\tau})}{M_2 \\exp((M_2-M_1)/\\tau) } \\bigg)^2 \\big)\n   \\end{aligned}')
('8.1', '\\rho = |\\mathbb{F}| \\exp \\big (\\frac{-2\\epsilon^2}{N}   \\bigg( \\frac{N-1+\\exp (({M_2-M_1})/{\\tau})}{M_2 \\exp((M_2-M_1)/\\tau) } \\bigg)^2 \\big)')
('8.1', '\\epsilon = \\frac{M_2\\exp \\left(({M_2-M_1})/{\\tau}\\right)}{N-1+\\exp \\left(({M_2-M_1})/{\\tau}\\right)} \\sqrt{\\frac{N}{2} \\ln(\\frac{2|\\mathbb{F}|}{\\rho})}')
('8.1', '\\forall \\rho \\in (0,1)')
('8.1', '1-\\rho')
('8.1', '\\mathcal{L}_{\\text{unbiased}} \\leq \\mathcal{L}^{KL}_{\\text{CL-DRO}} \\leq \\tau \\mathcal{\\widehat{L} }_{\\text{InfoNCE}} + \\frac{M_2\\exp \\left(({M_2-M_1})/{\\tau}\\right)}{N-1+\\exp \\left(({M_2-M_1})/{\\tau}\\right)} \\sqrt{\\frac{N}{2} \\ln(\\frac{2|\\mathbb{F}|}{\\rho})}')
('8.2', '\\tau')
('8.2', '\\eta')
('8.2', '\\tau')
('8.2', '- \\mathbb{E}_{P_0}[f_\\theta ] + \\operatorname*{inf}_{\\alpha\\geq 0} \\{\\mathbb{E}_{Q_0}[f_\\theta] + \\frac{1}{2\\alpha}\\frac{1}{\\phi^{(2)}(1)} \\mathbb{V}_{Q_0}[f_\\theta] + \\alpha \\eta \\}\n      % \\operatorname*{inf}_{\\tau} \\big \\{  -\\mathbb{E}_{P_0}[f_\\theta ] + \\mathbb{E}_{Q_0}[f_\\theta] + \\frac{1}{2\\tau} \\mathbb{V}_{Q_0}[f_\\theta] + \\tau \\eta \\big \\}')
('8.2', '\\alpha')
('8.2', '\\tau')
('8.2', '\\tau = \\sqrt{\\frac{\\mathbb{V}_{Q_0}[f_\\theta]}{2\\eta}}')
('8.3', '\\phi:\\mathbb{R}\\to \\mathbb{R}\\bigcup \\{ +\\infty \\}')
('8.3', '\\phi(z)\\geq  \\phi(1)=0')
('8.3', 'z')
('8.3', 'z = 1')
('8.3', '\\phi(1)>0')
('8.3', '\\begin{aligned}\n            \\phi^*(\\zeta )&=\\operatorname*{max}_{z} \\{ z \\zeta - \\phi(z) \\} \\\\\n            &=\\zeta + \\frac{1}{2!}[\\frac{1}{\\phi^{\\prime \\prime}(1)}]\\zeta^2 + o(\\zeta^2)\\\\\n         \\end{aligned}')
('8.3', '\\phi')
('8.3', '\\chi ^2')
('8.3', '\\chi ^2')
('8.3', 'n=2')
('8.3', '\\phi^*[\\zeta] \\approx \\zeta+\\frac{1}{2}[\\frac{1}{\\phi^{(2)}(1)}]\\zeta^2')
('8.3', '\\begin{aligned}\n            \\mathcal{L}_{\\text{CL-DRO}}^{\\phi}= & - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q_0}[\\phi^* ( \\frac{f_\\theta + \\beta}{\\alpha} ) ]   \\big \\}\\\\\n            = & - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q_0}[ \\frac{f_\\theta + \\beta}{\\alpha} + \\frac{1}{2}\\frac{1}{\\phi^{(2)}(1)} (\\frac{f_\\theta + \\beta}{\\alpha})^2]   \\big \\}\\\\\n            = & - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta - \\beta +  \\mathbb{E}_{Q_0}[ {f_\\theta + \\beta} + \\frac{1}{2}\\frac{1}{\\phi^{(2)}(1)\\alpha} ({f_\\theta + \\beta})^2]   \\big \\}\\\\\n            = & - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n            \\alpha \\eta  +  \\mathbb{E}_{Q_0}[ {f_\\theta } + \\frac{1}{2}\\frac{1}{\\phi^{(2)}(1)\\alpha} ({f_\\theta + \\beta})^2]   \\big \\}\\\\\n         \\end{aligned}')
('8.3', '\\beta')
('8.3', '\\frac{\\partial \\big \\{   \\alpha \\eta  +  \\mathbb{E}_{Q_0}[ {f_\\theta } + \\frac{1}{2}\\frac{1}{\\phi^{(2)}(1)\\alpha} ({f_\\theta + \\beta})^2] \\big \\}}{\\partial  \\beta} =0')
('8.3', '\\beta^*=-\\mathbb{E}_{Q_0}[f_\\theta]')
('8.3', '\\begin{aligned}\n            &-\\mathbb{E}_{P_0}[f_\\theta ] + \\operatorname*{inf}_{\\alpha\\geq 0, \\beta} \\big \\{ \\alpha \\eta  +  \\mathbb{E}_{Q_0}[ {f_\\theta } + \\frac{1}{2}\\frac{1}{\\phi^{(2)}(1)\\alpha} ({f_\\theta + \\beta})^2] \\big \\}  \\\\\n            =& -\\mathbb{E}_{P_0}[f_\\theta ] + \\operatorname*{inf}_{\\alpha\\geq 0} \\{ \\mathbb{E}_{Q_0} [ {f_\\theta }+ \\frac{1}{2\\alpha}\\frac{1}{\\phi^{(2)}(1)} ({f_\\theta - \\mathbb{E}_{Q_0} [f_\\theta] })^2 ]  + \\alpha \\eta \\} \\\\\n            =&- \\mathbb{E}_{P_0}[f_\\theta ] + \\operatorname*{inf}_{\\alpha\\geq 0} \\{\\mathbb{E}_{Q_0}[f_\\theta] + \\frac{1}{2\\alpha}\\frac{1}{\\phi^{(2)}(1)} \\mathbb{V}_{Q_0}[f_\\theta] + \\alpha \\eta \\}\\\\\n            % =&- \\mathbb{E}_{P_0}[f_\\theta ] + \\operatorname*{inf}_{\\alpha\\geq 0} \\{\\mathbb{E}_{Q_0}[f_\\theta] + \\frac{1}{2\\alpha}\\frac{1}{\\phi^{(2)}(1)} \\mathbb{V}_{Q_0}[f_\\theta] - \\alpha \\eta \\}\n         \\end{aligned}\n         \\label{diff_eq}')
('8.3', '\\phi^{(2)}(1)=1')
('8.3', '\\alpha^*')
('8.3', '\\tau')
('8.3', '\\alpha\\eta')
('8.3', '-\\mathbb{E}_{P_0}[f_\\theta ] + \\mathbb{E}_{Q_0}[f_\\theta] + \\frac{1}{2\\tau} \\mathbb{V}_{Q_0}[f_\\theta]')
('8.4', '\\phi')
('8.4', 'X')
('8.4', 'u')
('8.4', 'u(0)=0,u^*(1)=0')
('8.4', '\\rho(X)')
('8.4', '\\rho(X) = \\operatorname*{inf}_{\\lambda \\in \\mathbb{R}} \\{ \\lambda + \\mathbb{E} [u(f - \\lambda)] \\}')
('8.4', '\\label{eq_vr}\n       D_{\\phi}(P||Q) \\coloneqq \\operatorname*{sup}_{{f}\\in \\mathcal{F}} \\{ \\mathbb{E}_P [f ] -  \\mathbb{E}_Q [\\phi^*(f)] \\}')
('8.4', '\\mathcal{F}')
('8.4', '\\mathcal{X}')
('8.4', 'D_{\\phi}(P||Q) = \\operatorname*{max}_{{f}\\in \\mathcal{F}} -\\mathcal{L}_{\\text{CL-DRO}}^{\\phi}(P,Q)= \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\beta \\in \\mathbb{R}} \\{ -\\beta + \\mathbb{E}_{Q} [\\phi^*(f+\\beta)] \\}')
('8.4', '\\operatorname*{max}_{{f}\\in \\mathcal{F}} -\\mathcal{L}_{\\text{CL-DRO}}^{\\phi}(P,Q)= \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\beta \\in \\mathbb{R}} \\{ - \\beta + \\mathbb{E}_{Q} [\\phi^*(f+\\beta)] \\}')
('8.4', 'D_{\\phi}(P||Q)  =  \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\beta \\in \\mathbb{R}} \\{ -\\beta + \\mathbb{E}_{Q} [\\phi^*(f+\\beta)] \\}')
('8.4', '\\operatorname*{max}_{{f}\\in \\mathcal{F}} -\\mathcal{L}_{\\text{CL-DRO}}^{\\phi}(P,Q)= \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\beta \\in \\mathbb{R}} \\{ -\\beta + \\mathbb{E}_{Q} [\\phi^*(f+\\beta)] \\}')
('8.4', '\\begin{aligned}\n               - \\mathcal{L}_{\\text{CL-DRO}}^{\\phi} & = \\mathbb{E}_{P}[f] - \\operatorname*{min}_{\\alpha\\geq 0, \\beta} \\operatorname*{max}_{L} \\{ \\mathbb{E}_{Q}[f L] -  \\alpha [ \\mathbb{E}_{Q}[{\\phi}(L)] -\\eta] + \\beta (\\mathbb{E}_{Q} [L]  - 1) \\}\\\\\n               & = \\mathbb{E}_{P}[f] - \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n                   \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q}[\\operatorname*{max}_{L} \\{ \\frac{f+\\beta}{\\alpha} L - \\phi(L)\\}  ]   \\big \\}\\\\\n               & = \\mathbb{E}_{P}[f] - \\operatorname*{min}_{\\alpha\\geq 0, \\beta}  \\big \\{\n                   \\alpha \\eta - \\beta + \\alpha \\mathbb{E}_{Q}[\\phi^* ( \\frac{f + \\beta}{\\alpha} ) ]   \\big \\}\\\\\n               & = \\mathbb{E}_{P}[f] - \\operatorname*{min}_{\\beta}  \\big \\{\n                   \\alpha^* \\eta - \\beta + \\alpha^* \\mathbb{E}_{Q}[\\phi^* ( \\frac{f + \\beta}{\\alpha^*} ) ]   \\big \\}\\\\\n               & = \\mathbb{E}_{P}[f] - \\operatorname*{min}_{\\beta}  \\big \\{\n                       - \\beta + \\alpha^* \\mathbb{E}_{Q}[\\phi^* ( \\frac{f + \\beta}{\\alpha^*} ) ]  + Constant \\big \\}\\\\\n           \\end{aligned}')
('8.4', '\\alpha^*=1')
('8.4', 'D_{\\phi}(P||Q)  =  \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P} [f] - \\operatorname*{min}_{\\beta \\in \\mathbb{R}} \\{ -\\beta + \\mathbb{E}_{Q} [\\phi^*(f+\\beta)] \\}')
('8.4', '\\mathbb{E}_{P}[f]')
('8.4', '\\mathbb{E}_{Q}[f \\frac{dP}{dQ}]')
('8.4', '\\begin{aligned}\n               & \\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{P}[f] - \\operatorname*{min}_{\\beta}  \\big \\{\n                       - \\beta +  \\mathbb{E}_{Q}[\\phi^* ( {f + \\beta}{} ) ]   \\big \\}\\\\\n               =&\\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{Q}[f \\frac{dP}{dQ}] - \\operatorname*{min}_{\\beta}  \\big \\{\n                   - \\beta +  \\mathbb{E}_{Q}[\\phi^* ( {f + \\beta}{} ) ]   \\big \\}\\\\\n           \\end{aligned}')
('8.4', 'f + \\beta=Y')
('8.4', '\\begin{aligned}\n               &\\operatorname*{max}_{{f}\\in \\mathcal{F}} \\mathbb{E}_{Q}[f \\frac{dP}{dQ}] - \\operatorname*{min}_{\\beta}  \\big \\{\n                   - \\beta + \\mathbb{E}_{Q}[\\phi^* ( {f + \\beta} ) ]   \\big \\}\\\\\n               =&\\operatorname*{max}_{{Y}\\in \\mathcal{F}} \\operatorname*{min}_{\\beta} \\mathbb{E}_{Q}[ (Y-\\beta) \\frac{dP}{dQ}] -  \\big \\{\n                   - \\beta +  \\mathbb{E}_{Q}[\\phi^* ( {Y}{} ) ]   \\big \\}\\\\\n               =&\\operatorname*{max}_{{Y}\\in \\mathcal{F}} \\mathbb{E}_{Q}[ Y \\frac{dP}{dQ} -  \\phi^* ( {Y}{} )] \n               + \\operatorname*{min}_{\\beta} \\beta \\mathbb{E}_{Q} [1 - \\frac{dP}{dQ} ] \\\\\n               =&\\operatorname*{max}_{{Y}\\in \\mathcal{F}} \\mathbb{E}_{Q}[ Y \\frac{dP}{dQ} -  \\phi^* ( {Y}{} )] \n               +  0 \\\\\n           \\end{aligned}\n           \\label{eq_fthetay}')
('8.4', 'f+\\theta_1')
('8.4', 'Y')
('8.4', '\\beta')
('8.4', '\\mathbb{E}_{Q} [1 - \\frac{dP}{dQ} ]=0')
('8.4', '\\begin{aligned}\n        &\\operatorname*{max}_{{Y}\\in \\mathcal{F}} \\mathbb{E}_{Q}[ Y \\frac{dP}{dQ} -  \\phi^* ( {Y}{} )] \\\\\n        = &\\mathbb{E}_{Q}[\\operatorname*{sup}_{{Y}\\in \\mathcal{F}} \\{ Y \\frac{dP}{dQ} -  \\phi^* ( {Y}{} ) \\} ]\\\\\n        = &\\mathbb{E}_{Q}[\\phi^{**} ( {\\frac{dP}{dQ}}{} ) ] \\\\\n        = &\\mathbb{E}_{Q}[\\phi ( {\\frac{dP}{dQ}}{} ) ] \\\\\n        = & D_{\\phi}(P||Q) \\\\\n     \\end{aligned}')
('8.4', '\\phi^{**}=\\phi')
('8.5', '\\begin{aligned}\n        \\mathcal{L}_{\\text{CL-DRO}}^{\\phi} & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{ \\beta}  \\big \\{\n            \\alpha^* \\eta - \\beta + \\alpha^* \\mathbb{E}_{Q_0}[\\operatorname*{max}_{L} \\{ \\frac{f_\\theta + \\beta}{\\alpha^*} L  - \\phi(L) \\}]   \\big \\}\\\\\n            & = - \\mathbb{E}_{P_0}[f_\\theta] + \\operatorname*{min}_{ \\beta}  \\big \\{\n            \\alpha^* \\eta - \\beta + \\alpha^* \\mathbb{E}_{Q_0}[\\phi^* ( \\frac{f_\\theta + \\beta}{\\alpha^*} ) ]   \\big \\}\\\\\n    \\end{aligned}')
('8.5', 'L')
('8.5', '\\operatorname*{max}_{L} \\{ \\frac{f_\\theta + \\beta}{\\alpha^*} L  - \\phi(L) \\}')
('8.5', '\\label{l_1}\n  L = e^{\\frac{f_\\theta+ \\beta}{\\alpha^*}}')
('8.5', '\\beta')
('8.5', '\\operatorname*{min}_{\\beta}  \\big \\{\n                \\alpha^* \\eta - \\beta + \\alpha^* \\mathbb{E}_{Q_0}[ e^{ \\frac{f_\\theta + \\beta}{\\alpha^*} } - 1 ]   \\big \\}')
('8.5', '\\label{eta_1_}\n  \\beta =  \\alpha^* \\log \\mathbb{E}_{Q_0} e^{-\\frac{f_\\theta}{\\alpha^*}}')
('8.5', 'L = \\frac{e^{\\frac{f_\\theta}{\\alpha^*}}}{\\mathbb{E}_{Q_0} [e^{\\frac{f_\\theta}{\\alpha^*}}]}')
('8.5', 'L')
('8.5', 'Q^*')
('8.5', 'Q^* = \\frac{e^{\\frac{f_\\theta}{\\alpha^*}}}{\\mathbb{E}_{Q_0} [e^{\\frac{f_\\theta}{\\alpha^*}}]} Q_0')
('9.0', '\\tau')
('9.0', '\\tau_0')
('9.0', '\\tau')
('9.0', '\\tau^*')
('9.0', '\\{\\cdot\\}')
('9.0', '\\alpha')
('9.0', 'p=4')
('9.0', '\\tau=0.5')
('9.0', '1e-6')
('9.0', '\\tau')
('9.0', '\\eta')
('9.0', 'r_{ratio}=0')
('9.0', 'r_{ratio}=0.5')
('9.0', 'r_{ratio}=1')
('9.2', '\\mu \\in \\{ 0.5, 0.6 ,0.7 , 0.8, 0.9, 1.0 \\}')
('9.2', '\\sigma=1')
('9.2', '\\{\\cdot\\}')
('9.2', '\\tau')
('9.2', '\\mu')
('9.2', '\\sigma')
('9.3', 'w(x,m,n)=\\frac{1}{\\Gamma(m)n^m}x^{m-1}e^{-\\frac{x}{n}}')
('9.3', 'w(x,m)=\\frac{x}{m^2}e^{-\\frac{x^2}{2m^2}}')
('9.3', 'w(x,m)=\\frac{1}{2^{m/2}\\Gamma{(m/2)}}x^{m/2-1}e^{-{x}/{2}}')
('9.3', 'w(x,m,n)=\\frac{1}{n\\sqrt{2\\pi}}e^{-\\frac{1}{2} (\\frac{x-m}{n})^2}')
('9.3', 'm')
('9.3', 'n')
('9.3', 'x')
('9.3', '(0,+\\infty)')
('9.3', '{x=prediction\\_score + 1}')
('9.4', '\\mu')
('9.4', '\\mu')
('9.4', '\\sigma')
('9.4', '\\sigma')
('9.4', '\\mu')
('9.4', '\\sigma')
('9.4', '\\mu')
('9.4', '\\sigma')
('9.4', '\\tau')
('9.4', '\\sigma')
('9.4', '\\tau')
('9.4', '\\mu')
('9.4', '\\sigma')
('9.4', '\\sigma=1')
('9.4', '\\mu')
