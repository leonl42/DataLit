('1.0', '[0, 1]')
('2.0', '(\\mathcal{X}, d)')
('2.0', "(\\mathcal{Y}, d')")
('2.0', 'K>0')
('2.0', 'f:\\mathcal{X}\\rightarrow \\mathcal{Y}')
('2.0', 'K')
('2.0', '\\mathbf{x}, \\mathbf{y}\\in \\mathcal{X}')
('2.0', "d'(f(\\mathbf{x}), f(\\mathbf{y})) \\leq K d(\\mathbf{x}, \\mathbf{y}).")
('2.0', 'K')
('2.0', 'f')
('2.0', '\\left\\lVert f \\right\\rVert_{\\textrm{Lip}}')
('2.0', 'K')
('2.0', 'f:\\mathcal{X}\\rightarrow \\mathcal{Y}')
('2.0', '\\text{\\rm Lip}_{K} (\\mathcal{X}, \\mathcal{Y})')
('2.0', 'p, q')
('2.0', 'p(\\mathbf{z})')
('2.0', 'p')
('2.0', '\\mathbf{z}')
('2.0', 'q(\\mathbf{z}|\\mathbf{x})')
('2.0', 'q')
('2.0', '\\mathcal{X}')
('2.0', '\\mathcal{M}_+^1(\\mathcal{X})')
('2.0', 'p, q \\in \\mathcal{M}_+^1(\\mathcal{X})')
('2.0', '\\mathrm{KL}(p \\, || \\, q)')
('2.0', 'p \\ll q')
('2.0', '\\mathcal{F}')
('2.0', '\\mathcal{X}')
('2.0', '\\mathcal{F}')
('2.0', 'd_{\\mathcal{F}}')
('2.0', '\\label{eq-def-ipm}\nd_{\\mathcal{F}}(p, q) = \\sup_{f\\in\\mathcal{F}}\\left \\lvert  \\int_{}^{} f \\,dp - \\int_{}^{} f \\,dq \\right \\rvert, \\quad \\forall p, q \\in \\mathcal{M}_+^1(\\mathcal{X}).')
('2.0', '1')
('2.0', '\\mathcal{F}= \\{ f: \\mathcal{X}\\rightarrow \\mathbb{R}\\text{ s.t. } \\left\\lVert f \\right\\rVert_{\\textrm{Lip}} \\leq 1 \\}')
('2.0', 'p')
('2.0', '\\mathcal{Z}')
('2.0', 'g: \\mathcal{Z}\\rightarrow \\mathcal{X}')
('2.0', 'g')
('2.0', 'p')
('2.0', '{g} \\sharp p')
('2.0', '\\mathcal{X}')
('2.0', '{g} \\sharp p(A) = p(g^{-1}(A))')
('2.0', 'A \\subseteq \\mathcal{X}')
('2.0', '\\mathbf{x}\\sim{g} \\sharp p')
('2.0', '\\mathbf{z}\\sim p')
('2.0', '\\mathbf{x}=g(\\mathbf{z})')
('2.1', '\\mathcal{X}')
('2.1', '\\mu \\in \\mathcal{M}_+^1(\\mathcal{X})')
('2.1', '\\mathcal{Z}=\\mathbb{R}^{d_\\mathcal{Z}}')
('2.1', '\\phi')
('2.1', '\\theta')
('2.1', '\\phi')
('2.1', '\\theta')
('2.1', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('2.1', '\\mathcal{Z}')
('2.1', 'p_\\theta(\\mathbf{z}| \\mathbf{x})')
('2.1', 'p_\\theta(\\mathbf{x}| \\mathbf{z})')
('2.1', 'p(\\mathbf{z})=\\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('2.1', '\\mathcal{Z}')
('2.1', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('2.1', '\\mathbf{x}\\in \\mathcal{X}')
('2.1', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('2.1', '\\mathcal{N}(\\mu_\\phi\\left( \\mathbf{x}  \\right), \\text{diag}(\\sigma_\\phi^2\\left( \\mathbf{x}  \\right)))')
('2.1', '\\mu_\\phi: \\mathcal{X}\\rightarrow \\mathcal{Z}= \\mathbb{R}^{d_\\mathcal{Z}}\\quad \\text{ and } \\quad\\sigma_\\phi: \\mathcal{X}\\rightarrow \\mathbb{R}^{d_\\mathcal{Z}}_{\\geq 0}.')
('2.1', '\\text{diag}(\\sigma)')
('2.1', '\\sigma')
('2.1', '\\label{eq-qphi}\nQ_\\phi: \\mathcal{X}\\rightarrow \\mathbb{R}^{2{d_\\mathcal{Z}}}, \\quad \\text{where } \nQ_\\phi \\left( \\mathbf{x}  \\right) = \\begin{bmatrix}\n   \\mu_\\phi\\left( \\mathbf{x}  \\right) \\\\\n   \\sigma_\\phi\\left( \\mathbf{x}  \\right) \n \\end{bmatrix}.')
('2.1', 'g_\\theta: \\mathcal{Z}\\rightarrow \\mathcal{X}')
('2.1', '\\mathbf{x}\\in \\mathcal{X}')
('2.1', '\\mathbf{z}\\sim q_\\phi(\\mathbf{z}| \\mathbf{x})')
('2.1', 'g_\\theta( \\mathbf{z} )')
('2.1', '\\mathbf{x}')
('2.1', 'S = \\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}')
('2.1', '\\label{eq-loss-vae}\n\\mathcal{L}_\\text{VAE}(\\phi,\\theta) = \\frac{1}{n} \\sum_{i=1}^{n}{  \\left[   \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q_\\phi(\\mathbf{z}| \\mathbf{x}_i)}\\left[-\\log p_\\theta(\\mathbf{x}_i | \\mathbf{z})\\right] + \\beta \\mathrm{KL}(q_\\phi(\\mathbf{z}| \\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))   \\right]  },')
('2.1', '\\beta > 0')
('2.1', '\\mathbf{x}')
('2.1', 'g_\\theta( \\mathbf{z} )')
('2.1', 'L_2')
('2.1', '\\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z} )  \\right\\rVert^2')
('2.1', 'p(\\mathbf{z})')
('2.1', 'g_\\theta')
('2.1', '{g_\\theta} \\sharp p(\\mathbf{z}) \\in \\mathcal{M}_+^1(\\mathcal{X})')
('2.1', '{g_\\theta} \\sharp p(\\mathbf{z})')
('2.2', '\\mathcal{H}')
('2.2', 'S=\\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}')
('2.2', '\\mu')
('2.2', '\\mathcal{X}')
('2.2', '\\mathcal{X}\\times \\mathcal{Y}')
('2.2', '\\mathcal{X}')
('2.2', '\\mathcal{Y}')
('2.2', '\\ell: \\mathcal{H}\\times \\mathcal{X}\\rightarrow [0, \\infty)')
('2.2', 'q\\in \\mathcal{M}_+^1(\\mathcal{H})')
('2.2', 'q')
('2.2', 'p \\in \\mathcal{M}_+^1(\\mathcal{H})')
('2.2', 'q \\in \\mathcal{M}_+^1(\\mathcal{H})')
('2.2', '\\hat{\\mathcal{R}}_S(q) = \\mathop{\\mathrm{\\mathbb{E}}}_{h \\sim q(h)}\\left[\\frac{1}{n}\\sum_{i=1}^{n}{ \\ell(h, \\mathbf{x}_i) }\\right] \\quad \\text{ and } \\quad\n\\mathcal{R}(q) = \\mathop{\\mathrm{\\mathbb{E}}}_{h \\sim q(h)}\\left[\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\ell(h, \\mathbf{x}) \\right].')
('2.2', '\\mu')
('2.2', '\\mathcal{X}')
('2.2', '\\mathcal{H}')
('2.2', 'p')
('2.2', '\\mathcal{H}')
('2.2', '\\ell: \\mathcal{H}\\times \\mathcal{X}\\rightarrow [0, 1]')
('2.2', '\\delta \\in (0, 1)')
('2.2', '\\lambda >0')
('2.2', '1-\\delta')
('2.2', 'S\\sim\\mu^{\\otimes n}')
('2.2', 'q\\in \\mathcal{M}_+^1(\\mathcal{H})')
('2.2', '\\mathcal{R}(q) \\leq \\hat{\\mathcal{R}}_S(q) + \\frac{\\lambda}{8n} + \\frac{\\mathrm{KL}(q \\, || \\, p) + \\log\\frac{1}{\\delta}}{\\lambda}.')
('2.2', '\\lambda')
('2.2', '\\ell')
('2.2', '\\mathcal{H}')
('2.2', '\\mathcal{Z}')
('2.2', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('2.2', '\\mathbf{x}\\sim\\mu')
('2.2', 'q(h)')
('2.2', 'q(\\cdot | \\mathbf{x})')
('3', 'q(h|\\mathbf{x})')
('3', '\\mathbf{x}\\sim\\mu')
('3', 'q')
('3', '\\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}')
('3', 'q')
('3', '\\ell')
('3', 'q(\\cdot | \\mathbf{x})')
('3', '\\ell')
('3', 'K > 0')
('3', '\\mathcal{E}')
('3', '\\mathcal{H}\\rightarrow \\mathbb{R}')
('3', '\\mathbf{x}\\mapsto q(\\cdot | \\mathbf{x})')
('3', '\\mathbf{x}_1, \\mathbf{x}_2 \\in \\mathcal{X}')
('3', 'd_{\\mathcal{E}}\\left( q(h|\\mathbf{x}_1), q(h|\\mathbf{x}_2)  \\right) \\leq K d(\\mathbf{x}_1 , \\mathbf{x}_2).')
('3', '\\mathbf{x}\\in \\mathcal{X}')
('3', '\\ell(\\cdot, \\mathbf{x}) : \\mathcal{H}\\rightarrow \\mathbb{R}')
('3', '\\mathcal{E}')
('3', '\\ell(\\cdot, \\mathbf{x}) \\in \\mathcal{E}, \\quad \\text{for any } \\mathbf{x}\\in \\mathcal{X}.')
('3', 'q(h|\\mathbf{x})')
('3', '\\mathbf{x}\\sim\\mu')
('3', 'q(h|\\mathbf{x})')
('3', '\\ell')
('3', 'S= \\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}')
('3', '\\mathbf{x}\\mapsto q(h|\\mathbf{x})')
('3', 'q')
('3', 'd_{\\mathcal{E}}')
('3', 'd_{\\mathcal{E}}')
('3', 'd')
('3', '\\mathcal{X}')
('3', '\\mathbf{x}_1')
('3', '\\mathbf{x}_2')
('3', '\\mathcal{X}')
('3', 'q(h|\\mathbf{x}_1)')
('3', 'q(h|\\mathbf{x}_2)')
('3', 'd_{\\mathcal{E}}')
('3', '\\ell')
('3', 'd_{\\mathcal{E}}')
('3', 'q(h|\\mathbf{x}_1)')
('3', 'q(h|\\mathbf{x}_2)')
('3', 'L_2')
('3', '(\\mathcal{X}, d)')
('3', '\\mu')
('3', '\\mathcal{X}')
('3', '\\mathcal{H}')
('3', 'p(h)')
('3', '\\mathcal{H}')
('3', '\\ell: \\mathcal{H}{\\times} \\mathcal{X}{\\rightarrow} \\mathbb{R}')
('3', '\\delta \\in (0, 1)')
('3', '\\lambda \\,{>}\\, 0')
('3', '1\\,{-}\\,\\delta')
('3', 'S \\,{\\sim}\\, \\mu^{\\otimes n}')
('3', 'q(h|\\mathbf{x})')
('3', 'q(h|\\mathbf{x})')
('3', '\\ell')
('3', 'K \\,{>}\\, 0')
('3', "\\begin{split}\n\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x})} \\hspace{-3mm}\\ell(h, \\mathbf{x})   - \\frac{1}{n}\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)} \\hspace{-4mm}\\ell(h, \\mathbf{x}_i) }\n   \\leq\n\\frac{1}{\\lambda} \\left[  \n\\sum_{i=1}^{n}{\\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))} +\n\\frac{\\lambda K}{n} \\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) } + {}\n\\right. \\\\  \\left.\n\\log \\frac{1}{\\delta} + n \\log \\mathop{\\mathrm{\\mathbb{E}}}_{h \\sim p(h)} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} e^{\\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell(h, \\mathbf{x}')  - \\ell(h, \\mathbf{x}) \\right) }  \n  \\right].\n\\end{split}")
('3', '\\mathbf{x}\\sim\\mu')
('3', 'q(h|\\mathbf{x}_i)')
('3', 'n')
('3', 'p(h)')
('3', 'n')
('3', 'q_\\phi(\\mathbf{z}| \\mathbf{x}_1), \\dots, q_\\phi(\\mathbf{z}| \\mathbf{x}_n)')
('3', '\\mathbf{x}\\sim\\mu')
('3', 'q(h|\\mathbf{x})')
('3', '\\mathbf{x}')
('3', 'q(h|\\mathbf{x})')
('3', '\\mathbf{x}\\in \\mathcal{X}')
('3', '\\frac{1}{n}\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) }')
('3', 'q')
('3', '\\mathbf{x}\\sim\\mu')
('3', 'h')
('3', '\\mathbf{x}')
('3', '\\mathcal{E}')
('3', '\\ell')
('3', '\\mathcal{E}')
('3', 'K')
('3', '\\mathcal{H}')
('3', '\\mathcal{H}')
('3', '\\mathcal{H}= \\mathcal{Z}')
('4', '\\left\\lVert \\cdot \\right\\rVert')
('4', 'L_2')
('4', '\\mathcal{X}')
('4', '\\mathcal{Z}= \\mathbb{R}^{d_\\mathcal{Z}}')
('4', '{d_\\mathcal{Z}}> 0')
('4', '\\mathcal{X}')
('4', '\\mathcal{Z}')
('4', "\\mathbf{x}, \\mathbf{x}' \\in \\mathcal{X}")
('4', "d(\\mathbf{x}, \\mathbf{x}') = \\left\\lVert \\mathbf{x}- \\mathbf{x}' \\right\\rVert")
('4', 'K_\\phi, K_\\theta> 0')
('4', '\\mathbf{x}_1, \\mathbf{x}_2 \\in \\mathcal{X}')
('4', '\\mathbf{z}_1, \\mathbf{z}_2 \\in \\mathcal{Z}')
('4', '\\label{eq-kphi}\n\\left\\lVert  Q_\\phi \\left( \\mathbf{x}_1  \\right) - Q_\\phi \\left( \\mathbf{x}_2  \\right)  \\right\\rVert \\leq K_\\phi\\left\\lVert  \\mathbf{x}_1 - \\mathbf{x}_2  \\right\\rVert')
('4', '\\label{eq-ktheta}\n\\left\\lVert  g_\\theta( \\mathbf{z}_1 ) - g_\\theta( \\mathbf{z}_2 )  \\right\\rVert \\leq K_\\theta\\left\\lVert  \\mathbf{z}_1 - \\mathbf{z}_2  \\right\\rVert.')
('4', 'Q_\\phi')
('4', '\\ell_\\text{rec}^\\theta')
('4', 'L_2')
('4', 'L_2')
('4', '\\ell_\\text{rec}^\\theta: \\mathcal{Z}\\times \\mathcal{X}\\rightarrow [0, \\infty)')
('4', '\\label{eq-lossrec}\n\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) = \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z} )  \\right\\rVert.')
('4', '\\phi')
('4', '\\theta')
('4', 'K_\\phi, K_\\theta\\in \\mathbb{R}')
('4', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('4', '\\mathcal{E}= \\{ f: \\mathcal{Z}\\rightarrow \\mathbb{R}\\,\\, s.t. \\left\\lVert f \\right\\rVert_{\\textrm{Lip}} \\leq K_\\theta \\}')
('4', '\\ell=\\ell_\\text{rec}^\\theta')
('4', 'K=K_\\phi K_\\theta')
('4', '\\mathcal{E}')
('4', 'K_\\theta')
('4', 'd_{\\mathcal{E}}')
('4', 'W_1 \\leq W_2')
('4', 'd_{\\mathcal{E}}(q_\\phi(\\cdot | \\mathbf{x}_1), q_\\phi(\\cdot | \\mathbf{x}_2)) \\leq K_\\phi K_\\theta\\left\\lVert  \\mathbf{x}_1 - \\mathbf{x}_2  \\right\\rVert')
('4', '\\mathcal{X}')
('4', '\\mu \\in \\mathcal{M}_+^1(\\mathcal{X})')
('4', '\\mathcal{Z}')
('4', 'p(\\mathbf{z}) \\in \\mathcal{M}_+^1(\\mathcal{Z})')
('4', '\\theta')
('4', '\\delta \\in (0, 1), \\lambda > 0')
('4', '1-\\delta')
('4', 'S\\sim\\mu^{\\otimes n}')
('4', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('4', "\\begin{split}\n\\expectseul{\\mathbf{x}\\sim\\mu}&{ \\,\\, \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}| \\mathbf{x})} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) } \\leq \\frac{1}{n}\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{q_\\phi(\\mathbf{z}| \\mathbf{x}_i)} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i) }\n   +\n\\frac{1}{\\lambda} \\left[\n\\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}| \\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))} + \\right. \\\\  \n&\\left.\n\\tfrac{\\lambda K_\\phi K_\\theta}{n} \\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) } + \n\\log \\tfrac{1}{\\delta} + n \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} e^{\\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right) }    \\right],\n\\end{split}")
('4', 'K_\\phi')
('4', 'K_\\theta')
('4', '\\expectseul{q_\\phi(\\mathbf{z}| \\mathbf{x})}')
('4', '\\expectseul{\\mathbf{z}\\sim q_\\phi(\\mathbf{z}| \\mathbf{x})}')
('4', '\\beta')
('4', '\\lambda')
('4', '\\lambda =n')
('4', '\\beta =1')
('4.0', "\\Delta \\stackrel{\\text{def}}{=}\\sup_{\\mathbf{x}, \\mathbf{x}' \\in \\mathcal{X}}d(\\mathbf{x}, \\mathbf{x}')")
('4.0', '\\mathcal{X}')
('4.0', '\\Delta <\\infty')
('4.0', '\\mu \\in \\mathcal{M}_+^1(\\mathcal{X})')
('4.0', '\\mathcal{Z}')
('4.0', 'p(\\mathbf{z}) \\in \\mathcal{M}_+^1(\\mathcal{Z})')
('4.0', '\\theta')
('4.0', '\\delta \\in (0, 1), \\lambda > 0')
('4.0', '1-\\delta')
('4.0', 'S\\sim\\mu^{\\otimes n}')
('4.0', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('4.0', '\\begin{split}\n \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu } \\mathop{\\mathrm{\\mathbb{E}}}_{q_\\phi(\\mathbf{z}|\\mathbf{x})  } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})        \\leq\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \\frac{1}{\\lambda} \\left( \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  +{} \\right. \\\\\n  \\lambda K_\\phi K_\\theta\\Delta  +  \\left.\n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 \\Delta^2}{8n} \\right).\n\\end{split}')
('4.0', '\\mathbf{x}\\sim\\mu')
('4.1', '[0, 1]^{d^*}')
('4.1', '{d^*}')
('4.1', '\\mu')
('4.1', 'p^*')
('4.1', '\\mathbb{R}^{d^*}')
('4.1', 'p^*')
('4.1', '[0, 1]^{d^*}')
('4.1', '\\mathcal{X}')
('4.1', '\\mu \\in \\mathcal{M}_+^1(\\mathcal{X})')
('4.1', '\\mathcal{Z}')
('4.1', 'p(\\mathbf{z}) \\in \\mathcal{M}_+^1(\\mathcal{Z})')
('4.1', '\\theta')
('4.1', '\\delta \\in (0, 1), \\lambda >0, a>0')
('4.1', '\\mu = {g^*} \\sharp p^*')
('4.1', 'p^*')
('4.1', '\\mathbb{R}^{d^*}')
('4.1', 'g^*\\in \\text{\\rm Lip}_{K_*} (\\mathbb{R}^{d^*}, \\mathcal{X})')
('4.1', '1 - \\delta - \\frac{n {d^*}}{2} e^{-a^2 / 2}')
('4.1', 'S \\sim\\mu^{\\otimes n}')
('4.1', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('4.1', '\\begin{split}\n \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu } \\mathop{\\mathrm{\\mathbb{E}}}_{q_\\phi(\\mathbf{z}|\\mathbf{x})  } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})        \\leq\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \\frac{1}{\\lambda} \\left( \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  +{} \\right. \\\\\n   \\lambda K_\\phi K_\\theta K_*\\sqrt{(1 + a^2){d^*}}  +  \\left.\n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 K_*^2}{2n} \\right).\n\\end{split}')
('4.1', 'a > 0')
('4.1', '\\mathbf{x}_i \\in S')
('4.1', '\\mathbf{x}_i = g^*(\\mathbf{w}_i)')
('4.1', '\\mathbf{w}_i \\sim p^*')
('4.1', 'p^*')
('4.1', '\\mathbb{R}^{d^*}')
('4.1', '\\mathbf{w}_i')
('4.1', '[-a, a]^{d^*}')
('4.1', '1-\\delta')
('4.1', '1-\\delta - \\frac{n{d^*}}{2}e^{-a^2/2}')
('4.1', 'a')
('4.1', '\\mathbf{z}\\mapsto \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})')
('4.1', 'K_*')
('4.1', '\\frac{1}{n}\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\left\\lVert  \\mathbf{x}- \\mathbf{x}_i  \\right\\rVert }')
('4.1', '\\chi^2')
('4.1', '\\mathbf{w}_i \\in [-a, a]^{d^*}')
('4.1', '1\\leq i \\leq n')
('5', '\\hat{\\mu}_{\\phi, \\theta}')
('5', '\\hat{\\mu}_{\\phi, \\theta}= \\textstyle\\frac{1}{n} \\sum_{i=1}^{n}{{g_\\theta} \\sharp q_\\phi(\\mathbf{z}| \\mathbf{x}_i)}.')
('5', '\\mathbf{x}\\sim\\hat{\\mu}_{\\phi, \\theta}')
('5', '\\mathbf{z}\\sim q_\\phi(\\mathbf{z}| \\mathbf{x}_i)')
('5', 'i')
('5', '\\{ 1, \\dots, n \\}')
('5', '\\mathbf{z}')
('5', '\\mathbf{x}=g_\\theta( \\mathbf{z} )')
('5', 'S = \\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}')
('5', 'W_1(\\mu, \\hat{\\mu}_{\\phi, \\theta})')
('5', 'W_1(\\mu, {g_\\theta} \\sharp p(\\mathbf{z}))')
('5.0', '1-\\delta')
('5.0', 'S\\sim\\mu^{\\otimes n}')
('5.0', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('5.0', '\\begin{split}\nW_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq \n\\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \n\\frac{1}{\\lambda} \\left( \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + \n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 \\Delta^2}{8n}   \\right).\n\\end{split}')
('5.0', '\\mathcal{X}')
('5.0', "d(\\mathbf{x}, \\mathbf{x}') = \\left\\lVert \\mathbf{x}- \\mathbf{x}' \\right\\rVert")
('5.0', '\\ell_\\text{rec}^\\theta')
('5.0', '1-\\delta')
('5.0', 'S\\sim\\mu^{\\otimes n}')
('5.0', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('5.0', '\\begin{split}\nW_1(\\mu, {g_\\theta} \\sharp p(\\mathbf{z})) \\leq  \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \n\\frac{1}{\\lambda} \\left( \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + \\right. \\\\ \n  \\left.\n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 \\Delta^2}{8n}   \\right) +\n\\frac{K_\\theta}{n} \\sum_{i=1}^{n}{\\sqrt{ \\left\\lVert \\mu_\\phi\\left( \\mathbf{x}_i  \\right) \\right\\rVert^2 + \\left\\lVert \\sigma_\\phi\\left( \\mathbf{x}_i  \\right)  - \\Vec{1} \\right\\rVert^2  }},\n\\end{split}')
('5.0', '\\Vec{1} \\in \\mathbb{R}^{d_\\mathcal{Z}}')
('5.0', '1')
('5.0', 'W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_i), p(\\mathbf{z}))')
('5.0', 'W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_i), p(\\mathbf{z}))')
('5.1', '\\mathbb{R}^{d^*}')
('5.1', '{d^*}')
('5.1', '1 -\\delta')
('5.1', 'S\\sim\\mu^{\\otimes n}')
('5.1', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('5.1', '\\begin{split}\nW_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \\frac{1}{\\lambda} \\left( \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + \n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 K_*^2}{2n} \\right).\n\\end{split}')
('5.1', '1 - \\delta')
('5.1', 'S\\sim\\mu^{\\otimes n}')
('5.1', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('5.1', '\\begin{split}\nW_1(\\mu, {g_\\theta} \\sharp p(\\mathbf{z})) \\leq \n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \\frac{1}{\\lambda} \\left( \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + {} \\right. \\\\\n   \\left.\n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 K_*^2}{2n} \\right) + \n\\frac{K_\\theta}{n} \\sum_{i=1}^{n}{\\sqrt{ \\left\\lVert \\mu_\\phi\\left( \\mathbf{x}_i  \\right) \\right\\rVert^2 + \\left\\lVert \\sigma_\\phi\\left( \\mathbf{x}_i  \\right)  - \\Vec{1} \\right\\rVert^2  }},\n\\end{split}')
('5.1', '\\Vec{1} \\in \\mathbb{R}^{d_\\mathcal{Z}}')
('5.1', '1')
('5.1', 'O(n^{-1/2})')
('5.1', '\\lambda \\approx \\sqrt{n}')
('5.1', '\\lambda \\approx n')
('5.1', 'n^{-1}')
('5.1', 'O(n^{-1/2})')
('6.0', '\\theta')
('6.0.0', 'L_2')
('6.0.0', 'L_2')
('8', 'p, q \\in \\mathcal{M}_+^1(\\mathcal{X})')
('8', '\\gamma')
('8', '\\mathcal{X}\\times \\mathcal{X}')
('8', 'p')
('8', 'q')
('8', 'B \\subset \\mathcal{X}')
('8', '\\gamma(B \\times \\mathcal{X}) = p(B)')
('8', '\\gamma(\\mathcal{X}\\times B) = q(B)')
('8', 'p')
('8', 'q')
('8', '\\mathcal{X}\\times \\mathcal{X}')
('8', 'p')
('8', 'q')
('8', 'p \\otimes q')
('8', 'p')
('8', 'q')
('8', '(\\mathcal{X}, d)')
('8', 'p, q \\in \\mathcal{M}_+^1(\\mathcal{X})')
('8', 'k \\geq 1')
('8', 'k')
('8', 'W_k')
('8', 'W_k(p, q) = \\left( \\inf_{\\pi \\in \\Gamma(p, q)}\\int_{}^{} d(\\mathbf{x}, \\mathbf{y})^k \\,d\\pi(\\mathbf{x}, \\mathbf{y})  \\right)^{1/k},')
('8', '\\Gamma(p, q)')
('8', 'p')
('8', 'q')
('8', 'W_1')
('8', 'p=\\mathcal{N}(\\mu_1, \\Sigma_1)')
('8', 'q=\\mathcal{N}(\\mu_2, \\Sigma_2)')
('8', '\\mathbb{R}^{d^*}')
('8', '\\label{eq-w2-gaussian}\nW_2(p, q)^2 =  \\left\\lVert \\mu_1 - \\mu_2 \\right\\rVert^2 + \\text{Tr} \\left( \\Sigma_1 + \\Sigma_2 - 2\\left( \\Sigma_1^{1/2} \\Sigma_2 \\Sigma_1^{1/2} \\right)^{1/2}  \\right).')
('8', '\\Sigma_1 = \\text{diag}(\\sigma_1^2)')
('8', '\\Sigma_2 = \\text{diag}(\\sigma_2^2)')
('8', '\\sigma_1, \\sigma_2 \\in \\mathbb{R}^{d^*}')
('8', '\\Sigma_1 \\Sigma_2 = \\Sigma_2 \\Sigma_1')
('8', '\\left( \\Sigma_1^{1/2} \\Sigma_2 \\Sigma_1^{1/2} \\right)^{1/2} = \n\\Sigma_1^{1/2} \\Sigma_2^{1/2},')
('8', '\\left\\lVert \\cdot \\right\\rVert_{\\text{Fr}}')
('8', '\\text{Tr} \\left( \\Sigma_1 + \\Sigma_2 - 2\\left( \\Sigma_1^{1/2} \\Sigma_2 \\Sigma_1^{1/2} \\right)^{1/2}  \\right) = \\left\\lVert \\Sigma_1^{1/2} - \\Sigma_2^{1/2} \\right\\rVert_{\\text{Fr}}^2 = \\left\\lVert \\sigma_1 - \\sigma_2 \\right\\rVert^2.')
('8', 'p = \\mathcal{N}(\\mu_1, \\text{diag}(\\sigma_1^2))')
('8', 'q=\\mathcal{N}(\\mu_2, \\text{diag}(\\sigma_2^2))')
('8', 'p')
('8', 'q')
('8', '\\label{eq-w2-gaussian-diag}\nW_2(p, q) = \\left\\lVert \\mu_1 - \\mu_2 \\right\\rVert^2 + \\left\\lVert \\sigma_1 - \\sigma_2 \\right\\rVert^2.')
('8', 'p, q')
('8', '\\mathcal{H}')
('8', 'q \\ll p')
('8', 'g : \\mathcal{H}\\rightarrow \\mathbb{R}')
('8', '\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p} e^{g(h)}  < \\infty')
('8', '\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p} e^{g(h)}  \\geq e^{\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q}\\left[g(h)\\right]  - \\mathrm{KL}(q \\, || \\, p)}.')
('9', '\\mathbf{x}\\sim\\mu')
('9', 'q(h|\\mathbf{x}_i)')
('9', '\\mathbf{x}\\sim\\mu')
('9', 'q(h|\\mathbf{x})')
('9', '\\mathbf{x}')
('9', '\\mathcal{X}')
('9', '\\mu \\in \\mathcal{M}_+^1(\\mathcal{X})')
('9', '\\mathcal{H}')
('9', '\\ell: \\mathcal{H}\\times \\mathcal{X}\\rightarrow \\mathbb{R}')
('9', 'p(h) \\in \\mathcal{M}_+^1(\\mathcal{H})')
('9', '\\delta \\in (0, 1), \\lambda >0')
('9', '1-\\delta')
('9', 'S=\\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}\\sim\\mu^{\\otimes n}')
('9', 'q(h|\\mathbf{x}) \\in \\mathcal{M}_+^1(\\mathcal{H})')
('9', "\\label{eq-before-ipm-assum}\n\\begin{split}\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{  \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)} \\mathop{\\mathrm{\\mathbb{E}}}_{ \\mathbf{x}\\sim\\mu } \\ell(h, \\mathbf{x})     \\right\\}    }  \\leq\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{h \\sim q(h|\\mathbf{x}_i)} \\ell(h, \\mathbf{x}_i)   \\right\\}    } +\n   \\frac{1}{\\lambda} \\left[ \\sum_{i=1}^{n}{\\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))  }  \n+   \\right. \\\\  \\left.\n\\log \\frac{1}{\\delta} + n \\log  \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}   \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}'\\sim\\mu}\\left[\\ell(h, \\mathbf{x}')\\right] -   \\ell(h, \\mathbf{x})    \\right)         \\right]          \\right].    \n\\end{split}")
('9', 'H=\\{ h_1, \\dots, h_n \\} \\sim p(h)^{\\otimes n}')
('9', 'p(h)')
('9', 'Y')
('9', 'Y \\stackrel{\\text{def}}{=}\\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]  ,')
('9', '1-\\delta')
('9', 'S\\sim\\mu^{\\otimes n}')
('9', 'Y \\leq \\frac{1}{\\delta}\\mathop{\\mathrm{\\mathbb{E}}}_{}\\left[Y\\right]')
('9', '\\label{eq-after-markov}\n\\begin{split}\n  &\\hspace{-2.3cm}\\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]    \n\\leq \\\\\n&\\frac{1}{\\delta}\\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]           .\n\\end{split}')
('9', '\\setlength{\\jot}{10pt}\n\\begin{split}\n    & \\phantom{bbb} \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]     \\\\\n     & =   \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}}  \\prod_{i=1}^{n}{\\textnormal{exp}\\left[ \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)    \\right)         \\right]  }              \\\\\n    & = \\prod_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{h_i\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)    \\right)         \\right]       }           \\\\\n    & = \\prod_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)    \\right)         \\right]       }           \\\\\n    & \\geq  \\prod_{i=1}^{n}{  \\textnormal{exp}\\left[  \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)}\\left[ \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)    \\right)   \\right]  - \\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))    \\right]  }      ,\n\\end{split}')
('9', '\\setlength{\\jot}{10pt}\n\\begin{split}\n    & \\phantom{bbb} \\log  \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]     \\\\\n    & \\geq \\log \\prod_{i=1}^{n}{  \\textnormal{exp}\\left[  \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)}\\left[ \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)    \\right)   \\right]  - \\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))     \\right]  }  \\\\\n    & = \\sum_{i=1}^{n}{ \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)}\\left[ \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)    \\right)   \\right]  - \\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))   \\right) }\\\\\n    & = \\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)}\\left[ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)     \\right] } - \\sum_{i=1}^{n}{ \\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))  }.\n\\end{split}')
('9', '\\label{eq-after-change-measure}\n\\begin{split}\n\\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)}\\left[ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)     \\right] } - \\sum_{i=1}^{n}{ \\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))  } \n\\leq  \\\\\n\\log \\frac{1}{\\delta}\\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]           .\n\\end{split}')
('9', 'p(h)^{\\otimes n}')
('9', 'p(h)')
('9', "\\setlength{\\jot}{10pt}\n\\begin{split}\n    & \\phantom{bbb} \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]     \\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\prod_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)    \\right)         \\right]       }           \\\\\n    & =  \\prod_{i=1}^{n}{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}_i \\sim\\mu}   \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h, \\mathbf{x})\\right] -   \\ell(h, \\mathbf{x}_i)    \\right)         \\right]       }        \\\\\n    & =  \\prod_{i=1}^{n}{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}   \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}'\\sim\\mu}\\left[\\ell(h, \\mathbf{x}')\\right] -   \\ell(h, \\mathbf{x})    \\right)         \\right]       }   \\\\\n    & = \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}   \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}'\\sim\\mu}\\left[\\ell(h, \\mathbf{x}')\\right] -   \\ell(h, \\mathbf{x})    \\right)         \\right]         \\right)^n\n    .\n\\end{split}")
('9', "\\begin{split}\n\\hspace{-3cm}\\log \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{H\\sim p(h)^{\\otimes n}} \\textnormal{exp}\\left[  \\frac{\\lambda}{n} \\sum_{i=1}^{n}{  \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell(h_i, \\mathbf{x})\\right] -   \\ell(h_i, \\mathbf{x}_i)      \\right\\}  }        \\right]      =\n\\\\\n\\hspace{2cm} n \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}   \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   \\textnormal{exp}\\left[  \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}'\\sim\\mu}\\left[\\ell(h, \\mathbf{x}')\\right] -   \\ell(h, \\mathbf{x})    \\right)         \\right]      .  \n\\end{split}")
('9', 'n')
('9', 'n')
('9', 'q(h|\\mathbf{x}_1), \\dots, q(h|\\mathbf{x}_n)')
('9', 'n')
('9.0', '\\mathbf{x}\\sim\\mu')
('9.0', 'q(h|\\mathbf{x}_i), 1\\leq i \\leq n')
('9.0', 'q(h|\\mathbf{x}_i)')
('9.0', 'q(h|\\mathbf{x})')
('9.0', 'K>0')
('9.0', '1-\\delta')
('9.0', "\\label{eq-app-after-ipm-assum}\n\\begin{split}\n\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x})} \\ell(h, \\mathbf{x})   - \\frac{1}{n}  \\sum_{i=1}^{n}{ \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)} \\ell(h, \\mathbf{x}_i)   }  \n  \\leq \\frac{1}{\\lambda} \\left[ \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q(h|\\mathbf{x}_i) \\, || \\, p(h))  }  \n+ \\frac{\\lambda K}{n} \\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[d(\\mathbf{x}, \\mathbf{x}_i)\\right]} + \\right.\n\\\\  \\left.\n\\log \\frac{1}{\\delta} + n \\log  \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}   \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim p(h)}   e^{ \\frac{\\lambda}{n}  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}'\\sim\\mu}\\left[\\ell(h, \\mathbf{x}')\\right] -   \\ell(h, \\mathbf{x})    \\right)     }        \\right].    \n\\end{split}")
('9.0', '\\mathbf{x}_i \\in S, \\mathbf{x}\\in \\mathcal{X}')
('9.0', '\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x})} \\ell(h, \\mathbf{x})  - \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)} \\ell(h, \\mathbf{x})   \\leq d_{\\mathcal{E}} (q(h|\\mathbf{x}), q(h|\\mathbf{x}_i)) \\leq K d(\\mathbf{x}, \\mathbf{x}_i).')
('9.0', '\\sum_{i=1}^{n}{  \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_i)} \\mathop{\\mathrm{\\mathbb{E}}}_{ \\mathbf{x}\\sim\\mu } \\ell(h, \\mathbf{x})        }  = \\sum_{i=1}^{n}{  \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\mathop{\\mathrm{\\mathbb{E}}}_{ h\\sim q(h|\\mathbf{x}_i) } \\ell(h, \\mathbf{x}) \\right] }  \\geq\n\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x})} \\ell(h, \\mathbf{x})  - Kd(\\mathbf{x}, \\mathbf{x}_i)   \\right]} .')
('10.0', 'K_\\phi')
('10.0', 'K_\\theta')
('10.0', 'K_\\phi')
('10.0', 'K_\\theta')
('10.0', '\\label{eq-app-ipm-df}\nd_{\\mathcal{E}}\\left( q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2)  \\right) \\leq K_\\phi K_\\theta\\left\\lVert  \\mathbf{x}_1 - \\mathbf{x}_2  \\right\\rVert,')
('10.0', '\\label{eq-app-ipm-loss}\n\\ell(\\cdot, \\mathbf{x}) \\in \\mathcal{E}, \\quad \\text{for any } \\mathbf{x}\\in \\mathcal{X}.')
('10.0', '\\mathcal{E}= \\text{\\rm Lip}_{K_\\theta} (\\mathcal{Z}, \\mathbb{R})')
('10.0', 'K_\\theta')
('10.0', '\\mathcal{Z}')
('10.0', 'q_\\phi(\\mathbf{z}| \\mathbf{x}_i) = \\mathcal{N}(\\mu_\\phi\\left( \\mathbf{x}_i  \\right), \\text{diag}(\\sigma_\\phi^2\\left( \\mathbf{x}_i  \\right)))')
('10.0', 'W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2))')
('10.0', 'W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2))^2 = \\left\\lVert  \\mu_\\phi\\left( \\mathbf{x}_1  \\right) -\\mu_\\phi\\left( \\mathbf{x}_2  \\right)  \\right\\rVert^2  + \\left\\lVert  \\sigma_\\phi\\left( \\mathbf{x}_1  \\right)  - \\sigma_\\phi\\left( \\mathbf{x}_2  \\right)   \\right\\rVert^2,')
('10.0', 'Q_\\phi \\left( \\mathbf{x}  \\right) = \\begin{bmatrix}\n   \\mu_\\phi\\left( \\mathbf{x}  \\right) \\\\\n   \\sigma_\\phi\\left( \\mathbf{x}  \\right) \n \\end{bmatrix}')
('10.0', '\\left\\lVert  Q_\\phi \\left( \\mathbf{x}_1  \\right) - Q_\\phi \\left( \\mathbf{x}_2  \\right)  \\right\\rVert^2 =  W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2))^2 .')
('10.0', 'Q_\\phi')
('10.0', 'K_\\phi')
('10.0', '\\left\\lVert  Q_\\phi \\left( \\mathbf{x}_1  \\right) - Q_\\phi \\left( \\mathbf{x}_2  \\right)  \\right\\rVert \\leq K_\\phi\\left\\lVert  \\mathbf{x}_1 - \\mathbf{x}_2  \\right\\rVert')
('10.0', '\\label{eq-app-w2}\nW_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2)) \\leq K_\\phi\\left\\lVert  \\mathbf{x}_1 - \\mathbf{x}_2  \\right\\rVert.')
('10.0', '\\mathcal{E}= \\text{\\rm Lip}_{K_\\theta} (\\mathcal{Z}, \\mathbb{R})')
('10.0', 'd_{\\mathcal{E}}( q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2) ) = K_\\theta W_1(q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2)).')
('10.0', 'W_1 \\leq W_2')
('10.0', 'd_{\\mathcal{E}}( q_\\phi(\\mathbf{z}| \\mathbf{x}_1), q_\\phi(\\mathbf{z}| \\mathbf{x}_2) ) \\leq K_\\theta K_\\phi\\left\\lVert  \\mathbf{x}_1 - \\mathbf{x}_2  \\right\\rVert.')
('10.0', '\\ell(\\cdot, \\mathbf{x}) \\in \\text{\\rm Lip}_{K_\\theta} (\\mathcal{Z}, \\mathbb{R})')
('10.0', '\\mathbf{x}\\in \\mathcal{X}')
('10.0', '\\mathbf{z}_1, \\mathbf{z}_2 \\in \\mathcal{Z}')
('10.0', '\\setlength{\\jot}{10pt}\n\\begin{split}\n\\ell(\\mathbf{z}_1, \\mathbf{x}) - \\ell(\\mathbf{z}_2, \\mathbf{x}) & = \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z}_1 ) \\right\\rVert - \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z}_2 ) \\right\\rVert           \\\\\n    & = \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z}_1 ) +g_\\theta( \\mathbf{z}_2 ) - g_\\theta( \\mathbf{z}_2 ) \\right\\rVert - \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z}_2 ) \\right\\rVert             \\\\\n    & \\leq \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z}_2 ) \\right\\rVert + \\left\\lVert g_\\theta( \\mathbf{z}_2 ) - g_\\theta( \\mathbf{z}_1 ) \\right\\rVert - \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z}_2 ) \\right\\rVert          \\\\\n    & =   \\left\\lVert g_\\theta( \\mathbf{z}_2 ) - g_\\theta( \\mathbf{z}_1 ) \\right\\rVert         \\\\\n    & \\leq K_\\theta\\left\\lVert \\mathbf{z}_1 - \\mathbf{z}_2 \\right\\rVert,          \n\\end{split}')
('10.0', 'g_\\theta')
('10.1', "\\label{eq-app-diam}\n\\sup_{\\mathbf{x}, \\mathbf{x}' \\in \\mathcal{X}} d(\\mathbf{x}, \\mathbf{x}') = \\Delta < \\infty.")
('10.1', '\\label{eq-app-avg-bounded}\n\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) } \\leq \nn\\Delta')
('10.1', "\\label{eq-app-expon-bounded}\nn \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right)     \\right]   \\leq \n\\frac{\\lambda^2 \\Delta^2}{8n}.")
('10.1', '\\Delta')
('10.1', '\\mathbf{z}\\in \\mathcal{Z}')
('10.1', '\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) = \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z} ) \\right\\rVert = d(\\mathbf{x}, g_\\theta( \\mathbf{z} ))')
('10.1', '\\mathbf{x}')
('10.1', 'g_\\theta( \\mathbf{z} )')
('10.1', '\\Delta')
('10.1', '\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\in [0, \\Delta]')
('10.1', '\\mathbf{x}\\in \\mathcal{X}')
('10.1', '\\ell_i = \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i) \\in [0, \\Delta]')
('10.1', "\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}   \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}'\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')\\right] - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})    \\right)    \\right]        \\leq \\textnormal{exp}\\left[ \\frac{\\lambda^2 \\Delta^2}{8n^2}    \\right].")
('10.1', "n \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right)     \\right]   \\leq \nn \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \n\\textnormal{exp}\\left[ \\frac{\\lambda^2 \\Delta^2}{8n^2}    \\right]  = \n\\frac{\\lambda^2 \\Delta^2}{8n}.")
('10.2', '\\mu = {g^*} \\sharp p^*')
('10.2', 'p^*= \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('10.2', '\\mathbb{R}^{d^*}')
('10.2', 'g^*\\in \\text{\\rm Lip}_{K_*} (\\mathbb{R}^{d^*}, \\mathcal{X})')
('10.2', "\\label{eq-app-expon-manif}\nn \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right)     \\right]   \\leq \n\\frac{\\lambda^2 K_*^2}{2n}.")
('10.2', "n \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right)     \\right]   \\leq \n\\frac{\\lambda^2 K_*^2}{2n}.")
('10.2', '\\mu = {g^*} \\sharp p^*')
('10.2', 'p^*')
('10.2', '\\mathbb{R}^{d^*}')
('10.2', 'g^*')
('10.2', 'K_*')
('10.2', '\\ell_\\text{rec}^\\theta')
('10.2', "\\setlength{\\jot}{10pt}\n\\begin{split}\n &  \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right)     \\right]    \\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\left\\lVert  \\mathbf{x}' - g_\\theta( \\mathbf{z} ) \\right\\rVert  - \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z} ) \\right\\rVert \\right)     \\right]  .     \\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}' \\sim p^*} \\left\\lVert  g^*(\\mathbf{w}') - g_\\theta( \\mathbf{z} ) \\right\\rVert  - \\left\\lVert  g^*(\\mathbf{w}) - g_\\theta( \\mathbf{z} ) \\right\\rVert \\right)     \\right]          \\\\\n    & \\stackrel{(*)}{\\leq}\\textnormal{exp}\\left[ \\frac{\\lambda^2 K_*^2}{2n^2}       \\right]     . \n    \\end{split}")
('10.2', "n \\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\textnormal{exp}\\left[ \\frac{\\lambda}{n} \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}' \\sim\\mu} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}')  - \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) \\right)     \\right]   \\leq \n\\frac{\\lambda^2 K_*^2}{2n}.")
('10.2', '\\stackrel{(*)}{\\leq}')
('10.2', '\\alpha \\in \\mathcal{X}')
('10.2', 'f : \\mathbb{R}^{d^*}\\rightarrow \\mathbb{R}')
('10.2', 'f(\\mathbf{w}) = \\left\\lVert g^*(\\mathbf{w}) - \\alpha \\right\\rVert.')
('10.2', 'g^* \\in \\text{\\rm Lip}_{K_*} (\\mathbb{R}^{d^*}, \\mathcal{X})')
('10.2', 'f')
('10.2', 'K_*')
('10.2', '\\mathbf{w}_1, \\mathbf{w}_2 \\in \\mathbb{R}^{d^*}')
('10.2', '\\setlength{\\jot}{10pt}\n\\begin{split}\nf(\\mathbf{w}_1) - f(\\mathbf{w}_2) & =   \\left\\lVert g^*(\\mathbf{w}_1) - \\alpha \\right\\rVert - \\left\\lVert g^*(\\mathbf{w}_2) - \\alpha \\right\\rVert           \\\\\n    & =   \\left\\lVert g^*(\\mathbf{w}_1) - \\alpha + g^*(\\mathbf{w}_2) - g^*(\\mathbf{w}_2) \\right\\rVert - \\left\\lVert g^*(\\mathbf{w}_2) - \\alpha \\right\\rVert           \\\\\n    & \\leq  \\left\\lVert g^*(\\mathbf{w}_1) - g^*(\\mathbf{w}_2) \\right\\rVert + \\left\\lVert g^*(\\mathbf{w}_2) - \\alpha \\right\\rVert - \\left\\lVert g^*(\\mathbf{w}_2) - \\alpha \\right\\rVert             \\\\\n    & =  \\left\\lVert g^*(\\mathbf{w}_1) - g^*(\\mathbf{w}_2) \\right\\rVert         \\\\\n    &  \\leq  K_*\\left\\lVert \\mathbf{w}_1 - \\mathbf{w}_2 \\right\\rVert          \\\\\n\\end{split}')
('10.2', 'f')
('10.2', 'K_*')
('10.2', '\\mathbf{z}')
('10.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{}  e^{\\lambda(\\mathop{\\mathrm{\\mathbb{E}}}_{} [f(\\mathbf{z})]  - f(\\mathbf{z})   )}      \\leq e^{\\frac{\\lambda^2 K_*^2}{2}}.')
('10.2', "\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}_i \\sim p^*}\\left[ \\textnormal{exp}\\left[ \\frac{\\lambda}{n}  \\left(  \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}' \\sim p^*}\\left[\\left\\lVert g^*(\\mathbf{w}') - g_\\theta( \\mathbf{z} )   \\right\\rVert\\right] - \\left\\lVert g^*(\\mathbf{w}_i) - g_\\theta( \\mathbf{z} ) \\right\\rVert   \\right)          \\right]  \\right]  \\leq \\textnormal{exp}\\left[ \\frac{\\lambda^2 K_*^2}{2n^2}    \\right],")
('10.2', '\\stackrel{(*)}{\\leq}')
('10.2', '1 -\\frac{n{d^*}}{2}e^{\\frac{-a^2}{2}}')
('10.2', 'S')
('10.2', '\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) } \\leq \nn K_*\\sqrt{(1 + a^2){d^*}}')
('10.2', 'S = \\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\} \\stackrel{\\text{iid}}{\\sim}\\mu')
('10.2', '1 \\leq i \\leq n')
('10.2', '\\mathbf{w}_i \\sim p^*')
('10.2', '\\mathbf{x}_i  = g^*(\\mathbf{w}_i)')
('10.2', 'a>0')
('10.2', 'p^*')
('10.2', '\\underset{}{\\mathbb{P}}\\left[\\forall i, \\mathbf{w}_i \\in [-a, a]^{d^*}\\right] = \\left(\\text{erf}\\left(\\frac{a}{\\sqrt{2}} \\right) \\right)^{n {d^*}},')
('10.2', '\\text{erf}\\left(\\cdot \\right)')
('10.2', '\\text{erf}\\left(\\frac{a}{\\sqrt{2}} \\right)  \\geq \\sqrt{1-e^{\\frac{-a^2}{2}}},')
('10.2', '\\label{eq-app-confidence}\n\\underset{}{\\mathbb{P}}\\left[\\forall i, \\mathbf{w}_i \\in [-a, a]^{d^*}\\right] \\geq \\left( 1-e^{\\frac{-a^2}{2}}  \\right)^{n{d^*}/2} \\geq 1 -\\frac{n{d^*}}{2}e^{\\frac{-a^2}{2}}.')
('10.2', '\\mathbf{w}_i \\in [-a, a]^{d^*}')
('10.2', '1\\leq i \\leq n')
('10.2', '\\label{eq-app-avg-manif}\n\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) } \\leq \nn K_*\\sqrt{(1 + a^2){d^*}}')
('10.2', '\\label{eq-app-lipketoil}\n\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i)  = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\left\\lVert \\mathbf{x}- \\mathbf{x}_i \\right\\rVert  = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} \\left\\lVert g^*(\\mathbf{w})- g^*(\\mathbf{w}_i) \\right\\rVert  \\leq K_*\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} \\left\\lVert \\mathbf{w}- \\mathbf{w}_i \\right\\rVert ,')
('10.2', 'g^*\\in \\text{\\rm Lip}_{K_*} (\\mathbb{R}^{d^*}, \\mathcal{X})')
('10.2', '\\left\\lVert \\mathbf{w}- \\mathbf{w}_i \\right\\rVert^2')
('10.2', '\\chi^2')
('10.2', '{d^*}')
('10.2', '\\left\\lVert \\mathbf{w}_i \\right\\rVert^2')
('10.2', '\\mathbf{w}_i \\in [-a, a]^{d^*}')
('10.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} \\left\\lVert \\mathbf{w}- \\mathbf{w}_i \\right\\rVert  \\leq \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} \\left\\lVert \\mathbf{w}- \\mathbf{w}_i \\right\\rVert^2   \\right)^{1/2}\n= \\left( {d^*}+ \\left\\lVert \\mathbf{w}_i \\right\\rVert^2  \\right)^{1/2} \\leq \\left( {d^*}+ a^2{d^*}\\right)^{1/2}.')
('10.2', '\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} \\left\\lVert \\mathbf{x}- \\mathbf{x}_i \\right\\rVert  \\leq K_*\\sqrt{(1 + a^2){d^*}}')
('10.2', '1-\\delta -\\frac{n{d^*}}{2}e^{\\frac{-a^2}{2}}')
('10.2', '1- \\delta')
('10.2', '1 -\\frac{n{d^*}}{2}e^{\\frac{-a^2}{2}}')
('10.2', 'p^*')
('10.2', '[0, 1]^{d^*}')
('10.2', '[0, 1]^{d^*}')
('10.2', '\\mathbb{R}^{d^*}')
('10.2', '\\mathcal{X}')
('10.2', '\\mathcal{Z}')
('10.2', 'p(\\mathbf{z})  \\in \\mathcal{M}_+^1(\\mathcal{Z})')
('10.2', '\\theta')
('10.2', '\\delta \\in (0, 1), \\lambda >0, a>0')
('10.2', '\\mu = {g^*} \\sharp p^*')
('10.2', 'p^*= \\mathcal{U}([0, 1]^{d^*})')
('10.2', '[0, 1]^{d^*}')
('10.2', 'g^*\\in \\text{\\rm Lip}_{K_*} (\\mathbb{R}^{d^*}, \\mathcal{X})')
('10.2', 'K_*')
('10.2', '1 - \\delta')
('10.2', 'S')
('10.2', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('10.2', '\\begin{split}\n \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu } \\mathop{\\mathrm{\\mathbb{E}}}_{q_\\phi(\\mathbf{z}|\\mathbf{x})  } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})        -\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  \\leq \\frac{1}{\\lambda} \\left( \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + \\right. \\\\\n   \\lambda K_\\phi K_\\theta K_*\\sqrt{{d^*}}  +  \\left.\n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 K_*^2}{2n} \\right).\n\\end{split}')
('10.2', '\\{ \\mathbf{w}_1, \\dots, \\mathbf{w}_n \\} \\subseteq [0, 1]^{d^*}')
('10.2', '1\\leq i \\leq n')
('10.2', '\\mathbf{x}_i = g^*(\\mathbf{w}_i)')
('10.2', '[0, 1]^{d^*}')
('10.2', '\\sqrt{{d^*}}')
('10.2', '\\mu')
('10.2', 'g^*')
('10.2', '\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu} d(\\mathbf{x}, \\mathbf{x}_i) } = \n\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} d(g^*(\\mathbf{w}), g^*(\\mathbf{w}_i))   } \\leq\nK_*\\sum_{i=1}^{n}{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{w}\\sim p^*} \\left\\lVert \\mathbf{w}- \\mathbf{w}_i \\right\\rVert   } \\leq n K_*\\sqrt{{d^*}}.')
('10.2', '1-\\delta')
('11', '\\hat{\\mu}_{\\phi, \\theta}')
('11', '\\hat{\\mu}_{\\phi, \\theta}= \\frac{1}{n} \\sum_{i=1}^{n}{{g_\\theta} \\sharp q_\\phi(\\mathbf{z}| \\mathbf{x}_i)}   .')
('11', '\\label{eq-app-triangle-mu}\nW_1(\\mu, {g_\\theta} \\sharp p(\\mathbf{z})) \\leq W_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) + W_1(\\hat{\\mu}_{\\phi, \\theta}, {g_\\theta} \\sharp p(\\mathbf{z})).')
('11', '1-\\delta')
('11', 'S\\sim\\mu^{\\otimes n}')
('11', '\\begin{split}\n\\lambda W_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq \\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q(\\mathbf{z}|\\mathbf{x}_i)} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right)    } \n  + \\sum_{i=1}^{n}{\\mathrm{KL}(q(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  \n+  \\\\\n\\log \\frac{1}{\\delta} + \\log \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} e^{ \\lambda  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})\\right] -  \\frac{1}{n} \\sum_{i=1}^{n}{ \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)}      \\right)  }              .   \n\\end{split}')
('11', 'W_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) =    \\inf_{\\pi \\in \\Gamma(\\mu, \\hat{\\mu}_{\\phi, \\theta})}  \\int_{\\mathcal{X}\\times \\mathcal{X}}^{ }  \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert  \\,d\\pi(\\mathbf{x}, \\mathbf{y})')
('11', 'W_1 (\\mu, \\hat{\\mu}_{\\phi, \\theta})')
('11', '\\begin{aligned}\nW_1(\\mu, \\hat{\\mu}_{\\phi, \\theta})\n    & \\leq   \\int_{\\mathcal{X}\\times \\mathcal{X}}^{ }  \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert  \\,  d\\mu(\\mathbf{x}) d\\hat{\\mu}_{\\phi, \\theta}(\\mathbf{y})             \\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{y}\\sim\\hat{\\mu}_{\\phi, \\theta}} \\, \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}  \\left\\lVert \\mathbf{x}-\\mathbf{y} \\right\\rVert               .\n\\end{aligned}')
('11', '\\hat{\\mu}_{\\phi, \\theta}')
('11', '\\begin{aligned}\nW_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq\n \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{y}\\sim\\hat{\\mu}_{\\phi, \\theta}} \\, \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}  \\left\\lVert  \\mathbf{x}-\\mathbf{y}  \\right\\rVert         \n & = \n\\frac{1}{n} \\sum_{i=1}^{n}{\\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q_\\phi(\\mathbf{z}| \\mathbf{x}_i)} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}  \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z} )  \\right\\rVert         \\right) }  \\\\\n& = \n \\frac{1}{n} \\sum_{i=1}^{n}{\\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q_\\phi(\\mathbf{z}| \\mathbf{x}_i)} \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}  \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})         \\right) } .\n\\end{aligned}')
('11', '\\mathcal{H}= \\mathcal{Z}')
('11', '\\ell= \\ell_\\text{rec}^\\theta')
('11', '1-\\delta')
('11', 'S\\sim\\mu^{\\otimes n}')
('11', '\\label{eq-use-lemma-before-ipm}\n\\begin{split}\n \\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\left(  \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q(\\mathbf{z}|\\mathbf{x}_i)} \\mathop{\\mathrm{\\mathbb{E}}}_{ \\mathbf{x}\\sim\\mu } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})     \\right)    }  \\leq\n \\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q(\\mathbf{z}|\\mathbf{x}_i)} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right)    } \n  + \\sum_{i=1}^{n}{\\mathrm{KL}(q(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  \n+  \\\\\n\\log \\frac{1}{\\delta} + \\log \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} e^{ \\lambda  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})\\right] -  \\frac{1}{n} \\sum_{i=1}^{n}{ \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)}      \\right)  }              .    \n\\end{split}')
('11', 'W_1(\\hat{\\mu}_{\\phi, \\theta}, {g_\\theta} \\sharp p(\\mathbf{z})) \\leq \\frac{K_\\theta}{n} \\sum_{i=1}^{n}{ \\sqrt{ \\left\\lVert  \\mu_\\phi\\left( \\mathbf{x}_i  \\right)  \\right\\rVert^2 + \\left\\lVert  \\sigma_\\phi\\left( \\mathbf{x}_i  \\right)  - \\Vec{1}  \\right\\rVert^2} } ,')
('11', '\\Vec{1}\\in \\mathbb{R}^{d_\\mathcal{Z}}')
('11', '1')
('11', '\\hat{q}_\\phi(\\mathbf{z}) = \\frac{1}{n}\\sum_{i=1}^{n}{q_\\phi(\\mathbf{z}| \\mathbf{x}_i)},')
('11', '\\hat{\\mu}_{\\phi, \\theta}')
('11', '\\hat{\\mu}_{\\phi, \\theta}= \\frac{1}{n} \\sum_{i=1}^{n}{{g_\\theta} \\sharp q_\\phi(\\mathbf{z}| \\mathbf{x}_i)}  = {g_\\theta} \\sharp \\hat{q}_\\phi(\\mathbf{z}).')
('11', '\\setlength{\\jot}{10pt}\n\\begin{split}\nW_1(\\hat{\\mu}_{\\phi, \\theta}, {g_\\theta } \\sharp p(\\mathbf{z}))    & = W_1\\left(   {g_\\theta} \\sharp \\hat{q}_\\phi(\\mathbf{z})  , {g_\\theta} \\sharp p(\\mathbf{z})  \\right)          \\\\\n    & =   \\sup_{f \\in \\text{\\rm Lip}_{1} (\\mathcal{X}, \\mathbb{R})}\\left[  \\int_{\\mathcal{Z}}^{} f\\circ g_\\theta (\\mathbf{z}) \\,d\\hat{q}_\\phi(\\mathbf{z})  -  \\int_{\\mathcal{Z}}^{} f\\circ g_\\theta (\\mathbf{z}) \\,dp(\\mathbf{z})  \\right]           \\\\\n    & =  \\sup_{g \\in \\mathcal{G}_\\theta}\\left[  \\int_{\\mathcal{Z}}^{} g (\\mathbf{z}) \\,d\\hat{q}_\\phi(\\mathbf{z})  -  \\int_{\\mathcal{Z}}^{} g (\\mathbf{z}) \\,dp(\\mathbf{z})  \\right]          \\\\\n    & \\leq  \\sup_{g \\in \\text{\\rm Lip}_{K_\\theta} (\\mathcal{Z}, \\mathbb{R})}\\left[  \\int_{\\mathcal{Z}}^{} g (\\mathbf{z}) \\,d\\hat{q}_\\phi(\\mathbf{z})  -  \\int_{\\mathcal{Z}}^{} g (\\mathbf{z}) \\,dp(\\mathbf{z})  \\right]          \\\\\n    & =  K_\\theta W_1(\\hat{q}_\\phi(\\mathbf{z}), p(\\mathbf{z}))  ,\n\\end{split}')
('11', '\\mathcal{G}_\\theta = \\{ g: \\mathcal{Z}\\rightarrow \\mathbb{R}\\,\\text{ s.t. } g=f\\circ g_\\theta \\text{ and } f\\in \\text{\\rm Lip}_{1} (\\mathcal{X}, \\mathbb{R}) \\}')
('11', '\\mathcal{G}_\\theta \\subseteq \\text{\\rm Lip}_{K_\\theta} (\\mathcal{Z}, \\mathbb{R})')
('11', 'g_\\theta: \\mathcal{Z}\\rightarrow \\mathcal{X}')
('11', 'K_\\theta')
('11', '(p, q) \\mapsto W_1(p, q)')
('11', '\\hat{q}_\\phi(\\mathbf{z})')
('11', '\\label{eq-w1-w2-qhat}\n W_1(\\hat{q}_\\phi(\\mathbf{z}), p(\\mathbf{z}))  \\leq \\frac{1}{n}\\sum_{i=1}^{n}{W_1(q_\\phi(\\mathbf{z}| \\mathbf{x}_i), p(\\mathbf{z}))} \\leq \n \\frac{1}{n}\\sum_{i=1}^{n}{W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_i), p(\\mathbf{z}))}.')
('11', 'W_2(q_\\phi(\\mathbf{z}| \\mathbf{x}_i), p(\\mathbf{z}))^2 = \\left\\lVert  \\mu_\\phi\\left( \\mathbf{x}_i  \\right)  \\right\\rVert^2 + \\left\\lVert  \\sigma_\\phi\\left( \\mathbf{x}_i  \\right)  - \\Vec{1}  \\right\\rVert^2,')
('11', 'W_1(\\hat{\\mu}_{\\phi, \\theta}, {g_\\theta } \\sharp p(\\mathbf{z})) \\leq \\frac{K_\\theta}{n} \\sum_{i=1}^{n}{ \\sqrt{ \\left\\lVert  \\mu_\\phi\\left( \\mathbf{x}_i  \\right)  \\right\\rVert^2 + \\left\\lVert  \\sigma_\\phi\\left( \\mathbf{x}_i  \\right)  - \\Vec{1}  \\right\\rVert^2} }.')
('11.0', '1-\\delta')
('11.0', 'S\\sim\\mu^{\\otimes n}')
('11.0', '\\label{eq-app-someineq}\n\\begin{split}\n\\lambda W_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq \\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q(\\mathbf{z}|\\mathbf{x}_i)} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right)    } \n  + \\sum_{i=1}^{n}{\\mathrm{KL}(q(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  \n+  \\\\\n\\log \\frac{1}{\\delta} + \\log \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} e^{ \\lambda  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})\\right] -  \\frac{1}{n} \\sum_{i=1}^{n}{ \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)}      \\right)  }              .   \n\\end{split}')
('11.0', '\\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}   \\textnormal{exp}\\left[ \\lambda \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})\\right] - \\frac{1}{n} \\sum_{i=1}^{n}{\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)}       \\right)    \\right]        \n\\leq \n\\textnormal{exp}\\left[ \\frac{\\lambda^2 \\Delta^2}{8n}    \\right].')
('11.0', '1-\\delta')
('11.0', 'S\\sim\\mu^{\\otimes n}')
('11.0', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('11.0', '\\begin{split}\nW_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq \n\\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \n\\frac{1}{\\lambda} \\left( \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + \n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 \\Delta^2}{8n}   \\right).\n\\end{split}')
('11.2', '1-\\delta')
('11.2', 'S\\sim\\mu^{\\otimes n}')
('11.2', '\\begin{split}\n\\lambda W_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq \\frac{\\lambda}{n} \\sum_{i=1}^{n}{ \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim q(\\mathbf{z}|\\mathbf{x}_i)} \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right)    } \n  + \\sum_{i=1}^{n}{\\mathrm{KL}(q(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  \n+  \\\\\n\\log \\frac{1}{\\delta} + \\log \\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}    \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} e^{ \\lambda  \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})\\right] -  \\frac{1}{n} \\sum_{i=1}^{n}{ \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)}      \\right)  }              .   \n\\end{split}')
('11.2', '\\log \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{z}\\sim p(\\mathbf{z})} \n\\mathop{\\mathrm{\\mathbb{E}}}_{S\\sim\\mu^{\\otimes n}}   \\textnormal{exp}\\left[ \\lambda \\left( \\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu}\\left[\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})\\right] - \\frac{1}{n} \\sum_{i=1}^{n}{\\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)}  \\right)    \\right]     \\leq \n\\frac{\\lambda^2 K_*^2}{2n}.')
('11.2', '\\mathbf{z}')
('11.2', 'S')
('11.2', '1 -\\delta')
('11.2', 'S\\sim\\mu^{\\otimes n}')
('11.2', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('11.2', '\\begin{split}\nW_1(\\mu, \\hat{\\mu}_{\\phi, \\theta}) \\leq\n \\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i)   } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}    }  \n  + \\frac{1}{\\lambda} \\left( \n  \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }  + \n\\log \\frac{1}{\\delta} + \\frac{\\lambda^2 K_*^2}{2n} \\right).\n\\end{split}')
('12', '2')
('12', '\\mathbb{R}^2')
('12', '(-1, 0)')
('12', '(1, 0)')
('12', '\\sigma =0.1')
('12', '1.5')
('12', '\\sigma=0.1')
('12', 'K_\\phi= K_\\theta= 2')
('12', '\\label{eq-recall-rec-bounded}\n\\begin{split}\n \\underbrace{\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathbf{x}\\sim\\mu } \\mathop{\\mathrm{\\mathbb{E}}}_{q_\\phi(\\mathbf{z}|\\mathbf{x})  } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x})   }_\\text{Test Rec. Loss}     \n \\leq\n \\underbrace{\\frac{1}{n} \\sum_{i=1}^{n}{ \\left\\{ \\mathop{\\mathrm{\\mathbb{E}}}_{ q_\\phi(\\mathbf{z}|\\mathbf{x}_i) } \\ell_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}_i)   \\right\\}  }  }_\\text{Emp. Rec. Loss}\n  + \\underbrace{\\frac{1}{\\lambda} \\sum_{i=1}^{n}{\\mathrm{KL}(q_\\phi(\\mathbf{z}|\\mathbf{x}_i) \\, || \\, p(\\mathbf{z}))  }}_\\text{Emp. KL loss}  +   \\\\ \n   \\underbrace{K_\\phi K_\\theta\\Delta}_\\text{Avg distance}   \n+ \\underbrace{\\frac{\\lambda \\Delta^2}{8n}}_\\text{Exp. moment}  + \\frac{1}{\\lambda}\\log \\frac{1}{\\delta} .  \n\\end{split}')
('12', '\\lambda')
('12', '10.67')
('12', '\\lambda')
('12', 'n/0.01')
('12', 'n/0.025')
('12', 'n/0.05')
('12', 'n/0.075')
('12', 'n/0.1')
('12', 'n/0.25')
('12', 'n/0.5')
('12', 'n/0.75')
('12', 'n/1')
('12', '15.2')
('12', '\\lambda')
('12', 'n/0.01')
('12', 'n/0.025')
('12', 'n/0.05')
('12', 'n/0.075')
('12', 'n/0.1')
('12', 'n/0.25')
('12', 'n/0.5')
('12', 'n/0.75')
('12', 'n/1')
('12', '\\lambda')
('12', 'n')
('13.0', 'g_\\theta: \\mathcal{Z}\\rightarrow \\mathcal{X}')
('13.0.0', '\\sigma')
('13.0.0', '\\sigma \\propto \\frac{n}{\\lambda}')
('13.0.0', '\\lambda')
('13.0.0', '\\sigma')
('13.0.0', '\\lambda')
('13.0.0', '\\lambda')
('13.0.0', '\\lambda')
('13.0.0', '[0, 1]')
('13.0.0', "\\lambda'")
('13.0.0', "\\lambda'")
('13.0.0', '\\lambda \\in \\Lambda')
('13.0.0', '\\left \\lvert \\Lambda \\right \\rvert')
('13.0.0', '\\lambda')
('13.0.0', '\\log \\left \\lvert \\Lambda \\right \\rvert')
('13.0.0', '\\Lambda')
('13.0.0', '\\Lambda \\cap \\{ 1, \\dots, n \\}')
('13.0.0', '\\log n')
('13.0.0', '\\Lambda \\cap \\{ e^{k}: 1 \\leq k \\leq n \\}')
('13.0.0', '\\log \\log n')
('13.0.0.0', '\\ell_\\theta(\\mathbf{z}, \\mathbf{x}) = \\frac{1}{\\sigma_\\theta(\\mathbf{z})} \\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z} ) \\right\\rVert')
('13.0.0.0', '\\sigma_\\theta : \\mathcal{Z}\\rightarrow \\mathbb{R}_{> 0}')
('13.0.0.0', '\\sigma_\\theta(\\mathbf{z})')
('13.0.0.0', '\\sigma_1 > 0')
('13.0.0.0', '\\sigma_\\theta(\\mathbf{z}) > \\sigma_1')
('13.0.0.0', '\\mathbf{z}\\in \\mathcal{Z}')
('13.0.0.0', '\\ell_\\theta')
('13.0.0.0', '\\ell_\\theta')
('13.0.0.0', '\\left\\lVert \\mathbf{x}- g_\\theta( \\mathbf{z} ) \\right\\rVert \\leq M < \\infty')
('13.0.0.0', 'K = K_\\phi \\left( \\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1} \\right)')
('13.0.0.0', '\\phi')
('13.0.0.0', '\\theta')
('13.0.0.0', 'K_\\phi, K_\\theta\\in \\mathbb{R}')
('13.0.0.0', 'l_\\text{rec}^\\theta: \\mathcal{Z}\\times \\mathcal{X}\\rightarrow \\mathbb{R}')
('13.0.0.0', 'l_\\text{rec}^\\theta(\\mathbf{z}, \\mathbf{x}) = \\frac{1}{\\sigma_\\theta(\\mathbf{z})} \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z} )  \\right\\rVert')
('13.0.0.0', '\\sigma_\\theta : \\mathcal{Z}\\rightarrow \\mathbb{R}_{>0}')
('13.0.0.0', 'K_\\sigma')
('13.0.0.0', '\\mathbf{z}\\in \\mathcal{Z}')
('13.0.0.0', '\\sigma_\\theta(\\mathbf{z}) > \\sigma_1')
('13.0.0.0', '\\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z} )  \\right\\rVert \\leq M')
('13.0.0.0', '0 < \\sigma_1 < 1')
('13.0.0.0', 'M > 0')
('13.0.0.0', 'q_\\phi(\\mathbf{z}| \\mathbf{x})')
('13.0.0.0', '\\mathcal{E}= \\{ f: \\mathcal{Z}\\rightarrow \\mathbb{R}: \\left\\lVert  f  \\right\\rVert_\\textrm{Lip} \\leq \\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1} \\}')
('13.0.0.0', 'K = K_\\phi\\left( \\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1} \\right)')
('13.0.0.0', '\\ell= l_\\text{rec}^\\theta')
('13.0.0.0', '\\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1} > K_\\theta')
('13.0.0.0', 'l_\\text{rec}^\\theta')
('13.0.0.0', '\\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1}')
('13.0.0.0', '\\left \\lvert  \\frac{1}{\\sigma_\\theta(\\mathbf{z}_1)} - \\frac{1}{\\sigma_\\theta(\\mathbf{z}_2)}  \\right \\rvert = \\left \\lvert \\frac{\\sigma_\\theta(\\mathbf{z}_2) - \\sigma_\\theta(\\mathbf{z}_1)}{\\sigma_\\theta(\\mathbf{z}_1) \\sigma_\\theta(\\mathbf{z}_2)} \\right \\rvert \\leq \\frac{K_\\sigma \\left\\lVert  \\mathbf{z}_1 - \\mathbf{z}_2  \\right\\rVert}{\\sigma_1^2}.')
('13.0.0.0', '\\begin{aligned}\n\\setlength{\\jot}{10pt}\n\\begin{split}\n\\left \\lvert l_\\text{rec}^\\theta(\\mathbf{z}_1, \\mathbf{x}) - l_\\text{rec}^\\theta(\\mathbf{z}_2, \\mathbf{x} \\right \\rvert \n    & =  \\left \\lvert \\frac{1}{\\sigma_\\theta(\\mathbf{z}_1)} \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z}_1 )  \\right\\rVert - \\frac{1}{\\sigma_\\theta(\\mathbf{z}_2)} \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z}_2 )  \\right\\rVert     \\right \\rvert      \\\\\n    & =  \\left \\lvert \\frac{1}{\\sigma_\\theta(\\mathbf{z}_1)} - \\frac{1}{\\sigma_\\theta(\\mathbf{z}_2) }   \\right \\rvert \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z}_1 )  \\right\\rVert  + \n    \\frac{1}{\\sigma_\\theta(\\mathbf{z}_2) } \\left \\lvert  \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z}_1 )  \\right\\rVert -  \\left\\lVert  \\mathbf{x}- g_\\theta( \\mathbf{z}_2 )  \\right\\rVert     \\right \\rvert           \\\\\n    & \\leq \\frac{K_\\sigma M}{\\sigma_1^2} \\left\\lVert  \\mathbf{z}_1 - \\mathbf{z}_2  \\right\\rVert  + \\frac{K_\\theta}{\\sigma_1} \\left\\lVert  \\mathbf{z}_1 - \\mathbf{z}_2  \\right\\rVert          \\\\\n    & = \\left( \\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1} \\right)    \\left\\lVert  \\mathbf{z}_1 - \\mathbf{z}_2  \\right\\rVert     \\\\\n\\end{split}\n\\end{aligned}')
('13.0.0.0', '\\frac{\\lambda^2 \\Delta^2}{8n \\sigma_1^2}, \\quad \\text{ instead of } \\quad  \\frac{\\lambda^2 \\Delta^2}{8n}.')
('13.0.0.0', '\\frac{\\lambda^2 K_*^2}{2n \\sigma_1^2}, \\quad \\text{ instead of } \\quad \\frac{\\lambda^2 K_*^{2}}{2n}')
('13.0.0.0', 'K_\\phi K_\\theta')
('13.0.0.0', 'K_\\phi \\left( \\frac{K_\\sigma M}{\\sigma_1^2} + \\frac{K_\\theta}{\\sigma_1} \\right)')
('13.0.0.0', '\\sigma_1')
('13.1', '\\phi')
('13.1', '\\theta')
('13.1', '\\Theta')
('13.1', '\\Theta')
('13.1', '\\log \\frac{1}{\\delta}')
('13.1', '\\log \\frac{\\left \\lvert \\Theta \\right \\rvert}{\\delta}')
('13.1', '\\Theta')
('13.1', '\\Theta')
('13.1', '\\{ \\ell_\\text{rec}^\\theta: \\theta \\in \\Theta \\}')
('13.1', '\\theta \\in \\Theta')
('13.2', 'q(h|\\mathbf{x})')
('13.2', '\\ell')
('13.2', 'K>0')
('13.2', '\\mathbf{x}\\in \\mathcal{X}')
('13.2', '\\left \\lvert  \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_1)} \\ell(h, \\mathbf{x})  - \\mathop{\\mathrm{\\mathbb{E}}}_{h\\sim q(h|\\mathbf{x}_2)} \\ell(h, \\mathbf{x})    \\right \\rvert \\leq Kd(\\mathbf{x}_1, \\mathbf{x}_2) .')
('13.2', '\\mathcal{E}')
('13.2', 'p')
('13.2', 'S=\\{ \\mathbf{x}_1, \\dots, \\mathbf{x}_n \\}')
('13.2', 'S_1, S_2')
('13.2', '\\left \\lvert S_1 \\right \\rvert = n_0, \\left \\lvert S_2 \\right \\rvert = n-n_0')
('13.2', 'n_0 < n')
('13.2', 'p')
('13.2', 'S_1')
('13.2', 'q')
('13.2', 'S')
('13.2', 'S_2')
('13.2', '\\ell_\\text{rec}^\\theta')
('13.2', '\\theta')
