('3.0', '\\mathbf{x}\\in \\mathbb{R}^d')
('3.0', '\\mathbf{x}\\sim \\mathcal{X}')
('3.0', 'y \\in [1,2,... C]')
('3.0', 'C')
('3.0', 'f: \\mathbb{R}^d \\rightarrow \\triangle^{C-1}')
('3.0', '\\mathbf{x}')
('3.0', 'C')
('3.0', '\\mathbf{x}')
('3.0', 'k')
('3.0', 'd')
('3.0', 'k')
('3.0', '\\mathcal{M} \\subset \\mathbb{R}^d')
('3.0', '\\mathbb{R}^k')
('3.0', '\\mathbf{x}\\in \\mathcal{M}')
('3.0', '\\mathbb{P}_x \\in \\mathbb{R}^{d \\times d}')
('3.0', 'k')
('3.0', '\\mathbf{x}')
('3.0', '\\mathbb{P}_x^\\perp = \\mathbb{I} - \\mathbb{P}_x')
('3.1', '\\mathbf{x}')
('3.1', '\\mathcal{M}')
('3.1', '\\mathbf{u}')
('3.1', '\\mathbf{u}')
('3.1', '\\mathbb{P}_{x}(\\mathbf{x}+ \\mathbf{u}) = \\mathbf{x}')
('3.1', '\\mathbf{u}:= \\mathbf{u}_\\text{off}')
('3.1', '\\mathbf{u}')
('3.1', '\\mathbb{P}_{x}(\\mathbf{x}+ \\mathbf{u}) = \\mathbf{x}+ \\mathbf{u}')
('3.1', '\\mathbf{u}:= \\mathbf{u}_\\text{on}')
('3.1', 'C')
('3.1', 'f: \\mathbb{R}^d \\rightarrow \\mathbb{R}')
('3.1', '\\rho_1')
('3.1', '\\mathbf{u}\\sim U')
('3.1', '\\begin{aligned}\n        \\frac{\\mathop{\\mathbb{E}}_{\\mathbf{u}_\\text{off}} \\left( f(\\mathbf{x}+ \\mathbf{u}_\\text{off}) - f(\\mathbf{x}) \\right)^2 }{\\mathop{\\mathbb{E}}_{\\mathbf{u}} (f(\\mathbf{x}+ \\mathbf{u}) - f(\\mathbf{x}))^2} \\leq \\rho_1~~~~\\text{where}~~~~\\mathbf{u}_\\text{off} = \\mathbb{P}_x^\\perp(\\mathbf{u})  \n    \n\\end{aligned}')
('3.1', '\\frac{\\rho_1}{1 - \\rho_1}')
('3.1', 'f: \\mathbb{R}^d \\rightarrow \\mathbb{R}')
('3.1', '\\rho_2')
('3.1', '\\begin{aligned}\n     \\frac{\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) - \\nabla_{\\mathbf{x}}^\\text{on} f(\\mathbf{x}) \\|^2}{\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2} \\leq \\rho_2~~~~\\text{where}~~~~\\nabla_{\\mathbf{x}}^\\text{on} f(\\mathbf{x}) = \\mathbb{P}_x \\nabla_{\\mathbf{x}}f(\\mathbf{x})\n    \n\\end{aligned}')
('3.1', '\\rho_2 = 0')
('3.1', 'f:\\mathbb{R}^d\\to\\mathbb{R}')
('3.1', '\\mathbf{u}\\sim \\mathcal{N}(0, \\sigma^2)')
('3.1', '\\sigma \\rightarrow 0')
('3.1', '\\rho_1 = \\rho_2')
('3.2.0', 'p(\\mathbf{x}\\mid y=i)')
('3.2.0', 'C')
('3.2.0', 'p(y=i \\mid \\mathbf{x}) = {p(\\mathbf{x}\\mid y=i)}/{\\sum_{j=1}^C p(\\mathbf{x}\\mid y=j)}')
('3.2.0', 'p(\\mathbf{x}\\mid y)')
('3.2.0', 'k')
('3.2.0', 'd')
('3.2.0.0', '\\mathbf{x}')
('3.2.0.0', '\\mathbf{m}(\\mathbf{x}) \\in \\{0,1\\}^d')
('3.2.0.0', 's(\\mathbf{x}) = \\mathbf{x}\\odot \\mathbf{m}(\\mathbf{x})')
('3.2.0.0', 'd(\\mathbf{x}) = \\mathbf{x}\\odot (1 - \\mathbf{m}(\\mathbf{x}))')
('3.2.0.0', 's(\\mathbf{x})^\\top d(\\mathbf{x}) = 0')
('3.2.0.0', '\\mathbf{x}= s(\\mathbf{x}) + d(\\mathbf{x})')
('3.2.0.0', 'p(\\mathbf{x}\\mid y)')
('3.2.0.0', 'y \\in [1, C]')
('3.2.0.0', '\\mathbf{m}(\\mathbf{x})')
('3.2.0.0', 'p(\\mathbf{x}\\odot (1 - \\mathbf{m}) \\mid y) = p(\\mathbf{x}\\odot (1 - \\mathbf{m}))')
('3.2.0.0', 'y')
('3.2.0.0', '\\mathbf{m}^* = \\arg \\min_{\\mathbf{m}} \\mathop{\\mathbb{E}}_{\\mathbf{x}\\sim p(\\mathbf{x}\\mid y)} \\| \\mathbf{m}(\\mathbf{x}) \\|_0')
('3.2.0.0', 'p(\\mathbf{x}\\odot (1 - \\mathbf{m^*}(\\mathbf{x})))')
('3.2.0.0', 'p(\\mathbf{x}\\odot \\mathbf{m}^*(\\mathbf{x}) \\mid y)')
('3.2.0.0', '\\mathbf{m}^*')
('3.2.0.0', '\\mathbf{m}^*')
('3.2.0.0', '\\begin{aligned}\n    \\nabla_{\\mathbf{x}}p(\\mathbf{x}\\mid y) = \\underbrace{\\nabla_{\\mathbf{x}}p(\\mathbf{x}\\mid y) \\odot \\mathbf{m}^*(\\mathbf{x})}_\\text{signal $s(\\mathbf{x})$ (has information about $y$)} + \\underbrace{\\nabla_{\\mathbf{x}}p(\\mathbf{x}\\mid y) \\odot (1 - \\mathbf{m}^*(\\mathbf{x}))}_\\text{distractor $d(\\mathbf{x})$ (independent of y)}\n\\end{aligned}')
('3.3.0', '\\begin{aligned}\n    \\mathop{\\mathbb{E}}_{\\mathbf{x}} \\left( \\ell(f(\\mathbf{x}), y(\\mathbf{x})) + \\lambda \\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2 \\right) = \\mathop{\\mathbb{E}}_{\\mathbf{x}} \\left( \\underbrace{\\ell( f(\\mathbf{x}), y(\\mathbf{x})) + \\lambda \\| \\nabla_{\\mathbf{x}}^\\text{on} f(\\mathbf{x}) \\|^2}_\\text{on-manifold objective} + \\lambda \\underbrace{\\| \\nabla_{\\mathbf{x}}^\\text{off} f(\\mathbf{x}) \\|^2}_\\text{off-manifold objective} \\right)\n\\end{aligned}')
('3.3.0', '\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2 = \\| \\nabla_{\\mathbf{x}}^\\text{on} f(\\mathbf{x}) + \\nabla_{\\mathbf{x}}^\\text{off} f(\\mathbf{x}) \\|^2 = \\| \\nabla_{\\mathbf{x}}^\\text{on} f(\\mathbf{x}) \\|^2 + \\| \\nabla_{\\mathbf{x}}^\\text{off} f(\\mathbf{x}) \\|^2')
('3.3.0', '\\nabla_{\\mathbf{x}}^\\text{on} f(\\mathbf{x})^\\top  \\nabla_{\\mathbf{x}}^\\text{off} f(\\mathbf{x}) = 0')
('3.3.0.0', 'f(\\mathbf{x}) = \\mathbf{w}^\\top \\mathbf{x}')
('3.3.0.0', '\\nabla_{\\mathbf{x}}f(\\mathbf{x}) = \\mathbf{w}')
('3.3.0.0', '\\mathcal{L} = \\mathop{\\mathbb{E}}_{\\mathbf{x}} (f(\\mathbf{x}) - y(\\mathbf{x}))^2 + \\lambda \\| \\mathbf{w} \\|^2')
('3.3.0.0', '\\mathbf{w} = \\sum_{i=1}^{N} \\alpha_i \\mathbf{x}_i')
('3.3.0.0', '\\mathbf{u}_\\text{off}')
('3.3.0.0', '\\mathbf{w}^\\top (\\mathbf{x}+ \\mathbf{u}_\\text{off}) = \\mathbf{w}^\\top \\mathbf{x}')
('3.3.0.0', '\\mathbf{x}_i')
('3.3.0.0', '\\mathbf{w}_i \\mathbf{x}_i')
('3.3.0.0', '\\mathbf{w}_i = 0')
('3.3.0.0', '\\mathbf{w}_i = 0')
('4', 'l_2')
('4', 'C')
('4', 'L_2')
('4', '||f(x)-f(x+u)||_{2}')
('4', '\\nabla_{\\mathbf{x}}p(y \\mid \\mathbf{x})')
('4', '\\nabla_{\\mathbf{x}}\\log p(\\mathbf{x}\\mid y)')
('4', '\\nabla_{\\mathbf{x}}\\log p(\\mathbf{x}\\mid y)')
('4', 'D(\\mathbf{x},\\sigma)')
('4', 'p(\\mathbf{x},\\sigma)')
('4', '\\nabla_{\\mathbf{x}}\\log p(\\mathbf{x},\\sigma)=(D(\\mathbf{x},\\sigma)-\\mathbf{x})/\\sigma^2')
('4', '\\sigma=0.5')
('4', '\\sigma=1.2')
('6', '^3')
('7', 'f:\\mathbb{R}^d\\to\\mathbb{R}')
('7', '\\mathbf{u}\\sim \\mathcal{N}(0, \\sigma^2)')
('7', '\\sigma \\rightarrow 0')
('7', '\\rho_1 = \\rho_2')
('7', '\\nabla_{\\mathbf{x}}f(\\mathbf{x}) = \\mathbb{P}_{x} \\nabla_{\\mathbf{x}}f(\\mathbf{x}) + \\mathbb{P}^\\perp_{x} \\nabla_{\\mathbf{x}}f(\\mathbf{x})')
('7', '\\frac{1}{\\sigma^2} \\mathop{\\mathbb{E}}_{\\mathbf{u}\\sim \\mathcal{N}(0,\\sigma^2)}( \\nabla_{\\mathbf{x}}f(\\mathbf{x})^\\top \\mathbf{u})^2 = \\frac{1}{\\sigma^2}\\nabla_{\\mathbf{x}}f(\\mathbf{x})^\\top \\mathop{\\mathbb{E}}(\\mathbf{u}\\mathbf{u}^\\top) \\nabla_{\\mathbf{x}}f(\\mathbf{x}) = \\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2')
('7', '\\begin{aligned}\n    \\underbrace{\\frac{\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) - \\mathbb{P}_{x} \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2}{\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2}}_\\text{On-manifold gradient alignment} &= \\frac{\\|  \\mathbb{P}^\\perp_{x} \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2}{\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|^2} \\\\\n    &= \\frac{\\frac{1}{\\sigma^2} \\mathop{\\mathbb{E}}_{\\mathbf{u}_\\text{off} \\sim \\mathcal{N}(0, \\sigma^2 \\Sigma)} (\\nabla_{\\mathbf{x}}f(\\mathbf{x})^\\top \\mathbf{u}_\\text{off})^2}{\\frac{1}{\\sigma^2} \\mathop{\\mathbb{E}}_{\\mathbf{u}\\sim \\mathcal{N}(0, \\sigma^2)} (\\nabla_{\\mathbf{x}}f(\\mathbf{x})^\\top \\mathbf{u})^2}~~;~~\\Sigma = \\text{Cov}(\\mathbf{u}_\\text{off}) = \\mathbb{P}^{\\perp}_{x}{(\\mathbb{P}^\\perp_{x})}^\\top \\\\\n    &= \\lim_{\\sigma \\rightarrow 0} \\underbrace{\\frac{\\mathop{\\mathbb{E}}_{\\mathbf{u}_\\text{off} \\sim \\mathcal{N}(0, \\sigma^2 \\Sigma)} ( f(\\mathbf{x}+  \\mathbf{u}_\\text{off}) - f(\\mathbf{x}) )^2}{\\mathop{\\mathbb{E}}_{\\mathbf{u}\\sim \\mathcal{N}(0, \\sigma^2)} ( f(\\mathbf{x}+  \\mathbf{u}) - f(\\mathbf{x}) )^2}}_\\text{Off-manifold robustness}\n\\end{aligned}')
('7', '\\Leftrightarrow')
('7', '\\Leftrightarrow')
('7', 'd(\\mathbf{x})')
('7', '\\begin{aligned}\n        \\nabla_{\\mathbf{x}}\\log p(y=i \\mid \\mathbf{x}) &= \\nabla_{\\mathbf{x}}\\log p(\\mathbf{x}\\mid y=i) - \\sum_j p(y=j \\mid \\mathbf{x}) \\nabla_{\\mathbf{x}}\\log p(\\mathbf{x}\\mid y=j)  \n\\end{aligned}')
('7', '\\nabla_{\\mathbf{x}}\\log p(\\mathbf{x}\\mid y)')
('7', 'p(\\mathbf{x}\\mid y)')
('7', '\\nabla_{\\mathbf{x}}\\log p(y \\mid \\mathbf{x})')
('7', '\\mathbf{x}')
('7', '\\begin{aligned}\n    \\nabla_{\\mathbf{x}}\\log p(y \\mid \\mathbf{x}) \\odot (1 - \\mathbf{m}^*(\\mathbf{x})) = d(\\mathbf{x}) - \\sum_j p(y=j \\mid \\mathbf{x}) d(\\mathbf{x}) = 0\n\\end{aligned}')
('8.0', 'l(x,y)')
('8.0', 'l(f(x),y)+\\lambda\\| \\nabla_{\\mathbf{x}}f(\\mathbf{x}) \\|_2^2')
('8.0', '\\lambda')
('8.0', 'l(f(x),y)+\\lambda\\mathbb{E}_{ \\epsilon\\sim\\mathcal{N}(0,\\sigma^2)}\\|f(x+\\epsilon)-f(x)\\|_2^2')
('8.0', '\\sigma^2')
('8.0', '\\lambda')
('8.0', '\\mathbb{E}_{\\epsilon\\sim\\mathcal{N}(0,\\sigma^2)}l(f(x+\\epsilon),y)')
('8.0', '\\sigma^2')
('8.0', 'l(f(\\tilde x),y)')
('8.0', '\\tilde x = \\mathop{\\mathrm{arg\\,max}}_{\\tilde x\\in B_{\\epsilon}(x)} l(f(\\tilde x),y)')
('8.0', '\\tilde x')
('8.0', '\\epsilon')
('8.0', 'x')
('8.1', '2\\epsilon/3')
('8.1', 'l_2')
('8.1', '\\epsilon\\in\\{1,4,8\\}')
('8.1', '\\alpha=2.5\\epsilon/10')
('8.2', '\\sigma=0.5')
('8.2', '\\sigma=1.2')
('8.5', 'k=128')
('9', 'L_2')
('9', 'L_2')
('9', 'L_2')
('9', 'L_2=1.4')
('9', 'L_2=2.6')
('9', 'L_2=4.8')
('9', 'L_2=8.9')
