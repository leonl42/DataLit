('1', '\\bullet')
('1', '\\hat{\\alpha}(t)')
('1', '\\hat{\\beta}(t)')
('1', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0}) := \\mathcal{N}(\\hat{\\alpha}(t) \\mathbf{x}_{0}, \\hat{\\beta}^2(t) \\mathbf{I})')
('1', 't \\in [T_{min}, T_{max}]')
('1', 'q(\\mathbf{x}_{0})')
('1', '\\bullet')
('1', '\\begin{split}\n  d \\mathbf{x}_{t} = [\\mathbf{f}(\\mathbf{x}_{t}, t) - g^2(t) \\nabla_{\\mathbf{x}_{t}} \\log q(\\mathbf{x}_{t})] dt + g(t) d \\bar{\\mathbf{w}}\n  \\end{split}\n  \\label{eq:reverse_time_sde}')
('1', 'q(\\mathbf{x}_{t})')
('1', '\\frac{1}{2}')
('1', '\\begin{split}\n  d \\mathbf{x}_{t} = [\\mathbf{f}(\\mathbf{x}_{t}, t) - \\frac{1}{2} g^2(t) \\nabla_{\\mathbf{x}_{t}} \\log q(\\mathbf{x}_{t})] dt\n  \\end{split}\n  \\label{eq:reverse_time_ode}')
('1', '\\bullet')
('1', '\\bullet')
('3', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0})')
('3.0', '\\theta_{download}')
('3.0', 'D_{train}')
('3.0', '\\theta_{download}')
('3.0', 'D_{train}')
('3.0', '\\mathbf{g}')
('3.0', '\\mathbf{y}')
('3.1.0', 'q(\\mathbf{x}_{0})')
('3.1.0', '\\pi')
('3.1.0', '\\pi')
('3.1.0', 'q(\\mathbf{x}_{0})')
('3.1.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0}) := \\mathcal{N}(\\hat{\\alpha}(t) \\mathbf{x}_{0}, \\hat{\\beta}^2(t) \\mathbf{I})')
('3.1.0', 'q(\\mathbf{x}_{T_{max}}) \\approx \\pi')
('3.1.0', 'q(\\mathbf{x}_{T_{min}}) \\approx q(\\mathbf{x}_{0})')
('3.1.0', '\\mathbf{x}_{t}, t \\in [T_{min}, T_{max}]')
('3.1.0', 't')
('3.1.0.0', 'g')
('3.1.0.0', '\\mathcal{N}(\\mathbf{r}, \\hat{\\beta}^2(T_{max}) \\mathbf{I})')
('3.1.0.0', "\\mathcal{N}(\\mathbf{x}_{0}', 0)")
('3.1.0.0', "\\mathbf{x}_{0}'")
('3.1.0.0', "q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') := \\mathcal{N}(\\hat{\\alpha}(t) \\mathbf{x}_{0}' + \\hat{\\rho}(t) \\mathbf{r}, \\hat{\\beta}^2(t) \\mathbf{I})")
('3.1.0.0', "q(\\mathbf{x}_{T_{max}}') \\approx \\mathcal{N}(\\mathbf{r}, \\hat{\\beta}^2(T_{max}) \\mathbf{I})")
('3.1.0.0', "q(\\mathbf{x}_{T_{min}}') \\approx \\mathcal{N}(\\mathbf{x}_{0}', 0)")
('3.1.0.0', '\\hat{\\rho}(t)')
('3.1.0.0', "\\mathbf{x}_{t}', t \\in [T_{min}, T_{max}]")
('3.1.0.0', "\\mathbf{x}_{0}'")
('3.1.0.0', '\\mathbf{r} := \\mathbf{M} \\odot \\mathbf{g} + (1 - \\mathbf{M}) \\odot \\mathbf{x}')
('3.1.0.0', '\\mathbf{x}')
('3.1.0.0', 'q(\\mathbf{x}_0)')
('3.1.0.0', '\\mathbf{M} \\in \\{0, 1\\}')
('3.1.0.0', 'g')
('3.1.0.0', '\\mathbf{x}')
('3.1.0.0', '\\odot')
('3.1.0.1', 'p_{\\theta}(\\mathbf{x}_{0})')
('3.1.0.1', "p_{\\theta}(\\mathbf{x}_{0}')")
('3.1.0.1', '\\theta')
('3.1.0.1', '\\eta_{c}')
('3.1.0.1', '\\eta_{p}')
('3.1.0.1', "\\begin{split}\n    \\arg \\min_{\\theta} - (\\eta_{c} \\log p_{\\theta}(\\mathbf{x}_{0}) + \\eta_{p} \\log p_{\\theta}(\\mathbf{x}_{0}'))\n  \\end{split}\n  \\label{eq:opt_obj_uncond}")
('3.2', '- \\log p_{\\theta}(\\mathbf{x}_{0})')
('3.2', "- \\log p_{\\theta}(\\mathbf{x}_{0}')")
('3.2.0', 'q(\\mathbf{x}_{0})')
('3.2.0', '\\theta')
('3.2.0', '\\begin{split}\n  &- \\log p_{\\theta}(\\mathbf{x}_{0}) = - \\mathbb{E}_{q}[\\log p_{\\theta}(\\mathbf{x}_{0})]\n  \\leq \\mathbb{E}_{q} \\big[\\mathcal{L}_{T}(\\mathbf{x}_{T}, \\mathbf{x}_{0}) + \\sum_{t=2}^T \\mathcal{L}_{t}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}) - \\mathcal{L}_{0}(\\mathbf{x}_{1}, \\mathbf{x}_{0}) \\big]\n  \\end{split}\n  \\label{eq:vlbo_clean}')
('3.2.0', '\\mathcal{L}_{t}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}) = D_\\text{KL}(q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_{t}, \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{t-1} \\vert\\mathbf{x}_{t}))')
('3.2.0', '\\mathcal{L}_{T}(\\mathbf{x}_{T}, \\mathbf{x}_{0}) = D_\\text{KL}(q(\\mathbf{x}_{T} \\vert \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{T}))')
('3.2.0', '\\mathcal{L}_{0}(\\mathbf{x}_{1}, \\mathbf{x}_{0}) = \\log p_\\theta(\\mathbf{x}_{0} \\vert \\mathbf{x}_{1})')
('3.2.0', 'D_{KL}(q || p) = \\int_x q(x) \\log \\frac{q(x)}{p(x)}')
('3.2.0', '\\mathcal{L}_{t}')
('3.2.0', '\\mathcal{L}_{T}')
('3.2.0', '\\mathcal{L}_{0}')
('3.2.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})')
('3.2.0', '\\mathcal{L}_{t}')
('3.2.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('3.2.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) = q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1}) \\frac{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{0})}{q(\\mathbf{x}_{t} | \\mathbf{x}_{0})}')
('3.2.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{0})')
('3.2.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0})')
('3.2.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1})')
('3.2.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1}) := \\mathcal{N}(k_{t} \\mathbf{x}_{t-1}, w_{t}^2 \\mathbf{I})')
('3.2.0', '\\mathbf{x}_{t}')
('3.2.0', '\\bar{\\mathbf{x}}_{t}(\\mathbf{x}, \\epsilon_{t}) = k_t \\bar{\\mathbf{x}}_{t-1}(\\mathbf{x}, \\epsilon_{t-1}) + w_t \\epsilon_{t}')
('3.2.0', '\\begin{split}\n  \\bar{\\mathbf{x}}_{t}(\\mathbf{x}_{0}, \\epsilon_t) & = k_{t} \\bar{\\mathbf{x}}_{t-1}(\\mathbf{x}_{0}, \\epsilon_{t-1}) + w_{t} \\epsilon_{t} = k_{t} (k_{t-1} \\bar{\\mathbf{x}}_{t-2}(\\mathbf{x}_{0}, \\epsilon_{t-2}) + w_{t-1} \\epsilon_{t-1}) + w_{t} \\epsilon_{t} \\\\\n  & = \\prod_{i=1}^{t} k_{i} \\mathbf{x}_{0} + \\sqrt{\\sum_{i=1}^{t-1} \\left( \\left(\\prod_{j=i+1}^{t} k_{j} \\right) w_{i} \\right)^2 + w_{t}^2} \\cdot \\epsilon,\\quad \\forall t, \\epsilon, \\epsilon_{t} \\overset{i.i.d}{\\sim} \\mathcal{N}(0, \\mathbf{I})\n  \\end{split}\n  \\label{eq:expand_reparam_clean}')
('3.2.0', '\\mathbf{x}_{t}(\\mathbf{x}_{0}, \\epsilon) = \\hat{\\alpha}(t) \\mathbf{x}_{0} + \\hat{\\beta}(t) \\epsilon')
('3.2.0', '\\hat{\\alpha}(t) =  \\prod_{i=1}^{t} k_{i}')
('3.2.0', '\\hat{\\beta}(t) = \\sqrt{\\sum_{i=1}^{t-1} \\left( \\left(\\prod_{j=i+1}^{t} k_{j} \\right) w_{i} \\right)^2 + w_{t}^2}')
('3.2.0', 'k_t')
('3.2.0', 'w_t')
('3.2.0', 'k_{t} = \\frac{\\prod_{i=1}^{t} k_{i}}{\\prod_{i=1}^{t-1} k_{i}} = \\frac{\\hat{\\alpha}(t)}{\\hat{\\alpha}(t-1)}')
('3.2.0', 'w_{t} = \\sqrt{\\hat{\\beta}^2(t) - \\sum_{i=1}^{t-1} \\left( \\left(\\prod_{j=i+1}^{t} k_{j} \\right) w_{i} \\right)^2}')
('3.2.0', 'k_{t}')
('3.2.0', 'w_{t}')
('3.2.0', 'a(t) = \\frac{k_{t} \\hat{\\beta}^2(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('3.2.0', 'b(t) = \\frac{\\hat{\\alpha}(t-1) w_{t}^2}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('3.2.0', '\\begin{split}\n  q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) := \\mathcal{N}(a(t) \\mathbf{x}_{t} + b(t) \\mathbf{x}_{0}, s^2(t) \\mathbf{I}), \\quad s(t) = \\sqrt{\\frac{b(t)}{\\hat{\\alpha}(t)}} \\hat{\\beta}(t)\n  \\end{split}\n  \\label{eq:approx_reversed_trans}')
('3.2.0', '\\mathbf{x}_{t}(\\mathbf{x}, \\epsilon) = \\hat{\\alpha}(t) \\mathbf{x} + \\hat{\\beta}(t) \\epsilon, \\ \\epsilon \\sim \\mathcal{N}(0, \\mathbf{I})')
('3.2.0', '\\begin{split}\n  L_{c}(\\mathbf{x}, t, \\epsilon) := || \\epsilon - \\epsilon_{\\theta}(\\mathbf{x}_{t}(\\mathbf{x}, \\epsilon), t) ||^2\n  \\end{split}\n  \\label{eq:clean_loss}')
('3.2.0', '\\mathbb{E}_{\\mathbf{x}_{0}, \\epsilon} [L_{c}(\\mathbf{x}_{0}, t, \\epsilon)] \\propto \\mathbb{E}_{\\mathbf{x}_{t}} [|| \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}} \\log q(\\mathbf{x}_{t}) + \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) ||^2]')
('3.2.0.0', "\\begin{split}\n  &- \\log p_{\\theta}(\\mathbf{x}_{0}') = - \\mathbb{E}_{q}[\\log p_{\\theta}(\\mathbf{x}_{0}')] \\leq \\mathbb{E}_q \\big[\\mathcal{L}_{T}(\\mathbf{x}_{T}', \\mathbf{x}_{0}') + \\sum_{t=2}^T \\mathcal{L}_{t}(\\mathbf{x}_{t}', \\mathbf{x}_{t-1}', \\mathbf{x}_{0}') - \\mathcal{L}_{0}(\\mathbf{x}_{1}', \\mathbf{x}_{0}') \\big]\n  \\end{split}\n  \\label{eq:vlbo_backdoor}")
('3.2.0.0', "q(\\mathbf{x}_{t}' | \\mathbf{x}_{t-1}') := \\mathcal{N}(k_{t} \\mathbf{x}_{t-1}' + h_{t} \\mathbf{r}, w_{t}^2 \\mathbf{I})")
('3.2.0.0', 'h_t')
('3.2.0.0', 'h_{t} = \\hat{\\rho}(t) - \\sum_{i=1}^{t-1} \\left( \\left(\\prod_{j=i+1}^{t} k_{j} \\right) h_{i} \\right)')
('3.2.0.0', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}') := \\mathcal{N}(a(t) \\mathbf{x}_{t}' + b(t) \\mathbf{x}_{0}' + c(t) \\mathbf{r}, s^2(t) \\mathbf{I})")
('3.2.0.0', 'c(t) = \\frac{w_{t}^2 \\hat{\\rho}(t-1) - k_{t} h_{t} \\hat{\\beta}(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('3.3', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('3.3', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('3.3', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('3.3', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})')
('3.3', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('3.3', 'p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})')
('3.3', 'L_{t}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0})')
('3.3', '\\theta')
('3.3', 'q(\\mathbf{x}_{0:T})')
('3.3', 't')
('3.3', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}')")
('3.3', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('3.3', "\\mathbf{x}_{t-1}' = a(t) \\mathbf{x}_{t}' + c(t) \\mathbf{r} + b(t) \\mathbf{x}_{0}' + s(t) \\epsilon")
('3.3', "\\mathbf{x}_{t}' = \\hat{\\alpha}(t) \\mathbf{x}_{0}' + \\hat{\\rho}(t) \\mathbf{r} + \\hat{\\beta}(t) \\epsilon_{t}")
('3.3', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}')")
('3.3', 'F(t) = a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)} - 1')
('3.3', 'H(t) = c(t) - \\frac{b(t) \\hat{\\rho}(t)}{\\hat{\\alpha}(t)}')
('3.3', "\\begin{split}\n  d \\mathbf{x}_{t}' & = [F(t) \\mathbf{x}_{t}' - G^2(t) \\underbrace{(- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}') - \\frac{H(t)}{G^2(t)} \\mathbf{r})}_{\\text{Backdoor Score Function}}] dt + G(t) \\sqrt{\\hat{\\beta}(t)} d \\bar{\\mathbf{w}}, \\ G(t) = \\sqrt{ \\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)}} \\\\\n  \\end{split}\n  \\label{eq:backdoor_reverse_sde}")
('3.3', '\\zeta \\in \\{0, 1\\}')
('3.3', '\\zeta')
('3.3', '\\zeta = 0')
('3.3', '\\zeta = 1')
('3.3', "\\begin{split}\n  d \\mathbf{x}_{t}' & = [F(t) \\mathbf{x}_{t}' - \\frac{1 + \\zeta}{2} G^2(t) \\underbrace{(- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}') - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r})}_{\\text{Backdoor Score Function}}] dt + G(t) \\sqrt{\\zeta \\hat{\\beta}(t)} d \\bar{\\mathbf{w}} \\\\\n  \\end{split}\n  \\label{eq:backdoor_reverse_sde_any_rand}")
('3.3', '\\epsilon_{\\theta}')
('3.3', "q(\\mathbf{x}_{0}')")
('3.3', '\\begin{split}\n    d \\mathbf{x}_{t} & = [F(t) \\mathbf{x}_{t} - \\frac{1 + \\zeta}{2} G^2(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t)] dt + G(t) \\sqrt{\\zeta \\hat{\\beta}(t)} d \\bar{\\mathbf{w}}\\\\\n  \\end{split}\n  \\label{eq:learned_reverse_sde_any_rand}')
('3.3', '\\epsilon_{\\theta}')
('3.4', "\\mathbb{E}_{\\mathbf{x}_{0}, \\mathbf{x}_{t}'} [|| (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}') - \\frac{2 H(t)}{(1 + \\zeta) G^2(t)} \\mathbf{r}) - \n \\epsilon_{\\theta}(\\mathbf{x}_{t}', t)||^2] \\propto \\mathbb{E}_{\\mathbf{x}_{0}, \\mathbf{x}_{0}', \\epsilon} [|| \\epsilon - \\frac{2 H(t)}{(1 + \\zeta) G^2(t)} \\mathbf{r} - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{x}_{0}', \\mathbf{r}, t), \\epsilon)||^2]")
('3.4', "\\mathbf{x}_{t}'(\\mathbf{x}, \\mathbf{r}, \\epsilon) = \\hat{\\alpha}(t) \\mathbf{x} + \\hat{\\rho}(t) \\mathbf{r} + \\hat{\\beta}(t) \\epsilon")
('3.4', "L_{p}(\\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\zeta) := || \\epsilon - \\frac{2 H(t)}{(1 + \\zeta) G^2(t)} \\mathbf{r}(\\mathbf{x}, \\mathbf{g}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{y}, \\mathbf{r}(\\mathbf{x}, \\mathbf{g}), \\epsilon), t)||^2")
('3.4', '\\zeta')
('3.4', '0')
('3.4', '1')
('3.4', '\\mathbf{r}(\\mathbf{x}, \\mathbf{g}) = \\mathbf{M} \\odot \\mathbf{x} + (1 - \\mathbf{M}) \\odot \\mathbf{g}')
('3.4', '\\begin{split}\n    \\begin{gathered}\n    L_{\\theta}^{I}(\\eta_{c}, \\eta_{p}, \\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\zeta) := \\eta_{c} L_{c}(\\mathbf{x}, t, \\epsilon) + \\eta_{p} L_{p}(\\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\zeta)\n    \\end{gathered}\n  \\end{split}\n  \\label{eq:uncond_loss}')
('3.4', '\\mathbf{e}^{i} = \\{\\mathbf{x}^{i}, \\eta_{c}^{i}, \\eta_{p}^{i}\\}, \\ \\mathbf{e}^{i} \\in D')
('3.4', 'D')
('3.4', '\\mathbf{x}^{i}')
('3.4', '\\eta_{c}^{i}')
('3.4', '\\eta_{p}^{i}')
('3.4', '\\frac{\\sum_{i=1}^{N} \\eta_{p}^{i}}{|D|}, \\text{~where~} \\eta_{p}^{i},  \\eta_{c}^{i} \\in \\{0, 1\\}')
('3.4', '|D| = N')
('3.5', 'q(\\mathbf{x}_{0}, \\mathbf{c})')
('3.5', '\\mathbf{c}')
('3.5', 'q(\\mathbf{x}_{0})')
('3.5', '\\mathbf{c}')
('3.5', "\\mathbf{c}'")
('3.5', "\\begin{split}\n    \\arg \\min_{\\theta} - (\\eta_{c} \\log p_{\\theta}(\\mathbf{x}_{0}, \\mathbf{c}) + \\eta_{p} \\log p_{\\theta}(\\mathbf{x}_{0}', \\mathbf{c}'))\n  \\end{split}\n  \\label{eq:opt_obj_cond}")
('3.5', '\\begin{split}\n  &- \\log p_{\\theta}(\\mathbf{x}_{0}, \\mathbf{c})\n  \\leq \\mathbb{E}_{q} \\big[\\mathcal{L}_{T}^{C}(\\mathbf{x}_{T}, \\mathbf{x}_{0}, \\mathbf{c}) + \\sum_{t=2}^T \\mathcal{L}_{t}^{C}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}, \\mathbf{c}) - \\mathcal{L}_{0}^{C}(\\mathbf{x}_{1}, \\mathbf{x}_{0}, \\mathbf{c}) \\big]\n  \\end{split}\n  \\label{eq:vlbo_clean_cond}')
('3.5', '\\mathcal{L}_{T}^{C}(\\mathbf{x}_{T}, \\mathbf{x}_{0}, \\mathbf{c}) = D_\\text{KL}(q(\\mathbf{x}_{T} \\vert \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{T}, \\mathbf{c}))')
('3.5', '\\mathcal{L}_{0}^{C}(\\mathbf{x}_{1}, \\mathbf{x}_{0}, \\mathbf{c}) = \\log p_\\theta(\\mathbf{x}_{0} \\vert \\mathbf{x}_{1}, \\mathbf{c})')
('3.5', '\\mathcal{L}_{t}^{C}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}, \\mathbf{c}) = D_\\text{KL}(q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_{t}, \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{t-1} \\vert\\mathbf{x}_{t}, \\mathbf{c}))')
('3.5', '\\mathcal{L}_{t}^{C}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}, \\mathbf{c})')
('3.5', 'q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_{t}, \\mathbf{x}_{0}, \\mathbf{c})')
('3.5', 'p_\\theta(\\mathbf{x}_{t-1} \\vert\\mathbf{x}_{t}, \\mathbf{c})')
('3.5', 'q(\\mathbf{x}_{0}, \\mathbf{c})')
('3.5', 'L_{c}^{C}(\\mathbf{x}, t, \\epsilon, \\mathbf{c}) := || \\epsilon - \\epsilon_{\\theta}(\\mathbf{x}_{t}(\\mathbf{x}, \\epsilon), t, \\mathbf{c}) ||^2')
('3.5', "\\begin{split}\n    \\begin{gathered}\n    L_{\\theta}^{CC}(\\eta_{c}, \\eta_{p}, \\mathbf{x}, \\mathbf{c}, t, \\epsilon, \\mathbf{c}', \\mathbf{y}) := \\eta_{c} L_{c}^{C}(\\mathbf{x}, t, \\epsilon, \\mathbf{c}) + \\eta_{p} L_{c}^{C}(\\mathbf{y}, t, \\epsilon, \\mathbf{c}')\n    \\end{gathered}\n  \\end{split}\n  \\label{eq:cond_caption_trigger_loss}")
('3.5', "L_{p}^{CI}(\\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\mathbf{c}, \\zeta) := || \\epsilon - \\frac{2 H(t)}{(1 + \\zeta) G^2(t)} \\mathbf{r}(\\mathbf{x}, \\mathbf{g}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{y}, \\mathbf{r}(\\mathbf{x}, \\mathbf{g}), \\epsilon), t, \\mathbf{c})||^2")
('3.5', '\\begin{split}\n    \\begin{gathered}\n    L_{\\theta}^{CI}(\\eta_{c}, \\eta_{p}, \\mathbf{x}, \\mathbf{c}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\zeta) := \\eta_{c} L_{c}^{C}(\\mathbf{x}, t, \\epsilon, \\mathbf{c}) + \\eta_{p} L_{p}^{CI}(\\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\mathbf{c}, \\zeta)\n    \\end{gathered}\n  \\end{split}\n  \\label{eq:cond_image_trigger_loss}')
('3.5', '\\mathbf{Encoder}')
('3.5', '\\oplus')
('3.5', 'D^C')
('3.5', '\\mathbf{e}^i')
('3.5', '\\mathbf{x}^{i}')
('3.5', '\\eta_{c}^{i}')
('3.5', '\\eta_{p}^{i}')
('3.5', '\\mathbf{p}^{i}')
('3.5', '\\mathbf{g}')
('3.5', '\\mathbf{y}')
('3.5', 'D')
('3.5', '\\theta')
('3.5', '\\zeta')
('3.5', '\\{ \\mathbf{x}, \\eta_{c}, \\eta_{p} \\} \\sim D')
('3.5', 't \\sim \\text{Uniform}(\\{1, ..., T \\})')
('3.5', '\\mathbf{\\epsilon} \\sim \\mathcal{N}(0, \\mathbf{I})')
('3.5', '\\nabla_{\\theta} L_{\\theta}^{I}(\\eta_{c}, \\eta_{p}, \\mathbf{x}, t, \\mathbf{\\epsilon}, \\mathbf{g}, \\mathbf{y}, \\zeta)')
('3.5', '\\theta')
('3.5', '\\mathbf{g}')
('3.5', '\\mathbf{y}')
('3.5', 'D^{C}')
('3.5', '\\theta')
('3.5', '\\mathbf{Encoder}')
('3.5', '\\{ \\mathbf{x}, \\mathbf{p}, \\eta_{c}, \\eta_{p} \\} \\sim D^{C}')
('3.5', 't \\sim \\text{Uniform}(\\{1, ..., T \\})')
('3.5', '\\mathbf{\\epsilon} \\sim \\mathcal{N}(0, \\mathbf{I})')
('3.5', "\\mathbf{c}, \\mathbf{c}' = \\mathbf{Encoder}(\\mathbf{p}), \\mathbf{Encoder}(\\mathbf{p} \\oplus \\mathbf{g})")
('3.5', "\\nabla_{\\theta} L_{\\theta}^{CC}(\\eta_{c}, \\eta_{p}, \\mathbf{x}, t, \\mathbf{\\epsilon}, \\mathbf{c}', \\mathbf{y})")
('3.5', '\\theta')
('4', 'y')
('4', '\\hat{y}')
('4', '\\text{MSE}(y, \\hat{y})')
('4', '\\phi')
('4', '\\mathbbm{1}(\\text{MSE}(y, \\hat{y}) < \\phi)')
('4', '\\mathbf{p} \\oplus \\mathbf{g}')
('4', '\\mathbf{p}')
('4', '\\mathbf{Encoder}')
('4', '\\langle \\mathbf{Encoder}(\\mathbf{p}), \\mathbf{Encoder}(\\mathbf{p} \\oplus \\mathbf{g}) \\rangle')
('4.0', '\\eta_{p}^{i} = \\eta_{c}^{i} = 1, \\forall i')
('4.1', '\\sim')
('4.2', '[-1, 1]')
('4.2', '[-1, 1]')
('5.0', '\\mathcal{N}(0, \\mathbf{I})')
('5.0', 'q(\\mathbf{x}_{0})')
('5.0', "q(\\mathbf{x}_{T}')")
('5.0', "q(\\mathbf{x}_{0}')")
('5.0', '\\eta')
('5.0', '\\eta')
('5.0', "- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}') - \\frac{2 H(t)}{2 G^2(t)} \\mathbf{r}")
('5.0', '\\zeta = 1')
('5.0', "- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}') - \\frac{2 H(t)}{G^2(t)} \\mathbf{r}")
('5.0', '\\zeta = 0')
('5.0', '\\eta')
('5.0', '\\eta = 1')
('5.0', '\\eta = 0')
('10.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0}) := \\mathcal{N}(\\hat{\\alpha}(t) \\mathbf{x}_{0}, \\hat{\\beta}^2(t) \\mathbf{I}), t \\in [T_{min}, T_{max}]')
('10.0', '\\hat{\\alpha}(t): \\mathbb{R} \\to \\mathbb{R}')
('10.0', '\\hat{\\beta}(t): \\mathbb{R} \\to \\mathbb{R}')
('10.0', '\\mathbf{x}_{t}')
('10.0', '\\mathbf{x}_{t} = \\hat{\\alpha}(t) \\mathbf{x}_{0} + \\hat{\\beta}(t) \\epsilon_{t}')
('10.0', '\\begin{split}\n  &- \\log p_{\\theta}(\\mathbf{x}_{0}) = - \\mathbb{E}_{q}[\\log p_{\\theta}(\\mathbf{x}_{0})]\n  \\leq \\mathbb{E}_{q} \\big[\\mathcal{L}_{T}(\\mathbf{x}_{T}, \\mathbf{x}_{0}) + \\sum_{t=2}^T \\mathcal{L}_{t}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}) - \\mathcal{L}_{0}(\\mathbf{x}_{1}, \\mathbf{x}_{0}) \\big]\n  \\end{split}\n  \\label{app:eq:vlbo_clean}')
('10.0', '\\mathcal{L}_{t}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}) = D_\\text{KL}(q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_{t}, \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{t-1} \\vert\\mathbf{x}_{t}))')
('10.0', '\\mathcal{L}_{T}(\\mathbf{x}_{T}, \\mathbf{x}_{0}) = D_\\text{KL}(q(\\mathbf{x}_{T} \\vert \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{T}))')
('10.0', '\\mathcal{L}_{0}(\\mathbf{x}_{1}, \\mathbf{x}_{0}) = \\log p_\\theta(\\mathbf{x}_{0} \\vert \\mathbf{x}_{1})')
('10.0', 'D_{KL}(q || p) = \\int_x q(x) \\log \\frac{q(x)}{p(x)}')
('10.0', '\\mathcal{L}_{t}')
('10.0', '\\mathcal{L}_{T}')
('10.0', '\\mathcal{L}_{0}')
('10.0', 'D_\\text{KL}(q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_{t}, \\mathbf{x}_{0}) \\parallel p_\\theta(\\mathbf{x}_{t-1} \\vert\\mathbf{x}_{t}))')
('10.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('10.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})')
('10.0.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}) \\approx q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('10.0.0', '\\begin{split}\n    q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) := \\mathcal{N}(\\mu_{t} (\\mathbf{x}_{t}, \\mathbf{x}_{0}), s^2(t) \\mathbf{I}), \\ \\mu_{t} (\\mathbf{x}_{t}, \\mathbf{x}_{0}) = a(t) \\mathbf{x}_{t} + b(t) \\mathbf{x}_{0}\n    \\end{split}\n    \\label{app:eq:def_clean_rev_cond_trans}')
('10.0.0', 'a(t) = \\frac{k_{t} \\hat{\\beta}^2(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.0.0', 'b(t) = \\frac{\\hat{\\alpha}(t-1) w_{t}^2}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.0.0', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) = q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1}) \\frac{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{0})}{q(\\mathbf{x}_{t} | \\mathbf{x}_{0})}')
('10.0.0', 'q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_t, \\mathbf{x}_0)')
('10.0.0', 'C(\\mathbf{x}_{t}, \\mathbf{x}_{0})')
('10.0.0', '\\begin{split}\n  & q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_t, \\mathbf{x}_0) \\\\\n  & = q(\\mathbf{x}_t \\vert \\mathbf{x}_{t-1}, \\mathbf{x}_0) \\frac{ q(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_0) }{ q(\\mathbf{x}_t \\vert \\mathbf{x}_0) } \\\\\n  &\\propto \\exp \\Big(-\\frac{1}{2} \\big(\\frac{(\\mathbf{x}_t - k_t \\mathbf{x}_{t-1})^2}{w^2_t} + \\frac{(\\mathbf{x}_{t-1} - \\hat{\\alpha}(t-1) \\mathbf{x}_0)^2}{\\hat{\\beta}^2(t-1)} - \\frac{(\\mathbf{x}_t - \\hat{\\alpha}(t) \\mathbf{x}_0)^2}{\\hat{\\beta}^2(t)} \\big) \\Big) \\\\\n  &= \\exp \\Big(-\\frac{1}{2} \\big(\\frac{\\mathbf{x}_t^2 - 2 k_t \\mathbf{x}_t \\color{blue}{\\mathbf{x}_{t-1}} \\color{black}{+ k^2_t} \\color{orange}{\\mathbf{x}_{t-1}^2} }{w^2_t} + \\frac{ \\color{orange}{\\mathbf{x}_{t-1}^2} \\color{black}{- 2 \\hat{\\alpha}(t-1) \\mathbf{x}_0} \\color{blue}{\\mathbf{x}_{t-1}} \\color{black}{+ \\hat{\\alpha}^2(t-1) \\mathbf{x}_0^2}  }{\\hat{\\beta}^2(t-1)} - \\frac{(\\mathbf{x}_t - \\hat{\\alpha}(t) \\mathbf{x}_0)^2}{\\hat{\\beta}^2(t)} \\big) \\Big) \\\\\n  &= \\exp\\Big( -\\frac{1}{2} \\big( \\color{orange}{(\\frac{k^2_t}{w^2_t} + \\frac{1}{\\hat{\\beta}^2(t-1)})} \\mathbf{x}_{t-1}^2 - \\color{blue}{(\\frac{2 k_t}{w^2_t} \\mathbf{x}_t + \\frac{2\\hat{\\alpha}(t-1)}{\\hat{\\beta}^2(t-1)} \\mathbf{x}_0)} \\mathbf{x}_{t-1} \\color{black} + C(\\mathbf{x}_t, \\mathbf{x}_0) \\big) \\Big)\n  \\label{app:eq:clean_rev_cond_trans_expand}\n  \\end{split}')
('10.0.0', 'a(t)')
('10.0.0', 'b(t)')
('10.0.0', '\\begin{split}\n    a(t) \\mathbf{x}_{t} + b(t) \\mathbf{x}_{0}\n    &= (\\frac{k_t}{w^2_t} \\mathbf{x}_t + \\frac{\\hat{\\alpha}(t-1)}{\\hat{\\beta}^2(t-1)} \\mathbf{x}_0)/(\\frac{k^2_t}{w^2_t} + \\frac{1}{\\hat{\\beta}^2(t-1)}) \\\\\n    &= (\\frac{k_t}{w^2_t} \\mathbf{x}_t + \\frac{\\hat{\\alpha}(t-1)}{\\hat{\\beta}^2(t-1)} \\mathbf{x}_0) \\frac{w^2_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\\\\n    &= \\frac{k_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_t + \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_0 \\\\\n    \\label{app:eq:clean_rev_cond_trans_expand_mean}\n    \\end{split}')
('10.0.0', 'a(t) = \\frac{k_{t} \\hat{\\beta}^2(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.0.0', 'b(t) = \\frac{\\hat{\\alpha}(t-1) w_{t}^2}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.0.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0}) := \\mathcal{N}(\\hat{\\alpha}(t) \\mathbf{x}_{0}, \\hat{\\beta}^2(t) \\mathbf{I})')
('10.0.0', '\\mathbf{x}_{0} = \\frac{1}{\\hat{\\alpha}(t)} (\\mathbf{x}_{t} - \\hat{\\beta}(t) \\epsilon_{t})')
('10.0.0', '\\begin{split}\n    \\mu_{t} (\\mathbf{x}_t, \\mathbf{x}_{0})\n    &= \\frac{k_t \\hat{\\beta}^2(t-1) \\hat{\\alpha}(t) + \\hat{\\alpha}(t-1) w^2_t}{\\hat{\\alpha}(t) (k^2_t \\hat{\\beta}^2(t-1) + w^2_t)} \\mathbf{x}_{t} - \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{\\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{t} \\\\\n    \\end{split}\n    \\label{app:eq:clean_rev_cond_trans_plugin}')
('10.0.1', 'p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})')
('10.0.1', '\\theta')
('10.0.1', '\\begin{split}\n    p_{\\theta}(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_t) := \\mathcal{N}(\\mathbf{x}_{t-1}; \\mu_{\\theta}(\\mathbf{x}_{t}, \\mathbf{x}_{0}, t), s^2(t) \\mathbf{I})\n    \\end{split}\n    \\label{app:eq:def_learned_clean_rev_cond_trans}')
('10.0.1', '\\epsilon_{t}')
('10.0.1', '\\epsilon_{\\theta}(\\mathbf{x}_{t}, t)')
('10.0.1', '\\mu_{\\theta}(\\mathbf{x}_{t}, \\mathbf{x}_{0}, t)')
('10.0.1', '\\begin{split}\n    \\mu_{\\theta} (\\mathbf{x}_t, \\mathbf{x}_{0}, t)\n    &= \\frac{k_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_t + \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t}  \\left( \\frac{1}{\\hat{\\alpha}(t)} (\\mathbf{x}_{t} - \\hat{\\beta}(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t)) \\right) \\\\\n    &= \\frac{k_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_t + \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{1}{\\hat{\\alpha}(t)} \\mathbf{x}_{t} - \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{\\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\\\\n    &= \\frac{k_t \\hat{\\beta}^2(t-1) \\hat{\\alpha}(t) + \\hat{\\alpha}(t-1) w^2_t}{\\hat{\\alpha}(t) (k^2_t \\hat{\\beta}^2(t-1) + w^2_t)} \\mathbf{x}_{t} - \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{\\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\\\\n    \\end{split}\n    \\label{app:eq:learn_clean_rev_cond_trans}')
('10.0.2', '\\begin{split}\n    D_{KL} & (q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) || p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})) \\\\\n    \\propto & \\vert \\vert \\mu_{t} (\\mathbf{x}_t, \\mathbf{x}_0) - \\mu_{\\theta} (\\mathbf{x}_t, \\mathbf{x}_0, t) \\vert \\vert^2 \\\\\n    = & \\left \\vert \\left \\vert \\left( - \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{\\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{t} \\right) - \\left( - \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{\\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\right) \\right \\vert \\right \\vert^2 \\\\\n    \\propto & \\left \\vert \\left \\vert \\epsilon_t - \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\right \\vert \\right \\vert^2 \\\\\n    \\label{app:eq:clean_kl_div_loss}\n    \\end{split}')
('10.0.2', '\\mathbf{x}_{t}(\\mathbf{x}, \\epsilon) = \\hat{\\alpha}(t) \\mathbf{x} + \\hat{\\beta}(t) \\epsilon, \\ \\epsilon \\sim \\mathcal{N}(0, \\mathbf{I})')
('10.0.2', '\\begin{split}\n    \\mathcal{L}_{c}(\\mathbf{x}, t, \\epsilon) := \\big| \\big| \\epsilon - \\epsilon_{\\theta}(\\mathbf{x}_{t}(\\mathbf{x}, \\epsilon), t) \\big| \\big|^{2} \\\\\n    \\end{split}\n    \\label{app:eq:clean_loss}')
('10.1', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('10.1.0', '\\mathbf{r}')
('10.1.0', "\\begin{split}\n    q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}') := \\mathcal{N}(\\mu_{t}' (\\mathbf{x}_{t}', \\mathbf{x}_{0}'), s^2(t) \\mathbf{I}), \\ \\mu_{t}' (\\mathbf{x}_{t}', \\mathbf{x}_{0}') = a(t) \\mathbf{x}_{t}' \\color{red}+ c(t) \\mathbf{r} \\color{black}+ b(t) \\mathbf{x}_{0}'\n    \\end{split}\n    \\label{app:eq:def_backdoor_rev_cond_trans}")
('10.1.0', 'a(t) = \\frac{k_{t} \\hat{\\beta}^2(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.1.0', 'b(t) = \\frac{\\hat{\\alpha}(t-1) w_{t}^2}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.1.0', 'c(t) = \\frac{w_{t}^2 \\hat{\\rho}(t-1) - k_{t} h_{t} \\hat{\\beta}(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.1.0', "q(\\mathbf{x}_{t-1}' \\vert \\mathbf{x}_t', \\mathbf{x}_0')")
('10.1.0', "C'(\\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('10.1.0', '\\mathbf{r}')
('10.1.0', "\\begin{split}\n    & q(\\mathbf{x}_{t-1}' \\vert \\mathbf{x}_t', \\mathbf{x}_0') \\\\\n    & = q(\\mathbf{x}_t' \\vert \\mathbf{x}_{t-1}', \\mathbf{x}_0') \\frac{ q(\\mathbf{x}_{t-1}' \\vert \\mathbf{x}_0') }{ q(\\mathbf{x}_t' \\vert \\mathbf{x}_0') } \\\\\n    & \\propto \\exp \\Big(-\\frac{1}{2} \\big(\\frac{(\\mathbf{x}_t' - k_t \\mathbf{x}_{t-1}' \\color{red}- h_t \\mathbf{r} \\color{black})^2}{w^2_t} + \\frac{(\\mathbf{x}_{t-1}' - \\hat{\\alpha}(t-1) \\mathbf{x}_0' \\color{red}- \\hat{\\rho}(t-1) \\mathbf{r} \\color{black})^2}{\\hat{\\beta}^2(t-1)}  \\\\\n    & \\quad \\quad \\quad - \\frac{(\\mathbf{x}_t' - \\hat{\\alpha}(t) \\mathbf{x}_0' \\color{red}- \\hat{\\rho}(t) \\mathbf{r} \\color{black})^2}{\\hat{\\beta}^2(t)} \\big) \\Big) \\\\\n    &= \\exp \\Big(-\\frac{1}{2} \\big(\\frac{(\\mathbf{x}_t' - k_t \\mathbf{x}_{t-1}')^2 \\color{red} - 2 (\\mathbf{x}_t' - k_t \\mathbf{x}_{t-1}') h_t \\mathbf{r} + h_t^2 \\mathbf{r}^2}{w^2_t} \\\\\n    & \\quad \\quad \\quad + \\frac{(\\mathbf{x}_{t-1}' - \\hat{\\alpha}(t-1) \\mathbf{x}_0')^2 \\color{red}- 2 (\\mathbf{x}_{t-1}' - \\hat{\\alpha}(t-1) \\mathbf{x}_0') \\hat{\\rho}(t-1) \\mathbf{r} + \\hat{\\rho}(t-1)^2 \\mathbf{r}^2}{\\hat{\\beta}^2(t-1)} \\\\\n    & \\quad \\quad \\quad - \\frac{(\\mathbf{x}_t' - \\hat{\\alpha}(t) \\mathbf{x}_0' \\color{red}- \\hat{\\rho}(t) \\mathbf{r} \\color{black})^2}{\\hat{\\beta}^2(t)} \\big) \\Big) \\\\\n    &= \\exp \\Big(-\\frac{1}{2} \\big(\\frac{(\\mathbf{x}_t' - k_t \\mathbf{x}_{t-1}')^2 \\color{black}}{w^2_t} \\color{black} + \\frac{(\\mathbf{x}_{t-1}' - \\hat{\\alpha}(t-1) \\mathbf{x}_0')^2}{\\hat{\\beta}^2(t-1)} \\color{red} - \\frac{2 (\\mathbf{x}_t' - k_t \\mathbf{x}_{t-1}') h_t \\mathbf{r}}{w^2_t} \\\\\n    & \\quad \\quad \\quad \\color{black} - \\frac{\\color{red} 2 (\\mathbf{x}_{t-1}' - \\hat{\\alpha}(t-1) \\mathbf{x}_0') \\hat{\\rho}(t-1) \\mathbf{r} }{\\hat{\\beta}^2(t-1)} \\color{black} - \\frac{(\\mathbf{x}_t' - \\hat{\\alpha}(t) \\mathbf{x}_0' \\color{red}- \\hat{\\rho}(t) \\mathbf{r} \\color{black})^2}{\\hat{\\beta}^2(t)} \\big) \\Big) \\\\\n    &= \\exp\\Big( -\\frac{1}{2} \\big( \\color{orange}{(\\frac{k^2_t}{w^2_t} + \\frac{1}{\\hat{\\beta}^2(t-1)})} \\mathbf{x}_{t-1}'^2 \\color{blue} - 2 (\\frac{k_t}{w^2_t} \\mathbf{x}_t' + \\frac{\\hat{\\alpha}(t-1)}{\\hat{\\beta}^2(t-1)} \\mathbf{x}_0' \\\\\n    & \\quad \\quad \\quad \\color{red}+ (\\frac{\\hat{\\rho}(t-1)}{\\hat{\\beta}^2(t-1)} - \\frac{k_t h_t}{w_t^2}) \\mathbf{r} \\color{black}) \\mathbf{x}_{t-1}' + C'(\\mathbf{x}_t', \\mathbf{x}_0') \\big) \\Big) \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_rev_cond_trans_expand}")
('10.1.0', 'a(t)')
('10.1.0', 'b(t)')
('10.1.0', 'c(t)')
('10.1.0', '\\mathbf{r}')
('10.1.0', "\\vspace{-2mm}\n    \\begin{split}\n    a(t) \\mathbf{x}_{t}' \\color{red} + c(t) \\mathbf{r} \\color{black} + b(t) \\mathbf{x}_{0}'\n    &= (\\frac{k_t}{w^2_t} \\mathbf{x}_t' + \\frac{\\hat{\\alpha}(t-1)}{\\hat{\\beta}^2(t-1)} \\mathbf{x}_0' \\color{red}+ (\\frac{\\hat{\\rho}(t-1)}{\\hat{\\beta}^2(t-1)} - \\frac{k_t h_t}{w_t^2}) \\mathbf{r} \\color{black})/(\\frac{k^2_t}{w^2_t} + \\frac{1}{\\hat{\\beta}^2(t-1)}) \\\\\n    &= (\\frac{k_t}{w^2_t} \\mathbf{x}_t' + \\frac{\\hat{\\alpha}(t-1)}{\\hat{\\beta}^2(t-1)} \\mathbf{x}_0' \\color{red} + (\\frac{\\hat{\\rho}(t-1)}{\\hat{\\beta}^2(t-1)} - \\frac{k_t h_t}{w_t^2}) \\mathbf{r} \\color{black}) \\frac{w^2_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\\\\n    &= \\frac{k_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_t' + \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_0' \\\\ \n    & \\quad \\color{red} + (\\frac{w^2_t \\hat{\\rho}(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} - \\frac{k_t h_t  \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t}) \\mathbf{r} \\\\\n    &= \\frac{k_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_t' + \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_0' \\color{red} \\\\\n    & \\quad \\color{red} + \\frac{w^2_t \\hat{\\rho}(t-1) - k_t h_t  \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{r} \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_rev_cond_trans_expand_mean}\n    \\vspace{-2mm}")
('10.1.0', 'a(t) = \\frac{k_{t} \\hat{\\beta}^2(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.1.0', 'b(t) = \\frac{\\hat{\\alpha}(t-1) w_{t}^2}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.1.0', 'c(t) = \\frac{w_{t}^2 \\hat{\\rho}(t-1) - k_{t} h_{t} \\hat{\\beta}(t-1)}{k_{t}^2 \\hat{\\beta}^2(t-1) + w_{t}^2}')
('10.2', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}')")
('10.2', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('10.2', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}')")
('10.2', 'p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t})')
('10.2', '\\mathbf{f}: \\mathbb{R}^{d} \\times \\mathbb{R} \\to \\mathbb{R}^d')
('10.2', '\\mathbf{g}: \\mathbb{R} \\to \\mathbb{R}')
('10.2', '\\zeta \\in [0, 1]')
('10.2', 'd \\mathbf{x}_{t} = \\mathbf{f}(\\mathbf{x}_{t}, t) dt + g(t) d \\bar{\\mathbf{w}}')
('10.2', 'd \\mathbf{x}_{t} = [ \\mathbf{f}(\\mathbf{x}_{t}, t) - \\frac{1 - \\zeta}{2} g^2(t) \\nabla_{\\mathbf{x}_{t}} \\log p(\\mathbf{x}_{t})] dt + \\sqrt{\\zeta} \\mathbf{g}(t) d \\bar{\\mathbf{w}}')
('10.2', '\\mathbf{x}_{t} \\in \\mathbb{R}^d, t \\in [0, T]')
('10.2', 'p(\\mathbf{x}_{t})')
('10.2', '\\bar{\\mathbf{w}} \\in \\mathbb{R}^d')
('10.2', 'p(\\mathbf{x}_{t})')
('10.2', 'p(\\mathbf{x}, t)')
('10.2', 'd \\mathbf{x}_{t} = f(t) \\mathbf{x}_{t} dt + g(t) d \\bar{\\mathbf{w}}')
('10.2', '\\begin{split}\n    \\vspace{-4mm}\n    \\frac{\\partial }{\\partial t} p(\\mathbf{x}, t) & = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} (\\mathbf{f}_{i}(\\mathbf{x}, t) \\cdot p(\\mathbf{x}, t)) + \\frac{1}{2} \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\frac{\\partial^2}{\\partial \\mathbf{x}_{i} \\partial \\mathbf{x}_{j}} (g^2(t) \\cdot p(\\mathbf{x}, t)) \\\\ \n    & = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} (\\mathbf{f}(\\mathbf{x}, t) \\cdot p(\\mathbf{x}, t)) + \\frac{\\zeta}{2}  \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\frac{\\partial^2}{\\partial \\mathbf{x}_{i} \\partial \\mathbf{x}_{j}}  (g^2(t) \\cdot p(\\mathbf{x}, t)) \\\\ \n    & \\quad + \\frac{1 - \\zeta}{2} \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\frac{\\partial^2}{\\partial \\mathbf{x}_{i} \\partial \\mathbf{x}_{j}}  (g^2(t) \\cdot p(\\mathbf{x}, t)) \\\\\n    & = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} (\\mathbf{f}(\\mathbf{x}, t) \\cdot p(\\mathbf{x}, t)) + \\frac{\\zeta}{2}  \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\frac{\\partial^2}{\\partial \\mathbf{x}_{i} \\partial \\mathbf{x}_{j}}  (g^2(t) \\cdot p(\\mathbf{x}, t)) \\\\\n    & \\quad + \\frac{1 - \\zeta}{2} \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} (g^2(t) \\cdot \\frac{p(\\mathbf{x}, t)}{p(\\mathbf{x}, t)}\\nabla_{\\mathbf{x}} p(\\mathbf{x}, t)) \\\\\n  \\end{split}\n  \\vspace{-6mm}\n  \\label{app:eq:lemma_sde2ode_fp0}')
('10.2', '\\log p(\\mathbf{x}, t) \\nabla_{\\mathbf{x}} p(\\mathbf{x}, t) = \\frac{\\nabla_{\\mathbf{x}} p(\\mathbf{x}, t)}{p(\\mathbf{x}, t)}')
('10.2', '\\begin{split}\n    \\vspace{-4mm}\n    & = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} (\\mathbf{f}(\\mathbf{x}, t) \\cdot p(\\mathbf{x}, t)) + \\frac{\\zeta}{2}  \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\frac{\\partial^2}{\\partial \\mathbf{x}_{i} \\partial \\mathbf{x}_{j}}  (g^2(t) \\cdot p(\\mathbf{x}, t)) \\\\\n    & \\quad + \\frac{1 - \\zeta}{2} \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} ((g^2(t) \\cdot \\nabla_{\\mathbf{x}} \\log p(\\mathbf{x}, t)) \\cdot p(\\mathbf{x}, t)) \\\\\n    & = - \\sum_{i=1}^{d} \\frac{\\partial}{\\partial \\mathbf{x}_{i}} ((\\mathbf{f}(\\mathbf{x}, t) - \\frac{1 - \\zeta}{2} (g^2(t) \\cdot \\nabla_{\\mathbf{x}} \\log p(\\mathbf{x}, t))) \\cdot p(\\mathbf{x}, t)) \\\\\n    & \\quad + \\frac{\\zeta}{2}  \\sum_{i=1}^{d} \\sum_{j=1}^{d} \\frac{\\partial^2}{\\partial \\mathbf{x}_{i} \\partial \\mathbf{x}_{j}}  (g^2(t) \\cdot p(\\mathbf{x}, t)) \\\\\n    \\end{split}\n    \\vspace{-6mm}\n    \\label{app:eq:lemma_sde2ode_fp}')
('10.2', '\\zeta')
('10.2', '\\zeta = 0')
('10.2', '\\zeta = 1')
('10.2', '\\begin{split}\n    d \\mathbf{x}_{t} = [ \\mathbf{f}(\\mathbf{x}_{t}, t) - \\frac{1 - \\zeta}{2} g^2(t) \\nabla_{\\mathbf{x}_{t}} \\log p(\\mathbf{x}_{t})] dt + \\sqrt{\\zeta} \\mathbf{g}(t) d \\bar{\\mathbf{w}}\n    \\end{split}\n\\label{app:eq:lemma_sde2ode_arb_rand}')
('10.2', '\\hfill \\blacksquare')
('10.2.0', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}') \\approx q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('10.2.0', '\\mathbf{x}_{0}')
('10.2.0', "\\mathbf{x}_{0} = \\frac{\\mathbf{x}_{t}' - \\hat{\\rho}(t) \\mathbf{r} - \\hat{\\beta}(t) \\epsilon_{t}}{\\hat{\\alpha}(t)}")
('10.2.0', "q(\\mathbf{x}_{t}')")
('10.2.0', '\\epsilon_{t}')
('10.2.0', "- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}')")
('10.2.0', "\\begin{split}\n    \\mathbf{x}_{t-1}' & = a(t) \\mathbf{x}_{t}' + b(t) \\frac{\\mathbf{x}_{t}' - \\hat{\\rho}(t) \\mathbf{r} - \\hat{\\beta}(t) (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}'))}{\\hat{\\alpha}(t)} + c(t) \\mathbf{r} + s(t) \\epsilon_{t}, \\ \\epsilon_{t} \\sim \\mathcal{N}(0, \\mathbf{I}) \\\\\n    & = (a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)}) \\mathbf{x}_{t}' + (c(t) - \\frac{b(t) \\hat{\\rho}(t)}{\\hat{\\alpha}(t)}) \\mathbf{r} - \\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)} (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}')) + s(t) \\epsilon_{t}\n    \\end{split}\n    \\label{app:eq:backdoor_reversed_reparametrization}")
('10.2.0', "d \\mathbf{x}_{t}'")
('10.2.0', "\\begin{split}\n    d \\mathbf{x}_{t}' = \\big[ (a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)} - 1) \\mathbf{x}_{t}' + (c(t) - \\frac{b(t) \\hat{\\rho}(t)}{\\hat{\\alpha}(t)}) \\mathbf{r} - \\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)} (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}')) \\big] dt + s(t) d \\bar{\\mathbf{w}}\n    \\end{split}\n    \\label{app:eq:backdoor_reversed_sde_raw}")
('10.2.0', "\\begin{split}\n    d \\mathbf{x}_{t}' = \\big[ F(t) \\mathbf{x}_{t}' - G^2(t) (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') - \\frac{H(t)}{G^2(t)} \\mathbf{r}) \\big] dt + s(t) d \\bar{\\mathbf{w}}\n    \\end{split}\n    \\label{app:eq:backdoor_reversed_sde}")
('10.2.0', 'F(t) = a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)} - 1')
('10.2.0', 'H(t) = c(t) - \\frac{b(t) \\hat{\\rho}(t)}{\\hat{\\alpha}(t)}')
('10.2.0', 'G(t) = \\sqrt{\\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)}}')
('10.2.0', 'q(\\mathbf{x}_{t} | \\mathbf{x}_{0})')
('10.2.0', "q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}')")
('10.2.0', 's(t)')
('10.2.0', 's(t) = \\sqrt{\\hat{\\beta}(t)} G(t) = \\sqrt{\\frac{b(t)}{\\hat{\\alpha}(t)}} \\hat{\\beta}(t)')
('10.2.0', '\\zeta \\in [0, 1]')
('10.2.0', "\\begin{split}\n    d \\mathbf{x}_{t}' & = \\big[ F(t) \\mathbf{x}_{t}' - G^2(t) (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') - \\frac{H(t)}{G^2(t)} \\mathbf{r}) \\big] dt + s(t) d \\bar{\\mathbf{w}} \\\\\n    & = \\big[ F(t) \\mathbf{x}_{t}' - G^2(t) (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') - \\frac{H(t)}{G^2(t)} \\mathbf{r}) - \\frac{1 - \\zeta}{2} s^2(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') \\big] dt + \\sqrt{\\zeta} s(t) d \\bar{\\mathbf{w}} \\\\\n    % & = \\big[ F(t) \\mathbf{x}_{t} - G^2(t) (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}} \\log q(\\mathbf{x}_{t}) - \\frac{H(t)}{G^2(t)} \\mathbf{r}) + \\frac{1 - \\zeta}{2} G^2(t) ( - \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}} \\log q(\\mathbf{x}_{t})) \\big] dt + \\sqrt{\\zeta} s(t) d \\bar{\\mathbf{w}} \\\\\n    & = \\big[ F(t) \\mathbf{x}_{t}' - \\frac{1 + \\zeta}{2} G^2(t) \\underbrace{(- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r})}_{\\text{Backdoor Score Function}} \\big] dt + G(t) \\sqrt{\\zeta \\hat{\\beta}(t)} d \\bar{\\mathbf{w}} \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_reversed_sde_arb_stochasticity}")
('10.2.1', 'q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}) \\approx q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})')
('10.2.1', '\\mathbf{x}_{0}')
('10.2.1', '\\mathbf{x}_{0} = \\frac{\\mathbf{x}_{t} - \\hat{\\beta}(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t)}{\\hat{\\alpha}(t)}')
('10.2.1', '\\mathbf{x}_{t} = \\hat{\\alpha}(t) \\mathbf{x}_{0} + \\hat{\\beta}(t) \\epsilon_{t}')
('10.2.1', '\\epsilon_{t}')
('10.2.1', '\\epsilon_{\\theta}(\\mathbf{x}_{t}, t)')
('10.2.1', '\\begin{split}\n    \\mathbf{x}_{t-1} & = a(t) \\mathbf{x}_{t} + b(t) \\frac{\\mathbf{x}_{t} - \\hat{\\beta}(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t)}{\\hat{\\alpha}(t)} + s(t) \\epsilon_{t}, \\ \\epsilon_{t} \\sim \\mathcal{N}(0, \\mathbf{I}) \\\\\n    & = (a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)}) \\mathbf{x}_{t} - \\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) + s(t) \\epsilon_{t}\n    \\end{split}\n    \\label{app:eq:learned_reversed_reparametrization}')
('10.2.1', 'd \\mathbf{x}_{t}')
('10.2.1', '\\begin{split}\n    d \\mathbf{x}_{t} = \\big[ (a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)} - 1) \\mathbf{x}_{t} - \\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\big] dt + s(t) d \\bar{\\mathbf{w}}\n    \\end{split}\n    \\label{app:eq:learned_reversed_sde_raw}')
('10.2.1', 'F(t) = a(t) + \\frac{b(t)}{\\hat{\\alpha}(t)} - 1')
('10.2.1', 'G(t) = \\sqrt{\\frac{b(t) \\hat{\\beta}(t)}{\\hat{\\alpha}(t)}}')
('10.2.1', 's(t) = \\sqrt{\\frac{b(t)}{\\hat{\\alpha}(t)}} \\hat{\\beta}(t)')
('10.2.1', '\\begin{split}\n    d \\mathbf{x}_{t} = \\big[ F(t) \\mathbf{x}_{t} - G^2(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\big] dt + s(t) d \\bar{\\mathbf{w}}\n    \\end{split}\n    \\label{app:eq:learned_reversed_sde}')
('10.2.1', '\\zeta \\in [0, 1]')
('10.2.1', '\\epsilon_{\\theta}')
('10.2.1', '\\epsilon_{\\theta} (\\mathbf{x}_{t}, t) = - \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}} \\log q(\\mathbf{x}_{t})')
('10.2.1', '\\begin{split}\n    d \\mathbf{x}_{t} = \\big[ F(t) \\mathbf{x}_{t} - \\frac{1 + \\zeta}{2} G^2(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t) \\big] dt + G(t) \\sqrt{\\zeta \\hat{\\beta}(t)} d \\bar{\\mathbf{w}}\n    \\end{split}\n    \\label{app:eq:learned_reversed_sde_arb_randomness}')
('10.2.2', "\\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}')")
('10.2.2', "\\begin{split}\n    \\mathbb{E}_{\\mathbf{x}_{t}', \\mathbf{x}_{0}'} & \\big[ \\big| \\big| (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}', t) \\big| \\big|^{2} \\big] \\\\\n    \\propto & \\big| \\big| \\epsilon - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r}(\\mathbf{x}_{0}, \\mathbf{g}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{x}_{0}', \\mathbf{r}(\\mathbf{x}_{0}, \\mathbf{g}), \\epsilon), t) \\big| \\big|^{2} \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_score_loss_raw}")
('10.2.2', "\\begin{split}\n    \\mathcal{L}_{p}(\\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\zeta) := \\big| \\big| \\epsilon - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r}(\\mathbf{x}, \\mathbf{g}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{y}, \\mathbf{r}(\\mathbf{x}, \\mathbf{g}), \\epsilon), t) \\big| \\big|^{2} \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_score_loss}")
('10.3.0', '\\epsilon_{\\theta}(\\mathbf{x}_{0}, \\mathbf{c})')
('10.3.0', '\\arg \\min_{\\theta} - \\log p_{\\theta}(\\mathbf{x}_{0}, \\mathbf{c})')
('10.3.0', '\\mathbf{c}')
('10.3.0', 'D_{\\mathbf{x}_{i:T}}')
('10.3.0', '\\mathbf{x}_{i}, \\dots , \\mathbf{x}_{T}, \\ \\mathbf{x}_{t} \\in \\mathbb{R}^{d}, t \\in [i, T], i \\leq T')
('10.3.0', 'L_{VLB}^{C}')
('10.3.0', '\\begin{split}\n    - \\log p_{\\theta}(\\mathbf{x}_{0}, \\mathbf{c}) & = - \\mathbb{E}_{q(\\mathbf{x}_{0})} \\big[ \\log p_{\\theta}(\\mathbf{x}_{0}, \\mathbf{c}) \\big] \\\\\n    & = - \\mathbb{E}_{q(\\mathbf{x}_{0})} \\big[ \\log \\int_{D_{\\mathbf{x}_{1:T}}} p_{\\theta}(\\mathbf{x}_{0}, \\dots , \\mathbf{x}_{T}, \\mathbf{c}) d \\mathbf{x}_{1} \\dots d \\mathbf{x}_{T} \\big] \\\\\n    & = - \\mathbb{E}_{q(\\mathbf{x}_{0})} \\big[ \\log \\int_{\\mathbf{x}_{1} \\dots \\mathbf{x}_{T}} q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0}) \\frac{p_{\\theta}(\\mathbf{x}_{0}, \\dots , \\mathbf{x}_{T}, \\mathbf{c})}{q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0})} d \\mathbf{x}_{1} \\dots d \\mathbf{x}_{T} \\big] \\\\\n    & = - \\mathbb{E}_{q(\\mathbf{x}_{0})} \\big[ \\log \\mathbb{E}_{q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0})} \\big[ \\frac{p_{\\theta}(\\mathbf{x}_{0}, \\dots , \\mathbf{x}_{T} \\mathbf{c})}{q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0})} \\big] \\big] \\\\\n    & \\leq - \\mathbb{E}_{q(\\mathbf{x}_{0}, \\dots , \\mathbf{x}_{T})} \\big[ \\log \\frac{p_{\\theta}(\\mathbf{x}_{0}, \\dots , \\mathbf{x}_{T}, \\mathbf{c})}{q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0})} \\big] = L_{VLB}^{C} \\\\\n    \\end{split}\n    \\label{app:eq:conditional_NLL}')
('10.3.1', 'D_{KL}(q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) || p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c}))')
('10.3.1', '\\mathbb{E}_{q(\\mathbf{x}_{0}, \\dots , \\mathbf{x}_{T})}')
('10.3.1', '\\mathbb{E}_{q}')
('10.3.1', '\\mathbf{x}_{t}')
('10.3.1', 't')
('10.3.1', '\\mathbf{x}_{t-1}')
('10.3.1', '\\mathbf{c}')
('10.3.1', '\\begin{split}\n    L_{VLB}^{C} & = - \\mathbb{E}_{q} \\big[ \\log \\frac{p_{\\theta}(\\mathbf{x}_{0}, \\dots \\mathbf{x}_{T}, \\mathbf{c})}{q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0})} \\big] = \\mathbb{E}_{q} \\big[ \\log \\frac{q(\\mathbf{x}_{1}, \\dots , \\mathbf{x}_{T} | \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{0}, \\dots, \\mathbf{x}_{T} \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ \\log \\frac{\\prod_{t=1}^{T} q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1})}{p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c}) \\prod_{t=1}^{T} p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ -\\log p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c}) + \\sum_{t=1}^{T} \\log \\frac{q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1})}{p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ -\\log p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c}) + \\sum_{t=2}^{T} \\log \\frac{q(\\mathbf{x}_{t} | \\mathbf{x}_{t-1})}{p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} + \\log \\frac{q(\\mathbf{x}_{1} | \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{0} | \\mathbf{x}_{1}, \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ -\\log p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c}) + \\sum_{t=2}^{T} \\log \\big( \\frac{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} \\cdot \\frac{q(\\mathbf{x}_{t} | \\mathbf{x}_{0})}{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{0})} \\big) + \\log \\frac{q(\\mathbf{x}_{1} | \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{0} | \\mathbf{x}_{1}, \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ -\\log p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c}) + \\sum_{t=2}^{T} \\log \\frac{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} + \\sum_{t=2}^{T} \\log \\frac{q(\\mathbf{x}_{t} | \\mathbf{x}_{0})}{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{0})} + \\log \\frac{q(\\mathbf{x}_{1} | \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{0} | \\mathbf{x}_{1}, \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ -\\log p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c}) + \\sum_{t=2}^{T} \\log \\frac{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} + \\log \\frac{q(\\mathbf{x}_{T} | \\mathbf{x}_{0})}{q(\\mathbf{x}_{1} | \\mathbf{x}_{0})} + \\log \\frac{q(\\mathbf{x}_{1} | \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{0} | \\mathbf{x}_{1}, \\mathbf{c})} \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ \\log \\frac{q(\\mathbf{x}_{T} | \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c})} + \\sum_{t=2}^{T} \\log \\frac{q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0})}{p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})} - \\log p_{\\theta}(\\mathbf{x}_{0} | \\mathbf{x}_{1}, \\mathbf{c}) \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ D_{KL}(q(\\mathbf{x}_{T} | \\mathbf{x}_{0}) || p_{\\theta}(\\mathbf{x}_{T}, \\mathbf{c})) + \\sum_{t=2}^{T} D_{KL}(q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) || p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})) - \\log p_{\\theta}(\\mathbf{x}_{0} | \\mathbf{x}_{1}, \\mathbf{c}) \\big] \\\\\n    & = \\mathbb{E}_{q} \\big[ \\mathcal{L}_{T}^{C}(\\mathbf{x}_{T}, \\mathbf{x}_{0}, \\mathbf{c}) + \\sum_{t=2}^{T} \\mathcal{L}_{t}^{C}(\\mathbf{x}_{t}, \\mathbf{x}_{t-1}, \\mathbf{x}_{0}, \\mathbf{c}) - \\mathcal{L}_{0}^{C}(\\mathbf{x}_{1}, \\mathbf{x}_{0}, \\mathbf{c}) \\big] \\\\\n    \\end{split}\n    \\label{app:eq:conditional_VLBO}')
('10.3.2', 'p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})')
('10.3.2', '\\begin{split}\n    p_{\\theta}(\\mathbf{x}_{t-1} \\vert \\mathbf{x}_t) := \\mathcal{N}(\\mathbf{x}_{t-1}; \\mu_{\\theta}(\\mathbf{x}_{t}, \\mathbf{x}_{0}, t, \\mathbf{c}), s^2(t) \\mathbf{I})\n    \\end{split}\n    \\label{app:eq:def_clean_rev_cond_trans_caption}')
('10.3.2', '\\epsilon_{\\theta}(\\mathbf{x}_{t}, t, \\mathbf{c})')
('10.3.2', '\\epsilon_{\\theta}(\\mathbf{x}_{t}, t)')
('10.3.2', '\\begin{split}\n    \\mu_{\\theta} (\\mathbf{x}_t, \\mathbf{x}_{0}, t, \\mathbf{c})\n    &= \\frac{k_t \\hat{\\beta}^2(t-1)}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\mathbf{x}_t + \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t}  \\left( \\frac{1}{\\hat{\\alpha}(t)} (\\mathbf{x}_{t} - \\hat{\\beta}(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t, \\mathbf{c})) \\right) \\\\\n    &= \\frac{k_t \\hat{\\beta}^2(t-1) \\hat{\\alpha}(t) + \\hat{\\alpha}(t-1) w^2_t}{\\hat{\\alpha}(t) (k^2_t \\hat{\\beta}^2(t-1) + w^2_t)} \\mathbf{x}_{t} - \\frac{\\hat{\\alpha}(t-1) w^2_t}{k^2_t \\hat{\\beta}^2(t-1) + w^2_t} \\frac{\\hat{\\beta}(t)}{\\hat{\\alpha}(t)} \\epsilon_{\\theta}(\\mathbf{x}_{t}, t, \\mathbf{c}) \\\\\n    \\end{split}\n    % \\label{app:eq:learn_clean_rev_cond_trans}')
('10.3.2', '\\begin{split}\n    & D_{KL}(q(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{x}_{0}) || p_{\\theta}(\\mathbf{x}_{t-1} | \\mathbf{x}_{t}, \\mathbf{c})) \\propto\\vert \\vert \\mu_{t} (\\mathbf{x}_t, \\mathbf{x}_0) - \\mu_{\\theta} (\\mathbf{x}_t, \\mathbf{x}_0, t, \\mathbf{c}) \\vert \\vert^2 \\propto \\left \\vert \\left \\vert \\epsilon_t - \\epsilon_{\\theta}(\\mathbf{x}_{t}, t, \\mathbf{c}) \\right \\vert \\right \\vert^2 \\\\\n    \\label{app:eq:clean_conditional_kl_div_loss}\n    \\end{split}')
('10.3.2', '\\begin{split}\n    \\mathcal{L}_{c}^{C}(\\mathbf{x}, t, \\epsilon, \\mathbf{c}) := \\big| \\big| \\epsilon - \\epsilon_{\\theta}(\\mathbf{x}_{t}(\\mathbf{x}, \\epsilon), t, \\mathbf{c}) \\big| \\big|^{2} \\\\\n    \\end{split}\n    \\label{app:eq:clean_conditional_loss}')
('10.3.3', "q(\\mathbf{x}_{t-1}' | \\mathbf{x}_{t}', \\mathbf{x}_{0}')")
('10.3.3', '\\begin{split}\n    d \\mathbf{x}_{t} = \\big[ F(t) \\mathbf{x}_{t} - \\frac{1 + \\zeta}{2} G^2(t) \\epsilon_{\\theta}(\\mathbf{x}_{t}, t, \\mathbf{c}) \\big] dt + G(t) \\sqrt{\\zeta \\hat{\\beta}(t)} d \\bar{\\mathbf{w}}\n    \\end{split}\n  \\label{app:eq:learned_conditional_reversed_sde}')
('10.3.3', "\\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}')")
('10.3.3', "\\mathbf{x}_{t}'(\\mathbf{x}, \\mathbf{r}, \\epsilon) = \\hat{\\alpha}(t) \\mathbf{x} + \\hat{\\rho}(t) \\mathbf{r} + \\hat{\\beta}(t) \\epsilon")
('10.3.3', "\\begin{split}\n    \\mathbb{E}_{\\mathbf{x}_{t}', \\mathbf{x}_{0}'} & \\big[ \\big| \\big| (- \\hat{\\beta}(t) \\nabla_{\\mathbf{x}_{t}'} \\log q(\\mathbf{x}_{t}' | \\mathbf{x}_{0}') - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}, t, \\mathbf{c}) \\big| \\big|^{2} \\big] \\\\\n    \\propto & \\big| \\big| \\epsilon - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r}(\\mathbf{x}_{0}, \\mathbf{g}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{x}_{0}', \\mathbf{r}(\\mathbf{x}_{0}, \\mathbf{g}), \\epsilon), t, \\mathbf{c}) \\big| \\big|^{2} \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_conditional_score_loss_raw}")
('10.3.3', "\\begin{split}\n    \\mathcal{L}_{p}^{CI}(\\mathbf{x}, t, \\epsilon, \\mathbf{g}, \\mathbf{y}, \\mathbf{c}, \\zeta) := \\big| \\big| \\epsilon - \\frac{2 H(t)}{(1 + \\zeta)G^2(t)} \\mathbf{r}(\\mathbf{y}, \\mathbf{g}) - \\epsilon_{\\theta}(\\mathbf{x}_{t}'(\\mathbf{y}, \\mathbf{r}(\\mathbf{x}, \\mathbf{g}), \\epsilon), t, \\mathbf{c}) \\big| \\big|^{2} \\\\\n    \\end{split}\n    \\label{app:eq:backdoor_conditional_score_loss}")
('12.2', '\\times')
('12.2', '\\times')
('12.3', '\\mathbf{r}')
('12.3', '\\mathbf{g}')
('12.5', '\\zeta = 0')
('12.5', '\\zeta')
('12.7', '\\mathcal{N}(0, 0.3)')
('13.7', '\\eta')
('13.7', '\\eta')
