('2', '100\\%')
('3.0', 'N')
('3.0', 'X = \\{x_1, x_2, ..., x_N\\}')
('3.0', 'Y = \\{y_1, y_2, ..., y_N\\}')
('3.0', 'K')
('3.0', 'y_i')
('3.0', 'y_i \\in \\{0, 1\\}^K')
('3.0', 'y_{i,j}')
('3.0', 'j')
('3.0', 'x_i')
('3.0', 'y_i \\in \\{e_j\\}_{j\\in [K]}')
('3.0', 'e_j')
('3.0', 'j')
('3.0', 'j')
('3.0', 'L, U \\subset X')
('3.0', 'L \\cap U = \\emptyset')
('3.0', 'L_0 \\subset X')
('3.0', 'U_0 = X\\backslash L_0')
('3.0', '\\mathcal{A}')
('3.0', '(L, U)')
('3.0', '\\mathcal{A}(L, U) \\in U')
('3.1', 'M')
('3.1', 't')
('3.1', 'B')
('3.1', 'B')
('3.1', '\\{(x^{t, j}, y^{t, j})\\}_{j=1}^B')
('3.1', 'r: X \\times Y \\rightarrow \\mathbb{R}')
('3.1', '\\bar{A}')
('3.1', 'A')
('3.1', '\\bar{A}')
('3.1', 'B')
('3.1', 'A')
('3.1', 'B')
('3.1', 't \\in [T]')
('3.1', '\\mathbb{P}_{t, 1}, ..., \\mathbb{P}_{t, M}')
('3.1', 'j\\in [B]')
('3.1', 'r^{t, j} \\stackrel{iid}{\\sim}\\mathbb{P}_{t, \\alpha_{t, j}}')
('3.1', 'i\\in [M]')
('3.1', 'P_{t, i}')
('3.1', 't')
('4.0', 'y \\in \\{0, 1\\}^K')
('4.0', 'y\\in \\{e_i\\}_{i=1}^K')
('4.0', 't \\in [T]')
('4.0', '\\begin{aligned}\n        r_{div}^t(x, y) = \\frac{1}{K}\\sum_{i=1}^K \\frac{1}{\\max(1, \\text{COUNT}^t(i))} y_{:i} =: \\langle v_{div}^{t}, y \\rangle\n    \n\\end{aligned}')
('4.0', '\\text{COUNT}^t(i)')
('4.0', 'i')
('4.0', 't-1')
('4.0', 'y_{:i}')
('4.0', 'i')
('4.0', 'y')
('4.0', 'v_{div}^t')
('4.0', '0')
('4.0', '1')
('4.0', 'y')
('4.0', '\\begin{aligned}\n        r_{search}(x, y) = \\frac{1}{K}\\sum_{i=1}^K y_{:i} =: \\langle v_{pos}, y\\rangle \\quad \\text{ where } v_{pos} = \\frac{1}{K}\\vec{1}.\n    \n\\end{aligned}')
('4.0', 'v_{dom}^t \\in [-\\frac{1}{K}, \\frac{1}{K}]^K')
('4.0', 't')
('4.0', 'r_{dom}^t(x, y) = \\langle v_{dom}^t, y\\rangle')
('4.1', 'v_t \\in [-\\frac{1}{K}, \\frac{1}{K}]^K')
('4.1', '\\mathcal{A}_i \\in A')
('4.1', 'y')
('4.1', '\\mathbb{P}_{\\theta^i}')
('4.1', '\\theta^i')
('4.1', 'P_{\\theta^i}')
('4.1', '\\mathbb{P}_{\\theta^i}')
('4.1', '\\theta^i \\in [0, 1]^K')
('4.1', '\\theta^i \\in \\Delta^{(K - 1)}')
('4.1', 'K')
('4.1', 't')
('4.1', 'v^t')
('4.1', '\\alpha^{t, 1}, ..., \\alpha^{t, B}')
('4.1', 'y^{t, 1}, ..., y^{t, B}')
('4.1', 'y^{t, j} \\stackrel{iid}{\\sim}\\mathbb{P}_{\\theta^{\\alpha_{t, j}}}')
('4.1', 'r^{t, j} = \\langle v^t, y^{t, j}\\rangle')
('4.1', '\\phi_i^t = \\text{vec}(v^t e_i^\\top) \\in [-\\frac{1}{K}, \\frac{1}{K}]^{KM}')
('4.1', '\\text{vec}(\\cdot)')
('4.1', 'v^t')
('4.1', 'i')
('4.1', 'e_i')
('4.1', 'r = \\langle \\phi_i^t, \\theta^\\star\\rangle + \\varepsilon')
('4.1', 'i')
('4.1', '\\theta^\\star = \\text{vec}(\\left[\\theta^1, \\theta^2, ..., \\theta^M\\right]) \\in [0, 1]^{KM}')
('4.1', '\\varepsilon')
('4.1', '\\{y^{t, j}\\}_{j=1}^B')
('4.1', '\\theta^1, ..., \\theta^M')
('4.1', '\\theta^1, ..., \\theta^M')
('4.1', '\\widetilde{O}(BM^{\\frac{3}{4}}K^{\\frac{3}{4}} \\sqrt{T})')
('4.1', 'y^{t, j} \\sim \\mathbb{P}_{\\theta^{\\alpha^{t,j}}}')
('4.1', '\\widetilde{O}(B\\sqrt{MT})')
('4.2', '\\theta^1, ..., \\theta^M')
('4.2', '\\text{Unif}(\\Omega)')
('4.2', '\\Omega')
('4.2', '\\Omega = \\Delta^{(t-1)}')
('4.2', '[0, 1]^K')
('4.2', '\\theta^i')
('4.2', 'i \\in [M]')
('4.2', 'z \\in [0, 1]^d')
('4.2', 'a, b \\in \\mathcal{Z}^{+^d}')
('4.2', 'z \\sim \\text{Beta}(a, b)')
('4.2', 'i\\in [d]')
('4.2', 'z_i \\sim \\text{Beta}(a_i, b_i)')
('4.2', 't')
('4.2', 'B')
('5', '\\pi')
('5', '\\Theta = \\{\\theta^1, ..., \\theta^M\\}')
('5', '\\begin{aligned}\n    R(\\pi, \\Theta) := \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B \\max_{i\\in[M]} \\langle v^t, \\theta^i - \\theta^{\\alpha^{t,j}} \\rangle \\right]\n\\end{aligned}')
('5', '\\begin{aligned}\n    BR(\\pi) := \\mathbb{E}_{\\theta^i \\sim \\mathbb{P}_0(\\Omega), i\\in [M]} \\left[R(\\pi, \\{\\theta^i\\}_{i=1}^M)\\right]\n\\end{aligned}')
('5', '\\Omega')
('5', '\\theta^i')
('5', '\\mathbb{P}_0(\\Omega)')
('5', '\\Omega = [0, 1]^K')
('5', '\\Omega = \\Delta^{(K-1)}')
('5', '\\mathbb{P}_0(\\Omega) = \\mathop{\\mathrm{uniform}}(\\Omega)')
('5', '\\mathbb{P}_0')
('5', 'y^{t, j}')
('5', '\\theta^{\\alpha^{t,j}}')
('5', '\\pi_{context}')
('5', '\\begin{aligned}\n    BR(\\pi_{context}) \\leq \\widetilde{O}(BM^{\\frac{3}{4}}K^{\\frac{3}{4}}\\log T \\sqrt{T})\n\\end{aligned}')
('5', 'B')
('5', 'M')
('5', 'K')
('5', 'T')
('5', 'y^{t,j}')
('5', 'r^{t, j}')
('5', '\\begin{aligned}\n        BR(\\texttt{TAILOR} ) \\leq O(B\\sqrt{MT(\\log T + \\log M)})\n    \n\\end{aligned}')
('5', 'B')
('5', 'M')
('5', 'T')
('5', 'r^{t, j}')
('5', 't \\in [T]')
('5', 'j\\in [B]')
('5', '\\theta^1, ..., \\theta^M')
('5', 'y')
('5', 't')
('5', '\\langle v^t, \\theta^1 \\rangle')
('5', '\\langle v^t, \\theta^M \\rangle')
('5', '\\{\\langle v^t, y \\rangle')
('5.0', 'N_{train}')
('5.0', '\\mathcal{A}_i')
('5.0', 'P_i')
('5.0', 'Q_i')
('5.0', '\\mathcal{A}_i')
('5.0', 'O(N_{train} + TP_i + TBQ_i)')
('5.0', 'T')
('5.0', 'B')
('5.0', 'O(N_{train} + T\\cdot (\\sum_{i=1}^M P_i) + TB\\cdot \\max_{i\\in [M]} Q_i)')
('5.0', '20\\%')
('6.0', 'K - 1')
('6.0', 'K')
('6.0', 'K')
('6.0', 'N')
('6.0', '\\frac{1}{K} \\sum_{i\\in [K]} (N_i / N)')
('6.0', 'N_i')
('6.0', 'i')
('6.0', 'K')
('6.0', 'N')
('6.0', '40')
('6.0', '162770')
('6.0', '.0273')
('6.0', '.2257')
('6.0', '80')
('6.0', '82081')
('6.0', '.0028')
('6.0', '.0367')
('6.0', '20')
('6.0', '10000')
('6.0', '.0749')
('6.0', '.0721')
('6.0', '10')
('6.0', '12948')
('6.0', '.1572')
('6.0', '.1200')
('6.0', '1000')
('6.0', '1281167')
('6.0', '.5631')
('6.0', '49')
('6.0', '23236')
('6.0', '.0545')
('6.0', '256')
('6.0', '24486')
('6.0', '.0761')
('6.0', '2')
('6.0', '50000')
('6.0', '.1111')
('6.0', '10')
('6.0', '50000')
('6.0', '.0110')
('6.0', '2')
('6.0', '73257')
('6.0', '.0724')
('6.0', 'B = 500')
('6.0', 'B=10000')
('6.0', '10')
('6.0', '20')
('6.0', 'y')
('6.0', '\\mathbb{P}_{\\theta^1}, ..., \\mathbb{P}_{\\theta^M}')
('6.0', 'a^{i} \\leftarrow \\gamma a^{i} + \\sum_{j: \\alpha^{t, j} = i}y^{t, j}')
('6.0', 'b^{i} \\leftarrow \\gamma b^{i} + \\sum_{j: \\alpha^{t, j} = i} ( 1- y^{t, j})')
('6.0', '\\gamma')
('6.0', '.9')
('6.0', '\\{\\mathbb{P}_{\\theta^k}\\}_{k=1}^M')
('6.0', 'M')
('6.0', 'K')
('6.0', 'i')
('6.0', 'i')
('6.0', 'K')
('6.0', 'K')
('6.0', 'K')
('6.0', 'K')
('6.0', 'K')
('6.0', 'K')
('6.0', 'K')
('6.0', 'K')
('6.0', 'i \\in [K]')
('6.0', 'K')
('6.0', 'i')
('6.0', 'i')
('6.0', 'K')
('6.2', '\\{\\mathbb{P}_{\\theta_i}\\}_{i=1}^M')
('7', 'M')
('9.0', 'B')
('9.2', '10')
('9.3', '1')
('9.3', '0')
('9.3', '\\langle v_{div}^t, y \\rangle')
('9.3', '\\mathbbm{1}_{rare}^t \\ast v_{div^t}')
('9.3', '\\ast')
('9.3', '\\mathbbm{1}_{rare, i}^t \\in \\{1, -1\\}')
('9.3', '-1')
('9.3', '\\text{COUNT}^t(i)')
('10', '\\alpha^t := \\{\\alpha^{t, j}\\}_{j=1}^B')
('10', 'y^t := \\{y^{t, j}\\}_{j=1}^B')
('10', 'i')
('10', 't')
('10', 'H_t = \\{\\alpha^1, y^1, \\alpha^2, y^2,..., \\alpha^{t-1}, y^{t-1} \\}')
('10', 'i \\in [M]')
('10', "H_{t, i} = \\{y^{t', j} \\in H_t: \\alpha^{t', j} = i\\}")
('10', 'i')
('10', 't')
('10', 'H_t')
('10', 'i \\in [M]')
('10', 'y \\in H_{t, i}')
('10', '\\theta^i')
('10', 'y \\sim \\mathbb{P}_{\\theta^i}')
('10', 'v^t')
('10', '\\langle v^t, y \\rangle')
('10', '\\langle v^t, \\theta^i \\rangle')
('10', '\\mu^{t, i}')
('10', 'i')
('10', '\\bar{\\mu}^{t, i}')
('10', '\\mu^{t, i}')
('10', '\\bar{\\mu}^{t, i} := \\frac{1}{1\\vee |H_{t, i}|} \\sum_{y \\in H_{t, i}} \\langle v^t, y \\rangle')
('10', '\\bar{\\mu}^{t, i} = 0')
('10', '|H_{t, i}| = 0')
('10', '[-1, 1]')
('10', '\\begin{aligned}\n\\mathbb{P}\\left(\\forall i \\in [M], t\\in[T], |\\bar{\\mu}^{t, i} - \\mu^{t, i}| \\leq d^{t,i}\\right) \\geq 1 - \\frac{1}{T}\n\\end{aligned}')
('10', 'd^{t,i} := \\sqrt{\\frac{8 \\log (MT^2)}{1 \\vee |H_{t, i}|}}')
('10', 'U^{t, i} = \\text{clip}_{[-1, 1]} \\left(\\bar{\\mu}^{t, i} + d^{t,i} \\right)')
('10', 't')
('10', '\\mathbb{P}(\\Theta = \\cdot | H_t)')
('10', '\\Theta = \\{\\theta^i\\}_{i=1}^M')
('10', '\\widehat{\\Theta} = \\{\\widehat{\\theta}^i\\}_{i=1}^M')
('10', 'i_\\star^t = \\mathop{\\mathrm{arg\\,max}}_{i\\in M} \\langle v^t, \\theta^i\\rangle')
('10', '\\alpha^{t, j} = \\mathop{\\mathrm{arg\\,max}}_{i\\in M} \\langle v^t, \\widehat{\\theta}^{i}\\rangle')
('10', 'i_\\star^t')
('10', '\\mathbb{P}(\\Theta = \\cdot | H_t)')
('10', '\\alpha^{t, j}')
('10', '\\widehat{\\Theta}')
('10', '\\mathbb{P}(\\Theta = \\cdot | H_t)')
('10', 'i_\\star^t')
('10', '\\alpha^{t, j}')
('10', 'i')
('10', 'H_t')
('10', '\\mathbb{E}[U^{t, \\alpha^{t, j}} | H_t] = \\mathbb{E}[U^{t, i_\\star^t} | H_t]')
('10', '\\begin{aligned}\n    B&R(\\texttt{TAILOR} ) = \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B \\mu^{t, i_\\star^t} - \\mu^{t, \\alpha^{t, j}}\\right] \\\\\n    =& \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B (\\mu^{t,i_\\star^t} - U^{t, i_\\star^t}) + (U^{t, \\alpha^{t,j}} - \\mu^{t, \\alpha^{t, j}})\\right].\n\\end{aligned}')
('10', '\\bar{\\mu}^{t, i} \\in [-1,1]')
('10', '\\text{clip}_{[-1, 1]} \\left(\\bar{\\mu}^{t, i} + d^{t,i} \\right) = \\text{clip}_{[-\\infty, 1]} \\left(\\bar{\\mu}^{t, i} + d^{t,i} \\right)')
('10', '\\mathbb{P}\\left(\\forall i\\in[M], t\\in[T], |\\bar{\\mu}^{t, i} - \\mu^{t, i}| \\leq d^{t,i}\\right) \\geq 1 - \\frac{1}{T}')
('10', '\\begin{aligned}\n    \\mathbb{P}(\\forall i \\in [M], t\\in[T], \\mu^{t, i} > U^{t, i}) &= \\mathbb{P}(\\forall i \\in [M], t\\in[T],\\mu^{t, i} > \\text{clip}_{[-1, 1]} (\\bar{\\mu}^{t, i} + d^{t,i} )) \\\\\n    &= \\mathbb{P}(\\forall i \\in [M], t\\in[T],\\mu^{t, i} > \\bar{\\mu}^{t, i} + d^{t,i}) \\, , \\, \\mbox{since $\\mu^{t, i} \\leq 1$} \\\\\n    &= \\mathbb{P}(\\forall i \\in [M], t\\in[T],\\mu^{t, i} - \\bar{\\mu}^{t, i} > d^{t,i}) \\leq \\frac{1}{2T} \\\\\n    \\mathbb{P}(\\forall i \\in [M], t\\in[T], U^{t, i} - \\mu^{t, i} > 2d^{t, i}) &= \\mathbb{P}(\\forall i \\in [M], t\\in[T],\\text{clip}_{[-1, 1]} (\\bar{\\mu}^{t, i} + d^{t,i} ) - \\mu^{t, i} > 2d^{t, i}) \\\\\n    &\\leq \\mathbb{P}(\\forall i \\in [M], t\\in[T],\\bar{\\mu}^{t, i} + d^{t, i} - \\mu^{t, i} > 2d^{t, i}) \\\\\n    &= \\mathbb{P}(\\forall i \\in [M], t\\in[T],\\bar{\\mu}^{t, i} - \\mu^{t, i} > d^{t, i}) \\leq \\frac{1}{2T}.\n\\end{aligned}')
('10', '\\begin{aligned}\n    B&R(\\texttt{TAILOR} ) = \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B \\mu^{t, i_\\star^t} - \\mu^{t, \\alpha^{t, j}}\\right] \\\\\n    =& \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B \\mu^{t, i_\\star^t} - U^{t, i_\\star^t}\\right] + \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B U^{t, \\alpha^{t,j}} - \\mu^{t, \\alpha^{t, j}}\\right]\n\\end{aligned}')
('10', '\\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B \\mu^{t, i_\\star^t} - U^{t, i_\\star^t}\\right]')
('10', '\\mu^{t, i_\\star^t} - U^{t, i_\\star^t}')
('10', '2')
('10', '\\mu^{t, i}, U^{t, i} \\in [-1, 1]')
('10', '\\begin{aligned}\n    \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B \\mu^{t, i_\\star^t} - U^{t, i_\\star^t}\\right]\n    \\leq \\left(\\sum_{t=1}^T \\sum_{j=1}^B 0 \\cdot \\mathbb{P}(\\mu^{t, i_\\star^t} <= U^{t, i_\\star^t}) + 2\\cdot \\mathbb{P}(\\mu^{t, i_\\star^t} > U^{t, i_\\star^t})\\right) \\leq 2TB\\cdot \\frac{1}{2T} = B.\n\\end{aligned}')
('10', '\\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B U^{t, \\alpha^{t,j}} - \\mu^{t, \\alpha^{t, j}}\\right]')
('10', '\\begin{aligned}\n    \\mathbb{E}\\left[\\sum_{t=1}^T \\sum_{j=1}^B U^{t, \\alpha^{t,j}} - \\mu^{t, \\alpha^{t, j}}\\right]\n    &\\leq \\left( \\sum_{t=1}^T \\sum_{j=1}^B 2\\mathbb{P}(U^{t, \\alpha^{t,j}} - \\mu^{t, \\alpha^{t, j}} > 2d^{t,i})\\right) + \\left(\\sum_{t=1}^T\\sum_{j=1}^B 2d^{t,i} \\right) \\\\\n    &\\leq B + \\left(\\sum_{t=1}^T\\sum_{j=1}^B \\sqrt{\\frac{32\\log (MT^2)}{1 \\vee |H_{t, \\alpha^{t,j}}|}} \\right)\n\\end{aligned}')
('10', '|H_{t,i}|')
('10', 'i')
('10', '\\leq t')
('10', '\\frac{1}{1\\vee |H_{t, i}|} \\leq \\frac{B}{k}')
('10', 'k \\in [|H_{t, i}|, |H_{t+1, i}|]')
('10', '|H_{t+1, i}| - |H_{t, i}| \\leq B')
('10', '\\begin{aligned}\n    &\\sum_{t=1}^T\\sum_{j=1}^B \\sqrt{\\frac{32\\log (MT^2)}{1 \\vee |H_{t, \\alpha^{t,j}}|}} \\\\\n    &\\leq \\sum_{t=1}^T\\sum_{i=1}^M\\sum_{k=1}^{|H_{T, i}|} \\sqrt{\\frac{32\\log (MT^2) \\cdot B}{k}}\\\\\n    &\\leq O(\\sqrt{B (\\log T + \\log M)} \\sum_{i=1}^M \\sqrt{|H_{T,i}|})  \\\\\n    & \\leq O(\\sqrt{B (\\log T + \\log M)}) \\cdot O(\\sqrt{BMT}) =  O(B \\sqrt{MT(\\log T + \\log M)})\n\\end{aligned}')
('10', '\\sum_{i=1}^M |H_{T, i}| = TB')
('10', 'BR(\\texttt{TAILOR} ) \\leq B + B + O(B \\sqrt{MT(\\log T + \\log M)}) = O(B \\sqrt{MT(\\log T + \\log M)})')
