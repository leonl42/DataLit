('2', 'q(\\mathbf{z})')
('2', 'p(\\mathbf{z} | \\mathbf{x})')
('2', '\\mathbf{z}')
('2', '\\mathbf{x}')
('2', 'q(\\mathbf{z})')
('2', 'p(\\mathbf{z} | \\mathbf{x})')
('2', 'q^*(\\mathbf{z}) = \\underset{q(\\mathbf{z})}{\\mathrm{argmin}} \\, D_\\mathrm{KL}(q(\\mathbf{z}) \\| p(\\mathbf{z} | \\mathbf{x})).')
('2', 'q^*(\\mathbf{z})')
('3', 'M, D \\gets')
('3', ',')
('3', '\\mathbf{y}_{i} \\gets \\mathbf{0}')
('3', 'k \\gets i + M - N')
('3', 'k \\gets i - \\lvert \\mathcal{P} \\cap \\{1, 2, \\ldots, i-1\\} \\lvert')
('3', '\\mathbf{y}_{i} \\gets (\\mathbf{X}_{k1}, \\mathbf{X}_{k2}, \\ldots, \\mathbf{X}_{kD})^\\mathsf{T}')
('3', '[\\mathbf{y}_1, \\mathbf{y}_2, \\ldots, \\mathbf{y}_N]^\\mathsf{T}')
('3', '\\mathbf{X}_1 \\gets')
('3', '\\mathbf{X}_2 \\gets')
('3', '\\mathbf{U}_1 \\gets')
('3', '\\mathbf{U}_2 \\gets')
('3', '\\mathbf{T} \\gets')
('3', '\\mathbf{U} \\gets [\\mathbf{U}_1,')
('3', '+')
('3', ']')
('3', '\\mathbf{Z}, \\mathbf{M}, \\mathbf{S} \\gets')
('3', '\\mathbf{O} \\gets')
('3', '\\mathbf{G} \\gets')
('3', '+')
('3', '\\mathbf{G}, \\mathbf{M}, \\mathbf{S}')
('3', '\\mathbf{A}_1')
('3', '\\mathbf{A}_2 \\in \\mathbb{R}^{H \\times W \\times C}')
('3', '\\mathbf{X}_1')
('3', '\\mathbf{X}_2 \\in \\mathbb{R}^{N \\times (P^2 \\cdot C)}')
('3', 'H \\times W')
('3', 'C')
('3', 'P \\times P')
('3', 'N = \\frac{HW}{P^2}')
('3', "\\begin{gathered}\n  \\mathbf{Y}_{i,0} = [\\mathbf{c}, \\mathbf{W}_\\mathrm{e} \\mathbf{X}_i^\\mathsf{T} + \\mathbf{B}_\\mathrm{e}]^\\mathsf{T} + \\mathbf{P}_\\mathrm{e}, \\\\\n    \\mathbf{Y}'_{i,l} = \\mathrm{MSA}_l(\\mathrm{LN}(\\mathbf{Y}_{i,l-1})) + \\mathbf{Y}_{i,l-1}, \\\\\n    \\mathbf{Y}_{i,l} = \\mathrm{MLP}_l(\\mathrm{LN}(\\mathbf{Y}'_{i,l-1})) + \\mathbf{Y}'_{i,l-1}, \\\\\n    \\mathbf{U}_i = (\\mathbf{W}_\\mathrm{u} \\mathrm{LN}(\\mathbf{Y}_{i,L})^\\mathsf{T} + \\mathbf{B}_\\mathrm{u})^\\mathsf{T}, \\\\\n    \\forall i \\in \\{1,2\\}, \\, l \\in \\{1, 2, \\ldots, L\\}, \\notag\n\\end{gathered}")
('3', '\\mathbf{c} \\in \\mathbb{R}^D, \\mathbf{W}_\\mathrm{e} \\in \\mathbb{R}^{D \\times (P^2 \\cdot C)}')
('3', '\\mathbf{B}_\\mathrm{e} \\in \\mathbb{R}^{D \\times N}')
('3', "\\mathbf{P}_\\mathrm{e} \\in \\mathbb{R}^{(N+1) \\times D}, \\mathbf{W}_\\mathrm{u} \\in \\mathbb{R}^{D' \\times D}")
('3', "\\mathbf{B}_\\mathrm{u} \\in \\mathbb{R}^{D' \\times (N+1)}")
('3', '[\\, \\cdot \\, , \\, \\cdot \\,]')
('3', 'L')
('3', '\\mathbf{t}')
('3', '\\lvert \\mathcal{P} \\rvert')
('3', '\\mathbf{U}_2')
('3', '\\mathbf{U}_1')
('3', '\\mathbf{U}_2')
('3', '\\begin{gathered}\n  \\mathbf{T} = \\mathrm{Repeat}(\\mathbf{t}^\\mathsf{T}, \\lvert \\mathcal{P} \\lvert), \\\\\n  \\begin{aligned}\n    \\mathbf{U} = [\\mathbf{U}_1, \\quad & \\mathrm{Convert}(\\mathbf{U}_2, \\mathcal{P}, N+1) \\\\\n    + & \\mathrm{Convert}(\\mathbf{T}, \\mathcal{P}^\\complement, N+1)],\n  \\end{aligned}\n\\end{gathered}')
('3', '\\mathcal{P}')
('3', '\\lvert \\, \\cdot \\, \\rvert')
('3', '\\begin{gathered}\n  \\mathbf{M} = (\\mathbf{W}_\\mathrm{m} \\mathbf{U}^\\mathsf{T} + \\mathbf{B}_\\mathrm{m})^\\mathsf{T}, \\\\\n  \\mathbf{S} = (\\mathbf{W}_\\mathrm{s} \\mathbf{U}^\\mathsf{T} + \\mathbf{B}_\\mathrm{s})^\\mathsf{T}, \\\\\n  \\mathbf{Z} = \\mathbf{M} + \\mathbf{S} \\odot \\mathbf{E},\n\\end{gathered}')
('3', "\\mathbf{W}_\\mathrm{m}, \\mathbf{W}_\\mathrm{s} \\in \\mathbb{R}^{D' \\times 2D'}")
('3', "\\mathbf{B}_\\mathrm{m}, \\mathbf{B}_\\mathrm{s} \\in \\mathbb{R}^{D' \\times (N+1)}")
('3', "\\mathbf{E} \\sim \\mathcal{MN}_{(N+1) \\times D'}(\\mathbf{0}, \\mathbf{I}, \\mathbf{I})")
('3', '\\odot')
('3', '\\mathbf{Z}')
('3', "\\begin{gathered}\n  \\mathbf{V}_{0} = (\\mathbf{W}_\\mathrm{d}[\\mathbf{Z}, \\mathbf{U}_1]^\\mathsf{T} + \\mathbf{B}_\\mathrm{d})^\\mathsf{T} + \\mathbf{P}_\\mathrm{d}, \\\\\n  \\mathbf{V}'_l = \\mathrm{MSA}'_l(\\mathrm{LN}(\\mathbf{V}_{l-1})) + \\mathbf{V}_{l-1}, \\\\\n  \\mathbf{V}_l = \\mathrm{MLP}'_l(\\mathrm{LN}(\\mathbf{V}'_{l-1})) + \\mathbf{V}'_{l-1}, \\\\\n  \\mathbf{O} = (\\mathbf{W}_\\mathrm{o} \\mathrm{LN}(\\mathbf{V}_{L'})^\\mathsf{T} + \\mathbf{B}_\\mathrm{o})^\\mathsf{T}, \\\\\n  \\forall l \\in \\{1, 2, \\ldots, L'\\}, \\notag\n\\end{gathered}")
('3', "\\mathbf{W}_\\mathrm{d} \\in \\mathbb{R}^{D' \\times 2D'}")
('3', "\\mathbf{B}_\\mathrm{d} \\in \\mathbb{R}^{D' \\times (N+1)}")
('3', "\\mathbf{P}_\\mathrm{d} \\in \\mathbb{R}^{(N+1) \\times D'}")
('3', "\\mathbf{W}_\\mathrm{o} \\in \\mathbb{R}^{D' \\times (P^2 \\cdot C)}")
('3', '\\mathbf{B}_\\mathrm{o} \\in \\mathbb{R}^{(P^2 \\cdot C) \\times (N+1)}')
('3', "L'")
('3', '\\mathbf{G} = \\mathrm{Convert}([\\mathbf{0}^\\mathsf{T}; \\mathbf{X}_2], \\mathcal{P}, N) + \\mathrm{Convert}(\\mathbf{O}, \\mathcal{P}^\\complement, N),')
('3', '[\\, \\cdot \\, ; \\, \\cdot \\,]')
('3', '\\beta')
('3', '\\mathcal{MN}(\\mathbf{0}, \\mathbf{I}, \\mathbf{I})')
('3', '\\begin{gathered}\n    \\mathrm{max}_{\\phi, \\theta} \\mathbb{E}_{\\mathbf{X}_1, \\mathbf{X}_2 \\sim \\mathcal{D}}[\\mathbb{E}_{q_\\phi(\\mathbf{Z} \\mid \\mathbf{X}_1, \\mathbf{X}_2)} \\log p_\\theta(\\mathbf{R} \\mid \\mathbf{Z})], \\\\\n    \\mathrm{s.t.} \\, D_\\mathrm{KL}(q_\\phi(\\mathbf{Z} \\mid \\mathbf{X}_1, \\mathbf{X}_2) \\| p(\\mathbf{Z})) \\leq \\epsilon,\n  \\end{gathered}')
('3', '\\label{eq:KKT-condition}\n  \\begin{gathered}\n    \\mathcal{F}(\\theta, \\phi, \\beta; \\mathbf{X}_1, \\mathbf{X}_2, \\mathbf{R}) = \\mathbb{E}_{q_\\phi(\\mathbf{Z} \\mid \\mathbf{X}_1, \\mathbf{X}_2)} \\log p_\\theta(\\mathbf{R} \\mid \\mathbf{Z}) \\\\\n    - \\beta(D_\\mathrm{KL}(q_\\phi(\\mathbf{Z} \\mid \\mathbf{X}_1, \\mathbf{X}_2) \\| p(\\mathbf{Z})) - \\epsilon),\n  \\end{gathered}')
('3', '\\epsilon')
('3', '\\mathcal{L}_{\\mathrm{r}}')
('3', '\\mathcal{L}_{\\mathrm{KL}}')
('3', '\\label{eq:overall_loss}\n  \\mathcal{L} = \\mathcal{L}_\\mathrm{r} + \\beta \\cdot \\mathcal{L}_\\mathrm{KL}')
('3', '\\beta')
('3', '\\label{eq:reconstruction_loss}\n  \\mathcal{L}_{\\mathrm{r}} = \\frac{1}{P^2C \\lvert \\mathcal{P} \\rvert} \\| \\mathbf{G} - \\mathbf{R} \\|^2_\\mathrm{F}')
('3', '\\mathbf{R}')
('3', "\\label{eq:KL_loss}\n  \\mathcal{L}_{\\mathrm{KL}} = \\frac{\\| \\mathbf{M} \\|_\\mathrm{F}^2 + \\| \\mathbf{S} \\|_\\mathrm{F}^2 -\\sum_{i=1}^{N+1} \\sum_{j=1}^{D'} \\log \\mathbf{S}_{ij}}{2(N+1)D'} - \\frac{1}{2}")
('3', '\\| \\cdot \\|_\\mathrm{F}')
('4.4', '\\beta')
('4.4', '\\beta')
('4.4', '\\beta')
('4.4', '\\beta = 0.2')
('4.4', '\\beta')
('4.4', '\\beta')
('4.4', '\\beta')
('4.4', '\\beta')
('5', '\\beta')
