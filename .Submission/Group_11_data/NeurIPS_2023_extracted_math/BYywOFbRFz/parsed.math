('3', 's_t \\in \\mathcal{S}')
('3', 'a_t \\in \\mathcal{A}')
('3', 'p(s_{t+1} \\mid s_t, a_t)')
('3', 'p(s_0)')
('3', 'a_t \\sim \\pi_\\theta(a_t \\mid s_{t-k..t}, \\Phi_{t-k..t})')
('3', '\\theta')
('3', 's_{t-k..t}')
('3', '\\Phi_{t-k..t}')
('3', '\\pi(a_t \\mid s_t)')
('3', 'k')
('3', '\\Phi_t')
('3', '\\omega')
('3', '\\omega')
('3', '\\omega')
('3', '\\omega')
('3', '\\mathcal{D}')
('3', '\\tau')
('3', '\\Phi_t')
('3', '\\pi_\\theta')
('3', '\\mathcal{D} = \\{\\tau_1, \\tau_2, \\tau_3, ..., \\tau_n\\}')
('3', '\\pi_\\theta(a_t \\mid s_{t-k..t}, \\Phi_{t-k..t})')
('3', 't')
('3', 'L_\\theta(\\tau) = - \\sum_t \\log \\pi_\\theta(a_t \\mid s_{t-k..t}, \\Phi_{t-k..t})')
('3', 'L_\\theta(\\tau)')
('4.0', 'H + 1')
('4.0', '\\omega = s^{(H)}')
('4.0', '\\omega')
('4.0', '\\mathcal{D}')
('4.0', '\\pi_b')
('4.0', '\\pi_b(a_t = a^{(1)} \\mid s_t) = \\lambda > 0')
('4.0', 's_t')
('4.0', '\\pi_b')
('4.0', '\\omega')
('4.0', '\\frac{H}{1 - \\lambda}')
('4.0', 's^{(H)}')
('4.0', 'H')
('4.0', '\\lambda')
('4.0', '1 - \\lambda')
('4.0', '\\pi_G(a_t \\mid s_t, \\omega)')
('4.0', '\\mathcal{D}')
('4.0', '\\pi^*_G(a_t \\mid s_t, \\omega) = \\pi_b(a_t \\mid s_t) \\; \\forall s_t')
('4.0', '\\omega = s^{(H)}')
('4.0', '\\pi^*_G')
('4.0', '\\pi_b')
('4.0', '\\pi_W(a_t \\mid s_t, \\Phi_t)')
('4.0', '\\Phi_t = s_{t + K}')
('4.0', 'K < \\frac{1}{1 - \\lambda}')
('4.0', '\\pi_b')
('4.0', 'a_2')
('4.0', '\\mathcal{D}')
('4.0', '\\Phi_t')
('4.0', 's_t = s^{(h)}')
('4.0', '\\Phi_t = s^{(h+1)}')
('4.0', '\\mathcal{D}')
('4.0', '\\pi_b')
('4.0', 'a^{(2)}')
('4.0', '\\Phi_t')
('4.0', 's_t')
('4.0', '\\begin{aligned}\n\\mathrm{Pr}_{\\pi_b}[a_t = a^{(2)} \\mid s_t = s^{(h)}, s_{t+K} = s^{(h + 1)}] &= \\frac{\\mathrm{Pr}_{\\pi_b}[a_t = a^{(2)}, s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}]}{\\mathrm{Pr}_{\\pi_b}[s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}]} \\\\ &= \\frac{(1 - \\lambda)\\lambda^{K -1}}{\\binom{K}{1} \\left[ (1 - \\lambda)\\lambda^{K -  1} \\right]} = \\frac{1}{\\binom{K}{1}} = \\frac{1}{K}.\n\\end{aligned}')
('4.0', '\\pi^*_W')
('4.0', '\\mathcal{D}')
('4.0', 'a^{(2)}')
('4.0', '\\pi^*_W(a_t = a^{(2)} \\mid s_t = s^{(h)}, \\Phi_t = s^{(h + 1)}) = \\frac{1}{K}.')
('4.0', '\\pi_G^*(a_t = a^{(2)} \\mid s_t = s^{(h)}, \\omega) = 1 - \\lambda')
('4.0', 'K')
('4.0', '\\frac{1}{K} > 1 - \\lambda')
('4.0', '\\begin{aligned}\n\\pi^*_W(a_t = a^{(2)} \\mid s_t, \\Phi_t) > \\pi^*_G(a_t = a^{(2)} \\mid s_t, \\omega).\n\\end{aligned}')
('4.1', '\\pi_\\theta')
('4.1', 'W_\\phi')
('4.1', '\\phi')
('4.1', 'K')
('4.1', 's_t')
('4.1', '\\omega')
('4.1', '\\mathcal{D}')
('4.1', 'L_\\phi')
('4.1', '\\begin{aligned}\n\\arg \\min_\\phi \\sum_{\\tau \\in \\mathcal{D}} L_\\phi(W_\\phi(s_t, \\omega), s_{t + K}).\n\\label{eqn:goalnet}\n\\end{aligned}')
('4.1', '\\omega')
('4.2', '\\omega')
('4.2', 'W_\\phi')
('4.2', '\\phi')
('4.2', '\\mathtt{ARTG}')
('4.2', '\\mathtt{CRTG}')
('4.2', '\\omega')
('4.2', 's_t')
('4.2', '\\mathcal{D}')
('4.2', "\\begin{aligned}\n\\arg \\min_\\phi \\sum_{\\tau \\in \\mathcal{D}} (\\begin{bmatrix} \\frac{1}{T - t} \\sum_{t'=t}^T \\gamma^t r_t & \\sum_{t'=t}^T \\gamma^t r_t \\end{bmatrix}^\\top - W_\\phi(s_t, \\omega))^2.\n\\label{eqn:reward}\n\\end{aligned}")
('4.2', '\\mathtt{ARTG}')
('4.2', '\\mathtt{CRTG}')
('4.2', '\\mathtt{ARTG}')
('4.2', '\\mathtt{CRTG}')
('5', 'W_\\phi')
('5', '\\pi_\\theta')
('5', 's_{t-k..t}')
('5', '\\Phi_{t-k..t} = W_\\phi(s_{t-k..t}, \\omega)')
('5', 'k')
('5', 'W_\\phi')
('5', '\\mathcal{D}')
('5', '\\theta')
('5', '\\phi')
('5', 'W_\\phi')
('5', 'a_{t-k..t}')
('5', '\\Phi_t')
('5', 's_t')
('5', 't')
('6', '\\omega = s_{\\mathrm{target}}')
('6.0', '\\pm')
('6.0', '\\pm')
('6.1', 'K = 30')
('6.1', '\\pm')
('6.1', '\\pm')
('6.2.0', 'K')
('6.2.0', 'K')
('6.2.0', 'K')
('6.2.0', 'K')
('6.2.0', 'K = 30')
('6.2.0', 'K = 0')
('6.2.0', 'K')
('6.2.0', 'K = 30')
('6.2.0', 'K = 0')
('6.2.0', '\\pm')
('6.2.0', '\\pm')
('6.2.0.0', '\\mathtt{CRTG}')
('6.2.0.0', '\\mathtt{ARTG}')
('6.2.0.0', '\\mathtt{CRTG}')
('6.2.0.0', '\\mathtt{CRTG}')
('6.2.0.0', '\\mathtt{CRTG}')
('6.2.0.0', '\\mathtt{CRTG}')
('6.2.0.0', '\\mathtt{CRTG}')
('6.2.0.1', 'p_\\mathrm{drop}')
('6.2.0.1', 'L')
('6.2.0.1', 'a_{t-k..t - 1}')
('6.2.0.1', 'p_\\mathrm{drop} = 0.1')
('9', '\\mathcal{D}')
('9', '\\pi_b')
('9', '\\pi_G')
('9', '\\pi_b')
('9', '\\pi_G(a_t \\mid s_t, \\omega) = \\pi_G(a_t \\mid s_t)')
('9', '\\omega = s^{(H)}')
('9', 'a_t')
('9', '\\pi_G^*')
('9', '\\begin{aligned}\n    \\arg \\max_{\\pi_G} \\mathbb{E}_{(s_t, a_t) \\in \\mathcal{D}}[\\log \\pi_G(a_t \\mid s_t, \\omega)]\n\\end{aligned}')
('9', '\\mathcal{D}')
('9', '\\pi_b')
('9', '\\begin{aligned}\n\\mathbb{E}_{(s_t, a_t) \\in \\mathcal{D}}[\\log \\pi_G(a_t \\mid s_t, \\omega)] &= \\mathbb{E}_{s_t \\in \\mathcal{D}}[\\lambda \\log \\pi_G(a_t = a^{(1)} \\mid s_t, \\omega) + (1 - \\lambda) \\log \\pi_G(a_t = a^{(2)} \\mid s_t, \\omega)]\n\\end{aligned}')
('9', '\\hat{p} = \\pi_G(a_t = a^{(1)} \\mid s_t, \\omega)')
('9', 's_t')
('9', '\\mathbb{E}_{(s_t, a_t) \\in \\mathcal{D}}[\\log \\pi_G(a_t \\mid s_t, \\omega)] = \\lambda \\log \\hat{p} + (1 - \\lambda) \\log (1 - \\hat{p})')
('9', '\\hat{p}')
('9', '\\begin{aligned}\n\\frac{d}{d\\hat{p}} \\left[ \\lambda \\log \\hat{p} + (1 - \\lambda) \\log (1 - \\hat{p}) \\right] &= \\frac{\\lambda}{\\hat{p}} - \\frac{1 - \\lambda}{1 - \\hat{p}} \\\\\n&= \\frac{\\lambda(1 - \\hat{p}) - (1 - \\lambda)\\hat{p}}{\\hat{p}(1 - \\hat{p})}\n\\end{aligned}')
('9', '\\lambda(1 - \\hat{p}) - (1 - \\lambda)\\hat{p} = \\lambda - \\lambda \\hat{p} - \\hat{p} + \\lambda \\hat{p} = 0 \\implies \\boxed{\\hat{p} = \\lambda}')
('9', '\\pi_b')
('9', 'a^{(2)}')
('9', '\\Phi_t')
('9', 's_t')
('9', '\\mathcal{D}')
('9', '\\pi_b')
('9', '\\begin{aligned}\n& \\ \\mathrm{Pr}_{\\pi_b}[a_t = a^{(2)} \\mid s_t = s^{(h)}, s_{t+K} = s^{(h + 1)}] \\\\ &= \\frac{\\mathrm{Pr}_{\\pi_b}[a_t = a^{(2)}, s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}]}{\\mathrm{Pr}_{\\pi_b}[s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}]}\n\\end{aligned}')
('9', 's_{t + K} = s^{(h + 1)}')
('9', 's_t = s^{(h)}')
('9', 'a^{(2)}')
('9', 't')
('9', 't + K - 1')
('9', 's^{(h + 1)}')
('9', 's^{(h)}')
('9', 'a^{(2)}')
('9', 't')
('9', 'a^{(1)}')
('9', 't + 1')
('9', 't + K - 1')
('9', "\\begin{aligned}\n\\mathrm{Pr}_{\\pi_b}[a_t = a^{(2)}, s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}] &= (1 - \\lambda)\\prod_{t' = t + 1}^{t + K - 1} \\lambda \\\\ &= (1 - \\lambda)\\lambda^{K -1}\n\\end{aligned}")
('9', 'a^{(2)}')
('9', "t \\le t' < t + K")
('9', 'a^{(1)}')
('9', 'K')
('9', 'a^{(1)}')
('9', '1 - \\lambda')
('9', '\\begin{aligned}\n\\mathrm{Pr}_{\\pi_b}[s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)} &= \\binom{K}{1} (1 - \\lambda)\\lambda^{K -1} \\\\ &= K (1 - \\lambda)\\lambda^{K -1} \n\\end{aligned}')
('9', '\\begin{aligned}\n\\frac{\\mathrm{Pr}_{\\pi_b}[a_t = a^{(2)}, s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}]}{\\mathrm{Pr}_{\\pi_b}[s_{t+K} = s^{(h + 1)} \\mid s_t = s^{(h)}]} &= \\frac{(1 - \\lambda)\\lambda^{K -1}}{K (1 - \\lambda)\\lambda^{K -1} } \\\\ &= \\frac{1}{K}\n\\end{aligned}')
('9', '\\pi_W^*')
('9', '\\pi^*_W')
('9', '\\pi^*_W(a_t = a^{(2)} \\mid s_t = s^{(h)}, \\Phi_t = s^{(h + 1)}) = \\frac{1}{K}')
('9', '\\pi_G^*(a_t = a^{(2)} \\mid s_t = s^{(h)}, \\omega) = \\pi_b(a_t = a^{(2)} \\mid s_t = s^{(h)}) = 1 - \\lambda')
('9', 'K < \\frac{1}{1 - \\lambda} \\implies \\frac{1}{K} > 1 - \\lambda')
('9', '\\begin{aligned}\n\\pi^*_W(a_t = a^{(2)} \\mid s_t, \\Phi_t) > \\pi^*_G(a_t = a^{(2)} \\mid s_t, \\omega)\n\\end{aligned}')
('10.1', 'k')
('11', 'R_a')
('11', 'R_c')
('11', '\\tau')
('11', '|\\tau| = T')
('11', "\\begin{aligned}\n    R_a(\\tau, t) &= \\frac{1}{T - t} \\sum_{t' = t}^T \\gamma^t r_t \\\\\n    R_c(\\tau, t) &= \\sum_{t' = t}^T \\gamma^t r_t\n\\end{aligned}")
('11', "r_{t'}")
('11', "t' \\ge t")
('11', '\\theta_a')
('11', '\\theta_c')
('11', "\\begin{aligned}\n    \\hat{R}_a(\\tau, t) &= \\theta_a \\\\\n    \\hat{R}_c(\\tau, t) &= \\theta_c - \\sum_{t' = 1}^t \\gamma^t r_t\n\\end{aligned}")
('11', '\\hat{R}_a')
('11', '\\hat{R}_c')
('11', 'R')
('11', '\\hat{R}')
('11', 'R(\\tau, t)')
('11', '\\hat{R}(\\tau, t)')
('11', '\\pi')
('11', 'p(s_{t+1} \\mid s_t, a_t)')
('11', '\\mathbb{E}_{\\tau}[(R(\\tau, t) - \\hat{R}(\\tau, t))^2] = \\mathbb{E}[R(\\tau, t) - \\hat{R}(\\tau, t)]^2 + \\mathrm{Var}[\\hat{R}(\\tau, t) - R(\\tau, t)]')
('11', '\\mathrm{Cov}(X, Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y]')
('11', '\\mathrm{Var}[X] = E[X^2] - E[X]^2')
('11', '\\mathbb{E}_{\\tau}[(R(\\tau, t) - \\hat{R}(\\tau, t))^2] = \\mathbb{E}[R(\\tau, t)^2] + \\mathbb{E}[\\hat{R}(\\tau, t)^2] -2 \\mathbb{E}[\\hat{R}(\\tau, t) R(\\tau, t)]\\\\ ')
('11', '\\begin{aligned}\n\\mathbb{E}_{\\tau}[(R(\\tau, t) - \\hat{R}(\\tau, t))^2] \n&= \\mathrm{Var}[R(\\tau, t)] + \\mathbb{E}[R(\\tau, t)]^2 + \\mathbb{E}[\\hat{R}(\\tau, t)^2] -2 \\mathbb{E}[\\hat{R}(\\tau, t) R(\\tau, t)] \\\\\n&= \\mathrm{Var}[R(\\tau, t)] + \\mathbb{E}[R(\\tau, t)]^2 + \\mathbb{E}[\\hat{R}(\\tau, t)^2] -2 (\\mathrm{Cov}(\\hat{R}(\\tau, t), R(\\tau, t)) + \\\\& \\ \\ \\  \\ \\ \\ \\mathbb{E}[R(\\tau, t)] \\cdot \\mathbb{E}[\\hat{R}(\\tau, t)])) \\\\\n\\end{aligned}')
('11', '\\mathbb{E}[\\hat{R}(\\tau, t)^2]')
('11', '\\begin{aligned}\n\\mathbb{E}_{\\tau}[(R(\\tau, t) - \\hat{R}(\\tau, t))^2] &= (\\mathbb{E}[R(\\tau, t)] - \\mathbb{E}[\\hat{R}(\\tau, t)])^2 + \\mathrm{Var}[\\hat{R}(\\tau, t)] -2 \\mathrm{Cov}(\\hat{R}(\\tau, t), R(\\tau, t)) +  \\\\& \\ \\ \\  \\ \\ \\ \\mathrm{Var}[R(\\tau, t)] \\\\\n&= \\mathbb{E}[R(\\tau, t) - \\hat{R}(\\tau, t)]^2 + \\mathrm{Var}[\\hat{R}(\\tau, t)] -2 \\mathrm{Cov}(\\hat{R}(\\tau, t), R(\\tau, t)) +  \\\\& \\ \\ \\  \\ \\ \\ \\mathrm{Var}[R(\\tau, t)]\n\\end{aligned}')
('11', '\\mathrm{Var}[X - Y] = \\mathrm{Var}[X] + \\mathrm{Var}[Y] - 2 \\mathrm{Cov}(X, Y)')
('11', '\\mathbb{E}_{\\tau}[(R(\\tau, t) - \\hat{R}(\\tau, t))^2] = \\mathbb{E}[R(\\tau, t) - \\hat{R}(\\tau, t)]^2 + \\mathrm{Var}[\\hat{R}(\\tau, t) - R(\\tau, t)]')
('11.0', 'R')
('11.0', '\\begin{aligned}\n    E_{\\tau}[(R_a(\\tau, t) - \\hat{R}_a(\\tau, t))^2] &= E_{\\tau}[R_a(\\tau, t) - \\hat{R}_a(\\tau, t)]^2 + \\mathrm{Var}[R_a(\\tau, t)] \\\\\n    &=  E_{\\tau}[R_a(\\tau, t) - \\theta_a]^2 + \\mathrm{Var}[R_a(\\tau, t)]\n\\end{aligned}')
('11.0', '\\hat{\\theta}_a = \\mathbb{E}_\\tau[R_a(\\tau, t)]')
('11.0', '\\pi')
('11.0', 't')
('11.0', '\\theta_a')
('11.0', 'T = 1000')
('11.0', 't = T')
('11.0', 't \\in [1, T)')
('11.0', 't \\approx T')
('11.0', 't \\approx 0')
('11.0', 't')
('11.0', 'R_a')
('11.0', '\\theta_a')
('11.0', 's_t')
('11.0', '\\omega')
('11.0', '\\pm')
('11.0', '\\pm')
('11.0', '\\pm')
('11.0.0', '\\hat{R}_c')
('11.0.0', "\\theta_c = \\mathbb{E}[\\sum_{t' = 1}^T \\gamma^t r_t]")
('11.0.0', '\\hat{R}_c')
('11.0.0', 'R_c')
('11.0.0', '\\hat{R}_c')
('11.0.0', '\\hat{R}_c')
('11.0.0', 'R_c')
('11.0.0', "\\begin{aligned}\nE_{\\tau}[(R_c(\\tau, t) - \\hat{R}(\\tau, t))^2] &= \\mathbb{E}[R(\\tau, t) - \\hat{R}(\\tau, t)]^2 + \\mathrm{Var}[\\hat{R}(\\tau, t) - R(\\tau, t)]  \\\\\n&\\ge \\mathrm{Var}[\\hat{R}(\\tau, t) - R(\\tau, t)]  \\\\\n&\\approx \\mathrm{Var}[\\sum_{t' = 1}^t \\gamma^{t'} r_{t'}] + \\mathrm{Var}[R(\\tau, t)]\n\\end{aligned}")
('11.0.0', 'k')
('11.0.0', '\\lambda')
('11.0.0', "\\sum_{t' = t}^T \\gamma^t r_t")
('11.0.0', 's_t')
('11.0.0', '\\omega')
('11.0.0', '\\omega')
('11.0.0', 't \\approx 400')
('11.0.0', 't')
('11.0.0', 't \\approx T')
('12.2', '\\Phi_t')
('12.2', 'W_c \\gets \\{w_m: ||w_m - \\omega||_2 \\le ||s_t - \\omega||_2\\}')
('12.2', '\\arg \\min_{w_c \\in W_c} ||w_c - s_t||_2')
('12.2', '\\pm')
('12.2', '\\pm')
('12.2', '\\pm')
('12.2', 'k')
('12.3', 'a_t')
('12.3', 'a_t')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', '\\pm')
('12.3', 'L_C')
('12.3', 'L_A')
('12.3', 'L_C')
('12.3', 'L_A')
