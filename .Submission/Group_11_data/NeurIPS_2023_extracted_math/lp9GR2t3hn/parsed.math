('1', '\\mathbf{z}_0')
('2', '\\mathcal{S}')
('2', '\\mathcal{Q}')
('2', '\\mathcal{T}^i')
('2', 'p(\\mathcal{T})')
('2', '\\mathbf{z}^c')
('2', 'c')
('2', '\\mathbf{z}^c {=} \\frac{1}{K}\\sum_k f_{\\phi}(\\mathbf{x}^{c,k})')
('2', 'f_{\\phi}(\\mathbf{x}^{c,k})')
('2', '\\mathbf{x}^{c,k}')
('2', '\\mathbf{x}^q')
('2', "\\label{eqn:protonetProb}\n    p(\\mathbf{y}_{n}^q = c|\\mathbf{x}^q) = \\frac{\\exp(-d(f_{\\phi}(\\mathbf{x}^q),\\mathbf{z}^c))}{\\sum_{c'} \\exp(-d(f_{\\phi}(\\mathbf{x}^q),\\mathbf{z}^{c'}))},")
('2', '\\mathbf{y}^q')
('2', '\\mathbf{y}_n^q')
('2', 'n')
('2', 'd(\\cdot,\\cdot)')
('2', 'c')
('2', '\\mathbf{z}')
('2', 'q({\\boldsymbol x}_t|{\\boldsymbol x}_{t-1})')
('2', 't')
('2', '{\\boldsymbol x}_0 \\sim q({\\boldsymbol x}_0)')
('2', '\\begin{aligned}\n\\footnotesize\n    q({\\boldsymbol x}_{T}|{\\boldsymbol x}_0):=\\prod_{t=1}^{T}q({\\boldsymbol x}_t|{\\boldsymbol x}_{t-1}),\\quad \\mbox{where}\\quad\n    q({\\boldsymbol x}_t|{\\boldsymbol x}_{t-1}):={\\mathcal N}({\\boldsymbol x}_t;\\sqrt{1-\\beta_t}{\\boldsymbol x}_{t-1},\\beta_t{\\boldsymbol I}),\n\\end{aligned}')
('2', '\\{\\beta\\}_{t=0}^{T}')
('2', '\\alpha_t {:=} 1 {-} \\beta_t')
('2', '\\bar{\\alpha_t} {:=} \\prod_{s=1}^t\\alpha_s')
('2', 't')
('2', '\\bm x_t')
('2', '\\begin{aligned}\n    \\label{eq:ddpm}\n    {\\boldsymbol x}_t=\\sqrt{\\bar{\\alpha}_t}{\\boldsymbol x}_0+\\sqrt{1-\\bar{\\alpha}_t}\\boldsymbol{\\epsilon},\\quad \\mbox{where}\\quad \\boldsymbol{\\epsilon}\\sim{\\mathcal N}(\\textbf{0},{\\boldsymbol I}).\n\\end{aligned}')
('2', 'q({\\boldsymbol x}_{t-1}|{\\boldsymbol x}_t)')
('2', 'p_\\theta({\\boldsymbol x}_{t-1}|{\\boldsymbol x}_t)')
('2', '\\theta')
('2', '{\\boldsymbol x}_T \\sim  {\\mathcal N}({\\boldsymbol x}_T; \\textbf{0}, \\boldsymbol{I})')
('2', '\\begin{aligned}\n    p_\\theta({\\boldsymbol x}_{0:T}):=p_\\theta({\\boldsymbol x}_T)\\prod_{t=1}^{T}p_\\theta({\\boldsymbol x}_{t-1}|{\\boldsymbol x}_{t}), \n\\end{aligned}')
('2', '\\begin{aligned}\n\\label{eq:mu}\n     p_\\theta({\\boldsymbol x}_{t-1}|{\\boldsymbol x}_{t}):={\\mathcal N}({\\boldsymbol x}_{t-1};{\\boldsymbol\\mu}_\\theta({\\boldsymbol x}_t,t),\\sigma_t^2{\\boldsymbol I}), \\quad\n    {\\boldsymbol\\mu}_\\theta({\\boldsymbol x}_t,t):=\\frac{1}{\\sqrt{\\alpha}_t}\\Big{(}{\\boldsymbol x}_t-\\frac{1-\\alpha_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\boldsymbol{\\epsilon}_\\theta({\\boldsymbol x}_t,t)\\Big{)}.\n    %\\quad     \\boldsymbol{s}_\\theta(\\x_t,t)=-\\frac{1}{\\sqrt{1-\\bar{\\alpha}_t}}\\z_\\theta(\\x_t,t)\n\\end{aligned}')
('2', '\\boldsymbol{\\epsilon}_\\theta({\\boldsymbol x}_t,t)')
('2', '\\begin{aligned}\n    \\label{eq:objective}\n    \\mathcal{L}_{\\theta}=\\mathbb{E}_{t,{\\boldsymbol x}_0,\\boldsymbol{\\epsilon}}\\Big{[}\\|\\boldsymbol{\\epsilon}-\\boldsymbol{\\epsilon}_\\theta(\\sqrt{\\bar{\\alpha}_t}{\\boldsymbol x}_0+\\sqrt{1-\\bar{\\alpha}_t}\\boldsymbol{\\epsilon},t)\\|^2\\Big{]}.\n\\end{aligned}')
('2', 'p_\\theta({\\boldsymbol x}_{t-1}|{\\boldsymbol x}_t)')
('2', '\\begin{aligned}\n\\label{eq:reverse}\n    {\\boldsymbol x}_{t-1}=   {\\boldsymbol\\mu}_\\theta({\\boldsymbol x}_t,t)+\\sigma_t\\boldsymbol{\\epsilon}=\\frac{1}{\\sqrt{\\alpha_t}}\\Big{(}{\\boldsymbol x}_t-\\frac{1-\\alpha_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\boldsymbol{\\epsilon}_\\theta({\\boldsymbol x}_t,t)\\Big{)}+\\sigma_t\\boldsymbol{\\epsilon}.\n\\end{aligned}')
('2', '\\boldsymbol{\\epsilon}_\\theta')
('2', '\\boldsymbol{\\epsilon}_\\theta(\\mathbf{c}, \\sqrt{\\bar{\\alpha}_t}{\\boldsymbol x}_0 + \\sqrt{1 - \\bar{\\alpha}_t}\\boldsymbol{\\epsilon}, t)')
('2', '\\mathbf{c}')
('2', '{\\boldsymbol x}')
('2', '\\mathbf{z}')
('3.0', 'f_{\\phi}(\\mathcal{T}^i) {=} f(\\mathcal{T}^i, \\phi)')
('3.0', '\\mathcal{T}')
('3.0', '\\phi')
('3.0', '\\mathcal{T}^i')
('3.0', '\\mathbf{z}^{i, *} {=} f{{\\phi}^i}(\\mathcal{S}^i, \\mathcal{Q}^i)')
('3.0', 'f_{\\phi}')
('3.0', '\\mathcal{S}^i')
('3.0', '\\mathcal{Q}^i')
('3.0', '\\mathcal{T}^i')
('3.0', '\\begin{aligned}\n\\phi^{i} = \\phi - \\eta \\sum^{\\mathcal{T}_i}_{(\\mathbf{x}, \\mathbf{y}) \\sim \\mathcal{T}_i} \\mathcal{L}_{\\mathrm{CE}}(f(\\mathcal{S}^i, \\mathbf{x}^{q^i}, \\phi), \\mathbf{y}^{q^i}),\n\\end{aligned}')
('3.0', '\\mathcal{L}_{\\mathrm{CE}}')
('3.0', '\\mathcal{S}^i')
('3.0', '\\mathcal{Q}^i {=} \\{\\mathbf{x}^{q^i}, \\mathbf{y}^{q^i}\\}')
('3.0', '\\mathcal{T}^i')
('3.0', '\\phi^i')
('3.1', 'T')
('3.1', '\\mathbf{z}^*')
('3.1', '\\mathbf{z}^*')
('3.1', '\\mathbf{z}_T \\sim \\mathcal{N}(\\textbf{0}, \\boldsymbol{I})')
('3.1', '\\mathbf{z}^*')
('3.1', '\\mathbf{z}_t')
('3.1', 't')
('3.1', '\\mathbf{z}_0')
('3.1', '\\mathbf{z}^*')
('3.1', 't')
('3.1', '\\hat{\\mathbf{z}}_t')
('3.1', '\\hat{\\mathbf{z}}_t')
('3.1', '\\tilde{\\mathbf{z}}')
('3.1', 't')
('3.1', '\\mathbf{z}_t')
('3.1', '\\mathcal{L}_{\\mathrm{diff}}')
('3.1', '\\mathcal{L}_{\\mathrm{CE}}')
('3.1', '\\begin{aligned}\n\\label{eq:vlb}\n\\mathcal{L}_{\\mathrm{diff}} = |\\mathbf{z}^* - \\mathbf{z}_\\theta(\\sqrt{\\bar{\\alpha}_t}\\mathbf{z}^* +\\sqrt{1-\\bar{\\alpha}_t}\\boldsymbol{\\epsilon}, \\tilde{\\mathbf{z}}, t)|^2,\n\\end{aligned}')
('3.1', '\\mathbf{z}_\\theta(\\cdot, \\cdot)')
('3.1', '\\mathbf{z}^*')
('3.1', '\\tilde{\\mathbf{z}}')
('3.1', '\\hat{\\mathbf{y}}^q')
('3.1', '\\mathbf{z}_t')
('3.1', '\\begin{aligned}\n\\label{eq:final_loss}\n\\mathcal{L} = \\sum^{|Q|}_{{(\\mathbf{x}, \\mathbf{y}) \\sim \\mathcal{Q}}} \\Big[ - \\mathbb{E}{q(\\mathbf{z}_t|\\mathbf{z}_{t+1}, \\tilde{\\mathbf{z}})}\\big[\\log p(\\mathbf{y}^q|\\mathbf{x}^q,\\mathbf{z}_t)\\big] + \\beta |\\mathbf{z}^* - \\mathbf{z}_\\theta(\\sqrt{\\bar{\\alpha}_t}\\mathbf{z}^* +\\sqrt{1-\\bar{\\alpha}_t}\\boldsymbol{\\epsilon}, \\tilde{\\mathbf{z}}, t)|^2\\Big],\n\\end{aligned}')
('3.1', '\\beta')
('3.1', '|Q|')
('3.1', '\\mathbf{z}^*')
('3.1', '\\tilde{\\mathbf{z}}')
('3.1', 't')
('3.1', '\\hat{\\mathbf{z}}_t')
('3.1', '\\mathbf{z}_T')
('3.1', '\\hat{\\mathbf{z}}')
('3.1', '\\tau {=} \\{\\mathcal{S}, \\mathcal{Q}\\}')
('3.1', '\\tilde{\\mathbf{z}}')
('3.1', '\\mathcal{S}')
('3.1', '\\epsilon')
('3.1', '\\mathcal{N}(\\textbf{0}, \\boldsymbol{I})')
('3.1', '\\tilde{\\mathbf{z}}')
('3.1', '\\epsilon')
('3.1', '\\mathbf{z}_{T-1} {=} \\mathbf{z}_{\\theta}(\\mathbf{z}_T, \\tilde{\\mathbf{z}}, T)')
('3.1', 'T')
('3.1', '\\mathbf{z}_0 = \\mathbf{z}_{\\theta}(\\mathbf{z}_{1}, \\mathbf{z}, t_0)')
('3.1', '\\mathbf{z}_0')
('3.1', '\\hat{\\mathbf{y}}^q')
('3.1', '\\mathbf{z}^*')
('3.1', '\\tilde{\\mathbf{z}}')
('3.1', '\\mathbf{z}^* - \\tilde{\\mathbf{z}}')
('3.1', '\\mathbf{z}^* -\\tilde{\\mathbf{z}}')
('3.1', '\\mathbf{z}^*')
('5', '\\%')
('5', '95\\%')
('5', '\\epsilon \\sim \\mathcal{N}(0, I)')
('5', '\\mathbf{z}^*')
('5', '2.82\\%')
('5', '28.54\\%')
('5', '1.39\\%')
('5', '5 \\times')
('5', '15 \\times')
('8', '\\{\\mathcal{S}^i, \\mathcal{Q}^i\\}')
('8', '\\mathcal{T}^i')
('8', '\\tilde{\\mathbf{z}}^i = f(\\mathcal{S}^i)')
('8', '\\nabla \\mathcal{L}_{\\mathrm{CE}}(\\mathcal{S}^i, \\mathcal{Q}^i)')
('8', '\\phi^i')
('8', '\\phi^i')
('8', '\\mathbf{z}^{i, *} = f_{\\phi^i}(\\mathcal{S}_i)')
('8', 't \\sim Uniform({1...T})')
('8', '\\epsilon = \\mathcal{N}(\\mathbf{0},\\mathbf{1})')
('8', '\\beta_t = \\frac{10^{-4}(T-t) + 10^{-2}(t-1)}{T-1}')
('8', '\\alpha_t = 1-\\beta_t')
('8', '\\bar{\\alpha}_t = \\Pi_{k=0}^{k=t} \\alpha_k')
('8', '\\hat{\\mathbf{z}}_t^i = \\sqrt{\\bar{\\alpha_t}}(\\mathbf{z}^{i, *} - \\tilde{\\mathbf{z}}^i) + \\sqrt{1-\\bar{\\alpha_t}^2}\\epsilon')
('8', '\\mathcal{L}_{\\mathrm{diff}}')
('8', '\\mathcal{L}_{\\mathcal{T}^i}')
('8', '\\{\\phi, \\theta\\} \\leftarrow \\{\\phi, \\theta\\} - \\beta \\nabla_{\\{\\phi, \\theta\\}} \\sum_{\\mathcal{T}^i \\sim p(\\mathcal{T})} \\mathcal{L}_{\\mathcal{T}^i}')
('8', '\\mathbf{z}_{T} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('8', '\\tilde{\\mathbf{z}}')
('8', 'f(\\mathcal{S})')
('8', '\\epsilon = N(\\mathbf{0},\\mathbf{1})')
('8', '\\beta_t = \\frac{10^{-4}(T-t) + 10^{-2}(t-1)}{T-1}')
('8', '\\alpha_t = 1-\\beta_t')
('8', '\\bar{\\alpha}_t = \\Pi_{k=0}^{k=t} \\alpha_k')
('8', '\\mathbf{z}_{t-1} = \\mathbf{z}_{\\theta}(\\mathbf{z}_{t}, \\tilde{\\mathbf{z}},t)')
('8', '\\mathbf{y}^q')
('8', '\\mathbf{z}_0 + \\tilde{\\mathbf{z}}')
('9', '\\tilde{\\mathbf{z}}')
('9', 'I')
('9', '\\mathbf{z}^{*}')
('10', '\\mathbf{z}^* -\\tilde{\\mathbf{z}}')
('10', '\\mathbf{z}^*')
('12', '\\times')
('12', '\\times')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\tau')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\tau')
('14', '\\tau')
('14', '\\pm')
('14', '\\pm')
('14', '\\tau')
('14', '\\pm')
('14', '\\pm')
('14', '\\tau')
('14', '\\pm')
('14', '\\pm')
('14', '\\tau')
('14', '\\pm')
('14', '\\pm')
('14', '\\tau')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '5 \\times')
('14', '\\times')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
('14', '\\pm')
