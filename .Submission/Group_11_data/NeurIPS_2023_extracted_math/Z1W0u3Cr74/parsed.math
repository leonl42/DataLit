('2', 't')
('2', 'D_t')
('2', '\\mathcal{S}_t')
('2', '\\mathcal{Q}_t')
('2', '\\mathcal{S}_t')
('2', 'N')
('2', '(x_n, y_n)')
('2', '\\mathcal{Q}_t')
('2', 'D')
('2', 't^*')
('2', '\\mathcal{S}_{t^*}')
('2', '\\mathcal{Q}_{t^*}')
('2', 'f(x)')
('2', 'C')
('2', '\\{f^c\\}_{c=1}^C')
('2', "k(\\mathbf{x},\\mathbf{x}'\\mid\\bm{\\theta},\\mathbf{w})=k'(g_{\\mathbf{w}}(\\mathbf{x}),g_{\\mathbf{w}}(\\mathbf{x}')\\mid\\bm{\\theta})")
('2', "k'")
('2', '\\bm{\\theta}')
('2', '\\mathbf{x}')
('2', "\\mathbf{x}'")
('2', 'g')
('2', '\\mathbf{w}')
('2', '\\bm{\\theta}')
('2', '\\mathbf{w}')
('3.0', '\\label{eq3}\n    p(y=k \\mid \\mathbf{f}_n)=\\frac{\\sigma{(f_n^k / \\tau)}}{\\sum_{c=1}^C\\sigma{(f_n^c / \\tau)}},')
('3.0', 'C')
('3.0', 'f_n^c=f^c(\\mathbf{x}_n)')
('3.0', '\\mathbf{f}_n=[f_n^1,\\ldots,f_n^C]^{\\top}')
('3.0', 'k \\in [C] := \\{1, \\ldots, C\\}')
('3.0', '\\tau')
('3.0', '\\sigma(\\cdot)')
('3.0', '\\operatorname{LS}(\\mathbf{f}_n, \\tau)')
('3.0', 'I := \\{ i : f_n^i > 0 \\} \\subset [C]')
('3.0', '\\lim_{\\tau \\to 0^+} \\operatorname{LS}(\\mathbf{f}_n, \\tau) = \n        \\left\\{\\begin{array}{ll}\n            \\displaystyle\n            \\bm{e}_{c^*}, &  \\text {\\normalfont if } \\displaystyle \\max_{c\\in [C]} f_n^c < 0 \\text {\\normalfont \\: and } c^*=\\displaystyle \\mathop{\\mathrm{argmax}}_{c\\in [C]} f_n^c \\\\[5pt]\n             \\displaystyle \\frac{1}{|I|} \\sum_{c \\in I} \\bm{e}_c, & \\text {\\normalfont if } \\displaystyle \\max_{c\\in [C]} f_n^c > 0\n        \\end{array}\\right.')
('3.0', '\\bm{e}_c \\in \\mathbb{R}^C')
('3.0', '1')
('3.0', 'c')
('3.0', 'f_n^c < 0')
('3.0', 'c\\in [C]')
('3.0', '\\mathbf{f}_n')
('3.0', '0')
('3.1', '\\mathbf{f}_n \\in \\mathbb{R}^{C}')
('3.1', '\\tau \\in \\mathbb{R} \\setminus \\{0\\}')
('3.1', 'C_0\\in \\mathbb R')
('3.1', '\\lim_{C^\\prime \\to +\\infty} \\operatorname{LS}(\\mathbf{f}_n - C^\\prime, \\tau)=\\operatorname{S}(\\mathbf{f}_n, \\tau) = \\operatorname{S}(\\mathbf{f}_n-C_0, \\tau),')
('3.1', '\\operatorname{S}(\\mathbf{f}_n, \\tau)')
('3.1', 'C^\\prime = 5')
('3.1', '\\mathbf{f}_n')
('3.1', 'f^c \\sim \\mathcal{GP} (a, k^c)')
('3.1', 'a')
('3.1', 'k^c')
('3.1', 'c \\in [C]')
('3.1', '\\mathbf{y} = [y_1, \\ldots, y_N]^\\top')
('3.1', 'N')
('3.1', 'a\\in \\mathscr A')
('3.1', 'k^c\\in \\mathscr K')
('3.1', '\\mathscr{A}')
('3.1', '\\mathscr K')
('3.1', '\\mathscr{F} ( \\operatorname{\\ell} \\mid \\mathscr A, \\mathscr K)')
('3.1', 'p(\\mathbf{y}|\\mathbf{X},a,k^c)')
('3.1', 'a\\in \\mathscr A')
('3.1', 'k^c\\in \\mathscr K')
('3.1', '\\mathbf{X}\\in \\mathbb R^{N\\times p}')
('3.1', '\\ell')
('3.1', '\\mathscr A')
('3.1', '% \\mathscr{F} ( \\operatorname{S} \\mid a, k^c,\\mathbf{X}) = \\mathscr{F} ( \\operatorname{S} \\mid k^c,\\mathbf{X}).\n        \\mathscr{F} ( \\operatorname{S} \\mid \\mathscr A, \\mathscr K) = \\mathscr{F} ( \\operatorname{S} \\mid \\mathscr K).')
('3.1', '\\mathscr{F} ( \\operatorname{S} \\mid \\mathscr K) \\subset {{\\mathscr{F}} ( \\operatorname{LS} \\mid \\mathscr A, \\mathscr K)}.')
('3.1', 'a')
('3.1', 'a')
('3.1', 'y')
('3.1', 'k')
('3.1', 'a')
('3.1', '(C = 3)')
('3.1', '(y = 1)')
('3.1', 'f_1')
('3.1', 'f_2')
('3.1', 'f_3')
('3.1', '-100')
('3.1', 'f_1')
('3.1', 'f_2')
('3.1', '0')
('3.1', 'f_1 - f_2 =0')
('3.1', 'p(y = 1 | \\mathbf{f})')
('3.1', 'f_3')
('3.1', '-100')
('3.1', 'f_1')
('3.1', 'f_2')
('3.1', '0')
('3.1', 'f_1')
('3.1', 'f_2')
('3.1', '0')
('3.1', 'f_1')
('3.1', 'f_2')
('3.1', '0')
('3.1', 'f')
('4.0', '\\bm{\\Theta}')
('4.0', 't')
('4.0', 'D_{t}^x')
('4.0', 'D_{t}^y')
('4.0', 'D^x')
('4.0', 'D^y')
('4.0', 'p(D^y\\mid D^x,\\bm{\\Theta})=\\prod_{t}\\int p(D_{t}^y\\mid D_{t}^x,\\bm{\\phi}_t)p(\\bm{\\phi}_t\\mid\\bm{\\Theta})d\\bm{\\phi}_t,\n\\label{eq2}')
('4.0', '\\bm{\\phi}_t')
('4.0', 't')
('4.0', 'p(\\bm{\\phi}_t\\mid\\bm{\\Theta})')
('4.1', '\\mathbf{X}=[\\mathbf{x}_1,\\ldots,\\mathbf{x}_N]^\\top')
('4.1', '\\mathbf{y}=[y_1,\\ldots,y_N]^\\top')
('4.1', 'y_n\\in [C]')
('4.1', 'N')
('4.1', 'C')
('4.1', '\\mathbf{f}=[f^1,\\ldots,f^C]^{\\top}')
('4.1', 'f^c\\sim \\mathcal{GP}(a^c, k^c)')
('4.1', 'a^c')
('4.1', 'k^c')
('4.1', 'c')
('4.1', '\\bm{\\lambda}')
('4.1', '\\mathbf{M}')
('4.1', '\\bm{\\Omega}')
('4.1', 'f^c')
('4.1', '\\begin{aligned}\n \\nonumber p(\\mathbf{Y},\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})=&\\prod_{n=1}^N\\prod_{c=1}^C2^{-(y_n^c+m_n^c)}\\exp \\bigg(\\frac{y_n^c-m_n^c}{2}\\frac{f_n^c}{\\tau}-\\frac{\\omega_n^c}{2}{\\Big(\\frac{f_n^c}{\\tau}\\Big)^2}\\bigg )\\text{PG}(\\omega_n^c\\mid m_n^c+y_n^c,0) \\\\ \\label{eq10}\n    &\\cdot \\frac{\\lambda_n^{m_n^c}}{m_n^c!}\\exp(-\\lambda_n)\\cdot\\prod_{c=1}^C\\mathcal{N}(\\mathbf{f}^c\\mid\\mathbf{a}^c,\\mathbf{K}^c),\n\\end{aligned}')
('4.1', '\\mathbf{f}^c=[f_1^c,\\ldots,f_N^c]^{\\top}')
('4.1', 'c')
('4.1', '\\mathbf{F}')
('4.1', '\\lambda_n')
('4.1', 'm_n^c')
('4.1', '\\omega_n^c')
('4.1', '\\mathbf{a}^c')
('4.1', '\\mathbf{K}^c')
('4.1', 'c')
('4.1', 'N')
('4.1.0', 'p(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F}\\mid\\mathbf{Y})')
('4.1.0', 'q(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})=q_1(\\mathbf{M},\\bm{\\Omega})q_2(\\bm{\\lambda},\\mathbf{F})')
('4.1.0', '\\label{eq11}\n\\begin{minipage}{0.52\\textwidth}\n\\begin{gather}\n\\label{eq11a}\nq_1(\\bm{\\Omega}|\\mathbf{M})=\\prod_{n,c=1}^{N,C}\\text{PG}(\\omega_n^c\\mid m_n^c+y_n^c,\\widetilde{f}_n^c),\\\\\n\\label{eq11b}\nq_1(\\mathbf{M})=\\prod_{n,c=1}^{N,C}\\text{Po}(m_n^c\\mid\\gamma_n^c),\n\\end{gather}\n\\end{minipage}\n\\begin{minipage}{0.47\\textwidth}\n\\begin{gather}\n\\label{eq11c}\nq_2(\\bm{\\lambda})=\\prod_{n=1}^{N}\\text{Ga}(\\lambda_n\\mid\\alpha_n,C),\\\\\n\\label{eq11d}\nq_2(\\mathbf{F})=\\prod_{c=1}^C\\mathcal{N}(\\mathbf{f}^c\\mid\\widetilde{\\bm{\\mu}}^c,\\widetilde{\\bm{\\Sigma}}^c), \n\\end{gather}\n\\end{minipage}')
('4.1.0', '\\label{eq12}\n\\begin{minipage}{0.5\\textwidth}\n\\begin{gather}\n\\label{eq12a}\n\\widetilde{f}_n^c=\\frac{1}{\\tau}\\sqrt{\\mathbb{E}[f_n^{c^2}]}=\\frac{1}{\\tau}\\sqrt{\\widetilde{\\mu}_n^{c^2}+\\widetilde{\\sigma}_{nn}^{c^2}},\\\\\n\\label{eq12b}\n\\gamma_n^c=\\frac{\\exp(\\psi(\\alpha_n)-\\widetilde{\\mu}_n^c/2 \\tau)}{2C\\cosh(\\widetilde{f}_n^c/2)},\\\\\n\\label{eq12c}\n\\alpha_n=\\sum_{c=1}^C\\gamma_n^c+1,\n\\end{gather}\n\\end{minipage}\n\\begin{minipage}{0.5\\textwidth}\n\\begin{gather}\n\\label{eq12d}\n\\widetilde{\\bm{\\Sigma}}^c=(\\text{diag}(\\bar{\\omega}_n^c / \\tau^2)+\\mathbf{K}^{c^{-1}})^{-1},\\\\\n\\label{eq12e}\n\\widetilde{\\bm{\\mu}}^c=\\frac{1}{2 \\tau }\\widetilde{\\bm{\\Sigma}}^c(\\mathbf{y}^c-\\bm{\\gamma}^c) + \\widetilde{\\bm{\\Sigma}}^c\\mathbf{K}^{c^{-1}}\\mathbf{a}^c,\\\\\n\\label{eq12f}\n\\bar{\\omega}_n^c=\\mathbb{E}[\\omega_n^c]=\\frac{\\gamma_n^c+y_n^c}{2\\widetilde{f}_n^c}\\tanh\\frac{\\widetilde{f}_n^c}{2}. \n\\end{gather}\n\\end{minipage}')
('4.1.0', '\\psi(\\cdot)')
('4.1.0', '\\bm{\\Omega},\\mathbf{M},\\bm{\\lambda}')
('4.1.0', '\\mathbf{F}')
('4.2', '\\bm{\\Theta}')
('4.2', '\\begin{aligned}\n \\label{eq13}\n\\sum_{t=1}^T\\log p(\\mathbf{Y}_t\\mid\\bm{\\Theta})=\\sum_{t=1}^T\\log\\int p(\\mathbf{Y}_t,\\bm{\\lambda}_t,\\mathbf{M}_t,\\bm{\\Omega}_t,\\mathbf{F}_t\\mid\\bm{\\Theta})d\\bm{\\lambda}_t d\\mathbf{M}_t d\\bm{\\Omega}_t d\\mathbf{F}_t, \n\\end{aligned}')
('4.2', 't')
('4.2', 't')
('4.2', '\\mathcal{L}')
('4.2', '\\bm{\\Theta}')
('4.2', '\\nabla_{\\bm{\\Theta}}\\mathcal{L}')
('4.2', '\\bm{\\Theta}')
('4.2', '\\begin{aligned}\n    \\nabla_{\\boldsymbol{\\theta}} \\mathcal{L}_{\\mathrm{PL}} \n    \\approx \\frac{1}{M} \\sum_{m=1}^M \\nabla_{\\boldsymbol{\\theta}} \\log p (y_*=k\\mid\\mathbf{x}_*,\\mathbf{X},\\mathbf{Y},\\widehat{\\bm{\\Theta}}), \n\\end{aligned}')
('4.2', 'M')
('4.3', '\\mathbf{X}=\\{\\mathbf{x}_l\\}_{l=1}^L')
('4.3', '\\mathbf{Y}=\\{\\mathbf{y}_l\\}_{l=1}^L')
('4.3', '\\mathbf{x}_*')
('4.3', 'y_*=k')
('4.3', '\\label{eq15}\n\\begin{gather}\n\\label{eq15a}\np(y_*=k\\mid\\mathbf{x}_*,\\mathbf{X},\\mathbf{Y},\\widehat{\\bm{\\Theta}})=\\int p(y_*=k\\mid\\mathbf{f}_*)\\prod_{c=1}^C q(f_*^c\\mid\\mathbf{X},\\mathbf{Y},\\widehat{\\bm{\\Theta}})d\\mathbf{f}_*,\\\\\n\\label{eq15b}\nq(f_*^c\\mid\\mathbf{X},\\mathbf{Y},\\widehat{\\bm{\\Theta}})=\\int p(f_*^c\\mid\\mathbf{f}^c)q(\\mathbf{f}^c\\mid\\mathbf{X},\\mathbf{Y},\\widehat{\\bm{\\Theta}})d\\mathbf{f}^c=\\mathcal{N}(f_*^c\\mid\\mu_*^c,{\\sigma_*^2}^c),\n\\end{gather}')
('4.3', 'k\\in\\{1,\\ldots,C\\}')
('4.3', '\\widehat{\\bm{\\Theta}}')
('4.3', 'p(y_*=k\\mid\\mathbf{f}_*)')
('4.3', '\\mathbf{f}_*=[f^1(\\mathbf{x}_*),\\ldots,f^C(\\mathbf{x}_*)]^{\\top}')
('4.3', 'q(\\mathbf{f}^c\\mid\\mathbf{X},\\mathbf{Y},\\widehat{\\bm{\\Theta}})')
('4.3', '\\mu_*^c=\\mathbf{k}_{*l}^c\\mathbf{K}_{ll}^{c^{-1}}\\widetilde{\\bm{\\mu}}^c')
('4.3', '{\\sigma_*^2}^c=k_{**}^c-\\mathbf{k}_{*l}^c\\mathbf{K}_{ll}^{c^{-1}}\\mathbf{k}_{l*}^c+\\mathbf{k}_{*l}^c\\mathbf{K}_{ll}^{c^{-1}}\\widetilde{\\bm{\\Sigma}}^c\\mathbf{K}_{ll}^{c^{-1}}\\mathbf{k}_{l*}^c')
('5.0', '\\tau < 1')
('5.0', '\\tau = 0.5')
('5.0', '\\tau = 0.2')
('5.0', '-5')
('5.0', '\\tau < 1')
('5.0', '\\tau < 1')
('5.0', '\\tau = 0.2 ~\\text{or}~ 0.5')
('5.0', '\\tau = 1')
('5.1', '2')
('5.1', '\\rightarrow')
('9.0', 'f_n^c \\ne 0')
('9.0', 'c = 1, \\ldots, C')
('9.0', 'k')
('9.0', 'f_n^k > 0')
('9.0', '\\sigma (f_n^k / \\tau)')
('9.0', '1')
('9.0', '\\tau \\to 0')
('9.0', '\\sigma (f_n^k / \\tau)')
('9.0', '0')
('9.0', 'f_n^k < 0')
('9.0', '\\operatorname{LS}(\\mathbf{f}, \\tau)_k = \\frac{\\sigma (f_n^k / \\tau)}{\\sum_{c=1}^C \\sigma (f_n^c / \\tau)}')
('9.0', '\\max_{c = 1, \\ldots, C} f_n^c > 0')
('9.0', '\\max_{c = 1, \\ldots, C} f_n^c < 0')
('9.0', '\\begin{aligned}\n        \\lim_{\\tau \\to 0^+} \\operatorname{LS}(\\mathbf{f}, \\tau)_k \n        = ~& \\bigg (1 + \\lim_{\\tau \\to 0^+} \\sum_{c \\ne k} \\frac{1 + \\exp(- f_n^k / \\tau)}{1 + \\exp (- f_n^c / \\tau)} \\bigg )^{-1} \\\\\n        = ~& \\bigg (1 + \\lim_{\\tau \\to 0^+} \\sum_{c \\ne k} \\frac{f_n^k \\exp(- f_n^k / \\tau) / \\tau^2}{f_n^c \\exp (- f_n^c / \\tau) / \\tau^2} \\bigg )^{-1} \\\\\n        = ~& \\bigg (1 + \\lim_{\\tau \\to 0^+} \\sum_{c \\ne k} \\frac{f_n^k}{f_n^c} \\exp (- (f_n^k - f_n^c) / \\tau) \\bigg )^{-1},\n    \n\\end{aligned}')
('9.0', 'f_n^k / f_n^c > 0')
('9.0', '\\exp (- (f_n^k - f_n^c) / \\tau)')
('9.0', '0')
('9.0', 'f_n^k > f_n^c')
('9.0', '+ \\infty')
('9.0', '\\lim_{\\tau \\to 0^+} \\operatorname{LS}(\\mathbf{f}_n, \\tau)_k = \\mathbb{I} \\{k = c^*\\}')
('9.0', '\\mathbb{I} \\{ \\cdot \\}')
('9.1', '\\tau = 1')
('9.1', '\\begin{aligned}\n    p(y=k | \\mathbf{f}_n-C^\\prime) &= \\frac{1}{\\sum_{c=1}^C \\sigma(f_n^c-C^\\prime) / \\sigma(f_n^k-C^\\prime)},C^\\prime \\in \\mathbb{R}.\n\\end{aligned}')
('9.1', '\\mathbf{f}_n')
('9.1', 'C^\\prime')
('9.1', 'c, k \\in [C]')
('9.1', '\\begin{aligned}\n    \\frac{\\sigma(f_n^c-C^{\\prime})}{\\sigma(f_n^k-C^{\\prime})}&=\\exp(f_n^c - f_n^k) \\cdot \\frac{1+\\exp(f_n^k - C^{\\prime})}{1+\\exp(f_n^c - C^{\\prime})}\\\\\n    & \\to \\exp(f_n^c-f_n^k)\n\\end{aligned}')
('9.1', 'C^\\prime \\rightarrow \\infty')
('9.1', 'S(\\mathbf{f}_n-C_0)=S(\\mathbf{f}_n)')
('9.1', '\\begin{aligned}\n    p(y_n = k|\\mathbf{f_n})&=\\frac{1}{1+\\sum_{j\\neq k} \\exp(f_n^j-f_n^k)}\\\\\n    &=\\frac{1}{1+\\sum_{j\\neq k} \\exp((f_n^j-C_0)-(f_n^k-C_0))}\n    .\n\\end{aligned}')
('9.1', '\\mathbf{f_n}')
('9.2', '\\tau = 1')
('9.2', '\\mathbf{f}^c = (f_1^c, \\ldots, f_N^c)^\\top \\in \\mathbb{R}^N')
('9.2', 'c')
('9.2', '\\mathbf{F}=(f_{n}^c)_{N\\times C}\\in \\mathbb R^{N\\times C}')
('9.2', '\\mathbf{f} = vec(\\mathbf{F})')
('9.2', '\\mathbf{f} \\sim \\mathcal N\\big(\\operatorname{vec}(\\mathbf{a}\\mathbf{1}_{C}^T\\big), \\mathbf{K})')
('9.2', '\\mathbf\n{a}')
('9.2', '\\mathbf{K} = {\\rm diag}(\\mathbf{K}^1, \\ldots, \\mathbf{K}^C) \\in \\mathbb{R}^{NC \\times NC}')
('9.2', '\\mathbf{K}^c')
('9.2', '\\mathbf{y} \\in \\mathbf{R}^N')
('9.2', 'N')
('9.2', 'y_n \\in [C]')
('9.2', '\\begin{aligned}\n        p(\\mathbf{y}) &= \\int \\prod_{n=1}^N \\frac{1}{1+ \\sum_{j\\neq y_n} \\exp(f_n^j-f_n^{y_n})}p(\\mathbf{f})d\\mathbf{f}.\\\\\n    \n\\end{aligned}')
('9.2', '\\mathbf{\\widetilde{f}} \\in \\mathbb{R}^{NC}')
('9.2', '\\begin{aligned}\n\\label{equa:linear_transform}\n        \\widetilde f^j_n = \\left\\{\\begin{array}{ll}\n            \\displaystyle\n            f^j_n - f^{y_n}_n, &  \\text {\\normalfont if } j \\neq y_n \\\\[5pt]\n             \\displaystyle f^{y_n}_n, & \\text {\\normalfont if } \\displaystyle j = y_n.\n        \\end{array}\\right.\n    \n\\end{aligned}')
('9.2', '\\mathbf{\\widetilde{f}}_y \\in \\mathbb{R}^N')
('9.2', 'n')
('9.2', 'f_n^{y_n}')
('9.2', '\\mathbf{\\widetilde{f}}_{-y} \\in \\mathbb{R}^{N{(C-1)}}')
('9.2', '\\mathbf{\\widetilde{f}}')
('9.2', '\\mathbf{f}')
('9.2', '\\mathbf{\\widetilde{f}}_{-y}')
('9.2', 'a')
('9.2', '\\begin{aligned}\n        p(\\mathbf{y}) &= \\int \\prod_{n=1}^N \\frac{1}{1+ \\sum_{j\\neq y_n} \\exp(\\widetilde f^j_n)} p(\\mathbf{\\widetilde{f}}_y)d\\mathbf{\\widetilde{f}}_y\\\\\n        & = \\int \\prod_{n=1}^N \\frac{1}{1+ \\sum_{j\\neq y_n} \\exp(\\widetilde f^j_n)}p(\\mathbf{\\widetilde{f}}_{y} \\mid \\mathbf{\\widetilde{f}}_{-y})p(\\mathbf{\\widetilde{f}}_{-y})d\\mathbf{\\widetilde{f}}\\\\\n        & = \\int \\prod_{n=1}^N\\frac{1}{1+ \\sum_{j\\neq y_n} \\exp(\\widetilde f^j_n)}p(\\mathbf{\\widetilde{f}}_{-y})d\\mathbf{\\widetilde{f}}_{-y},\n    \n\\end{aligned}')
('9.2', 'p(\\mathbf{\\widetilde{f}}_{y} \\mid \\mathbf{\\widetilde{f}}_{-y})')
('9.2', 'p (\\mathbf{y})')
('9.2', 'a')
('9.2', '\\mathbf{\\widetilde{f}}_{-y}')
('9.2', 'a')
('9.2', 'p(\\mathbf{y})')
('9.2', 'k^c')
('9.2', '\\mathbf{y}')
('9.2', '\\mathbf{a}')
('9.2', '\\mathbf K')
('9.2', 'p_{ls}(\\mathbf{y}|\\mathbf{a},\\mathbf{K})')
('9.2', 'p_{s}(\\mathbf{y}|\\mathbf{K})')
('9.2', '\\label{eq:convergence}\n        \\begin{aligned} \n    \\lim_{\\mathbf{a}\\rightarrow -\\infty}p_{ls}(\\mathbf{y}| \\mathbf{a}, \\mathbf{K})&=\\lim_{\\mathbf{a}\\rightarrow -\\infty}\\int p_{ls}(\\mathbf{y}|\\mathbf{F})p(\\mathbf{F}|\\mathbf{a}, \\mathbf{K})d\\mathbf{F}\\\\&=\n        \\lim_{\\mathbf{a}\\rightarrow \\infty}\\int p_{ls}(\\mathbf{y}|\\mathbf{F}-\\mathbf{a}\\mathbf{1}_C^T)p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})d\\mathbf{F}\\\\ \n        &=\\int \\lim_{\\mathbf{a}\\rightarrow \\infty}p_{ls}(\\mathbf{y}|\\mathbf{F}-\\mathbf{a}\\mathbf{1}_C^T)p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})d\\mathbf{F}\\\\ \n        &=\\int p_{s}(\\mathbf{y}|\\mathbf{F})p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})d\\mathbf{F} \n         = p_s(\\mathbf{y}|\\mathbf{K}),\n    \\end{aligned}')
('9.2', '\\begin{aligned}\n    % \\lim_{C^\\prime \\rightarrow \\infty}p_{ls}(\\mathbf{y},\\mathbf{f}-C^\\prime;0, k^c) = p_s(\\mathbf{y},\\mathbf{f};0, k^c),\np_{ls}(\\mathbf{y}|\\mathbf{F}-\\mathbf{a}\\mathbf{1}_C^T)p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})&=\\prod_{n=1}^N \\frac{\\sigma(f_n^{y_n}-a_n)}{\\sum_{j=1}^C \\sigma(f_n^j-a_n)} p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})\\\\ \n&\\leq p(\\mathbf{F}|\\mathbf{0},\\mathbf{K}).\n\\end{aligned}')
('9.2', 'p_{ls}(\\mathbf{y}|\\mathbf{F}-\\mathbf{a}\\mathbf{1}_C^T)p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})')
('9.2', 'p(\\mathbf{F}|\\mathbf{0},\\mathbf{K})')
('9.2', '\\lim_{\\mathbf{a}\\rightarrow \\infty}p_{ls}(\\mathbf{y}|\\mathbf{F}-\\mathbf{a}\\mathbf{1}_C^T)=p_{s}(\\mathbf{y}|\\mathbf{F}),')
('9.2', 'a')
('9.2', 'k^c')
('9.2', 'x_i \\in \\mathbb{R}^p')
('9.2', '\\begin{aligned}\n        \\mathscr A &:= \\{f: \\mathbb R^{p}\\rightarrow \\overline{\\mathbb R}\\},\\\\\n            \\mathscr K&:=\\{f: \\mathbb{R}^{p}\\times  \\mathbb{R}^{p}\\rightarrow \\mathbb R, f \\text{~is postive semi-definite}\\}.\n\\end{aligned}')
('9.2', 'a_0(\\mathbf{x}) \\equiv -\\infty, \\forall \\mathbf{x}\\in \\mathbb R^p')
('9.2', 'a_0\\in \\mathscr A')
('9.2', '\\mathbf{y}')
('9.2', 'a_0')
('9.2', 'k^c')
('9.2', '\\mathbf{X}')
('9.2', '\\label{eq:equal}\n\\begin{aligned}\n        p_{ls}(\\mathbf{y}|\\mathbf{X},a_0, k^c)&:=\\lim_{\\mathbf{a}\\rightarrow -\\infty}p_{ls}(\\mathbf{y}|\\mathbf{a},\\mathbf{K})\\\\\n        &=p_s(\\mathbf{y}|\\mathbf{K}),\n\\end{aligned}')
('9.2', '{\\mathscr{F} ( \\operatorname{LS} \\mid \\mathscr A, \\mathscr K)}')
('9.2', '\\mathscr{F} ( \\operatorname{S} \\mid \\mathscr K)')
('9.2', '\\label{app:function class}\n\\begin{aligned}\n        {\\mathscr{F} ( \\operatorname{LS} \\mid \\mathscr A, \\mathscr K)}:&=\\{f: f(\\mathbf{y})=p_{ls}(\\mathbf{y}|\\mathbf{a},\\mathbf{K}), a_i = a(\\mathbf{x_i}), k^c_{ij}=k^c(\\mathbf{x}_i,\\mathbf{x}_j), a\\in \\mathscr A, k^c\\in \\mathscr K, \\mathbf{X} \\in \\mathbb R^{N\\times p}\\},\\\\\n    \\mathscr{F} ( \\operatorname{S} \\mid \\mathscr K) :&=\\{f: f(\\mathbf{y})=p_{s}(\\mathbf{y}|\\mathbf{K}), k^c_{ij}=k^c(\\mathbf{x}_i,\\mathbf{x}_j), k^c\\in \\mathscr K, \\mathbf{X} \\in \\mathbb R^{N\\times p}\\}.\n\\end{aligned}')
('9.2', 'p_s(\\cdot|\\mathbf{X},k^c)')
('9.2', '\\mathscr{F} (\\operatorname{S}\\mid \\mathscr K)')
('9.2', 'p_{ls}(\\cdot|\\mathbf{X},a_0, k^c) = p_s(\\cdot|\\mathbf{X},k^c)')
('9.2', 'p_{ls}(\\cdot|\\mathbf{X},a_0, k^c) \\in \\mathscr{F} ( \\operatorname{LS} \\mid \\mathscr A, \\mathscr K)')
('9.2', '\\mathscr{F} ( \\operatorname{S} \\mid  \\mathscr K) \\subset {{\\mathscr{F}} ( \\operatorname{LS} \\mid \\mathscr A,\\mathscr K)}.')
('9.3', '\\begin{aligned}\np(y_n=k\\mid\\mathbf{f}_n)=\\frac{\\sigma{(f_n^k / \\tau)}}{\\sum_{c=1}^C\\sigma{(f_n^c / \\tau)}},\n\\end{aligned}\n\\label{app.eq1}')
('9.3', 'f_n^c=f^c(\\mathbf{x}_n)')
('9.3', '\\mathbf{f}_n=[f_n^1,\\ldots,f_n^C]^{\\top}')
('9.3', 'k\\in\\{1,\\ldots,C\\}')
('9.3', '\\mathbf{x}_n')
('9.3.0', '1/z=\\int_0^\\infty \\exp{(-\\lambda z)}d\\lambda')
('9.3.0', '\\begin{aligned}\np(\\mathbf{y}\\mid\\mathbf{F})&=\\prod_{n=1}^N\\frac{\\sigma(f_n^k / \\tau)}{\\sum_{c=1}^C\\sigma{(f_n^c / \\tau )}}=\\prod_{n=1}^N\\sigma(f_n^k / \\tau )\\int_0^\\infty\\exp(-\\lambda_n\\sum_{c=1}^C\\sigma(f_n^c / \\tau ))d\\lambda_n\\\\\n&=\\int_0^\\infty\\cdots\\int_0^\\infty\\prod_{n=1}^N\\sigma(f_n^k / \\tau)\\exp(-\\lambda_n\\sum_{c=1}^C\\sigma(f_n^c / \\tau ))d\\lambda_1\\cdots d\\lambda_N, \n\\end{aligned}')
('9.3.0', '\\mathbf{y}=[y_1,\\ldots,y_N]^\\top')
('9.3.0', '\\mathbf{F}')
('9.3.0', 'N\\times C')
('9.3.0', 'f_n^c')
('9.3.0', '\\begin{aligned}\np(\\mathbf{y},\\bm{\\lambda}\\mid\\mathbf{F})&=\\prod_{n=1}^N\\sigma(f_n^k / \\tau)\\prod_{c=1}^C\\exp(-\\lambda_n\\sigma(f_n^c / \\tau)),\n\\end{aligned}\n\\label{app.eq2}')
('9.3.0', '\\bm{\\lambda}=[\\lambda_1,\\ldots,\\lambda_N]^{\\top}')
('9.3.0.0', '\\exp(\\lambda(z-1))=\\sum_{m=0}^\\infty z^m\\text{Po}(m\\mid\\lambda)')
('9.3.0.0', '\\sigma(x)=1-\\sigma(-x)')
('9.3.0.0', '\\begin{aligned}\np(\\mathbf{y},\\bm{\\lambda}\\mid\\mathbf{F})&=\\prod_{n=1}^N\\sigma(f_n^k / \\tau)\\prod_{c=1}^C\\sum_{m_n^c=0}^\\infty\\sigma(-f_n^c / \\tau)^{m_n^c}\\text{Po}(m_n^c|\\lambda_n).\n\\end{aligned}')
('9.3.0.0', '\\begin{aligned}\np(\\mathbf{y},\\bm{\\lambda},\\mathbf{M}\\mid\\mathbf{F})&=\\prod_{n=1}^N\\sigma(f_n^k / \\tau)\\prod_{c=1}^C\\sigma(-f_n^c / \\tau)^{m_n^c}\\text{Po}(m_n^c|\\lambda_n),\n\\end{aligned}\n\\label{app.eq3}')
('9.3.0.0', '\\mathbf{M}')
('9.3.0.0', 'N\\times C')
('9.3.0.0', 'm_n^c')
('9.3.0.1', '\\begin{aligned}\n\\sigma(z)=2^{-1}e^{z/2}\\int_0^\\infty e^{-\\omega z^2/2}\\text{PG}(\\omega\\mid1,0)d\\omega, \n\\end{aligned}')
('9.3.0.1', '\\text{PG}(\\omega\\mid 1,0)')
('9.3.0.1', '\\begin{aligned}\np(\\mathbf{Y},\\bm{\\lambda},\\mathbf{M}\\mid\\mathbf{F})&=\\int_0^\\infty \\cdots \\int_0^\\infty\\prod_{n=1}^N\\prod_{c=1}^C 2^{-(y_n^c+m_n^c)}\\exp \\Big(\\frac{y_n^c-m_n^c}{2}\\frac{f_n^c}{\\tau}-\\frac{\\omega_n^c}{2}\\Big(\\frac{f_n^c}{\\tau}\\Big)^2 \\Big)\\\\\n&\\text{PG}(\\omega_n^c\\mid m_n^c+y_n^c,0)\\frac{\\lambda_n^{m_n^c}}{m_n^c!}\\exp(-\\lambda_n)d\\omega_1^1 \\cdots d\\omega_N^C,\n\\end{aligned}')
('9.3.0.1', '\\mathbf{y}')
('9.3.0.1', '\\mathbf{Y}')
('9.3.0.1', 'N\\times C')
('9.3.0.1', '\\begin{aligned}\np(\\mathbf{Y},\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega}\\mid\\mathbf{F})&=\\prod_{n=1}^N\\prod_{c=1}^C 2^{-(y_n^c+m_n^c)}\\exp \\Big(\\frac{y_n^c-m_n^c}{2}\\frac{f_n^c}{\\tau}-\\frac{\\omega_n^c}{2}\\Big(\\frac{f_n^c}{\\tau}\\Big)^2 \\Big)\\text{PG}(\\omega_n^c\\mid m_n^c+y_n^c,0)\\\\\n&\\frac{\\lambda_n^{m_n^c}}{m_n^c!}\\exp(-\\lambda_n),\n\\end{aligned}\n\\label{app.eq4}')
('9.3.0.1', '\\bm{\\Omega}')
('9.3.0.1', 'N\\times C')
('9.3.0.1', '\\omega_n^c')
('9.3.0.2', 'f^c')
('9.3.0.2', '\\begin{aligned}\np(\\mathbf{Y},\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})&=\\prod_{n=1}^N\\prod_{c=1}^C2^{-(y_n^c+m_n^c)}\\exp \\Big(\\frac{y_n^c-m_n^c}{2}\\frac{f_n^c}{\\tau}-\\frac{\\omega_n^c}{2}\\Big(\\frac{f_n^c}{\\tau}\\Big)^2 \\Big)\\text{PG}(\\omega_n^c\\mid m_n^c+y_n^c,0)\\\\\n&\\frac{\\lambda_n^{m_n^c}}{m_n^c!}\\exp(-\\lambda_n)\\cdot\\prod_{c=1}^C\\mathcal{N}(\\mathbf{f}^c\\mid\\mathbf{a}^c,\\mathbf{K}^c),\n\\end{aligned}\n\\label{app.eq5}')
('9.3.0.2', '\\mathbf{f}^c=[f_1^c,\\ldots,f_N^c]^{\\top}')
('9.3.0.2', 'c')
('9.3.0.2', '\\mathbf{F}')
('9.3.0.2', '\\mathbf{a}^c')
('9.3.0.2', '\\mathbf{K}^c')
('9.3.0.2', 'c')
('9.4', 'p(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F}\\mid\\mathbf{Y})')
('9.4', 'q(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})=q_1(\\mathbf{M},\\bm{\\Omega})q_2(\\bm{\\lambda},\\mathbf{F})')
('9.4', '\\begin{aligned}\n\\log q_1(\\mathbf{M},\\bm{\\Omega})&=\\mathbb{E}_{q_2}\\log p(\\mathbf{Y},\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})+C_1,\\\\\n\\log q_2(\\bm{\\lambda},\\mathbf{F})&=\\mathbb{E}_{q_1}\\log p(\\mathbf{Y},\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})+C_2,\n\\end{aligned}')
('9.4', 'C_1')
('9.4', 'C_2')
('9.4', '\\begin{minipage}{0.52\\textwidth}\n\\begin{gather}\nq_1(\\bm{\\Omega}|\\mathbf{M})=\\prod_{n,c=1}^{N,C}\\text{PG}(\\omega_n^c\\mid m_n^c+y_n^c,\\widetilde{f}_n^c),\\\\\nq_1(\\mathbf{M})=\\prod_{n,c=1}^{N,C}\\text{Po}(m_n^c\\mid\\gamma_n^c),\n\\end{gather}\n\\end{minipage}\n\\begin{minipage}{0.47\\textwidth}\n\\begin{gather}\nq_2(\\bm{\\lambda})=\\prod_{n=1}^{N}\\text{Ga}(\\lambda_n\\mid\\alpha_n,C),\\\\\nq_2(\\mathbf{F})=\\prod_{c=1}^C\\mathcal{N}(\\mathbf{f}^c\\mid\\widetilde{\\bm{\\mu}}^c,\\widetilde{\\bm{\\Sigma}}^c), \n\\end{gather}\n\\end{minipage}')
('9.4', '\\begin{minipage}{0.5\\textwidth}\n\\begin{gather}\n\\widetilde{f}_n^c=\\frac{1}{\\tau}\\sqrt{\\mathbb{E}[f_n^{c^2}]}=\\frac{1}{\\tau}\\sqrt{\\widetilde{\\mu}_n^{c^2}+\\widetilde{\\sigma}_{nn}^{c^2}},\\\\\n\\gamma_n^c=\\frac{\\exp(\\psi(\\alpha_n)-\\widetilde{\\mu}_n^c/2 \\tau)}{2C\\cosh(\\widetilde{f}_n^c/2)},\\\\\n\\alpha_n=\\sum_{c=1}^C\\gamma_n^c+1,\n\\end{gather}\n\\end{minipage}\n\\begin{minipage}{0.5\\textwidth}\n\\begin{gather}\n\\widetilde{\\bm{\\Sigma}}^c=(\\text{diag}(\\bar{\\omega}_n^c / \\tau^2)+\\mathbf{K}^{c^{-1}})^{-1},\\\\\n\\widetilde{\\bm{\\mu}}^c=\\frac{1}{2 \\tau }\\widetilde{\\bm{\\Sigma}}^c(\\mathbf{y}^c-\\bm{\\gamma}^c) + \\widetilde{\\bm{\\Sigma}}^c\\mathbf{K}^{c^{-1}}\\mathbf{a}^c,\\\\\n\\bar{\\omega}_n^c=\\mathbb{E}[\\omega_n^c]=\\frac{\\gamma_n^c+y_n^c}{2\\widetilde{f}_n^c}\\tanh\\frac{\\widetilde{f}_n^c}{2}. \n\\end{gather}\n\\end{minipage}')
('9.5', '\\log p(\\mathbf{Y})\\geq\\mathcal{L}=\\mathbb{E}_q[\\log p(\\mathbf{Y}\\mid\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})]-\\text{KL}(q(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})||p(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})),\n  \\label{app.eq9}')
('9.5', '\\bm{\\Theta}')
('9.5', '\\label{app.eq10}\n  \\begin{align}\n  \\label{app.eq10a}\n  &\\mathbb{E}_q[\\log p(\\mathbf{Y}\\mid\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})]=\\sum_{n=1,c=1}^{N,C}-(y_n^c+\\gamma_n^c)\\log2+\\frac{y_n^c-\\gamma_n^c}{2 \\tau}\\widetilde{\\mu}_n^c-\\frac{\\bar{\\omega}_n^c}{2}\\widetilde{f}_n^{c^2},\\\\\n  \\label{app.eq10b}\n  &\\text{KL}(q(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F})||p(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega},\\mathbf{F}))=\\text{KL}(q(\\mathbf{F})||p(\\mathbf{F}))+\\text{KL}(q(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega})||p(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega})),\\\\\n  \\label{app.eq10c}\n  &\\text{KL}(q(\\mathbf{F})||p(\\mathbf{F}))=\\frac{1}{2}\\sum_{c=1}^C(\\log|\\mathbf{K}^c|-\\log|\\widetilde{\\bm{\\Sigma}}^c|-N+\\text{Tr}[\\mathbf{K}^{c^{-1}}\\widetilde{\\bm{\\Sigma}}^c]+(\\mathbf{a}^c-\\widetilde{\\bm{\\mu}}^c)^{\\top}\\mathbf{K}^{c^{-1}}(\\mathbf{a}^c-\\widetilde{\\bm{\\mu}}^c)),\\\\\n  \\label{app.eq10d}\n  &\\text{KL}(q(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega})||p(\\bm{\\lambda},\\mathbf{M},\\bm{\\Omega}))=\\text{KL}(q(\\bm{\\lambda})||p(\\bm{\\lambda}))+\\mathbb{E}_{q(\\bm{\\lambda})}[\\text{KL}(q(\\mathbf{M})||p(\\mathbf{M}\\mid\\bm{\\lambda}))]\\\\\n  &+\\mathbb{E}_{q(\\mathbf{M})}[\\text{KL}(q(\\bm{\\Omega}\\mid\\mathbf{M})||p(\\bm{\\Omega}\\mid\\mathbf{M}))],\\nonumber\\\\\n  \\label{app.eq10e}\n  &\\text{KL}(q(\\bm{\\lambda})||p(\\bm{\\lambda}))=\\sum_{n=1}^N-\\alpha_n+\\log C-\\log\\Gamma(\\alpha_n)-(1-\\alpha_n)\\psi(\\alpha_n),\\\\\n  \\label{app.eq10f}\n  &\\mathbb{E}_{q(\\bm{\\lambda})}[\\text{KL}(q(\\mathbf{M})||p(\\mathbf{M}\\mid\\bm{\\lambda}))]=\\sum_{n=1,c=1}^{N,C}\\gamma_n^c(\\log \\gamma_n^c-1)-\\gamma_n^c(\\psi(\\alpha_n)-\\log C)+\\frac{\\alpha_n}{C},\\\\\n  \\label{app.eq10g}\n  &\\mathbb{E}_{q(\\mathbf{M})}[\\text{KL}(q(\\bm{\\Omega}\\mid\\mathbf{M})||p(\\bm{\\Omega}\\mid\\mathbf{M}))]=\\sum_{n=1,c=1}^{N,C}-\\frac{\\widetilde{f}_n^{c^2}}{2}\\bar{\\omega}_n^c+(\\gamma_n^c+y_n^c)\\log\\cosh(\\frac{\\widetilde{f}_n^c}{2}).\n  \\end{align}')
('9.5', '\\begin{aligned}\n  \\mathcal{L}=&\\sum_{n=1,c=1}^{N,C}-(y_n^c+\\gamma_n^c)\\log2+\\frac{y_n^c-\\gamma_n^c}{2 \\tau}\\widetilde{\\mu}_n^c-\\frac{\\bar{\\omega}_n^c}{2 }\\widetilde{f}_n^{c^2}\\\\\n  &-\\frac{1}{2}\\sum_{c=1}^C(\\log|\\mathbf{K}^c|-\\log|\\widetilde{\\bm{\\Sigma}}^c|-N+\\text{Tr}[\\mathbf{K}^{c^{-1}}\\widetilde{\\bm{\\Sigma}}^c]+(\\mathbf{a}^c-\\widetilde{\\bm{\\mu}}^c)^{\\top}\\mathbf{K}^{c^{-1}}(\\mathbf{a}^c-\\widetilde{\\bm{\\mu}}^c))\\\\\n  &-\\sum_{n=1}^N-\\alpha_n+\\log C-\\log\\Gamma(\\alpha_n)-(1-\\alpha_n)\\psi(\\alpha_n)\\\\\n  &-\\sum_{n=1,c=1}^{N,C}\\gamma_n^c(\\log \\gamma_n^c-1)-\\gamma_n^c(\\psi(\\alpha_n)-\\log C)+\\frac{\\alpha_n}{C}\\\\\n  &-\\sum_{n=1,c=1}^{N,C}-\\frac{\\widetilde{f}_n^{c^2}}{2}\\bar{\\omega}_n^c+(\\gamma_n^c+y_n^c)\\log\\cosh(\\frac{\\widetilde{f}_n^c}{2}). \n  \\end{aligned}\n  \\label{app.eq11}')
('9.5', '\\bm{\\Theta}')
('9.6', 'y_*')
('9.7.0', '\\rightarrow')
('9.7.1', '\\{+1, -1\\}')
('9.7.1', '\\tau = 1')
('9.7.1', '\\mathcal{N}(-5, 1)')
('9.7.1', '\\max _c p(y=c \\mid \\mathbf{f})')
('9.7.1', 'f_c \\sim \\mathcal{N}(-5,1)')
('9.7.1', 'C = 5')
('9.7.2', '10^{-3}')
('9.7.2', '10^{-4}')
('9.7.3', 'p = 1')
('9.7.3', 'p = 2')
('9.7.3', '(\\tau < 1)')
('9.7.3', '(\\tau < 1)')
('9.7.3', '\\tau')
