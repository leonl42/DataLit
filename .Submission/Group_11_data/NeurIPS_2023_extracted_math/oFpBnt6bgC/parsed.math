('3', '\\theta')
('3', 'p_\\theta(\\mathbf{x}^0)')
('3', '\\mathbf{x}^0')
('3', '\\mathbf{x}^0')
('3', '[\\beta_1, \\beta_2, \\ldots, \\beta_T]')
('3', '\\label{eq:ddpm_forward}\n    q(\\mathbf{x}^{1:T} | \\mathbf{x}^{0}) = \\prod_{t=1}^{T} q(\\mathbf{x}^{t} | \\mathbf{x}^{t-1}), \\qquad\n    q(\\mathbf{x}^{t} | \\mathbf{x}^{t-1}) = \n    \\mathcal{N}(\\mathbf{x}^{t}; \\sqrt{1 - \\beta_t} \\mathbf{x}^{t-1}, \\beta_t \\mathbf{I}).')
('3', '\\alpha_t = 1 - \\beta_t')
('3', '\\bar{\\alpha}_t = \\prod_{s=1}^{t} \\alpha_s')
('3', '\\bm{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('3', '\\mathbf{x}^{t} = \\sqrt{\\bar{\\alpha}_t} \\mathbf{x}^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}')
('3', '\\mathbf{x}^0')
('3', '\\mathbf{x}^1, \\ldots, \\mathbf{x}^T')
('3', '\\label{eq:ddpm_reverse}\n\\begin{aligned}\n    &p_\\theta(\\mathbf{x}^{0:T}) = p(\\mathbf{x}^{T}) \\prod_{t=1}^T p_\\theta(\\mathbf{x}^{t-1} | \\mathbf{x}^{t}),  \\quad\n    &p_\\theta(\\mathbf{x}^{t-1} | \\mathbf{x}^{t}) = \\mathcal{N}(\\mathbf{x}^{t-1}; \\bm{\\mu}_\\theta(\\mathbf{x}^{t}, t), \\mathbf{\\Sigma}_\\theta(\\mathbf{x}^{t}, t)),\n\\end{aligned}')
('3', '\\mathbf{x}^T \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('3', 'p_\\theta(\\mathbf{x}^0)')
('3', 'q(\\mathbf{x}^{0:T})')
('3', 'p_{\\theta}(\\mathbf{x}^{0:T})')
('3', '\\begin{aligned}\n    \\mathbb{E} \\left[ -\\log p_{\\theta} (\\mathbf{x}^0) \\right]\n    \\leq& D_{KL} \\left(q\\left(\\mathbf{x}_0, \\mathbf{x}_1, \\cdots, \\mathbf{x}_T\\right) \\| p_\\theta\\left(\\mathbf{x}_0, \\mathbf{x}_1, \\cdots, \\mathbf{x}_T\\right)\\right) \\label{eq:expectation_NNL}\\\\\n    =& \\mathbb{E}_{q\\left(\\mathbf{x}_0, \\mathbf{x}_1, \\cdots, \\mathbf{x}_T\\right)}\\left[-\\log p\\left(\\mathbf{x}_T\\right)-\\sum_{t=1}^T \\log \\frac{p_\\theta\\left(\\mathbf{x}_{t-1} \\mid \\mathbf{x}_t\\right)}{q\\left(\\mathbf{x}_t \\mid \\mathbf{x}_{t-1}\\right)}\\right]+ C_1 \\\\\n    =& \\sum_{t=1}^T \\underbrace{D_{KL} \\left( q(\\mathbf{x}^{t-1} | \\mathbf{x}^t, \\mathbf{x}^0)||p_\\theta(\\mathbf{x}^{t-1} | \\mathbf{x}^{t}) \\right)}_{:=L_{t-1}} +C_2 \\label{eq:loss0}\n\\end{aligned}')
('3', 'C_1')
('3', 'C_2')
('3', '\\theta')
('3', 'q(\\mathbf{x}^{t-1} | \\mathbf{x}^t, \\mathbf{x}^0)')
('3', '\\label{eq:forward1}\n    q(\\mathbf{x}^{t-1} | \\mathbf{x}^t, \\mathbf{x}^0) = \\mathcal{N}(\\mathbf{x}^{t-1}; \\tilde{\\bm{\\mu}}_t(\\mathbf{x}^t, \\mathbf{x}^0), \\tilde{\\beta}_t \\mathbf{I}),')
('3', '\\label{eq:ddpm_sampling}\n        \\tilde{\\bm{\\mu}}_t(\\mathbf{x}^t, \\mathbf{x}^0) =\\frac{\\sqrt{\\bar{\\alpha}_{t-1}}\\beta_t}{1 - \\bar{\\alpha}_t} \\mathbf{x}^0 + \\frac{\\sqrt{\\alpha_t}(1 - \\bar{\\alpha}_t)}{1 - \\bar{\\alpha}_t} \\mathbf{x}^t \\quad\n    \\text{and}  \\quad \\tilde{\\beta}_t = \\frac{1 - \\bar{\\alpha}_{t-1}}{1 - \\bar{\\alpha}_t} \\beta_t.')
('3', '\\bm{\\mu}_\\theta(\\mathbf{x}^{t},t)')
('3', '\\label{eq:rep1}\n    \\bm{\\mu}_\\theta(\\mathbf{x}^{t}, t) = \\frac{1}{\\sqrt{\\alpha_t}} \\left(\\mathbf{x}^{t} - \\frac{1-\\alpha_t}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon}_\\theta(\\mathbf{x}^{t}, t) \\right),')
('3', 't')
('3', '\\label{eq:loss1}\n    L_{t-1} = \\mathbb{E}_{\\mathbf{x}^0, \\bm{\\epsilon}}\\left[\\frac{\\beta_t^2}{2\\tilde{\\beta}_t \\alpha_t (1-\\bar{\\alpha}_t)} ||\\bm{\\epsilon}_0 - \\bm{\\epsilon}_\\theta(\\sqrt{\\bar{\\alpha}_t} \\mathbf{x}^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}, t)||^2\\right] + C.')
('3', '\\mathbf{\\Sigma}_\\theta(\\mathbf{x}^{t},t)')
('3', '\\tilde{\\beta}_t\\mathbf{I}')
('3', '\\bm{\\epsilon}_\\theta')
('4.0', '\\mathcal{I}')
('4.0', 'v_{1:n-1} = [v_1, v_2, \\ldots, v_{n-1}]')
('4.0', 'v_{n}')
('4.0', '\\mathcal{D} = \\{ [v_{1:n-1}, v_n]_m \\}_{m=1}^{|\\mathcal{D}|}')
('4.0', '\\mathcal{D}_t = \\{ [v_{1:n-1}]_m \\}_{m=1}^{|\\mathcal{D}_t|}')
('4.0', 'v \\in \\mathcal{I}')
('4.0', '\\mathbf{e}')
('4.0', '\\mathbf{e}_{1:n-1} = [\\mathbf{e}_1, \\mathbf{e}_2, \\ldots, \\mathbf{e}_{n-1}]')
('4.0', 'p_\\theta(\\mathbf{e}_n^0 | \\mathbf{e}_{1:n-1})')
('4.0', 'p_\\theta(\\mathbf{e}_n | \\mathbf{e}_{1:n-1})')
('4.0', '\\mathbf{e}_n^0')
('4.0', '\\mathbf{e}_{1:n-1}')
('4.0', 'p_\\theta(\\mathbf{e}_n^0 | \\mathbf{e}_{1:n-1})')
('4.0', 'p_\\theta( \\cdot | \\mathbf{e}_{1:n-1})')
('4.0', 'p_\\theta(\\mathbf{e}_n^0 | \\mathbf{e}_{1:n-1})')
('4.1.0', '\\mathbf{e}_{1:n-1} = [\\mathbf{e}_1, \\mathbf{e}_2, \\ldots, \\mathbf{e}_{n-1}]')
('4.1.0', '\\mathbf{c}_{n-1} = \\textbf{T-enc}(\\mathbf{e}_{1:n-1}).')
('4.1.0', '\\mathbf{c}_{n-1}')
('4.1.0', 'p_\\theta(\\mathbf{e}_{n}^{t-1} | \\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1}) = \\mathcal{N}(\\mathbf{e}_{n}^{t-1}; \\bm{\\mu}_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1},t), \\mathbf{\\Sigma}_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1},t)),')
('4.1.0', '\\bm{\\mu}_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1},t)')
('4.1.0', 'q(\\mathbf{e}_n^{t} | \\mathbf{e}_n^{t-1}) = \\mathcal{N}(\\mathbf{e}_n^{t}; \\sqrt{1 - \\beta_t} \\mathbf{e}_n^{t-1}, \\beta_t \\mathbf{I})')
('4.1.0', '[\\beta_1, \\beta_2, \\ldots, \\beta_T]')
('4.1.0', 'L_{t-1}')
('4.1.0', 'L_{t-1} = D_{KL} (q(\\mathbf{e}^{t-1}_n | \\mathbf{e}_n^t, \\mathbf{e}_{n-1}^0)||p_\\theta(\\mathbf{e}_n^{t-1} | \\mathbf{e}_n^{t},\\mathbf{c}_{n-1})).\n    \\label{eq:loss0_t}')
('4.1.0', '\\mathbf{e}_n^0')
('4.1.0', '\\bm{\\epsilon}')
('4.1.0', '\\mathbf{e}_n^0')
('4.1.0', '\\bm{\\epsilon}')
('4.1.0', '\\mathbf{e}_n^{t} = \\sqrt{\\bar{\\alpha}_t} \\mathbf{e}_n^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}')
('4.1.0', '\\label{eq:rep2}\n\\bm{\\mu}_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1}, t) = \\sqrt{\\bar{\\alpha}_{t-1}} f_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1}, t) + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{\\sqrt{1 - \\bar{\\alpha}_t}} {\\bm{\\epsilon}},')
('4.1.0', '\\label{eq:loss2}\n    L_{t-1} = \\mathbb{E}_{\\mathbf{e}_n^0, \\bm{\\epsilon}}\\left[\\frac{\\bar{\\alpha}_{t-1}}{2\\tilde{\\beta}_t} ||\\mathbf{e}_n^0 - f_\\theta(\\sqrt{\\bar{\\alpha}_t} \\mathbf{e}_n^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}, \\mathbf{c}_{n-1}, t)||^2\\right] + C.')
('4.1.0', '\\mathbf{c}_{n-1}')
('4.1.0', '\\Phi')
('4.1.0', 'p_u')
('4.1.0', '\\mathbf{e}_n^0')
('4.1.0', '\\bm{\\epsilon}')
('4.1.0', '\\mathbf{e}_n^0, \\mathbf{e}_{1:n-1} \\sim \\mathcal{D}')
('4.1.0', '\\mathbf{c}_{n-1} = \\text{T-enc}(\\mathbf{e}_{1:n-1})')
('4.1.0', 'p_u')
('4.1.0', '\\quad \\mathbf{c}_{n-1} = \\Phi')
('4.1.0', 't \\sim \\mathrm{Uniform}(\\{1, \\dotsc, T\\})')
('4.1.0', '{\\boldsymbol{\\epsilon}}\\sim\\mathcal{N}(\\mathbf{0},\\mathbf{I})')
('4.1.0', '\\mathbf{e}_n^t = \\sqrt{\\bar{\\alpha}_t} \\mathbf{e}_n^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}')
('4.1.0', '\\theta = \\theta - \\mu \\nabla_\\theta \\left\\| \\mathbf{e}_n^0 - f_\\theta(\\mathbf{e}_n^t, \\mathbf{c}_{n-1}, t) \\right\\|^2')
('4.1.0', '\\mathbf{e}_{1:n-1} \\sim \\mathcal{D}_t')
('4.1.0', '\\mathbf{e}_n^T \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('4.1.0', '\\mathbf{c}_{n-1} = \\text{T-enc}(\\mathbf{e}_{1:n-1})')
('4.1.0', '\\mathbf{z}\\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('4.1.0', 't > 1')
('4.1.0', '\\mathbf{z}= \\mathbf{0}')
('4.1.0', '\\tilde{f}_\\theta(\\mathbf{e}_n^t, \\mathbf{c}_{n-1}, t) =  (1 + w) \\ f_\\theta(\\mathbf{e}_n^t, \\mathbf{c}_{n-1}, t) - w \\ f_\\theta(\\mathbf{e}_n^t, \\Phi, t)')
('4.1.0', '\\mathbf{e}_n^{t-1} = \\frac{\\sqrt{\\bar{\\alpha}_{t-1} }\\beta_t}{1 - \\bar{\\alpha}_t}  \\tilde{f}_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1}, t)  + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1 - \\bar{\\alpha}_t}\\mathbf{e}_n^t  + \\sqrt{\\tilde{\\beta}_t} \\mathbf{z}')
('4.1.0', '\\mathbf{e}_n^0')
('4.1.1', '\\mathbf{c}_{n-1}')
('4.1.1', 'f_\\theta(\\mathbf{e}_n^t, \\mathbf{c}_{n-1}, t)')
('4.1.1', '\\label{eq:cfg}\n    \\tilde{f}_\\theta(\\mathbf{e}_n^t, \\mathbf{c}_{n-1}, t) = (1 + w) \\ f_\\theta(\\mathbf{e}_n^t, \\mathbf{c}_{n-1}, t) - w \\ f_\\theta(\\mathbf{e}_n^t, \\Phi, t),')
('4.1.1', 'w')
('4.1.1', '\\mathbf{c}_{n-1}')
('4.1.1', 'w')
('4.1.1', '\\label{eq:denoise_one_step}\n     \\mathbf{e}_n^{t-1} = \\frac{\\sqrt{\\bar{\\alpha}_{t-1} }\\beta_t}{1 - \\bar{\\alpha}_t}  \\tilde{f}_\\theta(\\mathbf{e}_{n}^{t}, \\mathbf{c}_{n-1}, t)  + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1 - \\bar{\\alpha}_t}\\mathbf{e}_n^t  + \\sqrt{\\tilde{\\beta}_t} \\mathbf{z}, \\quad \\mathbf{z} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I}).')
('4.1.1', '\\mathbf{c}_{n-1}')
('4.1.1', '\\mathbf{e}_n^0')
('4.1.1', '\\mathbf{e}_n^T \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{I})')
('4.1.1', 'T')
('5.0', '\\mathbf{YooChoose}')
('5.0', '\\mathbf{KuaiRec}')
('5.0', '\\mathbf{Zhihu}')
('5.0', 'p_u')
('5.0', 'T')
('5.0', 'w')
('5.3', 'w')
('5.3', 'w')
('5.3', 'w')
('5.3', 'w')
('5.3', 'w')
('9', 't')
('9', '\\label{app:loss0}\n    L_{t-1} = D_{KL}\\left( q(\\mathbf{x}^{t-1} | \\mathbf{x}^t, \\mathbf{x}^0)||p_\\theta(\\mathbf{x}^{t-1} | \\mathbf{x}^{t}) \\right).')
('9', 'q(\\mathbf{x}^{t-1} | \\mathbf{x}^t, \\mathbf{x}^0)')
('9', 'p_\\theta(\\mathbf{x}^{t-1} | \\mathbf{x}^{t})')
('9', '\\label{app:loss_close0}\n    L_{t-1} = \\mathbb{E}_q\\left[\\frac{1}{2\\tilde{\\beta_t}} ||\\tilde{\\bm{\\mu}}_t(\\mathbf{x}^t, \\mathbf{x}^0) - \\bm{\\mu}_\\theta(\\mathbf{x}^{t}, t)||^2\\right] + C ,')
('9', '\\tilde{\\bm{\\mu}}_t(\\mathbf{x}^t, \\mathbf{x}^0) = \\frac{\\sqrt{\\bar{\\alpha}_{t-1} }\\beta_t}{1 - \\bar{\\alpha}_t}  \\mathbf{x}^0 + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1 - \\bar{\\alpha}_t}\\mathbf{x}^t.')
('9', '\\mathbf{x}^{t} = \\sqrt{\\bar{\\alpha}_t} \\mathbf{x}^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}')
('9', '\\label{eq:mu_t}\n\\begin{aligned}\n\\tilde{\\bm{\\mu}}_t(\\mathbf{x}^t, \\mathbf{x}^0)\n&= \\frac{\\sqrt{\\bar{\\alpha}_{t-1} }\\beta_t}{1 - \\bar{\\alpha}_t}  {\\color{red}{\\mathbf{x}^0}} + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1 - \\bar{\\alpha}_t}\\mathbf{x}^t \\\\\n&= \\frac{\\sqrt{\\bar{\\alpha}_{t-1} }\\beta_t}{1 - \\bar{\\alpha}_t}  {\\color{red}{\\frac{\\mathbf{x}^t - \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}}{\\sqrt{\\bar{\\alpha}_t}}}} + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1 - \\bar{\\alpha}_t}\\mathbf{x}^t \\\\\n&= \\frac{1}{\\sqrt{\\alpha_t}} \\left(\\mathbf{x}_t-\\frac{1-\\alpha_t}{\\sqrt{1-\\bar{\\alpha}_t} } \\bm{\\epsilon}\\right).\n\\end{aligned}')
('9', '\\bm{\\mu}_\\theta')
('9', '\\label{app:rep1}\n    \\bm{\\mu}_\\theta(\\mathbf{x}^{t}, t) = \\frac{1}{\\sqrt{\\alpha_t}} \\left(\\mathbf{x}^{t} - \\frac{1-\\alpha_t}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon}_\\theta(\\mathbf{x}^{t}, t) \\right).')
('9', 'L_{t-1}')
('9', '\\label{app:loss1}\n    L_{t-1} = \\mathbb{E}_{\\mathbf{x}^0, \\bm{\\epsilon}}\\left[\\frac{\\beta_t^2}{2\\tilde{\\beta}_t \\alpha_t (1-\\bar{\\alpha}_t)} ||\\bm{\\epsilon} - \\bm{\\epsilon}_\\theta(\\sqrt{\\bar{\\alpha}_t} \\mathbf{x}^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}, t)||^2\\right] + C.')
('9', '\\bm{\\mu}_\\theta')
('9', '\\bm{\\mu}_\\theta(\\mathbf{x}^{t}, t) = \\sqrt{\\bar{\\alpha}_{t-1}} f_\\theta(\\mathbf{x}^{t}, t) + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon}.')
('9', '\\begin{aligned}\n    &\\qquad \\tilde{\\bm{\\mu}}_t(\\mathbf{x}^t, \\mathbf{x}^0) - \\bm{\\mu}_\\theta(\\mathbf{x}^{t}, t) \\\\\n    &= \\frac{1}{\\sqrt{\\alpha_t}} \\left({\\color{red}{\\mathbf{x}^t}}-\\frac{1-\\alpha_t}{\\sqrt{1-\\bar{\\alpha}_t} } \\bm{\\epsilon}\\right) - \\sqrt{\\bar{\\alpha}_{t-1}} f_\\theta(\\mathbf{x}^{t}, t) - \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon} \\\\\n    &= \\frac{1}{\\sqrt{\\alpha_t}} \\left({\\color{red}{\\sqrt{\\bar{\\alpha}_t} \\mathbf{x}^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}}}-\\frac{1-\\alpha_t}{\\sqrt{1-\\bar{\\alpha}_t} } \\bm{\\epsilon}\\right) - \\sqrt{\\bar{\\alpha}_{t-1}} f_\\theta(\\mathbf{x}^{t}, t) - \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon} \\\\\n    &= \\sqrt{\\bar{\\alpha}_{t-1}} \\mathbf{x}^0 + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon} - \\sqrt{\\bar{\\alpha}_{t-1}} f_\\theta(\\mathbf{x}^{t}, t) - \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{\\sqrt{1 - \\bar{\\alpha}_t}} \\bm{\\epsilon} \\\\\n    &= \\sqrt{\\bar{\\alpha}_{t-1}} (\\mathbf{x}^0 - f_\\theta(\\mathbf{x}^{t}, t)).\n\\end{aligned}')
('9', '\\label{app:loss2}\n    L_{t-1} = \\mathbb{E}_{\\mathbf{x}^0, \\bm{\\epsilon}}\\left[\\frac{\\bar{\\alpha}_{t-1}}{2\\tilde{\\beta}_t} ||\\mathbf{x}^0 - f_\\theta(\\sqrt{\\bar{\\alpha}_t} \\mathbf{x}^{0} + \\sqrt{1-\\bar{\\alpha}_t}\\bm{\\epsilon}, t)||^2\\right] + C')
