('1', '\\pi_{\\mathcal{D}}(a|s)')
('1', '\\pi_{\\theta}(a|s)')
('1', '\\theta')
('1', 'Q')
('1', '\\pi_{\\theta}(a|s)')
('1', '\\begin{aligned}\n    \\max_{\\pi_{\\theta}} \\, & J(\\pi_{\\theta}) - \\alpha \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[\\mathcal{C}(s,a)\\right], \n\\end{aligned}')
('1', 'J(\\pi_{\\theta})')
('1', '\\pi_{\\theta}')
('1', '\\mathcal{D}')
('1', '\\mathcal{C}')
('1', '\\pi_{\\theta}')
('1', '\\alpha')
('1', '\\mathcal{C}')
('1', '\\mathcal{C}(s, a) := \\lVert \n\\pi_{\\theta}(s) - a\\rVert^2_2')
('1', '\\pi_{\\theta}(s)')
('1', '\\pi_{\\theta}(.|s)')
('1', 'a')
('1', '\\pi_{\\theta}')
('1', '\\pi_\\theta')
('1', '\\pi_{\\theta}')
('1', '\\pi^*')
('1', '\\pi^*')
('1', '\\pi_{\\mathcal{D}_w}')
('1', 'w(s,a)')
('1', '\\mathcal{D}_{w}(s,a)')
('1', '\\begin{aligned}\n\\max_{\\pi_{\\theta}} & ~ J(\\pi_{\\theta}) - \\alpha \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[w(s,a)\\mathcal{C}(s,a)\\right],  \n\\end{aligned}')
('1', '\\pi_{\\theta}')
('1', '\\pi_{\\mathcal{D}}')
('1', 'w')
('1', '\\pi_{\\mathcal{D}_w}')
('1', 'D_w')
('1', '\\pi_{\\mathcal{D}_w}')
('1', '\\begin{aligned}\n    \\max_{w} J(\\pi_{\\mathcal{D}_w}) = \\mathbb{E}_{(s,a)\\sim\\textcolor{red}{\\mathcal{D}_w}}\\left[r(s,a)\\right] \\approx \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[\\textcolor{red}{w(s,a)}r(s,a)\\right].\n\\end{aligned}')
('1', 'r(s,a)')
('1', '(s,a)')
('1', 'w')
('1', 'J(\\pi_{\\mathcal{D}_w})')
('1', '\\pi_{\\mathcal{D}_w}')
('1', 'w')
('1', '\\pi_\\theta')
('1', '\\pi_\\theta')
('1', 'J(\\pi_\\theta)')
('1', '\\pi_\\theta')
('1', '72')
('1', '20 \\times')
('2', 's_0')
('2', '\\rho_0(.)')
('2', 't')
('2', 's_t')
('2', 'a_t \\sim \\pi(.|s_t)')
('2', '\\pi')
('2', 'r_t = r(s_t, a_t)')
('2', 's_{t+1}')
('2', '\\mathcal{T}(.|s_t,a_t)')
('2', '\\pi')
('2', '\\gamma')
('2', 'J^\\gamma(\\pi) = \\mathbb{E}_{s_0\\sim\\rho_0, a_t\\sim\\pi(.|s_t), s_{t+1} \\sim \\mathcal{T}(.|s_t,a_t)}\\Big[\\sum^{\\infty}_{t=0} \\gamma^{t} r(s_t, a_t) \\Big]')
('2', '\\pi')
('2', '\\tau = (s_0, a_0, r_0, s_1, a_1, r_1 \\cdots )')
('2', '\\pi')
('2', '\\pi')
('2', 'J^\\gamma(\\pi)')
('2', '\\pi')
('2', '\\mathcal{D}')
('2', '\\pi_{\\mathcal{D}}')
('2', '\\pi')
('2', '(s_t, a_t)')
('2', '\\mathcal{D}')
('2', '\\widehat{J}^\\gamma_{{\\mathcal{D}}}(\\pi)')
('2', '\\mathcal{D}')
('2', 'N')
('2', '\\pi_{\\mathcal{D}}')
('2', '\\begin{aligned}\n\\label{eq:dataset}\n    \\mathcal{D} := \\{\\tau_i = (s_0, a_0, r_0, s_1, a_1, r_1 \\cdots s_{T_i})_i \\}^{N}_{i=1},\n\\end{aligned}')
('2', 'T_i')
('2', '\\tau_i')
('2', '\\pi')
('2', '\\pi')
('2', '\\mathcal{D}')
('2', '\\widehat{J}^\\gamma_{{\\mathcal{D}}}(\\pi)')
('2', '\\pi')
('2', '\\pi')
('2', '\\pi_{\\mathcal{D}}')
('2', '\\pi')
('2', '\\begin{aligned}\n\\label{eq:generic_offline_rl}\n    \\max_\\pi \\widehat{J}^\\gamma_{{\\mathcal{D}}}(\\pi) - \\alpha \\mathbb{E}_{(s_t,a_t)\\sim \\mathcal{D}} \\left[ \\mathcal{C}(s_t, a_t) \\right],\n\\end{aligned}')
('2', '\\mathcal{C}')
('2', '\\pi')
('2', '\\pi_{\\mathcal{D}}')
('2', '\\alpha \\in \\mathbb{R}^+')
('3', '(s,a)')
('3', '\\mathcal{D}')
('3', '\\mathbb{V}_{+}[G(\\tau_i)]')
('3', 'G(\\tau_i) := \\sum^{T_i - 1}_{t=0} \\gamma^t r(s^i_t, a^i_t)')
('3', '\\tau_i')
('3', '\\begin{aligned}\n    \\mathbb{V}_{+}[G(\\tau_i)]&\\doteq \\mathbb{E}_{\\tau_i \\sim \\mathcal{D}}\\left[\\left(G(\\tau_i)-\\mathbb{E}_{\\tau_i \\sim \\mathcal{D}}[G(\\tau_i)]\\right)^2_{+}\\right] \\quad\\text{with}\\quad x_{+}=\\max\\{x,0\\}, \\label{eq:rpsv}\n\\end{aligned}')
('3', '(s,a)')
('3', '\\mathcal{D}')
('3', '\\alpha')
('4', '(s,a)')
('4', '\\mathcal{D}_w')
('4', '\\begin{aligned}\n\\label{eq:density_ratio_weight}\n    w(s,a) = \\dfrac{\\mathcal{D}_w(s,a)}{\\mathcal{D}(s,a)},\n\\end{aligned}')
('4', '\\mathcal{D}_w(s,a)')
('4', '\\mathcal{D}(s,a)')
('4', '(s, a)')
('4', '\\mathcal{D}_w')
('4', '\\mathcal{D}')
('4', '\\mathcal{D}_w')
('4', 'w')
('4', '\\pi')
('4', '\\begin{aligned}\n\\label{eq:equivalence}\n    \\max_\\pi \\widehat{J}^\\gamma_{{\\mathcal{D}}}(\\pi) - \\alpha \\textcolor{red}{\\mathbb{E}_{(s_t,a_t)\\sim \\mathcal{D}} \\left[ w(s,a) \\mathcal{C}(s_t, a_t) \\right]} \\Longleftrightarrow  \\max_\\pi \\widehat{J}^\\gamma_{{\\mathcal{D}}}(\\pi) - \\alpha \\textcolor{red}{\\mathbb{E}_{(s_t,a_t)\\sim \\mathcal{D}_w} \\left[ \\mathcal{C}(s_t, a_t) \\right]}.\n\\end{aligned}')
('4', 'w(s,a)')
('4', '\\mathcal{D}_w')
('4', '\\pi_{\\mathcal{D}}')
('4', '\\mathcal{D}')
('4.0', 'w')
('4.0', '\\mathcal{D}_w')
('4.0', '\\pi_{\\mathcal{D}_w}')
('4.0', '\\pi_{\\mathcal{D}}')
('4.0', '\\mathcal{D}')
('4.0', 'J^\\gamma(\\pi_{\\mathcal{D}_w}) \\geq J^\\gamma(\\pi_{\\mathcal{D}})')
('4.0', 'w')
('4.0', 'J(\\pi_{\\mathcal{D}_w})')
('4.0', '\\begin{aligned}\n\\label{eq:J_Dw}\n    J^\\gamma(\\pi_{\\mathcal{D}_w}) %\n    \\approx \\mathbb{E}_{(s, a)\\sim\\textcolor{red}{\\mathcal{D}_w}}\\left[ r(s,a)  \\right] = \\mathbb{E}_{(s, a)\\sim\\mathcal{D}}\\left[ \\textcolor{red}{w(s,a)} r(s,a) \\right].\n\\end{aligned}')
('4.0', 'J^\\gamma(\\pi_{\\mathcal{D}_w})')
('4.0', 'w')
('4.0', 'w')
('4.0', '\\mathcal{D}')
('4.0', '\\gamma')
('4.0', '\\mathcal{D}_w')
('4.0', '\\begin{aligned}\n\\label{eq:bellman_flow}\n    \\mathcal{D}_w(s^\\prime) &= (1- \\gamma) \\rho_0(s^\\prime) + \\gamma \\sum_{s,a} \\mathcal{T}(s^\\prime|s,a) \\mathcal{D}_w(s, a) ~\\forall s^\\prime \\in \\mathcal{S}, &\n    \\mathcal{D}_w(s^\\prime) := \\sum_{a^\\prime \\in \\mathcal{A}}  \\mathcal{D}_w(s^\\prime, a^\\prime) \n\\end{aligned}')
('4.0', '\\mathcal{S}')
('4.0', '\\mathcal{A}')
('4.0', '\\gamma')
('4.0', 'J^\\gamma(\\pi_{\\mathcal{D}_w})')
('4.0', '\\mathcal{D}_w(s^\\prime)')
('4.0', 'J^\\gamma(\\pi_{\\mathcal{D}_w})')
('4.0', 'w')
('4.0', 'w')
('4.0', '\\rho_0')
('4.0', '\\rho_0')
('4.0', '\\rho_0')
('4.0', '\\rho_0')
('4.0', '\\rho_0')
('4.0', '\\gamma \\neq 1')
('4.0', 'J(\\pi_{\\mathcal{D}_w}) = J^{\\gamma=1}(\\pi_{\\mathcal{D}_w})')
('4.0', '\\gamma=1')
('4.0', '\\pi_{\\mathcal{D}_w}')
('4.0', 'w')
('4.0', '\\gamma=1')
('4.0', '\\begin{aligned}\n\\label{eq:bellman_flow_undiscount}\n    \\mathcal{D}_w(s^\\prime) = \\sum_{s,a} \\mathcal{T}(s^\\prime|s,a) \\mathcal{D}_w(s, a) ~\\forall s^\\prime \\in \\mathcal{S}.\n\\end{aligned}')
('4.0', 'w')
('4.0', '\\begin{aligned}\n\\label{eq:bellman_flow_undiscount_w}\n    w(s^\\prime) &= \\sum_{s,a} \\mathcal{T}(s^\\prime|s,a) w(s, a) ~\\forall s^\\prime \\in \\mathcal{S}, &\n    w(s) := \\sum_{a\\in\\mathcal{A}} \\dfrac{\\mathcal{D}_w(s, a)}{\\mathcal{D}(s,a)}\n\\end{aligned}')
('4.0', 'w(s)')
('4.0', 'w')
('4.0', '\\pi_{\\mathcal{D}_w}')
('4.0', '\\begin{aligned}\n\\label{eq:theoretical_w_opt}\n    \\max_w ~& J(\\pi_{\\mathcal{D}_w})  = \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[w(s,a)r(s,a)\\right] \\\\\n    \\text{subject to}~ & ~ w(s^\\prime) = \\sum_{s,a} \\mathcal{T}(s^\\prime|s,a) w(s, a) ~\\forall s^\\prime \\in \\mathcal{S} \\nonumber.\n\\end{aligned}')
('4.0', 'w')
('4.0', '(s,a)')
('4.1', 'w(s,a)')
('4.1', 'w(s^\\prime)')
('4.1', 'w(s^\\prime)')
('4.1', 'w(s,a)')
('4.1', '\\mathcal{A}')
('4.1', 'w(s,a)')
('4.1', 'w(s^\\prime)')
('4.1', '\\mathcal{D}_w(s, a) = \\mathcal{D}_w(s)\\pi_{\\mathcal{D}_w}(a|s)')
('4.1', '\\mathcal{D}(s, a) = \\mathcal{D}(s)\\pi_{\\mathcal{D}}(a|s)')
('4.1', 'w(s,a)')
('4.1', '\\begin{aligned}\n    w(s,a) \\doteq \\dfrac{\\mathcal{D}_w(s,a)}{\\mathcal{D}(s,a)} = \\dfrac{\\mathcal{D}_w(s)\\pi_{\\mathcal{D}_w}(a|s)}{\\mathcal{D}(s)\\pi_{\\mathcal{D}}(a|s)} = \\dfrac{\\mathcal{D}_w(s)}{\\mathcal{D}(s)} \\times \\dfrac{\\pi_{\\mathcal{D}_w}(a|s)}{\\pi_{\\mathcal{D}}(a|s)}.\n\\end{aligned}')
('4.1', 'w(s,a)')
('4.1', 'w_{\\phi, \\psi}(s,a)')
('4.1', 'w_\\phi(s)')
('4.1', '\\begin{aligned}\n    w_{\\phi,\\psi}(s, a) &= \\exp \\phi(s) \\exp \\psi(s, a), & w_{\\phi}(s) = \\exp \\phi(s)\n\\end{aligned}')
('4.1', '\\phi')
('4.1', '\\psi')
('4.1', 'D_{KL}(\\mathcal{D}_{w} || \\mathcal{D})')
('4.1', '\\mathcal{D}_{w}')
('4.1', 'w')
('4.1', '\\mathcal{D}')
('4.1', 'w_{\\phi,\\psi}(s,a)')
('4.1', '\\mathcal{D}')
('4.1', 'w')
('4.1', 'w_{\\phi,\\psi}')
('4.1', 'w_{\\phi,\\psi}')
('4.1', '\\begin{aligned}\n\\label{eq:practical_w_opt}\n    \\max_{\\phi, \\psi} ~& \\mathbb{E}_{(s,a,s^\\prime)\\sim \\mathcal{D}}\\left[\\underbrace{w_{\\phi,\\psi}(s,a)r(s,a)}_{\\text{Return}} - \\lambda_F \\underbrace{(w_{\\phi}(s^\\prime) - w_{\\phi,\\psi}(s, a))^2}_{\\text{Bellman flow conservation penalty}} \\right] - \\lambda_K \\underbrace{D_{KL}(\\mathcal{D}_{w} || \\mathcal{D})}_{\\text{KL regularization}},\n\\end{aligned}')
('4.1', 's^\\prime')
('4.1', 'a')
('4.1', 's')
('4.1', '\\lambda_F, \\lambda_K \\in \\mathbb{R}^+')
('4.1', 'w_{\\phi,\\psi}')
('4.1', 'w_{\\phi, \\psi}')
('4.1', '\\widehat{J}^\\gamma_{\\mathcal{D}}(\\pi)')
('4.1', '\\mathcal{C}(s,a)')
('4.1', '\\mathcal{D}')
('4.1', 'w_{\\phi,\\psi}(s,a)')
('4.1', '\\mathcal{C}(s,a)')
('4.1', 'J_{\\mathcal{D}_w}(\\pi)')
('4.1', '\\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[w_{\\phi,\\psi}(s,a)A(s,a) \\log\\pi(a|s)\\right]')
('4.1', 'A(s,a)')
('4.1', '\\widehat{J}^\\gamma_{\\mathcal{D}}(\\pi)')
('4.1', '\\mathcal{C}(s,a)')
('4.1', '\\pi')
('4.1', '\\widehat{J}^\\gamma_{\\mathcal{D}}(\\pi)')
('4.1', 'w_{\\psi,\\phi}(s,a)')
('4.1', '\\mathcal{D}')
('4.1', '\\pi')
('4.1', 'w_{\\phi,\\psi}')
('4.1', '\\mathcal{B}')
('4.1', '(s, a, r, s^\\prime)')
('4.1', '\\mathcal{D}')
('4.1', 'w_{\\phi,\\psi}')
('4.1', '\\mathcal{B}')
('4.1', '\\pi')
('4.1', 'w_{\\phi,\\psi}(s,a)')
('4.1', '\\mathcal{B}')
('5', '1-\\sigma\\%')
('5', '\\sigma\\%')
('5', '1-\\sigma\\%')
('5', '\\sigma\\%')
('5', '\\sigma\\%')
('5', '\\sigma \\in \\{1, 5, 10, 50\\}')
('5', '50,000')
('5', '20')
('5.0', '\\begin{aligned}\n\\label{eq:prev_traj_p}\n    \\mathcal{P}_{\\text{AW}}(s^i_t, a^i_t) &\\propto \\exp ((G(\\tau_i) - V_0(s^i_0)) / \\eta ) & \\text{(Advantage-weighting)} \\\\\n    \\mathcal{P}_{\\text{PF}}(s^i_t, a^i_t) &\\propto \\mathbb{1}\\left[ G(\\tau_i) \\geq G_{K\\text{\\%}} \\right] & \\text{(Percentage-filtering)},\n\\end{aligned}')
('5.0', '(s^i_t, a^i_t)')
('5.0', 't')
('5.0', '\\tau_i')
('5.0', 'G_{K\\%}')
('5.0', 'K\\%')
('5.0', 'K')
('5.0', '\\{10, 20, 50\\}')
('5.0', 'V(s^i_0)')
('5.0', 's^i_0')
('5.0', '\\tau_i')
('5.0', '\\eta')
('5.0', '\\eta')
('5.0', '20')
('5.0', '1000')
('5.0', '20')
('5.0', '10')
('5.0', '10')
('5.0', '95')
('5.0', '25')
('5.1', '8')
('5.1', '\\eta')
('7', '72')
('10.0', '\\pi')
('10.0', '\\mathcal{D}')
('10.0', '\\pi^H_{\\mathcal{D}}')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', '\\pi^H_{\\mathcal{D}}')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', 'J(\\pi^H_{\\mathcal{D}}) \\geq J(\\pi^L_{\\mathcal{D}})')
('10.0', '(s_t,a_t)')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', '\\pi^H_{\\mathcal{D}}')
('10.0', '(s_t,a_t)')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', '(s_t,a_t)')
('10.0', 'J(\\pi)')
('10.0', 'J(\\pi_{\\mathcal{D}})')
('10.0', '\\pi^H_{\\mathcal{D}}')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', 'J(\\pi_{\\mathcal{D}})')
('10.0', '\\mathcal{D}')
('10.0', '\\begin{aligned}\n\\label{eq:traj_piD}\n    J(\\pi_{\\mathcal{D}}) \\approx \\mathbb{E}_{\\tau_i \\sim \\mathcal{D}}\\left[ G(\\tau_i) \\right] = \\sum^{N}_{i=1} \\mathcal{D}(\\tau_i) G(\\tau_i) , \n\\end{aligned}')
('10.0', '\\mathcal{D}(\\tau_i)')
('10.0', '\\tau_i')
('10.0', '\\mathcal{D}')
('10.0', 'G(\\tau_i) := \\sum^{T_i - 1}_{t=0} r(s^i_t, a^i_t)')
('10.0', '\\tau_i')
('10.0', 'T_i')
('10.0', '\\pi^L_{\\mathcal{D}}')
('10.0', 'J(\\pi_{\\mathcal{D}})')
('10.0', 'J(\\pi)')
('10.0', 'J(\\pi_{\\mathcal{D}})')
('10.0', '\\pi')
('10.0', '\\pi_{\\mathcal{D}}')
('10.0', 'J(\\pi) \\geq J(\\pi_{\\mathcal{D}})')
('10.0', '\\pi')
('10.0', '\\pi_{\\mathcal{D}}')
('10.0', '\\pi')
('10.0', '\\pi')
('10.0', '\\pi_{\\mathcal{D}}')
('10.0', 'J(\\pi) - J(\\pi_{\\mathcal{D}}) \\leq C \\mathbb{E}_{(s, a)\\sim\\mathcal{D}}\\left[\\mathcal{C}(s, a)\\right]')
('10.0', 'C')
('10.0', '\\mathcal{C}')
('10.0', '\\pi')
('10.0', '\\pi_{\\mathcal{D}}')
('10.0.0', '\\mathcal{D}_{w}')
('10.0.0', '\\pi_{\\mathcal{D}_w}')
('10.0.0', 'J(\\pi_{\\mathcal{D}_w})')
('10.0.0', '\\pi_{\\mathcal{D}_w}')
('10.0.0', '\\pi_{\\mathcal{D}_w}')
('10.0.0', '\\pi_{\\mathcal{D}}')
('10.0.0', 'J(\\pi_{\\mathcal{D}_w}) \\geq J(\\pi_{\\mathcal{D}})')
('10.0.0', '\\mathcal{D}_w')
('10.0.0', 'w')
('10.0.0', 'J(\\pi_{\\mathcal{D}_w}) \\geq J(\\pi_{\\mathcal{D}})')
('10.1', 'D_{KL}(\\mathcal{D} || \\mathcal{D}_{w})')
('10.1', '\\mathcal{D}_{w}')
('10.1', '\\mathcal{D}')
('10.1', '\\epsilon')
('10.1', '\\epsilon')
('10.1', '2\\epsilon')
('10.1', '\\alpha')
('10.1', '\\alpha')
('10.1', '\\alpha')
('10.2.0.0', '\\begin{aligned}\n\\label{app:eq:cql}\n    \\max_{\\pi} & ~\\mathbb{E}_{s \\sim \\mathcal{D}, a \\sim \\pi(.|s)}\\left[\\textcolor{red}{w_{\\phi}(s)}\\left( Q(s, a) - \\log \\pi(a|s)\\right) \\right]  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\\text{(Actor)} \\\\\n    \\min_{Q} & ~\\alpha \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[\\textcolor{red}{w_{\\phi,\\psi}(s,a)}\\left(\\log \\sum_{a^\\prime\\in\\mathcal{A}} \\exp Q(s,a^\\prime) - Q(s,a) \\right)\\right] +  ~~~~~~~~~~~~~~~~~~\\text{(Critic)} \\\\ & \\mathbb{E}_{(s,a,s^\\prime)\\sim\\mathcal{D}, a^\\prime \\sim \\pi(.|s^\\prime)}\\left[\\textcolor{red}{w_{\\phi,\\psi}(s,a)}\\left(r(s,a) + \\gamma Q(s^\\prime, a^\\prime) - Q(s,a)\\right)^2\\right] \\nonumber \\\\\n    \\min_{\\alpha} &~ \\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim\\pi(.|s)}\\left[\\textcolor{red}{w_{\\phi}(s)}\\left(-\\log \\pi(a|s)  -\\bar{\\mathcal{H}}\\right)\\right]  ~~~~~~~~~~~~~~~~~~~~~\\text{(Entropy coefficient ~\\citep{haarnoja2018soft2})},\n\\end{aligned}')
('10.2.0.0', '\\bar{\\mathcal{H}}')
('10.2.0.0', 'w_\\phi')
('10.2.0.0', 'w_{\\phi,\\psi}')
('10.2.0.1', 'V')
('10.2.0.1', 'Q')
('10.2.0.1', '\\pi')
('10.2.0.1', '\\begin{aligned}\n    \\min_{V} & ~\\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[\\textcolor{red}{w_{\\phi}(s)}L^\\tau_2(Q(s,a) - V(s)) \\right] \\\\\n    \\min_Q &~ \\mathbb{E}_{(s,a,s^\\prime) \\sim \\mathcal{D}}\\left[\\textcolor{red}{w_{\\phi,\\psi}(s,a)}\\left(r(s,a) + \\gamma V(s^\\prime) - V(s)\\right)^2\\right] \\\\\n    \\max_\\pi &~ \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[\\textcolor{red}{w_{\\phi,\\psi}(s,a)}\\exp\\left(\\beta \\left(Q(s,a) - V(s)\\right)\\right) \\log \\pi(a|s)\\right],\n \n\\end{aligned}')
('10.2.0.1', 'L^\\tau_2')
('10.2.0.1', '\\beta')
('10.2.1', 'w_{\\phi,\\psi}')
('10.2.1', 'w_{\\phi}')
('10.2.1', '\\begin{aligned}\n    \\max_{\\phi, \\psi} ~& \\mathbb{E}_{(s,a,s^\\prime)\\sim \\mathcal{D}}\\left[\\underbrace{w_{\\phi,\\psi}(s,a)r(s,a)}_{\\text{Return}} - \\lambda_F \\underbrace{(w_{\\phi}(s^\\prime) - w_{\\phi,\\psi}(s, a))^2}_{\\text{Bellman flow conservation penalty}} \\right] - \\lambda_K \\underbrace{D_{KL}(\\mathcal{D}_{w} || \\mathcal{D})}_{\\text{KL regularization}}.\n\\end{aligned}')
('10.2.1', '\\begin{aligned}\n    D_{KL}(\\mathcal{D}_{w} || \\mathcal{D}) &= \\sum_{s,a} \\mathcal{D}_{w}(s,a)\\log \\dfrac{\\mathcal{D}_{w}(s,a)}{\\mathcal{D}(s,a)}\\\\\n    &= \\sum_{s,a} \\mathcal{D}(s,a) \\dfrac{\\mathcal{D}_{w}(s,a)}{\\mathcal{D}(s,a)} \\log \\dfrac{\\mathcal{D}_{w}(s,a)}{\\mathcal{D}(s,a)}\\nonumber \\\\\n    &= \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[\\dfrac{\\mathcal{D}_{w}(s,a)}{\\mathcal{D}(s,a)} \\log \\dfrac{\\mathcal{D}_{w}(s,a)}{\\mathcal{D}(s,a)} \\right]\\nonumber \\\\\n    &= \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[w(s,a)\\log w(s,a) \\right] \\nonumber.\n\\end{aligned}')
('10.2.1', '\\begin{aligned}\n\\label{eq:theoretical_w_opt_expand}\n    \\max_{\\phi, \\psi} ~& \\mathbb{E}_{(s,a,s^\\prime)\\sim \\mathcal{D}}\\left[\\underbrace{w_{\\phi,\\psi}(s,a)r(s,a)}_{\\text{Return}} - \\lambda_F \\underbrace{(w_{\\phi}(s^\\prime) - w_{\\phi,\\psi}(s, a))^2}_{\\text{Bellman flow conservation penalty}} -\\underbrace{\\lambda_K w_{\\phi,\\psi}(s,a)\\log w_{\\phi,\\psi}(s,a)}_{\\text{KL regularization}} \\right].\n\\end{aligned}')
('10.2.1', 'L(\\phi,\\psi)')
('10.2.1', '\\begin{aligned}\n\\label{app:eq:practical_w_obj}\n    L(\\phi, \\psi) &:= L_R(\\phi, \\psi) + \\lambda_F L_F(\\phi, \\psi) + \\lambda_K L_K(\\phi, \\psi) \\\\\n    L_R(\\phi, \\psi) &:= -\\sum^{B}_{i=1} \\bar{w}_{\\phi,\\psi}(s_i,a_i)r(s_i, a_i) \\\\\n    L_F(\\phi, \\psi) &:= \\dfrac{1}{B}\\sum^{B}_{i=1} \\left(w_{\\phi,\\psi}(s^\\prime_i) -  w_{\\phi,\\psi}(s_i, a_i)\\right)^2.\\\\\n    L_K(\\phi, \\psi) &:= \\sum^B_{i=1} \\bar{w}_{\\phi,\\psi}(s,a) \\log \\bar{w}_{\\phi,\\psi}(s,a),\n\\end{aligned}')
('10.2.1', 'B')
('10.2.1', '(s_i, a_i)')
('10.2.1', 'i^{\\text{th}}')
('10.2.1', '\\bar{w}_{\\phi,\\psi}(s_i,a_i)')
('10.2.1', '\\begin{aligned}\n    \\bar{w}_{\\phi,\\psi}(s_i,a_i) := \\dfrac{{w}_{\\phi,\\psi}(s_i,a_i)}{\\sum^B_{j=1}   {w}_{\\phi,\\psi}(s_j,a_j)},\n\\end{aligned}')
('10.2.1', '{w}_{\\phi,\\psi}(s_i,a_i)')
('10.2.1', '\\phi')
('10.2.1', '\\psi')
('10.2.1', '\\mathbb{E}\\left[w\\right] = 1')
('10.3.0', '{\\phi, \\psi}')
('10.3.0', '\\phi')
('10.3.0', '\\psi')
('10.3.0', '\\phi')
('10.3.0', '\\psi')
('10.3.0', '\\eta')
('10.3.0', '0.01')
('10.3.0', '0.1')
('10.3.0', '1.0')
('10.3.0', '5.0')
('10.3.0', '\\eta')
('10.3.0', '0.01')
('10.3.0', '0.2')
('10.3.0', '1.0')
('10.3.0', '5.0')
('10.3.0', 'K')
('10.3.0', '0.1')
('10.3.0', '0.2')
('10.3.0', '0.5')
('10.3.0', '\\eta')
('10.3.0', '\\lambda_K \\in \\{0.2, 1.0\\}')
('10.3.0', '\\lambda_F \\in \\{0.1, 1.0, 5.0\\}')
('10.3.0', '(\\lambda_K, \\lambda_F) = (0.2, 0.1)')
('10.3.0', '(\\lambda_K, \\lambda_F) = (1.0, 1.0)')
('10.3.1', '20')
('10.3.1', '1000')
('10.3.1', '10')
('10.3.2.0', '1-\\sigma\\%')
('10.3.2.0', '\\sigma\\%')
('10.3.2.0', '1-\\sigma\\%')
('10.3.2.0', '\\sigma\\%')
('10.3.2.0', '\\sigma\\%')
('10.3.2.0', '\\sigma \\in \\{1, 5, 10, 50\\}')
('10.3.2.0', '32')
('10.3.2.0', '\\times')
('10.3.2.0', '\\times')
('10.3.2.0', '\\sigma \\in \\{1, 5, 10, 50\\}')
('10.3.2.0', '50,000')
('10.3.2.0', '20')
('10.3.2.0', '\\sigma = 1')
('10.3.2.0', '\\sigma = 5')
('10.3.2.0', '\\sigma=10')
('10.3.2.0', '\\sigma=50')
('10.3.2.0', '\\sigma=50')
('10.3.2.0', '\\sigma = 50')
('10.3.2.1', '1-\\sigma\\%')
('10.3.2.1', '\\sigma\\%')
('10.3.2.1', '\\tau_i')
('10.3.2.1', '10')
('10.3.2.1', '50')
('10.3.2.1', '\\tau_i')
('10.3.2.1', '10')
('10.3.2.1', '50')
('10.3.2.1', '10')
('10.3.2.1', '50')
('10.3.2.1', '0')
('10.3.2.1', '1')
('10.3.2.1', '(G(\\tau_i) - G_\\text{min}) / (G_\\text{max} - G_\\text{min})')
('10.3.2.1', 'G_\\text{min}')
('10.3.2.1', 'G_\\text{max}')
('10.4', '113')
('10.4.0', 'J')
('10.4.1', "\\begin{aligned}\n\\label{app:tab:optdice}\n    & {\\min_\\nu \\max_{w\\ge0} }   ~\n    \\mathbb{E}_{(s,a) \\sim \\mathcal{D}}\\big[ e_\\nu(s,a) \\textcolor{black}{w(s,a)} - \\alpha f\\big(\\textcolor{black}{w(s,a)}\\big) \\big] + (1 - \\gamma) \\mathbb{E}_{s_0 \\sim p_0}[ \\nu(s_0) ] \\approx \\\\\n  & \\min_{\\nu} ~ \\mathbb{E}_{(s,a,s') \\sim \\mathcal{D}}\\big[ \\hat e_\\nu(s,a,s') \\textcolor{black}{ (f')^{-1} \\big( \\tfrac{1}{\\alpha} \\hat e_\\nu(s,a,s') \\big)_{+}} -\\alpha f \\big( \\textcolor{black}{ (f')^{-1} ( \\tfrac{1}{\\alpha} \\hat e_\\nu(s,a,s') )_{+}} \\big) \\big]\n    + \\\\\n &~~~~~~~~~~~~~~~~~~~~~~~~(1 - \\gamma) \\mathbb{E}_{s_0 \\sim p_0}[ \\nu(s_0) ] \\nonumber,\n\\end{aligned}")
('10.4.1', 'f')
('10.4.1', 'f(x) := x\\log x')
('10.4.1', "\\hat e_\\nu(s,a,s') := r(s,a) + \\gamma \\nu(s') - \\nu(s)")
('10.4.1', 'x_+ := \\max(0, x)')
('10.4.1', '\\alpha')
('10.4.1', '\\alpha')
('10.4.1', 'w(s,a)')
('10.4.1', '\\nu')
('10.4.1', '\\begin{aligned}\n\\label{app:eq:optdice_w}\n    w(s,a) = \\max \\left(0, (f)^{-1}\\left(\\dfrac{\\hat{e}_\\nu(s,a,s^\\prime)}{\\alpha} \\right)\\right).\n\\end{aligned}')
('10.4.1', '\\begin{aligned}\n    \\max_{\\pi} \\mathbb{E}_{(s,a)\\sim\\mathcal{D}_w}\\left[\\log \\pi(a|s)\\right] = \\max_{\\pi} \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[w(s,a) \\log \\pi(a|s)\\right].\n\\end{aligned}')
('10.4.2', '\\alpha')
('10.4.2', '\\alpha')
('10.4.2', '0.1')
('10.4.2', '5.0')
('10.4.2', '\\text{score}_{\\text{OptDiCE}} -\\text{score}_{\\text{Ours}}')
('10.4.2', '\\alpha')
('10.4.2', '\\alpha=0.1')
('10.4.2', '\\alpha=1.0')
('10.4.2', '\\alpha=5.0')
('10.4.3', '\\lambda_K')
('10.4.3', '\\lambda_F')
('10.4.3', '\\lambda_K')
('10.4.3', '\\lambda_F')
('10.4.3', '\\lambda_F')
('10.4.3', '\\lambda_F')
('10.4.3', '(\\lambda_K, \\lambda_F)')
('10.4.3', '(0.2,0.1)')
('10.4.3', '(0.2,1.0)')
('10.4.3', '(0.2,5.0)')
('10.4.3', '(1.0,0.1)')
('10.4.3', '(1.0,1.0)')
('10.4.3', '(1.0,5.0)')
('10.4.3', '\\lambda_K')
('10.4.3', '\\lambda_F')
('10.4.3', '\\lambda_F')
('10.4.3', '\\lambda_F')
('10.4.3', '(\\lambda_K, \\lambda_F)')
('10.4.3', '(0.2,0.1)')
('10.4.3', '(0.2,1.0)')
('10.4.3', '(0.2,5.0)')
('10.4.3', '(1.0,0.1)')
('10.4.3', '(1.0,1.0)')
('10.4.3', '(1.0,5.0)')
('10.4.4', '\\mathbb{E}_{(s,a)\\sim\\mathcal{D}}\\left[C(s,a)\\right]')
('10.4.4', 'w_{\\phi,\\psi}(s,a)')
('10.4.4', '\\alpha')
('10.4.4', 'w_{\\phi}(s)')
('10.4.4', '\\pi')
