('2', 'i')
('2', '{\\bm{p}}_i')
('2', '{\\bm{p}}_i')
('2', 'i')
('2', '(i-j)')
('2', 'i')
('2', 'j')
('2', 'b = f(i-j)')
('2', 'f')
('2', 'b')
('3.0', '\\mathcal{D} = \\{({\\bm{x}}_i, {\\bm{y}}_i)\\}')
('3.0', '{\\bm{x}}_i')
('3.0', '{\\bm{y}}_i')
('3.0', '\\lambda: \\mathcal{D} \\rightarrow \\mathbb{N}')
('3.0', 'd \\in \\mathcal{D}')
('3.0', 'L')
('3.0', '\\lambda \\le L')
('3.0', '\\lambda > L')
('3.0.0', '\\log p_\\theta({\\bm{y}}|{\\bm{x}}) = \\sum_{t=1}^{T} \\log p_\\theta(y_t|{\\bm{x}}, {\\bm{y}}_{1:t-1})')
('3.0.0', '\\sim')
('3.0.0.0', '\\mathcal{U}(1, L)')
('3.0.0.0', '\\mathcal{U}(1, 2L)')
('3.0.0.0', 'L=20')
('5.0', 'f_\\theta')
('5.0', '\\theta')
('5.0', 'f_\\theta')
('5.0', '{\\bm{x}}= \\left[\\texttt{<bos>}, x_1, \\ldots, x_T\\right]')
('5.0', 'f_\\theta')
('5.0', '{\\bm{x}}')
('5.0', '[1, 2, \\ldots, T]')
('5.0', 'l')
('5.0', '{\\bm{H}}^{(l-1)}')
('5.0', 'l')
('5.0', '{\\bm{H}}^{l}')
('5.0', '{\\bm{W}}_Q')
('5.0', '{\\bm{W}}_K')
('5.0', '{\\bm{W}}_V')
('5.0', '{\\bm{W}}_O')
('5.0', '{\\bm{W}}_Q, {\\bm{W}}_K, {\\bm{W}}_V \\in \\mathbb{R}^{h \\times d}')
('5.0', '{\\bm{W}}_O \\in \\mathbb{R}^{d \\times h}')
('5.0', 'd')
('5.0', 'h')
('5.0', '{\\bm{W}}_1, {\\bm{W}}_2 \\in \\mathbb{R}^{d \\times k.d}')
('5.0', '{\\bm{x}}')
('5.0', 'T+1')
('5.0', 'f_\\theta')
('5.0', '[1, \\ldots, T+1]')
('5.0', '{\\bm{H}}^{(1)}')
('5.0', '{\\bm{W}}_Q')
('5.0', '{\\bm{W}}_K')
('5.0', '{\\bm{W}}_V')
('5.0', '{\\bm{W}}_O')
('5.0', '{\\bm{W}}_1')
('5.0', '{\\bm{W}}_2')
('5.0', '{\\bm{H}}^{(1)}')
('5.0', 'f_\\theta')
('5.0', 'l\\ge 2')
('5.0', '{\\bm{q}}_n')
('5.0', '{\\bm{k}}_m')
('5.0', 'n')
('5.0', 'm')
('5.0', '\\begin{aligned}\n        \\langle {\\bm{q}}_n, {\\bm{k}}_m \\rangle & = f_\\mathrm{cnt}({\\bm{q}}, {\\bm{k}}) + f_\\mathrm{rel}(n-m) \\\n      \\end{aligned}')
('5.0', 'f_\\mathrm{cnt}')
('5.0', 'f_\\mathrm{rel}')
('5.1', 'l')
('5.1', '\\mathrm{P}_t = p({\\bm{k}}|{\\bm{q}}_t)')
('5.1', 't')
('5.1', '{\\bm{k}}\\in [{\\bm{k}}_1, \\dots {\\bm{k}}_t]')
('5.1', 'T')
('5.1', '\\mathrm{P}')
('5.1', '\\mathrm{Q}')
('5.1', 'D_\\mathrm{AT}(\\mathrm{P}, \\mathrm{Q}) = \\frac{1}{T} \\sum_{t=1}^T D_\\mathrm{JSD}(\\mathrm{P}_t || \\mathrm{Q}_t)')
('5.1', 'A')
('5.1', 'B')
('5.1', 'l')
('5.1', '\\begin{aligned}\n    D^{(l)}(A, B) & = \\min_{(\\mathrm{P}, \\mathrm{Q}) \\in A_l \\times B_l} D_\\mathrm{AT}(\\mathrm{P}, \\mathrm{Q}) \\\\\n  \\end{aligned}\n  \\label{eq:similarity}')
('5.1', 'A_l')
('5.1', 'B_l')
('5.1', 'l')
('5.1', 'A')
('5.1', 'B')
('6', '{\\bm{x}}')
('6', '{\\bm{s}};{\\bm{y}}')
('6', 'L=8')
('6.0', '\\mathcal{R}')
('6.0', 'd')
('6.0', '{\\bm{q}}_t')
('6.0', '{\\bm{k}}_n')
('6.0', '(t - n + 1)')
('6.0', '\\bar{d}')
('6.0', '\\bar{d}')
('6.0', '\\bar{d}')
('7.0.0', 'w')
('13.0', 'f_\\theta')
('13.0', '\\theta')
('13.0', 'f_\\theta')
('13.0', '{\\bm{x}}= \\left[x_0, x_1, \\ldots, x_T\\right]')
('13.0', '{\\bm{y}}= \\left[y_0, y_1, \\ldots, y_T\\right]')
('13.0', '\\mathrm{TLayer}^{(l)}({\\bm{H}}^{(l-1)};\\theta_l)')
('13.0', '{\\bm{H}}^{(l-1)}')
('13.0', 'l')
('13.0', '{\\bm{H}}^{l}')
('13.0', 'l')
('13.0', '\\theta_l')
('13.0', 'l')
('13.0', '{\\bm{H}}^{(l)} \\in \\mathbb{R}^{d \\times (T+1)}')
('13.0', 't')
('13.0', '{\\bm{h}}_t^{(l)}')
('13.0', 't')
('13.0', 'l')
('13.0', '\\theta_l = \\{({\\bm{W}}_Q^m, {\\bm{W}}_K^m, {\\bm{W}}_V^m, {\\bm{W}}_O^m)_m, {\\bm{W}}_1, {\\bm{W}}_2\\}')
('13.0', '{\\bm{W}}_Q^m, {\\bm{W}}_K^m, {\\bm{W}}_V^m \\in \\mathbb{R}^{h \\times d}')
('13.0', '{\\bm{W}}_O^m \\in \\mathbb{R}^{d \\times h}')
('13.0', 'm')
('13.0', '{\\bm{W}}_1, {\\bm{W}}_2 \\in \\mathbb{R}^{d \\times k.d}')
('13.0', 'd')
('13.0', 'h')
('13.0', 'h = \\frac{d}{\\text{\\# heads}}')
('13.0', 'k')
('13.0', 'l')
('13.0', 'm')
('13.0', '\\mathrm{TLayer}^{(l)}')
('13.0', '{\\bm{H}}^{(l-1)}')
('13.0', 't')
('13.0', '{\\bm{H}}^{(l)}')
('13.0', '\\begin{aligned}\n  {\\bm{h}}_t^{(l)} = \\mathrm{FF}(\\lambda({\\bm{a}}_t + {\\bm{h}}_t^{(l-1)})) + {\\bm{a}}_t + {\\bm{h}}_t^{(l-1)}\n\\end{aligned}')
('13.0', '\\mathrm{FF}')
('13.0', '\\lambda')
('13.0', '{\\bm{a}}_t \\in \\mathbb{R}^d')
('13.0', 't')
('13.0', '{\\bm{a}}_t')
('13.0', '\\begin{aligned}\n  \\label{eq:multi_head_attention}\n  {\\bm{a}}_t = \\sum_{m} \\mathrm{Attn}^{(m)}({\\bm{h}}_t^{(l-1)}, {\\bm{H}}^{(l-1)})\n\\end{aligned}')
('13.0', '\\mathrm{Attn}^{(m)}')
('13.0', 'm')
('13.0', '{\\bm{o}}_t \\in \\mathbb{R}^d')
('13.0', 't')
('13.0', '{\\bm{o}}_t')
('13.0', '\\begin{aligned}\n  \\label{eq:attention_head}\n  {\\bm{o}}_t = {\\bm{W}}_O \\left(\\sum_{i\\le t} \\hat{{\\bm{\\alpha}}}_i{\\bm{v}}_i \\right)\n\\end{aligned}')
('13.0', '\\hat{{\\bm{\\alpha}}} = \\mathrm{softmax}({\\bm{\\alpha}}) \\in \\mathbb{R}^{(t+1)}')
('13.0', '{\\bm{\\alpha}}')
('13.0', '\\begin{aligned}\n  \\label{eq:attention_weight}\n  {\\bm{\\alpha}}= \\left[\\langle {\\bm{q}}_t, {\\bm{k}}_0 \\rangle, \\langle {\\bm{q}}_t, {\\bm{k}}_1 \\rangle, \\ldots, \\langle {\\bm{q}}_t, {\\bm{k}}_t \\rangle \\right]^\\intercal\n\\end{aligned}')
('13.0', '{\\bm{q}}_t = {\\bm{W}}_Q {\\bm{h}}_t^{(l-1)} \\in \\mathbb{R}^h')
('13.0', '{\\bm{k}}_i = {\\bm{W}}_K {\\bm{h}}_i^{(l-1)} \\in \\mathbb{R}^h')
('13.0', '{\\bm{v}}_i = {\\bm{W}}_V {\\bm{h}}_i^{(l-1)} \\in \\mathbb{R}^h')
('13.0', '\\langle \\cdot, \\cdot \\rangle')
('13.0', '\\mathrm{FF}(\\cdot) \\in \\mathbb{R}^d')
('13.0', '\\begin{aligned}\n  \\label{eq:ff_sublayer}\n  \\mathrm{FF}({\\bm{x}}) = {\\bm{W}}_2 \\sigma({\\bm{W}}_1^\\intercal {\\bm{x}})\n\\end{aligned}')
('13.0', '\\sigma')
('13.0', '\\lambda(\\cdot) \\in \\mathbb{R}^d')
('13.0', '{\\bm{H}}^{(0)} = {\\bm{W}}_E {\\bm{X}}')
('13.0', '{\\bm{W}}_E \\in \\mathbb{R}^{d \\times V}')
('13.0', '{\\bm{X}}\\in \\mathbb{R}^{V \\times (T+1)}')
('13.0', 'V')
('13.1', '\\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle')
('13.1.0', '{\\bm{p}}_i')
('13.1.0', 'i')
('13.1.0', '\\begin{aligned}\n  \\label{eq:ape_init}\n  {\\bm{H}}^{(0)} = {\\bm{W}}_E {\\bm{X}}+ {\\bm{W}}_P {\\bm{P}}\n\\end{aligned}')
('13.1.0', '{\\bm{W}}_P \\in \\mathbb{R}^{d \\times T}')
('13.1.0', '{\\bm{P}}\\in \\mathbb{R}^{V_p \\times (T+1)}')
('13.1.0', 'V_p')
('13.1.0', 'j')
('13.1.0', '\\begin{aligned}\n  \\label{eq:ape_hidden_state}\n  {\\bm{h}}_j^{(0)} = {\\bm{e}}_j + {\\bm{p}}_j\n\\end{aligned}')
('13.1.0', '{\\bm{e}}_j \\in \\mathbb{R}^d')
('13.1.0', 'x_j')
('13.1.0', '{\\bm{p}}_j \\in \\mathbb{R}^d')
('13.1.0', 'j')
('13.1.0', '\\begin{aligned}\n  \\label{eq:ape_dot_product}\n  \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle & = \\langle {\\bm{W}}_Q {\\bm{h}}_t^{(0)}, {\\bm{W}}_K {\\bm{h}}_i^{(0)} \\rangle \\nonumber                                                  \\\\\n                               & = \\langle {\\bm{W}}_Q ({\\bm{e}}_t + {\\bm{p}}_t) , {\\bm{W}}_K ({\\bm{e}}_i + {\\bm{p}}_i) \\rangle \\nonumber                                         \\\\\n                               & = \\left({\\bm{W}}_Q ({\\bm{e}}_t + {\\bm{p}}_t)\\right)^\\intercal \\left({\\bm{W}}_K ({\\bm{e}}_i + {\\bm{p}}_i)\\right) \\nonumber                       \\\\\n                               & = {\\bm{e}}_t^\\intercal {\\bm{W}}_Q^\\intercal {\\bm{W}}_K {\\bm{e}}_i + {\\bm{e}}_t^\\intercal {\\bm{W}}_Q^\\intercal {\\bm{W}}_K {\\bm{p}}_i \\nonumber             \\\\\n                               & \\phantom{=} + {\\bm{p}}_t^\\intercal {\\bm{W}}_Q^\\intercal {\\bm{W}}_K {\\bm{e}}_i + {\\bm{p}}_t^\\intercal {\\bm{W}}_Q^\\intercal {\\bm{W}}_K {\\bm{p}}_i \\nonumber \\\\\n\\end{aligned}')
('13.1.0', '{\\bm{p}}_j \\in \\mathbb{R}^d')
('13.1.0', '{\\bm{p}}_j')
('13.1.0', '{\\bm{p}}_j')
('13.1.0', '\\begin{aligned}\n  \\label{eq:ape_sinusoidal}\n  {\\bm{p}}_j = \\left[\\sin(\\omega_1.j), \\cos(\\omega_1.j), \\sin(\\omega_2.j), \\cos(\\omega_2.j), \\ldots, \\sin(\\omega_{d/2}.j), \\cos(\\omega_{d/2}.j) \\right]^\\intercal\n\\end{aligned}')
('13.1.0', '\\omega_i = \\frac{1}{10000^{2i/d}}')
('13.1.0.0', '(t-i)')
('13.1.0.0', 't')
('13.1.0.0', 'i')
('13.1.0.0', 'b')
('13.1.0.0', 'b')
('13.1.0.0', '\\begin{aligned}\n  \\label{eq:t5_relative_bias}\n  \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle & = {\\bm{q}}_t^\\intercal {\\bm{k}}_i + b_{\\mathrm{bucket}(n-m)}\n\\end{aligned}')
('13.1.0.0', '\\mathrm{bucket}(n) =\n  \\begin{cases}\n    n                                                                                                                                                                                       & \\text{if}\\ n < \\frac{\\mathcal{B}}{2}                  \\\\\n    \\frac{\\mathcal{B}}{2} + \\left\\lfloor \\frac{\\log{\\left(\\frac{n}{\\mathcal{B}/2}\\right)}}{\\log{\\left(\\frac{\\mathcal{D}}{\\mathcal{B}/2}\\right)}} \\times \\frac{\\mathcal{B}}{2} \\right\\rfloor & \\text{if}\\ \\frac{\\mathcal{B}}{2} \\leq n < \\mathcal{D} \\\\\n    \\mathcal{B} - 1                                                                                                                                                                         & \\text{if}\\ n \\geq \\mathcal{D}\n  \\end{cases}')
('13.1.0.0', 'd')
('13.1.0.0', '\\mathcal{B}')
('13.1.0.0', '\\mathcal{D}')
('13.1.0.0', '\\frac{\\mathcal{D}}{2}')
('13.1.0.0', '\\frac{\\mathcal{D}}{2}')
('13.1.0.0', '\\mathcal{D}')
('13.1.0.0', '\\mathcal{B} = 32')
('13.1.0.0', '\\mathcal{D} = 128')
('13.1.0.0', '\\mathcal{B} = 5')
('13.1.0.0', '\\mathcal{D} = 6')
('13.1.0.0', '\\mathrm{bucket}(\n  \\begin{bmatrix}\n    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    4 & 3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    5 & 4 & 3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 \\\\\n    6 & 5 & 4 & 3 & 2 & 1 & 0 & 0 & 0 & 0 \\\\\n    7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 & 0 & 0 \\\\\n    8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 & 0 \\\\\n    9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\\\\n  \\end{bmatrix}\n  )\n  =\n  \\begin{bmatrix}\n    0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    3 & 3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\\n    4 & 3 & 3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 \\\\\n    4 & 4 & 3 & 3 & 2 & 1 & 0 & 0 & 0 & 0 \\\\\n    4 & 4 & 4 & 3 & 3 & 2 & 1 & 0 & 0 & 0 \\\\\n    4 & 4 & 4 & 4 & 3 & 3 & 2 & 1 & 0 & 0 \\\\\n    4 & 4 & 4 & 4 & 4 & 3 & 3 & 2 & 1 & 0\n  \\end{bmatrix}')
('13.1.0.1', '\\begin{aligned}\n  \\label{eq:alibi}\n  \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle & = {\\bm{q}}_t^\\intercal {\\bm{k}}_i - (t-i).C^{(m+1)}\n\\end{aligned}')
('13.1.0.1', 'm')
('13.1.0.1', 'C')
('13.1.0.1', 'C = 2^{-2^{-\\log _2 (\\text{\\# heads}+3)}}')
('13.1.0.1', '\\frac{1}{2}, \\frac{1}{2^2}, \\dots, \\frac{1}{2^8}')
('13.1.0.2', 'd=2')
('13.1.0.2', '\\begin{aligned}\n  \\label{eq:rotary}\n  \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle = &\n  \\langle \\mathrm{Rot}({\\bm{q}}_t, t), \\mathrm{Rot}({\\bm{k}}_i, i) \\rangle                                             \\nonumber \\\\\n  =                              & \\langle {\\bm{R}}^{t\\theta}{\\bm{q}}_t, {\\bm{R}}^{i\\theta}{\\bm{k}}_i \\rangle          \\nonumber               \\\\\n  =                              & ({\\bm{R}}^{t\\theta}{\\bm{q}}_t)^\\intercal ({\\bm{R}}^{i\\theta}{\\bm{k}}_i)             \\nonumber           \\\\\n  =                              & {{\\bm{q}}_t}^\\intercal ({\\bm{R}}^{t\\theta}) ^\\intercal {\\bm{R}}^{i\\theta}{\\bm{k}}_i \\nonumber           \\\\\n  =                              & {{\\bm{q}}_t}^\\intercal {\\bm{R}}^{(i-t)\\theta} {\\bm{k}}_i                     \\nonumber             \\\\\n\\end{aligned}')
('13.1.0.2', '{\\bm{R}}^{t\\theta}')
('13.1.0.2', '{\\bm{x}}')
('13.1.0.2', 't\\theta')
('13.1.0.2', '\\begin{aligned}\n  \\label{eq:rotary_matrix}\n  {\\bm{R}}^{n\\theta} = \\begin{bmatrix}\n                    \\cos(n\\theta) & -\\sin(n\\theta) \\\\\n                    \\sin(n\\theta) & \\cos(n\\theta)\n                  \\end{bmatrix}\n\\end{aligned}')
('13.1.0.2', 'd>2')
('13.1.0.2', '{\\bm{q}}_t')
('13.1.0.2', '{\\bm{k}}_i')
('13.1.0.2', '\\theta')
('13.1.0.3', '\\begin{aligned}\n  \\label{eq:nope}\n  \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle & = {\\bm{q}}_t^\\intercal {\\bm{k}}_i\n\\end{aligned}')
('14.0', '\\mathrm{softmax}')
('14.0', '{\\bm{x}}= \\left[\\texttt{<bos>}, x_1, \\ldots, x_T\\right]')
('14.0', 'T+1')
('14.0', 'f_\\theta')
('14.0', '[1, \\ldots, T+1]')
('14.0', '{\\bm{H}}^{(1)}')
('14.0', '{\\bm{W}}_Q')
('14.0', '{\\bm{W}}_K')
('14.0', '{\\bm{W}}_V')
('14.0', '{\\bm{W}}_O')
('14.0', '{\\bm{W}}_1')
('14.0', '{\\bm{W}}_2')
('14.0', 'd')
('14.0', '{\\bm{W}}_E \\in \\mathbb{R}^{d \\times V}')
('14.0', '{\\bm{W}}_E')
('14.0', '\\begin{aligned}\n  \\label{eq:word_embedding}\n  {\\bm{W}}_E = \\begin{bmatrix}\n            1       & 1       & 1       & \\dots  & 1       \\\\\n            1       & 0       & 0       & \\dots  & 0       \\\\\n            0       & 0       & 0       & \\dots  & 0       \\\\\n            e_{4,1} & e_{4,2} & e_{4,3} & \\dots  & e_{4,V} \\\\\n            \\vdots  & \\vdots  & \\vdots  & \\ddots & \\vdots  \\\\\n            e_{d,1} & e_{d,2} & e_{d,2} & \\dots  & e_{d,V}\n          \\end{bmatrix}_{d \\times V}\n\\end{aligned}')
('14.0', 'e_{d,i} \\in \\mathbb{R}')
('14.0', 'h\\ge 1')
('14.0', '{\\bm{W}}_Q, {\\bm{W}}_K, {\\bm{W}}_V, {\\bm{W}}_O')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_key_value}\n  \\begin{array}{ccc}\n    {\\bm{W}}_K = \\begin{bmatrix}\n              1      & 0      & \\dots  & 0      \\\\\n              1      & 0      & \\dots  & 0      \\\\\n              \\vdots & \\vdots & \\ddots & \\vdots \\\\\n              1      & 0      & \\dots  & 0\n            \\end{bmatrix}_{h \\times d} &\n    {\\bm{W}}_V = \\begin{bmatrix}\n              0      & 1      & 0      & \\dots  & 0      \\\\\n              0      & 0      & 0      & \\dots  & 0      \\\\\n              \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n              0      & 0      & 0      & \\dots  & 0\n            \\end{bmatrix}_{h \\times d}\n  \\end{array}\n\\end{aligned}')
('14.0', '{\\bm{W}}_K')
('14.0', '{\\bm{W}}_V')
('14.0', '{\\bm{W}}_Q')
('14.0', '{\\bm{W}}_O')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_output}\n  {\\bm{W}}_O = \\begin{bmatrix}\n            0      & 0      & 0      & 0      & \\dots  & 0      \\\\\n            0      & 0      & 0      & 0      & \\dots  & 0      \\\\\n            1      & 0      & 0      & 0      & \\dots  & 0      \\\\\n            0      & 0      & 0      & 0      & \\dots  & 0      \\\\\n            \\vdots & \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n            0      & 0      & 0      & 0      & \\dots  & 0\n          \\end{bmatrix}_{d \\times h}\n\\end{aligned}')
('14.0', '{\\bm{x}}= \\left[\\texttt{<bos>}, x_1, \\ldots, x_T\\right]')
('14.0', '[1, \\ldots, T+1]')
('14.0', '{\\bm{H}}^{(1)}')
('14.0', 't')
('14.0', '{\\bm{H}}^{(1)}')
('14.0', '{\\bm{h}}_t^{(1)}')
('14.0', '{\\bm{W}}_E')
('14.0', '{\\bm{H}}^{(0)}')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_hidden_state_0}\n  {\\bm{H}}^{(0)} = {\\bm{W}}_E {\\bm{X}}= \\begin{bmatrix}\n                            1       & 1       & 1       & \\dots  & 1       \\\\\n                            1       & 0       & 0       & \\dots  & 0       \\\\\n                            0       & 0       & 0       & \\dots  & 0       \\\\\n                            e_{4,1} & e_{4,2} & e_{4,3} & \\dots  & e_{4,V} \\\\\n                            \\vdots  & \\vdots  & \\vdots  & \\ddots & \\vdots  \\\\\n                            e_{d,1} & e_{d,2} & e_{d,2} & \\dots  & e_{d,V}\n                          \\end{bmatrix}_{d \\times (T+1)}\n\\end{aligned}')
('14.0', '1 \\le t \\le T+1')
('14.0', '{\\bm{W}}_Q')
('14.0', '{\\bm{q}}_t')
('14.0', '{\\bm{q}}_t = {\\bm{W}}_Q{\\bm{h}}_t^{(0)}')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_query}\n  {\\bm{q}}_t = [q_1, q_2, q_3, \\dots, q_h]^\\intercal\n\\end{aligned}')
('14.0', '{\\bm{W}}_Q')
('14.0', 'q_j \\in \\mathbb{R}')
('14.0', '{\\bm{k}}_i = {\\bm{W}}_K{\\bm{h}}_i^{(0)}')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_key}\n  \\begin{array}{cccc}\n    {\\bm{k}}_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix} &\n    {\\bm{k}}_2 = \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix} &\n    \\dots                                                       &\n    {\\bm{k}}_{t} = \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\end{pmatrix}\n  \\end{array}\n\\end{aligned}')
('14.0', 't')
('14.0', '\\le t')
('14.0', '{\\bm{\\alpha}}')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_attention_weight}\n  {\\bm{\\alpha}}= & \\left[\\langle {\\bm{q}}_t, {\\bm{k}}_1 \\rangle, \\langle {\\bm{q}}_t, {\\bm{k}}_2 \\rangle, \\ldots, \\langle {\\bm{q}}_t, {\\bm{k}}_t \\rangle \\right]^\\intercal \\\\\n  =         & \\left[\\alpha^*, \\alpha^*, \\ldots, \\alpha^* \\right]^\\intercal\n\\end{aligned}')
('14.0', '\\alpha^* = q_1 + q_2 + \\ldots + q_h')
('14.0', '\\mathrm{softmax}')
('14.0', '{\\bm{\\alpha}}^i')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_attention_prob}\n  \\hat{{\\bm{\\alpha}}} = \\mathrm{softmax}({\\bm{\\alpha}}) = \\left[\\frac{1}{t}, \\frac{1}{t}, \\ldots, \\frac{1}{t} \\right]^\\intercal\n\\end{aligned}')
('14.0', '{\\bm{v}}_i = {\\bm{W}}_V{\\bm{h}}_i^{(0)}')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_value}\n  \\begin{array}{cccc}\n    {\\bm{v}}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix} &\n    {\\bm{v}}_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix} &\n    \\dots                                                       &\n    {\\bm{v}}_{t} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix}\n  \\end{array}\n\\end{aligned}')
('14.0', '{\\bm{W}}_O')
('14.0', '\\begin{aligned}\n  \\label{eq:abs_output2}\n  {\\bm{o}}_t = {\\bm{W}}_O \\left(\\sum_{i\\le t} \\hat{{\\bm{\\alpha}}}_i{\\bm{v}}_i \\right) = {\\bm{W}}_O \\left(\\frac{1}{t}\\sum_{i\\le t} {\\bm{v}}_i \\right) = {\\bm{W}}_O \\begin{pmatrix} 1/t \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix}_{h} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1/t \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix}_{d}\n\\end{aligned}')
('14.0', '\\le t')
('14.0', 't')
('14.0', '[1, 2, \\dots, T+1]')
('14.1', '{\\bm{H}}^{(1)}')
('14.1', 'f_\\theta')
('14.1', 'l\\ge 2')
('14.1', '{\\bm{q}}_t')
('14.1', '{\\bm{k}}_i')
('14.1', 't')
('14.1', 'i')
('14.1', 't \\ge i')
('14.1', '\\begin{aligned}\n        \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle & = f_\\mathrm{cnt}({\\bm{q}}_t, {\\bm{k}}_i) + f_\\mathrm{rel}(t-i) \\\n      \\end{aligned}')
('14.1', 'f_\\mathrm{cnt}')
('14.1', 'f_\\mathrm{rel}')
('14.1', 'l\\ge 2')
('14.1', 'd')
('14.1', 'h\\ge 2')
('14.1', '{\\bm{W}}_Q, {\\bm{W}}_K')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_query}\n  {\\bm{W}}_Q = \\begin{bmatrix}\n            1        & 0        & 0        & 0        & \\dots  & 0        \\\\\n            0        & 0        & -1       & 0        & \\dots  & 0        \\\\\n            w_{3, 1} & w_{3, 2} & w_{3, 3} & w_{3, 4} & \\dots  & w_{3, d} \\\\\n            \\vdots   & \\vdots   & \\vdots   & \\vdots   & \\ddots & \\vdots   \\\\\n            w_{h, 1} & w_{h, 2} & w_{h, 3} & w_{h, 4} & \\dots  & w_{h, d}\n          \\end{bmatrix}_{h \\times d}\n\\end{aligned}')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_key}\n  {\\bm{W}}_V = \\begin{bmatrix}\n            0               & 0               & 1               & 0               & \\dots  & 0               \\\\\n            1               & 0               & 0               & 0               & \\dots  & 0               \\\\\n            w^\\prime_{3, 1} & w^\\prime_{3, 2} & w^\\prime_{3, 3} & w^\\prime_{3, 4} & \\dots  & w^\\prime_{3, d} \\\\\n            \\vdots          & \\vdots          & \\vdots          & \\vdots          & \\ddots & \\vdots          \\\\\n            w^\\prime_{h, 1} & w^\\prime_{h, 2} & w^\\prime_{h, 3} & w^\\prime_{h, 4} & \\dots  & w^\\prime_{h, d}\n          \\end{bmatrix}_{h \\times d}\n\\end{aligned}')
('14.1', 'w_{i,j}, w^\\prime_{i,j} \\in \\mathbb{R}')
('14.1', '{\\bm{W}}_V')
('14.1', '{\\bm{W}}_O')
('14.1', '{\\bm{x}}= \\left[\\texttt{<bos>}, x_1, \\ldots, x_T\\right]')
('14.1', '{\\bm{q}}_t')
('14.1', '{\\bm{k}}_i')
('14.1', 't')
('14.1', 'i')
('14.1', 't \\ge i')
('14.1', '{\\bm{H}}^{(l)}')
('14.1', 'l\\ge 1')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_hidden_state_1}\n  {\\bm{H}}^{(l)} = \\begin{bmatrix}\n                1       & 1       & 1       & 1       & \\dots  & 1         \\\\\n                1       & 0       & 0       & 0       & \\dots  & 0         \\\\\n                1       & 2       & 3       & 4       & \\dots  & T+1       \\\\\n                h_{4,1} & h_{4,2} & h_{4,3} & h_{4,4} & \\dots  & h_{4,T+1} \\\\\n                \\vdots  & \\vdots  & \\vdots  & \\vdots  & \\ddots & \\vdots    \\\\\n                h_{d,1} & h_{d,2} & h_{d,3} & h_{d,4} & \\dots  & h_{d,T+1}\n              \\end{bmatrix}_{d \\times (T+1)}\n\\end{aligned}')
('14.1', 'h_{i,j} \\in \\mathbb{R}')
('14.1', '1 \\le t \\le T+1')
('14.1', '{\\bm{W}}_Q')
('14.1', '{\\bm{q}}_t')
('14.1', '{\\bm{q}}_t = {\\bm{W}}_Q{\\bm{h}}_t^{(l)}')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_query_vec}\n  {\\bm{q}}_t = [1, -t, q_3, \\dots, q_h]^\\intercal\n\\end{aligned}')
('14.1', 'q_j \\in \\mathbb{R}')
('14.1', '{\\bm{k}}_i = {\\bm{W}}_K{\\bm{h}}_i^{(l)}')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_key_vec}\n  \\begin{array}{ccccc}\n    {\\bm{k}}_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ k_{3, 1} \\\\ \\vdots \\\\ k_{h, 1} \\end{pmatrix} &\n    {\\bm{k}}_2 = \\begin{pmatrix} 2 \\\\ 1 \\\\ k_{3, 2} \\\\ \\vdots \\\\ k_{h, 2} \\end{pmatrix} &\n    {\\bm{k}}_3 = \\begin{pmatrix} 3 \\\\ 1 \\\\ k_{3, 3} \\\\ \\vdots \\\\ k_{h, 3} \\end{pmatrix} &\n    \\dots                                                                          &\n    {\\bm{k}}_{t} = \\begin{pmatrix} t \\\\ 1 \\\\ k_{3, t} \\\\ \\vdots \\\\ k_{h, t} \\end{pmatrix}\n  \\end{array}\n\\end{aligned}')
('14.1', 'k_{(\\cdot, \\cdot)} \\in \\mathbb{R}')
('14.1', '{\\bm{k}}_i')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_key_vec_2}\n  {\\bm{k}}_i = [i, 1, k_{3,i}, \\dots, k_{h, i}]^\\intercal\n\\end{aligned}')
('14.1', '{\\bm{q}}_t')
('14.1', '{\\bm{k}}_i')
('14.1', '\\begin{aligned}\n  \\label{eq:rel_attention_dot_product}\n  \\langle {\\bm{q}}_t, {\\bm{k}}_i \\rangle = & 1.i + (-t).1 + q_3.k_{3,i} + \\dots + q_h.k_{h,i}   \\\\\n  =                              & i - t + \\sum_{j=3}^{h} q_j.k_{j,i}                 \\\\\n  =                              & \\left(\\sum_{j=3}^{h} q_j.k_{j,i}\\right) - (t-i)    \\\\\n  =                              & f_\\mathrm{cnt}({\\bm{q}}_t, {\\bm{k}}_i) + f_\\mathrm{rel}(t-i)\n\\end{aligned}')
('14.1', '{\\bm{q}}_t')
('14.1', '{\\bm{k}}_i')
('15.0.0', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}  \\\\\n     & \\texttt{Compute: 5 3 7 2 6 + 1 9 1 7 ?}  \\\\\n     & \\text{\\footnotesize \\color{gray} Output} \\\\\n     & \\texttt{The answer is 5 5 6 4 3.}        \\\\\n  \\end{aligned}')
('15.0.0', 'L')
('15.0.0', 'L')
('15.0.0.0', 'x')
('15.0.0.0', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}                                 \\\\\n     & \\texttt{Evaluate x = 3  in  ( 3 x ** 0 + 1 x ** 1 + 1 x ** 2 ) \\% 10 ?} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}                                \\\\\n     & \\texttt{The answer is 5.}                                               \\\\\n  \\end{aligned}')
('15.0.0.0', 'x')
('15.0.0.0', '\\mathcal{U}(-2, 2)')
('15.0.0.0', '\\mathcal{U}(0,3)')
('15.0.0.0', '\\mathcal{U}(-3, 3)')
('15.0.0.1', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}          \\\\\n     & \\texttt{Sort the following numbers: 3 1 4 1 5 ?} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}         \\\\\n     & \\texttt{The answer is 1 1 3 4 5.}                \\\\\n  \\end{aligned}')
('15.0.0.1', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}                            \\\\\n     & \\texttt{Sort the following numbers: 3 1, 4 1, 5 9, 1 2 6, 5 3 3 ?} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}                           \\\\\n     & \\texttt{The answer is 3 1, 4 1, 5 9, 1 2 6, 5 3 3.}                \\\\\n  \\end{aligned}')
('15.0.0.1', '\\mathcal{U}(0, 10000)')
('15.0.0.2', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}          \\\\\n     & \\texttt{Compute: ( 1 + 2 + 3 + 4 + 7 ) \\% 10 ?} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}         \\\\\n     & \\texttt{The answer is 7.}                        \\\\\n  \\end{aligned}')
('15.0.0.2', '\\mathcal{U}(1, 9)')
('15.0.0.3', "\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}          \\\\\n     & \\texttt{Is the number of 1's even in [ 1 0 0 1 1] ?}          \\\\\n     & \\text{\\footnotesize \\color{gray} Output}         \\\\\n     & \\texttt{The answer is No.}                        \\\\\n  \\end{aligned}")
('15.0.0.4', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}          \\\\\n     & \\texttt{If a = -1; b = -a; c = +b; d = +c. Then what is c?} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}         \\\\\n     & \\texttt{The answer is +1.}                        \\\\\n  \\end{aligned}')
('15.0.0.5', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}          \\\\\n     & \\texttt{Copy the following words: <w1> <w2> <w3> <w4> <w5> .} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}         \\\\\n     & \\texttt{<w1> <w2> <w3> <w4> <w5>}                        \\\\\n  \\end{aligned}')
('15.0.0.6', '\\begin{aligned}\n     & \\text{\\footnotesize \\color{gray} Input}          \\\\\n     & \\texttt{Reverse the following words: <w1> <w2> <w3> <w4> <w5> .} \\\\\n     & \\text{\\footnotesize \\color{gray} Output}         \\\\\n     & \\texttt{<w5> <w4> <w3> <w2> <w1> .}                        \\\\\n  \\end{aligned}')
('15.1', '\\mathrm{lr} \\in \\{0.00001, 0.00003, 0.00005\\}')
('15.1', '\\mathrm{WeightDecay} \\in \\{0, 0.05, 0.1\\}')
('17.0', 'd_\\mathrm{model}=1024')
('17.0', 'd_\\mathrm{kv}=128')
('17.0', 'd_\\mathrm{ff}=16,384')
('17.0', '1024')
('17.0', '256')
('17.0', '\\beta_1=0.9')
('17.0', '\\beta_2=0.95')
('17.0', '\\epsilon = 10^{-8}')
('17.0', '0.1')
('17.0', '2\\times 10^{-4}')
('17.1', '49,152')
('17.2', '1500')
('17.2', '512')
('17.2', '2560')
('17.2', '1024')
('17.2', '1024')
('17.2', '\\leq 1024')
('17.2', '> 1024')
('17.2', '1800')
('17.2', 'b_{\\mathrm{bucket}(.)}')
('17.2', '\\mathrm{bucket}(.) \\in [0, 31]')
