('1.0.0.3', 'a')
('1.0.0.3', '\\sigma(a) := 1/(1+e^{-a})')
('1.0.0.3', '\\left\\lVert\\cdot\\right\\rVert_\\infty')
('1.0.0.3', 'Z')
('1.0.0.3', 'P')
('1.0.0.3', 'f(\\cdot)')
('1.0.0.3', 'Z')
('1.0.0.3', 'f(Z)')
('1.0.0.3', 'P')
('1.0.0.3', '\\mathbb{E}_{Z\\sim P}[f(Z)]')
('1.0.0.3', '\\mathbb{E}_{Z}[f(Z)]')
('1.0.0.3', '\\mathcal{Y}')
('1.0.0.3', '\\Delta(\\mathcal{Y})')
('1.0.0.3', '\\mathcal{Y}')
('1.0.0.3', '0/0 = 0')
('2.0', '(\\mathcal{X}, \\mathcal{Y}, r^\\star, \\rho)')
('2.0', 'r^\\star: \\mathcal{X}\\times \\mathcal{Y}\\to \\mathbb{R}')
('2.0', 'r(x,y)')
('2.0', 'y\\in \\mathcal{Y}')
('2.0', 'x \\in \\mathcal{X}')
('2.0', '\\mathcal{X}')
('2.0', '\\mathcal{Y}')
('2.0', '\\rho')
('2.0', '\\pi: \\mathcal{X}\\to\\Delta(\\mathcal{Y})')
('2.0', '\\pi(\\cdot ~|~ x) \\in \\Delta(\\mathcal{Y})')
('2.0', 'x \\in \\mathcal{X}')
('2.0', '\\pi')
('2.0', 'x')
('2.0', '\\begin{aligned}\n    V^\\pi(x) := \\mathbb{E}_{y\\sim\\pi(\\cdot | x)}\\left[r(x,y)\\right].\n\\end{aligned}')
('2.0', 'y')
('2.0', 'r(x,y)')
('2.0', 'x')
('2.0', '\\pi^\\star')
('2.0', '\\pi')
('2.0', '\\begin{aligned}\n\\label{eq:suboptimality-def}\n    \\mathrm{SubOpt}(\\pi) := \\mathbb{E}_{x\\sim\\rho}\\left[V^{\\pi^\\star}(x) - V^{\\pi}(x)\\right].\n\\end{aligned}')
('2.0', '\\pi^\\star')
('2.0', '\\pi')
('2.0.0', '\\mathcal{D}')
('2.0.0', '\\mathcal{D}')
('2.0.0', '\\mathcal{D}')
('2.0.0', 'x')
('2.0.0', '(y^+, y^-)')
('2.0.0', '(y^+, y^-) \\sim \\pi_{\\mathrm{ref}}(\\cdot~|~x)')
('2.0.0', '\\pi_{\\mathrm{ref}}')
('2.0.0', 'y^+')
('2.0.0', 'y^-')
('2.0.0', 'x')
('2.0.0', 'y^+\\succ y^-~|~ x')
('2.0.0', 'r^\\star')
('2.0.0', '\\label{eq:BTL}\n    P(y^+\\succ y^-~|~ x) = \\frac{\\exp(r^\\star(x,y^+))}{\\exp(r^\\star(x,y^+)) + \\exp(r^\\star(x,y^-))}.')
('2.0.0', '\\mathcal{D}= \\{(x_i,y_i^+, y_i^-)\\}_{i=1}^{n}')
('2.0.0', '\\widehat{r}')
('2.0.0', '\\mathcal{F}')
('2.0.0', '\\label{eq:PPO-MLE}\n    \\widehat{r} \\leftarrow \\min_{f\\in\\mathcal{F}}-\\frac{1}{n}\\sum_{i=1}^n \\log \\frac{\\exp(f(x_i,y_i^+))}{\\exp(f(x_i,y_i^+)) + \\exp(f(x_i,y_i^-))}.')
('2.0.0', '\\widehat{r}')
('2.0.0', '\\label{eq:PPO}\n    \\widehat{\\pi} \\leftarrow \\max_{\\pi\\in\\Pi} \\mathbb{E}_{x\\sim \\mathcal{D}, y\\sim\\pi(\\cdot|x)}\\left[\\widehat{r}(x,y) - \\alpha D_{\\mathrm{KL}}\\big(\\pi(\\cdot~|~x)~||~\\pi_{\\mathrm{ref}}(\\cdot~|~x)\\big)\\right].')
('2.0.0', '\\pi_{\\mathrm{ref}}')
('2.0.0', '\\alpha')
('2.0.0', '\\widehat{\\pi}')
('2.0.0', '\\pi_{\\mathrm{ref}}')
('2.0.0', '\\label{eq:DPO}\n    \\widehat{\\pi} \\leftarrow \\max_{\\pi\\in\\Pi} \\mathbb{E}_{x\\sim \\mathcal{D}, y\\sim\\pi(\\cdot|x)}\\left[\\widehat{r}(x,y) - \\alpha D_{\\mathrm{KL}}\\big(\\pi(\\cdot~|~x)~||~\\pi_{\\mathrm{ref}}(\\cdot~|~x)\\big)\\right],')
('3', '\\begin{aligned}\n    \\widehat{\\pi} &\\in \\arg\\max_{\\pi} \\mathcal{L}_\\mathcal{D}(\\widehat{f}, \\pi) \\label{eq:stackelberg-policy}\\\\\n    \\text{s.t.}\\ \\widehat{f} &\\in \\arg\\min_{f\\in\\mathcal{F}} \\mathcal{L}_\\mathcal{D}(f, \\pi) + \\lambda\\mathcal{E}_\\mathcal{D}(f), \\label{eq:stackelberg-critic}\n\\end{aligned}')
('3', '\\lambda \\ge 0')
('3', "\\begin{aligned}\n\\label{eq:L-def}\n    \\mathcal{L}_\\mathcal{D}(f, \\pi) := \\frac{1}{n}\\sum_{j=1}^{n}f(x_j,y_j) - f(x_j,y_j'),\n\\end{aligned}")
('3', '\\{x_j\\}_{j=1}^n')
('3', '\\mathcal{D}')
('3', 'j\\in\\{1,\\cdots,n\\}')
('3', "y_j'")
('3', '\\pi_{\\mathrm{ref}}')
('3', 'x_j')
('3', '\\mathcal{D}')
('3', 'y_j \\sim \\pi(\\cdot ~|~ x_j)')
('3', '\\pi')
('3', 'x_j')
('3', '\\begin{aligned}\n\\label{eq:E-def}\n    \\mathcal{E}_\\mathcal{D}(f) := -\\frac{1}{n}\\sum_{i=1}^n \\log \\frac{\\exp(f(x_i,y_i^+))}{\\exp(f(x_i,y_i^+)) + \\exp(f(x_i,y_i^-))},\n\\end{aligned}')
('3', 'f')
('3', '\\mathcal{D}')
('3', '\\pi')
('3', '\\widehat{\\pi}')
('3', '\\widehat{f}')
('3', 'f')
('3', '\\mathcal{F}')
('3', '\\widehat{f}')
('3', '\\widehat{\\pi}')
('3', '\\widehat{f}')
('3', '\\mathcal{D}')
('3', '\\mathcal{D}')
('3', '\\mathcal{D}')
('3', '\\pi_{\\mathrm{init}}')
('3', '\\lambda')
('3', '\\eta')
('3', '\\mathcal{F}')
('3', '\\pi_1 \\leftarrow \\pi_{\\mathrm{init}}')
('3', '\\mathcal{L}_\\mathcal{D}')
('3', '\\mathcal{E}_\\mathcal{D}')
('3', 'f_{t} \\leftarrow \\arg\\min_{f\\in \\mathcal{F}} \\mathcal{L}_\\mathcal{D}(f, \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(f);')
('3', '\\forall (x,y)\\in\\mathcal{X}\\times\\mathcal{Y}')
('3', '\\pi_{t+1}(y~|~x) \\propto \\pi_t(y~|~x)\\exp(f_t(x,y)/\\eta);')
('3', '\\widehat{\\pi} := \\mathrm{Unif}(\\pi_{[1:T]})')
('3', 'f_t')
('3', '\\label{eq:def_dpo_f}\n    f_t(x,y) = \\eta\\log\\frac{\\pi_{t+1}(y|x)}{\\pi_{t}(y|x)} + \\log Z_t(x)')
('3', 'Z_t(x) = \\sum_y\\pi_t(y~|~x)\\exp(f_t(x,y)/\\eta)')
('3', '\\mathcal{F}')
('3', '\\mathcal{F}')
('3', '\\Pi')
('3', "y_j'")
('3', '\\{y_j^+\\}_{j=1}^n')
('3', '\\{y_j^-\\}_{j=1}^n')
('3', '\\mathcal{D}')
('3', "\\log\\frac{\\pi(y_j'|x_j)}{\\pi_t(y_j'|x_j)}")
('3', '\\log\\frac{\\pi(y_j^+|x_j)}{\\pi_t(y_j^+|x_j)}')
('3', '\\log\\frac{\\pi(y_j^-|x_j)}{\\pi_t(y_j^-|x_j)}')
('3', '\\mathcal{D}')
('3', '\\pi_{\\mathrm{init}}')
('3', '\\lambda')
('3', '\\eta')
('3', '\\Pi')
('3', '\\pi_1 \\leftarrow \\pi_{\\mathrm{init}}')
('3', '\\forall j \\in\\{1,\\cdots,n\\}')
('3', 'y_j\\sim\\pi_t(\\cdot~|~ x_j)')
('3', "y_j' = y_j^+")
('3', "\\begin{aligned}\n    \\pi_{t+1} &\\leftarrow \\arg\\min_{\\pi\\in\\Pi} \\frac{1}{n}\\sum_{j=1}^{n}\\eta\\left(\\log\\frac{\\pi(y_j|x_j)}{\\pi_t(y_j|x_j)} - \\log\\frac{\\pi(y_j'|x_j)}{\\pi_t(y_j'|x_j)}\\right) \\\\ & \\qquad\\qquad\\qquad\\qquad \n    - \\frac{\\lambda}{n}\\sum_{i=1}^n \\log\\sigma\\left(\\eta\\log\\frac{\\pi(y_i^+|x_i)}{\\pi_t(y_i^+|x_i)} - \\eta\\log\\frac{\\pi(y_i^-|x_i)}{\\pi_t(y_i^-|x_i)}\\right);\n    \n\\end{aligned}")
('3', '\\widehat{\\pi} := \\mathrm{Unif}(\\pi_{[1:T]})')
('4', 'r^\\star \\in \\mathcal{F}')
('4', 'R > 0')
('4', 'f\\in\\mathcal{F}')
('4', '\\left\\lVert f\\right\\rVert_\\infty \\le R')
('4', '\\mathcal{F}')
('4', '\\Pi')
('4', '\\mathcal{F}')
('4', '\\mathcal{F}')
('4', '\\mathfrak{C}:= \\sqrt{\\sup_{f\\in\\mathcal{F}}\\frac{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi^\\star(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[r^\\star(x,y_1) - r^\\star(x,y_2) - f(x,y_1) + f(x,y_2)\\Big]^2}{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[\\big(r^\\star(x,y_1) - r^\\star(x,y_2) - f(x,y_1) + f(x,y_2)\\big)^2\\Big]}} < \\infty')
('4', '\\mathcal{X}\\times\\mathcal{Y}')
('4', '\\mathcal{F}')
('4', '\\mathcal{F}')
('4', '\\pi^\\star')
('4', '\\begin{aligned}\n    \\mathfrak{C}\\le \\left\\lVert\\frac{\\pi^\\star}{\\pi_{\\mathrm{ref}}}\\right\\rVert_\\infty := \\sup_{x,y}\\frac{\\pi^\\star(y~|~x)}{\\pi_{\\mathrm{ref}}(y~|~x)}.\n\\end{aligned}')
('4', 'n')
('4', '\\mathcal{D}')
('4', 'c_{\\mathrm{KL}} := \\mathbb{E}_{x\\sim\\rho}\\left[D_{\\mathrm{KL}}\\big(\\pi^\\star(\\cdot|x)~||~\\pi_{\\mathrm{init}}(\\cdot|x)\\big)\\right]')
('4', "\\kappa := 1/(\\inf_{z\\in[-R,R]} \\sigma'(z))")
('4', '\\delta \\in (0,1)')
('4', '\\eta = \\Theta(\\sqrt{\\frac{R^2T}{c_{\\mathrm{KL}}}})')
('4', '\\lambda = \\Theta(\\mathfrak{C}\\sqrt{\\frac{n}{\\kappa^2\\log( |\\Pi|/\\delta)}})')
('4', '1-\\delta')
('4', '\\widehat{\\pi}')
('4', '\\begin{aligned}\n        \\mathrm{SubOpt}(\\widehat{\\pi}) \\le \\mathcal O\\left(\\mathfrak{C}\\kappa\\sqrt{\\frac{1}{n}\\log\\frac{|\\Pi|}{\\delta}} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\Pi|}{\\delta}} + R\\sqrt{\\frac{c_{\\mathrm{KL}}}{T}}\\right)\n    \n\\end{aligned}')
('4', 'C_0 > 0')
('4.0', '\\mathcal{D}')
('4.0', '\\begin{aligned}\n    \\mathrm{SubOpt}(\\widehat{\\pi}) &= \\frac{1}{T}\\sum_{t=1}^T\\Big(\\underbrace{\\mathbb{E}_{\\rho\\times\\pi^\\star}\\left[r^\\star(x,y) - f_{t}(x,y)\\right] - \\mathbb{E}_{\\rho\\times\\pi_{\\mathrm{ref}}}\\left[r^\\star(x,y) - f_{t}(x,y)\\right]}_{I_{t,1}}\\notag\\\\ &\\quad + \\underbrace{\\mathbb{E}_{\\rho\\times\\pi^\\star}[f_{t}(x,y)] - \\mathbb{E}_{\\rho\\times\\pi_t}[f_{t}(x,y)]}_{I_{t,2}} + \\underbrace{\\mathbb{E}_{\\rho\\times\\pi_t}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{\\rho\\times\\pi_{\\mathrm{ref}}}[f_{t}(x,y)]}_{I_{t,3}}\\notag\\\\ &\\quad - \\underbrace{\\left(\\mathbb{E}_{\\rho\\times\\pi_t}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{\\rho\\times\\pi_{\\mathrm{ref}}}[r^\\star(x,y)]\\right)}_{I_{t,4}}\\Big).\n\\end{aligned}')
('4.0', 'I_{t,1}')
('4.0', 'I_{t,3}')
('4.0', 'I_{t,4}')
('4.0', 'I_{t,1}')
('4.0', 'r^\\star')
('4.0', 'f_t')
('4.0', 'I_{t,1} \\lesssim \\mathcal{E}_\\mathcal{D}(f_t) - \\mathcal{E}_\\mathcal{D}(r^\\star) + \\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}.')
('4.0', 'I_{t,1}')
('4.0', 'I_{t,4}')
('4.0', '\\mathcal{L}_\\mathcal{D}(f, \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(f)')
('4.0', '\\mathcal{L}_\\mathcal{D}(r^\\star, \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(r^\\star)')
('4.0', 'I_{t,2}')
('4.0', '\\pi_{\\mathrm{init}}')
('4.0', '\\sum_{t=1}^{T}\\mathbb{E}_{\\rho\\times\\pi^\\star}[f_{t}(x,y)] - \\mathbb{E}_{\\rho\\times\\pi_t}[f_{t}(x,y)] \\le \\frac{2R^2T}{\\eta} + \\eta\\mathbb{E}_{x\\sim\\rho}\\Big[D_{\\mathrm{KL}}\\big(\\pi^\\star(\\cdot~|~x)~||~\\pi_{\\mathrm{init}}(\\cdot~|~x)\\big)\\Big].')
('4.0.0', '(x,y)')
('4.0.0', 'f_t')
('4.0.0', '\\pi')
('4.0.0', '\\mathbb{E}_{\\rho\\times\\pi}[f_t] \\le \\mathbb{E}_{\\rho\\times\\pi}[r^\\star]')
('4.0.0.0', '\\lambda \\to \\infty')
('4.0.0.0', '\\mathcal{D}')
('4.0.0.0', '\\lambda')
('4.0.0.0', '0')
('5.0.0.0', 't\\in\\{0,1,2\\}')
('5.0.0.0', '\\pi_t')
('5.0.0.0', 'y_j')
('5.0.0.0', 'x_j')
('5.0.0.0', '\\pi_t')
('5.0.0.0', '\\pi_{t+1}')
('5.0.0.0', '\\lambda = \\Theta(\\mathfrak{C}\\sqrt{n})')
('5.0.0.0', '\\lambda')
('5.0.0.0', '\\begin{aligned}\n    \\pi_{t+1} &\\leftarrow \\arg\\min_{\\pi\\in\\Pi} -\\frac{1}{n}\\sum_{j=1}^{n}\\log\\sigma\\left(\\frac{\\eta}{2}\\log\\frac{\\pi(y_j^+|x_j)}{\\pi_t(y_j^+|x_j)} + \\frac{\\eta}{2}\\log\\frac{\\pi(y_j^-|x_j)}{\\pi_t(y_j^-|x_j)} - \\eta\\log\\frac{\\pi(y_j|x_j)}{\\pi_t(y_j|x_j)}\\right) \\notag \\\\ & \\qquad\\qquad\\qquad\\qquad \n    - \\frac{\\lambda}{n}\\sum_{i=1}^n \\log\\sigma\\left(\\eta\\log\\frac{\\pi(y_i^+|x_i)}{\\pi_t(y_i^+|x_i)} - \\eta\\log\\frac{\\pi(y_i^-|x_i)}{\\pi_t(y_i^-|x_i)}\\right).\n\\end{aligned}')
('5.0.0.0', '\\lambda')
('5.0.0.0', '1.0')
('5.0.0.1', '\\beta')
('5.0.0.1', '\\beta')
('6', '\\widetilde{O}(\\sqrt{1/n}+\\sqrt{1/T})')
('7.0', '5e')
('7.0', '7')
('7.0', '5\\%')
('7.0', '\\beta = 0.1')
('7.0', '\\lambda = 1.0')
('8', 'p_1(\\cdot)')
('8', 'p_2(\\cdot)')
('8', 'P_1')
('8', 'P_2')
('8', 'p_1')
('8', 'p_2')
('8', 'D_{\\mathrm{TV}}(P_1, P_2) = \\frac{1}{2}\\int_z |p_1(z) - p_2(z)| \\mathrm{d} z,')
('8', 'P_1')
('8', 'P_2')
('8', 'p_1')
('8', 'p_2')
('8', 'D_{\\mathrm{KL}}(P_1 ~||~ P_2) = -\\int_z p_1(z)\\log\\frac{p_1(z)}{p_2(z)} \\mathrm{d} z.')
('8', 'f:\\Omega \\to \\mathbb{R}')
('8', '\\Omega')
('8', "z,z'\\in\\Omega")
('8', 'f')
('8', "B_{f}(z,z') := f(z) - f(z') - \\langle\\nabla f(z'), z - z'\\rangle.")
('8', 'v')
('8', 'A')
('8', '\\left\\lVert v\\right\\rVert_{A}')
('8', 'v')
('8', 'A')
('8', '\\left\\lVert v\\right\\rVert_{A} = \\sqrt{v^\\top A v}')
('8', 'f\\in\\mathcal{F}')
('8', 'P_f(y^+\\succ y^-~|~ x) := \\frac{\\exp(f(x,y^+))}{\\exp(f(x,y^+)) + \\exp(f(x,y^-))}.')
('8', 'C > 0')
('8', 'f(\\mathcal{X}) \\le Cg(\\mathcal{X})')
('8', '\\mathcal{X}')
('8', 'f(\\mathcal{X}) \\lesssim g(\\mathcal{X})')
('8', 'g(\\mathcal{X}) \\gtrsim f(\\mathcal{X})')
('8', 'f(\\mathcal{X}) \\lesssim g(\\mathcal{X})')
('9', '\\mathcal{F}_0\\subset \\mathcal{F}_1 \\subset \\mathcal{F}_2 \\subset \\cdots')
('9', '\\mathbb{E}_{i}')
('9', '\\mathcal{F}_i')
('9', 'Y_{n}=\\sum_{i=1}^{n}X_{i}\\in\\mathbb{R}')
('9', '\\{X_{i}\\}')
('9', '\\left|X_{i}\\right|\\leq R\\qquad\\text{and}\\qquad\\mathbb{E}_{i-1} \\big[X_{i}\\big]=0\\quad\\quad\\quad\\text{for all }i\\ge 1')
('9', 'R<\\infty')
('9', '1-\\delta')
('9', '\\left|Y_{n}\\right|\\leq \\sqrt{R^2n\\log\\frac{1}{\\delta}}.\\label{eq:hoeffding}')
('10', '\\widehat{\\pi}')
('10', '\\begin{aligned}\n        \\mathrm{SubOpt}(\\widehat{\\pi}) &= \\frac{1}{T}\\sum_{t=1}^{T}\\mathbb{E}_{x\\sim\\rho}\\Big[\\big\\langle\\pi^\\star(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), r^\\star(x,\\cdot)\\big\\rangle\\Big] \\notag\\\\\n        &= \\frac{1}{T}\\sum_{t=1}^{T}\\Big(\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[r^\\star(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[r^\\star(x,y)]\\Big)\\notag\\\\\n        &= \\frac{1}{T}\\sum_{t=1}^{T}\\mathrm{SubOpt}(\\pi_t).\n    \n\\end{aligned}')
('10', '\\mathrm{SubOpt}(\\pi_t)')
('10', 't=1,\\cdots,T')
('10', '\\begin{aligned}\n        \\mathrm{SubOpt}(\\pi_t) &= \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[r^\\star(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[r^\\star(x,y)]\\notag\\\\\n        &= \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}\\left[r^\\star(x,y) - f_{t}(x,y)\\right] + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)]\\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y) - r^\\star(x,y)\\right]\\notag\\\\\n        &= \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}\\left[r^\\star(x,y) - f_{t}(x,y)\\right] + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)]\\notag\\\\ &\\quad - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[r^\\star(x,y) - f_{t}(x,y)\\right]\\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)]\\notag\\\\ &\\quad - \\left(\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\right)\\notag\\\\\n        &= \\underbrace{\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}\\left[r^\\star(x,y) - f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[r^\\star(x,y) - f_{t}(x,y)\\right]}_{I_{t,1}}\\notag\\\\ &\\quad + \\underbrace{\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)]}_{I_{t,2}}\\notag\\\\ &\\quad + \\underbrace{\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)]}_{I_{t,3}}\\notag\\\\ &\\quad - \\underbrace{\\left(\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\right)}_{I_{t,4}}. \\label{eq:decomp}\n    \n\\end{aligned}')
('10', 'I_{t,1}')
('10', 'Z(x,y_1,y_2;r^\\star,f_{t}) := r^\\star(x,y_1) - r^\\star(x,y_2) - f_{t}(x,y_1) + f_{t}(x,y_2)')
('10', '\\begin{aligned}\n        I_{t,1} &= \\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi^\\star(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[r^\\star(x,y_1) - r^\\star(x,y_2) - f_{t}(x,y_1) + f_{t}(x,y_2)\\right]\\notag\\\\\n        &= \\sqrt{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\left[Z^2(x,y_1,y_2;r^\\star,f_{t})\\right]\\frac{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi^\\star(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\left[Z(x,y_1,y_2;r^\\star,f_{t})\\right]^2}{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\left[Z^2(x,y_1,y_2;r^\\star,f_{t})\\right]}}\\notag\\\\\n        &\\le \\sqrt{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\left[Z^2(x,y_1,y_2;r^\\star,f_{t})\\right]\\sup_{f\\in\\mathcal{F}}\\frac{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi^\\star(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\left[Z(x,y_1,y_2;r^\\star,f)\\right]^2}{\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\left[Z^2(x,y_1,y_2;r^\\star,f)\\right]}}\\notag\\\\\n        &\\le \\sqrt{\\mathfrak{C}^2\\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x), y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[Z^2(x,y_1,y_2;r^\\star,f_{t})\\right]}\\notag\\\\\n        &\\le \\sqrt{\\frac{\\mathfrak{C}^4}{2\\lambda^2} + \\frac{\\lambda^2}{2}\\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x), y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[Z^2(x,y_1,y_2;r^\\star,f_{t})\\right]^2}\\notag\\\\\n        &\\le \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[\\big(r^\\star(x,y_1) - r^\\star(x,y_2) - f_{t}(x,y_1) + f_{t}(x,y_2)\\big)^2\\right],\n    \n\\end{aligned}')
('10', '\\frac{a^2}{2} + \\frac{b^2}{2} \\ge ab')
('10', 'a = \\mathfrak{C}^2/\\lambda')
('10', 'b = \\lambda\\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x), y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[Z^2(x,y_1,y_2;r^\\star,f_{t})\\right]')
('10', 'I_{t,3}')
('10', 'I_{t,1}')
('10', '\\begin{aligned}\n        &\\quad\\ I_{t,1} + I_{t,3} \\notag\\\\\n        &\\le \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[\\big(r^\\star(x,y_1) - r^\\star(x,y_2) - f_{t}(x,y_1) + f_{t}(x,y_2)\\big)^2\\right]\\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)] \\label{eq:I1+I3-1}\\\\\n        &\\overset{(\\mathrm{i})}{\\lesssim} \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\mathcal{E}_\\mathcal{D}(f_t) - \\lambda\\mathcal{E}_\\mathcal{D}(r^\\star) + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}\\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)] \\label{eq:I1+I3-2}\\\\\n        &= \\frac{\\mathfrak{C}^2}{\\lambda} + \\mathcal{L}_\\mathcal{D}(f_t) + \\lambda\\mathcal{E}_\\mathcal{D}(f_t) - \\mathcal{L}_\\mathcal{D}(r^\\star) - \\lambda\\mathcal{E}_\\mathcal{D}(r^\\star) + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}\\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)] - \\mathcal{L}_\\mathcal{D}(f_t)\\notag\\\\ &\\quad + \\mathcal{L}_\\mathcal{D}(r^\\star) - \\Big(\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\Big)\n        \\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\n        \\label{eq:I1+I3-3}\\\\\n        &\\overset{(\\mathrm{ii})}{\\le} \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta} + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)] - \\mathcal{L}_\\mathcal{D}(f_t)\\notag\\\\ &\\quad + \\mathcal{L}_\\mathcal{D}(r^\\star) - \\Big(\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\Big)\n        \\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\n        \\notag\\\\\n        &\\overset{(\\mathrm{iii})}{\\lesssim} \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta} + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)] - \\mathcal{L}_\\mathcal{D}(f_t)\\notag\\\\ &\\quad + R\\sqrt{\\frac{1}{n}\\log\\frac{1}{\\delta}} + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\n        \\notag\\\\\n        &\\overset{(\\mathrm{iv})}{\\lesssim} \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} + R\\sqrt{\\frac{1}{n}\\log\\frac{1}{\\delta}}\\notag\\\\ &\\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\notag\\\\\n        &\\lesssim \\frac{\\mathfrak{C}^2}{\\lambda} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]. \\label{eq:I1+I3-f}\n    \n\\end{aligned}')
('10', '\\mathcal{L}_\\mathcal{D}(f_{t}, \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(f_{t}) = \\min_{f\\in\\mathcal{F}} \\mathcal{L}_\\mathcal{D}(f, \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(f)')
('10', "\\mathcal{L}_\\mathcal{D}(f_{t}, \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(f_{t}) \\le \\mathcal{L}_\\mathcal{D}(f', \\pi_t) + \\lambda \\mathcal{E}_\\mathcal{D}(f')")
('10', "f'\\in\\mathcal{F}")
('10', '1-\\delta/3')
('10', '\\begin{aligned}\n        &\\quad\\ \\mathcal{L}_\\mathcal{D}(r^\\star) - \\Big(\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\Big) \\notag\\\\\n        &= \\left(\\frac{1}{n}\\sum_{j=1}^{n}r^\\star(x_j,y_j) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right]\\right) - \\left(\\frac{1}{n}\\sum_{j=1}^{n}r^\\star(x_j,y_j^+) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[r^\\star(x,y)\\right]\\right) \\notag\\\\\n        &\\le \\left|\\frac{1}{n}\\sum_{j=1}^{n}r^\\star(x_j,y_j) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right]\\right| + \\left|\\frac{1}{n}\\sum_{j=1}^{n}r^\\star(x_j,y_j^+) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[r^\\star(x,y)\\right]\\right| \\notag\\\\\n        &\\lesssim R\\sqrt{\\frac{1}{n}\\log\\frac{1}{\\delta}}.\n    \n\\end{aligned}')
('10', 'f\\in\\mathcal{F}')
('10', 'f\\in\\mathcal{F}')
('10', '1-\\delta/3')
('10', '\\begin{aligned}\n        &\\quad\\ \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[f_{t}(x,y)] - \\mathcal{L}_\\mathcal{D}(f_t)\\notag\\\\\n        &= \\left(\\frac{1}{n}\\sum_{j=1}^{n}f_{t}(x_j,y_j^+) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[f_{t}(x,y)\\right]\\right) - \\left(\\frac{1}{n}\\sum_{j=1}^{n}f_{t}(x_j,y_j) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right]\\right) \\notag\\\\\n        &\\le \\left|\\frac{1}{n}\\sum_{j=1}^{n}f_{t}(x_j,y_j^+) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[f_{t}(x,y)\\right]\\right| - \\left|\\frac{1}{n}\\sum_{j=1}^{n}f_{t}(x_j,y_j) - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[f_{t}(x,y)\\right]\\right| \\notag\\\\\n        &\\lesssim R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}}.\n    \n\\end{aligned}')
('10', '\\begin{aligned}\n        \\mathrm{SubOpt}(\\pi_t) &\\lesssim \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)]\\notag\\\\ & \\quad + \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)]\\notag\\\\ & \\quad - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}\\left[r^\\star(x,y)\\right] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}[r^\\star(x,y)] \\notag\\\\ \\ & \\quad + \\frac{\\mathfrak{C}^2}{\\lambda} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}\\notag\\\\\n        &= \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)] \\notag\\\\ \\ & \\quad + \\frac{\\mathfrak{C}^2}{\\lambda} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}. \\label{eq:decomp-1}\n    \n\\end{aligned}')
('10', 'I_{t,2}')
('10', '\\begin{aligned}\n        \\sum_{t=1}^{T}I_{t,2} &= \\sum_{t=1}^{T}\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)] \\notag\\\\\n        &= \\sum_{t=1}^{T}\\mathbb{E}_{x\\sim\\rho}\\Big[\\big\\langle\\pi^\\star(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\Big]\\notag\\\\\n        &\\le \\frac{2R^2T}{\\eta} + \\eta\\mathbb{E}_{x\\sim\\rho}\\Big[D_{\\mathrm{KL}}\\big(\\pi^\\star(\\cdot~|~x)~||~\\pi_{\\mathrm{init}}(\\cdot~|~x)\\big)\\Big] \\notag\\\\\n        &\\lesssim R\\sqrt{\\mathbb{E}_{x\\sim\\rho}\\Big[D_{\\mathrm{KL}}\\big(\\pi^\\star(\\cdot~|~x)~||~\\pi_{\\mathrm{init}}(\\cdot~|~x)\\big)\\Big]\\cdot T}, \\label{eq:I_2}\n    \n\\end{aligned}')
('10', '\\eta')
('10', '\\lambda')
('10', '\\begin{aligned}\n        \\mathrm{SubOpt}(\\widehat{\\pi}) &= \\frac{1}{T}\\sqrt{\\mathbb{E}_{x\\sim\\rho}\\Big[D_{\\mathrm{KL}}\\big(\\pi^\\star(\\cdot~|~x)~||~\\pi_{\\mathrm{init}}(\\cdot~|~x)\\big)\\Big]\\cdot T} + \\frac{\\mathfrak{C}^2}{\\lambda} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} + \\lambda\\frac{\\kappa^2}{n}\\log\\frac{|\\mathcal{F}|}{\\delta} \\notag\\\\\n        &\\lesssim R\\sqrt{\\frac{\\mathbb{E}_{x\\sim\\rho}\\Big[D_{\\mathrm{KL}}\\big(\\pi^\\star(\\cdot~|~x)~||~\\pi_{\\mathrm{init}}(\\cdot~|~x)\\big)\\Big]}{T}} + \\mathfrak{C}\\kappa\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} + R\\sqrt{\\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}} .\n    \n\\end{aligned}')
('10', '\\log|\\mathcal{F}|')
('10', '\\log|\\Pi|')
('10.0', 'I_{t,1}')
('10.0', 'f \\in \\mathcal{F}')
('10.0', 'R > 0')
('10.0', '0< \\delta < 1')
('10.0', '1-\\delta')
('10.0', '\\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[\\big(r^\\star(x,y_1) - r^\\star(x,y_2) - f(x,y_1) + f(x,y_2)\\big)^2\\right] \\lesssim \\frac{\\kappa^2}{n}\\log \\frac{|\\mathcal{F}|}{\\delta}')
('10.0', 'f\\in\\mathcal{F}')
('10.0', '\\begin{aligned}\n        &\\quad\\\n        \\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[D_{\\mathrm{TV}}\\big(P_f(\\cdot ~|~ x,y_1,y_2), P(\\cdot ~|~ x,y_1,y_2)\\big)^2\\Big] \\notag\\\\\n        &\\lesssim \\frac{1}{n}\\sum_{i=1}^n\\log\\frac{ P(y_i^+\\succ y_i^-~|~ x_i)}{P_f(y_i^+\\succ y_i^-~|~ x_i)} + \\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}\\notag\\\\\n        &\\lesssim \\frac{1}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}.\n    \n\\end{aligned}')
('10.0', 'P(y^+\\succ y^-~|~ x) = \\sigma(r^\\star(x,y^+) - r^\\star(x,y^-))')
('10.0', 'f\\in\\mathcal{F}')
('10.0', 'P_f(y^+\\succ y^-~|~ x) = \\sigma(f(x,y^+) - f(x,y^-)).')
('10.0', 'r^\\star(x,y_1) - r^\\star(x,y_2)')
('10.0', 'f(x,y_1) - f(x,y_2)')
('10.0', "\\kappa^2 = 1/(\\inf_{z\\in[-R,R]} \\sigma'(z))^2")
('10.0', '\\begin{aligned}\n        &\\quad\\ \\mathbb{E}_{x\\sim\\rho, y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x),y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}\\left[\\big(r^\\star(x,y_1) - r^\\star(x,y_2) - f(x,y_1) + f(x,y_2)\\big)^2\\right] \\notag\\\\\n        &\\lesssim \\kappa^2\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\bigg[\\Big(\\left|P_f(y_1\\succ y_2 ~|~ x) - P(y_1 \\succ y_2 ~|~ x)\\right| + \\left|P_f(y_1 \\prec y_2 ~|~ x) - P(y_1 \\prec y_2 ~|~ x)\\right|\\Big)^2\\bigg]\\\\\n        &= 2\\kappa^2\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[D_{\\mathrm{TV}}\\big(P_f(\\cdot ~|~ x,y_1,y_2), P(\\cdot ~|~ x,y_1,y_2)\\big)^2\\Big] \\notag\\\\\n        &\\lesssim \\frac{\\kappa^2}{n}\\log \\frac{|\\mathcal{F}|}{\\delta},\n    \n\\end{aligned}')
('10.0.0', '0< \\delta < 1')
('10.0.0', '1-\\delta')
('10.0.0', '\\sum_{i=1}^n\\log\\frac{ P_f(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)} \\le \\log \\frac{|\\mathcal{F}|}{\\delta} %N_{[]}(1/n,\\cF,L_1)')
('10.0.0', 'f\\in\\mathcal{F}')
('10.0.0', 'g\\in\\mathcal{F}')
('10.0.0', '\\begin{aligned}\n        &\\quad\\ \\mathbb{E}\\left[\\exp\\left(\\sum_{i=1}^n\\log\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)}\\right)\\right]\\notag\\\\\n        &\\overset{(\\mathrm{i})}{=} \\prod_{i=1}^n\\mathbb{E}\\left[\\exp\\left(\\log\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)}\\right)\\right]\\notag\\\\\n        &= \\prod_{i=1}^n\\mathbb{E}\\left[\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)}\\right]\\notag\\\\\n        &\\overset{(\\mathrm{ii})}{=}  \\prod_{i=1}^n\\mathbb{E}\\Bigg[\\mathbb{E}\\bigg[\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)}~|~ (x_i,y_i^+,y_i^-)\\bigg]\\Bigg]\\notag\\\\\n        &= \\prod_{i=1}^n\\mathbb{E}\\left[ P_g(y_i^+\\succ y_i^-~|~ x_i) + P_g(y_i^+\\prec y_i^-~|~ x_i)\\right] = 1.\n    \n\\end{aligned}')
('10.0.0', '\\mathcal{D}')
('10.0.0', '\\begin{aligned}\n        &\\quad\\ \\mathbb{P}\\left[\\sum_{i=1}^n\\log\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)} > \\log\\frac{1}{\\delta}\\right] \\notag\\\\\n        &\\le \\mathbb{E}\\left[\\exp\\left(\\sum_{i=1}^n\\log\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)}\\right)\\right]\\exp\\left(-\\log\\frac{1}{\\delta}\\right) \\le \\delta.\n    \n\\end{aligned}')
('10.0.0', 'g\\in \\mathcal{F}')
('10.0.0', '\\begin{aligned}\n        \\mathbb{P}\\left[\\sum_{i=1}^n\\log\\frac{ P_g(y_i^+\\succ y_i^-~|~ x_i)}{P(y_i^+\\succ y_i^-~|~ x_i)} > \\log\\frac{|\\mathcal{F}|}{\\delta}\\right] \\le \\delta.\n    \n\\end{aligned}')
('10.0.1', '\\mathcal{D}')
('10.0.1', "\\mathcal{D}= \\{(x_i,y_i,y_i',o_i)\\}_{i=1}^n")
('10.0.1', 'o_i')
('10.0.1', 'y_i')
('10.0.1', "y_i'")
('10.0.1', 'x_i')
('10.0.1', 'o_i = +')
('10.0.1', "y_i \\succ y_i' ~|~ x_i")
('10.0.1', 'o_i = -')
('10.0.1', 'P(+ ~|~ x,y_1,y_2) = P(y_1 \\succ y_2 ~|~ x)')
('10.0.1', 'P(- ~|~ x,y_1,y_2) = P(y_1 \\prec y_2 ~|~ x)')
('10.0.1', 'P_f(+ ~|~ x,y_1,y_2) = P_f(y_1 \\succ y_2 ~|~ x)')
('10.0.1', 'P_f(- ~|~ x,y_1,y_2) = P_f(y_1 \\prec y_2 ~|~ x)')
('10.0.1', '0< \\delta < 1')
('10.0.1', '1-\\delta')
('10.0.1', '\\begin{aligned}\n        &\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[D_{\\mathrm{TV}}\\big(P_f(\\cdot ~|~ x,y_1,y_2), P(\\cdot ~|~ x,y_1,y_2)\\big)^2\\Big] \\lesssim \\frac{1}{n}\\left(\\sum_{i=1}^n\\log\\frac{ P(y_i^+\\succ y_i^-~|~ x_i)}{P_f(y_i^+\\succ y_i^-~|~ x_i)} + \\log\\frac{|\\mathcal{F}|}{\\delta}\\right)\n    \n\\end{aligned}')
('10.0.1', 'f\\in\\mathcal{F}')
('10.0.1', "\\begin{aligned}\n        &\\quad\\ \\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[D_{\\mathrm{TV}}\\big(P_f(\\cdot ~|~ x,y_1,y_2), P(\\cdot ~|~ x,y_1,y_2)\\big)^2\\Big] \\notag\\\\\n        &\\le -2\\log\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y'\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ o\\sim P(y \\succ y' | x)}}\\left[\\exp\\left(-\\frac{1}{2}\\log\\frac{ P(o ~|~ x,y,y')}{P_f(o ~|~ x,y,y')}\\right)\\right]. \\label{eq:MLE-TV-1}\n    \n\\end{aligned}")
('10.0.1', "\\widetilde{\\mathcal{D}} = \\{(\\widetilde{x}_i, \\widetilde{y}_i, \\widetilde{y}_i', \\widetilde{o}_i)\\}")
('10.0.1', '\\mathcal{D}')
('10.0.1', "\\begin{aligned}\n        &\\quad\\ -\\log\\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y'\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ o\\sim P(y \\succ y' | x)}}\\left[\\exp\\left(-\\frac{1}{2}\\log\\frac{ P(o ~|~ x,y,y')}{P_f(o ~|~ x,y,y')}\\right)\\right] \\notag\\\\\n        &= -\\frac{1}{n}\\sum_{i=1}^n\\log  \\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y'\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ o\\sim P(y \\succ y' | x)}}\\left[\\exp\\left(-\\frac{1}{2}\\log\\frac{ P(o ~|~ x,y,y')}{P_f(o ~|~ x,y,y')}\\right)\\right]\\notag\\\\\n        &= -\\frac{1}{n}\\log  \\mathbb{E}_{\\widetilde{\\mathcal{D}}}\\left[\\exp\\left(-\\frac{1}{2}\\sum_{i=1}^n\\log\\frac{ P(\\widetilde{o}_i ~|~ \\widetilde{x}_i, \\widetilde{y}_i, \\widetilde{y}_i')}{P_f(\\widetilde{o}_i ~|~ \\widetilde{x}_i, \\widetilde{y}_i, \\widetilde{y}_i')}\\right) ~|~ \\mathcal{D}\\right],\\label{eq:MLE-TV-2}\n    \n\\end{aligned}")
('10.0.1', '\\mathcal{D}')
('10.0.1', '\\widetilde{\\mathcal{D}}')
('10.0.1', "\\ell\\big(f,(x,y,y',o)\\big) := -\\frac{1}{2}\\log\\frac{ P(o ~|~ x,y,y')}{P_f(o ~|~ x,y,y')}")
('10.0.1', "\\begin{aligned}\n        \\mathbb{E}_{\\mathcal{D}}\\left[\\exp\\left(\\sum_{i=1}^n \\ell\\big(f,(x_i, y_i, y_i', o_i)\\big) - \\log \\mathbb{E}_{\\widetilde{\\mathcal{D}}} \\left[\\exp\\left(\\sum_{i=1}^n\\ell\\big(f,(\\widetilde{x}_i, \\widetilde{y}_i, \\widetilde{y}_i', \\widetilde{o}_i)\\big)\\right) ~|~ \\mathcal{D}\\right] - \\log|\\mathcal{F}|\\right)\\right] \\le 1. \\notag\n    \n\\end{aligned}")
('10.0.1', 'f\\in\\mathcal{F}')
('10.0.1', '1-\\delta')
('10.0.1', "\\begin{aligned}\n        -\\log \\mathbb{E}_{\\widetilde{\\mathcal{D}}} \\left[\\exp\\left(\\sum_{i=1}^n\\ell\\big(f,(\\widetilde{x}_i, \\widetilde{y}_i, \\widetilde{y}_i', \\widetilde{o}_i)\\big)\\right) ~|~ \\mathcal{D}\\right] \\le -\\sum_{i=1}^n \\ell\\big(f,(x_i, y_i, y_i', o_i)\\big) + 2\\log\\frac{|\\mathcal{F}|}{\\delta}. \\label{eq:MLE-TV-3}\n    \n\\end{aligned}")
('10.0.1', '1-\\delta')
('10.0.1', "\\begin{aligned}\n        &\\quad\\ \\mathbb{E}_{\\substack{x\\sim\\rho\\\\ y_1\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)\\\\ y_2\\sim\\pi_{\\mathrm{ref}}(\\cdot|x)}}\\Big[D_{\\mathrm{TV}}\\big(P_f(\\cdot ~|~ x,y_1,y_2), P(\\cdot ~|~ x,y_1,y_2)\\big)^2\\Big] \\notag\\\\\n        &\\le -\\frac{2}{n}\\sum_{i=1}^n \\ell\\big(f,(x_i, y_i, y_i', o_i)\\big) + \\frac{4}{n}\\log\\frac{|\\mathcal{F}|}{\\delta} \\notag\\\\\n        &= -\\frac{1}{n}\\sum_{i=1}^n \\log\\frac{ P(o_i ~|~ x_i, y_i, y_i')}{P_f(o_i ~|~ x_i, y_i, y_i')} + \\frac{4}{n}\\log\\frac{|\\mathcal{F}|}{\\delta}\\\\\n        &= -\\frac{1}{n}\\sum_{i=1}^n \\log\\frac{ P(y_i^+\\succ y_i^-~|~ x_i)}{P_f(y_i^+\\succ y_i^-~|~ x_i)} + \\frac{4}{n}\\log\\frac{|\\mathcal{F}|}{\\delta},\n    \n\\end{aligned}")
('10.1', 'I_{t,2}')
('10.1', 'I_{t,2}')
('10.1', '\\sum_{t=1}^{T}I_{t,2} = \\sum_{t=1}^{T}\\mathbb{E}_{x\\sim\\rho, y\\sim\\pi^\\star(\\cdot|x)}[f_{t}(x,y)] - \\mathbb{E}_{x\\sim\\rho, y\\sim\\pi_t(\\cdot|x)}[f_{t}(x,y)].')
('10.1.0', '\\begin{aligned}\n    \\ell_x(\\pi) &:= \\eta D_{\\mathrm{KL}}\\big(\\pi(\\cdot|x) ~||~ \\pi_{\\mathrm{ref}}(\\cdot|x)\\big) \\notag\\\\\n    &= \\eta\\sum_{y\\in\\mathcal{Y}}\\pi(y~|~x)\\log\\pi(y~|~x) - \\eta\\sum_{y\\in\\mathcal{Y}}\\pi(y~|~x)\\log\\pi_{\\mathrm{ref}}(y~|~x). \\notag\n\\end{aligned}')
('10.1.0', '\\pi:\\mathcal{X}\\to\\Delta(\\mathcal{Y})')
('10.1.0', 'x\\in\\mathcal{X}')
('10.1.0', '\\begin{aligned}\n        \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi) \\le \\sum_{t=1}^{T}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1).\n    \n\\end{aligned}')
('10.1.0', 'T=0')
('10.1.0', "T = T'")
('10.1.0', '\\pi')
('10.1.0', 'x\\in\\mathcal{X}')
('10.1.0', "\\begin{aligned}\n        &\\quad\\ \\sum_{t=1}^{T'+1}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1) \\notag\\\\\n        &\\overset{(\\mathrm{i})}{\\le} \\sum_{t=1}^{T'+1}\\big\\langle\\pi_{T'+2}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_{T'+2}) \\notag\\\\\n        &= \\sum_{t=1}^{T'}\\big\\langle\\pi_{T'+2}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_{T'+2}) + \\big\\langle\\pi_{T'+2}(\\cdot ~|~ x), f_{T'+1}(x,\\cdot)\\big\\rangle \\notag\\\\\n        &\\overset{(\\mathrm{ii})}{\\le} \\sum_{t=1}^{T'}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1) + \\big\\langle\\pi_{T'+2}(\\cdot ~|~ x), f_{T'+1}(x,\\cdot)\\big\\rangle \\notag\\\\\n        &= \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x), f_t(x,\\cdot)\\rangle - \\ell_x(\\pi),\n    \n\\end{aligned}")
('10.1.0', "\\pi_{T'+2}")
('10.1.0', "\\sum_{t=1}^{T'+1}\\big\\langle\\pi(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi)")
('10.1.1', '\\pi:\\mathcal{X}\\to\\Delta(\\mathcal{Y})')
('10.1.1', 'x\\in\\mathcal{X}')
('10.1.1', '\\begin{aligned}\n        \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\le \\sum_{t=1}^{T}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1) + \\ell_x(\\pi). \\notag\n    \n\\end{aligned}')
('10.1.1', '\\begin{aligned}\n        &\\quad\\ \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\notag\\\\\n        &= \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi) + \\ell_x(\\pi) - \\sum_{t=1}^{T}\\big\\langle\\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\notag\\\\\n        &\\le \\sum_{t=1}^{T}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1) - \\sum_{t=1}^{T}\\big\\langle\\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle + \\ell_x(\\pi) \\notag\\\\\n        &= \\sum_{t=1}^{T}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1) + \\ell_x(\\pi),\n    \n\\end{aligned}')
('10.1.1', '\\ell_x(\\cdot)')
('10.1.2', '\\pi:\\mathcal{X}\\to\\Delta(\\mathcal{Y})')
('10.1.2', 'x\\in\\mathcal{X}')
('10.1.2', '\\begin{aligned}\n        \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\le 2\\eta R^2T + \\frac{1}{\\eta}D_{\\mathrm{KL}}\\big(\\pi(\\cdot~|~x)~||~\\pi_{\\mathrm{ref}}(\\cdot~|~x)\\big).\n    \n\\end{aligned}')
('10.1.2', "L_{x,t}(\\pi) := \\sum_{t'=1}^{t}\\big\\langle\\pi(\\cdot ~|~ x), f_{t'}(x,\\cdot)\\big\\rangle - \\ell_x(\\pi).")
('10.1.2', 'L_{x,t}(\\cdot)')
('10.1.2', 'B_{L_{x,t}}(\\cdot||\\cdot)')
('10.1.2', '\\ell_{x}(\\cdot)')
('10.1.2', 'B_{\\ell_{x}}(\\cdot||\\cdot)')
('10.1.2', '\\begin{aligned}\n        L_{x,t}(\\pi_t) &= L_{x,t}(\\pi_{t+1}) + \\big\\langle\\pi_t(\\cdot ~|~ x) - \\pi_{t+1}(\\cdot ~|~ x), \\nabla L_{x,t}(\\pi)|_{\\pi=\\pi_{t+1}}\\big\\rangle + B_{L_{x,t}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x)) \\notag\\\\\n        &\\le L_{x,t}(\\pi_{t+1}) + B_{L_{x,t}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x))\\notag\\\\\n        &= L_{x,t}(\\pi_{t+1}) - B_{\\ell_{x}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x)) \n    \n\\end{aligned}')
('10.1.2', '\\pi_{t+1}')
('10.1.2', 'L_{x,t}(\\cdot)')
('10.1.2', 'L_{x,t}(\\pi) + \\ell_{x}(\\pi)')
('10.1.2', '\\pi')
('10.1.2', '\\begin{aligned}\n        B_{\\ell_{x}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x)) &\\le L_{x,t}(\\pi_{t+1}) - L_{x,t}(\\pi_{t}) \\notag\\\\\n        &= L_{x,t-1}(\\pi_{t+1}) - L_{x,t-1}(\\pi_{t}) + \\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\notag\\\\\n        &\\le \\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle, \\label{eq:no-regret-3-2}\n    \n\\end{aligned}')
('10.1.2', '\\pi_{t}')
('10.1.2', 'L_{x,t-1}(\\cdot)')
('10.1.2', 'B_{\\ell_{x}}')
('10.1.2', "\\begin{aligned}\n        B_{\\ell_{x}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x)) &= \\frac{1}{2}\\|\\pi_t(\\cdot ~|~ x) - \\pi_{t+1}(\\cdot ~|~ x)\\|^2_{\\nabla^2_\\pi\\ell_x (\\pi_{t}')}, \\label{eq:no-regret-3-1}\n    \n\\end{aligned}")
('10.1.2', "\\pi_t' := \\alpha\\pi_t + (1-\\alpha)\\pi_{t+1}")
('10.1.2', '\\alpha\\in[0,1]')
('10.1.2', "\\nabla^2_\\pi\\ell_x (\\pi_{t}')")
('10.1.2', '\\ell_x(\\pi)')
('10.1.2', '\\pi')
('10.1.2', "\\pi_{t}'")
('10.1.2', "\\begin{aligned}\n        &\\quad\\ \\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\notag\\\\\n        &\\le \\|\\pi_t(\\cdot ~|~ x) - \\pi_{t+1}(\\cdot ~|~ x)\\|_{\\nabla^2_\\pi\\ell_x (\\pi_{t}')}\\|f_t(x,\\cdot)\\|_{(\\nabla^2_\\pi\\ell_x)^{-1} (\\pi_{t}')} \\notag\\\\\n        &\\overset{\\mathrm{(i)}}{=} \\sqrt{2 B_{\\ell_{x}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x))}\\|f_t(x,\\cdot)\\|_{(\\nabla^2_\\pi\\ell_x)^{-1} (\\pi_{t}')} \\notag\\\\\n        &\\le \\sqrt{\\frac{2}{\\eta}B_{\\ell_{x}}(\\pi_{t}(\\cdot | x) ~||~ \\pi_{t+1}(\\cdot | x))}\\|f_t(x,\\cdot)\\|_{\\infty} \\notag\\\\\n        &\\overset{\\mathrm{(ii)}}{\\le} \\sqrt{\\frac{2}{\\eta}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle}\\|f_t(x,\\cdot)\\|_{\\infty} \\notag\\\\\n        &\\overset{\\mathrm{(iii)}}{\\le}  R\\sqrt{\\frac{2}{\\eta}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle},\n    \n\\end{aligned}")
('10.1.2', '\\begin{aligned}\n        \\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\le \\frac{2R^2}{\\eta}. \\label{eq:no-regret-3-3}\n    \n\\end{aligned}')
('10.1.2', '\\begin{aligned}\n        &\\quad\\ \\sum_{t=1}^{T}\\big\\langle\\pi(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle \\notag\\\\\n        &\\le \\sum_{t=1}^{T}\\big\\langle\\pi_{t+1}(\\cdot ~|~ x) - \\pi_{t}(\\cdot ~|~ x), f_t(x,\\cdot)\\big\\rangle - \\ell_x(\\pi_1) + \\ell_x(\\pi)\\notag\\\\\n        &\\le \\frac{2R^2T}{\\eta} + \\eta D_{\\mathrm{KL}}\\big(\\pi(\\cdot~|~x)~||~\\pi_{\\mathrm{ref}}(\\cdot~|~x)\\big),\n    \n\\end{aligned}')
