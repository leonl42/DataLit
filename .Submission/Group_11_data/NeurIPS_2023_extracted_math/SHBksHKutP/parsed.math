('1', '\\xi')
('1', '\\label{problem:conditional_bilevel_optimization}\n\\begin{aligned}\n\\min_{x\\in\\mathbb{R}^{d_x}} \\quad & F(x):=\\mathbb{E}_{\\xi\\sim \\mathbb{P}_{\\xi}, \\eta\\sim\\mathbb{P}_{\\eta\\mid\\xi}} [f(x,y^*(x;\\xi);\\eta, \\xi)]&\\text{(upper level)}\\\\\n\\mathrm{where} \\quad  & y^*(x;\\xi) :=\\hbox{\\rm argmin}_{y\\in\\mathbb{R}^{d_y}} \\mathbb{E}_{\\eta\\sim \\mathbb{P}_{\\eta\\mid\\xi}} [g(x,y;\\eta, \\xi)] \\quad \\forall ~\\xi \\text{ and } x. &\\text{(lower level)}\n\\end{aligned}')
('1', '\\xi\\sim\\mathbb{P}_\\xi')
('1', '\\eta\\sim\\mathbb{P}_{\\eta\\mid\\xi}')
('1', '\\mathbb{P}_{\\eta\\mid\\xi}')
('1', '\\eta')
('1', '\\xi')
('1', 'x')
('1', 'y')
('1', 'd_x')
('1', 'd_y')
('1', 'f')
('1', 'g')
('1', '(x,y)')
('1', '(\\xi,\\eta)')
('1', 'f(x, y;\\eta, \\xi)')
('1', 'x')
('1', 'g(x,y;\\eta,\\xi)')
('1', 'y')
('1', 'x')
('1', '\\eta')
('1', '\\xi')
('1', 'y^*(x;\\xi)')
('1', 'x')
('1', '\\xi')
('1', 'x')
('1', '\\xi')
('1', '\\eta')
('1', '\\mathbb{P}_\\xi')
('1', '\\xi')
('1', '\\mathbb{P}_{\\eta\\mid\\xi}')
('1', 'F(x)')
('1', 'x')
('1', '{\\epsilon}')
('1', 'F')
('1', '\\widehat x')
('1', '\\mathbb{E}\\|\\nabla F(\\widehat x)\\|^2\\leq{\\epsilon}^2')
('1', '\\label{problem:stochastic_bilevel_optimization}\n\\begin{aligned}\n\\min_{x\\in\\mathbb{R}^{d_x}} \\quad & \\mathbb{E}_{\\xi\\sim\\mathbb{P}_\\xi} [f(x,y^*(x);\\xi)] \\\\%&\\text{(upper level)}\\\\\n\\mathrm{where} \\quad  & y^*(x) := \\hbox{\\rm argmin}_{y\\in\\mathbb{R}^{d_y}} \\mathbb{E}_{\\eta\\sim\\mathbb{P}_\\eta} [g(x,y;\\eta)].%\n\\end{aligned}  \n\\vspace{-0.1em}')
('1', '\\label{problem:conditional_stochastic_optimization}\n\\min_{x\\in\\mathbb{R}^{d_x}} \\mathbb{E}_{\\xi\\sim\\mathbb{P}_\\xi} [f(x,\\mathbb{E}_{\\eta\\sim\\mathbb{P}_{\\eta\\mid\\xi}}[h(x;\\eta,\\xi)];\\xi)].\n\\vspace{-0.1em}')
('1', 'g(x,y;\\eta,\\xi) =\\|y - h(x;\\eta,\\xi)\\|^2')
('1', 'y^*(x,\\xi) = \\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}} [h(x;\\eta,\\xi)]')
('1', 'x')
('1', '\\xi')
('1', 'M')
('1', 'M')
('1', '\\theta')
('1', '\\label{problem:meta_learning_intro}\n\\begin{aligned}\n\\min_{x}  ~ & \\mathbb{E}_{i\\sim\\mu} \\mathbb{E}_{D^{test}_i\\sim\\rho_i}~\\big[ \nl_i(y_i^*(x),D^{test}_i)\n\\big]\n&\\text{(upper level)}\\\\\n\\mathrm{where} ~  & y_i^*(x) =\\hbox{\\rm argmin}_{y_i}~\\mathbb{E}_{D^{train}_i\\sim\\rho_i}\\big[ l_i(y_i,D^{train}_i) + \\frac{\\lambda}{2} \\|y_i - x\\|^2\\big], \\forall i\\in[M],x.  &\\text{(lower level)}\n\\end{aligned}')
('1', '\\mu')
('1', '[M]')
('1', 'x')
('1', 'x_i')
('1', 'x')
('1', 'M')
('1', '\\mathcal{O}(10^3)')
('1', '\\mathcal{O}(10^9)')
('1', 'M')
('1', '\\xi')
('1', 'x')
('1', 'y^*(x;\\xi)')
('1', '\\xi')
('1', 'y^*(x;\\xi)')
('1', '\\xi')
('1', 'y^*(x)')
('1', 'x')
('1', 'x')
('1', 'y')
('1', '\\{y^t\\}_{t}')
('1', '\\{y^*(x^t)\\}_{t}')
('1', 'y^*(x^{t+1}) - y^*(x^t)\\approx \\nabla y^*(x^t)^\\top (x^{t+1} - x^t),')
('1', 'x')
('1', 'y^*(x;\\xi)')
('1', '\\xi')
('1', '\\xi')
('1', '\\mathbb{P}_{\\eta\\mid\\xi}')
('1', '\\xi')
('1', 'y^*(x;\\xi^\\prime)')
('1', '\\xi^\\prime')
('1', '\\xi^t')
('1', 't')
('1', '\\{y^t\\}_t')
('1', '\\{y^*(x^t,\\xi^t)\\}_{t}')
('1', '\\xi')
('1', 'M')
('1', 'M')
('1', '\\xi')
('1', 'F')
('1', '{\\epsilon}')
('1', '\\xi')
('1', '\\mathcal{O}({\\epsilon}^{-2})')
('1', '\\mathbb{P}_{\\eta\\mid\\xi}')
('1', 'g')
('1', '\\widetilde\\mathcal{O}({\\epsilon}^{-6})')
('1', '{\\epsilon}')
('1', 'F')
('1', '\\nabla F')
('1', '\\mathcal{O}(1)')
('1', '\\mathbb{P}_{\\eta\\mid\\xi}')
('1', '\\mathcal{O}({\\epsilon}^{-2})')
('1', 'g')
('1', 'g')
('1', '{\\epsilon}')
('1', 'F')
('1', '\\widetilde\\mathcal{O}({\\epsilon}^{-4})')
('1.0', 'M')
('1.0', 'M')
('1.0', 'M')
('1.0', '\\psi:\\mathbb R^{d_x}\\times\\mathbb R^{d_y}')
('1.0', 'x\\in\\mathbb R^{d_x}')
('1.0', 'y\\in \\mathbb R^{d_y}')
('1.0', '\\nabla\\psi')
('1.0', '\\nabla_1\\psi')
('1.0', '\\nabla_2\\psi')
('1.0', '\\psi')
('1.0', '(x,y)')
('1.0', 'x')
('1.0', 'y')
('1.0', '\\nabla^2\\psi')
('1.0', '\\nabla^2_{11}\\psi')
('1.0', '\\nabla^2_{22}')
('1.0', '\\psi')
('1.0', '(x,y)')
('1.0', 'x')
('1.0', 'y')
('1.0', '\\nabla_{12}^2\\psi')
('1.0', '(d_x\\times d_y)')
('1.0', '\\partial^2_{x_i y_j}\\psi')
('1.0', '\\varphi:\\mathbb{R}^d\\rightarrow\\mathbb{R}')
('1.0', 'L')
('1.0', "|\\varphi(x)-\\varphi(x')|\\leq L\\|x-x'\\|")
('1.0', "x,x'\\in\\mathbb{R}^d")
('1.0', 'S')
('1.0', "\\|\\nabla \\varphi(x)-\\nabla \\varphi(x')\\|\\leq S\\|x-x'\\|")
('1.0', "x,x'\\in\\mathbb{R}^d")
('1.0', '\\varphi')
('1.0', '\\mu')
('1.0', "\\varphi(x)-\\varphi(x')-\\nabla \\varphi(x')^\\top(x-x')\\geq \\frac{\\mu}{2}\\|x-x'\\|^2")
('1.0', "x,x'\\in\\mathbb{R}^d")
('1.0', 'I')
('1.0', '\\widetilde\\mathcal{O}(\\cdot)')
('1.0', '\\mathcal{O}(\\cdot)')
('2', 'f')
('2', 'x')
('2', 'y')
('2', '\\eta')
('2', '\\xi')
('2', 'g')
('2', 'x')
('2', 'y')
('2', '\\eta')
('2', '\\xi')
('2', 'g')
('2', '\\mu_g')
('2', 'y')
('2', 'x')
('2', '\\eta')
('2', '\\xi')
('2', 'f')
('2', 'g')
('2', '\\nabla f')
('2', '\\nabla g')
('2', '\\nabla^2 g')
('2', 'L_{f,0}')
('2', 'L_{g,0}')
('2', 'L_{f,1}')
('2', 'L_{g,1}')
('2', 'L_{g,2}')
('2', '(x,y)')
('2', '\\eta')
('2', '\\xi')
('2', '(\\eta,\\xi)\\sim\\mathbb P_{(\\eta,\\xi)}')
('2', '\\nabla f(x,y;\\eta, \\xi)')
('2', '\\nabla \\mathbb{E}_{(\\eta,\\xi)\\sim\\mathbb P_{(\\eta,\\xi)}} [f(x,y;\\eta, \\xi)]')
('2', '\\sigma_f^2')
('2', 'x')
('2', 'y')
('2', '\\eta\\sim \\mathbb P_{\\eta|\\xi}')
('2', '\\nabla g(x,y;\\eta,\\xi)')
('2', '\\nabla \\mathbb{E}_{\\eta\\sim \\mathbb{P}_{\\eta\\mid\\xi}} [g(x,y;\\eta,\\xi)]')
('2', '\\sigma_{g,1}^2')
('2', '\\nabla^2 g(x,y;\\eta,\\xi)')
('2', '\\nabla^2 \\mathbb{E}_{\\eta \\sim\\mathbb{P}_{\\eta\\mid\\xi} } [g(x,y;\\eta,\\xi)]')
('2', '\\sigma_{g,1}^2')
('2', 'x')
('2', 'y')
('2', '\\xi')
('2', 'F')
('2', 'L_F')
('2', 'S_F')
('2', 'L_F, S_F>0')
('2', 'f')
('2', 'g')
('2', '(x,y)')
('2', '(\\eta,\\xi)\\sim \\mathbb P_{\\eta,\\xi}')
('2', '\\eta\\sim \\mathbb P_{\\eta|\\xi}')
('2', 'F')
('2', '\\nabla_1 y^*(x;\\xi) \\in\\mathbb R^{d_x\\times d_y}')
('2', 'x')
('2', '\\xi')
('2', '\\begin{aligned}\n    \\nabla F(x) = \\mathbb{E}_{(\\eta,\\xi)\\sim\\mathbb{P}_{(\\eta,\\xi)}}\n    \\Big[ \n    \\nabla_1 f(x,y^*(x;\\xi);\\eta,\\xi) + \\nabla_1 y^*(x;\\xi)^\\top \\nabla_2 f(x,y^*(x;\\xi);\\eta,\\xi)\n    \\Big].\n\\end{aligned}')
('2', '\\nabla_1 y^*(x;\\xi)')
('2', "\\begin{gathered}\n\\nabla F(x) = \n\\mathbb{E}_{(\\eta,\\xi)\\sim\\mathbb{P}_{(\\eta,\\xi)}} \\Big[ \n\\nabla_1 f(x,y^*(x;\\xi);\\eta,\\xi) \\\\\n-\n\\Big(\n\\mathbb{E}_{\\eta'\\sim \\mathbb{P}_{\\eta\\mid\\xi}} \\nabla_{12}^2 g(x,y^*(x;\\xi);\\eta',\\xi)\n\\Big) \n\\Lambda(x, y^*(x;\\xi); \\xi) \n\\nabla_2 f(x,y^*(x;\\xi);\\eta,\\xi)\n\\Big],\n\\end{gathered}")
('2', '\\Lambda(x, y; \\xi)=( \\mathbb{E}_{\\eta\\sim \\mathbb{P}_{\\eta\\mid\\xi}}\\nabla_{22}^2g(x, y; \\eta, \\xi))^{-1}')
('2', 'y^*(x,\\xi)')
('2', '\\Lambda(x, y; \\xi)')
('2', '\\xi')
('2', 'y^*(x;\\xi)')
('2', '\\Lambda(x, y; \\xi)')
('2', '\\nabla F(x)')
('2', 'y^*(x;\\xi)')
('2', 'y^*(x;\\xi)')
('2', 'K')
('2', 'k=1,\\ldots,K')
('2', 'k-1')
('2', '2^k')
('2', '2^{-k}')
('2', 'y^0_{K+1}')
('2', 'K')
('2', 'x')
('2', '\\xi')
('2', 'y_0')
('2', 'y^*(x;\\xi)')
('2', 'y^*(x;\\xi)')
('2', '\\sharp')
('2', 'K')
('2', '\\xi')
('2', 'x')
('2', 'y^0_1')
('2', '\\eta^j_k')
('2', '\\mathbb{P}_{\\eta\\mid\\xi}')
('2', 'y^{j+1}_k =y^{j}_k -\\beta_0 2^{-k} \\nabla_2 g(x,y^{j}_k ;\\eta^j_k,\\xi)')
('2', 'y_{k+1}^0 = 2^{-k}\\sum_{j=0}^{2^k-1} y_k^{j}')
('2', 'y^0_1')
('2', 'y^0_{K}')
('2', 'y^0_{K+1}')
('2', '\\Lambda(x, y; \\xi)')
('2', 'A')
('2', '0\\prec A\\prec I')
('2', '[\\mathbb{E}_{A\\sim\\mathbb P_A} A]^{-1} = \\sum_{n^\\prime=0}^\\infty (I-\\mathbb{E}_{A\\sim\\mathbb P_A} A)^n = \\sum_{n^\\prime=0}^\\infty  \\prod_{n=1}^{n^\\prime} \\mathbb{E}_{A_{n}\\sim\\mathbb P_A}(I-A_{n}) \\approx \\sum_{n^\\prime=0}^{N}  \\prod_{n=1}^{n^\\prime} \\mathbb{E}_{A_{n}\\sim\\mathbb P_A}(I-A_{n}).')
('2', 'N\\gg 1')
('2', '0\\prec\\nabla_{22}^2 g(x,y;\\eta_n,\\xi )\\prec  2L_{g,1} I')
('2', 'A=\\frac{1}{2L_{g,1}} \\nabla_{22}^2 g(x,y;\\eta_n,\\xi )')
('2', '\\Lambda(x, y; \\xi)')
('2', '\\label{eq:Hessian_inverse_estimator}\n\\widehat{\\Lambda}(x, y;\\xi):=\n\\begin{cases}\n  \\frac{N}{2L_{g,1}}I&\\quad \\text{if }\\widehat N=0,\\\\\n\\frac{N}{2L_{g,1}}\\prod_{n=1}^{\\widehat N}~\\Big( I -\\frac{1}{2L_{g,1}} \\nabla_{22}^2 g(x,y;\\eta_n,\\xi )\\Big) &\\quad \\text{if }\\widehat N\\ge 1.\n\\end{cases}')
('2', '\\widehat N')
('2', '\\{0,1,\\ldots,N-1\\}')
('2', '\\eta_1,\\ldots, \\eta_{\\widehat N}')
('2', '\\mathbb{P}_{\\eta\\mid\\xi}')
('2', 'N')
('2', 'N')
('2', 'N')
('2', 'N')
('2', '\\nabla F(x)')
('2', 'K')
('2', 'N')
('2', 'F')
('2', '\\xi')
('2', '\\mathbb{P}_\\xi')
('2', '\\eta^\\prime')
('2', '\\eta^{\\prime\\prime}')
('2', '\\mathbb{P}_{\\eta\\mid\\xi}')
('2', 'y_1^0')
('2', 'y^0_{K+1}')
('2', '\\widehat{\\Lambda}(x, y_{K+1}^0;\\xi)')
('2', '\\label{eq:basic-component}\n\\begin{aligned}\n    \\widehat{v}^K(x) := \\nabla_1 f(x,y_{K+1}^0;\\eta^{\\prime\\prime},\\xi)  - \n\\nabla_{12}^2 g(x,y_{K+1}^0;\\eta^\\prime,\\xi)\n\\widehat{\\Lambda}(x, y_{K+1}^0;\\xi)\n\\nabla_2 f(x,y_{K+1}^0;\\eta^{\\prime\\prime},\\xi).\n\\end{aligned}')
('2', '\\|\\mathbb{E}[\\widehat{v}^K](x)-\\nabla F(x)\\|\\leq {\\epsilon}')
('2', 'K = \\mathcal{O}(\\log({\\epsilon}^{-1}))')
('2', '\\mathcal{O}({\\epsilon}^{-2})')
('2', 'g')
('2', 'v(x)=\\widehat{v}^K(x)')
('2', '\\sharp')
('2', 'T')
('2', '\\{\\alpha_t\\}_{t=1}^{T}')
('2', 'x_1')
('2', 'v(x_t)')
('2', 'x_{t+1} = x_t - \\alpha_t v(x_t)')
('2', '\\widehat x_T')
('2', '\\{x_1,..., x_{T}\\}')
('2.0', 'y^0_{K+1}')
('2.0', '\\begin{aligned}\n\\widehat{v}^{K}(x)& =   \\widehat{v}^1(x)+\\sum_{k=1}^{K} [\\widehat{v}^{k+1}(x) - \\widehat{v}^k(x)] \\\\\n& = \\widehat{v}^1(x)+\\sum_{k=1}^{K} p_k\\frac{\\widehat{v}^{k+1}(x) - \\widehat{v}^k(x)}{p_k}\n=  \\widehat{v}^1(x)+\\mathbb{E}_{\\widehat k\\sim\\mathbb{P}_{\\widehat k}} \\Big[\\frac{\\widehat{v}^{\\widehat k+1}(x) - \\widehat{v}^{\\widehat k}(x)}{p_{\\widehat k}}\\Big],  \n\\end{aligned}')
('2.0', '\\widehat v^{\\widehat k}')
('2.0', 'k=1,\\ldots,K')
('2.0', 'K')
('2.0', '\\mathbb{P}_{\\widehat k}')
('2.0', '\\mathbb{P}_{\\widehat k}(\\widehat k=k)=p_k\\propto 2^{-k}')
('2.0', 'k=1,\\ldots, K')
('2.0', '\\label{estimator:RT-MLMC}\n\\widehat{v}(x) = \\widehat{v}^1(x)+p_{\\widehat k}^{-1}(\\widehat{v}^{{\\widehat k}+1}(x) - \\widehat{v}^{\\widehat k}(x)).')
('2.0', '\\mathbb{E}_{\\widehat k\\sim\\mathbb{P}_{\\widehat k}} [\\widehat{v}(x)] = \\widehat{v}^K(x)')
('2.0', '\\widehat v(x)')
('2.0', 'y^0_{k+1}(x,\\xi)')
('2.0', 'p_{k}')
('2.0', 'k')
('2.0', 'K=\\mathcal{O}(\\log({\\epsilon}^{-1}))')
('2.0', 'p_{K} =\\mathcal{O}({\\epsilon})')
('2.0', 'k\\ll K')
('2.0', '\\widehat{v}^{k+1}(x)')
('2.0', '\\widehat{v}^{k}(x)')
('2.0', 'y_{k+1}^0')
('2.0', 'y_k^0')
('2.0', '\\widehat{v}^{k+1}(x)-\\widehat{v}^{k}(x)')
('2.0', '~\\mathcal{O}(1)')
('2.0', '\\mathcal{O}({\\epsilon})')
('2.0', '\\mathcal{O}({\\epsilon}^{-2})')
('2.0', '\\mathcal{O}(\\log({\\epsilon}^{-1}))')
('2.0', 'v(x)=\\widehat{v}(x)')
('2.0', 'x')
('2.0', 'K')
('2.0', 'y_1^0')
('2.0', 'N')
('2.0', '\\xi')
('2.0', '\\mathbb{P}_\\xi')
('2.0', '\\widehat N')
('2.0', '\\{0,\\ldots,N-1\\}')
('2.0', '\\widehat k')
('2.0', '\\mathbb{P}_{\\widehat k}')
('2.0', '(\\widehat k,x, \\xi, y_1^0)')
('2.0', 'y_{\\widehat k+1}^0')
('2.0', 'y_{\\widehat k}^0')
('2.0', 'y_1^0')
('2.0', '\\widehat{v}^{\\widehat k+1}(x)')
('2.0', '\\widehat{v}^{\\widehat k}(x)')
('2.0', '\\widehat{v}^1(x)')
('2.0', '\\widehat v(x) = \\widehat{v}^1(x) +p_{\\widehat k}^{-1}(\\widehat{v}^{\\widehat k+1}(x) - \\widehat{v}^{\\widehat k}(x)).')
('2.0', '\\widehat v(x)')
('2.1', "\\label{Eq:c:expression}\n\\widehat c(x,y;\\xi) \\\\:= \n\\nabla_{12}^2 g(x,y;\\eta',\\xi)\n\\widehat{\\Lambda}(x, y;\\xi)\n\\nabla_2 f(x,y;\\eta'',\\xi).")
('2.1', '\\widehat{\\Lambda}(x, y;\\xi)')
('2.1', '\\widehat N')
('2.1', 'I-1/(2L_{g,1})\\nabla_{22} g(x,y;\\eta_n,\\xi)')
('2.1', 'n')
('2.1', '(y-1/(2L_{g,1})\\nabla_2 g(x,y;\\eta_{n},\\xi))')
('2.1', 'y')
('2.1', 'v=\\nabla_2 f(x,y;\\eta^{\\prime\\prime},\\xi)')
('2.1', 'v')
('2.1', '(y-1/(2L_{g,1})\\nabla_2 g(x,y;\\eta_{\\widehat N},\\xi))^\\top v')
('2.1', 'y')
('2.1', 'v=(I-1/(2L_{g,1})\\nabla_{22} g(x,y;\\eta_{\\widehat N},\\xi)) \\nabla_2 f(x,y;\\eta^{\\prime\\prime},\\xi)')
('2.1', 'n')
('2.1', 'v')
('2.1', '\\widehat{\\Lambda}(x, y;\\xi)')
('2.1', '\\mathcal{O}(Nd)')
('2.1', '\\mathcal{O}(d)')
('3', 'L_\\psi')
('3', 'S_\\psi')
('3', '\\psi(x)')
('3', '\\alpha\\leq 1/(2S_\\psi)')
('3', '\\begin{gathered}\n    \\textstyle \\mathbb{E}\\|\\nabla \\psi(\\widehat x_T)\\|^2 \n\\leq \n     \\frac{2A_1}{\\alpha T} + \\frac{2}{T}{\\textstyle\\sum}_{t=1}^{T} \\big[L_\\psi \\|\\mathbb{E}[v(x_t)-\\nabla \\psi(x_t)]\\| +  S_\\psi\\alpha\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2\\big],\n\\end{gathered}')
('3', 'A_1:= \\psi(x_1) -\\min_x \\psi(x)')
('3', '\\|\\mathbb{E}\\widehat{v}^K(x) - \\nabla F(x)\\| = \\|\\mathbb{E}\\widehat v(x) - \\nabla F(x)\\| \\leq \\mu_g^{-1} (1- \\mu_g/(2L_{g,1}))^{N} + \\mathcal{O}({N^2} 2^{-K/2}),')
('3', '\\mathrm{Var}(\\widehat{v}^K(x))=\\mathcal{O}({N^2})')
('3', '\\mathrm{Var}(\\widehat v(x))=\\mathcal{O}(K{N^4})')
('3', '{N} + 2^{K+1}-1')
('3', '2^{K+1}-1')
('3', '{N} + 3K')
('3', '3K')
('3', 'N=\\mathcal{O}(\\log({\\epsilon}^{-1}))')
('3', 'K = \\mathcal{O}(\\log({\\epsilon}^{-1}))')
('3', '\\mathcal{O}({\\epsilon})')
('3', '\\mathcal O(\\log(\\epsilon^{-1}))')
('3', '\\mathcal{O}(2^{K})=\\mathcal{O}({\\epsilon}^{-2})')
('3', '\\mathcal{O}(K) = \\mathcal{O}(\\log({\\epsilon}^{-1}))')
('3', '\\Lambda(x,y^*(x;\\xi);\\xi)')
('3', '\\epsilon')
('3', 'F')
('3', 'N=\\mathcal{O}(\\log({\\epsilon}^{-1}))')
('3', 'K = \\mathcal{O}(\\log({\\epsilon}^{-1}))')
('3', '\\alpha = \\mathcal{O}({\\epsilon}^2)')
('3', 'T=\\mathcal{O}({\\epsilon}^{-4})')
('3', '\\xi')
('3', '\\eta')
('3', 'g')
('3', 'f')
('3', '\\widetilde\\mathcal{O}({\\epsilon}^{-4})')
('3', '\\eta')
('3', 'g')
('3', '\\widetilde\\mathcal{O}({\\epsilon}^{-6})')
('3', '\\xi')
('3', 'f')
('3', '\\widetilde\\mathcal{O}({\\epsilon}^{-4})')
('3', '\\eta')
('3', 'g')
('3', 'f')
('4.0', '\\label{problem:meta_learning}\n\\begin{aligned}\n\\min_{x}  ~ & \\mathbb{E}_{i\\sim\\mu} \\mathbb{E}_{D^{test}_i\\sim\\rho_i}~\\big[ \nl_i(y_i^*(x),D^{test}_i)\n\\big]\n\\\\\n\\mathrm{where} ~  & y_i^*(x) =\\hbox{\\rm argmin}_{y_i}~\\mathbb{E}_{D^{train}_i\\sim\\rho_i}\\big[ l_i(y_i,D^{train}_i) + \\frac{\\lambda}{2} \\|y_i - x\\|^2\\big], \\forall i\\in[M]~\\text{and}~x. \n\\end{aligned}')
('4.0', '\\mu')
('4.0', 'M')
('4.0', '\\rho_i')
('4.0', 'i')
('4.0', 'D_i^{train}')
('4.0', 'D_i^{test}')
('4.0', 'i')
('4.0', 'x')
('4.0', 'y_i^*(x)')
('4.0', 'i')
('4.0', 'l_i')
('4.0', 'i')
('4.0', '\\lambda')
('4.0', 'K')
('4.0', '\\mu')
('4.0', 'M')
('4.0', 'M')
('4.0', 'M')
('4.0', 'M')
('4.0', 'y_i^*(x)')
('4.0', '\\widehat y_i(x):= x - \\lambda^{-1} \\nabla l_i(x, D_i^{train})')
('4.0', 'l_i(x, D), \\forall i')
('4.0', 'K')
('4.0', 'K')
('4.0', '9')
('4.0', 'K')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v1}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v1}}')
('4.0', '5120\\times5120')
('4.0', '\\theta')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.0', '\\mathrm{BSVRB}^{\\mathrm{v2}}')
('4.1', '\\xi')
('4.1', '\\eta')
('4.1', '\\xi')
('4.1', 'f(x;\\xi)')
('4.1', '\\xi')
('4.1', 'w')
('4.1', '\\eta')
('4.1', '(\\xi, \\eta)')
('4.1', '\\label{problem:WDRO_SI}\n\\min_{x}~\\max_{\\mathbb{P}}~\\Big\\{ \n\\mathbb{E}_{(\\xi,\\eta)\\sim\\mathbb{P}}[l(f(x,\\xi); \\eta)] - \\lambda \\mathsf{C}(\\mathbb{P}, \\mathbb{P}^0)\n\\Big\\},')
('4.1', 'l(w;\\eta)')
('4.1', 'w')
('4.1', '\\eta')
('4.1', '\\mathbb{P}^0')
('4.1', '(\\xi,\\eta)')
('4.1', '\\mathsf{C}(\\cdot,\\cdot)')
('4.1', '\\xi')
('4.1', '\\xi')
('4.1', '\\eta')
('4.1', 'f(x;\\xi)')
('4.1', '\\xi')
('4.1', 'l(f(x;\\xi);\\eta)')
('4.1', 'f(x;\\xi)')
('4.1', '\\eta')
('4.1', '\\label{problem:conditional_bilevel_optimization:WDRO:SI}\n\\begin{aligned}\n\\min_{x} ~ & \\mathbb{E}_{{\\xi}\\sim \\mathbb{P}_{\\xi}^0} \n\\mathbb{E}_{{\\eta}\\sim \\mathbb{P}_{{\\eta}\\mid {\\xi}}^0}~\\big[ \nl(f(x; y^*(x;{\\xi})), {\\eta}) - \\lambda\n\\|y^*(x;{\\xi}) - {\\xi}\\|^2\n\\big]\n&\\text{(upper level)}\\\\\n\\mathrm{where} ~  & y^*(x;{\\xi}) :=\\hbox{\\rm argmin}_{\\widetilde\\xi} ~\\mathbb{E}_{{\\eta}\\sim\\mathbb{P}_{{\\eta}\\mid{\\xi}}^0} \\big[\n-l(f(x;\\widetilde\\xi), {\\eta}) + \\lambda\\|\\xi - \\widetilde\\xi\\|^2\n\\big], ~\\forall \\widetilde\\xi~\\text{and}~x.  &\\text{(lower level)}\n\\end{aligned}')
('4.1', 'm')
('4.1', 'Z')
('4.1', '\\mathbb{P}_{Z\\mid X}')
('4.1', 'X')
('4.1', 'f')
('4.1', 'f(x;\\xi)')
('4.1', 'x')
('4.1', 'K')
('4.1', 'K')
('4.1', '\\eta')
('4.1', '\\xi')
('6', '\\psi')
('6', 'S_\\psi')
('6', '\\label{eq:SGD_error}\n\\begin{aligned}\n&\n    \\mathbb{E}\\psi(x_{t+1}) - \\psi(x_t) \\\\\n\\leq &\n    \\mathbb{E}\\nabla \\psi(x_t)^\\top (x_{t+1} - x_t) +\\frac{S_\\psi}{2}\\mathbb{E}\\|x_{t+1} - x_t\\|^2\\\\\n= &\n    -\\alpha_t \\mathbb{E}\\nabla \\psi(x_t)^\\top v(x_t) +\\frac{S_\\psi{\\alpha_t}^2}{2}\\mathbb{E}\\|v(x_t)\\|^2\\\\\n\\leq &  \n    -\\alpha_t \\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 + \\alpha_t \\mathbb{E}\\nabla \\psi(x_t)^\\top (\\nabla \\psi(x_t) - v(x_t)) \\\\\n    &\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad+S_\\psi{\\alpha_t}^2\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2 + S_\\psi{\\alpha_t}^2 \\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2\\\\\n= &\n    -(\\alpha_t - S_\\psi{\\alpha_t}^2) \\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 + \\alpha_t \\mathbb{E}\\nabla \\psi(x_t)^\\top (\\nabla \\psi(x_t) - v(x_t)) +S_\\psi{\\alpha_t}^2\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2 \\\\\n= &\n    -(\\alpha_t - S_\\psi{\\alpha_t}^2) \\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 + \\alpha_t \\mathbb{E}[\\nabla \\psi(x_t)^\\top \\mathbb{E}[\\nabla \\psi(x_t) - v(x_t)\\mid x_t]]\\\\\n    & \\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad+S_\\psi{\\alpha_t}^2\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2 \\\\\n\\leq &\n    -\\alpha_t/2 \\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 + \\alpha_t \\mathbb{E}[\\nabla \\psi(x_t)^\\top \\mathbb{E}[\\nabla \\psi(x_t) - v(x_t)\\mid x_t] ]+S_\\psi{\\alpha_t}^2\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2\\\\\n\\leq &\n    -\\alpha_t/2 \\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 + \\alpha_t \\mathbb{E}[\\|\\nabla \\psi(x_t)\\| \\|\\mathbb{E}[\\nabla \\psi(x_t) - v(x_t)\\mid x_t]\\| ]+S_\\psi{\\alpha_t}^2\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2,\n\\end{aligned}')
('6', '\\psi')
('6', '\\alpha_t\\leq 1/(2S_\\psi)')
('6', '\\alpha_t=\\alpha')
('6', '\\begin{gathered}\n\\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 \\leq \n    \\frac{2(\\mathbb{E}\\psi(x_t) - \\mathbb{E}\\psi(x_{t+1}))}{\\alpha} \\\\\n+ 2\\mathbb{E}\\|\\nabla \\psi(x_t)\\| \\|\\mathbb{E}[\\nabla \\psi(x_t) - v(x_t)\\mid x_t]\\| + 2S_\\psi\\alpha \\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2.\n\\end{gathered}')
('6', 't= 1')
('6', 't=T')
('6', '\\begin{gathered}\n \\mathbb{E}\\|\\nabla \\psi(\\widehat x_T)\\|^2 \n= \n    \\frac{1}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|\\nabla \\psi(x_t)\\|^2 \n\\leq \n     \\frac{2(\\psi(x_1) - \\min_{x} \\psi(x))}{\\alpha T} \\\\ + \\frac{2}{T}\\sum_{t=1}^{T} \\mathbb{E}\\|\\nabla \\psi(x_t)\\| \\|\\mathbb{E}[\\nabla \\psi(x_t) - v(x_t)\\mid x_t]\\| +  \\frac{2S_\\psi\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2\\\\\n\\leq \n    \\frac{2( \\psi(x_1) - \\min_{x} \\psi(x))}{\\alpha T} + \\frac{2}{T}\\sum_{t=1}^{T} \\Big[ L_\\psi \\|\\mathbb{E}[\\nabla \\psi(x_t) - v(x_t)]\\| +  S_\\psi\\alpha\\mathbb{E}\\|v(x_t)-\\nabla \\psi(x_t)\\|^2\\Big],\\\\\n\\end{gathered}')
('6', '\\psi')
('6', 'L_\\psi')
('6', '\\|\\nabla \\psi(x)\\|\\leq L_\\psi')
('6', 'x')
('6', 'x')
('6', '\\xi')
('6', 'y_{K+1}^0')
('6', '\\beta_0=(4\\mu_g)^{-1}')
('6', '\\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi)\\|^2\\leq 2L_{g,0}^2\\mu_g^{-2} 2^{-(K+1)}.')
('6', '\\beta_0')
('6', '(4\\mu_g)^{-1}')
('6', '\\beta_0>0')
('6', '\\beta_0')
('6', '\\mu_g')
('6', '\\beta_0')
('6', '0.4')
('6', 'G(x,y;\\xi):=\\mathbb{E}_{\\eta\\mid\\xi} g(x,y;\\eta,\\xi)')
('6', '\\mathbb{E}')
('6', 'x')
('6', '\\xi')
('6', 'y')
('6', 'k')
('6', 'y')
('6', 'j=0,\\ldots, 2^k-1')
('6', '\\begin{aligned}\n&\n    \\mathbb{E}\\|y^{j+1}_k - y\\|^2\\\\\n= &\n    \\mathbb{E}\\|y^{j}_k-\\beta_k \\nabla_2 g(x,y^{j}_k;\\eta^j_k,\\xi) - y\\|^2\\\\\n= & \n    \\mathbb{E}\\|y^{j}_k - y\\|^2+\\beta_k^2 \\mathbb{E}\\|\\nabla_2 g(x,y^{j}_k;\\eta^j_k,\\xi)\\|^2 - 2\\beta_k \\mathbb{E}\\nabla_2 g(x,y^{j}_k;\\eta^j_k,\\xi)^\\top (y^{j}_k-y)\\\\\n\\leq &\n    \\mathbb{E}\\|y^{j}_k - y\\|^2+\\beta_k^2 L_{g,0}^2 - 2\\beta_k (\\mathbb{E}G(x,y^{j}_k;\\xi) - G(x,y;\\xi)),\n\\end{aligned}')
('6', 'g')
('6', 'G')
('6', 'y')
('6', '\\mathbb{E}G(x,y^{j}_k;\\xi) - G(x,y;\\xi) \\leq \\frac{\\mathbb{E}\\|y^{j}_k - y\\|^2 - \\mathbb{E}\\|y^{j+1}_k - y\\|^2}{2\\beta_k} + \\frac{\\beta_k L_{g,0}^2}{2}.')
('6', 'j=0')
('6', 'j=2^{k}-1')
('6', '2^k')
('6', '\\label{eq:SGD_convex}\n\\begin{aligned}\n&\\mathbb{E}G(x,y^{0}_{k+1};\\xi)-G(x,y;\\xi)\\\\\n\\leq&\\frac{1}{2^k}\\sum_{j=0}^{2^k-1} \\mathbb{E}G(x,y^{j}_k;\\xi) - G(x,y;\\xi)\n\\leq\\frac{\\mathbb{E}\\|y^{0}_k - y\\|^2}{2\\beta_k 2^{k}} + \\frac{\\beta_k L_{g,0}^2}{2},\n\\end{aligned}')
('6', 'G')
('6', 'y')
('6', 'G(x,y;\\xi)')
('6', '\\mu_g')
('6', 'y')
('6', 'x')
('6', '\\xi')
('6', '\\begin{aligned}\n    &G(x,y_1^0;\\xi) - G(x,y^*(x;\\xi);\\xi)\n\\\\\n\\leq&  \n     -\\nabla_2 G(x,y_1^0;\\xi)^\\top (y^*(x;\\xi) - y_1^0) -\\frac{\\mu_g}{2}\\|y^*(x;\\xi) - y_1^0\\|^2 \\\\\n\\leq &\n    \\max_y \\Big\\{-\\nabla_2 G(x,y_1^0;\\xi)^\\top (y - y_1^0) -\\frac{\\mu_g}{2}\\|y - y_1^0\\|^2 \\Big\\}\\\\\n= & \n    \\frac{\\|\\nabla_2 G(x,y_1^0;\\xi)\\|^2}{2\\mu_g} \\leq \n    \\frac{L_{g,0}^2}{2\\mu_g}.\n\\end{aligned}')
('6', 'k')
('6', '\\mathbb{E}G(x,y_k^0;\\xi) - G(x,y^*(x;\\xi);\\xi) \\leq \\frac{L_{g,0}^2}{2^k\\mu_g}.')
('6', 'k=1')
('6', '\\mathbb{E}G(x,y_k^0;\\xi) - G(x,y^*(x;\\xi);\\xi) \\leq \\frac{L_{g,0}^2}{2^k\\mu_g}')
('6', 'k\\geq n')
('6', 'y=y^*(x;\\xi)')
('6', '\\begin{aligned}\n    \\mathbb{E}G(x,y_{k+1}^0;\\xi) - G(x,y^*(x;\\xi);\\xi) \n\\leq &\n    \\frac{\\mathbb{E}\\|y^{0}_k - y^*(x;\\xi)\\|^2}{2\\beta_k 2^{k}} + \\frac{\\beta_k L_{g,0}^2}{2}\\\\\n\\leq &  \n    \\frac{\\mathbb{E}G(x,y_{k}^0;\\xi) - G(x,y^*(x;\\xi);\\xi)}{\\mu_g\\beta_k 2^{k}} + \\frac{\\beta_0 L_{g,0}^2}{2^{K+1}}\\\\\n= &\n    \\frac{\\mathbb{E}G(x,y_{k}^0;\\xi) - G(x,y^*(x;\\xi);\\xi)}{\\mu_g\\beta_0} + \\frac{\\beta_0 L_{g,0}^2}{2^{K+1}}\\\\\n\\leq &\n    \\frac{L_{g,0}^2}{\\mu_g^2\\beta_0 2^k} + \\frac{\\beta_0 L_{g,0}^2}{2^{k+1}}\\\\\n= &\n    \\frac{L_{g,0}^2}{\\mu_g 2^{k+2}} + \\frac{ L_{g,0}^2}{\\mu_g 2^{k+3}}\\\\\n\\leq &\n    \\frac{L_{g,0}^2}{\\mu_g 2^{k+1}},\n\\end{aligned}')
('6', 'G')
('6', 'y')
('6', 'y^*(x;\\xi)')
('6', 'G')
('6', '\\beta_k=\\beta_0/2^k')
('6', '\\beta_0= (4\\mu_g)^{-1}')
('6', '\\mathbb{E}G(x,y_{K+1}^0;\\xi) - G(x,y^*(x;\\xi);\\xi)\\leq \\frac{L_{g,0}^2}{\\mu_g 2^{K+1}}.')
('6', '\\mu_g')
('6', 'G(x,y,;\\xi)')
('6', 'y^*(x;\\xi)')
('6', '\\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi)\\|^2\\leq\n\\frac{2}{\\mu_g}\n\\mathbb{E}G(x,y_{K+1}^0;\\xi) - G(x,y^*(x;\\xi);\\xi)\\leq\n\\frac{L_{g,0}^2}{\\mu_g^2 2^{K}}.')
('6', "\\begin{gathered}\nV(x) = \n\\mathbb{E}_{\\mathbb{P}_\\xi,\\mathbb{P}_{\\eta\\mid\\xi}}\\Big[ \n\\nabla_1 f(x,y^*(x;\\xi);\\eta,\\xi) \\\\\n-\n\\Big( \n\\mathbb{E}_{\\mathbb{P}_{\\eta^\\prime\\mid\\xi}}\\nabla_{12}^2 g(x,y^*(x;\\xi);\\eta',\\xi)\n\\Big)\n\\mathbb{E}_{\\{\\eta_n\\}_{n=1}^{\\widehat N}\\sim \\mathbb{P}_{\\eta\\mid\\xi}} [\\widehat{\\Lambda}(x, y^*(x;\\xi);\\xi)]\n\\nabla_2 f(x,y^*(x;\\xi);\\eta,\\xi)\n\\Big].\n\\end{gathered}")
('6.0', '\\|\\mathbb{E}\\widehat{v}(x) - \\nabla F(x)\\|\\leq \\|\\mathbb{E}\\widehat{v}(x) - V(x)\\| + \\| V(x) - \\nabla F(x)\\|.')
('6.0', 'x')
('6.0', 'y')
('6.0', '\\xi')
('6.0', '\\|\\mathbb{E}_{\\{\\eta_n\\}_{n=1}^{\\widehat N}\\sim \\mathbb{P}_{\\eta\\mid\\xi}} [\\widehat{\\Lambda}(x, y;\\xi)] -\\Lambda(x,y;\\xi)\\| \\leq \\frac{1}{\\mu_g} \\Big(1- \\frac{\\mu_g}{2L_{g,1}}\\Big)^{N}')
('6.0', '\\nabla g')
('6.0', 'f')
('6.0', '\\| V(x) - \\nabla F(x)\\| \\leq \\frac{L_{g,1} L_{f,0}}{\\mu_g} \\Big(1- \\frac{\\mu_g}{2L_{g,1}}\\Big)^{N}.')
('6.0', '\\widehat{v}(x)')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\widehat{v}(x) -V(x) \\\\\n= & \\mathbb{E}\\nabla_1 f(x,y_{K+1}^0;\\eta,\\xi)  - \\mathbb{E}\\nabla_1 f(x,y^*(x;\\xi);\\eta,\\xi) \\\\\n&+\n    \\mathbb{E}\\nabla_{12}^2 g(x,y_{K+1}^0;\\eta,\\xi) \\Big[{\\widehat{\\Lambda}(x, y^0_{K+1};\\xi)}\\Big] \\nabla_2 f(x,y_{K+1}^0;\\eta,\\xi)\\\\\n     & -\n    \\mathbb{E}\\nabla_{12}^2 g(x,y^*(x;\\xi);\\eta^\\prime,\\xi) \\Big[{\\widehat{\\Lambda}(x, y^*(x;\\xi);\\xi)}\\Big] \\nabla_2 f(x,y^*(x;\\xi);\\eta^\\prime,\\xi).\n\\end{aligned}')
('6.0', '\\nabla f')
('6.0', '\\begin{aligned}\n&\n     \\Big\\|\\mathbb{E}\\nabla_1 f(x,y_{K+1}^0;\\eta,\\xi) - \\mathbb{E}\\nabla_1 f(x,y^*(x;\\xi);\\eta,\\xi)\\Big\\|\\\\\n\\leq &\n    L_{f,1}\\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi)\\|\\\\\n\\leq &\n     \\frac{L_{f,1} L_{g,0}}{\\mu_g 2^{K/2}}.\n\\end{aligned}')
('6.0', '\\nabla f')
('6.0', '\\nabla g')
('6.0', '\\nabla^2 g')
('6.0', 'y')
('6.0', '\\begin{aligned}\n&\n    \\|\\mathbb{E}\\widehat{v}(x) -V(x)\\|\\\\\n\\leq &\n    L_{f,1}\\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi)\\| + \\frac{L_{g,1} L_{f,1}{N}}{L_{g,1}} \\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi)\\| + \\frac{L_{f,0} L_{g,2}{N}} \n  {L_{g,1}}\\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi)\\| \\\\\n  & +\n    L_{f,0} L_{g,1} \\frac{{N}}{L_{g,1}}  \\sum_{N^\\prime =1}^{N} \\frac{1}{N^\\prime} N^\\prime \\mathbb{E}\\|y_{K+1}^0 - y^*(x;\\xi) \\|\\\\\n\\leq &\n    \\frac{L_{f,1} L_{g,0}}{\\mu_g 2^{K/2}} + \\Big(\\frac{L_{g,1} L_{f,1}{N}}{L_{g,1}} + \\frac{L_{f,0} L_{g,2}{N}} \n  {L_{g,1}} + L_{f,0} L_{g,1} \\frac{{N^2}}{L_{g,1}} \\Big) \\frac{L_{g,0}}{\\mu_g 2^{K/2}}\\\\\n= &\n    \\mathcal{O}\\Big(\\frac{{N^2}}{2^{K/2}}\\Big).\n\\end{aligned}')
('6.0', '\\widehat{v}(x)')
('6.0', '\\xi')
('6.0', '\\eta')
('6.0', '\\mathbb{P}_{\\eta\\mid\\xi}')
('6.0', '\\sum_{N^\\prime=1}^{N} \\frac{1}{N^\\prime} N^\\prime + \\sum_{k=1}^{K} (2^{k+1}-1) \\frac{2^{-k}}{1-2^{-K - 1}} < {N} + 3K.')
('6.0', '\\sum_{k=1}^{K} (2^{k+1}-1) \\frac{2^{-k}}{1-2^{-K - 1}} <3K.')
('6.0', '\\widehat{v}(x)')
('6.0', '\\begin{aligned}\n& \n    H_K(1) := \\nabla_1 f(x,y_K^0;\\eta^{\\prime\\prime},\\xi),\\\\\n&\n    H_K(2) := \\nabla_{12}^2 g(x,y_K^0;\\eta^\\prime,\\xi)\\Big[{\\widehat{\\Lambda}(x, y^0_{K};\\xi)}\\Big]\\nabla_2 f(x,y_K^0;\\eta^{\\prime\\prime},\\xi),\\\\\n& \n    H^*(1) := \\nabla_1 f(x,y^*(x;\\xi);\\eta^{\\prime\\prime},\\xi),\\\\\n&\n    H^*(2) := \\nabla_{12}^2 g(x,y^*(x;\\xi);\\eta^\\prime,\\xi)\\Big[{\\widehat{\\Lambda}(x, y^*(x;\\xi);\\xi)}\\Big]\\nabla_2 f(x,y^*(x;\\xi);\\eta^{\\prime\\prime},\\xi).\n\\end{aligned}')
('6.0', '\\widehat v(x)')
('6.0', 'V(x)')
('6.0', '\\begin{aligned}\n    \\widehat v(x) & = \\frac{H_{k+1}(1) - H_{k}(1) - H_{k+1}(2) + H_{k}(2)}{p_k} + H_1(1)- H_1(2),\\\\\n    V(x) & = \\mathbb{E}[H^*(1)  - H^*(2)].\n\\end{aligned}')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\|\\widehat{v}(x) - \\mathbb{E}\\widehat{v}(x)\\|^2\\\\\n\\leq &\n    \\mathbb{E}\\|\\widehat{v}(x) - V(x)\\|^2\\\\\n\\leq & \n    2\\mathbb{E}\\| \\widehat{v}(x) - H_1(1)+ H_1(2)\\|^2 + 2\\mathbb{E}\\|H_1(1)- H_1(2) -V(x) \\|^2 \\\\\n\\leq &\n    4\\mathbb{E}\\Big\\|\\frac{1}{p_k} (H_{k+1}(1) - H_{k}(1))\\Big\\|^2 + 4\\mathbb{E}\\Big\\|\\frac{1}{p_k} (H_{k+1}(2) - H_{k}(2))\\Big\\|^2 + 2\\mathbb{E}\\|H_1(1)- H_1(2) -V(x) \\|^2,\n\\end{aligned}')
('6.0', '\\widehat v(x)')
('6.0', '\\mathbb{E}\\Big\\|\\frac{1}{p_k} (H_{k+1}(1) - H_{k}(1))\\Big\\|^2')
('6.0', '\\mathbb{E}\\Big\\|\\frac{1}{p_k} (H_{k+1}(2) - H_{k}(2))\\Big\\|^2')
('6.0', '\\mathbb{E}\\|H_1(1)- H_1(2) -V(x) \\|^2')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\Big\\|\\frac{1}{p_k} (H_{k+1}(1) - H_{k}(1))\\Big\\|^2\\\\\n= &\n    \\sum_{k=1}^{K} p_k^{-1} \\mathbb{E}\\|H_{k+1}(1) - H_k(1)\\|^2\\\\\n\\leq &\n    \\sum_{k=1}^{K} p_k^{-1} L_{f,1}^2 \\mathbb{E}\\|y_{k+1}^0 -y_k^0\\|^2 \\\\\n\\leq &\n    \\sum_{k=1}^{K} p_k^{-1} L_{f,1}^2 2(\\mathbb{E}\\|y_{k+1}^0 -y^*(x;\\xi)\\|+\\mathbb{E}\\|y^*(x;\\xi)- y_k^0\\|^2) \\\\\n\\leq &\n     \\sum_{k=1}^{K} p_k^{-1} L_{f,1}^2 \\frac{6L_{g,0}^2}{\\mu_g^2 2^k}\\\\\n\\leq &\n    K L_{f,1}^2 \\frac{6L_{g,0}^2}{\\mu_g^2},\n\\end{aligned}')
('6.0', '\\nabla f')
('6.0', 'p_k')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\Big\\|\\frac{1}{p_k} (H_{k+1}(2) - H_{k}(2))\\Big\\|^2 \\\\\n= &\n    \\sum_{k=1}^{K} p_k^{-1} \\mathbb{E}\\|H_{k+1}(2) - H_K(2)\\|^2 \\\\\n\\leq &\n    \\sum_{k=1}^{K} p_k^{-1}   6\\Big(L_{f,1}^2{N^2} + \\frac{L_{f,0}^2 L_{g,2}^2{N^2}} \n  {L_{g,1}^2} + L_{f,0}^2 {N^4} \\Big) \\mathbb{E}\\|y_{K+1}^0 -y_K^0\\|^2\\\\\n\\leq &\n    \\sum_{k=1}^{K} p_k^{-1}   2\\Big(\\frac{L_{g,0}^2}{\\mu_g^2 2^K}+\\frac{L_{g,0}^2}{\\mu_g^2 2^{K-1}}\\Big) 6\\Big(L_{f,1}^2{N^2} + \\frac{L_{f,0}^2 L_{g,2}^2{N^2}} \n  {L_{g,1}^2} + L_{f,0}^2 {N^4} \\Big)\\\\\n= &\n    \\frac{36K  L_{g,0}^2}{\\mu_g^2}\\Big(L_{f,1}^2{N^2} + \\frac{L_{f,0}^2 L_{g,2}^2{N^2}} \n  {L_{g,1}^2} + L_{f,0}^2 {N^4} \\Big),\n\\end{aligned}')
('6.0', 'f')
('6.0', '\\nabla f')
('6.0', '\\nabla g')
('6.0', '\\nabla^2 g')
('6.0', 'y')
('6.0', 'p_k')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\|H_1(1)- H_1(2) -V(x) \\|^2\\\\\n\\leq &\n    2\\mathbb{E}\\| H_1(1)-\\mathbb{E}H^*(1)\\|^2 + 2\\mathbb{E}\\| H_1(2)-\\mathbb{E}H^*(2)\\|^2\\\\\n\\end{aligned}')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\| H_1(1)-\\mathbb{E}H^*(1)\\|^2\\\\\n= &\n    \\mathbb{E}\\| \\nabla_1 f(x,y_1^0;\\eta,\\xi)-\\mathbb{E}\\nabla_1 f(x,y_1^0;\\eta,\\xi)\\|^2\\\\\n    & \\qquad\\qquad+\n    \\mathbb{E}\\|\\mathbb{E}\\nabla_1 f(x,y_1^0;\\eta,\\xi)-\\mathbb{E}\\nabla_1 f(x,y^*(x;\\xi);\\eta,\\xi)\\|^2\\\\\n\\leq &\n    \\sigma_{f}^2+ \\frac{L_{f,1}^2 L_{g,0}^2}{2\\mu_g^2},\\\\\n\\end{aligned}')
('6.0', '\\mathbb{E}\\|a+b\\|^2 = \\mathbb{E}\\|a\\|^2 + \\mathbb{E}\\|b\\|^2 +2\\mathbb{E}a^\\top b')
('6.0', '\\nabla f')
('6.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\| H_1(2)-\\mathbb{E}H^*(2)\\|^2 \\\\\n= &\n    \\mathbb{E}\\| H_1(2)-\\mathbb{E}H_1(2)\\|^2 + \\mathbb{E}\\| \\mathbb{E}H_1(2) - \\mathbb{E}H^*(2)\\|^2\\\\\n\\leq &\n    \\mathbb{E}\\| H_1(2)\\|^2 + \\mathbb{E}\\| \\mathbb{E}H_1(2) -  \\mathbb{E}H^*(2)\\|^2 \\\\\n\\leq &  \n    L_{g,1}^2 L_{f,0}^2 \\sum_{\\widehat N = 1}^N \\frac{1}{\\widehat N} \\frac{N^2}{4L_{g,1}} + 6\\Big(L_{f,1}^2{N^2} + \\frac{L_{f,0}^2 L_{g,2}^2{N^2}} \n  {L_{g,1}^2} + L_{f,0}^2 {N^4} \\Big)\\frac{L_{g,0}^2}{2\\mu_g^2}\\\\\n= &\n    L_{g,1}^2 L_{f,0}^2 \\frac{N^2}{4L_{g,1}} + 6\\Big(L_{f,1}^2{N^2} + \\frac{L_{f,0}^2 L_{g,2}^2{N^2}} \n  {L_{g,1}^2} + L_{f,0}^2 {N^4} \\Big)\\frac{L_{g,0}^2}{2\\mu_g^2},\n\\end{aligned}')
('6.0', '\\mathbb{E}\\|a+b\\|^2 = \\mathbb{E}\\|a\\|^2 + \\mathbb{E}\\|b\\|^2 +2\\mathbb{E}a^\\top b')
('6.0', '\\mathbb{E}\\|\\widehat{v}(x)-\\mathbb{E}\\widehat{v}(x)\\|^2 \\leq \\mathbb{E}\\|\\widehat{v}(x) - V (x)\\|^2 =\\mathcal{O}(K {N^4}).')
('6.0.0', '\\mathbb{E}\\widehat{v}(x)= \\mathbb{E}\\widehat{v}^K(x)')
('6.0.0', '2^{K+1}-1')
('6.0.0', '{N}+2^{K+1}-1')
('6.0.0', '\\begin{aligned}\n   \\widehat{v}^K(x) = H_{K+1}(1) - H_{K+1}(2)\n\\end{aligned}')
('6.0.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\|\\widehat{v}^K(x) - \\mathbb{E}\\widehat{v}^K(x)\\|^2\\\\\n\\leq &\n    \\mathbb{E}\\|\\widehat{v}^K(x) - V(x)\\|^2\\\\\n\\leq &\n    2\\mathbb{E}\\|H_{K+1}(1) - \\mathbb{E}H^*(1)\\|^2 + 2\\mathbb{E}\\|H_{K+1}(2) - \\mathbb{E}H^*(2)\\|^2 \\\\\n\\leq &  \n    2\\mathbb{E}\\|H_{K+1}(1) - \\mathbb{E}H_{K+1}(1) \\|^2 + 2\\mathbb{E}\\|\\mathbb{E}H_{K+1}(1)- \\mathbb{E}H^*(1)\\|^2 + 2\\mathbb{E}\\|H_{K+1}(2)\\|^2 \\\\\n    & \\qquad\\qquad+2\\mathbb{E}\\|\\mathbb{E}H_{K+1}(2) - \\mathbb{E}H^*(2)\\|^2 \\\\\n\\leq &\n    2\\sigma_{f}^2+ \\frac{L_{f,1}^2 L_{g,0}^2}{2^{K}\\mu_g^2} + L_{g,1}^2 L_{f,0}^2 \\frac{N^2}{2L_{g,1}} + 12\\Big(L_{f,1}^2{N^2} + \\frac{L_{f,0}^2 L_{g,2}^2{N^2}} \n  {L_{g,1}^2} + L_{f,0}^2 {N^4} \\Big)\\frac{L_{g,0}^2}{2^{K+1}\\mu_g^2}\\\\\n= &\n    \\mathcal{O}(N^2 + N^4 2^{-K}),\n\\end{aligned}')
('6.0.0', 'f')
('6.0.0', '\\nabla f')
('6.0.0', '\\nabla g')
('6.0.0', 'N')
('6.0.0', 'K')
('6.0.0', '\\mathcal{O}(\\log(\\epsilon^{-1}))')
('6.0.0', 'N^2')
('6.0.0.0', '\\begin{aligned}\n&\n    \\mathbb{E}\\|\\nabla F(\\widehat x_T)\\|^2 \\\\\n\\leq &\n     \\frac{2(\\mathbb{E}F(x_1) - \\min_{x} F(x))}{\\alpha T}  + \\frac{2}{T}\\sum_{t=1}^{T} \\mathbb{E}\\|\\nabla F(x_t)\\| \\|\\mathbb{E}[\\nabla F(x_t) - \\widehat{v}(x_t)\\mid x_t]\\| \\\\\n     &\\qquad\\qquad\\qquad+  \\frac{2S_F\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|\\widehat{v}(x_t)-\\nabla F(x_t)\\|^2\\\\\n\\leq &\n    \\frac{2(\\mathbb{E}F(x_1) - \\min_{x} F(x))}{\\alpha T}  + \\frac{2}{T}\\sum_{t=1}^{T} \\mathbb{E}\\|\\nabla F(x_t)\\| \\|\\mathbb{E}[\\nabla F(x_t) - \\widehat{v}(x_t)\\mid x_t]\\| \\\\\n    &\\qquad\\qquad\\qquad+  \\frac{4S_F\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|\\widehat{v}(x_t)-V(x_t)\\|^2+\n    \\frac{4S_F\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|V(x_t) - \\nabla F(x_t)\\|^2\\\\\n= &\n    \\mathcal{O}\\Big(\\frac{1}{\\alpha T} + S_F \\frac{1}{\\mu_g} \\Big(1- \\frac{\\mu_g}{2L_{g,1}}\\Big)^N +  S_F\\frac{N^2}{\\mu_g 2^{K/2}} + \\alpha S_F\\frac{KN^4}{\\mu_g^2} + \\alpha \\frac{1}{\\mu_g^2} \\Big(1- \\frac{\\mu_g}{2L_{g,1}}\\Big)^{2N}\\Big).\n\\end{aligned}')
('6.0.0.0', '\\widehat x_T')
('6.0.0.0', '{\\epsilon}')
('6.0.0.0', '\\mathcal{O}({\\epsilon}^2)')
('6.0.0.0', 'N = \\mathcal{O}(\\log({\\epsilon}^{-1}))')
('6.0.0.0', 'K = \\mathcal{O}(\\log({\\epsilon}^{-2}))')
('6.0.0.0', '\\alpha = \\mathcal{O}(T^{-1/2})')
('6.0.0.0', 'T = \\widetilde\\mathcal{O}({\\epsilon}^{-4})')
('6.0.0.0', 'g')
('6.0.0.0', '3KT=\\widetilde\\mathcal{O}({\\epsilon}^{-4})')
('6.0.0.0', 'f')
('6.0.0.0', 'f')
('6.0.0.0', 'T=\\widetilde{\\mathcal{O}}({\\epsilon}^{-4})')
('6.0.0.1', '\\begin{aligned}\n&\n    \\mathbb{E}\\|\\nabla F(\\widehat x_T)\\|^2 \\\\\n\\leq &\n    \\frac{2(\\mathbb{E}F(x_1) - \\min_{x} F(x))}{\\alpha T}  + \\frac{2}{T}\\sum_{t=1}^{T} \\mathbb{E}\\|\\nabla F(x_t)\\| \\|\\mathbb{E}[\\nabla F(x_t) - \\widehat{v}^K(x_t)\\mid x_t]\\| \\\\\n    &\\qquad\\qquad\\qquad\n    +\\frac{2S_F\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|\\widehat{v}^K(x_t) - \\nabla F(x_t)\\|^2\\\\\n\\leq &\n    \\frac{2(\\mathbb{E}F(x_1) - \\min_{x} F(x))}{\\alpha T}  + \\frac{2}{T}\\sum_{t=1}^{T} \\mathbb{E}\\|\\nabla F(x_t)\\| \\|\\mathbb{E}[\\nabla F(x_t) - \\widehat{v}^K(x_t)\\mid x_t]\\| \\\\\n    &\\qquad\\qquad\\qquad\n    +\\frac{4S_F\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|\\widehat{v}^K(x_t) - V(x_t)\\|^2 +\\frac{4S_F\\alpha}{T}\\sum_{t=1}^{T}\\mathbb{E}\\|V(x_t) - \\nabla F(x_t)\\|^2\\\\\n= &\n    \\mathcal{O}\\Big(\\frac{1}{\\alpha T} + S_F \\frac{1}{\\mu_g} \\Big(1- \\frac{\\mu_g}{2L_{g,1}}\\Big)^N +  S_F\\frac{N^2}{\\mu_g 2^{K/2}} + \\alpha S_F N^2 + \\alpha \\frac{1}{\\mu_g^2} \\Big(1- \\frac{\\mu_g}{2L_{g,1}}\\Big)^{2N}\\Big).\n\\end{aligned}')
('6.0.0.1', '\\widehat x_T')
('6.0.0.1', '{\\epsilon}')
('6.0.0.1', 'N = \\mathcal{O}(\\log({\\epsilon}^{-1}))')
('6.0.0.1', 'K = \\mathcal{O}(\\log({\\epsilon}^{-2}))')
('6.0.0.1', '\\alpha = \\mathcal{O}(T^{-1/2})')
('6.0.0.1', 'T = \\widetilde\\mathcal{O}({\\epsilon}^{-4})')
('6.0.0.1', 'g')
('6.0.0.1', '\\mathcal{O}(2^{K}T)=\\widetilde\\mathcal{O}({\\epsilon}^{-6})')
('6.0.0.1', 'f')
('6.0.0.1', 'f')
('6.0.0.1', 'T=\\widetilde{\\mathcal{O}}({\\epsilon}^{-4})')
('7', '\\nabla_1 y^*(x;\\xi)')
('7', 'g(x,y;\\eta,\\xi)')
('7', 'y')
('7', 'x')
('7', '\\xi')
('7', 'y^*(x;\\xi)')
('7', '\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}} \\nabla_2 g(x,y^*(x;\\xi);\\eta,\\xi) = 0.')
('7', 'x')
('7', '\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}}\n\\bigg[ \n\\nabla_{21}^2 g(x,y^*(x;\\xi);\\eta,\\xi) + \n\\nabla_{22}^2g(x,y^*(x;\\xi);\\eta,\\xi) \\nabla_1 y^*(x;\\xi)\n\\bigg]=0.')
('7', 'g(x,y;\\eta,\\xi)')
('7', '\\mu_g')
('7', 'y')
('7', 'x')
('7', '\\eta')
('7', '\\xi')
('7', '\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}}\\nabla_{22}^2g(x, y; \\eta, \\xi)\\in\\mathbb{S}^{d_y}_+')
('7', '\\nabla_1 y^*(x;\\xi)^\\top = -\n\\Big( \n\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}}\\nabla_{12}^2 g(x,y^*(x;\\xi);\\eta,\\xi)\n\\Big)\n\\Big( \n\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}}\\nabla_{22}^2g(x, y^*(x;\\xi); \\eta, \\xi)\n\\Big)^{-1},')
('7', '\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}}\\nabla_{12}^2 g(x,y^*(x;\\xi);\\eta,\\xi)')
('7', '\\mathbb{E}_{\\mathbb{P}_{\\eta\\mid\\xi}}\\nabla_{21}^2 g(x,y^*(x;\\xi);\\eta,\\xi)')
('8', "\\widehat c(x,y;\\xi) = \n\\nabla_{12}^2 g(x,y;\\eta',\\xi)\n\\widehat{\\Lambda}(x, y;\\xi)\n\\nabla_2 f(x,y;\\eta'',\\xi)")
('8', '\\mathcal{O}(d)')
('8', '\\nabla_{2}g(x, y; \\eta_n,\\xi)r_{n-1}')
('8', 'y')
('9', 't_0')
('9', 't')
('9', 't\\le t_0')
('9', '1/\\sqrt{t}')
('9', 't_0')
('9', '1/t')
('9', 't_0')
('9', 't_0')
('9.0', 'D=(a,b)')
('9.0', 'a\\in \\mathbb{R}^{d}')
('9.0', 'b\\in[C]')
('9.0', 'C')
('9.0', '\\ell_i(x, D)')
('9.0', '\\mathcal{L}(x; D) = -\\bm{b}^{T} x^\\top a + \\log\\big( \n1^\\top e^{x^\\top a}\n\\big),')
('9.0', 'x\\in\\mathbb{R}^{d\\times C}')
('9.0', '\\bm b\\in\\{0,1\\}^C')
('9.0', 'b')
('9.0', '\\lambda=2')
('9.0', '\\{\\text{5e-3},\\text{1e-2},\\text{5e-2},\\text{1e-1},\\text{2e-1}\\}')
('9.0', 'm')
('9.0', 'm')
('9.0', 'y_i(x)')
('9.0', 'm')
('9.0', '\\widehat{y}_{i,m}(x)')
('9.0', '\\widehat{y}_{i,0}(x)=x, \\quad \\widehat{y}_{i,k}(x)=\\widehat{y}_{i,k-1}(x)-\\gamma\\nabla\\left[ l_i(\\widehat{y}_{i,k-1}(x), D_{i,k-1}^{train})+\\frac{\\lambda}{2}\\|\\widehat{y}_{i,k-1}(x)-x\\|^2\\right],')
('9.0', '\\gamma')
('9.0', 'D_{i,k-1}^{train}\\sim \\rho_i')
('9.0', 'k=1,\\ldots,m')
('9.0', 'm')
('9.0', '\\{1,4,8,12\\}')
('9.0', 'm')
('9.1', 'l(w, \\eta) = h(w-\\eta)_+ + b(\\eta-w)_+,')
('9.1', 'h>0')
('9.1', 'b>0')
('9.1', 'l_{\\beta}(w, \\eta) = \\frac{h}{\\beta}\\log(1 + e^{\\beta(w-\\eta)}) + \\frac{b}{\\beta}\\log(1 + e^{\\beta(\\eta-w)}),')
('9.1', '\\beta=5')
('9.1', '\\xi')
('9.1', '100')
('9.1', '[-15,15]^{100}')
('9.1', '\\eta')
('9.1', '\\xi')
('9.1', '\\begin{aligned}\n\\eta&=f_{\\mathrm{NN}}(x; \\xi) + \\epsilon, \\quad \\epsilon\\sim \\mathcal{N}(0,1),\\\\\nf_{\\mathrm{NN}}(x; \\xi) &= 10*\\mathrm{Sigmoid}(W_3\\cdot\\mathrm{ReLU}(W_2\\cdot\\mathrm{ReLU}(W_1\\xi+b_1)+b_2) + b_3),\n\\end{aligned}')
('9.1', 'x:=(W_1,b_1,\\ldots, W_3,b_3)')
('9.1', '\\theta')
('9.1', '\\mathbb{E}_{(\\xi,\\eta)\\sim \\mathbb{P}^*}[l(f(x;\\xi), \\eta)]')
('9.1', '2\\cdot10^5')
('9.1', 'M=50')
('9.1', '\\xi')
('9.1', '\\{\\xi_i\\}_{i\\in[M]}')
('9.1', 'x_i')
('9.1', 'm\\in\\{10,30,50,100\\}')
('9.1', '\\eta')
('9.1', '\\mathbb{P}_{\\eta\\mid \\xi_i}')
('9.1', 'm=100')
('9.1', '\\label{problem:WDRO}\n\\min_{x}~\\max_{\\mathbb{P}}~\\Big\\{ \n\\mathbb{E}_{(\\xi,\\eta)\\sim\\mathbb{P}}[l_{\\beta}(f(x; \\xi); \\eta)] - \\lambda \\mathcal{W}(\\mathbb{P}, \\mathbb{P}^0)\n\\Big\\},')
('9.1', '\\mathcal{W}(\\cdot,\\cdot)')
('9.1', '\\lambda')
('9.1', '\\{1,10,50,100,150\\}')
