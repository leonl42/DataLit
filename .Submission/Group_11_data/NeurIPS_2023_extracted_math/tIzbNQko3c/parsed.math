('3.0', 'n_r')
('3.0', 'n_a')
('3.0', '{\\mathcal{P}}=({\\mathcal{S}},{\\mathcal{R}})')
('3.0', '{\\mathcal{S}}=[s_1,s_2,\\cdots,s_{n_r}]')
('3.0', 's_i')
('3.0', 'i')
('3.0', '{\\mathcal{R}}=[{\\bm{r}}_1,{\\bm{r}}_2...,{\\bm{r}}_{n_a}]\\in\\mathbb{R}^{n_a\\times 3}')
('3.0', '{\\bm{r}}_i')
('3.0', 'i')
('3.0', '{\\mathcal{F}}:{\\mathcal{X}}\\rightarrow{\\mathcal{Y}}')
('3.0', 'G')
('3.0', '{\\mathcal{F}}\\circ \\rho_{{\\mathcal{X}}}(x) = \\rho_{{\\mathcal{Y}}}\\circ{\\mathcal{F}}(x)')
('3.0', '\\rho_{{\\mathcal{X}}}')
('3.0', '\\rho_{{\\mathcal{Y}}}')
('3.0', 'g\\in G')
('3.0', '{\\mathcal{X}}')
('3.0', '{\\mathcal{Y}}')
('3.0', 'G')
('3.0', '\\rho_{{\\mathcal{Y}}}')
('3.0', '{\\mathcal{D}}=\\{{\\mathcal{P}}_1,{\\mathcal{P}}_2,...\\}')
('3.0', '\\phi({\\mathcal{S}},{\\mathcal{R}})')
('3.0', 'd')
('3.0', '{\\bm{h}}\\in\\mathbb{R}^{n_r\\times d}')
('3.0', '{\\bm{a}}\\in\\mathbb{R}^{n_a\\times d}')
('3.0', '{\\mathcal{R}}')
('3.1', '{\\mathcal{P}}^0')
('3.1', '{\\mathcal{P}}^t')
('3.1', 't=1,\\cdots,T')
('3.1', 'T')
('3.1', '{\\mathcal{P}}^0')
('3.1', 'T')
('3.1', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}  \n    q({\\mathcal{P}}^{1:T}|{\\mathcal{P}}^0)= \\begin{matrix}\\prod\\nolimits_{t=1}^T q({\\mathcal{P}}^{t}|{\\mathcal{P}}^{t-1})\\end{matrix},\\;\\;\n    p_{\\theta}({\\mathcal{P}}^{0:T-1}|{\\mathcal{P}}^T)= \\begin{matrix}\\prod\\nolimits_{t=1}^T p_{\\theta}({\\mathcal{P}}^{t-1}|{\\mathcal{P}}^{t})\\end{matrix},')
('3.1', 'q({\\mathcal{P}}^{t}|{\\mathcal{P}}^{t-1})')
('3.1', 't')
('3.1', 'p_{\\theta}({\\mathcal{P}}^{t-1}|{\\mathcal{P}}^{t})')
('3.1', '\\theta')
('3.1', 't')
('3.1', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt} \n    q({\\mathcal{P}}^{t}|{\\mathcal{P}}^{t-1})= q({\\mathcal{R}}^{t}|{\\mathcal{R}}^{t-1})\\cdot q({\\mathcal{S}}^{t}|{\\mathcal{S}}^{t-1}),\\;\\;%\\label{eq:indep_q}\n    p_{\\theta}({\\mathcal{P}}^{t-1}|{\\mathcal{P}}^{t})= p_{\\theta}({\\mathcal{R}}^{t-1}|{\\mathcal{P}}^t)\\cdot p_{\\theta}({\\mathcal{S}}^{t-1}|{\\mathcal{P}}^t),\\label{eq:indep_p}')
('3.1', '{\\bm{a}}^t')
('3.1', '{\\bm{h}}^t')
('3.1', '\\phi_{\\theta}({\\mathcal{S}}^t,{\\mathcal{R}}^t)')
('3.1', 'q({\\mathcal{P}}^{t}|{\\mathcal{P}}^{t-1})')
('3.1', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}  \n    q({\\mathcal{R}}^{t}|{\\mathcal{R}}^{t-1})\n    = {\\mathcal{N}}({\\mathcal{R}}^t;\\sqrt{1-\\beta_t}{\\mathcal{R}}^{t-1},\\beta_t I),\\;\\;\n    q({\\mathcal{S}}^t|{\\mathcal{S}}^{t-1})=\\text{random\\_mask}({\\mathcal{S}}^{t-1},\\rho_t),\\label{eq:diffusion_struct}')
('3.1', '\\beta_1,...,\\beta_T')
('3.1', '\\rho_1,...,\\rho_T')
('3.1', '\\text{random\\_mask}({\\mathcal{S}}^{t-1},\\rho_t)')
('3.1', '{\\mathcal{S}}^{t-1}')
('3.1', '\\rho_t')
('3.1', 't')
('3.1', 'p_{\\theta}({\\mathcal{R}}^{t-1}|{\\mathcal{P}}^{t})')
('3.1', '\\mu_\\theta({\\mathcal{P}}^t,t)')
('3.1', '\\sigma_t')
('3.1', '{\\mathcal{R}}^t')
('3.1', '\\mu_\\theta({\\mathcal{P}}^t,t)')
('3.1', '\\setlength{\\abovedisplayskip}{1pt}\n\\setlength{\\belowdisplayskip}{1pt}\n    p_{\\theta}({\\mathcal{R}}^{t-1}|{\\mathcal{P}}^t)={\\mathcal{N}}({\\mathcal{R}}^{t-1};\\mu_\\theta({\\mathcal{P}}^t,t),\\sigma_t^2 I),\\;\\;\n    \\mu_\\theta({\\mathcal{P}}^t,t)\n    =\\begin{matrix}\\frac{1}{\\sqrt{\\alpha_t}}\\left({\\mathcal{R}}^t-\\frac{\\beta_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\epsilon_\\theta({\\mathcal{P}}^t,t)\\right)\\end{matrix},\\label{eq:diffusion_struct_noise}')
('3.1', '\\alpha_t=1-\\beta_t')
('3.1', '\\bar{\\alpha}_t=\\prod_{s=1}^t \\alpha_s')
('3.1', '\\epsilon_\\theta(\\cdot)')
('3.1', '{\\mathcal{R}}^t')
('3.1', '{\\bm{a}}^t')
('3.1', '{\\mathcal{R}}^t')
('3.1', '{\\bm{r}}^t')
('3.1', '{\\mathcal{R}}^t')
('3.1', '(i,j)')
('3.1', '\\|{\\bm{r}}_{i}^t-{\\bm{r}}_{j}^t\\|_2')
('3.1', '{\\bm{a}}_{i}^{t}')
('3.1', '{\\bm{a}}_{j}^{t}')
('3.1', 'm_{i,j}')
('3.1', '\\setlength{\\abovedisplayskip}{0.5pt}\n\\setlength{\\belowdisplayskip}{0.5pt}\n    [\\epsilon_\\theta({\\mathcal{P}}^t,t)]_i =\\begin{matrix} \\sum\\nolimits_{j\\in{\\mathcal{N}}^{t}(i)} m_{i,j}\\cdot \\frac{{\\bm{r}}_{i}^t-{\\bm{r}}_{j}^t}{\\left\\|{\\bm{r}}_{i}^t-{\\bm{r}}_{j}^t\\right\\|_2}\\end{matrix},\\;\\; \\text{with}\\;\n    m_{i,j} =\\begin{small} \\text{MLP}({\\bm{a}}_{i}^{t},{\\bm{a}}_{j}^{t}, \\text{MLP}(\\|{\\bm{r}}_{i}^t-{\\bm{r}}_{j}^t\\|_2))\n    \\end{small},')
('3.1', '{\\mathcal{N}}^{t}(i)')
('3.1', 'i')
('3.1', '{\\mathcal{P}}^t')
('3.1', '\\epsilon_\\theta({\\mathcal{P}}^t,t)')
('3.1', 'm_{i,j}')
('3.1', '{\\mathcal{R}}^t')
('3.1', '{\\bm{r}}_{i}^t-{\\bm{r}}_{j}^t')
('3.1', '{\\mathcal{R}}^t')
('3.1', 'p_{\\theta}({\\mathcal{S}}^{t-1}|{\\mathcal{P}}^{t})')
('3.1', 'p_{\\theta}({\\mathcal{S}}^{t-1}|{\\mathcal{P}}^{t})')
('3.1', 'q({\\mathcal{S}}^{t-1}|{\\mathcal{S}}^{t},\\tilde{{\\mathcal{S}}}^{0})')
('3.1', '\\tilde{p}\\theta')
('3.1', '{\\mathcal{S}}^0')
('3.1', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}\n    p_\\theta({\\mathcal{S}}^{t-1}|{\\mathcal{P}}^t)\\propto\n    \\begin{matrix}\n    \\sum\\nolimits_{\\tilde{{\\mathcal{S}}}^0}\n    q({\\mathcal{S}}^{t-1}|{\\mathcal{S}}^{t},\\tilde{{\\mathcal{S}}}^{0})\\cdot\n    \\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}^0|{\\mathcal{P}}^t)\\end{matrix},\\label{eq:diffusion_seq_p}')
('3.1', '\\tilde{p}_\\theta')
('3.1', '{\\bm{h}}^t')
('3.1', 'i')
('3.1', '{\\mathcal{S}}^t')
('3.1', '{\\bm{h}}_{i}^t')
('3.1', 's^0_{i}')
('3.1', '{\\mathcal{S}}^0')
('3.1', '\\label{eq:generation_seq}\n\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}\n\\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}^0|{\\mathcal{P}}^t)=\\begin{matrix}\n    \\prod\\nolimits_i\n    \\tilde{p}_\\theta(\\tilde{s}^0_{i}|{\\mathcal{P}}^t)\n    \\end{matrix}\n    =\\begin{matrix}\n    \\prod\\nolimits_i\\text{Softmax}(\\tilde{s}_{i}^0|\\text{MLP}({\\bm{h}}_{i}^t))\n    \\end{matrix},')
('3.2', '\\setlength{\\abovedisplayskip}{0pt}\n\\setlength{\\belowdisplayskip}{0pt}\n    \\begin{adjustbox}{max width=0.85\\columnwidth}\n        $\\begin{matrix}\n        {\\mathcal{L}}\\coloneqq \\mathbb{E}\\left[\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{P}}^{t-1}|{\\mathcal{P}}^t,{\\mathcal{P}}^0)||p_\\theta({\\mathcal{P}}^{t-1}|{\\mathcal{P}}^t)\\right)\\right].\n        \\end{matrix}$\n    \\end{adjustbox}\n    \\label{eq:diff_obj}')
('3.2', '{\\mathcal{L}}^{({\\mathcal{R}})}')
('3.2', '{\\mathcal{L}}^{({\\mathcal{S}})}')
('3.2', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}\n\\begin{split}\n{\\mathcal{L}}^{({\\mathcal{R}})}\\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{R}}^{t-1}|{\\mathcal{R}}^{t},{\\mathcal{R}}^0)||p_\\theta({\\mathcal{R}}^{t-1}|{\\mathcal{P}}^t)\\right)\\end{matrix}\\right],\n\\\\\n{\\mathcal{L}}^{({\\mathcal{S}})}\\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{S}}^{t-1}|{\\mathcal{S}}^{t},{\\mathcal{S}}^0)||p_\\theta({\\mathcal{S}}^{t-1}|{\\mathcal{P}}^t)\\right)\\end{matrix}\\right].\n\\end{split}')
('3.2', '{\\mathcal{L}}^{({\\mathcal{R}})}')
('3.2', '\\epsilon_\\theta')
('3.2', '\\epsilon')
('3.2', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}\n    {\\mathcal{L}}^{({\\mathcal{R}})}\n    =\\begin{matrix}\\sum\\nolimits_{t=1}^T \\gamma_t \\mathbb{E}_{\\epsilon\\sim {\\mathcal{N}}(0,I)}\\left[\\|\\epsilon - \\epsilon_\\theta({\\mathcal{P}}^t,t)\\|_2^2\\right]\\end{matrix},')
('3.2', '\\gamma_t')
('3.2', '\\beta_1,...,\\beta_t')
('3.2', '\\gamma_t=1')
('3.2', '{\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{R}})}')
('3.2', '\\epsilon_\\theta')
('3.2', '{\\mathcal{R}}^t')
('3.2', '{\\mathcal{R}}^t')
('3.2', '\\epsilon')
('3.2', '\\hat{\\epsilon}')
('3.2', '{\\mathcal{L}}^{({\\mathcal{S}})}')
('3.2', 'p_\\theta({\\mathcal{S}}^{t-1}|{\\mathcal{P}}^t)')
('3.2', '\\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}^0|{\\mathcal{P}}^t)')
('3.2', 'q({\\mathcal{S}}^{t-1}|{\\mathcal{S}}^{t},\\tilde{{\\mathcal{S}}}^{0})')
('3.2', 't')
('3.2', '{\\mathcal{L}}^{({\\mathcal{S}})}')
('3.2', '\\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}^0|{\\mathcal{P}}^t)')
('3.2', '{\\mathcal{S}}^0')
('3.2', 's_{i}^0')
('3.2', '\\setlength{\\abovedisplayskip}{3pt}\n\\setlength{\\belowdisplayskip}{3pt}\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{S}})}\n    =\\begin{matrix}\\sum\\nolimits_{t=1}^T \\sum\\nolimits_i \\text{CE}\\left(s_{i}^0,\\tilde{p}_\\theta(s_{i}^{0}|{\\mathcal{P}}^t)\\right)\\end{matrix},')
('3.2', '(\\cdot,\\cdot)')
('3.2', '\\setlength{\\abovedisplayskip}{2pt}\n\\setlength{\\belowdisplayskip}{1pt}\n    {\\mathcal{L}}_{\\text{simple}}\n    = \n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{R}})}+\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{S}})}.')
('3.3', 'T=100')
('3.3', 't=10,...,100')
('3.3', 't=1,...,9')
('4.0', '{\\mathcal{P}}=({\\mathcal{S}},{\\mathcal{R}})')
('4.0', '{\\mathcal{P}}_1=({\\mathcal{S}}_1,{\\mathcal{R}}_1)')
('4.0', '{\\mathcal{P}}_2=({\\mathcal{S}}_2,{\\mathcal{R}}_2)')
('4.0', '{\\mathcal{S}}_2')
('4.0', '{\\mathcal{S}}_1')
('4.0', '{\\mathcal{R}}_2')
('4.0', '\\text{perturb}({\\mathcal{R}}_1,\\epsilon)')
('4.0', '\\epsilon\\in[0,2\\pi)^{n_r\\times 4}')
('4.0', '\\text{perturb}(\\cdot, \\cdot)')
('4.1', '{\\mathcal{P}}^{0:T}_1')
('4.1', '{\\mathcal{P}}^{0:T}_2')
('4.1', '{\\mathcal{P}}_1')
('4.1', '{\\mathcal{P}}_2')
('4.1', '{\\mathcal{P}}_1^0={\\mathcal{P}}_1=({\\mathcal{S}}_1,{\\mathcal{R}}_1)')
('4.1', 'q({\\mathcal{P}}_1^{1:T}|{\\mathcal{P}}_1^0)=q({\\mathcal{R}}_1^{1:T}|{\\mathcal{R}}_1^0)q({\\mathcal{S}}_1^{1:T}|{\\mathcal{S}}_1^0)')
('4.1', '{\\mathcal{R}}_1^{1:T}')
('4.1', '{\\mathcal{S}}^{1:T}')
('4.1', '{\\mathcal{P}}^{0:T}_1=\\{({\\mathcal{S}}^t_1, {\\mathcal{R}}^t_1)\\}_{t=0}^T')
('4.1', '{\\mathcal{P}}_1')
('4.1', '{\\mathcal{P}}_2^{0:T}=\\{({\\mathcal{S}}^t_2, {\\mathcal{R}}^t_2)\\}_{t=0}^T')
('4.2', '{\\mathcal{L}}=\\frac{1}{2}({\\mathcal{L}}^{(2\\rightarrow 1)}+{\\mathcal{L}}^{(1\\rightarrow 2)})')
('4.2', '\\setlength{\\abovedisplayskip}{1pt}\n\\setlength{\\belowdisplayskip}{1pt}\n    {\\mathcal{L}}^{(b\\rightarrow a)} \\coloneqq \\mathbb{E}_{{\\mathcal{P}}_{a}^{0:T},{\\mathcal{P}}_{b}^{0:T}}\n    \\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\mathcal{P}}_a^0)||p({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})\\right)\\end{matrix}\\right], \\label{eq:elbo1}')
('4.2', 'b\\rightarrow a')
('4.2', '2\\rightarrow 1')
('4.2', '1\\rightarrow 2')
('4.2', '{\\bm{\\mathcal{P}}}_b^{0:T}')
('4.2', '{\\mathcal{P}}_b^{0:T}')
('4.2', '{\\mathcal{L}}^{(2\\rightarrow 1)}')
('4.2', 'q({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\mathcal{P}}_1^0)')
('4.2', 'q({\\mathcal{P}}_1^{t}|{\\mathcal{P}}_1^{t-1})')
('4.2', '{\\mathcal{P}}_1^{t-1}')
('4.2', '{\\mathcal{P}}_1^t')
('4.2', '{\\bm{\\mathcal{P}}}_2^{0:T}')
('4.2', '{\\bm{\\mathcal{P}}}_2^{0:T}')
('4.2', '{\\mathcal{P}}_1')
('4.2', '{\\mathcal{P}}_2')
('4.2', '{\\mathcal{P}}_2')
('4.2', '{\\mathcal{P}}_1^{t-1}')
('4.2', 'p({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^{0:T})')
('4.2', 'p_\\theta({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)')
('4.2', '{\\mathcal{S}}_1^t')
('4.2', '{\\mathcal{S}}_2^t')
('4.2', '\\setlength{\\abovedisplayskip}{1pt}\n\\setlength{\\belowdisplayskip}{1pt}\n    {\\mathcal{L}}_{\\text{simple}}\n    = \\begin{matrix}\n    \\frac{1}{2}(\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{R}},2\\rightarrow 1)}+\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{S}},2\\rightarrow1)}+\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{R}},1\\rightarrow2)}+\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{S}},1\\rightarrow2)}\n    )\\end{matrix},')
('4.2', '{\\mathcal{L}}_{\\text{simple}}^{(\\cdot,b\\rightarrow a)}')
('4.2', '{\\mathcal{P}}_a^{0:T}')
('4.2', '{\\mathcal{P}}_b^{0:T}')
('4.3', '{\\mathcal{S}}')
('4.3', '{\\mathcal{R}}')
('4.3', '{\\mathcal{P}}=({\\mathcal{S}},{\\mathcal{R}})')
('5', '\\rho')
('5', '\\rho')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\rho')
('5', '\\rho')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5.0', '\\rho')
('5.2', '\\rho')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', 'T=1')
('5.2', 'T=100')
('5.3', '\\rho')
('5.3', '\\rho')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('9', 'p_\\theta({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)')
('9.0', '{\\bm{\\mathcal{P}}}_1^{0:T}')
('9.0', '{\\bm{\\mathcal{P}}}_2^{0:T}')
('9.0', '{\\mathcal{P}}_1^{0:T}')
('9.0', '{\\mathcal{P}}_2^{0:T}')
('9.0', 'p_\\theta({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)')
('9.0', '{\\mathcal{P}}_2^t')
('9.0', '{\\bm{a}}_2^t')
('9.0', '{\\bm{h}}_2^t')
('9.0', '{\\mathcal{P}}_2^t')
('9.0', '{\\mathcal{D}}')
('9.0', '\\alpha')
('9.0', '\\phi_\\theta')
('9.0', '{\\mathcal{R}}_1^t')
('9.0', '\\epsilon_\\theta({\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t,t)')
('9.0', '{\\mathcal{R}}_1^t')
('9.0', '{\\mathcal{R}}_1^t')
('9.0', '{\\mathcal{R}}_2^t')
('9.0', '\\epsilon_\\theta')
('9.0', '{\\mathcal{R}}_2^t')
('9.0', '{\\bm{a}}_{2}^t')
('9.0', '{\\mathcal{R}}_2^t')
('9.0', '{\\bm{r}}_{1}^t')
('9.0', '{\\mathcal{R}}_1^t')
('9.0', '\\begin{aligned}\n_i =\\begin{matrix} \\sum\\nolimits_{j\\in{\\mathcal{N}}^{t}_1(i)} m_{i,j}\\cdot \\frac{{\\bm{r}}_{1i}^t-{\\bm{r}}_{1j}^t}{\\left\\|{\\bm{r}}_{1i}^t-{\\bm{r}}_{1j}^t\\right\\|_2}\\end{matrix},\\; \\text{with}\\;\n    m_{i,j} =\\begin{small} \\text{MLP}({\\bm{a}}_{2i}^{t},{\\bm{a}}_{2j}^{t}, \\text{MLP}(\\|{\\bm{r}}_{1i}^t-{\\bm{r}}_{1j}^t\\|_2))\n    \\end{small},\n\\end{aligned}')
('9.0', '{\\mathcal{N}}^{t}_1(i)')
('9.0', 'i')
('9.0', '{\\mathcal{P}}_1^t')
('9.0', '\\epsilon_\\theta({\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t,t)')
('9.0', 'm_{i,j}')
('9.0', '{\\mathcal{R}}_1^t')
('9.0', '{\\mathcal{R}}_2^t')
('9.0', '{\\bm{r}}_{1i}^t-{\\bm{r}}_{1j}^t')
('9.0', '{\\mathcal{R}}_1^t')
('9.0', '{\\mathcal{S}}_1^0')
('9.0', '\\tilde{p}_\\theta')
('9.0', '{\\mathcal{S}}_2^t')
('9.0', 'i')
('9.0', '{\\mathcal{S}}_2^t')
('9.0', '{\\bm{h}}_{2i}^t')
('9.0', 's^0_{1i}')
('9.0', '{\\mathcal{S}}_1^0')
('9.0', '\\begin{aligned}\n% \\label{eq:generation_seq}\n\\tilde{p}_\\theta({\\mathcal{S}}^0_{1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)=\\begin{matrix}\n    \\prod\\nolimits_i\n    \\tilde{p}_\\theta(s^0_{1i}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)\n    \\end{matrix}\n    =\\begin{matrix}\n    \\prod\\nolimits_i\\text{Softmax}(s_{1i}^0|\\text{MLP}({\\bm{h}}_{2i}^t))\n    \\end{matrix},\n\\end{aligned}')
('9.1', '{\\mathcal{L}}^{(2\\rightarrow 1)}')
('9.1', '{\\mathcal{L}}^{({\\mathcal{R}},2\\rightarrow 1)}')
('9.1', '{\\mathcal{L}}^{({\\mathcal{S}},2\\rightarrow 1)}')
('9.1', '\\begin{aligned}\n    {\\mathcal{L}}^{({\\mathcal{R}},2\\rightarrow 1)}\n    \\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{R}}_1^{t-1}|{\\mathcal{R}}_1^{t},{\\mathcal{R}}_1^0)||p_\\theta({\\mathcal{R}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)\\right)\\end{matrix}\\right],\\label{app:eq:elboR}\\\\\n    {\\mathcal{L}}^{({\\mathcal{S}},2\\rightarrow 1)}\n    \\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{S}}_1^{t-1}|{\\mathcal{S}}_1^{t},{\\mathcal{S}}_1^0)||p_\\theta({\\mathcal{S}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)\\right)\\end{matrix}\\right].\n    \\label{app:eq:elboS}\n\\end{aligned}')
('9.1', '{\\mathcal{L}}^{({\\mathcal{R}},2\\rightarrow 1)}')
('9.1', '\\begin{aligned}\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{R}},2\\rightarrow 1)}\n    =\\begin{matrix}\\sum\\nolimits_{t=1}^T \\mathbb{E}_{\\epsilon\\sim {\\mathcal{N}}(0,I)}\\left[\\|\\epsilon - \\epsilon_\\theta({\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t,t)\\|_2^2\\right]\\end{matrix},\n\\end{aligned}')
('9.1', '{\\mathcal{L}}^{({\\mathcal{S}},2\\rightarrow 1)}')
('9.1', '\\begin{aligned}\n    {\\mathcal{L}}_{\\text{simple}}^{({\\mathcal{S}},2\\rightarrow 1)}\n    =\\begin{matrix}\\sum\\nolimits_{t=1}^T \\sum\\nolimits_i \\text{CE}\\left(s_{1i}^0,\\tilde{p}_\\theta(s_{1i}^{0}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)\\right)\\end{matrix}.\n\\end{aligned}')
('9.2', '{\\mathcal{P}}_2=({\\mathcal{S}}_2,{\\mathcal{R}}_2)')
('9.2', '{\\mathcal{S}}_2={\\mathcal{S}}_1,{\\mathcal{R}}_2={\\mathcal{R}}_1+\\epsilon')
('9.2', '\\epsilon\\in\\mathbb{R}^{n_a\\times 3}')
('10.0', '{\\bm{P}}_1^{0:T}')
('10.0', '{\\bm{P}}_2^{0:T}')
('10.0', '{\\bm{\\mathcal{P}}}_1^{0:T}')
('10.0', '{\\bm{\\mathcal{P}}}_2^{0:T}')
('10.0', '\\begin{aligned}\n    I({\\bm{P}}_1^{0:T};{\\bm{P}}_2^{0:T})\n    \\ge -\\frac{1}{2}({\\mathcal{L}}^{(2\\rightarrow 1)}+{\\mathcal{L}}^{(1\\rightarrow 2)}) + C,\n\\end{aligned}')
('10.0', 'C')
('10.0', '{\\mathcal{P}}_b^{0:T}')
('10.0', '{\\mathcal{P}}_a^{0:T}')
('10.0', '\\begin{aligned}\n    {\\mathcal{L}}^{(b\\rightarrow a)} \\coloneqq \\mathbb{E}_{{\\mathcal{P}}_{a}^{0:T},{\\mathcal{P}}_{b}^{0:T}}\n    \\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\mathcal{P}}_a^0)||p({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})\\right)\\end{matrix}\\right],% \\label{eq:elbo1}\n    % \\gL^{(1\\rightarrow 2)} &\\coloneqq \\E_q\\left[\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q(\\gP_2^{t-1}|\\gP_2^t,\\gP_2^0)||p(\\gP_2^{t-1}|\\gP_2^t,\\gP_1^{0:T})\\right)\\right].\\label{eq:elbo2}\n\\end{aligned}')
('10.0', 'b\\rightarrow a')
('10.0', '2\\rightarrow 1')
('10.0', '1\\rightarrow 2')
('10.0', '\\begin{aligned}\n \\label{eq:def_mi}\n    I({\\bm{P}}_1^{0:T};{\\bm{P}}_2^{0:T})\n    &=\\begin{matrix}\\mathbb{E}_{{\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T}\\sim p({\\bm{P}}_1^{0:T},{\\bm{P}}_2^{0:T})}\\left[\\log \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T})}{p({\\bm{\\mathcal{P}}}_1^{0:T})p({\\bm{\\mathcal{P}}}_2^{0:T})}\\right]\\end{matrix},\n\\end{aligned}')
('10.0', 'p({\\bm{P}}_1^{0:T},{\\bm{P}}_2^{0:T})=p({\\bm{P}}_1^0,{\\bm{P}}_2^0)q({\\bm{P}}_1^{1:T}|{\\bm{P}}_1^0)q({\\bm{P}}_2^{1:T}|{\\bm{P}}_2^0)')
('10.0', '\\begin{aligned}\n    &I({\\bm{P}}_1^{0:T};{\\bm{P}}_2^{0:T})\n    =\\mathbb{E}\\left[\\log \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T})}{p({\\bm{\\mathcal{P}}}_1^0)q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)p({\\bm{\\mathcal{P}}}_2^0)q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)}\\right]\\\\\n    \\ge& \\mathbb{E}\\left[\n    \\log  \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T})}{\\sqrt{p({\\bm{\\mathcal{P}}}_1^0)p({\\bm{\\mathcal{P}}}_2^0)}q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)}\n    \\right] \\\\\n    =& \\frac{1}{2}\\mathbb{E}\\left[\n    \\log  \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T})^2}{p({\\bm{\\mathcal{P}}}_1^0)p({\\bm{\\mathcal{P}}}_2^0)q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)^2q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)^2}\n    \\right] \\\\\n    =& \\frac{1}{2}\\mathbb{E}\\left[\n    \\log\\frac{p({\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T})}{p({\\bm{\\mathcal{P}}}_2^0)q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)} +\n    \\log \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T},{\\bm{\\mathcal{P}}}_2^{0:T})}{p({\\bm{\\mathcal{P}}}_1^0)q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)}\n    \\right]\\\\\n    =&\n    \\frac{1}{2}\n    \\mathbb{E}\\left[\\log \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T}|{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)}+\\log \\frac{p({\\bm{\\mathcal{P}}}_2^{0:T}|{\\bm{\\mathcal{P}}}_1^{0:T})}{q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)}\\right].\n\\end{aligned}')
('10.0', '{\\mathcal{P}}_1^{0:T}')
('10.0', '{\\mathcal{P}}_2^{0:T}')
('10.0', 'p({\\mathcal{P}}_1^{0:T},{\\mathcal{P}}_2^{0:T})=p({\\mathcal{P}}_1^0,{\\mathcal{P}}_2^0)q({\\mathcal{P}}_1^{1:T}|{\\mathcal{P}}_1^0)q({\\mathcal{P}}_2^{1:T}|{\\mathcal{P}}_2^0)')
('10.0', '\\begin{aligned}\n\\begin{matrix}\n    \\frac{1}{2}\n    \\mathbb{E}\\left[\\log \\frac{p({\\bm{\\mathcal{P}}}_1^{0:T}|{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\bm{\\mathcal{P}}}_1^{1:T}|{\\bm{\\mathcal{P}}}_1^0)}+\\log \\frac{p({\\bm{\\mathcal{P}}}_2^{0:T}|{\\bm{\\mathcal{P}}}_1^{0:T})}{q({\\bm{\\mathcal{P}}}_2^{1:T}|{\\bm{\\mathcal{P}}}_2^0)}\\right]\n    \\approx\n    \\frac{1}{2}\n    \\mathbb{E}_{{\\mathcal{P}}_{1}^{0:T},{\\mathcal{P}}_{2}^{0:T}}\\left[\\log \\frac{p({\\mathcal{P}}_1^{0:T}|{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\mathcal{P}}_1^{1:T}|{\\mathcal{P}}_1^0)}+\\log \\frac{p({\\mathcal{P}}_2^{0:T}|{\\bm{\\mathcal{P}}}_1^{0:T})}{q({\\mathcal{P}}_2^{1:T}|{\\mathcal{P}}_2^0)}\\right]\n\\end{matrix}\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    &\\mathbb{E}_{{\\mathcal{P}}_{1}^{0:T},{\\mathcal{P}}_2^{0:T}}\\left[\\log \\frac{p({\\mathcal{P}}_1^{0:T}|{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\mathcal{P}}_1^{1:T}|{\\mathcal{P}}_1^0)}\\right]\\\\\n    =&\\mathbb{E}_{{\\mathcal{P}}_{1}^{0:T},{\\mathcal{P}}_2^{0:T}}\\left[\\sum_{t=1}^T\\log \\frac{p({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\mathcal{P}}_1^{t}|{\\mathcal{P}}_1^{t-1})}\\right]\\\\\n    =&\\mathbb{E}_{{\\mathcal{P}}_{1}^{0:T},{\\mathcal{P}}_2^{0:T}}\\left[\\log \\frac{({\\mathcal{P}}_1^0|{\\mathcal{P}}_1^1,{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\mathcal{P}}_1^{1}|{\\mathcal{P}}_1^{0})}+\n    \\sum_{t=2}^T\\log\\left( \\frac{p({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^{t},{\\mathcal{P}}_1^0)}\\cdot\\frac{q({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^{0})}{q({\\mathcal{P}}_1^{t}|{\\mathcal{P}}_1^{0})}\\right)\\right]\\\\\n    =&\\mathbb{E}_{{\\mathcal{P}}_{1}^{0:T},{\\mathcal{P}}_2^{0:T}}\\left[-\\log q({\\mathcal{P}}_1^{T}|{\\mathcal{P}}_1^{0})+\\log p({\\mathcal{P}}_1^0|{\\mathcal{P}}_1^1,{\\bm{\\mathcal{P}}}_2^{0:T})+\n    \\sum_{t=2}^T\\log \\frac{p({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^{0:T})}{q({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^{t},{\\mathcal{P}}_1^0)}\\right] \\\\\n    =&-\\mathbb{E}_{{\\mathcal{P}}_{1}^{0:T},{\\mathcal{P}}_{2}^{0:T}}\\left[\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\mathcal{P}}_1^0)||p({\\mathcal{P}}_1^{t-1}|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^{0:T})\\right)\\right] + C^{(2\\rightarrow 1)}\\\\\n    =&-{\\mathcal{L}}^{(2\\rightarrow 1)}+ C^{(2\\rightarrow 1)},\n\\end{aligned}')
('10.0', 'p({\\mathcal{P}}_1^0|{\\mathcal{P}}_1^1,{\\bm{\\mathcal{P}}}_2^{0:T})')
('10.0', 'C^{(2\\rightarrow 1)}')
('10.0', '\\Box')
('10.1', '\\begin{aligned}\n\\label{app_eq:q_assumption}\n    q({\\mathcal{P}}_a^{t}|{\\mathcal{P}}_a^{t-1})= q({\\mathcal{R}}_a^{t}|{\\mathcal{R}}_a^{t-1})\\cdot q({\\mathcal{S}}_a^{t}|{\\mathcal{S}}_a^{t-1}),\n\\end{aligned}')
('10.1', '\\begin{aligned}\n\\label{app_eq:p_assumption}\n    &p_{\\theta}({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^{t},{\\bm{\\mathcal{P}}}_b^{t})= p_{\\theta}({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{t})\\cdot p_{\\theta}({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{t}),\n\\end{aligned}')
('10.1', '\\begin{aligned}\n\\label{app_eq:loss_decomp}\n    {\\mathcal{L}}^{(b\\rightarrow a)}&={\\mathcal{L}}^{({\\mathcal{R}},b\\rightarrow a)} + {\\mathcal{L}}^{({\\mathcal{S}},b\\rightarrow a)},\n\\end{aligned}')
('10.1', '\\begin{aligned}\n    {\\mathcal{L}}^{(b\\rightarrow a)} \\coloneqq& \\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\mathcal{P}}_a^0)||p_\\theta({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{t})\\right)\\end{matrix}\\right],\\\\\n    {\\mathcal{L}}^{({\\mathcal{R}},b\\rightarrow a)}\n    \\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^{t},{\\mathcal{R}}_a^0)||p_\\theta({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\right)\\end{matrix}\\right],\\\\\n    {\\mathcal{L}}^{({\\mathcal{S}},b\\rightarrow a)}\n    \\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^{t},{\\mathcal{S}}_a^0)||p_\\theta({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\right)\\end{matrix}\\right],\n\\end{aligned}')
('10.1', 'b\\rightarrow a')
('10.1', '{\\mathcal{P}}_b^{0:T}')
('10.1', '{\\mathcal{P}}_a^{0:T}')
('10.1', '{\\mathcal{L}}_t^{(\\cdot)}')
('10.1', '{\\mathcal{L}}^{(\\cdot)}')
('10.1', '\\begin{aligned}\n    &{\\mathcal{L}}_t^{(b\\rightarrow a)}\n    = D_{\\text{KL}}\\left(q({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\mathcal{P}}_a^0)||p_\\theta({\\mathcal{P}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})\\right) \\\\\n    &=D_{\\text{KL}}\\left(\\left[q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^t,{\\mathcal{R}}_a^0)q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^t,{\\mathcal{S}}_a^0)\\right]||\\left[p_\\theta({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})p_\\theta({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})\\right]\\right)\\\\\n    &=D_{\\text{KL}}\\left(q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^t,{\\mathcal{R}}_a^0)||p_\\theta({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})\\right) +\n    D_{\\text{KL}}\\left(q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^t,{\\mathcal{S}}_a^0)||p_\\theta({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^{0:T})\\right) \\\\\n    &= {\\mathcal{L}}_t^{({\\mathcal{R}},b\\rightarrow a)}+{\\mathcal{L}}_t^{({\\mathcal{S}},b\\rightarrow a)},\n\\end{aligned}')
('10.1', 'T')
('10.1', '\\Box')
('10.2', '\\begin{aligned}\n    q({\\mathcal{R}}_a^{t}|{\\mathcal{R}}_a^{t-1})\n    = {\\mathcal{N}}({\\mathcal{R}}_a^t;\\sqrt{1-\\beta_t}{\\mathcal{R}}_a^{t-1},\\beta_t I),\n\\end{aligned}')
('10.2', '\\begin{aligned}\n    &p_{\\theta}({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\n    ={\\mathcal{N}}({\\mathcal{R}}_a^{t-1};\\mu_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t),\\sigma_t^2 I),\\\\\n    &\\mu_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\n    =\\frac{1}{\\sqrt{\\alpha_t}}\\left({\\mathcal{R}}_a^t-\\frac{\\beta_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\epsilon_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\\right),\n\\end{aligned}')
('10.2', '\\begin{aligned}\n    {\\mathcal{L}}^{({\\mathcal{R}},b\\rightarrow a)}\n    \\coloneqq&\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^{t},{\\mathcal{R}}_a^0)||p_\\theta({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\right)\\end{matrix}\\right],\n\\end{aligned}')
('10.2', '\\begin{aligned}\n    {\\mathcal{L}}^{({\\mathcal{R}},b\\rightarrow a)}\n    =\\begin{matrix}\\sum\\nolimits_{t=1}^T \\gamma_t \\mathbb{E}_{\\epsilon\\sim {\\mathcal{N}}(0,I)}\\left[\\|\\epsilon - \\epsilon_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\\|_2^2\\right]\\end{matrix},\n\\end{aligned}')
('10.2', '\\gamma_t=\\frac{\\beta_t}{2\\alpha_t(1-\\bar{\\alpha}_{t-1})}')
('10.2', '\\alpha_t=1-\\beta_t')
('10.2', '\\bar{\\alpha}_t=\\prod_{s=1}^t \\alpha_s')
('10.2', 'b\\rightarrow a')
('10.2', '2\\rightarrow 1')
('10.2', '1\\rightarrow 2')
('10.2', 'q({\\mathcal{R}}_a^{t}|{\\mathcal{R}}_a^0)={\\mathcal{N}}({\\mathcal{R}}_a^t;\\sqrt{\\bar{\\alpha_t}}{\\mathcal{R}}_a^0,(1-\\bar{\\alpha}_t)I)')
('10.2', '\\epsilon_i')
('10.2', 'i')
('10.2', '\\begin{aligned}\n    {\\mathcal{R}}_a^{t}\n    &=\\sqrt{\\alpha_t}{\\mathcal{R}}_a^{t-1} + \\sqrt{\\beta_t}\\epsilon_t\\\\\n    &=\\sqrt{\\alpha_{t-1}\\alpha_t}{\\mathcal{R}}_a^{t-2} + \\sqrt{\\alpha_{t-1}\\beta_{t-1}}\\epsilon_{t-1}+\\sqrt{\\beta_t}\\epsilon_t\\\\\n    &=\\cdots\\\\\n    &=\\sqrt{\\bar{\\alpha}_t}{\\mathcal{R}}_a^0 + \\sqrt{\\alpha_t\\alpha_{t-1}...\\alpha_2\\beta_1}\\epsilon_1 + \\cdots + \\sqrt{\\alpha_{t-1}\\beta_{t-1}}\\epsilon_{t-1}+\\sqrt{\\beta_t}\\epsilon_t,\n\\end{aligned}')
('10.2', '{\\mathcal{R}}_a^{t}')
('10.2', '\\sqrt{\\bar{\\alpha}_t}{\\mathcal{R}}_a^0')
('10.2', '(\\alpha_t\\alpha_{t-1}...\\alpha_2\\beta_1+\\cdots+\\alpha_{t-1}\\beta_{t-1}+\\beta_t)I=(1-\\bar{\\alpha})I')
('10.2', '\\begin{aligned}\n    q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^t,{\\mathcal{R}}_a^0)\n    &= \\frac{q({\\mathcal{R}}_a^{t}|{\\mathcal{R}}_a^{t-1})q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^0)}{q({\\mathcal{R}}_a^t|{\\mathcal{R}}_a^0)} \\\\\n    &= \\frac{{\\mathcal{N}}({\\mathcal{R}}_a^t;\\sqrt{\\alpha_t}{\\mathcal{R}}_a^{t-1},\\beta_t I)\\cdot{\\mathcal{N}}({\\mathcal{R}}_a^{t-1};\\sqrt{\\bar{\\alpha}_{t-1}}{\\mathcal{R}}_a^0,(1-\\bar{\\alpha}_{t-1})I)}{{\\mathcal{N}}({\\mathcal{R}}_a^{t};\\sqrt{\\bar{\\alpha}_{t}}{\\mathcal{R}}_a^0,(1-\\bar{\\alpha}_{t})I)} \\\\\n    &={\\mathcal{N}}({\\mathcal{R}}_a^{t-1};\\frac{\\sqrt{\\bar{\\alpha}_{t-1}}\\beta_t}{1-\\bar{\\alpha}_t}{\\mathcal{R}}_a^0 + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1-\\bar{\\alpha}_t}{\\mathcal{R}}_a^t,\\frac{1-\\bar{\\alpha}_{t-1}}{1-\\bar{\\alpha}_t}\\beta_t I).\n\\end{aligned}')
('10.2', '\\tilde{\\beta}_t=\\frac{1-\\bar{\\alpha}_{t-1}}{1-\\bar{\\alpha}_t}\\beta_t')
('10.2', 't')
('10.2', '\\begin{aligned}\n    &D_{\\text{KL}}\\left(q({\\mathcal{R}}_a^{t-1}|{\\mathcal{R}}_a^{t},{\\mathcal{R}}_a^0)||p_\\theta({\\mathcal{R}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\right)\\\\\n    =&\\frac{1}{2\\tilde{\\beta}_t}\\left\\|\\frac{\\sqrt{\\bar{\\alpha}_{t-1}}\\beta_t}{1-\\bar{\\alpha}_t}{\\mathcal{R}}_a^0 + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1-\\bar{\\alpha}_t}{\\mathcal{R}}_a^t-\\frac{1}{\\sqrt{\\alpha_t}}\\left({\\mathcal{R}}_a^t-\\frac{\\beta_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\epsilon_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\\right)\\right\\|^2\\\\\n    =&\\frac{1}{2\\tilde{\\beta}_t}\\mathbb{E}_\\epsilon\\left\\|\\frac{\\sqrt{\\bar{\\alpha}_{t-1}}\\beta_t}{1-\\bar{\\alpha}_t}\\cdot \\frac{{\\mathcal{R}}_a^t-\\sqrt{1-\\bar{\\alpha}_t}\\epsilon}{\\sqrt{\\bar{\\alpha}_t}} + \\frac{\\sqrt{\\alpha_t}(1-\\bar{\\alpha}_{t-1})}{1-\\bar{\\alpha}_t}{\\mathcal{R}}_a^t-\\frac{1}{\\sqrt{\\alpha_t}}\\left({\\mathcal{R}}_a^t-\\frac{\\beta_t}{\\sqrt{1-\\bar{\\alpha}_t}}\\epsilon_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\\right)\\right\\|^2\\\\\n    =&\\frac{1}{2\\tilde{\\beta}_t}\\cdot\\frac{\\beta_t^2}{\\alpha_t(1-\\bar{\\alpha}_t)}\\mathbb{E}_\\epsilon\\left\\|\\epsilon-\\epsilon_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\\right\\|\\\\\n    =&\\gamma_t \\mathbb{E}_{\\epsilon}\\left[\\|\\epsilon - \\epsilon_\\theta({\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t,t)\\|_2^2\\right],\n\\end{aligned}')
('10.2', '\\Box')
('10.3', '{\\mathcal{L}}^{({\\mathcal{S}},b\\rightarrow a)}')
('10.3', '{\\mathcal{S}}_a^0')
('10.3', '\\begin{aligned}\n    p_\\theta({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\propto\n    \\begin{matrix}\n    \\sum\\nolimits_{\\tilde{{\\mathcal{S}}}_a^0}\n    q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^{t},\\tilde{{\\mathcal{S}}}_a^{0})\\cdot\n    \\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}_a^0|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\end{matrix},\n\\end{aligned}')
('10.3', '{\\mathcal{L}}^{({\\mathcal{S}},b\\rightarrow a)}')
('10.3', '\\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}_a^0|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)')
('10.3', '{\\mathcal{S}}_a^0')
('10.3', '\\begin{aligned}\n    {\\mathcal{L}}^{({\\mathcal{S}},b\\rightarrow a)}\n    &\\coloneqq\\mathbb{E}\\left[\\begin{matrix}\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^{t},{\\mathcal{S}}_a^0)||p_\\theta({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)\\right)\\end{matrix}\\right]\\\\\n    &=\\mathbb{E}\\left[\\sum\\nolimits_{t=1}^T D_{\\text{KL}}\\left(q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^{t},{\\mathcal{S}}_a^0)\\bigg|\\bigg|\n    \\frac{\\sum\\nolimits_{\\tilde{{\\mathcal{S}}}_a^0}\n    q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^{t},\\tilde{{\\mathcal{S}}}_a^{0})\\cdot\n    \\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}_a^0|{\\mathcal{P}}_1^t,{\\bm{\\mathcal{P}}}_2^t)}{Z}\n    \\right)\\right],\n\\end{aligned}')
('10.3', 'Z')
('10.3', '\\tilde{p}_\\theta(\\tilde{{\\mathcal{S}}}_a^0|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)')
('10.3', '{\\mathcal{S}}_a^0')
('10.3', 'p_\\theta({\\mathcal{S}}_a^{t-1}|{\\mathcal{P}}_a^t,{\\bm{\\mathcal{P}}}_b^t)')
('10.3', 'q({\\mathcal{S}}_a^{t-1}|{\\mathcal{S}}_a^{t},{\\mathcal{S}}_a^0)')
('10.3', '\\Box')
('11.0.0', 'd_{\\text{radius}}=4.5\\text{\\normalfont\\AA}')
('11.0.0.0', 'd_{\\text{seq}}=3')
('11.0.0.0', 'd_{\\text{radius}}=10.0\\text{\\normalfont\\AA}')
('11.0.0.0', 'k=10')
('11.0.0.0', 'd_{\\text{long}}=5')
('11.0.0.1', '15\\text{\\normalfont\\AA}')
('11.0.0.1', '\\tau')
('11.0.0.1', '\\beta_t')
('11.0.0.1', '\\beta_1=1e-4')
('11.0.0.1', '\\beta_T=0.1')
('11.0.0.1', '0.1\\pi')
('11.0.0.1', '0.3')
('11.0.0.3', '\\rho')
('11.0.0.3', '\\rho')
('11.0.0.3', 't \\in [0,1]')
('11.0.0.3', '\\label{supp:eq:fmax:precision_recall}\n        \\text{precision}_i(t)=\\frac{\\sum_f \\text{\\usefont{U}{bbm}{m}{n}1}[f\\in P_i(t) \\cap T_i]}{\\sum_f \\text{\\usefont{U}{bbm}{m}{n}1}[f\\in P_i(t)]}, \\quad \\text{recall}_i(t)=\\frac{\\sum_f \\text{\\usefont{U}{bbm}{m}{n}1}[f\\in P_i(t) \\cap T_i]}{\\sum_f \\text{\\usefont{U}{bbm}{m}{n}1}[f\\in T_i]},')
('11.0.0.3', 'f')
('11.0.0.3', 'T_i')
('11.0.0.3', 'i')
('11.0.0.3', 'P_i(t)')
('11.0.0.3', 'i')
('11.0.0.3', 't')
('11.0.0.3', '\\text{\\usefont{U}{bbm}{m}{n}1}[\\cdot]')
('11.0.0.3', '\\label{supp:eq:fmax:average}\n        \\text{precision}(t)=\\frac{1}{M(t)}\\sum_{i} \\text{precision}_i(t), \\quad \\text{recall}(t)=\\frac{1}{N}\\sum_{i} \\text{recall}_i(t),')
('11.0.0.3', 'N')
('11.0.0.3', 'M(t)')
('11.0.0.3', 't')
('11.0.0.3', '|P_i(t)| > 0')
('11.0.0.3', '\\label{supp:eq:fmax}\n        \\text{F\\textsubscript{max}}=\n        \\max_t\\left\\{\\frac{2\\cdot \\text{precision}(t)\\cdot \\text{recall}(t)}{\\text{precision}(t)+ \\text{recall}(t)}\\right\\}.')
('11.0.0.3', '\\rho')
('11.0.0.3', '\\rho')
('11.0.0.3', '\\rho')
('11.0.0.3', '\\rho')
('11.0.0.3', '\\rho')
('12', '\\rho')
('12', '\\rho')
('13', '\\rho')
('13', '\\rho')
('13', '\\;')
('14', '\\rho')
('14', '\\rho')
('15', '\\rho')
('15', '\\rho')
('15', '4.5\\text{\\normalfont\\AA}')
