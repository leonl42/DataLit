('2', '\\theta')
('2', 'f_{\\theta}:\\mathcal{X} \\to \\mathbb{R}^k')
('2', '\\mathcal{D}=\\{(x_i, y_i)\\}_{i=1}^n')
('2', 'p(y|x, \\theta) = p(y|f_\\theta(x))')
('2', 't')
('2', 'B_t')
('2', 'n_B')
('2', '\\mathcal{D}')
('2', 'B_t')
('2', '\\mathcal{D}_{t-1}')
('2', 't')
('2', "(x', y')")
('2', 'B_t')
('2', "(x', y')")
('2', "p(y|x, \\mathcal{D}_{t-1}, \\{(x', y')\\})=\\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1}, \\{(x', y')\\})} p(y|x, \\theta)")
('2', "(x', y') \\in B_t")
('2', '\\dot{p}(x,y)')
('2', "\\small\n   \\min_{(x', y') \\in B_t} \\mathbb{E}_{\\dot{p}(x)}\\big(D_\\text{KL}\\big[\\dot{p}(y|x) \\Vert p(y|x, \\mathcal{D}_{t-1}, \\{(x', y')\\})\\big]\\big) = \\mathrm{const.} - \\mathbb{E}_{\\dot{p}(x,y)}\\big[\\log p(y|x, \\mathcal{D}_{t-1} ,\\{(x', y')\\})\\big],")
('2', '\\mathrm{const.}')
('2', '\\mathcal{D}^* = \\{(\\tilde{x}_{i}, \\tilde{y}_{i})\\}_{i=1}^m')
('2', '\\dot{p}(x, y)')
('2', "\\label{eq:obj-raw}\n    \\max_{(x', y') \\in B_t} \\frac{1}{m}\\sum_{i=1}^m \\big[\\log p(\\tilde{y}_{i}|\\tilde{x}_{i}, \\mathcal{D}_{t-1},\\{(x', y')\\})\\big] \\iff \\max_{(x', y') \\in B_t}\\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1} ,\\{(x', y')\\}).")
('2', "\\small\n    p(\\mathcal{D}^*|\\mathcal{D}_{t-1},\\{(x', y')\\}) = \\frac{p(y'|x', \\mathcal{D}^*, \\mathcal{D}_{t-1}) p(x', \\mathcal{D}^*, \\mathcal{D}_{t-1})}{p(y'|x', \\mathcal{D}_{t-1}) p(x', \\mathcal{D}_{t-1})} = \\frac{p(y'|x', \\mathcal{D}^*, \\mathcal{D}_{t-1})}{p(y'|x', \\mathcal{D}_{t-1})}\\cdot p(\\mathcal{D}^* | \\mathcal{D}_{t-1}, x'),")
('2', "p(\\mathcal{D}^* | \\mathcal{D}_{t-1}, x')")
('2', 'p(\\mathcal{D}^* | \\mathcal{D}_{t-1})')
('2', "x'")
('2', '\\label{eq:obj}\n    \\max_{(x, y) \\in B_t}\\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) - \\log p(y|x, \\mathcal{D}_{t-1}),')
('2', '(x, y)')
('2', "(x', y')")
('2', '\\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1})')
('2', '\\log p(y|x, \\mathcal{D}^*)')
('3.0', '\\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1})')
('3.0', '\\log p(y|x, \\mathcal{D}_{t-1})')
('3.0', 'B_t')
('3.0', '\\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1})')
('3.0', 'p(\\theta | \\mathcal{D}^*, \\mathcal{D}_{t-1})')
('3.0', 'p(y|x, \\theta)')
('3.0', '\\label{eq:posterior-pred}\n\\begin{aligned}\n    \\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) =  \\log \\int {p(\\mathcal{D}^*|\\theta)p(\\theta|\\mathcal{D}_{t-1})} p(y|x, \\theta) d \\theta - \\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1}).\n\\end{aligned}')
('3.0', '\\label{eq:lb1}\n\\begin{aligned}\n      \\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) & \\geq \\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} \\log p(y|x, \\theta) + \\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} \\log p(\\mathcal{D}^*|\\theta) - \\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1}).\n\\end{aligned}')
('3.0', '(x, y)')
('3.0', '\\label{eq:lb2}\n\\begin{aligned}\n    \\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) \n    &=  \\log \\int {p(\\mathcal{D}_{t-1}|\\theta)p(\\theta|\\mathcal{D}^*)} p(y|x, \\theta) d \\theta - \\log p(\\mathcal{D}_{t-1}|\\mathcal{D}^*) \\\\\n    &\\geq \\mathbb{E}_{p(\\theta|\\mathcal{D}^*)} \\log p(y|x, \\theta) +  \\mathbb{E}_{p(\\theta|\\mathcal{D}^*)} \\log p(\\mathcal{D}_{t-1}|\\theta) - \\log p(\\mathcal{D}_{t-1}|\\mathcal{D}^*),\n\\end{aligned}')
('3.0', '(x, y)')
('3.0', '\\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) \\geq \\alpha\\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} \\log p(y|x, \\theta) + (1- \\alpha)\\mathbb{E}_{p(\\theta|\\mathcal{D}^*)} \\log p(y|x, \\theta) + \\mathrm{const.},')
('3.0', '\\alpha \\in [0, 1]')
('3.0', '\\mathcal{D}_{t-1}')
('3.0', '\\mathcal{D}^*')
('3.0', 'p(y|x, \\mathcal{D}_{t-1})')
('3.0', '\\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} p(y|x, \\theta)')
('3.0', '\\label{eq:obj-last}\n    \\max_{(x, y) \\in B_t} \\alpha\\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} \\log p(y|x, \\theta) +  (1- \\alpha)\\mathbb{E}_{p(\\theta|\\mathcal{D}^*)} \\log p(y|x, \\theta) - \\log \\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} p(y|x, \\theta).')
('3.0', '\\alpha')
('3.1', '\\mathbb{E}_{p(\\theta|\\mathcal{D}^*)} \\log p(y|x, \\theta) \\approx \\log p(y | \\tilde{f}(x)),')
('3.1', '\\tilde{f}: \\mathcal{X} \\to \\mathbb{R}^k')
('3.2', 'p(\\theta|\\mathcal{D}_{t-1})')
('3.2', 'q(\\theta|\\mathcal{D}_{t-1})')
('3.2', '\\tau_0')
('3.2', '\\theta')
('3.2', '\\mathcal{D}_{t-1}:=b_1 \\cup b_2 \\cup \\dots \\cup b_{t-1}')
('3.2', 'b_{i} \\subset B_i')
('3.2', 'i')
('3.2', 't')
('3.2', 't-1')
('3.2', '\\theta_{t-1}')
('3.2', 'p(\\theta|\\mathcal{D}_{t-1})')
('3.2', '\\small\n    q(\\theta|\\mathcal{D}_{t-1}) = \\mathcal{N}(\\theta_{t-1}, H_{t-1}^{-1}), \\; H_{t-1} = \\tau_0 I + \\sum_{i=1}^{t-1} \\Big(\\sum_{x, y \\in b_i} \\frac{\\partial^2 [-\\log p(y|x, \\theta)]}{\\partial\\theta^2 }\\Big|_{\\theta=\\theta_i}\\Big).')
('3.2', '\\theta_{t-1}')
('3.2', '\\small\n    q(\\theta|\\mathcal{D}_{t-1}) = \\mathcal{N}(\\theta_{t-1}, G_{t-1}^{-1}), \\; G_{t-1} = \\tau_0 I + \\sum_{i=1}^{t-1} \\Big(\\sum_{x, y \\in b_i} J_{\\theta_i}(x)^\\top \\Lambda_{\\theta_i}(x, y) J_{\\theta_i}(x)\\Big),')
('3.2', 'J_{\\theta_i}(x) := \\nabla_{\\theta} f_{\\theta}(x) |_{\\theta=\\theta_i}')
('3.2', '\\Lambda_{\\theta_i}(x, y) := \\nabla^2_{f} [-\\log p(y|f)]|_{f = f_{\\theta_i}(x)}')
('3.2', 'G_{t-1}')
('3.2', 'f_{\\theta_{i}}')
('3.2', 'h_{\\theta_{i}}')
('3.2', '\\theta_{i}^{(l)} \\in \\mathbb{R}^{d \\times k}')
('3.2', 'f_{\\theta_{i}}(x) := h_{\\theta_{i}}(x)^\\top \\theta_{i}^{(l)}')
('3.2', '\\theta_{i}^{(l)}')
('3.2', 'G^{(l)}_{t-1} \\approx V_{t-1} \\otimes U_{t-1} := (\\sqrt{|\\mathcal{D}_{t-1}|} A_{t-1}  + \\sqrt{\\tau_0} I) \\otimes (\\sqrt{|\\mathcal{D}_{t-1}|} C_{t-1} + \\sqrt{\\tau_0} I),')
('3.2', '\\otimes')
('3.2', '\\small\n\\begin{aligned}\n\\label{eq:ag}\n\\small\n    &\\quad \\quad \\quad \\quad \\quad \\quad \\quad A_{t-1} := \\frac{1}{|\\mathcal{D}_{t-1}|} \\sum_{i=1}^{t-1}\\sum_{x,y\\in b_i} h_{\\theta_{i}}(x)h_{\\theta_{i}}(x)^\\top, \\\\\n    &C_{t-1} := \\frac{1}{|\\mathcal{D}_{t-1}|} \\sum_{i=1}^{t-1}\\sum_{x,y\\in b_i} [\\nabla_f \\log p(y|f)|_{f=f_{\\theta_{i}}(x)}] [\\nabla_f \\log p(y|f)|_{f=f_{\\theta_{i}}(x)}]^\\top.\n\\end{aligned}')
('3.2', 'A_{t-1} \\in \\mathbb{R}^{d \\times d}')
('3.2', 'C_{t-1} \\in \\mathbb{R}^{k \\times k}')
('3.2', 'q(\\theta^{(l)} | \\mathcal{D}_{t-1}) = \\mathcal{MN}(\\theta^{(l)}|\\theta_{t-1}^{(l)}, U_{t-1}^{-1}, V_{t-1}^{-1})')
('3.2', 'f_x')
('3.2', 'x')
('3.2', '\\label{eq:lla-fdist}\n\\begin{aligned}\n    q(f_{x}|\\mathcal{D}_{t-1}) = \\mathcal{N}\\Big(f_{\\theta_{t-1}}(x), \\big(h_{\\theta_{t-1}}(x)^\\top V_{t-1}^{-1}h_{\\theta_{t-1}}(x)\\big) U_{t-1}^{-1}\\Big).\n\\end{aligned}')
('3.2', 'T')
('3.2', '\\mathcal{D}')
('3.2', '\\tau_0')
('3.2', 'n_{e}')
('3.2', 'n_B')
('3.2', 'n_b')
('3.2', '\\tilde{f}')
('3.2', '\\theta')
('3.2', '\\label{eq:obj-f}\n\\max_{(x, y) \\in B_t}  \\alpha\\Big[\\frac{1}{S}\\sum_{s=1}^S \\log p(y|f_{x}^{(s)})\\Big] +  (1- \\alpha) \\log p(y | \\tilde{f}(x)) - \\log \\Big[\\frac{1}{S}\\sum_{s=1}^S p(y|f_{x}^{(s)})\\Big],')
('3.2', 'f_{x}^{(s)} \\sim q(f_x|\\mathcal{D}_{t-1}), s=1,\\dots, S')
('3.2', 'S')
('3.2', '|\\mathcal{D}_{t-1}|')
('3.2', 'n_e')
('3.2', '|\\mathcal{D}_{t-1}|')
('3.2', 'V_{t-1}')
('3.2', 'U_{t-1}')
('3.2', 'A_t')
('3.2', 'C_t')
('3.2', 'b_t')
('3.2', 'A_t')
('3.2', 'C_t')
('4', '2.5')
('4', '1000')
('4', 'n_b = 32')
('4', '\\frac{n_b}{n_B}=0.1')
('4', '\\alpha')
('4', '\\{0.1, 0.2, 0.3, 0.4\\}')
('4', 'n_e')
('4', '\\{100, 200, 500, 1000\\}')
('4', '\\tau_0')
('4', '1')
('4.2', '\\sim')
('4.2', '\\sim')
('4.3', '10\\%')
('4.4', '\\alpha')
('4.4', 'n_e')
('4.4', '\\dagger')
('4.4', '\\dagger')
('4.4', '\\alpha')
('4.4', 'n_e')
('4.4', '\\tau')
('4.4', '\\alpha')
('4.4', 'n_e')
('4.4', '\\tau')
('4.4', '\\alpha')
('4.4', '\\alpha')
('4.4', '\\alpha=0')
('4.4', 'n_e')
('4.4', 'n_e')
('4.4', '\\tau')
('4.4', '48 * 18 / 32 / 21\\approx1.29')
('4.4', '77 * 18 / 53 / 21\\approx1.25')
('8.0', '\\begin{aligned}\n    \\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) &= \\log \\int p(\\theta|\\mathcal{D}^*, \\mathcal{D}_{t-1}) p(y|x, \\theta) d \\theta \\\\\n    &=  \\log \\int \\frac{p(\\mathcal{D}^*|\\theta)p(\\theta|\\mathcal{D}_{t-1})}{p(\\mathcal{D}^*|\\mathcal{D}_{t-1})} p(y|x, \\theta) d \\theta \\\\\n    &=  \\log \\int {p(\\mathcal{D}^*|\\theta)p(\\theta|\\mathcal{D}_{t-1})} p(y|x, \\theta) d \\theta - \\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1}). \\\\\n\\end{aligned}')
('8.1', '\\begin{aligned}\n      \\log p(y|x, \\mathcal{D}^*, \\mathcal{D}_{t-1}) &=  \\log \\int {p(\\mathcal{D}^*|\\theta)p(\\theta|\\mathcal{D}_{t-1})} p(y|x, \\theta) d \\theta - \\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1})\\\\\n      & \\geq \\int p(\\theta|\\mathcal{D}_{t-1}) \\log [p(\\mathcal{D}^*|\\theta) p(y|x, \\theta)] d\\theta  - \\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1})\\\\\n     &= \\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} \\log p(\\mathcal{D}^*|\\theta) + \\mathbb{E}_{p(\\theta|\\mathcal{D}_{t-1})} \\log p(y|x, \\theta)  - \\log p(\\mathcal{D}^*|\\mathcal{D}_{t-1}).\n\\end{aligned}')
('8.2', 'q(\\theta^{(l)} | \\mathcal{D}_{t-1}) = \\mathcal{MN}(\\theta^{(l)}|\\theta_{t-1}^{(l)}, U_{t-1}^{-1}, V_{t-1}^{-1})')
('8.2', 'h_{\\theta_{t-1}}(x)')
('8.2', '\\begin{aligned}\n    q(f_{x}|\\mathcal{D}_{t-1}) &= \\mathcal{MN}\\Big(h_{\\theta_{t-1}}(x)^\\top \\theta_{t-1}^{(l)}, U_{t-1}^{-1}, h_{\\theta_{t-1}}(x)^\\top V_{t-1}^{-1}h_{\\theta_{t-1}}(x)\\Big) \\\\\n    &= \\mathcal{N}\\Big(f_{\\theta_{t-1}}(x), \\big(h_{\\theta_{t-1}}(x)^\\top V_{t-1}^{-1}h_{\\theta_{t-1}}(x)\\big) U_{t-1}^{-1}\\Big).\n\\end{aligned}')
('8.2', '(h_{\\theta_{t-1}}(x)^\\top V_{t-1}^{-1}h_{\\theta_{t-1}}(x))')
('9.0', '32\\times32')
('9.0', '224\\times224')
('9.1', '\\alpha')
('9.1', '\\{0.1, 0.2, 0.3, 0.4\\}')
('9.1', '\\alpha')
('9.2', '3\\times3')
('9.2', 'B_t')
('9.2', 'b_t')
