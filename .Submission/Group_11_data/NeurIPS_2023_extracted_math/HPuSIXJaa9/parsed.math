('3', '\\pi^\\text{SFT}')
('3', 'x')
('3', '(y_1, y_2)\\sim \\pi^\\text{SFT}(y \\mid x)')
('3', 'y_w\\succ y_l \\mid x')
('3', 'y_w')
('3', 'y_l')
('3', '(y_1, y_2)')
('3', 'r^*(y, x)')
('3', 'p^*')
('3', '\\label{eq:bradley-terry}\n    p^*(y_1\\succ y_2 \\mid x)=\\frac{\\exp\\left(r^*(x, y_1)\\right)}{\\exp\\left(r^*(x, y_1)\\right) + \\exp\\left(r^*(x, y_2)\\right)}.')
('3', '\\mathcal{D}=\\bigl\\{x^{(i)}, y_w^{(i)}, y_l^{(i)}\\bigr\\}_{i=1}^N')
('3', 'p^*')
('3', 'r_{\\phi}(x, y)')
('3', '\\label{eq:reward_model}\n    \\mathcal{L}_R(r_{\\phi}, \\mathcal{D}) = -\\mathbb{E}_{(x, y_w, y_l)\\sim \\mathcal{D}}\\bigl[\\log \\sigma(r_{\\phi}(x, y_w)- r_{\\phi}(x, y_l))\\bigr]')
('3', '\\sigma')
('3', 'r_{\\phi}(x, y)')
('3', '\\pi^\\text{SFT}(y \\mid x)')
('3', '\\mathbb{E}_{x,y\\sim \\mathcal{D}}\\left[r_\\phi(x, y)\\right] = 0')
('3', 'x')
('3', '\\label{eq:RL}\n\\max_{\\pi_{\\theta}}  \\mathbb{E}_{x\\sim \\mathcal{D}, y\\sim \\pi_{\\theta}(y \\mid x)}\\bigl[r_{\\phi}(x, y)\\bigr] - \\beta\\mathbb{D}_{\\textrm{KL}}\\bigl[\\pi_{\\theta}(y\\mid x)\\mid \\mid \\pi_\\text{ref}(y\\mid x)\\bigr],')
('3', '\\beta')
('3', '\\pi_\\text{ref}')
('3', '\\pi^\\text{SFT}')
('3', '\\pi_\\theta')
('3', '\\pi^\\text{SFT}')
('3', '{r(x, y) = r_{\\phi}(x, y) -\\beta (\\log \\pi_{\\theta}(y\\mid x) - \\log \\pi_\\text{ref}(y\\mid x))}')
('4', 'r')
('4', '\\label{eq:op_policy}\n    \\pi_r(y\\mid x) = \\frac{1}{Z(x)}\\pi_\\text{ref}(y\\mid x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right),')
('4', 'Z(x) =\\sum_{y}\\pi_\\text{ref}(y\\mid x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)')
('4', 'r_{\\phi}')
('4', 'r^*')
('4', 'Z(x)')
('4', '\\pi_r')
('4', '\\pi_\\text{ref}')
('4', 'Z(\\cdot)')
('4', '\\label{eq:main_eq}\n    r(x,y) =\\beta \\log \\frac{\\pi_r(y\\mid x)}{\\pi_\\text{ref}(y\\mid x)} + \\beta \\log Z(x).')
('4', 'r^*')
('4', '\\pi^*')
('4', '{p^*(y_1 \\succ y_2 \\mid x) = \\sigma(r^*(x, y_1) - r^*(x, y_2))}')
('4', 'r^*(x,y)')
('4', '\\pi^*')
('4', '\\pi_\\text{ref}')
('4', '\\pi^*')
('4', '\\label{eq:objective}\n    p^*(y_1\\succ y_2 \\mid x)=\\frac{1}{1 + \\exp\\left(\\beta \\log \\frac{\\pi^*(y_2\\mid x)}{\\pi_\\text{ref}(y_2\\mid x)} - \\beta \\log \\frac{\\pi^*(y_1\\mid x)}{\\pi_\\text{ref}(y_1\\mid x)}\\right)}')
('4', '\\pi_\\theta')
('4', '\\label{eq:optimum_model}\n    \\mathcal{L}_\\text{DPO}(\\pi_{\\theta}; \\pi_\\text{ref}) = -\\mathbb{E}_{(x, y_w, y_l)\\sim \\mathcal{D}}\\left[\\log \\sigma \\left(\\beta \\log \\frac{\\pi_{\\theta}(y_w\\mid x)}{\\pi_\\text{ref}(y_w\\mid x)} - \\beta \\log \\frac{\\pi_{\\theta}(y_l\\mid x)}{\\pi_\\text{ref}(y_l\\mid x)}\\right)\\right].')
('4', '\\pi_\\theta')
('4', '\\mathcal{L}_\\text{DPO}')
('4', '\\theta')
('4', '\\begin{gathered}\n\\label{eq:gradient}\n    \\nabla_\\theta \\mathcal{L}_\\text{DPO}(\\pi_\\theta;\\pi_\\text{ref}) = \\\\ -\\beta\\mathbb{E}_{(x, y_w, y_l) \\sim \\mathcal{D}} \\bigg[\\underbrace{\\sigma(\\hat{r}_\\theta(x, y_l) - \\hat{r}_\\theta (x, y_w))}_\\text{higher weight when reward estimate is wrong}\\bigg[\\underbrace{\\nabla_\\theta\\log \\pi(y_w \\mid x)}_\\text{increase likelihood of $y_w$} - \\underbrace{\\nabla_\\theta\\log\\pi(y_l \\mid x)}_\\text{decrease likelihood of $y_l$}\\bigg]\\bigg],\n\\end{gathered}')
('4', '\\hat{r}_\\theta(x, y) = \\beta \\log \\frac{\\pi_\\theta(y \\mid x)}{\\pi_\\text{ref}(y \\mid x)}')
('4', '\\pi_\\theta')
('4', '\\pi_\\text{ref}')
('4', '\\mathcal{L}_\\text{DPO}')
('4', 'y_w')
('4', 'y_l')
('4', '\\hat{r}_\\theta')
('4', '\\beta')
('4', 'y_1, y_2 \\sim \\pi_\\text{ref}(\\cdot \\mid x)')
('4', 'x')
('4', '\\mathcal{D} = \\{x^{(i)}, y_w^{(i)}, y_l)^{(i)}\\}_{i=1}^N')
('4', '\\pi_\\theta')
('4', '\\mathcal{L}_\\text{DPO}')
('4', '\\pi_\\text{ref}')
('4', '\\mathcal{D}')
('4', '\\beta')
('4', '\\pi^\\text{SFT}')
('4', '\\pi_\\text{ref}= \\pi^\\text{SFT}')
('4', '\\pi^\\text{SFT}')
('4', '\\pi_\\text{ref}')
('4', '{(x, y_w)}')
('4', '{\\pi_\\text{ref}= \\mathop{\\mathrm{arg\\,max}}_{\\pi}\\mathbb{E}_{x, y_w \\sim \\mathcal{D}}\\left[\\log \\pi(y_w \\mid x)\\right]}')
('4', '\\pi_\\text{ref}')
('5.0', 'r^*(x, y) = \\beta \\log\\frac{\\pi^*_\\theta(y \\mid x)}{\\pi_\\text{ref}(y \\mid x)}')
('5.0', '\\pi_{\\theta}')
('5.0', 'r(x, y)')
('5.0', "r'(x, y)")
('5.0', "{r(x, y)-r'(x, y) = f(x)}")
('5.0', 'f')
('5.0', '{r(x, y) = \\beta \\log \\frac{\\pi(y\\mid x)}{\\pi_\\text{ref}(y\\mid x)}}')
('5.0', '\\pi(y\\mid x)')
('5.0', '\\pi_\\text{ref}(y \\mid x)')
('5.0', 'r(x, y)')
('5.0', '\\pi_r(y \\mid x)')
('5.0', 'r')
('5.0', 'f')
('5.0', 'f(r; \\pi_\\text{ref}, \\beta)(x, y) = r(x, y) - \\beta\\log\\sum_{y}\\pi_\\text{ref}(y\\mid x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)')
('5.0', 'f')
('5.0', '\\pi_r')
('5.0', 'x')
('5.0', 'f(r; \\pi_\\text{ref}, \\beta)(x, y)')
('5.0', 'r(x, y)')
('5.0', 'r')
('5.0', 'f(r; \\pi_\\text{ref}, \\beta)(x, y) = \\beta \\log \\frac{\\pi_r(y\\mid x)}{\\pi_\\text{ref}(y\\mid x)}')
('5.0', 'f')
('5.0', 'r')
('5.0', '\\label{eq:lag_p}\n     \\sum_{y}\\underbrace{\\pi_\\text{ref}(y\\mid x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)}_{=\\pi(y\\mid x)\\text{, using Thm.~\\ref{thm:main} reparam.}} = 1,')
('5.0', '\\pi(y\\mid x)')
('5.0', 'r(x, y)')
('5.0', 'x')
('5.1', '\\pi_{\\theta}(y\\mid x)')
('5.1', '\\mathbb{D}_{\\text{KL}}[\\pi_{\\theta}(y|x) \\mid \\mid \\pi^*(y\\mid x)]')
('5.1', '\\pi^*')
('5.1', 'r_{\\phi}(y, x)')
('5.1', '\\label{eq:AC}\n    \\max_{\\pi_{\\theta}}\\mathbb{E}_{\\pi_{\\theta}(y\\mid x)}\\bigg[\\underbrace{r_{\\phi}(x, y) -\\beta\\log\\sum_{y}\\pi_\\text{ref}(y\\mid x)\\exp\\left(\\frac{1}{\\beta}r_{\\phi}(x, y)\\right)}_{f(r_{\\phi}, \\pi_\\text{ref}, \\beta)} - \\underbrace{\\beta\\log\\frac{\\pi_{\\theta}(y\\mid x)}{\\pi_\\text{ref}(y\\mid x)}}_{\\text{KL}}\\bigg]')
('5.1', 'r_{\\phi}')
('5.1', 'f(r_{\\phi}, \\pi_\\text{ref}, \\beta)')
('5.1', '\\pi_\\text{ref}')
('6', 'N')
('6', '\\mathcal{D}=\\bigl\\{x^{(i)}, y_w^{(i)}, y_l^{(i)}\\bigr\\}_{i=1}^N')
('6', 'x')
('6', 'y')
('6', 'p(\\text{positive}\\mid x,y_w)>p(\\text{positive}\\mid x,y_l)')
('6', 'x')
('6', 'y')
('6', 'x')
('6', 'y')
('6', 'y_w')
('6', 'y_w')
('6', 'y_l')
('6', '\\alpha\\in[0,1]')
('6', 'N')
('6', 'N')
('6', 'N')
('6', 'N')
('6.0', '\\in\\{3,6,9,12\\}')
('6.0', '\\beta \\in \\{0.05,0.1,1,5\\}')
('6.0', '\\alpha\\in\\{0.05,0.1,0.5,1\\}')
('6.0', '\\text{KL}\\left(\\pi\\mid \\mid \\pi_\\text{ref}\\right)')
('6.1', 'N')
('6.1', '\\beta')
('6.1', 'N')
('6.2', '0')
('6.2', '0.25')
('10.0', '\\max_{\\pi}  \\mathbb{E}_{x\\sim \\mathcal{D}, y\\sim \\pi}\\bigl[r(x, y)\\bigr] - \\beta\\mathbb{D}_{\\textrm{KL}}\\bigl[\\pi(y|x)||\\pi_\\text{ref}(y|x)\\bigr]')
('10.0', 'r(x,y)')
('10.0', '\\pi_\\text{ref}')
('10.0', '\\begin{aligned}\n\\label{eq:RL_proof}\n\\max_{\\pi}  \\mathbb{E}_{x\\sim \\mathcal{D}, y\\sim \\pi}&\\bigl[r(x, y)\\bigr] - \\beta\\mathbb{D}_{\\textrm{KL}}\\bigl[\\pi(y|x)\\mid\\mid\\pi_\\text{ref}(y|x)\\bigr] \\nonumber\\\\\n&=\\max_{\\pi}  \\mathbb{E}_{x\\sim \\mathcal{D}}\\mathbb{E}_{y\\sim \\pi(y|x)}\\left[r(x, y) - \\beta\\log\\frac{\\pi(y|x)}{\\pi_\\text{ref}(y|x)}\\right] \\nonumber\\\\&=\n\\min_{\\pi}  \\mathbb{E}_{x\\sim \\mathcal{D}}\\mathbb{E}_{y\\sim \\pi(y|x)}\\left[\\log\\frac{\\pi(y|x)}{\\pi_\\text{ref}(y|x)} - \\frac{1}{\\beta}r(x, y)\\right] \\nonumber\\\\ &=\n\\min_{\\pi}  \\mathbb{E}_{x\\sim \\mathcal{D}}\\mathbb{E}_{y\\sim \\pi(y|x)}\\left[\\log\\frac{\\pi(y|x)}{\\frac{1}{Z(x)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)} - \\log Z(x)\\right]\n\\end{aligned}')
('10.0', 'Z(x) = \\sum_{y}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right).')
('10.0', 'x')
('10.0', '\\pi_\\text{ref}')
('10.0', '\\pi')
('10.0', '\\pi^*(y|x) = \\frac{1}{Z(x)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right),')
('10.0', '\\pi^*(y|x)\\geq 0')
('10.0', 'y')
('10.0', '\\sum_{y}\\pi^*(y|x)=1')
('10.0', 'Z(x)')
('10.0', 'y')
('10.0', '\\begin{aligned}\n\\min_{\\pi}  \\mathbb{E}_{x\\sim \\mathcal{D}}\\left[\\mathbb{E}_{y\\sim \\pi(y|x)}\\left[\\log\\frac{\\pi(y|x)}{\\pi^*(y|x)}\\right] - \\log Z(x)\\right]=\\\\\n\\min_{\\pi}\\mathbb{E}_{x\\sim\\mathcal{D}}\\left[\\mathbb{D}_{\\text{KL}}(\\pi(y|x)\\mid\\mid\\pi^*(y|x)) - \\log Z(x)\\right]\n\\end{aligned}')
('10.0', 'Z(x)')
('10.0', '\\pi')
('10.0', '\\pi(y|x)= \\pi^*(y|x) = \\frac{1}{Z(x)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)')
('10.0', 'x\\in\\mathcal{D}')
('10.1', '\\label{eq:BT_restated}\n    p^*(y_1\\succ y_2|x)=\\frac{\\exp\\left(r^*(x, y_1)\\right)}{\\exp\\left(r^*(x, y_1)\\right) + \\exp\\left(r^*(x, y_2)\\right)}')
('10.1', '\\label{eq:main_eq_restated}\n    r^*(x,y) =\\beta \\log \\frac{\\pi^*(y|x)}{\\pi_\\text{ref}(y|x)} + \\beta \\log Z(x)')
('10.1', '\\begin{aligned}\n    p^*(y_1\\succ y_2|x)&=\\frac{\\exp\\left(\\beta \\log \\frac{\\pi^*(y_1|x)}{\\pi_\\text{ref}(y_1|x)} + \\beta \\log Z(x)\\right)}{\\exp\\left(\\beta \\log \\frac{\\pi^*(y_1|x)}{\\pi_\\text{ref}(y_1|x)} + \\beta \\log Z(x)\\right) + \\exp\\left(\\beta \\log \\frac{\\pi^*(y_2|x)}{\\pi_\\text{ref}(y_2|x)} + \\beta \\log Z(x)\\right)}\\\\ &=\n    \\frac{1}{1+\\exp\\left(\\beta \\log \\frac{\\pi^*(y_2|x)}{\\pi_\\text{ref}(y_2|x)}-\\beta \\log \\frac{\\pi^*(y_1|x)}{\\pi_\\text{ref}(y_1|x)}\\right)} \\\\&= \\sigma\\left(\\beta \\log \\frac{\\pi^*(y_1|x)}{\\pi_\\text{ref}(y_1|x)} - \\beta \\log \\frac{\\pi^*(y_2|x)}{\\pi_\\text{ref}(y_2|x)}\\right).\n\\end{aligned}')
('10.2', 'x')
('10.2', 'K')
('10.2', 'y_1, \\ldots, y_K')
('10.2', '\\tau:[K]\\to[K]')
('10.2', '\\label{eq:pl-model}\n    p^*(\\tau| y_1,\\ldots, y_K, x)= \\prod_{k=1}^{K}\\frac{\\exp(r^*(x, y_{\\tau(k)}))}{\\sum_{j=k}^{K}\\exp(r^*(x, y_{\\tau(j)}))}')
('10.2', 'K=2')
('10.2', 'Z(x)')
('10.2', 'p^*(\\tau| y_1,\\ldots, y_K, x)= \\prod_{k=1}^{K}\\frac{\\exp\\left(\\beta \\log \\frac{\\pi^*(y_{\\tau(k)}|x)}{\\pi_\\text{ref}(y_{\\tau(k)}|x)}\\right)}{\\sum_{j=k}^{K}\\exp\\left(\\beta \\log \\frac{\\pi^*(y_{\\tau(j)}|x)}{\\pi_\\text{ref}(y_{\\tau(j)}|x)}\\right)}')
('10.2', '\\mathcal{D} = \\{\\tau^{(i)}, y_1^{(i)}, \\ldots, y_K^{(i)}, x^{(i)}\\}_{i=1}^N')
('10.2', '\\mathcal{L}_{\\text{DPO}}(\\pi_{\\theta}, \\pi_\\text{ref}) = -\\mathbb{E}_{\\tau, y_1, \\ldots, y_K, x\\sim\\mathcal{D}}\\left[\\log \\prod_{k=1}^{K}\\frac{\\exp\\left(\\beta \\log \\frac{\\pi_{\\theta}(y_{\\tau(k)}|x)}{\\pi_\\text{ref}(y_{\\tau(k)}|x)}\\right)}{\\sum_{j=k}^{K}\\exp\\left(\\beta \\log \\frac{\\pi_{\\theta}(y_{\\tau(j)}|x)}{\\pi_\\text{ref}(y_{\\tau(j)}|x)}\\right)}\\right]')
('10.3', '\\begin{aligned}\n\\label{eq:grad-start}\n    \\nabla_{\\theta}\\mathcal{L}_\\text{DPO}(\\pi_{\\theta}; \\pi_\\text{ref})\n    = -\\nabla_{\\theta}\\mathbb{E}_{(x, y_w, y_l)\\sim \\mathcal{D}}\\left[\\log \\sigma \\left(\\beta \\log \\frac{\\pi_{\\theta}(y_l|x)}{\\pi_\\text{ref}(y_l|x)} - \\beta \\log \\frac{\\pi_{\\theta}(y_w|x)}{\\pi_\\text{ref}(y_w|x)}\\right)\\right]\n\\end{aligned}')
('10.3', "\\begin{aligned}\n    \\nabla_{\\theta}\\mathcal{L}_\\text{DPO}(\\pi_{\\theta}; \\pi_\\text{ref})\n    =-\\mathbb{E}_{(x, y_w, y_l)\\sim \\mathcal{D}}\\left[\\frac{\\sigma'\\left(u\\right)}{\\sigma \\left(u\\right)}\\nabla_{\\theta}\\left(u\\right)\\right],\n\\end{aligned}")
('10.3', 'u = \\beta \\log \\frac{\\pi_{\\theta}(y_l|x)}{\\pi_\\text{ref}(y_l|x)} - \\beta \\log \\frac{\\pi_{\\theta}(y_w|x)}{\\pi_\\text{ref}(y_w|x)}')
('10.3', "\\sigma'(x) = \\sigma(x)(1-\\sigma(x))")
('10.3', '\\sigma(-x) = 1-\\sigma(x)')
('10.3', '\\begin{gathered}\n\\nabla_{\\theta}\\mathcal{L}_\\text{DPO}(\\pi_{\\theta}; \\pi_\\text{ref}) = \\\\\n     -\\mathbb{E}_{(x, y_w, y_l) \\sim \\mathcal{D}} \\bigg[\\beta\\sigma \\left(\\beta \\log \\frac{\\pi_{\\theta}(y_w|x)}{\\pi_\\text{ref}(y_w|x)} - \\beta \\log \\frac{\\pi_{\\theta}(y_l|x)}{\\pi_\\text{ref}(y_l|x)}\\right)\\bigg[\\nabla_\\theta\\log \\pi(y_w \\mid x) - \\nabla_\\theta\\log\\pi(y_l \\mid x)\\bigg]\\bigg],\n\\end{gathered}')
('10.3', '\\hat{r}_\\theta(x, y) = \\beta \\log \\frac{\\pi_\\theta(y \\mid x)}{\\pi_\\text{ref}(y \\mid x)}')
('10.4', 'r(x, y)')
('10.4', "r'(x, y)")
('10.4', "r'(x, y) = r(x, y) + f(x)")
('10.4', 'f')
('10.4', 'K=2')
('10.4', 'r(x, y)')
('10.4', 'p_r')
('10.4', 'x')
('10.4', 'y_1,\\ldots, y_K')
('10.4', '\\tau')
('10.4', "\\begin{aligned}\n    p_{r'}(\\tau| y_1,\\ldots, y_K, x) &= \n     \\prod_{k=1}^{K}\\frac{\\exp(r'(x, y_{\\tau(k)}))}{\\sum_{j=k}^{K}\\exp(r'(x, y_{\\tau(j)}))} \\\\\n     &= \\prod_{k=1}^{K}\\frac{\\exp(r(x, y_{\\tau(k)}) + f(x))}{\\sum_{j=k}^{K}\\exp(r(x, y_{\\tau(j)})+f(x))} \\\\\n     &= \\prod_{k=1}^{K}\\frac{\\exp(f(x))\\exp(r(x, y_{\\tau(k)}))}{\\exp(f(x))\\sum_{j=k}^{K}\\exp(r(x, y_{\\tau(j)}))} \\\\\n     &= \\prod_{k=1}^{K}\\frac{\\exp(r(x, y_{\\tau(k)}))}{\\sum_{j=k}^{K}\\exp(r(x, y_{\\tau(j)}))} \\\\\n     &= p_{r}(\\tau| y_1,\\ldots, y_K, x),\n\\end{aligned}")
('10.4', "r'(x, y)=r(x, y)+f(x)")
('10.4', '\\pi_r')
('10.4', "\\pi_{r'}")
('10.4', 'x, y')
('10.4', "\\begin{aligned}\n    \\pi_{r'}(y|x) &= \\frac{1}{\\sum_{y}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r'(x, y)\\right)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r'(x, y)\\right) \\\\\n    &= \\frac{1}{\\sum_{y}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}(r(x, y) + f(x))\\right)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}(r(x, y)+f(x))\\right) \\\\\n    &= \\frac{1}{\\exp\\left(\\frac{1}{\\beta}f(x)\\right)\\sum_{y}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)\\exp\\left(\\frac{1}{\\beta}f(x)\\right) \\\\\n    &= \\frac{1}{\\sum_{y}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right) \\\\\n    &= \\pi_r(y|x),\n\\end{aligned}")
('10.5', '\\pi_\\text{ref}(y|x)>0')
('10.5', 'x')
('10.5', 'y')
('10.5', '\\beta>0')
('10.5', 'r(x, y) = \\beta \\log \\frac{\\pi(y|x)}{\\pi_\\text{ref}(y|x)}')
('10.5', '\\pi(y|x)')
('10.5', 'r(x,y)')
('10.5', '\\pi_r(y|x)')
('10.5', 'r(x,y) =\\beta \\log \\frac{\\pi_r(y|x)}{\\pi_\\text{ref}(y|x)} + \\beta \\log Z(x)')
('10.5', 'Z(x) =\\sum_{y}\\pi_\\text{ref}(y|x)\\exp\\left(\\frac{1}{\\beta}r(x, y)\\right)')
('10.5', 'Z(x)')
('10.5', 'r')
('10.5', "r'(x, y) = f(r, \\pi_\\text{ref}, \\beta)(x, y) = r(x, y) - \\beta \\log Z(x)")
('10.5', 'r')
('10.5', "r'(x,y) =\\beta \\log \\frac{\\pi_r(y|x)}{\\pi_\\text{ref}(y|x)}")
('10.5', 'r')
('10.5', "r'")
('10.5', "f(r, \\pi_\\text{ref}, \\beta)(x, y)= \\beta \\log \\frac{\\pi_r(y|x)}{\\pi_\\text{ref}(y|x)}=\n\\beta \\log \\frac{\\pi_r'(y|x)}{\\pi_\\text{ref}(y|x)} = f(r', \\pi_\\text{ref}, \\beta)(x, y)")
('10.5', 'f')
('10.5', '\\pi_\\text{ref}(y|x)>0')
('10.5', 'x')
('10.5', 'y')
('10.5', '\\beta>0')
('10.5', 'r(x, y)')
('10.5', 'r(x, y) = \\beta \\log \\frac{\\pi(y|x)}{\\pi_\\text{ref}(y|x)}')
('10.5', '\\pi(y|x)')
('10.5', "r'(x, y) = r(x, y) + f(x)")
('10.5', "r'(x, y) = \\beta \\log \\frac{\\pi'(y|x)}{\\pi_\\text{ref}(y|x)}")
('10.5', "\\pi'(y|x)")
('10.5', 'r(x, y) = \\beta \\log \\frac{\\pi(y|x)}{\\pi_\\text{ref}(y|x)}')
('10.5', '\\pi(y|x)')
('10.5', "\\pi\\neq\\pi'")
('10.5', "r'(x, y) = r(x, y) + f(x) = \\beta \\log \\frac{\\pi(y|x)}{\\pi_\\text{ref}(y|x)} + f(x) =  \\beta \\log \\frac{\\pi(y|x)\\exp(\\frac{1}{\\beta} f(x))}{\\pi_\\text{ref}(y|x)}=\\beta \\log \\frac{\\pi'(y|x)}{\\pi_\\text{ref}(y|x)}")
('10.5', 'x')
('10.5', 'y')
('10.5', "\\pi(y|x)\\exp(\\frac{1}{\\beta} f(x)) = \\pi'(y|x)")
('10.5', 'y')
('10.5', '\\exp(\\frac{1}{\\beta} f(x)) = 1')
('10.5', '\\beta>0')
('10.5', 'f(x)=0')
('10.5', 'x')
('10.5', "r(x,y) = r'(x,y)")
('10.5', 'f(r, \\pi_\\text{ref}, \\beta)')
('11', '\\beta = 0.1')
('11', '\\beta=0.5')
('12.2', '\\log p(y_w|x)')
('12.2', '\\log p(y_l|x)')
('13.0', 'N')
('13.0', 'N')
('13.0', 'N')
('13.0', 'N')
('13.0', 'N=\\{1,4,16,64,128\\}')
