('3', 'M = (\\mathcal{X}, \\mathcal{S}, \\mathcal{A}, T, D, r, \\mu_0, \\gamma)')
('3', '\\mathcal{X}')
('3', '\\mathcal{S}')
('3', '\\mathcal{A}')
('3', "T(s'|s, a)")
('3', 'D(x|s)')
('3', 'r(s, a)')
('3', '\\mu_0(s_0)')
('3', '\\gamma \\in (0, 1)')
('3', '\\pi(a_t|x_t)')
('3', '\\eta_M \\coloneqq \\mathbb{E}_\\pi[\\sum_{t=0}^\\infty \\gamma^tr(s_t, a_t)]')
('3.0', 's_t')
('3.0', 'a_t')
('3.0', 'r_t')
('3.0', '\\mu_0(s_1)')
('3.0', 'T(s_{t+1}|s_t, a_t)')
('3.0', '\\mathcal{O}_t')
('3.0', 't')
('3.0', 'p(\\mathcal{O}_t = 1 | s_t, a_t) = \\exp(r(s_t, a_t))')
('3.0', 'p(\\mathcal{O}_{1:H})')
('3.0', 'H')
('3.0', '\\mathbb{E}[\\sum_{t=1}^H(r(s_t, a_t) + \\alpha\\mathcal{H}(\\pi(\\cdot|s_t)))]')
('3.0', 'q(s_{1:H}, a_{t+1:H}|x_{1:t+1}, a_{1:t})')
('3.0', 'q(s_{t+1}|x_{t+1}, s_t, a_t)')
('3.0', 'T(s_{t+1}|s_t, a_t)')
('3.0', '\\pi(a_t|x_{1:t}, a_{1:t-1})')
('3.0', 'p(x_{1:t+1}, \\mathcal{O}_{t+1:H}|a_{1:t})')
('3.0', '\\begin{aligned}\n    \\log  p(\\!~&x_{1:t+1}, \\mathcal{O}_{t+1:H} | a_{1:t})\\nonumber \\\\\n    \\geq \\!~& \\mathbb{E}_{(s_{1:H}, a_{t+1:H}) \\sim q}\n    \\left[\\sum_{\\tau=0}^t\\left(\\log D(x_{\\tau+1}|{s_{\\tau+1}}) - D_{KL} \\left( q(s_{\\tau+1}|x_{\\tau+1},s_\\tau, a_\\tau)\\middle\\| T(s_{\\tau+1}|s_\\tau,a_\\tau) \\right)\\right)\\right.\\nonumber\\\\\n    &\\left.+ \\sum_{\\tau=t+1}^H \\left(r(s_\\tau, a_\\tau) + \\log p(a_\\tau) - \\log\\pi(a_\\tau|x_{1:\\tau}, a_{1:\\tau-1})\\right)\\right]\\coloneqq \\mathcal{L}_\\text{ELBO}\\label{eq:policy}\n\\end{aligned}')
('3.0', 'r(s_\\tau, a_\\tau) = \\log p(\\mathcal{O}_\\tau = 1 | s_\\tau, a_\\tau)')
('3.0', 'p(a_\\tau)')
('3.0.0', '{\\mathcal{D}_\\text{env}}')
('3.0.0', '\\pi^{\\textup{B}}')
('3.0.0', '{\\mathcal{D}_\\text{env}}')
('3.0.0.0', '{\\mathcal{D}_\\text{env}}')
('3.0.0.0', 'M')
('3.0.0.0', '\\widehat{T}(\\cdot|s,a)')
('3.0.0.0', '\\widehat{r}(s,a)')
('3.0.0.0', '\\widetilde{M}')
('3.0.0.0', '\\widehat{T}')
('3.0.0.0', '\\widetilde{r}(s, a) = \\widehat{r}(s, a) - u(s, a)')
('3.0.0.0', 'u(s,a)')
('3.0.0.0', 'u(s,a) \\geq \\frac{r_{\\max}}{1-\\gamma} D_{TV}(T(s,a), \\widehat{T}(s,a))')
('3.0.0.0', '\\widetilde{M} = (\\mathcal{S}, \\mathcal{A}, \\widehat{T}, \\widetilde{r}, \\mu_0, \\gamma)')
('3.0.0.0', 'M')
('4.0', '\\mathcal{S}')
('4.0', 'M_\\mathcal{S}= (\\mathcal{S}, \\mathcal{A}, T, \\mu_0, \\mu_0, \\gamma)')
('4.0', '\\widehat{M}_\\mathcal{S}= (\\mathcal{S}, \\mathcal{A}, \\widehat{T}, r, \\mu_0, \\gamma)')
('4.0', "\\widehat{T}(s'|s,a)")
('4.0', '\\pi(a|s)')
('4.0', '\\widehat{M}_\\mathcal{S}')
('4.0', 'M_\\mathcal{S}')
('4.0', 'M_\\mathcal{S}')
('4.0', '\\widehat{M}_\\mathcal{S}')
('4.0', '\\widetilde{M}_\\mathcal{S}= (\\mathcal{S}, \\mathcal{A}, \\widehat{T}, \\widetilde{r}, \\mu_0, \\gamma)')
('4.0', '\\widetilde{r}(s, a) = r(s, a) - \\lambda u(s,a)')
('4.0', 'u(s, a)')
('4.0', '\\epsilon_u(\\pi) = \\underset{(s,a)\\sim \\rho^\\pi_{\\widehat{T},\\mu_0}}{\\bar{\\mathbb{E}}}[u(s,a)]')
('4.0', '\\rho^\\pi_{T,\\mu_0}(s,a) := \\sum_{t=0}^\\infty \\gamma^t \\mathbb{P}^\\pi_{T, \\mu, t}(s)\\pi(a \\,|\\,s)')
('4.0', '\\pi')
('4.0', '\\pi^*')
('4.0', '\\epsilon_u(\\pi^*)')
('4.0', '\\begin{aligned}\n    &\\eta_{M_\\mathcal{S}}(\\pi) \\geq \\eta_{\\widetilde{M}_\\mathcal{S}}(\\pi),\\label{eq:mopo}\\\\\n    &\\eta_{M_\\mathcal{S}}(\\hat{\\pi}) \\ge \\sup_{\\pi}\\{\\eta_{M_\\mathcal{S}}(\\pi) - 2\\lambda\\epsilon_u(\\pi)\\}\n\\end{aligned}')
('4.0', '\\hat{\\pi}')
('4.0', '\\widetilde{M}_\\mathcal{S}')
('4.0', 'u(s, a)')
('4.1', '\\widetilde{M} = (\\mathcal{X}, \\mathcal{S}, \\mathcal{A}, \\widehat{T}, D, \\widetilde{r}, \\mu_0, \\gamma)')
('4.1', '\\widehat{q}(s_{1:H}, a_{t+1:H}|x_{1:t+1}, a_{1:t})')
('4.1', 'q(s_{t+1}|x_{t+1}, s_t, a_t)')
('4.1', '\\widehat{T}(s_{t+1}|s_t, a_t)')
('4.1', '\\pi(a_t|x_{1:t}, a_{1:t-1})')
('4.1', '\\begin{aligned}\n    \\widehat{q}(s_{1:H}, a_{t+1:H}|x_{1:t+1}, a_{1:t})\\! =\\! \\prod_{\\tau=0}^tq(s_{\\tau+1}|x_{\\tau+1}, s_\\tau, a_\\tau)\\!\\!\\!\\prod_{\\tau=t+1}^{H-1}\\!\\!\\!\\widehat{T}(s_{\\tau+1}|s_\\tau, a_\\tau)\\!\\!\\!\\prod_{\\tau=t+1}^H\\!\\!\\!\\pi(a_\\tau|x_{1:\\tau}, a_{1:\\tau-1}).\\nonumber\n\\end{aligned}')
('4.1', '\\widehat{q}')
('4.1', '\\begin{aligned}\n    &\\mathbb{E}_{s_{t+1:H}, a_{t+1:H} \\sim q}\\left[ \\sum_{\\tau=t+1}^H r(s_\\tau, a_\\tau)\\right]\n    =\\underset{s_{t+1:H}, a_{t+1:H}\\sim \\rho^\\pi_{T,q(s_{t+1}|x_{t+1}, s_t, a_t)}}{\\bar{\\mathbb{E}}}\\left[ r(s_\\tau, a_\\tau)\\right]\\label{eq:init_dist}\\\\\n    &\\geq \\underset{s_{t+1:H}, a_{t+1:H}\\sim \\rho^\\pi_{\\widehat{T},q(s_{t+1}|x_{t+1}, s_t, a_t)}}{\\bar{\\mathbb{E}}}\\left[ \\widetilde{r}(s_\\tau, a_\\tau)\\right] = \\mathbb{E}_{s_{t+1:H}, a_{t+1:H} \\sim \\widehat{q}}\\left[ \\sum_{\\tau=t+1}^H \\widetilde{r}(s_\\tau, a_\\tau)\\right]\\label{eq:apply_mopo}\n\\end{aligned}')
('4.1', '\\widehat{q}')
('4.1', 'q(s_{t+1}|x_{t+1}, s_t, a_t)')
('4.1', '\\begin{aligned}\n    \\mathcal{L}_\\text{ELBO} \n    % &= \\E_{s_{1:H}, a_{t+1:H} \\sim q}\n    % \\left[\\!\\sum_{\\tau=0}^t\\!\\left(\\log D(x_{\\tau+1}|s_{\\tau+1})\\!-\\!D_{KL} \\left( q(s_{\\tau+1}|x_{\\tau+1},s_\\tau, a_\\tau)\\middle\\| T(s_{\\tau+1}|s_\\tau,a_\\tau) \\right)\\right)\\right. \\nonumber\\\\\n    % &\\left.+ \\sum_{\\tau=t+1}^H\\left(r(s_\\tau, a_\\tau) + \\log p(a_\\tau) - \\log\\pi(a_\\tau|x_{1:\\tau}, a_{1:\\tau-1})\\right)\\right]\\\\\n    &\\geq \\mathbb{E}_{s_{1:t}, a_{t+1:H} \\sim q}\\!\n    \\left[\\!\\sum_{\\tau=0}^t\\left(\n    \\underbrace{\\log D(x_{\\tau+1}|s_{\\tau+1})}_{\\mathrm{reconstruction}}\\!-\\! \n    \\underbrace{D_{KL} \\left( q(s_{\\tau+1}|x_{\\tau+1},s_\\tau, a_\\tau)\\middle\\| T(s_{\\tau+1}|s_\\tau,a_\\tau)\\! \\right)}_{\\mathrm{consistency}}\n    \\right)\\!\\right] \\label{eq:model_uncert}\\\\\n    &+ \\mathbb{E}_{s_{t+1:H}, a_{t+1:H} \\sim \\widehat{q}}\\left[\\sum_{\\tau=t+1}^H\\left(\\widetilde{r}(s_\\tau, a_\\tau)\\! +\\! \\log p(a_\\tau)\\! -\\! \\log\\pi(a_\\tau|x_{1:\\tau}, a_{1:\\tau-1})\\right)\\right] \\coloneqq \\widetilde{\\mathcal{L}}_\\text{ELBO}\\label{eq:policy_uncert}\n\\end{aligned}')
('4.1', '\\tilde{\\mathcal{L}}_\\text{ELBO}')
('4.1', '\\mathcal{L}_\\text{ELBO}')
('4.2', '\\label{eq1}\n\\begin{split}\n% \\ln p(x_{1:T}|a_{1:T}) & = \\int\\prod_{t=1}^TT(s_t|s_{t-1}, a_{t-1})p(x_t|s_t)ds_{1:T} \\\\\n%  & \\geq \\sum_{t=1}^T\\Big[\\mathbb{E}_{q(s_t|o_{\\leq t}, a_{\\leq t})}[\\ln p(o_t|s_t)]-\\\\\n%  & \\mathbb{E}_{q(s_{t-1}|o_{\\leq t-1}, a_{\\leq t-1})}D_{\\text{KL}}[q(s_t|o_{\\leq t}, a_{<t})||T_t(s_t|s_{t-1}, a_{t-1})]\\Big]\n &\\sum_{\\tau=0}^{H-1}\\Big[\\mathbb{E}_{q}[\\log D(x_{\\tau+1}|s_{\\tau+1})]-\\mathbb{E}_{q}D_{KL}(q(s_{\\tau+1}|x_{\\tau+1},s_\\tau, a_\\tau)\\| \\widehat{T}_{\\tau}(s_{\\tau+1}|s_{\\tau}, a_{\\tau}))\\Big]\n\\end{split}')
('4.2', '\\widehat{T}_{\\tau}')
('4.2', 'K')
('4.2', '\\{\\widehat{T}_1, \\ldots, \\widehat{T}_K\\}')
('4.2', 'q')
('4.2', '\\pi_{\\phi}(a_t|s_t)')
('4.2', 'Q_{\\phi}(s_t, a_t)')
('4.2', '\\mathcal{B}_{real}')
('4.2', '\\mathcal{B}_{sample}')
('4.2', 's_t, a_t, r_t, s_{t+1}')
('4.2', 's_{1:H}\\sim q(s_{1:H}|x_{1:H}, a_{1:H-1})')
('4.2', 'x_{1:H}, r_{1:H}, a_{1:H-1}\\sim\\mathcal{D}_{env}')
('4.2', '\\label{latentreward}\n    \\widetilde{r}_t(s_t, a_{t}) = \\frac{1}{K}\\sum_{i=1}^K r_{\\theta}(s_t^{(i)}, a_t) - \\lambda u(s_t, a_t)')
('4.2', 's^{(i)}_t\\sim \\widehat{T}_{\\theta_i}(s_{t-1}, a_{i-1})')
('4.2', 's_t')
('4.2', '\\{s^{(i)}_t, i=1,\\ldots, K\\}')
('4.2', 'u(s_t, a_t)')
('4.2', '\\lambda')
('4.2', 'u(s_t, a_t)')
('4.2', 'u(s_t, a_t) = \\text{Var}(\\{\\log \\widehat{T}_{\\theta_i}(s_t|s_{t-1}, a_{t-1}), i=1,\\ldots, K\\}),')
('4.2', '\\pi_{\\phi}(a_t|s_t), Q_{\\phi}(s_t, a_t)')
('5', '64\\times64')
('5', '128\\times128')
('5', '128\\times128')
('5', '64\\times 64')
('7', '64\\times 64')
('7', '128\\times 128')
('7', '128\\times 128')
('7', '128\\times 128')
('9', '\\begin{gathered}\n\\begin{aligned}\n&\\text{Image encoder:} &&h_t=E_\\theta(x_t) \\\\\n&\\text{Inference model:} && s_t \\sim q_\\theta(s_t|h_t, s_{t-1}, a_{t-1})\\\\\n&\\text{Latent transition model:} && s_t \\sim \\widehat{T}_\\theta(s_t| s_{t-1}, a_{t-1})\\\\\n&\\text{Reward predictor:} && r_t \\sim p_\\theta(r_t|s_t) \\\\\n&\\text{Image decoder:} && x_t \\sim D_\\theta(x_t|s_t).\n\\label{eq:latent_model}\n\\end{aligned}\n\\end{gathered}')
('9', 'x_t \\in \\mathcal{X}, s_t \\in \\mathcal{S}, a_t \\in \\mathcal{A}')
('9', 't')
('9', '\\theta')
('9', 's_t = [d_t, z_t]')
('9', 'd_t')
('9', 'z_t')
('9', '\\begin{gathered}\n\\begin{aligned}\n&\\text{Deterministic State Model:} &&d_t = f_{\\theta}(d_{t-1}, z_{t-1}, a_{t-1}) \\\\\n&\\text{Stochastic Inference Model:} &&z_t \\sim q_\\theta(z_t|h_t, d_t)\\\\\n&\\text{Ensemble of Transition Models:} &&z_t \\sim p_{\\theta_k}(z_t| d_t, z_{t-1}, a_{t-1})\\\\\n\\label{eq:rssm}\n\\end{aligned}\n\\end{gathered}')
('9', 'h_t = E_\\theta(x_t)')
('9', 'f_{\\theta}')
('9', '\\widehat{T}_{\\theta_k}, k=1,\\ldots,K')
('9', 'f_{\\theta}')
('9', 'p_{\\theta_k}, k=1,\\ldots,K')
('9', 'E_{\\theta}')
('9', 'D_{\\theta}')
('9', 'f_{\\theta}')
('9', 'T_{\\theta_i}, i=1,\\ldots, K')
('9', 'q_{\\theta}')
('9', 'lr = 6e-4')
('9', 'lr = 3e-4')
