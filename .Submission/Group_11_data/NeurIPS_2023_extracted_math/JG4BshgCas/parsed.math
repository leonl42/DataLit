('3.0', '\\mathcal{S}^\\text{meta} = \\{\\mathcal{T}_i\\}^T_i')
('3.0', 'P(\\mathcal{T})')
('3.0', '\\mathcal{T}_i')
('3.0', '\\mathcal{D}_i')
('3.0', '\\mathcal{D}^\\text{tr}_i')
('3.0', '\\mathcal{D}^\\text{ts}_i')
('3.0', 'K')
('3.0', '\\mathbf{x} \\in \\mathcal{X}')
('3.0', '\\mathbf{y} \\in \\mathcal{Y}')
('3.0', '\\mathcal{D}^\\text{tr}_i = \\{\n(\\mathbf{x}^k_i, \\mathbf{y}^k_i)\\}^K_{i=1}')
('3.0', '\\mathcal{D}^\\text{ts}_i')
('3.0', '\\mathcal{D}^\\text{tr}_i')
('3.0', '\\mathcal{D}^\\text{ts}_i')
('3.0', '\\mathcal{A}lg')
('3.0', '\\mathcal{L}')
('3.0', '\\mathcal{T}_i')
('3.0', '\\mathcal{A}lg_i')
('3.0', '\\mathbf{w}_i \\in \\mathbb{R}^d')
('3.0', '\\mathcal{S}^\\text{meta}')
('3.0', '\\mathcal{A}lg_j')
('3.0', '\\mathcal{T}_{j}')
('3.0', '\\begin{aligned}\n   &  \\min_{\\boldsymbol \\theta} \\sum_{i=1}^{T} \\mathcal{L} ( \\boldsymbol \\theta, \\mathbf{w}_i; \\mathcal{D}^\\text{ts}_i) \\label{eq:bilevel_meta-learner} \\\\\n     & \\text{s.t.}~\\mathbf{w}_i = \\min_{\\mathbf{w}} \\mathcal{L} (\\mathbf{w}; \\boldsymbol \\theta, \\mathcal{D}^\\text{tr}_i ) \\label{eq:bilelvel_base-learner},\n\\end{aligned}')
('3.0', '\\boldsymbol \\theta')
('3.0', '\\mathcal{T}_{j} \\in P(\\mathcal{T})')
('3.0', '\\mathcal{A}lg_j')
('3.0', '\\mathbf{w}_j')
('3.1', '\\mathcal{S}^\\text{meta} = \\{\\mathcal{T}_i\\}^T_{i=i}')
('3.1', '\\mathcal{S}^\\text{meta}')
('3.1', '\\mathcal{D}_i')
('3.1', '\\mathcal{T}_i \\in \\mathcal{S}^\\text{meta}')
('3.1', '\\mathcal{D}_j')
('3.1', '\\mathcal{T}_j')
('4.0', 'f_{\\boldsymbol \\theta}')
('4.0', '\\boldsymbol \\theta \\in \\Theta')
('4.0', '\\mathbf{z}_0 \\in \\mathcal{Z}')
('4.0', '\\mathbf{x}_0')
('4.0', 'C \\times H \\times W')
('4.0', '\\mathbf{z}')
('4.0', '\\label{eq:shift block}\n     \\mathbf{z}  = \\boldsymbol \\gamma \\odot \\mathbf{z}_0 + \\boldsymbol \\beta, ~~\\text{where}~~\\mathbf{z}_0 = f_{\\boldsymbol \\theta} (\\mathbf{x}_0) \\in \\mathbb{R}^{C \\times H \\times W},')
('4.0', '\\boldsymbol\\gamma')
('4.0', '\\boldsymbol \\beta')
('4.0', '\\mathbf{z} = \\text{FiSL}(\\mathbf{x}_0)')
('4.0', '\\boldsymbol \\phi =\\{\\boldsymbol \\gamma, \\boldsymbol \\beta\\}')
('4.1.0', 'P_0')
('4.1.0', 'P')
('4.1.0', 'P_0')
('4.1.0', '\\label{eq:worst-case}\n\\begin{split}\n  \\min_{\\boldsymbol \\theta} & \\sup_{P: D(P,P_0) \\leq \\rho} \\mathbb{E}_P[ \\mathcal{L}( \\boldsymbol \\theta, \\mathbf{w}^*; \\mathcal{D}^\\text{ts}_i)], \\\\\n  & \\text{where}~\\mathbf{w}^*_i = \\mathop{\\arg\\min}_{\\mathbf{w}} \\mathcal{L} (\\mathbf{w}; \\boldsymbol \\theta, \\mathcal{D}^\\text{tr}_i ).\n\\end{split}')
('4.1.0', 'P_0')
('4.1.0', 'P')
('4.1.0', 'D(P, P_0)')
('4.1.0', '\\mathcal{D}^\\text{tr}_i')
('4.1.0', '\\mathcal{D}^\\text{ts}_i')
('4.1.0', '\\mathcal{T}_i')
('4.1.0', 'P_0')
('4.1.0', '\\boldsymbol \\theta')
('4.1.0', 'P')
('4.1.0', '\\rho')
('4.1.0', 'P_0')
('4.1.0', '\\boldsymbol \\theta')
('4.1.0', 'P')
('4.1.0', '\\mathcal{Z}')
('4.1.0', 'D')
('4.1.0', 'c_{\\boldsymbol \\theta}: \\mathcal{Z} \\times \\mathcal{Z} \\rightarrow \\mathbb{R}_{+} \\cup \\{\\infty\\}')
('4.1.0', '(\\mathbf{x}_0, \\mathbf{y}_0)')
('4.1.0', '(\\mathbf{x}, \\mathbf{y})')
('4.1.0', '\\label{eq:wdistance}\n  c_{\\boldsymbol \\theta}((\\mathbf{x}_0, \\mathbf{y}_0), ( \\mathbf{x}, \\mathbf{y})) \\coloneqq \\frac{1}{2} \\|\\mathbf{z}_0 - \\mathbf{z} \\|^2_2 + \\infty \\cdot \\mathbf{1}\\{\\mathbf{y}_0 \\neq \\mathbf{y}\\},')
('4.1.0', '\\mathbf{z}_0 = f_{\\boldsymbol \\theta} (\\mathbf{x}_0)')
('4.1.0', '\\mathbf{z} = \\text{FiSL}(\\mathbf{x}_0)')
('4.1.0', '\\mathbf{x}')
('4.1.0', '\\mathbf{z}')
('4.1.0', 'P')
('4.1.0', 'P_0')
('4.1.0', '\\mathcal{Z}')
('4.1.0', '\\Pi(P, P_0)')
('4.1.0', '\\label{eq:our_wdistance}\n  D_{\\boldsymbol \\theta} (P, P_0) \\coloneqq \\inf_{M \\in \\Pi(P, P_0)} \\mathbb{E}_M[c_{\\boldsymbol \\theta}((\\mathbf{x}_0, \\mathbf{y}_0), (\\mathbf{x}, \\mathbf{y}))].')
('4.1.0', 'D_{\\boldsymbol \\theta}')
('4.1.0', '\\label{eq:our_definit}\n   \\min_{\\boldsymbol \\theta} \\sup_P \\{ \\mathbb{E}_P[ \\mathcal{L}( \\boldsymbol \\theta, \\mathbf{w}^*_i; \\mathcal{D}^\\text{ts}_i ):  D_{\\boldsymbol \\theta}(P, P_0)] \\leq \\rho \\}.')
('4.1.0', '\\rho')
('4.1.0', '\\mathcal{F}')
('4.1.0', '\\gamma')
('4.1.0', '\\label{eq:sup_max}\n \\min_{\\boldsymbol \\theta} \\sup_P \\{ \\mathbb{E}_P[ \\mathcal{L}( \\boldsymbol \\theta, \\mathbf{w}^*_i; \\mathcal{D}^\\text{ts}_i )- \\gamma D_{\\boldsymbol \\theta}(P, P_0)] \\},')
('4.1.0', '\\mathbf{w}^*_i = \\mathop{\\arg\\min}_\\mathbf{w} = \\mathcal{L}(\\mathbf{w}; \\boldsymbol \\theta, \\mathcal{D}^\\text{tr}_i)')
('4.1.0', 'P')
('4.1.0', '\\boldsymbol \\theta')
('4.1.0', '(\\Theta \\times \\mathbb{R}^d) \\times (\\mathcal{X} \\times \\mathcal{Y}) \\rightarrow R')
('4.1.0', '\\phi_r')
('4.1.0', 'P_0')
('4.1.0', '\\gamma \\geq 0')
('4.1.0', '\\begin{split}\n  & \\sup_P  \\{ \\mathbb{E}_P[ \\mathcal{L}( \\boldsymbol \\theta, \\mathbf{w}; \\mathcal{D}^\\text{ts}_i))- \\gamma D_{\\boldsymbol \\theta}(P, P_0)] \\} \\\\\n  & = \\mathbb{E}_{(\\mathbf{x}, \\mathbf{y} )\\in \\mathcal{D}^\\text{ts}_i} [\\phi_\\gamma(\\boldsymbol\\theta, \\mathbf{w}; \\mathbf{x}, \\mathbf{y})],~~~~~ \\text{where}\n\\end{split}')
('4.1.0', '\\label{eq:su_loss}\n\\begin{split}\n    & \\phi_\\gamma(\\boldsymbol\\theta, \\mathbf{w}; \\mathbf{x}_0, \\mathbf{y}_0) \\\\\n    & =\\sup_{\\mathbf{x} \\in \\mathcal{X}} \\{ \\mathcal{L}( \\boldsymbol \\theta, \\mathbf{w}; \\mathbf{x}, \\mathbf{y}_0 )- \\gamma c_{\\boldsymbol \\theta}( ( \\mathbf{x}_0, \\mathbf{y}_0), (\\mathbf{x}, \\mathbf{y}_0 ) ) \\}.\n\\end{split}')
('4.1.0', '\\boldsymbol \\theta')
('4.1.0', '\\phi_\\gamma')
('4.1.0', '\\mathbf{x}')
('4.1.0', '\\mathcal{T}_j')
('4.1.0', 'P_0')
('4.1.0', "\\label{eq:max}\n\\begin{split}\n   \\boldsymbol \\phi' =  \\boldsymbol \\phi +  \\eta \\nabla \\{ & \\mathbb{E}_{(\\mathbf{x}_0, \\mathbf{y}_0) \\in \\mathcal{D}^\\text{ts}_j}\\mathcal{L}(\\boldsymbol \\theta, \\mathbf{w}^*_j; \\mathbf{x}, \\mathbf{y}_0) \\\\\n   & - \\gamma c_{\\boldsymbol \\theta}(( \\mathbf{x}_0, \\mathbf{y_0}),( \\mathbf{x}, \\mathbf{y}_0) )  \\},\n\\end{split}")
('4.1.0', '\\mathbf{w}^*_j = \\mathop{\\arg\\min}_\\mathbf{w} = \\mathcal{L}(\\mathbf{w}; \\boldsymbol \\theta, \\mathcal{D}^\\text{tr}_j)')
('4.1.0', '\\mathbf{x}')
('4.1.0', '\\mathcal{T}_i')
('4.1.0', '\\hat{\\mathcal{T}_i}')
('4.1.0', '\\boldsymbol \\theta')
('4.1.0', '\\label{eq:min}\n  \\boldsymbol \\theta = \\boldsymbol \\theta - \\alpha \\nabla_{\\boldsymbol \\theta} \\mathcal{L} (\\boldsymbol \\theta, \\mathbf{w}_i^*; \\hat{\\mathcal{D}}^\\text{ts}_i),')
('4.1.0', '\\mathbf{w}_i^* = \\min_{\\mathbf{w}} \\mathcal{L} (\\mathbf{w}; \\boldsymbol \\theta, \\hat{\\mathcal{D}}^\\text{tr}_{i} )')
('4.1.0', "\\hat{\\mathcal{D}}^\\text{tr}_i = \\text{FiSL}_{\\boldsymbol \\phi'}(\\mathcal{D}^\\text{tr}_i)")
('4.1.0', "\\hat{\\mathcal{D}}^\\text{ts}_i = \\text{FiSL}_{\\boldsymbol \\phi'}(\\mathcal{D}^\\text{ts}_i)")
('4.1.1', '\\boldsymbol \\theta')
('4.1.1', '\\hat{\\mathcal{T}}_i')
('4.1.1', '\\mathcal{T}_k')
('4.1.1', '\\boldsymbol \\theta')
('4.1.1', '\\label{eq:overall-loss}\n       \\min_{\\boldsymbol \\theta} \\mathcal{L} (\\boldsymbol \\theta, \\mathbf{w}^*_k;  \\mathcal{D}^\\text{ts}_k)\n       +  \\mathcal{L} ( \\boldsymbol \\theta, \\mathbf{w}^*_{i} ;  \\hat{\\mathcal{D}}^\\text{ts}_{i}) ,')
('4.1.1', '\\mathbf{w}^*_{k}  = \\min_{\\mathbf{w}} \\mathcal{L} (\\mathbf{w}; \\boldsymbol \\theta, \\mathcal{D}^\\text{tr}_{k})')
('4.1.1', '\\mathbf{w}_{i}^*  = \\min_{\\mathbf{w}} \\mathcal{L} (\\mathbf{w}; \\boldsymbol \\theta, \\hat{\\mathcal{D}}^\\text{tr}_{i})')
('4.1.1', '\\hat{\\mathcal{D}}^\\text{tr}_{i}')
('4.1.1', '\\hat{\\mathcal{D}}^\\text{ts}_{i}')
('4.1.1', '\\boldsymbol \\theta, \\boldsymbol \\phi')
('4.1.1', '\\boldsymbol \\theta^*')
('4.1.1', '\\boldsymbol \\phi^*')
('4.1.1', '\\mathcal{T}_l')
('4.1.1', '\\label{eq:meta-test}\n  \\mathbf{w}_l = \\min_{\\mathbf{w}} \\mathcal{L} (\\mathbf{w}; \\boldsymbol \\theta^*, \\hat{\\mathcal{D}}^\\text{tr}_l), \\hat{\\mathcal{D}}^\\text{tr}_l = \\text{FiSL}_{\\boldsymbol \\phi^*}(\\mathcal{D}^\\text{tr}_l).\n  \\vspace{-2mm}')
('5.0', '[ 0.1, 3.0]')
('5.0', '[0, \\frac{3}{4}\\pi]')
('5.0', '[ 3.0, 5.0]')
('5.0', '[\\frac{3}{4}\\pi, \\pi]')
('5.0', '\\mathcal{D}^\\text{tr}')
('5.0', '\\mathcal{D}^\\text{ts}')
('5.0', '[-5, 5]')
('5.0', '\\mathcal{L}')
('5.0', '20,000')
('5.0', '2,000')
('5.0', '\\gamma')
('5.0', '\\eta')
('5.0', '0.5')
('5.0', '0.01')
('5.1', '64')
('5.1', '30,000')
('5.1', '0.001')
('5.1', '2')
('5.1', '0.1')
('5.1', '5')
('5.1', '\\gamma')
('5.1', '\\eta')
('5.1', '0.5')
('5.1', '0.1')
('5.1', '1,000')
('5.1', '95\\%')
('5.1', '\\mathcal{D}^\\text{ts}')
('5.1', '15')
('5.1', '5')
('5.1', '1')
('5.1', '5')
('5.1', '5')
('5.1', '3.06\\%')
('5.1', '6.72\\%')
