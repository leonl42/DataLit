('2', '\\langle{\\mathcal{S}}, {\\mathcal{A}}, {\\mathcal{P}}, r, \\gamma, \\mu_0\\rangle')
('2', '{\\mathcal{S}}')
('2', '{\\mathcal{A}}')
('2', '{\\mathcal{P}}{\\;:\\;}{\\mathcal{S}}{\\,\\times\\,}{\\mathcal{A}}{\\,\\times\\,}{\\mathcal{S}}{\\,\\rightarrow\\,}{\\mathbb{R}}^+')
('2', 'r{\\;:\\;}{\\mathcal{S}}{\\,\\times\\,}{\\mathcal{A}}{\\,\\rightarrow\\,}{\\mathbb{R}}')
('2', '\\gamma')
('2', '\\mu_0')
('2', '{{\\bm{s}}_0\\sim\\mu_0(\\cdot)}')
('2', '\\pi{\\,\\in\\,}\\Pi')
('2', '\\rho_\\pi({\\bm{s}},{\\bm{a}}) \\triangleq \\pi({\\bm{a}}\\,|\\,{\\bm{s}})\\,\\mu_\\pi({\\bm{s}})')
('2', '\\mu_\\pi({\\bm{s}}) \\triangleq \\sum_{t=0}^\\infty\\,\\gamma^t\\mu_t^\\pi({\\bm{s}})')
('2', "{\\mu_{t+1}^\\pi({\\bm{s}}') = \\int {\\mathcal{P}}({\\bm{s}}'\\mid{\\bm{s}},{\\bm{a}})\\,\\pi({\\bm{a}}\\mid{\\bm{s}})\\,\\mu_t^\\pi({\\bm{s}}) \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}}")
('2', '{\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim \\rho_\\pi}[f({\\bm{s}},{\\bm{a}})] =\n\\mathbb{E}_{\n{\\bm{s}}_{t+1} \\sim {\\mathcal{P}}(\\cdot\\mid{\\bm{s}}_t,{\\bm{a}}_t),\\,\n{\\bm{a}}_t\\sim\\pi(\\cdot\\mid{\\bm{s}}_t)}\n[\n\\sum_{t=0}^\\infty\\gamma^t\nf({\\bm{s}}_t,{\\bm{a}}_t)\n]}')
('2', 'd_\\pi({\\bm{s}},{\\bm{a}}) = (1-\\gamma)\\,\\rho_\\pi({\\bm{s}},{\\bm{a}})')
('2', '\\nu_\\pi({\\bm{s}}) = (1 - \\gamma)\\,\\mu_\\pi({\\bm{s}})')
('2', '{\\mathcal{D}}')
('2', "({\\bm{s}},{\\bm{a}},{\\bm{s}}')")
('2', '\\pi_*=\\mathop{\\mathrm{arg\\,max}}_\\pi \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim\\rho_\\pi}[r({\\bm{s}},{\\bm{a}})]')
('2', '\\textstyle \\min_{\\pi\\in\\Pi} l(\\pi, {\\mathcal{D}}) + \\lambda\\,\\Psi(\\pi),')
('2', 'l')
('2', '\\Pi')
('2', '\\Psi')
('2', '\\textstyle\\min_{\\pi\\in\\Pi} \\max_{r\\in{\\mathcal{R}}}\\,\\mathbb{E}_{{\\mathcal{D}}}[r]{-} \\mathbb{E}_{\\rho_\\pi}[r].')
('2', 'q({\\bm{a}}\\mid{\\bm{s}})')
('2', 'p({\\bm{a}}\\mid{\\bm{s}}) = {\\mathcal{U}}_{\\mathcal{A}}({\\bm{a}})')
('2', '{\\bm{\\phi}}')
('2', '\\begin{aligned}\n\\textstyle\n    \\min_{q,{\\bm{w}}}\n    \\textstyle\\int_{\\mathcal{S}}\n    \\nu_q({\\bm{s}})\\,\n    \\mathbb{D}_{\\textsc{kl}}[q({\\bm{a}}\\mid{\\bm{s}})\\mid\\mid p({\\bm{a}}\\mid{\\bm{s}})]\\,\n    {\\textnormal{d}}{\\bm{s}}\n    +\n    {\\bm{w}}^\\top(\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim {\\mathcal{D}}}[\n    {\\bm{\\phi}}({\\bm{s}},{\\bm{a}})]\n    {\\,-\\,}\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim \\rho_q}[\n    {\\bm{\\phi}}({\\bm{s}},{\\bm{a}})]\n    ).\n    \\label{eq:meirl}\n\\end{aligned}')
('2', '{\\bm{w}}^\\top{\\bm{\\phi}}({\\bm{s}},{\\bm{a}}) = r_{\\bm{w}}({\\bm{s}},{\\bm{a}})')
('2', "\\begin{aligned}\n{\\mathcal{Q}}({\\bm{s}},{\\bm{a}}) \n&{\\,=\\,}r_{\\bm{w}}({\\bm{s}},{\\bm{a}}) {\\,+\\,}\n\\gamma\n\\mathbb{E}_{{{\\bm{s}}'\\sim{\\mathcal{P}}(\\cdot\\mid{\\bm{s}},{\\bm{a}})}}[\n{\\mathcal{V}}_\\alpha({\\bm{s}}')],\n\\,\n{\\mathcal{V}}_\\alpha({\\bm{s}}){\\,=\\,}\\alpha\\log\\!{\\int_{\\mathcal{A}}}\\!\\!\\exp\\left(\\frac{1}{\\alpha}{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\\right){p({\\bm{a}}\\mid{\\bm{s}})}\\,{\\textnormal{d}}{\\bm{a}}{,}\n\\label{eq:soft_bellman_exact}\n\\intertext{for temperature $\\alpha = 1$. Using Jensen's inequality and importance sampling, this target is typically replaced with a lower-bound~\\citep{marino2021iterative}, which has the same optimum and samples from the optimized policy rather than the initial policy like many practical deep \\textsc{rl} algorithms \\citep{Haarnoja2018}:}\n{\\mathcal{Q}}({\\bm{s}},{\\bm{a}}) \n&{\\,=\\,}\nr_{\\bm{w}}({\\bm{s}},{\\bm{a}})\n{\\,+}\n\\gamma\\,\n\\mathbb{E}_{{\\bm{a}}'\\sim q(\\cdot\\mid{\\bm{s}}'),\\,{\\bm{s}}'\\sim {\\mathcal{P}}(\\cdot{\\,|\\,}{\\bm{s}},{\\bm{a}})}[{\\mathcal{Q}}({\\bm{s}}',{\\bm{a}}')\n{\\,-\\,}\n\\alpha\\,(\n\\log q({\\bm{a}}'{|\\,}{\\bm{s}}')\n{\\,-\\,}\n\\log p({\\bm{a}}'{|\\,}{\\bm{s}}'))\n].\n\\label{eq:soft_bellman}\n\\end{aligned}")
('2', '\\begin{aligned}\nq_\\alpha({\\bm{a}}\\mid{\\bm{s}})\n\\propto\n\\exp(\\alpha^{-1}({\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\n- {\\mathcal{V}}_\\alpha({\\bm{s}})\n)\\,p({\\bm{a}}\\mid{\\bm{s}}).\n\\label{eq:posteriorpolicy}\n\\end{aligned}')
('2', '\\max_q \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim \\rho_q}[{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})] - \\alpha\\,\\mathbb{D}_{\\textsc{kl}}[q({\\bm{a}}{\\,\\mid\\,}{\\bm{s}})\\mid\\mid p({\\bm{a}}{\\,\\mid\\,}{\\bm{s}})]')
('2', '\\alpha')
('2', 'q_{\\bm{\\theta}}')
('2', '{\\bm{s}}')
('2', '\\begin{aligned}\n{\\bm{\\theta}}_*\n&= \n\\textstyle\\mathop{\\mathrm{arg\\,min}}_{\\bm{\\theta}}\n\\textstyle\n\\mathbb{E}_{{\\bm{s}}\\sim{\\mathcal{B}}}[\\mathbb{D}_{\\textsc{kl}}[\nq_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})\n\\mid\\mid\nq_\\alpha({\\bm{a}}\\mid{\\bm{s}})]]\n=\n\\textstyle\n\\mathop{\\mathrm{arg\\,max}}_{\\bm{\\theta}}{\\mathcal{J}}_\\pi({\\bm{\\theta}}),\\nonumber\\\\\n{\\mathcal{J}}_\\pi({\\bm{\\theta}})\n&=\n\\mathbb{E}_{\n{\\bm{a}}\\sim q_{\\bm{\\theta}}(\\cdot{\\,\\mid\\,}{\\bm{s}}),\\,\n{\\bm{s}}\\sim{\\mathcal{B}}\n}\n\\left[\n{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\n{\\,-\\,} \\alpha\\,\n(\\log q_{\\bm{\\theta}}({\\bm{a}}{\\,\\mid\\,}{\\bm{s}})\n{\\,-\\,}\n\\log\np({\\bm{a}}\\mid{\\bm{s}}))\n\\right].\n\\end{aligned}')
('2', '{\\mathcal{J}}_\\pi')
('2', '{\\mathcal{B}}')
('2', 'f')
('3', '\\alpha')
('3', 'p')
('3', 'q_\\alpha')
('3', '\\begin{aligned}\n    {\\mathcal{Q}}({\\bm{s}},{\\bm{a}}) &= \\alpha\\log \\frac{q_\\alpha({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n    +\n    {\\mathcal{V}}_\\alpha({\\bm{s}}),\n    \\quad\n    {\\mathcal{V}}_\\alpha({\\bm{s}}) = \\alpha\\log\\int_{\\mathcal{A}}\\exp\\left(\\frac{1}{\\alpha}{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\\right)p({\\bm{a}}{\\mid}{\\bm{s}})\\,{\\textnormal{d}}{\\bm{a}}.\n    \\label{eq:invert_reward}\n\\end{aligned}')
('3', "\\begin{aligned}\n    r({\\bm{s}},{\\bm{a}})\n    &=\n    \\alpha\\log \\frac{q_\\alpha({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n    + {\\mathcal{V}}_\\alpha({\\bm{s}})\n    -\n    \\gamma\\,\n    \\mathbb{E}_{{\\bm{s}}'\\sim {\\mathcal{P}}(\\cdot\\mid{\\bm{s}},{\\bm{a}})}\\left[{\\mathcal{V}}_\\alpha({\\bm{s}}')\\right].\\label{eq:invert_bellman}\n\\end{aligned}")
('3', '{\\mathcal{V}}_\\alpha({\\bm{s}})')
('3', 'q_\\alpha({\\bm{a}}\\mid{\\bm{s}}){\\,=\\,}0')
('3', 'p({\\bm{a}}\\mid{\\bm{s}}){\\,=\\,}0')
('3', '\\alpha(\\log q({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))')
('3', 'r: {\\mathcal{S}}\\times {\\mathcal{A}}\\rightarrow {\\mathbb{R}}')
('3', '\\pi{\\,\\in\\,}\\Pi')
('3', '\\Psi: {\\mathcal{S}}\\rightarrow {\\mathbb{R}}')
('3', '\\tilde{r}')
('3', "r({\\bm{s}},{\\bm{a}}) = \\tilde{r}({\\bm{s}},{\\bm{a}}) + \\Psi({\\bm{s}}) - \\gamma\\,\\mathbb{E}_{{\\bm{s}}'\\sim {\\mathcal{P}}(\\cdot\\mid{\\bm{s}},{\\bm{a}})}[\\Psi({\\bm{s}}')]")
('3', '\\tilde{{\\mathcal{Q}}}')
('3', '{\\mathcal{Q}}({\\bm{s}},{\\bm{a}}) = \\tilde{{\\mathcal{Q}}}({\\bm{s}},{\\bm{a}}) + \\Psi({\\bm{s}})')
('3', '{\\mathcal{V}}_\\alpha({\\bm{s}})')
('3', '\\Psi({\\bm{s}})')
('3', 'q_\\alpha({\\bm{a}}|{\\bm{s}})')
('3', '{\\mathcal{D}}')
('3', 'p')
('3', '\\begin{aligned}\n    \\tilde{r}({\\bm{s}},{\\bm{a}})\n    {\\,=\\,}\n    \\alpha\\log \\frac{q_\\alpha({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n    \\;\n    {\\begin{cases}\n    \\;\\geq 0 \\text{ if } {\\bm{s}},{\\bm{a}}\\in{\\mathcal{D}},\\\\\n    \\;< 0 \\text{ if } {\\bm{s}}\\in{\\mathcal{D}},{\\bm{a}}\\notin{\\mathcal{D}},\\\\\n    \\;= 0 \\text{ if } {\\bm{s}}\\notin{\\mathcal{D}},\\forall {\\bm{a}}\\in {\\mathcal{A}}.\n    \\end{cases}}\n\\end{aligned}')
('3', '{\\mathcal{D}}')
('3', 'q({\\bm{a}}{\\,|\\,}{\\bm{s}})')
('3', 'p({\\bm{a}}{\\,|\\,}{\\bm{s}})')
('3', 'q({\\bm{a}}{\\,|\\,}{\\bm{s}})')
('3', 'p({\\bm{a}}{\\,|\\,}{\\bm{s}})')
('3', '\\lambda')
('3', '\\begin{aligned}\n\\textstyle\n&\n\\textstyle\n\\max_{q} & &\\mathbb{E}_{{\\bm{x}}\\sim q(\\cdot)}[f({\\bm{x}})]\n-\n\\lambda\\,\n(\\mathbb{D}_{\\textsc{kl}}[q({\\bm{x}})\\mid\\mid p({\\bm{x}})] - \\epsilon)\n&\n&\\rightarrow\n&&\nq_{\\lambda}({\\bm{x}}) \\propto \\exp(\\lambda^{-1}\\, f({\\bm{x}}))\\,p({\\bm{x}}).\n\\\\\n&\\textstyle\\min_{q} & &\\mathbb{D}_{\\textsc{kl}}[q({\\bm{x}})\\mid\\mid p({\\bm{x}})]\n-\n\\bm{\\lambda}^\\top\n(\\mathbb{E}_{{\\bm{x}}\\sim q(\\cdot)}[{\\bm{f}}({\\bm{x}})] - {\\bm{f}}^*)\n&\n&\\rightarrow\n&&\nq_{\\bm{\\lambda}}({\\bm{x}}) \\propto \\exp(\\bm{\\lambda}^\\top{\\bm{f}}({\\bm{x}}))\\,p({\\bm{x}}).\n\\end{aligned}')
('3', '\\exp(\\bm{\\lambda}^\\top{\\bm{f}}({\\bm{x}}))')
('3', '{\\bm{f}}')
('3', 'f')
('3', '\\epsilon')
('3', '\\lambda')
('3', '{\\bm{f}}')
('3', 'f')
('3', 'q({\\bm{a}}\\mid{\\bm{s}})')
('3', 'p({\\bm{a}}\\mid{\\bm{s}},{\\bm{w}})')
('3', '{\\bm{w}}')
('3', 'p({\\bm{w}})')
('3', 'p({\\bm{a}}\\mid{\\bm{s}}) = \\int p({\\bm{a}}\\mid{\\bm{s}},{\\bm{w}})p({\\bm{w}})\\,{\\textnormal{d}}{\\bm{w}}\\;\\forall{\\bm{s}}\\in{\\mathcal{S}}')
('3', 'p({\\bm{a}}\\mid{\\bm{s}}) = {\\mathcal{U}}_{\\mathcal{A}}({\\bm{a}})')
('3', '\\begin{aligned}\n    \\textstyle\\max_{\\bm{\\theta}}\\mathbb{E}_{{\\bm{a}},{\\bm{s}}\\sim {\\mathcal{D}}}[\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})]{\\,-\\,}\\lambda\\,\\mathbb{D}_{\\textsc{kl}}[q_{\\bm{\\theta}}({\\bm{w}})\\mid\\mid p({\\bm{w}})],\n    \\;\n    q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}) = \\int p({\\bm{a}}\\mid{\\bm{s}},{\\bm{w}}) \n    \\,\n    q_{\\bm{\\theta}}({\\bm{w}})\n    \\,{\\textnormal{d}}{\\bm{w}}.\n    \\label{eq:regression}\n\\end{aligned}')
('3', '{\\bm{\\theta}}_1 = \\mathop{\\mathrm{arg\\,max}}_{{\\bm{\\theta}}} \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}) - \\Psi({\\bm{\\theta}})]')
('3', '\\tilde{r}_{{\\bm{\\theta}}_1}({\\bm{s}},{\\bm{a}}) = \\alpha (\\log q_{{\\bm{\\theta}}_1}({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))')
('3', '\\pi({\\bm{a}}\\mid{\\bm{s}})')
('3', 'p({\\bm{a}}\\mid{\\bm{s}})')
('3', 'q_{{\\bm{\\theta}}_1}({\\bm{a}}\\mid{\\bm{s}})')
('3', "\\tilde{{\\mathcal{Q}}}_1({\\bm{s}},{\\bm{a}}) = \\tilde{r}_{{\\bm{\\theta}}_1}({\\bm{s}},{\\bm{a}})  + \\gamma\\,(\\tilde{{\\mathcal{Q}}}_1({\\bm{s}}',{\\bm{a}}'){-}\\alpha\\,(\\log q_{{\\bm{\\theta}}_1}({\\bm{a}}'\\mid{\\bm{s}}')-\\log\\pi({\\bm{a}}'\\mid{\\bm{s}}')),\\,\n{\\bm{s}},{\\bm{a}},{\\bm{s}}',{\\bm{a}}' \\sim {\\mathcal{D}}")
('3', 'n = 2 \\rightarrow N')
('3', '\\tilde{{\\mathcal{Q}}}_n')
('3', 'q_{{\\bm{\\theta}}_n}')
('3', '\\beta')
('3', 'q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})')
('3', 'r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}}){\\,=\\,}\\alpha (\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}){-}\\log p({\\bm{a}}\\mid{\\bm{s}}))')
('3', '\\alpha')
('3', '\\beta < \\alpha')
('3', '\\beta')
('3', '\\alpha')
('3', 'q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})')
('3', 'r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}}) = \\alpha (\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))')
('3', '\\alpha \\geq 0')
('3', 'p({\\bm{a}}\\mid{\\bm{s}},{\\bm{w}})')
('3', '{\\bm{w}}')
('3', '\\begin{aligned}\n    &\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}})\\right] -\n    \\mathbb{E}_{{\\bm{a}}\\sim q_{\\bm{\\theta}}(\\cdot\\mid{\\bm{s}}),\\,{\\bm{s}}\\sim\\mu_{q_{\\bm{\\theta}}}(\\cdot)}\n    \\left[\n    r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}}) \n    -\n    \\beta(\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))\n    \\right]\n    \\geq\\\\\n    &\\hspace{8em}\n    \\alpha\\,(\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}) \\right] -\n    \\lambda\\,\\mathbb{D}_{\\textsc{kl}}[q_{\\bm{\\theta}}({\\bm{w}})\\mid\\mid p({\\bm{w}})]\n    + \n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\log p({\\bm{a}}\\mid{\\bm{s}})\\right]).\n\\end{aligned}')
('3', '\\lambda = (\\alpha-\\beta)/\\alpha')
('3', '\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\log p({\\bm{a}}\\mid{\\bm{s}})\\right]')
('3', '\\mu_q({\\bm{s}})')
('3', '\\beta')
('3', '{\\mathcal{D}}')
('3', '\\beta = \\alpha')
('3', '\\lambda = 0')
('3', '{\\mathcal{D}}')
('3', '\\beta<\\alpha')
('3', '\\lambda>0')
('4', '{p({\\bm{a}}\\mid{\\bm{s}}) = {\\mathcal{U}}_{\\mathcal{A}}({\\bm{a}}) \\; \\forall\\;{\\bm{s}}\\in {\\mathcal{S}}},')
('4', '{\\mathcal{U}}_{\\mathcal{A}}')
('4', '{\\mathcal{A}}')
('4', 'f: {\\mathcal{X}}\\rightarrow {\\mathcal{Y}}')
('4', '{\\bm{y}}\\in{\\mathcal{Y}}')
('4', 'p({\\bm{y}}_1,\\dots,{\\bm{y}}_n)')
('4', '{\\bm{x}}_1,\\dots,{\\bm{x}}_n \\in {\\mathcal{X}}')
('4', 'n \\in {\\mathbb{N}}_{>0}')
('4', 'f_{\\text{per}}')
('4', '{\\bm{a}}= \\text{tanh}({\\bm{z}}({\\bm{s}})),')
('4', '{\\bm{z}}({\\bm{s}}) = {\\bm{W}}{\\bm{\\phi}}({\\bm{s}})')
('4', '{\\bm{W}}= [{\\bm{w}}_1, \\dots, {\\bm{w}}_{d_a}]^\\top,\n\\;\n{\\bm{w}}_i = {\\mathcal{N}}({\\bm{\\mu}}_i,{\\bm{\\Sigma}}_i)')
('4', '\\begin{aligned}\nq(a_i\\mid{\\bm{s}}) = {\\mathcal{N}}\n\\left(\nz_i;{\\bm{\\mu}}_i^\\top{\\bm{\\phi}}({\\bm{s}}),\\,{\\bm{\\phi}}({\\bm{s}})^\\top{\\bm{\\Sigma}}_i\\,{\\bm{\\phi}}({\\bm{s}})\n\\right)\n\\cdot\n\\bigg\\rvert\\text{det}\n\\left(\\frac{{\\textnormal{d}}a_i}{{\\textnormal{d}}z_i}\\right)\n\\bigg\\rvert^{-1},\n\\quad\n{\\bm{\\phi}}({\\bm{s}}) = f_{\\text{per}}(\\tilde{{\\bm{W}}}{\\bm{\\phi}}_{\\text{mlp}}({\\bm{s}})).\n\\end{aligned}')
('4', '\\tilde{{\\bm{W}}}')
('4', '{\\bm{\\phi}}_{\\text{mlp}}')
('4', '\\min_{\\bm{\\phi}}\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[\\nabla_{\\bm{a}}{\\mathcal{Q}}_{\\bm{\\phi}}({\\bm{s}},{\\bm{a}})]')
('4', '\\mathbb{D}_{\\textsc{kl}}[q_{\\bm{\\theta}}({\\bm{a}}\\,|\\,{\\bm{s}}) \\,||\\, q_{{\\bm{\\theta}}_1}({\\bm{a}}\\,|\\,{\\bm{s}})]')
('8', 'f')
('8', 'Q')
('8', 'Q')
('8', 'Q')
('8', '\\pm 1')
('8', 'Q')
('9', '\\begin{aligned}\n    \\pi({\\bm{a}}\\mid{\\bm{s}}) = \n    \\begin{cases}\n    p_{\\mathcal{D}}({\\bm{a}}\\mid{\\bm{s}}) \n    \\text{ if }\n    {\\bm{s}}\\in{\\mathcal{D}},\n    \\text{ where $p_{\\mathcal{D}}$ denotes conditional density estimation of ${\\mathcal{D}}$,}\\\\\n    {\\mathcal{U}}_{\\mathcal{A}}({\\bm{a}})\n    \\text{ otherwise.}\n    \\end{cases}\n\\end{aligned}')
('10', '{y = {\\bm{w}}^\\top{\\bm{\\phi}}({\\bm{x}})}')
('10', '{{\\bm{w}}\\sim{\\mathcal{N}}({\\bm{\\mu}},{\\bm{\\Sigma}})}')
('10', "{\\mathcal{K}}({\\bm{x}},{\\bm{x}}') = {\\bm{\\phi}}({\\bm{x}})^\\top{\\bm{\\phi}}({\\bm{x}}')")
('10', '{\\bm{r}}\\in {\\mathbb{R}}^d')
('10', '{\\mathcal{K}}({\\bm{r}}) = {\\bm{\\phi}}({\\bm{x}})^\\top{\\bm{\\phi}}({\\bm{x}}+{\\bm{r}})')
('10', '{\\mathcal{C}}({\\bm{r}}) = {\\bm{\\phi}}({\\bm{x}})^\\top\\,{\\bm{\\Sigma}}\\,{\\bm{\\phi}}({\\bm{x}}+{\\bm{r}})')
('10', 'S(\\bm{\\omega})')
('10', '\\begin{aligned}\n    {\\mathcal{C}}({\\bm{r}}) =\n    \\frac{1}{(2\\pi)^d}\n    \\int_{{\\mathbb{R}}^{d}} S(\\bm{\\omega})\\exp(i\\bm{\\omega}^\\top{\\bm{r}})\\,{\\textnormal{d}}{\\bm{r}},\n    \\quad\n    S(\\bm{\\omega}) = \\int_{{\\mathbb{R}}^d} {\\mathcal{C}}({\\bm{r}}) \\exp(-i\\bm{\\omega}^\\top{\\bm{r}})\\,{\\textnormal{d}}\\bm{\\omega}.\n\\end{aligned}')
('10', '\\exp(i\\omega^\\top{\\bm{r}})')
('10', '< 20')
('10', '{\\bm{r}}')
('10', 't')
('10', 'f_p({\\bm{W}}{\\bm{\\phi}}({\\bm{x}})),')
('10', 'f_p')
('10', '{\\bm{W}}')
('10', '{\\bm{\\phi}}({\\bm{x}})')
('10', '{\\bm{W}}')
('11', '\\begin{aligned}\n    {\\mathcal{L}}({\\mathcal{D}}, {\\bm{\\theta}}) &=\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\n    \\left\n    [({\\bm{a}}- {\\bm{\\mu}}_{\\bm{\\theta}}({\\bm{s}}))^2\n    -\n    \\log \\tilde{q}({\\bm{a}}\\mid{\\bm{s}})\n    \\right],\n    \\quad\n    \\tilde{q}({\\bm{a}}\\mid{\\bm{s}}) = {\\mathcal{N}}(\\text{\\texttt{sg}}({\\bm{\\mu}}_{\\bm{\\theta}}({\\bm{s}})),{\\bm{\\Sigma}}_{\\bm{\\theta}}({\\bm{s}})),\n\\end{aligned}')
('11', '\\text{\\texttt{sg}}(\\cdot)')
('12', '\\begin{aligned}\n{\\mathcal{J}}_r({\\bm{\\theta}})\n=\n\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\alpha \\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\right]\n-\n\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim\\rho_\\pi}\\left[\\alpha \\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\right].\n\\label{eq:r_finetune}\n\\end{aligned}')
('12', '\\pi')
('12', 'q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})')
('12', 'q')
('12', 'p')
('12', '\\mathbb{E}_{{\\bm{x}}\\sim q(\\cdot)}[R({\\bm{x}})^{-1}] \n=\n\\int p({\\bm{x}})\\,{\\textnormal{d}}{\\bm{x}}\n= 1')
('12', '\\log(x)\\leq x-1')
('12', '\\begin{aligned}\n\\mathbb{D}_{\\textsc{kl}}[q({\\bm{x}})\\mid\\mid p({\\bm{x}})] = \\mathbb{E}_{{\\bm{x}}\\sim q(\\cdot)}[\\log R({\\bm{x}})]\n=\n\\mathbb{E}_{{\\bm{x}}\\sim q(\\cdot)}[\nR({\\bm{x}})^{-1}- 1 + \\log R({\\bm{x}})\n],\n\\end{aligned}')
('12', '\\begin{aligned}\n\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim\\rho_\\pi}\\left[r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}})\n\\right]\n\\rightarrow\n\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim\\rho_\\pi}\\left[r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}}) - 1 + \\exp(-r_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}}))\n\\right].\n\\label{eq:reward_reg}\n\\end{aligned}')
('12', 'q_{\\bm{\\theta}}')
('13', '\\alpha (\\log q({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))')
('13', 'p({\\bm{a}}\\mid{\\bm{s}}) > 0')
('13', 'q({\\bm{a}}\\mid{\\bm{s}}) > 0')
('13', '\\sigma^2_{\\text{min}}')
('13', '-\\sum_{i=1}^{d_a}\\log(1-\\text{tanh}^2(u))')
('13', 'u\\in[-\\infty,\\infty]')
('13', 'd_a')
('13', '[-1, 1]^{d_{a}}')
('13', '\\alpha = d_a^{-1}')
('13', 'r({\\bm{s}},{\\bm{a}})\\leq\n\\frac{1}{d_a}(-0.5 d_a \\log 2\\pi\\sigma^2_{\\text{min}} + c + d_a \\log 2) = -0.5 \\log \\pi\\sigma^2_{\\text{min}}/2 + \\tilde{c}')
('13', 'c, \\tilde{c}')
('15', '{\\mathcal{Q}}(a)')
('15', '\\textstyle\\min_{\\bm{\\phi}}{\\mathcal{J}}_{\\mathcal{Q}}({\\bm{\\phi}})')
('15', '\\begin{aligned}\n    {\\mathcal{J}}_{\\mathcal{Q}}({\\bm{\\phi}}) = \n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{B}}}\n    [({\\mathcal{Q}}_{\\bm{\\phi}}({\\bm{s}},{\\bm{a}}) - {\\mathcal{Q}}^*({\\bm{s}},{\\bm{a}}))^2]\n    + \n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[|\\nabla_{\\bm{a}}{\\mathcal{Q}}_{\\bm{\\phi}}({\\bm{s}},{\\bm{a}})|^2],\n    \\label{eq:critic_objective}\n\\end{aligned}')
('15', '{\\mathcal{Q}}^*')
('15', 'Q')
('15', '{\\mathcal{B}}')
('15', '{\\mathcal{D}}')
('15', "\\begin{aligned}\n    \\textstyle\n    \\max_{\\bm{\\phi}}\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{B}}}\n    \\left[\n    f\\left(\n    {\\mathcal{Q}}_{\\bm{\\phi}}({\\bm{s}},{\\bm{a}})\n    - \\gamma\\,\\mathbb{E}_{{\\bm{s}}'\\sim{\\mathcal{P}}(\\cdot\\mid{\\bm{s}},{\\bm{a}})}\n    [{\\mathcal{V}}_{\\bm{\\phi}}^\\pi({\\bm{s}}')]\n    \\right)\\right]\n    -\n    (1-\\gamma)\n    \\mathbb{E}_{{\\bm{s}}\\sim\\mu_0}\n    [{\\mathcal{V}}_{\\bm{\\phi}}^\\pi({\\bm{s}})],\n\\end{aligned}")
('15', "{\\mathcal{V}}_{\\bm{\\phi}}^\\pi({\\bm{s}}) = {\\mathcal{Q}}({\\bm{s}},{\\bm{a}}')")
('15', "{\\bm{a}}'\\sim\\pi(\\cdot\\mid{\\bm{s}})")
('15', 'f')
('15', '\\mu_0')
('16', '\\max_{\\bm{\\theta}}{\\mathcal{J}}_\\pi({\\bm{\\theta}})')
('16', '\\begin{aligned}\n{\\mathcal{J}}_\\pi({\\bm{\\theta}})\n=\nE_{\n{\\bm{a}}\\sim q_{\\bm{\\theta}}(\\cdot\\mid{\\bm{s}}),\\,\n{\\bm{s}}\\sim {\\mathcal{B}}\\,\\cup\\,{\\mathcal{D}}\n}\n\\left[\n{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\n- \\beta (\\log q_{\\bm{\\theta}}(\\cdot\\mid{\\bm{s}})\n-\n\\log\nq_{{\\bm{\\theta}}_1}(\\cdot\\mid{\\bm{s}}))\n\\right].\n\\label{eq:policy_objective}\n\\end{aligned}')
('16', '\\beta')
('16', '{\\bm{\\theta}}_1 = \\mathop{\\mathrm{arg\\,max}}_{{\\bm{\\theta}}} \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}}) - \\Psi({\\bm{\\theta}})]')
('16', '\\tilde{r}_{{\\bm{\\theta}}_1}({\\bm{s}},{\\bm{a}}) = \\alpha (\\log q_{{\\bm{\\theta}}_1}({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))')
('16', '{\\mathcal{D}}')
('16', '\\tilde{r}_{{\\bm{\\theta}}_1}')
('16', 't = 1 \\rightarrow T')
('16', '{\\bm{s}}_{t+1} = \\text{\\texttt{Env}}({\\bm{s}}_t, {\\bm{a}}_t)')
('16', '{\\bm{a}}_t \\sim q_{{\\bm{\\theta}}_t}(\\cdot\\mid{\\bm{s}}_t)')
('16', '{\\mathcal{B}}')
('16', '{\\mathcal{J}}_{\\mathcal{Q}}({\\bm{\\phi}})')
('16', '{\\mathcal{J}}_r({\\bm{\\theta}})')
('16', '{\\mathcal{B}}')
('16', '{\\mathcal{J}}_\\pi({\\bm{\\theta}})')
('16', '{\\mathcal{B}}')
('17', 'p_{\\mathcal{D}}({\\bm{s}},{\\bm{a}}) = p_{\\mathcal{D}}({\\bm{a}}\\mid{\\bm{s}})\\,p_{\\mathcal{D}}({\\bm{s}})')
('17', '\\begin{aligned}\n    {\\bm{\\theta}}_1 = \\textstyle\\mathop{\\mathrm{arg\\,min}}_{\\bm{\\theta}}\\mathbb{E}_{{\\bm{s}}\\sim p_{\\mathcal{D}}(\\cdot)}[\\mathbb{D}_{\\textsc{kl}}[p_{\\mathcal{D}}({\\bm{a}}\\mid{\\bm{s}}) \\mid\\mid q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})]]\n    =\n    \\mathop{\\mathrm{arg\\,max}}_{\\bm{\\theta}}\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})].\n\\end{aligned}')
('17', '\\begin{aligned}\n{\\bm{\\theta}}_* &=\n\\textstyle\\mathop{\\mathrm{arg\\,max}}_{{\\bm{\\theta}}}\n\\mathbb{E}_{{\\bm{a}}\\sim q_{\\bm{\\theta}}(\\cdot\\mid{\\bm{s}}),\\, {\\bm{s}}\\sim \\mu_{\\pi_{\\bm{\\theta}}}(\\cdot)}\\left[\\alpha \\log\\frac{q_{{\\bm{\\theta}}_1}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n-\n\\beta \\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})} \\right],\\\\\n&=\n\\textstyle\\mathop{\\mathrm{arg\\,min}}_{q_{\\bm{\\theta}}}\n\\mathbb{E}_{{\\bm{s}}\\sim\\mu_{q_{\\bm{\\theta}}}(\\cdot)}[\n\\alpha\\,\n\\mathbb{D}_{\\textsc{kl}}[q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})\\mid\\mid q_{{\\bm{\\theta}}_1}({\\bm{a}}\\mid{\\bm{s}})]\n-\n(1 - \\beta/\\alpha)\\,\n\\mathbb{D}_{\\textsc{kl}}[q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})\\mid\\mid p({\\bm{a}}\\mid{\\bm{s}})]\n].\n\\end{aligned}')
('17', '\\beta \\leq \\alpha')
('17', '(1-\\beta/\\alpha)\\geq 0')
('17', 'q_{\\bm{\\theta}}')
('17', 'q_{\\bm{\\theta}}')
('17', '\\beta = \\alpha')
('17', 'q_{\\bm{\\theta}}')
('17', 'q_{{\\bm{\\theta}}_1}')
('18.0', '\\epsilon')
('18.0', '\\begin{aligned}\n    \\textstyle\\max_q\n    \\mathbb{E}_{{\\bm{s}}_{t+1}\\sim {\\mathcal{P}}(\\cdot\\mid{\\bm{s}}_t,{\\bm{a}}_t),\\,\n    {\\bm{a}}_t\\sim q(\\cdot\\mid{\\bm{s}}_t),\\,\n    {\\bm{s}}_0\\sim\\mu_0(\\cdot)}\n    [\\sum_t \\gamma^t r({\\bm{s}}_t,{\\bm{a}}_t)]\n    \\quad\n    \\text{s.t.}\n    \\quad\n    \\mathbb{E}_{{\\bm{s}}\\sim\\nu_q(\\cdot)}\n    [\\mathbb{D}_{\\textsc{kl}}[q({\\bm{a}}\\mid{\\bm{s}})\\mid\\mid p({\\bm{a}}\\mid{\\bm{s}})]]\n    \\leq \\epsilon.\n\\end{aligned}')
('18.0', 'd({\\bm{s}},{\\bm{a}}) = q({\\bm{a}}\\mid{\\bm{s}})\\,\\nu({\\bm{s}})\n= (1-\\gamma)\\rho({\\bm{s}},{\\bm{a}})')
('18.0', "\\begin{aligned}\n    {\\mathcal{L}}(d, \\lambda_1, \\lambda_2, \\lambda_3)\n    &=\n    (1-\\gamma)^{-1}\\int_{{\\mathcal{S}}\\times{\\mathcal{A}}}\n    d({\\bm{s}},{\\bm{a}})\\,\n    r({\\bm{s}},{\\bm{a}})\n    \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}+\n    \\lambda_1\n    \\left(\n    1-\n    \\int_{{\\mathcal{S}}\\times{\\mathcal{A}}}\n    d({\\bm{s}},{\\bm{a}})\n    \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}\n    \\right)\\\\\n    &+\n    \\int_{{\\mathcal{S}}}\n    \\lambda_2({\\bm{s}}')\n    \\left(\n    \\int_{{\\mathcal{S}}\\times{\\mathcal{A}}}\n    \\gamma\\, {\\mathcal{P}}({\\bm{s}}'\\mid{\\bm{s}},{\\bm{a}})\\,\n    d({\\bm{s}},{\\bm{a}})\n    \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}\n    +\n    (1-\\gamma)\\mu_0({\\bm{s}}')\n    -\n    \\int_{{\\mathcal{A}}}\n    d({\\bm{s}}',{\\bm{a}}')\\,{\\textnormal{d}}{\\bm{a}}'\n    \\right)\\,{\\textnormal{d}}{\\bm{s}}'\n    \\\\\n    &+ \\lambda_3\n    \\left(\n    \\epsilon -\n    \\int_{\\mathcal{S}}\\nu({\\bm{s}})\n    \\int_{\\mathcal{A}}q({\\bm{a}}\\mid{\\bm{s}})\n    \\log\\frac{q({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\,\n    {\\textnormal{d}}{\\bm{a}}\\,\n    {\\textnormal{d}}{\\bm{s}}\n    \\right),\n\\intertext{\nwhere $\\lambda_2$ is a function for an infinite-dimensional constraint.\nSolving for $\\partial{\\mathcal{L}}(q, \\lambda_1, \\lambda_2, \\lambda_3)/\\partial d = 0$,}\n    q({\\bm{a}}\\mid{\\bm{s}})\n    &\\propto\n    \\exp\n    (\n    \\alpha^{-1}\n    (\n    \\underbrace{\n    r({\\bm{s}},{\\bm{a}})\n    +\n    \\gamma\\,\n    \\mathbb{E}_{{\\bm{s}}'\\sim {\\mathcal{P}}(\\cdot\\mid{\\bm{s}},{\\bm{a}})}\n    [{\\mathcal{V}}({\\bm{s}}')]\n    }_{{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})}\n    -{\\mathcal{V}}({\\bm{s}})\n    )\n    )\\,\n    p({\\bm{a}}\\mid{\\bm{s}}),\n\\intertext{\nwith $\\alpha = (1-\\gamma)\\lambda_3$ and $\\lambda_2({\\bm{s}})=(1-\\gamma){\\mathcal{V}}({\\bm{s}})$,\nwhere ${\\mathcal{V}}$ can be interpreted as the soft value function,}\n    {\\mathcal{V}}({\\bm{s}}) &=\n    \\alpha\n    \\log \\int_{\\mathcal{A}}\n    \\exp\n    \\left(\n    \\frac{1}{\\alpha}\\,\n    {\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\n    \\right)\\,\n    p({\\bm{a}}\\mid{\\bm{s}})\\,{\\textnormal{d}}{\\bm{a}}\n    \\quad\\text{as}\\quad\n    \\int_{\\mathcal{A}}q({\\bm{a}}\\mid{\\bm{s}})\\,{\\textnormal{d}}{\\bm{a}}= 1.\n\\intertext{To obtain the more convenient lower bound of the soft Bellman equation, we combine importance sampling and Jensen's inequality to the soft Bellman equation}\n    {\\mathcal{V}}({\\bm{s}}) &=\n    \\alpha\n    \\log \\int_{\\mathcal{A}}\n    \\exp\n    \\left(\n    \\frac{1}{\\alpha}\\,\n    {\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\n    \\right)\\,\n    \\frac{p({\\bm{a}}\\mid{\\bm{s}})}{q({\\bm{a}}\\mid{\\bm{s}})}\\,\n    q({\\bm{a}}\\mid{\\bm{s}})\\,\n    {\\textnormal{d}}{\\bm{a}},\\\\\n    &\\geq \n    \\mathbb{E}_{{\\bm{a}}\\sim q(\\cdot\\mid{\\bm{s}})}\n    \\left[\n    {\\mathcal{Q}}({\\bm{s}},{\\bm{a}})\n    -\n    \\alpha\n    \\log\n    \\frac{q({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n    \\right].\n\\end{aligned}")
('18.0', '\\lambda_3')
('18.0', '\\alpha')
('18.0', '\\begin{aligned}\n    \\textstyle\\min_q\n    \\mathbb{E}_{{\\bm{s}}\\sim\\nu_q(\\cdot)}\n    [\\mathbb{D}_{\\textsc{kl}}[q({\\bm{a}}\\mid{\\bm{s}})\\mid\\mid p({\\bm{a}}\\mid{\\bm{s}})]]\n    \\quad\n    \\text{s.t.}\n    \\quad\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim\\rho_q}[\n    {\\bm{\\phi}}({\\bm{s}},{\\bm{a}})]\n    =\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim {\\mathcal{D}}}[\n    {\\bm{\\phi}}({\\bm{s}},{\\bm{a}})].\n\\end{aligned}')
('18.0', "\\begin{aligned}\n    {\\mathcal{L}}(d, \\lambda_1, \\lambda_2, \\bm{\\lambda_3})\n    &=\n    \\int_{\\mathcal{S}}\\nu({\\bm{s}})\n    \\int q({\\bm{a}}\\mid{\\bm{s}})\n    \\log\\frac{q({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n    \\,{\\textnormal{d}}{\\bm{a}}\n    \\,{\\textnormal{d}}{\\bm{s}}\n    +\n    \\lambda_1\n    \\left(\n    1 - \n    \\int_{{\\mathcal{S}}\\times{\\mathcal{A}}}\n    d({\\bm{s}},{\\bm{a}})\n    \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}\n    \\right)\\\\\n    &+\n    \\int_{{\\mathcal{S}}}\n    \\lambda_2({\\bm{s}}')\n    \\left(\n    \\int_{{\\mathcal{S}}\\times{\\mathcal{A}}}\n    \\gamma\\, {\\mathcal{P}}({\\bm{s}}'\\mid{\\bm{s}},{\\bm{a}})\\,\n    d({\\bm{s}},{\\bm{a}})\n    \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}\n    +\n    (1-\\gamma)\\mu_0({\\bm{s}}')\n    -\n    \\int_{{\\mathcal{A}}}\n    d({\\bm{s}}',{\\bm{a}}')\\,{\\textnormal{d}}{\\bm{a}}'\n    \\right)\\,{\\textnormal{d}}{\\bm{s}}'\n    \\\\\n    &+\n    \\bm{\\lambda_3}^\\top\n    \\left(\n    (1-\\gamma)^{-1}\\int_{{\\mathcal{S}}\\times{\\mathcal{A}}}\n    d({\\bm{s}},{\\bm{a}})\\,\n    {\\bm{\\phi}}({\\bm{s}},{\\bm{a}})\n    \\,{\\textnormal{d}}{\\bm{s}}\\,{\\textnormal{d}}{\\bm{a}}\n    -\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\n    [\n    {\\bm{\\phi}}({\\bm{s}}_t,{\\bm{a}}_t)]\n    \\right)\n    .\n\\end{aligned}")
('18.0', 'r({\\bm{s}},{\\bm{a}}) = (1-\\gamma)^{-1}\\bm{\\lambda_3}^\\top{\\bm{\\phi}}({\\bm{s}},{\\bm{a}})')
('18.1', "\\begin{aligned}\n\\underbrace{\n\\alpha\\log \\frac{q_\\alpha({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})} + {\\mathcal{V}}_\\alpha({\\bm{s}})\n}_{{\\mathcal{Q}}({\\bm{s}},{\\bm{a}})}\n=\n\\hspace{25em}\\\\\n\\hspace{0em}\nr({\\bm{s}}, {\\bm{a}}) +\n\\gamma\\,\n\\mathbb{E}_{{\\bm{s}}'\\sim {\\mathcal{P}}(\\cdot\\mid{\\bm{s}},{\\bm{a}}),\\,{\\bm{a}}'\\sim q_\\alpha(\\cdot\\mid{\\bm{s}}')}\n\\left[\n\\underbrace{\n\\cancel{\\alpha\\log \\frac{q_\\alpha({\\bm{a}}'\\mid{\\bm{s}}')}{p({\\bm{a}}'\\mid{\\bm{s}}')}}\n+\n{\\mathcal{V}}_\\alpha({\\bm{s}}')\n}_{{\\mathcal{Q}}({\\bm{s}}',{\\bm{a}}')}\n-\n\\cancel{\\alpha\\log \\frac{q_\\alpha({\\bm{a}}'\\mid{\\bm{s}}')}{p({\\bm{a}}'\\mid{\\bm{s}}')}}\n\\right].\n\\end{aligned}")
('18.2', 'q_{\\bm{\\theta}}({\\bm{a}}|{\\bm{s}})')
('18.2', '\\tilde{r}({\\bm{s}},{\\bm{a}}) = \\alpha(\\log q({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}}))')
('18.2', '\\alpha')
('18.2', 'q({\\bm{a}}\\mid{\\bm{s}})')
('18.2', '{r_{\\alpha,\\,\\pi}({\\bm{s}},{\\bm{a}}) = r({\\bm{s}},{\\bm{a}}) - \\alpha (\\log \\pi({\\bm{a}}\\mid{\\bm{s}}) - \\log p({\\bm{a}}\\mid{\\bm{s}})}')
('18.2', 'r')
('18.2', '\\tilde{r}')
('18.2', '\\pi = q')
('18.2', '\\tilde{r}_{\\alpha,\\,q}({\\bm{s}},{\\bm{a}}) = 0\\,\\forall {\\bm{s}}\\in{\\mathcal{S}}, \\,{\\bm{a}}\\in{\\mathcal{A}}')
('18.2', 'q({\\bm{a}}\\mid{\\bm{s}})')
('18.2', '{\\bm{w}}\\sim p(\\cdot)')
('18.2', '{\\bm{w}}{\\,\\in\\,}{\\mathcal{W}}')
('18.2', '{p({\\bm{y}}\\mid{\\bm{x}},{\\bm{w}})}')
('18.2', 'f')
('18.2', '{\\bm{X}}\\in{\\mathcal{X}}^L, L\\in{\\mathbb{Z}}_+.')
('18.2', 'f')
('18.2', '\\begin{aligned}\n{\\mathbb{D}}_f[q({\\bm{w}}) \\mid\\mid p({\\bm{w}})]\n=\n{\\mathbb{D}}_f[q({\\bm{Y}},{\\bm{w}}\\mid{\\bm{X}}) \\mid\\mid p({\\bm{Y}},{\\bm{w}}\\mid{\\bm{X}})]\n&\\geq\n{\\mathbb{D}}_f[q({\\bm{Y}}\\mid{\\bm{X}}) \\mid\\mid p({\\bm{Y}}\\mid{\\bm{X}})].\n\\end{aligned}')
('18.2', '\\begin{aligned}\n    {\\mathcal{J}}(r, \\pi, \\beta)\n    &=\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\n    r({\\bm{s}},{\\bm{a}})\n    \\right] -\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim \\rho_\\pi}\\left[r({\\bm{s}},{\\bm{a}})\n    -\n    \\beta\\log\\frac{\\pi({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\right].\n\\intertext{Substituting the coherent reward from Theorem \\ref{th:invert}, the objective becomes}\n    {\\mathcal{J}}({\\bm{\\theta}}, \\pi, \\beta) &=\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\alpha\\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\right] -\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim \\rho_\\pi}\\left[\\alpha\n    \\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\n    -\\beta\n    \\log\\frac{\\pi({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\right].\n\\end{aligned}')
('18.2', '\\pi_{{\\bm{\\theta}}_*}')
('18.2', '{\\bm{\\theta}}_* = \\mathop{\\mathrm{arg\\,max}}_{\\bm{\\theta}}\\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[\\log q_{\\bm{\\theta}}({\\bm{s}},{\\bm{a}})]')
('18.2', '\\pi')
('18.2', 'q_{\\bm{\\theta}}')
('18.2', '\\tilde{{\\mathcal{J}}}')
('18.2', '{\\bm{\\theta}}')
('18.2', '{\\mathcal{J}}')
('18.2', '\\beta=\\alpha')
('18.2', '\\pi=q_{\\bm{\\theta}}')
('18.2', '\\tilde{{\\mathcal{J}}}')
('18.2', '\\beta = \\alpha - \\delta\\alpha')
('18.2', '\\delta\\alpha \\geq 0')
('18.2', '\\begin{aligned}\n    \\tilde{{\\mathcal{J}}}({\\bm{\\theta}})\n    &=\n    {\\mathcal{J}}({\\bm{\\theta}}, q_{\\bm{\\theta}}, \\alpha - \\delta\\alpha)\n    =\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\alpha\\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{\n    p({\\bm{a}}\\mid{\\bm{s}})}\\right] -\n    \\mathbb{E}_{{\\bm{a}}\\sim q_{{\\bm{\\theta}}}(\\cdot\\mid{\\bm{s}}),\\,{\\bm{s}}\\sim \\mu_{q_{\\bm{\\theta}}}}\\left[\n    \\delta\\alpha\\,\\log\\frac{q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})}{p({\\bm{a}}\\mid{\\bm{s}})}\\right],\n\\intertext{\nThe right-hand term contains a conditional \\textsc{kl} divergence, which we can replace with an upper-bound using the data processing inequality from Lemma \\ref{lem:dpi} and the weight-space \\textsc{kl}.\nThis weight-space \\textsc{kl} is constant w.r.t. the state distribution expectation and we introduce the scale factor $\\lambda = \\delta\\alpha/\\alpha$.\nThe resulting lower-bound objective is proportional to the regularized behavioral cloning objective proposed in Equation \\ref{eq:regression},\n}\n    \\tilde{{\\mathcal{J}}}({\\bm{\\theta}})\n    &\\geq\n    \\alpha(\n    \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}\\left[\\log q_{\\bm{\\theta}}({\\bm{a}}\\mid{\\bm{s}})\\right] -\n    \\lambda\\,\\mathbb{D}_{\\textsc{kl}}[q_{\\bm{\\theta}}({\\bm{w}})\\mid\\mid p({\\bm{w}})] + C),\n    \\quad\n    C = \\mathbb{E}_{{\\bm{s}},{\\bm{a}}\\sim{\\mathcal{D}}}[-\\log p({\\bm{a}}\\mid{\\bm{s}})].\n\\end{aligned}')
('19', '{\\mathbb{H}}(\\pi)')
('19', '-d_a')
('19', 'd_a')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '{\\mathbb{H}}(\\pi)')
('19', '\\alpha')
('19', '[1.0, 0.3, 0.1, 0.03, 0.01]')
('19', '[0.1, 0.01]')
('19', '0.01')
('19', '0.1')
('19', '[-1, 0]')
('19', '\\pi')
('19', 'Q')
('19', '\\lambda')
('19', 'n')
('19', 'n')
('19', '\\pi')
('19', '\\lambda')
('19', '\\pi')
('19', 'n')
('19', 'Q')
('19', '\\lambda')
('19', 'Q')
('20.0', 'n')
('20.0', 'n')
('20.0', 'n')
('20.0', 'n')
('20.1', '5000')
('20.1', 'n')
('20.1', 'n')
('20.1', 'n')
('20.1', 'Q')
('20.2', 'n')
('20.2', 'n')
('21.0', 'n')
('21.1', 'n')
('21.1', 'n')
('21.2', 'n')
('21.3', 'n')
('21.3', 'n')
('21.3', 'n')
('21.3', 'n')
('21.9', 'n')
('21.9', 'n')
('21.9', 'n')
('21.9', 'n')
