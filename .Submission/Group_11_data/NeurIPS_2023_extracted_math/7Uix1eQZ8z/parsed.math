('1', '\\lambda')
('1', '\\lr')
('1', '\\lr')
('1', '\\lr')
('1', '\\lr')
('2.0', 'T')
('2.0', 'T')
('2.0', 'T = (\\mathcal S, \\mathcal A, p, r, \\gamma, \\mu_0)')
('2.0', '\\mathcal S')
('2.0', '\\mathcal A')
('2.0', 'p: \\mathcal S \\times \\mathcal A \\mapsto \\mathcal P(\\mathcal S)')
('2.0', '\\mathcal P(\\mathcal S)')
('2.0', '\\mathcal S')
('2.0', 'r: \\mathcal S \\mapsto \\reals')
('2.0', '\\gamma \\in [0, 1)')
('2.0', '\\mu_0 \\in \\mathcal P(\\mathcal S)')
('2.0', '(s, a)')
('2.0', "(s, a, s')")
('2.0', '(s,a)')
('2.0', "(s,a,s')")
('2.0', '\\sum_t \\gamma^t r(s_t)')
('2.0', 'r(s_t) \\triangleq r_t')
('2.0', '\\mathbf r \\in \\reals^{|\\mathcal S|}')
('2.0', '\\pi: \\mathcal S \\mapsto \\mathcal P(\\mathcal A)')
('2.0', '\\pi')
('2.0', '|\\mathcal S| \\times |\\mathcal S|')
('2.0', 'P^\\pi')
('2.0', "P^\\pi_{s, s'} = p^\\pi(s'|s) \\triangleq \\sum_a p(s'|s, a)\\pi(a|s)")
('2.0', '\\pi')
('2.0', 'r')
('2.0', 'a')
('2.0', 's')
('2.0', "\\begin{aligned}\n \\label{eq:q_values}\n       Q^\\pi_r(s, a) &= \\expect[\\pi]{\\sum_{k=0}^\\infty \\gamma^k r_{t+k} \\Big\\vert s_t = s, a_t = a} = \\expect[s'\\sim p^\\pi(\\cdot|s)]{r_t + \\gamma Q^\\pi_r(s', \\pi(s'))}. \n   \n\\end{aligned}")
('2.0', 'Q^\\pi_r')
('2.0', 'Q')
('2.0', '\\pi')
('2.0', '\\expect[\\pi]{\\cdot}')
('2.0', '\\expect[\\pi]{\\cdot \\vert s_t = s, a_t = a}')
('2.0', '\\expect[\\pi]{\\cdot \\vert s_t, a_t}')
('2.0', 'Q^\\pi_r')
('2.0', '\\mathcal T^\\pi Q \\triangleq r + \\gamma P^\\pi Q')
('2.0', 'Q^\\pi')
('2.0', '|\\mathcal S| \\times |\\mathcal A|')
('2.0', 'Q')
('2.0', "\\pi'")
('2.0', "Q_r^\\pi(s, a) \\geq Q_r^{\\pi'}(s, a), \\ \\forall (s, a) \\in Q_r^\\pi(s,a)")
('2.0', "\\pi'(s) \\in \\argmax_a Q^\\pi_r(s, a)")
('2.0.0', '\\begin{aligned}\n  V^\\pi(s) = \\E_{\\pi}\\left[\\sum_{k\\geq 0} \\gamma^k r_{t+k} \\Bigg\\vert s_t \\right] = \\vec r\\tr \\underbrace{\\E_{\\pi}\\left[\\sum_{k\\geq 0} \\gamma^k \\vec 1(s_{t+k}) \\Bigg\\vert s_t \\right]}_{\\triangleq M^\\pi(s)},\n\\end{aligned}')
('2.0.0', '\\vec 1(s_t)')
('2.0.0', 's_t')
('2.0.0', 'M^\\pi')
('2.0.0', '|\\St|\\times|\\St|')
('2.0.0', "\\begin{aligned}\n  M^\\pi(s,s') \\triangleq \\E_\\pi\\left[\\sum_{k\\geq 0} \\gamma^k \\mathbbm 1(s_{t+k}=s') \\Bigg\\vert s_t \\right] = \\E_\\pi\\left[\\mathbbm 1(s_{t} = s') + \\gamma M^\\pi(s_{t+1}, s') \\Bigg\\vert s_t \\right].\n\\end{aligned}")
('2.0.0', 'p')
('2.0.0', '\\vec r')
('2.0.0', "M^\\pi(s, a, s')")
('2.0.0', '\\vec r')
('2.0.0', 'Q')
('2.0.0', '\\pi')
('2.0.0', "\\begin{aligned}\n\\begin{split}\n  F^\\pi(s, s') &\\triangleq \\E_\\pi\\left[\\sum_{k\\geq 0} \\gamma^k \\mathbbm 1(s_{t+k}=s', s' \\notin \\{s_t,\\dots,s_{t+k-1}\\}) \\Bigg\\vert s_t \\right]. % \\\\ &= \\E_\\pi\\left[\\mathbbm 1(s_{t} = s') + \\gamma (1 - \\mathbbm 1(s_t = s'))F^\\pi(s_{t+1}, s') \\Bigg\\vert s_t\\right].\n\\end{split}\n\\end{aligned}")
('2.0.0.0', '\\Pi = \\{\\pi\\}')
('2.0.0.0', '\\vec r')
('2.0.0.0', '\\{Q^\\pi(s,a) = \\vec r\\tr M^\\pi(s,a, \\cdot)')
('2.0.0.0', "\\pi'")
('2.0.0.0', "Q^{\\pi'}(s,a) \\geq \\sup_{\\pi\\in\\Pi} Q^\\pi(s,a)")
('2.0.0.0', '\\forall s,a\\in\\St\\times\\A')
('2.0.0.0', '\\Pi')
('2.0.0.0', '\\Pi')
('2.0.0.0', "\\begin{aligned}\n  \\pi'(s) \\in \\argmax_{a\\in\\A} \\max_{\\pi \\in \\Pi} \\vec r\\tr M^\\pi(s,a,\\cdot).\n\\end{aligned}")
('3.0', '\\begin{aligned}\n \\label{eq:diminishing_returns}\n  r_\\lambda(s, t) = \\lambda(s)^{n(s, t)} \\bar r(s), \\quad \\lambda(s) \\in [0, 1],\n\\end{aligned}')
('3.0', 'n(s, t) \\in \\mathbb N')
('3.0', 's')
('3.0', 't')
('3.0', '\\bar r(s)')
('3.0', 's')
('3.0', '\\lambda(s)')
('3.0', 's')
('3.0', '\\lambda(s) = \\lambda = 1')
('3.0', '\\bar r')
('3.0.0', '\\lambda')
('3.0.0', '\\lr')
('3.0.0', '\\lr')
('4.0', '\\lr')
('4.0', '\\lambda')
('4.0', '\\lambda')
('4.0', '\\begin{aligned}\n  V^\\pi(s) &= \\E \\left[ \\sum_{k=0}^\\infty \\gamma^k r_\\lambda(s_{t+k}, k) \\big\\vert s_t = s\\right]   \n  = \\bar{\\vec{r}}\\tr \\underbrace{\\E \\left[ \\sum_{k=0}^\\infty \\gamma^k \\lambda^{n_t(s_{t+k}, k)} \\vec 1(s_{t+k}) \\big\\vert s_t = s\\right]}_{\\triangleq \\Phi^\\pi_\\lambda(s)},\n\\end{aligned}')
('4.0', '\\Phi^\\pi_\\lambda(s)')
('4.0', '\\lambda')
('4.0', '\\lr')
('4.0', 'n_t(s, k) \\triangleq \\sum_{j=0}^{k-1} \\mathbbm 1(s_{t+j} = s)')
('4.0', 's')
('4.0', 't')
('4.0', 't+k')
('4.0', '\\lr')
('4.0', '\\St')
('4.0', '\\vec\\lambda\\in[0, 1]^{|\\St|}')
('4.0', '\\lambda')
('4.0', '\\Phi_{\\lambda}^\\pi')
('4.0', "\\begin{aligned}\n    \\Phi_{\\lambda}^\\pi(s, s') &\\triangleq \\E \\left[ \\sum_{k=0}^\\infty \\lambda(s')^{n_t(s', k)}\\gamma^k  \\mathbbm 1(s_{t+k}=s') \\big\\vert s_t = s\\right]\n  \n\\end{aligned}")
('4.0', 'n_t(s, k) \\triangleq \\sum_{j=0}^{k-1} \\mathbbm 1(s_{t+j} = s)')
('4.0', 's')
('4.0', 't')
('4.0', 't+k-1')
('4.0', '\\lambda = 0')
('4.0', '\\lr')
('4.0', '0^0 = 1')
('4.0', '\\lambda = 1')
('4.0', '\\lambda \\in (0, 1)')
('4.0', '\\lr')
('4.0', '\\lambda')
('4.0', '\\lambda')
('4.0', '\\lr')
('4.0', "\\begin{aligned}\n \\label{eq:lr_recursion}\n\\begin{split}\n  \\Phi_{\\lambda}^\\pi(s, s') &= \\E \\left[ \\sum_{k=0}^\\infty \\lambda^{n_t(s', k)}\\gamma^k  \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t = s \\right] \n  \\\\\n  &\\stackrel{(i)}{=} \\E \\left[\\mathbbm 1(s_{t}=s') + \\lambda^{n_t(s', 1)} \\gamma \\sum_{k=1}^\\infty \\lambda^{n_{t+1}(s', k)}\\gamma^{k-1}  \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t = s \\right]\n  \\\\\n  &= \\mathbbm 1(s_t = s')(1 + \\gamma \\lambda \\E_{s_{t+1}\\sim p^\\pi} \\Phi_{\\lambda}^\\pi(s_{t+1}, s')) + \\gamma (1 - \\mathbbm 1(s_t = s'))\\E_{s_{t+1}\\sim p^\\pi} \\Phi_{\\lambda}^\\pi(s_{t+1}, s'),\n\\end{split}\n\\end{aligned}")
('4.0', '(i)')
('4.0', "n_t(s', k) = n_t(s', 1) + n_{t+1}(s', k-1)")
('4.0', '\\lr')
('4.0', '\\Phi\\in\\reals^{|\\St|\\times|\\St|}')
('4.0', '\\mathcal G_{\\lambda}^\\pi')
('4.0', '\\lr')
('4.0', '\\pi')
('4.0', '\\begin{aligned}\n    \\mathcal G_{\\lambda}^\\pi \\Phi \\triangleq I\\odot\\left(\\vec 1 \\vec 1\\tr + \\gamma \\lambda P^\\pi \\Phi\\right) + \\gamma (\\vec 1 \\vec 1\\tr  - I) \\odot P^\\pi \\Phi,\n  \n\\end{aligned}')
('4.0', '\\odot')
('4.0', 'I')
('4.0', '|\\St|\\times|\\St|')
('4.0', '\\pi')
('4.0', '\\mathcal G_{\\lambda}^\\pi \\Phi_{\\lambda}^\\pi = \\Phi_\\lambda^\\pi')
('4.0', '\\mathcal G_\\lambda^\\pi')
('4.0', '\\lr')
('4.0', '\\Phi^{(0)} = (1 - \\lambda)I')
('4.0', 'k=1,2,\\dots')
('4.0', '\\Phi^{(k+1)} = \\mathcal G_\\lambda^\\pi \\Phi^{(k)}')
('4.0', "\\begin{aligned}\n    |(\\Phi^{(k)} - \\Phi^\\pi_\\lambda)_{s,s'}| \\leq \\frac{\\gamma^{k+1}}{1 - \\lambda \\gamma}.\n  \n\\end{aligned}")
('4.0', '\\lr')
('4.0', '\\lr')
('4.0', '\\lambda')
('4.0', '\\lambda=0')
('4.0', '\\lambda')
('4.0', '\\lr')
('4.0', '\\lr')
('4.0', '\\lambda \\in \\{0.0, 0.5, 1.0\\}')
('4.1.0', '\\phi: \\St \\mapsto \\reals^D')
('4.1.0', '\\phi')
('4.1.0', '|\\St|')
('4.1.0', '\\phi: \\St \\mapsto \\reals^D')
('4.1.0', '\\varphi_1: \\mathcal S \\times \\A \\mapsto \\reals^D')
('4.1.0', '\\varphi_1^\\pi(s,a) \\triangleq \\E_\\pi\\left[\\sum_{k = 0}^\\infty \\gamma^k\\phi(s_{t+k}) \\Big\\vert s_t, a_t\\right]')
('4.1.0', 's,a \\in \\St \\times \\A')
('4.1.0', '\\lambda')
('4.1.0', '\\lambda')
('4.1.0', '\\lambda\\in[0, 1]')
('4.1.0', '\\phi: \\St \\mapsto [0, 1]^D')
('4.1.0', '\\lambda')
('4.1.0', '\\lambda')
('4.1.0', 's')
('4.1.0', '\\varphi^\\pi_\\lambda')
('4.1.0', "\\begin{aligned}\n    \\varphi_{\\lambda}^\\pi(s) &\\triangleq \\phi(s) \\odot (1 + \\gamma \\lambda \\E_{s'\\sim p^\\pi(\\cdot\\mid s)} \\varphi_{\\lambda}^\\pi(s')) + \\gamma (1 - \\phi(s))\\odot \\E_{s'\\sim p^\\pi(\\cdot\\mid s)} \\varphi_{\\lambda}^\\pi(s').\n  \n\\end{aligned}")
('4.1.0', '\\phi')
('4.1.0', '\\mathcal R')
('4.1.0', '\\begin{aligned}\n  \\mathcal R = \\{r \\mid \\exists \\vec w \\in \\reals^D \\ \\text{s.t.} \\ r(s,a) = \\vec w\\tr \\vec\\phi(s,a) \\ \\forall s,a \\in \\St \\times \\A \\}.\n\\end{aligned}')
('4.1.0', 'r \\in \\mathcal R')
('4.1.0.0', '\\mathcal R')
('4.1.0.0', '\\St')
('4.1.0.0', '\\begin{aligned}\n  M^\\pi(s, a, X) &\\triangleq \\sum_{k=0}^\\infty \\gamma^k \\pr(s_{t+k}\\in X \\mid s_t=s, a_t=a, \\pi) \\quad \\forall X \\subset \\St \\text{ measurable},\n\\end{aligned}')
('4.1.0.0', 'M^\\pi = I + \\gamma P^\\pi M^\\pi')
('4.1.0.0', "\\varphi_1^\\pi(s,a) = \\int_{s'} M^\\pi(s, a, ds') \\phi(s').")
('4.1.0.0', '\\lr')
('4.1.0.0', '\\begin{aligned}\n  \\Phi_\\lambda^\\pi(s, X) &\\triangleq \\sum_{k=0}^\\infty \\lambda^{n_t(X, k)}\\gamma^k \\pr(s_{t+k}\\in X \\mid s_t=s, \\pi ) \\label{eq:lambda-meas}\n  % &= I \\odot (\\vec 1 \\vec 1\\tr + \\lambda\\gamma P^\\pi \\Phi_\\lambda^\\pi) + \\gamma(\\vec 1 \\vec 1\\tr - I) \\odot P^\\pi \\Phi_\\lambda^\\pi,\n\\end{aligned}')
('4.1.0.0', 'n_t(X, k) \\triangleq \\sum_{j=0}^{k-1} \\delta_{s_{t+j}}(X)')
('4.1.0.0', '\\lambda < 1')
('4.1.0.0', 'A,B\\subseteq\\St')
('4.1.0.0', '\\Phi_\\lambda^\\pi(s,A \\cup B) < \\Phi_\\lambda^\\pi(s,A) + \\Phi_\\lambda^\\pi(s,B)')
('4.1.0.0', '\\lambda')
('4.1.0.0', '\\lambda')
('4.1.0.0', '\\Phi_\\lambda^\\pi')
('4.1.0.0', "\\begin{aligned}\n\\begin{split}\\label{eq:lo_loss}\n  \\mathcal L(\\Phi) &= \\E_{s_t,s_{t+1}\\sim\\rho,s'\\sim\\mu}\\left[  \\left(\\varphi(s_t, s') - \\gamma\\bar \\varphi(s_{t+1}, s') \\right)^2\\right] - 2\\E_{s_t\\sim\\rho} [\\varphi(s_t, s_t)] \\\\\n  &\\qquad\\qquad\\qquad\\qquad\n  + 2\\gamma (1 - \\lambda)\\E_{s_t,s_{t+1}\\sim\\rho}[\\mu(s_t)\\varphi(s_t, s_t)\\bar \\varphi(s_{t+1}, s_t)],\n\\end{split}\n\\end{aligned}")
('4.1.0.0', '\\rho')
('4.1.0.0', '\\mu')
('4.1.0.0', '\\St')
('4.1.0.0', '\\Phi_\\lambda^\\pi(s) \\triangleq \\varphi_\\lambda^\\pi(s)\\mathrm{diag}(\\mu)')
('4.1.0.0', '\\varphi_\\lambda^\\pi')
('4.1.0.0', '\\bar{\\cdot}')
('4.1.0.0', '\\rho')
('4.1.0.0', '\\mu')
('4.1.0.0', '\\lambda=1')
('5', '\\lr')
('5', '\\lr')
('5', '\\lambda')
('5', '\\lambda')
('5', '\\lambda')
('5.0', '\\lr')
('5.0', '\\lambda')
('5.0', '\\lr')
('5.0', '\\lambda=\\lambda_{true}')
('5.0', '\\lr')
('5.0', 'g')
('5.0', '\\lambda_{true} = 0.5')
('5.0', '\\lambda')
('5.0', '\\lambda')
('5.0', 'Q')
('5.0', '\\lr')
('5.0', '\\lambda \\in \\{0.5, 1.0\\}')
('5.0', '\\lambda=1')
('5.0', 'Q')
('5.0', '\\lr')
('5.0', '\\lambda = \\lambda_{true}')
('5.1', '\\lr')
('5.1', 'Q')
('5.1', '\\lr')
('5.1', 'Q')
('5.1', 'Q_\\lambda')
('5.1', '(s_{t},a_t, s_{t+1})')
('5.1', '\\begin{aligned}\n    \\mathcal T^\\star_\\lambda \\Phi \\triangleq \\vec 1(s_t) \\odot (1 + \\lambda \\gamma \\Phi(s_{t+1}, a_{t+1})) + \\gamma(1 - \\vec 1(s_t)) \\odot \\Phi(s_{t+1}, a_{t+1}), %\\quad a_{t+1} = \\argmax_{a} \\vec r\\tr \\Phi(s_t, a_t)\n\\end{aligned}')
('5.1', 'a_{t+1} = \\argmax_{a} Q_{\\lambda}(s_t, a) = \\argmax_{a} \\vec r\\tr \\Phi(s_t, a)')
('5.1', 'Q_\\lambda')
('5.1', 'Q_\\lambda')
('5.1', 'Q')
('5.1', '\\lambda = 1')
('5.1', '\\lambda')
('5.1', '\\lr')
('5.1', '\\begin{aligned}\n    \\mathcal T_\\lambda V(s_t) = r(s_t) + \\gamma (V(s_{t+1}) + (\\lambda - 1)\\vec w\\tr (\\phi(s_t) \\odot \\varphi_\\lambda(s_{t+1}))),\n\\end{aligned}')
('5.1', '\\phi')
('5.1', '\\lambda')
('5.2', '\\lr')
('5.2', '\\bar r')
('5.2', '\\lambda')
('5.2', '\\{M_j\\}_{j=1}^n \\subseteq \\mathcal{M}')
('5.2', 'M\\in\\mathcal{M}')
('5.2', '\\mathcal{M}')
('5.2', 'Q^{\\pi_j^*}')
('5.2', 'M_j')
('5.2', 'M')
('5.2', '\\hat{\\lambda}')
('5.2', '\\lambda')
('5.2', '\\tilde{Q}^{\\pi_j}')
('5.2', '\\|Q^{\\pi_j^*}-\\tilde{Q}^{\\pi_j}\\|_\\infty\\leq\\epsilon')
('5.2', 'j')
('5.2', '\\pi(s) \\in \\argmax_a \\max_j \\tilde{Q}^{\\pi_j}(s,a).')
('5.2', 'Q^\\pi(s,a) \\geq \\max_j Q^{\\pi_j^*}(s,a) - \\frac{1}{1-\\gamma}\\left(2\\epsilon + |\\lambda-\\hat{\\lambda}|\\|r\\|_\\infty + \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}\\right).')
('5.2', '\\lambda=1')
('5.2', '\\lambda < 1')
('5.2.0', '\\{\\pi_0, \\pi_1, \\pi_2, \\pi_3\\}')
('5.2.0', '\\{g_0, g_1, g_2\\}')
('5.2.0', '\\lambda = 0.5')
('5.2.0', 's_0')
('5.2.0', '0.1')
('5.2.0', 'H = 40')
('5.2.0', '\\lambda=1')
('5.2.0', '\\lr')
('5.2.0', '\\lambda\\in \\{0.0, 0.5, 1.0\\}')
('5.2.0', '\\lr')
('5.2.0', '\\lambda')
('5.2.0', '\\lambda')
('5.2.0', '\\lambda')
('5.2.0', '\\lr')
('5.2.0', '\\lambda\\in\\{0.0, 0.5, 1.0\\}')
('5.2.0', '\\lambda')
('5.2.0', '\\lambda')
('5.2.0.0', '128 \\times 128')
('5.2.0.0', 'H=50')
('5.2.0.0', '\\lambda')
('5.2.0.0', '\\lambda \\in \\{0.0, 0.5, 1.0\\}')
('5.2.0.0', '\\lambda')
('5.2.0.0', '[0, 1]')
('5.2.0.0', '\\lambda=0.5')
('5.2.0.0', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', "\\Phi_\\lambda^{\\pi_z}(s, a, s') = F(s, a, z)^\\top B(s') \\mu(s')")
('6', '\\pi_z(s) = \\argmax_a F(s,a,z)^\\top z')
('6', '\\mu')
('6', '\\St')
('6', 'r:\\St\\rightarrow\\mathbb{R}')
('6', '\\argmax_a F(s,a,z_R)^\\top z_R')
('6', 'z_R = \\mathbb{E}_{s\\sim\\mu}[r(s)B(s)]')
('6', 'z_R')
('6', '\\lambda')
('6', '\\begin{aligned}\n    \\mathcal{L}(\\lambda) = \\mathbb{E}_{s_t, s_{t+1}\\sim\\rho} \\left[ \\mathbbm 1(s_t=s_{t+1})\\left(r(s_{t+1}) - \\lambda r(s_t)\\right)^2 \\right],\n\\end{aligned}')
('6', '\\lambda')
('6', '\\rho')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lr')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda')
('6', '\\lambda=1')
('6', '\\lambda=0.1')
('7.0', '\\lr')
('7.0', '\\lambda')
('7.0', '\\lambda')
('7.0', '\\lr')
('7.0', '\\lr')
('7.0', '\\lr')
('7.0', '\\lambda')
('7.0', '\\lr')
('8', '\\lr')
('8', "\\begin{aligned}\n\\begin{split} %\\label{eq:lr_recursion}\n  \\Phi_{\\lambda}^\\pi(s, s') &= \\E \\left[ \\sum_{k=0}^\\infty \\lambda^{n_t(s', k)}\\gamma^k  \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t = s \\right] \n  \\\\\n  &= \\E \\left[\\mathbbm 1(s_{t}=s') + \\sum_{k=1}^\\infty \\lambda^{n_t(s', k)} \\gamma^k \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t = s \\right] \n  \\\\\n  &\\stackrel{(i)}{=} \\E \\left[\\mathbbm 1(s_{t}=s') + \\lambda^{n_t(s', 1)} \\gamma \\sum_{k=1}^\\infty \\lambda^{n_{t+1}(s', k)}\\gamma^{k-1}  \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t = s \\right]\n  \\\\\n  &\\stackrel{(ii)}{=} \\E \\Bigg[\\mathbbm 1(s_{t}=s') + \\mathbbm 1(s_t = s') \\lambda \\gamma \\sum_{k=1}^\\infty \\lambda^{n_{t+1}(s', k)}\\gamma^{k-1}  \\mathbbm 1(s_{t+k}=s') \\\\ &\\qquad + \\gamma(1 - \\mathbbm 1(s_t = s'))\\sum_{k=1}^\\infty \\lambda^{n_{t+1}(s', k)}\\gamma^{k-1}  \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t = s \\Bigg] \n  \\\\\n  &= \\mathbbm 1(s_t = s') + \\mathbbm 1(s_t = s')\\lambda\\gamma \\E_{s_{t+1}\\sim p^\\pi} \\Phi_{\\lambda}^\\pi(s_{t+1}, s') \\\\ &\\qquad\\qquad\\qquad + \\gamma(1 - \\mathbbm 1(s_t = s'))\\E_{s_{t+1}\\sim p^\\pi} \\Phi_{\\lambda}^\\pi(s_{t+1}, s')\n  \\\\\n  &= \\mathbbm 1(s_t = s')(1 + \\gamma \\lambda \\E_{s_{t+1}\\sim p^\\pi} \\Phi_{\\lambda}^\\pi(s_{t+1}, s')) \\\\ &\\qquad\\qquad\\qquad + \\gamma (1 - \\mathbbm 1(s_t = s'))\\E_{s_{t+1}\\sim p^\\pi} \\Phi_{\\lambda}^\\pi(s_{t+1}, s'),\n\\end{split}\n\\end{aligned}")
('8', '(i)')
('8', "n_t(s', k) = n_t(s', 1) + n_{t+1}(s', k)")
('8', '(ii)')
('8', "\\begin{aligned}\n  \\lambda^{n_t(s', 1)} = \\lambda^{\\mathbbm 1(s_t = s')} = \\mathbbm 1(s_t = s') \\lambda + (1 - \\mathbbm 1(s_t=s')).\n\\end{aligned}")
('9', '\\mathbb{R}^{|\\mathcal{S}|} \\rightarrow \\mathbb{R}^{|\\mathcal{S}|}')
('9', '\\vec{\\bar{r}}')
('9', 'p^\\pi')
('9', '\\gamma')
('9', '\\lambda')
('9', '|\\mathcal{S}|>1')
('9', 'T')
('9', 'V^\\pi')
('9', 'T')
('9', 'V^\\pi')
('9', 'T')
('9', 'TV^\\pi')
('9', 's \\in \\mathcal{S}')
('9', "\\begin{aligned}\n(TV^\\pi)(s) = \\bar r(s) + \\gamma \\mathbb{E}_{s' \\sim p^\\pi(\\cdot|s)} V^\\pi(s') + \\gamma (\\lambda-1) \\bar r(s) \\mathbb{E}_{s' \\sim p^\\pi(\\cdot|s)} \\Phi_\\lambda^\\pi (s',s).\n\\end{aligned}")
('9', 'f')
('9', 's \\in \\mathcal{S}')
('9', "\\begin{aligned}\n\\mathbb{E}_{s' \\sim p^\\pi(\\cdot|s)} \\Phi_\\lambda^\\pi(s',s) = \\mathbb{E}_{p^\\pi(\\cdot|s)} f(\\mathbf{\\bar r}, \\mathbf{V^\\pi}, \\gamma, \\lambda, s).\n\\end{aligned}")
('9', "\\begin{aligned}\nV^\\pi(s) = \\sum_{s' \\in \\mathcal{S}} \\Phi_\\lambda^\\pi(s,s') \\bar r(s').\n\\end{aligned}")
('9', '\\mathbf{\\bar{r}}')
('9', '\\mathbb{R}^{|\\mathcal{S}|}')
('9', '\\mathcal{S}>1')
('9', '\\mathbf{\\bar{r}}^\\bot')
('9', '\\mathbf{\\bar{r}}, \\mathbf{V^\\pi}, s')
('9', '\\mathbf{w} \\in \\mathbf{\\bar{r}}^\\bot \\setminus \\{\\mathbf{0}\\}')
('9', "\\begin{aligned}\n\\tilde{\\Phi}_\\lambda^\\pi(s,s') \\coloneqq \\Phi_\\lambda^\\pi(s,s') + w(s')\n\\end{aligned}")
('9', "s,s' \\in \\mathcal{S}")
('9', "\\begin{aligned}\n\\sum_{s' \\in \\mathcal{S}} \\tilde{\\Phi}_\\lambda^\\pi(s,s') \\bar r(s') = \\sum_{s' \\in \\mathcal{S}} \\Phi_\\lambda^\\pi(s,s') \\bar r(s') + \\sum_{s' \\in \\mathcal{S}} w(s') \\bar r(s') = V^\\pi(s),\n\\end{aligned}")
('9', '\\mathbf{w} \\perp \\mathbf{\\bar{r}}')
('9', "\\begin{aligned}\n\\mathbb{E}_{s' \\sim p^\\pi(\\cdot|s)} \\tilde{\\Phi}_\\lambda^\\pi(s',s) = \\sum_{s' \\in \\mathcal{S}} p^\\pi(s'|s)  \\Phi_\\lambda^\\pi(s',s) + \\sum_{s' \\in \\mathcal{S}} p^\\pi(s'|s) w(s).\n\\end{aligned}")
('9', 'w(s)')
('9', '\\mathbf{w} \\neq \\mathbf{0}')
('9', 's')
('9', 'w(s) \\neq 0')
('9', 's')
('9', '(\\mathbf{\\bar r}, \\mathbf{V^\\pi}, \\gamma, \\lambda, s)')
('9', 'f')
('9', "\\mathbb{E}_{s' \\sim p^\\pi(\\cdot|s)} \\Phi_\\lambda^\\pi(s',s)")
('9', "\\mathbb{E}_{s' \\sim p^\\pi(\\cdot|s)} \\tilde{\\Phi}_\\lambda^\\pi(s',s)")
('9', 'f')
('9', 'f')
('9', '\\mathcal G_{\\lambda}^\\pi')
('9', '\\mathcal G_{\\lambda}^\\pi')
('9', '\\pi')
('9', "\\Phi, \\Phi'\\in \\reals^{|\\St| \\times |\\St|}")
('9', "\\begin{aligned}\n    |\\mathcal G_{\\lambda}^\\pi \\Phi(s, s') - \\mathcal G_{\\lambda}^\\pi \\Phi'(s,s') | \\leq \\gamma |\\Phi(s, s') - \\Phi'(s, s')|.\n  \n\\end{aligned}")
('9', "\\begin{aligned}\n    |(\\mathcal G_\\lambda^\\pi \\Phi - \\mathcal G_\\lambda^\\pi \\Phi')_{s,s'}| &= |(I \\odot (\\vec 1 \\vec 1\\tr + \\gamma \\lambda P^\\pi \\Phi) + \\gamma (\\vec 1 \\vec 1\\tr  - I) \\odot P^\\pi \\Phi \\\\ &\\qquad \\qquad\\qquad\\qquad - I \\odot (\\vec 1 \\vec 1\\tr + \\gamma \\lambda P^\\pi \\Phi') - \\gamma (\\vec 1 \\vec 1\\tr  - I) \\odot P^\\pi \\Phi')_{s,s'}| \\\\\n    &= |(I \\odot \\gamma\\lambda P^\\pi (\\Phi - \\Phi') + \\gamma(\\vec 1\\vec 1\\tr - I) \\odot P^\\pi(\\Phi - \\Phi'))_{s,s'}| \\\\\n    &= |((I \\odot \\lambda \\vec 1\\vec 1\\tr  + \\vec 1 \\vec 1\\tr - I) \\odot \\gamma P^\\pi (\\Phi - \\Phi'))_{s,s'}| \\\\\n  % \\end{align*}\n  % Observe that $I_{|\\St|}(s, s') = \\mathbbm 1(s = s')$. For $s \\neq s'$, then,\n  % \\begin{align*}\n    &\\stackrel{(i)}{\\leq} | (\\gamma P^\\pi (\\Phi - \\Phi'))_{s,s'}| \\\\\n    &= \\gamma | (P^\\pi(\\Phi - \\Phi'))_{s,s'}| \\\\\n    &\\leq \\gamma |(\\Phi - \\Phi')_{s,s'}|,\n  \n\\end{aligned}")
('9', '(i)')
('9', '\\lambda \\leq 1')
('9', '\\lambda\\gamma')
('9', "s=s'")
('9', "\\Phi_\\lambda^\\pi(s,s')")
('9', "\\begin{aligned}\n    \\frac{\\mathbbm 1(s = s') + (1 - \\mathbbm 1(s = s'))\\gamma}{1 - \\lambda \\gamma}.\n  \n\\end{aligned}")
('9', "s = s'")
('9', '\\begin{aligned}\n    \\Phi^\\pi_\\lambda(s, s) = 1 + \\lambda \\gamma \\E_{s_{t+1}\\sim p^\\pi(\\cdot|s_t)}\\Phi_\\lambda^\\pi(s_{t+1},s).\n  \n\\end{aligned}')
('9', '\\lambda \\gamma')
('9', '\\begin{aligned}\n \\label{eq:max_same}\n    \\sum_{k=0}^\\infty (\\lambda\\gamma)^k = \\frac{1}{1 - \\lambda \\gamma}.\n  \n\\end{aligned}')
('9', "s\\neq s'")
('9', "\\mathbbm 1(s_t = s') = 0")
('9', "\\begin{aligned}\n    \\Phi_\\lambda^\\pi(s,s') = \\gamma \\E_{s_{t+1}\\sim p^\\pi(\\cdot|s_t)} \\Phi^\\pi_\\lambda(s_{t+1}, s').\n  \n\\end{aligned}")
('9', "\\Phi_\\lambda^\\pi(s, s) \\geq \\Phi_\\lambda^\\pi(s, s')")
('9', "s' \\neq s")
('9', "s_{t+1} = s'")
('9', "s = s'")
('9', "\\begin{aligned}\n \\label{eq:max_diff}\n    \\Phi_\\lambda^\\pi(s,s') = \\gamma \\left(\\frac{1}{1 - \\lambda \\gamma} \\right).\n  \n\\end{aligned}")
('9', "X_{s,s'} = X(s, s')")
('9', 'X')
('9', "\\begin{aligned}\n  \\begin{split}\n    |(\\Phi^{(k)} - \\Phi^\\pi_\\lambda)_{s,s'}| &= |(\\mathcal G_\\lambda^k \\Phi^{(0)} - \\mathcal G^k_\\lambda \\Phi^\\pi_\\lambda)_{s,s'}|  \\\\\n    &= |(\\mathcal G_\\lambda^k \\Phi^{(0)} - \\Phi^\\pi_\\lambda)_{s,s'}| \\\\\n    &\\stackrel{(i)}{\\leq} \\gamma^k |(\\Phi^{(0)} - \\Phi^\\pi_\\lambda)_{s,s'}| \\\\\n    &\\stackrel{(ii)}{=} \\gamma^k \\Phi^\\pi_\\lambda(s, s') \\\\\n    &\\stackrel{(iii)}{\\leq} \\frac{\\gamma^{k+1}}{1 - \\lambda \\gamma}\n  \\end{split}\n  \n\\end{aligned}")
('9', '(i)')
('9', '(ii)')
('9', "\\Phi^{(0)}(s, s') = 0")
('9', "s\\neq s'")
('9', '(iii)')
('9', 's\\in\\St')
('9', '\\pi')
('9', '\\lambda\\in[0,1)')
('9', 'A,B\\subseteq\\St')
('9', '\\Phi_\\lambda^\\pi(s,A \\cup B) < \\Phi_\\lambda^\\pi(s,A) + \\Phi_\\lambda^\\pi(s,B).')
('9', 'A,B')
('9', 'n_t(A \\cup B,k) = n_t(A,k) + n_t(B,k)')
('9', '\\pi')
('9', 's_t=s')
('9', '\\begin{aligned}\n        \\lambda^{n_t(A \\cup B,k)} \\pr(s_{t+k}\\in A \\cup B) &= \\lambda^{n_t(A,k)}\\lambda^{n_t(B,k)}\\pr(s_{t+k}\\in A) + \\lambda^{n_t(A,k)}\\lambda^{n_t(B,k)}\\pr(s_{t+k}\\in B) \\\\\n        &\\leq \\lambda^{n_t(A,k)}\\pr(s_{t+k}\\in A) + \\lambda^{n_t(B,k)}\\pr(s_{t+k}\\in B),\n    \n\\end{aligned}')
('9', '\\pr(s_{t+k}\\in A \\cup B) = \\pr(s_{t+k}\\in A) + \\pr(s_{t+k}\\in B)')
('9', 'A,B,t,k')
('9', '\\lambda=1')
('9', 'k')
('9.0', "\\Phi_\\lambda(s,a,s') \\leq \\frac{1}{1-\\lambda\\gamma}")
('9.0', "s,a,s'")
('9.0', '\\{M_j\\}_{j=1}^n \\subseteq \\mathcal{M}')
('9.0', 'M\\in\\mathcal{M}')
('9.0', '\\mathcal{M}')
('9.0', '\\lambda')
('9.0', 'Q^{\\pi_j^*}')
('9.0', 'M_j')
('9.0', 'M')
('9.0', '\\tilde{Q}^{\\pi_j}')
('9.0', '\\|Q^{\\pi_j^*}-\\tilde{Q}^{\\pi_j}\\|_\\infty\\leq\\epsilon')
('9.0', 'j')
('9.0', '\\pi(s) \\in \\argmax_a \\max_j \\tilde{Q}^{\\pi_j}(s,a).')
('9.0', 'Q^\\pi(s,a) \\geq \\max_j Q^{\\pi_j^*}(s,a) - \\frac{1}{1-\\gamma}\\left(2\\epsilon + \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}\\right),')
('9.0', 'r')
('9.0', 'M')
('9.0', '\\tilde{Q}_{\\text{max}}(s,a) \\coloneqq \\max_j \\tilde{Q}^{\\pi_j}(s,a)')
('9.0', 'Q_{\\text{max}}(s,a) \\coloneqq \\max_j Q^{\\pi_j^*}(s,a)')
('9.0', 'T^\\nu')
('9.0', '\\nu')
('9.0', 'M')
('9.0', '(s,a)\\in\\St\\times\\A')
('9.0', 'j')
('9.0', "\\begin{aligned}\n        T_i^\\pi \\tilde{Q}_{\\text{max}}(s,a) &= r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^\\pi(s',\\pi(s'),s) + \\tilde{Q}_{\\text{max}}(s',\\pi(s')) \\right) \\\\\n        &= r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^\\pi(s',\\pi(s'),s) + \\max_b\\tilde{Q}_{\\text{max}}(s',b) \\right) \\\\\n        &\\geq r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^\\pi(s',\\pi(s'),s) + \\max_b Q_{\\text{max}}(s',b)\\right) - \\gamma\\epsilon \\\\\n        &\\geq r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^\\pi(s',\\pi(s'),s) + Q_{\\text{max}}(s',\\pi_j^*(s'))\\right) - \\gamma\\epsilon \\\\\n        &\\geq r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^\\pi(s',\\pi(s'),s) + Q_i^{\\pi_j^*}(s',\\pi_j^*(s'))\\right) - \\gamma\\epsilon \\\\\n        &= r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^{\\pi_j^*}(s',\\pi_j^*(s'),s) + Q_i^{\\pi_j^*}(s',\\pi_j^*(s'))\\right) - \\gamma\\epsilon \\\\\n        &+ \\gamma(\\lambda-1)r(s,a)\\sum_{s'}p(s'|s,a)\\left(\\Phi^\\pi(s',\\pi(s'),s) - \\Phi^{\\pi_j^*}(s',\\pi_j^*(s'),s)\\right) \\\\\n        &\\geq T_i^{\\pi_j^*} Q_i^{\\pi_j^*}(s,a) - \\gamma\\epsilon - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma} \\\\\n        &= Q_i^{\\pi_j^*}(s,a) - \\gamma\\epsilon - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}.\n    \n\\end{aligned}")
('9.0', 'j')
('9.0', '\\begin{aligned}\n        T^\\pi \\tilde{Q}_{\\text{max}}(s,a) &\\geq \\max_j Q_i^{\\pi_j^*}(s,a) - \\gamma\\epsilon - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma} \\\\\n        &= Q_{\\text{max}}(s,a) - \\gamma\\epsilon - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma} \\\\\n        &\\geq \\tilde{Q}_{\\text{max}}(s,a) - \\epsilon - \\gamma\\epsilon - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}.\n    \n\\end{aligned}')
('9.0', 'c\\in\\mathbb{R}')
('9.0', "\\begin{aligned}\n        T^\\pi(\\tilde{Q}_{\\text{max}}(s,a) + c) &= T^\\pi\\tilde{Q}_{\\text{max}}(s,a) + \\gamma \\sum_{s'}p(s'|s,a)c \\\\\n        &= T^\\pi\\tilde{Q}_{\\text{max}}(s,a) + \\gamma c.\n    \n\\end{aligned}")
('9.0', 'T^\\nu')
('9.0', '\\begin{aligned}\n        Q_i^\\pi(s,a) &= \\lim_{k\\rightarrow\\infty}(T^\\pi)^k \\tilde{Q}_{\\text{max}}(s,a) \\\\\n        &\\geq \\lim_{k\\rightarrow\\infty}\\left[ \\tilde{Q}_{\\text{max}}(s,a) - \\left(\\epsilon(1+\\gamma) - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}\\right)\\sum_{j=0}^k \\gamma^j \\right] \\\\\n        &\\geq \\tilde{Q}_{\\text{max}}(s,a) - \\frac{1}{1-\\gamma}\\left(\\epsilon(1+\\gamma) - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}\\right) \\\\\n        &\\geq Q_{\\text{max}}(s,a) - \\eps - \\frac{1}{1-\\gamma}\\left(\\epsilon(1+\\gamma) - \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma}\\right) \\\\\n        &\\geq Q^{\\pi_j^*}(s,a) - \\frac{1}{1-\\gamma}\\left( 2\\epsilon + \\frac{\\gamma(1-\\lambda)r(s,a)}{1-\\lambda\\gamma} \\right).\n    \n\\end{aligned}')
('9.0', 'j')
('9.0', '\\nu')
('9.0', '\\lambda,\\hat{\\lambda} \\in [0,1]')
('9.0', 'Q_\\lambda')
('9.0', '\\lambda')
('9.0', '\\|Q_\\lambda^\\nu - Q_{\\hat{\\lambda}}^\\nu\\|_\\infty \\leq \\frac{|\\lambda-\\hat{\\lambda}|\\|r\\|_\\infty}{1-\\gamma}.')
('9.0', 'Q')
('9.0', '(s,a)\\in\\St\\times\\A')
('9.0', '\\begin{aligned}\n        |Q_\\lambda^\\nu(s,a)-Q_{\\hat{\\lambda}}^\\nu(s,a)| &= \\left| \\mathbb{E}_\\pi \\left[ \\sum_{k=0}^\\infty \\gamma^k \\left(\\lambda^{n_t(s_{t+k},k)} - \\hat{\\lambda}^{n_t(s_{t+k},k)}\\right) r(s_{t+k}) \\Big| s_t=s,a_t=a \\right] \\right| \\\\\n        &\\leq \\mathbb{E}_\\pi \\left[ \\sum_{k=0}^\\infty \\gamma^k \\left|\\lambda^{n_t(s_{t+k},k)} - \\hat{\\lambda}^{n_t(s_{t+k},k)}\\right| r(s_{t+k}) \\Big| s_t=s,a_t=a \\right] \\\\\n        &= \\mathbb{E}_\\pi \\left[ \\sum_{k=0}^\\infty \\gamma^k r(s_{t+k}) \\left|\\lambda - \\hat{\\lambda}\\right| \\sum_{j=0}^{n_t(s_{t+k},k)-1} \\lambda^{n_t(s_{t+k},k)-1-j} \\hat{\\lambda}^{j} \\Big| s_t=s,a_t=a \\right] \\\\\n        &\\leq |\\lambda - \\hat{\\lambda}| \\mathbb{E}_\\pi \\left[ \\sum_{k=0}^\\infty \\gamma^k r(s_{t+k}) \\Big| s_t=s,a_t=a \\right] \\\\\n        &\\leq \\frac{|\\lambda - \\hat{\\lambda}| \\|r\\|_\\infty}{1-\\gamma}.\n    \n\\end{aligned}')
('9.0', 'Q_\\lambda')
('9.0', '\\lambda')
('9.0', '\\max_j Q_{\\hat{\\lambda}}^{\\pi_j^*}(s,a) - Q^\\pi_\\lambda(s,a),')
('9.0', '\\lambda')
('9.0', '\\pi_j^*')
('9.0', '\\hat{\\lambda}')
('9.0', '\\begin{aligned}\n        \\max_j Q_{\\hat{\\lambda}}^{\\pi_j^*}(s,a) - Q^\\pi_\\lambda(s,a) &\\leq \\max_j Q_\\lambda^{\\pi_j^*}(s,a) - Q^\\pi_\\lambda(s,a) + |\\max_j Q_\\lambda^{\\pi_j^*}(s,a) - \\max_j Q_{\\hat{\\lambda}}^{\\pi_j^*}(s,a)| \\\\\n        &\\leq \\underbrace{\\max_j Q_\\lambda^{\\pi_j^*}(s,a) - Q^\\pi_\\lambda(s,a)}_{(1)} + \\max_j \\underbrace{|Q_\\lambda^{\\pi_j^*}(s,a) - Q_{\\hat{\\lambda}}^{\\pi_j^*}(s,a)|}_{(2)}.\n    \n\\end{aligned}')
('9.1', 'M\\in\\mathcal{M}')
('9.1', '\\mathcal{M}')
('9.1', '\\lambda')
('9.1', '\\hat{\\lambda}')
('9.1', '\\{M_j\\}_{j=1}^n')
('9.1', 'M_i')
('9.1', '\\mathcal{M}')
('9.1', 'Q_i^{\\pi_j^*}')
('9.1', 'M_j')
('9.1', 'M_i')
('9.1', '\\tilde{Q}_i^{\\pi_j}')
('9.1', '\\|Q_i^{\\pi_j^*}-\\tilde{Q}_i^{\\pi_j}\\|_\\infty\\leq\\epsilon')
('9.1', 'j')
('9.1', '\\pi(s) \\in \\argmax_a \\max_j \\tilde{Q}_i^{\\pi_j}(s,a).')
('9.1', 'Q_{\\hat{\\lambda}}^\\pi')
('9.1', 'Q_\\lambda^{\\pi^*}')
('9.1', '\\pi')
('9.1', 'M')
('9.1', '\\pi^*')
('9.1', 'M')
('9.1', '\\begin{aligned}\n      \\|Q_\\lambda^{\\pi^*} - Q_{\\hat{\\lambda}}^\\pi\\|_\\infty &\\leq \\frac{2}{1-\\gamma}\\left( \\frac{1}{2}|\\lambda-\\hat{\\lambda}|\\|r\\|_\\infty +  \\epsilon + \\|r-r_i\\|_\\infty + \\min_j\\|r_i-r_j\\|_\\infty \\right) + \\frac{1-\\lambda}{1-\\lambda\\gamma}C,\n  \n\\end{aligned}')
('9.1', 'C')
('9.1', '\\lambda')
('9.1', '\\begin{aligned}\n      C =  \\gamma\\frac{2\\|r-r_i\\|_\\infty + 2\\min_j\\|r_i-r_j\\|_\\infty + \\min\\left(\\|r\\|_\\infty, \\|r_i\\|_\\infty\\right) + \\min\\left(\\|r_i\\|_\\infty, \\|r_1\\|_\\infty, \\dots, \\|r_n\\|_\\infty\\right)}{1-\\gamma}.\n  \n\\end{aligned}')
('9.1', '\\lambda=1')
('9.1', '\\hat{\\lambda}\\neq\\lambda')
('9.1', '\\|Q^{\\pi^*}-Q_i^{\\pi_i^*}\\|_\\infty \\leq \\frac{\\|r-r_i\\|_\\infty}{1-\\gamma} + \\gamma(1-\\lambda)\\frac{\\min\\left(\\|r\\|_\\infty, \\|r_i\\|_\\infty\\right) + \\|r-r_i\\|_\\infty}{(1-\\gamma)(1-\\lambda\\gamma)}.')
('9.1', '\\Delta_i \\coloneqq \\|Q^{\\pi^*}-Q_i^{\\pi_i^*}\\|_\\infty')
('9.1', '(s,a)\\in\\St\\times\\A')
('9.1', "\\begin{aligned}\n    |Q^{\\pi^*}(s,a)-Q_i^{\\pi_i^*}(s,a)| &= \\Big| r(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left( (\\lambda-1)r(s,a) \\Phi^{\\pi^*}(s',\\pi^*(s'),s) + Q^{\\pi^*}(s',\\pi^*(s') \\right) \\\\\n    &- r_i(s,a) -\\gamma\\sum_{s'}p(s'|s,a)\\left( (\\lambda-1)r_i(s,a) \\Phi^{\\pi_i^*}(s',\\pi_i^*(s'),s) + Q_i^{\\pi_i^*}(s',\\pi_i^*(s') \\right) \\Big| \\\\\n    &\\leq |r(s,a)-r_i(s,a)| + \\gamma \\sum_{s'}p(s'|s,a)|Q^{\\pi^*}(s,a)-Q_i^{\\pi_i^*}(s,a)| \\\\\n    &+\\gamma(\\lambda-1)\\sum_{s'}p(s'|s,a)\\left|r(s,a)\\Phi^{\\pi^*}(s',\\pi^*(s'),s) - r_i(s,a)\\Phi^{\\pi_i^*}(s',\\pi_i^*(s'),s)\\right| \\\\\n    &\\leq \\|r-r_i\\|_\\infty + \\gamma \\Delta_i + \\gamma(1-\\lambda)\\|r\\Phi^{\\pi^*}-r_i\\Phi^{\\pi_i^*}\\|_\\infty.\n\\end{aligned}")
('9.1', '\\begin{aligned}\n    \\|r\\Phi^{\\pi^*}-r_i\\Phi^{\\pi_i^*}\\|_\\infty &\\leq \\|r\\Phi^{\\pi^*} - r\\Phi^{\\pi_i^*}\\|_\\infty + \\|r\\Phi^{\\pi_i^*} - r_i\\Phi^{\\pi_i^*}\\|_\\infty \\\\\n    &\\leq \\frac{\\|r\\|_\\infty + \\|r-r_i\\|_\\infty}{1-\\lambda\\gamma}.\n\\end{aligned}')
('9.1', '\\begin{aligned}\n    \\|r\\Phi^{\\pi^*}-r_i\\Phi^{\\pi_i^*}\\|_\\infty &\\leq \\|r\\Phi^{\\pi^*} - r_i\\Phi^{\\pi^*}\\|_\\infty + \\|r_i\\Phi^{\\pi^*} - r_i\\Phi^{\\pi_i^*}\\|_\\infty \\\\\n    &\\leq \\frac{\\|r_i\\|_\\infty + \\|r-r_i\\|_\\infty}{1-\\lambda\\gamma},\n\\end{aligned}')
('9.1', '\\|r\\Phi^{\\pi^*}-r_i\\Phi^{\\pi_i^*}\\|_\\infty \\leq \\frac{\\min\\left(\\|r\\|_\\infty, \\|r_i\\|_\\infty\\right) + \\|r-r_i\\|_\\infty}{1-\\lambda\\gamma}.')
('9.1', 's,a')
('9.1', '\\begin{aligned}\n    \\Delta_i &\\leq \\|r-r_i\\|_\\infty + \\gamma\\Delta_i + \\gamma(1-\\lambda)\\frac{\\min\\left(\\|r\\|_\\infty, \\|r_i\\|_\\infty\\right) + \\|r-r_i\\|_\\infty}{1-\\lambda\\gamma} \\\\\n    \\implies \\Delta_i &\\leq \\frac{\\|r-r_i\\|_\\infty}{1-\\gamma} + \\gamma(1-\\lambda)\\frac{\\min\\left(\\|r\\|_\\infty, \\|r_i\\|_\\infty\\right) + \\|r-r_i\\|_\\infty}{(1-\\gamma)(1-\\lambda\\gamma)}.\n\\end{aligned}')
('9.1', '\\pi')
('9.1', '\\|Q_i^\\pi-Q^\\pi\\|_\\infty \\leq \\frac{\\|r-r_i\\|_\\infty}{1-\\gamma} + \\gamma(1-\\lambda)\\frac{\\|r-r_i\\|_\\infty}{(1-\\gamma)(1-\\lambda\\gamma)}.')
('9.1', '\\Delta_i \\coloneqq \\|Q_i^\\pi-Q^\\pi\\|_\\infty')
('9.1', '(s,a)\\in\\St\\times\\A')
('9.1', "\\begin{aligned}\n        |Q_i^\\pi(s,a)-Q^\\pi(s,a)| &= \\Big|r_i(s,a) + \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r_i(s,a)\\Phi^\\pi(s',\\pi(s'),s) + Q_i^\\pi(s',\\pi(s'))\\right) \\\\ &- r(s,a) - \\gamma\\sum_{s'}p(s'|s,a)\\left((\\lambda-1)r(s,a)\\Phi^\\pi(s',\\pi(s'),s) + Q^\\pi(s',\\pi(s'))\\right) \\\\\n        &\\leq |r(s,a)-r_i(s,a)| + \\gamma\\sum_{s'}p(s'|s,a)(1-\\lambda)|r(s,a)-r_i(s,a)|\\Phi^\\pi(s',\\pi(s'),s) \\\\ &+ \\gamma\\sum_{s'}p(s'|s,a)|Q_i^\\pi(s',\\pi(s'))-Q^\\pi(s',\\pi(s'))| \\\\\n        &\\leq \\|r-r_i\\|_\\infty + \\gamma(1-\\lambda)\\|r-r_i\\|_\\infty \\frac{1}{1-\\lambda\\gamma} + \\gamma \\Delta'_i \\\\\n        \\implies \\Delta'_i &\\leq \\|r-r_i\\|_\\infty + \\frac{\\gamma(1-\\lambda)\\|r-r_i\\|_\\infty}{1-\\lambda\\gamma} + \\gamma\\Delta'_i \\\\\n        \\implies \\Delta'_i &\\leq \\frac{\\|r-r_i\\|_\\infty}{1-\\gamma} +  \\frac{\\gamma(1-\\lambda)\\|r-r_i\\|_\\infty}{(1-\\gamma)(1-\\lambda\\gamma)}.\n    \n\\end{aligned}")
('9.1', '\\begin{aligned}\n    \\|Q_\\lambda^{\\pi^*} - Q_{\\hat{\\lambda}}^\\pi\\|_\\infty \\leq \\|Q_\\lambda^{\\pi^*} - Q_\\lambda^\\pi\\|_\\infty + \\|Q_\\lambda^\\pi - Q_{\\hat{\\lambda}}^\\pi\\|_\\infty.\n\\end{aligned}')
('9.1', '\\frac{|\\lambda - \\hat{\\lambda}| \\|r\\|_\\infty}{1-\\gamma}.')
('9.1', '\\lambda')
('9.1', '\\|Q^{\\pi^*} - Q^\\pi\\|_\\infty \\leq \\underbrace{\\|Q^{\\pi^*}-Q_i^{\\pi_i^*}\\|_\\infty}_{(1)} + \\underbrace{\\|Q_i^{\\pi_i^*}-Q_i^\\pi\\|_\\infty}_{(2)} + \\underbrace{\\|Q_i^\\pi-Q^\\pi\\|_\\infty}_{(3)}.')
('9.1', 'M_i')
('9.1', 'M')
('9.1', 'j')
('9.1', '\\begin{aligned}\n    Q_i^{\\pi_i^*}(s,a) - Q_i^\\pi(s,a) &\\leq Q_i^{\\pi_i^*}(s,a) - Q_i^{\\pi_j^*}(s,a) + \\frac{1}{1-\\gamma}\\left(2\\epsilon + \\frac{\\gamma(1-\\lambda)r_i(s,a)}{1-\\lambda\\gamma}\\right) \\\\\n    \\implies \\|Q_i^{\\pi_i^*}-Q_i^\\pi\\|_\\infty &\\leq \\underbrace{\\|Q_i^{\\pi_i^*}-Q_j^{\\pi_j^*}\\|_\\infty}_{(2.1)} + \\underbrace{\\|Q_j^{\\pi_j^*}-Q_i^{\\pi_j^*}\\|_\\infty}_{(2.2)} + \\frac{1}{1-\\gamma}\\left(2\\epsilon + \\frac{\\gamma(1-\\lambda)\\|r_i\\|_\\infty}{1-\\lambda\\gamma}\\right).\n\\end{aligned}')
('9.1', 'M_j')
('9.1', 'M')
('9.1', '\\begin{aligned}\n    \\|Q_i^{\\pi_i^*}-Q_j^{\\pi_j^*}\\|_\\infty + \\|Q_j^{\\pi_j^*}-Q_i^{\\pi_j^*}\\|_\\infty &\\leq \\frac{2\\|r_i-r_j\\|_\\infty}{1-\\gamma} + \\gamma(1-\\lambda)\\frac{\\min\\left(\\|r_i\\|_\\infty, \\|r_j\\|_\\infty\\right) + 2\\|r_i-r_j\\|_\\infty}{(1-\\gamma)(1-\\lambda\\gamma)}.\n\\end{aligned}')
('9.1', '\\eqno\\qed')
('10', 'N')
('10', 'N')
('10', "s'")
('10', 's')
('10', '\\St')
('10', 'N')
('10', '\\pi')
('10', 'F^\\pi\\in[0, N]^{|\\St|\\times|\\St|}')
('10', "\\begin{aligned}\n    \\Phi_{(N)}^\\pi(s,s') \\triangleq \\E_{\\pi}\\left[ \\sum_{k=0}^\\infty \\gamma^{t+k}\\mathbbm 1\\left(s_{t+k}=s', \\#\\left(\\{ j \\mid s_{t+j} = s', j \\in [0, k-1] \\} \\right) < N\\right) \\Big\\vert s_t \\right].\n  \n\\end{aligned}")
('10', 'N')
('10', "s'")
('10', 't')
('10', 't+k')
('10', 's_t = s')
('10', '\\Phi_{(1)}^\\pi')
('10', "\\Phi_{(0)}(s,s') = 0")
('10', "\\forall s,s'")
('10', "\\begin{aligned}\n \\label{eq:nr_recursion}\n  \\Phi_{(N)}^\\pi(s, s') &= \\mathbbm 1(s_t = s')(1 + \\gamma \\E \\Phi_{(N-1)}^\\pi(s_{t+1}, s')) + \\gamma (1 - \\mathbbm 1(s_t = s'))\\E \\Phi_{(N)}^\\pi(s_{t+1}, s'),\n\\end{aligned}")
('10', 'p^\\pi(s_{t+1}|s_t)')
('10', 'N=1')
('10', 'N\\to\\infty')
('10', "\\begin{aligned}\n  \\lim_{N\\mapsto\\infty} \\Phi_{(N)}^\\pi(s, s') &= \\mathbbm 1(s_t = s')(1 + \\gamma \\E \\Phi_{(\\infty)}^\\pi(s_{t+1}, s')) + \\gamma (1 - \\mathbbm 1(s_t = s'))\\E \\Phi_{(\\infty)}^\\pi(s_{t+1}, s') \\\\\n    &= \\mathbbm 1(s_t = s') + \\gamma \\E \\Phi_{(\\infty)}^\\pi(s_{t+1}, s').\n\\end{aligned}")
('10', '\\Phi_{(N)}^\\pi')
('10', '\\Phi_{(N-1)}^\\pi')
('10', 'N > 1')
('10', '\\Phi_{(1)}^\\pi, \\dots \\Phi_{(N-1)}^\\pi')
('12.0', '6\\times 6')
('12.0', '\\gamma')
('12.0', 'H=10')
('12.0', '\\begin{aligned}\n \\label{eq:qmse}\n    Q_{error} \\triangleq \\frac{1}{|\\St||\\A|}\\sum_{s,a} (Q^\\pi(s, a) - \\hat Q(s, a))^2,\n\\end{aligned}')
('12.0', 'Q^\\pi')
('12.0', 'Q')
('12.0', '\\hat Q')
('12.0', '\\lr')
('12.0', '\\lambda \\in \\{0.5, 1.0\\}')
('12.0', '\\lr')
('12.0', '\\vec r \\in \\{-1, 0, 1\\}^{36}')
('12.0', '-1')
('12.0', '+1')
('12.0', 'g')
('12.0', '\\lr')
('12.0', '\\lambda\\in\\{0.5, 1.0\\}')
('12.0', '\\begin{aligned}\n    &\\Phi_\\lambda(s_t, a_t) \\gets \\Phi_\\lambda(s_t, a_t) + \\alpha \\delta_t, \\\\\n    &\\delta_t = \\vec 1(s_t) \\odot (1 + \\gamma\\lambda \\Phi_\\lambda(s_{t+1}, a_{t+1})) + \\gamma(1 - \\vec 1(s_t)) \\odot \\Phi_\\lambda(s_{t+1}, a_{t+1}) - \\Phi_\\lambda(s_t, a_t),\n\\end{aligned}')
('12.0', 'a_{t+1}\\sim \\pi(\\cdot\\mid s_{t+1})')
('12.0', 'Q')
('12.0', '\\lambda')
('12.0', '[0, 1]')
('12.0', '\\lambda')
('12.0', '\\lambda')
('12.1', '\\lambda_{true} = 0.5')
('12.1', '\\gamma = 0.95')
('12.1', '5')
('12.1', '10')
('12.1', '\\lr')
('12.1', '\\Phi_\\lambda^{(t)}\\in\\reals^{|\\St|\\times |\\A| \\times |\\St|}')
('12.1', '\\vec r^{(t)}')
('12.1', '(s_{t}, a_t, s_{t+1})')
('12.1', 'Q_\\lambda')
('12.1', 'Q_\\lambda^{(t)} \\gets   (\\Phi_\\lambda^{(t)})\\tr \\vec r^{(t)}')
('12.1', 'a_{t+1}\\gets \\argmax_{a\\in\\A}Q_\\lambda^{(t)}(s_{t+1}, a)')
('12.1', '\\Phi_\\lambda')
('12.1', '\\begin{aligned}\n                    &\\Phi_\\lambda^{(t+1)}(s_t, a_t) \\gets \\Phi_\\lambda^{(t)}(s_t, a_t) + \\alpha \\delta^{(t)}, \\quad \\text{where}\\\\\n    &\\delta^{(t)} = \\vec 1(s_t) \\odot (1 + \\gamma\\lambda \\Phi_\\lambda^{(t)}(s_{t+1}, a_{t+1})) + \\gamma(1 - \\vec 1(s_t)) \\odot \\Phi_\\lambda^{(t)}(s_{t+1}, a_{t+1}) - \\Phi_\\lambda^{(t)}(s_t, a_t).\n                \n\\end{aligned}')
('12.1', '\\Phi_\\lambda^{(t+1)}')
('12.1', 'Q_\\lambda')
('12.1', '\\lambda \\in \\{0.0, 0.5, 1.0\\}')
('12.1', '\\lambda_{true}')
('12.1', '\\alpha=0.1')
('12.1', 'H=100')
('12.1', '\\gamma = 0.99')
('12.1', '\\lambda')
('12.2', '\\{\\pi_0, \\pi_1, \\pi_2, \\pi_3\\}')
('12.2', '\\{g_0, g_1, g_2\\}')
('12.2', '\\bar r = [5, 10, 5]')
('12.2', '\\lambda = 0.5')
('12.2', 's_0')
('12.2', '0.1')
('12.2', 'H = 40')
('12.2', '0')
('12.2', '-1')
('12.2', '\\gamma = 0.97')
('12.2', '\\lr')
('12.2', '\\lambda')
('12.2', '0')
('12.2', '0.5')
('12.2', '1.0')
('12.2', '\\lr')
('12.2', '\\lambda')
('12.2', '\\lr')
('12.3', '\\Pi')
('12.3', '(o_0, o_1, \\dots, o_{H-1})\\in\\mathcal O^H')
('12.3', 'H=19')
('12.3', '6,460')
('12.3', '128 \\times 128 \\times 3')
('12.3', '3 \\times 3')
('12.3', '(2, 2, 2, 1)')
('12.3', '\\tanh')
('12.3', 'L_2')
('12.3', '\\phi: \\mathcal O^{7} \\mapsto \\reals^D')
('12.3', 'D=50')
('12.3', 'B=64')
('12.3', '(s_t, a_{t+1}, s_{t+1}, a_{t+1})')
('12.3', 's_t \\triangleq o_{t-6:t}')
('12.3', '\\vec w')
('12.3', '\\lambda')
('12.3', '\\lambda')
('12.3', '\\lambda')
('12.3', 'D |\\A| = 250')
('12.3', 'K=20')
('12.3', 'L=100')
('12.3', 'B=64')
('12.3', '\\begin{aligned}\n    a_{t} = \\argmax_{a\\in\\A}\\max_{\\pi\\in\\Pi} \\vec w\\tr \\varphi_\\theta^\\pi(s_t, a).\n\\end{aligned}')
('12.3', 'H=50')
('12.3', '\\lambda')
('12.3', '\\lambda')
('12.3', '\\lambda')
('12.3', '\\lambda')
('12.3', 'xy')
('12.3', '\\lambda')
('12.3', '\\{\\phi(s)\\in\\reals^D\\}_{s\\in\\St}')
('12.3', '\\lambda')
('12.3', '\\gamma')
('12.3', '\\vec w \\in \\reals^D')
('12.3', 'B')
('12.3', '\\alpha')
('12.3', '\\lambda')
('12.3', '\\varphi_\\theta')
('12.3', '\\theta^{(1)}')
('12.3', '\\lambda')
('12.3', '\\pi')
('12.3', '\\mathcal D \\gets \\varnothing')
('12.3', "\\mathcal D \\gets \\mathcal D \\cup \\left\\{\\left((s, a), \\underbrace{\\vec w\\tr\\left[\\phi(s) \\odot (1 + \\lambda\\gamma \\bar\\varphi_{\\theta^{(k)}}(s', a')) + \\gamma(1 - \\phi(s)) \\odot \\bar\\varphi_{\\theta^{(k)}}(s', a')\\right]}_{\\triangleq y(s,a)} \\right)\\right\\}")
('12.3', '\\theta_0')
('12.3', '\\mathcal D')
('12.3', '\\theta_{\\ell} \\gets \\theta_{\\ell-1} - \\alpha \\grad_\\theta \\frac{1}{2B}\\sum_{b=1}^B\\left(y_b - \\vec w\\tr\\varphi_{\\theta_{\\ell-1}}(s_b,a_b) \\right)^2')
('12.3', '\\theta^{(k+1)} \\gets \\theta_L')
('12.5', '\\lambda')
('12.5', '\\mathcal{L}')
('12.5', '\\|\\E_{s\\sim\\rho} B_\\omega(s)B_\\omega(s)^\\top - I\\|^2.')
('12.5', 'B')
('12.5', 'F_\\theta')
('12.5', 'B_\\omega')
('12.5', '\\nu')
('12.5', '\\mathbb{R}^d')
('12.5', 'F_\\theta, B_\\omega')
('12.5', '\\eta')
('12.5', 'B')
('12.5', 'E')
('12.5', 'M')
('12.5', 'T')
('12.5', 'N')
('12.5', '\\beta')
('12.5', '\\alpha')
('12.5', '\\lambda')
('12.5', '\\gamma')
('12.5', '\\epsilon')
('12.5', '\\tau')
('12.5', '\\mathcal{D} \\gets \\varnothing')
('12.5', 'z \\sim \\nu')
('12.5', 's_1')
('12.5', 'a_t')
('12.5', '\\epsilon-')
('12.5', 'F_\\theta(s_t,a,z)^\\top z')
('12.5', 'r_t(s_t)')
('12.5', 's_{t+1}')
('12.5', '\\mathcal{D} \\gets \\mathcal{D} \\cup \\{(s_t, a_t, r_t(s_t), s_{t+1})\\}')
('12.5', '\\{(s_j, a_j, r_j(s_j), s_{j+1})\\}_{j\\in J} \\subset \\mathcal{D}')
('12.5', '|J|=B')
('12.5', '\\{\\tilde s_j\\}_{j\\in J} \\subset \\mathcal{D}')
('12.5', '|J|=B')
('12.5', "\\{s'_j\\}_{j\\in J} \\overset{\\text{iid}}{\\sim} \\mu")
('12.5', '|J|=B')
('12.5', '\\{z_j\\}_{j\\in J} \\overset{\\text{iid}}{\\sim} \\nu')
('12.5', '|J|=B')
('12.5', 'j\\in J')
('12.5', '\\pi_{z_j}(\\cdot|s_{j+1}) = \\texttt{softmax}\\left(F_{\\theta^-}(s_{j+1},\\cdot,z_j)^\\top z_j / \\tau\\right)')
('12.5', "\\begin{aligned}\n                    \\mathcal{L}(\\theta,\\omega) &\\gets \\frac{1}{2B^2} \\sum_{j,k\\in J^2} \\left( F_\\theta(s_j,a_j,z_j)^\\top B_\\omega(s'_k) - \\gamma \\sum_{a\\in\\mathcal{A}} \\pi_{z_j}(a|s_{j+1}) F_{\\theta^-} (s_{j+1}, a, z_j)^\\top B_{\\omega^-}(s'_k) \\right)^2  \\\\ &\\quad - \\frac{1}{B}\\sum_{j\\in J} F_\\theta(s_j,a_j,z_j)^\\top B_\\omega(s_j) \\\\ &\\quad + \\frac{\\gamma(1-\\lambda)}{B} \\sum_{j\\in J} \\mu(s_j) F_\\theta(s_j,a_j,z_j)^\\top B_\\omega(s_j) \\sum_{a\\in\\mathcal{A}} \\pi_{z_j}(a|s_{j+1}) F_{\\theta^-}(s_{j+1},a,z_j)^\\top B_{\\omega^-}(s_j) \\\\\n                    &\\quad + \\beta \\left( \\frac{1}{B^2}\\sum_{j,k\\in J^2} B_\\omega(s_j)^\\top \\bar B_{\\omega}(\\tilde s_k) \\bar B_\\omega(s_j)^\\top \\bar B_\\omega(\\tilde s_k) - \\frac{1}{B} \\sum_{j\\in J} B_w(s_j)^\\top \\bar B_\\omega(s_j) \\right)\n                    \n\\end{aligned}")
('12.5', '\\theta')
('12.5', '\\omega')
('12.5', '\\mathcal{L}')
('12.5', '\\{(s_j, r_j(s_j), s_{j+1}, r_{j+1}(s_{j+1}))\\}_{j \\in J}')
('12.5', '|J|=B')
('12.5', '\\mathcal{D}')
('12.5', '\\mathcal{L}_\\lambda(\\lambda) \\gets \\frac{1}{2B}\\sum_{j\\in J} \\mathbbm 1(s_{j+1}=s_j) \\left( r_{j+1}(s_{j+1}) - \\lambda r_j(s_j)\\right)^2')
('12.5', '\\lambda')
('12.5', '\\mathcal{L}_\\lambda')
('12.5', '\\theta^- \\gets \\alpha\\theta^- + (1-\\alpha)\\theta')
('12.5', '\\omega^- \\gets \\alpha\\omega^- + (1-\\alpha)\\omega')
('12.5', 'r_0(s)')
('12.5', 'z_R \\gets \\sum_{s\\in\\St} \\mu(s)r_0(s)B_\\omega(s)')
('12.5', 's_1')
('12.5', 'a_t \\gets \\argmax_{a\\in\\mathcal{A}} F(s_t,a,z_R)^\\top z_R')
('12.5', 'r_t(s)')
('12.5', 's_{t+1}')
('12.5', 'z_R \\gets \\sum_{s\\in\\St} \\mu(s)r_t(s)B_\\omega(s)')
('13', '\\mathbf{\\lr}')
('13', '\\Phi^\\pi_1')
('13', '\\Phi^\\pi_0')
('13', '\\lambda')
('13', '\\lambda')
('14', '\\lr')
('14', '\\vec r_\\lambda')
('14', '\\lr')
('14', '\\lr')
('14', '\\lambda')
('14', '\\lr')
('14', '\\bar r(s_1) = 10')
('14', '\\bar r(s_2) = 6')
('14', '\\bar r(s_0) = 0')
('14', '\\lambda(s_1) = 0')
('14', '\\lambda(s_2) = 1.0')
('14', '\\gamma=0.99')
('14', 't=0')
('14', 's_0')
('14', '\\lambda(s_1) = \\lambda(s_2) = 1')
('14', 's_1')
('14', 's_0')
('14', 's_2')
('14', '\\lambda')
('14', 's_2')
('14', '10 + 0 = 10')
('14', '6 + 5.94 = 11.94')
('14', '\\lambda')
('15', '\\lambda')
('15', "\\Phi_\\lambda^\\pi(s_t, ds') \\triangleq \\varphi_\\lambda^\\pi(s_t, s')\\mu(ds')")
('15', '\\mu')
('15', "\\Phi_\\lambda^\\pi(s,A \\cup B) = \\int_A \\varphi_\\lambda^\\pi(s,ds')\\mu(ds') + \\int_B \\varphi_\\lambda^\\pi(s,ds')\\mu(ds') = \\Phi_\\lambda^\\pi(s,A) + \\Phi_\\lambda^\\pi(s,B)")
('15', 'A,B')
('15', '\\lambda')
('15', '\\St')
('15', "\\Phi_\\lambda^\\pi(s,s')=\\varphi_\\lambda^\\pi(s,s')\\mu(s')")
('15', '\\varphi')
('15', '\\Phi')
('15', "\\begin{aligned}\n  \\|\\Phi_\\lambda^\\pi \\|_\\rho^2 \\triangleq \\E_{\\stackrel{s\\sim\\rho}{s'\\sim\\mu}} \\left[ \\left( \\frac{\\Phi_\\lambda^\\pi(s, s')}{\\mu(s')}\\right)^2\\right],\n\\end{aligned}")
('15', '\\mu')
('15', '\\St')
('15', '\\St')
('15', '\\mu')
('15', '\\Phi_\\lambda^\\pi')
('15', '\\|\\cdot\\|_{\\rho,\\mu}^2')
('15', '\\Phi')
('15', '\\varphi')
('15', "\\begin{aligned}\n  \\mathcal L(\\Phi) &= \\| \\varphi\\mu - (I \\odot (\\vec 1\\vec 1\\tr + \\lambda\\gamma P^\\pi \\varphi\\mu) + \\gamma(\\vec 1\\vec 1\\tr + I) \\odot P^\\pi\\varphi\\mu) \\|_{\\rho,\\mu}^2\n  \\\\\n  &= \\E_{s_t\\sim\\rho,s'\\sim\\mu} \\Big[ \\Big(\\varphi(s_t, s') - \\frac{\\mathbbm 1(s_t=s')}{\\mu(s')} \\\\\n  &\\qquad\\qquad+ \\gamma(1 - \\lambda) \\frac{\\mathbbm 1(s_t=s')}{\\mu(s')} \\E_{s_{t+1}\\sim p^\\pi(\\cdot|s_t)}\\bar\\Phi(s_{t+1}, s')  - \\gamma \\E_{s_{t+1}\\sim p^\\pi(\\cdot|s_t)}\\bar\\varphi(s_{t+1}, s')\\Big)^2 \\Big] \\\\\n  &\\overset{+c}{=} \\E_{s_t,s_{t+1}\\sim\\rho,s'\\sim\\mu} \\left[  \\left(\\varphi(s_t, s') - \\gamma\\bar \\varphi(s_{t+1}, s') \\right)^2\\right] \\\\\n  &\\qquad\\qquad- 2\\E_{s_t,s_{t+1}\\sim\\rho} \\left[ \\sum_{s'} \\mu(s') \\varphi(s_t, s') \\frac{\\mathbbm 1(s_t=s')}{\\mu(s')}  \\right] \\\\\n  &\\qquad\\qquad+ 2\\gamma(1-\\lambda)\\E_{s_t,s_{t+1}\\sim\\rho} \\left[ \\sum_{s'}\\mu(s') \\varphi(s_t, s') \\bar\\varphi(s_{t+1}, s')\\mu(s') \\frac{\\mathbbm 1(s_t=s')}{\\mu(s')} \\right] \\\\\n  &\\overset{+c}{=} \\E_{s_t,s_{t+1}\\sim\\rho,s'\\sim\\mu}\\left[  \\left(\\varphi(s_t, s') - \\gamma\\bar \\varphi(s_{t+1}, s') \\right)^2\\right] - 2\\E_{s_t\\sim\\rho} [\\varphi(s_t, s_t)] \\\\\n  &\\qquad\\qquad+ 2\\gamma (1 - \\lambda)\\E_{s_t,s_{t+1}\\sim\\rho}[\\mu(s_t)\\varphi(s_t, s_t)\\bar \\varphi(s_{t+1}, s_t)],\n\\end{aligned}")
('15', '\\lambda=1')
('15', '\\varphi(s_{t+1},s_t)=0')
('15', '\\lambda')
('15', "\\begin{aligned}\n\\begin{split} \\label{eq:lo_fb_loss}\n    \\mathcal{L}(\\Phi) &= \\E_{s_t,a_t,s_{t+1}\\sim\\rho,s'\\sim\\mu} \\left[ \\left( F(s_t,a_t,z)^\\top B(s') - \\gamma \\bar{F}(s_{t+1},\\pi_z(s_{t+1}), z)^\\top \\bar{B}(s') \\right)^2 \\right] \\\\\n    &\\qquad - 2 \\mathbb{E}_{s_t,a_t\\sim\\rho} \\left[ F(s_t,a_t,z)^\\top B(s_t) \\right] \\\\\n    &\\qquad + 2\\gamma(1-\\lambda) \\mathbb{E}_{s_t,a_t,s_{t+1}\\sim\\rho} \\left[ \\mu(s_t) F(s_t,a_t,z)^\\top B(s_t) \\bar{F}(s_{t+1}, \\pi_z(s_{t+1}), z)^\\top \\bar{B}(s_t) \\right]\n\\end{split}\n\\end{aligned}")
('15', '\\lambda')
('15', "\\frac{\\Phi(s,ds')}{\\mu(ds')}")
('15.0', '\\lambda')
('15.0', '\\lambda')
('15.0', '\\lambda_{\\text{true}}, \\lambda_{\\text{agent}} \\in \\{0.5,1.0\\}')
('15.0', '\\lambda_{\\text{true}}')
('15.0', '\\lambda_{\\text{agent}}')
('15.0', '\\lambda')
('15.0', '\\lambda')
('15.0', '\\lambda=1')
('15.0', '\\bm{\\lambda}')
('15.0', 'M')
('15.0', 'E')
('15.0', 'N')
('15.0', 'B')
('15.0', 'T')
('15.0', '\\gamma')
('15.0', '\\alpha')
('15.0', '\\eta')
('15.0', '\\tau')
('15.0', '\\epsilon')
('15.0', '\\bm{\\lambda}')
('15.0', '\\bm{\\lambda}')
('15.1', 'R')
('15.1', 'r(s_t)')
('15.1', 't')
('15.1', 'R_t = \\sum_{u=0}^t r(s_u)')
('15.1', 't')
('15.1', 'T')
('15.1', 't')
('15.1', 's_t')
('15.1', '\\lambda r(s_t)')
('15.1', '\\frac{R-R_t}{T}.')
('15.1', 'R')
('15.1', '\\E_\\pi\\left[ \\sum_{k=0}^\\infty \\gamma^k r(s_{t+k}) \\Big\\vert s_t=s\\right],')
('15.1', '\\gamma<1')
('15.1', 'R')
('15.1', 'R_t')
('15.1', '\\gamma')
('15.1', '\\lambda')
('15.1', '\\gamma=0.99')
('15.1', '\\gamma=1.0')
('15.1', '\\lambda')
('15.1', '\\gamma=1.0')
('15.1', '\\lambda<1')
('15.1', '\\bm{\\lambda}')
('15.1', '\\gamma=0.99')
('15.1', '\\gamma=1.0')
('16.0', '\\min_{i\\in\\{1,2\\}} Q_i^\\pi(s, a)')
('16.0', '(s,a)')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\mathcal T_{soft} Q = r_t + \\gamma \\E V_{soft}(s_{t+1})')
('16.0', 'V_{soft}(s_{t+1})')
('16.0', '\\begin{aligned}\n  \\E_{a_{t+1} \\sim \\pi(\\cdot|s_{t+1})}\\Big[\\bar Q(s_{t+1}, a_{t+1}) + (\\lambda - 1)\\vec w\\tr(\\phi(s_t, a_t) &\\odot \\varphi_\\lambda(s_{t+1}, a_{t+1})) \\\\ &- \\alpha \\log \\pi(a_{t+1}\\mid s_{t+1}) \\Big]\n\\end{aligned}')
('16.0', '\\lambda=1')
('16.0', '\\lambda')
('16.0', '\\tilde \\phi_t = [s_t, a_t]')
('16.0', '[0, 1]')
('16.0', '\\begin{aligned}\n    \\phi_t^b = \\frac{\\tilde \\phi_t^b - \\min_b \\tilde\\phi_t^b}{\\max_b \\tilde\\phi_t^b - \\min_b \\tilde\\phi_t^b},\n\\end{aligned}')
('16.0', 'b')
('16.0', '(s_t, a_t)')
('16.0', 'X \\in [0, 1]^{B \\times D}')
('16.0', 'D = \\mathrm{dim}(\\St) + \\mathrm{dim}(\\A)')
('16.0', '\\begin{aligned}\n    \\vec w_t = \\left(X\\tr X \\right)^{-1} X\\tr \\vec r,\n\\end{aligned}')
('16.0', '\\vec r')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\{0, 0.5, 1.0\\}')
('16.0', '\\lambda')
('16.0', '\\ell')
('16.0', '\\ell -1')
('16.0', 'R_\\ell - R_{\\ell-1}')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', 'x')
('16.0', '\\lambda=x')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\lambda =1')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', 'R_{\\ell} - (\\ell-1)^{-1}\\sum_{i=1}^{\\ell-1}R_{i}')
('16.0', '^*')
('16.0', '\\lambda')
('16.0', '3 \\times 10^{-4}')
('16.0', '1 \\times 10^6')
('16.0', '[-1, 1]')
('16.0', '5 \\times 10^{-3}')
('16.0', '-\\mathrm{dim}(\\mathcal A)')
('16.0', '[-20,2]')
('16.0', '^*')
('16.0', '\\lambda')
('16.0', '^*')
('16.0', '\\{0, 0.5, 1.0\\}')
('16.0', '\\lambda')
('16.0', '\\lambda')
('16.0', '\\lambda')
('17.0', 'r(s,t) = \\lambda^{n(s,t)/m(s,t)}\\bar r(s),')
('17.0', 'm(s,t)')
('17.0', 's')
('17.0', 'm(s,t) \\triangleq t - \\max\\{j|s_{t+j}=s, \\, 0 \\leq j \\leq t-1\\}.')
('17.0', '\\max')
('17.0', 'm(s,t)')
('17.0', "\\E_\\pi \\left[ \\sum_{k=0}^\\infty \\gamma^k \\lambda^{n(s,t)/m(s,t)} \\mathbbm 1(s_{t+k}=s') \\Big\\vert s_t=s \\right]")
('17.0', 'Q_\\lambda')
('17.0', '\\lambda')
('17.0', 'n(s,t)/(0.1m(s,t))')
('17.0', 'H=100')
('17.0', 'Q_\\lambda')
('17.0.0', 'r(s,t) = \\left( 1-(1-\\lambda_d)\\sum_{j=0}^{t-1} \\lambda_r^{t-j} \\mathbbm 1(s_{t+j}=s) \\right) \\bar r(s),')
('17.0.0', '\\lambda_d, \\lambda_r\\in[0,1]')
('17.0.0', '\\Omega^\\pi')
('17.0.0', "\\Omega^\\pi(s, s') = \\E\\left[\\sum_{k=0}^\\infty \\gamma^k \\left(1 - (1 - \\lambda_d)\\sum_{j=0}^k \\lambda^{k-j}_r\\mathbbm 1(s_{t+j} = s')\\right) \\mathbbm 1(s_{t+k} = s') \\Bigg\\vert s_t = s\\right],")
('17.0.0', "\\begin{aligned}\n    \\Omega^\\pi(s,s')=\\mathbbm 1(s=s')(\\lambda_d - \\gamma\\lambda_r(1-\\lambda_d)&\\E_{s_{t+1}\\sim p^\\pi(\\cdot | s)} M^\\pi_{\\gamma\\lambda_r}(s_{t+1},s'))\n    \\\\ \n    &+ \\gamma \\E_{s_{t+1}\\sim p^\\pi(\\cdot | s)} \\Omega^\\pi(s_{t+1},s'),\n\\end{aligned}")
('17.0.0', 'M^\\pi_{\\gamma\\lambda_r}')
('17.0.0', '\\pi')
('17.0.0', '\\gamma\\lambda_r')
('17.0.0', '\\Omega^\\pi')
('17.0.0', 'M^\\pi_{\\gamma\\lambda_r}')
('17.0.0.0', 'r(s,t) = \\lambda_d^{n(s,t)}\\lambda_r^{n(s,t)-t}\\bar r(s),')
('17.0.0.0', '\\lambda_d, \\lambda_r\\in[0,1]')
('17.0.0.0', "P^\\pi(s,s') = \\E \\left[ \\sum_{k=0}^\\infty \\gamma^k \\lambda_d^{n_t(s',k)}\\lambda_r^{k-n_t(s',k)} \\mathbbm 1(s_{t+k}=s') \\Bigg\\vert s_t=s \\right],")
('17.0.0.0', "\\begin{aligned}\n    P^\\pi(s,s') &= \\mathbbm 1(s=s') + \\gamma(\\lambda_d \\mathbbm 1(s=s') + 1 \\\\\n    &\\qquad- \\mathbbm 1(s=s'))(\\lambda_r(1-\\mathbbm 1(s=s'))+\\mathbbm 1(s=s')) \\E_{s_{t+1}\\sim p^\\pi(\\cdot|s)} P^\\pi(s_{t+1},s').\n\\end{aligned}")
('17.0.0.0', 'P^\\pi')
('17.0.0.0', '\\bar r(s)=1')
('17.0.0.0', 's')
('17.0.0.0', 't=2,5')
('17.0.0.0', '\\lambda=0.5')
('17.0.0.0', '\\lambda_r=\\lambda_d=0.5')
('17.0.0.0', '\\lambda_d=0.5, \\lambda_r=0.9')
('18', '\\gamma')
('18', '\\lambda')
('18', '\\gamma')
('18', '\\lambda')
('18', '(s,a)')
('18', '\\gamma')
('18', '\\lambda')
('18', '\\lambda')
('19', '\\lambda')
('19', '\\lambda')
('19', '\\lambda')
