('3.0', '\\epsilon \\sim \\mathcal{N}(0,I)')
('3.0', 'x_0')
('3.0', 'x_t')
('3.0', 't')
('3.0', 'x_{t} = \\sqrt{\\bar{{\\alpha}}_{t}} x_{0} + \\sqrt{1-\\bar{{\\alpha}}_{t}}\\epsilon,')
('3.0', '{\\alpha}_t = 1-{\\beta}_t')
('3.0', '\\bar{{\\alpha}}_{t} = \\prod_{s=1}^{t} {\\alpha}_s')
('3.0', '{\\beta}_1,...,{\\beta}_t')
('3.0', '\\epsilon_\\theta')
('3.0', '\\epsilon')
('3.0', '\\mathcal{L} = \\mathbb{E}_{x_{0}, t, \\epsilon \\sim \\mathcal{N}(0,I)} \\left[ \\left\\lVert \\epsilon - \\epsilon_{\\theta}(x_{t}, t) \\right\\rVert_2^2 \\right],')
('3.0', 't\\in \\{ 1,...,T \\}')
('3.0', 'x_{t-1}')
('3.0', 'x_{t}')
('3.0', 't')
('3.0', '\\epsilon_{\\theta}(x_{t}, t)')
('3.0', '\\label{eq:ddpm_reverse_onestep}\n    x_{t-1} = \\frac{1}{\\sqrt{\\bar{\\alpha}_{t}}} \\left( x_t - \\frac{\\beta_t}{\\sqrt{1-\\bar{\\alpha}_t}} \\epsilon_{\\theta}(x_{t}, t) \\right) + \\sigma_t z,')
('3.0', 'z \\sim \\mathcal{N}(0,I)')
('3.0', '\\sigma_t^2')
('3.0', '\\beta_t')
('3.0', 'x_T \\sim \\mathcal{N}(0,I)')
('3.0', 'x_0')
('3.0', '\\epsilon_{\\theta}(x_{t})')
('3.0', '\\epsilon_{\\theta}(x_{t}, t)')
('3.0', '{\\epsilon}_{\\theta}(x_t) \\approx -{\\sigma}_t {\\nabla}_{x_t} \\mathrm{log}\\, p(x_t)')
('3.0', 'p(x_t)')
('3.0', 'x_t')
('3.0', 'x_0')
('3.0', 't')
('3.0', '\\hat{x}_{0} = {(x_t - \\sqrt{1-\\bar{\\alpha}_{t}}\\epsilon_{\\theta}(x_{t}, t))}/\n    {\\sqrt{\\bar{\\alpha}_{t}}}.\n\\label{eq:eps-to-x0}')
('3.0.0', 'c')
('3.0.0', '\\Tilde{p}_{\\theta}(x_t|c)')
('3.0.0', '{p}_{\\theta}(x_t|c)')
('3.0.0', '{{p}_{\\theta}(c|x_t)}')
('3.0.0', '\\Tilde{p}_{\\theta}(x_t|c) \\propto {p}_{\\theta}(x_t|c) {{p}_{\\theta}(c|x_t)}^s,')
('3.0.0', 's')
('3.0.0', 's>0')
('3.0.0', '{{p}_{\\theta}(c|x_t)}')
('3.0.0', '{p}_{\\theta}(x_t|c)')
('3.0.0', '{p}_{\\theta}(x_t)')
('3.0.0', '\\begin{aligned}\n\\Tilde{p}_{\\theta}(x_t|c)\n& \\propto {p}_{\\theta}(x_t|c) {{p}_{\\theta}(c|x_t)}^s\n\\nonumber = {p}_{\\theta}(x_t|c) \\left[ \\frac{{p}_{\\theta}(x_t|c){p}_{\\theta}(c)}{{p}_{\\theta}(x_t)} \\right]^s\n\\nonumber\\\\ \n& = {{p}_{\\theta}(x_t|c)}^{1+s} {{p}_{\\theta}(x_t)}^{-s}.\n\\end{aligned}')
('3.0.0', '\\Tilde{p}_\\theta(x_t|c)')
('3.0.0', '\\nabla_{x_t}\\log\\,\\Tilde{p}_\\theta(x_t|c) \\\\= (1+s){\\epsilon}^*(x_t, c) - s{\\epsilon}^*(x_t),')
('3.0.0', '\\epsilon^*')
('3.0.0', '\\begin{aligned}\n\\Tilde{\\epsilon}_{\\theta}(x_t, c)\n& = (1+s){\\epsilon}_{\\theta}(x_t, c) - s{\\epsilon}_{\\theta}(x_t)\n\\nonumber\\\\ & = {\\epsilon}_{\\theta}(x_t, c) + s ( {\\epsilon}_{\\theta}(x_t, c) - {\\epsilon}_{\\theta}(x_t) ) = {\\epsilon}_{\\theta}(x_t, c) + s \\Delta_t.\n\\end{aligned}')
('3.0.0', '\\hat{x}_0')
('3.0.0', '\\Delta_t={\\epsilon}_{\\theta}(x_t, c) - {\\epsilon}_{\\theta}(x_t, \\phi)')
('3.0.0', '{\\epsilon}_{\\theta}(x_t, c)')
('3.0.0', '{\\epsilon}_{\\theta}(x_t, \\phi)')
('3.0.0', '\\Delta_t')
('3.0.0', '{\\epsilon}_{\\theta}(x_t, c)')
('3.0.0', '{\\epsilon}_{\\theta}(x_t)')
('3.0.0', '\\phi')
('3.0.0', '{\\epsilon}_{\\theta}(x_t) \\approx {\\epsilon}_{\\theta}(x_t,\\phi)')
('3.0.0', '\\Delta_t ={\\epsilon}_{\\theta}(x_t, c) - {\\epsilon}_{\\theta}(x_t, \\phi)')
('3.0.0', 'c')
('3.0.0', '\\Delta_t')
('4.0', '\\mathcal{D}')
('4.0', '\\mathcal{D}')
('4.0', '\\mathcal{D}(x_t) = \n\\frac{p(y|x_t)}{p(\\hat{y}|x_t)} =\n\\frac{p(y){p(x_t|y)}}{p(\\hat{y}){p(x_t|\\hat{y})}},\n\\label{eq:disc}')
('4.0', 'y')
('4.0', '\\hat{y}')
('4.0', '\\mathcal{L}_\\mathcal{G}')
('4.0', '\\begin{aligned}\n{\\nabla}_{x_t} \\mathcal{L}_\\mathcal{G}\n&={\\nabla}_{x_t} \\left[- \\mathrm{log}\\: \\mathcal{D}(x_t) \\right] \n\\nonumber\\\\ & = {\\nabla}_{x_t}\\left[ - \\mathrm{log}\\: \\frac{p(y){p(x_t|y)}}{p(\\hat{y}){p(x_t|\\hat{y})}}\\right] = {\\nabla}_{x_t}\\left[ - \\mathrm{log}\\: \\frac{p(x_t|y)}{p(x_t|\\hat{y})}\\right] \n\\nonumber\\\\ & = -{\\nabla}_{x_t}(\\mathrm{log}\\:p(x_t|y) - \\mathrm{log}\\:p(x_t|\\hat{y})).\n\\label{eq:generator_grad}\n\\end{aligned}')
('4.0', '\\begin{aligned}\n\\Tilde{\\epsilon}_{\\theta}(x_t) &= {\\epsilon}_{\\theta}(x_t) + s{\\sigma}_t {\\nabla}_{x_t} \\mathcal{L}_\\mathcal{G}\n\\nonumber\\\\&= {\\epsilon}_{\\theta}(x_t) - s{\\sigma}_t {\\nabla}_{x_t} ( \\mathrm{log}\\: p(x_t|y) - \\mathrm{log}\\: p(x_t|\\hat{y}) )\n\\nonumber\\\\& = {\\epsilon}_{\\theta}(x_t) + s ( \\epsilon_{\\theta}(x_t) - \\hat{\\epsilon}_{\\theta}(x_t) ) = {\\epsilon}_{\\theta}(x_t) + s \\hat{\\Delta}_t.\n\\label{eq:PAG-derivation}\n\\end{aligned}')
('4.0', '\\epsilon_\\theta(x_t)')
('4.0', '-\\sigma_t{\\nabla}_{x_t} \\mathrm{log}\\, p(x_t|y)')
('4.0', '\\hat{y}')
('4.0', '\\hat{\\epsilon}_\\theta(x_t)')
('4.0', '\\hat{\\epsilon}_\\theta(x_t)')
('4.0.0', '\\begin{aligned}\n\\Tilde{\\epsilon}_{\\theta}(x_t, c) = {\\epsilon}_{\\theta}(x_t,c) + s ( \\epsilon_{\\theta}(x_t,c) - \\hat{\\epsilon}_{\\theta}(x_t,c) ).\n\\end{aligned}')
('4.0.0', '\\hat{\\epsilon}_{\\theta}(x_t,c)')
('4.0.0', '{\\epsilon}_{\\theta}(x_t, \\phi)')
('4.1', '\\hat{x}_0')
('4.1', '\\hat{\\Delta}_t = {\\epsilon}_{\\theta}(x_t) - \\hat{\\epsilon}_{\\theta}(x_t)')
('4.1', '{\\epsilon}_{\\theta}(x_t)')
('4.1', '{\\hat{\\epsilon}}_{\\theta}(x_t)')
('4.1', '\\hat{\\Delta}_t')
('4.1', '\\hat{\\epsilon}_\\theta(x_t)')
('4.1.0', '\\mathbf{A}_t')
('4.1.0', '\\mathrm{Softmax}({Q_t}{K^T_t}/\\sqrt{d})')
('4.1.0', '\\mathbf{I}')
('4.1.0', 'Q_t \\in \\mathbb{R}^\n{(h \\times w) \\times d}')
('4.1.0', 'K_t \\in \\mathbb{R}^{(h \\times w) \\times d}')
('4.1.0', 'V_t \\in \\mathbb{R}^{(h \\times w) \\times d}')
('4.1.0', 't')
('4.1.0', 'h')
('4.1.0', 'w')
('4.1.0', 'd')
('4.1.0', '\\label{equ:attention}\n\\mathrm{SA}(Q_t, K_t, V_t) = \\underbrace{\\mathrm{Softmax}\\left(\\frac{{Q_t}{K^T_t}}{\\sqrt{d}}\\right)}_\\textit{structure}\\overbrace{V_t}^\\textit{appearance}=\\mathbf{A}_t V_t,')
('4.1.0', 'V_t')
('4.1.0', 'V_t')
('4.1.0', '\\mathbf{A}_t = \\mathrm{Softmax}({Q_t}{K^T_t}/\\sqrt{d}) \\in \\mathbb{R}^{hw \\times hw}')
('4.1.0', '\\mathbf{I}\\in \\mathbb{R}^{hw \\times hw}')
('4.1.0', '\\label{equ:psa_attention}\n\\mathrm{PSA}(Q_t, K_t, V_t) = \n\\mathbf{I}V_t=\nV_t,')
('4.1.0', "\\mathbf{Model}(x_t), \\mathbf{Model'}(x_t):")
('4.1.0', '\\textrm{Diffusion model with self-attention and }')
('4.1.0', '\\textrm{perturbed self-attention (PSA), respectively.}')
('4.1.0', 's \\textrm{: guidance scale,}\\, \\Sigma_t \\textrm{: variance}')
('4.1.0', 'x_T \\sim \\mathcal{N}(0, I)')
('4.1.0', "{\\epsilon_t} \\leftarrow  \\mathbf{Model}(x_t), {\\hat{\\epsilon_t}} \\leftarrow \\mathbf{Model'}(x_t)")
('4.1.0', '\\tilde{\\epsilon}_t \\leftarrow \\epsilon_t + s(\\epsilon_t - \\hat{{\\epsilon_t}})')
('4.1.0', 'x_{t-1} \\sim \\mathcal{N}(\\frac{1}{\\sqrt{\\overline{\\alpha}_t}} (x_t - \\frac{1-\\alpha_t}{\\sqrt{1-\\overline{\\alpha}_t}}\\tilde{\\epsilon}_t), \\Sigma_t)')
('4.1.0', 'x_0')
('4.1.0', '\\mathrm{SA}')
('4.1.0', '\\mathrm{PSA}')
('4.1.0', '\\epsilon_{\\theta}(x_t)')
('4.1.0', '{\\hat{\\epsilon}}_{\\theta}(x_t)')
('4.1.0', 'x_t')
('4.1.0', '\\epsilon_{\\theta}(\\cdot)')
('4.1.0', '{\\hat{\\epsilon}}_{\\theta}(\\cdot)')
('4.1.0', '\\tilde{\\epsilon}_\\theta(x_t)')
('4.2', '\\hat{x}_0')
('4.2', '{\\epsilon}_{\\theta}(x_t)')
('4.2', '\\hat{\\epsilon}_{\\theta}(x_t)')
('4.2', '\\tilde{\\epsilon}_{\\theta}(x_t)')
('4.2', '\\hat{\\Delta}_t = {\\epsilon}_{\\theta}(x_t) - \\hat{\\epsilon}_{\\theta}(x_t)')
('4.2', '\\hat{\\epsilon}_{\\theta}(x_t)')
('4.2', '\\hat{\\Delta}_t')
('4.2', '\\hat{\\Delta}_t')
('4.2', '\\epsilon_\\theta(x_t)')
('4.2', '\\hat{\\Delta}_t')
('5', '\\downarrow')
('5', '\\uparrow')
('5', '\\uparrow')
('5', '\\uparrow')
('5', '\\times')
('5', '\\times')
('5.1', '\\times')
('5.2', '\\downarrow')
('5.2', '\\uparrow')
('5.2.1', '\\uparrow')
('5.2.1', '\\uparrow')
('5.3.0', 'x')
('5.3.0', 'y = \\mathcal{A}(x) + n')
('5.3.0', '\\mathcal{A}(\\cdot)')
('5.3.0', 'n')
('5.3.0', '\\times')
('5.3.0', '\\times')
('5.4.0', '\\times')
('5.4.0', '-\\infty')
('5.4.0', '{{Q_t}{K^T_t}}/{\\sqrt{d}}')
('5.4.0', '\\mathrm{Softmax}')
('7.0.0', '\\times')
('7.0.0', 's=1.0')
('7.0.0', '\\mathrm{Softmax}({Q_tK^T_t}/{\\sqrt{d}}) \\in \\mathbb{R}^{hw \\times hw}')
('7.0.0', '\\mathbf{I} \\in \\mathbb{R}^{hw \\times hw}')
('7.0.0', 'Q_t')
('7.0.0', 'K_t')
('7.0.0', 't')
('7.0.1', 's=3.0')
('7.0.1', 's')
('7.0.2', '\\hat{\\Delta}_t')
('7.1.0', 's=')
('7.1.0', 's=')
('7.1.0', 'w=')
('7.1.0', 'w=')
('7.1.0', 's=')
('7.1.0', 's=')
('7.1.0', 'w=')
('7.1.1', 's=')
('7.1.1', 'w=')
('7.1.1', 'w=')
('7.1.1', 's=')
('7.1.2', 'w=')
('7.1.3', '\\Tilde{\\epsilon}_{\\theta}(x_t,c)')
('7.1.3', '\\Tilde{\\epsilon}_{\\theta}(x_t,c) = {\\epsilon}_{\\theta}(x_t,c) + w ( \\epsilon_{\\theta}(x_t, c) - \\epsilon_{\\theta}(x_t,\\phi) ) + s ( \\epsilon_{\\theta}(x_t,c) - \\hat{\\epsilon}_{\\theta}(x_t,c) ),')
('7.1.3', 'w')
('7.1.3', 's')
('7.1.3', 'w')
('7.1.3', 's')
('7.1.3', '{\\epsilon}_{\\theta}(x_t,c)')
('7.1.3', '{\\epsilon}_{\\theta}(x_t,\\phi)')
('7.1.3', '\\hat{\\epsilon}_{\\theta}(x_t,c)')
('7.2', '\\eta')
('7.2', '\\gamma')
('7.2', '\\eta=1.0')
('7.2', '\\gamma=0.1')
('7.2', '\\epsilon_\\theta(\\boldsymbol{z}_t)')
('7.2', '\\Tilde{\\epsilon}_\\theta(\\boldsymbol{z}_t)')
('7.2', '\\hat{\\boldsymbol{z}}_0')
('7.4', '\\times')
('7.5', '\\downarrow')
('7.5', '\\uparrow')
('8.2.0', '\\times')
('8.2.0', '\\times')
('8.2.1', '\\times')
('9.0', '\\epsilon_\\theta(\\boldsymbol{z}_t)')
('9.0', '\\hat{\\boldsymbol{z}}_0')
('9.0', '\\times')
('9.1', '\\times')
('10.0', '\\mathrm{Softmax}({Q_t}{K^T_t}/\\sqrt{d}) \\in \\mathbb{R}^{hw \\times hw}')
('10.0', '\\sigma=0.1')
('10.0', 's=1.0')
('10.1', '\\times')
('10.1', 's=1.0')
('10.1', 's=')
('11.0.1', '\\hat{\\epsilon}_\\theta')
('11.0.2', '\\hat{\\epsilon}_\\theta')
('11.0.2', '\\hat{\\epsilon}_\\theta')
('11.1', '\\hat{\\Delta}_t={\\epsilon}_{\\theta}(x_t) - {\\hat{\\epsilon}}_{\\theta}(x_t)')
('11.1', '\\hat{\\Delta}_t ={\\epsilon}_{\\theta}(x_t) - {\\hat{\\epsilon}}_{\\theta}(x_t)')
('11.1', '\\hat{\\Delta}_t')
('11.1', '\\hat{\\Delta}_t')
('11.1', '\\Delta_t= {\\epsilon}_{\\theta}(x_t,c) - {{\\epsilon}}_{\\theta}(x_t,\\phi)')
('11.1', '\\Delta_t = {\\epsilon}_{\\theta}(x_t,c) - {{\\epsilon}}_{\\theta}(x_t,\\phi)')
('11.1', '\\Delta_t')
('11.1', '+')
('11.1', '+')
('11.2.0', 'p_\\mathrm{im}')
('11.2.0', '{h}_t')
('11.2.0', '{ x}_t')
('11.2.0', '{h}_t')
('11.2.0', '{x}_t')
('11.2.0', '\\bar{x}_t')
('11.2.0', '{ h}_t')
('11.2.0', '{ x}_t')
('11.2.0', '\\bar{x}_t=\\tilde{x_t}')
('11.2.0', '{h}_t = {x}_t - \\tilde{x}_t')
('11.2.0', '\\tilde{x}_t')
('11.2.0', '{x}_t')
('11.2.0', '\\hat{x}_0')
('11.2.0', 'x_t')
('11.2.0', 'G_\\sigma')
('11.2.0', '\\tilde{x}_0 = \\hat{x}_0 * G_\\sigma')
('11.2.0', '*')
('11.2.0', '\\epsilon_\\theta(x_t)')
('11.2.0', '\\tilde{\\epsilon}(\\bar{x}_t, h_t) = \\epsilon_\\theta(\\bar{x}_t, h_t)-s\\sigma_t\\nabla_{\\bar{x}_t}\\log p_{\\textrm{im}}(h_t|\\bar{x}_t)')
('11.2.0', '\\hat{\\epsilon}_\\theta(\\cdot)')
('11.2.0', '\\times')
('11.2.1', '\\sigma')
