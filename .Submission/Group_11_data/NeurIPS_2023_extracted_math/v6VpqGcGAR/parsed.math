('0.0.1.0.0', '\\rho')
('0.0.1.0.0', '\\mathcal{D}')
('0.0.1.0.0', 'N')
('0.0.1.0.0', '\\mathcal{S}')
('0.0.1.0.0', '\\mathcal{A}')
('0.0.1.0.0', 'T')
('0.0.1.0.0', 'R')
('0.0.1.0.0', '\\tau_t=( x_1, \\dots, x_{t}) \\in \\mathcal{S}')
('0.0.1.0.0', 'x_i \\in \\rho')
('0.0.1.0.0', 'N')
('0.0.1.0.0', 'a \\in \\mathcal{A}\\subseteq \\rho')
('0.0.1.0.0', '\\tau_t=(x_1,\\ldots,x_t)')
('0.0.1.0.0', 'a')
('0.0.1.0.0', '\\tau_{t+1}=T(\\tau_t, a)=(x_1,\\ldots,x_t, a)')
('0.0.1.0.0', '\\mathcal{S}^\\ast \\subseteq \\mathcal{S}')
('0.0.1.0.0', 'R:\\mathcal{S}^\\ast \\to \\mathbb{R}')
('0.0.1.0.0', 'R')
('0.0.1.0.0', '\\pi_\\theta')
('0.0.1.0.0', '\\theta')
('0.0.1.0.0', '\\rho\\sim \\mathcal{D}')
('0.0.1.0.0', 'a \\in \\mathcal{A}')
('0.0.1.0.0', '\\pi_\\theta(\\makebox[1ex]{\\textbf{$\\cdot$}}\\mid \\rho, \\tau_t)')
('0.0.1.0.0', '\\pi_\\theta')
('0.0.1.0.0', 'J(\\theta) \\doteq \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau\\sim \\pi_{\\theta}, \\rho} R(\\tau)')
('0.0.1.0.0', '\\theta')
('0.0.1.0.0', '\\theta')
('0.0.1.0.0', '\\nabla_\\theta J(\\theta) = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau\\sim \\pi_{\\theta}, \\rho} (R(\\tau) - b_\\rho)\\nabla_\\theta \\log(p_\\theta(\\tau))')
('0.0.1.0.0', 'p_\\theta(\\tau) = \\prod_t \\pi_\\theta(a_{t+1} \\mid \\rho, \\tau_t)')
('0.0.1.0.0', 'b_\\rho')
('0.0.1.0.0', '\\nabla_\\theta J')
('0.0.1.1.0', 'J(\\theta) = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau\\sim \\pi_{\\theta}, \\rho} R(\\tau)')
('0.0.1.1.0', 'K')
('0.0.1.1.0', '\\{\\pi_1, \\dots, \\pi_K\\}')
('0.0.1.1.0', 'J_{\\text{pop}}(\\theta_1, \\dots, \\theta_K) \\doteq \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \n    \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}, \\dots, \\tau_K\\sim \\pi_{\\theta_K}} \\max\\left[R(\\tau_1), \\dots, R(\\tau_K)\\right],')
('0.0.1.1.0', '\\tau_i')
('0.0.1.1.0', '\\pi_{\\theta_i}')
('0.0.1.1.0', 'J_{\\text{pop}}')
('0.0.1.1.0', 'K')
('0.0.1.1.0', '\\nabla J_{\\textnormal{pop}}(\\theta_1, \\theta_2, \\dots, \\theta_K) = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \n    \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}, \\dots, \\tau_K\\sim \\pi_{\\theta_K}}\n    \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla \\log p_{\\theta_{i^{*}}}(\\tau_{i^{*}}),')
('0.0.1.1.0', 'i^{*} = \\mathop{\\mathrm{arg\\,max}}_{i \\in \\{1, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr]')
('0.0.1.1.0', 'i^{**} = \\mathop{\\mathrm{arg\\,max}}_{i \\neq i^{*}} \\bigl[R(\\tau_i)\\bigr]')
('0.0.1.1.0', 'K')
('0.0.1.1.0', '\\theta_1 = \\theta_2 = \\dots = \\theta_K')
('0.0.1.1.0', '\\nabla J_{\\textnormal{pop}}(\\theta) = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \n    \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta}, \\dots, \\tau_K\\sim \\pi_{\\theta}}\n    \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla \\log p_{\\theta}(\\tau_{i^{*}}),')
('0.0.1.1.0', 'R(\\tau_{i^{**}})')
('0.0.1.1.0', 'i^*')
('0.0.1.1.0', 'i^{**}')
('0.0.1.1.0', 'R(\\tau_{i^*}) - R(\\tau_{i^{**}})')
('0.0.1.1.0.0', 'K')
('0.0.1.1.0.0', 'K')
('0.0.1.1.0.1', 'h_\\psi')
('0.0.1.1.0.1', '\\rho')
('0.0.1.1.0.1', '\\omega')
('0.0.1.1.0.1', '\\rho')
('0.0.1.1.0.1', 'q_\\phi')
('0.0.1.1.0.1', '\\omega')
('0.0.1.1.0.1', '\\tau_t')
('0.0.1.1.0.1', 'K')
('0.0.1.1.0.1', 'h_\\psi')
('0.0.1.1.0.1', 'q_{\\phi_i}')
('0.0.1.1.0.1', 'i\\in \\{1,\\ldots,K\\}')
('0.0.2.1.0', 'n')
('0.0.2.1.0.0', '\\rho')
('0.0.2.1.0.0', 'P\\in [1, N]')
('0.0.2.1.0.0', 'N')
('0.0.2.1.0.0', 'n=100')
('0.0.2.1.0.0', 'n=100')
('0.0.2.1.0.0', 'n\\in\\{125,150\\}')
('0.0.2.1.0.1', 'r')
('0.0.2.1.0.1', 'r')
('0.0.2.1.0.1', 'r')
('0.0.2.1.0.2', '\\ast')
('0.0.2.1.0.2', 'n=100')
('0.0.2.1.0.2', 'n=100')
('0.0.2.1.0.2', 'n \\in \\{125, 150\\}')
('0.0.2.2.0.2', '*')
('1.0.0', '10\\%')
('1.0.0.0', 'K')
('1.0.0.0', 'K')
('1.0.0.0', 'K')
('1.0.0.0', 'P')
('1.0.0.0', 'P\\times K')
('1.0.0.0', 'P')
('1.0.1.0', 'K')
('1.0.1.0', 'J_{\\text{pop}}(\\theta_1, \\theta_2, \\dots, \\theta_n) \\doteq \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \n    \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}, \\dots, \\tau_K\\sim \\pi_{\\theta_K}} \\max\\left[R(\\tau_1), \\dots, R(\\tau_K)\\right].')
('1.0.1.0', '\\nabla J_{\\textnormal{pop}}(\\theta_1, \\theta_2, \\dots, \\theta_n) = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \n    \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}, \\dots, \\tau_K\\sim \\pi_{\\theta_K}}\n    \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla \\log p_{\\theta_{i^{*}}}(\\tau_{i^{*}}),')
('1.0.1.0', '\\begin{aligned}\ni^{*} & = \\mathop{\\mathrm{arg\\,max}}\\bigl[R(\\tau_1), \\dots, R(\\tau_K)\\bigr], \n& \\text{(index of the best trajectory)} \\\\\ni^{**} & = \\mathop{\\mathrm{arg\\,second\\,max}}\\bigl[R(\\tau_1), \\dots, R(\\tau_K)\\bigr], \n& \\text{(index of the second best trajectory)}\n\\end{aligned}')
('1.0.1.0', '\\theta_1')
('1.0.1.0', '\\begin{aligned}\n    \\nabla_{\\theta_1} J_{\\textnormal{pop}}(\\theta_1, \\theta_2, \\dots, \\theta_K) &=     \\nabla_{\\theta_1} \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}, \\dots, \\tau_K\\sim \\pi_{\\theta_K}} \\max_{i \\in \\{ 1, 2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\\\\n    & = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\max_{i \\in \\{ 1, 2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\log p(\\tau_{1}, \\dots, \\tau_{K}) \\\\\n    & = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\max_{i \\in \\{ 1, 2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\log (\\pi_{\\theta_1}(\\tau_{1}) \\dots \\pi_{\\theta_K}(\\tau_{K})) \\\\\n    & = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\max_{i \\in \\{ 1, 2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} (\\log \\pi_{\\theta_1}(\\tau_{1}) + \\dots + \\log \\pi_{\\theta_K}(\\tau_{K})) \\\\\n    & = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\max_{i \\in \\{ 1, 2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1}), \\label{equ:first_derivation}\n\\end{aligned}')
('1.0.1.0', '\\rho')
('1.0.1.0', '\\tau_2, \\dots, \\tau_K')
('1.0.1.0', '\\begin{aligned}\n    \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}} \\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1}) \n    &= \\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}} \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1})\\\\\n     &= \\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\mathbb{E}_{\\tau_1 \\sim \\pi_{\\theta_1}} \\frac{\\nabla_{\\theta_1} \\pi_{\\theta_1}(\\tau_{1})}{\\pi_{\\theta_1}(\\tau_1)}\\\\\n     &= \\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\sum_{\\tau_1} \\nabla_{\\theta_1} \\pi_{\\theta_1}(\\tau_{1})\\\\\n      &= \\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\sum_{\\tau_1} \\pi_{\\theta_1}(\\tau_{1})\\\\\n    &= \\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} 1 = 0 \\\\\n\\end{aligned}')
('1.0.1.0', '\\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr]')
('1.0.1.0', '\\max_{i \\in \\{2, \\dots, K\\}} \\bigl[R(\\tau_i)\\bigr]')
('1.0.1.0', '\\theta_1')
('1.0.1.0', '\\begin{aligned}\n    \\nabla_{\\theta_1} J_{\\textnormal{pop}}(\\theta_1, \\theta_2, \\dots, \\theta_K) &= \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\max_{i \\in \\{ 1, 2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1}), \\\\\n     &= \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_2, \\dots, \\tau_K} \\mathbb{E}_{\\tau_1} \\max_{i \\in \\{ 1, 2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr] \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1}), \\\\\n     &= \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_2, \\dots, \\tau_K} \\mathbb{E}_{\\tau_1} \\left(\\max_{i \\in \\{ 1, 2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr] - \\max_{i \\in \\{2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr]\\right) \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1}), \\\\\n      &= \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_2, \\dots, \\tau_K} \\mathbb{E}_{\\tau_1} \\mathbbm{1}_{i^{*} = 1}  \\bigr(R(\\tau_{1}) - R(\\tau_{i^{**}})\\bigr) \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_{1}), \\label{equ:max_trick}\\\\\n        &= \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\mathbbm{1}_{i^{*} = 1}  \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla_{\\theta_1} \\log \\pi_{\\theta_1}(\\tau_1). \\\\\n\\end{aligned}')
('1.0.1.0', '\\left(\\max_{i \\in \\{ 1, 2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr] - \\max_{i \\in \\{2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr]\\right)')
('1.0.1.0', '\\tau_1')
('1.0.1.0', 'R(\\tau_1) - \\max_{i \\in \\{2, \\dots, K\\}}  \\bigl[R(\\tau_i)\\bigr] = R(\\tau_1) - R(\\tau_{i^{**}})')
('1.0.1.0', 'j \\in \\{1, \\dots, K\\}')
('1.0.1.0', '\\nabla_{\\theta_j} J_{\\textnormal{pop}}(\\theta_1, \\theta_2, \\dots, \\theta_K) = \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\mathbbm{1}_{i^{*} = j}  \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla_{\\theta_j} \\log \\pi_{\\theta_{j}}(\\tau_{j}).')
('1.0.1.0', '\\begin{aligned}\n    \\nabla_{\\theta} &= \\sum_{j=1}^{n} \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\mathbbm{1}_{i^{*} = j}  \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla_{\\theta_j} \\log \\pi_{\\theta_{j}}(\\tau_{j}), \\\\\n    \\nabla_{\\theta} &= \\mathbb{E}_{\\rho\\sim \\mathcal{D}} \\mathbb{E}_{\\tau_1, \\dots, \\tau_K} \\bigr(R(\\tau_{i^*}) - R(\\tau_{i^{**}})\\bigr) \\nabla_{\\theta_{i^*}} \\log \\pi_{\\theta_{i^*}}(\\tau_{i^*}), \\\\\n\\end{aligned}')
('1.0.3', 'K')
('1.0.3', 'K')
('1.0.3.0', '200 \\times 8 \\times N')
('1.0.3.0', 'N')
('1.0.3.0.0', '0.002\\%')
('1.0.4.0.0', 'n')
('1.0.4.0.0', '[0,1]^2')
('1.0.4.0.0.1', '\\mu = 10^{-4}')
('1.0.4.0.0.1', 'L_2')
('1.0.4.0.0.1', '10^{-6}')
('1.0.4.0.0.1', 'P')
('1.0.4.0.0.1', 'P\\in \\{20, 50, 100\\}')
('1.0.4.0.0.3', '47\\%')
('1.0.4.0.0.3', '\\%')
('1.0.4.0.0.3', '4 \\%')
('1.0.4.1.0', 'n')
('1.0.4.1.0', '[0,1]^2')
('1.0.4.1.0', '\\{\\frac{1}{D}, \\frac{2}{D}, \\dots, \\frac{9}{D}\\}')
('1.0.4.1.0', 'D = 50')
('1.0.4.1.0', 'D=55')
('1.0.4.1.0', 'D=60')
('1.0.4.1.0.1', 'P')
('1.0.4.1.0.1', 'P\\in\\{20, 50, 100\\}')
('1.0.4.2.0.0', '[0, 1]')
('1.0.4.2.0.0', '25')
('1.0.4.2.0.3', 'P')
('1.0.4.2.0.3', 'P\\in\\{20, 50, 100\\}')
('1.0.4.3.0', 'N')
('1.0.4.3.0', 'N')
('1.0.4.3.0', 'N')
('1.0.4.3.0.0', 'N')
('1.0.4.3.0.0', 'N')
('1.0.4.3.0.0', '[1, 99)')
('1.0.4.3.0.3', 'N = 10')
('1.0.4.3.0.3', '10\\times10')
('1.0.4.3.0.3', '98 \\times N^3')
('1.0.4.3.0.3', '1250')
