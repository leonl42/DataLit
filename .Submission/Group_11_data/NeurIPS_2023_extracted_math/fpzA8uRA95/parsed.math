('1', '\\gamma')
('1', '4')
('2.1', '(\\mathcal{X},d_{\\infty})')
('2.1', '\\mathcal{X}')
('2.1', "d_{\\infty}({x},{x}')=\\|{x}-{x}'\\|_\\infty")
('2.1', "\\mathcal{B}_\\epsilon[{x}] = \\{{x}'\\in \\mathcal{X}\\mid d_{\\infty}({x},{x}')\\le\\epsilon\\}")
('2.1', '\\epsilon>0')
('2.1', '{x}\\in \\mathcal{X}')
('2.1.0', 'f_\\theta: \\mathcal{X}\\rightarrow \\mathcal{Z}')
('2.1.0', '\\theta')
('2.1.0', 'g:\\mathcal{Z}\\rightarrow \\mathcal{V}')
('2.1.0', '\\tau_i, \\tau_j: \\mathcal{X}\\rightarrow \\mathcal{X}')
('2.1.0', '\\mathcal{T}')
('2.1.0', 'B \\sim \\mathcal{X}^\\beta')
('2.1.0', '\\beta')
('2.1.0', 'B^\\prime = \\{ \\tau_i(x_k),  \\tau_j(x_k) \\mid \\forall x_k \\in B \\}')
('2.1.0', '2\\beta')
('2.1.0', 'h_\\theta(\\cdot) = g \\circ f_\\theta(\\cdot)')
('2.1.0', 'x_k^u = \\tau_u(x_k)')
('2.1.0', 'x_k \\sim \\mathcal{X}')
('2.1.0', 'u \\in \\{i,j\\}')
('2.1.0', '(x_k^i, x_k^j)')
('2.1.0', '\\begin{aligned}\n     \\ell_\\mathrm{CL}(x_k^i,x_k^j; \\theta)\\!=\\!-\\! \\sum\\limits_{u \\in \\{i,j\\}} \\! \\log \\frac{e^{\\mathrm{sim}\\left(h_\\theta(x_k^i), h_\\theta(x_k^j) \\right)/t}}{\\sum\\limits_{x \\in B^\\prime \\setminus \\{x_k^u\\}} e^{\\mathrm{sim}\\left( h_\\theta(x_k^u), h_\\theta(x) \\right)/t}}, \\nonumber\n\\end{aligned}')
('2.1.0', '\\mathrm{sim}(p,q) = p^\\top q / \\| p \\|\\| q \\|')
('2.1.0', 't>0')
('2.1.0', 'X \\sim \\mathcal{X}^N')
('2.1.0', 'N')
('2.1.0', '\\mathcal{L}_\\mathrm{ACL}(X; \\theta) = \\sum_{k=1}^N  \\ell_\\mathrm{ACL}(x_k; \\theta)')
('2.1.0', '\\begin{aligned}\n \\ell_\\mathrm{ACL}(x_k;\\theta) = \n    \\big( \\mathop{\\max}_{\n        {\\Large \\tilde{{x}}_{k}^i \\in \\mathcal{B}_\\epsilon[x_k^i]}\n        \\atop\n        {\\Large \\tilde{{x}}_{k}^j \\in \\mathcal{B}_\\epsilon[x_k^j]}\n    }\n    (1 + \\omega) \\cdot \\ell_\\mathrm{CL}(\\tilde{{x}}_{k}^i, \\tilde{{x}}_{k}^j; \\theta) \\big) +  (1 - \\omega) \\cdot \\ell_\\mathrm{CL}(x_k^i, x_k^j; \\theta), \\nonumber \n\\end{aligned}')
('2.1.0', '\\omega \\in [0,1]')
('2.1.0', '\\tilde{{x}}_k^i')
('2.1.0', '\\tilde{{x}}_k^j')
('2.1.0', '\\epsilon')
('2.1.0', 'x_k^i')
('2.1.0', 'x_k^j')
('2.1.0', '\\omega = 0')
('2.1.0', '\\omega')
('2.1.0', '(x^{i,(0)}, x^{j,(0)})')
('2.1.0', 'T \\in \\mathbb{N}')
('2.1.0', '\\rho > 0')
('2.1.0', '\\epsilon \\geq 0')
('2.1.0', '\\tau=0')
('2.1.0', 'T-1')
('2.1.0', '\\begin{aligned}\n    & x^{i,(\\tau+1)} \\! = \\! \\Pi_{\\mathcal{B}_\\epsilon[x^{i,(0)}]} \\big( x^{i,(\\tau)} +\\rho \\mathop{\\mathrm{sign}}(\\nabla_{x^{i,(\\tau)}} \\ell_\\mathrm{CL}(x^{i,(\\tau)}, x^{j,(\\tau)})  \\big ), \\nonumber \\\\\n    & x^{j,(\\tau+1)} \\! = \\! \\Pi_{\\mathcal{B}_\\epsilon[x^{j,(0)}]} \\big( x^{j,(\\tau)} +\\rho \\mathop{\\mathrm{sign}}(\\nabla_{x^{j,(\\tau)}} \\ell_\\mathrm{CL}(x^{i,(\\tau)}, x^{j,(\\tau)})  \\big ), \\nonumber\n\\end{aligned}')
('2.1.0', '\\Pi_{\\mathcal{B}_\\epsilon[x]}')
('2.1.0', '\\epsilon')
('2.1.0', 'x')
('2.1.0', '\\theta')
('2.1.0', 'g')
('2.1.0', 'g')
('2.1.0', 'f_\\theta')
('3.0', 'x \\sim \\mathcal{X}')
('3.0', 'g \\circ f_\\theta: \\mathcal{X}\\rightarrow \\mathcal{V}')
('3.0', 'f_\\theta')
('3.0', 'g')
('3.0', '\\ell_\\mathrm{RD}(x;\\theta)')
('3.0', '\\begin{aligned}\n\\label{eq:robust_loss}\n     \\ell_{\\mathrm{RD}}(x; \\theta) = d(g \\circ f_\\theta(\\tilde{{x}}), g \\circ f_\\theta(x)) \\quad \n    \\mathrm{s.t.}\\quad \\tilde{{x}}= \\mathop{\\mathrm{\\mathrm{arg\\,max }}}_{x^{\\prime} \\in \\mathcal{B}_\\epsilon[x]}  d(g \\circ f_\\theta(x^{\\prime}), g \\circ f_\\theta(x)), \n\\end{aligned}')
('3.0', '\\tilde{{x}}')
('3.0', '\\epsilon')
('3.0', 'x')
('3.0', 'd(\\cdot, \\cdot): \\mathcal{V}\\times \\mathcal{V}\\rightarrow \\mathbb{R}')
('3.0', 'U')
('3.0', '\\mathcal{L}_\\mathrm{RD}(U;\\theta) = \\sum_{x_i \\in U} \\ell_{\\mathrm{RD}}(x_i; \\theta)')
('3.1', 'X \\sim \\mathcal{X}^N')
('3.1', 'U \\sim \\mathcal{X}^M')
('3.1', 'M \\ll N')
('3.1', 'S^*')
('3.1', '\\begin{aligned}\n\\label{eq:RCS-obj}\n    S^* & = \\mathop{\\mathrm{\\mathrm{arg\\,min }}}_{S \\subseteq X, |S|/|X| \\le k} \\mathcal{L}_{\\mathrm{RD}}(U; \\mathop{\\mathrm{\\mathrm{arg\\,min }}}_{\\theta}\\mathcal{L}_\\mathrm{ACL}(S; \\theta)).\n     % \\theta_S  & = ). \\nonumber\n\\end{aligned}')
('3.1', 'k\\in (0,1]')
('3.1', '|S^*| \\le kN')
('3.1', '\\mathcal{L}_\\mathrm{RD}(U)')
('3.1', '\\mathcal{L}_\\mathrm{ACL}(S)')
('3.1', 'S^*')
('3.1', '\\mathcal{L}_\\mathrm{ACL}(S^*)')
('3.1', '\\mathcal{L}_\\mathrm{RD}(U)')
('3.1', '\\begin{aligned}\n\\label{eq:RCS-one-step}\n    S^* = \\mathop{\\mathrm{\\mathrm{arg\\,min }}}_{S \\subseteq X, |S|/|X| \\leq k} \\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)),\n\\end{aligned}')
('3.1', '\\eta>0')
('3.1', 'G: 2^X \\rightarrow \\mathbb{R}')
('3.1', '\\begin{aligned}\n\\label{eq:set_func}\n    G_\\theta(S \\subseteq X) \\triangleq -\\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)).\n\\end{aligned}')
('3.1', '|S^*| = k |X|')
('3.1', '\\begin{aligned}\n\\label{eq:RCS-max}\n    S^* = \\mathop{\\mathrm{\\mathrm{arg\\,max }}}_{S \\subseteq X, |S|/|X| = k} G_\\theta(S).  \n\\end{aligned}')
('3.2', '|S|')
('3.2', 'kN')
('3.2', 'S')
('3.2', 'G_\\theta(S)')
('3.2', '\\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)')
('3.2', '\\binom{N}{kN}')
('3.2', '\\gamma')
('3.2', '\\lceil N/\\beta \\rceil + \\lfloor kN/\\beta \\rfloor \\ll \\binom{N}{kN}')
('3.2', '\\beta')
('3.2', '\\gamma')
('3.2', 'G: 2^X \\rightarrow \\mathbb{R}')
('3.2', 'G')
('3.2', 'G(x|A) \\triangleq G(A \\cup \\{x\\}) - G(A)')
('3.2', 'A \\subset')
('3.2', 'X')
('3.2', 'x \\in X \\setminus A')
('3.2', 'G')
('3.2', 'G(x|A) \\geq 0')
('3.2', 'A \\subset X')
('3.2', 'x \\in X \\setminus A')
('3.2', 'G')
('3.2', '\\gamma')
('3.2', '\\sum_{x \\in B} G(x|A) \\geq \\gamma [G(A \\cup B) - G(A)]')
('3.2', '\\gamma \\in [0,1]')
('3.2', 'A,B \\subseteq X')
('3.2', '\\ell_\\mathrm{RD}')
('3.2', '\\ell_\\mathrm{ACL}')
('3.2', '\\theta')
('3.2', '\\begin{aligned}\n   \\| \\frac{\\partial}{\\partial_\\theta} \\ell_{\\mathrm{RD}}(x;\\theta) \\| \\leq L_1,  \\|\\frac{\\partial}{\\partial_\\theta} \\ell_{\\mathrm{ACL}}(x;\\theta) \\| \\leq  L_2, \n   \\|\\frac{\\partial^2}{\\partial_\\theta} \\ell_{\\mathrm{RD}}(x;\\theta) \\| \\leq  L_3, \\|\\frac{\\partial^2}{\\partial_\\theta} \\ell_{\\mathrm{ACL}}(x;\\theta) \\| \\leq  L_4, \\nonumber\n  \n\\end{aligned}')
('3.2', 'L_1')
('3.2', 'L_2')
('3.2', 'L_3')
('3.2', 'L_4')
('3.2', '\\hat{G}_\\theta(S)')
('3.2', '\\gamma')
('3.2', '\\hat{G}_\\theta(S)\\triangleq G_\\theta(S)+|S|\\sigma')
('3.2', '\\sigma = 1+\\nu_1+\\nu_2L_2+\\eta M L_2 (L_1 + \\eta k N (L_1L_4 + L_2L_3))')
('3.2', '\\nu_1 \\rightarrow 0^+')
('3.2', '\\nu_2>0')
('3.2', '\\hat{G}_\\theta(S)')
('3.2', '\\gamma')
('3.2', '\\gamma > \\gamma^* = \\frac{1}{2\\sigma-1}')
('3.2', '\\begin{aligned}\n    \\label{eq:proxy_RCS_max}\n        \\hat{S}^* = \\mathop{\\mathrm{\\mathrm{arg\\,max }}}_{S \\subseteq X, |S|/|X| = k} \\hat{G}_\\theta(S).\n    \n\\end{aligned}')
('3.2', '\\theta')
('3.2', 'G^*_\\theta = \\sup_{S \\subseteq X, |S|/|X|=k} G_\\theta(S)')
('3.2', '\\hat{S}^*')
('3.2', '\\begin{aligned}\n          G_\\theta(\\hat{S}^*) \\geq G_\\theta^* - (G_\\theta^* + kN\\sigma) \\cdot e^{-\\gamma^*}. \\nonumber\n    \n\\end{aligned}')
('3.2.0', 'X')
('3.2.0', 'U')
('3.2.0', '\\beta')
('3.2.0', 'g \\circ f_\\theta')
('3.2.0', '\\eta')
('3.2.0', 'k\\in (0,1]')
('3.2.0', 'S')
('3.2.0', 'S \\gets \\emptyset, N \\gets |X|')
('3.2.0', '\\{ B_m\\}_{m=1}^{\\lceil N / \\beta \\rceil}')
('3.2.0', 'q_m \\gets \\nabla_\\theta \\mathcal{L}_\\mathrm{ACL}(B_m; \\theta)')
('3.2.0', 'q_U \\gets \\nabla_\\theta \\mathcal{L}_\\mathrm{RD}(U; \\theta)')
('3.2.0', 'best\\_gain = - \\infty')
('3.2.0', '\\hat{G}(B_m|S) \\gets \\eta q_U^{\\top}q_m')
('3.2.0', 's \\gets m')
('3.2.0', 'best\\_gain \\gets \\hat{G}(B_m|S)')
('3.2.0', 'S \\gets S \\cup B_s')
('3.2.0', 'X \\gets X \\setminus B_s')
('3.2.0', '\\theta \\gets \\theta - \\eta q_s')
('3.2.0.0', '\\lfloor k|X| / \\beta \\rfloor')
('3.2.0.0', 'B')
('3.2.0.0', '\\hat{G}_\\theta(B|S)')
('3.2.0.0', '\\lceil N/\\beta \\rceil')
('3.2.0.0', '\\lfloor kN/\\beta \\rfloor')
('3.2.0.0', '\\lceil N/\\beta \\rceil + \\lfloor kN/\\beta \\rfloor \\ll \\binom{N}{kN}')
('3.2.0.0', '\\begin{aligned}\n\\label{eq:taylor}\n     \\hat{G}_\\theta(B | S) \\approx \\eta \\nabla_\\theta\\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta))^\\top \\nabla_\\theta\\mathcal{L}_{\\mathrm{ACL}}(B; \\theta) + \\beta \\sigma, \n\\end{aligned}')
('3.2.0.0', 'B')
('3.2.0.0', '\\beta')
('3.2.0.0', '\\beta \\sigma')
('3.2.0.0', 'X')
('3.2.0.0', 'U')
('3.2.0.0', 'E')
('3.2.0.0', '\\eta^\\prime')
('3.2.0.0', '\\beta')
('3.2.0.0', 'W')
('3.2.0.0', 'I')
('3.2.0.0', 'k')
('3.2.0.0', '\\eta')
('3.2.0.0', "f_{\\theta'}")
('3.2.0.0', "g \\circ f_{\\theta'}")
('3.2.0.0', 'S \\gets X')
('3.2.0.0', 'W')
('3.2.0.0', '(E-W)')
('3.2.0.0', "\\theta \\gets copy(\\theta')")
('3.2.0.0', 'S \\gets \\mathrm{RCS}(X,U,\\beta, g \\circ f_{\\theta}, \\eta, k)')
('3.2.0.0', 'B_m')
('3.2.0.0', 'S')
('3.2.0.0', "\\theta' \\gets \\theta' - \\eta^\\prime \\nabla_{\\theta'} \\mathcal{L}_\\mathrm{ACL}(B_m; \\theta')")
('3.3', 'I \\in \\mathbb{N}')
('3.3', 'I')
('3.3', 'E \\in \\mathbb{N}')
('3.3.0', 'W')
('3.3.0', '10\\%')
('3.3.0.0', 'g')
('3.3.0.1', 'T')
('3.3.0.1', 'T_\\mathrm{ACL}')
('3.3.0.1', '\\epsilon_\\mathrm{ACL}')
('3.3.0.1', '\\rho_\\mathrm{ACL}')
('3.3.0.1', 'T_\\mathrm{RCS}')
('3.3.0.1', '\\epsilon_\\mathrm{RCS}')
('3.3.0.1', '\\rho_\\mathrm{RCS}')
('3.3.0.1', 'T_\\mathrm{RCS}')
('3.3.0.1', '0 < T_\\mathrm{RCS}\\leq T_\\mathrm{ACL}')
('3.3.0.1', '\\rho_\\mathrm{RCS}= \\frac{\\rho_\\mathrm{ACL}\\cdot T_\\mathrm{ACL}}{T_\\mathrm{RCS}}')
('3.3.0.1', '\\epsilon_\\mathrm{RCS}= \\epsilon_\\mathrm{ACL}')
('4.0', '\\beta=512')
('4.0', '\\eta=0.01')
('4.0', 'T_\\mathrm{RCS}=3')
('4.0', 'W=100')
('4.0', 'I=20')
('4.0', 'k \\in \\{ 0.05, 0.1, 0.2\\}')
('4.0', '\\mathcal{L}_\\mathrm{RD}(\\cdot)')
('4.0.0.1', 'S')
('4.2', '32 \\times 32')
('4.3.0', 'W')
('4.3.0', 'I')
('7.0.0', '\\hat{G}_\\theta(S)\\triangleq G_\\theta(S)+|S|\\sigma')
('7.0.0', '\\sigma = 1+\\nu_1+\\nu_2L_2+\\eta M L_2 (L_1 + \\eta k N (L_1L_4 + L_2L_3))')
('7.0.0', '\\nu_1 \\rightarrow 0^+')
('7.0.0', '\\nu_2>0')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\gamma')
('7.0.0', '\\gamma > \\gamma^* = \\frac{1}{2\\sigma-1}')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\hat{G}_\\theta(x|S)')
('7.0.0', '\\begin{aligned}\n        \\hat{G}_\\theta(x|S) & = \\hat{G}_\\theta(S \\cup \\{ x\\}) - \\hat{G}_\\theta(S) \\nonumber \\\\ \n        & = - \\mathcal{L}_\\mathrm{RD}(U; \\theta-\\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S;\\theta) - \\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\};\\theta)) + \\mathcal{L}_\\mathrm{RD}(U; \\theta-\\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S;\\theta)) + \\sigma \\nonumber \\\\ \n        & \\xlongequal[]{\\text{Taylor expansion}} \\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta-\\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S;\\theta))^\\top \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{e\\}; \\theta) + \\xi_1 (\\theta) + \\sigma  \\nonumber \\\\\n        & \\xlongequal[]{\\text{Taylor expansion}} \\eta \\frac{\\partial}{\\partial_\\theta} \\bigg [\\mathcal{L}_\\mathrm{RD}(U; \\theta) -\\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta)^\\top \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S; \\theta) +  \\xi_2(\\theta) \\bigg]^\\top \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta)  \\nonumber \\\\ \n        & \\qquad \\qquad \\qquad + \\xi_1 (\\theta) + \\sigma  \\nonumber \\\\\n        & = \\eta \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta)^\\top \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta)\n        -\\eta^2 \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta)^\\top \\frac{\\partial^2}{\\partial_\\theta}\\mathcal{L}_\\mathrm{ACL}(S;\\theta) \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\nonumber \\\\\n        & \\quad - \\eta^2 \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S; \\theta)^\\top \\frac{\\partial^2}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U;\\theta) \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) + \\frac{\\partial}{\\partial_\\theta} \\xi_2(\\theta)^\\top \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\nonumber \\\\\n        & \\quad + \\xi_1(\\theta) + \\sigma, \\label{eq:gain_convert}\n    \n\\end{aligned}')
('7.0.0', '\\xi_1 (\\theta) \\rightarrow 0')
('7.0.0', '\\xi_2 (\\theta) \\rightarrow 0')
('7.0.0', '\\mathcal{L}_\\mathrm{RD}(U; \\theta) = \\sum_{x_i \\in U}\\ell_\\mathrm{RD}(x_i; \\theta)')
('7.0.0', '\\mathcal{L}_\\mathrm{ACL}(S; \\theta) = \\sum_{x_i \\in S}\\ell_\\mathrm{ACL}(x_i; \\theta)')
('7.0.0', '|U|=M')
('7.0.0', '|X|=N')
('7.0.0', '\\begin{aligned}\n      % -ML_1 = -|U|L_1 \\leq \n      & \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta) \\| \\leq |U|L_1 = ML_1 ;\\\\\n      % -ML_3 = -|U|L_3 \\leq \n      & \\| \\frac{\\partial^2}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta) \\| \\leq |U|L_3 = ML_3 ;\\\\\n       % -kNL_2 = -k|X|L_2 \\leq -|S|L_2 \\leq \n       & \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S; \\theta) \\| \\leq |S|L_2 \\leq k|X|L_2  = kNL_2;\\\\\n       % -kNL_4 = -k|X|L_4 \\leq -|S|L_4 \\leq \n       & \\| \\frac{\\partial^2}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S; \\theta) \\| \\leq |S|L_4 \\leq k|X|L_4 = kNL_4.\n    \n\\end{aligned}')
('7.0.0', '\\| \\xi_1(\\theta)\\| \\leq \\nu_1')
('7.0.0', '\\| \\frac{\\partial}{\\partial_\\theta} \\xi_2(\\theta)\\| \\leq \\nu_2')
('7.0.0', '\\nu_1 \\rightarrow 0^+')
('7.0.0', '\\nu_2 > 0')
('7.0.0', '\\begin{aligned}\n        \\hat{G}_\\theta(x|S) & \\geq  - \\| \\hat{G}_\\theta(x|S) \\| \\nonumber \\\\\n        & \\geq - \\eta \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\|\n        -\\eta^2 \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta)\\| \\| \\frac{\\partial^2}{\\partial_\\theta}\\mathcal{L}_\\mathrm{ACL}(S;\\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\| \\nonumber \\\\\n        & \\quad - \\eta^2 \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S; \\theta) \\| \\| \\frac{\\partial^2}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U;\\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{e\\}; \\theta) \\| - \\| \\frac{\\partial}{\\partial_\\theta} \\xi_2(\\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta)\\| \\nonumber \\\\\n        & \\quad - \\| \\xi_1(\\theta)\\| + \\sigma \\nonumber \\\\\n        & \\geq -\\eta M L_1 L_2 - \\eta^2 ML_1 kNL_4 L_2 - \\eta^2 kNL_2 ML_3 L_2 - \\nu_2L_2 - \\nu_1 + \\sigma\n        \\nonumber \\\\\n        & \\geq \n        % - \\eta L_1L_2(1 + \\eta MN(L_3+L_4)) - L_2 L_2 - L_1 + \\sigma \n        % -\\eta M L_1 L_2 - \\eta^2 kMN L_2 (L_1L_4 + L_2L_3) - L_2L_2 - L_1 + \\sigma\n        -\\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3)) - \\nu_2L_2 - \\nu_1 + \\sigma.\n        \\nonumber \n        % & \\xlongequal[]{\\sigma = \\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3)) +\\nu_1+\\nu_2L_2+1} 1 > 0\n    \n\\end{aligned}')
('7.0.0', '\\sigma = \\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3)) +\\nu_1+\\nu_2L_2+1')
('7.0.0', '\\begin{aligned}\n        \\label{eq:lower_bound_gain}\n         \\hat{G}_\\theta(x|S) & \\geq 1.\n    \n\\end{aligned}')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\hat{G}_\\theta(x|S) > 0')
('7.0.0', '\\gamma')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\alpha')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\gamma')
('7.0.0', 'G(S): 2^X \\rightarrow \\mathbb{R}')
('7.0.0', '\\alpha')
('7.0.0', '\\gamma')
('7.0.0', '\\gamma \\geq 1 - \\alpha')
('7.0.0', '\\alpha')
('7.0.0', '\\alpha')
('7.0.0', '\\alpha')
('7.0.0', 'x')
('7.0.0', 'A')
('7.0.0', '1 - \\alpha')
('7.0.0', 'x')
('7.0.0', 'B')
('7.0.0', 'A \\subseteq B')
('7.0.0', '\\begin{aligned}\n            \\mathop{\\forall}\\limits_{A,B | A \\subseteq B} G_\\theta(x|A) \\geq (1 - \\alpha) G_\\theta(x|B). \\nonumber\n        \n\\end{aligned}')
('7.0.0', '\\begin{aligned}\n    \\label{eq:lower_bound}\n        \\hat{G}_\\theta(x|S) \\geq 1 = \\underline{\\hat{G}}_\\theta(S).\n    \n\\end{aligned}')
('7.0.0', '\\begin{aligned}\n        \\hat{G}_\\theta(x|S) & \\leq  \\eta \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta}\\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\|\n         + \\eta^2 \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U; \\theta)\\| \\| \\frac{\\partial^2}{\\partial_\\theta}\\mathcal{L}_\\mathrm{ACL}(S;\\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta}\\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\| \\nonumber \\\\\n        & \\quad + \\eta^2 \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(S; \\theta) \\| \\| \\frac{\\partial^2}{\\partial_\\theta} \\mathcal{L}_\\mathrm{RD}(U;\\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta) \\| + \\| \\frac{\\partial}{\\partial_\\theta}  \\xi_2(\\theta) \\| \\| \\frac{\\partial}{\\partial_\\theta} \\mathcal{L}_\\mathrm{ACL}(\\{x\\}; \\theta)\\| \\nonumber \\\\\n        & \\quad + \\| \\xi_1(\\theta)\\| + \\sigma \\nonumber \\\\\n        & \\leq  \\eta M L_1 L_2 + \\eta^2 ML_1 kNL_4 L_2 + \\eta^2 kNL_2 ML_3 L_2 + \\nu_2L_2 + \\nu_1 + \\sigma \\nonumber \\\\\n        & \\leq \\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3)) + \\nu_2L_2  +\\nu_1 + \\sigma .\\nonumber\n        % & \\xlongequal[]{\\sigma = \\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3)) + \\nu_2L_2  +\\nu_1+1} 2\\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3))+ 2\\nu_1 + 2\\nu_2 L_2 + 1 \\nonumber \\\\ \n        % & = 2\\sigma - 1 =  \\overline{\\hat{G}}_\\theta(S) \\label{eq:upper_bound}\n    \n\\end{aligned}')
('7.0.0', '\\sigma = \\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3)) + \\nu_2L_2  +\\nu_1+1')
('7.0.0', '\\begin{aligned}\n        \\hat{G}_\\theta(x|S) \\leq 2\\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3))+ 2\\nu_1 + 2\\nu_2 L_2 + 1 =  2\\sigma - 1 =  \\overline{\\hat{G}}_\\theta(S). \\label{eq:upper_bound}\n    \n\\end{aligned}')
('7.0.0', '\\begin{aligned}\n        \\frac{\\hat{G}_\\theta(x|A)}{\\hat{G}_\\theta(x|B)} \\geq \\frac{\\underline{\\hat{G}}_\\theta(S)}{\\overline{\\hat{G}}_\\theta(S)}\n       & = \\frac{1}{2\\eta M L_2 ( L_1 + \\eta k N (L_1L_4 + L_2L_3))+ 2\\nu_1 + 2\\nu_2 L_2 + 1} \\nonumber\\\\\n       &  = \\frac{1}{2 \\sigma - 1}\n         =  1 - \\alpha^* \\in (0,1).\n    \n\\end{aligned}')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\alpha^*')
('7.0.0', '\\hat{G}_\\theta(S)')
('7.0.0', '\\gamma')
('7.0.0', '\\gamma > \\gamma^* = \\frac{1}{2\\sigma-1}')
('7.1.0', '\\theta')
('7.1.0', 'G^*_\\theta = \\sup_{S \\subseteq X, |S|/|X|=k} G_\\theta(S)')
('7.1.0', '\\hat{S}^*')
('7.1.0', '\\begin{aligned}\n          G_\\theta(\\hat{S}^*) \\geq G_\\theta^* - (G_\\theta^* + kN\\sigma) \\cdot e^{-\\gamma^*}. \\nonumber\n    \n\\end{aligned}')
('7.1.0', '\\alpha')
('7.1.0', '\\alpha')
('7.1.0', 'G(S)')
('7.1.0', '1 - e^{-(1 - \\alpha)}')
('7.1.0', 'G(S)')
('7.1.0', '\\hat{G}_\\theta(S)')
('7.1.0', '\\alpha^*')
('7.1.0', '\\begin{aligned}\n\\label{eq:approx_proxy}\n    \\hat{G}_\\theta(\\hat{S}^*) \\geq (1 - e^{-\\gamma^*}) \\hat{G}_\\theta^* ,\n    % \\xLongleftrightarrow[]{\\hat{G}_\\theta(S) = G_\\theta(S) + |S|\\sigma}\n    % \\hat{G}_\\theta(S^*) - |S^*|\\sigma \\geq (1 - e^{-\\gamma^*}) \\hat{G}_\\theta^* - |S^*| \\sigma ,\n\\end{aligned}')
('7.1.0', '\\hat{G}_\\theta^* = \\sup_{S \\subseteq X, |S|/|X|=k} \\hat{G}_\\theta(S)')
('7.1.0', '\\hat{S}^*')
('7.1.0', '\\hat{G}_\\theta(S) = G_\\theta(S) + |S|\\sigma')
('7.1.0', '\\begin{aligned}\n    \\hat{G}_\\theta^* = \\sup_{S \\subseteq X, |S|/|X|=k} (G_\\theta(S) + |S|\\sigma) = \\sup_{S \\subseteq X, |S|/|X|=k} G_\\theta(S) + k |X| \\sigma = G_\\theta^* + k N\\sigma.\n\\end{aligned}')
('7.1.0', '\\hat{G}_\\theta(\\hat{S}^*) = G_\\theta(\\hat{S}^*) + k N \\sigma')
('7.1.0', '\\begin{aligned}\n    G_\\theta(\\hat{S}^*) \\geq G_\\theta^* - (G_\\theta^* + kN\\sigma) \\cdot e^{-\\gamma^*}. \n\\end{aligned}')
('7.2', '\\begin{aligned}\n     \\hat{G}_\\theta(B | S) & =  \\hat{G}_\\theta(S \\cup B) - \\hat{G}_\\theta(S) \\label{eq:d1} \\\\\n     & = G_\\theta(S \\cup B) + |S \\cup B|\\sigma - (G_\\theta(S) + |S|\\sigma) \\label{eq:d2} \\\\\n     & = G_\\theta(S \\cup B) - G_\\theta(S) + \\beta \\sigma  \\label{eq:disjoint} \\\\\n     & = -\\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S\\cup B; \\theta)) + \\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)) + \\beta \\sigma \\label{eq:d4} \\\\\n    & = -\\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta) - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(B; \\theta) ) \\nonumber \\\\ & \\qquad  + \\mathcal{L}_\\mathrm{RD}(U;\\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)) + \\beta \\sigma \\label{eq:d51} \\\\\n     & = -\\mathcal{L}_\\mathrm{RD}(U; \\theta_S - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(B; \\theta) ) + \\mathcal{L}_\\mathrm{RD}(U; \\theta_S) + \\beta \\sigma \\label{eq:d5} \\\\\n     & \\approx -\\big(\\mathcal{L}_\\mathrm{RD}(U; \\theta_S) - \\eta \\nabla_\\theta\\mathcal{L}_\\mathrm{RD}(U; \\theta_S)^\\top \\nabla_\\theta\\mathcal{L}_{\\mathrm{ACL}}(B; \\theta) + \\xi \\big) + \\mathcal{L}_\\mathrm{RD}(U; \\theta_S) + \\beta \\sigma \\label{eq:d6} \\\\\n     & \\approx \\eta \\nabla_\\theta\\mathcal{L}_\\mathrm{RD}(U; \\theta_S)^\\top \\nabla_\\theta\\mathcal{L}_{\\mathrm{ACL}}(B; \\theta) + \\beta \\sigma, \\label{eq:d7}\n\\end{aligned}')
('7.2', 'B')
('7.2', '\\beta \\in \\mathbb{N}')
('7.2', 'S')
('7.2', 'S')
('7.2', 'B')
('7.2', '\\hat{G}_\\theta(S)')
('7.2', 'S')
('7.2', 'B')
('7.2', 'S \\cup B')
('7.2', 'S')
('7.2', 'B')
('7.2', '\\theta_S = \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)')
('7.2', '\\mathcal{L}_\\mathrm{RD}(U; \\theta_S - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(B; \\theta) )')
('7.2', '\\xi')
('7.2', '\\theta_S')
('7.2', '\\theta - \\eta \\nabla_\\theta \\mathcal{L}_{\\mathrm{ACL}}(S; \\theta)')
('8.1.0', '\\epsilon_\\mathrm{ACL}=8/255')
('8.1.0', '\\alpha_\\mathrm{ACL}= 2/255')
('8.1.0', 'T_\\mathrm{ACL}=5')
('8.1.0', '32 \\times 32')
('8.1.0', '\\beta=512, T_\\mathrm{ACL}=5, \\epsilon_\\mathrm{ACL}=8/255,\\rho_\\mathrm{ACL}=2/255,T_\\mathrm{RCS}=1')
('8.1.0', 't')
('8.1.0', 'W=20')
('8.1.0', 'I=10')
('8.1.0.0', '\\omega')
('8.1.0.0', 'e')
('8.1.0.0', '\\mu_e')
('8.1.0.0', '\\omega_e')
('8.1.0.0', '\\begin{aligned}\n    &\\mu_e = 1 - \\lfloor \\frac{e}{K} \\rfloor \\cdot \\frac{K}{E}, \\quad e \\in \\{0, 1, \\dots, E-1 \\} ,\\nonumber \\\\\n    &\\omega_e = \\nu \\cdot (1 - \\mu_e),  \\quad e \\in \\{0, 1, \\dots, E-1 \\}, \\nonumber\n\\end{aligned}')
('8.1.0.0', 'K=50')
('8.1.0.0', '\\nu=2/3')
('8.1.0.0', 'E=1000')
('8.1.0.1', '8/255')
('8.1.0.1', '2/255')
('8.1.0.2', '32 \\times 32')
('8.1.0.2', '\\epsilon=4.0')
('8.1.0.2', '224 \\times 224')
('8.3', 'k=0.1')
('8.5.0', 'x')
('8.5.0', '\\ell_\\mathrm{RD}(x)')
('8.5.0', 'x')
('8.5.0', '\\ell_\\mathrm{RD}(x)')
('8.5.0.0', 'k=0.2')
('8.5.0.0', 'I=20')
('8.5.0.0', '\\sigma=3')
('8.6', 'k=0.2')
('8.8', 'W \\in \\{ 100,200,300\\}')
('8.8', 'k')
('8.9', 'I \\in \\{ 10,20,50\\}')
('8.9', 'k=0.2')
('8.9', 'W=100')
('8.9', 'I')
('8.9', 'I')
('8.9', 'I')
('8.10', '\\{ 64,128,256,512\\}')
('8.10', 'D')
('8.10', 'U')
('8.10', '\\beta')
('8.10', 'g \\circ f_\\theta')
('8.10', '\\eta')
('8.10', 'k\\in (0,1]')
('8.10', '\\mathcal{L}_{supervised}(\\cdot)')
('8.10', 'S')
('8.10', 'S \\gets \\emptyset, N \\gets |D|')
('8.10', '\\{ B_m\\}_{m=1}^{\\lceil N / \\beta \\rceil}')
('8.10', 'q_m \\gets \\nabla_\\theta \\mathcal{L}_{supervised}(B_m; \\theta)')
('8.10', 'q_U \\gets \\nabla_\\theta \\mathcal{L}_\\mathrm{RD}(U; \\theta)')
('8.10', 'best\\_gain = - \\infty')
('8.10', '\\hat{G}(B_m|S) \\gets \\eta q_U^{\\top}q_m')
('8.10', 's \\gets m')
('8.10', 'best\\_gain \\gets \\hat{G}(B_m|S)')
('8.10', 'S \\gets S \\cup B_s')
('8.10', 'D \\gets D \\setminus B_s')
('8.10', '\\theta \\gets \\theta - \\eta q_s')
('8.10', 'D')
('8.10', 'U')
('8.10', 'E')
('8.10', "\\eta'")
('8.10', '\\beta')
('8.10', 'W')
('8.10', 'I')
('8.10', 'k')
('8.10', '\\eta')
('8.10', '\\mathcal{L}_{supervised}(\\cdot)')
('8.10', "f_\\theta'")
('8.10', "g \\circ f_\\theta'")
('8.10', 'S \\gets D')
('8.10', 'W')
('8.10', '(E-W)')
('8.10', "\\theta \\gets copy(\\theta')")
('8.10', 'S \\gets \\mathrm{RCS}(D, U, \\beta, g \\circ f_{\\theta}, \\eta, k, \\mathcal{L}_{supervised}(\\cdot) )')
('8.10', 'B_m')
('8.10', 'S')
('8.10', "\\theta' \\gets \\theta' - \\eta' \\nabla_{\\theta'} \\mathcal{L}_{supervised}(B_m; \\theta')")
('8.11', 'K')
('8.11', '\\mathcal{L}_\\mathrm{ACL}(\\cdot)')
('8.11', '\\beta=512')
('8.11', 'T_\\mathrm{ACL}=5')
('8.11', '\\epsilon_\\mathrm{ACL}=8/255')
('8.11', '\\rho_\\mathrm{ACL}= 2/255')
('8.11', 'T_\\mathrm{RCS}=3')
('8.11', 'W=100')
('8.11', 'I=20')
('8.11', 'k=0.1')
('8.12.0', 'D = \\{ ({x}_i, y_i)\\}^N_{i=1}')
('8.12.0', '{x}_i \\in \\mathcal{X}')
('8.12.0', 'y_i \\in \\mathcal{Y}=  \\{0, 1, \\ldots, C-1\\}')
('8.12.0', 'f_\\theta: \\mathcal{X}\\rightarrow \\mathcal{Z}')
('8.12.0', 'g: \\mathcal{Z}\\rightarrow \\mathbb{R}^C')
('8.12.0', '\\begin{aligned}\n\\mathcal{L}_\\mathrm{SAT}(D; \\theta) = \\sum_{i=1}^N  \\left\\{\\max_{\\tilde{{x}}_i \\in \\mathcal{B}_\\epsilon[x_i]} \\ell(g \\circ f_\\theta (\\tilde{{x}}_i), y_i)\\right\\}, \n\\end{aligned}')
('8.12.0', '\\ell')
('8.12.0', '\\tilde{{x}}_i')
('8.12.0', '\\epsilon')
('8.12.0', 'x_i')
('8.12.0', '\\begin{aligned}\n\\label{eq:trades}\n\\mathcal{L}_\\mathrm{TRADES}(D; \\theta) = \\sum_{i=1}^N  \\left\\{\\ell(g \\circ f_\\theta (x_i), y_i) + c \\cdot \\max_{\\tilde{{x}}_i \\in \\mathcal{B}_\\epsilon[x_i]} KL(g \\circ f_\\theta (\\tilde{{x}}_i), g \\circ f_\\theta (x_i))\\right\\}, \n\\end{aligned}')
('8.12.0', '\\ell')
('8.12.0', 'KL(\\cdot,\\cdot)')
('8.12.0', 'c>0')
('8.12.0', '\\tilde{{x}}_i')
('8.12.0', '\\epsilon')
('8.12.0', 'x_i')
('8.12.0', 'c=6')
('8.12.0', 'g')
('8.12.0', 'g')
('8.12.0', 'f_\\theta')
('8.12.0', '\\label{eq:RCS-max-sup}\n    S^* = \\mathop{\\mathrm{\\mathrm{arg\\,max }}}_{S \\subseteq D, |S|/|D| = k} -\\mathcal{L}_\\mathrm{RD}(U; \\theta - \\eta \\nabla_\\theta \\mathcal{L}_{supervised}(S; \\theta)),')
('8.12.0', '\\mathcal{L}_\\mathrm{ACL}(\\cdot)')
('8.12.0', '\\mathcal{L}_{supervised}(\\cdot)')
('8.12.0', '\\mathcal{L}_\\mathrm{SAT}(\\cdot)')
('8.12.0', '\\mathcal{L}_\\mathrm{TRADES}(\\cdot)')
('8.12.0', '\\mathcal{L}_\\mathrm{RD}(\\cdot)')
('8.12.1.0', '\\epsilon=8/255, \\alpha=10/255')
('8.12.1.0', 'k=0.5')
('8.12.1.0', 'W=10')
('8.12.1.0', 'I=10')
('8.12.1.0', '\\epsilon=8/255, \\alpha=8/2550')
('8.12.1.1', '\\epsilon=8/255')
('8.12.1.1', 'k \\in \\{0.05, 0.1, 0.2\\}')
('8.12.1.1', 'k \\in \\{0.05, 0.1, 0.2\\}')
('8.12.1.2', '\\beta=128')
('8.12.1.2', 'T_\\mathrm{SAT}=10')
('8.12.1.2', '\\epsilon_\\mathrm{SAT}=8/255')
('8.12.1.2', '\\rho_\\mathrm{SAT}= 2/255')
('8.12.1.2', 'T_\\mathrm{RCS}= 3')
('8.12.1.2', 'W=30')
('8.12.1.2', 'I=10')
('8.12.1.2', 'k \\in \\{ 0.05, 0.1, 0.2\\}')
('8.12.1.2', 'T_\\mathrm{TRADES}=10')
('8.12.1.2', '\\epsilon_\\mathrm{TRADES}=8/255')
('8.12.1.2', '\\rho_\\mathrm{TRADES}= 2/255')
('8.12.2.0', '32 \\times 32')
('8.12.2.0', '\\beta=256')
('8.12.2.0', 'T_\\mathrm{SAT}=10')
('8.12.2.0', '\\epsilon_\\mathrm{SAT}=8/255')
('8.12.2.0', '\\rho_\\mathrm{SAT}= 2/255')
('8.12.2.0', 'T_\\mathrm{RCS}=3')
('8.12.2.0', 'W=10')
('8.12.2.0', 'W=10')
('8.12.2.0', 'k \\in \\{ 0.05, 0.1, 0.2\\}')
('8.12.2.0', '\\mathcal{L}_\\mathrm{Robust}(\\cdot)')
('8.12.2.1', '224 \\times 224')
('8.12.2.1', '\\beta=256')
('8.12.2.1', 'T_\\mathrm{SAT}=3')
('8.12.2.1', '\\epsilon_\\mathrm{SAT}=4/255')
('8.12.2.1', '\\rho_\\mathrm{SAT}= \\frac{3 \\epsilon_\\mathrm{SAT}}{T_\\mathrm{SAT}}')
('8.12.2.1', 'T_\\mathrm{RCS}=1')
('8.12.2.1', 'W=10')
('8.12.2.1', 'I=10')
('8.12.2.1', 'k \\in \\{ 0.05, 0.1, 0.2\\}')
('8.12.2.1', '224 \\times 224')
('8.12.2.1', '224 \\times 224')
