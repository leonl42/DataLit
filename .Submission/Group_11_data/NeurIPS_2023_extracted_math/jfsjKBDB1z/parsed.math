('1', '\\sim')
('1', '\\sim')
('1', '\\sim')
('1', '\\sim')
('3.0', 'n')
('3.0', 'P')
('3.0', 'd_m')
('3.0', 'M_{b} = \\begin{bmatrix} \n    M_s\\in \\mathbb{R}^{n\\times d_m}\\\\\n    M_p\\in \\mathbb{R}^{P\\times d_m}\n    \\end{bmatrix}.')
('3.0', 'L')
('3.0', 'd_q')
('3.0', 'X \\in \\mathbb{R}^{L \\times d_q}')
('3.0', 'X \\in \\mathbb{R}^{L \\times d_q}')
('3.0', 'Q \\in \\mathbb{R}^{L\\times d}')
('3.0', 'M_{b} \\in \\mathbb{R}^{(n+P)\\times d_m}')
('3.0', 'K \\in \\mathbb{R}^{(n+P) \\times d}')
('3.0', 'V \\in \\mathbb{R}^{(n+P) \\times d}')
('3.0', 'd')
('3.0', 'Q')
('3.0', 'K')
('3.0', 'V')
('3.0', '\\label{eq:crossattn}\n     \\textsf{C}(Q, K, V) =  \\text{softmax}\\left(\\frac{QK^T}{\\sqrt{d}}\\right)V,')
('3.0', '\\text{softmax}')
('3.0', '30K')
('3.1', '16\\times 16')
('3.1', '14\\times 14')
('3.1', '16')
('3.1', '1024\\times 1024')
('3.1', '64\\times 64')
('3.1', 'k_i')
('3.1', 'k_{i+1}')
('3.1', '||k_i - k_{i+1}||^2_2 \\leq \\frac{c_K}{n^2}')
('3.1', 'i = 1, \\dots, n - 1')
('3.1', 'c_K')
('3.1', 'l_w \\times l_h')
('3.1', 'K_s')
('3.1', '\\Tilde{K}_s')
('3.1', 'K_s')
('3.1', '\\Bar{K}_s')
('3.1', '\\Tilde{K}_s')
('3.1', 'l_w\\times l_h')
('3.1', '\\Bar{K}_s')
('3.1', 'K_s')
('3.1', 'K')
('3.1', 'V')
('3.1', 'K_s = [k_{11}, \\dots, k_{1h}; \\dots; k_{w1}, \\dots, k_{wh}]')
('3.1', 'w \\times h')
('3.1', 'n = w\\times h')
('3.1', 'k = \\Tilde{w}\\times \\Tilde{h}')
('3.1', 'w')
('3.1', '\\Tilde{w}')
('3.1', 'h')
('3.1', '\\Tilde{h}')
('3.1', 'l_w = \\frac{w}{\\Tilde{w}}, l_h = \\frac{h}{\\Tilde{h}}')
('3.1', '\\Tilde{K}_s')
('3.1', '\\Tilde{V}_s')
('3.1', '\\begin{aligned}\n\\label{eq:keys-values}\n\\small\n\\Tilde{k}_{ij} & = \\sum_{p = i \\times l_w + 1}^{(i + 1) \\times l_w}\\sum_{q = j \\times l_h + 1}^{(j + 1) \\times l_h} \\frac{k_{pq}}{l_w \\times l_h}, \\nonumber \\\\\n\\Tilde{v}_{ij} & = \\sum_{p = i \\times l_w + 1}^{(i + 1) \\times l_w}\\sum_{q = j \\times l_h + 1}^{(j + 1) \\times l_h} \\frac{v_{pq}}{l_w \\times l_h}, \n\\end{aligned}')
('3.1', 'i = 1, \\cdots, \\Tilde{w}, j=1, \\cdots, \\Tilde{h}')
('3.1', '2 \\times 2')
('3.1', '\\Tilde{K}_s')
('3.1', 'K_s')
('3.1', 'K_s \\in \\mathbb{R}^{n \\times d}')
('3.1', '\\Bar{K}_s \\in \\mathbb{R}^{n \\times d}')
('3.1', '\\Tilde{K}_s \\in \\mathbb{R}^{\\Tilde{w}\\Tilde{h} \\times d}')
('3.1', '\\Tilde{k}_i, i = 1, \\dots, \\Tilde{w}\\Tilde{h}')
('3.1', 'l_w\\times l_h')
('3.1', '\\begin{aligned}\n    \\Bar{K}_s = [\\underbrace{\\Tilde{k}_1; \\dots; \\Tilde{k}_1}_{l_w\\times l_h}; \\underbrace{\\Tilde{k}_2; \\dots; \\Tilde{k}_2}_{l_w\\times l_h}; \\dots; \\underbrace{\\Tilde{k}_{\\Tilde{w}\\Tilde{h}}; \\dots; \\Tilde{k}_{\\Tilde{w}\\Tilde{h}}}_{l_w\\times l_h}]\n\\end{aligned}')
('3.1', '\\Tilde{v}_i, i =1, \\dots, \\Tilde{w}\\Tilde{h}')
('3.1', 'l_w\\times l_h')
('3.1', '\\Bar{V}_s  \\in \\mathbb{R}^{n \\times d}')
('3.1', 'V_s \\in \\mathbb{R}^{n\\times d}')
('3.1', '\\begin{aligned}\n    \\small \n    \\Bar{V}_s= [\\underbrace{\\Tilde{v}_1; \\dots; \\Tilde{v}_1}_{l_w\\times l_h}; \\underbrace{\\Tilde{v}_2; \\dots; \\Tilde{v}_2}_{l_w \\times l_h}; \\dots; \\underbrace{\\Tilde{v}_{\\Tilde{w}\\Tilde{h}}; \\dots; \\Tilde{v}_{\\Tilde{w}\\Tilde{h}}}_{l_w \\times l_h}]\n\\end{aligned}')
('3.1', '\\Bar{K} = [\\Bar{K}_s; K_p]\\in \\mathbb{R}^{(n+P)\\times d}')
('3.1', '\\Bar{V} = [\\Bar{V}_s; K_p]\\in \\mathbb{R}^{(n+P)\\times d}')
('3.1', 'K')
('3.1', 'V')
('3.1', '\\bar{K}')
('3.1', '\\bar{V}')
('3.1', '\\begin{aligned}\n\\label{eq:replace}\n    \\text{softmax}\\left(\\frac{Q\\Bar{K}^{T}}{\\sqrt{d}}\\right)\\Bar{V} = \\text{softmax}\\left(A \\right)\\Tilde{V},\n\\end{aligned}')
('3.1', 'A = [\\frac{Q\\Tilde{K}_s^{T}}{\\sqrt{d}} + \\ln{(l_w\\times l_h)}, \\frac{QK_p^{T}}{\\sqrt{d}}] \\in \\mathbb{R}^{L\\times (\\Tilde{w}\\Tilde{h} + P)}')
('3.1', '\\Tilde{V} = [\\Tilde{V}_s; V_p] \\in \\mathbb{R}^{(\\Tilde{w}\\Tilde{h}+P)\\times d}')
('3.1', '\\Bar{K}')
('3.1', '\\Bar{V}')
('3.1', 'K')
('3.1', 'V')
('3.1', '\\text{softmax}\\left(\\frac{QK^T}{\\sqrt{d}}\\right)V')
('3.1', '\\label{eq:scrossattn}\n     \\Bar{\\textsf{C}}(Q, K, V) =  \\text{softmax}\\left(\\frac{Q\\bar{K}^T}{\\sqrt{d}}\\right)\\bar{V}.')
('3.1', '\\label{eq:ecrossattn}\n     \\Bar{\\textsf{C}}(Q, K, V) = \\text{softmax}(A)\\Tilde{V}.')
('3.1', '\\label{eq:acrossattn}\n     \\Tilde{\\textsf{C}}(Q, K, V) = \\text{softmax}\\left(\\frac{Q\\Tilde{K}^{T}}{\\sqrt{d}} \\right)\\Tilde{V},')
('3.1', '\\Tilde{K} = [\\Tilde{K}_s + \\ln{(l_w\\times l_h)}, K_p]\\in\\mathbb{R}^{(\\Tilde{w}\\Tilde{h}+P)\\times d}')
('4.0', '\\beta_1 = 0.9')
('4.0', '\\beta_2 = 0.999')
('4.0', '4e-4')
('4.0', '1024\\times 1024')
('4.0', '64')
('4.0', '\\beta_1 = 0.9')
('4.0', '\\beta_2 = 0.999')
('4.0', '6e-5')
('4.0', '3e-4')
('4.0', '1024\\times 1024')
('4.0', '25')
('4.0', '20')
('4.0', '0.1')
('4.0', '0.03')
('4.0', '0.03')
('4.0', '0.05')
('4.0', '64')
('4.0', '3')
('4.0', '\\mathcal{J}')
('4.0', '\\mathcal{F}')
('4.1', '2\\times2')
('4.1', '2\\times 2')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '<2')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{G}')
('4.1', '\\sim')
('4.1', '\\sim')
('4.1', '>')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '1, \\dots, 8')
('4.1', '\\sim')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\sim')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '>')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.1', '\\mathcal{J}')
('4.1', '\\mathcal{F}')
('4.2', '\\mathcal{J}')
('4.2', '\\mathcal{F}')
('4.2', '\\mathcal{J}')
('4.2', '\\mathcal{F}')
('4.2', '2\\times 2')
('4.2', '4 \\times 4')
('4.2', '2\\times 2')
('4.2', '4\\times 4')
('4.2', '\\sim')
('4.2', '\\mathcal{J}')
('4.2', '\\mathcal{F}')
('4.2', '2\\times 2')
('4.2', '>10')
('4.2', '\\mathcal{J}')
('4.2', '\\mathcal{F}')
('4.2', '\\mathcal{J}')
('4.2', '\\mathcal{F}')
('4.2', '1024\\times 1024')
('4.2', '512\\times 512')
('7', '\\Tilde{K}_s')
('7', 'K_s')
('7', 'K_s \\in \\mathbb{R}^{n \\times d}')
('7', '\\Bar{K}_s \\in \\mathbb{R}^{n \\times d}')
('7', '\\Tilde{K}_s \\in \\mathbb{R}^{\\Tilde{w}\\Tilde{h} \\times d}')
('7', '\\Tilde{k}_i, i = 1, \\dots, \\Tilde{w}\\Tilde{h}')
('7', 'l_w\\times l_h')
('7', '\\begin{aligned}\n    \\Bar{K}_s = [\\underbrace{\\Tilde{k}_1; \\dots; \\Tilde{k}_1}_{l_w\\times l_h}; \\underbrace{\\Tilde{k}_2; \\dots; \\Tilde{k}_2}_{l_w\\times l_h}; \\dots; \\underbrace{\\Tilde{k}_{\\Tilde{w}\\Tilde{h}}; \\dots; \\Tilde{k}_{\\Tilde{w}\\Tilde{h}}}_{l_w\\times l_h}]\n\\end{aligned}')
('7', '\\Tilde{v}_i, i =1, \\dots, \\Tilde{w}\\Tilde{h}')
('7', 'l_w\\times l_h')
('7', '\\Bar{V}_s  \\in \\mathbb{R}^{n \\times d}')
('7', 'V_s \\in \\mathbb{R}^{n\\times d}')
('7', '\\begin{aligned}\n    \\small \n    \\Bar{V}_s= [\\underbrace{\\Tilde{v}_1; \\dots; \\Tilde{v}_1}_{l_w\\times l_h}; \\underbrace{\\Tilde{v}_2; \\dots; \\Tilde{v}_2}_{l_w \\times l_h}; \\dots; \\underbrace{\\Tilde{v}_{\\Tilde{w}\\Tilde{h}}; \\dots; \\Tilde{v}_{\\Tilde{w}\\Tilde{h}}}_{l_w \\times l_h}]\n\\end{aligned}')
('7', '\\Bar{K} = [\\Bar{K}_s; K_p]\\in \\mathbb{R}^{(n+P)\\times d}')
('7', '\\Bar{V} = [\\Bar{V}_s; V_p]\\in \\mathbb{R}^{(n+P)\\times d}')
('7', '\\bar{K}')
('7', '\\bar{V}')
('7', 'Q\\in\\mathbb{R}^{L\\times d}')
('7', '\\begin{aligned}\n\\label{eq:replace}\n    \\text{softmax}\\left(\\frac{Q\\Bar{K}^{T}}{\\sqrt{d}}\\right)\\Bar{V} = \\text{softmax}\\left(A \\right)\\Tilde{V},\n\\end{aligned}')
('7', 'A = [\\frac{Q\\Tilde{K}_s^{T}}{\\sqrt{d}} + \\ln{(l_w\\times l_h)}, \\frac{QK_p^{T}}{\\sqrt{d}}] \\in \\mathbb{R}^{L\\times (\\Tilde{w}\\Tilde{h} + P)}')
('7', '\\Tilde{V} = [\\Tilde{V}_s; V_p] \\in \\mathbb{R}^{(\\Tilde{w}\\Tilde{h}+P)\\times d}')
('7', 'Q = [q_1; \\dots; q_L]')
('7', 'q_i \\in \\mathbb{R}^{1 \\times d}')
('7', '\\Bar{C} = \\text{softmax}\\left(\\frac{Q\\Bar{K}^{T}}{\\sqrt{d}}\\right)\\Bar{V} \\in \\mathbb{R}^{L\\times d}')
('7', '\\bar{S} = \\text{softmax}\\left(\\frac{Q\\Bar{K}^{T}}{\\sqrt{d}}\\right)\\in \\mathbb{R}^{L\\times (n+P)}')
('7', '\\resizebox{0.7\\linewidth}{!}{$\n\\bar{S} = D_{\\mathcal{S}}\\begin{bmatrix} \n    e(\\frac{q_1}{\\sqrt{d}}\\Tilde{k}_1^T) & \\dots & e(\\frac{q_1}{\\sqrt{d}}\\Tilde{k}_1^T) &\\dots & e(\\frac{q_1}{\\sqrt{d}}\\Tilde{k}_{\\Tilde{w}\\Tilde{h}}^T) & \\dots & e(\\frac{q_1}{\\sqrt{d}}K_p^T)\\\\\n    \\vdots & \\dots & \\vdots & \\dots & \\vdots &\\dots & \\dots \\\\\n    e(\\frac{q_L}{\\sqrt{d}}\\Tilde{k}_1^T) & \\dots  & e(\\frac{q_L}{\\sqrt{d}}\\Tilde{k}_1^T) &\\dots & e(\\frac{q_L}{\\sqrt{d}}\\Tilde{k}_{\\Tilde{w}\\Tilde{h}}^T) & \\dots & e(\\frac{q_L}{\\sqrt{d}}K_p^T)\n    \\end{bmatrix}$}')
('7', 'D_{\\mathcal{S}}')
('7', 'L\\times L')
('7', '\\bar{S}')
('7', 'e(\\cdot)')
('7', '\\exp(\\cdot)')
('7', '\\begin{aligned}\n\\label{eq:entry}\n    \\Bar{C}_{ij} & = D_{{\\mathcal{S}}_{ii}}(\\underbrace{e(\\frac{q_i}{\\sqrt{d}}\\Tilde{k}_1^T)\\Tilde{v}_1 + \\dots e(\\frac{q_i}{\\sqrt{d}}\\Tilde{k}_1^T)\\Tilde{v}_1}_{l_w\\times l_h} \n     + \\dots + \\underbrace{e(\\frac{q_i}{\\sqrt{d}}\\Tilde{k}_1^T)\\Tilde{v}_{\\Tilde{w}\\Tilde{h}}  + \\dots e(\\frac{q_i}{\\sqrt{d}}\\Tilde{k}_1^T)\\Tilde{v}_{\\Tilde{w}\\Tilde{h}}}_{l_w\\times l_h}  + e(\\frac{q_i}{\\sqrt{d}}K_p^T)V_p) \\nonumber \\\\ \n    &= D_{{\\mathcal{S}}_{ii}}(l_w\\times l_h\\times (e(\\frac{q_i}{\\sqrt{d}}\\Tilde{k}_1^T)\\Tilde{v}_1 + \\dots +  e(\\frac{q_i}{\\sqrt{d}}\\Tilde{k}_1^T)\\Tilde{v}_{\\Tilde{w}\\Tilde{h}}) + e(\\frac{q_i}{\\sqrt{d}}K_p^T)V_p) \\nonumber \\\\ \n    & = D_{{\\mathcal{S}}_{ii}}(l_w\\times l_h \\times e(\\frac{q_i}{\\sqrt{d}}\\Tilde{K}_s^T)\\Tilde{V}_s^T + e(\\frac{q_i}{\\sqrt{d}}K_p^T)V_p) \\nonumber \\\\ \n    & = D_{{\\mathcal{S}}_{ii}}(e(\\ln(l_w\\times l_h) + \\frac{q_i}{\\sqrt{d}}\\Tilde{K}_s^T)\\Tilde{V}_s + e(\\frac{q_i}{\\sqrt{d}}K_p^T)V_p) \\nonumber \\\\ \n    & = \\text{softmax}[\\frac{q_i\\Tilde{K}_s^{T}}{\\sqrt{d}} + \\ln{(l_w\\times l_h)}, \\frac{q_i\\Tilde{K}_p^{T}}{\\sqrt{d}}][\\Tilde{V}_s; V_p] \n\\end{aligned}')
('7', 'D_{{\\mathcal{S}}_{ii}}')
('7', 'i^{\\text{th}}')
('7', 'D_{\\mathcal{S}}')
('7', 'i^{\\text{th}}')
('7', '\\text{softmax}\\left(A \\right)\\Tilde{V}')
('8', '\\mathcal{J}')
('8', '\\mathcal{F}')
('8', '\\mathcal{J}')
('8', '\\mathcal{F}')
('8', '\\mathcal{J}')
('8', '\\mathcal{F}')
