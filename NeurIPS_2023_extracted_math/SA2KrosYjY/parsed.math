('2', '\\mathcal{X} \\in \\mathbb{R}^{H \\times W \\times 3}')
('2', '\\mathcal{Y}^{in} = \\{1,2,\\cdots,C\\}')
('2', 'C')
('2', '\\mathcal{D}^{in}_{tr} = \\{(I_i,y_i)\\}^{n}_{i=1}')
('2', '\\mathcal{P}_{\\mathcal{X}\\mathcal{Y}^{in}}')
('2', '\\mathcal{P}_{\\mathcal{X}}')
('2', '\\mathcal{X}')
('2', 'f : \\mathcal{X} \\mapsto \\mathbb{R}^C')
('2', '\\hat{y}_i = \\mathop{argmax}_{k} f[k](I_i)')
('2', '\\mathbf{x} \\in \\mathbb{R}^d')
('2', 'l_2')
('2', 'd')
('2', '\\mathbf{x} = \\mathcal{I}(I)')
('2', 'f')
('2', 'f(I) = W^T\\mathcal{I}(I) = W^T\\mathbf{x}')
('2', 'W = [\\mathbf{w}_1; \\mathbf{w}_2; \\cdots; \\mathbf{w}_C ]^T \\in \\mathbb{R}^{d\\times~C}')
('2', 'l_2')
('2', 'C')
('2', '\\mathbf{w}_k = \\mathcal{T}([v_{k,1};v_{k,2};\\cdots;v_{k,m};\\texttt{CLS}_k]) \\triangleq \\mathcal{T}([\\mathbf{v}_k;\\texttt{CLS}_k])')
('2', '\\mathbf{v}_k')
('2', 'm')
('2', 'k')
('2', '\\texttt{CLS}_k')
('2', '\\hat{y} = \\mathop{argmax}_{k} \\mathbf{w}_k^T\\mathbf{x} = \\mathop{argmax}_{k} \\langle \\mathbf{w}_k,\\mathbf{x} \\rangle')
('2', '\\mathbf{z}')
('2', 'y \\notin \\mathcal{Y}^{in}')
('2', 'g : \\mathcal{X} \\mapsto \\mathbb{R}^1')
('2', '\\mathcal{G} := \\{ \\mathbf{z} : g(\\mathbf{z}) \\leq \\lambda \\}')
('2', 'g(\\mathbf{z})')
('2', '\\lambda')
('3.0', '\\mathbf{z} \\notin \\mathcal{P}_{\\mathcal{X}}')
('3.0', '\\hat{y} = \\mathop{argmax}_{k} \\langle \\mathbf{w}^p_k,\\mathbf{z} \\rangle')
('3.0', '\\mathbf{w}_k^p = \\mathcal{T}([\\mathbf{v}_k^p;\\texttt{CLS}])')
('3.0', 'k')
('3.0', '\\mathbf{v}_k^p')
('3.0', '\\mathbf{v}_k^p')
('3.0', '\\mathbf{z}')
('3.0', 'k')
('3.0', '\\langle \\mathbf{w}_k^s,\\mathbf{z} \\rangle')
('3.0', '\\mathbf{w}_k^s = \\mathcal{T}([\\mathbf{v}_k^s;\\texttt{CLS}])')
('3.0', '\\mathbf{v}_k^s')
('3.0', 'C')
('3.0', 'C+C=2C')
('3.0', '(\\mathbf{x}_i, y_i)')
('3.0', '\\begin{aligned}\n  \\mathop{argmin}_{\\mathbf{w}^p,\\mathbf{w}^s} \\quad\n  % \\mathcal{L}_{\\texttt{ID}} = \n     \\frac{1}{n}\\sum_{i}\\left[ -\\log{\\frac{e^{ \\langle \\mathbf{w}^p_{y_i}, \\mathbf{x}_i \\rangle }}{e^{ \\langle \\mathbf{w}^p_{y_i}, \\mathbf{x}_i \\rangle } + \\sum_{k \\neq y_i}^{C}{e^{ \\langle \\mathbf{w}^p_k, \\mathbf{x}_i \\rangle }} + \\sum_{k \\neq y_i}^{C}{e^{ \\langle \\mathbf{w}^s_k, \\mathbf{x}_i \\rangle }}}} \\right] \n  \\label{eq:method_id_train}\n\\end{aligned}')
('3.0', '\\mathbf{x}')
('3.0', '\\mathbf{z}')
('3.0', '\\hat{y}')
('3.0', '\\begin{aligned}\n  R = \\mathbb{E}_{\\mathbf{x} \\sim \\mathcal{P}_{\\mathcal{X}}}\\left[ \\mathbbm{1}\\{ \\langle \\mathbf{w}_{\\hat{y}}^p\\mathbf{x} \\rangle < \\langle \\mathbf{w}_{\\hat{y}}^s,\\mathbf{x} \\rangle   \\} \\right] \n      + \\mathbb{E}_{\\mathbf{z} \\nsim \\mathcal{P}_{\\mathcal{X}}}\\left[ \\mathbbm{1}\\{ \\langle \\mathbf{w}_{\\hat{y}}^p,\\mathbf{z} \\rangle > \\langle \\mathbf{w}_{\\hat{y}}^s,\\mathbf{z} \\rangle \\}\\right] \n  \\label{eq:method_risk}\n\\end{aligned}')
('3.0', '\\mathcal{D}^{s}_{tr} = \\{(\\tilde{\\mathbf{z}}_i,\\hat{y}_i)\\}^{\\tilde{n}}_{i=1}')
('3.0', '\\mathop{argmin}_{\\mathbf{w}^p,\\mathbf{w}^s} \\quad\n  % \\mathcal{L}_{\\texttt{OOD}} = \n     \\frac{1}{n}\\sum_{i}\\left[ -\\log{\\frac{e^{ \\langle \\mathbf{w}^p_{y_i}, \\mathbf{x}_i \\rangle }}{ e^{\\langle \\mathbf{w}^p_{y_i}, \\mathbf{x}_i \\rangle } + e^{\\langle \\mathbf{w}^s_{y_i}, \\mathbf{x}_i \\rangle }}} \\right]\n  +  \\frac{1}{\\tilde{n}}\\sum_{i}\\left[ -\\log{\\frac{e^{\\langle \\mathbf{w}^s_{\\hat{y}_i}, \\tilde{\\mathbf{z}}_i \\rangle }}{ e^{\\langle \\mathbf{w}^p_{\\hat{y}_i}, \\tilde{\\mathbf{z}}_i \\rangle } + e^{\\langle \\mathbf{w}^s_{\\hat{y}_i}, \\tilde{\\mathbf{z}}_i \\rangle }}} \\right]\n  \\label{eq:method_ood_train}')
('3.0', '\\mathcal{D}^{s}_{tr}')
('3.1', '\\mathbf{v}^p_k = [v^p_{k,1};v^p_{k,2};\\cdots;v^p_{k,m}])')
('3.1', 'v^p_{k,j}')
('3.1', 'u')
('3.1', 'v^p_{k,j}')
('3.1', '\\mathring{\\mathbf{w}}^p_k = \\mathcal{T}([v^p_{k,1};\\cdots;u;\\cdots;v^p_{k,m};\\texttt{CLS}_k])')
('3.1', '\\mathring{\\mathbf{w}}^p_k')
('3.1', '\\mathring{\\mathbf{w}}^p_k')
('3.1', '\\mathbf{w}^p_k')
('3.1', '\\mathcal{D}^{s}_{tr} = \\{(\\tilde{\\mathbf{z}}_i,\\hat{y}_i) : \\langle \\mathring{\\mathbf{w}}^p_{\\hat{y}_i}, \\tilde{\\mathbf{z}}_i \\rangle  >  \\langle \\mathbf{w}^p_{\\hat{y}_i}, \\tilde{\\mathbf{z}}_i \\rangle \\}\n  \\label{eq:method_ood_synth}')
('3.1', '\\mathbf{v}_k^s')
('3.2', 'r_k = \\langle \\mathbf{w}^p_k,\\mathbf{x} \\rangle \\times \\frac{e^{ \\langle \\mathbf{w}^p_k, \\mathbf{x} \\rangle }}{ e^{\\langle \\mathbf{w}^p_k, \\mathbf{x} \\rangle } + e^{\\langle \\mathbf{w}^s_k, \\mathbf{x} \\rangle }} \\triangleq s_k \\times \\gamma_k\n  \\label{eq:method_infer}')
('3.2', '\\hat{y} = \\mathop{argmax}_{k} r_k')
('3.2', 'g(\\mathbf{x}) = -\\mathop{max}\\frac{e^{r_k}}{\\sum_{j}^{C}e^{r_j}}')
('3.2', '\\mathbf{w}^p')
('3.2', 's')
('3.2', '\\mathbf{w}^s')
('3.2', '\\gamma')
('4', '\\mathtt{iNaturalist}')
('4', '\\mathtt{SUN}')
('4', '\\mathtt{Places}')
('4', '\\mathtt{Texture}')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\cup')
('4.0', '\\cup')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\uparrow')
('4.0', '\\downarrow')
('4.0', '\\uparrow')
('4.0', '\\cup')
('4.0', 's')
('4.0', '\\gamma')
('4.0', 'r = s \\times \\gamma')
('4.0', '\\textbf{w}_p')
('4.0', '\\textbf{w}_s')
('4.0', 'r')
('4.0', '\\uparrow')
('4.0', '\\uparrow')
('4.1', '\\uparrow')
('4.1', '\\downarrow')
('4.1', '\\uparrow')
('4.1', '\\uparrow')
('4.1', '\\downarrow')
('4.1', '\\uparrow')
('4.1', 'N_s')
('4.1', '\\downarrow')
('4.1', '\\uparrow')
('4.1', '\\downarrow')
('4.1', '\\uparrow')
('7.1', 'k')
('7.1', 'k')
('7.1', 'k')
('7.1', '\\mathbf{v}^p_k = [v^p_{k,1};v^p_{k,2};\\cdots;v^p_{k,m}])')
('7.1', 'k')
('7.1', 'u')
('7.1', 'v^p_{k,j}')
('7.1', '\\mathring{\\mathbf{w}}^p_k')
('7.1', '\\mathbf{v}^p_k')
('7.1', 'v^p_{k,j}')
('7.1', 'u = [\\texttt{MASK}]')
('7.1', 'u = \\sigma')
('7.1', 'u = v^p_{k^\\prime,j^\\prime}')
('7.1', '\\mathring{\\mathbf{w}}^p_k = \\mathcal{T}([v^p_{k,1};\\cdots;u;\\cdots;v^p_{k,m};\\texttt{CLS}_k])')
('7.1', '\\mathring{\\mathbf{w}}^p_k')
('7.1', '\\mathbf{w}^p_k')
('7.1', '\\mathring{\\mathbf{w}}^p_k')
('7.1', 'v^p_{k,j} := u')
('7.1', '\\{v^p_{j}\\}^{m}')
('7.1', 'v^p_{j}')
('7.1', '\\mathring{\\mathbf{w}}^p_k')
('7.1', '\\downarrow')
('7.1', '\\uparrow')
('7.1', '\\downarrow')
('7.1', '\\uparrow')
('7.2', '\\gamma')
('7.3', '\\cup')
('7.3', '\\mathcal{I}')
('7.3', '\\mathcal{T}')
('7.3', '\\mathbf{v}^p')
('7.3', '\\mathbf{v}^s')
('7.3', 'l_2')
('7.3', '\\{\\mathbf{w}_{\\texttt{\\uppercase{\\romannumeral 1}},k}^p = \\mathcal{T}(\\mathbf{v}_{\\texttt{\\uppercase{\\romannumeral 1}},k}^p;\\texttt{CLS}_{\\texttt{\\uppercase{\\romannumeral 1}},k})\\}_{k=1}^{100}')
('7.3', '\\{\\mathbf{w}_{\\texttt{\\uppercase{\\romannumeral 2}},k}^p = \\mathcal{T}(\\mathbf{v}_{\\texttt{\\uppercase{\\romannumeral 2}},k}^p;\\texttt{CLS}_{\\texttt{\\uppercase{\\romannumeral 2}},k})\\}_{k=1}^{100}')
('7.3', '\\{\\mathbf{w}_k^p\\}_{k=1}^{200}')
('7.3', 'I')
('7.3', 'l_2')
('7.3', '\\mathbf{x} = \\mathcal{I}(I)')
('7.3', '\\mathbf{s}^p = [\\langle \\mathbf{w}_1^p,\\mathbf{x} \\rangle, \\langle \\mathbf{w}_2^p,\\mathbf{x} \\rangle, \\cdots, \\langle \\mathbf{w}_{200}^p,\\mathbf{x} \\rangle] \\triangleq [s_1^p, s_2^p, \\cdots, s_{200}^p]')
('7.3', '\\mathbf{s}^s = [s_1^s, s_2^s, \\cdots, s_{200}^s]')
('7.3', '\\mathcal{I}_\\texttt{\\uppercase{\\romannumeral 1}}')
('7.3', '\\mathcal{I}_\\texttt{\\uppercase{\\romannumeral 2}}')
('7.3', 'I')
('7.3', '\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 1}} = \\mathcal{I}_\\texttt{\\uppercase{\\romannumeral 1}}(I)')
('7.3', '\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 2}} = \\mathcal{I}_\\texttt{\\uppercase{\\romannumeral 2}}(I)')
('7.3', '\\mathbf{s}_\\texttt{\\uppercase{\\romannumeral 1}} = [\\langle \\mathbf{w}_1,\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 1}} \\rangle, \\langle \\mathbf{w}_2,\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 1}} \\rangle, \\cdots, \\langle \\mathbf{w}_{200},\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 1}} \\rangle] = \\{ \\langle \\mathbf{w}_k,\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 1}} \\rangle \\}_{k=1}^{200}')
('7.3', '\\mathbf{s}_\\texttt{\\uppercase{\\romannumeral 2}} = \\{ \\langle \\mathbf{w}_k,\\mathbf{x}_\\texttt{\\uppercase{\\romannumeral 2}} \\rangle \\}_{k=1}^{200}')
('7.3', '^p')
('7.3', '\\mathbf{s} =\n\\begin{cases}\n    \\mathbf{s}_\\texttt{\\uppercase{\\romannumeral 1}} & \\mathop{max}(\\mathbf{s}_\\texttt{\\uppercase{\\romannumeral 1}}) > \\mathop{max}(\\mathbf{s}_\\texttt{\\uppercase{\\romannumeral 2}}) \\\\ \n    \\mathbf{s}_\\texttt{\\uppercase{\\romannumeral 2}} & \\texttt{otherwise}\n\\end{cases}')
('8.0', '\\uparrow')
('8.0', '\\downarrow')
('8.0', '\\uparrow')
('8.1', '\\downarrow')
('8.1', '\\uparrow')
('8.1', '\\downarrow')
('8.1', '\\uparrow')
('8.2', '\\mathring{\\mathbf{w}}^p_k')
('8.2', '\\mathbf{w}^s_k')
('8.2', '\\downarrow')
('8.2', '\\uparrow')
('8.3', '\\uparrow')
('8.3', '\\downarrow')
('8.3', '\\uparrow')
('8.3', '\\uparrow')
('8.3', '\\downarrow')
('8.3', '\\uparrow')
('8.4', '\\uparrow')
('8.4', '\\downarrow')
('8.4', '\\uparrow')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('8.4', '\\pm')
('10', '\\mathtt{iNaturalist}')
('10', '\\mathtt{SUN}')
('10', '\\mathtt{Places}')
('10', '\\mathtt{Texture}')
