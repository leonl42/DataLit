('2', '\\mathbf{x}_0')
('2', '\\mathbf{x}_{t+1}\\sim \\pi(\\mathbf{x}_{t+1}|\\mathbf{x}_{t},t)')
('2', '\\mathbf{x}_T')
('2', '\\mathbf{x}=\\mathbf{x}_T')
('2', '\\pi(\\mathbf{x})')
('2', '\\mathbf{x}_0')
('2', '\\mathcal{N}(0,I)')
('2', '\\pi(\\mathbf{x})')
('2', 'q(\\mathbf{x})')
('2', 'E(\\mathbf{x})')
('2', '\\begin{aligned}\n    q(\\mathbf{x}) = \\frac{1}{Z}\\exp(-E(\\mathbf{x})/\\tau), \\quad E: \\mathcal{X}\\to\\ensuremath{\\mathbb{R}}\\quad Z=\\int_{\\mathcal{X}} \\exp(-E(\\mathbf{x})/\\tau) d\\mathbf{x}, \\label{eq:ebm}\n\\end{aligned}')
('2', '\\tau >0')
('2', '\\mathcal{X}')
('2', 'Z')
('2', '\\min_{q \\in \\mathcal{Q}} KL(p || q)')
('2', 'p(\\mathbf{x})')
('2', '\\mathcal{Q}')
('2', 'q(\\mathbf{x})')
('2', 'KL(p || q)=\\int_{\\mathcal{X}} p(\\mathbf{x}) \\log (p(\\mathbf{x})/q(\\mathbf{x})) d\\mathbf{x}')
('2', '\\mathcal{T}_{q}')
('2', 'q(\\mathbf{x})')
('2', '\\mathcal{T}_{q}^{k}(p)')
('2', 'k')
('2', '\\mathcal{T}_q')
('2', 'p(\\mathbf{x})')
('2', '\\begin{aligned}\n    \\min_{q\\in \\mathcal{Q}} KL(p||q) - KL(\\mathcal{T}_{q}^{k}(p)||q). \\label{eq:cd}\n\\end{aligned}')
('2', 'KL(p||q) \\geq KL(\\mathcal{T}_{q}^{k}(p)||q)')
('2', 'q(\\mathbf{x})')
('3.0', '\\mathcal{T}_{q}^{k}(p)(\\mathbf{x})')
('3.0', '\\pi(\\mathbf{x})')
('3.0', '\\pi(\\mathbf{x})')
('3.0', '\\mathcal{T}_{q}^{k}(p)(\\mathbf{x})')
('3.0', 'q(\\mathbf{x})')
('3.0', 'p(\\mathbf{x})')
('3.0', 'q(\\mathbf{x})')
('3.0', '\\pi(\\mathbf{x})')
('3.0', '\\mathcal{X}')
('3.0', '\\mathcal{Q}')
('3.0', '\\Pi')
('3.0', 'q(\\mathbf{x})')
('3.0', '\\pi(\\mathbf{x})')
('3.0', '\\begin{aligned}\n    \\inf_{q\\in\\mathcal{Q}} \\textcolor{blue}{\\sup_{\\pi\\in\\Pi}} KL(p||q) - KL(\\textcolor{blue}{\\pi} ||q), \\label{eq:gcd}\n\\end{aligned}')
('3.0', 'p(\\mathbf{x})\\in\\mathcal{Q}=\\Pi')
('3.0', 'p(\\mathbf{x})=q(\\mathbf{x})=\\pi(\\mathbf{x})')
('3.0', '\\begin{aligned}\n\\label{eq:gcd-learning-energy}\n\\inf_{E\\in\\mathcal{E}}\\sup_{\\pi\\in\\Pi}  \\mathbb{E}_{p}[E(\\mathbf{x})]  - \\mathbb{E}_{\\pi}[E(\\mathbf{x})] + \\tau \\mathcal{H}(\\pi),\n\\end{aligned}')
('3.0', '\\mathcal{H}(\\pi)=-\\int \\pi(\\mathbf{x}) \\log \\pi(\\mathbf{x})d\\mathbf{x}')
('3.0', '\\pi(\\mathbf{x})')
('3.0', '\\mathcal{E}')
('3.0', '\\mathcal{Q}')
('3.0', '\\begin{aligned}\n    \\mathcal{E} := \\left\\{ E : \\mathcal{X} \\rightarrow \\mathbb{R} | \\exp(-E(\\mathbf{x})/\\tau)/Z \\in \\mathcal{Q} \\hbox{ where } Z = \\int \\exp(-E(\\mathbf{x})/\\tau) d\\mathbf{x}< \\infty \\right\\}.\n    % \\centerline{}\n\\end{aligned}')
('3.0', 'E \\in \\mathcal{E}')
('3.0', 'E(\\mathbf{x}) = - \\tau \\log q(\\mathbf{x}) + c')
('3.0', 'q \\in \\mathcal{Q}')
('3.0', 'c')
('3.0', 'E(\\mathbf{x})=-\\tau \\log p(\\mathbf{x}) + c')
('3.0', '\\pi(\\mathbf{x})=p(\\mathbf{x})')
('3.1', 'p(\\mathbf{x})')
('3.1', '\\pi(\\mathbf{x})')
('3.1', '\\pi(\\mathbf{x})')
('3.1', 'E(\\mathbf{x})')
('3.1', '\\mathcal{E}')
('3.1', 'D^\\mathcal{E}(p||\\pi)')
('3.1', 'p(\\mathbf{x})\\in \\mathcal{Q} \\cap \\Pi')
('3.1', '\\mathcal{E}')
('3.1', '\\begin{aligned}\n        \\inf_{\\pi\\in\\Pi} D^\\mathcal{E}(p||\\pi) - \\tau \\mathcal{H}(\\pi), \n        \\hbox{ where } D^\\mathcal{E}(p||\\pi) := \\sup_{E\\in \\mathcal{E}} \\lvert\\mathbb{E}_{p}[E(\\mathbf{x})] - \\mathbb{E}_{\\pi}[E(\\mathbf{x})]\\rvert. \\label{eq:entropy-reg-ipm-min}\n    \n\\end{aligned}')
('3.1', 'E(\\mathbf{x})=-\\tau \\log p(\\mathbf{x}) + c')
('3.1', '\\pi(\\mathbf{x})=p(\\mathbf{x})')
('3.1', '\\tau=0')
('3.1', '\\mathcal{E}')
('3.1', '\\log p(\\mathbf{x})')
('3.2', '\\pi(\\mathbf{x})')
('3.2', '\\pi(\\mathbf{x}_{t+1}|\\mathbf{x}_{t},t)')
('3.2', '\\mathbf{x}_0,\\mathbf{x}_1,\\ldots,\\mathbf{x}_T(=\\mathbf{x})')
('3.2', '\\{(\\mathbf{x}_t, t)\\}_{t=0}^{T}')
('3.2', '\\mathbf{x}')
('3.2', '\\mathbf{x}_T')
('3.2', '\\log p(\\mathbf{x})')
('3.2', '\\log p(\\mathbf{x})')
('3.2', '-E(\\mathbf{x})')
('3.2', '\\pi(\\mathbf{x})')
('3.2', '\\mathcal{H}(\\pi(\\mathbf{x}_T))')
('3.2', '\\mathcal{H}(\\pi(\\mathbf{x}_{t+1}|\\mathbf{x}_t,t))')
('4', '\\pi(\\mathbf{x})')
('4', '\\pi(\\mathbf{x})')
('4', '\\theta')
('4', '\\phi')
('4', 'q_\\theta(\\mathbf{x})')
('4', '\\pi_\\phi(\\mathbf{x})')
('4', '\\begin{aligned}\n    % \\centerline{}\n    \\min_{\\theta} \\max_{\\phi} \\mathcal{L}(\\theta, \\phi), \\; \\mathcal{L}=\\mathbb{E}_{p}[E_\\theta(\\mathbf{x})]  - \\mathbb{E}_{\\pi_\\phi}[E_\\theta(\\mathbf{x})] + \\tau \\mathcal{H}(\\pi_\\phi).\n\\end{aligned}')
('4', 'E_\\theta(\\mathbf{x})')
('4', '\\pi_\\phi(\\mathbf{x})')
('4', '\\tau')
('4', '\\tau=0.1')
('4', '\\pi_\\phi(\\mathbf{x})')
('4', '\\begin{aligned}\n    \\nabla_\\theta \\mathcal{L} =& \\mathbb{E}_{p(\\mathbf{x})}[\\nabla_\\theta E_\\theta(\\mathbf{x})] - \\mathbb{E}_{\\pi_\\phi(\\mathbf{x})}[\\nabla_\\theta E_\\theta(\\mathbf{x})]. \\label{eq:ebm_update_on} \n    % =& -\\mathbb{E}_{p(\\bx)}[\\nabla_\\theta E_\\theta(\\bx)] + \\mathbb{E}_{\\pi_b(\\bx_{0:T})}\\left[\\frac{\\pi_\\phi(\\bx_{0:T})}{\\pi_b(\\bx_{0:T})} \\nabla_\\theta E_\\theta(\\bx_T)\\right]\n    % \\label{eq:ebm_update_off}\n\\end{aligned}')
('4', '-E_\\theta(\\mathbf{x})')
('4', '-E_\\theta(\\mathbf{x})')
('4', '\\begin{aligned}\n    \\nabla_\\phi \\mathcal{L} &= \\nabla_\\phi \\left(\\mathbb{E}_{\\pi_\\phi(\\mathbf{x})}[-E_\\theta(\\mathbf{x})]+\\tau\\cdot\\mathcal{H}(\\pi_\\phi) \\right) = \\mathbb{E}_{\\pi_\\phi(\\mathbf{x})}\\left[ \\nabla_\\phi \\log \\pi_\\phi(\\mathbf{x})( -E_\\theta(\\mathbf{x})-\\tau\\log \\pi_\\phi(\\mathbf{x}))\\right] \\nonumber\\\\\n    &= \\mathbb{E}_{\\pi_\\phi(\\mathbf{x}_{0:T})} \\left[ \\sum_{t=0}^{t={T-1}} \\nabla_\\phi \\log \\pi_\\phi(\\mathbf{x}_{t+1}|\\mathbf{x}_t,t) \\left[-E_\\theta(\\mathbf{x}_T) - \\tau\\log \\pi_\\phi(\\mathbf{x}_T) - B(\\mathbf{x}_t,t)\\right]  \\right], \\label{eq:pg-entropy-baseline}\n\\end{aligned}')
('4', '-\\tau\\log \\pi_\\phi(\\mathbf{x}_T)')
('4', 'B(\\mathbf{x}_t,t)')
('4', '\\log \\pi_\\phi(\\mathbf{x}_T)')
('4', '\\log \\pi_\\phi(\\mathbf{x}_T)')
('4', '\\pi_\\phi(\\mathbf{x})')
('4', '\\log \\pi_\\phi(\\mathbf{x}) \\approx D\\log d_{k}(\\mathbf{x})+c')
('4', 'D')
('4', 'd_{k}(\\mathbf{x})')
('4', 'k')
('4', 'c')
('4', '\\mathbf{x}')
('4', '-E_\\theta(\\mathbf{x})')
('4', '-\\tau \\log \\pi_\\phi(\\mathbf{x}_T)')
('4', 'V(\\mathbf{x}_t,t)=\\mathbb{E}_{\\pi_\\phi}[-E_\\theta(\\mathbf{x}_T)|\\mathbf{x}_t]')
('4', 'V(\\mathbf{x},t)')
('4', '\\min_{V(\\cdot,t)} (V(\\mathbf{x}_{t+1}, t+1) - V(\\mathbf{x}_t, t))^2')
('4', 't=0,\\ldots,T-1')
('4', '\\tau\\mathcal{H}(\\pi_\\phi)=-\\tau\\mathbb{E}_{\\pi_\\phi}[\\log\\pi_\\phi(\\mathbf{x}_T)]')
('4', 'B(\\mathbf{x}_t,t) = V(\\mathbf{x}_t, t) + \\tau \\mathcal{H}(\\pi_\\phi)')
('4', '\\tau')
('4', 'SW')
('4', '\\downarrow')
('4', '\\uparrow')
('4', '\\pm')
('4', '\\pm')
('4', '\\pm')
('4', '\\pm')
('4', '\\pm')
('4', '\\pm')
('4', '\\pm')
('5', 't=T')
('5', '\\pi(\\mathbf{x}_{t+1}|\\mathbf{x}_t,t)')
('5', '10^{-5}')
('5', '10^{-2}')
('5', 'T=5')
('5', '\\tau=0')
('5', 'p(\\mathbf{x})')
('5', 'q(\\mathbf{x})')
('5', 'p(\\mathbf{x})')
('5', 'T')
('5', 'T')
('5', 'T=1000')
('5', '\\tau = 0.05')
('5', '\\tau = 0')
('8.0', '\\pi^*(\\mathbf{x})=q(\\mathbf{x})')
('8.0', '\\Pi=\\mathcal{Q}')
('8.0', '\\min_{q\\in\\mathcal{Q}} KL(p||q)')
('8.0', 'q^*(\\mathbf{x})=p(\\mathbf{x})')
('8.0', 'p \\in \\mathcal{Q}')
('8.1.0', '\\Phi: \\mathcal{E}\\times\\Pi \\longrightarrow \\mathbb{R}')
('8.1.0', '\\begin{aligned}\n\\Phi(E, \\pi) = \\mathbb{E}_{p}[E(\\mathbf{x})]  - \\mathbb{E}_{\\pi}[E(\\mathbf{x})] + \\tau\\;\\mathcal{H}(\\pi).\n\\label{eq:obj_function}\n\\end{aligned}')
('8.1.0', '\\Phi(E, \\pi)')
('8.1.0', '\\begin{aligned}\n    \\inf_{E \\in \\mathcal{E}}\\sup_{\\pi \\in \\Pi} \\mathbb{E}_{p}[E(\\mathbf{x})]  - \\mathbb{E}_{\\pi}[E(\\mathbf{x})] + \\tau\\;\\mathcal{H}(\\pi),\n    \\label{eq:primal}\n\\end{aligned}')
('8.1.0', '\\Phi(E, \\pi)')
('8.1.0', '\\begin{aligned}\n    %\\sup_{\\pi \\in \\Pi}\\inf_{E \\in \\mathcal{E}} \\mathbb{E}_{p}[E(\\bx)]  - \\mathbb{E}_{\\pi}[E(\\bx)] + \\tau\\mathcal{H}(\\pi)\n    % \\label{eq:dual_prob} \n    %&\\Leftrightarrow \n    \\inf_{\\pi \\in \\Pi}\\sup_{E \\in \\mathcal{E}} -\\mathbb{E}_{p}[E(\\mathbf{x})]  + \\mathbb{E}_{\\pi}[E(\\mathbf{x})] - \\tau\\;\\mathcal{H}(\\pi) \n    &=\\inf_{\\pi \\in \\Pi}\\sup_{E\\in \\mathcal{E}} \\lvert\\mathbb{E}_{p}[E(\\mathbf{x})] - \\mathbb{E}_{\\pi}[E(\\mathbf{x})]\\rvert - \\tau \\; \\mathcal{H}(\\pi) \\label{eq:dual_prob-2}  \\\\\n    &= \\inf_{\\pi\\in\\Pi} D^\\mathcal{E}(p||\\pi) - \\tau\\; \\mathcal{H}(\\pi),\n\\end{aligned}')
('8.1.0', '\\mathcal{E}')
('8.1.0.0', '\\Phi')
('8.1.0.0', 'E(\\mathbf{x})')
('8.1.0.0', '\\pi(\\mathbf{x})')
('8.1.0.0', '\\Phi')
('8.1.0.0', 'E^p(\\mathbf{x})= -\\tau\\log{p(\\mathbf{x})} + c')
('8.1.0.0', 'c')
('8.1.0.0', 'p(\\mathbf{x})')
('8.1.0.0', '\\tau')
('8.1.0.0', '(E^*, \\pi^*)=(E^p, p)')
('8.1.0.0', '\\Phi')
('8.1.0.0', 'c')
('8.1.0.0', 'E^p')
('8.1.0.0', '(E^p, p) \\in \\mathcal{E} \\times \\Pi')
('8.1.0.0', 'p \\in \\mathcal {Q} \\cap \\Pi')
('8.1.0.0', '\\begin{aligned}\n    \\Phi(E^p, \\pi) &= \\mathbb{E}_{p}[E^p(\\mathbf{x})] + \\mathbb{E}_{\\pi}[\\tau\\log p - \\tau\\log \\pi]\\\\\n    &= \\mathbb{E}_{p}[E^p(\\mathbf{x})] -\\tau KL(\\pi || p) \\leq \\Phi(E^p,p) \\quad \\forall \\pi \\in \\Pi \\label{eq:duality-left}\n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n    \\Phi(E, p) &= \\mathbb{E}_{p}[E(\\mathbf{x})]  - \\mathbb{E}_{p}[E(\\mathbf{x})] + \\tau\\mathcal{H}(p)\\\\\n    &= \\tau\\mathcal{H}(p) = \\Phi(E^p, p) \\quad \\forall E \\in \\mathcal{E} \\label{eq:duality-right}\n\\end{aligned}')
('8.1.0.0', '\\Phi(E^p, \\pi)\\leq \\Phi(E^p, p) \\leq \\Phi(E, p)')
('8.1.0.0', '(E, \\pi) \\in \\mathcal{E}\\times\\Pi')
('8.1.0.0', '(E^p, p)')
('8.1.0.0', '\\Phi')
('9', '\\mathcal{B}=\\varnothing')
('9', 'i=0')
('9', 'n_{sampler}')
('9', 'n_{PPO}')
('9', 'm')
('9', '\\pi(\\mathbf{x})')
('9', '\\mathcal{B}')
('9', 'E(\\mathbf{x})')
('9', '\\mathcal{B}')
('9', 'V(\\mathbf{x}_t, t)')
('9', '\\mathcal{B}')
('9', '\\pi(\\mathbf{x})')
('9', '\\mathcal{B}_{\\text{on}}')
('9', '\\mathcal{B}')
('9', '\\varnothing')
('9', 'i \\leftarrow i +1')
('10', '\\begin{aligned}\n    \\nabla_\\phi \\mathcal{L} \n    &= \\nabla_\\phi \\int \\pi_\\phi(\\mathbf{x}_T) [-E_\\theta(\\mathbf{x}_T) - \\tau\\log \\pi_\\phi(\\mathbf{x}_T) ] d\\mathbf{x}_T \\\\\n    &= \\int \\nabla_\\phi \\pi_\\phi(\\mathbf{x}_T) [-E_\\theta(\\mathbf{x}_T) - \\tau\\log \\pi_\\phi(\\mathbf{x}_T)] d\\mathbf{x}_T \\\\\n    &= \\int \\nabla_\\phi \\left(\\int  \\pi_\\phi(\\mathbf{x}_{0:T}) d\\mathbf{x}_{0:{T-1}} \\right) [-E_\\theta(\\mathbf{x}_T) - \\tau\\log \\pi_\\phi(\\mathbf{x}_T)] d\\mathbf{x}_T \\\\\n    &= \\int \\nabla_\\phi\\pi_\\phi(\\mathbf{x}_{0:T}) [-E_\\theta(\\mathbf{x}_T) - \\tau\\log \\pi_\\phi(\\mathbf{x}_T)]d\\mathbf{x}_{0:T}\\\\\n    &= \\int \\pi_\\phi(\\mathbf{x}_{0:T}) \\nabla_\\phi \\log \\pi_\\phi(\\mathbf{x}_{0:T}) [-E_\\theta(\\mathbf{x}_T) - \\tau\\log \\pi_\\phi(\\mathbf{x}_T) ] d\\mathbf{x}_{0:T} \\\\\n    &= \\mathbb{E}_{\\pi_\\phi(\\mathbf{x}_{0:T})} \\left[ \\nabla_\\phi \\log \\pi_\\phi(\\mathbf{x}_{0:T})[-E_\\theta(\\mathbf{x}_T)-\\tau\\log\\pi_\\phi(\\mathbf{x}_T)] \\right] \\\\\n    &=\\mathbb{E}_{\\pi_\\phi(\\mathbf{x}_{0:T})} \\left[ \\left(\\sum_{t=0}^{t={T-1}} \\nabla_\\phi \\log \\pi_\\phi(\\mathbf{x}_{t+1}|\\mathbf{x}_t,t)\\right)[-E_\\theta(\\mathbf{x}_T)-\\tau\\log\\pi_\\phi(\\mathbf{x}_T)]  \\right].\n\\end{aligned}')
