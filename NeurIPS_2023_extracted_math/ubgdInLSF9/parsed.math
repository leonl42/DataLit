('1', '11.5')
('1', '2')
('1', '512\\times512')
('1', '2')
('2.0', '\\mathbf{x}')
('2.0', 'p_{\\text{data}}(\\mathbf{x})')
('2.0', '\\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(\\cdot)')
('2.0', '\\bm{\\theta}')
('2.0', '\\label{eqn:train_loss}\n% \\small\n    \\min_{\\bm{\\theta}} \\; \\mathbb{E}_{t\\sim U[0, 1],\\mathbf{x}\\sim p_{\\text{data}}(\\mathbf{x}),\\bm{\\epsilon}\\sim\\mathcal{N}(\\mathbf{0}, \\mathbf{I})} \\; \\lvert\\lvert\\hat{ \\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t) -\\bm{\\epsilon} \\rvert\\rvert_2^2,')
('2.0', 't')
('2.0', '\\bm{\\epsilon}')
('2.0', '\\mathbf{z}_t=\\alpha_t\\mathbf{x}+\\sigma_t\\bm{\\epsilon}')
('2.0', '\\alpha_t')
('2.0', '\\sigma_t')
('2.0', 't')
('2.0', "t'")
('2.0', '% \\small\n\\mathbf{z}_{t^\\prime}=\\alpha_{t^\\prime} \\frac{\\mathbf{z}_t - \\sigma_t \\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t)}{\\alpha_t} + \\sigma_{t^\\prime} \\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t),')
('2.0', "\\mathbf{z}_{t'}")
('2.0', '\\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(\\cdot)')
('2.0', "t'")
('2.0', '0')
('2.0', '\\mathbf{c}')
('2.0', '\\label{eqn:cfg}\n% \\small\n    \\tilde{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\mathbf{c}) = w\\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\mathbf{c}) - (w-1) \\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\varnothing),')
('2.0', '\\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\varnothing)')
('2.0', '\\varnothing')
('2.0', 'w')
('2.1', '8')
('2.1', '369')
('2.1', '1.7')
('2.1', '50')
('2.1', 't')
('2.1', '\\mathbf{c}')
('2.1', '\\small \\textit{Cross-Attention} (Q_{\\mathbf{z}_t}, K_{\\mathbf{c}}, V_{\\mathbf{c}}) = \\textit{Softmax} (\\frac{Q_{\\mathbf{z}_t} \\cdot K_{\\mathbf{c}}^\\top}{\\sqrt{d}}) \\cdot V_{\\mathbf{c}}')
('2.1', 'Q')
('2.1', '\\mathbf{z}_t')
('2.1', 'K')
('2.1', 'V')
('2.1', 'd')
('2.1', '\\label{eq:unet_forward}\n% \\small\n    \\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t) = \\prod \\{ \\textit{Cross-Attention} (\\mathbf{z}_t, \\mathbf{c}), \\textit{ResNet} (\\mathbf{z}_t, t) \\}.')
('3.0', 'p (\\cdot, I)')
('3.0', 'I')
('3.0', '\\label{eqn:robust}\\small\n    \\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}(t, \\mathbf{z}_t) = \\prod \\{ p(\\textit{Cross-Attention} (\\mathbf{z}_t, \\mathbf{c}), I), p(\\textit{ResNet} (\\mathbf{z}_t, t), I) \\}.')
('3.0', '\\hat{\\bm{\\epsilon}}_{\\bm\\theta}')
('3.0', '\\mathbb D_{val}')
('3.0', '\\mathbb{T}:\\{ \\textit{Cross-Attention}[i,j], \\textit{ResNet}[i,j] \\}')
('3.0', '\\hat{\\bm{\\epsilon}}_{\\bm\\theta}')
('3.0', 'S')
('3.0', '\\rightarrow')
('3.0', '\\rightarrow')
('3.0', '\\rightarrow')
('3.0', '\\frac{\\Delta \\textit{CLIP}}{\\Delta \\textit{Latency}}')
('3.0', 'T')
('3.0', 'A \\in \\{ A_{\\textit{Cross-Attention}[i,j]}^{+,-}, A_{\\textit{ResNet}{[i,j]}}^{+,-} \\}')
('3.0', 'A^{+,-}')
('3.0', '-')
('3.0', '+')
('3.0', 'i')
('3.0', 'j')
('3.0', '2')
('3.0', '50')
('3.0', '7.5')
('3.0', '2.5')
('3.0', '\\small \\frac{\\Delta \\textit{CLIP}}{\\Delta \\textit{Latency}}')
('3.1', '3.8\\times')
('3.1', '3.2\\times')
('3.1', '50\\%')
('3.1', '1/4')
('3.1', '50')
('4', '32')
('4', '16')
('4', '2\\times')
('4.0', '\\mathbf{v}')
('4.0', '\\bm{\\epsilon}')
('4.0', '\\hat{\\mathbf{v}}_{\\bm{\\theta}}')
('4.0', '\\bm{\\epsilon}')
('4.0', '\\hat{\\bm{\\epsilon}}_{\\bm{\\theta}}')
('4.0', '\\mathcal{L}_{\\mathrm{ori}}')
('4.0', '\\label{eqn:original_loss}\n    \\mathcal{L}_{\\mathrm{ori}} = \\mathbb{E}_{t\\sim U[0, 1],\\mathbf{x}\\sim p_{\\text{data}}(\\mathbf{x}),\\bm{\\epsilon}\\sim\\mathcal{N}(\\mathbf{0}, \\mathbf{I})} \\; \\lvert\\lvert\\hat{\\mathbf{v}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\mathbf{c})-\\mathbf{v}\\rvert\\rvert_2^2,')
('4.0', '\\mathbf{v}')
('4.0', '\\mathbf{x}')
('4.0', '\\bm{\\epsilon}')
('4.0', 't')
('4.0', '\\mathbf{v} \\equiv \\alpha_t \\bm{\\epsilon} - \\sigma_t \\mathbf{x}')
('4.0', '16')
('4.0', '50')
('4.0', '32')
('4.0', '128')
('4.0', '64')
('4.0', '16')
('4.0', '16')
('4.0', '16')
('4.0', '8')
('4.1', 't')
('4.1', '\\mathbf{z}_t')
('4.1', '\\mathbf{c}')
('4.1', 't')
('4.1', "t'")
('4.1', "t''")
('4.1', "0 \\le t'' < t' < t \\le 1")
('4.1', "% \\small\n\\begin{split}\n    \\hat{\\mathbf{v}}_t = \\hat{\\mathbf{v}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\mathbf{c}) &\\Rightarrow \\mathbf{z}_{t'} = \\alpha_{t'} (\\alpha_t \\mathbf{z}_t - \\sigma_t \\hat{\\mathbf{v}}_t)  + \\sigma_{t'} (\\sigma_t \\mathbf{z}_t + \\alpha_t \\hat{\\mathbf{v}}_t), \\\\\n    \\hat{\\mathbf{v}}_{t'} = \\hat{\\mathbf{v}}_{\\bm{\\theta}}({t'}, \\mathbf{z}_{t'}, \\mathbf{c}) &\\Rightarrow \\mathbf{z}_{t''} = \\alpha_{t''} (\\alpha_{t'} \\mathbf{z}_{t'} - \\sigma_{t'} \\hat{\\mathbf{v}}_{t'})  + \\sigma_{t''} (\\sigma_{t'} \\mathbf{z}_{t'} + \\alpha_{t'} \\hat{\\mathbf{v}}_{t'}).\n\\end{split}\n\\label{eqn:teacher_denoising}")
('4.1', '\\bm{\\eta}')
('4.1', '% \\small\n\\begin{split}\n    \\hat{\\mathbf{v}}^{(s)}_t = \\hat{\\mathbf{v}}_{\\bm{\\eta}}(t, \\mathbf{z}_t, \\mathbf{c}) \\Rightarrow \\hat{\\mathbf{x}}^{(s)}_t = \\alpha_t \\mathbf{z}_t - \\sigma_t \\hat{\\mathbf{v}}^{(s)}_t,\n\\end{split}\n\\label{eqn:student_denoising}')
('4.1', '{(s)}')
('4.1', "\\mathbf{z}_{t''}")
('4.1', '\\mathbf{z}_{t}')
('4.1', '\\mathbf{x}')
('4.1', "% \\small\n\\begin{split}\n    \\mathcal{L}_{\\mathrm{vani\\_dstl}} &= \\varpi(\\lambda_t) \\; || \\; \\hat{\\mathbf{x}}^{(s)}_t - \\frac{\\mathbf{z}_{t''} - \\frac{\\sigma_{t''}}{\\sigma_t} \\mathbf{z}_t }{\\alpha_{t''} - \\frac{\\sigma_{t''}}{\\sigma_t} \\alpha_t} \\; ||^2_2,\n\\end{split}\\label{eqn:vani_dist}")
('4.1', '\\varpi(\\lambda_t) = \\max(\\frac{\\alpha_t^2}{\\sigma_t^2}, 1)')
('4.1', '\\hat{\\mathbf{v}}^{(s)}_t')
('4.1', '% \\small\n\\begin{split}\n    \\tilde{\\mathbf{v}}^{(s)}_t =  w\\hat{\\mathbf{v}}_{\\bm{\\eta}}(t, \\mathbf{z}_t, \\mathbf{c}) - (w-1) \\hat{\\mathbf{v}}_{\\bm{\\eta}}(t, \\mathbf{z}_t, \\mathbf{\\varnothing}),\n\\end{split}\n\\label{eqn:cfg_in_distillation}')
('4.1', 'w')
('4.1', 'w')
('4.1', '[2, 14]')
('4.1', '\\mathcal{L}_{\\mathrm{vani\\_dstl}}')
('4.1', '\\mathcal{L}_{\\mathrm{cfg\\_dstl}}')
('4.1', '\\mathcal{L}_{\\mathrm{vani\\_dstl}}')
('4.1', '\\mathcal{L}_{\\mathrm{cfg\\_dstl}}')
('4.1', 'p')
('4.1', '1 - p')
('4.1', '\\label{eqn:distill_loss_all}\n% \\small\n\\begin{split}\n    \\mathcal{L} &= \\mathcal{L}_{\\mathrm{dstl}} + \\gamma \\mathcal{L}_{\\mathrm{ori}}, \\\\\n    \\mathcal{L}_{\\mathrm{dstl}} &= \\mathcal{L}_{\\mathrm{cfg\\_dstl}} \\text{\\; if \\;} P\\sim U[0, 1] < p \\text{\\; else \\;} \\mathcal{L}_{\\mathrm{vani\\_dstl}},\n\\end{split}')
('4.1', '\\mathcal{L}_{\\mathrm{ori}}')
('4.1', '\\gamma')
('4.1', 'U[0, 1]')
('4.1', '(0, 1)')
('4.1', 'w')
('4.1', '2\\times')
('4.1', 'w')
('4.1', 'w')
('4.1', 'w')
('5', '16')
('5', '32')
('5', '8')
('5', '40')
('5', '80')
('5', '0.01')
('5', '2,048')
('5.0', '30')
('5.0', '8')
('5.0', '230')
('5.0', '0.004-0.010')
('5.0', '8')
('5.0', '2.7')
('5.0', '16')
('5.0', '8')
('5.0', '8')
('5.0', '0.30')
('5.0', '8')
('5.0', '16')
('5.0', '8')
('5.0', '0.002-0.007')
('5.1', '6')
('5.1', '8')
('5.1', '8')
('5.1', 'w')
('5.1', '64 \\rightarrow 32 \\rightarrow 16 \\rightarrow 8')
('5.1', 'w')
('5.1', '8')
('5.1', '50')
('5.1', '8')
('5.1', 'w')
('5.1', '16')
('5.1', '7')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '\\gamma')
('5.1', '16')
('5.1', '8')
('5.1', '32')
('5.1', '8')
('5.1', '16')
('5.1', '16')
('5.1', '8')
('5.1', '8')
('5.1', '50')
('5.1', '1.0')
('5.1', '10.5')
('5.1', '0.5')
('5.1', '8')
('5.1', '16 \\rightarrow 8')
('5.1', '64')
('5.1', '8')
('5.1', '64 \\rightarrow 32 \\rightarrow 16 \\rightarrow 8')
('5.1', 'w')
('5.1', '0.30')
('5.1', '\\mathcal{L}_{\\text{vani\\_dstl}}')
('5.1', '\\mathcal{L}_{\\text{cfg\\_dstl}}')
('5.1', '\\mathcal{L}_{\\mathrm{dstl}}')
('5.1', 'w')
('5.1', '6')
('5.1', '[2, 14]')
('5.1', '0.1')
('5.1', '\\gamma')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '\\mathcal{L}_{\\mathrm{dstl}}')
('5.1', '\\gamma')
('5.1', '0.01, 0.2, 1.0')
('5.1', '0.2')
('5.1', '0.0')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '1.0')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '8')
('5.1', '16')
('5.1', '8')
('5.1', '\\mathcal{L}_{\\mathrm{ori}}')
('5.1', '\\gamma')
('6', 'w')
('7', '1.84')
('8', '\\frac{H}{8}\\times \\frac{W}{8}')
('8', '64\\times 64')
('8', '512\\times 512')
('8', '12\\times')
('8', '46\\%')
('8', '\\times')
('9.0', '4')
('9.1', '369')
('9.1', '230')
('9.1', '\\times')
('9.1', '8')
('9.1', '116')
('9.1', '9.0')
('9.1', '6')
('9.1', '7')
('9.1', '9')
('10', '\\sim')
('10', 't')
('10', '\\mathbf{z}_t')
('10', '\\mathbf{c}')
('10', 't')
('10', "t'")
('10', "t''")
('10', "0 \\le t'' < t' < t \\le 1")
('10', 't')
('10', "t'")
('10', "\\small\n\\begin{split}\n    \\hat{\\mathbf{v}}_t &= \\hat{\\mathbf{v}}_{\\bm{\\theta}}(t, \\mathbf{z}_t, \\mathbf{c}) \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher UNet first forward}}} \\\\\n    \\Rightarrow \\hat{\\mathbf{x}}_t &= \\alpha_t \\mathbf{z}_t - \\sigma_t \\hat{\\mathbf{v}}_t,  \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher predicted clean latent at time~}}}\\textcolor{teal}{t} \\\\\n    \\hat{\\pmb{\\epsilon}}_t &= \\sigma_t \\mathbf{z}_t + \\alpha_t \\hat{\\mathbf{v}}_t, \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher predicted noise at time~}}}\\textcolor{teal}{t} \\\\\n    \\Rightarrow \\mathbf{z}_{t'} &= \\alpha_{t'} \\hat{\\mathbf{x}}_t + \\sigma_{t'} \\hat{\\pmb{\\epsilon}}_t \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher predicted noisy latent at time~}}}\\textcolor{teal}{t'} \\\\\n    &= \\alpha_{t'} (\\alpha_t \\mathbf{z}_t - \\sigma_t \\hat{\\mathbf{v}}_t)  + \\sigma_{t'} (\\sigma_t \\mathbf{z}_t + \\alpha_t \\hat{\\mathbf{v}}_t). \\\\\n\\end{split}\n\\label{eqn:teacher_denoising_1}")
('10', "t'")
('10', "t''")
('10', 't')
('10', "t'")
('10', "t'")
('10', "t''")
('10', "\\small\n\\begin{split}\n    \\hat{\\mathbf{v}}_{t'} &= \\hat{\\mathbf{v}}_{\\bm{\\theta}}(t', \\mathbf{z}_{t'}, \\mathbf{c}) \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher UNet second forward}}} \\\\\n    \\Rightarrow \\hat{\\mathbf{x}}_{t'} &= \\alpha_{t'} \\mathbf{z}_{t'} - \\sigma_{t'} \\hat{\\mathbf{v}}_{t'}, \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher predicted clean latent at time~}}}\\textcolor{teal}{t'} \\\\\n    \\hat{\\pmb{\\epsilon}}_{t'} &= \\sigma_{t'} \\mathbf{z}_{t'} + \\alpha_{t'} \\hat{\\mathbf{v}}_{t'}, \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher predicted noise at time~}}}\\textcolor{teal}{t'} \\\\\n    \\Rightarrow \\mathbf{z}_{t''} &= \\alpha_{t''} \\hat{\\mathbf{x}}_{t'} + \\sigma_{t''} \\hat{\\pmb{\\epsilon}}_{t'} \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Teacher predicted noisy latent at time~}}}\\textcolor{teal}{t''} \\\\\n    &= \\alpha_{t''} (\\alpha_{t'} \\mathbf{z}_{t'} - \\sigma_{t'} \\hat{\\mathbf{v}}_{t'})  + \\sigma_{t''} (\\sigma_t \\mathbf{z}_{t'} + \\alpha_t \\hat{\\mathbf{v}}_{t'}). \\\\\n\\end{split}\n\\label{eqn:teacher_denoising_2}")
('10', '\\bm{\\eta}')
('10', "\\small\n\\begin{split}\n    \\hat{\\mathbf{v}}^{(s)}_t &= \\hat{\\mathbf{v}}_{\\bm{\\eta}}(t, \\mathbf{z}_t, \\mathbf{c}) \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Student UNet forward}}} \\\\\n    \\Rightarrow \\hat{\\mathbf{x}}^{(s)}_t &= \\alpha_t \\mathbf{z}_t - \\sigma_t \\hat{\\mathbf{v}}^{(s)}_t, \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Student predicted clean latent at time~}}}\\textcolor{teal}{t} \\\\\n    % \\Rightarrow \n    \\hat{\\pmb{\\epsilon}}_{t}^{(s)} &= (\\mathbf{z}_t - \\alpha_t \\hat{\\mathbf{x}}^{(s)}_t) / \\sigma_t, \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Student predicted noise at time~}}}\\textcolor{teal}{t} \\\\\n    \\Rightarrow \\mathbf{z}_{t''}^{(s)} &= \\alpha_{t''} \\hat{\\mathbf{x}}_t^{(s)} + \\sigma_{t''} \\hat{\\pmb{\\epsilon}}^{(s)}_t \\;\\;\\; \\vartriangleright{\\textcolor{teal}{\\texttt{Student predicted noisy latent at time~}}}\\textcolor{teal}{t''} \\\\\n    &= \\alpha_{t''} \\hat{\\mathbf{x}}_t^{(s)} + \\frac{\\sigma_{t''} }{\\sigma_t} (\\mathbf{z}_t - \\alpha_t \\hat{\\mathbf{x}}^{(s)}_t) \\\\\n    & = (\\alpha_{t''} - \\frac{\\sigma_{t''} }{\\sigma_t} \\alpha_t) \\hat{\\mathbf{x}}_t^{(s)} + \\frac{\\sigma_{t''} }{\\sigma_t} \\mathbf{z}_t, \\\\\n    \\Rightarrow \\hat{\\mathbf{x}}_t^{(s)} &= \\frac{\\mathbf{z}_{t''}^{(s)} - \\frac{\\sigma_{t''} }{\\sigma_t} \\mathbf{z}_t}{\\alpha_{t''} - \\frac{\\sigma_{t''} }{\\sigma_t} \\alpha_t},\n\\end{split}\n\\label{eqn:student_denoising_supp}")
('10', '{(s)}')
('10', "\\mathbf{z}_{t''}")
('10', '\\mathbf{z}_{t}')
('10', "\\begin{split}\n    \\mathbf{z}_{t''}^{(s)} = \\mathbf{z}_{t''}.\n\\end{split}")
('10', "\\mathbf{z}_{t''}^{(s)}")
('10', "\\mathbf{z}_{t''}")
('10', "\\small\n\\begin{split}\n    \\mathcal{L}_{\\mathrm{vani\\_dstl}} &= \\varpi(\\lambda_t) \\; || \\; \\hat{\\mathbf{x}}^{(s)}_t - \\frac{\\mathbf{z}_{t''} - \\frac{\\sigma_{t''}}{\\sigma_t} \\mathbf{z}_t }{\\alpha_{t''} - \\frac{\\sigma_{t''}}{\\sigma_t} \\alpha_t} \\; ||^2_2,\n\\end{split}")
('10', '\\varpi(\\lambda_t) = \\max(\\frac{\\alpha_t^2}{\\sigma_t^2}, 1)')
('11', '8')
('11', '16')
('11', '16')
('11', '8')
('11', '16')
