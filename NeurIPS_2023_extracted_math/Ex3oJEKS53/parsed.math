('1', '50')
('1', '75')
('2', '\\mathcal{D}')
('2', 'N')
('2', '\\{{\\bm{x}}_n, {\\bm{y}}_n\\}_{n=1}^N')
('2', '{\\bm{x}}_n\\!\\in\\!\\mathbb{R}^D')
('2', '{\\bm{y}}_n\\!\\in\\!\\mathbb{R}^C')
('2', 'f_{\\boldsymbol{\\theta}}\\!:\\!\\mathbb{R}^D\\!\\rightarrow\\!\\mathbb{R}^C')
('2', '{\\boldsymbol{\\theta}}\\!\\in\\!\\mathbb{R}^P')
('2', '\\ell\\!:\\!\\mathbb{R}^C\\!\\times\\!\\mathbb{R}^C\\!\\rightarrow\\!\\mathbb{R}')
('2', '\\ell({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}))\\!= - \\log p({\\bm{y}}| f_{\\boldsymbol{\\theta}}({\\bm{x}}))')
('2', '{\\boldsymbol{\\theta}}_{t+1} = {\\boldsymbol{\\theta}}_t - \\alpha \\nabla_{{\\boldsymbol{\\theta}}_t} \\ell({\\bm{y}}, f_{{\\boldsymbol{\\theta}}_t}({\\bm{x}}))')
('2', 't')
('2', '\\alpha')
('2', '{\\boldsymbol{\\theta}}_t')
('2', '\\label{eq:PGD}\n    {\\boldsymbol{\\theta}}_{t+1} = {\\boldsymbol{\\theta}}_t - \\alpha \\, {\\bm{C}}_t^{-1} \\nabla_{{\\boldsymbol{\\theta}}_t} \\ell({\\bm{y}}, f_{{\\boldsymbol{\\theta}}_t}({\\bm{x}})),')
('2', '{\\bm{C}}_t\\!\\in\\!\\mathbb{R}^{P \\times P}')
('2', '{\\bm{C}}_t')
('2', '{\\bm{H}}_t := \\nabla_{{\\boldsymbol{\\theta}}_t}^2 \\ell({\\bm{y}}, f_{{\\boldsymbol{\\theta}}_t}({\\bm{x}}))')
('2', '{\\bm{H}}_t')
('2.1', 'f_{\\boldsymbol{\\theta}}= f_{{\\boldsymbol{\\theta}}_L}\\!\\circ\\!\\dots\\!\\circ\\!f_{{\\boldsymbol{\\theta}}_\\ell}\\!\\circ\\!\\dots\\!\\circ\\!f_{{\\boldsymbol{\\theta}}_1}')
('2.1', '{\\boldsymbol{\\theta}}= \\mathrm{concat}\\big({\\boldsymbol{\\theta}}_1, \\dots,{\\boldsymbol{\\theta}}_\\ell, \\dots, {\\boldsymbol{\\theta}}_L \\big)')
('2.1', 'L')
('2.1', '\\mathrm{concat}(\\cdot, \\dots, \\cdot)')
('2.1', 'f_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}) = \\phi({\\bm{W}}_\\ell {\\bm{x}}+ {\\bm{b}}_\\ell),')
('2.1', '{\\bm{x}}\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{in}}},')
('2.1', '{\\bm{W}}_\\ell\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{in}}}')
('2.1', '{\\bm{b}}\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{out}}}')
('2.1', '{\\boldsymbol{\\theta}}_\\ell = \\mathrm{concat}\\big( \\mathrm{vec}({\\bm{W}}_\\ell), {\\bm{b}}_\\ell \\big)\\!\\in\\!\\mathbb{R}^{P_\\ell},')
('2.1', 'P_\\ell = P_{\\ell, \\mathrm{out}} P_{\\ell, \\mathrm{in}}\\!+\\!P_{\\ell, \\mathrm{out}}')
('2.1', '\\mathrm{vec}(\\cdot)')
('2.1', '\\phi')
('2.1', 'R')
('2.1', '{\\bm{X}}\\!\\in\\!\\mathbb{R}^{R \\times D}')
('2.1', '{\\bm{X}}{\\bm{W}}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}')
('2.1', '{\\bm{W}}')
('2.1', '{\\bm{W}}')
('2.1', 'R')
('2.1', 'i')
('2.1', '{\\bm{O}}')
('2.1', 'r')
('2.1', '{\\bm{X}}')
('2.1', '{\\bm{o}}_i = \\sum_{r=1}^R A_{i,r} {\\bm{x}}_r,')
('2.1', '{\\bm{A}}\\!\\in\\!\\mathbb{R}^{R \\times R}')
('2.1', '\\sum_{r=1}^R A_{i,r} = 1')
('2.1', '{\\bm{O}}= {\\bm{A}}{\\bm{X}}')
('2.1', 'r')
('2.1', 'i')
('2.1', '{\\bm{A}}')
('2.1', '{\\bm{A}}= \\mathrm{softmax}_{\\mathrm{row}}({\\bm{X}}{\\bm{W}}_Q^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{W}}_K {\\bm{X}}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0})')
('2.1', '{\\bm{W}}_Q\\!\\in\\!\\mathbb{R}^{P_\\mathrm{out} \\times D}')
('2.1', '{\\bm{W}}_K\\!\\in\\!\\mathbb{R}^{P_\\mathrm{out} \\times D}')
('2.1', '\\mathrm{softmax}_{\\mathrm{row}}(\\cdot)')
('2.1', '\\mathrm{softmax}({\\bm{x}})_i := \\exp(x_i) / \\sum_{j=1}^J \\exp(x_j)')
('2.1', '{\\bm{x}}\\!\\in\\!\\mathbb{R}^J')
('2.1', '{\\bm{W}}_Q, {\\bm{W}}_K')
('2.1', 'R')
('2.1', '2')
('2.1', '{\\bm{X}}^I\\!\\in\\!\\mathbb{R}^{C_\\mathrm{in} \\times H \\times W}')
('2.1', 'C_\\mathrm{in}')
('2.1', 'H')
('2.1', 'W')
('2.1', 'K\\!\\times\\!K')
('2.1', '4')
('2.1', 'C_\\mathrm{out}\\!\\times\\!C_\\mathrm{in}\\!\\times\\!K\\!\\times\\!K')
('2.1', 'C_\\mathrm{out}')
('2.1', '1')
('2.1', '{\\bm{O}}^I\\!\\in\\!\\mathbb{R}^{C_\\mathrm{out} \\times H \\times W}')
('2.1', "o_{d, i, j}^I = \\sum_{c=1}^{C_\\mathrm{in}} \\sum_{k=1}^{K} \\sum_{k'=1}^{K} X_{c, i+k-1, j+k'-1}^I W_{d, c, k, k'};")
('2.1', "X_{c, i+k-1, j+k'-1}")
('2.1', '0')
('2.1', '{\\bm{X}}\\!\\in\\!\\mathbb{R}^{HW \\times C_\\mathrm{in} K^2}')
('2.1', 'K\\!\\times\\!K')
('2.1', 'H\\!\\cdot\\!W')
('2.1', '{\\bm{W}}\\in \\mathbb{R}^{C_\\mathrm{out} \\times C_\\mathrm{in} K^2}')
('2.1', '{\\bm{O}}= {\\bm{X}}{\\bm{W}}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\in\\!\\mathbb{R}^{HW \\times C_\\mathrm{out}}')
('2.1', 'R = HW')
('2.1', 'R=N_V')
('2.1', 'R=N_E')
('2.2', '{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))\\!:=\\!\\nabla_{f_{\\boldsymbol{\\theta}}}^2 \\ell({\\bm{y}}_n, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))\\!\\in\\!\\mathbb{R}^{C \\times C}')
('2.2', '\\label{eq:GGN}\n    \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}) = \\sum_{n=1}^N {\\bm{J}}_{\\boldsymbol{\\theta}}f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{J}}_{\\boldsymbol{\\theta}}f_{\\boldsymbol{\\theta}}({\\bm{x}}_n),')
('2.2', 'f_{\\boldsymbol{\\theta}}')
('2.2', 'g^{-1}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) - {\\bm{y}}_n')
('2.2', 'g^{-1}')
('2.2', '{\\bm{C}}_t')
('2.3', 'P\\!\\times\\!P')
('2.3', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)\\!:=\\!{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)\\!=\\!{\\bm{J}}_{{\\bm{s}}_{\\ell, n}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n}\\!\\in\\!\\mathbb{R}^{C \\times P_\\ell}')
('2.3', '\\ell')
('2.3', '{\\bm{s}}_{\\ell, n}\\!=\\!{\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n}\\!=\\!({\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}})\\,\\mathrm{vec}({\\bm{W}}_\\ell)')
('2.3', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n}\\!=\\!{\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}.')
('2.3', '{\\bm{b}}_{\\ell, n}\\!:=\\!{\\bm{J}}_{{\\bm{s}}_{\\ell, n}}f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times C}')
('2.3', '\\ell')
('2.3', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!=\\!({\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}})^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{b}}_{\\ell, n}\\!=\\!{\\bm{a}}_{\\ell, n}\\!\\otimes {\\bm{b}}_{\\ell, n}')
('2.3', '\\ell')
('2.3', '\\label{eq:kfac}\n  \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) \\approx \\underbrace{\\left[ \\frac{1}{N} \\sum_{n=1}^N {\\bm{a}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: {\\bm{A}}_\\ell} \\otimes \\underbrace{\\left[ \\sum_{n=1}^N {\\bm{b}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{b}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: {\\bm{B}}_\\ell},')
('2.3', '{\\bm{a}}_{\\ell, n}\\!\\otimes {\\bm{b}}_{\\ell, n}')
('2.3', '{\\bm{A}}\\otimes {\\bm{B}}')
('2.3', '\\mathrm{vec}(\\cdot)')
('3.0', '\\ell')
('3.0', '\\ell')
('3.0', '{\\bm{A}}_{\\ell, n}\\!\\in\\!\\mathbb{R}^{R \\times P_{\\ell, \\mathrm{in}}}')
('3.0', '\\bm{{\\tilde{a}}}_{\\ell, n}\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{in}}}')
('3.0', '{\\bm{W}}_\\ell')
('3.0', '\\rightarrow')
('3.0', 'N\\!\\cdot\\!R')
('3.0', 'N\\!\\cdot\\!R')
('3.0', '\\rightarrow')
('3.0', 'N')
('3.0', 'R')
('3.0', '\\ell')
('3.0', '{\\bm{S}}_{\\ell, n}\\!\\in\\!\\mathbb{R}^{R \\times P_{\\ell, \\mathrm{out}}}')
('3.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)')
('3.0', '\\rightarrow')
('3.0', 'N\\!=\\!4, R\\!=\\!2, P_{\\ell, \\mathrm{in}}\\!=\\!8, P_{\\ell, \\mathrm{out}}\\!=\\!8,')
('3.0', 'P_\\ell\\!=\\!P_{\\ell, \\mathrm{in}}\\!\\cdot\\!P_{\\ell, \\mathrm{out}}\\!=\\!64')
('3.1', 'N\\!\\cdot\\!R')
('3.1', 'N\\!\\cdot\\!R')
('3.1', '\\mathcal{L}_{\\mathrm{expand}}(f_{\\boldsymbol{\\theta}}, \\mathcal{D})\\!:= - \\sum_{n=1}^N \\sum_{r=1}^R \\log p({\\bm{y}}_{n,r} | f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r)')
('3.1', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r')
('3.1', 'r')
('3.1', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)\\!\\in\\!\\mathbb{R}^{R \\times C}')
('3.1', '{\\bm{y}}_{n,r}')
('3.1', 'r')
('3.1', '{\\bm{Y}}_n\\!\\in\\!\\mathbb{R}^{R \\times C}')
('3.1', 'N')
('3.1', 'R')
('3.1', 'r')
('3.1', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)\\!\\in\\!\\mathbb{R}^{R \\times C}')
('3.1', '{\\boldsymbol{\\theta}}_\\ell')
('3.1', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r\\!=\\!\\sum_{m=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, m}')
('3.1', '{\\boldsymbol{\\theta}}_\\ell')
('3.1', 'R')
('3.1', 'r')
('3.1', '{\\bm{S}}_{\\ell, n}')
('3.1', '{\\bm{s}}_{\\ell, n, r}\\!=\\!{\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n, r}')
('3.1', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r}\\!=\\!{\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\otimes\\!\\mathbf{I}_{P_{\\ell, \\mathrm{out}}}')
('3.1', '{\\bm{b}}_{\\ell, n, r, m}\\!:=\\!{\\bm{J}}_{{\\bm{s}}_{\\ell, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}')
('3.1', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!=\\!\\sum_{m=1}^R {\\bm{a}}_{\\ell, n, m}\\!\\otimes\\!{\\bm{b}}_{\\ell, n, r, m}')
('3.1', 'N')
('3.1', 'N\\!\\cdot\\!R')
('3.1', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r')
('3.1', '\\sum_{m=1}^R {\\bm{b}}_{\\ell, n, r, m}')
('3.1', "\\begin{split}\n    \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) &= \\sum_{n=1}^N \\sum_{r=1}^R \\left( \\sum_{m=1}^R {\\bm{a}}_{\\ell, n, m} \\otimes {\\bm{b}}_{\\ell, n, r, m} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) \\left( \\sum_{m'=1}^R {\\bm{a}}_{\\ell, n, m'}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{b}}_{\\ell, n, r, m'}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\\\\n    &\\approx \\sum_{n=1}^N \\sum_{r=1}^R \\sum_{m=1}^R \\left( {\\bm{a}}_{\\ell, n, m} \\otimes {\\bm{b}}_{\\ell, n, r, m} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) \\left( {\\bm{a}}_{\\ell, n, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{b}}_{\\ell, n, r, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right),\n\\end{split}")
('3.1', "m\\!\\neq\\!m'")
('3.1', '1/R')
('3.1', 'N\\!\\cdot\\!R')
('3.1', 'N')
('3.1', '\\label{eq:kfac_expand}\n  \\bm{{\\hat{\\mathrm{GGN}}}}_{{\\boldsymbol{\\theta}}_\\ell}^{\\mathrm{expand}} := \\underbrace{\\left[ \\frac{1}{NR} \\sum_{n=1}^N \\sum_{m=1}^R {\\bm{a}}_{\\ell, n, m} {\\bm{a}}_{\\ell, n, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{= {\\bm{A}}_\\ell} \\otimes  \\underbrace{\\left[\\sum_{n=1}^N \\sum_{m=1}^R \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{b}}_{\\ell, n, r, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{= {\\bm{B}}_\\ell}')
('3.1', '\\label{eq:deep_linear}\n    f_{\\boldsymbol{\\theta}}({\\bm{x}}) = {\\bm{W}}_L \\dots {\\bm{W}}_\\ell \\dots {\\bm{W}}_1 {\\bm{x}}= {\\bm{W}}{\\bm{x}},')
('3.1', '{\\bm{x}}\\!\\in\\!\\mathbb{R}^D')
('3.1', '{\\bm{W}}_L\\!\\in\\!\\mathbb{R}^{C \\times P_{L, \\mathrm{in}}}, {\\bm{W}}_\\ell\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{in}}}')
('3.1', 'P_{\\ell, \\mathrm{in}}\\!=\\!P_{\\ell-1, \\mathrm{out}})')
('3.1', '{\\bm{W}}_1\\!\\in\\!\\mathbb{R}^{P_{1, \\mathrm{out}} \\times D}')
('3.1', '{\\bm{W}}')
('3.1', 'L')
('3.1', '{\\bm{X}}\\!\\in\\!\\mathbb{R}^{R \\times D}')
('3.1', '\\ell')
('3.1', '{\\boldsymbol{\\Sigma}}\\!\\in\\!\\mathbb{R}^{C \\times C}')
('3.2', 'N')
('3.2', '\\mathcal{L}_{\\mathrm{reduce}}(f_{\\boldsymbol{\\theta}}, \\mathcal{D})\\!:= - \\sum_{n=1}^N \\log p({\\bm{y}}_n | f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))')
('3.2', 'f_{\\boldsymbol{\\theta}}.')
('3.2', '{\\bm{A}}_{\\ell, n}\\!\\in\\!\\mathbb{R}^{R \\times P_{\\ell, \\mathrm{in}}}')
('3.2', '{\\bm{S}}_{\\ell, n}\\!=\\!{\\bm{A}}_{\\ell, n} {\\bm{W}}_\\ell^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\in\\!\\mathbb{R}^{R \\times P_{\\ell, \\mathrm{out}}}.')
('3.2', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{S}}_{\\ell, n}')
('3.2', '{\\bm{J}}_{{\\bm{S}}_{\\ell, n}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)')
('3.2', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)\\!=\\!\\sum_{r=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r}')
('3.2', '{\\bm{s}}_{\\ell, n, r}\\!\\in\\!\\mathbb{R}^{P_{\\ell, \\mathrm{out}}}')
('3.2', 'r')
('3.2', '{\\bm{S}}_{\\ell, n}')
('3.2', '{\\bm{s}}_{\\ell, n, r}\\!=\\!{\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n, r}')
('3.2', '\\ell')
('3.2', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r} \\approx \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r}. % =: \\bm{{\\hat{a}}}_{\\ell, n} \\otimes \\bm{{\\hat{b}}}_{\\ell, n}$.')
('3.2', 'R')
('3.2', 'N')
('3.2', 'N')
('3.2', '\\label{eq:kfac_reduce}\n\\begin{split}\n    &\\bm{{\\hat{\\mathrm{GGN}}}}_{{\\boldsymbol{\\theta}}_\\ell}^{\\mathrm{reduce}}\\!:=\\!\\\\\n    &\\underbrace{\\!\\left[\\!\\frac{1}{N\\!R^2}\\!\\sum_{n=1}^N\\!\\left(\\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\right)\\! \\left(\\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\!\\right) \\right]}_{= \\bm{{\\hat{A}}}_\\ell}\\otimes \\underbrace{\\left[\\sum_{n=1}^N\\!\\left(\\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r}\\!\\right) \\!{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{X}}_n))\\!\\left( \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\right]}_{= \\bm{{\\hat{B}}}_\\ell}.\n\\end{split}')
('3.2', 'z: \\mathbb{R}^{R \\times P_{\\ell, \\mathrm{out}}} \\rightarrow \\mathbb{R}^{P_{\\ell, \\mathrm{out}}}')
('3.2', 'z({\\bm{S}}_{\\ell, n})\\!=\\!c \\sum_{r=1}^R {\\bm{s}}_{\\ell, n, r}')
('3.2', 'c\\!\\in\\!\\mathbb{R}')
('3.2', 'c\\!=\\!\\sfrac{1}{R}')
('3.2', '\\ell')
('3.2', '{\\boldsymbol{\\Sigma}}\\!\\in\\!\\mathbb{R}^{C \\times C}')
('3.2', '{\\bm{A}}_\\ell')
('3.2', '\\mathcal{O}(NRP_{\\ell, \\mathrm{in}}^2)')
('3.2', '\\mathcal{O}(NP_{\\ell, \\mathrm{in}} (P_{\\ell, \\mathrm{in}}\\!+\\!R))')
('3.2', '\\bm{{\\hat{A}}}_\\ell')
('3.2', '{\\bm{B}}_\\ell')
('3.2', '\\bm{{\\hat{B}}}_\\ell,')
('3.2', '\\mathcal{O}(NRCP_{\\ell, \\mathrm{out}}(C\\!+\\!P_{\\ell, \\mathrm{out}}))')
('3.2', '\\mathcal{O}(NCP_{\\ell, \\mathrm{out}}(C\\!+\\!P_{\\ell, \\mathrm{out}}\\!+\\!R))')
('3.2', 'R')
('3.2', '\\mathcal{O}(NR(P_{\\ell, \\mathrm{in}} + P_{\\ell, \\mathrm{out}}))')
('3.2', '\\mathcal{O}(N(P_{\\ell, \\mathrm{in}} + P_{\\ell, \\mathrm{out}}))')
('4', '0.75')
('4.0', '128')
('4.0', '256')
('4.0', '512')
('4.0', '1024')
('4.0', '2048')
('4.0', '0.24')
('4.0', '0.38')
('4.0', '0.75')
('4.0', '1.36')
('4.0', '0.17')
('4.0', '0.24')
('4.0', '0.43')
('4.0', '0.63')
('4.0', '1.17')
('4.0', '2048')
('4.0', '2048')
('4.0', '4.5\\times\\!')
('4.0', '70\\%')
('4.1', '0.28098')
('4.1', '10')
('4.1', '31{,}887 \\pm 2{,}070')
('4.1', '16{,}106 \\pm 863')
('4.1', '15{,}566 \\pm 429')
('4.1', '51\\,\\%')
('4.1', '49\\,\\%')
('4.1', '2.33 \\pm 0.22')
('4.1', '1.32 \\pm 0.11')
('4.1', '1.23 \\pm 0.03')
('4.1', '57\\,\\%')
('4.1', '53\\,\\%')
('4.1', '\\approx\\!50\\,\\%')
('4.1', '10')
('4.2', '50')
('4.2', '0.77309')
('4.2', '122{,}139 \\pm 1119')
('4.2', '26.10 \\pm 0.24')
('4.2', '87{,}464 \\pm 245')
('4.2', '19.57 \\pm 0.13')
('4.2', '92{,}550 \\pm 731')
('4.2', '20.28 \\pm 0.00')
('4.2', '72\\,\\%')
('4.2', '75\\,\\%')
('4.2', '76\\,\\%')
('4.2', '78\\,\\%')
('4.2', '1.36\\times\\!')
('4.2', '50')
('4.3', '\\downarrow')
('4.3', '\\uparrow')
('4.3', '\\downarrow')
('4.3', '0.42')
('4.3', '88.9')
('4.3', '100')
('4.3', '0.24')
('4.3', '92.5')
('4.3', '0.70')
('4.3', '86.7')
('4.3', '50.5')
('4.3', '0.35')
('4.3', '93.5')
('4.3', '100')
('7', '\\mathcal{G} := (\\mathcal{V}, \\mathcal{E})')
('7', '\\mathcal{V}')
('7', 'N')
('7', '\\mathcal{E}')
('7', '{\\bm{C}}\\in \\mathbb{R}^{N \\times N}')
('7', 'C_{ij} = 0')
('7', 'C_{ij} = 1')
('7', '\\ell')
('7', 'f_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{X}}) = \\phi(\\bm{{\\hat{C}}} {\\bm{X}}{\\bm{W}}_\\ell^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0})')
('7', '{\\bm{X}}\\in \\mathbb{R}^{N \\times P_{\\ell, \\mathrm{in}}}')
('7', 'N')
('7', '{\\bm{x}}_n')
('7', 'P_{\\ell, \\mathrm{in}}')
('7', '\\bm{{\\hat{C}}} := ({\\bm{D}}+ \\mathbf{I}_N)^{-\\frac{1}{2}} ({\\bm{C}}+ \\mathbf{I}_N) ({\\bm{D}}+ \\mathbf{I}_N)^{-\\frac{1}{2}}')
('7', '{\\bm{D}}')
('7', '\\mathbf{I}_N')
('7', 'N \\times N')
('7', '\\label{eq:gcn_input}\n  \\bm{\\tilde{x}}_n := \\sum_{j=1}^N \\bm{{\\hat{C}}}_{nj} {\\bm{x}}_j = \\sum_{j \\in \\mathcal{N}(n)} \\bm{{\\hat{C}}}_{nj} {\\bm{x}}_j,')
('7', '\\label{eq:gcn}\n  f_{{\\boldsymbol{\\theta}}_\\ell}(\\bm{\\tilde{x}}_n) = \\phi({\\bm{W}}_\\ell \\bm{\\tilde{x}}_n),')
('7', '\\mathcal{N}(n) := \\{j \\in \\{1, \\dots, N\\} | \\bm{{\\hat{C}}}_{nj} \\neq 0 \\}')
('7', 'n.')
('7', '{\\bm{x}}_n')
('7', '\\mathcal{N}(n).')
('7', '{\\bm{W}}_\\ell')
('7', '\\bm{\\tilde{x}}_n')
('7', '\\mathcal{G} = ({\\bm{u}}, \\mathcal{V}, \\mathcal{E})')
('7', '{\\bm{u}}\\in \\mathbb{R}^{D_u}')
('7', '\\mathcal{V}')
('7', '\\mathcal{E}')
('7', 'i')
('7', 'N')
('7', '{\\mathbb{X}}_n^G := ({\\bm{x}}_n^u, {\\bm{X}}_n^V, {\\bm{X}}_n^E, {\\bm{r}}_n, {\\bm{s}}_n)')
('7', '{\\bm{x}}_n^u \\in \\mathbb{R}^{D_u}')
('7', '{\\bm{X}}_n^V \\in \\mathbb{R}^{N_n^V \\times D_V}')
('7', '{\\bm{X}}_n^E \\in \\mathbb{R}^{N_n^E \\times D_E}')
('7', 'n = 1, \\dots, N')
('7', '{\\bm{r}}_n \\in \\mathbb{R}^{N_n^E}')
('7', '{\\bm{s}}_n \\in \\mathbb{R}^{N_n^E}')
('7', '{\\bm{X}}_{n, {\\bm{r}}_n}^V \\in \\mathbb{R}^{N_n^E \\times D_V}')
('7', '{\\bm{X}}_{n, {\\bm{s}}_n}^V \\in \\mathbb{R}^{N_n^E \\times D_V}')
('7', '{\\bm{X}}_n^V')
('7', '{\\bm{s}}_n')
('7', '{\\bm{r}}_n')
('7', 'N_n^V')
('7', 'N_n^E')
('7', 'n \\in \\{1, \\dots, N \\}')
('7', '({\\bm{x}}_n^u, {\\bm{X}}_n^V, {\\bm{X}}_n^E)')
('7', '\\phi')
('7', '\\begin{split}\n  {\\bm{X}}_n^E &\\leftarrow \\phi^E({\\bm{X}}_n^E, {\\bm{X}}_{n, {\\bm{r}}_n}^V, {\\bm{X}}_{n, {\\bm{s}}_n}^V, {\\bm{x}}_n^u) \\\\\n  {\\bm{X}}_n^V &\\leftarrow \\phi^V({\\bm{X}}_n^V, \\bm{\\tilde{X}}_n^E, {\\bm{x}}_n^u) \\\\\n  {\\bm{x}}_n^u &\\leftarrow \\phi^u({\\bm{x}}_n^u, \\bm{\\bar{X}}_n^V, \\bm{\\bar{X}}_n^E),\n\\end{split}')
('7', '\\rho')
('7', '\\begin{split}\n    \\bm{\\tilde{X}}_n^E &\\leftarrow \\rho^{E \\rightarrow V}({\\bm{X}}_n^E) \\\\\n    \\bm{\\bar{X}}_n^E &\\leftarrow \\rho^{E \\rightarrow u}({\\bm{X}}_n^E) \\\\\n    \\bm{\\bar{X}}_n^V &\\leftarrow \\rho^{V \\rightarrow u}({\\bm{X}}_n^V).\n\\end{split}')
('7', 'n \\in \\{1, \\dots, N\\}')
('7', '{\\bm{X}}_n^E')
('7', '\\phi^E({\\bm{X}}_n^E, {\\bm{X}}_{n, {\\bm{r}}_n}^V, {\\bm{X}}_{n, {\\bm{s}}_n}^V, {\\bm{x}}_n^u)')
('7', '\\bm{\\tilde{X}}_n^E \\in \\mathbb{R}^{N_n^V \\times D_E}')
('7', '\\rho^{E \\rightarrow V}({\\bm{X}}_n^E)')
('7', '{\\bm{X}}_n^V')
('7', '\\phi^V({\\bm{X}}_n^V, \\bm{\\tilde{X}}_n^E, {\\bm{x}}_n^u)')
('7', '\\bm{\\bar{X}}_n^E \\in \\mathbb{R}^{D_E}')
('7', '\\rho^{E \\rightarrow u}({\\bm{X}}_n^E)')
('7', '\\bm{\\bar{X}}_n^V \\in \\mathbb{R}^{D_V}')
('7', '\\rho^{V \\rightarrow u}({\\bm{X}}_n^V)')
('7', '{\\bm{x}}_n^u')
('7', '\\phi^u({\\bm{x}}_n^u, \\bm{\\bar{X}}_n^V, \\bm{\\bar{X}}_n^E)')
('7', '\\phi')
('7', '\\rho')
('7', '{\\bm{x}}_n^u')
('7', '\\begin{split}\n  \\phi^E({\\bm{X}}_n^E, {\\bm{X}}_{n, {\\bm{r}}_n}^V, {\\bm{X}}_{n, {\\bm{s}}_n}^V, {\\bm{x}}_n^u) &:= \\mathrm{concat}({\\bm{X}}_n^E, {\\bm{X}}_{n, {\\bm{r}}_n}^V, {\\bm{X}}_{n, {\\bm{s}}_n}^V, \\mathrm{repeat}_{N_n^E}({\\bm{x}}_n^u)) {\\bm{W}}^{E^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} \\\\ % \\in \\R^{N_n^E \\times D_E} \\\\\n  \\phi^V({\\bm{X}}_n^V, \\bm{\\tilde{X}}_n^E, {\\bm{x}}_n^u) &:= \\mathrm{concat}({\\bm{X}}_n^V, \\bm{\\tilde{X}}_n^E, \\mathrm{repeat}_{N_n^V}({\\bm{x}}_n^u)) {\\bm{W}}^{V^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} \\\\ % \\in \\R^{N_n^V \\times D_V} \\\\\n  \\phi^u({\\bm{x}}_n^u, \\bm{\\bar{X}}_n^V, \\bm{\\bar{X}}_n^E) &:= {\\bm{W}}^u \\mathrm{concat}({\\bm{x}}_n^u, \\bm{\\bar{X}}_n^V, \\bm{\\bar{X}}_n^E) \\\\ % \\in \\R^{D_u},\n\\end{split}')
('7', '{\\bm{W}}^E \\in \\mathbb{R}^{D_E \\times (D_E + 2D_V + D_u)}, {\\bm{W}}^V \\in \\mathbb{R}^{D_V \\times (D_V + D_E + D_u)}')
('7', '{\\bm{W}}^u \\in \\mathbb{R}^{D_u \\times 3 D_u}')
('7', '\\phi')
('7', '\\phi^E')
('7', '\\phi^V')
('7', 'N_n^E')
('7', 'N_n^V')
('7', 'N')
('7', 'R_n')
('7', 'n')
('7', '\\phi^u')
('7', '{\\bm{x}}_n^u')
('8.0', '{\\bm{x}}\\sim p({\\bm{x}})')
('8.0', '\\label{eq:FIM}\n\t\\begin{split}\n\t\t{\\bm{F}}({\\boldsymbol{\\theta}}) &= -\\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}| f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[\\nabla_{\\boldsymbol{\\theta}}^2 \\log p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))] \\\\\n\t\t&= \\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}| f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[\\nabla_{\\boldsymbol{\\theta}}\\log  p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) (\\nabla_{\\boldsymbol{\\theta}}\\log p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)))^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}].\n\t\\end{split}')
('8.0', '{\\bm{y}}')
('8.0', '{\\bm{y}}')
('8.0', '{\\bm{y}}_n')
('8.0', '{\\bm{F}}({\\boldsymbol{\\theta}}) \\approx \\mathrm{diag}({\\bm{F}}({\\boldsymbol{\\theta}}_1), \\dots, {\\bm{F}}({\\boldsymbol{\\theta}}_\\ell), \\dots, {\\bm{F}}({\\boldsymbol{\\theta}}_L)) \\in \\mathbb{R}^{P \\times P},')
('8.0', '{\\bm{F}}({\\boldsymbol{\\theta}}_\\ell) \\in \\mathbb{R}^{P_\\ell \\times P_\\ell}')
('8.0', '\\mathrm{diag}(\\cdot, \\dots, \\cdot)')
('8.0', '\\ell')
('8.0', 'n')
('8.0', '{\\bm{x}}_n')
('8.0', '{\\bm{s}}_{\\ell, n} = {\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n},')
('8.0', '{\\bm{W}}_\\ell \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{in}}}')
('8.0', '{\\bm{a}}_{\\ell, n} \\in \\mathbb{R}^{P_{\\ell, \\mathrm{in}}},')
('8.0', '\\ell')
('8.0', '\\ell-1')
('8.0', '{\\bm{b}}_\\ell,')
('8.0', '{\\bm{W}}_\\ell.')
('8.0', '\\ell')
('8.0', '\\nabla_{{\\bm{W}}_\\ell} \\mathcal{L}({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) = \\nabla_{{\\bm{s}}_{\\ell, n}} \\mathcal{L}({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}=: {\\bm{g}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{in}}}.')
('8.0', '\\label{eq:kfac_extended}\n\\begin{align}\n  {\\bm{F}}({\\boldsymbol{\\theta}}_\\ell) &= \\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[\\mathrm{vec}(\\nabla_{{\\bm{W}}_\\ell} \\mathcal{L}({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))) \\mathrm{vec}(\\nabla_{{\\bm{W}}_\\ell} \\mathcal{L}({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)))^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}] \\label{eq:kfac:line-1} \\\\\n  &= \\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[\\mathrm{vec}({\\bm{g}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}) \\mathrm{vec}({\\bm{g}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0})^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}] \\label{eq:kfac:line-2} \\\\\n  &= \\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[({\\bm{a}}_{\\ell, n} \\otimes {\\bm{g}}_{\\ell, n})  ({\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{g}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0})] \\label{eq:kfac:line-3} \\\\\n  &= \\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[{\\bm{a}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{g}}_{\\ell, n} {\\bm{g}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}] \\label{eq:kfac:line-4} \\\\\n  %&\\approx \\frac{1}{N}  \\left[ \\sum_{n=1}^N \\E_{\\vy \\sim p(\\vy|f_\\vtheta(\\vx_n))}[\\va_{\\ell, n} \\va_{\\ell, n}^\\transpose] \\right] \\otimes \\left[ \\sum_{n=1}^N \\E_{\\vy \\sim p(\\vy|f_\\vtheta(\\vx_n))}[\\vg_{\\ell, n} \\vg_{\\ell, n}^\\transpose] \\right] \\label{eq:kfac:line-5} \\\\\n  &\\approx \\underbrace{\\left[ \\frac{1}{N} \\sum_{n=1}^N {\\bm{a}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: {\\bm{A}}_\\ell} \\otimes \\underbrace{\\left[ \\sum_{n=1}^N \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[{\\bm{g}}_{\\ell, n} {\\bm{g}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}] \\right]}_{=: {\\bm{G}}_\\ell} \\label{eq:kfac:line-6},\n\\end{align}')
('8.0', '{\\bm{A}}_\\ell \\in \\mathbb{R}^{P_{\\ell, \\mathrm{in}} \\times P_{\\ell, \\mathrm{in}}}')
('8.0', '{\\bm{G}}_\\ell \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{out}}}.')
('8.0', '{\\bm{A}}, {\\bm{B}}, {\\bm{C}}, {\\bm{D}}')
('8.0', '\\mathrm{vec}({\\bm{A}}{\\bm{B}}{\\bm{C}}) = ({\\bm{C}}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{A}}) \\mathrm{vec}({\\bm{B}})')
('8.0', '({\\bm{A}}\\otimes {\\bm{B}})^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= {\\bm{A}}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{B}}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}')
('8.0', '({\\bm{A}}\\otimes {\\bm{B}})({\\bm{C}}\\otimes {\\bm{D}}) = {\\bm{A}}{\\bm{C}}\\otimes {\\bm{B}}{\\bm{D}}')
('8.0', 'N=1')
('8.0', '\\mathcal{O}(P_{\\ell, \\mathrm{in}}^2 P_{\\ell, \\mathrm{out}}^2)')
('8.0', '\\mathcal{O}(P_{\\ell, \\mathrm{in}}^2 + P_{\\ell, \\mathrm{out}}^2)')
('8.0', '\\mathcal{O}(P_{\\ell, \\mathrm{in}}^3 P_{\\ell, \\mathrm{out}}^3)')
('8.0', '\\mathcal{O}(P_{\\ell, \\mathrm{in}}^3 + P_{\\ell, \\mathrm{out}}^3)')
('8.0', '\\begin{split}\n  {\\bm{F}}({\\boldsymbol{\\theta}}_\\ell)^{-1} {\\bm{g}}({\\boldsymbol{\\theta}}_\\ell) &\\approx ({\\bm{A}}_\\ell \\otimes {\\bm{G}}_\\ell)^{-1} {\\bm{g}}({\\boldsymbol{\\theta}}_\\ell) \\\\\n  &= \\mathrm{vec}\\left( {\\bm{G}}_\\ell^{-1} \\nabla_{{\\bm{W}}_\\ell} \\mathcal{L}({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{A}}_\\ell^{-1} \\right)\n\\end{split}')
('8.0', '{\\bm{g}}({\\boldsymbol{\\theta}}_\\ell) = \\mathrm{vec}\\left( \\nabla_{{\\bm{W}}_\\ell} \\mathcal{L}({\\bm{y}}, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\right)')
('8.0', '({\\bm{A}}\\otimes {\\bm{B}})^{-1} = {\\bm{A}}^{-1} \\otimes {\\bm{B}}^{-1}.')
('8.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n) := {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) = {\\bm{J}}_{{\\bm{s}}_{\\ell, n}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n} \\in \\mathbb{R}^{C \\times P_\\ell}')
('8.0', '\\ell')
('8.0', '{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) := {\\bm{H}}_{f_{\\boldsymbol{\\theta}}} \\mathcal{L}({\\bm{y}}_n, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\in \\mathbb{R}^{C \\times C}')
('8.0', '{\\bm{s}}_{\\ell, n} = {\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n} = ({\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}) \\mathrm{vec}({\\bm{W}}_\\ell)')
('8.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n} = {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}.')
('8.0', '{\\bm{b}}_{\\ell, n} := {\\bm{J}}_{{\\bm{s}}_{\\ell, n}}f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times C}')
('8.0', '\\ell')
('8.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= ({\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}})^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{b}}_{\\ell, n} = {\\bm{a}}_{\\ell, n} \\otimes {\\bm{b}}_{\\ell, n}.')
('8.0', '\\begin{split}\n  \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) &= \\sum_{n=1}^N {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n) \\\\\n  &= \\sum_{n=1}^N ({\\bm{a}}_{\\ell, n} \\otimes {\\bm{b}}_{\\ell, n}) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) ({\\bm{a}}_{\\ell, n} \\otimes {\\bm{b}}_{\\ell, n})^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\\\\n  &= \\sum_{n=1}^N ({\\bm{a}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}) \\otimes ({\\bm{b}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{b}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}) \\\\\n  &\\approx \\underbrace{\\left[ \\frac{1}{N} \\sum_{n=1}^N {\\bm{a}}_{\\ell, n} {\\bm{a}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: {\\bm{A}}_\\ell} \\otimes \\underbrace{\\left[ \\sum_{n=1}^N {\\bm{b}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{b}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: {\\bm{B}}_\\ell}.\n\\end{split}')
('8.0', '{\\bm{y}}')
('8.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)')
('8.1.0', 'N \\cdot R')
('8.1.0', 'N \\cdot R')
('8.1.0', '\\mathcal{L}_{\\mathrm{expand}}(f_{\\boldsymbol{\\theta}}, \\mathcal{D}) := - \\sum_{n=1}^N \\sum_{r=1}^R \\log p({\\bm{y}}_{n,r} | f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r),')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r')
('8.1.0', 'r')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) \\in \\mathbb{R}^{R \\times C}')
('8.1.0', '{\\bm{y}}_{n,r}')
('8.1.0', 'r')
('8.1.0', '{\\bm{Y}}_n\\!\\in\\!\\mathbb{R}^{R \\times C}')
('8.1.0', 'N')
('8.1.0', 'R')
('8.1.0', '{\\bm{x}}_n')
('8.1.0', '\\ell')
('8.1.0', '{\\bm{A}}_{\\ell, n} \\in \\mathbb{R}^{R \\times D}')
('8.1.0', '{\\bm{x}}_n')
('8.1.0', 'r')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) \\in \\mathbb{R}^{R \\times C}')
('8.1.0', '{\\boldsymbol{\\theta}}_\\ell')
('8.1.0', '\\label{eq:expand}\n  ({\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r)_{ij} = \\sum_{m=1}^R \\sum_{p=1}^{P_{\\ell, \\mathrm{out}}} \\frac{\\partial f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_{ri}}{\\partial {\\bm{S}}_{\\ell, n, mp}} \\frac{\\partial {\\bm{S}}_{\\ell, n, mp}}{\\partial {\\boldsymbol{\\theta}}_{\\ell, j}}')
('8.1.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r = \\sum_{m=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, m}.')
('8.1.0', '{\\boldsymbol{\\theta}}_\\ell')
('8.1.0', 'R')
('8.1.0', 'r')
('8.1.0', '{\\bm{S}}_{\\ell, n}')
('8.1.0', '{\\bm{s}}_{\\ell, n, r} = {\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n, r}')
('8.1.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r} = {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, k} := {\\bm{J}}_{{\\bm{s}}_{\\ell, n, k}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}')
('8.1.0', '\\begin{split}\n  {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}&= \\left( \\sum_{m=1}^R {\\bm{b}}_{\\ell, n, r, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}({\\bm{a}}_{\\ell, n, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}) \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\\\\n  %&= \\sum_{m=1}^R (\\va_{\\ell, n, m} \\otimes \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}) \\vb_{\\ell, n, r, m} \\\\\n  &= \\sum_{m=1}^R {\\bm{a}}_{\\ell, n, m} \\otimes {\\bm{b}}_{\\ell, n, r, m}.\n\\end{split}')
('8.1.0', 'N \\cdot R')
('8.1.0', 'N')
('8.1.0', "\\label{eq:kfac_expand_exact}\n\\begin{split}\n  \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) &= \\sum_{n=1}^N \\sum_{r=1}^R {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r \\\\\n  &= \\sum_{n=1}^N \\sum_{r=1}^R \\left( \\sum_{m=1}^R {\\bm{a}}_{\\ell, n, m} \\otimes {\\bm{b}}_{\\ell, n, r, m} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) \\left( \\sum_{m'=1}^R {\\bm{a}}_{\\ell, n, m'}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{b}}_{\\ell, n, r, m'}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right).\n\\end{split}")
('8.1.0', 'N \\cdot R')
('8.1.0', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)_r')
('8.1.0', 'N')
('8.1.0', '\\sum_{m=1}^R {\\bm{b}}_{\\ell, n, r, m}')
('8.1.0', '\\label{eq:kfac_expand_derivation}\n\\begin{split}\n  \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) &\\approx \\sum_{n=1}^N \\sum_{r=1}^R \\sum_{m=1}^R \\left( {\\bm{a}}_{\\ell, n, m} \\otimes {\\bm{b}}_{\\ell, n, r, m} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) \\left( {\\bm{a}}_{\\ell, n, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{b}}_{\\ell, n, r, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\\\\n  &= \\sum_{n=1}^N \\sum_{m=1}^R \\left( {\\bm{a}}_{\\ell, n, m} {\\bm{a}}_{\\ell, n, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{b}}_{\\ell, n, r, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right), \\\\\n\\end{split}')
('8.1.0', "m \\neq m'")
('8.1.0', 'N \\cdot R')
('8.1.0', 'N \\cdot R')
('8.1.0', 'N')
('8.1.0', '\\label{eq:kfac_expand_app}\n  \\bm{{\\hat{\\mathrm{GGN}}}}_{{\\boldsymbol{\\theta}}_\\ell}^{\\mathrm{expand}} := \\underbrace{\\left[ \\frac{1}{NR} \\sum_{n=1}^N \\sum_{m=1}^R {\\bm{a}}_{\\ell, n, m} {\\bm{a}}_{\\ell, n, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{= {\\bm{A}}_\\ell} \\otimes \\underbrace{\\left[\\sum_{n=1}^N \\sum_{m=1}^R \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{b}}_{\\ell, n, r, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{= {\\bm{B}}_\\ell}')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, m} = \\mathbf{0}')
('8.1.0', 'r \\neq m')
('8.1.0', '\\label{eq:kfac_expand_simple}\n  \\sum_{n=1}^N \\sum_{r=1}^R \\left( {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r, r} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) \\left( {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes {\\bm{b}}_{\\ell, n, r, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right).')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r')
('8.1.0', '{\\bm{s}}_{\\ell, n, m}')
('8.1.0', 'm \\neq r')
('8.1.0', 'R')
('8.1.0', '1 / N')
('8.1.0', '1 / NR')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, m} \\neq \\mathbf{0}')
('8.1.0', 'r \\neq m')
('8.1.0', 'N \\cdot R')
('8.1.0', 'N')
('8.1.0', 'N=R=1')
('8.1.0', '{\\bm{a}}_{\\ell, n, r}')
('8.1.0', 'n \\in \\{1, \\dots, N\\}')
('8.1.0', 'r \\in \\{1, \\dots, R\\}')
('8.1.0', '{\\bm{C}}_\\ell \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{out}}}')
('8.1.0', '\\ell')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, m} = \\mathbf{0}')
('8.1.0', 'r \\neq m')
('8.1.0', '{\\bm{b}}_{\\ell, n, m, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_m) {\\bm{b}}_{\\ell, n, m, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= {\\bm{C}}_\\ell')
('8.1.0', 'n \\in \\{1, \\dots, N\\}')
('8.1.0', 'm \\in \\{1, \\dots, R\\},')
('8.1.0', '\\ell')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, m} = \\mathbf{0}')
('8.1.0', 'r \\neq m')
('8.1.0', '\\ell')
('8.1.0', '\\begin{split}\n        &\\left( \\frac{1}{NR} \\sum_{n=1}^N \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( \\sum_{n=1}^N \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r, r} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{b}}_{\\ell, n, r, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\\\\n        = &\\left( \\frac{1}{NR} \\sum_{n=1}^N \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( NR {\\bm{C}}_\\ell \\right) \\\\\n        = &\\left(\\sum_{n=1}^N \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes {\\bm{C}}_\\ell \\\\\n        = &\\sum_{n=1}^N \\sum_{r=1}^R \\left( {\\bm{a}}_{\\ell, n, r} {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( {\\bm{b}}_{\\ell, n, r, r} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{b}}_{\\ell, n, r, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right),\n    \\end{split}')
('8.1.0', '{\\bm{b}}_{\\ell, n, m, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_m) {\\bm{b}}_{\\ell, n, m, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= {\\bm{C}}_\\ell')
('8.1.0', 'n \\in \\{1, \\dots, N\\}')
('8.1.0', 'm \\in \\{1, \\dots, R\\}')
('8.1.0', '{\\boldsymbol{\\Sigma}}\\in \\mathbb{R}^{C \\times C}')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r= {\\bm{W}}_\\ell {\\bm{x}}_{n, r}')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, m} = \\mathbf{0}')
('8.1.0', 'r \\neq m')
('8.1.0', '{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) = {\\boldsymbol{\\Sigma}}^{-1}')
('8.1.0', '{\\bm{b}}_{\\ell, n, m, m} = \\mathbf{I}_C')
('8.1.0', 'P_{\\ell, \\mathrm{out}} = C')
('8.1.0', '{\\bm{b}}_{\\ell, n, m, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) {\\bm{b}}_{\\ell, n, m, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= \\mathbf{I}_C {\\boldsymbol{\\Sigma}}^{-1} \\mathbf{I}_C = {\\boldsymbol{\\Sigma}}^{-1}')
('8.1.0', 'n \\in \\{1, \\dots, N\\}')
('8.1.0', 'm \\in \\{1, \\dots, R\\}')
('8.1.0', '\\label{eq:deep_linear_app}\n    f_{\\boldsymbol{\\theta}}({\\bm{x}}) = {\\bm{W}}_L \\dots {\\bm{W}}_\\ell \\dots {\\bm{W}}_1 {\\bm{x}}= {\\bm{W}}{\\bm{x}},')
('8.1.0', '{\\bm{x}}\\in \\mathbb{R}^D')
('8.1.0', '{\\bm{W}}_L \\in \\mathbb{R}^{C \\times P_{L, \\mathrm{in}}}, {\\bm{W}}_\\ell \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{in}}}')
('8.1.0', 'P_{\\ell, \\mathrm{in}} = P_{\\ell-1, \\mathrm{out}})')
('8.1.0', '{\\bm{W}}_1 \\in \\mathbb{R}^{P_{1, \\mathrm{out}} \\times D}')
('8.1.0', '{\\bm{W}}')
('8.1.0', 'L')
('8.1.0', '{\\bm{W}}_\\ell^a := {\\bm{W}}_L \\dots {\\bm{W}}_{\\ell+1}')
('8.1.0', '{\\bm{W}}_\\ell')
('8.1.0', '{\\bm{W}}_\\ell^b := {\\bm{W}}_{\\ell-1} \\dots {\\bm{W}}_1')
('8.1.0', '{\\bm{W}}_\\ell')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}) = {\\bm{W}}_\\ell^a {\\bm{W}}_\\ell {\\bm{W}}_\\ell^b {\\bm{x}}')
('8.1.0', '{\\bm{a}}_{\\ell, n, r} = {\\bm{W}}_\\ell^b {\\bm{x}}_{n,r} \\in \\mathbb{R}^{P_{\\ell, \\mathrm{in}}}')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, r} = {\\bm{W}}_\\ell^{a^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times C}.')
('8.1.0', 'f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r= {\\bm{W}}{\\bm{x}}_{n, r}')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, m} = \\mathbf{0}')
('8.1.0', 'r \\neq m')
('8.1.0', '{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) = {\\boldsymbol{\\Sigma}}^{-1}')
('8.1.0', '{\\bm{b}}_{\\ell, n, r, r} = {\\bm{W}}_\\ell^{a^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}}')
('8.1.0', '{\\bm{b}}_{\\ell, n, m, m} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_m) {\\bm{b}}_{\\ell, n, m, m}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= {\\bm{W}}_\\ell^{a^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} {\\boldsymbol{\\Sigma}}^{-1} {\\bm{W}}_\\ell^a')
('8.1.0', 'n \\in \\{1, \\dots, N\\}')
('8.1.0', 'm \\in \\{1, \\dots, R\\}')
('8.1.1', 'N')
('8.1.1', '\\label{eq:reduce}\n    \\mathcal{L}_{\\mathrm{reduce}}(f_{\\boldsymbol{\\theta}}, \\mathcal{D}) := - \\sum_{n=1}^N \\log p({\\bm{y}}_n | f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)),')
('8.1.1', 'f_{\\boldsymbol{\\theta}}.')
('8.1.1', '{\\bm{x}}_n')
('8.1.1', '{\\bm{y}}_n')
('8.1.1', 'R')
('8.1.1', '{\\bm{A}}_{\\ell, n} \\in \\mathbb{R}^{R \\times P_{\\ell, \\mathrm{in}}}')
('8.1.1', '{\\bm{S}}_{\\ell, n} = {\\bm{A}}_{\\ell, n} {\\bm{W}}_\\ell^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{R \\times P_{\\ell, \\mathrm{out}}}.')
('8.1.1', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{S}}_{\\ell, n}')
('8.1.1', '{\\bm{J}}_{{\\bm{S}}_{\\ell, n}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)')
('8.1.1', '\\left({\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)\\right)_{ij} = \\sum_{r=1}^R \\sum_{p=1}^{P_{\\ell, \\mathrm{out}}} \\frac{\\partial f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_i}{\\partial {\\bm{S}}_{\\ell, n, rp}} \\frac{\\partial {\\bm{S}}_{\\ell, n, rp}}{\\partial {\\boldsymbol{\\theta}}_{\\ell, j}},')
('8.1.1', '{\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) = \\sum_{r=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r},')
('8.1.1', '{\\bm{s}}_{\\ell, n, r} \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}}}')
('8.1.1', 'r')
('8.1.1', '{\\bm{S}}_{\\ell, n}')
('8.1.1', '{\\bm{s}}_{\\ell, n, r} = {\\bm{W}}_\\ell {\\bm{a}}_{\\ell, n, r}')
('8.1.1', '\\ell')
('8.1.1', '\\label{eq:kfac_reduce_derivation}\n\\begin{split}\n    \\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) &= \\sum_{n=1}^N {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{x}}_n) \\\\\n    &= \\sum_{n=1}^N \\left( \\sum_{r=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\left( \\sum_{r=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r} \\right) \\\\\n    &= \\sum_{n=1}^N \\left( \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\left( \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\\\\n    &\\approx \\sum_{n=1}^N \\underbrace{\\left[ \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\right]}_{=: \\bm{{\\hat{a}}}_{\\ell, n}} \\otimes \\underbrace{\\left[ \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r} \\right]}_{=: \\bm{{\\hat{b}}}_{\\ell, n}} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\left[ \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right] \\otimes \\left[ \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right] \\\\\n    &= \\sum_{n=1}^N \\left( \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( \\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\\\\n    &\\approx \\underbrace{\\left[ \\frac{1}{N} \\sum_{n=1}^N \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: \\bm{{\\hat{A}}}_\\ell} \\otimes \\underbrace{\\left[ \\sum_{n=1}^N \\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: \\bm{{\\hat{B}}}_\\ell},\n\\end{split}')
('8.1.1', 'R')
('8.1.1', 'N')
('8.1.1', 'N')
('8.1.1', '\\label{eq:kfac_reduce_app}\n\\begin{split}\n    &\\bm{{\\hat{\\mathrm{GGN}}}}_{{\\boldsymbol{\\theta}}_\\ell}^{\\mathrm{reduce}} := \\\\\n    &\\underbrace{\\left[ \\frac{1}{NR^2} \\sum_{n=1}^N \\left(\\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\right) \\left( \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\right]}_{= \\bm{{\\hat{A}}}_\\ell} \\otimes  \\underbrace{\\left[\\sum_{n=1}^N \\left( \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)) \\left( \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\right]}_{= \\bm{{\\hat{B}}}_\\ell}.\n\\end{split}')
('8.1.1', '{\\bm{D}}_{\\ell, n} \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times C}')
('8.1.1', '\\ell')
('8.1.1', '{\\bm{x}}_n')
('8.1.1', '{\\bm{C}}_\\ell \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}} \\times P_{\\ell, \\mathrm{out}}}')
('8.1.1', '\\ell')
('8.1.1', 'n')
('8.1.1', '{\\bm{b}}_{\\ell, n, r} = {\\bm{D}}_{\\ell, n}')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', '\\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= {\\bm{C}}_\\ell')
('8.1.1', 'n \\in \\{1, \\dots, N\\}')
('8.1.1', '\\ell')
('8.1.1', '\\begin{split}\n        &\\sum_{n=1}^N \\left( \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\left( \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes \\sum_{r=1}^R {\\bm{b}}_{\\ell, n, r} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\\\\n        = &\\sum_{n=1}^N \\left( \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes R {\\bm{D}}_{\\ell, n} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\left( \\frac{1}{R} \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes R {\\bm{D}}_{\\ell, n} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\\\\n        %= &\\sum_{n=1}^N \\left( \\sum_{r=1}^R \\va_{\\ell, n, r} \\otimes \\mD_{\\ell, n} \\right) \\mLambda(f_\\vtheta(\\vx_n)) \\left( \\sum_{r=1}^R \\va_{\\ell, n, r} \\otimes \\mD_{\\ell, n} \\right)^\\transpose \\\\\n        = &\\sum_{n=1}^N \\left( \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r} \\right) {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))\\left( \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0},\n    \\end{split}')
('8.1.1', 'n')
('8.1.1', '{\\bm{b}}_{\\ell, n, r} = {\\bm{D}}_{\\ell, n}')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', '\\begin{split}\n        &\\left( \\frac{1}{N} \\sum_{n=1}^N \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( \\sum_{n=1}^N \\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\\\\n        = &\\left( \\frac{1}{N} \\sum_{n=1}^N \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes N {\\bm{C}}_\\ell  \\\\\n        %= &\\left( \\sum_{n=1}^N \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\transpose \\right) \\otimes \\mC_\\ell \\\\\n        = &\\sum_{n=1}^N \\left( \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right) \\otimes \\left( \\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right),\n    \\end{split}')
('8.1.1', '\\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= {\\bm{C}}_\\ell')
('8.1.1', 'n \\in \\{1, \\dots, N\\}')
('8.1.1', 'z: \\mathbb{R}^{R \\times P_{\\ell, \\mathrm{out}}} \\rightarrow \\mathbb{R}^{P_{\\ell, \\mathrm{out}}}')
('8.1.1', '{\\bm{b}}_{\\ell, n, r}')
('8.1.1', '{\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} {\\bm{z}}_{\\ell, n}')
('8.1.1', '{\\bm{z}}_{\\ell, n} := z({\\bm{S}}_{\\ell, n}) \\in \\mathbb{R}^{P_{\\ell, \\mathrm{out}}}')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', '\\label{eq:scaled_sum}\n\\begin{split}\n  z({\\bm{S}}_{\\ell, n}) &= c \\sum_{r=1}^R {\\bm{s}}_{\\ell, n, r} \\\\\n  &= c {\\bm{S}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\mathbf{1}_R \\\\\n  &= \\left(\\mathbf{1}_R^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes c \\mathbf{I}_{P_{\\ell, \\mathrm{out}}} \\right) \\mathrm{vec}({\\bm{S}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}) \\\\\n  &= \\left(\\mathbf{1}_R^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\otimes c \\mathbf{I}_{P_{\\ell, \\mathrm{out}}} \\right) {\\bm{K}}^{(R, P_{\\ell, \\mathrm{out}})} \\mathrm{vec}({\\bm{S}}_{\\ell, n}) \\\\\n\\end{split}')
('8.1.1', 'c \\in \\mathbb{R}')
('8.1.1', '{\\bm{K}}^{(R, P_{\\ell, \\mathrm{out}})} := \\sum_{r=1}^R \\sum_{p=1}^{P_{\\ell, \\mathrm{out}}} ({\\bm{e}}_{R, r} {\\bm{e}}_{P_{\\ell, \\mathrm{out}}, p}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}) \\otimes ({\\bm{e}}_{P_{\\ell, \\mathrm{out}}, p} {\\bm{e}}_{R, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}),')
('8.1.1', '{\\bm{e}}_{i,j}')
('8.1.1', 'j')
('8.1.1', 'i')
('8.1.1', '\\mathrm{vec}({\\bm{S}}_{\\ell, n})')
('8.1.1', '{\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} {\\bm{z}}_{\\ell, n} = c \\mathbf{I}_{P_{\\ell, \\mathrm{out}}}')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', 'c=1')
('8.1.1', 'c = 1 / R')
('8.1.1', 'z')
('8.1.1', '\\mathrm{vec}({\\bm{S}}_{\\ell, n})')
('8.1.1', 'c_r \\in \\mathbb{R}')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', '{\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} {\\bm{z}}_{\\ell, n}')
('8.1.1', 'c\\!=\\!\\sfrac{1}{R}')
('8.1.1', '{\\boldsymbol{\\Sigma}}\\in \\mathbb{R}^{C \\times C}')
('8.1.1', '{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) = {\\boldsymbol{\\Sigma}}^{-1}')
('8.1.1', '{\\bm{b}}_{\\ell, n, r} = \\left( {\\bm{J}}_{{\\bm{z}}_{\\ell, n}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} {\\bm{z}}_{\\ell, n} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= c \\mathbf{I}_C')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', 'n \\in \\{1, \\dots, N\\}')
('8.1.1', 'P_{\\ell, \\mathrm{out}} = C')
('8.1.1', '\\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= c^2 R^2 \\mathbf{I}_C {\\boldsymbol{\\Sigma}}^{-1} \\mathbf{I}_C = c^2 R^2 {\\boldsymbol{\\Sigma}}^{-1}')
('8.1.1', 'n \\in \\{1, \\dots, N\\}.')
('8.1.1', '{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)_r) = {\\boldsymbol{\\Sigma}}^{-1}')
('8.1.1', '{\\bm{b}}_{\\ell, n, r} = \\left( {\\bm{J}}_{{\\bm{z}}_{\\ell, n}} f_{\\boldsymbol{\\theta}}({\\bm{x}}_n) {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} {\\bm{z}}_{\\ell, n} \\right)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= c {\\bm{W}}_\\ell^{a^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}}')
('8.1.1', 'r \\in \\{1, \\dots, R\\}')
('8.1.1', 'n \\in \\{1, \\dots, N\\}')
('8.1.1', '\\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}= c^2 R^2 {\\bm{W}}_\\ell^{a^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} {\\boldsymbol{\\Sigma}}^{-1} {\\bm{W}}_\\ell^{a}')
('8.1.1', 'n \\in \\{1, \\dots, N\\}.')
('8.1.1', 'N \\cdot R')
('8.1.1', 'N')
('8.2.0', '{\\bm{W}}^V')
('8.2.0', '\\label{eq:linear_self_attention}\n  f_{\\boldsymbol{\\theta}}({\\bm{X}}_n) = \\underbrace{{\\bm{X}}_n {\\bm{W}}^{Q^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}}}_{=: {\\bm{S}}_{Q, n}} \\underbrace{{\\bm{W}}^K {\\bm{X}}_n^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}}_{=: {\\bm{S}}_{K, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} \\underbrace{{\\bm{X}}_n {\\bm{W}}^{V^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}}}_{=: {\\bm{S}}_{V, n}}.')
('8.2.0', '{\\bm{X}}_n \\in \\mathbb{R}^{R \\times D}')
('8.2.0', 'f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{Q, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r')
('8.2.0', '{\\bm{W}}^Q')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{K, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r')
('8.2.0', '{\\bm{W}}^K')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{V, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r')
('8.2.0', '{\\bm{W}}^V')
('8.2.0', 'r')
('8.2.0', '{\\bm{W}}^Q')
('8.2.0', '{\\bm{s}}_{Q, n, r}')
('8.2.0', 'f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r = {\\bm{s}}_{Q, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{S}}_{K, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{S}}_{V, n}.')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{Q, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r = {\\bm{S}}_{V, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{S}}_{K, n} = {\\bm{b}}_{Q, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{C \\times P_{K, \\mathrm{out}}},')
('8.2.0', 'C = P_{V, \\mathrm{out}}')
('8.2.0', '{\\bm{b}}_{Q, n, r, m} = \\mathbf{0}')
('8.2.0', 'm \\neq r')
('8.2.0', '{\\bm{b}}_{Q, n, r}')
('8.2.0', 'n \\in \\{1, \\dots, N\\}')
('8.2.0', 'r \\in \\{1, \\dots, R\\}')
('8.2.0', '{\\bm{W}}^Q')
('8.2.0', 'N=1')
('8.2.0', 'r')
('8.2.0', 'f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)')
('8.2.0', 'r')
('8.2.0', '{\\bm{S}}_{K/V, n}')
('8.2.0', '{\\bm{S}}_{K/V, n}')
('8.2.0', 'r')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{K/V, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r')
('8.2.0', 'r')
('8.2.0', 'm')
('8.2.0', '{\\bm{W}}^K')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{K, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r = {\\bm{s}}_{V, n, m} {\\bm{s}}_{Q, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{C \\times P_{Q, \\mathrm{out}}}.')
('8.2.0', '{\\bm{W}}^V')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{V, n, m}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_r = {\\bm{s}}_{Q, n, r}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\bm{s}}_{K, n, m} \\mathbf{I}_C \\in \\mathbb{R}^{C \\times C}.')
('8.2.0', 'R')
('8.2.0', 'r')
('8.2.0', 'm')
('8.2.0', 'z')
('8.2.0', 'c')
('8.2.0', '\\begin{split}\n  {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} z(f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)) &= \\sum_{r=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} z(f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell} {\\bm{s}}_{\\ell, n, r} \\\\\n  &= \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes {\\bm{b}}_{\\ell, n, r} \\\\\n  &= \\sum_{r=1}^R {\\bm{a}}_{\\ell, n, r} \\otimes \\left( c \\sum_{m=1}^R {\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_m \\right),\n\\end{split}')
('8.2.0', '{\\bm{J}}_{{\\bm{s}}_{\\ell, n, r}} f_{\\boldsymbol{\\theta}}({\\bm{X}}_n)_m')
('8.2.0', '{\\bm{b}}_{\\ell, n, r}')
('8.2.0', 'r \\in \\{1, \\dots, R\\}')
('8.2.0', 'N=1')
('8.2.0', '{\\bm{W}}^Q')
('8.2.0', 'L')
('8.2.0', '{\\bm{W}}^Q')
('8.2.0', 'r')
('8.2.0', 'r')
('8.2.0', '{\\bm{S}}_{\\ell, Q, n}')
('8.2.0', '{\\bm{W}}_\\ell^Q')
('8.2.0', 'L')
('8.2.0', '{\\bm{W}}_L^Q')
('8.2.1', '\\bm{{\\tilde{a}}}_{\\ell, n}')
('8.2.1', '\\ell')
('8.2.1', 'n')
('8.2.1', '\\mathcal{N}(n)')
('8.2.1', '\\bm{{\\tilde{a}}}_{\\ell, n} := \\sum_{j \\in \\mathcal{N}(n)} \\bm{{\\hat{C}}}_{nj} {\\bm{a}}_{\\ell, j} \\in \\mathbb{R}^{P_{\\ell, \\mathrm{in}}}.')
('8.2.1', '\\begin{split}\n    GGN({\\boldsymbol{\\theta}}_\\ell) &= \\sum_{n=1}^N {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{X}})_n^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{X}})_n) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{X}})_n \\\\\n    &\\approx \\underbrace{\\big[ \\frac{1}{N} \\sum_{n=1}^N \\bm{{\\tilde{a}}}_{\\ell, n} \\bm{{\\tilde{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\big]}_{=: \\bm{{\\tilde{A}}}_\\ell} \\otimes \\underbrace{\\big[ \\sum_{n=1}^N \\bm{{\\tilde{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\bm{X}})_n) \\bm{{\\tilde{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\big]}_{=: \\bm{{\\tilde{B}}}_\\ell},\n\\end{split}')
('8.2.1', '{\\bm{X}}\\in \\mathbb{R}^{N \\times D}')
('8.2.1', '\\bm{{\\tilde{b}}}_{\\ell, n} := {\\bm{J}}_{\\bm{{\\tilde{s}}}_{\\ell, n}} f_{{\\boldsymbol{\\theta}}_\\ell}({\\bm{X}})_n^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}')
('8.2.1', '\\bm{{\\tilde{s}}}_{\\ell, n} := {\\bm{W}}_\\ell \\bm{{\\tilde{a}}}_{\\ell, n}.')
('8.2.1', '{\\bm{x}}_n')
('8.2.1', 'n')
('8.2.1', '{\\bm{X}}')
('8.2.1', '\\bm{{\\hat{C}}}')
('8.2.1', '\\bm{{\\hat{C}}}')
('8.2.1', 'R.')
('8.2.1', 'R_n')
('8.2.1', '{\\mathbb{X}}_n^G')
('8.2.1', 'n')
('8.2.1', '\\phi^E')
('8.2.1', 'R_n = N_n^E,')
('8.2.1', 'R_n = N_n^V')
('8.2.1', '\\phi^V')
('8.2.1', '\\phi^u')
('8.2.1', '\\ell')
('8.2.1', '\\phi^E')
('8.2.1', '\\label{eq:node_inputs}\n  {\\bm{A}}_{\\ell, n} = \\mathrm{concat}({\\bm{X}}_n^E, {\\bm{X}}_{n, {\\bm{r}}_n}^V, {\\bm{X}}_{n, {\\bm{s}}_n}^V, \\mathrm{repeat}_{N_n^E}({\\bm{x}}_n^u)) \\in \\mathbb{R}^{N_n^E \\times (D_E + 2D_V + D_u)}')
('8.2.1', '\\label{eq:edge_inputs}\n  {\\bm{A}}_{\\ell, n} = \\mathrm{concat}({\\bm{X}}_n^V, \\bm{\\tilde{X}}_n^E, \\mathrm{repeat}_{N_n^V}({\\bm{x}}_n^u)) \\in \\mathbb{R}^{N_n^V \\times (D_V + D_E + D_u)}')
('8.2.1', '\\phi^V')
('8.2.1', '{\\bm{b}}_{\\ell, n} = {\\bm{J}}_{{\\bm{S}}_{\\ell, n}}f_{\\boldsymbol{\\theta}}({\\mathbb{X}}_n^G)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{N_n^E \\times D_E \\times C}')
('8.2.1', '\\phi^E')
('8.2.1', '{\\bm{b}}_{\\ell, n} = {\\bm{J}}_{{\\bm{S}}_{\\ell, n}}f_{\\boldsymbol{\\theta}}({\\mathbb{X}}_n^G)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\in \\mathbb{R}^{N_n^V \\times D_V \\times C}')
('8.2.1', '{\\bm{S}}_{\\ell, n} = {\\bm{A}}_{\\ell, n} {\\bm{W}}_\\ell^{E^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} \\in \\mathbb{R}^{N_n^E \\times D_E}')
('8.2.1', '{\\bm{S}}_{\\ell, n} = {\\bm{A}}_{\\ell, n} {\\bm{W}}_\\ell^{V^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}} \\in \\mathbb{R}^{N_n^V \\times D_V}')
('8.2.1', '\\ell')
('8.2.1', '\\phi^E')
('8.2.1', '\\phi^V')
('8.2.1', '\\label{eq:gn_kfac}\n\\begin{split}\n    &\\bm{\\mathrm{GGN}}({\\boldsymbol{\\theta}}_\\ell) = \\sum_{n=1}^N {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\mathbb{X}}_n^G)^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\mathbb{X}}_n^G)) {\\bm{J}}_{{\\boldsymbol{\\theta}}_\\ell}({\\mathbb{X}}_n^G) \\\\\n    %&= \\sum_{n=1}^N \\big( \\sum_{r=1}^{R_n} \\mJ_{\\vtheta_\\ell}(\\vx_{n, r}^G) \\big)^\\transpose \\mLambda(f_\\vtheta(\\sX_n^G)) \\big( \\sum_{r=1}^{R_n} \\mJ_{\\vtheta_\\ell}(\\vx_{n, r}^G) \\big) \\\\\n    %&= \\sum_{n=1}^N \\left( \\sum_{r=1}^{R_n} \\va_{\\ell, n, r} \\otimes \\vb_{\\ell, n, r} \\right) \\mLambda(f_\\vtheta(\\sX_n^G)) \\left( \\sum_{r=1}^{R_n} \\va_{\\ell, n, r} \\otimes \\vb_{\\ell, n, r} \\right)^\\transpose \\\\\n    &\\approx \\sum_{n=1}^N \\! \\underbrace{ \\left[ \\sum_{r=1}^{R_n} \\! \\frac{1}{\\sqrt{R_n}} {\\bm{a}}_{\\ell, n, r} \\right]}_{=: \\bm{{\\hat{a}}}_{\\ell, n}} \\! \\otimes  \\! \\underbrace{ \\left[ \\sum_{r=1}^{R_n} \\! \\frac{1}{\\sqrt{R_n}} {\\bm{b}}_{\\ell, n, r} \\right]}_{=: \\bm{{\\hat{b}}}_{\\ell, n}} \\! {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\mathbb{X}}_n^G)) \\! \\left[ \\sum_{r=1}^{R_n} \\! \\frac{1}{\\sqrt{R_n}} {\\bm{a}}_{\\ell, n, r} \\right] \\! \\otimes \\! \\left[ \\sum_{r=1}^{R_n} \\! \\frac{1}{\\sqrt{R_n}} {\\bm{b}}_{\\ell, n, r} \\right]^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\\\\n    %&= \\sum_{n=1}^N \\left( \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\transpose \\right) \\otimes \\left( \\bm{{\\hat{b}}}_{\\ell, n} \\mLambda(f_\\vtheta(\\sX_n^G)) \\bm{{\\hat{b}}}_{\\ell, n}^\\transpose \\right) \\\\\n    &\\approx \\underbrace{\\left[ \\frac{1}{N} \\sum_{n=1}^N \\bm{{\\hat{a}}}_{\\ell, n} \\bm{{\\hat{a}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: \\bm{{\\hat{A}}}_\\ell} \\otimes \\underbrace{\\left[ \\sum_{n=1}^N \\bm{{\\hat{b}}}_{\\ell, n} {\\boldsymbol{\\Lambda}}(f_{\\boldsymbol{\\theta}}({\\mathbb{X}}_n^G)) \\bm{{\\hat{b}}}_{\\ell, n}^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}\\right]}_{=: \\bm{{\\hat{B}}}_\\ell},\n\\end{split}')
('8.2.1', 'R_n')
('8.2.1', 'n')
('8.2.1', '1/R_n')
('8.2.1', '\\bm{{\\hat{A}}}_\\ell')
('8.2.1', '\\bm{{\\hat{B}}}_\\ell')
('8.2.1', '1/R_n')
('8.2.1', '\\bm{{\\hat{a}}}_{\\ell, n}')
('8.2.1', '\\bm{{\\hat{b}}}_{\\ell, n}')
('8.2.1', 'N')
('8.2.1', '1/\\sqrt{R_n}')
('8.2.1', '\\bm{{\\hat{a}}}_{\\ell, n}')
('8.2.1', '\\bm{{\\hat{b}}}_{\\ell, n}')
('8.3', '\\mathcal{M}')
('8.3', 'M')
('8.3', 'R_m')
('8.3', 'R_\\mathcal{M} := \\sum_{m=1}^M R_m')
('8.3', '1 / R_\\mathcal{M}')
('8.3', '1 / M')
('8.3', '{\\bm{A}}')
('8.3', '{\\bm{B}}')
('8.3', 'C')
('8.3', 'C \\times C')
('8.3', '{\\bm{H}}_{f_{\\boldsymbol{\\theta}}}\\ell({\\bm{y}}_n, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))')
('8.3', 'N')
('8.3', '\\label{eq:mc_fisher}\n  \\mathrm{\\mathbb{E}}_{{\\bm{y}}\\sim p({\\bm{y}}| f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))}[\\nabla_{f_{\\boldsymbol{\\theta}}} \\log  p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)) \\nabla_{f_{\\boldsymbol{\\theta}}} \\log  p({\\bm{y}}|f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))^\\bgroup\\@ifstar{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\mkern-3.5mu\\egroup\\intercal$}\\raise\\dp 0\\box 0}{\\mathpalette\\setbox 0=\\hbox{\\m@th$\\relax\\egroup\\intercal$}\\raise\\dp 0\\box 0}] = {\\bm{H}}_{f_{\\boldsymbol{\\theta}}}\\ell({\\bm{y}}_n, f_{\\boldsymbol{\\theta}}({\\bm{x}}_n))')
('8.3', 'S')
('8.3', '{\\bm{y}}_s \\sim p({\\bm{y}}| f_{\\boldsymbol{\\theta}}({\\bm{x}}_n)')
('9.0', '77.309')
('9.0', '200')
('9.0', '20')
('9.0', '15')
('9.0', '350\\mathrm{k}')
('9.0', '44\\mathrm{k}')
('9.0', '0.28098')
('9.0', '1.3')
('9.0', '50\\mathrm{k}')
('9.0', '10\\mathrm{k}')
('9.0', '0.77309')
('9.0', '10')
('9.0', '128')
('9.0', '256')
('9.0', '512')
('9.0', '1024')
('9.0', '2048')
('9.0', '0.24 \\pm 0.01')
('9.0', '0.38 \\pm 0.02')
('9.0', '0.75 \\pm 0.03')
('9.0', '1.36 \\pm 0.05')
('9.0', '0.17 \\pm 0.01')
('9.0', '0.24 \\pm 0.02')
('9.0', '0.43 \\pm 0.03')
('9.0', '0.63 \\pm 0.04')
('9.0', '1.17 \\pm 0.08')
('9.1', '\\downarrow')
('9.1', '\\downarrow')
('9.1', '9.55 \\pm 0.13')
('9.1', '6.68 \\pm 0.04')
('9.1', '10')
('9.2', '512')
('9.2', '2.4917728606918423')
('9.2', '\\beta_1')
('9.2', '0.9449369031171744')
('9.2', '3{,}000')
('9.2', '0.861509027839639')
('9.2', '60{,}000')
('9.2', '0.75')
('9.2', '[0.1, 10]')
('9.2', '[\\num{1e-3}, 1]')
('9.2', '9.96871902194967')
('9.2', '0.7881965339190345')
('9.2', '0.5885756514016359')
('9.2', '0.0579230193904011')
('9.2', '10')
('9.3', '1{,}024')
('9.3', '\\epsilon = \\num{1e-8}')
('9.3', '4\\times')
('9.3', '0.0008445074561975979')
('9.3', '\\beta_1')
('9.3', '0.8895758153482813')
('9.3', '\\beta_2')
('9.3', '0.9978504782314613')
('9.3', '0.08135402759553023')
('9.3', '6999')
('9.3', '140{,}000')
('9.3', '0.75')
('9.3', '[\\num{1e-4}, \\num{1e-2}]')
('9.3', '0.0012662938340704357')
('9.3', '0.00016524019235426572')
('9.3', '50')
('9.3', '\\beta_2')
('9.3', '10')
('9.3', '\\beta_1 = 0.7132, \\beta_2 = 0.9982')
('9.3', '0.026595')
('9.3', '0.75')
('9.3', '92.6\\mathrm{k}')
('9.3', '93.7\\mathrm{k}')
('9.3', '50')
('9.3', '37')
('9.3', '25')
('9.3', '117.4\\mathrm{k}')
('9.4', '75')
('9.4', '50')
('9.4', '128')
('9.4', '0.1')
('9.4', '100')
('9.4', '\\downarrow')
('9.4', '\\uparrow')
('9.4', '\\downarrow')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
('9.4', '\\pm')
