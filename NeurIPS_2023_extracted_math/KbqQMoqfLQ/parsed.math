('2', 'Q, K, V \\in \\mathbb{R}^{s \\times d}')
('2', 's')
('2', 'd')
('2', '\\mathrm{Attention}(Q, K, V) = \\mathrm{softmax}(\\frac{QK^T}{\\sqrt{d}})V,')
('2', '\\mathrm{softmax}')
('2', 'QK^T')
('2', '\\mathrm{softmax}(\\frac{QK^T}{\\sqrt{d}})')
('2', 'O(s^2)')
('2', 'O(s^2)')
('2', 'O(s^2)')
('2', 'O(s)')
('2', '\\mathrm{FFN}(x)=\\max(0, xW_1 + b_1) W_2 + b_2')
('3', '\\mathrm{softmax}(QK^T)')
('3', 'Q\\in \\mathbb{R}^{s \\times d}')
('3', 'B_q')
('3', 'K, V \\in \\mathbb{R}^{s \\times d}')
('3', 'B_{kv}')
('3', '\\mathrm{Attention}(Q, K, V)')
('3', 'Q_i')
('3', '1 \\leq i \\leq B_q')
('3', '\\begin{aligned}\n    \\mathrm{Attention}(Q_i, K, V) = \\mathrm{Scaling}(\\{\\exp(Q_i K_j^T)V_j\\}_{j=1}^{B_{kv}}).\n\\end{aligned}')
('3', '\\begin{aligned}\n    \\mathrm{Attention}(Q_i, K_j, V_j) & = \\exp\\bigl(Q_i K_j^T - \\max(Q_i K_j^T)\\bigr) / \\sum \\exp\\bigl(Q_i K_j^T - \\max(Q_i K_j^T)\\bigr)  \\\\\n    \\mathrm{max}_i & = \\max \\bigl(\\max(Q_i K_1^T), \\ldots, \\max(Q_i K_B^T)\\bigr) \\\\\n    \\mathrm{Attention}(Q_i, K, V) & = \\bigl[ \\exp(Q_i K_j^T - \\mathrm{max}_i)~\\mathrm{Attention}(Q_i, K_j, V_j) \\bigr]_{j=1}^{B_{kv}}.\n\\end{aligned}')
('3', 'O(n^2)')
('3', '\\begin{aligned}\n\\mathrm{Output}_i = \\mathrm{FFN}\\bigl(\\mathrm{Attention}(Q_i, K, V) + Q_i\\bigr) + \\mathrm{Attention}(Q_i, K, V) + Q_i.\n\\end{aligned}')
('3', 'x')
('3', 'B_q')
('3', 'B_{kv}')
('3', 'x')
('3', 'B_q')
('3', 'B_{kv}')
('3', 'outer')
('3', 'inner')
('3', 'inner')
('3', 'outer')
('3.0', 'Q')
('3.0', 'K')
('3.0', 'V')
('3.0', 'x')
('3.0', '2bsh')
('3.0', 'b')
('3.0', 's')
('3.0', 'h')
('3.0', 'QK^T')
('3.0', 'Q')
('3.0', 'K')
('3.0', '4bsh')
('3.0', '\\text{softmax}(QK^T)')
('3.0', 'QK^T')
('3.0', '2bs^2a')
('3.0', 'a')
('3.0', 'bs^2a')
('3.0', '\\times')
('3.0', 'V')
('3.0', '2bs^2a')
('3.0', 'V')
('3.0', '2bsh')
('3.0', '2bsh')
('3.0', 'bsh')
('3.0', 'O(s^2)')
('3.0', '2bsh')
('3.0', '8bsh')
('3.0', '8bsh')
('3.0', 'bsh')
('3.0', '8bsh')
('3.0', 'O(s^2)')
('3.0', '4bch')
('3.0', 'q')
('3.0', '2bsh')
('3.0', 's \\gg c')
('3.0', '2bsh')
('3.0', '2bch')
('3.0', '8bch')
('3.0', '8bch')
('3.0', 'bch')
('3.0', '19bch')
('3.0', '2bsh')
('3.0', '2bsh')
('3.0', '2bsh')
('3.0', '2bsh')
('3.0', '8bsh')
('3.0', '8bsh')
('3.0', '8bsh/2bsh = 4')
('5.2', '1000 \\times 4')
('5.2', '1000')
('5.2', '4')
('9.0', '[16, 64, 128, 512, 1024, 2048, 4096]')
('9.1', '[16, 64, 128, 512, 1024, 2048, 4096]')
('9.1', '2.0\\times e^{-4}')
('9.1', '2048, 4096, 8192, 16384')
('9.1', '8, 4, 2, 1, 1')
('9.2', '64 \\times 1000 \\times 4')
