('2', '\\{{\\bm k}_j, \\mathbf{v}_j\\}_{j\\in [N]}')
('2', '\\mathbf{v}= f({\\bm k}) + \\varepsilon')
('2', '\\varepsilon')
('2', '\\mathbb{E}[\\varepsilon] = 0')
('2', 'f')
('2', '\\{{\\bm k}_j\\}_{j\\in[N]}')
('2', 'p({\\bm k})')
('2', 'p(\\mathbf{v}, {\\bm k})')
('2', '(\\mathbf{v}, {\\bm k})')
('2', 'f({\\bm q})')
('2', '{\\bm q}')
('2', 'f')
('2', '\\begin{aligned}\n    f({\\bm k}) = \\mathbb{E}[\\mathbf{v}|{\\bm k}] = \\int_{\\mathbb{R}^{D}} \\mathbf{v}\\cdot p(\\mathbf{v}|{\\bm k}) d\\mathbf{v}= \\int_{\\mathbb{R}^{D}} \\frac{\\mathbf{v}\\cdot p(\\mathbf{v}, {\\bm k})}{p({\\bm k})} d\\mathbf{v}, \\label{eq:conditional_expectation}\n\\end{aligned}')
('2', '\\mathbb{E}[\\varepsilon] = 0')
('2', 'f')
('2', 'p(\\mathbf{v}, {\\bm k})')
('2', 'p({\\bm k})')
('2', 'k_{\\sigma}')
('2', '\\sigma')
('2', '\\int_{\\mathbb{R}^D} k_{\\sigma}({\\bm x}-{\\bm x}^\\prime) d{\\bm x}= 1, \\forall {\\bm x}^\\prime')
('2', '\\hat{p}_{\\sigma}(\\mathbf{v}, {\\bm k}) = \\frac{1}{N} \\sum_{j\\in [N]} k_{\\sigma}\\left([\\mathbf{v}, {\\bm k}] - [\\mathbf{v}_j, {\\bm k}_j]\\right) \\quad\n    \\hat{p}_{\\sigma}({\\bm k}) = \\frac{1}{N} \\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j}),\n    \\label{eq:Gaussian_density_estimator_marginal}')
('2', '[\\mathbf{v}, {\\bm k}]')
('2', '\\mathbf{v}')
('2', '{\\bm k}')
('2', 'k_{\\sigma}')
('2', '\\hat{p}_{\\sigma}(\\mathbf{v}, {\\bm k}) = \\frac{1}{N} \\sum_{j\\in [N]} k_{\\sigma}(\\mathbf{v}- \\mathbf{v}_{j}) k_{\\sigma}({\\bm k}- {\\bm k}_{j}).')
('2', 'f')
('2', '% \\widehat{f}_{\\sigma}(\\bk) &= \\int_{\\mathbb{R}^{D}} \\frac{\\bv \\cdot \\hat{p}_{\\sigma}(\\bv, \\bk)}{\\hat{p}_{\\sigma}(\\bk)} d\\bv \\\\\n    % &= \\int_{\\mathbb{R}^{D}} \\frac{\\bv \\cdot \\sum_{j\\in [N]} k_{\\sigma}(\\bv - \\bv_{j}) k_{\\sigma}(\\bk - \\bk_{j})}{\\sum_{j\\in [N]} k_{\\sigma}(\\bk - \\bk_{j})} d\\bv \\nonumber \\\\\n    % & = \\frac{\\sum_{j\\in [N]} k_{\\sigma}(\\bk - \\bk_{j}) \\int \\bv \\cdot  k_{\\sigma}(\\bv - \\bv_{j}) d\\bv}{\\sum_{j\\in [N]} k_{\\sigma}(\\bk - \\bk_{j})} \\nonumber \\\\\n    %  & = \\frac{\\sum_{j\\in [N]} \\bv_{j} k_{\\sigma}(\\bk - \\bk_{j})}{\\sum_{j\\in [N]} k_{\\sigma}(\\bk - \\bk_{j})}. \\label{eq:Gaussian_nonparametric_regression}\n    \\widehat{f}_{\\sigma}({\\bm k}) = \\frac{\\sum_{j\\in [N]} \\mathbf{v}_{j} k_{\\sigma}({\\bm k}- {\\bm k}_{j})}{\\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j})}. \\label{eq:Gaussian_nonparametric_regression}')
('2', '\\{{\\bm k}_j\\}_{j\\in [N]}')
('2', '\\widehat{f}_{\\sigma}({\\bm q}_{i})')
('2', '% \\widehat{f}_{\\sigma}(\\bq_{i}) &= \\frac{\\sum_{j\\in [N]}\\bv_{j}\\exp\\left(\\bq\\bk_{j}^{\\top}/\\sigma^{2}\\right)}{\\sum_{j\\in [N]}\\exp\\left(\\bq\\bk_{j}^{\\top}/\\sigma^{2}\\right)} \\\\\n    % &= \\sum_{j\\in [N]}{\\rm softmax}\\left({\\bq}^\\top{\\bk}_j/\\sigma^{2}\\right){\\bv}_j. \\label{eqn:attn_reg_final}\n    \\widehat{f}_{\\sigma}({\\bm q}_{i}) = \\sum_{j\\in [N]}{\\rm softmax}\\left({{\\bm q}}^\\top{{\\bm k}}_j/\\sigma^{2}\\right){\\mathbf{v}}_j. \\label{eqn:attn_reg_final}')
('2', '\\{{\\bm k}_j\\}_{j\\in [N]}')
('2', '\\sigma^{2} = \\sqrt{D}')
('2', 'D')
('2', '{{\\bm q}}')
('2', '{\\bm k}_{j}')
('2', '\\widehat{f}_{\\sigma}({\\bm q}_{i}) = {\\bm h}_{i}')
('2.0', '\\mathcal{H}_k=\\{f~|~ f:\\mathcal{X}\\to \\mathbb{R}\\}')
('2.0', 'k')
('2.0', 'k:\\mathcal{X} \\times \\mathcal{X} \\to \\mathbb{R}')
('2.0', '\\langle\\cdot, \\cdot \\rangle_{\\mathcal{H}_k}')
('2.0', 'k({\\bm x}, \\cdot) \\in \\mathcal{H}_k, \\forall {\\bm x}\\in \\mathcal{X}')
('2.0', '\\forall f\\in\\mathcal{H}_k')
('2.0', 'f({\\bm x}) = \\langle f, k({\\bm x}, \\cdot)\\rangle_{\\mathcal{H}_k}')
('2.0', 'k_{\\sigma}({\\bm x}, {\\bm x}^\\prime) = k_{\\sigma}({\\bm x}- {\\bm x}^\\prime)')
('2.0', '\\hat{p}_{\\sigma} = \\frac{1}{N} \\sum_{j\\in[N]} k_{\\sigma}({\\bm x}_j, \\cdot) \\in \\mathcal{H}_{k_{\\sigma}}')
('2.0', '% \\centering\n    \\hat{p}_{\\sigma} = \\mathop{\\arg\\min}_{p\\in \\mathcal{H}_{k_{\\sigma}}} \\sum_{j\\in [N]} \\frac{1}{N}\\left\\|k_{\\sigma}({\\bm x}_j, \\cdot) - p\\right\\|_{\\mathcal{H}_{k_\\sigma}}^2. \\label{eq:rkhs_density_estimator}')
('2.0', '1/N')
('2.0', '\\left\\|k_{\\sigma}({\\bm x}_j, \\cdot) - p\\right\\|_{\\mathcal{H}_{k_\\sigma}}^2')
('2.0', '\\{k_{\\sigma}({\\bm x}_j, \\cdot)\\}_{j\\in [N]}')
('2.0', 'j')
('2.0', '\\|k_{\\sigma}({\\bm x}_j, \\cdot)\\|_{\\mathcal{H}_{k_{\\sigma}}}\\gg \\|k_{\\sigma}({\\bm x}_i, \\cdot)\\|_{\\mathcal{H}_{k_{\\sigma}}}')
('2.0', '\\forall i\\in [N], i\\neq j')
('3.0', '\\rho')
('3.0', '\\begin{aligned}\n    \\hat{p}_{\\text{robust}} = \\mathop{\\arg\\min}_{p \\in \\mathcal{H}_{k_{\\sigma}}} \\sum_{j\\in [N]} \\rho\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot ) - p\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right) = \\sum_{j\\in [N]} \\omega_{j} k_{\\sigma}({\\bm x}_j, \\cdot) .\\label{eq:robust_rkhs_density_estimator}\n\\end{aligned}')
('3.0', '\\rho')
('3.0', '\\omega = (\\omega_1, \\cdots, \\omega_N) \\in \\Delta_N')
('3.0', '\\omega_j \\propto \\psi\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot)-\\hat{p}_{\\text{robust}}\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)')
('3.0', '\\psi(x) := \\frac{\\rho^\\prime(x)}{x}')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0', '\\omega')
('3.0', '\\omega')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0', '\\omega^{(0)} \\in \\Delta_n')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0', '\\omega')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0', '{\\mathbf Q}= \\{{\\bm q}_i\\}_{i\\in[N]}, ~{\\mathbf K}= \\{{\\bm k}_j\\}_{j\\in[N]}, ~{\\mathbf V}= \\{\\mathbf{v}_l\\}_{l\\in[N]}')
('3.0', '~\\omega^{(0)}')
('3.0', '{\\mathbf K}= \\{{\\bm k}_j\\}_{j\\in[N]}')
('3.0', 'k_{\\sigma}({\\mathbf Q}, {\\mathbf K}) = \\{k_{\\sigma}({\\bm q}_i - {\\bm k}_j)\\}_{i,j\\in[N]}')
('3.0', 'k_{\\sigma}({\\mathbf Q}, {\\mathbf K})')
('3.0', 'B')
('3.0', 'I_1, \\dots, I_B')
('3.0', '\\mathcal{S}')
('3.0', 'I_l')
('3.0', '\\frac{1}{\\mathcal{S}} \\sum_{j \\in I_{l}} k_{\\sigma}({\\bm q}_i - {\\bm k}_{j}) = \\text{median}\\{\\frac{1}{\\mathcal{S}} \\sum_{j \\in I_{1}} k_{\\sigma}({\\bm q}_i - {\\bm k}_{j}), \\dots, \\frac{1}{\\mathcal{S}} \\sum_{j \\in I_{B}} k_{\\sigma}({\\bm q}_i - {\\bm k}_{j})\\}')
('3.0', '\\omega^{(0)}')
('3.0', '\\omega_{j}^{(1)} = \\frac{\\psi\\left(\\left\\|k_{\\sigma}({\\bm k}_j, \\cdot) - \\hat{p}_{\\text{robust}}^{(k)}({\\bm k})\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)}{\\sum_{j\\in [N]}\\psi\\left(\\left\\|k_{\\sigma}({\\bm k}_j, \\cdot) - \\hat{p}_{\\text{robust}}^{(k)}({\\bm k})\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)}.')
('3.0', '\\omega')
('3.0', '\\widehat{{\\bm h}}_{i} = \\frac{\\sum_{j\\in [N]} \\mathbf{v}_{j} \\omega_{j}^{\\text{joint}} k_{\\sigma}({\\bm q}_{i} - {\\bm k}_{j})}{\\sum_{j\\in [N]} \\omega_{j}^{\\text{marginal}} k_{\\sigma}({\\bm q}_{i} - {\\bm k}_{j})}')
('3.0', '\\widehat{{\\bm h}}_{i} = \\frac{\\sum_{j \\in I_{l}} v_{j} k_{\\sigma}({\\bm q}_i - {\\bm k}_{j})} {\\sum_{j \\in I_{l}} k_{\\sigma}({\\bm q}_i - {\\bm k}_{j})}.')
('3.0', 'L_2')
('3.0', '\\beta > 1')
('3.0', '\\mathcal{C}_{\\sigma}^N')
('3.0', 'k_{\\sigma}({\\bm{x}}_1, \\cdot), \\dots, k_{\\sigma}({\\bm{x}}_N, \\cdot) \\in \\mathcal{H}_{k_{\\sigma}}')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0', '\\hat{p}_{\\text{robust}} = \\arg\\underset{p\\in \\mathcal{C}_{\\sigma}^N}{\\min} \\left\\|\\frac{\\beta}{N}\\sum_{j\\in [N]} k_{\\sigma}(x_j, \\cdot) - p\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}^2,\n    \\label{eq:spkde}')
('3.0', '\\mathcal{C}_{\\sigma}^N')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0', '\\hat{p}_{\\text{robust}} = \\sum_{j\\in[N]}\\omega_{j}k_{\\sigma}(x_j, \\cdot), ~\\omega \\in \\Delta^N')
('3.0', '\\omega')
('3.0', '\\underset{\\omega}{\\min} ~\\omega^{\\top}G\\omega - 2q^{\\top}\\omega, \\quad \\text{subject~to~} \\omega \\in \\Delta^N,\n    \\label{eq:qp}')
('3.0', 'G')
('3.0', '\\{{\\bm{x}}_j\\}_{j\\in [N]}')
('3.0', 'k_{\\sigma}')
('3.0', 'q=G\\mathbf{1}\\frac{\\beta}{N}')
('3.0', 'k_{\\sigma}')
('3.0', '{\\bm{x}}_i')
('3.0', 'G')
('3.0', '\\hat{p}_{\\text{robust}}')
('3.0.0', '\\hat{p}_{\\text{robust}}(\\mathbf{v}, {\\bm k}) = \\sum_{j\\in [N]} \\omega_{j}^{\\text{joint}} k_{\\sigma}([\\mathbf{v}_j, {\\bm k}_j], [\\mathbf{v}, {\\bm k}]), \\quad \\hat{p}_{\\text{robust}}({\\bm k}) = \\sum_{j\\in [N]} \\omega_j^{\\text{marginal}} k_{\\sigma}({\\bm k}_j, {\\bm k}).')
('3.0.0', '\\begin{aligned}\n    \\widehat{{\\bm h}}_{i} = \\frac{\\sum_{j\\in [N]} \\mathbf{v}_{j} \\omega_{j}^{\\text{joint}} k_{\\sigma}({\\bm q}_{i} - {\\bm k}_{j})}{\\sum_{j\\in [N]} \\omega_{j}^{\\text{marginal}} k_{\\sigma}({\\bm q}_{i} - {\\bm k}_{j})},\n    \\label{eq:robust_rkhs}\n\\end{aligned}')
('3.0.0', '\\omega^{\\text{joint}}')
('3.0.0', '\\omega^{\\text{marginal}}')
('3.0.0', '\\{\\omega_{j}^{\\text{marginal}}\\}_{j\\in[N]}')
('3.0.0', '\\{\\omega_{j}^{\\text{joint}}\\}_{j\\in[N]}')
('3.0.0', '\\omega_j^{\\text{joint}}')
('3.0.0', '\\hat{p}_{\\text{robust}}(\\mathbf{v}, {\\bm k})')
('3.0.0', '\\hat{p}_{\\text{robust}}({\\bm k})')
('3.0.0', '\\omega^{\\text{marginal}}, \\omega^{\\text{joint}} \\in \\mathbb{R}^{j \\times i}')
('3.0.0', 'i, j = 1, \\dots, N')
('3.1', '\\{{\\bm k}_j\\}_{j = 1}^{N}')
('3.1', 'B')
('3.1', 'I_{1}, \\ldots, I_{B}')
('3.1', '|I_{1}| = |I_{2}| = \\ldots = |I_{B}| = \\mathcal{S}')
('3.1', 'p({\\bm k})')
('3.1', '\\begin{aligned}\n    \\hat{p}_{\\text{robust}}({\\bm k}) \\propto \\text{median}\\left\\{\\hat{p}_{\\sigma, I_{1}}({\\bm k}), \\ldots, \\hat{p}_{\\sigma, I_{B}}({\\bm k}) \\right\\}, \\label{eq:kde_median}\n\\end{aligned}')
('3.1', '\\hat{p}_{\\sigma, I_{l}}({\\bm k}) = \\frac{1}{\\mathcal{S}} \\sum_{j \\in I_{l}} k_{\\sigma}({\\bm k}- {\\bm k}_{j})')
('3.1', 'l\\in [B]')
('3.1', 'p(\\mathbf{v}, {\\bm k})')
('3.1', '\\begin{aligned}\n    \\hat{p}_{\\text{robust}}(\\mathbf{v}, {\\bm k}) \\propto \\text{median}\\left\\{\\hat{p}_{\\sigma, I_{1}}(\\mathbf{v}, {\\bm k}), \\ldots, \\hat{p}_{\\sigma, I_{B}}(\\mathbf{v}, {\\bm k}) \\right\\}, \\label{eq:joint_kde_median}\n\\end{aligned}')
('3.1', '\\hat{p}_{\\sigma, I_{l}}(\\mathbf{v}, {\\bm k}) = \\frac{1}{\\mathcal{S}} \\sum_{j \\in I_{l}} k_{\\sigma}(\\mathbf{v}- \\mathbf{v}_{j}) k_{\\sigma}({\\bm k}- {\\bm k}_{j})')
('3.1', 'l\\in [B]')
('3.1.0', '\\begin{aligned}\n    \\widehat{{\\bm h}}_{i} = \\frac{\\frac{1}{\\mathcal{S}} \\sum_{j \\in I_{l}} v_{j} k_{\\sigma}({\\bm q}_i - {\\bm k}_{j})} {\\text{median}\\left\\{\\hat{p}_{\\sigma, I_{1}}({\\bm q}_i - {\\bm k}), \\ldots, \\hat{p}_{\\sigma, I_{B}}({\\bm q}_i - {\\bm k}) \\right\\}}, \\label{eq:robust_Gaussian_nonparametric_regression}\n\\end{aligned}')
('3.1.0', 'I_{l}')
('3.1.0', '\\hat{p}_{\\sigma}({\\bm q}_i - {\\bm k})')
('3.1.0', 'I_{l}')
('3.1.0', 'I_{l_{1}} \\cap I_{l_{2}} = \\emptyset')
('3.1.0', '1 \\leq l_{1} \\neq l_{2} \\leq B')
('4.0', 'L')
('4.0', 'L')
('4.0', '1')
('4.0', '128')
('4.0', '256')
('4.0', '8')
('4.0', '4')
('4.0', '2048')
('4.0', '16')
('4.0', '80\\%')
('4.0', 'AAA')
('4.1', '5.7M')
('4.1', '7.2M')
('4.1', '\\epsilon = 1 / 255')
('4.1', 'l_{\\infty}')
('4.1', '20')
('4.1', '\\alpha=0.15')
('7', '{{\\bm{X}}}=[{\\bm{x}}_1,\\ldots,{\\bm{x}}_N]^\\top\\in {\\mathbb{R}}^{N\\times D_x}')
('7', 'N')
('7', '{\\mathbf H}:=[{\\bm h}_1,\\cdots,{\\bm h}_N]^\\top \\in {\\mathbb{R}}^{N\\times D_v}')
('7', '\\label{eq:attention-single-vector-app}%\\small\n{\\bm h}_i=\\sum_{j\\in [N]}{\\rm softmax}\\Big(\\frac{{\\bm{q}}_i^\\top{\\bm{k}}_j}{\\sqrt{D}} \\Big){\\bm{v}}_j,\\ \\mbox{for}\\ i=1,\\ldots,N.')
('7', '{\\bm{q}}_i')
('7', '{\\bm{k}}_j')
('7', '{\\bm{v}}_j')
('7', '\\label{eq:query-key-value-app}%\\small\n\\begin{aligned}\n[{\\bm{q}}_1,{\\bm{q}}_2,\\ldots,{\\bm{q}}_N]^\\top &:= {{\\bm{Q}}} = {{\\bm{X}}}{{\\bm{W}}}_Q^\\top \\in {\\mathbb{R}}^{N\\times D}, \\\\\n[{\\bm{k}}_1,{\\bm{k}}_2,\\ldots,{\\bm{k}}_N]^\\top &:={{\\bm{K}}} = {{\\bm{X}}}{{\\bm{W}}}_K^\\top \\in {\\mathbb{R}}^{N \\times D}, \\\\\n[{\\bm{v}}_1,{\\bm{v}}_2,\\ldots,{\\bm{v}}_N]^\\top &:= {{\\bm{V}}} = {{\\bm{X}}}{{\\bm{W}}}_V^\\top \\in {\\mathbb{R}}^{N\\times D_v}, \n\\end{aligned}')
('7', '{{\\bm{W}}}_Q, {{\\bm{W}}}_K\\in {\\mathbb{R}}^{D\\times D_x}')
('7', '{{\\bm{W}}}_V\\in {\\mathbb{R}}^{D_v\\times D_x}')
('7', '\\label{eq:attention-vector-form-app}%\\small\n{\\mathbf H}={\\rm softmax}\\Big(\\frac{{{\\bm{Q}}}{{\\bm{K}}}^\\top}{\\sqrt{D}} \\Big){{\\bm{V}}},')
('7', '{%\\small \n{({\\bm{Q}}{\\bm{K}}^\\top)}/{\\sqrt{D}}}')
('7', '\\{{\\bm k}_j, \\mathbf{v}_j\\}_{j\\in [N]}')
('7', '\\mathbf{v}= f({\\bm k}) + \\varepsilon, \\label{eq:nonparametric_regression_softmax_former_app}')
('7', '\\varepsilon')
('7', '\\mathbb{E}[\\varepsilon] = 0')
('7', 'f')
('7', '\\{{\\bm k}_j\\}_{j\\in[N]}')
('7', 'p({\\bm k})')
('7', 'p(\\mathbf{v}, {\\bm k})')
('7', '(\\mathbf{v}, {\\bm k})')
('7', '\\begin{aligned}\n    f({\\bm k}) = \\mathbb{E}[\\mathbf{v}|{\\bm k}] = \\int_{\\mathbb{R}^{D}} \\mathbf{v}\\cdot p(\\mathbf{v}|{\\bm k}) d\\mathbf{v}= \\int_{\\mathbb{R}^{D}} \\frac{\\mathbf{v}\\cdot p(\\mathbf{v}, {\\bm k})}{p({\\bm k})} d\\mathbf{v}, \\label{eq:conditional_expectation_app}\n    \n\\end{aligned}')
('7', 'p(\\mathbf{v}, {\\bm k})')
('7', 'p({\\bm k})')
('7', 'f')
('7', '\\begin{aligned}\n    \\hat{p}_{\\sigma}(\\mathbf{v}, {\\bm k}) &= \\frac{1}{N} \\sum_{j\\in [N]} k_{\\sigma}\\left([\\mathbf{v}, {\\bm k}] - [\\mathbf{v}_j, {\\bm k}_j]\\right) \\\\\n    \\hat{p}_{\\sigma}({\\bm k}) &= \\frac{1}{N} \\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j}),\n    \\label{eq:Gaussian_density_estimator_marginal_app}\n\\end{aligned}')
('7', '[\\mathbf{v}, {\\bm k}]')
('7', '\\mathbf{v}')
('7', '{\\bm k}')
('7', 'k_{\\sigma}')
('7', 'k_{\\sigma}({\\bm x}- {\\bm x}^\\prime) = \\exp\\left(-\\|{\\bm x}- {\\bm x}^\\prime\\|^2/(2\\sigma^2)\\right)')
('7', '\\begin{aligned}\n    \\hat{p}_{\\sigma}(\\mathbf{v}, {\\bm k}) = \\frac{1}{N} \\sum_{j\\in [N]} k_{\\sigma}(\\mathbf{v}- \\mathbf{v}_{j}) k_{\\sigma}({\\bm k}- {\\bm k}_{j}). \\label{eq:Gaussian_density_estimator_joint_app}\n\\end{aligned}')
('7', 'f')
('7', '\\begin{aligned}\n    \\widehat{f}_{\\sigma}({\\bm k}) &= \\int_{\\mathbb{R}^{D}} \\frac{\\mathbf{v}\\cdot \\hat{p}_{\\sigma}(\\mathbf{v}, {\\bm k})}{\\hat{p}_{\\sigma}({\\bm k})} d\\mathbf{v}\\\\\n    &= \\int_{\\mathbb{R}^{D}} \\frac{\\mathbf{v}\\cdot \\sum_{j\\in [N]} k_{\\sigma}(\\mathbf{v}- \\mathbf{v}_{j}) k_{\\sigma}({\\bm k}- {\\bm k}_{j})}{\\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j})} d\\mathbf{v}\\nonumber \\\\\n    & = \\frac{\\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j}) \\int \\mathbf{v}\\cdot  k_{\\sigma}(\\mathbf{v}- \\mathbf{v}_{j}) d\\mathbf{v}}{\\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j})} \\nonumber \\\\\n     & = \\frac{\\sum_{j\\in [N]} \\mathbf{v}_{j} k_{\\sigma}({\\bm k}- {\\bm k}_{j})}{\\sum_{j\\in [N]} k_{\\sigma}({\\bm k}- {\\bm k}_{j})}. \\label{eq:Gaussian_nonparametric_regression_app}\n    % \\widehat{f}_{\\sigma}(\\bk) = \\frac{\\sum_{j\\in [N]} \\bv_{j} k_{\\sigma}(\\bk - \\bk_{j})}{\\sum_{j\\in [N]} k_{\\sigma}(\\bk - \\bk_{j})}. \\label{eq:Gaussian_nonparametric_regression}\n\\end{aligned}')
('7', '\\{{\\bm k}_j\\}_{j\\in [N]}')
('7', '\\begin{aligned}\n    \\widehat{f}_{\\sigma}({\\bm q}) &= \\frac{\\sum_{j\\in [N]}\\mathbf{v}_{j}\\exp\\left(-\\|{\\bm q}- {\\bm k}_{j}\\|^{2}/2\\sigma^2\\right)}{ \\sum_{j\\in [N]}\\exp\\left(-\\|{\\bm q}- {\\bm k}_{j}\\|^{2}/2\\sigma^2\\right)} \\nonumber \\\\\n    &= \\frac{\\sum_{j\\in [N]}\\mathbf{v}_{j}\\exp\\left[-\\left(\\|{\\bm q}\\|^{2} + \\|{\\bm k}_{j}\\|^{2}\\right)/2\\sigma^{2}\\right]\\exp\\left({\\bm q}^\\top{\\bm k}_{j}/\\sigma^{2}\\right)}{\\sum_{j\\in [N]}\\exp\\left[-\\left(\\|{\\bm q}\\|^{2} + \\|{\\bm k}_{j}\\|^{2}\\right)/2\\sigma^{2}\\right]\\exp\\left({\\bm q}^\\top {\\bm k}_{j}/\\sigma^{2}\\right)} \\nonumber \\\\\n    &= \\sum_{j\\in [N]} \\frac{\\exp\\left({\\bm q}^\\top{\\bm k}_{j}/\\sigma^{2}\\right)}{\\sum_{j\\in [N] \\exp\\left({\\bm q}^\\top{\\bm k}_{j}/\\sigma^{2}\\right)}} \\mathbf{v}_{j} \\nonumber \\\\\n    &= \\sum_{j\\in [N]}{\\rm softmax}\\left({{\\bm q}}^\\top{{\\bm k}}_j/\\sigma^{2}\\right){\\mathbf{v}}_j. \\label{eqn:attn_reg_final_app}\n\\end{aligned}')
('7', '\\widehat{f}_{\\sigma}({\\bm q})')
('8', '\\begin{aligned}\n    \\rho(x) := \\left\\{ \\begin{array}{rcl} x^2 / 2, & 0 \\leq x \\leq a \\\\\n    ax - a^2 / 2, & a < x,\\end{array}\\right.\n    \\label{eq:huber}\n\\end{aligned}')
('8', 'a')
('8', '\\rho')
('8', '[0, \\infty]')
('8', '\\rho(0) = 0')
('8', '\\lim_{x\\to 0} \\frac{\\rho(x)}{x} = 0')
('8', '\\psi(x) : = \\frac{\\rho^\\prime(x)}{x}')
('8', '\\psi(0) = \\lim_{x\\to 0} \\frac{\\rho^\\prime(x)}{x}')
('8', '\\hat{p}_{\\text{robust}}')
('8', '\\begin{aligned}\n    \\hat{p}_{\\text{robust}} = \\sum_{j\\in [N]} \\omega_{j} k_{\\sigma}({\\bm x}_j, \\cdot),\n\\end{aligned}')
('8', '\\omega = (\\omega_1, \\cdots, \\omega_N) \\in \\Delta_N')
('8', '\\omega_j \\propto \\psi\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot)-\\hat{p}_{\\text{robust}}\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)')
('8', '\\Delta_n')
('8', 'n')
('8', 'p \\in \\mathcal{H}_{k_{\\sigma}}')
('8', '\\begin{aligned}\n    J(p) = \\frac{1}{N} \\sum_{j\\in [N]} \\rho\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot ) - p\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right).\n\\end{aligned}')
('8', 'J')
('8', '\\hat{p}_{\\text{robust}}')
('8', '\\rho')
('8', 'J')
('8', 'p \\in \\mathcal{H}_{k_{\\sigma}}')
('8', 'h \\in \\mathcal{H}_{k_{\\sigma}}')
('8', '\\delta J(p;h)')
('8', '\\begin{aligned}\n    \\delta J(p;h) : = \\lim_{\\tau \\to 0} \\frac{J(p + \\tau h) - J(p)}{\\tau} = - \\langle V(p), h \\rangle_{\\mathcal{H}_{k_{\\sigma}}},\n\\end{aligned}')
('8', 'V: \\mathcal{H}_{k_{\\sigma}} \\to \\mathcal{H}_{k_{\\sigma}}')
('8', 'V(p) = \\frac{1}{N} \\sum_{j\\in [N]} \\psi\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot ) - p\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)(k_{\\sigma}({\\bm x}_j, \\cdot ) - p).')
('8', '\\hat{p}_{\\text{robust}}')
('8', 'V(\\hat{p}_{\\text{robust}}) = 0')
('8', '\\hat{p}_{\\text{robust}}')
('8', 'V(\\hat{p}_{\\text{robust}}) = 0')
('8', '\\begin{aligned}\n    \\frac{1}{N} \\sum_{j\\in [N]} \\psi\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot ) - \\hat{p}_{\\text{robust}} \\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)(k_{\\sigma}({\\bm x}_j, \\cdot ) - \\hat{p}_{\\text{robust}}) = 0.\n\\end{aligned}')
('8', '\\hat{p}_{\\text{robust}} = \\sum_{j\\in [N]} \\omega_{j} k_{\\sigma}({\\bm x}_j, \\cdot)')
('8', '\\omega = (\\omega_1, \\cdots, \\omega_N) \\in \\Delta_N')
('8', '\\omega_j \\propto \\psi\\left(\\|k_{\\sigma}({\\bm x}_j, \\cdot)-\\hat{p}_{\\text{robust}}\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)')
('8', '\\begin{aligned}\n    \\psi(x) := \\left\\{ \\begin{array}{rcl} 1, & 0 \\leq x \\leq a \\\\\n    a/x, & a < x.\\end{array}\\right.\n\\end{aligned}')
('8', '\\|k_{\\sigma}({\\bm x}_j, \\cdot), \\cdot - \\hat{p}_{\\text{robust}}\\|_{\\mathcal{H}_{k_{\\sigma}}}')
('8', 'a')
('8', 'k_{\\sigma}({\\bm x}_j, \\cdot)')
('8', 'k_{\\sigma}({\\bm x}_j, \\cdot)')
('8', '\\hat{p}_{\\text{robust}}')
('8', '\\omega')
('8', '\\omega')
('8', '\\hat{p}_{\\text{robust}}')
('8', '\\omega')
('8', '\\omega^{(0)} \\in \\Delta_n')
('8', '\\hat{p}_{\\text{robust}}^{(k)} = \\sum_{j\\in [N]} \\omega_i^{(k-1)} k_{\\sigma}({\\bm x}_j, \\cdot), \\quad\n    \\omega_j^{(k)} =\\frac{\\psi\\left(\\left\\|k_{\\sigma}({\\bm x}_j, \\cdot) - \\hat{p}_{\\text{robust}}^{(k)}\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)}{\\sum_{j\\in [N]}\\psi\\left(\\left\\|k_{\\sigma}({\\bm x}_j, \\cdot) - \\hat{p}_{\\text{robust}}^{(k)}\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}\\right)}.\n    \\label{eq:kirwls}')
('8', '\\hat{p}_{\\text{robust}}')
('8', '\\left\\|k_{\\sigma}({\\bm x}_j, \\cdot) - \\hat{p}_{\\text{robust}}^{(k)}\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}')
('8', '\\begin{aligned}\n    % =& \\left\\langle k_{\\sigma}(\\bx_j, \\cdot), k_{\\sigma}(\\bx_j, \\cdot) \\right\\rangle_{\\mathcal{H}_{k_{\\sigma}}} - 2\\left\\langle k_{\\sigma}(\\bx_j, \\cdot), \\hat{p}_{\\text{robust}}^{(k)} \\right\\rangle_{\\mathcal{H}_{k_{\\sigma}}} + \\left\\langle \\hat{p}_{\\text{robust}}^{(k)}, ~ \\hat{p}_{\\text{robust}}^{(k)} \\right\\rangle_{\\mathcal{H}_{k_{\\sigma}}} \\\\\n    \\left\\|k_{\\sigma}({\\bm x}_j, \\cdot) - \\hat{p}_{\\text{robust}}^{(k)}\\right\\|_{\\mathcal{H}_{k_{\\sigma}}}^2 \n    &= -2\\sum_{m\\in [N]}\\omega_m^{(k-1)} k_{\\sigma}({\\bm x}_m, {\\bm x}_j) +k_{\\sigma}({\\bm x}_j, {\\bm x}_j) \\nonumber \\\\ \n    &+ \\sum_{m\\in [N], n\\in [N]} \\omega_m^{(k-1)} \\omega_n^{(k-1)} k_{\\sigma}({\\bm x}_m, {\\bm x}_n).\n\\end{aligned}')
('9', '\\phi: \\mathbb{R}\\rightarrow \\mathbb{R}')
('9', 'R')
('9', '\\{{\\bm k}_i \\}_{i \\in [N]}')
('9', 'B')
('9', 'I_1, \\dots, I_B')
('9', '|I_1| = |I_2| = \\dots = |I_B| = \\mathcal{S}')
('9', '\\hat{p}_{R, I_m}({\\bm q}_l) = \\frac{1}{\\mathcal{S}} \\sum_{i \\in I_m} \\prod_{j=1}^D \\phi(\\frac{\\sin (R(q_{lj} - k_{ij}))}{R(q_{lj} - k_{ij})})')
('9', '\\hat{\\mathbf{h}}_l = \\frac{\\frac{1}{\\mathcal{S}}\\sum_{i\\in I_m} \\mathbf{v}_i \\prod_{j=1}^D \\phi(\\frac{\\sin (R(q_{lj} - k_{ij}))}{R(q_{ij} - k_{lj})})}{\\mathrm{median}\\{\\hat{p}_{R, I_1}({\\bm q}_l), \\dots, \\hat{p}_{R, I_B}({\\bm q}_l)\\}},\n    \\label{eq:fourier_mom}')
('9', 'I_m')
('9', '\\hat{p}_{R}({\\bm q}_l, {\\bm k})')
('9', '\\hat{p}_{R}({\\bm q}) = \\mathrm{median}\\{\\hat{p}_{R, I_1}({\\bm q}), \\dots, \\hat{p}_{R, I_B}({\\bm q})\\}')
('9', 'p({\\bm q})')
('9', '\\mathcal{C} = \\{1 \\leq i \\leq N: \\ k_{i} \\ \\text{is clean}\\}')
('9', '\\mathcal{O} = \\{1 \\leq i \\leq N: \\ k_{i} \\ \\text{is outlier}\\}')
('9', '\\mathcal{C} \\cap \\mathcal{O} = \\emptyset')
('9', '\\mathcal{C} \\cup \\mathcal{O} = \\{1, 2, \\ldots, N\\}')
('9', '\\widehat{p}_{R}({\\bm q})')
('9', 'p({\\bm q})')
('9', '\\phi')
('9', '\\int \\phi(\\sin(z)/z) z^{j} dz = 0')
('9', '1 \\leq j \\leq m')
('9', '\\int |\\phi(\\sin(z)/z)| |z|^{m + 1} dz < \\infty')
('9', 'm \\in \\mathbb{N}')
('9', 'p({\\bm q})')
('9', '\\sup_{{\\bm q}} |p({\\bm q})| < \\infty')
('9', 'B')
('9', '|\\mathcal{O}|')
('9', 'B > (2 + \\delta) |\\mathcal{O}|')
('9', '\\delta')
('9', '\\Delta = \\frac{1}{2 + \\delta} - \\frac{|\\mathcal{O}|}{B}')
('9', 'R')
('9', '\\delta')
('9', '1 - \\exp(-2 \\Delta^2 B)')
('9', '\\begin{aligned}\n    \\|\\hat{p}_{R} - p\\|_{\\infty} \\leq C(\\frac{1}{R^{m+1}} + \\sqrt{\\frac{B R^{D} \\log R \\log (2/\\delta)}{N}})\n\\end{aligned}')
('9', 'C')
('9', 'R = \\mathcal{O}(N^{-\\frac{1}{2(m+1) + D}})')
('9', '\\hat{p}_{R}')
('9', 'p')
('9', '\\mathcal{O}(N^{-\\frac{m + 1}{2(m+1) + D}})')
('9', 'R')
('9', 'N')
('9', '\\hat{p}_{R}')
('9', 'p')
('9', '\\hat{p}_{R}')
('9', 'p')
('9', '\\widehat{p}_{R}({\\bm q})')
('9', '\\begin{aligned}\n    \\{\\sup_{{\\bm q}} |\\hat{p}_{R}({\\bm q}) - p({\\bm q})| \\geq \\epsilon \\} \\subset \\{\\sup_{{\\bm q}} \\sum_{b = 1}^{B} \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\geq \\frac{B}{2} \\}\n\\end{aligned}')
('9', '\\mathbb{P}(\\|\\hat{p}_{R}({\\bm q}) - p({\\bm q})\\|_{\\infty} \\geq \\epsilon)')
('9', '\\mathbb{P}(\\{\\sup_{{\\bm q}} \\sum_{b = 1}^{B} \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\geq \\frac{B}{2} \\})')
('9', '1 \\leq b \\leq B')
('9', '\\begin{aligned}\n    \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\leq \\bold{1}_{\\{\\sup_{{\\bm q}} \\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}}.\n\\end{aligned}')
('9', '\\begin{aligned}\n    \\sum_{b = 1}^{B} \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\leq \\sum_{b = 1}^{B} \\bold{1}_{\\{\\sup_{{\\bm q}} \\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}}, \n\\end{aligned}')
('9', '\\sup_{{\\bm q}} \\sum_{b = 1}^{B} \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\leq \\sum_{b = 1}^{B} \\bold{1}_{\\{\\sup_{{\\bm q}} \\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}}')
('9', '\\begin{aligned}\n    \\mathbb{P}(\\{\\sup_{{\\bm q}} \\sum_{b = 1}^{B} \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\geq \\frac{B}{2} \\}) \\leq \\mathbb{P}(\\sum_{b = 1}^{B} \\bold{1}_{\\{\\sup_{{\\bm q}} \\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}}). \n\\end{aligned}')
('9', 'W_{b} = \\bold{1}_{\\{\\sup_{{\\bm q}} \\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}}')
('9', '\\mathcal{B} = \\{1 \\leq b \\leq B: \\ I_{b} \\cap \\mathcal{O} = \\emptyset\\}')
('9', '\\begin{aligned}\n    \\sum_{b = 1}^{B} \\bold{1}_{\\{\\sup_{{\\bm q}} \\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} & = \\sum_{b \\in \\mathcal{B}} W_{b} + \n    \\sum_{b \\in \\mathcal{B}^{c}} W_{b} \\\\\n    & \\leq \\sum_{b \\in \\mathcal{B}} W_{b} + |\\mathcal{O}| \\\\\n    & \\leq \\sum_{b \\in \\mathcal{B}} (W_{b} - \\mathbb{E}[W_{b}]) + B \\cdot \\mathbb{P}(\\sup_{{\\bm q}} |\\hat{p}_{R, I_{1}}({\\bm q}) - p({\\bm q})| > \\epsilon) + |\\mathcal{O}|, \n\\end{aligned}')
('9', '1 \\in \\mathcal{B}')
('9', 'B > (2 + \\delta) |\\mathcal{O}|')
('9', '\\phi(z) \\leq C')
('9', '|z| \\leq 1')
('9', 'C')
('9', '\\begin{aligned}\n    \\mathbb{P}(\\sup_{{\\bm q}} |\\hat{p}_{R, I_{1}}({\\bm q}) - p({\\bm q})| \\geq C(\\frac{1}{R^{m+1}} + \\sqrt{\\frac{R^{D} \\log R \\log (2/\\delta)}{|I_{1}|}})) \\leq \\delta. \n\\end{aligned}')
('9', '\\begin{aligned}\n    \\sup_{{\\bm q}} |\\hat{p}_{R, I_{1}}({\\bm q}) - p({\\bm q})| \\leq \\sup_{{\\bm q}} |\\hat{p}_{R, I_{1}}({\\bm q}) - \\mathbb{E}[\\hat{p}_{R, I_{1}}({\\bm q})]| + \\sup_{{\\bm q}} |\\mathbb{E}[\\hat{p}_{R, I_{1}}({\\bm q})] - p({\\bm q})|.\n\\end{aligned}')
('9', '\\sup_{{\\bm q}} |\\hat{p}_{R, I_{1}}({\\bm q}) - \\mathbb{E}[\\hat{p}_{R, I_{1}}({\\bm q})]|')
('9', '\\mathbb{L}_{1}')
('9', '{\\bm q}')
('9', 'Y_{i} = \\frac{R^{D}}{A^{D}} \\prod_{j=1}^D \\phi(\\frac{\\sin (R(q_{j} - k_{ij}))}{R(q_{j} - k_{ij})})')
('9', 'A = \\int_{\\mathbb{R}} \\phi(\\frac{\\sin(z)}{z})dz')
('9', 'i \\in I_{1}')
('9', '\\sin(R(q_{j} - k_{ij}))/(R(q_{j} - k_{ij})) \\leq 1')
('9', '1 \\leq j \\leq D')
('9', '|Y_{i}| \\leq C^{D} R^{D}/ A^{D}')
('9', 'C')
('9', '\\phi(z) \\leq C')
('9', '|z| \\leq 1')
('9', 'E[|Y_{i}|]')
('9', '\\epsilon = C(\\frac{1}{R^{m+1}} + \\sqrt{\\frac{R^{D} \\log R \\log (2/\\delta)}{|I_{1}|}}))')
('9', '\\begin{aligned}\n    \\mathbb{P}(\\sup_{{\\bm q}} |\\hat{p}_{R, I_{1}}({\\bm q}) - p({\\bm q})| > \\epsilon) \\leq \\frac{\\delta}{2(2 + \\delta)}\n\\end{aligned}')
('9', '\\begin{aligned}\n    \\mathbb{P}(\\{\\sup_{{\\bm q}} \\sum_{b = 1}^{B} \\bold{1}_{\\{|\\hat{p}_{R, I_{b}}({\\bm q}) - p({\\bm q})| \\geq \\epsilon\\}} \\geq \\frac{B}{2} \\}) \\leq \\exp(- 2B\\Delta^2),\n\\end{aligned}')
('9', '\\Delta = \\frac{1}{2 + \\delta} - \\frac{|\\mathcal{O}|}{B}')
('10.0', '268K')
('10.0', '28K')
('10.0', '103M')
('10.0', '218K')
('10.0', '246K')
('10.0.0', '1.28M')
('10.0.0', '50K')
