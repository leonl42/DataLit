('3.0', '{\\mathcal{M}}')
('3.0', '({\\mathcal{S}}, {\\mathcal{A}}, {\\mathcal{P}}, r, c, \\mu_0)')
('3.0', '{\\mathcal{S}}')
('3.0', '{\\mathcal{A}}')
('3.0', '{\\mathcal{P}}:{\\mathcal{S}}\\times {\\mathcal{A}}\\times {\\mathcal{S}}\\xrightarrow{} [0, 1]')
('3.0', 'r:{\\mathcal{S}}\\times {\\mathcal{A}}\\times {\\mathcal{S}}\\xrightarrow{} \\mathbb{R}')
('3.0', '\\mu_0: {\\mathcal{S}}\\xrightarrow[]{} [0,1]')
('3.0', 'c:{\\mathcal{S}}\\times {\\mathcal{A}}\\times {\\mathcal{S}}\\xrightarrow{} \\mathbb{R}^{+}')
('3.0', '\\epsilon \\xrightarrow[]{} [0, +\\infty)')
('3.0', '\\pi:{\\mathcal{S}}\\times {\\mathcal{A}}\\rightarrow [0,1]')
('3.0', '\\tau = \\{s_1, a_1, ...\\}')
('3.0', '{\\mathbf{f}}_t={\\mathbf{f}}(s_t, a_t, s_{t+1}), {\\mathbf{f}}\\in\\{r, c\\}')
('3.0', 'V_{\\mathbf{f}}^\\pi(\\mu_0) = \\mathbb{E}_{\\tau \\sim \\pi, s_0 \\sim \\mu_0}[ \\sum_{t=0}^\\infty \\gamma^t {\\mathbf{f}}_t ], {\\mathbf{f}}\\in \\{r, c\\}')
('3.0', '\\pi')
('3.0', '\\mu_0')
('3.0', '\\epsilon')
('3.0', '% \\vspace{-2mm}\n   \\pi^* = \\arg\\max_{\\pi}  V_r^\\pi(\\mu_0), \\quad s.t. \\quad V_c^\\pi(\\mu_0)\\leq \\epsilon.')
('3.1', '\\epsilon \\in \\mathcal{E}')
('3.1', '\\pi(\\cdot|\\epsilon): {\\mathcal{S}}\\times {\\mathcal{A}}\\times \\mathcal{E} \\rightarrow [0, 1]')
('3.1', '\\pi^*(\\cdot|\\epsilon)')
('3.1', '\\epsilon \\in \\mathcal{E}')
('3.1', '% \\vspace{-2mm}\n   \\pi^*(\\cdot | \\epsilon) = \\arg\\max_{\\pi}  V_r^\\pi(\\mu_0), \\quad s.t. \\quad V_c^\\pi(\\mu_0)\\leq \\epsilon, \\quad \\forall \\epsilon \\in\\mathcal{E}.')
('3.1', 'a \\sim \\pi(s|\\epsilon)')
('3.1', 'D = \\bigcup_{i = 1}^{N} D_i')
('3.1', 'D_i \\sim \\pi(\\cdot | \\tilde{\\epsilon}_i), \\forall \\epsilon_i \\in \\tilde{{\\mathcal{E}}}, \\text{with } \\tilde{{\\mathcal{E}}} \\subset {{\\mathcal{E}}}, |\\tilde{{\\mathcal{E}}}| = N')
('3.1', 'N')
('4.0', 'Q_{\\mathbf{f}}^*')
('4.0', '\\pi^*')
('4.0', '\\label{equ: critics decomposition}\n    Q_{\\mathbf{f}}^*(s, a|\\epsilon) = \\boldsymbol{\\psi}_{\\mathbf{f}}(s, a)^\\top \\boldsymbol{z}_{\\mathbf{f}}^*(\\epsilon), \\quad {\\mathbf{f}}\\in \\{r, c\\},')
('4.0', '||\\boldsymbol{\\psi}_{\\mathbf{f}}(s, a)||_\\infty \\leq K_{\\mathbf{f}}')
('4.0', '(s, a)')
('4.0', 'K_{\\mathbf{f}}')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}^*')
('4.0', '\\epsilon')
('4.0', '\\boldsymbol{\\psi}_{\\mathbf{f}}(s, a)')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}^*(\\epsilon)')
('4.0', 'M')
('4.0', '\\psi_{{\\mathbf{f}}}(s, a)')
('4.0', '\\boldsymbol{z}_{{\\mathbf{f}}}(\\epsilon)')
('4.0', '\\boldsymbol{\\psi}_{\\mathbf{f}}(s, a)')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}(\\epsilon)')
('4.0', '||\\boldsymbol{\\psi}_{\\mathbf{f}}(s, a)||_\\infty \\leq K_{\\mathbf{f}}')
('4.0', '\\epsilon')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}^*(\\epsilon)')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}^*')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}^*(\\epsilon) = \\text{Poly}(\\epsilon, p) + \\boldsymbol{e}')
('4.0', '\\boldsymbol{z}_{\\mathbf{f}}^*')
('4.0', 'p')
('4.0', '\\epsilon')
('4.0', '\\boldsymbol{e}')
('4.0', '\\boldsymbol{e}')
('4.0', 'e_j \\sim {\\mathcal{N}}(0, \\sigma_j^2), j=i,...,M')
('4.0', '\\sigma = \\max_j \\sigma_j')
('4.0', 'p')
('4.0', '\\boldsymbol{z}(\\epsilon)')
('4.0', '\\epsilon_L')
('4.0', '\\epsilon_H')
('4.0', '{\\mathcal{E}}')
('4.0', '\\{\\tilde{\\epsilon}_i\\}_{i=1, 2, ..., N}')
('4.0', '[\\epsilon_L, \\epsilon_H]')
('4.0', '1-\\alpha')
('4.0', '\\epsilon \\in [\\epsilon_L, \\epsilon_H]')
('4.0', '||\\hat{Q}_{\\mathbf{f}}(s, a|\\epsilon) - Q_{\\mathbf{f}}^*(s, a|\\epsilon)|| \\leq \n \\frac{z_{\\alpha/2} B(p)}{N^{\\beta(p)}}  \\sqrt{ \\sigma^2 K_{\\mathbf{f}}^2 M },')
('4.0', 'B(p)')
('4.0', '\\beta(p)')
('4.0', 'p')
('4.0', 'z_{\\alpha / 2}')
('4.0', 'B(p), \\beta(p)')
('4.0', '\\epsilon \\in [\\epsilon_L, \\epsilon_H]')
('4.0', '\\epsilon = (\\epsilon - \\epsilon_L) / \\epsilon_H')
('4.0', '\\boldsymbol{\\psi}(s,a)')
('4.0', '\\boldsymbol{z}(\\epsilon)')
('4.0', '\\epsilon')
('4.1', '\\epsilon_i')
('4.1', 'O = O(s, a)')
('4.1', '(s, a)')
('4.1', 'a')
('4.1', 's')
('4.1', '\\tau')
('4.1', 'p(O=1 | \\tau) \\propto \\exp(\\sum_t \\gamma^t r_t/\\alpha)')
('4.1', '\\alpha')
('4.1', '\\tau')
('4.1', '\\pi(\\cdot | \\epsilon_i)')
('4.1', 'p_{\\pi(\\cdot | \\epsilon_i)}(\\tau)=p(s_0)\\prod_{t\\geq 0}p(s_{t+1} | s_t, a_t)\\pi(a_t | s_t, \\epsilon_i)')
('4.1', '\\pi(\\cdot | \\epsilon_i)')
('4.1', '% \\vspace{-10pt}\n\\begin{aligned}\n \\log p_{\\pi(\\cdot | \\epsilon_i)}  (O=1) \n     & = \\log \\mathbb{E}_{\\tau \\sim q(\\cdot | \\epsilon_i)} \\frac{p(O=1 | \\tau)p_\\pi(\\tau | \\epsilon_i)}{q(\\tau | \\epsilon_i) } \\\\\n     & \\geq \\mathbb{E}_{\\tau \\sim q(\\cdot | \\epsilon_i)} \\log \\frac{p(O=1 | \\tau)p_{\\pi(\\cdot | \\epsilon_i)}(\\tau)}{q(\\tau | \\epsilon_i) } \\\\ \n    & \\propto \\mathbb{E}_{\\tau \\sim q(\\cdot | \\epsilon_i)} [\\sum_{t=0}^\\infty \\gamma^t r_t] - \\alpha D_{\\mathrm{KL}}(q(\\tau | \\epsilon_i)  \\Vert p_{\\pi(\\cdot | \\epsilon_i)}(\\tau)) := {\\mathcal{J}}(q,\\pi | \\epsilon_i), \\label{eq:elbo}\n\\end{aligned}\n% \\vspace{5pt}')
('4.1', 'q(\\tau | \\epsilon_i)')
('4.1', '\\epsilon_i')
('4.1', '{\\mathcal{J}}(q,\\pi | \\epsilon_i)')
('4.1', '\\epsilon_i')
('4.1', 'q(\\tau | \\epsilon_i) = p(s_0)\\prod_{t\\geq0}p(s_{t+1}|s_t, a_t) q(a_t|s_t, \\epsilon_i)')
('4.1', 'q(a|s, \\epsilon_i)')
('4.1', '% \\vspace{-2mm}\n% \\vspace{-15pt}\n\\begin{split}\n    {\\mathcal{J}}(q,\\theta | \\epsilon_i) =&\n    \\mathbb{E}_{\\rho_q(\\cdot |\\epsilon_i)} \\Big[ \\sum_{t=0}^\\infty \\gamma^t r_t - \\alpha D_{\\mathrm{KL}}(q(\\cdot | \\epsilon_i) \\Vert \\pi_\\theta(\\cdot | \\epsilon_i))\\Big] + \\log p(\\theta)\n\\end{split}\n% \\vspace{-5pt}\n\\label{eq:elbo_new}')
('4.1', '\\rho_q(s | \\epsilon_i)')
('4.1', 'q(\\cdot|s, \\epsilon_i)')
('4.1', '\\rho_0')
('4.1', '\\theta')
('4.1', '\\pi')
('4.1', 'p(\\theta)')
('4.1', 'q')
('4.1', 'q(a|s, \\epsilon_i)')
('4.1', 'q(\\tau | \\epsilon_i)')
('4.1', '{\\mathcal{J}}(q,\\pi | \\epsilon_i)')
('4.1', 'q(\\tau | \\epsilon_i)')
('4.1', 'p_{\\pi(\\cdot | \\epsilon_i)}(\\tau)')
('4.1', 'q(\\cdot | s, \\epsilon_i)')
('4.1', '\\label{equ: feasible distribution}\n    \\Pi_{{\\mathcal{Q}}}^{\\epsilon_i}\\coloneqq \\{q(a|s, \\epsilon_i): \\mathbb{E}_{\\tau \\sim q(\\cdot | \\epsilon_i)}[\\sum_{t=0}^\\infty \\gamma^t c_t] \\leq \\epsilon_i, a \\in {\\mathcal{A}}, s \\in {\\mathcal{S}}\\},')
('4.1', '\\epsilon_i')
('4.1', 'q(\\tau | \\epsilon_i)')
('4.1', '\\Pi_{{\\mathcal{Q}}}^{\\epsilon_i}')
('4.1', 'p_{\\pi(\\cdot | \\epsilon_i)}(\\tau)')
('4.1', 'q(\\tau | \\epsilon_i)')
('4.1', '{\\mathcal{J}}(q,\\theta | \\epsilon_i)')
('4.1', 'q(\\cdot | \\epsilon_i)')
('4.1', '\\theta')
('4.1', '\\epsilon_i')
('4.1', 'q(\\cdot | \\epsilon_i) \\in \\Pi_{{\\mathcal{Q}}}^{\\epsilon_i}')
('4.1', '\\epsilon_i')
('4.1', 'j')
('4.1', 'th')
('4.1', 'q')
('4.1', '\\label{eq:estep_objective}\n\\begin{aligned}\n \\max _{q\\left(a | s, \\epsilon_i\\right)}  & \\mathbb{E}_{\\rho_q}\\left[\\int q\\left(a | s, \\epsilon_i\\right) \\hat{Q}_r^{\\pi_{\\theta_j}}\\left(s, a | \\epsilon_i\\right) d a\\right] \\\\\n \\text { s.t. } & \\mathbb{E}_{\\rho_q}\\left[\\int q\\left(a | s, \\epsilon_i\\right) \\hat{Q}_c^{\\pi_{\\theta_j}}\\left(s, a | \\epsilon_i\\right) d a\\right] \\leq \\epsilon_i, \\\\\n& \\mathbb{E}_{\\rho_q}\\left[D_{\\mathrm{KL}}\\left(q\\left(a | s, \\epsilon_i\\right) \\| \\pi_{\\theta_j}\\left(\\cdot | \\epsilon_i\\right)\\right)\\right] \\leq \\kappa;\n\\end{aligned}')
('4.1', '\\hat{Q}_{\\mathbf{f}}(\\cdot | \\epsilon_i)')
('4.1', '\\kappa')
('4.1', 'q^*_i = q^*_i(a|s, \\epsilon_i)')
('4.1', '\\epsilon_i')
('4.1', '\\begin{aligned}\n    q^*_i = \\frac{\\pi_{\\theta_j}(\\cdot | \\epsilon_i)}{Z(s, \\epsilon_i)} \\exp\\left(\\frac{\\hat{Q}_r^{\\pi_{\\theta_j}}(\\cdot | \\epsilon_i) - \\lambda_i^* \\hat{Q}_c^{\\pi_{\\theta_j}}(\\cdot | \\epsilon_i)}{\\eta_i^*}\\right),\n    \\label{eq:optimalq_theorem}\n\\end{aligned}')
('4.1', 'Z(s, \\epsilon_i)')
('4.1', 'q_i^*')
('4.1', '\\eta_i^*')
('4.1', '\\lambda_i^*')
('4.1', '% \\small\n \\begin{aligned}\n      \\min_{\\lambda_i, \\eta_i \\geq 0} \\ g(\\eta_i, \\lambda_i) = \\lambda_i \\epsilon_i + \\eta_i \\kappa \\mathbb{E}_{\\rho_q} \\left[ \\log \\mathbb{E}_{\\pi(\\cdot |{\\epsilon_i})} \\Big[ \\exp\\left(\\frac{\\hat{Q}_r( \\cdot | \\epsilon_i)- \\lambda_i \\hat{Q}_c( \\cdot | \\epsilon_i)}{\\eta_i}\\right) \\Big] \\right].\n\\end{aligned}\n\\label{eq:dual_opt}')
('4.1', 'q^*_i(a|s, \\epsilon_i)')
('4.1', '\\epsilon_i')
('4.1', 'q^*_i(a|s, \\epsilon_i)')
('4.1', '\\epsilon_i')
('4.1', 'a')
('4.1', 's')
('4.1', 'q^*_i=q^*_i(\\cdot|s, \\epsilon_i)')
('4.1', '\\epsilon_i')
('4.1', '\\theta')
('4.1', '\\epsilon_i \\in {\\mathcal{E}}')
('4.1', '\\begin{split}\n    {{\\mathcal{J}}}(\\theta|\\epsilon_i) = \\mathbb{E}_{\\rho_q}\\Big[\\alpha \\mathbb{E}_{q^*_i} \\big[ \\log \\pi_\\theta (a|s, \\epsilon_i)\\big]\\Big] + \\log (p|\\epsilon_i)\n\\end{split}\n\\label{eq:mstep}')
('4.1', '\\begin{split}\n    \\max_\\theta \\ \\mathbb{E}_{\\rho_q}\\Big[\\sum_{i=1}^{|{\\mathcal{E}}|} \\mathbb{E}_{q^*_i} \\big[ \\log \\pi_\\theta (a|s,\\epsilon_i)\\big] / |{\\mathcal{E}}| \\Big] \\  s.t. \\ \\mathbb{E}_{\\rho_q}\\big[ D_{\\mathrm{KL}}(\\pi_{\\theta_j}(a|s, \\epsilon_i)\\Vert \\pi_{\\theta}(a|s, \\epsilon_i)) \\big] \\leq \\gamma \\ \\forall i,\n\\end{split}\n\\label{eq:m_step_kl}')
('4.1', '\\mathcal{E}')
('4.1', '\\{\\epsilon_i\\}')
('4.2', '\\tilde{\\epsilon}_i \\in \\tilde{{\\mathcal{E}}}')
('4.2', '[\\epsilon_L, \\epsilon_H]')
('4.2', '1-\\alpha')
('4.2', '\\epsilon \\in [\\epsilon_L, \\epsilon_H]')
('4.2', '\\label{equ: bounded safety violation}\n  V_c^{\\pi(\\mu_0|\\epsilon)} - \\epsilon \\leq  \\frac{z_{\\alpha/2} B(p)}{N^{\\beta(p)}}  \\sqrt{ \\sigma^2 K_c^2 M },\n  % \\vspace{-5p}')
('4.2', '[\\epsilon_L, \\epsilon_H]')
('4.2', '\\sqrt{K_c^2 M}')
('4.2', 'K_c')
('4.2', 'M')
('4.2', '\\epsilon')
('4.2', 'N')
('4.2', '\\epsilon')
('4.2', 'N')
('4.2', '\\frac{1}{N^{\\beta(p)}}')
('4.2', 'N')
('4.2', 'p')
('4.2', 'z(\\epsilon)')
('4.2', 'p')
('4.2', '\\beta')
('4.2', '\\beta(p), B(p)')
('5', '\\epsilon')
('5', '\\bar{s} = [s; \\epsilon]')
('5', '\\epsilon')
('5', '\\epsilon_1, \\epsilon_2')
('5', '\\epsilon')
('5', '\\epsilon')
('5', '\\pi(\\cdot | \\epsilon_1), \\pi(\\cdot | \\epsilon_2)')
('5', '\\pi(\\cdot | \\epsilon) = w_1  \\pi(\\cdot | \\epsilon_1) + w_2 \\pi(\\cdot | \\epsilon_2); \\quad w_1 = (\\epsilon_2-\\epsilon)/(\\epsilon_2 - \\epsilon_1), \\ w_2 = (\\epsilon-\\epsilon_1)/(\\epsilon_2 - \\epsilon_1)')
('5', 'w_1')
('5', 'w_2')
('5', '\\tilde{{\\mathcal{E}}} = \\{20, 40, 60\\}')
('5', '\\{10, 15, ..., 70\\}')
('5', '\\epsilon')
('5', '\\text{CV} = \\max \\{0, \\Sigma_{\\tau} c_t - \\epsilon \\}')
('5.0', '5')
('5.0', '50')
('5.0', '\\tilde{{\\mathcal{E}}} = \\{20, 40, 60\\}')
('5.0', '{\\mathcal{E}}= \\{10, 15, ..., 70\\}')
('5.1', '\\epsilon')
('5.1', '\\epsilon')
('5.1', '\\tilde{{\\mathcal{E}}} = \\{20, 40, 60\\}')
('5.1', '\\tilde{{\\mathcal{E}}}^{\\prime} = \\{20, 30, 40, 50, 60, 70\\}')
('5.1', '|\\tilde{{\\mathcal{E}}}^{\\prime}| = 2 |\\tilde{{\\mathcal{E}}}|')
('5.1', '{\\mathcal{E}}= \\{10, 15, ..., 70\\}')
('5.1', '\\epsilon')
('5.1', '\\epsilon')
('5.1', '\\epsilon')
