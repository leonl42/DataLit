('1.0', '{\\mathbf X}:=[{\\bm x}(1),\\cdots,{\\bm x}(N)]^\\top\\in {\\mathbb{R}}^{N\\times D_x}')
('1.0', 'N')
('1.0', '{\\mathbf X}')
('1.0', '{\\mathbf H}')
('1.0', '{\\mathbf X}')
('1.0', '{\\mathbf Q}')
('1.0', '{\\mathbf K}')
('1.0', '{\\mathbf V}')
('1.0', '\\begin{aligned}\n{\\mathbf Q}={\\mathbf X}{\\mathbf W}_Q^\\top; {\\mathbf K}={\\mathbf X}{\\mathbf W}_K^\\top; {\\mathbf V}={\\mathbf X}{\\mathbf W}_V^\\top, \\label{eqn:qkv}\n\\end{aligned}')
('1.0', '{\\mathbf W}_Q,{\\mathbf W}_K\\in {\\mathbb{R}}^{D_{qk}\\times D_x}')
('1.0', '{\\mathbf W}_V\\in {\\mathbb{R}}^{D\\times D_x}')
('1.0', '{\\bm{Q}}:=[{\\bm q}(1),\\dots,{\\bm q}(N)]^\\top, {\\mathbf K}:=[{\\bm k}(1),\\dots,{\\bm k}(N)]^\\top')
('1.0', '{\\mathbf V}:=[{\\bm v}(1),\\dots,{\\bm v}(N)]^\\top')
('1.0', '{\\bm q}(i),{\\bm k}(i)')
('1.0', '{\\bm v}(i)')
('1.0', 'i=1,\\dots,N')
('1.0', '{\\mathbf U}:=[{\\bm u}(1),\\dots,{\\bm u}(N)]^\\top \\in {\\mathbb{R}}^{N\\times D_{qk}}')
('1.0', '\\label{eq:attention-mat}\n{{\\mathbf U}}={\\rm softmax}\\Big({{\\mathbf Q}}{{\\mathbf K}}^\\top /{\\sqrt{D_{qk}}}\\Big){\\bf V} :={\\mathbf A}{{\\mathbf V}},')
('1.0', '{\\mathbf Q}{\\mathbf K}^\\top/\\sqrt{D_{qk}}')
('1.0', '{\\mathbf A}:={\\rm softmax}\\Big(\\frac{{{\\mathbf Q}}{{\\mathbf K}}^\\top }{\\sqrt{D_{qk}}}\\Big) \\in {\\mathbb{R}}^{N\\times N}')
('1.0', 'a_{ij}')
('1.0', 'i,\\,j=1,\\cdots,N')
('1.0', '{\\bm q}(i)')
('1.0', 'i=1,\\cdots,N')
('1.0', '{{\\bm u}}(i)')
('1.0', '\\label{eq:attention-vec}\n{{\\bm u}}(i)=\\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm q}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j).')
('2', '{\\mathbf U}:=[{\\bm u}(1),\\cdots,{\\bm u}(N)]^\\top \\in {\\mathbb{R}}^{N \\times D}')
('2', '\\Omega \\subset {\\mathbb{R}}')
('2', 'x \\in \\Omega')
('2', '{\\bm u}(x):=[u_{1}(x), \\dots, u_{D}(x)]^T')
('2', '{\\bm u}:\\Omega \\rightarrow {\\mathbb{R}}^{D}')
('2', '{\\bm u}\\in L^{2}(\\Omega)')
('2', '{\\mathbf U}')
('2', '{\\bm u}(x)')
('2', '{\\mathbf U}')
('2', '{\\bm u}(x)')
('2', 'x \\in \\Omega')
('2', '{\\bm f}(x)')
('2', 'x \\in \\Omega')
('2', '{\\bm f}:\\Omega \\rightarrow {\\mathbb{R}}^{D}')
('2', '{\\bm f}\\in L^{2}(\\Omega)')
('2', '{\\bm f}(x)')
('2', '\\begin{aligned}\n{\\bm f}(x) = {\\bm u}(x) + {\\bm n}(x),\n\\end{aligned}')
('2', '{\\bm n}')
('2', '{\\bm u}(x)')
('2', '{\\bm f}(x)')
('2', '{\\bm u}(x)')
('2', '{\\bm u}')
('2', '\\begin{aligned}\n\\label{eqn:energy-functional}\n    E({\\bm u}, {\\bm f}) &= J({\\bm u}) + G({\\bm u},{\\bm f}) \\\\ \\nonumber\n    &= \\frac{1}{2} \\int_{\\Omega \\times \\Omega} \\|{\\bm u}(x) - {\\bm u}(y)\\|_2^2 k(x, y)dx dy + \\frac{\\lambda}{2}  \\int_{\\Omega} \\|{\\bm u}(x) - {\\bm f}(x)\\|_2^2 dx.\n\\end{aligned}')
('2', 'J({\\bm u}) = \\frac{1}{2} \\int_{\\Omega \\times \\Omega} \\|{\\bm u}(x) - {\\bm u}(y)\\|_2^2 k(x, y)dxdy')
('2', 'k(x, y)')
('2', 'x')
('2', 'y')
('2', 'k(x, y)')
('2', 'x')
('2', 'y')
('2', 'J({\\bm u})')
('2', 'J({\\bm u})')
('2', '{\\bm u}')
('2', 'G({\\bm u},{\\bm f}) =\\frac{\\lambda}{2}  \\int_{\\Omega} \\|{\\bm u}(x) - {\\bm f}(x)\\|_2^2 dx')
('2', 'J({\\bm u})')
('2', '{\\bm u}(x)')
('2', '{\\bm f}(x)')
('2', 'E({\\bm u}, {\\bm f})')
('2.0', 'J({\\bm u})')
('2.0', 'E({\\bm u}, {\\bm f})')
('2.0', 'J({\\bm u})')
('2.0', '\\begin{aligned}\n    J({\\bm u}) = \\frac{1}{2} \\int_{\\Omega \\times \\Omega}\\sum_{j=1}^{D}(u_j(x) - u_j(y))^2 k(x, y)dxdy\n\\end{aligned}')
('2.0', 'J')
('2.0', '{\\bm u}')
('2.0', '\\begin{aligned}\n\\label{eqn:devJu}\n    \\nabla_{{\\bm u}} J({\\bm u}) = \\left[\\frac{\\partial J}{\\partial u_1}, \\frac{\\partial J}{\\partial u_2},  \\dots, \\frac{\\partial J}{\\partial u_{D}} \\right]^T.\n% \\label{eq:}\n\\end{aligned}')
('2.0', '{\\partial J}/{\\partial u_j}')
('2.0', 'j = 1, 2, \\dots, D')
('2.0', 'h_j \\in L^{2}(\\Omega)')
('2.0', '\\begin{aligned}\n    \\frac{\\partial J}{\\partial u_j}\\cdot h_j(x) &= \\frac{d}{d\\tau}J(u_j + \\tau h_j)\\bigl|_{\\tau=0} \\nonumber \\\\ \n&= \\frac{1}{2} \\left(\\frac{d}{d\\tau}  \\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y) + \\tau h_j(x) - \\tau h_j(y))^{2} k(x, y)dxdy\\right)\\biggl|_{\\tau=0} \\nonumber \\\\\n&= \\left(\\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y) + \\tau h_j(x) - \\tau h_j(y))(h_j(x) -h_j(y))k(x, y)dxdy\\right)\\biggl|_{\\tau=0} \\nonumber \\\\\n&= \\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y))(h_j(x) -h_j(y))k(x, y)dxdy \\nonumber \\\\\n&= \\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y))h_j(x)k(x, y)dxdy - \\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y))h_j(y)k(x, y)dxdy \\nonumber\n% \\frac{d}{d\\tau} \\int_{\\Omega \\times \\Omega} \\bigl(u_i(x) - u_i(y) \\bigl)\\bigl(h_i(x) - h_i(y) \\bigl)k(x, y)dxdy.\n\\end{aligned}')
('2.0', '(x, y) \\rightarrow (y, x)')
('2.0', '\\begin{aligned}\n\\frac{\\partial J}{\\partial u_j} \\cdot h_j(x) &= \\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y))h_j(x)k(x, y)dxdy - \\int_{\\Omega \\times \\Omega}(u_j(y) - u_j(x))h_j(x)k(y, x)dxdy \\nonumber \\\\\n&= \\int_{\\Omega \\times \\Omega}(u_j(x) - u_j(y)(k(x, y) + k(y, x))dyh_j(x)dx \\nonumber\n\\end{aligned}')
('2.0', 'u_j')
('2.0', '\\begin{aligned}\n\\label{eq:partial-dev}\n\\frac{\\partial J}{\\partial u_j} \n&= \\int_{\\Omega}(u_j(x) - u_j(y)(k(x, y) + k(y, x))dy. \n\\end{aligned}')
('2.0', '{\\partial J}/{\\partial u_j}')
('2.0', '\\nabla_{{\\bm u}} J({\\bm u})(x)')
('2.0', '\\begin{aligned}\n    \\label{eq:gradient-descent}\n    \\frac{d{\\bm u}(x,t)}{dt} &= -\\nabla_{\\bm{u}}J({\\bm u}) = \\int_{\\Omega} \\bigl(\\bm{u}(y,t) - \\bm{u}(x,t) \\bigl)\\bigl(k(x, y) + k(y,x)\\bigl)dy,\n\\end{aligned}')
('2.0', 't')
('2.0', '{\\bm u}')
('2.0', 'J({\\bm u})')
('2.0', '{\\bm v}(x):=[v_{1}(x), \\dots, v_{D}(x)]^T')
('2.0', '{\\bm v}:\\Omega \\rightarrow {\\mathbb{R}}^{D}')
('2.0', '{\\bm v}\\in L^{2}(\\Omega)')
('2.0', '{\\bm v}(x)')
('2.0', '{\\bm v}(1), \\dots, {\\bm v}(N) \\in {\\mathbb{R}}^{D}')
('2.0', '{\\mathbf V}:=[{\\bm v}(1),\\cdots,{\\bm v}(N)]^\\top \\in {\\mathbb{R}}^{N \\times D}')
('2.0', '{\\bm u}')
('2.0', 't=0')
('2.0', '{\\bm v}(x)')
('2.0', '{\\bm u}(x, 0) = {\\bm v}(x)')
('2.0', '\\Delta t(x) = {1}/{\\int_{\\Omega}\\bigl(k(x, y) + k(y,x)\\bigl)dy}')
('2.0', "\\begin{aligned}\n\\label{eq:adaptive-stepsize-GD}\n        \\bm{u}(x, \\Delta t(x)) \n        &= \\bm{u}(x, 0) + \\Delta t(x)\\int_{\\Omega} \\bigl(\\bm{u}(y, 0) - \\bm{u}(x, 0) \\bigl)\\bigl(k(x, y) + k(y,x)\\bigl)dy\\nonumber \\\\\n    &=\\int_{\\Omega}\\displaystyle\\frac{\\bigl(k(x, y) + k(y,x)\\bigl) \\bm{u}(y, 0)}{\\int_{\\Omega}\\bigl(k(x, y') + k(y',x)\\bigl)dy'}dy =\\int_{\\Omega}\\displaystyle\\frac{K(x, y) \\bm{v}(y)}{\\int_{\\Omega}K(x, y')dy'}dy.\n\\end{aligned}")
('2.0', 'K(x,y):=k(x,y) + k(y,x)')
('2.0', '{\\bm u}(y, 0) = {\\bm v}(y)')
('2.0', '{\\bm u}')
('2.0', 't=0')
('2.0', '{\\bm v}')
('2.0', '{\\bm k}(x):=[k_{1}(x), \\dots, k_{D_{qk}}(x)]^T')
('2.0', '{\\bm k}:\\Omega \\rightarrow {\\mathbb{R}}^{D_{qk}}')
('2.0', '{\\bm k}\\in L^{2}(\\Omega)')
('2.0', '{\\bm u}(x)')
('2.0', '{\\bm v}(x)')
('2.0', '{\\bm k}(x)')
('2.0', '{\\bm k}(1), \\dots, {\\bm k}(N) \\in {\\mathbb{R}}^{D_{qk}}')
('2.0', '{\\mathbf K}:=[{\\bm k}(1),\\cdots,{\\bm k}(N)]^\\top \\in {\\mathbb{R}}^{N \\times D_{qk}}')
('2.0', 'K(x,y) = \\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(y)/\\sqrt{D_{qk}}\\bigl)')
('2.0', "\\begin{aligned}\n\\label{eqn:sym-attn-cont}\n\\bm{u}(x, \\Delta t(x)) &= \\int_{\\Omega}\\displaystyle\\frac{\\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(y)/\\sqrt{D_{qk}}\\bigl)}{\\int_{\\Omega}\\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(y')/\\sqrt{D_{qk}}\\bigl)dy'}{\\bm v}(y)dy.\n\\end{aligned}")
('2.0', '{\\bm k}(1),\\dots,{\\bm k}(N) \\in {\\mathbb{R}}^{D_{qk}}')
('2.0', '{\\bm v}(1),\\dots,{\\bm v}(N) \\in {\\mathbb{R}}^{D}')
('2.0', "\\begin{aligned}\n\\label{eqn:sym-attn-disr-1}\n\\bm{u}(x, \\Delta t(x)) &\\approx \\sum_{j = 1}^N\\displaystyle\\frac{\\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(j)/\\sqrt{D_{qk}}\\bigl)}{\\sum_{j' = 1}^N\\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(j')/\\sqrt{D_{qk}}\\bigl)}{\\bm v}(j).\n\\end{aligned}")
('2.0', '\\bm{u}(x, \\Delta t(x))')
('2.0', "\\begin{aligned}\n\\label{eqn:sym-attn-disr-2}\n\\bm{u}(i) &\\approx \\sum_{j = 1}^N\\displaystyle\\frac{\\exp\\bigl({\\bm k}(i)^{T}{\\bm k}(j)/\\sqrt{D_{qk}}\\bigl)}{\\sum_{j' = 1}^N\\exp\\bigl({\\bm k}(i)^{T}{\\bm k}(j')/\\sqrt{D_{qk}}\\bigl)}{\\bm v}(j) \\nonumber \\\\\n&= \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j),\\,\\,\\, i=1,\\dots,N.\n\\end{aligned}")
('2.0', '{\\mathbf Q}')
('2.0', '{\\mathbf K}')
('2.0', '{\\mathbf W}_Q = {\\mathbf W}_K')
('2.0', '{\\mathbf W}_Q')
('2.0', '{\\mathbf W}_K')
('2.0', '{\\mathbf X}')
('2.0', '{\\mathbf Q}')
('2.0', '{\\mathbf K}')
('2.0', '{\\bm k}(i)')
('2.0', '{\\bm q}(i)')
('2.0', 'i=1,\\dots,N')
('2.0', 'J({\\bm u}) = \\frac{1}{2} \\int_{\\Omega \\times \\Omega} \\|{\\bm u}(x) - {\\bm u}(y)\\|_2^2 k(x, y)dxdy')
('2.0', '{\\bm u}: \\Omega \\to \\mathbb{R}^{D}')
('2.0', '{\\bm u}\\in L^{2}(\\Omega)')
('2.0', 'K(x,y):=k(x,y) + k(y,x) = \\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(y)/\\sqrt{D_{qk}}\\bigl)')
('2.0', '{\\bm k}:\\Omega \\rightarrow {\\mathbb{R}}^{D_{qk}}')
('2.0', '{\\bm k}\\in L^{2}(\\Omega)')
('2.0', '{\\bm u}')
('2.0', 't=0')
('2.0', '{\\bm u}(x,0)={\\bm v}(x)')
('2.0', '\\Delta t(x):= \\displaystyle \\frac{1}{\\int_{\\Omega}\\bigl(k(x, y) + k(y,x)\\bigl)dy}')
('2.0', 'J')
('2.0', '{\\bm u}')
('2.0', '\\begin{aligned}\n\\bm{u}(x, \\Delta t(x)) = \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm k}}(x)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j), \\nonumber\n\\end{aligned}')
('2.0', '\\begin{aligned}\n\\label{eqn:thm-sym-attn}\n\\bm{u}(i) = \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j),\\,\\,\\, i=1,\\dots,N.\n\\end{aligned}')
('2.0', '{\\bm u}(n)')
('2.0', '{\\bm v}(n)')
('2.0', '{\\bm u}(n)')
('2.0', 'n=1,\\dots,N')
('2.0', '{\\bm k}(i)')
('2.0', '{\\bm q}(i)')
('2.0', 'i=1,\\dots,N')
('2.0', '\\begin{aligned}\n\\label{eqn:thm-asym-attn}\n\\bm{u}(i) = \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm q}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j),\\,\\,\\, i=1,\\dots,N. \\nonumber\n\\end{aligned}')
('2.0', '{\\bm u}')
('2.0', 'x')
('2.0', '{\\bm u}(x)')
('2.0', '{\\bm u}')
('2.0', '\\Omega')
('2.0', '{\\bm u}(x)')
('2.0', '{\\bm u}(x)')
('2.1', '{\\bm u}')
('2.1', '{\\bm u}')
('2.1', '{\\bm u}(x)')
('2.1', 'k')
('2.1', '{\\bm u}(x, 0) = {\\bm v}(x)')
('2.1', '\\Delta t = \\displaystyle {1}/{\\int_{\\Omega}\\bigl(k(x, y) + k(y,x)\\bigl)dy}')
('2.1', "\\begin{aligned}\n\\label{eq:uk}\n        \\bm{u}(x, k\\Delta t(x)) \n        % &= \\bm{u}(x, (k - 1)\\Delta t(x)) \\nonumber \\\\\n        % &+ \\Delta t(x)\\int_{\\Omega} \\bigl(\\bm{u}(y, (k - 1)\\Delta t(x)) - \\bm{u}(x, (k - 1)\\Delta t(x)) \\bigl)\\bigl(k(x, y) + k(y,x)\\bigl)dy\\nonumber \\\\\n    &=\\int_{\\Omega}\\displaystyle\\frac{K(x, y) \\bm{u}(y, (k - 1)\\Delta t(x))}{\\int_{\\Omega}K(x, y')dy'}dy.\n\\end{aligned}")
('2.1', '\\bm{u}(x, k\\Delta t(x))')
('2.1', '\\begin{aligned}\n\\label{eq:rwu}\n\\bm{u}^{(k)}(i) = \\sum_{j = 1}^N{\\mathbf A}_{ij}{\\bm u}^{(k-1)}(j)\n\\end{aligned}')
('2.1', '{\\mathbf A}_{ij}')
('2.1', '{\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('2.1', '{\\rm softmax}\\Big({{\\bm q}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('2.1', '\\{\\mathbf{B}^{(k)}(i)\\}_{k \\in K}')
('2.1', '\\{{\\bm v}(i)\\}^N_{i = 1}')
('2.1', '\\label{eq:def-rw}\n    \\begin{aligned}\n        \\mathbf{B}^{(0)}(i) &= {\\bm v}(i) \\\\ \n        \\mathbb{P}(\\mathbf{B}^{(k + 1)}(l) = {\\bm v}(j) &| \\mathbf{B}^{(k)}(l) = {\\bm v}(i)) = {\\mathbf A}_{ij}\n    \\end{aligned}')
('2.1', '\\mathbf{B}^{(k)}(n)')
('2.1', 'k')
('2.1', 'n')
('2.1', '{\\bm v}(n)')
('2.1', 'n')
('2.1', 'n = 1, 2, \\dots, N')
('2.1', '{\\mathbf A}')
('2.1', '{\\bm u}')
('2.1', 'i = 1, 2, \\dots, N')
('2.1', 'k')
('2.1', '{\\bm u}^{(0)}(i) = {\\bm v}(i)')
('2.1', '{\\bm u}(i)^{(k)}')
('2.1', 'k')
('2.1', 'i')
('2.1', '{\\bm u}^{(k)}(i)')
('2.1', '\\{\\mathbf{B}^{(k)}(i)\\}_{k \\in K}')
('2.1', '\\begin{aligned}\n{\\bm u}^{(k)}(i) = \\mathbb{E}[\\mathbf{B}^{(k)}(i)].\n\\end{aligned}')
('2.1', '{\\bm u}^{(k)}(i)')
('2.1', '\\mathbf{B}^{(k)}(i)')
('2.1', '{\\mathbf A}')
('2.1', '{\\mathbf A}_{ij} = {\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('2.1', '{\\mathbf A}_{ij} = {\\rm softmax}\\Big({{\\bm q}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('2.1', '\\pmb{\\pi} = [\\pi_1, \\pi_2, \\dots, \\pi_N]')
('2.1', '\\pi_i := P(\\mathbf{B}^{(k)}(j) = {\\bm v}(i))')
('2.1', 'i,j = 1, 2, \\dots, N')
('2.1', '\\sum_{i = 1}^N \\pi_i = 1')
('2.1', '\\pmb{\\pi}^T = \\pmb{\\pi}^T{\\mathbf A}')
('2.1', '{\\mathbf A}_{ij} = {\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('2.1', '\\begin{aligned}\n\\pmb{\\pi} = \\Bigg( \\frac{d_1}{\\sum_{j = 1}^N d_j}, \\frac{d_2}{\\sum_{j = 1}^N d_j}, \\dots, \\frac{d_n}{\\sum_{j = 1}^N d_j} \\Bigg),\n\\end{aligned}')
('2.1', 'd_i = \\sum_{j = 1}^N {\\rm exp}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('2.1', '{{\\bm k}}(1), {{\\bm k}}(2), \\dots, {{\\bm k}}(N)')
('2.1', '\\pi_i')
('2.1', '{\\mathbf A}')
('2.1', 'i = 1, 2, \\dots, N')
('2.1', '\\begin{aligned}\n        {\\bm u}^{(k)}(i) = \\mathbb{E}[\\mathbf{B}^{(k)}(i)] = \\sum_{j = 1}^N {\\bm v}(j) \\mathbb{P}(\\mathbf{B}^{(k - 1)}(i) = {\\bm v}(j)) \\rightarrow \\sum_{j = 1}^N \\pi_j {\\bm v}(j) =: \\bar{{\\bm v}}.\n    \\end{aligned}')
('2.1', 'k \\rightarrow \\infty')
('2.1', 'k')
('2.1', '{\\bm u}(i)^{(k)}')
('2.1', '{\\bm u}(x)')
('3', 'J({\\bm u})')
('3', '{\\bm u}')
('3', 'J({\\bm u})')
('3', 'E({\\bm u}, {\\bm f})')
('3', 'J({\\bm u})')
('3', 'G({\\bm u},{\\bm f}) = \\frac{\\lambda}{2}  \\int_{\\Omega} \\|{\\bm u}(x) - {\\bm f}(x)\\|_2^2 dx')
('3', '{\\bm f}(x)')
('3', '{\\bm u}(x)')
('3', '{\\bm f}(x)')
('3', 'J({\\bm u})')
('3', 'E({\\bm u}, {\\bm f})')
('3', 'E({\\bm u}, {\\bm f})')
('3', 'E(\\bm{u}, {\\bm f}) = J(\\bm{u}) + G(\\bm{u}, {\\bm f}) = J(\\bm{u}) + \\frac{\\lambda}{2} \\int_{\\Omega}\\sum_{j=1}^{D}(u_j(x) - f_j(x))^2 dx  \\nonumber')
('3', 'E(\\bm{u}, {\\bm f})')
('3', '\\label{eq:gradient-descent-Euv}\n    \\frac{d\\bm{u}(x,t)}{dt} = -\\nabla_{\\bm{u}}E({\\bm u}, {\\bm f}) = -\\nabla_{\\bm{u}}J({\\bm u}) - \\lambda \\bigl({\\bm u}(x) - {\\bm f}(x)\\bigl),')
('3', '\\Delta t(x) = {1}/{\\int_{\\Omega}\\bigl(k(x, y) + k(y,x)\\bigl)dy}')
('3', '{\\bm u}')
('3', 't=0')
('3', '{\\bm v}(x)')
('3', '{\\bm u}(x, 0) = {\\bm v}(x)')
('3', '\\lambda = \\tilde{\\lambda}/\\Delta t(x)')
('3', "\\begin{aligned}\n\\label{eq:neutreno-GD-1}\n    \\bm{u}(x, \\Delta t(x))  &= \\bm{u}(x, 0) - \\Delta t(x)\\nabla_{\\bm{u}}J - \\lambda\\Delta t(x) \\bigl(\\bm{u}(x, 0) - {\\bm f}(x)\\bigl) \\nonumber \\\\\n    &= \\int_{\\Omega}\\displaystyle\\frac{K(x, y) \\bm{v}(y)}{\\int_{\\Omega}K(x, y')dy'}dy + \\tilde{\\lambda} \\bigl({\\bm f}(x) - \\bm{v}(x)\\bigl).\n\\end{aligned}")
('3', '{\\bm f}(x)={\\bm v}^{0}(x)')
('3', '{\\bm v}^{0}(x)')
('3', '{\\bm v}(x)')
('3', "\\begin{aligned}\n\\label{eq:neutreno-GD-2}\n    \\bm{u}(x, \\Delta t(x)) &= \\int_{\\Omega}\\displaystyle\\frac{K(x, y) \\bm{v}(y)}{\\int_{\\Omega}K(x, y')dy'}dy + \\tilde{\\lambda} \\bigl({\\bm v}^{0}(x) - \\bm{v}(x)\\bigl).\n\\end{aligned}")
('3', '\\bm{u}(x, \\Delta t(x))')
('3', '\\bm{v}(x)')
('3', '{\\bm v}^{0}(x)')
('3', '\\begin{aligned}\n\\label{eqn:neutreno-sym-attn}\n\\bm{u}(i) = \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j) + \\tilde{\\lambda}({\\bm v}^{0}(i) - {\\bm v}(i)),\\,\\,\\, i=1,\\dots,N.\n\\end{aligned}')
('3', '{\\bm k}(i)')
('3', '{\\bm q}(i)')
('3', 'i=1,\\dots,N')
('3', '\\begin{aligned}\n\\label{eqn:neutreno-asym-attn}\n\\bm{u}(i) = \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm q}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}(j) + \\tilde{\\lambda}({\\bm v}^{0}(i) - {\\bm v}(i)),\\,\\,\\, i=1,\\dots,N.\n\\end{aligned}')
('3', '\\{{\\bm k}^{\\ell}(j),{\\bm v}^{\\ell}(j)\\}_{j=1}^{N}')
('3', '\\ell')
('3', '\\ell=1,\\dots,L')
('3', '{\\bm q}^{\\ell}(i)')
('3', 'i=1,\\dots,N')
('3', '\\ell')
('3', '{\\bm u}^{\\ell}(i)')
('3', '{\\bm q}^{\\ell}(i)')
('3', '\\begin{aligned}\n\\label{eqn:neutreno-asym-attn-def}\n\\bm{u}^{\\ell}(i) = \\sum_{j=1}^N{\\rm softmax}\\Big({{\\bm q}}^{\\ell}(i)^\\top{{\\bm k}}^{\\ell}(j)/\\sqrt{D_{qk}}\\Big){{\\bm v}}^{\\ell}(j) + \\tilde{\\lambda}({\\bm v}^{0}(i) - {\\bm v}^{\\ell}(i)),\\,\\,\\, i=1,\\dots,N.\n\\end{aligned}')
('3', '{\\bm v}^{0}(1),\\dots {\\bm v}^{0}(N)\\in {\\mathbb{R}}^{D}')
('3', '{\\bm u}(x)')
('5', 'J({\\bm u})')
('5', 'J({\\bm u})')
('5', '\\nabla_{{\\bm u}} J({\\bm u})')
('5', 'K(x, y)')
('5', 'J({\\bm u})')
('5', 'J({\\bm u})')
('5', 'J({\\bm u})')
('8.0', '1.28')
('8.0', '50,000')
('8.0', '\\tilde{\\lambda}')
('8.0', '0.6')
('8.1', '\\tilde{\\lambda} = 0.6')
('8.2', '28,000')
('8.2', '103')
('8.2', '3,600')
('8.2', '218,000')
('8.2', '246,000')
('8.2', '60')
('8.2', '268,000')
('8.2', 'L')
('8.2', 'L')
('8.2', '\\tilde{\\lambda} = 0.4')
('9.0', 'i = 1, \\dots, N')
('9.0', '\\mathbb{E}[\\mathbf{B}^{(0)}(i)] = {\\bm v}(i)')
('9.0', '\\mathbb{E}[\\mathbf{B}^{(k)}(i)] = {\\bm u}^{(k)}(i)')
('9.0', '\\begin{aligned}\n    \\nonumber\n    \\mathbb{E}[\\mathbf{B}^{(k + 1)}(i)] &= \\sum_{j = 1}^N {\\bm v}(j) \\mathbb{P}( \\mathbf{B}^{(k + 1)}(i) = {\\bm v}(j))\\\\\n    &= \\sum_{j = 1}^N {\\bm v}(j) \\sum_{l = 1}^N \\mathbb{P}( \\mathbf{B}^{(k + 1)}(i) = {\\bm v}(j)| \\mathbf{B}^{(1)}(i) = {\\bm v}(l))\\mathbb{P}( \\mathbf{B}^{(1)}(i) = {\\bm v}(l))\\\\\n    % &= \\sum_{j = 1}^N \\bv(j) \\sum_{l = 1}^N \\mathbb{P}( \\mathbf{B}^{(k)}(l) = \\bv(j)| \\mathbf{B}^{(1)}(i) = \\bv(l))\\mathbb{P}( \\mathbf{B}^{(1)}(i) = \\bv(l))\\\\\n    &= \\sum_{j = 1}^N {\\bm v}_j \\sum_{l = 1}^N \\mathbb{P}( \\mathbf{B}^{(k)}(l) = {\\bm v}(j))\\mathbb{P}( \\mathbf{B}^{(1)}(i) = {\\bm v}(l)| \\mathbf{B}^{(0)}(i) = {\\bm v}(i))\\\\\n    &= \\sum_{j = 1}^N {\\bm v}(j) \\sum_{l = 1}^N {\\mathbf A}_{il}\\mathbb{P}( \\mathbf{B}^{(k)}(l) = {\\bm v}(j)) \\\\\n    &= \\sum_{l = 1}^N {\\mathbf A}_{il} \\mathbb{E}[\\mathbf{B}^{(k)}(l)] = \\sum_{l = 1}^N {\\mathbf A}_{il} {\\bm u}^{(k)}(l) \\\\\n    &= {\\bm u}^{(k + 1)}(i).\n\\end{aligned}')
('9.1', '{\\mathbf A}\\in \\mathbb{R}^{N \\times N}')
('9.1', '{\\mathbf A}')
('9.1', '\\pmb{\\pi}')
('9.1', '{\\mathbf A}')
('9.1', '\\pmb{\\pi}')
('9.1', '\\begin{aligned}\n\\nonumber\n\\pmb{\\pi} = \\Bigg( \\frac{d_1}{\\sum_{j = 1}^N d_j}, \\frac{d_2}{\\sum_{j = 1}^N d_j}, \\dots, \\frac{d_n}{\\sum_{j = 1}^N d_j} \\Bigg),\n\\end{aligned}')
('9.1', 'd_i = \\sum_{j = 1}^N {\\rm exp}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('9.1', '\\nonumber\n\\begin{aligned}\n\\sum_{i = 1}^N \\pi_i{\\mathbf A}_{ij} &= \\sum_{i = 1}^N \\frac{d_i}{\\sum_{l = 1}^N d_l}\\frac{{\\rm exp}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)}{d_i} \\\\\n&= \\frac{\\sum_{i = 1}^N \\Bigg({\\rm exp}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)\\Bigg)}{\\sum_{l = 1}^N d_l} \\\\\n&= \\frac{d_j}{\\sum_{l = 1}^N d_l} = \\pi_j.\n\\end{aligned}')
('9.1', '\\pmb{\\pi}')
('9.1', '\\{\\mathbf{B}^{(k)}(i)\\}_{k \\in K}')
('9.2', 'k')
('9.2', '{\\bm u}(x, 0) = {\\bm v}(x)')
('9.2', '\\Delta t = {1}/{\\int_{\\Omega}\\bigl(k(x, y) + k(y,x)\\bigl)dy}')
('9.2', '\\lambda = \\tilde{\\lambda}/\\Delta t(x)')
('9.2', "\\begin{aligned}\n\\label{eq:neutreno-GD-k}\n    % \\bm{u}(x, k\\Delta t(x))  &= \n    % % \\bm{u}(x, (k - 1)\\Delta t(x)) - \n    % \\int_{\\Omega}\\displaystyle\\frac{K(x, y) \\bm{u}(y, (k - 1)\\Delta t(x))}{\\int_{\\Omega}K(x, y')dy'}dy - \\lambda \\Delta t(x) \\bigl(\\bm{u}(x, (k - 1)\\Delta t ) - \\bff(x)\\bigl) \\nonumber \\\\\n    \\bm{u}(x, k\\Delta t(x))  &= \n    \\bm{u}(x, (k-1)\\Delta t(x)) - \\Delta t(x)\\nabla_{\\bm{u}}J - \\lambda\\Delta t(x) \\bigl(\\bm{u}(x, (k-1)\\Delta t(x)) - {\\bm f}(x)\\bigl) \\nonumber \\\\\n    &= \\int_{\\Omega}\\displaystyle\\frac{K(x, y) \\bm{u}(y, (k - 1)\\Delta t(x))}{\\int_{\\Omega}K(x, y')dy'}dy + \\tilde{\\lambda} \\bigl({\\bm f}(x) - \\bm{u}(x, (k - 1)\\Delta t(x) )\\bigl).\n\\end{aligned}")
('9.2', '\\bm{u}(x, k\\Delta t(x))')
('9.2', '\\begin{aligned}\n\\label{eq:rwu-treno}\n\\bm{u}^{(k)}(i) = \\sum_{j = 1}^N{\\mathbf A}_{ij}{\\bm u}^{(k-1)}(j) + \\tilde{\\lambda} \\bigl({\\bm f}(i) - {\\bm u}^{(k-1)}(i)\\bigl), \n\\end{aligned}')
('9.2', '{\\mathbf A}_{ij}')
('9.2', '{\\rm softmax}\\Big({{\\bm k}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('9.2', '{\\rm softmax}\\Big({{\\bm q}}(i)^\\top{{\\bm k}}(j)/\\sqrt{D_{qk}}\\Big)')
('9.2', '{\\bm u}^{(k)}(i)')
('9.2', '\\bar{{\\bm u}}')
('9.2', 'k \\to \\infty')
('9.2', '\\begin{aligned}\n\\label{eq:prove-by-contradict}\n% \\nonumber\n&{\\bm u}^{(k + 1)}(i) - {\\bm u}^{(k + 1)}(j)\\\\ \n&= \\sum_{l = 1}^N {\\mathbf A}_{il}{\\bm u}^{(k)}(l) - \\sum_{l = 1}^N {\\mathbf A}_{jl}{\\bm u}^{(k)}(l) + \\tilde{\\lambda}({\\bm u}^{(k)}(j) - {\\bm u}^{(k)}(i)) + \\tilde{\\lambda}({\\bm f}(i) - {\\bm f}(j)) \\\\\n&= \\bigl(\\sum_{l = 1}^N {\\mathbf A}_{il}{\\bm u}^{(k)}(l) - {\\bm u}^{(k)}(i) \\sum_{l = 1}^N {\\mathbf A}_{il} \\bigl) - \\bigl(\\sum_{l = 1}^N {\\mathbf A}_{jl}{\\bm u}^{(k)}(l) - {\\bm u}^{(k)}(j) \\sum_{l = 1}^N {\\mathbf A}_{jl} \\bigl) \\\\ & \\quad + (\\tilde{\\lambda} - 1)({\\bm u}^{(k)}(j) - {\\bm u}^{(k)}(i)) +  \\tilde{\\lambda}({\\bm f}(i) - {\\bm f}(j)) \\\\\n&= \\sum_{l = 1}^N {\\mathbf A}_{il}({\\bm u}^{(k)}(l) - {\\bm u}^{(k)}(i)) - \\sum_{l = 1}^N {\\mathbf A}_{jl}({\\bm u}^{(k)}(l) - {\\bm u}^{(k)}(j)) + (\\tilde{\\lambda} - 1)({\\bm u}^{(k)}(j) - {\\bm u}^{(k)}(i)) \\\\ & \\quad+  \\tilde{\\lambda}({\\bm f}(i) - {\\bm f}(j))\n\\end{aligned}')
('9.2', '{\\bm u}^{(k)}(i) \\to \\bar{{\\bm u}}')
('9.2', 'i = 1, 2, \\dots, N')
('9.2', 'k \\to \\infty')
('9.2', '\\begin{cases}\n    ({\\bm u}^{(k + 1)}(i) - {\\bm u}^{(k + 1)}(j)) \\to \\mathbf{0} \\\\\n    ({\\bm u}^{(k)}(l) - {\\bm u}^{(k)}(i)) \\to \\mathbf{0}\\\\\n    ({\\bm u}^{(k)}(l) - {\\bm u}^{(k)}(j)) \\to \\mathbf{0}\\\\\n    ({\\bm u}^{(k)}(j) - {\\bm u}^{(k)}(i)) \\to \\mathbf{0}\n\\end{cases}')
('9.2', 'k \\to \\infty')
('9.2', '\\mathbf{0}')
('9.2', '\\tilde{\\lambda}({\\bm f}(i) - {\\bm f}(j))')
('9.2', '\\mathbf{0}')
('10', 'E({\\bm u}, {\\bm f})')
('10', '{\\bm u}')
('10', '\\begin{aligned}\n\\label{eq:devEu}\n    \\nabla_{\\bm{u}}E = \\nabla_{\\bm{u}}J + \n    \\left[\\frac{\\partial G}{\\partial u_1}, \\frac{\\partial G}{\\partial u_2}, \\dots, \\frac{\\partial G}{\\partial u_{D}} \\right]^T.\n\\end{aligned}')
('10', '{\\partial G}/{\\partial u_j}')
('10', 'j = 1, 2, \\dots, D')
('10', 'h_j \\in L^{2}(\\Omega)')
('10', '\\begin{aligned}\n\\frac{\\partial G}{\\partial u_j}\\cdot h_j(x) &= \\frac{d}{d\\tau}G(u_j + \\tau h_j)\\bigl|_{\\tau=0} \\nonumber\\\\\n&= \\frac{\\lambda}{2} \\left(\\frac{d}{d\\tau} \\int_{\\Omega} (u_j(x) - f_j(x) + \\tau h_j(x))^2 dx \\right)\\biggl|_{\\tau=0}  \\nonumber\\\\\n&= \\lambda \\int_{\\Omega} (u_j(x) - f_j(x))h_j(x)  dx  \\nonumber.\n\\end{aligned}')
('10', 'u_j')
('10', '\\label{eq:partial-devFu}\n\\frac{\\partial G}{\\partial u_j} = \\lambda (u_j(x) - f_j(x))')
('10', '{\\partial G}/{\\partial u_j}')
('10', '\\nabla_{{\\bm u}}E({\\bm u}, {\\bm f})')
('10', '\\label{eq:gradient-descent-E}\n    \\frac{d\\bm{u}(x,t)}{dt} = -\\nabla_{\\bm{v}}E({\\bm u}, {\\bm f}) = -\\nabla_{\\bm{u}}J({\\bm u})(x) + \\lambda \\bigl({\\bm f}(x) - {\\bm u}(x)\\bigl),')
('10', 't')
('10', '-\\nabla_{\\bm{u}}J({\\bm u})')
('12.0', '\\nabla_{{\\bm u}}J({\\bm u})')
('12.0', 't=0')
('12.0', '\\begin{aligned}\n\\nonumber\n\\nabla_{\\bm{u}}J({\\bm u}) &= \\int_{\\Omega} \\bigl(\\bm{u}(x,0) - \\bm{u}(y,0) \\bigl)K(x, y)dy =  \\int_{\\Omega} \\bigl(\\bm{v}(x) - \\bm{v}(y) \\bigl)K(x, y)dy,\n\\end{aligned}')
('12.0', 'K(x,y):=k(x,y) + k(y,x)')
('12.0', 'K(x,y) = \\exp\\bigl({\\bm k}(x)^{T}{\\bm k}(y)/\\sqrt{D_{qk}}\\bigl)')
('12.0', '\\sum_{j = 1}^N \\bigl( \\bm{v}(i) - \\bm{v}(j)\\bigl) \\exp\\bigl({\\bm k}(i)^{T}{\\bm k}(j)/\\sqrt{D_{qk}}\\bigl)')
('12.0', 'K(x,y) = \\exp\\bigl({\\bm q}(x)^{T}{\\bm k}(y)/\\sqrt{D_{qk}}\\bigl)')
('12.0', '\\sum_{j = 1}^N \\bigl( \\bm{v}(i) - \\bm{v}(j)\\bigl) \\exp\\bigl({\\bm q}(i)^{T}{\\bm k}(j)/\\sqrt{D_{qk}}\\bigl)')
('12.0', '\\nabla_{{\\bm u}}J({\\bm u})')
('12.1', 'J({\\bm u})')
('12.1', 'J({\\bm u})')
('12.2', '({\\bm x}_i, {\\bm x}_j)')
('12.2', '\\begin{aligned}\n\\nonumber\n\\frac{1}{N(N - 1)}\\sum_{i \\neq j}\\frac{{\\bm x}_i^T{\\bm x}_j}{\\| {\\bm x}_i\\|_2\\| {\\bm x}_j\\|_2}.\n\\end{aligned}')
('14.0', '[1, 6, 12]')
('14.3', '1.00005, 1.000002, 1.00013')
('14.6', '1.97')
('14.7', '[0.2, 1]')
('14.7', '0.2')
('14.7', '1')
('14.8', '81.39')
('14.8', '88.62')
('14.8', '80.77')
('14.8', '88.12')
('14.8', '77.32')
('14.8', '75.29')
