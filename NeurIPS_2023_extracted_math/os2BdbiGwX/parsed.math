('1', 'L1')
('1', 'L2')
('2.0', '\\mathcal{S}=\\{(x_{n}, y_{n})\\}_{n = 1}^{N}')
('2.0', 'x_{n} \\in \\mathcal{X}')
('2.0', 'y_{n}  \\in \\mathcal{Y}')
('2.0', 'f(.; w): \\mathcal{X} \\to \\mathcal{Y}')
('2.0', 'w \\in \\mathcal{W}')
('2.0', 'y')
('2.0', 'x')
('2.0', 'p(w | \\mathcal{S})')
('2.0', 'w')
('2.0', '\\mathcal{S}')
('2.0', 'p(w)')
('2.0', 'p(w | \\mathcal{S}) = \\prod_{n = 1}^{N} \\frac{p(y_{n} | x_{n}, w) \\, p(w)}{\\int_{} p(y_{n} | x_{n}, w) \\dd w}.\n    \\label{eq:Bayes_theorem}')
('2.0', 'p(w | \\mathcal{S})')
('2.0', 'q(w; \\theta)')
('2.0', '\\theta')
('2.0', 'q(w; \\theta)')
('2.0', '\\begin{split}\n    \\theta^* & = \\mathop{\\mathrm{arg\\,min}}_\\theta \\mathrm{KL}[ q(w; \\theta) \\Vert p(w|\\mathcal{S})] \\\\\n            & \\textstyle = \\mathop{\\mathrm{arg\\,min}}_\\theta \\mathrm{KL}[ q(w; \\theta) \\Vert p(w)] - \\int_{} q(w; \\theta) \\sum_{n = 1}^{N} \\log p(y_{n} | x_{n}, w) \\dd w \\\\\n            & \\textstyle = \\mathop{\\mathrm{arg\\,min}}_\\theta \\mathrm{KL}[ q(w; \\theta) \\Vert p(w)] + \\mathbb{E}_{q(w; \\theta)} \\left[ - \\sum_{i=n}^N \\log p(y_n|x_n, w) \\right],\n    \\end{split}')
('2.0', 'p(w)')
('2.0', 'w')
('2.0', 'q(w; \\theta) = \\mathcal{N}(\\mu, \\mathrm{diag}(\\sigma^{2}))')
('2.0', 'w = \\mu + \\sigma \\odot \\epsilon, \\quad \\epsilon \\sim \\mathcal{N}(0, I),')
('2.0', '\\odot')
('2.0', 'I')
('2.0', 'w = \\mu + \\sigma \\odot \\frac{\\epsilon}{\\norm{\\epsilon}} r, \\quad r = \\abs{\\rho} \\quad  \\textnormal{for} \\quad \\rho \\sim \\mathcal{N}(0, I),')
('2.0', '\\norm{.}')
('2.0', 'L1')
('2.0', 'L2')
('3.0', 'B1')
('3.0', 'B2')
('3.0', 'q(w; \\theta_{i}) = \\mathcal{N}(w; \\mu_{\\theta_{i}}, \\mathrm{diag}(\\sigma_{\\theta_{i}}^{2})), \\quad i = 1:2.')
('3.0', '\\mu_{\\theta_i}, \\sigma_{\\theta_i} \\in \\mathbb{R}^d')
('3.0', 'd')
('3.0', 'B_i, i = 1:2')
('3.0', '\\label{eq:variational_param}\n    \\textstyle \\mathcal{L}(\\theta_i) = \\mathrm{KL} \\left[ q(w; \\theta_i) \\Vert p(w) \\right] + \\mathbb{E}_{q(w; \\theta_i)} \\left[- \\sum_{n=1}^N \\log p(y_n|x_n, w) \\right].')
('3.0', 'z^{B1}')
('3.0', 'z^{B2}')
('3.0', 'B1')
('3.0', 'B2')
('3.0', '\\mathcal{T}')
('3.0', 'p^{B1}= \\mathrm{softmax}(\\nicefrac{z^{B1}}{\\mathcal{T}})')
('3.0', 'p^{B2}= \\mathrm{softmax}(\\nicefrac{z^{B2}}{\\mathcal{T}})')
('3.0', '\\begin{aligned}\n    \\mathcal{L}_{\\mathrm{logits}}^{B1} & = \\mathcal{L}(\\theta_1) + \\mathcal{T}^{2} \\times \\mathrm{KL} \\left[ p^{B2} \\Vert p^{B1} \\right], \\label{eq:logit_B1} \\\\\n    \\mathcal{L}_{\\mathrm{logits}}^{B2} & = \\mathcal{L}(\\theta_2) + \\mathcal{T}^{2} \\times \\mathrm{KL} \\left[ p^{B1} \\Vert p^{B2} \\right]. \\label{eq:logit_B2}\n\\end{aligned}')
('3.1', '\\theta_1 = (\\mu_{\\theta_1}, \\Sigma_{\\theta_1})')
('3.1', '\\theta_2 = (\\mu_{\\theta_2}, \\Sigma_{\\theta_2})')
('3.1', 'B1')
('3.1', 'B2')
('3.1', 'D(q(w;\\theta_1), q(w; \\theta_2))')
('3.1', '\\label{eq:ot_param}\n    D(q(w;\\theta_1), q(w; \\theta_2)) =\\mathcal{W}_2(q(w; \\theta_1), q(w; \\theta_2))^2 = \\norm{\\mu_{\\theta_1} - \\mu_{\\theta_2}}^2 + \\mathcal{B}(\\Sigma_{\\theta_1}, \\Sigma_{\\theta_2})^2,')
('3.1', '\\mathcal{B}(., .)')
('3.1', '\\mathcal{B} \\left( \\Sigma_{\\theta_1}, \\Sigma_{\\theta_2} \\right)^2 \n     = \\trace(\\Sigma_{\\theta_1} + \\Sigma_{\\theta_2} - 2(\\Sigma_{\\theta_1}^{1/2} \\Sigma_{\\theta_2} \\Sigma_{\\theta_1}^{1/2})^{1/2}).')
('3.1', '\\Sigma_{\\theta_1} = \\mathrm{diag}(\\sigma_{\\theta_1}^2)')
('3.1', '\\Sigma_{\\theta_2} = \\mathrm{diag}(\\sigma_{\\theta_2}^2)')
('3.1', '\\label{eq:ot_param_simplify}\n    D(q(w;\\theta_1), q(w; \\theta_2)) = \\norm{\\mu_{\\theta_1} - \\mu_{\\theta_2}}^2 + \\norm{\\sigma_{\\theta_1} - \\sigma_{\\theta_2}}^2.')
('3.1', 'D(q(w;{\\theta_1}), q(w; {\\theta_2}))')
('3.1', 'D(q(w;{\\theta_1}), q(w; {\\theta_2}))')
('3.1', '\\label{eq:diverse_param}\n    \\mathcal{L}_{\\mathrm{diverse~param}} = \\log(1 + \\exp(- D(q(w;\\theta_1), q(w; \\theta_2)))).')
('3.1', '\\mathcal{L}_{\\mathrm{diverse~param}} \\ge 0')
('3.1', '\\mathcal{L}_{\\mathrm{diverse~param}}')
('3.1', 'D(q(w;\\theta_1), q(w; \\theta_2))')
('3.1', '\\mu_{\\theta_1}, \\sigma_{\\theta_1} \\gets')
('3.1', '\\mu_{\\theta_2} \\gets')
('3.1', '\\sigma_{\\theta_2} \\gets')
('3.1', '\\mathbb{B}=\\left\\{ \\left( x_i, y_i \\right): ( x_i, y_i ) \\sim \\cal{S} \\right\\}_{i = 1}^{n_{\\mathrm{batch~size}}}')
('3.1', 'D_{\\mathrm{OT}} \\gets')
('3.1', '\\mathcal{L}_{\\mathrm{diverse~param}}')
('3.1', '\\mathcal{L}_{\\mathrm{logits}}^{B1}')
('3.1', '\\mathcal{L}_{\\mathrm{diverse~feat}}^{B1}')
('3.1', '\\mathcal{L}^{B1}  =  \\mathcal{L}_{\\text{logits}}^{B1} + \\alpha \\mathcal{L}_{\\text{diverse~param}} + \\beta\\mathcal{L}_{\\text{diverse~feat}}^{B1}')
('3.1', '\\mu_{\\theta_1}, \\sigma_{\\theta_1} \\gets \\Call{Adam}{\\mathcal{L}^{B1}}')
('3.1', '\\mathcal{L}_{\\mathrm{logits}}^{B2}')
('3.1', '\\mathcal{L}_{\\mathrm{diverse~feat}}^{B2}')
('3.1', '\\mathcal{L}^{B2} =  \\mathcal{L}_{\\text{logits}}^{B2} + \\alpha \\mathcal{L}_{\\text{diverse~param}} + \\beta\\mathcal{L}_{\\text{diverse~feat}}^{B2}')
('3.1', '\\mu_{\\theta_2}, \\sigma_{\\theta_2} \\gets \\Call{Adam}{\\mathcal{L}^{B2}}')
('3.1', '\\mu_{\\theta_1}, \\sigma_{\\theta_1}, \\mu_{\\theta_2}, \\sigma_{\\theta_2}')
('3.2', 'L2')
('3.2', 'F^{B1}_k')
('3.2', 'F^{B2}_k')
('3.2', 'k^{th}')
('3.2', 'B1')
('3.2', 'B2')
('3.2', 'L_1')
('3.2', 'L_2')
('3.2', 'F^{B1}_k')
('3.2', 'F^{B2}_k')
('3.2', 'k^{th}')
('3.2', '(k+1)^{th}')
('3.2', 'B1')
('3.2', "F'^{B1} = u({F^{B1}_k}, {F^{B1}_{k+1}}) = \\mathrm{softmax} \\left[ (\\mathbf{W}_QF^{B1}_{k+1})(\\mathbf{W}_KF^{B1}_k)^{\\top} \\right] \\mathbf{W}_VF^{B1}_k,")
('3.2', '\\mathbf{W}_Q')
('3.2', '\\mathbf{W}_K')
('3.2', '\\mathbf{W}_V')
('3.2', "F'^{B2}=u({F^{B2}_k}, {F^{B2}_{k+1}})")
('3.2', 'n')
('3.2', "G^{B1} = \\{{{F'_j}^{B1}}\\}_{j=1}^n")
('3.2', "G^{B2} = \\{{{F'_j}^{B2}}\\}_{j=1}^n")
('3.2', 'B1')
('3.2', 'B2')
('3.2', "p_{i|j} = \\frac{K(F'_i, F'_j)}{\\sum_{k=1, k \\neq i}^n K(F'_k, F'_j)},")
('3.2', 'K(a, b)')
('3.2', 'K(a, b)=\\frac{1}{2}(\\frac{a^Tb}{\\norm{a}\\norm{b}}+1)')
('3.2', '\\mathcal{Q}')
('3.2', '\\mathcal{P}')
('3.2', 'B1')
('3.2', 'B2')
('3.2', 'D_{\\mathrm{KL}}(G^{B2}, G^{B1}) = \\mathrm{KL} \\left[ \\mathcal{P} \\Vert \\mathcal{Q} \\right] = \\int \\mathcal{P}(x) \\log(\\frac{\\mathcal{P}(x) }{\\mathcal{Q}(x)}) \\dd x .')
('3.2', 'B1')
('3.2', 'B2')
('3.2', '\\label{eq:diverse_feature_loss_B1}\n    \\mathcal{L}_{\\mathrm{diverse~feat}}^{B1} = \\log(1 + \\exp(- D_{\\mathrm{KL}}(G^{B2}, G^{B1}))),')
('3.2', '\\label{eq:diverse_feature_loss_B2}\n    \\mathcal{L}_{\\mathrm{diverse~feat}}^{B2} = \\log(1 + \\exp(- D_{\\mathrm{KL}}(G^{B1}, G^{B2}))).')
('3.2', 'B1')
('3.2', 'B2')
('3.2', '\\begin{aligned}\n    \\mathcal{L}^{B1} & =  \\mathcal{L}_{\\mathrm{logits}}^{B1} + \\alpha \\mathcal{L}_{\\mathrm{diverse~param}} + \\beta\\mathcal{L}_{\\mathrm{diverse~feat}}^{B1}, \\label{eq:final_B1} \\\\\n    \\mathcal{L}^{B2} & =  \\mathcal{L}_{\\mathrm{logits}}^{B2} + \\alpha \\mathcal{L}_{\\mathrm{diverse~param}} + \\beta\\mathcal{L}_{\\mathrm{diverse~feat}}^{B2}, \\label{eq:final_B2}\n\\end{aligned}')
('3.2', '\\alpha')
('3.2', '\\beta')
('4.0.0.0', '\\beta')
('4.0.0.0', '\\mathcal{T}')
('4.0.0.0', '\\alpha')
('4.0.0.0', '\\beta')
('4.0.0.0', '\\beta')
('4.0.0.0', '\\mathcal{T}')
('4.0.0.0', '\\alpha')
('4.0.0.0', '\\beta')
('4.0.0.0', '\\mu')
('4.1.0.0', '\\mathcal{L}_{\\mathrm{logits}}')
('4.1.0.0', '\\mathcal{L}_{\\mathrm{diverse~param}}')
('4.1.0.0', '\\mathcal{L}_{\\mathrm{diverse~feat}}')
('4.2.0', '0.51\\%')
('4.2.0', '0.61\\%')
('4.2.0', '\\mathcal{L}_{\\mathrm{logits}}')
('4.2.0', '0.3\\%')
('4.2.0', '0.43\\%')
