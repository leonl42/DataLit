('2.0', '(\\mathcal{S}, \\mathcal{A}, R, P, \\mu)')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', 'P:\\mathcal{S}\\times\\mathcal{A}\\times \\mathcal{S}\\to[0,1]')
('2.0', 'R:\\mathcal{S}\\times\\mathcal{A}\\to\\mathbb{R}')
('2.0', '\\mu:\\mathcal{S}\\to [0,1]')
('2.0', '\\pi=\\{\\pi(a|s):s\\in\\mathcal{S}, a\\in\\mathcal{A}\\}')
('2.0', '\\Pi')
('2.0', 'J(\\pi) := \\mathop{\\mathrm{\\mathbb{E}}}_{\\tau\\sim\\pi}\\left[\\sum_{t=0}^{\\infty}\\gamma^t R(s_t,a_t) \\right]')
('2.0', '\\tau=(s_0,a_0,\\dots,)')
('2.0', '\\gamma\\in (0,1)')
('2.0', '\\tau\\sim\\pi')
('2.0', '\\pi')
('2.0', 's_0\\sim\\mu')
('2.0', 'a_t\\sim\\pi(\\cdot|s_t)')
('2.0', 's_{t+1}\\sim P(\\cdot|s_t,a_t)')
('2.0', 'V^{\\pi}(s):=\\mathop{\\mathrm{\\mathbb{E}}}_{\\tau\\sim\\pi}\\left[\\sum_{t=0}^{\\infty}\\gamma^t R(s_t,a_t)\\bigg| s_0=s\\right]')
('2.0', 'Q^{\\pi}(s,a):= \\mathop{\\mathrm{\\mathbb{E}}}_{\\tau\\sim\\pi}\\left[\\sum_{t=0}^{\\infty}\\gamma^t R(s_t,a_t)\\bigg| s_0=s, a_0=a\\right]')
('2.0', 'A^{\\pi}(s,a) := Q^{\\pi}(s,a)-V^{\\pi}(s)')
('2.0', 'd^{\\pi}(s) := (1-\\gamma)\\sum_{t=0}^{\\infty}\\gamma^t P(s_t=s|\\pi)')
('2.0', '\\mathcal{C}')
('2.0', '\\mathcal{C}')
('2.0', 'C_i:\\mathcal{S}\\times\\mathcal{A}\\to\\mathbb{R}')
('2.0', 'i=1,\\dots,m')
('2.0', 'C_i')
('2.0', 'J_{C_i}(\\pi) := \\mathop{\\mathrm{\\mathbb{E}}}_{\\tau\\sim\\pi}\\left[\\sum_{t=0}^{\\infty}\\gamma^t C_i(s,a)\\right]')
('2.0', '\\Pi_{\\mathcal{C}} := \\{\\pi\\in\\Pi:J_{C_i}(\\pi)\\leq b_i,i=1,\\dots,m\\}')
('2.0', '\\pi^* = \\mathop{\\mathrm{argmax}}_{\\pi\\in\\Pi_{\\mathcal{C}}}J(\\pi)')
('2.0', 'V^{\\pi}')
('2.0', 'Q^{\\pi}')
('2.0', 'A^{\\pi}')
('2.0', 'V_{C_i}^{\\pi}')
('2.0', 'Q_{C_i}^{\\pi}')
('2.0', 'A_{C_i}^{\\pi}')
('2.0', 'R')
('2.0', 'C_i')
('2.0', 'C')
('2.1', '\\Pi_\\theta=\\{\\pi_{\\theta}:\\theta\\in\\Theta\\}\\subset\\Pi')
('2.1', '\\Pi')
('2.1', 'k')
('2.1', '\\pi_{\\theta_k}')
('2.1', '\\pi_{\\theta_{k+1}}')
('2.1', '\\pi_{\\theta_k}')
('2.1', 'D(\\pi_{\\theta}, \\pi_{\\theta_k})<\\delta')
('2.1', 'D')
('2.1', 'D')
('2.1', 'D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)')
('2.1', 'C')
('2.1', 'J_{C}(\\pi_{\\theta})')
('2.1', '\\pi_{\\theta_k}')
('2.1', 'J_{C}(\\pi_{\\theta})')
('2.1', '\\pi_{\\theta}')
('2.1', '\\pi_{\\theta_k}')
('2.1', '\\pi_{\\theta_k}')
('2.1', '\\pi_{\\theta_{k+1}}')
('2.1', '\\begin{aligned}\n\\underset{\\pi_{\\theta}\\in\\Pi_{\\theta}}{\\text{maximize}} \\quad\n& \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi_{\\theta}}}[A^{\\pi_{\\theta_k}}(s,a)] \\label{eq:CPO_obj}  \\\\\n\\text{subject to} \\quad\n& J_{C}(\\pi_{\\theta_k})+\\frac{1}{1-\\gamma}\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi_{\\theta}}}\\left[A^{\\pi_{\\theta_k}}_{C}(s,a)\\right]\\leq b \\label{eq:CPO_cost_const} \\\\\n& \\bar{D}_\\text{KL}(\\pi_{\\theta}\\parallel \\pi_{\\theta_k})\\leq \\delta. \\label{eq:CPO_kl_const}  \n\\end{aligned}')
('2.1', '\\bar{D}_\\text{KL}(\\pi_{\\theta}\\parallel \\pi_{\\theta_k}) := \\mathop{\\mathrm{\\mathbb{E}}}_{s\\sim d^{\\pi_{\\theta_k}}}[D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s]]')
('2.1', '\\theta')
('3', '\\pi_{\\theta_k}')
('3', '\\pi^*')
('3', '\\Pi_{\\theta}')
('3', '\\pi_{\\theta}\\in\\Pi_{\\theta}')
('3', '\\pi^*')
('3', '\\pi_{\\theta_{k+1}}')
('3.0', '\\begin{aligned}\n\\underset{\\pi\\in\\Pi}{\\text{maximize}} \\quad\n& \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi}}[A^{\\pi_{\\theta_k}}(s,a)] \\label{eq:FOCOPS_obj} \\\\\n\\text{subject to} \\quad\n& J_{C}(\\pi_{\\theta_k})+\\frac{1}{1-\\gamma}\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi}}\\left[A^{\\pi_{\\theta_k}}_{C}(s,a)\\right]\\leq b \\label{eq:FOCOPS_cost_const} \\\\\n& \\bar{D}_\\text{KL}(\\pi\\parallel \\pi_{\\theta_k})\\leq \\delta  \\label{eq:FOCOPS_tr_const}\n\\end{aligned}')
('3.0', '\\pi')
('3.0', '\\theta')
('3.0', '\\Tilde{b}=(1-\\gamma)(b - \\Tilde{J}_{C}(\\pi_{\\theta_k}))')
('3.0', '\\pi_{\\theta_k}')
('3.0', '\\label{eq:FOCOPS_opt}\n        \\pi^{*}(a|s) = \\frac{\\pi_{\\theta_k}(a|s)}{Z_{\\lambda,\\nu}(s)}\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\\right)')
('3.0', 'Z_{\\lambda,\\nu}(s)')
('3.0', '\\lambda')
('3.0', '\\nu')
('3.0', '\\label{eq:dual}\n    \\min_{\\lambda,\\nu\\geq 0}\\;\\lambda\\delta+\\nu\\Tilde{b} + \\lambda\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[\\log Z_{\\lambda,\\nu}(s)]')
('3.0', '\\nu_1,\\dots,\\nu_m\\geq 0')
('3.0', '\\pi^*')
('3.0', '\\pi_{\\theta_k}')
('3.0', 'J_{C}(\\pi^*)\\leq b + \\frac{\\sqrt{2\\delta}\\gamma\\epsilon_{C}^{\\pi^*}}{(1-\\gamma)^2}')
('3.0', '\\epsilon_{C}^{\\pi^*}=\\max_s\\left|\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi}[A_{C}^{\\pi_{\\theta_k}}(s,a)]\\right|')
('3.1', '\\pi')
('3.1', '\\Pi')
('3.1', '\\pi^*')
('3.1', '\\Pi_{\\theta}')
('3.1', '\\pi^*')
('3.1', '\\label{eq:loss_func}\n    \\mathcal{L}(\\theta) = \\mathop{\\mathrm{\\mathbb{E}}}_{s\\sim d^{\\pi_{\\theta_k}}}\\left[D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi^*\\right)[s]\\right]')
('3.1', '\\pi_{\\theta}\\in\\Pi_{\\theta}')
('3.1', '\\mathcal{L}(\\theta)')
('3.1', '\\label{eq:loss_grad}\n    \\nabla_{\\theta}\\mathcal{L}(\\theta) = \\mathop{\\mathrm{\\mathbb{E}}}_{s\\sim d^{\\pi_{\\theta_k}}}\\left[\\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi^*\\right)[s]\\right]')
('3.1', '\\label{eq:loss_grad_s}\n    \\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi^*\\right)[s] = \\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s] \n    - \\frac{1}{\\lambda}\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi_{\\theta_k}}\\left[\\frac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{\\theta_k}(a|s)}\\left(A^{\\pi_{\\theta_k}}(s, a) - \\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\\right]')
('3.1', '\\pi_{\\theta_k}')
('3.1', '\\pi_{\\theta_k}')
('3.1', '\\lambda')
('3.1', '\\nu')
('3.1', '\\nabla_{\\theta}\\mathcal{L}(\\theta)')
('3.2', 'Z_{\\lambda,\\nu}(s)')
('3.2', '\\lambda')
('3.2', '\\nu')
('3.2', 'k')
('3.2', '\\lambda\\to 0')
('3.2', '\\pi^*')
('3.2', '\\lambda')
('3.2', '\\lambda')
('3.2', '\\lambda')
('3.2', '\\nu')
('3.2', '\\nu')
('3.2', '\\lambda^*')
('3.2', '\\nu^*')
('3.2', 'L(\\pi^*,\\lambda,\\nu)')
('3.2', '\\nu')
('3.2', 'L(\\pi^*,\\lambda,\\nu)')
('3.2', 'L(\\pi^*,\\lambda,\\nu)')
('3.2', '\\nu')
('3.2', '\\label{eq:dual_grad}\n    \\frac{\\partial L(\\pi^*,\\lambda,\\nu)}{\\partial \\nu} \n    = \\Tilde{b} - \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[A^{\\pi_{\\theta_k}}(s,a)]')
('3.2', '\\pi^*')
('3.2', '\\pi_{\\theta_k}')
('3.2', '\\pi^*')
('3.2', 'E_{s\\sim d^{\\pi_{\\theta_k}},a\\sim\\pi^*}[A^{\\pi_{\\theta_k}}(s,a)]\\approx E_{s\\sim d^{\\pi_{\\theta_k}},a\\sim\\pi_{\\theta_k}}[A^{\\pi_{\\theta_k}}(s,a)]=0')
('3.2', '\\label{eq:nu_update}\n    \\nu\\gets\\mathop{\\mathrm{\\text{proj}}}_{\\nu}\\left[\\nu -\n    \\alpha(b - J_C(\\pi_{\\theta_k}))\\right]')
('3.2', '\\alpha')
('3.2', '(1-\\gamma)')
('3.2', '\\Tilde{b}')
('3.2', '\\mathop{\\mathrm{\\text{proj}}}_{\\nu}')
('3.2', '\\nu')
('3.2', '[0,\\nu_{\\max}]')
('3.2', '\\nu_{\\max}')
('3.2', '\\nu')
('3.2', '\\nu_{\\max}')
('3.2', '\\nu_{\\max}=+\\infty')
('3.2', 'J_C(\\pi_{\\theta_k})')
('3.2', '\\pi_{\\theta_k}')
('3.2', '\\nu')
('3.2', '\\nu')
('3.2', '\\pi^*')
('3.2', '\\nu')
('3.2', 'J_C(\\pi_{\\theta_k})>b')
('3.2', '\\pi_{\\theta_k}')
('3.2', '\\nu')
('3.2', '\\nu')
('3.2', '\\theta')
('3.2', '\\pi_{\\theta}=\\pi_{\\theta_k}')
('3.2', 'I(s_j):=\\boldsymbol{1}_{D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s_j]\\leq\\delta}')
('3.2', 'D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s]')
('3.2', '\\label{eq:grad_est}\n    \\hat{\\nabla}_{\\theta} \\mathcal{L}(\\theta)\n    \\approx \\frac{1}{N}\\sum_{j=1}^N\\bigg[\\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s_j] -\\frac{1}{\\lambda}\\frac{\\nabla_{\\theta}\\pi_{\\theta}(a_j|s_j)}{\\pi_{\\theta_k}(a_j|s_j)}\\bigg(\\hat{A}(s_j, a_j) - \\nu\\hat{A}_{C}(s_j,a_j) \\bigg)\\bigg]I(s_j).')
('3.2', 'N')
('3.2', '\\pi_{\\theta_k}')
('3.2', '\\hat{A}')
('3.2', '\\hat{A}_{C}')
('3.2', '\\frac{1}{N}\\sum_{i=1}^ND_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s_i]>\\delta')
('3.2', '\\tau\\sim\\pi_{\\theta_k}')
('3.2', 'C')
('3.2', '\\nu')
('3.2', 'V_{\\phi_k}')
('3.2', 'V^{\\text{target}}_{\\phi_k}')
('3.2', 'V_{\\psi_k}^{C}')
('3.2', 'V^{C,\\text{target}}_{\\psi_k}')
('4', 'f(\\theta)')
('4', 'g(\\theta)\\leq 0')
('4', '\\max_{\\theta}\\min_{\\nu\\geq 0} (f(\\theta) - \\nu g(\\theta))')
('4', '\\theta')
('4', '\\nu')
('4.0', 'x')
('4.0', 'y')
('4.0', '95\\%')
('4.0', '95\\%')
('4.0', '1291.4\\pm 216.4')
('4.0', '1585.7\\pm 77.5')
('4.0', '1406.0\\pm 46.6')
('4.0', '\\boldsymbol{1830.0\\pm 22.6}')
('4.0', '98.78\\pm 1.77')
('4.0', '107.82\\pm 1.16')
('4.0', '100.25\\pm 0.67')
('4.0', '102.75\\pm 1.08')
('4.0', '1141.3\\pm 192.4')
('4.0', '\\boldsymbol{1621.59\\pm 39.4}')
('4.0', '1470.8\\pm 40.0')
('4.0', '1612.2\\pm 25.9')
('4.0', '151.53\\pm 1.88')
('4.0', '164.93\\pm 2.43')
('4.0', '150.05\\pm 1.40')
('4.0', '152.36\\pm 1.55')
('4.0', '1433.8\\pm 313.3')
('4.0', '750.3\\pm 355.3')
('4.0', '1167.1\\pm 257.6')
('4.0', '\\boldsymbol{1953.4\\pm 127.3}')
('4.0', '81.29\\pm 2.34')
('4.0', '87.57\\pm 3.48')
('4.0', '80.39\\pm 1.39')
('4.0', '81.84\\pm 0.92')
('4.0', '471.3\\pm 49.0')
('4.0', '4062.4\\pm 113.3')
('4.0', '3952.7\\pm 174.4')
('4.0', '\\boldsymbol{4529.7\\pm 86.2}')
('4.0', '18.89\\pm 0.77')
('4.0', '19.23\\pm 0.76')
('4.0', '15.83\\pm 0.41')
('4.0', '18.63\\pm 0.37')
('4.0', '29.73\\pm 3.13')
('4.0', '21.15\\pm 9.56')
('4.0', '20.31\\pm 6.01')
('4.0', '\\boldsymbol{31.94\\pm 2.60}')
('4.0', '24.72\\pm 0.85')
('4.0', '28.57\\pm 2.68')
('4.0', '23.88\\pm 0.64')
('4.0', '25.29\\pm 1.49')
('4.0', '2074.4\\pm 155.7')
('4.0', '1153.1\\pm 473.3')
('4.0', '1040.0\\pm 303.3')
('4.0', '\\boldsymbol{2485.9\\pm 158.3}')
('4.0', '81.7\\pm 1.14')
('4.0', '80.79\\pm 2.13')
('4.0', '78.12\\pm 1.78')
('4.0', '81.27\\pm 1.33')
('4.1', '95\\%')
('4.1', 'x')
('4.1', 'y')
('4.1', '95\\%')
('4.1', '95\\%')
('4.1', '637.4\\pm 88.2')
('4.1', '416.7\\pm 42.1')
('4.1', '390.9\\pm 43.9')
('4.1', '\\boldsymbol{965.9\\pm 46.2}')
('4.1', '50.4\\pm 4.4')
('4.1', '50.4\\pm 3.9')
('4.1', '50.0\\pm 3.5')
('4.1', '49.9\\pm 2.2')
('4.1', '1024.5\\pm 23.4')
('4.1', '697.5\\pm 14.0')
('4.1', '671.0\\pm 12.5')
('4.1', '\\boldsymbol{1106.1\\pm 32.2}')
('4.1', '50.3\\pm 0.59')
('4.1', '49.6\\pm 0.96')
('4.1', '47.9\\pm 1.5')
('4.1', '49.9\\pm 0.8')
('4.3', '\\lambda')
('4.3', '\\nu_{\\max}')
('4.3', '\\nu_{\\max}')
('4.3', '\\{1,2,3,5,10,+\\infty\\}')
('4.3', '\\nu_{\\max}')
('4.3', '\\nu_{\\max}=+\\infty')
('4.3', '0.3\\%')
('4.3', '\\nu_{\\max}=2')
('4.3', '\\lambda')
('4.3', '\\lambda')
('4.3', '7.4\\%')
('4.3', '\\lambda=1.5')
('7', '\\pi=\\{\\pi(a|s):s\\in\\mathcal{S}, a\\in\\mathcal{A}\\}')
('7', '\\pi')
('7', 'J_{C}(\\pi_{\\theta_k})')
('7', '\\pi')
('7', '\\sum_{s}d^{\\pi_{\\theta_k}}(s)D_\\text{KL}\\left(\\pi\\middle\\| \\pi_{\\theta_k}\\right)[s]\\leq \\delta')
('7', '\\pi_{\\theta_k}')
('7', 'D_\\text{KL}\\left(\\pi_{\\theta_k}\\middle\\| \\pi_{\\theta_k}\\right) = 0')
('7', '\\delta>0')
('7', 'p^*')
('7', '\\label{eq:FOCOPS_lagrange}\n        L(\\pi,\\lambda,\\nu)=\\lambda\\delta+\\nu\\Tilde{b}+\\mathop{\\mathrm{\\mathbb{E}}}_{s\\sim d^{\\pi_{\\theta_k}}}\\bigg[\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_k}}(s,a)] - \\nu\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_k}}_{C}(s,a)] \\ - \\lambda D_\\text{KL}\\left(\\pi\\middle\\| \\pi_{\\theta_k}\\right)[s] \\bigg]')
('7', '\\label{eq:min_max}\n   p^*=  \\max_{\\pi\\in\\Pi}\\min_{\\lambda,\\nu\\geq 0}  L(\\pi,\\lambda,\\nu) =\\min_{\\lambda,\\nu\\geq 0}\\max_{\\pi\\in\\Pi}L(\\pi,\\lambda,\\nu)')
('7', '\\pi^*,\\lambda^*,\\nu^*')
('7', '\\eqref{eq:min_max}')
('7', '\\pi^*')
('7', 's')
('7', '\\label{eq:focops_each_s}\n\\begin{aligned}\n\\underset{\\pi}{\\text{maximize}} \\quad\n& \\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim \\pi(\\cdot|s)} \\bigg[A^{\\pi_{\\theta_k}}(s,a) - \\nu A^{\\pi_{\\theta_k}}_{C}(s,a) -\\lambda(\\log\\pi(a|s)-\\log\\pi_{\\theta_k}(a|s)) \\bigg] \\\\\n\\text{subject to} \\quad\n& \\sum_a \\pi(a|s) = 1 \\\\\n& \\pi(a|s)\\geq 0\\quad\\text{for all }a\\in\\mathcal{A}\n\\end{aligned}')
('7', 'G(\\pi) = \\sum_a \\pi(a|s)\\bigg[A^{\\pi_{\\theta_k}}(s,a) - \\nu A^{\\pi_{\\theta_k}}_{C}(s,a) -\\lambda(\\log\\pi(a|s)-\\log\\pi_{\\theta_k}(a|s))+\\zeta \\bigg]  - 1')
('7', '\\zeta>0')
('7', '\\sum_a\\pi(a|s)=1')
('7', 'G(\\pi)')
('7', '\\pi(a|s)')
('7', 'a')
('7', '\\label{eq:lagrange_grad}\n    \\frac{\\partial G}{\\partial \\pi(a|s)}= A^{\\pi_{\\theta_k}}(s,a) - \\nu A^{\\pi_{\\theta_k}}_{C}(s,a)-\\lambda(\\log\\pi(a|s)+1-\\log\\pi_{\\theta_k}(a|s))+\\zeta')
('7', '\\pi(a|s) = \\pi_{\\theta_k}(a|s)\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a)\\right)+\\frac{\\zeta}{\\lambda}+1\\right)')
('7', '\\zeta')
('7', '\\sum_a\\pi(a|s)=1')
('7', '\\zeta/\\lambda+1')
('7', 'Z_{\\lambda,\\nu}(s)')
('7', '\\pi^*')
('7', '\\pi^{*}(a|s) = \\frac{\\pi_{\\theta_k}(a|s)}{Z_{\\lambda,\\nu}(s)}\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\\right)')
('7', '\\pi^*')
('7', '\\begin{aligned}\n        p^* &= \\min_{\\lambda,\\nu\\geq 0}\\lambda\\delta+\\nu\\Tilde{b}+\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[A^{\\pi_{\\theta_k}}(s,a)-\\nu A_{C}^{\\pi_{\\theta_k}}(s,a) -\\lambda(\\log\\pi^*(a|s)-\\log\\pi_{\\theta_k}(a|s))] \\\\\n        &= \\min_{\\lambda,\\nu\\geq 0}\\lambda\\delta+\\nu\\Tilde{b}+\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[A^{\\pi_{\\theta_k}}(s,a)-\\nu A_{C}^{\\pi_{\\theta_k}}(s,a) -\\lambda(\\log\\pi_{\\theta_k}(a|s) - \\log Z_{\\lambda,\\nu}(s) \\\\ &+\\frac{1}{\\lambda}(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a))-\\log\\pi_{\\theta_k}(a|s))] \\\\\n        &= \\min_{\\lambda,\\nu\\geq 0}\\;\\lambda\\delta+\\nu \\Tilde{b} + \\lambda\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[\\log Z_{\\lambda,\\nu}(s)]\n    \\end{aligned}')
('8', 's')
('8', '\\begin{aligned}\n    D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi^*\\right)[s] =& -\\sum_a\\pi_{\\theta}(a|s)\\log\\pi^*(a|s) + \\sum_a\\pi_{\\theta}(a|s)\\log \\pi_{\\theta}(a|s) \\\\\n    =& H(\\pi_{\\theta},\\pi^*)[s] - H(\\pi_{\\theta})[s]\n\\end{aligned}')
('8', 'H(\\pi_{\\theta})[s]')
('8', 'H(\\pi_{\\theta},\\pi^*)[s]')
('8', 's')
('8', '\\begin{aligned}\n    H(\\pi_{\\theta},\\pi^*)[s] =& -\\sum_a\\pi_{\\theta}(a|s)\\log\\pi^*(a|s) \\\\\n    =& -\\sum_a\\pi_{\\theta}(a|s)\\log\\left(\\frac{\\pi_{\\theta_k}(a|s)}{Z_{\\lambda,\\nu}(s)}\\exp\\left[\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\\right]\\right) \\\\\n    =& -\\sum_a\\pi_{\\theta}(a|s)\\log\\pi_{\\theta_k}(a|s) + \\log Z_{\\lambda,\\nu}(s) - \\frac{1}{\\lambda}\\sum_a\\pi_{\\theta}(a|s)\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\n\\end{aligned}')
('8', '\\begin{aligned}\n    D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi^*\\right)[s] =& D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s] + \\log Z_{\\lambda,\\nu}(s) - \\frac{1}{\\lambda}\\sum_a\\pi_{\\theta}(a|s)\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right) \\\\\n    =& D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s] + \\log Z_{\\lambda,\\nu}(s) - \\frac{1}{\\lambda}\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi_{\\theta_k}(\\cdot|s)}\\left[\\frac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_k}(a|s)}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\\right]\n\\end{aligned}')
('8', '\\pi_{\\theta_k}')
('8', '\\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi^*\\right)[s] = \\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta_k}\\right)[s] - \\frac{1}{\\lambda}\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi_{\\theta_k}(\\cdot|s)}\\left[\\frac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{\\theta_k}(a|s)}\\left(A^{\\pi_{\\theta_k}}(s,a)- \\nu A^{\\pi_{\\theta_k}}_{C}(s,a) \\right)\\right].')
('9', 'L(\\pi^*,\\lambda,\\nu) = \\lambda\\delta+\\nu\\Tilde{b} + \\lambda\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[\\log Z_{\\lambda,\\nu}(s)].')
('9', '\\nu')
('9', '\\Tilde{b}')
('9', '\\pi^*')
('9', '\\nu')
('9', '\\begin{aligned}\n        \\frac{\\partial\\pi^*(a|s)}{\\partial\\nu} &= \\frac{\\pi_{\\theta_k}(a|s)}{Z^2_{\\lambda,\\nu}(s)}\\bigg[Z_{\\lambda,\\nu}(s)\\frac{\\partial}{\\partial\\nu}\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a)\\right)\\right)\\\\\n        &-\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a)\\right)\\right)\\frac{\\partial Z_{\\lambda,\\nu}(s)}{\\partial\\nu}\\bigg] \\\\\n        &=-\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\pi^*(a|s)-\\pi^*(a|s)\\frac{\\partial\\log Z_{\\lambda,\\nu}(s) }{\\partial \\nu}\n    \\end{aligned}')
('9', 'L(\\pi^*,\\lambda,\\nu)')
('9', '\\label{eq:exp_grad}\n    \\begin{aligned}\n        &\\frac{\\partial}{\\partial\\nu}\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[\\log Z_{\\lambda,\\nu}(s)] \\\\\n        =& \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi_{\\theta_k}}}\\left[\\frac{\\partial}{\\partial\\nu}\\left(\\frac{\\pi^*(a|s)}{\\pi_{\\theta_k}(a|s)}\\log Z_{\\lambda,\\nu}(s)\\right)\\right] \\\\\n        =& \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi_{\\theta_k}}}\\left[\\frac{1}{\\pi_{\\theta_k}(a|s)}\\left(\\frac{\\partial\\pi^*(a|s)}{\\partial\\nu}\\log Z_{\\lambda,\\nu}(s)+\\pi^*(a|s)\\frac{\\partial\\log Z_{\\lambda,\\nu}(s) }{\\partial \\nu}\\right)\\right] \\\\\n        =& \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi_{\\theta_k}}}\\left[\\frac{\\pi^*(a|s)}{\\pi_{\\theta_k}(a|s)}\\left(-\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\log Z_{\\lambda,\\nu}(s)-\\frac{\\partial\\log Z_{\\lambda,\\nu}(s)}{\\partial\\nu}\\log Z_{\\lambda,\\nu}(s)+\\frac{\\partial\\log Z_{\\lambda,\\nu}(s)}{\\partial\\nu}\\right)\\right] \\\\\n        =& \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}\\left[-\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\log Z_{\\lambda,\\nu}(s)-\\frac{\\partial\\log Z_{\\lambda,\\nu}(s)}{\\partial\\nu}\\log Z_{\\lambda,\\nu}(s)+\\frac{\\partial\\log Z_{\\lambda,\\nu}(s)}{\\partial\\nu}\\right].\n    \\end{aligned}')
('9', '\\begin{aligned}\n        \\frac{\\partial Z_{\\lambda,\\nu}(s)}{\\partial\\nu} &= \\frac{\\partial}{\\partial\\nu}\\sum_a\\pi_{\\theta_k}(a|s)\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a)\\right)\\right) \\\\\n        &=\\sum_a -\\pi_{\\theta_k}(a|s)\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a)\\right)\\right) \\\\\n        &=\\sum_a -\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\frac{\\pi_{\\theta_k}(a|s)}{Z_{\\lambda,\\nu}(s)}\\exp\\left(\\frac{1}{\\lambda}\\left(A^{\\pi_{\\theta_k}}(s,a)-\\nu A^{\\pi_{\\theta_k}}_{C}(s,a)\\right)\\right)Z_{\\lambda,\\nu}(s)\\\\\n        &= -\\frac{Z_{\\lambda,\\nu}(s)}{\\lambda}\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi^*(\\cdot|s)}\\left[A^{\\pi_{\\theta_k}}_{C}(s,a)\\right].\n    \\end{aligned}')
('9', '\\label{eq:logz_grad}\n    \\frac{\\partial\\log Z_{\\lambda,\\nu}(s)}{\\partial\\nu} = \\frac{\\partial Z_{\\lambda,\\nu}(s)}{\\partial\\nu}\\frac{1}{Z_{\\lambda,\\nu}(s)} = -\\frac{1}{\\lambda}\\mathop{\\mathrm{\\mathbb{E}}}_{a\\sim\\pi^*(\\cdot|s)}\\left[A^{\\pi_{\\theta_k}}_{C}(s,a)\\right].')
('9', '\\label{eq:exp_grad_final}\n    \\begin{aligned}\n        \\frac{\\partial}{\\partial\\nu}\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}[\\log Z_{\\lambda,\\nu}(s)] &= \\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}\\left[-\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\log Z_{\\lambda,\\nu}(s)+\\frac{A^{\\pi_{\\theta_k}}_{C}(s,a)}{\\lambda}\\log Z_{\\lambda,\\nu}(s)-\\frac{1}{\\lambda}A^{\\pi_{\\theta_k}}_{C}(s,a)\\right] \\\\\n        &= -\\frac{1}{\\lambda}\\mathop{\\mathrm{\\mathbb{E}}}_{\\substack{s\\sim d^{\\pi_{\\theta_k}}\\\\ a\\sim\\pi^*}}\\left[A^{\\pi_{\\theta_k}}_{C}(s,a)\\right].\n    \\end{aligned}')
('10.0', 'L(\\theta) = \\min\\left(\\frac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_k}(a|s)}A^{\\pi_{\\theta_k}}(s,a), \\text{clip}\\left(\\frac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_k}(a|s)}, 1-\\epsilon, 1+\\epsilon\\right)A^{\\pi_{\\theta_k}}(s,a) \\right)')
('10.0', '\\label{eq:PPO_L}\n    \\Tilde{L}(\\theta) = L(\\theta) +  \\nu \\left(J_C(\\pi_{\\theta}) -b\\right)')
('10.0', '\\theta')
('10.0', '\\nu')
('10.1', '\\begin{aligned}\n\\underset{\\theta}{\\text{maximize}} \\quad\n&  \\Tilde{L}(\\theta) \\label{eq:TRPO_L_obj}  \\\\\n\\text{subject to} \\quad\n& \\bar{D}_\\text{KL}(\\pi_{\\theta}\\parallel \\pi_{\\theta_k})[s]\\leq \\delta. \\label{eq:TRPO_L_const}\n\\end{aligned}')
('10.1', '\\Tilde{L}(\\theta) = \\frac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_k}(a|s)} A^{\\pi_{\\theta_k}}(s,a) + \\nu \\left(J_C(\\pi_{\\theta})-b\\right)')
('10.1', '\\begin{aligned}\n\\underset{\\theta}{\\text{maximize}} \\quad\n&  \\Tilde{g}^T (\\theta-\\theta_k) \\label{eq:TRPO_L_taylor_obj}  \\\\\n\\text{subject to} \\quad\n& \\frac{1}{2}(\\theta-\\theta_k)^T H (\\theta-\\theta_k)\\leq\\delta. \\label{eq:TRPO_L_taylor_const}\n\\end{aligned}')
('10.1', '\\Tilde{g}')
('10.1', '\\theta')
('10.1', '\\nu')
('11', '25\\%')
('11', '50\\%')
('11', '75\\%')
('11', 'x')
('11', 'y')
('11', '25\\%')
('11', '50\\%')
('11', '75\\%')
('11', '95\\%')
('12', 'M')
('12', 'T')
('12', '(s_{i,t}, a_{i,t}, r_{i,t}, s_{i,t+1}, c_{i,t})')
('12', '\\pi_{\\theta}')
('12', 'i=1,\\dots,M')
('12', 't=1,\\dots,T')
('12', 'C')
('12', 'C')
('12', '\\hat{J}_{C} = \\frac{1}{M}\\sum_{i=1}^M\\sum_{t=0}^{T-1} \\gamma^t  c_{i,t}')
('12', "\\theta'\\gets\\theta")
('12', '\\hat{A}_{i,t}')
('12', '\\hat{A}_{i,t}^{C}')
('12', 'i=1,\\dots,M')
('12', 't=1,\\dots,T')
('12', 'V^{\\text{target}}_{i,t}=\\hat{A}_{i,t}+V_{\\phi}(s_{i,t})')
('12', 'V^{C, \\text{target}}_{i,t}=\\hat{A}_{i,t}+V_{\\psi}^C(s_{i,t})')
('12', '\\nu')
('12', '\\nu\\gets\\mathop{\\mathrm{\\text{proj}}}_{\\nu}\\left[\\nu - \\alpha_{\\nu}\\left(b-\\hat{J}_C\\right)\\right]')
('12', '\\begin{aligned}\n            \\mathcal{L}_V(\\phi) &= \\frac{1}{2N}\\sum_{j=1}^B (V_{\\phi}(s_j)-V^{\\text{target}}_j)^2 \\\\\n            \\mathcal{L}_{V^C}(\\psi) &= \\frac{1}{2N}\\sum_{j=1}^B (V_{\\psi}(s_j)-V^{C,\\text{target}}_j)^2\n        \n\\end{aligned}')
('12', '\\begin{aligned}\n            \\phi &\\gets\\phi -\\alpha_V\\nabla_{\\phi}\\mathcal{L}_V(\\phi) \\\\\n            \\psi &\\gets\\psi -\\alpha_V\\nabla_{\\psi}\\mathcal{L}_{V^C}(\\psi) \\\\\n        \n\\end{aligned}')
('12', '\\theta \\gets\\theta -\\alpha_{\\pi}\\hat{\\nabla}_{\\theta} \\mathcal{L}_{\\pi}(\\theta)')
('12', "\\hat{\\nabla}_{\\theta} \\mathcal{L}_{\\pi}(\\theta) \n    \\approx \\frac{1}{B}\\sum_{j=1}^B\\bigg[\\nabla_{\\theta}D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta'}\\right)[s_j] -\\frac{1}{\\lambda}\\frac{\\nabla_{\\theta}\\pi_{\\theta}(a_j|s_j)}{\\pi_{\\theta'}(a_j|s_j)}\\bigg(\\hat{A}_j - \\nu\\hat{A}^{C}_j \\bigg)\\bigg]\\boldsymbol{1}_{D_\\text{KL}\\left(\\pi_{\\theta}\\middle\\| \\pi_{\\theta'}\\right)[s_j]\\leq\\delta}")
('13.0.0', 'C(s,a) = \\sqrt{v_x^2 + v_y^2}')
('13.0.0', 'C(s, a) = |v_x|')
('13.0.0', 'v_x,v_y')
('13.0.0', 'x')
('13.0.0', 'y')
('13.0.1', '\\tanh')
('13.0.1', '\\nu')
('13.0.1', '\\nu_{\\max}')
('13.0.1', '\\{1,2,3,5,10,+\\infty\\}')
('13.0.1', '\\nu_{\\max}')
('13.0.1', '\\tanh')
('13.0.1', '\\tanh')
('13.0.1', '\\tanh')
('13.0.1', '\\tanh')
('13.0.1', '\\tanh')
('13.0.1', '\\gamma')
('13.0.1', '\\gamma_{C}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '3\\times 10^{-4}')
('13.0.1', '\\nu')
('13.0.1', 'L2')
('13.0.1', '3\\times 10^{-3}')
('13.0.1', '3\\times 10^{-3}')
('13.0.1', '3\\times 10^{-3}')
('13.0.1', '3\\times 10^{-3}')
('13.0.1', '3\\times 10^{-3}')
('13.0.1', '\\lambda')
('13.0.1', '\\delta')
('13.0.1', '\\nu')
('13.0.1', '\\nu_{\\max}')
('13.1.0', 'AD')
('13.1.0', 'BC')
('13.1.0', '\\begin{aligned}\n    R(s) &= \\frac{-yv_x+xv_y}{1 + |\\sqrt{x^2+y^2}-r|} \\\\\n    C(s) &= \\boldsymbol{1}(|x|>x_{\\lim}).\n\\end{aligned}')
('13.1.0', 'x,y')
('13.1.0', 'v_x,v_y')
('13.1.0', 'x')
('13.1.0', 'y')
('13.1.0', 'r')
('13.1.0', 'x_{\\lim}')
('13.1.0', 'r=10')
('13.1.0', 'x_{\\lim}')
('13.1.0', '(x,y)')
('13.1.1', '\\lambda=1.0')
('13.1.1', '\\delta=0.04')
('14', '95\\%')
('14', '920.4\\pm 75.9')
('14', '1721.4\\pm 191.2')
('14', '1335.57\\pm 43.17')
('14', '\\boldsymbol{1934.9\\pm 99.5}')
('14', '68.25\\pm 11.05')
('14', '99.20\\pm 2.55')
('14', '80.72\\pm 3.82')
('14', '105.21\\pm 5.91')
('14', '1698.0\\pm 22.5')
('14', '1922.4\\pm 12.9')
('14', '1805.5\\pm 60.0')
('14', '150.21\\pm 4.47')
('14', '179.82\\pm 1.73')
('14', '164.67\\pm 9.43')
('14', '158.39\\pm 6.56')
('14', '2084.9\\pm 39.69')
('14', '2108.8\\pm 24.8')
('14', '\\boldsymbol{2749.9\\pm 47.0}')
('14', '2446.2\\pm 9.0')
('14', '83.43\\pm 0.41')
('14', '82.17\\pm 1.53')
('14', '52.34\\pm 1.95')
('14', '81.26\\pm 0.88')
('14', '582.2\\pm 28.9')
('14', '3819.3\\pm 489.2')
('14', '1814.8\\pm 221.0')
('14', '\\boldsymbol{4867.3\\pm 350.8}')
('14', '18.93\\pm 0.93')
('14', '18.60\\pm 1.27')
('14', '20.30\\pm 1.81')
('14', '21.58\\pm 0.74')
('14', '37.90\\pm 1.05')
('14', '33.48\\pm 0.44')
('14', '33.45\\pm 2.30')
('14', '\\boldsymbol{39.37\\pm 2.04}')
('14', '25.49\\pm 0.57')
('14', '32.81\\pm 2.61')
('14', '22.61\\pm 0.33')
('14', '17.23\\pm 1.64')
('14', '1668.7\\pm 337.1')
('14', '2638.9\\pm 163.3')
('14', '2141.7\\pm 331.9')
('14', '\\boldsymbol{3148.6\\pm 60.5}')
('14', '79.23\\pm 1.24')
('14', '90.96\\pm 0.97')
('14', '40.67\\pm 6.86')
('14', '73.35\\pm 2.67')
('15', '\\lambda')
('15', '\\nu_{\\max}')
('15', 'x')
('15', 'y')
('15', 'x/y')
('15', '\\nu_{\\max}')
('15', '\\nu_{\\max}')
('15', '\\lambda')
('15', '\\lambda')
('15', '\\nu_{\\max}')
('15', '\\nu_{\\max}')
('15', '+\\infty')
('15', '\\nu_{\\max}')
('15', '\\nu_{\\max}')
('15', '+\\infty')
('15', '\\nu_{\\max}')
('15', '\\nu_{\\max}')
('15', '1')
('15', '2')
('15', '3')
('15', '5')
('15', '10')
('15', '+\\infty')
