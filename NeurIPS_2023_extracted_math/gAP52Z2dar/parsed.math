('1', 'Q')
('1', 'Q')
('1', 'Q')
('2', 'Q')
('2', 'Q')
('2', 'Q')
('3.0', "(s,a,r,s')")
('3.0', 'r')
('3.0', 'r_E')
('3.0', 'r_\\theta')
('3.0', '\\pi(a|s)')
('3.0', '\\mathbb{E}_\\pi[\\sum_{t=0}^\\infty \\gamma^t r_\\theta(s,a)]')
('3.0', '\\gamma')
('3.0', '\\sigma^{(1)}')
('3.0', '\\sigma^{(2)}')
('3.0', 'y')
('3.0', 'k')
('3.0', '\\sigma = (s_t, a_t, s_{t+1}, a_{t+1}, \\dots , a_{t+k-1}, s_{t+k} )')
('3.0', 'k')
('3.0', 'y')
('3.0', '\\begin{aligned}\n\\label{eq:bradley_terry}\nP_{r_E}[\\sigma^{(1)} \\succ \\sigma^{(2)}] = \\frac{\\exp \\sum_t r_E(s_t^{(1)}, a_t^{(1)})}{\\exp \\sum_t r_E(s_t^{(1)}, a_t^{(1)}) + \\exp \\sum_t r_E(s_t^{(2)}, a_t^{(2)})},\n\\end{aligned}')
('3.0', 'r_E(s_t, a_t)')
('3.0', 'r_E')
('3.0', 'P')
('3.0', '\\mathcal{D}_p = \\{(\\sigma^{(1)}, \\sigma^{(2)}, y)\\}')
('3.0', 'r_E')
('3.0', 'r_\\theta')
('3.0', '\\mathcal{D}_p')
('3.0', '\\label{eq:pref_loss}\n\\mathcal{L}_p(\\theta) = -\\mathbb{E}_{\\sigma^{(1)}, \\sigma^{(2)},y \\sim \\mathcal{D}_p}\\left[y \\log P_{r_\\theta}\\left[\\sigma^{(1)} \\succ \\sigma^{(2)}\\right] + (1-y) \\log \\left(1-P_{r_\\theta}\\left[\\sigma^{(1)} \\succ \\sigma^{(2)}\\right]\\right)\\right].')
('3.0', '\\mathbb{E}_{\\mathcal{D}_p}[D_{\\text{KL}}(P_{r_E}||P_\\theta)]')
('3.0', 'r_\\theta')
('3.0', 'r_\\theta')
('3.0', '\\pi')
('3.0', '\\mathcal{B}_r^\\pi')
('3.0', 'Q^\\pi')
('3.0', '\\pi')
('3.0', '\\mathcal{B}^\\pi_r')
('3.0', "\\label{eq:bellman}\n    (\\mathcal{B}^\\pi_r Q)(s,a) = r(s,a) + \\gamma \\mathbb{E}_{s' \\sim p(\\cdot|s,a)}[V^\\pi(s')],")
('3.0', 'Q')
('3.0', '\\mathcal{B}^*_r')
('3.0', '\\pi^*')
('3.0', '\\pi^*')
('3.0', 'Q^*')
('3.0', 'r_E')
('3.0', 'r_\\theta')
('3.0', 'Q')
('3.0', '\\pi')
('3.0', 'r')
('3.0', 'Q')
('3.0', 'Q')
('3.1', 'Q')
('3.1', 'r(s, a)')
('3.1', 'Q')
('3.1', 'P_Q')
('3.1', 'Q')
('3.1', 'Q')
('3.1', 'Q')
('3.1', '\\mathcal{B}^\\pi_r')
('3.1', '\\pi')
('3.1', '\\mathcal{B}^\\pi_r Q = Q')
('3.1', 'Q')
('3.1', 'r')
('3.1', '\\pi')
('3.1', 'Q')
('3.1', '\\pi')
('3.1', "\\label{eq:inverse_bellman}\n(\\mathcal{T}^\\pi Q)(s,a) = Q(s,a) - \\gamma \\mathbb{E}_{s'}[V^\\pi(s')].")
('3.1', '\\pi')
('3.1', 'Q')
('3.1', 'Q')
('3.1', '(\\mathcal{T}^\\pi Q)(s,a)')
('3.1', 'r_{Q^\\pi}(s,a)')
('3.1', 'r_{Q^\\pi}')
('3.1', 'Q^\\pi')
('3.1', 'r_{Q^\\pi}')
('3.1', 'Q')
('3.1', 'r')
('3.1', '\\pi')
('3.1', 'Q^\\pi')
('3.1', 'P_{Q^\\pi}[\\sigma^{(1)} \\succ \\sigma^{(2)}]')
('3.1', '\\label{eq:q_preference}\nP_{Q^\\pi}[\\sigma^{(1)} > \\sigma^{(2)}] = \\frac{\\exp \\sum_t  (\\mathcal{T}^\\pi Q)(s_t^{(1)}, a_t^{(1)}) }{\\exp \\sum_t (\\mathcal{T}^\\pi Q)(s_t^{(1)}, a_t^{(1)}) + \\exp \\sum_t (\\mathcal{T}^\\pi Q)(s_t^{(2)}, a_t^{(2)})}.')
('3.1', 'Q^\\pi')
('3.1', 'P_{Q^\\pi}')
('3.1', 'Q')
('3.1', 'r_\\theta')
('3.1', '\\pi')
('3.1', 'Q')
('3.1', 'Q')
('3.1', '\\mathcal{T}^*')
('3.1', 'Q')
('3.1', '\\pi^*')
('3.1', '\\mathcal{B}^*_r')
('3.1', '\\mathcal{T}^*')
('3.1', '\\mathcal{B}^*_r')
('3.1', "(\\mathcal{T}^* Q)(s,a) = Q(s,a) - \\gamma \\mathbb{E}_{s'}[V^{\\text{targ}}(s')] \\text{ where } V^\\text{targ}(s) \\text{ is estimated as in } \\mathcal{B}^*_r.")
('3.1', '\\mathcal{B}^*_r')
('3.1', 'Q^\\pi')
('3.1', "\\pi'")
('3.1', "Q^{\\pi'} \\geq Q^\\pi")
('3.1', 'Q^*')
('3.1', 'V^\\text{targ}(s) = \\mathbb{E}_{a \\sim \\pi(\\cdot|s)}[Q(s,a)]')
('3.1', '\\mathcal{T}^*')
('3.1', '\\mathcal{B}^*_r')
('3.1', 'Q')
('3.1', '\\mathcal{L}_p(Q) = -\\mathbb{E}_{\\sigma^{(1)}, \\sigma^{(2)},y \\sim \\mathcal{D}_p}\\left[y \\log P_{Q^*}[\\sigma^{(1)} \\succ \\sigma^{(2)}] + (1-y) \\log (1-P_{Q^*}[\\sigma^{(1)} > \\sigma^{(2)})\\right].')
('3.1', 'P_{Q^*}')
('3.1', '\\mathcal{T}^*Q')
('3.1', 'Q')
('3.1', 'Q')
('3.1', 'Q^*')
('3.1', 'Q^*')
('3.1', '\\psi(\\cdot)')
('3.1', 'r_{Q^\\pi} = \\mathcal{T^\\pi}Q')
('3.1', '\\label{eq:ipl}\n\\resizebox{.942\\textwidth}{!}{\n$\\mathcal{L}_p(Q) = -\\mathbb{E}_{\\sigma^{(1)}, \\sigma^{(2)},y \\sim \\mathcal{D}_p}\\left[y \\log P_{Q^*}[\\sigma^{(1)} \\succ \\sigma^{(2)}] + (1-y) \\log (1-P_{Q^*}[\\sigma^{(1)} > \\sigma^{(2)})\\right] + \\lambda \\psi\\left( \\mathcal{T}^*Q \\right)$\n}')
('3.1', '\\psi')
('3.1', '\\lambda > 0')
('3.1', 'Q')
('3.1', '\\mathcal{L}_p(Q)')
('3.1', 'V^{\\text{targ}}')
('3.1', '\\pi^*_r')
('3.1', 'r')
('3.1', '\\psi')
('3.1', '\\pi^*_{r^*}')
('3.1', 'r^* = \\arg \\min_r \\mathbb{E}_{\\mathcal{D}_p}[D_{\\text{KL}}(P_{r_E}||P_\\theta)] + \\lambda \\psi(r)')
('3.1', '\\pi')
('3.1', '\\mathcal{L}_p(Q)')
('3.1', 'r^*')
('3.1', 'V^\\text{targ}')
('3.1', '\\mathcal{L}_p(Q)')
('3.1', 'r^*')
('3.1', 'r^*')
('3.1', 'Q')
('3.1', '\\psi(r) =r^2')
('3.1', '\\mathcal{L}_p(Q)')
('3.1', 'r_\\theta')
('3.1', '\\lambda')
('3.2', '\\pi(a|s)')
('3.2', '\\max_\\pi \\mathbb{E}_{\\mathcal{D}_p \\cup \\mathcal{D}_o}[e^{(Q(s,a) - V(s))/\\alpha} \\log \\pi(a|s)]')
('3.2', "\\mathcal{D}_o = \\{(s,a,s')\\}")
('3.2', '\\mu(a|s)')
('3.2', '\\mathcal{D}_p')
('3.2', '\\mu(a|s)')
('3.2', '\\pi')
('3.2', '\\mathcal{X}')
('3.2', '\\mathcal{X}')
('3.2', "\\max_\\pi \\mathbb{E}_\\pi \\left[\\sum_{t=t'}^\\infty \\gamma^t \\left( r(s_t, a_t) - \\alpha \\log \\frac{\\pi(a_t|s_t)}{\\mu(a_t|s_t)}\\right)\\right]")
('3.2', '\\alpha')
('3.2', '\\mathcal{X}')
('3.2', 'Q')
('3.2', "(\\mathcal{B}^*_r Q)(s,a) = r(s,a) + \\gamma \\mathbb{E}_{s'}[V^{\\text{targ}}(s')],\\text{ where } V^\\text{targ}(s) = \\alpha \\log \\mathbb{E}_{a \\sim \\mu(\\cdot | s)}\\left[e^{Q(s, a) / \\alpha}\\right].")
('3.2', 'V^\\text{targ}')
('3.2', 'Q')
('3.2', 'Q')
('3.2', '\\mathcal{X}')
('3.2', '\\mathcal{L}_p(Q)')
('3.2', 'V')
('3.2', 'Q^*')
('3.2', 'V^*')
('3.2', '\\mathcal{D}_p')
('3.2', '\\mathcal{L}_p(Q)')
('3.2', '\\mathcal{D}_p')
('3.2', '\\mathcal{D}_p \\cup \\mathcal{D}_o')
('3.2', '\\psi(r) = \\mathbb{E}_{\\mathcal{D}_p \\cup \\mathcal{D}_o}[r(s,a)^2]')
('3.2', '\\mathcal{T}^*Q')
('3.2', 'Q')
('3.2', '\\mathcal{D}_p')
('3.2', '\\mathcal{D}_o')
('3.2', 'Q')
('3.2', 'V')
('3.2', '\\pi^*(a|s) \\propto \\mu(a|s) \\exp{\\left((Q^*(s,a) - V^*(s)) / \\alpha \\right)}')
('3.2', '\\mathcal{X}')
('3.2', '\\mathcal{X}')
('4.0', '\\min_V \\mathbb{E}_{B_p \\cup B_o}\\left[\\left|\\tau - \\vmathbb{1}(Q(s,a)-V(s) < 0)\\right| \\left(Q(s,a) - V(s)\\right)^2\\right]')
('4.0', '\\tau')
('4.0', '\\sigma')
('4.0', '\\mathcal{D}_p')
('4.0', '\\mathcal{D}_o')
('4.1', 'r_\\theta')
('4.1', 'r_\\theta')
('4.1', 'Q')
('4.1', 'Q')
('4.1', 'Q')
('4.1', '\\mathcal{X}')
('4.1', '\\mathcal{X}')
('4.1', '\\lambda = 0')
('4.1', '\\mathcal{X}')
('4.1', '\\lambda = 0')
('4.2', '\\mathcal{D}_p')
('4.2', "\\mathcal{D}_o = \\{(s,a,s') \\in \\mathcal{D}_p\\}")
('4.3', '\\lambda')
('4.3', '\\lambda')
('4.3', '\\lambda')
('5', 'Q')
('5', 'Q')
('5', 'Q^*')
('7.0', '\\pi')
('7.0', '\\mathcal{T}^\\pi')
('7.0', 'r')
('7.0', 'Q')
('7.0', 'r')
('7.0', 'Q = (\\mathcal{T}^\\pi)^{-1}r')
('7.0', '\\mathcal{B}_r^\\pi')
('7.0', 'P^\\pi')
('7.0', '\\pi')
('7.0', 'r = \\mathcal{T}^\\pi Q = (I - \\gamma P^\\pi) Q')
('7.0', 'Q')
('7.0', 'r')
('7.0', '(I - \\gamma P^\\pi)')
('7.0', 'P^\\pi')
('7.0', '\\gamma < 1')
('7.0', '||\\gamma P^\\pi|| < 1')
('7.0', '(I - \\gamma P^\\pi)^{-1}')
('7.0', 'Q = (I - \\gamma P^\\pi)^{-1} r')
('7.0', 'r')
('7.0', 'Q = (I - \\gamma P^\\pi)^{-1} r = (\\mathcal{T}^\\pi)^{-1}r = \\mathcal{B}^\\pi_r Q')
('7.0', '\\mathcal{B}^\\pi_r')
('7.0', '\\pi^*_r')
('7.0', 'r')
('7.0', '\\psi')
('7.0', '\\pi^*_{r^*}')
('7.0', 'r^* = \\arg \\min_r \\mathbb{E}_{\\mathcal{D}_p}[D_{\\text{KL}}(P_{r_E}||P_\\theta)] + \\lambda \\psi(r)')
('7.0', 'Q_t \\in \\mathbb{R}^{|S \\times A|}')
('7.0', '\\pi_t')
('7.0', 't')
('7.0', 'Q_0 = 1/(1 - \\gamma) \\min_{S \\times A} r(s,a)')
('7.0', 'r = (I - \\gamma P^\\pi)Q')
('7.0', 'P^\\pi')
('7.0', 'r^* = \\arg \\min_r \\mathbb{E}_{D_p}[y \\log P_r + (1-y) \\log (1 - P_r)]  + \\lambda \\psi(r)')
('7.0', '\\psi')
('7.0', 'r^*')
('7.0', '(I - \\gamma P^{\\pi_t})Q_t = r^*')
('7.0', '\\mathcal{B}^*_r')
('7.0', '\\mathcal{T}^*Q = r^*')
('7.0', 'Q = (\\mathcal{T}^*)^{-1}r^*')
('7.0', '\\mathcal{B}^*_{r^*}')
('7.0', 'Q^*_{r^*}')
('7.0', 'Q')
('7.0', 'r^*')
('7.0', '\\pi^*_{r^*}')
('7.0', '\\pi_t')
('7.0', 'Q_t')
('7.0', '\\pi_{t+1}')
('7.0', '\\pi_{t+1}')
('7.0', 'P^{\\pi_{t+1}}')
('7.0', 'P^{\\pi_{t+1}}')
('7.0', 'Q_{t+1}')
('7.0', '(I - \\gamma P^{\\pi_{t+1}})Q_{t+1} = r^*')
('7.0', 'r^*')
('7.0', 'Q_t')
('7.0', 'Q_{t+1}')
('7.0', 'r^*')
('7.0', 'Q^{\\pi_{t+1}} \\geq Q^{\\pi_{t}}')
('7.0', 'Q_{t+1} \\geq Q_{t}')
('7.0', 't')
('7.0', 'Q^* = (\\mathcal{T}^*)^{-1} r')
('7.0', '\\mathcal{B}^*_r')
('7.0', '\\phi(r) = r^2')
('7.0', 'r^* = \\arg \\min_r \\mathbb{E}_{\\mathcal{D}_p}[D_{\\text{KL}}(P_{r_E}||P_\\theta)] + \\lambda \\psi(r)')
('7.0', 'x')
('7.0', '-\\gamma^t, \\gamma^t')
('7.0', 'r')
('7.0', 'X^T D X + \\lambda I \\quad \\text{ where } D_{ii} = \\textrm{logistic}(x_i \\top r) (1 - \\textrm{logistic}(x_i \\top r))')
('7.0', 'r^*')
('7.0', 'r')
('7.1', '\\mathcal{X}')
('7.1', "V^*(s')")
('7.1', 'Q(s,a) = r(s,a)')
('7.1', '\\mathcal{X}')
('7.1', '\\pi^* = \\mu(a|s) e^{Q^*(s,a)}/ Z(s)')
('7.1', 'Z')
('7.1', '\\mathcal{T}^*Q = Q^*(s,a) = \\log \\frac{\\pi(a|s)}{\\mu(a|s)} + Z(s)')
('7.2', '\\tau')
('7.2', 'K')
('7.2', 'P_{r_E}(\\tau) = \\prod_{k=1}^K  \\left(\\exp \\sum_t r_E(s^{\\tau_k}_t, a^{\\tau_k}_t)\\right) / d_k')
('7.2', 'd_k = \\sum_{j=k}^K \\exp \\sum_{t} \\gamma^t r_E(s^{\\tau_j}_t, a^{\\tau_j}_t)')
('7.2', 'P_Q')
('7.2', '\\mathcal{L}_p (Q) = \\mathbb{E}_{\\tau \\sim \\mathcal{D}_p }\\left[ \\log P_Q (\\tau) \\right] + \\lambda \\psi(r)')
('8.0', '\\pi')
('8.0', '\\beta')
('8.0', '\\alpha')
('8.0', 'B_p \\sim \\mathcal{D}_p')
('8.0', '\\sigma')
('8.0', 's')
('8.0', '(\\sigma^{(1)}, \\sigma^{(2)}, y)')
('8.0', '\\textrm{start} \\sim \\textrm{Unif}[0, 1, 2, ... k - s]')
('8.0', '\\sigma = s_{\\textrm{start}}, a_{\\textrm{start}}, ..., s_{\\textrm{start} + s}')
('8.1', 'k = 100')
('8.1', 's = 64')
('8.1', 'k = 50')
('8.1', 's = 32')
('8.1', 'k = 100')
('8.1', 's = 64')
('8.1', 'X')
('8.1', '\\alpha = 2')
('8.1', '\\alpha = 5')
('8.1', 'Q, V, \\pi')
('8.1', 'r_\\theta')
('8.1', 'r_\\theta')
('8.1', 'r_\\theta')
('8.1', '\\beta')
('8.1', 'r_\\theta')
('8.1', '\\tau')
('8.1', '\\mathcal{D}_o')
('8.1', '\\mathcal{D}_p')
('8.1', 'k')
('8.1', 's')
('8.1', '\\lambda')
('8.2', 'y')
('8.2', '\\sum_t r(s_t^{(1)}, a_t^{(1)}) > \\sum_t r(s_t^{(2)}, a_t^{(2)})')
('8.2', 'r')
('8.2', '\\mathcal{D}')
('8.2', 'Q, V, \\pi')
('8.2', 'r_\\theta')
('8.2', 'r_\\theta')
('8.2', 'r_\\theta')
('8.2', '\\beta')
('8.2', 'r_\\theta')
('8.2', '\\tau')
('8.2', '\\mathcal{D}_p')
('8.2', 'k')
('8.2', 's')
('8.2', '\\lambda')
('8.3', '\\lambda')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\pm')
('8.3', '\\lambda')
('8.3', '\\lambda')
('8.3', '\\lambda')
('8.3', '\\lambda = 0.5')
('8.3', 'Q')
