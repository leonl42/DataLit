('3.0', 'x')
('3.0', 'x_0 \\in \\{1,2,...,K, K+1\\}')
('3.0', 'K')
('3.0', 'K+1')
('3.0', '[\\text{\\tt{MASK}}]')
('3.0', 'q(x_t|x_{t-1}) = \\bm{v}^\\top(x_{t})\\bm{Q}_t \\bm{v}(x_{t-1})\n\\label{eqn:markov}')
('3.0', '\\bm{v}(x)')
('3.0', 'x')
('3.0', '\\bm{Q}_t')
('3.0', 'x_{t-1}')
('3.0', 'x_t')
('3.0', 'p_\\theta(\\bm{x}_{t-1}|\\bm{x}_t)')
('3.0', 'p_\\theta(\\tilde{\\bm{x}}_0 | \\bm{x}_t)')
('3.0', '\\!\\!\\!\\! p_\\theta(\\bm{x}_{t-1}|\\bm{x}_t) = \\sum_{\\tilde{\\bm{x}}_0=1}^{K} q(\\bm{x}_{t-1}|\\bm{x}_t,\\tilde{\\bm{x}}_0) p_\\theta(\\tilde{\\bm{x}}_0|\\bm{x}_t),\n    \\label{eqn:vq-p}')
('3.0', '\\mathcal{L}_{t-1}^{dis} = D_{KL}({q(\\bm{x}_{t-1}|\\bm{x}_t,\\bm{x}_0)}\\ ||\\ {p_\\theta(\\bm{x}_{t-1}|\\bm{x}_t)}).\n\\label{eq:dis}')
('3.0.0', '\\bm{x}_0')
('3.0.0', '\\bm{x}_T')
('3.0.0', '\\begin{split}\n% \\begin{align}\nq(\\bm{x}_t|\\bm{x}_{t-1}) & :=\\mathcal{N}(\\bm{x}_t;\\sqrt{1-\\beta _t}\\bm{x}_{t-1},\\beta_{t}\\mathbf{I}),  \\\\\nq(\\bm{x}_{t}|\\bm{x}_{0}) & :=\\mathcal{N}(\\bm{x}_t;\\sqrt{\\overline{\\alpha}_t}\\bm{x}_{0},(1-\\overline{\\alpha}_t)\\mathbf{I}),\n% \\end{align}\n\\label{eq-forward}\n\\end{split}')
('3.0.0', '\\beta_{1},\\ldots,\\beta_{T}')
('3.0.0', '\\alpha _{t}:=1-\\beta _{t}')
('3.0.0', '\\overline{\\alpha}_{t}:=\\prod_{s=1}^t \\alpha _{s}')
('3.0.0', '\\mathcal{N}(0, \\mathbf{I})')
('3.0.0', 'p_\\theta(\\bm{x}_{t-1}|\\bm{x}_t)')
('3.0.0', 'p_{\\theta}(\\bm{x}_{t-1}|\\bm{x}_t) := \\mathcal{N}(\\bm{x}_{t-1}; \\mu_{\\theta}(\\bm{x}_t), \\Sigma_{\\theta}(\\bm{x}_t)), \n\\label{eqn:ldm-p}')
('3.0.0', '\\Sigma_{\\theta}')
('3.0.0', '\\sigma^2_t\\bm{I}')
('3.0.0', '\\mathcal{L}_{t-1}^{con} = \\mathop{\\mathbb{E}}_{q(\\bm{x}_{t} \\mid \\bm{x}_{t-1})}\\left[ \\frac{1}{2\\sigma^2_t}|| \\mu_\\theta(\\bm{x}_{t}, t) - \\hat{\\mu}(\\bm{x}_{t}, \\bm{x}_{0}) ||^2\\right] + C,\n\\label{eq:con}')
('3.0.0', 'C')
('3.0.0', '\\theta')
('3.0.0', '\\hat{\\mu}(\\bm{x}_{t}, \\bm{x}_{0})')
('3.0.0', 'q(\\bm{x}_{t-1} | \\bm{x}_{0},\\bm{x}_{t})')
('3.0.0', '\\mu_\\theta(\\bm{x}_{t}, t)')
('3.0.0', 'p_\\theta(\\bm{x}_{t-1} \\mid \\bm{x}_{t})')
('4.0', '\\bm{x}^i_{t-1}\\in \\mathbb{R}^d')
('4.0', 'i')
('4.0', 'i')
('4.0', 'i')
('4.0', '\\mathcal{N}^s_i')
('4.0', 's')
('4.0', '\\bm{x}^i_{t-1}')
('4.0', 'K')
('4.0', '\\mathcal{N}^s_i')
('4.0', 'K=8')
('4.0', 'K=24')
('4.0', 'S')
('4.0', 'p_\\theta(\\bm{x}^i_{t-1}|\\bm{x}_t)')
('4.0', '\\bm{x}^i_{t-1}')
('4.0', 's')
('4.0', '\\bm{H}_{\\mathcal{N}^s_i}')
('4.0', '\\bm{x}^i_{t-1}')
('4.0', 'p_\\theta(\\bm{x}^i_{t-1}, \\bm{H}_{\\mathcal{N}^s_i}|\\bm{x}_t),')
('4.0', 'p_\\theta')
('4.0', '\\psi_p')
('4.0', '\\psi_n')
('4.0', '\\psi_p')
('4.0', '\\bm{x}^i_{t-1}')
('4.0', '\\bm{x}_t')
('4.0', '\\psi_n')
('4.0', '\\bm{H}_{\\mathcal{N}^s_i}')
('4.0', '\\bm{x}^i_{t-1}')
('4.0', 'i')
('4.0', '\\bm{x}_t')
('4.0', '\\bm{x}^i_{t-1} = \\psi_p(\\bm{x}_t,t),\n    \\label{eq:recons-h}')
('4.0', 't')
('4.0', '\\psi_p')
('4.0', '\\bm{H}_{\\mathcal{N}^s_i}')
('4.0', '\\bm{x}^i_{t-1}')
('4.0', '\\bm{H}_{\\mathcal{N}^s_i} = \\psi_n(\\bm{x}^i_{t-1},t)=\\psi_n(\\psi_p(\\bm{x}_t,t)),\n    \\label{eq:recons-H}')
('4.0', '\\psi_n \\in \\mathbb{R}^{Kd}')
('4.0', '\\begin{aligned}\n\\begin{split}\n    \\mathcal{L}_{\\textsc{ConPreDiff}} =\\sum_{i=1}^{x\\times y}\\left[\\underbrace{\\mathcal{M}_p(\\bm{x}^i_{t-1}, \\bm{\\hat{x}}^i)}_{point\\ denoising}\n    +\\underbrace{\\mathcal{M}_n(\\bm{H}_{\\mathcal{N}^s_i}, \\bm{\\hat{H}}_{\\mathcal{N}^s_i})}_{context\\ prediction}\\right],\n    \\label{eq:recon-obj}\n\\end{split}\n\\end{aligned}')
('4.0', 'x,y')
('4.0', '\\bm{\\hat{x}}^i')
('4.0', '\\bm{\\hat{x}}_0^i')
('4.0', '\\bm{\\hat{H}}_{\\mathcal{N}^s_i}')
('4.0', '\\mathcal{M}_p')
('4.0', '\\mathcal{M}_n')
('4.0.0', '\\mathcal{M}_p,\\mathcal{M}_n')
('4.0.0', '\\mathcal{M}_n(\\bm{H}_{\\mathcal{N}^s_i}, \\bm{\\hat{H}}_{\\mathcal{N}^s_i})=\\sum_{j\\in \\mathcal{N}_i}(\\bm{x}_0^{i,j}-\\hat{\\bm{x}}_0^{i,j})^2,')
('4.0.0', '\\hat{\\bm{x}}_0^{i,j}')
('4.0.0', '\\hat{\\bm{x}}_0^i')
('4.0.0', '\\bm{x}_0^{i,j}')
('4.0.0', '\\bm{x}_0^{i,j}')
('4.0.0', '\\begin{aligned}\n  \\bm{x}_0^{i,j} = \\psi_n(\\psi_p(\\bm{x}_t,t)(i))(j).\n\\end{aligned}')
('4.0.0', '\\Psi(x_t,t)(i,j) = \\left\\{\\begin{aligned}&\\psi_n(\\psi_p({\\bm{x}_t},t)(i))(j),\\quad j \\in \\mathcal{N}_i,\\\\&\\psi_p({\\bm{x}_t},t)(i), \\quad j=i.\\end{aligned}\\right.')
('4.0.0', '\\bm{x}_{0}(\\bm{x}_t,t)')
('4.0.0', 'i')
('4.0.0', '\\begin{aligned}\n  \\bm{x}_0(\\bm{x}_t,t)(i) = 1/(|\\mathcal{N}_i|+1)*\\sum_{j \\in \\mathcal{N}_i\\cup\\{i\\}}\\Psi(\\bm{x}_t,t)(i,j).\n\\end{aligned}')
('4.0.0', '\\begin{aligned}||\\hat{\\bm{x}}_0-\\bm{x}_0(\\bm{x}_t,t)||_2^2 &= \\sum_i (\\hat{\\bm{x}}_0^i-\\bm{x}_0(\\bm{x}_t,t)(i))^2,\\\\&=\\sum_i (\\hat{\\bm{x}}_0^i-\\sum_{j \\in \\mathcal{N}_i\\cup\\{i\\}}\\Psi(\\bm{x}_t,t)(i,j)/(|\\mathcal{N}_i|+1))^2,\\\\&=\\sum_i(\\sum_{j \\in \\mathcal{N}_i\\cup\\{i\\}}(\\Psi(\\bm{x}_t,t)(i,j)-\\hat{\\bm{x}}_0^i))^2/(|\\mathcal{N}_i|+1)^2,\\\\(\\text{Cauchy\\ Inequality}) &\\leq \\sum_i \\sum_{j \\in \\mathcal{N}_i\\cup\\{i\\}} (\\Psi(\\bm{x}_t,t)(i,j)-\\hat{\\bm{x}}_0^i)^2/(|\\mathcal{N}_i|+1),\\\\&=1/(|\\mathcal{N}_i|+1)\\sum_i [(\\hat{\\bm{x}}_0^i- \\psi_p(\\bm{x}_t,t)(i))^2+\\sum_{j \\in \\mathcal{N}_i} (\\hat{\\bm{x}}_0^{i,j}-\\bm{x}_0^{i,j})^2]\\end{aligned}')
('4.0.0', 'i')
('4.0.0', '|\\mathcal{N}|')
('4.0.0.0', '\\psi_n : \\mathbb{R}^{d}\\rightarrow \\mathbb{R}^{Kd}')
('4.0.0.0', 'K')
('4.0.0.0', '\\bm{x}^i_{t-1}')
('4.0.0.0', 'Q')
('4.0.0.0', '\\mathcal{P}_{\\mathcal{N}^s_i}')
('4.0.0.0', '\\mathcal{P}_{\\mathcal{N}^s_i}\\triangleq \\frac{1}{K}\\sum_{u\\in \\mathcal{N}^s_i} \\delta_{h_u}')
('4.0.0.0', '\\mathcal{M}_n')
('4.0.0.0', '\\begin{aligned}\n\\begin{split}\n    \\mathcal{L}_{\\textsc{ConPreDiff}}=\\sum_{i=1}^{x\\times y}\\left[\\underbrace{\\mathcal{M}_p(\\bm{x}^i_{t-1}, \\bm{\\hat{x}}^i)}_{point\\ denoising}+\\underbrace{\\mathcal{W}_2^2(\\psi_n(\\bm{x}^i_{t-1},t), \\mathcal{P}_{\\mathcal{N}^s_i})}_{neighborhood\\ distribution\\ prediction}\\right],\n    \\label{eq:recon-obj2}\n\\end{split}\n\\end{aligned}')
('4.0.0.0', '\\psi_n(\\bm{x}^i_{t-1},t)')
('4.0.0.0', '\\mathcal{W}_2(\\cdot,\\cdot)')
('4.0.0.0', '\\mathcal{W}_2^2(\\psi_n(\\bm{x}^i_{t-1},t), \\mathcal{P}_{\\mathcal{N}^s_i})')
('4.1', '\\bm{\\hat{H}}_{\\mathcal{N}^s_i}')
('4.1', '\\mathcal{P}_{\\mathcal{N}^s_i}')
('4.1', '\\mathcal{P}_{\\mathcal{N}^s_i}')
('4.1', 'f')
('4.1', '\\psi_n(\\bm{x}^i_{t-1},t)')
('4.1', '\\bm{x}^i_{t-1}')
('4.1', 't')
('4.1', 'd')
('4.1', '\\begin{aligned}\n\\begin{split}\n    &\\psi_n(\\bm{x}^i_{t-1},t) = \\text{FNN}_n(\\xi), \\,\\xi \\sim \\mathcal{N}(\\mu_i, \\Sigma_i),\\\\  \\mu_i& = \\text{FNN}_\\mu(\\bm{x}^i_{t-1}), \\Sigma_i = \\text{diag}(\\exp(\\text{FNN}_\\sigma(\\bm{x}^i_{t-1}))).\n\\end{split}\n\\end{aligned}')
('4.1', '\\epsilon>0')
('4.1', '\\mathcal{P}_v^{(i)}')
('4.1', '\\mathbb{R}^d')
('4.1', 'u(\\cdot):\\mathbb{R}^d\\rightarrow \\mathbb{R}')
('4.1', '\\nabla u(\\cdot):\\mathbb{R}^d\\rightarrow \\mathbb{R}^d')
('4.1', '\\epsilon')
('4.1', '\\mathcal{W}_2^2(\\mathcal{P}_v^{(i)}, \\nabla u(\\mathcal{G}))<\\epsilon')
('4.1', '\\nabla u(\\mathcal{G})')
('4.1', '\\nabla u(\n\\xi)')
('4.1', '\\xi\\sim')
('4.1', 'd')
('4.1', '\\psi_n(\\bm{x}^i_{t-1},t)')
('4.1', '\\mathcal{P}_{\\mathcal{N}^s_i}')
('4.1', 'q')
('4.1', '\\{\\bm{x}^{tar}_{(i,j)}|1\\leq j\\leq q\\}')
('4.1', '\\mathcal{P}_{\\mathcal{N}^s_i}')
('4.1', 'q')
('4.1', '\\mathcal{N}(\\mu_i, \\Sigma_i)')
('4.1', '\\xi_1,\\xi_2,...,\\xi_q')
('4.1', '\\{\\bm{x}^{pred}_{(i,j)} = \\text{FNN}_n(\\xi_j)|1\\leq j\\leq q\\}')
('4.1', 'q')
('4.1', '\\psi_n(\\bm{x}^i_{t-1},t)')
('4.1', '\\mathcal{W}_2^2(\\psi_n(\\bm{x}^i_{t-1},t), \\mathcal{P}_{\\mathcal{N}^s_i})')
('4.1', '\\begin{aligned}\n\\begin{split}\n\\label{eq:emp-W-dis}\n     \\min_{\\pi} \\sum_{j=1}^q\\|\\bm{x}^{tar}_{(i,j)}-\\bm{x}^{pred}_{(i,\\pi(j))}\\|^2,\\quad \\text{s.t.}\\;\\pi\\;\\text{is a bijective mapping:} [q]\\rightarrow [q].\n\\end{split}\n\\end{aligned}')
('4.1', 'O(q^3)')
('4.1', 'O(q^2)')
('4.1', 'q')
('4.2', '\\bm{x}_{t}')
('4.2', '\\bm{x}_{t-1}')
('4.2', '\\mathcal{P}_{\\mathcal{N}^s_i}')
('4.2', '\\bm{x}^i_{t-1}')
('4.2', '\\mathcal{L}^{dis}_{t-1}')
('4.2', '\\mathcal{L}^{con}_{t-1}')
('4.2', '\\begin{split}\n    \\mathcal{L}^{dis}_{\\textsc{ConPreDiff}}&=\\mathcal{L}^{dis}_{t-1}+\\lambda_t\\cdot\\sum_{i=1}^{x\\times y}\\mathcal{W}_2^2(\\psi_n(\\bm{x}^i_{t-1},t), \\mathcal{P}_{\\mathcal{N}^s_i}),\\\\\n    \\mathcal{L}^{con}_{\\textsc{ConPreDiff}}&=\\mathcal{L}^{con}_{t-1}+\\lambda_t\\cdot\\sum_{i=1}^{x\\times y}\\mathcal{W}_2^2(\\psi_n(\\bm{x}^i_{t-1},t), \\mathcal{P}_{\\mathcal{N}^s_i}),\n    \\end{split}')
('4.2', '\\lambda_t\\in [0,1]')
('4.2', '\\psi_p')
('5', '\\textbf{\\textsc{ConPreDiff}}_{dis}')
('5', '\\textbf{\\textsc{ConPreDiff}}_{con}')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.0', '\\downarrow')
('5.0.0.1', '{\\textsc{ConPreDiff}}_{con}')
('5.0.0.1', '\\times')
('5.0.0.1', '\\times')
('5.0.0.1', '\\times')
('5.0.0.1', '\\times')
('5.0.0.1', '\\times')
('5.0.0.1', '{\\textsc{ConPreDiff}}_{dis}')
('8.1', '256\\times 256')
('8.1', '\\downarrow')
('8.1', '\\uparrow')
('8.1', '\\uparrow')
('8.1', '256\\times 256')
('8.1', '\\downarrow')
('8.1', '\\uparrow')
('8.1', '\\uparrow')
('8.1', '256\\times 256')
('8.1', '\\downarrow')
('8.1', '\\uparrow')
('8.1', '\\uparrow')
('8.1', '256\\times 256')
('8.1', '\\downarrow')
('8.1', '\\uparrow')
('8.1', '\\uparrow')
