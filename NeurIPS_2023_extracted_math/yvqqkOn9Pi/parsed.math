('0', 'r_3')
('0', 'a_1')
('0', 'a_2')
('0', 'a_3')
('0', 's_2')
('0', 'w(s_2, a_1, r_3)')
('0', '\\pi(a\\mid s_2)')
('0.0.0', '(\\mathcal{S}, \\mathcal{A}, p, p_r)')
('0.0.0', '\\mathcal{S}')
('0.0.0', '\\mathcal{A}')
('0.0.0', 'p(S_{t+1} \\mid S_t, A_t)')
('0.0.0', 'p_r(R \\mid S, A)')
('0.0.0', 'r')
('0.0.0', '\\pi(A\\mid S)')
('0.0.0', '\\theta')
('0.0.0', 'A')
('0.0.0', 'S')
('0.0.0', 's_{\\infty}')
('0.0.0', '\\lim_{t \\rightarrow \\infty} p(S_t=s_{\\infty})=1')
('0.0.0', '\\mathcal{T}(s,\\pi)')
('0.0.0', '\\mathcal{T}(s,a,\\pi)')
('0.0.0', 'T = (S_t, A_t, R_t)_{t \\geq 0}')
('0.0.0', 'S_0=s')
('0.0.0', '(S_0, A_0)=(s,a)')
('0.0.0', 'Z_t = \\sum_{t=0}^{\\infty} R_t')
('0.0.0', 'V^\\pi(s) = \\mathbb{E}_{T\\sim \\mathcal{T}(s, \\pi)}\\left[Z_t\\right]')
('0.0.0', 'Q^\\pi(s,a) = \\mathbb{E}_{T\\sim \\mathcal{T}(s,a, \\pi)}\\left[Z_t\\right]')
('0.0.0', 's')
('0.0.0', 's')
('0.0.0', 'a')
('0.0.0', 'V^\\pi(s_0)')
('0.0.0', 's_0')
('0.0.0', 'V^\\pi(s_0)')
('0.0.0', '\\nabla_\\theta V(s_0)')
('0.0.0', 'Q')
('0.0.0', '\\begin{aligned}\n\\label{eqn:discounted_pg}\n    \\hat{\\nabla}_\\theta^{\\text{REINFORCE},\\gamma} V^\\pi(s_0) =  \\sum\\nolimits_{t\\geq 0} R_t \\sum\\nolimits_{k \\leq t} \\gamma^{t-k}\\nabla_\\theta \\log \\pi(A_k \\mid S_k), \\quad \\gamma \\in [0,1].\n    \\vspace{-0.3cm}\n\\end{aligned}')
('0.0.0', "\\begin{aligned}\n\\label{eqn:hca_pg}\n    \\hat{\\nabla}_\\theta^{\\mathrm{HCA}} V^\\pi &= \\sum_{t\\geq 0}  \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t)\\Big(r(S_t,a) +  \\sum_{k \\geq 1} \\frac{p^{\\pi}(A_t=a \\mid S_t=s, S'=S_{t+k})}{\\pi(a\\mid S_t)} R_{t+k} \\Big)\n\\end{aligned}")
('0.0.0', 'r(s,a)')
('0.0.0', "\\frac{p^{\\pi}(a \\mid S_t=s, S'=S_{t+k})}{\\pi(a\\mid S_t)}")
('0.0.0', 'a')
('0.0.0', "S'")
('0.0.0', '\\hat{\\nabla}_{\\theta} V^{\\pi}(s_0)')
('0.0.0', '\\sum_{t\\geq 0}\\nabla_{\\theta}\\log \\pi(A_t \\mid S_t) \\sum_{k\\geq 0} R_{t+k}')
('0.0.0', '\\sum_{t\\geq 0}\\nabla_{\\theta}\\log \\pi(A_t \\mid S_t) \\left(\\sum_{k\\geq 0} R_{t+k} - V(S_t) \\right)')
('0.0.0', '\\sum_{t\\geq 0}\\sum_{a\\in \\mathcal{A}} \\nabla_{\\theta}\\pi(a \\mid S_t) Q(S_t, a)')
('0.0.0', '\\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t)\\Big(1 - \\frac{\\pi(A_t \\mid S_t)}{p^\\pi(A_t \\mid S_t, Z_t)}\\Big)Z_t')
('0.0.0', '\\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t)\\left( Z_t -Q(A_t, S_t)- \\sum_{t’>t}\\left(Q(S_{t’}, A_{t’}) - V(S_{t’}\\right) \\right) + \\hdots')
('0.0.0', '\\quad \\quad  \\hdots \\sum_{a \\in \\mathcal{A}}\\nabla_\\theta \\pi(a \\mid S_t) Q(S_t, a)')
('0.0.0', '\\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} w(S_t,a, U_{t+k}) R_{t+k}')
('0.0.0', '\\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} w(S_t,a, S_{t+k}) R_{t+k}')
('0.0.1.0', 'a')
('0.0.1.0', "a'")
('0.0.1.0', "U'\\sim p(U' \\mid s',a',r')")
('0.0.1.0', 'a')
('0.0.1.0', 'a')
('0.0.1.0', 'a')
('0.0.1.0', 's')
('0.0.1.0', "u'")
('0.0.1.0', "\\begin{aligned}\n\\label{eqn:contribution_coeff_time_indep}\n    w(s,a,u') &= \\frac{\\sum_{k\\geq 1} p^\\pi(U_{t+k}=u' \\mid S_t=s,A_t=a)}{\\sum_{k\\geq 1} p^\\pi(U_{t+k}=u' \\mid S_t=s)} -1 = \\frac{p^\\pi (A_t=a\\mid S_t=s, U'=u')}{\\pi (a \\mid s)} - 1\n\\end{aligned}")
('0.0.1.0', "u'")
('0.0.1.0', 'a')
('0.0.1.0', '\\pi')
('0.0.1.0', "p^\\pi(U_{t+k}=u' \\mid S_t=s) = \\sum_{a'} \\pi(a'\\mid s) p^\\pi(U_{t+k}=u' \\mid S_t=s,A_t=a')")
('0.0.1.0', "w(s,a,u')")
('0.0.1.0', 'a')
('0.0.1.0', "u'")
('0.0.1.0', '\\pi')
('0.0.1.0', "p^\\pi (A_t=a\\mid S_t=s, U'=u')")
('0.0.1.0', 'a')
('0.0.1.0', 's')
('0.0.1.0', "u'")
('0.0.1.0', "u'=s'")
('0.0.1.0', "u'=r'")
('0.0.1.0', "p(u' \\mid s',a')")
('0.0.1.1', '\\begin{aligned}\n\\label{eqn:causal_pg}\n    \\hat{\\nabla}_\\theta^U V^\\pi(s_0) &= \\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} w(S_t,a, U_{t+k}) R_{t+k}.\n    \\vspace{-0.2cm}\n\\end{aligned}')
('0.0.1.1', 'U=S')
('0.0.1.1', 'r(s,a)')
('0.0.1.1', 'U')
('0.0.1.1', 'U')
('0.0.1.1', 'R')
('0.0.1.1', 'k\\geq 0')
('0.0.1.1', 'p^{\\pi}(R_k=r \\mid S_0=s, A_0=a, U_k=u) = p^{\\pi}(R=r \\mid U=u)')
('0.0.1.1', 'k')
('0.0.1.1', 'U')
('0.0.1.1', '\\hat{\\nabla}_\\theta^UV^\\pi(s_0)')
('0.0.1.1', '\\begin{aligned}\n%\\label{eqn:causal_pg}\n    \\nabla_\\theta V^\\pi(s_0) &= \\mathbb{E}_{T\\sim \\mathcal{T}(s_0,\\pi)} \\hat{\\nabla}_\\theta^U V^\\pi(s_0).\n\\end{aligned}')
('0.0.1.2', 'U')
('0.0.1.2', "U'=S'")
('0.0.1.2', "p^{\\pi}(a \\mid s, s') = 1")
('0.0.1.2', 'a')
('0.0.1.2', 'U')
('0.0.1.2', 'R')
('0.0.1.2', "U'")
('0.0.1.2', 'U')
('0.0.1.2', "U'")
('0.0.1.2', "U'")
('0.0.1.2', 'U')
('0.0.1.2', 'U')
('0.0.1.2', 'R')
('0.0.1.2', 'R')
('0.0.1.2', 'U')
('0.0.1.2', 'U')
('0.0.1.2', "U'")
('0.0.1.2', 'S')
('0.0.1.2', "U'")
('0.0.1.2', "U'")
('0.0.1.2', 'U')
('0.0.1.2', 'U')
('0.0.1.2', 'R')
('0.0.1.2', "\\begin{aligned}\n        \\mathbb{V}[\\hat{\\nabla}^R_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^U_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^{U'}_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^S_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^{\\text{REINF}}_\\theta V^\\pi(s_0)] \n    \n\\end{aligned}")
('0.0.1.2', '\\hat{\\nabla}^X_\\theta V^\\pi(s_0)')
('0.0.1.2', 'U=X')
('0.0.1.2', '\\mathbb{V}[Y]')
('0.0.1.2', 'Y')
('0.0.1.2', 'A \\preccurlyeq B')
('0.0.1.2', 'B-A')
('0.0.1.2', 'U')
('0.0.1.2', 'U')
('0.0.1.2', 'u')
('0.0.1.2', 'r')
('0.0.1.2', 'U')
('0.0.1.2', 'u=r')
('0.0.1.2', "O^\\pi(u',s) = \\sum_{k\\geq1} p^{\\pi}(U_k=u' \\mid S_0=s)")
('0.0.1.2', "\\begin{aligned}\n        \\nabla_\\theta O^\\pi(u',s) \\propto \\mathbb{E}_{S''\\sim \\mathcal{T}(\\pi,s)}\\sum\\nolimits_{a \\in \\mathcal{A}}\\nabla_\\theta \\pi(a \\mid S'')  w(S'', a, u') O^\\pi(u',S'')\n    \n\\end{aligned}")
('0.0.1.2', 'a')
('0.0.1.2', 's')
('0.0.1.2', 'r')
('0.0.1.2', 'u')
('0.0.1.2', "\\sum_{a \\in \\mathcal{A}}\\nabla_\\theta \\pi(a \\mid s)  w(s, a, u')r'")
('0.0.1.2', "u'")
('0.0.1.2', 's')
('0.0.1.2', "r'")
('0.0.1.2', "U'=R'")
('0.0.1.2', "r'")
('0.0.1.2', "u' \\neq r'")
('0.0.1.2', "U'=f(R', \\Delta S')")
('0.0.1.2', "\\Delta S'")
('0.0.1.2', "\\Delta S'")
('0.0.1.2', "\\Delta S'")
('0.0.1.2', 'U')
('0.0.1.2', 'u=f(s,a)')
('0.0.1.3', "p^\\pi (A_t=a\\mid S_t=s, U'=u')")
('0.0.1.3', "h(a \\mid s,u')")
('0.0.1.3', 'a_t')
('0.0.1.3', 's_t')
('0.0.1.3', "u'")
('0.0.1.3', 'h')
('0.0.1.3', "p^{\\pi}(a \\mid s, u', l) = p^{\\pi}(a\\mid s, u')")
('0.0.1.3', 'l')
('0.0.1.3', 's')
('0.0.1.3', '\\pi(a \\mid s)')
('0.0.1.3', "p^\\pi (A_t=a\\mid S_t=s, U'=u')/\\pi(a\\mid s)")
('0.0.1.3', "\\sum_{k\\geq 1} p^\\pi(U_{t+k} = u' \\mid s, a)")
('0.0.2', '=\\|\\nabla_\\theta V^\\pi\\|^2 / \\mathbb{E}[\\|\\hat{\\nabla}_\\theta V^\\pi - \\nabla_\\theta V^\\pi\\|^2]')
('0.0.2', 'u')
('0.0.2', 'U')
('0.0.2', 'r(s,a)')
('0.0.2', 'U')
('0.0.2', "h(a \\mid s, u', l)")
('0.0.2', 's')
('0.0.2', 'l')
('0.0.2', "u'")
('0.0.2', 'a')
('0.0.2.2', 'U=R')
('0.0.3', "p^{\\pi}(a \\mid s, u')")
('0.0.3', 'u=r')
('1.0', '\\lambda')
('1.0.0', '\\mathcal{S}')
('1.0.0', 's_{\\infty}')
('1.0.0', 's_{\\infty}')
('1.0.0', '\\sum_{k\\geq o} \\gamma^k R_k')
('1.0.0', '\\gamma \\in [0,1]')
('1.0.0', 'p(S_{t+1} \\mid S_t, A_t)')
('1.0.0', '(1-\\gamma)')
('1.0.0', 'S')
('1.0.1.0', "u'")
('1.0.1.0', "u'")
('1.0.1.0', "u'")
('1.0.1.0', "p(A_t=a \\mid S_t=s, U'=u')")
('1.0.1.0', 'k')
('1.0.1.0', "p(U_k=u' \\mid S=s, A=a)")
('1.0.1.0', 'U_k')
('1.0.1.0', 'k')
('1.0.1.0', "p(U'=u' \\mid S=s, A=a, K=k)")
('1.0.1.0', 'K')
('1.0.1.0', 'p(K=k) = (1-\\beta) \\beta^{k-1}')
('1.0.1.0', '\\beta')
('1.0.1.0', 'K')
('1.0.1.0', "\\begin{aligned}\n    \\sum_{k\\geq 1} p(U_k=u' \\mid S=s, A=a) &= \\lim_{\\beta \\to 1} \\sum_{k\\geq 1} p(U_k=u' \\mid S=s, A=a)\\beta^{k-1}\\\\\n    &= \\lim_{\\beta \\to 1} \\frac{1}{1-\\beta} \\sum_{k\\geq 1} p(U'=u' \\mid S=s, A=a, K=k) p(K=k) \\\\\n    &= \\lim_{\\beta \\to 1} \\frac{1}{1-\\beta} p(U'=u' \\mid S=s, A=a)\n\\end{aligned}")
('1.0.1.0', 'k\\to \\infty')
('1.0.1.0', 's_{\\infty}')
('1.0.1.0', 'u_{\\infty}')
('1.0.1.0', "u'\\neq u_{\\infty}")
('1.0.1.0', "\\begin{aligned}\n    w(s,a,u') &= \\frac{\\sum_{k\\geq 1} p(U_k=u' \\mid S=s, A=a)}{\\sum_{k\\geq 1} p(U_k=u' \\mid S=s)} -1 \\\\\n    &= \\frac{p(U'=u' \\mid S=s, A=a)}{p(U'=u \\mid S=s)} - 1 = \\frac{p(A=a \\mid S=s, U'=u')}{\\pi(a\\mid s)} - 1\n\\end{aligned}")
('1.0.1.0', '\\pi(a\\mid s) > 0')
('1.0.1.0', '\\beta \\to 1')
('1.0.1.0', '\\pi(a\\mid s) = 0')
('1.0.1.0', "p^{\\pi}(a \\mid s, u')")
('1.0.1.0', "p^{\\pi}(U=u' \\mid S=s, A=a)")
('1.0.1.0', '\\pi(a\\mid s) = 0')
('1.0.1.1', 'A^\\pi(s,a) = Q^\\pi(s,a) - V^\\pi(s)')
('1.0.1.1', 'U')
('1.0.1.1', 'R')
('1.0.1.1', 'p^{\\pi}(R_k=r \\mid S_0=s, A_0=a, U_k=u) = p^{\\pi}(R=r \\mid U=u)')
('1.0.1.1', 'k')
('1.0.1.1', '(s,a)')
('1.0.1.1', '\\pi(a\\mid s) > 0')
('1.0.1.1', 'u=f(s,a,r)')
('1.0.1.1', "\\begin{aligned}\n\\label{eqn:advantage}\n        A^\\pi (s,a) &= r(s,a) - \\sum_{a' \\in \\mathcal{A}} \\pi(a \\mid s) r(s,a) + \\mathbb{E}_{T\\sim \\mathcal{T}(s,\\pi)}\\left[ \\sum_{k\\geq 1} w(s,a, U_k)R_k \\right]\n    \n\\end{aligned}")
('1.0.1.1', 'A^\\pi')
('1.0.1.1', 'r(s,a) \\triangleq \\mathbb{E}[R \\mid s,a]')
('1.0.1.1', '\\beta \\to 1_{-}')
('1.0.1.1', "\\begin{aligned}\n    Q(s,a) &= \\lim_{\\beta \\to 1_{-}} \\mathbb{E}_{T\\sim \\mathcal{T}(s,a,\\pi)}\\left[ \\sum_{k\\geq 1}\\beta^k R_k \\right] \\\\\n    &= r(s,a) + \\lim_{\\beta \\to 1_{-}} \\sum_{r \\in \\mathcal{R}} \\sum_{k\\geq 1} \\beta^k p^{\\pi}(R_k=r \\mid s, a) r \\\\\n    &= r(s,a) + \\lim_{\\beta \\to 1_{-}} \\sum_{r \\in \\mathcal{R}}\\sum_{u \\in \\mathcal{U}} \\sum_{k\\geq 1} \\beta^k p^{\\pi}(R_k=r, U_k=u \\mid s, a) r \\\\\n    &= r(s,a) + \\lim_{\\beta \\to 1_{-}} \\sum_{r \\in \\mathcal{R}}\\sum_{u \\in \\mathcal{U}} \\sum_{k\\geq 1} \\beta^k p^{\\pi}(R=r \\mid U=u)  r p^{\\pi}(U_k=u \\mid s, a) \\\\\n    &= r(s,a) + \\lim_{\\beta \\to 1_{-}} \\sum_{u \\in \\mathcal{U}} r(u) \\sum_{k\\geq 1} \\beta^k p^{\\pi}(U_k=u \\mid s, a) \\\\\n    &= r(s,a) + \\lim_{\\beta \\to 1_{-}} \\sum_{u \\in \\mathcal{U}} r(u) \\sum_{k\\geq 1} \\beta^k p^{\\pi}(U_k=u \\mid s) \\frac{\\sum_{k'\\geq 1} \\beta^{k'} p^{\\pi}(U_{k'}=u \\mid s, a)}{\\sum_{k'\\geq 1} \\beta^{k'} p^{\\pi}(U_{k'}=u \\mid s)}\n\\end{aligned}")
('1.0.1.1', 'u')
('1.0.1.1', 'r(s,a) \\triangleq \\mathbb{E}[R \\mid s,a]')
('1.0.1.1', 'r(u) \\triangleq \\mathbb{E}[R \\mid u]')
('1.0.1.1', 'k')
('1.0.1.1', "\\frac{1}{1-\\beta}p^{\\pi}_\\beta(R=r' \\mid s,a) = \\sum_{k=0} \\beta^k p^{\\pi}(R_k=r \\mid s, a)")
('1.0.1.1', "\\begin{aligned}\n    p^{\\pi}(a \\mid s, U'=u) = \\lim_{\\beta \\to 1_{-}} \\frac{p^{\\pi}_\\beta(U'=u \\mid s,a) \\pi(a \\mid s)}{p^{\\pi}_\\beta(U'=u \\mid s)} = \\lim_{\\beta \\to 1_{-}} \\frac{\\sum_{k\\geq 1} \\beta^k p^{\\pi}(U_k=u \\mid s, a)}{\\sum_{k\\geq 1} \\beta^k p^{\\pi}(U_k=u \\mid s)}\\pi(a \\mid s)\n\\end{aligned}")
('1.0.1.1', '\\beta \\to 1_{-}')
('1.0.1.1', 'p^{\\pi}(a \\mid s, R=r)')
('1.0.1.1', "\\begin{aligned}\n    Q^\\pi(s,a) &= r(s,a) + \\sum_{u \\in \\mathcal{U}} \\sum_{k\\geq 1} p^{\\pi}(U_k=u \\mid s) \\frac{p^{\\pi}(a \\mid s, U'=u)}{\\pi(a \\mid s)} r(u)\\\\\n    & = r(s,a) + \\sum_{u \\in \\mathcal{U}} \\sum_{k\\geq 1} p^{\\pi}(U_k=u \\mid s) (w(s,a,u)+1) r(u)\\\\\n    & = r(s,a) + \\sum_{u \\in \\mathcal{U}} \\sum_{k\\geq 1} p^{\\pi}(U_k=u \\mid s) (w(s,a,u)+1) \\sum_{r \\in \\mathcal{R}}p(R_k=r \\mid U_k=u) r\\\\\n    &= r(s,a) + \\mathbb{E}_{T \\sim \\mathcal{T}(s,\\pi)} \\left[ \\sum_{k\\geq 1} (w(s,a, U_k)+1) R_k \\right]\n\\end{aligned}")
('1.0.1.1', "\\begin{aligned}\n    A^\\pi(s,a) &= r(s,a) - \\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s) r(s,a') + \\mathbb{E}_{T \\sim \\mathcal{T}(s,\\pi)} \\left[ \\sum_{k\\geq 1} w(s,a, U_k)R_k \\right]\n\\end{aligned}")
('1.0.1.1', '\\begin{aligned}\n    \\nabla_\\theta V^\\pi(s_0) &= \\mathbb{E}_{T\\sim \\mathcal{T}(s_0,\\pi)} \\left[\\sum_{t\\geq 0}\\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) A^\\pi(S_t,a)\\right] \\\\\n    &=\\mathbb{E}_{T\\sim \\mathcal{T}(s_0,\\pi)} \\left[\\sum_{t\\geq 0} \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\left[ r(S_t,a) + \\sum_{k \\geq 1} w(S_t,a, U_{t+k}) R_{t+k} \\right]\\right] \\\\\n    &=\\mathbb{E}_{T\\sim \\mathcal{T}(s_0,\\pi)} \\left[\\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t)R_t +  \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t)\\sum_{k \\geq 1} w(S_t,a, U_{t+k}) R_{t+k} \\right]\n\\end{aligned}')
('1.0.1.1', "\\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s) r(s,a')")
('1.0.1.1', '\\mathbb{E}_{T\\sim \\mathcal{T}(s_0,\\pi)}[\\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t)r(S_t,a)]')
('1.0.1.1', '\\mathbb{E}_{T\\sim \\mathcal{T}(s_0,\\pi)}[\\nabla_\\theta \\log \\pi(A_t \\mid S_t)R_t]')
('1.0.1.2', 'U')
('1.0.1.2', '\\begin{aligned}\n\\label{eqn_app:pg_reward_model}\n        \\hat{\\nabla}_\\theta V^\\pi &= \\sum_{t\\geq 0}  \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t)\\Big(r(S_t,a) +  \\sum_{k \\geq 1} w(S_t,a,U_{t+k}) R_{t+k} \\Big)\n\\end{aligned}')
('1.0.1.2', 'r(s,a)')
('1.0.1.2', 'R_k')
('1.0.1.2', '\\begin{aligned}\n    \\hat{\\nabla}_\\theta V^\\pi &= \\sum_{t\\geq0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_{t} + \\frac{1}{M} \\sum_m \\nabla_\\theta \\log \\pi(a^m\\mid S_t)\\sum_{k=1}^{\\infty} w(S_{t}, a^m, U_{t+k}) R_{t+k}\n\\end{aligned}')
('1.0.1.2', 'M')
('1.0.1.2', 'a^m \\sim \\pi(\\cdot \\mid S_t)')
('1.0.1.2', 'a^m')
('1.0.1.2', 'R_{t+k}')
('1.0.1.2', 'A_t')
('1.0.1.2', 'a^m')
('1.0.1.2.0', '\\begin{aligned}\n    \\hat{\\nabla}_\\theta^{\\text{REINFORCE},\\gamma} V^\\pi(s_0) =  \\sum\\nolimits_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) \\sum\\nolimits_{k \\geq t} \\gamma^{k-t} R_k\n\\end{aligned}')
('1.0.1.2.0', '\\gamma \\in [0,1]')
('1.0.1.2.0', '\\gamma^t')
('1.0.1.2.0', '\\nabla_\\theta \\log \\pi(A_t \\mid S_t)')
('1.0.1.2.0', '\\begin{aligned}\n    \\hat{\\nabla}_\\theta^{\\text{REINFORCE},\\gamma} V^\\pi(s_0) =  \\sum\\nolimits_{t\\geq 0} R_t \\sum\\nolimits_{k \\leq t} \\gamma^{t-k}\\nabla_\\theta \\log \\pi(A_k \\mid S_k).\n\\end{aligned}')
('1.0.1.2.0', '\\begin{aligned}\n    \\hat{\\nabla}_\\theta^U V^\\pi(s_0) &= \\sum_{t\\geq 0} R_t \\left[\\nabla_\\theta \\log \\pi(A_t \\mid S_t)+ \\sum_{k < t} \\sum_{a\\in \\mathcal{A}}  w(S_k,a, U_{t}) \\nabla_\\theta \\pi(a \\mid S_k)\\right]\n\\end{aligned}')
('1.0.1.3', '\\{A_m\\}_{m=t}^{t+k}')
('1.0.1.3', "s'")
('1.0.1.3', "s'")
('1.0.1.3', "p^{\\pi}(A_t=a \\mid S_t, S'=s') = \\delta(a=a_t)")
('1.0.1.3', '\\delta')
('1.0.1.3', 'a_t')
('1.0.1.3', "s'")
('1.0.1.3', '\\begin{aligned}\n        \\hat{\\nabla}_\\theta^S V^\\pi(s_0) &= \\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} \\left(\\frac{\\delta(a=A_t)}{\\pi(a\\mid S_t)} -1 \\right) R_{t+k} \\\\\n        &= \\sum_{t\\geq 0}\\frac{\\nabla_{\\theta}\\pi(A_t \\mid S_t)}{\\pi(A_t \\mid S_t)} \\sum_{k\\geq 0} R_{t+k}\\\\\n        &= \\sum_{t\\geq 0}\\nabla_{\\theta}\\log \\pi(A_t \\mid S_t) \\sum_{k\\geq 0} R_{t+k}\n    \n\\end{aligned}')
('1.0.1.3', '\\sum_a \\nabla_\\theta \\pi(a \\mid s)= 0')
('1.0.1.4', 't=T')
('1.0.1.4', 't=0')
('1.0.1.4', '\\begin{aligned}\n    \\hat{\\nabla}_{\\theta}^{U}V^\\pi(U_T, R_T) &= \\sum_a \\nabla_\\theta \\pi(a\\mid s) w(s,a,U_T)R_T\\\\\n    \\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi(A_0, R_T) &= \\nabla_\\theta \\log \\pi(A_0\\mid s) R_T\n\\end{aligned}')
('1.0.1.4', 'U')
('1.0.1.4', 'S')
('1.0.1.4', 'R')
('1.0.1.4', 'Z')
('1.0.1.4', 's')
('1.0.1.4', 't=0')
('1.0.1.4', 'U')
('1.0.1.4', 'u')
('1.0.1.4', '\\begin{aligned}\n    w(s,a,u)= \\frac{p^{\\pi}(A_0=a \\mid S_0=s, U_T=u)}{\\pi(a\\mid s)} -1\n\\end{aligned}')
('1.0.1.4', '\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi(A_0, R_T) \\mid S_T, R_T] = \\hat{\\nabla}_{\\theta}^{S}V^\\pi(S_T, R_T)')
('1.0.1.4', "\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{S}V^\\pi(S_T, R_T) \\mid U'_T, R_T] = \\hat{\\nabla}_{\\theta}^{U'}V^\\pi(U'_T, R_T)")
('1.0.1.4', "\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{U'}V^\\pi(U'_T, R_T) \\mid U_T, R_T] = \\hat{\\nabla}_{\\theta}^{U}V^\\pi(U_T, R_T)")
('1.0.1.4', '\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{U}V^\\pi(U_T, R_T) \\mid R_T] = \\hat{\\nabla}_{\\theta}^{R}V^\\pi(R_T)')
('1.0.1.4', 'S_T')
('1.0.1.4', 'R_T')
('1.0.1.4', 'p^{\\pi}(A_0 \\mid S_0=s, S_T, R_T) = p^{\\pi}(A_0 \\mid S_0=s, S_T)')
('1.0.1.4', '\\begin{aligned}\n    &\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi(A_0, R_T) \\mid S_T, R_T] \\\\\n    &= \\sum_{a \\in \\mathcal{A}} p(A_0=a \\mid S_0=s, S_T) \\frac{\\nabla_\\theta \\pi(a\\mid s)}{\\pi(a\\mid s)} R_T = \\hat{\\nabla}_{\\theta}^{S}V^\\pi(S_T, R_T)\n\\end{aligned}')
('1.0.1.4', '\\sum_a \\nabla_\\theta \\pi(a \\mid s)= \\nabla_\\theta \\sum_a \\pi(a \\mid s)= 0')
('1.0.1.4', 'S_T')
('1.0.1.4', "U'_T")
('1.0.1.4', "\\begin{aligned}\n    p(A \\mid S, U'_T) &= \\sum_{s_T \\in \\mathcal{S}} p(S_T=s_T \\mid S, U'_T) p(A\\mid S, S_T=s_T, U'_T)\\\\\n    &= \\sum_{s_T \\in \\mathcal{S}} p(S_T=s_T \\mid S, U'_T) p(A\\mid S, S_T=s_T)\n\\end{aligned}")
('1.0.1.4', "p^{\\pi}(S_T \\mid S_0, U'_T, R_T) = p^{\\pi}(S_T \\mid S_0, U'_T)")
('1.0.1.4', "\\begin{aligned}\n    &\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{S}V^\\pi(S_T, R_T) \\mid U'_T, R_T]\\\\\n    &= \\sum_{a \\in \\mathcal{A}} \\sum_{s_T \\in \\mathcal{S}} p(S_T=s_T \\mid S_0=s, U'_T) p(A_0=a \\mid S=s, S_T=s_T) \\frac{\\nabla_\\theta \\pi(a\\mid s)}{\\pi(a\\mid s)} R_T  \\\\\n    &= \\sum_{a \\in \\mathcal{A}} p(A_0=a \\mid S=s, U'_T) \\frac{\\nabla_\\theta \\pi(a\\mid s)}{\\pi(a\\mid s)} R_T\\\\\n    &= \\hat{\\nabla}_{\\theta}^{U'}V^\\pi(U'_T, R_T)\n\\end{aligned}")
('1.0.1.4', "\\begin{aligned}\n    \\mathbb{E}[\\hat{\\nabla}_{\\theta}^{U'}V^\\pi(U'_T, R_T) \\mid U_T, R_T] &= \\hat{\\nabla}_{\\theta}^{U}V^\\pi(U_T, R_T)\\\\\n    \\mathbb{E}[\\hat{\\nabla}_{\\theta}^{U}V^\\pi(U_T, R_T) \\mid R_T] &= \\hat{\\nabla}_{\\theta}^{R}V^\\pi(R_T)\n\\end{aligned}")
('1.0.1.4', '\\mathbb{V}[X] = \\mathbb{E}[\\mathbb{V}[X\\mid Y]] + \\mathbb{V}[\\mathbb{E}[X\\mid Y]]')
('1.0.1.4', '\\begin{aligned}\n    \\mathbb{V}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi] &= \\mathbb{V}[\\mathbb{E}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi \\mid S_T]] + \\mathbb{E}[\\mathbb{V}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi \\mid S_T]] \\\\\n    &= \\mathbb{V}[\\hat{\\nabla}_{\\theta}^{S}V^\\pi] + \\mathbb{E}[\\mathbb{V}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi \\mid S_T]] \\succcurlyeq \\mathbb{V}[\\hat{\\nabla}_{\\theta}^{S}V^\\pi]\n\\end{aligned}')
('1.0.1.4', '\\mathbb{E}[\\mathbb{V}[\\hat{\\nabla}_{\\theta}^{\\text{REINFORCE}}V^\\pi \\mid S_T]]')
('1.0.1.4', "\\begin{aligned}\n       \\mathbb{V}[\\hat{\\nabla}^R_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^U_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^{U'}_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^S_\\theta V^\\pi(s_0)] \\preccurlyeq \\mathbb{V}[\\hat{\\nabla}^{\\text{REINFORCE}}_\\theta V^\\pi(s_0)] \n\\end{aligned}")
('1.0.1.4', 'U')
('1.0.1.4', 'u')
('1.0.1.4', 'n_g')
('1.0.1.4', 'U=R')
('1.0.1.4', 'U=S')
('1.0.1.4.0', 'U')
('1.0.1.5', 'u')
('1.0.1.5', 's')
('1.0.1.5', 'O^\\pi(u,s) = \\sum_{k\\geq 1} p^{\\pi}(U_k=u \\mid S_0=s)')
('1.0.1.5', 'O^\\pi(u,s,a) = \\sum_{k\\geq 1} p^{\\pi}(U_k=u \\mid S_0=s, A_0=a)')
('1.0.1.5', 'O^\\pi(u,s)')
('1.0.1.5', "\\begin{aligned}\n        \\nabla_\\theta O^\\pi(u,s) &= \\nabla_\\theta \\left[\\sum_{a\\in \\mathcal{A}} \\pi(a \\mid s)\\sum_{s' \\in \\mathcal{S}} p(s' \\mid s,a) \\big( \\delta(s'=s) + O^\\pi(u,s') \\big)\\right] \\\\\n        &= \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid s)O^\\pi(u,s,a) + \\sum_{s' \\in \\mathcal{S}} p(s' \\mid s)\\nabla_\\theta O^\\pi(u,s')\n    \n\\end{aligned}")
('1.0.1.5', '\\phi(u,s) = \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid s)O^\\pi(u,s,a)')
('1.0.1.5', "p^{\\pi}(S_l = s' \\mid S_0=s)")
('1.0.1.5', "s'")
('1.0.1.5', 's')
('1.0.1.5', 'l')
('1.0.1.5', "\\sum_{s'' \\in \\mathcal{S}} p^{\\pi}(S_l = s'' \\mid S_0=s) p^{\\pi}(S_1=s' \\mid S_0=s'') = p^{\\pi}(S_{l+1}=s' \\mid S_0=s)")
('1.0.1.5', "\\begin{aligned}\n        \\nabla_\\theta O^\\pi(u,s) &= \\sum_{s' \\in \\mathcal{S}} \\sum_{l=0}^{\\infty} p^{\\pi}(S_l=s' \\mid S_0=s) \\phi(u,s') \\\\\n        &= \\sum_{s' \\in \\mathcal{S}} \\sum_{l=0}^{\\infty} p^{\\pi}(S_l=s' \\mid S_0=s) \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid s') O^\\pi(u,s',a) \\\\\n        &\\propto \\mathbb{E}_{S \\sim \\mathcal{T}(s,\\pi)} \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S) O^\\pi(u,S,a)\n    \n\\end{aligned}")
('1.0.1.5', "\\sum_{l=0}^{\\infty} p^{\\pi}(S_l=s' \\mid S_0=s)")
('1.0.1.5', "\\sum_{s' \\in \\mathcal{S}} \\sum_{l=0}^{\\infty} p^{\\pi}(S_l=s' \\mid S_0=s)")
('1.0.1.5', 'S \\sim \\mathcal{T}(s,\\pi)')
('1.0.1.5', 'S')
('1.0.1.5', 's')
('1.0.1.5', '\\pi')
('1.0.1.5', '\\begin{aligned}\n        w(s,a,u) = \\frac{O^\\pi(u,s,a)}{O^\\pi(u,s)} -1\n    \n\\end{aligned}')
('1.0.1.5', '\\begin{aligned}\n        \\nabla_\\theta O^\\pi(u,s) &\\propto \\mathbb{E}_{S \\sim \\mathcal{T}(s,\\pi)} \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S)  w(S,a,u)  O^\\pi(u,S)\n    \n\\end{aligned}')
('1.0.1.5', '\\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid s)= 0')
('1.0.2.0', 'l')
('1.0.2.0', 's')
('1.0.2.0', "p^{\\pi}(A_0=a \\mid S_0=s, L_0=l, U'=u') = p^{\\pi}(A_0=a \\mid S_0=s, U'=u')")
('1.0.2.0', 'p(A_0=a \\mid S_0=s, L_0=l) = p(A_0=a \\mid S_0=s) = \\pi(a \\mid s)')
('1.0.2.0', "\\begin{aligned}\n        &p^{\\pi}(A_0=a \\mid S_0=s, L_0=l, U'=u') \\\\\n        &= \\frac{p^{\\pi}(A_0=a, U'=u' \\mid S_0=s, L_0=l)}{p^{\\pi}(U'=u' \\mid S_0=s, L_0=l)} \\\\\n        & = \\frac{p^{\\pi}(U'=u' \\mid S_0=s, A_0=a, L_0=l)  p(A_0=a \\mid S_0=s, L_0=l)}{\\sum_{a' \\in \\mathcal{A}} p^{\\pi}(A_0=a', U'=u' \\mid S_0=s, L_0=l)} \\\\\n        & = \\frac{p^{\\pi}(U'=u' \\mid S_0=s, A_0=a)  p(A_0=a \\mid S_0=s)}{\\sum_{a' \\in \\mathcal{A}} p^{\\pi}(U'=u' \\mid S_0=s, A_0=a',) p(A_0=a'\\mid S_0=s)} \\\\\n        &= \\frac{p^{\\pi}(A_0=a, U'=u' \\mid S_0=s)}{p^{\\pi}(U'=u' \\mid S_0=s)} \\\\\n        &= p^{\\pi}(A_0=a \\mid S_0=s, U'=u')\n    \n\\end{aligned}")
('1.0.2.1', "p^\\pi (A_t=a\\mid S_t=s, U'=u')/\\pi(a\\mid s)")
('1.0.2.1', "D(a,s,u')")
('1.0.2.1', "p^\\pi (A_t=a\\mid S_t=s, R'=r')")
('1.0.2.1', '\\pi(a\\mid s)')
('1.0.2.1', "\\begin{aligned}\n\\label{eqn:contrastive_loss}\n    L =  \\mathbb{E}_{s,u' \\sim \\mathcal{T}(s_0, \\pi)}\\left[\\mathbb{E}_{a \\sim  p^{\\pi}(a \\mid s, u')}\\left[\\log D(a,s,u') \\right] + \\mathbb{E}_{a \\sim \\pi(a \\mid s)}\\left[\\log\\big(1 - D(a,s,u')\\big) \\right] \\right],\n\\end{aligned}")
('1.0.2.1', "D^*(s,a,u')")
('1.0.2.1', "\\begin{aligned}\n        w(s,a,u') = \\frac{D^*(a,s,u')}{1-D^*(a,s,u')} -1.\n    \n\\end{aligned}")
('1.0.2.1', "s,u'")
('1.0.2.1', "D^*(a,s,u')")
('1.0.2.1', "\\mathbb{E}_{a \\sim  p^{\\pi}(a \\mid s, u')}\\left[\\log D(a,s,u') \\right] + \\mathbb{E}_{a \\sim \\pi(a \\mid s)}\\left[\\log\\big(1 - D(a,s,u')\\big) \\right]")
('1.0.2.1', "\\begin{aligned}\n    &p^{\\pi}(a \\mid s, u') \\frac{1}{D^*(a,s,u')} - \\pi(a\\mid s) \\frac{1}{1-D^*(a,s,u')} = 0\\\\\n    \\Rightarrow ~~~~ & \\frac{p^{\\pi}(a \\mid s, u')}{\\pi(a \\mid s)} = \\frac{D^*(a,s,u')}{1-D^*(a,s,u')}\n\\end{aligned}")
('1.0.2.1', '(a,b) \\in \\mathbb{R}^2_{/0}')
('1.0.2.1', 'f(x) = a \\log x + b \\log(1-x)')
('1.0.2.1', 'x \\in [0,1]')
('1.0.2.1', '\\frac{a}{a+b}')
('1.0.2.1', "(s,u')")
('1.0.2.1', 'D')
('1.0.2.1', "a^{(m)}, s^{(m)}, u'^{(m)}")
('1.0.2.1', '\\pi')
('1.0.2.1', "\\begin{aligned}\n    L = \\sum_{m=1}^M \\left[ -\\log D(a^{(m)}, s^{(m)}, u'^{(m)}) - \\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s^{(m)}) \\log\\big(1-D(a', s^{(m)}, u'^{(m)})\\big) \\right]\n\\end{aligned}")
('1.0.2.1.0', 'D')
('1.0.2.1.0', '\\begin{aligned}\n    \\log \\sigma(x) = -\\log(1 + \\exp(-x)) \\\\\n    \\log(1-\\sigma(x)) = -x -\\log(1+\\exp(-x))\n\\end{aligned}')
('1.0.2.1.0', 'D/(1-D)')
('1.0.2.1.0', '\\begin{aligned}\n    \\frac{\\sigma(x)}{1-\\sigma(x)} = \\exp\\big[-\\log(1 + \\exp(-x)) + x + \\log(1+\\exp(-x))\\big] = \\exp(x)\n\\end{aligned}')
('1.0.2.2', "u'")
('1.0.2.2', "s'")
('1.0.2.2', "\\sum_{k\\geq 1} p^\\pi(S_{t+k} = s' \\mid s, a)")
('1.0.2.2', "M(s,a,s')")
('1.0.2.2', "M(s,a,s')")
('1.0.2.2', "w(s,a,s') = M(s,a,s')/[\\sum_{\\tilde{a} \\in \\mathcal{A}} \\pi(\\tilde{a}\\mid s) M(s,\\tilde{a}, s')] -1")
('1.0.2.2', 'U')
('1.0.2.2', 'S')
('1.0.2.2', "\\begin{aligned}\n    \\sum_{k\\geq 0} p^{\\pi}(U_k = u' \\mid S_0=s, A_0=a) &=  \\sum_{k\\geq 0} \\sum_{s'\\in \\mathcal{S}} p^{\\pi}(U_k = u', S_k=s' \\mid S_0=s, A_0=a) \\\\\n    &= \\sum_{k\\geq 0 } \\sum_{s'\\in \\mathcal{S}} p(U' = u' \\mid S'=s') p^{\\pi}(S_k=s' \\mid S_0=s, A_0=a) \\\\\n    &= \\sum_{s'\\in \\mathcal{S}} p(U' = u' \\mid S'=s') \\sum_{k\\geq 0 } p^{\\pi}(S_k=s' \\mid S_0=s, A_0=a) \\\\\n    & =  \\sum_{s'\\in \\mathcal{S}} p(U' = u' \\mid S'=s') M(s,a,s')\n\\end{aligned}")
('1.0.2.2', 'S')
('1.0.2.2', 'U')
('1.0.2.2', "p(U' \\mid S')")
('1.0.3.0', '\\pi')
('1.0.3.0', 'h')
('1.0.3.0', 'T')
('1.0.3.0', 'N')
('1.0.3.0', 'M')
('1.0.3.0', 'L')
('1.0.3.0', 'K')
('1.0.3.0', 'L')
('1.0.3.0', '\\tau = \\{\\{S_t, A_t, R_t\\}_{t=0}^T\\}_{l=1}^L')
('1.0.3.0', 'U = f(S,A)')
('1.0.3.0', 'R')
('1.0.3.0', 'L')
('1.0.3.0', '\\tau = \\{\\{S_t, A_t, R_t\\}_{t=0}^T\\}_{l=1}^L')
('1.0.3.0', '\\pi')
('1.0.3.0', 'h(A_t | S_t , U_k, \\pi_t)')
('1.0.3.0', '\\tau')
('1.0.3.0', 'X_a = \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} w(S_t,a, U_{t+k}) R_{t+k}')
('1.0.3.0', '\\hat{\\nabla}_\\theta^U V^\\pi(s_0) = \\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a \\in \\mathcal{A}} X_a')
('1.0.3.1.0', 's_{\\infty}')
('1.0.3.1.0', 'T')
('1.0.3.1.0', 's')
('1.0.3.1.0', 'p^{\\pi}(S_T=s_{\\infty}|s_0=s)=1')
('1.0.3.1.0', "\\begin{aligned}\n    M(s, a, s', T) = \\sum_{k=1}^T p^{\\pi}(S_k=s'|S_0=s,A_0=a)\n\\end{aligned}")
('1.0.3.1.0', "s'")
('1.0.3.1.0', 'S_0=s')
('1.0.3.1.0', 'A_0=a')
('1.0.3.1.0', '\\pi')
('1.0.3.1.0', "M(s, a, s', T)")
('1.0.3.1.0', "\\begin{aligned}\n    M(s, a, s', t) &= \\sum_{s'' \\in \\mathcal{S}} p(S_1=s''|S_0=s, A_0=a) \\sum_{a'' \\in \\mathcal{A}}\\pi(a''|s'') ( \\mathbb{1}_{s''=s'} + M(s'', a'', s', t-1))\n\\end{aligned}")
('1.0.3.1.0', '\\mathbb{1}')
('1.0.3.1.0', "M(s, a, s', 0)")
('1.0.3.1.0', '0')
('1.0.3.1.0.0', "w(s,a,u') = \\frac{M(s,a,u',T)}{\\sum_{a' \\in \\mathcal{A}} \\pi(a'\\mid s) M(s,a', u',T)} -1")
('1.0.3.1.0.0', "M(s,a,u',T)=\\sum_{s'\\in \\mathcal{S}} M(s,a,s',T)\\sum_{a'\\in \\mathcal{A}}\\pi(a' \\mid s')\\sum_{r'} p(r'\\mid s',a') \\mathbb{1}_{f(s', a', r')=u'},")
('1.0.3.1.0.0', '\\mathcal{S}')
('1.0.3.1.0.1', "\\begin{aligned}\n    V(s) =& \\sum_{a' \\in \\mathcal{A}}\\pi(a'|s)r(s, a') + \\sum_{k=1}^T  \\sum_{s' \\in \\mathcal{S}}  p^{\\pi}(S_k=s'|S_0=s, \\pi) \\sum_{a' \\in \\mathcal{A}}\\pi(a'|s')r(s', a')\\\\\n    =& \\sum_{a' \\in \\mathcal{A}}\\pi(a'|s)r(s, a') + \\sum_{s' \\in \\mathcal{S}}  \\sum_{a \\in \\mathcal{A}} \\pi(a\\mid s) M(s,a, s',T) \\sum_{a' \\in \\mathcal{A}} \\pi(a'|s')r(s', a')\n\\end{aligned}")
('1.0.3.1.0.1', "r(s', a') = \\sum_{r'}r' p(r'\\mid s',a')")
('1.0.3.1.0.2', "\\begin{aligned}\n    Q(s,a) =& r(s,a) + \\sum_{k=1}^T  \\sum_{s' \\in \\mathcal{S}}  p^{\\pi}(S_k=s'|S_0=s, A_0=a) \\sum_{a' \\in \\mathcal{A}}\\pi(a'|s')r(s', a') \\\\\n    =&r(s,a) + \\sum_{s' \\in \\mathcal{S}} M(s,a, s',T) \\sum_{a' \\in \\mathcal{A}}\\pi(a'|s') r(s', a')\n\\end{aligned}")
('1.0.3.1.0.2', "r(s', a') = \\sum_{r'}r' p(r'\\mid s',a')")
('1.0.3.1.1', '\\hat{w}')
('1.0.3.1.1', '\\hat{V}')
('1.0.3.1.1', '\\hat{Q}')
('1.0.3.1.1.0', "\\begin{aligned}\n    \\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s,a)\\big] &= r(s,a) - \\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s) r(s,a') + \\mathbb{E}_{T \\sim \\mathcal{T}(s,\\pi)} \\left[ \\sum_{k= 1}^T \\hat{w}(s,a, U_k)R_k \\right] \\\\\n    &= r(s,a) - \\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s) r(s,a') + \\sum_{u' \\in \\mathcal{U}} \\sum_{k= 1}^T p^{\\pi}(U_k=u'\\mid S_0=s) \\hat{w}(s,a, u')r(u')\\\\ \n    &= r(s,a) - \\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s) r(s,a') + \\sum_{u' \\in \\mathcal{U}} \\hat{w}(s,a, u')r(u') \\sum_{a' \\in \\mathcal{A}} \\pi(a'\\mid s) M(s,a', u',T) \n\\end{aligned}")
('1.0.3.1.1.0', "r(u') = \\sum_{r'}r' p(r'\\mid u')")
('1.0.3.1.1.0', "M(s,a',u',T)")
('1.0.3.1.1.1', '\\begin{aligned}\n    \\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s,a)\\big] &= Q(s,a) - \\hat{V}(s)\n\\end{aligned}')
('1.0.3.1.1.1', 'Q')
('1.0.3.1.1.2', "\\begin{aligned}\n    \\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s,a)\\big] &= \\hat{Q}(s,a) - \\sum_{a' \\in \\mathcal{A}} \\pi(a' \\mid s) \\hat{Q}(s,a')\n\\end{aligned}")
('1.0.3.1.2', '\\mathbb{E}_\\pi\\big[\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi\\big]')
('1.0.3.1.2', '\\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s,a)\\big]')
('1.0.3.1.2', '\\begin{aligned}\n    \\mathbb{E}_\\pi\\big[\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi\\big] &= \\sum_{k=0}^T \\mathbb{E}_{S_k\\sim \\mathcal{T}(s_0,\\pi)} \\sum_{a \\in \\mathcal{A}} \\nabla_\\theta \\pi(a|s)\\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(S_k,a)\\big] \\\\\n    &= \\sum_{k=0}^T \\sum_{s\\in \\mathcal{S}} p^{\\pi}(S_k=s|s_0) \\sum_{a \\in \\mathcal{A}} \\nabla_\\theta \\pi(a|s)\\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s,a)\\big]\n\\end{aligned}')
('1.0.3.1.2', '\\nabla_\\theta \\pi(a|s_0)')
('1.0.3.1.2', "M(s,a,s', T)")
('1.0.3.1.2', '\\begin{aligned}\n\\label{eqn_app:expected_advantage2}\n    \\mathbb{E}_\\pi\\big[\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi\\big]=& \\sum_{a \\in \\mathcal{A}} \\nabla_\\theta \\pi(a|s_0)\\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s_0, a)\\big] +  \\\\\n    & \\quad \\quad \\sum_{s\\in \\mathcal{S}} \\sum_{a_0 \\in \\mathcal{A}} \\pi(a_0\\mid s_0) M(s_0,a_0, s, T)  \\sum_{a \\in \\mathcal{A}} \\nabla_\\theta \\pi(a|s)\\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s, a)\\big]\n\\end{aligned}')
('1.0.3.1.2.0', '\\mathbb{E}_\\pi\\big[\\hat{A}^\\pi(s_0, a)\\big]')
('1.0.3.2', '\\begin{aligned}\n    SNR &= \\frac{\\|\\nabla_\\theta V^\\pi\\|^2}{\\mathbb{E}_\\pi\\left[\\|\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi - \\nabla_\\theta V^\\pi\\|^2\\right]} \\\\\n    \\text{Variance} &= \\frac{\\mathbb{E}_\\pi\\left[\\|\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi - \\mathbb{E}_\\pi[\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi]\\|^2\\right]}{\\|\\nabla_\\theta V^\\pi\\|^2}\\\\\n    \\text{Bias} &= \\frac{\\|\\mathbb{E}_\\pi[\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi] - \\nabla_\\theta V^\\pi\\|^2}{\\|\\nabla_\\theta V^\\pi\\|^2}\n\\end{aligned}')
('1.0.3.2', '\\mathbb{E}_\\pi[\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi]')
('1.0.3.2', '\\nabla_\\theta V^\\pi')
('1.0.3.2', '\\mathbb{E}_\\pi\\left[\\|\\hat{\\nabla}_{\\theta}^{\\cdot}V^\\pi - \\nabla_\\theta V^\\pi\\|^2\\right]')
('1.0.3.2.0', 't=0')
('1.0.3.3', '\\begin{aligned}\n    \\text{SNR}^{\\text{REINF}} \\approx \\frac{\\| \\mathbb{E}[\\hat{\\nabla}_{\\theta}^{\\text{REINF}}V^\\pi]\\|^2}{C(\\theta)\\mathbb{V}[\\sum_{t\\in T2} R_t] + \\mathrm{Tr}\\left[\\mathbb{V}[\\hat{\\nabla}_{\\theta}^{\\text{REINF}}V^\\pi \\mid \\text{no T2}]\\right]}.\n\\end{aligned}')
('1.0.3.3', '\\hat{\\nabla}_{\\theta}^{\\text{REINF}}V^\\pi')
('1.0.3.3', 'C(\\theta)')
('1.0.3.3', 'T2')
('1.0.3.3', '\\mathrm{Tr}\\left[\\mathbb{V}[\\hat{\\nabla}_{\\theta}^{\\text{REINF}}V^\\pi \\mid \\text{no T2}]\\right]')
('1.0.3.3', 'L \\in \\{20, 40, \\dots, 100\\}')
('1.0.3.3', 'r_{\\text{distractor}} \\sim \\mathcal{U}(\\{ \\frac{2}{L}, \\frac{18}{L} \\})')
('1.0.3.3', 'r_{\\text{treasure}} = \\frac{4}{L}')
('1.0.3.4', 'L=40')
('1.0.3.5', 'd')
('1.0.3.5', 'n_a')
('1.0.3.5', 'o_s')
('1.0.3.5', 'i<d')
('1.0.3.5', 'j')
('1.0.3.5', '(i,j)=(0,0)')
('1.0.3.5', 'i \\leftarrow i+1')
('1.0.3.5', 'j \\leftarrow j(n_a - o_s) + a')
('1.0.3.5', '0\\leq a < n_a')
('1.0.3.5', 'r\\in \\{-2,-1,0,1,2\\}')
('1.0.3.5', '\\begin{aligned}\n    r(s,a) = \\big((\\mathrm{idx}(s) + ap + \\mathrm{seed})\\bmod n_r\\big) - n_r//2\n\\end{aligned}')
('1.0.3.5', '\\bmod')
('1.0.3.5', 'n_r=5')
('1.0.3.5', '\\mathrm{idx}(s)')
('1.0.3.5', 's=(i,j)')
('1.0.3.5', 'p')
('1.0.3.5', '\\mathrm{seed}')
('1.0.3.5', 'n_g')
('1.0.3.5', '\\begin{aligned}\n    u = (\\mathrm{idx}(s) + ap + \\mathrm{seed})\\bmod (n_r n_g) - n_r//2\n\\end{aligned}')
('1.0.3.5.0', 'U')
('1.0.3.5.0', 'n_g=4')
('1.0.3.5.0', 'n_g=32')
('1.0.3.6', 'C')
('1.0.3.6', 'O')
('1.0.3.6', 'B')
('1.0.3.6', '1 - \\gamma')
('1.0.3.6', '2O')
('1.0.3.6', 'O')
('1.0.3.6.0', '2')
('1.0.3.6.0.0', '0')
('1.0.3.6.0.0', '2')
('1.0.3.6.0.0', '0')
('1.0.3.6.0.0', '\\frac{C_o}{B}')
('1.0.3.6.0.0', 'C_o')
('1.0.3.6.0.0', '2')
('1.0.3.6.0.0', 'O')
('1.0.3.6.0.0', 'O')
('1.0.3.6.0.0', '1-\\gamma')
('1.0.3.6.0.1', 'C=5,B=3,O=2')
('1.0.3.6.0.1', '\\gamma=0.95')
('1.0.3.6.0.2', '\\sum_{a \\in \\mathcal{A}} \\pi(a | s_t) \\cdot \\left | w(s_t, a, r_{t+k}) \\right |')
('1.0.3.6.0.2', 's_t')
('1.0.3.6.0.2', 'r_{t+k}')
('1.0.3.7.0', 's')
('1.0.3.7.0', "u'")
('1.0.3.7.0', '\\otimes')
('1.0.3.7.0', '\\begin{aligned}\n    \\text{ReLU-g}(x) = \\text{ReLU}(x_{0:n/2}) - \\text{ReLU}(x_{n/2:n})\n\\end{aligned}')
('1.0.3.7.0', 'n')
('1.0.3.7.0', 'x')
('1.0.3.7.0', 'u')
('1.0.3.7.1', '\\lambda')
('1.0.3.7.1', '\\lambda')
('1.0.3.7.1', '\\frac{1}{\\sqrt{n_{\\text{input}}}}')
('1.0.3.7.1', 'n_{\\text{input}}')
('1.0.3.7.2', 'u=f(s,a)')
('1.0.3.7.2', 'u=f(s,a)')
('1.0.3.7.2', 'p(U \\mid S,A)')
('1.0.3.7.2', 'U')
('1.0.3.7.2', 'U')
('1.0.3.7.2.0', '1')
('1.0.3.7.2.0', '0')
('1.0.3.7.2.0', '\\frac{1}{\\sqrt{d}}')
('1.0.3.7.2.0', 'd')
('1.0.3.7.2.1', '\\eta_{L_1}=0.001')
('1.0.3.7.2.1', '\\eta_{L_2}=0.03')
('1.0.3.7.2.1', '(\\eta_{L_1},\\eta_{L_2}) = (0.001,0.03)')
('1.0.3.7.2.1', '(\\eta_{L_1},\\eta_{L_2}) = (0.05,0.0003)')
('1.0.3.7.2.2', 'B_\\text{feature}')
('1.0.3.7.2.2', '(s,a,r)')
('1.0.3.7.2.2', 'N_\\text{feature}')
('1.0.3.7.2.2', '\\mathbb{1}_{x>0.05}')
('1.0.3.7.2.2', 'B_\\text{feature}')
('1.0.3.7.2.2', '(B_\\text{feature},N_\\text{feature}) = (30,20000)')
('1.0.3.7.2.2', '(B_\\text{feature},N_\\text{feature}) = (90,30000)')
('1.0.3.7.3', '\\{0.003,0.001, 0.0003, 0.0001\\}')
('1.0.3.7.3', '\\{0.01, 0.003,0.001\\}')
('1.0.3.7.3', '\\{0.01, 0.003,0.001\\}')
('1.0.3.7.3', '\\{0.01, 0.003,0.001\\}')
('1.0.3.7.3', '\\{0.01, 0.003, 0.001\\}')
('1.0.3.7.3', '\\{0., 0.5, 0.9, 1.\\}')
('1.0.3.7.3', '\\{0., 0.5, 0.9,1.\\}')
('1.0.3.7.3', '\\{0.3, 0.1, 0.03, 0.01\\}')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '0.0001')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '1.')
('1.0.3.7.3', '0.9')
('1.0.3.7.3', '0.9')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.0001')
('1.0.3.7.3', '0.0003')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.003')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.001')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '1.')
('1.0.3.7.3', '0.9')
('1.0.3.7.3', '0.9')
('1.0.3.7.3', '0.03')
('1.0.3.7.3', '0.0187')
('1.0.3.7.3', '0.0142')
('1.0.3.7.3', '0.0116')
('1.0.3.7.3', '0.01')
('1.0.3.7.3', '0.0062')
('1.0.3.7.3.0', '\\texttt{entropy\\_reg}')
('1.0.3.7.3.0', '\\texttt{entropy\\_reg}')
('1.0.3.7.3.0', '0.03')
('1.0.3.7.3.0', '20')
('1.0.3.7.3.0', '0.01')
('1.0.3.7.3.0', '100')
('1.0.3.7.3.2', '1.')
('1.0.3.7.3.2', '0.001')
('1.0.4.0', 'U=S')
('1.0.4.0', 'r(s,a)')
('1.0.4.1', 'u')
('1.0.4.2', '\\begin{aligned}\n    \\sum_{t\\geq 0} \\sum_{a} \\nabla_\\theta \\pi(a \\mid S_t)\\Big(\\frac{p^\\pi(a \\mid S_t, Z_t)}{\\pi(a \\mid S_t)} -1\\Big)Z_t\n\\end{aligned}')
('1.0.4.3', '(1 + \\sigma \\epsilon)')
('1.0.4.3', '\\epsilon')
('1.0.4.3', '\\sigma \\in \\{0.001, 0.003, 0.01, 0.03, 0.1,0.3\\}')
('1.0.4.3', '\\log\\sigma')
('1.0.4.3', '\\log\\sigma')
('1.0.5.0', "p^{\\pi}(S_k=s' \\mid s,a)")
('1.0.5.0', "p(X=x)/p(X=x')")
('1.0.5.0', 'X')
('1.0.5.0', 'x')
('1.0.5.0', "x'")
('1.0.5.0', 'U=S')
('1.0.5.0', "\\begin{aligned}\n\\label{eqn_app:contribution_coeff_state}\n    w(s,a,s') &= \\frac{\\sum_{k\\geq 1} p^\\pi(S_{t+k}=s' \\mid S_t=s,A_t=a)}{\\sum_{k\\geq 1} p^\\pi(S_{t+k}=s' \\mid S_t=s)} -1 = \\frac{p^\\pi (A_t=a\\mid S_t=s, S'=s')}{\\pi (a \\mid s)} - 1\n\\end{aligned}")
('1.0.5.0', "s'")
('1.0.5.0', '(s,a)')
('1.0.5.0', 's')
('1.0.5.0', "p^{\\pi}(S'=s' \\mid s,a)")
('1.0.5.0', "s'")
('1.0.5.0', 'a')
('1.0.5.0', "a' \\neq a")
('1.0.5.0', "p^{\\pi}(S_k=s' \\mid s,a)")
('1.0.5.0', "p^{\\pi}(S_k=s' \\mid s,a')")
('1.0.5.0', "s'")
('1.0.5.0', 'a')
('1.0.5.0', "p^{\\pi}(S_k=s' \\mid s,a)")
('1.0.5.0', "p^{\\pi}(S_k=s' \\mid s,a)")
('1.0.5.0', "p^{\\pi}(S_k=s' \\mid s,a)")
('1.0.5.1', 'U')
('1.0.5.1', 'p(R\\mid S,A)')
('1.0.5.1', 'p(R\\mid S,A)')
('1.0.5.1', 'p(S,A \\mid R)')
('1.0.5.1', 'r')
('1.0.5.2', 'U')
('1.0.5.2.0', 'U')
('1.0.5.2.0.0', 'U \\sim \\mathcal{N}(R,\\sigma)')
('1.0.5.2.0.0', '\\mathcal{N}')
('1.0.5.2.0.0', '\\sigma')
('1.0.5.2.0.0', '\\sigma')
('1.0.5.2.0.1', "h(a \\mid s,u')")
('1.0.5.2.0.1', "u'")
('1.0.5.2.0.1', 'U')
('1.0.5.2.0.1', 'R')
('1.0.5.2.0.1', 'a')
('1.0.5.2.0.2', "p^{\\pi}(A_0=a \\mid S_0=s, S'=s')")
('1.0.5.2.0.2', "p^{\\pi}(A_0=a \\mid S_0=s, R'=r')")
('1.0.5.2.0.2', "\\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S'=s' \\mid S_0=s, R'=r')")
('1.0.5.2.0.2', "s''")
('1.0.5.2.0.2', "S'")
('1.0.5.2.0.2', "r(s'')")
('1.0.5.2.0.2', "s''")
('1.0.5.2.0.2', "S'\\sim \\mathcal{N}(s'', \\sigma)")
('1.0.5.2.0.2', "p^{\\pi}(S' \\mid S_0=s, R'=r(s''))")
('1.0.5.2.0.2', "\\begin{aligned}\n        p^{\\pi}(A_0=a \\mid S_0=s, R'=r') = \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S'=s' \\mid S_0=s, R'=r') p^{\\pi}(A_0=a \\mid S_0=s, S'=s')\n    \n\\end{aligned}")
('1.0.5.2.0.2', 'A_0')
('1.0.5.2.0.2', "R'")
('1.0.5.2.0.2', "S'")
('1.0.5.2.0.2', 'S_0')
('1.0.5.2.0.2', "\\begin{aligned}\n        &p^{\\pi}(A_0=a \\mid S_0=s, R'=r')\\\\\n        &= \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S'=s', A_0=a \\mid S_0=s, R'=r') \\\\\n        &= \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S'=s' \\mid S_0=s, R'=r') p^{\\pi}(A_0=a \\mid S_0=s, S'=s', R'=r') \\\\\n        &= \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S'=s' \\mid S_0=s, R'=r') p^{\\pi}(A_0=a \\mid S_0=s, S'=s')\n    \n\\end{aligned}")
('1.0.5.3.0', "a'\\mathcal{A}")
('1.0.5.3.0', "A'")
('1.0.5.3.0', '\\begin{aligned}\n \\label{eqn_app:cocoa_pg_continuous}\n        \\hat{\\nabla}_\\theta^U V^\\pi(s_0) &= \\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\int_{\\mathcal{A}} \\mathrm{d}a ~ \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} w(S_t,a, U_{t+k}) R_{t+k}\n\\end{aligned}')
('1.0.5.3.0', "A'")
('1.0.5.3.0', '\\begin{aligned}\n\\label{eqn_app:cocoa_pg_sample}\n    \\hat{\\nabla}_\\theta V^\\pi &= \\sum_{t\\geq0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_{t} + \\frac{1}{M} \\sum_m \\nabla_\\theta \\log \\pi(a^m\\mid S_t)\\sum_{k=1}^{\\infty} w(S_{t}, a^m, U_{t+k}) R_{t+k}\n\\end{aligned}')
('1.0.5.3.0', 'M')
('1.0.5.3.0', 'a^m \\sim \\pi(\\cdot \\mid S_t)')
('1.0.5.3.0.0', "p^{\\pi}(A_0=a \\mid S_0=s, S'=s')")
('1.0.5.3.0.0', '\\delta(a=a_0)')
('1.0.5.3.0.0', 'a_0')
('1.0.5.3.0.0', "s'")
('1.0.5.4', 's')
('1.0.5.4', '\\mathcal{O}')
('1.0.5.4', 'o_t')
('1.0.5.4', 'o')
('1.0.5.4', 's')
('1.0.5.4', 'a')
('1.0.5.4', 'p_o(o \\mid s,a)')
('1.0.5.4', 'x_t')
('1.0.5.4', "h_t=\\{o_{t'+1}, a_{t'}, r_{t'}\\}_{t'=0}^{t-1}")
('1.0.5.4', 'h_t')
('1.0.5.4', 's_t')
('1.0.5.4', 'b_t')
('1.0.5.4', 's')
('1.0.5.4', 'h_t')
('1.0.5.4', 'p_B(s\\mid b_t) = p(S_t = s \\mid H_t = h_t)')
('1.0.5.4', 'b')
('1.0.5.4', 's')
('1.0.5.4', 'x')
('1.0.5.4.0', 'x')
('1.0.5.4.0', 'h')
('1.0.5.4.0', 'h')
('1.0.5.4.0', 'x')
('1.0.5.4.0', '\\mathcal{S}')
('1.0.5.4.0', 'x')
('1.0.5.4.0', 'y')
('1.0.5.4.0', 'z')
('1.0.5.4.0', 'b=\\{b^1, b^2\\}')
('1.0.5.4.0', '\\begin{aligned}\n    p(S=x\\mid b) = b^1, ~~~ p(S=y \\mid b) = b^2, ~~~ p(S=z \\mid b) = 1 - b^1 - b^2\n\\end{aligned}')
('1.0.5.4.0', 'b_t')
('1.0.5.4.0', 'h_t')
('1.0.5.4.0', 'k')
('1.0.5.4.0', 'b_k = \\{0.5, 0.25\\}')
('1.0.5.4.0', 'x')
('1.0.5.4.0', "p^{\\pi}(B' = b' \\mid b, a)")
('1.0.5.4.0', 'a')
('1.0.5.4.0', 'x')
('1.0.5.4.0', 'B_k=\\{0.5, 0.23\\}')
('1.0.5.4.0', 'B_k=\\{0.5, 0.25\\}')
('1.0.5.4.0', "a'")
('1.0.5.4.0', 'a')
('1.0.5.4.0', "p^{\\pi}(B' = b' \\mid b, a)")
('1.0.5.4.0', 'a')
('1.0.5.4.0', 'a_0')
('1.0.5.4.0', "b'")
('1.0.5.4.0', "\\begin{aligned}\n    p^{\\pi}(A_0=a \\mid X_0=x, R'=r') = \\sum_{X' \\in \\mathcal{X}} p^{\\pi}(X'=x' \\mid X_0=x, R'=r') p^{\\pi}(A_0=a \\mid X_0=x, X'=x')\n\\end{aligned}")
('1.0.5.4.0', "x'")
('1.0.6.0', "p^{\\pi}(a \\mid s, u')")
('1.0.6.0', 'U')
('1.0.6.1', 'U')
('1.0.6.1', 'U')
('1.0.6.1', 'U')
('1.0.6.1', 'U')
('1.0.6.1', 'U')
('1.0.6.1', 'U')
('1.0.6.2', "s'")
('1.0.6.2', "w(s,a,s')")
('1.0.6.2', "S'")
('1.0.6.2', "U'")
('1.0.6.2', "\\begin{aligned}\n        w(s,a,u') = \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S'=s' \\mid S_0=s, U'=u') w(s,a,s')\n    \n\\end{aligned}")
('1.0.6.2', "p^{\\pi}(S'=s' \\mid S_0=s, U'=u')")
('1.0.6.2', "s'")
('1.0.6.2', "u'")
('1.0.6.2', 's')
('1.0.6.2', "p^{\\pi}(a \\mid s, u')")
('1.0.6.3', 'Z')
('1.0.6.3', 'S')
('1.0.6.3', "p^{\\pi}(Z'=z' \\mid S=s, U'=u')")
('1.0.6.3', "S'")
('1.0.6.3', "Z'")
('1.0.6.3', 'Z')
('1.0.6.3', "p^{\\pi}(z'\\mid s, u')")
('1.0.6.3', '\\beta')
('1.0.6.3', 'p(Z\\mid S,A;\\theta)')
('1.0.6.3', '\\theta')
('1.0.6.3', 'Z')
('1.0.6.3', 'U')
('1.0.6.3', 'R')
('1.0.6.3', "\\mathcal{I}(Z'; S', A' \\mid S, U')")
('1.0.6.3', 'S')
('1.0.6.3', "U'")
('1.0.6.3', "\\begin{aligned}\n    H-D \\leq \\mathcal{I}(Z'; S', A' \\mid S, U') \\leq \\text{Rate}\n\\end{aligned}")
('1.0.6.3', 'H')
('1.0.6.3', 'D')
('1.0.6.3', "\\begin{aligned}\n    H &= -\\mathbb{E}_{S',A', S, U'}[\\log p^{\\pi}(S',A' \\mid S,U')] \\\\\n    D &= -\\mathbb{E}_{S,U'}\\left[ \\mathbb{E}_{S', A' \\mid S,U'} \\left[ \\int \\mathrm{d}z' p(z'\\mid s', a';\\theta) \\log q(s', a' \\mid s, z';\\psi)\\right]\\right] \\\\\n\\text{Rate} &= \n%\\mathbb{E}_{S,U'}\\left[ \\mathbb{E}_{S', A' \\mid S,U'} \\left[ \\int \\mathrm{d}z' p(z'\\mid s', a';\\theta) \\log \\frac{p(z'\\mid s', a';\\theta)}{q(z' \\mid s, u'; \\phi)} \\right]\\right]\n\\mathbb{E}_{S,U'}\\left[ \\mathbb{E}_{S', A' \\mid S,U'} \\left[ D_{\\mathrm{KL}}\\big(p(z'\\mid s', a';\\theta)\\|q(z' \\mid s, u'; \\phi)\\big) \\right]\\right]\n\\end{aligned}")
('1.0.6.3', "q(s', a' \\mid s, z';\\psi)")
('1.0.6.3', "p(s', a' \\mid s, z')")
('1.0.6.3', "q(z' \\mid s, u'; \\phi)")
('1.0.6.3', "p(z' \\mid s, u')")
('1.0.6.3', 'D')
('1.0.6.3', "(s',a')")
('1.0.6.3', "z'")
('1.0.6.3', "q(s', a' \\mid s, z';\\psi)")
('1.0.6.3', '\\psi')
('1.0.6.3', "p(z'\\mid s',a')")
('1.0.6.3', "(s',a')")
('1.0.6.3', "Z'")
('1.0.6.3', "q(z' \\mid s, u'; \\phi)")
('1.0.6.3', "Z'")
('1.0.6.3', '\\text{Rate}\\leq a')
('1.0.6.3', 'a')
('1.0.6.3', "Z'")
('1.0.6.3', "(S',A')")
('1.0.6.3', "p(z' \\mid s',a';\\theta)")
('1.0.6.3', "q(z' \\mid s, u'; \\phi)")
('1.0.6.3', "\\mathcal{I}(Z'; S', A' \\mid S, U')")
('1.0.6.3', '\\begin{aligned}\n \\label{eqn_app:information_bottleneck}\n    \\min_{\\theta,\\phi,\\psi} D + \\beta \\text{Rate}\n\\end{aligned}')
('1.0.6.3', '\\beta')
('1.0.6.3', '\\beta')
('1.0.6.3', '\\beta=1')
('1.0.6.3', 'Z')
('1.0.6.3', "\\begin{aligned}\n    \\text{Rate} &= \\mathbb{E}_{S,U'}\\left[ D_{\\mathrm{KL}}\\big(p(z'\\mid s,u') \\| q(z'\\mid s,u'; \\phi)\\big)\\right] + \\\\\n    & \\quad \\quad \\mathbb{E}_{S,U',Z'}\\left[D_{\\mathrm{KL}}\\big(p(s',a'\\mid s, z') \\| p(s', a'\\mid s,u')\\big)\\right]\n\\end{aligned}")
('1.0.6.3', '\\phi')
('1.0.6.3', "q(z'\\mid s,u'; \\phi)")
('1.0.6.3', "p(z'\\mid s,u')")
('1.0.6.3', "p(z'\\mid s', a';\\theta)")
('1.0.6.3', 'Z')
('1.0.6.3', 'U')
('1.0.6.3', "q(z'\\mid s,u'; \\phi)")
('1.0.6.3', '\\theta')
('1.0.6.3', "Z'")
('1.0.6.3', "p(z'\\mid s,u')")
('1.0.6.3', "q(z'\\mid s,u'; \\phi)")
('1.0.6.3', 'Z')
('1.0.6.3', '\\beta')
('1.0.6.3', "Z'")
('1.0.6.3', "(S',A')")
('1.0.6.3', "Z'")
('1.0.6.3', "p(z'\\mid s,u')")
('1.0.6.3', "q(z'\\mid s,u'; \\phi)")
('1.0.6.3', '\\phi')
('1.0.6.3', "q(z'\\mid s,u'; \\phi)")
('1.0.6.3', "Z'")
('1.0.7.0', 'Do-interventions')
('1.0.7.0', 'A_t')
('1.0.7.0', 'a')
('1.0.7.0', 'S_t')
('1.0.7.0', 'R_{t+1}')
('1.0.7.0', 'V_i')
('1.0.7.0', 'v')
('1.0.7.0', '\\mathrm{Do}(V_i=v)')
('1.0.7.0', 'A_t=a')
('1.0.7.0', 'S_t=s')
('1.0.7.0', "U'=u'")
('1.0.7.0', "\\begin{aligned}\n\\label{eqn_app:causal_contribution}\n    w_{\\mathrm{Do}}(s,a,u') = \\frac{p^\\pi\\big(U'=u' \\mid S_t=s, \\mathrm{Do}(A_t=a)\\big)}{\\sum_{\\tilde{a} \\in \\mathcal{A}} \\pi(\\tilde{a}\\mid s) p^\\pi\\big(U'=u' \\mid S_t=s, \\mathrm{Do}(A_t=\\tilde{a})\\big)}  -1.\n\\end{aligned}")
('1.0.7.0', 'S')
('1.0.7.0', "U'")
('1.0.7.0', 'A')
('1.0.7.0', "p^\\pi\\big(U'=u' \\mid S_t=s, \\mathrm{Do}(A_t=a)\\big)")
('1.0.7.0', "p^\\pi\\big(U'=u' \\mid S_t=s,A_t=a\\big)")
('1.0.7.1', 'a')
('1.0.7.1', "a'")
('1.0.7.1', 'N')
('1.0.7.1', 'N')
('1.0.7.1', 'p^{\\pi}(\\{N\\} \\mid T=\\tau)')
('1.0.7.1', '\\{N\\}')
('1.0.7.1', '\\tau')
('1.0.7.1', 'h')
('1.0.7.1', "p^{\\pi}_\\tau\\big(A_t=a \\mid S_t=s, U'=u'\\big)")
('1.0.7.1', '\\tau')
('1.0.7.1', "h(a\\mid s', s, \\Phi_t(\\tau))")
('1.0.7.1', '\\Phi_t(\\tau)')
('1.0.7.1', 'p(\\{N\\} \\mid T=\\tau)')
('1.0.7.1', '\\Phi_t(\\tau)')
('1.0.7.1', 'A_t')
('1.0.7.1', "h(a\\mid s', s, \\Phi_t(\\tau))")
('1.0.7.1', '\\Phi_t(\\tau)')
('1.0.7.1', '\\Phi_t')
('1.0.7.1', '\\mathcal{L}_{\\mathrm{IM}}(s)')
('1.0.7.1', 'A_t')
('1.0.7.1', '\\Phi_t')
('1.0.7.1', 'S_t')
('1.0.7.1', '\\pi(a_t \\mid s_t)')
('1.0.7.1', 'p(a_t \\mid s_t, \\Phi_t(\\tau))')
('1.0.7.1', 'q(a_t \\mid s_t, \\Phi_t(\\tau))')
('1.0.8', '(1-\\gamma)')
('1.0.8', 's_{\\infty}')
('1.0.8', '(\\mathcal{S}, \\mathcal{A}, p, p_r, \\gamma)')
('1.0.8', '\\gamma \\in [0,1]')
('1.0.8', '(\\mathcal{S}, \\mathcal{A}, p, p_r)')
('1.0.8', 'V^\\pi_\\gamma(s) = \\mathbb{E}_{T\\sim \\mathcal{T}(s, \\pi)}\\left[\\sum_{t=0}^{\\infty}\\gamma^t R_t\\right]')
('1.0.8', 'Q_\\gamma^\\pi(s,a) = \\mathbb{E}_{T\\sim \\mathcal{T}(s,a, \\pi)}\\left[\\sum_{t=0}^{\\infty} \\gamma^t R_t\\right]')
('1.0.8', 's')
('1.0.8', 's')
('1.0.8', 'a')
('1.0.8', 'V^\\pi_\\gamma(s)')
('1.0.8', 'u')
('1.0.8', "\\begin{aligned}\n\\label{eqn_app:contribution_coeff_discounted}\n    w_\\gamma(s,a,u') &= \\frac{\\sum_{k\\geq 1}\\gamma^k p^\\pi(U_{t+k}=u' \\mid S_t=s,A_t=a)}{\\sum_{k\\geq 1}\\gamma^k p^\\pi(U_{t+k}=u' \\mid S_t=s)} -1  \\\\\n    &= \\frac{p^\\pi_\\gamma (A_t=a\\mid S_t=s, U'=u')}{\\pi (a \\mid s)} - 1\n\\end{aligned}")
('1.0.8', "p^\\pi_\\gamma (A_t=a\\mid S_t=s, U'=u')")
('1.0.8', 'k')
('1.0.8', 'p_\\beta(K=k) = (1-\\beta) \\beta^{k-1}')
('1.0.8', '\\beta=\\gamma')
('1.0.8', '\\beta=\\gamma')
('1.0.8', '\\beta \\to 1')
('1.0.8', "p^\\pi_\\gamma (A_t=a\\mid S_t=s, U'=u')")
('1.0.8', '\\begin{aligned}\n    L_\\gamma = \\mathbb{E}_\\pi\\left[\\sum_{t\\geq 0} \\sum_{k \\geq 1} \\gamma^k CE\\big(h_\\gamma(\\cdot \\mid S_t, U_{t+k}), \\delta(a=A_t)\\big)  \\right],\n\\end{aligned}')
('1.0.8', 'CE')
('1.0.8', 'h_\\gamma(\\cdot \\mid S_t, U_{t+k})')
('1.0.8', '\\delta(a=A_t)')
('1.0.8', 'A_t')
('1.0.8', '\\hat{\\nabla}_{\\theta} V^{\\pi}(s_0)')
('1.0.8', '\\sum_{t\\geq 0}\\gamma^{t}\\nabla_{\\theta}\\log \\pi(A_t \\mid S_t) \\sum_{k\\geq 0} \\gamma^{k} R_{t+k}')
('1.0.8', '\\sum_{t\\geq 0}\\gamma^t\\nabla_{\\theta}\\log \\pi(A_t \\mid S_t) \\left(\\sum_{k\\geq 0}\\gamma^k R_{t+k} - V^\\pi_\\gamma(S_t) \\right)')
('1.0.8', '\\sum_{t\\geq 0}\\gamma^t\\sum_{a\\in \\mathcal{A}} \\nabla_{\\theta}\\pi(a \\mid S_t) Q^\\pi_\\gamma(S_t, a)')
('1.0.8', '\\sum_{t\\geq 0} \\gamma^t \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} \\gamma^k w_\\gamma(S_t,a, U_{t+k}) R_{t+k}')
('1.0.8', '\\sum_{t\\geq 0}\\gamma^t \\nabla_\\theta \\log \\pi(A_t \\mid S_t) R_t  + \\sum_{a\\in \\mathcal{A}} \\nabla_\\theta \\pi(a \\mid S_t) \\sum_{k \\geq 1} \\gamma^k w_\\gamma(S_t,a, S_{t+k}) R_{t+k}')
('1.0.9', 'K')
('1.0.9', 'n')
('1.0.9', 'K')
('1.0.9', '\\beta')
('1.0.9', 'p_{n,\\beta}(K=k) = \n    \\begin{cases}\n      \\frac{\\beta^k}{z} & \\text{if}~~ 1 \\leq k \\leq n-1\\\\\n      0 & \\text{else}\n    \\end{cases} \n    \\quad z = \\beta \\frac{1-\\beta^{n-1}}{1-\\beta}')
('1.0.9', 'p^{\\pi}_{n,\\beta}')
('1.0.9', "\\begin{aligned}\n    p^{\\pi}_{n,\\beta}(U'=u \\mid S=s, A=a) &= \\sum_k p^{\\pi}_{n,\\beta}(U'=u, K=k \\mid S=s, A=a)\\\\\n    &= \\sum_k p_{n,\\beta}(K=k)p^{\\pi}_{n,\\beta}(U'=u\\mid S=s, A=a,  K=k )\\\\\n    &= \\frac{1-\\beta}{\\beta (1-\\beta^{n-1})}\\sum_{k=1}^{n-1} \\beta^k p^{\\pi}(U_k=u \\mid S_0=s, A_0=a)\n\\end{aligned}")
('1.0.9', "\\begin{aligned}\n    w_{n,\\beta}(s,a,u') &= \\frac{\\sum_{k=1}^{n-1} \\beta^k p^{\\pi}(U_k=u' \\mid S_0=s, A_0=a)}{\\sum_{k=1}^{n-1} \\beta^k p^{\\pi}(U_k=u' \\mid S_0=s)} \\\\\n    &=\\frac{p^{\\pi}_{n,\\beta}(U'=u' \\mid S=s, A=a)}{p^{\\pi}_{n,\\beta}(U'=u' \\mid S=s)} - 1 = \\frac{p^{\\pi}_{n,\\beta}(A=a \\mid S=s, U'=u')}{\\pi(a\\mid s)} - 1 \\\\\n    w_n(s,a,s') &= \\frac{p^{\\pi}(S_n=s' \\mid S_0=s, A_0=a)}{p^{\\pi}(S_n=s'\\mid S_0=s)} - 1 = \\frac{p^{\\pi}(A=a \\mid S=s, S_n=s')}{\\pi(a\\mid s)} - 1 \n\\end{aligned}")
('1.0.9', '\\gamma \\to 1_{-}')
('1.0.9', 's')
('1.0.9', 'a')
('1.0.9', '\\pi(a \\mid s) > 0')
('1.0.9', '\\beta')
('1.0.9', '\\gamma \\in [0,1]')
('1.0.9', 'u=f(s,a,r)')
('1.0.9', 'A^\\pi(s,a) = Q^\\pi(s,a) - V^\\pi(s)')
('1.0.9', '\\begin{aligned}\n        A^\\pi(s,a) = r(s,a) - r^\\pi(s) + \\mathbb{E}_{\\mathcal{T}(s,\\pi)} \\left[ \\sum_{k=1}^{n-1} \\gamma^k w_{n,\\beta}(s,a,U_k) R_k + \\gamma^n w_n(s,a,S_n) V^\\pi(S_n) \\right]\n    \n\\end{aligned}')
('1.0.9', 'r(s,a)')
('1.0.9', 'r^\\pi(s) = \\sum_a \\pi(a\\mid s) r(s,a)')
('1.0.9', 'Q^\\pi')
('1.0.9', 'V^\\pi')
('1.0.9', "\\begin{aligned}\n    Q(s,a) &= \\mathbb{E}_{T\\sim \\mathcal{T}(s,a,\\pi)}\\left[ \\sum_{k\\geq 1}\\gamma^k R_k \\right] \\\\\n    &= r(s,a) +\\sum_{r' \\in \\mathcal{R}} \\sum_{k\\geq 1} \\gamma^k p^{\\pi}(R_k=r' \\mid s, a) r' \\\\\n    &= r(s,a) + \\sum_{r' \\in \\mathcal{R}}\\sum_{u' \\in \\mathcal{U}} \\sum_{k=1}^{n-1} \\gamma^k p^{\\pi}(R_k=r', U_k=u' \\mid s,a) r'  + \\\\\n    & \\quad \\quad \\gamma^n \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S_n=s' \\mid s,a) V^\\pi(s') \\\\\n    &= r(s,a) + \\sum_{r' \\in \\mathcal{R}}\\sum_{u' \\in \\mathcal{U}} \\sum_{k=1}^{n-1} \\gamma^k p^{\\pi}(R'=r'\\mid U'=u') p^{\\pi}(U_k=u' \\mid s,a) r'  + \\\\\n    & \\quad \\quad \\gamma^n \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S_n=s' \\mid s,a) V^\\pi(s') \\\\\n    &= r(s,a) + \\sum_{u' \\in \\mathcal{U}} r(u') \\sum_{k=1}^{n-1} \\gamma^k p^{\\pi}(U_k=u' \\mid s,a) + \\gamma^n \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S_n=s' \\mid s,a) V^\\pi(s') \\\\\n    & = r(s,a) + \\sum_{u' \\in \\mathcal{U}} r(u') \\sum_{k=1}^{n-1} \\gamma^k p^{\\pi}(U_k=u' \\mid s) \\frac{\\sum_{k'=1}^{n-1}  \\gamma^{k'} p^{\\pi}(U_{k'}=u \\mid s, a)}{\\sum_{k'=1}^{n-1} \\gamma^{k'} p^{\\pi}(U_{k'}=u \\mid s)} + \\\\\n    &\\quad \\quad \\gamma^n \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S_n=s' \\mid s)  \\frac{p^{\\pi}(S_n=s' \\mid s,a)}{p^{\\pi}(S_n=s' \\mid s)} V^\\pi(s')\\\\\n    & = r(s,a) + \\sum_{u' \\in \\mathcal{U}} r(u') \\sum_{k=1}^{n-1} \\gamma^k p^{\\pi}(U_k=u' \\mid s) (w_{n,\\beta}(s,a,u') +1) \\\\\n    & \\quad \\quad + \\gamma^n \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S_n=s' \\mid s) (w_n(s,a,s') + 1) V^\\pi(s')\\\\\n    \n\\end{aligned}")
('1.0.9', "U'")
('1.0.9', "R'")
('1.0.9', "r(u') = \\sum_{r' \\in \\mathcal{R}} p(R'=r' \\mid U'=u')r'")
('1.0.9', "\\begin{aligned}\n        A(s,a) &= r(s,a) - r^\\pi(s) + \\sum_{u' \\in \\mathcal{U}} r(u') \\sum_{k=1}^{n-1} \\gamma^k p^{\\pi}(U_k=u' \\mid s) w_{n,\\beta}(s,a,u')\\\\\n    & \\quad \\quad + \\gamma^n \\sum_{s' \\in \\mathcal{S}} p^{\\pi}(S_n=s' \\mid s) w_n(s,a,s')V^\\pi(s')\\\\ \n    &= r(s,a) - r^\\pi(s) + \\mathbb{E}_{\\mathcal{T}(s,\\pi)} \\left[ \\sum_{k=1}^{n-1} \\gamma^k w_{n,\\beta}(s,a,U_k) R_k + \\gamma^n w_n(s,a,S_n) V^\\pi(S_n) \\right]\n    \n\\end{aligned}")
('1.0.9', "w_n(s,a,s')")
('1.0.9', "s'")
('1.0.9', "u'")
('1.0.9', "w(s,a,u')")
('1.0.9', "w_n(s,a,s')")
('1.0.9.0', "w_{\\beta,n}(s,a,u')")
('1.0.9.0', 'n')
('1.0.9.0', '\\gamma \\neq 1')
('1.0.9.0.0', 'K')
('1.0.9.0.0', 'K')
('1.0.9.0.0', 'p_{n,\\beta}^{HCA}(K=k) = \n    \\begin{cases}\n      \\beta^{k-1} (1-\\beta) & \\text{if}~~ 1 \\leq k \\leq n-1\\\\\n      \\beta^{n-1} & \\text{if}~~ k=n\\\\\n      0 & \\text{else}\n    \\end{cases}')
('1.0.9.0.0', 'K')
('1.0.9.0.0', "p^{\\pi}_{n,\\beta, HCA} (A=a \\mid S=s, S'=s')")
('1.0.9.0.0', 'Q')
('1.0.9.0.0', "p^{\\pi}_{n,\\beta, HCA} (A=a \\mid S=s, S'=s')")
('1.0.9.0.0', "s'")
('1.0.9.0.0', 'k\\sim p_{n,\\beta}^{HCA}(k)')
('1.0.9.0.0', "w_n(s,a,s')")
('1.0.9.0.0', "s'")
('1.0.9.0.0', 'k=n')
('1.0.9.0.0', '\\beta \\to 1')
('1.0.9.0.0', 'p_{n,\\beta}^{HCA}(K=k)')
('1.0.9.0.0', 'k=n')
('1.0.9.0.0', "p^{\\pi}_{n,\\beta, HCA} (A=a \\mid S=s, S'=s')")
('1.0.9.0.0', "s'")
('1.0.9.0.0', 'k=n')
('1.0.9.0.0', 'Z')
('1.0.9.0.0', '\\mathcal{S}')
('1.0.9.0.0', "\\label{eqn_app:hca_visit}\n  \\mu_k(Z=z \\mid S'=s') = \n    \\begin{cases}\n      \\delta(z=s') & \\text{if}~~ 1 \\leq k \\leq n-1\\\\\n      \\tilde{d}^\\pi(z\\mid s') & \\text{if}~~ k=n\\\\\n    \\end{cases}")
('1.0.9.0.0', "\\tilde{d}^\\pi(z\\mid s') = (1-\\gamma) \\sum_k \\gamma^k p^{\\pi}(S_k=z \\mid S_0=s)")
('1.0.9.0.0', "\\begin{aligned}\n    p^{\\pi}(A_0=a \\mid S_0=s, S'=s', Z=z) = p^{\\pi}(A_0=a \\mid S_0=s, S'=s')\n\\end{aligned}")
('1.0.9.0.0', "S'")
('1.0.9.0.0', "A_0 \\rightarrow S' \\leftarrow K \\rightarrow Z")
('1.0.9.0.0', "S'")
('1.0.9.0.0', 'A_0')
('1.0.9.0.0', 'Z')
('1.0.9.0.0', 'S_0')
('1.0.9.0.0', "S'")
('1.0.9.0.0', 'Z')
('1.0.9.0.0', "S'")
('1.0.9.0.0', 'K=n')
('1.0.9.0.0', 'Z')
('1.0.9.0.0', 'A_0')
('1.0.9.0.0', "S'")
('1.0.9.0.0', "S'")
('1.0.9.0.0', "s'")
('1.0.10.0', '\\begin{aligned}\n    \\sum_{t\\geq 0} \\nabla_\\theta \\log \\pi(A_t \\mid S_t)\\Big(1 - \\frac{\\pi(A_t \\mid S_t)}{p^\\pi(A_t \\mid S_t, Z_t)}\\Big)Z_t\n\\end{aligned}')
('1.0.10.1', 'Z')
('1.0.10.1', 's')
('1.0.10.1', 'p^\\pi(a \\mid s,z) > 0')
('1.0.10.1', '(s_t, a_t)')
('1.0.10.1', 'Z')
('1.0.10.1', 's_t')
('1.0.10.1', 'a_t')
('1.0.10.1', 'p^\\pi(a_t \\mid s_t, Z) > 0')
('1.0.10.1', 's_t')
('1.0.10.1', '(s_t, a_t)')
('1.0.10.1', '1')
('1.0.10.1', '-2')
('1.0.10.1', '\\frac{2}{3}')
('1.0.10.1', '\\frac{1}{3}')
('1.0.10.1', '1')
('1.0.10.1', '-2')
('1.0.10.1', 'A^\\pi(s,a_1) = (1 - \\frac{2}{3})=\\frac{1}{3}')
('1.0.10.1', 'A^\\pi(s,a_2) = -2(1 - 1/3)=-4/3')
('1.0.11.0', '^*')
('1.0.11.0', '^*')
('1.0.11.0', '^*')
