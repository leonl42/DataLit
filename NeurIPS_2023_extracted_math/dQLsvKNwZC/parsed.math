('2', '\\mathcal{M}= \\langle\\, \\mathcal{S}, \\mathcal{A}, H, \\mathcal{P}, r, g, s_1 \\, \\rangle')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', 'H \\in \\mathbb{Z}_{>0}')
('2', '\\mathcal{P}: \\mathcal{S}\\times \\mathcal{A}\\times \\mathcal{S}\\rightarrow [0, 1]')
('2', 'r: \\mathcal{S}\\times \\mathcal{A}\\rightarrow [0, 1]')
('2', 'g: \\mathcal{S}\\times \\mathcal{A}\\rightarrow [0, 1]')
('2', 's_1 \\in \\mathcal{S}')
('2', 's')
('2', 'a')
('2', '\\pi: \\mathcal{S}\\rightarrow \\mathcal{A}')
('2', "s'")
('2', 'r')
('2', 'g')
('2', '\\pi')
('2', 's')
('2', 'h')
('2', "\\begin{aligned}\n    V^\\pi_{r, h}(s) \\coloneqq \\mathbb{E}_\\pi \\left[ \\, \\sum_{h'=h}^H \\gamma_r^{h'} r(s_{h'}, a_{h'}) \\,\\middle\\vert\\,s_h = s \\, \\right]\n\\end{aligned}")
('2', "Q^\\pi_{r, h}(s, a) \\coloneqq \\mathbb{E}_\\pi \\left[ \\, \\sum_{{h'}=h}^H \\gamma_r^{h'} r(s_{h'}, a_{h'}) \\mid s_h = s, a_h = a \\, \\right]")
('2', '\\mathbb{E}_{\\pi}')
('2', "\\{(s_{h'}, a_{h'})\\}_{h'=h}^H")
('2', '\\pi')
('2', '\\gamma_r \\in (0, 1]')
('2', 'V_{\\max} \\coloneqq \\frac{1 - \\gamma_r^H}{1 - \\gamma_r}')
('2', '\\mathcal{T}_h: (\\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}) \\rightarrow (\\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R})')
('2', '\\mathcal{T}_h(Q)(s, a) \\coloneqq \\mathbb{E}\\left[ r(s_h, a_h) + \\gamma_r V_Q(s_{h+1}) \\, \\,\\middle\\vert\\,\\, s_h = s, a_h = a \\right]')
('2', 'V_Q(s) \\coloneqq \\max_{a \\in \\mathcal{A}} Q(s, a)')
('2', 'V_r^\\pi \\coloneqq V^\\pi_{r, 1}(s_1)')
('2', '\\max_{\\pi} V^\\pi_r \\quad \\text{subject to} \\quad \\Pr \\left[\\, \\sum_{h=1}^H \\gamma_g^h g(s_h, a_h) \\le \\xi_1 \\,\\middle\\vert\\,\\mathcal{P}, \\pi \\,\\right] = 1,')
('2', '\\xi_1 \\in \\mathbb{R}_{\\ge 0}')
('2', '\\gamma_g \\in (0, 1]')
('2', 'g')
('2', '\\mathbb{E}_\\pi [\\,\\sum_{h=1}^H \\gamma_g^h g(s_h, a_h)\\,] \\le \\xi_1')
('2', '\\max_{\\pi} V^\\pi_r \\ \\ \\ \\text{subject to} \\quad \\mathbb{E}\\left[\\, \\sum_{h=1}^H \\gamma_g^h \\, \\mathbb{I}(s_h \\in S_\\text{unsafe}) \\,\\middle\\vert\\,\\mathcal{P}, \\pi \\,\\right]  \\le \\xi_2,')
('2', '\\xi_2 \\in \\mathbb{R}_{\\ge 0}')
('2', '\\mathbb{I}(\\cdot)')
('2', 'S_\\text{unsafe} \\subset \\mathcal{S}')
('2', '\\max_{\\pi} V^\\pi_r \\quad \\text{subject to} \\quad \\Pr \\Bigl[\\, g(s_h, a_h) \\le \\xi_3 \\mid \\mathcal{P}, \\pi \\, \\Bigr] = 1, \\quad \\forall h \\in [\\, 1, H\\, ],')
('2', '\\xi_3 \\in \\mathbb{R}_{\\ge 0}')
('3', '\\pi^\\star: \\mathcal{S}\\rightarrow \\mathcal{A}')
('3', 'b_h \\in \\mathbb{R}')
('3', '\\max_{\\pi} V^\\pi_r \\quad \\text{subject to} \\quad \\Pr \\Bigl[\\, g(s_h, a_h) \\le b_h \\mid \\mathcal{P}, \\pi \\, \\Bigr] = 1, \\quad \\forall h \\in [\\, 1, H\\,].')
('3', 'b_h')
('3', 'h')
('3', 'h')
('3', 's_h')
('3', 'g(s_h, a_h) \\le b_h')
('3', 'b_h = \\eta_h')
('3', 'h')
('3', '\\eta_{h+1} = \\gamma_g^{-1} \\cdot (\\eta_h - g(s_h, a_h))')
('3', '\\eta_0 = \\xi_1')
('3', 's_h')
('3', 'g')
('3', 'b_h')
('3', 'b_h = 0.1')
('3', 'g(s_h, a) = 0.5, \\forall a \\in \\mathcal{A}')
('3', '\\zeta \\in \\mathbb{R}_{>0}')
('3', '\\Pr[\\, g(s_h, a_h) \\le b_h - \\zeta \\mid \\mathcal{P}, \\pi^\\star \\,] = 1, \\forall h \\in [1, H]')
('3', '\\widehat{a}')
('3', '\\mathcal{P}(s_1 \\mid s, \\widehat{a}) = 1')
('3', 's \\in \\mathcal{S}')
('3', '\\delta')
('3', '\\mu: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}')
('3', '\\delta')
('3', '\\Gamma: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}')
('3', '|\\, g(s, a) - \\mu(s, a) \\,| \\le \\Gamma(s, a)')
('3', '(s, a) \\in \\mathcal{S}\\times \\mathcal{A}')
('3', '1 - \\delta')
('4', '\\delta')
('4', '3')
('4', '9')
('4', '\\delta')
('4', 'g(s, a) \\in [\\, \\mu(s, a) \\pm \\Gamma(s, a)\\, ]')
('4', 's \\in \\mathcal{S}')
('4', 'a \\in \\mathcal{A}')
('4', '\\mu(s_h, a_h) + \\Gamma(s_h, a_h) \\le b_h')
('4', 'g(s_h, a_h) \\le b_h')
('4', '1 - \\delta')
('4', 'h')
('4', '1 - \\delta')
('4', 's_h')
('4', 'b_h')
('4', '\\begin{aligned}\n{2}\n    \\mathcal{A}_{h}^+ \\coloneqq \\{\\, a \\in \\mathcal{A}\\mid \\min \\{\\, 1, \\mu(s_{h}, a) + \\Gamma(s_{h}, a) \\,\\} \\le b_{h}\\,\\}.\n\\end{aligned}')
('4', '\\mathcal{A}_h^+')
('4', '3')
('4', '\\mathcal{A}_{h+1}^+ \\ne \\emptyset')
('4', '\\widehat{a}')
('4', '6')
('4', '9')
('4', 'g \\in [0, 1]')
('4', 'a_h = \\pi(s_h)')
('4', '\\mathcal{A}^+_{h}')
('4', 'r(s_h, a_h)')
('4', 'g(s_h, a_h)')
('4', 's_{h+1}')
('4', 'b_{h+1}')
('4', '\\widehat{r}(s_h, a_h) = - \\frac{c}{\\min_{a \\in \\mathcal{A}} \\Gamma(s_{h+1}, a)}')
('4', '(s_h, a_h, \\widehat{r}(s_h, a_h), s_{h+1} )')
('4', '\\mathcal{D}')
('4', '\\widehat{a}')
('4', '(s_h, a_h, r(s_h,a_h), s_{h+1})')
('4', '\\mathcal{D}')
('4', '\\pi')
('4', '\\mathcal{D}')
('4', '\\Gamma')
('4', '\\mathcal{D}')
('4', '\\mathcal{M}')
('4', '\\widehat{\\cal{M}} \\coloneqq\n    \\langle\\, \\mathcal{S}, \\{\\mathcal{A}, \\widehat{a}\\}, H, \\mathcal{P}, \\widehat{r}, \\rho \\, \\rangle.')
('4', '\\mathcal{M}')
('4', '\\widehat{a}')
('4', '\\widehat{a}')
('4', '\\label{eq:penalty}\n  \\widehat{r}(s_h, a_h) = \n  \\left\\{ \\,\n    \\begin{aligned}\n        & -c / \\min\\nolimits_{a \\in \\mathcal{A}} \\Gamma(s_{h+1}, a) \\quad\\ \\text{if}\\ \\ \\mathcal{A}_{h+1}^+ = \\emptyset, \\\\\n        & r(s_h, a_h) \\quad \\quad \\quad \\quad \\quad \\quad \\quad \\ \\ \\  \\text{otherwise},\n    \\end{aligned}\n  \\right.')
('4', 'c \\in \\mathbb{R}_{>0}')
('4', '(s_h, a_h)')
('4', 'h+1')
('4', '\\mathcal{A}_{h+1}^+ = \\emptyset')
('4', '\\Gamma(s, a) = 0')
('4', '(s, a)')
('4', '\\widehat{r}(s, a) = -\\infty')
('4', '\\widehat{a}')
('4', '\\widehat{r}')
('4', '\\mathcal{D}')
('4', '\\delta')
('4', '\\delta')
('4', '15')
('4', '\\mathcal{D}')
('4', '\\Gamma')
('4', '\\Gamma')
('4', '1-\\delta')
('4', '\\frac{\\zeta}{2}')
('4', '\\Gamma(s, a) \\le \\frac{\\zeta}{2}')
('4', '(s,a)')
('4', 'c \\in \\mathbb{R}')
('4', 'c > \\frac{\\zeta V_{\\max}}{2 \\gamma_r^H}')
('4', '\\widehat{\\mathcal{M}}')
('4', '\\mathcal{M}')
('4', '\\delta')
('5', '\\mathcal{F}')
('5', 'Q_{r, h}^\\star \\coloneqq Q_{r, h}^{\\pi^\\star}')
('5', 'g')
('5.0', 'd \\in \\mathbb{Z}_{>0}')
('5.0', '\\mathbb{B}^d \\coloneqq \\{ \\texttt{x} \\in \\mathbb{R}^d: \\|\\texttt{x}\\|_2 \\le 1 \\}')
('5.0', 'l_2')
('5.0', '\\mathbb{R}^d')
('5.0', '\\phi: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{B}^d')
('5.0', 'f: [-1, 1] \\rightarrow [-1, 1]')
('5.0', '\\mathcal{F}\\coloneqq \\{(s,a) \\rightarrow f(\\langle \\phi_{s,a}, \\theta \\rangle): \\theta \\in \\mathbb{B}^d\\}')
('5.0', '\\phi_{s,a} \\coloneqq \\phi(s, a)')
('5.0', 'f(\\cdot)')
('5.0', '0 < \\underline{\\kappa} < \\overline{\\kappa} < \\infty')
('5.0', 'M < \\infty')
('5.0', "\\underline{\\kappa} < |f'(\\texttt{x})| < \\overline{\\kappa}")
('5.0', "|f''(\\texttt{x})| < M")
('5.0', '|\\texttt{x}| \\le 1')
('5.0', 'f(\\texttt{x}) = \\texttt{x}')
('5.0', 'f(\\texttt{x}) = 1/(1 + e^{-\\texttt{x}})')
('5.0', '1 \\le h < H')
('5.0', 'u \\in \\mathcal{F}_{\\text{up}}')
('5.0', '\\mathcal{T}_h(u) \\in \\mathcal{F}')
('5.0', 'g \\in \\mathcal{F}')
('5.0', '\\mathcal{T}_h')
('5.0', 'A \\in \\mathbb{R}^{d \\times d} \\succ 0')
('5.0', '\\alpha_{\\max} \\in \\mathbb{R}_{>0}')
('5.0', '\\begin{aligned}\n  \\mathcal{F}_{\\text{up}} \\coloneqq \\{(s,a) \\rightarrow \\min\\{V_{\\max}, f(\\langle \\phi_{s,a}, \\theta \\rangle) + \\alpha \\| \\phi_{s,a}\\|_A \\}: \\theta \\in \\mathbb{B}^d, 0 \\le \\alpha \\le \\alpha_{\\max}, \\|A\\|_{\\text{op}} \\le 1 \\},\n\\end{aligned}')
('5.0', '\\|\\texttt{x}\\|_A \\coloneqq \\sqrt{\\texttt{x}^\\top A \\texttt{x}}')
('5.0', '\\|A\\|_{\\text{op}}')
('5.1', 's_h^{(t)}')
('5.1', 'a_h^{(t)}')
('5.1', 'h')
('5.1', 't')
('5.1', '\\widetilde{\\phi}_h^{(t)} \\coloneqq \\phi(s_h^{(t)}, a_h^{(t)})')
('5.1', '\\delta')
('5.1', 'g \\in \\mathcal{F}')
('5.1', '\\delta')
('5.1', '\\delta')
('5.1', '\\delta=\\frac{1}{TH}')
('5.1', 'C \\in \\mathbb{R}_{>0}')
('5.1', 'C_g \\coloneqq C \\overline{\\kappa} \\underline{\\kappa}^{-1}\\sqrt{1+M+\\overline{\\kappa}+d^2 \\ln \\left(\\frac{1+\\overline{\\kappa}+\\alpha_{\\max}}{\\delta}\\right)}')
('5.1', '\\textstyle\n        \\Gamma(s, a) \\coloneqq  C_g \\cdot \\|\\phi_{s, a}\\|_{\\Lambda_{h,t}^{-1}} \\quad \\text{with} \\quad \\Lambda_{h,t} \\coloneqq \\sum_{\\tau\\leq t} \\widetilde{\\phi}_h^{(\\tau)} \\widetilde{\\phi}_h^{(\\tau)} + I,')
('5.1', 'I')
('5.1', '\\widehat{\\theta}^g_{h, t} \\in \\mathbb{R}^d')
('5.1', '\\widehat{\\theta}^g_{h,t} \\coloneqq \\mathop{\\mathrm{arg\\,min}}_{\\|\\theta\\|_2\\leq 1} \\sum_{\\tau\\leq t}\\left(g(s_{h}^{(\\tau)}, a_{h}^{(\\tau)}) \\!- \\! f(\\langle\\, \\widetilde{\\phi}_h^{(\\tau)},\\theta \\,\\rangle)\\right)^2')
('5.1', '\\begin{aligned}\n{2}\n    |\\, g(s_h^{(t)},a_h^{(t)}) - f(\\langle\\, \\widetilde{\\phi}_h^{(t)}, \\widehat{\\theta}^g_{h,t} \\,\\rangle)\\, | & \\le \\Gamma(s_h^{(t)}, a_h^{(t)})\n  \n\\end{aligned}')
('5.1', '(s, a) \\in \\mathcal{S}\\times \\mathcal{A}')
('5.1', '1 - \\delta')
('5.1', 'l_2')
('5.1', '\\phi')
('5.1', '\\|\\phi_{s, a}\\|_{\\Lambda_{h,t}^{-1}}')
('5.1', '\\widehat{\\theta}^Q_{h, t} \\in \\mathbb{R}^d')
('5.1', '\\widehat{\\theta}^Q_{h,t} \\coloneqq \\mathop{\\mathrm{arg\\,min}}_{\\|\\theta\\|_2\\leq 1} \\sum_{\\tau\\leq t}\\left(y_{h}^{(\\tau)} - f(\\langle\\, \\widetilde{\\phi}_h^{(\\tau)},\\theta \\,\\rangle)\\right)^2')
('5.1', "y_{h}^{(\\tau)} \\coloneqq r(s_{h}^{(\\tau)}, a_{h}^{(\\tau)}) + \\max_{a'\\in \\mathcal{A}}\\widehat{Q}_{r, h+1}^{(\\tau)}(s_{h+1}^{(\\tau)},a')")
('5.1', '\\tau\\leq t')
('5.1', '\\widehat{Q}_{r, h}^{(t)}(s,a) \\coloneqq \\min \\left\\{ V_{\\max}, f(\\langle \\phi_{s,a}, \\hat{\\theta}^Q_{h,t} \\rangle) + C_{\\sfrac{Q}{g}} \\Gamma(s,a) \\right\\}')
('5.1', '\\widehat{Q}_{r,h}^{(0)} = 0')
('5.1', 'h \\le H')
('5.1', '\\widehat{Q}_{r, H+1}^{(t)} = 0')
('5.1', '1 \\le t \\le T')
('5.1', 'C_{\\sfrac{Q}{g}} \\in \\mathbb{R}_{>0}')
('5.1', '\\begin{aligned}\n{2}\n    |\\, Q_{r,h}^\\star(s_h^{(t)},a_h^{(t)}) - f(\\langle\\, \\widetilde{\\phi}_h^{(t)}, \\widehat{\\theta}^Q_{h,t} \\,\\rangle)\\, | \\le C_{\\sfrac{Q}{g}} \\cdot \\Gamma(s_h^{(t)},a_h^{(t)})\n  \n\\end{aligned}')
('5.1', '(s, a) \\in \\mathcal{S}\\times \\mathcal{A}')
('5.1', '1 - \\delta')
('5.1', '\\Gamma(s_h^{(t)},a_h^{(t)})')
('5.1', '\\delta')
('5.1', '\\delta')
('5.1', 'h')
('5.1', 't')
('5.1', 'f\\left(\\langle\\, \\widetilde{\\phi}_h^{(t)}, \\widehat{\\theta}^g_{h,t} \\,\\rangle\\right) + \\Gamma \\left(s_h^{(t)}, a_h^{(t)}\\right) \\le b_h.')
('5.1', 'g(s_h^{(t)}, s_h^{(t)}) \\le b_h')
('5.1', 'h')
('5.1', 't')
('5.1', '1 - \\delta')
('5.1', '\\mathcal{A}_h^+ = \\emptyset')
('5.1', '\\widehat{a}')
('5.1', '\\pi')
('5.1', '\\widehat{r}')
('5.1', 's \\in \\mathcal{S}')
('5.1', '\\pi_h^{(t)}(s) = \\mathop{\\mathrm{arg\\,max}}_{a \\in \\mathcal{A}} \\widehat{Q}^{(t)}_{\\widehat{r}, h}(s, a).')
('5.1', 'g(s_h^{(t)}, a_h^{(t)}) \\le b_h')
('5.1', 't \\in [1, T]')
('5.1', 'h \\in [1, H]')
('5.1', '1 - \\delta')
('5.1', 'C_1')
('5.1', 'C_2')
('5.1', 'T')
('5.1', 't^\\star')
('5.1', '\\lambda_{\\min}(\\Sigma)tH - C_1\\sqrt{tHd} - C_2\\sqrt{tH \\ln \\delta^{-1}} \\ge 2 C_g \\cdot \\zeta^{-1}')
('5.1', '\\lambda_{\\min}(\\Sigma)')
('5.1', '\\Sigma')
('5.1', '\\pi^{(t)}')
('5.1', 't')
('5.1', '\\sum_{t=t^\\star}^T \\left[ V_r^{\\pi^\\star} - V_r^{\\pi^{(t)}} \\right] \\le \\widetilde{O}\\left(H\\sqrt{d^3 (T-t^*)}\\right)')
('5.1', '1 - \\delta')
('5.1', '\\delta')
('5.1', 't^\\star')
('5.1', '\\frac{\\zeta}{2}')
('5.1', '\\widehat{\\mathcal{M}}')
('5.1', '\\mathcal{M}')
('6', '\\delta')
('6', 'g')
('6', "g(\\bm{z}) \\sim \\mathcal{GP}(\\mu(\\bm{z}), k(\\bm{z}, \\bm{z}'))")
('6', '\\bm{z} \\coloneqq [s, a]')
('6', '\\mu(\\bm{z})')
('6', "k(\\bm{z}, \\bm{z}')")
('6', 'g(\\cdot, \\cdot)')
('6', 'n \\in \\mathbb{Z}_{>0}')
('6', '(\\bm{z}_1, \\bm{z}_2, \\ldots, \\bm{z}_n)')
('6', '\\bm{y}_n \\coloneqq \\{\\, y_1, y_2, \\ldots, y_n\\, \\}')
('6', 'y_n \\coloneqq g(\\bm{z}_n) + N_n')
('6', 'N_n \\sim \\mathcal{N}(0, \\omega^2)')
('6', '\\omega \\in \\mathbb{R}_{\\ge 0}')
('6', 'n \\approx tH+h')
('6', 't')
('6', 'h')
('6', '\\mu_n(\\bm{z}) =  \\bm{k}_n^\\top(\\bm{z})(\\bm{K}_n+\\omega^2 \\bm{I})^{-1} \\bm{y}_n')
('6', '\\sigma_n(\\bm{z}) = k_n(\\bm{z},\\bm{z})')
('6', "k_n(\\bm{z},\\bm{z}') = k(\\bm{z},\\bm{z}') - \\bm{k}_n^\\top(\\bm{z})(\\bm{K}_n+\\omega^2 \\bm{I})^{-1} \\bm{k}_n(\\bm{z}')")
('6', '\\bm{k}_n(\\bm{z}) = [k(\\bm{z}_1, \\bm{z}), \\ldots, k(\\bm{z}_n, \\bm{z})]^\\top')
('6', '\\bm{K}_n')
('6', '\\| g \\|_k^2 \\le B')
('6', 'N_n \\le \\omega')
('6', 'n \\ge 1')
('6', '\\beta_n^{1/2} \\coloneqq B + 4 \\omega \\sqrt{\\nu_n + 1 + \\ln(1/\\delta)}')
('6', '\\delta')
('6', '\\label{eq:uq_gp}\n        \\Gamma(s, a) \\coloneqq \\beta_n \\cdot \\sigma_n(s, a), \\quad \\forall (s, a) \\in \\mathcal{S}\\times \\mathcal{A},')
('6', '\\nu_n')
('6', 'k')
('6', 'g(s_h^{(t)}, a_h^{(t)}) \\le b_h')
('6', 't')
('6', 'h')
('6', '1 - \\delta')
('6', '\\delta')
('6', '\\widehat{r}')
('6', '\\label{eq:deeprl}\n    \\pi \\coloneqq \\mathop{\\mathrm{arg\\,max}}_{\\pi} V_{\\widehat{r}}^\\pi.')
('7', 'g')
('7', '1')
('7', '0')
('7', '\\xi_1 = 20')
('7', "b_h \\coloneqq \\gamma_g^{-1} \\cdot (\\xi_1 - \\sum_{h'=0}^{h-1} \\gamma_g^{h'} g(s_{h'}, a_{h'}))")
('7', 'g(s_h, a_h) \\le b_h')
('7', 'h')
('7', '\\widehat{\\mathcal{M}}')
('8', '\\delta')
('10.0', '\\eta_h')
('10.0', "\\label{eq:eta_1}\n    \\eta_h \\coloneqq \\gamma_g^{-h} \\cdot \\left(\\, \\xi_1 - \\sum_{h'=1}^{h-1} \\gamma_g^{h'} g(s_{h'}, a_{h'}) \\, \\right), \\quad \\forall h \\in [1, H].")
('10.0', '\\eta_h')
('10.0', '\\gamma_g')
('10.0', '\\begin{aligned}\n{2}\n    \\label{eq:eta_2}\n    \\eta_{h+1} = \\gamma_g^{-1} \\cdot \\left(\\, \\eta_h - g(s_h, a_h) \\, \\right) \\quad \\text{with} \\quad \\eta_0 = \\xi_1.\n  \n\\end{aligned}')
('10.0', '\\eta_h \\ge 0, \\quad \\forall h \\in [1, H].')
('10.0', '\\eta_{h+1} \\ge 0, \\quad \\forall h \\in [1, H] \\iff \\eta_h - g(s_h, a_h) \\ge 0, \\quad \\forall h \\in [1, H].')
('10.0', '\\eta_h')
('10.0', '\\label{lemma:gse_vs_p2_final_eq}\n    \\max_{\\pi} V^\\pi_r \\quad \\text{subject to} \\quad  \\Pr[\\, g(s_h, a_h) \\le \\eta_h \\mid \\mathcal{P}, \\pi \\,] = 1, \\quad \\forall h \\in [1, H].')
('10.0', 'b_h \\coloneqq \\eta_h')
('10.1', "\\begin{aligned}\n    &\\ \\mathbb{E}\\left[\\, \\sum_{h=1}^H \\gamma_g^h \\, \\mathbb{I}(s_h \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right] \\le \\xi_2 \\\\\n    \\iff &\\ \\mathbb{E}\\left[\\, \\sum_{h'=1}^h \\gamma_g^{h'} \\, \\mathbb{I}(s_{h'} \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right]  \\le \\xi_2, \\quad \\forall h \\in [1, H] \\\\\n    \\iff &\\ \\mathbb{E}\\left[\\, \\gamma_g^h \\, \\mathbb{I}(s_h \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right] \\le \\xi_2 - \\mathbb{E}\\left[\\, \\sum_{h'=1}^{h-1} \\gamma_g^{h'} \\, \\mathbb{I}(s_{h'} \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right], \\quad \\forall h \\in [2, H] \\\\\n    \\iff &\\ \\mathbb{E}\\left[\\, \\mathbb{I}(s_h \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right] \\le \\gamma_g^{-h} \\left\\{\\, \\xi_2 - \\mathbb{E}\\left[\\, \\sum_{h'=1}^{h-1} \\gamma_g^{h'} \\, \\mathbb{I}(s_{h'} \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right] \\right\\}, \\quad \\forall h \\in [2, H]\n\\end{aligned}")
('10.1', 'g: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}')
('10.1', 'g(s_h, a) \\coloneqq \\mathbb{E}[\\, \\mathbb{I}(s_h \\in S_\\text{unsafe}) \\mid \\mathcal{P}, \\pi \\,], \\quad \\forall a \\in \\mathcal{A}.')
('10.1', "b_h \\coloneqq \\gamma_g^{-h} \\left\\{\\, \\xi_2 - \\mathbb{E}\\left[\\, \\sum_{h'=1}^{h-1} \\gamma_g^{h'} \\, \\mathbb{I}(s_{h'} \\in S_\\text{unsafe}) \\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\,\\right] \\right\\},")
('10.1', '\\Pr[\\,g(s, a) \\le b_h \\mid \\mathcal{P}, \\pi \\,] = 1.')
('10.2', 'b_h = \\xi_3')
('10.2', 'h')
('11', '\\xi_5 \\in \\mathbb{R}_{\\ge 0}')
('11', 'S_\\text{unsafe} \\subset \\mathcal{S}')
('11', '\\pi^\\star')
('11', '\\textstyle\n    \\max_{\\pi} V^\\pi_r \\quad \\text{subject to} \\quad \\Pr \\left[\n    \\bigvee_{h=1}^{H} s_h \\in S_\\text{unsafe}\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\right] \\le \\xi_5.')
('11', '\\begin{aligned}\n        \\nonumber\n        \\Pr \\left[ \\bigvee_{h=1}^{H} s_h \\in S_\\text{unsafe}\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\right]\n        &\\ \\le \\sum_{h=1}^H \\Pr \\left[s_h \\in S_\\text{unsafe}\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\right]  \\\\\n        &\\ = \\sum_{h=1}^H \\mathbb{E}\\left[ \\, \\mathbb{I}(s_h \\in S_\\text{unsafe})\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\, \\right] \\\\\n        &\\ = \\mathbb{E}\\left[\\, \\sum_{h=1}^H  \\mathbb{I}(s_h \\in S_\\text{unsafe})\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\, \\right].\n        \\label{eq:problem_2_5}\n    \n\\end{aligned}')
('11', '\\Pr[A \\cup B] \\le \\Pr[A] + \\Pr[B]')
('11', 'g(\\cdot, \\cdot)')
('11', 'b_h')
('11', '\\begin{aligned}\n    \\nonumber\n    \\Pr \\left[ \\bigvee_{h=1}^{H} s_h \\in S_\\text{unsafe}\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\right]\n    &\\ \\le \\mathbb{E}\\left[\\, \\sum_{h=1}^H  \\mathbb{I}(s_h \\in S_\\text{unsafe})\\, \\,\\middle\\vert\\,\\, \\mathcal{P}, \\pi \\, \\right].\n\\end{aligned}')
('12.0', 'h')
('12.0', '\\label{eq:appendix_c1}\n\\mu(s_h,a_h) + \\Gamma(s_h,a_h) \\le b_h.')
('12.0', '\\delta')
('12.0', '1 - \\delta')
('12.0', 'g(s_h, a_h) \\le b_h.')
('12.0', '1')
('12.1', '\\label{eq:appendix_safety_conservative}\n  g(s_h, a_h) \\le b_h - \\zeta, \\quad \\forall h \\in [1, H].')
('12.1', '\\Gamma(s,a) \\le \\frac{1}{2}  \\zeta, \\forall (s,a) \\in \\mathcal{S}\\times \\mathcal{A}')
('12.1', '\\mu(s_h, a_h) + \\Gamma(s_h, a_h) \\le g(s_h, a_h) + \\zeta \\le b_h, \\quad \\forall h \\in [1, H],')
('12.1', '\\delta')
('12.1', '\\Gamma(\\cdot, \\cdot)')
('12.1', 'h')
('12.1', '1-\\delta')
('12.1', 'c')
('12.1', 'c > \\frac{\\zeta}{2 \\gamma_r^H}V_{\\max}')
('12.1', '\\widehat{r}')
('12.1', '\\begin{aligned}\n  \\widehat{r}(s_h, a_h)\n  &\\ = \\frac{-c}{\\min_{a \\in \\mathcal{A}} \\Gamma(s_{h+1}, a)} \\\\\n  &\\ < \\frac{-\\frac{1}{2} \\zeta \\cdot \\frac{1}{\\gamma_r^H} V_{\\max}}{\\frac{1}{2} \\zeta} \\\\\n  &\\ < - \\gamma_r^{-H} V_{\\max}.\n\\end{aligned}')
('12.1', '\\widehat{\\mathcal{M}}')
('12.1', '\\max_s V_r^\\pi(s) \\le V_{\\max}')
('12.1', '\\widehat{M}')
('12.1', '\\widehat{a}')
('12.1', '\\widehat{\\mathcal{M}}')
('12.1', '\\mathcal{M}')
('13.0', 'a_h = \\pi(s_h)')
('13.0', '\\mathcal{A}^+_{h}')
('13.0', 'r(s_h, a_h)')
('13.0', 's_{h+1}')
('13.0', 'g(s_h, a_h)')
('13.0', 'b_{h+1}')
('13.0', '\\widehat{r}(s_h, a_h) = - \\frac{c}{\\min_{a \\in \\mathcal{A}} \\Gamma(s_{h+1}, a)}')
('13.0', '(s_h, a_h, \\widehat{r}(s_h, a_h), s_{h+1})')
('13.0', '\\mathcal{D}')
('13.0', '\\widehat{a}')
('13.0', '(s_h, a_h, r(s_h, a_h), s_{h+1})')
('13.0', '\\mathcal{D}')
('13.0', '\\widehat{\\theta}^g_{h, t}')
('13.0', '\\widehat{\\theta}^Q_{h, t}')
('13.0', '\\textstyle\n      \\widehat{Q}^{(t)}_{\\widehat{r}, h}(s, a) = \\min \\{ V_{\\max}, f(\\langle \\phi_{s,a}, \\hat{\\theta}^Q_{h, t} \\rangle)+ C_{\\sfrac{Q}{g}} \\Gamma(s,a)\\}')
('13.0', '\\pi_h^{(t)}(s) = \\mathop{\\mathrm{arg\\,max}}_{a \\in \\mathcal{A}} \\widehat{Q}^{(t)}_{\\widehat{r}, h}(s, a).')
('13.0', '\\Gamma(s,a) \\coloneqq C_g \\cdot \\|\\phi_{s, a}\\|_{\\Lambda_{h,t}^{-1}}')
('13.0', '\\mathcal{D}')
('13.2', 'C_1')
('13.2', 'C_2')
('13.2', 'T')
('13.2', 't^\\star')
('13.2', '\\label{equation:lambda_min}\n    \\lambda_{\\min}(\\Sigma)tH - C_1\\sqrt{tHd} - C_2\\sqrt{tH \\ln \\delta^{-1}} \\ge 2 \\cdot C_g \\cdot \\zeta^{-1}')
('13.2', '\\lambda_{\\min}(\\Sigma)')
('13.2', '\\Sigma')
('13.2', '\\Gamma(s_h^{(t)}, a_h^{(t)}) \\le \\frac{1}{2} \\cdot \\zeta.')
('13.2', '\\lambda_{\\min}(\\Lambda_{h,t}) \\ge \n    \\lambda_{\\min}(\\Sigma)tH - C_1\\sqrt{tHd} - C_2\\sqrt{tH \\ln \\delta^{-1}}.')
('13.2', '\\lambda_{\\min}(\\Lambda_{h,t}) \\ge 2 \\cdot C_g \\cdot \\zeta^{-1}.')
('13.2', '\\lambda_{\\max}(\\Lambda^{-1}_{h,t}) = \\frac{1}{\\lambda_{\\min}(\\Lambda_{h,t})}')
('13.2', 't \\in [t^\\star, T]')
('13.2', 'h \\in [1, H]')
('13.2', '\\begin{aligned}\n{2}\n    \\Gamma(s_h^{(t)}, a_h^{(t)})\n    & = C_g \\cdot \\|\\phi_{s, a}\\|_{\\Lambda_{h,t}^{-1}} \\\\\n    & \\le C_g \\cdot \\lambda_{\\max}(\\Lambda^{-1}_{h,t}) \\\\\n    & = C_g \\cdot \\lambda^{-1}_{\\min}(\\Lambda_{h,t}) \\\\\n    & \\le \\frac{1}{2}\\, \\zeta.\n\\end{aligned}')
('13.3', '\\label{eq:appendix_d1}\n    f(\\langle\\, \\widetilde{\\phi}_h^{(\\tau)}, \\widehat{\\theta}^g_{h,t} \\,\\rangle) + \\Gamma(s_h^{(t)}, a_h^{(t)}) \\le b_h.')
('13.3', '1 - \\delta')
('13.3', 'g(s_h^{(t)}, a_h^{(t)}) \\le b_h.')
('13.4', '\\pi^\\star')
('13.4', '\\begin{aligned}\n    g(s_h, \\pi^\\star(s_h)) \\le b_h - \\zeta, \\quad \\forall h \\in [1, H].\n\\end{aligned}')
('13.4', '\\pi^\\star')
('13.4', '\\begin{aligned}\n{2}\n    \\{\\, (s, a) \\in \\mathcal{S}\\times \\mathcal{A}\\mid g(s,a) \\le b_h - \\zeta \\, \\},\n\\end{aligned}')
('13.4', '\\begin{aligned}\n{2}\n    \\{\\, (s, a) \\mid g(s,a) \\le b_h - \\zeta \\, \\}\n    & \\subseteq \\{\\, (s, a) \\mid \\mu(s,a) - \\Gamma(s,a) \\le b_h - \\zeta \\, \\} \\\\\n    & \\subseteq \\{\\, (s, a) \\mid \\mu(s,a) + \\Gamma(s,a) \\le b_h \\, \\}.\n\\end{aligned}')
('13.4', '\\Gamma(s,a) < \\frac{\\zeta}{2}')
('13.4', '\\sum_{t=t^\\star}^T \\left[ V_r^{\\pi^\\star} - V_r^{\\pi_t} \\right]  = \\mathcal{R}(T) + \\sum_{t=t^\\star} V_{\\max} \\delta,\n    \\label{eq:regret}')
('13.4', '\\delta')
('13.4', '\\delta')
('13.4', '\\begin{aligned}\n    \\mathcal{R}(T)\n    \\le\\ &\n    O\\Biggl(H\\sqrt{(T-t^\\star)\\ln((T-t^\\star)H)} \\\\\n    &\\quad\\quad + H \\overline{\\kappa} \\underline{\\kappa}^{-1}\\sqrt{M+\\overline{\\kappa}+d^2 \\ln \\left(\\frac{\\overline{\\kappa}+\\alpha_{\\max}}{(T-t^\\star)H}\\right) \\cdot (T-t^\\star)d \\ln\\left(1 + \\frac{(T-t^\\star)}{d}\\right)}\\Biggr) \\\\\n    \\le\\ & \\widetilde{O}(H\\sqrt{d^3 (T-t^\\star)}).\n\\end{aligned}')
('13.4', '\\delta = \\frac{1}{TH}')
('13.4', '\\begin{aligned}\n    \\sum_{t=t^\\star}^T V_{\\max} \\cdot \\delta\n    & = \\sum_{t=t^\\star}^T V_{\\max} \\cdot \\frac{1}{TH} \\\\\n    & = \\sum_{t=t^\\star}^T \\frac{1 - \\gamma^H}{1-\\gamma} \\cdot \\frac{1}{TH} \\\\\n    & \\le \\sum_{t=t^\\star}^T H \\cdot \\frac{1}{TH} \\\\\n    & \\le O(1).\n\\end{aligned}')
('13.4', '\\widetilde{O}(H\\sqrt{d^3 (T-t^\\star)})')
('14', '\\delta')
('14', '\\| g \\|_k^2 \\le B')
('14', 'N_n \\le \\omega')
('14', 'n \\ge 1')
('14', '\\Gamma(s, a) \\coloneqq \\beta_n \\cdot \\sigma_n(s, a), \\quad \\forall (s, a) \\in \\mathcal{S}\\times \\mathcal{A}')
('14', '\\beta_n^{1/2} \\coloneqq B + 4 \\omega \\sqrt{\\nu_n + 1 + \\ln \\delta^{-1}}')
('14', '\\nu_n')
('14', 'k')
('14', '\\Gamma')
('14', '\\delta')
('14', '\\| g \\|_k^2 \\le B')
('14', 'N_n \\le \\omega')
('14', '\\forall n \\ge 1')
('14', '\\beta_n^{1/2} \\coloneqq B + 4 \\omega \\sqrt{\\nu_n + 1 + \\ln \\delta^{-1}}.')
('14', '|\\, g(s, a) - \\mu_n(s, a) \\,| \\le \\beta_n \\cdot \\sigma_n(s, a), \\quad \\forall (s, a) \\in \\mathcal{S}\\times \\mathcal{A}')
('14', 'n \\ge 1')
('14', '1-\\delta')
('14', '\\Gamma(s, a) \\coloneqq \\beta_n \\cdot \\sigma_n(s, a), \\quad \\forall (s, a) \\in \\mathcal{S}\\times \\mathcal{A}')
('14', '\\Gamma: \\mathcal{S}\\times \\mathcal{A}\\rightarrow \\mathbb{R}')
('14', '\\delta')
('14.0', '\\mathcal{A}^+_h \\ne \\emptyset')
('14.0', '\\delta')
('14.0', '1-\\delta')
('14.0', '\\mathcal{A}^+_h = \\emptyset')
('14.0', '1-\\delta')
('15', '[64, 64]')
('15', '5 \\times 10^{-3}')
('15', '3 \\times 10^{-4}')
('15', '3 \\times 10^{-2}')
('15', '0.99')
('15', '0.99')
('15', '10,000')
('15', '80')
('15', '500')
('15', '0.01')
('15', '0.1')
('15', '0.8')
('15', '10')
('15', '-1')
('15', '[16, 16]')
('15', '128')
('15', '100')
('16', '20 \\times 20')
('16', '100')
('16', '1.0 \\pm 0.0')
