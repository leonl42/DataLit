('2.0', '(\\mathcal{S}, \\mathcal{A}, P, d_0, R, \\gamma)')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', 'P(\\mathbf{s}_{t+1}|\\mathbf{s}_t, \\mathbf{a})')
('2.0', 'd_0(\\mathbf{s}_0)')
('2.0', 'R(\\mathbf{s}_t, \\mathbf{a}_t, \\mathbf{s}_{t+1})')
('2.0', '\\gamma\\in (0, 1]')
('2.1', 'L_\\pi=\\mathbb{E}_{(\\mathbf{s}, \\mathbf{a}) \\sim \\mathcal{D}} \\Bigg[\n        \\overbrace{\\exp \\Big(\\underbrace{\\beta}_{\\text{balance coefficient}}\\big(\\underbrace{Q(\\mathbf{s}, \\mathbf{a})-V(\\mathbf{s})}_{\\text{policy improvement}}\\big)\\Big)}^{\\text{imitation weight}} \\cdot \\underbrace{\\log \\pi(\\mathbf{a}|\\mathbf{s})}_{\\text{policy constraint}}\\Bigg].\n        \\label{eq: training objective}')
('2.1', 'L_\\pi')
('2.1', '\\mathcal{D}')
('2.1', '\\mathcal{D}')
('2.1', '\\mathcal{D}_{\\text{offline}} = \\{(\\mathbf{s}_k, \\mathbf{a}_k, \\mathbf{s}^{\\prime}_k, r_k) \\mid k=1, 2, \\cdots, N\\}')
('2.1', '\\mathcal{D}')
('2.1', '\\beta')
('2.1', '(s, a)')
('3', '\\begin{aligned}\n\\max_{\\pi} & \\ \\ \\mathbb{E}_{\\mathbf{s}\\sim d{\\pi_\\beta}(\\cdot), \\mathbf{a}\\sim \\pi(\\cdot|\\mathbf{s})} \\left[Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s})\\right] \\label{eq: optimization problem}\\\\\n& \\text { s.t. } D_{\\mathrm{KL}}(\\pi(\\cdot | \\mathbf{s}) | \\pi_{\\beta}(\\cdot | \\mathbf{s})) \\leq \\epsilon_\\mathbf{s}, \\quad \\forall \\mathbf{s}\\in \\mathcal{S} \\label{eq: kl constraint} \\\\\n& \\int_{\\mathbf{a}\\in\\mathcal{A}} \\pi(\\mathbf{a}| \\mathbf{s})\\mathop{}\\!\\mathrm{d}\\mathbf{a}=1, \\quad \\forall \\mathbf{s}\\in \\mathcal{S} \\label{eq: normalization constraint}.\n\\end{aligned}')
('3', '\\pi^k (k \\in \\mathbb{N})')
('3', 'k')
('3', '\\pi_\\beta')
('3', '\\mathcal{D}')
('3', 'd_{\\pi_{\\beta}}(\\mathbf{s})')
('3', '\\pi_\\beta')
('3', '\\epsilon_\\mathbf{s}')
('3', '\\pi^{k+1}')
('3', '\\epsilon')
('3', '\\int_{\\mathbf{s}\\in\\mathcal{S}} d_{\\pi_\\beta}(\\mathbf{s}) D_{\\mathrm{KL}}(\\pi(\\cdot | \\mathbf{s}) \\| \\pi_{\\beta}(\\cdot | \\mathbf{s})) \\mathop{}\\!\\mathrm{d}\\mathbf{s}\\le \\epsilon \\label{eq: distributional constraint}.\n      \\vspace{5pt}')
('3', 'J^k_*[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in\\mathcal{S}\\}]')
('3', 'J^k_*[\\epsilon]')
('3', '\\forall \\epsilon \\ge 0, \\quad \\exists \\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}, \\quad J^k_*[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in\\mathcal{S}\\}] \\ge J^k_*[\\epsilon].')
('3', '\\mathcal{S} = [s_{\\min}, s_{\\max}]^l')
('3', 'l')
('3', '\\mathbf{s}\\in \\mathcal{S}')
('3', '\\pi^{k+1}')
('3', '\\pi_*^{k+1}')
('3', '\\forall \\mathbf{s}\\in \\mathcal{S}, \\mathbf{a}\\in \\mathcal{A}')
('3', '\\pi_*^{k+1}(\\mathbf{a}|\\mathbf{s}) = \\frac{\\pi_\\beta(\\mathbf{a}|\\mathbf{s})}{Z_{\\mathbf{s}}} \\exp\\left({\\color{blue}\\beta_\\mathbf{s}}(Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}))\\right),\n    \\label{eq: adaptive optimal policy}')
('3', '\\beta_{\\mathbf{s}}')
('3', 'Z_{\\mathbf{s}}')
('3', '\\pi_{\\mathbf{\\phi}}')
('3', '\\pi_*^{k+1}')
('3', '\\label{eq: adaptive training objective}\n    \\mathbf{\\phi} = \\underset{\\phi}{\\arg \\max }\\mathbb{E}_{(\\mathbf{s}, \\mathbf{a})\\sim \\mathcal{D}} \\Big[ \\exp({\\color{blue}\\beta_{\\mathbf{s}}} (Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}))) \\log \\pi_{\\mathbf{\\phi}}(\\mathbf{a}|\\mathbf{s}) \\Big].')
('4', '\\pi_u')
('4', '\\pi_b')
('4', '\\mathcal{B}')
('4', '\\mathbf{s}')
('4', '\\pi_u')
('4', '\\pi_b')
('4', '\\mapsto')
('4', '\\pi_b: \\mathcal{S}\\mapsto\\mathcal{B}')
('4', '\\beta_\\mathbf{s}')
('4', '\\mathbf{s}')
('4', '\\beta_\\mathbf{s}')
('4', '\\pi_u: \\mathcal{S}\\times \\mathcal{B} \\mapsto \\mathcal{A}')
('4', '\\beta_\\mathbf{s}')
('4', '\\pi_u')
('4', '\\mathbf{s}')
('4.0', '\\pi_u')
('4.0', '\\pi_u')
('4.0', '\\label{eq: the optimization target of the universal model}\n     \\pi_u^{k+1} = \\underset{\\pi_u}{\\arg \\max }\\mathbb{E}_{(\\mathbf{s}, \\mathbf{a})\\sim \\mathcal{D}} \\Big[ \\exp(\\beta_\\mathbf{s}(Q^{k}(\\mathbf{s}, \\mathbf{a})-V^{k}(\\mathbf{s}))) \\log \\pi_u(\\mathbf{a}|\\mathbf{s}, {\\color{blue}\\beta_\\mathbf{s}}) \\Big].')
('4.0', 'Q^{k}')
('4.0', 'V^k')
('4.0', 'Q')
('4.0', 'V')
('4.0', 'k')
('4.0', '\\beta_\\mathbf{s}')
('4.0', '\\beta_\\mathbf{s}')
('4.0', '\\mathcal{B}')
('4.0', '\\pi_u')
('4.0', '\\beta_\\mathbf{s}')
('4.0', '\\pi_b')
('4.0', '\\pi_u')
('4.0', '\\pi_u')
('4.0', '\\pi_b')
('4.1', '\\pi_b')
('4.1', '\\pi_u')
('4.1', '\\beta_{\\mathbf{s}} \\in \\mathcal{B}')
('4.1', '\\pi_b')
('4.1', '\\beta_\\mathbf{s}')
('4.1', '\\mathbf{s}')
('4.1', '\\pi_b')
('4.1', '\\pi_b^{k+1} = \\underset{\\pi_b}{\\arg \\max } \\mathbb{E}_{(\\mathbf{s}, \\mathbf{a})\\sim \\mathcal{D}}\\Big[Q^{k}(\\mathbf{s}, \\underbrace{\\pi_u^{k+1}(\\mathbf{s}, \\overbrace{\\pi_b(\\mathbf{s})}^{\\mathclap{\\text{balance coefficient }\\beta_\\mathbf{s}}}}_{\\text{action}})\\Big].\n    \\label{eq: the optimization target of the balance model}')
('4.1', '\\pi_u^{k+1}')
('4.1', '\\pi_b')
('4.1', 'Q^k')
('4.1', '\\pi_u^{k+1}')
('4.1', 'Q')
('4.1', 'Q^k')
('4.1', '\\pi_b')
('4.1', '\\mathcal{B}')
('4.1', '\\pi_b')
('4.2', 'Q')
('4.2', 'V')
('4.2', '\\pi_u')
('4.2', '\\pi_b')
('4.2', '\\pi_b: \\mathcal{S} \\mapsto \\mathcal{B}')
('4.2', '\\pi_u: \\mathcal{S}\\times \\mathcal{B} \\mapsto \\mathcal{A}')
('4.2', '\\pi_u(\\cdot, \\pi_b(\\cdot)): \\mathcal{S}\\mapsto \\mathcal{A}')
('4.2', '\\pi_u(\\cdot, \\pi_b(\\cdot))')
('5.1.0', '\\Delta')
('6.1', '\\mathcal{D}')
('6.1', '\\pi')
('6.1', '\\tau')
('6.1', 'd_{\\text{action}}^{\\pi, \\tau} = \\mathbb{E}_{(\\mathbf{s}, \\mathbf{a}) \\sim \\tau}\\big[ \\| \\underset{\\mathbf{a}^\\prime}{\\arg \\max }\\ \\pi(\\mathbf{a}^\\prime|\\mathbf{s}) - \\mathbf{a}\\|^2_2 \\big].\n    \\label{eq: action distance}\n    % \\vspace{-10pt}')
('6.1', 'd_{\\text{action}}^{\\pi, \\tau}')
('6.1', '\\pi')
('6.1', '\\tau')
('6.1', '(s, a)')
('6.5', '\\sim')
('6.5', '\\pi_b')
('10', '\\mathcal{D}')
('10', '\\mathcal{D}_{\\text{offline}}')
('10', 'N_{\\text{off}}, N_{\\text{on}}')
('10', '\\pi_b^0, \\pi_u^0, Q^0, V^0')
('10', '\\mathcal{D}')
('10', '\\mathcal{D}_{\\text{offline}}')
('10', 'M_k')
('10', '\\mathcal{D}')
('10', 'M_k')
('10', 'B_{M_k}')
('10', '\\pi_u^k')
('10', '\\pi_u^{k+1}')
('10', 'M_k, B_{M_k}')
('10', '\\pi_b^k')
('10', '\\pi_b^{k+1}')
('10', 'M_k')
('10', 'Q^k, V^k')
('10', 'Q^{k+1}, V^{k+1}')
('10', 'M_k')
('10', '\\pi_u^k, \\pi_b^k')
('10', '\\mathcal{D}')
('10', 'M_k')
('10', '\\mathcal{D}')
('10', '\\pi_b^k')
('10', 'M_k')
('10', 'B_{M_k}')
('10', '\\pi_u^k')
('10', '\\pi_u^{k+1}')
('10', 'M_k, B_{M_k}')
('10', '\\pi_b^k')
('10', '\\pi_b^{k+1}')
('10', 'M_k')
('10', 'Q^k, V^k')
('10', 'Q^{k+1}, V^{k+1}')
('10', 'M_k')
('11.0', '\\begin{aligned}\n    &\\exists \\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in\\mathcal{S}\\} \\in C, \\quad \\forall \\mathbf{s}\\in \\mathcal{S}, \\quad  D_{\\mathrm{KL}}(\\pi(\\cdot | \\mathbf{s}) \\| \\pi_{\\beta}(\\cdot | \\mathbf{s})) \\le \\epsilon_\\mathbf{s}, \\label{eq: equivalent equation 1}\\\\\n    &\\text{where} \\ C = \\left\\{\\left\\{\\epsilon_\\mathbf{s}^\\prime, \\mathbf{s}\\in \\mathcal{S}\\right\\} | \\int_{\\mathbf{s}\\in\\mathcal{S}} d_{\\pi_\\beta}(\\mathbf{s}) \\epsilon_\\mathbf{s}^\\prime \\mathop{}\\!\\mathrm{d}\\mathbf{s}= \\epsilon, \\epsilon_\\mathbf{s}^\\prime\\ge 0 \\right\\}. \\label{eq: equivalent equation 2}\n\\end{aligned}')
('11.0', '\\Rightarrow')
('11.0', '\\nRightarrow')
('11.0', '\\int_{\\mathbf{s}\\in \\mathcal{S}} d_{\\pi_\\beta(\\mathbf{s})} D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s})\\| \\pi_\\beta(\\cdot|\\mathbf{s})) \\mathrm{d}\\mathbf{s} \\le \\epsilon')
('11.0', '\\forall \\epsilon_{\\mathbf{s}}\\ge 0\\ (\\mathbf{s}\\in \\mathcal{S})')
('11.0', '\\int_{\\mathbf{s}\\in\\mathcal{S}}d_{\\pi_\\beta}(\\mathbf{s})\\epsilon_{\\mathbf{s}}\\mathrm{d}\\mathbf{s}=\\epsilon')
('11.0', '\\mathbf{s}\\in\\mathcal{S}')
('11.0', 'D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s})\\| \\pi_\\beta(\\cdot|\\mathbf{s})) > \\epsilon_{\\mathbf{s}}')
('11.0', '\\{\\epsilon_{\\mathbf{s}}, \\mathbf{s} \\in \\mathcal{S}\\}')
('11.0', '\\mathbf{s}_0 \\in \\mathcal{S}')
('11.0', '\\mathbf{s}\\neq \\mathbf{s}_0')
('11.0', '\\epsilon_{\\mathbf{s}} = D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s})\\| \\pi_\\beta(\\cdot|\\mathbf{s}))')
('11.0', '\\epsilon_{\\mathbf{s}_0} = \\epsilon - \\int_{\\mathbf{s}\\in\\mathcal{S}, \\mathbf{s}\\neq \\mathbf{s}_0} d_{\\pi_\\beta}(\\mathbf{s})D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s}_0)\\| \\pi_\\beta(\\cdot|\\mathbf{s}_0))\\mathrm{d}\\mathbf{s}')
('11.0', '\\int_{\\mathbf{s}\\in\\mathcal{S}}d_{\\pi_\\beta}(\\mathbf{s})\\epsilon_{\\mathbf{s}}\\mathrm{d}\\mathbf{s}=\\epsilon')
('11.0', 'D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s}_0)\\| \\pi_\\beta(\\cdot|\\mathbf{s}_0)) > \\epsilon_{\\mathbf{s}_0}')
('11.0', '\\begin{aligned}\n\\epsilon = &\\quad \\int_{\\mathbf{s}\\in\\mathcal{S}}d_{\\pi_\\beta}(\\mathbf{s})\\epsilon_{\\mathbf{s}}\\mathrm{d}\\mathbf{s} \\nonumber\\\\\n=&\\quad d_{\\pi_\\beta}(\\mathbf{s}_0)\\epsilon_{\\mathbf{s}_0} + \\int_{\\mathbf{s}\\in\\mathcal{S}, \\mathbf{s}\\neq\\mathbf{s}_0}d_{\\pi_\\beta}(\\mathbf{s})\\epsilon_{\\mathbf{s}}\\mathrm{d}\\mathbf{s} \\nonumber\\\\\n<&\\quad d_{\\pi_\\beta}(\\mathbf{s}_0)D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s}_0)\\| \\pi_\\beta(\\cdot|\\mathbf{s}_0)) \\nonumber\n+ \\int_{\\mathbf{s}\\in\\mathcal{S}, \\mathbf{s}\\neq\\mathbf{s}_0}d_{\\pi_\\beta}(\\mathbf{s})D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s})\\| \\pi_\\beta(\\cdot|\\mathbf{s}))\\mathrm{d}\\mathbf{s} \\nonumber\\\\\n=&\\quad \\int_{\\mathbf{s}\\in\\mathcal{S}}d_{\\pi_\\beta}(\\mathbf{s})D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s})\\| \\pi_\\beta(\\cdot|\\mathbf{s}))\\mathrm{d}\\mathbf{s}.\\nonumber\n\\end{aligned}')
('11.0', '\\int_{\\mathbf{s}\\in \\mathcal{S}} d_{\\pi_\\beta(\\mathbf{s})} D_{\\text{KL}}(\\pi(\\cdot|\\mathbf{s})\\| \\pi_\\beta(\\cdot|\\mathbf{s})) \\mathrm{d}\\mathbf{s} \\le \\epsilon')
('11.0', '\\nRightarrow')
('11.0', '\\Rightarrow')
('11.0', '\\mathcal{F}^k(\\epsilon)')
('11.0', '\\mathcal{F}^k(\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\})')
('11.0', '\\mathcal{F}^k(\\epsilon) = \\bigcup_{\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\} \\in C } \\mathcal{F}^k(\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}).')
('11.0', '~\\label{eq: feasible region}\n    \\forall \\epsilon \\ge 0, \\quad \\exists \\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\} \\in C,  \\quad  \\pi^{k+1}_*[\\epsilon] \\in \\mathcal{F}^k(\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}),')
('11.0', '\\pi^{k+1}_*[\\epsilon]')
('11.0', 'J_*^k[\\epsilon]')
('11.0', '\\forall \\epsilon \\ge 0, \\quad \\exists \\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\} \\in C, \\quad \\exists \\pi \\in \\mathcal{F}^k(\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}), \\quad  J^k_\\pi[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}] \\ge J_*^k[\\epsilon].')
('11.0', 'J^k_\\pi[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}]')
('11.0', '\\pi')
('11.0', '\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}')
('11.0', '\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}')
('11.0', 'J_*^k[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}]')
('11.0', 'J^k_\\pi[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}]')
('11.0', '\\exists \\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}, \\quad  J_*^k[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}] \\ge J^k_\\pi[\\{\\epsilon_\\mathbf{s}, \\mathbf{s}\\in \\mathcal{S}\\}] \\ge  J_*^k[\\epsilon].')
('11.1', '\\mathcal{S}')
('11.1', '\\mathcal{S}=\\{\\mathbf{s}_1, \\mathbf{s}_2, \\cdots, \\mathbf{s}_m\\}')
('11.1', '\\begin{aligned}\n\\max_{\\pi} &\\ \\  \\mathbb{E}_{\\mathbf{s}\\sim d_{\\pi_\\beta}(\\cdot), \\mathbf{a}\\sim \\pi(\\cdot|\\mathbf{s})} \\left[Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s})\\right] \\label{eq: simplified optimization problem}\\\\\n\\text { s.t. } & D_{\\mathrm{KL}}(\\pi(\\cdot | \\mathbf{s}_i) \\| \\pi_{\\beta}(\\cdot | \\mathbf{s}_i)) \\leq \\epsilon_i, \\quad i=1, 2, \\cdots, m \\label{eq: simplified kl constraint}\\\\\n & \\int_{\\mathbf{a}\\in\\mathcal{A}} \\pi(\\mathbf{a}| \\mathbf{s}_i) \\mathop{}\\!\\mathrm{d}\\mathbf{a}=1, \\quad i=1, 2, \\cdots, m \\label{eq: simplified normalization constraint}.\n\\end{aligned}')
('11.1', '\\pi^k (k\\in \\mathbb{N})')
('11.1', 'k')
('11.1', '\\pi_\\beta')
('11.1', 'd_{\\pi_{\\beta}}(\\mathbf{s})')
('11.1', '\\pi_\\beta')
('11.1', '\\pi^{k+1}')
('11.1', '\\pi^{k+1}')
('11.1', '\\pi_*^{k+1}')
('11.1', '\\forall \\mathbf{s}\\in \\{\\mathbf{s}_1, \\mathbf{s}_2, \\cdots, \\mathbf{s}_m\\}, \\mathbf{a}\\in \\mathcal{A}')
('11.1', '\\pi_*^{k+1}(\\mathbf{a}|\\mathbf{s}) = \\frac{\\pi_\\beta(\\mathbf{a}|\\mathbf{s})}{Z_{\\mathbf{s}}} \\exp\\left(\\beta_{\\mathbf{s}}(Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}))\\right).\n    \\label{eq: simplified adaptive optimal policy}')
('11.1', 'L(\\pi, \\mathbf{\\lambda}, \\mathbf{\\mu})')
('11.1', '\\begin{aligned}\n    L(\\pi, \\mathbf{\\lambda}, \\mathbf{\\mu})  =& -\\mathbb{E}_{\\mathbf{s}\\sim d_{\\pi_\\beta}(\\cdot), \\mathbf{a}\\sim \\pi(\\cdot|\\mathbf{s})} \\left[Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s})\\right] \\\\\n    & + \\sum_{i=1}^m \\lambda_i \\Big(\\int_{\\mathbf{a}} \\pi(\\mathbf{a}|\\mathbf{s}_i) \\mathop{}\\!\\mathrm{d}\\mathbf{a}- 1\\Big)  + \\sum_{i=1}^m \\mu_i \\Big( D_{\\mathrm{KL}}(\\pi(\\cdot | \\mathbf{s}_i) \\| \\pi_{\\beta}(\\cdot | \\mathbf{s}_i)) - \\epsilon_i \\Big),\n\\end{aligned}')
('11.1', '\\mathbf{\\lambda} = (\\lambda_1, \\lambda_2, \\cdots, \\lambda_m), \\mathbf{\\mu} = (\\mu_1, \\mu_2, \\cdots, \\mu_m)')
('11.1', '\\forall \\mathbf{a}\\in \\mathcal{A}, i \\in \\{ 1, 2, \\cdots, m\\}')
('11.1', '\\begin{aligned}\n    \\frac{\\partial L}{\\partial \\pi(\\mathbf{a}|\\mathbf{s}_i)} &= -d_{\\pi_{\\beta}}(\\mathbf{s}_i) \\left(Q^{\\pi^k}(\\mathbf{s}_i, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}_i)\\right) + \\lambda_i  + \\mu_i \\left(\\log\\left(\\frac{\\pi(\\mathbf{a}|\\mathbf{s}_i)}{\\pi_{\\beta}(\\mathbf{a}|\\mathbf{s}_i)}\\right) + 1\\right) = 0.\n\\end{aligned}')
('11.1', '\\pi^{k+1}_*')
('11.1', '\\begin{aligned}\n    \\pi_*^{k+1}(\\mathbf{a}|\\mathbf{s}_i) = \\frac{\\pi_\\beta(\\mathbf{a}|\\mathbf{s}_i)}{Z_{\\mathbf{s}_i}} \\exp\\left(\\beta_{\\mathbf{s}_i}(Q^{\\pi^k}(\\mathbf{s}_i, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}_i))\\right),\n    %&\\exp(-\\frac{\\lambda_i}{\\mu_i} - 1)\n\\end{aligned}')
('11.1', 'Z_{\\mathbf{s}_i} = \\exp\\left(\\frac{\\lambda_i}{\\mu_i} + 1\\right), \\beta_{\\mathbf{s}_i} = \\frac{d_{\\pi_\\beta}(\\mathbf{s}_i)}{\\mu_i}')
('11.1', 'Z_{\\mathbf{s}_i}')
('11.1', '\\int_{\\mathbf{a}\\in\\mathcal{A}} \\pi_\\beta(\\mathbf{a}|\\mathbf{s}_i) \\exp\\left(\\beta_{\\mathbf{s}_i}(Q^{\\pi^k}(\\mathbf{s}_i, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}_i))\\right) \\mathop{}\\!\\mathrm{d}\\mathbf{a}')
('11.1', '\\mathcal{S} = [s_{\\min}, s_{\\max}]^l')
('11.1', '\\mathcal{S} = [0, 1]')
('11.1', '\\mathcal{S} = [s_{\\min}, s_{\\max}]^l')
('11.1', '\\{B_i, i=0,1,2,\\cdots\\}')
('11.1', 'B_i = \\{ j/2^{i}, j=0, 1, \\cdots, 2^{i}\\}')
('11.1', '\\{B_i, i=0,1,2,\\cdots\\}')
('11.1', '\\begin{aligned}\n    &\\forall i \\in \\mathbb{N}_+, \\quad B_i \\subseteq \\mathcal{S}; \\label{eq: Bi first satisfaction}\\\\\n     &\\forall i \\in \\mathbb{N}_+, \\quad B_i \\subseteq B_{i+1};\\\\\n     & \\forall i \\in \\mathbb{N}_+, \\quad |B_i| = 2^i + 1 < \\infty, \\quad \\text{\\textit{i.e.}, all $B_i$ are finite sets, and therefore all $B_i$ are compact};\\\\\n     & \\lim_{i\\to\\infty} \\sup_{x\\in \\mathcal{S}} \\inf_{y\\in B_i} \\| x - y \\|_{\\infty} = \\lim_{i\\to\\infty} \\frac{1}{2^{i+1}} = 0.\\label{eq: Bi last satisfaction}\n\\end{aligned}')
('11.1', '\\mathbf{s}\\in \\mathcal{S}')
('11.1', '\\pi_*^{k+1}[A]')
('11.1', '\\begin{aligned}\n\\pi_*^{k+1}[A] = &\\underset{\\pi}{\\arg \\max }  \\mathbb{E}_{\\mathbf{s}\\sim d_{\\pi_\\beta}(\\cdot), \\mathbf{a}\\sim \\pi(\\cdot|\\mathbf{s})} \\left[Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s})\\right]\\\\\n\\text { s.t. } & D_{\\mathrm{KL}}(\\pi(\\cdot | \\mathbf{s}) \\| \\pi_{\\beta}(\\cdot | \\mathbf{s})) \\leq \\epsilon_\\mathbf{s}, \\quad \\mathbf{s}\\in A\\\\\n & \\int_{\\mathbf{a}\\in\\mathcal{A}} \\pi(\\mathbf{a}| \\mathbf{s}) \\mathop{}\\!\\mathrm{d}\\mathbf{a}=1, \\quad  \\mathbf{s}\\in A,\n\\end{aligned}')
('11.1', 'A')
('11.1', '\\mathcal{S}')
('11.1', '\\pi_*^{k+1}[B_i] \\xrightarrow{i \\to \\infty} \\pi_*^{k+1}[\\mathcal{S}].\n    \\label{eq: policy extreme}')
('11.1', 'B_i')
('11.1', '|B_i|<\\infty')
('11.1', '\\pi_*^{k+1}[B_i]')
('11.1', '\\pi_{\\mathbf{\\phi}}')
('11.1', '\\pi_*^{k+1}')
('11.1', '\\begin{aligned}\n    \\mathbf{\\phi} &= \\underset{\\mathbf{\\phi}}{\\arg \\min } \\mathbb{E}_{\\mathbf{s}\\sim d_{\\pi_\\beta}(\\cdot)}\\left[D_{\\mathrm{KL}}(\\pi_*^{k+1} (\\cdot|\\mathbf{s}) \\| \\pi_{\\mathbf{\\phi}}(\\cdot|\\mathbf{s}))\\right] \\\\\n    &=\\underset{\\phi}{\\arg \\max }\\mathbb{E}_{\\mathbf{s}\\sim d_{\\pi_\\beta}(\\cdot)} \\left[ \\frac{1}{Z_{\\mathbf{s}}}  \\mathbb{E}_{\\mathbf{a}\\sim \\pi_\\beta(\\mathbf{a}|\\mathbf{s})} \\left[ \\exp(\\beta_{\\mathbf{s}} (Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}))) \\log \\pi_{\\mathbf{\\phi}}(\\mathbf{a}|\\mathbf{s}) \\right] \\right].\\label{eq: approximate to the optimal policy}\n\\end{aligned}')
('11.1', 'Z_{\\mathbf{s}}')
('11.1', '\\frac{1}{Z_{\\mathbf{s}}}')
('11.1', '\\begin{aligned}\n    \\mathbf{\\phi} &= \\underset{\\phi}{\\arg \\max } \\mathbb{E}_{\\mathbf{s}\\sim d_{\\pi_\\beta}(\\cdot)}\\left[\\mathbb{E}_{\\mathbf{a}\\sim \\pi_\\beta(\\mathbf{a}|\\mathbf{s})} \\left[  \\exp(\\beta_{\\mathbf{s}} (Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}))) \\log \\pi_{\\mathbf{\\phi}}(\\mathbf{a}|\\mathbf{s}) \\right] \\right] \\\\\n    & = \\underset{\\phi}{\\arg \\max }\\mathbb{E}_{(\\mathbf{s}, \\mathbf{a})\\sim \\mathcal{D}} \\left[ \\exp(\\beta_{\\mathbf{s}} (Q^{\\pi^k}(\\mathbf{s}, \\mathbf{a})-V^{\\pi^k}(\\mathbf{s}))) \\log \\pi_{\\mathbf{\\phi}}(\\mathbf{a}|\\mathbf{s}) \\right].\n\\end{aligned}')
('12', '\\pi^{k+1} = \\underset{\\pi}{\\arg \\max } \\mathbb{E}_{\\mathbf{s}\\sim \\mathcal{D}, \\mathbf{a}\\sim \\pi(\\cdot|\\mathbf{s})} \\left[ \\alpha \\cdot {\\color{blue}Q^{k}(\\mathbf{s}, \\mathbf{a})} - {\\color{red}\\log\\pi(\\mathbf{a}| \\mathbf{s})}  \\right],\n\\label{eq: cql policy update}')
('12', '\\pi^k')
('12', 'Q^k')
('12', 'k')
('12', '\\alpha')
('12', '\\alpha')
('12', '\\begin{aligned}\n    &\\pi^{k+1}_u = \\underset{\\pi_u}{\\arg \\max } \\mathbb{E}_{\\mathbf{s}\\sim \\mathcal{D}, \\mathbf{a}\\sim \\pi_u(\\cdot|\\mathbf{s}, {\\color{red}\\alpha_\\mathbf{s}})} \\left[ {\\color{blue}\\alpha_\\mathbf{s}} \\cdot  Q^k(\\mathbf{s}, \\mathbf{a}) -\\log\\pi_u(\\mathbf{a}| \\mathbf{s}, {\\color{red}\\alpha_\\mathbf{s}})  \\right], \\label{eq: cql with FamO2O} \\\\\n    &\\text{where}\\quad \\alpha_\\mathbf{s}= \\pi_b^k(\\mathbf{s}),\n\\end{aligned}')
('12', '\\pi_u')
('12', '\\pi_b')
('12', '\\alpha_\\mathbf{s}')
('12', '\\alpha')
('12', '\\alpha_\\mathbf{s}')
('12', '\\pi_b^{k+1} = \\underset{\\pi_b}{\\arg \\max } \\mathbb{E}_{\\mathbf{s}\\sim\\mathcal{D}} \\Big[Q^k(\\mathbf{s}, \\underbrace{\\pi_u^{k+1}(\\mathbf{s}, \\overbrace{\\pi_b(\\mathbf{s})}^{\\mathclap{\\text{balance coefficient }\\beta_\\mathbf{s}}})}_{\\text{action}})\\Big].\n    \\label{eq: family cql balance model update}')
('12', '\\pi_b: \\mathcal{S}\\mapsto\\mathcal{B}')
('12', '\\pi_u: \\mathcal{S}\\times \\mathcal{B}\\mapsto \\mathcal{A}')
('12', '\\pi_u(\\cdot, \\pi_b(\\cdot)): \\mathcal{S}\\mapsto \\mathcal{A}')
('13.0', '10^6')
('13.0', '2.5\\times 10^4')
('13.0', '2\\times 10^6')
('13.0', '1\\times 10^6')
('13.1', 'l')
('13.1', 'l + l_b')
('13.1', 'l_b')
('13.1', '1.0')
('13.1', '8.0')
('13.1', '5.0')
('13.1', '14.0')
('13.1', '2.0')
('13.1', '9.0')
('13.1', '3.0')
('13.1', '11.0')
('13.1', '0.5')
('13.1', '1.5')
('13.1', '10^6')
('13.1', '10^6')
('13.1', '7.5\\times 10^4')
('13.1', '2\\times 10^5')
('13.1', '1\\times 10^6')
('13.1', '2\\times 10^6')
('13.1', '1\\times 10^6')
('14.0', '[1, 5]')
('14.0', '[1, 4]')
('14.0', '[2, 4]')
('14.0', '[6, 12]')
('14.0', '[8, 12]')
('14.0', '[8, 14]')
('14.0', '[9, 11]')
('14.0', '[1, 5]')
('14.0', '[1, 4]')
('14.0', '[2, 4]')
('14.0', '[6, 12]')
('14.0', '[8, 12]')
('14.0', '[8, 14]')
('14.0', '[9, 11]')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', 'Q')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', 'Q')
('15', '5\\times 10^{-3}')
('15', 'V')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', 'V')
('15', '5\\times 10^{-3}')
('15', '2 \\times 10^6')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', '3\\times 10^{-4}')
('15', '[256, 256, 256, 256]')
('15', '1\\times 10^4')
('15', 'Q')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', 'Q')
('15', '5\\times 10^{-3}')
('15', '2 \\times 10^6')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', '3\\times 10^{-4}')
('15', '[256, 256]')
('15', 'Q')
('15', '5\\times 10^{-3}')
('15', '2 \\times 10^6')
