('1', '_2')
('2', '0')
('3.0', '\\bm{\\mathcal{T}} \\in \\mathbb{R}^{\\mathbf{i}_0\\times \\mathbf{i}_1  \\times \\mathbf{i}_2}')
('3.0', '\\bm{\\mathcal{M}}\\in\\mathbb{R}^{\\mathbf{i}_0\\times \\mathbf{i}_1  \\times \\mathbf{i}_2}')
('3.0', '\\bm{\\mathcal{N}}\\in\\mathbb{R}^{\\mathbf{j}_0\\times \\mathbf{j}_1 \\times \\mathbf{j}_2}')
('3.0', '\\mathbb{R}^{\\mathbf{i}_0\\times \\mathbf{i}_1 \\times \\mathbf{j}_2 \\times \\mathbf{j}_3}')
('3.0', '\\mathbf{i}_2 = \\mathbf{j}_0 \\triangleq e_0')
('3.0', '(\\bm{\\mathcal{M}}\\times_{2}^{0}\\bm{\\mathcal{N}})_{i_0, i_1, j_2, j_3} \n= \\sum_{m=0}^{e_0 - 1} \\bm{\\mathcal{M}}_{i_0, i_1, m}\\bm{\\mathcal{N}}_{m, j_2, j_3}.')
('3.0', '2N')
('3.0', '\\bm{\\mathcal{X}} \\in\\mathbb R^{I_1\\times J_1 \\times I_2 \\times J_2 \\ldots I_N \\times J_N}')
('3.0', '\\begin{aligned}\n\\label{eq:TN:MPOTTD}\n\t \\bm{\\mathcal{X}}_{i_1,j_1,i_2,j_2\\ldots,i_N,j_N} \\approx \\sum_{r_{1},r_{2},\\ldots,r_{N}=1}^{R_1,R_2,\\ldots,R_{N}} \\bm{\\mathcal{G}}^{(1)}_{r_1,i_1,j_1,r_2}  \\bm{\\mathcal{G}}^{(2)}_{r_2,i_2,j_2,r_3} \\bm{\\mathcal{G}}^{(3)}_{r_3,i_3,j_3,r_4}\\cdots  \\bm{\\mathcal{G}}^{(N)}_{r_{N},i_N,j_N,r_1},\n\\end{aligned}')
('3.0', '\\{R_1,R_2,\\ldots,R_{N}\\}')
('3.0', '\\bm{\\mathcal{G}}^{(n)}\\in \\mathbb R^{R_{n}\\times I_n\\times I_n \\times R_{n+1}}')
('3.0', 'R_1=R_{N+1}')
('3.0', '\\mathbf{Q} \\in \\mathbb{R}^{I}')
('3.0', '\\mathbf{K} \\in \\mathbb{R}^{I}')
('3.0', '\\mathbf{V} \\in \\mathbb{R}^{I}')
('3.0', '\\mathbf{W}^Q \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}^{K} \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}^V \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}^{O} \\in \\mathbb{R}^{I\\times O}')
('3.0', 'I = O')
('3.0', 'n')
('3.0', '\\{\\mathbf{W}^{Q, i}\\}^n, \\{\\mathbf{W}^{K, i}\\}^n, \\{\\mathbf{W}^{V, i}\\}^n, \\{\\mathbf{W}^{O, i}\\}^n')
('3.0', '\\begin{aligned}\n&\\operatorname{Att}_i(\\mathbf{Q}, \\mathbf{K}, \\mathbf{V}) = \\operatorname{softmax}\\left(\\frac{\\mathbf{Q}\\mathbf{W}^{Q, i}(\\mathbf{K}\\mathbf{W}^{K, i})^{T}}{\\sqrt{d_k}}\\right) \\mathbf{V}\\mathbf{W}^{V, i}\\mathbf{W}^{{O, i}^T}, \\notag \\\\\n&\\operatorname{MHSA}((\\mathbf{Q}, \\mathbf{K}, \\mathbf{V})) = \\sum^n_{i=1}{\\operatorname{Att}_i(\\mathbf{Q}, \\mathbf{K}, \\mathbf{V})},\n\\end{aligned}')
('3.0', 'd_k')
('3.0', '\\mathbf{W}^{Q, i}')
('3.0', '\\mathbf{W}^{K, i}')
('3.0', '\\mathbf{W}^{V, i}')
('3.0', '\\mathbf{W}^{O, i}')
('3.0', '\\mathbf{X} \\in \\mathbb{R}^{I}')
('3.0', '\\mathbf{W}^{IN} \\in \\mathbb{R}^{I\\times kO}')
('3.0', '\\mathbf{W}^{OUT} \\in \\mathbb{R}^{kI\\times O}')
('3.0', 'I=O')
('3.0', 'k')
('3.0', '\\begin{aligned}\n\\operatorname{FFN}(\\mathbf{X}) = \n\\operatorname{GeLU}(\\mathbf{X}\\mathbf{W}^{IN})\\mathbf{W}^{OUT}.\n\\end{aligned}')
('3.0', '\\mathbf{W}^Q, \\mathbf{W}^{K}, \\mathbf{W}^V, \\mathbf{W}^{O}')
('3.0', '\\mathbf{W}^{IN}')
('3.0', '\\mathbf{W}^{OUT}')
('3.0', '\\mathbf{W}^Q, \\mathbf{W}^{K}, \\mathbf{W}^V, \\mathbf{W}^{O}')
('3.0', '\\mathbf{W}^{IN}')
('3.0', '\\mathbf{W}^{OUT}')
('3.0', 'I')
('3.0', 'O')
('3.0', 'L')
('3.0', '\\bm{\\mathcal{M}}')
('3.0', '\\bm{\\mathcal{S}}')
('3.0', '\\bm{\\mathcal{S}}')
('3.0', '\\{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L\\}')
('3.0', '\\Phi_{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L}')
('3.1', 'L')
('3.1', 'D')
('3.1', '\\mathbf{M}(L, D)')
('3.1', 'j')
('3.1', '\\bm{\\theta}_j = \\{\\mathbf{W}_j^Q \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}_j^{K} \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}_j^V \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}_j^{O} \\in \\mathbb{R}^{I\\times O}, \\mathbf{W}_j^{IN} \\in \\mathbb{R}^{I\\times kO}, \\mathbf{W}_j^{OUT} \\in \\mathbb{R}^{kI\\times O}\\}')
('3.1', 'j \\in [L]')
('3.1', 'I=O=D')
('3.1', '\\mathbf{M}(L, D)')
('3.1', '\\bm{\\theta}^{L, D} = \\{\\theta_j\\}^{L}_{j=1}')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', '\\Phi_{\\bm{\\mathcal{S}}}')
('3.1', '\\mathbf{M}(L_1, D_1)\\rightarrow \\mathbf{M}(L_2, D_2)')
('3.1', '\\bm{\\theta}^{L_2, D_2} = \\Phi_{\\bm{\\mathcal{S}}}(\\bm{\\theta}^{L_1, D_1})')
('3.1', 'L_1 < L_2')
('3.1', '\\bm{\\theta}^{L_2, D_2}')
('3.1', 'j')
('3.1', '{B\\times I\\times O}')
('3.1', 'I')
('3.1', 'O')
('3.1', 'B=2k+4')
('3.1', '\\bm{\\mathcal{M}}\\in \\mathbb{R}^{B\\times I\\times O \\times L}')
('3.1', 'L')
('3.1', '\\bm{\\mathcal{M}}_1\\in \\mathbb{R}^{B_2\\times I_1\\times O_1 \\times L_1}')
('3.1', '\\bm{\\mathcal{M}}_2\\in \\mathbb{R}^{B_1\\times I_2\\times O_2 \\times L_2}')
('3.1', '\\bm{\\mathcal{S}}\\in \\mathbb{R}^{B_1\\times I_1\\times O_1 \\times L_1\\times B_2\\times I_2\\times O_2 \\times L_2}')
('3.1', '\\Phi_{\\bm{\\mathcal{S}}}')
('3.1', '\\bm{\\mathcal{M}}_1')
('3.1', '\\bm{\\mathcal{M}}_2')
('3.1', '\\begin{aligned}\n\\label{eq:full}\n    (\\bm{\\mathcal{M}}_2)_{b_2,i_2,o_2,l_2} = \\sum\\limits_{b_1,i_1,o_1,l_1}(\\bm{\\mathcal{M}}_1)_{b_1,i_1,o_1,l_1} \\bm{\\mathcal{S}}_{b_1,i_1,o_1,l_1,b_2,i_2,o_2,l_2},\n\\end{aligned}')
('3.1', 'b_1')
('3.1', 'i_1')
('3.1', 'o_1')
('3.1', 'l_1')
('3.1', 'b_2')
('3.1', 'i_2')
('3.1', 'o_2')
('3.1', 'l_2')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', '\\{\\bm{\\mathcal{S}}_B \\in \\mathbb{R}^{R_1\\times B_1\\times B_2\\times R_2}, \\bm{\\mathcal{S}}_O \\in \\mathbb{R}^{R_2\\times O_1\\times O_2\\times R_3}, \\bm{\\mathcal{S}}_L \\in \\mathbb{R}^{R_3\\times L_1\\times L_2\\times R_4}, \\bm{\\mathcal{S}}_I \\in \\mathbb{R}^{R_4\\times I_1\\times I_2\\times R_1}\\}')
('3.1', 'R=\\{R_1, R_2, R_3, R_4\\}')
('3.1', '\\Phi_{\\bm{\\mathcal{S}}}')
('3.1', '\\Phi_{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L}')
('3.1', '\\begin{aligned}\n\\label{eq:trmpo}\n    (\\bm{\\mathcal{M}}_2)_{b_2,i_2,o_2,l_2} &= \\sum\\limits_{b_1,i_1,o_1,l_1,r_1,r_2,r_3,r_4}\\notag \\\\ \n    &(\\bm{\\mathcal{M}}_1)_{b_1,i_1,o_1,l_1} (\\bm{\\mathcal{S}}_B)_{r_1,b_1,b_2,r_2} (\\bm{\\mathcal{S}}_O)_{r_2,o_1,o_2,r_3} (\\bm{\\mathcal{S}}_L)_{r_3,l_1,l_2,r_4} (\\bm{\\mathcal{S}}_I)_{r_4,i_1,i_2,r_1}.\n\\end{aligned}')
('3.1', '\\bm{\\mathcal{S}}_B')
('3.1', '\\bm{\\mathcal{S}}_I')
('3.1', '\\bm{\\mathcal{S}}_O')
('3.1', '\\bm{\\mathcal{S}}_L')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', 'M_1')
('3.1', 'S_{\\ast}')
('3.1', '\\bm{\\mathcal{M}}_2')
('3.1', '\\begin{aligned}\n\\label{eq:target}\n\\min\\limits_{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L}\\mathbb{E}_{\\mathbf{X}\\sim\\mathcal{D}}\\bm{\\mathcal{L}}(\\mathbf{X}, \\bm{\\mathcal{M}}_2), ~~\\text{w.r.t}~~\\bm{\\mathcal{M}}_2=\\Phi_{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L}(\\bm{\\mathcal{M}}_1),\n\\end{aligned}')
('3.1', '\\bm{\\mathcal{L}}')
('3.1', '\\mathcal{D}')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', '\\theta^{L_1,D_1}')
('3.1', '\\mathbf{M}(L_1, D_1)')
('3.1', '\\bm{\\mathcal{M}}_1')
('3.1', '\\Phi_{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L}')
('3.1', '\\bm{\\mathcal{M}}_2')
('3.1', '\\Phi_{\\bm{\\mathcal{S}}_B,\\bm{\\mathcal{S}}_I,\\bm{\\mathcal{S}}_O,\\bm{\\mathcal{S}}_L}')
('3.1', '\\bm{\\mathcal{M}}_2')
('3.1', '\\theta^{L_2,D_2}')
('3.1', '\\mathbf{M}(L_2,D_2)')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', '\\bm{\\mathcal{S}}_B')
('3.1', '\\bm{\\mathcal{S}}_I')
('3.1', '\\bm{\\mathcal{S}}_O')
('3.1', '\\bm{\\mathcal{S}}_L')
('3.1', 'R')
('3.1', '\\bm{\\mathcal{S}}')
('3.1', 'R')
('3.2', '\\mathbf{M}(L_1, D_1)\\rightarrow \\mathbf{M}(L_2, D_2)')
('3.2', 'I_1=O_1=D_1')
('3.2', 'I_2=O_2=D_2')
('3.2', 'R=\\max(R_1, R_2, R_3, R_4)')
('3.2', '\\bm{\\mathcal{S}}_I')
('3.2', '\\bm{\\mathcal{S}}_O')
('3.2', '\\bm{\\mathcal{S}}_K')
('3.2', '2L_1D_1D_2+L_1L_2')
('3.2', '\\bm{\\mathcal{S}}_I')
('3.2', '\\bm{\\mathcal{S}}_O')
('3.2', '\\bm{\\mathcal{S}}_L')
('3.2', '2B_1D_1D_2+L_1L_2')
('3.2', '\\bm{\\mathcal{S}}_B')
('3.2', '\\bm{\\mathcal{S}}_I')
('3.2', '\\bm{\\mathcal{S}}_O')
('3.2', '\\bm{\\mathcal{S}}_L')
('3.2', '2RD_1D_2+R^2(B_1B_2+L_1L_2)')
('3.2', 'I_1')
('3.2', 'O_1')
('3.2', 'L_1')
('3.2', '\\bm{\\mathcal{S}}_K')
('3.2', 'I_1')
('3.2', 'O_1')
('3.2', 'B_1')
('3.2', '\\bm{\\mathcal{S}}_L')
('3.2', '\\bm{\\mathcal{S}}_I')
('3.2', '\\bm{\\mathcal{S}}_O')
('3.2', '\\bm{\\mathcal{S}}_L')
('3.2', '\\bm{\\mathcal{M}}_1')
('3.2', '\\bm{\\mathcal{S}}')
('3.2', 'R')
('3.2', '\\bm{\\mathcal{M}}_2')
('3.2', '\\bm{\\mathcal{S}}_K')
('3.2', '\\bm{\\mathcal{S}}_L')
('3.2', '\\bm{\\mathcal{S}}_B')
('4.0', '\\Psi')
('4.0', '\\xi_{Scratch}')
('4.0', '\\Psi')
('4.0', '\\xi_{\\ast}')
('4.0', 'r')
('4.0', 'r = \\frac{\\xi_{Scratch} - \\xi_{\\ast}}{\\xi_{Scratch}}.')
('4.1', '\\{1, 4, 7, 10\\}')
('8.1', '\\rightarrow')
('8.2', '\\rightarrow')
