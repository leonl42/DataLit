('1', 'Q')
('1', 't')
('1', 'Q')
('1', 'Q')
('2', 'M=(\\mathcal{S}, \\mathcal{A}, P, r, \\gamma, \\mu_0)')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}=\\{A_1,A_2,...,A_m\\}')
('2', "P(s'\\mid s,a)")
('2', "s, s'\\in \\mathcal{S}")
('2', 'a\\in \\mathcal{A}')
('2', 'r: \\mathcal{S}\\times\\mathcal{A}\\to [0,1]')
('2', '\\gamma\\in [0,1)')
('2', '\\mu_0')
('2', '\\mathcal{P}')
('2', 'P\\in\\mathcal{P}')
('2', 'r')
('2', '\\pi')
('2', '\\pi(\\cdot|s)')
('2', 's')
('2', '\\pi(\\cdot\\mid s)\\in \\Delta(\\mathcal{A}):=\\{p\\in\\mathbb{R}^m: \\sum_{i=1}^m p_i =1, p_i\\ge 0, \\forall i\\}')
('2', 's\\in\\mathcal{S}')
('2', '\\pi')
('2', 'P')
('2', 'V_P^\\pi(s):=\\mathbb{E}_{P,\\pi}[\\sum_{t=0}^{\\infty}\\gamma^t r(s_t, a_t)| s_0= s]')
('2', '\\pi')
('2', 'P')
('2', 's')
('2', 'r')
('2', 'V_P^\\pi:=\\mathbb{E}_{s\\sim \\mu_0}V_P^\\pi(s)')
('2', '\\mathcal{S}')
('2', '\\mu_0')
('2', 'Q')
('2', 'Q_P^{\\pi}(s, a)= \\mathbb{E}_{P,\\pi}[\\sum_{t=0}^{\\infty}\\gamma^t r(s_t, a_t)| s_0= s, a_0=a]')
('2', 'd_{P}^{\\pi}(s,a):= (1-\\gamma)\\sum_{t=0}^{\\infty} \\gamma^t\\text{Pr}(s_t=s, a_t=a| s_0\\sim \\mu_0)')
('2', '\\pi')
('2', 'P')
('2', 'V^\\pi_P')
('2', '\\mathbb{E}_{(s,a)\\sim d_{P}^{\\pi}}[r(s,a)]')
('2', "\\mathcal{D}_n= \\{(s_i,a_i,r_i,s_i'): i=1,...,n\\}")
('2', 'P^*')
('2', 'V^\\pi_{P^*}')
('2', '\\rho(s, a)')
('2', '(s_i,a_i)_{i=1}^n')
('2', '\\sup_{s,a}d_{P^*}^{\\pi}(s,a)/\\rho(s,a)< \\infty')
('2', '\\pi')
('2', '\\pi^\\dagger')
('2', '\\sup_{s,a} d_{P^*}^{\\pi^\\dagger}(s,a)/\\rho(s,a)< \\infty')
('2', '\\Pi:=\\{\\pi: \\sup _{s, a} d_{p^*}^\\pi(s, a) / \\rho(s, a)<\\infty\\}')
('3', '\\{\\eta_t\\}_{t=1}^T')
('3', '\\widehat{P}')
('3', '\\alpha_n')
('3', '\\pi_0(\\cdot|s)=\\mathrm{Unif}(\\mathcal{A})')
('3', 'P_t= \\text{argmin}_{P\\in \\mathcal{P}_{n,\\alpha_n}} V_P^{\\pi_t}')
('3', '\\mathcal{P}_{n,\\alpha_n}=\\{P\\in\\mathcal{P}: \\mathcal{E}_n(P)\\le \\alpha_n\\}.')
('3', '\\pi_{t+1}(\\cdot\\mid s) =\\underset{p \\in \\Delta(\\mathcal{A})}{\\arg \\max }\\left\\{\\langle Q_{P_t}^{\\pi_t}(s, \\cdot),p\\rangle-\\frac{1}{\\eta_t} D\\left(\\pi_t(\\cdot\\mid s), p\\right)\\right\\}, \\forall s.')
('3.0', '\\mathcal{P}_{n,\\alpha_n}=\\{P\\in\\mathcal{P}: \\mathcal{E}_n(P)\\le \\alpha_n\\}')
('3.0', '\\mathcal{E}_n(P):=\\widehat{L}_n(P)-\\widehat{L}_n(\\widehat{P})')
('3.0', '\\widehat{L}_n: \\mathcal{P}\\to \\mathbb{R}^+')
('3.0', 'P')
('3.0', '\\mathcal{D}_n')
('3.0', '\\widehat{P}=\\arg\\min_{P\\in\\mathcal{P}} \\widehat{L}_n(P)')
('3.0', '\\widehat{L}_n')
('3.0', '\\widehat{L}_n(P)')
('3.0', 'P')
('3.0', '\\widehat{P}')
('3.0', 'P')
('3.0', '\\alpha_n')
('3.0', 'P_t')
('3.0', 'V_P^{\\pi_t}')
('3.0', '\\mathcal{P}_{n,\\alpha_n}')
('3.0', '\\begin{aligned}\n\\label{equa: constrained}\nP_t= &\\text{argmin}_{P\\in \\mathcal{P}_{n,\\alpha_n}} V_P^{\\pi_t}.\n\\end{aligned}')
('3.0', 'P_t')
('3.0', '\\pi_t')
('3.0', 'Q^{\\pi_t}_{P_t}')
('3.0', 'Q')
('3.0', 'Q')
('3.0', 'Q')
('3.0', 'Q')
('3.0', 'Q')
('3.0', 'Q')
('3.0', 'Q')
('3.1', 'Q')
('3.1', 'D(\\cdot,\\cdot)')
('3.1', '\\|\\cdot\\|')
('3.1', '\\Delta(\\mathcal{A})')
('3.1', '\\omega: \\Delta(\\mathcal{A}) \\rightarrow \\mathbb{R}')
('3.1', '\\|\\cdot\\|')
('3.1', 'D(\\cdot,\\cdot)')
('3.1', '\\begin{aligned}\nD\\left(p, p\\prime\\right):=\\omega\\left(p\\prime\\right)-\\left[\\omega\\left(p\\right)+\\left\\langle \\nabla\\omega\\left(p\\right), p\\prime-p\\right\\rangle\\right] \\geq \\frac{1}{2}\\left\\|p\\prime-p\\right\\|^2, \\forall p, p\\prime \\in \\Delta(\\mathcal{A}),\n\\end{aligned}')
('3.1', '\\langle\\cdot,\\cdot\\rangle')
('3.1', 'Q_{P_t}^{\\pi_t}(s, \\cdot)\\in \\mathbb{R}^m')
('3.1', 'i')
('3.1', 'Q_{P_t}^{\\pi_t}(s, A_i)')
('3.1', '\\eta_t>0')
('3.1', '\\begin{aligned}\n\\label{equ: policy update}\n\\pi_{t+1}(\\cdot\\mid s) =\\underset{p \\in \\Delta(\\mathcal{A})}{\\arg \\max }\\left\\{\\langle Q_{P_t}^{\\pi_t}(s, \\cdot),p\\rangle-\\frac{1}{\\eta_t} D\\left(\\pi_t(\\cdot\\mid s), p\\right)\\right\\} \\quad \\forall s.  \\end{aligned}')
('3.1', 'D(\\cdot,\\cdot)')
('3.1', 'S')
('4', '\\eta_t')
('4', '\\mathcal{P}_{n,\\alpha_n}')
('4', '\\pi_0=\\mathrm{Unif}(\\mathcal{A})')
('4', 'P_t:= P_{\\phi^{(K)}}')
('4', '\\phi^{(K)}')
('4', '\\{s_j\\}_{j=1}^N')
('4', 'd_{P_t}^{\\pi_t}')
('4', '\\{f_{t-1,i}(s;\\widehat{\\beta}_{t-1,i})\\}_{i=1}^m')
('4', 's_j')
('4', '\\{\\Tilde{Q}_{\\omega,t}(s_j,A_i)\\}_{i=1}^m')
('4', '\\widehat{\\beta}_{t,i}')
('4', 'i=1,...,m')
('4', '\\{f_{t,i}(s;\\widehat{\\beta}_{t,i})\\}_{i=1}^m')
('4', 't+1')
('4.0', '\\label{alg: constrained}\n\\max_{\\lambda>0}\\min_{P\\in\\mathcal{P}} V_P^{\\pi_t} + \\lambda(\\mathcal{E}_n(P)-\\alpha_n).')
('4.0', 'P')
('4.0', '\\phi')
('4.0', 'P_\\phi')
('4.0', '\\begin{aligned}\n\\label{algo: PD}\n& \\phi^{(k+1)}=\\phi^{(k)}-\\kappa_1 \\nabla_\\phi \\mathcal{L}_{V,t}(\\phi^{(k)},\\lambda^{(k)}) , \\quad \\lambda^{(k+1)}=\\operatorname{Proj}_{\\Lambda}\\left(\\lambda^{(k)}+\\kappa_2\\left(\\mathcal{E}_n(P_\\phi)-\\alpha_n\\right)\\right).\n\\end{aligned}')
('4.0', '\\operatorname{Proj}_{\\Lambda}')
('4.0', '\\Lambda')
('4.0', '\\lambda')
('4.0', '\\mathcal{L}_{V,t}(\\phi^{(k)},\\lambda^{(k)})')
('4.0', 'V_{P_{\\phi^{(k)}}}^{\\pi_t} + \\lambda^{(k)}(\\mathcal{E}_n(P_{\\phi^{(k)}})-\\alpha_n)')
('4.0', '\\nabla_\\phi \\mathcal{L}_{V,t}(\\phi^{(k)},\\lambda^{(k)})')
('4.1', '\\pi_{t+1}(\\cdot\\mid s)')
('4.1', 's')
('4.1', 'Q_{P_t}^{\\pi_t}')
('4.1', '\\pi_t(\\cdot\\mid s)')
('4.1', 's')
('4.1', 'Q_{P_t}^{\\pi_t}')
('4.1', 'T')
('4.1', 'T')
('4.1', 'D(\\pi_t(\\cdot \\mid s),p)')
('4.1', '\\langle Q_{P_t}^{\\pi_t}(s, \\cdot),p\\rangle+\\frac{1}{\\eta_t}\\left\\langle \\nabla\\omega\\left(\\pi_t(\\cdot\\mid s)\\right),p\\right\\rangle-\\frac{1}{\\eta_t} \\omega(p)')
('4.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,p):=\\sum_{i=1}^m \\Tilde{Q}_{\\omega,t}(s,A_i)p_i = \\left\\langle \\Tilde{Q}_{\\omega,t}(s,\\cdot), p\\right\\rangle')
('4.1', '\\Tilde{Q}_{\\omega,t}(s,A_i):=Q_{P_t}^{\\pi_t}(s, A_i)+\\frac{1}{\\eta_t}\\nabla\\omega(\\pi_t(\\cdot\\mid s))_i')
('4.1', '\\Tilde{Q}_{\\omega,t}(s,\\cdot)')
('4.1', 'i')
('4.1', '\\Tilde{Q}_{\\omega,t}(s,A_i)')
('4.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,p)')
('4.1', 'f_t(s,p;\\beta_t)\\in\\mathcal{F}_t')
('4.1', 'f_t(s,p;\\beta_t^*)\\approx \\Tilde{\\mathcal Q}_{\\omega,t}(s,p)')
('4.1', '\\beta_t^*')
('4.1', '\\Tilde{Q}_{\\omega,t}(s,A_i)')
('4.1', 'A_i')
('4.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,p)= \\left\\langle \\Tilde{Q}_{\\omega,t}(s,\\cdot), p\\right\\rangle')
('4.1', 'i=1,...,m')
('4.1', 'f_{t,i}(s;\\beta_{t,i})\\in\\mathcal{F}_{t,i}')
('4.1', '\\Tilde{Q}_{\\omega,t}(s,A_i)')
('4.1', 'f_t(s,p;\\beta_t)=\\sum_{i=1}^m f_{t,i}(s;\\beta_{t,i})p_i := \\langle f_t(s;\\beta_t), p\\rangle.')
('4.1', '\\mathcal{F}_{t,i}')
('4.1', 'i=1,...,m')
('4.1', '\\beta_{t,i}^*')
('4.1', '\\label{choice of beta}\n\\beta_{t,i}^* \\in \\operatorname{argmin}_{\\beta_{t,i}} \\mathbb{E}_{s \\sim d_{P_t}^{\\pi_t}}\\left[\\left(\\Tilde{Q}_{\\omega,t}(s,A_i)-f_{t,i}(s;\\beta_{t,i})\\right)^2\\right].')
('4.1', '\\{s_j\\}_{j=1}^N\\sim d_{P_t}^{\\pi_t}')
('4.1', '\\label{beta hat}\n\\widehat{\\beta}_{t,i} \\in \\operatorname{argmin}_{\\beta_{t,i}} \\frac{1}{N}\\sum_{j=1}^N\\left[\\left(\\Tilde{Q}_{\\omega,t}(s_j,A_i)-f_{t,i}(s_j;\\beta_{t,i})\\right)^2\\right],')
('4.1', '\\{\\Tilde{Q}_{\\omega,t}(s_j,A_i)\\}_{j=1}^N')
('4.1', '\\widehat{\\beta}_{t,i}')
('4.1', 'f_{t,i}(s;\\widehat{\\beta}_{t,i})\\approx f_{t,i}(s;\\beta_{t,i}^*)\\approx \\Tilde{ Q}_{\\omega,t}(s,A_i)')
('4.1', 'i=1,...,m')
('4.1', '\\{f_{t,i}(s;\\widehat{\\beta}_{t,i})\\}_{i=1}^m')
('4.1', '\\label{formula: update beta}\n\\pi_{t+1}(\\cdot\\mid s)=\\underset{p \\in \\Delta(\\mathcal{A})}{\\arg \\max }\\left\\{\\sum_{i=1}^m f_{t,i}(s;\\widehat{\\beta}_{t,i})p_i-\\frac{1}{\\eta_t} \\omega(p)\\right\\}, \\forall s \\in \\mathcal{S}.')
('4.1', '\\mathcal{F}_{t,i}')
('4.2.0', '\\widehat{L}_n')
('4.2.0', "\\widehat{L}_n(P_\\phi) = -\\frac{1}{n}\\sum_{i=1}^n\\log P_\\phi(s_i'\\mid s_i,a_i).")
('4.2.0', '\\widehat{P} = P_{\\widehat{\\phi}}')
('4.2.0', "\\mathcal{E}_n(P_\\phi) = \\frac{1}{n}\\sum_{i=1}^n\\log \\frac{P_{\\widehat{\\phi}}(s_i'\\mid s_i,a_i)}{P_\\phi(s_i'\\mid s_i,a_i)}.")
('4.2.0', '\\nabla_\\phi \\mathcal{L}_{V,t}(\\phi, \\lambda) = \\nabla_\\phi V_{P_\\phi}^{\\pi_t}+\\lambda \\nabla_\\phi\\mathcal{E}_n(P_\\phi).')
('4.2.0', '\\nabla_\\phi V_{P_\\phi}^{\\pi_t}')
('4.2.0', "M_\\phi(s',s,a,\\pi_t):=\\left(r(s,a)+\\gamma V_\\phi^{\\pi_t}\\left(s^{\\prime}\\right)\\right) \\times \\nabla_\\phi \\log P_\\phi\\left(s^{\\prime}\\mid s, a\\right)")
('4.2.0', "\\nabla_\\phi V_{P_\\phi}^{\\pi_t}=\\mathbb{E}_{s,a \\sim d_{P_\\phi}^{\\pi_t},,s^{\\prime} \\sim P_\\phi(\\cdot\\mid s,a)} M_\\phi(s',s,a,\\pi_t).")
('4.2.0', '\\nabla_\\phi\\mathcal{E}_n(P_\\phi)')
('4.2.0', "\\nabla_\\phi\\mathcal{E}_n(P_\\phi)=-\\frac{1}{n}\\sum_{i=1}^n \\nabla_\\phi \\log P_\\phi(s_i'\\mid s_i,a_i).")
('4.2.0', '\\nabla_\\phi \\mathcal{L}_{V,t}(\\phi, \\lambda)')
('4.2.0', '\\nabla_\\phi V_{P_\\phi}^{\\pi_t}')
('4.2.0', '\\nabla_\\phi\\mathcal{E}_n(P_\\phi)')
('4.2.0', 'P_t:=P_{\\phi^{(K)}}')
('4.2.0.0', '\\omega(p):=\\sum_{i=1}^m p_i\\log p_i')
('4.2.0.0', 'f_{t,i}(s;\\beta_{t,i})')
('4.2.0.0', '\\Tilde{ Q}_{\\omega,t}(s,A_i)')
('4.2.0.0', 'i=1,...,m')
('4.2.0.0', '\\beta_{t,i}')
('4.2.0.0', '\\{s_j\\}_{j=1}^N')
('4.2.0.0', 'd_{P_t}^{\\pi_t}')
('4.2.0.0', '\\Tilde{ Q}_{\\omega,t}(s_j,A_i)')
('4.2.0.0', 'j=1,...,N')
('4.2.0.0', '(s_j, \\Tilde{ Q}_{\\omega,t}(s_j,A_i))_{j=1}^N')
('4.2.0.0', '\\widehat{\\beta}_{t,i}')
('4.2.0.0', '\\omega')
('4.2.0.0', '\\pi_{t+1}\\left(A_i \\mid s\\right)\\propto \\exp(\\eta_t f_{t,i}(s;\\widehat{\\beta}_{t,i}))')
('4.2.0.0', 'i=1,\\ldots,m')
('4.2.0.0', 'f_{t,i}(s;\\beta_{t,i})')
('4.2.0.0', 'i=1, \\dots, m')
('5', '\\widehat{\\pi}')
('5', "\\mathcal{D}= (s_i,a_i,r_i,s_i')_{i=1}^n")
('5', '(s_i,a_i)\\overset{i.i.d.}{\\sim}\\rho')
('5', "s_i'\\sim P^*(\\cdot \\mid s_i,a_i)")
('5', '\\rho')
('5', 'P^*')
('5', '\\pi^\\dagger')
('5', 'C_{\\pi^\\dagger} := \\sup_{s,a} \\frac{d_{P^*}^{\\pi^\\dagger}(s,a)}{\\rho(s,a)}<\\infty')
('5', 'P^*\\in\\mathcal{P}.')
('5', '\\frac{c_1}{n}\\le\\alpha_n=o(1),\\frac{c_2}{\\sqrt{n}}\\le \\delta_n=o(1)')
('5', 'P_*\\in \\mathcal{P}_{n,\\alpha_n}')
('5', '\\varepsilon_{est}:=\\sup_{P\\in \\mathcal{P}_{n,\\alpha_n}} \\mathbb{E}_{(s,a)\\sim\\rho}[\\|P(\\cdot\\mid s,a)-P^*(\\cdot\\mid s,a)\\|_1]\\le \\delta_n.')
('5', 'C_{\\pi^\\dagger}')
('5', '\\pi^\\dagger')
('5', '\\mathcal{P}')
('5', '\\eta_t=(1-\\gamma)\\sqrt{\\frac{2\\log(|\\mathcal\nA|)}{T}}')
('5', 'T')
('5', '\\begin{split}\nV^{\\pi^\\dagger}_{P^*}-V_{P^*}^{\\widehat{\\pi}}\\lesssim & \\underbrace{(\\frac{\\gamma}{(1-\\gamma)^2}+\\frac{\\gamma}{(1-\\gamma)^3})C_{\\pi^\\dagger}\\ \\varepsilon_{est}}_{\\mathrm{model\\ error}}+ \\underbrace{\\frac{1}{(1-\\gamma)^2}\\frac{1}{\\sqrt{T}}}_{\\mathrm{policy\\ optimization\\ error}}\\\\\n&+\\underbrace{\\frac{1}{(1-\\gamma)^{\\frac{3}{2}}}|\\mathcal{A}| \\sqrt{\\sup _s \\frac{d_{P^*}^{\\pi^{\\dagger}}(s)}{\\mu_0(s)}} (\\varepsilon_{\\text {approx }}+\\frac{\\sqrt{\\max_{t,i}|\\mathcal{F}_{t,i}|}}{\\sqrt{N}})}_{\\mathrm{function\\ approximation\\ error}}\\\\\n\\end{split}')
('5', '\\widehat{\\pi}\\sim\\operatorname{Unif}(\\pi_0,\\pi_1,...,\\pi_{T-1})')
('5', '\\{\\pi_t\\}_{t=0}^{T-1}')
('5', '\\varepsilon_{approx}')
('5', 'n')
('5', 'T')
('5', 'Q')
('5', 'T')
('5', '\\varepsilon_{est}=O_P(1/\\sqrt{n})')
('5', '\\varepsilon_{approx}')
('5', '\\max_{t,i}|\\mathcal{F}_{t,i}|\\to\\infty')
('5', 'O_P(1/\\sqrt{N})')
('5', '\\sup_s d_{P^*}^{\\pi^{\\dagger}}(s)/\\mu_0(s)')
('5', '\\pi^{\\dagger}')
('5', 'P^*')
('5', '\\max_{t,i}|\\mathcal{F}_{t,i}|\\to\\infty')
('5', '\\varepsilon_{approx}\\to 0')
('5', '0')
('5', '\\max_{t,i}|\\mathcal{F}_{t,i}|\\to\\infty')
('5', 'N\\to\\infty')
('5', 'C_{\\pi^{\\dagger}}')
('5', '\\varepsilon_{est}')
('5', 'd_{P^*}^{\\pi^{\\dagger}}')
('5', '\\sup_s d_{P^*}^{\\pi^{\\dagger}}(s)/\\mu_0(s)')
('5', '\\varepsilon_{\\text {approx }}+\\frac{\\sqrt{\\max_{t,i}|\\mathcal{F}_{t,i}|}}{\\sqrt{N}}')
('5', 'd_{P^*}^{\\pi^{\\dagger}}')
('6.0.0', 's_0 \\sim \\mathcal{U}(-2,2)')
('6.0.0', 'n')
('6.0.0', 's_{n+1}-s_{n}=:\\Delta s \\sim \\psi_{a}\\mathcal{N}(\\mu_{1,a},0.1)+(1-\\psi_a)\\mathcal{N}(\\mu_{2,a},0.1)')
('6.0.0', 'a\\in \\{-1,0,1\\}')
('6.0.0', '\\beta')
('6.0.0.0', '1000')
('6.0.0.0', '4')
('6.0.0.0', '1000')
('6.0.0.1', 's=0.1')
('6.0.0.1', '\\hat{\\psi}_0')
('6.0.0.1', '10\\textsuperscript{th}')
('6.0.0.1', 'V(0.1)')
('6.0.0.1', '0.1')
('6.0.0.1', 'V(0.1)')
('6.1', '\\Tilde{Q}_{\\omega,t}(s,a)')
('6.1', '\\forall a\\in')
('6.1', '\\mathcal{A}')
('6.1', '\\Tilde{Q}_{\\omega,t}(s,A_i)')
('6.1', '5')
('7', 'P^*\\notin\\mathcal{P}')
('9.0', 'O(1/\\sqrt{n})')
('9.0', 'n')
('9.0', 'O(1/n^{1/5})')
('9.0', 'O(1/\\sqrt{n})')
('9.1', '|S|=\\infty')
('9.1', 's')
('9.1', 'f_t')
('9.1', '\\pi_t(\\cdot\\mid s)')
('9.1', 's')
('9.1', '\\pi_t(s)')
('9.1', 'f_t')
('9.1', '\\Omega\\left(C^T\\right)')
('9.1', '\\omega(p)=\\sum_{i=1}^m p_i \\log p_i')
('9.1', '\\pi_{t+1}\\left(A_i \\mid s\\right) \\propto \\exp \\left(\\eta_t f_{t,i}(s;\\widehat{\\beta}_{t,i})\\right)')
('9.1', 'i=1, \\ldots, m')
('9.1', '\\pi_{t+1}\\left(A_i \\mid s\\right) \\propto \\exp \\left(\\eta_t \\tilde{f}_t\\left(s ; \\widehat{\\beta}_{t, i}\\right)\\right) \\pi_t\\left(A_i \\mid s\\right)')
('9.1', 'i=1, \\ldots, m')
('9.1', '\\pi_{t+1}\\left(A_i \\mid s\\right)')
('9.1', '\\pi_t(\\cdot)')
('9.1', '\\tilde{f}_t\\left(\\cdot ; \\widehat{\\beta}_{t, i}\\right)')
('9.1', 'C')
('9.1', '\\Omega\\left(C^T\\right)')
('9.1', 'O\\left(T\\left(\\frac{K L^2}{1-\\gamma}+\\frac{N L}{(1-\\gamma)^2}\\right)\\right)')
('9.2', '\\omega(p)=\\sum_{i=1}^m p_i \\log p_i')
('9.2', '\\pi_{t+1}\\left(A_i \\mid s\\right) \\propto \\exp \\left(\\eta_t f_{t,i}\\left(s ; \\widehat{\\beta}_{t, i}\\right)\\right)')
('9.2', 'i=1, \\ldots, m')
('9.2', 't')
('9.2', '\\widehat{\\beta}_{t-1}')
('9.2', '(t-1)')
('9.2', '\\pi_t(s)')
('9.2', 't')
('9.2', 't+1')
('9.2', '\\pi_t')
('9.2', 'V_{P_k}^{\\pi_t}')
('9.2', 'k=1, \\ldots, K')
('9.2', 'd_P^{\\pi_t}')
('9.2', '\\pi_t')
('9.2', '\\frac{1}{1-\\gamma}')
('9.2', 't')
('9.2', '\\pi_t')
('9.2', 'O\\left(\\frac{K L^2}{1-\\gamma}\\right)')
('9.2', 'L')
('9.2', '\\pi_t')
('9.2', '\\left(s_j, A_i\\right)_{j=1}^N')
('9.2', '\\Tilde{Q}_{\\omega,t}(s_j,A_i)')
('9.2', 'j, i')
('9.2', 'O\\left(\\frac{N L}{(1-\\gamma)^2}\\right)')
('9.2', '\\left(s_j, p_j\\right)')
('9.2', 'j=1, \\ldots, N')
('9.2', 't')
('9.2', '\\pi_t\\left(A_i \\mid \\cdot\\right)=\\exp \\left(f_{t-1,i}\\left(\\cdot; \\widehat{\\beta}_{t-1, i}\\right)\\right) / C')
('9.2', 'O\\left(\\frac{K L^2}{1-\\gamma}+\\frac{N L}{(1-\\gamma)^2}\\right)')
('9.2', 't')
('9.2', '\\omega')
('9.2', 'I')
('9.2', 'O\\left(IT\\left(\\frac{K L^2}{1-\\gamma}+\\frac{N L}{(1-\\gamma)^2}\\right)\\right)')
('10', 'p\\in \\Delta(\\mathcal{A})')
('10', '\\mathcal{A}')
('10', '\\mathcal{A}\\subset \\mathbb R^{d_\\mathcal{A}}')
('10', 'd_\\mathcal{A}')
('10', '\\mathcal{A}')
('10', '\\pi:\\mathcal{S}\\to\\mathcal{A}')
('10', '\\pi(s)\\in \\mathcal{A}')
('10', 's\\in\\mathcal{S}')
('10', '\\label{equ: continuous action update}\n    \\pi_{t+1}(s)=\\underset{a \\in \\mathcal{A}}{\\arg \\max }\\left\\{ Q_{P_t}^{\\pi_t}(s, a)-\\frac{1}{\\eta_t} D\\left(\\pi_t(s), a\\right)\\right\\} \\quad \\forall s .')
('10', 's')
('10', 'D(\\pi_t(s),a)')
('10', 'Q_{P_t}^{\\pi_t}(s, a)+\\frac{1}{\\eta_t}\\left\\langle \\nabla\\omega\\left(\\pi_t( s)\\right),a\\right\\rangle-\\frac{1}{\\eta_t} \\omega(a)')
('10', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,a):=  Q_{P_t}^{\\pi_t}(s, a)+\\frac{1}{\\eta_t}\\left\\langle \\nabla\\omega\\left(\\pi_t( s)\\right),a\\right\\rangle')
('10', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,a)')
('10', 'f_t(s,a;\\beta_t)\\in\\mathcal{F}_t')
('10', 'f_t(s,a;\\beta_t^*)\\approx \\Tilde{\\mathcal Q}_{\\omega,t}(s,a)')
('10', '\\beta_t^*')
('10', '\\mathcal{F}_t')
('10', '\\beta_{t}^*')
('10', '\\label{choice of beta: continuous}\n\\beta_{t}^* \\in \\operatorname{argmin}_{\\beta_{t}} \\mathbb{E}_{(s,a) \\sim d_{P_t}^{\\pi_t}}\\left[\\left(\\Tilde{Q}_{\\omega,t}(s,a)-f_{t}(s,a;\\beta_{t})\\right)^2\\right].')
('10', '\\{s_j,a_j\\}_{j=1}^N\\sim d_{P_t}^{\\pi_t}')
('10', '\\label{beta hat: continuous}\n\\widehat{\\beta}_{t} \\in \\operatorname{argmin}_{\\beta_{t}} \\frac{1}{N}\\sum_{j=1}^N\\left[\\left(\\Tilde{Q}_{\\omega,t}(s_j,a_j)-f_{t}(s_j,a_j;\\beta_{t})\\right)^2\\right],')
('10', '\\{\\Tilde{Q}_{\\omega,t}(s_j,a_j)\\}_{j=1}^N')
('10', '\\widehat{\\beta}_{t}')
('10', 'f_{t}(s,a;\\widehat{\\beta}_{t})\\approx f_{t}(s,a;\\beta_{t}^*)\\approx \\Tilde{ Q}_{\\omega,t}(s,a)')
('10', '\\label{formula: update beta - continuous}\n\\pi_{t+1}(s)=\\underset{a \\in \\mathcal{A}}{\\arg \\max }\\left\\{ f_{t}(s,a;\\widehat{\\beta}_{t})-\\frac{1}{\\eta_t} \\omega(a)\\right\\}, \\forall s \\in \\mathcal{S}.')
('10', '\\eta_t')
('10', '\\mathcal{P}_{n,\\alpha_n}')
('10', '\\pi_0=\\mathrm{Unif}(\\mathcal{A})')
('10', 'P_t:= P_{\\phi^{(K)}}')
('10', '\\phi^{(K)}')
('10', '\\{s_j,a_j\\}_{j=1}^N')
('10', 'd_{P_t}^{\\pi_t}')
('10', 'f_{t-1}(s,a;\\widehat{\\beta}_{t-1})')
('10', '(s_j,a_j)')
('10', '\\Tilde{Q}_{\\omega,t}(s_j,a_j)')
('10', '\\widehat{\\beta}_{t,i}')
('10', 'f_{t}(s,a;\\widehat{\\beta}_{t})')
('10', 't+1')
('11', 'd_{\\mathcal{F}}')
('11', '\\mathcal{F}')
('11', 'd_{\\mathcal{F}}(P, Q):=\\sup _{f \\in \\mathcal{F}}\\left|\\underset{x \\sim P}{\\mathbb{E}}\\left[f\\left(x\\right)\\right]-\\underset{x\\sim Q}{\\mathbb{E}}\\left[f\\left(x\\right)\\right]\\right|')
('11', 'P')
('11', 'Q')
('11', '\\mathcal{F}')
('11', '\\operatorname{TV}')
('11', '\\exists x_0 \\in \\mathcal{D}: f_i\\left(x_0\\right)<0, \\quad i=1, \\ldots, m, \\quad h_i\\left(x_0\\right)=0, \\quad i=1, \\ldots, p')
('11', '\\mathcal F_{t,i}')
('11', '\\max_{t,i}|F_{t,i}|')
('11', '\\varepsilon_{\\operatorname{approx}} \\approx 0')
('11', '\\varepsilon_{\\operatorname{approx}}:=\\sup_{P,\\pi,t,i} \\inf_{f_{t,i}\\in \\mathcal F_{t,i}}\\| \\Tilde{Q}_{\\omega,t}(s,A_i)-f_{t,i}(s;\\beta_{t,i}) \\|_{2,d_P^\\pi}.')
('11', '\\delta>0')
('11', '\\mathcal{F}')
('11', '\\Bar{\\mathcal{R}}_n(\\delta ; \\mathcal{F})=\\mathbb{E}_{\\varepsilon, x}\\left[\\sup _{\\substack{f \\in \\mathcal{F} \\\\\\|f\\|_2 \\leq \\delta}}\\left|\\frac{1}{n} \\sum_{i=1}^n \\varepsilon_i f\\left(x_i\\right)\\right|\\right],')
('11', '\\left\\{x_i\\right\\}_{i=1}^n')
('11', '\\mathbb{P}')
('11', '\\left\\{\\varepsilon_i\\right\\}_{i=1}^n')
('11', '\\{-1,+1\\}')
('11', '\\left\\{x_i\\right\\}_{i=1}^n')
('11', '\\mathcal{F}')
('11', 'f \\in \\mathcal{F}')
('11', '\\alpha \\in[0,1]')
('11', '\\alpha f')
('11', '\\mathcal{F}')
('11', 'f')
('11', '\\mu')
('11', 'f(y) \\geq f(x)+\\nabla f(x)^T(y-x)+\\frac{\\mu}{2}\\|y-x\\|^2.')
('12', "\\mathcal{L}(\\mathcal{P}):=\\{(s',s,a)\\mapsto l(P,s',s,a),P\\in\\mathcal{P}\\}")
('12', 'P^*')
('12', '\\delta^2_n\\ge\\frac{c_1}{n}')
('12', '\\Bar{\\mathcal{R}}_n(\\delta;\\mathcal{L}(\\mathcal{P}))\\le \\delta^2')
('12', '\\Bar{\\mathcal{R}}_n(\\delta;\\mathcal{L}(\\mathcal{P}))')
('12', "l(P,s',s,a)")
('12', 'l_0')
('12', 'P')
('12', "l(P_1,s',s,a) - l(P_2,s',s,a)\\le l_{0} |P_1(s'|s,a)-P_2(s'|s,a)|.")
('12', "l(P,s',s,a)")
('12', "P(s',s,a)")
('12', '\\|\\cdot\\|_{L^2,P^*}')
('12', "H^2(P^*(\\cdot\\mid s,a),P(\\cdot \\mid s,a))\\le c_3\\mathbb{E}_{s'\\sim P^*(\\cdot|\\mid s,a)}l(P,s',s,a) - c_3\\mathbb{E}_{s'\\sim P^*}l(P^*,s',s,a)")
('12', '\\alpha = c_1\\delta_n^2')
('12', 'P^*\\in \\mathcal{P}_{n,\\alpha_n}')
('12', '\\sup_{P\\in \\mathcal{P}_{n,\\alpha_n}} \\mathbb{E}_{(s,a)\\sim\\rho}[\\|P(\\cdot\\mid s,a)-P^*(\\cdot\\mid s,a)\\|_1]\\le c_2\\delta_n.')
('12', "l(P,s',s,a):=-\\log P(s'\\mid s, a)")
('12', '\\widehat{L}_n(P)=-\\frac{1}{n}\\log P')
('12', 'b>0,\\nu>0')
('12', "\\begin{aligned}\n\\sup_{P\\in\\mathcal{P}}\\sup_{s',s,a}P(s'|s,a)<b, and,\\inf_{s',s,a}P^*(s'|s,a)\\ge \\nu.\n\\end{aligned}")
('12', '\\delta_n^2\\ge (1+\\frac{b}{\\nu})\\frac{1}{n}')
('12', '\\mathcal{P}')
('12', '\\Bar{\\mathcal{R}}_n(\\delta;\\mathcal{P})\\le \\frac{\\delta^2}{\\sqrt{b+\\nu}},')
('12', '\\alpha_n=c_1\\delta_n^2')
('12', '\\epsilon_{est}=c_2 \\delta_n')
('12', 'c_1,c_2')
('12', '\\eta_t =(1-\\gamma)\\sqrt{\\frac{2\\log(|\\mathcal{A}|)}{T}}')
('12', 'T')
('12', '\\begin{split}\nV^{\\pi^\\dagger}_{P^*}-V_{P^*}^{\\widehat{\\pi}}\\le & \\underbrace{(\\frac{\\gamma}{(1-\\gamma)^2}+\\frac{\\gamma}{(1-\\gamma)^3})C_{\\pi^\\dagger}\\ \\varepsilon_{est}}_{\\mathrm{statistical\\ error}}+ \\underbrace{\\frac{1}{(1-\\gamma)^2}\\sqrt{\\frac{2\\log(|\\mathcal{A}|)}{T}}}_{\\mathrm{policy\\ optimization\\ error}}\\\\\n\\end{split}')
('12', '\\widehat{\\pi}\\sim\\operatorname{Unif}(\\pi_0,\\pi_1,...,\\pi_{T-1})')
('12', 'n')
('12', 'T')
('13.0', '\\Delta_m')
('13.0', '\\Delta(\\mathcal{A})')
('13.0', '\\pi(s)=\\pi(\\cdot\\mid s)')
('13.0', '\\label{thm 1 proof eq 1}\nV_{P^*}^{\\pi^\\dagger} - \\frac{1}{T} \\sum_{t=0}^{T-1}V_{P^*}^{\\pi_t} = \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P^*}^{\\pi^\\dagger}-V_{P_t}^{\\pi^\\dagger} \\right) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi^\\dagger}-V_{P_t}^{\\pi_t} \\right) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi_t}-V_{P^*}^{\\pi_t} \\right).')
('13.0', 'V_{P^*}^{\\pi^\\dagger}-V_{P_t}^{\\pi^\\dagger}')
('13.0', 't')
('13.0', "\\label{thm 1 proof eq 2}\n\\begin{split}\nV_{P^*}^{\\pi^\\dagger}-V_{P_t}^{\\pi^\\dagger} &= \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\left[ \\mathbb{E}_{s'\\sim P^*(\\cdot|s,a)} V_{P_t}^{\\pi^\\dagger}(s') - \\mathbb{E}_{s'\\sim P_t(\\cdot|s,a)} V_{P_t}^{\\pi^\\dagger}(s') \\right]\\\\\n&\\le \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\left[ \\left\\| V_{P_t}^{\\pi^\\dagger} \\right\\|_\\infty \\|P^*(\\cdot|s,a)-P_t(\\cdot|s,a)\\|_1 \\right]\\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^2} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\|P^*(\\cdot|s,a)-P_t(\\cdot|s,a)\\|_1\\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^2} C_{\\pi^\\dagger} \\mathbb{E}_{(s,a)\\sim \\rho} \\left\\|P^*(\\cdot|s,a) - P_t(\\cdot|s,a)\\right\\|_1\\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^2} C_{\\pi^\\dagger} \\varepsilon_\\text{est}\n\\end{split}")
('13.0', 'C_{\\pi^\\dagger}')
('13.0', '\\varepsilon_\\text{est}')
('13.0', 'P^* \\in \\mathcal{P}_{n,\\alpha_n}')
('13.0', 'P_t= \\text{argmin}_{P\\in \\mathcal{P}_{n,\\alpha_n}} V_P^{\\pi_t}')
('13.0', 'V_{P_t}^{\\pi_t}\\le V_{P^*}^{\\pi_t}')
('13.0', 't')
('13.0', '\\label{thm 1 proof eq 3}\n\\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi_t}-V_{P^*}^{\\pi_t} \\right) \\le 0.')
('13.0', 'V_{P_t}^{\\pi_\\dagger}-V_{P_t}^{\\pi_t}')
('13.0', '\\label{thm 1 proof eq 4}\n\\begin{split}\n\\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi^\\dagger}-V_{P_t}^{\\pi_t} \\right) =&\\ \\frac{1}{T(1-\\gamma)} \\sum_{t=0}^{T-1} \\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}} \\left[ A_{P_t}^{\\pi_t}(s,a) \\right]\\\\\n=&\\ \\frac{1}{T(1-\\gamma)} \\sum_{t=0}^{T-1} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[ A_{P_t}^{\\pi_t}(s,a) \\right] \\\\\n&+ \\frac{1}{T(1-\\gamma)} \\sum_{t=0}^{T-1} (\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}} - \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}) \\left[ A_{P_t}^{\\pi_t}(s,a) \\right].\n\\end{split}')
('13.0', 'A_{P_t}^{\\pi_t}(s,a)')
('13.0', '\\pi_{t+1}(s) =\\underset{p \\in \\Delta_m}{\\arg \\max }\\left\\{ \\langle Q_{P_t}^{\\pi_t}(s, \\cdot),p\\rangle-\\frac{1}{\\eta_t} D\\left(\\pi_t(s), p\\right)\\right\\}')
('13.0', '\\label{thm 1 proof eq 5}\n\\pi_{t+1}(s) =\\underset{p \\in \\Delta_m}{\\arg \\min }\\left\\{ -\\langle Q_{P_t}^{\\pi_t}(s, \\cdot),p\\rangle+\\frac{1}{\\eta_t} D\\left(\\pi_t(s), p\\right)\\right\\}.')
('13.0', 'p\\in \\Delta_m')
('13.0', '\\left\\langle -Q_{P_t}^{\\pi_t}(s, \\cdot) +\\frac{1}{\\eta_t} \\nabla_p D\\left(\\pi_t(s), p=\\pi_{t+1}(s)\\right), p - \\pi_{t+1}(s)\n \\right\\rangle \\ge 0.')
('13.0', 'D(\\pi_t,p)= \\omega(p)- \\omega(\\pi_t) - \\langle \\nabla\\omega(\\pi_t), p-\\pi_t \\rangle')
('13.0', '\\label{thm 1 proof eq 6}\n\\left\\langle -Q_{P_t}^{\\pi_t}(s, \\cdot) +\\frac{1}{\\eta_t} \\Bigl(\\nabla\\omega(\\pi_{t+1}(s)) - \\nabla\\omega(\\pi_{t}(s))\\Bigr), p - \\pi_{t+1}(s)\n \\right\\rangle \\ge 0.')
('13.0', 'D(\\cdot,\\cdot)')
('13.0', 'D(\\pi_t(s), p) - D(\\pi_t(s), \\pi_{t+1}(s)) - D(\\pi_{t+1}(s), p) = \\left\\langle \\nabla\\omega(\\pi_{t+1}(s)) - \\nabla\\omega(\\pi_{t}(s)), p-\\pi_{t+1}(s)\n \\right\\rangle.')
('13.0', '\\left\\langle Q_{P_t}^{\\pi_t}(s, \\cdot), p - \\pi_{t+1}(s)\n \\right\\rangle\\le \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), p) - D(\\pi_t(s), \\pi_{t+1}(s)) - D(\\pi_{t+1}(s), p)\\Bigr).')
('13.0', '\\begin{aligned}\n&\\left\\langle A_{P_t}^{\\pi_t}(s, \\cdot), p \\right\\rangle \\\\\n&= \\left\\langle Q_{P_t}^{\\pi_t}(s, \\cdot), p \\right\\rangle - V_{P_t}^{\\pi_t}(s)\\\\\n&\\le \\left\\langle Q_{P_t}^{\\pi_t}(s, \\cdot), \\pi_{t+1}(s) \\right\\rangle - V_{P_t}^{\\pi_t}(s) + \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), p) - D(\\pi_t(s), \\pi_{t+1}(s)) - D(\\pi_{t+1}(s), p)\\Bigr)\\\\\n&= \\left\\langle Q_{P_t}^{\\pi_t}(s, \\cdot), \\pi_{t+1}(s) -\\pi_t(s) \\right\\rangle + \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), p) - D(\\pi_t(s), \\pi_{t+1}(s)) - D(\\pi_{t+1}(s), p)\\Bigr).\n\\end{aligned}')
('13.0', 'p= \\pi^\\dagger(s)')
('13.0', '\\label{thm 1 proof eq 7}\n\\begin{split}\n&\\left\\langle A_{P_t}^{\\pi_t}(s, \\cdot), \\pi^\\dagger(s) \\right\\rangle\\\\\n\\le& \\left\\langle Q_{P_t}^{\\pi_t}(s, \\cdot), \\pi_{t+1}(s) -\\pi_t(s) \\right\\rangle + \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_t(s), \\pi_{t+1}(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr)\\\\\n\\le& \\left\\langle Q_{P_t}^{\\pi_t}(s, \\cdot), \\pi_{t+1}(s) -\\pi_t(s) \\right\\rangle - \\frac{1}{2\\eta_t} \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1^2 \\\\\n&+ \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr)\\\\\n\\le&\\ \\|Q_{P_t}^{\\pi_t}(s, \\cdot)\\|_\\infty \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1 - \\frac{1}{2\\eta_t} \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1^2 \\\\\n&+ \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr)\\\\\n\\le&\\ \\frac{\\eta_t}{2} \\|Q_{P_t}^{\\pi_t}(s, \\cdot)\\|_\\infty^2 + \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr)\\\\\n\\le&\\ \\frac{\\eta_t}{2(1-\\gamma)^2} + \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr)\n\\end{split}')
('13.0', "D(p',p)\\ge \\frac{1}{2}\\|p-p'\\|^2")
('13.0', 'L_1')
('13.0', '\\|\\cdot\\|')
('13.0', '\\mathbb{R}^m')
('13.0', '-\\frac{C}{2\\eta_t} \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1^2')
('13.0', 'C')
('13.0', '\\frac{\\eta_t}{2C} \\|Q\\|_{\\infty}^2')
('13.0', '\\label{thm 1 proof eq 8}\n\\begin{split}\n&\\sum_{t=0}^{T-1} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[ A_{P_t}^{\\pi_t}(s,a) \\right]\\\\\n&= \\sum_{t=0}^{T-1} \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle A_{P_t}^{\\pi_t}(s, \\cdot), \\pi^\\dagger(s) \\right\\rangle \\\\\n&\\le \\sum_{t=0}^{T-1} \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left[ \\frac{\\eta_t}{2(1-\\gamma)^2} + \\frac{1}{\\eta_t} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr) \\right]\\\\\n&= \\frac{1}{2(1-\\gamma)^2} \\sum_{t=0}^{T-1}\\eta_t + \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\sum_{t=0}^{T-1} \\Bigl(D(\\pi_t(s), \\pi^\\dagger(s)) - D(\\pi_{t+1}(s), \\pi^\\dagger(s))\\Bigr).\n\\end{split}')
('13.0', '\\{\\eta_t\\}')
('13.0', '\\label{same as thm 1 eq 1}\n\\begin{split}\n&\\sum_{t=0}^{T-1} \\left(\\frac{1} {\\eta_t}D\\left(\\pi_t(s), \\pi^\\dagger(s)\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),\\pi^\\dagger(s))\\right)\\\\\n&= \\frac{1}{\\eta_0}D\\left(\\pi_0(s), \\pi^\\dagger(s)\\right) + \\sum_{t=1}^{T-1} (\\frac{1}{\\eta_t} - \\frac{1}{\\eta_{t-1}})D\\left(\\pi_t(s), \\pi^\\dagger(s)\\right) - \\frac{1}{\\eta_{T-1}} D(\\pi_{T}(s),\\pi^\\dagger(s))\\\\\n&\\le \\frac{1}{\\eta_0}D\\left(\\pi_0(s), \\pi^\\dagger(s)\\right)\\\\\n&\\le \\frac{1}{\\eta_0}D_0.\n\\end{split}')
('13.0', '\\label{thm 1 proof eq 9}\n\\sum_{t=0}^{T-1} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[ A_{P_t}^{\\pi_t}(s,a) \\right] \\le \\frac{1}{2(1-\\gamma)^2} \\sum_{t=0}^{T-1}\\eta_t + \\frac{D_0}{\\eta_0}.')
('13.0', '\\Tilde{r}(s,a)= A_{P_t}^{\\pi_t}(s,a)')
('13.0', '\\widetilde{M}_t = (\\mathcal{S},\\mathcal{A},P_t, \\Tilde{r}, \\gamma)')
('13.0', '\\widetilde{M}^* = (\\mathcal{S},\\mathcal{A},P^*, \\Tilde{r}, \\gamma)')
('13.0', '\\pi^\\dagger')
('13.0', '\\Tilde{r}')
('13.0', "\\begin{aligned}\n&\\frac{1}{1-\\gamma}\\Bigl(\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}}-\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\Bigr) A_{P_t}^{\\pi_t}(s,a) \\\\\n&= V_{\\widetilde{M}_t}^{\\pi^\\dagger} - V_{\\widetilde{M}^*}^{\\pi^\\dagger}\\\\\n&=\\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[\\mathbb{E}_{s'\\sim P_t(\\cdot|s,a)} V_{\\widetilde{M}_t}^{\\pi^\\dagger}(s') - \\mathbb{E}_{s'\\sim P^*(\\cdot|s,a)} V_{\\widetilde{M}_t}^{\\pi^\\dagger}(s') \\right].\n\\end{aligned}")
('13.0', 'r\\in [0,1]')
('13.0', 'Q_{P_t}^{\\pi_t}(\\cdot,\\cdot)')
('13.0', 'V_{P_t}^{\\pi_t}(\\cdot)')
('13.0', '[0, \\frac{1}{1-\\gamma}]')
('13.0', '|\\Tilde{r}| \\le \\frac{1}{1-\\gamma}')
('13.0', "|V_{\\widetilde{M}_t}^{\\pi^\\dagger}(s')|\\le \\frac{1}{(1-\\gamma)^2}")
('13.0', "\\label{thm 1 proof eq 10}\n\\begin{split}\n&\\frac{1}{1-\\gamma} \\Bigl(\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}}-\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\Bigr) A_{P_t}^{\\pi_t}(s,a) \\\\\n&=\\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[\\mathbb{E}_{s'\\sim P_t(\\cdot|s,a)} V_{\\widetilde{M}_t}^{\\pi^\\dagger}(s') - \\mathbb{E}_{s'\\sim P^*(\\cdot|s,a)} V_{\\widetilde{M}_t}^{\\pi^\\dagger}(s') \\right]\\\\\n& \\le \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[\\left\\|V_{\\widetilde{M}_t}^{\\pi^\\dagger}\\right\\|_{\\infty} \\left\\|P_t(\\cdot|s,a) - P^*(\\cdot|s,a)\\right\\|_1 \\right]\\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^3} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\|P_t(\\cdot|s,a) - P^*(\\cdot|s,a)\\right\\|_1 \\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\mathbb{E}_{(s,a)\\sim \\rho} \\left\\|P_t(\\cdot|s,a) - P^*(\\cdot|s,a)\\right\\|_1\\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\varepsilon_\\text{est}\n\\end{split}")
('13.0', '\\varepsilon_\\text{est}')
('13.0', '\\label{thm 1 proof eq 11}\n\\begin{split}\n&\\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi^\\dagger}-V_{P_t}^{\\pi_t} \\right) \\\\\n&= \\frac{1}{T(1-\\gamma)} \\sum_{t=0}^{T-1} \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} \\left[ A_{P_t}^{\\pi_t}(s,a) \\right] + \\frac{1}{T(1-\\gamma)} \\sum_{t=0}^{T-1} (\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}} - \\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}) \\left[ A_{P_t}^{\\pi_t}(s,a) \\right] \\\\\n&\\le \\frac{1}{2T(1-\\gamma)^3} \\sum_{t=0}^{T-1}\\eta_t + \\frac{D_0}{T(1-\\gamma)\\eta_0} + \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\varepsilon_\\text{est}.\n\\end{split}')
('13.0', '\\begin{aligned}\n&V_{P^*}^{\\pi^\\dagger} - \\frac{1}{T} \\sum_{t=0}^{T-1}V_{P^*}^{\\pi_t} \\\\\n&= \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P^*}^{\\pi^\\dagger}-V_{P_t}^{\\pi^\\dagger} \\right) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi^\\dagger}-V_{P_t}^{\\pi_t} \\right) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi_t}-V_{P^*}^{\\pi_t} \\right)\\\\\n&\\le \\frac{\\gamma}{(1-\\gamma)^2} C_{\\pi^\\dagger} \\varepsilon_\\text{est} + \\frac{1}{2T(1-\\gamma)^3} \\sum_{t=0}^{T-1}\\eta_t + \\frac{D_0}{T(1-\\gamma)\\eta_0} + \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\varepsilon_\\text{est} + 0\\\\\n&\\le c_1 C_{\\pi^\\dagger} \\varepsilon_\\text{est} + \\frac{1}{2T(1-\\gamma)^3} \\sum_{t=0}^{T-1}\\eta_t + \\frac{D_0}{T(1-\\gamma)\\eta_0}.\n\\end{aligned}')
('13.1', 'V_{P_t}^{\\pi_\\dagger}-V_{P_t}^{\\pi_t}')
('13.1', '\\mathcal{A}=\\{A_1,A_2,...,A_m\\}')
('13.1', '\\Delta_m:=\\left\\{p \\in \\mathbb{R}^m: \\sum_{i=1}^m p_i=1, p_i \\geq 0, i=1, \\ldots, m\\right\\}')
('13.1', '\\pi_t(s)\\in\\Delta_m')
('13.1', "\\begin{aligned}\n& Q_{P_t}^{\\pi_t}\\left(s, A_i\\right):=R\\left(s, A_i\\right)+\\gamma \\int  V_{P_t}^{\\pi_t}\\left(s^{\\prime}\\right)P\\left(s^{\\prime} \\mid s, A_i\\right)ds', i=1, \\ldots, m, \\\\\n& \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i):=Q_{P_t}^{\\pi_t}\\left(s, A_i\\right)+ \\frac{1}{\\eta_t} \\nabla_i \\omega\\left(\\pi_t(s)\\right), i=1, \\ldots, m\n\\end{aligned}")
('13.1', 'A_i')
('13.1', 'p\\in\\Delta_m')
('13.1', '\\begin{aligned}\n\\Tilde{\\mathcal Q}_{\\omega,t}(s,p)&=Q_{P_t}^{\\pi_t}(s, p)+ \\left\\langle\\nabla \\omega\\left(\\pi_t(s)\\right), p\\right\\rangle / \\eta_t\\\\\n& = \\sum_{i=1}^m Q_{P_t}^{\\pi_t}\\left(s, A_i\\right)p_i + \\left\\langle\\nabla \\omega\\left(\\pi_t(s)\\right), p\\right\\rangle / \\eta_t\\\\\n&:=\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot), p\\right\\rangle\n\\end{aligned}')
('13.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)')
('13.1', 'm')
('13.1', 'i')
('13.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i)')
('13.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,p)')
('13.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)')
('13.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i)')
('13.1', 'i=1,...,m')
('13.1', 'i=1,...,m')
('13.1', '\\begin{aligned}\nf_{t,i}(s;\\beta_{t,i})\\approx \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i)\n\\end{aligned}')
('13.1', 'f_{t,i}(s;\\beta_{t,i})')
('13.1', '\\beta')
('13.1', '\\label{formula: finite action update rule}\n\\pi_{t+1}(s)=\\underset{p \\in \\Delta_m}{\\arg \\max }\\left\\{\\left\\langle f_{t}(s;\\beta_{t}), p\\right\\rangle-\\frac{1}{\\eta_t} \\omega(p)\\right\\}, \\forall s \\in \\mathcal{S}.')
('13.1', '\\label{formula: argmin finite action update rule}\n\\pi_{t+1}(s)=\\underset{p \\in \\Delta_m}{\\arg \\min }\\left\\{-\\left\\langle f_{t}(s;\\beta_{t}), p\\right\\rangle+\\frac{1}{\\eta_t} \\omega(p)\\right\\}, \\forall s \\in \\mathcal{S}.')
('13.1', '\\omega')
('13.1', '1')
('13.1', '\\left\\langle f_{t}(s;\\beta), p\\right\\rangle')
('13.1', 'p')
('13.1', '\\frac{1}{\\eta_t}')
('13.1', '\\Delta_m')
('13.1', '\\langle \\nabla\\left\\{-\\left\\langle f_{t}(s;\\beta_{t}), \\pi_{t+1}(s)\\right\\rangle+\\frac{1}{\\eta_t} \\omega(\\pi_{t+1}(s))\\right\\},p-\\pi_{t+1}(s)\\rangle \\ge0')
('13.1', 'p\\in \\Delta_m')
('13.1', '\\begin{aligned}\n\\left\\langle - f_{t}(s;\\beta_{t}), p-\\pi_{t+1}(s)\\right\\rangle &\\ge -\\frac{1}{\\eta_t} \\left\\langle \\nabla\\omega(\\pi_{t+1}(s)), p-\\pi_{t+1}(s)\\right\\rangle \\\\\n&= \\frac{1}{\\eta_t}\\Bigl(D(\\pi_{t+1}(s),p)) - \\omega(p)+ \\omega(\\pi_{t+1}(s)\\Bigr).\n\\end{aligned}')
('13.1', '\\label{main thm proof eq 1}\n    \\begin{aligned}\n        &-\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot), p\\right\\rangle +\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)- f_{t}(s;\\beta_{t}), p\\right\\rangle\\\\\n        \\ge& -\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot), \\pi_{t+1}(s)\\right\\rangle +\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)- f_{t}(s;\\beta_{t}), \\pi_{t+1}(s)\\right\\rangle\\\\\n        &+\\frac{1}{\\eta_t} \\omega(\\pi_{t+1}(s))-\\frac{1}{\\eta_t} \\omega(p) +\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p).\\\\\n    \\end{aligned}')
('13.1', '\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot), p\\right\\rangle')
('13.1', '\\Tilde{\\mathcal Q}_{\\omega,t}(s,p)')
('13.1', '\\delta_t(s):=\\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)- f_{t}(s;\\beta_{t})')
('13.1', '\\delta_t(s)')
('13.1', 'm')
('13.1', '\\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot), p\\right\\rangle =  \\Tilde{\\mathcal Q}_{\\omega,t}(s,p) = Q_{P_t}^{\\pi_t}(s,p)+ \\left\\langle\\nabla \\omega\\left(\\pi_t(s)\\right), p\\right\\rangle / \\eta_t')
('13.1', 'p')
('13.1', '\\delta_t(s)=\\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot) -  f_{t}(s;\\beta_{t})')
('13.1', '\\label{equ 25}\n    \\begin{aligned}\n        & -Q_{P_t}^{\\pi_t}(s,p)- \\left\\langle\\nabla \\omega\\left(\\pi_t(s)\\right), p\\right\\rangle / \\eta_t +\\left\\langle \\delta_t(s), p\\right\\rangle\\\\\n        \\ge & -Q_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s))- \\left\\langle\\nabla \\omega\\left(\\pi_{t}(s)\\right), \\pi_{t+1}(s)\\right\\rangle / \\eta_t +\\left\\langle \\delta_t(s), \\pi_{t+1}(s)\\right\\rangle\\\\\n        &+\\frac{1}{\\eta_t} \\omega(\\pi_{t+1}(s))-\\frac{1}{\\eta_t} \\omega(p)+\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p).\\\\\n    \\end{aligned}')
('13.1', 'D(\\cdot,\\cdot)')
('13.1', '\\omega\\left(\\pi_{t+1}(s)\\right)-\\omega(p)-\\left\\langle\\nabla \\omega\\left(\\pi_t(s)\\right), \\pi_{t+1}(s)-p\\right\\rangle=D\\left(\\pi_t(s), \\pi_{t+1}(s)\\right)-D\\left(\\pi_t(s), p\\right).')
('13.1', '\\begin{aligned}\n        & Q_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s))-Q_{P_t}^{\\pi_t}(s,p)\\\\\n        \\ge &  \\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle+\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p)+\\frac{1}{\\eta_t}D\\left(\\pi_t(s), \\pi_{t+1}(s)\\right)-\\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right).\\\\\n    \\end{aligned}')
('13.1', '\\begin{aligned}        \n        &A_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s)) - A_{P_t}^{\\pi_t}(s,p)\\\\\n        =& Q_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s)) - V_{P_t}^{\\pi_t}(s)  - Q_{P_t}^{\\pi_t}(s,p) +V_{P_t}^{\\pi_t}(s)\\\\\n        =&Q_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s))-Q_{P_t}^{\\pi_t}(s,p)\\\\\n        \\ge &  \\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle+\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p)+\\frac{1}{\\eta_t}D\\left(\\pi_t(s), \\pi_{t+1}(s)\\right)-\\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right).\n    \\end{aligned}')
('13.1', '\\label{bounding advantage}\n    \\begin{aligned}        \n        &A_{P_t}^{\\pi_t}(s,p)\\\\\n        \\le&\\ A_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s)) -\\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle +\\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right) -\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p) \\\\\n        &-\\frac{1}{\\eta_t}D\\left(\\pi_t(s), \\pi_{t+1}(s)\\right)\\\\\n        \\le&\\ A_{P_t}^{\\pi_t}(s,\\pi_{t+1}(s)) -\\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle + \\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p) \\\\\n        &- \\frac{1}{2\\eta_t} \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1^2\\\\\n        =&\\ \\langle Q_{P_t}^{\\pi_t}(s), \\pi_{t+1}(s) - \\pi_{t}(s)\\rangle - \\frac{1}{2\\eta_t} \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1^2 \\\\\n        &-\\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle + \\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p)\\\\\n        \\le&\\ \\|Q\\|_{\\infty}\\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1 - \\frac{1}{2\\eta_t} \\|\\pi_{t+1}(s) - \\pi_{t}(s)\\|_1^2 \\\\\n        &-\\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle + \\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p)\\\\\n        \\le&\\ \\frac{\\eta_t}{2} \\|Q\\|_{\\infty}^2 -\\left\\langle \\delta_t(s), \\pi_{t+1}(s)-p\\right\\rangle + \\frac{1}{\\eta_t}D\\left(\\pi_t(s), p\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),p)\n    \\end{aligned}')
('13.1', "D(p',p)\\ge \\frac{1}{2}\\|p-p'\\|^2")
('13.1', 'L_1')
('13.1', 'V^{\\pi^\\dagger}_{P_t}-V^{\\pi_t}_{P_t}')
('13.1', '\\label{main thm proof eq 2}\n\\begin{aligned}\n&\\frac{1}{T+1}\\sum_{t=0}^T (V^{\\pi^\\dagger}_{P_t}-V^{\\pi_t}_{P_t})\\\\\n&= \\frac{1}{T+1}\\sum_{t=0}^T \\frac{1}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}} A_{P_t}^{\\pi_t}(s,a)\\\\\n&= \\frac{1}{T+1}\\sum_{t=0}^T \\frac{1}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} A_{P_t}^{\\pi_t}(s,a) + \\frac{1}{T+1}\\sum_{t=0}^T \\frac{1}{1-\\gamma}\\Bigl(\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}}-\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\Bigr) A_{P_t}^{\\pi_t}(s,a).\n\\end{aligned}')
('13.1', 'p')
('13.1', '\\pi^\\dagger(s)')
('13.1', '\\label{main thm proof eq 3}\n\\begin{aligned}\n&\\frac{1}{T+1}\\sum_{t=0}^T \\frac{1}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}A_{P_t}^{\\pi_t}(s,a)\\\\\n=&\\ \\frac{1}{T+1}\\sum_{t=0}^T \\frac{1}{1-\\gamma}\\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}}A_{P_t}^{\\pi_t}(s,\\pi^\\dagger(s))\\\\\n\\le&\\ \\frac{1}{(T+1)(1-\\gamma)}\\sum_{t=0}^T \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}}\\biggl[\\frac{\\eta_t}{2} \\|Q\\|_{\\infty}^2 -\\left\\langle \\delta_t(s), \\pi_{t+1}(s)-\\pi^\\dagger(s)\\right\\rangle \\biggr.\\\\\n&\\biggl.+ \\frac{1}{\\eta_t}D\\left(\\pi_t(s), \\pi^\\dagger(s)\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),\\pi^\\dagger(s))\\biggr]\\\\\n\\le&\\ \\frac{1}{2(T+1)(1-\\gamma)^3}\\sum_{t=0}^T \\eta_t + \\frac{1}{(T+1)(1-\\gamma)}\\sum_{t=0}^T \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle \\delta_t(s), \\pi^\\dagger(s)- \\pi_{t+1}(s)\\right\\rangle \\\\\n&+ \\frac{1}{(T+1)(1-\\gamma)} \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\sum_{t=0}^T \\left( \\frac{1}{\\eta_t}D\\left(\\pi_t(s), \\pi^\\dagger(s)\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),\\pi^\\dagger(s)) \\right).\n\\end{aligned}')
('13.1', '\\begin{aligned}\n&\\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle \\delta_t(s), \\pi^\\dagger(s)- \\pi_{t+1}(s)\\right\\rangle \\\\\n&= \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle \\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)- f_{t}(s;\\beta_{t}), \\pi^\\dagger(s)- \\pi_{t+1}(s)\\right\\rangle\\\\\n&\\le \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle |\\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)- f_{t}(s;\\beta_{t})|, \\pi^\\dagger(s)\\right\\rangle + \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle |\\Tilde{\\mathcal Q}_{\\omega,t}(s,\\cdot)- f_{t}(s;\\beta_{t})|, \\pi_{t+1}(s)\\right\\rangle\\\\\n&\\le 2|\\mathcal{A}|\\max_i \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left|   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right|\\\\\n&\\le 2|\\mathcal{A}|\\max_i \\sqrt{ \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left(   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right)^2 }\\\\\n&\\le 2|\\mathcal{A}|\\max_i \\left\\| \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{d_{P_t}^{\\pi_t}(s)} \\right\\|_{\\infty}^{\\frac{1}{2}} \\sqrt{ \\mathbb{E}_{s\\sim d_{P_t}^{\\pi_t}} \\left(   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right)^2 }\\\\\n&\\le \\frac{2|\\mathcal{A}|\\max_i}{\\sqrt{1-\\gamma}} \\left\\| \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{\\mu_0(s)} \\right\\|_{\\infty}^{\\frac{1}{2}} \\sqrt{ \\mathbb{E}_{s\\sim d_{P_t}^{\\pi_t}} \\left(   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right)^2 }.\n\\end{aligned}')
('13.1', '\\begin{aligned}\n&\\mathbb{E}_{s\\sim d_{P_t}^{\\pi_t}} \\left(   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right)^2 \\\\\n&\\le \\min_{\\beta_{t,i}} \\mathbb{E}_{s\\sim d_{P_t}^{\\pi_t}} \\left(   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right)^2 + c\\frac{|\\mathcal{F}_{t,i}|}{N}, w.h.p.\\\\\n&\\le \\sup_{P,\\pi} \\inf_{\\beta_{t,i}} \\mathbb{E}_{s\\sim d_{P}^{\\pi}} \\left(   \\Tilde{\\mathcal Q}_{\\omega,t}(s,A_i) - f_{t,i}(s;\\beta_{t,i}) \\right)^2 + c\\frac{|\\mathcal{F}_{t,i}|}{N}, w.h.p.\\\\\n&= \\varepsilon_\\text{approx}^2 + c\\frac{|\\mathcal{F}_{t,i}|}{N}, w.h.p.\n\\end{aligned}')
('13.1', '\\label{main thm proof eq 4}\n\\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle \\delta_t(s), \\pi^\\dagger(s)- \\pi_{t+1}(s)\\right\\rangle \\le \\frac{2|\\mathcal{A}|}{\\sqrt{1-\\gamma}} \\left\\| \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{\\mu_0(s)} \\right\\|_{\\infty}^{\\frac{1}{2}} (\\varepsilon_\\text{approx}+c\\sqrt{\\frac{\\max_{t,i}|\\mathcal{F}_{t,i}|}{N}}).')
('13.1', '\\label{main thm proof eq 5}\n\\begin{aligned}\n\\sum_{t=0}^T \\left(\\frac{1} {\\eta_t}D\\left(\\pi_t(s), \\pi^\\dagger(s)\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),\\pi^\\dagger(s))\\right)\\le \\frac{1}{\\eta_0}D_0.\n\\end{aligned}')
('13.1', '\\label{main thm proof eq 6}\n\\begin{split}\n&\\frac{1}{T+1}\\sum_{t=0}^T \\frac{1}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}A_{P_t}^{\\pi_t}(s,a) \\\\\n\\le&\\ \\frac{1}{2(T+1)(1-\\gamma)^3}\\sum_{t=0}^T \\eta_t + \\frac{1}{(T+1)(1-\\gamma)}\\sum_{t=0}^T \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\left\\langle \\delta_t(s), \\pi^\\dagger(s)- \\pi_{t+1}(s)\\right\\rangle \\\\\n&+ \\frac{1}{(T+1)(1-\\gamma)} \\mathbb{E}_{s\\sim d_{P^*}^{\\pi^\\dagger}} \\sum_{t=0}^T \\left( \\frac{1}{\\eta_t}D\\left(\\pi_t(s), \\pi^\\dagger(s)\\right)-\\frac{1}{\\eta_t}D(\\pi_{t+1}(s),\\pi^\\dagger(s)) \\right)\\\\\n\\le&\\ \\frac{1}{2(T+1)(1-\\gamma)^3}\\sum_{t=0}^T \\eta_t + \\frac{1}{1-\\gamma} \\frac{2|\\mathcal{A}|}{\\sqrt{1-\\gamma}} \\left\\| \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{\\mu_0(s)} \\right\\|_{\\infty}^{\\frac{1}{2}} (\\varepsilon_\\text{approx}+c\\sqrt{\\frac{\\max_{t,i}|\\mathcal{F}_{t,i}|}{N}})\\\\\n&+ \\frac{D_0}{(T+1)(1-\\gamma)\\eta_0}.\n\\end{split}')
('13.1', '\\label{main thm proof eq 7}\n\\begin{split}\n\\frac{1}{1-\\gamma} \\Bigl(\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}}-\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\Bigr) A_{P_t}^{\\pi_t}(s,a) \\le \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\varepsilon_\\text{est}.\n\\end{split}')
('13.1', '\\label{main thm proof eq 8}\n\\begin{split}\n&\\frac{1}{T}\\sum_{t=0}^{T-1} (V^{\\pi^\\dagger}_{P_t}-V^{\\pi_t}_{P_t})\\\\\n=&\\ \\frac{1}{T}\\sum_{t=0}^{T-1} \\frac{1}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}} A_{P_t}^{\\pi_t}(s,a) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\frac{1}{1-\\gamma}\\Bigl(\\mathbb{E}_{(s,a)\\sim d_{P_t}^{\\pi^\\dagger}}-\\mathbb{E}_{(s,a)\\sim d_{P^*}^{\\pi^\\dagger}}\\Bigr) A_{P_t}^{\\pi_t}(s,a)\\\\\n\\le&\\ \\frac{1}{2T(1-\\gamma)^3}\\sum_{t=0}^{T-1} \\eta_t + \\frac{1}{1-\\gamma} \\frac{2|\\mathcal{A}|}{\\sqrt{1-\\gamma}} \\left\\| \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{\\mu_0(s)} \\right\\|_{\\infty}^{\\frac{1}{2}} \\varepsilon_\\text{approx} + \\frac{D_0}{T(1-\\gamma)\\eta_0}+ \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\varepsilon_\\text{est}.\n\\end{split}')
('13.1', 'V_{P^*}^{\\pi^\\dagger} - V_{P^*}^{\\pi_t}')
('13.1', '\\label{main thm proof eq 9}\nV_{P^*}^{\\pi^\\dagger} - \\frac{1}{T} \\sum_{t=0}^{T-1}V_{P^*}^{\\pi_t} = \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P^*}^{\\pi^\\dagger}-V_{P_t}^{\\pi^\\dagger} \\right) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi^\\dagger}-V_{P_t}^{\\pi_t} \\right) + \\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi_t}-V_{P^*}^{\\pi_t} \\right).')
('13.1', 'P^* \\in \\mathcal{P}_{n,\\alpha_n}')
('13.1', 'P_t= \\text{argmin}_{P\\in \\mathcal{P}_{n,\\alpha_n}} V_P^{\\pi_t}')
('13.1', 'V_{P_t}^{\\pi_t}\\le V_{P^*}^{\\pi_t}')
('13.1', 't')
('13.1', '\\label{main thm proof eq 10}\n\\frac{1}{T}\\sum_{t=0}^{T-1} \\left( V_{P_t}^{\\pi_t}-V_{P^*}^{\\pi_t} \\right) \\le 0.')
('13.1', '\\label{main thm proof eq 11}\n\\begin{split}\nV_{P^*}^{\\pi^\\dagger}-V_{P_t}^{\\pi^\\dagger} \\le \\frac{\\gamma}{(1-\\gamma)^2} C_{\\pi^\\dagger} \\varepsilon_\\text{est}.\n\\end{split}')
('13.1', '\\begin{aligned}\nV_{P^*}^{\\pi^\\dagger} - \\frac{1}{T} \\sum_{t=0}^{T-1}V_{P^*}^{\\pi_t} \\le&\\  \\frac{\\gamma}{(1-\\gamma)^2} C_{\\pi^\\dagger} \\varepsilon_\\text{est} + \\frac{1}{2T(1-\\gamma)^3}\\sum_{t=0}^{T-1} \\eta_t \\\\\n&+ \\frac{1}{1-\\gamma} \\frac{2|\\mathcal{A}|}{\\sqrt{1-\\gamma}} \\left\\| \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{\\mu_0(s)} \\right\\|_{\\infty}^{\\frac{1}{2}} (\\varepsilon_\\text{approx}+c\\sqrt{\\frac{\\max_{t,i}|\\mathcal{F}_{t,i}|}{N}})\\\\\n&+ \\frac{D_0}{T(1-\\gamma)\\eta_0}+ \\frac{\\gamma}{(1-\\gamma)^3} C_{\\pi^\\dagger} \\varepsilon_\\text{est} + 0\\\\\n\\le&\\ c_1 C_{\\pi^\\dagger} \\varepsilon_\\text{est} + c_2 |\\mathcal{A}| \\sqrt{\\sup_s \\frac{d_{P^*}^{\\pi^\\dagger}(s)}{\\mu_0(s)}} (\\varepsilon_\\text{approx}+c\\sqrt{\\frac{\\max_{t,i}|\\mathcal{F}_{t,i}|}{N}})\\\\\n&+ \\frac{1}{2T(1-\\gamma)^3}\\sum_{t=0}^{T-1} \\eta_t + \\frac{D_0}{T(1-\\gamma)\\eta_0}.\n\\end{aligned}')
('13.2', '\\|\\widehat{P}-P^*\\|_2\\le c_1\\delta_n')
('13.2', '\\mathbb{E}(l(\\hat{P})-l(P^*))\\le c_2\\delta_n^2.')
('13.2', 'P^*\\in \\mathcal{P}_{n,\\alpha_n}')
('13.2', '\\widehat{L}_n(P^*)-\\widehat{L}_n(\\widehat{P})')
('13.2', '\\widehat{P}')
('13.2', '\\widehat{L}_n(P)')
('13.2', "\\widehat{L}_n(P)=\\frac{1}{n}\\sum_{i=1}^n l(P)(s_i,a_i,s_i')")
('13.2', 'L(P):=\\mathbb{E}l(P)')
('13.2', '\\widehat{L}_n')
('13.2', '\\begin{aligned}\n&\\widehat{L}_n(P^*)-\\widehat{L}_n(\\widehat{P})\\\\\n=& \\widehat{L}_n(P^*) - L(P^*) + L(P^*) - L(\\widehat{P}) + L(\\widehat{P}) - \\widehat{L}_n(\\widehat{P})\\\\\n=& (\\widehat{L}_n(P^*) - \\widehat{L}_n(\\widehat{P})+L(\\widehat{P})-L(P^*))+L(P^*)-L(\\widehat{P})\\\\\n\\le &|(\\widehat{L}_n(P^*) - \\widehat{L}_n(\\widehat{P})+L(\\widehat{P})-L(P^*))|.\n    \\end{aligned}')
('13.2', '0')
('13.2', '\\frac{|(\\widehat{L}_n(P^*) - \\widehat{L}_n(\\widehat{P})+L(\\widehat{P})-L(P^*))|}{\\|\\widehat{P}-P^*\\|_2}\\le \\sup_{P}\\frac{|(\\widehat{L}_n(P^*) - \\widehat{L}_n(P)+L(P)-L(P^*))|}{\\|P-P^*\\|_2}\\le c_3 \\delta_n.')
('13.2', '|(\\widehat{L}_n(P^*) - \\widehat{L}_n(\\widehat{P})+L(\\widehat{P})-L(P^*))|\\le c_3\\delta_n \\|\\widehat{P}-P^*\\|_2\\le c_4\\delta_n^2.')
('13.2', '\\widehat{L}_n(P^*)-\\widehat{L}_n(\\widehat{P})\\le c_4\\delta_n^2')
('13.2', 'P^*\\in \\mathcal{P}_{n,\\alpha_n}')
('13.2', '\\alpha')
('13.2', 'c\\delta_n^2')
('13.2', '\\mathbb{E}_{s,a\\sim\\rho}\\|P(\\cdot|s,a)-P^*(\\cdot|s,a)\\|_1\\le c\\delta_n')
('13.2', 'P\\in\\mathcal{P}_{n,\\alpha_n}')
('13.2', '\\mathbb{E}_{s,a\\sim \\rho}H^2(P,P^*)\\le L(P)-L(P^*)')
('13.2', 'P.')
('13.2', '\\begin{aligned}\n&\\mathbb{E}_{s,a\\sim \\rho} H^2(P,P^*)\\\\\n&\\le L(P)-L(P^*)\\\\\n&=L(P)-\\widehat{L}_n(P) + \\widehat{L}_n(P) -  \\widehat{L}_n(P^*)+\\widehat{L}_n(P^*) - L(P^*)\\\\\n&\\le |L(P)-\\widehat{L}_n(P)+\\widehat{L}_n(P^*) - L(P^*)|+|\\widehat{L}_n(P) -  \\widehat{L}_n(P^*)|\\\\\n&\\le |L(P)-\\widehat{L}_n(P)+\\widehat{L}_n(P^*) - L(P^*)|+|\\widehat{L}_n(P) -  \\widehat{L}_n(\\widehat{P})|+|\\widehat{L}_n(\\widehat{P})-\\widehat{L}_n(P^*)|\\\\\n&\\le c_1\\delta_n^2+c_2\\alpha_n+c_2\\alpha_n\\\\\n&\\le c\\delta_n^2.\n    \\end{aligned}')
('13.2', 'H^2')
('13.2', '\\sup_{P\\in\\mathcal{P}_{n,\\alpha_n}}\\mathbb{E}_{s,a\\sim \\rho}\\|P(\\cdot|s,a)-P^*(\\cdot|s,a)\\|_1\\le c\\delta_n.')
('13.3', "\\widehat{L}_n(P)=\\frac{1}{n}\\sum_{i=1}^n \\frac{P^*(s_i'\\mid s_i,a_i)}{P(s_i'\\mid s_i,a_i)}")
('13.3', "{L}(P)=\\mathbb{E}_{(s,a)\\sim\\rho,s'\\sim P^*(\\cdot\\mid s,a)}\\frac{P^*(s'\\mid s,a)}{P(s'\\mid s,a)}=D_{\\mathrm{KL}}(P^* \\| P).")
('13.3', 'P^*\\in \\mathcal{P}_{n,\\alpha_n}')
('13.3', '\\widehat{L}_n(P^*)-\\widehat{L}_n(\\widehat{P})')
('13.3', '\\widehat{P}')
('13.3', '\\widehat{L}_n(P)')
('13.3', '\\begin{aligned}\n&\\widehat{L}_n(P^*)-\\widehat{L}_n(\\widehat{P})\\\\\n=& \\widehat{L}_n(P^*) - L(P^*) + L(P^*) - L(\\widehat{P}) + L(\\widehat{P}) - \\widehat{L}_n(\\widehat{P})\\\\\n=&(a) + (b) +(c) \n    \\end{aligned}')
('13.3', '\\sup_{P\\in\\mathcal{P}}|(\\widehat{L}_n-L)(P)|.')
('13.3', '\\sup_{P\\in\\mathcal{P}}|(\\widehat{L}_n-L)(P)|\\le \\delta_n^2')
('13.3', '(b)')
('13.3', 'L(P^*) - L(\\widehat{P}) = D_{\\mathrm{KL}}(P^* \\| \\widehat{P})')
('13.3', 'P')
('13.3', '(b) = D_{\\mathrm{KL}}(P^* \\| \\widehat{P})\\le \\delta_n^2')
('13.3', '\\widehat{L}_n(P^*)-\\widehat{L}_n(\\widehat{P})\\le c\\delta_n^2=\\alpha')
('13.3', '1-\\delta')
('13.3', 'P^*\\in \\mathcal{P_\\alpha}')
('13.3', '1-\\delta')
('13.3', '\\sup_{P\\in \\mathcal{P}_{n,\\alpha_n}} (\\mathbb{E}_{(s,a)\\sim\\rho}[d_f(P(\\cdot\\mid s,a),P^*(\\cdot\\mid s,a))^2])^\\frac{1}{2}\\le c_2 \\delta_n  .')
('13.3', 'P\\in\\mathcal{P}_{n,\\alpha_n}')
('13.3', '\\begin{aligned}\nH^2(P,P^*)&\\le KL(P\\| P^*)\\\\\n&= L(P) - L(P^*)\\\\\n&= L(P) - \\widehat{L}_n(P) + \\widehat{L}_n(P)-\\widehat{L}_n(\\widehat{P}) + \\widehat{L}_n(\\widehat{P}) - L(\\widehat{P}) + L(\\widehat{P}) - L(P^*).\n    \\end{aligned}')
('13.3', '\\sup_{P\\in\\mathcal{P}}|(\\widehat{L}_n-L)(P)|\\le \\delta_n^2.')
('13.3', '\\alpha =c\\delta_n^2')
('13.3', 'P\\in\\mathcal{P}_{n,\\alpha_n}')
('13.3', 'KL(\\widehat{P}\\| P^*)\\le c_3\\delta_n^2')
('14', '\\mathcal{S}')
('14', '\\mathcal{A}')
('14', 'r')
('14', '\\gamma')
('14', '\\mu_0')
('14', '\\mathcal{S}')
('14', '\\mathcal{A}')
('14', 'r:\\mathcal{S}\\to \\mathbb{R}')
('14', 'P')
('14', '\\widehat{P}')
('14', '\\pi: \\mathcal{S}\\to \\Delta(\\mathcal{A})')
('14', "V_{P}^\\pi-V_{\\widehat{P}}^\\pi = \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a) \\sim d_{P}^\\pi}\\left[\\mathbb{E}_{s'\\sim P(\\cdot|s,a)}\\left[V_{\\widehat{P}}^\\pi(s')\\right]- \\mathbb{E}_{s' \\sim \\widehat{P}(\\cdot|s,a)}\\left[V_{\\widehat{P}}^\\pi(s')\\right]\\right].")
('14', 'V_{\\widehat{P}}^\\pi(s)')
('14', '-C\\le V_{\\widehat{P}}^\\pi(s)\\le C, \\ \\forall s\\in \\mathcal{S}')
('14', '\\left|V_{P}^\\pi-V_{\\widehat{P}}^\\pi \\right| \\le 2C \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a) \\sim d_{P}^\\pi}\\left[\\operatorname{TV}(P(\\cdot|s,a), \\widehat{P}(\\cdot|s,a))\\right].')
('14', 'V_{\\widehat{P}}^\\pi(s)')
('14', '0\\le V_{\\widehat{P}}^\\pi(s)\\le C, \\ \\forall s\\in \\mathcal{S}')
('14', '\\left|V_{P}^\\pi-V_{\\widehat{P}}^\\pi \\right| \\le C \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a) \\sim d_{P}^\\pi}\\left[\\operatorname{TV}(P(\\cdot|s,a), \\widehat{P}(\\cdot|s,a))\\right].')
('14', 'd_P^\\pi (\\cdot,\\cdot|s_0,a_0)')
('14', '(s,a)')
('14', '(S_0=s_0, A_0=a_0)')
('14', 'P')
('14', 'd_P^\\pi (\\cdot,\\cdot|s_0,a_0)= (1-\\gamma) \\sum_{t=0}^\\infty \\gamma^t P^\\pi (S_t=\\cdot \\ , A_t=\\cdot \\ |s_0,a_0).')
('14', '(s_0,a_0),')
('14', '\\label{simu lemma eq 1}\nQ_P^\\pi(s_0, a_0)= \\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}[r(s,a)].')
('14', '(s,a)')
('14', "\\label{simu lemma eq 2}\nQ_P^\\pi(s, a)= r(s,a)+ \\gamma \\mathbb{E}_{s'\\sim P(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')} \\left[Q_P^\\pi(s', a')\\right].")
('14', "\\label{simu lemma eq 3}\nQ_{\\widehat{P}}^\\pi(s, a)= r(s,a)+ \\gamma \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')} \\left[Q_{\\widehat{P}}^\\pi(s', a')\\right].")
('14', 'r(s,a)')
('14', 'r(s,a)')
('14', "\\label{simu lemma eq 4}\nQ_P^\\pi(s_0, a_0)= \\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}\\left[ Q_{\\widehat{P}}^\\pi(s, a)- \\gamma \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')} Q_{\\widehat{P}}^\\pi(s', a') \\right].")
('14', 'Q_P^\\pi(s_0, a_0)')
('14', "\\begin{aligned}\n&\\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}[r(s,a)]\\\\\n&= Q_P^\\pi(s_0, a_0)\\\\\n&= r(s_0,a_0)+ \\gamma \\mathbb{E}_{s\\sim P(\\cdot|s_0,a_0), a\\sim \\pi(\\cdot|s)} \\left[Q_P^\\pi(s, a)\\right]\\\\\n&= r(s_0,a_0)+ \\gamma \\mathbb{E}_{s\\sim P(\\cdot|s_0,a_0), a\\sim \\pi(\\cdot|s)} \\left[ \\frac{1}{1-\\gamma} \\mathbb{E}_{(s',a')\\sim d_P^\\pi(\\cdot,\\cdot|s,a)}[r(s',a')] \\right].\n\\end{aligned}")
('14', "\\begin{aligned}\n-r(s_0,a_0)=&\\ \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{s\\sim P(\\cdot|s_0,a_0), a\\sim \\pi(\\cdot|s)} \\left[\\mathbb{E}_{(s',a')\\sim d_P^\\pi(\\cdot,\\cdot|s,a)}[r(s',a')] \\right]\\\\\n&- \\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}[r(s,a)].\n\\end{aligned}")
('14', 'r:\\mathcal{S}\\times\\mathcal{A}\\to \\mathbb{R}')
('14', 'r(\\cdot,\\cdot)')
('14', 'Q_{\\widehat{P}}^\\pi(\\cdot,\\cdot)')
('14', "\\label{simu lemma eq 5}\n\\begin{split}\n-Q_{\\widehat{P}}^\\pi(s_0,a_0)=&\\ \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{s\\sim P(\\cdot|s_0,a_0), a\\sim \\pi(\\cdot|s)} \\left[\\mathbb{E}_{(s',a')\\sim d_P^\\pi(\\cdot,\\cdot|s,a)}[Q_{\\widehat{P}}^\\pi(s',a')] \\right]\\\\\n&- \\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}[Q_{\\widehat{P}}^\\pi(s,a)].\n\\end{split}")
('14', "\\label{simu lemma eq 6}\n\\begin{split}\nQ_P^\\pi(s_0,a_0)-Q_{\\widehat{P}}^\\pi(s_0,a_0)=& \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{s\\sim P(\\cdot|s_0,a_0), a\\sim \\pi(\\cdot|s)} \\left[\\mathbb{E}_{(s',a')\\sim d_P^\\pi(\\cdot,\\cdot|s,a)}Q_{\\widehat{P}}^\\pi(s',a') \\right]\\\\\n&- \\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}\\left[ \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')} Q_{\\widehat{P}}^\\pi(s', a') \\right].\n\\end{split}")
('14', "\\begin{aligned}\n\\mathbb{E}_{s\\sim P(\\cdot|s_0,a_0), a\\sim \\pi(\\cdot|s)} \\mathbb{E}_{(s',a')\\sim d_P^\\pi(\\cdot,\\cdot|s,a)} [\\cdot]&= \\mathbb{E}_{(s',a')\\sim \\widetilde{d}_P^\\pi(\\cdot,\\cdot|s_0,a_0)}[\\cdot]\\\\&= \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)} \\mathbb{E}_{s'\\sim P(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')}[\\cdot]\n\\end{aligned}")
('14', '\\widetilde{d}_P^\\pi(s,a|s_0,a_0):= (1-\\gamma)\\sum_{t=0}^\\infty \\gamma^t P^\\pi (S_{t+1}=s,A_{t+1}=a|S_0=s_0,A_0=a_0)')
('14', "\\begin{aligned}\n&Q_P^\\pi(s_0,a_0)-Q_{\\widehat{P}}^\\pi(s_0,a_0)\\\\&= \\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}\\left[ \\mathbb{E}_{s'\\sim P(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')} Q_{\\widehat{P}}^\\pi(s', a')- \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a), a'\\sim \\pi(\\cdot|s')} Q_{\\widehat{P}}^\\pi(s', a') \\right]\\\\\n&= \\frac{\\gamma}{1-\\gamma}\\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}\\left[ \\mathbb{E}_{s'\\sim P(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s')- \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s') \\right].\n\\end{aligned}")
('14', 'V_P^\\pi(s_0)')
('14', 'V_{\\widehat{P}}^\\pi(s_0)')
('14', '\\mu')
('14', 'd_P^\\pi')
('14', '\\mu')
('14', "\\begin{aligned}\nV_P^\\pi-V_{\\widehat{P}}^\\pi&= \\mathbb{E}_{s_0\\sim \\mu} \\left[V_P^\\pi(s_0)-V_{\\widehat{P}}^\\pi(s_0)\\right]\\\\\n&= \\mathbb{E}_{s_0\\sim \\mu, a_0\\sim \\pi(\\cdot|s_0)}\\left[ Q_P^\\pi(s_0,a_0)-Q_{\\widehat{P}}^\\pi(s_0,a_0)\\right]\\\\\n&= \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{s_0\\sim \\mu, a_0\\sim \\pi(\\cdot|s_0)} \\mathbb{E}_{(s,a)\\sim d_P^\\pi(\\cdot,\\cdot|s_0,a_0)}\\left[ \\mathbb{E}_{s'\\sim P(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s')- \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s') \\right]\\\\\n&= \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi}\\left[ \\mathbb{E}_{s'\\sim P(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s')- \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s') \\right],\n\\end{aligned}")
('14', "\\label{simu lemma eq 7}\n\\begin{split}\n\\left| V_P^\\pi-V_{\\widehat{P}}^\\pi \\right| &= \\frac{\\gamma}{1-\\gamma} \\left| \\mathbb{E}_{(s,a)\\sim d_P^\\pi}\\left[ \\mathbb{E}_{s'\\sim P(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s')- \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s') \\right] \\right| \\\\\n&\\le \\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi} \\left| \\mathbb{E}_{s'\\sim P(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s')- \\mathbb{E}_{s'\\sim \\widehat{P}(\\cdot|s,a)} V_{\\widehat{P}}^\\pi(s') \\right|.\n\\end{split}")
('14', 'q_1')
('14', 'q_2')
('14', 'C')
('14', '-C\\le f(x)\\le C')
('14', '\\text{TV}(q_1, q_2)=\\frac{1}{2}\\|q_1-q_2\\|_1')
('14', '\\label{simu lemma eq 8}\n\\begin{split}\n\\left| \\mathbb{E}_{x\\sim q_1}f(x)- \\mathbb{E}_{x\\sim q_2}f(x) \\right| &= \\left| \\int f(x) (q_1(x)-q_2(x)) dx \\right| \\\\\n&= \\|f(q_1-q_2)\\|_1 \\le \\|f\\|_\\infty \\|q_1-q_2\\|_1\\le 2C \\text{TV}(q_1,q_2).\n\\end{split}')
('14', '\\left| V_P^\\pi-V_{\\widehat{P}}^\\pi \\right| \\le 2C\\frac{\\gamma}{1-\\gamma} \\mathbb{E}_{(s,a)\\sim d_P^\\pi} \\left[ \\text{TV}(P(\\cdot|s,a), \\widehat{P}(\\cdot|s,a)) \\right],')
('14', '0\\le f(x)\\le C')
('14', '\\begin{aligned}\n&\\left| \\mathbb{E}_{x\\sim q_1}f(x)- \\mathbb{E}_{x\\sim q_2}f(x) \\right|\\\\ &= \\left| \\int f(x) (q_1(x)-q_2(x)) dx \\right| \\\\\n&= \\left| \\int f(x)(q_1(x)-q_2(x)) \\mathbf{1}\\{q_1(x)>q_2(x)\\} dx - \\int f(x) (q_2(x)-q_1(x)) \\mathbf{1}\\{q_1(x)\\le q_2(x)\\} dx\\right|.\n\\end{aligned}')
('14', '\\begin{aligned}\n& \\left| \\mathbb{E}_{x\\sim q_1}f(x)- \\mathbb{E}_{x\\sim q_2}f(x) \\right| \\\\\n&\\le  \\max \\left\\{ \\int f(x)(q_1(x)-q_2(x)) \\mathbf{1}\\{q_1(x)>q_2(x)\\} dx , \\int f(x) (q_2(x)-q_1(x)) \\mathbf{1}\\{q_1(x)\\le q_2(x)\\} dx \\right\\}\\\\\n&\\le C \\max \\left\\{ \\int (q_1(x)-q_2(x)) \\mathbf{1}\\{q_1(x)>q_2(x)\\} dx , \\int (q_2(x)-q_1(x)) \\mathbf{1}\\{q_1(x)\\le q_2(x)\\} dx \\right\\}\\\\\n&= C \\text{TV}(q_1,q_2),\n\\end{aligned}')
('14', 'f')
('14', '\\mu')
('14', 'f(y) \\geq f(x)+\\nabla f(x)^T(y-x)+\\frac{\\mu}{2}\\|y-x\\|^2,')
('14', 'g')
('14', 'f+g')
('14', '\\mu')
('14', 'g')
('14', 'g(y) \\geq g(x)+\\nabla g(x)^T(y-x).')
('14', 'f(y)+g(y) \\geq f(x)+g(x)+(\\nabla f(x)^T+\\nabla g(x)^T)(y-x)+\\frac{\\mu}{2}\\|y-x\\|^2,')
('14', '\\mathcal{F}')
('14', 'f^*')
('14', '\\delta_n^2 \\geq \\frac{c}{n}')
('14', '\\overline{\\mathcal{R}}_n\\left(\\delta ; \\mathcal{F}^*\\right) \\leq \\delta^2 .')
('14', '\\sup _{f \\in \\mathcal{F}} \\frac{\\left|\\mathbb{P}_n\\left(\\mathcal{L}_f-\\mathcal{L}_f\\right)-\\mathbb{P}\\left(\\mathcal{L}_f-\\mathcal{L}_f\\right)\\right|}{\\left\\|f-f^*\\right\\|_2+\\delta_n} \\leq 10 L \\delta_n')
('14', '1-c_1 e^{-c_2 n \\delta_n^2}')
('14', '\\gamma')
('14', '\\widehat{f} \\in \\mathcal{F}')
('14', '\\mathbb{P}_n\\left(\\mathcal{L}_{\\widehat{f}}-\\mathcal{L}_f\\right) \\leq 0')
('14', '\\left\\|\\widehat{f}-f^*\\right\\|_2 \\leq\\left(\\frac{20 L}{\\gamma}+1\\right) \\delta_n')
('14', '\\mathbb{P}\\left(\\mathcal{L}_{\\widehat{f}}-\\mathcal{L}_f\\right) \\leq 10 L\\left(\\frac{20 L}{\\gamma}+2\\right) \\delta_n^2,')
('14', '\\delta_n')
('14', '\\delta_n^2 \\geq\\left(1+\\frac{b}{v}\\right) \\frac{1}{n}')
('14', '\\widehat{f}')
('14', 'H^2\\left(\\widehat{f} \\| f^*\\right) \\leq c_0 \\delta_n^2')
('14', '1-c_1 e^{-c_2 \\frac{v}{b+n} n \\delta_n^2}')
('14', 'b>0')
('14', '\\epsilon_b>0')
('14', 'p')
('14', 'q')
('14', '0<d_H^2(p, q)<\\epsilon_b P(p / q)^b')
('14', '\\begin{aligned}\n& K(p ; q) \\lesssim d_H^2(p, q)\\left(1+\\frac{1}{b} \\log _{-} d_H(p, q)+\\frac{1}{b} \\log _{+} P\\left(\\frac{p}{q}\\right)^b\\right)+1-Q(\\mathfrak{X}), \\\\\n& V_2(p ; q) \\lesssim d_H^2(p, q)\\left(1+\\frac{1}{b} \\log _{-} d_H(p, q)+\\frac{1}{b} \\log _{+} P\\left(\\frac{p}{q}\\right)^b\\right)^2 .\n\\end{aligned}')
('14', 'p')
('14', 'q')
('14', '0<\\epsilon<0.4')
('14', '\\begin{gathered}\nK(p ; q) \\leq d_H^2(p, q)\\left(1+2 \\log _{-} \\epsilon\\right)+2 P\\left[\\left(\\log \\frac{p}{q}\\right) \\mathbb{I}\\{q / p \\leq \\epsilon\\}\\right], \\\\\nV_2(p ; q) \\leq d_H^2(p, q)\\left(12+2 \\log _{-}^2 \\epsilon\\right)+8 P\\left[\\left(\\log \\frac{p}{q}\\right)^2 \\mathbb{I}\\{q / p \\leq \\epsilon\\}\\right] .\n\\end{gathered}')
('14', 'p')
('14', 'q')
('14', '\\begin{aligned}\n& K(p ; q) \\lesssim d_H^2(p, q)\\left(1+\\log \\left\\|\\frac{p}{q}\\right\\|_{\\infty}\\right) \\leq 2 d_H^2(p, q)\\left\\|\\frac{p}{q}\\right\\|_{\\infty}, \\\\\n& V_2(p ; q) \\lesssim d_H^2(p, q)\\left(1+\\log \\left\\|\\frac{p}{q}\\right\\|_{\\infty}\\right)^2 \\leq 2 d_H^2(p, q)\\left\\|\\frac{p}{q}\\right\\|_{\\infty} .\n\\end{aligned}')
('15', '\\Tilde{Q}_{\\omega,t}(s,A_i)')
('15', 't')
('15', 'i=1,...,m')
('15', '\\Tilde{Q}_{\\omega,t}(s,a)')
('15', 'f_{t-1,i}(s;\\widehat{\\beta}_{t-1,i})')
('15', 's_0=s')
('15', 'a_0=A_i')
('15', 'h=0')
('15', 'q=r(s_0,A_i)')
('15', 'U\\sim \\operatorname{unif}[0,1]')
('15', 's_{h}\\sim P_t(\\cdot\\mid s_{h-1},a_{h-1})')
('15', "\\begin{aligned}\n                                   &\\pi_{t}(s_{h})=\\underset{p' \\in \\Delta(\\mathcal{A})}{\\arg \\max }\\left\\{\\sum_{i=1}^mf_{t-1,i}(s;\\widehat{\\beta}_{t-1,i})p_i'-\\frac{1}{\\eta_t} \\omega(p')\\right\\}\\\\                                \n                               \\end{aligned}")
('15', 'a_{h}\\sim \\pi_{t}(s_{h})')
('15', 'q = q + r(s_{h},a_{h})')
('15', 'h = h + 1')
('15', '\\widehat{Q}_{P_t}^{\\pi_t}(s,A_i):=q')
('15', '\\Tilde{Q}_{\\omega,t}(s,A_i):=\\widehat{Q}_{P_t}^{\\pi_t}(s, A_i)+\\frac{1}{\\eta_t}\\nabla \\omega\\left(\\pi_t(s)\\right)_i')
('15', 'f_{t-1}(s,a;\\widehat{\\beta}_{t-1})')
('15', 's_0=s')
('15', 'a_0=a')
('15', 'h=0')
('15', 'q=r(s_0,a_0)')
('15', 'U\\sim \\operatorname{unif}[0,1]')
('15', 's_{h}\\sim P_t(\\cdot\\mid s_{h-1},a_{h-1})')
('15', "\\begin{aligned}\n                                   &\\pi_{t}(s_{h})=\\underset{a'\\in \\mathcal{A}}{\\arg \\max }\\left\\{f_{t-1}(s,a';\\widehat{\\beta}_{t-1})-\\frac{1}{\\eta_t} \\omega(a')\\right\\}\\\\                                \n                               \\end{aligned}")
('15', 'a_{h}\\sim \\pi_{t}(s_{h})')
('15', 'q = q + r(s_{h},a_{h})')
('15', 'h = h + 1')
('15', '\\widehat{Q}_{P_t}^{\\pi_t}(s,a):=q')
('15', '\\Tilde{Q}_{\\omega,t}(s,a):=\\widehat{Q}_{P_t}^{\\pi_t}(s, a)+\\frac{1}{\\eta_t}\\nabla \\omega\\left(\\pi_t(s)\\right)_i')
('16.0.0', 's_0 \\sim \\mathcal{U}(-2,2)')
('16.0.0', 'n')
('16.0.0', 's_{n+1}-s_{n}=:\\Delta s \\sim \\psi_{a}\\mathcal{N}(\\mu_{1,a},0.1)+(1-\\psi_a)\\mathcal{N}(\\mu_{2,a},0.1)')
('16.0.0', 'a\\in \\{-1,0,1\\}')
('16.0.0', '\\mu_{1,-1}=-2,\\mu_{2,-1}=0')
('16.0.0', '\\mu_{1,0}=\\mu_{1,1}=0')
('16.0.0', '\\mu_{2,0}=\\mu_{2,1}=2')
('16.0.0', '\\psi_{-1}=\\psi_{0}=0.6')
('16.0.0', '\\psi_{1}=0.4')
('16.0.0', '\\beta')
('16.0.0', "\\beta(a|s) =\n  \\begin{cases}\n  0.05  & a= 1,\\\\\n 0.05  & a= 0,\\\\\n  0.9  & a=- 1,\\\\\n  \\end{cases}\n    r(s') =\n  \\begin{cases}\n    -2 & -3\\leq s'\\leq 0,\\\\\n -1.8  & 3>s'> 0,\\\\\n  %0 \\, & s'\\leq -3 \\text{ or } \\geq 3.\\\\\n    0  & s'< -3,\\\\\n   0  & s'\\geq 3,\\\\\n  \\end{cases}")
('16.0.0', 's \\in \\mathbb{R}')
('16.0.0', '0')
('16.0.0', '50')
('16.0.0', '\\psi_{-1}')
('16.0.0', '\\psi_{0}')
('16.0.0', '\\psi_{1}')
('16.0.0', '\\hat{\\psi}_{-1}')
('16.0.0', '\\hat{\\psi}_{0}')
('16.0.0', '\\hat{\\psi}_{1}')
('16.0.0.0', 'D(\\cdot,\\cdot)')
('16.0.0.0', 'f_{t,i}(s,\\beta_{t,i})=\\beta_{t,i}^\\top e(s,A_i),\\forall i=1,...,m')
('16.0.0.0', 'e(s,A_i)')
('16.0.0.1', '\\hat{\\psi}_0')
('16.0.0.2', '\\eta')
('16.0.0.2', '\\kappa_1')
('16.0.0.2', '\\lambda')
('16.0.0.2', '\\gamma')
('16.1.0', '18')
('16.1.0', '\\eta')
('16.1.0', '\\kappa_1')
('16.1.0', '\\lambda')
('16.1.0', '\\gamma')
