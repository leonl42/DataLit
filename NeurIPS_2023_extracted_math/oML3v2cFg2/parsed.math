('1', '\\bullet')
('1', '\\bullet')
('1', '\\bullet')
('2', '(\\mathcal{S}, \\mathcal{A}, P, \\eta, r, \\gamma)')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', 'P: \\mathcal{S} \\times \\mathcal{A} \\times \\mathcal{S} \\to [0,1]')
('2', '\\eta(\\cdot)')
('2', 'r: \\mathcal{S} \\times \\mathcal{A} \\to \\mathbb{R}')
('2', '\\gamma \\in (0,1)')
('2', 'P')
('2', '\\pi')
('2', 'd^{\\pi}_{P}(s,a) := (1 - \\gamma) \\pi(a|s) \\sum_{t = 0}^{\\infty} \\gamma^t P^{\\pi}(s_t = s | s_0 \\sim \\eta)')
('2', '(s,a)')
('2', '\\tau^{\\rm E} := \\{(s_t, a_t)\\}_{t = 0}^{\\infty}')
('2', '\\pi^{\\rm E}')
('2', '\\tau^{\\rm A}')
('2', '\\pi')
('2', '\\begin{aligned}\n &\\max_{r} ~ \\min_{\\pi} ~ \\Big\\{ \\mathbb{E}_{\\tau^{\\rm E} \\sim \\pi^{\\rm E}} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\cdot r(s_t, a_t) \\Big] - \\mathbb{E}_{\\tau^{\\rm A} \\sim \\pi} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\cdot r(s_t, a_t) \\Big] - {H}(\\pi) \\Big\\} \\label{formulation:MaxEnt_IRL}\n\\end{aligned}')
('2', 'H(\\pi) := \\mathbb{E}_{\\tau \\sim \\pi}\\big[ \\sum_{t=0}^{\\infty} -\\gamma^t \\log \\pi(a_t | s_t) \\big]')
('2', '\\pi')
('2', '\\mathcal{D} := \\{ (s, a, s^\\prime) \\}')
('2', '\\widehat{P}(s^\\prime| s,a)')
('2', 's^{\\prime}, s \\in \\mathcal{S}')
('2', 'a \\in \\mathcal{A}')
('2', '\\widehat{P}')
('2', 'P')
('2', '\\widehat{P}')
('2', '\\label{formulation:offline_MLIRL}\n    \\begin{align} \n    \\max_{\\theta} &~~~~~L(\\theta) := \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\log \\pi_{\\theta}(a_t | s_t)  \\bigg] \\label{objective:ML}  \\\\\n    s.t. &~~~~\\pi_{\\theta} := \\arg \\max_{\\pi} ~ \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\bigg( r(s_t, a_t; \\theta)  + U(s_t, a_t) + \\mathcal{H} \\big(\\pi(\\cdot | s_t) \\big) \\bigg) \\bigg], \\label{constraint:MaxEnt_RL}\n\\end{align}')
('2', '\\mathcal{H}\\big( \\pi(\\cdot|s) \\big) := \\sum_{a \\in \\mathcal{A}} -\\pi(a|s) \\log \\pi(a|s)')
('2', '\\pi(\\cdot|s)')
('2', 'U(\\cdot,\\cdot)')
('2', '\\widehat{P}(\\cdot| s,a)')
('2', '(s,a)')
('2', 'r(\\cdot, \\cdot; \\theta)')
('2', '\\pi_{\\theta}')
('2', 'r(\\cdot, \\cdot; \\theta)')
('2', '\\pi_{\\theta}')
('2', 'L(\\theta)')
('2', '\\widehat{P}')
('2', '\\mathcal{D} := \\{ (s,a,s^\\prime) \\}')
('2', 'U(s,a)')
('2', '\\pi_{\\theta}')
('3', '\\widehat{P}')
('3', '\\mathcal{D} := \\{ (s,a,s^\\prime) \\}')
('3', '\\tau^{\\rm E}')
('3', 'P')
('3', '\\tau^{\\rm A}')
('3', '\\widehat{P}')
('3', '\\theta')
('3', '\\pi_{\\theta}')
('3', '\\begin{align}\n    V_{\\theta}(s) & := \\mathbb{E}_{\\tau \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t;\\theta) + U(s_t,a_t)  + \\mathcal{H}(\\pi_{\\theta}(\\cdot | s_t)) \\Big) \\Big | s_0 = s \\Big], \\label{eq:optimal_soft_V} \\\\\n    \\hspace{-0.2cm}Q_{\\theta}(s,a) & := r(s,a;\\theta) + U(s,a) + \\gamma  \\mathbb{E}_{s^\\prime \\sim \\widehat{P}(\\cdot|s,a)} \\big[ V_{\\theta}(s^\\prime) ]. \\label{def:optimal_soft_Q}\n\\end{align}')
('3', '\\pi_{\\theta}')
('3', 'V_{\\theta}')
('3', '(s,a)')
('3', '\\begin{aligned}\n    \\pi_{\\theta}(a|s) = \\frac{\\exp Q_{\\theta}(s,a)}{\\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta}(s,\\tilde{a})}, \\quad V_{\\theta}(s) =  \\log \\Big( \\sum_{a \\in \\mathcal{A}} \\exp Q_{\\theta}(s,a) \\Big). \\label{closed_form:optimal_policy_V}\n\\end{aligned}')
('3', 'P')
('3', '\\eta(\\cdot)')
('3', 'd^{\\rm E}(s,a)')
('3', '\\pi^{\\rm E}')
('3', '\\begin{aligned}\n    d^{\\rm E}(s,a) := (1 - \\gamma) \\pi^{\\rm E}(a|s) \\sum_{t = 0}^{\\infty} \\gamma^t P^{\\pi^{\\rm E}}(s_t = s | s_0 \\sim \\eta). \\label{def:expert_visitation_measure}\n\\end{aligned}')
('3', '\\pi_{\\theta}')
('3', 'L(\\theta)')
('3', '\\theta')
('3', 'L(\\theta)')
('3', '\\begin{aligned}\n        L(\\theta) &= \\widehat{L}(\\theta) + \\frac{\\gamma}{1 - \\gamma} \\cdot \\mathbb{E}_{(s_t, a_t) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[ \\sum_{s^\\prime \\in \\mathcal{S}} V_{\\theta}(s^\\prime) \\Big( \\widehat{P}(s^\\prime| s, a) - P(s^\\prime| s, a) \\Big) \\Big] \\label{eq:likelihood_decomposition}\n    \n\\end{aligned}')
('3', '\\widehat{L}(\\theta)')
('3', '\\begin{aligned}\n        \\widehat{L}(\\theta) &:=  \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) \\Big) \\Big] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[ V_{\\theta}(s_0) \\bigg]. \\label{def:surrogate_objective}\n    \n\\end{aligned}')
('3', '\\widehat{L}(\\theta)')
('3', '\\widehat{P}')
('3', 'P')
('3', '\\widehat{L}(\\cdot)')
('3', '\\widehat{P}')
('3', 'P')
('3', 'L(\\theta)')
('3', '\\widehat{L}(\\theta)')
('3', '\\theta')
('3', '(s,a)')
('3', '\\begin{aligned}\n            |r(s,a;\\theta)| \\leq C_r, \\quad |U(s,a)| \\leq C_u  \\label{ineq:bound_reward_penalty} \n        \n\\end{aligned}')
('3', 'C_r')
('3', 'C_{u}')
('3', 'C_v')
('3', '\\begin{aligned}\n        |L(\\theta) - \\widehat{L}(\\theta)| \\leq \\frac{\\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a) \\sim d^{\\rm E}(\\cdot, \\cdot)}\\big[ \\| P(\\cdot|s,a) - \\widehat{P}(\\cdot|s,a) \\|_1 \\big]. \\label{ineq:objective_gap}\n    \n\\end{aligned}')
('3', '\\mathbb{E}_{(s,a) \\sim d^{\\rm E}(\\cdot, \\cdot)}\\big[ \\| P(\\cdot|s,a) - \\widehat{P}(\\cdot|s,a) \\|_1 \\big]')
('3', '|L(\\theta) - \\widehat{L}(\\theta)|')
('3', 'd^{\\rm E}(\\cdot, \\cdot)')
('3', '\\widehat{P}')
('3', '\\mathcal{S} \\times \\mathcal{A}')
('3', '\\mathcal{D} := \\{ (s,a,s^{\\prime}) \\}')
('3', '\\Omega := \\{ (s,a) | d^{\\rm E}(s,a) > 0 \\}')
('3', '\\widehat{L}(\\theta)')
('3', 'L(\\theta)')
('3', '\\widehat{P}')
('3', 'L(\\theta)')
('3', '\\widehat{L}(\\theta)')
('3', '|\\mathcal{S}| < \\infty')
('3', '|\\mathcal{A}| < \\infty')
('3', '\\mathcal{D} = \\{(s,a,s^\\prime)\\}')
('3', '\\widehat{P}')
('3', '\\Omega := \\{ (s,a) | d^{\\rm E}(s,a)>0 \\}')
('3', '\\mathcal{S}^{\\rm E} := \\{s| \\sum_{a \\in \\mathcal{A}} d^{\\rm E}(s,a) > 0 \\} \\subseteq \\mathcal{S}')
('3', '\\varepsilon \\in (0,2)')
('3', 'N')
('3', '(s,a) \\in \\Omega')
('3', '\\begin{aligned}\n    \\#\\textit{transition samples} \\geq |\\Omega| \\cdot N \\geq \\frac{c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{\\varepsilon^2} \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) \\nonumber\n\\end{aligned}')
('3', 'c')
('3', '\\delta')
('3', '1 - \\delta')
('3', '\\begin{aligned}\n    &\\mathbb{E}_{(s,a) \\sim d^{\\rm E}(\\cdot, \\cdot)}\\big[ \\| P(\\cdot|s,a) - \\widehat{P}(\\cdot|s,a) \\|_1 \\big] \\leq \\varepsilon, \\quad  %\\label{concentration_analysis:dynamics_model} \\\\\n    | L(\\theta) - \\widehat{L}(\\theta)| \\leq \\frac{ \\gamma C_v }{1 - \\gamma} \\varepsilon. \\label{concentration_analysis:surrogate_objective}\n\\end{aligned}')
('3', '\\widehat{P}')
('3', '\\widehat{L}(\\theta)')
('3', 'L(\\theta)')
('3', '\\widehat{L}(\\cdot)')
('3', 'L(\\cdot)')
('3', '\\widehat{L}(\\cdot)')
('3', '\\begin{aligned}\n    \\theta^* \\in \\arg\\max_{\\theta} ~ L(\\theta), \\quad \\hat{\\theta} \\in \\arg\\max_{\\theta} ~ \\widehat{L}(\\theta). \\nonumber\n\\end{aligned}')
('3', '\\hat{\\theta}')
('3', '\\theta^*')
('3', '\\varepsilon \\in (0,\\frac{4\\gamma C_v}{1 - \\gamma})')
('3', 'N')
('3', '(s,a) \\in \\Omega')
('3', '\\mathcal{D}')
('3', '\\begin{aligned}\n    \\#\\textit{transition samples} \\geq |\\Omega| \\cdot N \\geq \\frac{4\\gamma^2 \\cdot C_v^2 \\cdot c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{ (1-\\gamma)^2 \\varepsilon^2  } \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) \\nonumber\n\\end{aligned}')
('3', 'c')
('3', '\\delta')
('3', '1 - \\delta')
('3', '\\begin{aligned}\n    L(\\theta^*) - L(\\hat{\\theta}) \\leq \\varepsilon. \\label{ineq:performance_difference_guarantee}\n\\end{aligned}')
('4', '\\widehat{L}(\\cdot)')
('4', '\\hat{\\theta}')
('4', '\\widehat{L}(\\cdot)')
('4', 'V_{\\theta}(\\cdot)')
('4', '\\pi_{\\theta}')
('4', '\\widehat{L}(\\cdot)')
('4', '\\theta')
('4', '\\pi_{\\theta}')
('4', '\\begin{aligned}\n    \\max_{\\theta} \\;\\widehat{L}(\\theta), \\quad  \\mbox {\\rm s.t.} ~~~~\\pi_{\\theta} := \\arg \\max_{\\pi} ~ \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta)  + U(s_t, a_t) + \\mathcal{H} \\big(\\pi(\\cdot | s_t) \\big) \\Big) \\Big]. \\label{formulation:bi_level}\n\\end{aligned}')
('4', '\\pi_{\\theta}')
('4', '\\theta')
('4', 'k')
('4', '\\pi_k')
('4', '\\theta_k')
('4', '\\pi_{k+1}')
('4', '\\widehat{P}')
('4', '\\theta_{k+1}')
('4', '\\theta_k')
('4', '\\pi_{k+1}')
('4', '\\pi_{\\theta_k}')
('4', 'V_{\\theta}')
('4', 'Q_{\\theta}')
('4', '\\pi_k')
('4', 'r(\\cdot, \\cdot; \\theta_k)')
('4', '\\widehat{P}')
('4', 'V_k(\\cdot)')
('4', 'Q_k(\\cdot, \\cdot)')
('4', '\\widehat{Q}_k(s,a)')
('4', '\\epsilon_{\\rm app}>0')
('4', '\\begin{aligned}\n    \\| \\widehat{Q}_k - Q_k \\|_{\\infty} := \\max_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} | \\widehat{Q}_k(s,a) - Q_k(s,a) | \\leq \\epsilon_{\\rm app}. \\label{def:soft_Q_approximation}\n\\end{aligned}')
('4', '\\widehat{Q}_k')
('4', '\\pi_{k+1}')
('4', '\\begin{aligned}\n    \\pi_{k+1}(a|s) \\propto \\exp \\big( \\widehat{Q}_k(s,a) \\big), \\quad \\forall s \\in \\mathcal{S}, a \\in \\mathcal{A}. \\label{def:soft_policy_iteration}\n\\end{aligned}')
('4', '\\epsilon_{\\rm app}')
('4', 'k')
('4', '\\theta_k')
('4', '\\pi_{k+1}')
('4', '\\theta_{k+1}')
('4', '\\nabla \\widehat{L}(\\theta_k)')
('4', '\\widehat{L}(\\theta)')
('4', '\\begin{aligned}\n        \\nabla  \\widehat{L}(\\theta) &= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta,\\pi^{\\rm E},P)}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta} \n        \\nabla_{\\theta} r(s_t, a_t;\\theta)\n        \\Big] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\theta},\\widehat{P})}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta)\n        \\Big]. \\label{eq:surrogate_objective_grad}\n    \n\\end{aligned}')
('4', '\\pi_{\\theta}')
('4', 'k')
('4', '\\pi_{k+1}')
('4', '\\nabla  \\widehat{L}(\\theta)')
('4', '\\tau_k^{\\rm E}')
('4', '\\tau_k^{\\rm A}')
('4', '\\pi_{k+1}')
('4', '\\widehat{P}')
('4', 'g_k')
('4', '\\nabla \\widehat{L}(\\theta_k)')
('4', '\\begin{aligned}\n    g_k := h(\\theta_k; \\tau_k^{\\rm E}) - h(\\theta_k; \\tau_k^{\\rm A}), \\label{eq:stochastic_grad_estimator}\n\\end{aligned}')
('4', 'h(\\theta; \\tau) := \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta)')
('4', '\\begin{aligned}\n    \\theta_{k+1} = \\theta_k + \\alpha g_k \\label{eq:reward_parameter_update}\n\\end{aligned}')
('4', '\\theta_0')
('4', '\\pi_0')
('4', '\\alpha')
('4', '\\widehat{P}')
('4', '\\mathcal{D}')
('4', 'U(\\cdot,\\cdot)')
('4', '\\widehat{P}')
('4', 'Q_k(\\cdot, \\cdot)')
('4', '\\widehat{Q}_k(\\cdot, \\cdot)')
('4', '\\pi_{k+1}(\\cdot|s) \\propto \\exp\\big( \\widehat{Q}_k(s,\\cdot) \\big), \\forall s \\in \\mathcal{S}')
('4', '\\tau_k^{\\rm E} := \\{ s_t, a_t \\}_{t \\geq 0}')
('4', '\\tau_k^{\\rm A} := \\{ s_t, a_t \\}_{t \\geq 0}')
('4', '\\pi_{k+1}')
('4', '\\widehat{P}')
('4', 'g_k := h(\\theta_{k}; \\tau_k^{\\rm E}) - h(\\theta_{k}; \\tau_k^{\\rm A})')
('4', 'h(\\theta; \\tau) := \\sum_{t \\geq 0} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta)')
('4', '\\theta_{k+1} := \\theta_{k} + \\alpha g_k')
('5', '\\pi_{k+1}')
('5', '\\pi_{\\theta_k}')
('5', 'k')
('5', 'g_k')
('5', '\\nabla \\widehat{L}(\\theta_k)')
('5', '\\alpha')
('5', '\\theta')
('5', '\\{ \\pi_{k+1} \\}_{k \\geq 0}')
('5', '\\{ \\pi_{\\theta_k} \\}_{k \\geq 0}')
('5', '\\pi')
('5', '\\widehat{P}')
('5', '\\kappa > 0')
('5', '\\rho \\in (0,1)')
('5', '\\begin{aligned}\n        \\max_{s \\in \\mathcal{S}} ~ \\| \\widehat{P}(s_t \\in \\cdot| s_0 = s, \\pi) -  \\mu^{\\pi}_{\\widehat{P}}(\\cdot) \\|_{\\rm TV} \\leq \\kappa \\rho^t, \\quad \\forall ~ t \\geq 0  \\nonumber\n    \n\\end{aligned}')
('5', '\\| \\cdot \\|_{\\rm TV}')
('5', '\\mu^{\\pi}_{\\widehat{P}}')
('5', '\\pi')
('5', '\\widehat{P}')
('5', '\\theta')
('5', 's \\in \\mathcal{S}')
('5', 'a \\in \\mathcal{A}')
('5', '\\begin{aligned}\n        \\big \\| \\nabla_{\\theta} r(s, a; \\theta) \\big  \\|  \\leq L_r, \\quad \\big \\|   \\nabla_{\\theta} r(s, a; \\theta_1)  - \\nabla_{\\theta} r(s, a; \\theta_2)  \\big \\|   \\leq  L_g \\|  \\theta_{1} - \\theta_{2} \\|, \\label{ineq:bounded_reward_gradient} \n        \n\\end{aligned}')
('5', 'L_r')
('5', 'L_g')
('5', '\\theta_1')
('5', '\\theta_2')
('5', '\\begin{align}\n        &| Q_{\\theta_1}(s,a)  - Q_{\\theta_2}(s,a) | \\leq L_q \\| \\theta_{1} - \\theta_2 \\|, ~ \\forall s \\in \\mathcal{S}, a \\in \\mathcal{A}  \\label{ineq:soft_Q_Lipschitz} \\\\\n        &\\| \\nabla \\widehat{L}(\\theta_{1}) - \\nabla \\widehat{L}(\\theta_{2}) \\| \\leq L_c \\| \\theta_1 - \\theta_2 \\|  \\label{ineq:objective_lipschitz_smooth}\n    \\end{align}')
('5', 'L_q')
('5', 'L_c')
('5', '\\{ \\pi_{k+1} \\}_{k\\geq0}')
('5', '\\{ \\theta_k \\}_{k \\geq 0}')
('5', 'K')
('5', '\\alpha = \\alpha_0 \\cdot K^{-\\frac{1}{2}}')
('5', '\\alpha_0>0')
('5', '\\small\n        \\begin{align}\n        &\\frac{1}{K}\\sum_{k = 0}^{K-1} \\mathbb{E} \\Big[ \\big \\|  \\log\\pi_{k+1} - \\log\\pi_{\\theta_k} \\big \\|_{\\infty} \\Big] = \\mathcal{O}(K^{-\\frac{1}{2}}) + \\mathcal{O}(\\epsilon_{\\rm app}) \\label{rate:lower_error} \\\\\n        &\\frac{1}{K} \\sum_{k = 0}^{K - 1} \\mathbb{E} \\Big[ \\|  \\nabla \\widehat{L}(\\theta_{k})  \\|^2 \\Big] = \\mathcal{O}(K^{-\\frac{1}{2}}) + \\mathcal{O}(\\epsilon_{\\rm app}) \\label{rate:upper_grad_norm}\n    \\end{align}')
('5', '\\|  \\log\\pi_{k+1} - \\log\\pi_{\\theta_k} \\|_{\\infty} := \\max_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\big| \\log\\pi_{k+1}(a|s) - \\log\\pi_{\\theta_k}(a|s) \\big|')
('5', '\\epsilon_{\\rm app}')
('5', 'r(s,a;\\theta) := \\phi(s,a)^{\\top} \\theta')
('5', '\\phi(s,a)')
('5', '(s,a)')
('5', '\\varepsilon \\in (0, \\frac{4\\gamma C_v}{1 - \\gamma})')
('5', 'N')
('5', '(s,a) \\in \\Omega')
('5', '\\mathcal{D}')
('5', '\\begin{aligned}\n    \\#\\textit{transition samples} \\geq |\\Omega| \\cdot N \\geq \\frac{4\\gamma^2 \\cdot C_v^2 \\cdot c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{ (1-\\gamma)^2 \\varepsilon^2  } \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) \\nonumber\n\\end{aligned}')
('5', 'c')
('5', '\\delta')
('5', '1 - \\delta')
('5', '\\tilde{\\theta}')
('5', '\\widehat{L}(\\cdot)')
('5', '\\begin{aligned}\n    L(\\theta^*) - L(\\tilde{\\theta}) \\leq \\varepsilon \\label{performance_guarantee:stationary_point}\n\\end{aligned}')
('5', '\\theta^*')
('5', 'L(\\cdot)')
('5', '\\begin{aligned}\n    L(\\theta^*) - L(\\tilde{\\theta}) = \\frac{1}{1 - \\gamma} \\mathbb{E}_{s \\sim d^{\\rm E}(\\cdot), a \\sim \\pi^{\\rm E}(\\cdot | s)} \\big[ \\log \\big( \\frac{\\pi_{\\theta^*}(a|s)}{\\pi_{\\tilde{\\theta}}(a|s)} \\big) \\big] \\leq \\varepsilon.   \\nonumber\n\\end{aligned}')
('5', '\\theta^*')
('5', '\\pi^{\\rm E} = \\pi_{\\theta^*}')
('5', '\\begin{aligned}\n    L(\\theta^*) - L(\\tilde{\\theta}) = \\frac{1}{1 - \\gamma} \\mathbb{E}_{s \\sim d^{\\rm E}(\\cdot), a \\sim \\pi^{\\rm E}(\\cdot | s)} \\big[ \\log \\big( \\frac{\\pi^{\\rm E}(a|s)}{\\pi_{\\tilde{\\theta}}(a|s)} \\big) \\big] = \\frac{1}{1 - \\gamma} \\mathbb{E}_{s \\sim d^{\\rm E}(\\cdot)} \\big[ D_{KL}\\big( \\pi^{\\rm E}(\\cdot | s) || \\pi_{\\tilde{\\theta}}(\\cdot | s) \\big) \\big] \\leq \\varepsilon. \\nonumber\n\\end{aligned}')
('5', '\\pi_{\\tilde{\\theta}}')
('5', '\\epsilon')
('5', '\\pi^{\\rm E}')
('5', '\\theta')
('5', '\\tilde{\\theta}')
('5', '\\pi_{\\tilde{\\theta}}')
('5', '\\tilde{\\theta}')
('6', '6')
('6', 'N')
('6', '\\{ \n\\widehat{P}^{i}_{\\phi, \\varphi}(s_{t+1} | s_t, a_t) = \\mathcal{N}(\\mu^{i}_{\\phi}(s_t, a_t), \\Sigma_{\\varphi}^{i}(s_t, a_t))\\}_{i=1}^{N}')
('6', 'U(s,a) = -\\max_{i = 1, \\cdots N} \\| \\Sigma_{\\varphi}^{i}(s, a)) \\|_{\\rm F}')
('6', '(s,a,s^\\prime)')
('6', 'r(\\cdot, \\cdot;\\theta)')
('6', '\\{ \\big(s,a,r(s,a;\\theta), s^{\\prime} \\big) \\}')
('11', '1,000')
('11.0', '\\mathcal{D} = \\{(s,a,s^\\prime) \\}')
('11.0', '\\mathcal{D}^{\\rm E} = \\{ \\tau^{\\rm E} \\}')
('11.0', '1,000')
('11.0', '{(s,a,s^\\prime)}')
('11.0', '\\mathcal{D}^{\\rm E}')
('11.0', '10,000')
('11.0', 'D^{\\rm E}')
('11.0', '\\mathcal{D}')
('11.0', '\\mathcal{D}')
('11.0', '(256,256)')
('11.0', '(s,a)')
('11.0', 'r(s,a;\\theta)')
('11.0', '1 \\times 10^{-4}')
('11.0', 'U(\\cdot, \\cdot)')
('11.0', '20')
('11.0', '\\mathcal{D}^{\\rm E} = \\{ \\tau^{\\rm E} \\}')
('11.0', '\\widehat{P}')
('11.1', 'D^{\\rm E}')
('11.1', '1,000')
('11.1', '10,000')
('11.1', '1')
('11.1', '10')
('11.1', '1,000')
('11.1', 'r(\\cdot, \\cdot;\\theta)')
('11.1', 'r(\\cdot, \\cdot; \\theta)')
('11.1', '\\{ \n\\big( s,a,r(s,a;\\theta),s^\\prime \\big) \\}')
('11.1', '\\mathcal{D}')
('12', '\\{(s,a,s^\\prime)\\}')
('13', '\\theta')
('13', '(s,a)')
('13', '\\begin{aligned}\n            |r(s,a;\\theta)| \\leq C_r, \\quad |U(s,a)| \\leq C_u  \\nonumber\n        \n\\end{aligned}')
('13', 'C_r')
('13', 'C_{u}')
('13', '\\pi')
('13', '\\widehat{P}')
('13', '\\kappa > 0')
('13', '\\rho \\in (0,1)')
('13', '\\begin{aligned}\n        \\max_{s \\in \\mathcal{S}} ~ \\| \\widehat{P}(s_t \\in \\cdot| s_0 = s, \\pi) -  \\mu^{\\pi}_{\\widehat{P}}(\\cdot) \\|_{\\rm TV} \\leq \\kappa \\rho^t, \\quad \\forall ~ t \\geq 0  \\nonumber\n    \n\\end{aligned}')
('13', '\\| \\cdot \\|_{\\rm TV}')
('13', '\\mu^{\\pi}_{\\widehat{P}}')
('13', '\\pi')
('13', '\\widehat{P}')
('13', '\\theta')
('13', 's \\in \\mathcal{S}')
('13', 'a \\in \\mathcal{A}')
('13', '\\begin{align}\n        &\\big \\| \\nabla_{\\theta} r(s, a; \\theta) \\big  \\|  \\leq L_r, \\nonumber \\\\\n        &\\big \\|    \\nabla_{\\theta} r(s, a; \\theta_1)  - \\nabla_{\\theta} r(s, a; \\theta_2)  \\big \\|   \\leq  L_g \\|  \\theta_{1} - \\theta_{2} \\|, \\nonumber\n        \\end{align}')
('13', 'L_r')
('13', 'L_g')
('13', 'z')
('13', '\\{1, . . . , d\\}')
('13', 'q')
('13', 'q')
('13', '\\vec{q} = [\\text{Pr}(z = j)]^{d}_{j=1}')
('13', 'N')
('13', '\\vec{q}')
('13', '[\\hat{q}]_{j} = \\frac{1}{N} \\sum_{i=1}^{N} \\bm 1[z_i = j]')
('13', '\\hat{q}')
('13', 'd')
('13', '\\epsilon >0')
('13', '\\text{Pr} \\bigg( \\| \\hat{q} - \\vec{q} \\|_2 \\geq \\frac{1}{\\sqrt{N}} + \\epsilon \\bigg) \\leq e^{-N\\epsilon^2}, \\label{concentration:L2_norm}')
('13', '\\text{Pr} \\bigg( \\| \\hat{q} - \\vec{q} \\|_1 \\geq \\sqrt{d}\\big(\\frac{1}{\\sqrt{N}} + \\epsilon \\big) \\bigg) \\leq e^{-N\\epsilon^2}. \\label{concentration:L1_norm}')
('13', '\\eta(\\cdot)')
('13', 'P( \\cdot | s,a)')
('13', 'd_w(\\cdot, \\cdot)')
('13', '(s,a)')
('13', 'w')
('13', 'w')
('13', 'w^\\prime')
('13', '\\begin{aligned}\n        \\| d_{w}(\\cdot, \\cdot) - d_{w^\\prime}(\\cdot, \\cdot)  \\|_{\\rm TV} \\leq C_d \\| w - w^\\prime \\|    \\label{ineq:lipschitz_measure}\n    \n\\end{aligned}')
('13', 'C_d')
('13', '\\theta_k')
('13', '\\pi_{k+1}')
('13', 'Q_{k + \\frac{1}{2}}')
('13', 'Q_{k+1}')
('13', '\\theta_{k+1}')
('13', '\\pi_{k+1}')
('13', 's \\in \\mathcal{S}')
('13', 'a \\in \\mathcal{A}')
('13', 'k \\geq 0')
('13', '\\begin{aligned}\n         | Q_{k+    \\frac{1}{2}} (s,a) -  Q_{k+1} (s,a) | \\leq L_q \\| \\theta_{k} - \\theta_{k+1} \\|, \\label{Lipschitz:soft_Q_reward_gap}\n    \n\\end{aligned}')
('13', 'L_q := \\frac{L_r}{1 - \\gamma} >0')
('13', 'L_r')
('13', 'k\\geq0')
('13', '\\begin{align}\n     Q_{k}(s,a)  &\\leq Q_{k+\\frac{1}{2}}(s,a) + \\frac{2\\gamma \\epsilon_{\\rm app}}{1 - \\gamma}, \\quad \\forall s \\in \\mathcal{S}, a \\in \\mathcal{A} \\label{ineq:approx_soft_policy_improvement}, \\\\\n     \\| Q_{\\theta_k} - Q_{k+\\frac{1}{2}} \\|_{\\infty} &\\leq \\gamma \\| Q_{\\theta_k} - Q_{k} \\|_{\\infty} + \\frac{2\\gamma \\epsilon_{\\rm app}}{1 - \\gamma} \\label{ineq:soft_Q_contraction}\n\\end{align}')
('13', 'Q_{k+\\frac{1}{2}}(\\cdot, \\cdot)')
('13', '\\theta_k')
('13', '\\pi_{k+1}')
('13', 'Q_{\\theta_k}(\\cdot, \\cdot)')
('13', '\\theta_k')
('13', '\\pi_{\\theta_k}')
('13', '\\| Q_{\\theta_k} - Q_{k+\\frac{1}{2}} \\|_{\\infty} = \\max_{s \\in \n\\mathcal{S}} \\max_{a \\in \\mathcal{A}} | Q_{\\theta_k}(s,a) - Q_{k+\\frac{1}{2}}(s,a) |')
('13', 'Q_k')
('13', 'V_k')
('13', '\\begin{align}\n    &Q_k(s,a) := r(s,a; \\theta_k) + U(s,a) + \\gamma \\mathbb{E}_{s^\\prime \\sim \\widehat{P}(\\cdot | s,a)} \\big[ V_{k}(s^\\prime) \\big] \\label{def:soft_Q_iterate} \\\\\n    &V_k(s) := \\mathbb{E}_{\\tau \\sim (\\eta, \\pi_{k}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big( r(s_t, a_t;\\theta_k) + U(s_t,a_t) + \\mathcal{H}(\\pi_{k}(\\cdot | s_t)) \\Big) \\Big | s_0 = s \\Big] \\label{def:soft_V_iterate}\n\\end{align}')
('13', 'U(s,a)')
('13', '(s,a)')
('13', '\\widehat{P}')
('13', 'Q_k')
('13', 'Q_k(s,a) = \\tilde{r}(s,a; \\theta_k) + \\gamma \\mathbb{E}_{s^\\prime \\sim \\widehat{P}(\\cdot | s,a)} \\big[ V_{k}(s^\\prime) \\big]')
('13', '\\tilde{r}(s,a; \\theta_k) := r(s,a;\\theta_k) + U(s,a)')
('14', '\\pi_{\\theta}')
('14', 'V_{\\theta}')
('14', 'L(\\theta)')
('14', '\\begin{aligned}\n    L(\\theta) &= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\log \\pi_{\\theta}(a_t | s_t)  \\bigg] \\nonumber \\\\\n    &\\overset{(i)}{=} \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\log \\Big( \\frac{\\exp Q_{\\theta}(s_t, a_t)}{\\sum_{a \\in \\mathcal{A}} \\exp Q_{\\theta}(s_t, a)} \\Big) \\bigg] \\nonumber \\\\\n    &\\overset{(ii)}{=} \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( Q_{\\theta}(s_t, a_t) - V_{\\theta}(s_t) \\Big) \\bigg] \\nonumber \\\\\n    &= \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ Q_{\\theta}(s_t, a_t) \\bigg] - \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{s_t \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ V_{\\theta}(s_t) \\bigg] \\nonumber \\\\\n    &\\overset{(iii)}{=} \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ r(s_t, a_t; \\theta) + U(s_t, a_t) + { \\gamma} \\mathbb{E}_{s_{t+1} \\sim \\widehat{P}(\\cdot| s_t, a_t)} [ V_{\\theta}(s_{t+1}) ] \\bigg] - \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{s_t \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ V_{\\theta}(s_t) \\bigg] \\nonumber \\\\\n    &= \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ r(s_t, a_t; \\theta) + U(s_t, a_t) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[ V_{\\theta}(s_0) \\bigg] \\nonumber \\\\\n    & \\quad + \\bigg( \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P), s_{t+1} \\sim \\widehat{P}(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] - \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{s_{t+1} \\sim (\\eta, \\pi^{\\rm E}, P)} \\big[ V_{\\theta}(s_{t+1}) \\big] \\bigg) \\nonumber \\\\\n    &= \\underbrace{\\bigg( \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ r(s_t, a_t; \\theta) + U(s_t, a_t) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[ V_{\\theta}(s_0) \\bigg] \\bigg)}_{\\rm T1: ~\\text{\\footnotesize surrogate objective}} \\nonumber \\\\\n    & \\quad + \\underbrace{\\bigg( \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P), s_{t+1} \\sim \\widehat{P}(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] - \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P), s_{t+1} \\sim P(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] \\bigg)}_{\\rm T2:~\\text{\\footnotesize error term due to transition probability mismatch}} \\label{rewrite:likelihood_obj}\n\\end{aligned}')
('14', '\\pi_{\\theta}')
('14', '{\\rm T}_2')
('14', '\\widehat{P}')
('14', 'P')
('14', '\\begin{aligned}\nT_2& =\\quad \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P), s_{t+1} \\sim \\widehat{P}(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] - \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P), s_{t+1} \\sim P(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] \\nonumber \\\\\n    &= \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\mathbb{E}_{s_{t+1} \\sim \\widehat{P}(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] - \\mathbb{E}_{s_{t+1} \\sim P(\\cdot| s_t, a_t)} \\big[ V_{\\theta}(s_{t+1}) \\big] \\bigg]  \\nonumber \\\\\n    &= \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\sum_{s_{t+1} \\in \\mathcal{S}} V_{\\theta}(s_{t+1}) \\big( \\widehat{P}(s_{t+1}| s_t, a_t) - P(s_{t+1}| s_t, a_t) \\big) \\bigg]  \\nonumber\n\\end{aligned}')
('14', 'd^{\\rm E}(\\cdot, \\cdot)')
('14', 'd^{\\rm E}(s,a) := (1 - \\gamma) \\pi^{\\rm E}(a|s) \\sum_{t = 0}^{\\infty} \\gamma^t P^{\\pi^{\\rm E}}(s_t = s | s_0 \\sim \\eta)')
('14', '\\begin{aligned}\n    T_2 &= \\sum_{t = 0}^{\\infty} \\gamma^{t+1} \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ \\sum_{s_{t+1} \\in \\mathcal{S}} V_{\\theta}(s_{t+1}) \\big( \\widehat{P}(s_{t+1}| s_t, a_t) - P(s_{t+1}| s_t, a_t) \\big) \\bigg]  \\nonumber \\\\\n    &= \\gamma \\sum_{t = 0}^{\\infty} \\sum_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\gamma^t P(s_t =s | s_0 \\sim \\eta)  \\pi^E(a_t = a| s_t = s) \\bigg(  \\sum_{s_{t+1} \\in \\mathcal{S}} V_{\\theta}(s_{t+1}) \\big( \\widehat{P}(s_{t+1}| s_t = s, a_t = a) - P(s_{t+1}| s_t = s, a_t = a) \\big) \\bigg) \\nonumber \\\\\n    &= \\frac{\\gamma}{1 - \\gamma} \\cdot \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[   \\sum_{s^\\prime \\in \\mathcal{S}} V_{\\theta}(s^\\prime) \\Big( \\widehat{P}(s^\\prime| s, a) - P(s^\\prime| s, a) \\Big) \\Big] \\label{expression:transition_dynamics_mismatch_error}\n\\end{aligned}')
('14', '\\widehat{L}(\\cdot)')
('14', '\\begin{aligned}\n    \\widehat{L}(\\theta) := \\sum_{t = 0}^{\\infty} \\gamma^t \\mathbb{E}_{(s_t, a_t) \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[ r(s_t, a_t; \\theta) + U(s_t, a_t) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[ V_{\\theta}(s_0) \\bigg]. \\label{def:surrogate_objective_appendix}\n\\end{aligned}')
('14', 'L(\\theta)')
('14', '\\begin{aligned}\n        L(\\theta) &= \\widehat{L}(\\theta) + \\frac{\\gamma}{1 - \\gamma} \\cdot \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[   \\sum_{s^\\prime \\in \\mathcal{S}} V_{\\theta}(s^\\prime) \\Big( \\widehat{P}(s^\\prime| s, a) - P(s^\\prime| s, a) \\Big) \\Big]. \\label{decompostion_result:likelihood_objective}\n\\end{aligned}')
('15', '\\begin{aligned}\n    | L(\\theta) - \\widehat{L}(\\theta)| &= \\frac{\\gamma}{1 - \\gamma} \\cdot \\bigg| \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[   \\sum_{s^\\prime \\in \\mathcal{S}} V_{\\theta}(s^\\prime) \\Big( \\widehat{P}(s^\\prime| s, a) - P(s^\\prime| s, a) \\Big) \\Big] \\bigg| \\nonumber \\\\\n    &\\leq \\frac{\\gamma}{1 - \\gamma} \\cdot \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[   \\sum_{s^\\prime \\in \\mathcal{S}} \\big| V_{\\theta}(s^\\prime) \\big| \\cdot \\big| \\widehat{P}(s^\\prime| s, a) - P(s^\\prime| s, a) \\big| \\Big]  \\nonumber \\\\\n    &\\leq \\frac{\\gamma}{1 - \\gamma} \\cdot \\max_{\\tilde{s} \\in \\mathcal{S}} | V_{\\theta}(\\tilde{s}) | \\cdot \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[   \\sum_{s^\\prime \\in \\mathcal{S}} \\big| \\widehat{P}(s^\\prime| s, a) - P(s^\\prime| s, a) \\big| \\Big] \\nonumber \\\\\n    &= \\frac{\\gamma}{1 - \\gamma} \\cdot R(\\theta) \\cdot \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[  \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\Big] \\label{bound:objective_approximation_error}\n\\end{aligned}')
('15', 'R(\\theta) := \\max_{s \\in \\mathcal{S}} \\big| V_{\\theta}(s) \\big|')
('15', 'd^{\\rm E}(\\cdot, \\cdot)')
('15', 'V_{\\theta}(\\cdot)')
('15', '\\begin{aligned}\nR(\\theta) &= \\max_{s \\in \\mathcal{S}} ~ \\big| V_{\\theta}(s) \\big| \\nonumber \\\\\n    &\\overset{(i)}{=} \\max_{s \\in \\mathcal{S}} ~ \\bigg| \\mathbb{E}_{\\tau \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big( r(s_t, a_t;\\theta) + U(s_t,a_t)  + \\mathcal{H}(\\pi_{\\theta}(\\cdot | s_t)) \\big) \\Big | s_0 = s \\Big] \\bigg| \\nonumber \\\\\n    &\\leq \\max_{s \\in \\mathcal{S}} ~ \\mathbb{E}_{\\tau \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big( | r(s_t, a_t;\\theta) | + | U(s_t,a_t) |  + | \\mathcal{H}(\\pi_{\\theta}(\\cdot | s_t)) | \\big) \\Big | s_0 = s \\Big] \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\max_{s \\in \\mathcal{S}} ~ \\mathbb{E}_{\\tau \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big( C_{r} + C_{u}  + | \\mathcal{H}(\\pi_{\\theta}(\\cdot | s_t)) | \\big) \\Big | s_0 = s \\Big] \\nonumber \\\\\n    &\\overset{(iii)}{\\leq} \\max_{s \\in \\mathcal{S}} ~ \\mathbb{E}_{\\tau \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big( C_{r} + C_{u}  + \\log |\\mathcal{A}| \\big) \\Big | s_0 = s \\Big] \\nonumber \\\\\n    &= \\frac{C_r + C_u + \\log |\\mathcal{A}|}{1 - \\gamma}. \\nonumber\n\\end{aligned}')
('15', 'V_{\\theta}(\\cdot)')
('15', '| \\mathcal{H}(\\pi_{\\theta}(\\cdot | s)) | = \\mathcal{H}(\\pi_{\\theta}(\\cdot | s)) \\leq - \\sum_{a \\in \\mathcal{A}} \\frac{1}{|\\mathcal{A}|} \\log |\\frac{1}{|\\mathcal{A}|}| = \\log |\\mathcal{A}|')
('15', 'C_{v} := \\frac{C_r + C_u + \\log |\\mathcal{A}|}{1 - \\gamma}')
('15', 'R(\\theta) = \\max_{s \\in \\mathcal{S}} \\big| V_{\\theta}(s) \\big| \\leq C_{v}.')
('15', '\\begin{aligned}\n    |L(\\theta) - \\widehat{L}(\\theta)| \\leq \\frac{\\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s, a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\Big[  \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\Big]. \\nonumber\n\\end{aligned}')
('16', '\\widehat{L}(\\theta)')
('16', '\\theta')
('16', '\\begin{aligned}\n        \\nabla \\widehat{L}(\\theta) &\\overset{(i)}{=}  \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( \\nabla_{\\theta} r(s_t, a_t; \\theta) + \\nabla_{\\theta} U(s_t, a_t) \\Big) \\Big]  - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[ \\nabla_{\\theta} V_{\\theta}(s_0) \\bigg] \\nonumber \\\\\n        &\\overset{(ii)}{=} \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta) \\Big]  - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[ \\nabla_{\\theta} \\log \\big( \\sum_{a \\in \\mathcal{A}} \\exp Q_{\\theta}(s_0, a) \\big) \\bigg] \\nonumber \\\\\n        &= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[  \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta} r(s_t, a_t; \\theta)  \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[  \\sum_{a \\in \\mathcal{A}} \\bigg( \\frac{ \\exp Q_{\\theta}(s_0, a) }{\\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta}(s_0, \\tilde{a}) } \\nabla_\\theta Q_{\\theta}(s_0, a) \\bigg) \\bigg]  \\nonumber \\\\\n        &\\overset{(iii)}{=} \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[  \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta} r(s_t, a_t; \\theta) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot)} \\bigg[  \\sum_{a\\in\\mathcal{A}}  \\pi_{\\theta}(a | s_0) \\nabla_\\theta Q_{\\theta}(s_0, a) \\bigg] \\nonumber \\\\\n        &= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[  \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta} r(s_t, a_t; \\theta) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot), a_0 \\sim \\pi_{\\theta}(\\cdot | s_0)} \\bigg[ \\nabla_\\theta Q_{\\theta}(s_0, a_0) \\bigg] \\label{eq:surrogate_obj_grad_expression}\n    \n\\end{aligned}')
('16', '\\widehat{L}(\\theta)')
('16', 'V_{\\theta}')
('16', 'U(s,a)')
('16', '\\theta')
('16', '\\pi_{\\theta}')
('16', 'Q_{\\theta}')
('16', 'Q_{\\theta}')
('16', '\\pi_{\\theta}')
('16', 'U')
('16', '\\widehat{P}')
('16', '\\begin{aligned}\n        &\\nabla_\\theta Q_{\\theta}(s_0, a_0) \\nonumber \\\\\n     &\\overset{(i)}{=} \\nabla_{\\theta} \\bigg( r(s_0,a_0;\\theta) + U(s_0, a_0) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0)} \\big[ V_{\\theta}(s_1) \\big]  \\bigg) \\nonumber \\\\\n        &\\overset{(ii)}{=} \\nabla_{\\theta} r(s_0,a_0;\\theta) + \\nabla_{\\theta} U(s_0, a_0) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0)} \\bigg[ \\nabla_{\\theta} \\log\\bigg( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta}(s_0, \\tilde{a}) \\bigg) \\bigg] \\nonumber \\\\\n        &= \\nabla_{\\theta} r(s_0,a_0;\\theta) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0)} \\bigg[ \\sum_{a \\in \\mathcal{A}} \\frac{\\exp Q_{\\theta}(s_1, a) }{\\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta}(s_1, \\tilde{a})} \\nabla_{\\theta} Q_{\\theta}(s_1, a) \\bigg] \\nonumber \\\\\n        &\\overset{(iii)}{=} \\nabla_{\\theta} r(s_0,a_0;\\theta) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0)} \\bigg[ \\sum_{a \\in \\mathcal{A}} \\pi_{\\theta}(a|s_1) \\nabla_{\\theta} Q_{\\theta}(s_1, a) \\bigg] \\nonumber \\\\\n        &\\overset{(iv)}{=} \\nabla_{\\theta} r(s_0,a_0;\\theta) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0), a_1 \\sim \\pi_{\\theta}(\\cdot|s_1)} \\bigg[ \\nabla_{\\theta} \\bigg( r(s_1,a_1;\\theta) + U(s_1, a_1) + \\gamma \\mathbb{E}_{s_2 \\sim \\widehat{P}(\\cdot|s_1, a_1)} \\big[ V_{\\theta}(s_2) \\big]  \\bigg) \\bigg] \\nonumber \n    \n\\end{aligned}')
('16', 'V_{\\theta}')
('16', '\\begin{aligned}\n     &\\nabla_\\theta Q_{\\theta}(s_0, a_0) \\nonumber \\\\\n     &= \\nabla_{\\theta} \\bigg( r(s_0,a_0;\\theta) + U(s_0, a_0) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0)} \\big[ V_{\\theta}(s_1) \\big]  \\bigg) \\nonumber \\\\\n     &= \\nabla_{\\theta} r(s_0,a_0;\\theta) + \\gamma \\mathbb{E}_{s_1 \\sim \\widehat{P}(\\cdot|s_0, a_0), a_1 \\sim \\pi_{\\theta}(\\cdot|s_1)} \\bigg[ \\nabla_{\\theta} \\bigg( r(s_1,a_1;\\theta) + U(s_1, a_1) + \\gamma \\mathbb{E}_{s_2 \\sim \\widehat{P}(\\cdot|s_1, a_1)} \\big[ V_{\\theta}(s_2) \\big]  \\bigg) \\bigg] \\nonumber \\\\\n      &= \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\pi_{\\theta}, \\widehat{P})} \\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t;\\theta) \\mid s_0, a_0 \\bigg]. \\label{eq:optimal_soft_Q_grad}\n \n\\end{aligned}')
('16', '\\widehat{L}(\\theta)')
('16', '\\begin{aligned}\n        \\nabla \\widehat{L}(\\theta) &= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[  \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta} r(s_t, a_t; \\theta) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot), a_0 \\sim \\pi_{\\theta}(\\cdot | s_0)} \\bigg[ \\nabla_\\theta Q_{\\theta}(s_0, a_0) \\bigg] \\nonumber \\\\\n        &= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\bigg[  \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta} r(s_t, a_t; \\theta) \\bigg] - \\mathbb{E}_{s_0 \\sim \\eta(\\cdot), a_0 \\sim \\pi_{\\theta}(\\cdot | s_0)} \\bigg[  \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t;\\theta) \\mid s_0, a_0 \\Big] \\bigg] \\nonumber \\\\\n        &=\\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta) \\bigg]. \\label{eq:obj_grad_exact_form}\n    \n\\end{aligned}')
('17', 'Q_{\\theta}')
('17', '\\widehat{L}(\\theta)')
('17.0', 'Q_{\\theta}(s,a)')
('17.0', '\\theta')
('17.0', '(s,a)')
('17.0', 'Q_{\\theta}')
('17.0', '\\theta')
('17.0', 'Q_{\\theta}')
('17.0', '\\begin{aligned}\n    \\| \\nabla_\\theta Q_{\\theta}(s, a) \\| &= \\bigg\\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t;\\theta) \\mid s_0 = s, a_0 = a \\Big] \\bigg\\| \\nonumber \\\\\n    &\\overset{(i)}{\\leq} \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\| \\nabla_{\\theta} r(s_t, a_t;\\theta) \\| \\mid s_0 = s, a_0 = a \\Big] \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t L_r \\mid s_0 = s, a_0 = a \\Big] \\nonumber \\\\\n    &= \\frac{L_r}{1 - \\gamma} \\label{ineq:optimal_Q_grad_bound}\n\\end{aligned}')
('17.0', 'L_q := \\frac{L_r}{1 - \\gamma}')
('17.0', 'Q_{\\theta}')
('17.0', '\\begin{aligned}\n    |Q_{\\theta_1}(s,a) - Q_{\\theta_2}(s,a)| \\overset{(i)}{=} \\big| \\langle \\theta_1 - \\theta_2, \\nabla_{\\theta} Q_{\\tilde{\\theta}}(s,a) \\rangle \\big| \\leq \\| \\theta_1 - \\theta_2 \\| \\cdot \\| \\nabla_{\\theta} Q_{\\tilde{\\theta}}(s,a) \\| \\overset{(ii)}{\\leq} L_q \\| \\theta_1 - \\theta_2 \\| \\nonumber \n\\end{aligned}')
('17.0', '\\tilde{\\theta}')
('17.0', '\\theta_1')
('17.0', '\\theta_2')
('17.1', '\\widehat{L}(\\theta)')
('17.1', '\\theta_1')
('17.1', '\\theta_2')
('17.1', '\\begin{aligned}\n   &\\| \\nabla \\widehat{L}(\\theta_1) - \\nabla \\widehat{L}(\\theta_2) \\| \\nonumber \\\\\n   &\\overset{(i)}{:=} \\bigg \\| \\bigg( \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_1}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] \\bigg) \\nonumber \\\\\n   &\\quad \\quad - \\bigg( \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta_2) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\bigg] \\bigg) \\bigg \\| \\nonumber \\\\\n   &\\leq \\bigg\\| \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta_2) \\bigg]  \\bigg \\|  \\nonumber \\\\\n   &\\quad \\quad + \\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_1}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\bigg] \\bigg \\| \\label{decomposition:obj_grad_difference}\n\\end{aligned}')
('17.1', '\\begin{aligned}\n    &\\bigg\\| \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\nabla_{\\theta}r(s_t, a_t; \\theta_2) \\bigg]  \\bigg \\| \\nonumber \\\\\n    &= \\bigg\\| \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\big( \\nabla_{\\theta}r(s_t, a_t; \\theta_1) - \\nabla_{\\theta}r(s_t, a_t; \\theta_2) \\big) \\bigg]  \\bigg \\| \\nonumber \\\\\n    &\\overset{(i)}{\\leq} \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t  \\Big\\| \\nabla_{\\theta}r(s_t, a_t; \\theta_1) - \\nabla_{\\theta}r(s_t, a_t; \\theta_2) \\Big \\| \\bigg] \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t L_g \\Big\\| \\theta_1 - \\theta_2 \\Big \\| \\bigg] \\nonumber \\\\\n    &= \\frac{L_g}{1 - \\gamma} \\big\\| \\theta_1 - \\theta_2 \\big \\| \\label{ineq:expert_traj_grad_bound}\n\\end{aligned}')
('17.1', '\\begin{aligned}\n    &\\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_1}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\bigg] \\bigg \\| \\nonumber \\\\\n    &\\leq \\underbrace{\\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_1}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg]   \\bigg \\| }_{\\rm T1: ~\\text{\\footnotesize error term due to policy mismatch}} \\nonumber \\\\\n    &\\quad + \\underbrace{ \\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\bigg]  \\bigg \\|. }_{\\rm T2: ~\\text{\\footnotesize error term due to reward parameter mismatch}} \\label{def:reward_grad_traj_difference}\n\\end{aligned}')
('17.1', '\\pi_{\\theta_1}')
('17.1', '\\pi_{\\theta_2}')
('17.1', '\\theta_1')
('17.1', '\\theta_2')
('17.1', '\\begin{aligned}\n    &\\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_1}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg]   \\bigg \\| \\nonumber \\\\\n    &\\overset{(i)}{=} \\bigg\\| \\frac{1}{1 - \\gamma} \\mathbb{E}_{(s,a) \\sim d^{\\pi_{\\theta_1}}_{\\widehat{P}}(\\cdot, \\cdot) } \\big[ \\nabla_{\\theta} r(s, a; \\theta_1) \\big] -  \\frac{1}{1 - \\gamma} \\mathbb{E}_{(s,a) \\sim d^{\\pi_{\\theta_2}}_{\\widehat{P}}(\\cdot, \\cdot) } \\big[ \\nabla_{\\theta} r(s, a; \\theta_1) \\big] \\bigg \\| \\nonumber \\\\\n    &= \\frac{1}{1-\\gamma} \\bigg \\| \\sum_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\nabla_{\\theta} r(s, a; \\theta_1) \\cdot \\big( d^{\\pi_{\\theta_1}}_{\\widehat{P}}(s, a) - d^{\\pi_{\\theta_2}}_{\\widehat{P}}(s, a)  \\big)    \\bigg \\| \\nonumber \\\\\n    &\\leq \\frac{1}{1-\\gamma} \\sum_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\big \\| \\nabla_{\\theta} r(s, a; \\theta_1) \\big \\| \\cdot \\big | d^{\\pi_{\\theta_1}}_{\\widehat{P}}(s, a) - d^{\\pi_{\\theta_2}}_{\\widehat{P}}(s, a)  \\big| \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\frac{2 L_r}{1 - \\gamma} \\|  d^{\\pi_{\\theta_1}}_{\\widehat{P}}(\\cdot, \\cdot) - d^{\\pi_{\\theta_2}}_{\\widehat{P}}(\\cdot, \\cdot)  \\|_{\\rm TV} \\nonumber \\\\\n    &\\overset{(iii)}{\\leq} \\frac{2L_r C_d}{1 - \\gamma} \\| Q_{\\theta_1} - Q_{\\theta_2} \\| \\nonumber \\\\\n    &\\overset{(iv)}{\\leq} \\frac{2L_r C_d \\sqrt{|\\mathcal{S}| \\cdot |\\mathcal{A}|}}{1 - \\gamma} \\| Q_{\\theta_1} - Q_{\\theta_2} \\|_{\\infty} \\nonumber \\\\\n    &\\overset{(v)}{\\leq} \\frac{2 L_q L_r C_d \\sqrt{|\\mathcal{S}| \\cdot |\\mathcal{A}|}}{1 - \\gamma} \\| \\theta_1 - \\theta_2 \\| \\label{bound:traj_policy_mismatch_error}\n\\end{aligned}')
('17.1', '| Q_{\\theta_1}(s,a) - Q_{\\theta_2}(s,a) | \\leq \\| Q_{\\theta_1} - Q_{\\theta_2} \\|_{\\infty}')
('17.1', '(s,a)')
('17.1', '\\| Q_{\\theta_1} - Q_{\\theta_2} \\| \\leq \\sqrt{|\\mathcal{S}| \\cdot |\\mathcal{A}|} ~ \\| Q_{\\theta_1} - Q_{\\theta_2} \\|_{\\infty}')
('17.1', '\\begin{aligned}\n    &\\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\bigg]  \\bigg \\| \\nonumber \\\\\n    &= \\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big( \\nabla_{\\theta} r(s_t, a_t; \\theta_1) - \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\big) \\Big] \\bigg \\| \\nonumber \\\\\n    &\\overset{(i)}{\\leq} \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\big \\| \\nabla_{\\theta} r(s_t, a_t; \\theta_1) - \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\big \\| \\Big] \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t L_g \\| \\theta_1 - \\theta_2 \\| \\Big] \\nonumber \\\\\n    &= \\frac{L_g}{1 - \\gamma} \\| \\theta_1 - \\theta_2 \\| \\label{bound:traj_reward_mismatch_error}\n\\end{aligned}')
('17.1', '\\begin{aligned}\n    \\bigg \\| \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_1}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_1) \\bigg] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta_2}, \\widehat{P})}\\bigg[ \\sum_{t = 0}^{\\infty} \\gamma^t \\nabla_{\\theta} r(s_t, a_t; \\theta_2) \\bigg] \\bigg \\| \\leq \\frac{2 L_q L_r C_d \\sqrt{|\\mathcal{S}| \\cdot |\\mathcal{A}|} + L_g}{1 - \\gamma} \\cdot \\| \\theta_1 - \\theta_2 \\|. \\label{ineq:traj_difference_joint_bound}\n\\end{aligned}')
('17.1', 'L_c = \\frac{2 L_q L_r C_d \\sqrt{|\\mathcal{S}| \\cdot |\\mathcal{A}|} + 2L_g}{1 - \\gamma}')
('17.1', '\\widehat{L}(\\theta)')
('17.1', '\\begin{aligned}\n    \\| \\nabla \\widehat{L}(\\theta_1) - \\nabla \\widehat{L}(\\theta_2) \\| \\leq L_c \\| \\theta_1 - \\theta_2 \\|. \\nonumber\n\\end{aligned}')
('18', '\\Omega := \\{ (s,a) \\mid  d^{\\rm E}(s,a) > 0 \\}')
('18', '\\mathcal{S}^{\\rm E} := \\{s \\mid  \\sum_{a \\in \\mathcal{A}} d^{\\rm E}(s,a) > 0 \\}')
('18', '(s, a) \\in \\Omega')
('18', '| \\mathcal{S}^{\\rm E} |')
('18', 'P(\\cdot | s,a)')
('18', 'P(s^{\\prime} | s,a) > 0')
('18', 's^{\\prime}')
('18', '(s,a)')
('18', '\\mathcal{S}^{\\rm E}')
('18', 'N')
('18', '(s,a) \\in \\Omega')
('18', '\\widehat{P}( s^{\\prime} | s,a) = \\frac{N(s,a,s^\\prime)}{N}')
('18', 's^{\\prime} \\in \\mathcal{S}^{\\rm E}')
('18', 'N(s,a,s^\\prime)')
('18', '(s,a,s^\\prime)')
('18', '(s,a) \\in \\Omega')
('18', 's^\\prime \\notin \\mathcal{S}^{\\rm E}')
('18', '\\widehat{P}( s^{\\prime} | s,a) = \\frac{N(s,a,s^\\prime)}{N} = 0')
('18', '\\mathcal{S}^{\\rm E}')
('18', '(s, a) \\in \\Omega')
('18', '1 - e^{-N\\epsilon^2}')
('18', '\\| P(\\cdot | s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\leq \\sqrt{|\\mathcal{S}^{\\rm E}|} \\cdot \\bigg( \\frac{1}{\\sqrt{N}} + \\epsilon \\bigg). \\label{concentration:empirical_distribution_approx}')
('18', '\\tilde{\\delta} := e^{-N\\epsilon^2}')
('18', '\\epsilon = \\sqrt{\\frac{1}{N} \\ln \\frac{1}{\\tilde{\\delta}} }')
('18', '\\epsilon')
('18', '1 - \\tilde{\\delta}')
('18', '\\| P(\\cdot | s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\leq \\sqrt{|\\mathcal{S}^{\\rm E}|} \\cdot \\bigg( \\frac{1}{\\sqrt{N}} + \\sqrt{\\frac{1}{N} \\ln \\frac{1}{\\tilde{\\delta}} } \\bigg) = c \\sqrt{\\frac{| \\mathcal{S}^{\\rm E} |}{N} \\ln \\frac{1}{\\tilde{\\delta}} }. \\label{complexity:L1_norm}')
('18', 'c := 1 + \\frac{1}{ \\sqrt{ \\ln \\frac{1}{\\tilde{\\delta}} } }')
('18', '\\tilde{\\delta}')
('18', '\\begin{aligned}\n    &P\\bigg( \\max_{(s,a) \\in \\Omega} \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\geq c \\sqrt{\\frac{| \\mathcal{S}^{\\rm E} |}{N} \\ln \\frac{1}{\\tilde{\\delta}} } \\bigg) \\nonumber \\\\\n    &\\overset{(i)}{\\leq} \\sum_{(s,a) \\in \\Omega} P\\bigg( \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\geq c \\sqrt{\\frac{| \\mathcal{S}^{\\rm E} |}{N} \\ln \\frac{1}{\\tilde{\\delta}} } \\bigg) \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} |\\Omega| \\cdot \\tilde{\\delta} \\nonumber\n\\end{aligned}')
('18', '1 - |\\Omega| \\cdot \\tilde{\\delta}')
('18', '\\begin{aligned}\n    \\max_{(s,a) \\in \\Omega} \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\leq c \\sqrt{\\frac{| \\mathcal{S}^{\\rm E} |}{N} \\ln \\frac{1}{\\tilde{\\delta}} }. \\label{concentration:maximum_L1_norm}\n\\end{aligned}')
('18', '\\delta := |\\Omega| \\cdot \\tilde{\\delta}')
('18', '\\tilde{\\delta} = \\frac{\\delta}{|\\Omega|}')
('18', '1 - \\delta')
('18', '\\begin{aligned}\n    \\max_{(s,a) \\in \\Omega} \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\leq c \\sqrt{\\frac{| \\mathcal{S}^{\\rm E} |}{N} \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) }. \\label{standard_concentration:maximum_L1_norm}\n\\end{aligned}')
('18', '\\max_{(s,a) \\in \\Omega} \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\leq \\varepsilon')
('18', 'N')
('18', '(s,a) \\in \\Omega')
('18', '\\begin{aligned}\n    c \\sqrt{\\frac{| \\mathcal{S}^{\\rm E} |}{N} \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) } \\leq \\varepsilon \\implies N \\geq \\frac{c^2 \\cdot |\\mathcal{S}^{\\rm E}|}{\\varepsilon^2} \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big). \\nonumber\n\\end{aligned}')
('18', '(s,a) \\in \\Omega')
('18', '\\mathcal{D} = \\{ (s,a,s^\\prime) \\}')
('18', '\\begin{aligned}\n    \\#\\text{transition samples} \\geq |\\Omega| \\cdot N \\geq \\frac{c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{\\varepsilon^2} \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big). \\label{complexity:transition_samples}\n\\end{aligned}')
('18', '1 - \\delta')
('18', 'P')
('18', '\\widehat{P}')
('18', '\\begin{aligned}\n    \\mathbb{E}_{(s,a) \\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\big] \\leq \\max_{(s,a) \\in \\Omega} \\| P(\\cdot| s,a) - \\widehat{P}(\\cdot | s,a) \\|_1 \\leq \\varepsilon. \\label{ineq:generalization_error_bound}\n\\end{aligned}')
('19', '\\theta^*')
('19', '\\hat{\\theta}')
('19', '\\begin{aligned}\n    &L(\\theta^*) - L(\\hat{\\theta}) \\nonumber \\\\\n    &= \\big( L(\\theta^*) - \\widehat{L}(\\theta^*) \\big) + \\big( \\widehat{L}(\\theta^*) - \\widehat{L}(\\hat{\\theta}) \\big) + \\big( \\widehat{L}(\\hat{\\theta}) - L(\\hat{\\theta}) \\big) \\nonumber \\\\\n    &\\overset{(i)}{\\leq} \\frac{\\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big]  + \\big( \\widehat{L}(\\theta^*) - \\widehat{L}(\\hat{\\theta}) \\big) + \\frac{\\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big]     \\nonumber \\\\\n    &= \\frac{2 \\gamma C_{v} }{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big] + \\big( \\widehat{L}(\\theta^*) - \\widehat{L}(\\hat{\\theta}) \\big) \\label{ineq:likelihood_difference_decomposition}\n\\end{aligned}')
('19', '\\hat{\\theta}')
('19', '\\widehat{L}(\\cdot)')
('19', '\\widehat{L}(\\theta) - \\widehat{L}(\\hat{\\theta}) \\leq 0')
('19', '\\theta')
('19', '\\begin{aligned}\n    L(\\theta^*) - L(\\hat{\\theta}) &\\leq \\frac{2 \\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big] + \\big( \\widehat{L}(\\theta^*) - \\widehat{L}(\\hat{\\theta}) \\big) \\nonumber \\\\\n    &\\leq \\frac{2 \\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big]. \\nonumber\n\\end{aligned}')
('19', '\\begin{aligned}\n    \\#\\text{transition samples} \\geq \\frac{c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{ \\big(\\frac{(1-\\gamma)\\varepsilon}{2\\gamma C_v} \\big)^2 } \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) = \\frac{4\\gamma^2 \\cdot C_v^2 \\cdot c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{ (1-\\gamma)^2 \\varepsilon^2  } \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big). \\nonumber\n\\end{aligned}')
('19', '1 - \\delta')
('19', '\\begin{aligned}\n    &\\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big] \\leq \\frac{(1-\\gamma)\\varepsilon}{2\\gamma C_v}, \\nonumber \\\\\n    &L(\\theta^*) - L(\\hat{\\theta}) \\leq \\frac{2 \\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a)\\sim d^{\\rm E}(\\cdot, \\cdot)} \\big[ \\big\\| \\widehat{P}(\\cdot| s, a) - P(\\cdot| s, a) \\big\\|_{1} \\big] \\leq \\varepsilon. \\nonumber\n\\end{aligned}')
('20.0', '\\{ \\pi_{k+1} \\}_{k\\geq 0}')
('20.0', '\\{ \\pi_{\\theta_k} \\}_{k \\geq 0}')
('20.0', '\\pi_{k+1}')
('20.0', '\\pi_{k+1}')
('20.0', '\\pi_{\\theta_k}')
('20.0', '\\begin{aligned}\n    &\\Big| \\log \\pi_{k+1}(a|s) - \\log \\pi_{\\theta_k}(a|s) \\Big| \\nonumber \\\\\n    &\\overset{(i)}{=} \\Big| \\log \\Big( \\frac{\\exp \\widehat{Q}_{k}(s,a)}{ \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp \\widehat{Q}_{k}(s, \\tilde{a}) } \\Big) - \\log \\Big( \\frac{\\exp Q_{\\theta_k}(s,a)}{ \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta_k}(s, \\tilde{a}) } \\Big) \\Big| \\nonumber \\\\\n    &= \\Big|  \\Big( \\widehat{Q}_{k}(s,a) - \\log \\big( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp \\widehat{Q}_{k}(s, \\tilde{a}) \\big) \\Big) - \\Big( Q_{\\theta_k}(s,a) - \\log \\big( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta_k}(s, \\tilde{a}) \\big) \\Big) \\Big| \\nonumber \\\\\n    &\\leq \\Big| \\widehat{Q}_{k}(s,a) - Q_{\\theta_k}(s,a) \\Big| + \\Big| \\log \\big( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp \\widehat{Q}_{k}(s, \\tilde{a}) \\big) - \\log \\big( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta_k}(s, \\tilde{a}) \\big) \\Big|  \\label{decomposition:log_policy_difference}\n\\end{aligned}')
('20.0', '|\\mathcal{A}|')
('20.0', '\\overrightarrow{a} := [a_1, a_2, \\cdots, a_{|\\mathcal{A}|}]')
('20.0', '\\overrightarrow{b} := [b_1, b_2, \\cdots, b_{|\\mathcal{A}|}]')
('20.0', '\\begin{aligned}\n    \\Big| \\log \\big( \\| \\exp (\\overrightarrow{a}) \\|_{1} \\big) - \\log \\big( \\| \\exp (\\overrightarrow{b}) \\|_{1} \\big) \\Big| &\\overset{(i)}{=} \\Big| \\langle \\overrightarrow{a} - \\overrightarrow{b}, \\nabla_{\\overrightarrow{v}} \\log \\big( \\| \\exp (\\overrightarrow{v}) \\|_{1} \\big) \\rangle \\Big| \\nonumber \\\\\n    &\\leq \\|  \\overrightarrow{a} - \\overrightarrow{b}  \\|_{\\infty} \\cdot \\| \\nabla_{\\overrightarrow{v}} \\log \\big( \\| \\exp (\\overrightarrow{v}) \\|_{1} \\big) \\|_{1} \\nonumber \\\\\n    &\\overset{(ii)}{=} \\|  \\overrightarrow{a} - \\overrightarrow{b}  \\|_{\\infty} \\label{ineq:norm_conversion}\n\\end{aligned}')
('20.0', '\\overrightarrow{v}')
('20.0', '\\overrightarrow{a}')
('20.0', '\\overrightarrow{b}')
('20.0', '\\begin{aligned}\n_{i} = \\frac{\\exp(v_i)}{\\| \\exp (\\overrightarrow{v}) \\|_{1}}, \\quad \\| \\nabla_{\\overrightarrow{v}} \\log \\big( \\| \\exp (\\overrightarrow{v}) \\|_{1} \\big) \\|_{1} = 1, \\quad \\forall \\overrightarrow{v} \\in \\mathbb{R}^{|\\mathcal{A}|}. \\nonumber\n\\end{aligned}')
('20.0', '\\begin{aligned}\n    \\Big| \\log \\pi_{k+1}(a|s) - \\log \\pi_{\\theta_k}(a|s) \\Big| &\\leq \\Big| \\widehat{Q}_{k}(s,a) - Q_{\\theta_k}(s,a) \\Big| + \\Big| \\log \\big( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp \\widehat{Q}_{k}(s, \\tilde{a}) \\big) - \\log \\big( \\sum_{\\tilde{a} \\in \\mathcal{A}} \\exp Q_{\\theta_k}(s, \\tilde{a}) \\big) \\Big|  \\nonumber \\\\\n    &\\leq \\Big| \\widehat{Q}_{k}(s,a) - Q_{\\theta_k}(s,a) \\Big| + \\max_{\\tilde{a} \\in \\mathcal{A}} \\Big| \\widehat{Q}_{k}(s, \\tilde{a}) - Q_{\\theta_k}(s,\\tilde{a}) \\Big|. \\label{bound:log_policy_difference}\n\\end{aligned}')
('20.0', '\\| \\log \\pi \\|_{\\infty} := \\max_{s \\in \\mathcal{S}, a \\in \\mathcal{A}}| \\log \\pi(a|s) |')
('20.0', '\\begin{aligned}\n    \\big \\| \\log \\pi_{k+1} - \\log \\pi_{\\theta_k} \\big \\|_{\\infty} \\leq 2 \\big \\| \\widehat{Q}_{k} - Q_{\\theta_k} \\big \\|_{\\infty}. \\label{bound:infinity_norm_conversion}\n\\end{aligned}')
('20.0', '\\widehat{Q}_k')
('20.0', 'Q_k')
('20.0', '\\epsilon_{\\rm app}')
('20.0', '\\begin{aligned}\n    \\big \\| \\log \\pi_{k+1} - \\log \\pi_{\\theta_k} \\big \\|_{\\infty} \\leq 2 \\big \\| \\widehat{Q}_{k} - Q_{\\theta_k} \\big \\|_{\\infty} = 2 \\big \\| \\widehat{Q}_{k} - Q_k + Q_k - Q_{\\theta_k} \\big \\|_{\\infty} \\leq 2 \\epsilon_{\\rm app} + 2 \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty}. \\label{bound:policy_to_Q_conversion}\n\\end{aligned}')
('20.0', '\\| \\log \\pi_{k+1} - \\log \\pi_{\\theta_k} \\|_{\\infty}')
('20.0', 'Q_k')
('20.0', 'Q_{\\theta_k}')
('20.0', '\\{ Q_{k + \\frac{1}{2}} \\}_{k\\geq 0}')
('20.0', 'Q_{k + \\frac{1}{2}}')
('20.0', '\\theta_k')
('20.0', '\\pi_{k+1}')
('20.0', '\\begin{aligned}\n    \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} &= \\big \\| Q_k - Q_{\\theta_k} + Q_{\\theta_{k-1}} - Q_{\\theta_{k-1}} + Q_{k - \\frac{1}{2}} - Q_{k - \\frac{1}{2}} \\big \\|_{\\infty} \\nonumber \\\\\n    &\\leq \\big \\| Q_{\\theta_k} - Q_{\\theta_{k-1}} \\big \\|_{\\infty} + \\big \\| Q_{\\theta_{k-1}} - Q_{k - \\frac{1}{2}} \\big \\|_{\\infty} + \\big \\| Q_k - Q_{k - \\frac{1}{2}} \\big \\|_{\\infty} \\nonumber \\\\\n    &\\overset{(i)}{\\leq} \\big \\| Q_{\\theta_{k-1}} - Q_{k - \\frac{1}{2}} \\big \\|_{\\infty} + 2L_q \\| \\theta_k - \\theta_{k-1} \\| \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\gamma \\big \\| Q_{\\theta_{k-1}} - Q_{k - 1} \\big \\|_{\\infty} + 2L_q \\| \\theta_k - \\theta_{k-1} \\| + \\frac{2 \\gamma \\epsilon_{\\rm app}}{1 - \\gamma}\n    \\label{decomposition:soft_Q_convergence}\n\\end{aligned}')
('20.0', '\\theta')
('20.0', '\\begin{aligned}\n    \\| \\theta_k - \\theta_{k-1} \\| = \\alpha \\| g_{k-1} \\| \\overset{(i)}{=} \\alpha \\| h(\\theta_{k-1}; \\tau_{k-1}^{\\rm E}) - h(\\theta_{k-1}; \\tau_{k-1}^{\\rm A}) \\| \\leq \\alpha \\| h(\\theta_{k-1}; \\tau_{k-1}^{\\rm E}) \\| + \\alpha \\| h(\\theta_{k-1}; \\tau_{k-1}^{\\rm A}) \\| \\overset{(ii)}{\\leq} \\frac{2\\alpha L_r}{1 - \\gamma} \\nonumber\n\\end{aligned}')
('20.0', 'h(\\theta; \\tau)')
('20.0', '\\| \\nabla_{\\theta} r(s,a;\\theta) \\| \\leq L_r')
('20.0', 'L_q := \\frac{L_r}{1 - \\gamma}')
('20.0', '\\begin{aligned}\n    \\| \\theta_k - \\theta_{k-1} \\| \\leq 2 \\alpha L_q. \\label{bound:reward_parameter_difference}\n\\end{aligned}')
('20.0', '\\begin{aligned}\n    \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} \\leq \\gamma \\big \\| Q_{k - 1} - Q_{\\theta_{k-1}} \\big \\|_{\\infty} + 4\\alpha L_q^2 + \\frac{2 \\gamma \\epsilon_{\\rm app}}{1 - \\gamma}. \\label{contraction:soft_Q_difference}\n\\end{aligned}')
('20.0', 'k = 1')
('20.0', 'k = K')
('20.0', 'K')
('20.0', '\\begin{aligned}\n  \\frac{1}{K} \\sum_{k=1}^{K}  \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} \\leq \\frac{\\gamma}{K} \\sum_{k=0}^{K-1} \\big \\| Q_{k} - Q_{\\theta_{k}} \\big \\|_{\\infty} + 4\\alpha L_q^2 + \\frac{2 \\gamma \\epsilon_{\\rm app}}{1 - \\gamma} . \\label{ineq:summation_contractions}\n\\end{aligned}')
('20.0', '\\begin{aligned}\n  \\frac{1 - \\gamma}{K} \\sum_{k=1}^{K}  \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} \\leq \\frac{\\gamma}{K} \\big( \\big \\| Q_{0} - Q_{\\theta_{0}} \\big \\|_{\\infty} - \\big \\| Q_{K} - Q_{\\theta_{K}} \\big \\|_{\\infty} \\big ) + 4\\alpha L_q^2 + \\frac{2 \\gamma \\epsilon_{\\rm app}}{1 - \\gamma}. \\label{ineq:convergence_error}\n\\end{aligned}')
('20.0', '\\| Q_{0} - Q_{\\theta_{0}} \\|_{\\infty}')
('20.0', '\\Delta_0')
('20.0', '\\| Q_{0} - Q_{\\theta_{0}} \\|_{\\infty} \\leq \\Delta_0')
('20.0', '1 - \\gamma')
('20.0', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k=1}^{K}  \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} \\leq \\frac{\\gamma}{K (1 - \\gamma)} \\Delta_0 + \\frac{4\\alpha L_q^2}{1 - \\gamma} + \\frac{2 \\gamma \\epsilon_{\\rm app}}{(1 - \\gamma)^2}. \\label{ineq:convergence_result}\n\\end{aligned}')
('20.0', '\\frac{1}{K}\\big \\| Q_K - Q_{\\theta_K} \\big \\|_{\\infty}')
('20.0', '\\frac{1}{K}\\big \\| Q_0 - Q_{\\theta_0} \\big \\|_{\\infty}')
('20.0', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k=0}^{K-1}  \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} &\\leq \\frac{\\gamma}{K (1 - \\gamma)} \\Delta_0 + \\frac{1}{K}\\Delta_0 - \\frac{1}{K}\\big \\| Q_K - Q_{\\theta_K} \\big \\|_{\\infty} + \\frac{4\\alpha L_q^2}{1 - \\gamma} + \\frac{2 \\gamma \\epsilon_{\\rm app}}{(1 - \\gamma)^2} \\nonumber \\\\\n    &\\leq \\frac{1}{K(1 - \\gamma)} \\Delta_0 + \\frac{4\\alpha L_q^2}{1 - \\gamma} + \\frac{2 \\gamma \\epsilon_{\\rm app}}{(1 - \\gamma)^2}.      \\label{ineq:Q_convergence_error}\n\\end{aligned}')
('20.0', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k = 0}^{K-1} \\big \\| \\log \\pi_{k+1} - \\log \\pi_{\\theta_k} \\big \\|_{\\infty} &\\overset{(i)}{\\leq} 2 \\epsilon_{\\rm app} + \\frac{2}{K} \\sum_{k=0}^{K-1} \\big \\| Q_k - Q_{\\theta_k} \\big \\|_{\\infty} \\nonumber \\\\\n    &\\overset{(ii)}{\\leq} \\Big( 2 + \\frac{4 \\gamma}{(1 - \\gamma)^2} \\Big) \\epsilon_{\\rm app} + \\frac{2\\Delta_0}{K(1 - \\gamma)} + \\frac{8\\alpha L_q^2}{1 - \\gamma}\n\\end{aligned}')
('20.0', '\\alpha')
('20.0', '\\alpha = \\alpha_0 \\times K^{-\\frac{1}{2}}')
('20.0', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k = 0}^{K-1} \\big \\| \\log \\pi_{k+1} - \\log \\pi_{\\theta_k} \\big \\|_{\\infty} = \\mathcal{O}(\\epsilon_{\\rm app}) + \\mathcal{O}(K^{-\\frac{1}{2}}). \\label{rate:policy_convergence_error}\n\\end{aligned}')
('20.1', '\\{ \\theta_k \\}_{k \\geq 0}')
('20.1', '\\widehat{L}(\\theta)')
('20.1', '\\begin{aligned}\n    \\widehat{L}(\\theta_{k+1}) &\\overset{(i)}{\\geq} \\widehat{L}(\\theta_k) + \\big \\langle \\nabla \\widehat{L}(\\theta_k), \\theta_{k+1} - \\theta_k \\big \\rangle - \\frac{L_c}{2} \\| \\theta_{k+1} - \\theta_k \\|^2 \\nonumber \\\\\n    &\\overset{(ii)}{=} \\widehat{L}(\\theta_k) + \\alpha \\big \\langle \\nabla \\widehat{L}(\\theta_k), g_k \\big \\rangle - \\frac{L_c \\alpha^2}{2} \\| g_k \\|^2 \\nonumber \\\\\n    &= \\widehat{L}(\\theta_k) + \\alpha \\big \\langle \\nabla \\widehat{L}(\\theta_k), g_k - \\nabla \\widehat{L}(\\theta_k) \\big \\rangle + \\alpha \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 - \\frac{L_c \\alpha^2}{2} \\| g_k \\|^2 \\label{ineq:surrogate_obj_analysis}\n\\end{aligned}')
('20.1', 'g_k')
('20.1', '\\begin{aligned}\n    \\| g_k \\| \\overset{(i)}{=} \\| h(\\theta_k; \\tau_k^{\\rm E}) - h(\\theta_k; \\tau_k^{\\rm A}) \\|  \\leq \\| h(\\theta_k; \\tau_k^{\\rm E}) \\| + \\| h(\\theta_k; \\tau_k^{\\rm A}) \\| \\overset{(ii)}{\\leq} \\frac{2L_r}{1 - \\gamma} \\label{bound:surrogate_obj_gradient}\n\\end{aligned}')
('20.1', 'L_q := \\frac{L_r}{1 - \\gamma}')
('20.1', '\\begin{aligned}\n    \\widehat{L}(\\theta_{k+1}) \\geq \\widehat{L}(\\theta_k) + \\alpha \\big \\langle \\nabla \\widehat{L}(\\theta_k), g_k - \\nabla \\widehat{L}(\\theta_k) \\big \\rangle + \\alpha \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 - 2L_c L_q^2 \\alpha^2. \\label{ineq:surrogate_obj_improvement}\n\\end{aligned}')
('20.1', '\\begin{aligned}\n    &\\mathbb{E} \\big[ \\widehat{L}(\\theta_{k+1}) \\big] \\nonumber \\\\\n    &\\geq \\mathbb{E} \\big[ \\widehat{L}(\\theta_k) \\big] + \\alpha \\mathbb{E} \\big[ \\big \\langle \\nabla \\widehat{L}(\\theta_k), g_k - \\nabla \\widehat{L}(\\theta_k) \\big \\rangle \\big] + \\alpha \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] - 2L_c L_q^2 \\alpha^2   \\nonumber \\\\\n    &= \\mathbb{E} \\big[ \\widehat{L}(\\theta_k) \\big] + \\alpha \\mathbb{E} \\big[ \\big \\langle \\nabla \\widehat{L}(\\theta_k), \\mathbb{E} [ g_k - \\nabla \\widehat{L}(\\theta_k) | \\theta_k] \\big \\rangle \\big] + \\alpha \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] - 2L_c L_q^2 \\alpha^2 \\nonumber \\\\\n    &\\overset{(i)}{=} \\mathbb{E} \\big[ \\widehat{L}(\\theta_k) \\big]  + \\alpha \\mathbb{E} \\Big[ \\Big \\langle \\nabla \\widehat{L}(\\theta_k), \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\theta_k},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big]  -   \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{k+1},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big]   \\Big \\rangle \\Big] \\nonumber \\\\\n  &\\quad + \\alpha \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] - 2L_c L_q^2 \\alpha^2 \\nonumber \\\\\n  &\\overset{(ii)}{\\geq} \\mathbb{E} \\big[ \\widehat{L}(\\theta_k) \\big] - \\underbrace{ 2\\alpha L_q \\mathbb{E} \\Big[ \\Big \\|  \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\theta_k},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big]  -   \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{k+1},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big] \\Big \\| \\Big] }_{\\rm T1: ~\\text{\\footnotesize error term due to policy mismatch}} \\nonumber \\\\\n  &\\quad + \\alpha \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] - 2L_c L_q^2 \\alpha^2 \\label{ineq:surrogate_improvement_bound}\n\\end{aligned}')
('20.1', '\\| \\nabla \\widehat{L}(\\theta_k) \\| \\leq 2L_q')
('20.1', '\\begin{aligned}\n    &\\mathbb{E} \\Big[ \\Big \\|  \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\theta_k},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big]  -   \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{k+1},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big] \\Big \\| \\Big]  \\nonumber \\\\\n  &\\overset{(i)}{=} \\mathbb{E} \\Big[ \\Big \\|  \\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a) \\sim d^{\\pi_{\\theta_k}}_{\\widehat{P}}(\\cdot, \\cdot)}\\big[ \\nabla_{\\theta} r(s,a;\\theta_k) \\big]  -   \\frac{1}{1-\\gamma} \\mathbb{E}_{(s,a) \\sim d^{\\pi_{k+1}}_{\\widehat{P}}(\\cdot, \\cdot)}\\big[ \\nabla_{\\theta} r(s,a;\\theta_k) \\big] \\Big \\| \\Big]  \\nonumber \\\\\n  &= \\frac{1}{1 - \\gamma} \\mathbb{E} \\Big[  \\Big \\|  \\sum_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\nabla_{\\theta} r(s,a;\\theta_k) \\cdot \\big( d^{\\pi_{\\theta_k}}_{\\widehat{P}}(s, a) - d^{\\pi_{k+1}}_{\\widehat{P}}(s, a) \\big) \\Big \\| \\Big] \\nonumber \\\\\n  &\\leq \\frac{1}{1 - \\gamma} \\mathbb{E} \\Big[  \\sum_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\big \\| \\nabla_{\\theta} r(s,a;\\theta_k) \\big \\| \\cdot \\big| d^{\\pi_{\\theta_k}}_{\\widehat{P}}(s, a) - d^{\\pi_{k+1}}_{\\widehat{P}}(s, a) \\big| \\Big] \\nonumber \\\\\n  &\\overset{(ii)}{\\leq} \\frac{L_r}{1 - \\gamma} \\mathbb{E} \\Big[  \\sum_{s \\in \\mathcal{S}, a \\in \\mathcal{A}} \\big| d^{\\pi_{\\theta_k}}_{\\widehat{P}}(s, a) - d^{\\pi_{k+1}}_{\\widehat{P}}(s, a) \\big| \\Big] \\nonumber \\\\\n  &\\overset{(iii)}{=} \\frac{2L_r}{1 - \\gamma} \\mathbb{E} \\Big[  \\big \\| d^{\\pi_{\\theta_k}}_{\\widehat{P}}(\\cdot, \\cdot) - d^{\\pi_{k+1}}_{\\widehat{P}}(\\cdot, \\cdot) \\big \\|_{\\rm TV} \\Big] \\label{ineq:reward_trajectory_mismatch_bound}\n\\end{aligned}')
('20.1', 'd^{\\pi_{\\theta_k}}_{\\widehat{P}}(\\cdot, \\cdot)')
('20.1', 'd^{\\pi_{k+1}}_{\\widehat{P}}')
('20.1', 'L_q := \\frac{L_r}{1 - \\gamma}')
('20.1', '\\pi_{\\theta_k}')
('20.1', '\\pi_{k+1}')
('20.1', 'Q_{\\theta_k}')
('20.1', '\\widehat{Q}_k')
('20.1', '\\begin{aligned}\n    &\\mathbb{E} \\Big[ \\Big \\|  \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\theta_k},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big]  -   \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{k+1},\\widehat{P})}\\big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\theta_k)\n        \\big] \\Big \\| \\Big]  \\nonumber \\\\\n  &= 2L_q \\mathbb{E} \\Big[  \\big \\| d^{\\pi_{\\theta_k}}_{\\widehat{P}}(\\cdot, \\cdot) - d^{\\pi_{k+1}}_{\\widehat{P}}(\\cdot, \\cdot) \\big \\|_{\\rm TV} \\Big] \\nonumber \\\\\n  &\\overset{(i)}{\\leq} 2 L_q C_d \\mathbb{E} \\Big[  \\big \\| Q_{\\theta_k} - \\widehat{Q}_{k} \\big \\| \\Big] \\nonumber \\\\\n  &\\overset{(ii)}{\\leq} 2 L_q C_d \\sqrt{|\\mathcal{S}| \\times |\\mathcal{A}|} ~ \\mathbb{E} \\Big[  \\big \\| Q_{\\theta_k} - \\widehat{Q}_{k} \\big \\|_{\\infty} \\Big] \\nonumber \\\\\n  &= 2 L_q C_d \\sqrt{|\\mathcal{S}| \\times |\\mathcal{A}|} ~ \\mathbb{E} \\Big[  \\big \\| Q_{\\theta_k} - Q_k + Q_k - \\widehat{Q}_{k} \\big \\|_{\\infty} \\Big] \\nonumber \\\\\n  &\\leq 2 L_q C_d \\sqrt{|\\mathcal{S}| \\times |\\mathcal{A}|} ~ \\mathbb{E} \\Big[  \\big \\| Q_{\\theta_k} - Q_k \\big \\|_{\\infty} + \\epsilon_{\\rm app} \\Big] \\label{bound:reward_grad_traj_difference}\n\\end{aligned}')
('20.1', '\\begin{aligned}\n    \\mathbb{E} \\big[ \\widehat{L}(\\theta_{k+1}) \\big] &\\geq \\mathbb{E} \\big[ \\widehat{L}(\\theta_k) \\big] - 4\\alpha C_d L_q^2 \\sqrt{|\\mathcal{S}| \\times |\\mathcal{A}|} ~ \\mathbb{E} \\Big[  \\big \\| Q_{\\theta_k} - Q_k \\big \\|_{\\infty} + \\epsilon_{\\rm app} \\Big] + \\alpha \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] - 2L_c L_q^2 \\alpha^2 \\label{bound:surrogate_difference}\n\\end{aligned}')
('20.1', '\\alpha')
('20.1', '\\begin{aligned}\n    \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] \\leq \\frac{1}{\\alpha} \\mathbb{E} \\big[ \\widehat{L}(\\theta_{k+1}) - \\widehat{L}(\\theta_k) \\big] + 4 C_d L_q^2 \\sqrt{|\\mathcal{S}| \\times |\\mathcal{A}|} ~ \\mathbb{E} \\Big[  \\big \\| Q_{\\theta_k} - Q_k \\big \\|_{\\infty} + \\epsilon_{\\rm app} \\Big] + 2\\alpha L_c L_q^2. \\label{bound:surrogate_obj_grad_norm}\n\\end{aligned}')
('20.1', 'C_0 := 4 C_d L_q^2 \\sqrt{|\\mathcal{S}| \\times |\\mathcal{A}|}')
('20.1', 'k = 0')
('20.1', 'k = K - 1')
('20.1', 'K')
('20.1', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k = 0}^{K-1} \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] \\leq \\frac{\\mathbb{E} \\big[ \\widehat{L}(\\theta_{K}) - \\widehat{L}(\\theta_0) \\big]}{\\alpha K} + \\frac{C_0}{K} \\sum_{k = 0}^{K-1} \\Big[  \\big \\| Q_{\\theta_k} - Q_k \\big \\|_{\\infty} + \\epsilon_{\\rm app} \\Big] + 2\\alpha L_c L_q^2 \\label{ineq:summation_surrogate_obj_grad_norm}\n\\end{aligned}')
('20.1', '\\begin{aligned}\n|L(\\theta) - \\widehat{L}(\\theta)| \\leq \\frac{\\gamma C_{v}}{1 - \\gamma} \\cdot \\mathbb{E}_{(s,a) \\sim d^{\\rm E}(\\cdot, \\cdot)}\\big[ \\| P(\\cdot|s,a) - \\widehat{P}(\\cdot|s,a) \\|_1 \\big] \\leq \\frac{2 \\gamma C_{v}}{1 - \\gamma} \\label{ineq:obj_gap_bound}    \n\\end{aligned}')
('20.1', '\\| P(\\cdot|s,a) - \\widehat{P}(\\cdot|s,a) \\|_1 \\leq 2')
('20.1', '(s,a)')
('20.1', 'L(\\theta)')
('20.1', '\\widehat{L}(\\theta)')
('20.1', '\\theta')
('20.1', 'C_1 := \\frac{2 \\gamma C_{v}}{1 - \\gamma}')
('20.1', '\\begin{aligned}\n    \\widehat{L}(\\theta) \\leq L(\\theta) + \\frac{2 \\gamma C_{v}}{1 - \\gamma} \\leq \\frac{2 \\gamma C_{v}}{1 - \\gamma} = C_1.  \\label{upper_bound:surrogate_obj}\n\\end{aligned}')
('20.1', '\\widehat{L}(\\theta_0)')
('20.1', 'C_2 := \\widehat{L}(\\theta_0)')
('20.1', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k = 0}^{K-1} \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] \\leq \\frac{C_1 - C_2}{\\alpha K} + C_0 \\epsilon_{\\rm app} + \\frac{C_0 \\Delta_0}{K(1- \\gamma)} + \\frac{4\\alpha C_0 L_q^2}{1 - \\gamma} + \\frac{2 \\gamma \\epsilon_{\\rm app} C_0}{(1 - \\gamma)^2} + 2\\alpha L_c L_q^2. \\nonumber\n\\end{aligned}')
('20.1', '\\alpha')
('20.1', '\\alpha = \\alpha_0 \\cdot K^{-\\frac{1}{2}}')
('20.1', '\\begin{aligned}\n    \\frac{1}{K} \\sum_{k = 0}^{K-1} \\mathbb{E} \\big[ \\| \\nabla \\widehat{L}(\\theta_k) \\|^2 \\big] = \\mathcal{O}(K^{-\\frac{1}{2}}) + \\mathcal{O}(\\epsilon_{\\rm app}). \\nonumber\n\\end{aligned}')
('21', 'r(s,a;\\theta) := \\phi(s,a)^{\\top} \\theta')
('21', '\\phi(s,a)')
('21', '(s,a)')
('21', '\\label{formulation:surrogate_rewrite}\n        \\begin{align} \n    \\max_{\\theta} &~~~\\widehat{L}(\\theta) := \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) \\Big) \\Big] \\nonumber \\\\\n    & \\quad \\quad \\quad \\quad - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi_{\\theta}, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) + \\mathcal{H}(\\pi_{\\theta}(\\cdot | s_t)) \\Big) \\Big] \\label{objective:surrogate_rewrite}  \\\\\n    s.t. &~~~\\pi_{\\theta} := \\arg \\max_{\\pi} ~ \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) + \\mathcal{H} \\big(\\pi(\\cdot | s_t) \\big) \\Big) \\Big]. \\label{optimal_policy:rewrite}\n\\end{align}')
('21', '\\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) + \\mathcal{H} \\big(\\pi(\\cdot | s_t) \\big) \\Big) \\Big]')
('21', '\\begin{aligned}\n    \\max_{\\theta} \\min_{\\pi} ~ \\mathcal{L}(\\theta, \\pi) &:= \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) \\Big) \\Big] \\nonumber \\\\\n    &\\quad \\quad - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) + \\mathcal{H}(\\pi(\\cdot | s_t)) \\Big) \\Big] . \\label{formulation:min_max} \n\\end{aligned}')
('21', '\\tilde{\\theta}')
('21', '\\pi_{\\tilde{\\theta}}')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', 'r(s,a;\\theta) := \\phi(s,a)^{\\top} \\theta')
('21', '\\phi(s,a)')
('21', '(s,a)')
('21', '\\tilde{\\theta}')
('21', '\\pi_{\\tilde{\\theta}}')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\eqref{formulation:min_max}')
('21', 'r(s,a;\\theta) := \\phi(s,a)^{\\top} \\theta')
('21', '\\mathcal{L}(\\theta, \\pi)')
('21', '\\begin{aligned}\n    \\mathcal{L}(\\theta, \\pi) &:= \\underbrace{ \\left \\langle \\theta, \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\phi(s_t,a_t) \\Big] -  \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\phi(s_t,a_t) \\Big]  \\right \\rangle }_{\\rm Term ~ A: ~\\text{\\footnotesize a linear function of the reward parameter $\\theta$}} \\nonumber \\\\\n    &\\quad \\quad + \\underbrace{ \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t U(s_t, a_t) \\Big] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( U(s_t, a_t) + \\mathcal{H}(\\pi(\\cdot | s_t)) \\Big) \\Big]. }_{\\rm Term ~ B: ~\\text{\\footnotesize independent of the reward parameter $\\theta$}} \\label{formulation:min_max_linear_reward}\n\\end{aligned}')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\theta')
('21', '\\pi')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\begin{aligned}\n    \\mathcal{L}(\\theta, \\pi_{\\tilde{\\theta}}) \\leq \\mathcal{L}(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}}) \\leq \\mathcal{L}(\\tilde{\\theta}, \\pi)  \\label{ineq:saddle_point}\n\\end{aligned}')
('21', '\\theta')
('21', '\\pi')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\begin{align}\n    &\\tilde{\\theta} \\in \\arg \\max_{\\theta} \\mathcal{L}(\\theta, \\pi_{\\tilde{\\theta}}), \\label{optimality_condition:reward}  \\\\\n    &\\pi_{\\tilde{\\theta}} \\in \\arg \\min_{\\pi} \\mathcal{L}(\\tilde{\\theta}, \\pi). \\label{optimality_condition:policy}\n\\end{align}')
('21', '\\tilde{\\theta}')
('21', '\\widehat{L}(\\cdot)')
('21', '\\widehat{L}(\\cdot)')
('21', '\\tilde{\\theta}')
('21', '\\widehat{L}(\\cdot)')
('21', '\\begin{aligned}\n    \\nabla \\widehat{L}(\\tilde{\\theta}) = \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta,\\pi^{\\rm E},P)}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta} \n        \\nabla_{\\theta} r(s_t, a_t;\\tilde{\\theta})\n        \\Big] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\tilde{\\theta}},\\widehat{P})}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\nabla_{\\theta}r(s_t, a_t;\\tilde{\\theta})\n        \\Big]  = 0  \\nonumber\n\\end{aligned}')
('21', 'r(s,a;\\theta) := \\phi(s,a)^{\\top} \\theta')
('21', '\\tilde{\\theta}')
('21', '\\begin{aligned}\n    \\nabla \\widehat{L}(\\tilde{\\theta}) = \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta,\\pi^{\\rm E},P)}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta} \n        \\phi(s_t, a_t)\n        \\Big] - \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta,\\pi_{\\tilde{\\theta}},\\widehat{P})}\\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \n        %\\frac{\\partial r_{\\theta}(s_t, a_t)}{\\partial \\theta}\n        \\phi(s_t, a_t)\n        \\Big]  = 0 \\label{first_order_condition:linear_reward}\n\\end{aligned}')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\pi')
('21', '\\mathcal{L}(\\theta, \\pi)')
('21', '\\theta')
('21', '\\begin{aligned}\n    \\nabla_{\\theta} \\mathcal{L}(\\theta, \\pi) = \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\phi(s_t,a_t) \\Big] -  \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\phi(s_t,a_t) \\Big]. \\label{grad_expression:max_min_reward}\n\\end{aligned}')
('21', '\\begin{aligned}\n    \\nabla_{\\theta} \\mathcal{L}(\\theta = \\tilde{\\theta}, \\pi = \\pi_{\\tilde{\\theta}}) = 0. \\label{saddle_point_condition:first_order_reward}\n\\end{aligned}')
('21', '\\mathcal{L}(\\cdot,\\cdot)')
('21', '\\theta')
('21', '\\pi')
('21', '\\pi_{\\tilde{\\theta}}')
('21', '\\theta')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\begin{aligned}\n    \\mathcal{L}(\\theta, \\pi) &:= \\underbrace{ \\mathbb{E}_{\\tau^{\\rm E} \\sim (\\eta, \\pi^{\\rm E}, P)} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) \\Big) \\Big] }_{ \\rm Term ~ I_1: ~\\text{\\footnotesize independent of $\\pi$} } \\nonumber \\\\\n    &\\quad \\quad - \\underbrace{ \\mathbb{E}_{\\tau^{\\rm A} \\sim (\\eta, \\pi, \\widehat{P})} \\Big[ \\sum_{t = 0}^{\\infty} \\gamma^t \\Big( r(s_t, a_t; \\theta) + U(s_t, a_t) + \\mathcal{H}(\\pi(\\cdot | s_t)) \\Big) \\Big] }_{ \\rm Term ~ I_2: ~\\text{\\footnotesize a function of the policy $\\pi$} } . \\label{formulation:min_max_rewrite} \n\\end{aligned}')
('21', '\\pi_{\\tilde{\\theta}}')
('21', '\\tilde{\\theta}')
('21', '\\begin{aligned}\n   \\pi_{\\tilde{\\theta}} \\in \\arg \\min_{\\pi} \\mathcal{L}(\\tilde{\\theta}, \\pi) \\nonumber\n\\end{aligned}')
('21', '\\tilde{\\theta}')
('21', '\\widehat{L}(\\cdot, \\cdot)')
('21', '\\pi_{\\tilde{\\theta}}')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\tilde{\\theta}')
('21', '\\widehat{L}(\\cdot)')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\begin{aligned}\n  \\min_{\\pi} \\max_{\\theta} \\mathcal{L}(\\theta, \\pi) \\leq \\max_{\\theta} \\mathcal{L}(\\theta, \\pi_{\\tilde{\\theta}}) \\overset{(i)}{=} \\mathcal{L}(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}}) \\overset{(ii)}{=} \\min_{\\pi}  \\mathcal{L}(\\tilde{\\theta}, \\pi)  \\leq \\max_{\\theta} \\min_{\\pi} \\mathcal{L}(\\theta, \\pi) \\label{property:saddle_point}\n\\end{aligned}')
('21', '(i)')
('21', '(ii)')
('21', '\\begin{aligned}\n    \\max_{\\theta} \\min_{\\pi} \\mathcal{L}(\\theta, \\pi) \\leq \\min_{\\pi} \\max_{\\theta} \\mathcal{L}(\\theta, \\pi). \\label{ineq:minimax}\n\\end{aligned}')
('21', '\\begin{aligned}\n  \\min_{\\pi} \\max_{\\theta} \\mathcal{L}(\\theta, \\pi) = \\max_{\\theta} \\mathcal{L}(\\theta, \\pi_{\\tilde{\\theta}}) = \\mathcal{L}(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}}) = \\min_{\\pi}  \\mathcal{L}(\\tilde{\\theta}, \\pi)  = \\max_{\\theta} \\min_{\\pi} \\mathcal{L}(\\theta, \\pi). \\label{equality:saddle_point}\n\\end{aligned}')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\tilde{\\theta}')
('21', '\\pi_{\\tilde{\\theta}}')
('21', '\\begin{align}\n        &\\tilde{\\theta} \\in \\arg \\max_{\\theta} \\min_{\\pi} \\mathcal{L}(\\theta, \\pi), \\label{optimal_solution:reward} \\\\\n        &\\pi_{\\tilde{\\theta}} \\in \\arg \\min_{\\pi} \\max_{\\theta} \\mathcal{L}(\\theta, \\pi). \\label{optimal_solution:policy}\n    \\end{align}')
('21', '\\widehat{L}(\\cdot)')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\theta')
('21', '\\begin{aligned}\n    \\widehat{L}(\\theta) = \\min_{\\pi} \\mathcal{L}(\\theta, \\pi). \\label{formulation:equality}\n\\end{aligned}')
('21', '\\begin{aligned}\n    \\tilde{\\theta} \\in \\arg \\max_{\\theta} \\min_{\\pi} ~ \\mathcal{L}(\\theta, \\pi) = \\arg \\max_{\\theta} ~ \\widehat{L}(\\theta). \\label{global_optimum:reward}\n\\end{aligned}')
('21', '(\\tilde{\\theta}, \\pi_{\\tilde{\\theta}})')
('21', '\\mathcal{L}(\\cdot, \\cdot)')
('21', '\\tilde{\\theta}')
('21', '\\widehat{L}(\\cdot)')
('21', 'L(\\cdot)')
('21', '\\widehat{L}(\\cdot)')
('21', '\\begin{aligned}\n    \\theta^* \\in \\arg\\max_{\\theta} ~ L(\\theta), \\quad \\hat{\\theta} \\in \\arg\\max_{\\theta} ~ \\widehat{L}(\\theta).  \\label{def:optimal_reward_estimates}\n\\end{aligned}')
('21', '\\epsilon \\in (0,2)')
('21', 'N')
('21', '(s,a) \\in \\Omega')
('21', '\\mathcal{D}')
('21', '\\begin{aligned}\n    \\#\\textit{transition samples} \\geq |\\Omega| \\cdot N \\geq \\frac{4\\gamma^2 \\cdot C_v^2 \\cdot c^2 \\cdot |\\Omega| \\cdot |\\mathcal{S}^{\\rm E}|}{ (1-\\gamma)^2 \\varepsilon^2  } \\ln \\Big( \\frac{|\\Omega|}{\\delta} \\Big) \\label{ineq:transition_samples}\n\\end{aligned}')
('21', 'c')
('21', '\\delta')
('21', '1 - \\delta')
('21', '\\begin{aligned}\n    L(\\theta^*) - L(\\hat{\\theta}) \\leq \\varepsilon. \\nonumber\n\\end{aligned}')
('21', '\\tilde{\\theta}')
('21', '\\tilde{\\theta}')
('21', '\\tilde{\\theta}')
('21', '1 - \\delta')
('21', '\\begin{aligned}\n    L(\\theta^*) - L(\\tilde{\\theta}) \\leq \\varepsilon. \\nonumber\n\\end{aligned}')
