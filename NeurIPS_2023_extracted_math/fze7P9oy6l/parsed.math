('1', '40\\%\\sim 87\\%')
('1', '6\\%')
('2.0', '<\\mathcal{S}, \\mathcal{A}, R, P, \\mu>')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', "R(s, a, s'):\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\rightarrow \\mathbb{R}")
('2.0', 's')
('2.0', "s'")
('2.0', 'a')
('2.0', "P(s'|s,a):\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\rightarrow [0, 1]")
('2.0', 's')
('2.0', "s'")
('2.0', 'a')
('2.0', '\\mu: \\mathcal{S}\\rightarrow[0, 1]')
('2.0', '\\pi: \\mathcal{\\mu}\\rightarrow P(A)')
('2.0', 'J(\\pi)= \\underset{\\substack{s_0\\sim\\mu,a_t\\sim \\pi(\\cdot|s_t)\\\\s_{t+1}\\sim P(\\cdot|s_t,a_t)}}{\\mathbb{E}}[\\sum_{t=0}^{\\infty}\\gamma^t R(s_t,a_t,s_{t+1})]\n\\label{eq:mdp_objective}')
('2.0', '\\pi')
('2.0', "Q^{\\pi}(s_t,a_t)=\\mathbb{E}_{\\pi}\\sum_{t'=t}^{\\infty}r(s_t',a_t')")
('2.0.0', '\\mathcal{D}')
('2.0.0', "\\begin{aligned}\n    \\label{eq:policy_evaluation}\n    \\min_{\\psi}\\mathbb{E}_{(s,a,s',r)\\sim\\mathcal{D}} [(Q^{\\pi}_{\\psi}(s,a) - (r(s,a) + \\gamma \\mathbb{E}_{{a'\\sim \\pi_{\\theta}}}Q^{\\pi}_{\\psi^{'}}(s',a')))]^2\\qquad \\text{(Policy Evaluation)}\n\\end{aligned}")
('2.0.0', '\\pi')
('2.0.0', '\\psi')
('2.0.0', '\\theta')
('2.0.0', "\\psi^{'}")
('2.0.0', '\\begin{aligned}\n    \\label{eq:policy_update}\n    \\max_{\\theta}\\mathbb{E}_{s\\sim\\mathcal{D}}[Q^{\\pi}_{\\psi}(s,\\pi_{\\theta})]\\qquad\\qquad \\text{(Policy Update)}\n\\end{aligned}')
('2.0.0.0', '\\begin{aligned}\n    \\label{eq:policy_update_brac}\n    \\max_{\\theta}\\mathbb{E}_{s\\sim\\mathcal{D}}[Q^{\\pi}_{\\psi}(s,\\pi_{\\theta})]\\qquad  \\mathop{\\mathrm{s.t.\\ }}\\mathbb{E}_{s\\sim\\mathcal{D}}[D(\\pi_{\\theta}(\\cdot|s)||\\pi_b(\\cdot|s))]<\\epsilon \\qquad \\text{(BRAC Policy Update)}\n\\end{aligned}')
('2.0.0.0', 'D')
('2.0.0.0', '\\pi_{\\theta}')
('2.0.0.0', '\\pi_b')
('2.0.0.0', '\\begin{aligned}\n    \\label{eq:behavior_policy}\n    \\pi_b(a|s)=\\mathop{\\mathrm{arg\\,max}}_{\\pi_b} \\mathbb{E}_{(s,a)\\sim\\mathcal{D}}[p(a|s)]\n\\end{aligned}')
('3', "\\mathcal{D} = \\{(s_i,a_i,s'_i,r_i)\\}_{i=1}^{N}")
('3', '\\pi_{\\theta}')
('5.0', '\\mathcal{D}')
('5.0', '\\pi_b(a|s)>\\epsilon')
('5.0', '\\pi_{\\theta}')
('5.0', '\\pi_{\\theta}')
('5.0', '\\begin{aligned}\n  \\label{eq:criteria}\n  \\mathbb{E}_{a\\sim\\pi_{\\theta}(\\cdot|s)}[\\pi_b(a|s)]>\\epsilon\n\\end{aligned}')
('5.0', '\\epsilon')
('5.0.0', "\\begin{aligned}\n  \\label{eq:mmd}\n  \\text{MMD}_{k}^{2}(\\pi(\\cdot|s),\\pi_b(\\cdot|s))=\\underset{x,x'\\sim\\pi(\\cdot|s)}{\\mathbb{E}}[K(x,x')]\n  -2\\underset{\\substack{x\\sim\\pi(\\cdot|s),\\\\y\\sim\\pi_b(\\cdot|s)}}{\\mathbb{E}}[K(x,y)]\n  +\\underset{y,y'\\sim\\pi_b(\\cdot|s)}{\\mathbb{E}}[K(y,y')]\n\\end{aligned}")
('5.0.0', 'K')
('5.0.0.0', 'P')
('5.0.0.0', 'Q')
('5.0.0.0', '\\chi')
('5.0.0.0', 'Q')
('5.0.0.0', 'P')
('5.0.0.0', '\\begin{aligned}\n    \\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(P,Q) = \\int_{x \\sim \\chi} P(x)\\log \\frac{P(x)}{Q(x)}dx\n\\end{aligned}')
('5.0.0.0', '\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\theta}(\\cdot|s), \\pi_b(\\cdot|s))<\\epsilon_{\\text{KL}}')
('5.0.0.0', '\\mathcal{H(\\pi_{\\theta})}=\\mathcal{H}_0')
('5.0.0.1', '\\pi_{\\theta}')
('5.0.0.1', '\\pi_{b}')
('5.0.0.1', '\\pi_{b}')
('5.0.0.1', 'Z')
('5.0.0.1', '\\log \\pi_{b}(a|s)\\geq \\mathbb{E}_{z\\sim q(z|s,a)}[\\log p(a|s,z)]-\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(q(z|s,a)||p(z))')
('5.0.0.1', 'q(z|s,a)')
('5.0.0.1', 'p(z)')
('5.0.0.1', '\\begin{aligned}\n  \\label{eq:kl_upperbound}\n  \\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\theta}(\\cdot|s)||&\\pi_{b}(\\cdot|s))=\\mathbb{E}_{a\\sim\\pi_{\\theta}}[\\log \\pi_{\\theta}(a|s)-\\log \\pi_{b}(a|s)] \\nonumber\\\\\n  &\\leq \\mathbb{E}_{a\\sim\\pi_{\\theta}}[\\log \\pi_{\\theta}(a|s)]-\\mathbb{E}_{a\\sim\\pi_{\\theta}}[\\mathbb{E}_{z\\sim q(z|s,a)}[\\log p(a|s,z)]-\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(q(z|s,a)||p(z))] \\nonumber\\\\\n  &=\\mathbb{E}_{a\\sim\\pi_{\\theta}, z\\sim q(z|s,a)}[\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\theta}(\\cdot|s)||p(\\cdot|s,z))+\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(q(z|s,a)||p(z))]\\nonumber \\\\\n  &=\\mathcal{D}^{\\text{upper}}_{\\text{KL}}(\\pi_{\\theta}(\\cdot|s)||\\pi_{b}(\\cdot|s))\n  % &=\\mathbb{E}_{z\\sim p(z)}[\\kl(\\pi_{\\theta}(\\cdot|s)||p(\\cdot|s,z))] \\quad \\text{at inference time } q(z)=p(z)\n\\end{aligned}')
('5.0.0.1', 'p(\\cdot|s,z)')
('5.0.0.1', 'q(z|s,a)')
('5.0.0.1', 'p(z)=\\mathcal{N}(0,1)')
('5.0.0.1', '\\pi_{\\theta}(a|s)=\\mathcal{N}(\\mu_{\\theta}(s), \\sigma_{\\theta}(s))')
('5.0.0.1', '\\mu_{\\theta}')
('5.0.0.1', '\\sigma_{\\theta}')
('5.0.0.2', '\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(q(z|s,a)||p(z|s,a))')
('5.0.0.2', 'p(z|s,a)')
('5.0.0.2', 'q(z|s,a)')
('5.0.0.2', '\\begin{aligned}\n  \\resizebox{0.92\\columnwidth}{!}{$\n  \\underset{s\\sim\\mathcal{D}}{\\mathbb{E}}[{\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\theta}(\\cdot|s)||\\pi_{b}(\\cdot|s))}]=\\underset{s\\sim\\mathcal{D}}{\\mathbb{E}}[\\mathcal{D}^{\\text{upper}}_{\\text{KL}}(\\pi_{\\theta}(\\cdot|s)||\\pi_{b}(\\cdot|s))]-\\underset{s\\sim\\mathcal{D}}{\\mathbb{E}}[\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(q(z|s,a)||p(z|s,a))]$\n  }\n\\end{aligned}')
('5.0.0.2', '\\mathbb{E}_{s\\sim\\mathcal{D}}[\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(q(z|s,a)||p(z|s,a))]')
('5.0.0.2', '\\begin{aligned}\n  \\label{eq:policy_update_bracp}\n  \\max_{\\theta}\\mathbb{E}_{s\\sim\\mathcal{D}}[Q^{\\pi}_{\\psi}(s,\\pi_{\\theta})]\\ \\mathop{\\mathrm{s.t.\\ }}\\ \\mathbb{E}_{s\\sim\\mathcal{D}}[{\\mathcal{D}^{\\text{upper}}_{\\text{KL}}(\\pi_{\\theta}(\\cdot|s)||\\pi_{b}(\\cdot|s))}]<\\epsilon^{\\text{upper}}_{\\text{KL}}\\ \\text{and}\\  \\mathcal{H(\\pi_{\\theta})}=\\mathcal{H}_0\n\\end{aligned}')
('5.1', '\\pi_{old}')
('5.1', '\\pi_{new}')
('5.1', '\\pi_{old}')
('5.1', '\\mathbb{E}_{a\\sim\\pi}[Q^{\\pi}(s,a)]')
('5.1', '\\mathbb{E}_{a\\sim\\pi_b}[Q^{\\pi_{\\text{new}}}(s,a)-Q^{\\pi_{\\text{old}}}(s,a)]>\\delta')
('5.1', '\\delta=\\sup_{a}|Q^{\\pi_{\\text{new}}}(s,a)-Q^{\\pi_{\\text{old}}}(s,a)|\\cdot\\sqrt{\\nicefrac{\\epsilon_{\\text{KL}}}{2}}')
('5.1', '\\epsilon_{\\text{KL}}=\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\text{new}}||\\pi_b)')
('5.1', '\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{new}}}(s,a)]>\\mathbb{E}_{a\\sim\\pi_{\\text{old}}}[Q^{\\pi_{\\text{old}}}(s,a)]')
('5.1', '\\delta')
('5.1', '\\mathbb{E}_{(s,a)\\sim\\mathcal{D}}[Q^{\\pi}(s,a)]')
('5.1', '\\mathbb{E}_{(s,a)\\sim\\pi}[Q^{\\pi}(s,a)]')
('5.1.0', '\\mathbb{E}_{a\\sim\\pi}[Q^{\\pi}(s,a)]')
('5.1.0', "\\begin{aligned}\n  \\label{eq:policy_improvement_gp}\n  \\resizebox{0.92\\columnwidth}{!}{$\n  \\min_{\\psi}\\mathbb{E}_{(s,a,s',r)\\sim\\mathcal{D}} [(Q^{\\pi}_{\\psi}(s,a) - (r(s,a) + \\gamma \\mathbb{E}_{{a'\\sim \\pi_{\\theta}}}Q^{\\pi}_{\\psi^{'}}(s',a')))]^2 +\n  \\lambda  \\underset{a^{''}\\sim\\pi(\\cdot|s)}{\\mathbb{E}}(||\\nabla_{a^{''}}Q^{\\pi}_{\\psi}(s,a^{''})||_2 f(\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi||\\pi_b))$\n  }\n\\end{aligned}")
('5.1.0', '\\pi')
('5.1.0', 'f')
('5.1.0', '\\lambda')
('6', 'f')
('6', '\\mathcal{H}')
('6.0.0', '63\\%')
('6.0.0', '164\\%')
('6.0.0', '16.3\\%')
('6.0.0.0', '3\\%\\sim 6\\%')
('9.0', '\\pi_{\\text{old}}')
('9.0', 'Q^{\\pi_{\\text{old}}}')
('9.0', '\\pi_{\\text{old}}')
('9.0', '\\mathbb{E}_{a\\sim\\pi}[Q^{\\pi}(s,a)]')
('9.0', '\\begin{aligned}\n        \\label{eq:policy_update_inequal}\n        \\mathbb{E}_{a\\sim \\pi_{\\text{new}}}[Q^{\\pi_{\\text{old}}}(s,a)]>\\mathbb{E}_{a\\sim \\pi_{\\text{old}}}[Q^{\\pi_{\\text{old}}}(s,a)]\n    \n\\end{aligned}')
('9.0', '\\Delta Q(s,a)=Q^{\\pi_{\\text{new}}}(s,a)-Q^{\\pi_{\\text{old}}}(s,a)')
('9.0', '\\begin{aligned}\n        |\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[\\Delta Q(s,a)]-\\mathbb{E}_{a\\sim\\pi_b}[\\Delta Q(s,a)]|\\leq \\sup_{a}|\\Delta Q(s,a)|\\sqrt{\\frac{\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\text{new}}||\\pi_b)}{2}}\n    \n\\end{aligned}')
('9.0', '\\mathbb{E}_{a\\sim\\pi_b}[\\Delta Q(s,a)]>\\sup_{a}|\\Delta Q(s,a)|\\sqrt{\\frac{\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi_{\\text{new}}||\\pi_b)}{2}}')
('9.0', '\\begin{aligned}\n        \\label{eq:policy_evaluation_inequal}\n        \\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[\\Delta Q(s,a)]> 0\n    \n\\end{aligned}')
('9.0', '\\begin{aligned}\n        &\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{new}}}(s,a)] - \\mathbb{E}_{a\\sim\\pi_{\\text{old}}}[Q^{\\pi_{\\text{old}}}(s,a)]\\nonumber\\\\\n        &=\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{new}}}(s,a)] - \\mathbb{E}_{a\\sim\\pi_{\\text{old}}}[Q^{\\pi_{\\text{old}}}(s,a)] + \\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{old}}}(s,a)] - \\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{old}}}(s,a)] \\nonumber\\\\\n        &=(\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{old}}}(s,a)]-\\mathbb{E}_{a\\sim\\pi_{\\text{old}}}[Q^{\\pi_{\\text{old}}}(s,a)]) + (\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{new}}}(s,a)]-\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{old}}}(s,a)]) \\nonumber \\\\\n        &> \\mathbb{E}_{a\\sim \\pi_{\\text{new}}}[Q^{\\pi_{\\text{new}}}(s,a)-Q^{\\pi_{\\text{old}}}(s,a)]=\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[\\Delta Q(s,a)]> 0\n    \n\\end{aligned}')
('9.0', '\\mathbb{E}_{a\\sim\\pi_{\\text{new}}}[Q^{\\pi_{\\text{new}}}(s,a)] > \\mathbb{E}_{a\\sim\\pi_{\\text{old}}}[Q^{\\pi_{\\text{old}}}(s,a)]')
('10.0', '[0, 1]')
('10.0', "\\begin{aligned}\n    r'=(r-r_{min}) / (r_{max} - r_{min})\n\\end{aligned}")
('10.0', 'r_{max}')
('10.0', 'r_{min}')
('10.0.0', '\\pi_{\\theta}=\\mathop{\\mathrm{arg\\,min}}_{\\pi_{\\theta}\\in \\Pi}\\mathop{\\mathrm{\\mathcal{D}_{\\text{KL}}}}(\\pi, \\pi_{\\beta})')
('10.0.0', '\\Pi')
('10.0.0', '\\Pi')
('10.0.0', 'Q^{\\pi_{\\theta}}')
('10.0.0.1', '\\{Q_{\\psi_1}, Q_{\\psi_2}\\}')
('10.0.0.1', "\\{Q_{{\\psi'}_1}, Q_{{\\psi'}_2}\\}")
('10.0.0.1', "\\begin{aligned}\n    Q_{\\psi'}(s',a')=\\min_{j=1,2}Q_{{\\psi'}_j}(s',a')\n\\end{aligned}")
('10.0.0.2', 'Z')
('10.0.0.2', 'z')
('10.0.0.2', 'B')
('10.0.0.2', 'B=3')
('10.0.0.3', '\\mathcal{H}_0')
('10.0.0.3', '\\epsilon')
('10.0.0.3', '\\mathcal{H}_0=\\nicefrac{\\mathcal{H}(\\pi_b)}{4}')
('10.0.0.3', '\\epsilon')
('10.0.0.3', '\\epsilon_{\\min}=\\min D(\\pi_{\\theta}, \\pi_b)')
('10.0.0.3', '\\epsilon=\\epsilon_{\\min}+\\epsilon_{\\text{generalization}}')
('10.0.0.3', '\\epsilon_{\\text{generalization}}')
('10.0.0.3', '\\epsilon_{\\text{generalization}}=3.0')
('10.0.0.3', '\\epsilon_{\\text{generalization}}=0.2')
('10.0.0.3', '\\epsilon_{\\text{generalization}}=1.0')
('10.0.0.3', '\\epsilon_{\\text{generalization}}=7.0')
('10.0.0.3', '\\tau')
('10.0.0.3', '\\gamma')
('10.0.0.3', 'T')
