('1', 'E({\\mathbf{x}})')
('1', '\\tilde p({\\mathbf{x}}) = \\exp(-E({\\mathbf{x}}))')
('2.0', '(\\log p_T, \\eta, \\phi)')
('2.0', 'p_T')
('2.0', '\\eta, \\phi')
('2.0', '{\\mathbf{x}}= \\{(\\log p_T, \\eta, \\phi)_i\\}_i^N')
('2.0', 'p({\\mathbf{x}})')
('2.0', 'p(y | {\\mathbf{x}})')
('3.0', 'E({\\mathbf{x}}, y)')
('3.0', 'q_\\theta({\\mathbf{x}})')
('3.0', '{\\mathbf{x}}_0^-')
('3.0', '\\exp(-E({\\mathbf{x}}))')
('3.0', 'p_\\theta({\\mathbf{x}}) = \\exp(-E_\\theta({\\mathbf{x}})) / Z(\\theta)')
('3.0', 'E_\\theta({\\mathbf{x}}) \\footnote{%\\paragraph{Physics Energy vs Probabilistic Energy}\nWe note that this energy function is not to be confused with the physical energy of the HEP events/objects. Here the energy is essentially an abstract quantity used for probabilistic modelling of the radiation patterns and substructures. It can approximately serve as a measure of radiation substructure or complexity when describing HEP events.}: {\\mathcal{X}}\\to \\mathbb{R}')
('3.0', '{\\mathbf{x}}\\in {\\mathcal{X}}')
('3.0', 'Z = \\int \\tilde p({\\mathbf{x}}) d{\\mathbf{x}}= \\int \\exp(-E_\\theta({\\mathbf{x}})) d{\\mathbf{x}}')
('3.0', '\\mathbb{E}_{p_D}(\\log p_\\theta ({\\mathbf{x}}))')
('3.0', '\\log p_\\theta ({\\mathbf{x}}) = -E_\\theta ({\\mathbf{x}}) - \\log Z(\\theta)')
('3.0', '\\theta')
('3.0', '\\begin{aligned}\n    \\nabla_\\theta \\mathcal{L}(\\theta) \n    &= - \\mathbb{E}_{p_D({\\mathbf{x}})} [\\nabla_\\theta \\log p_\\theta ({\\mathbf{x}})] \\\\\n    &= \\mathbb{E}_{{\\mathbf{x}}^+ \\sim p_D({\\mathbf{x}})} [\\nabla_\\theta E_\\theta ({\\mathbf{x}}^+)] - \\mathbb{E}_{{\\mathbf{x}}^- \\sim p_\\theta ({\\mathbf{x}})} [\\nabla_\\theta E_\\theta ({\\mathbf{x}}^-)]\\, ,\n    \\label{eq:nll}\n\\end{aligned}')
('3.0', 'p_D({\\mathbf{x}})')
('3.0', 'p_\\theta ({\\mathbf{x}})')
('3.0', '{\\mathbf{x}}^+')
('3.0', '{\\mathbf{x}}^-')
('3.0', 'D_{\\mathrm{KL}}(p_D({\\mathbf{x}}) \\Vert p_\\theta({\\mathbf{x}})) - D_{\\mathrm{KL}}(T p_D({\\mathbf{x}}) \\Vert p_\\theta({\\mathbf{x}}))\\, ,\n    \\label{eq:cd}')
('3.0', 'T')
('3.0.0', '\\{{\\mathbf{x}}^-_k\\}_{k=1}^K')
('3.0.0', '{\\mathbf{x}}^{-}_{k+1} = {\\mathbf{x}}^{-}_k - \\frac{\\lambda^2}{2} \\nabla_{\\mathbf{x}}E_\\theta ({\\mathbf{x}}_k^-) + \\lambda \\cdot \\epsilon, \\, \\textrm{with} \\, \\epsilon \\sim {\\mathcal{N}}(0, 1)\n    \\label{eq:ld}')
('3.0.0.0', '\\sim')
('3.0.0.1', 'E_\\theta(\\cdot)')
('3.0.0.1', '\\{{\\mathbf{x}}^+_i\\}_{i=1}^N')
('3.0.0.1', 'p_{\\rm{D}}({\\mathbf{x}})')
('3.0.0.1', 'E_\\theta(\\cdot)')
('3.0.0.1', '{\\mathcal{B}}\\gets \\varnothing')
('3.0.0.1', '\\lambda_{\\mathbf{x}}')
('3.0.0.1', '\\lambda_\\theta')
('3.0.0.1', '\\alpha')
('3.0.0.1', '{\\mathbf{x}}_i^+ \\sim p_{\\rm{D}}({\\mathbf{x}})')
('3.0.0.1', '{\\mathbf{x}}_{i,0}^- \\sim 0.95 * {\\mathcal{B}}+ 0.05 * {\\mathcal{U}}')
('3.0.0.1', '{\\mathbf{x}}^{-}_{i, k+1} = {\\mathbf{x}}^{-}_{i, k} - \\lambda_{\\mathbf{x}}\\nabla_{\\mathbf{x}}E_\\theta ({\\mathbf{x}}_{i, k}^-) + 0.005 \\cdot \\epsilon_k, \\, \\epsilon_k \\sim {\\mathcal{N}}(0, 1)')
('3.0.0.1', '{\\mathbf{x}}_i^- \\gets {\\mathbf{x}}^{-}_{i, K}')
('3.0.0.1', '\\mathcal{L}_{\\rm CD} = \\frac{1}{N} \\sum_i  (E_\\theta({\\mathbf{x}}_i^+) - E_\\theta({\\mathbf{x}}_i^-))')
('3.0.0.1', '\\mathcal{L}_{\\rm reg} = \\frac{1}{N} \\sum_i (E_\\theta({\\mathbf{x}}_i^+)^2 + E_\\theta({\\mathbf{x}}_i^-))^2')
('3.0.0.1', '\\theta \\gets \\theta - \\lambda_\\theta \\nabla_\\theta (\\mathcal{L}_{\\rm CD} + \\alpha \\mathcal{L}_{\\rm reg})')
('3.0.0.1', '{\\mathcal{B}}\\leftarrow {\\mathbf{x}}^-_{i, K} \\cup {\\mathcal{B}}')
('3.1.0', '{\\mathbf{g}}({\\mathbf{x}})')
('3.1.0', 'p({\\mathbf{x}}, y) =  \\frac{\\exp ({\\mathbf{g}}({\\mathbf{x}})_y)}{Z}')
('3.1.0', '{\\mathbf{g}}({\\mathbf{x}})_y')
('3.1.0', 'p({\\mathbf{x}}) = \\frac{\\sum_y \\exp({\\mathbf{g}}({\\mathbf{x}})_y)}{Z}')
('3.1.0', '{\\mathbf{x}}')
('3.1.0', '-\\log \\sum_y \\exp({\\mathbf{g}}({\\mathbf{x}})_y)')
('3.1.0', '\\frac{\\exp({\\mathbf{g}}({\\mathbf{x}})_y)}{\\sum_y \\exp({\\mathbf{g}}({\\mathbf{x}})_y)}')
('3.1.0', 'p(y | {\\mathbf{x}})')
('3.1.0', 'p(y | {\\mathbf{x}})')
('3.1.0', '\\log p({\\mathbf{x}}, y) = \\log p({\\mathbf{x}}) + \\log p(y | {\\mathbf{x}})\\, .\n    \\label{eq:ebm-clf}')
('3.1.0', '\\log p({\\mathbf{x}})')
('3.1.0', 'E({\\mathbf{x}}) = -\\log \\sum_y \\exp({\\mathbf{g}}({\\mathbf{x}})_y)')
('3.1.0', '\\log p(y | {\\mathbf{x}})')
('3.2', 'W')
('3.2', 'A')
('3.2', 'Q')
('3.2', 'K')
('3.2', '\\begin{equation}\n    A = {\\rm softmax} (Q \\cdot K^T / \\sqrt{d_{\\rm model}})\n    \\label{eq:sa_weights}\n    \\end{equation}\n    \\begin{equation}\n    W = A \\cdot V\n    \\label{eq:sa}\n    \\end{equation}')
('3.2', '(\\log p_T, \\eta, \\phi)')
('3.2', 'd_{\\rm model}')
('3.2', 'N_L')
('4.0', '\\lambda_{\\mathbf{x}}')
('4.0', '\\beta_1 = 0.0')
('4.0', '\\beta_2 = 0.999')
('4.0.0', 'p_T = \\sum_{i=1}^N p_{Ti}')
('4.0.0', 'M = \\sqrt{ (\\sum_{i=1}^N E_{i})^2 - (\\sum_{i=1}^N {\\mathbf{p}}_{i})^2}')
('4.1', 'p_{\\rm T}')
('4.1', '(\\eta, \\phi)')
('4.1', '(\\eta, \\phi)')
('4.1', 'p_T')
('4.1', 'M')
('4.1', 'p_T')
('4.1', 'M')
('4.1', '\\beta')
('4.1', 'p_T')
('4.1', '10^{-4}')
('4.1', 'M')
('4.1', '10^{-4}')
('4.1', 'M/p_T')
('4.1', '10^{-4}')
('4.1', '\\beta')
('4.1', '2.4 \\pm 1.9')
('4.1', '3.2 \\pm 2.0')
('4.1', '6.3 \\pm 4.6')
('4.2.0.0', 'E({\\mathbf{x}})')
('4.2.0.0', 'M_J')
('4.2.0.0', 'E')
('4.2.0.1', '\\min_y E({\\mathbf{x}}, y)')
('4.2.0.1', 'H')
('4.2.0.1', 'p_\\theta ({\\mathbf{x}})')
('4.2.0.1', '\\Vert \\nabla_{\\mathbf{x}}\\log p_\\theta ({\\mathbf{x}}) \\Vert = \\Vert \\nabla_{\\mathbf{x}}E({\\mathbf{x}}) \\Vert')
('4.2.0.1', 'E({\\mathbf{x}})')
('4.2.0.1', '\\epsilon_S')
('4.2.0.1', '1/\\epsilon_B')
('4.2.0.1', 'p(y|{\\mathbf{x}})')
('4.2.0.1', '{\\mathbf{g}}({\\mathbf{x}})_y = - E({\\mathbf{x}}, y)')
('4.2.0.1', '\\kappa=1000')
('4.2.0.1', 'H')
('4.2.0.1', '\\kappa=1000')
('4.2.0.1', 'E({\\mathbf{x}})')
('4.2.0.1', '0.679 \\pm 0.009')
('4.2.0.1', '0.794 \\pm 0.032')
('4.2.0.1', '\\Vert \\nabla_{\\mathbf{x}}\\log p_\\theta ({\\mathbf{x}}) \\Vert')
('4.2.0.1', '0.628 \\pm 0.017')
('4.2.0.1', '0.738 \\pm 0.033')
('4.2.0.1', 'E({\\mathbf{x}})')
('4.2.0.1', '0.703 \\pm 0.020')
('4.2.0.1', '0.815 \\pm 0.018')
('4.2.0.1', '\\Vert \\nabla_{\\mathbf{x}}\\log p_\\theta ({\\mathbf{x}}) \\Vert')
('4.2.0.1', '0.679 \\pm 0.040')
('4.2.0.1', '0.722 \\pm 0.028')
('4.2.0.1', '{\\mathbf{g}}({\\mathbf{x}})_y)')
('4.2.0.1', '0.920 \\pm 0.002')
('4.2.0.1', '0.877 \\pm 0.008')
('4.2.0.1', 'p(y|{\\mathbf{x}})')
('4.2.0.1', '0.940 \\pm 0.002')
('4.2.0.1', '0.865 \\pm 0.012')
('4.2.0.1', 'E({\\mathbf{x}})')
('4.2.0.1', '\\epsilon')
('6.0', 'H \\to hh \\to (b \\bar b) (b \\bar b)')
('6.0', 'p_T')
('6.0.0', 'k_T')
('6.0.0', 'R=1.0')
('6.0.0', 'p_T > 450')
('6.0.0.0', '(0,0)')
('6.0.0.0', '(\\eta, \\phi)')
('6.0.0.0', '(\\sum_i \\frac{\\eta_i E_i}{R_i}, \\sum_i \\frac{\\phi_i E_i}{R_i})')
('6.0.0.0', 'R_i = \\sqrt{\\eta_i^2 + \\phi_i^2)}')
('6.0.0.0', 'E_i')
('6.0.0.0', '(\\eta, \\phi)')
('6.0.0.1', '\\in')
('6.0.0.1', '\\in')
('6.0.0.1', '\\in')
('6.0.0.1', '\\log p_{Ti} \\sim {\\mathcal{N}}(2, 1)')
('6.0.0.1', '\\eta_i \\sim {\\mathcal{N}}(0, 0.1^2)')
('6.0.0.1', '\\phi_i \\sim {\\mathcal{N}}(0, 0.2^2)')
('6.0.0.1', '\\{(\\log(p_T), \\eta, \\phi)_i\\}_{i=1}^N')
('6.0.0.1', 'N_L')
('6.0.0.1', 'd_{\\rm model}')
('6.0.0.1', '\\epsilon = 0.005')
('6.0.0.1', '\\beta_1=0.0, \\beta_2=0.999')
('6.0.0.1', '\\gamma = 0.98')
('7.0', 'p_T')
('7.0', 'M')
('7.0', 'p_T')
('7.0', '10^{-4}')
('7.0', 'M')
('7.0', '10^{-4}')
('7.1', '\\log p(y | {\\mathbf{x}})')
('7.1', '\\kappa')
('7.1', '\\log p({\\mathbf{x}}, y) = \\log p({\\mathbf{x}}) + \\kappa \\log p(y | {\\mathbf{x}})\\, .\n    \\label{eq:ebm-clf-kappa}')
('7.1', '\\kappa')
('7.1', '\\kappa=1.0')
('7.1', '\\kappa=0.5')
('7.1', '\\kappa=0.1')
('7.2', '(\\eta, \\phi)')
('7.2', '\\epsilon')
('7.2', '\\epsilon')
