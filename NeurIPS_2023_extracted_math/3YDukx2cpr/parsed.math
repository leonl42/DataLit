('2', 'f({\\bm{a}}): \\mathbb{R}^{d_0} \\rightarrow \\mathbb{R}^{d_1}')
('2', 'D_{{\\bm{a}}}^k f[{\\bm{a}}_0] \\in \\mathbb{R}^{d_0 \\times d_1}')
('2', 'k')
('2', 'f')
('2', '{\\bm{a}}')
('2', '{\\bm{a}}_0')
('2', 'f \\circ g')
('2', 'f')
('2', 'g')
('2', '\\bigodot')
('2', '{\\bm{a}}^{\\bigodot 2 } \\overset{\\Delta}{=} {\\bm{a}}\\bigodot {\\bm{a}}')
('2', '\\bigoplus')
('2', '\\bigoplus_{j \\le J} {\\bm{a}}_j')
('2', '\\{ {\\bm{a}}_j \\}_{j \\le J}')
('2', 'j')
('2', 'J')
('2', 'j')
('2', '\\bigoplus')
('2', '{\\bm{a}}_i \\bigoplus {\\bm{b}}_j')
('2', '\\{ {\\bm{a}}_i \\}')
('2', '\\{ {\\bm{b}}_j \\}')
('2', '\\bigoplus')
('2', '{\\mathcal{G}}= \\{ {\\mathcal{V}}, {\\mathcal{E}}\\}')
('2', '{\\mathcal{V}}= \\{ v_1, ..., v_m \\}')
('2', '{\\mathcal{E}}\\subseteq {\\mathcal{V}}\\times {\\mathcal{V}}')
('2', '\\mathcal{D} = \\{({\\mathcal{G}}^{(i)}, y^{(i)}) \\}_{i\\le n}')
('2', 'n')
('2', 'y^{(i)}')
('2', '{\\mathcal{G}}^{(i)}')
('2', 'F')
('2', '{\\mathcal{G}}^{(i)}')
('2', '{\\bm{h}}^{(i)} \\in \\mathbb{R}^{d_h}')
('2', "F'")
('2', '{\\bm{h}}^{(i)}')
('2', "\\widehat{y}^{(i)} = (F' \\circ F)({\\mathcal{G}}^{(i)})")
('2', "\\mathcal{L}((F' \\circ F)({\\mathcal{G}}^{(i)}), y^{(i)})")
('2', '~\\mathcal{T} : \\mathcal{K} \\rightarrow \\mathbb{R}^{d_h}')
('2', '\\mathcal{K} \\subset \\mathbb{Z} \\times \\mathbb{Z}')
('2', 'i \\le n')
('2', 'j \\le J')
('2', '\\Tilde{{\\bm{h}}}_j^{(i)} = \\mathcal{T}(i, j)')
('2', '{\\mathcal{G}}_j^{(i)}')
('2', 'F')
('3.0', '\\mathcal{D}_\\text{train} = \\{ ({\\mathcal{G}}^{(i)}, y^{(i)}) \\}_{i=1}^n')
('3.0', "\\begin{aligned}\n\\nabla_\\theta \\sum_{({\\mathcal{G}}^{(i)}, y^{(i)}) \\in {\\mathcal{B}}} \\mathcal{L}((F' \\circ F)({\\mathcal{G}}^{(i)}), y^{(i)})\n\\end{aligned}")
('3.0', '\\theta')
('3.0', "F' \\circ F")
('3.0', '{\\mathcal{B}}')
('3.0', '| \\mathcal{V}^{(i)} |')
('3.0', '\\begin{aligned}\n    {\\mathcal{G}}^{(i)} \\approx  \\bigoplus {\\mathcal{G}}^{(i)}_j \\textrm{ \\ \\  \\ \\  for } j \\in \\{1, 2, \\dots, J^{(i)} \\}\n\\end{aligned}')
('3.0', '\\mathcal{D}_\\text{train} = \\{ ( \\bigoplus_{j \\le J^{(i)}} {\\mathcal{G}}^{(i)}_j, y^{(i)}) \\}_{i=1}^n')
('3.0', 'J^{(i)}')
('3.0', '| \\mathcal{V}_j^{(i)} | < m_{\\text{GST}}, \\forall (i,j)')
('3.0', '{\\mathcal{G}}_j^{(i)}')
('3.0', '{\\bm{h}}_j^{(i)} = F({\\mathcal{G}}_j^{(i)})')
('3.0', "F'")
('3.0', '{\\bm{h}}^{(i)} = \\bigoplus {\\bm{h}}_j^{(i)}')
('3.0', "F'")
('3.0', "\\widehat{y}^{(i)} = F' (\\bigoplus {\\bm{h}}_j^{(i)})")
('3.0', '\\{ {\\mathcal{G}}_j^{(i)} \\}_{j \\in J^{(i)}}')
('3.0', '\\mathcal{S}^{(i)} \\subseteq \\{1, \\dots, J^{(i)}\\}')
('3.0', '{\\bm{h}}_s')
('3.0', '\\bar{{\\bm{h}}}_j')
('3.0', '{\\bm{h}}^{(i)} \\approx \\{{\\bm{h}}_s^{(i)}\\}_{s \\in \\mathcal{S}^{(i)}} \\bigoplus \\{\\bar{{\\bm{h}}}_j^{(i)} \\}_{j \\notin \\mathcal{S}^{(i)}} \\triangleq {\\bm{h}}_s^{(i)} \\bigoplus \\bar{{\\bm{h}}}_j^{(i)}')
('3.0', '\\mathcal{D}_\\text{train} = \\{ ( \\bigoplus {\\mathcal{G}}^{(i)}_j, y^{(i)}) \\}_{i=1}^n')
('3.0', 'F')
('3.0', "F'")
('3.0', '\\mathcal{B} \\leftarrow \\text{SampleMiniBatch}( \\mathcal{D}_{\\text{train}})')
('3.0', '\\{{\\mathcal{G}}_s^{(i)}\\}_{s \\in \\mathcal{S}^{(i)}} \\leftarrow \\text{SampleGraphSegments}({\\mathcal{G}}^{(i)})')
('3.0', '\\bar{{\\bm{h}}}_j^{(i)} \\leftarrow \\text{ProduceEmbedding}({\\mathcal{G}}_j^{(i)}) \\text{ for } j \\notin \\mathcal{S}^{(i)}')
('3.0', '{\\bm{h}}_s^{(i)} \\leftarrow F({\\mathcal{G}}_s^{(i)})')
('3.0', 's \\in \\mathcal{S}^{(i)}')
('3.0', "\\text{SGD on loss} \\leftarrow \\frac{1}{| \\mathcal{B} |} \\sum_{i} \\mathcal{L}\\left(F'({\\bm{h}}_s^{(i)} {\\bigoplus} \\bar{{\\bm{h}}}_j^{(i)} ), \\widehat{y}^{(i)} \\right)")
('3.0', '\\text{ProduceEmbedding}(\\cdot)')
('3.0', 'F')
('3.0', '\\{ {\\mathcal{G}}_j^{(i)} \\}_{j \\notin \\mathcal{S}^{(i)}}')
('3.1', '\\bar{{\\bm{h}}}_j')
('3.1', '\\{{\\mathcal{G}}^{(i)}_j \\}_{j \\notin \\mathcal{S}^{(i)}}')
('3.1', '\\Tilde{{\\bm{h}}}_j^{(i)} = \\mathcal{T}(i,j)')
('3.1', '\\mathcal{T}')
('3.1', '\\text{ProduceEmbedding}(\\cdot)')
('3.1', "\\mathcal{L}(F'({\\bm{h}}_s^{(i)} {\\bigoplus}\\Tilde{{\\bm{h}}}_j^{(i)}), y^{(i)} )")
('3.1', '{\\mathcal{G}}^{(i)}_j')
('3.1', '{\\mathcal{G}}^{(i)}_j')
('3.1', '{\\mathcal{G}}^{(i)}_s')
('3.1', '\\mathcal{T}')
('3.1', '\\mathcal{T}')
('3.1', '\\Tilde{{\\bm{h}}}_j^{(i)}')
('3.1', 'F')
('3.2', "F'")
('3.2', '\\mathcal{P}_{\\text{train}}({\\bm{h}}, y) = \\mathcal{P}({\\bm{h}}_s {\\bigoplus} \\Tilde{{\\bm{h}}}_j, y)')
('3.2', '\\mathcal{P}_{\\text{test}}({\\bm{h}}, y) =\\mathcal{P}(\\bigoplus {\\bm{h}}_j, y)')
('3.2', "\\begin{aligned}\n    &\\mathop{\\mathrm{arg\\,min}}_{\\theta} \\mathbb{E}_{({\\bm{h}},y)\\sim \\mathcal{P}({\\bm{h}}_s {\\bigoplus} \\Tilde{{\\bm{h}}}_j, y)} \\mathcal{L}(F'({\\bm{h}}), y) \n    \\neq\n    \\mathop{\\mathrm{arg\\,min}}_{\\theta} \\mathbb{E}_{({\\bm{h}},y)\\sim \\mathcal{P}(\\bigoplus {\\bm{h}}_j, y)} \\mathcal{L}(F'({\\bm{h}}), y)\n\\end{aligned}")
('3.2', '{\\bm{h}}_j^{(i)}')
('3.2', '\\mathcal{T}')
('3.2', 'F')
('3.2', "F'")
('3.2', '\\mathcal{T}')
('3.2', "F'")
('3.3', "F'")
('3.3', 'F')
('3.3', '\\| \\Tilde{{\\bm{h}}}_j^{(i)} - \\bar{{\\bm{h}}}_j^{(i)} \\| \\le \\epsilon, \\forall (i, j)')
('3.3', "(F' \\circ F) (\\cdot)")
('3.3', 'k')
('3.3', "\\| \\nabla F'(\\Tilde{{\\bm{h}}}_j^{(i)}) - \\nabla F'(\\bar{{\\bm{h}}}_j^{(i)}) \\| \\le k' \\cdot \\epsilon")
('3.3', '\\Tilde{{\\bm{h}}}_j^{(i)}')
('3.3', '\\mathcal{T}')
('3.3', '{\\mathcal{G}}^{(i)}')
('3.3', '\\mathcal{D}_\\text{train}')
('3.3', '{\\mathcal{G}}^{(i)} \\approx \\bigoplus {\\mathcal{G}}^{(i)}_j')
('3.3', '{\\mathcal{G}}^{(i)}_s')
('3.3', '\\mathcal{T}')
('3.3', '{\\mathcal{G}}^{(i)}')
('3.3', 'n')
('3.3', 'n')
('3.3', 'nJ^{(i)}/S^{(i)}')
('3.3', 'S^{(i)}')
('3.3', '|\\mathcal{S}^{(i)}|')
('3.3', 'p')
('3.3', '\\eta')
('3.3', '\\begin{aligned}\n\\label{eq:SED}\n    \\eta^{(i)} =\n    \\begin{cases}\n     p + (1-p)\\frac{J^{(i)}}{S^{(i)}}& \\text{for } {\\mathcal{G}}^{(i)}_s \\\\\n      0 & \\text{for } {\\mathcal{G}}^{(i)}_j \\text{, with prob. } (1-p) \\\\\n      1  &  \\text{for } {\\mathcal{G}}^{(i)}_j \\text{, with prob. } p \\\\\n    \\end{cases}       \n\\end{aligned}')
('4', "\\mathcal{L}(F'({\\bm{h}}_s^{(i)} {\\bigoplus}\\Tilde{{\\bm{h}}}_j^{(i)}))")
('4', "\\mathcal{L}(F'(\\bigoplus{\\bm{h}}_j^{(i)}))")
('4', '{\\mathcal{G}}^{(i)}')
('4', 'J^{(i)}')
('4', 'S^{(i)}')
('4', '\\delta^{(i)} \\triangleq  {\\bm{h}}_s^{(i)}{\\bigoplus}\\Tilde{{\\bm{h}}}_j^{(i)} - \\bigoplus{\\bm{h}}_j^{(i)}')
('4', '\\delta^{(i)}=0')
('4', "\\begin{aligned}\n\\label{eq:taylor}\n&\\mathbb{E}_s \\mathcal{L}(F'({\\bm{h}}_s^{(i)} {\\bigoplus}\\Tilde{{\\bm{h}}}_j^{(i)})) -  \\mathcal{L}(F'({\\bigoplus}{\\bm{h}}_j^{(i)})) \\\\\n=&  \\mathbb{E}_s \\mathcal{L}( F'({\\bigoplus}{\\bm{h}}_j^{(i)} + \\delta^{(i)}) ) -  \\mathcal{L}(F'({\\bigoplus}{\\bm{h}}_j^{(i)}))   \\nonumber \\\\\n\\approx & \\sum_j \\mathbb{E}_{\\delta_j^{(i)}} \\underbrace{D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}]\\delta_j^{(i)}}_{B} +  \\underbrace{\\frac{1}{2} {\\delta_j^{(i)}}^\\top (D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}]) \\delta_j^{(i)}}_{R} \\nonumber\n\\end{aligned}")
('4', '\\delta^{(i)}')
('4', '\\begin{aligned}\n    \\mathbb{E}_{\\delta_j^{(i)^\\textrm{ET}}}[B] &= C \\times \\frac{J^{(i)}-S^{(i)}}{J^{(i)}} \\mathbb{E}(\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)} ) \\\\\n    \\mathbb{E}_{\\delta_j^{(i)^\\textrm{SED}}}[B] &= C \\times  \\frac{J^{(i)}-S^{(i)}}{J^{(i)}} \\mathbb{E}(\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)} ) p\n\\end{aligned}')
('4', 'C')
('4', 'p')
('4', 'p')
('4', '\\mathbb{E} (\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)})')
('4', 'p')
('4', 'p=1')
('4', '\\mathbb{E}_{\\delta^{(i)^\\textrm{SED}}_j}[B]')
('4', '\\mathbb{E}_{\\delta^{(i)^\\textrm{SED}}_j}[R]')
('4', 'p=0')
('4', 'S^{(i)}')
('4', 'S^{(i)}=1')
('4', '\\mathbb{E}_{\\delta^{(i)^\\textrm{SED}}_j}[B] = 0')
('4', '\\mathbb{E}_{\\delta^{(i)^\\textrm{SED}}_j}[R]')
('5.0', '{\\mathcal{G}}^{(i)}')
('5.0', '{\\mathcal{G}}^{(i)} \\approx  \\bigoplus {\\mathcal{G}}^{(i)}_j')
('5.0', '{\\mathcal{G}}^{(i)}_j')
('5.0', '\\text{ProduceEmedding}(\\cdot)')
('5.0', 'F')
('5.0', '\\{ {\\mathcal{G}}_j^{(i)} \\}_{j \\notin \\mathcal{S^{(i)}}}')
('5.0', 'S^{(i)} = 1')
('5.0', '\\Tilde{{\\bm{h}}}_j^{(i)} = \\mathcal{T}(i,j)')
('5.0', '\\mathcal{T}')
('5.0', '\\mathcal{T}')
('5.0', "F'")
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\bar{{\\bm{h}}}_j^{(i)}')
('5.2', '\\begin{aligned}\n    \\text{OPA}(y, \\widehat{y}) = \\frac{\\sum_i \\sum_j \\mathbb{I}[\\widehat{y}_i > \\widehat{y}_j] \\cdot \\mathbb{I}[y_i > y_j] }{\\sum_i \\sum_j \\mathbb{I}[y_i > y_j]}\n\\end{aligned}')
('5.2', 'F')
('5.2', "F'")
('5.2', "F'")
('5.3', 'p')
('5.3', 'p=1')
('5.3', 'p=0')
('5.3', 'p=0.5')
('5.4', '\\mathcal{T}')
('9', 'W \\cdot \\Tilde{{\\bm{h}}}_j^{(i)}  \\approx 0')
('9', 'W \\cdot {\\bm{h}}_j^{(i)}  \\approx 0')
('9', 'W')
('9', "F'")
('9', 'p')
('9', 'p')
('9', '\\delta^{(i)} \\triangleq  {\\bm{h}}_s^{(i)}{\\bigoplus}\\Tilde{{\\bm{h}}}_j^{(i)} - {\\bigoplus}{\\bm{h}}_j^{(i)}')
('9', '\\begin{aligned}\n    \\delta_j^{(i)^\\textrm{ET}} =\\begin{cases}\n      0 & \\text{with prob. } \\frac{S^{(i)}}{J^{(i)}} \\\\\n      \\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)}  & \\text{with prob. } \\frac{J^{(i)}-S^{(i)}}{J^{(i)}} \\\\\n    \\end{cases}       \n\\end{aligned}')
('9', '{\\mathcal{G}}_j^{(i)}')
('9', '\\frac{S^{(i)}}{J^{(i)}}')
('9', '{\\mathcal{G}}^{(i)}')
('9', 'S^{(i)}')
('9', '\\Tilde{{\\bm{h}}}_j^{(i)}')
('9', '\\delta_j^{(i)}')
('9', '\\begin{aligned}\n    \\delta_j^{(i)^\\textrm{SED}} =\n    \\begin{cases}\n      \\frac{(1 - p)(J^{(i)}-S^{(i)})}{S^{(i)}} {\\bm{h}}^{(i)}_j & \\text{with prob. } \\frac{S^{(i)}}{J^{(i)}} \\\\\n      - {\\bm{h}}_j^{(i)} &  \\text{with prob. } \\frac{(1 - p) (J^{(i)}-S^{(i)})}{J^{(i)}} \\\\\n      \\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)}  & \\text{with prob. } \\frac{p(J^{(i)}-S^{(i)})}{J^{(i)}}  \\\\\n    \\end{cases}       \n\\end{aligned}')
('9', '\\delta_j^{(i)}=0')
('9', 'W \\cdot \\Tilde{{\\bm{h}}}_j^{(i)}  \\approx 0')
('9', 'W \\cdot {\\bm{h}}_j^{(i)}  \\approx 0')
('9', '\\delta^{(i)}')
('9', "\\begin{aligned}\n    & \\mathcal{L}(F'({\\bm{h}}_s^{(i)} {\\bigoplus} \\tilde{{\\bm{h}}}_j^{(i)})) - \\mathcal{L}(F'({\\bigoplus} {\\bm{h}}_j^{(i)})) \\\\\n    =& \\mathcal{L}(F'({\\bigoplus} ({\\bm{h}}_j^{(i)}+\\delta_j^{(i)}))) - \\mathcal{L}(F'({\\bigoplus} {\\bm{h}}_j^{(i)})) \\\\\n    \\approx& \\sum_j D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}]\\delta_j^{(i)} + \\frac{1}{2} {\\delta^{(i)}_j}^\\top (D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}]) \\delta_j^{(i)}\n\\end{aligned}")
('9', 's')
('9', "\\begin{aligned}\n\\label{eq:taylor_sup}\n&\\mathbb{E}_s \\mathcal{L}(F'({\\bm{h}}_s^{(i)} {\\bigoplus}\\Tilde{{\\bm{h}}}_j^{(i)})) -  \\mathcal{L}(F'({\\bigoplus}{\\bm{h}}_j^{(i)}))  \\\\\n\\approx & \\sum_j \\mathbb{E}_{\\delta_j^{(i)}} \\underbrace{D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}]\\delta_j^{(i)}}_{B} +  \\underbrace{\\frac{1}{2} {\\delta_j^{(i)}}^\\top (D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}]) \\delta_j^{(i)}}_{R} \\nonumber\n\\end{aligned}")
('9', '\\delta_j^{(i)}')
('9', "\\begin{aligned}\n    \\mathbb{E}_{\\delta_j^{(i)^\\textrm{ET}}}[B] &= \\langle D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], \\mathbb{E} \\delta_j^{(i)} \\rangle\\\\\n    &=\\langle D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], \\frac{J^{(i)}-S^{(i)}}{J^{(i)}} \\mathbb{E}(\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)} ) \\rangle\\\\\n    \\mathbb{E}_{\\delta_j^{(i)^\\textrm{SED}}}[B] &= \\langle D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], \\mathbb{E} \\delta_j^{(i)} \\rangle\\\\\n    &= \\langle D_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}],  \\frac{J^{(i)}-S^{(i)}}{J^{(i)}} \\mathbb{E}(\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)} ) * p \\rangle\n\\end{aligned}")
('9', "\\begin{aligned}\n    \\mathbb{E}_{\\delta_j^{(i)^\\textrm{ET}}}[R] =& \\langle   D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], \\frac{\\mathbb{E} \\delta_j^{(i)} \\delta_j^{{(i)}^\\top}}{2}\\rangle \\\\\n    =& \\langle D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], \\frac{J^{(i)}-S^{(i)}}{2J^{(i)}} (\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)})^{\\bigodot 2} \\rangle\\\\\n    \\mathbb{E}_{\\delta_j^{(i)^\\textrm{SED}}}[R] &= \\langle   D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], \\frac{\\mathbb{E} \\delta_j^{(i)} \\delta_j^{{(i)}^\\top}}{2}\\rangle \\\\\n    =& \\langle D^2_{{\\bm{h}}_j^{(i)}} (\\mathcal{L} \\circ F')[{\\bm{h}}_j^{(i)}], (\\frac{(J^{(i)}-S^{(i)})p}{2J^{(i)}} (\\tilde{{\\bm{h}}}_j^{(i)} - {\\bm{h}}_j^{(i)})^{\\bigodot 2} \\\\\n    &+ \\frac{(J^{(i)}-S^{(i)})(1-p)(J^{(i)}-pJ^{(i)}+pS^{(i)})}{2J^{(i)}S^{(i)}} {{\\bm{h}}_j^{(i)}}^{\\bigodot 2}) \\rangle\n\\end{aligned}")
('10.0', '\\mathcal{D}_\\text{train} = \\{ ( \\bigoplus {\\mathcal{G}}^{(i)}_j, y^{(i)}) \\}_{i=1}^n')
('10.0', 'F')
('10.0', "F'")
('10.0', '\\mathcal{T}')
('10.0', '\\mathcal{B} \\leftarrow \\text{SampleMiniBatch}( \\mathcal{D}_{\\text{train}})')
('10.0', '\\{{\\mathcal{G}}_s^{(i)}\\}_{s \\in \\mathcal{S}^{(i)}} \\leftarrow \\text{SampleGraphSegments}({\\mathcal{G}}^{(i)})')
('10.0', '\\Tilde{{\\bm{h}}}_j^{(i)} \\leftarrow \\mathcal{T}.\\text{LookUp}\\left((i, j)\\right) \\textbf{ for } j \\notin \\mathcal{S}^{(i)}')
('10.0', '{\\bm{h}}_s^{(i)} \\leftarrow F({\\mathcal{G}}_s^{(i)})')
('10.0', 's \\in \\mathcal{S}^{(i)}')
('10.0', '\\mathcal{T} .\\text{InsertOrUpdate}((i, s), {\\bm{h}}_s^{(i)} )')
('10.0', "\\text{SGD on } \\frac{1}{|\\mathcal{B} |} \\sum_{i} \\mathcal{L}\\left(F'( \\eta_s^{(i)} \\cdot {\\bm{h}}_s^{(i)}{\\bigoplus}( \\eta_j^{(i)} \\cdot \\Tilde{{\\bm{h}}}_j^{(i)} ), y^{(i)} \\right)")
('10.0', '\\mathcal{T}.\\text{InsertOrUpdate}((i, j), F({\\mathcal{G}}_j^{(i)}) ) \\text{ for every } {\\mathcal{G}}_j^{(i)}')
('10.0', '\\bar{{\\bm{h}}}_j^{(i)} \\leftarrow \\mathcal{T}.\\text{LookUp}\\left((i, j)\\right) \\textbf{ for } j \\le J^{(i)}')
('10.0', "\\text{SGD with loss} \\leftarrow \\frac{1}{|\\mathcal{B} |} \\sum_{i} \\mathcal{L}\\left(F'( \\bigoplus \\bar{{\\bm{h}}}_j^{(i)} ) \\right)")
('10.0', 'p=0.5')
('10.0', 'p=0.5')
('10.0', '\\begin{aligned}\n    \\mathcal{L}(\\widehat{y}_1, \\widehat{y}_2) = \\sum_i \\sum_j \\mathbb{I}[y_i > y_j] \\cdot \\max(0, 1 - (\\widehat{y}_i - \\widehat{y}_j))\n\\end{aligned}')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
