('1.0.0.0', 'B')
('1.0.0.0', 'B')
('1.0.0.0', 'B')
('1.1', 'n^{1/3}')
('1.1', 'n^{-2/3}')
('1.1', 'n')
('1.1', '\\varepsilon')
('1.1', '\\Omega(\\varepsilon^{-1})')
('1.1', '\\Omega(\\varepsilon^{-3/2})')
('2.0', '\\mathbb{N}')
('2.0', '\\mathbb{R}')
('2.0', 'n\\in\\mathbb{N}')
('2.0', '[n]:=\\{1,\\dots,n\\}')
('2.0', 'x\\in\\mathbb{R}')
('2.0', '\\lfloor x \\rfloor = \\max\\{m\\in \\mathbb {Z}: m\\leq x\\}')
('2.0', '\\mathcal{S}= \\{ s_i: i \\in [n] \\} \\subset \\mathbb{R}')
('2.0', 'k \\in [n]')
('2.0', 's_{(k)}')
('2.0', 'k')
('2.0', 'k')
('2.0', '\\mathcal{S}')
('2.0', '(\\Omega, \\mathcal{E}, P)')
('2.0', 'A \\in \\mathcal{E}')
('2.0', '\\mathds{1}_A: \\Omega \\to \\{0,1\\}')
('2.0', '\\mathds{1}_A(x) = 1')
('2.0', 'x \\in A')
('2.0', 'A')
('2.0', 'P')
('2.0', 'P(A) = 1')
('2.0', 'P')
('2.0', '\\mathbb{E}_P')
('2.0', 'P')
('2.0', 'P')
('2.0', 'X: \\Omega \\to \\mathbb{R}^d')
('2.0', 'P_X:=P\\circ X^{-1}')
('2.0', 'X')
('2.0', 'f, g:\\mathbb{R}\\to \\mathbb{R}')
('2.0', 'f(x) = O(g(x))')
('2.0', 'x\\to\\infty')
('2.0', 'M>0')
('2.0', 'x_0 > 0')
('2.0', '\\left| f(x) \\right| \\leq M g(x)')
('2.0', 'x\\geq x_0')
('2.0', 'f(x) = \\Omega(g(x))')
('2.0', 'g(x) = O(f(x))')
('2.1', '\\mathcal{X}\\subset \\mathbb{R}^d')
('2.1', '\\mathcal{Y}= \\{0,1\\}')
('2.1', 'P')
('2.1', 'f: \\mathcal{X}\\to \\mathcal{Z}= [0,1]')
('2.1', '\\label{eqn:ideal}\n    f(X) \\approx P[ Y=1 \\mid X ].')
('2.1', 'X')
('2.1', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('2.1', 'P')
('2.1', 'f(X) = P\\left[Y=1 \\mid f(X) \\right]     \\quad \\textrm{ $P$-almost surely.}')
('2.1', 'f(X) = \\mathbb{E}Y')
('2.1', 'Y')
('2.1', 'f(X)')
('2.1', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('2.1', 'P')
('2.1', '\\mathrm{Var}\\big( \\mathbb{E}[Y\\mid f(X)] \\big) = \\mathbb{E}\\Big[ \\big( \\mathbb{E}[Y\\mid f(X)] - \\mathbb{E}[Y] \\big)^2 \\Big].')
('2.1', 'f')
('2.1', '\\mathrm{Var}[ Y ]')
('2.1', 'f')
('2.1', '\\mathrm{MSE}(f) := \\underbrace{\\mathbb{E}\\big[ \\big( Y - f(X) \\big)^2 \\big]}_{\\textrm{mean-squared error}}\n        = \\mathrm{Var}[ Y ] - \\underbrace{\\mathrm{Var}\\left( \\mathbb{E}\\big[Y\\mid f(X)\\big] \\right)}_{\\textrm{sharpness}} + \\underbrace{\\mathbb{E}\\big[ \\big( f(X) - \\mathbb{E}[Y\\mid f(X)] \\big)^2 \\big]}_{\\textrm{lack of calibration}}')
('3', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('3', 'h:\\mathcal{Z}\\to\\mathcal{Z}')
('3', 'h\\circ f')
('3', 'f')
('3', 'f')
('3', 'P')
('3', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('3', 'h: \\mathcal{Z}\\to \\mathcal{Z}')
('3', 'h')
('3', 'f')
('3', 'P')
('3', '\\label{eqn:loss_rel}\n        R^{\\mathrm{cal}}(h) = R^{\\mathrm{cal}}_P(h; f) := \\mathbb{E}_P \\left[ \\big( h \\circ f(X) - \\mathbb{E}_P \\left[ Y \\mid h \\circ f(X) \\right] \\big)^2 \\right].')
('3', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('3', 'h: \\mathcal{Z}\\to \\mathcal{Z}')
('3', 'h')
('3', 'f')
('3', 'P')
('3', '\\label{eqn:loss_grp}\n        R^{\\mathrm{sha}}(h) = R^{\\mathrm{sha}}_P(h; f) := \\mathbb{E}_P \\left[ \\big( \\mathbb{E}_P \\left[ Y \\mid h \\circ f(X) \\right] - \\mathbb{E}_P \\left[ Y \\mid f(X) \\right] \\big)^2 \\right].')
('3', 'R^{\\mathrm{cal}}(h; f) = 0')
('3', 'h \\circ f')
('3', 'R^{\\mathrm{sha}}(h; f)')
('3', 'f')
('3', 'h')
('3', 'R^{\\mathrm{sha}}(h; f)=0')
('3', 'h')
('3', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('3', 'h: \\mathcal{Z}\\to \\mathcal{Z}')
('3', 'h')
('3', 'f')
('3', 'P')
('3', 'R(h) = R_P(h; f) := \\mathbb{E}_P \\left[(h\\circ f(X) - \\mathbb{E}_P[Y \\mid f(X)])^2 \\right]. \\label{eqn:risk_recalib}')
('3', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('3', 'h: \\mathcal{Z}\\to \\mathcal{Z}')
('3', '\\begin{aligned}\n        R_P(h; f) = R^{\\mathrm{cal}}_P(h; f) + R^{\\mathrm{sha}}_P(h; f).\n    \n\\end{aligned}')
('3', 'R_P(h) = 0')
('3', 'R^{\\mathrm{cal}}_P(h) = 0')
('3', 'R^{\\mathrm{sha}}_P( h ) = 0')
('3', 'h \\circ f')
('3', 'h')
('3', 'f')
('3', 'Y')
('3', 'R(h) = 0')
('3', 'h')
('3', 'f')
('3', 'P')
('3', 'h^*_{f,P}: \\mathcal{Z}\\to \\mathcal{Z}')
('3', '\\label{eqn:optimal_h}\n    h^*_{f,P}(z) = \n        \\begin{cases}\n            \\mathbb{E}_P [Y \\mid f(X)=z],    &   \\text{if }  z \\in \\mathop{\\mathrm{supp}}P_{f(X)},\\\\\n            0,                      &   \\text{if }  z \\not\\in \\mathop{\\mathrm{supp}}P_{f(X)}.\n        \\end{cases}')
('3', 'R(h^*_{f,P}) = 0')
('3', 'h')
('3', 'f')
('3', 'h = h^*_{f,P}')
('3', 'P_Z')
('3', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('3', '\\mathcal{D}= \\big\\{ (x_i, y_i): i \\in [n] \\big\\}')
('3', 'P')
('3', '\\hat{h} \\approx h^*_{f,P}')
('3', 'f')
('3', '\\mathcal{D}')
('3', '\\mathbb{E}[Y \\mid Z]')
('3', '\\left\\{ (z_i, y_i): i \\in [n] \\right\\}')
('3', 'z_i=f(x_i)')
('3', '\\forall i \\in [n]')
('4.0', '\\{(z_i, y_i) \\in \\mathcal{Z}\\times \\mathcal{Y}: i \\in [n]\\}')
('4.0', '\\mathcal{Z}= [0,1]')
('4.0', '\\mathbb{E}[Y \\mid Z]')
('4.0', 'S = \\{z_i \\in [0,1]: i \\in [n] \\}')
('4.0', '\\mathcal{B}= \\{I_1, I_2, \\dots, I_B\\}')
('4.0', 'S')
('4.0', 'I_1 = [u_0, u_1], \\qquad \\mathrm{and} \\qquad I_b = (u_{b-1}, u_b]~~ \\forall b \\in [B] \\setminus \\{1\\},')
('4.0', 'u_0=0')
('4.0', 'u_B=1')
('4.0', 'u_b=z_{(\\left\\lfloor nb/B \\right\\rfloor)}')
('4.0', 'b \\in [B-1]')
('4.0', 'Y')
('4.0', 'Z')
('4.0', 'Z')
('4.0', 'F_Z')
('4.0', 'h^*_{f,P}')
('4.0', '\\mathop{\\mathrm{supp}}P_{Z}')
('4.0', 'K > 0')
('4.0', 'z_1 \\leq z_2')
('4.0', 'h^*_{f,P}(z_2) - h^*_{f,P}(z_1) \\leq K \\cdot \\big( F_Z(z_2) - F_Z(z_1) \\big)')
('4.0', '\\mathcal{B}')
('4.0', 'P_Z')
('4.0', 'S = \\{Z_i: i \\in [n]\\}')
('4.0', 'P_Z')
('4.0', 'Z')
('4.0', 'P[Y \\mid Z]')
('4.0', 'Z')
('4.0', 'P[Y \\mid Z=z]')
('4.0', 'I')
('4.0', 'P_Z(I)')
('4.0', '\\hat{h}')
('4.0.0', '\\{(z_i, y_i): i \\in [n]\\}')
('4.0.0', 'B \\in \\mathbb{N}')
('4.0.0', '\\mathcal{B}= \\{I_1, I_2, \\dots, I_B\\}')
('4.0.0', 'B')
('4.0.0', '\\{ z_i: i \\in [n] \\}')
('4.0.0', '\\hat{h} = \\hat{h}_{\\mathcal{B}}: \\mathcal{Z}\\to \\mathcal{Z}')
('4.0.0', '\\label{eqn:recalib_ftn}\n        \\hat{h}(z) = \\sum_{I \\in \\mathcal{B}} \\hat{\\mu}_I \\cdot \\mathds{1}_{I}(z)\n        \\quad\\text{where}\\quad\n        \\hat{\\mu}_I := \n        % \\texttt{Average}\\{y_i: z_i \\in I\\} = \n        \\frac{\\sum_{i=1}^n y_i \\cdot \\mathds{1}_{I}(z_i)}{\\sum_{i=1}^n \\mathds{1}_{I}(z_i)}, ~~\\forall I \\in \\mathcal{B}.')
('4.1', 'R(\\hat{h})')
('4.1', '\\hat{h}')
('4.1', '0')
('4.1', 'n')
('4.1', '\\infty')
('4.1', 'P')
('4.1', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('4.1', '\\mathcal{B}')
('4.1', 'f(X)')
('4.1', '\\hat{h} = \\hat{h}_{\\mathcal{B}}')
('4.1', '\\mathcal{B}')
('4.1', 'c > 0')
('4.1', '\\delta \\in (0, 1)')
('4.1', 'n \\geq c \\cdot |\\mathcal{B}| \\log \\big( \\frac{2|\\mathcal{B}|}{\\delta}\\big)')
('4.1', '1 - \\delta')
('4.1', '\\begin{aligned}\n        R^{\\mathrm{cal}}(\\hat{h}) &\\leq \n        %\\left( \\sqrt{\\frac{1}{2( \\lfloor n/|\\binsch| \\rfloor - 1)} \\log \\left(\\frac{4 |\\binsch|}{\\delta}\\right) } + \\frac{1}{\\lfloor n/|\\binsch| \\rfloor} \\right)^2%,\\\\\n        \\left( \\sqrt{\\frac{\\log \\left(4 |\\mathcal{B}| / \\delta \\right) }{2( \\lfloor n/|\\mathcal{B}| \\rfloor - 1)} } + \\frac{1}{\\lfloor n/|\\mathcal{B}| \\rfloor} \\right)^2%,\\\\\n        , \\quad\\text{and}\\quad\n        R^{\\mathrm{sha}}(\\hat{h}) \\leq  \\begin{cases}\\frac{2}{|\\mathcal{B}|},\\\\ \\frac{8 K^2}{|\\mathcal{B}|^2} & \\text{if \\ref{assump:smooth} holds.} \\end{cases}\n    \n\\end{aligned}')
('4.1', 'R^{\\mathrm{cal}}(\\hat{h})')
('4.1', 'R^{\\mathrm{sha}}(\\hat{h})')
('4.1', 'R(\\hat{h})')
('4.1.0', 'n')
('4.1.0', 'B = |\\mathcal{B}|')
('4.1.0', 'B')
('4.1.0', 'R(\\hat{h}) = R^{\\mathrm{cal}}(\\hat{h}) + R^{\\mathrm{sha}}(\\hat{h})')
('4.1.0', 'n')
('4.1.0', 'B')
('4.1.0', 'n/B \\geq 2')
('4.1.0', 'n/B - 1 \\geq n/(2B)')
('4.1.0', 'B \\geq 1')
('4.1.0', '\\delta < 1')
('4.1.0', '\\log(\\frac{4B}{\\delta}) \\geq 1')
('4.1.0', '\\frac{1}{ n/B} \\leq \\sqrt{\\frac{1}{2(  n/B - 1)} \\log \\left(\\frac{4 B}{\\delta}\\right) } \\leq \\sqrt{\\frac{1}{n/B} \\log \\left(\\frac{4 B}{\\delta}\\right) }')
('4.1.0', 'R(\\hat{h}) \\leq \\zeta(B; n, \\delta)')
('4.1.0', '\\zeta(B; n, \\delta) := \\frac{4B}{n} \\log \\left(\\frac{4 B}{\\delta}\\right) + \\frac{8 K^2}{B^2}')
('4.1.0', '\\log B')
('4.1.0', '\\zeta(B; n, \\delta)')
('4.1.0', 'B')
('4.1.0', 'B^*')
('4.1.0', '\\begin{aligned}\n % B^* ~ K^{2/3} \\cdot \n    &B^* \\asymp n^{1/3} \\cdot \\log^{-1/3} (1/\\delta), \\\\\n    &R(\\hat{h}) \\asymp R^{\\mathrm{cal}}(\\hat{h}) \\asymp R^{\\mathrm{sha}}(\\hat{h}) = O\\big( {B^*}^{-2}\\big) = O \\left( n^{-2/3} \\cdot \\log^{2/3} (1/\\delta) \\right). \\label{eqn:risk_asymptotic}\n\\end{aligned}')
('4.1.0', 'R(\\hat{h})')
('4.1.0', 'R^{\\mathrm{cal}}(\\hat{h})')
('4.1.0', 'R^{\\mathrm{sha}}(\\hat{h})')
('4.1.0', '\\varepsilon')
('4.1.0', '\\begin{aligned}\n    n = \\Omega(\\varepsilon^{-3/2}) \\label{eqn:complexity}.\n\\end{aligned}')
('4.1.0.0', 'g')
('4.1.0.0', '\\mathcal{G}')
('4.1.0.0', 'g')
('4.1.0.0', 'h^*_{f,P}')
('4.1.0.0', '\\mathcal{G}')
('4.1.0.0', '\\mathcal{G}')
('4.1.0.0', 'h^*_{f,P}\\in \\mathcal{G}')
('4.1.0.0', 'O\\left(\\frac{1}{n}\\log\\frac{B}{\\delta} + \\frac{1}{B}\\right)')
('4.1.0.0', '\\tilde{O}(n^{-1})')
('4.1.0.0', 'B^* \\asymp n')
('4.1.0.0', 'R(\\hat{h}) = O(n^{-2/3})')
('4.1.0.0', '\\mathcal{G}')
('4.1.0.0', 'h^*_{f,P}\\notin \\mathcal{G}')
('4.1.0.1', '\\mathcal{B}=\\{I_b\\}_{b=1}^B')
('4.1.0.1', 'n')
('4.1.0.1', '\\mathcal{B}')
('4.1.0.1', '2')
('4.1.0.1', 'f(X)')
('4.1.0.1', 'B')
('4.1.0.1', '\\mathcal{B}')
('4.1.0.1', 'Y')
('4.1.0.1', 'f(X)')
('4.1.0.1', '\\mathcal{B}')
('4.1.0.1', 'R^{\\mathrm{cal}}')
('4.1.0.1', 'R^{\\mathrm{sha}}')
('5.0', 'P')
('5.0', 'Q')
('5.0', 'P')
('5.0', 'Q')
('5.0', 'P')
('5.0', 'Q')
('5.0', 'P[X\\in B \\mid Y=k] = Q[X\\in B \\mid Y=k]')
('5.0', 'k \\in \\{0, 1\\}')
('5.0', 'B \\in \\mathcal{B}(\\mathcal{X})')
('5.0', 'P[Y=1] \\in (0,1)')
('5.0', 'Q[Y=1] \\in (0,1)')
('5.0.0', 'P')
('5.0.0', 'Q')
('5.0.0', 'g^*: \\mathcal{Z}\\to \\mathcal{Z}')
('5.0.0', '\\label{eqn:optimal_g}\n    g^*(z) = \\frac{w^*_1 z}{ w^*_1 z + w^*_0 (1-z)}\n    \\qquad\\text{where}\\qquad\n    w^*_k = \\frac{Q[Y=k]}{P[Y=k]}, ~~\\forall k \\in \\{0,1\\}.')
('5.0.0', 'P')
('5.0.0', 'Q')
('5.0.0', '\\label{eqn:relation_under_shift}\n    Q[Y=1 \\mid X\\in B] = g^*\\Big( P[Y=1 \\mid X\\in B] \\Big), \\qquad \\forall B \\in \\mathcal{B}(\\mathcal{X}).')
('5.0.0', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('5.0.0', 'P')
('5.0.0', 'h^*_{f,P}(z) = P[Y = 1 \\mid f(X)=z]')
('5.0.0', 'P')
('5.0.0', 'Q')
('5.0.0', 'f')
('5.0.0', 'Q')
('5.0.0', 'h^*_{f, Q} = g^* \\circ h^*_{f,P}')
('5.0.0', 'h^*_{f, Q}(z) \n        \\stackrel{(a)}{=} Q[Y=1 \\mid f(X) = z]\n        \\stackrel{(b)}{=} g^*\\left(P[Y=1 \\mid f(X) = z]\\right)\n        \\stackrel{(c)}{=} \\left( g^* \\circ h^*_{f,P}\\right) (z),')
('5.0.0', 'h^*_{f,P}')
('5.0.0', 'R_P(h; f)')
('5.0.0', 'R_Q(h^*_{f, Q}; f) = 0')
('5.0.0', 'h^*_{f, Q} = g^* \\circ h^*_{f,P}')
('5.0.0', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('5.0.0', '\\mathcal{D}_P= (x_i, y_i)_{i=1}^{n_P} \\sim P')
('5.0.0', "\\mathcal{D}_Q= (x'_i, y'_i)_{i=1}^{n_Q} \\sim Q")
('5.0.0', '\\hat{h} \\approx h^*_{f,Q}')
('5.0.0', 'f')
('5.0.0', '\\mathcal{D}_P')
('5.0.0', '\\mathcal{D}_Q')
('5.0.0', '\\mathcal{D}_P')
('5.0.0', 'h^*_{f,P}')
('5.0.0', 'P[Y=k], ~k \\in \\{0,1\\}')
('5.0.0', 'P')
('5.1.0', 'h^*_{f, Q} = g^* \\circ h^*_{f,P}')
('5.1.0', '\\hat{g}\\approx g^*')
('5.1.0', '\\hat{h}_P \\approx h^*_{f,P}')
('5.1.0', '\\mathcal{D}_P')
('5.1.0', '\\hat{h}_P: \\mathcal{Z}\\to \\mathcal{Z}')
('5.1.0', 'f')
('5.1.0', 'P')
('5.1.0', '\\mathcal{D}_P')
('5.1.0', '\\mathcal{D}_Q')
('5.1.0', '\\hat{g}: \\mathcal{Z}\\to \\mathcal{Z}')
('5.1.0', '\\label{eqn:g_hat}\n        \\hat{g}(z) = \\frac{\\hat{w}_1 z}{ \\hat{w}_1 z + \\hat{w}_0 (1-z)}\n        \\qquad\\text{where}\\qquad\n        \\hat{w}_k = \\frac{\\hat{Q}[Y=k]}{\\hat{P}[Y=k]}, ~~\\forall k \\in \\{0,1\\},')
('5.1.0', '\\hat{P}[Y=k] := \\frac{1}{|\\mathcal{D}_P|} \\sum_{i=1}^{|\\mathcal{D}_P|} \\mathds{1}[y_i=k]')
('5.1.0', "\\hat{Q}[Y=k] := \\frac{1}{|\\mathcal{D}_Q|} \\sum_{i=1}^{|\\mathcal{D}_Q|} \\mathds{1}[y'_i=k]")
('5.1.0', '\\begin{aligned}\n        \\hat{h}_Q = \\hat{g}\\circ \\hat{h}_P. \\label{eqn:h_hat}\n    \n\\end{aligned}')
('5.1.0', '\\hat{h}_P')
('5.1.0', '\\hat{g}')
('5.1.0', 'g^*')
('5.1.0', '\\hat{w}_1')
('5.1.0', '\\hat{w}_0')
('5.1.0.0', 'p_k := P[Y=k]')
('5.1.0.0', 'q_k := Q[Y=k]')
('5.1.0.0', 'w^*_k = \\frac{q_k}{p_k}')
('5.1.0.0', 'k \\in \\{0,1\\}')
('5.1.0.0', 'p_{\\min} := \\min_{k} p_k')
('5.1.0.0', 'q_{\\min} := \\min_{k} p_k')
('5.1.0.0', 'w^*_{\\min}:= \\min_{k} w^*_k')
('5.1.0.0', 'w^*_{\\max}:= \\max_{k} w^*_k')
('5.1.0.0', 'P, Q')
('5.1.0.0', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('5.1.0.0', '\\mathcal{D}_P\\sim P')
('5.1.0.0', 'n_P')
('5.1.0.0', '\\mathcal{D}_Q\\sim Q')
('5.1.0.0', 'n_Q')
('5.1.0.0', '\\mathcal{B}')
('5.1.0.0', '\\mathcal{D}_P')
('5.1.0.0', '\\hat{h}_P = \\hat{h}_{P,\\mathcal{B}}')
('5.1.0.0', '\\mathcal{B}')
('5.1.0.0', '\\hat{g}')
('5.1.0.0', '\\label{eqn:master_shift}\n        R_Q \\big( \\hat{g} \\circ \\hat{h}_P \\big)\n            \\leq 2 \\left\\{ \\left( \\frac{ \\rho_0 - \\rho_1 }{ \\rho_0 + \\rho_1 } \\right)^2 + \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot R_P\\big( \\hat{h}_P; f \\big) \\right\\}\n            \\qquad\\text{where}\\qquad\n            \\rho_k := \\frac{\\hat{w}_k}{w^*_k}, ~~k \\in \\{0,1\\}.')
('5.1.0.0', 'c > 0')
('5.1.0.0', '\\delta \\in (0, 1)')
('5.1.0.0', 'n_P \\geq \\max\\left\\{ c, ~ \\frac{27}{p_{\\min}} \\right\\} \\cdot |\\mathcal{B}| \\log \\left( \\frac{4|\\mathcal{B}|}{\\delta} \\right)\n        \\qquad\\text{and}\\qquad\n        n_Q \\geq \\frac{27}{q_{\\min}} \\log \\left( \\frac{16}{\\delta} \\right),')
('5.1.0.0', '1 - \\delta')
('5.1.0.0', '\\label{eqn:risk_upper.A}\n    \\begin{aligned}\n        R_Q \\big( \\hat{g} \\circ \\hat{h}_P \\big)\n            &\\leq \n                2 \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot \n                \\left\\{ \\left( \\sqrt{\\frac{1}{2( \\lfloor n_P/|\\mathcal{B}| \\rfloor - 1)} \\log \\left(\\frac{8 |\\mathcal{B}|}{\\delta}\\right) } + \\frac{1}{\\lfloor n_P/|\\mathcal{B}| \\rfloor}\\right)^2 + \\frac{8K^2}{|\\mathcal{B}|^2} \\right\\}     \\\\\n            &\\qquad \n                +54 \\max \\left\\{ \\frac{1}{ p_{\\min} \\cdot n_P }, ~\\frac{1}{ q_{\\min} \\cdot n_Q }  \\right\\} \\cdot \\log \\left( \\frac{16}{\\delta} \\right) .\n    \\end{aligned}')
('5.1.0.0', '\\rho_k \\to 1')
('5.1.0.0', 'n_P, n_Q \\to \\infty')
('5.1.0.0', '2 \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot R_P\\big( \\hat{h}_P; f \\big)')
('5.1.0.0', 'P=Q')
('5.1.0.0', 'w^*_{\\min}= w^*_{\\max}= 1')
('5.1.0.0', '2')
('5.1.0.0', 'n_P \\geq n_Q')
('5.1.0.0', '|\\mathcal{B}| \\asymp n_P^{1/3}')
('5.1.0.0', 'R_Q \\big( \\hat{g} \\circ \\hat{h}_P; f \\big) = O\\big(n_P^{-2/3} + n_Q^{-1}\\big)')
('5.1.0.0', 'n_Q = \\Omega(\\varepsilon^{-1})')
('5.1.0.0', 'n_Q = \\Omega(\\varepsilon^{-3/2})')
('5.1.0.0', 'n_P')
('5.1.0.0', 'R_Q(\\hat{g} \\circ \\hat{h}_P) = O(n_Q^{-1})')
('6', '\\mathcal{D}(\\pi)')
('6', 'X')
('6', 'Y')
('6', 'Y \\sim \\textrm{Bernoulli}(\\pi)')
('6', 'X \\mid Y = 0 \\sim N(-2, 1)')
('6', 'X \\mid Y = 1 \\sim N(2, 1)')
('6', 'f(x) = \\texttt{sigmoid}(x) := 1 / (1 + e^{-x})')
('6', '\\delta = 0.1')
('6', 'n')
('6', 'B')
('6', 'R^{\\mathrm{cal}}= O(n^{-0.97}B^{0.93})')
('6', 'R^{\\mathrm{sha}}= O(B^{-1.75})')
('6', '\\tilde{O}(B/n)')
('6', 'O(B^{-2})')
('6', 'R')
('6', 'B')
('6', 'R^{\\mathrm{cal}}(\\hat{h})')
('6', 'n')
('6', 'R^{\\mathrm{cal}}(\\hat{h})')
('6', 'B')
('6', 'R^{\\mathrm{sha}}(\\hat{h})')
('6', 'B')
('6', 'R(\\hat{h})')
('6', 'B')
('6', 'B')
('6', 'n')
('6', 'n')
('6', 'B')
('6', 'B')
('6', 'B')
('6', '\\mathcal{D}(0.5)')
('6', '\\mathcal{D}(0.1)')
('6', 'n_P = 10^3')
('6', 'n_Q = 10^2')
('6', '\\hat{g}')
('6', 'R^{\\mathrm{sha}}=0')
('6', 'R^{\\mathrm{cal}}')
('6', 'B = n_P^{1/3}')
('6', '\\mathcal{D}_P')
('6', 'R^{\\mathrm{cal}}')
('6', 'B = n_Q^{1/3}')
('6', '\\mathcal{D}_Q')
('6', 'R^{\\mathrm{cal}}')
('6', 'R^{\\mathrm{sha}}')
('6', 'R^{\\mathrm{cal}}')
('6', 'R^{\\mathrm{cal}}')
('6', 'R^{\\mathrm{sha}}')
('6', 'R')
('6', '\\mathrm{MSE}')
('6', '\\hat{h}_P')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('6', '\\hat{h}_Q^{\\textrm{target}}')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('6', '\\hat{g}')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('6', '\\hat{h}_Q')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('6', '\\pm')
('8', '\\begin{aligned}\n    R^{\\mathrm{cal}}(h; f) &= \\mathbb{E}\\left[ \\big( f(X) - \\mathbb{E}\\left[ Y \\mid f(X) \\right] \\big)^2 \\right]\\\\\n    R^{\\mathrm{sha}}(h; f) &= \\mathbb{E}\\left[ \\big( \\mathbb{E}\\left[ Y \\mid h \\circ f(X) \\right] - \\mathbb{E}\\left[ Y \\mid f(X) \\right] \\big)^2 \\right].\n\\end{aligned}')
('8', 'Z=f(X)')
('8', 'Y_Z := \\mathbb{E}[ Y \\mid Z ]')
('8', 'Y_{h(Z)} = \\mathbb{E}[ Y \\mid h(Z) ]')
('8', '\\begin{aligned}\n    R(h)\n    &= \\mathbb{E}[(h(Z) - Y_Z)^2] \\\\\n    &= \\mathbb{E}[(h(Z) - Y_{h(Z)}+ Y_{h(Z)}- Y_Z)^2] \\\\\n    &= \\mathbb{E}[(h(Z) - Y_{h(Z)})^2] + \\mathbb{E}[(Y_{h(Z)}- Y_Z)^2] + 2 \\mathbb{E}[(h(Z) - Y_{h(Z)})(Y_{h(Z)}- Y_Z)] \\\\\n    &= \\mathbb{E}[(h(Z) - Y_{h(Z)})^2] + \\mathbb{E}[(Y_{h(Z)}- Y_Z)^2] + 2 \\mathbb{E}[\\mathbb{E}[(h(Z) - Y_{h(Z)})(Y_{h(Z)}- Y_Z) \\mid h(Z)]] \\\\\n    &= \\mathbb{E}[(h(Z) - Y_{h(Z)})^2] + \\mathbb{E}[(Y_{h(Z)}- Y_Z)^2] + 2 \\mathbb{E}[(h(Z) - Y_{h(Z)})(Y_{h(Z)}- \\mathbb{E}[Y_Z\\mid h(Z)])] \\\\\n    &= \\mathbb{E}[(h(Z) - Y_{h(Z)})^2] + \\mathbb{E}[(Y_{h(Z)}- Y_Z)^2] + 2 \\mathbb{E}[(h(Z) - Y_{h(Z)})(Y_{h(Z)}- Y_{h(Z)})] \\\\\n    &= \\underbrace{\\mathbb{E}[(h(Z) - Y_{h(Z)})^2]}_{R^{\\mathrm{cal}}(h)} + \\underbrace{\\mathbb{E}[(Y_{h(Z)}- Y_Z)^2]}_{R^{\\mathrm{sha}}(h)}.\n\\end{aligned}')
('9', '(Y, Z) \\in \\mathcal{Y}\\times \\mathcal{Z}')
('9', 'P_{Y,Z}')
('9', 'S = \\{(y_i, z_i) \\in \\mathcal{Y}\\times \\mathcal{Z}: i \\in [n]\\}')
('9', '\\mathcal{B}= \\{I_1, I_2, \\dots, I_B\\}')
('9', 'B')
('9', 'z_i')
('9', 'S')
('9', 'S')
('9', 'P_{Y,Z}')
('9', '\\mathcal{B}')
('9', 'S')
('9', 'B \\in \\mathbb{N}')
('9', 'Z')
('9', '[0,1]')
('9', '\\alpha \\in \\mathbb{R}')
('9', '\\alpha \\geq 1')
('9', '\\mathcal{B}')
('9', 'B')
('9', '\\frac{1}{\\alpha B} \\leq P[Z\\in I_b] \\leq \\frac{\\alpha}{B},   \\qquad \\forall b \\in [B].')
('9', '\\Phi_{\\mathrm{balance}}')
('9', '\\Phi_{\\mathrm{approx}}')
('9', '\\mathcal{B}')
('9', '\\begin{aligned}\n    \\forall \\alpha \\in \\mathbb{R},\\quad\n    \\Phi_{\\mathrm{balance}}(\\mathcal{B};\\alpha)  &:= \\mathds{1}\\left\\{ \\frac{1}{\\alpha |\\mathcal{B}|} \\leq P\\left[ Z \\in I\\right] \\leq \\frac{\\alpha}{|\\mathcal{B}|}, ~~ \\forall I \\in \\mathcal{B}\\right\\},\n        \\label{eqn:Phi_balance}\\\\\n    \\forall \\varepsilon \\in \\mathbb{R},\\quad\n    \\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon)   &:= \\mathds{1}\\left\\{ \\max_{I \\in \\mathcal{B}} \\left| \\hat{\\mu}_{I} - \\mu_{I} \\right| \\leq \\varepsilon \\right\\},\n        \\label{eqn:Phi_approx}\n\\end{aligned}')
('9', '\\mathds{1}(A) = 1')
('9', 'A')
('9', 'I \\in \\mathcal{B}')
('9', '\\label{eqn:bin_means}\n    \\hat{\\mu}_I = \\frac{\\sum_{i=1}^n y_i \\cdot \\mathds{1}_{I}(z_i)}{\\sum_{i=1}^n \\cdot \\mathds{1}_{I}(z_i)}\n    \\qquad\\text{and}\\qquad\n    \\mu_I = \\mathbb{E}_{(Y,Z) \\sim P_{Y,Z}} \\left[ Y \\cdot \\mathds{1}_{I}(Z) \\right].')
('9', '\\Phi_{\\mathrm{balance}}(\\mathcal{B};\\alpha) = 1')
('9', '\\alpha \\geq 1')
('9', '\\mathcal{B}')
('9', '\\alpha')
('9', 'Z')
('9', '\\Phi_{\\mathrm{approx}}(\\mathcal{B};\\varepsilon) = 1')
('9', '\\varepsilon \\geq 0')
('9', 'Y')
('9', 'I \\in \\mathcal{B}')
('9', '\\varepsilon')
('9', '\\alpha, \\varepsilon \\in \\mathbb{R}')
('9', '\\mathcal{B}')
('9', '\\Phi_{\\mathrm{balance}}(\\mathcal{B};\\alpha) = \\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon) = 1')
('9', 'R^{\\mathrm{cal}}')
('9', 'R^{\\mathrm{sha}}')
('9', '\\Phi_{\\mathrm{balance}}(\\mathcal{B};\\alpha) = \\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon) = 1')
('9.0.0', '\\mathcal{B}')
('9.0.0', 'P_{Y,Z}')
('9.0.0', 'S = \\{Z_i: i \\in [n]\\}')
('9.0.0', 'P_Z')
('9.0.0', '\\mathcal{B}')
('9.0.0', 'B')
('9.0.0', 'S')
('9.0.0', "c' > 0")
('9.0.0', '\\delta \\in (0,1)')
('9.0.0', "n \\geq c' \\cdot B \\log (B/\\delta)")
('9.0.0', '\\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1')
('9.0.0', '1 - \\delta')
('9.0.0', "n \\geq c' \\cdot B \\log \\left(\\frac{B}{\\delta}\\right)\n    \\qquad\\implies\\qquad\n    P\\left[ \\mathcal{B}\\text{ is 2-well-balanced with respect to }P_Z \\right] \\geq 1 - \\delta.")
('9.0.0', 'c')
('9.0.0', "c' = 2420")
('9.0.0', "c'")
('9.0.0', '\\mathcal{Z}= [0,1]')
('9.0.0', "\\left\\{ I'_j: j \\in [10B] \\right\\}")
('9.0.0', "P[ Z \\in I'_j] = \\frac{1}{10B}")
('9.0.0', 'j \\in [10B]')
('9.0.0', 'I_b')
('9.0.0', 'O\\left(B^2 \\log\\left( \\frac{B}{\\delta}\\right) \\right)')
('9.0.0.0', '\\mathcal{B}')
('9.0.0.0', '\\mathcal{B}')
('9.0.0.0', 'P_Z')
('9.0.0.0', '\\mathcal{Z}= [0,1]')
('9.0.0.0', 'S = \\{Z_i: i \\in [n]\\}')
('9.0.0.0', 'P_Z')
('9.0.0.0', 'B \\in \\mathbb{N}')
('9.0.0.0', 'B \\leq \\frac{n}{2}')
('9.0.0.0', '\\mathcal{B}')
('9.0.0.0', 'B')
('9.0.0.0', 'S')
('9.0.0.0', '\\delta \\in (0,1)')
('9.0.0.0', 'P\\left[ \\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon_{\\delta}) = 1 \\right] \\geq 1 - \\delta\n        \\qquad\n        \\text{where}\n        \\qquad\n        \\varepsilon_{\\delta} = \\sqrt{\\frac{1}{2( \\lfloor n/B \\rfloor - 1)} \\log \\left(\\frac{2B}{\\delta}\\right) } + \\frac{1}{\\lfloor n/B \\rfloor}.')
('9.0.0.0', 'P_Z')
('9.0.0.0', 'n \\geq 2B\n    \\qquad\\implies\\qquad\n    P\\left[  \\sup_{b \\in [B]} |\\hat{\\mu}_b - \\mu_b| \\leq \\sqrt{\\frac{1}{2(\\lfloor n/B \\rfloor - 1)} \\log \\left(\\frac{2B}{\\delta}\\right) } + \\frac{1}{\\lfloor n/B \\rfloor} \\right] \\geq 1-\\delta.')
('9.1', 'R^{\\mathrm{cal}}')
('9.1', 'R^{\\mathrm{sha}}')
('9.1', '\\hat{h}')
('9.1', '\\Phi_{\\mathrm{balance}}(\\mathcal{B};\\alpha) = 1')
('9.1', '\\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon) = 1')
('9.1', '\\alpha, \\varepsilon \\in \\mathbb{R}')
('9.1.0', 'P = P_{X,Y}')
('9.1.0', '\\mathcal{X}\\times \\mathcal{Y}')
('9.1.0', 'f: \\mathcal{X}\\to \\mathcal{Z}')
('9.1.0', '\\tilde{S} = \\left\\{ (x_i, y_i) \\in \\mathcal{X}\\times \\mathcal{Y}: i \\in [n] \\right\\}')
('9.1.0', 'P')
('9.1.0', 'S = \\left\\{ (z, y) \\in \\mathcal{Z}\\times \\mathcal{Y}: (x,y) \\in \\tilde{S} \\text{ and } z = f(x) \\right\\}')
('9.1.0', '\\mathcal{B}')
('9.1.0', 'z')
('9.1.0', 'S')
('9.1.0', '\\hat{h} = \\hat{\\mathcal{B}}: \\mathcal{Z}\\to \\mathcal{Z}')
('9.1.0', '\\mathcal{B}')
('9.1.0', 'P, f, \\tilde{S}, S, \\mathcal{B}')
('9.1.0', '\\hat{h}')
('9.1.0', 'P, f, \\tilde{S}, S, \\mathcal{B}')
('9.1.0', '\\hat{h}')
('9.1.0', '\\mathcal{B}')
('9.1.0', '\\mathcal{B}')
('9.1.0', '\\beta: \\mathcal{Z}\\to [|\\mathcal{B}|]')
('9.1.0', '\\beta(z) = \\sum_{I \\in \\mathcal{B}} \\mathds{1}_{ (0, \\sup I] } (z).')
('9.1.0', '\\beta')
('9.1.0', '\\mathcal{B}')
('9.1.0', 'z \\in [0,1]')
('9.1.0', '\\mathcal{B}= \\{ I_1, \\dots, I_B \\}')
('9.1.0', 'B \\in \\mathbb{N}')
('9.1.0', 'u_0, u_1, \\dots, u_B \\in [0,1]')
('9.1.0', '0 = u_0 < u_1 < \\dots < u_B = 1')
('9.1.0', 'I_b = (u_{b-1}, u_b]')
('9.1.0', 'b\\in [B] \\setminus \\{1\\}')
('9.1.0', 'I_1 = [u_0, u_1]')
('9.1.0', '\\beta(z) = b')
('9.1.0', 'z \\in I_b')
('9.1.1', '\\mathcal{B}')
('9.1.1', '\\hat{\\mu}_I')
('9.1.1', '\\mu_I')
('9.1.1', '\\varepsilon')
('9.1.1', '\\varepsilon^2')
('9.1.1', '\\varepsilon \\geq 0')
('9.1.1', '\\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon) = 1')
('9.1.1', 'R^{\\mathrm{cal}}(\\hat{h}; f, P) \\leq \\varepsilon^2.')
('9.1.1', 'Z = f(X)')
('9.1.1', '\\begin{aligned}\n        R^{\\mathrm{cal}}\\big( \\hat{h}; f, P \\big)\n            &= \\mathbb{E}\\left[ \\Big( \\hat{h}(Z) - \\mathbb{E}[ Y \\mid \\hat{h}(Z) ] \\Big)^2 \\right]\\\\\n            &= \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\Big( \\hat{h}(Z) - \\mathbb{E}[ Y \\mid \\hat{h}(Z) ] \\Big)^2 \\,\\Big|\\,  \\beta(Z) \\right] \\right]\n                &&\\because \\text{the law of total expectation}\\\\\n            &= \\mathbb{E}\\left[ \\big( \\hat{\\mu}_{I_{\\beta(Z)}} - \\mu_{I_{\\beta(Z)}} \\big)^2 \\right]\n                &&\\text{ cf. }\\eqref{eqn:bin_means}\\\\\n            &\\leq \\max_{I \\in \\mathcal{B}} \\big( \\hat{\\mu}_{I} - \\mu_{I} \\big)^2.\n    \n\\end{aligned}')
('9.1.1', '\\Phi_{\\mathrm{approx}}(\\mathcal{B}; \\varepsilon) = 1')
('9.1.1', '\\max_{I \\in \\mathcal{B}} \\big( \\hat{\\mu}_{I} - \\mu_{I} \\big)^2 \\leq \\varepsilon^2')
('9.1.1', 'L^p')
('9.1.1', '\\ell_p')
('9.1.1', 'p=2')
('9.1.2', '\\mathcal{B}')
('9.1.2', 'h^*_{f,P}')
('9.1.2', '\\alpha \\in \\mathbb{R}')
('9.1.2', '\\alpha \\geq 1')
('9.1.2', '\\Phi_{\\mathrm{balance}}(\\mathcal{B}, \\alpha) = 1')
('9.1.2', 'R^{\\mathrm{sha}}(\\hat{h}; f, P) \\leq \\frac{\\alpha}{|\\mathcal{B}|}.')
('9.1.2', 'Z = f(X)')
('9.1.2', '\\hat{h}')
('9.1.2', 'f')
('9.1.2', 'P')
('9.1.2', 'R^{\\mathrm{sha}}( \\hat{h}; f, P) := \\mathbb{E}\\left[ \\big( \\mathbb{E}\\big[ Y \\mid \\hat{h} (Z) \\big] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big)^2 \\right].')
('9.1.2', '\\beta')
('9.1.2', '\\mathcal{B}')
('9.1.2', '\\begin{aligned}\n        &\\mathbb{E}\\left[ \\big( \\mathbb{E}\\left[ Y \\mid \\hat{h} (Z) \\right] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big)^2 \\right]\\\\\n            &\\qquad\\leq \\mathbb{E}\\left[ \\big| \\mathbb{E}\\left[ Y \\mid \\hat{h} (Z) \\right] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big| \\right]     \n                &&\\because \\big| \\mathbb{E}\\left[ Y \\mid \\hat{h} (Z) \\right] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big| \\leq 1\\\\\n            &\\qquad= \\sum_{I \\in \\mathcal{B}} \\mathbb{E}\\left[ \\big| \\mathbb{E}[ Y \\mid \\hat{h} (Z) ] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big| \\cdot \\mathds{1}_I(Z) \\right]\\\\\n            &\\qquad= \\sum_{I \\in \\mathcal{B}} \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\big| \\mathbb{E}[ Y \\mid \\hat{h} (Z) ] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big| \\cdot \\mathds{1}_I(Z) \\, \\Big| \\, \\beta(Z) \\right] \\right]\n                &&\\because \\text{the law of total expectation}\\\\\n            &\\qquad= \\sum_{I \\in \\mathcal{B}} P[ Z \\in I ] \\cdot \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\big| \\mathbb{E}[ Y \\mid \\hat{h} (Z) ] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big| \\, \\Big| \\, Z \\in I \\right] \\right]\n                &&\\because \\text{Remark \\ref{rem:index}}\\\\\n            &\\qquad\\leq \\sum_{I \\in \\mathcal{B}} P[ Z \\in I ] \\cdot \\left( \\sup_{z \\in I} h^*_{f,P}(z) - \\inf_{z \\in I} h^*_{f,P}(z) \\right)\n                &&\\because \\text{by definition of }h^*_{f,P}; \\text{ cf. \\eqref{eqn:optimal_h}}\\\\\n            &\\qquad \\leq \\sum_{I \\in \\mathcal{B}} \\frac{\\alpha}{|\\mathcal{B}|}  \\cdot \\left( \\sup_{z \\in I} h^*_{f,P}(z) - \\inf_{z \\in I} h^*_{f,P}(z) \\right)      \n                &&\\because \\Phi_{\\mathrm{balance}}(\\mathcal{B}, \\alpha) = 1\\\\\n            &\\qquad \\leq \\frac{\\alpha}{|\\mathcal{B}|}.\n    \n\\end{aligned}')
('9.1.2', 'I \\in \\mathcal{B}')
('9.1.2', 'h^*_{f,P}(z) \\in [0,1]')
('9.1.2', 'h^*_{f,P}')
('9.1.2.0', 'O(|\\mathcal{B}|^{-1})')
('9.1.2.0', 'O(|\\mathcal{B}|^{-2})')
('9.1.2.0', 'h^*_{f,P}')
('9.1.2.0', 'K > 0')
('9.1.2.0', 'z_1 \\leq z_2')
('9.1.2.0', 'h^*_{f,P}(z_2) - h^*_{f,P}(z_1) \\leq K \\cdot \\big( F_Z(z_2) - F_Z(z_1) \\big)')
('9.1.2.0', 'h^*_{f,P}')
('9.1.2.0', 'K')
('9.1.2.0', 'F_Z')
('9.1.2.0', 'P[Y=1|Z=z]')
('9.1.2.0', 'Y')
('9.1.2.0', 'Z')
('9.1.2.0', 'Z')
('9.1.2.0', 'P[Y=1|Z]')
('9.1.2.0', 'Z')
('9.1.2.0', 'Y')
('9.1.2.0', 'Z')
('9.1.2.0', 'Z = f(X)')
('9.1.2.0', 'p_Z')
('9.1.2.0', '\\epsilon')
('9.1.2.0', 'Z')
('9.1.2.0', 'h^*_{f,P}')
('9.1.2.0', 'L')
('9.1.2.0', 'h^*_{f,P}')
('9.1.2.0', '(L/\\epsilon)')
('9.1.2.0', 'F_Z')
('9.1.2.0', 'F_Z')
('9.1.2.0', 'h^*_{f,P}')
('9.1.2.0', 'K')
('9.1.2.0', 'Z')
('9.1.2.0', 'h^*_{f,P}(z)')
('9.1.2.0', '[0.5, 0.75]')
('9.1.2.0', 'p_Z(z)')
('9.1.2.0', 'K')
('9.1.2.0', 'p_Z(z) \\to 0')
('9.1.2.0', '\\psi')
('9.1.2.0', '\\psi')
('9.1.2.0', 'K \\in \\mathbb{R}_+')
('9.1.2.0', '\\psi: [0,1] \\to [0,1]')
('9.1.2.0', '\\phi: [0,1] \\to [0,1]')
('9.1.2.0', 'z_1, z_2 \\in [0,1]')
('9.1.2.0', 'z_1 \\leq z_2')
('9.1.2.0', '\\big| \\phi(z_2) - \\phi(z_1) \\big| \\leq K \\cdot\\big( \\psi(z_2) - \\psi(z_1) \\big).')
('9.1.2.0', 'h^*_{f,P}(z)')
('9.1.2.0', 'K')
('9.1.2.0', 'F_Z')
('9.1.2.0', 'K \\geq 0')
('9.1.2.0', 'F_Z')
('9.1.2.0', 'Z = f(X)')
('9.1.2.0', '\\Phi_{\\mathrm{balance}}(\\mathcal{B}, \\alpha) = 1')
('9.1.2.0', 'R^{\\mathrm{sha}}\\leq \\frac{K^2\\alpha^3}{B^2}.')
('9.1.2.0', 'Z = f(X)')
('9.1.2.0', 'B = |\\mathcal{B}|')
('9.1.2.0', 'b \\in [B]')
('9.1.2.0', 'z_{b, \\max} := \\sup I_b')
('9.1.2.0', 'z_{b, \\min} := \\inf I_b')
('9.1.2.0', '\\begin{aligned}\n    &R^{\\mathrm{sha}}(\\hat{h}; f, P) \\\\\n        &\\qquad= \\mathbb{E}\\left[ \\big( \\mathbb{E}\\big[ Y \\mid \\hat{h} (Z) \\big] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big)^2 \\right] \\\\\n        &\\qquad= \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\big( \\mathbb{E}\\big[ Y \\mid \\hat{h} (Z) \\big] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big)^2 \\, \\Big|\\, \\beta(Z) \\right] \\right]\\\\\n        &\\qquad= \\sum_{b=1}^B P[ Z \\in I_b] \\cdot \\mathbb{E}\\left[ \\big( \\mathbb{E}\\big[ Y \\mid \\hat{h} (Z) \\big] - \\mathbb{E}\\left[ Y \\mid Z \\right] \\big)^2 \\, \\Big|\\, \\beta(Z) = b \\right] \\\\\n        &\\qquad\\leq \\sum_{b=1}^B P[ Z \\in I_b] \\cdot \\Big( h^*_{f,P}(z_{b,\\max}) - h^*_{f,P}(z_{b,\\min}) \\Big)^2\n            &&\\because h^*_{f,P}\\text{ is non-decreasing}\\\\\n        &\\qquad\\leq \\sum_{b=1}^B P[ Z \\in I_b] \\cdot \\Big( K \\cdot \\big( F_Z(z_{b,\\max}) - F_Z(z_{b,\\min}) \\big) \\Big)^2\n            &&\\because h^*_{f,P}\\text{ is K-smooth w.r.t. }F_Z\\\\\n        &\\qquad= \\sum_{b=1}^B K^2 \\cdot P[Z \\in I_b]^3\\\\\n        &\\qquad\\leq K^2 \\sum_{b=1}^B \\left( \\frac{\\alpha}{B} \\right)^3\n            &&\\because \\Phi_{\\mathrm{balance}}(\\mathcal{B}, \\alpha) = 1\\\\\n        &\\qquad= \\frac{K^2 \\alpha^3}{B^2}.\n\\end{aligned}')
('9.1.2.0', 'O(B^{-2})')
('9.1.2.0', 'R^{\\mathrm{sha}}= O(B^{-2})')
('9.1.2.0', 'B')
('9.1.2.0', 'Z\\sim\\textrm{Uniform}[0,1]')
('9.1.2.0', '1/B')
('9.1.2.0', '1/(12B^2)')
('9.1.2.0', '1/(12B^2)')
('9.1.2.0', 'B^{-2}')
('9.2', '\\delta \\in (0,1)')
('9.2', '\\delta_1 = \\delta_2 = \\delta/2')
('9.2', "\\begin{aligned}\n        &n \\geq c' \\cdot |\\mathcal{B}| \\log \\left( \\frac{|\\mathcal{B}|}{\\delta_1} \\right)\n            &&\\implies      &&P\\left[ \\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1 \\right] \\geq 1 - \\delta_1\n            &&\\text{by Lemma \\ref{LEMMA:WELL}}\\\\\n        &n \\geq 2 |\\mathcal{B}|\n            &&\\implies      && P\\left[ \\Phi_{\\mathrm{approx}}(\\mathcal{B}, \\varepsilon_{\\delta_2}) = 1 \\right] \\geq 1 - \\delta_2\n            &&\\text{by Lemma \\ref{LEMMA:FREE}}\n    \n\\end{aligned}")
('9.2', "c' > 0")
('9.2', '\\varepsilon_{\\delta_2} = \\sqrt{\\frac{1}{2( \\lfloor n/|\\mathcal{B}| \\rfloor - 1)} \\log \\left(\\frac{2 |\\mathcal{B}|}{\\delta_2}\\right) } + \\frac{1}{\\lfloor n/|\\mathcal{B}| \\rfloor}.')
('9.2', '\\delta_1 = \\frac{\\delta}{2} < \\frac{1}{2}')
('9.2', '|\\mathcal{B}| \\geq 1')
('9.2', '\\log \\left( \\frac{|\\mathcal{B}|}{\\delta_1} \\right) \\geq \\log 2')
('9.2', "c := \\max\\{ c', \\frac{2}{\\log 2} \\}")
('9.2', 'n \\geq c \\cdot |\\mathcal{B}| \\log \\left( \\frac{2 |\\mathcal{B}|}{\\delta} \\right)\n            \\qquad\\implies\\qquad\n            P\\big[ \\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1 ~~\\text{and}~~ \\Phi_{\\mathrm{approx}}(\\mathcal{B}, \\varepsilon_{\\delta/2}) = 1\\big] \\geq  1 - \\delta.')
('9.2', '\\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1')
('9.2', '\\Phi_{\\mathrm{approx}}(\\mathcal{B}, \\varepsilon_{\\delta_2}) = 1')
('9.2', '\\begin{aligned}\n        R^{\\mathrm{cal}}(\\hat{h}; f; P) &\\leq (\\varepsilon_{\\delta_2})^2                &&\\text{by Lemma \\ref{Lemma:REL}}, \\\\\n        R^{\\mathrm{sha}}(\\hat{h}; f, P) &\\leq \\frac{2}{|\\mathcal{B}|},                          &&\\text{by Lemma \\ref{Lemma:GRP}}.\n    \n\\end{aligned}')
('9.2', 'R^{\\mathrm{sha}}(\\hat{h}; f, P)')
('9.2', 'R^{\\mathrm{sha}}(\\hat{h}; f, P) \\leq \\frac{8 K^2}{|\\mathcal{B}|^2}.')
('10.0.0', 'X_i')
('10.0.0', 'p \\in (0,1)')
('10.0.0', 'S_n := \\frac{1}{n} \\sum_{i=1}^n X_i')
('10.0.0', '\\delta \\in \\mathbb{R}')
('10.0.0', '0 < \\varepsilon < 1')
('10.0.0', '\\begin{aligned}\n        P\\left[ S_n \\geq (1+\\varepsilon) p \\right] &\\leq \\exp \\left( - \\frac{\\varepsilon^2 p}{3} n \\right),\\\\\n        P\\left[ S_n \\leq (1-\\varepsilon) p \\right] &\\leq \\exp \\left( - \\frac{\\varepsilon^2 p}{2} n \\right).\n    \n\\end{aligned}')
('10.0.0', '\\varepsilon, \\delta \\in (0,1)')
('10.0.0', '\\label{eqn:chernoff_implication}\n    n \\geq \\frac{3}{\\varepsilon^2 p} \\log \\left( \\frac{2}{\\delta} \\right)\n    \\qquad\\implies\\qquad\n    P\\left( \\frac{| S_n - p |}{p} > \\varepsilon \\right) \\leq \\delta.')
('10.0.0', 'P, Q')
('10.0.0', '\\mathcal{Y}= \\{0,1\\}')
('10.0.0', '\\mathcal{D}_P\\sim P')
('10.0.0', '\\mathcal{D}_Q\\sim Q')
('10.0.0', 'n_P')
('10.0.0', 'n_Q')
('10.0.0', 'k \\in \\{0,1\\}')
('10.0.0', '\\begin{aligned}\n    w^*_k = \\frac{P_{Q}[Y=k]}{P_{P}[Y=k]},\n    \\qquad\\text{and}\\qquad\n    \\hat{w}_k = \\frac{P_{\\mathcal{D}_Q}[Y=k]}{P_{\\mathcal{D}_P}[Y=k]}.\n\\end{aligned}')
('10.0.0', '\\rho_0 := \\frac{\\hat{w}_0}{w^*_0}\n    \\qquad\\text{and}\\qquad\n    \\rho_1 := \\frac{\\hat{w}_1}{w^*_1}.')
('10.0.0', '\\Phi_{\\mathrm{ratio}}(\\mathcal{D}_P, \\mathcal{D}_Q; \\beta)')
('10.0.0', '\\mathcal{D}_P\\sim P')
('10.0.0', '\\mathcal{D}_Q\\sim Q')
('10.0.0', '\\beta \\in \\mathbb{R}')
('10.0.0', '1 < \\beta \\leq 2')
('10.0.0', '\\label{eqn:Phi_ratio}\n    \\Phi_{\\mathrm{ratio}}(\\mathcal{D}_P, \\mathcal{D}_Q; \\beta) := \\mathds{1}\\left\\{ \\frac{1}{\\beta} \\leq \\rho_k \\leq \\beta, ~~\\forall k \\in \\{0,1\\} \\right\\}.')
('10.0.0', 'P, Q')
('10.0.0', '\\mathcal{Y}= \\{0,1\\}')
('10.0.0', '\\mathcal{D}_P\\sim P')
('10.0.0', '\\mathcal{D}_Q\\sim Q')
('10.0.0', 'n_P')
('10.0.0', 'n_Q')
('10.0.0', 'k \\in \\{0,1\\}')
('10.0.0', 'p_k := P_P[Y=k]')
('10.0.0', 'q_k := P_Q[Y=k]')
('10.0.0', '\\hat{p}_k = \\frac{1}{n_P} \\sum_{y_i \\in \\mathcal{D}_P} \\mathds{1}\\{ y_i = k \\}')
('10.0.0', '\\hat{q}_k = \\frac{1}{n_Q} \\sum_{y_i \\in \\mathcal{D}_Q} \\mathds{1}\\{ y_i = k \\}')
('10.0.0', '\\delta \\in (0,1)')
('10.0.0', '\\beta \\in (1,2]')
('10.0.0', 'n_P \\geq \\frac{27}{(\\beta-1)^2 \\min\\{p_0, p_1\\}} \\log \\left( \\frac{8}{\\delta} \\right)\n            \\quad\\text{and}\\quad\n            n_Q \\geq \\frac{27}{(\\beta-1)^2 \\min\\{q_0, q_1\\}} \\log \\left( \\frac{8}{\\delta} \\right),')
('10.0.0', 'P\\left( \\Phi_{\\mathrm{ratio}}(\\mathcal{D}_P, \\mathcal{D}_Q; \\beta) =1 \\right) \\geq 1 - \\delta.')
('10.0.0', '\\varepsilon = \\frac{\\beta - 1}{3}')
('10.0.0', '\\frac{1+x}{1-x} \\leq 1 + 3x')
('10.0.0', 'x \\in [0, 1/3]')
('10.0.0', '\\frac{1}{\\beta} \\leq \\frac{1-\\varepsilon}{1+\\varepsilon} < \\frac{1 + \\varepsilon}{1- \\varepsilon} \\leq \\beta')
('10.0.0', 'k \\in \\{0,1\\}')
('10.0.0', '\\begin{aligned}\n        n_P &\\geq \\frac{3}{\\varepsilon^2 p_k} \\log \\left( \\frac{8}{\\delta} \\right)\n            &&\\implies&\n            P\\left( \\frac{| \\hat{p}_k - p_k |}{p_k} > \\varepsilon \\right) &\\leq \\frac{\\delta}{4},\\\\\n        n_Q &\\geq \\frac{3}{\\varepsilon^2 q_k} \\log \\left( \\frac{8}{\\delta} \\right)\n            &&\\implies&\n            P\\left( \\frac{| \\hat{q}_k - q_k |}{q_k} > \\varepsilon \\right) &\\leq \\frac{\\delta}{4}.\n    \n\\end{aligned}')
('10.0.0', '\\begin{aligned}\n        &n_P \\geq \\frac{3}{\\varepsilon^2 \\min\\{p_0, p_1\\}} \\log \\left( \\frac{8}{\\delta} \\right)\n        ~~\\text{and}~~\n        n_Q \\geq \\frac{3}{\\varepsilon^2 \\min\\{q_0, q_1\\}} \\log \\left( \\frac{8}{\\delta} \\right)\\\\\n        &\\qquad\\implies\\qquad\n            P\\left( \\max_{k \\in \\{0,1\\}} \\frac{| \\hat{p}_k - p_k |}{p_k} > \\varepsilon ~~\\text{or}~~ \\max_{k \\in \\{0,1\\}} \\frac{| \\hat{q}_k - q_k |}{q_k} > \\varepsilon \\right) \\leq \\delta\\\\\n        &\\qquad\\implies\\qquad\n            P\\left( \\max_{k \\in \\{0,1\\}} \\rho_k > \\frac{1 + \\varepsilon}{1-\\varepsilon} ~~\\text{or}~~ \\min_{k \\in \\{0,1\\}} \\rho_k < \\frac{1 - \\varepsilon}{1+\\varepsilon} \\right) \\leq \\delta\\\\\n        &\\qquad\\implies\\qquad\n            P\\left( \\max_{k \\in \\{0,1\\}} \\rho_k > \\beta ~~\\text{or}~~ \\min_{k \\in \\{0,1\\}} \\rho_k < \\frac{1}{\\beta} \\right) \\leq \\delta.\n    \n\\end{aligned}')
('10.0.1', 'w = (w_0, w_1) \\in \\mathbb{R}^2')
('10.0.1', 'w_0, w_1 > 0')
('10.0.1', 'w_0 + w_1 = 1')
('10.0.1', 'g_w : [0,1] \\to [0,1]')
('10.0.1', 'g_w(z) = \\frac{ w_1 z }{w_1 z + w_0 (1-z) }')
('10.0.1', 'L')
('10.0.1', 'L = \\max \\left\\{ \\frac{w_1}{w_0}, \\frac{w_0}{w_1} \\right\\}')
('10.0.1', 'g_w')
('10.0.1', '\\begin{aligned}\n        \\frac{d}{dz} g_w(z) \n            &= \\frac{w_1 \\cdot \\big[ w_1 z + w_0 (1-z) \\big] - w_1 z \\cdot ( w_1 - w_0 ) }{\\big[ w_1 z + w_0 (1-z) \\big]^2}\n            = \\frac{ w_1 w_0 }{ \\big[ w_1 z + w_0 (1-z) \\big]^2 }.\n    \n\\end{aligned}')
('10.0.1', 'g_w')
('10.0.1', '\\frac{d}{dz} g_w(z) > 0')
('10.0.1', 'z \\in [0,1]')
('10.0.1', 'g_w')
('10.0.1', '\\begin{aligned}\n        \\frac{d^2}{dz^2} g_w(z) \n            &= \\frac{ 2 w_0 w_1 \\cdot (w_0 - w_1) }{\\big[ w_1 z + w_0 (1-z) \\big]^3}\n            \\begin{cases}\n                > 0, ~~\\forall z \\in [0,1]     & \\text{if }w_0 > w_1,\\\\\n                = 0, ~~\\forall z \\in [0,1]     & \\text{if }w_0 = w_1,\\\\\n                < 0, ~~\\forall z \\in [0,1]     & \\text{if }w_0 < w_1.\n            \\end{cases}\n    \n\\end{aligned}')
('10.0.1', '\\begin{aligned}\n        \\sup_{z \\in [0,1]} \\frac{d}{dz} g_w(z)  = \n            \\begin{cases}\n                \\frac{d}{dz} g_w(z) \\Big|_{z=1} = \\frac{w_0}{w_1}   & \\text{if }w_0 > w_1,\\\\\n                \\frac{d}{dz} g_w(z) \\Big|_{z=0} = \\frac{w_1}{w_0}   & \\text{if }w_0 \\leq w_1.\n            \\end{cases}\n    \n\\end{aligned}')
('10.0.1', 'P, Q')
('10.0.1', '(X,Y) \\in \\mathcal{X}\\times \\{0,1\\}')
('10.0.1', 'w_k = \\frac{ P[Y=k] }{Q[ Y=k ]}')
('10.0.1', 'k \\in \\{0,1\\}')
('10.0.1', 'P, Q')
('10.0.1', 'f: \\mathcal{X}\\to \\mathbb{R}')
('10.0.1', '\\min_{k \\in \\{0,1\\}} w_k \\leq \\frac{\\mathbb{E}_Q[f(X)]}{\\mathbb{E}_P[f(X)]} \\leq \\max_{k \\in \\{0,1\\}} w_k.')
('10.0.1', '\\begin{aligned}\n        \\mathbb{E}_Q \\left[ f(X) \\right]\n            &= \\mathbb{E}_Q \\left[ \\mathbb{E}_Q \\big[ f(X) \\mid Y \\big] \\right]     &&\\text{by the law of total expectation}\\\\\n            &= \\sum_{k=0}^1 P_Q[Y=k] \\cdot \\mathbb{E}_Q \\big[ f(X) \\mid Y \\big]\\\\\n            &= \\sum_{k=0}^1 \\big( w_k \\cdot P_P[Y=k] \\big) \\cdot \\mathbb{E}_P \\big[ f(X) \\mid Y \\big].\n                &&\\text{by definition of }w_k \\text{ \\& the label shift assumption}\n    \n\\end{aligned}')
('10.0.1', '\\min_k w_k \\cdot \\mathbb{E}_P[f(X)] \\leq \\mathbb{E}_Q[f(X)] \\leq \\max_k w_k \\cdot \\mathbb{E}_P[f(X)]')
('10.1', 'R_Q(\\hat{h}_Q; f)')
('10.1', '\\hat{g}')
('10.1', '\\hat{h}_P')
('10.1', 'R_Q')
('10.1.0', 'R_Q')
('10.1.0', '\\begin{aligned}\n    R_Q(\\hat{h}_Q; f) \n        &= \\mathbb{E}_Q \\left[ \\left(\\hat{h}_Q \\circ f(X) - \\mathbb{E}_Q[Y|f(X)] \\right)^2 \\right]\n            \\nonumber\\\\\n        &= \\mathbb{E}_Q \\left[ \\left( \\hat{g} \\circ \\hat{h}_P \\circ f(X) - g^* \\circ \\hat{h}_P \\circ f(X) + g^* \\circ \\hat{h}_P \\circ f(X) - \\mathbb{E}_Q[Y|f(X)] \\right)^2 \\right]\n            \\nonumber\\\\\n        &\\stackrel{(a)}{\\leq}  2\\cdot  \\Bigg\\{ \\underbrace{\\mathbb{E}_Q \\left[ \\, \\left( \\hat{g} \\circ \\hat{h}_P \\circ f(X) - g^* \\circ \\hat{h}_P \\circ f(X) \\right)^2\\, \\right]}_{=: T_1} \n            \\label{eqn:step1_master.T1}\\\\\n            &\\qquad+ \\underbrace{\\mathbb{E}_Q \\left[ \\, \\left( g^* \\circ \\hat{h}_P \\circ f(X) - \\mathbb{E}_Q[Y|f(X)] \\right)^2\\, \\right]}_{=:T_2} \\Bigg\\},\n                \\label{eqn:step1_master.T2}\n\\end{aligned}')
('10.1.0', '(a+b)^2 \\leq 2(a^2 + b^2)')
('10.1.0', 'a, b \\in \\mathbb{R}')
('10.1.0', 'T_1')
('10.1.0', 'T_2')
('10.1.0.0', '\\begin{aligned}\n    g^*(z) &= \\frac{w^*_1 z}{ w^*_1 z + w^*_0 (1-z)}\n        &&\\text{where}&\n        w^*_k &= \\frac{Q[Y=k]}{P[Y=k]}, ~~\\forall k \\in \\{0,1\\},\\\\\n    \\hat{g}(z) &= \\frac{\\hat{w}_1 z}{ \\hat{w}_1 z + \\hat{w}_0 (1-z)}\n        &&\\text{where}&\n        \\hat{w}_k &= \\frac{\\hat{Q}[Y=k]}{\\hat{P}[Y=k]}, ~~\\forall k \\in \\{0,1\\}.\n\\end{aligned}')
('10.1.0.0', '\\rho_0 := \\frac{\\hat{w}_0}{w^*_0}\n    \\qquad\\text{and}\\qquad\n    \\rho_1 := \\frac{\\hat{w}_1}{w^*_1}.')
('10.1.0.0', 'z \\in (0,1)')
('10.1.0.0', '\\begin{aligned}\n    \\left| \\hat{g}(z) - g^*(z) \\right|\n        &= \\left| \\frac{\\hat{w}_1 z}{ \\hat{w}_1 z + \\hat{w}_0 (1-z)} - \\frac{w^*_1 z}{ w^*_1 z + w^*_0 (1-z)} \\right|\\\\\n        &= \\left| \\frac{ \\big( \\hat{w}_1 w^*_0 - w^*_1 \\hat{w}_0 \\big) \\cdot z (1-z) }{ \\big[ \\hat{w}_1 z + \\hat{w}_0 (1-z) \\big] \\cdot \\big[ w^*_1 z + w^*_0 (1-z) \\big] } \\right|\\\\\n        &\\leq \\left| \\frac{ \\big( \\hat{w}_1 w^*_0 - w^*_1 \\hat{w}_0 \\big) \\cdot z (1-z) }{ \\big( \\hat{w}_1 w^*_0 + w^*_1 \\hat{w}_0 \\big) \\cdot z (1-z) } \\right|\\\\\n        &= \\left| \\frac{ \\hat{w}_1 w^*_0 - w^*_1 \\hat{w}_0 }{ \\hat{w}_1 w^*_0 + w^*_1 \\hat{w}_0 } \\right|\\\\\n        &= \\frac{\\big| \\rho_0 - \\rho_1 \\big|}{ \\rho_0 + \\rho_1 }.\n\\end{aligned}')
('10.1.0.0', '\\hat{g}(0) = g^*(0) = 0')
('10.1.0.0', '\\hat{g}(1)=g^*(1) = 1')
('10.1.0.0', 'Z_{\\hat{h}} := \\hat{h}_P \\circ f(X)')
('10.1.0.0', '\\label{eqn:T1_upper}\n    T_1 = \\mathbb{E}_Q \\left[ \\Big( \\hat{g}(Z_{\\hat{h}}) - g^*(Z_{\\hat{h}}) \\Big)^2 \\right] \n        \\leq \\left( \\frac{ \\rho_0 - \\rho_1 }{ \\rho_0 + \\rho_1 } \\right)^2.')
('10.1.0.0', '\\rho_0, \\rho_1')
('10.1.0.1', '\\begin{aligned}\n    T_2 &= \\mathbb{E}_Q \\left[ \\, \\Big( g^* \\circ \\hat{h}_P \\circ f(X) - \\mathbb{E}_Q[Y \\mid f(X)] \\Big)^2\\, \\right]\\\\\n        &= \\mathbb{E}_Q \\left[ \\, \\Big( g^* \\circ \\hat{h}_P \\circ f(X) - g^* \\big( \\mathbb{E}_P[Y \\mid f(X)] \\big) \\Big)^2\\, \\right]    \n            &&\\because \\text{Label shift assumption, cf. \\eqref{eqn:relation_under_shift}}\\\\\n        &\\leq \\left( \\frac{w^*_{\\max}}{w^*_{\\min}} \\right)^2 \\cdot \\mathbb{E}_Q \\left[ \\, \\left( \\hat{h}_P \\circ f(X) - \\mathbb{E}_P[Y \\mid f(X)]  \\right)^2\\, \\right]     \n            &&\\because g^* \\text{ is }\\frac{w^*_{\\max}}{w^*_{\\min}}\\text{-Lipschitz, cf. Lemma \\ref{lem:lipschitz}}\\\\\n        &\\leq \\left( \\frac{w^*_{\\max}}{w^*_{\\min}} \\right)^2 \\cdot w^*_{\\max}\\cdot \\mathbb{E}_P \\left[ \\, \\Big( \\hat{h}_P \\circ f(X) - \\mathbb{E}_P[Y\\mid f(X)] \\Big)^2\\, \\right] \n            &&\\because \\text{by Lemma \\ref{lem:ratio_PQ}}\\\\\n        &= \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot R_P\\big( \\hat{h}_P; f \\big).\n\\end{aligned}')
('10.1.0.2', '\\delta \\in (0,1)')
('10.1.0.2', '\\delta')
('10.1.0.2', '\\delta_1, \\delta_2, \\delta_3')
('10.1.0.2', '\\delta_1 = \\delta_2 = \\delta/4')
('10.1.0.2', '\\delta_3 = \\delta/2')
('10.1.0.2', "\\begin{aligned}\n    &n_P \\geq c' \\cdot |\\mathcal{B}| \\log \\left( \\frac{|\\mathcal{B}|}{\\delta_1} \\right)\n        &&\\implies      &&P\\left[ \\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1 \\right] \\geq 1 - \\delta_1\n        &&\\text{by Lemma \\ref{LEMMA:WELL}}\\\\\n    &n_P \\geq 2 |\\mathcal{B}|\n        &&\\implies      && P\\left[ \\Phi_{\\mathrm{approx}}(\\mathcal{B}, \\varepsilon_{\\delta_2}) = 1 \\right] \\geq 1 - \\delta_2\n        &&\\text{by Lemma \\ref{LEMMA:FREE}}\n\\end{aligned}")
('10.1.0.2', "c' > 0")
('10.1.0.2', '\\varepsilon_{\\delta_2} = \\sqrt{\\frac{1}{2( \\lfloor n/|\\mathcal{B}| \\rfloor - 1)} \\log \\left(\\frac{2 |\\mathcal{B}|}{\\delta_2}\\right) } + \\frac{1}{\\lfloor n/|\\mathcal{B}| \\rfloor}.')
('10.1.0.2', 'n_P \\geq \\frac{27}{\\min\\{p_0, p_1\\}} \\log \\left( \\frac{8}{\\delta_3} \\right)\n    \\qquad\\text{and}\\qquad\n    n_Q \\geq \\frac{27}{\\min\\{q_0, q_1\\}} \\log \\left( \\frac{8}{\\delta_3} \\right),')
('10.1.0.2', '\\beta_{\\delta_3}')
('10.1.0.2', 'n_P, n_Q')
('10.1.0.2', '\\delta_3')
('10.1.0.2', '\\label{eqn:beta}\n    \\beta_{\\delta_3} = \\beta_{\\delta_3}(n_P, n_Q) := 1 + \\sqrt{ \\max \\left\\{ \\frac{1}{n_P \\cdot \\min\\{p_0, p_1\\}}, ~\\frac{1}{n_Q \\cdot \\min\\{q_0, q_1\\}} \\right\\} \\cdot 27 \\log \\left( \\frac{8}{\\delta_3} \\right) }.')
('10.1.0.2', 'P\\left( \\Phi_{\\mathrm{ratio}}(\\mathcal{D}_P, \\mathcal{D}_Q; \\beta_0) =1 \\right) \\geq 1 - \\delta_3.')
('10.1.0.2', '\\delta_1 = \\frac{\\delta}{4} < \\frac{1}{4}')
('10.1.0.2', '|\\mathcal{B}| \\geq 4')
('10.1.0.2', '\\log \\left( \\frac{|\\mathcal{B}|}{\\delta_1} \\right) \\geq \\log 16 \\geq 2')
('10.1.0.2', "c = c'")
('10.1.0.2', "c' \\geq 1")
('10.1.0.2', '\\log \\left( \\frac{|\\mathcal{B}|}{\\delta_1} \\right) \\geq \\log \\left( \\frac{16}{\\delta} \\right) = \\log \\left( \\frac{8}{\\delta_3} \\right)')
('10.1.0.2', "\\begin{aligned}\n    &n_P \\geq \\max\\left\\{ c, ~ \\frac{27}{\\min\\{p_0, p_1\\}} \\right\\} \\cdot |\\mathcal{B}| \\log \\left( \\frac{4|\\mathcal{B}|}{\\delta} \\right)\\\\\n    &\\qquad\\implies\\qquad\n    n_P \\geq \\max\\left\\{ c' \\cdot |\\mathcal{B}| \\log \\left( \\frac{|\\mathcal{B}|}{\\delta_1} \\right), ~ 2 |\\mathcal{B}|, ~\\frac{27}{\\min\\{p_0, p_1\\}} \\log \\left( \\frac{8}{\\delta_3} \\right) \\right\\}.\n\\end{aligned}")
('10.1.0.2', '\\delta \\in (0,1)')
('10.1.0.2', '\\begin{aligned}\n        &n_P \\geq \\max\\left\\{ c, ~ \\frac{27}{\\min\\{p_0, p_1\\}} \\right\\} \\cdot |\\mathcal{B}| \\log \\left( \\frac{4|\\mathcal{B}|}{\\delta} \\right)\n            \\quad\\text{and}\\quad\n            n_Q \\geq \\frac{27}{\\min\\{q_0, q_1\\}} \\log \\left( \\frac{16}{\\delta} \\right)\\\\\n        &\\qquad\\implies\\qquad\n            P\\left[ \\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1 ~\\&~ \\Phi_{\\mathrm{approx}}(\\mathcal{B}, \\varepsilon_{\\delta/4}) = 1 ~\\&~ \\Phi_{\\mathrm{ratio}}(\\mathcal{D}_P, \\mathcal{D}_Q; \\beta_{\\delta/2}) =1 \\right] \\geq 1 - \\delta.\n    \\end{aligned}')
('10.1.0.2', '\\Phi_{\\mathrm{balance}}(\\mathcal{B}, 2) = 1 ~\\&~ \\Phi_{\\mathrm{approx}}(\\mathcal{B}, \\varepsilon_{\\delta/4}) = 1 ~\\&~ \\Phi_{\\mathrm{ratio}}(\\mathcal{D}_P, \\mathcal{D}_Q; \\beta_{\\delta/2}) =1')
('10.1.0.2', '\\begin{aligned}\n    T_1 &\\leq \\left( \\frac{\\big| \\rho_0 - \\rho_1 \\big|}{ \\rho_0 + \\rho_1 } \\right)^2 \\leq \\left( \\frac{ \\beta_{\\delta/2} - \\frac{1}{\\beta_{\\delta/2}} }{ \\beta_{\\delta/2} + \\frac{1}{\\beta_{\\delta/2}} } \\right)^2 \\leq \\left( \\beta_{\\delta/2} - 1 \\right)^2,\n        &&\\because \\eqref{eqn:T1_upper}; \\text{ also, see \\eqref{eqn:Phi_ratio}}\\\\\n    T_2 &\\leq \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot R_P\\big( \\hat{h}_P; f \\big)\\\\\n        &\\leq \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot  \\left(\\varepsilon_{\\delta/4}^2 + \\frac{2}{|\\mathcal{B}|}\\right).\n        &&\\because \\text{proof of Theorem \\ref{Thm:risk_bound}; Lemmas \\ref{Lemma:REL} \\& \\ref{Lemma:GRP}}\n\\end{aligned}')
('10.1.0.2', 'T_2 \\leq \\frac{{w^*_{\\max}}^3}{{w^*_{\\min}}^2} \\cdot  \\left(\\varepsilon_{\\delta/4}^2 + \\frac{8 K^2}{|\\mathcal{B}|^2}\\right).')
('10.1.0.2', 'T_1')
('10.1.0.2', 'T_2')
('10.1.0.2', '\\beta')
('11', '\\begin{aligned}\n    \\hat{h}_Q = \\hat{g} \\circ \\hat{h}_P,    \n\\end{aligned}')
('11', '\\mathcal{D}_Q')
('11', '\\hat{g}')
('11', '\\hat{w} = (\\hat{w}_0, \\hat{w}_1)')
('11', '\\mathcal{D}_P')
('11', '\\mathcal{D}_Q')
('11', 'R_Q(\\hat{h}_Q) = O(n_Q^{-1})')
('11', 'n_P')
('11', 'w')
('11', '\\hat{h} \\circ f')
('11', '\\begin{aligned}\n    \\hat{h}_Q^{\\textrm{ML}} = \\hat{g}^{\\textrm{ML}} \\circ \\hat{h}_P,\n\\end{aligned}')
('11', 'g^{\\textrm{ML}}')
('11', '\\hat{w}^{\\textrm{ML}}')
('11', 'R_Q(\\hat{h}_Q^{\\textrm{ML}}) = O(n_Q^{-1})')
('11', 'n_P')
('11', 'w')
('11', 'R_Q(\\hat{h}_Q^{\\textrm{ML}}) = O(n_Q^{-1})')
('11', 'n_P')
('11', 'R_Q(\\hat{h}_Q) = 2 (T_1 + T_2)')
('11', 'T_1')
('11', 'T_1 = O(n_Q^{-1})')
('11', 'n_P')
('11', '\\hat{h}_P \\circ f')
('11', '\\|\\hat{w} - w\\|_2^2 = O(n_Q^{-1})')
('11', '\\begin{aligned}\n    \\|\\hat{w} - w\\|_2^2 &= \\sum_{k\\in\\{0,1\\}} (\\rho_k - 1)^2 w_k^2 %\\\\\n    \\geq {w^*_{\\min}}^2 \\sum_{k\\in\\{0,1\\}} (\\rho_k - 1)^2 %\\\\\n    \\geq {w^*_{\\min}}^2 \\max_{k\\in\\{0,1\\}} (\\rho_k - 1)^2,\n\\end{aligned}')
('11', '\\rho_k \\in [1-\\alpha, 1+\\alpha]')
('11', 'k\\in\\{0, 1\\}')
('11', '%\\begin{align}\n    \\alpha = \\frac{\\|\\hat{w} - w\\|_2}{w^*_{\\min}} > 0.')
('11', '\\|\\hat{w} - w\\|_2^2')
('11', '\\alpha < 0.5')
('11', 'T_1')
('11', '\\begin{aligned}\n    T_1 \\leq \\left( \\frac{ \\rho_0 - \\rho_1 }{ \\rho_0 + \\rho_1 } \\right)^2 %\\\\\n    \\leq \\frac{2\\alpha}{2 - 2\\alpha} %\\\\\n    \\leq 2\\alpha %\\\\\n    = 2 \\frac{\\|\\hat{w} - w\\|_2}{w^*_{\\min}} %\\\\\n    = O(n_Q^{-1}).\n\\end{aligned}')
('12', '\\mathcal{D}(\\pi)')
('12', 'X')
('12', 'Y')
('12', 'Y \\sim \\textrm{Bernoulli}(\\pi)')
('12', 'X \\mid Y = 0 \\sim N(-2, 1)')
('12', 'X \\mid Y = 1 \\sim N(2, 1)')
('12', 'f(x) = \\texttt{sigmoid}(x) := 1 / (1 + e^{-x})')
('12', 'x \\in \\mathbb{R}')
('12', '\\texttt{logit}(p) := \\log \\left( p / (1-p) \\right)')
('12', 'p\\in(0,1)')
('12', '\\texttt{sigmoid}')
('12.0', 'f')
('12.0', '\\mathcal{D}(0.5)')
('12.0', 'h^*_{f,P}(z) = P[Y = 1 \\mid f(X) = z] = \\texttt{sigmoid}(4 f^{-1}(z)).')
('12.0.0', 'n \\in [10^2, 10^{7}]')
('12.0.0', 'B \\in [6, 10^3]')
('12.0.0', '(n,B)')
('12.0.0', 'f')
('12.0.0', '\\mathcal{D}(0.5)')
('12.0.0', 'R^{\\mathrm{cal}}(\\hat{h})')
('12.0.0', 'R^{\\mathrm{sha}}(\\hat{h})')
('12.0.0', 'R(\\hat{h})')
('12.0.0.0', 'B^{*\\textrm{experiment}}')
('12.0.0.0', 'n')
('12.0.0.0', 'B^{*\\textrm{theory}}')
('12.0.0.0', 'B^{*\\textrm{experiment}}')
('12.0.0.0', 'B^{*\\textrm{theory}}')
('12.0.0.0', 'O(n^{1/3})')
('12.1', '\\mathcal{D}(0.5)')
('12.1', '\\mathcal{D}(\\pi_Q)')
('12.1', '\\pi_Q')
('12.1', '\\{0.01, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5\\}')
('12.1', '\\pi_Q > 0.5')
('12.1', 'n_P')
('12.1', '\\{10, 10^3, 10^5, 10^7\\}')
('12.1', 'n^Q')
('12.1', '\\{10, 10^3, 10^5\\}')
('12.1', '\\hat{h}_Q=\\hat{g} \\circ \\hat{h}_P')
('12.1', '\\textsc{Composite}')
('12.1', '\\hat{h}_P')
('12.1', '\\hat{g}')
('12.1', '\\hat{g}_Q^{\\textrm{target}}')
('12.1', 'B')
('12.1', 'n_P^{1/3}')
('12.1', 'n_Q^{1/3}')
('12.1', '\\pi_Q = 0.1')
('12.1', 'n_P = 10^3')
('12.1', 'n_Q = 10^2')
('12.1', 'R^{\\mathrm{cal}}')
('12.1', 'R^{\\mathrm{sha}}')
('12.1', 'R^{\\mathrm{sha}}=0')
('12.1', '\\hat{g}')
('12.1', 'R^{\\mathrm{cal}}')
('12.1', 'R^{\\mathrm{sha}}')
('12.1', '\\textsc{Target}{}')
('12.1', 'R')
('12.1', 'h^*')
('12.1', 'h^*')
('12.1', '\\hat{h}_Q')
('12.1', '\\hat{h}_P')
('12.1', '\\hat{h}_Q^{\\textrm{target}}')
('12.1', '\\hat{g}')
('12.1', 'Z=f(X)')
