('2.0', '(\\mathcal{S},\\mathcal{A},p,r,c,d_0,\\gamma)')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', 'p: \\mathcal{S} \\times \\mathcal{A} \\rightarrow P(\\mathcal{S})')
('2.0', 'P(\\mathcal{S})')
('2.0', '\\mathcal{S}')
('2.0', 'r,c: \\mathcal{S} \\times \\mathcal{A} \\rightarrow \\mathbb{R}')
('2.0', 'd_0 \\in P(\\mathcal{S})')
('2.0', '\\gamma')
('2.0', '\\pi: \\mathcal{S} \\rightarrow P(\\mathcal{A})')
('2.0', '\\pi')
('2.0', 'J_{p,r}(\\pi) = \\mathbb{E}_{\\tau \\sim (\\pi,p)} \\left[ \\sum_{t=0}^{\\infty} \\gamma^t r(s_t,a_t) \\right]')
('2.0', 'J_{p,c}(\\pi) = \\mathbb{E}_{\\tau \\sim (\\pi,p)} \\left[ \\sum_{t=0}^{\\infty} \\gamma^t c(s_t,a_t) \\right]')
('2.0', '\\tau \\sim (\\pi,p)')
('2.0', 's_0 \\sim d_0')
('2.0', 'a_t \\sim \\pi(\\, \\cdot \\mid s_t)')
('2.0', 's_{t+1} \\sim p(\\, \\cdot \\mid s_t, a_t)')
('2.0', '\\pi')
('2.0', '\\label{eq:safe_rl}\n\\max_{\\pi} \\,\\, J_{p,r}(\\pi) \\quad \\textnormal{s.t.} \\quad J_{p,c}(\\pi) \\leq B,')
('2.0', 'B')
('2.0', 'p')
('2.0', '\\pi')
('2.0', 'Q^{\\pi}_{p,r}(s,a)')
('2.0', 'Q^{\\pi}_{p,c}(s,a)')
('2.0', '\\label{eq:safe_rl_update}\n\\max_{\\pi} \\,\\, \\mathop{\\mathbb{E}}_{s \\sim \\mathcal{D}} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ Q^{\\pi_k}_{p,r}(s,a) \\right] \\right] \\quad \\textnormal{s.t.} \\quad \\mathop{\\mathbb{E}}_{s \\sim \\mathcal{D}} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ Q^{\\pi_k}_{p,c}(s,a) \\right] \\right] \\leq B,')
('2.0', '\\pi_k')
('2.0', '\\mathcal{D}')
('2.0', 'Q^{\\pi}_{p,r}(s,a)')
('2.0', 'Q^{\\pi}_{p,c}(s,a)')
('2.0', "\\begin{aligned}\n    \\mathcal{T}^{\\pi}_{p,r}Q(s,a) &:= r(s,a) + \\gamma \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a') \\right] \\right], \\\\\n    \\mathcal{T}^{\\pi}_{p,c}Q(s,a) &:= c(s,a) + \\gamma \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a') \\right] \\right].\n\\end{aligned}")
('2.0.0', 'p')
('2.0.0', '\\mu')
('2.0.0', '\\mu = \\prod_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mu_{s,a}')
('2.0.0', '\\mu_{s,a}')
('2.0.0', 'p_{s,a} = p(\\, \\cdot \\mid s,a) \\in P(\\mathcal{S})')
('2.0.0', '\\mu')
('2.0.0', '\\mu_{s,a}')
('2.0.0', '\\mu_{s,a} \\in P(\\mathcal{M})')
('2.0.0', '\\mathcal{M} = P(\\mathcal{S})')
('2.0.0', '\\mu')
('2.0.0', '\\mu')
('2.0.0', '\\mathcal{U} = \\bigotimes_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mathcal{U}_{s,a}')
('2.0.0', '\\mu_{s,a} \\in \\mathcal{U}_{s,a} \\subseteq P(\\mathcal{M})')
('2.0.0', '\\mathcal{U}')
('2.0.0', '\\mu')
('2.0.0', '\\mathcal{U}')
('2.0.0.0', '(\\mathcal{M},\\mathcal{F},\\mu_{s,a})')
('2.0.0.0', '\\mathcal{F}')
('2.0.0.0', '\\sigma')
('2.0.0.0', '\\mathcal{M}')
('2.0.0.0', '\\mu_{s,a} \\in P(\\mathcal{M})')
('2.0.0.0', '\\mathcal{M}')
('2.0.0.0', '\\mathcal{Z}')
('2.0.0.0', '\\mathcal{Z}^*')
('2.0.0.0', '\\rho: \\mathcal{Z} \\rightarrow \\mathbb{R}')
('2.0.0.0', 'Z \\in \\mathcal{Z}')
('2.0.0.0', '\\rho(Z)')
('2.0.0.0', '\\rho^+')
('2.0.0.0', '\\rho^+(Z) = - \\rho(-Z)')
('2.0.0.0', '\\rho')
('2.0.0.0', 'g: [0,1] \\rightarrow [0,1]')
('2.0.0.0', 'g(0)=0')
('2.0.0.0', 'g(1) = 1')
('2.0.0.0', 'g')
('2.0.0.0', '\\rho(Z) = \\int_{0}^{1} F_Z^{-1}(u)d\\tilde{g}(u),')
('2.0.0.0', 'F_Z^{-1}')
('2.0.0.0', 'Z')
('2.0.0.0', '\\tilde{g}(u) = 1 - g(1-u)')
('2.0.0.0', 'g')
('2.0.0.0', '\\eta \\geq 0')
('2.0.0.0', 'g_{\\eta}(u) = \\Phi ( \\Phi^{-1}(u) + \\eta )')
('2.0.0.0', '\\Phi')
('3.0.0', '\\mu')
('3.0.0', '\\mu')
('3.0.0', '\\mu')
('4', 'p')
('4', 'p \\sim \\mu')
('4', '\\mu')
('4', '\\mu_{s,a}')
('4', '\\rho')
('4', '\\label{eq:ramu_rl}\n\\max_{\\pi} \\,\\, J_{\\rho^+,r}(\\pi) \\quad \\textnormal{s.t.} \\quad J_{\\rho,c}(\\pi) \\leq B,')
('4', '\\rho^+')
('4', '\\rho')
('4', 'p_{s,a} \\sim \\mu_{s,a}')
('4', "\\begin{aligned}\n   J_{\\rho^+,r}(\\pi) &:= \\mathop{\\mathbb{E}}_{s \\sim d_0} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[  r(s,a) + \\gamma \\mathop{\\rho^+}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ r(s',a') + \\ldots \\, \\right] \\right] \\right) \\right] \\right], \\\\\n   J_{\\rho,c}(\\pi) &:= \\mathop{\\mathbb{E}}_{s \\sim d_0} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[  c(s,a) + \\gamma \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ c(s',a') + \\ldots \\, \\right] \\right] \\right) \\right] \\right].\n\\end{aligned}")
('4', '\\rho^+_{\\, p_{s,a} \\sim \\mu_{s,a}}\\left( \\, \\cdot \\, \\right)')
('4', '\\rho_{\\, p_{s,a} \\sim \\mu_{s,a}}\\left( \\, \\cdot \\, \\right)')
('4', '\\mu_{s,a}')
('4', 'Q^{\\pi}_{\\rho^+,r}(s,a)')
('4', 'Q^{\\pi}_{\\rho,c}(s,a)')
('4', '\\label{eq:ramu_rl_update}\n    \\max_{\\pi} \\,\\, \\mathop{\\mathbb{E}}_{s \\sim \\mathcal{D}} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ Q^{\\pi_k}_{\\rho^+,r}(s,a) \\right] \\right] \\quad \\textnormal{s.t.} \\quad \\mathop{\\mathbb{E}}_{s \\sim \\mathcal{D}} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ Q^{\\pi_k}_{\\rho,c}(s,a) \\right] \\right] \\leq B.')
('4', 'p')
('4', "\\begin{aligned}\n    Q^{\\pi}_{\\rho^+,r}(s,a) &= r(s,a) + \\gamma \\mathop{\\rho^+}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{\\pi}_{\\rho^+,r}(s',a')  \\right] \\right] \\right), \\\\\n    Q^{\\pi}_{\\rho,c}(s,a) &= c(s,a) + \\gamma \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{\\pi}_{\\rho,c}(s',a')  \\right] \\right] \\right).\n\\end{aligned}")
('4', '\\pi')
('4', "\\begin{aligned}\n    \\mathcal{T}^{\\pi}_{\\rho^+,r} Q(s,a) &:= r(s,a) + \\gamma \\mathop{\\rho^+}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right), \\\\\n    \\mathcal{T}^{\\pi}_{\\rho,c} Q(s,a) &:= c(s,a) + \\gamma \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right).\n\\end{aligned}")
('4', 'p_{s,a} \\sim \\mu_{s,a}')
('4', '\\mathcal{T}^{\\pi}_{\\rho^+,r} Q(s,a) = \\mathop{\\rho^+}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathcal{T}^{\\pi}_{p,r} Q(s,a) \\right), \\quad \\mathcal{T}^{\\pi}_{\\rho,c} Q(s,a) = \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathcal{T}^{\\pi}_{p,c} Q(s,a) \\right). \\label{eq:rho_bellman}')
('4', '\\mathcal{T}^{\\pi}_{p,r}')
('4', '\\mathcal{T}^{\\pi}_{p,c}')
('4', '\\mathcal{T}^{\\pi}_{\\rho^+,r}')
('4', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('4', 'Q^{\\pi}_{\\rho^+,r}(s,a)')
('4', 'Q^{\\pi}_{\\rho,c}(s,a)')
('5', '\\label{eq:dr_rl}\n\\max_{\\pi} \\,\\, \\inf_{\\beta \\in \\mathcal{U}^+} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ J_{p,r}(\\pi) \\right] \\quad \\textnormal{s.t.} \\quad \\sup_{\\beta \\in \\mathcal{U}} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ J_{p,c}(\\pi) \\right] \\leq B')
('5', '\\mathcal{U}^+ = \\bigotimes_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mathcal{U}^+_{s,a}')
('5', '\\mathcal{U} = \\bigotimes_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mathcal{U}_{s,a}')
('5', '\\mathcal{U}^+_{s,a}, \\, \\mathcal{U}_{s,a}  \\subseteq \\left\\lbrace \\beta_{s,a} \\in P(\\mathcal{M}) \\mid \\beta_{s,a} = \\xi_{s,a} \\mu_{s,a}, \\,\\, \\xi_{s,a} \\in \\mathcal{Z}^*   \\right\\rbrace')
('5', '\\mu_{s,a}')
('5', '\\xi_{s,a}')
('5', '\\rho^+')
('5', '\\rho')
('5', '\\mathcal{T}^{\\pi}_{\\rho^+,r}')
('5', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('5', '\\mathcal{U}^+')
('5', '\\mathcal{U}')
('5', '\\rho^+')
('5', '\\rho')
('5', '\\mathcal{U}^+')
('5', '\\mathcal{U}')
('5', '\\mu_{s,a}')
('5', '\\xi_{s,a}')
('5', '\\rho^+')
('5', '\\rho')
('5', '\\mathcal{T}^{\\pi}_{\\rho^+,r}')
('5', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('5', '\\mathcal{T}^{\\pi}_{\\rho^+,r}')
('5', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('5', '\\gamma')
('5', 'Q^{\\pi}_{\\rho^+,r}(s,a)')
('5', 'Q^{\\pi}_{\\rho,c}(s,a)')
('6', 'Q^{\\pi}_{\\rho^+,r}(s,a)')
('6', 'Q^{\\pi}_{\\rho,c}(s,a)')
('6', 'Q_{\\theta_r}')
('6', 'Q_{\\theta_c}')
('6', '\\begin{aligned}\n    \\mathcal{L}^+(\\theta_r) &= \\mathop{\\mathbb{E}}_{(s,a) \\sim \\mathcal{D}} \\left[ \\left( Q_{\\theta_r}(s,a) - \\hat{\\mathcal{T}}^{\\pi}_{\\rho^+,r} \\bar{Q}_{\\theta_r}(s,a) \\right)^2 \\right], \\\\\n    \\mathcal{L}(\\theta_c) &= \\mathop{\\mathbb{E}}_{(s,a) \\sim \\mathcal{D}} \\left[ \\left( Q_{\\theta_c}(s,a) - \\hat{\\mathcal{T}}^{\\pi}_{\\rho,c} \\bar{Q}_{\\theta_c}(s,a) \\right)^2 \\right],\n\\end{aligned}')
('6', '\\hat{\\mathcal{T}}^{\\pi}_{\\rho^+,r}')
('6', '\\hat{\\mathcal{T}}^{\\pi}_{\\rho,c}')
('6', '\\bar{Q}')
('6', '\\mu_{s,a}')
('6.0', 'n')
('6.0', 'p_{s,a}^{(i)}')
('6.0', 'i=1,\\ldots,n')
('6.0', '\\mu_{s,a}')
('6.0', 'w_{\\rho}^{(i)} = g \\left( \\frac{i}{n} \\right) - g \\left( \\frac{i-1}{n} \\right),')
('6.0', 'g')
('6.0', '\\rho')
('6.0', '\\sum_{i=1}^n w_{\\rho^+}^{(i)} \\mathcal{T}^{\\pi}_{p^{(i)},r} Q(s,a), \\quad \\sum_{i=1}^n w_{\\rho}^{(i)} \\mathcal{T}^{\\pi}_{p^{(i)},c} Q(s,a),')
('6.0', '\\mathcal{T}^{\\pi}_{p^{(i)},r} Q(s,a)')
('6.0', '\\mathcal{T}^{\\pi}_{p^{(i)},c} Q(s,a)')
('6.0', '\\mathcal{T}^{\\pi}_{p^{(i)},r} Q(s,a)')
('6.0', '\\mathcal{T}^{\\pi}_{p^{(i)},c} Q(s,a)')
('6.0', "\\hat{\\mathcal{T}}^{\\pi}_{p^{(i)},r} Q(s,a) = r(s,a) + \\gamma Q(s',a'), \\quad \\hat{\\mathcal{T}}^{\\pi}_{p^{(i)},c} Q(s,a) = c(s,a) + \\gamma Q(s',a'),")
('6.0', "s' \\sim p_{s,a}^{(i)}")
('6.0', "a' \\sim \\pi(\\, \\cdot \\mid s')")
('6.0', '\\hat{\\mathcal{T}}^{\\pi}_{\\rho^+,r} Q(s,a) = \\sum_{i=1}^n w_{\\rho^+}^{(i)} \\hat{\\mathcal{T}}^{\\pi}_{p^{(i)},r} Q(s,a), \\quad \\hat{\\mathcal{T}}^{\\pi}_{\\rho,c} Q(s,a) =  \\sum_{i=1}^n w_{\\rho}^{(i)} \\hat{\\mathcal{T}}^{\\pi}_{p^{(i)},c} Q(s,a), \\label{eq:ramu_bellman_sample}')
('6.0', 'p_{s,a}^{(i)}')
('6.0', 'i=1,\\ldots,n')
('6.0', '\\mu_{s,a}')
('6.0', 'g')
('6.0', 'n=5')
('6.0.0', '\\mu')
('6.0.0', 'p_{s,a}^{(i)} \\sim \\mu_{s,a}')
('6.0.0', "s' \\sim p_{s,a}^{(i)}")
('6.0.0', '\\mu')
('6.0.0', 'p^{\\textnormal{train}}')
('6.0.0', 'p^{\\textnormal{train}}')
('6.0.0', 'x \\sim X')
('6.0.0', 'p_{s,a}(x)')
('6.0.0', 'x \\sim X')
('6.0.0', "s'")
('6.0.0', 'p_{s,a}^{\\textnormal{train}}')
('6.0.0', 'f_x: \\mathcal{S} \\times \\mathcal{S} \\rightarrow \\mathcal{S}')
('6.0.0', "(s,s')")
('6.0.0', "\\tilde{s}'")
('6.0.0', 'x \\sim X')
('6.0.0', '\\mu_{s,a}')
('6.0.0', 'p_{s,a}^{\\textnormal{train}}')
('6.0.0', 'x \\sim X')
('6.0.0', 'f_x')
('6.0.0', "s' \\sim p_{s,a}^{\\textnormal{train}}")
('6.0.0', "\\tilde{s}' = f_x(s,s')")
('6.0.0', 'p_{s,a}(x)')
('6.0.0', '\\mathcal{S} = \\mathbb{R}^d')
('6.0.0', 'x \\sim U([-2\\epsilon,2\\epsilon]^d)')
('6.0.0', "f_x(s,s') = s + (s' - s)(1+x),")
('6.0.0', 'x \\sim U([-2\\epsilon,2\\epsilon]^d)')
('6.0.0', '\\epsilon')
('6.0.0', '\\epsilon')
('6.0.0', '\\mu_{s,a}')
('6.0.0', '\\epsilon')
('6.0.0', 'f_x')
('6.0.0', '\\epsilon')
('6.0.0', '\\mu_{s,a}')
('6.0.0', '\\pi_0')
('6.0.0', 'Q_{\\theta_r}, Q_{\\theta_c}')
('6.0.0', '\\rho^+,\\rho')
('6.0.0', 'X')
('6.0.0', '\\tau \\sim (\\pi_k,p^{\\textnormal{train}})')
('6.0.0', '\\mathcal{D}')
('6.0.0', "(s,a,r,c,s') \\sim \\mathcal{D}")
('6.0.0', 'n')
('6.0.0', 'x_i \\sim X')
('6.0.0', "f_{x_i}(s,s')")
('6.0.0', 'Q_{\\theta_r}, Q_{\\theta_c}')
('6.0.0', '\\mathcal{L}^+(\\theta_r), \\mathcal{L}(\\theta_c)')
('6.0.0', '\\pi')
('6.0.0.0', 'x \\sim X')
('6.0.0.0', "f_x(s,s')")
('7', '1{,}000')
('7', 'r(s,a) \\in [0,1]')
('7', 'c(s,a) \\in \\left\\lbrace 0,1 \\right\\rbrace')
('7', 'B=100')
('7', '\\dag')
('7', '\\eta=0.75')
('7', 'n=5')
('7', '\\epsilon=0.10')
('7.0.0', '\\mu')
('8', '\\mu')
('8', '\\rho')
('8', '\\mu')
('8', '\\rho')
('8', '\\mu')
('9', "Z,Z' \\in \\mathcal{Z}")
('9', "Z \\leq Z'")
('9', "\\rho(Z) \\leq \\rho(Z')")
('9', '\\alpha \\in \\mathbb{R}')
('9', 'Z \\in \\mathcal{Z}')
('9', '\\rho(Z+\\alpha) = \\rho(Z) + \\alpha')
('9', '\\tau \\geq 0')
('9', 'Z \\in \\mathcal{Z}')
('9', '\\rho(\\tau Z) = \\tau \\rho(Z)')
('9', '\\lambda \\in [0,1]')
('9', "Z,Z' \\in \\mathcal{Z}")
('9', "\\rho(\\lambda Z + (1-\\lambda) Z') \\leq \\lambda \\rho(Z) + (1-\\lambda) \\rho(Z')")
('9', "Z,Z' \\in \\mathcal{Z}")
('9', "\\rho(Z+Z') = \\rho(Z) + \\rho(Z')")
('9', "Z,Z' \\in \\mathcal{Z}")
('9', "\\rho(Z) = \\rho(Z')")
('9', '\\rho')
('9', 'Z \\in \\mathcal{Z}')
('9', '\\rho(Z) = \\sup_{\\beta_{s,a} \\in \\mathcal{U}_{s,a}} \\mathbb{E}_{\\beta_{s,a}} \\left[ Z \\right],')
('9', '\\mathbb{E}_{\\beta_{s,a}} \\left[ \\, \\cdot \\, \\right]')
('9', '\\beta_{s,a} \\in P(\\mathcal{M})')
('9', '\\mathcal{U}_{s,a}  \\subseteq \\left\\lbrace \\beta_{s,a} \\in P(\\mathcal{M}) \\mid \\beta_{s,a} = \\xi_{s,a} \\mu_{s,a}, \\,\\, \\xi_{s,a} \\in \\mathcal{Z}^*  \\right\\rbrace')
('9', '\\rho')
('10', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10', '\\rho^+(Z) = - \\rho(-Z)')
('10', '\\rho')
('10.0', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.0', "\\begin{aligned}\n\\mathcal{T}^{\\pi}_{\\rho,c} Q(s,a) &= c(s,a) + \\gamma \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right) \\\\\n&= c(s,a) + \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\gamma \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right) \\\\\n&= \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( c(s,a) +  \\gamma \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right) \\\\\n&= \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathcal{T}^{\\pi}_{p,c} Q(s,a) \\right),\n\\end{aligned}")
('10.0', '\\rho')
('10.0', '\\rho')
('10.0', '\\mathcal{T}^{\\pi}_{p,c}')
('10.1', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.1', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.1', "\\begin{aligned}\n\\mathcal{T}^{\\pi}_{\\rho,c} Q(s,a) &= \\mathop{\\rho}_{p_{s,a} \\sim \\mu_{s,a}} \\left( \\mathcal{T}^{\\pi}_{p,c} Q(s,a) \\right) \\\\\n&= \\sup_{\\beta_{s,a} \\in \\mathcal{U}_{s,a}} \\,\\,  \\mathop{\\mathbb{E}}_{p_{s,a} \\sim \\beta_{s,a}} \\left[ \\mathcal{T}^{\\pi}_{p,c} Q(s,a) \\right] \\\\\n&= c(s,a) + \\gamma \\sup_{\\beta_{s,a} \\in \\mathcal{U}_{s,a}} \\,\\,  \\mathop{\\mathbb{E}}_{p_{s,a} \\sim \\beta_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right],\n\\end{aligned}")
('10.1', '\\mathcal{U}_{s,a}')
('10.1', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.1', '\\mathcal{U} = \\bigotimes_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mathcal{U}_{s,a}')
('10.1', 'Q^{\\pi}_{\\rho,c}(s,a)')
('10.1', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.1', '\\mathcal{U}')
('10.1', '\\mathcal{U}')
('10.1', 'Q^{\\pi}_{\\rho,c}(s,a) = \\sup_{\\beta \\in \\mathcal{U}} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ Q^{\\pi}_{p,c}(s,a) \\right].')
('10.1', 'J_{\\rho,c}(\\pi)')
('10.1', '\\begin{aligned}\n    J_{\\rho,c}(\\pi) &= \\mathop{\\mathbb{E}}_{s \\sim d_0} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ Q^{\\pi}_{\\rho,c}(s,a) \\right] \\right] \\\\\n    &= \\mathop{\\mathbb{E}}_{s \\sim d_0} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ \\, \\sup_{\\beta \\in \\mathcal{U}} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ Q^{\\pi}_{p,c}(s,a) \\right] \\right] \\right] \\\\\n    &= \\sup_{\\beta \\in \\mathcal{U}} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ \\mathop{\\mathbb{E}}_{s \\sim d_0} \\left[ \\mathop{\\mathbb{E}}_{a \\sim \\pi(\\cdot \\mid s)} \\left[ Q^{\\pi}_{p,c}(s,a) \\right] \\right] \\right] \\\\\n    &= \\sup_{\\beta \\in \\mathcal{U}} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ J_{p,c}(\\pi) \\right],\n\\end{aligned}')
('10.1', '\\mathcal{U}')
('10.1', '\\mathcal{T}^{\\pi}_{\\rho^+,r}')
('10.1', '\\mathcal{U}^+ = \\bigotimes_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mathcal{U}^+_{s,a}')
('10.1', 'J_{\\rho^+,r}(\\pi) = \\inf_{\\beta \\in \\mathcal{U}^+} \\, \\mathop{\\mathbb{E}}_{p \\sim \\beta} \\left[ J_{p,r}(\\pi) \\right].')
('10.2', '\\mathcal{T}^{\\pi}_{\\rho^+,r}')
('10.2', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.2', '\\beta_{s,a} \\in \\mathcal{U}_{s,a}')
('10.2', "\\mathop{\\mathbb{E}}_{p_{s,a} \\sim \\beta_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right] = \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{\\beta}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right],")
('10.2', '\\bar{p}^{\\beta}_{s,a} = \\mathbb{E}_{p_{s,a} \\sim \\beta_{s,a}} \\left[ p_{s,a} \\right] \\in P(\\mathcal{S})')
('10.2', '\\beta_{s,a}')
('10.2', "\\begin{aligned}\n\\mathcal{T}^{\\pi}_{\\rho,c} Q(s,a) &= c(s,a) + \\gamma \\sup_{\\beta_{s,a} \\in \\mathcal{U}_{s,a}} \\,\\,  \\mathop{\\mathbb{E}}_{p_{s,a} \\sim \\beta_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{s' \\sim p_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right] \\right] \\\\\n&= c(s,a) + \\gamma \\sup_{\\bar{p}^{\\beta}_{s,a} \\in \\mathcal{P}_{s,a}} \\,  \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{\\beta}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q(s',a')  \\right] \\right],\n\\end{aligned}")
('10.2', '\\mathcal{P}_{s,a} = \\left\\lbrace \\bar{p}^{\\beta}_{s,a} \\in P(\\mathcal{S}) \\mid \\bar{p}^{\\beta}_{s,a} = \\mathop{\\mathbb{E}}_{p_{s,a} \\sim \\beta_{s,a}} \\left[ p_{s,a} \\right], \\,\\, \\beta_{s,a} \\in \\mathcal{U}_{s,a} \\right\\rbrace.')
('10.2', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.2', '\\mathcal{P} = \\bigotimes_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\mathcal{P}_{s,a}')
('10.2', 'Q^{(1)}')
('10.2', 'Q^{(2)}')
('10.2', '\\Vert Q^{(1)} - Q^{(2)}  \\Vert_{\\infty} = \\sup_{(s,a) \\in \\mathcal{S} \\times \\mathcal{A}} \\left| Q^{(1)}(s,a) - Q^{(2)}(s,a) \\right|.')
('10.2', '\\epsilon > 0')
('10.2', '(s,a) \\in \\mathcal{S} \\times \\mathcal{A}')
('10.2', '\\bar{p}_{s,a}^{(1)} \\in \\mathcal{P}_{s,a}')
('10.2', "\\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{(1)}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(1)}(s',a')  \\right] \\right] \\geq \\sup_{\\bar{p}^{\\beta}_{s,a} \\in \\mathcal{P}_{s,a}} \\,  \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{\\beta}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(1)}(s',a')  \\right] \\right] - \\epsilon.")
('10.2', "\\begin{aligned}\n&\\mathcal{T}^{\\pi}_{\\rho,c} Q^{(1)}(s,a) - \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(2)}(s,a) \\\\\n& = \\gamma \\left( \\sup_{\\bar{p}^{\\beta}_{s,a} \\in \\mathcal{P}_{s,a}} \\,  \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{\\beta}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(1)}(s',a')  \\right] \\right] - \\sup_{\\bar{p}^{\\beta}_{s,a} \\in \\mathcal{P}_{s,a}} \\,  \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{\\beta}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(2)}(s',a')  \\right] \\right] \\right) \\\\\n& \\leq \\gamma \\left( \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{(1)}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(1)}(s',a')  \\right] \\right] + \\epsilon - \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{(1)}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(2)}(s',a')  \\right] \\right] \\right) \\\\\n& = \\gamma \\mathop{\\mathbb{E}}_{s' \\sim \\bar{p}^{(1)}_{s,a}} \\left[ \\mathop{\\mathbb{E}}_{a' \\sim \\pi(\\cdot \\mid s')} \\left[ Q^{(1)}(s',a') - Q^{(2)}(s',a')  \\right] \\right] + \\gamma \\epsilon \\\\\n& \\leq \\gamma \\Vert Q^{(1)} - Q^{(2)}  \\Vert_{\\infty} + \\gamma \\epsilon.\n\\end{aligned}")
('10.2', '-\\gamma \\Vert Q^{(1)} - Q^{(2)}  \\Vert_{\\infty} - \\gamma \\epsilon \\leq \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(1)}(s,a) - \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(2)}(s,a),')
('10.2', '\\left| \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(1)}(s,a) - \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(2)}(s,a) \\right| \\leq \\gamma \\Vert Q^{(1)} - Q^{(2)}  \\Vert_{\\infty} + \\gamma \\epsilon.')
('10.2', '\\Vert \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(1)} - \\mathcal{T}^{\\pi}_{\\rho,c} Q^{(2)} \\Vert_{\\infty} \\leq \\gamma \\Vert Q^{(1)} - Q^{(2)}  \\Vert_{\\infty} + \\gamma \\epsilon.')
('10.2', '\\epsilon > 0')
('10.2', '\\mathcal{T}^{\\pi}_{\\rho,c}')
('10.2', '\\gamma')
('11.0', 'B=100')
('11.0', '\\left[0,1\\right]')
('11.0', '[0.15,0.20,0.25,0.30]')
('11.0', '\\left[ 0.75, 1.25 \\right]')
('11.0', '\\left[ 0.10, 0.50 \\right]')
('11.0', '1{,}000')
('11.0', '\\left[ 500, 1{,}500 \\right]')
('11.0.0', '\\left[ 0.875, 1.125 \\right]')
('11.0.0', '\\left[ 0.20, 0.40 \\right]')
('11.0.0', '1{,}000')
('11.0.0', '\\left[ 750, 1{,}250 \\right]')
('11.0.0', '\\left[ 0.05, 0.15 \\right]')
('11.0.0', '\\left[ 0.40, 1.00 \\right]')
('11.0.0', '\\left[ 1.00, 2.00 \\right]')
('11.0.0.1', '\\pi(a \\mid s) = \\mathcal{N}(\\mu(s),\\Sigma(s))')
('11.0.0.1', '\\mu(s)')
('11.0.0.1', '\\Sigma(s)')
('11.0.0.1', '\\Sigma(s)')
('11.0.0.1', '\\tau=5\\textnormal{e-}3')
('11.0.0.1', '\\epsilon_{\\textnormal{KL}}')
('11.0.0.1', '\\beta_{\\mu}')
('11.0.0.1', '\\beta_{\\Sigma}')
('11.0.0.1', '\\epsilon')
('11.0.0.1', '\\mu_{s,a}')
('11.0.0.1', '\\epsilon \\in \\left[ 0.05, 0.10, 0.15, 0.20 \\right]')
('11.0.0.1', '\\epsilon')
('11.0.0.1', '\\epsilon')
('11.0.0.1', '\\epsilon = 0.10')
('11.0.0.1', 'n=5')
('11.0.0.1', '\\gamma')
('11.0.0.1', '\\tau')
('11.0.0.1', '\\epsilon_{\\textnormal{KL}}')
('11.0.0.1', '\\beta_{\\mu}')
('11.0.0.1', '\\beta_{\\Sigma}')
('11.0.0.1', 'n')
('11.0.0.1', '\\epsilon')
('11.0.0.1', '\\epsilon')
('11.0.0.1', '\\eta=0.75')
