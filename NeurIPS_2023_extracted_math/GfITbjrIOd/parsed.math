('1', 'q')
('1', 'q')
('1', 'q')
('1', 'q')
('1', 'x')
('1', 'q')
('1', 'q')
('1', 'C')
('1.0', 'C')
('1.0', 'C')
('2.0', 'X')
('2.0', 'Y')
('2.0', 'X \\in {\\mathcal{X}}')
('2.0', 'Y \\in {\\mathcal{Y}}')
('2.0', '{\\mathcal{Y}}= \\lbrace (1, 0, \\cdots, 0), (0, 1, \\cdots, 0), \\cdots, (0, 0, \\cdots, 1) \\rbrace')
('2.0', 'y \\in {\\mathcal{Y}}')
('2.0', 'C \\in {\\mathbb{N}}')
('2.0', '{\\mathcal{Y}}= \\lbrace 1, 2, \\cdots, C \\rbrace')
('2.0', 'y')
('2.0', '\\hat{p}: {\\mathcal{X}}\\to \\Delta^C')
('2.0', '\\Delta^C')
('2.0', 'C')
('2.0', '{\\hat{p}}')
('2.0', '\\lbrace {\\hat{p}}(x) \\vert x \\in {\\mathcal{X}}\\rbrace')
('2.0', 'p^*: {\\mathcal{X}}\\to \\Delta^C')
('2.0', 'p^*(x) = {\\mathbb{E}}[Y \\mid X= x] \\in \\Delta^C')
('2.0', 'c \\in [C]')
('2.0', 'p^*(x)_c = \\Pr[Y_c \\mid X = x]')
('2.1', '{\\mathcal{A}}')
('2.1', '\\ell: {\\mathcal{Y}}\\times {\\mathcal{A}}\\to {\\mathbb{R}}')
('2.1', 'X')
('2.1', '({\\mathcal{A}}, \\ell)')
('2.1', '\\ell')
('2.1', '{\\mathcal{A}}')
('2.1', '\\ell')
('2.1', '{\\mathcal{L}_{\\mathrm{all}}}= \\lbrace\\ell: {\\mathcal{Y}}\\times {\\mathcal{A}}\\to \\mathbb{R} \\rbrace')
('2.1', '{\\mathcal{A}}')
('2.1', '{\\mathcal{A}}\\in \\lbrace [1], [2], \\cdots, [K], \\cdots, {\\mathbb{N}}, {\\mathbb{R}}\\rbrace')
('2.1', '[K] = \\lbrace 1, \\cdots, K \\rbrace')
('2.2', '{\\hat{p}}(X)')
('2.2', 'Y')
('2.2', '{\\mathcal{A}}')
('2.2', '\\delta: \\Delta^C \\to {\\mathcal{A}}')
('2.2', '{\\drule_{\\mathrm{all}}}')
('2.2', '\\ell \\in {\\mathcal{L}_{\\mathrm{all}}}')
('2.2', '{\\mathcal{A}}')
('2.2', '{\\hat{p}}')
('2.2', '\\delta_\\ell({\\hat{p}}(x)) = \\arg\\inf_{a \\in {\\mathcal{A}}} {\\mathbb{E}}_{{\\hat{Y}}\\sim {\\hat{p}}(x)} [\\ell({\\hat{Y}}, a)]')
('2.2', '{\\mathcal{L}}\\subset {\\mathcal{L}_{\\mathrm{all}}}')
('2.2', '\\drule_{\\mathcal{L}}:= \\lbrace \\delta_\\ell, \\ell \\in {\\mathcal{L}}\\rbrace')
('3', '{\\hat{p}}')
('3', '\\ell')
('3', '{\\hat{p}}(X) = p^*(X)')
('3', '{\\mathcal{L}}\\subset {\\mathcal{L}_{\\mathrm{all}}}')
('3.0', '{\\hat{p}}')
('3.0', '\\ell')
('3.0', '\\delta_\\ell')
('3.0', '\\hat{p}')
('3.0', '\\delta_\\ell')
('3.0', '\\ell')
('3.0', '\\delta \\in {\\drule_{\\mathrm{all}}}')
('3.0', '\\delta')
('3.0', '\\hat{p}')
('3.0', '{\\mathcal{L}}\\subset {\\mathcal{L}_{\\mathrm{all}}}')
('3.0', '\\drule \\subset {\\drule_{\\mathrm{all}}}:= \\lbrace \\Delta^C \\to {\\mathcal{A}}\\rbrace')
('3.0', '{\\hat{p}}')
('3.0', '({\\mathcal{L}};\\drule)')
('3.0', 'p^*')
('3.0', '\\forall \\ell \\in {\\mathcal{L}}')
('3.0', '\\delta \\in \\drule')
('3.0', '{\\mathcal{A}}')
('3.0', '\\ell')
('3.0', '\\delta')
('3.0', '{\\mathcal{A}}')
('3.0', '\\ell')
('3.0', '\\drule')
('3.0', '{\\mathcal{A}}')
('3.0', '\\begin{aligned}\n    {\\mathbb{E}}_X {\\mathbb{E}}_{{\\hat{Y}}\\sim {\\hat{p}}(X)} [\\ell({\\hat{Y}}, \\delta({\\hat{p}}(X))) ] = {\\mathbb{E}}_X {\\mathbb{E}}_{Y \\sim p^*(X)} [\\ell(Y, \\delta({\\hat{p}}(X))) ] \\label{eq:equal_loss}\n\\end{aligned}')
('3.0', '{\\hat{p}}')
('3.0', '{\\mathcal{L}}')
('3.0', '({\\mathcal{L}};\\drule_{\\mathcal{L}})')
('3.0', '{\\hat{Y}}')
('3.0', 'X')
('3.0', 'Y')
('3.0', '\\delta')
('3.0', '{\\mathcal{L}}')
('3.0', '\\drule')
('3.0', 'X,Y')
('3.0', 'X')
('3.0', '\\delta \\in {\\drule_{\\mathrm{all}}}')
('3.0', 'X')
('3.0', '{\\hat{p}}(X)')
('3.0', 'X')
('3.0', '{\\mathcal{L}}')
('3.0', '{\\mathcal{L}}')
('3.0', '\\drule_{\\mathcal{L}}')
('3.0', '{\\mathcal{L}}')
('3.0', '{\\mathcal{L}}')
('3.0', '{\\hat{p}}')
('3.0', '{\\mathcal{L}}')
('3.0', "\\begin{aligned}\n    \\forall \\delta' \\in \\drule_{\\mathcal{L}}, &{\\mathbb{E}}_X{\\mathbb{E}}_{Y \\sim p^*(X)}[\\ell(Y, \\delta_\\ell({\\hat{p}}(X))) ] \\leq {\\mathbb{E}}_X{\\mathbb{E}}_{Y \\sim p^*(X)}[\\ell(Y, \\delta'({\\hat{p}}(X))) ]  & \\text{(No regret)} \\\\\n   & {\\mathbb{E}}_X {\\mathbb{E}}_{{\\hat{Y}}\\sim {\\hat{p}}(X)} [\\ell({\\hat{Y}}, \\delta_{\\ell}({\\hat{p}}(X))) ] = {\\mathbb{E}}_X {\\mathbb{E}}_{Y \\sim p^*(X)} [\\ell(Y, \\delta_{\\ell}({\\hat{p}}(X))) ] & \\text{(Accurate loss estimation)} \n\\end{aligned}")
('3.0', '\\delta_\\ell')
('3.0', "\\delta' \\in \\drule_{{\\mathcal{L}}}")
('3.0', '\\hat{p}')
('3.0', "\\delta'")
('3.0', "\\ell' \\in {\\mathcal{L}}")
('3.0', '\\delta_\\ell')
('3.0', 'Y')
('3.0', '{\\mathcal{L}}')
('3.0', '{\\mathcal{L}}')
('3.0', '\\ell')
('3.0', '{\\mathcal{L}}')
('3.0', '\\delta_\\ell')
('3.0', '\\drule_{\\mathcal{L}}')
('3.1', '{\\mathcal{L}}')
('3.1', '\\beta')
('3.1', '\\beta')
('3.1', '\\begin{aligned}\n    \\Pr[Y = \\arg\\max {\\hat{p}}(X) \\mid \\max {\\hat{p}}(X) = \\beta] = \\beta.\n\\end{aligned}')
('3.1', '{\\hat{p}}')
('3.1', '{\\mathcal{L}}_r')
('3.1', '{\\mathcal{L}}_r')
('3.1', '\\begin{aligned}\n    {\\mathcal{L}}_r := \\left\\lbrace \n    \\ell(y, a) = \\mathbb{I}(y \\neq a \\land a \\neq \\bot) + \\beta \\cdot \\mathbb{I}(a = \\bot) :\n    a \\in {\\mathcal{Y}}\\cup \\lbrace \\bot \\rbrace, \\forall \\beta \\in [0, 1]   \\right\\rbrace\n\\end{aligned}')
('3.1', '{\\mathcal{L}}_r')
('3.1', '\\bot')
('3.1', '0')
('3.1', 'y')
('3.1', '1')
('3.1', '\\beta < 1')
('3.1', '{\\mathcal{L}}_r')
('3.1', '{\\hat{p}}')
('3.1', '{\\hat{p}}')
('3.1', '{\\mathcal{L}}')
('3.1', '\\begin{array}{l} \\text{Confidence Calibration \\citep{guo2017calibration}} \\\\ \\Pr[Y = \\arg\\max {\\hat{p}}(X) \\mid \\max {\\hat{p}}(X) = \\beta] = \\beta \\\\ \\forall \\beta \\in [0, 1] \\end{array}')
('3.1', '{\\mathcal{L}}_r := \\left\\lbrace \\begin{array}{ll}   \n    \\ell(y, a) = \\mathbb{I}(y \\neq a \\land a \\neq \\bot) + \\beta \\cdot \\mathbb{I}(a = \\bot) : \\\\\n    a \\in {\\mathcal{Y}}\\cup \\lbrace \\bot \\rbrace, \\forall \\beta \\in [0, 1] \\end{array}  \\right\\rbrace')
('3.1', '\\begin{array}{l} \\text{Classwise Calibration \\citep{kull2019beyond}} \\\\\n    {\\mathbb{E}}[Y_c \\mid \\hat{p}_c(X) = \\beta] = \\beta, \\forall c \\in [C], \\forall \\beta \\in [0, 1]\n \\end{array}')
('3.1', '{\\mathcal{L}}_{cr} := \\left\\lbrace \\begin{array}{l} \n \\ell_c(y, a) = \\mathbb{I}(a = \\bot) + \\beta_1 \\cdot \\mathbb{I}(y = c \\land a = T) \\\\\n \\qquad\\qquad\\qquad + \\beta_2 \\cdot \\mathbb{I}(y \\neq c \\land a = F) :\\\\\n a \\in  \\lbrace T, F, \\bot \\rbrace,\n \\forall \\beta_1, \\beta_2 \\in \\mathbb{R}, c \\in [C] \\end{array} \\right\\rbrace')
('3.1', '\\begin{array}{l} \\text{Distribution Calibration \\citep{kull2015novel} } \\\\ {\\mathbb{E}}[Y \\mid {\\hat{p}}(X) = q] = q, \\forall q \\in \\Delta^C \\end{array}')
('3.1', '{\\mathcal{L}}_{\\text{all}} = \\lbrace\\ell:{\\mathcal{Y}}\\times {\\mathcal{A}}\\mapsto \\mathbb{R} \\rbrace')
('3.1', 'p^*')
('3.1', '{\\mathcal{L}}_r, {\\mathcal{L}}_{cr}')
('3.1', '{\\hat{p}}')
('3.1', '{\\mathcal{L}}_r')
('3.1', '{\\mathcal{L}}_{cr}')
('3.1', '{\\mathcal{L}}_{\\text{all}}')
('3.1', '{\\mathcal{L}}_r')
('3.1', '{\\mathcal{L}}_{\\text{cr}}')
('3.1', '{\\mathbb{E}}[Y \\mid {\\hat{p}}(X) = q] = q, \\forall q \\in \\Delta^C')
('3.1', '{\\mathcal{L}_{\\mathrm{all}}}')
('3.1', '{\\hat{p}}')
('3.1', '{\\mathbb{E}}[Y \\mid {\\hat{p}}(X) = q]')
('3.1', 'q')
('3.1', '{\\hat{p}}')
('3.1', '{\\hat{p}}')
('3.1', '{\\hat{p}}')
('3.1', 'x')
('3.1', 'q_0')
('3.1', '{\\hat{p}}(x) = q_0, \\forall x \\in {\\mathcal{X}}')
('3.1', '{\\mathcal{L}_{\\mathrm{all}}}')
('3.1', '\\ell: {\\mathcal{Y}}\\times {\\mathcal{A}}\\to {\\mathbb{R}}')
('3.1', '{\\mathcal{A}}')
('3.1', '|{\\mathcal{A}}| = 2^C')
('3.1', '\\delta\\in \\drule_{{\\mathcal{L}_{\\mathrm{all}}}}: \\Delta^C \\to {\\mathcal{A}}')
('3.1', '\\Delta^C')
('3.2', '{\\mathcal{L}}^K')
('3.2', 'K \\in {\\mathbb{N}}')
('3.2', 'K')
('3.2', '{\\mathcal{L}}^K')
('3.2', '{\\mathcal{L}}^K')
('3.2', '{\\mathcal{L}}^K')
('3.2', 'K')
('3.2', '{\\mathcal{L}}^K = \\lbrace \\ell: {\\mathcal{Y}}\\times {\\mathcal{A}}\\to {\\mathbb{R}}, |{\\mathcal{A}}| = K \\rbrace')
('3.2', '{\\hat{p}}')
('3.2', '{\\mathcal{L}}^K')
('3.2', 'p^*')
('3.2', '\\forall \\ell \\in {\\mathcal{L}}^K')
('3.2', '\\delta \\in \\drule_{{\\mathcal{L}}^K}')
('3.2', '\\begin{aligned}\n    {\\mathbb{E}}_X {\\mathbb{E}}_{{\\hat{Y}}\\sim {\\hat{p}}(X)} [\\ell({\\hat{Y}}, \\delta({\\hat{p}}(X))) ] = {\\mathbb{E}}_X {\\mathbb{E}}_{Y \\sim p^*(X)} [\\ell(Y, \\delta({\\hat{p}}(X))) ] \\label{eq:equal_loss}\n\\end{aligned}')
('3.2', '{\\mathcal{L}}^K')
('3.2', '{\\mathcal{L}}^K')
('3.2', 'K')
('3.2', '\\hat{p}')
('3.2', '{\\hat{p}}')
('3.2', '{\\mathcal{L}}^K')
('3.2.0', '{\\mathcal{L}}^K')
('3.2.0', '{\\mathcal{L}}^K')
('3.2.0', '{\\hat{p}}')
('3.2.0', '\\ell \\in {\\mathcal{L}}^K')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '\\delta_\\ell({\\hat{p}}(x)) = \\delta_\\ell({\\hat{p}}_\\ell(x))')
('3.2.0', '\\ell')
('3.2.0', '{\\hat{p}}')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '\\hat{p}')
('3.2.0', '\\hat{p}_\\ell')
('3.2.0', '{\\hat{p}}')
('3.2.0', '\\ell')
('3.2.0', 'K')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '\\ell')
('3.2.0', '\\ell')
('3.2.0', '{\\hat{p}}')
('3.2.0', '\\ell')
('3.2.0', 'K')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '{\\mathcal{L}}^K')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '\\ell \\in {\\mathcal{L}}^K')
('3.2.0', '{\\hat{p}}')
('3.2.0', '{\\mathcal{L}}^K')
('3.2.0', '\\ell \\in {\\mathcal{L}}^K')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '\\le K')
('3.2.0', '{\\hat{p}}_\\ell')
('3.2.0', '\\delta_\\ell({\\hat{p}}_\\ell(x)) = \\delta_\\ell({\\hat{p}}(x))')
('3.2.0', 'x \\in {\\mathcal{X}}')
('3.2.0', '{\\mathbb{E}}[\\ell(Y,\\delta_\\ell({\\hat{p}}_\\ell(X)))] = {\\mathbb{E}}[\\ell(Y,\\delta_\\ell({\\hat{p}}(X)))]')
('4.0', 'y \\in {\\mathcal{Y}}')
('4.0', 'a \\in {\\mathcal{A}}')
('4.0', '\\ell')
('4.0', '\\max_a \\lVert \\ell(\\cdot, a) \\rVert_2 := \\max_a \\sqrt{\\sum_{y \\in {\\mathcal{Y}}} \\ell(y, a)^2}')
('4.0', 'p')
('4.0', 'C')
('4.0', 'p')
('4.0', '{\\hat{p}}')
('4.0', '({\\mathcal{L}}, \\epsilon')
('4.0', 'p^*')
('4.0', '\\forall \\ell \\in {\\mathcal{L}}')
('4.0', '\\delta \\in \\drule_{\\mathcal{L}}')
('4.0', '\\begin{aligned}\n    \\left\\lvert {\\mathbb{E}}[\\ell({\\hat{Y}}, \\delta({\\hat{p}}(X))) ] - {\\mathbb{E}}[\\ell(Y, \\delta({\\hat{p}}(X))) ]  \\right\\rvert \\leq \\epsilon \\sup_{a \\in {\\mathcal{A}}} \\lVert \\ell(\\cdot, a) \\rVert_2\n\\end{aligned}')
('4.0', '({\\mathcal{L}}, 0)')
('4.0', '{\\mathcal{L}}')
('4.0', 'K')
('4.0', '({\\mathcal{L}}^K,\\epsilon)')
('4.0', '{\\hat{p}}')
('4.0', 'K, C, 1/\\epsilon')
('4.0', '{\\hat{p}}')
('4.0', '({\\mathcal{L}}^K,\\epsilon)')
('4.0', "{\\hat{p}}'")
('4.0', '({\\mathcal{L}}^K,\\epsilon)')
('4.0', 'L_2')
('4.0', '{\\hat{p}}(x) \\equiv {\\mathbb{E}}[Y], \\forall x')
('4.0', '({\\mathcal{L}}^K,0)')
('4.0', 'L_2')
('4.0', 'L_2')
('4.0', "{\\hat{p}}'")
('4.0', "{\\mathbb{E}}[\\lVert {\\hat{p}}'(X) - Y \\rVert_2^2] \\leq {\\mathbb{E}}[\\lVert {\\hat{p}}(X) - Y \\rVert_2^2]")
('4.0', 'L_2')
('4.1', '({\\mathcal{L}}^K, \\epsilon)')
('4.1', '\\begin{aligned}\n \\sup_{\\delta \\in \\drule_{{\\mathcal{L}}^K}}   \\sup_{\\ell \\in {\\mathcal{L}}^K}  \\left\\lvert {\\mathbb{E}}[\\ell({\\hat{Y}}, \\delta({\\hat{p}}(X))) ] - {\\mathbb{E}}[\\ell(Y, \\delta({\\hat{p}}(X))) ]  \\right\\rvert / \\left( \\sup_{a \\in {\\mathcal{A}}} \\lVert \\ell(\\cdot, a) \\rVert_2 \\right)\n\\end{aligned}')
('4.1', '\\epsilon')
('4.1.0', '{\\mathcal{L}}^K')
('4.1.0', '\\delta \\in \\drule')
('4.1.0', '\\begin{aligned}\n  \\sup_{\\ell \\in {\\mathcal{L}}^K}  \\frac{\\left\\lvert {\\mathbb{E}}[\\ell({\\hat{Y}}, \\delta({\\hat{p}}(X))) ] - {\\mathbb{E}}[\\ell(Y, \\delta({\\hat{p}}(X))) ]  \\right\\rvert }{\\sup_{a \\in {\\mathcal{A}}} \\lVert \\ell(\\cdot, a) \\rVert_2} =  \\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[ ({\\hat{Y}}- Y) \\mathbb{I}(\\delta({\\hat{p}}(X)) = a) ] \\right\\rVert_2  \\label{eq:norm_calibration}\n\\end{aligned}')
('4.1.0', '\\delta')
('4.1.0', '\\Delta^C')
('4.1.0', '\\Delta_1 := \\lbrace q \\in \\Delta^C, \\mathbb{I}(\\delta(q) = 1) \\rbrace, \\cdots, \\Delta_K := \\lbrace q \\in \\Delta^C, \\mathbb{I}(\\delta(q) = K) \\rbrace')
('4.1.0', '\\Delta_k')
('4.1.0', '{\\mathbb{E}}[ ({\\hat{Y}}- Y) \\mathbb{I}({\\hat{p}}(X) \\in \\Delta_k)]')
('4.1.0.0', '\\Delta^C')
('4.1.0.0', "\\begin{aligned}\n    {B^K}= \\left\\lbrace b_w \\mid \\forall w \\in {\\mathbb{R}}^{K \\times C} \\right\\rbrace\\label{eq:bk_def}&&\n    \\textrm{where~~}b_w(q,a) = {\\mathbb{I}}(a = \\arg\\sup_{a' \\in [K]} \\langle q, w_{a'}\\rangle)\n\\end{aligned}")
('4.1.0.0', 'Y')
('4.1.0.0', 'X')
('4.1.0.0', 'w')
('4.1.0.0', 'q \\in \\Delta^C')
('4.1.0.0', 'a')
('4.1.0.0', 'b_w')
('4.1.0.0', 'b_w(q, a)=1')
('4.1.0.0', 'q')
('4.1.0.0', 'a')
('4.1.0.0', '0')
('4.1.0.0', '\\begin{aligned}\n    \\sup_{\\delta \\in \\drule_{{\\mathcal{L}}^K}} \\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[ ({\\hat{Y}}- Y) \\mathbb{I}(\\delta({\\hat{p}}(X))) = a) ] \\right\\rVert_2 = \\sup_{b \\in {B^K}}\\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[ ({\\hat{Y}}- Y) b({\\hat{p}}(X), a) ] \\right\\rVert_2\n\\end{aligned}')
('4.1.0.0', '{\\hat{p}}')
('4.1.0.0', '({\\mathcal{L}}^K, \\epsilon)')
('4.1.0.0', '\\begin{aligned}\n    %\\sup_{b \\in \\critic}\\sum_{a=1}^K \\left\\lVert \\Eb [ (\\hp(X) - p^*(X)) b(\\hp(X), a) ] \\right\\rVert_2  = \n    \\sup_{b \\in {B^K}}\\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[ ({\\hat{Y}}- Y) b({\\hat{p}}(X), a) ] \\right\\rVert_2 \\leq \\epsilon \\label{eq:decision_calibration_equivalent}\n\\end{aligned}')
('4.1.0.0', '{\\hat{p}}')
('4.1.0.0', '\\Delta^C')
('4.1.0.0', 'K')
('4.1.0.0', '{\\hat{Y}}- Y')
('4.1.0.0', '{\\hat{p}}(X) - p^*(X)')
('4.1.0.0', 'B^K')
('4.1.0.0', 'B^K')
('4.2', '{\\hat{p}}')
('4.2', 'b \\in B^K')
('4.2', '{\\hat{p}}')
('4.2', 'b')
('4.2', '(B^K, \\epsilon)')
('4.2', '{\\hat{p}}')
('4.2', '\\epsilon')
('4.2', '{\\hat{p}}^{(0)} = {\\hat{p}}')
('4.2', 'N')
('4.2', '{\\hat{p}}')
('4.2', '\\epsilon')
('4.2', 'O(K/\\epsilon^2)')
('4.2', '\\lambda > 0')
('4.2', 'O(\\text{poly}(K, C, \\log(1/\\delta), \\lambda))')
('4.2', '1-\\delta')
('4.2', '({\\mathcal{L}}^K, \\epsilon+\\lambda)')
('4.2', "{\\hat{p}}'")
('4.2', "{\\mathbb{E}}[\\lVert {\\hat{p}}'(X) - Y \\rVert_2^2] \\leq {\\mathbb{E}}[\\lVert {\\hat{p}}(X) - Y \\rVert_2^2] + \\lambda")
('4.2', 'B^K')
('4.3', '{B^K}')
('4.3', "\\begin{aligned}\n    {\\bar{B}^K}= \\left\\lbrace \\bar{b}_w \\mid \\forall w \\in {\\mathbb{R}}^{K \\times C} \\right\\rbrace&&\n    \\textrm{where~~}\\bar{b}_w(q,a) = \\frac{e^{\\langle q, w_a\\rangle}}{\\sum_{a'} e^{\\langle q, w_{a'} \\rangle}}\n\\end{aligned}")
('4.3', '\\bar{b}_w \\in {\\bar{B}^K}')
('4.3', 'w')
('4.3', '{\\bar{B}^K}')
('4.3', '{B^K}')
('4.3', '{\\bar{B}^K}')
('4.3', '{\\hat{p}}')
('4.3', '({\\mathcal{L}}^K, \\epsilon)')
('4.3', '\\begin{aligned}\n     \\sup_{\\bar{b} \\in {\\bar{B}^K}}\\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[ ({\\hat{Y}}- Y) \\bar{b}({\\hat{p}}(X), a) ] \\right\\rVert_2 \\leq \\epsilon \\label{eq:decision_calibration_equivalent2}:\n\\end{aligned}')
('4.3', '\\bar{B}^K')
('4.3', 'B^K')
('5.0', '\\ell')
('5.0', '\\delta_\\ell')
('5.0', '\\begin{aligned}\n    \\text{loss gap} :=  \\left\\lvert {\\mathbb{E}}[\\ell({\\hat{Y}}, \\delta_\\ell({\\hat{p}}(X))) ] - {\\mathbb{E}}[\\ell(Y, \\delta_\\ell({\\hat{p}}(X))) ] \\right\\rvert / \\sup_{a \\in {\\mathcal{A}}} \\lVert \\ell(\\cdot, a) \\rVert_2 \\label{eq:loss_gap_metric}\n\\end{aligned}')
('5.0', 'y\\in{\\mathcal{Y}}, a\\in{\\mathcal{A}}')
('5.0', '\\ell(y, a) \\sim \\text{Normal}(0, 1)')
('5.0.0', '{\\hat{p}}')
('5.0.0.0', '0')
('5.0.0.1', 'K=3')
('5.0.0.1', '0.40 \\pm 0.08')
('5.0.0.1', '0.010 \\pm 0.001')
('5.0.0.1', 'C')
('5.1.0.0', '0.30')
('5.1.0.0', '0.00173')
('6.0', '{\\mathcal{F}}')
('6.0.0', 'X')
('7', 'x')
('7', '{\\hat{p}}(x)')
('7', 'x')
('7', '{\\mathcal{L}}^K')
('7', 'x')
('9', 't')
('9', 'b_a(X) = b({\\hat{p}}^{(t-1)}(X), a)')
('9', 't')
('9', 'b_a')
('9', 'b(X)')
('9', '(b_1(X), \\cdots, b_K(X))')
('9', '{\\hat{p}}')
('9', '{\\mathcal{D}}= \\lbrace (x_1, y_1), \\cdots, (x_M, y_M) \\rbrace')
('9', '\\epsilon')
('9', '{\\hat{p}}^{(0)} = {\\hat{p}}')
('9', 'v^{(0)} = +\\infty')
('9', '{\\hat{p}}^{(T)}')
('9', 'T')
('9', 't')
('9', '{\\hat{p}}^{(t-1)}')
('9', 'b^{(t)}')
('9', '\\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[(Y - {\\hat{p}}^{t-1}(X)) b^{(t)}_a(X)] \\right\\rVert^2')
('9', '{\\hat{p}}^{(t-1)} \\to {\\hat{p}}^{(t)}')
('9', '\\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[(Y - {\\hat{p}}^{t}(X)) b^{(t)}_a(X)] \\right\\rVert^2')
('9', 'U \\in {\\mathbb{R}}^{C \\times K}')
('9', '\\begin{aligned}\n{\\hat{p}}^{(t)}(X) = {\\hat{p}}^{(t-1)}(X) + U  b^{(t)}(X)\n\\end{aligned}')
('9', '\\begin{aligned}\n    L(U) &:= \\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[(Y - {\\hat{p}}^{(t)}(X)) b^{(t)}_a(X)] \\right\\rVert^2 \n\\end{aligned}')
('9', 'L')
('9', '\\begin{aligned}\n    L(U) &=  \\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[(Y - {\\hat{p}}^{(t-1)}(X)) b^{(t)}_a(X) - U b^{(t)}(X) b^{(t)}_a(X) ] \\right\\rVert^2    \\\\\n    &= \\sum_{a=1}^K \\left\\lVert  R_a - (D U^T)_a \\right\\rVert^2 \n    =  \\left\\lVert R - DU^T   \\right\\rVert^2  \n\\end{aligned}')
('9', 'D')
('9', '\\begin{aligned}\n    U^* := \\arg\\inf L(U) = R^T D^{-1}, \\quad L(U^*) = 0\n\\end{aligned}')
('9', 'D')
('9', 'D')
('9', 'O(K/\\epsilon^2)')
('9', '\\lambda > 0')
('9', 'O(\\text{poly}(K, C, \\log(1/\\delta), \\lambda))')
('9', '1-\\delta')
('9', '({\\mathcal{L}}^K, \\epsilon + \\lambda)')
('9', "{\\hat{p}}'")
('9', "{\\mathbb{E}}[\\lVert {\\hat{p}}'(X) - Y \\rVert_2^2] \\leq {\\mathbb{E}}[\\lVert {\\hat{p}}(X) - Y \\rVert_2^2] + \\lambda")
('11.0', 'U, V')
('11.0', '{\\mathbb{E}}[U \\mid V] = 0')
('11.0', '\\forall c \\in \\mathbb{R}, {\\mathbb{E}}[U \\mathbb{I}(V > c)] = 0')
('11.0', '\\ell: y, a \\mapsto \\mathbb{I}(y \\neq a \\cap a \\neq \\bot) + \\beta \\mathbb{I}(a = \\bot)')
('11.0', '\\begin{aligned}\n    \\delta_\\ell(x) = \\left\\lbrace \\begin{array}{ll} \\arg\\max {\\hat{p}}(x)  & \\max {\\hat{p}}(x) > 1-\\beta \\\\ \\bot & \\text{otherwise} \\end{array}\\right.\n\\end{aligned}')
('11.0', 'U= \\max {\\hat{p}}(X)')
('11.0', 'V = \\arg\\max {\\hat{p}}(X)')
('11.0', '\\ell')
('11.0', "\\ell'")
('11.0', '\\beta')
('11.0', "\\beta'")
('11.0', "\\begin{aligned}\n    &{\\mathbb{E}}[\\ell'(Y, \\delta_{\\ell}(X))] - {\\mathbb{E}}[\\ell'({\\hat{Y}}, \\delta_{\\ell}(X))] \\\\\n    &= {\\mathbb{E}}[(\\ell'(Y, \\bot) - \\ell'({\\hat{Y}}, \\bot))  \\mathbb{I}(\\delta_{\\ell}(X) = \\bot)] + {\\mathbb{E}}[(\\ell'(Y, \\delta_{\\ell}(X)) - \\ell'({\\hat{Y}}, \\delta_{\\ell}(X))) \\mathbb{I}( \\delta_{\\ell}(X) \\neq \\bot)] & \\text{Tower}  \\\\\n    &= 0 + {\\mathbb{E}}[(p^*_{V}(X) - {\\hat{p}}_{V}(X)) \\mathbb{I}( \\max {\\hat{p}}(x) > 1-\\beta )] & \\text{Def of } \\ell \\\\\n    &= {\\mathbb{E}}[(p^*_{V}(X) - U) \\mathbb{I}(U > 1-\\beta)]\n\\end{aligned}")
('11.0', '{\\hat{p}}')
('11.0', '\\begin{aligned}\n    U = \\Pr[Y = \\arg\\max {\\hat{p}}(X) \\mid U] = {\\mathbb{E}}[p^*_{V}(X) \\mid U] \n\\end{aligned}')
('11.0', '{\\mathbb{E}}[p^*_{V}(X) - U \\mid U] = 0')
('11.0', "\\begin{aligned}\n    0 = {\\mathbb{E}}[(p^*_{V}(X) - U) \\mathbb{I}(U > 1-\\beta)] = {\\mathbb{E}}[\\ell'(Y, \\delta_\\ell(X))] - {\\mathbb{E}}[\\ell'({\\hat{Y}}, \\delta_\\ell(X))] \n\\end{aligned}")
('11.0', '{\\hat{p}}')
('11.0', 'L_r')
('11.0', '{\\hat{p}}')
('11.0', 'L_r')
('11.0', '\\forall \\beta \\in [0, 1]')
('11.0', '{\\mathbb{E}}[(p^*_{V}(X) - U) \\mathbb{I}(U > 1-\\beta)] = 0')
('11.0', '\\begin{aligned}\n    0 = {\\mathbb{E}}[p^*_{V}(X) - U \\mid U] = {\\mathbb{E}}[p^*_{V}(X) \\mid U]  - U\n\\end{aligned}')
('11.0', '{\\hat{p}}')
('11.0', '\\ell: y, a \\mapsto {\\mathbb{I}}(a = \\bot) + \\beta_1 {\\mathbb{I}}(y \\neq c \\wedge a=T) + \\beta_2 {\\mathbb{I}}(y = c \\wedge a=F)')
('11.0', '\\beta_1, \\beta_2 > 1')
('11.0', '\\ell')
('11.0', '\\begin{aligned}\n    \\delta_\\ell(x) = \\left\\lbrace \\begin{array}{ll} T & {\\hat{p}}_c(x) > \\max(1 - 1/\\beta_1, \\beta_1 / (\\beta_1 + \\beta_2)) \\\\ F & {\\hat{p}}_c(x) < \\min(1/\\beta_2, \\beta_1 / (\\beta_1 + \\beta_2))  \\\\ \\bot & \\text{otherwise} \\end{array}\\right.\n\\end{aligned}')
('11.0', '\\alpha \\geq \\gamma')
('11.0', '\\beta_1, \\beta_2')
('11.0', '\\alpha := \\max(1 - 1/\\beta_1, \\beta_1 / (\\beta_1 + \\beta_2)), \\gamma := \\min(1/\\beta_2, \\beta_1 / (\\beta_1 + \\beta_2))')
('11.0', '\\ell')
('11.0', "\\ell'")
('11.0', "\\beta_1, \\beta_2, \\beta_1', \\beta_2'")
('11.0', "\\alpha \\geq \\gamma, \\alpha' \\geq \\gamma'")
('11.0', "\\begin{aligned}\n& {\\mathbb{E}}[\\ell'(Y, \\delta_{\\ell}(X)) - {\\mathbb{E}}[\\ell'({\\hat{Y}}, \\delta_{\\ell}(X))] \\\\\n&= {\\mathbb{E}}[(\\ell'(Y, \\delta_{\\ell}(X))  - \\ell'({\\hat{Y}}, \\delta_{\\ell}(X))) {\\mathbb{I}}(\\delta_{\\ell}(X) = T)] +  {\\mathbb{E}}[(\\ell'(Y, \\delta_{\\ell}(X)) - \\ell'({\\hat{Y}}, \\delta_{\\ell}(X))) {\\mathbb{I}}(\\delta_{\\ell}(X) = F)] \\\\\n&= {\\mathbb{E}}[(\\ell'(Y, T)  - \\ell'({\\hat{Y}}, T)) {\\mathbb{I}}(\\delta_{\\ell}(X) = T)] +  {\\mathbb{E}}[(\\ell'(Y, F) - \\ell'({\\hat{Y}}, F)) {\\mathbb{I}}(\\delta_{\\ell}(X) = F)] \\\\\n&= \\beta_1' {\\mathbb{E}}[ ( {\\hat{p}}_c(X) - p_c^*(X)) {\\mathbb{I}}({\\hat{p}}_c(X) > \\alpha) ] + \\beta_2' {\\mathbb{E}}[ (p_c^*(X) - {\\hat{p}}_c(X)) {\\mathbb{I}}({\\hat{p}}_c(X) < \\gamma) ]\n\\end{aligned}")
('11.0', '{\\hat{p}}')
('11.0', '\\forall \\alpha, \\gamma')
('11.0', '{\\mathbb{E}}[ (p_c^*(X) - {\\hat{p}}_c(X)) {\\mathbb{I}}({\\hat{p}}_c(X) > \\alpha) ] = 0')
('11.0', '{\\mathbb{E}}[ (p_c^*(X) - {\\hat{p}}_c(X)) {\\mathbb{I}}({\\hat{p}}_c(X) < \\gamma) ] = 0')
('11.0', '{\\mathcal{L}}_{cr}')
('11.0', '{\\hat{p}}')
('11.0', '{\\mathcal{L}}_{cr}')
('11.0', '\\forall \\alpha')
('11.0', '{\\mathbb{E}}[ ( {\\hat{p}}_c(X) - p_c^*(X)) {\\mathbb{I}}({\\hat{p}}_c(X) > \\alpha) ] = 0')
('11.0', '{\\hat{p}}')
('11.0', '{\\mathcal{A}}= \\Delta^C')
('11.0', '\\ell')
('11.0', '\\ell: y, a \\mapsto -\\log a_y')
('11.0', '\\begin{aligned}\n    \\delta_\\ell(x) = \\arg\\inf_{a \\in \\Delta^C} {\\mathbb{E}}_{{\\hat{Y}}\\sim {\\hat{p}}(X)}[-\\log a_{\\hat{Y}}] = {\\hat{p}}(x)\n\\end{aligned}')
('11.0', 'U = {\\hat{p}}(X)')
('11.0', '{\\mathcal{L}}_B')
('11.0', '{\\mathcal{L}}_B = \\lbrace \\ell, |\\ell(y, a)| \\leq B \\rbrace')
('11.0', "\\begin{aligned}\n& \\sup_{\\ell' \\in {\\mathcal{L}}_B} {\\mathbb{E}}[\\ell'(Y, \\delta_{\\ell}(X))] - {\\mathbb{E}}[\\ell'({\\hat{Y}}, \\delta_{\\ell}(X))]  \\\\\n& \\sup_{\\ell' \\in {\\mathcal{L}}_B} {\\mathbb{E}}[ {\\mathbb{E}}[\\ell'(Y, U) - \\ell'({\\hat{Y}}, U) \\mid U]]  & \\text{Tower} \\\\ \n&= B {\\mathbb{E}}[ \\left\\lVert {\\mathbb{E}}[ p^*(X) - {\\hat{p}}(X) \\mid U] \\right\\rVert_1 ] & \\text{Cauchy Schwarz} \\\\\n\\end{aligned}")
('11.0', '{\\hat{p}}')
('11.0', '\\left\\lVert {\\mathbb{E}}[ p^*(X) - {\\hat{p}}(X) \\mid U] \\right\\rVert_1 = 0')
('11.0', '{\\hat{p}}')
('11.0', '{\\mathcal{L}}_B')
('11.0', '{\\hat{p}}')
('11.0', '{\\mathcal{L}}_B')
('11.0', '\\left\\lVert {\\mathbb{E}}[ p^*(X) - {\\hat{p}}(X) \\mid U] \\right\\rVert_1 = 0')
('11.0', '{\\hat{p}}')
('11.0', 'B')
('11.1', '{\\hat{p}}')
('11.1', '{\\mathcal{L}}^K')
('11.1', 'a \\in [K]')
('11.1', '\\lbrace x, \\delta_\\ell({\\hat{p}}(x)) = a \\rbrace')
('11.1', '\\begin{aligned}\n    {\\mathbb{E}}_X{\\mathbb{E}}_{\\hat{Y} \\sim {\\hat{p}}(X)}[\\hat{Y} \\mid \\delta_\\ell({\\hat{p}}(X)) = a] = {\\mathbb{E}}_X{\\mathbb{E}}_{Y \\sim p^*(X)}[Y \\mid \\delta_\\ell({\\hat{p}}(X)) = a] \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:equal_conditioned}\n\\end{aligned}')
('11.1', '\\ell \\in {\\mathcal{L}}^K')
('11.1', '\\delta_\\ell')
('11.1', '{\\hat{p}}')
('11.1', '{\\mathcal{L}}^K')
('11.1', '\\ell \\in {\\mathcal{L}}^K')
('11.1', '{\\hat{p}}_\\ell')
('11.1', '{\\hat{p}}')
('11.1', '\\delta_\\ell')
('11.1', '\\begin{aligned}\n    {\\hat{p}}_\\ell(x) = {\\mathbb{E}}_X[{\\hat{p}}(X) \\mid \\delta_\\ell({\\hat{p}}(X)) = \\delta_\\ell({\\hat{p}}(x))]\n\\end{aligned}')
('11.1', '\\lbrace x, \\delta_\\ell({\\hat{p}}(x) = a) \\rbrace')
('11.1', '{\\hat{p}}_\\ell')
('11.1', 'K')
('11.1', '{\\hat{p}}_\\ell')
('11.1', 'q \\in \\Delta^C')
('11.1', '{\\hat{p}}_\\ell')
('11.1', 'q')
('11.1', 'a_q \\in [K]')
('11.1', '\\{x : {\\hat{p}}_\\ell(x) = q\\} = \\{x : \\delta_\\ell({\\hat{p}}(x)) = a_q\\}')
('11.1', '\\begin{aligned}\n{\\mathbb{E}}_X{\\mathbb{E}}_{Y \\sim p^*(X)}[Y \\mid {\\hat{p}}_\\ell(X) = q]\n&= {\\mathbb{E}}_X{\\mathbb{E}}_{Y \\sim p^*(X)}[Y \\mid \\delta_\\ell({\\hat{p}}(X)) = a_q]\\\\\n&= {\\mathbb{E}}_X{\\mathbb{E}}_{\\hat{Y} \\sim {\\hat{p}}_\\ell(X)}[\\hat{Y} \\mid \\delta_\\ell({\\hat{p}}(X)) = a_q]\\\\\n&= {\\mathbb{E}}_X{\\mathbb{E}}_{\\hat{Y} \\sim {\\hat{p}}_\\ell(X)}[\\hat{Y} \\mid {\\hat{p}}_\\ell(X) = q]\\\\\n&= q\n\\end{aligned}')
('11.1', '{\\hat{p}}_\\ell')
('11.1', '{\\hat{p}}')
('11.1', 'x \\in {\\mathcal{X}}')
('11.1', '{\\hat{p}}_\\ell')
('11.1', '{\\hat{p}}')
('11.1', 'x \\in {\\mathcal{X}}')
('11.1', 'x')
('11.1', '{\\hat{p}}_\\ell(x) = q')
('11.1', 'a_q \\in [K]')
('11.1', 'x')
('11.1', 'a \\in [K]')
('11.1', '\\begin{aligned}\n    \\langle \\ell_{a_q} , {\\hat{p}}(x) \\rangle \\le \\langle \\ell_a, {\\hat{p}}(x) \\rangle.\n\\end{aligned}')
('11.1', '\\{x : {\\hat{p}}_\\ell(x) = q\\}')
('11.1', 'a_q')
('11.1', '\\begin{aligned}\n\\langle \\ell_{a_q} , q \\rangle &= \\langle \\ell_{a_q} , {\\mathbb{E}}[{\\hat{p}}(X) \\mid \\delta_\\ell({\\hat{p}}(X)) = a_q] \\rangle\\\\\n&= {\\mathbb{E}}[\\langle \\ell_{a_q}, {\\hat{p}}(X) \\rangle \\mid  \\delta_\\ell({\\hat{p}}(X)) = a_q]\\\\\n&\\le {\\mathbb{E}}[\\langle \\ell_a, {\\hat{p}}(X) \\rangle \\mid  \\delta_\\ell({\\hat{p}}(X)) = a_q]\\\\\n&= \\langle \\ell_a , {\\mathbb{E}}[{\\hat{p}}(X) \\mid \\delta_\\ell({\\hat{p}}(X)) = a_q] \\rangle\\\\\n&= \\langle \\ell_a, q \\rangle\n\\end{aligned}')
('11.1', 'x \\in {\\mathcal{X}}')
('11.2', '{\\mathcal{A}}= [K]')
('11.2', '{\\mathcal{Y}}\\simeq [C]')
('11.2', 'K')
('11.2', '\\ell_1, \\cdots, \\ell_K')
('11.2', '\\ell_{ac} = \\ell(c, a)')
('11.2', '{\\hat{p}}: {\\mathcal{X}}\\to \\Delta^C')
('11.2', '\\begin{aligned}\n    {\\mathbb{E}}_{{\\hat{Y}}\\sim {\\hat{p}}(x)} [\\ell({\\hat{Y}}, a)] = \\langle {\\hat{p}}(x), \\ell_a \\rangle \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:notation_change}\n\\end{aligned}')
('11.2', "\\delta_{\\ell'}")
('11.2', "\\ell' \\in {\\mathcal{L}}^K")
('11.2', "\\delta_{\\ell'}({\\hat{p}}(x)) = \\delta_{\\ell'}(x)")
('11.2', "\\begin{aligned}\n&\\sup_{\\ell} \\frac{\\left\\lvert {\\mathbb{E}}_{X} {\\mathbb{E}}_{ {\\hat{Y}}\\sim {\\hat{p}}(X)} [\\ell({\\hat{Y}}, \\delta_{\\ell'}(X)) ] - {\\mathbb{E}}_{X} {\\mathbb{E}}_{  Y \\sim p^*(X)} [\\ell(Y, \\delta_{\\ell'}(X)) ]  \\right\\rvert}{\\sup_a \\lVert \\ell(\\cdot, a) \\rVert_2 }   \\\\\n&= \\sup_{\\ell, \\lVert \\ell(\\cdot, a) \\rVert_2 \\leq 1} \\left\\lvert {\\mathbb{E}}_{X} {\\mathbb{E}}_{ {\\hat{Y}}\\sim {\\hat{p}}(X)} [\\ell({\\hat{Y}}, \\delta_{\\ell'}(X)) ] - {\\mathbb{E}}_{X} {\\mathbb{E}}_{  Y \\sim p^*(X)} [\\ell(Y, \\delta_{\\ell'}(X)) ]  \\right\\rvert & \\text{Normalize} \\\\\n&= \\sup_{\\ell, \\lVert \\ell(\\cdot, a) \\rVert_2 \\leq 1}  \\left\\lvert {\\mathbb{E}}_X\\left[  \\langle \\ell_{\\delta_{\\ell'}(X)}, {\\hat{p}}(X) \\rangle \\right] -  {\\mathbb{E}}_X\\left[  \\langle \\ell_{\\delta_{\\ell'}(X)}, p^*(X) \\rangle \\right] \\right\\rvert & \\text{Eq.\\ref{eq:notation_change}}\\\\\n&= \\sup_{\\ell, \\lVert \\ell(\\cdot, a) \\rVert_2 \\leq 1}  \\left\\lvert \\sum_a {\\mathbb{E}}_X[ \\langle {\\hat{p}}(X), \\ell_a \\rangle \\mathbb{I}(\\delta_{\\ell'}(X) = a) ] - \\sum_a {\\mathbb{E}}_X[ \\langle p^*(X), \\ell_a \\rangle \\mathbb{I}(\\delta_{\\ell'}(X) = a) ]   \\right\\rvert & \\text{Total Probability} \\\\\n%\\end{align}\n% \\begin{align}\n% \\hat{L}(\\hp, \\ell) =  = \\sum_a \\Eb[ \\langle \\hp(X), \\ell_a \\rangle \\mathbb{I}(\\delta_*(X) = a) ]\n% \\end{align}\n% and the true loss is given by \n% \\begin{align}\n% L^*(\\hp, \\ell) = \\sum_a  \\Eb[ \\langle p^*(X), \\ell_a \\rangle \\mathbb{I}(\\delta_*(X) = a) ] \n% \\end{align}\n% so the gap is given by \n% \\begin{align}\n%     \\left\\lVert L^*(\\hp, \\ell) - \\hat{L}(\\hp, \\ell) \\right\\rvert &= \\left\\lVert \\sum_a \\Eb[ \\langle p^*(X) - \\hp(X), \\ell_a \\rangle \\mathbb{I}(\\delta_*(X) = a) ]  \\right\\rvert \\\\\n&= \\sup_{\\ell, \\lVert \\ell(\\cdot, a) \\rVert_2 \\leq 1}  \\left\\lvert \\sum_a \\langle  {\\mathbb{E}}_X[ (p^*(X) - {\\hat{p}}(X)) \\mathbb{I}(\\delta_{\\ell'}(X) = a) ], \\ell_a \\rangle  \\right\\rvert  & \\text{Linearity} \\\\\n&=  \\sum_a  \\left\\lVert  {\\mathbb{E}}_X[ (p^*(X) - {\\hat{p}}(X)) \\mathbb{I}(\\delta_{\\ell'}(X) = a) ] \\right\\rVert_2  & \\text{Cauchy Schwarz}  \n% &\\leq \\sup_{b \\in \\critic} \\sum_{a \\in \\Ac} \\left\\lVert \\Eb[ (\\hp(X) - Y) b(\\hp(X), a)] \\right\\rVert_*  \n \n\\end{aligned}")
('11.2', '\\begin{aligned}\n   \\lbrace q, a \\mapsto {\\mathbb{I}}(\\delta_{\\ell}(q) = a), \\ell \\in {\\mathcal{L}}^K, q \\in \\Delta^C \\rbrace\n\\end{aligned}')
('11.2', 'B^K')
('11.2', '\\ell_a = -w_a / \\lVert w_a \\rVert_2')
('11.2', "\\begin{aligned}\n    {\\mathbb{I}}(\\delta_{\\ell}(q) = a) = {\\mathbb{I}}(\\arg\\inf_{a'} \\langle \\ell_{a'}, q \\rangle = a) = {\\mathbb{I}}(\\arg\\sup_{a'} \\langle w_{a'}, q \\rangle = a) = b_w(q, a)\n\\end{aligned}")
('11.3.0', '{\\mathcal{D}}= \\lbrace (X_1, Y_1), \\cdots, (X_N, Y_N) \\rbrace')
('11.3.0', '\\psi: {\\mathcal{X}}\\times {\\mathcal{Y}}\\to {\\mathbb{R}}')
('11.3.0', '\\hat{{\\mathbb{E}}}_{\\mathcal{D}}[\\psi(X, Y)]')
('11.3.0', '\\begin{aligned}\n    \\hat{{\\mathbb{E}}}_{\\mathcal{D}}[\\psi(X, Y)] := \\frac{1}{N} \\sum_{n} \\psi(X_n, Y_n) \n\\end{aligned}')
('11.3.0', 'B^K')
('11.3.0', 'X,Y')
('11.3.0', '{\\hat{p}}')
('11.3.0', 'N')
('11.3.0', '{\\mathcal{D}}= \\lbrace (X_1, Y_1), \\cdots, (X_N, Y_N) \\rbrace')
('11.3.0', '1-\\delta')
('11.3.0', '{\\mathcal{D}}')
('11.3.0', '\\begin{aligned}\n    \\sup_{b \\in B^K} \\sum_{a=1}^K \\left\\lVert {\\mathbb{E}}[ ({\\hat{p}}(X) - Y) b({\\hat{p}}(X), a) ] \\right\\rVert_2 - \\sum_{a=1}^K \\left\\lVert \\hat{{\\mathbb{E}}}_{\\mathcal{D}}[ ({\\hat{p}}(X) - Y) b({\\hat{p}}(X), a) ] \\right\\rVert_2  \\leq \\tilde{O}\\left( \\frac{K^{3/2} C}{\\sqrt{N}} \\right)   \\label{eq:convergence_thm}\n\\end{aligned}')
('11.3.0', '\\tilde{O}')
('11.3.0', '\\delta')
('11.3.0', '\\delta')
('11.3.0', 'B')
('11.3.0', '\\lbrace b: \\Delta^C \\to [0, 1] \\rbrace')
('11.3.0', 'U,V')
('11.3.0', 'U')
('11.3.0', '[-1, 1]^C')
('11.3.0', 'V')
('11.3.0', '\\Delta^C')
('11.3.0', '{\\mathcal{D}}= \\lbrace (U_1, V_1), \\cdots, (U_N, V_N)\\rbrace')
('11.3.0', 'N')
('11.3.0', 'U,V')
('11.3.0', 'B')
('11.3.0', '\\begin{aligned}\n    {\\mathcal{R}}_N(B) := {\\mathbb{E}}_{{\\mathcal{D}}, \\sigma_i \\sim \\mathrm{Uniform}(\\lbrace -1, 1 \\rbrace)} \\left[ \\sup_{b \\in B} \\frac{1}{N} \\sum_{n=1}^N \\sigma_i b(V_i) \\right]\n\\end{aligned}')
('11.3.0', '\\delta > 0')
('11.3.0', '1-\\delta')
('11.3.0', '{\\mathcal{D}}')
('11.3.0', '\\forall b \\in B')
('11.3.0', '\\begin{aligned}\n    \\lVert \\hat{{\\mathbb{E}}}_{\\mathcal{D}}[U b(V)]  -  {\\mathbb{E}}[U b(V)] \\rVert_2 \\leq \\sqrt{C} {\\mathcal{R}}_N(B) + \\sqrt{\\frac{2C}{N}\\log \\frac{2C}{\\delta}} \n\\end{aligned}')
('11.3.0', "\\begin{aligned}\nB^K_a &= \\left\\lbrace b: z \\mapsto {\\mathbb{I}}(a = \\arg\\sup_{a'} \\langle z, w_a \\rangle), w_a \\in {\\mathbb{R}}^C, a=1, \\cdots, K, z \\in \\Delta^C \\right\\rbrace \\\\\n\\bar{B}^K_a &= \\left\\lbrace b: z \\mapsto \\frac{e^{\\langle z, w_a \\rangle}}{\\sum_{a'} e^{\\langle z, w_{a'} \\rangle}}, w_a \\in {\\mathbb{R}}^C, a=1, \\cdots, K, z \\in \\Delta^C \\right\\rbrace\n\\end{aligned}")
('11.3.0', '{\\mathcal{R}}_N(B^K_a) = O\\left( \\sqrt{\\frac{CK\\log K \\log N}{N}} \\right)')
('11.3.0', '{\\mathcal{R}}_N(\\bar{B}^K_a) = O\\left( \\left(\\frac{K}{N}\\right)^{1/4}\\log \\frac{N}{K} \\right)')
('11.3.0', 'U = {\\hat{p}}(X) - Y')
('11.3.0', 'U')
('11.3.0', '[-1, 1]^C')
('11.3.0', '\\begin{aligned}\n    &\\sup_{b \\in {B^K}} \\sum_a  \\lVert {\\mathbb{E}}[U b({\\hat{p}}(X), a)] \\rVert_2 - \\lVert \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U b({\\hat{p}}(X), a)] \\rVert_2\\\\\n    &\\leq \\sum_a \\sup_{b \\in B^K_a}  \\lVert {\\mathbb{E}}[U b({\\hat{p}}(X), a)] \\rVert_2 - \\lVert \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U b({\\hat{p}}(X), a)] \\rVert_2  & \\text{Jensen} \\\\\n    &\\leq \\sum_a \\sup_{b \\in B^K_a} \\lVert {\\mathbb{E}}[U b({\\hat{p}}(X), a)] -  \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U b({\\hat{p}}(X), a)] \\rVert_2  & \\text{Triangle} \\\\\n    &\\leq \\sum_a  \\sqrt{C} {\\mathcal{R}}_N(B^K_a) + \\sqrt{\\frac{2C}{N}\\log \\frac{2C}{\\delta}}  \\quad \\left( \\text{w.p. } 1-\\delta \\right) & \\text{Lemma~\\ref{lemma:concentration_action}} \\\\\n    &\\leq  \\sum_a \\sqrt{C} O\\left( \\sqrt{\\frac{CK\\log K \\log N}{N}} \\right) + \\sqrt{\\frac{2C}{N}\\log \\frac{2C}{\\delta}}  & \\text{Lemma~\\ref{lemma:radamacher_bound}} \\\\\n    &\\leq  K\\sqrt{C} O\\left( \\sqrt{\\frac{CK\\log K \\log N}{N}} \\right) + K\\sqrt{ \\frac{2C}{N} \\log \\frac{2C}{\\delta}}  \\\\\n    &= \\tilde{O}\\left( \\frac{K^{3/2} C}{\\sqrt{N}} \\right) \n\\end{aligned}')
('11.3.0.0', '{\\hat{p}}')
('11.3.0.0', '\\epsilon')
('11.3.0.0', 'O(K/\\epsilon^2)')
('11.3.0.0', '\\lambda > 0')
('11.3.0.0', 'O(\\text{poly}(K, C, \\log(1/\\delta), \\lambda))')
('11.3.0.0', '1-\\delta')
('11.3.0.0', '({\\mathcal{L}}^K, \\epsilon+\\lambda)')
('11.3.0.0', "{\\hat{p}}'")
('11.3.0.0', "{\\mathbb{E}}[\\lVert {\\hat{p}}'(X) - Y \\rVert_2^2] \\leq {\\mathbb{E}}[\\lVert {\\hat{p}}(X) - Y \\rVert_2^2] + \\lambda")
('11.3.0.0', '{\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}(X))^2]')
('11.3.0.0', 't')
('11.3.0.0', 'b_a(X) = b({\\hat{p}}^{(t-1)}(X), a)')
('11.3.0.0', 't')
('11.3.0.0', 'b_a')
('11.3.0.0', 'b(X)')
('11.3.0.0', '(b_1(X), \\cdots, b_K(X))')
('11.3.0.0', 'b')
('11.3.0.0', '\\begin{aligned}\n    \\sum_a  \\lVert {\\hat{{\\mathbb{E}}}}[   ({\\hat{p}}(X) - Y) b_a(X) ] \\rVert \\geq \\epsilon \\label{eq:error_lb} \n\\end{aligned}')
('11.3.0.0', '\\gamma \\in \\mathbb{R}^{K \\times K}')
('11.3.0.0', '\\gamma_a = {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}(X) ) b(X, a)]/ {\\hat{{\\mathbb{E}}}}[b(X, a)]')
('11.3.0.0', "{\\hat{p}}'(X) = \\pi({\\hat{p}}(X) + \\sum_a \\gamma_a b(X, a))")
('11.3.0.0', "\\begin{aligned}\n    &{\\hat{{\\mathbb{E}}}}[\\lVert Y - {\\hat{p}}(X)\\rVert^2] - {\\hat{{\\mathbb{E}}}}[\\Vert Y - {\\hat{p}}'(X) \\rVert^2] \\\\ &= {\\hat{{\\mathbb{E}}}}[ \\lVert Y - {\\hat{p}}(X)\\rVert^2 - \\Vert Y -  \\pi({\\hat{p}}(X) + \\sum_a \\gamma_a b(X, a) ) \\rVert^2] \\\\\n    &\\geq {\\hat{{\\mathbb{E}}}}[ \\lVert Y - {\\hat{p}}(X)\\rVert^2 - \\Vert Y -  {\\hat{p}}(X) - \\sum_a \\gamma_a b(X, a)  \\rVert^2] & \\text{Projection ineq} \\\\\n    % &= \\hEb[ \\lVert Y - \\hp(X)\\rVert^2 - \\Vert Y - \\hp(X) - \\sum_a \\gamma_a b(X, a) \\rVert^2 \\\\\n    %&\\qquad - \\lVert e_a \\rVert^2 + 2 (Y - \\hp(X) - \\sum_a \\gamma_a b(X, a))^T e_a]  \\\\\n    % &\\geq \\hEb[ \\lVert Y - \\hp(X)\\rVert^2 - \\Vert Y - \\hp(X) - \\sum_a \\gamma_a b(X, a) \\rVert^2 \\\\\n    % &\\qquad + \\lVert e_a \\rVert^2 - 2 (Y - \\hp(X) - \\sum_a \\gamma_a b(X, a))^T e_a]  \\\\\n    &= {\\hat{{\\mathbb{E}}}}\\left[ (2Y - 2{\\hat{p}}(X) - \\sum_a \\gamma_a b(X, a))^T \\left( \\sum_a \\gamma_a b(X, a)  \\right)\\right] & a^2-b^2 = (a+b)(a-b) \\\\\n    &= 2\\sum_a \\gamma_a^T \\gamma_a {\\hat{{\\mathbb{E}}}}[b(X, a)] - \\sum_{a, a'} \\gamma_a^T \\gamma_{a'} {\\hat{{\\mathbb{E}}}}[b(X, a)b(X, a')] & \\text{Definition} \\gamma_a \\\\ \n    &= 2\\sum_a \\gamma_a^T \\gamma_a {\\hat{{\\mathbb{E}}}}[b(X, a)] - \\sum_{a} \\gamma_a^T \\gamma_{a} {\\hat{{\\mathbb{E}}}}[b(X, a)b(X, a)] & b(x, a) b(x, a') = 0, \\forall a \\neq a' \\\\ \n    &= 2\\sum_a \\gamma_a^T \\gamma_a {\\hat{{\\mathbb{E}}}}[b(X, a)] - \\sum_{a} \\gamma_a^T \\gamma_{a} {\\hat{{\\mathbb{E}}}}[b(X, a)] & b(X, a)^2 = b(X, a)\\\\ \n    % &= \\hEb\\left[ \\sum_a \\gamma_a^T b(X, a) (2Y - 2\\hp(X)) - \\left\\lVert \\sum_a \\gamma_a b(X, a) \\right\\rVert^2  \\right] - \\epsilon^2/2 \\\\\n    % &= \\hEb\\left[  2 \\sum_a \\lVert \\gamma_a \\rVert^2 - \\left\\lVert \\sum_a \\gamma_a b(X, a) \\right\\rVert^2 \\right] - \\epsilon^2/2 \\\\\n    &=   \\sum_a  \\Vert \\gamma_a \\rVert^2 {\\hat{{\\mathbb{E}}}}[b(X, a)]  \\geq \\frac{1}{K} \\left( \\sum_a \\lVert \\gamma_a \\rVert {\\hat{{\\mathbb{E}}}}[b(X, a)] \\right)^2 & \\text{Norm inequality}  \\\\\n    & = \\frac{1}{K}\\left(  \\sum_a  \\left\\lVert {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}(X)b(X, a)]  \\right\\rVert \\right)^2 \\geq \\frac{\\epsilon^2}{K}  & \\text{Definition } \\gamma_a\n\\end{aligned}")
('11.3.0.0', '{\\hat{p}}')
('11.3.0.0', '\\begin{aligned}\n    {\\hat{{\\mathbb{E}}}}[\\lVert p^*(X) - {\\hat{p}}(X)\\rVert_2^2] \\leq {\\hat{{\\mathbb{E}}}}[ \\lVert p^*(X) - {\\hat{p}}(X) \\rVert_1^2 ] \\leq 1\n\\end{aligned}')
('11.3.0.0', 'K/\\epsilon^2')
('11.3.0.0', "{\\hat{p}}'")
('11.3.0.0', "\\begin{aligned}\n    \\sum_a  \\lVert {\\hat{{\\mathbb{E}}}}[   ({\\hat{p}}'(X) - Y) b_a(X) ] \\rVert \\leq \\epsilon\n\\end{aligned}")
('11.3.0.0', "\\begin{aligned}\n{\\hat{{\\mathbb{E}}}}[\\lVert {\\hat{p}}'(X) - Y \\rVert_2^2] \\leq {\\hat{{\\mathbb{E}}}}[\\lVert {\\hat{p}}(X) - Y \\rVert_2^2]\n\\end{aligned}")
('11.3.0.0', '{\\hat{{\\mathbb{E}}}}')
('11.3.0.0', '{\\mathbb{E}}')
('11.3.0.0', '{\\mathbb{E}}[\\cdot] \\in {\\hat{{\\mathbb{E}}}}[\\cdot] \\pm \\kappa')
('11.3.0.0', '\\kappa > 0')
('11.3.0.0', '\\kappa')
('11.3.0.0', 'D')
('11.3.0.0', "\\sum_{a, a'} D_{aa'} = 1")
('11.3.0.0', '\\lambda_1')
('11.3.0.0', '\\lambda_n')
('11.3.0.0', 'D')
('11.3.0.0', "\\sum_{a, a'} D_{aa'} = 1")
('11.3.0.0', '\\lambda_1(D) \\leq 1')
('11.3.0.0', '\\lambda_n(D^{-1}) \\geq 1')
('11.3.0.0', 'D')
('11.3.0.0', 'B')
('11.3.0.0', 'D')
('11.3.0.0', '\\begin{aligned}\n\\lambda_n(D) {\\mathrm{trace}}(B) \\leq {\\mathrm{trace}}(BD) \\leq \\lambda_1(D) {\\mathrm{trace}}(B) \n\\end{aligned}')
('11.3.0.0', '{\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t-1)}(X))^2]')
('11.3.0.0', 't')
('11.3.0.0', '\\begin{aligned}\n    \\epsilon^2/K \\leq \\sum_{a} \\lVert {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t-1)}(X)) b_a^{(t)}(X)] \\rVert^2 := {\\mathrm{trace}}(RR^T) \n\\end{aligned}')
('11.3.0.0', '\\begin{aligned}\n    &{\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t-1)}(X))^2] - {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t)}(X))^2] \\\\\n    &=  {\\hat{{\\mathbb{E}}}}\\left[ (2 (Y - {\\hat{p}}^{(t-1)}(X)) - R^TD^{-1}b^{(t)}(X))^T R^T D^{-1} b^{(t)}(X) \\right] & \\text{Definition}  \\\\\n    &=  2{\\hat{{\\mathbb{E}}}}\\left[ (Y - {\\hat{p}}^{(t-1)}(X))^T R^T D^{-1} b^{(t)}(X) \\right] - {\\hat{{\\mathbb{E}}}}\\left[ b^{(t)}(X)^T D^{-T} R R^T D^{-1} b^{(t)}(X)  \\right]  \\\\\n    &= 2{\\mathrm{trace}}\\left( {\\hat{{\\mathbb{E}}}}\\left[  b^{(t)}(X) (Y - {\\hat{p}}^{(t-1)}(X))^T R^T D^{-1}  \\right] \\right) \\\\\n    & \\qquad - {\\mathrm{trace}}\\left( {\\hat{{\\mathbb{E}}}}\\left[ b^{(t)}(X) b^{(t)}(X)^T D^{-T} R R^T D^{-1}  \\right] \\right) & \\text{Cyclic property} \\\\\n    &= 2{\\mathrm{trace}}\\left( R R^T D^{-1} \\right) - {\\mathrm{trace}}(RR^T D^{-1}) = {\\mathrm{trace}}(RR^T D^{-1}) & \\text{Definition}  \\\\\n    &\\geq {\\mathrm{trace}}(RR^T) \\geq \\epsilon^2/K & \\text{Lemma~\\ref{lemma:non_neg_matrix} and \\ref{lemma:perron}}\n\\end{aligned}')
('11.3.0.0', 'O(K/\\epsilon^2)')
('11.3.0.0', '\\begin{aligned}\n    \\sup_{b \\in B^K} \\sum_{a} \\lVert {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t-1)}(X)) b_a^{(t)}(X)] \\rVert \n    &\\leq \\sup_{b \\in {\\bar{B}^K}} \\sum_{a} \\lVert {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t-1)}(X)) b_a^{(t)}(X)] \\rVert \\\\\n    &\\leq \\sup_{b \\in {\\bar{B}^K}} \\sqrt{K} \\sqrt{\\sum_{a} \\lVert {\\hat{{\\mathbb{E}}}}[(Y - {\\hat{p}}^{(t-1)}(X)) b_a^{(t)}(X)] \\rVert^2 } \\\\\n    &\\leq \\sqrt{K} \\epsilon/\\sqrt{K} = \\epsilon\n\\end{aligned}')
('11.3.0.0', '({\\mathcal{L}}^K, \\epsilon)')
('11.4', 'A')
('11.4', 'V')
('11.4', '\\begin{aligned}\n    {\\mathbb{E}}[(U - {\\mathbb{E}}[U\\mid V]) {\\mathbb{I}}_A] = 0\n\\end{aligned}')
('11.4', 'V > c')
('11.4', '\\begin{aligned}\n    {\\mathbb{E}}[(U - {\\mathbb{E}}[U\\mid V]) {\\mathbb{I}}(V > c)] = 0\n\\end{aligned}')
('11.4', '\\begin{aligned}\n    {\\mathbb{E}}[U{\\mathbb{I}}(V > c)] = {\\mathbb{E}}[{\\mathbb{E}}[U \\mid V] {\\mathbb{I}}(V > c)] \n\\end{aligned}')
('11.4', '\\lVert z \\rVert_\\alpha \\leq C^{1/\\alpha} \\lVert z \\rVert_\\infty')
('11.4', '\\begin{aligned}\n    \\lVert \\hat{{\\mathbb{E}}}_{\\mathcal{D}}[U b(V)]  -  {\\mathbb{E}}[U b(V)] \\rVert_2 \\leq  \\sqrt{C} \\lVert \\hat{{\\mathbb{E}}}[U b(V)]  -  {\\mathbb{E}}[U b(V)] \\rVert_\\infty \\label{eq:convergence_2_to_infty}\n\\end{aligned}')
('11.4', 'c')
('11.4', 'U')
('11.4', 'U^c')
('11.4', '\\lvert \\hat{{\\mathbb{E}}}[U^c b(V)]  -  {\\mathbb{E}}[U^c b(V)] \\rvert')
('11.4', '\\bar{{\\mathcal{D}}} = \\lbrace (\\bar{U}_1, \\bar{V}_1), \\cdots (\\bar{U}_N, \\bar{V}_N) \\rbrace')
('11.4', '\\sigma_n \\in \\lbrace -1, 1 \\rbrace')
('11.4', '\\begin{aligned}\n    &{\\mathbb{E}}_{{\\mathcal{D}}} \\left[ \\sup_b  \\lvert \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U^c b(V)]  - {\\mathbb{E}}[U^c b(V)] \\rvert  \\right] \\\\\n    &= {\\mathbb{E}}_{{\\mathcal{D}}} \\left[ \\sup_b \\left\\lvert \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U^c b(V)] - {\\mathbb{E}}_{\\bar{{\\mathcal{D}}}}\\left[ \\hat{{\\mathbb{E}}}_{\\bar{{\\mathcal{D}}}}[ U^cb(V)] \\right] \\right\\rvert \\right] & \\text{Tower}  \\\\\n    &= {\\mathbb{E}}_{{\\mathcal{D}}} \\left[ \\sup_b \\left\\lvert {\\mathbb{E}}_{\\bar{{\\mathcal{D}}}}[\\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U^c b(V)] - \\hat{{\\mathbb{E}}}_{\\bar{{\\mathcal{D}}}}[ U^cb(V)] ] \\right\\rvert\\right] & \\text{Linearity}  \\\\\n    &\\leq {\\mathbb{E}}_{{\\mathcal{D}}} \\left[ \\sup_b {\\mathbb{E}}_{\\bar{{\\mathcal{D}}}}\\left[ \\left\\lvert \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U^c b(V)] - \\hat{{\\mathbb{E}}}_{\\bar{{\\mathcal{D}}}}[ U^cb(V)] \\right\\rvert  \\right] \\right]  & \\text{Jensen} \\\\ \n    &\\leq {\\mathbb{E}}_{{\\mathcal{D}}, \\bar{{\\mathcal{D}}}} \\left[ \\sup_b \\left\\lvert \\hat{{\\mathbb{E}}}_{{\\mathcal{D}}}[U^c b(V)] - \\hat{{\\mathbb{E}}}_{\\bar{{\\mathcal{D}}}}[ U^cb(V)] \\right\\rvert\\right]  & \\text{Jensen} \\\\ \n   &\\leq {\\mathbb{E}}_{\\sigma, {\\mathcal{D}}, \\bar{{\\mathcal{D}}}} \\left[ \\sup_b \\left\\lvert \\frac{1}{N} \\sum_i \\sigma_i U^c_i b(V_i) - \\frac{1}{N}  \\sum_i \\sigma_i \\bar{U}^c_i b(\\bar{V}_i)  \\right\\rvert \\right]  & \\text{Radamacher} \\\\\n      &\\leq {\\mathbb{E}}_{\\sigma, {\\mathcal{D}}, \\bar{{\\mathcal{D}}}} \\left[ \\sup_b \\left\\lvert \\frac{1}{N}  \\sum_i \\sigma_i U^c_i b(V_i) \\right\\rvert + \\sup_b \\left\\lvert \\frac{1}{N}  \\sum_i \\sigma_i \\bar{U}^c_i b(\\bar{V}_i)  \\right\\rvert \\right]  & \\text{Jensen} \\\\\n    &= 2{\\mathbb{E}}_{\\sigma, {\\mathcal{D}}} \\left[ \\sup_b \\left\\lvert \\frac{1}{N} \\sum_i \\sigma_i U^c_i b(V_i)\\right\\rvert \\right]   % &\\leq 2C^{1/\\alpha}  \\Eb_{\\sigma, \\Dc} \\left[ \\left\\lvert \\sup_b \\frac{1}{N} \\sum_i \\sigma_i U^c_{i} b(V_i)  \\right\\rvert_\\infty \\right]  &   \\\\\n%   &= 2\\Eb_{\\sigma, \\Dc} \\left[ \\sup_b \\left( \\sum_c \\left\\lvert \\frac{1}{N}\\sum_i \\sigma_i U^c_{ic} b(V_i) \\right\\rvert^\\alpha \\right)^{1/\\alpha} \\right]  \\\\\n%   &\\leq 2\\Eb_{\\sigma, \\Dc} \\left[ \\left( \\sum_c \\left\\lvert \\sup_b \\frac{1}{N} \\sum_i \\sigma_i U^c_{ic} b(V_i) \\right\\rvert^\\alpha \\right)^{1/\\alpha} \\right]  & \\text{Jensen} \\\\\n%   &= 2C^{1/\\alpha}  \\Eb_{\\sigma, \\Dc} \\left[ \\max_c \\sup_b \\frac{1}{N} \\sum_i \\sigma_i U_{ic} b(V_i)   \\right] \\label{eq:convergence2}\n    % &= 2 \\Rc^m(g d_\\theta) & \\text{Definition of Radamacher complexity} \n\\end{aligned}')
('11.4', 'b')
('11.4', '\\begin{aligned}\n    {\\mathcal{R}}_N(B) := {\\mathbb{E}}\\left[ \\sup_b  \\frac{1}{N}\\sum_i \\sigma_i b(V_i) \\right] \n\\end{aligned}')
('11.4', 'U_{i}^c \\in [-1, 1]')
('11.4', 'U_{i}^c')
('11.4', 'c \\in [C]')
('11.4', '\\begin{aligned}\n    {\\mathcal{R}}_N(B)  \\geq {\\mathbb{E}}\\left[ \\sup_b \\frac{1}{N} \\sum_i \\sigma_i U_{ic} b(V_i) \\right] \\label{eq:individual_convergence}\n\\end{aligned}')
('11.4', '{\\mathcal{D}}\\to  \\frac{1}{N} \\sum_i \\sigma_i U_{ic} b(V_i)')
('11.4', '2/N')
('11.4', '\\epsilon > 0')
('11.4', '\\begin{aligned}\n    \\Pr\\left[\\sup_b  \\left\\lvert \\frac{1}{N}\\sum_i \\sigma_i U_i^c b(V_i) \\right\\rvert \\geq {\\mathcal{R}}_N(B) + \\epsilon\\right] \\leq 2e^{-N\\epsilon^2/2}\n\\end{aligned}')
('11.4', '\\begin{aligned}\n    \\Pr\\left[ \\max_c \\sup_b \\left\\lvert \\frac{1}{N}\\sum_i \\sigma_i U_i^c b(V_i)  \\right\\rvert \\geq {\\mathcal{R}}_N(B) + \\epsilon\\right] \\leq 2Ce^{-N\\epsilon^2/2}\n\\end{aligned}')
('11.4', '\\begin{aligned}\n    &\\Pr\\left[ \\sup_b \\lVert \\hat{{\\mathbb{E}}}[U b(V)]  -  {\\mathbb{E}}[U b(V)] \\rVert_2 \\geq \\sqrt{C} {\\mathcal{R}}_N(B) + \\sqrt{C} \\epsilon \\right] \\\\\n    &\\leq \\Pr\\left[ \\max_c \\sup_b \\hat{{\\mathbb{E}}}[U^c b(V)]  -  {\\mathbb{E}}[U^c b(V)] \\rVert_2 \\geq {\\mathcal{R}}_N(B) + \\epsilon \\right] \\leq 2Ce^{-N\\epsilon^2/2}\n\\end{aligned}')
('11.4', '\\forall \\delta > 0')
('11.4', '\\begin{aligned}\n    \\Pr\\left[ \\sup_b \\lVert \\hat{{\\mathbb{E}}}[U b(V)]  -  {\\mathbb{E}}[U b(V)] \\rVert_2 \\geq \\sqrt{C} {\\mathcal{R}}_N(B) + \\sqrt{\\frac{2C}{N}\\log \\frac{2C}{\\delta}} \\right] \\leq \\delta\n\\end{aligned}')
('11.4', 'B^K_a')
('11.4', '\\forall b \\in B^K_a')
('11.4', '\\lbrace z \\in \\Delta^C, b(z) = 1 \\rbrace')
('11.4', 'K')
('11.4', 'C')
('11.4', '{\\mathrm{VC}}(B^K_a) \\leq (C+1)2K\\log_2 (3K)')
('11.4', '\\begin{aligned}\n    {\\mathcal{R}}_N(B^K_a) \\leq \\sqrt{\\frac{2{\\mathrm{VC}}(B^K_a)\\log (eN/{\\mathrm{VC}}(B^K_a)) }{N}} = O\\left( \\sqrt{\\frac{2CK\\log K \\log N}{N}} \\right)\n\\end{aligned}')
