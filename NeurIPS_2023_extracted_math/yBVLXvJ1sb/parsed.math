('2', 'f(\\bm{\\cdot};\\theta)')
('2', 'C')
('2', '\\theta')
('2', 'x')
('2', '{X}')
('2', 'f(x;\\theta)\\in\\mathbb{R}^{C}')
('2', 'f(x;\\theta)_{c}')
('2', 'c')
('2', '{\\textbf{Z}}\\coloneqq[{{z}}_{{1}},\\hbox to10.00002pt{.\\hss.\\hss.},{{z}}_{{N}}]')
('2', 'N')
('2', '{{z}}_{{i}}\\coloneqq({{x}}_{{i}},{{y}}_{{i}})')
('2', '{{x}}_{{i}}\\in\\mathcal{X}')
('2', '{{y}}_{{i}}\\in\\mathcal{Y}\\coloneqq[0,1]^{C}')
('2', 'K')
('2', '\\{\\Phi_{k}\\}_{k=1}^{K}')
('2', '\\Phi_{k}\\subseteq[N]')
('2', '\\Phi_{k}\\cap\\Phi_{k^{\\prime}}=\\emptyset')
('2', 'k\\neq k^{\\prime}')
('2', '\\cup_{k=1}^{K}\\Phi_{k}=[N].')
('2', '\\Phi_{k}')
('2', '{{N}^{\\prime}}')
('2', '{{\\textbf{Z}}^{\\prime}}\\coloneqq[{{{z}^{\\prime}}}_{{1}},\\hbox to10.00002pt{.%\n\\hss.\\hss.},{{{z}^{\\prime}}}_{{{{N}^{\\prime}}}}]')
('2', '{{{z}^{\\prime}}}_{{i}}\\coloneqq({{{x}^{\\prime}}}_{{i}},{{{y}^{\\prime}}}_{{i}})')
('2', '{{{x}^{\\prime}}}_{{i}}\\in\\mathcal{X},{{{y}^{\\prime}}}_{{i}}\\in\\mathcal{Y}')
('2', '\\theta=\\operatorname{argmin}_{\\theta^{\\prime}}\\tfrac{1}{{{N}^{\\prime}}}\\sum_{i%\n\\leavevmode\\resizebox{5.44446pt}{0.0pt}{=}1}^{{{N}^{\\prime}}}L({{{z}^{\\prime}}%\n}_{{i}};\\theta^{\\prime})')
('2', 'L')
('2', 'z=(x,y)')
('2', 'x\\in\\mathcal{X},y=[y_{1},\\hbox to10.00002pt{.\\hss.\\hss.},y_{C}]\\in\\mathcal{Y}')
('2', 'L(z;\\theta)=-\\textstyle\\sum_{c}y_{c}\\log p_{c}')
('2', 'p=[p_{1},\\hbox to10.00002pt{.\\hss.\\hss.},p_{C}]')
('2', 'p_{c}\\coloneqq\\tfrac{\\exp(f(x;\\theta)_{c})}{\\sum_{c^{\\prime}}\\exp(f(x;\\theta)_%\n{c^{\\prime}}))}')
('2', 'p=\\operatorname{softmax}(f(x;\\theta))')
('2', 'z^{\\prime}')
('2', 'z')
('2', 'z')
('2', 'z^{\\prime}')
('2', 'I({{z}^{\\prime}},{z})\\coloneqq\\nabla_{\\theta}L({{z}^{\\prime}};\\theta)^{%\n\\intercal}H_{\\theta}^{-1}\\nabla_{\\theta}L({z};\\theta),')
('2', 'H_{\\theta}')
('2', 'H_{\\theta}\\coloneqq 1/n\\sum_{i=1}^{n}\\nabla^{2}_{\\theta}L(z;\\theta)')
('2', 'H_{\\theta}')
('2', 'H_{\\theta}^{-1}')
('2', 'H_{\\theta}')
('2', 'P')
('2', 'P')
('2', 'H_{\\theta}')
('2', 'P')
('2', 'D')
('2', 'H_{\\theta}')
('2', 'P\\times P')
('2', '\\operatorname{FactorHessian}')
('2', 'H_{\\theta}^{-1}')
('2', '\\displaystyle M,\\lambda=\\operatorname{FactorHessian}({{\\textbf{Z}}^{\\prime}},%\n\\Theta,P,D)\\ \\text{where}')
('2', '\\displaystyle M,\\lambda=\\operatorname{FactorHessian}({{\\textbf{Z}}^{\\prime}},%\n\\Theta,P,D)\\ \\text{where}')
('2', '\\displaystyle\\hat{H}_{\\theta}^{-1}\\coloneqq M\\lambda^{-1}M^{\\intercal}\\approx H%\n_{\\theta}^{-1},')
('2', '\\displaystyle\\hat{H}_{\\theta}^{-1}\\coloneqq M\\lambda^{-1}M^{\\intercal}\\approx H%\n_{\\theta}^{-1},')
('2', 'M\\in\\mathbb{R}^{|\\theta|\\times D}')
('2', '\\lambda\\in\\mathbb{R}^{D\\times D}')
('2', '|\\theta|')
('2', '\\hat{H}_{\\theta}^{-1}')
('2', 'H_{\\theta}^{-1}')
('2', 'D')
('2', 'P')
('2', '\\Theta\\coloneqq(L,f,\\theta)')
('2', '\\hat{H}_{\\theta}^{-1}')
('2', '{{z}^{\\prime}}')
('2', '{z}')
('2', '\\displaystyle\\hat{I}({{z}^{\\prime}},{z})\\coloneqq\\nabla_{\\theta}L({{z}^{\\prime%\n}};\\theta)^{\\intercal}\\hat{H}_{\\theta}^{-1}\\nabla_{\\theta}L({z};\\theta).')
('2', '\\displaystyle\\hat{I}({{z}^{\\prime}},{z})')
('2', '\\displaystyle\\coloneqq\\nabla_{\\theta}L({{z}^{\\prime}};\\theta)^{\\intercal}\\hat{%\nH}_{\\theta}^{-1}\\nabla_{\\theta}L({z};\\theta).')
('3.1', '{z}')
('3.1', 'E({z})')
('3.1', '\\displaystyle E({z})\\coloneqq\\{\\hat{I}({{{z}^{\\prime}}}_{{j}},z)\\}_{j=1}^{{{N}%\n^{\\prime}}},')
('3.1', '\\displaystyle E({z})\\coloneqq\\{\\hat{I}({{{z}^{\\prime}}}_{{j}},z)\\}_{j=1}^{{{N}%\n^{\\prime}}},')
('3.1', '{\\textbf{Z}},{{\\textbf{Z}}^{\\prime}},\\Theta,P,D')
('3.1', 'D')
('3.1', 'M,\\lambda\\leftarrow\\operatorname{FactorHessian}({{\\textbf{Z}}^{\\prime}},\\Theta%\n,P,D)')
('3.1', '\\mu_{i}\\leftarrow\\lambda^{-1/2}M^{\\intercal}\\nabla_{\\theta}L(z_{i};\\theta)')
('3.1', 'i=1,\\hbox to10.00002pt{.\\hss.\\hss.},N')
('3.1', '\\bm{\\mu}\\leftarrow[\\mu_{1},\\hbox to10.00002pt{.\\hss.\\hss.},\\mu_{N}]')
('3.1', '\\bm{\\mu}')
('3.1', '{\\textbf{Z}},{{\\textbf{Z}}^{\\prime}},\\Theta,P,D')
('3.1', 'K')
('3.1', '{{\\textbf{Z}}^{\\prime}}')
('3.1', '\\Theta')
('3.1', 'P')
('3.1', 'D')
('3.1', '\\Phi')
('3.1', '\\bm{\\mu}\\leftarrow\\operatorname{GetEmbeddings}({\\textbf{Z}},{{\\textbf{Z}}^{%\n\\prime}},\\Theta,P,D)')
('3.1', '[r_{1},\\hbox to10.00002pt{.\\hss.\\hss.},r_{{N}}]\\leftarrow\\operatorname{K-Means%\n}(\\bm{\\mu},K)')
('3.1', 'N')
('3.1', '\\{\\{i\\in[N]:r_{i}=k\\}\\ \\text{for}\\ k\\in[K]\\}')
('3.1', '\\{\\Phi_{k}\\}_{k=1}^{K}')
('3.1', '\\displaystyle\\operatorname{argmin}_{\\{\\Phi_{k}\\}_{k=1}^{K}}\\textstyle\\sum_{k}%\n\\textstyle\\sum_{i,i^{\\prime}\\in\\Phi_{k}}||E({{z}}_{{i}})-E({{z}}_{{i^{\\prime}}%\n})||^{2}.')
('3.1', '\\displaystyle\\operatorname{argmin}_{\\{\\Phi_{k}\\}_{k=1}^{K}}\\textstyle\\sum_{k}%\n\\textstyle\\sum_{i,i^{\\prime}\\in\\Phi_{k}}||E({{z}}_{{i}})-E({{z}}_{{i^{\\prime}}%\n})||^{2}.')
('3.2', '{{N}^{\\prime}}')
('3.2', '\\mu(z)')
('3.2', 'z')
('3.2', '\\displaystyle\\mu(z)\\coloneqq\\lambda^{-1/2}M^{\\intercal}\\nabla_{\\theta}L(z;\\theta)')
('3.2', '\\displaystyle\\mu(z)\\coloneqq\\lambda^{-1/2}M^{\\intercal}\\nabla_{\\theta}L(z;\\theta)')
('3.2', 'M')
('3.2', '\\lambda')
('3.2', '{{z}^{\\prime}}')
('3.2', '{z}')
('3.2', '\\hat{I}({{z}^{\\prime}},{z})=\\mu({{z}^{\\prime}})^{\\intercal}\\mu({z})')
('3.2', 'D')
('3.2', 'P')
('3.2', 'D')
('3.2', 'C>0')
('3.2', '{{z}}_{{i}},{{z}}_{{j}}')
('3.2', '||E({{z}}_{{i}})-E({{z}}_{{j}})||^{2}\\leq C||\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})%\n)||^{2}')
('3.3', '\\bm{\\mu}\\coloneqq[\\mu({z}_{1}),\\hbox to10.00002pt{.\\hss.\\hss.},\\mu({z}_{{N}})]')
('3.3', '\\{\\Phi_{k}\\}')
('3.3', '\\displaystyle\\textstyle\\sum_{k}\\textstyle\\sum_{i,i^{\\prime}\\in\\Phi_{k}}||E({{z%\n}}_{{i}})-E({{z}}_{{i^{\\prime}}})||^{2}\\leq C\\textstyle\\sum_{k}\\textstyle\\sum_%\n{i,i^{\\prime}\\in\\Phi_{k}}||\\mu({{z}}_{{i}})-\\mu({{z}}_{{i^{\\prime}}})||^{2}.')
('3.3', '\\displaystyle\\textstyle\\sum_{k}\\textstyle\\sum_{i,i^{\\prime}\\in\\Phi_{k}}||E({{z%\n}}_{{i}})-E({{z}}_{{i^{\\prime}}})||^{2}\\leq C\\textstyle\\sum_{k}\\textstyle\\sum_%\n{i,i^{\\prime}\\in\\Phi_{k}}||\\mu({{z}}_{{i}})-\\mu({{z}}_{{i^{\\prime}}})||^{2}.')
('3.3', 'C>0')
('3.3', '\\mathcal{O}')
('3.3', 'P')
('3.3', 'P')
('3.3', 'P')
('3.3', '\\mathcal{O}')
('3.3', '\\times')
('3.3', '\\times')
('3.4', '\\operatorname{InfEmbed}')
('3.4', 'K')
('3.4', 'K')
('3.4', 'K')
('3.4', 'A')
('3.4', 'S')
('3.4', 'B')
('3.4', 'A')
('3.4', 'S')
('3.5', 'z=(x,y)')
('3.5', 'z^{\\prime}=(x^{\\prime},y^{\\prime})')
('3.5', 'f')
('3.5', 'z,z^{\\prime}')
('3.5', '\\displaystyle\\nabla_{\\theta}L(z;\\theta)^{\\intercal}\\nabla_{\\theta}L(z^{\\prime}%\n;\\theta)=(y-p)^{\\intercal}(y^{\\prime}-p^{\\prime})x^{\\intercal}x^{\\prime},')
('3.5', '\\displaystyle\\nabla_{\\theta}L(z;\\theta)^{\\intercal}\\nabla_{\\theta}L(z^{\\prime}%\n;\\theta)=(y-p)^{\\intercal}(y^{\\prime}-p^{\\prime})x^{\\intercal}x^{\\prime},')
('3.5', 'L')
('3.5', '\\theta')
('3.5', 'z')
('3.5', 'p\\coloneqq[p_{1},\\hbox to10.00002pt{.\\hss.\\hss.},p_{C}]=\\operatorname{softmax}%\n(f(x))')
('3.5', 'y')
('3.5', 'x')
('3.5', 'p^{\\prime},y^{\\prime},x^{\\prime}')
('3.5', 'z^{\\prime}')
('3.5', 'x^{\\intercal}x^{\\prime}')
('3.5', '(y-p)^{\\intercal}(y^{\\prime}-p^{\\prime})')
('3.5', '(y-p)')
('3.5', '(y^{\\prime}-p^{\\prime})')
('3.6', 'k')
('3.6', 'k')
('3.6', '\\Phi')
('3.6', '[\\mu(z^{\\prime}_{1}),\\dots,\\mu(z^{\\prime}_{N^{\\prime}})]')
('3.6', 'v\\coloneqq\\sum_{i\\in\\Phi}\\mu({z_{i}})')
('3.6', 'k')
('3.6', 'O')
('3.6', 'k')
('3.6', 'z^{\\prime}')
('3.6', 'v^{\\intercal}\\mu({z^{\\prime}})')
('3.6', 'O=\\operatorname{argmin}_{O^{\\prime}\\subseteq[N^{\\prime}],|O^{\\prime}|=k}v^{%\n\\intercal}(\\sum_{i\\in O^{\\prime}}\\mu(z^{\\prime}_{i^{\\prime}}))')
('4', '\\nabla_{\\theta}L(z;\\theta)')
('4', 'M,\\lambda^{1/2}')
('4', 'P=500')
('4', 'D=100')
('4.1', 'k=10')
('4.2', '\\operatorname{InfEmbed}')
('4.2', '\\operatorname{InfEmbed}')
('4.3', '\\operatorname{RuleFind}')
('4.3', '40')
('4.3', '\\operatorname{RuleFind}')
('4.3', '40')
('4.4', 'K=25')
('5', '\\operatorname{InfEmbed}')
('x1', 'H_{\\theta}')
('x1', 'I({{z}^{\\prime}},{z})\\coloneqq\\nabla_{\\theta}L({{z}^{\\prime}};\\theta)^{%\n\\intercal}H_{\\theta}^{-1}\\nabla_{\\theta}L({z};\\theta),')
('x1', 'H_{\\theta}^{-1}')
('x1', 'H_{\\theta}')
('x1', '(q_{1},\\hbox to10.00002pt{.\\hss.\\hss.},q_{D})')
('x1', 'P')
('x1', '(b,H_{\\theta}b,\\hbox to10.00002pt{.\\hss.\\hss.},H_{\\theta}^{P-1})')
('x1', 'R')
('x1', 'H_{\\theta}')
('x1', 'H_{\\theta}=QRQ^{\\intercal}')
('x1', 'Q\\coloneqq[q_{1},\\hbox to10.00002pt{.\\hss.\\hss.},q_{P}]\\in\\mathbb{R}^{|\\theta|%\n\\times P}')
('x1', 'R\\in\\mathbb{R}^{P\\times P}')
('x1', 'P')
('x1', 'H_{\\theta}')
('x1', 'R\\approx V\\lambda V^{\\intercal}')
('x1', 'R^{-1}\\approx V\\lambda^{-1}V^{\\intercal}')
('x1', 'V=[v_{1},\\hbox to10.00002pt{.\\hss.\\hss.},v_{D}]\\in\\mathbb{R}^{P\\times D}')
('x1', 'v_{1},\\hbox to10.00002pt{.\\hss.\\hss.},v_{D}')
('x1', 'D')
('x1', 'R')
('x1', '\\lambda=\\operatorname{diag}(\\lambda_{1},\\hbox to10.00002pt{.\\hss.\\hss.},%\n\\lambda_{D})')
('x1', '\\lambda_{1},\\hbox to10.00002pt{.\\hss.\\hss.},\\lambda_{D}')
('x1', 'D')
('x1', 'R')
('x1', 'R')
('x1', 'P\\times P')
('x1', 'P=200')
('x1', 'H_{\\theta}^{-1}')
('x1', '\\displaystyle\\hat{H}_{\\theta}^{-1}\\coloneqq M\\lambda^{-1}M^{\\intercal},\\ \\text%\n{where}\\ M=QV')
('x1', '\\displaystyle\\hat{H}_{\\theta}^{-1}')
('x1', '\\displaystyle\\coloneqq M\\lambda^{-1}M^{\\intercal},\\ \\text{where}\\ M=QV')
('x1', '{{z}^{\\prime}}')
('x1', '{z}')
('x1', '\\displaystyle\\hat{I}({{z}^{\\prime}},{z})\\coloneqq\\nabla_{\\theta}L({{z}^{\\prime%\n}};\\theta)^{\\intercal}\\hat{H}_{\\theta}^{-1}\\nabla_{\\theta}L({z};\\theta).')
('x1', '\\displaystyle\\hat{I}({{z}^{\\prime}},{z})')
('x1', '\\displaystyle\\coloneqq\\nabla_{\\theta}L({{z}^{\\prime}};\\theta)^{\\intercal}\\hat{%\nH}_{\\theta}^{-1}\\nabla_{\\theta}L({z};\\theta).')
('x1', '\\hat{H}_{\\theta}^{-1}')
('x1', '\\Theta\\coloneqq(L,f,\\theta)')
('x1', '\\triangleright')
('x1', '{{\\textbf{Z}}^{\\prime}}')
('x1', '\\Theta')
('x1', 'P')
('x1', 'D')
('x1', '{{\\textbf{Z}}^{\\prime}}')
('x1', '\\Theta')
('x1', 'P')
('x1', 'D')
('x1', 'H_{\\theta}\\leftarrow\\sum_{i=1}^{N^{\\prime}}\\nabla_{\\theta}^{2}L({{{z}^{\\prime}%\n}}_{{i}};\\theta)')
('x1', 'H_{\\theta}')
('x1', 'P')
('x1', 'Q\\in\\mathbb{R}^{|\\theta|\\times P},R\\in\\mathbb{R}^{P\\times P}')
('x1', 'V,\\lambda\\leftarrow')
('x1', 'D')
('x1', 'R')
('x1', 'M\\leftarrow QV')
('x1', 'M,\\lambda')
('A2.1', 'C')
('A2.1', '{{z}}_{{i}},{{z}}_{{j}}')
('A2.1', '||E({{z}}_{{i}})-E({{z}}_{{j}})||^{2}\\leq C||\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})%\n)||^{2}')
('A2.1', '\\displaystyle||E({{{z}}_{{i}}})-E({{{z}}_{{j}}})||^{2}=\\textstyle\\sum_{n=1}^{N%\n^{\\prime}}(\\hat{I}({{{{z}^{\\prime}}}_{{n}}},{{z}}_{{i}})-\\hat{I}({{{z}^{\\prime%\n}}}_{{n}},{{z}}_{{j}}))^{2}')
('A2.1', '\\displaystyle||E({{{z}}_{{i}}})-E({{{z}}_{{j}}})||^{2}')
('A2.1', '\\displaystyle=\\textstyle\\sum_{n=1}^{N^{\\prime}}(\\hat{I}({{{{z}^{\\prime}}}_{{n}%\n}},{{z}}_{{i}})-\\hat{I}({{{z}^{\\prime}}}_{{n}},{{z}}_{{j}}))^{2}')
('A2.1', '\\displaystyle=\\textstyle\\sum_{n=1}^{N^{\\prime}}(\\mu({{{z}^{\\prime}}}_{{n}})^{%\n\\intercal}\\mu({{z}}_{{i}})-\\mu({{{z}^{\\prime}}}_{{n}})^{\\intercal}\\mu({{z}}_{{%\nj}}))^{2}')
('A2.1', '\\displaystyle=\\textstyle\\sum_{n=1}^{N^{\\prime}}(\\mu({{{z}^{\\prime}}}_{{n}})^{%\n\\intercal}\\mu({{z}}_{{i}})-\\mu({{{z}^{\\prime}}}_{{n}})^{\\intercal}\\mu({{z}}_{{%\nj}}))^{2}')
('A2.1', '\\displaystyle=\\textstyle\\sum_{n=1}^{N^{\\prime}}(\\mu({{{z}^{\\prime}}}_{{n}})^{%\n\\intercal}(\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})))^{2}')
('A2.1', '\\displaystyle=\\textstyle\\sum_{n=1}^{N^{\\prime}}(\\mu({{{z}^{\\prime}}}_{{n}})^{%\n\\intercal}(\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})))^{2}')
('A2.1', '\\displaystyle\\leq\\textstyle\\sum_{n=1}^{N^{\\prime}}||\\mu({{{z}^{\\prime}}}_{{n}}%\n)||^{2}||\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})||^{2}')
('A2.1', '\\displaystyle\\leq\\textstyle\\sum_{n=1}^{N^{\\prime}}||\\mu({{{z}^{\\prime}}}_{{n}}%\n)||^{2}||\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})||^{2}')
('A2.1', '\\displaystyle\\leq C||\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})||^{2},\\ \\text{where}')
('A2.1', '\\displaystyle\\leq C||\\mu({{z}}_{{i}})-\\mu({{z}}_{{j}})||^{2},\\ \\text{where}')
('A2.1', 'C\\coloneqq\\sum_{n=1}^{N^{\\prime}}||\\mu({{{z}^{\\prime}}}_{{n}})||^{2}')
('A2.1', 'i')
('A2.1', 'j')
('A2.2', '\\operatorname{InfEmbed}')
('A2.2', 'K')
('A2.2', 'K')
('A2.2', 'K')
('A2.2', 'A')
('A2.2', 'S')
('A2.2', 'B')
('A2.2', 'A')
('A2.2', 'S')
('A2.2', '\\bm{\\mu},A,S,B')
('A2.2', '\\bm{\\mu}')
('A2.2', 'A')
('A2.2', 'S')
('A2.2', 'B')
('A2.2', 'A')
('A2.2', 'S')
('A2.2', 'acc\\leftarrow')
('A2.2', '\\{\\mu_{i}\\}')
('A2.2', 'size\\leftarrow')
('A2.2', '\\{\\mu_{i}\\}')
('A2.2', 'acc\\leq A')
('A2.2', 'size\\geq S')
('A2.2', '\\{\\bm{\\mu}\\}')
('A2.2', 'size<S')
('A2.2', '\\{\\}')
('A2.2', '\\bm{r}\\leftarrow\\operatorname{K-Means}(\\bm{\\mu},B)')
('A2.2', '\\bm{r}_{k}\\leftarrow\\{\\mu_{i}\\}_{i:r_{i}=k}')
('A2.2', 'k\\in[B]')
('A2.2', 'F=\\{\\}')
('A2.2', 'k\\in[B]')
('A2.2', 'F\\leftarrow F\\cup\\{\\operatorname{RuleFind}(\\{\\mu_{i}\\}_{i:r_{i}=b},A,S,B)\\}')
('A2.2', 'F')
('A2.2', 'A,S,B,{\\textbf{Z}},{{\\textbf{Z}}^{\\prime}},\\Theta,P,D')
('A2.2', '\\bm{\\mu}\\leftarrow\\operatorname{GetEmbeddings}({\\textbf{Z}},{{\\textbf{Z}}^{%\n\\prime}},\\Theta,P,D)')
('A2.2', 'F\\leftarrow\\texttt{RuleFind}(\\bm{\\mu},A,S,B)')
('A2.2', 'F')
('A4.1', 'D=100')
('A4.1', 'P=500')
('A4.1', '\\operatorname{InfEmbed}')
('A4.1', 'K=25')
('A4.1', 'D=100')
('A4.1', 'P=500')
('A4.1', '12282')
('A4.1', '1425')
('A4.1', '200')
('A4.1', '1')
('A4.1', '5')
('A4.1', '0.9')
('A4.1', '0.01')
('A4.1', '10')
('A4.1', '\\gamma=0.1')
('A4.1', '[-1024,1024]')
('A4.1', 'k=3')
