('1', '5 \\times')
('2', 'd')
('2', 'b')
('2', 's')
('2', 'W_K^i \\in {\\mathbb{R}}^{d  \\times d}')
('2', 'W_V^i \\in {\\mathbb{R}}^{d  \\times d}')
('2', 'i^{th}')
('2', 'x_{\\text{prompt}}^i = [x_1^i, ..., x_p^i], x_{\\text{prompt}}^i \\in {\\mathbb{R}}^{ b \\times p \\times d}')
('2', 'i^{th}')
('2', 'i')
('2', '{\\cal{K}}^i, {\\cal{V}}^i \\in {\\mathbb{R}}^{ b \\times p \\times d}')
('2', '{\\cal{K}}^i_0 =x_{\\text{prompt}}^i  W_K^i, {\\cal{V}}^i_0 = x_{\\text{prompt}}^i W_V^i')
('2', 't')
('2', 'i^{th}')
('2', 'x^i_t \\in {\\mathbb{R}}^{ b \\times 1 \\times d}')
('2', '{\\cal{K}}^i_{t+1} = [{\\cal{K}}^i_t, x^i_tW_K^i], {\\cal{V}}^i_{t+1} = [{\\cal{V}}^i_t, x^i_tW_V^i]')
('2.0', '\\times')
('2.0', '\\times')
('2.1', 'O(n^2)')
('2.1', 'n')
('3.0', 't')
('3.0', '\\frac{1}{t}')
('3.0', '\\frac{1}{t}')
('3.1', 't')
('3.1', '\\alpha')
('3.1', 't')
('3.1', 'S_{t}')
('3.1', 't')
('3.1', 'S_{ a\\rightarrow b}')
('3.1', 'a')
('3.1', 'b')
('3.1', 'S_{ a\\rightarrow b} = \\cup^{t = b}_{t = a}S_{t}')
('3.1', 'l')
('3.1', 'S_{ 1 \\rightarrow t} \\in \\{ x_1, ... x_t \\}')
('3.1', '\\{ x_1,..., x_t \\}')
('3.1', 't')
('3.1', 'S_{ t+1 \\rightarrow l} \\in \\{ x_1, ... x_t \\}')
('3.1', '\\{ x_1,..., x_t \\}')
('3.1', 't')
('3.1', 'S_{t+1 \\rightarrow l}')
('3.1', '\\emph{Persistence Ratio} = \\frac{ |S_{t+1 \\rightarrow l} \\cap S_{0 \\rightarrow t}|}{ |\\{ x | x \\in S_{t+1 \\rightarrow l}, x \\in \\{x_1,..., x_t\\} \\}|}')
('3.1', '\\frac{ |S_{0 \\rightarrow t}|}{t}')
('3.1', '|S_{0 \\rightarrow t}| = t')
('3.1', 't = \\frac{l}{2}')
('3.1', '\\alpha = \\frac{1}{t}')
('3.1', 't')
('3.1', 'S_{0 \\rightarrow t}')
('3.2', '\\label{eq:basic_transformer}\n    x_{t+1} = \\mathcal{F}\\left(a_{t}\\right) \\textrm{, where } a_{t} = \\texttt{softmax}\\left(\\sfrac{1}{t}\\cdot x_tW_QW_K^\\top X_{t-1}^\\top\\right)X_{t-1}W_VW_O')
('3.2', 'x_t\\in\\mathbb{R}^{1\\times d}')
('3.2', 'X_{t-1}\\in\\mathbb{R}^{(t-1)\\times d}')
('3.2', 'x_1,\\dots, x_{t-1}')
('3.2', 'j')
('3.2', 'x_j')
('3.2', 'W_Q, W_K, W_V\\in\\mathbb{R}^{d\\times p}')
('3.2', 'W_O\\in\\mathbb{R}^{p\\times d}')
('3.2', '\\mathcal{F}:\\mathbb{R}^{1\\times d}\\rightarrow\\mathbb{R}^{1\\times d}')
('3.2', '\\label{eq:basic_mlp}\n    \\mathcal{F}(x) = x + W_2\\texttt{relu}(W_1x)')
('3.2', '\\alpha_{t} = \\texttt{softmax}(\\sfrac{1}{t}\\cdot x_tW_QW_K^\\top X_{t-1}^\\top)')
('3.2', '\\alpha_{t,j}')
('3.2', 'x_tW_QW_K^\\top x_j^\\top')
('3.2', 'x_tW_QW_K^\\top x_j^\\top')
('3.2', 'A = W_VW_OW_QW_K^\\top')
('3.2', '\\lambda_K,\\lambda_Q,\\lambda_V,\\lambda_O')
('3.2', 'W_K, W_Q, W_V, W_O')
('3.2', '\\left\\|x_t\\right\\|_2 = 1')
('3.2', 't')
('3.2', 'c,\\epsilon > 0')
('3.2', 'a_{t}x_{t+1}^\\top \\geq (1-\\delta)\\left\\|a_{t}\\right\\|_2')
('3.2', '\\delta \\leq \\left(\\frac{c\\epsilon}{\\lambda_Q\\lambda_K\\lambda_V\\lambda_O}\\right)^2')
('3.2', 'x_{\\ell}')
('3.2', 'x_{\\ell}Ax_{\\ell}^\\top\\geq c')
('3.2', 'x_{\\ell}Ax_{\\ell}\\geq \\epsilon^{-1}\\max_{j\\in[t], j\\neq \\ell}x_jAx_{\\ell}^\\top')
('3.2', '\\label{eq:theo3.1}\n        \\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}(\\alpha_{t,\\ell} - 3\\epsilon) \\leq x_{t+1}W_QW_K^\\top x_j^\\top\\leq \\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}(\\alpha_{t,\\ell} + 3\\epsilon)')
('3.2', 'x_{\\ell}')
('3.2', 'x_{\\ell}Ax_{\\ell}^\\top')
('3.2', 'x_{t+1}W_QW_K^\\top x_j^\\top')
('3.2', 'a_{t}x_{t+1}^\\top \\geq (1-\\delta)\\left\\|a_{t}\\right\\|_2')
('3.2', '\\mathcal{F}')
('3.2', '\\left\\|x\\right\\|_2 \\gg \\left\\|W_2\\texttt{relu}(W_1x)\\right\\|_2')
('3.2', '\\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}')
('3.2', 'x_{t+1}W_QW_K^\\top x_j^\\top')
('3.2', '\\alpha_{t,\\ell}')
('3.2', 'x_{t+1}W_QW_K^\\top x_j^\\top')
('3.2', '\\alpha_{t+1,\\ell}')
('3.2', '\\alpha_{t,\\ell}')
('3.2', '\\alpha_{t+1,\\ell}')
('3.2', 'x_{\\ell}')
('3.2', 'x_{\\ell}Ax_{\\ell}^\\top')
('3.2', 'A')
('3.2', 'A')
('3.2', 'x_{\\ell}')
('4', 'B')
('4', 'T_{\\text{max}}')
('4', '\\Bar{\\mathcal{K}} \\in R^{n \\times d}')
('4', '\\Bar{\\mathcal{V}} \\in R^{n \\times d}')
('4', 'n = 0')
('4', '\\Bar{\\mathcal{K}}, \\Bar{\\mathcal{V}}')
('4', 'n \\leftarrow n + 1')
('4', 'n \\leq B')
('4', 't \\leftarrow t+1')
('4', '\\Bar{\\mathcal{K}} \\in \\mathbf{R}^{n \\times d}')
('4', '\\Bar{\\mathcal{V}} \\in R^{n \\times d}')
('4', 'w')
('4', 'r')
('4', 'm')
('4', 't')
('4', 'I \\leftarrow \\vec{0} \\in R^{t}')
('4', 'I \\leftarrow I + \\alpha_i < \\frac{1}{t}')
('4', 'I[:-r] \\leftarrow  0')
('4', 'S_t \\leftarrow \\textit{Argsort}\\left(I\\right)[:-m]')
('4', 'S_t')
('4', '\\Bar{\\mathcal{K}} \\in R^{n \\times d}')
('4', '\\Bar{\\mathcal{V}} \\in R^{n \\times d}')
('4', 'n \\leftarrow n - m')
('4.0', 'i')
('4.0', '\\mathcal{K}_t, \\mathcal{V}_t \\in  R^{t \\times d}')
('4.0', 't')
('4.0', 'x_t\\in\\mathbb{R}^{1\\times d}')
('4.0', 't')
('4.0', 't')
('4.0', 'a_{t} = \\sum_{i=1}^{t} \\alpha_{t,i} \\mathcal{V}[i]_t  \\textrm{, where } \\alpha_{t, i} = \\frac{\\exp(\\langle  x_t W_K , \\mathcal{K}_t[i] \\rangle )}{\\sum_{i=1}^{t} \\exp(\\langle  x_t W_K , \\mathcal{K}_t[i] \\rangle )}')
('4.0', '\\alpha_{t,i}')
('4.0', 'B')
('4.0', 'B')
('4.0', 'B')
('4.0', '\\{x_1, \\ldots, x_t, \\ldots\\}')
('4.0', 'B')
('4.0', '\\Bar{\\mathcal{K}}_t')
('4.0', '\\Bar{\\mathcal{V}}_t')
('4.0', '\\Bar{\\mathcal{K}}_t, \\Bar{\\mathcal{V}}_t \\in R^{n \\times d}')
('4.0', 'n < B')
('4.0', 'w')
('4.0', 'r')
('4.0', 'r = 10')
('4.0', 'w = 400')
('4.0', '\\hat{a}_{t} = \\sum_{i = 1}^n \\hat{\\alpha}_{t,i} \\Bar{\\mathcal{V}}_t[i]  \\textrm{, where } \\hat{\\alpha}_{t, i} = \\frac{\\exp(\\langle  x_t W_K , \\Bar{\\mathcal{K}}_{t}[i] \\rangle )}{\\sum_{i = 1}^n \\exp(\\langle  x_t W_K , \\Bar{\\mathcal{K}}_t[i] \\rangle )}')
('4.0', 'm')
('4.0', 'm = 0.5B')
('4.0', 'L')
('4.0', 'H')
('4.1', '\\{\\tilde{x}_t\\}_{t=0}^T')
('4.1', 'm = 1')
('4.1', '\\tilde{x}_{t+1} = \\mathcal{F}\\left(\\tilde{a}_{t}\\right) \\textrm{, where } \\tilde{a}_{t} = \\textrm{\\texttt{softmax}}\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_t W_Q\\tilde{\\mathcal{K}}_t^\\top\\right)\\tilde{\\mathcal{V}}_t^\\top W_O')
('4.1', 'm = 1')
('4.1', 'B')
('4.1', '\\{x_t\\}_{t=0}^T')
('4.1', '\\left\\|x_t - \\tilde{x}_t\\right\\|_2')
('4.1', '\\lambda_1,\\lambda_2')
('4.1', 'W_1')
('4.1', 'W_2')
('4.1', '\\beta_{t,j} = \\frac{\\exp\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_j^\\top\\right)}{\\sum_{i=1}^{t-1}\\exp\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_i^\\top\\right)}')
('4.1', '\\beta_{t,j} = cv_{t,j}')
('4.1', 'v_{t,j}')
('4.1', 'f(x) = c(x+b)^{-k}')
('4.1', '\\lambda_V\\lambda_O(1+ \\lambda_1\\lambda_2)(1 + \\lambda_Q\\lambda_K) \\leq \\frac{1}{2}')
('4.1', 'T_{\\min}')
('4.1', 'T_{\\max}')
('4.1', 'B \\leq T_{\\max}')
('4.1', 't\\in[T_{\\min}, T_{\\max}]')
('4.1', 'S_t')
('4.1', 'B')
('4.1', '\\beta_{t,j}')
('4.1', '\\left|S_t\\right| = B')
('4.1', '\\min_{j\\in S_t}\\beta_{t,j} \\geq \\max_{j\\notin\\hat{S}_t}\\beta_{t,j}')
('4.1', '\\epsilon\\in(0,1)')
('4.1', '1 - T_{\\max}\\exp\\left(-\\frac{\\epsilon^2b^2(T_{\\min}-1)}{(k-2)^2(u-b)^2}\\right) - T_{\\max}\\exp\\left(-\\frac{2(T_{\\min}-1)(1-\\sfrac{B}{T_{\\max}})^2}{(1-\\epsilon)^2}\\right)')
('4.1', 't\\in [T_{\\min}, T_{\\max}]')
('4.1', '\\label{eq:err_bound}\n        \\mathbb{E}\\left[\\left\\|x_t - \\tilde{x}_t\\right\\|_2\\right] \\leq \\frac{2.1(1-\\sfrac{B}{T_{\\max}})}{(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\sfrac{1}{(k-1)}}\\right)')
('4.1', '\\beta_{t,j}')
('4.1', '1-\\sfrac{B}{T_{\\max}}')
('4.1', 'B=T_{\\max}')
('4.1', 'k - (k-1)\\left(\\frac{1-\\epsilon}{B-\\epsilon}\\right)^{\\sfrac{1}{(k-1)}}')
('5', '\\times')
('5', '\\times')
('5', '\\times')
('5', '\\times')
('5', '\\times')
('5', '2\\times')
('5', '3 \\times')
('5', '\\frac{\\alpha_s - \\alpha_o}{\\alpha_o}')
('5', '\\alpha_s')
('5', '\\alpha_o')
('5', '\\alpha_s')
('5', 'n')
('5', '\\{x^{top\\_n}_t\\}_{t=0}^T')
('5', "\\{x'_t\\}_{t=0}^T")
('5', 'n')
('5', "similarity\\left(x^{topB}_t, x_t\\right) \\leq \\left(x'_t, x_t\\right)")
('7', '5\\times')
('9.1', '\\mathcal{F}')
('9.1', '\\mathcal{F}')
('9.1', 'x')
('9.1', 'x')
('9.1', '\\mathcal{F}(x)')
('10.0', '\\label{eq:appendix_basic_transformer}\n    x_{t+1} = \\mathcal{F}\\left(a_{t}\\right) \\textrm{, where } a_{t} = \\texttt{softmax}\\left(\\sfrac{1}{t}\\cdot x_tW_QW_K^\\top X_{t-1}^\\top\\right)X_{t-1}W_VW_O')
('10.0', 'x_t\\in\\mathbb{R}^{1\\times d}')
('10.0', 'X_{t-1}\\in\\mathbb{R}^{(t-1)\\times d}')
('10.0', 'x_1,\\dots, x_{t-1}')
('10.0', 'j')
('10.0', 'x_j')
('10.0', 'W_Q, W_K, W_V\\in\\mathbb{R}^{d\\times p}')
('10.0', 'W_O\\in\\mathbb{R}^{p\\times d}')
('10.0', '\\mathcal{F}:\\mathbb{R}^{1\\times d}\\rightarrow\\mathbb{R}^{1\\times d}')
('10.0', '\\label{eq:appendix_basic_mlp}\n    \\mathcal{F}(x) = x + W_2\\texttt{relu}(W_1x)')
('10.0', '\\alpha_{t} = \\texttt{softmax}(\\sfrac{1}{t}\\cdot x_tW_QW_K^\\top X_{t-1}^\\top)')
('10.0', '\\alpha_{t,j}')
('10.0', 'x_tW_QW_K^\\top x_j^\\top')
('10.0', 'A = W_VW_OW_QW_K^\\top')
('10.0', '\\lambda_K,\\lambda_Q,\\lambda_V,\\lambda_O')
('10.0', 'W_K, W_Q, W_V, W_O')
('10.0', '\\left\\|x_t\\right\\|_2 = 1')
('10.0', 't')
('10.0', 'c,\\epsilon > 0')
('10.0', 'a_{t}x_{t+1}^\\top \\geq (1-\\delta)\\left\\|a_{t}\\right\\|_2')
('10.0', '\\delta \\leq \\left(\\frac{c\\epsilon}{\\lambda_Q\\lambda_K\\lambda_V\\lambda_O}\\right)^2')
('10.0', 'x_{\\ell}')
('10.0', 'x_{\\ell}Ax_{\\ell}^\\top\\geq c')
('10.0', 'x_{\\ell}Ax_{\\ell}\\geq \\epsilon^{-1}\\max_{j\\in[t], j\\neq \\ell}x_jAx_{\\ell}^\\top')
('10.0', '\\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}(\\alpha_{t,\\ell} - 3\\epsilon) \\leq x_{t+1}W_QW_K^\\top x_j^\\top\\leq \\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}(\\alpha_{t,\\ell} + 3\\epsilon)')
('10.0', 'x_1, x_2\\in\\mathbb{R}^{1\\times m}')
('10.0', '\\left\\|x_1\\right\\|_2 = \\left\\|x_2\\right\\|_2 = 1')
('10.0', 'x_1x_2^\\top\\geq 1-\\delta')
('10.0', '\\delta\\in(0,1)')
('10.0', 'y\\in\\mathbb{R}^{1\\times m}')
('10.0', '\\begin{aligned}\n    \\left|x_1 y^\\top - x_2 y^\\top\\right|\\leq \\sqrt{2\\delta}\\left\\|y\\right\\|_2\n\\end{aligned}')
('10.0', 'x_2 = x_2^\\parallel + x_2^\\perp')
('10.0', '\\begin{aligned}\n    x_2^\\parallel = x_1 x_2^\\top\\cdot x_1;\\quad x_2^\\perp = x_2 - x_2^\\parallel\n\\end{aligned}')
('10.0', 'x_2^\\perp x_1^\\top  = 0')
('10.0', '\\begin{aligned}\n    \\left\\|x_2^\\perp\\right\\|_2^2 = \\left\\|x_2\\right\\|_2^2 - \\left\\|x_2^\\parallel\\right\\|_2^2 = \\delta(2-\\delta)\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\left\\|x_1 - x_2\\right\\|_2^2 & = \\left\\|(x_1 - x_2^\\parallel) - x_2^\\perp\\right\\|_2^2\\\\\n    & = \\left\\|\\left(1 - x_1 x_2^\\top\\right)x_1 - x_2^\\perp\\right\\|_2^2\\\\\n    & = \\left(1 - x_1 x_2^\\top\\right)^2 + \\left\\|x_2^\\perp\\right\\|_2^2\\\\\n    & = 2\\delta\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\left|x_1 y^\\top - x_2 y^\\top\\right|\\leq \\left\\|x_1 - x_2\\right\\|_2\\cdot\\left\\|y\\right\\|_2 = \\sqrt{2\\delta}\\left\\|y\\right\\|_2\n\\end{aligned}')
('10.0', '\\ell\\in[t]')
('10.0', 'x_{\\ell} Ax_{\\ell}^\\top > \\epsilon^{-1}\\left|x_jAx_{\\ell}^\\top\\right|')
('10.0', 'j\\neq \\ell')
('10.0', '\\begin{aligned}\n        \\left(\\mathcal{S}(t)_{\\ell} - \\epsilon\\right)x_{\\ell}^\\top ax_{\\ell}\\leq x_{\\ell}^\\top W_K^\\top W_Qa_{t} \\leq \\left(\\mathcal{S}(t)_{\\ell} + \\epsilon\\right)x_{\\ell}^\\top ax_{\\ell}\n    \n\\end{aligned}')
('10.0', '\\begin{aligned}\n            a_{t} = \\alpha_tX_{t-1}W_VW_O = \\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}x_j\\right)W_VW_O\n        \n\\end{aligned}')
('10.0', '\\begin{aligned}\n            a_{t}W_Q W_K^\\top x_{\\ell}^\\top = \\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}x_j\\right)W_VW_O  W_QW_K^\\top x_{\\ell}^\\top  = \\sum_{j=1}^{t-1}\\alpha_{t,j}x_j Ax_{\\ell}^\\top\n        \n\\end{aligned}')
('10.0', '\\begin{aligned}\n            \\left|a_{t}W_Q W_K^\\top x_{\\ell}^\\top - \\alpha_{t,\\ell}x_{\\ell}Ax_{\\ell}^\\top\\right| & = \\left|\\sum_{j=1,j\\neq\\ell}^{t-1}\\alpha_{t,j}x_j Ax_{\\ell}^\\top\\right|\\\\\n            & \\leq \\sum_{j=1,j\\neq\\ell}^{t-1}\\alpha_{t,j}\\left|x_j Ax_{\\ell}^\\top\\right|\\\\\n            & \\leq \\epsilon x_{\\ell}Ax_{\\ell}^\\top\\sum_{j=1,j\\neq\\ell}^{t-1}\\alpha_{t,j}\\\\\n            & \\leq \\epsilon x_{\\ell}Ax_{\\ell}^\\top\n        \n\\end{aligned}')
('10.0', '\\epsilon^{-1}\\left|x_j Ax_{\\ell}^\\top\\right| \\leq  x_{\\ell}Ax_{\\ell}^\\top')
('10.0', '\\sum_{j=1,j\\neq\\ell}^{t-1}\\alpha_{t,j}\\leq \\sum_{j=1}^{t-1}\\alpha_{t,j} = 1')
('10.0', '\\begin{aligned}\n            \\left(\\alpha_{t,\\ell} - \\epsilon\\right)x_{\\ell}Ax_{\\ell}^\\top\\leq a_{t}W_Q W_K^\\top x_{\\ell}^\\top \\leq \\left(\\alpha_{t,\\ell} + \\epsilon\\right)x_{\\ell}Ax_{\\ell}^\\top\n        \n\\end{aligned}')
('10.0', '\\left\\|x_{\\ell}\\right\\|_2 = 1')
('10.0', '\\ell')
('10.0', 'a_{t}x_{t+1}^\\top\\geq (1-\\delta)\\left\\|a_{t}\\right\\|_2')
('10.0', '\\begin{aligned}\n    \\left|\\left\\|a_{t}\\right\\|_2^{-1}a_{t} W_QW_K^\\top x_{\\ell}^\\top  - x_{t+1} W_QW_K^\\top x_{\\ell}^\\top\\right| \\leq \\sqrt{2\\delta}\\left\\|W_Q W_K^\\top x_{\\ell}^\\top\\right\\|_2\n\\end{aligned}')
('10.0', '\\lambda_Q, \\lambda_K')
('10.0', 'W_Q')
('10.0', 'W_K')
('10.0', '\\left\\|W_Q W_K^\\top x_{\\ell}^\\top\\right\\|_2 \\leq \\lambda_Q\\lambda_K\\left\\|x_{\\ell}\\right\\|_2')
('10.0', '\\left\\|x_{\\ell}\\right\\|_2 = 1')
('10.0', '\\begin{aligned}\n    \\left|\\left\\|a_{t}\\right\\|_2^{-1}a_{t} W_QW_K^\\top x_{\\ell}^\\top  - x_{t+1} W_QW_K^\\top x_{\\ell}^\\top\\right| \\leq \\sqrt{2\\delta}\\lambda_Q\\lambda_K\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\left\\|a_{t}\\right\\|_2 & = \\left\\|\\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}x_j\\right)W_VW_O\\right\\|\\\\\n    & \\leq \\lambda_O\\lambda_V\\left\\|\\sum_{j=1}^{t-1}\\alpha_{t,j}x_j\\right\\|_2\\\\\n    & \\leq \\lambda_O\\lambda_V\\sum_{j=1}^{t-1}\\alpha_{t,j}\\left\\|x_j\\right\\|_2\\\\\n    & = \\lambda_O\\lambda_V\n\\end{aligned}')
('10.0', '\\delta\\leq \\left(\\frac{c\\epsilon}{\\lambda_Q\\lambda_K\\lambda_V\\lambda_O}\\right)^2')
('10.0', '\\begin{aligned}\n    \\left|\\left\\|a_{t}\\right\\|_2^{-1}a_{t} W_QW_K^\\top x_{\\ell}^\\top  - x_{t+1} W_QW_K^\\top x_{\\ell}^\\top\\right| \\leq \\frac{2c\\epsilon}{\\lambda_V\\lambda_O} \\leq \\frac{2c\\epsilon}{\\left\\|a_{t}\\right\\|_2}\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\left|a_{t} W_QW_K^\\top x_{\\ell}^\\top - \\alpha_{t,\\ell}x_{\\ell}Ax_{\\ell}^\\top\\right| \\leq \\epsilon x_{\\ell}^\\top ax_{\\ell}\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\left|x_{t+1} W_QW_K^\\top x_{\\ell}^\\top - \\left\\|a_{t+1}\\right\\|_2^{-1} \\alpha_{t,\\ell}x_{\\ell}Ax_{\\ell}^\\top\\right| \\leq \\frac{\\epsilon}{\\left\\|a_{t}\\right\\|_2}x_{\\ell}^\\top ax_{\\ell} + \\frac{2c\\epsilon}{\\left\\|a_{t}\\right\\|_2}\n\\end{aligned}')
('10.0', 'x_{\\ell}^\\top ax_{\\ell} \\geq c')
('10.0', '\\begin{aligned}\n    \\frac{2c\\epsilon}{\\left\\|a_{t}\\right\\|_2} \\leq \\frac{2\\epsilon}{\\left\\|a_{t}\\right\\|_2}x_{\\ell}^\\top ax_{\\ell}\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\left|x_{t+1} W_QW_K^\\top x_{\\ell}^\\top - \\left\\|a_{t}\\right\\|_2^{-1} \\alpha_{t,\\ell}x_{\\ell}Ax_{\\ell}^\\top\\right| \\leq \\frac{3\\epsilon}{\\left\\|a_{t}\\right\\|_2}x_{\\ell}^\\top ax_{\\ell}\n\\end{aligned}')
('10.0', '\\begin{aligned}\n    \\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}(\\alpha_{t,\\ell} - 3\\epsilon) \\leq x_{t+1} W_QW_K^\\top x_{\\ell}^\\top \\leq \\frac{x_{\\ell}Ax_{\\ell}^\\top}{\\left\\|a_{t}\\right\\|_2}(\\alpha_{t,\\ell} + 3\\epsilon)\n\\end{aligned}')
('10.1', '\\{\\tilde{x}_t\\}_{t=0}^T')
('10.1', 'm = 1')
('10.1', '\\tilde{x}_{t+1} = \\mathcal{F}\\left(\\tilde{a}_{t}\\right) \\textrm{, where } \\tilde{a}_{t} = \\textrm{\\texttt{softmax}}\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_t W_Q\\tilde{\\mathcal{K}}_t^\\top\\right)\\tilde{\\mathcal{V}}_t^\\top W_O')
('10.1', 'm = 1')
('10.1', 'B')
('10.1', '\\{x_t\\}_{t=0}^T')
('10.1', '\\left\\|x_t - \\tilde{x}_t\\right\\|_2')
('10.1', '\\lambda_1,\\lambda_2')
('10.1', 'W_1')
('10.1', 'W_2')
('10.1', '\\beta_{t,j} = \\frac{\\exp\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_j^\\top\\right)}{\\sum_{i=1}^{t-1}\\exp\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_i^\\top\\right)}')
('10.1', '\\beta_{t,j} = cv_{t,j}')
('10.1', 'v_{t,j}')
('10.1', 'f(x) = c(x+b)^{-k}')
('10.1', '\\lambda_V\\lambda_O(1+ \\lambda_1\\lambda_2)(1 + \\lambda_Q\\lambda_K) \\leq \\frac{1}{2}')
('10.1', 'T_{\\min}')
('10.1', 'T_{\\max}')
('10.1', 'B \\leq T_{\\max}')
('10.1', 't\\in[T_{\\min}, T_{\\max}]')
('10.1', 'S_t')
('10.1', 'B')
('10.1', '\\beta_{t,j}')
('10.1', '\\left|S_t\\right| = B')
('10.1', '\\min_{j\\in S_t}\\beta_{t,j} \\geq \\max_{j\\notin\\hat{S}_t}\\beta_{t,j}')
('10.1', '\\epsilon\\in(0,1)')
('10.1', '1 - T_{\\max}\\exp\\left(-\\frac{\\epsilon^2b^2(T_{\\min}-1)}{(k-2)^2(u-b)^2}\\right) - T_{\\max}\\exp\\left(-\\frac{2(T_{\\min}-1)(1-\\sfrac{B}{T_{\\max}})^2}{(1-\\epsilon)^2}\\right)')
('10.1', 't\\in [T_{\\min}, T_{\\max}]')
('10.1', '\\mathbb{E}\\left[\\left\\|x_t - \\tilde{x}_t\\right\\|_2\\right] \\leq \\frac{2.1(1-\\sfrac{B}{T_{\\max}})}{(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\sfrac{1}{(k-1)}}\\right)')
('10.1', 'm_{k,j} = \\mathbb{I}\\left\\{j\\in S_t\\right\\}')
('10.1', 'm_{k,j}')
('10.1', '\\tilde{a}_{t}')
('10.1', '\\label{eq:sampled_a}\n    \\tilde{a}_{t} = \\left(\\sum_{j=1}^{t-1}\\tilde{\\alpha}_{t,j}\\tilde{x}_j\\right)W_VW_O;\\quad \\tilde{\\alpha}_{t,j} = \\frac{m_{k,j}\\exp\\left(\\sfrac{1}{t}\\cdot \\tilde{x}_tW_QW_K^\\top \\tilde{x}_j^\\top\\right)}{\\sum_{i=1}^{t-1}m_{k,j}\\exp\\left(\\sfrac{1}{t}\\cdot \\tilde{x}_tW_QW_K^\\top \\tilde{x}_i^\\top\\right)}')
('10.1', '\\{x_i\\}_{i=1}^t')
('10.1', '\\{y_i\\}_{i=1}^t')
('10.1', '\\left\\|x_i\\right\\|_2 = \\left\\|y_i\\right\\|_2 = 1')
('10.1', 'i\\in[t]')
('10.1', 'X_{t-1}, Y_{t-1}\\in\\mathbb{R}^{(t-1)\\times d}')
('10.1', 'i')
('10.1', 'x_i')
('10.1', 'y_i')
('10.1', '\\Delta_t = \\left\\|x_t - y_t\\right\\|_2')
('10.1', '\\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top X_{t-1}^\\top\\right)_2 - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}y_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2\\leq 2\\frac{\\sqrt{t-1}}{t}\\lambda_Q\\lambda_K\\Delta_t')
('10.1', '\\begin{aligned}\n        & \\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top X_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}y_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2\\\\\n        & \\quad\\quad \\leq \\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top X_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2\\\\\n        &\\quad\\quad\\quad\\quad+\\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top Y_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}y_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2\n    \n\\end{aligned}')
('10.1', '\\begin{aligned}\n        & \\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top X_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2\\\\\n        & \\quad\\quad \\leq \\frac{1}{t}\\left\\|x_tW_QW_K^\\top\\left(X_{t-1}- Y_{t-1}\\right)^\\top\\right\\|_2\\\\\n        & \\quad\\quad \\leq \\frac{1}{t}\\lambda_Q\\lambda_K\\left\\|x_t\\right\\|_2\\left\\|X_{t-1}- Y_{t-1}\\right\\|_2\n    \n\\end{aligned}')
('10.1', '\\left\\|x_t\\right\\|_2 = 1')
('10.1', '\\left\\|X_{t-1}- Y_{t-1}\\right\\|_2 = \\left(\\sum_{j=1}^{t-1}\\left\\|x_j - y_j\\right\\|_2\\right)^{\\frac{1}{2}} \\leq \\sqrt{t-1}\\Delta_t')
('10.1', '\\left\\|\\textrm{\\texttt{softmax}}\\left(x_tW_QW_K^\\top X_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(x_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2 \\leq \\frac{\\sqrt{t-1}}{t}\\lambda_Q\\lambda_K\\Delta_t')
('10.1', '\\begin{aligned}\n        & \\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top Y_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}y_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2\\\\\n        & \\quad\\quad \\leq \\frac{1}{t}\\left\\|(x_t - y_t)W_QW_K^\\top Y_{t-1}^\\top\\right\\|_2\\\\\n        & \\quad\\quad \\leq \\frac{1}{t}\\lambda_Q\\lambda_K\\left\\|Y_{t-1}\\right\\|_F\\left\\|x_t - y_t\\right\\|_2\n    \n\\end{aligned}')
('10.1', '\\left\\|x_t - y_t\\right\\|_2 = \\Delta_t')
('10.1', '\\left\\|Y_{t-1}\\right\\|_2 = \\sqrt{t-1}')
('10.1', '\\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}x_tW_QW_K^\\top Y_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{t}y_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2 \\leq \\frac{\\sqrt{t-1}}{t}\\lambda_Q\\lambda_K\\Delta_t')
('10.1', '\\left\\|\\textrm{\\texttt{softmax}}\\left(\\frac{1}{\\sqrt{t}}x_tW_QW_K^\\top X_{t-1}^\\top\\right) - \\textrm{\\texttt{softmax}}\\left(\\frac{1}{\\sqrt{t}}y_tW_QW_K^\\top Y_{t-1}^\\top\\right)\\right\\|_2 \\leq 2\\frac{\\sqrt{t-1}}{t}\\lambda_Q\\lambda_K\\Delta_t')
('10.1', '\\tilde{a}_{t}')
('10.1', 'b_{t}')
('10.1', '\\label{eq:intermediate_a}\n        b_{t} = \\left(\\sum_{j=1}^{t-1}\\beta_{t,j}\\tilde{x}_j\\right)W_VW_O;\\quad\\beta_{t,j} = \\frac{\\exp\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_j^\\top\\right)}{\\sum_{i=1}^{t-1}\\exp\\left(\\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_i^\\top\\right)}')
('10.1', '\\left\\|x_j\\right\\|_2 = 1')
('10.1', 'j\\in[t]')
('10.1', '\\left\\|\\tilde{a}_{t} - b_{t}\\right\\|_2 \\leq \\lambda_V\\lambda_O\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}')
('10.1', '\\tilde{a}_{t} - b_{t} = \\left(\\sum_{j=1}^{t-1}\\left(\\tilde{\\alpha}_{t,j}-\\beta_{t,j}\\right)\\tilde{x}_j\\right)W_VW_O')
('10.1', '\\left\\|\\tilde{a}_{t} - b_{t}\\right\\|_2')
('10.1', '\\left\\|\\tilde{a}_{t} - b_{t}\\right\\|_2 \\leq \\lambda_V\\lambda_O\\sum_{j=1}^{t-1}\\left(\\tilde{\\alpha}_{t,j}-\\beta_{t,j}\\right)\\left\\|\\tilde{x}_j\\right\\|_2 = \\lambda_V\\lambda_O\\sum_{j=1}^{t-1}\\left(\\tilde{\\alpha}_{t,j}-\\beta_{t,j}\\right)')
('10.1', '\\left\\|\\tilde{x}_j\\right\\|_2 = 1')
('10.1', 'j\\in[t]')
('10.1', '\\tilde{\\alpha}_{t,j} - \\beta_{t,j}')
('10.1', '\\hat{S}_t = S_t \\setminus\\{t\\}')
('10.1', 'm_{k,j} = 1')
('10.1', 'j \\in \\hat{S}_t')
('10.1', 'r_{t,j} = \\sfrac{1}{t}\\cdot\\tilde{x}_tW_QW_K^\\top\\tilde{x}_j^\\top')
('10.1', '\\beta')
('10.1', '\\begin{aligned}\n        \\beta_{t,j} = \\frac{\\exp\\left(r_{t,j}\\right)}{\\sum_{i\\in\\hat{S}_t}\\exp\\left(r_{t,i}\\right) + \\sum_{i\\notin\\hat{S}_t}\\exp\\left(r_{t,i}\\right)}\n    \n\\end{aligned}')
('10.1', 'j\\notin\\hat{S}_t')
('10.1', '\\tilde{\\alpha}_{t,j} = 0')
('10.1', 'j\\in \\hat{S}_t')
('10.1', '\\tilde{\\alpha}_{t,j} = \\frac{\\exp\\left(r_{t,j}\\right)}{\\sum_{i\\in\\hat{S}_t}\\exp\\left(r_{t,i}\\right)}')
('10.1', 'j\\in\\hat{S}_t')
('10.1', '\\begin{aligned}\n        \\beta_{t,j} - \\tilde{\\alpha}_{t,j} & = \\exp\\left(r_{t,j}\\right)\\cdot\\frac{\\sum_{i\\notin\\hat{S}_t}\\exp\\left(r_{t,i}\\right)}{\\left(\\sum_{i\\in\\hat{S}_t}\\exp\\left(r_{t,i}\\right)\\right)\\left(\\sum_{i\\in\\hat{S}_t}\\exp\\left(r_{t,i}\\right) + \\sum_{i\\notin\\hat{S}_t}\\exp\\left(r_{t,i}\\right)\\right)}\\\\\n        & = \\frac{\\exp\\left(r_{t,j}\\right)}{\\sum_{i\\in\\hat{S}_t}\\exp\\left(r_{t,i}\\right)}\\cdot\\frac{\\sum_{i\\notin\\hat{S}_t}\\exp\\left(r_{t,i}\\right)}{\\sum_{i\\in\\hat{S}_t}\\exp\\left(r_{t,i}\\right) + \\sum_{i\\notin\\hat{S}_t}\\exp\\left(r_{t,i}\\right)}\\\\\n        & = \\tilde{\\alpha}_{t,j}\\sum_{i\\notin\\hat{S}_t}\\beta_{t,j}\n    \n\\end{aligned}')
('10.1', '\\left\\|\\tilde{a}_{t} - b_{t}\\right\\|_2')
('10.1', '\\left\\|\\tilde{a}_{t} - b_{t}\\right\\|_2 \\leq \\lambda_V\\lambda_O\\left(\\sum_{j\\in\\hat{S}_t}^{t-1}\\tilde{\\alpha}_{t,j}\\sum_{i\\notin\\hat{S}_t}\\beta_{t,j} - \\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}\\right) = 2\\lambda_V\\lambda_O\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}')
('10.1', '\\sum_{j\\in\\hat{S}_t}\\tilde{\\alpha}_{t,j} = 1')
('10.1', '\\lambda_1,\\lambda_2')
('10.1', 'W_1, W_2')
('10.1', 'x_1, x_2\\in\\mathbb{R}^d')
('10.1', '\\left\\|\\mathcal{F}(x_1) - \\mathcal{F}(x_2)\\right\\| \\leq \\left(1 + \\lambda_1\\lambda_2\\right)\\left\\|x_1 - x_2\\right\\|_2')
('10.1', '\\begin{aligned}\n        \\left\\|\\mathcal{F}(x_1) - \\mathcal{F}(x_2)\\right\\| & = \\left\\|\\left(x_1 + W_2\\texttt{relu}\\left(W_1x_1\\right)\\right) - \\left(x_2 + W_2\\texttt{relu}\\left(W_1x_2\\right)\\right)\\right\\|\\\\\n        & \\leq \\left\\|x_1 - x_2\\right\\|_2 + \\left\\|W_2\\texttt{relu}\\left(W_1x_1\\right) - W_2\\texttt{relu}\\left(W_1x_2\\right)\\right\\|\\\\\n        & \\leq \\left\\|x_1 - x_2\\right\\|_2 + \\lambda_2\\left\\|\\texttt{relu}\\left(W_1x_1\\right) - \\texttt{relu}\\left(W_1x_2\\right)\\right\\|\\\\\n        & \\leq \\left\\|x_1 - x_2\\right\\|_2 + \\lambda_2\\left\\|W_1\\left(x_1 - x_2\\right)\\right\\|_2\\\\\n        & \\leq \\left\\|x_1 - x_2\\right\\|_2 + \\lambda_1\\lambda_1\\left\\|x_1 - x_2\\right\\|_2\\\\\n        & = (1 + \\lambda_1\\lambda_2)\\left\\|x_1 - x_2\\right\\|_2\n    \n\\end{aligned}')
('10.1', '(\\cdot)')
('10.1', '1')
('10.1', '\\begin{aligned}\n    a_{t} - \\tilde{a}_{t} & = \\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}x_j\\right)W_VW_O - \\left(\\sum_{j=1}^{t-1}\\tilde{\\alpha}_{t,j}\\tilde{x}_j\\right)W_VW_O\\\\\n    & = \\underbrace{\\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}x_j\\right)W_VW_O - \\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}\\tilde{x}_j\\right)W_VW_O}_{\\mathcal{T}_1}\\\\\n    & \\quad\\quad\\quad + \\underbrace{\\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}\\tilde{x}_j\\right)W_VW_O - \\left(\\sum_{j=1}^{t-1}\\beta_{t,j}\\tilde{x}_j\\right)W_VW_O}_{\\mathcal{T}_2}\\\\\n    &\\quad\\quad\\quad + \\underbrace{\\left(\\sum_{j=1}^{t-1}\\beta_{t,j}\\tilde{x}_j\\right)W_VW_O - \\left(\\sum_{j=1}^{t-1}\\tilde{\\alpha}_{t,j}\\tilde{x}_j\\right)W_VW_O}_{\\mathcal{T}_3}\n\\end{aligned}')
('10.1', '\\label{eq:decomp_main}\n    \\left\\|a_{t} - \\tilde{a}_{t}\\right\\|_2\\leq \\left\\|\\mathcal{T}_1\\right\\|_2 + \\left\\|\\mathcal{T}_2\\right\\|_2 + \\left\\|\\mathcal{T}_3\\right\\|_2')
('10.1', '\\mathcal{T}_1')
('10.1', '\\begin{aligned}\n    \\left\\|\\mathcal{T}_1\\right\\|_2 & = \\left\\|\\left(\\sum_{j=1}^{t-1}\\alpha_{t,j}(x_{t,j}-\\tilde{x}_{t,j})\\right)W_VW_O\\right\\|_2\\\\\n    & \\leq \\lambda_V\\lambda_O\\left\\|\\sum_{j=1}^{t-1}\\alpha_{t,j}(x_{t,j}-\\tilde{x}_{t,j})\\right\\|\\\\\n    & \\leq \\lambda_V\\lambda_O\\sum_{j=1}^{t-1}\\alpha_{t,j}\\left\\|x_{t,j} - \\tilde{x}_{t,j}\\right\\|_2\\\\\n    & \\leq \\lambda_V\\lambda_O\\Delta_t\\sum_{j=1}^{t-1}\\alpha_{t,j}\\\\\n    & = \\lambda_V\\lambda_O\\Delta_t\n\\end{aligned}')
('10.1', '\\left\\|x_{t,j} - \\tilde{x}_{t,j}\\right\\|_2 = \\Delta_t')
('10.1', '\\sum_{j=1}^{t-1}\\alpha_{t,j} = 1')
('10.1', '\\mathcal{T}_2')
('10.1', '\\left\\|\\alpha_t - \\beta_t\\right\\|\\leq 2\\frac{\\sqrt{t-1}}{t}\\lambda_Q\\lambda_K\\Delta_t')
('10.1', '\\begin{aligned}\n    \\left\\|\\mathcal{T}_2\\right\\|_2 & = \\left\\|\\left(\\sum_{j=0}^{t-1}(\\alpha_{t,j} - \\beta_{t,j})\\tilde{x}_j\\right)W_VW_O\\right\\|_2\\\\\n    & \\leq \\lambda_V\\lambda_O\\left\\|\\left(\\sum_{j=0}^{t-1}(\\alpha_{t,j} - \\beta_{t,j})\\tilde{x}_j\\right)\\right\\|_2\\\\\n    & \\leq \\lambda_V\\lambda_O\\sum_{j=0}^{t-1}\\left|\\alpha_{t,j} - \\beta_{t,j}\\right|\\left\\|\\tilde{x}_j\\right\\|_2\\\\\n    & \\leq \\lambda_V\\lambda_O\\left\\|\\alpha_t - \\beta_t\\right\\|_1\\\\\n    & \\leq \\sqrt{t-1}\\lambda_V\\lambda_O\\left\\|\\alpha_t - \\beta_t\\right\\|_2\\\\\n    & \\leq 2\\left(1 - \\frac{1}{t}\\right)\\lambda_Q\\lambda_K\\lambda_V\\lambda_O\\Delta_t\n\\end{aligned}')
('10.1', '\\mathcal{T}_3')
('10.1', '\\left\\|\\mathcal{T}_3\\right\\|_2 \\leq 2\\lambda_V\\lambda_O\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}')
('10.1', '\\left\\|a_{t} - \\tilde{a}_{t}\\right\\|_2 \\leq \\lambda_V\\lambda_O\\left(2\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j} + \\left(2\\lambda_Q\\lambda_K + 1\\right)\\Delta_t\\right)')
('10.1', '\\left\\|x_{t+1} - \\tilde{x}_{t+1}\\right\\|_2\\leq (1 + \\lambda_1\\lambda_2)\\lambda_V\\lambda_O\\left(2\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j} + \\left(2\\lambda_Q\\lambda_K + 1\\right)\\Delta_t\\right)')
('10.1', '1 - T_{\\max}\\exp\\left(-\\frac{\\epsilon^2b^2(T_{\\min}-1)}{(k-2)^2(u-b)^2}\\right) - T_{\\max}\\exp\\left(-\\frac{2(T_{\\min}-1)(1-\\sfrac{B}{T_{\\max}})^2}{(1-\\epsilon)^2}\\right)')
('10.1', 't\\in[T_{\\min}, T_{\\max}]')
('10.1', '\\mathbb{E}\\left[\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}\\right]\\leq \\frac{(1-\\sfrac{B}{T_{\\max}})}{0.98(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\frac{1}{k-1}}\\right) := \\Delta_{\\max}')
('10.1', '\\mathbb{E}\\left[\\left\\|x_t - \\tilde{x}_t\\right\\|\\right]\\leq 2\\Delta_{\\max}')
('10.1', '\\begin{aligned}\n    \\mathbb{E}\\left[\\left\\|x_{t+1} - \\tilde{x}_{t+1}\\right\\|_2\\right] & \\leq (1 + \\lambda_1\\lambda_2)\\lambda_V\\lambda_O\\left(2\\Delta_{\\max} + 2\\left(2\\lambda_Q\\lambda_K + 1\\right)\\Delta_{\\max}\\right)\\\\\n    & \\leq 4\\lambda_V\\lambda_O(1+ \\lambda_1\\lambda_2)(1 + \\lambda_Q\\lambda_K)\\Delta_{\\max}\n\\end{aligned}')
('10.1', '\\lambda_V\\lambda_O(1+ \\lambda_1\\lambda_2)(1 + \\lambda_Q\\lambda_K) \\leq \\frac{1}{2}')
('10.1', '\\mathbb{E}\\left[\\left\\|x_{t+1} - \\tilde{x}_{t+1}\\right\\|_2\\right] \\leq 2\\Delta_{\\max}')
('10.1', 't\\in[T_{\\min}, T_{\\max}]')
('10.1', '\\mathbb{E}\\left[\\left\\|x_{t} - \\tilde{x}_{t}\\right\\|_2\\right] \\leq \\frac{2.1(1-\\sfrac{B}{T_{\\max}})}{(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\frac{1}{k-1}}\\right)')
('10.2', '\\beta_{t,j}')
('10.2', 'f(x) =  c(x+b)^{-\\gamma}')
('10.2', '[0, u-b)')
('10.2', 'k > 2')
('10.2', 'u\\geq 5b')
('10.2', 'S_t')
('10.2', '\\hat{S}_t = S_t\\setminus\\{t\\}')
('10.2', '1 - T_{\\max}\\exp\\left(-\\frac{\\epsilon^2b^2(T_{\\min}-1)}{(k-2)^2(u-b)^2}\\right) - T_{\\max}\\exp\\left(-\\frac{2(T_{\\min}-1)(1-B)^2}{(1-\\epsilon)^2}\\right)')
('10.2', 't\\in T')
('10.2', '\\label{eq:theo_plb}\n        \\mathbb{E}\\left[\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}\\right] \\leq \\frac{(1-\\sfrac{B}{T_{\\max}})}{0.98(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\frac{1}{k-1}}\\right)')
('10.2', 'B')
('10.2', '\\beta_{t,j}')
('10.2', 'v_j')
('10.2', 'f(x) = c(x+b)^{-k}')
('10.2', '[0, u - b)')
('10.2', 'c')
('10.2', '\\begin{aligned}\n    c = \\left(\\int_0^{u-b} (x+b)^{-k}dx\\right)^{-1} = \\frac{k-1}{b^{1-k} - u^{1-k}}\n\\end{aligned}')
('10.2', '\\int x(x+b)^{-k} = -\\frac{(x+b)^{1-k}((k-1)x + b)}{(k-1)(k-2)} := g(x)')
('10.2', 'C = \\sum_{j=1}^{t-1}v_j')
('10.2', 'C')
('10.2', '\\begin{aligned}\n    \\mathbb{E}\\left[C\\right] = (t-1)\\mathbb{E}\\left[v_1\\right] & = (t-1)\\frac{k-1}{b^{1-k} - u^{1-k}}\\int_0^\\infty x(x+b)^{-k}dx\\\\\n    & = (t-1)\\frac{k-1}{b^{1-k} - u^{1-k}}(g(u) - g(0))\\\\\n    & = (t-1)\\frac{k-1}{b^{1-k} - u^{1-k}}\\left(\\frac{b^{2-k}}{(k-1)(k-2)} - \\frac{u^{1-k}((k-1)u - (k-2)b)}{(k-1)(k-2)}\\right)\\\\\n    & = \\frac{t-1}{k-2}\\cdot\\frac{b^{2-k} - (k-1)u^{2-k} + (k-2)bu^{1-k}}{b^{1-k} - u^{1 - k}}\n\\end{aligned}')
('10.2', '\\Delta = \\frac{b^{2-k} - (k-1)u^{2-k} + (k-2)bu^{1-k}}{b^{1-k} - u^{1 - k}}')
('10.2', '\\mathbb{P}\\left(C \\leq (1-\\epsilon)\\mathbb{E}\\left[C\\right]\\right) \\leq \\exp\\left(-\\frac{2\\epsilon^2\\mathbb{E}\\left[C\\right]^2}{(t-1)(u-b)^2}\\right)')
('10.2', '1 - \\exp\\left(-\\frac{2\\epsilon^2\\Delta^2(t-1)}{(k-2)^2(u-b)^2}\\right)')
('10.2', 'C \\geq (1-\\epsilon)\\Delta\\frac{t-1}{k-2}')
('10.2', '\\sum_{j\\notin\\hat{S}_t}\\beta_{t,j}')
('10.2', '\\hat{S}_t = \\{j\\in[t-1]:\\beta_{t,j} \\geq \\frac{\\gamma}{C}\\}')
('10.2', 'C^{-1}\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j \\leq \\gamma\\right\\}v_j')
('10.2', '\\begin{aligned}\n    \\mathbb{E}\\left[C^{-1}\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j\\leq \\gamma\\right\\}v_j\\right] & \\leq \\frac{k-2}{(t-1)\\Delta(1-\\epsilon)}\\mathbb{E}\\left[\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j \\leq \\gamma\\right\\}v_j\\right]\\\\\n    & = \\frac{k-2}{\\Delta(1-\\epsilon)}\\cdot\\frac{k-1}{b^{1-k} - u^{1-k}}\\int_0^{\\gamma}x(x+b)^{-k}dx\\\\\n    & = \\frac{(k-1)(k-2)}{\\Delta(1-\\epsilon)\\left(b^{1-k} - u^{1-k}\\right)}\\left(g(\\gamma) - g(0)\\right)\n\\end{aligned}')
('10.2', '\\gamma')
('10.2', '\\begin{aligned}\n    \\mathbb{E}\\left[\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j\\leq \\gamma\\right\\}\\right] = (t-1)\\mathbb{P}\\left(v_j\\leq \\gamma\\right) = (t-1)\\cdot\\frac{b^{1-k}-(\\gamma+b)^{1-k}}{b^{1-k} - u^{1-k}}\n\\end{aligned}')
('10.2', '\\begin{aligned}\n    & \\mathbb{P}\\left(\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j\\leq \\gamma\\right\\}\\geq (1-\\epsilon)(t-1)\\cdot\\frac{b^{1-k}-(\\gamma+b)^{1-k}}{b^{1-k} - u^{1-k}}\\right)\\\\\n    &\\quad\\quad\\leq \\exp\\left(-\\frac{2(t-1)\\epsilon^2\\left(b^{1-k}-(\\gamma+b)^{1-k}\\right)^2}{\\left(b^{1-k} - u^{1-k}\\right)^2}\\right)\n\\end{aligned}')
('10.2', '\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j\\leq \\gamma\\right\\} \\geq T_{\\max} - B')
('10.2', '(\\gamma+b)^{1-k} \\leq b^{1-k} - \\frac{1-\\sfrac{B}{T_{\\max}}}{1-\\epsilon}(b^{1-k} - u^{1-k})')
('10.2', '\\gamma \\geq \\left(\\left(\\frac{\\sfrac{B}{T_{\\max}}-\\epsilon}{1-\\epsilon}\\right)^{\\frac{1}{1-k}}-1\\right)b')
('10.2', 'g(\\gamma) = - \\left(b^{1-k} - \\frac{1-\\sfrac{B}{T_{\\max}}}{1-\\epsilon}(b^{1-k} - u^{1-k})\\right)\\frac{b + (k-1)\\gamma}{(k-1)(k-2)}')
('10.2', 'b^{1-k} - \\frac{1-\\sfrac{B}{T_{\\max}}}{1-\\epsilon}(b^{1-k} - u^{1-k}) \\geq \\frac{\\sfrac{B}{T_{\\max}} -\\epsilon}{1-\\epsilon}(b^{1-k} - u^{1-k})')
('10.2', '\\begin{aligned}\n    \\mathbb{E}\\left[C^{-1}\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j\\leq \\gamma\\right\\}v_j\\right] & \\leq \\frac{b(1-\\sfrac{B}{T_{\\max}})}{\\Delta(1-\\epsilon)^2} - \\frac{(k-1)(\\sfrac{B}{T_{\\max}}-\\epsilon)\\gamma}{\\Delta(1-\\epsilon)^2}\\\\\n    & \\leq \\frac{b(1-\\sfrac{B}{T_{\\max}})}{\\Delta(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\frac{1}{k-1}}\\right)\n\\end{aligned}')
('10.2', 'u\\geq 5b')
('10.2', '\\Delta = b - (k-1)\\left(\\frac{u}{b}\\right)^{1-k}\\cdot\\frac{b-u}{b^{1-k} - u^{1-k}} \\leq 0.98b')
('10.2', '\\mathbb{E}\\left[C^{-1}\\sum_{j=1}^{t-1}\\mathbb{I}\\left\\{v_j\\leq \\gamma\\right\\}v_j\\right] \\leq \\frac{(1-\\sfrac{B}{T_{\\max}})}{0.98(1-\\epsilon)^2}\\left(k -  (k-1)\\left(\\frac{1-\\epsilon}{\\sfrac{B}{T_{\\max}}-\\epsilon}\\right)^{\\frac{1}{k-1}}\\right)')
('10.2', '1 - \\exp\\left(-\\frac{\\epsilon^2b^2(t-1)}{(k-2)^2(u-b)^2}\\right) - \\exp\\left(-\\frac{2(t-1)(1-\\sfrac{B}{T_{\\max}})^2}{(1-\\epsilon)^2}\\right)')
