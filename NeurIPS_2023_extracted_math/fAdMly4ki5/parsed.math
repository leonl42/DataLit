('2.0.0', '(\\mathcal{S}, \\mathcal{A},\\mathcal{P}, \\mathcal{R}, \\mathcal{\\mu}, \\mathcal{\\gamma})')
('2.0.0', '\\mathcal{S}')
('2.0.0', '\\mathcal{A}')
('2.0.0', '\\mathcal{P}:\\mathcal{S}\\times\\mathcal{A}\\to\\mathcal{S}')
('2.0.0', '\\mathcal{R}:\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\to\\mathbb{R}')
('2.0.0', '\\mathcal{\\gamma}\\in(0, 1]')
('2.0.0', '\\mathcal{\\mu}')
('2.0.0', 't')
('2.0.0', 'a_t')
('2.0.0', '\\pi:\\mathcal{S}\\to\\Delta_\\mathcal{A}')
('2.0.0', 's_{t+1}')
('2.0.0', 'r_t')
('2.0.0', '\\pi^*=\\arg\\max_\\pi\\mathbb{E}_{a_t \\sim \\pi}\\big[\\sum\\nolimits_{t=0}^{\\infty}\\gamma^t r_t\\big]')
('2.0.0', '\\mathcal{T} \\sim p(\\mathcal{T})')
('2.0.0', '(\\mathcal{S}^{\\mathcal{T}}, \\mathcal{A},\\mathcal{P}^{\\mathcal{T}}, \\mathcal{R}^{\\mathcal{T}}, \\mathcal{\\mu}^{\\mathcal{T}}, \\mathcal{\\gamma})')
('2.0.0', '\\pi^*=\\arg\\max_\\pi\\mathbb{E}_{{\\mathcal{T}}\\sim p(\\mathcal{T})}\\mathbb{E}_{a_t\\sim\\pi^{\\mathcal T}}\\big[\\sum\\nolimits_{t=0}^{\\infty}\\gamma^t r_t^{\\mathcal{T}}\\big]')
('2.0.0.0', "\\{(s_j, a_j, s'_j, r_j)\\}_{j=1}^{N}")
('2.0.0.0', '\\pi_\\beta')
('2.0.0.0', '\\mathcal{D}')
('2.0.0.0', '\\mathcal{D}=\\cup_{i=1}^N \\mathcal{D}_i')
('2.0.0.0', '\\mathcal{D}_i')
('2.0.0.0', '\\mathcal{T}_i')
('2.0.0.0', "(s,a,s',r)")
('2.1', '\\mathcal{D}=\\cup_{i=1}^N \\mathcal{D}_i')
('2.1', '\\tau')
('2.1', '\\mathcal{D}')
('2.1', '\\bm{x}_k(\\tau)')
('2.1', 'k')
('2.1', '\\bm{y}(\\tau)')
('2.1', '\\bm{x}_0(\\tau)\\sim q(\\bm{x}(\\tau))')
('2.1', 'K')
('2.1', '\\beta_k')
('2.1', '\\label{eq:diffusion}\n    q(\\bm{x}_k(\\tau)|\\bm{x}_{k-1}(\\tau)):=\\mathcal{N}(\\bm{x}_k(\\tau);\\sqrt{1-\\beta_k}\\bm{x}_{k-1}(\\tau), \\beta_k\\boldsymbol{I}).')
('2.1', '\\beta_k = 1- \\exp\\big({-\\beta_{min}(\\frac{1}{K})-0.5(\\beta_{\\rm max}-\\beta_{\\rm min})\\frac{2k-1}{K^2}}\\big)')
('2.1', '\\beta_{\\rm max}=10')
('2.1', '\\beta_{\\rm min}=0.1')
('2.1', 'p_\\theta(\\bm{x}_{k-1}(\\tau)|\\bm{x}_k(\\tau),\\bm{y}(\\tau)):=\\mathcal{N}(\\bm{x}_{k-1}(\\tau)|\\mu_\\theta(\\bm{x}_k(\\tau), \\bm{y}(\\tau), k),\\Sigma_k)')
('2.1', '\\mathcal{L}_{\\rm denoise}:=\\mathbb{E}_{k\\sim \\mathcal{U}(1, K), \\bm{x}_0(\\tau)\\sim q,\\epsilon\\sim\\mathcal{N(\\boldsymbol{\\mathrm{0}},\\boldsymbol{{I}})}}[\\big\\|\\epsilon-\\epsilon_\\theta(\\bm{x}_k(\\tau), \\bm{y}(\\tau), k)\\big\\|^2],')
('2.1', '\\epsilon_\\theta')
('2.1', '\\epsilon\\sim\\mathcal{N}(\\boldsymbol{\\mathrm{0}},\\boldsymbol{{I}})')
('2.1', '\\bm{x}_0(\\tau)')
('2.1', '\\bm{x}_k(\\tau)')
('2.1', '\\alpha_k:=1-\\beta_k')
('2.1', '\\bar{\\alpha}_k:=\\prod_{s=1}^k\\alpha_s')
('2.1', '\\nonumber\n    \\bm{x}_{k-1}(\\tau)\\!\\gets\\! \\frac{1}{\\sqrt{\\alpha_k}} \\left(\\bm{x}_k(\\tau)\\!-\\!\\frac{\\beta_k}{\\sqrt{1-\\bar{\\alpha}_k}}\\epsilon_\\theta(\\bm{x}_k(\\tau),\\bm{y}(\\tau),k)\\right) + \\sqrt{\\beta_k}\\sigma,\\ \\sigma\\!\\sim\\!\\mathcal{N}(\\boldsymbol{0},\\boldsymbol{I}),\\ \\text{for}\\ k=\\{K,...,1\\}.')
('2.1', 'q(\\bm{x}(\\tau)|\\bm{y}(\\tau))')
('2.1', '\\epsilon_\\theta(\\bm{x}_k(\\tau), \\bm{y}(\\tau), k)')
('2.1', '\\epsilon_\\theta(\\bm{x}_k(\\tau), \\varnothing, k)')
('2.1', '\\bm{y}(\\tau)')
('2.1', '\\epsilon_\\theta(\\bm{x}_k(\\tau), \\varnothing, k)+\\alpha(\\epsilon_\\theta(\\bm{x}_k(\\tau), \\bm{y}(\\tau), k)-\\epsilon_\\theta(\\bm{x}_k(\\tau),\\varnothing, k))')
('2.1', '\\alpha')
('3.0', '\\label{eq:c-diffusion}\n    \\max\\nolimits_\\theta\\mathbb{E}_{\\tau\\sim\\cup_i\\mathcal{D}_i}\\big[\\log p_{\\theta}(\\bm{x}_{0}(\\tau)\\:\\big|\\: \\bm{y}(\\tau)\\big],')
('3.0', '\\bm{x}_0(\\tau)')
('3.0', '\\bm{y}(\\tau)')
('3.0', '\\bm{x}_0(\\tau)')
('3.0', 'p_\\theta')
('3.0', '\\bm{x}(\\tau)')
('3.0', '\\bm{x}(\\tau)')
('3.0', '\\bm{x}(\\tau)')
('3.0', '\\bm{x}^{\\textcolor{red}{p}}_k(\\tau):=(a_t, a_{t+1},...,a_{t+H-1})_k,')
('3.0', "\\label{eq:y-p}\n\\bm{y}^{\\textcolor{red}{p}}(\\tau):=\\big[\\bm{y}'(\\tau),R(\\tau)\\big], \\quad \\ \\ \\bm{y}'(\\tau):=(Z,s_{t-L+1},...,s_{t}),")
('3.0', 't')
('3.0', 'H')
('3.0', 'R(\\tau)')
('3.0', 'L')
('3.0', '\\tau')
('3.0', '\\bm{x}')
('3.0', '\\tau')
('3.0', 'Z')
('3.0', "\\bm{y}'(\\tau)")
('3.0', 'R(\\tau)')
('3.0', '\\bm{x}^{\\textcolor{red}{s}}_k(\\tau):=\\begin{bmatrix}\ns_t &s_{t+1}& \\cdots & s_{t+H-1} \\\\\na_t &a_{t+1}&\\cdots&a_{t+H-1} \\\\\nr_t &r_{t+1}& \\cdots & r_{t+H-1}\n\\end{bmatrix},')
('3.0', '\\bm{y}^{\\textcolor{red}{s}}(\\tau):=[Z],')
('3.0', '\\bm{y}^{\\textcolor{red}{s}}(\\tau)')
('3.0', "y'(\\tau)")
('3.0', '\\bm{x}_0(\\tau)')
('3.0', '\\bm{x}_0(\\tau)')
('3.0', '\\bm{y}(\\tau)')
('3.1', 'Z')
('3.1', 'Z:=\\begin{bmatrix}\n    s^*_{i}&s^*_{i+1}& \\cdots& s^*_{i+J-\n    1}\\\\\n    a^*_{i}&a^*_{i+1}&\\cdots&a^*_{i+J-1}\n    \\end{bmatrix},')
('3.1', 'J')
('3.1', '\\bm{x}^{\\textcolor{red}{p}}_0(\\tau)')
('3.1', '\\bm{x}_K(\\tau)')
('3.1', '\\bm{x}^{\\textcolor{red}{p}}_k(\\tau)')
('3.1', '\\bm{x}^{\\textcolor{red}{p}}_{k-1}(\\tau)')
('3.1', "\\epsilon_\\theta\\big(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau),\\bm{y}'(\\tau), \\varnothing, k\\big)+\\alpha\\big(\\epsilon_\\theta(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau), \\bm{y}'(\\tau), R(\\tau), k)-\\epsilon_\\theta(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau), \\bm{y}'(\\tau), \\varnothing, k)\\big),")
('3.1', "\\bm{y}'(\\tau)")
('3.1', 'R(\\tau)')
('3.1', '\\tau')
('3.1', '\\alpha')
('3.1', 'p_\\theta')
('3.1', '\\epsilon_\\theta')
('3.1', "\\mathcal{L}^{\\textcolor{red}{p}}(\\theta):=\\mathbb{E}_{k\\sim \\mathcal{U}(1, K), \\bm{x}_0(\\tau)\\sim q,\\epsilon\\sim\\mathcal{N(\\boldsymbol{\\mathrm{0}},\\boldsymbol{{I}})},\\beta\\sim \\rm{Bern}(p)}\\big[\\big\\|\\epsilon-\\epsilon_\\theta\\big(\\bm{x}_k^{\\textcolor{red}{p}}(\\tau),\\bm{y}'(\\tau),(1-\\beta)R(\\tau)+\\beta\\varnothing, k\\big)\\big\\|^2\\big].")
('3.1', 'p')
('3.1', 'R(\\tau)')
('3.1', "\\bm{x}^{\\textcolor{red}{p}}_{k-1}(\\tau)\\sim\\mathcal{N}(\\mu_\\theta(\\bm{x}^{\\textcolor{red}{p}}_{k-1},\\bm{y}'(\\tau), R_{\\rm max}(\\tau), k-1),\\beta\\Sigma_{k-1})")
('3.1', '\\beta\\in[0,1)')
('3.1', 'R(\\tau)')
('3.1', '\\mathcal{L}^{\\textcolor{red}{s}}(\\theta):=\\mathbb{E}_{k\\sim \\mathcal{U}(1, K), \\bm{x}_0(\\tau)\\sim q,\\epsilon\\sim\\mathcal{N(\\boldsymbol{\\mathrm{0}},\\boldsymbol{{I}})}}\\big[\\big\\|\\epsilon-\\epsilon_\\theta(\\bm{x}_k^{\\textcolor{red}{s}}(\\tau),\\bm{y}^{\\textcolor{red}{s}}(\\tau), k)\\big\\|^2\\big].')
('3.1', '\\bm{x}^{\\textcolor{red}{s}}_{k-1}(\\tau)\\sim\\mathcal{N}(\\mu_\\theta(\\bm{x}^{\\textcolor{red}{s}}_{k-1},\\bm{y}^{\\textcolor{red}{s}}(\\tau), k-1),\\Sigma_{k-1})')
('3.2', '\\epsilon_\\theta')
('3.2', 'x')
('3.2', 'h')
('3.2', '\\bm{d}')
('3.2', 'f')
('3.2', '\\nonumber\n\\begin{aligned}\n    &h_{P}=f_P(x^{\\rm{prompt}}),h_{Ti}=f_{Ti}(x^{\\rm{timestep}}),\\ \\ \\ \\rhd\\:\\text{for prompt and diffusion timestep}\\\\\n    &h^{\\textcolor{red}{s}}_{Tr}=f_{Tr}(x^{\\rm{transitions}}),\\:\\:\\:\\:\\:\\:\\rhd\\:\\text{for\\ \\textsc{MTDiff-s}}\\\\\n    &h^{\\textcolor{red}{p}}_A=f_{A}(x^{\\rm{actions}}),h^{\\textcolor{red}{p}}_H=f_H(x^{\\rm{history}}),\n    h^{\\textcolor{red}{p}}_R=f_R(x^{\\rm{return}}).\\:\\:\\:\\:\\rhd\\:\\text{for\\ \\textsc{MTDiff-p}}\n\\end{aligned}')
('3.2', 'h_P')
('3.2', 'h_{Ti}')
('3.2', '\\nonumber\n    h^{\\textcolor{red}{p}}_{\\rm tokens}={\\rm{LN}}(h_{Ti}\\times[h_{P},h_{Ti},h_{R}^{\\textcolor{red}{p}},h_H^{\\textcolor{red}{p}},h_A^{\\textcolor{red}{p}}]+ h_R^{\\textcolor{red}{p}}+E^{\\rm{pos}}),\n    h^{\\textcolor{red}{s}}_{\\rm tokens}={\\rm{LN}}(h_{Ti}\\times[h_{P},h_{Ti},h_{Tr}^{\\textcolor{red}{s}}]+E^{\\rm{pos}}),')
('3.2', 'E^{\\rm{pos}}')
('3.2', '\\rm{LN}')
('3.2', 'h_{Ti}')
('3.2', 'h_{R}^{\\textcolor{red}{p}}')
('3.2', '\\nonumber\n    h^{\\textcolor{red}{p}}_{\\rm out} = {\\rm{transformer}}(h^{\\textcolor{red}{p}}_{\\rm tokens}),\\quad h^{\\textcolor{red}{s}}_{\\rm out} = {\\rm{transformer}}(h^{\\textcolor{red}{s}}_{\\rm tokens}).')
('3.2', 'k')
('3.2', '\\bm{d}')
('3.2', 'p_\\theta')
('5.0.0.1', 'z')
('5.0.0.1', 's')
('5.0.0.1', 'z')
('5.0.0.1', "s' = s \\times z")
('5.0.0.1', 'z \\sim {\\rm Uniform}[\\alpha,\\beta]')
('5.0.0.1', "s' \\gets s + \\epsilon\\nabla_s\\mathbb{J}_Q(\\pi(s))")
('5.0.0.1', '\\mathbb{J}_Q')
('5.0.0.1', 'Q')
('5.0.0.1', '\\epsilon')
('5.2.0.0', 'Q')
('8', '2e^{-4}')
('8', '2e^6')
('8', 'f_P')
('8', 'f_{Ti}')
('8', 'f_R')
('8', 'f_R')
('8', 'f_H')
('8', 'f_A')
('8', 'f_{TR}')
('8', 'p')
('8', 'L=2')
('8', 'L=5')
('8', 'J=20')
('8', 'K=200')
('8', '\\alpha=1.2')
('8', '\\beta=0.5')
('8', '\\mathcal{T}^{train}')
('8', 'N')
('8', '\\mathcal{D}')
('8', 'M')
('8', 'Z')
('8', '\\bm{x}^{\\textcolor{red}{p}}_0(\\tau_i)')
('8', 'H')
('8', 'S^{\\rm prev}_i')
('8', 'L')
('8', '\\mathcal{D}_i')
('8', 'M')
('8', 'R(\\tau_i)')
('8', '\\tau_i')
('8', '\\tau^*_i')
('8', 'J')
('8', 'Z_i')
('8', 'M')
('8', '\\mathcal{B}=\\{\\bm{x}^{\\textcolor{red}{p}}_0(\\tau_i),\\tau^*_i,S^{\\rm prev}_i,R(\\tau_i)\\}_{i=1}^{|\\mathcal{T}^{train}|}')
('8', 'k\\sim \\mathcal{U}(1, K)')
('8', '\\bm{x}^{\\textcolor{red}{p}}_k(\\tau_i)')
('8', 'R(\\tau)')
('8', '\\beta\\sim {\\rm{Bern}}(p)')
('8', '\\mathcal{L}^{\\textcolor{red}{p}}(\\theta)')
('8', 'R_{\\rm max}(\\tau)')
('8', 'h_0')
('8', 'Z')
('8', '\\beta')
('8', '\\alpha')
('8', '\\bm{x}^{\\textcolor{red}{p}}_K(\\tau)\\sim\\mathcal{N(\\boldsymbol{\\mathrm{0}},\\beta\\boldsymbol{{I}})}')
('8', '\\tau^*\\sim Z')
('8', "\\bm{y}'(\\tau) = [h_t, \\tau^*]")
('8', "\\hat{\\epsilon} = \\epsilon_\\theta\\big(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau),\\bm{y}'(\\tau), \\varnothing, k\\big)+\\alpha\\big(\\epsilon_\\theta(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau), \\bm{y}'(\\tau), R_{\\rm max}(\\tau), k)-\\epsilon_\\theta(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau), \\bm{y}'(\\tau), \\varnothing, k)\\big)")
('8', '(\\mu_{k-1},\\Sigma_{k-1})\\gets {\\rm{Denoise}}(\\bm{x}^{\\textcolor{red}{p}}_k(\\tau),\\hat{\\epsilon})')
('8', '\\bm{x}^{\\textcolor{red}{p}}_{k-1}(\\tau)\\sim\\mathcal{N}(\\mu_{k-1},\\beta\\Sigma_{k-1})')
('8', '\\bm{x}^{\\textcolor{red}{p}}_0(\\tau)')
('8', 'h_t')
('8', '\\mathcal{T}^{train}')
('8', 'N')
('8', '\\mathcal{D}')
('8', 'M')
('8', 'Z')
('8', '\\bm{x}^{\\textcolor{red}{s}}_0(\\tau_i)')
('8', 'H')
('8', '\\mathcal{D}_i')
('8', 'M')
('8', '\\tau^*_i')
('8', 'J')
('8', 'Z_i')
('8', 'M')
('8', '\\mathcal{B}=\\{\\bm{x}^{\\textcolor{red}{s}}_0(\\tau_i),\\tau^*_i\\}_{i=1}^{|\\mathcal{T}^{train}|}')
('8', 'k\\sim \\mathcal{U}(1, K)')
('8', '\\bm{x}^{\\textcolor{red}{s}}_k(\\tau_i)')
('8', '\\mathcal{L}^{\\textcolor{red}{s}}(\\theta)')
('8', '\\mathcal{D}=\\varnothing')
('8', 'M')
('8', 'Z')
('8', '\\bm{x}^{\\textcolor{red}{s}}_K(\\tau)\\sim\\mathcal{N(\\boldsymbol{\\mathrm{0}},\\boldsymbol{{I}})}')
('8', '\\tau^*\\sim Z')
('8', '\\bm{y}^{\\textcolor{red}{s}}_k(\\tau) = [\\tau^*]')
('8', '\\hat{\\epsilon} = \\epsilon_\\theta\\big(\\bm{x}^{\\textcolor{red}{s}}_k(\\tau),\\bm{y}^{\\textcolor{red}{s}}(\\tau), k\\big)')
('8', '(\\mu_{k-1},\\Sigma_{k-1})\\gets {\\rm{Denoise}}(\\bm{x}^{\\textcolor{red}{s}}_k(\\tau),\\hat{\\epsilon})')
('8', '\\bm{x}^{\\textcolor{red}{s}}_{k-1}(\\tau)\\sim\\mathcal{N}(\\mu_{k-1},\\Sigma_{k-1})')
('8', '\\mathcal{D}=\\mathcal{D}\\cup\\bm{x}^{\\textcolor{red}{s}}_0(\\tau)')
('9', 'z')
('9', 'z')
('9', 'Q')
('9', 'z')
('9', 'z')
('9', 'z')
('9', 'z')
('9', "s' = s \\times z")
('9', 'z \\sim {\\rm Uniform}[\\alpha,\\beta]')
('9', '\\alpha=0.8')
('9', '\\beta=1.2')
('9', "s' \\gets s + \\epsilon\\nabla_s\\mathbb{J}_Q(\\pi(s))")
('9', '\\mathbb{J}_Q')
('9', 'Q')
('9', '\\epsilon')
('9', '\\epsilon=0.01')
('10', 'z_p')
('12.1', '\\epsilon')
('12.1', '\\epsilon')
('12.1', '0.0174')
('12.1', '0.4552')
('12.1', '0.0001')
('12.1', '0.4024')
('12.1', '0.0641')
('12.1', '0.4617')
('13.0', '0.2 \\times')
('15', '\\bm{-29.09\\pm 0.31}')
('15', '\\bm{602.17\\pm 1.68}')
('15', '\\bm{-34.43\\pm2.33}')
('15', '\\bm{409.81\\pm9.69}')
