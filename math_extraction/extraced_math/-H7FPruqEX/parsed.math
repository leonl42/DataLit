('2', '(\\mathcal{S},\\mathcal{A},p,r,\\gamma)')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', 'p:\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\to[0,1]')
('2', 'r:\\mathcal{S}\\times\\mathcal{A}\\to\\mathbb{R}')
('2', '\\gamma')
('2', '\\pi:\\mathcal{S}\\times\\mathcal{A}\\to[0,1]')
('2', '\\mbox{maximize}\\ \\mathcal{J}=\\mathbb{E}_{traj\\sim\\pi}\\left[\\sum_{t}\\gamma^{t}r%\n(s_{t},a_{t})\\right],')
('2', 'traj=\\{s_{0},a_{0},r_{0},\\dots\\}')
('2', '\\pi')
('2', '\\mathcal{J}')
('2', 'V^{\\pi}(s)=\\mathbb{E}_{\\pi}\\left[\\sum_{t}\\gamma^{t}r_{t}|s_{0}=s\\right]')
('2', 'Q^{\\pi}(s,a)=\\mathbb{E}_{\\pi}\\left[\\sum_{t}\\gamma^{t}r_{t}|s_{0}=s,a_{0}=a\\right]')
('2', 'A^{\\pi}(s,a)=Q^{\\pi}(s,a)-V^{\\pi}(s)')
('2', 'Q_{\\theta}')
('2', 'Q^{\\pi}')
('2', '\\mbox{minimize}\\ \\mathbb{E}_{\\pi}[(Q^{\\pi}(s,a)-Q_{\\theta}(s,a))^{2}],')
('2', 'Q^{\\pi}')
('2', '\\lambda')
('2', '\\mathcal{J}')
('2', '\\pi_{\\theta}')
('2', '\\nabla_{\\theta}\\mathcal{J}=\\mathbb{E}_{\\pi}[\\Psi(s,a)\\nabla_{\\theta}\\log\\pi_{%\n\\theta}(a|s)].')
('2', '\\Psi=\\sum_{t=0}^{\\infty}\\gamma^{t}r_{t}')
('2', '\\Psi(s,a)')
('2', '\\Psi(s,a)=r+\\gamma V^{\\tilde{\\pi}}(s^{\\prime})-V_{\\theta}(s)')
('2', 'V^{\\tilde{\\pi}}')
('3.1', 'V_{\\theta}')
('3.1', 'V^{\\pi}')
('3.1', 'Q_{\\theta}')
('3.1', 'Q^{\\pi}')
('3.1', '\\pi_{\\theta}')
('3.1', '\\theta')
('3.1', '\\tau')
('3.1', '\\tau')
('3.1', '\\theta\\leftarrow\\theta+\\eta\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})\\nabla_{\\theta%\n}Q_{\\theta}]')
('3.1', '\\theta\\leftarrow\\theta+\\eta\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{\\theta})\\nabla_{\\theta%\n}\\log\\pi_{\\theta}]')
('3.1', '\\pi')
('3.1', 'Q')
('3.1', 'V')
('3.1', '\\pi')
('3.1', 'pg')
('3.1', '\\textbf{E}\\rightarrow\\textbf{I}\\rightarrow\\textbf{E}\\rightarrow\\textbf{I}\\cdots')
('3.1', '\\pi')
('3.1', 'Q')
('3.1', 'V')
('3.1', '\\pi')
('3.1', 'pg')
('3.1', '\\textbf{E}\\rightarrow\\textbf{I}\\rightarrow\\textbf{E}\\rightarrow\\textbf{I}\\cdots')
('3.1', '<x,y>')
('3.1', '<x,y>=\\arccos(\\frac{x\\cdot y}{||x||\\cdot||y||})')
('3.1', '\\arccos:[-1,1]\\rightarrow[0,\\pi]')
('3.1', '\\beta')
('3.1', '\\beta\\overset{def}{=}<\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})\\nabla_{\\theta}Q_{%\n\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{\\theta})\\nabla_{\\theta}\\log\\pi_{\\theta%\n}]>.')
('3.1', '\\beta=0')
('3.1', '\\cos(\\beta)=1')
('3.1', '\\beta=\\pi/2')
('3.1', '\\cos(\\beta)=0')
('3.1', '\\beta=\\pi')
('3.1', '\\cos(\\beta)=-1')
('3.1', 'Q^{\\pi}')
('3.1', 'Q_{\\theta}')
('3.1', '\\pi')
('3.1', '\\pi_{\\theta}')
('3.1', '\\beta>0')
('3.1', '\\beta=0')
('3.1', '\\beta=0')
('3.1', '\\beta')
('3.1', '\\beta=0')
('3.1', '\\theta')
('3.1', '\\chi')
('3.1', '\\theta')
('3.1', '\\chi\\overset{def}{=}\\mathbb{E}_{\\pi}[\\cos<\\nabla_{\\theta}Q_{\\theta},\\nabla_{%\n\\theta}\\log\\pi_{\\theta}>].')
('3.1', '\\chi')
('3.1', '\\chi=1')
('3.1', '\\nabla_{\\theta}Q_{\\theta}=\\nabla_{\\theta}\\log\\pi_{\\theta}')
('3.1', '\\chi')
('3.1', '\\cos(\\beta)')
('3.1', '\\chi')
('3.1', '\\cos(\\beta)')
('3.1', '\\beta')
('3.1', '\\chi')
('3.1', '\\cos(\\beta)')
('3.1', '\\chi')
('3.1', '\\chi')
('3.1', '\\cos(\\beta)')
('3.1', '\\arccos(\\chi)')
('3.1', '\\beta')
('3.1', '\\pi/2')
('3.1', '\\chi=1')
('3.1', '\\cos(\\beta)')
('3.1', '1')
('3.2', '\\tau\\in\\mathbb{R}_{+}')
('3.2', 'sg')
('3.2', 'stop\\ gradient')
('3.2', 'V_{\\theta}')
('3.2', 'A_{\\theta}')
('3.2', '\\theta')
('3.2', '\\pi_{\\theta}')
('3.2', 'Q_{\\theta}')
('3.2', '\\left\\{\\begin{aligned} &\\pi_{\\theta}(\\cdot|s)=\\text{softmax}(A_{\\theta}(s,%\n\\cdot)/\\tau),\\\\\n&\\bar{A}_{\\theta}(s,a)=A_{\\theta}(s,a)-\\sum_{a^{\\prime}}sg(\\pi_{\\theta}(a^{%\n\\prime}|s))A_{\\theta}(s,a^{\\prime}),\\\\\n&Q_{\\theta}(s,a)=\\bar{A}_{\\theta}(s,a)+sg(V_{\\theta}(s)).\\end{aligned}\\right.')
('3.2', 'sg')
('3.2', 'sg')
('3.2', '\\bar{A}_{\\theta}=A_{\\theta}-\\mathbb{E}_{\\pi}[A_{\\theta}]=A_{\\theta}-sg(\\pi_{%\n\\theta})\\cdot A_{\\theta}')
('3.2', 'sg')
('3.2', 'sg')
('3.2', '\\pi_{\\theta}')
('3.2', '\\pi_{\\theta}')
('3.2', 'sg')
('3.2', 'Q_{\\theta}=\\bar{A}_{\\theta}+sg(V_{\\theta})')
('3.2', 'sg')
('3.2', 'Q_{\\theta}=\\bar{A}_{\\theta}+sg(V_{\\theta})')
('3.2', 'Q_{\\theta}')
('3.2', 'Q^{\\pi}')
('3.2', 'Q_{\\theta}=A_{\\theta}+V_{\\theta}')
('3.2', '\\mathbb{E}_{\\pi}[A_{\\theta}]=0')
('3.2', '\\mathbb{E}_{\\pi}[Q_{\\theta}]=V_{\\theta}')
('3.2', 'Q_{\\pi}')
('3.2', 'Q_{\\theta}=A_{\\theta}-\\mathbb{E}_{\\pi}[A_{\\theta}]+V_{\\theta}')
('3.2', '\\mathbb{E}_{\\pi}[Q_{\\theta}]=V_{\\theta}')
('3.3', '\\theta')
('3.3', 'V,Q,A,\\pi')
('3.3', 'V')
('3.3', 'Q')
('3.3', 'V^{\\tilde{\\pi}}')
('3.3', 'Q^{\\tilde{\\pi}}')
('3.3', 'V^{\\tilde{\\pi}}')
('3.3', 'Q^{\\tilde{\\pi}}')
('3.3', '\\theta')
('3.3', '\\displaystyle L_{V}(\\theta)=\\mathbb{E}_{\\pi}[(V^{\\tilde{\\pi}}-V)^{2}],\\ L_{Q}(%\n\\theta)=\\mathbb{E}_{\\pi}[(Q^{\\tilde{\\pi}}-Q)^{2}],')
('3.3', '\\displaystyle L_{V}(\\theta)=\\mathbb{E}_{\\pi}[(V^{\\tilde{\\pi}}-V)^{2}],\\ L_{Q}(%\n\\theta)=\\mathbb{E}_{\\pi}[(Q^{\\tilde{\\pi}}-Q)^{2}],')
('3.3', '\\theta')
('3.3', '\\displaystyle\\nabla_{\\theta}L_{V}(\\theta)=\\mathbb{E}_{\\pi}\\left[(V^{\\tilde{\\pi%\n}}-V)\\nabla_{\\theta}V\\right],\\ \\nabla_{\\theta}L_{Q}(\\theta)=\\mathbb{E}_{\\pi}%\n\\left[(Q^{\\tilde{\\pi}}-Q)\\nabla_{\\theta}Q\\right].')
('3.3', '\\displaystyle\\nabla_{\\theta}L_{V}(\\theta)=\\mathbb{E}_{\\pi}\\left[(V^{\\tilde{\\pi%\n}}-V)\\nabla_{\\theta}V\\right],\\ \\nabla_{\\theta}L_{Q}(\\theta)=\\mathbb{E}_{\\pi}%\n\\left[(Q^{\\tilde{\\pi}}-Q)\\nabla_{\\theta}Q\\right].')
('3.3', '\\theta')
('3.3', '\\displaystyle\\nabla_{\\theta}\\mathcal{J}(\\tau,\\theta)=\\mathbb{E}_{\\pi}\\left[%\n\\tau(Q^{\\tilde{\\pi}}-V)\\nabla_{\\theta}\\log\\pi\\right],')
('3.3', '\\displaystyle\\nabla_{\\theta}\\mathcal{J}(\\tau,\\theta)=\\mathbb{E}_{\\pi}\\left[%\n\\tau(Q^{\\tilde{\\pi}}-V)\\nabla_{\\theta}\\log\\pi\\right],')
('3.3', '\\mathcal{J}(\\tau,\\theta)=\\tau\\mathbb{E}_{\\pi}[\\sum\\gamma^{t}r_{t}]')
('3.3', '\\tau')
('3.3', '\\tau')
('3.3', '\\theta')
('3.3', '\\alpha_{1}\\nabla_{\\theta}L_{V}+\\alpha_{2}\\nabla_{\\theta}L_{Q}+\\alpha_{3}\\nabla%\n_{\\theta}\\mathcal{J}.')
('3.3', '(V,Q,\\pi)')
('3.3', '\\nabla_{\\theta}Q=(\\textbf{1}-\\pi)\\nabla_{\\theta}A=\\tau\\nabla_{\\theta}\\log\\pi.')
('3.3', '\\textbf{g}=(\\textbf{1}-\\pi)\\nabla_{\\theta}A.')
('3.3', '\\displaystyle\\nabla_{\\theta}L_{Q}=\\mathbb{E}_{\\pi}\\left[(Q^{\\tilde{\\pi}}-Q)%\n\\textbf{g}\\right],\\nabla_{\\theta}\\mathcal{J}=\\mathbb{E}_{\\pi}\\left[(Q^{\\tilde{%\n\\pi}}-V)\\textbf{g}\\right].')
('3.3', '\\displaystyle\\nabla_{\\theta}L_{Q}=\\mathbb{E}_{\\pi}\\left[(Q^{\\tilde{\\pi}}-Q)%\n\\textbf{g}\\right],\\nabla_{\\theta}\\mathcal{J}=\\mathbb{E}_{\\pi}\\left[(Q^{\\tilde{%\n\\pi}}-V)\\textbf{g}\\right].')
('3.3', '\\nabla_{\\theta}L_{Q}')
('3.3', '\\nabla_{\\theta}\\mathcal{J}')
('3.3', '\\chi=1')
('3.3', 'Q')
('3.3', '\\pi')
('3.3', '\\tau')
('3.3', '\\nabla_{\\theta}L_{Q}')
('3.3', '\\nabla_{\\theta}\\mathcal{J}')
('3.3', '\\nabla_{\\theta}\\mathcal{J}=\\nabla_{\\theta}L_{Q}+\\mathbb{E}_{\\pi}\\left[(Q-V)%\n\\textbf{g}\\right].')
('3.3', '\\mathbb{E}_{\\pi}\\left[(Q-V)\\textbf{g}\\right]')
('3.3', 'Q')
('3.3', 'Q')
('3.3', '\\nabla_{\\theta}\\mathcal{J}')
('3.3', '\\theta')
('3.3', 'Q')
('3.3', 'Q')
('3.3', '(V,Q,\\pi)')
('3.3', '\\mathbb{E}_{\\pi}\\left[(Q-V)\\textbf{g}\\right]=\\tau\\mathbb{E}_{\\pi}\\left[(Q-V)%\n\\nabla_{\\theta}\\log\\pi\\right]=-\\tau^{2}\\nabla_{\\theta}\\textbf{H}[\\pi],')
('3.3', '\\nabla_{\\theta}L_{Q}=\\nabla_{\\theta}\\mathcal{J}+\\tau^{2}\\nabla_{\\theta}\\textbf%\n{H}[\\pi].')
('3.3', '\\nabla_{\\theta}L_{Q}')
('3.3', '\\nabla_{\\theta}L_{Q}')
('3.3', '\\theta')
('3.3', '\\alpha_{2}\\nabla_{\\theta}L_{Q}')
('3.4', '\\delta^{{\\color[rgb]{0,0,1}DR}}_{t}{=}r_{t}+\\gamma{\\color[rgb]{0,0,1}V}(s_{t+1%\n})-{\\color[rgb]{0,0,1}Q}(s_{t},a_{t})')
('3.4', '\\delta^{{\\color[rgb]{1,.5,0}V}/{\\color[rgb]{0,1,0}Q}}_{t}{=}r_{t}+\\gamma{%\n\\color[rgb]{1,.5,0}V}(s_{t+1})/{\\color[rgb]{0,1,0}Q}(s_{t+1},a_{t+1})-{\\color[%\nrgb]{1,.5,0}V}(s_{t})/{\\color[rgb]{0,1,0}Q}(s_{t},a_{t})')
('3.4', 'V^{\\tilde{\\pi}}')
('3.4', '\\mathbb{E}_{\\mu}[V_{t}+\\sum_{k\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t+k}{\\color[%\nrgb]{0,0,1}\\delta^{DR}_{t+k}}]')
('3.4', '\\mathbb{E}_{\\mu}[V_{t}+\\sum_{k\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t+k}{\\color[%\nrgb]{1,.5,0}\\delta^{V}_{t+k}}]')
('3.4', 'Q^{\\tilde{\\pi}}')
('3.4', '\\mathbb{E}_{\\mu}[Q_{t}+\\sum_{k\\geq 0}\\gamma^{k}{\\color[rgb]{0,0,1}c_{[t+1:t+k-%\n1]}(1_{\\{k=0\\}}+1_{\\{k>0\\}}\\rho_{t+k})\\delta^{DR}_{t+k}}]')
('3.4', '\\mathbb{E}_{\\mu}[Q_{t}+\\sum_{k\\geq 0}\\gamma^{k}{\\color[rgb]{0,1,0}c_{[t+1:t+k]%\n}\\delta^{Q}_{t+k}}]')
('3.4', '\\nabla\\mathcal{J}')
('3.4', '\\mathbb{E}_{\\mu}[\\rho_{t}({\\color[rgb]{0,0,1}Q_{t}^{\\tilde{\\pi}}}-V_{t})\\nabla%\n\\log\\pi]')
('3.4', '\\mathbb{E}_{\\mu}[\\rho_{t}({\\color[rgb]{1,.5,0}r_{t}+V_{t+1}^{\\tilde{\\pi}}}-V_{%\nt})\\nabla\\log\\pi]')
('3.4', '\\mu')
('3.4', 'V^{\\tilde{\\pi}}')
('3.4', 'Q^{\\tilde{\\pi}}')
('3.4', '(V,Q,\\pi)')
('4.1', '\\nabla L_{V}=\\mathbb{E}_{\\pi}[(V^{\\pi}-V_{\\theta})\\nabla V_{\\theta}]')
('4.1', '\\nabla L_{Q}=\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})\\nabla Q_{\\theta}]')
('4.1', '\\nabla\\mathcal{J}=\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{\\theta})\\nabla\\log\\pi_{\\theta}]')
('4.1', '<a,b>')
('4.1', 'a,b\\in\\{\\nabla L_{V},\\nabla L_{Q},\\nabla\\mathcal{J}\\}')
('4.1', 'a')
('4.1', 'b')
('4.1', '\\cos<\\nabla Q,\\nabla\\log\\pi>')
('4.1', '\\chi')
('4.1', '\\mathbb{E}_{\\pi}[\\cos<\\nabla_{\\theta}Q_{\\theta},\\nabla_{\\theta}\\log\\pi_{\\theta%\n}>]')
('4.1', '\\frac{x\\cdot y}{||x||\\cdot||y||}')
('4.1', '\\frac{x\\cdot y}{\\max(||x||,10^{-8})\\cdot\\max(||y||,10^{-8})}')
('4.2', '\\begin{array}[]{c|ccc|ccc}\\hline\\cr\\hline\\cr&\\text{PPO}&&\\text{PPO+CASA}&\\text%\n{R2D2}&&\\text{R2D2+CASA}\\\\\n\\hline\\cr&&\\hbox{\\multirowsetup$\\Rightarrow$}&(V,A)=(V_{\\theta},A_{\\theta})&&%\n\\hbox{\\multirowsetup$\\Rightarrow$}&(V,A)=(V_{\\theta},A_{\\theta})\\\\\n\\text{Func.}&(V,logit)=(V_{\\theta},logit_{\\theta})&&\\pi=\\text{softmax}(A/\\tau)%\n&(V,A)=(V_{\\theta},A_{\\theta})&&\\pi=\\text{softmax}(A/\\tau)\\\\\n\\text{Approx.}&\\pi=\\text{softmax}(logit)&&\\bar{A}=A-sg(\\pi)\\cdot A&Q=A+V&&\\bar%\n{A}=A-sg(\\pi)\\cdot A\\\\\n&&&Q=\\bar{A}+sg(V)&&&Q=\\bar{A}+sg(V)\\\\\n\\hline\\cr\\text{Gradient}&0.5\\nabla L_{V}+\\nabla\\mathcal{J}&\\Rightarrow&0.5%\n\\nabla L_{V}+\\nabla L_{Q}+\\nabla\\mathcal{J}&\\nabla L_{Q}&\\Rightarrow&0.5\\nabla\nL%\n_{V}+\\nabla L_{Q}+\\nabla\\mathcal{J}\\\\\n\\hline\\cr\\hline\\cr\\end{array}')
('4.2', '\\epsilon')
('4.2', '\\arg\\max Q')
('4.2', '\\pi_{surrogate}=\\text{softmax}(A/\\tau)')
('4.2', '\\chi=1')
('4.2', '\\alpha_{1},\\alpha_{2},\\alpha_{3}')
('4.2', '\\cos(\\beta)')
('4.2', '\\chi')
('4.2', '\\pi')
('4.2', 'Q')
('4.3', '\\begin{array}[]{c|c}\\hline\\cr\\hline\\cr\\text{PPO+CASA}&Q=A_{\\theta}-sg(\\pi_{%\n\\theta})\\cdot A_{\\theta}+sg(V_{\\theta})\\\\\n\\hline\\cr\\text{type 1}&Q=A_{\\theta}-\\pi_{\\theta}\\cdot A_{\\theta}+sg(V_{\\theta}%\n)\\\\\n\\hline\\cr\\text{type 2}&Q=A_{\\theta}-sg(\\pi_{\\theta})\\cdot A_{\\theta}+V_{\\theta%\n}\\\\\n\\hline\\cr\\text{type 3}&Q=A_{\\theta}+sg(V_{\\theta})\\\\\n\\hline\\cr\\text{type 4}&Q=A_{\\theta}+V_{\\theta}\\\\\n\\hline\\cr\\text{type 5}&Q=Q_{\\theta}\\\\\n\\hline\\cr\\hline\\cr\\end{array}')
('4.3', '\\&')
('4.3', 'sg')
('4.3', '\\pi')
('4.3', 'sg')
('4.3', 'V_{\\theta}')
('4.3', '\\&')
('4.3', 'sg')
('4.3', 'V')
('4.3', 'Q_{\\theta}')
('4.3', 'Q^{\\pi}')
('4.3', '\\&')
('4.3', 'sg')
('4.3', '\\pi')
('4.3', 'sg')
('4.3', 'V_{\\theta}')
('4.3', '\\&')
('4.3', 'sg')
('4.3', 'V')
('4.3', 'Q_{\\theta}')
('4.3', 'Q^{\\pi}')
('4.3', '\\nabla Q\\propto\\nabla\\log\\pi')
('4.3', '\\chi=1')
('4.3', 'Q=A-\\mathbb{E}_{\\pi}[A]+sg(V)')
('4.3', '0.5\\cdot\\nabla L_{V}+\\nabla L_{Q}+\\nabla\\mathcal{J}')
('4.3', '\\chi')
('4.3', '\\cos(\\beta)')
('4.3', '(\\chi,\\cos(\\beta))')
('4.3', '(\\chi,\\cos(\\beta))')
('4.3', '\\chi')
('4.3', '\\cos(\\beta)')
('4.3', '(\\chi,\\cos(\\beta))')
('4.3', '(\\chi,\\cos(\\beta))')
('4.3', 'sg\\text{-}V')
('4.3', 'no\\text{-}sg\\text{-}V')
('4.3', 'sg\\text{-}V')
('4.3', '\\chi')
('4.3', '\\cos(\\beta)')
('4.3', 'no\\text{-}sg\\text{-}V')
('4.3', 'sg\\text{-}V')
('4.3', '\\chi=1')
('4.3', '\\cos(\\beta)')
('4.3', '\\pi')
('4.3', 'Q^{\\pi}')
('4.3', '\\chi')
('4.3', '\\cos(\\beta)')
('4.3', '\\chi')
('4.3', '\\cos(\\beta)')
('4.4', '\\%')
('4.4', '\\%')
('4.4', '\\%')
('5', '\\chi')
('5', '\\chi=1')
('6', '\\pi')
('6', '\\chi=1')
('6', '\\pi')
('6', '\\chi')
('6', '\\pi')
('6', '\\pi')
('8', 'Q_{w}')
('8', 'w')
('8', '\\pi_{\\theta}')
('8', '\\theta')
('8', 'Q_{w}')
('8', '\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{w})\\nabla_{w}Q_{w}]=0')
('8', '\\nabla_{w}Q_{w}=\\nabla_{\\theta}\\log\\pi_{\\theta},')
('8', '\\nabla_{\\theta}\\mathcal{J}=\\mathbb{E}_{\\pi}[Q_{w}\\nabla_{\\theta}\\log\\pi_{%\n\\theta}].')
('8', 'w=\\theta')
('8', 'Q_{w}')
('8', '\\pi_{\\theta}')
('8', 'Q_{\\theta}')
('8', '\\theta')
('8', '\\pi_{\\theta}')
('8', '\\theta')
('8', 'Q_{\\theta}')
('8', '\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})\\nabla_{\\theta}Q_{\\theta}]=0')
('8', '\\nabla_{\\theta}Q_{\\theta}=\\nabla_{\\theta}\\log\\pi_{\\theta},')
('8', '\\nabla_{\\theta}\\mathcal{J}=\\mathbb{E}_{\\pi}[Q_{\\theta}\\nabla_{\\theta}\\log\\pi_{%\n\\theta}].')
('8', '\\chi\\overset{def}{=}\\mathbb{E}_{\\pi}[\\cos<\\nabla_{\\theta}Q_{\\theta},\\nabla_{%\n\\theta}\\log\\pi_{\\theta}>].')
('8', '\\chi=1')
('8', '\\nabla_{\\theta}Q_{\\theta}=\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\nabla_{\\theta}Q_{\\theta}\\propto\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\chi=1')
('8', '\\chi=1')
('8', '\\nabla_{\\theta}Q_{\\theta}\\propto\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\chi=1')
('8', '\\nabla_{\\theta}Q_{\\theta}\\propto\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\nabla_{\\theta}Q_{\\theta}\\propto\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\nabla_{\\theta}Q_{\\theta}=\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\chi=1')
('8', '\\nabla_{\\theta}Q_{\\theta}=\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\nabla_{\\theta}Q_{\\theta}\\propto\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '<\\nabla_{\\theta}Q_{\\theta},\\nabla_{\\theta}\\log\\pi_{\\theta}>=0')
('8', '\\chi')
('8', '\\chi=\\mathbb{E}_{\\pi}[\\cos<\\nabla_{\\theta}Q_{\\theta},\\nabla_{\\theta}\\log\\pi_{%\n\\theta}>]=\\mathbb{E}_{\\pi}[1]=1.')
('8', '\\chi\\leq 1')
('8', '\\cos(x)')
('8', 'x')
('8', '0')
('8', '\\pi')
('8', '\\chi=1')
('8', '\\cos<\\nabla_{\\theta}Q_{\\theta},\\nabla_{\\theta}\\log\\pi_{\\theta}>=0')
('8', '\\nabla_{\\theta}Q_{\\theta}\\propto\\nabla_{\\theta}\\log\\pi_{\\theta}')
('8', '\\begin{array}[]{c|c|c|c}\\hline\\cr\\hline\\cr&\\text{Function Approximation}&\\text%\n{Train Gradients}&\\text{Cosine of Interested Angles}\\\\\n\\hline\\cr\\text{PPO}&(V,logit)=(V_{\\theta},logit_{\\theta})&0.5\\nabla L_{V}+%\n\\nabla\\mathcal{J}&\\\\\n&\\pi=\\text{softmax}(logit)&&\\\\\n\\hline\\cr\\text{PPO ver.1}&(Q,logit)=(Q_{\\theta},logit_{\\theta}),&0.5\\nabla L_{%\nV}+\\nabla\\mathcal{J}&\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>\\\\\n&\\pi=\\text{softmax}(logit)&&\\cos<\\nabla Q,\\nabla\\log\\pi>\\\\\n&V=sg(\\pi)\\cdot Q&&\\\\\n\\hline\\cr\\text{PPO ver.2}&(Q,logit)=(Q_{\\theta},logit_{\\theta}),&0.5\\nabla L_{%\nV}+\\nabla L_{Q}+\\nabla\\mathcal{J}&\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>\\\\\n&pi=\\text{softmax}(logit)&&\\cos<\\nabla Q,\\nabla\\log\\pi>\\\\\n&V=sg(\\pi)\\cdot Q&&\\\\\n\\hline\\cr\\text{PPO+CASA}&(V,A)=(V_{\\theta},A_{\\theta}),&0.5\\nabla L_{V}+\\nabla\nL%\n_{Q}+\\nabla\\mathcal{J}&\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>\\\\\n&\\pi=\\text{softmax}(A/\\tau),&&\\cos<\\nabla Q,\\nabla\\log\\pi>\\\\\n&\\bar{A}=A-sg(\\pi)\\cdot A&&\\\\\n&Q=\\bar{A}+sg(V)&&\\\\\n\\hline\\cr\\hline\\cr\\end{array}')
('8', '\\nabla L_{Q}')
('8', '\\nabla L_{Q}')
('8', '\\begin{array}[]{c|c|c|c}\\hline\\cr\\hline\\cr&\\text{Function Approximation}&\\text%\n{Train Gradients}&\\text{Cosine of Interested Angles}\\\\\n\\hline\\cr\\text{R2D2}&(V,A)=(V_{\\theta},A_{\\theta})&\\nabla L_{Q}&\\cos<\\nabla L_%\n{Q},\\nabla\\mathcal{J}>\\\\\n&Q=A+V&&\\\\\n&\\pi=\\text{softmax}(A/\\tau)&&\\\\\n\\hline\\cr\\text{R2D2 ver.1}&(V,A)=(V_{\\theta},A_{\\theta})&0.5\\nabla L_{V}+%\n\\nabla L_{Q}&\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>\\\\\n&Q=A+V&&\\\\\n&\\pi=\\text{softmax}(A/\\tau)&&\\\\\n\\hline\\cr\\text{R2D2+CASA}&(V,A)=(V_{\\theta},A_{\\theta}),&0.5\\nabla L_{V}+%\n\\nabla L_{Q}+\\nabla\\mathcal{J}&\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>\\\\\n&\\pi=\\text{softmax}(A/\\tau),&&\\\\\n&\\bar{A}=A-sg(\\pi)\\cdot A&&\\\\\n&Q=\\bar{A}+sg(V)&&\\\\\n\\hline\\cr\\hline\\cr\\end{array}')
('8', '\\nabla L_{V}')
('8', '\\nabla L_{V}')
('8', '\\beta\\overset{def}{=}<\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})\\nabla_{\\theta}Q_{%\n\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{\\theta})\\nabla_{\\theta}\\log\\pi_{\\theta%\n}]>')
('8', '\\chi\\overset{def}{=}\\mathbb{E}_{\\pi}[\\cos<\\nabla_{\\theta}Q_{\\theta},\\nabla_{%\n\\theta}\\log\\pi_{\\theta}>]')
('8', 'L_{V}(\\theta)=\\mathbb{E}_{\\pi}[(V^{\\pi}-V_{\\theta})^{2}],\\ L_{Q}(\\theta)=%\n\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})^{2}],')
('8', '\\nabla_{\\theta}\\mathcal{J}(\\theta)=\\mathbb{E}_{\\pi}\\left[(Q^{\\pi}-V_{\\theta})%\n\\nabla_{\\theta}\\log\\pi\\right].')
('8', 'V^{\\pi}')
('8', 'Q^{\\pi}')
('8', '\\cos<\\nabla Q,\\nabla\\log\\pi>=\\mathbb{E}_{\\pi}[\\cos<\\nabla_{\\theta}Q_{\\theta},%\n\\nabla_{\\theta}\\log\\pi_{\\theta}>],')
('8', '\\displaystyle\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>=\\cos<\\mathbb{E}_{\\pi}[(Q^{%\n\\pi}-Q_{\\theta})\\nabla_{\\theta}Q_{\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{%\n\\theta})\\nabla_{\\theta}\\log\\pi_{\\theta}]>,')
('8', '\\displaystyle\\cos<\\nabla L_{Q},\\nabla\\mathcal{J}>=\\cos<\\mathbb{E}_{\\pi}[(Q^{%\n\\pi}-Q_{\\theta})\\nabla_{\\theta}Q_{\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{%\n\\theta})\\nabla_{\\theta}\\log\\pi_{\\theta}]>,')
('8', '\\displaystyle\\cos<\\nabla L_{V},\\nabla\\mathcal{J}>=\\cos<\\mathbb{E}_{\\pi}[(V^{%\n\\pi}-V_{\\theta})\\nabla_{\\theta}V_{\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{%\n\\theta})\\nabla_{\\theta}\\log\\pi_{\\theta}]>,')
('8', '\\displaystyle\\cos<\\nabla L_{V},\\nabla\\mathcal{J}>=\\cos<\\mathbb{E}_{\\pi}[(V^{%\n\\pi}-V_{\\theta})\\nabla_{\\theta}V_{\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-V_{%\n\\theta})\\nabla_{\\theta}\\log\\pi_{\\theta}]>,')
('8', '\\displaystyle\\cos<\\nabla L_{V},\\nabla L_{Q}>=\\cos<\\mathbb{E}_{\\pi}[(V^{\\pi}-V_%\n{\\theta})\\nabla_{\\theta}V_{\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})%\n\\nabla_{\\theta}Q_{\\theta}]>.')
('8', '\\displaystyle\\cos<\\nabla L_{V},\\nabla L_{Q}>=\\cos<\\mathbb{E}_{\\pi}[(V^{\\pi}-V_%\n{\\theta})\\nabla_{\\theta}V_{\\theta}],\\,\\mathbb{E}_{\\pi}[(Q^{\\pi}-Q_{\\theta})%\n\\nabla_{\\theta}Q_{\\theta}]>.')
('8', '\\nabla_{\\theta}L_{V}')
('8', '\\nabla_{\\theta}\\mathcal{J}')
('8', '\\nabla_{\\theta}L_{Q}')
('8', '\\cos(\\beta)')
('8', '\\chi')
('8', 'V_{\\theta}')
('8', 'sg(\\pi)\\cdot Q_{\\theta}')
('8', 'Q_{\\theta}')
('8', 'V_{\\theta}')
('8', 'Q_{\\theta}')
('8', '\\epsilon')
('8', '\\epsilon')
('8', '\\arg\\max Q_{\\theta}')
('8', '\\arg\\max Q_{\\theta}')
('8', '\\text{softmax}(A_{\\theta}/\\tau)=\\text{softmax}(Q_{\\theta}/\\tau)\\overset{\\tau%\n\\rightarrow 0+}{\\longrightarrow}\\arg\\max Q_{\\theta}')
('8', '\\pi_{surrogate}=\\text{softmax}(A_{\\theta}/\\tau)')
('8', '\\pi_{surrogate}')
('8', '\\epsilon')
('8', '\\tau=1')
('8', '\\left\\{\\begin{aligned} &\\pi=\\text{softmax}(A),\\\\\n&\\bar{A}=A-\\mathbb{E}_{\\pi}[A],\\\\\n&Q=\\bar{A}+sg(V).\\end{aligned}\\right.')
('8', '\\text{softmax}(A)')
('8', '\\mathbb{E}_{\\pi}[A]')
('8', 'a_{0},\\dots,a_{k}')
('8', 'A(s,a_{0}),\\dots,A(s,a_{k})')
('8', 'K(\\cdot,\\cdot)')
('8', 'a')
('8', 'A(s,a)')
('8', 'A(s,a)=\\frac{1}{Z_{a}}(K(a_{0},a)A(s,a_{0})+\\dots+K(a_{k},a)A(s,a_{k})),')
('8', 'Z_{a}=\\sum_{i=0}^{k}K(a_{i},a)')
('8', 'K(\\cdot,a)')
('8', 'a')
('8', '|\\{A(s,a_{0}),\\dots,A(s,a_{k})\\}|')
('8', '\\text{softmax}(A)')
('8', '\\mathbb{E}_{\\pi}[A]')
('8', 'V')
('8', '\\left\\{\\begin{aligned} &\\pi(s,a)=\\exp(A(s,a))/\\int_{a}\\exp(A(s,a))da,\\\\\n&\\bar{A}(s,a)=A(s,a)-\\int_{a}sg(\\pi(s,a))A(s,a)da,\\\\\n&Q(s,a)=\\bar{A}(s,a)+sg(V(s)).\\end{aligned}\\right.')
('8', '\\displaystyle\\nabla\\log\\pi(s,a)=\\nabla A(s,a)-\\frac{\\nabla\\int_{a}\\exp(A(s,a))%\nda}{\\int_{a}\\exp(A(s,a))da}')
('8', '\\displaystyle\\nabla\\log\\pi(s,a)')
('8', '\\displaystyle=\\nabla A(s,a)-\\frac{\\nabla\\int_{a}\\exp(A(s,a))da}{\\int_{a}\\exp(A%\n(s,a))da}')
('8', '\\displaystyle=\\nabla A(s,a)-\\frac{\\int_{a}\\exp(A(s,a))\\nabla A(s,a)da}{\\int_{a%\n}\\exp(A(s,a))da}')
('8', '\\displaystyle=\\nabla A(s,a)-\\frac{\\int_{a}\\exp(A(s,a))\\nabla A(s,a)da}{\\int_{a%\n}\\exp(A(s,a))da}')
('8', '\\displaystyle=\\nabla A(s,a)-\\int_{a}\\frac{\\exp(A(s,a))}{\\int_{a}\\exp(A(s,a))da%\n}\\nabla A(s,a)da')
('8', '\\displaystyle=\\nabla A(s,a)-\\int_{a}\\frac{\\exp(A(s,a))}{\\int_{a}\\exp(A(s,a))da%\n}\\nabla A(s,a)da')
('8', '\\displaystyle=\\nabla A(s,a)-\\int_{a}\\pi(s,a)\\nabla A(s,a)da')
('8', '\\displaystyle=\\nabla A(s,a)-\\int_{a}\\pi(s,a)\\nabla A(s,a)da')
('8', '\\displaystyle=\\nabla\\bar{A}(s,a)=\\nabla Q(s,a).')
('8', '\\displaystyle=\\nabla\\bar{A}(s,a)=\\nabla Q(s,a).')
('8', '(V,Q,\\pi)')
('8', '\\tilde{\\pi}_{VTrace}=\\tilde{\\pi}_{ReTrace}')
('8', '(V,Q,\\pi)')
('8', 'V')
('8', 'Q')
('8', '\\tilde{\\pi}_{VTrace}=\\tilde{\\pi}_{ReTrace}')
('8', '(V,Q)')
('8', 'V')
('8', '\\displaystyle V_{DR}^{\\tilde{\\pi}}(s_{t})\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_%\n{t})+\\sum_{k\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t+k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle V_{DR}^{\\tilde{\\pi}}(s_{t})')
('8', '\\displaystyle\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_{t})+\\sum_{k\\geq 0}\\gamma^{k%\n}c_{[t:t+k-1]}\\rho_{t+k}\\delta^{DR}_{t+k}],')
('8', '\\mu')
('8', '\\delta^{DR}_{t}\\overset{def}{=}r_{t}+\\gamma V(s_{t+1})-Q(s_{t},a_{t})')
('8', '\\rho_{t}\\overset{def}{=}\\min\\{\\frac{\\pi_{t}}{\\mu_{t}},\\bar{\\rho}\\}')
('8', 'c_{t}\\overset{def}{=}\\min\\{\\frac{\\pi_{t}}{\\mu_{t}},\\bar{c}\\}')
('8', 'c_{[t:t+k]}\\overset{def}{=}\\prod_{i=0}^{k}c_{t+i}')
('8', 'Q')
('8', '\\displaystyle Q_{DR}^{\\tilde{\\pi}}(s_{t},a_{t})\\overset{def}{=}\\mathbb{E}_{s_{%\nt+1},r_{t}\\sim p(\\cdot,\\cdot|s_{t},a_{t})}[r_{t}+\\gamma V_{DR}^{\\tilde{\\pi}}(s%\n_{t+1})]')
('8', '\\displaystyle Q_{DR}^{\\tilde{\\pi}}(s_{t},a_{t})')
('8', '\\displaystyle\\overset{def}{=}\\mathbb{E}_{s_{t+1},r_{t}\\sim p(\\cdot,\\cdot|s_{t}%\n,a_{t})}[r_{t}+\\gamma V_{DR}^{\\tilde{\\pi}}(s_{t+1})]')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:%\nt+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:%\nt+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\tilde{\\rho}_{t,k}=1_{\\{k=0\\}}+1_{\\{k>0\\}}\\rho_{t+k}')
('8', '\\bar{A}=A-\\mathbb{E}_{\\pi}[A]')
('8', 'Q=\\bar{A}+sg(V)')
('8', '\\displaystyle\\mathscr{T}(Q)\\overset{def}{=}\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+%\n\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{T}(Q)\\overset{def}{=}\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+%\n\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{S}(V)\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_{t})+\\sum_{k%\n\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{S}(V)\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_{t})+\\sum_{k%\n\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{U}(Q,V)=(\\mathscr{T}(Q)-\\mathbb{E}_{\\pi}[Q]+\\mathscr{S}(%\nV),\\mathscr{S}(V)),')
('8', '\\displaystyle\\mathscr{U}(Q,V)=(\\mathscr{T}(Q)-\\mathbb{E}_{\\pi}[Q]+\\mathscr{S}(%\nV),\\mathscr{S}(V)),')
('8', '\\displaystyle\\mathscr{U}^{(n)}(Q,V)=\\mathscr{U}(\\mathscr{U}^{(n-1)}(Q,V)),')
('8', '\\displaystyle\\mathscr{U}^{(n)}(Q,V)=\\mathscr{U}(\\mathscr{U}^{(n-1)}(Q,V)),')
('8', '\\mathscr{U}^{(n)}(Q,V)\\rightarrow(Q^{\\tilde{\\pi}},V^{\\tilde{\\pi}})')
('8', '\\tilde{\\pi}(a|s)=\\frac{\\min\\left\\{\\bar{\\rho}\\mu(a|s),\\pi(a|s)\\right\\}}{\\sum_{b%\n\\in\\mathcal{A}}\\min\\left\\{\\bar{\\rho}\\mu(b|s),\\pi(b|s)\\right\\}}.')
('8', 'n\\rightarrow+\\infty')
('8', '(V,Q)')
('8', '(V^{\\tilde{\\pi}},Q^{\\tilde{\\pi}})')
('8', '\\displaystyle\\tilde{\\pi}(a|s)=\\frac{\\min\\left\\{\\bar{\\rho}\\mu(a|s),\\pi(a|s)%\n\\right\\}}{\\sum_{b\\in\\mathcal{A}}\\min\\left\\{\\bar{\\rho}\\mu(b|s),\\pi(b|s)\\right\\}}.')
('8', '\\displaystyle\\tilde{\\pi}(a|s)=\\frac{\\min\\left\\{\\bar{\\rho}\\mu(a|s),\\pi(a|s)%\n\\right\\}}{\\sum_{b\\in\\mathcal{A}}\\min\\left\\{\\bar{\\rho}\\mu(b|s),\\pi(b|s)\\right\\}}.')
('8', '\\pi=softmax(A/\\tau)')
('8', '\\nabla\\log\\pi=(\\textbf{1}-\\pi)\\frac{\\nabla A}{\\tau}')
('8', 'sg')
('8', '\\bar{A}=A-\\mathbb{E}_{\\pi}[A]')
('8', 'Q=\\bar{A}+sg(V)')
('8', '\\nabla Q=(\\textbf{1}-\\pi)\\nabla A')
('8', 'Q=\\bar{A}+sg(V)=A-sg(\\pi)\\cdot A+sg(V)')
('8', '\\nabla Q=(\\textbf{1}-\\pi)\\nabla A')
('8', '\\log\\pi')
('8', '\\nabla\\log\\pi=(\\textbf{1}-\\pi)\\nabla(A/\\tau)=(\\textbf{1}-\\pi)\\frac{\\nabla A}{\\tau}')
('8', '\\bar{A}=A-\\mathbb{E}_{\\pi}[A]')
('8', 'Q=\\bar{A}+sg(V),\\pi=softmax(A/\\tau)')
('8', '\\mathbb{E}_{\\pi}\\left[(Q-V)\\nabla\\log\\pi\\right]=-\\tau\\nabla\\textbf{H}[\\pi].')
('8', '\\pi=\\exp(A/\\tau)/Z,\\ Z=\\int_{\\mathcal{A}}\\exp(A/\\tau),')
('8', 'A=\\tau\\log\\pi+\\tau\\log Z.')
('8', '\\mathbb{E}_{\\pi}\\left[f(s)\\nabla\\log\\pi(\\cdot|s)\\right]=0')
('8', '\\mathbb{E}_{\\pi}\\left[\\mathbb{E}_{\\pi}[A]\\cdot\\nabla\\log\\pi\\right]=0,')
('8', '\\mathbb{E}_{\\pi}\\left[\\log Z\\cdot\\nabla\\log\\pi\\right]=0.')
('8', '\\displaystyle\\mathbb{E}_{\\pi}\\left[(Q-V)\\nabla\\log\\pi\\right]=\\mathbb{E}_{\\pi}%\n\\left[A\\nabla\\log\\pi\\right]-\\mathbb{E}_{\\pi}\\left[\\mathbb{E}_{\\pi}[A]\\cdot%\n\\nabla\\log\\pi\\right]')
('8', '\\displaystyle\\mathbb{E}_{\\pi}\\left[(Q-V)\\nabla\\log\\pi\\right]')
('8', '\\displaystyle=\\mathbb{E}_{\\pi}\\left[A\\nabla\\log\\pi\\right]-\\mathbb{E}_{\\pi}%\n\\left[\\mathbb{E}_{\\pi}[A]\\cdot\\nabla\\log\\pi\\right]')
('8', '\\displaystyle=\\tau\\mathbb{E}_{\\pi}\\left[\\log\\pi\\nabla\\log\\pi\\right]+\\tau%\n\\mathbb{E}_{\\pi}\\left[\\log Z\\cdot\\nabla\\log\\pi\\right]')
('8', '\\displaystyle=\\tau\\mathbb{E}_{\\pi}\\left[\\log\\pi\\nabla\\log\\pi\\right]+\\tau%\n\\mathbb{E}_{\\pi}\\left[\\log Z\\cdot\\nabla\\log\\pi\\right]')
('8', '\\displaystyle=\\tau\\mathbb{E}_{\\pi}\\left[\\log\\pi\\nabla\\log\\pi\\right].')
('8', '\\displaystyle=\\tau\\mathbb{E}_{\\pi}\\left[\\log\\pi\\nabla\\log\\pi\\right].')
('8', '\\displaystyle\\nabla\\textbf{H}[\\pi]=-\\nabla\\int_{\\mathcal{A}}\\pi_{i}\\log\\pi_{i}')
('8', '\\displaystyle\\nabla\\textbf{H}[\\pi]')
('8', '\\displaystyle=-\\nabla\\int_{\\mathcal{A}}\\pi_{i}\\log\\pi_{i}')
('8', '\\displaystyle=-\\int_{\\mathcal{A}}\\nabla\\pi_{i}\\cdot\\log\\pi_{i}-\\int_{\\mathcal{%\nA}}\\pi_{i}\\nabla\\log\\pi_{i}')
('8', '\\displaystyle=-\\int_{\\mathcal{A}}\\nabla\\pi_{i}\\cdot\\log\\pi_{i}-\\int_{\\mathcal{%\nA}}\\pi_{i}\\nabla\\log\\pi_{i}')
('8', '\\displaystyle=-\\int_{\\mathcal{A}}\\pi_{i}\\nabla\\log\\pi_{i}\\cdot\\log\\pi_{i}-\\int%\n_{\\mathcal{A}}\\pi_{i}\\frac{\\nabla\\pi_{i}}{\\pi_{i}}')
('8', '\\displaystyle=-\\int_{\\mathcal{A}}\\pi_{i}\\nabla\\log\\pi_{i}\\cdot\\log\\pi_{i}-\\int%\n_{\\mathcal{A}}\\pi_{i}\\frac{\\nabla\\pi_{i}}{\\pi_{i}}')
('8', '\\displaystyle=-\\mathbb{E}_{\\pi}\\left[\\log\\pi\\nabla\\log\\pi\\right].')
('8', '\\displaystyle=-\\mathbb{E}_{\\pi}\\left[\\log\\pi\\nabla\\log\\pi\\right].')
('8', '\\mathbb{E}_{\\pi}\\left[(Q-V)\\nabla\\log\\pi\\right]=-\\tau\\nabla\\textbf{H}[\\pi]')
('8', '\\bar{A}=A-\\mathbb{E}_{\\pi}[A]')
('8', 'Q=\\bar{A}+sg(V)')
('8', '\\displaystyle\\mathscr{T}(Q)\\overset{def}{=}\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+%\n\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{T}(Q)\\overset{def}{=}\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+%\n\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{S}(V)\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_{t})+\\sum_{k%\n\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{S}(V)\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_{t})+\\sum_{k%\n\\geq 0}\\gamma^{k}c_{[t:t+k-1]}\\rho_{t,k}\\delta^{DR}_{t+k}],')
('8', '\\displaystyle\\mathscr{U}(Q,V)=(\\mathscr{T}(Q)-\\mathbb{E}_{\\pi}[Q]+\\mathscr{S}(%\nV),\\mathscr{S}(V)),')
('8', '\\displaystyle\\mathscr{U}(Q,V)=(\\mathscr{T}(Q)-\\mathbb{E}_{\\pi}[Q]+\\mathscr{S}(%\nV),\\mathscr{S}(V)),')
('8', '\\displaystyle\\mathscr{U}^{(n)}(Q,V)=\\mathscr{U}(\\mathscr{U}^{(n-1)}(Q,V)),')
('8', '\\displaystyle\\mathscr{U}^{(n)}(Q,V)=\\mathscr{U}(\\mathscr{U}^{(n-1)}(Q,V)),')
('8', '\\mathscr{U}^{(n)}(Q,V)\\rightarrow(Q^{\\tilde{\\pi}},V^{\\tilde{\\pi}})')
('8', '\\tilde{\\pi}(a|s)=\\frac{\\min\\left\\{\\bar{\\rho}\\mu(a|s),\\pi(a|s)\\right\\}}{\\sum_{b%\n\\in\\mathcal{A}}\\min\\left\\{\\bar{\\rho}\\mu(b|s),\\pi(b|s)\\right\\}}.')
('8', 'n\\rightarrow+\\infty')
('8', '\\mathscr{T}(Q)-\\mathbb{E}_{\\pi}[Q]+\\mathscr{S}(V)')
('8', 'Q')
('8', 'Q=\\bar{A}+sg(V)')
('8', 'Q')
('8', 'V')
('8', '\\nabla L_{Q}(\\theta)')
('8', '\\nabla L_{V}(\\theta)')
('8', 'Q')
('8', '\\nabla L_{Q}(\\theta)')
('8', 'A')
('8', '\\nabla L_{V}(\\theta)')
('8', 'V')
('8', 'V')
('8', 'Q')
('8', '-\\mathbb{E}_{\\pi}[Q]+\\mathscr{S}(V)')
('8', '\\displaystyle\\widetilde{\\mathscr{T}}(Q)=-\\mathbb{E}_{\\pi}[Q]+\\mathscr{T}(Q),')
('8', '\\displaystyle\\widetilde{\\mathscr{T}}(Q)')
('8', '\\displaystyle=-\\mathbb{E}_{\\pi}[Q]+\\mathscr{T}(Q),')
('8', '\\displaystyle\\widetilde{\\mathscr{U}}(Q,V)=(\\widetilde{\\mathscr{T}}(Q),\\mathscr%\n{S}(V)),')
('8', '\\displaystyle\\widetilde{\\mathscr{U}}(Q,V)')
('8', '\\displaystyle=(\\widetilde{\\mathscr{T}}(Q),\\mathscr{S}(V)),')
('8', '\\displaystyle\\widetilde{\\mathscr{U}}^{(n)}(Q,V)=\\widetilde{\\mathscr{U}}(%\n\\widetilde{\\mathscr{U}}^{(n-1)}(Q,V)).')
('8', '\\displaystyle\\widetilde{\\mathscr{U}}^{(n)}(Q,V)')
('8', '\\displaystyle=\\widetilde{\\mathscr{U}}(\\widetilde{\\mathscr{U}}^{(n-1)}(Q,V)).')
('8', '\\widetilde{\\mathscr{T}}^{(n)}(Q)')
('8', 'A^{*}')
('8', 'n\\rightarrow\\infty')
('8', 'V')
('8', 'V')
('8', 'Q')
('8', 'A^{*}')
('8', 'V')
('8', '\\mathscr{S}^{(n)}(V)')
('8', 'V^{*}')
('8', 'n\\rightarrow\\infty')
('8', '\\widetilde{\\mathscr{U}}^{(n)}(Q,V)\\rightarrow(A^{*},V^{*})\\ \\ as\\ \\ n%\n\\rightarrow+\\infty.')
('8', '\\mathscr{U}(Q,V)=(\\widetilde{\\mathscr{T}}(Q)+\\mathscr{S}(V),\\mathscr{S}(V)),')
('8', '\\widetilde{\\mathscr{T}}(Q)+\\mathscr{S}(V)')
('8', 'Q')
('8', '\\mathscr{S}(V)')
('8', 'V')
('8', '\\displaystyle\\mathscr{U}^{(2)}(Q,V)=\\mathscr{U}(\\widetilde{\\mathscr{T}}(Q)+%\n\\mathscr{S}(V),\\mathscr{S}(V))')
('8', '\\displaystyle\\mathscr{U}^{(2)}(Q,V)')
('8', '\\displaystyle=\\mathscr{U}(\\widetilde{\\mathscr{T}}(Q)+\\mathscr{S}(V),\\mathscr{S%\n}(V))')
('8', '\\displaystyle=(\\mathscr{T}(\\widetilde{\\mathscr{T}}(Q)+\\mathscr{S}(V))-\\mathscr%\n{S}(V)+\\mathscr{S}^{(2)}(V),\\mathscr{S}^{(2)}(V))')
('8', '\\displaystyle=(\\mathscr{T}(\\widetilde{\\mathscr{T}}(Q)+\\mathscr{S}(V))-\\mathscr%\n{S}(V)+\\mathscr{S}^{(2)}(V),\\mathscr{S}^{(2)}(V))')
('8', '\\displaystyle=(\\widetilde{\\mathscr{T}}^{(2)}(Q)+\\mathscr{S}^{(2)}(V),\\mathscr{%\nS}^{(2)}(V)).')
('8', '\\displaystyle=(\\widetilde{\\mathscr{T}}^{(2)}(Q)+\\mathscr{S}^{(2)}(V),\\mathscr{%\nS}^{(2)}(V)).')
('8', '\\displaystyle\\mathscr{U}^{(n)}(Q,V)=(\\widetilde{\\mathscr{T}}^{(n)}(Q)+\\mathscr%\n{S}^{(n)}(V),\\mathscr{S}^{(n)}(V))')
('8', '\\displaystyle\\mathscr{U}^{(n)}(Q,V)')
('8', '\\displaystyle=(\\widetilde{\\mathscr{T}}^{(n)}(Q)+\\mathscr{S}^{(n)}(V),\\mathscr{%\nS}^{(n)}(V))')
('8', '\\displaystyle\\rightarrow(A^{*}+V^{*},V^{*})\\ \\ as\\ \\ n\\rightarrow+\\infty.')
('8', '\\displaystyle\\rightarrow(A^{*}+V^{*},V^{*})\\ \\ as\\ \\ n\\rightarrow+\\infty.')
('8', '\\tilde{\\pi}(a|s)=\\frac{\\min\\left\\{\\bar{\\rho}\\mu(a|s),\\pi(a|s)\\right\\}}{\\sum_{b%\n\\in\\mathcal{A}}\\min\\left\\{\\bar{\\rho}\\mu(b|s),\\pi(b|s)\\right\\}}.')
('8', '\\mathbb{E}_{\\mu}[\\rho_{t}(r_{t}+\\gamma V_{t+1}-V_{t})|\\mathscr{F}_{t}]=0,')
('8', '\\mathscr{U}(Q^{\\tilde{\\pi}},V^{\\tilde{\\pi}})=(Q^{\\tilde{\\pi}},V^{\\tilde{\\pi}})')
('8', '(A^{*}+V^{*},V^{*})=(Q^{\\tilde{\\pi}},V^{\\tilde{\\pi}}).')
('8', '\\bar{A}=A-\\mathbb{E}_{\\pi}[A]')
('8', 'Q=\\bar{A}+sg(V)')
('8', '\\mathscr{T}(Q)\\overset{def}{=}\\mathbb{E}_{\\mu}[Q(s_{t},a_{t})+\\sum_{k\\geq 0}%\n\\gamma^{k}c_{[t+1:t+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}]')
('8', 'Q')
('8', '\\mathscr{T}(Q)')
('8', 'Q=A+sg(V)')
('8', 'V')
('8', 'Q')
('8', 'Q')
('8', 'V')
('8', 'A')
('8', 'V')
('8', 'V^{*}')
('8', '\\bar{A}=A-\\mathbb{E}_{\\pi}[A]')
('8', '\\mathbb{E}_{\\pi}[\\bar{A}]=0')
('8', 'A')
('8', '\\mathbb{E}_{\\pi}[Q]=V^{*}')
('8', '\\widetilde{\\mathscr{T}}(Q)\\overset{def}{=}-\\mathbb{E}_{\\pi}[Q]+\\mathscr{T}(Q).')
('8', '\\widetilde{\\mathscr{T}}(Q)')
('8', 'Q_{t}=Q(s_{t},a_{t}),A_{t}=A(s_{t},a_{t}),V^{*}_{t}=V^{*}(s_{t}).')
('8', '\\tilde{\\rho}_{t,0}=1')
('8', '\\mathscr{F}')
('8', '\\widetilde{\\mathscr{T}}')
('8', '\\displaystyle\\widetilde{\\mathscr{T}}(Q)=\\mathbb{E}_{\\mu}[A_{t}+\\sum_{k\\geq 0}%\n\\gamma^{k}c_{[t+1:t+k-1]}\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}]')
('8', '\\displaystyle\\widetilde{\\mathscr{T}}(Q)')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[A_{t}+\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-1]}%\n\\tilde{\\rho}_{t,k}\\delta^{DR}_{t+k}]')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[-V^{*}_{t}+\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-%\n1]}\\tilde{\\rho}_{t,k}r_{t+k}+\\sum_{k\\geq 0}\\gamma^{k+1}c_{[t+1:t+k-1]}\\Delta_{%\nk}],')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[-V^{*}_{t}+\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k-%\n1]}\\tilde{\\rho}_{t,k}r_{t+k}+\\sum_{k\\geq 0}\\gamma^{k+1}c_{[t+1:t+k-1]}\\Delta_{%\nk}],')
('8', '\\Delta_{k}=\\mathbb{E}_{\\mu}\\left[\\tilde{\\rho}_{t,k}V^{*}_{t+k+1}-c_{t+k}\\tilde%\n{\\rho}_{t,k+1}Q_{t+k+1}|\\mathscr{F}_{t+k}\\right].')
('8', 'Q')
('8', '\\mathbb{E}_{\\mu}[V_{t+k+1}^{*}|\\mathscr{F}_{t+k}]=\\mathbb{E}_{\\mu}[\\mathbb{E}_%\n{\\pi}[Q_{t+k+1}|\\mathscr{F}_{t+k+1}]|\\mathscr{F}_{t+k}],\\\\\n')
('8', '\\Delta_{k}=\\mathbb{E}_{\\mu}[(\\tilde{\\rho}_{t,k}\\frac{\\pi_{t+k+1}}{\\mu_{t+k+1}}%\n-c_{t+k}\\tilde{\\rho}_{t,k+1})Q_{t+k+1}|\\mathscr{F}_{t+k}].')
('8', 'Q_{1}=A_{1}+sg(V^{*})')
('8', 'Q_{2}=A_{2}+sg(V^{*})')
('8', '\\mathbb{E}_{\\mu}[(\\tilde{\\rho}_{t,k}\\frac{\\pi_{t+k+1}}{\\mu_{t+k+1}}-c_{t+k}%\n\\tilde{\\rho}_{t,k+1})|\\mathscr{F}_{t+k}]\\geq 0,')
('8', '||\\widetilde{\\mathscr{T}}(Q_{1})-\\widetilde{\\mathscr{T}}(Q_{2})||\\leq\\mathcal{%\nC}||Q_{1}-Q_{2}||,')
('8', '\\displaystyle\\mathcal{C}=\\mathbb{E}_{\\mu}[\\sum_{k\\geq 0}\\gamma^{k+1}c_{[t+1:t+%\nk-1]}(\\tilde{\\rho}_{t,k}\\frac{\\pi_{t+k+1}}{\\mu_{t+k+1}}-c_{t+k}\\tilde{\\rho}_{t%\n,k+1})]')
('8', '\\displaystyle\\mathcal{C}')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[\\sum_{k\\geq 0}\\gamma^{k+1}c_{[t+1:t+k-1]}(%\n\\tilde{\\rho}_{t,k}\\frac{\\pi_{t+k+1}}{\\mu_{t+k+1}}-c_{t+k}\\tilde{\\rho}_{t,k+1})]')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[1-1+\\sum_{k\\geq 0}\\gamma^{k+1}c_{[t+1:t+k-1]}%\n\\left(\\tilde{\\rho}_{t,k}-c_{t+k}\\tilde{\\rho}_{t,k+1}\\right)]')
('8', '\\displaystyle=\\mathbb{E}_{\\mu}[1-1+\\sum_{k\\geq 0}\\gamma^{k+1}c_{[t+1:t+k-1]}%\n\\left(\\tilde{\\rho}_{t,k}-c_{t+k}\\tilde{\\rho}_{t,k+1}\\right)]')
('8', '\\displaystyle=1-(1-\\gamma)\\mathbb{E}_{\\mu}[\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k%\n-1]}\\tilde{\\rho}_{t,k}]')
('8', '\\displaystyle=1-(1-\\gamma)\\mathbb{E}_{\\mu}[\\sum_{k\\geq 0}\\gamma^{k}c_{[t+1:t+k%\n-1]}\\tilde{\\rho}_{t,k}]')
('8', '\\displaystyle\\leq 1-(1-\\gamma)<1.')
('8', '\\displaystyle\\leq 1-(1-\\gamma)<1.')
('8', '\\widetilde{\\mathscr{T}}(Q)')
('8', 'A^{*}')
('8', '\\mathscr{T}(Q)')
('8', 'A^{*}+V^{*}')
('8', 'Q=A+sg(V)')
('8', '\\mathbb{E}_{\\pi}[A]=0')
('8', '\\mathscr{S}(V)\\overset{def}{=}\\mathbb{E}_{\\mu}[V(s_{t})+\\sum_{k\\geq 0}\\gamma^{%\nk}c_{[t:t+k-1]}\\rho_{t,k}\\delta^{DR}_{t+k}]')
('8', 'V')
('8', '\\mathscr{S}(V)')
('8', '\\Delta_{k}=\\mathbb{E}_{\\mu}\\left[\\left(\\rho_{t+k}-c_{t+k}\\rho_{t+k+1}\\right)V_%\n{t+k+1}-c_{t+k}\\rho_{t+k+1}A^{*}_{t+k+1}|\\mathscr{F}_{t+k}\\right],')
('8', '\\Delta^{1}_{k}-\\Delta^{2}_{k}=\\mathbb{E}_{\\mu}\\left[\\left(\\rho_{t+k}-c_{t+k}%\n\\rho_{t+k+1}\\right)\\cdot(V^{1}_{t+k+1}-V^{2}_{t+k+1})|\\mathscr{F}_{t+k}\\right].')
('8', 'V')
('8', 'Q')
('8', '\\pi')
('8', '\\beta_{1}')
('8', '\\beta_{2}')
('8', '\\epsilon')
('8', 'n')
('8', 'n')
('8', '(r,0,1)')
('8', '\\gamma')
('8', '\\epsilon')
('8', '\\lambda')
('8', '\\tau')
('8', 'Q_{t}^{\\tilde{\\pi}}=h(\\sum_{i=0}^{n-1}\\gamma^{i}r_{t+i}+\\gamma^{n}h^{-1}(\\text%\n{Double}(Q_{t+n})))')
('8', 'h')
('8', 'h(x)=\\text{sign}(x)\\cdot(\\sqrt{|x|+1}-1)+10^{-3}x')
('8', 'n')
('8', '\\epsilon')
('8', '\\epsilon\\sim 0.4^{\\text{uniform}(1,8)}')
('8', '\\alpha')
('8', '\\gamma')
('8', '\\tau')
('8', '\\log(|r|+1.0)\\cdot(2\\cdot 1_{\\{r\\geq 0\\}}-1_{\\{r<0\\}})')
('8', '\\gamma')
('8', 'V')
('8', '\\alpha_{1}')
('8', 'Q')
('8', '\\alpha_{2}')
('8', '\\pi')
('8', '\\alpha_{3}')
('8', '\\tau')
('8', '\\bar{c}')
('8', '\\bar{\\rho}')
