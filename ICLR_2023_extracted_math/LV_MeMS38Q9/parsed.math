(None, '\\mathcal{O}(d^{3})')
(None, '\\mathcal{O}(d^{2})')
('1', '\\mathcal{U}_{k},\\mathcal{L}_{k}')
('1', '\\mathcal{U}_{k},\\mathcal{L}_{k}')
('1', '\\mathcal{O}(d^{3})')
('1', '\\mathcal{O}(d^{2})')
('1', 'd')
('2', 'P')
('2', '\\lambda')
('2', '\\mathcal{C}')
('2', '\\lambda')
('2', '\\theta')
('2', 'P:\\arg\\min_{\\theta}\\mathcal{C}(\\theta,\\lambda,\\cdots)')
('2', 'n')
('2', '\\displaystyle P_{n}:\\theta_{n}^{*}=\\underset{\\theta_{n}}{\\mathrm{argmin}}\\;%\n\\mathcal{C}_{n}(\\theta_{n},\\mathcal{U}_{n},\\mathcal{L}_{n};\\mathcal{D}_{n})')
('2', '\\displaystyle P_{n}:')
('2', '\\displaystyle\\theta_{n}^{*}=\\underset{\\theta_{n}}{\\mathrm{argmin}}\\;\\mathcal{C%\n}_{n}(\\theta_{n},\\mathcal{U}_{n},\\mathcal{L}_{n};\\mathcal{D}_{n})')
('2', '\\rhd')
('2', 'n')
('2', '\\rhd')
('2', 'n')
('2', '\\displaystyle\\hskip 22.76219pt\\ddots')
('2', '\\displaystyle\\hskip 22.76219pt\\ddots')
('2', '\\displaystyle P_{k}:\\hskip 25.60747pt\\text{s.t.}\\hskip 5.69054pt\\theta_{k}^{*}%\n=\\underset{\\theta_{k}}{\\mathrm{argmin}}\\;\\mathcal{C}_{k}(\\theta_{k},\\mathcal{U%\n}_{k},\\mathcal{L}_{k};\\mathcal{D}_{k})')
('2', '\\displaystyle P_{k}:')
('2', '\\displaystyle\\hskip 25.60747pt\\text{s.t.}\\hskip 5.69054pt\\theta_{k}^{*}=%\n\\underset{\\theta_{k}}{\\mathrm{argmin}}\\;\\mathcal{C}_{k}(\\theta_{k},\\mathcal{U}%\n_{k},\\mathcal{L}_{k};\\mathcal{D}_{k})')
('2', '\\rhd')
('2', 'k\\in\\{2,\\ldots,n-1\\}')
('2', '\\rhd')
('2', 'k\\in\\{2,\\ldots,n-1\\}')
('2', '\\displaystyle\\hskip 65.44133pt\\ddots')
('2', '\\displaystyle\\hskip 65.44133pt\\ddots')
('2', '\\displaystyle P_{1}:\\hskip 68.2866pt\\text{s.t.}\\hskip 5.69054pt\\theta_{1}^{*}=%\n\\underset{\\theta_{1}}{\\mathrm{argmin}}\\;\\mathcal{C}_{1}(\\theta_{1},\\mathcal{U}%\n_{1},\\mathcal{L}_{1};\\mathcal{D}_{1})')
('2', '\\displaystyle P_{1}:')
('2', '\\displaystyle\\hskip 68.2866pt\\text{s.t.}\\hskip 5.69054pt\\theta_{1}^{*}=%\n\\underset{\\theta_{1}}{\\mathrm{argmin}}\\;\\mathcal{C}_{1}(\\theta_{1},\\mathcal{U}%\n_{1},\\mathcal{L}_{1};\\mathcal{D}_{1})')
('2', '\\rhd')
('2', '1')
('2', '\\rhd')
('2', '1')
('2', 'P_{k}')
('2', 'k')
('2', '\\theta_{k}\\,/\\,\\theta_{k}^{*}')
('2', '\\mathcal{U}_{k}\\,/\\,\\mathcal{L}_{k}')
('2', '\\mathcal{D}_{k}')
('2', '\\mathcal{C}_{k}')
('2', '\\mathcal{U}_{k}\\subseteq\\{\\theta_{k+1},\\cdots,\\theta_{n}\\}')
('2', '\\mathcal{L}_{k}\\subseteq\\{\\theta_{1}^{*},\\cdots,\\theta_{k-1}^{*}\\}')
('2', '\\{P_{1},P_{2},\\cdots,P_{n}\\}')
('2', 'P_{n}')
('2', 'P_{1}')
('2', '\\theta_{2}')
('2', '\\theta_{1}')
('2', '\\mathcal{C}_{1}')
('2', '\\mathcal{C}_{2}')
('2', '\\theta_{1}^{*}')
('2', '\\theta_{2}')
('2', '\\mathcal{U}_{1}=\\{\\theta_{2}\\}')
('2', '\\mathcal{L}_{2}=\\{\\theta_{1}^{*}\\}')
('2', '\\mathcal{C}_{k}(\\theta_{k},\\mathcal{U}_{k},\\mathcal{L}_{k})')
('2', '\\theta_{k}')
('2', '\\theta_{k}^{*}')
('2', 'P_{k}')
('2', '\\theta_{l}^{*}\\in\\mathcal{L}_{k}')
('2', '\\theta_{k}')
('2', '\\frac{d\\mathcal{C}_{k}}{d\\theta_{k}}')
('2', '\\displaystyle\\frac{d\\mathcal{C}_{k}}{d\\theta_{k}}={\\color[rgb]{.5,0,.5}%\n\\underbrace{\\frac{\\partial\\mathcal{C}_{k}}{\\partial\\theta_{k}}}_{\\text{direct %\ngradient}}}+\\sum_{\\theta_{l}^{*}\\in\\mathcal{L}_{k}}{\\color[rgb]{1.0,0.35,0.21}%\n\\underbrace{\\frac{d\\theta_{l}^{*}}{d\\theta_{k}}}_{\\text{best-response Jacobian%\n}}}\\times{\\color[rgb]{.5,0,.5}\\underbrace{\\frac{\\partial\\mathcal{C}_{k}}{%\n\\partial\\theta_{l}^{*}}}_{\\text{direct gradient}}}')
('2', '\\displaystyle\\frac{d\\mathcal{C}_{k}}{d\\theta_{k}}={\\color[rgb]{.5,0,.5}%\n\\underbrace{\\frac{\\partial\\mathcal{C}_{k}}{\\partial\\theta_{k}}}_{\\text{direct %\ngradient}}}+\\sum_{\\theta_{l}^{*}\\in\\mathcal{L}_{k}}{\\color[rgb]{1.0,0.35,0.21}%\n\\underbrace{\\frac{d\\theta_{l}^{*}}{d\\theta_{k}}}_{\\text{best-response Jacobian%\n}}}\\times{\\color[rgb]{.5,0,.5}\\underbrace{\\frac{\\partial\\mathcal{C}_{k}}{%\n\\partial\\theta_{l}^{*}}}_{\\text{direct gradient}}}')
('2', 'k')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{l}^{*}')
('3.1', '\\theta_{p_{4}}')
('3.1', '\\theta_{p_{3}}^{*}')
('3.1', '\\theta_{p_{4}}\\rightarrow\\theta_{p_{3}}^{*}')
('3.1', '\\theta_{p_{4}}\\rightarrow\\theta_{p_{1}}^{*}\\rightarrow\\theta_{p_{3}}^{*}')
('3.1', '\\frac{d\\theta_{l}^{*}}{d\\theta_{k}}')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{l}^{*}')
('3.1', '\\displaystyle\\frac{d\\mathcal{C}_{k}}{d\\theta_{k}}=\\frac{\\partial\\mathcal{C}_{k%\n}}{\\partial\\theta_{k}}+\\sum_{\\theta_{l}^{*}\\in\\mathcal{L}_{k}}\\sum_{q\\in%\n\\mathcal{Q}_{k,l}}\\Bigg{(}{\\color[rgb]{1,0,0}\\underbrace{\\frac{\\partial\\theta_%\n{q(1)}^{*}}{\\partial\\theta_{k}}}_{\\text{upper-to-lower}}}\\times\\Bigg{(}\\prod_{%\ni=1}^{\\text{len}(q)-1}{\\color[rgb]{0.0,0.5,0.0}\\underbrace{\\frac{\\partial%\n\\theta_{q(i+1)}^{*}}{\\partial\\theta_{q(i)}^{*}}}_{\\text{lower-to-upper}}}\\Bigg%\n{)}\\times\\frac{\\partial\\mathcal{C}_{k}}{\\partial\\theta_{l}^{*}}\\Bigg{)}')
('3.1', '\\displaystyle\\frac{d\\mathcal{C}_{k}}{d\\theta_{k}}=\\frac{\\partial\\mathcal{C}_{k%\n}}{\\partial\\theta_{k}}+\\sum_{\\theta_{l}^{*}\\in\\mathcal{L}_{k}}\\sum_{q\\in%\n\\mathcal{Q}_{k,l}}\\Bigg{(}{\\color[rgb]{1,0,0}\\underbrace{\\frac{\\partial\\theta_%\n{q(1)}^{*}}{\\partial\\theta_{k}}}_{\\text{upper-to-lower}}}\\times\\Bigg{(}\\prod_{%\ni=1}^{\\text{len}(q)-1}{\\color[rgb]{0.0,0.5,0.0}\\underbrace{\\frac{\\partial%\n\\theta_{q(i+1)}^{*}}{\\partial\\theta_{q(i)}^{*}}}_{\\text{lower-to-upper}}}\\Bigg%\n{)}\\times\\frac{\\partial\\mathcal{C}_{k}}{\\partial\\theta_{l}^{*}}\\Bigg{)}')
('3.1', '\\mathcal{Q}_{k,l}')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{l}^{*}')
('3.1', 'q(i)')
('3.1', 'i')
('3.1', 'q')
('3.1', '\\theta_{l}^{*}')
('3.1', '\\theta_{P_{i}}^{*}\\rightarrow\\theta_{P_{j}}^{*}')
('3.1', 'P_{i}<P_{j}')
('3.1', '\\theta_{P_{i}}\\rightarrow\\theta_{P_{j}}^{*}')
('3.1', '{P_{i}}>{P_{j}}')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{l}^{*}')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{l}^{*}')
('3.2', 'P_{k}')
('3.2', 'k=1,\\cdots,n')
('3.2', '\\mathcal{O}(d^{3})')
('3.2', 'd')
('3.2', '\\mathcal{O}(d^{2})')
('3.2', 'q')
('3.2', '\\displaystyle\\text{Calculate}\\frac{\\partial w^{*}(\\lambda)}{\\partial\\lambda}\\times\nv')
('3.2', '\\displaystyle\\frac{\\partial w^{*}(\\lambda)}{\\partial\\lambda}\\times v')
('3.2', '\\displaystyle\\text{Given}w^{*}(\\lambda)=\\underset{w}{\\mathrm{argmin}}\\;%\n\\mathcal{C}(w,\\lambda).')
('3.2', '\\displaystyle w^{*}(\\lambda)=\\underset{w}{\\mathrm{argmin}}\\;\\mathcal{C}(w,%\n\\lambda).')
('3.2', 'w^{*}(\\lambda)')
('3.2', 'w^{*}(\\lambda)')
('3.2', 'w^{*}(\\lambda)')
('3.2', 'w^{*}(\\lambda)')
('3.2', '\\frac{dw^{*}(\\lambda)}{d\\lambda}')
('3.2', 'v')
('3.3', 'P_{i}')
('3.3', 'P_{j}')
('3.3', '\\theta_{i}^{*}\\rightarrow\\theta_{j}^{*}')
('3.3', 'P_{i}')
('3.3', 'P_{j}')
('3.3', 'P_{j}')
('3.3', '\\mathcal{L}_{j}')
('4', 'P_{k}')
('4', '\\theta_{k}')
('4', '\\mathcal{U}_{k}')
('4', '\\mathcal{L}_{k}')
('4', '\\mathcal{D}_{k}')
('4', '\\mathcal{C}_{k}')
('4', '\\mathcal{C}_{k}')
('4', '\\mathcal{U}_{k}')
('4', '\\mathcal{L}_{k}')
('5.1', '\\displaystyle\\theta^{*}=\\underset{\\theta}{\\mathrm{argmin}}\\;\\mathcal{L}_{val}(%\nw^{*}(\\theta))')
('5.1', '\\displaystyle\\theta^{*}')
('5.1', '\\displaystyle=\\underset{\\theta}{\\mathrm{argmin}}\\;\\mathcal{L}_{val}(w^{*}(%\n\\theta))')
('5.1', '\\displaystyle\\rhd\\,\\text{Reweighting}')
('5.1', '\\displaystyle\\rhd\\,\\text{Reweighting}')
('5.1', '\\displaystyle\\text{s.t. }w^{*}(\\theta)=\\underset{w}{\\mathrm{argmin}}\\;\\frac{1}%\n{N}\\sum_{i=1}^{n}\\mathcal{R}(L^{i}_{train};\\theta)\\cdot L^{i}_{train}(f(x_{i};%\nw),y_{i})')
('5.1', '\\displaystyle\\text{s.t. }w^{*}(\\theta)')
('5.1', '\\displaystyle=\\underset{w}{\\mathrm{argmin}}\\;\\frac{1}{N}\\sum_{i=1}^{n}\\mathcal%\n{R}(L^{i}_{train};\\theta)\\cdot L^{i}_{train}(f(x_{i};w),y_{i})')
('5.1', '\\displaystyle\\rhd\\,\\text{Classification}')
('5.1', '\\displaystyle\\rhd\\,\\text{Classification}')
('5.1', 'w')
('5.1', 'L_{train}^{i}')
('5.1', 'i')
('5.1', '\\theta')
('5.1', '\\mathcal{R}')
('5.1', 'L^{i}_{train}')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.2', '\\displaystyle\\theta^{*}=\\underset{\\theta}{\\mathrm{argmin}}\\;\\mathcal{L}_{val}(%\nw^{*}(\\theta,\\alpha)),\\hskip 14.22636pt\\alpha^{*}=\\underset{\\alpha}{\\mathrm{%\nargmin}}\\;\\mathcal{L}_{val}^{\\prime}(w^{*}(\\theta,\\alpha))')
('5.2', '\\displaystyle\\theta^{*}=\\underset{\\theta}{\\mathrm{argmin}}\\;\\mathcal{L}_{val}(%\nw^{*}(\\theta,\\alpha)),\\hskip 14.22636pt\\alpha^{*}=\\underset{\\alpha}{\\mathrm{%\nargmin}}\\;\\mathcal{L}_{val}^{\\prime}(w^{*}(\\theta,\\alpha))')
('5.2', '\\displaystyle\\rhd\\,\\text{RWT \\& CRT}')
('5.2', '\\displaystyle\\rhd\\,\\text{RWT \\& CRT}')
('5.2', '\\displaystyle\\text{s.t. }w^{*}(\\theta,\\alpha)=\\underset{w}{\\mathrm{argmin}}\\;%\n\\frac{1}{N}\\sum_{i=1}^{n}\\mathcal{R}(L^{i}_{train};\\theta)\\cdot L^{i}_{train}(%\nf(x_{i};w),g(x_{i},y_{i};\\alpha))')
('5.2', '\\displaystyle w^{*}(\\theta,\\alpha)=\\underset{w}{\\mathrm{argmin}}\\;\\frac{1}{N}%\n\\sum_{i=1}^{n}\\mathcal{R}(L^{i}_{train};\\theta)\\cdot L^{i}_{train}(f(x_{i};w),%\ng(x_{i},y_{i};\\alpha))')
('5.2', '\\displaystyle\\rhd\\,\\text{Classification}')
('5.2', '\\displaystyle\\rhd\\,\\text{Classification}')
('5.2', '\\alpha')
('5.2', 'g')
('5.2', '\\mathcal{L}_{val}^{\\prime}')
('5.2', 'f')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.3', '\\displaystyle\\theta^{*}=\\underset{\\theta}{\\mathrm{argmin}}\\;\\mathcal{L}_{FT}(v%\n^{*}(w^{*}(\\theta)))')
('5.3', '\\displaystyle\\theta^{*}')
('5.3', '\\displaystyle=\\underset{\\theta}{\\mathrm{argmin}}\\;\\mathcal{L}_{FT}(v^{*}(w^{*}%\n(\\theta)))')
('5.3', '\\displaystyle\\rhd\\,\\text{Reweighting}')
('5.3', '\\displaystyle\\rhd\\,\\text{Reweighting}')
('5.3', '\\displaystyle\\text{s.t. }v^{*}(w^{*}(\\theta))=\\underset{v}{\\mathrm{argmin}}\\;%\n\\Big{(}\\mathcal{L}_{FT}(v)+\\lambda\\|v-w^{*}(\\theta)\\|^{2}_{2}\\Big{)}')
('5.3', '\\displaystyle\\text{s.t. }v^{*}(w^{*}(\\theta))')
('5.3', '\\displaystyle=\\underset{v}{\\mathrm{argmin}}\\;\\Big{(}\\mathcal{L}_{FT}(v)+%\n\\lambda\\|v-w^{*}(\\theta)\\|^{2}_{2}\\Big{)}')
('5.3', '\\displaystyle\\rhd\\,\\text{Finetuning}')
('5.3', '\\displaystyle\\rhd\\,\\text{Finetuning}')
('5.3', '\\displaystyle w^{*}(\\theta)=\\underset{w}{\\mathrm{argmin}}\\;\\frac{1}{N}\\sum_{i=%\n1}^{n}\\mathcal{R}(x_{i};\\theta)\\cdot L^{i}_{PT}(w)')
('5.3', '\\displaystyle w^{*}(\\theta)')
('5.3', '\\displaystyle=\\underset{w}{\\mathrm{argmin}}\\;\\frac{1}{N}\\sum_{i=1}^{n}\\mathcal%\n{R}(x_{i};\\theta)\\cdot L^{i}_{PT}(w)')
('5.3', '\\displaystyle\\rhd\\,\\text{Pretraining}')
('5.3', '\\displaystyle\\rhd\\,\\text{Pretraining}')
('5.3', 'x_{i}')
('5.3', 'L_{PT}^{i}')
('5.3', 'i')
('5.3', '\\mathcal{R}')
('5.3', 'x_{i}')
('5.3', '\\lambda')
('5.3', 'w')
('5.3', 'v')
('5.3', '\\theta')
('5.3', '\\rightarrow')
('5.3', '\\rightarrow')
('5.3', '\\rightarrow')
('5.3', '\\rightarrow')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('A1.1', '\\displaystyle\\alpha^{*}=\\underset{\\alpha}{\\mathrm{argmin}}\\;\\mathcal{L}_{val}(%\nw^{*}(\\alpha),\\alpha)')
('A1.1', '\\displaystyle\\alpha^{*}')
('A1.1', '\\displaystyle=\\underset{\\alpha}{\\mathrm{argmin}}\\;\\mathcal{L}_{val}(w^{*}(%\n\\alpha),\\alpha)')
('A1.1', '\\displaystyle\\rhd\\,\\text{Architecture Search}')
('A1.1', '\\displaystyle\\rhd\\,\\text{Architecture Search}')
('A1.1', '\\displaystyle\\text{s.t. }w^{*}(\\alpha)=\\underset{w}{\\mathrm{argmin}}\\;\\mathcal%\n{L}_{train}(w;\\alpha)')
('A1.1', '\\displaystyle\\text{s.t. }w^{*}(\\alpha)')
('A1.1', '\\displaystyle=\\underset{w}{\\mathrm{argmin}}\\;\\mathcal{L}_{train}(w;\\alpha)')
('A1.1', '\\displaystyle\\rhd\\,\\text{Classification}')
('A1.1', '\\displaystyle\\rhd\\,\\text{Classification}')
('A1.1', '\\alpha')
('A1.1', 'w')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A1.2', '\\pm')
('A4.1', '\\displaystyle\\lambda^{*}=\\arg\\min_{\\lambda}\\;\\text{sigmoid}(y_{u}x_{u}^{T}w^{*})')
('A4.1', '\\displaystyle\\lambda^{*}')
('A4.1', '\\displaystyle=\\arg\\min_{\\lambda}\\;\\text{sigmoid}(y_{u}x_{u}^{T}w^{*})')
('A4.1', '\\displaystyle w^{*}=\\arg\\min_{w}\\;\\text{sigmoid}(y_{l}x_{l}^{T}w^{*})+\\frac{1}%\n{2}w^{T}diag(\\lambda)w')
('A4.1', '\\displaystyle w^{*}')
('A4.1', '\\displaystyle=\\arg\\min_{w}\\;\\text{sigmoid}(y_{l}x_{l}^{T}w^{*})+\\frac{1}{2}w^{%\nT}diag(\\lambda)w')
('A4.1', '(x_{l},y_{l})')
('A4.1', '(x_{u},y_{u})')
('A4.1', 'x\\in\\mathbb{R}^{n\\times d}')
('A4.1', 'y\\in\\mathbb{R}^{n\\times 1}')
('A4.1', 'n')
('A4.1', 'd')
('A4.1', 'w\\in\\mathbb{R}^{d\\times 1}')
('A4.1', '\\lambda\\in\\mathbb{R}^{d\\times 1}')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
('A5.2', '\\cdot')
