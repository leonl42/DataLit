('3.0', 't')
('3.0', 's_t \\in \\mathcal{R}^{n_s}')
('3.0', 'a_t \\in \\mathcal{R}^{n_a}')
('3.0', 'r_t \\in \\mathcal{R}^1')
('3.0', '\\pi(a_t | s_t)')
('3.0', '\\tau_{0:T} = \\{s_0, a_0, r_0, s_1, a_1, r_1, \\cdots, s_T, a_T, r_T\\}')
('3.0', 'T')
('3.0', '\\pi')
('3.0', '\\max_{\\pi} \\mathbb{E}_{\\tau \\sim \\pi}(R)')
('3.0', 'R := \\sum_{t=0}^{T} \\gamma^t r_t \\label{eq:return}')
('3.0', '\\gamma \\in [0, 1)')
('3.0', 's \\in \\mathcal{R}^{n_s}')
('3.0', 'a \\in \\mathcal{R}^{n_a}')
('3.0', 'o^{pro}, \\mathcal{M}_s^{pro} \\in \\mathbb{R}^{K \\times n}, o^{ext} \\in \\mathbb{R}^x')
('3.0', 's = [o^{pro}, o^{ext}]')
('3.0', 'a, \\mathcal{M}_a \\in \\mathbb{R}^{K \\times m}')
('3.0', 'n_s = K*n - \\sum \\mathcal{M}_s + x')
('3.0', 'n_a = K*m - \\sum \\mathcal{M}_a')
('3.1', 'V(s)')
('3.1', '\\label{eq:loss_critic}\n%\\small\nL^{\\text{Critic}} = \\mathbb{E}_{s \\sim d^{\\pi}}[r_t + \\gamma (V_{\\theta_{\\text{old}}}(s_{t+1}) - V_{\\theta}(s_{t}))^2] \n\\notag')
('3.1', 'A_t')
('3.1', '\\begin{aligned}\n    \\hat{A}_t &= \\delta_t + (\\gamma \\lambda) \\delta_{t+1} + \\cdots + (\\gamma \\lambda)^{T-t+1} \\delta_{T-1} \\notag \\\\\n    \\delta_t &= r_t + \\gamma V(s_{t+1}) - V(s_t) \\label{eq:gae}\n\\end{aligned}')
('3.1', 'A_t')
('3.1', '%\\label{eq:loss_actor}\n    L^{\\text{Actor}} = \\text{CLIP}(\\text{E}_t \\frac{\\pi_{\\theta_{\\text{old}}}(a_t | s_t)}{\\pi_{\\theta}(a_t | s_t)} \\hat{A_t} - \\beta \\text{KL} [\\pi_{\\theta_{\\text{old}}}(\\cdot | s_t), \\pi_{\\theta}(\\cdot | s_t)]) \\notag')
('3.1', '\\text{CLIP}')
('3.1', '[1 - \\epsilon, 1 + \\epsilon] \\hat{A_t}')
('3.1', '\\text{KL}')
('3.1', '\\label{eq:loss_ppo}\nL^{\\text{PPO}} = -\\eta_A L^{\\text{Actor}} + \\eta_C L^{\\text{Critic}}')
('3.2', 'K')
('3.2', 'o^{pro} \\in \\mathbb{R}^{K \\times n}')
('3.2', 'n')
('3.2', 'x')
('3.2', 'o^{ext} \\in \\mathbb{R}^x')
('3.2', 's := [o^{pro}, o^{ext}]')
('3.2', 'm')
('3.2', 'a \\in \\mathbb{R}^{K \\times m}')
('3.2', 'o^{pro}')
('3.2', 'a')
('3.3', 'x \\in \\mathbb{R}^{T \\times e}')
('3.3', 'T')
('3.3', 'e')
('3.3', '\\label{eq:time_encode}\n\\text{Enc}_T(x) = \\text{Attention}(\\text{Q=}x, \\text{K=}x, \\text{V=}x) \\in \\mathbb{R}^{T \\times e}')
('3.3', 'p \\in \\mathbb{R}^{K \\times e}')
('3.3', 'K')
('3.3', '\\label{eq:morph_encode}\n\\text{Enc}_M(p) = \\text{Attention}(\\text{Q=}p, \\text{K=}p, \\text{V=}p) \\in \\mathbb{R}^{K \\times e}')
('3.3', 'o^{pro}')
('3.3', 'a')
('3.3', 'p')
('3.3', 'e')
('3.3', '\\text{Enc}_M')
('4.0', 'e')
('4.0', 't')
('4.0', '\\begin{aligned}\n    o_t^e &= \\text{Embed}_o(o^{pro}_t) \\in \\mathbb{R}^{K, e} \\notag \\\\\n    x_t^e &= \\text{Embed}_x(o^{ext}_t) \\in \\mathbb{R}^{e} \\notag \\\\\n    a_t^e &= \\text{Embed}_a(a_t) \\in \\mathbb{R}^{K, e}\n    %s_t^e &= \\text{MLP}_s([o_t^e, o^{ext}]) \\in \\mathbb{R}^{K, e} \\\\\n\\end{aligned}')
('4.0', '\\begin{aligned}\n    o_t^p &= \\text{Enc}_M(o_t^e) \\notag \\\\\n    s_t^p &= \\text{MLP}_s([s_t^p, x_t^e]) \\in \\mathbb{R}^{e} \\notag \\\\\n    a_t^p &= \\text{Enc}_M(a_t^e)\n\\end{aligned}')
('4.0', '\\text{Prompt} = \\text{Embed}(K, n, m, x)')
('4.0', '\\begin{aligned}\n    \\text{output} =& \\text{Enc}_T(\\text{Prompt}, \\text{input}) \\\\\n    \\text{input} :=& \\{\\text{BOS}, s_0^p, \\quad a_0^p, s_1^p, \\quad \\cdots, \\cdots, \\quad a_{t-1}^p, s_t^p  \\} \\\\\n    \\text{output} :=& \\{\\hat{s}_0^p, \\hat{a}_0^p, \\quad \\hat{s}_1^p, \\hat{a}_2^p, \\quad \\cdots, \\cdots, \\quad \\hat{s}_t^p, \\hat{a}_t^p \\}\n\\end{aligned}')
('4.0', 'T_w')
('4.0', 'T_w')
('4.0', '\\begin{aligned}\n    \\hat{a}_t^p &\\leftarrow \\hat{a}_t^p + \\text{Attention}(\\text{Q=}\\hat{a}_t^p, \\text{K=}s_t^p, \\text{V=}s_t^p) \\notag \\\\\n    \\hat{s}_t^p &\\leftarrow \\hat{s}_t^p + \\text{Attention}(\\text{Q=}\\hat{s}_t^p, \\text{K=}a_{t-1}^p, \\text{V=}a_{t-1}^p) \\notag\n\\end{aligned}')
('4.0', '\\hat{a}_t = \\text{Proj}_a (\\hat{a}_t^p),\\quad \\hat{s}_t = \\text{Proj}_s (\\hat{s}_t^p), \\quad \\hat{V}_t = \\text{Proj}_V (\\hat{s}_t^p)')
('4.0', '\\text{Embed}_o, \\text{Embed}_x, \\text{Embed}_a, \\text{Embed}_s, \\text{Proj}_a, \\text{Proj}_s, \\text{Proj}_V')
('4.1', '\\begin{aligned}\n    L^{\\text{imitation}} &= \\text{MSE}(\\hat{a}_t, a_t^p), \\quad L^{\\text{prediction}} = \\text{MSE}(\\hat{s}_t, s_t^p) \\notag \\\\ \n    L^{\\text{pretrain}} &= \\eta_i L^{\\text{imitation}} + \\eta_p L^{\\text{prediction}}\n\\end{aligned}')
('4.1', '\\text{MSE}')
('4.1', 'L^{\\text{imitation}}')
('4.1', 'L^{\\text{prediction}}')
('4.1', 'L^{\\text{prediction}}(t=0)')
('4.1', '\\hat{V}_t')
('4.1', '\\hat{a}_t')
('4.1', '\\hat{V}_t \\rightarrow V(s_t), \\quad \\hat{a}_t \\rightarrow \\pi(s_t)')
('4.1', 'L^{\\text{pretrain}}')
('4.1', 'L^{\\text{finetune}} = \\eta_1 L^{\\text{PPO}} + \\eta_2 L^{\\text{pretrain}}')
('4.1', 'L^{\\text{pretrain}}')
('4.1', '\\pi')
('4.1', 'T')
('4.1', '\\hat{A}_0, \\cdots, \\hat{A}_T')
('4.1', '\\theta')
('4.1', 'L^{\\text{finetune}}')
('5.0', 'K')
('5.0', 'n')
('5.0', 'm')
('5.0', 'x')
('5.0', 'm_s')
('5.0', 'm_a')
('5.0', 'n_s')
('5.0', 'n_a')
('5.0', '\\ast')
('5.0', '\\ast')
('5.0', '\\ast')
('5.1', '^\\ast')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '^\\ast')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\pm')
('5.1', '\\ast')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '^\\ast')
('5.3', '^\\ast')
('5.3', '^\\ast')
('5.3', '^\\ast')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\pm')
('5.3', '\\ast')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.4', '\\pm')
('5.5', 'L^{\\text{prediction}}')
('5.5', 'L^{\\text{PPO}}')
('6', 'L^{\\text{PPO}}')
('8', '\\pi(a_t | s_t)')
('8', '\\tau_{0:T} = \\{s_0, a_0, r_0, s_1, a_1, r_1, \\cdots, s_T, a_T, r_T\\}')
('8', 'T')
('8', '\\pi')
('8', '\\max_{\\pi} \\mathbb{E}_{\\tau \\sim \\pi}(R)')
('8', 'R := \\sum_{t=0}^{T} \\gamma^t r_t \\label{eq:return}')
('8', '\\gamma \\in [0, 1)')
('8', 'V(s)')
('8', '\\label{eq:loss_critic}\n%\\small\nL^{\\text{Critic}} = \\mathbb{E}_{s \\sim d^{\\pi}}[(r_t + \\gamma (V_{\\theta_{\\text{old}}}(s_{t+1}) - V_{\\theta}(s_{t}))^2] \n\\notag')
('8', 'A_t')
('8', '\\begin{aligned}\n    \\hat{A}_t &= \\delta_t + (\\gamma \\lambda) \\delta_{t+1} + \\cdots + (\\gamma \\lambda)^{T-t+1} \\delta_{T-1} \\\\\n    \\delta_t &= r_t + \\gamma V(s_{t+1}) - V(s_t) \\label{eq:gae}\n\\end{aligned}')
('8', 'A_t')
('8', '\\label{eq:loss_actor}\n    L^{\\text{Actor}} = \\text{CLIP}(\\text{E}_t \\frac{\\pi_{\\theta_{\\text{old}}}(a_t | s_t)}{\\pi_{\\theta}(a_t | s_t)} \\hat{A_t} - \\beta \\text{KL} [\\pi_{\\theta_{\\text{old}}}(\\cdot | s_t), \\pi_{\\theta}(\\cdot | s_t)])')
('8', '\\text{CLIP}')
('8', '[1 - \\epsilon, 1 + \\epsilon] \\hat{A_t}')
('8', '\\text{KL}')
('8', '\\label{eq:loss_ppo}\nL^{\\text{PPO}} = -\\eta_A L^{\\text{Actor}} + \\eta_C L^{\\text{Critic}}\n\\notag')
('9', 'T_w')
('9', 'T_w')
('9', '\\begin{aligned}\n    \\hat{a}_t^p &\\leftarrow \\hat{a}_t^p + \\text{Attention}(\\text{Q=}\\hat{a}_t^p, \\text{K=}s_t^p, \\text{V=}s_t^p) \\notag \\\\\n    \\hat{s}_t^p &\\leftarrow \\hat{s}_t^p + \\text{Attention}(\\text{Q=}\\hat{s}_t^p, \\text{K=}a_{t-1}^p, \\text{V=}a_{t-1}^p)\n\\end{aligned}')
('9', '\\gamma')
('9', '\\epsilon')
('9', '\\beta')
('9', '\\lambda')
('9', 'N')
('9', 'T')
('9', 'T_w')
('9', 'e')
('9', '\\eta_A')
('9', '\\eta_C')
('9', '\\eta_p')
('9', '\\eta_i')
('9', '\\eta_1')
('9', '\\eta_2')
('9', '\\#')
('9', '\\text{layers}(\\text{Embed}_o)')
('9', '[n, e]')
('9', '\\text{layers}(\\text{Embed}_x)')
('9', '[x, e]')
('9', '\\text{layers}(\\text{Embed}_a)')
('9', '[m, e]')
('9', '\\text{layers}(\\text{Embed}_s)')
('9', '[(K+1)e, e]')
('9', '\\text{layers}(\\text{Proj}_s)')
('9', '[e, n_s]')
('9', '\\text{layers}(\\text{Proj}_a)')
('9', '[e, n_a]')
('9', '\\text{layers}(\\text{Proj}_v)')
('9', '[e, 1]')
