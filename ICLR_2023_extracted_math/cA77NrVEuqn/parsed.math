('0.0.0', '2')
('0.0.1', '\\tau')
('0.0.1', 'T')
('0.0.1', '\\tau')
('0.0.1', 'G_t := \\sum_{i=t}\\gamma^{i-t}r_i')
('0.0.1', '\\tau:=\\left(s_1, a_1, r_1, G_1, s_2, a_2, r_2, G_2, \\ldots, s_T, a_T, r_T, G_T\\right).')
('0.0.1', '\\tau')
('0.0.1', '\\label{eq:diffusion-obj}\n\\max _\\theta \\mathbb{E}_{\\tau \\sim \\mathcal{D}}\\left[\\log p_\\theta\\left(\\boldsymbol{x}_0(\\tau) \\mid \\boldsymbol{y}(\\tau)\\right)\\right].')
('0.0.1', 'p_\\theta')
('0.0.1', '\\boldsymbol{x}_0(\\tau)')
('0.0.1', '\\boldsymbol{y}(\\tau)')
('0.0.1', '\\boldsymbol{y}')
('0.0.1', 'q\\left(\\boldsymbol{x}_{k+1}(\\tau) \\mid \\boldsymbol{x}_k(\\tau)\\right), \\quad p_\\theta\\left(\\boldsymbol{x}_{k-1}(\\tau) \\mid \\boldsymbol{x}_k(\\tau), \\boldsymbol{y}(\\tau)\\right).')
('0.0.1', 'q')
('0.0.1', 'p_\\theta')
('0.0.1.0', 'p^*(\\tau \\mid s_1, \\boldsymbol{z})')
('0.0.1.0', '\\boldsymbol{z}:=(z_1,\\ldots,z_M)')
('0.0.1.0', '(s_1, \\boldsymbol{z})')
('0.0.1.0', '\\tau')
('0.0.1.0', 'p^*(\\tau \\mid s_1, \\boldsymbol{z}):=p(s_1)\\mathbbm{1}(\\tau=h(s_1, \\boldsymbol{z}))\\pi^{*}(\\boldsymbol{z} \\mid s_1)')
('0.0.1.0', '\\boldsymbol{z}')
('0.0.1.0', '\\pi^*(\\boldsymbol{z} \\mid s_1)')
('0.0.1.0', 'h(s_1, \\boldsymbol{z})')
('0.0.1.0', '\\pi^*(\\boldsymbol{z} \\mid s_1)>0')
('0.0.1.0', '\\boldsymbol{z}')
('0.0.1.0', 's_1')
('0.0.1.0', '\\mathcal{Z}')
('0.0.2.0', 'q_\\phi\\left(\\boldsymbol{z}_0 \\mid s_1, \\tau \\right)')
('0.0.2.0', 'p_\\theta\\left(\\boldsymbol{z}_0 \\mid s_1\\right)')
('0.0.2.0', 'p_{\\boldsymbol{\\psi}}\\left(\\tau \\mid s_1, \\boldsymbol{z}_0\\right)')
('0.0.2.0', '\\log p(\\tau \\mid s_1)')
('0.0.2.0', '\\boldsymbol{y}(\\tau)')
('0.0.2.0', 's_1')
('0.0.2.0', '\\label{eq:loss}\n\\begin{aligned}\n\\mathcal{L}(s_1, \\tau, \\boldsymbol{\\phi}, \\boldsymbol{\\theta}, \\boldsymbol{\\psi}) & =\\mathbb{E}_{q_{\\boldsymbol{\\phi}}\\left(\\mathbf{z}_0 \\mid s_1, \\tau\\right)}\\left[-\\log p_{\\boldsymbol{\\psi}}\\left(\\tau \\mid s_1, \\mathbf{z}_0\\right)\\right]+\\operatorname{KL}\\left(q_{\\boldsymbol{\\phi}}\\left(\\mathbf{z}_0 \\mid s_1, \\tau\\right) \\| p_{\\boldsymbol{\\theta}}\\left(\\mathbf{z}_0 \\mid s_1\\right)\\right) \\\\\n& =\\mathbb{E}_{q_{\\boldsymbol{\\phi}}\\left(\\mathbf{z}_0 \\mid s_1, \\tau\\right)}\\left[-\\log p_{\\boldsymbol{\\psi}}\\left(\\tau \\mid s_1, \\mathbf{z}_0\\right)\\right]+\\mathbb{E}_{q_\\phi\\left(\\mathbf{z}_0 \\mid s_1, \\tau\\right)}\\left[\\log q_{\\boldsymbol{\\phi}}\\left(\\mathbf{z}_0 \\mid s_1, \\tau\\right)\\right] \\\\\n& +\\mathbb{E}_{q_{\\boldsymbol{\\phi}}\\left(\\mathbf{z}_0 \\mid s_1, \\tau\\right)}\\left[-\\log p_{\\boldsymbol{\\theta}}\\left(\\mathbf{z}_0 \\mid s_1\\right)\\right]\n\\end{aligned}')
('0.0.2.0', 'q_\\phi\\left(\\mathbf{z}_0 \\mid s_0, \\tau\\right)')
('0.0.2.0', 'p\\left(\\mathbf{z}_0 \\mid s_0, \\tau\\right)')
('0.0.2.0', '\\{q_{\\boldsymbol{\\phi}},p_{\\boldsymbol{\\psi}}\\}')
('0.0.2.0', '\\{q_{\\boldsymbol{\\theta}}\\}')
('0.0.2.0', '\\mathcal{D}_{\\tau}')
('0.0.2.0.0', '\\boldsymbol{x}_t:=\\left(s_t, a_t, r_t, G_t\\right)')
('0.0.2.0.0', '\\boldsymbol{\\phi}')
('0.0.2.0.0', '\\boldsymbol{x}_t')
('0.0.2.0.0', 'T')
('0.0.2.0.0', 'T')
('0.0.2.0.0', '1')
('0.0.2.0.0', 'L')
('0.0.2.0.0', 'T / L')
('0.0.2.0.0', 'L')
('0.0.2.0.0', 'T')
('0.0.2.0.0', 's_1')
('0.0.2.0.0', '\\hat{\\tau}:=(\\hat{\\boldsymbol{x}}_1, \\hat{\\boldsymbol{x}}_2, \\ldots, \\hat{\\boldsymbol{x}}_T)')
('0.0.2.0.0', '\\hat{\\boldsymbol{x}}_t:=(\\hat{\\boldsymbol{s}}_t, \\hat{\\boldsymbol{a}}_t, \\hat{r}_t, \\hat{G}_t)')
('0.0.2.0.0', '\\boldsymbol{x}_t')
('0.0.2.0.0', '\\{\\tau\\}')
('0.0.2.0.0', '\\{\\hat{\\tau}\\}')
('0.0.2.0.0', '\\approx 10^{-6}')
('0.0.2.0.0.0', '\\{q_{\\boldsymbol{\\phi}},p_{\\boldsymbol{\\psi}}\\}')
('0.0.2.0.0.0', '\\boldsymbol{x}_k(\\boldsymbol{z})')
('0.0.2.0.0.0', '\\boldsymbol{y}(\\boldsymbol{z}):=s_1')
('0.0.2.1.0', '\\tau')
('0.0.2.1.0', '\\boldsymbol{z}')
('0.0.2.1.0', 'q_{\\boldsymbol{\\phi}}')
('0.0.2.1.0', 's_1')
('0.0.2.1.0', '\\pi^{*}(\\boldsymbol{z} \\mid s_1) \\propto \\mu(\\boldsymbol{z} \\mid s_1) e^{\\beta\\sum_{t=1}^{T}Q_{\\zeta}(s_t,a_t)},')
('0.0.2.1.0', '\\mu(\\boldsymbol{z} \\mid s_1)')
('0.0.2.1.0', 'Q_{\\zeta}(\\cdot,\\cdot)')
('0.0.2.1.0', 'Q')
('0.0.2.1.0', '\\beta \\geq 0')
('0.0.2.1.0', 'p_0 := \\pi^*')
('0.0.2.1.0', 'q_0 = \\mu')
('0.0.2.1.0', '\\boldsymbol{z}_0 = \\boldsymbol{z}')
('0.0.2.1.0', 'p_0(\\boldsymbol{z}_0 \\mid s_1) \\propto q_0(\\boldsymbol{z}_0 \\mid s_1) \\exp\\left(-\\beta \\mathcal{E}(h(\\boldsymbol{z}_0, s_1))\\right),')
('0.0.2.1.0', '\\mathcal{E}(h(\\boldsymbol{z}_0, s_1)) := -\\sum_{t=1}^{T}Q_{\\zeta}(s_{t},a_{t})')
('0.0.2.1.0', 'h(\\boldsymbol{z}_0, s_1)')
('0.0.2.1.0', 'p_{\\boldsymbol{\\psi}}')
('0.0.2.1.0', 'q_0(\\boldsymbol{z}_0 \\mid s_1)')
('0.0.2.1.0', '\\boldsymbol{z}_0')
('0.0.2.1.0', 'q_0 := q')
('0.0.2.1.0', 'p_0 = p')
('0.0.2.1.0', 'k=0')
('0.0.2.1.0', 'q_0')
('0.0.2.1.0', 'p_0')
('0.0.2.1.0', 'p_{k0}(\\boldsymbol{z}_k|\\boldsymbol{z}_0,s_1):=q_{k0}(\\boldsymbol{z}_k|\\boldsymbol{z}_0,s_1)=\\mathcal{N}(\\boldsymbol{z}_k|\\alpha_k\\boldsymbol{z}_0, \\sigma_t^2 \\mathbf{I})')
('0.0.2.1.0', 'q_k')
('0.0.2.1.0', 'p_k')
('0.0.2.1.0', '\\boldsymbol{z}_k')
('0.0.2.1.0', 'k')
('0.0.2.1.0', '\\label{eq:intermediate-guidance-latent}\n    p_k(\\boldsymbol{z}_k \\mid s_1) \\propto q_k(\\boldsymbol{z}_k \\mid s_1)\\exp\\left(\\mathcal{E}_k(h(\\boldsymbol{z}_k, s_1))\\right),')
('0.0.2.1.0', '\\mathcal{E}_k(h(\\boldsymbol{z}_k, s_1))')
('0.0.2.1.0', '\\beta\\mathcal{E}(h(\\boldsymbol{z}_0, s_1))')
('0.0.2.1.0', 'k=0')
('0.0.2.1.0', '-\\log\\mathbb{E}_{q_{0k(\\boldsymbol{z}_0|\\boldsymbol{z}_k)}}[\\exp(-\\beta\\mathcal{E}(h(\\boldsymbol{z}_0, s_1)))]')
('0.0.2.1.0', 'k>0')
('0.0.2.1.0', 'p_{k}(\\boldsymbol{z}_k \\mid s_1)')
('0.0.2.1.0', '\\nabla_{\\boldsymbol{z}_k} \\log p_k\\left(\\boldsymbol{z}_k \\mid s_1\\right)=\\nabla_{\\boldsymbol{z}_k} \\log q_k\\left(\\boldsymbol{z}_k \\mid s_1\\right)+\\nabla_{\\boldsymbol{z}_k} \\mathcal{E}_k\\left(h(\\boldsymbol{z}_k, s_1)\\right).')
('0.0.2.1.0', '\\nabla_{\\boldsymbol{z}_k}\\mathcal{E}(h(\\boldsymbol{z}_k, s_1))')
('0.0.2.1.0.0', '\\nabla_{\\boldsymbol{z}_k}\\log p_k(\\boldsymbol{z}_k \\mid s_1)')
('0.0.2.1.0.0', '\\nabla_{\\boldsymbol{z}_k}\\mathcal{E}(h(\\boldsymbol{z}_k, s_1))')
('0.0.2.1.0.0', 'q_0(\\boldsymbol{z}_0 \\mid s_1)')
('0.0.2.1.0.0', 'Q_{\\zeta}(s,a)')
('0.0.2.1.0.0', '\\mathcal{E}(h(\\boldsymbol{z}_0, s_1))')
('0.0.2.1.0.0', 'f_{\\eta}(\\boldsymbol{z}_k,s_1,k)')
('0.0.2.1.0.0', '\\mathcal{E}_k(h(\\boldsymbol{z}_k,s_1))')
('0.0.2.1.0.0', 'p_{\\theta}(\\boldsymbol{z}_0 \\mid s_1)')
('0.0.2.1.0.0', 'Q_{\\zeta}(s,a)')
('0.0.2.1.0.0', 'f_{\\eta}(\\boldsymbol{z}_k,s_1,k)')
('0.0.2.1.0.0', '\\label{eq:cep-latent}\n    \\begin{aligned}\n        \\min_\\eta \\mathbb{E}_{p(k,s1)} \\mathbb{E}_{\\prod_{i=1}^M q\\left(\\boldsymbol{z}_0^{(i)} \\mid s_1\\right) p\\left(\\epsilon^{(i)}\\right)}\\left[\n        -\\sum_{i=1}^M \\frac{e^{-\\beta\\mathcal{E}_0(h(\\boldsymbol{z}_0^{(i)},s_1))}}{\\sum_{j=1}^M e^{-\\beta\\mathcal{E}_0(h(\\boldsymbol{z}_0^{(j)},s_1))}} \\log \\frac{e^{f_\\eta\\left(\\boldsymbol{z}_k^{(i)},s_1,k\\right)}}{\\sum_{j=1}^M e^{f_\\eta\\left(\\boldsymbol{z}_k^{(j)},s_1,k\\right)}}\\right],\n    \\end{aligned}')
('0.0.2.1.0.0', 'k \\sim \\mathcal{U}(0,K)')
('0.0.2.1.0.0', '\\boldsymbol{z}_k = \\alpha_k \\boldsymbol{z}_0 + \\sigma_k\\epsilon')
('0.0.2.1.0.0', '\\epsilon \\sim \\mathcal{N}(0, \\mathbb{I})')
('0.0.2.1.0.0', 'q(\\boldsymbol{z}_0 \\mid s_1)')
('0.0.2.1.0.0', 'q_{\\boldsymbol{\\phi}}')
('0.0.2.1.0.0', 'p_{\\theta}')
('0.0.2.1.0.0', 'M')
('0.0.2.1.0.0', '\\{\\hat{\\boldsymbol{z}_0}^{(i)}\\}_M')
('0.0.2.1.0.0', 's_1')
('0.0.2.1.0.0', '\\label{eq:cep-latent-final}\n    \\min_\\eta \\mathbb{E}_{k, s_1, \\epsilon}-\\sum_{i=1}^M \\frac{e^{-\\beta\\mathcal{E}_0(h(\\hat{\\boldsymbol{z}}_0^{(i)},s_1))}}{\\sum_{j=1}^M e^{-\\beta\\mathcal{E}_0(h(\\hat{\\boldsymbol{z}}_0^{(j)},s_1))}} \\log \\frac{e^{f_\\eta\\left(\\hat{\\boldsymbol{z}}_k^{(i)},s_1,k\\right)}}{\\sum_{j=1}^M e^{f_\\eta\\left(\\hat{\\boldsymbol{z}}_k^{(j)},s_1,k\\right)}},')
('0.0.2.1.0.0', '\\hat{\\boldsymbol{z}_0}^{(i)},\\hat{\\boldsymbol{z}_0}^{(j)}')
('0.0.2.1.0.0', 's_1')
('0.0.2.2', '\\{q_{\\boldsymbol{\\phi}},p_{\\boldsymbol{\\psi}}\\}')
('0.0.2.2', 'p_{\\theta}')
('0.0.2.2', 'f_{\\eta}')
('0.0.2.2', '\\mathcal{D}')
('0.0.2.2', 's_1 \\in \\mathcal{D}')
('0.0.2.2', 'q_{\\boldsymbol{\\phi}}')
('0.0.2.2', 'p_{\\theta}')
('0.0.2.2', 'p_{\\boldsymbol{\\psi}}')
('0.0.2.2', 'f_{\\eta}')
('0.0.2.2', 'B_1')
('0.0.2.2', '\\tau')
('0.0.2.2', '\\mathcal{D}')
('0.0.2.2', '\\hat{\\tau}')
('0.0.2.2', 'q_{\\boldsymbol{\\phi}}')
('0.0.2.2', 'p_{\\boldsymbol{\\psi}}')
('0.0.2.2', '\\{\\boldsymbol{\\phi},\\boldsymbol{\\psi}\\}')
('0.0.2.2', 'B_2')
('0.0.2.2', '\\tau')
('0.0.2.2', '\\mathcal{D}')
('0.0.2.2', 'B_2')
('0.0.2.2', '\\epsilon')
('0.0.2.2', '\\mathcal{N}(0,\\mathbf{I})')
('0.0.2.2', 'B_2')
('0.0.2.2', 'k')
('0.0.2.2', '\\mathcal{U}(0, K)')
('0.0.2.2', '\\boldsymbol{z}_0')
('0.0.2.2', 'q_{\\boldsymbol{\\phi}}')
('0.0.2.2', 'p_{\\boldsymbol{\\psi}}')
('0.0.2.2', '\\boldsymbol{z}_0')
('0.0.2.2', '\\boldsymbol{z}_k := \\alpha_k \\boldsymbol{z}_0 + \\sigma_k \\epsilon')
('0.0.2.2', '\\{\\theta\\}')
('0.0.2.2', 'M')
('0.0.2.2', '\\{\\hat{\\boldsymbol{z}_0}^{(i)}\\}_M')
('0.0.2.2', 'p_{\\theta}')
('0.0.2.2', 'B_3')
('0.0.2.2', 's_1')
('0.0.2.2', '\\mathcal{D}')
('0.0.2.2', 'B_3')
('0.0.2.2', '\\epsilon')
('0.0.2.2', '\\mathcal{N}(0,\\mathbf{I})')
('0.0.2.2', 'B_3')
('0.0.2.2', 'k')
('0.0.2.2', '\\mathcal{U}(0, K)')
('0.0.2.2', '\\{\\hat{\\boldsymbol{z}_0}^{(i)}\\}_M')
('0.0.2.2', 's_1')
('0.0.2.2', '\\hat{\\boldsymbol{z}_0}^{(i)}')
('0.0.2.2', '\\hat{\\boldsymbol{z}_k}^{(i)}:=\\alpha_k \\hat{\\boldsymbol{z}_0}^{(i)} + \\sigma_k \\epsilon')
('0.0.2.2', '\\{\\eta\\}')
('0.0.2.2', 'k')
('0.0.2.2', '\\nabla_{\\boldsymbol{z}_k} \\log p_k\\left(\\boldsymbol{z}_k \\mid s_1\\right)')
('0.0.2.2', '\\nabla_{\\boldsymbol{z}_k} \\log q_k\\left(\\boldsymbol{z}_k \\mid s_1\\right)')
('0.0.2.2', '\\nabla_{\\boldsymbol{z}_k} \\mathcal{E}_k\\left(h(\\boldsymbol{z}_k, s_1)\\right)')
('0.0.2.2', 'p_{\\boldsymbol{\\psi}}\\left(\\tau \\mid s_1, \\boldsymbol{z}_0\\right)')
('0.0.2.2', '\\boldsymbol{z}_0')
('0.0.2.2', 'p\\left(s_1,\\boldsymbol{z}_0,\\tau\\right)=p_{0}\\left(\\boldsymbol{z}_0 \\mid s_1\\right) p_{\\boldsymbol{\\psi}}\\left(\\tau \\mid s_1,\\boldsymbol{z}_0\\right)')
('0.0.3', '5\\%')
('0.0.3.1.0', '50')
('0.0.3.1.0', '1')
('1.0.0', 'L')
('1.0.0', 'H')
('1.0.1.0', '\\mathcal{M} = (\\mathcal{S}, \\mathcal{A}, \\mathcal{P}, r, \\gamma)')
('1.0.1.0', '\\mathcal{S}')
('1.0.1.0', '\\mathcal{A}')
('1.0.1.0', 's, s^{\\prime} \\in \\mathcal{S}')
('1.0.1.0', 'a \\in \\mathcal{A}')
('1.0.1.0', '\\mathcal{P}\\left(s^{\\prime} \\mid s, a\\right): \\mathcal{S} \\times \\mathcal{A} \\times \\mathcal{S} \\rightarrow[0, 1]')
('1.0.1.0', 'r(s, a, s^{\\prime}): \\mathcal{S} \\times \\mathcal{A} \\times \\mathcal{S} \\rightarrow \\mathbb{R}')
('1.0.1.0', '\\gamma \\in (0, 1]')
('1.0.1.0', '\\pi: \\mathcal{S} \\times \\mathcal{A} \\rightarrow[0, 1]')
('1.0.1.0', 'a')
('1.0.1.0', 's')
('1.0.1.0', '\\pi(a \\mid s)')
('1.0.1.0', 't \\in [1, T]')
('1.0.1.0', 'R_t = \\sum_{t^{\\prime} = t}^T \\gamma^{t^{\\prime} - t} r_{t^{\\prime}}')
('1.0.1.0', '\\pi')
('1.0.1.0', 'J = \\mathbb{E}_{a_t \\sim \\pi(\\cdot \\mid s_t), s_{t + 1} \\sim \\mathcal{P}(\\cdot \\mid s_t, a_t)}[\\sum_{t = 1}^T \\gamma^{t - 1} r_t(s_t, a_t, s_{t + 1})]')
('1.0.1.0', '(s, a, r, s^{\\prime})')
('1.0.1.0', '\\mathcal{D}')
('1.0.1.0', '\\pi_\\mu')
('1.0.1.0', '\\pi')
('1.0.1.0', 'J')
('1.0.1.0', '\\pi_\\mu')
('1.0.1.0', '\\mathcal{D} = \\left\\{\\tau_i\\right\\}_{i = 1}^D')
('1.0.1.0', '\\tau = \\left\\{\\left(s_i, a_i, r_i, s_i^{\\prime}\\right)\\right\\}_{i = 1}^T')
('1.0.1.1', 'q(\\boldsymbol{z})')
('1.0.1.1', '\\mathcal{D}:=\\{\\boldsymbol{z}^i\\}')
('1.0.1.1', 'i')
('1.0.1.1', '\\boldsymbol{z}^i')
('1.0.1.1', 'q_{\\boldsymbol{\\phi}}')
('1.0.1.1', 'q(\\boldsymbol{z}_{k+1} | \\boldsymbol{z}_k):=\\mathcal{N}(\\boldsymbol{z}_{k+1} ; \\sqrt{\\tilde{\\alpha}_k} \\boldsymbol{z}_k,(1-\\tilde{\\alpha}_k) \\boldsymbol{I})')
('1.0.1.1', 'k')
('1.0.1.1', 'p_\\theta(\\boldsymbol{z}_{k-1} | \\boldsymbol{z}_k):=')
('1.0.1.1', '\\mathcal{N}(\\boldsymbol{z}_{k-1} | \\mu_\\theta(\\boldsymbol{z}_k, k), \\Sigma_k)')
('1.0.1.1', 'k')
('1.0.1.1', '\\mathcal{N}(\\mu, \\Sigma)')
('1.0.1.1', '\\mu')
('1.0.1.1', '\\Sigma')
('1.0.1.1', '\\alpha_k \\in \\mathbb{R}')
('1.0.1.1', '\\alpha_k:=\\sqrt{\\tilde{\\alpha}_k}')
('1.0.1.1', '\\sigma_k:=\\sqrt{1-\\tilde{\\alpha}_k}')
('1.0.1.1', '\\boldsymbol{z}_0:=\\boldsymbol{z}')
('1.0.1.1', '\\mathcal{D}')
('1.0.1.1', '\\boldsymbol{z}_1, \\boldsymbol{z}_2, \\ldots, \\boldsymbol{z}_{K-1}')
('1.0.1.1', '\\boldsymbol{z}_K \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{I})')
('1.0.1.1', '\\tilde{\\alpha}_k')
('1.0.1.1', 'K')
('1.0.1.1', '\\log p_\\theta')
('1.0.1.1', '\\mathcal{L}_{\\text{denoise}}(\\theta):=\\mathbb{E}_{k \\sim[1, K], \\boldsymbol{z}_0 \\sim q, \\epsilon \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{I})}\\left[\\|\\epsilon-\\epsilon_\\theta(\\boldsymbol{z}_k, k)\\|^2\\right].')
('1.0.1.1', '\\epsilon_\\theta(\\boldsymbol{z}_k, k)')
('1.0.1.1', '\\epsilon \\sim')
('1.0.1.1', '\\mathcal{N}(0, I)')
('1.0.1.1', '\\boldsymbol{z}_0')
('1.0.1.1', '\\boldsymbol{z}_k')
('1.0.1.1.0', 'q(\\boldsymbol{z} | y(\\boldsymbol{z}))')
('1.0.1.1.0', 'y(\\boldsymbol{z})')
('1.0.1.1.0', 'y(\\boldsymbol{z})')
('1.0.1.1.0', 's_1')
('1.0.1.1.0', '\\epsilon_\\theta(\\boldsymbol{z}_k, k) \\propto \\nabla_{\\boldsymbol{z}_k} \\log p(\\boldsymbol{z}_k)')
('1.0.1.1.0', '\\epsilon_\\theta(\\boldsymbol{z}_k, s_1, k)')
('1.0.1.1.0', '\\epsilon_\\theta(\\boldsymbol{z}_k, k)')
('1.0.1.1.0', '\\epsilon_\\theta(\\boldsymbol{z}_k, \\varnothing, k)')
('1.0.1.1.0', '\\varnothing')
('1.0.1.1.0', 's_1')
('1.0.1.1.0', '\\boldsymbol{y}(\\boldsymbol{z})=\\varnothing')
('1.0.1.1.0', 'e')
('1.0.1.1.0', '\\tilde{\\epsilon}_k:=\\epsilon_\\theta(\\boldsymbol{z}_k, k)+\\omega(\\epsilon_\\theta(\\boldsymbol{z}_k, s_1, k)-\\epsilon_\\theta(\\boldsymbol{z}_k, k))')
('1.0.1.1.0', '\\mu_{k-1}')
('1.0.1.1.0', '\\Sigma_{k-1}')
('1.0.1.1.0', '\\boldsymbol{z}_{k-1}')
('1.0.1.1.0', '\\tilde{\\epsilon}_{k-1}')
('1.0.1.1.0', '\\boldsymbol{z}_{k-1} \\sim')
('1.0.1.1.0', '\\mathcal{N}\\left(\\mu_{k-1}, \\alpha \\Sigma_{k-1}\\right)')
('1.0.1.1.0', '\\alpha \\in [0,1)')
('1.0.2.2', 'Q')
('1.0.2.2', 'Q')
('1.0.2.2', 'Q')
('1.0.2.2', 'Q')
('1.0.2.4', 'q(x)')
('1.0.2.4', 'q(x)\\exp(-\\beta\\mathcal{E}(x))')
('1.0.2.4', '2')
('1.0.2.4', '3')
('1.0.2.4', '3')
('1.0.4', '5')
('1.0.4', '20')
('1.0.4', 'v2')
('1.0.4', 'v0')
('1.0.4.0', '3')
('1.0.4.0', '3')
('1.0.4.0.1', '1')
('1.0.4.0.1', '50')
('1.0.4.0.1', 'Q')
('1.0.4.0.1', '1')
('1.0.4.0.2', '\\in [3e-4, 1e-3]')
('1.0.4.0.2', '\\in [0.05, 0.2]')
('1.0.4.0.2', '1')
('1.0.4.1', '256')
('1.0.4.1', '3090')
('1.0.4.1', '24')
('1.0.4.1.0.0', '\\mathcal{O}_{t: T}')
('1.0.4.1.0.0', '\\log p\\left(\\mathbf{a}_t \\mid \\mathbf{s}_t, \\mathcal{O}_{t: T}\\right)')
('1.0.4.1.0.0', '2')
('1.0.4.1.0.0', '512')
('1.0.4.1.0.0', '3')
('1.0.4.1.0.0', '1024')
('1.0.4.1.0.0', '2e-4')
('1.0.4.1.0.0', '32')
('1.0.4.1.0.0', '2e6')
('1.0.4.1.0.0', '2e-4')
('1.0.4.1.0.0', '64')
('1.0.4.1.0.0', '1e6')
('1.0.4.1.0.1', '6')
('1.0.4.1.0.1', '2')
('1.0.4.1.0.1', '256')
('1.0.4.1.0.1', '128')
('1.0.4.1.0.1', '2 \\times 10^{-4}')
('1.0.4.1.0.1', '32')
('1.0.4.1.0.1', '2 \\times 10^6')
('1.0.4.1.0.1', 'p')
('1.0.4.1.0.1', 's_1')
('1.0.4.1.0.1', '0.25')
('1.0.4.1.0.1', 'K=100')
('1.0.4.1.1', '4')
('1.0.4.1.1', '256')
('1.0.4.1.1', '1 \\times 10^6')
('1.0.4.1.1', '3 \\times 10^{-4}')
('1.0.4.1.1', '256')
('1.0.4.1.1', 'M')
('1.0.4.1.1', '16')
('1.0.4.1.1', '32')
('1.0.4.1.1', '\\beta')
('1.0.4.1.1', '3')
('1.0.4.1.1', 'H')
('1.0.4.1.1', '40')
('1.0.4.1.1', '100')
('1.0.4.1.1', 'w')
('1.0.4.1.1', '\\{1.2,1.4,1.6,1.8\\}')
('1.0.4.1.1', '\\alpha')
('1.0.4.1.1', '0.5')
('1.0.4.1.1', 'C')
('1.0.4.1.1', '20')
('1.0.5.0', 's_1')
('1.0.5.0', '\\pi^{*}(\\tau \\mid s_1) \\propto \\mu(\\tau \\mid s_1) e^{\\beta\\sum_{t=1}^{T}Q_{\\zeta}(s_t,a_t)},')
('1.0.5.0', '\\tau:=(s_1, a_1, \\cdots, s_T, a_T)')
('1.0.5.0', '\\mu(\\tau \\mid s_1)')
('1.0.5.0', 'Q_{\\zeta}(\\cdot,\\cdot)')
('1.0.5.0', 'Q')
('1.0.5.0', '\\beta \\geq 0')
('1.0.5.0', 'p_0 := \\pi^*')
('1.0.5.0', 'q_0 = \\mu')
('1.0.5.0', '\\tau_0 = \\tau')
('1.0.5.0', 'p_0(\\tau_0 \\mid s_1) \\propto q_0(\\tau_0 \\mid s_1) \\exp\\left(-\\beta \\mathcal{E}(\\tau_0, s_1)\\right),')
('1.0.5.0', '\\mathcal{E}(\\tau_0, s_1) := -\\sum_{t=1}^{T}Q_{\\zeta}(s_{t},a_{t})')
('1.0.5.0', 'f_{\\eta}(\\tau_k,s_1,k)')
('1.0.5.0', '\\label{eq:cep-raw}\n    \\begin{aligned}\n        \\min_\\eta \\mathbb{E}_{p(k,s1)} \\mathbb{E}_{\\prod_{i=1}^M q\\left(\\tau_0^{(i)} \\mid s_1\\right) p\\left(\\epsilon^{(i)}\\right)}\\left[\n        -\\sum_{i=1}^M \\frac{e^{-\\beta\\mathcal{E}_0(h(\\tau_0^{(i)},s_1))}}{\\sum_{j=1}^M e^{-\\beta\\mathcal{E}_0(h(\\tau_0^{(j)},s_1))}} \\log \\frac{e^{f_\\eta\\left(\\tau_k^{(i)},s_1,k\\right)}}{\\sum_{j=1}^M e^{f_\\eta\\left(\\tau_k^{(j)},s_1,k\\right)}}\\right],\n    \\end{aligned}')
('1.0.5.0', 'k \\sim \\mathcal{U}(0,K)')
('1.0.5.0', '\\tau_k = \\alpha_k \\tau_0 + \\sigma_k\\epsilon')
('1.0.5.0', '\\epsilon \\sim \\mathcal{N}(0, \\mathbb{I})')
('1.0.5.0', 'q(\\tau_0 \\mid s_1)')
('1.0.5.0', 'M')
('1.0.5.0', '\\{\\hat{\\tau_0}^{(i)}\\}_M')
('1.0.5.0', 's_1')
('1.0.5.0', '\\label{eq:cep-raw-final}\n    \\min_\\eta \\mathbb{E}_{k, s_1, \\epsilon}-\\sum_{i=1}^M \\frac{e^{-\\beta\\mathcal{E}_0(h(\\hat{\\tau}_0^{(i)},s_1))}}{\\sum_{j=1}^M e^{-\\beta\\mathcal{E}_0(h(\\hat{\\tau}_0^{(j)},s_1))}} \\log \\frac{e^{f_\\eta\\left(\\hat{\\tau}_k^{(i)},s_1,k\\right)}}{\\sum_{j=1}^M e^{f_\\eta\\left(\\hat{\\tau}_k^{(j)},s_1,k\\right)}},')
('1.0.5.0', '\\hat{\\tau_0}^{(i)},\\hat{\\tau_0}^{(j)}')
('1.0.5.0', 's_1')
('1.0.5.0', 'p_{\\theta}')
('1.0.5.0', 'f_{\\eta}')
('1.0.5.0', 'B_1')
('1.0.5.0', '\\tau')
('1.0.5.0', '\\mathcal{D}')
('1.0.5.0', 'B_1')
('1.0.5.0', '\\epsilon')
('1.0.5.0', '\\mathcal{N}(0,\\mathbf{I})')
('1.0.5.0', 'B_1')
('1.0.5.0', 'k')
('1.0.5.0', '\\mathcal{U}(0, K)')
('1.0.5.0', '\\tau_0')
('1.0.5.0', '\\tau_k := \\alpha_k \\tau_0 + \\sigma_k \\epsilon')
('1.0.5.0', '\\{\\theta\\}')
('1.0.5.0', 'M')
('1.0.5.0', '\\{\\hat{\\tau}^{(i)}\\}_M')
('1.0.5.0', 'p_{\\theta}')
('1.0.5.0', 'B_2')
('1.0.5.0', 's_1')
('1.0.5.0', '\\mathcal{D}')
('1.0.5.0', 'B_2')
('1.0.5.0', '\\epsilon')
('1.0.5.0', '\\mathcal{N}(0,\\mathbf{I})')
('1.0.5.0', 'B_2')
('1.0.5.0', 'k')
('1.0.5.0', '\\mathcal{U}(0, K)')
('1.0.5.0', '\\{\\hat{\\tau_0}^{(i)}\\}_M')
('1.0.5.0', 's_1')
('1.0.5.0', '\\hat{\\tau_0}^{(i)}')
('1.0.5.0', '\\hat{\\tau_k}^{(i)}:=\\alpha_k \\hat{\\tau_0}^{(i)} + \\sigma_k \\epsilon')
('1.0.5.0', '\\{\\eta\\}')
('1.0.5.0.0', '\\mathcal{E}(\\tau_0,s_1)')
('1.0.5.0.0', '\\tau_0')
('1.0.5.0.0', 'f_{\\eta}(\\tau_t,s_1,t)')
('1.0.5.0.0', '\\min_\\eta \\mathbb{E}_{q_{0t}\\left(\\tau_0, \\tau_t, s_1\\right)}\\left[\\left\\|f_\\eta\\left(\\tau_t, s_1,t\\right)-\\mathcal{E}\\left(\\tau_0,s_1\\right)\\right\\|_2^2\\right].')
('1.0.5.0.0', 'f_{\\eta}')
('1.0.5.0.0', '\\label{eq:mse-loss}\n    f_\\eta^{\\mathrm{MSE}}\\left(\\tau_t,s_1,t\\right)=\\mathbb{E}_{q_{0t}\\left(\\tau_0 \\mid \\tau_t,s_1\\right)}\\left[\\mathcal{E}\\left(\\tau_0,s_1\\right)\\right].')
('1.0.5.0.0', '\\begin{aligned}\n        \\mathcal{E}_t\\left(\\tau_0,s_1\\right) & =-\\log \\mathbb{E}_{q_{0 t}\\left(\\tau_0 \\mid \\tau_t,s_1\\right)}\\left[e^{-\\mathcal{E}\\left(\\tau_0,s_1\\right)}\\right] \\\\\n        & \\geq \\mathbb{E}_{q_{0 t}\\left(\\tau_0 \\mid \\tau_t,s_1\\right)}\\left[\\mathcal{E}\\left(\\tau_0,s_1\\right)\\right]=f_\\eta^{\\mathrm{MSE}}\\left(\\tau_t,s_1,t\\right),\n    \\end{aligned}')
('1.0.5.0.0', 't=0')
('1.0.5.0.0', 'f_\\eta^{\\mathrm{MSE}}')
('1.0.5.0.0', 't>0')
('1.0.5.0.0', 'f_\\eta^{\\mathrm{MSE}}')
('1.0.5.0.0', '\\nabla_{\\tau_t}\\mathcal{E}_t\\left(\\tau_t,s_1\\right)')
('1.0.5.0.0', '\\mathcal{E}(\\boldsymbol{z}_0,s_1)')
('1.0.5.0.0', '\\min _\\eta \\mathbb{E}_{t, \\boldsymbol{z}_0, \\boldsymbol{z}_t}\\left[\\left\\|\\exp \\left(f_\\eta\\left(\\boldsymbol{z}_t, t\\right)\\right)-\\exp \\left(\\beta \\mathcal{E}\\left(\\boldsymbol{z}_0\\right)\\right)\\right\\|_2^2\\right].')
('1.0.5.1', '\\tau_{\\text{sim}}')
('1.0.5.1', 'T')
('1.0.5.1', '\\tau_{\\text{sim}}:=\\left(s_1, a_1,  s_2, a_2, \\ldots, s_T\\right).')
('1.0.5.1', 's_1')
('1.0.5.1', '\\pi^{*}(\\tau_{\\text{sim}} \\mid s_1) \\propto \\mu(\\tau_{\\text{sim}} \\mid s_1) e^{\\beta\\sum_{t=1}^{T}Q_{\\zeta}(s_t,a_t)},')
('1.0.5.1', '\\mu(\\tau_{\\text{sim}} \\mid s_1)')
('1.0.5.1', 'Q_{\\zeta}(\\cdot,\\cdot)')
('1.0.5.1', 'Q')
('1.0.5.1', '\\beta \\geq 0')
('1.0.6.0', 'L')
('1.0.6.0', '\\frac{1}{L}')
('1.0.6.0', 'L')
('1.0.6.0', 'L')
('1.0.6.0', '1')
('1.0.7.0', '\\max_\\pi \\mathbb{E}_{s \\sim \\mathcal{D}^\\mu}\\left[\\mathbb{E}_{a \\sim \\pi(\\cdot \\mid s)} A_{\\zeta}(s, a)-\\frac{1}{\\beta} D_{\\mathrm{KL}}(\\pi(\\cdot \\mid s) \\| \\mu(\\cdot \\mid s))\\right],')
('1.0.7.0', 'A_{\\zeta}')
('1.0.7.0', '(s, a)')
('1.0.7.0', 'A^{\\pi}(s,a) := Q^\\pi(s,a) - V^{\\pi}(s)')
('1.0.7.0', '\\pi')
('1.0.7.0', '\\beta')
('1.0.7.0', '\\pi^*')
('1.0.7.0', '\\pi^*(a \\mid s) \\propto \\mu(a \\mid s) e^{\\beta A_\\zeta(s, a)}.')
('1.0.7.0', 'V^{\\pi}(s)')
('1.0.7.0', 'a')
('1.0.7.0', '\\pi^*(a \\mid s) \\propto \\mu(a \\mid s) e^{\\beta A_\\zeta(s, a)} \\propto \\mu(a \\mid s) e^{\\beta Q_\\zeta(s, a)},')
('1.0.7.0', 'Q_{\\zeta}')
('1.0.7.0', '(s, a)')
('1.0.7.0', 'Q')
('1.0.7.0', 'Q^\\pi(s,a)')
('1.0.7.0', '\\pi')
('1.0.7.0', '\\zeta')
('1.0.7.0', 'Q')
('1.0.7.0', '\\label{eq:constrained-traj-opt-latent}\n    \\begin{aligned}\n        &\\pi^{*}(\\boldsymbol{z} \\mid s_1) = p(s_1)\\prod_{t=0}^{T-1} \\pi^*(a_t \\mid s_t) p(s_{t+1} \\mid s_{t}, a_{t})\\mathcal{R}(r_t \\mid s_{t}, a_{t}, s_{t+1})\\mathcal{G}(G_{t} \\mid s_{t}, a_{t}) \\\\\n        &\\propto p(s_1)\\prod_{t=0}^{T-1} \\mu(a_t \\mid s_t) \\exp\\left(\\beta Q_\\zeta(s_t, a_t)\\right) p(s_{t+1} | s_{t}, a_{t})\\mathcal{R}(r_t \\mid s_{t}, a_{t}, s_{t+1})\\mathcal{G}(G_{t} \\mid s_{t}, a_{t}) \\\\\n        &= p(s_1) \\left(\\prod_{t=0}^{T-1}\\mu(a_t \\mid s_t) p(s_{t+1} | s_{t}, a_{t})\\mathcal{R}(r_t \\mid s_{t}, a_{t}, s_{t+1})\\mathcal{G}(G_{t} \\mid s_{t}, a_{t})\\right) \\left(\\prod_{t=0}^{T-1} \\exp\\left(\\beta Q_\\zeta(s_t, a_t)\\right)\\right) \\\\\n        &= \\mu(\\boldsymbol{z} \\mid s_1) \\exp\\left(\\beta\\sum_{t=0}^{T-1}Q_\\zeta(s_t, a_t)\\right) = \\mu(\\boldsymbol{z} \\mid s_1) e^{\\beta\\sum_{t=0}^{T-1}Q_\\zeta(s_t, a_t)}.\\nonumber \n        % \\\\\n        % &= p^{\\mu}(\\boldsymbol{z} \\mid s_1) \\exp\\left(\\beta\\left(\\sum_{t=0}^{T-1}\\left(r(s_t, a_t)+(1-\\gamma)V(s_{t+1})\\right)-V(s_1)\\right)\\right) \\\\\n        % &= p^{\\mu}(\\boldsymbol{z} \\mid s_1) \\exp\\left(\\beta\\left(A_{\\gamma=1}(s_1,a_0)+(1-\\gamma)\\sum_{t=0}^{T-1}V(s_{t+1})\\right)\\right).\n    \\end{aligned}')
