('1', 'N')
('1', '\\epsilon-')
('1', '\\epsilon')
('1.1', '\\epsilon')
('2', 's \\in \\mathcal{S},')
('2', 'a \\in \\mathcal{A}')
('2', 'r = r(s,a).')
('2', 's^{\\prime}')
('2', 's')
('2', 'a')
('2', 'p_{i,j}^a.')
('2', 'P^a = [[p_{i,j}^a]].')
('2', 'V^{*}(s) = \\max_{\\pi} \\mathbb{E}\\left[ \\sum_{t=0}^{\\infty} \\beta^t r_t \\vert s_0 =s,  \\pi  \\right].')
('2', '\\begin{aligned}\n    Q^*(s,a) &=& r(s,a) + \\beta \\sum_{s^{\\prime} \\in \\mathcal{S} } p_{s,s^{\\prime}}^a  \n   \\max_{a^{\\prime}} Q^*(s^{\\prime},a^{\\prime}), \n \\\\\nV^{*}(s) &=& \\max_{a \\in \\mathcal{A}} Q^*(s,a).\n\\end{aligned}')
('2', 'R =[[r(s,a)]]')
('2', 'P^a,')
('2', 'a \\in \\mathcal{A}')
('2', 'n^{th}')
('2', 's,')
('2', 'a,')
('2', 's^{\\prime},')
('2', 'r_n = r(s,a).')
('2', 'n+1')
('2', 'Q_{n}')
('2', '\\begin{aligned}\nQ_{n+1}(s, a) = Q_{n}(s, a) + \\alpha_n \\left[r_n + \\beta  \\max_{a^{\\prime}} Q_{n}(s^{\\prime},a^{\\prime}) \n\\right. \\nonumber \\\\ \\left.\n- Q_{n}(s, a)  \\right] \n\\end{aligned}')
('2', '(s,a) \\in \\mathcal{S} \\times \\mathcal{A},')
('2', 'Q_{n+1}(s,a) = Q_n(s,a).')
('2', '\\alpha_n')
('2', '(s,a) \\in \\mathcal{S} \\times \\mathcal{A},')
('2', 'Q_n(s,a)')
('2', 'n \\rightarrow \\infty.')
('2.0', 's,')
('2.0', 'a')
('2.0', 'r(s,a)')
('2.0', 's^{\\prime}')
('2.0', 'Q_{n-1}')
('2.0', 'Q_{n}')
('2.0', 'n-1')
('2.0', 'n.')
('2.0', '\\Gamma')
('2.0', "\\begin{aligned}\n    \\Gamma Q(s, a) := r + \\beta  \\cdot \\max_{a'} Q(s', a').\n\\end{aligned}")
('2.0', '(s,a) \\in \\mathcal{S} \\times \\mathcal{A},')
('2.0', 'n+1')
('2.0', '\\begin{aligned}\n  Q_{n+1}(s, a) := Q_n(s, a) + \\alpha_{n} \\cdot \\left( \\Gamma  Q_{n-1}(s, a) - Q_n(s, a)\\right) + \\nonumber \\\\ (1 - \\alpha_n) \\cdot \\left(\\Gamma Q_n(s, a) - \\Gamma Q_{n-1}(s, a)\\right), \n\\end{aligned}')
('2.0', '\\alpha_n = \\frac{1}{n+1}.')
('2.1', 'w')
('2.1', '\\widehat{T}')
('2.1', "\\begin{aligned}\n\\widehat{T} Q(s, a) := w \\cdot r + (1-w + \\beta \\cdot w) \\cdot \\max_{a'} Q(s', a').\n\\end{aligned}")
('2.1', 'n+1')
('2.1', '\\begin{aligned}\nQ_{n+1}(s, a) := Q_n(s,a)+ \\alpha_n \\cdot \\left( \\widehat{T} Q_{n-1}(s, a) - Q_n(s, a)\\right)  \\nonumber \\\\ +  (1- \\alpha_n)\\cdot \\left(  \\widehat{T} Q_n(s, a) -  \\widehat{T} Q_{n-1}(s, a)\\right).\n\\end{aligned}')
('2.1', 'w')
('2.1', 'w \\geq 1.')
('2.2', '(s,a),')
('2.2', 'm')
('2.2', 'm')
('2.2', '\\frac{1}{m}\\sum_{i=1}^{m} 1_{(s,a,s_i^n= s^{\\prime})} \\approx p_{s,s^{\\prime}}^a.')
('2.2', '\\begin{aligned}\n    Q_{n+1}(s,a) =  r(s,a) + \\beta \\frac{1}{m} \\sum_{i=1}^{m}  \\left[   V_{n}(s_i^{n})  \\right], \n\\end{aligned}')
('2.2', '\\begin{aligned}\n    V_{n+1}(s) = \\max_{a}  Q_{n+1}(s,a).\n\\end{aligned}')
('2.2', '\\{ s_k^{n} \\}_{k=1}^{m}')
('2.2', '(s,a)')
('2.2', 'm')
('2.2', 'n')
('2.2', 'Q')
('2.2', 'Q')
('2.2', 'm')
('2.3', '\\epsilon-')
('2.3', '\\epsilon-')
('2.3', '1-\\epsilon')
('2.3', 'Q')
('2.3', '\\epsilon.')
('2.3', '\\begin{aligned}\n    a_n =  \n    \\begin{cases}\n        a & \\mbox{with prob. $\\frac{\\epsilon}{|\\mathcal{A}|}$}, \\\\\n        \\arg\\max_{a \\in \\mathcal{A}} Q_{n+1}(s,a) & \\mbox{with prob. $1-\\epsilon.$}\n    \\end{cases}\n\\end{aligned}')
('2.3', '\\begin{aligned}\n    a_n = \\arg\\max_{a} \\left( Q_n(s, a) + c \\cdot \\sqrt{\\frac{\\log(n+1)}{N(s, a) +1}} \\right).\n\\end{aligned}')
('2.3', 's^{\\prime}')
('2.3', 'r.')
('2.3', "\\begin{aligned}\n    Q_{n+1}(s, a) &=& Q_{n}(s, a) + \\alpha \\cdot \\left( r + \\beta  V_n(s^{'}) - Q_n(s, a) \\right) \\\\\n    V_n(s) &=& \\min \\left( V_{max}, \\max_{a^{'}} Q_n(s, a^{'}) \\right).\n\\end{aligned}")
('2.3', "s \\leftarrow s'")
('2.4', 'a = 0')
('2.4', 'a = 1')
('2.4', '\\begin{aligned}\n  P_0 &=&  \\begin{bmatrix}\n    0.1502 & 0.0400 & 0.4156 & 0.0300 & 0.3642 \\\\\n    0.4000 & 0.3500& 0.0800& 0.1200& 0.0500 \\\\\n    0.5276 & 0.0400 &0.3991 & 0.0200 & 0.0133  \\\\\n    0.0500 & 0.1000& 0.1500& 0.2000& 0.5000 \\\\\n    0.0191 & 0.0100 & 0.0897 & 0.0300 & 0.8512 \n\\end{bmatrix}, \\\\\n P_1 &=& \n\\begin{bmatrix}\n    0.7196 & 0.0500 & 0.0903 & 0.0100 & 0.1301 \\\\\n    0.5500 & 0.2000& 0.0500& 0.0800& 0.1200 \\\\ \n    0.1903 & 0.0100 & 0.1663 & 0.0100 & 0.6234 \\\\\n    0.2000 & 0.0500 &0.1500 & 0.1000 & 0.5000 \\\\\n    0.2501 & 0.0100& 0.3901 & 0.0300 & 0.3198 \n\\end{bmatrix}, \\\\\nR &= &\n\\begin{bmatrix}\n    0.4580 & 0.9631  \\\\\n    0.5100 & 0.8100 \\\\\n    0.6508 & 0.7963  \\\\\n    0.6710 & 0.6061 \\\\\n    0.6873 & 0.5057  \n\\end{bmatrix}.\n\\end{aligned}')
('2.4', '\\beta = 0.9')
('2.4', '\\alpha = 0.02')
('2.4', 'T_{\\max}= 30000')
('2.4', '\\epsilon = 0.3.')
('2.4', 'm=20.')
('2.4', 'e_n = \\mathrm{mean}(|Q_n(s,a,) - Q^*(s,a)|)')
('2.4', 'n.')
('2.4', '\\epsilon')
('2.4', '\\epsilon')
('2.4', '\\epsilon')
('2.4', '\\epsilon')
('3', 'N.')
('3', 'K.')
('3', 'K')
('3', '\\mathcal{S}')
('3', 'X_t^i')
('3', 't')
('3', 'i')
('3', 'X_t^i \\in \\mathcal{S}.')
('3', 'i')
('3', 't')
('3', 'a_t^i')
('3', '\\begin{aligned}\n    a_t^i = \n    \\begin{cases} \n    1 & \\mbox{If arm $i$ is played, } \\\\ \n    0 & \\mbox{If arm $i$ not  played.}\n    \\end{cases} \n\\end{aligned}')
('3', 'i')
('3', 'a^i.')
('3', '[[p_{s,s^{\\prime}}^{a^i}]]')
('3', 'i')
('3', 'a^i \\in \\{1,0\\}.')
('3', 's')
('3', 'a^i')
('3', 'i')
('3', 'r_i(s,a^i).')
('3', '\\begin{aligned}\n\\max_{\\pi} \\mathbb{E}^{\\pi}\\left[ \\sum_{t=1}^{\\infty} \\beta^{t-1} \\left(\\sum_{n=1}^{N} r_i(X_t^i,a_t^i) \\right) \\right] \n\\end{aligned}')
('3', '\\sum_{n=1}^{N} a_t^i = M.')
('3', 'M')
('3', '\\begin{aligned}\n    \\sum_{t=1}^{\\infty} \\beta^{t-1} \\left(\\sum_{n=1}^{N} a_t^i \\right) = \\frac{M}{(1-\\beta)}.\n\\end{aligned}')
('3', '\\begin{aligned}\n  \\max_{\\pi}  \\mathbb{E}^{\\pi}\\left[ \\sum_{t=1}^{\\infty} \\beta^{t-1} \\left( r_i(X_t^i,a_t^i)  +  \\lambda (1- a_t^i) \\right) \\right] .\n\\end{aligned}')
('3', '\\begin{aligned}\n   \\max_{\\pi} \\mathbb{E}^{\\pi}\\left[ \\sum_{n=1}^{N} \\left( \\sum_{t=1}^{\\infty} \\beta^{t-1}  \\left( r_i(X_t^i,a_t^i)  +  \\lambda (1- a_t^i \\right) \\right)  \\right] . \n\\end{aligned}')
('3', 'N')
('3', '\\begin{aligned}\n  \\max_{\\pi}  \\mathbb{E}^{\\pi}\\left[ \\sum_{t=1}^{\\infty} \\beta^{t-1}  \\left( r_i(X_t^i,a_t^i)  +  \\lambda (1- a_t^i \\right)  \\right] .\n\\end{aligned}')
('3.0', 'i.')
('3.0', '\\begin{aligned}\n    V(s) = \\max_{a \\in \\{0,1\\}} \\{ r(s,a) + \\lambda (1-a) + \\beta \\sum_{s^{\\prime}} p_{s,s^{\\prime}}^{a} V(s^{\\prime})\\}.\n\\end{aligned}')
('3.0', '\\begin{aligned}\n    Q^{\\lambda}(s,a) =  r(s,a) + (1-a)\\lambda +   \\beta \\sum_{s^{\\prime} \\in \\mathcal{S} } p_{s,s^{\\prime}}^a  \n   \\max_{a^{\\prime}} Q^{\\lambda}(s^{\\prime},a^{\\prime}),\n\\end{aligned}')
('3.0', '\\begin{aligned}\n    V(s) &=& \\max_{a \\in \\mathcal{A}} Q(s,a).\n\\end{aligned}')
('3.0', '\\lambda')
('3.0', '\\lambda')
('3.0', 'Q^{\\lambda}(s,a=1) - Q^{\\lambda}(s,a=0) =0.')
('3.0', 'W(s) = \\min \\{ \\lambda:  Q^{\\lambda}(s,a=1) - Q^{\\lambda}(s,a=0) =0 \\}')
('3.0', 's \\in \\mathcal{S}.')
('3.0', '\\lambda')
('3.0', '\\begin{aligned}\nQ_{n+1}^{\\lambda}(s, a) = Q_{n}^{\\lambda}(s, a) + \\alpha_n \\left[r(s,a) + \\lambda (1-a) + \n\\right. \\nonumber \\\\ \\left. \n\\beta  \\max_{a^{\\prime}} Q_{n}^{\\lambda}(s^{\\prime},a^{\\prime}) \n- Q_{n}^{\\lambda}(s, a)  \\right] \n\\end{aligned}')
('3.0', '(s,a) \\in \\mathcal{S} \\times \\mathcal{A},')
('3.0', 'Q_{n+1}^{\\lambda}(s,a) = Q_n^{\\lambda}(s,a).')
('3.0', '\\alpha_n')
('3.0', 'r= r(s,a) + \\lambda (1-a).')
('3.1', '\\lambda')
('3.1', '\\tilde{s},')
('3.1', '\\lambda')
('3.1', '\\tilde{s} \\in \\mathcal{S}.')
('3.1', 'Q^{*,\\lambda}(s,a,\\tilde{s})')
('3.1', '(s,a,\\tilde{s})')
('3.1', '\\lambda.')
('3.1', '\\lambda')
('3.1', '\\tilde{s},')
('3.1', 'Q^{*,\\lambda}(\\tilde{s},a=1,\\tilde{s}) = Q^{*,\\lambda}(\\tilde{s},a=1,\\tilde{s}).')
('3.1', 'Q_n^{\\lambda}(s, a, \\tilde{s})')
('3.1', 'n')
('3.1', '(s,a,\\tilde{s}).')
('3.1', 'n')
('3.1', 'Q_n^{\\lambda}(s, a, \\tilde{s}) \\rightarrow  Q^{*,\\lambda}(s,a,\\tilde{s}).')
('3.1', 'n,')
('3.1', '\\tilde{s}')
('3.1', '|Q_n^{\\lambda(\\tilde{s})}(\\tilde{s},a = 1, \\tilde{s}) - Q_n^{\\lambda(\\tilde{s})}(\\tilde{s},a = 0, \\tilde{s})|\n\\leq \\delta')
('3.1', '0<\\delta <<1.')
('3.1', 'Q(s, a, \\tilde{s})')
('3.1', 's, \\tilde{s} \\in \\mathcal{S}, a \\in \\{0,1\\}')
('3.1', '\\lambda(s)')
('3.1', 's \\in \\mathcal{S}')
('3.1', 'q(\\cdot , \\cdot) \\leftarrow Q(\\cdot , \\cdot , \\tilde{s})')
('3.1', 'a= \\mathrm{EEpolicy}(s,a, Q)')
('3.1', '(r,s^{\\prime}) = \\mathrm{Observe}(s,a, \\lambda(\\tilde{s}))')
('3.1', 'r = r(s,a) + (1-a) \\lambda(\\tilde{s})')
('3.1', 'q(s,a) = \\mathrm{QRLupdate}(s,a,r,s^{\\prime},\\beta, \\alpha)')
('3.1', "s \\leftarrow s'")
('3.1', 'Q^{\\lambda(\\tilde{s})}(\\cdot,\\cdot,\\tilde{s}) \\leftarrow q(\\cdot,\\cdot)')
('3.1', '\\lambda(\\tilde{s}) \\leftarrow \\lambda(\\tilde{s}) + \\gamma  \\times  (Q^{\\lambda(\\tilde{s})}(\\tilde{s}, 1, \\tilde{s}) - Q^{\\lambda(\\tilde{s})}(\\tilde{s}, 0, \\tilde{s}))')
('3.1', '\\lambda(\\tilde{s})')
('3.1', '\\lambda(\\tilde{s})')
('3.1', '\\tilde{s} \\in \\mathcal{S},')
('3.1', 'Q(\\cdot, \\cdot, \\tilde{s}).')
('3.1', '\\lambda_n(\\tilde{s})')
('3.1', '\\begin{aligned}\n    \\lambda_{n+1}(\\tilde{s}) = \\lambda_n(\\tilde{s}) + \\gamma (Q(\\tilde{s}, 1, \\tilde{s}) - Q(\\tilde{s}, 0, \\tilde{s})). \n\\end{aligned}')
('3.1', '\\gamma')
('3.1', '\\lambda_n(\\tilde{s})')
('3.1', '\\tilde{s} \\in \\mathcal{S},')
('3.1', "\\begin{aligned}\n    Q_{n+1}^{\\lambda}(s, a, \\tilde{s}) =  Q_{n}^{\\lambda}(s, a, \\tilde{s})  + \\alpha \\left[r(s,a) + \\lambda_n(\\tilde{s}) (1-a)+ \\nonumber \n    \\right. \\\\ \\left. \n    \\beta \\max_{a^{'}} Q_{n}^{\\lambda}(s, a^{'}, \\tilde{s}) - Q_{n}^{\\lambda}(s, a, \\tilde{s})\n    \\right]\n    \\label{eqn:Q-RLupdate}\n\\end{aligned}")
('3.1', '\\begin{aligned}\n    \\lambda_{n+1}(\\tilde{s}) = \\lambda_n(\\tilde{s}) + \\gamma  \\left[Q_n^{\\lambda}(\\tilde{s}, 1, \\tilde{s}) - Q_n^{\\lambda}(\\tilde{s}, 0, \\tilde{s})\\right]. \n    \\label{eqn:index-update}\n\\end{aligned}')
('3.1', '\\alpha')
('3.1', '\\gamma')
('3.1', '\\alpha')
('3.1', '\\gamma')
('3.1', '\\max_{\\tilde{s}}|Q_n^{\\lambda}(\\tilde{s}, 1, \\tilde{s}) - Q_n^{\\lambda}(\\tilde{s}, 0, \\tilde{s})|')
('3.1.1', '\\begin{aligned}\nQ_{n+1}^{\\lambda}(s, a,\\tilde{s}) := Q_n^{\\lambda}(s, a,\\tilde{s}) + \\alpha TE_1 + (1 - \\alpha) TE_2      \n\\end{aligned}')
('3.1.1', "\\begin{aligned}\n    TE_1  &=&  \\Gamma  Q_{n-1}^{\\lambda}(s, a,\\tilde{s}) - Q_n^{\\lambda}(s, a,\\tilde{s}), \\\\\n    TE_2 &=&  \\Gamma Q_n^{\\lambda}(s, a,\\tilde{s}) - \\Gamma Q_{n-1}^{\\lambda}(s, a,\\tilde{s}), \\\\\n    \\Gamma Q^{\\lambda}(s, a) &=& r + \\beta   \\max_{a'} Q^{\\lambda}(s', a').\n\\end{aligned}")
('3.1.1', 'T_{\\max}')
('3.1.1', 'n')
('3.1.1', 'n-1.')
('3.1.1', 'Q^*')
('3.1.1', '\\sqrt{\\frac{1}{T_{\\max}}}')
('3.1.1', 'T_{\\max}')
('3.1.2', '\\begin{aligned}\nQ_{n+1}^{\\lambda}(s, a,\\tilde{s}) := Q_n^{\\lambda}(s,a,\\tilde{s})+ \\alpha TE_3   +  (1- \\alpha) TE_4,\n\\end{aligned}')
('3.1.2', "\\begin{aligned}\n    TE_3 &=&   \\widehat{T} Q_{n-1}^{\\lambda}(s, a,\\tilde{s}) - Q_n^{\\lambda}(s, a,\\tilde{s})  \\\\ \n    TE_4 &=&  \\widehat{T} Q_n^{\\lambda}(s, a,\\tilde{s}) -  \\widehat{T} Q_{n-1}^{\\lambda}(s, a,\\tilde{s}) \\\\\n    \\widehat{T} Q^{\\lambda}(s, a,\\tilde{s}) &=& w  r + (1-w + \\beta  w)  \\max_{a'} Q^{\\lambda}(s', a',\\tilde{s}).\n\\end{aligned}")
('3.1.2', 'T_{\\max},')
('3.1.2', 'w \\geq 1.')
('3.1.2', 'w=1.')
('3.1.3', '\\begin{aligned}\n    Q_{n+1}^{\\lambda}(s,a,\\tilde{s}) =  r(s,a) + \\beta \\frac{1}{m} \\sum_{i=1}^{m}  \\left[   V_{n}^{\\lambda}(s_i^{n}),\\tilde{s}  \\right] \n\\end{aligned}')
('3.1.3', '\\begin{aligned}\n    V_{n}^{\\lambda}(s_i^{n},\\tilde{s}) = \\max_{a^{\\prime}}  Q_{n}^{\\lambda}(s_i^{n},a^{\\prime},\\tilde{s}).\n\\end{aligned}')
('3.1.3', '\\{ s_i^{n} \\}_{i=1}^{m}')
('3.1.3', '(s,a)')
('3.1.3', 'm')
('3.1.3', 'T_{\\max},')
('4', '\\epsilon =0.3,')
('4', 'T_{\\max} =10000,')
('4', 'K_{\\max} = 3000,')
('4', 'm =20.')
('4', '\\alpha = 0.02')
('4', '\\gamma= 0.005.')
('4', 'E_n = \\frac{1}{|\\mathcal{S}|}\\sum_{\\tilde{s}  \\in \\mathcal{S}} |Q_n^{ \\lambda}(\\tilde{s}, 1, \\tilde{s} ) - Q_n^{\\lambda}(\\tilde{s}, 0, \\tilde{s})|.')
('4', 'E_n')
('4', 'n')
('4', '\\epsilon')
('5', '\\epsilon')
('5', '\\epsilon')
