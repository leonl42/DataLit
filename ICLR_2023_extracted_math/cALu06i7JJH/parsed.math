('2', '\\{\\mathcal{S},\\mathcal{A},P,r,d_{0},\\gamma\\}')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', 'P:\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\rightarrow\\mathbb{R}')
('2', 'r:\\mathcal{S}\\times\\mathcal{A}\\rightarrow\\mathbb{R}')
('2', 'd_{0}:\\mathcal{S}\\rightarrow\\mathbb{R}')
('2', '\\gamma\\in[0,1)')
('2', '\\pi')
('2', '\\pi:\\mathcal{S}\\times\\mathcal{A}\\rightarrow[0,1]')
('2', '\\pi(a|s)')
('2', 'J(\\pi)\\triangleq\\mathbb{E}_{s_{0}\\sim d_{0},a_{t}\\sim\\pi(\\cdot|s_{t}),s_{t+1}%\n\\sim P(\\cdot|s_{t},a_{t})}\\big{[}\\sum_{t=0}^{\\infty}\\gamma^{t}r(s_{t},a_{t})%\n\\big{]}')
('2', 'Q_{\\pi}')
('2', 'V_{\\pi}')
('2', 'Q_{\\pi}(s_{t},a_{t})\\triangleq\\mathbb{E}_{t}\\Big{[}\\sum_{l=0}^{\\infty}\\gamma^{%\nl}r(s_{t+l},a_{t+l})\\Big{]}')
('2', 'V_{\\pi}(s_{t})\\triangleq\\mathbb{E}_{a_{t}\\sim\\pi(\\cdot|s_{t})}\\Big{[}Q_{\\pi}(s%\n_{t},a_{t})\\Big{]}')
('2', 'A_{\\pi}(s,a)\\triangleq Q_{\\pi}(s,a)-V_{\\pi}(s)')
('2', '{d_{\\pi}(s)\\triangleq\\sum_{t=0}^{\\infty}\\gamma^{t}P(s_{t}=s|\\pi,d_{0})}')
('2', 'J(\\tilde{\\pi})=J(\\pi)+\\sum_{s}d_{\\tilde{\\pi}}(s)\\sum_{a}\\tilde{\\pi}(a|s)A_{\\pi%\n}(s,a).')
('2', 'd_{\\tilde{\\pi}}(s)')
('2', '\\tilde{\\pi}')
('2', 'L_{\\pi}(\\tilde{\\pi})\\triangleq J(\\pi)+\\sum_{s}d_{\\pi}(s)\\sum_{a}\\tilde{\\pi}(a|%\ns)A_{\\pi}(s,a),')
('2', 'd_{\\tilde{\\pi}}')
('2', 'd_{\\pi}')
('2', 'D_{\\mathrm{TV}}^{\\mathrm{max}}(\\pi,\\tilde{\\pi})\\triangleq\\max_{s}D_{\\mathrm{TV%\n}}\\big{(}\\pi(\\cdot|s),\\tilde{\\pi}(\\cdot|s)\\big{)}')
('2', 'D_{\\mathrm{TV}}')
('2', '\\alpha\\triangleq D_{\\mathrm{TV}}^{\\mathrm{max}}(\\pi,\\tilde{\\pi})')
('2', 'J(\\tilde{\\pi})\\geq L_{\\pi}(\\tilde{\\pi})-\\frac{4\\epsilon\\gamma}{(1-\\gamma)^{2}}%\n\\alpha^{2}')
('2', '\\epsilon=\\max_{s,a}\\lvert A_{\\pi}(s,a)\\rvert')
('2', 'D_{\\mathrm{TV}}^{2}(\\pi,\\tilde{\\pi})\\leq\\frac{1}{2}D_{\\mathrm{KL}}(\\pi,\\tilde{%\n\\pi})')
('2', 'J(\\tilde{\\pi})\\geq L_{\\pi}(\\tilde{\\pi})-\\frac{2\\epsilon\\gamma}{(1-\\gamma)^{2}}%\nD_{\\mathrm{KL}}^{\\mathrm{max}}(\\pi,\\tilde{\\pi})')
('2', 'D_{\\mathrm{KL}}^{\\mathrm{max}}(\\pi,\\tilde{\\pi})\\triangleq\\max_{s}D_{\\mathrm{KL%\n}}(\\pi,\\tilde{\\pi})')
('2', '\\pi')
('2', '\\tilde{\\pi}')
('2', '\\max_{\\tilde{\\pi}}\\quad\\mathbb{E}_{(s,a)\\sim d_{\\pi}}\\Big{[}\\frac{\\tilde{\\pi}(%\na|s)}{\\pi(a|s)}A_{\\pi}(s,a)\\Big{]},\\quad\\text{s.t.}\\quad\\mathbb{E}_{s}\\big{[}D%\n_{\\mathrm{KL}}(\\pi(\\cdot|s),\\tilde{\\pi}(\\cdot|s))\\big{]}\\leq\\delta,')
('2', '\\delta')
('2', '\\max_{\\tilde{\\pi}}\\mathbb{E}_{d_{\\pi}}\\big{[}\\min\\big{(}\\frac{\\tilde{\\pi}(a|s)%\n}{\\pi(a|s)}A_{\\pi},\\mathrm{clip}(\\frac{\\tilde{\\pi}(a|s)}{\\pi(a|s)},1-\\epsilon,%\n1+\\epsilon)A_{\\pi}\\big{)}\\big{]},\\quad\\text{ where }\\epsilon\\text{ is the %\nclipping hyperparameter. }')
('3.1', 'A(s,a)\\triangleq r(s,a)+\\mathbb{E}_{s^{\\prime}\\sim P(\\cdot|s,a)}[f(s^{\\prime})%\n]-f(s)')
('3.1', 'f')
('3.1', 'f:\\mathcal{S}\\rightarrow\\mathbb{R}')
('3.1', '\\pi')
('3.1', '\\tilde{\\pi}')
('3.1', '\\tilde{\\pi}')
('3.1', '\\pi')
('3.1', 'J(\\tilde{\\pi})-J(\\pi)=\\mathbb{E}_{s\\sim d_{\\tilde{\\pi}}(s),a\\sim\\tilde{\\pi}}[A%\n(s,a)]-\\mathbb{E}_{s\\sim d_{\\pi}(s),a\\sim\\pi}[A(s,a)].')
('3.1', 'A(s,a)')
('3.1', '\\pi')
('3.1', 'A_{\\pi}(s,a)')
('3.1', 'f')
('3.1', 'd_{\\tilde{\\pi}}(s)\\tilde{\\pi}(a)-d_{\\pi}(s)\\pi(a)')
('3.1', 'A(s,a)')
('3.1', 'd_{\\tilde{\\pi}}(s)')
('3.1', 'd_{\\tilde{\\pi}}(s)')
('3.1', '\\pi')
('3.1', 'd_{\\pi}(s)')
('3.1', 'G_{\\pi}(\\tilde{\\pi})\\triangleq\\mathbb{E}_{s\\sim d_{\\pi}(s),a\\sim\\pi(\\cdot|s)}%\n\\big{[}\\big{(}\\frac{\\tilde{\\pi}(a|s)}{\\pi(a|s)}-1\\big{)}A(s,a)\\big{]}.')
('3.1', '\\tilde{\\pi}')
('3.1', '\\pi')
('3.1', 'J(\\tilde{\\pi})-J(\\pi)\\geq G_{\\pi}(\\tilde{\\pi})-\\frac{2\\gamma}{1-\\gamma}(\\delta%\n+\\epsilon),\\quad\\text{ where }\\delta=\\max_{s,a}\\left|\\big{(}\\frac{\\tilde{\\pi}(%\na|s)}{\\pi(a|s)}-1\\big{)}A(s,a)\\right|\\text{ and }\\epsilon=\\left|\\sum_{a}\\pi(a|%\ns)A(s,a)\\right|.')
('3.1', '\\big{(}\\frac{\\tilde{\\pi}(a|s)}{\\pi(a|s)}-1\\big{)}')
('3.1', '\\big{(}\\frac{\\tilde{\\pi}(a|s)}{\\pi(a|s)}-1\\big{)}')
('3.1', 'A(s,a)')
('3.1', 'G_{\\pi}(\\tilde{\\pi})')
('3.1', 'G_{\\pi}(\\tilde{\\pi})')
('3.1', 'A(s,a)')
('3.2', 'i=1,2,...')
('3.2', '=1,2,...,N')
('3.2', '\\pi')
('3.2', '\\hat{A}_{\\pi}')
('3.2', '=1,2,...,K')
('3.2', 'M')
('3.2', '\\{(s,a)\\}')
('3.2', '\\mathcal{L}(\\theta)\\triangleq\\frac{1}{M}\\sum\\limits_{s,a}\\min\\Big{(}\\big{(}%\n\\frac{\\tilde{\\pi}_{\\theta}(a|s)}{\\pi(a|s)}-1\\big{)}\\hat{A}_{\\pi}(s,a),\\delta%\n\\Big{)}')
('3.2', '\\mathcal{L}(\\theta)')
('3.2', '\\theta')
('3.2', '\\pi\\leftarrow\\tilde{\\pi}_{\\theta}')
('3.2', 'G_{\\pi}(\\tilde{\\pi})')
('3.2', 'G_{\\pi}(\\tilde{\\pi})')
('3.2', '\\pi')
('3.2', '\\max_{\\theta}\\quad\\mathbb{E}_{(s,a)\\sim d_{\\pi}}\\big{[}\\frac{\\tilde{\\pi}_{%\n\\theta}(s,a)}{\\pi(s,a)}A_{\\pi}(s,a)\\big{]}')
('3.2', 'G_{\\pi}(\\tilde{\\pi})')
('3.2', '\\max_{\\theta}\\quad\\mathbb{E}_{(s,a)\\sim d_{\\pi}}\\big{[}\\mathrm{clip}\\big{(}%\n\\frac{\\tilde{\\pi}_{\\theta}(s,a)}{\\pi(s,a)}-1,-\\lambda,\\lambda\\big{)}A_{\\pi}(s,%\na)\\big{]}')
('3.2', '\\lambda>0')
('3.2', '\\big{(}\\frac{\\tilde{\\pi}_{\\theta}(s,a)}{\\pi(s,a)}-1\\big{)}A_{\\pi}(s,a)')
('3.2', '\\max_{\\theta}\\quad\\mathbb{E}_{(s,a)\\sim d_{\\pi}}\\Big{[}\\min\\Big{(}\\big{(}\\frac%\n{\\tilde{\\pi}_{\\theta}(s,a)}{\\pi(s,a)}-1\\big{)}A_{\\pi}(s,a),\\delta\\Big{)}\\Big{]},')
('3.2', '\\delta>0')
('3.2', '\\delta')
('4', '\\tanh')
('4', '0.01')
('4', '0.01')
('4', '0.0003')
('4', '0')
('4', '\\delta')
('4', '0.01')
('4', '\\frac{\\tilde{\\pi}(a|s)}{\\pi(a|s)}')
('4', '[-2,1]')
('4', '[0,1]')
