('2', '\\mathcal{M}_{G}')
('2', '\\mathcal{M}=\\langle\\mathcal{S},\\mathcal{A},\\mathcal{P},R,\\gamma\\rangle')
('2', '\\langle\\mathcal{G},p_{g},\\Phi\\rangle')
('2', '\\mathcal{M}_{G}')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', '\\mathcal{P}:\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{S}\\rightarrow[0,1]')
('2', '\\gamma')
('2', 'R:\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{G}\\rightarrow\\mathbb{R}')
('2', 'R:\\mathcal{S}\\times\\mathcal{A}\\times\\mathcal{G}\\rightarrow\\mathbb{R}')
('2', 'R(s,a,g)=\\mathds{1}{(}\\Phi(s^{\\prime}\\sim\\mathcal{P}(\\cdot|s,a))=g)')
('2', '\\Phi:\\mathcal{S}\\rightarrow\\mathcal{G}')
('2', 's')
('2', 'g\\in\\mathcal{G}')
('2', '\\pi:\\mathcal{S}\\times\\mathcal{G}\\times\\mathcal{A}\\rightarrow[0,1]')
('2', '\\operatorname*{\\mathbb{E}}_{g\\sim p_{g}}\\left[\\sum_{t=0}^{T-1}\\gamma^{t}R(s_{t%\n},a_{t}\\sim\\pi(\\cdot|s_{t},g),g)\\right].')
('2', 'H')
('2', 'z')
('2', 'H')
('2', '\\tau^{\\text{sub}}')
('2', '\\displaystyle\\tau_{t:t+H}=(s_{t},\\dots,s_{t+H},a_{t},\\dots,a_{t+H-1})=(s_{0:H}%\n,a_{0:H-1})')
('2', '\\displaystyle\\tau_{t:t+H}')
('2', '\\displaystyle=(s_{t},\\dots,s_{t+H},a_{t},\\dots,a_{t+H-1})=(s_{0:H},a_{0:H-1})')
('2', '\\tau')
('2', '\\mathcal{L}_{\\text{skill}}')
('2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{\\tau^{\\text{sub}}\\sim\\tau}\\Bigg{[}%\n\\sum_{i=0}^{H-1}\\underbrace{(\\pi_{\\theta}^{L}\\left(s_{i},z\\right)-a_{i})^{2}}_%\n{\\text{action reconstruction}}+\\underbrace{\\beta\\cdot KL(q_{\\phi}(z|\\tau^{%\n\\text{sub}})||P(z))}_{\\text{regularization}}\\Bigg{]}')
('2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{\\tau^{\\text{sub}}\\sim\\tau}\\Bigg{[}')
('2', '\\displaystyle\\sum_{i=0}^{H-1}\\underbrace{(\\pi_{\\theta}^{L}\\left(s_{i},z\\right)%\n-a_{i})^{2}}_{\\text{action reconstruction}}+\\underbrace{\\beta\\cdot KL(q_{\\phi}%\n(z|\\tau^{\\text{sub}})||P(z))}_{\\text{regularization}}\\Bigg{]}')
('2', 'KL')
('2', 'P(z)\\sim\\mathcal{N}(0,I)')
('2', 'q_{\\phi}')
('2', 'z')
('2', '\\pi_{\\theta}^{L}')
('2', '\\pi(a|s,g)')
('2', '\\pi_{\\theta}^{L}(a|s,z)')
('2', '\\pi_{\\psi}^{Z}(z|s,g)')
('2', '\\pi(a|s,g)=\\pi_{\\theta}^{L}(a|s,z)\\circ\\pi_{\\psi}^{Z}(z|s,g).')
('2', '\\pi_{\\psi}^{Z}')
('2', 'p_{\\theta}')
('2', '\\pi_{\\theta}^{L},\\pi_{\\psi}^{Z}')
('2', 'p_{\\theta}')
('2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{g\\sim p_{g}}\\Bigg{[}\\sum^{T-1}_{t=0}%\n\\Bigg{[}\\sum_{k=tH}^{(t+1)H-1}\\left[R(s_{k},a_{k}\\sim\\pi_{\\theta}^{L}(\\cdot|s_%\n{k},z_{tH}),g)\\right]')
('2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{g\\sim p_{g}}\\Bigg{[}\\sum^{T-1}_{t=0}%\n\\Bigg{[}')
('2', '\\displaystyle\\sum_{k=tH}^{(t+1)H-1}\\left[R(s_{k},a_{k}\\sim\\pi_{\\theta}^{L}(%\n\\cdot|s_{k},z_{tH}),g)\\right]')
('2', '\\displaystyle-KL(\\pi_{\\psi}^{Z}(z_{tH}|s_{tH},g)||p_{\\theta}(z_{tH}|s_{tH}))%\n\\Bigg{]}\\Bigg{]}')
('2', '\\displaystyle-KL(\\pi_{\\psi}^{Z}(z_{tH}|s_{tH},g)||p_{\\theta}(z_{tH}|s_{tH}))%\n\\Bigg{]}\\Bigg{]}')
('2', 'z_{tH}\\sim\\pi_{\\psi}^{Z}(\\cdot|s_{tH},g)')
('2', 'H')
('3', '\\pi_{\\theta}^{L}')
('3', '\\pi_{\\psi}^{Z}')
('3', '\\mathcal{P}_{\\theta}^{-1}')
('3', '\\mathcal{P}_{\\theta}')
('3', '\\mathcal{P}_{\\phi}')
('3', 'q_{\\phi}')
('3', 'p_{\\theta}')
('3', 'E_{\\theta}')
('3', 'D_{\\phi}')
('3', '\\psi')
('3', '\\theta')
('3', '\\phi')
('3', 'q_{\\phi}')
('3', 'D_{\\phi}')
('3.1.1', '\\beta')
('3.1.1', 'z')
('3.1.1', 'q_{\\phi}')
('3.1.1', '\\tau^{\\text{sub}}')
('3.1.1', 'z')
('3.1.1', '\\pi_{\\theta}^{L}')
('3.1.1', 'z')
('3.1.1', 'B=\\{\\tau^{\\text{sub}}_{i}\\}_{i=1}^{N}')
('3.1.1', '\\mathcal{D}')
('3.1.1', 'p_{\\theta}')
('3.1.1', '\\mathcal{L}_{\\text{prior}}')
('3.1.1', '\\displaystyle\\operatorname*{\\mathbb{E}}_{B\\sim\\mathcal{D}}\\left[KL(p_{\\theta}(%\nz|\\textbf{h}_{t})\\>||\\>\\textbf{sg}(q_{\\phi}(z|\\tau^{\\text{sub}})))\\right]')
('3.1.1', '\\displaystyle\\operatorname*{\\mathbb{E}}_{B\\sim\\mathcal{D}}\\left[KL(p_{\\theta}(%\nz|\\textbf{h}_{t})\\>||\\>\\textbf{sg}(q_{\\phi}(z|\\tau^{\\text{sub}})))\\right]')
('3.1.1', '\\textbf{h}_{t}=\\textbf{sg}(E_{\\theta}(s_{t}))')
('3.1.1', 's_{t}')
('3.1.1', '\\tau^{\\text{sub}}')
('3.1.1', 'p_{\\theta}')
('3.1.2', '\\mathcal{P}_{\\theta}')
('3.1.2', '\\mathcal{P}_{\\phi}')
('3.1.2', 'E_{\\theta}')
('3.1.2', '\\mathbb{H}')
('3.1.2', 'D_{\\phi}')
('3.1.2', '\\mathcal{P}_{\\phi}')
('3.1.2', '\\mathcal{P}_{\\theta}')
('3.1.2', 'H')
('3.1.2', '\\mathcal{P}_{\\theta}^{-1}')
('3.1.2', 'h_{0}')
('3.1.2', 'h_{H}')
('3.1.2', '\\mathcal{L}_{\\text{model}}')
('3.1.2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{B\\sim\\mathcal{D}}\\Big{[}\\sum_{k=0}^{H%\n-1}\\big{[}\\underbrace{(D_{\\phi}(h_{t+k})-s_{t+k})^{2}}_{\\text{observation %\nreconstruction}}+\\underbrace{(\\mathcal{P}_{\\phi}(h_{t+k},z)-\\bar{h}_{t+k+1})^{%\n2}}_{\\text{flat dynamics}}\\big{]}')
('3.1.2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{B\\sim\\mathcal{D}}\\Big{[}\\sum_{k=0}^{H%\n-1}\\big{[}\\underbrace{(D_{\\phi}(h_{t+k})-s_{t+k})^{2}}_{\\text{observation %\nreconstruction}}+\\underbrace{(\\mathcal{P}_{\\phi}(h_{t+k},z)-\\bar{h}_{t+k+1})^{%\n2}}_{\\text{flat dynamics}}\\big{]}')
('3.1.2', '\\displaystyle+\\underbrace{(\\mathcal{P}_{\\theta}(h_{t},z)-\\bar{h}_{t+H})^{2}}_{%\n\\text{skill-step dynamics}}+\\underbrace{KL(\\textbf{sg}(z)\\>||\\>\\mathcal{P}_{%\n\\theta}^{-1}(z|\\textbf{h}_{t},\\textbf{h}_{t+H}))}_{\\text{inverse skill-step %\ndynamics}}\\Big{]}')
('3.1.2', '\\displaystyle+\\underbrace{(\\mathcal{P}_{\\theta}(h_{t},z)-\\bar{h}_{t+H})^{2}}_{%\n\\text{skill-step dynamics}}+\\underbrace{KL(\\textbf{sg}(z)\\>||\\>\\mathcal{P}_{%\n\\theta}^{-1}(z|\\textbf{h}_{t},\\textbf{h}_{t+H}))}_{\\text{inverse skill-step %\ndynamics}}\\Big{]}')
('3.1.2', 'h_{t}=E_{\\theta}(s_{t})')
('3.1.2', '\\bar{h}_{t}=E_{\\bar{\\theta}}(s_{t})')
('3.1.2', '\\bar{\\theta}')
('3.1.2', '\\theta')
('3.1.2', 'z=q_{\\phi}(\\tau^{\\text{sub}})')
('3.1.2', 'q_{\\phi}')
('3.1.2', '(h\\in\\mathbb{H})')
('3.1.3', 'p_{\\theta}')
('3.1.3', '\\mathcal{P}_{\\phi}')
('3.1.3', 'h')
('3.1.3', 'z')
('3.1.3', '(s,a)')
('3.1.3', 'D_{\\phi}')
('3.1.3', '\\pi_{\\theta}^{L}')
('3.2', '\\pi_{\\psi}^{Z}')
('3.2', '\\pi_{\\theta}^{L}')
('3.2', 'f_{\\psi}')
('3.2', '\\mathcal{P}_{\\theta}^{-1}')
('3.2', '\\pi_{\\psi}^{Z}(s_{t},g)=\\mathcal{P}_{\\theta}^{-1}(z|\\textbf{h}_{t},\\hat{h}_{t+%\nH})\\circ f_{\\psi}(\\hat{h}_{t+H}|\\textbf{h}_{t},g)\\circ E_{\\theta}(h_{t}|s_{t}).')
('3.2', 's_{t}')
('3.2', 'g')
('3.2', '\\hat{h}_{t+H}')
('3.2', 'z')
('3.2', '\\pi_{\\theta}^{L}')
('3.2', 'z')
('3.2', '\\mathcal{P}_{\\theta}^{-1}')
('3.2', 'f_{\\psi}')
('3.2', '\\mathcal{L}_{\\text{sg}}')
('3.2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{B\\sim\\mathcal{D}}\\bigg{[}\\underbrace{%\n\\left(\\bar{h}_{t+H}-f_{\\psi}(\\textbf{h}_{t},g)\\right)^{2}}_{\\text{behavior %\ncloning}}+\\underbrace{\\left(f_{\\psi}(\\textbf{h}_{t},g)-\\mathcal{P}_{\\theta}(%\n\\textbf{h}_{t},\\hat{z})\\right)^{2}}_{\\text{sanity check}}\\bigg{]}')
('3.2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{B\\sim\\mathcal{D}}\\bigg{[}\\underbrace{%\n\\left(\\bar{h}_{t+H}-f_{\\psi}(\\textbf{h}_{t},g)\\right)^{2}}_{\\text{behavior %\ncloning}}+\\underbrace{\\left(f_{\\psi}(\\textbf{h}_{t},g)-\\mathcal{P}_{\\theta}(%\n\\textbf{h}_{t},\\hat{z})\\right)^{2}}_{\\text{sanity check}}\\bigg{]}')
('3.2', '\\bar{h}_{t+H}=E_{\\bar{\\theta}}(s_{t+H})')
('3.2', '\\hat{z}\\sim\\mathcal{P}_{\\theta}^{-1}(\\cdot|\\textbf{h}_{t},f_{\\psi}(h_{t},g))')
('3.3', '\\mathcal{L}=\\mathcal{L}_{\\text{skill}}\\ +\\mathcal{L}_{\\text{prior}}+\\mathcal{L%\n}_{\\text{model}}+\\mathcal{L}_{\\text{sg}}')
('3.4', 'f_{\\psi}')
('3.4', 'f_{\\psi}')
('3.4', '\\displaystyle\\mathbb{E}_{B^{\\prime}}\\bigg{[}\\underbrace{-Q(\\textbf{h}_{t},\\pi_%\n{\\psi}^{Z}(\\textbf{h}_{t},g))}_{\\text{reward maximization}}+\\alpha\\cdot%\n\\underbrace{KL(\\pi_{\\psi}^{Z}(z|\\textbf{h}_{t},g)||p_{\\theta}(z|\\textbf{h}_{t}%\n))}_{\\text{prior regularization}}')
('3.4', '\\displaystyle\\mathbb{E}_{B^{\\prime}}\\bigg{[}')
('3.4', '\\displaystyle\\underbrace{-Q(\\textbf{h}_{t},\\pi_{\\psi}^{Z}(\\textbf{h}_{t},g))}_%\n{\\text{reward maximization}}+\\alpha\\cdot\\underbrace{KL(\\pi_{\\psi}^{Z}(z|%\n\\textbf{h}_{t},g)||p_{\\theta}(z|\\textbf{h}_{t}))}_{\\text{prior regularization}}')
('3.4', '\\displaystyle+\\underbrace{\\left(\\mathcal{P}_{\\theta}(h_{t+H}|\\textbf{h}_{t},%\n\\pi_{\\psi}^{Z}(\\textbf{h}_{t},g))-f_{\\psi}(h_{t+H}|\\textbf{h}_{t},g)\\right)^{2%\n}}_{\\text{state consistency regularization}}\\bigg{]}')
('3.4', '\\displaystyle+\\underbrace{\\left(\\mathcal{P}_{\\theta}(h_{t+H}|\\textbf{h}_{t},%\n\\pi_{\\psi}^{Z}(\\textbf{h}_{t},g))-f_{\\psi}(h_{t+H}|\\textbf{h}_{t},g)\\right)^{2%\n}}_{\\text{state consistency regularization}}\\bigg{]}')
('3.4', '\\textbf{h}_{t}=\\textbf{sg}(E_{\\theta}(s_{t}))')
('3.4', 'B^{\\prime}')
('3.4', '(s_{t},z,s_{t+H})')
('3.4', 'f_{\\psi}(h_{t+H}|\\textbf{h}_{t},g)')
('3.4', '\\theta')
('3.4', '\\phi')
('3.4', 'f_{\\psi}')
('4.1', '\\begin{cases}\\mathbb{I}\\left[(\\Phi(s)-g)^{2}\\leq 1\\right]\\times 100&\\text{for %\nmaze},\\\\\n(\\text{achieved\\_obj}/\\text{target\\_obj})\\times 100&\\text{for kitchen}\\end{cases}')
('4.1', '\\Phi')
('4.1', 's')
('4.1', 'g')
('4.1', '73.7\\pm 2.0')
('4.1', '46.2\\pm 4.1')
('4.1', '23.4\\pm 6.4')
('4.1', '98.8\\pm 1.1')
('4.1', '\\textbf{100.0}\\pm\\textbf{0.0}')
('4.1', '33.3\\pm 4.0')
('4.1', '15.2\\pm 10.9')
('4.1', '26.9\\pm 3.0')
('4.1', '74.9\\pm 1.1')
('4.1', '\\textbf{89.5}\\pm\\textbf{2.0}')
('4.1', '12.6\\pm 5.2')
('4.1', '14.4\\pm 3.6')
('4.1', '23.2\\pm 5.2')
('4.1', '74.0\\pm 2.5')
('4.1', '\\textbf{84.2}\\pm\\textbf{7.3}')
('4.1', '5.3\\pm 3.9')
('4.1', '1.3\\pm 1.3')
('4.1', '15.8\\pm 3.9')
('4.1', '32.5\\pm 8.7')
('4.1', '\\textbf{66.7}\\pm\\textbf{7.0}')
('4.1', '35.9\\pm 4.8')
('4.1', '69.6\\pm 1.1')
('4.1', '49.1\\pm 2.5')
('4.1', '66.6\\pm 7.5')
('4.1', '\\textbf{98.7}\\pm\\textbf{1.3}')
('4.1', '0.0\\pm 0.0')
('4.1', '44.7\\pm 1.8')
('4.1', '26.2\\pm 8.5')
('4.1', '54.8\\pm 5.7')
('4.1', '\\textbf{88.6}\\pm\\textbf{1.3}')
('4.1', '0.2\\pm 0.2')
('4.1', '31.4\\pm 0.8')
('4.1', '31.2\\pm 1.7')
('4.1', '47.7\\pm 4.3')
('4.1', '\\textbf{86.8}\\pm\\textbf{1.7}')
('4.1', '0.4\\pm 0.2')
('4.1', '18.3\\pm 1.0')
('4.1', '28.7\\pm 7.0')
('4.1', '41.7\\pm 5.2')
('4.1', '\\textbf{72.2}\\pm\\textbf{3.4}')
('4.2', '14.6')
('4.2', '20.2')
('4.2', '34.2')
('4.2', '33.8')
('4.2', '39.1')
('4.2', '30.5')
('4.2', '7.5\\pm 5.2')
('4.2', '16.2\\pm 12.0')
('4.2', '\\textbf{67.1}\\pm\\textbf{14.4}')
('4.2', '3.9\\pm 0.0')
('4.2', '15.8\\pm 6.5')
('4.2', '\\textbf{74.1}\\pm\\textbf{5.7}')
('4.2', '15.8\\pm 15.5')
('4.2', '40.8\\pm 15.5')
('4.2', '\\textbf{73.7}\\pm\\textbf{5.7}')
('4.2', '46.1\\pm 27.8')
('4.2', '61.0\\pm 11.9')
('4.2', '\\textbf{76.3}\\pm\\textbf{5.5}')
('4.2', '23.4\\pm 1.7')
('4.2', '18.6\\pm 5.4')
('4.2', '\\textbf{68.0}\\pm\\textbf{5.9}')
('4.2', '24.4\\pm 2.9')
('4.2', '20.3\\pm 2.5')
('4.2', '\\textbf{78.4}\\pm\\textbf{4.2}')
('4.2', '22.8\\pm 3.1')
('4.2', '34.8\\pm 1.0')
('4.2', '\\textbf{83.5}\\pm\\textbf{8.8}')
('4.2', '25.1\\pm 2.8')
('4.2', '54.2\\pm 4.2')
('4.2', '\\textbf{92.5}\\pm\\textbf{2.3}')
('4.3', '50.9')
('4.3', '58.3')
('4.3', '49.4')
('4.3', '58.1')
('4.3', '32.9')
('4.3', '15.3')
('4.3', '48.7')
('4.3', '38.3')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\phi}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '78.4\\pm 2.0')
('4.4', '77.6\\pm 4.2')
('4.4', '\\textbf{88.6}\\pm\\textbf{1.3}')
('4.4', '64.7\\pm 1.5')
('4.4', '48.9\\pm 3.3')
('4.4', '\\textbf{86.8}\\pm\\textbf{1.7}')
('4.4', '57.7\\pm 2.9')
('4.4', '51.9\\pm 6.7')
('4.4', '\\textbf{72.2}\\pm\\textbf{3.4}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', 'H')
('4.4', 'H')
('4.4', 'H=10')
('4.4', 'H')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', 'H=40')
('4.4', '\\mathcal{P}_{\\theta}')
('4.4', 'f_{\\psi}')
('4.4', '44.8\\pm 1.4')
('4.4', '92.8\\pm 1.9')
('4.4', '\\textbf{98.7}\\pm\\textbf{1.3}')
('4.4', '90.1\\pm 3.0')
('4.4', '41.4\\pm 1.5')
('4.4', '87.4\\pm 1.0')
('4.4', '\\textbf{88.6}\\pm\\textbf{1.3}')
('4.4', '76.9\\pm 1.1')
('4.4', '32.1\\pm 3.1')
('4.4', '78.8\\pm 1.1')
('4.4', '\\textbf{86.8}\\pm\\textbf{1.7}')
('4.4', '65.8\\pm 2.0')
('4.4', '29.5\\pm 1.6')
('4.4', '66.7\\pm 0.5')
('4.4', '\\textbf{72.2}\\pm\\textbf{3.4}')
('4.4', '60.2\\pm 2.5')
('4.4', 'H')
('4.4', 'H')
('4.4', 'f_{\\psi}')
('4.4', 'f_{\\psi}')
('4.4', 'f_{\\psi}')
('4.4', '52.3\\pm 8.3')
('4.4', '57.3\\pm 7.6')
('4.4', '\\textbf{68.0}\\pm\\textbf{5.9}')
('4.4', '56.0\\pm 10.9')
('4.4', '62.1\\pm 8.9')
('4.4', '\\textbf{78.4}\\pm\\textbf{4.2}')
('4.4', '58.9\\pm 5.0')
('4.4', '60.2\\pm 5.9')
('4.4', '\\textbf{83.5}\\pm\\textbf{8.8}')
('4.4', '63.9\\pm 17.1')
('4.4', '70.8\\pm 4.6')
('4.4', '\\textbf{92.5}\\pm\\textbf{2.3}')
('4.4', '\\pi_{\\psi}^{Z}')
('4.4', 'z')
('4.4', '\\pi_{\\psi}^{Z}')
('4.4', 'f_{\\psi}')
('4.4', '95.6\\pm 0.8')
('4.4', '85.5\\pm 2.4')
('4.4', '\\textbf{98.7}\\pm\\textbf{1.3}')
('4.4', '87.7\\pm 0.5')
('4.4', '75.4\\pm 2.3')
('4.4', '\\textbf{88.6}\\pm\\textbf{1.3}')
('4.4', '75.7\\pm 3.2')
('4.4', '58.2\\pm 4.6')
('4.4', '\\textbf{86.8}\\pm\\textbf{1.7}')
('4.4', '67.3\\pm 4.0')
('4.4', '50.0\\pm 0.5')
('4.4', '\\textbf{72.2}\\pm\\textbf{3.4}')
