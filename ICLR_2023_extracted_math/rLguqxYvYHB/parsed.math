('2', 'A')
('2', 'a')
('2', '\\mathcal{A}')
('2', 'P')
('2.0', 'A \\in \\mathcal{A}')
('2.0', 'Y \\in \\mathcal{Y} \\subseteq [-R, R]')
('2.0', 'a')
('2.0', 'Y^{(a)} \\in \\mathcal{Y}')
('2.0', 'Y = Y^{(a)}')
('2.0', 'A=a')
('2.0', 'U \\in \\mathcal{U}')
('2.0', '\\forall a\\in\\mathcal{A},~ Y^{(a)} \\mathop{\\perp\\!\\!\\!\\perp}A | U')
('2.0', 'O \\in \\mathcal{O}')
('2.0', '\\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{}\\left[Y^{(a)}\\right]')
('2.0', 'A=a')
('2.0', "\\theta_\\mathrm{ATT}(a; a') = \\mathbb{E}_{}\\left[Y^{(a)}|A=a'\\right]")
('2.0', 'A=a')
('2.0', "A=a'")
('2.0', 'U')
('2.0', "\\begin{aligned}\n        \\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{U}\\left[\\mathbb{E}_{}\\left[Y|A=a, U\\right]\\right], ~ \\theta_\\mathrm{ATT}(a; a') = \\mathbb{E}_{U}\\left[\\mathbb{E}_{}\\left[Y|A=a, U\\right]|A=a'\\right].\n    \n\\end{aligned}")
('2.0', 'O')
('2.0', 'O=o')
('2.0', 'U')
('2.0', '(A,Y)')
('2.0.0', 'X \\in \\mathcal{X}')
('2.0.0', 'U')
('2.0.0', 'A')
('2.0.0', '(A,Y,X)')
('2.0.0', 'X')
('2.0.0', "\\begin{aligned}\n        \\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{X}\\left[ g(a, X)\\right], ~ \\theta_\\mathrm{ATT}(a; a') = \\mathbb{E}_{X}\\left[g(a, X)|A=a'\\right],\n    \n\\end{aligned}")
('2.0.0', 'g(a,x) = \\mathbb{E}_{}\\left[Y|A=a, X=x\\right]')
('2.0.0', 'X')
('2.0.0', 'U')
('2.0.0.0', 'M\\in \\mathcal{M}')
('2.0.0.0', 'A')
('2.0.0.0', 'Y')
('2.0.0.0', 'M')
('2.0.0.0', "\\begin{aligned}\n        \\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{A'}\\left[\\mathbb{E}_{M}\\left[g(A', M)|A=a\\right]\\right], ~ \\theta_\\mathrm{ATT}(a; a') = \\mathbb{E}_{M}\\left[g(a', M)|A=a\\right],\n    \n\\end{aligned}")
('2.0.0.0', 'g(a,m) = \\mathbb{E}_{}\\left[Y|A=a, M=m\\right]')
('2.0.0.0', "A' \\in \\mathcal{A}")
('2.0.0.0', 'A')
('3.0', 'g = \\mathbb{E}_{}\\left[Y|A=a, X=x\\right]')
('3.0', 'g')
('3.0', 'g(a,x)')
('3.0', '(A,X)')
('3.0', 'Y')
('3.0', 'g(a,x) = \\bm{w}^\\top (\\bm{\\phi}_A(a) \\otimes \\bm{\\phi}_X(x))')
('3.0', '\\bm{\\phi}_A: \\mathcal{A}\\to\\mathbb{R}^{d_1}, \\bm{\\phi}_X: \\mathcal{X}\\to\\mathbb{R}^{d_2}')
('3.0', '\\bm{w} \\in \\mathbb{R}^{d_1d_2}')
('3.0', '\\otimes')
('3.0', '\\bm{a} \\otimes \\bm{b} = \\mathrm{vec}(\\bm{a}\\bm{b}^\\top)')
('3.0', '\\{(a_i, y_i, x_i)\\}^n_{i=1} \\sim P')
('3.0', 'n')
('3.0', '\\bm{\\phi}_A, \\bm{\\phi}_X')
('3.0', '\\bm{w}')
('3.0', '\\begin{aligned}\n\\hat{\\mathcal{L}}_1(\\bm{w}, \\bm{\\phi}_A, \\bm{\\phi}_X) = \\frac1n \\sum_{i=1}^n (y_i - \\bm{w}^\\top (\\bm{\\phi}_A(a_i) \\otimes \\bm{\\phi}_X(x_i)))^2. \\label{eq:stage1}\n\\end{aligned}')
('3.0', '\\lambda\\|\\bm{w}\\|^2')
('3.0', '\\hat{\\mathcal{L}}_1')
('3.0', '\\hat{\\bm{w}}, \\hat{\\bm{\\phi}}_A, \\hat{\\bm{\\phi}}_Z = \\mathop{\\mathrm{arg\\,min}}\\hat{\\mathcal{L}}_1')
('3.0', '\\hat{g}(a,x) = \\hat{\\bm{w}}^\\top (\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{\\phi}}_X(x))')
('3.0', '\\hat{g}')
('3.0', 'g')
('3.0', "\\begin{aligned}\n    \\theta_{\\mathrm{ATE}}(a) \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right]\\right),~ \\theta_{\\mathrm{ATT}}(a; a') \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\middle|A=a'\\right]\\right).\n\\end{aligned}")
('3.0', 'g(a,x) = \\bm{w}^\\top (\\bm{\\phi}_A(a) \\otimes \\bm{\\phi}_X(x))')
('3.0', "\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)],~\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)|A=a']")
('3.0', '\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)]')
('3.0', '\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)] \\simeq \\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_X(x_i).')
('3.0', "\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)|A=a']")
('3.0', 'A')
('3.0', '\\hat{\\bm{\\phi}}_X(X)')
('3.0', "\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)|A=a']")
('3.0', "\\hat{\\bm{f}}_{\\bm{\\phi}_X}(a')")
('3.0', '\\hat{\\bm{f}}_{\\bm{\\phi}_X}: \\mathcal{A} \\to \\mathbb{R}^{d_2}')
('3.0', '\\begin{aligned}\n    \\hat{\\bm{f}}_{\\bm{\\phi}_X} = \\mathop{\\mathrm{arg\\,min}}_{\\bm{f}: \\mathcal{A} \\to \\mathbb{R}^{d_2}} \\hat{\\mathcal{L}}_2(\\bm{f}; \\bm{\\phi}_X), \\quad \\hat{\\mathcal{L}}_2(\\bm{f}; \\bm{\\phi}_X) = \\frac1n \\sum_{i=1}^n \\|\\bm{\\phi}_X(x_i) - \\bm{f}(a_i)\\|^2. \\label{eq:stage2-backdoor}\n\\end{aligned}')
('3.0', '\\|\\cdot\\|')
('3.0', '\\mathcal{L}_2')
('3.0', '\\bm{f}')
('3.0', "\\begin{aligned}\n    \\hat{\\theta}_\\mathrm{ATE}(a) = \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_X(x_i) \\right), \\quad \\hat{\\theta}_\\mathrm{ATT}(a; a') =\\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X}(a') \\right)\n\\end{aligned}")
('3.0', '\\hat{\\theta}_\\mathrm{ATE}')
('3.0', '\\hat{\\theta}_\\mathrm{ATE}= \\frac1n \\sum_{i=1}^n \\hat{g}(a, x_i)')
('3.0', 'g(a,z) = \\bm{w}^\\top (\\bm{\\phi}_A(a) \\otimes \\bm{\\phi}_X(x))')
('3.0.0', '\\{(a_i, y_i, m_i)\\}_{i=1}^n')
('3.0.0', '\\hat{g}(a,m) = \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{\\phi}}_M(m)\\right)')
('3.0.0', '\\begin{aligned}\n    \\hat{\\bm{w}}, \\hat{\\bm{\\phi}}_A,  \\hat{\\bm{\\phi}}_M = \\mathop{\\mathrm{arg\\,min}}\\frac1n \\sum_{i=1}^n (y_i - \\bm{w}^\\top (\\bm{\\phi}_A(a_i) \\otimes \\bm{\\phi}_M(m_i)))^2,\n\\end{aligned}')
('3.0.0', '\\bm{\\phi}_M: \\mathcal{M} \\to \\mathbb{R}^{d_2}')
('3.0.0', "\\begin{aligned}\n        &\\theta_{\\mathrm{ATE}}(a) \\simeq \\hat{\\bm{w}}^\\top \\left(\\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_A(A)\\right] \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_M(M)\\middle| A=a\\right]\\right),\\\\\n        &\\theta_{\\mathrm{ATT}}(a; a') \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a') \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_M(M)\\middle| A=a\\right]\\right).\n\\end{aligned}")
('3.0.0', '\\mathbb{E}[\\hat{\\bm{\\phi}}_A(A)]')
('3.0.0', '\\mathbb{E}[\\hat{\\bm{\\phi}}_M(M)|A=a]')
('3.0.0', "\\begin{aligned}\n    \\hat{\\theta}_\\mathrm{ATE}(a) = \\hat{\\bm{w}}^\\top \\left( \\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_A(a_i)  \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}(a) \\right), \\quad \\hat{\\theta}_\\mathrm{ATT}(a; a') =\\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a') \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}(a) \\right),\n\\end{aligned}")
('3.0.0', '\\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}')
('3.0.0', '\\mathcal{L}_2')
('3.0.0', '\\begin{aligned}\n    \\hat{\\mathcal{L}}_2 =  \\frac1n \\sum_{i=1}^n \\|\\bm{\\phi}_M(m_i) - \\bm{f}(a_i)\\|^2.\n\\end{aligned}')
('4', 'g')
('4.0', 'g')
('4.0', '\\begin{aligned}\n        \\mathcal{H}_g = \\{\\bm{w}^\\top (\\bm{\\phi}_A(a) \\otimes \\bm{\\phi}_Z(z)) ~|~\\bm{w} &\\in \\mathbb{R}^{d_1d_2},\\bm{\\phi}_A(a)\\in \\mathbb{R}^{d_1}, \\bm{\\phi}_Z(z)\\in \\mathbb{R}^{d_2}, \\\\\n        & \\|\\bm{w}\\|_1 \\leq R,~\\max_{a\\in \\mathcal{A}} \\|\\bm{\\phi}_A(a)\\|_\\infty \\leq 1,~\\max_{z\\in \\mathcal{Z}} ~\\|\\bm{\\phi}_Z(z)\\|_\\infty \\leq 1\\}.\n\\end{aligned}')
('4.0', '\\ell_1')
('4.0', '\\bm{b} \\in \\mathbb{R}^d')
('4.0', '\\|\\bm{b}\\|_1 = \\sum_{i=1}^d |b_i|')
('4.0', '\\|\\bm{b}\\|_\\infty = \\max_{i\\in[d]} b_i')
('4.0', '\\|\\bm{\\phi}_A(a) \\otimes \\bm{\\phi}_Z(z)\\|_\\infty \\leq \\|\\bm{\\phi}_A(a)\\|_\\infty\\|\\bm{\\phi}_Z(z)\\|_\\infty')
('4.0', 'h(a,z) \\in [-R, R]')
('4.0', 'h \\in \\mathcal{H}_g')
('4.0', '\\hat{g}')
('4.0', 'S = \\{a_i, y_i, x_i\\}_{i=1}^n')
('4.0', '\\hat{\\mathcal{L}}_1')
('4.0', '\\hat{g} = \\mathop{\\mathrm{arg\\,min}}\\hat{\\mathcal{L}}_1')
('4.0', 'g')
('4.0', 'g \\in \\mathcal{H}_g')
('4.0', '1-2\\delta')
('4.0', '\\begin{aligned}\n    \\|g - \\hat{g}\\|_{P(A,X)} \\leq \\sqrt{16R\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) + 8R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}},\n\\end{aligned}')
('4.0', '\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g)')
('4.0', '\\mathcal{H}_g')
('4.0', 'S')
('4.0', '\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g)')
('4.0', '\\begin{aligned}\n        \\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) \\leq O(C^L/\\sqrt{n})\n    \n\\end{aligned}')
('4.0', 'C')
('4.0', 'L')
('4.0', '\\bm{\\phi}_A, \\bm{\\phi}_X')
('4.0.0', '\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)]')
('4.0.0', "\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)|A=a']")
('4.0.0', '\\{x_i\\}_{i=1}^n')
('4.0.0', '\\hat{\\bm{\\phi}}_X')
('4.0.0', '1-\\delta')
('4.0.0', '\\begin{aligned}\n        \\left\\|\\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right] - \\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_X(x_i) \\right\\|_\\infty \\leq \\sqrt{\\frac{2\\log ({2d_2}/{\\delta})}{n}}.\n    \n\\end{aligned}')
('4.0.0', "\\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)|A=a']")
('4.0.0', '\\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X} = \\mathop{\\mathrm{arg\\,min}}_{\\bm{f}} \\hat{\\mathcal{L}}_2(\\bm{f}; \\hat{\\bm{\\phi}}_X)')
('4.0.0', '\\mathcal{H}_{\\bm{f}}')
('4.0.0', '\\begin{aligned}\n        \\mathcal{H}_{\\bm{f}} = \\{a \\in \\mathcal{A} \\to (f_1(a), \\dots, f_{d_2}(a))^\\top \\in [-1, 1]^{d_2}~|~ f_1, \\dots, f_{d_2} \\in \\mathcal{H}_{f}\\},\n    \n\\end{aligned}')
('4.0.0', '\\mathcal{H}_f')
('4.0.0', 'f:\\mathcal{Z}\\to[-1, 1]')
('4.0.0', '\\bm{f}^*_{\\hat{\\bm{\\phi}}_X}(a) = \\mathbb{E}[\\hat{\\bm{\\phi}}_X(X)| A=a]')
('4.0.0', '\\bm{f}^*_{\\hat{\\bm{\\phi}}_X} \\in \\mathcal{H}_{\\bm{f}}')
('4.0.0', '\\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X} = \\mathop{\\mathrm{arg\\,min}}_{\\bm{f} \\in \\mathcal{H}_{\\bm{f}}} \\hat{\\mathcal{L}}_2(\\bm{f}; \\hat{\\bm{\\phi}}_X)')
('4.0.0', 'S = \\{(a_i,x_i)\\}')
('4.0.0', '\\bm{f}^*_{\\hat{\\bm{\\phi}}_X} = (f_1^*,\\dots, f_{d_2}^*)^\\top, \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X} = (\\hat{f}_1,\\dots, \\hat{f}_{d_2})^\\top')
('4.0.0', '\\begin{aligned}\n   \\max_{i \\in [d_2]} \\left\\| f^*_i(A) - \\hat{f}_i(A) \\right\\|_{P(A)}  \\leq \\sqrt{16\\hat{\\mathfrak{R}}_S(\\mathcal{H}_f) + 8\\sqrt{\\frac{\\log (2d_2/\\delta)}{2n}}}\n    \n\\end{aligned}')
('4.0.0', '1-2\\delta')
('4.0.0', '\\hat{\\mathfrak{R}}_S(\\mathcal{H}_f)')
('4.0.0', '\\mathcal{H}_f')
('4.0.0', 'S')
('4.0.0', '\\mathcal{H}_f')
('4.0.0', 'O(1/\\sqrt{n})')
('4.0.0.0', '\\ell_2')
('4.0.0.0', 'h_1, h_2 \\in \\mathcal{H}_g')
('4.0.0.0', 'c > 0')
('4.0.0.0', '\\beta')
('4.0.0.0', '\\begin{aligned}\n         \\sup_{a \\in \\mathcal{A}, x \\in \\mathcal{X}} |h_1(a,x) - h_2(a,x)| \\leq \\frac1c \n         \\|h_1(A,X) - h_2(A,X)\\|^{\\frac{1}{\\beta}}_{P(A,X)} .\n    \n\\end{aligned}')
('4.0.0.0', '\\mathcal{A} \\times \\mathcal{X}')
('4.0.0.0', '\\beta=1')
('4.0.0.0', 'c = \\min_{ (a,x) \\in \\mathcal{A} \\times \\mathcal{X}} P(A=a, X=x)')
('4.0.0.0', '\\beta = \\frac{2d + 2}{2}')
('4.0.0.0', '\\mathcal{A}, \\mathcal{X}')
('4.0.0.0', 'd')
('4.0.0.0', 'P(A, X)')
('4.0.0.0', '\\mathcal{H}_g')
('4.0.0.0', '1-4\\delta')
('4.0.0.0', '\\begin{aligned}\n        \\sup_{a\\in\\mathcal{A}}|\\theta_\\mathrm{ATE}(a) - \\hat{\\theta}_\\mathrm{ATE}(a)| &\\leq O\\left(n^{-\\frac{1}{4\\beta}}\\right).\n    \n\\end{aligned}')
('4.0.0.0', '\\bm{f}=(f_1,\\dots,f_{d_2})^\\top')
('4.0.0.0', '\\tilde{\\bm{f}}=(\\tilde{f}_1,\\dots,\\tilde{f}_{d_2})^\\top')
('4.0.0.0', '\\mathcal{H}_{\\bm{f}}')
('4.0.0.0', "\\begin{aligned}\n    \\sup_{a \\in \\mathcal{A}} \\|\\bm{f}(a) - \\tilde{\\bm{f}}(a)\\|_\\infty \\leq \\frac1{c'} \\left(\\max_{i \\in [d_2]} \\left\\| f_i(A) - \\tilde{f}_i(A) \\right\\|_{P(A)}\\right)^{\\frac{1}{\\beta'}},\n    \n\\end{aligned}")
('4.0.0.0', '1-4\\delta')
('4.0.0.0', "\\begin{aligned}\n        \\sup_{a,a'\\in\\mathcal{A}}|\\theta_\\mathrm{ATT}(a; a') - \\hat{\\theta}_\\mathrm{ATT}(a; a')| &\\leq O\\left(n^{-\\frac{1}{4\\beta}} + n^{-\\frac{1}{4\\beta'}}\\right).\n    \n\\end{aligned}")
('4.0.0.0', 'O(n^{-1/4})')
('4.0.0.0', 'g')
('5', 'P(X)')
('5', 'P(X|A)')
('5', 'm')
('5', 'g')
('5', '\\theta = \\mathbb{E}_{}\\left[m(g,(A,X))\\right]')
('5', 'm(g,(A,X)) = g(a,X)')
('5', '\\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{}\\left[g(a,X)\\right]')
('5', 'g')
('5', '\\alpha')
('5', '\\mathbb{E}_{}\\left[m(g,(A,X))\\right] = \\mathbb{E}_{}\\left[\\alpha(A,X)g(A,X)\\right]')
('5', '\\alpha')
('5', 'a')
('5', '\\alpha')
('6.0', '\\hat{\\mathcal{L}}_1')
('6.0', '\\begin{aligned}\n    \\hat{\\mathcal{L}}_1(\\bm{w}, \\bm{\\phi}_A, \\bm{\\phi}_X) = \\frac1n \\sum_{i=1}^n (y_i - \\bm{w}^\\top (\\bm{\\phi}_A(a_i) \\otimes \\bm{\\phi}_X(x_i)))^2 + \\lambda\\|\\bm{w}\\|^2.\n\\end{aligned}')
('6.0', '\\hat{\\mathcal{L}}_1')
('6.0', '(\\bm{w}, \\bm{\\phi}_A, \\bm{\\phi}_X)')
('6.0', '\\bm{w}')
('6.0', '\\bm{\\phi}_A, \\bm{\\phi}_X')
('6.0', '\\bm{w}')
('6.0', '\\begin{aligned}\n    \\hat{\\bm{w}}(\\bm{\\phi}_A, \\bm{\\phi}_X) = \\left(\\frac1n \\sum_{i=1}^n (\\bm{\\phi}_{A,X}(a_i, x_i))(\\bm{\\phi}_{A,X}(a_i, x_i))^\\top +\\lambda I\\right)^{-1} \\frac1n \\sum_{i=1}^n y_i\\bm{\\phi}_{A,X}(a_i, x_i),\n\\end{aligned}')
('6.0', '\\bm{\\phi}_{A,X}(a,x) = \\bm{\\phi}_{A}(a) \\otimes \\bm{\\phi}_{Z}(a)')
('6.0', '\\begin{aligned}\n    \\hat{\\bm{\\phi}}_A, \\hat{\\bm{\\phi}}_X = \\mathop{\\mathrm{arg\\,min}}_{\\bm{\\phi}_A, \\bm{\\phi}_X}   \\hat{\\mathcal{L}}_1\\left(\\hat{\\bm{w}}(\\bm{\\phi}_A, \\bm{\\phi}_X), \\bm{\\phi}_A, \\bm{\\phi}_X\\right)\n\\end{aligned}')
('6.1', '\\pm')
('6.1', '\\pm')
('6.1', '\\pm')
('6.1', '\\pm')
('6.1', '\\pm')
('6.1', '\\pm')
('6.1', '\\pm')
('6.1', 'g')
('6.1', '\\alpha')
('6.1', '\\hat{g}, \\hat{\\alpha}')
('6.1', '\\begin{aligned}\n    \\mathrm{Direct:} ~\\mathbb{E}_{}\\left[m(\\hat{g},(A,X))\\right], \\mathrm{IPW:} ~\\mathbb{E}_{}\\left[Y\\hat{\\alpha}(A,X)\\right],\n     \\mathrm{DR:}~ \\mathbb{E}_{}\\left[m(\\hat{g},(A,X))\\!+\\!\\hat{\\alpha}(A,X)(Y\\!-\\!\\hat{g}(A,X))\\right],\n\\end{aligned}')
('6.1', 'm')
('6.1', 'g')
('6.1', 'm')
('6.1', '\\pm')
('6.1', '\\pm')
('6.2', '\\times')
('6.2', '\\mathtt{shape}')
('6.2', '\\mathtt{scale}')
('6.2', '\\mathtt{rotation}')
('6.2', '\\mathtt{posX}')
('6.2', '\\mathtt{posY}')
('6.2', '\\mathtt{shape}')
('6.2', '\\mathtt{scale}')
('6.2', '\\mathtt{rotation}')
('6.2', '\\mathtt{posX} \\in [0, 1]')
('6.2', '\\mathtt{posY} \\in [0, 1]')
('6.2.0', 'U_1, U_2 \\sim \\mathrm{Unif}(-1, 1)')
('6.2.0', 'X_1 = U_1 + \\varepsilon_1, X_2 = U_2 + \\varepsilon_2')
('6.2.0', '\\varepsilon_1, \\varepsilon_2 \\sim \\mathcal{N}(0, 0.09)')
('6.2.0', 'A')
('6.2.0', '\\mathtt{posX} = (X_1 + 1.5) / 3.0, \\mathtt{posY} = (X_2 + 1.5) / 3.0')
('6.2.0', '\\mathcal{N}(0, 0.01)')
('6.2.0', '\\begin{aligned}\n    Y = \\frac{h^2(A)}{100} + (U_1 + U_2) + \\varepsilon_Y, \\quad h(A) = \\sum_{i,j=1}^{64} \\frac{(i-1)}{64} \\frac{(j-1)}{64} A_{[ij]}\n\\end{aligned}')
('6.2.0', 'A_{[ij]}')
('6.2.0', '(i,j)')
('6.2.0', '\\varepsilon_Y')
('6.2.0', '\\varepsilon_Y \\sim \\mathcal{N}(0, 0.25)')
('6.2.0', '(Y,A,X_1,X_2)')
('6.2.0', '\\theta_\\mathrm{ATE}(a) = h^2(A)/100')
('6.2.0', '(\\theta_\\mathrm{ATE}(a) - \\hat{\\theta}_\\mathrm{ATE}(a))^2')
('6.2.0', 'a')
('6.2.0', '\\alpha')
('6.2.0', '\\hat{g}')
('6.2.0', '\\hat{\\alpha}')
('6.2.0.0', 'U_1, U_2 \\sim \\mathrm{Unif}(-1.5, 1.5)')
('6.2.0.0', '\\mathtt{posX} = (X_1 + 1.5) / 3.0, \\mathtt{posY} = (X_2 + 1.5) / 3.0')
('6.2.0.0', '\\mathcal{N}(0, 0.01)')
('6.2.0.0', 'M = h(A) + \\varepsilon_M')
('6.2.0.0', 'M')
('6.2.0.0', '\\varepsilon_M\\sim\\mathcal{N}(0, 0.04)')
('6.2.0.0', '\\begin{aligned}\n    Y = \\frac{M^2}{100} + 5(U_1 + U_2) + \\varepsilon_Y, \\quad \\varepsilon_Y \\sim \\mathcal{N}(0, 0.25)\n\\end{aligned}')
('6.2.0.0', "\\theta_\\mathrm{ATT}(a; a')")
('6.2.0.0', 'a')
('6.2.0.0', "a'")
('6.2.0.0', '\\mathtt{posX}=0.6, \\mathtt{posY}=0.6')
('7', '\\nabla_a \\theta_\\mathrm{ATE}(a)')
('8.0', 'Z \\in \\mathcal{Z}')
('8.0', 'P(Z)')
('8.0', '\\mathcal{Z} \\subset [0, 1]^d')
('8.0', 'L')
('8.0', 'h')
('8.0', 'h(z) \\in [-R, R]')
('8.0', '\\begin{aligned}\n        \\max_{z \\in \\mathcal{Z}} |h(z)| \\leq \\left(\\frac{4}{c}\\right)^{\\frac{1}{d+2}}(2R + 2\\sqrt{d}L)^\\frac{d}{d+2} \\|h\\|^{\\frac{2}{d+2}}_{P(Z)}\n    \n\\end{aligned}')
('8.0', 'f(z)')
('8.0', 'f(z) \\geq \\varepsilon > 0')
('8.0', '\\mathcal{Z}')
('8.0', 'z^*')
('8.0', '\\begin{aligned}\n        |h(z^*)| = \\max_{z \\in\\mathcal{Z}} |h(z)|.\n    \n\\end{aligned}')
('8.0', 'M = |h(z^*)|')
('8.0', '\\begin{aligned}\n        \\mathfrak{B} = \\left\\{z \\in \\mathcal{Z} ~ \\middle| ~ \\forall i \\in [d]~ \\max\\left(0, z^*_{[i]} - \\frac{M}{2R + 2\\sqrt{d}L}\\right) \\leq z_{[i]} \\leq \\min\\left(1, z^*_{[i]} + \\frac{M}{2R + 2\\sqrt{d}L}\\right)\\right\\},\n    \n\\end{aligned}')
('8.0', 'z_{[i]}')
('8.0', 'i')
('8.0', 'z')
('8.0', 'z \\in \\mathfrak{B}')
('8.0', '\\begin{aligned}\n        |h(z)| &\\geq |h(z^*)| - L\\|z^* - z\\|_2\\\\\n        &= M - L\\sqrt{\\sum_{i=1}^d |z^*_{[i]} - z_{[i]}|^2}\\\\\n        & \\ge M - L\\sqrt{\\sum_{i=1}^d \\left(\\frac{M}{2R + 2\\sqrt{d}L}\\right)^2} \\\\\n        & \\geq  M - L\\sqrt{\\sum_{i=1}^d \\left(\\frac{M}{2\\sqrt{d}L}\\right)^2} \\geq M / 2\n    \n\\end{aligned}')
('8.0', '\\mathfrak{B}')
('8.0', '\\begin{aligned}\n        \\frac{M}{2R + 2\\sqrt{d}L} \\leq \\frac{R}{2R + 2\\sqrt{d}L} \\leq \\frac{R}{2R} = \\frac12,\n    \n\\end{aligned}')
('8.0', '0 \\geq z^*_{[i]} -  \\frac{M}{2R + 2\\sqrt{d}L}')
('8.0', '1 \\leq z^*_{[i]} +  \\frac{M}{2R + 2\\sqrt{d}L}')
('8.0', '\\begin{aligned}\n        \\min\\left(1, z^*_{[i]} + \\frac{M}{2R + 2\\sqrt{d}L}\\right) - \\max\\left(0, z^*_{[i]} - \\frac{M}{2R + 2\\sqrt{d}L}\\right) \\geq \\frac{M}{2R + 2\\sqrt{d}L},\n    \n\\end{aligned}')
('8.0', '\\begin{aligned}\n        \\|h\\|^2_{P(Z)} &= \\int_{\\mathcal{Z}} |h(z)|^2 f(z) \\mathrm{d}z\\\\\n        &\\geq \\int_{\\mathfrak{B}} |h(z)|^2 f(z) \\mathrm{d}z\\\\\n        &\\geq c\\left(\\frac{M}{2R + 2\\sqrt{d}L}\\right)^d \\frac{M^2}{4}.\n    \n\\end{aligned}')
('8.0', 'M = \\max_{z \\in\\mathcal{Z}} |h(z)|')
('8.0', '\\begin{aligned}\n        \\max_{z \\in\\mathcal{Z}} |h(z)| \\leq \\left(\\frac{4}{c}\\right)^{\\frac{1}{d+2}}(2R + 2\\sqrt{d}L)^\\frac{d}{d+2} \\|h\\|^{\\frac{2}{d+2}}_{P(Z)}.\n    \n\\end{aligned}')
('8.0', '\\mathcal{A} = [0, 1]^{d_A}, \\mathcal{X} = [0, 1]^{d_X}')
('8.0', 'h \\in \\mathcal{H}_g')
('8.0', 'L-')
('8.0', '\\begin{aligned}\n    \\max_{a,x \\in\\mathcal{A} \\times \\mathcal{X}} |h_1(a,x) - h_2(a,x)| \\leq C \\|h_1 - h_2\\|^{\\frac{2}{d_A + d_X+2}}_{P(A,X)},\n\\end{aligned}')
('8.0', 'C = \\left(\\frac{4}{c}\\right)^{\\frac{1}{d_A + d_X +2}}(4R + 4\\sqrt{d_A + d_X}L)^\\frac{d_A + d_X}{d_A + d_X+2}')
('8.1.0', '\\mathcal{X}')
('8.1.0', '\\mathcal{H}')
('8.1.0', '\\mathcal{X}')
('8.1.0', '\\mathcal{Y} \\subseteq [-R, R]')
('8.1.0', 'S = ((y_1, x_1), (y_2, x_2), \\dots, (y_n, x_n)) \\in (\\mathcal{X} \\times \\mathcal{Y})^n')
('8.1.0', '\\begin{aligned}\n        \\hat{\\mathfrak{R}}_S(\\mathcal{H}) = \\mathbb{E}_{\\bm{\\sigma}}\\left[\\frac 1n \\sup_{h\\in \\mathcal{H}} \\sum_{i=1}^n \\sigma_i h(x_i)\\right],\n    \n\\end{aligned}')
('8.1.0', '\\bm{\\sigma}=(\\sigma_1,\\dots,\\sigma_n)')
('8.1.0', '\\sigma_i')
('8.1.0', '\\{-1,+1\\}')
('8.1.0', '\\delta > 0')
('8.1.0', '1-\\delta')
('8.1.0', 'S')
('8.1.0', 'n')
('8.1.0', 'h \\in \\mathcal{H}')
('8.1.0', '\\begin{aligned}\n        &\\mathbb{E}_{}\\left[(Y - h(X))^2\\right] \\leq \\frac1n \\sum_{i=1}^n (y_i - h(x_i))^2 + 8R\\hat{\\mathfrak{R}}_S(\\mathcal{H}) + 4R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}},\\\\\n        & \\frac1n \\sum_{i=1}^n (y_i - h(x_i))^2 \\leq \\mathbb{E}_{}\\left[(Y - h(X))^2\\right] +8R\\hat{\\mathfrak{R}}_S(\\mathcal{H}) + 4R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}.\n    \n\\end{aligned}')
('8.1.0', '\\hat{g}, g \\in \\mathcal{H}_g')
('8.1.0', '1-2\\delta')
('8.1.0', '\\begin{aligned}\n        &\\mathbb{E}_{}\\left[(Y - \\hat{g}(A, X))^2\\right] \\leq \\frac1n \\sum_{i=1}^n (y_i - \\hat{g}(a_i, x_i))^2 + 8R\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) + 4R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}\\\\\n        &\\frac1n \\sum_{i=1}^n (y_i - g(a_i, x_i))^2\\leq  \\mathbb{E}_{}\\left[(Y - g(A, X))^2\\right] + 8R\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) + 4R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}\n    \n\\end{aligned}')
('8.1.0', '\\hat{g} = \\mathop{\\mathrm{arg\\,min}}\\mathcal{L}_1')
('8.1.0', '\\begin{aligned}\n        &\\mathbb{E}_{}\\left[(Y - \\hat{g}(A, X))^2\\right] \\leq \\mathbb{E}_{}\\left[(Y - g(A, X))^2\\right] + 16R\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) + 8R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}\\\\\n        \\Leftrightarrow \\quad & \\mathbb{E}_{}\\left[(g(A, X) - \\hat{g}(A, X))^2\\right] \\leq 16R\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) + 8R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}.\n    \n\\end{aligned}')
('8.1.0.0', '\\mathcal{H}_g')
('8.1.0.0', '\\bm{\\phi}_A, \\bm{\\phi}_X')
('8.1.0.0', 'L')
('8.1.0.0', '\\mathcal{H}_{\\mathrm{NN}}')
('8.1.0.0', '\\begin{aligned}\n        \\mathcal{H}_{\\mathrm{NN}} = \\left\\{f: \\mathbb{R}^D \\to \\mathbb{R}~\\middle|~ f(s) = W^{(L)}\\sigma\\left(W^{(L-1)} \\sigma(\\dots\\sigma(W^{(1)} s)\\right), \\prod_{i=1}^L \\|W^{(i)}\\|_{p,q} \\leq \\gamma \\right\\},\n    \n\\end{aligned}')
('8.1.0.0', '\\sigma')
('8.1.0.0', 'W^{(1)} \\in \\mathbb{R}^{D \\times H}, W^{(L)} \\in \\mathbb{R}^{1 \\times H}, W^{(2)},\\dots,W^{(L-1)} \\in \\mathbb{R}^{H \\times H}')
('8.1.0.0', '\\|\\cdot\\|_{p,q}')
('8.1.0.0', 'L_{p,q}')
('8.1.0.0', '\\sup_{x\\neq 0} \\|Wx\\|_{q} /\\|x\\|_p')
('8.1.0.0', 'L, q \\geq 1')
('8.1.0.0', '1\\leq p \\leq \\infty')
('8.1.0.0', 'S = \\{s_1,\\dots,s_n\\}')
('8.1.0.0', '\\begin{aligned}\n                  \\hat{\\mathfrak{R}}_S(\\mathcal{H}_{\\mathrm{NN}}) \\leq \\sqrt{\\frac{1}{n}\\left(\\gamma^2 2H^{\\left[\\frac1{p^*} - \\frac1q\\right]_+}\\right)^{2(L-1)}\\left(\\min\\{p^* , 4 \\log (2D)\\}\\right) \\max_i \\|s_i\\|_{p^*}}\n    \n\\end{aligned}')
('8.1.0.0', 'p^* = 1/(1-1/p)')
('8.1.0.0', '[x]_+ = \\max\\{0, x\\}')
('8.1.0.0', '\\mathcal{H}_g')
('8.1.0.0', '\\mathcal{H}_{\\mathrm{NN}}')
('8.1.0.0', '\\mathcal{A}, \\mathcal{X} \\subset \\mathbb{R}^{D}')
('8.1.0.0', '\\mathcal{H}_{\\mathrm{NNFeat.}}(d)')
('8.1.0.0', '\\begin{aligned}\n        \\mathcal{H}_{\\mathrm{NNFeat.}}(d) = \\left\\{\\bm{\\phi}: \\mathbb{R}^D \\to \\mathbb{R}^d \\middle| \\bm{\\phi}(s) = (\\tilde\\sigma(f_1(s)), \\tilde\\sigma(f_2(s)), \\dots,\\tilde\\sigma( f_d(s)))^\\top, f_1,\\dots,f_d \\in \\mathcal{H}_{\\mathrm{NN}}\\right\\}\n    \n\\end{aligned}')
('8.1.0.0', '\\tilde\\sigma')
('8.1.0.0', '\\tilde\\sigma(x) = \\min(1, \\max(0, x))')
('8.1.0.0', '\\mathcal{H}_g')
('8.1.0.0', '\\begin{aligned}\n        \\mathcal{H}_g = \\{\\bm{w}^\\top (\\bm{\\phi}_A(a) \\otimes \\bm{\\phi}_X(x)) ~|~\\bm{w} &\\in \\mathbb{R}^{d_1d_2},\\bm{\\phi}_A(a)\\in \\mathbb{R}^{d_1}, \\bm{\\phi}_X(x)\\in \\mathbb{R}^{d_2}, \\\\\n        & \\|\\bm{w}\\|_1 \\leq R,~\\bm{\\phi}_A \\in \\mathcal{H}_{\\mathrm{NNFeat.}}(d_1),~\\bm{\\phi}_X \\in \\mathcal{H}_{\\mathrm{NNFeat.}}(d_2)\\}.\n    \n\\end{aligned}')
('8.1.0.0', 'S = \\{(a_1,x_1), \\dots (a_n,x_n)\\}')
('8.1.0.0', '\\begin{aligned}\n        \\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) \n \\leq 6R \\sqrt{\\frac{1}{n}\\left(\\gamma^2 2H^{\\left[\\frac1{p^*} - \\frac1q\\right]_+}\\right)^{2(L-1)}\\left(\\min\\{p^* , 4 \\log (2D)\\}\\right) \\left(\\max_i \\|a_i\\|_{p^*} + \\max_i \\|x_i\\|_{p^*}\\right)}.\n    \n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n    \\max_{a\\in\\mathcal{A}} \\|\\bm{\\phi}_A(a)\\|_\\infty \\leq 1, \\max_{x\\in\\mathcal{X}} \\|\\bm{\\phi}_X(x)\\|_\\infty \\leq 1\n\\end{aligned}')
('8.1.0.0', '\\tilde\\sigma')
('8.1.0.0', '\\begin{aligned}\n        &\\tilde{\\mathcal{H}}_{\\mathrm{NN}} = \\{\\tilde\\sigma \\circ f | f \\in \\mathcal{H}_{\\mathrm{NN}}\\},\\\\\n        &\\tilde{\\mathcal{H}}^2_{\\mathrm{NN}} = \\{\\tilde{f}_1(a)\\tilde{f}_2(x) | \\tilde{f}_1, \\tilde{f}_2 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\}.\n    \n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n        \\mathcal{H}_g \\subset \\left\\{\\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  w_{ij} h_{ij}(a,x) ~\\middle|~ \\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  |w_{ij}| \\leq R, \\forall i,j~ h_{ij} \\in \\tilde{\\mathcal{H}}^2_{\\mathrm{NN}}\\right\\}.\n    \n\\end{aligned}')
('8.1.0.0', '\\bm{w}')
('8.1.0.0', '\\|\\bm{w}\\|\\leq R')
('8.1.0.0', '\\|\\bm{w}\\| =  R')
('8.1.0.0', '\\begin{aligned}\n        \\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) &\\leq \\hat{\\mathfrak{R}}_S\\left(\\left\\{\\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  w_{ij} h_{ij}(a,x) ~\\middle|~ \\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  |w_{ij}| \\leq R, \\forall i,j~ h_{ij} \\in \\tilde{\\mathcal{H}}^2_{\\mathrm{NN}}\\right\\}\\right)\\\\\n        &= \\hat{\\mathfrak{R}}_S\\left(\\left\\{\\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  w_{ij} h_{ij}(a,x) ~\\middle|~ \\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  |w_{ij}| = R, \\forall i,j~ h_{ij} \\in \\tilde{\\mathcal{H}}^2_{\\mathrm{NN}}\\right\\}\\right)\\\\\n        &\\leq R\\hat{\\mathfrak{R}}_S\\left(\\left\\{\\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  w_{ij} h_{ij}(a,x) ~\\middle|~ \\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  |w_{ij}| = 1, \\forall i,j~ h_{ij} \\in \\tilde{\\mathcal{H}}^2_{\\mathrm{NN}}\\right\\}\\right)\n    \n\\end{aligned}')
('8.1.0.0', '\\tilde{\\mathcal{H}}^2_\\mathrm{NN} - \\tilde{\\mathcal{H}}^2_\\mathrm{NN}')
('8.1.0.0', '\\begin{aligned}\n        \\tilde{\\mathcal{H}}^2_\\mathrm{NN} - \\tilde{\\mathcal{H}}^2_\\mathrm{NN} = \\left\\{h_1(a,x) - h_2(a,x) ~\\middle|~ h_1,h_2 \\in \\tilde{\\mathcal{H}}^2_\\mathrm{NN}\\right\\}.\n    \n\\end{aligned}')
('8.1.0.0', '\\tilde{\\mathcal{H}}^2_\\mathrm{NN}')
('8.1.0.0', '\\tilde{\\mathcal{H}}^2_\\mathrm{NN} - \\tilde{\\mathcal{H}}^2_\\mathrm{NN}')
('8.1.0.0', '\\begin{aligned}\n        \\sum_{i=1}^{d_1}\\sum_{j=1}^{d_2}  w_{ij} h_{ij}(a,x) = \\sum_{w_{i,j}\\geq 0}w_{ij} (h_{ij}(a,x)-0) + \\sum_{w_{i,j} < 0} |w_{ij}| (0 - h_{ij}(a,x)).\n    \n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n      \\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) &\\leq\n      R \\hat{\\mathfrak{R}}_S(\\tilde{\\mathcal{H}}^2_\\mathrm{NN} - \\tilde{\\mathcal{H}}^2_\\mathrm{NN}) \\leq\n      2R \\hat{\\mathfrak{R}}_S(\\tilde{\\mathcal{H}}^2_\\mathrm{NN}).\n    \n\\end{aligned}')
('8.1.0.0', '\\hat{\\mathfrak{R}}_S(\\tilde{\\mathcal{H}}^2_\\mathrm{NN})')
('8.1.0.0', '\\begin{aligned}\n    \\hat{\\mathfrak{R}}_S(\\tilde{\\mathcal{H}}^2_\\mathrm{NN}) &= \\hat{\\mathfrak{R}}_S(\\{\\tilde{f}_1(a)\\tilde{f}_2(x) | \\tilde{f}_1, \\tilde{f}_2 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\})\\\\\n    &= \\hat{\\mathfrak{R}}_S\\left(\\left\\{\\frac12\\left((\\tilde{f}_1(a) + \\tilde{f}_2(x))^2 - (\\tilde{f}_1(a))^2 - (\\tilde{f}_2(x))^2\\right) \\middle | \\tilde{f}_1, \\tilde{f}_2 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\right\\}\\right)\\\\\n    &=\\frac12\\hat{\\mathfrak{R}}_S\\left(\\left\\{(\\tilde{f}_1(a) + \\tilde{f}_2(x))^2 \\middle | \\tilde{f}_1, \\tilde{f}_2 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\right\\}\\right) + \\frac12\\hat{\\mathfrak{R}}_S\\left(\\left\\{(\\tilde{f}_1(a))^2 \\middle | \\tilde{f}_1 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\right\\}\\right)\\\\\n    &\\quad\\quad +\\frac12\\hat{\\mathfrak{R}}_S\\left(\\left\\{(\\tilde{f}_2(x))^2 \\middle | \\tilde{f}_2 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\right\\}\\right)\\\\\n    &\\leq 2 \\hat{\\mathfrak{R}}_S\\left(\\left\\{\\tilde{f}_1(a) + \\tilde{f}_2(x) \\middle | \\tilde{f}_1, \\tilde{f}_2 \\in \\tilde{\\mathcal{H}}_{\\mathrm{NN}}\\right\\}\\right)  + \\hat{\\mathfrak{R}}_{S_A}(\\tilde{\\mathcal{H}}_\\mathrm{NN}) + \\hat{\\mathfrak{R}}_{S_X}(\\tilde{\\mathcal{H}}_\\mathrm{NN})\\\\\n    &= 3\\hat{\\mathfrak{R}}_{S_A}(\\tilde{\\mathcal{H}}_\\mathrm{NN}) + 3\\hat{\\mathfrak{R}}_{S_X}(\\tilde{\\mathcal{H}}_\\mathrm{NN}),\n    \n\\end{aligned}')
('8.1.0.0', 'S_A = \\{a_i\\}')
('8.1.0.0', 'S_X=\\{x_i\\}')
('8.1.0.0', '\\begin{aligned}\n    \\hat{\\mathfrak{R}}_{S_A}(\\tilde{\\mathcal{H}}_\\mathrm{NN}) \\leq \\hat{\\mathfrak{R}}_{S_A}({\\mathcal{H}}_\\mathrm{NN}),~ \\hat{\\mathfrak{R}}_{S_X}(\\tilde{\\mathcal{H}}_\\mathrm{NN}) \\leq \\hat{\\mathfrak{R}}_{S_X}({\\mathcal{H}}_\\mathrm{NN}), \n\\end{aligned}')
('8.1.0.0', '\\tilde\\sigma')
('8.1.0.0', '\\begin{aligned}\n    \\hat{\\mathfrak{R}}_{S}({\\mathcal{H}}_g) \\leq 6R(\\hat{\\mathfrak{R}}_{S_A}({\\mathcal{H}}_\\mathrm{NN}) + \\hat{\\mathfrak{R}}_{S_X}({\\mathcal{H}}_\\mathrm{NN})).\n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n        |\\theta_\\mathrm{ATE}(a) - \\hat{\\theta}_\\mathrm{ATE}(a)| &\\leq \\left|\\theta - \\mathbb{E}_{}\\left[\\hat{g}(a, X)\\right]\\right| + \\left|\\hat{\\theta}_\\mathrm{ATE}(a) -\\mathbb{E}_{}\\left[\\hat{g}(a, X)\\right] \\right|\n    \n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n    \\left|\\theta_\\mathrm{ATE}(a) - \\mathbb{E}_{}\\left[\\hat{g}(a, X)\\right]\\right| &=  \\left|\\mathbb{E}_{}\\left[g(a,X) - \\hat{g}(a,X)\\right]\\right| \\\\\n    &\\leq \\mathbb{E}_{}\\left[|g(a,X) - \\hat{g}(a,X)|\\right]\\\\\n    &\\leq \\sup_{a\\in\\mathcal{A}, x \\in \\mathcal{X}} |g(a,x) - \\hat{g}(a,x)| \n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n    \\left|\\hat{\\theta} - \\int \\mathbb{E}_{}\\left[\\hat{g}(a, X)\\right] \\right| & = \\left|\\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\frac1n \\sum_{i=1}^n\\hat{\\bm{\\phi}}_X(x_i)  - \\hat{\\bm{\\phi}}_A(a) \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right]\\right) \\right|\\\\\n    &\\leq \\|\\hat{\\bm{w}}\\|_1\\left\\| \\hat{\\bm{\\phi}}_A(a) \\otimes \\frac1n \\sum_{i=1}^n\\hat{\\bm{\\phi}}_X(x_i)  - \\hat{\\bm{\\phi}}_A(a) \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right] \\right\\|_\\infty\\\\\n    &\\leq \\|\\hat{\\bm{w}}\\|_1 \\left\\| \\hat{\\bm{\\phi}}_A(a) \\right\\|_\\infty \\left\\| \\frac1n \\sum_{i=1}^n\\hat{\\bm{\\phi}}_X(x_i)  - \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right] \\right\\|_\\infty\\\\\n    &\\leq R \\left\\| \\frac1n \\sum_{i=1}^n\\hat{\\bm{\\phi}}_X(x_i)  - \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right] \\right\\|_\\infty\n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n    |\\theta_\\mathrm{ATE}(a) - \\hat{\\theta}_\\mathrm{ATE}(a)| \\leq \\sup_{a,x} |g(a,x) - \\hat{g}(a,x)| +   R \\left\\| \\frac1n \\sum_{i=1}^n\\hat{\\bm{\\phi}}_X(x_i)  - \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right] \\right\\|_\\infty.\n\\end{aligned}')
('8.1.0.0', '\\begin{aligned}\n    &\\sup_{a,x} |g(a,x) - \\hat{g}(a,x)| \\leq \\frac1c \\left(16R\\hat{\\mathfrak{R}}_S(\\mathcal{H}_g) + 8R^2 \\sqrt{\\frac{\\log 2/\\delta}{2n}}\\right)^{1/2\\beta},\\\\\n     &\\left\\|\\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\right] - \\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_X(x_i) \\right\\|_\\infty \\leq \\sqrt{\\frac{2\\log ({2d_2}/{\\delta})}{n}}\n\\end{aligned}')
('8.1.0.0', '1-4\\delta')
('8.1.0.0', "\\begin{aligned}\n    |\\theta_\\mathrm{ATT}(a; a') - \\hat{\\theta}_\\mathrm{ATT}(a; a')| \\leq \\sup_{a,x} |g(a,x) - \\hat{g}(a,x)| +   \\sup_{a'\\in\\mathcal{A}} R \\left\\| \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X}(a')  - \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)|A=a'\\right] \\right\\|_\\infty.\n\\end{aligned}")
('8.1.0.0', "\\begin{aligned}\n    \\left\\| \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X}(a')  - \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)|A=a'\\right] \\right\\| \\leq \\frac1{c'}\\left(16\\hat{\\mathfrak{R}}_S(\\mathcal{H}_f) + 8\\sqrt{\\frac{\\log (2d_2/\\delta)}{2n}}\\right)^{1/2\\beta'}.\n\\end{aligned}")
('8.1.0.0', '\\mathcal{H}_f')
('8.2', 'm')
('8.2', '\\theta')
('8.2', '\\theta = \\mathbb{E}_{}\\left[m(g, (A,X))\\right]')
('8.2', 'g')
('8.2', 'g(a,x) = \\mathbb{E}_{}\\left[Y|A=a, X=x\\right]')
('8.2', '\\alpha')
('8.2', '\\mathbb{E}_{}\\left[m(g, (A,X))\\right] = \\mathbb{E}_{}\\left[\\alpha(A,X)g(A,X)\\right]')
('8.2', '\\begin{aligned}\n    \\mathbb{E}_{}\\left[(m^2(\\alpha,(A,X))\\right] \\leq M \\|\\alpha \\|^2_{P(A,X)},\n\\end{aligned}')
('8.2', '\\alpha \\in \\mathcal{H}_\\alpha')
('8.2', 'M')
('8.2', '\\theta_\\mathrm{ATE}(a)')
('8.2', 'm')
('8.2', '\\begin{aligned}\n    m(\\alpha, (A,X)) = \\alpha(a, X).\n\\end{aligned}')
('8.2', '\\hat{\\alpha}')
('8.2', '\\alpha_0')
('8.2', 'M')
('8.2', '\\begin{aligned}\n    \\|\\hat{\\alpha} - \\alpha_0\\|^2_{P(A,X)} \\leq O(M\\delta_n + n^{-1/2}),\n\\end{aligned}')
('8.2', '\\delta_n')
('8.2', '\\begin{aligned}\n    \\delta_n = O\\left(\\sqrt{\\frac{\\log n}{n}}\\right).\n\\end{aligned}')
('8.2', 'M')
('8.2', '\\alpha')
('8.2', '\\mathcal{A} = [-1, 1]^d')
('8.2', '\\mathcal{X}')
('8.2', 'P(A,X)')
('8.2', '\\tilde\\alpha')
('8.2', '\\begin{aligned}\n    \\tilde\\alpha(a,x) = \\max\\left(1 - \\sum^d_{i=1}2|a_{[i]}|, 0\\right),\n\\end{aligned}')
('8.2', 'a_{[i]}')
('8.2', 'i')
('8.2', 'a')
('8.2', '\\tilde\\alpha')
('8.2', 'x')
('8.2', '\\theta_\\mathrm{ATE}(a)')
('8.2', 'a = \\bm{0} =[0,\\dots, 0]^\\top')
('8.2', '\\begin{aligned}\n    \\mathbb{E}_{}\\left[(m(\\tilde\\alpha)(A,X))^2\\right] = \\mathbb{E}_{}\\left[(\\tilde\\alpha(\\bm{0}, X))^2\\right] = 1.\n\\end{aligned}')
('8.2', '\\mathfrak{B}')
('8.2', '\\begin{aligned}\n    \\mathfrak{B} = \\left\\{a \\in \\mathcal{A}~\\middle|~\\forall i \\in [d], -\\frac12 \\leq a_{[i]} \\leq \\frac12\\right\\}.\n\\end{aligned}')
('8.2', '\\tilde\\alpha(a,x) = 0')
('8.2', 'a \\notin \\mathfrak{B}')
('8.2', '\\begin{aligned}\n    \\|\\tilde\\alpha\\|^2_{P(A,X)} &= \\int_{\\mathcal{A}} |\\tilde\\alpha(A,X)|^2  \\mathrm{d}P(A, X)\\\\\n    &= \\int_{\\mathfrak{B}} |\\tilde\\alpha(A,X)|^2  \\mathrm{d}P(A, X)\\\\\n    &\\leq \\int_{\\mathfrak{B}}  \\mathrm{d}P(A, X) = 1/2^d.\n\\end{aligned}')
('8.2', 'P(A,X)')
('8.2', '\\tilde\\alpha \\in \\mathcal{H}_\\alpha')
('8.2', 'M')
('8.2', '\\begin{aligned}\n    M \\geq 2^d.\n\\end{aligned}')
('9', "\\begin{aligned}\n    \\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{U,O}\\left[\\mathbb{E}_{}\\left[Y |U, O, A=a\\right]\\right], \\quad \\theta_\\mathrm{ATE}(a; a') = \\mathbb{E}_{U,O}\\left[\\mathbb{E}_{}\\left[Y |U, O, A=a\\right]\\right].\n\\end{aligned}")
('9', 'O=o')
('9', '\\begin{aligned}\n     \\theta_{\\mathrm{CATE}}(a; o) = \\mathbb{E}_{}\\left[Y^{(a)}\\middle|O=o\\right].\n \n\\end{aligned}')
('9', '\\begin{aligned}\n     \\theta_{\\mathrm{CATE}}(a; o) = \\mathbb{E}_{U|O=o}\\left[\\mathbb{E}_{}\\left[Y|U, O=o, A=a\\right]\\right].\n \n\\end{aligned}')
('9.0', 'X')
('9.0', 'X')
('9.0', "\\begin{aligned}\n        &\\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{X,O}\\left[g(a,O,X)\\right],\\\\\n        &\\theta_\\mathrm{ATT}(a; a') = \\mathbb{E}_{X,O}\\left[g(a,O,X) | A=a'\\right],\\\\\n        &\\theta_{\\mathrm{CATE}}(a; o) = \\mathbb{E}_{X}\\left[g(a, o, X)|O=o\\right]\n    \n\\end{aligned}")
('9.0', 'g(a,o,x) = \\mathbb{E}_{}\\left[Y|A=a, O=o, X=x\\right]')
('9.0', '\\hat{g}')
('9.0', '\\hat{g}(a,o,x) = \\hat{\\bm{w}}^\\top(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{\\phi}}_O(o) \\otimes \\hat{\\bm{\\phi}}_X(x))')
('9.0', '\\begin{aligned}\n    \\hat{\\bm{w}}, \\hat{\\bm{\\phi}}_A, \\hat{\\bm{\\phi}}_O,\\hat{\\bm{\\phi}}_X(x) = \\mathop{\\mathrm{arg\\,min}}\\frac1n \\sum_{i=1}^n (y_i - \\bm{w}^\\top(\\bm{\\phi}_A(a_i) \\otimes \\bm{\\phi}_O(o_i) \\otimes \\bm{\\phi}_X(x_i)))^2 \\label{eq:backdoor-stage1-obs}\n\\end{aligned}')
('9.0', '(y_i, a_i, o_i, x_i)')
('9.0', '\\bm{w}')
('9.0', '\\bm{\\phi}_A, \\bm{\\phi}_O, \\bm{\\phi}_X')
('9.0', "\\begin{aligned}\n    &\\theta_\\mathrm{ATE}(a) \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\mathbb{E}_{X,O}\\left[\\hat{\\bm{\\phi}}_O(O) \\otimes \\hat{\\bm{\\phi}}_X(X)\\right]\\right),\\\\\n    &\\theta_\\mathrm{ATT}(a; a') \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\mathbb{E}_{X,O}\\left[\\hat{\\bm{\\phi}}_O(O) \\otimes \\hat{\\bm{\\phi}}_X(X)\\middle|A=a'\\right]\\right),\\\\\n    &\\theta_{\\mathrm{CATE}}(a; o) \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{\\phi}}_O(o)  \\otimes \\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_X(X)\\middle|O=o\\right]\\right)\n\\end{aligned}")
('9.0', "\\begin{aligned}\n    &\\hat\\theta_\\mathrm{ATE}(a) = \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\frac1n \\sum_{i=1}^n \\left(\\hat{\\bm{\\phi}}_O(o_i) \\otimes \\hat{\\bm{\\phi}}_X(x_i)\\right)\\right),\\\\\n    &\\hat\\theta_\\mathrm{ATT}(a; a') = \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_O \\otimes \\hat{\\bm{\\phi}}_X}(a')\\right),\\\\\n    &\\hat\\theta_{\\mathrm{CATE}}(a; o) = \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{\\phi}}_O(o) \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X}(o)\\right)\n\\end{aligned}")
('9.0', '\\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_O \\otimes \\hat{\\bm{\\phi}}_X}, \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X}(o)')
('9.0', '\\begin{aligned}\n    &\\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_O \\otimes \\hat{\\bm{\\phi}}_X} = \\mathop{\\mathrm{arg\\,min}}_{\\bm{f}}  \\frac1n \\sum_{i=1}^n \\|\\hat{\\bm{\\phi}}_O(o_i) \\otimes \\hat{\\bm{\\phi}}_X(x_i) - \\bm{f}(a_i)\\|^2\\\\\n    &\\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_X} = \\mathop{\\mathrm{arg\\,min}}_{\\bm{f}}  \\frac1n \\sum_{i=1}^n \\|\\hat{\\bm{\\phi}}_X(x_i) - \\bm{f}(o_i)\\|^2.\n\\end{aligned}')
('9.0.0', 'M')
('9.0.0', 'M')
('9.0.0', "\\begin{aligned}\n        &\\theta_\\mathrm{ATE}(a) = \\mathbb{E}_{A'}\\left[\\mathbb{E}_{O}\\left[\\mathbb{E}_{M|O, A=a}\\left[g(A', O, M)\\right]\\right]\\right],\\\\\n        &\\theta_\\mathrm{ATT}(a; a') = \\mathbb{E}_{O}\\left[\\mathbb{E}_{M|O, A=a}\\left[g(a', O, M)\\right]\\right],\\\\\n        &\\theta_{\\mathrm{CATE}}(a; o) = \\mathbb{E}_{A'}\\left[\\mathbb{E}_{M|O=o, A=a}\\left[g(A', o, M)\\right]\\right]\n    \n\\end{aligned}")
('9.0.0', 'g(a, o, m) = \\mathbb{E}_{}\\left[Y|A=a, O=o, M=m\\right]')
('9.0.0', "A'")
('9.0.0', 'A')
('9.0.0', '\\hat{g}')
('9.0.0', '\\hat{g}(a,o,x) = \\hat{\\bm{w}}^\\top(\\hat{\\bm{\\phi}}_A(a) \\otimes \\hat{\\bm{\\phi}}_O(o) \\otimes \\hat{\\bm{\\phi}}_M(m))')
('9.0.0', '\\begin{aligned}\n    \\hat{\\bm{w}}, \\hat{\\bm{\\phi}}_A, \\hat{\\bm{\\phi}}_O,\\hat{\\bm{\\phi}}_M(m) = \\mathop{\\mathrm{arg\\,min}}\\frac1n \\sum_{i=1}^n (y_i - \\bm{w}^\\top(\\bm{\\phi}_A(a_i) \\otimes \\bm{\\phi}_O(o_i) \\otimes \\bm{\\phi}_M(m_i)))^2.\n\\end{aligned}')
('9.0.0', "\\begin{aligned}\n    &\\theta_\\mathrm{ATE}(a) \\simeq \\hat{\\bm{w}}^\\top \\left(\\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_A(A)\\right] \\otimes \\mathbb{E}_{O}\\left[\\hat{\\bm{\\phi}}_O(O) \\otimes  \\mathbb{E}_{M|O,A=a}\\left[ \\hat{\\bm{\\phi}}_M(M)\\right]\\right]\\right),\\\\\n    &\\theta_\\mathrm{ATT}(a; a') \\simeq \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a') \\otimes \\mathbb{E}_{O}\\left[\\hat{\\bm{\\phi}}_O(O) \\otimes \\mathbb{E}_{M|O,A=a}\\left[ \\hat{\\bm{\\phi}}_M(M)\\right]\\right]\\right),\\\\\n    &\\theta_{\\mathrm{CATE}}(a; o) \\simeq \\hat{\\bm{w}}^\\top \\left(\\mathbb{E}_{}\\left[\\hat{\\bm{\\phi}}_A(A)\\right]  \\otimes \\hat{\\bm{\\phi}}_O(o) \\otimes \\mathbb{E}_{M|O=o,A=a}\\left[ \\hat{\\bm{\\phi}}_M(M)\\right]\\right).\n\\end{aligned}")
('9.0.0', '\\mathbb{E}_{M|O=o,A=a}\\left[ \\hat{\\bm{\\phi}}_M(M)\\right]')
('9.0.0', '\\mathbb{E}_{M|O=o,A=a}\\left[\\hat{\\bm{\\phi}}_M(M)\\right] = \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}(o, a)')
('9.0.0', '\\begin{aligned}\n    \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M} = \\mathop{\\mathrm{arg\\,min}}_{\\bm{f}}  \\frac1n \\sum_{i=1}^n \\|\\hat{\\bm{\\phi}}_M(m_i) - \\bm{f}(o_i, a_i)\\|^2.  \n\\end{aligned}')
('9.0.0', "\\begin{aligned}\n    &\\hat\\theta_\\mathrm{ATE}(a) = \\hat{\\bm{w}}^\\top \\left(\\left(\\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_A(a_i) \\right)\\otimes \\frac1n \\sum_{j=1}^n \\left(\\hat{\\bm{\\phi}}_O(o_j) \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}(o_j, a)\\right)\\right),\\\\\n    &\\hat\\theta_\\mathrm{ATT}(a; a') = \\hat{\\bm{w}}^\\top \\left(\\hat{\\bm{\\phi}}_A(a') \\otimes \\frac1n \\sum_{i=1}^n \\left(\\hat{\\bm{\\phi}}_O(o_i) \\otimes \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}(o_i, a)\\right)\\right),\\\\\n    &\\hat\\theta_{\\mathrm{CATE}}(a; o) = \\hat{\\bm{w}}^\\top \\left(\\left(\\frac1n \\sum_{i=1}^n \\hat{\\bm{\\phi}}_A(a_i) \\right)\\otimes  \\hat{\\bm{\\phi}}_O(o) \\otimes  \\hat{\\bm{f}}_{\\hat{\\bm{\\phi}}_M}(o, a)\\right).\n\\end{aligned}")
