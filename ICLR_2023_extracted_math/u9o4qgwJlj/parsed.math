('3.0', 'x(t) \\in \\mathbb{R}^L')
('3.0', 'y(t) \\in \\mathbb{R}^L')
('3.0', 'h(t) \\in \\mathbb{R}^N')
('3.0', "\\begin{aligned}\n    h'(t) &= \\mathbf{A} h(t) + \\mathbf{B} x(t), \\\\\n    y(t) &= \\mathbf{C} h(t),\n\\end{aligned}\n\\label{eq:original_ssm}")
('3.0', 'L')
('3.0', 'N')
('3.0', '\\mathbf{A} \\in \\mathbb{R}^{N \\times N}')
('3.0', '\\mathbf{B} \\in \\mathbb{R}^{N \\times L}')
('3.0', '\\mathbf{C} \\in \\mathbb{R}^{L \\times N}')
('3.0', '\\Delta')
('3.0', '\\begin{aligned}\n    \\mathbf{\\overline{A}} &= \\exp ( \\Delta \\mathbf{A} ), \\\\\n    \\mathbf{\\overline{B}} &= (\\Delta \\mathbf{A})^{-1} (\\exp(\\Delta \\mathbf{A}) - \\mathbf{I}) \\cdot \\Delta \\mathbf{B}.\n\\end{aligned}')
('3.0', '\\mathbf{\\overline{A}}')
('3.0', '\\mathbf{\\overline{B}}')
('3.0', '\\begin{aligned}\n    h_t &= \\mathbf{\\overline{A}} h_{t-1} + \\mathbf{\\overline{B}} x_t, \\\\\n    y_t &= \\mathbf{C} h_t.\n\\end{aligned}\n\\label{eq:discret_mamba}')
('3.0', '\\begin{aligned}\n    \\mathbf{\\overline{K}} &= ( \\mathbf{C} \\mathbf{\\overline{B}}, \\mathbf{C} \\mathbf{\\overline{AB}}, \\ldots, \\mathbf{C} \\mathbf{\\overline{A}^{L-1}\\overline{B}} ), \\\\\n    \\mathbf{y} &= \\mathbf{x} * \\mathbf{\\overline{K}},\n\\end{aligned}')
('3.0', '\\mathbf{y}')
('3.0', 'L')
('3.0', '\\mathbf{x}')
('3.0', '\\mathbf{\\overline{K}} \\in \\mathbb{R}^L')
('3.1', 'N')
('3.1', 'K')
('3.1', 'N-K')
('3.1', '\\{x_j\\}^{K-1}_{j=0}')
('4.0', 'l^{th}')
('4.0', 'T_{l-1} \\in \\mathbb{R}^{B \\times N \\times D}')
('4.0', 'B')
('4.0', 'N')
('4.0', 'D')
('4.0', '\\{x_j\\}^{N-1}_{j=0}')
('4.0', 'N')
('4.0', 'K')
('4.0', 'N-K')
('4.0', '\\{q_j\\}^{K-1}_{j=0}')
('4.0', 'K')
('4.0', 'q_s < q_t')
('4.0', 's<t')
('4.0', "\\label{eq:remained_state}\n\\begin{aligned}\n    h'_{q_0} &= \\mathbf{\\overline{B}} x_{q_{0}}, \\\\\n    h'_{q_1} &= \\mathbf{\\overline{A}}^{q_1-q_0} \\mathbf{\\overline{B}} x_{q_{0}} + \\mathbf{\\overline{B}} x_{q_1},\\\\\n    ...&\\\\\n    h'_{q_{(K-1)}} & =  \\underbrace{\\mathbf{\\overline{A}}^{q_{(K-1)}-q_0} \\mathbf{\\overline{B}} x_{q_{0}} + \\mathbf{\\overline{A}}^{q_{(K-1)}-q_{1}} \\mathbf{\\overline{B}} x_{q_1} + \\mathbf{\\overline{A}}^{q_{(K-1)}-q_{2}} \\mathbf{\\overline{B}} x_{q_2} + ... +  \\mathbf{\\overline{B}} x_{q_{(K-1)}}}_{K \\textrm{ terms/tokens}}.\n\\end{aligned}")
('4.0', 'x_{q_{i}}')
('4.0', 'x_{q_{i+1}}')
('4.0', 'q_{i+1} - q_i > 1')
('4.0', 'x_{q_{i}}')
('4.0', 'x_{q_{i+1}}')
('4.0', 'x_{q_{i}}')
('4.0', 'x_{q_{i+1}}')
('4.0', 'K_i')
('4.0', 'K_i \\ge 1')
('4.0', '\\{q_i + j\\}^{K_i}_{j=1}')
('4.0', 'q_{i} <  (q_i) + 1 < ...  <   (q_i) + K_i  < q_{(i+1)}')
('4.0', 'q_{i+1}')
('4.0', 'q_i + 1')
('4.0', 'q_{(i+1)}')
('4.0', '(q_i) + 1')
('4.0', "\\label{eq:pruned_state}\n\\begin{aligned}\n    h'_{q_i} &= \\mathbf{\\overline{A}}^{q_{i}-q_0} \\mathbf{\\overline{B}} x_{q_{0}} + \\mathbf{\\overline{A}}^{q_{i}-q_{1}} \\mathbf{\\overline{B}} x_{q_1} + ... + \\mathbf{\\overline{B}} x_{q_{i}}, \\\\\n    h'_{(q_{i})+1} &= \\mathbf{\\overline{A}}^{(q_{i})+1-(q_0)} \\mathbf{\\overline{B}} x_{q_{0}} + \\mathbf{\\overline{A}}^{(q_{i})+1-(q_{1})} \\mathbf{\\overline{B}} x_{q_1} + ... + \\mathbf{\\overline{A}} \\mathbf{\\overline{B}} x_{q_{i}},\\\\\n    ...&\\\\\n    h'_{(q_{i})+K_i} &= \\mathbf{\\overline{A}}^{(q_{i})+K_i-(q_0)} \\mathbf{\\overline{B}} x_{q_{0}} + \\mathbf{\\overline{A}}^{(q_{i})+K_i-(q_{1})} \\mathbf{\\overline{B}} x_{q_1} + ... + \\mathbf{\\overline{A}}^{K_i} \\mathbf{\\overline{B}} x_{q_{i}},\\\\\n    h'_{q_{(i+1)}} & = \\mathbf{\\overline{A}}^{q_{(i+1)}-q_0} \\mathbf{\\overline{B}} x_{q_{0}} + \\mathbf{\\overline{A}}^{q_{(i+1)}-q_{1}} \\mathbf{\\overline{B}} x_{q_1} + ... + \\mathbf{\\overline{A}}^{q_{(i+1)} - q_i} \\mathbf{\\overline{B}} x_{q_{i}} + \\mathbf{\\overline{B}} x_{q_{(i+1)}}.\n\\end{aligned}")
('4.0', 'q_0')
('4.0', 'q_{K-1}')
('4.0', "h'_{(q_{i})+1}  = \\mathbf{\\overline{A}} h'_{(q_{i})} + \\mathbf{\\overline{B}} x_{(q_{i})+1} = \\mathbf{\\overline{A}} h'_{(q_{i})}")
('4.0', 'x_{(q_{i})+1}')
('4.0.0', '\\{x_j\\}^{K-1}_{j=0}')
('4.1', 'l^{th}')
('4.1', 'T_{l-1} \\in \\mathbb{R}^{B \\times N \\times D}')
('4.1', "X'\\in \\mathbb{R}^{B \\times N \\times D'}")
('4.1', "X'")
('4.1', "y_m \\leftarrow \\texttt{SSM}(A_m, B_m, C_m)(X'_m), \\quad \\text{for } m \\in \\{\\texttt{forward}, \\texttt{backward}\\},")
('4.1', "y_m \\in \\mathbb{R}^{B \\times N \\times D'}")
('4.1', 'y_m')
('4.1', "y'_{\\texttt{forward}}")
('4.1', "y'_{\\texttt{backward}}")
('4.1', 'l^{th}')
('4.1', "T_l \\leftarrow \\texttt{Linear}^T(y'_{\\texttt{forward}} + y'_{\\texttt{backward}}) + T_{l-1}.")
('4.1', "\\label{eq:importance_metric}\n    \\mathcal{S} = \\frac{\\sum_{d=1}^{D'} \\texttt{max}(0,{y_m}_d)}{D'},")
('4.1', '\\mathcal{S}')
('4.1', '\\mathcal{S}')
('4.1', '\\ell_{1}')
('4.1', '\\ell_{2}')
('4.2.0', '\\{q_j\\}^{K-1}_{j=0}')
('4.2.0.0', '\\sim')
('5.0', '10^{-5}')
('5.0', '10^{-8}')
('5.0', '384^2')
('5.0', '384^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.0', '224^2')
('5.1', '\\times')
('5.2.0', '\\ell_1')
('5.2.0', '\\ell_2')
('5.2.0', '\\ell_1')
('5.2.0', '\\ell_2')
('5.2.1', '\\times')
('5.2.1', '\\times')
('5.2.1', '\\times')
('5.2.1', '\\times')
