('1', '\\hat{b}')
('1', '\\hat{p}')
('1', '{\\bm{q}}')
('1', '{\\bm{k}}')
('1', '{\\bm{v}}')
('3.0', '{\\bm{h}}= \\texttt{Backbone}({\\bm{x}})')
('3.0', '{\\bm{x}}\\in\\mathbb{R}^{3\\times H_0\\times W_0}')
('3.0', '{\\bm{h}}')
('3.0', '{\\bm{c}}\\in\\mathbb{R}^{C\\times H_1\\times W_1}')
('3.0', '{\\bm{c}}= \\texttt{Encoder}({\\bm{h}}).')
('3.0', '{\\bm{\\phi}}_p')
('3.0', '\\texttt{MHA}')
('3.0', '\\widehat{{\\bm{q}}}\\in\\mathbb{R}^{N\\times C}')
('3.0', '{\\bm{c}}\\in\\mathbb{R}^{H_1W_1\\times C}')
('3.0', 'N')
('3.0', '{\\bm{\\phi}}_q\\in\\mathbb{R}^{N\\times C}')
('3.0', '\\label{eq:ca}\n\\begin{aligned}\n    \\widehat{{\\bm{q}}} &= \\texttt{CrossAtten}({\\bm{c}}, {\\bm{\\phi}}_q) = \\texttt{MHA}({\\bm{q}}, {\\bm{k}}, {\\bm{v}}) \\\\\n    & = \\sum\\texttt{Softmax}(\\frac{{\\bm{q}}{\\bm{k}}^T}{\\sqrt{d_k}}){\\bm{v}}.\n\\end{aligned}')
('3.0', '{\\bm{q}}')
('3.0', '{\\bm{k}}')
('3.0', '{\\bm{v}}')
('3.0', '{\\bm{c}}')
('3.0', '{\\bm{\\phi}}_q')
('3.0', '\\label{eq:kvq}\n    {\\bm{q}}= f_q({\\bm{\\phi}}_q);\\;\\;\n    {\\bm{k}}= f_k({\\bm{c}});\\;\\;\n    {\\bm{v}}= f_v({\\bm{c}}).')
('3.0', 'f_q, f_k, f_v')
('3.1', '\\{{\\bm{x}}_1, {\\bm{x}}_2\\}')
('3.1', '{\\bm{x}}')
('3.1', '50\\%')
('3.1', '100\\%')
('3.1', '\\tau=0.5')
('3.1', '\\{{\\bm{x}}_1, {\\bm{x}}_2\\}')
('3.1', '\\{{\\bm{x}}_1, {\\bm{x}}_2\\}')
('3.1', 'c')
('3.1', '\\tau')
('3.1', '\\{{\\bm{x}}_1, {\\bm{x}}_2\\}')
('3.1', '{\\bm{b}}')
('3.1', 'n=10')
('3.1', '\\{{\\bm{b}}_1, {\\bm{b}}_2\\}')
('3.1', '{\\bm{b}}')
('3.2', '\\{{\\bm{x}}_1, {\\bm{x}}_2\\}')
('3.2', '\\{{\\bm{h}}_1, {\\bm{h}}_2\\} = \\texttt{Backbone}(\\{{\\bm{x}}_1, {\\bm{x}}_2\\})')
('3.2', '\\{{\\bm{z}}_1,{\\bm{z}}_2\\}')
('3.2', '\\{{\\bm{h}}_1, {\\bm{h}}_2\\}')
('3.2', '\\{{\\bm{b}}_1,{\\bm{b}}_2\\}')
('3.2', '\\label{eq:z}\n\\begin{aligned}\n    {\\bm{z}}_1 &= \\texttt{RoIAlign}({\\bm{h}}_1, {\\bm{b}}_1); \\\\\n    {\\bm{z}}_2 &= \\texttt{RoIAlign}({\\bm{h}}_2, {\\bm{b}}_2).\n\\end{aligned}')
('3.2', '\\{{\\bm{p}}_1,{\\bm{p}}_2\\}\\in\\mathbb{R}^{C\\times H_3\\times W_3}')
('3.2', '\\label{eq:p}\n\\begin{aligned}\n    {\\bm{p}}_1 &= \\texttt{Backbone}(\\texttt{Crop}({\\bm{x}}_1, {\\bm{b}}_1)); \\\\\n    {\\bm{p}}_2 &= \\texttt{Backbone}(\\texttt{Crop}({\\bm{x}}_2, {\\bm{b}}_2)).\n\\end{aligned}')
('3.2', '\\{{\\bm{z}}_1,{\\bm{z}}_2\\}')
('3.2', '\\{{\\bm{p}}_1,{\\bm{p}}_2\\}')
('3.2', '\\texttt{MVCA}')
('3.2', '\\{({\\bm{c}}_1, {\\bm{z}}_1, {\\bm{p}}_1, {\\bm{b}}_1), ({\\bm{c}}_2, {\\bm{z}}_2, {\\bm{p}}_2, {\\bm{b}}_2)\\}')
('3.2', '{\\bm{x}}_1')
('3.2', '{\\bm{x}}_2')
('3.2', '\\label{eq:mvca}\n    \\widehat{{\\bm{q}}}_2 = \\texttt{MVCA}({\\bm{c}}_2, {\\bm{\\phi}}_q, {\\bm{z}}_1) = \\texttt{MHA}({\\bm{q}}_1, {\\bm{k}}_2, {\\bm{v}}_2),')
('3.2', '{\\bm{q}}_1')
('3.2', '{\\bm{k}}_2')
('3.2', '{\\bm{v}}_2')
('3.2', '{\\bm{q}}_1 = f_q({\\bm{z}}_1 + {\\bm{\\phi}}_q);\\;\\;\n    {\\bm{k}}_2 = f_k({\\bm{c}}_2);\\;\\;\n    {\\bm{v}}_2 = f_v({\\bm{c}}_2).\n    \\label{eq:cv_kvq}')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{x}}_1')
('3.2', '{\\bm{\\phi}}_q')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{\\phi}}_q')
('3.2', '\\widehat{{\\bm{q}}}_2')
('3.2', '{\\bm{c}}_2')
('3.2', '{\\bm{x}}_2')
('3.2', '\\widehat{{\\bm{q}}}_2')
('3.2', '{\\bm{x}}_2')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{x}}_1')
('3.2', '\\texttt{MVCA}')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{x}}_1')
('3.2', '\\widehat{{\\bm{q}}}_2')
('3.2', '{\\bm{x}}_2')
('3.2', '{\\bm{z}}_1')
('3.2', 'f_{box}')
('3.2', '\\label{eq:box_head}\n    \\widehat{{\\bm{b}}}_2 = f_{box}(\\widehat{{\\bm{q}}}_2)\\in\\mathbb{R}^{N\\times 4}.')
('3.2', '\\label{eq:loc}\n    \\mathcal{L}_{loc}  = \\ell_{box}(\\widehat{{\\bm{b}}}_2, {\\bm{b}}_2) + \\ell_{box}(\\widehat{{\\bm{b}}}_1, {\\bm{b}}_1),')
('3.2', '\\ell_{box}')
('3.2', '\\ell_1')
('3.2', 'f_{sem}')
('3.2', "\\label{eq:discriminative_head}\n    \\widehat{{\\bm{p}}}_2 = f_{sem}(\\widehat{{\\bm{q}}}_2)\\in\\mathbb{R}^{N\\times C'}.")
('3.2', '{\\bm{c}}')
('3.2', '\\mathcal{L}_{g}')
('3.2', '\\label{eq:disc_g}\n\\begin{aligned}\n    \\mathcal{L}_g=\\mathcal{C}\\big[\\texttt{MLP}({\\bm{c}}_1), &\\texttt{detach}({\\bm{c}}_2)\\big] + \\\\\n    &\\mathcal{C}\\big[\\texttt{MLP}({\\bm{c}}_2), \\texttt{detach}({\\bm{c}}_1)\\big],\n\\end{aligned}')
('3.2', '\\mathcal{C}')
('3.2', '{\\bm{z}}_1')
('3.2', '\\widehat{{\\bm{q}}}_2')
('3.2', '{\\bm{p}}_1')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{z}}_1')
('3.2', '{\\bm{p}}_1')
('3.2', '{\\bm{p}}_1')
('3.2', '\\label{eq:disc_r}\n    \\mathcal{L}_{r} = \\mathcal{D}(\\widehat{{\\bm{p}}}_2, {\\bm{p}}_1) + \\mathcal{D}(\\widehat{{\\bm{p}}}_1, {\\bm{p}}_2),')
('3.2', '\\mathcal{D}')
('3.2', '\\ell_2')
('3.2', '\\label{eq:all}\n    \\mathcal{L} =  \\lambda_0\\mathcal{L}_{r} + \\lambda_1\\mathcal{L}_{g} + \\lambda_2\\mathcal{L}_{loc},')
('3.2', '\\lambda_{0/1/2}')
('4.0', '\\sim')
('4.0', '\\sim')
('4.0', '\\sim')
('4.0', '_{50}')
('4.0', '_{75}')
('4.0', '_{s}')
('4.0', '_{m}')
('4.0', '_{l}')
('4.0', '1\\times10^{-4}')
('4.0', '1\\times10^{-4}')
('4.0', '1\\times10^{-4}')
('4.0', '5\\times10^{-5}')
('4.0', '1\\times10^{-4}')
('4.0', '2\\times10^{-4}')
('4.0', '5\\times10^{-5}')
('4.0', '2\\times10^{-5}')
('4.1', '_{50}')
('4.1', '_{75}')
('4.2', '\\rightarrow')
('6.0', '{\\bm{x}}_{kv}')
('6.0', '{\\bm{x}}_q')
('6.0', 'f_v, f_k, f_q')
('6.0', '{\\bm{q}}')
('6.0', '{\\bm{k}}')
('6.0', '{\\bm{v}}')
('6.0', '\\begin{aligned}\n    {\\bm{q}}&=f_q({\\bm{x}}_q+{\\bm{\\phi}}_q);\\\\\n    {\\bm{k}}&=f_k({\\bm{x}}_{kv}+{\\bm{\\phi}}_p);\\\\\n    {\\bm{v}}&=f_v({\\bm{x}}_{kv}),\n\\end{aligned}')
('6.0', '{\\bm{\\phi}}_{p}')
('6.0', '{\\bm{\\phi}}_{q}')
('6.0', '\\widehat{q}')
('6.0', '\\widehat{q}=\\texttt{SHA}({\\bm{q}},{\\bm{k}},{\\bm{v}})=\\sum_j\\alpha_{i,j}{\\bm{v}}_j,')
('6.0', 'i')
('6.0', 'j')
('6.0', '\\alpha_{i,j}=\\texttt{Softmax}(\\frac{{\\bm{q}}_i{\\bm{k}}_j^T}{\\sqrt{d_k}}),')
('6.0', 'd_k')
('6.0', 'N')
('6.0', 'f_{\\texttt{MHA}}')
('6.0', '\\begin{aligned}\n        \\widehat{q}&=\\texttt{MHA}({\\bm{q}},{\\bm{k}},{\\bm{v}})\\\\\n        &=f_{\\texttt{MHA}}\\Big(\\texttt{Concat}\\big[\\texttt{SHA}_0({\\bm{q}},{\\bm{k}},{\\bm{v}}),\\dots,\\texttt{SHA}_N({\\bm{q}},{\\bm{k}},{\\bm{v}})\\big]\\Big).\n    \\end{aligned}')
('6.0', '\\widehat{q}')
('6.0', '{\\bm{x}}_q')
('6.1', 'N')
('6.1', '\\widehat{y}')
('6.1', 'y')
('6.1', '\\mathcal{H}')
('6.1', '\\mathcal{H}(y, \\widehat{y})=\\sum_{i=1}^N\\Big[-\\eta_0\\log\\widehat{{\\bm{k}}}_{\\widehat{\\sigma}(i)}+\\bm{1}_\\mathrm{\\{{\\bm{k}}_i=1\\}}\\mathcal{L}_{box}({\\bm{b}}_i,\\widehat{{\\bm{b}}}_{\\widehat{\\sigma}(i)})\\Big],\n  \\label{eq:hungarian}')
('6.1', '{\\bm{k}}')
('6.1', '{\\bm{k}}_i=1')
('6.1', '{\\bm{k}}_i=0')
('6.1', '\\mathcal{L}_{box}')
('6.1', '\\ell_1')
('6.1', '\\widehat{\\sigma}(i)')
('6.1', 'i')
('6.1', '\\eta_0')
('6.1', '\\eta_1')
('6.1', '\\ell_1')
('6.1', '\\eta_2')
('7', '\\mathcal{L}_{loc}')
('7', '\\lambda_2')
('7', '\\lambda_0')
('7', '\\lambda_1')
('7', '\\lambda_0')
('7', '\\lambda_1')
('7', '\\lambda_0')
('7', '\\lambda_1')
('7', '\\lambda_0')
('7', '\\lambda_1')
('7', '\\lambda_0')
('7', '\\lambda_1')
('7', '\\lambda_1=1.0,\\lambda_2=1.0')
('7', 'K')
('7', 'K')
