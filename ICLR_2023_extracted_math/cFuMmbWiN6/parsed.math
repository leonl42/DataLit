('1', 'x_1,\\ldots, x_n')
('1', '\\label{eq:intro_message_passing}\n  \\begin{split}\n    \\text{(Information Retrieval)} \\quad x_i &\\gets \\mathrm{Aggregate}\\big(x_i, \\left\\{m_{j \\to i}\\right\\}_{j=1}^{n}\\big), \\\\\n    \\text{(Local Processing)} \\quad x_i &\\gets \\mathrm{Process}(x_i).\n  \\end{split}')
('1', 'j')
('1', 'i')
('1', 'm_{j \\to i} = \\phi_v(x_j)')
('1', 'm_{j \\to i} = r(x_i, x_j)')
('1', 'r(\\cdot, \\cdot)')
('1', 'v_i')
('1', 'r(x, y_i)')
('1', 's_i')
('1', '\\alpha_i')
('1', '\\mathrm{Attention}(x, (y_1, \\ldots, y_n))')
('1', '\\mathrm{RelationalAttention}(x, (y_1, \\ldots, y_n))')
('2.0', 'x \\in \\mathbb{R}^d')
('2.0', '\\bm{y}= (y_1, \\ldots, y_n)\\in \\mathbb{R}^{n \\times d}')
('2.0', '\\label{eq:self_attn}\n  \\begin{split}\n    \\mathrm{Attention}(x, (y_1, \\ldots, y_n)) &= \\sum_{i=1}^{n} \\alpha_i(x, \\bm{y}) \\phi_v(y_i), \\ \\text{where}, \\\\\n    \\alpha(x, \\bm{y}) &= \\mathrm{Softmax}\\big(\\left[\\left \\langle \\phi_q^{\\mathrm{attn}}(x), \\phi_k^{\\mathrm{attn}}(y_i) \\right\\rangle\\right]_{i=1}^{n}\\big),\n  \\end{split}')
('2.0', '\\phi_q^{\\mathrm{attn}},\\phi_k^{\\mathrm{attn}}')
('2.0', '\\phi_v')
('2.0', 'y_i')
('2.0', '\\alpha(x, \\bm{y})')
('2.0', '\\alpha_i(x, \\bm{y})')
('2.0', 'i')
('2.1', '\\label{eq:rel_attn}\n  \\begin{split}\n    \\mathrm{RelationalAttention}(x, (y_1, \\ldots, y_n)) &= \\sum_{i=1}^{n} \\alpha_i(x, \\bm{y}) \\big(r(x, y_i) W_r + s_i W_s\\big), \\ \\text{where},\\\\\n    \\alpha(x, \\bm{y}) &= \\mathrm{Softmax}\\big(\\left[\\left \\langle \\phi_q^{\\mathrm{attn}}(x), \\phi_k^{\\mathrm{attn}}(y_i) \\right\\rangle\\right]_{i=1}^{n}\\big), \\\\\n    % r(x, y_i) &= \\bigparen{\\iprod{\\phi_{q,1}^{\\rel}(x)}{\\phi_{k,1}^{\\rel}(y_i)}, \\ldots, \\iprod{\\phi_{q, d_r}^{\\rel}(x)}{\\phi_{k, d_r}^{\\rel}(y_i)}}, \\\\\n    r(x, y_i) &= \\big(\\left \\langle \\phi_{q, \\ell}^{\\mathrm{rel}}(x), \\phi_{k, \\ell}^{\\mathrm{rel}}(y_i) \\right\\rangle\\big)_{\\ell \\in [d_r]}, \\\\\n    % r(x, y_i) &= \\bigbra{\\iprod{\\phiqrell{\\ell}(x)}{\\phikrell{\\ell}(y_i)}}_{\\ell = 1}^{d_r}, \\\\\n    (s_1, \\ldots, s_n) &= \\mathrm{SymbolRetriever}(\\bm{y};\\,S_\\mathrm{lib})\n  \\end{split}')
('2.1', 'x')
('2.1', '\\bm{y}= (y_1, \\ldots, y_n)')
('2.1', '\\{r(x, y_i)\\}_{i=1}^{n}')
('2.1', 'x')
('2.1', 's_i')
('2.1', 'S_\\mathrm{lib}')
('2.1', '\\phi_q^{\\mathrm{attn}}, \\phi_k^{\\mathrm{attn}}')
('2.1', '\\phi_{q, \\ell}^{\\mathrm{rel}}, \\phi_{k, \\ell}^{\\mathrm{rel}}, \\ell \\in [d_r]')
('2.1', '\\ell \\in [d_r]')
('2.1', '\\phi_{q, \\ell}^{\\mathrm{rel}}, \\phi_{k, \\ell}^{\\mathrm{rel}}')
('2.1', 'd_r')
('2.1', '(\\langle \\phi_{q, \\ell}^{\\mathrm{rel}}(x), \\phi_{k, \\ell}^{\\mathrm{rel}}(y_i) \\rangle)_{\\ell \\in [d_r]}')
('2.1', 'r(\\cdot, \\cdot)')
('2.1', 'r(x, y) = r(y, x),\\, \\forall x, y')
('2.1', '\\phi_q^{\\mathrm{rel}}= \\phi_k^{\\mathrm{rel}}')
('2.2', 'r(x, y_i)')
('2.2', 's_i')
('2.2', 's_i')
('2.2', 's_i')
('2.2', 'y_i')
('2.2', 's_i')
('2.2', 'S_\\mathrm{lib}')
('2.2', 'S_\\mathrm{lib}= (s_1, \\ldots, s_{\\mathtt{max\\_len}}) \\in \\mathbb{R}^{\\mathtt{max\\_len} \\times d}')
('2.2', 's_i')
('2.2', 'i')
('2.2', 'S_\\mathrm{lib}= (s_{-\\Delta}, \\ldots, s_{-1}, s_0, s_1, \\ldots, s_{\\Delta}) \\in \\mathbb{R}^{(2 \\Delta + 1) \\times d}')
('2.2', '\\Delta')
('2.2', '\\sum_{j} \\alpha_{ij}  (r(x_i, x_j) \\, W_r + s_{j-i} \\,  W_s)')
('2.2', 'S_\\mathrm{lib}= (s_1, \\ldots, s_{n_s}) \\in \\mathbb{R}^{n_s \\times d}')
('2.2', 'F_\\mathrm{lib}= (f_1, \\ldots, f_{n_s})')
('2.2', 'x_i')
('2.2', 'f_j')
('2.2', 's_j')
('2.2', '\\mathrm{SymbolicAttention}(\\bm{x}) = \\mathrm{Softmax}\\big((\\bm{x}\\, W_q)\\, F_\\mathrm{lib}^\\top\\big) S_\\mathrm{lib}.')
('2.2', 'S_\\mathrm{lib}, F_\\mathrm{lib}, W_q')
('2.3', '{\\mathcal{X}}\\times {\\mathcal{Y}}^n')
('2.3', '(y_1, \\ldots, y_n)')
('2.3', '\\mathrm{Select}: {\\mathcal{X}}\\times {\\mathcal{Y}}^n \\to {\\mathcal{Y}}')
('2.3', '(y_1, \\ldots, y_n)')
('2.3', '\\{\\preccurlyeq_x\\}_{x \\in {\\mathcal{X}}}')
('2.3', '\\mathrm{Rel}: {\\mathcal{X}}\\times {\\mathcal{Y}}\\to \\mathbb{R}^{d_r}')
('2.3', '{\\mathcal{X}}\\times {\\mathcal{Y}}')
('2.3', '\\mathrm{Rel}(x, \\mathrm{Select}(x, \\bm{y}))')
('3.0', 'n_h^{sa}')
('3.0', 'n_h^{ra}')
('3.0', 'n_h \\coloneq n_h^{sa}+ n_h^{ra}')
('3.0', '\\begin{aligned}\n        \\bm{\\alpha}^{(h)} &\\gets \\mathrm{Softmax}\\big({(\\bm{x}\\, W_{q, h}^{\\mathrm{attn}})} {(\\bm{x}\\, W_{k, h}^{\\mathrm{attn}})}^\\intercal\\big), \\qquad && h \\in [n_h^{sa}] \\\\\n        e_i^{(h)} &\\gets \\sum_{j} \\alpha_{ij}^{(h)} x_j \\, W_v^h, \\qquad && i \\in [n], h \\in [n_h^{sa}]\\\\\n        e_i &\\gets \\mathrm{concat}\\big(e_i^{(1)}, \\ldots, e_i^{(n_h^{sa})}\\big) \\, W_o^{sa}, && i \\in [n]\n    \n\\end{aligned}')
('3.0', '\\bm{s}= (s_1, \\ldots, s_n) \\gets \\mathrm{SymbolRetriever}(\\bm{x};\\,S_\\mathrm{lib})')
('3.0', '\\begin{aligned}\n        \\bm{\\alpha}^{(h)} &\\gets \\mathrm{Softmax}\\big({(\\bm{x}\\, W_{q, h}^{\\mathrm{attn}})} {(\\bm{x}\\, W_{k, h}^{\\mathrm{attn}})}^\\intercal\\big), \\qquad && h \\in [n_h^{ra}] \\\\\n        \\bm{r}_{ij} &\\gets \\big(\\left \\langle x_i \\, W_{q, \\ell}^{\\mathrm{rel}}, x_j \\, W_{k, \\ell}^{\\mathrm{rel}} \\right\\rangle\\big)_{\\ell \\in [d_r]} \\qquad && i,j \\in [n] \\\\\n        a_i^{(h)} &\\gets \\sum_{j} \\alpha_{ij}^{(h)} \\big(\\bm{r}_{ij}\\,W_r^h + s_j \\, W_s^{h}\\big), \\qquad && i \\in [n],\\, h \\in [n_h^{ra}]\\\\\n        a_i &\\gets \\mathrm{concat}\\big(a_i^{(1)}, \\ldots, a_i^{(n_h^{ra})}\\big) W_o^{ra}, && i \\in [n]\n    \n\\end{aligned}')
('3.0', '\\alpha_{ij}^h')
('3.0', 'O(n^2)')
('3.0', '\\bm{r}_{ij}')
('3.0', 'W_{q}^{\\mathrm{rel}} = W_k^{\\mathrm{rel}}')
('3.1', '\\bm{x}\\gets \\mathrm{Norm}(\\bm{x}+ \\mathrm{DualAttn}(\\bm{x}))')
('3.1', '\\bm{x}\\gets \\mathrm{Norm}(\\bm{x}+ \\mathrm{MLP}(\\bm{x}))')
('3.1', '\\hphantom{\\bm{x}\\gets \\mathrm{Norm}(\\bm{x}+ \\mathrm{MLP}(\\bm{x}))}')
('3.1', '\\bm{x}')
('3.1', '\\bm{x}\\gets \\mathrm{Norm}(\\bm{x}+ \\mathrm{DualAttn}(\\bm{x}))')
('3.1', '\\bm{x}\\gets \\mathrm{Norm}(\\bm{x}+ \\mathrm{CrossAttn}(\\bm{x}, \\bm{y}))')
('3.1', '\\bm{x}\\gets \\mathrm{Norm}(\\bm{x}+ \\mathrm{MLP}(\\bm{x}))')
('3.1', '\\bm{x}')
('4.0', '\\mathtt{match\\,\\,pattern}')
('4.1', '\\mathtt{polynomials\\_\\_expand}')
('4.1', '\\mathtt{Expand}\\, (5x-3)(2x+1)')
('4.1', '10x^2 -x -3')
('4.1', 'n_h^{sa}= 8')
('4.1', 'n_h^{sa}= n_h^{ra}= 4')
('4.2', '\\pm')
('4.2', 'd_{\\text{model}}')
('4.2', 'n_h^{sa}')
('4.2', 'n_h^{ra}')
('4.2', '86.4 \\pm 0.1\\%')
('4.2', '\\mathbf{89.7 \\pm 0.1\\%}')
('4.2', '68.8 \\pm 0.2\\%')
('4.2', '\\mathbf{70.5 \\pm 0.1\\%}')
('4.2', 'd_{\\mathrm{model}}= d_{\\mathrm{ff}}= 384')
('4.2', 'n_h^{sa}= 12')
('4.2', 'n_h^{sa}= n_h^{ra}= 6')
('4.2', '\\bm{r}_{ij}')
('4.3', '\\boldsymbol{r}_{ij}')
('4.3', '\\bm{r}_{ij}')
('4.3', '\\bm{r}_{ij} \\in \\mathbb{R}^{d_r}')
('8', '\\mathbb{R}^d \\times \\mathbb{R}^{n \\times d} \\to \\mathbb{R}^{d_{\\mathrm{out}}}')
('8', 'd')
('8', 'd_{\\mathrm{out}}')
('8', '{\\mathcal{X}}')
('8', '{\\mathcal{Y}}')
('8', '\\mathbb{R}^d')
('8', 'x \\in {\\mathcal{X}}')
('8', '\\bm{y}= (y_1, \\ldots, y_n)\\in {\\mathcal{Y}}^n')
('8', '\\begin{aligned}\n  \\mathrm{RA}(x, \\bm{y}) &= \\sum_{i=1}^{n} \\alpha_i(x; \\bm{y}) \\big(r(x, y_i) \\, W_r +  s_i \\, W_s\\big), \\\\\n  \\alpha(x; \\bm{y}) &= \\mathrm{Softmax}\\Big(\\big[\\left \\langle \\phi_q^{\\mathrm{attn}}(x), \\phi_k^{\\mathrm{attn}}(y_i) \\right\\rangle\\big]_{i=1}^{n}\\Big) \\in \\Delta^n, \\\\\n  r(x, y_i) &= \\left(\\left \\langle \\phi_{q,\\ell}^{\\mathrm{rel}}(x), \\phi_{k,\\ell}^{\\mathrm{rel}}(y_i) \\right\\rangle\\right)_{\\ell \\in [d_r]} \\in \\mathbb{R}^{d_r}, \\\\\n  (s_1, \\ldots, s_n) &= \\mathrm{SymbolRetriever}\\left(\\bm{y};\\, S_\\mathrm{lib}\\right) \\in \\mathbb{R}^{n \\times d_{\\mathrm{out}}},\n\\end{aligned}')
('8', '\\phi_q^{\\mathrm{attn}}, \\phi_k^{\\mathrm{attn}}, \\phi_{q,\\ell}^{\\mathrm{rel}}, \\phi_{k,\\ell}^{\\mathrm{rel}}: \\mathbb{R}^{d} \\to \\mathbb{R}^{d_k}')
('8', 'W_r = I, d_{\\mathrm{out}} = d_r')
('8', 'W_s = 0')
('8', '(y_1, \\ldots, y_n)')
('8', 'r: {\\mathcal{X}}\\times {\\mathcal{Y}}\\to \\mathbb{R}^{d_r}')
('8', '\\{\\preccurlyeq_x\\}_x')
('8', 'x')
('8', '\\preccurlyeq_x')
('8', '{\\mathcal{Y}}')
('8', 'y_1 \\preccurlyeq_x y_2')
('8', 'y_2')
('8', 'x')
('8', 'y_1')
('8', 'x \\in {\\mathcal{X}}')
('8', '\\preccurlyeq_x')
('8', 'y_1, y_2 \\in {\\mathcal{Y}}')
('8', 'y_1 \\preccurlyeq y_2')
('8', 'y_2 \\preccurlyeq_x y_1')
('8', 'y \\preccurlyeq_x y')
('8', 'y \\in {\\mathcal{Y}}')
('8', 'y_1 \\preccurlyeq_x y_2')
('8', 'y_2 \\preccurlyeq_x y_3')
('8', 'y_1 \\preccurlyeq_x y_3')
('8', 'x \\in {\\mathcal{X}}')
('8', '\\preccurlyeq_x')
('8', '({\\mathcal{Y}}, \\preccurlyeq_x)')
('8', '\\prec_x')
('8', '\\sim_x')
('8', 'y_1 \\prec_x y_2')
('8', 'y_1 \\preccurlyeq_x y_2')
('8', 'y_2 \\preccurlyeq_x y_1')
('8', 'y_1 \\sim y_2')
('8', 'y_1 \\preccurlyeq_x y_2')
('8', 'y_2 \\preccurlyeq_x y_1')
('8', '\\bm{y}= (y_1, \\ldots, y_n)\\in {\\mathcal{Y}}^n')
('8', 'x \\in {\\mathcal{X}}')
('8', '\\preccurlyeq_x')
('8', '\\label{eq:def_selection}\n  \\mathrm{Select}(x, (y_1, \\ldots, y_n)) \\coloneq \\max\\left((y_1, \\ldots, y_n), \\mathtt{key}=\\preccurlyeq_x\\right).')
('8', '\\mathrm{Select}(x, \\bm{y})')
('8', 'x')
('8', 'y_i')
('8', 'y_i \\succ_x y_j, \\ \\forall j \\neq i')
('8', '(y_1, \\ldots, y_n)')
('8', '\\{\\preccurlyeq_x\\}_x')
('8', '{\\mathcal{Y}}')
('8', 'x')
('8', '{\\mathcal{X}}')
('8', '\\{\\preccurlyeq_x\\}_{x \\in {\\mathcal{X}}}')
('8', 'x \\in {\\mathcal{X}}')
('8', '\\preccurlyeq_x')
('8', '(y_i)_i')
('8', 'y_i \\preccurlyeq_x z')
('8', 'y_i \\to y_{\\infty}')
('8', 'y_\\infty \\preccurlyeq_x z')
('8', 'y \\in {\\mathcal{Y}}')
('8', '\\{z \\in {\\mathcal{Y}}: z \\preccurlyeq_x y\\}')
('8', '\\{z \\in {\\mathcal{Y}}: y \\preccurlyeq_x z\\}')
('8', '{\\mathcal{Y}}')
('8', 'x \\in {\\mathcal{X}}')
('8', 'u_x: {\\mathcal{Y}}\\to \\mathbb{R}')
('8', '\\preccurlyeq_x')
('8', 'y_1 \\preccurlyeq_x y_2 \\iff u_x(y_1) \\leq u_x(y_2)')
('8', '\\{u_x: {\\mathcal{Y}}\\to \\mathbb{R}\\}_{x \\in {\\mathcal{X}}}')
('8', 'u(x, y) \\coloneq u_x(y)')
('8', '{\\mathcal{X}}\\times {\\mathcal{Y}}^n')
('8', '(x, \\bm{y}) \\sim {\\mathbb{P}}_{x,\\bm{y}}')
('8', '\\varepsilon> 0')
('8', '\\eta_\\varepsilon> 0')
('8', '\\min_{j \\neq i} \\left\\lvert u_x(y_i) - u_x(y_j)\\right\\rvert > \\eta_\\varepsilon')
('8', '1 - \\varepsilon')
('8', '{\\mathcal{X}}, {\\mathcal{Y}}')
('8', '\\{\\preccurlyeq_x\\}_{x \\in {\\mathcal{X}}}')
('8', '{\\mathcal{Y}}')
('8', '\\mathrm{Select}(x, (y_1, \\ldots, y_n)) = \\max((y_1, \\ldots, y_n), \\mathtt{key}=\\preccurlyeq_x)')
('8', '\\{\\preccurlyeq_x\\}_{x}')
('8', 'R: {\\mathcal{X}}\\times {\\mathcal{Y}}\\to \\mathbb{R}^{d_r}')
('8', 'x, \\bm{y}\\sim {\\mathbb{P}}_{x, \\bm{y}}')
('8', '\\varepsilon> 0')
('8', '\\phi_q^{\\mathrm{attn}}, \\phi_k^{\\mathrm{attn}}, \\phi_q^{\\mathrm{rel}}, \\phi_k^{\\mathrm{rel}}')
('8', '\\left\\lVert\\mathrm{RA}(x, (y_1, \\ldots, y_n)) - R(x, \\mathrm{Select}(x, (y_1, \\ldots, y_n)))\\right\\rVert_{\\infty} < \\varepsilon')
('8', '{\\mathcal{E}}:= \\{(x, \\bm{y}) \\in {\\mathcal{X}}\\times {\\mathcal{Y}}^n \\,\\colon\\, \\min_{j \\neq i} \\left\\lvert u_x(y_i) - u_x(y_j)\\right\\rvert > \\eta_\\varepsilon\\}')
('8', 'i^* = \\mathop{\\mathrm{arg\\,max}}((y_1, \\ldots, y_n), \\mathtt{key} = \\preccurlyeq_x) = \\mathop{\\mathrm{arg\\,max}}(u_x(y_1), \\ldots, u_x(y_n))')
('8', '\\varepsilon_1 > 0')
('8', '\\phi_q^{\\mathrm{attn}}, \\phi_k^{\\mathrm{attn}}')
('8', '\\alpha_{i^*}(x, \\bm{y}) > 1 - \\varepsilon_1')
('8', '(x, \\bm{y}) \\in {\\mathcal{E}}')
('8', '1')
('8', '\\preccurlyeq_x')
('8', '{\\mathcal{E}}')
('8', '\\varepsilon_2 > 0')
('8', '(\\phi_{q, \\ell}^{\\mathrm{rel}}, \\phi_{k, \\ell}^{\\mathrm{rel}})_{\\ell \\in [d_r]}')
('8', 'r(x, y) \\coloneq (\\langle \\phi_{q, \\ell}^{\\mathrm{rel}}(x), \\phi_{k, \\ell}^{\\mathrm{rel}}(y) \\rangle)_{\\ell \\in [d_r]}')
('8', 'R')
('8', '\\varepsilon_2')
('8', '\\left\\lVert R(x, y) - r(x, y)\\right\\rVert_{\\infty} < \\varepsilon_2, \\quad \\text{Lebesgue almost every } (x, y) \\in {\\mathcal{X}}\\times {\\mathcal{Y}}.')
('8', '\\begin{aligned}\n    &\\left\\lVert\\mathrm{RA}(x, (y_1, \\ldots, y_n)) - R(x, \\mathrm{Select}(x, (y_1, \\ldots, y_n)))\\right\\rVert_{\\infty} \\\\\n    &= \\left\\lVert\\sum_{i=1}^{n} \\alpha_i(x; \\bm{y}) \\,r(x, y_i) - R(x, y_{i^*})\\right\\rVert_{\\infty} \\\\\n    &\\leq \\sum_{i=1}^{n} \\left\\lVert\\alpha_i(x; \\bm{y}) \\,r(x, y_i) - R(x, y_{i^*})\\right\\rVert_{\\infty} \\\\\n    &\\leq \\alpha_{i^*}(x, \\bm{y}) \\left\\lVert r(x, y_{i^*}) - R(x, y_{i^*})\\right\\rVert_{\\infty} + \\sum_{j \\neq i^*} \\alpha_i(x; \\bm{y}) \\left\\lVert r(x, y_i) - R(x, y_{i^*})\\right\\rVert_{\\infty}\\\\\n    &\\leq (1 - \\varepsilon_1) \\varepsilon_2 + \\varepsilon_1 \\max_{x, y, y^*} \\left\\lVert r(x, y) - R(x, y^{*})\\right\\rVert_{\\infty}.\n  \n\\end{aligned}')
('8', '\\max_{x, y, y^*} \\left\\lVert r(x, y) - R(x, y^*)\\right\\rVert_{\\infty}')
('8', '{\\mathcal{X}}, {\\mathcal{Y}}')
('8', 'r, R')
('8', '\\varepsilon_1, \\varepsilon_2')
('9.0', 'n_h := n_h^{sa}+ n_h^{ra}')
('9.0', 'h \\in [n_h^{sa}]')
('9.0', 'W_{q, h}^{\\mathrm{attn}}, W_{k, h}^{\\mathrm{attn}} \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_{\\mathrm{key}}}')
('9.0', 'W_v^h \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_h}')
('9.0', 'W_o^{sa} \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_{\\mathrm{model}}}')
('9.0', 'h \\in [n_h^{ra}]')
('9.0', '\\ell \\in [d_r]')
('9.0', 'W_{q, h}^{\\mathrm{attn}}, W_{k, h}^{\\mathrm{attn}} \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_{\\mathrm{key}}}')
('9.0', 'W_{q, \\ell}^{\\mathrm{rel}}, W_{k, \\ell}^{\\mathrm{rel}} \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_{\\mathrm{proj}}}')
('9.0', 'W_s^h \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_h}')
('9.0', 'W_r^h \\in \\mathbb{R}^{d_r \\times d_h}')
('9.0', 'W_o^{ra} \\in \\mathbb{R}^{d_{\\mathrm{model}}\\times d_{\\mathrm{model}}}')
('9.0', 'd_{\\mathrm{key}}, d_h = d_{\\mathrm{model}}/ n_h')
('9.0', 'd_{\\mathrm{proj}}= d_h \\cdot n_h^{ra}/ d_r')
('9.0', 'd_r')
('9.0', 'd_{\\mathrm{proj}}')
('9.0', 'd_r')
('9.0', 'd_{\\mathrm{proj}}')
('9.0', 'W_{q, \\ell}^{\\mathrm{rel}} = W_{k, \\ell}^{\\mathrm{rel}}')
('9.0', 'd_r')
('9.0', 'n_h^{ra}')
('9.0', 'W_r^h')
('9.0', 'd_h = d_{\\mathrm{model}}/ n_h')
('9.0', 'd_h')
('9.0', 'd_{\\mathrm{model}}')
('9.0', 'n_h^{sa}= 6, n_h^{ra}= 2')
('9.0', 'd_{\\mathrm{model}}')
('9.0', 'a_i^{(h)} \\gets \\sum_{j} \\alpha_{ij}^{(h)} \\big(\\bm{r}_{ij} W_r^h + s_j W_s^h\\big),')
('9.0', '\\alpha_{ij}^{(h)}')
('9.0', 'h \\in [n_h^{ra}]')
('9.0', '\\bm{r}_{ij} \\in \\mathbb{R}^{d_r}')
('9.0', 's_j \\in \\mathbb{R}^{d_{\\mathrm{model}}}')
('9.0', 'j')
('9.0', 'W_r^h, W_s^h')
('9.0', '\\bm{r}_{ij}')
('9.0', 's_j')
('9.0', 'd_h')
('9.0', '\\sum_{j} \\alpha_{ij}^{(h)} \\big(\\bm{r}_{ij} W_r^h + s_j W_s^h\\big) = \\sum_{j} \\big(\\alpha_{ij}^{(h)} s_j W_s^h\\big) + \\big(\\sum_{j} \\alpha_{ij}^{(h)} \\bm{r}_{ij}\\big) W_r^h.')
('9.0', 'W_r^h')
('9.0', '\\sum_{j} \\alpha_{ij}^{(h)} \\bm{r}_{ij}')
('9.0', '\\texttt{sv[:,:,h,:]} = \\bm{s}\\,W_s^h')
('9.0', '\\texttt{attn\\_scores[:,h,:,:]} = \\bm{\\alpha}^h')
('9.0', '\\texttt{relations[:, i,j,:]} = \\bm{r}_{ij}')
('9.0', '\\sum_{j} \\alpha_{ij}^h s_j W_s^h')
('9.0', '\\sum_{j} \\alpha_{ij}^h \\bm{r}_{ij}')
('9.0', 'W_r^h')
('9.0', 'W_r^h')
('9.0', 'W_r^h')
('9.0', 'b \\times n \\times n \\times n_h^{ra}\\times d_h')
('9.0', '{\\mathcal{O}}(b \\cdot n^2 \\cdot d_{\\mathrm{model}})')
('9.0', 'W_r^h')
('9.0', 'b \\times n \\times n \\times d_r')
('9.0', 'd_r \\ll d_{\\mathrm{model}}')
('9.0', 'b \\times n \\times d_r')
('9.0', 'b \\times n  \\times n_h^{ra}\\times d_h')
('9.0', 'd_r \\asymp n_h')
('9.0', '\\sum_{j} \\alpha_{ij}^{(h)} \\big(\\bm{r}_{ij} W_r^h + s_{j-i} W_s^h\\big)')
('9.0', 's_{j-i}')
('9.0', 'j')
('9.0', 'i')
('9.0', 'j')
('9.0', 'i')
('9.0', '\\texttt{sv[i,j,h,:]} = s_{j-i} W_s^h')
('9.1', 'd_{\\mathrm{ff}}= 4 \\cdot d_{\\mathrm{model}}')
('9.1', '\\mathrm{SwiGLU}(x) = \\mathrm{Swish}(x W + b) \\otimes (x V + c)')
('10.0.0', '36 \\times 36 \\times 3')
('10.0.0', '3 \\times 3')
('10.0.0', '12 \\times 12')
('10.0.0', 'd_{\\mathrm{model}}= 128')
('10.0.0', 'd_{\\mathrm{ff}}= 256')
('10.0.0', 'd_{\\mathrm{model}}= 144')
('10.0.0', 'd_{\\mathrm{ff}}= 288')
('10.0.0', 'W_q^{\\mathrm{rel}}= W_k^{\\mathrm{rel}}')
('10.0.0', '250')
('10.0.0', '2,500')
('10.0.0', '250')
('10.0.0', '5,000')
('10.0.0', '25,000')
('10.0.0', '5,000')
('10.0.0', '0.001')
('10.0.0', '\\beta_1 = 0.9, \\beta_2 = 0.99')
('10.0.0', '512')
('10.0.1', 'r(x, y) = (\\langle W_{q, \\ell}^{\\mathrm{rel}}, W_{k, \\ell}^{\\mathrm{rel}} \\rangle)_{\\ell \\in [d_r]} \\in \\mathbb{R}^{d_r}')
('10.0.1', 'W_{q, \\ell}^{\\mathrm{rel}} = W_{k, \\ell}^{\\mathrm{rel}}')
('10.1.0', '2 \\times 10^6')
('10.1.0', '10^4')
('10.1.0', 'd_{\\mathrm{model}}= 128, d_{\\mathrm{ff}}= 256')
('10.1.0', 'd_{\\mathrm{model}}= 144, d_{\\mathrm{ff}}= 288')
('10.1.0', '8')
('10.1.0', 'n_h^{sa}= 8')
('10.1.0', 'n_h^{sa}= n_h^{ra}= 4')
('10.1.0', 'n_h^{sa}= 8, n_h^{ra}= 0')
('10.1.0', 'n_h^{sa}= 4 = n_h^{ra}= 4')
('10.1.0', 'n_h^{sa}= 4 = n_h^{ra}= 4')
('10.1.0', '8')
('10.1.0', '\\beta_1 = 0.9, \\beta_2 = 0.995')
('10.1.0', '6 \\times 10^{-4}')
('10.2.0', '60,000')
('10.2.0', '32 \\times 32')
('10.2.0', '60,000')
('10.2.0', '4 \\times 4')
('10.2.0', 'd_{\\mathrm{model}}= d_{\\mathrm{ff}}= 384')
('10.2.0', 'n_h^{sa}= 12')
('10.2.0', 'n_h^{sa}= n_h^{ra}= 6')
('10.2.0', '\\bm{r}_{ij}')
('10.2.0', '10^{-3}')
('10.2.0', '10^{-5}')
('10.2.0', '\\beta_1 = 0.9, \\beta_2 = 0.999')
('10.2.0', '5 \\cdot 10^{-5}')
('10.2.1', '\\bm{r}_{ij}')
('10.2.1', '\\bm{r}_{ij}')
('10.2.1', 'W_q^{\\mathrm{rel}}= W_k^{\\mathrm{rel}}')
('10.2.1', '\\pm')
('10.2.1', 'd_{\\text{model}}')
('10.2.1', 'n_h^{sa}')
('10.2.1', 'n_h^{ra}')
('10.2.1', '89.5 \\pm 0.1\\%')
('10.2.1', '\\bm{91.7 \\pm 0.1\\%}')
('10.2.1', '68.2 \\pm 0.1\\%')
('10.2.1', '\\bm{70.9 \\pm 0.1\\%}')
('10.3.0', 'd_{\\mathrm{model}}= 1024, n_h = 16, L = 24')
('10.3.0', 'd_{\\mathrm{model}}= 1536, n_h = 24, L = 24')
('10.3.0', 'd_{\\mathrm{model}}= 2048, n_h = 32, L = 24')
('10.3.0', 'd_{\\mathrm{ff}}= 4 \\cdot d_{\\mathrm{model}}')
('10.3.0', '524,288')
('10.3.0', '1,024')
('10.3.0', '6 \\times 10^{-4}')
('10.3.0', '6 \\times 10^{-5}')
('10.3.0', '\\beta_1 = 0.9, \\beta_2 = 0.95')
('10.3.0', '0.1')
('10.3.1', 'd^{-\\alpha}')
('10.3.1', 'd')
('10.3.1', '\\alpha')
('10.3.1', 'd_{\\mathrm{model}}')
('10.3.1', 'n_{\\mathrm{layers}}')
('10.3.1', 'n_h^{sa}')
('10.3.1', 'n_h^{ra}')
('10.3.1', 'd_r')
('10.3.1', 'n_{kv}^{h}')
('10.3.1', '\\downarrow')
('11.0', '\\bm{x}= (x_1, \\ldots, x_n)')
('11.0', "\\bm{x}' = (x_1', \\ldots, x_n')")
('11.0', "\\begin{aligned}\n    \\bm{x}' &\\gets \\sigma_{\\mathrm{rel}}\\left(\\phi_q(\\bm{x}) {\\phi_k(\\bm{x})}^\\intercal\\right) \\bm{s}, \\\\\n    \\bm{s}&= \\mathrm{SymbolRetriever}(\\bm{x})\n\\end{aligned}")
('11.0', '\\phi_q, \\phi_k')
('11.0', '\\bm{s}')
('11.0', '\\sigma_{\\mathrm{rel}}')
('11.0', '\\sigma_{\\mathrm{rel}} = \\mathrm{Softmax}')
('11.0', "\\begin{aligned}\n&\\text{RA (this work)}    & &\\text{RCA \\citep{altabaa2024abstractors}}\\\\\n(x_1', \\ldots, x_n') &\\gets \\mathrm{RA}(\\bm{x}; S_\\mathrm{lib}), & (x_1', \\ldots, x_n') &\\gets \\mathrm{RCA}(\\bm{x}; S_\\mathrm{lib})\\\\\nx_i' &= \\sum_{j=1}^{n} \\alpha_{ij} \\, \\big(r(x_i, x_j)\\,W_r  + s_j \\, W_s\\big), & x_i' &= \\sum_{j=1}^{n} \\alpha_{ij} \\, s_j,\\\\\n\\bm{\\alpha} &= \\mathrm{Softmax}\\big(\\phi_q(\\bm{x}) {\\phi_k(\\bm{x})}^\\intercal\\big), & \\bm{\\alpha} &= \\mathrm{Softmax}\\big(\\phi_q(\\bm{x}) {\\phi_k(\\bm{x})}^\\intercal\\big),\\\\\nr(x, y) &= \\big(\\left \\langle \\phi_{q,\\ell}^{\\mathrm{rel}}(x), \\phi_{k,\\ell}^{\\mathrm{rel}}(y) \\right\\rangle\\big)_{\\ell \\in [d_r]}, & \\\\\n(s_1, \\ldots, s_n) &= \\mathrm{SymbolRetriever}(\\bm{x};\\,S_\\mathrm{lib}) & (s_1, \\ldots, s_n) &= \\mathrm{SymbolRetriever}(\\bm{x};\\,S_\\mathrm{lib})\n\\end{aligned}")
('11.0', '\\mathrm{Attention}(Q \\gets \\bm{x},\\, K \\gets \\bm{x},\\, V \\gets \\bm{s})')
('11.0', '\\alpha_{ij}')
('11.0', '\\langle \\phi_q^{\\mathrm{attn}}(x_i), \\phi_k^{\\mathrm{attn}}(x_j) \\rangle')
('11.0', 'x_i')
('11.0', 'x_j')
('11.0', 's_j')
('11.0', 'x_j')
('11.0', '\\phi_q^{\\mathrm{attn}}, \\phi_k^{\\mathrm{attn}}')
('11.0', '(\\phi_{q, \\ell}^{\\mathrm{rel}}, \\phi_{k, \\ell}^{\\mathrm{rel}})_{\\ell \\in [d_r]}')
('11.1', '\\texttt{Encoder} \\to \\texttt{Abstractor} \\to \\texttt{Decoder}')
