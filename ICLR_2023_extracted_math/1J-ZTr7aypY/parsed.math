('0.2', '\\mathcal{X}\\subseteq \\mathbb{R}^D')
('0.2', '\\mathcal{Y}\\subseteq \\mathbb{R}^M')
('0.2', '\\mathcal{S}_k \\subseteq \\mathbb{R}^{D_k}')
('0.2', 'k')
('0.2', '\\mathcal{W}\\subseteq \\mathbb{R}^P')
('0.2', '\\Lambda \\subseteq \\mathbb{R}^Q')
('0.2', '\\Theta \\subseteq \\mathbb{R}^R')
('0.2', 'N')
('0.2', 'T')
('0.2', '{\\bm x}\\in \\mathcal{X}')
('0.2', '{\\bm y}\\in \\mathcal{Y}')
('0.2', '{\\bm s}_k \\in \\mathcal{S}_k')
('0.2', 'k')
('0.2', '{\\bm w}\\in \\mathcal{W}')
('0.2', '{\\bm \\lambda}\\in \\Lambda')
('0.2', '{\\bm \\theta}\\in \\Theta')
('0.2', '\\pi \\in [0,1]')
('0.2', '{\\bm \\pi}\\in \\triangle^M')
('0.2', 'f')
('0.2', 'f(\\cdot; {\\bm x})')
('0.2', '{\\bm x}')
('0.2', 'L')
('0.2', '\\ell')
('0.2', '\\kappa')
('0.2', '\\phi')
('0.2', '\\mathrm{step}')
('0.2', '\\mathrm{logistic}_\\sigma')
('0.2', '\\sigma')
('0.2', '\\mathrm{logistic}')
('0.2', '\\mathrm{logistic}_1')
('0.2', 'p_{\\bm \\theta}')
('0.2', '{\\bm \\theta}')
('0.2', '\\rho')
('0.2', '\\mathcal{X}\\times \\mathcal{Y}')
('0.2', '\\rho_\\mathcal{X}')
('0.2', '\\mathcal{X}')
('0.2', '{\\bm \\mu}, \\sigma^2')
('0.2', 'Z')
('0.3.0.1', '10')
('1.0.0.0', 'f:\\mathbb{R}\\rightarrow \\mathbb{R}')
('1.0.0.0', 'c \\in\\mathbb{R}')
('1.0.0.0', 'v\\in \\mathbb{R}')
('1.0.0.0', 'w \\in \\mathbb{R}')
('1.0.0.0', '\\varepsilon > 0')
('1.0.0.0', 'R > 0')
('1.0.0.0', 'v \\in \\mathbb{R}')
('1.0.0.0', '0<|v -w| \\leq R')
('1.0.0.0', '|f(v) -\n  c| \\leq \\varepsilon')
('1.0.0.0', 'c')
('1.0.0.0', 'f')
('1.0.0.0', 'v')
('1.0.0.0', 'w')
('1.0.0.0', '\\lim_{v \\rightarrow w} f(w) = c.')
('1.0.0.0', '\\lim_{v\\rightarrow w} f(w) = c')
('1.0.0.0', '\\lim_{v\\rightarrow w} g(w) = d')
('1.0.0.0', '(af + bg)(w) \\coloneqq af(w) + bg(w)')
('1.0.0.0', 'a, b \\in \\mathbb{R}')
('1.0.0.0', '(fg)(w) \\coloneqq f(w) g(w)')
('1.0.0.0', '\\lim_{v\\rightarrow w} (af + bg)(w) = ac + bd')
('1.0.0.0', '\\lim_{v\\rightarrow w} (fg)(w) =\ncd')
('1.0.0.0', 'f:\\mathbb{R}\\rightarrow \\mathbb{R}')
('1.0.0.0', 'w \\in \\mathbb{R}')
('1.0.0.0', '\\lim_{v \\rightarrow w} f(v) = f(w).')
('1.0.0.0', 'f')
('1.0.0.0', 'o')
('1.0.0.0', 'g(v) = o(f(v)) \\ \\mbox{as} \\ v \\rightarrow w')
('1.0.0.0', '\\lim_{v\\rightarrow w} \\frac{|g(v)|}{|f(v)|} = 0.')
('1.0.0.0', 'f')
('1.0.0.0', 'g')
('1.0.0.0', 'v \\to w')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', 'f(w+\\delta) = f(w) + o(1) \\ \\mbox{as} \\ \\delta \\rightarrow 0.')
('1.0.0.0', 'f: \\mathbb{R}\\rightarrow \\mathbb{R}')
('1.0.0.0', '[w_0, w_0+\\delta]')
('1.0.0.0', 'f(w_0)')
('1.0.0.0', 'f(w_0+\\delta)')
('1.0.0.0', '(f(w_0+\\delta) -\nf(w_0))/\\delta')
('1.0.0.0', '\\delta')
('1.0.0.0', 'w_0')
('1.0.0.0', 'f')
('1.0.0.0', 'w_0')
('1.0.0.0', 'f')
('1.0.0.0', 'w_0')
('1.0.0.0', 'f:\\mathbb{R}\n\t\\rightarrow\\mathbb{R}')
('1.0.0.0', 'w\\in \\mathbb{R}')
('1.0.0.0', "f'(w) \\coloneqq \\lim_{\\delta\\rightarrow 0} \\frac{f(w+\\delta)- f(w)}{\\delta},\n\t\\label{diff:eq:derivative_definition}")
('1.0.0.0', "f'(w)")
('1.0.0.0', 'w')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', 'f')
('1.0.0.0', 'w_0')
('1.0.0.0', 'w \\mapsto aw + b')
('1.0.0.0', 'a')
('1.0.0.0', 'b')
('1.0.0.0', 'f')
('1.0.0.0', 'w_0')
('1.0.0.0', 'y_0= f(w_0)')
('1.0.0.0', 'w_0 + \\delta')
('1.0.0.0', 'u_\\delta=f(w_0+\\delta)')
('1.0.0.0', 'u_0 = a w_0 + b')
('1.0.0.0', 'u_\\delta = a(w_0 + \\delta) + b')
('1.0.0.0', 'a = (f(w_0 + \\delta) - f(w_0)) / \\delta')
('1.0.0.0', 'b=f(w_0) -aw_0')
('1.0.0.0', "f'(w)")
('1.0.0.0', 'f')
('1.0.0.0', 'w_0')
('1.0.0.0', 'a')
('1.0.0.0', '\\delta \\to 0')
('1.0.0.0', 'f')
('1.0.0.0', 'w_0')
('1.0.0.0', 'f(w)')
('1.0.0.0', 'w')
('1.0.0.0', 'w_0')
('1.0.0.0', "w\n\t\t\\mapsto f'(w_0) w + f(w_0) - f'(w_0) w_0 = f(w_0) + f'(w_0)(w - w_0)")
('1.0.0.0', 'f')
('1.0.0.0', 'w\\in\n\\mathbb{R}')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', 'w')
('1.0.0.0', 'w')
('1.0.0.0', 'w')
('1.0.0.0', 'f:\\mathbb{R}\\rightarrow \\mathbb{R}')
('1.0.0.0', 'w\\in \\mathbb{R}')
('1.0.0.0', 'w\\in \\mathbb{R}')
('1.0.0.0', 'o')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', "f'(w)\n   \\in \\mathbb{R}")
('1.0.0.0', "f(w+\\delta) = f(w) + f'(w)\\delta + o(\\delta) \\ \\mbox{as} \\ \\delta \\rightarrow 0.")
('1.0.0.0', "f'(w)\\delta + o(\\delta) = o(1)")
('1.0.0.0', '\\delta \\rightarrow 0')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', "f'")
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', "f'(w)")
('1.0.0.0', 'w')
('1.0.0.0', "f'(w)")
('1.0.0.0', 'f')
('1.0.0.0', "w_{t+1}= w_t - \\gamma f'(w_t)")
('1.0.0.0', '\\gamma>0')
('1.0.0.0', 'f')
('1.0.0.0', 'w_t')
('1.0.0.0', 'w^n')
('1.0.0.0', 'e^w')
('1.0.0.0', '\\ln w')
('1.0.0.0', '\\cos w')
('1.0.0.0', '\\sin w')
('1.0.0.0', 'f(w) = w^n')
('1.0.0.0', 'w \\in \\mathbb{R}')
('1.0.0.0', 'n\\in \\mathbb{N}\\setminus\\{0\\}')
('1.0.0.0', '\\delta \\in \\mathbb{R}')
('1.0.0.0', '\\begin{aligned}\n\t\t\\frac{f(w+\\delta) - f(w)}{\\delta} \n\t\t& = \\frac{(w+\\delta)^n - w^n}{\\delta} \\\\\n\t\t& = \\frac{\\sum_{k=0}^{n} \\binom{n}{k} \\delta^k w^{n-k} - w^n}{\\delta} \\\\\n\t\t& =  \\sum_{k=1}^{n} \\binom{n}{k} \\delta^{k-1} w^{n-k} \\\\\n\t\t& = \\binom{n}{1}\n\t\tw^{n-1}  +  \\sum_{k=2}^{n} \\binom{n}{k} \\delta^{k-1} w^{n-k},\n\t\n\\end{aligned}')
('1.0.0.0', '\\binom{n}{1} = n')
('1.0.0.0', '\\lim_{\\delta \\rightarrow 0} \\sum_{k=2}^{n}\n\t\\binom{n}{k} \\delta^{k-1} w^{n-k} =0')
('1.0.0.0', "f'(w)= n w^{n-1}")
('1.0.0.0', '\\mathbb{R}')
('1.0.0.0', 'f:\\mathcal{U}\\rightarrow\\mathbb{R}')
('1.0.0.0', '\\mathcal{U}\\subseteq \\mathbb{R}')
('1.0.0.0', 'f(w)=\\sqrt w')
('1.0.0.0', '\\mathcal{U}=\\mathbb{R}_+')
('1.0.0.0', 'f')
('1.0.0.0', 'w\\in \\mathcal{U}')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', 'r>0')
('1.0.0.0', 'w+\\delta \\in \\mathcal{U}')
('1.0.0.0', '|\\delta|\\leq r')
('1.0.0.0', 'f')
('1.0.0.0', 'w')
('1.0.0.0', '\\mathcal{U}')
('1.0.0.0', 'w\\in \\mathcal{U}')
('1.0.0.0', '\\{w+\\delta: |\\delta|\\leq r\\} \\subseteq \\mathcal{U}')
('1.0.0.0', 'r')
('1.0.0.0', '\\mathcal{U}')
('1.0.0.0', 'a')
('1.0.0.0', 'b')
('1.0.0.0', '\\mathcal{U}=[a, b]')
('1.0.0.0', 'f')
('1.0.0.0', 'a')
('1.0.0.0', 'b')
('1.0.0.0', 'a')
('1.0.0.0', 'b')
('1.0.0.1', 'w\\in \\mathbb{R}')
('1.0.0.1', 'f:\\mathbb{R}\\rightarrow\\mathbb{R}')
('1.0.0.1', 'g:\\mathbb{R}\\rightarrow \\mathbb{R}')
('1.0.0.1', 'f')
('1.0.0.1', 'g')
('1.0.0.1', 'f')
('1.0.0.1', 'g')
('1.0.0.1', 'w')
('1.0.0.1', 'f')
('1.0.0.1', 'g')
('1.0.0.1', 'w')
('1.0.0.1', "\\begin{aligned}\n\t\\forall a, b \\in \\mathbb{R}, \\ (af+bg)'(w) & = af'(w) +bg'(w) \\tag{Linearity}\\\\\n\t(fg)'(w) &= f'(w) g(w) + f(w)g'(w),  \\tag{Product rule} \n\\end{aligned}")
('1.0.0.1', '(fg)(w) = f(w)g(w)')
('1.0.0.1', 'o')
('1.0.0.1', '\\delta\\rightarrow 0')
('1.0.0.1', "\\begin{aligned}\n  (fg)(w+\\delta) & = (f(w) + f'(w)\\delta+ o(\\delta))(g(w) + g'(w)\\delta + o(\\delta)) \\\\\n  & = f(w)g(w) + f'(w)g(w)\\delta + f(w)g'(w)\\delta + o(\\delta),\n\\end{aligned}")
('1.0.0.1', 'g')
('1.0.0.1', 'w')
('1.0.0.1', 'f')
('1.0.0.1', 'g(w)')
('1.0.0.1', '(f\\circ g)(w) \\coloneqq f(g(w))')
('1.0.0.1', 'w')
('1.0.0.1', "\\begin{aligned}\n\\hspace{54pt} (f\\circ g)'(w) = f'(g(w)) g'(w).  \\tag{Chain rule}\n\\end{aligned}")
('1.0.0.1', 'f(w) = e^w\\ln w+\\cos w^2')
('1.0.0.1', 'f')
('1.0.0.1', 'f(w)= e^w\\ln w+\\cos w^2')
('1.0.0.1', 'f')
('1.0.0.1', 'w>0')
('1.0.0.1', '\\operatorname{sq}(w) \\coloneqq w^2')
('1.0.0.1', "\\begin{aligned}\n\\hspace*{-20pt}\tf'(w) & = (\\exp \\cdot \\ln)'(w) + (\\cos \\circ \\operatorname{sq})'(w)  \\tag{Linearity}\\\\\n\\hspace*{-20pt}\t(\\exp \\cdot \\ln)'(w) & = \\exp'(w) \\cdot \\ln(w)  + \\exp(w) \\cdot \\ln'(w)  \\tag{Product rule} \\\\\n\\hspace*{-20pt}\t\\quad (\\cos \\circ \\operatorname{sq})'(w) & = \\cos'(\\operatorname{sq}(w)) \\operatorname{sq}'(w)   \\tag{Chain rule} \\\\\n\\hspace*{-20pt}\t\\exp'(w) & = \\exp(w),  \\hspace{30pt} \\ln'(w)  = 1/w, \\tag{Elem. func.} \\\\\n\\hspace*{-20pt}\t\\operatorname{sq}'(w) & = 2 w, \\hspace{44pt} \\cos'(w)  =- \\sin(w). \\hspace{-3pt}  \\tag{Elem. func.}\n\t\n\\end{aligned}")
('1.0.0.1', "f'(w) = e^w \\ln w+ e^w/w - 2w\\sin w^2")
('1.0.0.2', 'u = f(w)')
('1.0.0.2', 'w')
('1.0.0.2', 'f')
('1.0.0.2', 'f')
('1.0.0.2', "f' = \\frac{du}{dw} \\quad \\mbox{with} \\quad f'(w) = \\left.\\frac{du}{dw}\\right|_w")
('1.0.0.2', 'du')
('1.0.0.2', 'dw')
('1.0.0.2', 'u')
('1.0.0.2', 'w')
('1.0.0.2', '|_w')
('1.0.0.2', 'w')
('1.0.0.2', 'v = g(w)')
('1.0.0.2', 'u = f(v)')
('1.0.0.2', '\\frac{du}{dw} = \\frac{du}{dv} \\cdot \\frac{dv}{dw}.')
('1.0.0.2', "\\left.\\frac{du}{dw}\\right|_w \n\t= \\left.\\frac{du}{dv}\\right|_{g(w)} \\left.\\frac{dv}{dw}\\right|_w \n\t=  f'(g(w)) g'(w) = (f\\circ g)'(w).")
('1.0.0.2', "f'(w)")
('1.0.1.0', 'f:\\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.1.0', '{\\bm w}= (w_1, \\ldots, w_P) \\in \\mathbb{R}^P')
('1.0.1.0', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.0', '\\mathbb{R}')
('1.0.1.0', 'f')
('1.0.1.0', 'f({\\bm w}+\\delta{\\bm v}) {-}f({\\bm w})')
('1.0.1.0', 'f')
('1.0.1.0', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.0', '{\\bm v}\\in \\mathbb{R}^P')
('1.0.1.0', '\\delta>0')
('1.0.1.0', 'f')
('1.0.1.0', '{\\bm w}')
('1.0.1.0', '{\\bm v}')
('1.0.1.0', '\\nonumber\n\t\\partial f({\\bm w})[{\\bm v}] \n    \\coloneqq \\lim_{\\delta \\rightarrow 0} \\frac{f({\\bm w}+ \\delta {\\bm v}) - f({\\bm w})}{\\delta},')
('1.0.1.0', 'f')
('1.0.1.0', '{\\bm w}')
('1.0.1.0', '{\\bm e}_i \n\\coloneqq (0, \\ldots, 0, \\underbrace{1}_i, 0, \\ldots, 0) .')
('1.0.1.0', 'i \\in [P]')
('1.0.1.0', '\\nonumber\n\t\\partial_i f({\\bm w}) \n    \\coloneqq \\partial f({\\bm w})[{\\bm e}_i] \n    = \\lim_{\\delta \\rightarrow 0} \\frac{f({\\bm w}+ \\delta {\\bm e}_i) - f({\\bm w})}{\\delta}.')
('1.0.1.0', '\\partial_i f({\\bm w}) = \\frac{\\partial\nf({\\bm w})}{\\partial w_i}')
('1.0.1.0', '\\partial_i f({\\bm w}) = \\partial_{w_i} f({\\bm w})')
('1.0.1.0', 'i')
('1.0.1.0', '\\phi(\\omega_i) = f(w_1, \\ldots,\n\\omega_i, \\ldots, w_P)')
('1.0.1.0', '\\omega_i')
('1.0.1.0', '{\\bm w}_i')
('1.0.1.1', 'l: \\mathbb{R}^P \\rightarrow \\mathbb{R}^M')
('1.0.1.1', 'a_1, a_2 \\in \\mathbb{R}')
('1.0.1.1', '{\\bm v}_1, {\\bm v}_2 \\in \\mathbb{R}^D')
('1.0.1.1', 'l[a_1 {\\bm v}_1 + a_2 {\\bm v}_2] = a_1 l({\\bm v}_1) + a_2 l[{\\bm v}_2].')
('1.0.1.1', '\\mathbb{R}')
('1.0.1.1', 'l: \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.1.1', 'f: \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.1.1', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.1', '\\lim_{\\|{\\bm v}\\|_2 \\rightarrow 0} \n  \\frac{|f({\\bm w}+ {\\bm v}) - f({\\bm w}) - \\partial f({\\bm w})[{\\bm v}]|}{\\|{\\bm v}\\|_2} = 0.')
('1.0.1.1', 'f: \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.1.1', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.1', '\\nabla f({\\bm w}) \n\\coloneqq \\begin{pmatrix} \\partial_1 f({\\bm w}) \\\\\n  \\vdots \\\\\n  \\partial_P f({\\bm w}) \\end{pmatrix}\n  = \\begin{pmatrix} \\partial f({\\bm w})[{\\bm e}_1] \\\\\n  \\vdots \\\\\n  \\partial f({\\bm w})[{\\bm e}_P] \\end{pmatrix}.')
('1.0.1.1', 'f')
('1.0.1.1', '{\\bm w}')
('1.0.1.1', '{\\bm v}=\\sum_{i=1}^P v_i {\\bm e}_i')
('1.0.1.1', '\\hspace{-1ex}\\partial f({\\bm w})[{\\bm v}] = \\sum_{i=1}^P v_i \\partial f({\\bm w})[{\\bm e}_i] =\n\\langle {\\bm v}, \\nabla f({\\bm w})\\rangle.')
('1.0.1.1', '\\langle \\cdot, \\cdot \\rangle')
('1.0.1.1', 'f({\\bm w}) = \\langle {\\bm a}, {\\bm w}\n\\rangle = \\sum_{i=1}^P a_i w_i')
('1.0.1.1', '(\\langle {\\bm a}, {\\bm w}+{\\bm v}\\rangle - \\langle {\\bm a}, {\\bm w}\\rangle -\n\\langle {\\bm a}, {\\bm v}\\rangle)/\\|{\\bm v}\\|_2 = 0')
('1.0.1.1', '{\\bm v}')
('1.0.1.1', '\\|{\\bm v}\\| \\rightarrow 0')
('1.0.1.1', '\\nabla f({\\bm w}) = {\\bm a}')
('1.0.1.1', 'f({\\bm w}+ {\\bm v})')
('1.0.1.1', '{\\bm v}= {\\mathbf{0}}')
('1.0.1.1', '{\\bm g}')
('1.0.1.1', 'f({\\bm w}+{\\bm v}) = f({\\bm w}) + \\langle {\\bm g}, {\\bm v}\\rangle + o(\\|{\\bm v}\\|_2),')
('1.0.1.1', 'f')
('1.0.1.1', '{\\bm w}')
('1.0.1.1', '\\langle {\\bm g}, \\cdot \\rangle')
('1.0.1.1', '{\\bm g}')
('1.0.1.1', 'f')
('1.0.1.1', '{\\bm w}')
('1.0.1.1', 'f:\\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.1.1', 'f(x_1, x_2) = x_1^3/(x_1^2 + x_2^2)')
('1.0.1.1', '0')
('1.0.1.1', '0')
('1.0.1.1', '0')
('1.0.1.1', '\\ell({\\bm \\theta}, {\\bm y}) \\coloneqq - \\langle {\\bm y}, {\\bm \\theta}\\rangle \n    + \\log \\sum_{i=1}^M e^{\\theta_i}')
('1.0.1.1', '{\\bm \\theta}\\in \\mathbb{R}^M')
('1.0.1.1', '{\\bm y}\\in \\{{\\bm e}_1, \\dots,\n    {\\bm e}_M\\}')
('1.0.1.1', '{\\bm \\theta}')
('1.0.1.1', '{\\bm y}')
('1.0.1.1', 'f({\\bm \\theta}) \\coloneqq\n    \\ell({\\bm \\theta}, {\\bm y})')
('1.0.1.1', 'f')
('1.0.1.1', 'f = l + \\mathrm{logsumexp}')
('1.0.1.1', 'l({\\bm \\theta}) \\coloneqq\\langle -{\\bm y}, {\\bm \\theta}\\rangle')
('1.0.1.1', '\\mathrm{logsumexp}({\\bm \\theta})\n      \\coloneqq \\log \\sum_{i=1}^M \\exp(\\theta_i),')
('1.0.1.1', 'l')
('1.0.1.1', '\\nabla l(\\theta)\n    = -{\\bm y}')
('1.0.1.1', '\\mathrm{logsumexp}')
('1.0.1.1', '\\exp({\\bm \\theta}) =\n    (\\exp(\\theta_1), \\ldots, \\exp(\\theta_M))')
('1.0.1.1', '\\exp(x) = 1 + x +\n    o(x)')
('1.0.1.1', '\\log(1+ x) = x + o(x)')
('1.0.1.1', '\\odot')
('1.0.1.1', '\\begin{aligned}\n      \\mathrm{logsumexp}({\\bm \\theta}+ {\\bm v}) \n      & = \\log\\left(\\langle \\exp({\\bm \\theta}+ {\\bm v}), \\operatorname{\\mathbf 1}\\rangle\\right) \\\\\n      & = \\log\\left(\\langle \\exp({\\bm \\theta}) \\odot \\exp({\\bm v}), \\operatorname{\\mathbf 1}\\rangle\\right) \\\\\n      & = \\log\\left(\\langle \\exp({\\bm \\theta}) \\odot (\\operatorname{\\mathbf 1}+ {\\bm v}+ o(\\|{\\bm v}\\|_2)), \\operatorname{\\mathbf 1}\\rangle\\right) \\\\\n      & = \\log\\left(\\langle \\exp({\\bm \\theta}), \\operatorname{\\mathbf 1}\\rangle + \\langle  \\exp({\\bm \\theta}), {\\bm v}\\rangle + o(\\|{\\bm v}\\|_2)\\right)\\\\\n      & = \\log\\left(\\langle \\exp({\\bm \\theta}), \\operatorname{\\mathbf 1}\\rangle \\right) \n      + \\left\\langle \\frac{\\exp({\\bm \\theta})}{\\langle \\exp({\\bm \\theta}), \\operatorname{\\mathbf 1}\\rangle} , {\\bm v}\\right\\rangle + o(\\|{\\bm v}\\|_2),\n    \n\\end{aligned}')
('1.0.1.1', '\\mathrm{logsumexp}({\\bm \\theta}+ {\\bm v})')
('1.0.1.1', '\\nabla \\mathrm{logsumexp}({\\bm \\theta}) =\n    \\mathrm{softargmax}({\\bm \\theta})')
('1.0.1.1', '\\begin{aligned}\n      \\mathrm{softargmax}({\\bm \\theta}) & \n      \\coloneqq \\left(e^{\\theta_1}/\\left(\\sum_{j=1}^{M}e^{\\theta_j}\\right), \\ldots, e^{\\theta_M}/\\left(\\sum_{j=1}^M\n      e^{\\theta_j}\\right)\\right).\n    \n\\end{aligned}')
('1.0.1.1', '\\nabla f({\\bm \\theta}) = -{\\bm y}\n    + \\mathrm{softargmax}({\\bm \\theta})')
('1.0.1.1.0', 'u_1,\n\\ldots, u_M \\in \\mathbb{R}')
('1.0.1.1.0', 'f_1, \\ldots, f_M')
('1.0.1.1.0', '{\\bm w}')
('1.0.1.1.0', 'u_1 f_1 + \\ldots + u_M f_M')
('1.0.1.1.0', '{\\bm w}')
('1.0.1.1.0', '\\nabla (u_1 f_1 + \\ldots + u_M f_M)({\\bm w}) \n= u_1 \\nabla f_1({\\bm w}) + \\ldots + u_M \\nabla f_M({\\bm w}).')
('1.0.1.1.1', 'f')
('1.0.1.1.1', '{\\bm w}')
('1.0.1.1.1', '\\begin{aligned}\n\t\\mathop{\\mathrm{arg\\,max}}_{{\\bm v}\\in \\mathbb{R}^P, \\|{\\bm v}\\|_2\\leq 1} \\partial f({\\bm w})[{\\bm v}]  \n\t& = \\mathop{\\mathrm{arg\\,max}}_{{\\bm v}\\in \\mathbb{R}^P, \\|{\\bm v}\\|_2\\leq 1} \\langle {\\bm v}, \\nabla f({\\bm w}) \\rangle\n\t= \\nabla f({\\bm w})/\\|\\nabla f({\\bm w})\\|_2,\n\\end{aligned}')
('1.0.1.1.1', '\\nabla f({\\bm w}) \\neq \\mathbf{0}')
('1.0.1.1.1', '\\nabla f({\\bm w})')
('1.0.1.1.1', '{\\bm w}')
('1.0.1.1.1', 'f({\\bm w})')
('1.0.1.1.1', 'f')
('1.0.1.1.1', '-\\nabla f({\\bm w})')
('1.0.1.1.1', 'f')
('1.0.1.1.1', '{\\bm w}_{t+1} = {\\bm w}_t -\\gamma \\nabla f({\\bm w}_t)')
('1.0.1.1.1', '\\gamma>0')
('1.0.1.1.1', 'f')
('1.0.1.1.1', '{\\bm w}_t')
('1.0.1.1.1', '-\\nabla f({\\bm w}_t)')
('1.0.1.1.1', 'f:\\mathbb{R}\n\t\t\\rightarrow\\mathbb{R}^2')
('1.0.1.1.1', 'w')
('1.0.1.1.1', 'f(w)\\in \\mathbb{R}^2')
('1.0.1.2', 'f:\\mathbb{R}^P \\rightarrow \\mathbb{R}^M')
('1.0.1.2', 'f({\\bm w}) \\coloneqq (f_1({\\bm w}), \\dots, f_M({\\bm w}))')
('1.0.1.2', 'f_j \\colon \\mathbb{R}^P\n\\to \\mathbb{R}')
('1.0.1.2', '\\partial f({\\bm w})[{\\bm v}] \n\\coloneqq  \\lim_{\\delta \\rightarrow 0} \\frac{f({\\bm w}+ \\delta {\\bm v}) - f({\\bm w})}{\\delta} \n= \\lim_{\\delta \\rightarrow 0}\\begin{pmatrix}\n\t \\frac{f_1({\\bm w}+ \\delta {\\bm v}) - f_1({\\bm w})}{\\delta}\\\\\n\t\\vdots\\\\\n\t \\frac{f_M({\\bm w}+ \\delta {\\bm v}) - f_M({\\bm w})}{\\delta}\n\t\\end{pmatrix} \\in \\mathbb{R}^M,')
('1.0.1.2', 'f')
('1.0.1.2', '{\\bm v}\\in \\mathbb{R}^P')
('1.0.1.2', 'f_j')
('1.0.1.2', '\\partial\nf({\\bm w})[{\\bm v}] = (\\partial f_j({\\bm w})[{\\bm v}])_{j=1}^M')
('1.0.1.2', 'f')
('1.0.1.2', '{\\bm w}')
('1.0.1.2', '\\partial_i f({\\bm w}) \n\t\\coloneqq \\partial f({\\bm w})[{\\bm e}_i] = \\begin{pmatrix}\n\t\t\\partial_i f_1({\\bm w}) \\\\\n\t\t\\vdots \\\\\n\t\t\\partial_i f_M({\\bm w})\n\t\\end{pmatrix}\\in \\mathbb{R}^M.')
('1.0.1.2', 'f:\\mathbb{R}\\rightarrow \\mathbb{R}^2')
('1.0.1.2', 'f:\\mathbb{R}^P\\rightarrow\n  \\mathbb{R}^M')
('1.0.1.2', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.2', '\\lim_{\\|{\\bm v}\\|_2 \\rightarrow 0} \n    \\frac{\\|f({\\bm w}+ {\\bm v}) - f({\\bm w}) - \\partial f({\\bm w})[{\\bm v}]\\|_2}{\\|{\\bm v}\\|_2} = 0.')
('1.0.1.2', 'f:\\mathbb{R}^P\\rightarrow \\mathbb{R}^M')
('1.0.1.2', '{\\bm w}')
('1.0.1.2', '\\begin{aligned}\n\t\t\\bm \\partial f ({\\bm w}) \n\t\t& \\coloneqq \\begin{pmatrix}\n\t\t\t\t\\partial_1 f_1({\\bm w}) & \\ldots & \\partial_P f_1({\\bm w}) \\\\\n\t\t\t\t\\vdots & \\ddots & \\vdots \\\\\n\t\t\t\t\\partial_1 f_M({\\bm w}) & \\ldots & \\partial_P f_M({\\bm w})\n\t\t\t\\end{pmatrix} \\in \\mathbb{R}^{M \\times P}.\n\t\n\\end{aligned}')
('1.0.1.2', '\\begin{aligned}\n\t\t\\bm \\partial f ({\\bm w}) \n\t\t& = \\begin{pmatrix}\n\t\t\t\t\\partial_1 f({\\bm w}), \\ldots, \\partial_P f({\\bm w})\n\t\t\t\\end{pmatrix} \n\t\t  = \\begin{pmatrix}\n\t\t\t\\nabla f_1({\\bm w})^\\top \\\\\n\t\t\t\\vdots \\\\\n\t\t\t\\nabla f_M({\\bm w})^\\top\n\t\t\t\\end{pmatrix}.\n\t\n\\end{aligned}')
('1.0.1.2', 'f')
('1.0.1.2', '{\\bm w}')
('1.0.1.2', '{\\bm v}= \\sum_{i=1}^P v_i{\\bm e}_i \\in \\mathbb{R}^P')
('1.0.1.2', '\\partial f({\\bm w})[{\\bm v}] \n      = \\sum_{i=1}^P v_i \\partial_i f({\\bm w}) = \\bm \\partial f({\\bm w}) {\\bm v}\\in \\mathbb{R}^M.')
('1.0.1.2', '\\bm \\partial')
('1.0.1.2', 'f({\\bm w}+ {\\bm v})')
('1.0.1.2', '{\\bm v}={\\mathbf{0}}')
('1.0.1.2', 'l')
('1.0.1.2', 'f({\\bm w}+{\\bm v}) = f({\\bm w}) + l[{\\bm v}] + o(\\|{\\bm v}\\|_2),')
('1.0.1.2', 'f')
('1.0.1.2', '{\\bm w}')
('1.0.1.2', 'l')
('1.0.1.2', '{\\bm J}')
('1.0.1.2', 'l[{\\bm v}] = {\\bm J}{\\bm v}')
('1.0.1.2', '{\\bm J}= \\bm \\partial f({\\bm w})')
('1.0.1.2', 'f({\\bm w}) = {\\bm A}{\\bm w}')
('1.0.1.2', '{\\bm A}\\in\n\\mathbb{R}^{M\\times P}')
('1.0.1.2', 'f')
('1.0.1.2', '{\\bm w}')
('1.0.1.2', '\\bm \\partial f({\\bm w}) = {\\bm A}')
('1.0.1.2', 'f:\\mathbb{R}^P \\rightarrow\\mathbb{R}')
('1.0.1.2', 'M=1')
('1.0.1.2', '\\bm \\partial f({\\bm w}) = \\nabla f({\\bm w})^\\top \\in \\mathbb{R}^{1\\times P}.')
('1.0.1.2', 'f: \\mathbb{R}\\rightarrow \\mathbb{R}^M')
('1.0.1.2', "\\bm \\partial f(w) = f'(w) \\coloneqq \n  \\begin{pmatrix}\n    f_1'(w) \\\\\n    \\vdots \\\\ \n    f_M'(w)\n  \\end{pmatrix} \\in \\mathbb{R}^{M\\times 1}.")
('1.0.1.2', 'f:\\mathbb{R}\\rightarrow\\mathbb{R}')
('1.0.1.2', 'f')
('1.0.1.2', "\\bm \\partial f(w) = f'(w) \\in \\mathbb{R}.")
('1.0.1.2', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.2', 'f({\\bm w}) \n\t\t\\coloneqq \\begin{pmatrix}\n\t\t\t\\sigma(w_1) \\\\\n\t\t\t\\vdots \\\\\n\t\t\t\\sigma(w_P)\n\t\t\\end{pmatrix}\\in \\mathbb{R}^P \\quad \\mbox{where} \\quad \\sigma(w) \\coloneqq \\log(1+e^w).')
('1.0.1.2', '\\sigma')
('1.0.1.2', 'j')
('1.0.1.2', 'f')
('1.0.1.2', 'i')
('1.0.1.2', '{\\bm w}')
('1.0.1.2', 'i\\neq j')
('1.0.1.2', '\\partial_i\n\tf_j({\\bm w}) = 0')
('1.0.1.2', 'i\\neq j')
('1.0.1.2', 'i=j')
('1.0.1.2', '\\sigma')
('1.0.1.2', 'w_j')
('1.0.1.2', "\\partial_j f_j({\\bm w}) =\n    \\sigma'(w_j)")
('1.0.1.2', "\\sigma'(w) = e^{w}/(1+e^w)")
('1.0.1.2', 'f')
('1.0.1.2', "\\bm \\partial f({\\bm w}) \n    = \\operatorname{\\bf diag}(\\sigma'(w_1), \\dots, \\sigma'(w_P))\n\t\\coloneqq \\begin{pmatrix}\n\t\t\\sigma'(w_1) & 0 & \\ldots & 0 \\\\\n\t\t0 & \\ddots & \\ddots & \\vdots \\\\\n\t\t\\vdots & \\ddots & \\ddots & 0 \\\\\n\t\t0 & \\ldots & 0 & \\sigma'(w_P)\n\t\\end{pmatrix}.")
('1.0.1.2.0', 'f')
('1.0.1.2.0', '{\\bm v}\n\\in \\mathbb{R}^P')
('1.0.1.2.0', 'f')
('1.0.1.2.0', '{\\bm u}\n\\in \\mathbb{R}^M')
('1.0.1.2.0', '\\nabla \\langle {\\bm u}, f \\rangle({\\bm w})')
('1.0.1.2.0', '\\langle {\\bm u}, f \\rangle({\\bm w}) \\coloneqq \\langle {\\bm u}, f({\\bm w}) \\rangle \\in \\mathbb{R}.')
('1.0.1.2.0', '\\nabla f_j({\\bm w})')
('1.0.1.2.0', 'f_j = {\\bm e}_j^\\top f')
('1.0.1.2.0', '{\\bm w}')
('1.0.1.2.0', '{\\bm e}_j')
('1.0.1.2.0', 'j')
('1.0.1.2.0', '\\mathbb{R}^M')
('1.0.1.2.0', 'f')
('1.0.1.2.0', '{\\bm w}')
('1.0.1.2.0', '{\\bm u}= \\sum_{j=1}^M u_j{\\bm e}_j \\in \\mathbb{R}^M')
('1.0.1.2.0', '\\nabla \\langle {\\bm u}, f \\rangle({\\bm w}) \n= \\sum_{j=1}^M u_j \\nabla f_j({\\bm w}) = \\bm \\partial f({\\bm w})^\\top {\\bm u}\\in \\mathbb{R}^P,')
('1.0.1.2.0', '\\bm \\partial f({\\bm w})^\\top')
('1.0.1.2.0', 'i \\in [P]')
('1.0.1.2.0', '\\nabla_i \\langle {\\bm u}, f \\rangle({\\bm w}) \n= [\\bm \\partial f({\\bm w})^\\top {\\bm u}]_i\n= \\lim_{\\delta \\rightarrow 0} \\frac{\\langle {\\bm u}, f({\\bm w}+ \\delta {\\bm e}_i)\n-f({\\bm w}) \\rangle}{\\delta}.')
('1.0.1.2.1', 'f:\\mathbb{R}^P \\rightarrow\\mathbb{R}^M')
('1.0.1.2.1', 'g:\\mathbb{R}^M \\rightarrow \\mathbb{R}^R')
('1.0.1.2.1', 'f')
('1.0.1.2.1', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.2.1', 'g')
('1.0.1.2.1', 'f({\\bm w}) \\in \\mathbb{R}^M')
('1.0.1.2.1', 'g\n\t\\circ f')
('1.0.1.2.1', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.1.2.1', '\\bm \\partial(g\\circ f)({\\bm w}) = \\bm \\partial g(f({\\bm w})) \\bm \\partial f({\\bm w}).')
('1.0.1.2.1', 'g\\circ f({\\bm w}+{\\bm v})')
('1.0.1.2.1', 'f')
('1.0.1.2.1', '{\\bm w}')
('1.0.1.2.1', 'g')
('1.0.1.2.1', 'f({\\bm w})')
('1.0.1.2.1', '\\begin{aligned}\n    g(f({\\bm w}+{\\bm v})) & = g(f({\\bm w}) + \\bm \\partial f({\\bm w}){\\bm v}+ o(\\|{\\bm v}\\|)) \\\\\n    & = g(f({\\bm w})) + \\bm \\partial g(f({\\bm w})) \\bm \\partial f({\\bm w}){\\bm v}+ o(\\|{\\bm v}\\|).\n  \n\\end{aligned}')
('1.0.1.2.1', 'g\\circ f')
('1.0.1.2.1', '{\\bm w}')
('1.0.1.2.1', '\\bm \\partial g(f({\\bm w}))\n  \\bm \\partial f({\\bm w})')
('1.0.1.2.1', 'g')
('1.0.1.2.1', '\\nabla (g \\circ f)')
('1.0.1.2.1', 'f:\\mathbb{R}^P \\rightarrow\\mathbb{R}^M')
('1.0.1.2.1', 'g:\\mathbb{R}^M \\rightarrow \\mathbb{R}')
('1.0.1.2.1', '\\nabla \t(g\\circ f)({\\bm w}) = \\bm \\partial f({\\bm w})^\\top \\nabla g(f({\\bm w})).')
('1.0.1.2.1', 'N')
('1.0.1.2.1', '{\\bm x}_1, \\ldots, {\\bm x}_N \\in\n\t\\mathbb{R}^D')
('1.0.1.2.1', 'N')
('1.0.1.2.1', 'y_1, \\ldots, y_N\\in \\mathbb{R}')
('1.0.1.2.1', '{\\bm w}\\in\n\t\\mathbb{R}^{D}')
('1.0.1.2.1', 'f({\\bm w}) = \\|{\\bm X}{\\bm w}-{\\bm y}\\|_2^2 = \\sum_{i=1}^N (\\langle {\\bm x}_i,\n\t{\\bm w}\\rangle -y_i)^2')
('1.0.1.2.1', '{\\bm X}= ({\\bm x}_1, \\ldots, {\\bm x}_N)^\\top \\in \\mathbb{R}^{N\\times D}')
('1.0.1.2.1', '{\\bm y}= (y_1, \\ldots, y_N)^\\top \\in \\mathbb{R}^N')
('1.0.1.2.1', 'f')
('1.0.1.2.1', 'f_1({\\bm w})= {\\bm X}{\\bm w}')
('1.0.1.2.1', 'f_2({\\bm p}) = \\|{\\bm p}- {\\bm y}\\|_2^2')
('1.0.1.2.1', 'f= f_2 \\circ\n\tf_1')
('1.0.1.2.1', '\\nabla f({\\bm w}) \n\t= \\bm \\partial f_1({\\bm w})^\\top \\nabla f_2(f_1({\\bm w}))')
('1.0.1.2.1', 'f_1')
('1.0.1.2.1', 'f_2')
('1.0.1.2.1', '{\\bm w}')
('1.0.1.2.1', 'f_1({\\bm w})')
('1.0.1.2.1', 'f_1')
('1.0.1.2.1', '\\bm \\partial f_1({\\bm w})\n\t= {\\bm X}')
('1.0.1.2.1', 'f_2')
('1.0.1.2.1', '\\partial_j f_2({\\bm p})= 2(p_j  - y_j)')
('1.0.1.2.1', 'j \\in \\{1, \\ldots, N\\}')
('1.0.1.2.1', 'f_2')
('1.0.1.2.1', '{\\bm p}')
('1.0.1.2.1', '\\nabla f_2({\\bm p}) =\n\t2({\\bm p}- {\\bm y})')
('1.0.1.2.1', 'f_1')
('1.0.1.2.1', 'f_2')
('1.0.1.2.1', 'f')
('1.0.1.2.1', '\\nabla f({\\bm w}) \n\t= 2{\\bm X}^\\top (f_1({\\bm w}) - {\\bm y}) = 2{\\bm X}^\\top({\\bm X}{\\bm w}-{\\bm y}).')
('1.0.2.0', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}^M')
('1.0.2.0', 'f({\\bm W}) = {\\bm W}{\\bm x}')
('1.0.2.0', '{\\bm x}\\in \\mathbb{R}^D')
('1.0.2.0', '{\\bm W}\\in \\mathbb{R}^{M\\times D}')
('1.0.2.0', '{\\bm W}\\in \\mathbb{R}^{M\\times D}')
('1.0.2.0', '{\\bm w}\\in \\mathbb{R}^{MD}')
('1.0.2.0', '{\\bm W}')
('1.0.2.0', '{\\bm w}= \\operatorname{vec}({\\bm W})')
('1.0.2.0', '{\\bm W}=\n\\operatorname{vec}^{-1}({\\bm w})')
('1.0.2.0', 'f({\\bm W})')
('1.0.2.0', '\\tilde f({\\bm w}) =\nf(\\operatorname{vec}^{-1}({\\bm w})) = \\operatorname{vec}^{-1}({\\bm w}) {\\bm x}')
('1.0.2.0', '\\tilde f')
('1.0.2.0', '{\\bm w}')
('1.0.2.0', '\\mathbb{R}^{M \\times MD}')
('1.0.2.0', 'f')
('1.0.2.0', '{\\bm W}\n\\in \\mathbb{R}^{M\\times D}')
('1.0.2.0', '{\\bm V}\\in \\mathbb{R}^{M\\times D}')
('1.0.2.0', '{\\bm V}')
('1.0.2.0', '{\\bm v}= \\operatorname{vec}({\\bm V})')
('1.0.2.0', '\\bm \\partial\\tilde f({\\bm w}){\\bm v}')
('1.0.2.0', 'M^3D^2')
('1.0.2.0', 'f')
('1.0.2.0', 'f')
('1.0.2.0', '{\\bm W}\\in \\mathbb{R}^{M\\times D}')
('1.0.2.0', '{\\bm V}\\in \\mathbb{R}^{M\\times D}')
('1.0.2.0', '{\\bm V}')
('1.0.2.0', '\\partial\nf({\\bm W})[{\\bm V}] = f({\\bm V}) = {\\bm V}{\\bm x}')
('1.0.2.0', 'MD')
('1.0.2.0', '\\bm \\partial\\tilde f({\\bm w})')
('1.0.2.1', '\\mathcal{E}')
('1.0.2.1', '+')
('1.0.2.1', '\\cdot')
('1.0.2.1', '{\\bm u}')
('1.0.2.1', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.1', 'a \\in \\mathbb{R}')
('1.0.2.1', '{\\bm u}+{\\bm v}\\in \\mathcal{E}')
('1.0.2.1', 'a \\cdot {\\bm u}\\in \\mathcal{E}')
('1.0.2.1', '{\\bm e}_1, \\ldots, {\\bm e}_P \\in \\mathcal{E}')
('1.0.2.1', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.1', '{\\bm v}= \\sum_{i=1}^{P} v_i {\\bm e}_i')
('1.0.2.1', 'v_1, \\ldots, v_P \\in \\mathbb{R}')
('1.0.2.1', '\\mathbb{R}^P')
('1.0.2.1', 'P')
('1.0.2.1', '\\mathbb{R}^{P_1 \\times P_2}')
('1.0.2.1', 'P_1\\times P_2')
('1.0.2.1', '{\\bm E}_{ij} \\in \\{0,1\\}^{P_1\\times P_2}')
('1.0.2.1', 'i \\in [P_1], j\\in [P_2]')
('1.0.2.1', '(i,\nj)')
('1.0.2.1', '{\\bm W}\\in \\mathbb{R}^{P_1\n\\times P_2}')
('1.0.2.1', '{\\bm W}= \\sum_{i, j=1}^{P_1, P_2} W_{i j} {\\bm E}_{ij}')
('1.0.2.1', '\\mathcal{E}')
('1.0.2.1', '\\langle \\cdot, \\cdot\n  \\rangle: \\mathcal{E}\\times \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.2.1', '{\\bm x}\\mapsto\n    \\langle {\\bm x}, {\\bm w}\\rangle')
('1.0.2.1', '{\\bm y}\\mapsto \\langle {\\bm v}, {\\bm y}\\rangle')
('1.0.2.1', '{\\bm w}, {\\bm v}\\in \\mathcal{E}')
('1.0.2.1', '\\langle {\\bm w}, {\\bm v}\\rangle = \\langle\n      {\\bm v}, {\\bm w}\\rangle')
('1.0.2.1', '{\\bm w}, {\\bm v}\\in \\mathcal{E}')
('1.0.2.1', '\\langle {\\bm w},  {\\bm w}\\rangle\\geq 0')
('1.0.2.1', '{\\bm w}\n    \\in \\mathcal{E}')
('1.0.2.1', '\\langle {\\bm w}, {\\bm w}\\rangle = 0')
('1.0.2.1', '{\\bm w}=0')
('1.0.2.1', '\\|{\\bm w}\\| \\coloneqq \\sqrt{\\langle {\\bm w}, {\\bm w}\n  \\rangle}')
('1.0.2.1', '\\|{\\bm w}-{\\bm v}\\|')
('1.0.2.1', '{\\bm w},\n{\\bm v}\\in \\mathcal{E}')
('1.0.2.1', '\\mathcal{E}= \\mathbb{R}^P')
('1.0.2.1', '\\langle {\\bm w}, {\\bm v}\\rangle = \\sum_{i=1}^{P} w_iv_i.')
('1.0.2.1', '\\mathcal{E}=\\mathbb{R}^{P_1\\times P_2}')
('1.0.2.1', '{\\bm W}, {\\bm V}\\in \\mathbb{R}^{P_1 \\times P_2}')
('1.0.2.1', '\\langle {\\bm W}, {\\bm V}\\rangle \n\\coloneqq \\langle \\operatorname{vec}({\\bm W}), \\operatorname{vec}({\\bm V}) \\rangle\n= \\sum_{i,j=1}^{P_1, P_2} W_{ij} V_{ij}\n= \\operatorname{tr}({\\bm W}^\\top {\\bm V}),')
('1.0.2.1', '\\operatorname{tr}({\\bm Z}) \\coloneqq \\sum_{i=1}^P Z_{ii}')
('1.0.2.1', '{\\bm Z}\\in \\mathbb{R}^{P \\times P}')
('1.0.2.1', 'R')
('1.0.2.1', '\\mathcal{E}=\\mathbb{R}^{P_1\\times \\ldots \\times P_R}')
('1.0.2.1', '\\bm{\\mathsf W}, \\bm{\\mathsf V}\\in \\mathbb{R}^{P_1\\times \\ldots \\times\nP_R}')
('1.0.2.1', '\\langle \\bm{\\mathsf W}, \\bm{\\mathsf V}\\rangle  \n\\coloneqq \\langle \\operatorname{vec}(\\bm{\\mathsf W}), \\operatorname{vec}(\\bm{\\mathsf V}) \\rangle\n= \\sum_{i_1,\\ldots, i_R=1}^{P_1, \\ldots, P_R} \\bm{\\mathsf W}_{i_1\\ldots i_R} \\bm{\\mathsf V}_{i_1\\ldots\ni_R},')
('1.0.2.1', '\\bm{\\mathsf W}_{i_1\\ldots i_R}')
('1.0.2.1', '(i_1,\\ldots, i_R)')
('1.0.2.1', '\\bm{\\mathsf W}')
('1.0.2.2', 'l:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.2', '\\mathcal{E}')
('1.0.2.2', '\\mathcal{F}')
('1.0.2.2', '{\\bm w}, {\\bm v}\\in \\mathcal{E}')
('1.0.2.2', 'a, b \\in \\mathbb{R}')
('1.0.2.2', 'l[a{\\bm w}+ b{\\bm v}] = a \\cdot l[{\\bm w}] + b\n\\cdot l[{\\bm v}]')
('1.0.2.2', '\\mathcal{E}= \\mathbb{R}^P')
('1.0.2.2', '\\mathcal{F}=\\mathbb{R}^M')
('1.0.2.2', '{\\bm A}\\in \\mathbb{R}^{M \\times P}')
('1.0.2.2', 'l[{\\bm x}] = {\\bm A}{\\bm x}')
('1.0.2.2', '{\\bm A}')
('1.0.2.2', 'l')
('1.0.2.2', '\\mathcal{E}')
('1.0.2.2', '\\mathcal{F}')
('1.0.2.2', '\\langle\\cdot, \\cdot \\rangle_\\mathcal{E}')
('1.0.2.2', '\\langle \\cdot, \\cdot \\rangle_\\mathcal{F}')
('1.0.2.2', 'l:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.2', 'l^*: \\mathcal{F}\\rightarrow \\mathcal{E}')
('1.0.2.2', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.2', '{\\bm u}\\in \\mathcal{F}')
('1.0.2.2', '\\langle l[{\\bm v}], {\\bm u}\\rangle_\\mathcal{F}= \\langle {\\bm v}, l^*[{\\bm u}] \\rangle_\\mathcal{E}.')
('1.0.2.2', 'l[{\\bm v}] = {\\bm A}{\\bm v}')
('1.0.2.2', 'l^*[{\\bm u}] = {\\bm A}^\\top {\\bm u}')
('1.0.2.2', '\\langle l[{\\bm v}], {\\bm u}\\rangle_\\mathcal{F}\n= \\langle {\\bm A}{\\bm v}, {\\bm u}\\rangle_\\mathcal{F}\n= \\langle {\\bm v}, {\\bm A}^\\top {\\bm u}\\rangle_\\mathcal{E}\n= \\langle {\\bm v}, l^*[{\\bm u}] \\rangle_\\mathcal{E}.')
('1.0.2.3', '\\mathcal{E}')
('1.0.2.3', '\\mathcal{F}')
('1.0.2.3', '\\langle \\cdot, \\cdot\\rangle_\\mathcal{E}')
('1.0.2.3', '\\langle \\cdot, \\cdot \\rangle_\\mathcal{F}')
('1.0.2.3', 'f:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.3', '{\\bm w}\\in \\mathcal{E}')
('1.0.2.3', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.3', '\\partial f({\\bm w})[{\\bm v}] \\coloneqq \n    \\lim_{\\delta \\rightarrow 0} \\frac{f({\\bm w}+ \\delta {\\bm v}) - f({\\bm w})}{\\delta}')
('1.0.2.3', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.3', '{\\bm v}')
('1.0.2.3', '\\lim_{\\|{\\bm v}\\|_\\mathcal{F}\\rightarrow 0} \n    \\frac{\\|f({\\bm w}+ {\\bm v}) - f({\\bm w}) - \\partial f({\\bm w})[{\\bm v}]\\|_\\mathcal{F}}{\\|{\\bm v}\\|_\\mathcal{F}} = 0.')
('1.0.2.3', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.3', '\\partial f({\\bm w}): \\mathcal{E}\\to \\mathcal{F}')
('1.0.2.3', '{\\bm v}')
('1.0.2.3', '\\partial f({\\bm w})[{\\bm v}]')
('1.0.2.3', '\\partial f')
('1.0.2.3', '\\mathcal{E}')
('1.0.2.3', '\\mathcal{E}')
('1.0.2.3', '\\mathcal{F}')
('1.0.2.3', '\\partial f \\colon \\mathcal{E}\\to (\\mathcal{E}\\to \\mathcal{F}).')
('1.0.2.3', '{\\bm v}')
('1.0.2.3', '\\mathcal{E}')
('1.0.2.3', '\\mathcal{E}')
('1.0.2.3.0', 'f:\\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.2.3.0', '{\\bm w}\\in \\mathcal{E}')
('1.0.2.3.0', '\\nabla f({\\bm w}) \\in \\mathcal{E}')
('1.0.2.3.0', 'f')
('1.0.2.3.0', '{\\bm w}')
('1.0.2.3.0', 'f')
('1.0.2.3.0', '{\\bm w}')
('1.0.2.3.0', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.3.0', '\\partial f({\\bm w})[{\\bm v}] \n      = \\langle \\nabla f({\\bm w}), {\\bm v}\\rangle_\\mathcal{E}.')
('1.0.2.3.0', '\\mathcal{E}')
('1.0.2.4', 'f:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.4', '{\\bm w}\\in \\mathcal{E}')
('1.0.2.4', '{\\bm u}\\in \\mathcal{F}')
('1.0.2.4', '\\partial f({\\bm w})^* \\colon \\mathcal{F}\\to \\mathcal{E}')
('1.0.2.4', '\\begin{aligned}\n    \\nabla \\langle {\\bm u}, f\\rangle_\\mathcal{F}({\\bm w}) = \\partial f({\\bm w})^*[{\\bm u}],\n  \n\\end{aligned}')
('1.0.2.4', '\\langle {\\bm u}, f\\rangle_\\mathcal{F}({\\bm w}) \\coloneqq \\langle {\\bm u},\n  f({\\bm w})\\rangle_\\mathcal{F}')
('1.0.2.4', '\\partial f(\\cdot)^*')
('1.0.2.4', '\\mathcal{E}')
('1.0.2.4', '\\mathcal{F}')
('1.0.2.4', '\\mathcal{E}')
('1.0.2.4', '\\partial\n  f(\\cdot)^* \\colon \\mathcal{E}\\to (\\mathcal{F}\\to \\mathcal{E}).')
('1.0.2.4', '\\langle\n  {\\bm u}, \\cdot\\rangle')
('1.0.2.4', '\\langle {\\bm u}, f\\rangle_\\mathcal{F}')
('1.0.2.4', '\\begin{aligned}\n    \\partial (\\langle {\\bm u}, f\\rangle_\\mathcal{F})({\\bm w})[{\\bm v}] \n    & = \\langle {\\bm u}, \\partial f({\\bm w})[{\\bm v}]\\rangle_\\mathcal{F}\\\\\n    & = \\langle \\partial f({\\bm w})^*[{\\bm u}], {\\bm v}\\rangle_\\mathcal{F}.\n  \n\\end{aligned}')
('1.0.2.4', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.4', '\\partial f({\\bm w})^*[{\\bm u}]')
('1.0.2.4', '\\langle {\\bm u}, f\\rangle_\\mathcal{F}')
('1.0.2.5', 'f:\\mathcal{E}\n  \\rightarrow \\mathcal{F}')
('1.0.2.5', 'g:\\mathcal{F}\\rightarrow \\mathcal{G}')
('1.0.2.5', '\\mathcal{E}, \\mathcal{F}, \\mathcal{G}')
('1.0.2.5', 'f')
('1.0.2.5', '{\\bm w}\\in \\mathcal{E}')
('1.0.2.5', 'g')
('1.0.2.5', 'f({\\bm w}) \\in \\mathcal{F}')
('1.0.2.5', 'g \\circ f')
('1.0.2.5', '{\\bm w}\\in \\mathcal{E}')
('1.0.2.5', '\\partial (g\\circ f)({\\bm w})[{\\bm v}] \n    = \\partial g(f({\\bm w}))[\\partial f({\\bm w})[{\\bm v}]]')
('1.0.2.5', '\\partial (g\\circ f)({\\bm w})^*[{\\bm u}] \n    = \\partial f({\\bm w})^*[\\partial g(f({\\bm w}))^*[{\\bm u}]].')
('1.0.2.5', 'f:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.5', 'g: \\mathcal{F}\\rightarrow \\mathbb{R}')
('1.0.2.5', '\\nabla \t(g\\circ f)({\\bm w}) = \\partial f({\\bm w})^* [\\nabla g(f({\\bm w}))].')
('1.0.2.6', 'f({\\bm x}, {\\bm W}) = {\\bm W}{\\bm x}')
('1.0.2.6', '\\mathcal{E}=\n\\mathbb{R}^D \\times \\mathbb{R}^{M \\times D}')
('1.0.2.6', 'f({\\bm w}_1, \\ldots, {\\bm w}_S)')
('1.0.2.6', '\\mathcal{E}= \\mathcal{E}_1 \\times \\ldots \\times \\mathcal{E}_S')
('1.0.2.6', '{\\bm w}_i \\in \\mathcal{E}_i')
('1.0.2.6', 'i')
('1.0.2.6', '{\\bm w}_i')
('1.0.2.6', '{\\bm v}_i \\in \\mathcal{E}_i')
('1.0.2.6', '\\partial_i f({\\bm w}_1, \\ldots, {\\bm w}_S)[{\\bm v}_i]')
('1.0.2.6', 'f({\\bm w}) = f({\\bm w}_1, \\dots, {\\bm w}_S)')
('1.0.2.6', 'f \\colon \\mathcal{E}\\to \\mathcal{F}')
('1.0.2.6', '{\\bm w}\\coloneqq ({\\bm w}_1, \\dots, {\\bm w}_S) \\in \\mathcal{E}')
('1.0.2.6', '\\mathcal{E}\\coloneqq \\mathcal{E}_1 \\times \\dots \\times \\mathcal{E}_S')
('1.0.2.6', '{\\bm v}= ({\\bm v}_1, \\dots, {\\bm v}_S) \\in \\mathcal{E}')
('1.0.2.6', '\\begin{aligned}\n\\partial f({\\bm w})[{\\bm v}]\n&= \\partial f({\\bm w}_1, \\dots, {\\bm w}_S)[{\\bm v}_1, \\dots, {\\bm v}_S] \\in \\mathcal{F}\\\\\n&= \\sum_{i=1}^S \\partial_i f({\\bm w}_1, \\dots, {\\bm w}_S)[{\\bm v}_i].\n\\end{aligned}')
('1.0.2.6', '{\\bm u}\\in \\mathcal{F}')
('1.0.2.6', '\\begin{aligned}\n\\partial f({\\bm w})^*[{\\bm u}] \n&= \\partial f({\\bm w}_1, \\dots, {\\bm w}_S)^*[{\\bm u}] \\in \\mathcal{E}\\\\\n&= (\\partial_1 f({\\bm w}_1, \\dots, {\\bm w}_S)^*[{\\bm u}], \\dots, \n\\partial_S f({\\bm w}_1, \\dots, {\\bm w}_S)^*[{\\bm u}]).\n\\end{aligned}')
('1.0.2.6', 'f({\\bm x}, {\\bm W}) = {\\bm W}{\\bm x}')
('1.0.2.6', '{\\bm W}\\in \\mathbb{R}^{M \\times D}')
('1.0.2.6', '{\\bm x}\\in\n\\mathbb{R}^D')
('1.0.2.6', '\\mathcal{E}= \\mathcal{E}_1 \\times \\mathcal{E}_2 = \\mathbb{R}^D \\times\n\\mathbb{R}^{M \\times D}')
('1.0.2.6', '\\mathcal{F}= \\mathbb{R}^M')
('1.0.2.6', '{\\bm v}\\in \\mathbb{R}^D')
('1.0.2.6', '{\\bm V}\n\\in \\mathbb{R}^{M \\times D}')
('1.0.2.6', '\\partial f({\\bm x}, {\\bm W})[{\\bm v}, {\\bm V}] = {\\bm W}{\\bm v}+ {\\bm V}{\\bm x}\\in \\mathcal{F}.')
('1.0.2.6', '\\begin{aligned}\n    \\partial_1 f({\\bm x}, {\\bm W})[{\\bm v}] &= {\\bm W}{\\bm v}\\in \\mathcal{F}, \\\\\n    \\partial_2 f({\\bm x}, {\\bm W})[{\\bm V}] &= {\\bm V}{\\bm x}\\in \\mathcal{F}.\n\\end{aligned}')
('1.0.2.6', '{\\bm u}\\in \\mathbb{R}^M')
('1.0.2.6', '\\partial f({\\bm x}, {\\bm W})^*[{\\bm u}] = ({\\bm W}^\\top {\\bm u}, {\\bm u}{\\bm x}^\\top)\n\\in \\mathcal{E}.')
('1.0.2.6', '\\begin{aligned}\n    \\partial_1 f({\\bm x}, {\\bm W})^*[{\\bm u}] &= {\\bm W}^\\top {\\bm u}\\in \\mathcal{E}_1, \\\\\n    \\partial_2 f({\\bm x}, {\\bm W})^*[{\\bm u}] &= {\\bm u}{\\bm x}^\\top \\in \\mathcal{E}_2.\n\\end{aligned}')
('1.0.2.6', '{\\bm x}= ({\\bm x}_1,\n{\\bm x}_2)')
('1.0.2.6', '{\\bm x}_1')
('1.0.2.6', '{\\bm x}_2')
('1.0.2.6', '{\\bm w}= ({\\bm w}_1, {\\bm w}_2,\n{\\bm w}_3)')
('1.0.2.6', 'f({\\bm x}, {\\bm w}) = f(({\\bm x}_1, {\\bm x}_2), ({\\bm w}_1, {\\bm w}_2, {\\bm w}_3))')
('1.0.2.6', 'L({\\bm w}; {\\bm x}, {\\bm y})')
('1.0.2.6', 'L \\colon \\mathcal{W}\\to \\mathbb{R}')
('1.0.2.6', '{\\bm x}')
('1.0.2.6', '{\\bm y}')
('1.0.2.6', '\\nabla L({\\bm w}; {\\bm x}, {\\bm y}) \\in\n\\mathcal{W}')
('1.0.2.6', 'L({\\bm w}, {\\bm x}, {\\bm y})')
('1.0.2.6', 'L \\colon \\mathcal{W}\\times \\mathcal{X}\\times \\mathcal{Y}\\to \\mathbb{R}')
('1.0.2.6', '\\nabla L({\\bm w}, {\\bm x}, {\\bm y}) \\in \\mathcal{W}\\times \\mathcal{X}\\times \\mathcal{Y}')
('1.0.2.6', '\\nabla_1 L({\\bm w}, {\\bm x}, {\\bm y}) \\in\n\\mathcal{W}')
('1.0.2.6', '\\nabla_{\\bm w}L({\\bm w}, {\\bm x}, {\\bm y}) \\in \\mathcal{W}')
('1.0.2.7', 'f({\\bm w}) = (f_1({\\bm w}), \\dots, f_T({\\bm w}))')
('1.0.2.7', 'f \\colon \\mathcal{E}\\to \\mathcal{F}')
('1.0.2.7', 'f_i \\colon \\mathcal{E}\\to \\mathcal{F}_i')
('1.0.2.7', '\\mathcal{F}\\coloneqq \\mathcal{F}_1 \\times \\dots \\times \\mathcal{F}_T')
('1.0.2.7', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.7', '\\begin{aligned}\n\\partial f({\\bm w})[{\\bm v}] = (\\partial f_1({\\bm w})[{\\bm v}], \\dots, \\partial f_T({\\bm w})[{\\bm v}]) \\in \\mathcal{F}.\n\\end{aligned}')
('1.0.2.7', '{\\bm u}= ({\\bm u}_1, \\dots, {\\bm u}_T) \\in \\mathcal{F}')
('1.0.2.7', '\\begin{aligned}\n\\partial f({\\bm w})^*[{\\bm u}] \n&= \\partial f({\\bm w})^*[{\\bm u}_1, \\dots, {\\bm u}_T] \\in \\mathcal{E}\\\\\n&= \\sum_{i=1}^T \\partial f_i({\\bm w})^*[{\\bm u}_i].\n\\end{aligned}')
('1.0.2.7', '{\\bm h}({\\bm w}) \\coloneqq g(f({\\bm w})) = g(f_1({\\bm w}), \\dots, f_T({\\bm w}))')
('1.0.2.7', '\\partial {\\bm h}({\\bm w}) \n=  \\sum_{i=1}^T \\partial_i f(g({\\bm w})) \\circ \\partial g_i({\\bm w})')
('1.0.2.7', '\\partial {\\bm h}({\\bm w}) [{\\bm v}]\n\t=  \\sum_{i=1}^T \\partial_i f(g({\\bm w})) [\\partial g_i({\\bm w})[{\\bm v}]].')
('1.0.2.8', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.2.8', '\\mathcal{E}')
('1.0.2.8', '\\mathcal{F}')
('1.0.2.8', '\\mathcal{F}')
('1.0.2.8', 'l')
('1.0.2.8', 'C>0')
('1.0.2.8', 'l[{\\bm v}] \\leq C \\|{\\bm v}\\|')
('1.0.2.8', '\\|\\cdot\\|')
('1.0.2.8', '\\mathcal{E}')
('1.0.2.8', 'f: \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.2.8', '\\partial\nf({\\bm w}): \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.2.8', 'g \\in \\mathcal{E}')
('1.0.2.8', '\\partial f({\\bm w}) {\\bm v}= \\langle g, {\\bm v}\\rangle')
('1.0.2.8', '{\\bm v}\\in \\mathcal{E}')
('1.0.2.8', '\\mathbb{R}')
('1.0.2.8', '\\langle a, b \\rangle  \\coloneqq \\int a(x)b(x) dx.')
('1.0.2.8', '\\mathbb{R}')
('1.0.3.0', 'f:\\mathbb{R}\\rightarrow\n\\mathbb{R}')
('1.0.3.0', "f': \\mathbb{R}\\rightarrow\n\\mathbb{R}")
('1.0.3.0', 'f^{(2)}(w)')
('1.0.3.0', 'f:\n  \\mathbb{R}\\rightarrow \\mathbb{R}')
('1.0.3.0', 'w \\in \\mathbb{R}')
('1.0.3.0', "f'")
('1.0.3.0', 'w')
('1.0.3.0', "f^{(2)}(w) \n    \\coloneqq \\lim_{\\delta \\rightarrow 0} \\frac{f'(w+\\delta) - f'(w)}{\\delta},")
('1.0.3.0', 'f')
('1.0.3.0', 'w')
('1.0.3.0', 'w')
('1.0.3.0', 'f')
('1.0.3.0', 'w')
('1.0.3.0', 'w')
('1.0.3.0', 'w')
('1.0.3.1', 'f:\\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.3.1', 'f')
('1.0.3.1', '{\\bm w}')
('1.0.3.1', 'f:\\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.3.1', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.3.1', "{\\bm v}, {\\bm v}' \\in \\mathbb{R}^P")
('1.0.3.1', '{\\bm w}\\mapsto \\partial f({\\bm w})[{\\bm v}]')
('1.0.3.1', "{\\bm v}'")
('1.0.3.1', "\\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}'] \n    \\coloneqq \\lim_{\\delta \\rightarrow 0} \n    \\frac{\\partial f({\\bm w}+ \\delta {\\bm v}')[{\\bm v}] - \\partial f({\\bm w})[{\\bm v}]}{\\delta},")
('1.0.3.1', '\\partial f({\\bm w})[{\\bm v}]')
('1.0.3.1', '{\\bm w}')
('1.0.3.1', '\\partial_{i j}^2 f({\\bm w}) \\coloneqq \\partial^2 f({\\bm w})[{\\bm e}_i, {\\bm e}_j]')
('1.0.3.1', '{\\bm e}_i')
('1.0.3.1', '{\\bm e}_j')
('1.0.3.1', 'i')
('1.0.3.1', 'j')
('1.0.3.1', '\\mathbb{R}^P')
('1.0.3.1', '\\partial_{i j}^2 f({\\bm w}) = \\frac{\\partial^2\nf({\\bm w})}{\\partial w_i \\partial w_j}.')
('1.0.3.2', '\\partial f({\\bm w})[{\\bm v}]')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', 'f: \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.3.2', '{\\bm w}\n  \\in \\mathbb{R}^P')
('1.0.3.2', '\\partial f: \\mathbb{R}^P \\rightarrow (\\mathbb{R}^P\n  \\rightarrow\\mathbb{R})')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', 'b: \\mathbb{R}^P \\times \\mathbb{R}^P \\rightarrow \\mathbb{R}^M')
('1.0.3.2', 'b[{\\bm v}, \\cdot]: \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.3.2', '{\\bm v}')
('1.0.3.2', "b[\\cdot, {\\bm v}']")
('1.0.3.2', "{\\bm v}'")
('1.0.3.2', "b[{\\bm v}, {\\bm v}'] = \\sum_{i=1}^P v_i b[{\\bm e}_i, {\\bm v}'] = \\sum_{i=1}^{P}\n    \\sum_{j=1}^P v_iv_j' b[{\\bm e}_i, {\\bm e}_j],")
('1.0.3.2', '{\\bm v}= \\sum_{i=1}^P v_i {\\bm e}_i')
('1.0.3.2', "{\\bm v}' = \\sum_{i=1}^P v_i' {\\bm e}_i")
('1.0.3.2', '\\mathbb{R}')
('1.0.3.2', 'b: \\mathbb{R}^P \\times \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.3.2', 'f:\\mathbb{R}^P \\rightarrow\n  \\mathbb{R}')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', 'P \\times P')
('1.0.3.2', '\\nabla^2 f({\\bm w}) \\coloneqq \\begin{pmatrix}\n      \\partial_{11} f({\\bm w}) & \\ldots & \\partial_{1P} f({\\bm w}) \\\\\n      \\vdots & \\ddots & \\vdots \\\\\n      \\partial_{P1} f({\\bm w}) & \\ldots & \\partial_{PP} f({\\bm w})\n    \\end{pmatrix},')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', '{\\bm v}=\n  \\sum_{i=1}^P v_i {\\bm e}_i')
('1.0.3.2', "{\\bm v}' = \\sum_{i=1}^P\n  v_i' {\\bm e}_i")
('1.0.3.2', "\\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}'] \n    = \\sum_{i, j = 1}^{P} v_i v_j'\\partial^2 f({\\bm w})[{\\bm e}_i, {\\bm e}_j]\n    = \\langle {\\bm v}, \\nabla^2 f({\\bm w}) {\\bm v}'\\rangle.")
('1.0.3.2', 'f')
('1.0.3.2', '\\nabla')
('1.0.3.2', '\\nabla^2 f({\\bm w}) = \\nabla (\\nabla f)({\\bm w})')
('1.0.3.2', 'f')
('1.0.3.2', 'f')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', 'f:\\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.3.2', '{\\bm w}')
('1.0.3.2', '\\nabla^2 f({\\bm w})')
('1.0.3.2', '\\partial_{i j}^2 f({\\bm w}) =\n  \\partial_{j i}^2 f({\\bm w})')
('1.0.3.2', 'i, j \\in \\{1, \\ldots P\\}')
('1.0.3.2', '\\nabla^2 f({\\bm w}) = (\\partial_{ji}^2f({\\bm w}))_{i, j=1}^P = \\bm \\partial(\\nabla f)({\\bm w})')
('1.0.3.2', 'f')
('1.0.3.3', 'f: \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.3.3', '\\mathcal{E}')
('1.0.3.3', '\\langle\\cdot, \\cdot\\rangle')
('1.0.3.3', '{\\bm w}\\in\n  \\mathcal{E}')
('1.0.3.3', '{\\bm v}\\in \\mathcal{E}')
('1.0.3.3', '\\nabla^2 f({\\bm w})[{\\bm v}]')
('1.0.3.3', 'f')
('1.0.3.3', '{\\bm w}')
('1.0.3.3', '{\\bm v}')
('1.0.3.3', "{\\bm v}' \\in \\mathcal{E}")
('1.0.3.3', "\\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}'] = \\langle {\\bm v}', \\nabla^2 f({\\bm w})[{\\bm v}]\\rangle.")
('1.0.3.3', '\\mathcal{E}= \\mathbb{R}^P')
('1.0.3.3', '\\nabla^2 f({\\bm w})[{\\bm v}]= (\\partial^2 f({\\bm w})[{\\bm v}, {\\bm e}_i])_{i=1}^P')
('1.0.3.4', 'f: \\mathcal{E}\n\\rightarrow \\mathcal{F}')
('1.0.3.4', 'f \\coloneqq (f_1, \\dots, f_M)')
('1.0.3.4', 'f_j \\colon \\mathcal{E}\\to\n\\mathcal{F}_j')
('1.0.3.4', '\\mathcal{F}\\coloneqq \\mathcal{F}_1 \\times \\dots \\times \\mathcal{F}_M')
('1.0.3.4', "{\\bm w}, {\\bm v}, {\\bm v}' \\in \\mathcal{E}")
('1.0.3.4', "\\partial f({\\bm w})[{\\bm v}, {\\bm v}'] = (\\partial f_j({\\bm w})[{\\bm v}, {\\bm v}'])_{j=1}^M \\in \\mathcal{F}.")
('1.0.3.4', 'f')
('1.0.3.4', "\\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}'] \n  = \\sum_{i,j=1}^P v_i v_j' \\partial^2 f({\\bm w})[{\\bm e}_i, {\\bm e}_j]\n  = (\\langle {\\bm v}, \\nabla^2 f_j({\\bm w}) {\\bm v}'\\rangle)_{j=1}^M.")
('1.0.3.4', '\\mathcal{E}= \\mathbb{R}^P')
('1.0.3.4', '\\mathcal{F}_j = \\mathbb{R}')
('1.0.3.4', '\\mathcal{F}= \\mathbb{R}^M')
('1.0.3.4', '\\partial^2 f({\\bm w}) \n= (\\partial^2 f({\\bm w})[{\\bm e}_i, {\\bm e}_j])_{i,j=1}^P\n\\in \\mathbb{R}^{M \\times P \\times P},')
('1.0.3.4', 'f')
('1.0.3.4', '{\\bm v}')
('1.0.3.4', "{\\bm v}'")
('1.0.4.0', 'n')
('1.0.4.0', 'n')
('1.0.4.0', 'f^{(n)}')
('1.0.4.0', 'f:\\mathbb{R}\n  \\rightarrow \\mathbb{R}')
('1.0.4.0', 'w \\in \\mathbb{R}')
('1.0.4.0', "f^{(n)}(w) \n    \\coloneqq (f^{(n-1)})'(w)\n    = \\lim_{\\delta \\rightarrow 0} \\frac{f^{(n-1)}(w+\\delta) - f^{(n-1)}(w)}{\\delta}")
('1.0.4.0', 'f^{n-1}')
('1.0.4.0', 'w')
('1.0.4.0', 'n')
('1.0.4.0', 'w')
('1.0.4.1', 'f')
('1.0.4.1', 'n')
('1.0.4.1', 'f: \\mathbb{R}^P \\rightarrow \\mathbb{R}')
('1.0.4.1', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.4.1', '{\\bm v}_1, \\ldots, {\\bm v}_n')
('1.0.4.1', '\\begin{aligned}\n    & \\partial^n f({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_n] \\\\\n    & = \\partial (\\partial^{n-1}f({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_{n-1}])[{\\bm v}_n] \\\\\n    & = \\lim_{\\delta \\rightarrow 0} \n    \\frac{\n      \\partial f({\\bm w}+ \\delta {\\bm v}_n)[{\\bm v}_1, \\ldots, {\\bm v}_{n-1}] \n      - \\partial f({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_{n-1}]\n    }{\n      \\delta\n    }\n  \n\\end{aligned}')
('1.0.4.1', 'f')
('1.0.4.1', 'n')
('1.0.4.1', 'n-1')
('1.0.4.1', 'n-1')
('1.0.4.1', 'n')
('1.0.4.1', 'c: \\otimes_{i=1}^n \\mathbb{R}^P\n\\rightarrow \\mathbb{R}^M')
('1.0.4.1', '{\\bm v}_j \\mapsto c[{\\bm v}_1,\\ldots,{\\bm v}_j,\\ldots,\n{\\bm v}_n]')
('1.0.4.1', '{\\bm v}_j')
('1.0.4.1', 'j \\in [n]')
('1.0.4.1', '\\mathbb{R}')
('1.0.4.1', 'n')
('1.0.4.1', '\\partial^n f({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_n] \n  = \\sum_{i_1, \\ldots, i_n=1}^P v_{1,i_1} \\ldots v_{n, i_n} \n  \\partial^n f({\\bm w})[{\\bm e}_{i_1}, \\ldots, {\\bm e}_{i_n}].')
('1.0.4.1', 'n')
('1.0.4.1', '\\nabla^n f({\\bm w}) = (\\partial^n f({\\bm w})[{\\bm e}_{i_1}, \\ldots,\n{\\bm e}_{i_n}])_{i_1, \\ldots, i_n=1}^P \\in \\mathbb{R}^{P \\times \\ldots \\times P}.')
('1.0.4.2', 'f:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.4.2', '\\mathcal{F}= \\mathcal{F}_1 \\times \\dots \\times \\mathcal{F}_M')
('1.0.4.2', 'n')
('1.0.4.2', '\\partial^n f({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_n] \n  = (\\partial^n f_j({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_n])_{j=1}^M.')
('1.0.4.2', 'f')
('1.0.4.2', 'n')
('1.0.4.2', 'n-1')
('1.0.4.2', 'n-1')
('1.0.4.2', 'n')
('1.0.4.2', 'n')
('1.0.4.2', '\\partial^n\nf({\\bm w})[{\\bm v}_1, \\ldots, {\\bm v}_n] = \\sum_{i_1, \\ldots, i_n=1}^P v_{1,i_1} \\ldots v_{n,\ni_n} \\partial^n f({\\bm w})[{\\bm e}_{i_1}, \\ldots, {\\bm e}_{i_n}].')
('1.0.4.2', '\\mathcal{E}= \\mathbb{R}^P')
('1.0.4.2', '\\mathcal{F}= \\mathbb{R}^M')
('1.0.4.2', 'n+1')
('1.0.4.2', '\\partial^n f({\\bm w}) = (\\partial^n f_j({\\bm w})[{\\bm e}_{i_1}, \\ldots, {\\bm e}_{i_n}])_{j=1, i_1,\n\\ldots, i_n=1}^{M, P, \\ldots, P} \\in\n\\mathbb{R}^{M \\times P \\times \\ldots \\times P}.')
('1.0.4.3', 'o')
('1.0.4.3', '{\\bm v}')
('1.0.4.3', 'f({\\bm w}+{\\bm v}) \n  = f({\\bm w}) \n  + \\langle \\nabla f({\\bm w}), {\\bm v}\\rangle\n  + o(\\|{\\bm v}\\|_2).')
('1.0.4.3', 'f')
('1.0.4.3', '{\\bm w}')
('1.0.4.3', 'f')
('1.0.4.3', '{\\bm v}')
('1.0.4.3', 'f')
('1.0.4.3', '{\\bm w}')
('1.0.4.3', 'f({\\bm w}+{\\bm v}) \n  = f({\\bm w}) \n  + \\langle \\nabla f({\\bm w}), {\\bm v}\\rangle\n  + \\frac{1}{2}\\langle {\\bm v}, \\nabla^2 f({\\bm w}) {\\bm v}\\rangle\n  + o(\\|{\\bm v}\\|_2^2).')
('1.0.4.3', '{\\bm w}')
('1.0.4.3', '\\|{\\bm v}\\|_2^3\n\\leq \\|{\\bm v}\\|_2^2')
('1.0.4.3', '\\|{\\bm v}\\|_2 \\le 1')
('1.0.4.3', '{\\bm n}')
('1.0.4.3', 'n')
('1.0.4.3', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}^M')
('1.0.4.3', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.4.3', '\\begin{aligned}\nf({\\bm w}+{\\bm v}) \n& = f({\\bm w}) \n+ \\partial f({\\bm w})[{\\bm v}] \n+ \\frac{1}{2} \\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}] \n+ \\ldots \\\\\n& + \\frac{1}{n!} \\partial^n\nf({\\bm w})[\\underbrace{{\\bm v}, \\ldots, {\\bm v}}_{n \\, \\mathrm{times}}]\n+ o(\\|{\\bm v}\\|_2^{n}).\n\\end{aligned}')
('1.0.4.3', "{\\bm w}' = {\\bm w}+ {\\bm v}\\iff {\\bm v}= {\\bm w}'\n- {\\bm w}")
('1.0.4.3', 'n')
('1.0.4.3', "f({\\bm w}')")
('1.0.4.3', '{\\bm w}')
('1.0.4.3', "f({\\bm w}') \n= f({\\bm w}) + \\sum_{j=1}^{n} \\frac{1}{j!} \\partial^j \nf({\\bm w})[\\underbrace{{\\bm w}' - {\\bm w}, \\ldots, {\\bm w}' - {\\bm w}}_{j \\, \\mathrm{times}}]\n+ o(\\|{\\bm w}' - {\\bm w}\\|_2^{n}).")
('1.0.5.0', '\\mathcal{M}')
('1.0.5.0', '\\mathcal{N}')
('1.0.5.0', 'f: \\mathcal{M} \\rightarrow \\mathcal{N}')
('1.0.5.0', '\\mathcal{M}\n  \\subseteq \\mathcal{E}')
('1.0.5.0', '\\mathcal{N} \\subseteq \\mathcal{F}')
('1.0.5.0', '\\mathcal{E}')
('1.0.5.0', '\\mathcal{F}')
('1.0.5.0', 'f')
('1.0.5.0', '\\bar f:\\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.5.0', 'f')
('1.0.5.0', '\\bar f')
('1.0.5.0', '\\mathcal{M}')
('1.0.5.1', 'f')
('1.0.5.1', 'f')
('1.0.5.1', 'f')
('1.0.5.1', '\\mathcal{S}^P')
('1.0.5.1', '\\mathbb{R}^P')
('1.0.5.1', '\\alpha: \\mathbb{R}\\rightarrow\n\\mathcal{S}^P')
('1.0.5.1', '{\\bm w}\\in \\mathcal{S}^P')
('1.0.5.1', '0')
('1.0.5.1', '\\alpha(0) =\n{\\bm w}')
('1.0.5.1', '\\alpha')
('1.0.5.1', "\\alpha'(0) \\coloneqq (\\alpha_1'(0), \\ldots, \\alpha_P'(0))")
('1.0.5.1', 'f')
('1.0.5.1', 'f\\circ \\alpha')
('1.0.5.1', '0')
('1.0.5.1', "(f\\circ \\alpha)'(0) =\n\\partial f({\\bm w})[\\alpha'(0)]")
('1.0.5.1', "\\alpha'(0)")
('1.0.5.1', '\\alpha')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', 'f')
('1.0.5.1', '\\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.1', '\\mathcal{M}')
('1.0.5.1', '{\\bm w}\\in \\mathcal{M}')
('1.0.5.1', "\\mathcal{T}_{\\bm w}\\mathcal{M} \\coloneqq \\{{\\bm v}= \\alpha'(0) \n    \\ \\mbox{for any} \\ \n    \\alpha: \\mathbb{R}\\rightarrow \\mathcal{M}\n    \\ \\mbox{differentiable s.t.} \\\n    \\alpha(0) = {\\bm w}\n    \\}.")
('1.0.5.1', 'f')
('1.0.5.1', '\\mathcal{M}')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', 'f\\circ \\alpha')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', "(f\\circ \\alpha)'(0)")
('1.0.5.1', 'f({\\bm w})')
('1.0.5.1', '0')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', 'f({\\bm w})')
('1.0.5.1', 'f: \\mathcal{M}\n\\rightarrow \\mathcal{N}')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', '\\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.1', '\\mathcal{M}')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', '\\mathcal{T}_{f({\\bm w})}\n\\mathcal{N}')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', 'f({\\bm w})')
('1.0.5.1', 'f')
('1.0.5.1', '\\alpha')
('1.0.5.1', '\\alpha')
('1.0.5.1', 'f\\circ \\alpha')
('1.0.5.1', '\\mathcal{M}')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', 'f: \\mathcal{M} \\rightarrow \\mathcal{N}')
('1.0.5.1', '{\\bm w}\\in\n  \\mathcal{M}')
('1.0.5.1', '\\partial f({\\bm w}): \\mathcal{T}_{\\bm w}\\mathcal{M} \\rightarrow\n  \\mathcal{T}_{f({\\bm w})} \\mathcal{N}')
('1.0.5.1', "\\partial f({\\bm w})[{\\bm v}] \\coloneqq (f\\circ \\alpha)'(0),")
('1.0.5.1', '{\\bm v}\\in \\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.1', "{\\bm v}= \\alpha'(0)")
('1.0.5.1', '\\alpha: \\mathbb{R}\\rightarrow \\mathcal{M}')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', '0')
('1.0.5.1', '\\alpha(0) = {\\bm w}')
('1.0.5.1', 'f')
('1.0.5.1', '\\mathcal{M}')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', '{\\bm w}')
('1.0.5.1', '\\mathcal{T}_{{\\bm w}} \\mathcal{M}')
('1.0.5.1', '\\mathcal{N}')
('1.0.5.1', 'f({\\bm w})')
('1.0.5.1', '\\mathcal{T}_{f({\\bm w})}\\mathcal{N}')
('1.0.5.2', 'f: \\mathcal{M}\\rightarrow \\mathcal{N}')
('1.0.5.2', '\\alpha: \\mathbb{R}\\rightarrow \\mathcal{M}')
('1.0.5.2', '\\alpha')
('1.0.5.2', '\\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.2', '\\mathcal{T}_{f({\\bm w})} \\mathcal{N}')
('1.0.5.2', 'f')
('1.0.5.2', '\\beta: \\mathcal{N}\\rightarrow \\mathbb{R}')
('1.0.5.2', '{\\bm y}\\in \\mathcal{N}')
('1.0.5.2', '{\\bm y}=f({\\bm w})')
('1.0.5.2', '{\\bm w}\\in \\mathcal{M}')
('1.0.5.2', '\\beta')
('1.0.5.2', 'f')
('1.0.5.2', '\\beta: \\mathcal{N}\\rightarrow \\mathbb{R}')
('1.0.5.2', '{\\bm y}')
('1.0.5.2', '\\mathcal{N}')
('1.0.5.2', '{\\bm y}\\in \\mathcal{N}')
('1.0.5.2', '\\begin{aligned}\n    \\mathcal{T}_{\\bm y}^* \\mathcal{N} & = \\{\n      u = \\partial \\beta({\\bm y})\n    \\ \\mbox{for any} \\ \\beta: \\mathcal{N}\\rightarrow \\mathbb{R}\\ \\mbox{differentiable}\n    \\} \\\\\n    & = \\{u: \\mathcal{T}_{\\bm y}\\mathcal{N} \\rightarrow \\mathbb{R}\\ \\mbox{for any linear map} \\ u \\},\n  \n\\end{aligned}')
('1.0.5.2', '\\mathcal{T}_{\\bm y}\\mathcal{N}')
('1.0.5.2', '\\mathcal{T}_{\\bm y}\\mathcal{N}')
('1.0.5.2', '\\mathbb{R}')
('1.0.5.2', '\\mathcal{T}_{\\bm y}\\mathcal{N}')
('1.0.5.2', '\\mathcal{T}_ {\\bm y}^* \\mathcal{N}')
('1.0.5.2', '\\beta \\circ f')
('1.0.5.2', '\\beta')
('1.0.5.2', 'f({\\bm w})')
('1.0.5.2', '\\mathcal{M}')
('1.0.5.2', '\\mathcal{N}')
('1.0.5.2', 'f: \\mathcal{M} \\rightarrow \\mathcal{N}')
('1.0.5.2', '{\\bm w}\\in \\mathcal{M}')
('1.0.5.2', '\\partial f({\\bm w})^\\star: \\mathcal{T}_{f({\\bm w})}^*\\mathcal{N}\n  \\rightarrow \\mathcal{T}_{{\\bm w}}^* \\mathcal{M}')
('1.0.5.2', '\\partial f({\\bm w})^\\star u \\coloneqq \\partial (\\beta \\circ f)({\\bm w}),')
('1.0.5.2', 'u \\in \\mathcal{T}_{f({\\bm w})} \\mathcal{N}^*')
('1.0.5.2', '\\partial \\beta(\n  f({\\bm w})) = u')
('1.0.5.2', '\\beta: \\mathcal{N}\\rightarrow \\mathbb{R}')
('1.0.5.2', '\\partial\nf({\\bm w})^\\star')
('1.0.5.2', '\\partial f({\\bm w})^*')
('1.0.5.2', '\\partial f({\\bm w})')
('1.0.5.2', '\\partial \nf({\\bm w})^*')
('1.0.5.2', '\\langle \\cdot, \\cdot \\rangle_{\\bm w}')
('1.0.5.2', '\\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.2', '{\\bm w}\\in \\mathcal{M}')
('1.0.5.2', '\\mathcal{M}')
('1.0.5.2', '\\mathcal{M}')
('1.0.5.2', '\\langle\n  \\cdot, \\cdot\\rangle_{\\bm w}')
('1.0.5.2', 'u \\in \\mathcal{T}_{\\bm w}^*\n  \\mathcal{M}')
('1.0.5.2', '{\\bm w}\\in \\mathcal{M}')
('1.0.5.2', '{\\bm u}\\in \\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.2', '\\forall {\\bm v}\\in \\mathcal{T}_{\\bm w}\\mathcal{M}, \\ u[{\\bm v}] = \\langle {\\bm u}, {\\bm v}\\rangle_{\\bm w}.')
('1.0.5.2', 'f: \\mathcal{M}\\rightarrow \\mathbb{R}')
('1.0.5.2', 'f')
('1.0.5.2', '\\nabla\n  f({\\bm w}) \\in \\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.2', '\\forall {\\bm v}\\in \\mathcal{T}_{\\bm w}\\mathcal{M}, \\ \\partial f({\\bm w})[{\\bm v}] = \\langle \\nabla f({\\bm w}), {\\bm v}\\rangle.')
('1.0.5.2', '\\partial\nf({\\bm w})^*')
('1.0.5.2', '\\mathcal{M}')
('1.0.5.2', '\\mathcal{N}')
('1.0.5.2', 'f: \\mathcal{M} \\rightarrow\n\\mathcal{N}')
('1.0.5.2', '\\left(\\partial f({\\bm w})^\\star u\\right)[{\\bm v}] = \\langle \\partial f({\\bm w})^*[{\\bm u}], {\\bm v}\\rangle \n  \\ \\mbox{for any} \\ {\\bm v}\\in \\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.2', 'u = \\langle \\cdot, {\\bm u}\\rangle \\in \\mathcal{T}_{f({\\bm w})}^* \\mathcal{N}')
('1.0.5.2', '{\\bm u}\\in\n\\mathcal{T}_{f({\\bm w})} \\mathcal{N}')
('1.0.5.2', 'f')
('1.0.5.2', '\\mathcal{M}')
('1.0.5.2', '\\mathcal{N}')
('1.0.5.2', '\\partial f({\\bm w})')
('1.0.5.2', '\\partial f({\\bm w})^\\star')
('1.0.5.2', '\\partial f({\\bm w})^*')
('1.0.5.2', 'f')
('1.0.5.2', '\\mathcal{M}\\rightarrow \\mathcal{N}')
('1.0.5.2', '\\partial f({\\bm w})')
('1.0.5.2', '\\mathcal{T}_{\\bm w}\\mathcal{M} \\rightarrow \\mathcal{T}_{f({\\bm w})} \\mathcal{N}')
('1.0.5.2', '\\partial f({\\bm w})^\\star')
('1.0.5.2', '\\mathcal{T}_{f({\\bm w})}^*\\mathcal{N} \\rightarrow \\mathcal{T}_{\\bm w}^* \\mathcal{M}')
('1.0.5.2', '\\partial f({\\bm w})^*')
('1.0.5.2', '\\mathcal{T}_{f({\\bm w})} \\mathcal{N} \\rightarrow \\mathcal{T}_{\\bm w}\\mathcal{M}')
('1.0.5.2', '\\mathcal{S}^P')
('1.0.5.2', '\\mathbb{R}^P')
('1.0.5.2', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.5.2', 'c({\\bm w}) \\coloneqq \\langle {\\bm w}, {\\bm w}\\rangle - 1 = 0')
('1.0.5.2', '\\partial\nc({\\bm w})[{\\bm v}] = 2\\langle {\\bm w}, {\\bm v}\\rangle')
('1.0.5.2', '{\\bm v}= (v_1, \\ldots, v_{P-1}) \\in \\mathbb{R}^{P-1}')
('1.0.5.2', '{\\bm w}')
('1.0.5.2', '\\psi_1({\\bm v}) = \\sqrt{1-\n\\langle {\\bm v}, {\\bm v}\\rangle}')
('1.0.5.2', '{\\bm \\psi}({\\bm v}) = (v_1, \\ldots, v_{P-1},\n\\psi_1({\\bm v}))')
('1.0.5.2', '\\langle {\\bm \\psi}({\\bm v}), {\\bm \\psi}({\\bm v})\\rangle = 1')
('1.0.5.2', 'c({\\bm \\psi}({\\bm w})) =1')
('1.0.5.2', '{\\bm \\psi}^{-1}')
('1.0.5.2', '{\\bm w}')
('1.0.5.2', '\\mathbb{R}^{P-1}')
('1.0.5.2', 'P-1')
('1.0.5.2', 'c')
('1.0.5.2', '\\alpha: \\mathbb{R}\\rightarrow \\mathcal{S}')
('1.0.5.2', '\\alpha(0) ={\\bm w}')
('1.0.5.2', '\\delta\\in \\mathbb{R}')
('1.0.5.2', 'c(\\alpha(\\delta)) =\n{\\mathbf{0}}')
('1.0.5.2', "(c\\circ \\alpha)'(0) = \\partial c({\\bm w})[\\alpha'(0)].")
('1.0.5.2', "\\alpha'(0)")
('1.0.5.2', '\\partial c({\\bm w})')
('1.0.5.2', '\\mathrm{Null}(\\partial c({\\bm w}))\n\\coloneqq \\{{\\bm v}\\in \\mathbb{R}^P: \\partial c({\\bm w})[{\\bm v}] =0\\}.')
('1.0.5.2', '\\mathcal{S}')
('1.0.5.2', '{\\bm w}')
('1.0.5.2', '\\begin{aligned}\n  \\mathcal{T}_{\\bm w}\\mathcal{M} & = \\mathrm{Null}(2 \\langle {\\bm w}, \\cdot\\rangle)  \\\\\n  & = \\{ {\\bm v}\\in \\mathbb{R}^P: \\langle {\\bm w}, {\\bm v}\\rangle = 0\\}\n\\end{aligned}')
('1.0.5.2', 'P-1')
('1.0.5.2', '{\\bm w}')
('1.0.6.0', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.6.0', 'C\\geq 0')
('1.0.6.0', '{\\bm x}, {\\bm y}\\in \\mathcal{E}')
('1.0.6.0', '\\|f({\\bm x})- f({\\bm y})\\| \\leq C\\|{\\bm x}-{\\bm y}\\|.')
('1.0.6.0', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.6.0', '{\\bm x}\\in \\mathcal{E}')
('1.0.6.0', '\\mathcal{U}')
('1.0.6.0', '{\\bm x}')
('1.0.6.0', 'f')
('1.0.6.0', '\\mathcal{U}')
('1.0.6.0', 'f')
('1.0.6.0', '\\mathcal{E}')
('1.0.6.0', '\\mathcal{F}')
('1.0.6.0', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.6.0', 'f')
('1.0.6.0', '\\mathcal{E}')
('1.0.6.0', 'f')
('1.0.6.1', 'f: \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.6.1', '{\\bm w}\\in \\mathcal{E}')
('1.0.6.1', '{\\bm v}\n  \\in \\mathcal{E}')
('1.0.6.1', '\\partial_C f({\\bm w})[{\\bm v}] \\coloneqq \\limsup_{\\substack{{\\bm u}\\rightarrow {\\bm w}\\\\ \\delta \\searrow 0}} \n    \\frac{f({\\bm u}+ \\delta {\\bm v}) - f({\\bm u})}{\\delta},')
('1.0.6.1', '\\delta \\searrow 0')
('1.0.6.1', '\\delta')
('1.0.6.1', '0')
('1.0.6.1', '\\limsup_{{\\bm x}\\rightarrow {\\bm a}} f({\\bm x})\n    \\coloneqq \\lim_{\\varepsilon \\rightarrow 0}\n    \\sup\\{f({\\bm x}) : {\\bm x}\\in B({\\bm a}, \\varepsilon)\\setminus\\{{\\bm a}\\}\\}')
('1.0.6.1', 'B({\\bm a}, \\varepsilon) \\coloneqq \\{{\\bm x}\\in \\mathcal{E}: \\|{\\bm x}-{\\bm a}\\|\\leq \\varepsilon \\}')
('1.0.6.1', '{\\bm a}')
('1.0.6.1', '\\varepsilon')
('1.0.6.1', 'f:\n  \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.6.1', '{\\bm w}\\in \\mathcal{E}')
('1.0.6.1', '{\\bm g}\\in \\mathcal{E}')
('1.0.6.1', '\\forall {\\bm v}\\in \\mathcal{E}')
('1.0.6.1', '\\partial f({\\bm w})[{\\bm v}] \\geq \\langle {\\bm g}, {\\bm v}\\rangle.')
('1.0.6.1', 'f')
('1.0.6.1', '{\\bm w}')
('1.0.6.1', 'f')
('1.0.6.1', '\\mathcal{E}\\setminus \\Omega')
('1.0.6.1', '{\\bm w}')
('1.0.6.1', 'S\\subseteq \\mathcal{E}')
('1.0.6.1', 'S')
('1.0.6.1', '\\mathop{\\mathrm{conv}}(S) \\coloneqq \\{\\lambda_1 {\\bm s}_1 + \\ldots + \\lambda_m {\\bm s}_m \\\n  \\colon m \\in \\mathbb{N}, \\ \\lambda_i \\geq 0, \\sum_{i=1}^{m} \\lambda_i = 1, {\\bm s}_i\n  \\in S\\}.')
('1.0.6.1', 'f: \\mathcal{E}\\rightarrow \\mathbb{R}')
('1.0.6.1', '\\Omega')
('1.0.6.1', 'f')
('1.0.6.1', '{\\bm g}\\in \\mathcal{E}')
('1.0.6.1', 'f')
('1.0.6.1', '{\\bm w}\\in \\mathcal{E}')
('1.0.6.1', '\\begin{aligned}\n    {\\bm g}& \\in \\mathop{\\mathrm{conv}}\\left(\\left\\{\n      \\lim_{n \\rightarrow +\\infty} \\nabla f({\\bm v}_n) \\colon\n      ({\\bm v}_n)_{n=1}^{+\\infty} \\ \\mbox{s.t.} \\ {\\bm v}_n \\in \\mathcal{E}\\setminus \\Omega,  \\ \n      {\\bm v}_n  \\underset{n \\rightarrow + \\infty}{\\rightarrow} {\\bm w}\n    \\right\\}\\right).\n  \n\\end{aligned}')
('1.0.6.1', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.6.1', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.6.1', '\\Omega')
('1.0.6.1', 'f')
('1.0.6.1', 'f')
('1.0.6.1', '{\\bm w}\\in \\mathcal{E}')
('1.0.6.1', '\\mathbf{J}')
('1.0.6.1', '\\mathop{\\mathrm{conv}}\\left(\\left\\{\n      \\lim_{n \\rightarrow +\\infty} \\bm \\partial f({\\bm v}_n) \\colon\n      ({\\bm v}_n)_{n=1}^{+\\infty} \\ \\mbox{s.t.} \\ {\\bm v}_n \\in \\mathcal{E}\\setminus \\Omega,  \\ \n      {\\bm v}_n  \\underset{n \\rightarrow + \\infty}{\\rightarrow} {\\bm w}\n    \\right\\}\\right).')
('1.0.6.1', 'f: \\mathcal{E}\\rightarrow \\mathcal{F}')
('1.0.6.1', 'f:\\mathcal{E}\n\\rightarrow \\mathbb{R}')
('1.0.7', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}')
('1.0.7', '\\partial f({\\bm w})[{\\bm v}]')
('1.0.7', '{\\bm w}\\in \\mathbb{R}^P')
('1.0.7', '{\\bm v}\\in \\mathbb{R}^P')
('1.0.7', '{\\bm w}=\n\\sum_{j=1}^P w_j {\\bm e}_j')
('1.0.7', '\\{{\\bm e}_1, \\dots, {\\bm e}_P\\}')
('1.0.7', '{\\bm v}')
('1.0.7', '\\nabla f({\\bm w}) \\in \\mathbb{R}^P')
('1.0.7', '{\\bm w}')
('1.0.7', 'f \\colon\n\\mathbb{R}^P \\to \\mathbb{R}^M')
('1.0.7', '\\bm \\partial f({\\bm w}) \\in \\mathbb{R}^{M \\times P}')
('1.0.7', '\\bm \\partial')
('1.0.7', 'f \\colon \\mathcal{E}\\to \\mathbb{R}')
('1.0.7', '\\nabla f({\\bm w}) \\in \\mathcal{E}')
('1.0.7', 'f\n\\colon \\mathcal{E}\\to \\mathcal{F}')
('1.0.7', '\\partial f({\\bm w})')
('1.0.7', '\\partial')
('1.0.7', '{\\bm w}\\in \\mathcal{E}')
('1.0.7', 'l[{\\bm v}] = \\partial f({\\bm w})[{\\bm v}]')
('1.0.7', '\\partial f({\\bm w}) \\colon \\mathcal{E}\\to \\mathcal{F}')
('1.0.7', '{\\bm w}\\in \\mathcal{E}')
('1.0.7', '{\\bm v}\\in \\mathcal{E}')
('1.0.7', '\\partial f({\\bm w})^* \\colon \\mathcal{F}\\to \\mathcal{E}')
('1.0.7', 'l[{\\bm u}] = \\partial f({\\bm w})^*[{\\bm u}]')
('1.0.7', '{\\bm w}\\in \\mathcal{E}')
('1.0.7', '{\\bm u}\\in \\mathcal{F}')
('1.0.7', '\\ell')
('1.0.7', 'f')
('1.0.7', '\\nabla (\\ell \\circ f)({\\bm w}) = \\partial f({\\bm w})^* \\nabla \\ell(f({\\bm w}))')
('1.0.7', 'f({\\bm w})')
('1.0.7', '\\mathbb{R}^P')
('1.0.7', '\\mathbb{R}')
('1.0.7', '\\nabla^2 f({\\bm w}) \\in \\mathbb{R}^{P \\times P}')
('1.0.7', '\\nabla f({\\bm w})')
('1.1.0.0', '\\mathcal{Y}')
('1.1.0.0', 'p \\colon \\mathcal{Y}\\to [0,1]')
('1.1.0.0', '{\\bm y}\\in \\mathcal{Y}')
('1.1.0.0', '\\mathbb{P}(Y = {\\bm y}) \\coloneqq p({\\bm y}),')
('1.1.0.0', 'Y')
('1.1.0.0', 'Y')
('1.1.0.0', 'p')
('1.1.0.0', 'Y \\sim p')
('1.1.0.0', 'p')
('1.1.0.0', '\\phi(Y)')
('1.1.0.0', 'Y \\sim p')
('1.1.0.0', '\\phi \\colon \\mathcal{Y}\\to \\mathbb{R}^M')
('1.1.0.0', '\\mathbb{E}[\\phi(Y)] = \\sum_{{\\bm y}\\in \\mathcal{Y}} p({\\bm y}) \\phi({\\bm y}),')
('1.1.0.0', '\\mathbb{V}[\\phi(Y)] \n= \\mathbb{E}[(\\phi(Y) - \\mathbb{E}[\\phi(Y)])^2] \n= \\sum_{y \\in \\mathcal{Y}} p(y) (\\phi(y) - \\mathbb{E}[\\phi(Y)])^2')
('1.1.0.0', '\\mathop{\\mathrm{arg\\,max}}_{{\\bm y}\\in \\mathcal{Y}} p({\\bm y}).')
('1.1.0.0', '\\mathcal{Y}')
('1.1.0.0', 'p')
('1.1.0.0', 'q')
('1.1.0.0', '\\mathrm{KL}(p, q)\n\\coloneqq \\sum_{y \\in \\mathcal{Y}} p(y) \\log\\left(\\frac{p(y)}{q(y)}\\right)\n= \\mathbb{E}_{Y \\sim p} \\log\\left(\\frac{p(Y)}{q(Y)}\\right).')
('1.1.0.1', '\\mathcal{Y}')
('1.1.0.1', 'p \\colon \\mathcal{Y}\\to \\mathbb{R}_+')
('1.1.0.1', '\\mathcal{A}\\subseteq \\mathcal{Y}')
('1.1.0.1', '\\mathbb{P}(Y \\in \\mathcal{A}) = \\int_\\mathcal{A}p(y) dy.')
('1.1.0.1', '\\sum_{{\\bm y}\\in \\mathcal{Y}}')
('1.1.0.1', '\\int_{\\mathcal{Y}}')
('1.1.0.1', '\\phi(Y)')
('1.1.0.1', '\\mathbb{E}[\\phi(Y)] = \\int_{\\mathcal{Y}} p(y) \\phi(y) dy,')
('1.1.0.1', '\\mathbb{V}[\\phi(Y)] \n= \\mathbb{E}[(\\phi(Y) - \\mathbb{E}[\\phi(Y)])^2] \n= \\int_{\\mathcal{Y}} p(y) (\\phi(y) - \\mathbb{E}[\\phi(Y)])^2 dy')
('1.1.0.1', '\\mathrm{KL}(p, q)\n\\coloneqq \\int_\\mathcal{Y}p(y) \\log\\left(\\frac{p(y)}{q(y)}\\right) dy\n= \\mathbb{E}_{Y \\sim p} \\log\\left(\\frac{p(Y)}{q(Y)}\\right).')
('1.1.0.1', '\\mathcal{Y}= \\mathbb{R}')
('1.1.0.1', '\\mathbb{P}(Y \\le b) = \\int_{-\\infty}^b p(y) dy.')
('1.1.0.1', 'Y')
('1.1.0.1', '(a, b]')
('1.1.0.1', '\\mathbb{P}(a < Y \\le b) = \\mathbb{P}(Y \\le b) - \\mathbb{P}(Y \\le a).')
('1.1.1.0', '\\mathcal{Y}')
('1.1.1.0', 'p({\\bm y})')
('1.1.1.0', 'p')
('1.1.1.0', 'p_{\\bm \\lambda}')
('1.1.1.0', '{\\bm \\lambda}\\in \\Lambda')
('1.1.1.0', '{\\bm y}_1, \\dots, {\\bm y}_N')
('1.1.1.0', '{\\bm \\lambda}\\in \\Lambda')
('1.1.1.0', '\\widehat {\\bm \\lambda}_N \\coloneqq\n\\mathop{\\mathrm{arg\\,max}}_{{\\bm \\lambda}\\in \\Lambda} \\prod_{i=1}^N p_{{\\bm \\lambda}}({\\bm y}_i).')
('1.1.1.0', '\\log')
('1.1.1.0', '\\widehat {\\bm \\lambda}_N\n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm \\lambda}\\in \\Lambda} -\\sum_{i=1}^N \\log p_{{\\bm \\lambda}}({\\bm y}_i).')
('1.1.1.0', 'p_{\\bm \\lambda}')
('1.1.1.0', '{\\bm \\lambda}= (\\mu, \\sigma)')
('1.1.1.0', 'p_{\\bm \\lambda}(y) \\coloneqq \\frac{1}{\\sigma \\sqrt{2 \\pi}} \n\\exp\\left(-\\frac{1}{2} \\left(\\frac{y - \\mu}{\\sigma}\\right)^2\\right).')
('1.1.1.0', 'y_1, \\dots, y_N')
('1.1.1.0', '\\mu')
('1.1.1.0', '\\sigma^2')
('1.1.1.1', 'p')
('1.1.1.1', '{\\bm \\lambda}_\\infty \\coloneqq \n\\mathop{\\mathrm{arg\\,min}}_{{\\bm \\lambda}\\in \\Lambda} \\mathrm{KL}(p, p_{\\bm \\lambda})\n= \\mathbb{E}_{Y \\sim p} \\log\\left(\\frac{p(Y)}{p_{\\bm \\lambda}(Y)}\\right),')
('1.1.1.1', '\\widehat {\\bm \\lambda}_N \\to {\\bm \\lambda}_\\infty')
('1.1.1.1', 'N \\to \\infty')
('1.1.1.1', '\\mathrm{KL}(p, p_{\\bm \\lambda})\n\\approx\n\\frac{1}{N} \\sum_{i=1}^N \\log\\left(\\frac{p({\\bm y}_i)}{p_{\\bm \\lambda}({\\bm y}_i)}\\right)\n=\n\\frac{1}{N} \\sum_{i=1}^N \\log p({\\bm y}_i) - \\log p_{\\bm \\lambda}({\\bm y}_i)')
('1.1.2.0', '\\mathbb{P}(Y = {\\bm y})')
('1.1.2.0', '{\\bm y}\\in \\mathcal{Y}')
('1.1.2.0', '\\mathbb{P}(Y = {\\bm y}| X = {\\bm x})')
('1.1.2.0', '{\\bm x}\\in \\mathcal{X}')
('1.1.2.0', '\\mathbb{P}(Y = {\\bm y}| X = {\\bm x}) \\coloneqq p_{\\bm \\lambda}({\\bm y})')
('1.1.2.0', '{\\bm \\lambda}\\coloneqq f({\\bm x}, {\\bm w})')
('1.1.2.0', 'f')
('1.1.2.0', '{\\bm w}\\in \\mathcal{W}')
('1.1.2.0', '\\mathcal{X}')
('1.1.2.0', '\\mathcal{Y}')
('1.1.2.0', 'f')
('1.1.2.0', '\\mathcal{X}')
('1.1.2.0', '\\Lambda')
('1.1.2.0', '{\\bm \\lambda}')
('1.1.2.0', '\\lambda = \\pi')
('1.1.2.0', '{\\bm \\lambda}= (\\mu, \\sigma)')
('1.1.2.0', 'p_{\\bm \\theta}')
('1.1.2.0', 'p_{\\bm \\lambda}')
('1.1.2.0', '{\\bm \\theta}')
('1.1.2.1', '\\mathcal{X}')
('1.1.2.1', '\\mathcal{Y}')
('1.1.2.1', '\\mathcal{Y}')
('1.1.2.1', '\\mathbb{P}(Y = {\\bm y}| X = {\\bm x})')
('1.1.2.1', '\\mathbb{P}(Y \\in \\mathcal{A}| X={\\bm x})')
('1.1.2.1', '\\mathbb{E}[\\phi(Y)|X={\\bm x}]')
('1.1.2.1', '\\phi')
('1.1.2.1', '\\mathbb{V}[\\phi(Y)|X={\\bm x}]')
('1.1.2.1', '\\mathop{\\mathrm{arg\\,max}}_{{\\bm y}\\in \\mathcal{Y}} p_{\\bm \\lambda}({\\bm y})')
('1.1.2.1', '{\\bm x}')
('1.1.2.2', '\\mathcal{Y}= \\{0,1\\}')
('1.1.2.2', '\\lambda \\coloneqq \\pi \\in [0,1].')
('1.1.2.2', 'Y')
('1.1.2.2', '\\pi')
('1.1.2.2', 'Y \\sim \\mathrm{Bernoulli}(\\pi).')
('1.1.2.2', 'p_\\pi(y) \\coloneqq\n\\begin{cases}\n\\pi &\\mbox{if } y = 1 \\\\\n1 - \\pi &\\mbox{if } y = 0\n\\end{cases}.')
('1.1.2.2', 'y \\in \\{0, 1\\}')
('1.1.2.2', 'p_\\pi(y) = \\pi^y (1-\\pi)^{1 -y}.')
('1.1.2.2', '\\mathbb{E}[Y] = \\pi = \\mathbb{P}(Y = 1)')
('1.1.2.2', '\\mathbb{V}[Y] = \\pi (1-\\pi) = \\mathbb{P}(Y=1)\\mathbb{P}(Y=0).')
('1.1.2.2.0', '\\pi')
('1.1.2.2.0', '[0,1]')
('1.1.2.2.0', '\\pi \\coloneqq f({\\bm x}, {\\bm w}) \\coloneqq \\mathrm{logistic}(g({\\bm x}, {\\bm w})),')
('1.1.2.2.0', 'g \\colon \\mathcal{X}\\times \\mathcal{W}\\to \\mathbb{R}')
('1.1.2.2.0', '\\mathrm{logistic}(a) \\coloneqq \\frac{1}{1 + \\exp(-a)} \\in (0,1).')
('1.1.2.2.0', 'g')
('1.1.2.2.0', '{\\bm w}')
('1.1.2.2.0', '\\mu')
('1.1.2.2.0', '\\sigma')
('1.1.2.2.0', 'p_{\\mu,\\sigma}(u) \\coloneqq p_{0,1}\\left(\\frac{u - \\mu}{\\sigma}\\right)')
('1.1.2.2.0', 'p_{0,1}(z) \\coloneqq \\frac{\\exp(-z)}{(1 + \\exp(-z))^2}.')
('1.1.2.2.0', 'U')
('1.1.2.2.0', '\\mu')
('1.1.2.2.0', '\\sigma')
('1.1.2.2.0', 'U \\sim \\mathrm{Logistic}(\\mu, \\sigma)')
('1.1.2.2.0', 'U \\sim \\mathrm{Logistic}(\\mu, \\sigma)')
('1.1.2.2.0', '\\mathbb{P}(U \\le u) \n= \\int_{-\\infty}^u p_{\\mu,\\sigma}(u) du\n= \\mathrm{logistic}\\left(\\frac{u - \\mu}{\\sigma}\\right).')
('1.1.2.2.0', 'U \\sim \\mathrm{Logistic}(\\mu, \\sigma)')
('1.1.2.2.0', 'Y \\sim \\mathrm{Bernoulli}\\left(\\mathrm{logistic}\\left(\\frac{u -\n    \\mu}{\\sigma}\\right)\\right),')
('1.1.2.2.0', '\\mathbb{P}(Y = 1)  = \\mathbb{P}(U \\le u).')
('1.1.2.2.0', 'U')
('1.1.2.2.0', 'u')
('1.1.2.3', 'M')
('1.1.2.3', '\\mathcal{Y}= [M]')
('1.1.2.3', '{\\bm \\lambda}\\coloneqq {\\bm \\pi}\\in \\triangle^M,')
('1.1.2.3', '\\triangle^M \n\\coloneqq \\{{\\bm \\pi}\\in \\mathbb{R}_+^M \\colon \\langle {\\bm \\pi}, \\operatorname{\\mathbf 1}\\rangle = 1 \\},')
('1.1.2.3', 'Y')
('1.1.2.3', '{\\bm \\pi}')
('1.1.2.3', 'Y \\sim \\mathrm{Categorical}({\\bm \\pi}).')
('1.1.2.3', 'p_{\\bm \\pi}(y) \\coloneqq \\langle {\\bm \\pi}, \\phi(y) \\rangle = \\pi_y,')
('1.1.2.3', '\\phi(y) \\coloneqq {\\bm e}_y')
('1.1.2.3', 'y \\in [M]')
('1.1.2.3', 'Y')
('1.1.2.3', 'Y')
('1.1.2.3', '\\phi(Y) = {\\bm e}_Y')
('1.1.2.3', '\\mathbb{E}_{Y \\sim p_{\\bm \\pi}}[\\phi(Y)] = {\\bm \\pi}.')
('1.1.2.3', '{\\bm \\pi}')
('1.1.2.3.0', '{\\bm \\pi}')
('1.1.2.3.0', '\\triangle^M')
('1.1.2.3.0', '{\\bm \\pi}\\coloneqq f({\\bm x}, {\\bm w}) \\coloneqq \n\\mathrm{softargmax}(g({\\bm x}, {\\bm w})),')
('1.1.2.3.0', 'g \\colon \\mathcal{X}\\times \\mathcal{W}\\to \\mathbb{R}^M')
('1.1.2.3.0', '\\mathrm{softargmax}({\\bm u}) \\coloneqq \\frac{\\exp({\\bm u})}{\\sum_j \\exp(u_j)}\n\\in \\mathrm{relint}(\\triangle^M).')
('1.1.2.3.0', '\\triangle^M')
('1.1.2.3.0', '\\mathrm{relint}(\\triangle^M) = \\triangle^M \\cap \\mathbb{R}^M_{>0}')
('1.1.2.3.0', 'g')
('1.1.2.3.0', '{\\bm w}')
('1.1.2.4', '\\mathcal{Y}= \\mathbb{R}')
('1.1.2.4', '{\\bm \\lambda}\\coloneqq (\\mu, \\sigma),')
('1.1.2.4', '\\mu \\in \\mathbb{R}')
('1.1.2.4', '\\sigma \\in \\mathbb{R}_+')
('1.1.2.4', 'p_{\\mu,\\sigma}(y) \\coloneqq \n\\frac{1}{\\sigma \\sqrt{2\\pi} }\n\\exp\\left(-\\frac{1}{2}\\frac{(y-\\mu)^2}{\\sigma^2}\\right).')
('1.1.2.4', '\\mathbb{E}_{Y \\sim p_{\\mu,\\sigma}}[Y] = \\mu.')
('1.1.2.4', '\\mathbb{P}(Y \\le y) = \\frac{1}{2}\\left[\n    1 + \\mathrm{erf}\\left(\\frac{y - \\mu}{\\sigma \\sqrt{2}}\\right)\n\\right],\n\\label{proba_learn:eq:normal_cdf}')
('1.1.2.4', '\\operatorname{erf}(z) \n\\coloneqq \\frac{2}{\\sqrt\\pi}\\int_0^z e^{-t^2}\\,\\mathrm dt.')
('1.1.2.4', '\\mathbb{P}(a < Y \\le b)\n=\n\\frac{1}{2} \\left[\n    \\mathrm{erf}\\left(\\frac{b - \\mu}{\\sigma \\sqrt{2}}\\right)\n    - \\mathrm{erf}\\left(\\frac{a - \\mu}{\\sigma \\sqrt{2}}\\right)\n\\right].')
('1.1.2.4.0', '\\sigma')
('1.1.2.4.0', '1')
('1.1.2.4.0', '\\mu')
('1.1.2.4.0', '\\mu \\coloneqq f({\\bm x}, {\\bm w}) \\in \\mathbb{R},')
('1.1.2.4.0', 'f \\colon \\mathcal{X}\\times \\mathcal{W}\\to \\mathbb{R}')
('1.1.2.4.0', 'f')
('1.1.2.4.0', '\\mathbb{E}_{Y \\sim p_{\\mu,1}}[Y] = \\mu = f({\\bm x}, {\\bm w}).')
('1.1.2.4.0', '\\mu')
('1.1.2.4.0', '\\mathbb{P}(Y \\le y)')
('1.1.2.4.0', '\\mathbb{P}(a < Y \\le b)')
('1.1.2.5', '\\mathcal{Y}= \\mathbb{R}^M')
('1.1.2.5', '{\\bm \\lambda}\\coloneqq ({\\bm \\mu}, {\\bm \\Sigma}),')
('1.1.2.5', '{\\bm \\mu}\\in \\mathbb{R}^M')
('1.1.2.5', '{\\bm \\Sigma}\\in \\mathbb{R}^{M \\times M}')
('1.1.2.5', 'p_{{\\bm \\mu},{\\bm \\Sigma}}({\\bm y}) \\coloneqq \n\\frac{1}{\\sqrt{2 \\pi^M |{\\bm \\Sigma}|}}\n\\exp\\left(-\\frac{1}{2} \\langle {\\bm y}- {\\bm \\mu}, \n{\\bm \\Sigma}^{-1} ({\\bm y}- {\\bm \\mu}) \\rangle\\right).')
('1.1.2.5', 'M')
('1.1.2.5', 'Y_j')
('1.1.2.5', 'j \\in [M]')
('1.1.2.5', '\\mathbb{E}_{Y \\sim p_{{\\bm \\mu},{\\bm \\Sigma}}}[Y] = {\\bm \\mu}.')
('1.1.2.5.0', '{\\bm \\mu}')
('1.1.2.5.0', '{\\bm \\mu}\\coloneqq f({\\bm x}, {\\bm w}) \\in \\mathbb{R}^M.')
('1.1.2.5.0', 'f')
('1.1.2.5.0', '{\\bm \\mu}')
('1.1.2.5.0', '{\\bm \\Sigma}')
('1.1.2.5.0', '({\\bm \\mu}, {\\bm \\Sigma}) \\coloneqq f({\\bm x}, {\\bm w}) \\in \\mathbb{R}^M \\times \\mathbb{R}^{M \\times M}.')
('1.1.2.5.0', 'f')
('1.1.2.5.0', '{\\bm \\Sigma}')
('1.1.2.5.0', '{\\bm \\Sigma}= {\\bm S}{\\bm S}^\\top')
('1.1.2.5.0', '{\\bm S}')
('1.1.2.6', '\\mathcal{Y}= \\mathbb{N}')
('1.1.2.6', '\\lambda > 0')
('1.1.2.6', '\\mathbb{P}(Y = y) =\np_\\lambda(y) \\coloneqq \\frac{\\lambda^y \\exp(-\\lambda)}{y!}.')
('1.1.2.6', '\\mathbb{P}(Y \\le y) = \\sum_{i=0}^y \\mathbb{P}(Y = y).')
('1.1.2.6', '1')
('1.1.2.6', '\\mathbb{E}[Y] = \\mathbb{V}[Y] = \\lambda.')
('1.1.2.6.0', '\\lambda')
('1.1.2.6.0', '\\lambda \\coloneqq f({\\bm x}, {\\bm w}) \\coloneqq \\exp(g({\\bm x}, {\\bm w})) > 0,')
('1.1.2.6.0', 'g \\colon \\mathcal{X}\\times \\mathcal{W}\\to \\mathbb{R}')
('1.1.2.7', '{\\bm w}\\in \\mathcal{W}')
('1.1.2.7', 'f')
('1.1.2.7', '({\\bm x}_1, {\\bm y}_1), \\dots, ({\\bm x}_N, {\\bm y}_N)')
('1.1.2.7', '\\widehat {\\bm w}_N \\coloneqq\n\\mathop{\\mathrm{arg\\,max}}_{{\\bm w}\\in \\mathcal{W}} \\prod_{i=1}^N p_{{\\bm \\lambda}_i}({\\bm y}_i),')
('1.1.2.7', '{\\bm \\lambda}_i \\coloneqq f({\\bm x}_i, {\\bm w}).')
('1.1.2.7', '\\widehat {\\bm w}_N\n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} -\\sum_{i=1}^N \\log p_{{\\bm \\lambda}_i}({\\bm y}_i).')
('1.1.2.7', '\\lambda_i = \\pi_i = \\mathrm{logistic}(g({\\bm x}_i, {\\bm w}))')
('1.1.2.7', '-\\log p_{\\lambda_i}(y_i) = \n-\\left[y_i \\log \\pi_i + (1-y_i) \\log (1-\\pi_i)\\right],')
('1.1.2.7', '{\\bm \\lambda}_i = {\\bm \\pi}_i = \\mathrm{softargmax}(g({\\bm x}_i, {\\bm w}))')
('1.1.2.7', '\\begin{aligned}\n-\\log p_{{\\bm \\lambda}_i}(y_i) \n&= \\log \\sum_{j=1}^M \\exp(\\pi_{i,j}) - \\pi_{i,y_i} \\\\\n&= \\mathrm{logsumexp}({\\bm \\pi}_i) - \\langle {\\bm \\pi}_i, {\\bm e}_{y_i} \\rangle,\n\\end{aligned}')
('1.1.2.7', '\\lambda_i = \\mu_i = f({\\bm x}_i, {\\bm w})')
('1.1.2.7', '\\sigma_i^2')
('1.1.2.7', '-\\log p_{\\lambda_i}(y_i) = \n\\frac{1}{\\sigma_i^2} (y_i - \\mu_i)^2\n+\\frac{1}{2} \\log \\sigma_i^2 + \\frac{1}{2} \\log(2\\pi),')
('1.1.2.7', '\\lambda_i = \\exp(\\theta_i)')
('1.1.2.7', '\\theta_i \\coloneqq g({\\bm x}_i, {\\bm w})')
('1.1.2.7', '\\begin{aligned}\n-\\log p_{\\lambda_i}(y_i) \n&= -y_i \\log(\\lambda_i) + \\lambda_i + \\log(y_i!) \\\\\n&= -y_i \\theta_i + \\exp(\\theta_i) + \\log(y_i!)\n\\end{aligned}')
('1.1.2.7', '\\lambda_i')
('1.1.2.7', '\\theta_i')
('1.1.2.7', 'y_i \\ge 0')
('1.1.3.0', '\\begin{aligned}\np_{\\bm \\theta}({\\bm y}) \n&= \\frac{h({\\bm y}) \\exp\\left[\\langle {\\bm \\theta}, \\phi({\\bm y})\n\\rangle\\right]}{\\exp(A({\\bm \\theta}))} \\\\\n&= h({\\bm y}) \\exp\\left[\\langle {\\bm \\theta}, \\phi({\\bm y}) \\rangle - \nA({\\bm \\theta})\\right],\n\\end{aligned}')
('1.1.3.0', '{\\bm \\theta}')
('1.1.3.0', 'h')
('1.1.3.0', '\\phi')
('1.1.3.0', '{\\bm y}')
('1.1.3.0', '{\\bm y}')
('1.1.3.0', 'A')
('1.1.3.0', 'p_{\\bm \\lambda}')
('1.1.3.0', 'p_{\\bm \\theta}')
('1.1.3.0', '{\\bm \\theta}')
('1.1.3.0', '{\\bm \\lambda}')
('1.1.3.0', '\\lambda = \\pi')
('1.1.3.0', '\\begin{aligned}\np_\\lambda(y)\n&\\coloneqq \\pi^y (1-\\pi)^{1-y} \\\\\n&= \\exp(\\log(\\pi^y (1-\\pi)^{1-y})) \\\\\n&= \\exp(y \\log(\\pi) + (1-y) \\log(1-\\pi)) \\\\\n&= \\exp(\\log(\\pi/(1-\\pi)) y + \\log(1 - \\pi)) \\\\\n&= \\exp(\\theta y - \\log(1 + \\exp(\\theta))) \\\\\n&= \\exp(\\theta y - \\mathrm{softplus}(\\theta)) \\\\\n&\\eqqcolon p_\\theta(y).\n\\end{aligned}')
('1.1.3.0', '\\theta = \\mathrm{logit}(\\pi) \\coloneqq\n\\log(\\pi/(1+\\pi))')
('1.1.3.0', '\\mathcal{Y}')
('1.1.3.0', '\\{0,1\\}')
('1.1.3.0', '[M]')
('1.1.3.0', '{\\bm \\lambda}')
('1.1.3.0', '\\pi = \\mathrm{logistic}(\\theta)')
('1.1.3.0', '{\\bm \\pi}= \\mathrm{softmax}({\\bm \\theta})')
('1.1.3.0', '{\\bm \\theta}')
('1.1.3.0', '\\mathrm{logit}(\\pi)')
('1.1.3.0', '\\log {\\bm \\pi}+ \\exp(A({\\bm \\theta}))')
('1.1.3.0', '\\phi(y)')
('1.1.3.0', 'y')
('1.1.3.0', '{\\bm e}_y')
('1.1.3.0', 'A({\\bm \\theta})')
('1.1.3.0', '\\mathrm{softplus}(\\theta)')
('1.1.3.0', '\\mathrm{logsumexp}({\\bm \\theta})')
('1.1.3.0', 'h(y)')
('1.1.3.0', '\\mathcal{Y}')
('1.1.3.0', '\\mathbb{R}')
('1.1.3.0', '\\mathbb{R}')
('1.1.3.0', '{\\bm \\lambda}')
('1.1.3.0', '\\mu = \\theta \\sigma')
('1.1.3.0', '(\\mu, \\sigma^2) = (\\frac{-\\theta_1}{2\\theta_2}, \\frac{-1}{2\\theta_2})')
('1.1.3.0', '{\\bm \\theta}')
('1.1.3.0', '\\frac{\\mu}{\\sigma}')
('1.1.3.0', '(\\frac{\\mu}{\\sigma^2}, \\frac{-1}{2\\sigma^2})')
('1.1.3.0', '\\phi(y)')
('1.1.3.0', '\\frac{y}{\\sigma}')
('1.1.3.0', '(y, y^2)')
('1.1.3.0', 'A({\\bm \\theta})')
('1.1.3.0', '\\frac{\\theta^2}{2} = \\frac{\\mu^2}{2\\sigma^2}')
('1.1.3.0', '\\frac{-\\theta_1^2}{4\\theta_2} - \\frac{1}{2}\n        \\log(-2\\theta_2) = \\frac{\\mu^2}{\\sigma^2} + \\log \\sigma')
('1.1.3.0', 'h(y)')
('1.1.3.0', '\\frac{\\exp(\\frac{-y^2}{2\\sigma^2})}{\\sqrt{2\\pi}\\sigma}')
('1.1.3.0', '\\frac{1}{\\sqrt{2\\pi}}')
('1.1.3.0', '\\mathcal{Y}')
('1.1.3.0', '\\mathbb{R}^M')
('1.1.3.0', '\\mathbb{N}')
('1.1.3.0', '{\\bm \\lambda}')
('1.1.3.0', '({\\bm \\mu}, {\\bm \\Sigma}) = (-\\frac{1}{2} {\\bm \\theta}_2^{-1} {\\bm \\theta}_1, -\\frac{1}{2}\n{\\bm \\theta}_2^{-1})')
('1.1.3.0', '\\lambda = \\exp(\\theta)')
('1.1.3.0', '{\\bm \\theta}')
('1.1.3.0', '({\\bm \\Sigma}^{-1} {\\bm \\mu}, -\\frac{1}{2} {\\bm \\Sigma}^{-1})')
('1.1.3.0', '\\log \\lambda')
('1.1.3.0', '\\phi({\\bm y})')
('1.1.3.0', '({\\bm y}, {\\bm y}{\\bm y}^\\top)')
('1.1.3.0', 'y')
('1.1.3.0', 'A({\\bm \\theta})')
('1.1.3.0', '-\\frac{1}{4} {\\bm \\theta}_1^\\top {\\bm \\theta}_2^{-1} - \\frac{1}{2} \\log |-2{\\bm \\theta}_2|')
('1.1.3.0', '\\exp(\\theta)')
('1.1.3.0', '= \\frac{1}{2} {\\bm \\mu}^\\top {\\bm \\Sigma}^{-1} {\\bm \\mu}+ \\frac{1}{2} \\log |{\\bm \\Sigma}|')
('1.1.3.0', 'h(y)')
('1.1.3.0', '(2\\pi)^{-M/2}')
('1.1.3.0', '1/y!')
('1.1.3.1', 'A')
('1.1.3.1', 'A({\\bm \\theta}) \n\\coloneqq\n\\log \\sum_{{\\bm y}\\in \\mathcal{Y}} h({\\bm y}) \\exp\\left[\\langle {\\bm \\theta}, \\phi({\\bm y})\n\\rangle\\right]')
('1.1.3.1', 'A({\\bm \\theta}) \n\\coloneqq\n\\log \\int_{\\mathcal{Y}} h(y) \\exp\\left[\\langle {\\bm \\theta}, \\phi(y) \\rangle\\right] dy')
('1.1.3.1', '\\Theta \\coloneqq \\{ {\\bm \\theta}\\in \\mathbb{R}^M \\colon A({\\bm \\theta}) < +\\infty\\} \\subseteq\n\\mathbb{R}^M.')
('1.1.3.1', 'A({\\bm \\theta})')
('1.1.3.1', 'A({\\bm \\theta}) = \\mathrm{logsumexp}(B({\\bm \\theta})) \n\\coloneqq \\log \\sum_{{\\bm y}\\in \\mathcal{Y}} [B({\\bm \\theta})]_{\\bm y},')
('1.1.3.1', 'B({\\bm \\theta}) \n\\coloneqq (\\langle {\\bm \\theta}, \\phi({\\bm y}) \\rangle + \\log h({\\bm y}))_{{\\bm y}\\in \\mathcal{Y}}.')
('1.1.3.1', 'A({\\bm \\theta})')
('1.1.3.1', '\\mathrm{logsumexp}')
('1.1.3.1', 'B')
('1.1.3.1', 'A({\\bm \\theta})')
('1.1.3.1', '\\phi(Y)')
('1.1.3.1', 'p_{\\bm \\theta}')
('1.1.3.1', '\\begin{aligned}\n{\\bm \\mu}({\\bm \\theta}) \\coloneqq \n\\nabla A({\\bm \\theta})\n= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\\phi(Y)] \\in \\mathcal{M}.\n\\end{aligned}')
('1.1.3.1', '\\nabla A({\\bm \\theta})\n= \\partial B({\\bm \\theta})^* \\nabla \\mathrm{logsumexp}(B({\\bm \\theta}))\n= (\\phi({\\bm y}))_{{\\bm y}\\in \\mathcal{Y}} ~ \\mathrm{softmax}(B({\\bm \\theta})).')
('1.1.3.1', '\\nabla A({\\bm \\theta})')
('1.1.3.1', '{\\bm \\mu}({\\bm \\theta})')
('1.1.3.1', '\\mathcal{M}\n\\coloneqq \\mathrm{conv}(\\phi(\\mathcal{Y}))\n\\coloneqq \\{ \\mathbb{E}_{p}[\\phi(Y)] \\colon p \\in \\mathcal{P}(\\mathcal{Y})\\},')
('1.1.3.1', '\\mathrm{conv}(\\mathcal{S})')
('1.1.3.1', '\\mathcal{S}')
('1.1.3.1', '\\mathcal{P}(\\mathcal{Y})')
('1.1.3.1', '\\mathcal{Y}')
('1.1.3.1', '\\nabla^2 A({\\bm \\theta})')
('1.1.3.1', '\\phi(Y)')
('1.1.3.1', 'p_{\\bm \\theta}')
('1.1.3.1', '{\\bm \\theta}')
('1.1.3.1', '\\nabla A')
('1.1.3.1', '\\Theta')
('1.1.3.1', '\\mathcal{M}')
('1.1.3.1', '{\\bm \\mu}({\\bm \\theta}) = \\nabla A({\\bm \\theta})')
('1.1.3.1', '{\\bm \\theta}= (\\nabla A)^{-1}({\\bm \\mu}({\\bm \\theta}))')
('1.1.3.2', '\\widehat {\\bm \\mu}= \\frac{1}{N}\n\\sum_{i=1}^n \\phi({\\bm y}_i) \\in \\mathcal{M}')
('1.1.3.2', '{\\bm y}_1,\\dots,{\\bm y}_N')
('1.1.3.2', 'H(p) \\coloneqq -\\sum_{{\\bm y}\\in \\mathcal{Y}} p({\\bm y}) \\log p({\\bm y})')
('1.1.3.2', 'H(p) \\coloneqq -\\int_{\\mathcal{Y}} p(y) \\log p(y) dy')
('1.1.3.2', 'p')
('1.1.3.2', 'p^\\star \\coloneqq\n\\mathop{\\mathrm{arg\\,max}}_{p \\in \\mathcal{P}(\\mathcal{Y})} H(p)\n\\quad \\text{s.t.} \\quad\n\\mathbb{E}_{Y \\sim p}[\\phi(Y)] = \\widehat {\\bm \\mu}.')
('1.1.3.2', '\\phi')
('1.1.3.2', '{\\bm \\theta}')
('1.1.3.3', '{\\bm \\theta}\\in \\Theta')
('1.1.3.3', '{\\bm y}_1, \\dots, {\\bm y}_N')
('1.1.3.3', '\\widehat {\\bm \\theta}_N\n= \\mathop{\\mathrm{arg\\,max}}_{{\\bm \\theta}\\in \\Theta} \\prod_{i=1}^N p_{\\bm \\theta}({\\bm y}_i)\n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm \\theta}\\in \\Theta} -\\sum_{i=1}^N \\log p_{\\bm \\theta}({\\bm y}_i).')
('1.1.3.3', '-\\log p_{\\bm \\theta}({\\bm y})\n= A({\\bm \\theta}) - \\langle {\\bm \\theta}, \\phi({\\bm y}) \\rangle - \\log h({\\bm y}).')
('1.1.3.3', '-\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y})\n= \\nabla A({\\bm \\theta}) - \\phi({\\bm y})\n= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\\phi(Y)] - \\phi({\\bm y})')
('1.1.3.3', '-\\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y})\n= \\nabla^2 A({\\bm \\theta}),')
('1.1.3.3', '{\\bm y}')
('1.1.3.3', '{\\bm \\theta}\\mapsto -\\log p_{\\bm \\theta}({\\bm y})')
('1.1.3.3', '\\phi(Y)')
('1.1.3.3', '\\phi({\\bm y})')
('1.1.3.4', 'p_{\\bm w}({\\bm y}\\mid {\\bm x})')
('1.1.3.4', 'f')
('1.1.3.4', 'p_{\\bm w}({\\bm y}\\mid {\\bm x}) \\coloneqq p_{\\bm \\theta}({\\bm y})\n\\quad \\text{where} \\quad\n{\\bm \\theta}\\coloneqq f({\\bm x}, {\\bm w}).')
('1.1.3.4', 'f')
('1.1.3.4', 'p_{\\bm \\theta}')
('1.1.3.4', '{\\bm x}')
('1.1.3.4', '\\mathcal{X}\\times \\mathcal{W}')
('1.1.3.4', '\\Theta')
('1.1.3.4', 'f')
('1.1.3.4', '\\Theta \\coloneqq \\{ {\\bm \\theta}\\in \\mathbb{R}^M \\colon A({\\bm \\theta}) < +\\infty\\}.')
('1.1.3.4', '\\Theta')
('1.1.3.4', '\\mathbb{R}^M')
('1.1.3.4', '{\\bm \\theta}= ({\\bm \\mu}, {\\bm \\Sigma}) = f({\\bm x}, {\\bm w})')
('1.1.3.4', '{\\bm \\Sigma}')
('1.1.3.4.0', '\\{({\\bm x}_i, {\\bm y}_i)\\}_{i=1}^N')
('1.1.3.4.0', '{\\bm w}')
('1.1.3.4.0', 'f({\\bm x}, {\\bm w})')
('1.1.3.4.0', '\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}}\n-\\sum_{i=1}^N \\log {\\bm p}_{{\\bm \\theta}_i}({\\bm y}_i)\n=\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}}\n\\sum_{i=1}^N A({\\bm \\theta}_i) - \\langle {\\bm \\theta}_i, \\phi({\\bm y}_i) \\rangle')
('1.1.3.4.0', '{\\bm \\theta}_i \\coloneqq f({\\bm x}_i, {\\bm w})')
('1.1.3.4.0', '-\\log p_{\\bm \\theta}({\\bm y})')
('1.1.3.4.0', '{\\bm \\theta}')
('1.1.3.4.0', '-\\log p_{f({\\bm x},{\\bm w})}({\\bm y})')
('1.1.3.4.0', '{\\bm w}')
('1.1.3.4.0', 'f')
('1.1.3.4.1', '{\\bm w}')
('1.1.3.4.1', '{\\bm x}')
('1.1.3.4.1', '\\phi(Y)')
('1.1.3.4.1', '\\nabla A(f({\\bm x}, {\\bm w}))')
('1.1.3.4.1', '{\\bm x}')
('1.1.3.4.1', '{\\bm \\theta}= f({\\bm x}, {\\bm w})')
('1.1.3.4.1', '{\\bm \\mu}= \\nabla A({\\bm \\theta})')
('1.1.3.4.1', 'f')
('1.1.3.4.1', '{\\bm w}')
('1.1.3.4.1', '\\nabla A \\circ f')
('1.1.3.4.1', '{\\bm y}')
('1.1.3.4.1', '{\\bm x}')
('1.1.3.4.1', '{\\bm \\theta}= f({\\bm x},\n{\\bm w})')
('1.1.3.4.1', '\\mathbb{P}(Y = {\\bm y}| X = {\\bm x}) = p_{\\bm \\theta}({\\bm y})')
('1.1.3.4.1', '{\\bm \\mu}= {\\bm p}= \\nabla A({\\bm \\theta}) = \\mathrm{softargmax}({\\bm \\theta}) \\in \\triangle^M.')
('1.1.3.4.1', '{\\bm \\theta}')
('1.1.3.4.1', '{\\bm \\lambda}')
('1.1.4', '\\mathcal{X}')
('1.1.4', '\\mathcal{Y}')
('1.1.4', '\\mathcal{X}')
('1.1.4', '\\Lambda')
('2.0.0.0', 'f_1,\\dots,f_K')
('2.0.0.0', '{\\bm s}_0 \\in\n\\mathcal{S}_0')
('2.0.0.0', '\\begin{aligned}\n\t{\\bm s}_0 &\\in \\mathcal{S}_0\\nonumber \\\\\n\t{\\bm s}_1 &\\coloneqq f_1({\\bm s}_0) \\in \\mathcal{S}_1 \\nonumber\\\\ \n\t\t & \\hspace{6pt} \\vdots \\nonumber\\\\\n\t{\\bm s}_K &\\coloneqq f_K({\\bm s}_{K-1}) \\in \\mathcal{S}_K \\nonumber \\\\\n\tf({\\bm s}_0) &\\coloneqq {\\bm s}_K. \n  \\label{neural_nets:eq:chain}\n\\end{aligned}')
('2.0.0.0', '{\\bm s}_0')
('2.0.0.0', '{\\bm s}_k \\in \\mathcal{S}_k')
('2.0.0.0', '{\\bm s}_K \\in \\mathcal{S}_K')
('2.0.0.0', 'f_k')
('2.0.0.0', 'f_{k-1}')
('2.0.0.0', 'f_k \\colon \\mathcal{S}_{k-1} \\to \\mathcal{S}_k')
('2.0.0.0', '\\begin{aligned}\n  f({\\bm s}_0)\n  &= (f_K \\circ \\dots \\circ f_2 \\circ f_1)({\\bm s}_0) \\\\\n  &= f_K(\\dots f_2(f_1({\\bm s}_0))).\n\\end{aligned}')
('2.0.0.1', '\\mathcal{G}= (\\mathcal{V}, \\mathcal{E})')
('2.0.0.1', '\\mathcal{V}')
('2.0.0.1', '\\mathcal{E}')
('2.0.0.1', '(i,j) \\in \\mathcal{E}')
('2.0.0.1', 'i \\in \\mathcal{V}')
('2.0.0.1', 'j \\in \\mathcal{V}')
('2.0.0.1', 'i\n\\rightarrow j')
('2.0.0.1', 'j')
('2.0.0.1', 'i')
('2.0.0.1', '\\rightarrow j')
('2.0.0.1', 'i\n\\rightarrow')
('2.0.0.1', '\\mathcal{G}= (\\mathcal{V}, \\mathcal{E})')
('2.0.0.1', 'j')
('2.0.0.1', 'j')
('2.0.0.1', '{\\operatorname{pa}}(j) \\coloneqq \\{i: i \\rightarrow j\\}')
('2.0.0.1', 'i')
('2.0.0.1', 'i')
('2.0.0.1', '{\\operatorname{ch}}(i) \\coloneqq \\{j \\colon i \\rightarrow j\\}')
('2.0.0.1', 'i')
('2.0.0.1', 'j')
('2.0.0.1', 'j_1,\n\\ldots, j_m')
('2.0.0.1', 'i \\rightarrow j_1 \\rightarrow \\ldots\n\\rightarrow j_m \\rightarrow j')
('2.0.0.1', 'i')
('2.0.0.1', 'i')
('2.0.0.1', 'i')
('2.0.0.1', 'i \\preceq j')
('2.0.0.1', 'i')
('2.0.0.1', 'j')
('2.0.0.1', 'i \\leq j')
('2.0.0.1', 'j')
('2.0.0.1', 'i')
('2.0.0.1', '\\mathcal{V}= \\{0,\n  1, 2, 3, 4\\}')
('2.0.0.1', '\\mathcal{E}= \\{(0, 1), (0, 2), (0, 3), (1, 3), (2, 3),\n  (1, 4), (3, 4)\\}')
('2.0.0.1', '3')
('2.0.0.1', '{\\operatorname{pa}}(3) = \\{0, 1, 2\\}')
('2.0.0.1', '1')
('2.0.0.1', '{\\operatorname{ch}}(1) = \\{3, 4\\}')
('2.0.0.1', '0')
('2.0.0.1', '4')
('2.0.0.1', '0 \\rightarrow 3 \\rightarrow 4')
('2.0.0.1', '0')
('2.0.0.1', '4')
('2.0.0.1', '0')
('2.0.0.1', '3')
('2.0.0.1', '0 \\leq 3')
('2.0.0.1', '3')
('2.0.0.1', '0')
('2.0.0.1', '1')
('2.0.0.1', '2')
('2.0.0.1', '1 \\leq 2')
('2.0.0.1', '2')
('2.0.0.1', '1')
('2.0.0.1', '(0, 1, 2, 3, 4)')
('2.0.0.1', '(0, 2, 1, 3, 4)')
('2.0.0.2', '{\\bm s}_0 \\in \\mathcal{S}_0')
('2.0.0.2', '{\\bm s}_K \\in \\mathcal{S}_K')
('2.0.0.2', 'f_k')
('2.0.0.2', '{\\bm s}_k \\in \\mathcal{S}_k')
('2.0.0.2', '\\mathcal{V}\\coloneqq \\{0, 1, \\dots, K\\}')
('2.0.0.2', '0')
('2.0.0.2', '{\\bm s}_0 \\in \\mathcal{S}_0')
('2.0.0.2', 'K')
('2.0.0.2', '{\\bm s}_K \\in \\mathcal{S}_K')
('2.0.0.2', '{\\bm s}_0')
('2.0.0.2', '{\\bm s}_k')
('2.0.0.2', 'f_k')
('2.0.0.2', '0')
('2.0.0.2', '{\\bm s}_0')
('2.0.0.2', '1, \\dots, K')
('2.0.0.2', 'f_k')
('2.0.0.2', '{\\bm s}_k')
('2.0.0.2', 'f(x_1, x_2) = x_2e^{x_1}\\sqrt{x_1 + x_2 e^{x_1}}')
('2.0.0.2', 'f')
('2.0.0.2', '8')
('2.0.0.2', 'i_1, \\dots, i_{p_k} \\coloneqq\n{\\operatorname{pa}}(k)')
('2.0.0.2', 'k')
('2.0.0.2', 'p_k \\coloneqq |{\\operatorname{pa}}(k)|')
('2.0.0.2', '{\\bm s}_{\\operatorname{pa}}(k) \\coloneqq {\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}}')
('2.0.0.2', 'f_k')
('2.0.0.2', 'i_1, \\dots, i_{p_k}')
('2.0.0.2', 'f_{i_1}, \\ldots, f_{i_{p_k}}')
('2.0.0.2', 'f_k')
('2.0.0.2.0', '0, 1, \\dots, K')
('2.0.0.2.0', 'k \\in [K]')
('2.0.0.2.0', '\\begin{aligned}\n{\\bm s}_k \n\\coloneqq f_k({\\bm s}_{{\\operatorname{pa}}(k)})\n\\coloneqq f_k({\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}}) \\in \\mathcal{S}_k.\n\\end{aligned}')
('2.0.0.2.0', 'f_k')
('2.0.0.2.0', '{\\bm s}_{{\\operatorname{pa}}(k)}')
('2.0.0.2.0', '{\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}}')
('2.0.0.2.0', 'f_1, \\dots, f_K')
('2.0.0.2.0', '{\\bm s}_0 \\in \\mathcal{S}_0')
('2.0.0.2.0', 'i_1, \\dots, i_{p_k} \\coloneqq {\\operatorname{pa}}(k)')
('2.0.0.2.0', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{{\\operatorname{pa}}(k)}) \\coloneqq f_k({\\bm s}_{i_1}, \\ldots,\n{\\bm s}_{i_{p_k}})')
('2.0.0.2.0', 'f({\\bm s}_0) \\coloneqq {\\bm s}_K')
('2.0.0.2.1', '{\\bm s}_0 \\in \\mathcal{S}_0')
('2.0.0.2.1', '{\\bm s}_0 = ({\\bm s}_{0,1}, \\dots, {\\bm s}_{0,N_0})')
('2.0.0.2.1', '\\mathcal{S}_0 = (\\mathcal{S}_{0,1} \\times \\dots \\times \\mathcal{S}_{0,N_0})')
('2.0.0.2.1', '{\\bm s}_0')
('2.0.0.2.1', 'f_k')
('2.0.0.2.1', '{\\bm s}_k = ({\\bm s}_{k,1},\\dots,{\\bm s}_{k,N_k})')
('2.0.0.2.1', '\\mathcal{S}_k = (\\mathcal{S}_{k,1} \\times \\dots \\times \\mathcal{S}_{k,N_k})')
('2.0.0.2.1', '{\\bm s}_k')
('2.0.0.2.2', 'f_k')
('2.0.0.2.2', '{\\bm s}_k')
('2.0.0.2.2', 'k')
('2.0.0.2.2', '{\\bm s}_k')
('2.0.0.2.2', 'f_k')
('2.0.0.3', '\\mathbb{F}')
('2.0.0.3', '\\mathbb{R}')
('2.0.0.3', '\\mathbb{F}')
('2.0.0.3', 'f_k')
('2.0.0.3', '+')
('2.0.0.3', '\\times')
('2.0.0.3', 'f_k')
('2.0.0.3', '+')
('2.0.0.3', '\\times')
('2.0.0.3', '\\mathbb{F}')
('2.0.0.3', 'S(\\mathcal{C})')
('2.0.0.3', '\\mathcal{C}')
('2.0.0.3', '\\mathcal{C}')
('2.0.0.3', 'S(f)')
('2.0.0.3', 'f')
('2.0.0.3', 'S(\\mathcal{C})')
('2.0.0.3', '\\mathcal{C}')
('2.0.0.3', 'f')
('2.0.1', 'f_k')
('2.0.1', '\\begin{aligned}\n  {\\bm s}_0 &\\coloneqq {\\bm x}\\\\\n  {\\bm s}_1 &\\coloneqq f_1({\\bm s}_0, {\\bm w}_1) \\\\\n  {\\bm s}_2 &\\coloneqq f_2({\\bm s}_1, {\\bm w}_2) \\\\\n  &\\vdots \\\\\n  {\\bm s}_K &\\coloneqq f_K({\\bm s}_{K-1}, {\\bm w}_K),\n\\end{aligned}')
('2.0.1', '{\\bm x}\\in \\mathcal{X}')
('2.0.1', '{\\bm w}_1, \\ldots, {\\bm w}_K \\in \\mathcal{W}_1 \\times \\dots \\times \\mathcal{W}_K')
('2.0.1', 'f_k')
('2.0.1', '{\\bm s}_k \\in \\mathcal{S}_k')
('2.0.1', '{\\bm x}')
('2.0.1', '\\mathcal{S}_k')
('2.0.1', 'k')
('2.0.1', '{\\bm s}_K \\eqqcolon f({\\bm x}, {\\bm w})')
('2.0.1', '\\mathcal{X}\\times \\mathcal{W}')
('2.0.1', '\\mathcal{S}_K')
('2.0.1', '{\\bm w}\\coloneqq ({\\bm w}_1, \\dots, {\\bm w}_K) \\in \\mathcal{W}\\coloneqq \\mathcal{W}_1\n\\times \\ldots \\times \\mathcal{W}_K')
('2.0.1', '{\\bm w}')
('2.0.1', '({\\bm x}_i, {\\bm y}_i)')
('2.0.1', '\\|{\\bm y}_i - f({\\bm x}_i, {\\bm w})\\|_2^2')
('2.0.1', '{\\bm w}')
('2.0.1', '{\\bm w}')
('2.0.2.0', '{\\bm s}_k \n= f_k({\\bm s}_{k-1}, {\\bm w}_k) \n\\coloneqq a_k({\\bm W}_k {\\bm s}_{k-1} + {\\bm b}_k),')
('2.0.2.0', '{\\bm w}_k \\coloneqq ({\\bm W}_k, {\\bm b}_k)')
('2.0.2.0', '{\\bm W}_k')
('2.0.2.0', '{\\bm b}_k')
('2.0.2.0', '{\\bm s}\\mapsto {\\bm W}_k {\\bm s}+\n{\\bm b}_k')
('2.0.2.0', '{\\bm v}\\mapsto a_k({\\bm v})')
('2.0.2.0', '{\\bm W}_k {\\bm s}_{k-1}')
('2.0.2.0', '{\\bm s}_{k-1}')
('2.0.2.0', '{\\bm s}_{k-1}')
('2.0.2.0', 'W_k')
('2.0.2.0', 'g({\\bm x}_1, {\\bm x}_2, {\\bm w}_g)')
('2.0.2.0', '{\\bm x}_1 \\in \\mathcal{X}_1')
('2.0.2.0', '{\\bm x}_2 \\in \\mathcal{X}_2')
('2.0.2.0', '{\\bm x}\\coloneqq {\\bm x}_1 \\oplus {\\bm x}_2 \\in \\mathcal{X}_2 \\oplus \\mathcal{X}_2')
('2.0.2.0', 'f({\\bm x}, {\\bm w}_f)')
('2.0.2.0', '{\\bm x}_1')
('2.0.2.0', '{\\bm x}_2')
('2.0.2.1', 'K=1')
('2.0.2.1', '{\\bm s}_1 = a_1({\\bm W}_1 {\\bm x}+ {\\bm b}_1).')
('2.0.2.1', 'a_1')
('2.0.2.1', 'K')
('2.0.2.1', '{\\bm s}_K = a_K({\\bm W}_K {\\bm s}_{K-1} + {\\bm b}_K).')
('2.0.2.1', '{\\bm s}_{K-1}')
('2.0.2.1', '{\\bm x}')
('2.0.3', 'a_k')
('2.0.3.0', '\\mathrm{relu}(u) \n\\coloneqq \\max(u, 0) \n= \\begin{cases} \nu, & u \\ge 0 \\\\ \n0, & u < 0\n\\end{cases}.')
('2.0.3.0', 'u=0')
('2.0.3.0', '{\\bm s}_k = \\mathrm{relu}({\\bm A}_k {\\bm s}_{k-1} + {\\bm b}_k),')
('2.0.3.0', '\\mathrm{softplus}(u) \\coloneqq \\log(1 + e^u).')
('2.0.3.1.0', '{\\bm u}\\in \\mathbb{R}^M')
('2.0.3.1.0', '\\max({\\bm u}) \\coloneqq \\max_{j \\in [M]} u_j.')
('2.0.3.1.1', '\\mathrm{logsumexp}({\\bm u}) \\coloneqq \n\\mathrm{softmax}({\\bm u}) \\coloneqq \n\\log \\sum_{j=1}^M e^{u_j},')
('2.0.3.1.1', 'u \\in \\mathbb{R}')
('2.0.3.1.1', '\\mathrm{logsumexp}((u, 0)) = \\mathrm{softplus}(u).')
('2.0.3.1.1', '\\mathrm{logsumexp}({\\bm u}) = \\mathrm{logsumexp}({\\bm u}- c\\operatorname{\\mathbf 1}) + c,')
('2.0.3.1.1', 'c \\coloneqq \\max_{j \\in [M]} u_j')
('2.0.3.1.1', '\\gamma > 0')
('2.0.3.1.1', '\\mathrm{logsumexp}_\\gamma({\\bm u}) = \\gamma \\cdot \\mathrm{logsumexp}({\\bm u}/ \\gamma).')
('2.0.3.1.1', '{\\bm u}\\in \\mathbb{R}^M')
('2.0.3.1.1', '\\max({\\bm u}) \\le \\mathrm{logsumexp}_\\gamma({\\bm u}) \\le \\max({\\bm u}) + \\gamma \\cdot \\log(M).')
('2.0.3.1.1', '\\mathrm{logsumexp}_\\gamma({\\bm u}) \\to \\max({\\bm u})')
('2.0.3.1.1', '\\gamma \\to 0')
('2.0.3.1.2', 's \\coloneqq \\sum_{j=1}^M u_i')
('2.0.3.1.2', 'u_i > 0')
('2.0.3.1.2', '\\tilde{u}_i \\coloneqq \\log u_i')
('2.0.3.1.2', '\\tilde{s} \\coloneqq \\log s')
('2.0.3.1.2', '\\tilde{s} = \\log \\sum_{j=1}^M \\exp(\\tilde{u}_i).')
('2.0.3.1.2', '\\log\\left(\\sum_{i=1}^M u_i\\right) = \\mathrm{logsumexp}(\\log({\\bm u})).')
('2.0.3.1.2', '\\log\\left(\\prod_{j=1}^M u_i \\right) = \\sum_{i=1}^M \\log(u_i).')
('2.0.3.2', '[0,1]')
('2.0.3.2', '[0,1]')
('2.0.3.2.0', '\\mathrm{step}(u) \\coloneqq\n\\begin{cases} \n1, & u \\ge 0 \\\\ \n0, & u < 0\n\\end{cases}.')
('2.0.3.2.0', '\\mathbb{R}')
('2.0.3.2.0', '\\{0, 1\\}')
('2.0.3.2.0', 'u=0')
('2.0.3.2.1', '\\mathbb{R}')
('2.0.3.2.1', '(0, 1)')
('2.0.3.2.1', '\\begin{aligned}\n\\mathrm{logistic}(u) \n&\\coloneqq \\frac{1}{1 + e^{-u}}  \\\\\n&= \\frac{e^u}{1 + e^u} \\\\\n&= \\frac{1}{2} + \\frac{1}{2} \\tanh\\left(\\frac{u}{2}\\right).\n\\end{aligned}')
('2.0.3.2.1', '(-\\infty, 0)')
('2.0.3.2.1', '(0, 0.5)')
('2.0.3.2.1', '[0, +\\infty)')
('2.0.3.2.1', '[0.5, 1)')
('2.0.3.2.1', '\\mathrm{logistic}(0) = 0.5')
('2.0.3.2.1', '\\mathrm{step}(u)')
('2.0.3.2.1', 'u \\in \\mathbb{R}')
('2.0.3.2.1', "\\mathrm{softplus}'(u) = \\mathrm{logistic}(u).")
('2.0.3.2.1', 'u \\in \\mathbb{R}')
('2.0.3.2.1', '\\mathrm{logistic}(-u) = 1 - \\mathrm{logistic}(u)')
('2.0.3.2.1', "\\begin{aligned}\n\\mathrm{logistic}'(u) \n&= \\mathrm{logistic}(u) \\cdot \\mathrm{logistic}(-u) \\\\\n&= \\mathrm{logistic}(u) \\cdot (1 - \\mathrm{logistic}(u)).\n\\end{aligned}")
('2.0.3.3', '\\mathbb{R}^M')
('2.0.3.3', '\\triangle^M \\coloneqq \n\\left\\{{\\bm \\pi}\\in \\mathbb{R}^M \\colon  \\forall j \\in [M],\\ \\pi_j \\geq 0,\\\n\\sum_{j=1}^M \\pi_j= 1\\right\\}.')
('2.0.3.3.0', '\\mathrm{argmax}({\\bm u}) \\coloneqq \\phi\\left(\\mathop{\\mathrm{arg\\,max}}_{j \\in [M]} u_j\\right),')
('2.0.3.3.0', '\\phi(j)')
('2.0.3.3.0', 'j \\in\n[M]')
('2.0.3.3.0', '\\phi(j) \n\\coloneqq (0, \\ldots, 0, \\underbrace{1}_j, 0, \\ldots, 0) \n= {\\bm e}_j \\in \\{0,1\\}^M.')
('2.0.3.3.1', '\\mathrm{softargmax}({\\bm u}) \\coloneqq \\frac{\\exp({\\bm u})}{\\sum_{j=1}^M \\exp(u_j)}.')
('2.0.3.3.1', '{\\bm \\pi}=\n\\mathrm{softargmax}({\\bm u})')
('2.0.3.3.1', '\\pi_j \\in (0,1)')
('2.0.3.3.1', '\\pi_j')
('2.0.3.3.1', '0')
('2.0.3.3.1', '1')
('2.0.3.3.1', '\\mathrm{softargmax}')
('2.0.3.3.1', '\\nabla \\mathrm{logsumexp}({\\bm u}) = \\mathrm{softargmax}({\\bm u}).')
('2.0.3.3.1', '\\mathrm{softargmax}')
('2.0.3.3.1', 'u \\in \\mathbb{R}')
('2.0.3.3.1', '_1 = \\mathrm{logistic}(u).')
('2.0.3.3.1', '{\\bm u}\\in \\mathbb{R}^M')
('2.0.3.3.1', 'c \\in \\mathbb{R}')
('2.0.3.3.1', '{\\bm \\pi}\\coloneqq \\mathrm{softargmax}({\\bm u}) = \\mathrm{softargmax}({\\bm u}+ c \\operatorname{\\mathbf 1}).')
('2.0.3.3.1', 'M-1')
('2.0.3.3.1', '{\\bm u}^\\top \\operatorname{\\mathbf 1}= \\sum_{i=1}^M u_i = 0')
('2.0.3.3.1', 'u_i \\leftarrow u_i - \\bar{u}')
('2.0.3.3.1', '\\bar{u} \\coloneqq \\frac{1}{M} \\sum_{j=1}^M u_j')
('2.0.3.3.1', '\\log \\pi_i = u_i - \\log \\sum_{j=1}^M \\exp(u_j),')
('2.0.3.3.1', '\\sum_{i=1}^M \\log \\pi_i = - M \\log \\sum_{j=1}^M \\exp(u_j)')
('2.0.3.3.1', 'u_i =\n[\\mathrm{softargmax}^{-1}({\\bm \\pi})]_i = \n\\log \\pi_i - \\frac{1}{M} \\sum_{j=1}^M \\log \\pi_j.')
('2.0.4', 'K+1')
('2.0.4', 'f_1')
('2.0.4', '\\dots')
('2.0.4', 'f_K')
('2.0.4', 'f_{K+1}')
('2.0.4', 'f_{K+1}')
('2.0.4', 'f_1')
('2.0.4', '\\dots')
('2.0.4', 'f_K')
('2.0.4', 'f_k')
('2.0.4', 'f_k')
('2.0.4', '{\\bm s}_k \n= f_k({\\bm s}_{k-1}, {\\bm w}_k) \n\\coloneqq {\\bm s}_{k-1} + h_k({\\bm s}_{k-1}, {\\bm w}_k).')
('2.0.4', 'h_k')
('2.0.4', '{\\bm s}_k - {\\bm s}_{k-1}')
('2.0.4', '{\\bm s}_{k-1}')
('2.0.4', '{\\bm w}_k')
('2.0.4', 'h_k({\\bm s}_{k-1}, {\\bm w}_k) = {\\mathbf{0}}')
('2.0.4', 'f_k')
('2.0.4', 'h_k({\\bm s}_{k-1}, {\\bm w}_k) \n\\coloneqq {\\bm C}_k a_k({\\bm W}_k {\\bm s}_{k-1} + {\\bm b}_k) + {\\bm d}_k,')
('2.0.4', '{\\bm w}_k \\coloneqq ({\\bm W}_k, {\\bm b}_k, {\\bm C}_k, {\\bm d}_k)')
('2.0.4', '{\\bm C}_k')
('2.0.4', '{\\bm d}_k')
('2.0.4', '{\\bm s}_k \n= f_k({\\bm s}_{k-1}, {\\bm w}_k) \n\\coloneqq a_k({\\bm s}_{k-1} + h_k({\\bm s}_{k-1}, {\\bm w}_k)),')
('2.0.4', 'a_k')
('2.0.5', 'f^d \\colon \\mathbb{R}^D \\times \\mathbb{R}^P \\to \\mathbb{R}^{L \\times M}')
('2.0.5', 'f^e \\colon \\mathbb{R}^{L \\times D} \\times \\mathbb{R}^P \\to \\mathbb{R}^M')
('2.0.5', 'f^a \\colon \\mathbb{R}^{L \\times D} \\times \\mathbb{R}^P \\to \\mathbb{R}^{L \\times M}')
('2.0.5', "f^u \\colon \\mathbb{R}^{L \\times D} \\times \\mathbb{R}^P \\to \\mathbb{R}^{L' \\times M}")
('2.0.5', 'L')
('2.0.5', 'P')
('2.0.5', '{\\bm p}_{1:L} \\coloneqq ({\\bm p}_1, \\dots, {\\bm p}_L)')
('2.0.5', 'L')
('2.0.5.0', '{\\bm p}_{1:L} = f^d({\\bm x},\n{\\bm w})')
('2.0.5.0', '{\\bm x}\\in \\mathbb{R}^D')
('2.0.5.0', '{\\bm w}\\in \\mathbb{R}^P')
('2.0.5.0', '{\\bm p}_{1:L} \\in \\mathbb{R}^{L \\times M}')
('2.0.5.0', '{\\bm p}_{1:L}\n\\coloneqq f^d({\\bm x}, {\\bm w})')
('2.0.5.0', '\\begin{aligned}\n    {\\bm z}_l &\\coloneqq g({\\bm x}, {\\bm z}_{l-1}, {\\bm w}_g) \\quad l \\in [L] \\\\\n    {\\bm p}_l &\\coloneqq h({\\bm z}_l, {\\bm w}_h) \\quad l \\in [L].\n\\end{aligned}')
('2.0.5.0', '{\\bm w}\\coloneqq ({\\bm w}_g, {\\bm w}_h, {\\bm z}_0)')
('2.0.5.0', 'g')
('2.0.5.0', '{\\bm z}_l')
('2.0.5.0', '{\\bm x}')
('2.0.5.0', '{\\bm z}_{l-1}')
('2.0.5.0', 'h')
('2.0.5.0', '{\\bm p}_l')
('2.0.5.0', '{\\bm z}_l')
('2.0.5.0', 'g')
('2.0.5.0', 'h')
('2.0.5.0', 'g')
('2.0.5.0', 'h')
('2.0.5.0', 'g')
('2.0.5.1', '{\\bm p}= f^e({\\bm x}_{1:L},\n{\\bm w})')
('2.0.5.1', '{\\bm x}_{1:L} \\in \\mathbb{R}^{L \\times D}')
('2.0.5.1', '{\\bm w}\n\\in \\mathbb{R}^P')
('2.0.5.1', '{\\bm p}\\in \\mathbb{R}^M')
('2.0.5.1', '{\\bm p}\n\\coloneqq f^e({\\bm x}_{1:L}, {\\bm w})')
('2.0.5.1', '\\begin{aligned}\n{\\bm s}_l &\\coloneqq \\gamma({\\bm x}_l, {\\bm s}_{l-1}, {\\bm w}_g) \\quad l \\in [L] \\\\\n{\\bm p}&= \\mathrm{pooling}({\\bm s}_{1:L})\n\\end{aligned}')
('2.0.5.1', '{\\bm w}\\coloneqq ({\\bm w}_g, {\\bm s}_0)')
('2.0.5.1', '\\gamma')
('2.0.5.1', 'g')
('2.0.5.2', '{\\bm p}_{1:L} = f^a({\\bm x}_{1:L}, {\\bm w})')
('2.0.5.2', '{\\bm x}_{1:L} \\in \\mathbb{R}^{L \\times D}')
('2.0.5.2', '{\\bm w}\\in \\mathbb{R}^P')
('2.0.5.2', '{\\bm p}_{1:L} \\in \\mathbb{R}^{L \\times M}')
('2.0.5.2', '{\\bm x}_l')
('2.0.5.2', '{\\bm p}_{1:L} = f^a({\\bm x}_{1:L}, {\\bm w})')
('2.0.5.2', '\\begin{aligned}\n{\\bm s}_l &\\coloneqq \\gamma({\\bm x}_l, {\\bm s}_{l-1}, {\\bm w}_\\gamma) \\quad l \\in [L] \\\\\n{\\bm p}_l &= h({\\bm s}_l, {\\bm w}_h) \\quad l \\in [L] \\\\\n\\end{aligned}')
('2.0.5.2', '{\\bm w}\\coloneqq ({\\bm w}_\\gamma, {\\bm w}_h, {\\bm s}_0)')
('2.0.5.2', '\\gamma')
('2.0.5.2', 'h')
('2.0.5.3', "{\\bm p}_{1:L'} = f^u({\\bm x}_{1:L}, {\\bm w})")
('2.0.5.3', '{\\bm x}_{1:L} \\in \\mathbb{R}^{L \\times D}')
('2.0.5.3', '{\\bm w}\\in \\mathbb{R}^P')
('2.0.5.3', "{\\bm p}_{1:L'} \\in \\mathbb{R}^{L' \\times M}")
('2.0.5.3', "{\\bm p}_{1:L'} = f^u({\\bm x}_{1:L}, {\\bm w})")
('2.0.5.3', "\\begin{aligned}\n{\\bm c}&\\coloneqq f^e({\\bm x}_{1:L}, {\\bm w}_e) \\\\\n{\\bm p}_{1:L'} &\\coloneqq f^d({\\bm c}, {\\bm w}_d)\n\\end{aligned}")
('2.0.5.3', '{\\bm w}\\coloneqq ({\\bm w}_e, {\\bm w}_d)')
('2.0.5.3', 'f_e')
('2.0.5.3', 'f_d')
('2.0.5.3', "\\begin{aligned}\n{\\bm s}_l &\\coloneqq \\gamma({\\bm x}_l, {\\bm s}_{l-1}, {\\bm w}_\\gamma) \\quad l \\in [L] \\\\\n{\\bm c}&= \\mathrm{pooling}({\\bm s}_{1:L}) \\\\\n{\\bm z}_l &\\coloneqq g({\\bm c}, {\\bm p}_{l-1}, {\\bm z}_{l-1}, {\\bm w}_g) \\quad l \\in [L'] \\\\\n{\\bm p}_l &\\coloneqq h({\\bm z}_l, {\\bm w}_h) \\quad l \\in [L'].\n\\end{aligned}")
('2.0.5.3', "L'")
('2.0.5.3', 'D')
('2.0.5.3', '{\\bm c}')
('2.1.0', '\\pi = \\mathrm{op}(u_1, u_2)')
('2.1.0', 'u_1 \\in \\mathbb{R}')
('2.1.0', 'u_2 \\in \\mathbb{R}')
('2.1.0', '\\pi \\in \\{0,1\\}')
('2.1.0', '\\pi')
('2.1.0', '\\begin{aligned}\n\\mathrm{gt}(u_1, u_2)\n&\\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } u_1 \\ge u_2 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n&= \\mathrm{step}(u_1 - u_2)\n        \n\\end{aligned}')
('2.1.0', '\\begin{aligned}\n\\mathrm{lt}(u_1, u_2)\n&\\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } u_1 \\le u_2 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n&= 1 - \\mathrm{gt}(u_1, u_2) \\\\\n&= \\mathrm{step}(u_2 - u_1)\n        \n\\end{aligned}')
('2.1.0', '\\begin{aligned}\n\\mathrm{eq}(u_1, u_2)\n&\\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } |u_1 - u_2| = 0 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n&= \\mathrm{gt}(u_2, u_1) \\cdot \\mathrm{gt}(u_1, u_2) \\\\\n&= \\mathrm{step}(u_2 - u_1) \\cdot \\mathrm{step}(u_1 - u_2) \\\\\n\\end{aligned}')
('2.1.0', '\\begin{aligned}\n\\mathrm{neq}(u_1, u_2)\n&\\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } |u_1 - u_2| > 0 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n&= 1 - \\mathrm{eq}(u_1, u_2) \\\\\n&= 1 - \\mathrm{step}(u_2 - u_2) \\cdot \\mathrm{step}(u_1 - u_2),\n        \n\\end{aligned}')
('2.1.0', '\\mathrm{step} \\colon \\mathbb{R}\\to \\{0,1\\}')
('2.1.0', '\\mathrm{step}(u)\n\\coloneqq \\begin{cases}\n    1 &\\mbox{ if } u \\ge 0 \\\\\n    0 &\\mbox{ otherwise}\n\\end{cases}.')
('2.1.0', 'u=0')
('2.1.0', 'u \\neq 0')
('2.1.0', '\\mathrm{step}')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma')
('2.1.1.0', '\\sigma > 0')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma(-u) = 1 - \\mathrm{sigmoid}_\\sigma(u)')
('2.1.1.0', '\\lim_{u \\to \\infty} \\mathrm{sigmoid}_\\sigma(u) = 1')
('2.1.1.0', '\\lim_{u \\to -\\infty} \\mathrm{sigmoid}_\\sigma(u) = 0')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma(0) = \\frac{1}{2}')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma(u) \n\\coloneqq \\mathrm{logistic}_\\sigma(u) \\coloneqq \\frac{1}{1+ e^{-u/\\sigma}} \\in (0, 1)')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma(u) \\coloneqq \\Phi(u/\\sigma).')
('2.1.1.0', '\\begin{aligned}\n\\mathrm{gt}(\\mu_1, \\mu_2) \n&= \\mathrm{step}(\\mu_1 - \\mu_2) \\\\\n&\\approx \\mathrm{sigmoid}_\\sigma(\\mu_1 - \\mu_2) \\\\\n&\\eqqcolon \\mathrm{gt}_\\sigma(\\mu_1, \\mu_2)\n\\end{aligned}')
('2.1.1.0', '\\begin{aligned}\n\\mathrm{lt}(\\mu_1, \\mu_2) \n&= \\mathrm{step}(\\mu_2-\\mu_1) \\\\\n&\\approx \\mathrm{sigmoid}_\\sigma(\\mu_2 - \\mu_1) \\\\\n&\\eqqcolon \\mathrm{lt}_\\sigma(\\mu_1, \\mu_2) \\\\\n&= 1 - \\mathrm{sigmoid}_\\sigma(\\mu_1 - \\mu_2) \\\\\n&= 1 - \\mathrm{gt}_\\sigma(\\mu_1 - \\mu_2).\n\\end{aligned}')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma(\\mu_1 - \\mu_2) \\to 1')
('2.1.1.0', '\\mu_1 -\n\\mu_2 \\to \\infty')
('2.1.1.0', '\\mathrm{sigmoid}_\\sigma')
('2.1.1.0', '1')
('2.1.1.0', '\\mu_1')
('2.1.1.0', '\\mu_2')
('2.1.1.0', '\\tau')
('2.1.1.0', '\\mu_1 - \\mu_2 \\ge \\tau \\Longrightarrow \\mathrm{sigmoid}_\\sigma(\\mu_1 - \\mu_2) = 1')
('2.1.1.1', '\\mathrm{gt}_\\sigma(\\mu_1,\\mu_2)')
('2.1.1.1', '\\mathrm{lt}_\\sigma(\\mu_1,\\mu_2)')
('2.1.1.1', '\\mu_1 \\in \\mathbb{R}')
('2.1.1.1', '\\mu_2 \\in \\mathbb{R}')
('2.1.1.1', 'U_1 \\sim p_{\\mu_1,\\sigma_1}\n\\quad \\text{and} \\quad\nU_2 \\sim p_{\\mu_2,\\sigma_2},')
('2.1.1.1', '\\sigma_1')
('2.1.1.1', '\\sigma_2')
('2.1.1.1', '(U_1, U_2)\\sim p_{\\mu_1,\\sigma_1}\\otimes p_{\\mu_2,\\sigma_2},')
('2.1.1.1', 'p_1')
('2.1.1.1', 'p_2')
('2.1.1.1', 'p_1 \\otimes p_2')
('2.1.1.1', '(p_1 \\otimes p_2)(u_1, u_2) \\coloneqq p_1(u_1)p_2(u_2)')
('2.1.1.1', '\\begin{aligned}\n\\mathrm{gt}_\\sigma(\\mu_1, \\mu_2) \n&= \\mathbb{E}\\left[\\mathrm{gt}(U_1, U_2)\\right] \\\\\n&= \\mathbb{E}\\left[\\mathrm{step}(U_1 - U_2)\\right] \\\\\n&= \\mathbb{P}(U_1 - U_2 > 0) \\\\\n&= 1 - \\mathbb{P}(U_1 - U_2 \\le 0) \\\\\n&= 1 - F_{U_1 - U_2}(0),\n\\end{aligned}')
('2.1.1.1', 'F_X')
('2.1.1.1', 'X')
('2.1.1.1', '\\sigma')
('2.1.1.1', '\\sigma_1')
('2.1.1.1', '\\sigma_2')
('2.1.1.1', '\\begin{aligned}\n\\mathrm{lt}_\\sigma(\\mu_1, \\mu_2) \n&= \\mathbb{E}\\left[\\mathrm{lt}(U_1, U_2)\\right] \\\\\n&= \\mathbb{E}\\left[\\mathrm{step}(U_2 - U_1)\\right] \\\\\n&= \\mathbb{P}(U_1 - U_2 \\le 0) \\\\\n&= F_{U_1 - U_2}(0).\n\\end{aligned}')
('2.1.1.1', 'U_1')
('2.1.1.1', 'U_2')
('2.1.1.1', 'Z_1 \\sim p_{0,1}')
('2.1.1.1', 'Z_2 \\sim p_{0,1}')
('2.1.1.1', 'U_1 = \\mu_1 + \\sigma_1 Z_1')
('2.1.1.1', 'U_2 = \\mu_2 + \\sigma_2 Z_2')
('2.1.1.1', '\\begin{aligned}\n\\mathrm{gt}_\\sigma(\\mu_1, \\mu_2) \n&= \\mathbb{E}\\left[\\mathrm{gt}(\\mu_1 + \\sigma_1 Z_1, \\mu_2 + \\sigma_2 Z_2)\\right] \\\\\n\\mathrm{lt}_\\sigma(\\mu_1, \\mu_2) \n&= \\mathbb{E}\\left[\\mathrm{lt}(\\mu_1 + \\sigma_1 Z_1, \\mu_2 + \\sigma_2 Z_2)\\right].\n\\end{aligned}')
('2.1.1.1.0', 'U_1 \\sim \\mathrm{Normal}(\\mu_1, \\sigma_1^2)')
('2.1.1.1.0', 'U_2 \\sim \\mathrm{Normal}(\\mu_2, \\sigma_2^2)')
('2.1.1.1.0', '\\label{cf:eq:diff_normal}\nU_1 - U_2 \\sim \\mathrm{Normal}(\\mu_1 - \\mu_2, \\sigma_1^2 + \\sigma_2^2).')
('2.1.1.1.0', '\\Phi')
('2.1.1.1.0', '\\begin{aligned}\n\\mathrm{gt}_\\sigma(\\mu_1, \\mu_2) \n&= \\Phi\\left(\\frac{\\mu_1-\\mu_2}{\\sigma}\\right) \\\\\n\\mathrm{lt}_\\sigma(\\mu_1, \\mu_2) \n&= \\Phi\\left(\\frac{\\mu_2-\\mu_1}{\\sigma}\\right),\n\\end{aligned}')
('2.1.1.1.0', '\\sigma \\coloneqq \\sqrt{\\sigma_1^2 + \\sigma_2^2}')
('2.1.1.1.0', 'Z_1')
('2.1.1.1.0', 'Z_2')
('2.1.1.1.1', 'U_1 \\sim \\mathrm{Gumbel}(\\mu_1, \\sigma)')
('2.1.1.1.1', 'U_2 \\sim \\mathrm{Gumbel}(\\mu_2, \\sigma)')
('2.1.1.1.1', '\\label{cf:eq:diff_logistic}\nU_1 - U_2 \\sim \\mathrm{Logistic}(\\mu_1 - \\mu_2, \\sigma).')
('2.1.1.1.1', '\\begin{aligned}\n\\mathrm{gt}_\\sigma(\\mu_1, \\mu_2) \n&= \\mathrm{logistic}\\left(\\frac{\\mu_1-\\mu_2}{\\sigma}\\right) \\\\\n\\mathrm{lt}_\\sigma(\\mu_1, \\mu_2) \n&= \\mathrm{logistic}\\left(\\frac{\\mu_2-\\mu_1}{\\sigma}\\right).\n\\end{aligned}')
('2.1.1.1.1', 'Z_1')
('2.1.1.1.1', 'Z_2')
('2.1.1.1.2', '\\mathrm{gt}(\\mu_1, \\mu_2) = \\mathbb{E}\\left[\\mathrm{gt}(U_1, U_2)\\right],')
('2.1.1.1.2', 'U_i \\sim \\delta_{\\mu_i}')
('2.1.1.1.2', '\\delta_{\\mu_i}')
('2.1.1.1.2', '1')
('2.1.1.1.2', '\\mu_i')
('2.1.2.0', '\\mathrm{eq}(\\mu_1,\\mu_2)')
('2.1.2.0', '0')
('2.1.2.0', '1')
('2.1.2.0', '\\mu_1 = \\mu_2')
('2.1.2.0', '\\mu_1')
('2.1.2.0', '\\mu_2')
('2.1.2.0', 'k(\\mu_1, \\mu_2)')
('2.1.2.0', 'k(\\mu_1, \\mu_2) \\coloneqq \\langle \\phi(\\mu_1), \\phi(\\mu_2) \\rangle')
('2.1.2.0', '\\phi(\\mu_1)')
('2.1.2.0', '\\phi(\\mu_2)')
('2.1.2.0', '\\mu_1')
('2.1.2.0', '\\mu_2')
('2.1.2.0', '\\mathcal{H}')
('2.1.2.0', '0')
('2.1.2.0', '1')
('2.1.2.0', '\\begin{aligned}\n  \\mathrm{eq}(\\mu_1, \\mu_2) \n  & \\approx \\frac{k(\\mu_1,\\mu_2)}\n  {\\sqrt{k(\\mu_1,\\mu_1)k(\\mu_2,\\mu_2)}} \\nonumber\\\\\n  & = \\frac{\\langle \\phi(\\mu_1), \\phi(\\mu_2) \\rangle}\n  {\\|\\phi(\\mu_1)\\|\\|\\phi(\\mu_2)\\|},\n\\end{aligned}')
('2.1.2.0', '\\|\\phi(\\mu)\\| \\coloneqq \\sqrt{\\langle \\phi(\\mu), \\phi(\\mu)\\rangle} =\n\\sqrt{\\kappa(\\mu, \\mu)}')
('2.1.2.0', '\\phi(\\mu_1)')
('2.1.2.0', '\\phi(\\mu_2)')
('2.1.2.0', 'k(\\mu_1, \\mu_2) \\coloneqq \\kappa(\\mu_1 - \\mu_2),')
('2.1.2.0', '\\sigma > 0')
('2.1.2.0', '\\kappa_\\sigma')
('2.1.2.0', '\\begin{aligned}\n\\mathrm{eq}(\\mu_1, \\mu_2) \n\\approx \n\\mathrm{eq}_\\sigma(\\mu_1, \\mu_2) \n\\coloneqq\n\\frac{\\kappa_\\sigma(\\mu_1 - \\mu_2)}{\\kappa_\\sigma(0)}.\n\\end{aligned}')
('2.1.2.0', '\\kappa_\\sigma(t) \\coloneqq \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)')
('2.1.2.0', '\\kappa_\\sigma(t) \n\\coloneqq \\mathrm{sech}^2\\left(\\frac{t}{2\\sigma}\\right),')
('2.1.2.0', '\\mathrm{sech}(u) \\coloneqq 2 / (\\exp(u) + \\exp(-u)).')
('2.1.2.0', '\\mu_1=\\mu_2')
('2.1.2.1', 'U_1 \\sim p_{\\mu_1,\\sigma_1}\n\\quad \\text{and} \\quad\nU_2 \\sim p_{\\mu_2,\\sigma_2}')
('2.1.2.1', '\\mu_1 \\in \\mathbb{R}')
('2.1.2.1', '\\mu_2 \\in \\mathbb{R}')
('2.1.2.1', '\\mathrm{eq}(U_1, U_2)')
('2.1.2.1', '\\mathbb{E}[\\mathrm{eq}(U_1, U_2)] \n= \\mathbb{P}(U_1=U_2)= 0,')
('2.1.2.1', 'U_1')
('2.1.2.1', 'U_2')
('2.1.2.1', 'U_1=U_2')
('2.1.2.1', 'U_1-U_2=0')
('2.1.2.1', 'f_{U_1-U_2}')
('2.1.2.1', 'U_1-U_2')
('2.1.2.1', '0')
('2.1.2.1', '0')
('2.1.2.1', '1')
('2.1.2.1', '\\mathrm{eq}_\\sigma(\\mu_1,\\mu_2) \n= \\frac{f_{U_1 - U_2}(0)}{f_{0}(0)}.')
('2.1.2.1', '\\begin{aligned}\nf_{U_1-U_2}(t)\n&= (f_{U_1} \\ast f_{-U_2})(t) \\\\\n&= \\int_{-\\infty}^\\infty f_{U_1}(\\tau) f_{-U_2}(t - \\tau) d\\tau.\n\\end{aligned}')
('2.1.2.1', 't=0')
('2.1.2.1', 'f_X')
('2.1.2.1', '\\begin{aligned}\nf_{U_1-U_2}(0)\n&= (f_{U_1} \\ast f_{-U_2})(0) \\\\\n&= \\int_{-\\infty}^\\infty f_{U_1}(\\tau) f_{-U_2}(-\\tau) d\\tau \\\\\n&= \\int_{-\\infty}^\\infty f_{U_1}(\\tau) f_{U_2}(\\tau) d\\tau \\\\\n&\\coloneqq \\langle f_{U_1}, f_{U_2} \\rangle \\\\\n&\\coloneqq k(\\mu_1,\\mu_2).\n\\end{aligned}')
('2.1.2.1.0', '\\mathbb{P}(U_1=U_2) = 0')
('2.1.2.1.0', '\\mathbb{P}(|U_1-U_2| \\le \\varepsilon) = F_{|U_1-U_2|}(\\varepsilon)')
('2.1.2.1.0', 'X')
('2.1.2.1.0', '\\begin{aligned}\nF_{|X|}(x)\n&= \\mathbb{P}(|X| \\le x) \\\\\n&= \\mathbb{P}(-x \\le X \\le x) \\\\\n&= \\mathbb{P}(X \\le x) - \\mathbb{P}(X \\le -x) \\\\\n&= F_X(x) -  F_X(-x).\n\\end{aligned}')
('2.1.2.1.0', '\\mathbb{P}(|U_1-U_2| \\le \\varepsilon)  \n= F_{U_1-U_2}(\\varepsilon) - F_{U_1-U_2}(\\varepsilon).')
('2.1.2.1.0', '|X|')
('2.1.2.1.0', "\\begin{aligned}\nf_{|X|}(x) \n&= F'_X(x) - F'_{X}(-x) \\\\\n&= f_X(x) + f_{X}(-x)\n\\end{aligned}")
('2.1.2.1.0', 'f_{|X|}(0) = 2 f_X(0).')
('2.1.2.1.0', 'f_{|U_1-U_2|}(0) = 2 f_{U_1-U_2}(0),')
('2.1.2.1.0', 'U_1 - U_2')
('2.1.2.1.0', '0')
('2.1.2.1.0', 'X')
('2.1.2.1.0', '|X|')
('2.1.2.1.1', 'U_1 \\sim \\mathrm{Normal}(\\mu_1, \\sigma_1^2)')
('2.1.2.1.1', 'U_2 \\sim \\mathrm{Normal}(\\mu_2, \\sigma_2^2)')
('2.1.2.1.1', 'f_{U_1 - U_2}(t) \n= \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t - (\\mu_1 -\\mu_2))^2}{2(\\sigma_1^2 +\n\\sigma_2^2)}\\right)')
('2.1.2.1.1', '\\mathrm{\\mathrm{eq}}_\\sigma(\\mu_1,\\mu_2)\n= \n\\exp\\left(\\frac{(\\mu_1 -\\mu_2)^2}{2(\\sigma_1^2 + \\sigma_2^2)}\\right)\n\\in [0,1].')
('2.1.2.1.1', '\\kappa_\\sigma(\\mu_1 - \\mu_2) / \\kappa_\\sigma(0)')
('2.1.2.1.1', '\\kappa_\\sigma')
('2.1.2.1.1', '\\sigma = \\sqrt{\\sigma_1^2 +\n\\sigma_2^2}')
('2.1.2.1.1', '\\mathbb{P}(|U_1-U_2| \\le \\varepsilon)\n= \n\\Phi\\left(\\frac{\\varepsilon-(\\mu_1-\\mu_2)}{\\sigma}\\right)\n-\n\\Phi\\left(\\frac{-\\varepsilon-(\\mu_1-\\mu_2)}{\\sigma}\\right).')
('2.1.2.1.2', 'U_1 \\sim \\mathrm{Gumbel}(\\mu_1, \\sigma)')
('2.1.2.1.2', 'U_2 \\sim \\mathrm{Gumbel}(\\mu_2, \\sigma)')
('2.1.2.1.2', '\\mathrm{sech}(u) \\coloneqq 2 / (\\exp(u) + \\exp(-u)),')
('2.1.2.1.2', 'f_{U_1 - U_2}(t) \n= \\frac{1}{4\\sigma} \n\\mathrm{sech}^2\\left(\\frac{t - (\\mu_1 - \\mu_2)}{2 \\sigma}\\right)')
('2.1.2.1.2', '\\mathrm{\\mathrm{eq}}_\\sigma(\\mu_1,\\mu_2)\n= \\mathrm{sech}^2\\left(\\frac{\\mu_1 - \\mu_2}{2 \\sigma}\\right)\n\\in [0,1].')
('2.1.2.1.2', '\\kappa_\\sigma(\\mu_1 - \\mu_2) / \\kappa_\\sigma(0)')
('2.1.2.1.2', '\\kappa_\\sigma')
('2.1.2.1.2', '\\sigma = \\sigma_1 = \\sigma_2')
('2.1.2.2', '\\mu_1')
('2.1.2.2', '\\mu_2')
('2.1.2.2', 'U_1 \\sim p_{\\mu_1,\\sigma_1}')
('2.1.2.2', 'U_2 \\sim p_{\\mu_2,\\sigma_2}')
('2.1.2.2', '\\sigma_1')
('2.1.2.2', '\\sigma_2')
('2.1.2.2', '\\mu_1')
('2.1.2.2', '\\mu_2')
('2.1.2.2', 'U_1')
('2.1.2.2', 'U_2')
('2.1.2.2', '\\mu_1')
('2.1.2.2', '\\mu_2')
('2.1.2.2', '\\mathbb{R}')
('2.1.2.2', '\\{U_\\mu: \\mu\\in \\mathbb{R}\\}')
('2.1.2.2', '\\mu \\in \\mathbb{R}')
('2.1.2.2', 'K')
('2.1.2.2', '(U_{\\mu_1}, \\dots, U_{\\mu_K})')
('2.1.2.2', '(\\mu_1, \\ldots, \\mu_K) \\in \\mathbb{R}')
('2.1.2.2', '\\mu \\mapsto \\mathbb{E}[U_{\\mu}]')
('2.1.2.2', '(\\mu_i,\\mu_j) \\mapsto \\operatorname{Cov}(U_{\\mu_i}, U_{\\mu_j})')
('2.1.2.2', '\\mathbb{E}[U_{\\mu}]=\\mu')
('2.1.2.2', '\\operatorname{Cov}(U_{\\mu_i}, U_{\\mu_j}) \\coloneqq k(\\mu_1, \\mu_2),')
('2.1.2.2', 'k')
('2.1.2.2', '\\mathrm{corr}(U_{\\mu_i}, U_{\\mu_j}) \n  \\coloneqq \\frac{\\operatorname{Cov}(U_{\\mu_i}, U_{\\mu_j})}{\\sqrt{\\operatorname{Var}(U_{\\mu_i})\\operatorname{Var}(U_{\\mu_j})}}\n  \\in [0, 1].')
('2.1.2.2', '\\begin{aligned}\n\\mathrm{corr}(U_{\\mu_i}, U_{\\mu_j}) \n&= \\frac{k(\\mu_1,\\mu_2)}{\\sqrt{k(\\mu_1,\\mu_1)k(\\mu_2,\\mu_2)}} \\\\\n&= \\frac{\\langle \\phi(\\mu_1),\\phi(\\mu_2)\n\\rangle}{\\|\\phi(\\mu_1)\\|\\|\\phi(\\mu_2)\\|},\n\\end{aligned}')
('2.1.2.2', 'K=2')
('2.1.2.2', 'k_\\sigma(\\mu_1, \\mu_2) = \\kappa(\\mu_1 - \\mu_2)')
('2.1.2.2', '\\mathrm{eq}_\\sigma(\\mu_1, \\mu_2)\n  = \\mathrm{corr}(U_{\\mu_1}, U_{\\mu_2})\n  = \\frac{\\kappa(\\mu_1 -\\mu_2)}{\\kappa(0)}.')
('2.1.3', '\\{0,1\\} \\times \\{0,1\\}')
('2.1.3', '\\{0,1\\}')
('2.1.3', "\\begin{aligned}\n\\mathrm{and}(\\pi, \\pi')\n&\\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } \\pi = \\pi' = 1 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n\\mathrm{or}(\\pi, \\pi')\n&\\coloneqq\n\\begin{cases}\n    1 &\\mbox{ if } 1 \\in \\{\\pi, \\pi'\\} \\\\\n0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n\\mathrm{not}(\\pi)\n&\\coloneqq\n\\begin{cases}\n0 &\\mbox{ if } \\pi = 1 \\\\\n1 &\\mbox{ if } \\pi = 0\n\\end{cases}.\n\\end{aligned}")
('2.1.3', "\\begin{aligned}\n        \\mathrm{and}(\\pi, \\pi') = \\mathrm{and}(\\pi', \\pi) \\\\\n        \\mathrm{or}(\\pi, \\pi') = \\mathrm{and}(\\pi', \\pi)\n        \n\\end{aligned}")
('2.1.3', "\\begin{aligned}\n            \\mathrm{and}(\\pi, \\mathrm{and}(\\pi', \\pi'')) &=\n            \\mathrm{and}(\\mathrm{and}(\\pi, \\pi'), \\pi'') \\\\\n            \\mathrm{or}(\\pi, \\mathrm{or}(\\pi', \\pi'')) &=\n            \\mathrm{or}(\\mathrm{or}(\\pi, \\pi'), \\pi'')\n        \n\\end{aligned}")
('2.1.3', "\\mathrm{and}(\\pi, \\mathrm{or}(\\pi', \\pi''))\n        =\n        \\mathrm{or}(\\mathrm{and}(\\pi, \\pi'), \\mathrm{and}(\\pi, \\pi''))")
('2.1.3', '\\begin{aligned}\n        \\mathrm{and}(\\pi, 1) &= \\pi \\\\\n        \\mathrm{or}(\\pi, 0) &= \\pi \n    \n\\end{aligned}')
('2.1.3', "\\begin{aligned}\n        \\mathrm{not}(\\mathrm{or}(\\pi, \\pi'))\n        &=\n        \\mathrm{and}(\\mathrm{not}(\\pi), \\mathrm{not}(\\pi')) \\\\\n        \\mathrm{not}(\\mathrm{and}(\\pi, \\pi'))\n        &=\n        \\mathrm{or}(\\mathrm{not}(\\pi), \\mathrm{not}(\\pi')).\n    \n\\end{aligned}")
('2.1.3', '{\\bm \\pi}= (\\pi_1, \\dots, \\pi_K) \\in \\{0,1\\}^K')
('2.1.3', '\\textbf{all}')
('2.1.3', '\\forall')
('2.1.3', '\\textbf{any}')
('2.1.3', '\\exists')
('2.1.3', '\\{0,1\\}^K')
('2.1.3', '\\{0,1\\}')
('2.1.3', '\\mathrm{all}({\\bm \\pi}) \\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } \\pi_1 = \\dots = \\pi_K = 1 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases}')
('2.1.3', '\\mathrm{any}({\\bm \\pi}) \\coloneqq\n\\begin{cases}\n1 &\\mbox{ if } 1 \\in \\{\\pi_1, \\dots, \\pi_K\\} \\\\\n0 &\\mbox{ otherwise }\n\\end{cases}.')
('2.1.4.0', "\\begin{aligned}\n\\mathrm{and}(\\pi, \\pi') &= \\pi \\cdot \\pi' \\\\\n\\mathrm{or}(\\pi, \\pi') &= \\pi + \\pi' - \\pi \\cdot \\pi' \\\\\n\\mathrm{not}(\\pi) &= 1 - \\pi.\n\\end{aligned}")
('2.1.4.0', '[0, 1] \\times [0,1] \\to [0, 1]')
('2.1.4.0', "\\pi, \\pi' \\in [0,1]")
('2.1.4.0', '[0,1]^K')
('2.1.4.0', '[0,1]')
('2.1.4.0', '\\begin{aligned}\n    \\mathrm{all}({\\bm \\pi}) &= \\prod_{i=1}^K \\pi_i \\\\\n    \\mathrm{any}({\\bm \\pi}) &= 1 - \\prod_{i=1}^K (1 - \\pi_i). \n\\end{aligned}')
('2.1.4.0', '\\{0,1\\} \\times \\{0,1\\}')
('2.1.4.0', '\\{0,1\\}')
('2.1.4.0', "\\mathrm{and}(\\pi, \\pi') \\coloneqq \\pi \\cdot \\pi'")
('2.1.4.0', "\\mathrm{or}(\\pi, \\pi') \\coloneqq \\pi + \\pi' - \\pi \\cdot \\pi'")
('2.1.4.0', '[0,1] \\times [0,1]')
('2.1.4.0', '[0,1]')
('2.1.4.0', 'Y')
('2.1.4.0', "Y'")
('2.1.4.0', '\\pi')
('2.1.4.0', "\\pi'")
('2.1.4.0', "\\begin{aligned}\n\\mathrm{and}(\\pi, \\pi') &= \\mathbb{P}(Y = 1 \\cap Y' = 1) \n                        = \\mathbb{P}(Y = 1) \\cdot \\mathbb{P}(Y' = 1) \\\\\n\\mathrm{or}(\\pi, \\pi') &= \\mathbb{P}(Y = 1 \\cup Y' = 1) \\\\\n                       &= \\mathbb{P}(Y=1) + \\mathbb{P}(Y'=1) - \\mathbb{P}(Y = 1 \\cap Y' = 1) \\\\\n                       &= \\mathbb{P}(Y=1) + \\mathbb{P}(Y'=1) - \\mathbb{P}(Y = 1) \\mathbb{P}(Y' = 1) \\\\\n\\mathrm{not}(\\pi) &= \\mathbb{P}(Y \\neq 1) = 1 - \\mathbb{P}(Y = 1).\n\\end{aligned}")
('2.1.4.0', 'Y = (Y_1, \\dots, Y_K) \\in \\{0,1\\}^K')
('2.1.4.0', '{\\bm \\pi}= (\\pi_1, \\dots, \\pi_K)')
('2.1.4.0', '\\begin{aligned}\n\\textrm{all}({\\bm \\pi}) \n&= \\mathbb{P}(Y_1 = 1 \\cap \\dots \\cap Y_K = 1) \\\\\n&= \\prod_{i=1}^K \\mathbb{P}(Y_i = 1) \\\\\n\\textrm{any}({\\bm \\pi}) \n&= \\mathbb{P}(Y_1 = 1 \\cup \\dots \\cup Y_K = 1) \\\\\n&= 1 - \\mathbb{P}(\\neg(Y_1 = 1 \\cup \\dots \\cup Y_K = 1)) \\\\\n&= 1 - \\mathbb{P}(Y_1 \\neq 1 \\cap \\dots \\cap Y_K \\neq 1) \\\\\n&= 1 - \\prod_{i=1}^K (1 - \\mathbb{P}(Y_i=1)).\n\\end{aligned}')
('2.1.4.0', 'K')
('2.1.4.1', '[0,1] \\times [0,1]')
('2.1.4.1', '[0,1]')
('2.1.4.1', '1')
('2.1.4.1', "t(\\pi, \\pi') \\le t(\\tau, \\tau')")
('2.1.4.1', '\\pi \\le \\tau')
('2.1.4.1', "\\pi' \\le \\tau'")
('2.1.4.1', '0')
('2.1.4.1', '\\textbf{and}')
('2.1.4.1', '{\\bm \\pi}\\in [0,1]^K')
('2.1.4.1', "\\pi \\cdot \\pi'")
('2.1.4.1', "\\pi + \\pi' - \\pi \\cdot \\pi'")
('2.1.4.1', "\\min(\\pi, \\pi')")
('2.1.4.1', "\\max(\\pi, \\pi')")
('2.1.4.1', "\\max(\\pi + \\pi' - 1, 0)")
('2.1.4.1', "\\min(\\pi + \\pi', 1)")
('2.1.4.1', '\\forall')
('2.1.4.1', '\\exists')
('2.1.4.1', '\\prod_{i=1}^K \\pi_i')
('2.1.4.1', '1 - \\prod_{i=1}^K (1 - \\pi_i)')
('2.1.4.1', '\\min(\\pi_1, \\dots, \\pi_K)')
('2.1.4.1', '\\max(\\pi_1, \\dots, \\pi_K)')
('2.1.4.1', '\\max(\\sum_{i=1}^K \\pi_i - (K-1), 0)')
('2.1.4.1', '\\min(\\sum_{i=1}^K\n\\pi_i, 1)')
('2.1.5', '\\mathrm{ifelse} \\colon \\{0,1\\} \\times \\mathcal{V}\\times \\mathcal{V}\\to \\mathcal{V}')
('2.1.5', '\\begin{aligned}\n\\mathrm{ifelse}(\\pi, {\\bm v}_1, {\\bm v}_0)\n&\\coloneqq \n\\begin{cases}\n{\\bm v}_1 &\\mbox{ if } \\pi = 1 \\\\\n{\\bm v}_0 &\\mbox{ if } \\pi = 0 \n\\end{cases} \\label{cf:eq:ifelse} \\\\\n&= \\pi \\cdot {\\bm v}_1 + (1 - \\pi) \\cdot {\\bm v}_0. \\nonumber\n\\end{aligned}')
('2.1.5', '\\pi')
('2.1.5', '\\mathrm{ifelse}')
('2.1.5', '\\pi \\not \\in \\{0,1\\}')
('2.1.5', '\\pi \\in\n\\{0,1\\}')
('2.1.5', '{\\bm v}_0 \\in \\mathcal{V}')
('2.1.5', '{\\bm v}_1 \\in \\mathcal{V}')
('2.1.5', '\\pi=1')
('2.1.5', '{\\bm v}_1')
('2.1.5', '{\\bm v}_0')
('2.1.5', '\\pi=0')
('2.1.5', '{\\bm v}_0')
('2.1.5', '{\\bm v}_1')
('2.1.5', '\\mathrm{ifelse}')
('2.1.5.0', '\\pi \\in \\{0,1\\}')
('2.1.5.0', '\\mathrm{ifelse}(\\pi, {\\bm v}_1, {\\bm v}_0)')
('2.1.5.0', '{\\bm v}_1 \\in \\mathcal{V}')
('2.1.5.0', '{\\bm v}_0 \\in \\mathcal{V}')
('2.1.5.0', '{\\bm v}_1')
('2.1.5.0', '{\\bm v}_0')
('2.1.5.0', '{\\bm v}_1')
('2.1.5.0', '{\\bm v}_0')
('2.1.5.0', '\\begin{aligned}\n\\partial_{{\\bm v}_0} \\mathrm{ifelse}(\\pi, {\\bm v}_1, {\\bm v}_0)\n&\\coloneqq \n\\begin{cases}\n0 &\\mbox{ if } \\pi = 1 \\\\\nI &\\mbox{ if } \\pi = 0 \n\\end{cases} \\\\\n&= (1-\\pi) \\cdot I\n\\end{aligned}')
('2.1.5.0', '\\begin{aligned}\n\\partial_{{\\bm v}_1} \\mathrm{ifelse}(\\pi, {\\bm v}_1, {\\bm v}_0)\n&\\coloneqq \n\\begin{cases}\nI &\\mbox{ if } \\pi = 1 \\\\\n0 &\\mbox{ if } \\pi = 0 \n\\end{cases} \\\\\n&= \\pi \\cdot I,\n\\end{aligned}')
('2.1.5.0', 'I')
('2.1.5.0', 'g_1 \\colon \\mathcal{U}_1 \\to \\mathcal{V}')
('2.1.5.0', 'g_0 \\colon \\mathcal{U}_0 \\to \\mathcal{V}')
('2.1.5.0', '{\\bm v}_1 \\coloneqq g_1({\\bm u}_1)')
('2.1.5.0', '{\\bm v}_0 \\coloneqq g_0({\\bm u}_0)')
('2.1.5.0', '{\\bm u}_1 \\in \\mathcal{U}_1')
('2.1.5.0', '{\\bm u}_0 \\in \\mathcal{U}_0')
('2.1.5.0', '\\mathrm{ifelse}')
('2.1.5.0', 'g_1')
('2.1.5.0', 'g_0')
('2.1.5.0', 'f \\colon \\{0,1\\} \\times \\mathcal{U}_1 \\times \\mathcal{U}_0 \\to \\mathcal{V}')
('2.1.5.0', '\\begin{aligned}\nf(\\pi, {\\bm u}_1, {\\bm u}_0) \n&\\coloneqq \\mathrm{ifelse}(\\pi, g_1({\\bm u}_1), g_0({\\bm u}_0)) \\\\\n&= \\pi \\cdot g_1({\\bm u}_1) + (1-\\pi) \\cdot g_0({\\bm u}_0).\n\\end{aligned}')
('2.1.5.0', '\\partial_{{\\bm u}_1} f(\\pi, {\\bm u}_1, {\\bm u}_0) \n= \\pi \\cdot \\partial g_1({\\bm u}_1)')
('2.1.5.0', '\\partial_{{\\bm u}_0} f(\\pi, {\\bm u}_1, {\\bm u}_0) \n= (1-\\pi) \\partial g_0({\\bm u}_0).')
('2.1.5.0', 'g_1')
('2.1.5.0', 'g_0')
('2.1.5.0', '{\\bm u}_1')
('2.1.5.0', '{\\bm u}_0')
('2.1.5.0', '\\pi')
('2.1.5.1', '\\pi')
('2.1.5.1', '\\pi')
('2.1.5.1', 'f_h \\colon \\mathbb{R}\\times \\mathcal{U}_1 \\times \\mathcal{U}_0 \\to \\mathcal{V}')
('2.1.5.1', 'f_h(p, {\\bm u}_1, {\\bm u}_0)\n\\coloneqq\n\\begin{cases}\ng_1({\\bm u}_1) &\\mbox{ if } p \\ge 0 \\\\\ng_0({\\bm u}_0) &\\mbox{ otherwise }\n\\end{cases}.')
('2.1.5.1', '\\begin{aligned}\nf_h(p, {\\bm u}_1, {\\bm u}_0) \n&\\coloneqq \\mathrm{ifelse}(\\mathrm{gt}(p, 0), g_1({\\bm u}_1), g_0({\\bm u}_0)) \\\\\n&= \\mathrm{ifelse}(\\mathrm{step}(p), g_1({\\bm u}_1), g_0({\\bm u}_0)) \\\\\n&= \\mathrm{step}(p) g_1({\\bm u}_1) + (1 - \\mathrm{step}(p)) g_0({\\bm u}_0).\n\\end{aligned}')
('2.1.5.1', 'p=0')
('2.1.5.1', "\\mathrm{step}'(p) = 0")
('2.1.5.1', 'p \\neq 0')
('2.1.5.1', 'f_h')
('2.1.5.1', 'p \\neq 0')
('2.1.5.1', "\\begin{aligned}\n\\partial_p f_h(p, {\\bm u}_1, {\\bm u}_0) \n&= \\partial_1 f_h(p, {\\bm u}_1, {\\bm u}_0) \\\\\n&= \\mathrm{step}'(p)(g_1({\\bm u}_1) - g_0({\\bm u}_0)) \\\\\n&= {\\mathbf{0}}.\n\\end{aligned}")
('2.1.5.1', 'f_h')
('2.1.5.1', 'p')
('2.1.5.1', 'p \\neq 0')
('2.1.5.1', 'g_h({\\bm u}_1, {\\bm u}_0) \\coloneqq f_h(t({\\bm u}_1), {\\bm u}_1, {\\bm u}_0),')
('2.1.5.1', 't')
('2.1.5.1', '{\\bm u}_1')
('2.1.5.1', '\\begin{aligned}\n\\partial_{{\\bm u}_1} g_h({\\bm u}_1, {\\bm u}_0) \n&= \\partial t({\\bm u}_1) \\partial_1 f_h(t({\\bm u}_1), {\\bm u}_1, {\\bm u}_0)\n+ \\partial_2 f_h(t({\\bm u}_1), {\\bm u}_1, {\\bm u}_0) \\\\\n&= \\partial_2 f_h(t({\\bm u}_1), {\\bm u}_1, {\\bm u}_0).\n\\end{aligned}')
('2.1.5.1', 't({\\bm u}_1)')
('2.1.5.1', 'g_h')
('2.1.5.2', '\\mathrm{ifelse}(\\pi, {\\bm v}_1, {\\bm v}_0)\n= \\pi \\cdot {\\bm v}_1 + (1 - \\pi) \\cdot {\\bm v}_0.')
('2.1.5.2', '\\pi \\in [0,1]')
('2.1.5.2', '\\pi \\in \\{0,1\\}')
('2.1.5.2', '\\{0,1\\}')
('2.1.5.2', '[0,1]')
('2.1.5.2', '\\mathrm{gt}(a, b) \\approx \\mathrm{sigmoid}(a - b) \\in [0,1],')
('2.1.5.2', '\\mathbb{R}')
('2.1.5.2', '[0,1]')
('2.1.5.2', '\\begin{aligned}\nf_s(p, {\\bm u}_1, {\\bm u}_0) \n&\\coloneqq \\mathrm{ifelse}(\\mathrm{sigmoid}(p), g_1({\\bm u}_1), g_0({\\bm u}_0)) \\nonumber \\\\\n&= \\mathrm{sigmoid}(p) g_1({\\bm u}_1) + (1 - \\mathrm{sigmoid}(p)) g_0({\\bm u}_0), \n\\label{cf:eq:soft_ifelse}\n\\end{aligned}')
('2.1.5.2', "\\partial_p f_s(p, {\\bm u}_1, {\\bm u}_0)    \n= \\mathrm{sigmoid}'(p)(g_1({\\bm u}_1) - g_0({\\bm u}_0)).")
('2.1.5.2', '\\mathrm{sigmoid}= \\mathrm{logistic}')
('2.1.5.2', '\\pi')
('2.1.5.2', '0')
('2.1.5.2', '1')
('2.1.5.2', '\\pi')
('2.1.5.2', 'p')
('2.1.5.2', 'g_0')
('2.1.5.2', 'g_1')
('2.1.5.2.0', 'g_i({\\bm u}_i)')
('2.1.5.2.0', 'i \\in \\{0,1\\}')
('2.1.5.2.0', '\\pi = \\mathrm{sigmoid}(p)')
('2.1.5.2.0', 'f_s(p, {\\bm u}_1, {\\bm u}_0)\n= \\mathbb{E}_{i \\sim \\mathrm{Bernoulli}(\\mathrm{sigmoid}(p))}\\left[g_i({\\bm u}_i)\\right].')
('2.1.5.2.0', 'p')
('2.1.5.2.0', '\\mathrm{sigmoid}(p)')
('2.1.5.2.0', '\\begin{aligned}\n&\\mathbb{V}_{i \\sim \\mathrm{Bernoulli}(\\mathrm{sigmoid}(p))}\\left[g_i({\\bm u}_i)\\right] \\\\\n=& \n\\mathbb{E}_{i \\sim \\mathrm{Bernoulli}(\\mathrm{sigmoid}(p))}\n\\left[(f_s(p, {\\bm u}_1, {\\bm u}_0) - g_i({\\bm u}_i))^2 \\right].\n\\end{aligned}')
('2.1.5.2.0', 'P')
('2.1.5.2.0', 'p')
('2.1.5.2.0', '1')
('2.1.5.2.0', '\\mathbb{P}(P \\le 0) = \\mathrm{logistic}(-p) = 1 - \\mathrm{logistic}(p)')
('2.1.5.2.0', '\\begin{aligned}\nf_s(p, {\\bm u}_1, {\\bm u}_0)\n&= \\mathrm{ifelse}(\\mathrm{logistic}(p), g_1({\\bm u}_1), g_0({\\bm u}_0)) \\\\\n&= \\mathrm{logistic}(p) g_1({\\bm u}_1) + (1 - \\mathrm{logistic}(p)) g_0({\\bm u}_0) \\\\\n&= \\mathbb{P}(P > 0) \\cdot g_1({\\bm u}_1) + \\mathbb{P}(P \\le 0) \\cdot g_0({\\bm u}_0).\n\\end{aligned}')
('2.1.5.2.0', '\\begin{aligned}\n    f(x, y, z) \\coloneqq\n    \\begin{cases}\n      y & \\mbox{if} \\ a \\leq x \\leq b \\\\\n      z & \\mbox{otherwise}\n    \\end{cases}.\n  \n\\end{aligned}')
('2.1.5.2.0', 'y')
('2.1.5.2.0', 'z')
('2.1.5.2.0', 'x')
('2.1.5.2.0', '\\mathrm{and}')
('2.1.5.2.0', '\\begin{aligned}\n    f(x, y, z) & = \n    \\mathrm{ifelse}(\\mathrm{and}(\\mathrm{gt}(x, a), \\mathrm{lt}(x, b)), y, z).\n  \n\\end{aligned}')
('2.1.5.2.0', '\\mathrm{gt}')
('2.1.5.2.0', '\\mathrm{lt}')
('2.1.5.2.0', '\\mathrm{gt}_\\sigma')
('2.1.5.2.0', '\\mathrm{lt}_\\sigma')
('2.1.5.2.0', '\\begin{aligned}\n  f^{\\mathrm{loc}}_\\sigma(x, y, z) &\\coloneqq\n    \\mathrm{ifelse}(\\mathrm{and}(\\mathrm{gt}_\\sigma(x, a), \\mathrm{lt}_\\sigma(x,\n    b)), y, z) \\\\\n                                   &= \\pi_a \\pi_b y + (1-\\pi_a\\pi_b)z\n  \n\\end{aligned}')
('2.1.5.2.0', '\\begin{aligned}\n    \\pi_a &\\coloneqq \\mathrm{sigmoid}_\\sigma(x-a) \\\\\n    \\pi_b &\\coloneqq \\mathrm{sigmoid}_\\sigma(b-x),\n\\end{aligned}')
('2.1.5.2.0', '\\mathrm{sigmoid}_\\sigma')
('2.1.5.2.0', '\\begin{aligned}\n  f^{\\mathrm{glob}}_\\sigma(x, y, z) &\\coloneqq\n  \\mathbb{E}[\\mathrm{ifelse}(\\mathrm{and}(\\mathrm{gt}(x+\\sigma Z, a), \\mathrm{lt}(x +\n  \\sigma Z, b)), y, z)] \\\\\n                                    &=\\mathrm{ifelse}(\\pi, y, z)\n  \n\\end{aligned}')
('2.1.5.2.0', '\\begin{aligned}\n    \\pi &\\coloneqq \\mathbb{E}[\\mathrm{and}(\\mathrm{gt}(x + \\sigma Z, a), \\mathrm{lt}(x +\\sigma Z, b))] \\\\\n    & = \\mathbb{P}(a\\leq x+\\sigma Z\\leq b) \\\\\n    & =  \\mathrm{sigmoid}_\\sigma(b - x) - \\mathrm{sigmoid}_\\sigma(a-x)\\\\\n    & = \\pi_b - \\pi_a,\n  \n\\end{aligned}')
('2.1.5.2.0', '\\mathrm{sigmoid}_\\sigma')
('2.1.5.2.0', '\\sigma Z')
('2.1.5.2.0', 'f^{\\mathrm{glob}}_\\sigma(x, y, z) \n  =(\\pi_b - \\pi_a) y + (1 - (\\pi_b - \\pi_a)) z.')
('2.1.5.2.0', 'a \\le x')
('2.1.5.2.0', 'x \\le b')
('2.1.5.2.0', '\\operatorname{\\mathbf 1}_{X \\geq a}')
('2.1.5.2.0', '\\operatorname{\\mathbf 1}_{X\\leq b}')
('2.1.5.2.0', 'a \\le x \\le b')
('2.1.5.2.0', '\\sigma\n  \\rightarrow 0')
('2.1.5.2.0', '\\sigma')
('2.1.5.2.0', 'f(x)\n      \\coloneqq 1')
('2.1.5.2.0', 'x \\in [-1, 1]')
('2.1.5.2.0', 'f(x) \\coloneqq 0')
('2.1.5.2.0', 'f(x) = \\mathrm{ifelse}(\\mathrm{and}(\\mathrm{gt}(x, -1), \\mathrm{lt}(x, 1)), 1, 0)')
('2.1.5.2.0', '\\mathrm{gt}')
('2.1.5.2.0', '\\mathrm{lt}')
('2.1.5.2.0', '\\sigma')
('2.1.5.2.0', '\\sigma')
('2.1.6', 'K')
('2.1.6.0', '2')
('2.1.6.0', '\\pi \\in \\{0,1\\}')
('2.1.6.0', 'K')
('2.1.6.0', 'K')
('2.1.6.0', '{\\bm \\pi}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_K\\}')
('2.1.6.0', '{\\bm e}_i')
('2.1.6.0', '{\\bm e}_i \\coloneqq (0, \\dots, \\underbrace{1}_i, \\dots, 0),')
('2.1.6.0', 'i')
('2.1.6.0', 'K-1')
('2.1.6.0', '{\\bm e}_i')
('2.1.6.0', 'i \\in [K]')
('2.1.6.0.0', '{\\bm \\pi}\\in \\{{\\bm e}_1,\\dots,{\\bm e}_K\\}')
('2.1.6.0.0', '{\\bm \\pi}= (\\pi_1,\\dots,\\pi_K)')
('2.1.6.0.0', '\\pi_i')
('2.1.6.0.1', '{\\bm \\pi}')
('2.1.6.0.1', '\\begin{aligned}\n\\mathrm{argmax}({\\bm p})\n&\\coloneqq\n\\mathop{\\mathrm{arg\\,max}}_{{\\bm \\pi}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_K\\}}\n\\langle {\\bm \\pi}, {\\bm p}\\rangle \\\\\n\\mathrm{argmin}({\\bm p})\n&\\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm \\pi}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_K\\}}\n\\langle {\\bm \\pi}, {\\bm p}\\rangle\n= \\mathrm{argmax}(-{\\bm p}).\n\\end{aligned}')
('2.1.6.1', '\\mathrm{cond} \\colon \\{{\\bm e}_1, \\dots, {\\bm e}_K\\} \n\\times \\mathcal{V}^K \\to \\mathcal{V}')
('2.1.6.1', '\\begin{aligned}\n\\mathrm{cond}({\\bm \\pi}, {\\bm v}_1, \\dots, {\\bm v}_K)\n&\\coloneqq \n\\begin{cases}\n{\\bm v}_1 &\\mbox{ if } {\\bm \\pi}= {\\bm e}_1 \\\\\n\\vdots & \\\\\n{\\bm v}_K &\\mbox{ if } {\\bm \\pi}= {\\bm e}_K\n\\end{cases} \\label{cf:eq:cond} \\\\\n&= \\sum_{i=1}^K \\pi_i {\\bm v}_i \\nonumber.\n\\end{aligned}')
('2.1.6.1', '\\mathrm{ifelse}')
('2.1.6.1', '\\mathrm{cond}')
('2.1.6.1', '{\\bm \\pi}\\in \\{{\\bm e}_1,\\dots,{\\bm e}_K\\}')
('2.1.6.1', '{\\bm \\pi}= {\\bm e}_i')
('2.1.6.1', 'i')
('2.1.6.1', '{\\bm v}_i')
('2.1.6.1', '{\\bm v}_j')
('2.1.6.1', 'j \\neq i')
('2.1.6.1', '\\mathrm{SoftThreshold}(u, \\lambda) \\coloneqq\n\\begin{cases}\n0 &\\mbox{ if } |u| \\le \\lambda \\\\\nu - \\lambda &\\mbox{ if } u \\ge \\lambda \\\\\nu + \\lambda &\\mbox{ if } u \\le -\\lambda\n\\end{cases}.')
('2.1.6.1', '{\\bm \\pi}\\in \\{{\\bm e}_1, {\\bm e}_2, {\\bm e}_3\\}')
('2.1.6.1', '\\begin{aligned}\n{\\bm \\pi}\n&\\coloneqq (\\mathrm{lt}(|u|, \\lambda), \n\\mathrm{gt}(u, \\lambda), \n\\mathrm{lt}(u, -\\lambda)) \\\\\n&= (\\mathrm{step}(\\lambda - |u|),\n\\mathrm{step}(u - \\lambda), \\mathrm{step}(-u - \\lambda)).\n\\end{aligned}')
('2.1.6.1', '{\\bm \\pi}')
('2.1.6.1', '{\\bm \\pi}\\coloneqq \\mathrm{argmax}((\\lambda - |u|, u - \\lambda, -u - \\lambda)).')
('2.1.6.1', '|u|=\\lambda')
('2.1.6.1', '{\\bm \\pi}')
('2.1.6.1', '\\mathrm{SoftThreshold}(u, \\lambda) = \\mathrm{cond}({\\bm \\pi}, 0, u - \\lambda, u + \\lambda).')
('2.1.6.1', '\\mathrm{argmax}')
('2.1.6.1', '\\mathrm{softargmax}')
('2.1.6.2', '{\\bm \\pi}')
('2.1.6.2', '\\mathrm{cond}({\\bm \\pi}, {\\bm v}_1, \\dots, {\\bm v}_K)')
('2.1.6.2', '{\\bm v}_i')
('2.1.6.2', '{\\bm v}_i')
('2.1.6.2', '{\\bm v}_i')
('2.1.6.2', '\\begin{aligned}\n\\partial_{{\\bm v}_i} \\mathrm{cond}({\\bm \\pi}, {\\bm v}_1, \\dots, {\\bm v}_K)\n&\\coloneqq \n\\begin{cases}\nI &\\mbox{ if } {\\bm \\pi}= {\\bm e}_i \\\\\n{\\mathbf{0}}&\\mbox{ if } {\\bm \\pi}\\neq {\\bm e}_i \n\\end{cases}.\n\\end{aligned}')
('2.1.6.2', 'g_i \\colon \\mathcal{U}_i \\to \\mathcal{V}')
('2.1.6.2', '{\\bm u}_i \\in \\mathcal{U}_i')
('2.1.6.2', 'f({\\bm \\pi}, {\\bm u}_1, \\dots, {\\bm u}_K)\n\\coloneqq\n\\mathrm{cond}({\\bm \\pi}, g_1({\\bm u}_1), \\dots, g_K({\\bm u}_K)),')
('2.1.6.2', '{\\bm u}_i')
('2.1.6.2', '\\begin{aligned}\n\\partial_{{\\bm u}_i}\nf({\\bm \\pi}, {\\bm u}_1, \\dots, {\\bm u}_K)\n&\\coloneqq \n\\begin{cases}\n\\partial g_i({\\bm u}_i) &\\mbox{ if } {\\bm \\pi}= {\\bm e}_i \\\\\n{\\mathbf{0}}&\\mbox{ if } {\\bm \\pi}\\neq {\\bm e}_i \n\\end{cases}.\n\\end{aligned}')
('2.1.6.2', 'g_i')
('2.1.6.2', '{\\bm u}_i')
('2.1.6.2', '{\\bm \\pi}')
('2.1.6.3', '{\\bm \\pi}')
('2.1.6.3', 'f_a({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K) \\coloneqq\n\\begin{cases}\n{\\bm v}_1 &\\mbox{ if } p_1 = \\max_j p_j \\\\\n\\vdots & \\\\\n{\\bm v}_K &\\mbox{ if } p_K = \\max_j p_j\n\\end{cases}.')
('2.1.6.3', 'f_a({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K)\n\\coloneqq\n\\mathrm{cond}(\\mathrm{argmax}({\\bm p}), g_1({\\bm u}_1), \\dots, g_K({\\bm u}_K)),')
('2.1.6.3', '{\\bm p}')
('2.1.6.3', '\\partial_{\\bm p}f_a({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K) = {\\mathbf{0}}.')
('2.1.6.4', '\\mathrm{softargmax}({\\bm p}) \\coloneqq \n\\frac{\\exp({\\bm p})}{\\sum_{i=1}^K \\exp(p_i)} \\in \\triangle^K')
('2.1.6.4', '\\mathrm{softargmin}({\\bm p}) \\coloneqq \\mathrm{softargmax}(-{\\bm p}) \\in \\triangle^K.')
('2.1.6.4', '\\mathrm{cond}({\\bm \\pi}, {\\bm v}_1, \\dots, {\\bm v}_K)\n= \\sum_{i=1}^K \\pi_i {\\bm v}_i')
('2.1.6.4', '{\\bm \\pi}\\in \\triangle^K')
('2.1.6.4', '{\\bm \\pi}\\in \\{{\\bm e}_1,\\dots,{\\bm e}_K\\}')
('2.1.6.4', '\\begin{aligned}\nf_s({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K) \n&\\coloneqq \\mathrm{cond}(\\mathrm{softargmax}({\\bm p}), g_1({\\bm u}_1), \\dots, g_K({\\bm u}_K)) \n\\nonumber \\\\\n&= \\sum_{i=1}^K [\\mathrm{softargmax}({\\bm p})]_i \\cdot g_i({\\bm u}_i),\n\\label{cf:eq:soft_cond}\n\\end{aligned}')
('2.1.6.4', '\\partial_p f_s({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K)    \n= \n\\partial \\mathrm{softargmax}({\\bm p})(g_1({\\bm u}_1), \\dots, g_K({\\bm u}_K)),')
('2.1.6.4.0', 'g_i({\\bm u}_i)')
('2.1.6.4.0', 'i \\in [K]')
('2.1.6.4.0', '{\\bm \\pi}= \\mathrm{softargmax}({\\bm p})')
('2.1.6.4.0', 'f_s({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K)\n= \\mathbb{E}_{i \\sim \\mathrm{Categorical}(\\mathrm{softargmax}({\\bm p}))}\\left[g_i({\\bm u}_i)\\right].')
('2.1.6.4.0', 'K')
('2.1.6.4.0', '{\\bm p}')
('2.1.6.4.0', '\\begin{aligned}\n& \\mathbb{V}_{i \\sim \\mathrm{Categorical}(\\mathrm{softargmax}({\\bm p}))}\\left[g_i({\\bm u}_i)\\right] \\\\\n=& \n\\mathbb{E}_{i \\sim \\mathrm{Categorical}(\\mathrm{softargmax}({\\bm p}))}\n\\left[(f_s({\\bm p}, {\\bm u}_1, \\dots, {\\bm u}_K) - g_i({\\bm u}_i))^2 \\right].\n\\end{aligned}')
('2.1.7', 'K')
('2.1.7', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{k-1})')
('2.1.7', '{\\bm r}\\coloneqq {\\bm s}_K')
('2.1.7', 'f_k')
('2.1.7', '\\mathrm{forloop}')
('2.1.7', '{\\bm s}_0')
('2.1.7', 'f_k({\\bm s}_{k-1}) \\coloneqq g_k({\\bm s}_{k-1}, {\\bm w}_k),')
('2.1.7', 'g_k')
('2.1.7', '{\\bm w}')
('2.1.7', 'L({\\bm w}, \\lambda) \n\\coloneqq \n\\frac{1}{N} \\sum_{i=1}^N \\ell(h({\\bm x}_i, {\\bm w}), {\\bm y}_i) + \\frac{\\lambda}{2}\n\\|{\\bm w}\\|^2_2.')
('2.1.7', '{\\bm w}_0')
('2.1.7', '{\\bm w}_k \n= f({\\bm w}_{k-1}, \\gamma_k, \\lambda)\n\\coloneqq {\\bm w}_{k-1} - \\gamma_k \\nabla_1 L({\\bm w}_{k-1}, \\lambda).')
('2.1.7', 'f_k({\\bm w}_{k-1}) \\coloneqq f({\\bm w}_{k-1}, \\gamma_k, \\lambda).')
('2.1.7', 'f')
('2.1.7', 'L')
('2.1.7', '\\gamma_k')
('2.1.7', '\\lambda')
('2.1.7', 'i')
('2.1.7', 'j')
('2.1.7', '\\mathbb{R}^N \\times [N] \\times [N]')
('2.1.7', '\\mathbb{R}^N')
('2.1.7', '\\mathrm{swap}({\\bm v}, i, j) \n\\coloneqq {\\bm v}+ (v_j - v_i) {\\bm e}_i + (v_i - v_j) {\\bm e}_j.')
('2.1.7', "\\begin{aligned}\n&\\text{\\bf for} ~ i \\coloneqq 1,\\dots,N ~ \\text{\\bf do} \\\\\n&\\quad \\text{\\bf for} ~ j \\coloneqq 1, \\dots, N - i - 1 ~ \\text{\\bf do} \\\\\n&\\quad \\quad {\\bm v}' \\coloneqq \\mathrm{swap}({\\bm v}, j, j+1) \\\\\n&\\quad \\quad \\pi \\coloneqq \\mathrm{step}(v_j - v_{j+1}) \\\\\n&\\quad \\quad {\\bm v}\\leftarrow \\mathrm{ifelse}(\\pi, {\\bm v}', {\\bm v})\n\\end{aligned}")
('2.1.8', 'f')
('2.1.8', '{\\bm u}_k')
('2.1.8', '{\\bm s}_k')
('2.1.8', '{\\bm s}_k, {\\bm v}_k \\coloneqq f({\\bm s}_{k-1}, {\\bm u}_k)')
('2.1.8', '{\\bm r}\\coloneqq ({\\bm s}_K, {\\bm v}_1, \\dots, {\\bm v}_K)')
('2.1.8', 'f')
('2.1.8', '\\begin{aligned}\n{\\bm v}_1 &\\coloneqq {\\bm u}_1 \\\\\n{\\bm v}_2 &\\coloneqq {\\bm u}_1 + {\\bm u}_2 \\\\\n{\\bm v}_3 &\\coloneqq {\\bm u}_1 + {\\bm u}_2 + {\\bm u}_3 \\\\\n     &\\vdots\n\\end{aligned}')
('2.1.8', '\\begin{aligned}\n    {\\bm v}_k &\\coloneqq {\\bm s}_{k-1} + {\\bm u}_k \\\\\n    f({\\bm s}_{k-1}, {\\bm u}_k) &\\coloneqq ({\\bm v}_k, {\\bm v}_k)\n\\end{aligned}')
('2.1.8', '{\\bm s}_0 = {\\mathbf{0}}')
('2.1.8', '{\\bm s}_K')
('2.1.8', '{\\bm v}_K')
('2.1.9.0', 'f \\colon \\mathcal{S}\\to \\{0,1\\}')
('2.1.9.0', '\\pi=1')
('2.1.9.0', '\\pi=0')
('2.1.9.0', 'g \\colon \\mathcal{S}\\to \\mathcal{S}')
('2.1.9.0', '\\pi \\leftarrow f({\\bm s})')
('2.1.9.0', '{\\bm s}\\leftarrow g({\\bm s})')
('2.1.9.0', '\\pi \\leftarrow f({\\bm s})')
('2.1.9.0', '{\\bm r}\\coloneqq {\\bm s}')
('2.1.9.0', '\\pi \\coloneqq f({\\bm s})')
('2.1.9.0', '{\\bm r}\\coloneqq {\\bm s}')
('2.1.9.0', '{\\bm r}\\coloneqq \\mathrm{whileloop}(g({\\bm s}))')
('2.1.9.0', '\\pi = 1')
('2.1.9.0', '{\\bm s}\n      \\leftarrow g({\\bm s})')
('2.1.9.0', '\\pi \\leftarrow f({\\bm s})')
('2.1.9.0', '\\pi = 0')
('2.1.9.0.0', '\\mathrm{ifelse}')
('2.1.9.0.0', '\\begin{aligned}\n{\\bm r}\n&\\coloneqq \\mathrm{ifelse}(f({\\bm s}), {\\bm s}, \\mathrm{whileloop}(g({\\bm s}))) \\\\\n&= f({\\bm s}) \\cdot {\\bm s}+ (1 - f({\\bm s})) \\cdot \\mathrm{whileloop}(g({\\bm s})).\n\\end{aligned}')
('2.1.9.0.0', '\\mathrm{ifelse}')
('2.1.9.0.0', '\\mathrm{whileloop}(g({\\bm s}))')
('2.1.9.0.0', '\\pi = f({\\bm s}) = 0')
('2.1.9.0.0', 'f({\\bm s}) \\in \\{0,1\\}')
('2.1.9.1', 'T')
('2.1.9.1', 'T=3')
('2.1.9.1', '\\begin{aligned}\n    &\\pi_0 \\coloneqq f({\\bm s}_0) \\\\\n    &\\text{\\bf{if}} ~ \\pi_0 = 1 ~ \\textbf{\\bf{then}} \\\\\n    &\\quad {\\bm r}\\coloneqq {\\bm s}_0 \\\\\n    &\\text{\\bf{else}} \\\\\n    &\\quad {\\bm s}_1 \\coloneqq g({\\bm s}_0), \\pi_1 \\coloneqq f({\\bm s}_1) \\\\\n    &\\quad \\text{\\bf{if}} ~ \\pi_1 = 1 ~ \\textbf{\\bf{then}} \\\\\n    &\\quad \\quad {\\bm r}\\coloneqq {\\bm s}_1 \\\\\n    &\\quad \\text{\\bf{else}} \\\\\n    &\\quad \\quad {\\bm s}_2 \\coloneqq g({\\bm s}_1), \\pi_2 \\coloneqq f({\\bm s}_2) \\\\\n    &\\quad \\quad \\text{\\bf{if}} ~ \\pi_2 = 1 ~ \\textbf{\\bf{then}} \\\\\n    &\\quad \\quad \\quad {\\bm r}\\coloneqq {\\bm s}_2 \\\\\n    &\\quad \\quad \\text{\\bf{else}} \\\\\n    &\\quad \\quad \\quad {\\bm r}\\coloneqq {\\bm s}_3 \\coloneqq g({\\bm s}_2) \\\\\n\\end{aligned}')
('2.1.9.1', '\\mathrm{ifelse}')
('2.1.9.1', '\\begin{aligned}\n{\\bm r}= \\mathrm{ifelse}(&\\pi_0, \\\\\n                     &{\\bm s}_0, \\\\\n                     &\\mathrm{ifelse}(\\pi_1, \\\\\n                     & \\hspace{1cm}   {\\bm s}_1,  \\\\\n                     & \\hspace{1cm}   \\mathrm{ifelse}(\\pi_2, \\\\\n                     & \\hspace{2cm}                   {\\bm s}_2, \\\\\n                     & \\hspace{2cm}                   {\\bm s}_3)))\n\\end{aligned}')
('2.1.9.1', '\\begin{aligned}\n{\\bm r}\n&= \\pi_0 {\\bm s}_0 + (1-\\pi_0) \\left[ \\pi_1 {\\bm s}_1 + (1-\\pi_1) \\left[ \\pi_2 {\\bm s}_2 +\n(1-\\pi_2) {\\bm s}_3 \\right] \\right] \\\\\n&= \\pi_0 {\\bm s}_0 + \n(1-\\pi_0) \\pi_1 {\\bm s}_1 +\n(1-\\pi_0) (1- \\pi_1) \\pi_2 {\\bm s}_2 +\n(1-\\pi_0) (1- \\pi_1) (1 - \\pi_2) {\\bm s}_3.\n\\end{aligned}')
('2.1.9.1', 'T \\in \\mathbb{N}')
('2.1.9.1', '\\begin{aligned}\n{\\bm r}\n& = \\sum_{i=0}^T \\left((1-\\pi_0) \\dots (1-\\pi_{i-1})\\right) \\pi_i {\\bm s}_i  \\\\\n& = \\sum_{i=0}^T  \\left(\\prod_{j=0}^{i-1} (1 - \\pi_j)\\right) \\pi_i {\\bm s}_i,\n\\end{aligned}')
('2.1.9.1', '\\begin{aligned}\n  {\\bm s}_i \n  & \\coloneqq g({\\bm s}_{i-1}) \\coloneqq g^{i}({\\bm s}_0) \n  \\coloneqq \\underbrace{g \\circ \\dots \\circ g}_{i \\text{ times}}({\\bm s}_0) \\in \\mathcal{S}\\\\\n  \\pi_i & \\coloneqq f({\\bm s}_i) \\in \\{0,1\\}.\n\\end{aligned}')
('2.1.9.1', '\\begin{aligned}\n    \\tilde{\\pi}_0 &\\coloneqq \\pi_0\\\\\n    \\tilde{\\pi}_i &\\coloneqq \\left(\\prod_{j=0}^{i-1}\\pi_j\\right)\\pi_i\n    \\quad i \\in \\{1,\\dots,T\\},\n\\end{aligned}')
('2.1.9.1', '\\tilde{{\\bm \\pi}} \\coloneqq (\\tilde{\\pi}_0,\n\\tilde{\\pi}_1,\\dots,\\tilde{\\pi}_T) \\in \\triangle^{T+1}')
('2.1.9.1', 'T')
('2.1.9.1', '{\\bm r}= \\mathrm{cond}(\\tilde{{\\bm \\pi}}, {\\bm s}_0, {\\bm s}_1, \\dots, {\\bm s}_T).')
('2.1.9.1', 'T')
('2.1.9.1', 'T+1')
('2.1.9.1', '\\mathrm{cond}(\\tilde{{\\bm \\pi}}, {\\bm s}_0, \\dots,\n    {\\bm s}_T) = \\sum_{t=0}^T \\tilde{\\pi}_t {\\bm s}_t')
('2.1.9.1', '\\sqrt{x}')
('2.1.9.1', 'x > 0')
('2.1.9.1', 's_0')
('2.1.9.1', 's_{i+1} \n\\coloneqq g({\\bm s}_i) \n\\coloneqq \\frac{1}{2} \\left(s_i + \\frac{x}{s_i}\\right).')
('2.1.9.1', 'i')
('2.1.9.1', '\\varepsilon(s_i) \\coloneqq \\frac{1}{2}(s_i^2 - x)^2.')
('2.1.9.1', '\\begin{aligned}\n    \\pi_i &\\coloneqq \n\\begin{cases}\n    1 &\\mbox{ if } \\varepsilon(s_i) \\le \\tau \\\\\n    0 &\\mbox{ otherwise }\n\\end{cases} \\\\\n          &= \\mathrm{step}(\\tau - \\varepsilon(s_i)),\n\\end{aligned}')
('2.1.9.1', '0 < \\tau \\ll 1')
('2.1.9.1', '\\mathrm{step}')
('2.1.9.2', 'g \\colon \\mathcal{S}\\to \\mathcal{S}')
('2.1.9.2', '{\\bm s}_0 \\in \\mathcal{S}')
('2.1.9.2', '{\\bm s}_0, {\\bm s}_1, {\\bm s}_2, \\ldots')
('2.1.9.2', '{\\bm s}_i = g({\\bm s}_{i-1})')
('2.1.9.2', '{\\bm s}_i')
('2.1.9.2', '{\\bm s}_{i+1}')
('2.1.9.2', '{\\bm s}_i')
('2.1.9.2', '\\pi_i\\in\\{0, 1\\}')
('2.1.9.2', '\\{{\\bm s}_0, {\\bm s}_1, {\\bm s}_2,\\dots \\}')
('2.1.9.2', '\\{0,1,2,\\dots\n\\}')
('2.1.9.2', '\\mathbb{P}(S_{t+1} = {\\bm s}_i | S_t = {\\bm s}_j)\n= p_{i,j} \\coloneqq\n\\begin{cases}\n\\pi_i &\\mbox{ if } i = j \\\\\n(1-\\pi_i) &\\mbox{ if } i = j + 1 \\\\\n0 &\\mbox{ otherwise }\n\\end{cases},')
('2.1.9.2', 'S_0 = {\\bm s}_0')
('2.1.9.2', 'S_t')
('2.1.9.2', 't')
('2.1.9.2', '\\pi_i \\in \\{0, 1\\}')
('2.1.9.2', 'p_{i,j}')
('2.1.9.2', 'T=3')
('2.1.9.2', '\\mathbf{P}\n\\coloneqq (p_{i,j})_{i,j=0}^T\n\\coloneqq\n\\begin{blockarray}{ccccc}\n& {\\bm s}_0 & {\\bm s}_1 & {\\bm s}_2 & {\\bm s}_3 \\\\\n\\begin{block}{c(cccc)}\n    {\\bm s}_0 & 0 & 1 & 0 & 0 \\\\\n    {\\bm s}_1 & 0 & 0 & 1 & 0 \\\\\n    {\\bm s}_2 & 0 & 0 & 0 & 1 \\\\\n    {\\bm s}_3 & 0 & 0 & 0 & 1 \\\\\n\\end{block}\n\\end{blockarray}.')
('2.1.9.2', '{\\bm r}')
('2.1.9.2', 'I = \\min\\{i \\in \\{1, 2, \\ldots\\} \\ \\mbox{s.t.} \\  S_i = S_{i-1}\\}.')
('2.1.9.2', 'I')
('2.1.9.2', 'S_i')
('2.1.9.2', '\\begin{aligned}\n  {\\bm r}& = \\mathbb{E}[S_I] \\\\\n  & = \\sum_{i=1}^{+\\infty} \\mathbb{P}(I= i) \\mathbb{E}[S_i | I = i]  \\\\\n  & = \\sum_{i=1}^{+\\infty} \\mathbb{P}(I= i) {\\bm s}_{i-1} \\\\\n  & = \\sum_{i=1}^{+\\infty} \\prod_{j=0}^{i-2}(1-\\pi_j) \\pi_{i-1}{\\bm s}_{i-1} \\\\\n  & = \\sum_{i=0}^{+\\infty} \\prod_{j=0}^{i-1}(1-\\pi_j) \\pi_i{\\bm s}_i.\n\\end{aligned}')
('2.1.9.2', 'i')
('2.1.9.2', '0')
('2.1.9.2', '\\infty')
('2.1.9.2', 'T')
('2.1.9.2', '\\pi_i \\coloneqq \\mbox{or}(f({\\bm s}_i), \\mathrm{eq}(i, T)) \\in \\{0,1\\},')
('2.1.9.2', '\\begin{aligned}\n  {\\bm r}& = \\mathbb{E}[S_I] = \\sum_{i=0}^{T} \\prod_{j=0}^{i-1}(1-\\pi_j) \\pi_i{\\bm s}_i.\n\\end{aligned}')
('2.1.9.2', 'T=3')
('2.1.9.2', '\\mathbf{P} =\n\\begin{blockarray}{ccccc}\n& {\\bm s}_0 & {\\bm s}_1 & {\\bm s}_2 & {\\bm s}_3 \\\\\n\\begin{block}{c(cccc)}\n    {\\bm s}_0 & \\pi_0 & 1-\\pi_0 & 0 & 0 \\\\\n    {\\bm s}_1 & 0 & \\pi_1 & 1-\\pi_1 & 0 \\\\\n    {\\bm s}_2 & 0 & 0 & \\pi_2 & 1 - \\pi_2 \\\\\n    {\\bm s}_3 & 0 & 0 & 0 & 1 \\\\\n\\end{block}\n\\end{blockarray}.')
('2.1.9.2.0', 'f({\\bm s}_i) = \\mathrm{step}(\\tau - \\varepsilon({\\bm s}_i))')
('2.1.9.2.0', '\\pi_i \\coloneqq \\mbox{or}(f({\\bm s}_i), \\mathrm{eq}(i, T)) \\in \\{0,1\\}.')
('2.1.9.2.0', '\\mathrm{step}')
('2.1.9.2.0', '\\tau')
('2.1.9.2.0', '0')
('2.1.9.2.0', 'f({\\bm s}_i) = \\mathrm{sigmoid}(\\tau - \\varepsilon({\\bm s}_i))')
('2.1.9.2.0', '\\mathrm{or}')
('2.1.9.2.0', '[0,1] \\times [0,1]')
('2.1.9.2.0', '\\pi_i \\coloneqq \\mathrm{or}(f({\\bm s}_i), \\mathrm{eq}(i, T)) \\in [0,1].')
('2.1.9.2.0', '\\mathrm{sigmoid}')
('2.1.9.2.0', '\\mathrm{sigmoid}= \\mathrm{logistic}')
('2.1.9.2.0', '\\tau')
('2.1.9.2.0', '\\begin{aligned}\n  {\\bm r}= \\mathbb{E}[S_I] \n  & = \\sum_{i=0}^{T} \\prod_{j=0}^{i-1}(1-\\pi_j) \\pi_i{\\bm s}_i \\\\\n  & = \\sum_{i=0}^{T} \\prod_{j=0}^{i-1}(1-\\mathrm{sigmoid}(\\varepsilon({\\bm s}_i) -\\tau))\n  \\mathrm{sigmoid}(\\varepsilon({\\bm s}_i)-\\tau){\\bm s}_i.\n\\end{aligned}')
('2.1.9.2.0', 'T')
('2.1.9.2.0', '1')
('2.2.0', '\\mathcal{V}')
('2.2.0', 'K')
('2.2.0', '\\mathcal{V}')
('2.2.0', 'K')
('2.2.0', '{\\bm l}\\coloneqq ({\\bm l}_1, \\dots, {\\bm l}_K) \\in \\mathcal{L}_{K}(\\mathcal{V})')
('2.2.0', '{\\bm l}_i \\in \\mathcal{V}')
('2.2.0', '\\mathcal{L}_K(\\mathcal{V}) \\coloneqq \\mathcal{V}^K = \\underbrace{\\mathcal{V}\\times \\dots \\times\n\\mathcal{V}}_{K\\text{ times}}.')
('2.2.0.0.0', '{\\bm l}\\in \\mathcal{L}_K(\\mathcal{V})')
('2.2.0.0.0', '\\mathrm{list.get} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times [K] \\to \\mathcal{V}')
('2.2.0.0.0', '\\mathrm{list.get}({\\bm l}, i) \\coloneqq {\\bm l}_i.')
('2.2.0.0.0', '{\\bm l}\\in \\mathcal{L}_K(\\mathcal{V})')
('2.2.0.0.0', 'i \\in [K]')
('2.2.0.0.0', '\\mathcal{V}= \\mathbb{R}')
('2.2.0.0.0', '\\mathcal{L}_K(\\mathcal{V})')
('2.2.0.0.0', '\\mathbb{R}^K')
('2.2.0.0.0', '\\mathrm{list.get}({\\bm l}, i) = \\langle {\\bm l}, {\\bm e}_i \\rangle,')
('2.2.0.0.0', '\\{{\\bm e}_1,\\dots,{\\bm e}_K\\}')
('2.2.0.0.0', '\\mathbb{R}^K')
('2.2.0.0.1', '{\\bm l}\\in \\mathcal{L}_K(\\mathcal{V})')
('2.2.0.0.1', '\\mathrm{list.set} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times [K] \\times \\mathcal{V}\\to \\mathcal{L}_K(\\mathcal{V})')
('2.2.0.0.1', '_j\n\\coloneqq\n\\begin{cases}\n    {\\bm v}&\\mbox{ if } i = j \\\\\n    {\\bm l}_j &\\mbox{ if } i \\neq j\n\\end{cases},')
('2.2.0.0.1', 'j \\in [K]')
('2.2.0.0.1', '{\\bm l}\\in\n\\mathcal{L}_K(\\mathcal{V})')
('2.2.0.0.1', '{\\bm v}\\in \\mathcal{V}')
('2.2.0.0.1', 'i \\in [K]')
('2.2.0.0.1', '\\mathcal{V}= \\mathbb{R}')
('2.2.0.0.1', '{\\bm l}= (l_1,\\dots,l_K)')
('2.2.0.0.1', '\\mathrm{list.set}({\\bm l}, i, v) = (v - l_i) {\\bm e}_i.')
('2.2.0.0.1', 'l_i')
('2.2.0.0.1', 'v')
('2.2.0.0.1', 'i \\in [K]')
('2.2.0.0.2', 'O(1)')
('2.2.0.1', 'K')
('2.2.0.1', '\\mathrm{list.get}')
('2.2.0.1', '\\mathrm{list.set}')
('2.2.0.1.0', '\\mathrm{list.init} \\colon \\mathcal{V}\\to \\mathcal{L}_1(\\mathcal{V})')
('2.2.0.1.0', '\\mathrm{list.init}({\\bm v}) \\coloneqq ({\\bm v}),')
('2.2.0.1.0', '({\\bm v})')
('2.2.0.1.0', '1')
('2.2.0.1.1', '\\mathrm{list.pushLeft} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times \\mathcal{V}\\to \\mathcal{L}_{K+1}(\\mathcal{V})')
('2.2.0.1.1', '\\mathrm{list.pushLeft}({\\bm l}, {\\bm v}) \\coloneqq ({\\bm v}, {\\bm l}_1, \\dots, {\\bm l}_K).')
('2.2.0.1.1', '\\mathrm{list.pushRight} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times \\mathcal{V}\\to \\mathcal{L}_{K+1}(\\mathcal{V})')
('2.2.0.1.1', '\\mathrm{list.pushRight}({\\bm l}, {\\bm v}) \\coloneqq ({\\bm l}_1, \\dots, {\\bm l}_K, {\\bm v}).')
('2.2.0.1.2', '\\mathrm{list.popLeft} \\colon \\mathcal{L}_K(\\mathcal{V}) \\to \\mathcal{L}_{K-1}(\\mathcal{V}) \\times \\mathcal{V}')
('2.2.0.1.2', '\\mathrm{list.popLeft}({\\bm l}) \\coloneqq ({\\bm l}_2, \\dots, {\\bm l}_{K}), {\\bm l}_1')
('2.2.0.1.2', '\\mathrm{list.popRight} \\colon \\mathcal{L}_K(\\mathcal{V}) \\to \\mathcal{L}_{K-1}(\\mathcal{V}) \\times \\mathcal{V}')
('2.2.0.1.2', '\\mathrm{list.popRight}({\\bm l}) \\coloneqq ({\\bm l}_1, \\dots, {\\bm l}_{K-1}), {\\bm l}_K.')
('2.2.0.1.2', '\\mathcal{L}_0(\\mathcal{V})')
('2.2.0.1.3', '1')
('2.2.0.1.3', '\\mathrm{list.insert}: \\mathcal{L}_K(\\mathcal{V}) \\times [K+1] \\times \\mathcal{V}\\rightarrow\n\\mathcal{L}_{K+1}(\\mathcal{V})')
('2.2.0.1.3', '_j\n\\coloneqq\n\\begin{cases}\n{\\bm l}_j & \\mbox{if} \\ j < i \\\\\n{\\bm v}& \\mbox{if} \\ j = i \\\\\n{\\bm l}_{j-1} & \\mbox{if} \\ j > i\n\\end{cases},')
('2.2.0.1.3', 'j \\in [K+1]')
('2.2.0.1.3', '\\mathrm{list.set}')
('2.2.0.1.3', '\\mathrm{list.insert}')
('2.2.0.1.3', '{\\bm l}')
('2.2.0.1.3', '{\\bm v}')
('2.2.0.1.3', 'i')
('2.2.0.1.3', '\\begin{aligned}\n\\mathrm{list.insert}({\\bm l}, 1, {\\bm v}) & = \\mathrm{pushLeft}({\\bm l}, {\\bm v}), \\\\\n\\mathrm{list.insert}({\\bm l}, K+1, {\\bm v}) & = \\mathrm{pushRight}({\\bm l}, {\\bm v}).\n\\end{aligned}')
('2.2.0.1.4', '\\mathrm{list.init}')
('2.2.0.1.4', '\\mathrm{list.push}')
('2.2.0.1.4', '\\mathrm{list.pop}')
('2.2.0.1.4', '\\mathrm{list.set}')
('2.2.0.1.4', '\\mathrm{list.insert}')
('2.2.0.1.4', '{\\bm l}')
('2.2.0.1.4', '{\\bm v}')
('2.2.0.1.4', 'i')
('2.2.0.1.5', 'O(K)')
('2.2.0.1.5', 'O(1)')
('2.2.0.1.6', '\\mathrm{list.pushRight}')
('2.2.0.1.6', '\\mathrm{list.popRight}')
('2.2.0.1.6', '\\mathrm{list.pushLeft}')
('2.2.0.1.6', '\\mathrm{list.popRight}')
('2.2.0.2.0', '\\mathrm{list.get}')
('2.2.0.2.0', 'i \\in [K]')
('2.2.0.2.0', '{\\bm \\pi}_i \\in \\triangle^K')
('2.2.0.2.0', 'i \\in [K]')
('2.2.0.2.0', '{\\bm \\pi}_i \\in \\{{\\bm e}_1, \\dots, {\\bm e}_K\\}')
('2.2.0.2.0', '\\mathrm{list.softGet} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times \\triangle^K \\to \\mathop{\\mathrm{conv}}(\\mathcal{V})')
('2.2.0.2.0', '\\begin{aligned}\n\\mathrm{list.softGet}({\\bm l}, {\\bm \\pi}_i)\n&\\coloneqq \\sum_{j=1}^K \\pi_{i,j} {\\bm l}_j \\\\\n&= \\mathrm{cond}({\\bm \\pi}_i, {\\bm l}_1, \\dots, {\\bm l}_K) \\\\\n&= \\mathbb{E}_{I \\sim \\mathrm{Categorical}({\\bm \\pi}_i)}[{\\bm l}_I],\n\\end{aligned}')
('2.2.0.2.0', '\\mathrm{cond}')
('2.2.0.2.0', '\\mathcal{V}= \\mathbb{R}')
('2.2.0.2.0', '\\mathrm{list.softGet}({\\bm l}, i) = \\langle {\\bm l}, {\\bm \\pi}_i \\rangle.')
('2.2.0.2.0', '{\\bm \\pi}_i = (\\pi_{i,1}, \\dots, \\pi_{i,K})')
('2.2.0.2.0', '({\\bm l}_1,\\dots,{\\bm l}_K)')
('2.2.0.2.0', '{\\bm l}_i')
('2.2.0.2.0', '|i-j|')
('2.2.0.2.0', '{\\bm l}_i')
('2.2.0.2.0', '{\\bm l}_j')
('2.2.0.2.0', 'i')
('2.2.0.2.0', 'i')
('2.2.0.2.0', '{\\bm l}_{i-1}')
('2.2.0.2.0', '{\\bm l}_{i+1}')
('2.2.0.2.0', '1')
('2.2.0.2.0', '{\\bm \\pi}_i \\coloneqq \n\\frac{1}{4} \\cdot {\\bm e}_{i-1} + \\frac{1}{2} {\\bm e}_i + \\frac{1}{4} \\cdot {\\bm e}_{i+1} \\in\n\\triangle^K.')
('2.2.0.2.0', '\\mathrm{list.get}')
('2.2.0.2.0', '\\mathrm{list.softGet}({\\bm l}, {\\bm \\pi}_i) \n= \\left(\\mathrm{list.get}({\\bm l}, \\cdot) \\ast \\kappa\\right)(i)\n= \\sum_{j=-\\infty}^\\infty \\mathrm{list.get}({\\bm l}, i - j) \\kappa(j),')
('2.2.0.2.0', '\\kappa(-1) \\coloneqq \\frac{1}{4}')
('2.2.0.2.0', '\\kappa(1) \\coloneqq \\frac{1}{4}')
('2.2.0.2.0', '\\kappa(0) \\coloneqq \\frac{1}{2}')
('2.2.0.2.0', '\\kappa(j) \\coloneqq 0')
('2.2.0.2.0', 'j \\not \\in\n\\{-1,0,1\\}')
('2.2.0.2.0', '\\mathcal{V}= \\mathbb{R}^M')
('2.2.0.2.0', '\\mathrm{list.softGet}')
('2.2.0.2.0', 'O(M \\cdot |\\mathrm{supp}({\\bm \\pi}_i)|)')
('2.2.0.2.0', '\\mathrm{list.get}({\\bm l}, i)')
('2.2.0.2.0', '{\\bm l}')
('2.2.0.2.0', 'i')
('2.2.0.2.0', '\\mathrm{list.sofGet}({\\bm l}, {\\bm \\pi}_i)')
('2.2.0.2.0', '{\\bm l}')
('2.2.0.2.0', '{\\bm \\pi}_i')
('2.2.0.2.0', '\\mathcal{V}=\\mathbb{R}')
('2.2.0.2.0', '\\mathrm{list.softGet}({\\bm l}, {\\bm \\pi}_i)')
('2.2.0.2.0', '{\\bm l}')
('2.2.0.2.0', '{\\bm \\pi}_i')
('2.2.0.2.0', '{\\bm e}_i')
('2.2.0.2.1', '\\mathrm{list.softSet} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times \\triangle^K \\times \\mathcal{V}\\to \n\\mathcal{L}_K(\\mathop{\\mathrm{conv}}(\\mathcal{V}))')
('2.2.0.2.1', '\\begin{aligned}\n\\left[\\mathrm{list.softSet}({\\bm l}, {\\bm \\pi}_i, {\\bm v})\\right]_j\n&\\coloneqq \n\\mathbb{E}[\\mathrm{list.set}({\\bm l}, I, {\\bm v})]_j \\\\\n&= \\mathbb{P}(I=j) {\\bm v}+ \\mathbb{P}(I \\neq j) {\\bm l}_j \\\\\n&= \\pi_{i,j} {\\bm v}+ (1 - \\pi_{i,j}) {\\bm l}_j,\n\\end{aligned}')
('2.2.0.2.1', 'j \\in [K]')
('2.2.0.2.1', 'I \\sim \\mathrm{Categorical}({\\bm \\pi}_i)')
('2.2.0.2.1', '\\begin{aligned}\n\\mathrm{list.softSet}({\\bm l}, {\\bm \\pi}_i, {\\bm v})\n&= (\\pi_{i,1} {\\bm v}+ (1-\\pi_{i,1}) {\\bm l}_1,\n\\dots,\n\\pi_{1,K} {\\bm v}+ (1-\\pi_{1,K}) {\\bm l}_K) \\\\\n&=\n(\\mathrm{ifelse}(\\pi_{i,1}, {\\bm v}, {\\bm l}_1),\n\\dots,\n\\mathrm{ifelse}(\\pi_{i,K}, {\\bm v}, {\\bm l}_K)),\n\\end{aligned}')
('2.2.0.2.1', '\\mathrm{ifelse}')
('2.2.0.2.1', '\\mathrm{ifelse}(\\pi, {\\bm u}_1, {\\bm u}_0)\n= \\mathbb{E}_{I \\sim \\mathrm{Bernouilli}(\\pi)}[{\\bm u}_I],')
('2.2.0.2.1', '\\mathrm{list.softSet}')
('2.2.0.2.1', '\\mathop{\\mathrm{conv}}(\\mathcal{V})')
('2.2.0.2.1', '\\mathcal{V}')
('2.2.0.2.1', '\\mathcal{V}= \\mathbb{R}^M')
('2.2.0.2.1', '\\mathop{\\mathrm{conv}}(\\mathcal{V}) = \\mathbb{R}^M')
('2.2.0.2.2', '\\mathrm{list.softInsert} \\colon \\mathcal{L}_K(\\mathcal{V}) \\times \\triangle^{K+1} \\times \\mathcal{V}\n\\to \\mathcal{L}_{K+1}(\\mathop{\\mathrm{conv}}(\\mathcal{V}))')
('2.2.0.2.2', '\\begin{aligned}\n_j \n&\\coloneqq \\mathbb{E}[\\mathrm{list.insert}({\\bm l}, I, {\\bm v})] \\\\\n& = \\mathbb{P}(I > j) {\\bm l}_j + \\mathbb{P}(I = j) {\\bm v}+ \\mathbb{P}(I < j) {\\bm l}_{j-1},\n\\end{aligned}')
('2.2.0.2.2', 'I \\sim \\mathrm{Categorical}({\\bm \\pi}_i)')
('2.2.0.2.2', 'j \\in [K+1]')
('2.2.0.2.2', '\\begin{aligned}\n    \\mathbb{P}(I > j) &= \n\\begin{cases}\n    0 &\\mbox{ if } j = K+1 \\\\\n    \\sum_{k=j+1}^{K+1} \\pi_{i, k} &\\mbox{ otherwise }\n\\end{cases} \\\\\n    P(I = j) &= \\pi_{i,j} \\quad  \\\\\n    \\mathbb{P}(I < j) &= \n\\begin{cases}\n    0 &\\mbox{ if } j = 1 \\\\\n    \\sum_{k=1}^{j-1} \\pi_{i, k} &\\mbox{ otherwise }\n\\end{cases}.\n\\end{aligned}')
('2.2.0.2.3', '{\\bm l}_{\\bm i}\\in \\mathcal{V}')
('2.2.0.2.3', '{\\bm l}\\in \\mathcal{L}_{K_1,\\dots,K_T}(\\mathcal{V})')
('2.2.0.2.3', '{\\bm i}= (i_1, \\dots, i_T) \\in [K_1] \\times \\dots \\times [K_T]')
('2.2.0.2.3', 'T \\in \\mathbb{N}')
('2.2.0.2.3', '{\\bm l}')
('2.2.0.2.3', '{\\bm i}\\in [K_1] \\times \\dots \\times [K_T]')
('2.2.0.2.3', 'i \\in [K_1 \\dots K_T]')
('2.2.0.2.3', '[K]')
('2.2.0.2.3', '[K_1] \\times \\dots \\times [K_T]')
('2.2.0.2.3', 'K \\coloneqq K_1 \\dots K_T')
('2.2.0.2.3', '{\\bm \\pi}_{\\bm i}\\in\n\\triangle^{K_1 \\times \\dots \\times K_T}')
('2.2.0.2.3', '{\\bm i}')
('2.2.1', '\\mathcal{K}')
('2.2.1', '\\mathcal{V}')
('2.2.1', 'L')
('2.2.1', '\\mathcal{K}')
('2.2.1', '\\mathcal{V}')
('2.2.1', '\\mathcal{D}_L(\\mathcal{K},\\mathcal{V}) \n\\coloneqq \\mathcal{L}_L(\\mathcal{K}\\times \\mathcal{V})\n= (\\mathcal{K}\\times \\mathcal{V})^L')
('2.2.1', '{\\bm d}\\coloneqq (({\\bm k}_1,{\\bm v}_1), \\dots, ({\\bm k}_L,{\\bm v}_L)) \\in \\mathcal{D}_L(\\mathcal{K},\\mathcal{V}).')
('2.2.1.0.0', '\\mathrm{dict.get}')
('2.2.1.0.0', '\\mathrm{dict.get} \\colon \\mathcal{D}_L(\\mathcal{K},\\mathcal{V}) \\times \\mathcal{K}\\to \\mathcal{V}\\cup \\{\\infty\\}')
('2.2.1.0.0', '\\mathrm{dict.get}({\\bm d}, {\\bm k})\n\\coloneqq \n\\begin{cases}\n    {\\bm v}_i &\\mbox{ if } \\exists i \\in [L] \\text{ s.t. } {\\bm k}= {\\bm k}_i \\\\\n    \\infty & \\mbox{ if } {\\bm k}\\not \\in \\{{\\bm k}_1,\\dots,{\\bm k}_L\\}\n\\end{cases}.')
('2.2.1.0.0', '{\\bm d}')
('2.2.1.0.0', '{\\bm k}')
('2.2.1.0.0', '\\begin{aligned}\n\\mathrm{dict.get}({\\bm d}, {\\bm k}) \\coloneqq \n\\frac{\\sum_{i=1}^L \\mathrm{eq}({\\bm k}, {\\bm k}_i) {\\bm v}_i}\n{\\sum_{i=1}^L \\mathrm{eq}({\\bm k}, {\\bm k}_i)}.\n\\end{aligned}')
('2.2.1.0.0', '{\\bm d}')
('2.2.1.0.0', '{\\bm k}')
('2.2.1.0.0', '{\\bm k}\\in \\{{\\bm k}_1,\\dots,{\\bm k}_L\\}')
('2.2.1.0.0', '\\mathcal{V}= \\mathbb{R}^M')
('2.2.1.0.0', '\\mathrm{dict.get}({\\bm d}, {\\bm k}) = {\\bm v}_i\n\\quad \\text{where} \\quad\ni = \\mathop{\\mathrm{arg\\,max}}_{j \\in [L]} \\|{\\bm k}- {\\bm k}_j\\|_2,')
('2.2.1.0.0', '\\mathrm{dict.get}')
('2.2.1.0.1', '\\mathrm{dict.set}')
('2.2.1.0.1', '\\mathrm{dict.set}: \\mathcal{D}_L(\\mathcal{K}, \\mathcal{V}) \\times \\mathcal{K}\\times \\mathcal{V}\n\\rightarrow \\mathcal{D}_L(\\mathcal{K}, \\mathcal{V})')
('2.2.1.0.1', '(\\mathrm{dict.set}({\\bm d}, {\\bm k}, {\\bm v}))_i \\coloneqq\n  \\begin{cases}\n    ({\\bm k}_i, {\\bm v}) & \\mbox{if} \\ {\\bm k}_i = {\\bm k}\\\\\n    ({\\bm k}_i, {\\bm v}_i) & \\mbox{if} \\ {\\bm k}_i \\neq {\\bm k}\n  \\end{cases}.')
('2.2.1.0.1', '{\\bm k}')
('2.2.1.0.1', '{\\bm d}')
('2.2.1.0.1', '{\\bm v}')
('2.2.1.0.1', '{\\bm k}')
('2.2.1.1', '({\\bm k}_i,{\\bm v}_i) \\in \\mathcal{K}\\times \\mathcal{V}')
('2.2.1.1', '{\\bm d}')
('2.2.1.1', '\\mathcal{K}')
('2.2.1.1', '\\mathcal{V}')
('2.2.1.1', '\\mathcal{K}= \\mathcal{V}= \\mathbb{R}')
('2.2.1.1', '{\\bm v}')
('2.2.1.1', '{\\bm k}')
('2.2.1.1', 'K')
('2.2.1.1', 'V')
('2.2.1.1', 'f({\\bm v}|{\\bm k})')
('2.2.1.1', 'V|K')
('2.2.1.1', 'f({\\bm k}, {\\bm v})')
('2.2.1.1', '(K,V)')
('2.2.1.1', 'f({\\bm k})')
('2.2.1.1', 'K')
('2.2.1.1', 'f({\\bm v}|{\\bm k}) = \\frac{f({\\bm k}, {\\bm v})}{f({\\bm k})}.')
('2.2.1.1', '\\begin{aligned}\n\\mathbb{E}[V | K={\\bm k}] \n= \\int_{\\mathcal{V}} f({\\bm v}|{\\bm k}) {\\bm v}d{\\bm v}\n= \\int_{\\mathcal{V}} \\frac{f({\\bm k}, {\\bm v})}{f({\\bm k})} {\\bm v}d{\\bm v}.\n\\end{aligned}')
('2.2.1.1', '\\mathbb{E}[V|K]')
('2.2.1.1', '\\mathbb{E}[(h(K) - V)^2]')
('2.2.1.1', 'h \\colon \\mathcal{K}\\to\n\\mathcal{V}')
('2.2.1.1', 'L')
('2.2.1.1', '({\\bm k}_i, {\\bm v}_i)')
('2.2.1.1', '\\kappa_\\sigma')
('2.2.1.1', '\\rho_\\sigma')
('2.2.1.1', '\\widehat{f}_\\sigma({\\bm k}, {\\bm v}) \n\\coloneqq \\frac{1}{L} \\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i) \n\\rho_\\sigma({\\bm v}- {\\bm v}_i).')
('2.2.1.1', '\\begin{aligned}\n\\widehat{f}_\\sigma({\\bm k}) \n&\\coloneqq \n\\int_{\\mathcal{V}} \\widehat{f}_\\sigma({\\bm k}, {\\bm v})d{\\bm v}\\\\\n&=\n\\frac{1}{L} \\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i) \\int_{\\mathcal{V}} \\rho_\\sigma({\\bm v}-\n{\\bm v}_i) d{\\bm v}\\\\\n&=\\frac{1}{L} \\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i).\n\\end{aligned}')
('2.2.1.1', 'f')
('2.2.1.1', '\\widehat{f}_\\sigma')
('2.2.1.1', '\\begin{aligned}\n\\widehat{\\mathbb{E}}[V|K={\\bm k}]\n&\\coloneqq \\int_{\\mathcal{V}} \\frac{\\widehat{f}_\\sigma({\\bm k}, {\\bm v})}{\\widehat{f}_\\sigma({\\bm k})} {\\bm v}d{\\bm v}\\\\\n&= \\int_{\\mathcal{V}} \\frac{\\frac{1}{L} \\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i) \n\\rho_\\sigma({\\bm v}- {\\bm v}_i)}{\\frac{1}{L} \\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i)} {\\bm v}d{\\bm v}\\\\\n&=  \\frac{\\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i)\n\\int_{\\mathcal{V}} \\rho_\\sigma({\\bm v}- {\\bm v}_i) {\\bm v}d{\\bm v}}{\\sum_{i=1}^L \\kappa_\\sigma({\\bm k}-\n{\\bm k}_i)} \\\\\n&=  \\frac{\\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i) {\\bm v}_i}{\\sum_{i=1}^L\n\\kappa_\\sigma({\\bm k}- {\\bm k}_i)}.\n\\end{aligned}')
('2.2.1.1', '\\rho_\\sigma({\\bm v}- {\\bm v}_i) = p_{{\\bm v}_i,\\sigma}({\\bm v})')
('2.2.1.1', 'p_{{\\bm v}_i,\\sigma}({\\bm v})')
('2.2.1.1', '{\\bm v}_i')
('2.2.1.1', '\\int_{\\mathcal{V}} \\rho_\\sigma({\\bm v}- {\\bm v}_i){\\bm v}d{\\bm v}\n= \\mathbb{E}_{V \\sim p_{{\\bm v}_i,\\sigma}}[V] \n= {\\bm v}_i.')
('2.2.1.1', '{\\bm d}= (({\\bm k}_1,{\\bm v}_1),\\dots,({\\bm k}_L,{\\bm v}_L))')
('2.2.1.1', '\\mathrm{dict.softGet} \\colon \\mathcal{D}_L(\\mathcal{K}, \\mathcal{V}) \\times \\mathcal{K}\\to \\mathop{\\mathrm{conv}}(\\mathcal{V})')
('2.2.1.1', '\\mathrm{dict.softGet}({\\bm d}, {\\bm k}) \n\\coloneqq \\frac{\\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i) {\\bm v}_i}{\n\\sum_{i=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_i)}.')
('2.2.1.1', '\\mathcal{K}= \\mathcal{V}= \\mathbb{R}')
('2.2.1.2', '\\mathcal{K}')
('2.2.1.2', '\\{{\\bm k}_1,\\dots,{\\bm k}_L\\} \\subset \\mathcal{K}')
('2.2.1.2', '{\\bm d}= (({\\bm k}_1,{\\bm v}_1),\\dots,({\\bm k}_L,{\\bm v}_L))')
('2.2.1.2', '{\\bm k}')
('2.2.1.2', '{\\bm \\pi}_{\\bm k}= (\\pi_{{\\bm k},1},\\dots,\\pi_{{\\bm k},L}) \\in \\triangle^L')
('2.2.1.2', '({\\bm k}_1,\\dots,{\\bm k}_L)')
('2.2.1.2', '{\\bm d}')
('2.2.1.2', '\\pi_{{\\bm k},i} \\coloneqq\n\\frac{\\kappa_\\sigma({\\bm k}- {\\bm k}_i)}{\\sum_{j=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_j)}\n\\quad \\forall i \\in [L].')
('2.2.1.2', '{\\bm k}')
('2.2.1.2', '({\\bm k}_1,\\dots,{\\bm k}_L)')
('2.2.1.2', '{\\bm d}')
('2.2.1.2', '\\begin{aligned}\n\\mathrm{dict.softGet}({\\bm d}, {\\bm k}) \n&= \\mathbb{E}_{i \\sim \\mathrm{Categorical}({\\bm \\pi}_{\\bm k})}[{\\bm v}_i] \\\\\n&= \\sum_{i=1}^L \\pi_{{\\bm k},i} {\\bm v}_i.\n\\end{aligned}')
('2.2.1.2', '\\sigma \\to\n0')
('2.2.1.2', '\\mathrm{dict.get}({\\bm d}, {\\bm k}) =\n\\frac{\\sum_{i=1}^L \\mathrm{eq}({\\bm k},{\\bm k}_i) {\\bm v}_i}{\\sum_{i=1}^L\n\\mathrm{eq}({\\bm k},{\\bm k}_i)}.')
('2.2.1.2', '\\mathrm{dict.softGet}')
('2.2.1.2', '\\kappa_\\sigma')
('2.2.1.2', '{\\bm \\pi}_{\\bm k}= (\\pi_{{\\bm k},1},\\dots,\\pi_{{\\bm k},L}) \\in \\triangle^L')
('2.2.1.2', '({\\bm k}_1,\\dots,{\\bm k}_L)')
('2.2.1.2', '{\\bm k}')
('2.2.1.2', '\\mathrm{dict.softGet}')
('2.2.1.2', '({\\bm v}_1,\\dots,{\\bm v}_L)')
('2.2.1.2', '(\\pi_{{\\bm k},1},\\dots,\\pi_{{\\bm k},L})')
('2.2.1.2', '\\mathrm{dict.get}')
('2.2.1.2', '{\\bm k}\\in \\{{\\bm k}_1,\\dots,{\\bm k}_L\\}')
('2.2.1.2', '[L]')
('2.2.1.2', '\\mathrm{dict.softGet}')
('2.2.1.2', '{\\bm k}\\in \\{{\\bm k}_1,\\dots,{\\bm k}_L\\}')
('2.2.1.2', '{\\bm \\pi}_{{\\bm k}} \\in \\triangle^L')
('2.2.1.2', '{\\bm k}')
('2.2.1.2', '\\mathrm{list.softSet}({\\bm d}, {\\bm \\pi}_{\\bm k}, ({\\bm k}, {\\bm v})).')
('2.2.1.2', '\\mathrm{dict.set}')
('2.2.1.2', '{\\bm \\pi}_{\\bm k}')
('2.2.1.3', '\\kappa_\\sigma')
('2.2.1.3', '\\begin{aligned}\n\\kappa_\\sigma({\\bm k}- {\\bm k}_i)\n&= \\exp(-\\|{\\bm k}- {\\bm k}_i\\|^2_2 / (2\\sigma^2)) \\\\\n&= \\exp(-(\\|{\\bm k}\\|^2_2 + \\|{\\bm k}_i\\|^2) / (2\\sigma^2))\n\\exp(\\langle {\\bm k}, {\\bm k}_i \\rangle / \\sigma^2) \\\\\n&= \\exp(-\\sigma^2)\n\\exp(\\langle {\\bm k}, {\\bm k}_i \\rangle / \\sigma^2)\n\\end{aligned}')
('2.2.1.3', '\\begin{aligned}\n\\pi_{{\\bm k},i}\n&= \\frac{\\kappa_\\sigma({\\bm k}- {\\bm k}_i)}{\\sum_{j=1}^L \\kappa_\\sigma({\\bm k}- {\\bm k}_j)}\\\\\n&= \\frac{\\exp(\\langle {\\bm k}, {\\bm k}_i \\rangle / \\sigma^2)}{\n\\sum_{j=1}^L \\exp(\\langle {\\bm k}, {\\bm k}_j \\rangle / \\sigma^2)}.\n\\end{aligned}')
('2.2.1.3', '{\\bm d}= (({\\bm k}_1,{\\bm v}_1), \\dots, ({\\bm k}_L,{\\bm v}_L))')
('2.2.1.3', '\\mathrm{dict.softGet}({\\bm d}, {\\bm k}) \n= \\frac{\\exp(\\langle {\\bm k}, {\\bm k}_i \\rangle / \\sigma^2) {\\bm v}_i}{\n\\sum_{j=1}^L \\exp(\\langle {\\bm k}, {\\bm k}_j \\rangle / \\sigma^2)}.')
('2.2.2', '\\mathrm{list.get}')
('2.2.2', '\\mathrm{dict.get}')
('3.0', '\\partial f({\\bm w})[{\\bm v}]')
('3.0', 'f\n\\colon \\mathcal{E}\\to \\mathcal{F}')
('3.0', '{\\bm w}\\in \\mathcal{E}')
('3.0', '{\\bm v}\\in\n\\mathcal{E}')
('3.0.0', '\\partial f({\\bm w})[{\\bm v}] \n\\coloneqq \n\\lim_{\\delta \\rightarrow 0} \\frac{f({\\bm w}+ \\delta{\\bm v}) -f({\\bm w})}{\\delta}.')
('3.0.0', '\\partial f({\\bm w})[{\\bm v}] \n\\approx\n\\frac{f({\\bm w}+ \\delta{\\bm v}) -f({\\bm w})}{\\delta},')
('3.0.0', '0 < \\delta \\ll 1')
('3.0.0', 'f({\\bm w}+\\delta{\\bm v}) - f({\\bm w})\n=\n\\delta \\partial f({\\bm w})[{\\bm v}] \n+ \\frac{\\delta^2}{2} \\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}]\n+ \\frac{\\delta^3}{3!} \\partial^3 f({\\bm w})[{\\bm v}, {\\bm v}, {\\bm v}]\n+ \\dots')
('3.0.0', '\\begin{aligned}\n\\frac{f({\\bm w}+\\delta{\\bm v}) - f({\\bm w})}{\\delta}\n&=\n\\partial f({\\bm w})[{\\bm v}] \n+ \\frac{\\delta}{2} \\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}]\n+ \\frac{\\delta^2}{3!} \\partial^3 f({\\bm w})[{\\bm v}, {\\bm v}, {\\bm v}]\n+ \\dots \\\\\n&=\n\\partial f({\\bm w})[{\\bm v}] + o(\\delta).\n\\end{aligned}')
('3.0.0', '\\delta')
('3.0.0', 'o(\\delta)')
('3.0.0', '\\delta')
('3.0.0', 'f')
('3.0.0', 'f')
('3.0.0', 'f')
('3.0.0', '\\tilde{f}')
('3.0.0', '\\tilde{f}(w) \\approx [f(w)/\\varepsilon] \\varepsilon')
('3.0.0', '[f(w)/\\varepsilon]')
('3.0.0', 'f(w)/\\varepsilon \\in \\mathbb{R}')
('3.0.0', '\\varepsilon')
('3.0.0', 'f({\\bm w}+\\delta{\\bm v}) - f({\\bm w})')
('3.0.0', 'o(\\varepsilon)')
('3.0.0', 'f(x) \\coloneqq \\mathrm{softplus}(x) = \\log(1+\\exp(x))')
('3.0.0', "f'(x) = \\mathrm{logistic}(x)")
('3.0.0', 'x=1')
('3.0.0', '\\delta')
('3.0.0', '\\delta')
('3.0.1', '\\partial f({\\bm w})[{\\bm v}] \n\\approx\n\\frac{f({\\bm w}) - f({\\bm w}- \\delta{\\bm v})}{\\delta},')
('3.0.1', '0 < \\delta \\ll 1')
('3.0.1', '(f({\\bm w}) - f({\\bm w}-\\delta{\\bm v}))/\\delta = \\partial\nf({\\bm w})[{\\bm v}] + o(\\delta)')
('3.0.2', '\\partial f({\\bm w})[{\\bm v}] \n\\approx\n\\frac{f({\\bm w}+ \\delta{\\bm v}) - f({\\bm w}-\\delta{\\bm v})}{2\\delta},')
('3.0.2', '0 < \\delta \\ll 1')
('3.0.2', '\\begin{aligned}\nf({\\bm w}+\\delta{\\bm v}) - f({\\bm w}-\\delta{\\bm v})\n=& \n2\\delta \\partial f({\\bm w})[{\\bm v}] \n+ \\frac{2\\delta^3}{3!} \\partial^3 f({\\bm w})[{\\bm v}, {\\bm v}, {\\bm v}] \\\\\n &+ \\frac{2\\delta^5}{5!} \\partial^5 f({\\bm w})[{\\bm v}, \\dots, {\\bm v}] + \\dots\n\\end{aligned}')
('3.0.2', '\\begin{aligned}\n\\frac{f({\\bm w}+\\delta{\\bm v}) - f({\\bm w}-\\delta{\\bm v})}{2\\delta}\n=& \n\\partial f({\\bm w})[{\\bm v}] \n+ \\frac{\\delta^2}{3!} \\partial^3 f({\\bm w})[{\\bm v}, {\\bm v}, {\\bm v}] + \\ldots\\\\\n=& \\partial f({\\bm w})[{\\bm v}] + o(\\delta^2).\n\\end{aligned}')
('3.0.2', 'o(\\delta^2)')
('3.0.2', '\\delta<1')
('3.0.3', '\\partial f({\\bm w})[{\\bm v}] \\approx \\sum_{i=0}^p \\frac{a_i}{\\delta} f({\\bm w}+ i\\delta {\\bm v})')
('3.0.3', 'p+1')
('3.0.3', 'a_i')
('3.0.3', 'o(\\delta^p)')
('3.0.3', '\\begin{aligned}\n  \\sum_{k=0}^p \\frac{a_i}{\\delta} f({\\bm w}+ i\\delta {\\bm v}) \n  & = \\sum_{k=0}^p a_i \\sum_{j=0}^p \n  \\frac{i^j\\delta^{j-1}}{j!} \\partial^j f({\\bm w})[{\\bm v}, \\ldots, {\\bm v}] + o(\\delta^p).\n\\end{aligned}')
('3.0.3', 'p+1')
('3.0.3', 'p+1')
('3.0.3', 'a_0, \\ldots, a_p')
('3.0.3', '\\begin{aligned}\n  a_0 + a_1 + \\ldots + a_p & = 0 \\\\\n  a_1 + 2 a_2 + \\ldots + p a_p & = 1 \\\\\n  a_1 + 2^j a_2 + \\ldots + p^j a_p & = 0 \\quad \\forall j \\in \\{2, \\ldots, p\\}.\n\\end{aligned}')
('3.0.3', '\\partial f({\\bm w})[{\\bm v}] \\approx \\sum_{i=0}^p \\frac{a_i}{\\delta} f({\\bm w}- i\\delta\n{\\bm v})')
('3.0.3', '\\partial f({\\bm w})[{\\bm v}] \\approx \\sum_{i=-p}^p \\frac{a_i}{\\delta} f({\\bm w}+ i\\delta {\\bm v}),')
('3.0.3', 'o(\\delta^{2p})')
('3.0.3', 'a_{-p}, \\ldots, a_p')
('3.0.3', 'a_0 = 0')
('3.0.3', '2p')
('3.0.4', 'k')
('3.0.4', '\\partial^k f({\\bm w})[{\\bm v}, \\ldots, {\\bm v}] \n  \\approx \\sum_{i=0}^p \\frac{a_i}{\\delta^k}f({\\bm w}+ i \\delta {\\bm v}).')
('3.0.4', 'k')
('3.0.4', 'a_i')
('3.0.4', '\\begin{aligned}\n  0^j a_0 + 1^j a_1 + 2^j a_2 + \\ldots + p^j a_p & = 0 \\quad \\forall j \\in \\{0, \\ldots, k-1\\}. \\\\\n  0^k a_0 + 1^k a_1 + 2^k a_2 + \\ldots + p^k a_p & = k! \\\\\n  0^j a_0 + 1^j a_1 + 2^j a_2 + \\ldots + p^j a_p & = 0 \\quad \\forall j \\in \\{k+1, \\ldots, p\\}.\n\\end{aligned}')
('3.0.4', 'o(\\delta^{p - k +1})')
('3.0.4', 'p+1')
('3.0.4', 'p=k=2')
('3.0.4', '\\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}] \n  \\approx \\frac{-(3/2)f({\\bm x}) +2 f({\\bm x}+ \\delta {\\bm v}) - (1/2) f({\\bm x}+ 2\\delta {\\bm v})}{\\delta^2},')
('3.0.4', 'o(\\delta)')
('3.0.4', '\\partial^k f({\\bm w})[{\\bm v}, \\ldots, {\\bm v}] \n  \\approx \\sum_{i=-p}^p \\frac{a_i}{\\delta^k} f({\\bm w}+ i\\delta {\\bm v}),')
('3.0.4', 'o(\\delta^{2p +2 - 2\\lceil (k+1)/2\\rceil})')
('3.0.4', 'k=2')
('3.0.4', 'p=1')
('3.0.4', '\\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}] \n  \\approx \\frac{f({\\bm w}+\\delta{\\bm v}) + f({\\bm w}-\\delta{\\bm v}) - 2f({\\bm w})}{\\delta^2}.')
('3.0.4', 'o(\\delta^2)')
('3.0.4', '3')
('3.0.5', 'f')
('3.0.5', '\\mathbb{C}^P')
('3.0.5', 'P')
('3.0.5', 'i = \\sqrt{-1}')
('3.0.5', 'f')
('3.0.5', '\\begin{aligned}\nf({\\bm w}+(i \\delta){\\bm v}) \n=&\nf({\\bm w})\n+\n(i\\delta) \\partial f({\\bm w})[{\\bm v}] \n+ \\frac{(i\\delta)^2}{2} \\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}] \\\\\n &+ \\frac{(i\\delta)^3}{3!} \\partial^3 f({\\bm w})[{\\bm v}, {\\bm v}, {\\bm v}]\n+ \\dots \\\\\n=&\nf({\\bm w})\n+\n(i\\delta) \\partial f({\\bm w})[{\\bm v}] \n- \\frac{\\delta^2}{2} \\partial^2 f({\\bm w})[{\\bm v}, {\\bm v}] \\\\\n &- \\frac{i(\\delta)^3}{3!} \\partial^3 f({\\bm w})[{\\bm v}, {\\bm v}, {\\bm v}]\n+ \\dots \\quad .\n\\end{aligned}')
('3.0.5', '\\operatorname{Re}(f({\\bm w}+(i \\delta){\\bm v}))\n= f({\\bm w}) + o(\\delta^2)')
('3.0.5', '\\operatorname{Im}\\left(\\frac{f({\\bm w}+(i \\delta){\\bm v})}{\\delta}\\right)\n= \\partial f({\\bm w})[{\\bm v}] + o(\\delta^2).')
('3.0.5', '\\partial f({\\bm w})[{\\bm v}]\n\\approx\n\\operatorname{Im}\\left(\\frac{f({\\bm w}+(i \\delta){\\bm v})}{\\delta}\\right),')
('3.0.5', '0 < \\delta \\ll 1')
('3.0.5', 'f')
('3.0.6', 'M=1')
('3.0.6', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}')
('3.0.6', '\\partial f({\\bm w})[{\\bm v}]')
('3.0.6', '{\\bm v}')
('3.0.6', 'f')
('3.0.6', '\\nabla f({\\bm w})')
('3.0.6', '_j \n= \\langle \\nabla f({\\bm w}), {\\bm e}_j \\rangle = \\partial f({\\bm w})[{\\bm e}_j],')
('3.0.6', 'j \\in [P]')
('3.0.6', 'P+1')
('3.0.6', '2P')
('3.0.6', 'P')
('3.0.6', 'f \\colon\n\\mathbb{R}^P \\to \\mathbb{R}')
('3.0.6', '2')
('3.0.6', 'P+1')
('3.0.6', '2')
('3.0.6', 'P+1')
('3.0.6', '2')
('3.0.6', '2P')
('3.0.6', '1')
('3.0.6', 'P')
('3.1.0', 'f \\colon \\mathcal{S}_0\n\\to \\mathcal{S}_K')
('3.1.0', 'f \\coloneqq f_K \\circ \\dots\n\\circ f_1')
('3.1.0', 'f_k \\colon \\mathcal{S}_{k-1} \\to \\mathcal{S}_k')
('3.1.0', 'f')
('3.1.0', '\\begin{aligned}\n\t{\\bm s}_0 &\\in \\mathcal{S}_0\\nonumber \\\\\n\t{\\bm s}_1 &\\coloneqq f_1({\\bm s}_0) \\in \\mathcal{S}_1 \\nonumber\\\\ \n\t\t & \\hspace{6pt} \\vdots \\nonumber\\\\\n\t{\\bm s}_K &\\coloneqq f_K({\\bm s}_{K-1}) \\in \\mathcal{S}_K \\nonumber\\\\\n\tf({\\bm s}_0) &\\coloneqq {\\bm s}_K. \\label{auto_diff:eq:chain}\n\\end{aligned}')
('3.1.0', 'f')
('3.1.0', '{\\bm s}_0')
('3.1.0', '{\\bm s}_0')
('3.1.0', '{\\bm w}')
('3.1.0.0', '\\bm \\partial f({\\bm s}_0)')
('3.1.0.0', '\\bm{\\partial}')
('3.1.0.0', '\\bm \\partial f({\\bm s}_0) = \n    \\bm \\partial f_K({\\bm s}_{K-1}) \n    \\bm \\partial f_{K-1}({\\bm s}_{K-2}) \n    \\ldots \n    \\bm \\partial f_2({\\bm s}_1)\n    \\bm \\partial f_1({\\bm s}_0),\n    \\label{auto_diff:eq:chain_full_jac}')
('3.1.0.0', '\\bm \\partial f_k({\\bm s}_{k-1})')
('3.1.0.0', '{\\bm s}_0, \\ldots, {\\bm s}_K')
('3.1.0.0', '\\bm \\partial f({\\bm s}_0)')
('3.1.0.0', '\\bm \\partial f({\\bm s}_0)')
('3.1.0.1', '\\partial f({\\bm s}_0)')
('3.1.0.1', '\\partial')
('3.1.0.1', '\\partial f({\\bm s}_0)')
('3.1.0.1', '\\partial f({\\bm s}_0) \n= \n\\partial f_K({\\bm s}_{K-1}) \n\\circ \n\\partial f_{K-1}({\\bm s}_{K-2}) \n\\circ \n\\ldots \n\\circ \n\\partial f_2({\\bm s}_1)\n\\circ\n\\partial f_1({\\bm s}_0).')
('3.1.0.1', '\\partial f({\\bm s}_0)')
('3.1.0.1', '{\\bm v}\\in \\mathcal{S}_0')
('3.1.0.1', '\\begin{aligned}\n\t{\\bm t}_0 & \\coloneqq {\\bm v}\\\\\n\t{\\bm t}_1 & \\coloneqq \\partial f_1({\\bm s}_0)[{\\bm t}_0] \\\\\n\t& \\hspace{6pt} \\vdots\\\\\n\t{\\bm t}_K & \\coloneqq \\partial f_K({\\bm s}_{K-1})[{\\bm t}_{K-1}]\\\\\n\t\\partial f({\\bm s}_0)[{\\bm v}] &\\coloneqq {\\bm t}_K. \n\\end{aligned}')
('3.1.0.1', '\\partial f_k({\\bm s}_{k-1})[{\\bm t}_{k-1}]')
('3.1.0.1', '{\\bm s}_k')
('3.1.0.1', '\\partial f_k: \n        {\\bm s}_{k-1}, {\\bm t}_{k-1} \\mapsto \n        \\partial f_k({\\bm s}_{k-1})[{\\bm t}_{k-1}]')
('3.1.0.1', '\\partial f_k({\\bm s}_{k-1})[{\\bm t}_{k-1}]= {\\bm t}_k')
('3.1.0.1', 'f \\coloneqq f_K \\circ \\ldots \\circ f_1')
('3.1.0.1', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.0.1', '{\\bm v}\n\\in \\mathcal{S}_0')
('3.1.0.1', '{\\bm t}_0 \\coloneqq {\\bm v}')
('3.1.0.1', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{k-1}) \\in \\mathcal{S}_k')
('3.1.0.1', '{\\bm t}_k \\coloneqq \\partial f_k({\\bm s}_{k-1})[{\\bm t}_{k-1}] \\in \\mathcal{S}_k')
('3.1.0.1', 'f({\\bm s}_0) \\coloneqq {\\bm s}_K')
('3.1.0.1', '\\partial f({\\bm s}_0)[{\\bm v}] = {\\bm t}_K')
('3.1.0.1.0', 'f')
('3.1.0.1.0', '{\\bm t}_k')
('3.1.0.1.0', '\\partial f_k')
('3.1.0.1.0', 'f_k')
('3.1.0.1.0', 'f')
('3.1.0.1.0.0', 'f = f_K \\circ \\dots \\circ f_1')
('3.1.0.1.0.0', 'k')
('3.1.0.1.0.0', '{\\bm s}_{k-1}')
('3.1.0.1.0.0', '{\\bm s}_k')
('3.1.0.1.0.0', '{\\bm s}_{k-1}')
('3.1.0.1.0.0', '{\\bm s}_k')
('3.1.0.1.0.0', 'f')
('3.1.0.1.0.0', '{\\bm s}_k')
('3.1.0.1.0.0', 'f')
('3.1.0.1.0.0', 'k')
('3.1.0.1.0.0', '{\\bm s}_{k-1}')
('3.1.0.1.0.0', '{\\bm t}_{k-1}')
('3.1.0.1.0.0', '{\\bm s}_{k-1}')
('3.1.0.1.0.0', '{\\bm t}_{k-1}')
('3.1.0.1.0.0', '{\\bm s}_k, {\\bm t}_k')
('3.1.0.1.0.0', '{\\bm t}_0 = {\\bm v}')
('3.1.0.1.0.0', '{\\bm s}_K = f({\\bm s}_0)')
('3.1.0.1.0.0', '{\\bm t}_K = \\partial f({\\bm s}_0)[{\\bm v}]')
('3.1.0.2', '\\ell \\circ f')
('3.1.0.2', '\\ell')
('3.1.0.2', 'f')
('3.1.0.2', '\\nabla (\\ell \\circ f)({\\bm s}_0) = \\partial f({\\bm s}_0)^*[\\nabla \\ell(f({\\bm s}_0))].')
('3.1.0.2', '\\partial f({\\bm s}_0)^*')
('3.1.0.2', '\\nabla \\ell(f({\\bm s}_0)) \\in \\mathcal{S}_K')
('3.1.0.2', '{\\bm u}\\in \\mathcal{S}_K')
('3.1.0.2', '\\partial f({\\bm s}_0)^* = \\partial f_1({\\bm s}_0)^* \\circ \\ldots \\circ \\partial\nf_K({\\bm s}_{K-1})^*.')
('3.1.0.2', '\\partial f({\\bm s}_0)^*')
('3.1.0.2', '{\\bm u}\\in \\mathcal{S}_K')
('3.1.0.2', '\\begin{aligned}\n\t{\\bm r}_K & = {\\bm u}\\\\\n\t{\\bm r}_{K-1} & = \\partial f_K({\\bm s}_{K-1})^*[{\\bm r}_K] \\\\\n\t& \\hspace{6pt} \\vdots \\\\\n\t{\\bm r}_0 & = \\partial f_1({\\bm s}_0)^*[{\\bm r}_1] \\\\\n\t\\partial f({\\bm s}_0)^*[{\\bm u}] &= {\\bm r}_0.\n\\end{aligned}')
('3.1.0.2', '\\partial f_k({\\bm s}_{k-1})^*')
('3.1.0.2', '\\partial f_k^* : \n            ({\\bm s}_{k-1}, {\\bm r}_k) \\mapsto\n            \\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k]')
('3.1.0.2', '\\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k]= {\\bm r}_{k-1}')
('3.1.0.2', 'f \\coloneqq f_K \\circ \\ldots \\circ f_1')
('3.1.0.2', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.0.2', '{\\bm u}\\in \\mathcal{S}_K')
('3.1.0.2', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{k-1}) \\in \\mathcal{S}_k')
('3.1.0.2', '{\\bm r}_K \\coloneqq {\\bm u}')
('3.1.0.2', '{\\bm r}_{k-1} \\coloneqq \\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k] \\in\n        \\mathcal{S}_{k-1}')
('3.1.0.2', 'f({\\bm s}_0) \\coloneqq {\\bm s}_K')
('3.1.0.2', '\\partial f({\\bm s}_0)^*[{\\bm u}] = {\\bm r}_0')
('3.1.0.2.0.0', '{\\bm s}_0, \\ldots, {\\bm s}_{K-1}')
('3.1.0.2.0.0', 'K')
('3.1.0.2.0.1', '\\partial f({\\bm s}_0)^*[{\\bm u}_i]')
('3.1.0.2.0.1', 'n')
('3.1.0.2.0.1', '{\\bm u}_i')
('3.1.0.2.0.1', '{\\bm s}_k')
('3.1.0.2.0.1', 'n')
('3.1.0.2.0.1', '{\\bm s}_k')
('3.1.0.2.0.1', '{\\bm u}')
('3.1.0.2.0.1', '\\mathrm{forward}(f, {\\bm s}_0)\n\\coloneqq (f({\\bm s}_0), \\partial f({\\bm s}_0)^*)')
('3.1.0.2.0.1', '\\partial f({\\bm s}_0)^*[{\\bm u}] \n\\coloneqq \\mathrm{backward}({\\bm u}; {\\bm s}_0, \\ldots, {\\bm s}_{K-1}).')
('3.1.0.2.0.1', '\\partial f({\\bm s}_0)^*')
('3.1.0.2.0.1', '{\\bm s}_0, \\dots\n{\\bm s}_K')
('3.1.0.2.0.1', '\\partial f({\\bm s}_0)')
('3.1.0.2.0.1', '{\\bm v}_i')
('3.1.0.2.0.1', '\\begin{aligned}\n\t\t{\\bm s}_0 & = {\\bm x}\\\\\n\t\t{\\bm s}_1 & = f_1({\\bm s}_0) = \\sigma({\\bm A}_1 {\\bm s}_0 + {\\bm b}_1) \\\\\n\t\t{\\bm s}_2 & = f_2({\\bm s}_1) = {\\bm A}_2 {\\bm s}_1 + {\\bm b}_2 \\\\\n\t\tf({\\bm x}) & = {\\bm s}_2,\n\t\n\\end{aligned}')
('3.1.0.2.0.1', '{\\bm A}_1, {\\bm A}_2, {\\bm b}_1, {\\bm b}_2')
('3.1.0.2.0.1', '\\sigma')
('3.1.0.2.0.1', '\\sigma(x) =\n\t\\log(1+e^x)')
('3.1.0.2.0.1', "\\sigma'(x) = e^x/(1+e^x)")
('3.1.0.2.0.1', 'f')
('3.1.0.2.0.1', '{\\bm x}')
('3.1.0.2.0.1', '{\\bm v}')
('3.1.0.2.0.1', "\\begin{aligned}\n\t\t{\\bm t}_0 & = {\\bm v}\\\\\n\t\t{\\bm t}_1 & = \\sigma'({\\bm A}_1 {\\bm s}_0 + {\\bm b}_1) \\odot ({\\bm A}_1 {\\bm t}_0) \\\\\n\t\t{\\bm t}_2 & = {\\bm A}_2 {\\bm t}_1 \\\\\n\t\t\\partial f({\\bm x})[{\\bm v}] & = {\\bm t}_2,\n\t\n\\end{aligned}")
('3.1.0.2.0.1', 'f')
('3.1.0.2.0.1', '{\\bm x}')
('3.1.0.2.0.1', "\\begin{aligned}\n\t\t{\\bm r}_2 & = {\\bm u}\\\\\n\t\t{\\bm r}_1 & = \\partial f_2({\\bm s}_1)^*[{\\bm r}_2] \n\t\t\t   = {\\bm A}_2^\\top {\\bm r}_2 \\\\\n\t\t{\\bm r}_0 & = \\partial f_1({\\bm s}_0)^*[{\\bm r}_1] \n\t\t       = {\\bm A}_1^\\top (\\sigma'({\\bm A}_1 {\\bm s}_0 + {\\bm b}_1) \\odot {\\bm r}_1) \\\\\n\t\t\\partial f({\\bm x})^*[{\\bm u}] & = {\\bm r}_0.\n\t\n\\end{aligned}")
('3.1.0.3', '\\bm \\partial f({\\bm s}_0)')
('3.1.0.3', 'f = f_K \\circ \\dots \\circ f_1')
('3.1.0.3', '\\mathcal{S}_k\n\\subseteq \\mathbb{R}^{D_k}')
('3.1.0.3', 'D_K = M')
('3.1.0.3', 'D_0 = D')
('3.1.0.3.0', '\\bm \\partial_j f({\\bm s}_0) \\in \\mathbb{R}^M')
('3.1.0.3.0', 'j \\in [D]')
('3.1.0.3.0', '{\\bm e}_j \\in \\mathbb{R}^D')
('3.1.0.3.0', '\\begin{aligned}\n\\partial_1 f({\\bm s}_0) &= \\partial f({\\bm s}_0) {\\bm e}_1 \\\\\n                     &\\vdots \\\\\n\\partial_D f({\\bm s}_0) &= \\partial f({\\bm s}_0) {\\bm e}_D.\n\\end{aligned}')
('3.1.0.3.0', 'D')
('3.1.0.3.0', '\\mathbb{R}^D')
('3.1.0.3.0', 'f_k')
('3.1.0.3.0', 'f_k: \\mathbb{R}^{D_{k-1}} \\rightarrow \\mathbb{R}^{D_k}')
('3.1.0.3.0', '\\bm \\partial f_k({\\bm s}_{k-1})')
('3.1.0.3.0', 'D_{k} \\times\nD_{k-1}')
('3.1.0.3.0', 'D')
('3.1.0.3.0', 'O\\left(D \\sum_{k=1}^K D_k D_{k-1}\\right)')
('3.1.0.3.0', 'O(\\max_{k \\in [K]} D_k)')
('3.1.0.3.0', 'D_1 = \\dots = D_{K-1} = D')
('3.1.0.3.0', 'D_K=M')
('3.1.0.3.0', 'D')
('3.1.0.3.0', 'O(MD^2 + KD^3)')
('3.1.0.3.0', 'O(\\max\\{D, M\\})')
('3.1.0.3.0', 'D=1')
('3.1.0.3.1', '\\nabla f_i({\\bm s}_0) \\in \\mathbb{R}^D')
('3.1.0.3.1', 'i \\in [M]')
('3.1.0.3.1', '{\\bm e}_i \\in \\mathbb{R}^M')
('3.1.0.3.1', '\\begin{aligned}\n\\nabla f_1({\\bm s}_0) &= \\partial f({\\bm s}_0)^* {\\bm e}_1 \\\\\n               &\\vdots \\\\\n\\nabla f_M({\\bm s}_0) &= \\partial f({\\bm s}_0)^* {\\bm e}_M.\n\\end{aligned}')
('3.1.0.3.1', 'M')
('3.1.0.3.1', '\\mathbb{R}^M')
('3.1.0.3.1', 'f_k')
('3.1.0.3.1', 'f_k: \\mathbb{R}^{D_{k-1}} \\rightarrow \\mathbb{R}^{D_k}')
('3.1.0.3.1', 'M')
('3.1.0.3.1', 'O\\left(M \\sum_{k=1}^K D_k D_{k-1}\\right)')
('3.1.0.3.1', 'O(\\sum_{k=1}^{K} D_k)')
('3.1.0.3.1', 'K')
('3.1.0.3.1', 'D_0 = \\dots =\nD_{K-1} = D')
('3.1.0.3.1', 'D_K=M')
('3.1.0.3.1', 'M')
('3.1.0.3.1', 'O(M^2D + KMD^2)')
('3.1.0.3.1', 'O(KD + M)')
('3.1.0.3.1', 'M=1')
('3.1.0.3.2', 'M<D')
('3.1.0.3.2', 'M\\geq D')
('3.1.0.3.2', 'f = f_K \\circ \\dots \\circ f_1')
('3.1.0.3.2', 'f_k \\colon \\mathbb{R}^D \\to \\mathbb{R}^D')
('3.1.0.3.2', 'k = 1, \\dots, K-1')
('3.1.0.3.2', 'f_K \\colon \\mathbb{R}^D \\to \\mathbb{R}^M')
('3.1.0.3.2', '\\partial f_k')
('3.1.0.3.2', 'D')
('3.1.0.3.2', 'M')
('3.1.0.3.2', 'O(MD^2 + KD^3)')
('3.1.0.3.2', 'O(M^2D + KMD^2)')
('3.1.0.3.2', 'O(\\max\\{M,D\\})')
('3.1.0.3.2', 'O(KD + M)')
('3.1.1', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.1', 'f_k')
('3.1.1', '{\\bm w}_k \\in \\mathcal{W}_k')
('3.1.1', '\\begin{aligned}\n\t{\\bm s}_0 & \\coloneqq {\\bm x}\\in \\mathcal{S}_0 \\\\\n\t{\\bm s}_1 & \\coloneqq f_1({\\bm s}_0, {\\bm w}_1) \\in \\mathcal{S}_1 \\\\ \n\t\t & \\hspace{6pt} \\vdots \\\\\n\t{\\bm s}_K & \\coloneqq f_K({\\bm s}_{K-1}, {\\bm w}_K) \\in \\mathcal{S}_K \\\\\n\tf({\\bm x}, {\\bm w}) & \\coloneqq {\\bm s}_K,\n\\end{aligned}')
('3.1.1', '\\mathcal{S}_0 = \\mathcal{X}')
('3.1.1', '{\\bm w}= ({\\bm w}_1, \\dots, {\\bm w}_K) \\in \\mathcal{W}_1 \\times \\dots\n\\times \\mathcal{W}_K')
('3.1.1', 'f_k')
('3.1.1.0', 'f \\colon \\mathcal{E}\\to \\mathcal{F}')
('3.1.1.0', '\\mathcal{E}\\coloneqq \\mathcal{X}\\times (\\mathcal{W}_1 \\times \\dots \\times \\mathcal{W}_K)')
('3.1.1.0', '\\mathcal{F}\\coloneqq \\mathcal{S}_K')
('3.1.1.0', '\\partial f({\\bm x}, {\\bm w})^* \\colon \\mathcal{F}\\to \\mathcal{E}')
('3.1.1.0', '\\partial f({\\bm x}, {\\bm w})^*[{\\bm u}] \\in \\mathcal{E}')
('3.1.1.0', '{\\bm u}\\in \\mathcal{F}')
('3.1.1.0', 'f_k \\colon \\mathcal{E}_k \\to \\mathcal{F}_k')
('3.1.1.0', '\\mathcal{E}_k \\coloneqq \\mathcal{S}_{k-1} \\times \\mathcal{W}_k')
('3.1.1.0', '\\mathcal{F}_k \\coloneqq \\mathcal{S}_k')
('3.1.1.0', '\\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)^* \\colon \\mathcal{F}_k \\to \\mathcal{E}_k')
('3.1.1.0', '\\begin{aligned}\n    {\\bm r}_K &= {\\bm u}\\in \\mathcal{S}_K \\\\\n    ({\\bm r}_{K-1}, {\\bm g}_K) &= \\partial f_K({\\bm s}_{K-1}, {\\bm w}_K)^* [{\\bm r}_K] \\in \\mathcal{S}_{K-1}\n    \\times \\mathcal{W}_K \\\\\n                     &\\hspace{6pt} \\vdots \\\\\n    ({\\bm r}_0, {\\bm g}_1) &= \\partial f_1({\\bm s}_0, {\\bm w}_1)^* [{\\bm r}_1] \\in \\mathcal{S}_0 \\times \\mathcal{W}_1.\n\\end{aligned}')
('3.1.1.0', '\\partial f({\\bm x}, {\\bm w})^*[{\\bm u}] = ({\\bm r}_0, ({\\bm g}_1, \\dots, {\\bm g}_K)).')
('3.1.1.1', 'L({\\bm w}; {\\bm x}, {\\bm y}) \\coloneqq \\ell(f({\\bm x}, {\\bm w}); {\\bm y}) \\in \\mathbb{R}.')
('3.1.1.1', '\\nabla L({\\bm w}; {\\bm x}, {\\bm y}) \n= ({\\bm g}_1, \\dots, {\\bm g}_K) \\in \\mathcal{W}_1 \\times \\dots \\times \\mathcal{W}_K')
('3.1.1.1', '\\partial f({\\bm x}, {\\bm w})^*[{\\bm u}] = ({\\bm r}_0, ({\\bm g}_1, \\dots, {\\bm g}_K)),')
('3.1.1.1', '{\\bm u}= \\nabla \\ell(f({\\bm x}, {\\bm w}); {\\bm y}) \\in \\mathcal{S}_K')
('3.1.1.1', '{\\bm r}_0 \\in \\mathcal{S}_0')
('3.1.1.1', '\\mathcal{S}_0 = \\mathcal{X}')
('3.1.1.1', '{\\bm x}\\in \\mathcal{X}')
('3.1.1.1', '\\partial f_k^*: \n    ({\\bm s}_{k-1}, {\\bm w}_{k-1}, {\\bm r}_k) \\mapsto \n    \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)[{\\bm r}_k]')
('3.1.1.1', '\\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)^*[{\\bm r}_k] = ({\\bm r}_{k-1}, {\\bm g}_k)')
('3.1.1.1', 'f_1, \\dots, f_K')
('3.1.1.1', '({\\bm x},{\\bm y}) \\in \\mathcal{X}\\times \\mathcal{Y}')
('3.1.1.1', '{\\bm w}= ({\\bm w}_1, \\ldots {\\bm w}_K) \\in \\mathcal{W}_1\n        \\times \\dots \\times \\mathcal{W}_K')
('3.1.1.1', '{\\bm s}_0 \\coloneqq {\\bm x}')
('3.1.1.1', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{k-1}, {\\bm w}_k) \\in \\mathcal{S}_k')
('3.1.1.1', '\\ell({\\bm s}_K; {\\bm y})')
('3.1.1.1', '{\\bm u}\\coloneqq \\nabla \\ell({\\bm s}_K; {\\bm y})\n        \\in \\mathcal{S}_K')
('3.1.1.1', '{\\bm r}_K \\coloneqq {\\bm u}\\in \\mathcal{S}_K')
('3.1.1.1', '({\\bm r}_{k-1}, {\\bm g}_k) \\coloneqq \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)^*[{\\bm r}_k] \\in\n        \\mathcal{S}_{k-1} \\times \\mathcal{W}_k')
('3.1.1.1', 'L({\\bm w}; {\\bm x}, {\\bm y}) \\coloneqq \\ell({\\bm s}_K; {\\bm y})')
('3.1.1.1', '\\nabla L({\\bm w}; {\\bm x}, {\\bm y}) = (g_1, \\ldots, g_K)')
('3.1.2.0', 'f_1, \\dots, f_K')
('3.1.2.0', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.2.0', '{\\bm v}\\in\n        \\mathcal{S}_0')
('3.1.2.0', '{\\bm t}_0 \\coloneqq {\\bm v}')
('3.1.2.0', 'i_1, \\dots, i_{p_k} \\coloneqq {\\operatorname{pa}}(k)')
('3.1.2.0', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}})')
('3.1.2.0', '\\begin{aligned}\n{\\bm t}_k &\\coloneqq \n\\partial f_k({\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}})[{\\bm t}_{i_1}, \\dots, {\\bm t}_{i_{p_k}}] \\\\\n& = \\sum_{j=1}^{p_k} \\partial_{j} f_k({\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}})[{\\bm t}_{i_j}].\n\\end{aligned}')
('3.1.2.0', 'f({\\bm s}_0) \\coloneqq {\\bm s}_K')
('3.1.2.0', '\\partial f({\\bm s}_0)[{\\bm v}] = {\\bm t}_K')
('3.1.2.0', '{\\bm v}\\in\n\\mathcal{S}_0')
('3.1.2.0', '{\\bm t}_0 \\coloneqq {\\bm v}\\in \\mathcal{S}_0')
('3.1.2.0', 'k \\in [K]')
('3.1.2.0', '\\begin{aligned}\n{\\bm t}_k \n&\\coloneqq \\partial f_k({\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}})[{\\bm t}_{i_1}, \\dots,\n{\\bm t}_{i_{p_k}}] \\\\\n&= \\sum_{j=1}^{p_k} \n\\partial_{j} f_k({\\bm s}_{i_1}, \\dots, {\\bm s}_{i_{p_k}})[{\\bm t}_{i_j}],\n\\end{aligned}')
('3.1.2.0', 'i_1, \\ldots, i_{p_k} = {\\operatorname{pa}}(k)')
('3.1.2.0', '\\partial f({\\bm s}_0)[{\\bm v}] = {\\bm t}_K')
('3.1.2.0', '{\\bm s}_k')
('3.1.2.0', '{\\bm t}_k')
('3.1.2.0', 'k')
('3.1.2.1', '{\\bm u}\\in\n\\mathcal{S}_K')
('3.1.2.1', '{\\bm \\delta}_{i_1,k}, \\dots, {\\bm \\delta}_{i_{p_k},k} \n= \\partial f_k({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}})^*[{\\bm r}_k].')
('3.1.2.1', '{\\bm s}_k')
('3.1.2.1', 'f_{j_1},\\dots, f_{j_{c_k}}')
('3.1.2.1', 'j_1,\\dots,j_{c_k} = {\\operatorname{ch}}(k)')
('3.1.2.1', '{\\bm s}_k')
('3.1.2.1', 'f_j')
('3.1.2.1', '{\\bm r}_k')
('3.1.2.1', '{\\bm r}_k \\coloneqq \\sum_{j \\in \\{j_1,\\dots,j_{c_k}\\}} {\\bm \\delta}_{k,j}.')
('3.1.2.1', 'k')
('3.1.2.1', '{\\bm r}_k')
('3.1.2.1', '{\\bm r}_k')
('3.1.2.1', 'k')
('3.1.2.1', 'f_1, \\dots, f_K')
('3.1.2.1', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.2.1', '{\\bm u}\\in\n          \\mathcal{S}_K')
('3.1.2.1', 'i_1, \\dots, i_{p_k} \\coloneqq {\\operatorname{pa}}(k)')
('3.1.2.1', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}})')
('3.1.2.1', 'l_k \\coloneqq \\partial f_k({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}})^*')
('3.1.2.1', '{\\bm r}_K \\coloneqq {\\bm u}')
('3.1.2.1', '{\\bm r}_k \\coloneqq 0 ~ \\forall k  \\in \\{0, \\ldots, K-1\\}')
('3.1.2.1', 'i_1, \\dots, i_{p_k} = {\\operatorname{pa}}(k)')
('3.1.2.1', '{\\bm \\delta}_{i_1,k}, \\dots, {\\bm \\delta}_{i_{p_k},k} \\coloneqq \n          l_k[{\\bm r}_k]')
('3.1.2.1', '{\\bm r}_{i_j} \\leftarrow\n          {\\bm r}_{i_j} + {\\bm \\delta}_{i_j,k} ~ \\forall j \\in \\{1, \\dots, p_k\\}')
('3.1.2.1', 'f({\\bm s}_0) \\coloneqq {\\bm s}_K')
('3.1.2.1', '\\partial f({\\bm s}_0)^*[{\\bm u}] = {\\bm r}_0')
('3.1.2.1', 'f_k')
('3.1.2.1', 'k')
('3.1.2.1', 'p_k')
('3.1.2.1', 'f_{i_1}, \\ldots, f_{i_{p_k}}')
('3.1.2.1', '\\{i_1, \\ldots, i_{p_k}\\}= {\\operatorname{pa}}(k)')
('3.1.2.1', 'c_k')
('3.1.2.1', 'f_{j_1},\n  \\ldots, f_{j_{c_k}}')
('3.1.2.1', '\\{j_1, \\ldots, j_{c_k}\\}= {\\operatorname{ch}}(k)')
('3.1.2.1', 'k')
('3.1.2.1', '{\\bm s}_k^p \\coloneqq ({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}})')
('3.1.2.1', '\\partial_i f_k({\\bm s}_k^p)[{\\bm t}_{i_j}]')
('3.1.2.1', '{\\bm t}_{i_j}')
('3.1.2.1', 'j=1, \\ldots, p_k')
('3.1.2.1', '{\\bm t}_k')
('3.1.2.1', 'k')
('3.1.2.1', 'f_{j_1}, \\ldots, f_{j_{c_k}}')
('3.1.2.1', '\\{j_1, \\ldots, j_{c_k}\\}= {\\operatorname{ch}}(k)')
('3.1.2.1', '{\\bm r}_k')
('3.1.2.1', '{\\bm r}_k')
('3.1.2.1', '\\partial_i f_k({\\bm s}_k^p)')
('3.1.2.2', 'f \\colon \\mathcal{E}\\to \\mathbb{R}')
('3.1.2.2', 'f_k')
('3.1.2.2', 'f')
('3.1.2.2', '\\nabla f')
('3.1.2.2', 'f')
('3.1.2.2', '\\nabla f')
('3.1.2.2', '\\nabla f')
('3.1.2.2', 'f')
('3.1.2.2', 'f \\colon \\mathcal{E}\\to \\mathbb{R}')
('3.1.2.2', 'S(\\nabla f) \\le 5 \\cdot S(f),')
('3.1.2.2', 'S(f)')
('3.1.2.2', 'f')
('3.1.2.2', '+')
('3.1.2.2', '\\times')
('3.1.3.0', '\\mathcal{A}')
('3.1.3.0', '\\mathcal{A}= \\{+, \\times\\}')
('3.1.3.0', '\\mathcal{A}')
('3.1.3.0', '\\mathcal{A}')
('3.1.3.1', 'f_k')
('3.1.3.1', '\\mathcal{F}')
('3.1.3.1', '\\mathcal{F}')
('3.1.3.1', 'f \\in \\mathcal{F}')
('3.1.3.1', 'g \\in \\mathcal{F}')
('3.1.3.1', 'f \\circ g \\in \\mathcal{F}')
('3.1.3.1', 'f_k')
('3.1.3.1', '\\mathcal{A}')
('3.1.3.1', 'f_k')
('3.1.3.1', '\\mathcal{A}')
('3.1.3.2', 'f \\in \\mathcal{A}')
('3.1.3.2', 'f({\\bm W}) = {\\bm W}{\\bm x}\\in \\mathbb{R}^M')
('3.1.3.2', '{\\bm x}\\in\n\t\\mathbb{R}^D')
('3.1.3.2', '{\\bm W}\\in \\mathbb{R}^{M\\times D}')
('3.1.3.2', 'f')
('3.1.3.2', '{\\bm W}\\in \\mathbb{R}^{M \\times D}')
('3.1.3.2', '{\\bm V}\\in \\mathbb{R}^{M \\times D}')
('3.1.3.2', '\\partial f({\\bm W})[{\\bm V}] = f({\\bm V}) =\n\t{\\bm V}{\\bm x}\\in \\mathbb{R}^M.')
('3.1.3.2', '{\\bm u}\\in \\mathbb{R}^M')
('3.1.3.2', '{\\bm V}\\in\n\t\\mathbb{R}^{M\\times D}')
('3.1.3.2', '\\langle \\partial f({\\bm W})[{\\bm V}], {\\bm u}\\rangle =\n\t\\langle {\\bm V}, \\partial f({\\bm W})^*[{\\bm u}] \\rangle')
('3.1.3.2', '\\langle \\partial f({\\bm W})[{\\bm V}], {\\bm u}\\rangle \n\t= \\langle {\\bm V}{\\bm x}, {\\bm u}\\rangle \n\t= \\operatorname{tr}({\\bm x}^\\top {\\bm V}^\\top {\\bm u})\n\t= \\langle {\\bm V}, {\\bm u}{\\bm x}^\\top \\rangle.')
('3.1.3.2', '\\partial f({\\bm W})^*[{\\bm u}] = {\\bm u}{\\bm x}^\\top \\in \\mathbb{R}^{M \\times D}.')
('3.1.3.2', 'f({\\bm W}) = {\\bm W}{\\bm X}')
('3.1.3.2', '{\\bm W}\\in \\mathbb{R}^{M \\times D}')
('3.1.3.2', '{\\bm X}\\in \\mathbb{R}^{D \\times N}')
('3.1.3.2', '{\\bm W}\\in \\mathbb{R}^{M \\times D}')
('3.1.3.2', '{\\bm V}\\in \\mathbb{R}^{M\n\t\\times D}')
('3.1.3.2', '\\partial f({\\bm W})[{\\bm V}] = f({\\bm V}) = {\\bm V}{\\bm X}\\in \\mathbb{R}^{M\\times N}.')
('3.1.3.2', '{\\bm U}\\in \\mathbb{R}^{M\\times N}')
('3.1.3.2', '\\partial f({\\bm W})^*[{\\bm U}] = {\\bm U}{\\bm X}^\\top \\in \\mathbb{R}^{M \\times D}.')
('3.1.3.2', 'f({\\bm w}) \\coloneqq (g_1(w_1), \\dots, g_P(w_P))')
('3.1.3.2', 'g_i \\colon \\mathbb{R}\\to \\mathbb{R}')
('3.1.3.2', "g_i'")
('3.1.3.2', "\\bm \\partial f({\\bm w}) = \\operatorname{\\bf diag}(g_1'(w_1), \\dots, g_P'(w_P)) \\in \\mathbb{R}^{P \\times P}.")
('3.1.3.2', "\\partial f({\\bm w})[{\\bm v}] \n= \\partial f({\\bm w})^*[{\\bm v}]\n= (g_1'(w_1), \\dots, g_P'(w_P)) \\odot {\\bm v},")
('3.1.3.2', '\\odot')
('3.1.3.3', 'f \\in \\mathcal{A}')
('3.1.3.3', 'l({\\bm w})')
('3.1.3.3', '\\partial l({\\bm w})[{\\bm v}] = l({\\bm v})')
('3.1.3.3', '{\\bm w}')
('3.1.3.3', '\\partial l({\\bm w})^*[{\\bm u}] = l^*({\\bm u})')
('3.1.3.3', 'l^*')
('3.1.3.3', 'l')
('3.1.3.3', '{\\bm w}')
('3.1.3.3', 'l({\\bm u}; {\\bm w}) \\coloneqq \\partial f({\\bm w})^*[{\\bm u}]')
('3.1.3.3', 'f')
('3.1.3.3', '{\\bm u}')
('3.1.3.3', 'l({\\bm u}; {\\bm w})')
('3.1.3.3', '{\\bm u}')
('3.1.3.3', '\\partial l({\\bm u}; {\\bm w})^*[{\\bm v}] \n= l^*({\\bm v}; {\\bm w})\n= \\partial f({\\bm w})^{**}[{\\bm v}]\n= \\partial f({\\bm w})[{\\bm v}],')
('3.1.3.3', '{\\bm u}')
('3.1.3.3', 'f({\\bm x}, {\\bm W}) \\coloneqq {\\bm W}{\\bm x}')
('3.1.3.3', '\\begin{aligned}\n\\partial f({\\bm x}, {\\bm W})^*[{\\bm u}]\n&= ({\\bm W}^\\top {\\bm u}, {\\bm u}{\\bm x}^\\top) \\\\\n&= (f({\\bm u}, {\\bm W}^\\top), f({\\bm x}^\\top, {\\bm u})) \\\\\n&\\eqqcolon l({\\bm u}; {\\bm x}, {\\bm W}).\n\\end{aligned}')
('3.1.3.3', '\\begin{aligned}\n\\partial l({\\bm u}; {\\bm x}, {\\bm W})^*[{\\bm v}, {\\bm V}]\n&= f({\\bm v}, {\\bm W}) + f({\\bm x}, {\\bm V}) \\\\\n&= {\\bm W}{\\bm v}+ {\\bm V}{\\bm x}\\\\\n&= \\partial f({\\bm x}, {\\bm W})[{\\bm v}, {\\bm V}].\n\\end{aligned}')
('3.1.4', 'f = f_K\n\\circ \\ldots \\circ f_1')
('3.1.4', 'f_i: \\mathbb{R}^D \\rightarrow \\mathbb{R}^D')
('3.1.4.0', '\\mathcal{C}(K)')
('3.1.4.0', 'f_i')
('3.1.4.0', '\\mathcal{M}(K)')
('3.1.4.0', 'f\n= f_K \\circ \\ldots \\circ f_1')
('3.1.4.0', '\\partial f({\\bm s}_0)^*[{\\bm u}]')
('3.1.4.0', '\\mathcal{C}(K) = K-1 \\quad \\text{and} \\quad \\mathcal{M}(K) = K.')
('3.1.4.0', '\\mathcal{C}(K) = K(K-1)/2 \\quad \\text{and} \\quad \\mathcal{M}(K) = 1.')
('3.1.4.0', 'K')
('3.1.4.0', 'f_K \\circ \\ldots \\circ f_1')
('3.1.4.0', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.4.0', '{\\bm u}\\in \\mathcal{S}_K')
('3.1.4.0', '\\partial f_1({\\bm s}_0)^*[{\\bm u}]')
('3.1.4.0', '{\\bm r}_K = {\\bm u}')
('3.1.4.0', '{\\bm s}_{k-1} = (f_{k-1} \\circ \\ldots  \\circ f_1)({\\bm s}_0)')
('3.1.4.0', '{\\bm r}_{k-1} = \\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k]')
('3.1.4.0', '{\\bm r}_0')
('3.1.4.1', '{\\bm s}_K = f_K \\circ \\dots \\circ\nf_1({\\bm s}_0)')
('3.1.4.1', '\\begin{aligned}\n    {\\bm s}_{K/2} &= f_{K/2} \\circ \\ldots \\circ f_1({\\bm s}_0) \\\\\n    {\\bm s}_{K} &= f_{K} \\circ \\ldots \\circ f_{K/2+1}({\\bm s}_{K/2}),\n\\end{aligned}')
('3.1.4.1', 'K')
('3.1.4.1', '{\\bm s}_k')
('3.1.4.1', '{\\bm s}_0')
('3.1.4.1', '{\\bm s}_{K/2}')
('3.1.4.1', '{\\bm s}_{k}')
('3.1.4.1', 'k>K/2')
('3.1.4.1', '{\\bm s}_{K/2}')
('3.1.4.1', '{\\bm s}_{K/2} = f_{K/2} \\circ \\ldots \\circ f_1({\\bm s}_0)')
('3.1.4.1', '{\\bm r}_{K/2} = \\mbox{\\texttt{vjp\\_full\\_recompute}}(f_K \\circ \\ldots\n      \\circ f_{K/2 +1}, {\\bm s}_{K/2}, {\\bm u})')
('3.1.4.1', '{\\bm r}_0 = \\mbox{\\texttt{vjp\\_full\\_recompute}}(f_{K/2} \\circ \\ldots\n      \\circ f_1, {\\bm s}_0, {\\bm r}_{K/2})')
('3.1.4.1', '{\\bm s}_{K/2}')
('3.1.4.1', 'f_K \\circ \\ldots \\circ f_1')
('3.1.4.1', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.4.1', '{\\bm u}\\in \\mathcal{S}_K')
('3.1.4.1', '\\partial f_1({\\bm s}_0)^*[{\\bm u}]')
('3.1.4.1', '{\\bm s}_{K/2} = f_{K/2} \\circ \\ldots \\circ f_1({\\bm s}_0)')
('3.1.4.1', '{\\bm r}_{K/2} = \\mbox{\\texttt{vjp\\_halving}}(f_K \\circ \\ldots \\circ f_{K/2 +1}, {\\bm s}_{K/2}, {\\bm u})')
('3.1.4.1', '{\\bm r}_0 = \\mbox{\\texttt{vjp\\_halving}}(f_{K/2} \\circ \\ldots\n\\circ f_1, {\\bm s}_0, {\\bm r}_{K/2})')
('3.1.4.1', '{\\bm r}_0')
('3.1.4.1', '\\mathcal{C}(K)')
('3.1.4.1', 'K')
('3.1.4.1', 'K/2')
('3.1.4.1', '\\begin{aligned}\n    \\mathcal{C}(K) & = 2\\mathcal{C}(K/2) + K/2.\n\\end{aligned}')
('3.1.4.1', '1')
('3.1.4.1', '\\mathcal{C}(1) = 0')
('3.1.4.1', 'K')
('3.1.4.1', '2')
('3.1.4.1', '\\mathcal{C}(K) = \\frac{K}{2}\\log_2 K.')
('3.1.4.1', '{\\bm s}_0')
('3.1.4.1', '{\\bm s}_0')
('3.1.4.1', '\\log_2 K')
('3.1.4.1', 'K')
('3.1.4.1', '2')
('3.1.4.1', '{\\bm s}_0')
('3.1.4.1', '{\\bm s}_0')
('3.1.4.1', 'K')
('3.1.4.1', '2')
('3.1.4.1', '\\mathcal{M}(K) = \\log_2 K.')
('3.1.4.1', '8')
('3.1.4.2', '\\log_2 K')
('3.1.4.2', 'K')
('3.1.4.2', 'l')
('3.1.4.2', 'l+1')
('3.1.4.2', 'K')
('3.1.4.2', '0')
('3.1.4.2', 'l')
('3.1.4.2', '{\\bm s}_0')
('3.1.4.2', 'l')
('3.1.4.2', '{\\bm s}_0')
('3.1.4.2', '{\\bm s}_l')
('3.1.4.2', '\\mathcal{C}(k, s)')
('3.1.4.2', 'k')
('3.1.4.2', 's')
('3.1.4.2', '\\mathcal{C}(k, s) = \\mathcal{C}(k-l, s-1) + \\mathcal{C}(l, s) + l,')
('3.1.4.2', 'l \\in \\{1, \\dots, k-1\\}')
('3.1.4.2', 'l = k/2')
('3.1.4.2', 'l')
('3.1.4.2', '\\label{auto_diff:eq:checkpointing_dyn_prog}\n  \\mathcal{C}^*(k, s) \\coloneqq\n  \\min_{1\\leq l\\leq K-1} \\{\\mathcal{C}^*(k-l, s-1) + \\mathcal{C}^*(l, s) + l\\}.')
('3.1.4.2', '\\mathcal{C}^*(K, S)')
('3.1.4.2', '\\mathcal{C}^*(k, s)')
('3.1.4.2', 'k=1, \\ldots, K-1')
('3.1.4.2', 's=1, \\ldots, S-1')
('3.1.4.2', 'k=1')
('3.1.4.2', '\\mathcal{C}^*(1, s) \\coloneqq 0')
('3.1.4.2', 's=1')
('3.1.4.2', '\\mathcal{C}^*(k,\n1) \\coloneqq (k(k-1))/2.')
('3.1.4.2', '\\mathcal{C}^*(k, s)')
('3.1.4.2', 'k=1')
('3.1.4.2', 'K')
('3.1.4.2', 's=1')
('3.1.4.2', 'S')
('3.1.4.2', 'l^*(k, s) \\coloneqq \\mathop{\\mathrm{arg\\,min}}_{1\\leq l\\leq k-1}\n\\{\\mathcal{C}^*(k-l, s-1) + \\mathcal{C}^*(l, s) + l\\}.')
('3.1.4.2', 'K, S')
('3.1.4.2', '\\mathcal{C}^*(k-l,\ns-1)')
('3.1.4.2', '\\mathcal{C}^*(l, s)')
('3.1.4.2', 'f_k')
('3.1.4.2.0', 'f_k')
('3.1.4.2.0', 'l')
('3.1.4.2.0', '1')
('3.1.4.2.0', 'l')
('3.1.4.2.0', 'K')
('3.1.4.2.0', 'S')
('3.1.4.2.0', 'l^*(k, s)')
('3.1.4.2.0', 'l^*(k,\ns)')
('3.1.4.2.0', 'K, S')
('3.1.4.2.0', 'l^*(k, s)')
('3.1.4.2.0', 'f_k')
('3.1.4.3', 'S')
('3.1.4.3', 'S')
('3.1.5.0', 'f_k')
('3.1.5.0', 'f_k^{-1}')
('3.1.5.0', 'f_k^{-1}')
('3.1.5.0', '{\\bm s}_{k-1}')
('3.1.5.0', '{\\bm r}_k \\mapsto \\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k]')
('3.1.5.0', '{\\bm s}_k')
('3.1.5.0', '{\\bm s}_{k-1} = f_k^{-1}({\\bm s}_k)')
('3.1.5.0', '{\\bm s}_k')
('3.1.5.0', '{\\bm r}_k')
('3.1.5.0', 'f \\coloneqq f_K \\circ \\ldots \\circ f_1')
('3.1.5.0', 'f_k')
('3.1.5.0', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.1.5.0', '{\\bm u}\\in \\mathcal{S}_K')
('3.1.5.0', '{\\bm s}_K = f_K \\circ \\ldots \\circ f_1({\\bm s}_0)')
('3.1.5.0', '{\\bm s}_{k-1} = f_k^{-1}({\\bm s}_k)')
('3.1.5.0', '{\\bm r}_{k-1} \n      =  \\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k]')
('3.1.5.0', 'f({\\bm s}_0) \\coloneqq {\\bm s}_K')
('3.1.5.0', '\\partial f({\\bm s}_0)^*[{\\bm u}] = {\\bm r}_0')
('3.1.5.0', 'f_k^{-1}')
('3.1.5.1', 'f_k')
('3.1.5.1', '\\partial f_k({\\bm s}_{k-1})^{-1} = \\partial f_k({\\bm s}_{k-1})^*,')
('3.1.5.1', 'f = f_K \\circ \\ldots \\circ f_1')
('3.1.5.1', 'f^{-1} = f_1^{-1} \\circ \\ldots \\circ f_K^{-1}')
('3.1.5.1', '\\partial f({\\bm s}_0)^*[{\\bm u}] = \\partial f^{-1}({\\bm s}_K)[{\\bm u}].')
('3.1.5.1', 'f')
('3.1.5.1', 'f^{-1}')
('3.1.6', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}')
('3.1.6', '\\nabla f')
('3.1.6', 'P')
('3.1.6', 'P')
('3.1.6', '\\nabla f')
('3.1.6', '\\nabla f')
('3.1.6', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}')
('3.1.6', '\\begin{aligned}\n\\nabla f({\\bm \\mu})\n&= \\mathbb{E}_{Z \\sim p} \\left[\\partial f({\\bm \\mu})[Z] Z \\right] \\\\\n&= \\mathbb{E}_{Z \\sim p} \\left[\\langle \\nabla f({\\bm \\mu}), Z \\rangle Z \\right].\n\\end{aligned}')
('3.1.6', 'p \\coloneqq \\mathrm{Normal}(0,1)^P')
('3.1.6', 'M')
('3.1.6', '{\\bm z}_1,\\dots,{\\bm z}_M')
('3.1.6', '\\langle \\nabla\nf({\\bm \\mu}), {\\bm z}_i \\rangle')
('3.1.6', 'i \\in [M]')
('3.1.7', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}^M')
('3.1.7', 'M \\ge P')
('3.1.7', 'P \\ge M')
('3.1.7', 'f \\colon\n\\mathbb{R}^P \\to \\mathbb{R}')
('3.2.0', 'f \\colon \\mathcal{E}\\to \\mathbb{R}')
('3.2.0', '\\nabla^2 f({\\bm w}) [{\\bm v}]')
('3.2.0', '{\\bm w}\\in \\mathcal{E}')
('3.2.0', '{\\bm v}\\in \\mathcal{E}')
('3.2.0.0', '\\nabla^2 f({\\bm w})[{\\bm v}] = \\partial (\\nabla f)({\\bm w})^*[{\\bm v}].')
('3.2.0.0', '\\nabla^2 f({\\bm w})[{\\bm v}] = \\partial (\\nabla f)({\\bm w})[{\\bm v}].')
('3.2.0.0', 'g \\colon \\mathcal{E}\\to \\mathcal{E}')
('3.2.0.0', '{\\bm v}\\in \\mathcal{E}')
('3.2.0.0', '\\partial g({\\bm w})^*[{\\bm v}] = \\nabla \\langle g, {\\bm v}\\rangle({\\bm w}),')
('3.2.0.0', '\\langle g, {\\bm v}\\rangle({\\bm w}) \\coloneqq \\langle {\\bm v}, g({\\bm w}) \\rangle')
('3.2.0.0', '\\langle g, {\\bm v}\\rangle')
('3.2.0.0', '{\\bm w}')
('3.2.0.0', '\\partial (\\nabla f)({\\bm w})^*[{\\bm v}] = \\nabla \\langle \\nabla f, {\\bm v}\\rangle({\\bm w}).')
('3.2.0.0', '\\langle \\nabla f, {\\bm v}\\rangle({\\bm w}) =\n\\langle \\nabla f({\\bm w}), {\\bm v}\\rangle = \n\\partial f({\\bm w})[{\\bm v}]')
('3.2.0.0', 'f')
('3.2.0.0', '{\\bm w}')
('3.2.0.0', '{\\bm v}')
('3.2.0.0', 'f')
('3.2.0.0', '{\\bm w}')
('3.2.0.0', '{\\bm v}')
('3.2.0.0', '\\nabla^2 f({\\bm w})[{\\bm v}] \n  = \\nabla (\\partial f(\\cdot)[{\\bm v}])({\\bm w}),')
('3.2.0.0', '(\\partial f(\\cdot)[{\\bm v}])({\\bm w}) \\coloneqq \\partial f({\\bm w})[{\\bm v}]')
('3.2.0.0', '{\\bm w}')
('3.2.0.0', '{\\bm v}')
('3.2.0.0', '\\mathcal{E}= \\mathbb{R}^P')
('3.2.0.0', 'P')
('3.2.0.0', '\\nabla^2 f({\\bm w})[{\\bm v}] = (\\partial^2 f({\\bm w})[{\\bm v}, {\\bm e}_i])_{i=1}^P.')
('3.2.0.0', '\\nabla^2 f({\\bm w})[{\\bm v}]')
('3.2.0.0', '\\partial (\\nabla f)({\\bm w})^*[{\\bm v}]')
('3.2.0.0', '\\partial (\\nabla f)({\\bm w})[{\\bm v}]')
('3.2.0.0', '\\nabla (\\partial f(\\cdot)[{\\bm v}])({\\bm w})')
('3.2.0.0', '(\\partial^2 f({\\bm w})[{\\bm v}, {\\bm e}_i])_{i=1}^P')
('3.2.0.1', 'f \\coloneqq f_K \\circ \\dots \\circ\nf_1')
('3.2.0.1', 'f_k \\colon \\mathbb{R}^P \\to \\mathbb{R}^P')
('3.2.0.1', 'k \\in \\{1, \\dots, K-1\\}')
('3.2.0.1', 'f_K \\colon \\mathbb{R}^P\n\\to \\mathbb{R}')
('3.2.0.1', 'f = f_K \\circ \\dots \\circ f_1')
('3.2.0.1', '\\nabla f')
('3.2.0.1', '\\partial f_k({\\bm s}_{k-1})[{\\bm r}_k]')
('3.2.0.1', '{\\bm s}_{k-1}')
('3.2.0.1', '{\\bm r}_k')
('3.2.0.1', '{\\bm s}_0')
('3.2.0.1', '{\\bm s}_{k-1}, {\\bm r}_k \\mapsto \\partial\nf_k({\\bm s}_{k-1})[{\\bm r}_k]')
('3.2.0.1', '\\nabla f')
('3.2.0.1', '\\nabla f')
('3.2.0.1', 'f=f_K \\circ \\ldots f_1')
('3.2.0.1', 'f')
('3.2.0.1', '\\nabla f')
('3.2.0.1', '\\nabla^2 f({\\bm x})[{\\bm v}]')
('3.2.0.1', '\\nabla f')
('3.2.0.1', '{\\bm s}_{k-1},\n  {\\bm r}_k \\mapsto \\partial f_k({\\bm s}_{k-1})[{\\bm r}_k]')
('3.2.0.1', '\\nabla f')
('3.2.0.1', '\\nabla^2 f({\\bm x})[{\\bm v}]')
('3.2.0.1', '\\partial f_k({\\bm s}_{k-1})')
('3.2.0.1', 'O(KP^2)')
('3.2.0.1', 'O(KP)')
('3.2.0.1', 'O(KP^2)')
('3.2.0.1', 'O(KP)')
('3.2.0.1', 'O(KP^2)')
('3.2.0.1', 'O(KP)')
('3.2.0.1', 'O(KP^3)')
('3.2.0.1', 'O(3P)')
('3.2.0.1', 'P')
('3.2.0.1', '{\\bm e}_1,\\dots,{\\bm e}_P')
('3.2.0.1', '{\\bm r}_k')
('3.2.0.1', '{\\bm t}_k')
('3.2.0.1', '{\\bm s}_{k-1},\n{\\bm t}_{k-1} \\mapsto \\partial f_k({\\bm s}_{k-1})[{\\bm t}_{k-1}]')
('3.2.0.1', 'f')
('3.2.1.0', '\\nabla^2 L({\\bm w})')
('3.2.1.0', 'L \\colon \\mathcal{W}\\to \\mathbb{R}')
('3.2.1.0', 'L({\\bm w})')
('3.2.1.0', 'L({\\bm w}+ {\\bm v}) \\approx \\langle \\nabla L({\\bm w}), {\\bm v}\\rangle\n+ \\frac{1}{2} \\langle {\\bm v}, \\nabla^2 L({\\bm w}) {\\bm v}\\rangle.')
('3.2.1.0', 'L')
('3.2.1.0', '\\nabla^2 L({\\bm w})')
('3.2.1.0', '{\\bm v}')
('3.2.1.0', 'L = \\ell \\circ f')
('3.2.1.0', '\\ell')
('3.2.1.0', 'L')
('3.2.1.0', 'f')
('3.2.1.0', 'f')
('3.2.1.0', 'L \\coloneqq \\ell \\circ f')
('3.2.1.0', 'f: \\mathcal{W}\\rightarrow \\mathcal{M}')
('3.2.1.0', '\\ell:\\mathcal{M}\\rightarrow \\mathbb{R}')
('3.2.1.0', 'L = \\ell \\circ f')
('3.2.1.0', '{\\bm w}\\in \\mathcal{W}')
('3.2.1.0', '\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w}) \\coloneqq \\partial f({\\bm w})^* \\nabla^2\\ell(f({\\bm w}))\n      \\partial f({\\bm w}).')
('3.2.1.0', '\\ell')
('3.2.1.0', '\\ell')
('3.2.1.0', '\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w})')
('3.2.1.0', 'f')
('3.2.1.0', 'L({\\bm w}+ {\\bm v}) \\approx \\langle \\nabla L({\\bm w}), {\\bm v}\\rangle\n+ \\frac{1}{2} \\langle {\\bm v}, \\nabla^2_{\\mathrm{GN}}L({\\bm w}) {\\bm v}\\rangle')
('3.2.1.0', '{\\bm v}')
('3.2.1.0', 'L = \\ell \\circ f')
('3.2.1.0', 'f')
('3.2.1.0', '\\ell')
('3.2.1.0', '\\begin{aligned}\n  \\nabla^2 (\\ell \\circ f)({\\bm w})\n  & = \\partial f({\\bm w})^* \\nabla^2 \\ell(f({\\bm w})) \\partial f({\\bm w}) \n  + \\partial^2 f({\\bm w})^* [\\nabla \\ell(f({\\bm w}))] \\\\\n  & = \\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w}) + \\sum_{j=1}^{Z} \\nabla_j \\ell(f({\\bm w})) \\nabla^2\n  f_j({\\bm w}).\n\\end{aligned}')
('3.2.1.0', 'f')
('3.2.1.0', '\\nabla^2 (\\ell \\circ f)({\\bm w}) = \\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w}).')
('3.2.1.0', '\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)')
('3.2.1.0', '\\nabla^2 (\\ell \\circ f)')
('3.2.1.0', 'f')
('3.2.1.1', '\\begin{aligned}\n\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f\\circ g)({\\bm w}) \n= \\partial g({\\bm w})^* \\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)(g({\\bm w})) \\partial g({\\bm w}).\n\\end{aligned}')
('3.2.1.2', '{\\bm v}\\in \\mathcal{W}')
('3.2.1.2', '\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w})[{\\bm v}] \\coloneqq \\bm \\partial f({\\bm w})^* \\nabla^2\\ell(f({\\bm w}))\n\\bm \\partial f({\\bm w}) {\\bm v},\n\\label{higher:eq:gnvp}')
('3.2.1.2', '\\nabla^2\\ell({\\bm \\theta}){\\bm u}')
('3.2.1.2', '\\ell')
('3.2.1.2', '\\mathcal{M}')
('3.2.1.2', '\\mathcal{M}')
('3.2.1.2', 'f')
('3.2.1.2', '\\ell')
('3.2.1.2', 'f')
('3.2.1.2', '1')
('3.2.1.2', 'f')
('3.2.1.2', 'f({\\bm w})')
('3.2.1.2', '{\\bm u}\\mapsto (\\partial\nf({\\bm w})^*{\\bm u})')
('3.2.1.2', '1')
('3.2.1.2', 'f')
('3.2.1.2', '1')
('3.2.1.2', 'f')
('3.2.1.2', '{\\bm v}\\mapsto \\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w}){\\bm v}')
('3.2.1.2', '2')
('3.2.1.2', '1')
('3.2.1.2', 'f')
('3.2.1.3', '\\mathcal{W}\\subseteq \\mathbb{R}^P')
('3.2.1.3', '\\mathcal{M}\\subseteq \\mathbb{R}^M')
('3.2.1.3', '\\ell')
('3.2.1.3', '\\nabla^2_{\\mathrm{GN}}(\\ell\\circ f)({\\bm w}) =\nVV^\\top')
('3.2.1.3', 'V \\in \\mathbb{R}^{P \\times R}')
('3.2.1.3', 'R \\le \\min\\{P,M\\}')
('3.2.1.3', '\\ell')
('3.2.1.3', '\\ell')
('3.2.1.3', '\\nabla^2 \\ell(f({\\bm w})) = \\sum_{j=1}^M \\lambda_i {\\bm u}_i {\\bm u}_i^\\top')
('3.2.1.3', '{\\bm u}_i')
('3.2.1.3', '\\lambda_i \\geq 0')
('3.2.1.3', '\\begin{aligned}\n  \\nabla^2_{\\mathrm{GN}}(\\ell \\circ f) \n  & = \\sum_{j=1}^M \\lambda_i \\partial f({\\bm w})^* {\\bm u}_i {\\bm u}_i^\\top\\partial f({\\bm w})^* \\\\\n  & = \\sum_{j=1}^M \\left(\\sqrt{\\lambda_i} \\partial f({\\bm w})^* {\\bm u}_i\\right)\n  \\left(\\sqrt{\\lambda_i} \\partial f({\\bm w})^*  {\\bm u}_i\\right)^\\top \\\\\n  & = \\sum_{j=1}^M {\\bm v}_i{\\bm v}_i^\\top \n  \\quad \\mbox{where} \\ {\\bm v}_i \\coloneqq \\sqrt{\\lambda_i}\\partial f({\\bm w})^* {\\bm u}_i.\n\\end{aligned}')
('3.2.1.3', '{\\bm v}_i')
('3.2.1.3', 'V = ({\\bm v}_1, \\ldots, {\\bm v}_M)')
('3.2.1.3', '\\nabla^2_{\\mathrm{GN}}(\\ell\\circ f)({\\bm w}) = VV^\\top')
('3.2.1.3', '\\nabla^2 \\ell(f({\\bm w})) \\in \\mathbb{R}^{M \\times M}')
('3.2.1.3', 'O(M^3)')
('3.2.1.3', 'M')
('3.2.1.3', 'f')
('3.2.1.3', '{\\bm w}')
('3.2.1.3', '\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f)({\\bm w})[{\\bm v}] = V V^\\top {\\bm v}')
('3.2.1.3', 'P \\times M')
('3.2.1.3', 'f')
('3.2.1.4', 'L({\\bm w}; {\\bm x}, {\\bm y}) \\coloneqq \\ell(f({\\bm w}; {\\bm x}); {\\bm y}).')
('3.2.1.4', '({\\bm x},{\\bm y})')
('3.2.1.4', '\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, {\\bm y}) \\coloneqq \n\\partial f({\\bm w}; {\\bm x})^* \\nabla^2 \\ell({\\bm \\theta}; {\\bm y}) \\partial f({\\bm w}; {\\bm x}).')
('3.2.1.4', '\\rho')
('3.2.1.4', '({\\bm x},{\\bm y})')
('3.2.1.4', 'L({\\bm w}) \\coloneqq \\mathbb{E}_{X,Y \\sim \\rho} \\left[L({\\bm w}; X, Y)\\right]')
('3.2.1.4', '\\nabla^2_{\\mathrm{GN}}L({\\bm w}) = \\mathbb{E}_{X,Y \\sim \\rho}\\left[\\nabla^2_{\\mathrm{GN}}L({\\bm w}; X, Y)\\right].')
('3.2.2.0', 'S')
('3.2.2.0', 'L({\\bm w}; S) = -\\log q_{{\\bm w}}(S)')
('3.2.2.0', 'q_{\\bm w}')
('3.2.2.0', '{\\bm w}')
('3.2.2.0', 'L')
('3.2.2.0', '{\\bm w}')
('3.2.2.0', 'S')
('3.2.2.0', 'q_{\\bm w}')
('3.2.2.0', '\\begin{aligned}\n    \\nabla^2_{\\mathrm{F}}L ({\\bm w}) \n    &\\coloneqq \n    \\mathbb{E}_{S \\sim q_{{\\bm w}}}[\\nabla L({\\bm w}; S) \\otimes \\nabla L({\\bm w}; S)] \\\\\n    &= \\mathbb{E}_{S \\sim q_{{\\bm w}}}[\\nabla_{\\bm w}\\log q_{{\\bm w}}(S) \\otimes \\nabla_{\\bm w}\\log\n    q_{{\\bm w}}(S)].\n  \n\\end{aligned}')
('3.2.2.0', '\\nabla_{\\bm w}\\log q_{{\\bm w}}(S)')
('3.2.2.1', '{\\bm w}')
('3.2.2.1', 'L({\\bm w}; S) = -\\log\n  q_{{\\bm w}}(S)')
('3.2.2.1', '\\begin{aligned}\n    \\nabla^2_{\\mathrm{F}}L ({\\bm w}) \n    &= \\mathbb{E}_{S \\sim q_{{\\bm w}}}[\\nabla^2 L({\\bm w}; S)] \n    = \\mathbb{E}_{S \\sim q_{{\\bm w}}}[-\\nabla_{{\\bm w}}^2\\log q_{{\\bm w}}(S)].\n  \n\\end{aligned}')
('3.2.2.1', 'S')
('3.2.2.1', 'q_{\\bm w}')
('3.2.2.1', '\\rho')
('3.2.2.1', '\\begin{aligned}\n\\nabla^2_{\\mathrm{F}}L ({\\bm w})\n&=\\mathbb{E}_{S \\sim q_{{\\bm w}}}[\\nabla_{\\bm w}\\log q_{{\\bm w}}(S)\\nabla_{\\bm w}\\log\nq_{{\\bm w}}(S)^\\top] \\\\\n&\\neq\n\\mathbb{E}_{S \\sim \\rho}[\\nabla_{\\bm w}\\log q_{{\\bm w}}(S)\\nabla_{\\bm w}\\log\nq_{{\\bm w}}(S)^\\top]\n\\end{aligned}')
('3.2.2.2', 'S \\sim q_{\\bm w}')
('3.2.2.2', 'S = (X, Y)')
('3.2.2.2', 'q_{\\bm w}(X, Y) \\coloneqq \\rho_X(X) p_{\\bm \\theta}(Y)')
('3.2.2.2', '{\\bm \\theta}\\coloneqq f({\\bm w}; X)')
('3.2.2.2', '(X, Y) \\sim q_{\\bm w}')
('3.2.2.2', 'q_{\\bm w}')
('3.2.2.2', 'q_{\\bm w}(X, Y) \\coloneqq \\rho_X(X) p_{\\bm \\theta}(Y)')
('3.2.2.2', 'L({\\bm w}; {\\bm x}, {\\bm y})= -\\log q_{{\\bm w}}({\\bm x}, {\\bm y})')
('3.2.2.2', '\\begin{aligned}\n    \\nabla^2_{\\mathrm{F}}L ({\\bm w}) & = \n    \\mathbb{E}_{(X, Y) \\sim q_{\\bm w}}[\n      \\nabla_{\\bm w}\\log q_{\\bm w}(X, Y) \\otimes \\nabla_{\\bm w}\\log q_{\\bm w}(X, Y)\n      ] \\\\\n    & = \n    \\mathbb{E}_{X \\sim \\rho_X} \\left[\n      \\mathbb{E}_{Y\\sim p_{{\\bm \\theta}}}\\left[\n        \\nabla_{\\bm w}\\log p_{{\\bm \\theta}}(Y) \\otimes \\nabla_{\\bm w}\\log p_{{\\bm \\theta}}(Y)\\right]\n      \\right] \\\\\n    & = \n    \\mathbb{E}_{X \\sim \\rho_X} \\left[\n      \\partial f({\\bm w}; X)^* \\nabla^2_{\\mathrm{F}}\\ell({\\bm \\theta})\n        \\partial f({\\bm w}; X) \\right],\n  \n\\end{aligned}')
('3.2.2.2', '{\\bm \\theta}\\coloneqq f({\\bm w}; X)')
('3.2.2.2', '\\ell({\\bm \\theta}; Y) \\coloneqq -\\log p_{\\bm \\theta}(Y)')
('3.2.2.2', 'p_{\\bm \\theta}')
('3.2.2.2', 'p_{\\bm \\theta}')
('3.2.2.2', '\\begin{aligned}\n\\nabla^2_{\\mathrm{F}}L({\\bm w})\n&= \\mathbb{E}_{X \\sim \\rho_X} \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\nabla L({\\bm w}; X, Y) \\otimes \\nabla L({\\bm w}; X, Y)] \\\\\n&= \\mathbb{E}_{X \\sim \\rho_X} \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\partial f({\\bm w}; X)^*\n\\nabla \\ell({\\bm \\theta}; Y) \\otimes \\nabla \\ell({\\bm \\theta}; Y)\n\\partial f({\\bm w}; X)] \\\\\n&= \\mathbb{E}_{X \\sim \\rho_X} \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\partial f({\\bm w}; X)^* \\nabla^2 \\ell({\\bm \\theta}; Y) \\partial f({\\bm w}; X)] \\\\\n&= \\mathbb{E}_{X,Y \\sim \\rho}\\left[\\nabla^2_{\\mathrm{GN}}L({\\bm w}; X, Y)\\right],\n\\end{aligned}')
('3.2.2.2', '\\rho_X({\\bm x}) \\coloneqq \\int \\rho({\\bm x}, {\\bm y})d{\\bm y}')
('3.2.2.2', 'p_{\\bm \\theta}')
('3.2.2.2', '\\nabla^2 \\ell({\\bm \\theta}, {\\bm y})')
('3.2.2.2', '{\\bm y}')
('3.2.2.2', '\\begin{aligned}\n\\nabla^2 \\ell({\\bm \\theta}; \\cdot) \n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\\nabla^2 \\ell({\\bm \\theta}; Y)] \\\\\n&=\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[\\nabla^2 \\ell({\\bm \\theta}; Y)] \\\\\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[-\\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)] \\\\\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y) \\otimes \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)] \\\\\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[\\nabla \\ell({\\bm \\theta}; Y) \\otimes \\nabla \\ell({\\bm \\theta}; Y)],\n\\end{aligned}')
('3.2.2.2', '\\cdot')
('3.2.2.2', '{\\bm y}')
('3.2.3.0', '\\begin{aligned}\n  {\\bm w}^{t+1} \n  & = {\\bm w}^t - \\nabla^2 L({\\bm w}^t)^{-1}\\nabla L({\\bm w}^t).\n\\end{aligned}')
('3.2.3.0', 'L')
('3.2.3.0', 'L:\\mathbb{R}^P \\rightarrow \\mathbb{R}')
('3.2.3.0', 'L')
('3.2.3.0', '{\\bm w}\\in \\mathbb{R}^P')
('3.2.3.0', '{\\bm u}\\mapsto \\nabla^2 L({\\bm w})^{-1} {\\bm u},')
('3.2.3.0', '{\\bm u}')
('3.2.3.0', '{\\bm v}')
('3.2.3.0', '\\nabla^2 L({\\bm w}) {\\bm v}= {\\bm u}')
('3.2.3.1', 'H[{\\bm v}] = {\\bm u}')
('3.2.3.1', '{\\bm v}\\mapsto H[{\\bm v}]')
('3.2.3.1', '{\\bm v}')
('3.2.3.1', 'H')
('3.2.3.1', '\\langle {\\bm v}, H[{\\bm v}]\\rangle >0')
('3.2.3.1', '{\\bm v}\n\\neq 0')
('3.2.3.1', 'H')
('3.2.3.1', '\\nabla^2 L({\\bm w})^{-1} {\\bm u}\\approx \\mathrm{CG}(\\nabla^2 L({\\bm w})[\\cdot], {\\bm u}).')
('3.2.3.1', 'T= P')
('3.2.3.1', 'H[\\cdot]: \\mathbb{R}^P \\rightarrow \\mathbb{R}^P')
('3.2.3.1', '{\\bm u}\\in \\mathbb{R}^P')
('3.2.3.1', '{\\bm v}_0')
('3.2.3.1', '{\\mathbf{0}}')
('3.2.3.1', 'T')
('3.2.3.1', 'P')
('3.2.3.1', '\\varepsilon')
('3.2.3.1', '{\\bm r}_0 = {\\bm u}- H[{\\bm v}_0]')
('3.2.3.1', '{\\bm p}_0 = {\\bm r}_0')
('3.2.3.1', '\\alpha_t = \\frac{\\langle {\\bm r}_t, {\\bm r}_t \\rangle}{\\langle {\\bm p}_t, H\n      [{\\bm p}_t]\\rangle}')
('3.2.3.1', '{\\bm v}_{t+1} = {\\bm v}_t + \\alpha_t {\\bm p}_t')
('3.2.3.1', '{\\bm r}_{t+1} = {\\bm r}_t - \\alpha_t H[{\\bm p}_t]')
('3.2.3.1', '\\langle {\\bm r}_{t+1},\n      {\\bm r}_{t+1} \\rangle \\leq \\varepsilon')
('3.2.3.1', '\\beta_t = \\frac{\\langle {\\bm r}_{t+1}, {\\bm r}_{t+1} \\rangle}{\\langle {\\bm r}_t,\n      {\\bm r}_t \\rangle}')
('3.2.3.1', '{\\bm p}_{t+1} = {\\bm r}_{t+1} + \\beta_t {\\bm p}_t')
('3.2.3.1', '{\\bm v}_T')
('3.2.3.1', 'H[{\\bm v}_T] \\approx {\\bm u}')
('3.2.3.2', 'H \\in \\mathbb{R}^{P \\times P}')
('3.2.3.2', 'H {\\bm v}= {\\bm u}')
('3.2.3.2', 'O(P^3)')
('3.2.3.2', 'O(P^2)')
('3.2.3.2', 'O(P)')
('3.2.3.2', 'O(P^3)')
('3.2.3.2', 'P')
('3.2.3.2', 'H')
('3.2.3.2', 'O(P^3)')
('3.2.3.2', 'O(P^2)')
('3.2.3.2', 'H')
('3.2.3.2', 'H')
('3.2.3.2', 'H')
('3.2.3.2', '{\\bm e}_i^\\top H\n{\\bm e}_j = H_{i,j}')
('3.2.3.2', 'H')
('3.2.3.2', 'P')
('3.2.4.0', 'h = g \\circ f')
('3.2.4.0', '\\partial^2 h({\\bm w})^*[{\\bm u}] \n  \\coloneqq \\nabla^2 \\langle h, {\\bm u}\\rangle({\\bm w}) \\in \\mathbb{R}^{P \\times P},')
('3.2.4.0', 'h: \\mathbb{R}^P \\rightarrow \\mathbb{R}^Q')
('3.2.4.0', '{\\bm w}\\in \\mathbb{R}^P')
('3.2.4.0', '{\\bm u}\\in \\mathbb{R}^Q')
('3.2.4.0', '\\langle {\\bm u}, h\\rangle({\\bm w}) \\coloneqq \\langle {\\bm u}, h({\\bm w})\\rangle')
('3.2.4.0', '{}^*')
('3.2.4.0', '{\\bm v}_1, {\\bm v}_2 \\mapsto \\partial^2 h({\\bm w})[{\\bm v}_1, {\\bm v}_2]')
('3.2.4.0', 'f: \\mathbb{R}^P \\rightarrow \\mathbb{R}^M')
('3.2.4.0', 'g: \\mathbb{R}^M\n  \\rightarrow \\mathbb{R}^Q')
('3.2.4.0', 'g \\circ f')
('3.2.4.0', '\\mathbb{R}^P\\times \\mathbb{R}^P')
('3.2.4.0', '\\mathbb{R}^Q')
('3.2.4.0', '{\\bm v}_1, {\\bm v}_2 \\in \\mathbb{R}^P')
('3.2.4.0', '\\begin{aligned}\n    \\partial^2 (g\\circ f)({\\bm w})[{\\bm v}_1, {\\bm v}_2]\n    & = \\partial g(f({\\bm w}))[\\partial^2 f({\\bm w})[{\\bm v}_1, {\\bm v}_2]] \\\\\n    & \\quad + \\partial^2 g(f({\\bm w}))[\\partial f({\\bm w})[{\\bm v}_1], \\partial f({\\bm w})[{\\bm v}_2]].\n  \n\\end{aligned}')
('3.2.4.0', 'g\\circ f')
('3.2.4.0', '{\\bm u}\\in\n  \\mathbb{R}^Q')
('3.2.4.0', '\\begin{aligned}\n    \\partial^2 (g\\circ f)({\\bm w})^*[{\\bm u}] \n    & = \\partial^2 f({\\bm w})^* [\\partial g(f({\\bm w}))^* {\\bm u}] \\label{higher:eq:hbp} \\\\\n    & \\quad + \\partial f({\\bm w})^* \\partial^2 g(f({\\bm w}))^*[{\\bm u}] \\partial f({\\bm w}). \\nonumber\n  \n\\end{aligned}')
('3.2.4.0', 'f \\colon \\mathbb{R}^P \\to \\mathbb{R}^M')
('3.2.4.0', '\\ell \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('3.2.4.0', '\\begin{aligned}\n    \\nabla^2 (\\ell \\circ f)({\\bm w})\n    & = \\sum_{j=1}^M (\\nabla \\ell(f({\\bm w})))_j \\nabla^2 f_j({\\bm w})\\\\\n    & \\quad + \\bm \\partial f({\\bm w})^\\top \\nabla^2 \\ell(f({\\bm w})) \\bm \\partial f({\\bm w}).\n  \n\\end{aligned}')
('3.2.4.0', 'h \\colon \\mathbb{R}^P \\to \\mathbb{R}')
('3.2.4.0', 'h \\colon \\mathbb{R}^P \\to \\mathbb{R}^Q')
('3.2.4.0', '\\partial^2 f({\\bm w})^* [\\partial g(f({\\bm w}))^* {\\bm u}]')
('3.2.4.0', '\\partial f({\\bm w})^* \\partial^2\ng(f({\\bm w}))^*[{\\bm u}] \\partial f({\\bm w})')
('3.2.4.0', 'f({\\bm x}) = (f(x_i))_{i=1}^M')
('3.2.4.0', '\\ell')
('3.2.4.0', "\\nabla^2 f_i({\\bm x}) = f''(x_i) {\\bm e}_i{\\bm e}_i^\\top")
('3.2.4.0', "\\begin{aligned}\n    \\nabla^2 (\\ell\\circ f)({\\bm x})\n    & = \\sum_{i=1}^M (\\nabla \\ell(f({\\bm x})))_i f''(x_i) {\\bm e}_i{\\bm e}_i^\\top \\\\\n    & \\quad + \\operatorname{\\bf diag}(f'({\\bm x})) \\nabla^2 \\ell(f({\\bm x})) \\operatorname{\\bf diag}(f'({\\bm x})) \\\\\n    & = \\operatorname{\\bf diag}(\\nabla \\ell(f({\\bm w})) \\odot f''({\\bm x}))\\\\\n    & \\quad + \\nabla^2 \\ell(f({\\bm x})) \\odot (f'({\\bm x}) f'({\\bm x})^\\top),\n  \n\\end{aligned}")
('3.2.4.0', "f'({\\bm x}) \\coloneqq (f'(x_i))_{i=1}^M")
('3.2.4.0', "f''({\\bm x}) \\coloneqq (f''(x_i))_{i=1}^M")
('3.2.4.0', 'f({\\bm W}) = {\\bm W}{\\bm x}')
('3.2.4.0', '{\\bm W}\\in \\mathbb{R}^{M\\times D}')
('3.2.4.0', '\\ell: \\mathbb{R}^M \\rightarrow \\mathbb{R}')
('3.2.4.0', '\\begin{aligned}\n    \\nabla^2 (\\ell\\circ f)({\\bm W}) = \\partial f({\\bm W})^* \n    \\nabla^2 \\ell(f({\\bm W})) \\partial f({\\bm W}).\n  \n\\end{aligned}')
('3.2.4.0', '\\partial f({\\bm W})[{\\bm V}] =\n  {\\bm V}{\\bm x}')
('3.2.4.0', '\\partial f({\\bm W})^*[{\\bm u}] = {\\bm u}{\\bm x}^\\top')
('3.2.4.0', '\\begin{aligned}\n    \\nabla^2 (\\ell\\circ f)({\\bm W})[{\\bm V}] \n    & = \\partial f({\\bm W})^*[\n      \\nabla^2 \\ell(f({\\bm W})) [\\partial f({\\bm W})[{\\bm V}]]] \n    & = {\\bm H}{\\bm V}{\\bm x}{\\bm x}^\\top,\n  \n\\end{aligned}')
('3.2.4.0', '{\\bm H}\\coloneqq \\nabla^2 \\ell(f({\\bm W}))')
('3.2.4.1', 'f = f_K\\circ \\ldots \\circ f_1')
('3.2.4.1', '{\\bm r}_k')
('3.2.4.1', '\\bm{R}_k')
('3.2.4.1', 'f \\coloneqq f_K \\circ \\ldots \\circ f_1')
('3.2.4.1', '{\\bm x}')
('3.2.4.1', '{\\bm u}')
('3.2.4.1', '{\\bm s}_0 \\coloneqq {\\bm x}')
('3.2.4.1', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{k-1})')
('3.2.4.1', '{\\bm r}_K \\coloneqq \\nabla \\ell({\\bm s}_K), \\ \\bm{R}_K \\coloneqq \\nabla^2 \\ell({\\bm s}_K)')
('3.2.4.1', '{\\bm r}_{k-1} \\coloneqq \\partial f_k({\\bm s}_{k-1})^*[{\\bm r}_k]')
('3.2.4.1', '\\bm{R}_{k-1} \\coloneqq \\partial^2 f_k({\\bm s}_{k-1})^*[{\\bm r}_k] \n        + \\partial f_k({\\bm s}_{k-1})^* \\bm{R}_k \\partial f_k({\\bm s}_{k-1})')
('3.2.4.1', '{\\bm s}_{k-1}')
('3.2.4.1', '\\ell(f({\\bm x})) = \\ell({\\bm s}_K)')
('3.2.4.1', '\\nabla(\\ell \\circ f)({\\bm x}) = {\\bm r}_0')
('3.2.4.1', '\\nabla^2(\\ell \\circ f)({\\bm x}) = \\bm{R}_0')
('3.2.4.2', 'n+1')
('3.2.4.2', 'f_1, \\ldots, f_n')
('3.2.4.2', 'g')
('3.2.4.2', 'f_i: \\mathbb{R}^P \\rightarrow \\mathbb{R}^{M_i}')
('3.2.4.2', 'g: \\mathbb{R}^{M_1} \\times \\ldots \\times\n  \\mathbb{R}^{M_n} \\rightarrow \\mathbb{R}^Q')
('3.2.4.2', 'g \\circ f')
('3.2.4.2', 'f({\\bm w})= (f_1({\\bm w}), \\ldots, f_n({\\bm w}))')
('3.2.4.2', '{\\bm u}\\in \\mathbb{R}^Q')
('3.2.4.2', '\\begin{aligned}\n    \\partial^2 (g \\circ f)({\\bm w})^*[{\\bm u}] \n    & = \\sum_{i=1}^n \\partial^2 f_i({\\bm w})^*[ \\partial_i g(f({\\bm w}))^*[{\\bm u}]] \\\\\n    & \\quad + \\sum_{i, j=1}^n \n    \\partial f_i({\\bm w})^* \n    \\partial^2_{i, j} g(f({\\bm w}))^*[{\\bm u}]\n    \\partial f_j({\\bm w}).\n  \n\\end{aligned}')
('3.2.4.2', 'f_i')
('3.2.4.2', '\\partial f_i({\\bm w})^* \\partial^2_{i, j} g(f({\\bm w}))^*[{\\bm u}] \\partial f_j({\\bm w})')
('3.2.4.2', 'i \\neq j')
('3.2.4.2', 'f_i')
('3.2.4.2', 'n+1')
('3.2.4.2', 'g_1, \\ldots, g_n')
('3.2.4.2', 'f')
('3.2.4.2', 'g_i: \\mathbb{R}^M \\rightarrow \\mathbb{R}^{Q_i}')
('3.2.4.2', 'f: \\mathbb{R}^{P} \\rightarrow \\mathbb{R}^M')
('3.2.4.2', 'g \\circ f')
('3.2.4.2', 'g({\\bm w})= (g_1({\\bm w}), \\ldots, g_n({\\bm w}))')
('3.2.4.2', '{\\bm u}= ({\\bm u}_1, \\ldots, {\\bm u}_n) \\in \\mathbb{R}^{Q_1} \\times \\ldots \\times\n  \\mathbb{R}^{Q_n}')
('3.2.4.2', '\\begin{aligned}\n    \\partial^2 (g \\circ f)({\\bm w})^*[{\\bm u}] \n    & = \\sum_{i=1}^n \\partial^2 f({\\bm w})^*[ \\partial g_i(f({\\bm w}))^*[{\\bm u}_i]] \\\\\n    & \\quad + \\sum_{i=1}^n \n    \\partial f({\\bm w})^* \n    \\partial^2 g_i(f({\\bm w}))^*[{\\bm u}]\n    \\partial f({\\bm w}).\n  \n\\end{aligned}')
('3.2.5.0', '\\begin{aligned}\n    {\\bm s}_0 &\\coloneqq {\\bm x}\\\\\n    {\\bm s}_k &\\coloneqq f_k({\\bm s}_{k-1}, {\\bm w}_k) ~ \\forall k \\in \\{1, \\ldots, K\\} \\\\\n    f({\\bm x}, {\\bm w}) &\\coloneqq {\\bm s}_K,\n\\end{aligned}')
('3.2.5.0', '{\\bm w}\\coloneqq ({\\bm w}_1, \\dots, {\\bm w}_K)')
('3.2.5.0', '\\ell \\circ f')
('3.2.5.0', '{\\bm w}')
('3.2.5.0', '{\\bm w}_k')
('3.2.5.0', '\\bm{R}_{k-1} \\coloneqq \\partial^2 f_k({\\bm s}_{k-1})^*[{\\bm r}_k] \n    + \\partial f_k({\\bm s}_{k-1})^* \\bm{R}_k \\partial f_k({\\bm s}_{k-1}).')
('3.2.5.0', '{\\bm r}_K \\coloneqq \\nabla \\ell({\\bm s}_K)')
('3.2.5.0', '\\bm{R}_K \\coloneqq \\nabla^2 \\ell({\\bm s}_K)')
('3.2.5.0', '\\begin{aligned}\n  {\\bm r}_{k-1} &\\coloneqq \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)^*[{\\bm r}_k] \\\\\n  \\begin{pmatrix}\n      \\bm{R}_{k-1} & \\sim \\\\\n      \\sim & \\bm{H}_k\n  \\end{pmatrix} & \\coloneqq \\partial^2 f_k({\\bm s}_{k-1}, {\\bm w}_k)^*[{\\bm r}_k] \\nonumber \\\\\n& \\quad + \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)^* \\bm{R}_k \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k), \\nonumber\n\\end{aligned}')
('3.2.5.0', '\\sim')
('3.2.5.0', '\\begin{aligned}\n    \\bm{R}_0 &= \\nabla_{{\\bm x}{\\bm x}}^2 (\\ell\\circ f)({\\bm x}, {\\bm w}) \\\\\n    {\\bm H}_1 &= \\nabla_{{\\bm w}_1{\\bm w}_1}^2(\\ell\\circ f)({\\bm x}, {\\bm w}) \\\\\n        &\\vdots \\\\\n    {\\bm H}_K &= \\nabla_{{\\bm w}_K{\\bm w}_K}^2(\\ell\\circ f)({\\bm x}, {\\bm w})).\n\\end{aligned}')
('3.2.5.0', '{\\bm w}_k')
('3.2.5.0', '{\\bm w}_k')
('3.2.5.0', '\\tilde{f}_K \\circ \\ldots \\circ \\tilde{f}_{k+1} \\circ f_k({\\bm s}_{k-1}, {\\bm w}_k)')
('3.2.5.0', '\\tilde{f}_i \\coloneqq f_i(\\cdot, {\\bm w}_k)')
('3.2.5.0', 'i \\in \\{k+1,\\dots,K\\}')
('3.2.5.0', '\\begin{aligned}\n    \\begin{pmatrix}\n        \\bm{R}_{k-1} & \\sim \\\\\n      \\sim & {\\bm G}_k\n    \\end{pmatrix} & \n    \\coloneqq \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k)^* \\bm{R}_k \\partial f_k({\\bm s}_{k-1}, {\\bm w}_k), \\nonumber\n  \n\\end{aligned}')
('3.2.5.0', '\\bm{R}_K \\coloneqq \\nabla^2 \\ell({\\bm s}_K)')
('3.2.5.0', '\\bm{R}_0, {\\bm G}_0, \\ldots, {\\bm G}_K')
('3.2.5.0', 'f_k({\\bm s}_{k-1}, {\\bm w}_k) \\coloneqq {\\bm a}({\\bm W}_k {\\bm s}_{k-1})\n  \\quad \\text{with} \\quad {\\bm w}_k \\coloneqq \\operatorname{vec}({\\bm W}_k)')
('3.2.5.0', 'k=K, \\ldots, 1')
('3.2.5.0', "\\begin{aligned}\n      \\bm{R}_{k-1} &\\coloneqq {\\bm W}_k^\\top {\\bm J}_k {\\bm W}_k \\\\\n      {\\bm J}_k &\\coloneqq \\bm{R}_k \\odot ({\\bm a}'({\\bm W}_k {\\bm s}_{k-1}){\\bm a}'({\\bm W}_k{\\bm s}_{k-1})^\\top ) \\\\\n    {\\bm G}_k &\\coloneqq {\\bm J}_k \\otimes {\\bm s}_{k-1} {\\bm s}_{k-1}^\\top\n  \n\\end{aligned}")
('3.2.5.0', '\\bm{R}_K \\coloneqq \\nabla^2 \\ell({\\bm s}_K)')
('3.2.5.0', '{\\bm G}_1,\n  \\ldots, {\\bm G}_K')
('3.2.5.0', 'f')
('3.2.5.0', '{\\bm w}_1, \\ldots, {\\bm w}_K')
('3.2.5.1', 'f({\\bm x}, {\\bm w})')
('3.2.5.1', 'i_1, \\ldots, i_{p_k} \\coloneqq {\\operatorname{pa}}(k)')
('3.2.5.1', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}}) \\quad\n  \\forall k \\in \\{1, \\ldots, K\\}')
('3.2.5.1', 'f({\\bm x}, {\\bm w}) = {\\bm s}_K')
('3.2.5.1', 'k')
('3.2.5.1', 'k = K, \\ldots, 1')
('3.2.5.1', 'j \\in {\\operatorname{pa}}(k)')
('3.2.5.1', '\\begin{aligned}\n\\label{higher:eq:hbp_graphs}\n  {\\bm r}_{i_j} & \\leftarrow {\\bm r}_{i_j} + \\partial_j f_k({\\bm s}_{i_1}, \\ldots,\n  s_{i_{p_k}})^*[{\\bm r}_k] \\\\\n  R_{i_j} & \\leftarrow R_{i_j} + \\partial^2_{jj} f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}})^*[{\\bm r}_k] \\nonumber\\\\\n  & \\quad \n  + \\partial_j f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}})^* R_k \\partial_j\n  f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}}),\n\\end{aligned}')
('3.2.5.1', 'R_K \\coloneqq \\nabla^2 \\ell({\\bm s}_K)')
('3.2.5.1', '{\\bm r}_K \\coloneqq \\nabla\n\\ell({\\bm s}_K)')
('3.2.5.1', '\\ell(f_1({\\bm w}),\nf_2({\\bm w}))')
('3.2.5.1', 'f')
('3.2.6.0', '{\\bm M}\\in \\mathbb{R}^{D \\times D}')
('3.2.6.0', '\\operatorname{\\bf diag}({\\bm M}) = ({\\bm M}_{ii})_{i=1}^D \\in \\mathbb{R}^{D}')
('3.2.6.0', '{\\bm M}')
('3.2.6.0', '{\\bm m}\\in \\mathbb{R}^D')
('3.2.6.0', '\\operatorname{\\bf Diag}({\\bm m}) = \\sum_{i=1}^D\nm_i{\\bm e}_i{\\bm e}_i^\\top')
('3.2.6.0', 'm_i')
('3.2.6.0', '\\ell \\circ f_K \\circ \\ldots \\circ f_1')
('3.2.6.0', '\\operatorname{\\bf diag}({\\bm H}_{k-1})')
('3.2.6.0', '{\\bm H}_k')
('3.2.6.0', '\\begin{aligned}\n\\operatorname{\\bf diag}({\\bm H}_{k-1}) = & \\operatorname{\\bf diag}(\\partial^2 f_k({\\bm s}_{k-1})^* {\\bm r}_k) \\\\\n& + \\operatorname{\\bf diag}(\\bm \\partial f_k({\\bm s}_{k-1})^* {\\bm H}_k \\bm \\partial f_k({\\bm s}_{k-1})).\n\\end{aligned}')
('3.2.6.0', '{\\bm H}_k')
('3.2.6.0', '\\operatorname{\\bf diag}({\\bm H}_k)')
('3.2.6.0', '\\begin{aligned}\n{\\bm d}_{k-1}\n\\coloneqq &\\operatorname{\\bf diag}(\\partial^2 f_k({\\bm s}_{k-1})^* {\\bm r}_k) \\\\\n& + \\operatorname{\\bf diag}(\\bm \\partial f_k({\\bm s}_{k-1})^* \\operatorname{\\bf Diag}({\\bm d}_k) \\bm \\partial f_k({\\bm s}_{k-1})).\n\\end{aligned}')
('3.2.6.0', '\\operatorname{\\bf Diag}({\\bm d}_k)')
('3.2.6.0', '{\\bm H}_k')
('3.2.6.0', 'D_k')
('3.2.6.0', '\\begin{aligned}\nd_{k-1,i} =\n&\\sum_{j=1}^{D_k} r_{k,j} \\cdot \\partial_{i,i}^2 f_{k,j}({\\bm s}_{k-1}) +\n\\sum_{j=1}^{D_k} d_{k,j} (\\partial_i f_{k,j}({\\bm s}_{k-1}))^2.\n\\end{aligned}')
('3.2.6.0', '{\\bm d}_K \\coloneqq \\operatorname{\\bf diag}(\\nabla^2\n\\ell({\\bm s}_K))')
('3.2.6.0', '{\\bm H}_K')
('3.2.6.0', '\\nabla^2\\ell({\\bm s}_K)')
('3.2.6.0', '\\operatorname{\\bf Diag}({\\bm d}_K)')
('3.2.6.0', 'f_K')
('3.2.6.0', '{\\bm d}_0 \\approx \\operatorname{\\bf diag}(\\nabla^2 (\\ell\\circ f)({\\bm x}))')
('3.2.6.0', '{\\bm r}_k')
('3.2.6.0', '{\\bm d}_k')
('3.2.6.0', '{\\bm r}_0 = \\nabla (\\ell\\circ f)({\\bm x})')
('3.2.6.1', 'f({\\bm x}, {\\bm w})')
('3.2.6.1', '\\begin{aligned}\n  {\\bm r}_{i_j} & \\leftarrow {\\bm r}_{i_j} + \\partial_j f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}})^*[{\\bm r}_k]\n  \\nonumber\n  \\\\\n  {\\bm d}_{i_j} & \\leftarrow {\\bm d}_{i_j} \n  + \\operatorname{\\bf diag}(\\partial^2_{jj} f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}})^*[{\\bm r}_k]) \\nonumber\\\\\n  & \\quad \n  + \\operatorname{\\bf diag}(\n  \\partial_j f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}})^* \n  \\operatorname{\\bf Diag}({\\bm d}_k) \n  \\partial_j f_k({\\bm s}_{i_1}, \\ldots, s_{i_{p_k}})\n  ),\n    \\label{higher:eq:diag_approx_graphs}\n\\end{aligned}')
('3.2.6.1', 'j \\in {\\operatorname{pa}}(k)')
('3.2.6.1', '{\\bm r}_K = \\nabla \\ell({\\bm s}_K)')
('3.2.6.1', '{\\bm d}_K =\n\\operatorname{\\bf diag}(\\nabla^2 \\ell({\\bm s}_K))')
('3.2.6.1', '\\operatorname{\\bf Diag}({\\bm d}_K) = \\nabla^2 \\ell({\\bm s}_K)')
('3.2.6.1', '\\begin{aligned}\n    {\\bm s}_{k} &\\coloneqq {\\bm a}_k({\\bm W}_k {\\bm s}_{k-1}) \\quad \\forall k \\in \\{1,\\dots,K-1\\}\\\\\n    f({\\bm w}, {\\bm x}) &\\coloneqq {\\bm s}_K\n\\end{aligned}')
('3.2.6.1', '{\\bm s}_0 = {\\bm x}')
('3.2.6.1', '{\\bm a}_k')
('3.2.6.1', '{\\bm w}')
('3.2.6.1', '{\\bm W}_1,\n\\ldots, {\\bm W}_K')
('3.2.6.1', '{\\bm t}_k = {\\bm W}_k {\\bm s}_{k-1}')
('3.2.6.1', "\\begin{aligned}\n  {\\bm r}_{k-1} &\\coloneqq {\\bm W}_k^\\top ({\\bm a}'({\\bm t}_k) \\odot {\\bm r}_k) \\\\\n  {\\bm g}_k &\\coloneqq \\operatorname{vec}(({\\bm a}'({\\bm t}_k) \\odot {\\bm r}_k) {\\bm s}_{k-1}^\\top) \\\\ \n  {\\bm \\delta}_k &\\coloneqq {\\bm r}_k \\odot {\\bm a}''({\\bm t}_k) + {\\bm d}_k\\odot {\\bm a}'({\\bm t}_k)^2 \\\\\n  {\\bm d}_{k-1} &\\coloneqq \\left(\\sum_{j=1}^{D_k} {\\bm W}_{k, i j}^2 \\delta_{k, j}\\right)_{i=1}^{D_k}  \\\\\n  {\\bm h}_k &\\coloneqq \\operatorname{vec}({\\bm \\delta}_k ({\\bm s}_{k-1}^2)^\\top)\n\\end{aligned}")
('3.2.6.1', '{\\bm r}_K = \\nabla \\ell({\\bm s}_K)')
('3.2.6.1', '{\\bm d}_K = \\operatorname{\\bf diag}(\\nabla^2\n\\ell({\\bm s}_K))')
('3.2.6.1', '{\\bm g}_1, \\ldots, {\\bm g}_K')
('3.2.6.1', 'f')
('3.2.6.1', '{\\bm w}_1, \\ldots, {\\bm w}_K')
('3.2.6.1', '{\\bm w}_i = \\operatorname{vec}({\\bm W}_i)')
('3.2.6.1', '{\\bm h}_1, \\ldots,\n{\\bm h}_K')
('3.2.6.1', '{\\bm w}_1, \\ldots,\n{\\bm w}_K')
('3.2.7.0', '{\\bm A}\\in \\mathbb{R}^{P \\times P}')
('3.2.7.0', '{\\bm \\omega}\\in \\mathbb{R}^P')
('3.2.7.0', '\\mathbb{E}_{{\\bm \\omega}\\sim p}[{\\bm \\omega}{\\bm \\omega}^\\top] = I')
('3.2.7.0', 'p = \\mathrm{Uniform}(\\{-1, 1\\})')
('3.2.7.0', 'p = \\mathrm{Normal}(0, I)')
('3.2.7.0', '\\mathbb{E}_{{\\bm \\omega}\\sim p}[\\langle {\\bm \\omega}, {\\bm A}{\\bm \\omega}\\rangle] = \\operatorname{tr}({\\bm A}).')
('3.2.7.0', '{\\bm A}')
('3.2.7.0', '\\mathbb{E}_{{\\bm \\omega}\\sim p}[{\\bm \\omega}\\odot {\\bm A}{\\bm \\omega}] \n= \\operatorname{\\bf Diag}({\\bm A}),')
('3.2.7.0', '\\odot')
('3.2.7.0', '{\\bm A}')
('3.2.7.0', '\\operatorname{\\bf Diag}({\\bm A}) \\approx\n\\frac{1}{S}\n\\sum_{i=1}^S {\\bm \\omega}_i \\odot {\\bm A}{\\bm \\omega}_i,')
('3.2.7.0', 'S \\to \\infty')
('3.2.7.0', 'S')
('3.2.7.1', 'L({\\bm w}; {\\bm x}, {\\bm y}) \\coloneqq \\ell(f({\\bm w}; {\\bm x}); {\\bm y})')
('3.2.7.1', '\\ell')
('3.2.7.1', '\\ell({\\bm \\theta}; {\\bm y}) \\coloneqq -\\log p_{\\bm \\theta}({\\bm y})')
('3.2.7.1', '{\\bm \\theta}\\coloneqq f({\\bm w}; {\\bm x})')
('3.2.7.1', 'f')
('3.2.7.1', '\\begin{aligned}\n\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, \\cdot) \n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\partial f({\\bm w}; {\\bm x})^*\n\\nabla \\ell({\\bm \\theta}; Y) \\otimes \\nabla \\ell({\\bm \\theta}; Y)\n\\partial f({\\bm w}; {\\bm x})] \\\\\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\nabla L({\\bm w}; {\\bm x}, Y) \\otimes \\nabla L({\\bm w}; {\\bm x}, Y)],\n\\end{aligned}')
('3.2.7.1', '\\cdot')
('3.2.7.1', '\\begin{aligned}\n\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, \\cdot) \n\\approx \n\\frac{1}{S} \\sum_{j=1}^S [\\nabla L({\\bm w}; {\\bm x}, {\\bm y}_{i_j}) \\otimes \\nabla L({\\bm w}; {\\bm x},\n{\\bm y}_{i_j})]\n\\end{aligned}')
('3.2.7.1', '{\\bm y}_{i_1},\\dots,{\\bm y}_{i_S} \\sim p_{\\bm \\theta}')
('3.2.7.1', '{\\bm \\theta}= f({\\bm w}, {\\bm x})')
('3.2.7.1', 'S')
('3.2.7.2', '\\operatorname{\\bf diag}(\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, \\cdot))\n= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\nabla L({\\bm w}; {\\bm x}, Y) \\odot \\nabla L({\\bm w}; {\\bm x}, Y)],')
('3.2.7.2', '\\odot')
('3.2.7.2', '{\\bm y}_{i_1}, \\dots, {\\bm y}_{i_S}')
('3.2.7.2', 'p_{\\bm \\theta}')
('3.2.7.2', '\\operatorname{\\bf diag}(\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, \\cdot))\n\\approx\n\\frac{1}{S}\n\\sum_{j=1}^S \\nabla L({\\bm w}; {\\bm x}, {\\bm y}_{i_j}) \\odot \\nabla L({\\bm w}; {\\bm x}, {\\bm y}_{i_j}),')
('3.2.7.2', 'p_{\\bm \\theta}')
('3.2.7.2', '\\begin{aligned}\n&\\frac{1}{S} \\operatorname{\\bf diag}(\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, \\cdot)) \\\\\n=& \\mathbb{E}_{Y_1, \\dots, Y_S \\sim p_{\\bm \\theta}}\n\\left[\\nabla \\frac{1}{S} \\sum_{i=1}^S L({\\bm w}; {\\bm x}, Y_i) \n\\odot \n\\nabla \\frac{1}{S} \\sum_{i=1}^S L({\\bm w}; {\\bm x}, Y_i)\\right].\n\\end{aligned}')
('3.2.7.2', '\\gamma_i \\coloneqq \\nabla L({\\bm w}; {\\bm x}, Y_i)')
('3.2.7.2', '\\begin{aligned}\n\\mathbb{E}\\left[\\sum_i \\gamma_i \\odot \\sum_j \\gamma_j\\right]\n&= \\mathbb{E}\\left[\\sum_i \\gamma_i \\odot \\gamma_i \n+ \\sum_{i \\neq j} \\gamma_i \\odot \\gamma_j\\right] \\\\\n&= \\mathbb{E}\\left[\\sum_i \\gamma_i \\odot \\gamma_i\\right]\n\\end{aligned}')
('3.2.7.2', '\\mathbb{E}[\\gamma_i \\odot \\gamma_j] = \\mathbb{E}[\\gamma_i] \\odot \\mathbb{E}[\\gamma_j] = {\\mathbf{0}}')
('3.2.7.2', '\\gamma_i')
('3.2.7.2', '\\gamma_j')
('3.2.7.2', 'i \\neq j')
('3.2.7.2', '\\begin{aligned}\n\\frac{1}{S} \\operatorname{\\bf diag}(\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, \\cdot))\n\\approx\n\\left(\\nabla \\frac{1}{S} \\sum_{j=1}^S L({\\bm w}; {\\bm x}, {\\bm y}_{i_j})\\right)\n\\odot\n\\left(\\nabla \\frac{1}{S} \\sum_{j=1}^S L({\\bm w}; {\\bm x}, {\\bm y}_{i_j})\\right),\n\\end{aligned}')
('3.2.7.2', 'p_{\\bm \\theta}')
('3.2.7.2', '{\\bm y}')
('3.2.7.2', '{\\bm x}')
('3.2.8', '\\ell \\circ f')
('3.2.8', '\\ell')
('3.3.0', 'A_1')
('3.3.0', 'A_2')
('3.3.0', '\\mathbb{P}(A_1 \\cap A_2) = \\mathbb{P}(A_2 | A_1) \\mathbb{P}(A_1).')
('3.3.0', 'S_1')
('3.3.0', 'S_2')
('3.3.0', 'A_1 \\coloneqq \\{S_1 = {\\bm s}_1\\}')
('3.3.0', 'A_2 \\coloneqq \\{S_2 = {\\bm s}_2\\}')
('3.3.0', '\\mathbb{P}(S_1= {\\bm s}_1, S_2= {\\bm s}_2) = \\mathbb{P}(S_2={\\bm s}_2 | S_1={\\bm s}_1) \\mathbb{P}(S_1={\\bm s}_1).')
('3.3.0', 'K')
('3.3.0', '\\mathbb{P}\\left(A_1 \\cap \\ldots \\cap A_K\\right) \n= \\mathbb{P}\\left(A_K \\mid A_1 \\cap \\ldots \\cap A_{K-1}\\right)\n\\mathbb{P}\\left(A_1 \\cap \\ldots \\cap A_{K-1}\\right).')
('3.3.0', '\\mathbb{P}\\left(A_1 \\cap \\ldots \\cap A_{K-1}\\right)\n=\n\\mathbb{P}\\left(A_{K-1} \\mid A_1 \\cap \\ldots \\cap A_{K-2}\\right) \n\\mathbb{P}\\left(A_1 \\cap \\ldots \\cap A_{K-2}\\right).')
('3.3.0', '\\begin{aligned}\n\\mathbb{P}\\left(A_1 \\cap \\ldots \\cap A_K\\right) \n&= \\prod_{j=1}^K \\mathbb P(A_j \\mid A_1 \\cap \\dots \\cap A_{j-1})\\\\\n&= \\prod_{j=1}^K \\mathbb  P\\left(A_j \\,\\Bigg|\\, \\bigcap_{i=1}^{j-1} A_i\\right).\n\\end{aligned}')
('3.3.0', 'K')
('3.3.0', 'S_j')
('3.3.0', 'A_j \\coloneqq \\{S_j = {\\bm s}_j \\}')
('3.3.0', '\\mathbb{P}\\left(S_1 = {\\bm s}_1, \\ldots,S_K = {\\bm s}_K\\right) \n= \\prod_{j=1}^K \\mathbb P(S_j = {\\bm s}_j \\mid S_1 = {\\bm s}_1, \\dots, S_{j-1}={\\bm s}_{j-1}).')
('3.3.0', 'S_1,\\dots,S_K')
('3.3.1', 'A')
('3.3.1', 'B')
('3.3.1', '\\mathbb{P}(A|B) = \\mathbb{P}(A).')
('3.3.1', 'S_1')
('3.3.1', 'S_2')
('3.3.1', '\\mathbb{P}(S_2={\\bm s}_2|S_1={\\bm s}_1) = \\mathbb{P}(S_2={\\bm s}_2).')
('3.3.1', 'K')
('3.3.1', 'S_1, \\dots, S_K')
('3.3.1', '\\mathcal{C}')
('3.3.1', '\\begin{aligned}\n    S_\\mathcal{C}&\\coloneqq (S_i \\colon i \\in \\mathcal{C}) \\\\\n    {\\bm s}_\\mathcal{C}&\\coloneqq ({\\bm s}_i \\colon i \\in \\mathcal{C}).\n\\end{aligned}')
('3.3.1', 'S_j')
('3.3.1', 'S_\\mathcal{D}')
('3.3.1', 'S_\\mathcal{C}')
('3.3.1', '\\mathcal{C}\\cap \\mathcal{D}= \\emptyset')
('3.3.1', '{\\bm s}_j, {\\bm s}_{\\mathcal{C}}, {\\bm s}_{\\mathcal{D}}')
('3.3.1', '\\mathbb{P}(S_j = {\\bm s}_j \\mid S_\\mathcal{C}= {\\bm s}_\\mathcal{C}, S_\\mathcal{D}= {\\bm s}_\\mathcal{D}) \n= \\mathbb{P}(S_j = {\\bm s}_j \\mid S_\\mathcal{C}= {\\bm s}_\\mathcal{C}).')
('3.3.2.0', 'K')
('3.3.2.0', '{\\bm s}\\coloneqq ({\\bm s}_1, \\dots, {\\bm s}_K)')
('3.3.2.0', '{\\bm s}')
('3.3.2.0', '\\mathcal{S}\\coloneqq \\mathcal{S}_1 \\times \\dots \\times \\mathcal{S}_K')
('3.3.2.0', '\\mathcal{S}_k')
('3.3.2.0', '\\mathcal{S}_k \\coloneqq \\{{\\bm v}_1, \\dots, {\\bm v}_{M_k}\\}')
('3.3.2.0', '\\mathcal{S}_k')
('3.3.2.0', '\\{1,\\dots,M_k\\}')
('3.3.2.0', '\\begin{aligned}\n\\mathbb{P}(S = {\\bm s}) \n&= \\mathbb{P}(S_1={\\bm s}_1,\\dots,S_K={\\bm s}_K) \\\\\n&= p({\\bm s}) \\\\\n&= p({\\bm s}_1,\\dots,{\\bm s}_K),\n\\end{aligned}')
('3.3.2.0', 'p')
('3.3.2.0', '\\sum_{{\\bm s}\\in \\mathcal{S}} p({\\bm s})\n= \\sum_{{\\bm s}_1,\\dots,{\\bm s}_K \\in \\mathcal{S}} p({\\bm s}_1,\\dots,{\\bm s}_K)\n= 1.')
('3.3.2.0', '(S_1,\\dots,S_K)')
('3.3.2.1', '{\\bm s}=\n({\\bm s}_1,\\dots,{\\bm s}_K)')
('3.3.2.1', '\\mathbb{P}(S_1 = {\\bm s}_1, \\dots, S_k = {\\bm s}_k)\n=\np({\\bm s}_1, \\dots, {\\bm s}_k).')
('3.3.2.1', '\\log \\mathbb{P}(S_1 = {\\bm s}_1, \\dots, S_k = {\\bm s}_k)\n=\n\\log p({\\bm s}_1, \\dots, {\\bm s}_k).')
('3.3.2.2', '\\mathop{\\mathrm{arg\\,max}}_{{\\bm s}_1 \\in \\mathcal{S}_1, \\dots, {\\bm s}_K \\in \\mathcal{S}_K}\np({\\bm s}_1,\\dots,{\\bm s}_K).')
('3.3.2.3', 'S_k={\\bm s}_k')
('3.3.2.3', '\\begin{aligned}\n\\mathcal{C}_k({\\bm s}_k)\n\\coloneqq \n\\underbrace{\\mathcal{S}_1 \\times \\dots \\times \\mathcal{S}_{k-1}}_{\\mathcal{A}_{k-1}}\n\\times \\{{\\bm s}_k\\} \\times \n\\underbrace{\\mathcal{S}_{k+1} \\times \\dots \\times \\mathcal{S}_K}_{\\mathcal{B}_{k+1}}.\n\\label{gm:eq:marginal_set_ck}\n\\end{aligned}')
('3.3.2.3', 'S_k')
('3.3.2.3', 'S_k={\\bm s}_k')
('3.3.2.3', '\\begin{aligned}\n\\mathbb{P}(S_k = {\\bm s}_k) \n&= \\sum_{{\\bm s}_1,\\dots,{\\bm s}_K \\in \\mathcal{C}_k({\\bm s}_k)} p({\\bm s}_1,\\dots,{\\bm s}_K) \\\\\n&= \n\\sum_{{\\bm s}_1,\\dots,{\\bm s}_{k-1} \\in \\mathcal{A}_{k-1}} \n\\sum_{{\\bm s}_{k+1},\\dots,{\\bm s}_K \\in \\mathcal{B}_{k+1}} \np({\\bm s}_1,\\dots,{\\bm s}_K)\n\\end{aligned}')
('3.3.2.3', '\\begin{aligned}\n\\mathcal{C}_{k,l}({\\bm s}_k,{\\bm s}_l)\n\\coloneqq \n\\mathcal{S}_1 \\times \\dots \\times \\{{\\bm s}_k\\} \\times \\dots \\times \\{{\\bm s}_l\\} \\times \\dots\n\\times \\mathcal{S}_K,\n\\end{aligned}')
('3.3.2.3', '\\begin{aligned}\n\\mathbb{P}(S_k = {\\bm s}_k, S_l={\\bm s}_l) \n= \\sum_{{\\bm s}_1,\\dots,{\\bm s}_K \\in \\mathcal{C}_{k,l}({\\bm s}_k,{\\bm s}_l)} p({\\bm s}_1,\\dots,{\\bm s}_K).\n\\end{aligned}')
('3.3.2.3', '\\mathbb{P}(S_{k-1} = {\\bm s}_{k-1}, S_k={\\bm s}_k)')
('3.3.2.4', '\\phi(S)')
('3.3.2.4', 'p')
('3.3.2.4', '\\begin{aligned}\n{\\bm \\mu}\\coloneqq \\mathbb{E}_{S \\sim p}[\\phi(S)] \n= \\sum_{{\\bm s}\\in \\mathcal{S}} p({\\bm s}) \\phi({\\bm s}) \\in \\mathcal{M}\n\\end{aligned}')
('3.3.2.4', 'p_{\\bm \\theta}')
('3.3.2.4', '\\begin{aligned}\n\\mu({\\bm \\theta}) \\coloneqq \\mathbb{E}_{S \\sim p_{\\bm \\theta}}[\\phi(S)] \n= \\sum_{{\\bm s}\\in \\mathcal{S}} p_{\\bm \\theta}({\\bm s}) \\phi({\\bm s}) \\in \\mathcal{M}.\n\\end{aligned}')
('3.3.2.4', '\\phi')
('3.3.2.4', '\\begin{aligned}\n\\phi({\\bm s}) \\coloneqq (\\phi_\\mathcal{C}({\\bm s}_\\mathcal{C}))_{\\mathcal{C}\\in C},\n\\end{aligned}')
('3.3.2.4', '\\mathcal{C}\\subseteq [K]')
('3.3.2.4', '\\phi({\\bm s})')
('3.3.2.4', '{\\bm s}')
('3.3.2.4', '{\\bm \\mu}_\\mathcal{C}\n\\coloneqq \\mathbb{E}_S[\\phi_\\mathcal{C}(S_\\mathcal{C})]\n= \\sum_{{\\bm s}\\in \\mathcal{S}} p({\\bm s}) \\phi_\\mathcal{C}({\\bm s}_\\mathcal{C}).')
('3.3.2.4.0', '{\\bm \\mu}')
('3.3.2.4.0', '\\phi(\\mathcal{S}) \\coloneqq \\{\\phi({\\bm s}) \\colon {\\bm s}\\in \\mathcal{S}\\}')
('3.3.2.4.0', '\\mathcal{M}\\coloneqq \\mathop{\\mathrm{conv}}(\\phi(\\mathcal{S}))\n\\coloneqq \n\\left\\{ \\sum_{{\\bm s}\\in \\mathcal{S}} p({\\bm s}) \\phi({\\bm s}) \\colon p \\in \\mathcal{P}(\\mathcal{S}) \\right\\},')
('3.3.2.4.0', '\\mathcal{P}(\\mathcal{S})')
('3.3.2.4.0', '\\mathcal{S}')
('3.3.2.4.0', '\\mathcal{M}')
('3.3.2.4.0', '\\phi({\\bm s})')
('3.3.2.4.0', '{\\bm s}\\in \\mathcal{S}')
('3.3.2.4.0', '\\mathcal{M}')
('3.3.2.4.0', '{\\bm s}\\in \\mathcal{S}')
('3.3.2.4.1', '\\mathcal{S}_k = \\{{\\bm v}_1,\\dots,{\\bm v}_M\\}')
('3.3.2.4.1', '\\phi({\\bm s})')
('3.3.2.4.1', '\\mathcal{M}')
('3.3.2.4.1', '{\\bm \\mu}\\in \\mathcal{M}')
('3.3.2.4.1', '_{k,i}\n= [\\phi_k({\\bm s}_k)]_{i}\n= \\mathbb{I}({\\bm s}_k = {\\bm v}_i) \\label{gm:eq:unary_encoding}')
('3.3.2.4.1', '\\mathbb{I}(p) \\coloneqq 1')
('3.3.2.4.1', 'p')
('3.3.2.4.1', '0')
('3.3.2.4.1', 'S_k={\\bm v}_i')
('3.3.2.4.1', '\\begin{aligned}\n_{k,i} \n&= \\mathbb{E}_S[\\phi(S)_{k,i}] \\\\\n&= \\mathbb{E}_{S_k}[\\phi_k(S_k)_i] \\\\\n&= \\mathbb{E}_{S_k}[\\mathbb{I}(S_k={\\bm v}_i)] \\\\\n&= \\sum_{{\\bm s}_k \\in \\mathcal{S}_k} \\mathbb{P}(S_k={\\bm s}_k)\\mathbb{I}({\\bm s}_k={\\bm v}_i) \\\\\n&= \\mathbb{P}(S_k = {\\bm v}_i).\n\\end{aligned}')
('3.3.2.4.1', '_{k,l,i,j}\n= [\\phi_{k,l}({\\bm s}_k, {\\bm s}_l)]_{i,j}\n= \\mathbb{I}({\\bm s}_k = {\\bm v}_i, {\\bm s}_l={\\bm v}_j) \\label{gm:eq:pairwise_encoding}.')
('3.3.2.4.1', 'S_k={\\bm v}_i')
('3.3.2.4.1', 'S_l={\\bm v}_j')
('3.3.2.4.1', '\\begin{aligned}\n_{k,l,i,j} \n&= \\mathbb{E}_S[\\phi(S)_{k,l,i,j}] \\\\\n&= \\mathbb{E}_{S_k,S_l}[\\phi_{k,l}(S_k,S_l)_{i,j}] \\\\\n&= \\mathbb{E}_{S_k,S_l}[\\mathbb{I}(S_k={\\bm v}_i,S_l={\\bm v}_j)] \\\\\n&= \\sum_{{\\bm s}_k \\in \\mathcal{S}_k} \\sum_{{\\bm s}_l \\in \\mathcal{S}_l} \\mathbb{P}(S_k={\\bm s}_k,S_l={\\bm s}_l)\n\\mathbb{I}({\\bm s}_k={\\bm v}_i,{\\bm s}_l={\\bm v}_j) \\\\\n&= \\mathbb{P}(S_k={\\bm v}_i, S_l = {\\bm v}_j).\n\\end{aligned}')
('3.3.2.5', 'O(\\prod_{k=1}^K |\\mathcal{S}_k|)')
('3.3.2.5', '|\\mathcal{S}_k| = M ~\\forall k \\in [K]')
('3.3.2.5', 'O(M^K)')
('3.3.3.0', 'S_1,\\dots,S_K')
('3.3.3.0', 'S_k \\in \\mathcal{S}_k')
('3.3.3.0', 'S_{k-1} \\in \\mathcal{S}_{k-1}')
('3.3.3.0', '\\begin{aligned}\n\\mathbb{P}(S_k={\\bm s}_k \\mid S_{k-1}={\\bm s}_{k-1}, \\dots, S_1={\\bm s}_1)\n&= \\mathbb{P}(S_k={\\bm s}_k \\mid S_{k-1}={\\bm s}_{k-1}) \\\\\n&\\coloneqq p_k({\\bm s}_k \\mid {\\bm s}_{k-1}),\n\\end{aligned}')
('3.3.3.0', 'f_k')
('3.3.3.0', '{\\bm s}_{k-1}')
('3.3.3.0', '{\\bm s}_k')
('3.3.3.0', 'p_k')
('3.3.3.0', 'S_k')
('3.3.3.0', 'S_{k-1}')
('3.3.3.0', '\\begin{aligned}\n    S_0 &\\coloneqq {\\bm s}_0 \\\\\n    S_1 &\\sim p_1(\\cdot \\mid S_0) \\\\\n    S_2 &\\sim p_2(\\cdot \\mid S_1) \\\\\n                 &\\vdots \\\\\n    S_K &\\sim p_K(\\cdot \\mid S_{K-1}).\n\\end{aligned}')
('3.3.3.0', 'S_k \\mid S_{k-1} \\sim p_k(\\cdot \\mid S_{k-1})')
('3.3.3.0', 'S_0')
('3.3.3.0', 'S_0')
('3.3.3.0', 'S_1')
('3.3.3.0', 'S_0')
('3.3.3.0', '\\mathbb{P}(S_0 = {\\bm s}_0) = p_0({\\bm s}_0) \\coloneqq 1')
('3.3.3.0', '\\mathcal{S}_0 \\coloneqq \\{{\\bm s}_0\\}')
('3.3.3.0', 'S_1')
('3.3.3.0', '\\mathbb{P}(S_1 = {\\bm s}_1) \n\\coloneqq \\mathbb{P}(S_0 = {\\bm s}_0) \\mathbb{P}(S_1 = {\\bm s}_1 | S_0 = {\\bm s}_0)\n= \\mathbb{P}(S_1 = {\\bm s}_1 | S_0 = {\\bm s}_0).')
('3.3.3.0', '\\begin{aligned}\n\\mathbb{P}(S_1={\\bm s}_1,\\dots,S_K={\\bm s}_K)\n&= p({\\bm s}_1,\\dots,{\\bm s}_K) \\\\\n&= \\prod_{k=1}^K \\mathbb{P}(S_k = {\\bm s}_k \\mid S_{k-1} = {\\bm s}_{k-1}) \\\\\n&= \\prod_{k=1}^K p_k({\\bm s}_k \\mid {\\bm s}_{k-1}),\n\\end{aligned}')
('3.3.3.0', '{\\bm s}_0')
('3.3.3.0', 'p_0({\\bm s}_0) = 1')
('3.3.3.0', '\\mathcal{S}_k = \\{1,2,3\\}')
('3.3.3.0', '\\{1, \\dots, K\\}')
('3.3.3.0', '{\\bm x}\\in \\mathcal{X}')
('3.3.3.0', 'K')
('3.3.3.0', 'S_k')
('3.3.3.0', '\\mathcal{S}_k = \\{1, \\dots, M\\}')
('3.3.3.0', 'S_k \\sim \\mathrm{Categorical}({\\bm \\pi}_{k-1,k,S_{k-1}})')
('3.3.3.0', '\\begin{aligned}\n{\\bm \\pi}_{k-1,k,i} &\\coloneqq \\mathrm{softargmax}({\\bm \\theta}_{k-1,k,i}) \n\\in \\triangle^M \\\\\n               &= (\\pi_{k-1,k,i,j})_{j=1}^M \\\\\n{\\bm \\theta}_{k-1,k,i} &\\coloneqq (\\theta_{k-1,k,i,j})_{j=1}^M \\in \\mathbb{R}^M \\\\\n\\theta_{k-1,k,i,j} &\\coloneqq f_{k-1,k}({\\bm x}, i, j, {\\bm w}_k) \\in \\mathbb{R}.\n\\end{aligned}')
('3.3.3.0', "\\begin{aligned}\n\\mathbb{P}(S_k = j \\mid S_{k-1} = i) \n&= p_k(j \\mid i) \\\\\n&= \\pi_{k-1,k,i,j} \\\\\n&= \\left[\\mathrm{softargmax}({\\bm \\theta}_{k-1,k,i})\\right]_j \\\\\n&= \\frac{\\exp(\\theta_{k-1,k,i,j})}{\\sum_{j'} \\exp(\\theta_{k-1,k,i,j'})}\n\\end{aligned}")
('3.3.3.0', "\\begin{aligned}\n\\log \\mathbb{P}(S_k = j \\mid S_{k-1} = i) \n&= \\log p_k(j \\mid i) \\\\\n&= \\theta_{k-1,k,i,j} - \\mathrm{logsumexp}({\\bm \\theta}_{k-1,k,i}) \\\\\n&= \\theta_{k-1,k,i,j} - \\log \\sum_{j'} \\exp(\\theta_{k-1,k,i,j'}).\n\\end{aligned}")
('3.3.3.0', 'k-1')
('3.3.3.0', 'k')
('3.3.3.0', '\\theta_{k-1,k,i,j}')
('3.3.3.0', '\\theta_{k,i,j}')
('3.3.3.1', 'S_k')
('3.3.3.1', 'S_{k-1}')
('3.3.3.1', 'k')
('3.3.3.1', 'p_1 = \\dots = p_K = p.')
('3.3.3.1', 'S_k \\in \\mathcal{S}')
('3.3.3.1', '\\mathcal{S}= \\{{\\bm v}_1,\\dots,{\\bm v}_M\\}')
('3.3.3.1', '\\mathbb{P}(S_k={\\bm v}_j \\mid S_{k-1} = {\\bm v}_i) = p({\\bm v}_j|{\\bm v}_i) = \\pi_{i,j},')
('3.3.3.1', '\\pi_{i,j} \\in [0,1]')
('3.3.3.1', '{\\bm v}_i')
('3.3.3.1', '{\\bm v}_j')
('3.3.3.1', '\\mathcal{S}= \\{{\\bm v}_1,\\dots,{\\bm v}_M\\}')
('3.3.3.1', '\\{1,\\dots,M\\}')
('3.3.3.1', '\\mathbb{P}(S_k=j \\mid S_{k-1} = i) = p(j|i) = \\pi_{i,j}.')
('3.3.3.2', 'n^{\\text{th}}')
('3.3.3.2', 'n')
('3.3.3.2', '\\begin{aligned}\n&\\mathbb{P}(S_k={\\bm s}_k \\mid S_{k-1}={\\bm s}_{k-1}, \\dots, S_1={\\bm s}_1) \\\\\n= &\\mathbb{P}(S_k={\\bm s}_k \\mid S_{k-1}={\\bm s}_{k-1}, \\dots, S_{k-n}={\\bm s}_{k-n}) \\\\\n= &p_k({\\bm s}_k|{\\bm s}_{k-1},\\dots,{\\bm s}_{k-n}).\n\\end{aligned}')
('3.3.3.2', 'n')
('3.3.4.0', '\\mathcal{G}= (\\mathcal{V}, \\mathcal{E})')
('3.3.4.0', '\\mathcal{V}= \\{1, \\dots, K\\}')
('3.3.4.0', '\\mathcal{E}')
('3.3.4.0', '\\{i_1, \\dots, i_{n_k}\\} = {\\operatorname{pa}}(k) \\subseteq \\mathcal{V}')
('3.3.4.0', 'n_k \\coloneqq\n|{\\operatorname{pa}}(k)|')
('3.3.4.0', 'S_{i_1},\\dots,S_{i_{n_k}}')
('3.3.4.0', 'S_k')
('3.3.4.0', 'S_0')
('3.3.4.0', 'f_1,\\dots,f_K')
('3.3.4.0', 'p_k')
('3.3.4.0', 'S_k')
('3.3.4.0', 'S_{{\\operatorname{pa}}(k)}')
('3.3.4.0', '\\begin{aligned}\n    S_0 &\\coloneqq {\\bm s}_0 \\\\\n    S_1 &\\sim p_1(\\cdot \\mid S_0) \\\\\n    S_2 &\\sim p_2(\\cdot \\mid S_{{\\operatorname{pa}}(2)}) \\\\\n        &\\vdots \\\\\n    S_K &\\sim p_K(\\cdot \\mid S_{{\\operatorname{pa}}(K)}).\n\\end{aligned}')
('3.3.4.0', 'S_0,S_1,\\dots, S_K')
('3.3.4.0', '\\begin{aligned}\n\\mathbb{P}(S = {\\bm s})\n&\\coloneqq \\mathbb{P}(S_1={\\bm s}_1, \\dots, S_K={\\bm s}_K) \\\\\n&= \\prod_{k=1}^K \\mathbb{P}(S_k = s_k| S_{{\\operatorname{pa}}(k)} = {\\bm s}_{{\\operatorname{pa}}(k)}) \\\\\n&\\coloneqq \\prod_{k=1}^K p_k(s_k|{\\bm s}_{{\\operatorname{pa}}(k)})\n\\end{aligned}')
('3.3.4.1', 'p_k')
('3.3.4.1', 'k')
('3.3.4.1', 'p_k')
('3.3.4.1', 'p_k')
('3.3.4.1', 'f_k')
('3.3.4.2', 'p_k')
('3.3.4.2', 'S = (S_1, \\dots, S_K)')
('3.3.4.2', 'k= 1, \\dots, K')
('3.3.4.2', 'k')
('3.3.4.2', 's_k \\sim p_k(\\cdot|{\\bm s}_{{\\operatorname{pa}}(k)})')
('3.3.4.2', '{\\bm s}_{{\\operatorname{pa}}(k)}')
('3.3.5.0', '\\mathbb{P}(S={\\bm s}) \n= p({\\bm s})\n\\coloneqq \\frac{1}{Z} \\prod_{\\mathcal{C}\\in C} \\psi_\\mathcal{C}({\\bm s}_\\mathcal{C}),')
('3.3.5.0', 'C')
('3.3.5.0', '\\mathcal{G}')
('3.3.5.0', '\\mathcal{V}')
('3.3.5.0', 'Z')
('3.3.5.0', 'Z \\coloneqq \\sum_{{\\bm s}\\in \\mathcal{S}} \\prod_{\\mathcal{C}\\in C} \\psi_\\mathcal{C}({\\bm s}_\\mathcal{C}),')
('3.3.5.0', '\\psi_\\mathcal{C}\\colon \\mathcal{S}_\\mathcal{C}\\to \\mathbb{R}_+')
('3.3.5.0', '\\mathcal{S}_\\mathcal{C}\\coloneqq (\\mathcal{S}_j)_{j \\in \\mathcal{C}}')
('3.3.5.0', 'S = (S_1, \\dots, S_K)')
('3.3.5.0', '{\\bm s}= ({\\bm s}_1, \\dots, {\\bm s}_K)')
('3.3.5.0', '\\mathbb{P}(S={\\bm s}) = \\prod_{k=1}^K p_k({\\bm s}_k \\mid {\\bm s}_{k-1}).')
('3.3.5.0', 'Z=1')
('3.3.5.0', 'C \\coloneqq \\{\\{0,1\\}, \\{1,2\\}, \\dots, \\{K-1,K\\}\\}')
('3.3.5.0', '\\psi_{\\{k-1,k\\}}({\\bm s}_{k-1},{\\bm s}_k) \\coloneqq p_k({\\bm s}_k|{\\bm s}_{k-1}).')
('3.3.5.1', '\\psi_\\mathcal{C}({\\bm s}_\\mathcal{C}; {\\bm \\theta}_\\mathcal{C})\n\\coloneqq\n\\exp(\\langle {\\bm \\theta}_\\mathcal{C}, \\phi_\\mathcal{C}({\\bm s}_\\mathcal{C}) \\rangle)')
('3.3.5.1', '\\phi_\\mathcal{C}\\colon \\mathcal{S}_\\mathcal{C}\\to \\Theta_\\mathcal{C}')
('3.3.5.1', '{\\bm \\theta}_\\mathcal{C}\\in \\Theta_\\mathcal{C}')
('3.3.5.1', '\\begin{aligned}\np_{\\bm \\theta}({\\bm s}) \n&\\coloneqq \\frac{1}{Z({\\bm \\theta})} \\prod_{\\mathcal{C}\\in C} \\psi_\\mathcal{C}({\\bm s}_\\mathcal{C}; {\\bm \\theta}_\\mathcal{C}) \\\\\n&= \\frac{1}{Z({\\bm \\theta})} \\prod_{\\mathcal{C}\\in C} \\exp(\\langle {\\bm \\theta}_\\mathcal{C}, \\phi_\\mathcal{C}({\\bm s}_\\mathcal{C})\n\\rangle) \\\\\n&= \\frac{1}{Z({\\bm \\theta})} \\exp\\left(\\sum_{\\mathcal{C}\\in C} \\langle {\\bm \\theta}_\\mathcal{C},\n    \\phi_\\mathcal{C}({\\bm s}_\\mathcal{C})\n    \\rangle\\right) \\\\\n&= \\frac{1}{Z({\\bm \\theta})} \\exp\\left(\\langle {\\bm \\theta}, \\phi({\\bm s}) \\rangle\\right) \\\\\n&= \\exp\\left(\\langle {\\bm \\theta}, \\phi({\\bm s}) \\rangle - A({\\bm \\theta})\\right)\n\\end{aligned}')
('3.3.5.1', '\\begin{aligned}\n    \\phi({\\bm s}) &\\coloneqq (\\phi_\\mathcal{C}({\\bm s}_\\mathcal{C}))_{\\mathcal{C}\\in C} \\\\\n    {\\bm \\theta}&\\coloneqq ({\\bm \\theta}_\\mathcal{C})_{\\mathcal{C}\\in C} \\\\\n    Z({\\bm \\theta}) &\\coloneqq \n    \\sum_{{\\bm s}\\in \\mathcal{S}} \\prod_{\\mathcal{C}\\in C} \\psi_\\mathcal{C}({\\bm s}_\\mathcal{C}; {\\bm \\theta}_\\mathcal{C}) \\\\\n               &= \\sum_{{\\bm s}\\in \\mathcal{S}}\n               \\exp\\left(\\langle {\\bm \\theta}, \\phi({\\bm s}) \\rangle\\right) \\\\\nA({\\bm \\theta}) &\\coloneqq \\log Z({\\bm \\theta})\n\\end{aligned}')
('3.3.5.1', '{\\bm \\theta}')
('3.3.5.1', '\\phi')
('3.3.5.1', 'A({\\bm \\theta})')
('3.3.5.1', 'Y = (Y_1, \\dots, Y_M) \\in \\{0,1\\}^M')
('3.3.5.1', 'Y_i \\in \\{0,1\\}')
('3.3.5.1', '\\mathcal{G}= (\\mathcal{V}, \\mathcal{E})')
('3.3.5.1', '\\mathcal{V}= [M]')
('3.3.5.1', '\\mathcal{E}\\subseteq V^2')
('3.3.5.1', '(i,j) \\in \\mathcal{E}')
('3.3.5.1', 'Y_i')
('3.3.5.1', 'Y_j')
('3.3.5.1', 'Y_i')
('3.3.5.1', 'Y_i')
('3.3.5.1', 'Y_i')
('3.3.5.1', '{\\bm y}= (y_1, \\dots, y_M) \\in \\{0,1\\}^M')
('3.3.5.1', '\\begin{aligned}\n\\mathbb{P}(Y = {\\bm y}) \n&= p_{\\bm \\theta}({\\bm y}) \\\\\n&= \\exp\\left(\\sum_{i \\in \\mathcal{V}} \\theta_i y_i \n+ \\sum_{(i,j) \\in \\mathcal{E}} \\theta_{i,j} y_i y_j - A({\\bm \\theta}) \\right) \\\\\n&= \\exp\\left(\\sum_{\\mathcal{C}\\in C} \\langle {\\bm \\theta}_\\mathcal{C}, \\phi_\\mathcal{C}({\\bm y}) \\rangle - A({\\bm \\theta})\n\\right),\n\\end{aligned}')
('3.3.5.1', 'C \\coloneqq \\mathcal{V}\\cup \\mathcal{E}')
('3.3.5.1', '{\\bm \\theta}\\in \\mathbb{R}^{|\\mathcal{V}| + |\\mathcal{E}|}')
('3.3.5.1', '(\\theta_i)_{i \\in \\mathcal{V}}')
('3.3.5.1', '(\\theta_{i,j})_{(i,j) \\in \\mathcal{E}}')
('3.3.5.1', '\\theta_{i,j}')
('3.3.5.1', 'y_i y_j y_k')
('3.3.5.1', '(i,j,k) \\in \\mathcal{V}^3')
('3.3.5.2', '{\\bm y}')
('3.3.5.2', '{\\bm x}')
('3.3.5.2', '\\mathbb{P}(Y={\\bm y}\\mid X = {\\bm x}) \n= p({\\bm y}\\mid {\\bm x})\n= \\frac{1}{Z({\\bm x})} \\prod_{\\mathcal{C}\\in C} \\psi_\\mathcal{C}({\\bm y}_\\mathcal{C}, {\\bm x}).')
('3.3.5.2', '\\Psi_\\mathcal{C}')
('3.3.5.2', '{\\bm x}')
('3.3.5.2', '{\\bm x}')
('3.3.5.3', 'Z')
('3.3.6', 'p({\\bm s}_1,\\dots,{\\bm s}_K) = \\frac{1}{Z} \\prod_{k=1}^K \\psi_k({\\bm s}_{k-1},{\\bm s}_k),')
('3.3.6', 'Z \\coloneqq \\sum_{{\\bm s}\\in \\mathcal{S}} \\prod_{k=1}^K \\psi_k({\\bm s}_{k-1},{\\bm s}_{k-1})')
('3.3.6', '\\psi_k')
('3.3.6', '\\psi_{k-1,k}')
('3.3.6', 'k-1')
('3.3.6', 'k')
('3.3.6', '\\psi_k({\\bm s}_{k-1},{\\bm s}_k) \\coloneqq p_k({\\bm s}_k \\mid {\\bm s}_{k-1}),')
('3.3.6', 'Z=1')
('3.3.6.0', 'Z = \\sum_{{\\bm s}_1 \\in \\mathcal{S}_1} \\psi_1({\\bm s}_0, {\\bm s}_1) \\sum_{{\\bm s}_2 \\in \\mathcal{S}_2}\n\\psi_2({\\bm s}_1, {\\bm s}_2) \\dots \\sum_{{\\bm s}_K \\in \\mathcal{S}_K} \\psi_K({\\bm s}_{K-1}, {\\bm s}_K).')
('3.3.6.0', '\\mathcal{A}_{k-1}')
('3.3.6.0', '\\mathcal{B}_{k+1}')
('3.3.6.0', 'k')
('3.3.6.0', '\\begin{aligned}\n\\alpha_k({\\bm s}_k)\n&\\coloneqq \\sum_{{\\bm s}_1,\\dots,{\\bm s}_{k-1} \\in \\mathcal{A}_{k-1}} \n\\prod_{j=1}^k \\psi_j({\\bm s}_{j-1}, {\\bm s}_j) \\\\\n&= \\sum_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \\psi_k({\\bm s}_{k-1}, {\\bm s}_k)\n\\dots\n\\sum_{{\\bm s}_1 \\in \\mathcal{S}_1} \\psi_2({\\bm s}_1,{\\bm s}_2) \\psi_1({\\bm s}_0,{\\bm s}_1) \\\\\n\\beta_k({\\bm s}_k) \n&\\coloneqq \\sum_{{\\bm s}_{k+1},\\dots,{\\bm s}_K \\in \\mathcal{B}_{k+1}} \n\\prod_{j=k+1}^K \\psi_j({\\bm s}_{j-1}, {\\bm s}_j) \\\\\n&=\n\\sum_{{\\bm s}_{k+1} \\in \\mathcal{S}_{k+1}} \\psi_{k+1}({\\bm s}_k,{\\bm s}_{k+1})\n\\dots\n\\sum_{{\\bm s}_K \\in \\mathcal{S}_K} \\psi_K({\\bm s}_{K-1},{\\bm s}_K).\n\\end{aligned}')
('3.3.6.0', '\\begin{aligned}\n\\alpha_k({\\bm s}_k) &= \n\\sum_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \n\\psi_k({\\bm s}_{k-1},{\\bm s}_k) \\alpha_{k-1}({\\bm s}_{k-1}) \\\\\n\\beta_k({\\bm s}_k) &= \n\\sum_{{\\bm s}_{k+1} \\in \\mathcal{S}_{k+1}} \\psi_{k+1}({\\bm s}_k,{\\bm s}_{k+1}) \\beta_{k+1}({\\bm s}_{k+1})\n\\end{aligned}')
('3.3.6.0', '\\begin{aligned}\n    \\alpha_1({\\bm s}_1) &\\coloneqq \\psi_1({\\bm s}_0, {\\bm s}_1) \\quad \\forall {\\bm s}_1 \\in \\mathcal{S}_1 \\\\\n    \\beta_K({\\bm s}_K) &\\coloneqq 1 \\quad \\forall {\\bm s}_K \\in \\mathcal{S}_K.\n\\end{aligned}')
('3.3.6.0', '\\begin{aligned}\nZ \n= \\sum_{{\\bm s}_K \\in \\mathcal{S}_K} \\alpha_K({\\bm s}_K) \\beta_K({\\bm s}_K)\n= \\sum_{{\\bm s}_1 \\in \\mathcal{S}_1} \\alpha_1({\\bm s}_1) \\beta_1({\\bm s}_1)\n\\end{aligned}')
('3.3.6.0', '\\begin{aligned}\n\\mathbb{P}(S_k = {\\bm s}_k) \n&= \\frac{1}{Z} \\alpha_k({\\bm s}_k) \\beta_k({\\bm s}_k)\\\\\n\\mathbb{P}(S_{k-1}={\\bm s}_{k-1}, S_k={\\bm s}_k) &= \n\\frac{1}{Z}\n\\alpha_{k-1}({\\bm s}_{k-1})\n\\psi_k({\\bm s}_{k-1}, {\\bm s}_k) \n\\beta_k({\\bm s}_k).\n\\end{aligned}')
('3.3.6.0', '\\begin{aligned}\n\\mathbb{P}(S_k={\\bm s}_k \\mid S_{k-1}={\\bm s}_{k-1}) \n&= \\frac{\\mathbb{P}(S_{k-1}={\\bm s}_{k-1}, S_k={\\bm s}_k)}{\\mathbb{P}(S_{k-1}={\\bm s}_{k-1})} \\\\\n&= \\frac{\\alpha_{k-1}({\\bm s}_{k-1}) \\psi_k({\\bm s}_{k-1}, {\\bm s}_k) \\beta_k({\\bm s}_k)}{\n\\alpha_{k-1}({\\bm s}_{k-1}) \\beta_{k-1}({\\bm s}_{k-1})} \\\\\n&= \\frac{\\psi_k({\\bm s}_{k-1}, {\\bm s}_k) \\beta_k({\\bm s}_k)}{\n\\beta_{k-1}({\\bm s}_{k-1})}.\n\\end{aligned}')
('3.3.6.0', '\\begin{aligned}\n\\log \\alpha_k({\\bm s}_k) &= \n\\log \\sum_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \n\\exp(\\log \\psi_k({\\bm s}_{k-1},{\\bm s}_k) + \\log \\alpha_{k-1}({\\bm s}_{k-1})) \\\\\n\\log \\beta_k({\\bm s}_k) &= \n\\log \\sum_{{\\bm s}_{k+1} \\in \\mathcal{S}_{k+1}}\n\\exp(\\log \\psi_{k+1}({\\bm s}_k,{\\bm s}_{k+1}) + \\log \\beta_{k+1}({\\bm s}_{k+1})).\n\\end{aligned}')
('3.3.6.0', '\\psi_1, \\dots, \\psi_K')
('3.3.6.0', '{\\bm s}_0')
('3.3.6.0', '\\alpha_1({\\bm s}_1) \\coloneqq \\psi_1({\\bm s}_0, {\\bm s}_1) ~ \\forall\n    {\\bm s}_1 \\in \\mathcal{S}_1')
('3.3.6.0', '\\alpha_k({\\bm s}_k) \\coloneqq\n\\displaystyle{\\sum_{s_{k-1} \\in \\mathcal{S}_{k-1}} \\psi_k({\\bm s}_{k-1},{\\bm s}_k)\n\\alpha_{k-1}({\\bm s}_{k-1})}')
('3.3.6.0', '\\beta_{K}({\\bm s}_K) \\coloneqq 1 ~ \\forall {\\bm s}_K \\in \\mathcal{S}_K')
('3.3.6.0', '\\beta_k({\\bm s}_k) \\coloneqq \n\\displaystyle{\\sum_{s_{k+1} \\in \\mathcal{S}_{k+1}} \\psi_{k+1}({\\bm s}_k,{\\bm s}_{k+1})\n\\beta_{k+1}({\\bm s}_{k+1})}')
('3.3.6.0', 'Z \n= \\displaystyle{\\sum_{{\\bm s}_K \\in \\mathcal{S}_K} \\alpha_K({\\bm s}_K) \\beta_K({\\bm s}_K)}\n= \\displaystyle{\\sum_{{\\bm s}_K \\in \\mathcal{S}_K} \\alpha_K({\\bm s}_K)}')
('3.3.6.0', '\\forall k \\in [K]')
('3.3.6.0', '\\mathbb{P}(S_k = {\\bm s}_k) = \n    \\frac{1}{Z} \\alpha_k({\\bm s}_k) \\beta_k({\\bm s}_k)')
('3.3.6.0', '\\mathbb{P}(S_{k-1}={\\bm s}_{k-1}, S_k={\\bm s}_k) = \n\\frac{1}{Z} \\alpha_{k-1}({\\bm s}_{k-1}) \\psi_k({\\bm s}_{k-1}, {\\bm s}_k) \\beta_k({\\bm s}_k)')
('3.3.6.1', '\\begin{aligned}\n &\\max_{{\\bm s}_1 \\in \\mathcal{S}_1, \\dots, {\\bm s}_K \\in \\mathcal{S}_K}\n\\prod_{k=1}^K \\psi_k({\\bm s}_{k-1},{\\bm s}_k) \\\\\n=& \\max_{{\\bm s}_K \\in \\mathcal{S}_K} \n\\max_{{\\bm s}_{K-1} \\in \\mathcal{S}_{K-1}}\n\\psi_K({\\bm s}_{K-1},{\\bm s}_K)\n\\dots\n\\max_{{\\bm s}_1 \\in \\mathcal{S}_1} \n\\psi_2({\\bm s}_1,{\\bm s}_2)\n\\psi_1({\\bm s}_0,{\\bm s}_1).\n\\end{aligned}')
('3.3.6.1', 'k \\in [K]')
('3.3.6.1', '\\delta_k({\\bm s}_k) \\coloneqq\n\\max_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}}\n\\psi_k({\\bm s}_{k-1},{\\bm s}_k)\n\\dots\n\\max_{{\\bm s}_1 \\in \\mathcal{S}_1} \n\\psi_2({\\bm s}_1,{\\bm s}_2)\n\\psi_1({\\bm s}_0,{\\bm s}_1).')
('3.3.6.1', 'k \\in [K]')
('3.3.6.1', '\\delta_k({\\bm s}_k) = \n\\max_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \\psi_k({\\bm s}_{k-1},{\\bm s}_k) \\delta_{k-1}({\\bm s}_{k-1}),')
('3.3.6.1', '\\delta_1({\\bm s}_k) \\coloneqq \\psi({\\bm s}_0, {\\bm s}_k)')
('3.3.6.1', '\\max_{{\\bm s}_1 \\in \\mathcal{S}_1, \\dots, {\\bm s}_K \\in \\mathcal{S}_K} p({\\bm s}_1, \\dots, {\\bm s}_K)\n= \\frac{1}{Z} \\max_{{\\bm s}_K \\in \\mathcal{S}_K} \\delta_K({\\bm s}_K).')
('3.3.6.1', 'k \\in [K]')
('3.3.6.1', '\\log \\delta_k({\\bm s}_k) = \n\\max_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \n\\log \\psi_k({\\bm s}_{k-1},{\\bm s}_k) \n+ \\log \\delta_{k-1}({\\bm s}_{k-1}).')
('3.3.6.1', '{\\bm q}_k({\\bm s}_k) \\coloneqq\n\\mathop{\\mathrm{arg\\,max}}_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \\psi_k({\\bm s}_{k-1},{\\bm s}_k) \\delta_{k-1}({\\bm s}_{k-1})')
('3.3.6.1', '{\\bm s}_k^\\star')
('3.3.6.1', '{\\bm s}_{k-1}^\\star')
('3.3.6.1', '\\psi_1, \\dots, \\psi_K')
('3.3.6.1', '{\\bm s}_0')
('3.3.6.1', '\\delta_1({\\bm s}_1) \\coloneqq \\psi_1({\\bm s}_0, {\\bm s}_1) ~ \\forall {\\bm s}_1\n    \\in \\mathcal{S}_1')
('3.3.6.1', '\\delta_k({\\bm s}_k) \\coloneqq\n\\displaystyle{\\max_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \\psi_k({\\bm s}_{k-1},{\\bm s}_k)\n\\delta_{k-1}({\\bm s}_{k-1})}')
('3.3.6.1', 'q_k({\\bm s}_k) \\coloneqq\n\\displaystyle{\\mathop{\\mathrm{arg\\,max}}_{{\\bm s}_{k-1} \\in \\mathcal{S}_{k-1}} \\psi_k({\\bm s}_{k-1},{\\bm s}_k)\n\\delta_{k-1}({\\bm s}_{k-1})}')
('3.3.6.1', '\\delta^\\star \\coloneqq \\displaystyle{\\max_{{\\bm s}_K \\in \\mathcal{S}_K}\n        \\delta_K({\\bm s}_K)}')
('3.3.6.1', '{\\bm s}_K^\\star \\coloneqq \\displaystyle{\\mathop{\\mathrm{arg\\,max}}_{{\\bm s}_K \\in \\mathcal{S}_K}\n        \\delta_K({\\bm s}_K)}')
('3.3.6.1', '{\\bm s}_{k}^\\star \\coloneqq q_{k+1}({\\bm s}_{k+1}^\\star)')
('3.3.6.1', '\\displaystyle{\\max_{{\\bm s}_1 \\in \\mathcal{S}_1, \\dots, {\\bm s}_K \\in \\mathcal{S}_K} p({\\bm s}_1, \\dots, {\\bm s}_K) \\propto\n    \\delta^\\star}')
('3.3.6.1', '\\displaystyle{\\mathop{\\mathrm{arg\\,max}}_{{\\bm s}_1 \\in \\mathcal{S}_1, \\dots, {\\bm s}_K \\in \\mathcal{S}_K} p({\\bm s}_1, \\dots, {\\bm s}_K) =\n({\\bm s}_1^\\star, \\dots, {\\bm s}_K^\\star)}')
('3.3.8.0', '\\phi')
('3.3.8.0', '\\nabla A({\\bm \\theta})')
('3.3.8.0', 'A({\\bm \\theta})')
('3.3.8.0', '\\begin{aligned}\np_{\\bm \\theta}({\\bm s}) \n&= h({\\bm s}) \\exp\\left[\\langle {\\bm \\theta}, \\phi({\\bm s}) \\rangle - \nA({\\bm \\theta})\\right]\n\\end{aligned}')
('3.3.8.0', 'A({\\bm \\theta}) \n\\coloneqq\n\\log \\sum_{{\\bm s}\\in \\mathcal{S}} h({\\bm s}) \\exp\\left[\\langle {\\bm \\theta}, \\phi({\\bm s}) \\rangle\\right].')
('3.3.8.0', '\\begin{aligned}\n\\mu({\\bm \\theta}) \n\\coloneqq \\nabla A({\\bm \\theta})\n= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\\phi(Y)] \\in \\mathcal{M}.\n\\end{aligned}')
('3.3.8.0', '\\begin{aligned}\n\\mathbb{P}(S_k = {\\bm v}_i)\n&= [\\nabla A({\\bm \\theta})]_{k,i} \\\\\n\\mathbb{P}(S_k = {\\bm v}_i, S_l = {\\bm v}_j)\n&= [\\nabla A({\\bm \\theta})]_{k,l,i,j}.\n\\end{aligned}')
('3.3.8.0', 'A({\\bm \\theta})')
('3.3.8.0', 'A({\\bm \\theta})')
('3.3.8.0', '\\nabla\nA({\\bm \\theta})')
('3.3.8.0', 'A({\\bm \\theta})')
('3.3.8.0', '\\begin{aligned}\n\\mathbb{P}(S_k = {\\bm v}_i)\n&= [\\nabla A({\\bm \\theta})]_{k,i} \n= \\frac{1}{Z} \\alpha_k({\\bm v}_i) \\beta_k({\\bm v}_i) \\\\\n\\mathbb{P}(S_{k-1} = {\\bm v}_i, S_k = {\\bm v}_j)\n&= [\\nabla A({\\bm \\theta})]_{k-1,k,i,j} \n= \\frac{1}{Z} \\alpha_{k-1}({\\bm v}_i) \\psi_k({\\bm v}_i, {\\bm v}_j) \\beta_k({\\bm v}_j),\n\\end{aligned}')
('3.3.8.0', 'Z')
('3.3.8.0', '\\alpha')
('3.3.8.0', '\\beta')
('3.3.8.0', '{\\bm \\theta}')
('3.3.8.0', 'A_\\varepsilon({\\bm \\theta}) \\coloneqq \\varepsilon A({\\bm \\theta}/ \\varepsilon)')
('3.3.8.0', '\\varepsilon \\to 0')
('3.3.8.0', '{\\bm \\mu}({\\bm \\theta})')
('3.3.8.1', '\\mathbb{K}')
('3.3.8.1', '(\\oplus, \\otimes)')
('3.3.8.1', '\\otimes')
('3.3.8.1', '\\oplus')
('3.3.8.1', '\\oplus')
('3.3.8.1', '\\otimes')
('3.3.8.1', '\\oplus')
('3.3.8.1', '\\bar{0}')
('3.3.8.1', '\\bar{1}')
('3.3.8.1', '\\oplus')
('3.3.8.1', '\\otimes')
('3.3.8.1', '\\bar{0}')
('3.3.8.1', '\\bar{1}')
('3.3.8.1', '0')
('3.3.8.1', '1')
('3.3.8.1', '\\oplus')
('3.3.8.1', 'a \\oplus b = b \\oplus a')
('3.3.8.1', '\\oplus')
('3.3.8.1', 'a \\oplus (b \\oplus c) = (a \\oplus b) \\oplus c')
('3.3.8.1', '\\otimes')
('3.3.8.1', '\\oplus')
('3.3.8.1', 'a \\otimes (b \\oplus c) = (a \\otimes b) \\oplus (a \\otimes c)')
('3.3.8.1', '(\\mathbb{K}, \\oplus)')
('3.3.8.1', '(\\mathbb{K}, \\otimes)')
('3.3.8.1', '\\mathbb{R}_+')
('3.3.8.1', '(+, \\times)')
('3.3.8.1', '(0,1)')
('3.3.8.1', '\\mathbb{R}')
('3.3.8.1', '(\\max, +)')
('3.3.8.1', '(-\\infty, 0)')
('3.3.8.1', '\\mathbb{R}')
('3.3.8.1', '(\\max_\\varepsilon, +)')
('3.3.8.1', '(-\\infty, 0)')
('3.3.8.1', '\\text{max}_\\varepsilon(a,b) \n\\coloneqq \\varepsilon \\log((\\exp(a) + \\exp(b)) / \\varepsilon),')
('3.3.8.1', '\\varepsilon \\coloneqq 1')
('3.3.8.1', '\\text{max}_\\varepsilon')
('3.3.8.1', '\\text{max}_\\varepsilon')
('3.3.8.1', '-\\infty')
('3.3.8.1', '\\begin{aligned}\n\\text{max}_\\varepsilon(a_1,\n\\text{max}_\\varepsilon(a_2, a_3))\n&= \\mathrm{logsumexp}_\\varepsilon(a_1,a_2,a_3) \\\\\n&= \\varepsilon \\log \\sum_i \\exp(a_i / \\varepsilon).\n\\end{aligned}')
('3.3.8.1', '\\underset{{\\bm v}\\in \\mathcal{V}}{\\text{max}_\\varepsilon} ~ f({\\bm v})\n\\coloneqq \\varepsilon \\log \\sum_{{\\bm v}\\in \\mathcal{V}} \\exp(f({\\bm v}) / \\varepsilon) \\in \\mathbb{R}.')
('3.3.8.1', "\\underset{{\\bm v}\\in \\mathcal{V}}{\\text{argmax}_\\varepsilon} ~ f({\\bm v})\n\\coloneqq \\left(\\exp(f({\\bm v}') / \\varepsilon) / \n    \\sum_{{\\bm v}\\in \\mathcal{V}} \\exp(f({\\bm v}) / \\varepsilon) \\right)_{{\\bm v}' \\in \\mathcal{V}}\n    \\in \\mathcal{P}(\\mathcal{V}).")
('3.3.8.2', '\\mathcal{S}_0 = \\{1\\}')
('3.3.8.2', '\\mathcal{S}_k = \\{1, \\dots, M\\}')
('3.3.8.2', 'k \\in [K]')
('3.3.8.2', '\\log \\psi_k(i,j) \n= \\langle {\\bm \\theta}_k,\\phi_k(i,j) \\rangle\n= \\theta_{k,i,j}.')
('3.3.8.2', '\\begin{aligned}\na_{1,j} \n&\\coloneqq\n\\log \\alpha_1(j) = \\theta_{1,1,j} \\\\\na_{k,j}\n&\\coloneqq \\log \\alpha_k(j) \n= \\underset{i \\in [M]}{\\text{max}_\\varepsilon} ~\n\\theta_{k,i,j} + a_{k-1,i}\n\\end{aligned}')
('3.3.8.2', '\\begin{aligned}\nq_{k,j}\n\\coloneqq \\underset{i \\in [M]}{\\text{argmax}_\\varepsilon} ~\n\\theta_{k,i,j} + a_{k-1,i}.\n\\end{aligned}')
('3.3.8.2', '{\\bm \\theta}\\in \\mathbb{R}^{K \\times M \\times M}')
('3.3.8.2', '\\log Z = A = \\underset{j \\in [M]}{\\text{max}_\\varepsilon} ~ a_{K,j}.')
('3.3.8.2', 'Q \\coloneqq\n\\underset{j \\in [M]}{\\text{argmax}_\\varepsilon} ~ a_{K,j}\n\\in \\triangle^M,')
('3.3.8.2', '\\mathcal{P}([M]) = \\triangle^M')
('3.3.8.2', 'A')
('3.3.8.2', '{\\bm \\theta}_k')
('3.3.8.2', 'a_k')
('3.3.8.2', 'a_{k+1},\\dots,a_K')
('3.3.8.2', 'r_{k,i} \\coloneqq \\frac{\\partial A}{\\partial a_{k,i}},')
('3.3.8.2', 'r_{K,i}\n= \\frac{\\partial A}{\\partial a_{K,i}}\n= Q_i.')
('3.3.8.2', '\\theta_{k,i,j}')
('3.3.8.2', 'a_{k,j}')
('3.3.8.2', 'k \\in [K]')
('3.3.8.2', 'i \\in [M]')
('3.3.8.2', 'j \\in [M]')
('3.3.8.2', '\\begin{aligned}\n\\mu_{k,i,j}\n&\\coloneqq \\frac{\\partial A}{\\partial \\theta_{k,i,j}} \\\\\n&= \\frac{\\partial A}{\\partial a_{k,j}} \\cdot \\frac{\\partial a_{k,j}}{\\partial \\theta_{k,i,j}} \\\\\n&= r_{k,j} \\cdot q_{k,j,i}.\n\\end{aligned}')
('3.3.8.2', 'a_{k,i}')
('3.3.8.2', 'a_{k+1,j}')
('3.3.8.2', 'j \\in [M]')
('3.3.8.2', 'k \\in \\{1, \\dots, K-1\\}')
('3.3.8.2', 'i \\in [M]')
('3.3.8.2', '\\begin{aligned}\nr_{k,i}\n= \\frac{\\partial A}{\\partial a_{k,i}}    \n&=\n\\sum_{j \\in [M]}\n\\frac{\\partial A}{\\partial a_{k+1,j}}    \n\\frac{\\partial a_{k+1,j}}{\\partial a_{k,i}} \\\\\n&=\n\\sum_{j \\in [M]} r_{k+1,j} q_{k+1,j,i} \\\\\n&=\n\\sum_{j \\in [M]} \\mu_{k+1,i,j}.\n\\end{aligned}')
('3.3.8.2', '\\text{max}_\\varepsilon')
('3.3.8.2', '\\text{argmax}_\\varepsilon')
('3.3.8.2', 'q')
('3.3.8.2', '{\\bm q}')
('3.3.8.2', '{\\bm \\theta}\\in \\mathbb{R}^{K \\times M \\times M}')
('3.3.8.2', '\\max_\\varepsilon')
('3.3.8.2', 'a_{1,j} \\coloneqq \\theta_{1,1,j} ~ \\forall j \n    \\in [M]')
('3.3.8.2', 'a_{k,j} \\coloneqq\n        \\underset{i \\in [M]}{\\text{max}_\\varepsilon} ~ \\theta_{k,i,j} +\na_{k-1,j} \\in \\mathbb{R}')
('3.3.8.2', '{\\bm q}_{k,j} \\coloneqq\n        \\underset{i \\in [M]}{\\text{argmax}_\\varepsilon} ~\n        \\theta_{k,i,j} + a_{k-1,j} \\in \\triangle^M')
('3.3.8.2', 'A \\coloneqq \\underset{i \\in\n        [M]}{\\text{max}_\\varepsilon} ~ a_{K,i} \\in \\mathbb{R}')
('3.3.8.2', '\\bm{Q} \\coloneqq \\underset{i \\in\n        [M]}{\\text{argmax}_\\varepsilon} ~ a_{K,i} \\in \\triangle^M')
('3.3.8.2', 'r_{K,j} = Q_j')
('3.3.8.2', '\\forall j \\in [K]')
('3.3.8.2', '\\mu_{k+1,i,j} = r_{k+1,j} \\cdot q_{k+1,j,i}')
('3.3.8.2', 'r_{k,i} \\leftarrow \\mu_{k+1,i,j}')
('3.3.8.2', '\\underset{i_1,\\dots,i_K \\in [M]^K}{\\max_\\varepsilon} \n    \\theta_{1,1,i_1} + \\sum_{k=2}^K \\theta_{k,i_{k-1},i_k} = A')
('3.3.8.2', '\\nabla A({\\bm \\theta}) = \\mu')
('3.4.0', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.0', '{\\bm w}^\\star \\colon \\Lambda \\to \\mathcal{W}')
('3.4.0', '\\partial {\\bm w}^\\star({\\bm \\lambda})')
('3.4.0', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.0', '\\partial {\\bm w}^\\star({\\bm \\lambda})')
('3.4.0', '{\\bm \\lambda}\\in \\Lambda')
('3.4.0.0', '{\\bm w}^\\star({\\bm \\lambda}) = \\mathop{\\mathrm{arg\\,max}}_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda}),')
('3.4.0.0', 'f \\colon \\mathcal{W}\\times \\Lambda \\to \\mathbb{R}')
('3.4.0.0', '\\mathcal{W}')
('3.4.0.0', '\\mathop{\\mathrm{arg\\,max}}')
('3.4.0.0', '\\mathop{\\mathrm{arg\\,min}}')
('3.4.0.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.0.1', 'F \\colon \\mathcal{W}\n\\times \\Lambda \\to \\mathcal{W}')
('3.4.0.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.0.1', 'F({\\bm w}, {\\bm \\lambda}) = {\\mathbf{0}}')
('3.4.0.1', '{\\bm \\lambda}\\in \\Lambda')
('3.4.0.2', 'f, g \\colon \\mathcal{W}\\times \\Lambda \\to \\mathbb{R}')
('3.4.0.2', 'h({\\bm \\lambda})')
('3.4.0.2', '\\label{implicit:eq:bilevel}\nh({\\bm \\lambda}) \\coloneqq g({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}),\n\\quad \\text{where} \\quad\n{\\bm w}^\\star({\\bm \\lambda}) = \\mathop{\\mathrm{arg\\,max}}_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda}).')
('3.4.0.2', 'f')
('3.4.0.2', 'g')
('3.4.0.2', '{\\bm w}\\in \\mathcal{W}')
('3.4.0.2', '{\\bm \\lambda}\\in \\Lambda')
('3.4.0.2', 'h({\\bm \\lambda})')
('3.4.0.2', '{\\bm \\lambda}')
('3.4.0.2', '\\nabla h({\\bm \\lambda})')
('3.4.0.2', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.0.2', '{\\bm \\lambda}')
('3.4.0.2', '\\partial h({\\bm \\lambda}) = \n\\partial_1 g({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) \\partial {\\bm w}^\\star({\\bm \\lambda})\n+ \\partial_2 g({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}).')
('3.4.0.2', '\\partial h({\\bm \\lambda})^\\top = \\nabla h({\\bm \\lambda})')
('3.4.0.2', '\\nabla h({\\bm \\lambda}) = \n\\partial {\\bm w}^\\star({\\bm \\lambda})^\\top \\nabla_1 g({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) \n+ \\nabla_2 g({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}).')
('3.4.0.2', '\\partial {\\bm w}^\\star({\\bm \\lambda})')
('3.4.0.2', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.0.2', '\\lambda')
('3.4.0.2', 'f')
('3.4.0.2', 'w^\\star(\\lambda) \\coloneqq \\mathop{\\mathrm{arg\\,min}}_w f(w; \\lambda)')
('3.4.0.2', 'h(\\lambda) \\coloneqq g(w^\\star(\\lambda), \\lambda)')
('3.4.0.2', 'g')
('3.4.0.2', '\\lambda_1')
('3.4.0.2', '\\lambda_2')
('3.4.0.2', '\\lambda^\\star')
('3.4.0.2', '\\lambda')
('3.4.0.2', 'h(\\lambda) = g(w^\\star(\\lambda), \\lambda)')
('3.4.0.2', '\\lambda')
('3.4.1', 'g = f')
('3.4.1', 'h')
('3.4.1', 'h({\\bm \\lambda}) \n= f({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda})\n= \\max_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda}).')
('3.4.1', 'h')
('3.4.1', 'f')
('3.4.1', 'h({\\bm \\lambda})= \\max_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda})')
('3.4.1', '{\\bm \\lambda}\\mapsto f({\\bm w},\n  {\\bm \\lambda})')
('3.4.1', '{\\bm w}\\in \\mathcal{W}')
('3.4.1.0', 'f')
('3.4.1.0', 'f \\colon \\mathcal{W}\\times \\Lambda \\to \\mathbb{R}')
('3.4.1.0', '\\mathcal{W}')
('3.4.1.0', 'h({\\bm \\lambda}) \n\\coloneqq \\max_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda})')
('3.4.1.0', '{\\bm w}^\\star({\\bm \\lambda})\n\\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda}).')
('3.4.1.0', 'f')
('3.4.1.0', '{\\bm w}')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.1.0', 'h')
('3.4.1.0', '\\nabla h({\\bm \\lambda}) = \\nabla_2 f({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}).')
('3.4.1.0', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', 'h({\\bm \\lambda}) = \\min_{{\\bm w}\\in \\mathcal{W}} f({\\bm w},\n{\\bm \\lambda})')
('3.4.1.0', 'f({\\bm w}, {\\bm \\lambda})')
('3.4.1.0', '{\\bm w}')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', 'h(\\lambda) = \\min_{w \\in \\mathbb{R}} f(w, \\lambda)')
('3.4.1.0', 'f(w, \\lambda) = \\frac{\\lambda}{2} w^2 + b w + c')
('3.4.1.0', '\\lambda > 0')
('3.4.1.0', 'w^\\star(\\lambda)')
('3.4.1.0', 'f')
('3.4.1.0', '\\lambda')
('3.4.1.0', '\\frac{1}{2} w^2')
('3.4.1.0', "h'(\\lambda) = \\frac{1}{2} w^\\star(\\lambda)")
('3.4.1.0', 'f')
('3.4.1.0', 'w')
('3.4.1.0', '\\lambda w + b')
('3.4.1.0', 'w^\\star(\\lambda) = -\\frac{b}{\\lambda}')
('3.4.1.0', "h'(\\lambda) = \\frac{1}{2} \\frac{b^2}{\\lambda^2}")
('3.4.1.0', 'w^\\star(\\lambda)')
('3.4.1.0', 'f(w, \\lambda)')
('3.4.1.0', 'h(\\lambda) =\n-\\frac{1}{2} \\frac{b^2}{\\lambda} + c')
('3.4.1.0', "(\\frac{1}{\\lambda})' =\n-\\frac{1}{\\lambda^2}")
('3.4.1.0', "h'(\\lambda)")
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', 'f({\\bm w}, {\\bm \\lambda}) \\coloneqq \\langle {\\bm w}, {\\bm \\lambda}\\rangle - \\Omega({\\bm w})')
('3.4.1.0', '\\Omega')
('3.4.1.0', 'h({\\bm \\lambda}) = \\max_{{\\bm w}\\in \\mathcal{W}} ~ \\langle {\\bm w}, {\\bm \\lambda}\\rangle\n- \\Omega({\\bm w}) \\eqqcolon \\Omega^*({\\bm \\lambda})')
('3.4.1.0', '\\Omega^*')
('3.4.1.0', '\\Omega')
('3.4.1.0', 'f')
('3.4.1.0', '\\nabla_2 f({\\bm w}, {\\bm \\lambda}) = {\\bm w}')
('3.4.1.0', '\\nabla h({\\bm \\lambda}) = \\nabla \\Omega^*({\\bm \\lambda}) =\n{\\bm w}^\\star({\\bm \\lambda})')
('3.4.1.0', 'f({\\bm w}, {\\bm \\lambda})')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', '\\min_{{\\bm \\lambda}\\in \\Lambda} \\max_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda})')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.0', '{\\bm w}')
('3.4.1.0', '\\min_{{\\bm \\lambda}\\in \\Lambda} h({\\bm \\lambda})')
('3.4.1.0', 'h({\\bm \\lambda}) \\coloneqq \\max_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda})')
('3.4.1.0', '\\nabla h({\\bm \\lambda})')
('3.4.1.0', '{\\bm \\lambda}')
('3.4.1.1', 'f')
('3.4.1.1', '{\\bm w}')
('3.4.1.1', 'f \\colon \\mathcal{W}\\times \\Lambda \\to \\mathbb{R}')
('3.4.1.1', '\\mathcal{W}')
('3.4.1.1', 'h({\\bm \\lambda}) \n\\coloneqq \\max_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda})')
('3.4.1.1', '{\\bm w}^\\star({\\bm \\lambda})\n\\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm w}\\in \\mathcal{W}} f({\\bm w}, {\\bm \\lambda}).')
('3.4.1.1', 'f')
('3.4.1.1', '{\\bm \\lambda}')
('3.4.1.1', '{\\bm w}\\in \\mathcal{W}')
('3.4.1.1', '\\nabla_1 f')
('3.4.1.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.1.1', 'h')
('3.4.1.1', '\\nabla h({\\bm \\lambda}) = \\nabla_2 f({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}).')
('3.4.1.1', 'f')
('3.4.1.1', 'f')
('3.4.2.0', 'F(x, \\lambda) = 0')
('3.4.2.0', 'x = x^\\star(\\lambda)')
('3.4.2.0', '\\lambda')
('3.4.2.0', 'F \\colon \\mathbb{R}\\times \\mathbb{R}\\to \\mathbb{R}')
('3.4.2.0', 'F(x, \\lambda)')
('3.4.2.0', '\\mathcal{U}')
('3.4.2.0', '(x_0, \\lambda_0)')
('3.4.2.0', 'F(x_0, \\lambda_0) = 0')
('3.4.2.0', '\\partial_1 F(x_0, \\lambda_0) \\neq 0')
('3.4.2.0', '\\mathcal{V}\\subseteq \\mathcal{U}')
('3.4.2.0', '(x_0, \\lambda_0)')
('3.4.2.0', 'x^\\star(\\lambda)')
('3.4.2.0', 'x^\\star(\\lambda_0) = x_0')
('3.4.2.0', 'F(x^\\star(\\lambda), \\lambda) = 0')
('3.4.2.0', '\\lambda')
('3.4.2.0', '\\mathcal{V}')
('3.4.2.0', '\\partial x^\\star(\\lambda) = -\\frac{\\partial_2 F(x^\\star(\\lambda), \\lambda)}{\n\\partial_1 F(x^\\star(\\lambda), \\lambda)}')
('3.4.2.0', 'w \\equiv x')
('3.4.2.0', '\\lambda \\equiv y')
('3.4.2.0', 'F(x, y) \\coloneqq x^2 + y^2 - 1')
('3.4.2.0', 'F(x, y) = 0')
('3.4.2.0', 'y')
('3.4.2.0', 'x')
('3.4.2.0', 'y \\in [-1, 1]')
('3.4.2.0', 'x')
('3.4.2.0', 'x = \\sqrt{1 - y^2}')
('3.4.2.0', 'x = -\\sqrt{1 - y^2}')
('3.4.2.0', '(x_0, y_0)')
('3.4.2.0', 'x_0 > 0')
('3.4.2.0', 'y_0 > 0')
('3.4.2.0', 'x = x^\\star(y) = \\sqrt{1 - y^2}')
('3.4.2.0', '\\partial_1 F(x, y) = 2x')
('3.4.2.0', '\\partial_2 F(x, y) = 2y')
('3.4.2.0', '\\partial x^\\star(y) = - \\frac{2y}{2 x^\\star(y)} = -\\frac{y}{\\sqrt{1 - y^2}}')
('3.4.2.0', '\\sqrt{1 - y^2}')
('3.4.2.0', 'y \\in [0, 1)')
('3.4.2.0', 'y')
('3.4.2.0', 'x')
('3.4.2.0', 'x^\\star(\\lambda)')
('3.4.2.0', 'F(x^\\star(\\lambda),\n\\lambda) = 0')
('3.4.2.0', 'F(w, \\lambda) = w^5 + w^3 + w - \\lambda')
('3.4.2.0', '5')
('3.4.2.0', '\\partial_1 F(w,\n\\lambda) =\n5w^4 + 3w^2 + 1')
('3.4.2.0', 'w^\\star(\\lambda)')
('3.4.2.0', 'F(w^\\star(\\lambda), \\lambda) = 0')
('3.4.2.0', '\\partial w^\\star(\\lambda) = (5w^\\star(\\lambda)^4 + 3 w^\\star(\\lambda)^2 +\n1)^{-1}')
('3.4.2.0', 'F(w, \\lambda) = (w - \\lambda)^2')
('3.4.2.0', 'F(w^\\star(\\lambda), \\lambda) = 0')
('3.4.2.0', 'w^\\star(\\lambda) = \\lambda')
('3.4.2.0', '\\lambda')
('3.4.2.0', '\\partial_1 F(w, \\lambda) = 2(w-\\lambda)')
('3.4.2.0', '\\partial_1 F(0, 0) = 0')
('3.4.2.1', 'F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) = {\\mathbf{0}}')
('3.4.2.1', '\\partial_1 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) \\partial {\\bm w}^\\star({\\bm \\lambda}) +\n\\partial_2 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) = {\\mathbf{0}},')
('3.4.2.1', '\\partial {\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', '-\\partial_1 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) \\partial {\\bm w}^\\star({\\bm \\lambda}) =\n\\partial_2 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}).')
('3.4.2.1', '\\partial {\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', 'F \\colon \\mathcal{W}\\times \\Lambda \\to \\mathcal{W}')
('3.4.2.1', 'F({\\bm w}, {\\bm \\lambda})')
('3.4.2.1', '({\\bm w}_0, {\\bm \\lambda}_0)')
('3.4.2.1', 'F({\\bm w}_0, {\\bm \\lambda}_0) = {\\mathbf{0}}')
('3.4.2.1', '\\partial_1 F({\\bm w}_0, {\\bm \\lambda}_0)')
('3.4.2.1', '{\\bm \\lambda}_0')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda}_0) = {\\bm w}_0')
('3.4.2.1', 'F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) = {\\mathbf{0}}')
('3.4.2.1', '{\\bm \\lambda}')
('3.4.2.1', '-\\partial_1 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda})  \\partial {\\bm w}^\\star({\\bm \\lambda}) =  \\partial_2 F({\\bm w}^\\star({\\bm \\lambda}),{\\bm \\lambda})')
('3.4.2.1', '\\iff \\partial {\\bm w}^\\star({\\bm \\lambda}) \n= -\\partial_1 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda})^{-1} \\partial_2 F({\\bm w}^\\star({\\bm \\lambda}),\n{\\bm \\lambda}).')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda}) = \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathbb{R}^P} f({\\bm w}, {\\bm \\lambda})')
('3.4.2.1', 'f')
('3.4.2.1', '{\\bm w}')
('3.4.2.1', 'F({\\bm w}, {\\bm \\lambda}) \\coloneqq \\nabla_1 f({\\bm w}, {\\bm \\lambda})')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', 'F')
('3.4.2.1', 'F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) = {\\mathbf{0}}')
('3.4.2.1', '\\partial_1 F({\\bm w}, {\\bm \\lambda}) = \\nabla^2_1 f({\\bm w}, {\\bm \\lambda})')
('3.4.2.1', 'f')
('3.4.2.1', '{\\bm w}')
('3.4.2.1', '\\partial_2 F({\\bm w}, {\\bm \\lambda}) = \\partial_2 \\nabla_1 f({\\bm w},\n{\\bm \\lambda})')
('3.4.2.1', 'f')
('3.4.2.1', '({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda})')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', '\\partial {\\bm w}^\\star({\\bm \\lambda}) = -\\nabla^2_1 f({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda})\n \\partial_2 \\nabla_1 f({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda})')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda}) = \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\n\\in \\mathcal{C}} f({\\bm w}, {\\bm \\lambda})')
('3.4.2.1', 'f')
('3.4.2.1', '{\\bm w}')
('3.4.2.1', '\\mathcal{C}\n\\subseteq \\mathcal{W}')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda}) = P_\\mathcal{C}({\\bm w}^\\star({\\bm \\lambda}) - \\eta \\nabla_1\nf({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}))')
('3.4.2.1', '\\eta > 0')
('3.4.2.1', 'P({\\bm y}) \\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm x}\\in \\mathcal{C}} \\|{\\bm x}- {\\bm y}\\|_2^2')
('3.4.2.1', '{\\bm y}')
('3.4.2.1', '\\mathcal{C}')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', 'F({\\bm w}, {\\bm \\lambda}) =\n{\\bm w}- P_\\mathcal{C}({\\bm w}- \\eta \\nabla_1 f({\\bm w}, {\\bm \\lambda}))')
('3.4.2.1', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.1', '\\partial_1 F({\\bm w}, {\\bm \\lambda})')
('3.4.2.1', '\\partial P_\\mathcal{C}({\\bm y})')
('3.4.2.1', 'P_\\mathcal{C}({\\bm y})')
('3.4.2.1', '\\mathcal{C}')
('3.4.2.2', '{\\bm w}^\\star({\\bm \\lambda})')
('3.4.2.2', '{\\bm w}^\\star \\colon \\Lambda \\to \\mathcal{W}')
('3.4.2.2', 'F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) = {\\mathbf{0}}')
('3.4.2.2', 'F \\colon \\mathcal{W}\\times \\Lambda \\to \\mathcal{W}')
('3.4.2.2', '\\begin{aligned}\n  A & \\coloneqq -\\partial_1 F({\\bm w}^\\star({\\bm \\lambda}), {\\bm \\lambda}) \\\\\n  B & \\coloneqq \\partial_2 F({\\bm w}^\\star({\\bm \\lambda}),{\\bm \\lambda}).\n\\end{aligned}')
('3.4.2.2', '{\\bm t}\\coloneqq \\partial {\\bm w}^\\star({\\bm \\lambda}) {\\bm v}')
('3.4.2.2', '{\\bm v}\\in \\Lambda')
('3.4.2.2', 'A {\\bm t}= B {\\bm v}.')
('3.4.2.2', '\\partial {\\bm w}^\\star({\\bm \\lambda})^* {\\bm u}')
('3.4.2.2', '{\\bm u}\\in \\mathcal{W}')
('3.4.2.2', 'A^* {\\bm r}= {\\bm u}.')
('3.4.2.2', '{\\bm r}')
('3.4.2.2', '\\partial {\\bm w}^\\star({\\bm \\lambda})^* {\\bm u}\n= \\partial {\\bm w}^\\star({\\bm \\lambda})^* A^* {\\bm r}\n= B^*{\\bm r}.')
('3.4.2.2', 'A')
('3.4.2.2', 'B')
('3.4.2.2', 'F')
('3.4.2.2', 'A^*')
('3.4.2.2', 'B^*')
('3.4.2.2', 'F')
('3.4.2.2', 'A')
('3.4.2.2', 'A')
('3.4.2.3', 'f({\\bm \\lambda}, {\\bm w}) = ({\\bm \\lambda}, F({\\bm w}, {\\bm \\lambda}))')
('3.4.2.3', '\\mathbb{R}^Q \\times \\mathbb{R}^P')
('3.4.2.3', '\\mathbb{R}^Q \\times \\mathbb{R}^P')
('3.4.2.3', 'f')
('3.4.2.3', '\\bm \\partial f({\\bm \\lambda}, {\\bm w})  =\n  \\begin{pmatrix}\n    \\operatorname{I}& 0 \\\\\n    \\bm \\partial_2  F({\\bm w}, {\\bm \\lambda}) & \\bm \\partial_1 F({\\bm w}, {\\bm \\lambda})\n  \\end{pmatrix}.')
('3.4.2.3', '{\\bm w}_0, {\\bm \\lambda}_0')
('3.4.2.3', '\\det(\\bm \\partial f({\\bm \\lambda}_0, {\\bm w}_0)) =\n  \\det(\\operatorname{I})\\det( \\bm \\partial_1 F({\\bm w}_0, {\\bm \\lambda}_0)) > 0')
('3.4.2.3', '\\partial_1\n  F({\\bm w}_0, {\\bm \\lambda}_0)')
('3.4.2.3', 'f')
('3.4.2.3', 'N')
('3.4.2.3', 'f({\\bm \\lambda}_0,\n  {\\bm w}_0) = ({\\bm \\lambda}_0, {\\mathbf{0}})')
('3.4.2.3', 'N \\cap\n  \\{({\\bm \\lambda}, {\\mathbf{0}}), {\\bm \\lambda}\\in \\mathbb{R}^Q\\}')
('3.4.2.3', '{\\bm \\lambda}_0')
('3.4.2.3', '( {\\bm \\lambda},\n  {\\bm w}^*({\\bm \\lambda})) = f^{-1}({\\bm \\lambda}, {\\mathbf{0}})')
('3.4.2.3', 'f^{-1}')
('3.4.2.3', '{\\bm w}^*({\\bm \\lambda})')
('3.4.2.3', '\\partial {\\bm w}^*({\\bm \\lambda})')
('3.4.2.3', '\\begin{pmatrix}\n      \\sim  & \\sim \\\\\n      \\partial {\\bm w}^*({\\bm \\lambda}) & \\sim\n    \\end{pmatrix} = \\partial f^{-1}({\\bm \\lambda}, {\\mathbf{0}}),')
('3.4.2.3', '\\partial f^{-1}({\\bm \\lambda}, {\\mathbf{0}}) = (\\partial f({\\bm \\lambda},\n  {\\bm w}^*({\\bm \\lambda})))^{-1}')
('3.4.2.3', '\\begin{pmatrix}\n      {\\bm A}& {\\bm B}\\\\\n      {\\bm C}& {\\bm D}\n    \\end{pmatrix}^{-1} \n    = \n    \\begin{pmatrix}\n      \\sim & \\sim \\\\\n      -({\\bm D}- {\\bm C}{\\bm A}^{-1}{\\bm B})^{-1}{\\bm C}{\\bm A}^{-1} & \\sim\n    \\end{pmatrix},')
('3.4.3.0', '{\\bm s}\\in \\mathcal{S}')
('3.4.3.0', '{\\bm w}\\in \\mathcal{W}')
('3.4.3.0', 'c({\\bm s}, {\\bm w}) = {\\mathbf{0}}')
('3.4.3.0', 'c \\colon \\mathcal{S}\\times \\mathcal{W}\\to \\mathcal{S}')
('3.4.3.0', '{\\bm s}')
('3.4.3.0', '{\\bm w}\\in \\mathcal{W}')
('3.4.3.0', '{\\bm s}^\\star({\\bm w})')
('3.4.3.0', '\\mathcal{W}')
('3.4.3.0', '\\mathcal{S}')
('3.4.3.0', 'c({\\bm s}^\\star({\\bm w}), {\\bm w}) = {\\mathbf{0}}')
('3.4.3.0', 'L \\colon \\mathcal{S}\\times \\mathcal{W}\\to \\mathbb{R}')
('3.4.3.0', 'L({\\bm w}) \\coloneqq L({\\bm s}^\\star({\\bm w}), {\\bm w}).')
('3.4.3.0', '{\\bm s}^\\star({\\bm w})')
('3.4.3.0', '\\begin{aligned}\n\\min_{{\\bm w}\\in \\mathcal{W}} L({\\bm s}, {\\bm w}) \n\\quad \\text{s.t.} \\quad c({\\bm s}, {\\bm w}) = {\\mathbf{0}}.\n\\end{aligned}')
('3.4.3.0', '\\begin{aligned}\n\\min_{{\\bm w}\\in \\mathcal{W}} L({\\bm s}^\\star({\\bm w}), {\\bm w}).\n\\end{aligned}')
('3.4.3.0', '\\nabla L({\\bm w})')
('3.4.3.0', 'c:\\mathcal{S}\\times \\mathcal{W}\\rightarrow \\mathcal{S}')
('3.4.3.0', 'c({\\bm s}, {\\bm w})')
('3.4.3.0', '{\\bm w}\\in \\mathcal{W}')
('3.4.3.0', '{\\bm s}^\\star({\\bm w})')
('3.4.3.0', 'c({\\bm s}^\\star({\\bm w}), {\\bm w})= {\\mathbf{0}}')
('3.4.3.0', '{\\bm s}^\\star({\\bm w})')
('3.4.3.0', 'L({\\bm w}) \\coloneqq L({\\bm s}^\\star({\\bm w}), {\\bm w}),')
('3.4.3.0', 'L:\\mathcal{S}\\times \\mathcal{W}\\rightarrow \\mathbb{R}')
('3.4.3.0', '\\nabla L({\\bm w}) = \n  \\nabla_2 L({\\bm s}^\\star({\\bm w}), {\\bm w}) + \\partial_2 c({\\bm s}^\\star({\\bm w}), {\\bm w})^* {\\bm r}^\\star({\\bm w}),')
('3.4.3.0', '{\\bm r}^\\star({\\bm w})')
('3.4.3.0', '\\partial_1 c({\\bm s}^\\star({\\bm w}), {\\bm w})^* {\\bm r}= -\\nabla_1 L({\\bm s}^\\star({\\bm w}), {\\bm w}).')
('3.4.3.0', '{\\bm r}^\\star({\\bm w})')
('3.4.3.1', '{\\bm s}')
('3.4.3.1', '{\\bm w}\\in \\mathcal{W}')
('3.4.3.1', 'c({\\bm s}, {\\bm w}) =\n{\\mathbf{0}}')
('3.4.3.1', 'L({\\bm w})')
('3.4.3.1', '\\begin{aligned}\nL({\\bm w}) \n&= \\min_{{\\bm s}\\in \\mathcal{S}} L({\\bm s}, {\\bm w}) \\quad \\text{s.t.} \\quad c({\\bm s}, {\\bm w}) = {\\mathbf{0}}\\\\\n&= \\max_{{\\bm s}\\in \\mathcal{S}} L({\\bm s}, {\\bm w}) \\quad \\text{s.t.} \\quad c({\\bm s}, {\\bm w}) = {\\mathbf{0}}.\n\\end{aligned}')
('3.4.3.1', '\\nabla L({\\bm w})')
('3.4.3.1', '{\\bm w}')
('3.4.3.2', 'L')
('3.4.3.2', 'c')
('3.4.3.2', '\\mathcal{L}({\\bm s}, {\\bm w}, {\\bm r}) \\coloneqq L({\\bm s}, {\\bm w}) + \\langle {\\bm r}, c({\\bm s}, {\\bm w}) \\rangle,')
('3.4.3.2', '{\\bm r}\\in \\mathcal{S}')
('3.4.3.2', 'c({\\bm s}, {\\bm w}) = {\\mathbf{0}}')
('3.4.3.2', '{\\bm r}')
('3.4.3.2', '\\begin{aligned}\n\\nabla_{\\bm s}\\mathcal{L}({\\bm s}, {\\bm w}, {\\bm r}) &= \\nabla_1 L({\\bm s}, {\\bm w}) + \\partial_1 c({\\bm s}, {\\bm w})^* {\\bm r}\\\\\n\\nabla_{\\bm w}\\mathcal{L}({\\bm s}, {\\bm w}, {\\bm r}) &= \\nabla_2 L({\\bm s}, {\\bm w}) + \\partial_2 c({\\bm s}, {\\bm w})^* {\\bm r}\\\\\n\\nabla_{\\bm r}\\mathcal{L}({\\bm s}, {\\bm w}, {\\bm r}) &= c({\\bm s}, {\\bm w}),\n\\end{aligned}')
('3.4.3.2', '\\partial_i c({\\bm s}, {\\bm w})^*')
('3.4.3.2', '\\nabla_{\\bm r}\\mathcal{L}({\\bm s}, {\\bm w}, {\\bm r})')
('3.4.3.2', 'c({\\bm s}, {\\bm w}) = {\\mathbf{0}}')
('3.4.3.2', '\\nabla_{\\bm s}\\mathcal{L}({\\bm s}, {\\bm w}, {\\bm r})')
('3.4.3.2', '\\partial_1 c({\\bm s}, {\\bm w})^* {\\bm r}= -\\nabla_1 L({\\bm s}, {\\bm w}).')
('3.4.3.2', '{\\bm r}')
('3.4.3.2', '{\\bm s}= {\\bm s}^\\star({\\bm w})')
('3.4.3.2', '{\\bm r}^\\star({\\bm w})')
('3.4.3.2', '\\begin{aligned}\n\\nabla L({\\bm w})\n&= \\nabla_2 \\mathcal{L}({\\bm s}^\\star({\\bm w}), {\\bm w}, {\\bm r}^\\star({\\bm w})) \\\\\n&=\n\\nabla_2 L({\\bm s}^\\star({\\bm w}), {\\bm w}) + \\partial_2 c({\\bm s}^\\star({\\bm w}), {\\bm w})^* {\\bm r}^\\star({\\bm w}),\n\\end{aligned}')
('3.4.3.3', '\\nabla L({\\bm w}) = \\nabla_2 L({\\bm s}^\\star({\\bm w}), {\\bm w}) \n+ \\partial {\\bm s}^\\star({\\bm w})^* \\nabla_1 L({\\bm s}^\\star({\\bm w}), {\\bm w}),')
('3.4.3.3', '\\partial {\\bm s}^\\star({\\bm w})^*')
('3.4.3.3', '{\\bm s}^\\star')
('3.4.3.3', '\\mathcal{S}')
('3.4.3.3', '\\mathcal{W}')
('3.4.3.3', '\\partial {\\bm s}^\\star({\\bm w})^*')
('3.4.3.3', '{\\bm u}= \\nabla_1 L({\\bm s}^\\star({\\bm w}), {\\bm w}) \\in \\mathcal{S}')
('3.4.3.3', 'c({\\bm s}^\\star({\\bm w}), {\\bm w}) = {\\mathbf{0}}')
('3.4.3.3', 'A^* {\\bm r}= {\\bm u}')
('3.4.3.3', 'A^* \\coloneqq \\partial_1 c({\\bm s}^\\star({\\bm w}), {\\bm w})^*')
('3.4.3.3', '\\mathcal{S}')
('3.4.3.3', '\\mathcal{S}')
('3.4.3.3', '{\\bm r}')
('3.4.3.3', '\\partial {\\bm s}^\\star({\\bm w})^* {\\bm u}= B^* {\\bm r}')
('3.4.3.3', 'B^* \\coloneqq \\partial_2 c({\\bm s}^\\star({\\bm w}), {\\bm w})^*')
('3.4.3.3', '\\mathcal{S}')
('3.4.3.3', '\\mathcal{W}')
('3.4.3.3', '\\nabla L({\\bm w}) = \\nabla_2 L({\\bm s}^\\star({\\bm w}), {\\bm w}) \n+ \\partial_2 c({\\bm s}^\\star({\\bm w}), {\\bm w})^* {\\bm r}.')
('3.4.3.4', '{\\bm x}\\in \\mathcal{X}')
('3.4.3.4', '{\\bm w}= ({\\bm w}_1,\n\\ldots, {\\bm w}_k) \\in \\mathcal{W}_1 \\times \\ldots \\times \\mathcal{W}_K')
('3.4.3.4', '\\begin{aligned}\n\t{\\bm s}_0 &\\coloneqq {\\bm x}\\in \\mathcal{X}\\nonumber \\\\\n\t{\\bm s}_1 &\\coloneqq f_1({\\bm s}_0, {\\bm w}_1) \\in \\mathcal{S}_1 \\nonumber \\\\ \n\t\t & \\hspace{6pt} \\vdots \\nonumber\\\\\n\t{\\bm s}_K &\\coloneqq f_K({\\bm s}_{K-1}, {\\bm w}_K) \\in \\mathcal{S}_K \\nonumber \\\\\n\tf({\\bm w}) &\\coloneqq {\\bm s}_K. \\label{auto_diff:eq:feedforward_autodiff_viewpoints}\n\\end{aligned}')
('3.4.3.4', '{\\bm w}')
('3.4.3.4', 'f({\\bm w})')
('3.4.3.4.0', '{\\bm s}= ({\\bm s}_1, \\ldots, {\\bm s}_K)\n\\in \\mathcal{S}_1 \\times  \\ldots \\times \\mathcal{S}_K')
('3.4.3.4.0', 'c({\\bm s}, {\\bm w}) = {\\mathbf{0}}')
('3.4.3.4.0', 'c({\\bm s}, {\\bm w}) \\coloneqq \n  \\begin{pmatrix}\n    {\\bm s}_1 - f_1({\\bm x}, {\\bm w}_1) \\\\\n    {\\bm s}_2 - f_2({\\bm s}_1, {\\bm w}_2) \\\\\n    \\vdots \\\\\n    {\\bm s}_K - f_K({\\bm s}_{K-1}, {\\bm w}_K)\n  \\end{pmatrix}.')
('3.4.3.4.0', '{\\bm s}^\\star({\\bm w}) = ({\\bm s}_1^\\star({\\bm w}), \\ldots, {\\bm s}_K^\\star({\\bm w}))')
('3.4.3.4.0', '{\\bm s}_1,\n\\ldots, {\\bm s}_K')
('3.4.3.4.0', 'f({\\bm w}) = {\\bm s}_K^\\star({\\bm w})')
('3.4.3.4.0', '{\\bm s}^\\star_K({\\bm w})')
('3.4.3.4.0', '\\ell')
('3.4.3.4.0', 'L({\\bm w}) \\coloneqq \\ell({\\bm s}_K^\\star({\\bm w}); {\\bm y}).')
('3.4.3.4.0', 'L({\\bm w})')
('3.4.3.4.0', 'L({\\bm w}) = \\min_{{\\bm s}\\in \\mathcal{S}} \\ell({\\bm s}; {\\bm y})\n\\quad \\text{s.t.} \\quad\nc({\\bm s}, {\\bm w}) = {\\mathbf{0}}.')
('3.4.3.4.0', '{\\bm s}_K^\\star({\\bm w})')
('3.4.3.4.0', '{\\bm u}_K \\in \\mathcal{S}_K')
('3.4.3.4.0', 'L({\\bm w}) \n\\coloneqq \\ell({\\bm s}_K^\\star({\\bm w}); {\\bm u}_K)\n\\coloneqq \\langle {\\bm s}_K^\\star({\\bm w}), {\\bm u}_K \\rangle')
('3.4.3.4.0', '\\partial f({\\bm w})^* {\\bm u}_K = \\nabla L({\\bm w}).')
('3.4.3.4.0', '{\\bm u}\\in \\mathcal{S}_1 \\times \\dots \\times \\mathcal{S}_{K-1} \\times \\mathcal{S}_K')
('3.4.3.4.0', '{\\bm u}\\coloneqq ({\\mathbf{0}}, \\ldots, {\\mathbf{0}}, \\nabla_1 \\ell(f({\\bm w}); {\\bm y}))')
('3.4.3.4.0', '\\ell')
('3.4.3.4.0', '{\\bm u}\\coloneqq ({\\mathbf{0}}, \\ldots, {\\mathbf{0}}, {\\bm u}_K)')
('3.4.3.4.0', 'f')
('3.4.3.4.0', '{\\bm u}_K')
('3.4.3.4.0', '\\nabla  L({\\bm w}) = \\partial_2 c({\\bm s}({\\bm w}), {\\bm w})^* {\\bm r}^\\star({\\bm w}),')
('3.4.3.4.0', '{\\bm r}^\\star({\\bm w})')
('3.4.3.4.0', '\\partial_1 c({\\bm s}({\\bm w}), {\\bm w})^* {\\bm r}=  -{\\bm u}.')
('3.4.3.4.1', 'c')
('3.4.3.4.1', '{\\bm s}^\\star({\\bm w})')
('3.4.3.4.1', '\\bm \\partial_1 c({\\bm s}^\\star({\\bm w}), {\\bm w}) \n  =\n  \\begin{pmatrix}\n    \\operatorname{I}& 0 & \\dots & \\dots & 0 \\\\\n    - A_1 & \\operatorname{I}& \\ddots &  & \\vdots\\\\\n    0 & -A_2 & \\operatorname{I}& \\ddots & \\vdots \\\\\n    \\vdots & \\ddots & \\ddots & \\ddots & 0 \\\\\n    0 & \\dots & 0 & -A_K & \\operatorname{I}\n  \\end{pmatrix},')
('3.4.3.4.1', 'A_k \\coloneqq \\bm \\partial_1 f_k({\\bm s}_{k-1}, {\\bm w}_k)')
('3.4.3.4.1', '\\bm \\partial_1 c({\\bm s}^\\star({\\bm w}), {\\bm w})^*\n  =\n  \\begin{pmatrix}\n    \\operatorname{I}& - A_1^* & 0 & \\dots & 0 \\\\\n    0 & \\operatorname{I}& -A_2^* & \\ddots & \\vdots\\\\\n    \\vdots & \\ddots & \\operatorname{I}& \\ddots & 0 \\\\\n    \\vdots &  & \\ddots & \\ddots & -A_K^* \\\\\n    0 & \\dots & \\dots & 0 & \\operatorname{I}\n  \\end{pmatrix}.')
('3.4.3.4.1', '\\partial_1 c({\\bm s}({\\bm w}), {\\bm w})^*{\\bm r}= {\\bm u}')
('3.4.3.4.1', '{\\bm r}_K = {\\bm u}')
('3.4.3.4.1', '{\\bm r}_k')
('3.4.3.4.1', 'k+1')
('3.4.3.4.1', 'k \\in (K-1,\\dots,1)')
('3.4.3.4.1', '\\begin{aligned}\n{\\bm r}_k -  A_{k+1}^*{\\bm r}_{k+1} = {\\mathbf{0}}\n\\iff \n{\\bm r}_k = \\partial f_{k+1}({\\bm s}_k, {\\bm w}_{k+1})^*{\\bm r}_{k+1}.\n\\end{aligned}')
('3.4.3.4.1', '\\partial_2 c({\\bm s}({\\bm w}), {\\bm w})^* {\\bm r}\n  = \\begin{pmatrix}\n    \\partial_2 f_1({\\bm x}, {\\bm w}_1)^* {\\bm r}_1 \\\\\n    \\partial_2 f_2({\\bm s}_1({\\bm w}), {\\bm w}_2)^* {\\bm r}_2 \\\\\n    \\vdots \\\\\n    \\partial_2 f_K({\\bm s}_1({\\bm w}), {\\bm w}_K)^* {\\bm r}_K\n  \\end{pmatrix},')
('3.4.3.4.1', '{\\bm w}= ({\\bm w}_1, \\dots, {\\bm w}_K)')
('3.4.3.4.1', '{\\bm w}')
('3.4.3.4.1', '{\\bm w}')
('3.4.3.4.1', 'f')
('3.4.4.0', 'f^{-1}')
('3.4.4.0', 'f^{-1}')
('3.4.4.0', 'f')
('3.4.4.0', 'f \\colon \\mathcal{W}\\to \\mathcal{W}')
('3.4.4.0', '\\partial f({\\bm w}_0)')
('3.4.4.0', '{\\bm w}_0')
('3.4.4.0', 'f')
('3.4.4.0', '{\\bm w}_0')
('3.4.4.0', 'f({\\bm w}_0)')
('3.4.4.0', 'f^{-1}')
('3.4.4.0', '{\\bm \\omega}_0 = f({\\bm w}_0)')
('3.4.4.0', '\\partial f^{-1}({\\bm \\omega})')
('3.4.4.0', '\\partial f({\\bm w}) \\partial f^{-1}({\\bm \\omega})= I\n\\Leftrightarrow\n\\partial f^{-1}({\\bm \\omega}) = (\\partial f({\\bm w}))^{-1},')
('3.4.4.0', '{\\bm w}= f^{-1}({\\bm \\omega})')
('3.4.4.1', 'F \\colon \\mathcal{W}\\times \\Lambda \\to \\mathcal{W}')
('3.4.4.1', '\\mathcal{W}=\\Lambda=\\mathbb{R}^Q')
('3.4.4.1', 'F({\\bm w}, {\\bm \\omega}) = f({\\bm w}) - {\\bm \\omega}')
('3.4.4.1', 'f \\colon \\mathbb{R}^Q \\to \\mathbb{R}^Q')
('3.4.4.1', '{\\bm w}^\\star({\\bm \\omega})')
('3.4.4.1', 'F({\\bm w}^\\star({\\bm \\omega}), {\\bm \\omega}) = {\\mathbf{0}}')
('3.4.4.1', '{\\bm w}^\\star({\\bm \\omega}) = f^{-1}({\\bm \\omega})')
('3.4.4.1', '\\partial_1 F({\\bm w}, {\\bm \\omega}) = \\partial f({\\bm w})')
('3.4.4.1', '\\partial_2 F({\\bm w}, {\\bm \\omega}) = -I')
('3.4.4.1', 'F')
('3.4.4.2', 'f^{-1}')
('3.4.4.2', 'f({\\bm w}_0)')
('3.4.4.2', '{\\bm \\omega}')
('3.4.4.2', 'f({\\bm w}_0)')
('3.4.4.2', 'f \\circ f^{-1}({\\bm \\omega}) = {\\bm \\omega}.')
('3.4.4.2', '{\\bm \\omega}')
('3.4.4.2', '\\partial f(f^{-1}({\\bm \\omega})) \\partial f^{-1}({\\bm \\omega}) = \\operatorname{I},')
('3.4.4.2', '\\operatorname{I}')
('3.4.4.2', '\\mathbb{R}^Q')
('3.4.4.2', '{\\bm w}=\n  f^{-1}({\\bm \\omega})')
('3.4.4.2', 'f({\\bm w}_0)')
('3.4.4.2', '{\\bm l}=\\partial f({\\bm w}_0)')
('3.4.4.2', '{\\bm l}^{-1}')
('3.4.4.2', 'f')
('3.4.4.2', '{\\bm l}^{-1}(f({\\bm w})) - f({\\bm w}_0)')
('3.4.4.2', '\\partial f({\\bm w}_0) = \\operatorname{I}')
('3.4.4.2', 'f({\\bm w}_0) = 0')
('3.4.4.2', '{\\bm w}_0=0')
('3.4.4.2', 'f')
('3.4.4.2', 'N = \\{{\\bm w}:\n  \\|{\\bm w}-{\\bm w}_0\\|_2\\leq \\delta\\}')
('3.4.4.2', '\\|\\partial f({\\bm w}) - \\operatorname{I}\\|_2\\leq\n  1/2')
('3.4.4.2', 'g({\\bm w}) = f({\\bm w}) - {\\bm w}')
('3.4.4.2', '1/2')
('3.4.4.2', '{\\bm \\omega}')
('3.4.4.2', '\\|{\\bm \\omega}-f({\\bm w}_0)\\|_2 \\leq \\delta/2')
('3.4.4.2', "{\\bm w}_{k+1} =\n  {\\bm w}_k - f({\\bm w}_k) - {\\bm \\omega}'")
('3.4.4.2', '\\mathcal{N}')
('3.4.4.2', 'g')
('3.4.4.2', '{\\bm w}_\\infty')
('3.4.4.2', '{\\bm w}_\\infty = {\\bm w}_\\infty - f({\\bm w}_\\infty) - {\\bm \\omega}\\iff\n  f({\\bm w}_\\infty) = {\\bm \\omega}')
('3.4.4.2', 'M = \\{{\\bm \\omega}: \\|{\\bm \\omega}-{\\bm \\omega}_0\\|_2\\leq \\delta/2\\}')
('3.4.4.2', '{\\bm \\omega}_0 = f({\\bm w}_0)')
('3.4.4.2', 'N')
('3.4.4.2', 'f^{-1}')
('3.4.4.2', '{\\bm \\omega}')
('3.4.4.2', '{\\bm \\omega}_0')
('3.4.4.2', '{\\bm w}\\coloneqq\n  f^{-1}({\\bm \\omega}) \\in N')
('3.4.4.2', 'f')
('3.4.4.2', '{\\bm w}')
('3.4.4.2', '\\|\\partial f({\\bm w}) - \\operatorname{I}\\|_2 \\leq 1/2')
('3.4.4.2', '{\\bm a}= \\partial f({\\bm w}) -\\operatorname{I}')
('3.4.4.2', '{\\bm b}= \\sum_{k=0}^{+\\infty} {\\bm a}^k')
('3.4.4.2', '{\\bm b}= \\partial f({\\bm w})^{-1}')
('3.4.4.2', '\\partial f({\\bm w})')
('3.4.4.2', '\\|\\partial f({\\bm w})^{-1}\\|\\leq 2')
('3.4.4.2', '\\partial f({\\bm w})^{-1}')
('3.4.4.2', '\\frac{\\|f^{-1}({\\bm \\omega}+ {\\bm \\eta}) - f({\\bm \\omega}) - (\\partial f({\\bm w}))^{-1}{\\bm \\eta}\\|_2}\n    {\\|{\\bm \\eta}\\|_2}.')
('3.4.4.2', '{\\bm v}')
('3.4.4.2', 'f^{-1}({\\bm \\omega}+ {\\bm \\eta}) = {\\bm w}+ {\\bm v}')
('3.4.4.2', 'g({\\bm w}) =\n  f({\\bm w}) - {\\bm w}')
('3.4.4.2', '1/2')
('3.4.4.2', 'N')
('3.4.4.2', '\\|{\\bm v}-{\\bm \\eta}\\|_2 = \\|g({\\bm w}+\n  {\\bm v}) - g({\\bm w})\\|_2 \\leq 1/2\\|{\\bm v}\\|_2')
('3.4.4.2', '\\|{\\bm v}\\|_2 \\geq \\|{\\bm \\eta}\\|/2')
('3.4.4.2', '\\begin{aligned}\n    & \\frac{\\|f^{-1}({\\bm \\omega}+ {\\bm \\eta}) - f({\\bm \\omega}) - (\\partial f({\\bm w}))^{-1}{\\bm \\eta}\\|_2}\n    {\\|{\\bm \\eta}\\|_2} \\\\\n    & = \\frac{\\|{\\bm v}- (\\partial f({\\bm w}))^{-1}(f({\\bm w}+ {\\bm v}) - f({\\bm w}))\\|_2}\n    {\\|{\\bm \\eta}\\|_2} \\\\\n    & \\leq 4 \\frac{\\|f({\\bm w}+{\\bm v}) - f({\\bm w}) - \\partial f({\\bm w}){\\bm v}\\|_2}{\\|u\\|_2}\n  \n\\end{aligned}')
('3.4.4.2', '\\|{\\bm \\eta}\\|_2 \\rightarrow 0')
('3.4.4.2', '\\|{\\bm v}\\|_2 \\rightarrow 0')
('3.4.4.2', '\\|f({\\bm w}+{\\bm v}) - f({\\bm w}) - \\partial f({\\bm w}){\\bm v}\\|_2/\\|{\\bm v}\\|_2 \\rightarrow 0')
('3.4.4.2', 'f^{-1}')
('3.4.4.2', '\\partial f^{-1}({\\bm \\omega}) =  (\\partial\n  f({\\bm w}))^{-1} =  (\\partial f(f^{-1}({\\bm \\omega})))^{-1}')
('3.4.4.2', 'f^{-1}')
('3.4.4.2', '\\partial f^{-1}({\\bm \\omega})')
('3.5.0', '\\Theta')
('3.5.0', '\\mathcal{Y}')
('3.5.0', 'f: \\Theta\n\\times\\mathcal{Y}\\rightarrow \\mathbb{R}')
('3.5.0', 'F({\\bm \\theta}) \\coloneqq \\int_\\mathcal{Y}f({\\bm \\theta}, {\\bm y})d{\\bm y}.')
('3.5.0', '\\nabla F({\\bm \\theta}) = \\int_\\mathcal{Y}\\nabla_{\\bm \\theta}f({\\bm \\theta}, {\\bm y})d{\\bm y}.')
('3.5.0', '\\Theta = \\mathcal{Y}= \\mathbb{R}')
('3.5.0', 'f')
('3.5.0', 'f(\\theta,\n    \\cdot)')
('3.5.0', '\\theta \\in \\Theta')
('3.5.0', 'f(\\cdot, y)')
('3.5.0', 'y \\in \\mathcal{Y}')
('3.5.0', 'g(\\cdot, y)')
('3.5.0', 'f(\\theta, y) = f(\\theta_0, y) + \\int_{\\theta_0}^\\theta g(\\tau, y)d\\tau')
('3.5.0', '\\partial_1 f(\\theta, y)')
('3.5.0', 'f(\\cdot, y)')
('3.5.0', '[\\theta_0, \\theta_1]')
('3.5.0', '\\int_{\\theta_0}^{\\theta_1} \\int |\\partial_1 f(\\theta, y)| dy d\\theta')
('3.5.0', 'f:\\Theta \\times \\mathcal{Y}\\rightarrow \\mathbb{R}')
('3.5.0', 'f')
('3.5.0', 'f(\\cdot, y)')
('3.5.0', 'y')
('3.5.1', '{\\bm \\theta}')
('3.5.1.0', 'F({\\bm \\theta}) \n\\coloneqq \\mathbb{E}_{Y \\sim p}[g(Y, {\\bm \\theta})]\n= \\int_{\\mathcal{Y}} g({\\bm y}, {\\bm \\theta}) p({\\bm y}) d{\\bm y},')
('3.5.1.0', 'Y \\in \\mathcal{Y}\\subseteq \\mathbb{R}^M')
('3.5.1.0', 'p')
('3.5.1.0', 'g \\colon \\mathcal{Y}\\times \\Theta \\to \\mathbb{R}')
('3.5.1.0', '{\\bm \\theta}')
('3.5.1.0', '\\begin{aligned}\n\\nabla F({\\bm \\theta})\n&= \\nabla_{\\bm \\theta}\\int_{\\mathcal{Y}} g({\\bm y}, {\\bm \\theta}) p({\\bm y}) d{\\bm y}\\\\\n&= \\int_{\\mathcal{Y}} \\nabla_{\\bm \\theta}g({\\bm y}, {\\bm \\theta}) p({\\bm y}) d{\\bm y}\\\\\n&= \\mathbb{E}_{Y \\sim p}[\\nabla_{\\bm \\theta}g(Y, {\\bm \\theta})].\n\\end{aligned}')
('3.5.1.0', 'p')
('3.5.1.0', '\\widehat{F}_N({\\bm \\theta}) \\coloneqq \\frac{1}{N}\\sum_{i=1}^{N} g(Y_i, {\\bm \\theta})')
('3.5.1.0', '\\nabla \\widehat{F}_N({\\bm \\theta}) \n= \\frac{1}{N}\\sum_{i=1}^{N} \\nabla_{\\bm \\theta}g(Y_i, {\\bm \\theta}),')
('3.5.1.0', 'N')
('3.5.1.0', 'Y_1, \\ldots, Y_N')
('3.5.1.0', 'p')
('3.5.1.0', '\\mathbb{E}[\\widehat{F}_N({\\bm \\theta})] = F({\\bm \\theta})')
('3.5.1.0', '\\mathbb{E}[\\nabla \\widehat{F}_N({\\bm \\theta})] = \\nabla F({\\bm \\theta})')
('3.5.1.0', 'N \\rightarrow +\\infty')
('3.5.1.0', '\\nabla F({\\bm \\theta})')
('3.5.1.0', 'y_1, \\ldots, y_n')
('3.5.1.0', 'p')
('3.5.1.0', '\\widehat{F}_N({\\bm \\theta}) = \\frac{1}{n}\\sum_{i=1}^{n} g(y_i,\n      {\\bm \\theta})')
('3.5.1.0', '\\nabla \\widehat{F}_N({\\bm \\theta})')
('3.5.1.0', '\\nabla^2 F({\\bm \\theta})')
('3.5.1.0', '\\nabla^2\n\\widehat{F}_N({\\bm \\theta})')
('3.5.1.1', '{\\bm \\theta}')
('3.5.1.1', 'E({\\bm \\theta}) \\coloneqq \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y)]\n= \\int_{\\mathcal{Y}} g({\\bm y}) p_{\\bm \\theta}({\\bm y}) d{\\bm y},')
('3.5.1.1', 'Y \\in \\mathcal{Y}\\subseteq \\mathbb{R}^M')
('3.5.1.1', 'p_{\\bm \\theta}')
('3.5.1.1', '{\\bm \\theta}\\in \\Theta')
('3.5.1.1', 'g\n\\colon \\mathcal{Y}\\to \\mathbb{R}')
('3.5.1.1', '{\\bm \\theta}\\in\n\\Theta')
('3.5.1.1', '{\\bm \\theta}= f({\\bm x}, {\\bm w}) \\in \\Theta')
('3.5.1.1', 'f')
('3.5.1.1', '{\\bm w}\\in \\mathcal{W}')
('3.5.1.1', '\\nabla E({\\bm \\theta})')
('3.5.1.1', '{\\bm \\theta}')
('3.5.1.1', 'p_{\\bm \\theta}')
('3.5.1.1', 'E({\\bm \\theta}) = \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y)]')
('3.5.1.1', 'p_{\\bm \\theta}')
('3.5.1.1', 'E')
('3.5.1.1', '{\\bm \\theta}')
('3.5.1.1', '{\\bm \\theta}')
('3.5.1.1.0', '\\mathcal{Y}')
('3.5.1.1.0', 'p_{\\bm \\theta}({\\bm y})')
('3.5.1.1.0', 'E({\\bm \\theta})')
('3.5.1.1.0', 'E({\\bm \\theta}) = \\int_{\\mathcal{Y}} p_{\\bm \\theta}({\\bm y}) g({\\bm y}) d{\\bm y}.')
('3.5.1.1.0', '\\begin{aligned}\n\\nabla E({\\bm \\theta}) \n&= \\nabla_{\\bm \\theta}\\int_{\\mathcal{Y}} p_{\\bm \\theta}({\\bm y}) g({\\bm y}) d{\\bm y}\\\\\n&= \\int_{\\mathcal{Y}} \\nabla_{\\bm \\theta}p_{\\bm \\theta}({\\bm y}) g({\\bm y}) d{\\bm y}.\n\\end{aligned}')
('3.5.1.1.1', '\\mathcal{Y}')
('3.5.1.1.1', 'p_{\\bm \\theta}({\\bm y})')
('3.5.1.1.1', 'E({\\bm \\theta})')
('3.5.1.1.1', 'E({\\bm \\theta}) = \\sum_{{\\bm y}\\in \\mathcal{Y}} p_{\\bm \\theta}({\\bm y}) g({\\bm y}).')
('3.5.1.1.1', '\\nabla E({\\bm \\theta}) \n= \\sum_{{\\bm y}\\in \\mathcal{Y}}  g({\\bm y}) \\nabla_{{\\bm \\theta}} p_{\\bm \\theta}({\\bm y}).')
('3.5.1.1.1', '\\nabla E({\\bm \\theta})')
('3.5.1.1.1', '{\\bm y}\\in \\mathcal{Y}')
('3.5.1.1.1', '|\\mathcal{Y}|')
('3.5.1.1.1', 'p_{\\bm \\theta}')
('3.5.1.1.1', '\\{{\\bm y}\\in \\mathcal{Y}\\colon p_{\\bm \\theta}({\\bm y}) \\neq 0\\}')
('3.5.1.1.1', '{\\bm y}')
('3.5.1.1.1', 'g({\\bm y})')
('3.5.1.1.1', '\\nabla E({\\bm \\theta})')
('3.5.1.1.1', '{\\bm \\theta}')
('3.5.1.1.1', '{\\bm w}')
('3.5.1.2', 'L({\\bm \\theta}; {\\bm y}) \\coloneqq \\mathbb{E}_{\\hat Y \\sim p_{\\bm \\theta}}[\\ell(\\hat Y, {\\bm y})],')
('3.5.1.2', '{\\bm y}')
('3.5.1.2', '\\ell = -r')
('3.5.1.2', 'r')
('3.5.1.2', '\\ell \\colon \\mathcal{Y}\\times \\mathcal{Y}\\to \\mathbb{R}')
('3.5.1.2', '\\ell \\colon \\mathbb{R}^M \\times \\mathcal{Y}\\to \\mathbb{R}')
('3.5.1.2', 'L({\\bm \\theta}; {\\bm y})')
('3.5.1.2', 'p_{\\bm \\theta}')
('3.5.1.2', '\\widehat {\\bm y}')
('3.5.1.2', '\\ell(\\widehat {\\bm y}, {\\bm y})')
('3.5.1.2', '\\mathcal{Y}= [M]')
('3.5.1.2', 'p_{\\bm \\theta}')
('3.5.1.2', 'p_{\\bm \\theta}(y) \n\\coloneqq \\frac{\\exp(\\theta_{y})}{\\sum_{i \\in [M]} \\exp(\\theta_i)} \n= \\left[\\mathrm{softmax}({\\bm \\theta})\\right]_{y} \\in (0, 1),')
('3.5.1.2', '\\theta_{y} \\coloneqq f({\\bm x}, y, {\\bm w}) \\in \\mathbb{R}')
('3.5.1.2', 'f')
('3.5.1.2', '\\mathcal{Y}\\subseteq \\mathbb{R}^M')
('3.5.1.2', '|\\mathcal{Y}| \\gg M')
('3.5.1.2', "p_{\\bm \\theta}({\\bm y}) \\coloneqq\n\\frac{\\exp(\\langle \\phi({\\bm y}), {\\bm \\theta}\\rangle)}{\\sum_{{\\bm y}' \\in \\mathcal{Y}} \\exp(\\langle\n    \\phi({\\bm y}'), {\\bm \\theta}\\rangle)},")
('3.5.1.2', '{\\bm \\theta}= f({\\bm x}, {\\bm w}) \\in \\mathbb{R}^M')
('3.5.1.2', '\\rho')
('3.5.1.2', '\\mathcal{X}\\times \\mathcal{Y}')
('3.5.1.2', 'R({\\bm w}) \\coloneqq \\mathbb{E}_{(X,Y) \\sim \\rho}[L(f(X, {\\bm w}); Y)].')
('3.5.1.2', 'R({\\bm w})')
('3.5.1.2', '\\begin{aligned}\n\\nabla R({\\bm w}) \n&= \\mathbb{E}_{(X, Y) \\sim \\rho}[\\nabla_{\\bm w}L(f(X, {\\bm w}); Y)] \\\\\n&= \\mathbb{E}_{(X, Y) \\sim \\rho}[\\partial_2 f({\\bm x}, {\\bm w})^* \\nabla L(f(X, {\\bm w}); Y)].\n\\end{aligned}')
('3.5.1.2', '\\nabla R({\\bm w})')
('3.5.1.2', 'L({\\bm \\theta}; {\\bm y})')
('3.5.1.3', 'g({\\bm \\lambda})')
('3.5.1.3', 'g({\\bm \\lambda})')
('3.5.1.3', '{\\bm \\lambda}\\in \\mathbb{R}^Q')
('3.5.1.3', 'g({\\bm \\lambda})')
('3.5.1.3', '{\\bm \\lambda}\\in \\mathbb{R}^Q')
('3.5.1.3', '\\mathop{\\mathrm{arg\\,min}}_{{\\bm \\lambda}\\in \\mathbb{R}^Q} g({\\bm \\lambda})')
('3.5.1.3', '\\mathop{\\mathrm{arg\\,min}}_{{\\bm \\theta}\\in \\mathbb{R}^M} E({\\bm \\theta})')
('3.5.1.3', 'E({\\bm \\theta}) = \\mathbb{E}_{{\\bm \\lambda}\\sim p_{\\bm \\theta}}[g({\\bm \\lambda})]')
('3.5.1.3', 'p_{\\bm \\theta}')
('3.5.1.3', '{\\bm \\lambda}')
('3.5.1.3', 'g({\\bm \\lambda})')
('3.5.1.3', '\\nabla E({\\bm \\theta})')
('3.5.1.3', 'g')
('3.5.1.3', 'p_{\\bm \\theta}')
('3.5.1.3', '{\\bm \\lambda}')
('3.5.1.3', '{\\bm \\lambda}\\sim \\mathrm{Normal}({\\bm \\mu}, {\\bm \\Sigma})')
('3.5.1.3', '{\\bm \\theta}=\n({\\bm \\mu}, {\\bm \\Sigma})')
('3.5.1.3', '{\\bm \\theta}')
('3.5.1.3', 'E({\\bm \\theta})')
('3.5.1.3', '{\\bm \\lambda}')
('3.5.1.3', '\\mathop{\\mathrm{arg\\,max}}_{{\\bm \\lambda}\\in \\mathbb{R}^Q} p_{\\bm \\theta}({\\bm \\lambda})')
('3.5.1.3', '\\mathbb{E}_{{\\bm \\lambda}\\sim p_{\\bm \\theta}({\\bm \\lambda})}[{\\bm \\lambda}]')
('3.5.2.0', '\\nabla E({\\bm \\theta})')
('3.5.2.0', '\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y}) \n= \\frac{\\nabla_{\\bm \\theta}p_{\\bm \\theta}({\\bm y})}{p_{\\bm \\theta}({\\bm y})}\n\\Longleftrightarrow\n\\nabla_{\\bm \\theta}p_{\\bm \\theta}({\\bm y})\n= \np_{\\bm \\theta}({\\bm y})\n\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y}).')
('3.5.2.0', 'p_{\\bm \\theta}')
('3.5.2.0', '\\mathcal{Y}')
('3.5.2.0', '\\theta \\in \\Theta')
('3.5.2.0', 'E({\\bm \\theta}) \n\\coloneqq \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y)]\n= \\int_\\mathcal{Y}p_{\\bm \\theta}({\\bm y}) g({\\bm y}) d{\\bm y},')
('3.5.2.0', 'Y \\in \\mathcal{Y}\\subseteq \\mathbb{R}^M')
('3.5.2.0', 'g \\colon \\mathcal{Y}\\to \\mathbb{R}')
('3.5.2.0', '\\nabla E({\\bm \\theta})\n= \\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[g(Y) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)].')
('3.5.2.0', '\\begin{aligned}\n\\nabla E({\\bm \\theta})\n&= \\int_{\\mathcal{Y}} \\nabla_{\\bm \\theta}p_{\\bm \\theta}({\\bm y}) g({\\bm y}) d{\\bm y}\\\\\n&= \\int_{\\mathcal{Y}} p_{\\bm \\theta}({\\bm y}) g({\\bm y}) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y}) d{\\bm y}\\\\\n&= \\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[g(Y) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)].\n\\end{aligned}')
('3.5.2.0', '{\\bm \\theta}')
('3.5.2.0', '\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y})')
('3.5.2.0', 'p_{\\bm \\theta}')
('3.5.2.0', '\\nabla E({\\bm \\theta})')
('3.5.2.0', '\\nabla E({\\bm \\theta})\n\\approx\n\\widehat{{\\bm \\gamma}}_N({\\bm \\theta})\n\\coloneqq\n\\frac{1}{N} \\sum_{i=1}^N g(Y_i) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y_i),\n\\label{grad_est:eq:gamma_n_def}')
('3.5.2.0', 'Y_1, \\dots, Y_N')
('3.5.2.0', 'p_{\\bm \\theta}')
('3.5.2.0', 'g')
('3.5.2.0', 'g')
('3.5.2.0', 'g')
('3.5.2.0', '{\\bm y}= (y_1, \\dots, y_L)')
('3.5.2.0', 'p_{\\bm \\theta}({\\bm y}) \n\\coloneqq\np_{\\bm \\theta}(y_1) \np_{\\bm \\theta}(y_2| y_1) \n\\dots \np_{\\bm \\theta}(y_L | y_1, \\dots, y_{L-1}),')
('3.5.2.0', 'p_{\\bm \\theta}')
('3.5.2.0', 'p_{\\bm \\theta}')
('3.5.2.0', '\\begin{aligned}\n\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y}) \n& = \n\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(y_1) +\n\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(y_2| y_1) + \\dots \\\\\n& \\quad +\n\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(y_L | y_1, \\dots, y_{L-1}).\n\\end{aligned}')
('3.5.2.0', 'p_{\\bm \\theta}(y_j|y_1,\\dots,y_{j-1})')
('3.5.2.0', '\\nabla E({\\bm \\theta})')
('3.5.2.0', 'p_{\\bm \\theta}')
('3.5.2.0', '\\nabla_{\\bm \\theta}p_{\\bm \\theta}({\\bm y})')
('3.5.2.0', 'p_{\\bm \\theta}({\\bm y})')
('3.5.2.0', '{\\bm \\theta}\\in \\mathbb{R}^\\mathcal{Y}')
('3.5.2.0', '\\begin{aligned}\np_{\\bm \\theta}(y) \n\\coloneqq \\exp(\\theta_y /\\gamma - A({\\bm \\theta}))\n= \\exp(\\theta_y / \\gamma) / \\exp(A({\\bm \\theta}))\n\\end{aligned}')
('3.5.2.0', 'A({\\bm \\theta}) \\coloneqq \\log \\sum_{y \\in \\mathcal{Y}} \\exp(\\theta_y / \\gamma).')
('3.5.2.0', '\\theta_y = f({\\bm x}, y, {\\bm w})')
('3.5.2.0', 'f')
('3.5.2.0', '{\\bm x}')
('3.5.2.0', '{\\bm w}')
('3.5.2.0', '\\log p_{\\bm \\theta}(y)   \n= \\theta_y / \\gamma - A({\\bm \\theta}),')
('3.5.2.0', '\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(y)   \n= {\\bm e}_y / \\gamma - \\nabla A({\\bm \\theta}).')
('3.5.2.0', '\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(y)')
('3.5.2.0', '\\nabla A({\\bm \\theta})')
('3.5.2.0', '\\mathcal{Y}')
('3.5.2.0.0', '{\\bm \\theta}')
('3.5.2.0.0', 'g')
('3.5.2.0.0', '{\\bm \\theta}')
('3.5.2.0.0', 'E({\\bm \\theta}) \\coloneqq\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} [g(Y, {\\bm \\theta})].')
('3.5.2.0.0', '\\nabla E({\\bm \\theta}) =\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} [g(Y, {\\bm \\theta}) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n+\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} [\\nabla_{\\bm \\theta}g(Y, {\\bm \\theta})].')
('3.5.2.0.1', 'E({\\bm \\theta}) \\coloneqq \\mathbb{E}_{Y_1 \\sim p_{\\bm \\theta}, Y_2 \\sim q_{\\bm \\theta}}[g(Y_1,Y_2)].')
('3.5.2.0.1', '\\nabla E({\\bm \\theta}) \n= \\mathbb{E}_{Y_1 \\sim p_{\\bm \\theta}, Y_2 \\sim q_{\\bm \\theta}}[(\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y_1) +\n\\nabla \\log q_{\\bm \\theta}(Y_2)) g(Y_1,Y_2)],')
('3.5.2.0.1', '\\rho_{\\bm \\theta}\\coloneqq p_{\\bm \\theta}\\cdot q_{\\bm \\theta}')
('3.5.2.1.0', '\\widehat{{\\bm \\gamma}}_N')
('3.5.2.1.0', '\\nabla E({\\bm \\theta})\n= \n\\mathbb{E}[\\widehat{{\\bm \\gamma}}_N({\\bm \\theta})],')
('3.5.2.1.0', 'N')
('3.5.2.1.0', '\\begin{aligned}\n\\mathbb{V}[\\widehat{{\\bm \\gamma}}_N({\\bm \\theta})]\n&\\coloneqq \\mathbb{E}[\\|\\widehat{{\\bm \\gamma}}_N({\\bm \\theta}) - \\nabla E({\\bm \\theta})\\|_2^2] \\\\\n&= \\mathbb{E}[\\|\\widehat{{\\bm \\gamma}}_N({\\bm \\theta})\\|_2^2] - \\|\\nabla E({\\bm \\theta})\\|^2_2.\n\\end{aligned}')
('3.5.2.1.0', 'N \\to \\infty')
('3.5.2.1.1', 'p_{\\bm \\theta}')
('3.5.2.1.1', 'g')
('3.5.2.1.1', '\\beta')
('3.5.2.1.1', '\\nabla E({\\bm \\theta})\n= \\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[(g(Y) - \\beta) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)].')
('3.5.2.1.1', '\\nabla E({\\bm \\theta})')
('3.5.2.1.1', '\\begin{aligned}\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\n\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)\n] \n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\\left[\n\\frac{\\nabla_{\\bm \\theta}p_{\\bm \\theta}(Y)}{p_{\\bm \\theta}(Y)}\n\\right] \\\\\n&= \\nabla_{\\bm \\theta}\\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\\operatorname{\\mathbf 1}] \\\\\n&= \\nabla_{\\bm \\theta}\\operatorname{\\mathbf 1}\\\\\n&= {\\mathbf{0}},\n\\end{aligned}')
('3.5.2.1.1', 'p_{\\bm \\theta}')
('3.5.2.1.1', '\\beta')
('3.5.2.1.1', 'g')
('3.5.2.1.2', 'h \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('3.5.2.1.2', 'p_{\\bm \\theta}')
('3.5.2.1.2', 'H({\\bm \\theta}) \\coloneqq \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[h(Y)].')
('3.5.2.1.2', 'H({\\bm \\theta})')
('3.5.2.1.2', '\\nabla H({\\bm \\theta})')
('3.5.2.1.2', '\\gamma \\ge 0')
('3.5.2.1.2', '\\begin{aligned}\nE({\\bm \\theta})\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y)] \\\\\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y) - \\gamma (h(Y) - H({\\bm \\theta}))] \\\\\n&= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y) - \\gamma h(Y)] + \\gamma H({\\bm \\theta})\n\\end{aligned}')
('3.5.2.1.2', '\\begin{aligned}\n\\nabla E({\\bm \\theta})\n&= \\nabla_{\\bm \\theta}\\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y) - \\gamma h(Y)]\n+ \\gamma \\nabla H({\\bm \\theta}).\n\\end{aligned}')
('3.5.2.1.2', '\\nabla E({\\bm \\theta})\n= \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[(g(Y) - \\gamma h(Y)) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n+ \\gamma \\nabla H({\\bm \\theta}).')
('3.5.2.1.2', 'h')
('3.5.2.1.2', 'f')
('3.5.2.1.2', 'f')
('3.5.2.1.2', 'f')
('3.5.2.2', 'p_{\\bm \\theta}')
('3.5.2.2', '\\mathcal{Y}')
('3.5.2.2', '\\theta \\in \\Theta')
('3.5.2.2', 'E({\\bm \\theta}) \n\\coloneqq \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y)]\n= \\int_\\mathcal{Y}p_{\\bm \\theta}({\\bm y}) g({\\bm y}) d{\\bm y},')
('3.5.2.2', 'Y \\in \\mathcal{Y}')
('3.5.2.2', 'g \\colon \\mathcal{Y}\\to \\mathcal{G}')
('3.5.2.2', 'E')
('3.5.2.2', '{\\bm \\theta}\\in \\Theta')
('3.5.2.2', '{\\bm v}\\in \\Theta')
('3.5.2.2', '\\partial E({\\bm \\theta}) {\\bm v}\n= \n\\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[\\langle \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y), {\\bm v}\\rangle\ng(Y)] \\in \\mathcal{G}')
('3.5.2.2', 'E')
('3.5.2.2', '{\\bm \\theta}\\in \\Theta')
('3.5.2.2', '{\\bm u}\\in \\mathcal{G}')
('3.5.2.2', '\\partial E({\\bm \\theta})^* {\\bm u}\n  = \n  \\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y) \\langle{\\bm u}, g(Y) \\rangle] \\in \\Theta')
('3.5.2.2', 'E')
('3.5.2.2', '{\\bm \\theta}\\in \\Theta')
('3.5.2.2', '\\bm \\partial E({\\bm \\theta})\n  = \n  \\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[g(Y) \\otimes \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)],')
('3.5.2.2', '\\otimes')
('3.5.2.2', 'E')
('3.5.2.2', '{\\bm \\theta}\\in \\Theta')
('3.5.2.2', '{\\bm u}\\in \\Theta')
('3.5.2.2', '\\langle E({\\bm \\theta}), {\\bm u}\\rangle\n  = \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[\\langle g(Y), {\\bm u}\\rangle]')
('3.5.2.2', '\\langle g(Y), {\\bm u}\\rangle')
('3.5.2.2.0', '{\\bm \\theta}')
('3.5.2.2.0', 'E({\\bm \\theta}) \\coloneqq\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} [g(Y, {\\bm \\theta})],')
('3.5.2.2.0', '\\partial E({\\bm \\theta}) =\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[g(Y, {\\bm \\theta}) \\otimes \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n+\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} [\\partial_{\\bm \\theta}g(Y, {\\bm \\theta})].')
('3.5.2.3', 'g({\\bm y}, {\\bm \\theta}) = g({\\bm y}) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm \\theta})')
('3.5.2.3', 'E({\\bm \\theta}) \\coloneqq \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}[g(Y)]')
('3.5.2.3', '\\begin{aligned}\n\\nabla^2 E({\\bm \\theta})\n=&\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[g(Y) \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y) \\otimes \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n+ \\\\\n &\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[g(Y) \\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)].\n\\end{aligned}')
('3.5.2.3', '\\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y})\n= \\frac{1}{p_{\\bm \\theta}({\\bm y})} \\nabla^2_{\\bm \\theta}p_{\\bm \\theta}({\\bm y})\n- \\frac{1}{p_{\\bm \\theta}({\\bm y})^2} \\nabla_{\\bm \\theta}p_{\\bm \\theta}({\\bm y}) \\otimes \\nabla_{\\bm \\theta}\np_{\\bm \\theta}({\\bm y})')
('3.5.2.3', '\\nabla^2_{\\bm \\theta}p_{\\bm \\theta}({\\bm y})\n=\np_{\\bm \\theta}({\\bm y})\n\\left[\n\\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y})\n+ \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y}) \\otimes \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}({\\bm y})\n\\right].')
('3.5.2.3.0', 'g({\\bm y}) = 1')
('3.5.2.3.0', '\\int_\\mathcal{Y}p_{\\bm \\theta}({\\bm y}) d{\\bm y}= 1')
('3.5.2.3.0', '\\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n=\n{\\mathbf{0}},\n\\label{grad_est:eq:bartlett_first}')
('3.5.2.3.0', '\\label{grad_est:eq:bartlett_second}\n\\begin{aligned}\n&\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[\\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n+\n\\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[\\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y) \\otimes \\nabla_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)] \\\\\n=& \\mathbb{E}_{Y \\sim p_{\\bm \\theta}} \n[\\nabla^2_{\\bm \\theta}\\log p_{\\bm \\theta}(Y)]\n+\n\\mathrm{cov}[\\log p_{\\bm \\theta}(Y)] \\\\\n=& {\\mathbf{0}},\n\\end{aligned}')
('3.5.3', '{\\bm \\theta}')
('3.5.3', 'p_{\\bm \\theta}')
('3.5.3.0', 'E(\\mu, \\sigma)\n\\coloneqq \\mathbb{E}_{U \\sim \\mathrm{Normal}(\\mu, \\sigma^2)}[g(U)],')
('3.5.3.0', 'g \\colon \\mathbb{R}\\to \\mathbb{R}')
('3.5.3.0', 'Z \\sim \\mathrm{Normal}(0, 1)')
('3.5.3.0', 'U = \\mu + \\sigma Z')
('3.5.3.0', 'E(\\mu, \\sigma) \n= \\mathbb{E}_{Z \\sim \\mathrm{Normal}(0, 1)}[g(\\mu + \\sigma Z)].')
('3.5.3.0', '\\mu')
('3.5.3.0', '\\sigma')
('3.5.3.0', "\\begin{aligned}\n\\frac{\\partial}{\\partial \\mu} E(\\mu, \\sigma) \n&= \\mathbb{E}_{Z \\sim \\mathrm{Normal}(0, 1)}[g'(\\mu + \\sigma Z)] \\\\\n\\frac{\\partial}{\\partial \\sigma} E(\\mu, \\sigma) \n&= \\sigma \\cdot \\mathbb{E}_{Z \\sim \\mathrm{Normal}(0, 1)}[g'(\\mu + \\sigma Z)].\n\\end{aligned}")
('3.5.3.0', 'U \\coloneqq \\mu + \\sigma Z\n\\label{grad_est:eq:loc_scale_transform}')
('3.5.3.0', '\\mu')
('3.5.3.0', '\\sigma > 0')
('3.5.3.0', 'U')
('3.5.3.0', 'Z')
('3.5.3.0', 't')
('3.5.3.0', 'Z')
('3.5.3.0', 'U')
('3.5.3.0', 'F_Z(z) \\coloneqq \\mathbb{P}(Z \\le z)')
('3.5.3.0', "f_Z(z) \\coloneqq F_Z'(z)")
('3.5.3.0', 'U \\coloneqq \\mu + \\sigma Z')
('3.5.3.0', '\\begin{aligned}\n    F_Z(z) &= F_U(\\mu + \\sigma z) \n    \\iff\n    F_U(u) = F_Z\\left(\\frac{u - \\mu}{\\sigma}\\right) \\\\\n    f_Z(z) &= \\sigma f_U(\\mu + \\sigma z) \n    \\iff\n    f_U(u) = \\frac{1}{\\sigma} f_Z\\left(\\frac{u - \\mu}{\\sigma}\\right).\n\\end{aligned}')
('3.5.3.0', '\\begin{aligned}\nF_Z(z) \n&= \\mathbb{P}(Z \\le z) \\\\\n&= \\mathbb{P}\\left(\\frac{U-\\mu}{\\sigma} \\le z\\right) \\\\\n&= \\mathbb{P}(U \\le \\mu + \\sigma z) \\\\\n&= F_U(\\mu + \\sigma z)\n\\end{aligned}')
('3.5.3.0', 'f_Z(z)')
('3.5.3.0', 'F_Z(z)')
('3.5.3.1', 'U \\coloneqq T(Z, {\\bm \\theta}),')
('3.5.3.1', 'T \\colon \\mathbb{R}^M \\times \\mathbb{R}^Q \\to \\mathbb{R}^M')
('3.5.3.1', '\\mu')
('3.5.3.1', '\\sigma')
('3.5.3.1', '{\\bm \\theta}\\coloneqq (\\mu, \\sigma)')
('3.5.3.1', 'U \n= T(Z, {\\bm \\theta}) \n= \\mu + \\sigma Z.')
('3.5.3.1', 'T')
('3.5.3.1', 'E({\\bm \\theta}) \\coloneqq \\mathbb{E}_{U \\sim p_{\\bm \\theta}}[g(U)],')
('3.5.3.1', 'U \\in \\mathcal{U}\\subseteq \\mathbb{R}^M')
('3.5.3.1', 'g \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('3.5.3.1', 'T \\colon \\mathbb{R}^M \\times \\mathbb{R}^Q \\to \\mathbb{R}^M')
('3.5.3.1', 'Z \\sim p')
('3.5.3.1', 'p')
('3.5.3.1', '{\\bm \\theta}')
('3.5.3.1', 'U \\coloneqq T(Z, {\\bm \\theta})')
('3.5.3.1', 'U \\sim p_{\\bm \\theta}')
('3.5.3.1', 'E({\\bm \\theta}) \n= \\mathbb{E}_{Z \\sim p}[h(Z, {\\bm \\theta})]\n= \\mathbb{E}_{Z \\sim p}[g(T(Z, {\\bm \\theta}))],')
('3.5.3.1', 'h({\\bm z}, {\\bm \\theta}) \\coloneqq g(T({\\bm z}, {\\bm \\theta}))')
('3.5.3.1', '\\begin{aligned}\n\\nabla E({\\bm \\theta}) \n&= \\mathbb{E}_{Z \\sim p}[\\nabla_2 h(Z, {\\bm \\theta})] \\\\\n&= \\mathbb{E}_{Z \\sim p}[\\partial_2 T(Z, {\\bm \\theta})^* \\nabla g(T(Z, {\\bm \\theta}))].\n\\end{aligned}')
('3.5.3.1', '\\nabla E({\\bm \\theta})')
('3.5.3.1', 'g')
('3.5.3.1', 'g')
('3.5.3.1', '\\mathbb{R}^M')
('3.5.3.1', '\\mathcal{U}')
('3.5.3.1', 'Z')
('3.5.3.1', '{\\bm w}')
('3.5.3.1', 'X \\coloneqq T(Z, {\\bm w})')
('3.5.3.1', 'X \\sim \\mathrm{Normal}(\\mu, \\sigma^2)')
('3.5.3.1', '\\exp(X) \\sim \\mathrm{Lognormal}(\\mu, \\sigma^2)')
('3.5.3.1', 'U \\sim \\mathrm{Uniform}(0,1)')
('3.5.3.1', '-\\log(U) / \\lambda \\sim \\mathrm{Exponential}(\\lambda)')
('3.5.3.1', 'X_1,\\dots,X_N \\sim \\mathrm{Exponential}(\\lambda)')
('3.5.3.1', '\\sum_{i=1}^N X_i \\sim \\mathrm{Gamma}(N, \\lambda)')
('3.5.3.1', 'X_i \\sim \\mathrm{Gamma}(\\alpha_i,\\theta)')
('3.5.3.1', 'i \\in [K]')
('3.5.3.1', '\\left(\n\\frac{X_1}{\\sum_{i=1}^K X_i}, \n\\dots, \n\\frac{X_K}{\\sum_{i=1}^K X_i}\n\\right) \n\\sim \n\\mathrm{Dirichlet}(\\alpha_1,\\dots,\\alpha_K)')
('3.5.3.2', 'Y')
('3.5.3.2', 'F_Y \\colon \\mathbb{R}\\to [0,1]')
('3.5.3.2', 'F_Y(y) \\coloneqq \\mathbb{P}(Y \\le y).')
('3.5.3.2', 'Q_Y \\colon [0,1] \\to \\mathbb{R}')
('3.5.3.2', 'Q_Y(\\pi) = y')
('3.5.3.2', '\\pi = F_Y(y)')
('3.5.3.2', 'F_Y')
('3.5.3.2', 'Q_Y')
('3.5.3.2', 'Q_Y(\\pi) = F^{-1}_Y(\\pi).')
('3.5.3.2', 'Q_Y(\\pi) \\coloneqq \\inf \\{y \\in \\mathbb{R}\\colon \\pi \\le F_Y(y) \\}.')
('3.5.3.2', 'Q_Y(\\pi)')
('3.5.3.2', 'p')
('3.5.3.2', 'p')
('3.5.3.2', 'Y \\sim p')
('3.5.3.2', 'p')
('3.5.3.2', 'Q_Y')
('3.5.3.2', 'U \\sim \\text{Uniform}(0,1)')
('3.5.3.2', 'Q_Y(U) \\sim p')
('3.5.3.2', '\\pi \\leq F_Y(t)')
('3.5.3.2', 'Q_Y')
('3.5.3.2', 'Q_Y(\\pi) \\leq t')
('3.5.3.2', '\\pi\n  \\geq F_Y(t)')
('3.5.3.2', 'Q_Y')
('3.5.3.2', 'F_Y(Q_Y(\\pi)) \\geq \\pi')
('3.5.3.2', 'F_Y(Q_Y(\\pi)) \\geq F_Y(t)')
('3.5.3.2', 'Q_Y(\\pi) \\geq t')
('3.5.3.2', 'Q_Y(\\pi) \\leq t \\iff \\pi \\leq F_Y(t)')
('3.5.3.2', '\\begin{aligned}\n    \\mathbb{P}(Q_Y(U)\\leq t) & = \\mathbb{P}(U \\leq F_Y(t)) \\\\\n    & = F_Y(t).\n  \n\\end{aligned}')
('3.5.3.2', 'Q_Y(U)')
('3.5.3.2', 'Y')
('3.5.3.2', 'Y \\sim p_{\\bm \\theta}')
('3.5.3.2', 'p_{\\bm \\theta}')
('3.5.3.2', '{\\bm \\theta}')
('3.5.3.2', 'Q_Y(\\pi, {\\bm \\theta})')
('3.5.3.2', 'E({\\bm \\theta})\n= \\mathbb{E}_{Y \\sim {\\bm p}_{\\bm \\theta}}[g(Y)]\n= \\mathbb{E}_{\\pi \\sim \\text{Uniform}(0,1)}[g(Q_Y(\\pi, {\\bm \\theta}))]')
('3.5.3.2', '\\nabla E({\\bm \\theta})\n= \\mathbb{E}_{\\pi \\sim \\text{Uniform}(0,1)}[\n  \\partial_2 Q_Y(\\pi, {\\bm \\theta})^* \\nabla g(Q_Y(\\pi, {\\bm \\theta}))\n  ].')
('3.5.3.2', 'Y \\sim \\text{Exponential}(\\lambda)')
('3.5.3.2', 'Y')
('3.5.3.2', '\\pi = F_Y(y) = 1 - \\exp(-\\lambda y)')
('3.5.3.2', 'y \\ge 0')
('3.5.3.2', 'Q_Y(\\pi, \\lambda) = -\\frac{\\log(1-\\pi)}{\\lambda}')
('3.5.3.2', 'Y \\sim \\text{Normal}(\\mu, \\sigma^2)')
('3.5.3.2', 'F_Y(y) = \\frac{1}{2}\\left[1 + \\text{erf}\\left(\\frac{y -\n\\mu}{\\sigma\\sqrt{2}}\\right)\\right]')
('3.5.3.2', 'Q_Y(\\pi, {\\bm \\theta}) = \\mu + \\sigma \\sqrt{2} \\cdot \\mathrm{erf}^{-1}(2\\pi - 1)')
('3.5.3.2', '{\\bm \\theta}= (\\mu, \\sigma)')
('3.5.3.2', '\\mathrm{erf}')
('3.5.3.3.0', 'Z \\sim p')
('3.5.3.3.0', 'p')
('3.5.3.3.0', '\\mathcal{Z}')
('3.5.3.3.0', 'T \\colon \\mathcal{Z}\\to \\mathcal{U}')
('3.5.3.3.0', 'p')
('3.5.3.3.0', 'T')
('3.5.3.3.0', 'q')
('3.5.3.3.0', 'U \\coloneqq T(Z) \\in \\mathcal{U}')
('3.5.3.3.0', 'U \\sim q')
('3.5.3.3.0', 'T')
('3.5.3.3.0', 'T')
('3.5.3.3.0', 'p')
('3.5.3.3.0', 'T = Q')
('3.5.3.3.0', 'Q')
('3.5.3.3.0', 'T =\n\\mathrm{argmax}')
('3.5.3.3.0', 'T = -\\log(-\\log(\\cdot))')
('3.5.3.3.0', 'X = T(Z, {\\bm w})')
('3.5.3.3.0', 'q')
('3.5.3.3.0', 'q')
('3.5.3.3.0', 'p')
('3.5.3.3.0', '\\begin{aligned}\nU \\sim q\n\\iff\nZ \\sim p, U &\\coloneqq T(Z).\n\\end{aligned}')
('3.5.3.3.0', 'p')
('3.5.3.3.0', 'p_Z')
('3.5.3.3.0', 'f')
('3.5.3.3.0', 'q')
('3.5.3.3.0', '\\begin{aligned}\n\\mathbb{E}_{U \\sim q}[f(U)] \n= \\mathbb{E}_{Z \\sim p}[f(T(Z))]\n= \\int_{\\mathcal{Z}} f(T({\\bm z})) p_Z({\\bm z}) d{\\bm z},\n\\end{aligned}')
('3.5.3.3.0', 'q')
('3.5.3.3.1', '\\mathcal{M}(\\mathcal{Z})')
('3.5.3.3.1', '\\mathcal{Z}')
('3.5.3.3.1', '\\alpha \\in \\mathcal{M}(\\mathcal{Z})')
('3.5.3.3.1', 'd\\alpha({\\bm z})\n\\coloneqq p_Z({\\bm z}) d{\\bm z}')
('3.5.3.3.1', 'f')
('3.5.3.3.1', '\\int_\\mathcal{Z}f({\\bm z}) d\\alpha({\\bm z}) = \\int_\\mathcal{Z}f({\\bm z}) p_Z({\\bm z}) d{\\bm z}.')
('3.5.3.3.1', '\\alpha')
('3.5.3.3.1', '\\alpha(\\mathcal{Z}) = \\int_\\mathcal{Z}d\\alpha({\\bm z}) = \\int_\\mathcal{Z}p_Z({\\bm z}) d{\\bm z}= 1')
('3.5.3.3.1', 'T \\colon \\mathcal{Z}\\to \\mathcal{U}')
('3.5.3.3.1', '\\alpha \\in \\mathcal{M}(\\mathcal{Z})')
('3.5.3.3.1', '\\beta = T_\\sharp \\alpha \\in \\mathcal{M}(\\mathcal{U})')
('3.5.3.3.1', 'f \\in \\mathcal{C}(\\mathcal{U})')
('3.5.3.3.1', '\\int_\\mathcal{U}f({\\bm u}) d\\beta({\\bm u}) = \\int_\\mathcal{Z}f(T({\\bm z})) d\\alpha({\\bm z}).')
('3.5.3.3.1', '\\mathcal{A}\\subset \\mathcal{U}')
('3.5.3.3.1', '\\beta(\\mathcal{A}) = \\alpha(\\{{\\bm z}\\in \\mathcal{Z}\\colon T({\\bm z}) \\in \\mathcal{A}\\}) \n= \\alpha(T^{-1}(\\mathcal{A})),')
('3.5.3.3.1', 'T^{-1}(\\mathcal{A}) = \\{z \\in \\mathcal{Z}: T({\\bm z})\\in \\mathcal{A}\\}')
('3.5.3.3.1', '\\alpha')
('3.5.3.3.1', 'T_\\sharp \\alpha')
('3.5.3.4', 'U')
('3.5.3.4', 'U \\coloneqq T(Z)')
('3.5.3.4', 'Z')
('3.5.3.4', 'U')
('3.5.3.4', 'T')
('3.5.3.4', 'Z = T^{-1}(U)')
('3.5.3.4', '\\mathcal{A}\\subseteq \\mathcal{U}')
('3.5.3.4', '\\begin{aligned}\n\\mathbb{P}(U \\in \\mathcal{A}) \n= \\mathbb{P}(Z \\in T^{-1}(\\mathcal{A})) \n= \\int_{T^{-1}(\\mathcal{A})} p_Z({\\bm z}) d{\\bm z}.\n\\end{aligned}')
('3.5.3.4', 'T^{-1}')
('3.5.3.4', 'Z \\sim p')
('3.5.3.4', 'p')
('3.5.3.4', '\\mathcal{Z}')
('3.5.3.4', 'p_Z')
('3.5.3.4', 'T \\colon \\mathcal{Z}\\to \\mathcal{U}')
('3.5.3.4', 'p')
('3.5.3.4', 'T')
('3.5.3.4', 'q')
('3.5.3.4', 'U \\coloneqq T(Z) \\sim q')
('3.5.3.4', 'q_U({\\bm u}) = |\\det(\\partial T^{-1}({\\bm u}))| p_Z(T^{-1}({\\bm u})),')
('3.5.3.4', '\\partial T^{-1}({\\bm u})')
('3.5.3.4', 'T^{-1} \\colon \\mathcal{U}\\to \\mathcal{Z}')
('3.5.3.4', '\\begin{aligned}\n\\mathbb{P}(U \\in \\mathcal{A})  \n&= \\int_{\\mathcal{A}} p_U({\\bm u}) d{\\bm u}\\\\\n&= \\int_{\\mathcal{A}} |\\det(\\partial T^{-1}({\\bm u}))| p_Z(T^{-1}({\\bm u})) d{\\bm u}.\n\\end{aligned}')
('3.5.3.4', '\\partial T^{-1}({\\bm u})\n= (\\partial T(T^{-1}({\\bm u})))^{-1},')
('3.5.3.4', 'T({\\bm z})')
('3.5.3.4', '\\partial T({\\bm z})')
('3.5.3.4', 'T')
('3.5.3.4', 'T^{-1}')
('3.5.3.4', '\\partial T^{-1}')
('3.5.4.0.0', '\\mathcal{G}= (\\mathcal{V}, \\mathcal{E})')
('3.5.4.0.0', '\\mathcal{V}= \\mathcal{V}_f \\cup \\mathcal{V}_p')
('3.5.4.0.0', '\\mathcal{V}_f')
('3.5.4.0.0', '\\mathcal{V}_p')
('3.5.4.0.0', '\\mathcal{V}=\\{0, 1, \\ldots, K\\}')
('3.5.4.0.0', '0')
('3.5.4.0.0', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.5.4.0.0', 'K')
('3.5.4.0.0', 'S_K \\in \\mathcal{S}_K')
('3.5.4.0.0', 'k \\in \\{1,\\dots,K\\}')
('3.5.4.0.0', 'k \\in \\mathcal{V}_f')
('3.5.4.0.0', 'f_k')
('3.5.4.0.0', 'k \\in \\mathcal{V}_p')
('3.5.4.0.0', 'p_k')
('3.5.4.0.0', '\\mathcal{E}')
('3.5.4.0.0', 'k')
('3.5.4.0.0', '{\\operatorname{pa}}(k)')
('3.5.4.0.1', '{\\bm s}_k')
('3.5.4.0.1', 'S_k')
('3.5.4.0.1', 'p_k')
('3.5.4.0.1', 'f_k')
('3.5.4.0.1', '{\\operatorname{pa}}(k)')
('3.5.4.0.1', '{\\operatorname{pa}}(k)= {\\operatorname{determ}}(k) \\cup {\\operatorname{random}}(k)')
('3.5.4.0.1', '{\\operatorname{determ}}(k) \\coloneqq \\{i_1, \\ldots, i_{p_k}\\}')
('3.5.4.0.1', '{\\operatorname{random}}(k) \\coloneqq \\{j_1, \\ldots, j_{q_k}\\}')
('3.5.4.0.1', '{\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}}')
('3.5.4.0.1', 'S_{j_1}, \\ldots, S_{j_{q_k}}')
('3.5.4.0.1', 'k')
('3.5.4.0.2', '0, 1, \\dots, K')
('3.5.4.0.2', '{\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}}')
('3.5.4.0.2', 'S_{j_1}, \\ldots, S_{j_{q_k}}')
('3.5.4.0.2', 'k \\in \\{1, \\dots, K\\}')
('3.5.4.0.2', 'k \\in \\mathcal{V}_p')
('3.5.4.0.2', '\\begin{aligned}\n&S_k\n\\sim p_k(\\cdot \\mid {\\bm s}_{{\\operatorname{determ}}(k)}, S_{{\\operatorname{random}}(k)}) \\\\\n\\iff\n&S_k\n\\sim p_k(\\cdot \\mid {\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}}, S_{j_1}, \\ldots, S_{j_{q_k}})\n\\end{aligned}')
('3.5.4.0.2', 'p_k')
('3.5.4.0.2', 'S_k')
('3.5.4.0.2', 'S_k')
('3.5.4.0.2', 'S_k \\mid {\\bm s}_{{\\operatorname{determ}}(k)}, S_{{\\operatorname{random}}(k)}\n\\sim p_k(\\cdot \\mid {\\bm s}_{{\\operatorname{determ}}(k)}, S_{{\\operatorname{random}}(k)} )')
('3.5.4.0.2', 'k \\in \\mathcal{V}_p')
('3.5.4.0.2', '{\\operatorname{pa}}(k) = \\emptyset')
('3.5.4.0.2', 'k \\in \\mathcal{V}_f')
('3.5.4.0.2', '\\begin{aligned}\nS_k \n&\\coloneqq f_k({\\bm s}_{{\\operatorname{determ}}(k)}, S_{{\\operatorname{random}}(k)}) \\\\\n&\\coloneqq f_k({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}}, S_{j_1}, \\ldots, S_{j_{q_k}})\n\\end{aligned}')
('3.5.4.0.2', 'q_k = |{\\operatorname{random}}(k)| = 0')
('3.5.4.0.2', '\\begin{aligned}\n{\\bm s}_k \n&\\coloneqq f_k({\\bm s}_{{\\operatorname{determ}}(k)}) \\\\\n&\\coloneqq f_k({\\bm s}_{i_1}, \\ldots, {\\bm s}_{i_{p_k}}).\n\\end{aligned}')
('3.5.4.0.2', 'p_k')
('3.5.4.0.2', 'k \\in \\mathcal{V}_p')
('3.5.4.0.2', 'S_k \\in \\mathcal{S}_k')
('3.5.4.0.2', 'k \\in \\mathcal{V}_f')
('3.5.4.0.2', 'f_k')
('3.5.4.0.2', 'S_k \\in \\mathcal{S}_k')
('3.5.4.0.2', 'k')
('3.5.4.0.2', 'k')
('3.5.4.0.2', 'f_k')
('3.5.4.0.2', '{\\bm s}_k \\in \\mathcal{S}_k')
('3.5.4.0.2', 'S_K = f({\\bm s}_0) \\in \\mathcal{S}_K')
('3.5.4.0.2', 'S_K')
('3.5.4.0.2', 'S_k')
('3.5.4.0.2', '1,\\dots,K')
('3.5.4.0.2', 'k')
('3.5.4.0.2', 'f_k')
('3.5.4.0.2', 'p_k')
('3.5.4.0.2', '{\\bm s}_0 \\in \\mathcal{S}_0')
('3.5.4.0.2', '{\\operatorname{pa}}(k) = {\\operatorname{determ}}(k) \\cup {\\operatorname{random}}(k)')
('3.5.4.0.2', 'S_k \\sim p_k(\\cdot|{\\bm s}_{{\\operatorname{determ}}(k)},S_{{\\operatorname{random}}(k)})')
('3.5.4.0.2', 'S_k \\coloneqq \n          f_k({\\bm s}_{{\\operatorname{determ}}(k)}, S_{{\\operatorname{random}}(k)})')
('3.5.4.0.2', '{\\bm s}_k \\coloneqq f_k({\\bm s}_{{\\operatorname{determ}}(k)})')
('3.5.4.0.2', 'f({\\bm s}_0) \\coloneqq S_K \\in \\mathcal{S}_K')
('3.5.4.1', '\\begin{aligned}\n      S_1 &\\sim p_1(\\cdot \\mid {\\bm s}_0) \\\\\n      S_2 &\\coloneqq f_2(S_1) \\\\\n  E({\\bm s}_0) &\\coloneqq \\mathbb{E}[S_2] \\\\\n  \\nabla E({\\bm s}_0) &= \\mathbb{E}_{S_1}[f_2(S_1) \\nabla_{{\\bm s}_0} \\log p_1(S_1 \\mid {\\bm s}_0)]\n  \n\\end{aligned}')
('3.5.4.1', '\\begin{aligned}\n      S_1 & \\sim p_1 \\\\\n      S_2 &\\coloneqq f_2(S_1, {\\bm s}_0) \\\\\n      E({\\bm s}_0) &\\coloneqq \\mathbb{E}[S_2] \\\\\n      \\nabla E({\\bm s}_0) &= \\mathbb{E}_{S_1}\\left[ \\nabla_{{\\bm s}_0} f_2(S_1, {\\bm s}_0) \\right]\n  \n\\end{aligned}')
('3.5.4.1', '\\begin{aligned}\n      {\\bm s}_1 &\\coloneqq f_1({\\bm s}_0) \\\\\n      S_2 & \\sim p_2(\\cdot \\mid {\\bm s}_1) \\\\\n      S_3 &\\coloneqq f_3(S_2) \\\\\n      E({\\bm s}_0) &\\coloneqq \\mathbb{E}[S_3] \\\\\n      \\nabla E({\\bm s}_0)\n        &= \\partial f({\\bm s}_0)^* \\mathbb{E}_{S_2}[f_3(S_2) \\nabla_{{\\bm s}_1} \\log p_2(S_2\n        \\mid {\\bm s}_1)]\n  \n\\end{aligned}')
('3.5.4.1', '\\begin{aligned}\n      {\\bm s}_1 &\\coloneqq f_1({\\bm s}_0) \\\\\n      {\\bm s}_2 &\\coloneqq f_2({\\bm s}_0) \\\\\n      S_3 & \\sim p_3(\\cdot \\mid {\\bm s}_1) \\\\\n      S_4 &\\sim p_4(\\cdot \\mid {\\bm s}_2, S_3) \\\\\n      S_5 &\\coloneqq f_5(S_4) \\\\\n      E({\\bm s}_0) &\\coloneqq \\mathbb{E}[S_5]\n      = \\mathbb{E}_{S_3} \\left[ \\mathbb{E}_{S_4}[f_5(S_4)]\\right] \\\\ \n      \\nabla E({\\bm s}_0) &=\n      \\mathbb{E}_{S_3} \\left[\\partial f_1({\\bm s}_0)^*\\nabla_{{\\bm s}_1} \\log p(S_3 \\mid {\\bm s}_1)\n      \\mathbb{E}_{S_4}[f_5(S_4)]\\right] \\\\\n      &\\quad  + \\mathbb{E}_{S_3}\n      \\left[\\mathbb{E}_{S_4}\\left[\\partial f_2({\\bm s}_0)^*\\nabla_{{\\bm s}_2} \\log\n      p_4(S_4|{\\bm s}_2,S_3)f_5(S_4) \\right]\\right]\n  \n\\end{aligned}')
('3.5.4.2', 'S_K \\coloneqq f({\\bm s}_0).')
('3.5.4.2', 'p(\\cdot|{\\bm s}_0)')
('3.5.4.2', 'S_K \\sim p(\\cdot|{\\bm s}_0)')
('3.5.4.2', 'p(\\cdot|{\\bm s}_0)')
('3.5.4.2', 'E({\\bm s}_0) \\coloneqq \\mathbb{E}[S_K] = \\mathbb{E}[f({\\bm s}_0)] \\in \\mathop{\\mathrm{conv}}(\\mathcal{S}_K),')
('3.5.4.2', 'S_K \\sim p(\\cdot|{\\bm s}_0)')
('3.5.4.2', 'S_k')
('3.5.4.2', 'S_k\n  \\sim p_k(\\cdot|{\\bm s}_{{\\operatorname{determ}}(k)}, S_{{\\operatorname{random}}(k)}),')
('3.5.4.2', 'k \\in \\mathcal{V}_p')
('3.5.4.2', 'E({\\bm s}_0)')
('3.5.4.2', 'E({\\bm s}_0)')
('3.5.4.2.0', 'p_k')
('3.5.4.2.0', 'f_k')
('3.5.4.2.0', 'f_k')
('3.5.4.3', 'S_k')
('3.5.4.3', 'k')
('3.5.4.3', 'S_K')
('3.5.4.3', 'f_{k+1}')
('3.5.4.3', '\\mathop{\\mathrm{conv}}(\\mathcal{S}_k)')
('3.5.4.3', 'S_k \\in\n\\mathcal{S}_k')
('3.5.4.3', 'k \\in \\{1, \\dots, K\\}')
('3.5.4.3', '\\mathbb{E}[S_k] \\in\n\\mathop{\\mathrm{conv}}(\\mathcal{S}_k)')
('3.5.4.3', '\\mathbb{E}[S_k]')
('3.5.4.3', '\\mathop{\\mathrm{conv}}(\\mathcal{S}_k)')
('3.5.4.3', '\\mathcal{S}_k')
('3.5.4.3', 'f_{k+1}')
('3.5.4.3', '\\mathbb{E}[S_k]')
('3.5.4.3', '\\mathop{\\mathrm{conv}}(\\mathcal{S}_k)')
('3.5.5.0.0', '{\\bm s}_0 \\coloneqq {\\bm x}')
('3.5.5.0.0', 'k \\in \\{1, \\dots,K\\}')
('3.5.5.0.0', '{\\bm s}_k \\coloneqq {\\bm s}_{k-1} + h_k({\\bm s}_{k-1}, {\\bm w}_k).')
('3.5.5.0.0', '{\\bm s}_k - {\\bm s}_{k-1} = h_k({\\bm s}_k, {\\bm w}_k).')
('3.5.5.0.0', '{\\bm s}(t)')
('3.5.5.0.0', 'h(t, {\\bm s}, {\\bm w})')
('3.5.5.0.0', '{\\bm w}')
('3.5.5.0.0', '{\\bm x}')
('3.5.5.0.0', '{\\bm s}(t)')
('3.5.5.0.0', "\\begin{aligned}\n  {\\bm s}(0) &= {\\bm x}\\nonumber \\\\\n  {\\bm s}'(t) &= h(t, {\\bm s}(t), {\\bm w}) \\quad t \\in [0, T] \\label{ode:eq:ode}\n\\end{aligned}")
('3.5.5.0.0', "{\\bm s}'(t)")
('3.5.5.0.0', '{\\bm s}')
('3.5.5.0.0', 'T')
('3.5.5.0.0', 'f({\\bm x}, {\\bm w}) \\coloneqq {\\bm s}(T)')
('3.5.5.0.0', '\\label{ode:eq:ode_integral_form}\n  f({\\bm x}, {\\bm w}) = {\\bm s}(T) = {\\bm x}+ \\int_0^T h(t, {\\bm s}(t), {\\bm w})dt.')
('3.5.5.0.1', '{\\bm s}(t)')
('3.5.5.0.1', 'h: [0, T] \\times \\mathcal{S}\\rightarrow \\mathcal{S}')
('3.5.5.0.1', '{\\bm s}: [0, T] \\rightarrow \\mathcal{S}')
('3.5.5.0.1', "\\begin{aligned}\n      {\\bm s}(0) &= {\\bm s}_0 \\\\ \n      {\\bm s}'(t) &= h(t, {\\bm s}(t)) \\quad t \\in [0, T],\n  \n\\end{aligned}")
('3.5.5.0.1', '{\\bm s}_0 \\in \\mathcal{S}')
('3.5.5.0.1', 'h(t, {\\bm s}) ={\\bm A}{\\bm s}')
('3.5.5.0.1', '{\\bm s}_t = \\exp(t{\\bm A})({\\bm s}_0),')
('3.5.5.0.1', '\\exp({\\bm A})')
('3.5.5.0.1', '{\\bm s}(T)')
('3.5.5.0.1', '{\\bm A}')
('3.5.5.0.2', '{\\bm s}_k')
('3.5.5.0.2', '{\\bm s}(t)')
('3.5.5.0.2', 't_k')
('3.5.5.0.2', 't_{k-1}')
('3.5.5.0.2', 't_k')
('3.5.5.0.2', '\\begin{aligned}\n  {\\bm s}(t_{k-1}) - {\\bm s}(t_k) \n  & = \\int_{t_{k-1}}^{t_k} h(t, {\\bm s}(t), {\\bm w})dt \\\\\n  & \\approx \\delta_k h(t_{k-1}, {\\bm s}(t_{k-1}), {\\bm w}),\n\\end{aligned}')
('3.5.5.0.2', '\\delta_k \\coloneqq t_k - t_{k-1}.')
('3.5.5.0.2', '{\\bm s}_0 = {\\bm x}')
('3.5.5.0.2', 'k \\in \\{1, \\ldots, K\\}')
('3.5.5.0.2', '{\\bm s}_k \\coloneqq {\\bm s}_{k-1} + \\delta_k h(t_{k-1}, {\\bm s}_{k-1}, {\\bm w}).')
('3.5.5.0.2', '\\delta_k h(t_{k-1}, {\\bm s}_{k-1}, {\\bm w})')
('3.5.5.0.2', 'h_k({\\bm s}_{k-1}, {\\bm w}_k)')
('3.5.5.0.2', '\\delta_k = \\delta')
('3.5.5.0.2', 'K = \\lceil\nT/\\delta\\rceil')
('3.5.5.0.2', 'k')
('3.5.5.0.2', '\\|{\\bm s}_k - {\\bm s}(k \\delta)\\| = O(\\delta^k)')
('3.5.5.0.2', '\\delta\\rightarrow 0')
('3.5.5.0.2', 'k\\rightarrow +\\infty')
('3.5.5.0.2', 'k')
('3.5.5.0.2', '\\varepsilon')
('3.5.5.0.2', '\\|{\\bm s}_k - {\\bm s}(k \\delta)\\| = O(\\delta^k)')
('3.5.5.0.2', "s'(t) =\n\\lambda s(t)")
('3.5.5.0.2', '\\lambda \\in \\mathbb{C}')
('3.5.5.0.2', 't\\rightarrow\n+\\infty')
('3.5.5.1', '{\\bm w}')
('3.5.5.1', 'h(t, {\\bm s}, {\\bm w})')
('3.5.5.1', '{\\bm w}\\in \\mathcal{W}')
('3.5.5.1', 'L')
('3.5.5.1', '\\label{ode:eq:optim_through_ode}\n  \\min_{{\\bm w}\\in \\mathcal{W}} L(f({\\bm x}, {\\bm w}), {\\bm y}),')
('3.5.5.1', 'f({\\bm x}, {\\bm w}) \\coloneqq {\\bm s}(T) = {\\bm x}+ \\int_0^T h(t, {\\bm s}(t), {\\bm w})dt.')
('3.5.5.1', '\\ell')
('3.5.5.1', 'f')
('3.5.5.1', 'h: [0, T] \\times \\mathcal{S}\\times \\mathcal{W}\\rightarrow \\mathcal{S}')
('3.5.5.1', '\\partial_3 h(t, {\\bm s}, {\\bm w})')
('3.5.5.1', 't, {\\bm s}, {\\bm w}')
('3.5.5.1', '{\\bm s}:\\mathcal{S}\\rightarrow \\mathcal{S}')
('3.5.5.1', "\\begin{aligned}\n      {\\bm s}(0) &= {\\bm x}\\\\\n      {\\bm s}'(t) &= h(t, {\\bm s}(t), {\\bm w}) \\quad  t \\in [0, T],\n  \n\\end{aligned}")
('3.5.5.1', 'f({\\bm x}, {\\bm w}) = {\\bm s}(T)')
('3.5.5.1', 'T')
('3.5.5.1', 'f')
('3.5.5.1', '{\\bm u}\\in\n  \\mathcal{S}')
('3.5.5.1', '{\\bm u}')
('3.5.5.1', '\\partial f({\\bm x}, {\\bm w})^*{\\bm u}= ({\\bm r}(0), {\\bm g})')
('3.5.5.1', '{\\bm g}= \\int_{0}^{T} \\partial_3 h(t, {\\bm s}(t), {\\bm w})^* {\\bm r}(t) dt')
('3.5.5.1', '{\\bm r}')
('3.5.5.1', "\\begin{aligned}\n    {\\bm r}'(t) & = - \\partial_2 h(t, {\\bm s}(t), {\\bm w})^* {\\bm r}(t) \\\\\n    {\\bm r}(T) &= {\\bm u}\\nonumber.\n  \n\\end{aligned}")
('3.5.5.1', '\\nabla (L \\circ f)({\\bm x}, {\\bm w})')
('3.5.5.1', 'L: \\mathcal{S}\\rightarrow \\mathbb{R}')
('3.5.5.1', '{\\bm r}(T) = \\nabla L({\\bm s}(T))')
('3.5.5.1', 'z(t; {\\bm w})')
('3.5.5.1', "{\\bm z}'(t; {\\bm w}) = \\begin{pmatrix}\n      \\alpha z_1(t;{\\bm w}) - \\beta z_1(t;{\\bm w}) z_2(t;{\\bm w}) \\\\\n      -\\gamma z_2(t;{\\bm w}) + \\delta z_1(t;{\\bm w}) z_2(t;{\\bm w})\n    \\end{pmatrix} + {\\bm c},")
('3.5.5.1', '{\\bm w}= (\\alpha, \\beta, \\gamma, \\delta, {\\bm c})')
('3.5.5.1', '{\\bm z}_1, \\ldots, {\\bm z}_T')
('3.5.5.1', '\\min_{{\\bm w}}\\sum_{\\tau=1}^{T} (z(t_j;{\\bm w}) - z_j)^2,')
('3.5.5.1', '{\\bm z}(\\cdot;{\\bm w})')
('3.5.5.1', '{\\bm w}')
('3.5.5.1', '{\\bm w}')
('3.5.5.1', '{\\bm w}')
('3.5.5.2', 'f({\\bm x}, {\\bm w})')
('3.5.5.2', 'L\\circ f')
('3.5.5.2', '{\\bm r}(t)')
('3.5.5.2', '{\\bm s}(t)')
('3.5.5.2', '{\\bm r}(t)')
('3.5.5.2', '{\\bm s}(t)')
('3.5.5.2.0', '{\\bm s}(t)')
('3.5.5.2.0', '{\\bm \\sigma}(t)= {\\bm s}(T-t),\n{\\bm \\rho}(t) = {\\bm r}(T-t)')
('3.5.5.2.0', '{\\bm \\gamma}(t) = \\int_t^T \\partial_3 h(\\tau, {\\bm s}(\\tau),\n{\\bm w})^*{\\bm r}(\\tau) d\\tau')
('3.5.5.2.0', 'L\\circ f')
('3.5.5.2.0', '({\\bm \\rho}(T), {\\bm \\gamma}(T))')
('3.5.5.2.0', '{\\bm \\sigma}, {\\bm \\rho}, {\\bm \\gamma}')
('3.5.5.2.0', "\\begin{aligned}\n  {\\bm \\sigma}(0) & = {\\bm s}(T),\n  \\hspace*{30pt} {\\bm \\sigma}'(t) = -h(T-t, {\\bm \\sigma}(t), {\\bm w}), \\\\\n  {\\bm \\rho}(0) & = \\nabla L({\\bm s}(T)),\n  \\hspace*{6pt} {\\bm \\rho}'(t) = \\partial_2 h(T-t, {\\bm \\sigma}(t), {\\bm w})^* {\\bm \\rho}(t), \\\\\n  {\\bm \\gamma}(0) & = 0,\n  \\hspace*{48pt} {\\bm \\gamma}'(t) = \\partial_3 h(T-t, {\\bm \\sigma}(t), {\\bm w})^*{\\bm \\rho}(t).\n\\end{aligned}")
('3.5.5.2.0', '{\\bm s}(T)')
('3.5.5.2.0', '\\nabla L({\\bm s}(T))')
('3.5.5.2.0', 'h: [0, T] \\times \\mathcal{S}\\times \\mathcal{W}\\rightarrow \\mathbb{R}')
('3.5.5.2.0', 'L: \\mathcal{S}\\rightarrow \\mathbb{R}')
('3.5.5.2.0', '{\\bm x}')
('3.5.5.2.0', '{\\bm w}')
('3.5.5.2.0', 'K')
('3.5.5.2.0', '\\delta = T/K')
('3.5.5.2.0', 'h_k({\\bm s}, {\\bm w}) = h(k\\delta, {\\bm s}, {\\bm w})')
('3.5.5.2.0', '{\\bm s}_0 \\coloneqq {\\bm x}')
('3.5.5.2.0', '{\\bm s}_k \\coloneqq {\\bm s}_{k-1} + \\delta h_{k-1}({\\bm s}_{k-1}, {\\bm w})')
('3.5.5.2.0', '{\\bm u}\\coloneqq \\nabla L({\\bm s}_K)')
('3.5.5.2.0', '{\\bm r}_K \\coloneqq {\\bm u}')
('3.5.5.2.0', '\\hat {\\bm s}_K = {\\bm s}_K')
('3.5.5.2.0', '{\\bm g}_K= {\\mathbf{0}}')
('3.5.5.2.0', '\\hat {\\bm s}_{k-1}  \\coloneqq \\hat {\\bm s}_k - \\delta h_k(\\hat {\\bm s}_k, {\\bm w})')
('3.5.5.2.0', '{\\bm r}_{k-1} \\coloneqq {\\bm r}_k + \\delta \\partial_2 h_k(\\hat {\\bm s}_k, {\\bm w})^* {\\bm r}_k')
('3.5.5.2.0', '{\\bm g}_{k-1} \\coloneqq {\\bm g}_k + \\delta \\partial_3 h_k(\\hat {\\bm s}_k, {\\bm w})^*{\\bm r}_k')
('3.5.5.2.0', '({\\bm r}_0, {\\bm g}_0) \\approx \\nabla (L\\circ f)({\\bm x}, {\\bm w})')
('3.5.5.2.0', '{\\bm s}_k')
('3.5.5.2.0', '\\hat {\\bm s}_k')
('3.5.5.2.0', '\\hat {\\bm s}_k')
('3.5.5.2.0', '\\hat {\\bm s}_0')
('3.5.5.2.0', '{\\bm s}_0={\\bm x}')
('3.5.5.2.0', '\\sigma(T) = {\\bm s}(0)')
('3.5.5.2.0', '\\hat {\\bm s}_0\n\\approx \\sigma(T)')
('3.5.5.2.0', '{\\bm s}_0')
('3.5.5.2.0', '{\\bm s}_0= \\hat {\\bm s}_0')
('3.5.5.2.1', "\\begin{aligned}\n  {\\bm s}'(t) & = h(t, {\\bm s}(t), {\\bm w}), \n  \\quad {\\bm s}(0) = {\\bm x}, \\nonumber\\\\\n  {\\bm r}'(t) & = - \\partial_2 h(t, {\\bm s}(t), {\\bm w})^* {\\bm r}(t), \n  \\quad {\\bm r}(T) = \\nabla L({\\bm s}(T))\\nonumber \\\\\n  {\\bm g}'(t) & = - \\partial_3 h(t, {\\bm s}(t), {\\bm w})^*{\\bm r}(t), \n  \\quad {\\bm g}(T) = 0, \\nonumber\n\\end{aligned}")
('3.5.5.2.1', '\\nabla L({\\bm s}(T))')
('3.5.5.3', '\\begin{aligned}\n\\min_{{\\bm w}\\in \\mathcal{W}} \\quad & L({\\bm s}_K)\n\\quad \\text{where} \\quad\n{\\bm s}_k = {\\bm s}_{k-1} + \\delta h(k\\delta, {\\bm s}_{k-1}, {\\bm w}) ~\nk \\in \\{1, \\ldots, K\\},\n\\end{aligned}')
('3.5.5.3', '{\\bm s}_0 = {\\mathbf{0}}')
('3.5.5.3', '\\delta')
('3.5.5.3', 'K')
('3.5.5.3', 'K')
('3.5.5.3', 'h')
('3.5.5.3', '{\\bm s}')
('3.5.5.4', '\\mathcal{M}')
('3.5.5.4', '({\\bm s}_k)_{k=1}^{K}')
('3.5.5.4', "{\\bm s}'(t) = h(t, {\\bm s}(t))")
('3.5.5.4', '[0, T]')
('3.5.5.4', 'k \\in (1,\\dots, K)')
('3.5.5.4', '\\begin{aligned}\n\\label{ode:eq:forward_reversible}\n  t_k, {\\bm s}_k, {\\bm c}_k = \\mathcal{M}(t_{k-1}, {\\bm s}_{k-1}, {\\bm c}_{k-1}; h, \\delta),\n\\end{aligned}')
('3.5.5.4', '\\delta>0')
('3.5.5.4', 't_k')
('3.5.5.4', 't_k = t_{k-1} + \\delta')
('3.5.5.4', '{\\bm s}_k')
('3.5.5.4', '{\\bm s}(t_k)')
('3.5.5.4', '{\\bm c}_k')
('3.5.5.4', 'k \\in (K, \\dots, 1)')
('3.5.5.4', '\\begin{aligned}\nt_{k-1}, {\\bm s}_{k-1}, {\\bm c}_{k-1} = \\mathcal{M}(t_k, {\\bm s}_k, {\\bm c}_k; h, -\\delta).\n\\end{aligned}')
('3.5.5.4', '\\mathcal{M}^{-1}')
('3.5.5.4', 't_{k-1}, {\\bm s}_{k-1}, {\\bm c}_k = \\mathcal{M}^{-1}(t_k, {\\bm s}_k, {\\bm c}_k; h, \\delta).')
('3.5.5.4', '\\begin{aligned}\n  \\mathcal{M}(t_k, {\\bm s}_k, {\\bm c}_k; h, -\\delta) = \\mathcal{M}^{-1}(t_k,\n  {\\bm s}_k, {\\bm c}_k; h, \\delta).\n\\end{aligned}')
('3.5.5.4', '{\\bm y}_{k-1}')
('3.5.5.4', '{\\bm y}_k = {\\bm y}_{k-1} - \\delta\nf({\\bm y}_{k-1})')
('3.5.5.4.0', '\\delta')
('3.5.5.4.0', 't_{k-1}, {\\bm s}_{k-1}, {\\bm c}_{k-1}')
('3.5.5.4.0', 'h')
('3.5.5.4.0', '\\begin{aligned}\n  \\bar t_{k-1} & \\coloneqq t_{k-1} + \\frac{\\delta}{2} \\\\\n  \\bar {\\bm s}_{k-1} & \\coloneqq {\\bm s}_{k-1} + \\frac{\\delta}{2} {\\bm c}_{k-1} \\\\\n  \\bar {\\bm c}_{k-1} & \\coloneqq h(\\bar t_{k-1}, \\bar {\\bm s}_{k-1}) \\\\\n  t_k & \\coloneqq \\bar t_{k-1} + \\frac{\\delta}{2} \\\\\n  {\\bm s}_k & \\coloneqq \\bar {\\bm s}_{k-1} + \\frac{\\delta}{2} \\bar {\\bm c}_{k-1} \\\\\n  {\\bm c}_k & \\coloneqq  2 \\bar {\\bm c}_{k-1} - {\\bm c}_{k-1} \\\\\n  \\mathcal{M}(t_{k-1}, {\\bm s}_{k-1}, {\\bm c}_{k-1}; h, \\delta) & \\coloneqq (t_k, {\\bm s}_k, {\\bm c}_k). \\hspace*{60pt}\n\\end{aligned}')
('3.5.5.4.0', '\\mathcal{M}(t_k, {\\bm s}_k, {\\bm c}_k; h, -\\delta) =\n(t_{k-1}, {\\bm s}_k, {\\bm c}_k)')
('3.5.5.4.1', '{\\bm c}_k')
('3.5.5.4.1', "{\\bm s}''(t) = h(t, {\\bm s}(t), {\\bm w})")
('3.5.5.5', '{\\bm s}(t, {\\bm x}, {\\bm w})')
('3.5.5.5', 't')
('3.5.5.5', '{\\bm x}')
('3.5.5.5', '{\\bm w}')
('3.5.5.5', '{\\bm s}(t, {\\bm x}, {\\bm w})')
('3.5.5.5', '{\\bm r}')
('3.5.5.5', '{\\bm r}')
('3.5.5.5', '\\begin{aligned}\n    \\langle f({\\bm x}, {\\bm w}), {\\bm u}\\rangle \n    & = \\langle {\\bm s}(T, {\\bm x}, {\\bm w}), {\\bm u}\\rangle  \\\\\n    & \\quad + \n      \\int_0^T \n        \\langle \n          {\\bm r}(t),\n          h(t, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w}) - \\partial_t {\\bm s}(t, {\\bm x}, {\\bm w})\n        \\rangle\n      dt,\n  \n\\end{aligned}')
('3.5.5.5', '\\partial_t {\\bm s}(t, {\\bm x}, {\\bm w}) = \\partial_1 {\\bm s}(t,\n  {\\bm x}, {\\bm w})')
('3.5.5.5', '\\begin{aligned}\n    & \\partial_{\\bm w}f({\\bm x}, {\\bm w})^*[{\\bm u}] \\\\\n    & = \\partial_{\\bm w}{\\bm s}(T, {\\bm x}, {\\bm w})^* {\\bm u}\\\\\n    & \\quad + \\int_0^T \n    (\\partial_{\\bm w}{\\bm s}(t, {\\bm x}, {\\bm w})^* \\partial_{\\bm s}^* h({\\bm t}, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^*\n    - \\partial_{{\\bm w}t}^2 {\\bm s}(t, {\\bm x}, {\\bm w})^*\n    ){\\bm r}(t) dt \\\\\n    & \\quad + \\int_0^T \\partial_{\\bm w}h(t, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^* {\\bm r}(t) dt,  \\\\\n    & \\partial_{\\bm x}f({\\bm x}, {\\bm w})^*[{\\bm u}] \\\\\n    & = \\partial_{\\bm x}{\\bm s}(T, {\\bm x}, {\\bm w})^* {\\bm u}\\\\\n    & \\quad + \\int_0^T \n    (\\partial_{\\bm x}{\\bm s}(t, {\\bm x}, {\\bm w})^* \\partial_{\\bm s}^* h({\\bm t}, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^*\n    - \\partial_{{\\bm x}t}^2 {\\bm s}(t, {\\bm x}, {\\bm w})^*\n    ){\\bm r}(t) dt\n  \n\\end{aligned}')
('3.5.5.5', '\\partial_{{\\bm w}t}^2 {\\bm s}(t, {\\bm x}, {\\bm w})^*{\\bm r},\n  \\partial_{{\\bm x}t}^2 {\\bm s}(t, {\\bm x}, {\\bm w})^*{\\bm r}')
('3.5.5.5', '\\langle {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm r}\\rangle')
('3.5.5.5', 't')
('3.5.5.5', '{\\bm w}')
('3.5.5.5', '{\\bm x}')
('3.5.5.5', '{\\bm s}')
('3.5.5.5', '\\begin{aligned}\n    \\int_0^T \\partial_{{\\bm w}t}^2 {\\bm s}(t, {\\bm x}, {\\bm w})^* {\\bm r}(t)dt \n    & = \\int_0^T \\partial_{t {\\bm w}}^2 {\\bm s}(t, {\\bm x}, {\\bm w})^* {\\bm r}(t)dt \\\\\n    & = (\n      \\partial_{{\\bm w}} {\\bm s}(T, {\\bm x}, {\\bm w})^* {\\bm r}(T) \n      - \\partial_{{\\bm w}} {\\bm s}(0, {\\bm x}, {\\bm w})^* {\\bm r}(0)\n      ) \\\\\n    & \\quad - \\int_0^T \\partial_{{\\bm w}} {\\bm s}(t, {\\bm x}, {\\bm w})^* {\\bm r}(t)^* \\partial_t {\\bm r}(t)dt.\n  \n\\end{aligned}')
('3.5.5.5', '{\\bm s}(0) = {\\bm x}')
('3.5.5.5', '\\partial_{{\\bm w}} {\\bm s}(0, {\\bm x}, {\\bm w})^* {\\bm r}(0) = 0')
('3.5.5.5', '{\\bm w}')
('3.5.5.5', '\\begin{aligned}\n    & \\partial_{\\bm w}f({\\bm x}, {\\bm w})^*[{\\bm u}]  \\\\\n    & = \\partial_{\\bm w}{\\bm s}(T, {\\bm x}, {\\bm w})^* [{\\bm u}- {\\bm r}(T)] \\\\\n    & \\quad + \\int_0^T \n      \\partial_{\\bm w}{\\bm s}(t, {\\bm x}, {\\bm w})^*[\n        \\partial_{\\bm s}h({\\bm t}, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^* {\\bm r}(t)\n        + \\partial_t {\\bm r}(t)\n        ]dt \\\\\n    & \\quad + \\int_0^T \\partial_{\\bm w}h(t, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^* {\\bm r}(t) dt.\n  \n\\end{aligned}')
('3.5.5.5', '{\\bm r}(t)')
('3.5.5.5', '\\partial_t {\\bm r}(t) = -\\partial_{\\bm s}h({\\bm t}, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^* {\\bm r}(t), \n    \\quad {\\bm r}(T) = {\\bm u},')
('3.5.5.5', '\\partial_{\\bm w}f({\\bm x}, {\\bm w})^*[{\\bm u}] = \\int_0^T \\partial_{\\bm w}h(t, {\\bm s}(t, {\\bm x}, {\\bm w}), {\\bm w})^* {\\bm r}(t) dt.')
('3.5.5.5', '{\\bm x}')
('3.5.5.5', '\\partial_{{\\bm x}} {\\bm s}(0, {\\bm x}, {\\bm w})^* {\\bm r}(0) = {\\bm r}(0)')
('3.5.5.5', '{\\bm s}(0) = {\\bm x}')
('3.5.5.5', '{\\bm r}(t)')
('3.5.5.5', '\\partial_{\\bm x}f({\\bm x}, {\\bm w})^*[{\\bm u}] = {\\bm r}(0).')
('3.5.5.5', '{\\bm r}')
('4.0.0', '\\mathbb{R}\\cup \\{\\infty\\}')
('4.0.0', 'f:\\mathbb{R}^M \\rightarrow \\mathbb{R}\\cup{\\infty}')
('4.0.0', '\\mathrm{dom}(f) = \\{{\\bm u}\\in \\mathbb{R}^M: f({\\bm u}) < \\infty\\}.')
('4.0.0.0', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup\n\\{\\infty\\}')
('4.0.0.0', 'g \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.0.0', '\\begin{aligned}\n(f \\square g)({\\bm \\mu}) \n&\\coloneqq \\inf_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u}) + g({\\bm \\mu}- {\\bm u}) \\\\\n&= \\inf_{{\\bm z}\\in \\mathbb{R}^M} f({\\bm \\mu}+ {\\bm z}) + g({\\bm z}) \\\\\n&= \\inf_{{\\bm u}, {\\bm z}\\in \\mathbb{R}^M} f({\\bm u}) + g({\\bm z}) \\text{ s.t. } {\\bm u}= {\\bm \\mu}+ {\\bm z}.\n\\end{aligned}')
('4.0.0.0', '{\\bm u}\\coloneqq {\\bm \\mu}+ {\\bm z}')
('4.0.0.0', 'f')
('4.0.0.0', 'g')
('4.0.0.0', 'f \\square g')
('4.0.0.0', '{\\bm \\mu}\\in \\mathbb{R}^M')
('4.0.0.0', '(f \\square g)({\\bm \\mu}) = (g \\square f)({\\bm \\mu}).')
('4.0.0.0.0', '(f \\square g)({\\bm \\mu})')
('4.0.0.0.0', '\\inf_{{\\bm u}\n\\in \\mathbb{R}^M} f({\\bm u}) + g({\\bm \\mu}- {\\bm u})')
('4.0.0.0.0', '{\\bm u}\n\\mapsto f({\\bm u}) + g({\\bm \\mu}- {\\bm u})')
('4.0.0.0.0', '{\\bm \\mu}\\in \\mathbb{R}^M')
('4.0.0.0.0', 'f')
('4.0.0.0.0', 'g')
('4.0.0.0.1', 'f')
('4.0.0.0.1', 'f \\square R')
('4.0.0.0.1', 'R')
('4.0.0.0.1', '2')
('4.0.0.0.1', '\\iota_\\mathcal{C}')
('4.0.0.0.1', '\\mathcal{C}')
('4.0.0.0.1', 'f({\\bm u})')
('4.0.0.0.1', 'g({\\bm z})')
('4.0.0.0.1', '(f \\square g)({\\bm \\mu})')
('4.0.0.0.1', 'f({\\bm u})')
('4.0.0.0.1', '0')
('4.0.0.0.1', '\\inf_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u})')
('4.0.0.0.1', 'f({\\bm u})')
('4.0.0.0.1', '\\iota_{\\{{\\bm v}\\}}({\\bm z})')
('4.0.0.0.1', 'f({\\bm \\mu}- {\\bm v})')
('4.0.0.0.1', '\\iota_\\mathcal{C}({\\bm u})')
('4.0.0.0.1', '\\iota_\\mathcal{D}({\\bm z})')
('4.0.0.0.1', '\\iota_{\\mathcal{C}+ \\mathcal{D}}({\\bm \\mu})')
('4.0.0.0.1', '\\iota_\\mathcal{C}({\\bm u})')
('4.0.0.0.1', '\\|{\\bm z}\\|_2')
('4.0.0.0.1', 'd_\\mathcal{C}({\\bm \\mu}) = \\inf_{{\\bm u}\\in \\mathcal{C}} \\|{\\bm \\mu}- {\\bm u}\\|_2')
('4.0.0.0.1', 'f({\\bm u})')
('4.0.0.0.1', '\\frac{1}{2}\\|{\\bm z}\\|_2^2')
('4.0.0.0.1', '\\mathrm{env}_f({\\bm \\mu}) = \\inf_{{\\bm u}\\in \\mathbb{R}^M} \\frac{1}{2}\\|{\\bm \\mu}- {\\bm u}\\|_2^2 + f({\\bm u})')
('4.0.0.1', 'R({\\bm z}) \\coloneqq \\frac{1}{2} \\|{\\bm z}\\|^2_2')
('4.0.0.1', 'f \\square R')
('4.0.0.1', 'f')
('4.0.0.1', 'f')
('4.0.0.1', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.0.1', '\\begin{aligned}\n\\mathrm{env}_f({\\bm \\mu}) \n&\\coloneqq \\left(f \\square \\frac{1}{2} \\|\\cdot\\|^2_2\\right)({\\bm \\mu}) \\\\\n&= \\inf_{{\\bm u}\\in \\mathbb{R}^M}\nf({\\bm u}) + \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|_2^2 \\\\\n&= \\inf_{{\\bm z}\\in \\mathbb{R}^M}\nf({\\bm \\mu}+ {\\bm z}) + \\frac{1}{2} \\|{\\bm z}\\|_2^2.\n\\end{aligned}')
('4.0.0.1', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.0.1', '{\\bm \\mu}')
('4.0.0.1', '\\frac{1}{2}\\|{\\bm \\mu}-{\\bm u}\\|_2^2')
('4.0.0.1', 'f({\\bm u})')
('4.0.0.1', 'f')
('4.0.0.1', '\\mathrm{prox}_{f}({\\bm \\mu}) \n\\coloneqq \\mathop{\\mathrm{arg\\,min}}_{{\\bm u}\\in \\mathbb{R}^M}\n\\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|_2^2 + f({\\bm u}),')
('4.0.0.1', '\\mathrm{prox}_{f}({\\bm \\mu})')
('4.0.0.1', '\\mathrm{env}_f({\\bm \\mu}) = \nf(\\mathrm{prox}_f({\\bm \\mu}))\n+\n\\frac{1}{2} \\|{\\bm \\mu}- \\mathrm{prox}_f({\\bm \\mu})\\|_2^2.\n\\label{smoothing:eq:env_from_prox}')
('4.0.0.1.0', '\\mathrm{env}_f')
('4.0.0.1.0', 'f')
('4.0.0.1.0', 'f')
('4.0.0.1.0', '\\mathrm{env}_f')
('4.0.0.1.0', 'L')
('4.0.0.1.0', 'L')
('4.0.0.1.0', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.0.1.0', 'f')
('4.0.0.1.0', '\\mathrm{env}_f')
('4.0.0.1.0', '1')
('4.0.0.1.0', '\\mathrm{prox}_f({\\bm \\mu})')
('4.0.0.1.0', '{\\bm \\mu}\\in \\mathbb{R}^M')
('4.0.0.1.0', '\\nabla \\mathrm{env}_f({\\bm \\mu}) = {\\bm \\mu}- \\mathrm{prox}_f({\\bm \\mu}).')
('4.0.0.1.0', 'f')
('4.0.0.1.0', '{\\bm \\mu}\\in\n\\mathbb{R}^M')
('4.0.0.1.0', '\\mathrm{prox}_f({\\bm \\mu}) + \\mathrm{prox}_{f^*}({\\bm \\mu}) = {\\bm \\mu},')
('4.0.0.1.0', 'f^*')
('4.0.0.1.0', 'f')
('4.0.0.1.0', '\\nabla \\mathrm{env}_{f^*}({\\bm \\mu}) = \\mathrm{prox}_f({\\bm \\mu})')
('4.0.0.1.0', '\\mathrm{env}_f')
('4.0.0.1.0', 'f')
('4.0.0.1.0', '\\mathrm{env}_f')
('4.0.0.1.0', 'f')
('4.0.0.1.0', '\\min_{{\\bm \\mu}\\in \\mathbb{R}^M} \\mathrm{env}_f({\\bm \\mu}) = \\min_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u}).')
('4.0.0.1.0', '\\begin{aligned}\n\\inf_{{\\bm \\mu}\\in \\mathbb{R}^M} \\mathrm{env}_f({\\bm \\mu})\n&= \\inf_{{\\bm \\mu}\\in \\mathbb{R}^M} \\inf_{{\\bm u}\\in \\mathbb{R}^M} \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|^2_2 +\nf({\\bm u}) \\\\\n&= \\inf_{{\\bm u}\\in \\mathbb{R}^M} \\inf_{{\\bm \\mu}\\in \\mathbb{R}^M} \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|^2_2 +\nf({\\bm u}) \\\\\n&= \\inf_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u}).\n\\end{aligned}')
('4.0.0.1.1', '1')
('4.0.0.1.1', 'f({\\bm u}) \\coloneqq \\|{\\bm u}\\|_1 = \\sum_{j=1}^M |u_i|')
('4.0.0.1.1', '\\begin{aligned}\n\\mathrm{prox}_{f}({\\bm \\mu}) \n&= \\mathop{\\mathrm{arg\\,min}}_{{\\bm u}\\in \\mathbb{R}^M} \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|^2_2 + \\|{\\bm u}\\|_1 \\\\\n&= \\mathrm{sign}({\\bm \\mu}) \\cdot \\max(|{\\bm \\mu}| - 1, 0).\n\\end{aligned}')
('4.0.0.1.1', '\\mathrm{env}_f({\\bm \\mu}) \n= \\sum_{j=1}^M \\mathrm{huber}(\\mu_j)\n\\approx \\sum_{j=1}^M |\\mu_j|,')
('4.0.0.1.1', '\\mathrm{huber}(\\mu_j)\n\\coloneqq\n\\begin{cases}\n\\frac{\\mu_j^2}{2} &\\mbox{ if } |\\mu_j| \\le 1 \\\\\n|\\mu_j| - \\frac{1}{2} &\\mbox{ if } |\\mu_j| > 1\n\\end{cases}.')
('4.0.0.1.1', 'M=1')
('4.0.0.1.1', 'u \\in \\mathbb{R}')
('4.0.0.2', '\\mathrm{env}_f({\\bm \\mu}) \\coloneqq\n\\inf_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u}) + \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|_2^2')
('4.0.0.2', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('4.0.0.2', 'f \\colon \\mathbb{R}^M \\to\n\\mathbb{R}^T')
('4.0.0.2', 'f({\\bm u}) = (f_1({\\bm u}), \\dots, f_T({\\bm u}))')
('4.0.0.2', 'f_i \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('4.0.0.2', 'i \\in [T]')
('4.0.0.2', 'f_j')
('4.0.0.2', '\\mathrm{\\mathbf{env}}_f({\\bm \\mu}) \\coloneqq (\\mathrm{env}_{f_1}({\\bm \\mu}), \\dots, \\mathrm{env}_{f_T}({\\bm \\mu})),')
('4.0.0.2', '\\mathrm{env}_{f_i}({\\bm \\mu}) = \\inf_{{\\bm u}_i \\in \\mathbb{R}^M} f_i({\\bm u}_i) \n+ \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}_i\\|_2^2.')
('4.0.0.2', 'T')
('4.0.0.2', 'i \\in [T]')
('4.0.0.2', '\\mathrm{\\mathbf{env}}_f({\\bm u})')
('4.0.0.2', '{\\bm d}\\in \\mathbb{R}^T')
('4.0.0.2', '\\begin{aligned}\n\\partial  \\mathrm{\\mathbf{env}}_f({\\bm \\mu})^*[{\\bm d}]\n&= \\sum_{i=1}^T \\partial \\mathrm{env}_{f_i}({\\bm \\mu})^*[d_i] \\\\\n&= \\sum_{i=1}^T d_i \\nabla \\mathrm{env}_{f_i}({\\bm \\mu}).\n\\end{aligned}')
('4.0.0.2', 'f({\\bm u}) = (f_1(u_1), \\dots, f_T(u_T))')
('4.0.0.2', '\\partial \\mathrm{\\mathbf{env}}_f({\\bm \\mu})^*[{\\bm d}] = \\sum_{i=1}^T d_i \\mathrm{env}_{f_i}(\\mu_i).')
('4.0.0.2', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}^T')
('4.0.0.2', 'f')
('4.0.0.2', '{\\bm d}\\in \\mathbb{R}^T')
('4.0.0.2', '\\partial f({\\bm u})^*[{\\bm d}] = \\nabla \\langle f, {\\bm d}\\rangle({\\bm u}),')
('4.0.0.2', '\\langle f, {\\bm d}\\rangle({\\bm u}) \\coloneqq \\langle f({\\bm u}), {\\bm d}\\rangle')
('4.0.0.2', 'f')
('4.0.0.2', '\\partial f({\\bm u})^*[{\\bm d}]')
('4.0.0.2', '\\nabla \\mathrm{env}_{\\langle f, {\\bm d}\\rangle}({\\bm \\mu})')
('4.0.0.2', '\\mathrm{env}_{\\langle f, {\\bm d}\\rangle}({\\bm \\mu}) \n= \\inf_{{\\bm u}\\in \\mathbb{R}^M} \\langle f({\\bm u}), {\\bm d}\\rangle\n+ \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|^2_2.\n\\label{smoothing:eq:moreau_vjp}')
('4.0.0.2', 'T')
('4.0.0.2', '{\\bm d}= {\\bm e}_i')
('4.0.0.2', '\\mathrm{env}_{f_i}({\\bm \\mu})')
('4.0.0.2', 'f')
('4.0.0.2', '{\\bm d}')
('4.0.0.2', '\\partial f({\\bm \\mu})^*[{\\bm d}] \n\\approx    \n\\nabla \\mathrm{env}_{\\langle f, {\\bm d}\\rangle}({\\bm \\mu}) \n= {\\bm \\mu}- {\\bm u}^\\star,')
('4.0.0.2', '{\\bm u}^\\star')
('4.0.0.2', '{\\bm d}')
('4.0.0.2', 'f_i')
('4.0.0.2', '{\\bm d}')
('4.0.0.2', 'f({\\bm u}) = (f_1(u_1), \\dots, f_T(u_T))')
('4.0.0.2', '{\\bm d}= (d_1, \\dots, d_T)')
('4.0.0.2', '\\mathrm{env}_{\\langle f, {\\bm d}\\rangle}({\\bm \\mu}) = \\sum_{i=1}^T \\mathrm{env}_{d_i f_i}(\\mu_i).')
('4.0.1', 'f')
('4.0.1', 'f^*')
('4.0.1.0', '{\\bm u}\\mapsto \\langle {\\bm u}, {\\bm v}\\rangle - b.')
('4.0.1.0', '{\\bm v}\\in \\mathbb{R}^M')
('4.0.1.0', '-b \\in \\mathbb{R}')
('4.0.1.0', '{\\bm v}')
('4.0.1.0', 'f({\\bm u})')
('4.0.1.0', 'f({\\bm u})')
('4.0.1.0', '{\\bm u}')
('4.0.1.0', 'b')
('4.0.1.0', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.1.0', '\\langle {\\bm u}, {\\bm v}\\rangle - b \\le f({\\bm u})\n\\iff\n\\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}) \\le b.')
('4.0.1.0', 'b')
('4.0.1.0', 'b \\coloneqq \\sup_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)} \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}),')
('4.0.1.0', 'f')
('4.0.1.0', '\\mathop{\\mathrm{dom}}(f) \\coloneqq \\{{\\bm u}\\in \\mathbb{R}^M \\colon f({\\bm u}) < \\infty\\}.')
('4.0.1.0', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.1.0', 'f^*({\\bm v}) \\coloneqq \\sup_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)}\n\\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}).')
('4.0.1.0', '\\sup')
('4.0.1.0', '\\max')
('4.0.1.0', 'f^*({\\bm v})')
('4.0.1.0', '\\infty')
('4.0.1.0', '-f^*({\\bm v})')
('4.0.1.0', '{\\bm v}')
('4.0.1.0', 'f({\\bm u})')
('4.0.1.0', 'v')
('4.0.1.0', 'u \\mapsto uv - f^*(v)')
('4.0.1.0', 'f')
('4.0.1.0', 'v')
('4.0.1.0', 'f^*')
('4.0.1.0', 'f')
('4.0.1.0', '({\\bm u}, f({\\bm u}))')
('4.0.1.0', '{\\bm u}\n\\in \\mathop{\\mathrm{dom}}(f)')
('4.0.1.0', '{\\bm v}')
('4.0.1.0', '-f^*({\\bm v})')
('4.0.1.0', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(f^*)')
('4.0.1.0', 'f')
('4.0.1.0', '({\\bm u}, f({\\bm u}))')
('4.0.1.0', '{\\bm u}\n\\in \\mathop{\\mathrm{dom}}(f)')
('4.0.1.0', '{\\bm v}')
('4.0.1.0', '-f^*({\\bm v})')
('4.0.1.0', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(f^*)')
('4.0.1.0', 'v')
('4.0.1.0', 'v')
('4.0.1.0', 'u')
('4.0.1.1', 'f^*({\\bm v})')
('4.0.1.1', 'f')
('4.0.1.1', 'f({\\bm u}) = \\frac{1}{2} \\|{\\bm u}\\|_2^2')
('4.0.1.1', '\\mathop{\\mathrm{dom}}(f) = \\mathbb{R}^M')
('4.0.1.1', 'f^*({\\bm v}) = \\max_{{\\bm u}\\in \\mathbb{R}^M} \\langle {\\bm u}, {\\bm v}\\rangle - \\frac{1}{2} \\|{\\bm u}\\|^2_2.')
('4.0.1.1', '{\\bm u}\\mapsto \\langle {\\bm u}, {\\bm v}\\rangle - \\frac{1}{2} \\|{\\bm u}\\|^2_2')
('4.0.1.1', '{\\bm u}^\\star = {\\bm v}')
('4.0.1.1', '{\\bm u}^\\star')
('4.0.1.1', 'f^*({\\bm v}) \n= \\langle {\\bm u}^\\star, {\\bm v}\\rangle - \\frac{1}{2} \\|{\\bm u}^\\star\\|^2_2\n= \\frac{1}{2} \\|{\\bm v}\\|^2_2.')
('4.0.1.1', 'f = f^*')
('4.0.1.1', 'f({\\bm u}) = \\langle {\\bm u}, \\log {\\bm u}\\rangle')
('4.0.1.1', '\\mathop{\\mathrm{dom}}(f) = \\mathbb{R}_+^M')
('4.0.1.1', 'u\\mapsto \\langle {\\bm u}, {\\bm v}\\rangle - \\langle {\\bm u}, \\log {\\bm u}\\rangle')
('4.0.1.1', '{\\bm u}^\\star = \\exp({\\bm v}-\\operatorname{\\mathbf 1})')
('4.0.1.1', 'f^*({\\bm v}) =  \\sum_{j=1}^M \\exp(v_j - 1).')
('4.0.1.1.0', '\\mathbb{R}\\cup \\{\\infty\\}')
('4.0.1.1.0', '\\iota_\\mathcal{C}({\\bm u})\n\\coloneqq \\begin{cases}\n    0 &\\mbox{ if } {\\bm u}\\in \\mathcal{C}\\\\\n    +\\infty &\\mbox{ otherwise }\n\\end{cases}.')
('4.0.1.1.0', 'f({\\bm u}) = \\iota_\\mathcal{C}({\\bm u})')
('4.0.1.1.0', '\\mathcal{C}')
('4.0.1.1.0', 'f^*({\\bm v}) \n= \\sup_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)} ~ \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u})\n= \\sup_{{\\bm u}\\in \\mathcal{C}} ~ \\langle {\\bm u}, {\\bm v}\\rangle\n\\coloneqq \\sigma_{\\mathcal{C}}({\\bm v}),')
('4.0.1.1.0', '\\mathcal{C}')
('4.0.1.1.0', '{\\bm v}\\mapsto \\mathop{\\mathrm{arg\\,max}}_{{\\bm u}\\in \\mathcal{C}} \\langle {\\bm u}, {\\bm v}\\rangle,')
('4.0.1.1.0', '\\mathcal{C}')
('4.0.1.1.0', 'f({\\bm u}) = \\langle {\\bm u}, \\log {\\bm u}\\rangle + \\iota_{\\triangle^M}({\\bm u})')
('4.0.1.1.0', 'f^*({\\bm v}) = \\mathrm{logsumexp}({\\bm v}) = \\log \\sum_{i=1}^M \\exp(v_j).')
('4.0.1.2', 'f^*({\\bm v})')
('4.0.1.2', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.1.2', 'f')
('4.0.1.2', '{\\bm u}, {\\bm v}\\in \\mathbb{R}^M')
('4.0.1.2', 'f({\\bm u}) + f^*({\\bm v}) - \\langle {\\bm u}, {\\bm v}\\rangle \\ge 0.')
('4.0.1.2', 'f^*({\\bm v})')
('4.0.1.2', '{\\bm v}')
('4.0.1.2', '\\nabla f^*({\\bm v}) \n= \\mathop{\\mathrm{arg\\,max}}_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)} \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}).')
('4.0.1.2', 'f^*({\\bm v})')
('4.0.1.2', '{\\bm v}')
('4.0.1.2', 'f')
('4.0.1.2', 'f^*')
('4.0.1.2', '{\\bm v}= \\nabla f({\\bm u}) \n\\iff\n{\\bm u}= \\nabla f^*({\\bm v}) \n\\iff\nf^*({\\bm v}) + f({\\bm u}) - \\langle {\\bm u}, {\\bm v}\\rangle = 0.')
('4.0.1.2', 'f = f^{**}')
('4.0.1.2', 'f')
('4.0.1.2', 'f^{**} \\le f')
('4.0.1.2', '{\\bm v}\\mapsto \\sup_{{\\bm u}\\in \\mathcal{C}} g({\\bm u}, {\\bm v})')
('4.0.1.2', 'g')
('4.0.1.2', '{\\bm v}')
('4.0.1.2', 'g')
('4.0.1.2', '{\\bm u}')
('4.0.1.2', 'g({\\bm u}, {\\bm v}) = \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u})')
('4.0.1.2', '{\\bm v}')
('4.0.1.2', '{\\bm v}')
('4.0.1.2', "\\begin{aligned}\nf^*({\\bm v}) &= \\langle {\\bm g}, {\\bm v}\\rangle - f({\\bm g}) \\\\\nf^*({\\bm v}') &\\ge \\langle {\\bm g}, {\\bm v}' \\rangle - f({\\bm g}),\n\\end{aligned}")
('4.0.1.2', '{\\bm g}\\coloneqq \\displaystyle{\\mathop{\\mathrm{arg\\,max}}_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)}} \\langle {\\bm u}, {\\bm v}\n\\rangle - f({\\bm u})')
('4.0.1.2', "f^*({\\bm v}') \\ge f^*({\\bm v}) + \\langle {\\bm g}, {\\bm v}' - {\\bm v}\\rangle.")
('4.0.1.2', 'f^*')
('4.0.1.2', '{\\bm g}= \\nabla f^*({\\bm v})')
('4.0.1.3', 'f({\\bm u}) = \\sum_{j=1}^M f_j(u_j)')
('4.0.1.3', 'f^*({\\bm v}) = \\sum_{j=1}^M f^*_j(v_j).')
('4.0.1.3', 'f({\\bm u}) = c \\cdot g({\\bm u})')
('4.0.1.3', 'c > 0')
('4.0.1.3', 'f^*({\\bm v}) = c \\cdot g^*({\\bm v}/ c).')
('4.0.1.3', 'f({\\bm u}) = g({\\bm u}) + \\langle {\\bm \\alpha}, {\\bm u}\\rangle + \\beta')
('4.0.1.3', 'f^*({\\bm v}) = g^*({\\bm v}- {\\bm \\alpha}) - \\beta.')
('4.0.1.3', 'f({\\bm u}) = g(M{\\bm u})')
('4.0.1.3', 'x\\mapsto M{\\bm x}')
('4.0.1.3', 'f^*({\\bm v}) = g^*(M^{-T} {\\bm v}).')
('4.0.1.3', 'h_1')
('4.0.1.3', 'h_2')
('4.0.1.3', '(h_1 + h_2)^* = h_1^* \\square h_2^*')
('4.0.1.3', '\\square')
('4.0.1.4', 'f')
('4.0.1.4', '-f')
('4.0.1.4', 'f')
('4.0.1.4', 'f^*({\\bm v})')
('4.0.1.4', 'f^*({\\bm v}) \\approx \\sup_{{\\bm u}\\in \\mathcal{U}} \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}),')
('4.0.1.4', '\\mathcal{U}\\subseteq \\mathop{\\mathrm{dom}}(f)')
('4.0.1.4', 'f^*({\\bm v})')
('4.0.1.4', '{\\bm v}\\in \\mathcal{V}')
('4.0.1.4', '\\mathcal{V}\\subseteq \\mathop{\\mathrm{dom}}(f^*)')
('4.0.1.4', 'O(|\\mathcal{U}| \\cdot |\\mathcal{V}|)')
('4.0.1.4', '|\\mathcal{U}| = |\\mathcal{V}| = O(N^M)')
('4.0.1.4', 'N')
('4.0.1.4', 'M')
('4.0.1.4', 'M \\in \\{1,2,3\\}')
('4.0.2', 'R')
('4.0.2.0', 'f')
('4.0.2.0', '\\frac{1}{\\mu}')
('4.0.2.0', '\\|\\cdot\\|')
('4.0.2.0', '\\mathop{\\mathrm{dom}}(f)')
('4.0.2.0', 'f^*')
('4.0.2.0', '\\mu')
('4.0.2.0', '\\|\\cdot\\|_*')
('4.0.2.0', '\\mathop{\\mathrm{dom}}(f^*)')
('4.0.2.0', '\\frac{1}{2} \\|{\\bm u}\\|_2^2')
('4.0.2.0', '\\|\\cdot\\|_2')
('4.0.2.0', '\\mathbb{R}^M')
('4.0.2.0', '\\frac{1}{2} \\|{\\bm v}\\|_2^2')
('4.0.2.0', '\\|\\cdot\\|_2')
('4.0.2.0', '\\mathbb{R}^M')
('4.0.2.0', '\\langle {\\bm u}, \\log {\\bm u}\\rangle')
('4.0.2.0', '\\|\\cdot\\|_1')
('4.0.2.0', '\\triangle^M')
('4.0.2.0', '\\mathrm{logsumexp}({\\bm v})')
('4.0.2.0', '\\|\\cdot\\|_\\infty')
('4.0.2.0', '\\mathbb{R}^M')
('4.0.2.1', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('4.0.2.1', 'f^*')
('4.0.2.1', 'f^*({\\bm v}) \\coloneqq \\sup_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)} \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}).')
('4.0.2.1', '\\Omega')
('4.0.2.1', 'f_\\Omega^*({\\bm v}) \\coloneqq f^*({\\bm v}) + \\Omega({\\bm v}).\n\\label{smoothing:eq:regularized_conjugate}')
('4.0.2.1', 'f^*_\\Omega')
('4.0.2.1', 'f_\\Omega({\\bm u}) \n\\coloneqq f^{**}_\\Omega({\\bm u}) \n= \\max_{{\\bm v}\\in \\mathbb{R}^M} \\langle {\\bm u}, {\\bm v}\\rangle - f_\\Omega^*({\\bm v}).')
('4.0.2.1', '{\\bm u}')
('4.0.2.1', '{\\bm v}')
('4.0.2.1', '{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)')
('4.0.2.1', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(f^*)')
('4.0.2.1', '\\Omega')
('4.0.2.1', '\\mu')
('4.0.2.1', 'f_\\Omega({\\bm u})')
('4.0.2.1', '\\frac{1}{\\mu}')
('4.0.2.1', 'f_\\Omega({\\bm u})')
('4.0.2.1', 'f')
('4.0.2.1', 'f_\\Omega({\\bm u})')
('4.0.2.1', 'f({\\bm u})')
('4.0.2.1', '1')
('4.0.2.1', '3')
('4.0.2.1', '1')
('4.0.2.1', 'f({\\bm u}) \\coloneqq \\|{\\bm u}\\|_1 = \\sum_{j=1}^M |u_j|')
('4.0.2.1', '\\|\\cdot\\|')
('4.0.2.1', '\\{{\\bm v}\\in \\mathbb{R}^M \\colon\n\\|{\\bm v}\\|_* \\le 1\\}')
('4.0.2.1', '\\|{\\bm u}\\|_1')
('4.0.2.1', '\\|{\\bm v}\\|_\\infty')
('4.0.2.1', '\\{ {\\bm v}\\in \\mathbb{R}^M \\colon \\|{\\bm v}\\|_\\infty \\le 1\\}\n=\n[-1, 1]^M.')
('4.0.2.1', '\\iota_\\mathcal{C}')
('4.0.2.1', '\\mathcal{C}')
('4.0.2.1', 'f^*({\\bm v}) = \\iota_{[-1,1]^M}({\\bm v}).')
('4.0.2.1', '\\Omega({\\bm v}) \\coloneqq \\frac{1}{2} \\|{\\bm v}\\|_2^2')
('4.0.2.1', 'f^*_\\Omega({\\bm v}) \\coloneqq \\iota_{[-1,1]^M}({\\bm v}) + \\Omega({\\bm v}).')
('4.0.2.1', 'f_\\Omega({\\bm u}) \n= f_\\Omega^{**}({\\bm u})\n= \\langle {\\bm u}, {\\bm v}^\\star \\rangle - \\Omega({\\bm v}^\\star) \n= \\sum_{i=1}^M \\mathrm{huber}(u_i),')
('4.0.2.1', '{\\bm v}^\\star \n= \\mathrm{clip}\\left({\\bm u}\\right)\n\\coloneqq \\max\\left(\\min\\left({\\bm u}, 1\\right), -1\\right)')
('4.0.2.1', '\\mathcal{L}_\\Omega \\le \\Omega({\\bm v}) \\le \\mathcal{U}_\\Omega')
('4.0.2.1', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(\\Omega)')
('4.0.2.1', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.2.1', 'f({\\bm u}) - \\mathcal{U}_\\Omega \\le f_\\Omega({\\bm u}) \\le f({\\bm u}) - \\mathcal{L}_\\Omega.')
('4.0.2.1', '\\begin{aligned}\n{\\bm v}^\\star &\\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm v}\\in \\mathbb{R}^M} \\langle {\\bm u}, {\\bm v}\\rangle - f^*({\\bm v})\\\\\n{\\bm v}^\\star_\\Omega &\\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm v}\\in \\mathbb{R}^M} \\langle {\\bm u}, {\\bm v}\\rangle \n- f^*_\\Omega({\\bm v}),\n\\end{aligned}')
('4.0.2.1', 'f^*_\\Omega \\coloneqq f^* + \\Omega')
('4.0.2.1', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.2.1', 'f_\\Omega({\\bm u})\n= \\langle {\\bm u}, {\\bm v}^\\star_\\Omega \\rangle - f_\\Omega^*({\\bm v}^\\star_\\Omega)\n\\ge \\langle {\\bm u}, {\\bm v}^\\star \\rangle - f_\\Omega^*({\\bm v}^\\star)\n= f({\\bm u}) - \\Omega({\\bm v}^\\star)')
('4.0.2.1', 'f({\\bm u}) - \\Omega({\\bm v}^\\star_\\Omega)\n= \\langle {\\bm u}, {\\bm v}^\\star \\rangle - f^*({\\bm v}^\\star) - \\Omega({\\bm v}^\\star_\\Omega)\n\\ge \\langle {\\bm u}, {\\bm v}^\\star_\\Omega \\rangle - f_\\Omega^*({\\bm v}^\\star_\\Omega)\n= f_\\Omega({\\bm u}).')
('4.0.2.1', '\\mathcal{L}_\\Omega \\le \\Omega({\\bm v}) \\le \\mathcal{U}_\\Omega')
('4.0.2.1', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(\\Omega)')
('4.0.2.1', 'f({\\bm u}) - \\mathcal{U}_\\Omega\n\\le\nf({\\bm u}) - \\Omega({\\bm v}^\\star)\n\\le\nf_\\Omega({\\bm u})\n\\le\nf({\\bm u}) - \\Omega({\\bm v}^\\star_\\Omega)\n\\le f({\\bm u}) - \\mathcal{L}_\\Omega.')
('4.0.2.1', 'f_\\Omega({\\bm u})')
('4.0.2.1', '\\nabla f_\\Omega({\\bm u})\n= \\mathop{\\mathrm{arg\\,max}}_{{\\bm v}\\in \\mathbb{R}^M}\n\\langle {\\bm u}, {\\bm v}\\rangle - f_\\Omega^*({\\bm v}).')
('4.0.2.1', '\\Omega')
('4.0.2.1', 'f_\\Omega')
('4.0.2.1', '\\nabla f_\\Omega')
('4.0.2.1', '\\nabla f_\\Omega')
('4.0.2.1', 'f_\\Omega')
('4.0.2.2', 'f')
('4.0.2.2', 'f \\square R')
('4.0.2.2', 'R \\colon \\mathop{\\mathrm{dom}}(f) \\to \\mathbb{R}')
('4.0.2.2', 'f^*')
('4.0.2.2', 'f')
('4.0.2.2', '\\Omega')
('4.0.2.2', 'f_\\Omega')
('4.0.2.2', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.2.2', 'R \\colon \\mathbb{R}^M \\to \\mathbb{R}\\cup \\{\\infty\\}')
('4.0.2.2', 'f_\\Omega = f \\square R')
('4.0.2.2', '\\Omega = R^*')
('4.0.2.2', 'f_\\Omega({\\bm u}) \n= (f^* + \\Omega)^*({\\bm u})\n= \\sup_{{\\bm v}\\in \\mathop{\\mathrm{dom}}({\\bm f}^*)} \\langle {\\bm u}, {\\bm v}\\rangle - f^*({\\bm v}) - \\Omega({\\bm v}).')
('4.0.2.2', 'h_1')
('4.0.2.2', 'h_2')
('4.0.2.2', '(h_1 + h_2)^* = h_1^* \\square h_2^*')
('4.0.2.2', 'h_1 = f^*')
('4.0.2.2', 'h_2 = \\Omega = R^*')
('4.0.2.2', 'f^{**}= f')
('4.0.2.2', 'R^{**} = R')
('4.0.2.2', '\\Omega = \\frac{1}{2}\\|\\cdot\\|^2_2 = \\Omega^*')
('4.0.2.2', '\\mathrm{env}_f = f_\\Omega = f_{\\Omega^*}.')
('4.0.2.3.0', '\\Omega')
('4.0.2.3.0', '1')
('4.0.2.3.0', 'f_\\Omega')
('4.0.2.3.0', '1')
('4.0.2.3.0', 'f')
('4.0.2.3.0', '\\varepsilon \\Omega')
('4.0.2.3.0', '\\varepsilon>0')
('4.0.2.3.0', '1/\\varepsilon')
('4.0.2.3.0', 'f_{\\varepsilon \\Omega}')
('4.0.2.3.0', 'f')
('4.0.2.3.0', '\\begin{aligned}\nf_{\\varepsilon \\Omega}({\\bm v}) \n&= \\varepsilon f_\\Omega({\\bm v}/\\varepsilon) \\\\\n\\nabla f_{\\varepsilon \\Omega}({\\bm v}) \n&= \\nabla f_\\Omega({\\bm v}/\\varepsilon).\n\\end{aligned}')
('4.0.2.3.0', 'f_\\Omega')
('4.0.2.3.0', 'f_{\\varepsilon \\Omega}')
('4.0.2.3.0', 'f({\\bm u}) - \\varepsilon \\mathcal{U}_\\Omega \n  \\le f_\\Omega({\\bm u}) \n  \\le f({\\bm u}) - \\varepsilon \\mathcal{L}_\\Omega,')
('4.0.2.3.0', '\\mathcal{L}_\\Omega \\le \\Omega({\\bm v}) \\le \\mathcal{U}_\\Omega')
('4.0.2.3.0', '{\\bm v}\\in\n\\mathop{\\mathrm{dom}}(\\Omega)')
('4.0.2.3.1', '\\varepsilon \\Omega')
('4.0.2.3.1', '\\varepsilon\n> 0')
('4.0.2.3.1', 'R =\n\\varepsilon \\Omega^*(\\cdot / \\varepsilon)')
('4.0.2.3.1', 'f_{\\varepsilon \\Omega} = f \\square \\varepsilon \\Omega^*(\\cdot / \\varepsilon).')
('4.0.2.3.1', '\\Omega({\\bm v}) = \\frac{1}{2} \\|{\\bm v}\\|^2_2')
('4.0.2.3.1', 'R({\\bm u}) \n= \\frac{\\varepsilon}{2} \\|{\\bm u}/ \\varepsilon\\|^2_2\n= \\frac{1}{2 \\varepsilon} \\|{\\bm u}\\|^2_2\n= \\frac{1}{\\varepsilon} \\Omega({\\bm u}).')
('4.0.2.3.1', 'f_{\\varepsilon \\Omega} \n= f \\square \\frac{1}{\\varepsilon} \\Omega\n= \\frac{1}{\\varepsilon} (\\varepsilon f \\square \\Omega)\n= \\frac{1}{\\varepsilon} \\mathrm{env}_{\\varepsilon f}.')
('4.0.2.4', '\\Omega({\\bm \\pi})')
('4.0.2.4', '{\\bm \\pi}\\in \\triangle^M')
('4.0.2.4.0', 'I(E)')
('4.0.2.4.0', 'E')
('4.0.2.4.0', '0')
('4.0.2.4.0', '1')
('4.0.2.4.0', '0')
('4.0.2.4.0', 'E')
('4.0.2.4.0', 'p(E)')
('4.0.2.4.0', 'I(E)')
('4.0.2.4.0', 'y')
('4.0.2.4.0', 'Y')
('4.0.2.4.0', '\\{Y =\ny\\}')
('4.0.2.4.0', 'I(y) \\coloneqq I(\\{Y = y\\}).')
('4.0.2.4.0', 'H(Y)')
('4.0.2.4.0', 'Y \\in \\mathcal{Y}')
('4.0.2.4.0', 'H(Y) \\coloneqq \\mathbb{E}[I(Y)].')
('4.0.2.4.1', 'I(E) \n\\coloneqq \\log\\left(\\frac{1}{p(E)}\\right )\n= - \\log p(E).')
('4.0.2.4.1', '-\\log 1 = 0')
('4.0.2.4.1', '-\\log 0 = \\infty')
('4.0.2.4.1', '-\\log')
('4.0.2.4.1', '(0,1]')
('4.0.2.4.1', 'H(Y) \n= \\mathbb{E}[I(Y)]   \n= -\\sum_{y \\in \\mathcal{Y}} p(y) \\log p(y).')
('4.0.2.4.1', '{\\bm \\pi}\\in \\triangle^M')
('4.0.2.4.1', 'H({\\bm \\pi}) \n= -\\sum_{i=1}^M \\pi_i \\log \\pi_i \n= -\\langle {\\bm \\pi}, \\log {\\bm \\pi}\\rangle')
('4.0.2.4.1', '\\Omega({\\bm \\pi}) = -H({\\bm \\pi}) = \\langle {\\bm \\pi}, \\log {\\bm \\pi}\\rangle.')
('4.0.2.4.1', '\\|\\cdot\\|_1')
('4.0.2.4.1', '\\triangle^M')
('4.0.2.4.1', '\\mathbb{R}_+^M')
('4.0.2.4.1', '\\Omega')
('4.0.2.4.1', 'f^*')
('4.0.2.4.1', '\\Omega')
('4.0.2.4.1', 'f')
('4.0.2.4.1', '\\mathop{\\mathrm{dom}}(f^*) \\subseteq \\triangle^M')
('4.0.2.4.2', 'I(E) = \\frac{1}{2}(1 - p(E)).')
('4.0.2.4.2', '\\frac{1}{2}')
('4.0.2.4.2', 'p(E) = 1')
('4.0.2.4.2', 'I(E) = 0')
('4.0.2.4.2', 'p(E) = 0')
('4.0.2.4.2', 'I(E)')
('4.0.2.4.2', '\\frac{1}{2}')
('4.0.2.4.2', 'p(E)')
('4.0.2.4.2', 'H(Y) \n= \\mathbb{E}[I(Y)]   \n= \\frac{1}{2} \\sum_{y \\in \\mathcal{Y}} p(y) (1 - p(y)).')
('4.0.2.4.2', '{\\bm \\pi}\\in \\triangle^M')
('4.0.2.4.2', '\\Omega({\\bm \\pi}) \n= \\frac{1}{2} \\langle {\\bm \\pi}, {\\bm \\pi}- \\operatorname{\\mathbf 1}\\rangle\n= \\frac{1}{2} (\\|{\\bm \\pi}\\|^2_2 - 1).')
('4.0.2.4.2', '\\|\\cdot\\|_2')
('4.0.2.4.2', '\\mathbb{R}^M')
('4.0.2.4.2', '\\Omega')
('4.0.2.4.2', 'f')
('4.0.2.4.2', '\\mathop{\\mathrm{dom}}(f^*) \\subseteq \\mathbb{R}^M')
('4.0.2.4.2', '{\\bm \\pi}= (\\pi, 1-\\pi) \\in \\triangle^2')
('4.0.2.4.2', '\\pi \\in [0,1]')
('4.0.2.4.2', '(0.5, 0.5)')
('4.0.2.4.2', '\\Omega')
('4.0.2.4.2', 'f')
('4.0.2.4.2', '\\mathop{\\mathrm{dom}}(f^*) \\subseteq\n\\triangle^M')
('4.0.2.4.3', '\\alpha \\ge 1')
('4.0.2.4.3', 'I(E) = \\frac{1}{\\alpha (\\alpha-1)}(1 - p(E)^{\\alpha-1}).')
('4.0.2.4.3', 'H(Y) \n= \\mathbb{E}[I(Y)]   \n= \\frac{1}{\\alpha(\\alpha-1)} \\sum_{y \\in \\mathcal{Y}} p(y) (1 - p^{\\alpha-1}(y)).')
('4.0.2.4.3', '\\alpha \\to 1')
('4.0.2.4.3', '\\alpha = 2')
('4.0.2.4.3', '{\\bm \\pi}\\in \\triangle^M')
('4.0.2.4.3', '\\Omega({\\bm \\pi}) \n= \\frac{1}{\\alpha(\\alpha-1)}\\langle {\\bm \\pi}, {\\bm \\pi}^{\\alpha-1} - \\operatorname{\\mathbf 1}\\rangle\n= \\frac{1}{\\alpha(\\alpha-1)} (\\|{\\bm \\pi}\\|^\\alpha_\\alpha - 1),')
('4.0.2.4.3', '\\|{\\bm v}\\|_p')
('4.0.2.4.3', 'p')
('4.0.2.4.3', 'p \\ge 1')
('4.0.2.4.3', '\\|{\\bm v}\\|_p \\coloneqq \n\\left(\\sum_{i=1}^M v_i^p\\right)^{\\frac{1}{p}},')
('4.0.2.4.3', '\\|{\\bm v}\\|_p^p = \\sum_{i=1}^M v_i^p.')
('4.0.2.4.3', '\\alpha \\to 1')
('4.0.2.4.3', '\\alpha=1.5')
('4.0.2.4.3', '\\alpha=2')
('4.0.2.4.4', 'H \\colon \\triangle^M \\to \\mathbb{R}_+')
('4.0.2.4.4', 'H({\\bm \\pi}) = 0')
('4.0.2.4.4', '{\\bm \\pi}\\in \\{{\\bm e}_1,\\dots,{\\bm e}_M\\}')
('4.0.2.4.4', 'H')
('4.0.2.4.4', 'H(P {\\bm \\pi}) = H({\\bm \\pi})')
('4.0.2.4.4', 'P')
('4.0.2.4.4', 'H')
('4.0.2.4.4', 'p')
('4.0.2.4.4', 'H({\\bm \\pi}) = \\frac{1}{2} - \\frac{1}{2} \\|{\\bm \\pi}\\|_p^2.')
('4.0.2.4.4', 'p')
('4.0.2.4.4', 'p \\in (1,2]')
('4.0.2.4.4', 'p \\in (1,2]')
('4.0.3', '\\mathrm{relu}(u)\n\\coloneqq \n\\begin{cases}\n    u &\\mbox{ if } u \\ge 0 \\\\\n    0 &\\mbox{ otherwise }\n\\end{cases}\n= \\max(u, 0).')
('4.0.3', 'f')
('4.0.3', 'f^*')
('4.0.3', '\\Omega')
('4.0.3', 'f^*_\\Omega \\coloneqq f^* + \\Omega')
('4.0.3', 'f_\\Omega')
('4.0.3', 'f_\\Omega^{**}')
('4.0.3', 'f = \\mathrm{relu}')
('4.0.3', '\\mathrm{relu}^*(\\pi) \n= \\iota_{[0,1]}(\\pi)\n= \\begin{cases}\n    0 &\\mbox{ if } \\pi \\in [0,1] \\\\\n    \\infty &\\mbox{ if } \\pi \\not \\in [0,1]\n\\end{cases}.')
('4.0.3', '\\mathrm{relu}(u) =\n\\max_{\\pi \\in [0,1]} u \\cdot \\pi\n= \\max_{\\pi \\in \\{0,1\\}} u \\cdot \\pi\n= \\begin{cases}\n    u &\\mbox{ if } u \\ge 0 \\\\\n    0 &\\mbox{ otherwise}\n\\end{cases}.\n\\label{smoothing:eq:relu_variational_form}')
('4.0.3', '\\pi')
('4.0.3', '[0,1]')
('4.0.3', '\\pi \\in [0,1]')
('4.0.3', '\\pi \\in \\{0,1\\}')
('4.0.3', '[0,1]')
('4.0.3', '\\mathrm{relu}^* = \\iota_{[0,1]}')
('4.0.3', '\\mathrm{relu}^*_\\Omega(\\pi) \n= \\mathrm{relu}^*(\\pi) + \\Omega(\\pi)\n= \\iota_{[0,1]}(\\pi) + \\Omega(\\pi)')
('4.0.3', '\\Omega')
('4.0.3', '\\begin{aligned}\n\\mathrm{relu}_\\Omega(u) \n&= \\max_{\\pi \\in \\mathbb{R}} u \\cdot \\pi - \n(\\iota_{[0,1]}(\\pi) + \\Omega(\\pi)) \\\\\n&= \\max_{\\pi \\in [0,1]} u \\cdot \\pi  \n- \\Omega(\\pi).\n\\end{aligned}')
('4.0.3.0', '\\Omega(\\pi) = \\pi \\log \\pi + (1-\\pi) \\log (1-\\pi)')
('4.0.3.0', '\\langle {\\bm \\pi}, \\log {\\bm \\pi}\\rangle')
('4.0.3.0', '{\\bm \\pi}= (\\pi, 1 - \\pi)')
('4.0.3.0', '\\mathrm{relu}_\\Omega(u) = \\mathrm{softplus}(u) = \\log(1 + \\exp(u)).')
('4.0.3.0.0', '\\Omega({\\bm \\pi}) = \\pi(\\pi - 1)')
('4.0.3.0.0', '\\frac{1}{2} \\langle {\\bm \\pi}, {\\bm \\pi}- \\operatorname{\\mathbf 1}\\rangle')
('4.0.3.0.0', '{\\bm \\pi}= (\\pi, 1-\\pi)')
('4.0.3.0.0', '\\mathrm{relu}_\\Omega(u)\n=\n\\mathrm{sparseplus}(u) \n=\n\\begin{cases}\n  0, & u \\leq -1\\\\\n  \\frac{1}{4}(u+1)^2, & -1 < u < 1 \\\\  \n  u, & u \\geq 1\n\\end{cases}.')
('4.0.4.0', '{\\bm u}= (u_1, \\dots, u_M) \\in \\mathbb{R}^M')
('4.0.4.0', '\\mathrm{max}({\\bm u}) \\coloneqq \\max_{j \\in [M]} u_j.')
('4.0.4.0', '\\max_\\Omega')
('4.0.4.0', '\\max')
('4.0.4.0', '\\max')
('4.0.4.0', '\\mathrm{max}^*({\\bm \\pi}) = \\iota_{\\triangle^M}({\\bm \\pi}).')
('4.0.4.0', '\\triangle^M')
('4.0.4.0', '{\\bm e}_1, \\dots, {\\bm e}_M')
('4.0.4.0', '\\max({\\bm u}) \n=\n\\max_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle \n=\n\\max_{{\\bm \\pi}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_M\\}} \\langle {\\bm u}, {\\bm \\pi}\\rangle.')
('4.0.4.0', '\\triangle^M')
('4.0.4.0', '\\mathrm{max}^* = \\iota_{\\triangle^M}')
('4.0.4.0', '\\text{max}_\\Omega^*({\\bm \\pi}) \n= \\text{max}^*({\\bm \\pi}) + \\Omega({\\bm \\pi}) \n= \\Omega({\\bm \\pi}) + \\iota_{\\triangle^M}({\\bm \\pi})')
('4.0.4.0', '\\begin{aligned}\n\\mathrm{max}_\\Omega({\\bm u})\n&= (\\Omega + \\iota_{\\triangle^M})^*({\\bm u}) \\\\ \n&= \\max_{{\\bm \\pi}\\in \\mathbb{R}^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle -\n(\\Omega({\\bm \\pi}) + \\iota_{\\triangle^M}({\\bm \\pi})) \\\\\n&= \\max_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle - \\Omega({\\bm \\pi}).\n\\end{aligned}')
('4.0.4.0', '\\max_\\Omega')
('4.0.4.0', '\\mathcal{L}_\\Omega \\le \\Omega({\\bm \\pi}) \\le \\mathcal{U}_\\Omega')
('4.0.4.0', '{\\bm \\pi}\\in \\triangle^M')
('4.0.4.0', '\\max({\\bm u}) - \\mathcal{U}_\\Omega \\le \\text{max}_\\Omega({\\bm u}) \\le \\max({\\bm u}) - \\mathcal{L}_\\Omega')
('4.0.4.0', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.4.0', '{\\bm u}\\le {\\bm v}')
('4.0.4.0', '\\text{max}_\\Omega({\\bm u}) \\le \\text{max}_\\Omega({\\bm v})')
('4.0.4.0', '\\Omega(P {\\bm \\pi}) = \\Omega({\\bm \\pi})')
('4.0.4.0', 'P')
('4.0.4.0', '{\\bm \\pi}\n\\in \\triangle^M')
('4.0.4.0', '\\text{max}_\\Omega(P{\\bm u}) = \\text{max}_\\Omega({\\bm u})')
('4.0.4.0', 'P')
('4.0.4.0', '+')
('4.0.4.0', '\\text{max}_\\Omega({\\bm u}+ c \\operatorname{\\mathbf 1}) = \n\\text{max}_\\Omega({\\bm u}) + c')
('4.0.4.0', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.4.0', 'c \\in \\mathbb{R}')
('4.0.4.0', '\\Omega')
('4.0.4.0.0', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.4.0.0', '\\min({\\bm u}) = -\\max(-{\\bm u}).')
('4.0.4.0.0', '\\mathrm{max}_\\Omega')
('4.0.4.0.0', '\\begin{aligned}\n\\mathrm{min}_\\Omega({\\bm u}) &\\coloneqq -\\mathrm{max}_\\Omega(-{\\bm u}).\n\\end{aligned}')
('4.0.4.1', '\\max_\\Omega({\\bm u})')
('4.0.4.1', '\\Omega')
('4.0.4.1', '\\delta_\\Omega({\\bm u})\n\\coloneqq (\\Omega + \\iota_{\\mathbb{R}_+^M})^*({\\bm u})\n= \\max_{{\\bm v}\\in \\mathbb{R}^M_+} \\langle {\\bm u}, {\\bm v}\\rangle - \\Omega({\\bm v}).')
('4.0.4.1', '\\max_\\Omega')
('4.0.4.1', '\\delta_\\Omega')
('4.0.4.1', '\\Omega')
('4.0.4.1', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.4.1', '\\begin{aligned}\n\\text{max}_\\Omega({\\bm u})    \n&= \\min_{\\tau \\in \\mathbb{R}} \\tau + \\delta_\\Omega({\\bm u}- \\tau \\operatorname{\\mathbf 1}) \\\\\n&= \\tau^\\star + \\delta_\\Omega({\\bm u}- \\tau^\\star \\operatorname{\\mathbf 1})\n\\end{aligned}')
('4.0.4.1', '\\nabla \\text{max}_\\Omega({\\bm u})    \n= \\nabla \\delta_\\Omega({\\bm u}- \\tau^\\star \\operatorname{\\mathbf 1}),')
('4.0.4.1', '\\tau^\\star')
('4.0.4.1', '\\tau')
('4.0.4.1', '\\min')
('4.0.4.1', '\\langle \\nabla \\delta_\\Omega({\\bm u}- \\tau^\\star \\operatorname{\\mathbf 1}), \\operatorname{\\mathbf 1}\\rangle = 1.')
('4.0.4.1', '\\begin{aligned}\n\\text{max}_\\Omega({\\bm u})\n&= \\max_{{\\bm v}\\in \\triangle^M} \\langle {\\bm u}, {\\bm v}\\rangle - \\Omega({\\bm v}) \\\\\n&= \\max_{{\\bm v}\\in \\mathbb{R}_+^M} \\min_{\\tau \\in \\mathbb{R}} \\langle {\\bm u}, {\\bm v}\\rangle - \\Omega({\\bm v}) \n- \\tau(\\langle {\\bm v}, \\operatorname{\\mathbf 1}\\rangle - 1) \\\\\n&= \\min_{\\tau \\in \\mathbb{R}} \\tau + \\max_{{\\bm v}\\in \\mathbb{R}_+^M} \n\\langle {\\bm u}-  \\tau \\operatorname{\\mathbf 1}, {\\bm v}\\rangle - \\Omega({\\bm v}) \\\\\n&= \\min_{\\tau \\in \\mathbb{R}} \\tau + \\delta_\\Omega({\\bm u}-  \\tau \\operatorname{\\mathbf 1}),\n\\end{aligned}')
('4.0.4.1', '\\min')
('4.0.4.1', '\\max')
('4.0.4.1', '({\\bm u},{\\bm v}) \\mapsto \\langle {\\bm u}, {\\bm v}\\rangle - \\Omega({\\bm v})')
('4.0.4.1', '{\\bm v}\\in \\triangle^M')
('4.0.4.1', '\\nabla \\delta_\\Omega({\\bm u})')
('4.0.4.1', '\\tau \\mapsto \\tau + \\delta_\\Omega({\\bm u}- \\tau \\operatorname{\\mathbf 1})')
('4.0.4.2', '\\Omega')
('4.0.4.2', '\\max_\\Omega')
('4.0.4.2', '\\Omega({\\bm \\pi}) = \\langle {\\bm \\pi}, \\log {\\bm \\pi}\\rangle')
('4.0.4.2', '\\begin{aligned}\n\\mathrm{softmax}({\\bm u})\n&\\coloneqq \\mathrm{max}_\\Omega({\\bm u}) \\\\\n&= \\max_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle - \\Omega({\\bm \\pi}) \\\\\n&= \\mathrm{logsumexp}({\\bm u}) \\\\\n&= \\log \\sum_{j=1}^M e^{u_j}.\n\\end{aligned}')
('4.0.4.2', '\\mathop{\\mathrm{dom}}(\\Omega) = \\mathbb{R}_+^M')
('4.0.4.2', '\\delta_\\Omega = \\Omega^*')
('4.0.4.2', '\\delta_\\Omega({\\bm u}) = \\sum_{j=1}^M \\exp(u_j - 1)')
('4.0.4.2', '\\max_\\Omega({\\bm u}) = \\tau^\\star + \\delta_\\Omega({\\bm u}- \\tau^\\star \\operatorname{\\mathbf 1})')
('4.0.4.2', '\\tau^\\star')
('4.0.4.2', '\\langle \\nabla \\delta_\\Omega({\\bm u}- \\tau^\\star \\operatorname{\\mathbf 1}), \\operatorname{\\mathbf 1}\\rangle = 1.')
('4.0.4.2', '\\nabla \\delta_\\Omega({\\bm u}) = \\exp({\\bm u}- \\operatorname{\\mathbf 1})')
('4.0.4.2', '\\sum_{j=1}^M \\exp(u_j - 1 - \\tau) = 1')
('4.0.4.2', '\\tau^\\star + 1 = \\mathrm{logsumexp}({\\bm u})')
('4.0.4.2', '\\max_\\Omega({\\bm u}) \n= \\mathrm{logsumexp}({\\bm u}) - 1 + \\sum_{j=1}^M\\exp(u_j - \\mathrm{logsumexp}({\\bm u}))\n= \\mathrm{logsumexp}({\\bm u})')
('4.0.4.2', '-\\log M \\le \\Omega({\\bm \\pi}) \\le 0')
('4.0.4.2', '{\\bm \\pi}\\in \\triangle^M')
('4.0.4.2', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.4.2', '\\max({\\bm u}) \\le \\mathrm{softmax}({\\bm u}) \\le \\max({\\bm u}) + \\log M.')
('4.0.4.2', '\\max_\\Omega')
('4.0.4.2', 'a, b, c \\in \\mathbb{R}')
('4.0.4.2', '\\text{softmax}(\\text{softmax}(a, b), c) \n=\n\\text{softmax}(a, \\text{softmax}(b, c)).')
('4.0.4.3', '\\Omega')
('4.0.4.3', '\\Omega({\\bm \\pi}) = \\frac{1}{2} \\langle {\\bm \\pi}, {\\bm \\pi}- \\operatorname{\\mathbf 1}\\rangle')
('4.0.4.3', '\\begin{aligned}\n\\mathrm{sparsemax}({\\bm u})\n&\\coloneqq \\text{max}_\\Omega({\\bm u}) \\\\\n&= \\max_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle - \\Omega({\\bm \\pi}) \\\\\n&= \\langle {\\bm u}, {\\bm \\pi}^\\star \\rangle - \\Omega({\\bm \\pi}^\\star)\n\\end{aligned}')
('4.0.4.3', '{\\bm \\pi}^\\star \n= \\mathrm{sparseargmax}({\\bm u})\n\\coloneqq \\mathop{\\mathrm{arg\\,min}}_{{\\bm \\pi}\\in \\triangle^M} \\|{\\bm u}- {\\bm \\pi}\\|_2^2.')
('4.0.4.3', '\\Omega({\\bm \\pi})')
('4.0.4.3', '\\frac{1}{2}\\|{\\bm \\pi}\\|^2_2')
('4.0.4.3', '\\Omega({\\bm \\pi}) = \\frac{1}{2} \\langle {\\bm \\pi}, {\\bm \\pi}- \\operatorname{\\mathbf 1}\\rangle')
('4.0.4.3', '\\mathrm{sparsemax}({\\bm u})\n= \\text{max}_\\Omega({\\bm u})\n= \\min_{\\tau \\in \\mathbb{R}}\n\\tau + \\frac{1}{2} \\sum_{i=1}^M [u_i - \\tau]_+^2')
('4.0.4.3', '\\tau^\\star')
('4.0.4.3', '\\sum_{i=1}^M [u_i - \\tau]_+ = 1.')
('4.0.4.3', '\\delta_\\Omega({\\bm u}) = \\max_{{\\bm v}\\in \\mathbb{R}_+^M} \\langle {\\bm u}, {\\bm v}\\rangle - \\Omega({\\bm v})')
('4.0.4.3', '{\\bm v}\\mapsto \\langle {\\bm u}, {\\bm v}\\rangle - \\Omega({\\bm v})')
('4.0.4.3', '{\\bm v}^\\star = [{\\bm u}]_+')
('4.0.4.3', '{\\bm v}^\\star')
('4.0.4.3', '\\delta_\\Omega({\\bm u}) = \\frac{1}{2}\n\\sum_{i=1}^M [u_i]_+^2')
('4.0.4.3', '\\tau')
('4.0.4.3', '\\tau^\\star')
('4.0.4.3', '\\tau^\\star \n= \\frac{1}{j^\\star} \\left(\\sum_{i=1}^{j^\\star} u_{[i]} - 1\\right),\n\\label{smoothing:eq:sparsemax_optimal_threshold}')
('4.0.4.3', 'j^\\star')
('4.0.4.3', 'j \\in [M]')
('4.0.4.3', 'u_j - \\frac{1}{j} \\left(\\sum_{i=1}^j u_{[i]} - 1\\right) > 0,')
('4.0.4.3', 'u_{[1]} \\ge u_{[2]} \\ge \\dots \\ge u_{[M]}')
('4.0.4.3', '\\tau^\\star')
('4.0.4.3', '\\tau')
('4.0.4.3', '\\frac{1}{2M} \\le \\|{\\bm \\pi}\\|^2_2 \\le \\frac{1}{2}')
('4.0.4.3', '-\\frac{M-1}{2M} \\le \\|{\\bm \\pi}\\|^2_2 \\le 0')
('4.0.4.3', '{\\bm \\pi}\\in \\triangle^M')
('4.0.4.3', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.4.3', '\\max({\\bm u}) \\le \\mathrm{sparsemax}({\\bm u}) \\le \\max({\\bm u}) + \\frac{M-1}{2M}.')
('4.0.4.3', '\\{{\\bm u}\\in \\mathbb{R}^3: f({\\bm u}) = c\\}')
('4.0.4.3', 'c')
('4.0.4.3', '\\{{\\bm u}\\in \\mathbb{R}^3: u_i = u_j\\ \\text{for any} \\ i\\neq j\\}')
('4.0.4.4', '{\\bm u}= (u, 0) \\in \\mathbb{R}^2')
('4.0.4.4', '\\mathrm{max}_\\Omega((u, 0)) = \\mathrm{relu}_\\Psi(u),')
('4.0.4.4', '\\Psi(\\pi) \\coloneqq \\Omega((\\pi, 1-\\pi))')
('4.0.4.4', '\\Omega')
('4.0.4.4', '\\Psi(\\pi) = \\pi \\log \\pi + (1-\\pi) \\log (1-\\pi)')
('4.0.4.4', '\\Omega')
('4.0.4.4', '\\Psi(\\pi) = \\pi(\\pi-1)')
('4.0.5', '\\mathrm{step}(u)\n\\coloneqq \\begin{cases}\n    1 &\\mbox{ if } u \\ge 0 \\\\\n    0 &\\mbox{ otherwise}\n\\end{cases}.')
('4.0.5', '\\mathrm{step}(u) = \n\\mathop{\\mathrm{arg\\,max}}_{\\pi \\in [0,1]} u \\cdot \\pi.')
('4.0.5', '\\mathrm{step}_\\Omega(u) \\coloneqq \n\\mathop{\\mathrm{arg\\,max}}_{\\pi \\in [0,1]} u \\cdot \\pi - \\Omega(\\pi).')
('4.0.5', '\\Omega')
('4.0.5', '\\mathrm{step}_\\Omega(u)')
('4.0.5', 'u')
('4.0.5', '\\mathrm{step}(u)')
('4.0.5.0', '\\Omega(\\pi) = \\pi \\log \\pi + (1-\\pi) \\log (1-\\pi)')
('4.0.5.0', '\\mathrm{step}_\\Omega(u) =\n\\mathrm{logistic}(u) \\coloneqq \\frac{1}{1 + e^{-u}} = \\frac{e^u}{1 + e^u}.')
('4.0.5.0.0', '\\Omega(\\pi) = \\pi(\\pi - 1)')
('4.0.5.0.0', '\\mathrm{step}_\\Omega(u) =\n\\mathrm{sparsesigmoid}(u) \\coloneqq\n\\begin{cases}\n0, & u \\le -1\\\\\n\\frac{1}{2}(u+1), & -1 < u < 1 \\\\  \n1, & u \\ge 1\n\\end{cases}.')
('4.0.5.0.0', '0')
('4.0.5.0.0', '1')
('4.0.5.0.1', "\\begin{aligned}\n    \\mathrm{step}(u) &= \\mathrm{relu}'(u) \\\\\n    \\mathrm{logistic}(u) &= \\mathrm{softplus}'(u) \\\\\n    \\mathrm{sparsesigmoid}(u) &= \\mathrm{sparseplus}'(u)\n\\end{aligned}")
('4.0.5.0.1', "\\mathrm{relu}_\\Omega'(u) = \\mathrm{step}_\\Omega(u).")
('4.0.6', '\\mathrm{argmax}({\\bm u}) \n\\coloneqq \\phi(\\mathop{\\mathrm{arg\\,max}}_{j \\in [M]} u_j),')
('4.0.6', '\\phi(j) = \\mathrm{onehot}(j) = {\\bm e}_j')
('4.0.6', 'j \\in\n[M]')
('4.0.6', '\\mathbb{R}^M')
('4.0.6', '\\mathrm{argmax}({\\bm u}) = \n\\mathop{\\mathrm{arg\\,max}}_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle\n= \\mathop{\\mathrm{arg\\,max}}_{{\\bm \\pi}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_M\\}} \\langle {\\bm u}, {\\bm \\pi}\\rangle,')
('4.0.6', '\\mathrm{argmax}_\\Omega({\\bm u}) \\coloneqq\n\\mathop{\\mathrm{arg\\,max}}_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle - \\Omega({\\bm \\pi}).')
('4.0.6', '\\mathrm{argmax}_\\Omega({\\bm u})')
('4.0.6', '{\\bm u}')
('4.0.6', '\\Omega')
('4.0.6', '\\mathrm{argmax}_\\Omega({\\bm u}) = \\nabla \\mathrm{max}_\\Omega({\\bm u}).')
('4.0.6.0', '\\Omega({\\bm \\pi}) = \\langle {\\bm \\pi}, \\log {\\bm \\pi}\\rangle')
('4.0.6.0', '\\mathrm{argmax}_\\Omega({\\bm u}) = \n\\mathrm{softargmax}({\\bm u}) =\n\\frac{\\exp({\\bm u})}{\\sum_{j=1}^M \\exp(u_j)},')
('4.0.6.0', '\\max_\\Omega({\\bm u}) = \\mathrm{logsumexp}({\\bm u})')
('4.0.6.0', '\\nabla \\max_\\Omega({\\bm u}) =\n\\mathrm{argmax}_\\Omega({\\bm u})')
('4.0.6.0', '\\mathrm{logsumexp}({\\bm u})')
('4.0.6.0', '\\mathrm{softargmax}({\\bm u})')
('4.0.6.0.0', '\\Omega({\\bm \\pi}) = \\frac{1}{2} \\langle {\\bm \\pi}, {\\bm \\pi}- \\operatorname{\\mathbf 1}\\rangle')
('4.0.6.0.0', '\\frac{1}{2} \\|{\\bm \\pi}\\|^2_2')
('4.0.6.0.0', '\\begin{aligned}\n\\mathrm{argmax}_\\Omega({\\bm u}) \n&= \\mathrm{sparseargmax}({\\bm u}) \\\\\n&\\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle - \n\\frac{1}{2} \\langle {\\bm \\pi}, {\\bm \\pi}- \\operatorname{\\mathbf 1}\\rangle \\\\\n&= \\mathop{\\mathrm{arg\\,max}}_{{\\bm \\pi}\\in \\triangle^M} \\langle {\\bm u}, {\\bm \\pi}\\rangle - \n\\frac{1}{2} \\|{\\bm \\pi}\\|_2^2 \\\\\n&=\\mathop{\\mathrm{arg\\,min}}_{{\\bm \\pi}\\in \\triangle^M} \\|{\\bm u}- {\\bm \\pi}\\|^2_2,\n\\end{aligned}')
('4.0.6.0.0', '\\triangle^M')
('4.0.6.0.0', 'O(M)')
('4.0.6.0.0', 'O(M \\log M)')
('4.0.6.0.0', '\\tau^\\star')
('4.0.6.0.0', '\\mathrm{sparseargmax}({\\bm u}) = [{\\bm u}- \\tau^\\star]_+,')
('4.0.6.0.0', '\\mathrm{argmax}({\\bm u})')
('4.0.6.0.0', '\\mathrm{softargmax}({\\bm u})')
('4.0.6.0.0', '\\mathrm{sparseargmax}({\\bm u})')
('4.0.6.0.0', '{\\bm u}= (u_1, u_2, 0)')
('4.0.6.0.0', 'u_1')
('4.0.6.0.0', 'u_2')
('4.0.6.0.1', '\\mathop{\\mathrm{arg\\,min}}({\\bm u}) = \\mathop{\\mathrm{arg\\,max}}(-{\\bm u}).')
('4.0.6.0.1', '\\mathrm{argmax}_\\Omega')
('4.0.6.0.1', '\\mathrm{argmin}_\\Omega({\\bm u}) \\coloneqq \n\\mathrm{argmax}_\\Omega(-{\\bm u}).')
('4.0.6.0.1', '{\\bm u}\\in \\mathbb{R}^M')
('4.0.6.0.1', '\\mathrm{argmin}_\\Omega({\\bm u}) = \\nabla \\text{min}_\\Omega({\\bm u}).')
('4.0.7', 'f')
('4.0.7', 'f')
('4.0.7', 'R')
('4.0.7', 'R = \\frac{1}{2}\n\\|\\cdot\\|_2^2')
('4.0.7', 'f^*')
('4.0.7', 'f')
('4.0.7', '\\Omega')
('4.0.7', 'R = \\Omega^*')
('4.0.7', 'f')
('4.0.7', '({\\bm u}, f({\\bm u}))')
('4.0.7', '{\\bm u}\\in \\mathop{\\mathrm{dom}}(f)')
('4.0.7', '{\\bm v}')
('4.0.7', '-f^*({\\bm v})')
('4.0.7', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(f^*)')
('4.1.0.0', 'f')
('4.1.0.0', 'g')
('4.1.0.0', 'f \\ast g')
('4.1.0.0', '(f \\ast g)(\\mu) \\coloneqq \\int_{-\\infty}^\\infty f(u) g(\\mu - u) \\, du,\n\\label{conv:eq:conv_def}')
('4.1.0.0', 'f')
('4.1.0.0', 'g')
('4.1.0.0', 'g')
('4.1.0.0', 'y')
('4.1.0.0', 'z\n\\coloneqq \\mu - u')
('4.1.0.0', '(f \\ast g)(\\mu) \n= \\int_{-\\infty}^\\infty f(\\mu - z) g(z) \\, dz\n= (g \\ast f)(\\mu).\n\\label{conv:eq:conv_def2}')
('4.1.0.1', '\\kappa')
('4.1.0.1', 'f \\ast \\kappa')
('4.1.0.1', 'f')
('4.1.0.1', '\\sigma')
('4.1.0.1', '\\kappa_\\sigma(z) \n\\coloneqq \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-\\frac{1}{2}(\\frac{z}{\\sigma})^2}.')
('4.1.0.1', '\\sigma^2')
('4.1.0.1', '\\frac{1}{\\sqrt{2\\pi}\\sigma}')
('4.1.0.1', '1')
('4.1.0.1', '\\sigma')
('4.1.0.1', '\\kappa_\\sigma')
('4.1.0.1.0', '\\begin{aligned}\n(f \\ast \\kappa_\\sigma)(\\mu)\n&\\coloneqq \n\\frac{1}{\\sqrt{2\\pi}\\sigma}\n\\int_{-\\infty}^\\infty f(u) e^{-\\frac{1}{2} (\\frac{\\mu -\nu}{\\sigma})^2} du \\\\\n&= \\mathbb{E}_{U \\sim p_{\\mu,\\sigma}}[f(U)],\n\\end{aligned}')
('4.1.0.1.0', 'p_{\\mu,\\sigma}(u) \n\\coloneqq \\kappa_\\sigma(\\mu - u)\n= \\kappa_\\sigma(z)\n= \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-\\frac{1}{2} (\\frac{\\mu - u}{\\sigma})^2}')
('4.1.0.1.0', '\\mu')
('4.1.0.1.0', '\\sigma^2')
('4.1.0.1.0', 'f \\ast \\kappa_\\sigma')
('4.1.0.1.0', 'f(u)')
('4.1.0.1.0', '\\mu')
('4.1.0.1.0', '\\mu')
('4.1.0.1.0', '\\sigma')
('4.1.0.1.0', 'f({\\bm u})')
('4.1.0.1.0', '\\mathbb{E}[f(U)]')
('4.1.0.1.1', '\\begin{aligned}\n(f \\ast \\kappa_\\sigma)(\\mu)\n&\\coloneqq \\int_{-\\infty}^\\infty f(\\mu - z)\ne^{-\\frac{1}{2} (\\frac{z}{\\sigma})^2} dz \\\\\n&= \\mathbb{E}_{Z \\sim p_{0,\\sigma}}[f(\\mu - Z)] \\\\\n&= \\mathbb{E}_{Z \\sim p_{0,\\sigma}}[f(\\mu + Z)],\n\\end{aligned}')
('4.1.0.1.1', 'p_{0,\\sigma}')
('4.1.0.1.1', 'p_{0,\\sigma}(z) = p_{0,\\sigma}(-z)')
('4.1.0.1.2', '\\sigma \\to 0')
('4.1.0.1.2', '\\kappa_\\sigma')
('4.1.0.1.2', '\\lim_{\\sigma \\to 0} \\kappa_\\sigma(z) = \\delta(z).')
('4.1.0.1.2', '\\sigma \\to 0')
('4.1.0.1.2', 'f \\ast \\kappa_\\sigma')
('4.1.0.1.2', 'f')
('4.1.0.1.2', '\\lim_{\\sigma \\to 0} (f \\ast \\kappa_\\sigma)(u) = f(u).')
('4.1.0.2', 'f')
('4.1.0.2', 'g')
('4.1.0.2', '\\mathbb{Z}')
('4.1.0.2', '(f \\ast g)[i] \\coloneqq \\sum_{j=-\\infty}^\\infty f[j] g[i - j].')
('4.1.0.2', '(f \\ast g)[i] = \\sum_{j=-\\infty}^\\infty f[i - j] g[j] = (g \\ast f)[i].')
('4.1.0.2', 'g')
('4.1.0.2', 'S \\coloneqq \\{-M, -M+1, \\dots, 0, \\dots, M-1, M\\}')
('4.1.0.2', 'g[i] = 0')
('4.1.0.2', 'i \\not \\in S')
('4.1.0.2', '(f \\ast g)[i] = \\sum_{j=-M}^M f[i - j] g[j] = (g \\ast f)[i].')
('4.1.0.2', 'f \\colon \\mathbb{Z}\\to \\mathbb{R}')
('4.1.0.2', '\\kappa \\colon \\mathbb{R}\\to \\mathbb{R}')
('4.1.0.2', '1')
('4.1.0.2', '0')
('4.1.0.2', 'f[t] \\coloneqq t^2 + 0.3 \\sin(6\\pi t)')
('4.1.0.3', "(f \\ast g)' = (f' \\ast g) = (f \\ast g'),")
('4.1.0.3', 'g')
('4.1.0.3', 'n')
('4.1.0.3', '\\mathbb{R}')
('4.1.0.3', 'f')
('4.1.0.3', '\\mathbb{R}')
('4.1.0.3', 'f \\ast g')
('4.1.0.3', 'n')
('4.1.0.3', '\\mathbb{R}')
('4.1.0.4', 'f \\colon\n\\mathbb{R}^M \\to \\mathbb{R}')
('4.1.0.4', 'g \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('4.1.0.4', '(f \\ast g)({\\bm \\mu}) \\coloneqq \\int_{\\mathbb{R}^M} f({\\bm u}) g({\\bm \\mu}- {\\bm u}) \\, d{\\bm u},')
('4.1.0.4', '\\begin{aligned}\n\\kappa_\\sigma({\\bm z}) \n&\\coloneqq \n\\prod_{j=1}^M\n\\frac{1}{\\sqrt{2\\pi}\\sigma_j}\ne^{-\\frac{1}{2}(\\frac{z_j}{\\sigma_j})^2} = \\frac{1}{\\sqrt{2\\pi}^M\\sigma^M}\ne^{-\\frac{1}{2}\\frac{\\|{\\bm z}\\|^2_2}{\\sigma^2}},\n\\label{conv:eq:gaussian_kernel_diag_cov}\n\\end{aligned}')
('4.1.0.4', '\\sigma_1 = \\dots = \\sigma_M')
('4.1.0.4', 'M=2')
('4.1.0.5', '(f \\square g)({\\bm \\mu}) \\coloneqq \\inf_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u}) + g({\\bm \\mu}- {\\bm u}).')
('4.1.0.5', '(F \\ast G)({\\bm \\mu}) \\coloneqq \\int_{\\mathbb{R}^M} F({\\bm u}) G({\\bm \\mu}- {\\bm u}) \\, d{\\bm u}.')
('4.1.0.5', 'f')
('4.1.0.5', 'g')
('4.1.0.5', 'F')
('4.1.0.5', 'G')
('4.1.0.6', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('4.1.0.6', 'g \\colon\n\\mathbb{R}^M \\to \\mathbb{R}')
('4.1.0.6', '(f \\square_\\varepsilon g)({\\bm \\mu}) \\coloneqq\n\\underset{{\\bm u}\\in \\mathbb{R}^M}{\\mathrm{softmin}_\\varepsilon} ~\nf({\\bm u}) + g({\\bm \\mu}- {\\bm u}),')
('4.1.0.6', '\\mathcal{S}')
('4.1.0.6', 'h \\colon \\mathcal{S}\\to \\mathbb{R}')
('4.1.0.6', '\\underset{{\\bm u}\\in \\mathcal{S}}{\\mathrm{softmin}_\\varepsilon} ~ h({\\bm u})\n\\coloneqq -\\varepsilon \\log \\int_{\\mathcal{S}} \n\\exp\\left(-h({\\bm u}) / \\varepsilon \\right) d{\\bm u}.')
('4.1.0.6', '\\varepsilon \\to 0')
('4.1.0.6.0', '\\begin{aligned}\n\\mathcal{C}_\\varepsilon\\{f\\}({\\bm u}) &\\coloneqq  \\exp(-f({\\bm u}) / \\varepsilon) \\\\\n\\mathcal{C}_\\varepsilon^{-1}\\{F\\}({\\bm v}) &= -\\varepsilon \\log F({\\bm v}),\n\\end{aligned}')
('4.1.0.6.0', '\\begin{aligned}\nF_\\varepsilon &\\coloneqq \\mathcal{C}_\\varepsilon\\{f\\} \\\\\nG_\\varepsilon &\\coloneqq \\mathcal{C}_\\varepsilon\\{g\\} \\\\\nH_\\varepsilon &\\coloneqq \\mathcal{C}_\\varepsilon\\{h_\\varepsilon\\}.\n\\end{aligned}')
('4.1.0.6.0', 'H_\\varepsilon({\\bm \\mu}) = (F_\\varepsilon \\ast G_\\varepsilon)({\\bm \\mu}).')
('4.1.0.6.0', 'h_\\varepsilon({\\bm \\mu}) = \\mathcal{C}_\\varepsilon^{-1}\\{H_\\varepsilon\\}({\\bm \\mu}).')
('4.1.0.6.0', '\\begin{aligned}\nh_\\varepsilon({\\bm \\mu}) \n=  \\mathcal{C}_\\varepsilon^{-1}\\{\\mathcal{C}_\\varepsilon\\{f\\} \\ast \\mathcal{C}_\\varepsilon\\{g\\}\\}({\\bm \\mu}).\n\\end{aligned}')
('4.1.0.6.0', 'n')
('4.1.0.6.0', 'O(n \\log n)')
('4.1.0.7', 'f')
('4.1.0.7', 'R(z) = \\frac{1}{2} z^2')
('4.1.0.7', 'M_f({\\bm \\mu}) \n\\coloneqq (f \\square R)({\\bm \\mu})\n= \\inf_{{\\bm u}\\in \\mathbb{R}^M} f({\\bm u}) + \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|^2_2.')
('4.1.0.7', 'M_f^\\varepsilon({\\bm \\mu}) \n\\coloneqq (f \\square_\\varepsilon R)({\\bm \\mu})\n= \\underset{{\\bm u}\\in \\mathbb{R}^M}{\\mathrm{softmin}_\\varepsilon} ~ f({\\bm u}) + \\frac{1}{2}\n\\|{\\bm \\mu}- {\\bm u}\\|^2_2.')
('4.1.0.7', 'f')
('4.1.0.7', '\\begin{aligned}\nM_f^\\varepsilon({\\bm \\mu}) =\n-\\varepsilon \\log \\int_{\\mathbb{R}^M} \n\\exp\\left((-f({\\bm u}) - \\frac{1}{2} \\|{\\bm \\mu}- {\\bm u}\\|_2^2) / \\varepsilon \\right) d{\\bm u}.\n\\end{aligned}')
('4.1.0.7', '\\begin{aligned}\n(f \\ast \\kappa_\\sigma)({\\bm \\mu}) \\coloneqq \\int_{\\mathbb{R}^M} \nf({\\bm u}) \\kappa_\\sigma({\\bm \\mu}- {\\bm u}) \\, d{\\bm u},\n\\end{aligned}')
('4.1.0.7', '\\kappa_\\sigma')
('4.1.1', 'f')
('4.1.1', 'F(s) \n\\coloneqq \\mathcal{F}\\{f\\}(s) \n\\coloneqq \\int_{-\\infty}^{\\infty}f(t) e^{-i 2 \\pi s t} \\, dt, \\quad s \\in \\mathbb{R}.')
('4.1.1', '\\mathcal{F}\\{f\\}')
('4.1.1', 'f')
('4.1.1', 'F')
('4.1.1.0', 'h(t) \\coloneqq (f \\ast g)(t).')
('4.1.1.0', '\\begin{aligned}\n    F &\\coloneqq \\mathcal{F}\\{f\\}, \\\n    G \\coloneqq \\mathcal{F}\\{g\\}, \\\n    H \\coloneqq \\mathcal{F}\\{h\\},\n\\end{aligned}')
('4.1.1.0', 'H(s) = \\mathcal{F}\\{h\\}(s) = F(s) \\cdot G(s), \\quad s \\in \\mathbb{R}.')
('4.1.1.0', '\\mathcal{F}\\{f \\ast g\\} = \\mathcal{F}\\{f\\} \\cdot \\mathcal{F}\\{g\\}.')
('4.1.1.0', 'h(t) = (f*g)(t) = \\mathcal{F}^{-1}\\{F \\cdot G\\}(t), \\quad t \\in \\mathbb{R}.')
('4.1.1.1', '\\mathcal{F}\\{f \\ast g\\} = \\mathcal{F}\\{f\\} \\cdot \\mathcal{F}\\{g\\}.')
('4.1.1.1', '(f \\square g)^* = f^* + g^*.')
('4.1.1.1', '\\mathcal{F}\\{f\\}')
('4.1.1.1', 'f^*')
('4.1.1.1', '(+, \\cdot)')
('4.1.1.1', '(\\min, +)')
('4.1.1.1', '(a > 0)')
('4.1.1.1', 'f(t) = g(t / a)')
('4.1.1.1', 'f(t) = a g(t/a)')
('4.1.1.1', '\\mathcal{F}\\{f\\}(t) = a\\mathcal{F}\\{g\\}(as)')
('4.1.1.1', 'f^*(s) = a g^*(s)')
('4.1.1.1', 'f(t) = g(t - t_0)')
('4.1.1.1', 'f(t) = g(t - t_0)')
('4.1.1.1', '\\mathcal{F}\\{f\\}(s) = e^{-i 2 \\pi t_0 s} \\mathcal{F}\\{g\\}(s)')
('4.1.1.1', 'f^*(s) = g^*(s) + t_0')
('4.1.1.1', 'h = f \\ast g')
('4.1.1.1', 'h = f \\square g')
('4.1.1.1', '\\mathcal{F}\\{h\\} = \\mathcal{F}\\{f\\} \\cdot \\mathcal{F}\\{g\\}')
('4.1.1.1', 'h^* = f^* + g^*')
('4.1.1.1', 'f(t) = e^{-at^2}')
('4.1.1.1', 'f(t) = \\frac{a}{2} t^2')
('4.1.1.1', '\\mathcal{F}\\{f\\}(s) = \\sqrt{\\frac{\\pi}{a}} e^{-\\pi^2 s^2/a}')
('4.1.1.1', 'f^*(s) = \\frac{1}{2a} s^2')
('4.1.1.1', 'f \\ast \\kappa_\\sigma')
('4.1.1.1', 'f \\square \\frac{1}{2\\varepsilon} \\|\\cdot\\|^2_2')
('4.1.1.2', 'f \\colon \\mathbb{R}^M \\to \\mathbb{R}')
('4.1.1.2', 'f^*({\\bm v}) \n\\coloneqq \\max_{{\\bm u}\\in \\mathbb{R}^M} ~ \\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}).')
('4.1.1.2', 'f')
('4.1.1.2', 'f^*_\\varepsilon({\\bm v})\n\\coloneqq \n\\underset{{\\bm u}\\in \\mathbb{R}^M}{\\mathrm{softmax}_\\varepsilon} ~\n\\langle {\\bm u}, {\\bm v}\\rangle - f({\\bm u}),')
('4.1.1.2', '\\mathcal{S}')
('4.1.1.2', 'g \\colon \\mathcal{S}\\to \\mathbb{R}')
('4.1.1.2', '\\underset{{\\bm u}\\in \\mathcal{S}}{\\mathrm{softmax}_\\varepsilon} ~ g({\\bm u})\n\\coloneqq \\varepsilon \\log \\int_{\\mathcal{S}} \n\\exp\\left(g({\\bm u}) / \\varepsilon \\right) d{\\bm u}.')
('4.1.1.2', '\\varepsilon \\to 0')
('4.1.1.2.0', 'f')
('4.1.1.2.0', 'f^*_\\varepsilon({\\bm v})\n= \\mathcal{Q}_\\varepsilon^{-1}\\left\\{\\frac{1}{\\mathcal{Q}_\\varepsilon\\{f\\} \\ast\nG_\\varepsilon}\\right\\}\\left({\\bm v}\\right)')
('4.1.1.2.0', '\\begin{aligned}\nG_\\varepsilon\n&\\coloneqq \n\\mathcal{C}_\\varepsilon\\left\\{\\frac{1}{2} \\|\\cdot\\|^2_2\\right\\}\n= \\exp\\left(-\\frac{1}{2} \\frac{\\|\\cdot\\|^2_2}{\\varepsilon}\\right) \\\\\n\\mathcal{Q}_\\varepsilon\\{f\\}\n&\\coloneqq \n\\mathcal{C}_\\varepsilon\\left\\{f(\\cdot) - \\frac{1}{2} \\|\\cdot\\|^2_2\\right\\} =\n\\exp\\left(\\frac{1}{2\\varepsilon} \\|\\cdot\\|^2_2 -\n\\frac{1}{\\varepsilon}f(\\cdot)\\right) \\\\\n\\mathcal{Q}_\\varepsilon^{-1}\\{F\\}\n&\\coloneqq \\frac{1}{2} \\|\\cdot\\|^2_2 - \\varepsilon \\log(F(\\cdot)).\n\\end{aligned}')
('4.1.1.2.0', '\\begin{small}\n\\begin{aligned}\nf_\\varepsilon({\\bm v}) &\\coloneqq \n\\varepsilon \\log \\int \\exp\\left(\\frac{1}{\\varepsilon} \\langle {\\bm u}, {\\bm v}\\rangle -\n\\frac{1}{\\varepsilon} f({\\bm u}))\\right) d{\\bm u}\\\\\n&= \\varepsilon \\log \\int \\exp\\left(-\\frac{1}{2\\varepsilon} \\|{\\bm u}- {\\bm v}\\|^2_2 +\n    \\frac{1}{2\\varepsilon} \\|{\\bm u}\\|^2_2 + \\frac{1}{2\\varepsilon}\\|{\\bm v}\\|^2_2 \n    - \\frac{1}{\\varepsilon} f({\\bm u}))\\right) d{\\bm u}\\\\\n&= \\varepsilon \\log \\int \\exp\\left(-\\frac{1}{2\\varepsilon} \\|{\\bm u}- {\\bm v}\\|^2_2 +\n    \\frac{1}{2\\varepsilon} \\|{\\bm u}\\|^2_2 - \\frac{1}{\\varepsilon} f({\\bm u}))\\right) d{\\bm u}\n    + \\frac{1}{2} \\|{\\bm v}\\|^2_2 \\\\\n&= \\varepsilon \\log \\int G_\\varepsilon({\\bm v}- {\\bm u}) \\mathcal{Q}_\\varepsilon\\{f\\}({\\bm u}) d{\\bm u}\n+ \\frac{1}{2} \\|{\\bm v}\\|^2_2 \\\\\n&= \\varepsilon \\log (\\mathcal{Q}_\\varepsilon\\{f\\} \\ast G_\\varepsilon)({\\bm v}) \n+ \\frac{1}{2} \\|{\\bm v}\\|^2 \\\\\n&=  \\frac{1}{2} \\|{\\bm v}\\|^2 -\n\\varepsilon \\log \n\\left(\\frac{1}{\\mathcal{Q}_\\varepsilon\\{f\\} \\ast G_\\varepsilon}\\right)({\\bm v}) \\\\\n&= \\mathcal{Q}_\\varepsilon^{-1}\\left\\{\\frac{1}{\\mathcal{Q}_\\varepsilon\\{f\\} \\ast\nG_\\varepsilon}\\right\\}\\left({\\bm v}\\right)\n\\end{aligned}\n\\end{small}')
('4.1.1.2.0', '\\mathbb{R}^M')
('4.1.1.2.0', '\\mathcal{S}')
('4.1.1.2.0', 'O(n \\log n)')
('4.1.1.2.0', 'n = |\\mathcal{S}|')
('4.1.1.2.0', '\\begin{aligned}\n(\\mathcal{Q}_\\varepsilon\\{f\\} \\ast G_\\varepsilon)({\\bm v})\n&\\approx \\sum_{{\\bm u}\\in \\mathcal{S}} G_\\varepsilon({\\bm v}- {\\bm u}) \\mathcal{Q}_\\varepsilon\\{f\\}({\\bm u}) \\\\\n&= {\\bm K}{\\bm q},\n\\end{aligned}')
('4.1.1.2.0', '{\\bm K}')
('4.1.1.2.0', 'n \\times n')
('4.1.1.2.0', "\\exp(-\\frac{1}{2\\varepsilon} \\|{\\bm u}- {\\bm u}'\\|^2_2)")
('4.1.1.2.0', "{\\bm u},{\\bm u}' \\in \\mathcal{S}")
('4.1.1.2.0', '{\\bm q}')
('4.1.1.2.0', 'n')
('4.1.1.2.0', '\\exp(\\frac{1}{\\varepsilon}(\\frac{1}{2} \\|{\\bm v}\\|^2_2 - f({\\bm u}))')
('4.1.1.2.0', '{\\bm u}\\in \\mathcal{S}')
('4.1.1.2.0', '\\begin{aligned}\nf^*_\\varepsilon(v) \n&= \\varepsilon \\log \\int_{-\\infty}^\\infty \\exp\\left(\\frac{1}{\\varepsilon}\\left[\nuv - f(u)\\right])\\right) du \\\\\n&= \\varepsilon \\log\n\\mathcal{B}\\left\\{e^{-\\frac{f}{\\varepsilon}}\\right\\}\\left(-\\frac{v}{\\varepsilon}\\right)\n\\\\\n&= \n-\\mathcal{C}^{-1}_\\varepsilon\\left\\{\\mathcal{B}\\left\\{\\mathcal{C}_\\varepsilon\\{f\\}\\right\\}\\right\\}\n\\left(-\\frac{v}{\\varepsilon}\\right)\n\\end{aligned}')
('4.1.1.2.0', '\\mathcal{B}\\{g\\}(v) \\coloneqq \\int_{-\\infty}^\\infty e^{-uv} g(u) du')
('4.1.2.0', '\\mathrm{step}(u) \\coloneqq h(u)\n\\coloneqq \\begin{cases}\n    1 &\\mbox{ if } u \\ge 0 \\\\\n    0 &\\mbox{ otherwise}\n\\end{cases}.')
('4.1.2.0', '\\begin{aligned}\n(h \\ast \\kappa_\\sigma)(\\mu)\n&= \\int_{-\\infty}^\\mu \\kappa_\\sigma(z) h(\\mu - z) dz\n+ \\int_{\\mu}^\\infty \\kappa_\\sigma(z) h(\\mu - z) dz \\\\\n&= \\int_{-\\infty}^\\mu \\kappa_\\sigma(z) dz \\\\\n&= \\Phi_\\sigma(\\mu) \\\\\n&= \\frac{1}{2} \\left[1 +\n\\mathrm{erf}\\left(\\frac{\\mu}{\\sqrt{2}\\sigma}\\right)\\right],\n\\end{aligned}')
('4.1.2.0', '\\Phi_\\sigma(\\mu)')
('4.1.2.0', '\\sigma^2')
('4.1.2.0', '\\operatorname{erf}(z) \n\\coloneqq \\frac{2}{\\sqrt\\pi}\\int_0^z e^{-t^2}\\,\\mathrm dt,')
('4.1.2.1', 'r(u)\n\\coloneqq \\begin{cases}\n    u &\\mbox{ if } u \\ge 0 \\\\\n    0 &\\mbox{ otherwise}\n\\end{cases}\n= u \\cdot h(u).')
('4.1.2.1', '\\begin{aligned}\n(r \\ast \\kappa_\\sigma)(\\mu)\n&= \\int_{-\\infty}^\\mu \\kappa_\\sigma(z) r(\\mu - z) dz \\\\\n&= \\int_{-\\infty}^\\mu \\kappa_\\sigma(z) (\\mu - z) dz \\\\\n&= \\mu \\int_{-\\infty}^\\mu \\kappa_\\sigma(z) z - \n\\int_{-\\infty}^\\mu \\kappa_\\sigma(z) z dz \\\\\n&= \\mu \\Phi_\\sigma(\\mu) + \\sigma^2 \\kappa_\\sigma(\\mu).\n\\end{aligned}')
('4.1.2.1', 'a \\coloneqq \\frac{1}{2\\sigma^2}')
('4.1.2.1', '\\int z e^{-a z^2} dz\n= -\\frac{1}{2a} \\int e^t d t\n= -\\frac{1}{2a} e^t + C \n= -\\frac{1}{2a} e^{-a z^2} + C')
('4.1.2.1', 't \\coloneqq -a z^2 \\Rightarrow z dz = -\\frac{1}{2a} d t')
('4.1.2.1', '\\sigma')
('4.1.2.1', "(r \\ast \\kappa_\\sigma)' = (r' \\ast \\kappa_\\sigma) = h \\ast \\kappa_\\sigma = \\Phi_\\sigma.")
('4.1.2.1', "(r \\ast \\kappa_\\sigma)'' \n= (h \\ast \\kappa_\\sigma)' \n= (h' \\ast \\kappa_\\sigma) \n= \\delta \\ast \\kappa_\\sigma \n= \\kappa_\\sigma,")
('4.1.2.1', "h'")
('4.1.2.1', 'h \\ast \\kappa_\\sigma = \\Phi_\\sigma')
('4.1.2.1', "\\Phi_\\sigma' = \\kappa_\\sigma")
('4.1.2.1', '\\Phi_\\sigma')
('4.1.2.1', '\\kappa_\\sigma')
('4.1.2.1', '\\sigma^2')
('4.1.3.0', 'f: \\mathbb{R}^M\\rightarrow \\mathbb{R}')
('4.1.3.0', '{\\bm \\mu}')
('4.1.3.0', 'Z \\sim p')
('4.1.3.0', 'p')
('4.1.3.0', 'f_\\sigma({\\bm \\mu}) \\coloneqq \\mathbb{E}_{Z\\sim p}[f({\\bm \\mu}+ \\sigma Z)].')
('4.1.3.0', '\\sigma')
('4.1.3.0', '\\sigma \\rightarrow 0')
('4.1.3.0', 'f')
('4.1.3.0', 'U \\coloneqq {\\bm \\mu}+ \\sigma Z.')
('4.1.3.0', 'U \\sim p_{{\\bm \\mu}, \\sigma},')
('4.1.3.0', 'p_{{\\bm \\mu}, \\sigma}')
('4.1.3.0', 'p')
('4.1.3.0', 'Z')
('4.1.3.0', 'p')
('4.1.3.0', 'p = p_{{\\mathbf{0}},1}')
('4.1.3.0', '\\begin{aligned}\n  f_\\sigma({\\bm \\mu})\n  &= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[f({\\bm \\mu}+ \\sigma \\cdot Z)] \n  \\nonumber\n  \\\\\n  &= \\mathbb{E}_{U \\sim p_{{\\bm \\mu},\\sigma}}[f(U)].\n  \\label{perturb:eq:smooth_perturb2}\n\\end{aligned}')
('4.1.3.0', '\\begin{aligned}\n  f_\\sigma({\\bm \\mu}) & = \\int f({\\bm \\mu}+ \\sigma {\\bm z}) p_{{\\mathbf{0}},1}({\\bm z}) d{\\bm z}\\\\\n  & = f \\ast \\kappa_\\sigma({\\bm \\mu}),\n\\end{aligned}')
('4.1.3.0', '\\kappa_\\sigma({\\bm z}) \n\\coloneqq \np_{{\\mathbf{0}}, \\sigma}(-{\\bm z}).')
('4.1.3.0', 'p_{{\\mathbf{0}},1}({\\bm z}) \\coloneqq \\exp(-\\nu({\\bm z})) / C,')
('4.1.3.0', '\\nu({\\bm z})')
('4.1.3.0', 'C')
('4.1.3.0', '\\nu({\\bm z}) = \\frac{1}{2} \\|{\\bm z}\\|^2_2')
('4.1.3.0', 'C=\\sqrt{2\\pi}^M')
('4.1.3.0.0', 'f_\\sigma({\\bm \\mu})')
('4.1.3.1', 'f')
('4.1.3.1', '\\label{perturb:eq:expected_grad}\n  \\nabla f_\\sigma({\\bm \\mu}) = \n  \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[\\nabla f({\\bm \\mu}+ \\sigma \\cdot Z)].')
('4.1.3.1', 'f')
('4.1.3.1', 'f')
('4.1.3.1', '\\nabla f')
('4.1.3.1', 'f_\\sigma')
('4.1.3.1', 'f')
('4.1.3.1', 'f')
('4.1.3.1', 'f_\\sigma')
('4.1.3.1', 'f_{\\sigma}')
('4.1.3.1', 'U =\n{\\bm \\mu}+\\sigma Z')
('4.1.3.1', '\\begin{aligned}\n\\nabla f_\\sigma({\\bm \\mu}) \\nonumber\n&= \\nabla_{\\bm \\mu}\\mathbb{E}_{U \\sim p_{{\\bm \\mu},\\sigma}}[f(U)] \\nonumber \\\\\n&= \\nabla_{\\bm \\mu}\\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[f({\\bm \\mu}+ \\sigma \\cdot Z)] \\nonumber \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[\\nabla_{\\bm \\mu}f({\\bm \\mu}+ \\sigma \\cdot Z)] \\nonumber \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[\\nabla f({\\bm \\mu}+ \\sigma \\cdot Z)].\n\\label{perturb:eq:grad_pge}\n\\end{aligned}')
('4.1.3.2', '\\nabla f')
('4.1.3.2', 'f')
('4.1.3.2', 'f_\\sigma({\\bm \\mu})  = \\mathbb{E}_{U \\sim p_{{\\bm \\mu},\\sigma}}[f(U)]')
('4.1.3.2', '\\nabla f_\\sigma({\\bm \\mu}) \n= \\mathbb{E}_{U \\sim p_{{\\bm \\mu}, \\sigma}}[f(U) \\nabla_{{\\bm \\mu}} \\log p_{{\\bm \\mu},\\sigma}(U)].')
('4.1.3.2', 'p_{{\\bm \\mu},\\sigma}({\\bm u}) \n= \\frac{1}{\\sigma} p_{{\\mathbf{0}},1}(({\\bm u}- {\\bm \\mu}) / \\sigma),')
('4.1.3.2', 'p_{{\\mathbf{0}},1}({\\bm z}) \\coloneqq \\exp(-\\nu({\\bm z})) / C,')
('4.1.3.2', '\\nabla_{\\bm \\mu}\\log p_{{\\bm \\mu},\\sigma}({\\bm u})\n= \\nabla \\nu(({\\bm u}- {\\bm \\mu}) / \\sigma) / \\sigma.')
('4.1.3.2', '\\begin{aligned}\n\\nabla f_\\sigma({\\bm \\mu}) \n&= \\mathbb{E}_{U \\sim p_{{\\bm \\mu}, \\sigma}}[f(U) \\nabla \\nu((U - {\\bm \\mu}) / \\sigma) /\n\\sigma] \\nonumber \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}[f({\\bm \\mu}+ \\sigma \\cdot Z)\n\\nabla \\nu(Z) / \\sigma],\n\\label{perturb:eq:gradient_sfe}\n\\end{aligned}')
('4.1.3.2', 'Z = (U - {\\bm \\mu}) / \\sigma')
('4.1.3.2', '{\\bm \\theta}= ({\\bm \\mu}, \\sigma)')
('4.1.3.2', '\\nabla \\nu({\\bm z}) = {\\bm z}')
('4.1.3.2', '\\begin{aligned}\n\\nabla f_\\sigma({\\bm \\mu}) \n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}[f({\\bm \\mu}+ \\sigma \\cdot Z) Z / \\sigma].\n\\end{aligned}')
('4.1.3.2', 'f_\\sigma')
('4.1.3.2', 'f')
('4.1.3.3', 'p')
('4.1.3.3', '\\begin{aligned}\n\\mathbb{E}_{Z \\sim p} [h(Z) \\nabla \\log p(Z)]\n&= \\int_{\\mathbb{R}^M} h({\\bm z}) \\left(\\frac{\\nabla p({\\bm z})}{p({\\bm z})}\\right) p({\\bm z}) d{\\bm z}\\\\\n&= \\int_{\\mathbb{R}^M} h({\\bm z}) \\nabla p({\\bm z}) d{\\bm z}.\n\\end{aligned}')
('4.1.3.3', 'h({\\bm z})p({\\bm z})')
('4.1.3.3', '\\|{\\bm z}\\| \\to \\infty')
('4.1.3.3', '\\int_{\\mathbb{R}^M} h({\\bm z}) \\nabla p({\\bm z}) d{\\bm z}\n=\n-\\int_{\\mathbb{R}^M} p({\\bm z}) \\nabla h({\\bm z}) d{\\bm z}.')
('4.1.3.3', '\\mathbb{E}_{Z \\sim p} [h(Z) \\nabla \\log p(Z)]\n= -\\mathbb{E}_{Z \\sim p}[\\nabla h(Z)].')
('4.1.3.3', '{\\bm z}')
('4.1.3.3', 'h({\\bm z}) \\coloneqq f({\\bm \\mu}+ \\sigma \\cdot {\\bm z})')
('4.1.3.3', '\\nabla h({\\bm z}) = \\nabla f({\\bm \\mu}+ \\sigma \\cdot {\\bm z}) \\cdot \\sigma')
('4.1.3.3', '\\begin{aligned}\n\\nabla f_\\sigma({\\bm \\mu})\n&= \\nabla_{\\bm \\mu}\\mathbb{E}_{U \\sim p_{{\\bm \\mu},\\sigma}}[f(U)] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[\\nabla f({\\bm \\mu}+ \\sigma \\cdot Z)]\n\\quad \\text{(reparametrization trick)}\\\\\n&= -\\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[h(Z) \\nabla \\log p(Z) / \\sigma] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[h(Z) \\nabla \\nu(Z) / \\sigma] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[f({\\bm \\mu}+ \\sigma \\cdot Z) \\nabla \\nu(Z) / \\sigma]\n\\quad \\text{(score function estimator)}\n\\end{aligned}')
('4.1.3.4', '\\nabla\n\\nu(Z)')
('4.1.3.4', 'Z \\sim p_{{\\mathbf{0}}, 1}')
('4.1.3.4', '\\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}[f({\\bm \\mu}) \\nabla \\nu(Z) / \\sigma] \n= f({\\bm \\mu}) \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}[\\nabla \\nu(Z) / \\sigma] \n= {\\mathbf{0}}')
('4.1.3.4', '\\label{perturb:eq:finite_diff}\n\\nabla f_\\sigma({\\bm \\mu}) \n= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}\\left[(f({\\bm \\mu}+ \\sigma \\cdot Z)\n- f({\\bm \\mu})) \\nabla \\nu(Z) / \\sigma\\right].')
('4.1.3.4', 'Z')
('4.1.3.4', '\\nabla f_\\sigma({\\bm \\mu}) \n= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}\\left[(f({\\bm \\mu}+ \\sigma \\cdot Z)\n- f({\\bm \\mu}- \\sigma \\cdot Z)) \\nabla \\nu(Z) / (2 \\sigma)\\right].\n\\label{perturb:eq:central_diff}')
('4.1.3.4', 'Z')
('4.1.3.4', '-Z')
('4.1.3.4', '|\\nabla f(\\mu) - \\nabla f_\\sigma(\\mu)|')
('4.1.3.4', 'f(u) \\coloneqq u^3')
('4.1.3.4', 'f_\\sigma(\\mu) \\coloneqq \\mathbb{E}[f(\\mu + \\sigma\nZ)]')
('4.1.3.4', 'Z \\sim \\mathrm{Normal}(0,1)')
('4.1.3.4', '\\sigma \\coloneqq 0.1')
('4.1.3.4', '\\nabla f_\\sigma(\\mu)')
('4.1.3.4', '\\sigma')
('4.1.3.5', '\\sigma \\to 0')
('4.1.3.5', '\\nabla f')
('4.1.3.5', 'f')
('4.1.3.5', '{\\bm \\mu}')
('4.1.3.5', '{\\bm z}')
('4.1.3.5', '\\begin{aligned}\n\\partial f({\\bm \\mu})[{\\bm z}]\n& = \\langle \\nabla f({\\bm \\mu}), {\\bm z}\\rangle \\\\\n& = \\lim_{\\sigma \\to 0} \n\\left[f({\\bm \\mu}+ \\sigma \\cdot {\\bm z}) - f({\\bm \\mu})\\right] / \\sigma.\n\\end{aligned}')
('4.1.3.5', '\\sigma \\to 0')
('4.1.3.5', 'Z')
('4.1.3.5', '\\nabla \\nu({\\bm z}) = {\\bm z}')
('4.1.3.5', '\\begin{aligned}\n\\nabla f_\\sigma({\\bm \\mu}) \n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}} \n\\left[\\partial f({\\bm \\mu})[Z] \\nabla \\nu(Z) \\right] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}} \n\\left[\\partial f({\\bm \\mu})[Z] Z \\right] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}} \n\\left[\\langle \\nabla f({\\bm \\mu}), Z \\rangle Z\\right] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}} \n\\left[\\nabla f({\\bm \\mu}) Z Z^\\top\\right] \\\\\n&= \\nabla f({\\bm \\mu}).\n\\end{aligned}')
('4.1.3.5', 'f_\\sigma({\\bm \\mu}) = (f \\ast \\kappa_\\sigma)({\\bm \\mu}) \\to f({\\bm \\mu})')
('4.1.3.5', '\\sigma \\to 0')
('4.1.4.0', 'p(z) = \\exp(-\\nu(z)),')
('4.1.4.0', '\\nu(z) = z + \\gamma + \\exp(-(z+\\gamma)),')
('4.1.4.0', '\\gamma \\approx 0.577')
('4.1.4.0', 'M')
('4.1.4.0', 'Z = (Z_1, \\ldots, Z_m)')
('4.1.4.0', '{\\bm \\mu}+ \\sigma Z \\sim p_{{\\bm \\mu}, \\sigma},')
('4.1.4.0', 'p_{{\\mathbf{0}}, 1}= p')
('4.1.4.0', '\\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[\\nabla \\nu(Z)] = {\\mathbf{0}}')
('4.1.4.0', 'U \\sim \\mathrm{Uniform}(0,1)')
('4.1.4.0', 'Z \\coloneqq -\\log(-\\log(U))')
('4.1.4.0', 'Z \\sim \\mathrm{Gumbel}(0, 1)')
('4.1.4.0', 'Z')
('4.1.4.0', 'p_{\\mu, 1}')
('4.1.4.0', '\\exp(-Z)')
('4.1.4.0', '\\operatorname{Exp}(\\exp(\\mu - \\gamma))')
('4.1.4.0', '\\exp(-Z)')
('4.1.4.0', '\\operatorname{Exp}(\\exp(\\mu-\\gamma))')
('4.1.4.1', '\\mu_1, \\mu_2 \\in \\mathbb{R}')
('4.1.4.1', '\\mathrm{gt}(\\mu_1, \\mu_2) \\coloneqq \\begin{cases}\n    1 & \\mbox{if} \\ \\mu_1 \\geq  \\mu_2 \\\\\n    0 & \\mbox{if} \\ \\mu_1 < \\mu_2\n  \\end{cases} = \\mathrm{step}(\\mu_1-\\mu_2),')
('4.1.4.1', '\\mathrm{step}')
('4.1.4.1', '\\mathrm{logistic}(a-b)= 1/(1+ e^{-(a-b)})')
('4.1.4.1', '\\mathrm{step}(a-b)')
('4.1.4.1', 'Z_1, Z_2 \\sim \\mathrm{Gumbel}(0,1)')
('4.1.4.1', '\\mu_1 + \\sigma Z_1 - (\\mu_2 + \\sigma Z_2)  \\sim\n      \\mathrm{Logistic}(\\mu_1-\\mu_2,\\sigma),')
('4.1.4.1', '\\mu_1, \\mu_2 \\in \\mathbb{R}')
('4.1.4.1', '\\sigma >0')
('4.1.4.1', '\\mathbb{E}[\\mathrm{gt}(\\mu_1 + \\sigma Z_1, \\mu_2 + \\sigma Z_2)] \n    = \\frac{1}{1+ e^{-(\\mu_1-\\mu_2)/\\sigma}}.')
('4.1.4.1', '\\mu_1 + \\sigma Z_1 - (\\mu_2 + \\sigma Z_2)')
('4.1.4.1', '\\begin{aligned}\n    \\mathbb{P}(\\mu_1 + \\sigma Z_1 - (\\mu_2 + \\sigma Z_2) \\leq t) \n    & = \\mathbb{P}\\left(\\mu_1/\\sigma + Z_1 \\leq (\\mu_2 + t)/\\sigma + Z_2\\right) \\\\\n    & = \\mathbb{P}\\left(e^{-(\\mu_1/\\sigma + Z_1)} \\geq e^{-((\\mu_2 + t)/\\sigma + Z_2)}\\right).\n  \n\\end{aligned}')
('4.1.4.1', 'e^{-(\\mu_1/\\sigma + Z_1)}\\sim\n  \\operatorname{Exp}(\\exp(\\mu_1/\\sigma - \\gamma))')
('4.1.4.1', 'e^{-(\\mu_2 + t)/\\sigma + Z_2}')
('4.1.4.1', 'U \\sim \\operatorname{Exp}(u), V \\sim \\operatorname{Exp}(v)')
('4.1.4.1', '\\mathbb{P}(U\\leq\n  V) = u/(u+v)')
('4.1.4.1', '\\begin{aligned}\n    \\mathbb{P}(\\mu_1 + \\sigma Z_1 - (\\mu_2 + \\sigma Z_2) \\leq t) \n    & = \\frac{e^{(\\mu_2 + t)/\\sigma - \\gamma }}{e^{(\\mu_2 + t)/\\sigma - \\gamma }\n    + e^{\\mu_1/\\sigma - \\gamma}} \\\\\n    & = \\frac{1}{1+ e^{-(t- (\\mu_1-\\mu_2))/\\sigma}}.\n  \n\\end{aligned}')
('4.1.4.1', '\\mu_1-\\mu_2')
('4.1.4.1', '\\sigma')
('4.1.4.1', '\\mathrm{Logistic}(\\mu_1 - \\mu_2, \\sigma)')
('4.1.4.1', '\\begin{aligned}\n    \\mathbb{E}[\\mathrm{gt}(\\mu_1 + \\sigma Z_1, \\mu_2 + \\sigma Z_2)] \n    & = \\mathbb{E}\\left[\\mathrm{step}(\\mu_1+ \\sigma Z_1 - (\\mu_2+ \\sigma Z_2)\\right] \\\\\n    & = \\mathbb{P}(\\mu_1 + \\sigma Z_1 - (\\mu_2 + \\sigma Z_2)\\geq 0) \\\\\n    & = \\frac{1}{1+e^{-(\\mu_1-\\mu_2)/\\sigma}}.\n  \n\\end{aligned}')
('4.1.4.2', '{\\bm y}({\\bm u}) \n\\coloneqq \n\\mathop{\\mathrm{arg\\,max}}_{{\\bm y}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_M\\}} \\langle {\\bm y}, {\\bm u}\\rangle\n= \\phi(i({\\bm u})),')
('4.1.4.2', '\\begin{aligned}\ni({\\bm u}) & \\coloneqq \\mathop{\\mathrm{arg\\,max}}_{i \\in [M]} u_i  \\\\\n\\phi(i) & \\coloneqq {\\bm e}_i\n\\end{aligned}')
('4.1.4.2', '\\phi(i)')
('4.1.4.2', 'i \\in [M]')
('4.1.4.2', '{\\bm y}({\\bm u})')
('4.1.4.2', 'M')
('4.1.4.2', 'Z \\sim p_{{\\mathbf{0}},1}')
('4.1.4.2', 'Y \\coloneqq i({\\bm \\mu}+ \\sigma \\cdot Z) \\in [M],')
('4.1.4.2', '{\\bm \\mu}\\in \\mathbb{R}^M')
('4.1.4.2', '\\sigma >0')
('4.1.4.2', 'Y')
('4.1.4.2', 'q_{{\\bm \\mu},\\sigma} \\coloneqq\n\\mathrm{Categorical}(\\mathrm{softargmax}({\\bm \\mu}/ \\sigma)).')
('4.1.4.2', '\\begin{aligned}\n{\\bm y}_\\sigma({\\bm \\mu}) \n& = \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}[{\\bm y}({\\bm \\mu}+ \\sigma \\cdot Z)] \\\\\n& = \\mathbb{E}_{Y \\sim q_{{\\bm \\mu},\\sigma}}[\\phi(Y)] \\\\\n& = \\mathrm{softargmax}({\\bm \\mu}/ \\sigma).\n\\end{aligned}')
('4.1.4.2', 'k \\in [M]')
('4.1.4.2', '\\begin{aligned}\n    \\mathbb{P}(Y = k) & = \\mathbb{P}\\left(\\mathop{\\mathrm{arg\\,max}}_{i \\in [M]} \\{\\mu_i + \\sigma Z_i\\} = k\\right) \\\\\n    & = \\mathbb{P}\\left(\\mathop{\\mathrm{arg\\,min}}_{i \\in [M]} \\{e^{-\\mu_i/\\sigma - Z_i} \\} = k\\right)\n  \n\\end{aligned}')
('4.1.4.2', 'e^{-\\mu_i/\\sigma - Z_i}\n  \\sim \\operatorname{Exp}(\\exp(\\mu_i/\\sigma - \\gamma))')
('4.1.4.2', 'U_1, \\ldots, U_M')
('4.1.4.2', 'u_1,\n  \\ldots, u_m')
('4.1.4.2', '\\mathbb{P}(\\mathop{\\mathrm{arg\\,min}}_{i \\in [M]} \\{U_i\\} = k) =\n  u_k/\\sum_{i=1}^{M} u_i')
('4.1.4.2', '\\mathbb{P}(Y = k) = \\frac{\\exp(\\mu_k/\\sigma)}{\\sum_{i=1}^M \\exp(\\mu_i/\\sigma)},')
('4.1.4.2', 'Y \\sim \\mathrm{Categorical}(\\mathrm{softargmax}({\\bm \\mu}/ \\sigma)).')
('4.1.4.2', 'Y')
('4.1.4.2', '\\phi')
('4.1.4.3', 'M')
('4.1.4.3', 'Z \\sim p_{{\\mathbf{0}},1}')
('4.1.4.3', 'f({\\bm u}) \\coloneqq \\max_{i \\in [M]} u_i,')
('4.1.4.3', 'V \\coloneqq f({\\bm \\mu}+ \\sigma \\cdot Z).')
('4.1.4.3', 'q_{{\\bm \\mu},\\sigma}\n\\coloneqq\np_{\\sigma \\mathrm{LSE}({\\bm \\mu}/\\sigma), \\sigma}.')
('4.1.4.3', 'f_\\sigma({\\bm \\mu})\n= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}}, 1}}[f(U + \\sigma \\cdot Z)]\n= \\mathbb{E}_{V \\sim q_{{\\bm \\mu}, \\sigma}}[V]\n= \\sigma \\cdot \\mathrm{LSE}({\\bm \\theta}/ \\sigma).')
('4.1.4.3', 'f({\\bm \\mu}+ \\sigma \\cdot Z)')
('4.1.4.3', '\\begin{aligned}\n    \\mathbb{P}(\\max_{i\\in [M]} \\{\\mu_i + \\sigma Z_i\\} \\leq t) \n    & = \\mathbb{P}\\left(\\min_{i \\in [M]} \\{ e^{-(\\mu_i/\\sigma -Z_i)} \\}\\geq e^{-t/\\sigma}\\right)\n  \n\\end{aligned}')
('4.1.4.3', 'e^{-(\\mu_i/\\sigma -Z_i)} \\sim \\operatorname{Exp}(\\exp(\\mu_i/\\sigma_i) - \\gamma)')
('4.1.4.3', 'U_1, \\ldots, U_M')
('4.1.4.3', 'u_i')
('4.1.4.3', '\\min_{i \\in [M]} U_i \\sim \\operatorname{Exp}(\\sum_{i=1}^M u_i)')
('4.1.4.3', '\\begin{aligned}\n    \\mathbb{P}\\left(\\max_{i\\in [M]} \\{\\mu_i + \\sigma Z_i\\} \\leq t\\right) \n    & = \\exp\\left(-\\sum_{i=1}^M (\\exp(\\mu_i/\\sigma -\\gamma) ) \\exp(-t/\\sigma)\\right) \\\\\n    & = \\exp(-\\exp(-(t - \\sigma\\mathrm{LSE}({\\bm \\mu}/\\sigma))/\\sigma - \\gamma)). \\\\\n  \n\\end{aligned}')
('4.1.4.3', '\\sigma \\mathrm{LSE}({\\bm \\mu}/\\sigma)')
('4.1.4.3', '\\sigma')
('4.1.4.4', 'Z')
('4.1.4.4', 'Y')
('4.1.4.4', '\\mathrm{Categorical}(\\mathrm{softargmax}({\\bm \\mu}/ \\sigma))')
('4.1.4.4', 'Y')
('4.1.4.4', '{\\bm \\mu}')
('4.1.4.4', '\\mathrm{softargmax}({\\bm \\mu}/\\sigma)')
('4.1.4.4', 'M-1')
('4.1.4.5', '\\mathcal{Y}= [M]')
('4.1.4.5', '\\mathbb{R}^M')
('4.1.4.5', '\\mathcal{Y}\\subseteq \\mathbb{R}^M')
('4.1.4.5', '|\\mathcal{Y}| \\gg M')
('4.1.4.5', '\\begin{aligned}\nf({\\bm u})\n&\\coloneqq \\max_{{\\bm y}\\in \\mathcal{Y}} \\langle {\\bm y}, {\\bm u}\\rangle \\\\\n{\\bm y}({\\bm u})\n&\\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm y}\\in \\mathcal{Y}} \\langle {\\bm y}, {\\bm u}\\rangle.\n\\end{aligned}')
('4.1.4.5', 'f')
('4.1.4.5', '{\\bm y}')
('4.1.4.5', '\\begin{aligned}\nf_\\sigma({\\bm \\mu}) \n&\\coloneqq \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}\n[f({\\bm \\mu}+ \\sigma \\cdot Z)] \\\\\n{\\bm y}_\\sigma({\\bm \\mu}) \n&\\coloneqq \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}\n[{\\bm y}({\\bm \\mu}+ \\sigma \\cdot Z)],\n\\end{aligned}')
('4.1.4.5', '\\nabla f_\\sigma({\\bm \\mu})')
('4.1.4.5', '\\mathcal{Y}\\subseteq \\mathbb{R}^M')
('4.1.4.5', 'p_{{\\mathbf{0}},1}')
('4.1.4.5', 'p_{{\\mathbf{0}},1}({\\bm z}) \\coloneqq \\exp(-\\nu({\\bm z})) / C.')
('4.1.4.5', 'f_\\sigma({\\bm \\mu})')
('4.1.4.5', '\\begin{aligned}\n  \\nabla f_\\sigma({\\bm \\mu}) \n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} [{\\bm y}({\\bm \\mu}+ \\sigma \\cdot Z)] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} [f({\\bm \\mu}+ \\sigma \\cdot Z) \\nabla \\nu(Z) \n\\sigma] \\\\\n& \\in \\mathop{\\mathrm{conv}}(\\mathcal{Y}).\n\\end{aligned}')
('4.1.4.5', '\\nabla f_\\sigma({\\bm \\mu}) = {\\bm y}_\\sigma({\\bm \\mu})')
('4.1.4.5', '{\\bm y}= \\nabla f')
('4.1.4.5', '{\\bm y}= \\nabla f')
('4.1.4.5', '{\\bm y}_\\sigma({\\bm \\mu})')
('4.1.4.5', '\\begin{aligned}\n\\partial {\\bm y}_\\sigma({\\bm \\mu}) \n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}\\left[{\\bm y}({\\bm \\mu}+ \\sigma Z)\\nabla \\nu(Z)^\\top /\n\\sigma\\right] \\\\\n&= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}}\\left[f({\\bm \\mu}+ \\sigma Z)\n    \\left(\\nabla \\nu(Z)\\nabla \\nu(Z)^\\top - \\nabla^2 \\nu(Z)\\right) /\n\\sigma^2\\right].\n\\end{aligned}')
('4.1.4.5', '{\\bm y}_\\sigma({\\bm \\mu})\n= \\nabla f_\\sigma({\\bm \\mu})\n= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} [f({\\bm \\mu}+ \\sigma \\cdot Z) \\nabla \\nu(Z) /\n\\sigma].')
('4.1.4.5', '{\\bm y}')
('4.1.4.5', 'f')
('4.1.4.5.0', '\\mathcal{Y}')
('4.1.4.5.0', 'p')
('4.1.4.5.0', 'f_\\sigma({\\bm \\mu}) \n\\coloneqq \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} [f({\\bm \\mu}+ \\sigma \\cdot Z)]\n= \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} [\\max_{{\\bm y}\\in \\mathcal{Y}} \\langle {\\bm \\mu}+ \\sigma \\cdot\nZ, {\\bm y}\\rangle]')
('4.1.4.5.0', 'f^*_\\sigma({\\bm y})')
('4.1.4.5.0', 'f_\\sigma({\\bm \\mu})')
('4.1.4.5.0', 'f_\\sigma({\\bm \\mu}) \n=\n\\max_{{\\bm y}\\in \\mathcal{Y}} \\langle {\\bm \\mu}, {\\bm y}\\rangle - f^*_\\sigma({\\bm y}).')
('4.1.4.5.0', '\\nabla f_\\sigma({\\bm \\mu}) = {\\bm y}_\\sigma({\\bm \\mu})')
('4.1.4.5.0', '\\mathbb{R}^M')
('4.1.4.5.0', '\\mathcal{Y}')
('4.1.4.5.0', 'f^*_\\sigma({\\bm y})')
('4.1.4.6', 'h({\\bm u}) \\coloneqq\ng({\\bm y}({\\bm u}))')
('4.1.4.6', 'h_\\sigma({\\bm \\mu}) \n\\coloneqq \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} \\left[g({\\bm y}({\\bm \\mu}+ \\sigma Z))\\right]')
('4.1.4.6', '{\\bm y}({\\bm u}) \\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm y}\\in \\{{\\bm e}_1, \\dots, {\\bm e}_M\\}} \\langle {\\bm y}, {\\bm u}\\rangle.')
('4.1.4.6', 'h_\\sigma({\\bm \\mu})')
('4.1.4.6', '{\\bm y}({\\bm u})')
('4.1.4.6', '{\\bm y}({\\bm u})')
('4.1.4.6', '\\tau')
('4.1.4.6', 'h_{\\sigma,\\tau}({\\bm \\mu}) \n\\coloneqq \\mathbb{E}_{Z \\sim p_{{\\mathbf{0}},1}} \\left[g(\\mathrm{softargmax}_\\tau({\\bm \\mu}+\n\\sigma Z))\\right].')
('4.1.4.6', '\\nabla h_{\\sigma,\\tau}({\\bm \\mu})')
('4.1.4.6', '\\nabla h_{\\sigma}({\\bm \\mu})')
('4.1.4.6', '\\tau')
('4.1.4.6', '\\tau \\to 0')
('4.1.4.6', 'h_{\\sigma,\\tau}({\\bm \\mu}) \\to h_\\sigma({\\bm \\mu})')
('4.1.4.6', 'g')
('4.1.4.6', '\\triangle^M')
('4.1.4.6', '\\{{\\bm e}_1,\\dots,{\\bm e}_M\\}')
('4.1.4.6', '\\sigma=1')
('4.1.4.6', 'T \n\\coloneqq \\mathrm{softargmax}_\\tau({\\bm \\mu}+ Z) \\in \\triangle^M,')
('4.1.4.6', 'Z \\sim p_{{\\mathbf{0}}, 1}')
('4.1.4.6', 'T')
('4.1.4.6', 'p_{{\\bm \\mu},\\tau}({\\bm t}) \\coloneqq \\Gamma(M) \\tau^{M-1}\n\\left( \\sum_{i=1}^M \\frac{\\pi_i}{t_i^\\tau} \\right)^{-M}\n\\prod_{i=1}^M \\frac{\\pi_i}{t_i^{\\tau +1}},')
('4.1.4.6', '{\\bm \\pi}\\coloneqq \\mathrm{softargmax}({\\bm \\mu})')
('4.1.4.6', '{\\bm y}({\\bm u}) \\coloneqq \\mathop{\\mathrm{arg\\,max}}_{{\\bm y}\\in \\mathcal{Y}} \\langle {\\bm y}, {\\bm u}\\rangle,')
('4.1.4.6', 'g')
('4.1.4.6', '\\mathop{\\mathrm{conv}}(\\mathcal{Y})')
('4.1.4.6', '\\mathcal{Y}')
('4.1.4.6', '{\\bm y}')
('5.0.0', 'L')
('5.0.0', 'L({\\bm w})')
('5.0.0', '{\\bm w}\\in \\mathcal{W}')
('5.0.0', '\\mathcal{W}=\\mathbb{R}^P')
('5.0.0', 'L({\\bm w})')
('5.0.0', 'L^\\star \\coloneqq \\inf_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}),')
('5.0.0', 'L({\\bm w})')
('5.0.0', "{\\bm w}^\\star \\in \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) \n\\coloneqq \\left\\{{\\bm w}\\in \\mathcal{W}: L({\\bm w}) = \\min_{{\\bm w}' \\in \\mathcal{W}} L({\\bm w}')\\right\\}.")
('5.0.0', '{\\bm w}^{0}')
('5.0.0', 't')
('5.0.0', '{\\bm w}^{t}')
('5.0.0', 'L')
('5.0.0', '\\varepsilon')
('5.0.0', 'L({\\bm w}^{t}) - L^\\star \\leq \\varepsilon.\n\\label{optim:eq:epsilon_accurate}')
('5.0.1', '{\\bm w}^{1}, {\\bm w}^{2}, \\dots')
('5.0.1', 'L')
('5.0.1', 'L')
('5.0.1', 'L({\\bm w})')
('5.0.1', '{\\bm w}\\in \\mathcal{W}')
('5.0.1', 'L({\\bm w}) \\in \\mathbb{R}')
('5.0.1', '\\nabla L({\\bm w}) \\in\n        \\mathcal{W}')
('5.0.1', 'L')
('5.0.1', '\\nabla^2\n        L({\\bm w})')
('5.0.1', '\\nabla^2 L({\\bm w})\n        {\\bm v}\\in \\mathcal{W}')
('5.0.1', 'L')
('5.0.1', '{\\bm v}\\in\n        \\mathcal{W}')
('5.0.1', '\\mathcal{O}')
('5.0.1', 'L')
('5.0.1', '\\mathcal{A}')
('5.0.1', '{\\bm w}^{1}, \\ldots, {\\bm w}^{t}')
('5.0.1', '{\\bm w}^{0}')
('5.0.1', '{\\bm w}^{t+1} \n  \\coloneqq \\mathcal{A}({\\bm w}^{0}, \\ldots, {\\bm w}^{t}, \n    \\mathcal{O}({\\bm w}^{0}), \\ldots, \\mathcal{O}({\\bm w}^{t}), {\\bm \\lambda}),')
('5.0.1', '{\\bm \\lambda}\\in \\Lambda \\subseteq \\mathbb{R}^Q')
('5.0.1', '{\\bm w}\n^{t+1} = \\mathcal{A}({\\bm w}^{t}, \\mathcal{O}({\\bm w}^{t}), {\\bm \\lambda})')
('5.0.1', '{\\bm w}^{t+1} \\coloneqq {\\bm w}^{t} - \\gamma \\nabla L({\\bm w}^{t}),')
('5.0.1', '\\gamma')
('5.0.2', '{\\bm w}^{t+1}')
('5.0.2', '{\\bm w}^{t}')
('5.0.2', '{\\bm w}^{t+1} \\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) + \\frac{1}{2\\gamma} \\|{\\bm w}- {\\bm w}^{t}\\|_2^2.')
('5.0.2', 'L')
('5.0.2', '{\\bm w}^t')
('5.0.2', '{\\bm w}^{t+1} \\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \\tilde{L}({\\bm w}, {\\bm w}^{t}) + \n\\frac{1}{2\\gamma} \\|{\\bm w}- {\\bm w}^{t}\\|_2^2.')
('5.0.2', '{\\bm w}^{t+1} \\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \\tilde{L}({\\bm w}, {\\bm w}^{t}) + \n\\frac{1}{\\gamma} d({\\bm w},  {\\bm w}^{t}),')
('5.0.2', '\\tilde{L}({\\bm w}, {\\bm w}^{t})')
('5.0.2', 'L({\\bm w})')
('5.0.2', '{\\bm w}^{t}')
('5.0.2', "d({\\bm w}, {\\bm w}')")
('5.0.2', '{\\bm w}')
('5.0.2', "{\\bm w}'")
('5.0.2', '\\tilde{L}')
('5.0.2', 'd')
('5.0.3.0', 'g \\colon \\mathcal{W}\\to \\mathcal{F}')
('5.0.3.0', '\\beta')
('5.0.3.0', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.0', '\\|g({\\bm w}) - g({\\bm v})\\|_2 \\le \\beta \\|{\\bm w}- {\\bm v}\\|_2.')
('5.0.3.0.0', '2')
('5.0.3.0.0', 'g \\colon \\mathcal{W}\\to \\mathcal{F}')
('5.0.3.0.0', '\\beta')
('5.0.3.0.0', '\\|\\cdot\\|')
('5.0.3.0.0', '\\mathcal{C}\\subseteq \\mathcal{W}')
('5.0.3.0.0', '{\\bm w}, {\\bm v}\\in \\mathcal{C}')
('5.0.3.0.0', '\\|g({\\bm w}) - g({\\bm v})\\|_* \\le \\beta \\|{\\bm w}- {\\bm v}\\|.')
('5.0.3.0.0', '\\|\\cdot\\| = \\|\\cdot\\|_2')
('5.0.3.0.0', '2')
('5.0.3.1', 'L')
('5.0.3.1', '\\beta')
('5.0.3.1', '\\beta')
('5.0.3.1', 'g({\\bm w}) = \\nabla L({\\bm w})')
('5.0.3.1', 'L \\colon \\mathcal{W}\\to \\mathbb{R}')
('5.0.3.1', '\\beta')
('5.0.3.1', '\\beta > 0')
('5.0.3.1', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.1', '\\|\\nabla L({\\bm w}) - \\nabla L({\\bm v})\\|_2 \\leq \\beta \\|{\\bm w}-{\\bm v}\\|_2.')
('5.0.3.1', '{\\bm w}')
('5.0.3.1', '{\\bm w}')
('5.0.3.1', '{\\bm v}')
('5.0.3.1', '{\\bm w}')
('5.0.3.1', 'L:\\mathcal{W}\\to \\mathbb{R}')
('5.0.3.1', '\\beta')
('5.0.3.1', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.1', '|L({\\bm w}) - L({\\bm v}) + \\langle \\nabla L({\\bm v}), {\\bm w}-{\\bm v}\\rangle|\n  \\leq\n  \\frac{\\beta}{2}\\|{\\bm w}-{\\bm v}\\|_2^2.')
('5.0.3.1', 'L({\\bm w}) \n\\leq \nL({\\bm v}) + \\langle \\nabla L({\\bm v}), {\\bm w}-{\\bm v}\\rangle  +\n\\frac{\\beta}{2}\\|{\\bm w}-{\\bm v}\\|_2^2.')
('5.0.3.1', '|L({\\bm v})- L({\\bm w}) - \\langle \\nabla L({\\bm w}), {\\bm v}-{\\bm w}\\rangle|')
('5.0.3.1', '{\\bm w}-{\\bm v}')
('5.0.3.1', '|L({\\bm v})- L({\\bm w}) - \\langle \\nabla L({\\bm w}), {\\bm v}-{\\bm w}\\rangle| \n= |\\int_0^1 \\langle \\nabla L({\\bm w}+ s({\\bm v}-{\\bm w})), {\\bm v}-{\\bm w}\\rangle ds \n- \\langle \\nabla L({\\bm w}), {\\bm v}-{\\bm w})\\rangle|\n\\leq \\int_0^1 \\|\\nabla L({\\bm w}+ s({\\bm v}-{\\bm w}))ds -  \\nabla L({\\bm w})\\|_2\\|{\\bm v}-{\\bm w}\\|_2\n\\leq L\\|{\\bm w}-{\\bm v}\\|_2^2/2')
('5.0.3.1', 'L({\\bm w})')
('5.0.3.1', '{\\bm v}')
('5.0.3.1', '{\\bm w}')
('5.0.3.1.0', 'L:\\mathcal{W}\\to \\mathbb{R}')
('5.0.3.1.0', '\\beta')
('5.0.3.1.0', '\\|\\cdot\\|')
('5.0.3.1.0', '\\mathcal{C}')
('5.0.3.1.0', '{\\bm w}, {\\bm v}\\in \\mathcal{C}')
('5.0.3.1.0', '\\|\\nabla L({\\bm w}) - \\nabla L({\\bm v})\\|_* \n\\le  \n\\frac{\\beta}{2} \\|{\\bm w}- {\\bm v}\\|.')
('5.0.3.1.0', 'L:\\mathcal{W}\\to \\mathbb{R}')
('5.0.3.1.0', '\\beta')
('5.0.3.1.0', '\\|\\cdot\\|')
('5.0.3.1.0', '\\mathcal{C}')
('5.0.3.1.0', '{\\bm w}, {\\bm v}\\in \\mathcal{C}')
('5.0.3.1.0', '|\\underbrace{L({\\bm w}) - L({\\bm v}) - \\langle \\nabla L({\\bm v}), {\\bm w}- {\\bm v}\\rangle}_{B_L({\\bm w}, {\\bm v})}|\n\\le  \\frac{\\beta}{2} \\|{\\bm w}- {\\bm v}\\|^2,')
('5.0.3.1.0', 'B_f')
('5.0.3.1.0', 'f')
('5.0.3.2', 'L: \\mathcal{W}\\rightarrow \\mathbb{R}')
('5.0.3.2', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.2', '\\tau\\in [0, 1]')
('5.0.3.2', 'L(\\tau{\\bm w}+ (1-\\tau){\\bm v}) \\leq \\tau L({\\bm w}) + (1-\\tau)L({\\bm v}).')
('5.0.3.2', 'L')
('5.0.3.2', '{\\bm w}\\neq {\\bm v}')
('5.0.3.2', '{\\bm w}_1, \\ldots, {\\bm w}_n \\in \\mathcal{W}')
('5.0.3.2', '\\tau_1, \\ldots \\tau_n \\geq 0')
('5.0.3.2', '\\sum_{i=1}^n \\tau_i = 1')
('5.0.3.2', '\\tau_1, \\ldots, \\tau_n')
('5.0.3.2', '[n])')
('5.0.3.2', 'L')
('5.0.3.2', 'L\\left(\\sum_{i=1}^n \\tau_i {\\bm w}_i\\right) \\leq\n  \\sum_{i=1}^n \\tau_i L({\\bm w}_i).')
('5.0.3.2', '\\sum_{i=1}^n \\tau_i {\\bm w}_i')
('5.0.3.2', 'L \\colon \\mathcal{W}\\rightarrow \\mathbb{R}')
('5.0.3.2', 'W')
('5.0.3.2', '\\mathcal{W}')
('5.0.3.2', 'L(\\mathbb{E}[W]) \\leq \\mathbb{E}[L(W)],')
('5.0.3.2', 'L:\\mathcal{W}\\rightarrow \\mathbb{R}')
('5.0.3.2', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.2', 'L({\\bm v}) \\geq L({\\bm w}) + \\langle \\nabla L({\\bm w}), {\\bm v}-{\\bm w}\\rangle.')
('5.0.3.2', 'L')
('5.0.3.2', '{\\bm w}\\neq {\\bm v}')
('5.0.3.2', '\\hat{\\bm w}')
('5.0.3.2', '\\nabla L(\\hat {\\bm w}) = {\\mathbf{0}}\\implies  \n  \\forall {\\bm v}\\in \\mathbb{R}^P, \\  L({\\bm v}) \\geq L(\\hat {\\bm w}) \\implies \n  L(\\hat {\\bm w}) = L^\\star.')
('5.0.3.2', 'L: \\mathcal{W}\\rightarrow \\mathbb{R}')
('5.0.3.2', '\\forall  {\\bm w}\\in \\mathcal{W}, \\ \\nabla^2 L({\\bm w}) \\succeq 0, \n  \\ \\mbox{i.e.}, \\ \n  \\forall {\\bm w}, {\\bm v}\\in \\mathcal{W}, \\ \n  \\langle {\\bm v}, \\nabla^2 L({\\bm w}) {\\bm v}\\rangle \\geq 0.')
('5.0.3.2', 'L')
('5.0.3.2', '\\forall  {\\bm w}\\in \\mathcal{W}, \\ \\nabla^2 L({\\bm w}) \\succ 0')
('5.0.3.2', '\\forall {\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.2', '\\langle {\\bm v}, \\nabla^2 L({\\bm w}) {\\bm v}\\rangle > 0')
('5.0.3.3', '\\mu')
('5.0.3.3', 'L: \\mathcal{W}\\rightarrow \\mathbb{R}')
('5.0.3.3', '\\mu')
('5.0.3.3', '\\mu >0')
('5.0.3.3', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.3', '\\tau\\in [0, 1]')
('5.0.3.3', 'L(\\tau{\\bm w}+ (1-\\tau){\\bm v}) \\leq \\tau L({\\bm w}) + (1-\\tau)L({\\bm v}) -\n  \\frac{\\mu}{2} \\tau (1-\\tau) \\|{\\bm w}- {\\bm v}\\|^2_2.')
('5.0.3.3', 'L')
('5.0.3.3', '\\mu')
('5.0.3.3', '{\\bm w}, {\\bm v}\\in \\mathcal{W}')
('5.0.3.3', 'L({\\bm v}) \\geq L({\\bm w}) + \\langle \\nabla L({\\bm w}), {\\bm w}-{\\bm v}\\rangle \n  + \\frac{\\mu}{2} \\|{\\bm w}-{\\bm v}\\|_2^2.')
('5.0.3.3', '\\mu')
('5.0.3.3', '\\forall {\\bm w}\\in \\mathcal{W},  \\ \\nabla^2 L({\\bm w}) \\succeq \\mu \\operatorname{I}, \n  \\ \\mbox{i.e.}, \\ \n  \\forall {\\bm w}, {\\bm v}\\in \\mathcal{W}, \\ \n  \\langle {\\bm v}, \\nabla^2 L({\\bm w}) {\\bm v}\\rangle \\geq \\mu\\|{\\bm v}\\|_2^2.')
('5.0.3.3', 'L({\\bm w})')
('5.0.3.3', '\\mbox{$L$ strongly convex} \n\\implies \\mbox{$L$ strictly convex} \n\\implies \\mbox{$L$ convex}.')
('5.0.3.3.0', '2')
('5.0.3.3.0', 'L:\\mathcal{W}\\rightarrow \\mathbb{R}')
('5.0.3.3.0', '\\mu')
('5.0.3.3.0', '\\|\\cdot\\|')
('5.0.3.3.0', '\\mathcal{C}')
('5.0.3.3.0', '{\\bm w}, {\\bm v}\\in \\mathcal{C}')
('5.0.3.3.0', '\\frac{\\mu}{2} \\|{\\bm w}- {\\bm v}\\|^2 \\le\n\\underbrace{L({\\bm w}) - L({\\bm v}) - \\langle \\nabla L({\\bm v}), {\\bm w}- {\\bm v}\\rangle}_{B_L({\\bm w},\n{\\bm v})}.')
('5.0.3.3.0', 'L')
('5.0.3.3.0', '\\mu')
('5.0.3.3.0', '\\lambda L')
('5.0.3.3.0', '(\\mu\\lambda)')
('5.0.3.3.0', '\\mu')
('5.0.3.3.0', 'f({\\bm u}) = \\frac{1}{2} \\|{\\bm u}\\|^2_2')
('5.0.3.3.0', '1')
('5.0.3.3.0', '\\|\\cdot\\|_2')
('5.0.3.3.0', '\\mathbb{R}^M')
('5.0.3.3.0', 'f({\\bm u}) = \\langle {\\bm u}, \\log {\\bm u}\\rangle')
('5.0.3.3.0', '1')
('5.0.3.3.0', '\\|\\cdot\\|_1')
('5.0.3.3.0', '\\triangle^M')
('5.0.3.3.0', '{\\bm p}, {\\bm q}\\in \\triangle^M')
('5.0.3.3.0', '\\frac{1}{2} \\|{\\bm p}- {\\bm q}\\|_1^2 \\le B_f({\\bm p}, {\\bm q}) = \\mathrm{KL}({\\bm p}, {\\bm q}),')
('5.0.3.3.0', 'f({\\bm u})')
('5.0.3.3.0', '\\frac{1}{\\mu}')
('5.0.3.3.0', '\\|\\cdot\\|_1')
('5.0.3.3.0', '\\mathcal{C}\\subset \\mathbb{R}^M_+')
('5.0.3.3.0', '\\mu = \\sup_{{\\bm u}\\in \\mathcal{C}}\n\\|{\\bm u}\\|_1')
('5.0.3.3.0', '\\mathbb{R}^M_+')
('5.0.3.3.0', '\\frac{1}{2} \\|{\\bm p}- {\\bm q}\\|_1^2 \\le \\mathrm{KL}({\\bm p}, {\\bm q})')
('5.0.3.3.0', '{\\bm p}\\coloneqq (\\pi, 1-\\pi)')
('5.0.3.3.0', '{\\bm q}\\coloneqq (0.3, 0.7)')
('5.0.3.4', '{\\bm w}^\\star \\in \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) \\implies \\nabla L({\\bm w}^\\star) = 0.')
('5.0.3.4', 'F: t \\rightarrow L({\\bm w}^\\star - t \\nabla\nL({\\bm w}^*))')
('5.0.3.4', '\\nabla L({\\bm w}^\\star)\\neq 0')
('5.0.3.4', "F'(0) = -\\|\\nabla\nL({\\bm w}^\\star)\\|_2^2 \\neq 0")
('5.0.3.4', 't >0')
('5.0.3.4', 'F(t) <\nF(0)')
('5.0.3.4', 'L({\\bm w}^\\star)')
('5.0.3.4', '\\hat {\\bm w}')
('5.0.3.4', '\\exists r>0, \\ \\mbox{s.t.}\\ \n  \\forall {\\bm v}\\in \\mathcal{W}\\ \\mbox{satisfying} \\ \\|{\\bm v}-\\hat {\\bm w}\\|\\leq r, \\ \n  \\mbox{we have} \\  L({\\bm v}) \\geq L(\\hat{\\bm w}).')
('5.0.3.4', 'L({\\bm v}) \\leq L(\\hat{\\bm w})')
('5.0.3.4', '\\hat {\\bm w}')
('5.0.3.4', '\\|\\nabla f({\\bm w}^t)\\|_2')
('5.0.3.4', '0')
('5.0.4', '\\varepsilon')
('5.0.4', 't = T(\\varepsilon).')
('5.0.4', 't')
('5.0.4', '\\varepsilon = R(t),')
('5.0.4', 'R')
('5.0.4', 't \\rightarrow\n+\\infty')
('5.0.4', 'R')
('5.0.4', '\\beta')
('5.0.4', 'T(\\varepsilon)')
('5.0.4', 't')
('5.0.4', 'R(t) \\leq\n\\varepsilon')
('5.0.4', 'T(\\varepsilon) = \\min \\{t \\in \\mathbb{N}\\colon R(t) \\le \\varepsilon\\}.')
('5.0.4', 't')
('5.0.4', '\\rho_t \\coloneqq \\frac{R(t)}{R(t-1)}.')
('5.0.4', '\\rho_{\\infty} \\coloneqq \\lim_{t \\rightarrow + \\infty} \\rho_t.')
('5.0.4', '\\rho_\\infty =1')
('5.0.4', 't \\rightarrow + \\infty')
('5.0.4', 'R(t)')
('5.0.4', 'O(1/t), O(1/t^2)')
('5.0.4', 'O(1/t^\\alpha)')
('5.0.4', '\\alpha>0')
('5.0.4', 'T(\\varepsilon) = O(\\varepsilon^{-1/\\alpha})')
('5.0.4', '\\rho_\\infty = c \\in (0, 1)')
('5.0.4', 'R(t) = O(\\exp(- c t))')
('5.0.4', 'c')
('5.0.4', 'T(\\varepsilon) = O (c^{-1}\\ln \\varepsilon^{-1})')
('5.0.4', '\\rho_\\infty = 0')
('5.0.4', 'R(t) = O(\\exp(-t^2))')
('5.0.4', 'T(\\varepsilon) = O(\n    \\sqrt{\\ln\\varepsilon^{-1}})')
('5.0.4', 'R(t) = O(\\exp(-\\exp(t)))')
('5.0.4', 'T(\\varepsilon) = O (\\ln\\ln\\varepsilon^{-1})')
('5.0.4.0', '\\beta')
('5.0.4.0', '[0, 1]^P')
('5.0.4.0', '\\frac{c}{\\varepsilon^P}')
('5.0.4.0', 'P = 10')
('5.0.4.0', '\\varepsilon=10^{-3}')
('5.0.4.0', '10^{30}')
('5.0.4.0.0', 'P')
('5.0.4.0.0', 'P')
('5.0.4.0.0', 'P\\gg 1')
('5.0.4.0.0', '\\sqrt{P}')
('5.0.4.0.0', 'P')
('5.1.0', '\\gamma')
('5.1.0', '{\\bm w}^{t+1} = {\\bm w}^{t} - \\gamma \\nabla L({\\bm w}^{t}). \n\\label{optim:eq:gradient_descent}')
('5.1.0', 'f(w)=\n  0.05w_1^2 + 0.5 w_2^2')
('5.1.0.0', 'L({\\bm w})')
('5.1.0.0', '{\\bm w}^{t}')
('5.1.0.0', 'L({\\bm w}) \n\\approx \nL({\\bm w}^{t}) + \\langle \\nabla L({\\bm w}^{t}), {\\bm w}- {\\bm w}^{t} \\rangle.')
('5.1.0.0', '{\\bm w}^{t+1} \n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \nL({\\bm w}^{t}) + \\langle \\nabla L({\\bm w}^{t}), {\\bm w}- {\\bm w}^{t} \\rangle \n+ \\frac{1}{2\\gamma} \\|{\\bm w}- {\\bm w}^{t}\\|_2^2.\n\\label{optim:eq:gd_variational}')
('5.1.0.0', '{\\bm w}^{t}')
('5.1.0.0', '\\frac{1}{2\\gamma} \\|{\\bm w}\n- {\\bm w}^{t}\\|_2^2')
('5.1.0.0', 'L')
('5.1.0.0', '{\\bm w}^{t}')
('5.1.0.0', '\\gamma')
('5.1.0.1', '\\nabla L({\\bm w}^{t}) \\neq {\\mathbf{0}}')
('5.1.0.1', 'L_t(\\gamma) \\coloneqq L({\\bm w}^{t} - \\gamma \\nabla L({\\bm w}^{t}))')
('5.1.0.1', "L'_t(0)=-\\|\\nabla L({\\bm w}^{t})\\|_2^2")
('5.1.0.1', '\\nabla L({\\bm w}^{t}) \\neq\n{\\mathbf{0}}')
('5.1.0.1', 'L({\\bm w}^{t+1}) \n  \\leq L({\\bm w}^{t}) \n  - \\gamma \\|\\nabla L({\\bm w}^{t})\\|_2^2\n  + \\frac{\\beta\\gamma^2}{2} \\|\\nabla L({\\bm w}^{t})\\|_2^2.')
('5.1.0.1', '\\beta')
('5.1.0.1', '\\gamma \\leq \\frac{1}{\\beta}')
('5.1.0.1', 'L({\\bm w}^{t+1}) - L({\\bm w}^{t}) \\leq \n  - \\frac{\\gamma}{2}\\|\\nabla L({\\bm w}^{t})\\|_2^2,')
('5.1.0.1', 'T')
('5.1.0.1', '\\begin{aligned}\n  \\min_{t\\in \\{0, \\ldots, T-1\\}} \\|\\nabla L({\\bm w}^{t})\\|_2^2 \n  & \\leq \\frac{1}{T}\\sum_{t=0}^{T-1} \\|\\nabla L({\\bm w}^{t})\\|_2^2 \\\\\n  & \\leq \\frac{2}{\\gamma T}\\left(L({\\bm w}^{0}) - L({\\bm w}^{T})\\right) \\\\\n  & \\leq \\frac{2}{\\gamma T}\\left(L({\\bm w}^{0}) - L^\\star\\right),\n\\end{aligned}')
('5.1.0.1', 'L^\\star')
('5.1.0.1', 'L')
('5.1.0.1.0', 'T_s(\\varepsilon)')
('5.1.0.1.0', '\\varepsilon')
('5.1.0.1.0', '\\|\\nabla\nL(\\hat {\\bm w})\\|_2\\leq \\varepsilon')
('5.1.0.1.0', 'T_s(\\varepsilon) \\leq\nO(\\varepsilon^{-2})')
('5.1.0.1.1', '\\beta')
('5.1.0.1.1', 'f')
('5.1.0.1.1', '\\gamma \\leq 1/\\beta')
('5.1.0.1.1', 'L({\\bm w}^{T}) - L^\\star \n    \\leq \\frac{1}{\\gamma T}\\|{\\bm w}^{0} - {\\bm w}^\\star\\|_2^2.')
('5.1.0.1.1', 'T(\\varepsilon)= O(1/\\varepsilon)')
('5.1.0.1.2', '\\beta')
('5.1.0.1.2', '\\mu')
('5.1.0.1.2', '\\gamma \\leq 1/\\beta')
('5.1.0.1.2', '\\begin{aligned}\n  L({\\bm w}^{T}) - L^\\star\n  & \\leq \\left(1 - \\gamma \\mu\\right)^T \n  \\left(L({\\bm w}^{0}) - L^\\star\\right) \\\\\n  & \\leq \\exp\\left(- \\gamma \\mu T\\right)\n  \\left(L({\\bm w}^{0}) - L^\\star\\right).\n\\end{aligned}')
('5.1.0.1.2', 'T(\\varepsilon) = O(\\ln\\varepsilon^{-1})')
('5.1.0.1.2', '\\|\\nabla L({\\bm v})\\|_2^2 \\geq c(L({\\bm v}) - L^\\star)')
('5.1.0.1.2', 'c')
('5.1.0.1.2', '{\\bm v}\\in \\mathcal{W}')
('5.1.0.2', '{\\bm w}\n\\mapsto \\frac{1}{2} {\\bm w}^\\top {\\bm A}{\\bm w}+ {\\bm b}^\\top {\\bm w}')
('5.1.0.2', '{\\bm A}')
('5.1.0.2', '\\begin{aligned}\n  {\\bm v}^{t+1} &\\coloneqq \\nu {\\bm v}^{t} - \\gamma \\nabla L({\\bm w}^{t}) \\\\\n  {\\bm w}^{t+1} &\\coloneqq {\\bm w}^{t} + {\\bm v}^{t+1}.\n\\end{aligned}')
('5.1.0.2', '{\\bm v}^{t}')
('5.1.0.2', '\\nu=0')
('5.1.0.2', '\\nu>0')
('5.1.0.2', '\\nu')
('5.1.0.2', 'O(\\exp(- T \\sqrt{\\mu /\\beta}))')
('5.1.0.2', '\\nu, \\gamma')
('5.1.0.2', 'O(\\exp(-T\\mu/\\beta))')
('5.1.0.2', '\\mu/\\beta \\leq 1')
('5.1.1', '\\rho')
('5.1.1', '\\min_{{\\bm w}\\in \\mathcal{W}} \\ \nL({\\bm w}) \\coloneqq \\mathbb{E}_{S \\sim \\rho} \\left[L({\\bm w}; S)\\right].')
('5.1.1', 'L')
('5.1.1', 'L({\\bm w}; S) \\coloneqq \\ell(Y, f(X, {\\bm w}))')
('5.1.1', '\\ell')
('5.1.1', 'f')
('5.1.1', 'S=(X, Y)')
('5.1.1', 'X')
('5.1.1', 'Y')
('5.1.1', '\\rho')
('5.1.1', '\\rho')
('5.1.1', 'L({\\bm w})')
('5.1.1', '\\nabla L({\\bm w})')
('5.1.1', 'n')
('5.1.1', '{\\bm s}_i = ({\\bm x}_i, {\\bm y}_i)')
('5.1.1', '\\rho = \\rho_n')
('5.1.1', 'L({\\bm w})\n= \\mathbb{E}_{S \\sim \\rho_n} \\left[L({\\bm w}; S)\\right] \n= \\frac{1}{n} \\sum_{i=1}^n L({\\bm w}; (X_i, Y_i)).')
('5.1.1', 'L({\\bm w})')
('5.1.1', '\\nabla L({\\bm w})\n\\coloneqq\n\\frac{1}{n} \\sum_{i=1}^n \\nabla L({\\bm w}; ({\\bm x}_i, {\\bm y}_i)).')
('5.1.1', '\\nabla L({\\bm w})')
('5.1.1', '\\nabla L({\\bm w})')
('5.1.1', 'n')
('5.1.1', 'n')
('5.1.1.0', '\\rho')
('5.1.1.0', 'S \\sim \\rho')
('5.1.1.0', '\\nabla L({\\bm w}; S)')
('5.1.1.0', '\\nabla L({\\bm w})')
('5.1.1.0', '\\mathbb{E}_{S \\sim \\rho}\\left[ \\nabla L({\\bm w}; S)\\right] = \\nabla L({\\bm w}).')
('5.1.1.0', '\\nabla L({\\bm w}; S)')
('5.1.1.0', '\\nabla L({\\bm w})')
('5.1.1.0', 'm \\ll n')
('5.1.1.0', 'S_i \\coloneqq (X_i, Y_i)')
('5.1.1.0', '\\frac{1}{m} \\sum_{i=1}^m \\nabla L({\\bm w};S_i)')
('5.1.1.0', '\\nabla L({\\bm w})')
('5.1.1.0', 'm')
('5.1.1.0', 'n')
('5.1.1.0', 'L({\\bm w})')
('5.1.1.0', 'g({\\bm w}; S)')
('5.1.1.0', '\\nabla L({\\bm w})')
('5.1.1.0', 'S')
('5.1.1.0', 'q')
('5.1.1.0', '\\mathbb{E}_{S \\sim q}\\left[g({\\bm w}; S)\\right] = \\nabla L({\\bm w}).')
('5.1.1.0', '\\mathbb{E}_{S \\sim q}\\left[\\left\\| g({\\bm w}; S) \n    - \\nabla L({\\bm w}) \\right\\|_2^2\\right].')
('5.1.1.0', 'q = \\rho')
('5.1.1.0', 'q')
('5.1.1.0', 'm')
('5.1.1.0', 'p')
('5.1.1.1', '{\\bm w}^{t+1} = {\\bm w}^{t} - \\gamma g({\\bm w}^{t}; S ^{t}) \n  \\quad \\mbox{where} \\\n  S ^{t} \\sim q.')
('5.1.1.1', 'S ^{t}')
('5.1.1.1', '{\\bm w}^{t}')
('5.1.1.1', '\\beta')
('5.1.1.1', 'L({\\bm w}; {\\bm s})')
('5.1.1.1', 'T')
('5.1.1.1', 'T')
('5.1.1.1', '\\bar {\\bm w}^{T} \\coloneqq \\frac{1}{T}\n\\sum_{t=1}^T {\\bm w}^{t}')
('5.1.1.1', '\\sigma^2')
('5.1.1.1', '{\\bm w}^\\star')
('5.1.1.1', 'L')
('5.1.1.1', '\\mathbb{E}_{S_0, \\ldots, S_{T-1}}')
('5.1.1.1', '\\gamma \\leq\n1/(4\\beta)')
('5.1.1.1', '\\mathbb{E}_{S_0, \\ldots, S_{T-1}}[ L(\\bar {\\bm w}^{T})] \n  - L^\\star \\\\\n  \\leq \\frac{1}{\\gamma T}\\|{\\bm w}_0 - {\\bm w}^\\star\\|_2^2 + 2\\gamma \\sigma^2.')
('5.1.1.1', '\\sigma_1^2')
('5.1.1.1', 'm')
('5.1.1.1', '\\sigma_m = \\sigma_1^2/m')
('5.1.1.1', '\\gamma^t = t^{-1/2}')
('5.1.1.1', 'O((\\|{\\bm w}_0-{\\bm w}^\\star\\|_2^2 + \\sigma^2\\ln t)/\\sqrt(t))')
('5.1.1.1', '\\gamma_0')
('5.1.1.1', 'T_0')
('5.1.1.1', '\\gamma_j = \\rho \\gamma_{j-1}')
('5.1.1.1', '\\rho \\in\n(0, 1)')
('5.1.1.1', 'T_j, T_{j+1}')
('5.1.1.2', '\\begin{aligned}\n  {\\bm v}^{t+1} &\\coloneqq \\nu {\\bm v}^{t} + {\\bm g}({\\bm w}^{t}; S ^{t}) \\\\\n  {\\bm w}^{t+1} &\\coloneqq {\\bm w}^{t} - \\gamma {\\bm v}^{t+1}. \n\\end{aligned}')
('5.1.1.2', '\\begin{aligned}\n  {\\bm v}^{t+1} &\\coloneqq \\nu {\\bm v}^{t} \n  + {\\bm g}({\\bm w}^{t} + \\nu {\\bm v}^{t}; S ^{t}) \\\\\n  {\\bm w}^{t+1} &\\coloneqq {\\bm w}^{t} -  \\gamma {\\bm v}^{t+1}.\n\\end{aligned}')
('5.1.1.3', '\\begin{aligned}\n{\\bm m}^{t+1} &\\coloneqq \\nu_1  {\\bm m}^{t} + (1-\\nu_1) {\\bm g}^{t} \\\\\n{\\bm v}^{t+1} &\\coloneqq \\nu_2  {\\bm v}^{t} + (1-\\nu_2)  ({\\bm g}^{t})^2 \\\\\n\\hat{{\\bm m}}^{t+1} &\\coloneqq {\\bm m}^{t+1} / {(1-\\nu_1^t)} \\\\\n\\hat{{\\bm v}}^{t+1} &\\coloneqq {\\bm v}^{t+1} / {(1-\\nu_2^t)} \\\\\n{\\bm w}^{t+1} &\\coloneqq {\\bm w}^{t} - \\gamma \\ \n\\hat{{\\bm m}}^{t+1} / \\left({\\sqrt{\\hat{{\\bm v}}^{t+1} + \\varepsilon}} \\right),\n\\end{aligned}')
('5.1.1.3', '{\\bm g}^{t} \\coloneqq {\\bm g}({\\bm w}^{t}; S ^{t})')
('5.1.1.3', '({\\bm g}^{t})^2')
('5.1.1.3', '{\\bm g}^{t}')
('5.1.1.3', '\\nu_1, \\nu_2, \\gamma, \\varepsilon')
('5.1.1.3', '\\gamma')
('5.1.2', '\\min_{{\\bm w}\\in \\mathcal{C}} L({\\bm w}),\n\\label{optim:eq:constrained_pb}')
('5.1.2', '\\mathcal{C}\\subseteq \\mathcal{W}= \\mathbb{R}^P')
('5.1.2', '\\widehat {\\bm w}')
('5.1.2', '\\widehat {\\bm w}\\in \\mathcal{C}')
('5.1.2', 'L')
('5.1.2', '\\mathcal{C}')
('5.1.2', 'L')
('5.1.2', '\\mathcal{C}')
('5.1.2', '\\mathcal{C}')
('5.1.2', '\\mathrm{proj}_{\\mathcal{C}}({\\bm w}) \\coloneqq \\mathop{\\mathrm{arg\\,min}}_{{\\bm v}\\in \\mathcal{C}} \\|{\\bm w}-{\\bm v}\\|_2^2.')
('5.1.2', '\\mathcal{C}')
('5.1.2', '\\mathcal{C}')
('5.1.2', '\\mathcal{C}')
('5.1.2.0', '{\\bm w}^{t+1} \\coloneqq \\mathrm{proj}_{\\mathcal{C}}({\\bm w}^{t} - \\gamma \\nabla L({\\bm w}^{t})).')
('5.1.2.0', '{\\bm w}^{t+1} \n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{C}} \nL({\\bm w}^{t}) + \\langle \\nabla L({\\bm w}^{t}), {\\bm w}- {\\bm w}^{t} \\rangle \n+ \\frac{1}{2\\gamma} \\|{\\bm w}- {\\bm w}^{t}\\|_2^2.')
('5.1.2.0', '{\\bm w}^{t}')
('5.1.2.0', 'L')
('5.1.2.0', '{\\bm w}^{t}')
('5.1.2.0', '\\mathcal{C}')
('5.1.2.0', 'R(T) = O(1/T)')
('5.1.2.0', '\\nabla L({\\bm w})')
('5.1.2.0', '\\nabla L({\\bm w}; S)')
('5.1.2.1', '\\gamma > 0')
('5.1.2.1', '{\\bm w}^\\star')
('5.1.2.1', 'L')
('5.1.2.1', '\\mathcal{C}')
('5.1.2.1', '{\\bm w}^\\star = \\mathrm{proj}_{\\mathcal{C}}({\\bm w}^\\star - \\gamma \\nabla L({\\bm w}^\\star)).')
('5.1.2.1', '\\langle \\nabla L({\\bm w}^\\star), {\\bm w}- {\\bm w}^\\star \\rangle \\geq 0 \n\\quad \\forall {\\bm w}\\in {\\mathcal{C}}.')
('5.1.2.2', '\\mathcal{C}= \\mathbb{R}^P')
('5.1.2.2', '\\mathrm{proj}_{\\mathcal{C}}({\\bm w}) = {\\bm w}.')
('5.1.2.2', '\\mathcal{C}= [a, b]^P')
('5.1.2.2', '\\mathrm{proj}_{\\mathcal{C}}({\\bm w}) \n= \\mathrm{clip}({\\bm w}, a, b)\n\\coloneqq \\min\\{\\max\\{{\\bm w}, a\\}, b\\}.')
('5.1.2.2', '\\min')
('5.1.2.2', '\\max')
('5.1.2.2', '\\mathcal{C}= \\mathbb{R}_+^P')
('5.1.2.2', '\\mathrm{proj}_{\\mathcal{C}}({\\bm w}) \n= \\max\\{{\\bm w}, 0\\},')
('5.1.2.2', '\\mathcal{C}= \\triangle^P')
('5.1.2.2', '\\mathrm{proj}_{\\mathcal{C}}({\\bm w}) \n= \\max\\{{\\bm w}- \\tau \\operatorname{\\mathbf 1}, 0\\},')
('5.1.2.2', '\\tau \\in \\mathbb{R}')
('5.1.2.2', '\\mathrm{proj}_{\\mathcal{C}}({\\bm w})')
('5.1.2.2', '1')
('5.1.2.2', '\\tau')
('5.1.2.2', 'O(P \\log P)')
('5.1.2.2', 'O(P)')
('5.1.3', '\\mathcal{C}')
('5.1.3', '\\mathcal{C}')
('5.1.3', '\\iota_{\\mathcal{C}}({\\bm w})\n\\coloneqq\n\\begin{cases}\n0 &\\mbox{if } {\\bm w}\\in \\mathcal{C}\\\\\n+\\infty &\\mbox{otherwise}\n\\end{cases}.')
('5.1.3', '\\min_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) + \\iota_{\\mathcal{C}}({\\bm w}).')
('5.1.3', '\\min_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) + \\Omega({\\bm w}),')
('5.1.3', '\\Omega')
('5.1.3', '\\Omega')
('5.1.3', '\\Omega \\colon \\mathcal{W}\\to \\mathbb{R}')
('5.1.3', '\\mathrm{prox}_{\\Omega}({\\bm w}) \n\\coloneqq \\mathop{\\mathrm{arg\\,min}}_{{\\bm v}\\in \\mathcal{W}} \\frac{1}{2} \\|{\\bm w}-{\\bm v}\\|_2^2 + \\Omega({\\bm v}).')
('5.1.3.0', '{\\bm w}^{t+1} = \n\\mathrm{prox}_{\\gamma \\Omega}({\\bm w}^{t} - \\gamma \\nabla L({\\bm w}^{t})).')
('5.1.3.0', '{\\bm w}^{t+1} \n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \nL({\\bm w}^{t}) + \\langle \\nabla L({\\bm w}^{t}), {\\bm w}- {\\bm w}^{t} \\rangle \n+ \\frac{1}{2\\gamma} \\|{\\bm w}- {\\bm w}^{t}\\|_2^2 + \\Omega({\\bm w}).')
('5.1.3.0', 'L')
('5.1.3.0', '{\\bm w}^{t}')
('5.1.3.0', '\\Omega')
('5.1.3.0', '\\Omega')
('5.1.3.0', '{\\bm y}= (y_1, \\ldots, y_n)^\\top \\in \\mathbb{R}^N')
('5.1.3.0', '{\\bm X}= ({\\bm x}_1, \\ldots, {\\bm x}_n)^\\top\\in \\mathbb{R}^{N\\times P}')
('5.1.3.0', 'L({\\bm w}) = \\frac{1}{2}\\|{\\bm X}{\\bm w}- {\\bm y}\\|_2^2')
('5.1.3.0', '\\Omega({\\bm w}) = \\lambda \\|{\\bm w}\\|_1')
('5.1.3.0', '\\lambda > 0')
('5.1.3.0', '\\mathrm{prox}_{\\Omega}')
('5.1.3.0', 'O(1/T)')
('5.1.3.1', '{\\bm w}^\\star = \\mathrm{prox}_{\\gamma \\Omega}({\\bm w}^\\star - \\gamma \\nabla L({\\bm w}^\\star)),')
('5.1.3.1', '\\gamma > 0')
('5.1.3.2', '\\Omega({\\bm w}) = 0')
('5.1.3.2', '\\mathrm{prox}_{\\gamma\\Omega}({\\bm w}) = {\\bm w}.')
('5.1.3.2', '\\Omega({\\bm w}) = \\iota_C({\\bm w})')
('5.1.3.2', '\\mathrm{prox}_{\\gamma \\Omega}({\\bm w}) = \\mathrm{proj}_C({\\bm w}).')
('5.1.3.2', '\\Omega({\\bm w}) = \\lambda \\|{\\bm w}\\|_1')
('5.1.3.2', '\\mathrm{prox}_{\\gamma \\Omega}({\\bm w}) \n= (\\mathrm{sign}({\\bm w}) \\cdot \\max(|{\\bm w}| - \\gamma \\lambda, 0)),')
('5.1.3.2', '\\Omega({\\bm w}) = \\lambda \\sum_{g \\in G} \\|{\\bm w}_g\\|_2')
('5.1.3.2', 'G')
('5.1.3.2', '[P]')
('5.1.3.2', '{\\bm w}_g')
('5.1.3.2', 'g')
('5.1.3.2', '\\left[\\mathrm{prox}_{\\gamma \\Omega}({\\bm w})\\right]_g\n= \n\\max(1 - \\lambda \\cdot \\gamma / \\|{\\bm w}_g\\|_2, 0) {\\bm w}_g,')
('5.2', '{\\bm w}^{t+1} \\coloneqq {\\bm w}^t - \\gamma^t B^t \\nabla L({\\bm w}^t),')
('5.2', '\\gamma^t')
('5.2', 'B^t')
('5.2.0.0', 'L({\\bm w})')
('5.2.0.0', 'L({\\bm w})')
('5.2.0.0', '{\\bm w}^t')
('5.2.0.0', 'L({\\bm w}) \\approx L({\\bm w}^t) + \\langle\n\\nabla L({\\bm w}^t), {\\bm w}-{\\bm w}^t\\rangle + \\frac{1}{2}\\langle {\\bm w}-{\\bm w}^t, \\nabla^2 L({\\bm w}^t)({\\bm w}\n-{\\bm w}^t) \\rangle.')
('5.2.0.0', '{\\bm w}^t')
('5.2.0.0', '\\begin{aligned}\n  {\\bm w}^{t+1} \n  = \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \n  L({\\bm w}^t) \n  + \\langle \\nabla L({\\bm w}^t), {\\bm w}{-}{\\bm w}^t\\rangle  \n  + \\frac{1}{2}\\langle {\\bm w}{-}{\\bm w}^t, \\nabla^2 L({\\bm w}^t)({\\bm w}{-}{\\bm w}^t) \\rangle. \n  \\label{optim:eq:newton}\n\\end{aligned}')
('5.2.0.0', '{\\bm w}^t')
('5.2.0.0', '\\nabla^2\nL({\\bm w}^t) \\succ 0')
('5.2.0.0', 'L')
('5.2.0.0', '{\\bm w}^{t+1} = {\\bm w}^t - \\nabla^2 L({\\bm w}^t)^{-1}\\nabla L({\\bm w}^t).')
('5.2.0.0', '\\nabla^2 L({\\bm w}) \\prec 0')
('5.2.0.1', '\\frac{1}{2} \\|{\\bm w}-{\\bm w}^t\\|_2^2')
('5.2.0.1', '{\\bm w}^t')
('5.2.0.1', '\\begin{aligned}\n{\\bm w}^{t+1} \n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} ~\n&L({\\bm w}^t) + \\langle \\nabla L({\\bm w}^t), {\\bm w}{-}{\\bm w}^t\\rangle\n\\frac{1}{2}\\langle {\\bm w}{-}{\\bm w}^t, \\nabla^2 L({\\bm w}^t)({\\bm w}{-}{\\bm w}^t) \\rangle  \\\\\n&+ \\frac{\\eta^t}{2} \\|{\\bm w}-{\\bm w}^t\\|_2^2,\n\\end{aligned}')
('5.2.0.1', '\\eta^t')
('5.2.0.1', '\\eta^t > 0')
('5.2.0.1', '\\nabla^2 L({\\bm w}^t) + \\eta^t \\operatorname{I}')
('5.2.0.1', '{\\bm w}^{t+1} = {\\bm w}^t - {\\bm d}^t,')
('5.2.0.1', '{\\bm d}^t \\coloneqq (\\nabla^2 L({\\bm w}^t) + \\eta^t \\operatorname{I})^{-1} \\nabla L({\\bm w}^t).\n\\label{optim:eq:reg_newton_direction}')
('5.2.0.2', '{\\bm d}^t')
('5.2.0.2', '\\nabla L({\\bm w}^t)')
('5.2.0.2', '(\\nabla^2 L({\\bm w}^t) + \\eta^t \\operatorname{I}) {\\bm d}^t =  \\nabla L({\\bm w}^t),')
('5.2.0.2', 'O(P^3)')
('5.2.0.3', '{\\bm w}^0 \\in \\mathcal{W}')
('5.2.0.3', '{\\bm w}^\\star')
('5.2.0.3', '\\mu')
('5.2.0.3', 'M')
('5.2.0.3', '\\|{\\bm w}^0 -{\\bm w}^*\\|_2\\leq \\frac{2\\mu}{3M}')
('5.2.0.3', 'R(t) \\leq\nO(\\exp(\\exp(-t))')
('5.2.0.4', '{\\bm w}^{t+1} = {\\bm w}^t - {\\bm d}^t')
('5.2.0.4', '{\\bm d}^t')
('5.2.0.4', '{\\bm d}\\in \\mathcal{W}')
('5.2.0.4', '-{\\bm d}')
('5.2.0.4', 'L')
('5.2.0.4', '{\\bm w}')
('5.2.0.4', '\\gamma >0')
('5.2.0.4', 'L({\\bm w}- \\gamma {\\bm d}) \\leq L({\\bm w}).')
('5.2.0.4', 'L')
('5.2.0.4', '-{\\bm d}')
('5.2.0.4', '\\langle -{\\bm d},\n  \\nabla L({\\bm w}) \\rangle <0')
('5.2.0.4', '{\\bm d}^t = \\nabla^2 L({\\bm w}^t)^{-1}\\nabla L({\\bm w}^t)')
('5.2.0.4', '{\\bm w}^t')
('5.2.0.4', '\\nabla L({\\bm w}^t) \\neq 0')
('5.2.0.4', '\\nabla^2\nL({\\bm w}^t)\\succ0')
('5.2.0.4', '\\nabla^2 L({\\bm w}^t)\\not \\succ 0')
('5.2.0.4', '\\eta^t >0')
('5.2.0.4', '\\nabla^2 L({\\bm w}^t) + \\eta^t \\operatorname{I}\\succ 0')
('5.2.0.4', '{\\bm d}^t = -\n(\\nabla^2 L({\\bm w}^t) +\\eta^t\\operatorname{I})^{-1}\\nabla L({\\bm w}^t)')
('5.2.0.4', '\\nabla L({\\bm w}^t) \\neq 0')
('5.2.0.4', '{\\bm w}^{t+1} = {\\bm w}^t - \\gamma^t {\\bm d}^t')
('5.2.0.4', '\\gamma^t')
('5.2.0.4', '\\{\\rho^\\tau, \\tau \\in\n\\mathbb{N}\\}')
('5.2.0.4', '\\rho \\in (0, 1)')
('5.2.0.4', 'c \\in (0, 1)')
('5.2.0.4', 'L({\\bm w}^t - \\gamma^t {\\bm d}^t) \\leq L({\\bm w}^t) \n  - c \\gamma^t\n  \\langle \\nabla L({\\bm w}^t), \\nabla^2 L({\\bm w}^t)^{-1}\\nabla L({\\bm w}^t) \\rangle.')
('5.2.0.4', '\\gamma^t <1')
('5.2.0.4', '\\gamma^t = 1')
('5.2.0.5', 'L({\\bm w}) = \\frac{1}{2} a\nw_1^2 + \\frac{1}{2} b w_2^2')
('5.2.0.5', 'a\\gg b \\geq 0')
('5.2.0.5', '\\nabla L({\\bm w}) = (a w_1, b w_2)^\\top')
('5.2.0.5', '(a, b)')
('5.2.0.5', '{\\bm w}^{t+1} =\n{\\bm w}^t - \\gamma \\operatorname{\\bf diag}(a^{-1}, b^{-1})L({\\bm w}^t),')
('5.2.0.5', '\\gamma = 1')
('5.2.0.5', '{\\bm w}^\\star')
('5.2.0.5', 't')
('5.2.0.5', '\\tilde L({\\bm v}) = L(A {\\bm v}) \n  \\ \\mbox{for} \\ \n  A = \\nabla^2 L({\\bm w}^t)^{-1/2},')
('5.2.0.5', 'L')
('5.2.0.5', 'A')
('5.2.0.5', '\\tilde L')
('5.2.0.5', '{\\bm v}^{t+1}  = {\\bm v}^t - \\nabla \\tilde L({\\bm v}^t) \n\\ \\iff \\ \n{\\bm w}^{t+1} = {\\bm w}^t - (\\nabla^2 L({\\bm w}^t))^{-1} \\nabla L({\\bm w}^t)')
('5.2.0.5', '{\\bm w}^t = A {\\bm v}^t = \\nabla^2 L({\\bm w}^t)^{-1/2} {\\bm v}^t.')
('5.2.0.5', 'A')
('5.2.0.5', 'L({\\bm w}) = \\frac{1}{2}a w_1^2 +\n    \\frac{1}{2} b w_2^2')
('5.2.0.5', 'a\\gg b \\geq 0')
('5.2.0.6', '\\min_{{\\bm w}\\in \\mathcal{W}} \\ \nL({\\bm w}) \\coloneqq \\mathbb{E}_{S \\sim \\rho} \\left[L({\\bm w}; S)\\right].')
('5.2.0.6', '\\mathbb{E}_{S \\sim \\rho} \\left[\\nabla^2 L({\\bm w}; S)\\right] = \\nabla^2 L({\\bm w}).')
('5.2.0.6', "g({\\bm w}; S) \\approx \\nabla L({\\bm w}), \\quad H({\\bm w}; S') \\approx \\nabla^2 L({\\bm w})")
('5.2.0.6', "S, S'")
('5.2.0.6', 'p')
('5.2.0.6', "{\\bm w}^{t+1} = {\\bm w}^t - \\gamma^t (H({\\bm w}^t; S') + \\eta^t \\operatorname{I})^{-1}{\\bm g}({\\bm w}^t; S),")
('5.2.0.6', '\\eta^t \\geq 0')
('5.2.0.6', "(H({\\bm w}^t; S') + \\eta^t)^{-1} \\succ 0")
('5.2.0.6', '\\gamma^t')
('5.2.1.0', 'L({\\bm w}) \\coloneqq \\ell(f({\\bm w})),')
('5.2.1.0', '\\ell: \\mathcal{M}\\rightarrow \\mathbb{R}')
('5.2.1.0', 'f: \\mathcal{W}\\rightarrow \\mathcal{M}')
('5.2.1.0', '{\\bm w}\\in \\mathcal{W}')
('5.2.1.0', 'L({\\bm w})')
('5.2.1.0', '{\\bm w}^t')
('5.2.1.0', 'f')
('5.2.1.0', '{\\bm w}^t')
('5.2.1.0', 'f({\\bm w}) \\approx f({\\bm w}^t) + \\partial f({\\bm w}^t) ({\\bm w}-{\\bm w}^t)')
('5.2.1.0', '\\ell')
('5.2.1.0', '\\begin{aligned}\n{\\bm w}^{t+1} \n&\\coloneqq \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \\ell(f({\\bm w}^t) + \\partial f({\\bm w}^t) ({\\bm w}-{\\bm w}^t)) \\\\\n&= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \\ell(\\partial f({\\bm w}^t) {\\bm w}+ f({\\bm w}^t) -\\partial\nf({\\bm w}^t){\\bm w}^t) \\\\\n&= \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \\ell(J^t {\\bm w}+ {\\bm \\delta}^t),\n\\end{aligned}')
('5.2.1.0', 'J^t \\coloneqq \\partial f({\\bm w}^t)')
('5.2.1.0', '{\\bm \\delta}^t \\coloneqq f({\\bm w}^t) - \\partial f({\\bm w}^t){\\bm w}^t')
('5.2.1.0', '\\ell(J^t {\\bm w}+ {\\bm \\delta}^t)')
('5.2.1.0', 'L = \\ell \\circ f')
('5.2.1.0', '{\\bm w}^t')
('5.2.1.0', 'L')
('5.2.1.0', 'L({\\bm w})')
('5.2.1.0', '{\\bm w}^{t+1} \n\\coloneqq \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} \\ell(J^t {\\bm w}+ {\\bm \\delta}^t) \n+ \\frac{\\eta^t}{2} \\|{\\bm w}- {\\bm w}^t\\|_2^2.\n\\label{optim:eq:modified_gauss_newton}')
('5.2.1.0', '\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) + \\frac{\\eta^t}{2} \\|{\\bm w}- {\\bm w}^t\\|_2^2,')
('5.2.1.0', 'L({\\bm w})')
('5.2.1.0', '{\\bm w}\\mapsto \\ell(J^t {\\bm w}+ \\delta^t)')
('5.2.1.0', '{\\bm w}\\mapsto (J^t)^* \\nabla \\ell(J^t {\\bm w}+ \\delta^t)')
('5.2.1.0', 'J^t {\\bm w}')
('5.2.1.0', '(J^t)^* \\nabla \\ell({\\bm z})')
('5.2.1.0', '\\ell({\\bm z})')
('5.2.1.0', '\\ell({\\bm z}) \\coloneqq \\frac{1}{2} \\|{\\bm z}- {\\bm y}\\|^2_2')
('5.2.1.0', '{\\bm y}')
('5.2.1.0', '\\eta^t = 0')
('5.2.1.0', '\\eta^t')
('5.2.1.1', '\\ell')
('5.2.1.1', '{\\bm z}^t \\coloneqq f({\\bm w}^t)')
('5.2.1.1', 'q^t({\\bm z}) \\coloneqq \\ell({\\bm z}^t) \n+ \\langle \\nabla \\ell({\\bm z}^t), {\\bm z}-{\\bm z}^t\\rangle \n+ \\frac{1}{2}\\langle {\\bm z}-{\\bm z}^t, \\nabla^2 \\ell({\\bm z}^t) ({\\bm z}-{\\bm z}^t)\\rangle\n\\approx \\ell({\\bm z})')
('5.2.1.1', '{\\bm w}^{t+1} \\coloneqq \n\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} q^t(J^t {\\bm w}+ \\delta^t)\n+ \\frac{\\eta^t}{2} \\|{\\bm w}- {\\bm w}^t\\|_2^2.')
('5.2.1.1', '\\ell')
('5.2.1.1', 'q^t')
('5.2.1.1', 'f')
('5.2.1.1', '\\begin{aligned}\n{\\bm w}^{t+1} = \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} ~\n&L({\\bm w}^t) + \\langle {\\bm q}^t, J^t({\\bm w}{-} {\\bm w}^t) \\rangle \\\\\n& + \\frac{1}{2} \\langle {\\bm w}{-} {\\bm w}^t, \n  (J^t)^* Q^t J^t ({\\bm w}{-} {\\bm w}^t) \\rangle \n +\\frac{\\eta^t}{2} \\|{\\bm w}- {\\bm w}^t\\|^2_2\n\\end{aligned}')
('5.2.1.1', '{\\bm q}^t \\coloneqq \\nabla \\ell(f({\\bm w}^t)) \\in \\mathcal{M}=\\mathbb{R}^Z, \n    Q^t \\coloneqq \\nabla^2 \\ell(f({\\bm w}^t)) \\in \\mathbb{R}^{Z \\times Z}.')
('5.2.1.1', '\\begin{aligned}\n{\\bm w}^{t+1} \n&= {\\bm w}^t - ((J^t)^* Q^t J^t + \\eta^t \\operatorname{I})^{-1} (J^t)^* {\\bm q}^t \\\\\n&= {\\bm w}^t - (\\nabla^2_{\\mathrm{GN}}(\\ell \\circ f) ({\\bm w}^t) + \\eta^t \\operatorname{I})^{-1} \\nabla L({\\bm w}^t),\n\\end{aligned}')
('5.2.1.1', 'L = \\ell \\circ f')
('5.2.1.2', '-(\\nabla^2_{\\mathrm{GN}}(\\ell\\circ f)({\\bm w}^t) + \\eta^t\n\\operatorname{I})^{-1} \\nabla L({\\bm w}^t)')
('5.2.1.2', '\\eta^t >0')
('5.2.1.2', '\\gamma^t')
('5.2.1.2', '{\\bm w}^{t+1} = \n{\\bm w}^t - \\gamma^t(\\nabla^2_{\\mathrm{GN}}(\\ell\\circ f)({\\bm w}^t) + \\eta^t \\operatorname{I})^{-1} \\nabla L({\\bm w}^t).')
('5.2.1.3', 'L({\\bm w}) \n= \\mathbb{E}_{S \\sim \\rho} [L({\\bm w}; S)] \n= \\mathbb{E}_{(X, Y) \\sim \\rho}[\\ell(f({\\bm w}; X); Y)]')
('5.2.1.3', 'S = (X, Y)')
('5.2.1.3', 'X')
('5.2.1.3', 'Y')
('5.2.1.3', '\\nabla^2_{\\mathrm{GN}}L')
('5.2.1.3', '\\begin{aligned}\n\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, {\\bm y}) \n& \\coloneqq \\partial f({\\bm w}; {\\bm x})^\\top \\nabla^2 \\ell(f({\\bm w}; {\\bm x})) \\partial f({\\bm w}; {\\bm x}), \\\\\n\\nabla^2_{\\mathrm{GN}}L ({\\bm w}) & \\coloneqq \\mathbb{E}_{(X, Y)\\sim\n  \\rho}[\\nabla^2_{\\mathrm{GN}}L({\\bm w}; {\\bm x}, {\\bm y})]. \\nonumber\n\\end{aligned}')
('5.2.1.3', '{\\bm g}({\\bm w};\nS) \\approx \\nabla L({\\bm w})')
('5.2.1.3', "G({\\bm w}; S') \\approx \\nabla^2_{\\mathrm{GN}}L({\\bm w})")
('5.2.1.3', "S, S' \\sim \\rho")
('5.2.1.3', "{\\bm w}^{t+1} \\coloneqq {\\bm w}^t - \\gamma^t(G({\\bm w}; S') + \\eta^t \\operatorname{I})^{-1} {\\bm g}({\\bm w}, S),")
('5.2.1.3', '\\eta^t \\geq 0')
('5.2.1.3', '\\gamma^t')
('5.2.2.0', '\\min_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) \n= \\mathbb{E}_{S \\sim \\rho} \\left[L({\\bm w}; S)\\right]\n= \\mathbb{E}_{S \\sim \\rho} \\left[-\\log q_{\\bm w}(S)\\right],')
('5.2.2.0', '\\rho')
('5.2.2.0', 'q_{\\bm w}')
('5.2.2.0', '{\\bm w}')
('5.2.2.0', 'S=Y')
('5.2.2.0', 'q_{\\bm w}(Y)')
('5.2.2.0', 'S=(X,Y)')
('5.2.2.0', '\\mathbb{P}(X, Y) = \\mathbb{P}(X) \\mathbb{P}(Y|X)')
('5.2.2.0', 'q_{\\bm w}(S)')
('5.2.2.0', 'q_{\\bm w}({\\bm x}, {\\bm y}) \\coloneqq \\rho_X({\\bm x}) p_{\\bm \\theta}({\\bm y}),')
('5.2.2.0', '\\rho_X')
('5.2.2.0', 'X')
('5.2.2.0', 'p_{\\bm \\theta}({\\bm y})')
('5.2.2.0', '{\\bm \\theta}= f({\\bm w}; {\\bm x})')
('5.2.2.0', '{\\bm w}\n\\in \\mathcal{W}')
('5.2.2.0', '{\\bm x}\\in \\mathcal{X}')
('5.2.2.1', '{\\bm w}^{t+1} = \n  \\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}^t) \n  + \\langle \\nabla L({\\bm w}^t), {\\bm w}- {\\bm w}^t\\rangle \n  + \\mathrm{KL}(q_{{\\bm w}^t},q_{\\bm w}),')
('5.2.2.1', '\\mathrm{KL}(p,q) \\coloneqq \\int p({\\bm z}) \\log \\frac{p({\\bm z})}{q({\\bm z})} d{\\bm z}')
('5.2.2.1', 'q_{{\\bm w}^t}')
('5.2.2.1', 'q_{{\\bm w}}')
('5.2.2.1', '\\mathrm{KL}(q_{{\\bm w}^t}, q_{\\bm w}) \\approx \n\\frac{1}{2}\\langle {\\bm w}- {\\bm w}^t, \\nabla^2_{\\mathrm{F}}L ({\\bm w}^t)({\\bm w}-{\\bm w}^t)\\rangle')
('5.2.2.1', '\\nabla^2_{\\mathrm{F}}L ({\\bm w})')
('5.2.2.1', '\\begin{aligned}\n{\\bm w}^{t+1} \\coloneqq \n\\mathop{\\mathrm{arg\\,min}}_{{\\bm w}\\in \\mathcal{W}} ~\n&L({\\bm w}^t) \n+ \\langle \\nabla L({\\bm w}^t), {\\bm w}- {\\bm w}^t\\rangle \\\\\n& + \\frac{1}{2}\\langle {\\bm w}- {\\bm w}^t, \\nabla^2_{\\mathrm{F}}L ({\\bm w}^t)({\\bm w}-{\\bm w}^t)\\rangle\n  + \\frac{\\eta^t}{2}\\|{\\bm w}-{\\bm w}^t\\|^2_2,\n\\end{aligned}')
('5.2.2.1', '\\nabla^2_{\\mathrm{F}}L({\\bm w}^t)')
('5.2.2.1', '{\\bm w}^{t+1} = {\\bm w}^t - (\\nabla^2_{\\mathrm{F}}L ({\\bm w}^t) + \\eta^t \\operatorname{I})^{-1}\\nabla L({\\bm w}^t).')
('5.2.2.1', 'p_{\\bm \\theta}')
('5.2.2.2', '\\nabla L({\\bm w}^t)')
('5.2.2.2', '\\rho')
('5.2.2.2', '\\nabla^2_{\\mathrm{F}}L({\\bm w}^t)')
('5.2.2.2', '{\\bm \\theta}\\coloneqq f({\\bm w}, X)')
('5.2.2.2', '\\nabla^2_{\\mathrm{F}}L({\\bm w}) = \\mathbb{E}_{X \\sim \\rho_X} \\mathbb{E}_{Y \\sim p_{\\bm \\theta}}\n[\\nabla L({\\bm w}; X, Y) \\otimes \\nabla L({\\bm w}; X, Y)].')
('5.2.2.2', '{\\bm g}({\\bm w}^t; S) \\approx \\nabla L({\\bm w}^t, S)')
('5.2.2.2', "F({\\bm w}^t; S') \\approx \\nabla^2_{\\mathrm{F}}L({\\bm w}^t)")
('5.2.2.2', 'S')
('5.2.2.2', '\\rho')
('5.2.2.2', "S'")
('5.2.2.2', 'q_{{\\bm w}^t}({\\bm x}, {\\bm y}) = p_\\mathcal{X}({\\bm x})\n\\rho_{{\\bm \\theta}}({\\bm y})')
('5.2.2.2', "{\\bm w}^{t+1} = {\\bm w}^t - \\gamma^t(F({\\bm w}^t; S') + \\eta^t \\operatorname{I})^{-1}{\\bm g}({\\bm w}^t; S),")
('5.2.2.2', '\\gamma^t')
('5.2.3.0', 'h^t({\\bm w}) = L({\\bm w}^t) + \\langle \\nabla L({\\bm w}^t), {\\bm w}\n- {\\bm w}^t\\rangle + \\frac{1}{2} \\langle {\\bm w}- {\\bm w}^t, Q^t ({\\bm w}-{\\bm w}^t) \\rangle')
('5.2.3.0', 'Q^t')
('5.2.3.0', '\\nabla^2 L({\\bm w}^t)')
('5.2.3.0', '\\nabla h^t({\\bm w}^t) =\n\\nabla L({\\bm w}^t)')
('5.2.3.0', '\\nabla h^t({\\bm w}^{t-1})= \\nabla L({\\bm w}^{t-1})')
('5.2.3.0', '\\begin{aligned}\n  &\\nabla h^t({\\bm w}^t) - \\nabla h^t({\\bm w}^{t-1}) = \\nabla L({\\bm w}^t) - \\nabla L({\\bm w}^{t-1})\\\\\n    \\iff& Q^t ({\\bm w}^t - {\\bm w}^{t-1}) = \\nabla L({\\bm w}^t) - \\nabla L({\\bm w}^{t-1})\\\\\n    \\iff& {\\bm w}^t - {\\bm w}^{t-1} = B^t(\\nabla L({\\bm w}^t) - \\nabla L({\\bm w}^{t-1})),\n\\end{aligned}')
('5.2.3.0', 'B^t = (Q^t)^{-1}')
('5.2.3.0', 'B^t')
('5.2.3.0', 'B^{t+1} \\coloneqq \n\\left(\\operatorname{I}- \\rho^t {\\bm s}^t ({\\bm y}^t)^\\top \\right)\nB^t \n\\left(\\operatorname{I}- \\rho^t {\\bm s}^t ({\\bm y}^t)^\\top\\right)\n+ \\rho^t {\\bm s}^t ({\\bm s}^t)^\\top')
('5.2.3.0', '\\begin{aligned}\n  {\\bm s}^t &\\coloneqq {\\bm w}^{t+1} - {\\bm w}^t \\\\\n  {\\bm y}^t &\\coloneqq \\nabla L({\\bm w}^{t+1}) - \\nabla L({\\bm w}^t) \\\\\n  \\rho^t &\\coloneqq \\frac{1}{\\langle {\\bm s}^t, {\\bm y}^t \\rangle}.\n\\end{aligned}')
('5.2.3.0', 'B_t \\in \\mathbb{R}^{P \\times P}')
('5.2.3.0', 'P')
('5.2.3.1', 'B_t')
('5.2.3.1', '\\nabla L({\\bm w}^t)')
('5.2.3.1', 'B_t')
('5.2.3.1', 'B^t')
('5.2.3.1', '{\\bm v}')
('5.2.3.1', '({\\bm s}^1, {\\bm y}^1, \\rho^1), \\dots, ({\\bm s}^t, {\\bm y}^t, \\rho^t)')
('5.2.4', 'B^t \\coloneqq \\operatorname{\\bf diag}(|H_{11}^t|^{-1}, \\ldots, |H_{PP}^t|^{-1}).')
('5.2.5', '{\\bm w}^{t+1} \\coloneqq {\\bm w}^t - \\gamma^t B^t \\nabla L({\\bm w}^t)')
('5.2.5', 'B^t \\nabla L({\\bm w}^t)')
('5.2.5', 'L')
('5.3.0', '\\|{\\bm u}\\|')
('5.3.0', '\\|{\\bm v}\\|_* \n\\coloneqq \n\\max_{\\|{\\bm u}\\| \\le 1} \\langle {\\bm u}, {\\bm v}\\rangle.')
('5.3.0', '\\|\\cdot\\|')
('5.3.0', '\\|\\cdot\\|')
('5.3.0', 'B_{\\|\\cdot\\|} \\coloneqq \\{{\\bm u}\\in \\mathbb{R}^D \\colon \\|{\\bm u}\\| \\le 1\\}.')
('5.3.0', 'p')
('5.3.0', '\\|{\\bm u}\\|_p \\coloneqq \n\\left(\n\\sum_{j=1}^D |u_j|^p\n\\right)^{1/p}.')
('5.3.0', '\\|{\\bm v}\\|_q')
('5.3.0', 'q')
('5.3.0', '\\frac{1}{p} + \\frac{1}{q} = 1')
('5.3.0', '2')
('5.3.0', '\\frac{1}{2} +\n\\frac{1}{2} = 1')
('5.3.0', '1')
('5.3.0', '\\infty')
('5.3.0', '\\frac{1}{1} + \\frac{1}{\\infty} = 1')
('5.3.0', '{\\bm u}, {\\bm v}\\in \\mathbb{R}^D')
('5.3.0', '|\\langle {\\bm u}, {\\bm v}\\rangle|\n\\le\n\\|{\\bm u}\\|_* \\|{\\bm v}\\|.')
('5.3.0', 'f({\\bm u}) = \\|{\\bm u}\\|')
('5.3.0', 'f^*({\\bm v}) \n= \\iota_{B_{\\|\\cdot\\|}}({\\bm v})\n= \\begin{cases}\n    0 &\\mbox{ if } \\|{\\bm v}\\|_* \\le 1 \\\\\n    \\infty &\\mbox { otherwise }\n\\end{cases}.')
('5.3.0', 'f({\\bm u}) = \\frac{1}{2} \\|{\\bm u}\\|^2')
('5.3.0', 'f^*({\\bm v}) = \\frac{1}{2} \\|{\\bm v}\\|^2_*.')
('5.3.1', '\\min_{{\\bm w}\\in \\mathcal{W}} L({\\bm w}) \\coloneqq\n\\min_{{\\bm w}\\in \\mathcal{W}} \\ell(f({\\bm w})) + R({\\bm w}),')
('5.3.1', 'f \\colon \\mathcal{W}\\to \\mathcal{M}')
('5.3.1', '\\ell \\colon \\mathcal{M}\\to \\mathbb{R}')
('5.3.1', 'R \\colon \\mathcal{W}\\to \\mathbb{R}')
('5.3.1', 'f \\colon \\mathcal{W}\\to \\mathcal{M}')
('5.3.1', '\\ell \\colon \\mathcal{M}\\to \\mathbb{R}')
('5.3.1', 'R \\colon \\mathcal{W}\\to \\mathbb{R}')
('5.3.1', '\\min_{{\\bm w}\\in \\mathcal{W}} \\ell(f({\\bm w})) + R({\\bm w})\n\\ge\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n-R^f({\\bm \\alpha}) - \\ell^*(-{\\bm \\alpha}),')
('5.3.1', '\\ell^*(-{\\bm \\alpha}) \\coloneqq \n\\max_{{\\bm \\theta}\\in \\mathcal{M}} \\langle -{\\bm \\alpha}, {\\bm \\theta}\\rangle -\n\\ell({\\bm \\theta})')
('5.3.1', 'R^{f}({\\bm \\alpha}) \\coloneqq \n\\max_{{\\bm w}\\in \\mathcal{W}}\n\\langle {\\bm \\alpha}, f({\\bm w}) \\rangle - R({\\bm w}).')
('5.3.1', '\\ell^*')
('5.3.1', 'R^f')
('5.3.1', 'f')
('5.3.1', '\\ell')
('5.3.1', 'R')
('5.3.1', 'R^f')
('5.3.1', '\\ell^*')
('5.3.1', 'f')
('5.3.1', '\\ell')
('5.3.1', 'R')
('5.3.1', '\\begin{aligned}\n&\\min_{{\\bm w}\\in \\mathcal{W}} \\ell(f({\\bm w})) + R({\\bm w})\\\\\n=& \\min_{\\substack{{\\bm w}\\in \\mathcal{W}\\\\{\\bm \\theta}\\in \\mathcal{M}}}\n\\ell({\\bm \\theta}) + R({\\bm w})\n\\quad \\text{s.t.} \\quad {\\bm \\theta}= f({\\bm w}) \\\\\n=& \\min_{\\substack{{\\bm w}\\in \\mathcal{W}\\\\{\\bm \\theta}\\in \\mathcal{M}}}\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n\\ell({\\bm \\theta}) + R({\\bm w}) + \\langle {\\bm \\alpha}, {\\bm \\theta}- f({\\bm w}) \\rangle \\\\\n\\ge&\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n\\min_{\\substack{{\\bm w}\\in \\mathcal{W}\\\\{\\bm \\theta}\\in \\mathcal{M}}}\n\\ell({\\bm \\theta}) + R({\\bm w}) + \\langle {\\bm \\alpha}, {\\bm \\theta}- f({\\bm w}) \\rangle \\\\\n=&\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n\\min_{{\\bm w}\\in \\mathcal{W}}\n\\langle {\\bm \\alpha}, -f({\\bm w}) \\rangle + R({\\bm w})\n+\n\\min_{{\\bm \\theta}\\in \\mathcal{M}}\n\\ell({\\bm \\theta}) + \\langle {\\bm \\alpha}, {\\bm \\theta}\\rangle \\\\\n=&\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n-\\max_{{\\bm w}\\in \\mathcal{W}}\n\\langle {\\bm \\alpha}, f({\\bm w}) \\rangle - R({\\bm w})\n-\n\\max_{{\\bm \\theta}\\in \\mathcal{M}}\n\\langle -{\\bm \\alpha}, {\\bm \\theta}\\rangle - \\ell({\\bm \\theta}) \\\\\n=&\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n-R^f({\\bm \\alpha}) - \\ell^*(-{\\bm \\alpha}).\n\\end{aligned}')
('5.3.1', 'f({\\bm w}) = A {\\bm w}')
('5.3.1', 'A')
('5.3.1', '\\ell')
('5.3.1', 'R')
('5.3.1', 'A')
('5.3.1', '\\mathcal{W}')
('5.3.1', '\\mathcal{M}')
('5.3.1', '\\ell \\colon \\mathcal{M}\\to \\mathbb{R}')
('5.3.1', 'R \\colon \\mathcal{W}\\to \\mathbb{R}')
('5.3.1', 'A^*')
('5.3.1', 'A')
('5.3.1', '\\min_{{\\bm w}\\in \\mathcal{W}} \\ell(A{\\bm w}) + R({\\bm w})\n=\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}}\n-R^*(A^*{\\bm \\alpha}) - \\ell^*(-{\\bm \\alpha}).')
('5.3.1', '{\\bm w}^\\star \n\\in \\mathop{\\mathrm{arg\\,max}}_{{\\bm w}\\in \\mathcal{W}} \\langle A {\\bm \\alpha}^\\star, {\\bm w}\\rangle - R({\\bm w}).')
('5.3.1', 'R')
('5.3.1', '{\\bm w}^\\star = \\nabla R^*(A^* {\\bm \\alpha}^\\star).')
('5.3.1', 'f({\\bm w}) = A{\\bm w}')
('5.3.1', '\\begin{aligned}\nR^{f}({\\bm \\alpha}) \n&\\coloneqq \n\\max_{{\\bm w}\\in \\mathcal{W}}\n\\langle {\\bm \\alpha}, f({\\bm w}) \\rangle - R({\\bm w}) \\\\\n&= \n\\max_{{\\bm w}\\in \\mathcal{W}}\n\\langle {\\bm \\alpha}, A{\\bm w}\\rangle - R({\\bm w}) \\\\\n&=\\max_{{\\bm w}\\in \\mathcal{W}}\n\\langle A^*{\\bm \\alpha}, {\\bm w}\\rangle - R({\\bm w}) \\\\\n&=R^*(A^*{\\bm \\alpha}).\n\\end{aligned}')
('5.3.1', '\\min \\max')
('5.3.1', '\\mathcal{M}')
('5.3.1', '\\mathcal{W}')
('5.3.1', '\\ell({\\bm \\theta}) \\coloneqq \\sum_{i=1}^N \\ell_i({\\bm \\theta}_i)')
('5.3.1', '{\\bm \\theta}= A{\\bm w}= (A_1 {\\bm w}, \\dots, A_N {\\bm w}) \\in \\mathcal{M}^N')
('5.3.1', 'A_i')
('5.3.1', '\\mathcal{W}')
('5.3.1', '\\mathcal{M}')
('5.3.1', '\\min_{{\\bm w}\\in \\mathcal{W}} \\sum_{i=1}^N \\ell_i(A_i {\\bm w}) + R({\\bm w})\n=\n\\max_{{\\bm \\alpha}\\in \\mathcal{M}^N}\n-R(A^*{\\bm \\alpha}) - \\sum_{i=1}^N \\ell_i^*(-{\\bm \\alpha}_i),')
('5.3.1', 'A^* {\\bm \\alpha}= (A_1^* {\\bm \\alpha}_1, \\dots, A_N^* {\\bm \\alpha}_N)')
('5.3.1', 'A_i {\\bm w}\\coloneqq {\\bm W}{\\bm x}_i,')
('5.3.1', '{\\bm W}\\in \\mathbb{R}^{M \\times D}')
('5.3.1', '{\\bm w}\\in \\mathcal{W}')
('5.3.1', '{\\bm x}_i \\in \\mathbb{R}^D')
('5.3.1', 'M')
('5.3.1', 'A_i^* {\\bm \\alpha}_i = {\\bm \\alpha}_i {\\bm x}_i^\\top.')
('5.3.1', '{\\bm y}_i \\in \\mathbb{R}^M')
('5.3.1', '{\\bm t}_i = \\phi({\\bm y}_i) = {\\bm y}_i')
('5.3.1', 'y_i \\in [M]')
('5.3.1', '{\\bm t}_i = \\phi(y_i) = {\\bm e}_{y_i}')
('5.3.1', '{\\bm \\mu}_i \\coloneqq {\\bm y}_i - {\\bm \\alpha}_i')
('5.3.1', '\\ell_i({\\bm \\theta}_i)')
('5.3.1', '\\ell_i^*(-{\\bm \\alpha}_i)')
('5.3.1', '\\frac{1}{2} \\|{\\bm \\theta}_i - {\\bm t}_i\\|^2_2')
('5.3.1', '\\frac{1}{2}\\|{\\bm \\alpha}_i\\|^2_2 - \\langle {\\bm t}_i, {\\bm \\alpha}_i \\rangle')
('5.3.1', '\\|{\\bm \\theta}_i - {\\bm t}_i\\|_1')
('5.3.1', '\\iota_{[-1,1]^M}({\\bm \\alpha}_i) - \\langle {\\bm t}_i, {\\bm \\alpha}_i \\rangle')
('5.3.1', '\\mathrm{LSE}({\\bm \\theta}_i) - \\langle {\\bm \\theta}, {\\bm t}_i \\rangle')
('5.3.1', '\\langle {\\bm \\mu}_i, \\log {\\bm \\mu}_i \\rangle + \\iota_{\\triangle^M}({\\bm \\mu}_i)')
('5.3.1', '\\max_{i \\in [M]} \\theta_i - \\theta_y')
('5.3.1', '\\iota_{\\triangle^M}({\\bm \\mu}_i)')
('5.3.1', '\\max_{i \\in [M]} [i \\neq y] + \\theta_i - \\theta_y')
('5.3.1', '\\iota_{\\triangle^M}({\\bm \\mu}_i) - \\langle \\operatorname{\\mathbf 1}- {\\bm t}_i, {\\bm \\mu}_i \\rangle')
('5.3.2', 'f \\colon \\mathbb{R}^D \\to \\mathbb{R}')
('5.3.2', '\\begin{aligned}\nB_f({\\bm u}, {\\bm v})\n&\\coloneqq f({\\bm u}) - f({\\bm v}) - \\langle \\nabla f({\\bm v}), {\\bm u}- {\\bm v}\\rangle \\\\\n&= \\langle \\nabla f({\\bm v}), {\\bm v}\\rangle - f({\\bm v}) - \n\\left[\\langle \\nabla f({\\bm v}), {\\bm u}\\rangle - f({\\bm u})\\right],\n\\end{aligned}')
('5.3.2', '{\\bm u}, {\\bm v}\\in \\mathop{\\mathrm{dom}}(f)')
('5.3.2', 'f({\\bm u})')
('5.3.2', '{\\bm u}\\mapsto f({\\bm v}) + \\langle \\nabla f({\\bm v}), {\\bm u}- {\\bm v}\\rangle')
('5.3.2', '{\\bm v}')
('5.3.2', 'f({\\bm u}) = \\frac{1}{2} \\|{\\bm u}\\|^2_2')
('5.3.2', '\\mathop{\\mathrm{dom}}(f) = \\mathbb{R}^D')
('5.3.2', 'B_f({\\bm u}, {\\bm v}) = \\frac{1}{2} \\|{\\bm u}- {\\bm v}\\|^2_2,')
('5.3.2', 'f({\\bm u}) = \\langle {\\bm u}, \\log {\\bm u}\\rangle')
('5.3.2', '\\mathop{\\mathrm{dom}}(f) = \\mathbb{R}_+^D')
('5.3.2', 'B_f({\\bm u}, {\\bm v}) = \n\\sum_{j=1}^D u_j \\log \\frac{u_j}{v_j}\n- \\sum_{j=1}^D u_j + \\sum_{j=1}^D v_j,')
('5.3.2.0', 'f \\colon \\mathbb{R}^D \\to \\mathbb{R}')
('5.3.2.0', 'B_f({\\bm u}, {\\bm v}) \\ge 0')
('5.3.2.0', '{\\bm u}, {\\bm v}\\in \\mathop{\\mathrm{dom}}(f)')
('5.3.2.0', 'B_f({\\bm u}, {\\bm v}) = 0')
('5.3.2.0', '{\\bm u}= {\\bm v}')
('5.3.2.0', 'f')
('5.3.2.0', 'B_f({\\bm u}, {\\bm v})')
('5.3.2.0', '{\\bm u}')
('5.3.2.0', 'B_f({\\bm u}, {\\bm v}) = B_{f^*}({\\bm b}, {\\bm a})')
('5.3.2.0', '{\\bm b}= \\nabla f({\\bm v}) \\in \\mathop{\\mathrm{dom}}(f^*)')
('5.3.2.0', '{\\bm a}= \\nabla f({\\bm u}) \\in \\mathop{\\mathrm{dom}}(f^*)')
('5.3.2.0', 'f({\\bm u})')
('5.3.2.0', '{\\bm u}\\mapsto B_f({\\bm u}, {\\bm v})')
('5.3.2.0', 'f({\\bm u})')
('5.3.2.0', '{\\bm u}')
('5.3.2.0', 'f')
('5.3.2.0', 'f({\\bm u})')
('5.3.2.0', '{\\bm v}')
('5.3.2.0', '{\\bm v}\\in \\mathop{\\mathrm{dom}}(f)')
('5.3.2.0', '\\mathrm{bprox}_{f,g}({\\bm v}) \n\\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm u}\\in \\mathop{\\mathrm{dom}}(f) \\cap \\mathop{\\mathrm{dom}}(g)}\nB_f({\\bm u}, {\\bm v}) + g({\\bm u}).')
('5.3.2.0', '\\mathcal{C}\\subseteq \\mathop{\\mathrm{dom}}(f)')
('5.3.2.0', '\\mathrm{bproj}_{f,\\mathcal{C}}({\\bm v}) \n\\coloneqq\n\\mathop{\\mathrm{arg\\,min}}_{{\\bm u}\\in \\mathcal{C}} B_f({\\bm u}, {\\bm v}).')
('5.3.2.0', '\\Omega = f + g')
('5.3.2.0', '{\\bm \\theta}\\in \\mathop{\\mathrm{dom}}(f^*)')
('5.3.2.0', '\\nabla \\Omega^*({\\bm \\theta}) \n= \\mathrm{bprox}_{f,g}(\\nabla f^*({\\bm \\theta})).')
('5.3.2.0', '\\Omega = f + \\iota_C')
('5.3.2.0', '{\\bm \\theta}\\in \\mathop{\\mathrm{dom}}(f^*)')
('5.3.2.0', '\\nabla \\Omega^*({\\bm \\theta}) \n= \\mathrm{bproj}_{f,\\mathcal{C}}(\\nabla f^*({\\bm \\theta})).')
('5.3.2.0', 'f({\\bm u}) = \\frac{1}{2}\\|{\\bm u}\\|^2_2')
('5.3.2.0', '\\begin{aligned}\n\\mathrm{bproj}_{f, \\triangle^D}({\\bm v}) \n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm u}\\in \\triangle^D} \\frac{1}{2} \\|{\\bm u}- {\\bm v}\\|^2_2.\n\\end{aligned}')
('5.3.2.0', 'f({\\bm u}) = \\langle {\\bm u}, \\log {\\bm u}- \\operatorname{\\mathbf 1}\\rangle')
('5.3.2.0', '\\begin{aligned}\n\\mathrm{bproj}_{f, \\triangle^D}({\\bm v}) \n= \\mathop{\\mathrm{arg\\,min}}_{{\\bm u}\\in \\mathbb{R}^D_+} \\mathrm{KL}({\\bm u}, {\\bm v})\n= \\mathrm{softmax}({\\bm \\theta}),\n\\end{aligned}')
('5.3.2.0', '{\\bm v}= \\nabla f^*({\\bm \\theta}) = \\exp({\\bm \\theta})')
('5.3.3', '\\Omega')
('5.3.3', '\\ell_\\Omega({\\bm \\theta}, {\\bm t})\n\\coloneqq\n\\Omega^*({\\bm \\theta}) + \\Omega({\\bm t}) - \\langle {\\bm \\theta}, {\\bm t}\\rangle')
('5.3.3', '{\\bm \\theta}\\in \\mathop{\\mathrm{dom}}(\\Omega^*)')
('5.3.3', '{\\bm t}\\in \\mathop{\\mathrm{dom}}(\\Omega)')
('5.3.3', '{\\bm \\theta}= f({\\bm x}, {\\bm w})')
('5.3.3', 'f')
('5.3.3', '{\\bm w}')
('5.3.3', '{\\bm t}= \\phi({\\bm y})')
('5.3.3', '\\phi \\colon \\mathcal{Y}\\to \\mathop{\\mathrm{dom}}(\\Omega)')
('5.3.3', 'y \\in [M]')
('5.3.3', '\\phi(y) = {\\bm e}_y')
('5.3.3', '{\\bm e}_y')
('5.3.3', 'y')
('5.3.3', '{\\bm \\theta}')
('5.3.3', '{\\bm t}')
('5.3.3', 'B_\\Omega({\\bm t}, {\\bm v}) \n= \\Omega^*({\\bm \\theta}) + \\Omega({\\bm t}) - \\langle {\\bm \\theta}, {\\bm t}\\rangle')
('5.3.3', '{\\bm \\theta}= \\nabla \\Omega({\\bm v})')
('5.3.3', '\\ell_\\Omega({\\bm \\theta}, {\\bm t}) \\ge 0')
('5.3.3', '{\\bm \\theta}\\in \\mathop{\\mathrm{dom}}(\\Omega^*)')
('5.3.3', '{\\bm t}\\in \\mathop{\\mathrm{dom}}(\\Omega)')
('5.3.3', '\\ell_\\Omega({\\bm \\theta}, {\\bm t}) = 0')
('5.3.3', '\\nabla \\Omega^*({\\bm \\theta}) = {\\bm t}')
('5.3.3', '\\Omega')
('5.3.3', '\\ell_\\Omega({\\bm \\theta}, {\\bm t})')
('5.3.3', '{\\bm \\theta}')
('5.3.3', '\\Omega')
('5.3.3', '{\\bm t}')
('5.3.3', '\\Omega')
('5.3.3', '0 \n\\le \n\\underbrace{B_\\Omega({\\bm t}, \\nabla \\Omega^*({\\bm \\theta}))}_{\\text{possibly nonconvex\nin } {\\bm \\theta}}\n\\le \n\\underbrace{\\ell_\\Omega({\\bm \\theta}, {\\bm t})}_{\\text{convex in } {\\bm \\theta}}.')
