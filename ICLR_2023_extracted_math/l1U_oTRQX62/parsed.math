('3', 'f(x)')
('3', 'q(z|x)')
('3', 'h(x,z)')
('3', 'q(c|x,z)')
('3', 'g(z,c)')
('3', 'x')
('3', 'z')
('3', 'c')
('3.0', 'K')
('3.0', 'k')
('3.0', '\\mathcal{D}_k')
('3.0', '\\theta^{*}')
('3.0', '\\begin{aligned}\n    \\theta^{*}=\\mathop{\\mathrm{arg\\,min}}_{\\theta}\\sum_{k=1}^{K} w_k \\mathcal{L}_{k}(\\theta;\\mathcal{D}_{k})\n    \\end{aligned}\n    \\label{eq-loss-fedavg}')
('3.0', '\\mathcal{L}_{k}(\\theta;\\mathcal{D}_{k})=\\sum_{x\\in\\mathcal{D}_{k}}\\ell(\\theta;x)')
('3.0', 'k')
('3.0', 'w_k=|\\mathcal{D}_k|/\\sum_{k=1}^{K} |\\mathcal{D}_k|')
('3.0', '\\ell(\\theta;x)')
('3.0', 'x')
('3.0', 'z')
('3.0', 'p(z)=\\mathcal{N}(z;0,I)')
('3.0', 'q_{\\theta}(z|x)')
('3.0', 'x')
('3.0', 'z\\sim q_{\\theta}(z|x)')
('3.0', 'q_{\\theta}(z|x)')
('3.0', 'q_{\\theta}(z|x)=\\mathcal{N}(z;\\mu(x),\\Sigma(x))')
('3.0', '\\Sigma')
('3.0', 'x')
('3.0', '\\log p_{\\varphi}(x|z)')
('3.0', '\\theta')
('3.0', '\\varphi')
('3.0', '\\begin{aligned}\n    EB(x)=\\mathbb{E}_{q_{\\theta}(z|x)}[\\log p_{\\varphi}(x|z)]-D_{KL}(q_{\\theta}(z|x)||p(z))\n    \\end{aligned}\n    \\label{eq-vae-elbo}')
('3.0', 'z')
('3.0', 'KL')
('3.0', 'q_{\\theta}(z|x)')
('3.0', 'p(z)')
('3.0', '\\ell(\\theta,\\varphi;x)')
('3.0', '\\theta')
('3.0', '\\varphi')
('3.0', '\\begin{aligned}\n    \\ell(\\theta,\\varphi;x)=-\\mathbb{E}_{q(z|x)}[\\log p(x|z)]+D_{KL}(q(z|x)||p(z))\n    \\end{aligned}\n    \\label{eq-vae-free}')
('3.1', 'z')
('3.1', 'c')
('3.1', 'z')
('3.1', 'p(z)=\\mathcal{N}(z;0, I)')
('3.1', 'c')
('3.1', 'p_k(c)')
('3.1', 'k')
('3.1', 'k')
('3.1', 'p_{k}(c)')
('3.1', 'p_k(c)')
('3.1', 'q(c)=\\sum_{k=1}^{K}w_{k}p_{k}(c)')
('3.1', '\\mathcal{N}(c;0,I)')
('3.1', 'x')
('3.1', 'q(z|x)=\\mathcal{N}(z;\\mu(x),\\Sigma(x))')
('3.1', 'z')
('3.1', 'q(c|x,z)=\\mathcal{N}(c;\\hat{\\mu}(x,z),\\hat{\\Sigma}(x,z))')
('3.1', 'x')
('3.1', 'z')
('3.1', 'z')
('3.1', 'c')
('3.1', '\\log p_{k}(x|z,c)')
('3.1', '\\begin{aligned}\n    \\ell^{cva}(\\theta,\\varphi_{k};x)=-\\mathbb{E}_{q(z|x)}[\\mathbb{E}_{q(c|x,z)}[\\log p_{k}(x|z,c)]\\\\+\\beta\\mathcal{R}_{c}(q(c|x,z))]+\\alpha\\mathcal{R}_{z}(q(z|x))\n    \\end{aligned}\n    \\label{eq-feddva-loss}')
('3.1', '\\theta')
('3.1', '\\varphi_k')
('3.1', 'k')
('3.1', '\\mathcal{R}_{z}(q(z|x))')
('3.1', '\\mathcal{R}_{c}(q(c|x,z))')
('3.1', 'q(z|x)')
('3.1', 'q(c|x,z)')
('3.1', '\\alpha')
('3.1', '\\beta')
('3.1', 'q(z|x)')
('3.1', 'D_{KL}(q(z|x)||p(z))')
('3.1', 'z')
('3.1', 'c')
('3.1', 'p_{k}(c)')
('3.1', 'D_{KL}(q(c|x,z)||q(c))')
('3.1', '\\begin{aligned}\n    D_{KL}(q(c|x,z)||q(c))-D_{KL}(q(c|x,z)||\\bar{p}_{k}(c))\\ge\\xi_{k}\n    \\end{aligned}\n    \\label{ieq-reg-c}')
('3.1', '\\bar{p}_{k}(c)=\\frac{1}{|\\mathcal{D}_{k}|}\\sum_{x\\in\\mathcal{D}_{k}}q(c|x,z)')
('3.1', 'q(c|x,z)')
('3.1', 'k')
('3.1', '\\xi_{k}>0')
('3.1', '\\bar{p}_{k}(c)')
('3.1', 'p_{k}(c)')
('3.1', 'q(c|x,z)')
('3.1', '\\xi_{k}')
('3.1', '\\bar{p}_{k}(c)')
('3.1', 'q(c)')
('3.1', 'c')
('3.1', 'KL')
('3.1', '\\mathcal{R}_{z}(q(z|x))')
('3.1', '\\mathcal{R}_{c}(q(c|x,z))')
('3.1', '\\begin{aligned}\n    &\\mathcal{R}_{z}(q(z|x))=D_{KL}(q(z|x)||p(z))\n    \\label{eq-reg-z}\n    \\end{aligned}')
('3.1', '\\begin{aligned}\n    \\mathcal{R}_{c}(q(c|x,z))=\\max(&\\xi_{k}+D_{KL}(q(c|x,z)||\\bar{p}_{k}(c))\\\\\n    &, D_{KL}(q(c|x,z)||q(c)))\n    \\label{eq-reg-c}\n    \\end{aligned}')
('3.1', '\\begin{aligned}\n    \\mathop{\\mathrm{arg\\,min}}_{\\theta,\\varphi_{1}...\\varphi_{K}}\\sum_{k=1}^{K}w_{k}\\mathcal{L}_{k}(\\theta,\\varphi_k;\\mathcal{D}_{k})\n    \\end{aligned}\n    \\label{eq-fedcva-objective}')
('3.1', '\\mathcal{L}_{k}(\\theta,\\varphi_{k};\\mathcal{D}_{k})=\\sum_{x\\in\\mathcal{D}_{k}}\\ell^{cva}(\\theta,\\varphi_k;x)')
('3.1', "\\begin{aligned}\n    \\varphi_{k}'=\\varphi_{k}-\\eta\\nabla_{\\varphi_k}\\mathcal{L}_{k}(\\theta,\\varphi_k;\\mathcal{D}_{k}), 1\\le k\\le K\n    \\end{aligned}\n    \\label{eq-gradient-local-decoder}")
('3.1', "\\begin{aligned}\n    \\theta'=\\theta-\\lambda\\sum_{k=1}^{K}w_{k}\\nabla_{\\theta}\\mathcal{L}_{k}(\\theta,\\varphi_{k};\\mathcal{D}_{k})\n    \\end{aligned}\n    \\label{eq-gradient-local-encoder}")
('3.1', '\\eta')
('3.1', '\\lambda')
('3.1', "\\theta'=\\sum_{k=1}^{K}w_{k}\\theta'_{k}")
('3.1', "\\begin{aligned}\n     \\theta'_{k}=\\theta_{k}-\\lambda\\nabla_{\\theta}\\mathcal{L}_{k}(\\theta_{k},\\varphi_{k};\\mathcal{D}_{k}), 1\\le k\\le K\n    \\end{aligned}\n    \\label{eq-gradient-local-encoder-fedavg}")
('3.1', '\\varphi_k')
('3.1', '\\theta')
('3.1', 'm')
('3.1', 'b')
('3.1', '\\lambda')
('3.1', '\\eta')
('3.1', '\\xi_{k}')
('3.1', '\\theta^{(1)}\\leftarrow\\theta')
('3.1', 'm')
('3.1', '\\mathbb{C}')
('3.1', '\\theta_k^{(r+1)}\\leftarrow')
('3.1', '(k, \\theta^{(r)})')
('3.1', '\\theta^{(r+1)}\\leftarrow \\sum_{k=1}^{K}w_{k}\\theta_{k}^{(r+1)}')
('3.1', '(k, \\theta)')
('3.1', '\\theta_{k}\\leftarrow\\theta')
('3.1', '\\varphi_{k}\\leftarrow\\varphi')
('3.1', '\\varphi_{k}')
('3.1', '\\varphi\\leftarrow \\varphi_{k}')
('3.1', '\\theta_{k}')
('3.1', '\\theta_{k}')
('4', 'q(z|x)')
('4', 'q(c|x,z)')
('4', '\\begin{aligned}\n    % \\log p_{k}(x)\\ge&\n    ELBO_{z}(x,k)=&\\mathbb{E}_{q(z|x)}[\\log p_{k}(x|z)]\\\\&-D_{KL}(q(z|x)||p(z))\n    \\end{aligned}\n    \\label{eq-elbo-z}')
('4', '\\begin{aligned}\n    %\\log p_{k}(x|z)\\ge\n    ELBO_{c}(x,z,k)=&\\mathbb{E}_{q(c|x,z)}[\\log p(x|z,c)]\\\\&-D_{KL}(q(c|x,z)||p_{k}(c))\n    \\end{aligned}\n    \\label{eq-elbo-c}')
('4', 'k')
('4', 'k')
('4', '\\log p(x|z,c)')
('4', 'p_{k}(x)=\\iint p(x|z,c)p(z)p_{k}(c)\\text{d}z\\text{d}c')
('4', 'p_{k}(c)')
('4', '\\log p(x|z,c)')
('4', '\\log p(x|z,c)')
('4', 'q(c|x,z)')
('4', "\\begin{aligned}\n    % \\log p_{k}(x|z)\\ge& \n    ELBO'_{c}(x,z,k)=&\\mathbb{E}_{q(c|x,z)}[\\log p_{k}(x|z,c)]\\\\&-D_{KL}(q(c|x,z)||q(c))\n    \\end{aligned}\n    \\label{eq-elbo-c-alternative}")
('4', 'D_{KL}(q(c|x,z)||q(c))')
('4', 'KL')
('4', 'q(c|x,z)')
('4', 'q(c)')
('4', '\\begin{aligned}\n    \\mathbb{E}_{p_{k}(x)}[\\mathbb{E}_{q(z|x)}[-H(q(c|x,z))]]+H(\\bar{p}_{k}(c),q(c))\n    \\end{aligned}')
('4', 'c')
('4', 'q(c)')
('4', 'q(c|x,z)')
('4', 'p_{k}(c)')
('4', 'q(c)')
('4', 'D_{KL}(\\bar{p}_{k}(c)||q(c))\\ge\\xi_{k}')
('4', 'p_{k}(x|z)')
('4', '\\xi_{k}')
('4', 'c')
('4', '\\xi_{k}')
('4', 'c')
('5', 'z')
('5', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'c')
('5.0', 'z')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('5.0', 'z')
('5.0', 'c')
('7.0', 'p(z|x)')
('7.0', 'z')
('7.0', 'q(z|x)')
('7.0', 'p(z|x)')
('7.0', 'k')
('7.0', 'D_{KL}(q(z|x)||p(z|x))')
('7.0', '\\begin{aligned}\n    D_{KL}(q(z|x)||p(z|x))=&\\int q(z|x) \\log \\frac{q(z|x)}{p(z|x)} \\text{d}z\\\\\n    =&\\int q(z|x) \\log \\frac{q(z|x)p_{k}(x)}{p(z|x)p_{k}(x)} \\text{d}z\\\\\n    =&\\log p_{k}(x)+\\int q(z|x)\\log \\frac{q(z|x)}{p_{k}(x|z)p(z)}\\text{d}z\\\\\n    =&\\log p_{k}(x)-\\mathbb{E}_{q(z|x)}[\\log p_{k}(x|z)]+D_{KL}(q(z|x)||p(z))\n    \\end{aligned}')
('7.0', '\\begin{aligned}\n    \\log p_{k}(x)\\ge ELBO_{z}(x,k)=\\mathbb{E}_{q(z|x)}[\\log p_{k}(x|z)]-D_{KL}(q(z|x)||p(z))\n    \\end{aligned}')
('7.1', 'p(c|x,z)')
('7.1', 'c')
('7.1', 'q(c|x,z)')
('7.1', 'p(c|x,z)')
('7.1', 'k')
('7.1', 'D_{KL}(q(c|x,z)||p(c|x,z))')
('7.1', '\\begin{aligned}\n    D_{KL}(q(c|x,z)||p(c|x,z))=&\\int q(c|x,z) \\log\\frac{q(c|x,z)}{p(c|x,z)}\\text{d}c\\\\\n    =&\\int q(c|x,z) \\log \\frac{q(c|x,z)p_{k}(x|z)}{p(c|x,z)p_{k}(x|z)}\\text{d}c\\\\\n    =&\\log p_{k}(x|z) + \\int q(c|x,z)\\log\\frac{q(c|x,z)}{p_{k}(x,c|z)}\\text{d}c\\\\\n    =&\\log p_{k}(x|z) - \\mathbb{E}_{q(c|x,z)}[\\log p_{k}(x,c|z)] - H(q(c|x,z))\n    \\end{aligned}')
('7.1', 'p(x|z,c)')
('7.1', 'p_{k}(x)=\\iint p(x|z,c)p(z)p_{k}(c)\\text{d}z\\text{d}c')
('7.1', 'p_{k}(c)')
('7.1', '\\begin{aligned}\n    \\log p_{k}(x)\\ge ELBO_{c}(x,z,k)=\\mathbb{E}_{q(c|x,z)}[\\log p(x|z,c)]-D_{KL}(q(c|x,z)||p_{k}(c))\n    \\end{aligned}')
('7.1', "\\begin{aligned}\n    \\log p_{k}(x)\\ge ELBO'_{c}(x,z,k)=\\mathbb{E}_{q(c|x,z)}[\\log p_{k}(x|z,c)]-D_{KL}(q(c|x,z)||q(c))\n    \\end{aligned}")
('7.2', '\\begin{aligned}\n    &\\mathbb{E}_{p_{k}(x)}[\\mathbb{E}_{q(z|x)}[D_{KL}(q(c|x,z)||q(c))-D_{KL}(q(c|x,z)||\\bar{p}_{k}(c))]]\\\\\n    =&\\mathbb{E}_{p_{k}(x)}[\\mathbb{E}_{q(z|x)}[\\mathbb{E}_{q(c|x,z)}[\\log \\bar{p}_{k}(c)-\\log q(c)]]]\\\\\n    =&\\mathbb{E}_{\\bar{p}_{k}(c)}[\\log \\bar{p}_{k}(c)-\\log q(c)]\\\\\n    =&D_{KL}(\\bar{p}_{k}(c)||q(c))\\\\\n    \\ge&\\xi_{k}\n    \\end{aligned}')
('8.0', 'i')
('8.0', 'x_{i}')
('8.0', 'j')
('8.0', 'x_{j}')
('8.0', 'c')
('8.0', 'q(c|x_i, z_i)=\\mathcal{N}(c;\\mu_i,\\Sigma_i)')
('8.0', 'q(c|x_j, z_j)=\\mathcal{N}(c;\\mu_j,\\Sigma_j)')
('8.0', 'c')
('8.0', 'd')
('8.0', '\\Sigma_i')
('8.0', '\\Sigma_j')
('8.0', '\\begin{aligned}\n    \\int q(c|x_i,z_i)\\log q(c|x_i,z_i)\\text{d}c=&\\int \\mathcal{N}(c;\\mu_i,\\Sigma_i) \\log \\mathcal{N}(c;\\mu_i,\\Sigma_i)\\text{d}c\\\\\n    =&-\\frac{1}{2}(d\\log(2\\pi)+\\log|\\Sigma_i|+d)\n    \\end{aligned}\n    \\label{computation-hqc}')
('8.0', '\\begin{aligned}\n    \\int q(c|x_i,z_i)\\log q(c|x_j,z_j)\\text{d}c=&\\int \\mathcal{N}(c;\\mu_i,\\Sigma_i)\\log \\mathcal{N}(c;\\mu_j,\\Sigma_j)\\text{d}c\\\\\n    =&-\\frac{1}{2}(d\\log(2\\pi)+\\log|\\Sigma_j|+Tr(\\Sigma_j^{-1}\\Sigma_i)+(\\mu_i-\\mu_j)^{T}\\Sigma_j^{-1}(\\mu_i-\\mu_j))\n    \\end{aligned}\n    \\label{computation-cqc}')
('8.0', 'KL')
('8.0', 'q(c|x_i,z_i)')
('8.0', 'q(c|x_j,z_j)')
('8.0', '\\begin{aligned}\n    D_{KL}(q(c|x_i,z_i)||q(c|x_j,z_j))\n    =&\\int q(c|x_i,z_i) (\\log q(c|x_i,z_i)- \\log q(c|x_j,z_j))\\text{d}c\\\\\n    =&\\int \\mathcal{N}(c;\\mu_i,\\Sigma_i) (\\log \\mathcal{N}(c;\\mu_i,\\Sigma_i))\\text{d}c- \\int \\mathcal{N}(c;\\mu_i,\\Sigma_i)(\\log \\mathcal{N}(c;\\mu_j,\\Sigma_j))\\text{d}c\\\\\n    =&\\frac{1}{2}[(\\mu_i-\\mu_j)^{T}\\Sigma_{j}^{-1}(\\mu_i-\\mu_j)-\\log |\\Sigma_{j}^{-1}\\Sigma_i|+Tr(\\Sigma_j^{-1}\\Sigma_i)-d]\\\\\n    =&\\frac{1}{2}\\sum_{l=1}^{d}[(\\frac{\\mu_{i}^{(l)}-\\mu_{j}^{(l)}}{\\sigma_j^{(l)}})^{2}-\\log(\\frac{\\sigma_i^{(l)}}{\\sigma_j^{(l)}})^{2}+(\\frac{\\sigma_i^{(l)}}{\\sigma_j^{(l)}})^{2}-1]\n    \\end{aligned}\n    \\label{DKL-q-q}')
('8.0', 'l')
('8.0', 'l')
('8.0', '\\sigma_i^{(l)}')
('8.0', 'l')
('8.0', '\\Sigma_i')
('8.1', 'x_{i}')
('8.1', 'x_{j}')
('8.1', 'i')
('8.1', 'j')
('8.1', '\\mathcal{D}_{k}')
('8.1', 'n_k')
('8.1', '\\begin{aligned}\n    D_{KL}(q(c|x_i,z_i)||\\bar{p}_{k}(c))=&\\mathbb{E}_{q(c|x_{i},z_{i})}[\\log q(c|x_{i},z_{i})-\\log\\frac{1}{n_k}\\sum_{j=1}^{n_{k}}[q(c|x_j,z_j)]\\\\\n    \\le&\\mathbb{E}_{q(c|x_i,z_i)}[\\log q(c|x_i,z_i)-\\frac{1}{n_k}\\sum_{j=1}^{n_k}\\log q(c|x_j,z_j)]\\\\\n    =&\\frac{1}{n_k}\\sum_{j=1}^{n_k}\\mathbb{E}_{q(c|x_i,z_i)}[\\log q(c|x_i,z_i)-\\log q(c|x_j,z_j)]\n    \\end{aligned}')
('8.1', '\\begin{aligned}\n    D_{KL}(q(c|x_i,z_i)||\\bar{p}_{k}(c))\\le\\frac{1}{2n_k}\\sum_{j=1}^{n_k}\\sum_{l=1}^{d}[(\\frac{\\mu_{i}^{(l)}-\\mu_{j}^{(l)}}{\\sigma_j^{(l)}})^{2}-\\log(\\frac{\\sigma_i^{(l)}}{\\sigma_j^{(l)}})^{2}+(\\frac{\\sigma_i^{(l)}}{\\sigma_j^{(l)}})^{2}-1]\n    \\end{aligned}')
('8.1', '\\mu_i')
('8.1', '\\sigma_i')
('8.1', '\\mu_j')
('8.1', '\\sigma_j')
('9.1', 'z')
('9.1', 'c')
('9.1', 'z')
('9.1', 'x')
('9.1', '[x;z]')
('9.2', 'z')
('9.2', 'c')
('9.2', '\\xi_{k}')
('9.2', 'c')
('9.2', '\\alpha')
('9.2', '\\beta')
('9.3', 'z')
('9.3', 'c')
('9.3', 'z')
('9.3', 'c')
('9.3', 'z')
('9.3', 'c')
('9.3', 'z')
('9.3', 'c')
('9.3', 'z')
('9.3', 'c')
('9.3', 'z')
('9.3', 'c')
