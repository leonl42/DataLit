('2.1', '\\begin{aligned}\n\\begin{split}\n    \\label{eq:k-fac}\n    F^{ll} & = \\mathop{\\mathrm{\\mathbb{E}}}_{y\\sim p(y|x)}\\left[\\nabla_\\theta \\log{p(y|x)} \\nabla_\\theta \\log{p(y|x)}^\\top\\right] \\\\\n    & = \\mathop{\\mathrm{\\mathbb{E}}}[(g \\otimes a) (g \\otimes a)^\\top] = \\mathop{\\mathrm{\\mathbb{E}}}[(g g^\\top) \\otimes (a a^\\top)] \\\\\n    & \\approx \\mathop{\\mathrm{\\mathbb{E}}}[g g^\\top] \\otimes \\mathop{\\mathrm{\\mathbb{E}}}[a a^\\top] ,\n\\end{split}\n\\end{aligned}')
('2.1', 'F^{ll}')
('2.1', 'l')
('2.1', 'g')
('2.1', 'a')
('2.1', '\\otimes')
('2.1', '\\mathcal{O}(M^2 \\times N^2)')
('2.1', '\\mathcal{O}(M^2 + N^2)')
('2.1', 'M')
('2.1', 'N')
('3', '\\mathcal{D}_t')
('3', 't')
('3', '\\begin{aligned}\n    \\min_{\\theta} \\frac{1}{T} \\sum_{t=1}^{T} \\mathop{\\mathrm{\\mathbb{E}}}_{(x,y) \\in \\mathcal{D}_t} \\left[ \\lambda_t \\mathcal{L}(f(x;\\theta, t),y) \\right] ,\n\\end{aligned}')
('3', '\\theta')
('3', '\\lambda_t')
('3', '\\begin{aligned}\n\\begin{split}\n\\frac{1}{t} \\sum_{i=1}^{t} \\mathop{\\mathrm{\\mathbb{E}}}_{(x,y) \\in \\mathcal{D}_i} \\left[ \\lambda_i \\mathcal{L}(f(x;\\theta,i),y) \\right] \n&= C + \\frac{1}{2} (\\theta - \\theta_t)^\\top A (\\theta - \\theta_t) + \\mathcal{O}(\\theta^3)\\\\\n&\\simeq C + \\frac{1}{2} (\\theta - \\theta_t)^\\top A (\\theta - \\theta_t) ,\n\\end{split}\n\\end{aligned}')
('3', 'A')
('3', 'C')
('3', '\\theta_t')
('3', 't')
('3', 'A')
('3', 'A')
('3.0', '\\label{eq:fisher-information}\n    F_\\theta = \\mathop{\\mathrm{\\mathbb{E}}}_{y\\sim p_\\theta(y|x)}{\\left[ \\nabla_\\theta \\log{p_\\theta(y|x)} \\nabla_\\theta \\log{p_\\theta(y|x)}^\\top \\right]}')
('3.0', 'p_\\theta(y|x)')
('3.0', 'y')
('3.0', '\\rightarrow')
('3.0', '\\nabla_\\theta \\log{p_\\theta(y|x)} \\rightarrow 0')
('3.0', 'F_\\theta \\rightarrow 0')
('3.1', '\\begin{aligned}\n\\begin{split}\n    \\ell(f(x;\\theta,t),y) = \\frac{1}{2} ||\\alpha \\phi(y) - f(x;\\theta,t)||^2\n\\end{split}\n\\end{aligned}')
('3.1', '\\phi(\\cdot)')
('3.1', '\\alpha')
('3.1', '\\alpha=15')
('3.1', '\\begin{aligned}\n    g_{lin}(x; \\psi) & = g(x; \\psi_0) + D_\\psi g(x;\\psi_0) \\cdot \\psi ,\n\\end{aligned}')
('3.1', 'D_\\psi g(x;\\psi_0)')
('3.1', '\\psi_0')
('3.1', '\\begin{aligned}\n    f(x; \\theta,t) & = w_t \\cdot g_{lin}(x; \\psi) + b_t ,\n\\end{aligned}')
('3.1', 'g(x; \\psi_0)')
('3.1', '\\theta = \\{ \\psi, w_t, b_t \\}')
('3.1', '\\{ \\psi, w_t, b_t \\}')
('3.1', 'g_{lin}(x; \\psi)')
('3.1', '\\psi')
('3.1', '\\begin{aligned}\n\\begin{split}\n    \\ell(f(x;\\theta,t),y) &= \\frac{1}{2} ||\\alpha\\phi(y) - f(x;\\theta,t)||^2\\\\\n    &= \\frac{1}{2} (\\theta - \\theta_t)^\\top H_\\theta (\\theta - \\theta_t) + C ,\n\\end{split}\n\\end{aligned}')
('3.1', '\\theta_t')
('3.1', 't')
('3.1', 'H_\\theta')
('3.1', '\\begin{aligned}\n    \\mathcal{L}_{data} &= \\mathop{\\mathrm{\\mathbb{E}}}_{(x,y)\\sim\\mathcal{D}_t}[\\ell(f(x;\\theta,t),y)] \\\\\n    \\mathcal{L}_{reg} &= \\frac{1}{2} (\\theta - \\theta_{t-1})^\\top H (\\theta - \\theta_{t-1}) \\\\\n    \\mathcal{L} &= \\frac{1}{t} \\mathcal{L}_{data} + \\frac{t-1}{t} \\mathcal{L}_{reg},\n\\end{aligned}')
('3.1', '1:(t-1)')
('3.1', 'H')
('3.2', 'W')
('3.2', '\\overline{W}')
('3.2', 'y')
('3.2', '\\begin{aligned}\n    \\mathcal{L}\\left( \\overline{W} \\right) = \\mathop{\\mathrm{\\mathbb{E}}}{\\left[ \\frac{1}{2} ||y - \\overline{W}z||^2 \\right]} ,\n\\end{aligned}')
('3.2', '\\overline{w}:=\\text{Vec}\\left(\\overline{W}\\right)')
('3.2', '\\begin{aligned}\n\\begin{split}\n    \\frac{\\partial^2 \\mathcal{L}}{\\partial \\overline{w} \\partial \\overline{w}^\\top}  = \\frac{\\partial}{\\partial \\overline{w}} \\mathop{\\mathrm{\\mathbb{E}}}[(y - \\overline{W}z) z^\\top] \n     = \\mathop{\\mathrm{\\mathbb{E}}}{[ z z^\\top \\otimes I ]} = \\mathop{\\mathrm{\\mathbb{E}}}{[z z^\\top]} \\otimes I .\n\\end{split}\n\\end{aligned}')
('3.2', '\\mathop{\\mathrm{\\mathbb{E}}}{[z z^\\top]}')
('3.2', '\\mathcal{M}')
('3.2', '\\begin{aligned}\n    \\mathcal{L}_{reg} = \\frac{\\lambda}{2} \\cdot (\\theta - \\theta_{t-1})^\\top H (\\theta - \\theta_{t-1}) + (1-\\lambda)\\cdot\\mathop{\\mathrm{\\mathbb{E}}}_{\\mathcal{M}}[ \\ell(f(x;\\theta,t),y) ].\n\\end{aligned}')
('4.0', '\\times')
('4.0', '\\eta=10^{-1}')
('4.0', '256')
('4.0', '10^{-5}')
('4.0', '\\eta=10^{-4}')
('4.0', '\\times')
('4.0', '\\times')
('4.0', '\\times')
('4.0', '\\times')
('4.0', '10^{-3}')
('4.0', '10^{-4}')
('4.0', '(\\beta_1, \\beta_2) = (0.9, 0.999)')
('4.0', '\\lambda = 1/2')
('4.0', '(t-1):t')
('4.0', '10^{-5}')
('4.1.1', '\\dagger')
('4.1.1', '\\ddagger')
('4.1.1', '\\text{DLCFT}^\\dagger')
('4.1.1', '\\text{DLCFT}^\\ddagger')
('6', 'p(y|x)')
('6', 'x \\in \\mathbb{R}^M')
('6', '\\begin{aligned}\n    p(y=k|x) = \\frac{e^{x_k}}{\\sum_{m}{e^{x_m}}}.\n\\end{aligned}')
('6', 't')
('6', '\\begin{aligned}\n    \\mathcal{L}(x) = - \\log{p(y=t|x)} = -x_t + \\log{\\sum_{m}{e^{x_m}}}.\n\\end{aligned}')
('6', '\\begin{aligned}\n    \\frac{\\partial^2 \\mathcal{L}(x)}{\\partial x_i \\partial x_j} & = \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left( -x_t + \\log{\\sum_{m}{e^{x_m}}} \\right) \\\\\n    &= \\frac{\\partial^2}{\\partial x_i \\partial x_j} \\left(\\log{\\sum_{m}{e^{x_m}}} \\right) \\\\\n    &= \\frac{\\partial}{\\partial x_j} \\left(\\frac{e^{x_i}}{\\sum_{m}{e^{x_m}}} \\right).\n\\end{aligned}')
('6', 'j=i')
('6', '\\begin{aligned}\n    \\frac{\\partial^2 \\mathcal{L}(x)}{\\partial x_i^2} = \\frac{e^{x_i}\\left(\\sum_{m}{e^{x_m}}- e^{x_i}\\right)}{\\left(\\sum_{m}{e^{x_m}}\\right)^2}\n    = \\frac{\\frac{e^{x_i}}{e^{x_t}}\\left(1+\\sum_{m\\neq t}{\\frac{e^{x_m}}{e^{x_t}}} - \\frac{e^{x_i}}{e^{x_t}}\\right)}{\\left(1+\\sum_{m\\neq t}{\\frac{e^{x_m}}{e^{x_t}}}\\right)^2}.\n    \\label{eq:hessian-diagonal}\n\\end{aligned}')
('6', 'j\\neq i')
('6', '\\begin{aligned}\n    \\frac{\\partial^2 \\mathcal{L}(x)}{\\partial x_i \\partial x_j} = \\frac{- e^{x_i}e^{x_j}}{\\left(\\sum_{m}{e^{x_m}}\\right)^2}\n    = \\frac{- \\frac{e^{x_i}}{e^{x_t}}\\frac{e^{x_j}}{e^{x_t}}}{\\left(1+\\sum_{m\\neq t}{\\frac{e^{x_m}}{e^{x_t}}}\\right)^2}.\n    \\label{eq:hessian-offdiagonal}\n\\end{aligned}')
('6', 'p(y=t|x) \\rightarrow 1')
('6', 'e^{x_m - x_t} \\rightarrow 0')
('6', 'm\\neq t')
('7', '\\theta_0')
('7', 'f(x; \\theta_0)')
('7', '\\theta_0')
('7', 'f(x; \\theta_0 + \\Delta\\theta) \\simeq f(x; \\theta_0) + D_\\theta f(x; \\theta_0) \\cdot \\Delta\\theta,')
('7', 'D_\\theta f(x; \\theta_0)')
('7', '(x, \\theta_0)')
('7.0', '\\partial_r x_{l}')
