('1', 'f')
('2.0', 't')
('2.0', '\\mathbf{s}_{t}')
('2.0', '\\pi(\\mathbf{a}_{t}|\\mathbf{s}_{t})')
('2.0', '\\mathbf{a}_{t}')
('2.0', '\\gamma < 1')
('2.0', '\\mathbf{s}_{t+1}')
('2.0', 'p(\\ensuremath{\\mathbf{s}_{t+1}}|\\ensuremath{\\mathbf{s}_{t}},\\ensuremath{\\mathbf{a}_{t}})')
('2.0', '1 - \\gamma')
('2.0', '\\mathbf{s}_{0}')
('2.0', 'p_0(\\mathbf{s})')
('2.0', '\\ensuremath{\\boldsymbol{\\tau}}_i=(\\ensuremath{\\mathbf{s}_{0}}, \\ensuremath{\\mathbf{a}_{0}}, \\dots, \\ensuremath{\\mathbf{s}_{T_i}}, \\ensuremath{\\mathbf{a}_{T_i}})')
('2.0', '\\mathbf{s}_{T_i}')
('2.0', '\\mathbf{a}_{T_i}')
('2.0', 'i')
('2.0', '\\pi')
('2.0', 'p^\\pi(\\ensuremath{\\boldsymbol{\\tau}})')
('2.0', 't')
('2.0', 'p^\\pi_t(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.0', 'p^\\pi(\\ensuremath{\\boldsymbol{\\tau}})')
('2.0', '\\pi')
('2.0', 'p^\\pi(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = (1-\\gamma) \\sum_{t=0}^\\infty \\gamma^t p_t^\\pi(\\mathbf{s}, \\mathbf{a})')
('2.0', 'r(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}})')
('2.0', 't')
('2.0', 'J_\\text{RL} = \\int_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}} p^\\pi(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) r(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}')
('2.0', 'N')
('2.0', '\\mathcal{D}=\\left\\{\\mathbf{o}_i\\right\\}_{1\\le i \\le N}')
('2.0', '\\mathcal{O}')
('2.0', 'p(\\mathbf{o}|\\boldsymbol{\\tau})')
('2.0', 'D(p^\\pi(\\ensuremath{\\mathbf{o}})||q(\\ensuremath{\\mathbf{o}}))')
('2.0', 'p^\\pi(\\ensuremath{\\mathbf{o}})')
('2.0', 'q(\\ensuremath{\\mathbf{o}})')
('2.0', '\\label{nail_eq:generalILobjective}\nJ_\\text{IL} = \\min_\\pi D(p^\\pi(\\ensuremath{\\mathbf{o}})||q(\\ensuremath{\\mathbf{o}})).')
('2.0', 'p^\\pi(\\ensuremath{\\mathbf{o}})')
('2.1', 'f')
('2.1.0', 'D_\\text{JS}(p(\\mathbf{x}||q(\\mathbf{x}))')
('2.1.0', 'p(\\mathbf{x})')
('2.1.0', 'q(\\mathbf{x})')
('2.1.0', '\\label{nail_eq:GAN}\nJ_\\text{GAN}(p, D) = \\min_p \\max_D \\mathrm{E}_{\\mathbf{x} \\sim q}\\left[ \\log D(\\mathbf{x}) \\right] + \\mathrm{E}_{\\mathbf{x} \\sim p(\\mathbf{x})}\\left[ \\log\\left(1 - D(\\mathbf{x})\\right) \\right].')
('2.1.0', 'D(\\mathbf{x})')
('2.1.0', ']0,1[')
('2.1.0', '\\mathbf{x}')
('2.1.0', 'p(\\mathbf{x})')
('2.1.0', 'G(\\mathbf{z})')
('2.1.0', '\\mathbf{z} \\sim \\mathcal{N}(\\mathbf{z})')
('2.1.0', 'p(\\mathbf{x})')
('2.1.0', 'f')
('2.1.0', '{f}')
('2.1.0', '{f}')
('2.1.1', '{f}')
('2.1.1', 'f')
('2.1.1', 'D_f(q(\\mathbf{x})||p(\\mathbf{x})) = \\mathrm{E}_p\\left[f\\Big(\\frac{q(\\mathbf{x})}{p(\\mathbf{x})}\\Big)\\right].')
('2.1.1', 'f')
('2.1.1', 'q')
('2.1.1', 'p')
('2.1.1', '\\label{nail_eq:f-gan}\nJ_\\text{F-GAN}(p, D) = \\min_p \\max_D \\mathrm{E}_{\\mathbf{x} \\sim q}\\left[  D(\\mathbf{x}) \\right] - \\mathrm{E}_{\\mathbf{x} \\sim p(\\mathbf{x})}\\left[ f^*(D(\\mathbf{x})) \\right],')
('2.1.1', 'f^*(t)=\\sup_{u \\in \\text{dom}_f} ut - f(u)')
('2.1.1', 'f')
('2.1.1', 'f')
('2.1.1', '\\forall_\\mathbf{x}: D(\\mathbf{x}) \\in \\text{dom}_{f^*}')
('2.1.1', 'f')
('2.1.1', 'D^\\star(\\mathbf{x})')
('2.1.1', 'p(\\mathbf{x})')
('2.1.1', 'f')
('2.1.1', '\\frac{q(\\mathbf{x})}{p(\\mathbf{x})}')
('2.1.1', "D^\\star(\\mathbf{x}) = f'\\Big(\\frac{q(\\mathbf{x})}{p(\\mathbf{x})}\\Big).")
('2.1.1', 'f')
('2.1.1', 'f')
('2.1.1', "\\underset{p}{\\max}\\; \\mathrm{E}_{\\mathbf{x} \\sim p(\\mathbf{x})}\\left[ f^*(D^\\star(\\mathbf{x})) \\right] =  \\underset{p}{\\max}\\; \\mathrm{E}_{\\mathbf{x} \\sim p(\\mathbf{x})}\\left[ f^* \\circ f'\\Big(\\frac{q(\\mathbf{x})}{p(\\mathbf{x})}\\Big) \\right] =  \\underset{p}{\\max} \\; \\mathrm{E}_{\\mathbf{x} \\sim p(\\mathbf{x})}\\left[ g\\Big(\\frac{q(\\mathbf{x})}{p(\\mathbf{x})}\\Big) \\right],")
('2.1.1', "g = f^\\star \\circ f'")
('2.1.1', '\\phi(\\mathbf{x})=\\frac{q(\\mathbf{x})}{p(\\mathbf{x})}')
('2.1.1', 'f')
('2.1.2', '\\phi(\\mathbf{x})')
('2.1.2', 'q(\\mathbf{x})')
('2.1.2', 'p(\\mathbf{x})')
('2.1.2', 'z(Q)')
('2.1.2', 'q(\\mathbf{x})')
('2.1.2', 'z(\\neg Q)=1-z(Q)')
('2.1.2', 'p(\\mathbf{x})')
('2.1.2', '\\begin{aligned}\nz(\\mathbf{x}) = z(Q) q(\\mathbf{x}) + (1 - z(Q)) p(\\mathbf{x}),\n\\end{aligned}')
('2.1.2', 'z(Q)')
('2.1.2', 'z(\\neg Q)')
('2.1.2', '\\tilde{z}(Q|\\mathbf{x})')
('2.1.2', 'z(Q|\\mathbf{x})')
('2.1.2', 'z(Q|\\mathbf{x})')
('2.1.2', '\\tilde{z}(Q|\\mathbf{x})')
('2.1.2', '\\nu(\\mathbf{x})')
('2.1.2', '\\tilde{z}(Q|\\mathbf{x}) = \\frac{1}{1+\\exp{\\left(-\\ensuremath{\\nu(\\mathbf{x})}\\right)}} \\Rightarrow \\ensuremath{\\nu(\\mathbf{x})}= \\log \\Big(\\frac{\\tilde{z}(Q|\\mathbf{x})}{1 - \\tilde{z}(Q|\\mathbf{x})}\\Big).')
('2.1.2', '\\tilde{z}(Q|\\mathbf{x}) \\approx z(Q|\\mathbf{x})')
('2.1.2', '\\label{nail_eq:dre_classification}\n\\ensuremath{\\nu(\\mathbf{x})}\\approx \\log \\Big( \\frac{z(Q|\\mathbf{x})}{1-z(Q|\\mathbf{x})} \\Big) = \\log \\Big( \\frac{z(Q) q(\\mathbf{x})}{z(\\neg{Q}) p(\\mathbf{x})} \\Big) = \\log \\Big( \\frac{z(Q)}{z(\\neg{Q})} \\Big) + \\log \\Big( \\phi(\\mathbf{x}) \\Big).')
('2.1.2', 'z(Q)=z(\\neg Q)=0.5')
('2.1.2', '\\nu(\\mathbf{x})')
('2.1.2', '\\log(\\phi(\\mathbf{x}))')
('2.2', 'p^\\pi(\\ensuremath{\\mathbf{o}}) = \\int_{\\ensuremath{\\boldsymbol{\\tau}}} p^\\pi(\\ensuremath{\\boldsymbol{\\tau}}) p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}) d\\ensuremath{\\boldsymbol{\\tau}}')
('2.2', 'f')
('2.2.0', 'f')
('2.2.0', '\\label{nail_eq:f-gail}\nJ_\\text{AIL}(\\pi, D) = \\min_\\pi \\max_D \\mathrm{E}_{\\ensuremath{\\mathbf{o}}\\sim q}\\left[  D(\\ensuremath{\\mathbf{o}}) \\right] - \\mathrm{E}_{\\ensuremath{\\mathbf{o}}\\sim p^\\pi(\\ensuremath{\\mathbf{o}})}\\left[ f^*(D(\\ensuremath{\\mathbf{o}})) \\right].')
('2.2.0', 'p^\\pi(\\ensuremath{\\mathbf{o}})')
('2.2.0', '\\pi')
('2.2.0', 'f')
('2.2.0', 'p^\\pi(\\ensuremath{\\mathbf{o}})')
('2.2.0', '\\pi')
('2.2.0', 'p^\\pi(\\ensuremath{\\mathbf{o}}) = \\int_{\\ensuremath{\\boldsymbol{\\tau}}} p^\\pi(\\ensuremath{\\boldsymbol{\\tau}}) p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}) d\\ensuremath{\\boldsymbol{\\tau}}')
('2.2.0', '\\label{nail_eq:episodic_rl}\n\\max_\\pi \\mathrm{E}_{\\ensuremath{\\boldsymbol{\\tau}}\\sim p^\\pi(\\ensuremath{\\boldsymbol{\\tau}})}\\left[ r_\\text{ep}(\\ensuremath{\\boldsymbol{\\tau}}) \\right],')
('2.2.0', 'r_\\text{ep}(\\ensuremath{\\boldsymbol{\\tau}}) = \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}}.')
('2.2.0', 'r(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.2.0', "r(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}, \\ensuremath{\\mathbf{s}}')")
('2.2.0', "\\ensuremath{\\mathbf{s}}'")
('2.2.0', 'q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.2.0', 'q(\\ensuremath{\\mathbf{s}})')
('2.2.0', "q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{s}}')")
('2.2.0', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}})')
('2.2.0', 't')
('2.2.0', '\\ensuremath{\\mathbf{s}_{t}}')
('2.2.0', '\\ensuremath{\\mathbf{a}_{t}}')
('2.2.0', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}, t) = p(\\ensuremath{\\mathbf{o}}| \\ensuremath{\\mathbf{s}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{a}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}).')
('2.2.0', '\\label{nail_eq:adv_reward}\n\tr_{\\text{adv}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}_{.}}')
('2.2.0', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.2.0', 'p(\\ensuremath{\\mathbf{o}})')
('2.2.0', 'p^\\pi(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.2.0', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}, t) = p(\\ensuremath{\\mathbf{o}}| \\ensuremath{\\mathbf{s}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{a}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{s}_{t+1}}^{\\ensuremath{\\boldsymbol{\\tau}}})')
('2.2.0', "p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}, \\ensuremath{\\mathbf{s}}')")
('2.2.0', '\\ensuremath{\\boldsymbol{\\tau}}_i')
('2.2.0', "\\ensuremath{\\mathbf{s}}'")
('2.2.0', '\\ensuremath{\\boldsymbol{\\tau}}_{i+1}')
('2.2.0', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}_{i})')
('2.2.0', '\\ensuremath{\\mathbf{o}}_{reset}')
('2.2.0', 't')
('2.2.0', '\\ensuremath{\\mathbf{s}_{t}}')
('2.2.0', '\\ensuremath{\\mathbf{a}_{t}}')
('2.2.1', 'f')
('2.2.1', 'p^\\pi(\\ensuremath{\\mathbf{o}}) = q(\\ensuremath{\\mathbf{o}})')
('2.2.1', 'D_\\text{KL}(q(\\ensuremath{\\mathbf{o}})||p^\\pi(\\ensuremath{\\mathbf{o}})) = D_f^{\\text{KL}}(p^\\pi(\\ensuremath{\\mathbf{o}})||q(\\ensuremath{\\mathbf{o}})) = \\mathrm{E}_q\\left[\\log\\Big(\\frac{q(\\ensuremath{\\mathbf{o}})}{p^\\pi(\\ensuremath{\\mathbf{o}})}\\Big)\\right],')
('2.2.1', 'f(u)=u \\log(u)')
('2.2.1', 'D_\\text{KL}(p^\\pi(\\ensuremath{\\mathbf{o}})||q(\\ensuremath{\\mathbf{o}})) = D_{f}^{\\text{RKL}}(p^\\pi(\\ensuremath{\\mathbf{o}})||q(\\ensuremath{\\mathbf{o}})) = \\mathrm{E}_{p^\\pi}\\left[\\log\\Big(\\frac{p^\\pi(\\ensuremath{\\mathbf{o}})}{q(\\ensuremath{\\mathbf{o}})}\\Big)\\right],')
('2.2.1', 'f(u) = -\\log(u)')
('2.2.1', 'f_\\text{RKL}(u) = -\\log(u)')
('2.2.1', "\\begin{aligned}\nf^*_\\text{RKL}(t) = -1 - \\log(-t)  \\quad \\quad \\text{and} \\quad \\quad  f'_\\text{RKL}(u) = - \\frac{1}{u}.\n\\end{aligned}")
('2.2.1', "r(\\ensuremath{\\mathbf{o}}) = f^*_\\text{RKL} \\circ f'_\\text{RKL}\\big(\\frac{q(\\ensuremath{\\mathbf{o}})}{p^\\pi(\\ensuremath{\\mathbf{o}})}\\big) = -1 + \\log\\Big(\\frac{q(\\ensuremath{\\mathbf{o}})}{p^\\pi(\\ensuremath{\\mathbf{o}})}\\Big)")
('2.2.1', '\\label{nail_eq:adversarial_reward}\nr_{adv}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = -1 + \\log\\Big(\\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^\\pi(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})}\\Big)')
('2.2.1', 'f^{*}_\\text{RKL}')
('2.2.1', '\\mathbb{R}^{-}')
('2.2.1', 'D(\\ensuremath{\\mathbf{o}}) = -\\exp(\\nu(\\ensuremath{\\mathbf{o}}))')
('2.2.1', '\\label{nail_eq:fgan_rkl_objective}\nJ_{\\text{RKL-FGAN}}(\\nu) = \\underset{\\nu}{\\max} \\; \\mathrm{E}_{\\ensuremath{\\mathbf{o}}\\sim p^{\\pi}(\\ensuremath{\\mathbf{o}})}\\left[ \\nu(\\ensuremath{\\mathbf{o}}) \\right] -\\mathrm{E}_{\\ensuremath{\\mathbf{o}}\\sim q(\\ensuremath{\\mathbf{o}})}\\left[  \\exp{\\nu(\\ensuremath{\\mathbf{o}})} \\right] + 1,')
('2.2.1', "\\nu^\\star(\\ensuremath{\\mathbf{o}}) = \\log \\left(- D^\\star(\\ensuremath{\\mathbf{o}})\\right) = \\log \\left( -f'_{\\text{RKL}}\\Big(\\frac{q(\\ensuremath{\\mathbf{o}})}{p^{\\pi}(\\ensuremath{\\mathbf{o}})}\\Big)\\right) = \\log \\Big(\\frac{p^{\\pi}(\\ensuremath{\\mathbf{o}})}{q(\\ensuremath{\\mathbf{o}})}\\Big) = -r(\\ensuremath{\\mathbf{o}}) - 1")
('2.2.1', '-r(\\ensuremath{\\mathbf{o}})')
('2.2.1', 'f')
('2.3.0', '\\label{nail_eq:maxent_expert_model}\n\\pi_\\text{expert}(\\ensuremath{\\mathbf{a}}| \\ensuremath{\\mathbf{s}}) = \\exp{\\Big({Q^\\text{soft}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})}-{V^\\text{soft}(\\ensuremath{\\mathbf{s}})}\\Big)} = \\exp{\\big(A^\\text{soft}\\big)}.')
('2.3.0', 'Q^\\text{soft}')
('2.3.0', 'V^\\text{soft}')
('2.3.0', 'A^\\text{soft}')
('2.3.0', "\\begin{aligned}\nQ^\\text{soft}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) &= r_\\text{expert}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) + \\gamma \\int_{\\ensuremath{\\mathbf{s}}'} p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) V^\\text{soft}(\\ensuremath{\\mathbf{s}}') d\\ensuremath{\\mathbf{s}}', \\\\\nV^\\text{soft}(\\ensuremath{\\mathbf{s}}) &= \\log \\int_\\ensuremath{\\mathbf{a}}\\exp\\big(Q^\\text{soft}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})\\big) \nd\\ensuremath{\\mathbf{a}}, \\\\\nA^\\text{soft}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) &= Q^\\text{soft}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - V^\\text{soft}(\\ensuremath{\\mathbf{s}}).\n\\end{aligned}")
('2.3.0', 'V^\\text{soft}(\\ensuremath{\\mathbf{s}})')
('2.3.0', '\\pi')
('2.3.0', '\\ensuremath{\\mathbf{s}}')
('2.3.0', '\\label{nail_eq:maxent_rl}\n\\underset{\\pi}{\\max} \\; J_\\text{maxent-RL}(\\pi) = \\underset{\\pi}{\\max} \\int_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}} p^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\left( r_\\text{expert}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}.')
('2.3.0', '\\tilde{\\mathbf{f}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.3.0', 'r_\\text{expert}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\boldsymbol{\\theta}^\\top \\mathbf{f}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}),')
('2.3.0', '\\mathbf{f}')
('2.3.0', '\\boldsymbol{\\theta}')
('2.3.0', "\\label{nail_eq:maxentLL}\n\\begin{aligned}\n\\mathcal{L} &= \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\left( r_{\\boldsymbol{\\theta}} + \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})} V^{\\text{soft},\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}') - V^{\\text{soft},\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}) \\right) \\right] \\\\\n&= \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ r_{\\boldsymbol{\\theta}} \\right] + (1-\\gamma) \\sum_{t=1}^{\\infty} \\gamma^{t} \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim q_{t}(\\ensuremath{\\mathbf{s}})} \\left[ V^{\\text{soft},\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}) \\right] - (1-\\gamma) \\sum_{t=0}^{\\infty} \\gamma^{t} \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim q_{t}(\\ensuremath{\\mathbf{s}})} \\left[ V^{\\text{soft},\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}) \\right] \\\\\n&=  \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\Big[ r_{\\boldsymbol{\\theta}} \\Big]  - (1-\\gamma) \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim p_{0}(\\ensuremath{\\mathbf{s}})} \\left[ V^{\\text{soft},\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}) \\right].\n\\end{aligned}\n%\\sum_{\\stateN,\\actionN \\sim q(\\stateN, \\actionN)} \\log \\pi^{\\boldsymbol{\\theta}}(\\actionN|\\stateN) = \\sum_{\\stateN, \\actionN ~ q(\\stateN,\\actionN)} \\log^\\boldsymbol{\\theta}")
('2.3.0', '\\begin{aligned}\n\\label{nail_eq:maxent_gradient}\n\\frac{d\\mathcal{L}}{d{\\boldsymbol{\\theta}}} &= \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\Big[ \\frac{dr_{\\boldsymbol{\\theta}}}{d\\boldsymbol{\\theta}} \\Big] - \\mathrm{E}_{\n\t\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim p^{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})\n} \\Big[ \\frac{dr_{\\boldsymbol{\\theta}}}{d\\boldsymbol{\\theta}} \\Big] \\\\\n&= \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\Big[ \\mathbf{f}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big] - \\mathrm{E}_{\n\t\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim p^{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})\n} \\Big[ \\mathbf{f}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) \\Big],\n\\end{aligned}')
('2.3.0', 'p^{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('2.3.0', 'r_{\\boldsymbol{\\theta}}')
('2.3.1', 'r_{\\boldsymbol{\\theta}}')
('2.3.1', 'p^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = p^{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('2.3.1', '\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('2.3.1', '\\label{nail_eq:airl_disc}\n\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('2.3.1', '\\pi')
('2.3.1', "\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}},\\ensuremath{\\mathbf{s}}') = f_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}) + \\gamma g(\\ensuremath{\\mathbf{s}}') - g(\\ensuremath{\\mathbf{s}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})")
('2.3.1', 'f_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}})')
('2.3.1', '\\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('2.3.1', 'i')
('2.3.1', '\\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) - \\log \\pi^{(i)}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('2.3.1', '\\pi^{(i)}')
('2.3.1', '\\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\pi^{(i)}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}')
('2.3.1', '\\pi^{(i)}')
('2.3.1', 'r(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) - \\log \\pi^{(i)}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}).')
('2.3.1', '\\pi')
('2.3.1', '\\label{nail_eq:airl_maxent}\nJ_\\text{AIRL-maxent} = \\underset{\\pi}{\\max} \\int_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}} p^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\left( \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}},')
('2.3.1', '\\bar{\\nu}_{\\boldsymbol{\\theta}}')
('2.3.1', 'q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('3', '\\begin{aligned}\n\\label{nail_eq:optimizationProblem}\n& \\max_\\pi - \\int_\\mathbf{o} p^\\pi(\\mathbf{o}) \\log{\\frac{p^\\pi(\\mathbf{o})}{q(\\mathbf{o})}} d\\mathbf{o} \\nonumber \\\\\n& =\\max_\\pi  \\int_{\\boldsymbol{\\tau}, \\mathbf{o}} p^\\pi(\\boldsymbol{\\tau)} p(\\mathbf{o}|\\boldsymbol{\\tau})  \\log{\\frac{q(\\mathbf{o})}{p^\\pi(\\mathbf{o})}} d\\boldsymbol{\\tau}d\\mathbf{o} \\nonumber\\\\\n& =\\max_\\pi  \\int_{\\boldsymbol{\\tau}} p^\\pi(\\boldsymbol{\\tau)} r(\\boldsymbol{\\tau}, \\pi) d\\boldsymbol{\\tau}.\n\\end{aligned}')
('3', '\\label{nail_eq:trajectoryReward}\nr(\\boldsymbol{\\tau}, \\pi) = \\int_{\\mathbf{o}} p(\\mathbf{o}|\\boldsymbol{\\tau}) \\log{\\frac{q(\\mathbf{o})}{\\int_{\\boldsymbol{\\tau}} p^\\pi(\\boldsymbol{\\tau}) p(\\mathbf{o}|\\boldsymbol{\\tau}) d\\boldsymbol{\\tau}}} d\\mathbf{o}')
('3', 'p^\\pi(\\boldsymbol{\\tau})')
('3', 'p^\\pi(\\boldsymbol{\\tau})')
('3', '\\tilde{p}(\\boldsymbol{\\tau})')
('3.0', 'p^\\pi(\\boldsymbol{\\tau})')
('3.0', '\\tilde{p}(\\boldsymbol{\\tau})')
('3.0', '\\begin{aligned}\n\\label{eq:decomposition}\np^\\pi(\\mathbf{o}) &= \\frac{p^\\pi(\\boldsymbol{\\tau}) p(\\mathbf{o}|\\boldsymbol{\\tau})}{p^\\pi(\\boldsymbol{\\tau|\\mathbf{o}})} \\nonumber\n= \\frac{p^\\pi(\\boldsymbol{\\tau}) p(\\mathbf{o}|\\boldsymbol{\\tau})}{\\tilde{p}(\\boldsymbol{\\tau|\\mathbf{o}})} \\frac{\\tilde{p}(\\boldsymbol{\\tau|\\mathbf{o}})}{p^\\pi(\\boldsymbol{\\tau|\\mathbf{o}})} = \\tilde{p}(\\mathbf{o}) \\frac{p^\\pi(\\boldsymbol{\\tau}) p(\\mathbf{o}|\\boldsymbol{\\tau})}{\\tilde{p}(\\boldsymbol{\\tau})p(\\mathbf{o}|\\boldsymbol{\\tau})}\n\\frac{\\tilde{p}(\\boldsymbol{\\tau|\\mathbf{o}})}{p^\\pi(\\boldsymbol{\\tau|\\mathbf{o}})} \\nonumber\\\\\n& = \\tilde{p}(\\mathbf{o}) \\frac{p^\\pi(\\boldsymbol{\\tau})}{\\tilde{p}(\\boldsymbol{\\tau})}\n\\frac{\\tilde{p}(\\boldsymbol{\\tau|\\mathbf{o}})}{p^\\pi(\\boldsymbol{\\tau|\\mathbf{o}})}.\n\\end{aligned}')
('3.0', '\\begin{aligned}\n\\label{nail_eq:reformulatedObjective}\n& \\max_\\pi  \\int_{\\boldsymbol{\\tau}, \\mathbf{o}} p^\\pi(\\boldsymbol{\\tau)} p(\\mathbf{o}|\\boldsymbol{\\tau}) \\log{\\frac{q(\\mathbf{o})}{p^\\pi(\\mathbf{o})}}  d\\boldsymbol{\\tau}d\\mathbf{o} \\nonumber\\\\\n=&\\max_\\pi \\int_{\\boldsymbol{\\tau}, \\mathbf{o}} p^\\pi(\\boldsymbol{\\tau)} p(\\mathbf{o}|\\boldsymbol{\\tau}) \\left( \\log{\\frac{q(\\mathbf{o})}{\\tilde{p}(\\mathbf{o})}} - \\log\\frac{p^\\pi(\\boldsymbol{\\tau})}{\\tilde{p}(\\boldsymbol{\\tau})} + \\log\\frac{p^\\pi(\\boldsymbol{\\tau|\\mathbf{o}})}{\\tilde{p}^\\pi(\\boldsymbol{\\tau|\\mathbf{o}})} \\right)  d\\boldsymbol{\\tau}d\\mathbf{o} \\nonumber \\\\\n=&\\max_\\pi  \\int_{\\boldsymbol{\\tau}, \\mathbf{o}} p^\\pi(\\boldsymbol{\\tau)} p(\\mathbf{o}|\\boldsymbol{\\tau})  \\log{\\frac{q(\\mathbf{o})}{\\tilde{p}(\\mathbf{o})}} d\\boldsymbol{\\tau}d\\mathbf{o} - \\text{KL}\\left(p^\\pi(\\boldsymbol{\\tau})||\\tilde{p}(\\boldsymbol{\\tau})\\right)  \\\\\n&  + \\mathrm{E}_{p^\\pi(\\mathbf{o})} \\left[ \\text{KL}\\left(p^\\pi(\\boldsymbol{\\tau}|\\mathbf{o})||\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right]  \\nonumber \\\\\n=&\\max_\\pi \\int_{\\boldsymbol{\\tau}, \\mathbf{o}} p^\\pi(\\boldsymbol{\\tau)} p(\\mathbf{o}|\\boldsymbol{\\tau})  \\log{\\frac{q(\\mathbf{o})}{\\tilde{p}(\\mathbf{o})}} d\\boldsymbol{\\tau}d\\mathbf{o}  \\nonumber\\\\\n&- (1-\\gamma) \\sum_t \\gamma^t \\int_\\mathbf{s} p_t^\\pi(\\mathbf{s}) \\int_\\mathbf{a} \\pi(\\mathbf{a}|\\mathbf{s}) \\log\\frac{\\pi(\\mathbf{a}|\\mathbf{s})}{\\tilde{\\pi}(\\mathbf{a}|\\mathbf{s})} d\\mathbf{a}d\\mathbf{s} + \\mathrm{E}_{p^\\pi(\\mathbf{o})} \\left[ \\text{KL}\\left(p^\\pi(\\boldsymbol{\\tau}|\\mathbf{o})||\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right]  \\nonumber \\\\\n\\begin{split}\n\\label{nail_eq:lowerbound_plus_EKL}\n=&\\max_\\pi H(\\pi) + \\int_{\\boldsymbol{\\tau}, \\mathbf{o}} p^\\pi(\\boldsymbol{\\tau)} p(\\mathbf{o}|\\boldsymbol{\\tau})  \\log{\\frac{q(\\mathbf{o})}{\\tilde{p}(\\mathbf{o})}} d\\boldsymbol{\\tau}d\\mathbf{o}   \\\\&+  (1-\\gamma) \\sum_t \\gamma^t \\int_\\mathbf{s} p_t^\\pi(\\mathbf{s}) \\int_\\mathbf{a} \\pi(\\mathbf{a}|\\mathbf{s}) \\log{\\tilde{\\pi}(\\mathbf{a}|\\mathbf{s})} d\\mathbf{a}d\\mathbf{s}  + \\mathrm{E}_{p^\\pi(\\mathbf{o})} \\left[ \\text{KL}\\left(p^\\pi(\\boldsymbol{\\tau}|\\mathbf{o})||\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right].\n\\end{split}\n\\end{aligned}')
('3.0', 'H(\\pi)')
('3.0', '\\pi')
('3.0', 'H(\\mathbf{\\pi}) = - (1-\\gamma) \\sum_{t=0}^\\infty \\gamma^t \\int_\\mathbf{s} p_t^\\pi(\\mathbf{s}) \\int_\\mathbf{a} \\pi(\\mathbf{a}|\\mathbf{s}) \\log\\pi(\\mathbf{a}|\\mathbf{s}) d\\mathbf{a} d\\mathbf{s}.')
('3.0', '\\label{eq:lowerBoundTraj}\n\\mathcal{L} = H(\\pi) + \\int_{\\mathbf{o}} p^\\pi(\\mathbf{o}) \\log{\\frac{q(\\mathbf{o})}{\\tilde{p}(\\mathbf{o})}} d\\mathbf{o} + (1-\\gamma) \\sum_t \\gamma^t \\int_\\mathbf{s} p_t^\\pi(\\mathbf{s}) \\int_\\mathbf{a} \\pi(\\mathbf{a}|\\mathbf{s}) \\log{\\tilde{\\pi}(\\mathbf{a}|\\mathbf{s})} d\\mathbf{a}d\\mathbf{s}.')
('3.0', '\\begin{aligned}\n\\label{nail_eq:lb_objective}\n\\underset{\\pi}{\\max}\\; J_{\\text{NAIL}, \\tilde{\\pi}}(\\pi) =& \\underset{\\pi}{\\max} \\int_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}} p^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big( \\underbrace{\\log \\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})}_{r_\\text{lb}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})} - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\Big) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}.\n\\end{aligned}')
('3.0', 'r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\log\\left(\\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}\\right) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('3.0', '\\tilde{\\pi}')
('3.0', '\\pi')
('3.0', '\\tilde{\\pi}')
('3.0', 'J_{\\text{NAIL}, \\tilde{\\pi}}(\\pi) >  J_{\\text{NAIL}, \\tilde{\\pi}}(\\tilde {\\pi}) \\implies D_\\text{RKL}(p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})) < D_\\text{RKL}(p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})).')
('3.0', 'J_{\\text{NAIL}, \\tilde{\\pi}}(\\pi)')
('3.0', '\\tilde{\\pi}')
('3.0', '\\underset{\\pi}{\\max}\\; J_{\\text{AIL-RKL}}(\\pi) = \\int_{\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}} p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) \\underbrace{\\log \\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} }_{r_\\text{adv}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})} d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}},')
('3.0', 'r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('3.0', '\\log{\\tilde{\\pi}(\\ensuremath{\\mathbf{a}}| \\ensuremath{\\mathbf{s}})}')
('3.0', '\\tilde{\\pi}')
('3.0', '\\tilde{\\pi}')
('3.0', '\\pi')
('3.0', 'r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('3.0', 'q(\\ensuremath{\\mathbf{o}})')
('3.1', '\\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('3.1', '\\text{KL}\\left(p^\\pi(\\boldsymbol{\\tau})||\\tilde{p}(\\boldsymbol{\\tau})\\right)')
('3.1', '\\tilde{\\pi}')
('3.1', '\\mathcal{D}=\\left\\{(\\ensuremath{\\mathbf{s}_{i}},\n\t\t\\ensuremath{\\mathbf{a}_{i}})\\right\\}_{i=1 \\dots N}')
('3.1', '\\tilde{\\pi}')
('3.1', '\\tilde{\\phi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})=')
('3.1', '(\\tilde{\\pi}, \\mathcal{D})')
('3.1', '\\tilde{\\pi} \\gets')
('3.1', '(\\tilde{\\pi}, \\tilde{\\phi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}))')
('4.0', '\\tilde{\\pi}')
('4.0', '\\log \\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}')
('4.0', '\\begin{aligned}\n\t\t\\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) \\approx \\log \\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}\n\t\t\n\\end{aligned}')
('4.0', '\\begin{aligned}\n\t\t\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) \\approx \\log \\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}).\n\t\t\n\\end{aligned}')
('4.0', 'J_\\text{AIRL-maxent}(\\pi)')
('4.0', 'J_{\\text{NAIL}, \\tilde{\\pi}}(\\pi)')
('4.0', '\\widetilde{\\phi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.0', 'r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.0', '\\tilde{\\pi}')
('4.0', 'p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\approx q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('4.0', 'r_\\text{adv}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = \\log \\frac{q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\approx 0')
('4.0', 'A^{\\text{soft}}_{\\text{expert}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = \\log \\pi_{\\text{expert}}(\\ensuremath{\\mathbf{a}}| \\ensuremath{\\mathbf{s}})')
('4.0', 'r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.0', 'r_{\\text{lb}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\log\\left(\\frac{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}\\right) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) = \\log\\left(\\frac{q(\\ensuremath{\\mathbf{s}})}{p^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}})}\\right) + \\log \\pi_{\\text{expert}}(\\ensuremath{\\mathbf{a}}| \\ensuremath{\\mathbf{s}}).')
('4.0', "\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}},\\ensuremath{\\mathbf{s}}') = f_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}) + \\gamma g_{\\eta}(\\ensuremath{\\mathbf{s}}') - g_{\\eta}(\\ensuremath{\\mathbf{s}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})")
('4.0', 'f_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}})')
('4.0', '\\bar{\\nu}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.1', '\\underset{\\pi}{\\max}\\; \\Big[ J_\\text{bc}(\\pi) = \\mathrm{E}_{\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})} \\left[ \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right] \\Big].')
('4.1.0', 'q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.1.0', '\\label{nail_eq:DV_IL}\n\\underset{\\pi}{\\min}\\;\\text{KL}(p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})) = \\underset{\\pi}{\\min} \\; \\underset{\\nu}{\\max} \\; -\\log \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\exp \\left( \\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) \\right) \\right] +  \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\nu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) \\right].')
('4.1.0', '\\label{nail_eq:optimalNuDV}\n\\nu^{\\star}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\log \\frac{p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} + \\textrm{const},')
('4.1.0', 'f')
('4.1.0', 'p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('4.1.0', '\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('4.1.0', 'Q^{\\pi}_{\\nu}')
('4.1.0', '\\pi')
('4.1.0', '\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('4.1.0', "\\label{nail_eq:VD_CoV}\n\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}}' \\sim \\pi(\\ensuremath{\\mathbf{a}}'|\\ensuremath{\\mathbf{s}}')} \\left[ Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}', \\ensuremath{\\mathbf{a}}')  \\right].")
('4.1.0', "\\begin{aligned}\n\\begin{split}\n\\nonumber\n\\underset{\\pi}{\\min} \\; \\underset{ Q^{\\pi}_{\\nu}}{\\max} \\; -&\\log \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\exp \\left( Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}}' \\sim \\pi(\\ensuremath{\\mathbf{a}}'|\\ensuremath{\\mathbf{s}}')} \\left[ Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}', \\ensuremath{\\mathbf{a}}')  \\right] \\right) \\right] \\\\\n&+  \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}}' \\sim \\pi(\\ensuremath{\\mathbf{a}}'|\\ensuremath{\\mathbf{s}}')} \\left[ Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}', \\ensuremath{\\mathbf{a}}')  \\right] \\right] \n\\end{split}\n\\\\\n\\begin{split}\n\\label{nail_eq:VD_obj}\n=\\underset{\\pi}{\\min} \\; \\underset{ Q^{\\pi}_{\\nu}}{\\max} &-\\log \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\exp \\left( Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}}' \\sim \\pi(\\ensuremath{\\mathbf{a}}'|\\ensuremath{\\mathbf{s}}')} \\left[ Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}}', \\ensuremath{\\mathbf{a}}')  \\right] \\right) \\right] \\\\\n&+ (1-\\gamma) \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{0}} \\sim p_{0}(\\ensuremath{\\mathbf{s}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}_{0}} \\sim \\pi(\\ensuremath{\\mathbf{a}_{0}}|\\ensuremath{\\mathbf{s}_{0}})} \\left[ Q^{\\pi}_{\\nu}(\\ensuremath{\\mathbf{s}_{0}}, \\ensuremath{\\mathbf{a}_{0}})  \\right].\n\\end{split}\n\\end{aligned}")
('4.1.0', "(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}, \\ensuremath{\\mathbf{s}}')")
('4.1.0', '\\ensuremath{\\mathbf{s}_{0}}')
('4.1.0', "\\ensuremath{\\mathbf{a}}'")
('4.1.0', '\\ensuremath{\\mathbf{a}_{0}}')
('4.1.0', 'r_\\text{adv}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})=\\log\\left( \\frac{q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})}{p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})} \\right)')
('4.1.1', 'Q_{\\text{lb}}^{\\text{soft, }\\pi^{(i)}}')
('4.1.1', '\\pi^{(i)}')
('4.1.1', 'r_{\\text{lb}}^{\\pi^{(i)}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.1.1', '\\pi^{(i+1)}')
('4.1.1', 'J_{\\text{NAIL},\\pi^{(i)}}')
('4.1.1', 'r_{\\text{lb}}^{\\pi^{(i)}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('4.1.1', 'Q_{r}^{\\tilde{\\pi}}')
('4.1.1', '\\tilde{\\pi}')
('4.1.1', 'r')
('4.1.1', 'Q_{r_\\text{lb}}^{\\text{soft},\\tilde{\\pi}}')
('4.1.1', '\\tilde{\\pi}')
('4.1.1', 'r_{\\text{lb}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = r(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('4.1.1', 'Q_{r_\\text{lb}}^{\\text{soft},\\tilde{\\pi}}')
('4.1.1', 'Q_{r}^{\\tilde{\\pi}}')
('4.1.1', 'Q_{r_\\text{lb}}^{\\text{soft},\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = Q_{r}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}).')
('4.1.1', '\\tilde{\\pi}')
('4.1.1', "\\begin{aligned}\n\\label{nail_eq:nail_critic}\n\\begin{split}\n-Q_{r_{\\text{adv}}}^{\\tilde{\\pi}} = \\underset{Q^{\\tilde{\\pi}}_{\\nu}}{\\mathop{\\mathrm{arg\\,max}}} &-\\log \\mathrm{E}_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\exp \\left( Q^{\\tilde{\\pi}}_{\\nu}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}}' \\sim \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}'|\\ensuremath{\\mathbf{s}}')} \\left[ Q^{\\tilde{\\pi}}_{\\nu}(\\ensuremath{\\mathbf{s}}', \\ensuremath{\\mathbf{a}}')  \\right] \\right) \\right] \\\\\n&+ (1-\\gamma) \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{0}} \\sim p_{0}(\\ensuremath{\\mathbf{s}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}_{0}} \\sim \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{0}}|\\ensuremath{\\mathbf{s}_{0}})} \\left[ Q^{\\tilde{\\pi}}_{\\nu}(\\ensuremath{\\mathbf{s}_{0}}, \\ensuremath{\\mathbf{a}_{0}})  \\right].\n\\end{split}\n\\end{aligned}")
('4.1.1', 'Q_{r_{\\text{adv}}}^{\\tilde{\\pi}}')
('4.1.1', '\\nu')
('4.1.1', '\\nu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\approx -r_\\text{adv}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + \\mathrm{const}')
('4.1.1', '\\begin{aligned}\n\\label{nail_eq:nail_actor_loss}\n\\mathcal{L}_{\\text{actor}, \\pi^{(i)}}(\\pi) =& - \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim z(\\ensuremath{\\mathbf{s}})} \\left[ \\int_{\\ensuremath{\\mathbf{a}}} \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\left( Q_{\\text{adv}}^{\\pi^{(i)}} + \\log {\\pi}^{(i)}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right) d\\ensuremath{\\mathbf{a}}\\right] \\\\\n=& - \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim z(\\ensuremath{\\mathbf{s}})} \\left[ \\mathcal{L}_{\\text{actor}, \\pi^{(i)}}(\\pi, \\ensuremath{\\mathbf{s}}) \\right], \\nonumber\n\\end{aligned}')
('4.1.1', 'z(\\ensuremath{\\mathbf{s}})')
('4.1.1', '\\pi')
('4.1.1', 'z(\\ensuremath{\\mathbf{s}}) = q(\\ensuremath{\\mathbf{s}})')
('4.1.1', 'Q^{\\tilde{\\pi}}_{r_{\\text{adv}}}')
('4.1.1', '\\pi')
('4.1.1', '\\mathcal{L}_{\\text{actor}, \\pi^{(i)}}(\\pi,\\ensuremath{\\mathbf{s}})')
('4.1.1', '\\pi^{(i)}')
('4.1.1', '\\ensuremath{\\mathbf{s}}')
('4.1.1', '\\pi^{(i)}')
('4.1.1', 'J_{\\text{NAIL},\\pi^{(i)}}(\\pi)')
('4.1.1', '\\forall_{\\ensuremath{\\mathbf{s}}}:\\mathcal{L}_{\\text{actor}, \\pi^{(i)}}(\\pi, \\ensuremath{\\mathbf{s}}) \\le \\mathcal{L}_{\\text{actor}, \\pi^{(i)}}(\\pi^{(i)}, \\ensuremath{\\mathbf{s}}) \\implies J_{\\text{NAIL},\\pi^{(i)}}(\\pi) \\ge J_{\\text{NAIL},\\pi^{(i)}}(\\pi^{(i)}).')
('4.1.1', "\\widetilde{\\phi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = \\exp \\left( Q_{r_{\\text{adv}}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}}' \\sim p(\\ensuremath{\\mathbf{s}}'|\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\mathrm{E}_{\\ensuremath{\\mathbf{a}}' \\sim \\pi(\\ensuremath{\\mathbf{a}}'|\\ensuremath{\\mathbf{s}}')} \\left[ Q_{r_{\\text{adv}}}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}}', \\ensuremath{\\mathbf{a}}')  \\right] \\right).")
('4.1.1', 'Q^{\\tilde{\\pi}}_{r_{\\text{adv}}}')
('4.1.1', '\\mathcal{D}=\\left\\{(\\ensuremath{\\mathbf{s}_{i}},\n\t\t\\ensuremath{\\mathbf{a}_{i}})\\right\\}_{i=1 \\dots N}')
('4.1.1', '\\tilde{\\pi}')
('4.1.1', 'Q_{r_{\\text{adv}}}^{\\tilde{\\pi}} \\gets')
('4.1.1', '(\\tilde{\\pi},\\mathcal{D})')
('4.1.1', '\\tilde{\\pi} \\gets')
('4.1.1', '(\\tilde{\\pi}, Q_{r_{\\text{adv}}}^{\\tilde{\\pi}})')
('5', '\\tanh')
('5', '\\eta_\\pi')
('5', '\\eta_Q')
('5', 'N_\\pi')
('5', 'N_Q')
('5', '\\eta_\\pi')
('5', '\\eta_Q')
('5', 'N_\\pi')
('5', 'N_Q')
('6.0', 'f')
('8', '\\begin{aligned}\nJ_\\text{BCE}(\\boldsymbol{\\theta}) =& E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\log \\left( \\frac{\n\t\\exp{ \\Big(\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big)}}{ \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) + \\exp{ \\Big(\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})  \\Big)}} \\right) \\right] \\\\\n&+ E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\log \\left( \\frac{\\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})}{\\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) + \\exp{ \\Big(\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big)}} \\right) \\right] \\\\\n=& E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \n\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})  \\right]\n+ E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim p^{\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right] \\\\\n&- 2 E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim \\mu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\log \\left( \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) + \\exp{ \\Big(\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big)} \\right) \\right],\n\\end{aligned}')
('8', '\\mu(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\frac{1}{2} (q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + p^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}))')
('8', '\\begin{aligned}\n\\label{nail_eq:bce_gradient}\n\\frac{dJ_\\text{BCE}(\\boldsymbol{\\theta})}{d\\boldsymbol{\\theta}} =&\nE_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \n\\frac{d \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{d \\boldsymbol{\\theta}}  \\right]\n- 2 E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim \\mu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\frac{\\exp{ \\Big(\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big)}}{\\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) + \\exp{ \\Big(\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\Big)}}\n\\frac{d \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{d \\boldsymbol{\\theta}}\n\\right] \\nonumber \\\\\n=&\nE_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \n\\frac{d \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{d \\boldsymbol{\\theta}}  \\right]\n- E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim \\mu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\frac{{\\bar{p}}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{\\frac{1}{2} \\left(\n\tp^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + {\\bar{p}}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\right)}\n\\frac{d \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{d \\boldsymbol{\\theta}}\n\\right] \\nonumber \\\\\n=&\nE_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim q(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \n\\frac{d \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{d \\boldsymbol{\\theta}}  \\right]\n- E_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}\\sim \\mu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})} \\left[ \\frac{{\\bar{p}}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{\\bar{\\mu}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}\n\\frac{d \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})}{d \\boldsymbol{\\theta}}\n\\right],\n\\end{aligned}')
('8', '{\\bar{p}}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = p^\\pi(\\ensuremath{\\mathbf{s}}) \\exp\\left( \\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\right)')
('8', '{\\bar{\\mu}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})=\\frac{1}{2} \\left(\np^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + {\\bar{p}}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\right)')
('8', '\\pi')
('8', '\\bar{p}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = p_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('8', '\\bar{p}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('8', '\\bar{\\mu}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})=\\mu(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('8', 'p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\bar{p}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('8', '\\bar{\\nu}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = A^{\\text{soft},\\pi}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) = \\log{\\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})}')
('8', '\\bar{p}_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = p_{\\boldsymbol{\\theta}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('9', 'p(t|\\ensuremath{\\boldsymbol{\\tau}}) = \n\t\\begin{cases}\n\t\\frac{1}{T(\\ensuremath{\\boldsymbol{\\tau}})} & t < T(\\ensuremath{\\boldsymbol{\\tau}}) \\\\\n\t0 & otherwise\n\t\\end{cases}')
('9', 't')
('9', '\\ensuremath{\\boldsymbol{\\tau}}')
('9', 'T(\\ensuremath{\\boldsymbol{\\tau}})')
('9', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}},t) = p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{a}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}})')
('9', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}})')
('9', '\\label{nail_eq:prop_state_reward_eq1}\np(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}) = \\sum_{t=0}^{\\infty} p(t|\\ensuremath{\\boldsymbol{\\tau}}) p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}},t) = \\sum_{t=0}^{\\infty} p(t|\\ensuremath{\\boldsymbol{\\tau}}) p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{a}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}).')
('9', '\\begin{aligned}\n\\label{nail_eq:adv_step}\nJ_\\text{rl,ep}(\\pi) &= \\mathrm{E}_{\\ensuremath{\\boldsymbol{\\tau}}\\sim p^\\pi(\\ensuremath{\\boldsymbol{\\tau}})}\\left[  \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\boldsymbol{\\tau}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}}\\right] \\nonumber \\\\\n&=  \\int_{\\ensuremath{\\boldsymbol{\\tau}}} p^{\\pi}(\\ensuremath{\\boldsymbol{\\tau}})  \\int_\\ensuremath{\\mathbf{o}}\\sum_{t=0}^{\\infty} p(t|\\ensuremath{\\boldsymbol{\\tau}}) p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{a}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}} d\\ensuremath{\\boldsymbol{\\tau}}\\nonumber \\\\\n&= \\sum_{t=0}^{\\infty} p(t) \\int_{\\ensuremath{\\boldsymbol{\\tau}}}  p^{\\pi}(\\ensuremath{\\boldsymbol{\\tau}}|t)    \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}, \\ensuremath{\\mathbf{a}_{t}}^{\\ensuremath{\\boldsymbol{\\tau}}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}} d\\ensuremath{\\boldsymbol{\\tau}}\\nonumber \\\\\n&= \\sum_{t=0}^{\\infty}  p(t)  \\int_{\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}} p_{t}^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})  \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}} d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}\\nonumber \\\\\n&= (1 - \\gamma) \\sum_{t=0}^{\\infty} \\gamma^t \\int_{\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}}  p_{t}^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})  \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}} d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}\\nonumber \\\\\n&= (1 - \\gamma) \\sum_{t=0}^{\\infty} \\gamma^t \\int_{\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}}  p_{t}^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})  r_{\\text{adv}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}\\nonumber\\\\\n&= \\int_{\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}} p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) r_{\\text{adv}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}.\n\\end{aligned}')
('9', 'r_{\\text{adv}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\int_\\ensuremath{\\mathbf{o}} p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) f^*(D(\\ensuremath{\\mathbf{o}})) d\\ensuremath{\\mathbf{o}}')
('9', 'p(\\ensuremath{\\mathbf{o}}|\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})')
('9', '\\ensuremath{\\mathbf{o}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = [\\ensuremath{\\mathbf{s}}^\\top, \\ensuremath{\\mathbf{a}}^\\top ]^\\top')
('9', '\\ensuremath{\\mathbf{o}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = \\ensuremath{\\mathbf{s}}')
('10', 'D_\\text{RKL}(\\tilde{p}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}))')
('10', 'J_{\\text{NAIL},\\tilde{\\pi}}(\\tilde{\\pi})')
('10', '\\begin{aligned}\nD_\\text{RKL}(\\tilde{p}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})) = -J_{\\text{NAIL},\\tilde{\\pi}}(\\tilde{\\pi}) - \\mathrm{E}_{\\tilde{p}(\\mathbf{o})} \\left[ \\text{KL}\\left(\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})||\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right] \n= -J_{\\text{NAIL},\\tilde{\\pi}}(\\tilde{\\pi}),\n\\end{aligned}')
('10', '\\pi')
('10', '\\begin{aligned}\nD_\\text{RKL}(p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})) = -J_{\\text{NAIL},\\tilde{\\pi}}(\\pi) - \\mathrm{E}_{p^\\pi(\\mathbf{o})} \\left[ \\text{KL}\\left(p^{\\pi}(\\boldsymbol{\\tau}|\\mathbf{o})||\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right].\n\\end{aligned}')
('10', '\\pi')
('10', 'J_{\\text{NAIL},\\tilde{\\pi}}(\\pi) > J_{\\text{NAIL},\\tilde{\\pi}}(\\tilde{\\pi})')
('10', '\\begin{aligned}\n&D_\\text{RKL}(\\tilde{p}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})) - D_\\text{RKL}(p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})) \\\\ &\\quad=  \\underbrace{J_{\\text{NAIL},\\tilde{\\pi}}(\\pi) - J_{\\text{NAIL},\\tilde{\\pi}}(\\tilde{\\pi})}_{> 0} + \\underbrace{\\mathrm{E}_{p^\\pi(\\mathbf{o})} \\left[ \\text{KL}\\left(p^{\\pi}(\\boldsymbol{\\tau}|\\mathbf{o})||\\tilde{p}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right]}_{>0} > 0.\n\\end{aligned}')
('11', '\\left\\{D_\\text{RKL}(p^{\\pi^{(i)}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}))\\right\\}_{i=0}^{\\infty}')
('11', '\\pi^{(i)}')
('11', '\\begin{aligned}\n0 = \\frac{d}{d\\pi} J_{\\text{NAIL},\\pi^{(i)}}(\\pi)\\bigg\\rvert_{\\pi=\\pi^{(i)}} =& \\frac{d}{d\\pi} D_\\text{RKL}(p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}))\\bigg\\rvert_{\\pi=\\pi^{(i)}}  \\\\ &+ \\underbrace{\\frac{d}{d\\pi} \\mathrm{E}_{p^\\pi(\\mathbf{o})} \\left[ \\text{KL}\\left(p^{\\pi}(\\boldsymbol{\\tau}|\\mathbf{o})||p^{\\pi^{(i)}}(\\boldsymbol{\\tau}|\\mathbf{o})\\right) \\right]\\bigg\\rvert_{\\pi=\\pi^{(i)}} }_{=0}.\n\\end{aligned}')
('11', '\\pi^{(i)}')
('11', '\\begin{aligned}\n\\frac{d}{d\\pi} D_\\text{RKL}(p^{\\pi}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}})||q(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}))\\bigg\\rvert_{\\pi=\\pi^{(i)}} = 0.\n\\end{aligned}')
('12', '\\pi')
('12', 'r')
('12', '\\label{nail_eq:softpolicyeval}\n\\mathcal{T}^\\pi Q^{\\text{soft}}(\\ensuremath{\\mathbf{s}_{t}},\\ensuremath{\\mathbf{a}_{t}}) \\triangleq r(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) + \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{t+1}} \\sim p} \\left[ V^{\\text{soft}}(\\ensuremath{\\mathbf{s}_{t+1}}) \\right]')
('12', 'V^\\text{soft}(\\ensuremath{\\mathbf{s}}) = \\mathrm{E}_{\\ensuremath{\\mathbf{a}}\\sim \\pi} \\left[ Q^{\\text{soft}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right].')
('12', '\\hat{Q}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\triangleq Q_{r}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('12', '\\tilde{\\pi}')
('12', 'r_{\\text{lb}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) = r(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})')
('12', '\\hat{Q} = Q_{r_\\text{lb}}^{\\text{soft},\\tilde{\\pi}}')
('12', '\\hat{Q}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})')
('12', '\\begin{aligned}\n\\mathcal{T}^{\\tilde{\\pi}} \\hat{Q}(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) &=r_{\\text{lb}}(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) + \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{t+1}} \\sim p, \\ensuremath{\\mathbf{a}_{t+1}} \\sim \\tilde{\\pi}} \\left[ \\hat{Q}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}})  - \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{t+1}}|\\ensuremath{\\mathbf{s}_{t+1}}) \\right] \\\\\n&= r(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) +  \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{t}}|\\ensuremath{\\mathbf{s}_{t}}) \\\\\n&\\phantom{=}+ \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{t+1}} \\sim p, \\ensuremath{\\mathbf{a}_{t+1}} \\sim \\tilde{\\pi}} \\Big[ Q_{r}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}_{t+1}},\\ensuremath{\\mathbf{a}_{t+1}}) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{t+1}}|\\ensuremath{\\mathbf{s}_{t+1}}) - \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{t+1}}|\\ensuremath{\\mathbf{s}_{t+1}}) \\Big] \\\\\n&= r(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) +  \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{t}}|\\ensuremath{\\mathbf{s}_{t}}) + \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{t+1}} \\sim p, \\ensuremath{\\mathbf{a}_{t+1}} \\sim \\tilde{\\pi}} \\left[ Q_{r}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}_{t+1}}, \\ensuremath{\\mathbf{a}_{t+1}}) \\right]\n\\\\\n&= Q_{r}^{\\tilde{\\pi}}(\\ensuremath{\\mathbf{s}_{t}},\\ensuremath{\\mathbf{a}_{t}}) + \\log \\tilde{\\pi}(\\ensuremath{\\mathbf{a}_{t}}|\\ensuremath{\\mathbf{s}_{t}}) = \\hat{Q}(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}).\n\\end{aligned}')
('13', '\\mathbf{s}')
('13', '\\begin{aligned}\n\\begin{split}\n\\label{nail_eq:soft_actor_improvement}\n\\mathrm{E}_{\\ensuremath{\\mathbf{a}}\\sim \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})} \\left[ Q_{r_\\text{lb}}^{\\text{soft},{\\pi}^{(i)}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\log{\\pi}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})  \\right] \\ge &\\mathrm{E}_{\\ensuremath{\\mathbf{a}}\\sim \\pi^{(i)}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}})} \\left[ Q_{r_\\text{lb}}^{\\text{soft},{\\pi}^{(i)}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\log{\\pi^{(i)}}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right] \\\\\n&= V_{r_\\text{lb}}^{\\text{soft},{\\pi}^{(i)}}(\\ensuremath{\\mathbf{s}}).\n\\end{split}\n\\end{aligned}')
('13', '\\begin{aligned}\n\\begin{split}\n\\label{nail_eq:newQlargeroldQ}\nQ_{r_\\text{lb}}^{\\text{soft},{\\pi}^{(i)}}(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) &= r_\\text{lb}(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) + \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{t+1}} \\sim p} \\left[ V^{\\text{soft}}(\\ensuremath{\\mathbf{s}_{t+1}}) \\right] \\\\\n&\\le r_\\text{lb}(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}) + \\gamma \\mathrm{E}_{\\ensuremath{\\mathbf{s}_{t+1}} \\sim p, \\ensuremath{\\mathbf{a}_{t+1}} \\sim \\pi} \\left [ Q_{r_\\text{lb}}^{\\text{soft},{\\pi}^{(i)}}(\\ensuremath{\\mathbf{s}_{t+1}}, \\ensuremath{\\mathbf{a}_{t+1}}) - \\log{\\pi}(\\ensuremath{\\mathbf{a}_{t+1}}|\\ensuremath{\\mathbf{s}_{t+1}})  \\right] \\\\\n&\\; \\;\\vdots \\\\\n&\\le Q_{r_\\text{lb}}^{\\text{soft},{\\pi}}(\\ensuremath{\\mathbf{s}_{t}}, \\ensuremath{\\mathbf{a}_{t}}).\n\\end{split}\n\\end{aligned}')
('13', 'J_{\\text{NAIL}, \\pi^{(i)}}(\\pi)')
('13', 'Q_{r_\\text{lb}}^{\\text{soft},{\\pi}}')
('13', 'J_{\\text{NAIL}, \\pi^{(i)}}(\\pi^{(i)})')
('13', '\\begin{aligned}\nJ_{\\text{NAIL}, \\pi^{(i)}}(\\pi) =& \\int_{\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}} p^\\pi(\\ensuremath{\\mathbf{s}},\\ensuremath{\\mathbf{a}}) \\left( r_\\text{lb}^{\\pi^{(i)}}(\\ensuremath{\\mathbf{s}}, \\ensuremath{\\mathbf{a}}) - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right) d\\ensuremath{\\mathbf{s}} d\\ensuremath{\\mathbf{a}}\\\\\n=& (1-\\gamma) \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim p_{0}(\\ensuremath{\\mathbf{s}}), \\ensuremath{\\mathbf{a}}\\sim \\pi} \\left[ Q_{r_\\text{lb}^{\\pi^{(i)}}}^{\\text{soft},{\\pi}} - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right] \n\t\\\\\n\\ge& (1-\\gamma) \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim p_{0}(\\ensuremath{\\mathbf{s}}), \\ensuremath{\\mathbf{a}}\\sim \\pi} \\left[ Q_{r_\\text{lb}^{\\pi^{(i)}}}^{\\text{soft},{\\pi^{(i)}}} - \\log \\pi(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right] \n\\\\\n\\ge&\n(1-\\gamma) \\mathrm{E}_{\\ensuremath{\\mathbf{s}}\\sim p_{0}(\\ensuremath{\\mathbf{s}}), \\ensuremath{\\mathbf{a}}\\sim \\pi^{(i)}} \\left[ Q_{r_\\text{lb}^{\\pi^{(i)}}}^{\\text{soft},{\\pi^{(i)}}} - \\log \\pi^{(i)}(\\ensuremath{\\mathbf{a}}|\\ensuremath{\\mathbf{s}}) \\right] \n= J_{\\text{NAIL}, \\pi^{(i)}}(\\pi^{(i)}).\n\\end{aligned}')
