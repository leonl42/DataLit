('1', '\\pi_{\\theta_{k}}')
('1', '\\pi_{\\theta}')
('1', '\\pi_{\\theta_{k}}')
('1', '\\pi_{\\theta_{k}}')
('1', '\\pi_{\\theta_{k}}')
('1', '\\eta(\\pi_{\\theta},\\pi_{\\theta_{k}})')
('1', '\\pi_{\\theta_{k}}')
('1', '\\pi_{\\theta}')
('1', '\\displaystyle\\underset{\\theta}{\\text{maximize}}\\quad\\hat{J}(\\pi_{\\theta}\\;|\\;%\n\\pi_{\\theta_{k}},\\,\\mbox{new data})')
('1', '\\displaystyle\\underset{\\theta}{\\text{maximize}}\\quad')
('1', '\\displaystyle\\hat{J}(\\pi_{\\theta}\\;|\\;\\pi_{\\theta_{k}},\\,\\mbox{new data})')
('1', '\\displaystyle\\text{subject to}\\eta(\\pi_{\\theta},\\pi_{\\theta_{k}})\\leq\\delta')
('1', '\\displaystyle\\eta(\\pi_{\\theta},\\pi_{\\theta_{k}})\\leq\\delta')
('1', '\\hat{J}(\\pi_{\\theta}\\;|\\;\\pi_{\\theta_{k}},\\,\\mbox{new data})')
('1', 'J(\\pi_{\\theta})')
('1', '\\pi_{\\theta}')
('1', '\\pi_{\\theta_{k}}')
('1', '\\pi_{\\theta_{k}}')
('1', '\\pi_{\\theta_{k}}')
('2', '\\mathcal{S}')
('2', '\\mathcal{A}')
('2', 'r(s,a)')
('2', 's\\in\\mathcal{S}')
('2', 'a\\in\\mathcal{A}')
('2', '\\pi=\\{\\pi(a|s):s\\in\\mathcal{S},a\\in\\mathcal{A}\\}')
('2', '\\Pi')
('2', 'J(\\pi)\\triangleq\\operatorname*{\\mathbb{E}}_{\\tau\\sim\\pi}\\left[\\sum_{t=0}^{%\n\\infty}\\gamma^{t}r(s_{t},a_{t})\\right]')
('2', '\\gamma\\in(0,1)')
('2', '\\tau=(s_{0},a_{0},s_{1},\\dots)')
('2', 'A^{\\pi}(s,a)')
('2', '\\pi')
('2', '\\Pi_{\\text{DL}}=\\{\\pi_{\\theta}|\\theta\\in\\Theta\\}\\subset\\Pi')
('2', '\\Pi_{\\text{DL}}')
('2', '\\Pi')
('2', 'J(\\pi_{\\theta})')
('2', '\\Pi_{\\text{DL}}')
('2', 'J(\\pi_{\\theta})')
('2', '\\theta=\\theta_{k}')
('2', '\\nabla_{\\theta}J(\\pi_{\\theta_{k}})=\\operatorname*{\\mathbb{E}}_{\\tau\\sim\\pi_{%\n\\theta_{k}}}\\left[\\sum_{t=0}^{\\infty}\\gamma^{t}\\nabla_{\\theta}\\log\\pi_{\\theta_%\n{k}}(a_{t}|s_{t})A^{\\pi_{\\theta_{k}}}(s_{t},a_{t})\\right].')
('2', '\\pi_{\\theta_{k}}')
('2', '\\nabla_{\\theta}J(\\pi_{\\theta_{k}})\\approx\\dfrac{1}{N}\\sum_{i=1}^{N}\\sum_{t=0}^%\n{T-1}\\nabla_{\\theta}\\log\\pi_{\\theta_{k}}(a_{it}|s_{it})A^{\\pi_{\\theta_{k}}}(s_%\n{t},a_{t})\\triangleq g_{k}')
('2', 'd^{\\pi}(s)\\triangleq(1-\\gamma)\\sum_{t=0}^{\\infty}\\gamma^{t}P_{\\pi}(s_{t}=s)')
('2', '\\pi')
('2', '\\pi(\\cdot|s)')
('2', '\\mathcal{A}')
('2', 's')
('2', '\\pi')
('2', '{D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]}')
('2', '\\pi(\\cdot|s)')
('2', '\\pi_{\\theta_{k}}(\\cdot|s)')
('2', '\\bar{D}_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})=\\operatorname*{\\mathbb{E}}_{%\ns\\sim d^{\\pi_{\\theta_{k}}}}[D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]]')
('2.1', 'J(\\pi_{\\theta})')
('2.1', '\\pi_{\\theta_{k}}')
('2.1', 'J(\\pi_{\\theta})-J(\\pi_{\\theta_{k}})')
('2.1', 'J(\\pi_{\\theta})')
('2.1', '\\theta_{k}')
('2.1', 'J(\\pi_{\\theta})-J(\\pi_{\\theta_{k}})\\approx(\\theta-\\theta_{k})^{T}\\nabla_{%\n\\theta}J(\\pi_{\\theta_{k}})\\approx(\\theta-\\theta_{k})^{T}g_{k}')
('2.1', 'g_{k}')
('2.1', 'd^{\\pi}(s)')
('2.1', 'd^{\\pi_{\\theta_{k}}}(s)')
('2.1', 'J(\\pi)-J(\\pi_{\\theta_{k}})\\approx\\mathcal{L}_{\\pi_{\\theta_{k}}}(\\pi)\\triangleq%\n\\frac{1}{1-\\gamma}\\operatorname*{\\mathbb{E}}_{s\\sim d^{\\pi_{\\theta_{k}}}}%\n\\operatorname*{\\mathbb{E}}_{a\\sim\\pi_{\\theta_{k}}(\\cdot|s)}\\left[\\frac{\\pi(a|s%\n)}{\\pi_{\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('2.1', '\\mathcal{L}_{\\pi_{\\theta_{k}}}(\\pi_{\\theta})')
('2.1', 'J(\\pi_{\\theta})-J(\\pi_{\\theta_{k}})')
('2.1', '\\theta')
('3', '\\eta(\\pi_{\\theta},\\pi_{\\theta_{k}})=\\bar{D}_{\\text{KL}}(\\pi_{\\theta}\\parallel%\n\\pi_{\\theta_{k}})')
('3', '\\theta\\in\\Theta')
('3', 'J(\\pi_{\\theta})')
('3', '\\bar{D}_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})')
('3', '\\pi_{\\theta_{k}}')
('3', '\\theta')
('3', '\\theta^{*}')
('3', '\\theta^{*}')
('3', 'g_{k}')
('3', 'h_{k}')
('3', '\\theta_{k}')
('3', '\\bar{D}_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})\\leq\\delta')
('3', '\\pi_{\\theta_{k}}')
('3', '\\pi_{\\theta}')
('3', '\\pi_{\\theta_{k}}')
('3', '\\pi_{\\theta}(a_{t}|s_{t})')
('3', '(1+\\epsilon)\\pi_{\\theta_{k}}(a_{t}|s_{t})')
('3', '(1-\\epsilon)\\pi_{\\theta_{k}}(a_{t}|s_{t})')
('4', '\\eta(\\pi,\\pi_{\\theta_{k}})\\leq\\delta')
('4', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad\\mathcal{L}_{\\pi_{%\n\\theta_{k}}}(\\pi)')
('4', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad')
('4', '\\displaystyle\\mathcal{L}_{\\pi_{\\theta_{k}}}(\\pi)')
('4', '\\displaystyle\\text{subject to}\\eta(\\pi,\\pi_{\\theta_{k}})\\leq\\delta')
('4', '\\displaystyle\\eta(\\pi,\\pi_{\\theta_{k}})\\leq\\delta')
('4', '\\pi')
('4', '\\Pi_{DL}')
('4', '\\pi^{*}')
('4', '\\eta(\\pi,\\pi_{\\theta_{k}})\\leq\\delta')
('4', '\\pi_{\\theta}')
('4', '\\Pi_{DL}')
('4', '\\pi^{*}')
('4', '\\theta_{k}')
('4', '\\theta_{k+1}')
('4', 'N')
('4', '\\pi_{\\theta_{k}}')
('4', '(s_{i},a_{i},A_{i})')
('4', 'i=1,..,m')
('4', 'A_{i}')
('4', 'A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})')
('4', 'i')
('4', '(i,t)')
('4', 't')
('4', 'i')
('4', 's_{i}')
('4', '\\pi^{*}')
('4', '\\eta')
('4', '\\pi_{\\theta}')
('4', '\\pi^{*}(\\cdot|s_{i})')
('4', 'i=1,..,m')
('4', '\\theta_{k+1}')
('4', 'L(\\theta)=\\frac{1}{N}\\sum_{i=1}^{m}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi^{*})%\n[s_{i}]')
('4', '\\pi_{\\theta_{k}}')
('4', 'L(\\theta)')
('4', '\\theta')
('4', '\\theta_{k+1}')
('5.1', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad\\sum_{s}d^{\\pi_{\\theta_%\n{k}}}(s)\\operatorname*{\\mathbb{E}}_{a\\sim\\pi(\\cdot|s)}\\left[A^{\\pi_{\\theta_{k}%\n}}(s,a)\\right]')
('5.1', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad')
('5.1', '\\displaystyle\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)\\operatorname*{\\mathbb{E}}_{a\\sim%\n\\pi(\\cdot|s)}\\left[A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('5.1', '\\displaystyle\\text{subject to}\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\pi%\n\\parallel\\pi_{\\theta_{k}})[s]\\leq\\delta')
('5.1', '\\displaystyle\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\pi\\parallel\\pi_{%\n\\theta_{k}})[s]\\leq\\delta')
('5.1', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('5.1', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('5.1', '\\mathcal{L}_{\\pi_{\\theta_{k}}}(\\pi)')
('5.1', '\\pi')
('5.1', '\\pi_{\\theta_{k}}')
('5.1', '\\lambda>0')
('5.1', '\\pi^{\\lambda}(a|s)=\\dfrac{\\pi_{\\theta_{k}}(a|s)}{Z_{\\lambda}(s)}e^{A^{\\pi_{%\n\\theta_{k}}}(s,a)/\\lambda}')
('5.1', 'Z_{\\lambda}(s)')
('5.1', '\\pi^{\\lambda}(a|s)')
('5.1', '\\lambda')
('5.1', '\\lambda_{s}')
('5.1', 'D_{\\text{KL}}(\\pi^{\\lambda_{s}}\\parallel\\pi_{\\theta_{k}})[s]=\\epsilon')
('5.1', '{\\Gamma}^{\\lambda}=\\{s:D_{\\text{KL}}(\\pi^{\\lambda}\\parallel\\pi_{\\theta_{k}})[s%\n]\\leq\\epsilon\\}')
('5.1', '\\tilde{\\pi}^{\\lambda}(a|s)=\\begin{cases}\\pi^{\\lambda}(a|s)\\quad\\quad s\\in{%\n\\Gamma}^{\\lambda}\\\\\n\\pi^{\\lambda_{s}}(a|s)\\quad\\quad s\\notin{\\Gamma}^{\\lambda}\\\\\n\\end{cases}')
('5.1', '\\lambda')
('5.1', '\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\tilde{\\pi}^{\\lambda}\\parallel\\pi%\n_{\\theta_{k}})[s]=\\delta')
('5.1', '\\pi_{\\theta}')
('5.1', '\\tilde{\\pi}^{\\lambda}(a|s)')
('5.1', 's_{i}')
('5.1', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\tilde{\\pi}^{%\n\\lambda})[s_{i}]=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta%\n_{k}})[s_{i}]-\\dfrac{1}{\\tilde{\\lambda}_{s_{i}}}\\operatorname*{\\mathbb{E}}_{a%\n\\sim\\pi_{\\theta_{k}}(\\cdot|s_{i})}[\\nabla_{\\theta}\\log\\pi_{\\theta}(a|s_{i})A^{%\n\\pi_{\\theta_{k}}}(s_{i},a)]')
('5.1', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\tilde{\\pi}^{%\n\\lambda})[s_{i}]=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta%\n_{k}})[s_{i}]-\\dfrac{1}{\\tilde{\\lambda}_{s_{i}}}\\operatorname*{\\mathbb{E}}_{a%\n\\sim\\pi_{\\theta_{k}}(\\cdot|s_{i})}[\\nabla_{\\theta}\\log\\pi_{\\theta}(a|s_{i})A^{%\n\\pi_{\\theta_{k}}}(s_{i},a)]')
('5.1', '\\overset{\\sim}{\\lambda}_{s_{i}}=\\lambda')
('5.1', 's_{i}\\in{\\Gamma}^{\\lambda}')
('5.1', '\\tilde{\\lambda}_{s_{i}}=\\lambda_{s_{i}}')
('5.1', 's_{i}\\notin{\\Gamma}^{\\lambda}')
('5.1', 'a_{i}')
('5.1', 'A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})')
('5.1', 'A_{i}')
('5.1', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\tilde{\\pi}^{%\n\\lambda})[s_{i}]\\approx\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{%\n\\theta_{k}})[s_{i}]-\\dfrac{1}{\\overset{\\sim}{\\lambda}_{s_{i}}}\\dfrac{\\nabla_{%\n\\theta}\\pi_{\\theta}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}A_{i}')
('5.1', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\tilde{\\pi}^{%\n\\lambda})[s_{i}]\\approx\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{%\n\\theta_{k}})[s_{i}]-\\dfrac{1}{\\overset{\\sim}{\\lambda}_{s_{i}}}\\dfrac{\\nabla_{%\n\\theta}\\pi_{\\theta}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}A_{i}')
('5.1', '\\delta')
('5.1', '\\lambda')
('5.1', '\\lambda')
('5.1', '\\delta')
('5.1', '\\overset{\\sim}{\\lambda}_{s_{i}}=\\lambda')
('5.1', 's_{i}')
('5.1', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\tilde{\\pi}^{%\n\\lambda})\\approx\\dfrac{1}{m}\\sum_{i=1}^{m}[\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{%\n\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]-\\dfrac{1}{\\lambda}\\dfrac{\\nabla_{%\n\\theta}\\pi_{\\theta}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}A_{i}]\\mathbbm%\n{1}_{D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]\\leq\\epsilon}')
('5.1', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\tilde{\\pi}^{%\n\\lambda})\\approx\\dfrac{1}{m}\\sum_{i=1}^{m}[\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{%\n\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]-\\dfrac{1}{\\lambda}\\dfrac{\\nabla_{%\n\\theta}\\pi_{\\theta}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}A_{i}]\\mathbbm%\n{1}_{D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]\\leq\\epsilon}')
('5.1', '\\pi_{\\theta}')
('5.1', '\\dfrac{1}{\\lambda}\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a_{i}|s_{i})}{\\pi_{\\theta%\n_{k}}(a_{i}|s_{i})}A_{i}')
('5.1', '\\pi_{\\theta}')
('5.1', '\\pi_{\\theta_{k}}')
('5.1', '\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]')
('5.1', '\\dfrac{1}{m}\\sum_{i}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}%\n]\\approx\\delta')
('5.2', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad\\sum_{s}d^{\\pi_{\\theta_%\n{k}}}(s)\\operatorname*{\\mathbb{E}}_{a\\sim\\pi(\\cdot|s)}\\left[A^{\\pi_{\\theta_{k}%\n}}(s,a)\\right]')
('5.2', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad')
('5.2', '\\displaystyle\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)\\operatorname*{\\mathbb{E}}_{a\\sim%\n\\pi(\\cdot|s)}\\left[A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('5.2', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('5.2', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('5.2', '\\pi^{*}(a|s)=\\pi_{\\theta_{k}}(a|s)\\frac{\\lambda(s)}{\\lambda^{\\prime}(s)-A^{\\pi%\n_{\\theta_{k}}}(s,a)}')
('5.2', '\\lambda(s)>0')
('5.2', '\\lambda^{\\prime}(s)>\\max_{a}A^{\\pi_{\\theta_{k}}}(s,a)')
('5.2', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi^{*})[s]=%\n\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s]-%\n\\underset{a\\sim\\pi_{\\theta_{k}}}{E}\\left[\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|%\ns)}{\\pi_{\\theta_{k}}(a|s)}\\log\\left(\\dfrac{1}{\\lambda^{\\prime}(s)-A^{\\pi_{%\n\\theta_{k}}}(s,a)}\\right)\\right]')
('5.2', '\\displaystyle\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi^{*})[s]')
('5.2', '\\displaystyle=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k%\n}})[s]-\\underset{a\\sim\\pi_{\\theta_{k}}}{E}\\left[\\dfrac{\\nabla_{\\theta}\\pi_{%\n\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log\\left(\\dfrac{1}{\\lambda^{\\prime}(s)-A^%\n{\\pi_{\\theta_{k}}}(s,a)}\\right)\\right]')
('5.2', 'a')
('5.2', 'A^{\\pi_{\\theta_{k}}}(s,a)>\\lambda^{\\prime}(s)-1')
('5.2', 'a')
('5.2', 'A^{\\pi_{\\theta_{k}}}(s,a)<\\lambda^{\\prime}(s)-1')
('5.2', '\\pi_{\\theta}')
('5.2', '\\pi_{\\theta_{k}}')
('5.3', 'L^{\\infty}')
('5.3', '\\pi_{\\theta}(a_{i}|s_{i})')
('5.3', '(1+\\epsilon)\\pi_{\\theta_{k}}(a_{i}|s_{i})')
('5.3', '(1-\\epsilon)\\pi_{\\theta_{k}}(a_{i}|s_{i})')
('5.3', 'i=1,\\ldots,m')
('5.3', '\\eta(\\pi,\\pi_{\\theta_{k}})=\\underset{i=1,\\ldots,m}{\\text{max}}\\frac{|\\pi(a_{i}%\n|s_{i})-\\pi_{\\theta_{k}}(a_{i}|s_{i})|}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}')
('5.3', '\\displaystyle\\underset{\\pi(a_{1}|s_{1}),\\dots,\\pi(a_{m}|s_{m})}{\\text{maximize%\n}}\\quad\\sum_{i=1}^{m}A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_{i})}{%\n\\pi_{k}(a_{i}|s_{i})}')
('5.3', '\\displaystyle\\underset{\\pi(a_{1}|s_{1}),\\dots,\\pi(a_{m}|s_{m})}{\\text{maximize%\n}}\\quad')
('5.3', '\\displaystyle\\sum_{i=1}^{m}A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_%\n{i})}{\\pi_{k}(a_{i}|s_{i})}')
('5.3', '\\displaystyle\\text{subject to}\\left|\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_%\n{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right|\\leq\\epsilon\\quad i=1,\\dots,m')
('5.3', '\\displaystyle\\left|\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}|s_{i})}{\\pi_{%\n\\theta_{k}}(a_{i}|s_{i})}\\right|\\leq\\epsilon\\quad i=1,\\dots,m')
('5.3', '\\displaystyle\\sum_{i=1}^{m}\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}%\n|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}\\leq\\delta')
('5.3', '\\displaystyle\\sum_{i=1}^{m}\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}%\n|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}\\leq\\delta')
('5.3', '\\pi_{\\theta_{k}}')
('5.3', '\\displaystyle\\pi^{*}(a_{i}|s_{i})=\\begin{cases}\\pi_{\\theta_{k}}(a_{i}|s_{i})%\n\\min\\{1+\\lambda A_{i},1+\\epsilon\\}\\quad A_{i}\\geq 0\\\\\n\\pi_{\\theta_{k}}(a_{i}|s_{i})\\max\\{1+\\lambda A_{i},1-\\epsilon\\}\\quad A_{i}<0\\\\\n\\end{cases}')
('5.3', '\\displaystyle\\pi^{*}(a_{i}|s_{i})=\\begin{cases}\\pi_{\\theta_{k}}(a_{i}|s_{i})%\n\\min\\{1+\\lambda A_{i},1+\\epsilon\\}\\quad A_{i}\\geq 0\\\\\n\\pi_{\\theta_{k}}(a_{i}|s_{i})\\max\\{1+\\lambda A_{i},1-\\epsilon\\}\\quad A_{i}<0\\\\\n\\end{cases}')
('5.3', '\\lambda>0')
('5.3', 'A_{i}\\triangleq A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})')
('5.3', '\\lambda')
('5.3', '\\delta')
('5.3', '\\pi^{*}')
('5.3', '\\pi_{\\theta}')
('5.3', '\\pi^{*}')
('5.3', '\\theta')
('5.3', '\\nabla_{\\theta}\\sum_{i}(\\pi_{\\theta}(a_{i}|s_{i})-\\pi^{*}(a_{i}|s_{i}))^{2}')
('5.3', 'L^{\\infty}')
('6.1', 'L^{\\infty}')
('6.1', '6\\%')
('6.1', '27\\%')
('6.1', '17\\%')
('6.1', '28\\%')
('6.2', '\\sum_{i}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]')
('6.2', '\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]')
('6.2', '\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{i}]')
('6.3', '\\delta,\\epsilon,\\lambda')
('6.3', '75\\%')
('6.3', '50\\%')
('6.3', '18\\%')
('6.3', '21\\%')
('6.4', '9\\%')
('6.4', '\\boldsymbol{55\\%}')
('A1.1', '\\pi=\\{\\pi(a|s)')
('A1.1', 's\\in\\mathcal{S}')
('A1.1', 'a\\in\\mathcal{A}\\}')
('A1.1', '\\sum_{a\\in\\mathcal{A}}\\pi(a|s)\\log\\pi(a|s)-\\sum_{a\\in\\mathcal{A}}\\pi(a|s)\\log%\n\\pi_{\\theta_{k}}(a|s)')
('A1.1', '\\pi')
('A1.1', '\\pi_{\\theta_{k}}')
('A1.1', '\\lambda')
('A1.1', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad\\sum_{s}d^{\\pi_{\\theta_%\n{k}}}(s)\\{\\operatorname*{\\mathbb{E}}_{a\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_{k}}}(%\ns,a)]-\\lambda D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\}')
('A1.1', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad')
('A1.1', '\\displaystyle\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)\\{\\operatorname*{\\mathbb{E}}_{a%\n\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_{k}}}(s,a)]-\\lambda D_{\\text{KL}}(\\pi%\n\\parallel\\pi_{\\theta_{k}})[s]\\}')
('A1.1', '\\displaystyle\\text{subject to}D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]%\n\\leq\\epsilon\\mbox{ for all }s')
('A1.1', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('A1.1', 's')
('A1.1', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad\\operatorname*{%\n\\mathbb{E}}_{a\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_{k}}}(s,a)]-\\lambda D_{\\text{KL%\n}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]')
('A1.1', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad')
('A1.1', '\\displaystyle\\operatorname*{\\mathbb{E}}_{a\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_{k}%\n}}(s,a)]-\\lambda D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]')
('A1.1', '\\displaystyle\\text{subject to}D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon')
('A1.1', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon')
('A1.1', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad\\sum_{a=1}^{K}\\pi(a|%\ns)\\left[A^{\\pi_{\\theta_{k}}}(s,a)-\\lambda\\log\\left(\\frac{\\pi(a|s)}{\\pi_{\\theta%\n_{k}}(a|s)}\\right)\\right]')
('A1.1', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad')
('A1.1', '\\displaystyle\\sum_{a=1}^{K}\\pi(a|s)\\left[A^{\\pi_{\\theta_{k}}}(s,a)-\\lambda\\log%\n\\left(\\frac{\\pi(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\right)\\right]')
('A1.1', '\\displaystyle\\text{subject to}\\sum_{a=1}^{K}\\pi(a|s)=1')
('A1.1', '\\displaystyle\\sum_{a=1}^{K}\\pi(a|s)=1')
('A1.1', '\\displaystyle\\pi(a|s)\\geq 0,\\quad\\;a=1,\\dots,K')
('A1.1', '\\displaystyle\\pi(a|s)\\geq 0,\\quad\\;a=1,\\dots,K')
('A1.1', '\\pi^{\\lambda}(a|s)=\\dfrac{\\pi_{\\theta_{k}}(a|s)}{Z_{\\lambda}(s)}e^{A^{\\pi_{%\n\\theta_{k}}}(s,a)/\\lambda}')
('A1.1', 'Z_{\\lambda}(s)')
('A1.1', '\\pi^{\\lambda}(\\cdot|s)')
('A1.1', 'D_{\\text{KL}}(\\pi^{\\lambda}\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon')
('A1.1', '\\pi^{\\lambda}(a|s)')
('A1.1', 'D_{\\text{KL}}(\\pi^{\\lambda}\\parallel\\pi_{\\theta_{k}})[s]>\\epsilon')
('A1.1', '\\pi^{\\lambda}(a|s)')
('A1.1', '\\lambda')
('A1.1', '\\lambda_{s}')
('A1.1', '\\lambda_{s}')
('A1.1', 'D_{\\text{KL}}(\\pi^{\\lambda}\\parallel\\pi_{\\theta_{k}})[s]=\\epsilon')
('A1.1', '\\displaystyle\\tilde{\\pi}^{\\lambda}(a|s)=\\begin{cases}\\dfrac{\\pi_{\\theta_{k}}(a%\n|s)}{Z(s)}e^{A^{\\pi_{\\theta_{k}}}(s,a)/\\lambda}\\quad\\quad s\\in{\\Gamma}^{%\n\\lambda}\\\\\n\\dfrac{\\pi_{\\theta_{k}}(a|s)}{Z(s)}e^{A^{\\pi_{\\theta_{k}}}(s,a)/\\lambda_{s}}%\n\\quad\\quad s\\notin{\\Gamma}^{\\lambda}\\\\\n\\end{cases}')
('A1.1', '\\displaystyle\\tilde{\\pi}^{\\lambda}(a|s)=\\begin{cases}\\dfrac{\\pi_{\\theta_{k}}(a%\n|s)}{Z(s)}e^{A^{\\pi_{\\theta_{k}}}(s,a)/\\lambda}\\quad\\quad s\\in{\\Gamma}^{%\n\\lambda}\\\\\n\\dfrac{\\pi_{\\theta_{k}}(a|s)}{Z(s)}e^{A^{\\pi_{\\theta_{k}}}(s,a)/\\lambda_{s}}%\n\\quad\\quad s\\notin{\\Gamma}^{\\lambda}\\\\\n\\end{cases}')
('A1.1', '{\\Gamma}^{\\lambda}=\\{s:D_{\\text{KL}}(\\pi^{\\lambda}\\parallel\\pi_{\\theta_{k}})[s%\n]\\leq\\epsilon\\}')
('A1.1', '\\lambda')
('A1.1', '\\lambda')
('A1.1', '\\displaystyle\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\tilde{\\pi}^{\\lambda%\n}\\parallel\\pi_{\\theta_{k}})[s]=\\delta')
('A1.1', '\\displaystyle\\sum_{s}d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\tilde{\\pi}^{\\lambda%\n}\\parallel\\pi_{\\theta_{k}})[s]=\\delta')
('A1.1', '\\Box')
('A1.2', 's\\in\\mathcal{S}')
('A1.2', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad\\operatorname*{%\n\\mathbb{E}}_{a\\sim\\pi_{\\theta_{k}}(\\cdot|s)}\\left[\\dfrac{\\pi(a|s)}{\\pi_{\\theta%\n_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('A1.2', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad')
('A1.2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{a\\sim\\pi_{\\theta_{k}}(\\cdot|s)}\\left[%\n\\dfrac{\\pi(a|s)}{\\pi_{\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('A1.2', '\\displaystyle\\text{subject to}\\operatorname*{\\mathbb{E}}_{a\\sim\\pi_{\\theta_{k}%\n}(\\cdot|s)}\\left[\\log\\frac{\\pi_{\\theta_{k}}(a|s)}{\\pi(a|s)}\\right]\\leq\\epsilon')
('A1.2', '\\displaystyle\\operatorname*{\\mathbb{E}}_{a\\sim\\pi_{\\theta_{k}}(\\cdot|s)}\\left[%\n\\log\\frac{\\pi_{\\theta_{k}}(a|s)}{\\pi(a|s)}\\right]\\leq\\epsilon')
('A1.2', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad\\sum_{a=1}^{K}A^{\\pi%\n_{\\theta_{k}}}(s,a)\\pi(a|s)')
('A1.2', '\\displaystyle\\underset{\\pi(\\cdot|s)}{\\text{maximize}}\\quad')
('A1.2', '\\displaystyle\\sum_{a=1}^{K}A^{\\pi_{\\theta_{k}}}(s,a)\\pi(a|s)')
('A1.2', '\\displaystyle\\text{subject to}-\\sum_{a=1}^{K}\\pi_{\\theta_{k}}(a|s)\\log\\pi(a|s)%\n\\leq\\epsilon^{\\prime}')
('A1.2', '\\displaystyle-\\sum_{a=1}^{K}\\pi_{\\theta_{k}}(a|s)\\log\\pi(a|s)\\leq\\epsilon^{\\prime}')
('A1.2', '\\displaystyle\\sum_{a=1}^{K}\\pi(a|s)=1')
('A1.2', '\\displaystyle\\sum_{a=1}^{K}\\pi(a|s)=1')
('A1.2', '\\displaystyle\\pi(a|s)\\geq 0,\\quad\\;a=1,\\dots,K')
('A1.2', '\\displaystyle\\pi(a|s)\\geq 0,\\quad\\;a=1,\\dots,K')
('A1.2', '\\epsilon^{\\prime}=\\epsilon+entropy(\\pi_{\\theta_{k}})')
('A1.2', '\\displaystyle\\pi^{*}(a|s)=\\pi_{\\theta_{k}}(a|s)\\frac{\\lambda(s)}{\\lambda^{%\n\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}')
('A1.2', '\\displaystyle\\pi^{*}(a|s)=\\pi_{\\theta_{k}}(a|s)\\frac{\\lambda(s)}{\\lambda^{%\n\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}')
('A1.2', '\\lambda(s)')
('A1.2', '\\lambda^{\\prime}(s)')
('A1.2', '\\lambda(s)>0')
('A1.2', '\\lambda^{\\prime}(s)>\\max_{a}A^{\\pi_{\\theta_{k}}}(s,a)')
('A1.2', '\\Box')
('A1.3', 'L^{\\infty}')
('A1.3', '\\displaystyle\\underset{\\pi(a_{1}|s_{1}),\\dots,\\pi(a_{m}|s_{m})}{\\text{maximize%\n}}\\quad\\sum_{i=1}^{m}A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_{i})}{%\n\\pi_{k}(a_{i}|s_{i})}')
('A1.3', '\\displaystyle\\underset{\\pi(a_{1}|s_{1}),\\dots,\\pi(a_{m}|s_{m})}{\\text{maximize%\n}}\\quad')
('A1.3', '\\displaystyle\\sum_{i=1}^{m}A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_%\n{i})}{\\pi_{k}(a_{i}|s_{i})}')
('A1.3', '\\displaystyle\\text{subject to}1-\\epsilon\\leq\\dfrac{\\pi(a_{i}|s_{i})}{\\pi_{%\n\\theta_{k}}(a_{i}|s_{i})}\\leq 1+\\epsilon\\quad i=1,\\dots,m')
('A1.3', '\\displaystyle 1-\\epsilon\\leq\\dfrac{\\pi(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_%\n{i})}\\leq 1+\\epsilon\\quad i=1,\\dots,m')
('A1.3', '\\displaystyle\\sum_{i=1}^{m}\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}%\n|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}\\leq\\delta')
('A1.3', '\\displaystyle\\sum_{i=1}^{m}\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}%\n|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}\\leq\\delta')
('A1.3', '\\pi_{\\theta_{k}}(a_{i}|s_{i}),i=1,\\ldots,m')
('A1.3', '\\lambda')
('A1.3', '\\displaystyle\\underset{\\pi(a_{1}|s_{1}),\\dots,\\pi(a_{m}|s_{m})}{\\text{maximize%\n}}\\quad\\sum_{i=1}^{m}\\left[A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_%\n{i})}{\\pi_{k}(a_{i}|s_{i})}-\\lambda\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k%\n}}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}\\right]')
('A1.3', '\\displaystyle\\underset{\\pi(a_{1}|s_{1}),\\dots,\\pi(a_{m}|s_{m})}{\\text{maximize%\n}}\\quad')
('A1.3', '\\displaystyle\\sum_{i=1}^{m}\\left[A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_%\n{i}|s_{i})}{\\pi_{k}(a_{i}|s_{i})}-\\lambda\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{%\n\\theta_{k}}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}\\right]')
('A1.3', '\\displaystyle\\text{subject to}1-\\epsilon\\leq\\dfrac{\\pi(a_{i}|s_{i})}{\\pi_{%\n\\theta_{k}}(a_{i}|s_{i})}\\leq 1+\\epsilon\\quad i=1,\\dots,m')
('A1.3', '\\displaystyle 1-\\epsilon\\leq\\dfrac{\\pi(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_%\n{i})}\\leq 1+\\epsilon\\quad i=1,\\dots,m')
('A1.3', 's_{i}')
('A1.3', '\\displaystyle\\underset{\\pi(a_{i}|s_{i})}{\\text{maximize}}\\quad A^{\\pi_{\\theta_%\n{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_{i})}{\\pi_{k}(a_{i}|s_{i})}-\\lambda\\left(%\n\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s%\n_{i})}\\right)^{2}')
('A1.3', '\\displaystyle\\underset{\\pi(a_{i}|s_{i})}{\\text{maximize}}\\quad')
('A1.3', '\\displaystyle A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\frac{\\pi(a_{i}|s_{i})}{\\pi_{k}%\n(a_{i}|s_{i})}-\\lambda\\left(\\frac{\\pi(a_{i}|s_{i})-\\pi_{\\theta_{k}}(a_{i}|s_{i%\n})}{\\pi_{\\theta_{k}}(a_{i}|s_{i})}\\right)^{2}')
('A1.3', '\\displaystyle\\text{subject to}1-\\epsilon\\leq\\dfrac{\\pi(a_{i}|s_{i})}{\\pi_{%\n\\theta_{k}}(a_{i}|s_{i})}\\leq 1+\\epsilon')
('A1.3', '\\displaystyle 1-\\epsilon\\leq\\dfrac{\\pi(a_{i}|s_{i})}{\\pi_{\\theta_{k}}(a_{i}|s_%\n{i})}\\leq 1+\\epsilon')
('A1.3', '\\pi^{*}(a_{i}|s_{i})=\\pi_{\\theta_{k}}(a_{i}|s_{i})\\left(1+\\dfrac{A^{\\pi_{%\n\\theta_{k}}}(s_{i},a_{i})}{2\\lambda}\\right)')
('A1.3', 'A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})\\geq 0')
('A1.3', '\\pi^{*}(a_{i}|s_{i})>\\pi_{\\theta_{k}}(a_{i}|s_{i})(1+\\epsilon)')
('A1.3', '\\pi_{\\theta_{k}}(a_{i}|s_{i})(1+\\epsilon)')
('A1.3', 'A^{\\pi_{\\theta_{k}}}(s_{i},a_{i})<0')
('A1.3', '\\pi^{*}(a_{i}|s_{i})<\\pi_{\\theta_{k}}(a_{i}|s_{i})(1-\\epsilon)')
('A1.3', '\\pi_{\\theta_{k}}(a_{i}|s_{i})(1-\\epsilon)')
('A1.3', '\\lambda')
('A1.3', '\\lambda')
('A1.3', '\\Box')
('A1.3', 'CE')
('A2.1', '\\displaystyle CE(\\pi_{\\theta}||\\tilde{\\pi}^{\\tilde{\\lambda}_{s}})[s]')
('A2.1', '\\displaystyle CE(\\pi_{\\theta}||\\tilde{\\pi}^{\\tilde{\\lambda}_{s}})[s]')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\tilde{\\pi}^{\\tilde{\\lambda}_{s}}(%\na|s)\\text{(Expanding the definition of cross entropy)}')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\tilde{\\pi}^{\\tilde{\\lambda}_{s}}(%\na|s)\\text{(Expanding the definition of cross entropy)}')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\left(\\dfrac{\\pi_{\\theta_{k}}(a|s)%\n}{Z_{\\tilde{\\lambda}_{s}}(s)}e^{A^{\\pi_{\\theta_{k}}}(s,a)/\\tilde{\\lambda}_{s}}%\n\\right)\\text{(Expanding the definition of $\\tilde{\\pi}^{\\tilde{\\lambda}_{s}}$)}')
('A2.1', '\\tilde{\\pi}^{\\tilde{\\lambda}_{s}}')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\left(\\dfrac{\\pi_{\\theta_{k}}(a|s)%\n}{Z_{\\tilde{\\lambda}_{s}}(s)}e^{A^{\\pi_{\\theta_{k}}}(s,a)/\\tilde{\\lambda}_{s}}%\n\\right)\\text{(Expanding the definition of $\\tilde{\\pi}^{\\tilde{\\lambda}_{s}}$)}')
('A2.1', '\\tilde{\\pi}^{\\tilde{\\lambda}_{s}}')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\left(\\dfrac{\\pi_{\\theta_{k}}(a|s)%\n}{Z_{\\tilde{\\lambda}_{s}}(s)}\\right)-\\sum_{a}\\pi_{\\theta}(a|s)\\dfrac{A^{\\pi_{%\n\\theta_{k}}}(s,a)}{\\tilde{\\lambda}_{s}}\\text{(Log of product is sum of log)}')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\left(\\dfrac{\\pi_{\\theta_{k}}(a|s)%\n}{Z_{\\tilde{\\lambda}_{s}}(s)}\\right)-\\sum_{a}\\pi_{\\theta}(a|s)\\dfrac{A^{\\pi_{%\n\\theta_{k}}}(s,a)}{\\tilde{\\lambda}_{s}}\\text{(Log of product is sum of log)}')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\pi_{\\theta_{k}}(a|s)+\\sum_{a}\\pi_%\n{\\theta}(a|s)\\log Z_{\\tilde{\\lambda}_{s}}(s)-\\dfrac{1}{\\tilde{\\lambda}_{s}}%\n\\sum_{a}\\pi_{\\theta_{k}}(a|s)\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}A%\n^{\\pi_{\\theta_{k}}}(s,a)')
('A2.1', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\pi_{\\theta_{k}}(a|s)+\\sum_{a}\\pi_%\n{\\theta}(a|s)\\log Z_{\\tilde{\\lambda}_{s}}(s)-\\dfrac{1}{\\tilde{\\lambda}_{s}}%\n\\sum_{a}\\pi_{\\theta_{k}}(a|s)\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}A%\n^{\\pi_{\\theta_{k}}}(s,a)')
('A2.1', '\\displaystyle=CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]+\\log Z_{\\tilde{\\lambda}_{s%\n}}(s)-\\dfrac{1}{\\tilde{\\lambda}_{s}}\\underset{a\\sim\\pi_{\\theta_{k}}(.|s)}{E}%\n\\left[\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a%\n)\\right]')
('A2.1', '\\displaystyle=CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]+\\log Z_{\\tilde{\\lambda}_{s%\n}}(s)-\\dfrac{1}{\\tilde{\\lambda}_{s}}\\underset{a\\sim\\pi_{\\theta_{k}}(.|s)}{E}%\n\\left[\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a%\n)\\right]')
('A2.1', '\\displaystyle\\Rightarrow\\nabla_{\\theta}CE(\\pi_{\\theta}||\\tilde{\\pi}^{\\tilde{%\n\\lambda}_{s}})[s]=\\nabla_{\\theta}CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-\\dfrac{%\n1}{\\tilde{\\lambda}_{s}}\\underset{a\\sim\\pi_{\\theta_{k}}(.|s)}{E}\\left[\\dfrac{%\n\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s%\n,a)\\right]\\text{(Taking gradient on both sides)}')
('A2.1', '\\displaystyle\\Rightarrow\\nabla_{\\theta}CE(\\pi_{\\theta}||\\tilde{\\pi}^{\\tilde{%\n\\lambda}_{s}})[s]=\\nabla_{\\theta}CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-\\dfrac{%\n1}{\\tilde{\\lambda}_{s}}\\underset{a\\sim\\pi_{\\theta_{k}}(.|s)}{E}\\left[\\dfrac{%\n\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s%\n,a)\\right]\\text{(Taking gradient on both sides)}')
('A2.1', '\\displaystyle\\Rightarrow\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel%\n\\tilde{\\pi}^{\\tilde{\\lambda}_{s}})[s]=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta%\n}\\parallel\\pi_{\\theta_{k}})[s]-\\dfrac{1}{\\tilde{\\lambda}_{s}}\\underset{a\\sim%\n\\pi_{\\theta_{k}}(.|s)}{E}\\left[\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{%\n\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('A2.1', '\\displaystyle\\Rightarrow\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel%\n\\tilde{\\pi}^{\\tilde{\\lambda}_{s}})[s]=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta%\n}\\parallel\\pi_{\\theta_{k}})[s]-\\dfrac{1}{\\tilde{\\lambda}_{s}}\\underset{a\\sim%\n\\pi_{\\theta_{k}}(.|s)}{E}\\left[\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{%\n\\theta_{k}}(a|s)}A^{\\pi_{\\theta_{k}}}(s,a)\\right]')
('A2.2', '\\displaystyle CE(\\pi_{\\theta}||\\pi^{*})[s]')
('A2.2', '\\displaystyle CE(\\pi_{\\theta}||\\pi^{*})[s]')
('A2.2', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\pi^{*}(a|s)\\text{(Expanding the %\ndefinition of cross entropy)}')
('A2.2', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\pi^{*}(a|s)\\text{(Expanding the %\ndefinition of cross entropy)}')
('A2.2', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\left(\\pi_{\\theta_{k}}(a|s)\\frac{%\n\\lambda(s)}{\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right)\\text{(%\nExpanding the definition of $\\pi^{*}$)}')
('A2.2', '\\pi^{*}')
('A2.2', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\left(\\pi_{\\theta_{k}}(a|s)\\frac{%\n\\lambda(s)}{\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right)\\text{(%\nExpanding the definition of $\\pi^{*}$)}')
('A2.2', '\\pi^{*}')
('A2.2', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\pi_{\\theta_{k}}(a|s)-\\sum_{a}\\pi_%\n{\\theta}(a|s)\\log\\lambda(s)+\\sum_{a}\\pi_{\\theta}(a|s)\\log(\\lambda^{\\prime}(s)-%\nA^{\\pi_{\\theta_{k}}}(s,a))')
('A2.2', '\\displaystyle=-\\sum_{a}\\pi_{\\theta}(a|s)\\log\\pi_{\\theta_{k}}(a|s)-\\sum_{a}\\pi_%\n{\\theta}(a|s)\\log\\lambda(s)+\\sum_{a}\\pi_{\\theta}(a|s)\\log(\\lambda^{\\prime}(s)-%\nA^{\\pi_{\\theta_{k}}}(s,a))')
('A2.2', '\\displaystyle=CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-\\lambda(s)+E_{a\\sim\\pi_{%\n\\theta_{k}}}\\left[\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log(\\lambda%\n^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a))\\right]')
('A2.2', '\\displaystyle=CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-\\lambda(s)+E_{a\\sim\\pi_{%\n\\theta_{k}}}\\left[\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log(\\lambda%\n^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a))\\right]')
('A2.2', '\\displaystyle=CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-\\lambda(s)-E_{a\\sim\\pi_{%\n\\theta_{k}}}\\left[\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log\\dfrac{1%\n}{\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right]')
('A2.2', '\\displaystyle=CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-\\lambda(s)-E_{a\\sim\\pi_{%\n\\theta_{k}}}\\left[\\dfrac{\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log\\dfrac{1%\n}{\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right]')
('A2.2', '\\displaystyle\\Rightarrow\\nabla_{\\theta}CE(\\pi_{\\theta}||\\pi^{*})[s]=\\nabla_{%\n\\theta}CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-E_{a\\sim\\pi_{\\theta_{k}}}\\left[%\n\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log\\dfrac{1}{%\n\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right]\\text{(Taking gradient on%\n both sides)}')
('A2.2', '\\displaystyle\\Rightarrow\\nabla_{\\theta}CE(\\pi_{\\theta}||\\pi^{*})[s]=\\nabla_{%\n\\theta}CE(\\pi_{\\theta}||\\pi_{\\theta_{k}})[s]-E_{a\\sim\\pi_{\\theta_{k}}}\\left[%\n\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{\\theta_{k}}(a|s)}\\log\\dfrac{1}{%\n\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right]\\text{(Taking gradient on%\n both sides)}')
('A2.2', '\\displaystyle\\Rightarrow\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi^%\n{*})[s]=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s]%\n-E_{a\\sim\\pi_{\\theta_{k}}}\\left[\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{%\n\\theta_{k}}(a|s)}\\log\\dfrac{1}{\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right]')
('A2.2', '\\displaystyle\\Rightarrow\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi^%\n{*})[s]=\\nabla_{\\theta}D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s]%\n-E_{a\\sim\\pi_{\\theta_{k}}}\\left[\\dfrac{\\nabla_{\\theta}\\pi_{\\theta}(a|s)}{\\pi_{%\n\\theta_{k}}(a|s)}\\log\\dfrac{1}{\\lambda^{\\prime}(s)-A^{\\pi_{\\theta_{k}}}(s,a)}\\right]')
('A2.2', 'd^{\\pi}(s)')
('A2.2', 'P_{\\pi}(s_{t}=s)')
('A2.2', '\\frac{d}{ds}P_{\\pi}(s_{t}\\leq s)')
('A2.2', 'd^{\\pi}(s)')
('A2.2', '\\bar{D}_{\\text{KL}}(\\pi\\parallel\\pi_{k})')
('A2.2', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad\\int d^{\\pi_{\\theta_{k}%\n}}(s)\\operatorname*{\\mathbb{E}}_{a\\sim\\pi(\\cdot|s)}[A^{\\pi_{\\theta_{k}}}(s,a)]ds')
('A2.2', '\\displaystyle\\underset{\\pi\\in\\Pi}{\\text{maximize}}\\quad')
('A2.2', '\\displaystyle\\int d^{\\pi_{\\theta_{k}}}(s)\\operatorname*{\\mathbb{E}}_{a\\sim\\pi(%\n\\cdot|s)}[A^{\\pi_{\\theta_{k}}}(s,a)]ds')
('A2.2', '\\displaystyle\\text{subject to}\\int d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\pi%\n\\parallel\\pi_{\\theta_{k}})[s]ds\\leq\\delta')
('A2.2', '\\displaystyle\\int d^{\\pi_{\\theta_{k}}}(s)D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta%\n_{k}})[s]ds\\leq\\delta')
('A2.2', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('A2.2', '\\displaystyle D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s]\\leq\\epsilon\\mbox{%\n for all }s')
('A2.2', 's\\in\\mathcal{S}')
('A4.1', '-\\lambda')
('A4.1', '0.0003')
('A4.1', '64')
('A4.1', '\\gamma')
('A4.1', '\\lambda')
('A4.1', '0.99')
('A4.1', '0.95')
('A4.1', '\\delta,\\epsilon,\\lambda')
('A4.1', '0.05/1.2')
('A4.1', '0.05')
('A4.1', '1.3')
('A4.1', '30')
('A4.1', '\\delta,\\epsilon,\\lambda')
('A4.1', '[0.05,0.07],[0.01,0.07],[1.0,1.2]')
('A4.1', '[5,30]')
('A4.2', '0.0001')
('A4.2', 'process\\_seed=experiment\\_seed+10000*process\\_rank')
('A4.2', '\\delta,\\epsilon,\\lambda')
('A4.2', '0.02')
('A4.2', '\\delta/1.3')
('A4.2', '1.1')
('A4.2', '9')
('A4.2', '\\pi_{\\theta}')
('A4.2', 'V_{\\phi}')
('A4.2', 'V^{\\pi_{\\theta}}')
('A4.2', '\\gamma,\\beta')
('A4.2', '\\alpha')
('A4.2', '\\delta')
('A4.2', '\\epsilon')
('A4.2', '\\lambda')
('A4.2', '\\zeta')
('A4.2', '\\pi_{\\theta_{k}}')
('A4.2', '(s_{it},a_{it},r_{it},s_{i(t+1)}),\\quad i=1,\\ldots,N,t=1,\\ldots,T')
('A4.2', 'A_{it},\\quad i=1,\\ldots,N,t=1,\\dots,T')
('A4.2', '\\theta\\leftarrow\\theta_{k}')
('A4.2', '\\phi\\leftarrow\\phi_{k}')
('A4.2', '\\zeta')
('A4.2', '\\{s_{1},a_{1},A_{1},\\ldots,s_{M},a_{M},A_{M}\\}')
('A4.2', 'L(\\phi)=\\dfrac{1}{M}\\overset{}{\\underset{m}{\\sum}}(V^{targ}(s_{m})-V_{\\phi}(s_%\n{m}))^{2}')
('A4.2', '\\phi\\leftarrow\\phi-\\alpha\\nabla_{\\phi}L(\\phi)')
('A4.2', 'L(\\theta)=\\frac{1}{M}\\underset{m}{\\sum}\\left[\\nabla_{\\theta}D_{\\text{KL}}(\\pi_%\n{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{m}]-\\dfrac{1}{\\lambda}\\dfrac{\\nabla_{%\n\\theta}\\pi_{\\theta}(a_{m}|s_{m})}{\\pi_{\\theta_{k}}(a_{m}|s_{m})}A_{m}\\right]%\n\\mathbbm{1}_{D_{\\text{KL}}(\\pi_{\\theta}\\parallel\\pi_{\\theta_{k}})[s_{m}]\\leq\\epsilon}')
('A4.2', '\\theta\\leftarrow\\theta-\\alpha L(\\theta)')
('A4.2', '\\dfrac{1}{m}\\sum_{m}D_{\\text{KL}}(\\pi\\parallel\\pi_{\\theta_{k}})[s_{m}]>\\delta')
('A4.2', '\\theta_{k+1}\\leftarrow\\theta')
('A4.2', '\\phi_{k+1}\\leftarrow\\phi')
('A6.1', '28\\%')
