('3.0', '\\mathcal{S}')
('3.0', '\\mathcal{A}')
('3.0', '\\mathcal{O}')
('3.0', '\\mathcal{F}: \\mathcal{S}\\times\\mathcal{A}\\rightarrow\\mathcal{S}')
('3.0', '\\mathcal{R}: \\mathcal{S}\\times \\mathcal{A}\\rightarrow [0,1]')
('3.0', '_\\text{sys}')
('3.0', 'o_1\\in{\\mathcal{O}}')
('3.0', 't')
('3.0', '\\theta')
('3.0', 'o_t\\in{\\mathcal{O}}')
('3.0', 'a_t\\in{\\mathcal{A}}')
('3.0', '\\pi_\\theta(\\cdot|s_t)')
('3.0', 's_t=(')
('3.0', '_\\text{sys},o_1, a_1, \\cdots, a_{t-1}, o_{t})\\in{\\mathcal{S}}')
('3.0', 'r\\in[0,1]')
('3.0', '(')
('3.0', '_\\text{sys}, o_1, a_1, \\cdots, o_{n}, a_n)')
('3.0', 'r=1')
('3.0', '0')
('3.0', '_\\text{sys}')
('3.0', '\\pi_\\theta(a_n|o_1)')
('3.0', '\\begin{aligned}\n    \\pi_\\theta(a_n|o_1)=\\prod_{t=1}^n \\pi_\\theta(a_t|s_t). \\label{eq:MDP}\n\\end{aligned}')
('3.1', 't_e=(\\hat{o}_1, \\hat{a}_1, \\cdots, \\hat{o}_{n}, \\hat{a}_n)')
('3.1', '{\\mathcal{T}}')
('3.1', '\\pi_{\\theta_0}')
('3.1', '\\begin{aligned}\n    L_\\text{SFT}=-\\mathbb{E}_{t_e\\sim{\\mathcal{T}}}[\\pi_\\theta(\\hat{a}_n|\\hat{o}_1)]. \\label{eq:SFT}\n\\end{aligned}')
('3.1', '\\pi_\\theta(\\hat{a}_n|\\hat{o}_1)=\\prod_{t=1}^n \\pi_\\theta(\\hat{a}_t|\\hat{s}_t)')
('3.1', '\\hat{s}_t=(\\hat{o}_1, \\hat{a}_1, ..., \\hat{o}_{t})')
('3.1', 't_e')
('3.1', 'w=(w_1, ..., w_l)')
('3.1', 'l')
('3.1', '\\pi_\\theta(\\hat{a}_n|\\hat{o}_1)')
('3.1', '\\begin{aligned}\n    \\pi_\\theta(\\hat{a}_n|\\hat{o}_1)=-\\sum_k \\log\\pi_\\theta(w_k|w_{<k}) \\times \\mathbf{1}_{w_k\\in {\\mathcal{A}}},\n\\end{aligned}')
('3.1', 'w_{<k}')
('3.1', 'k')
('3.1', '\\mathbf{1}_{w_k\\in {\\mathcal{A}}}')
('3.1', 'w_k')
('4.0', 't_e=(\\hat{o}_1')
('4.0', '\\hat{a}_1')
('4.0', '\\cdots')
('4.0', '\\hat{o}_{n}, \\hat{a}_n)')
('4.0', 'n')
('4.0', '\\begin{aligned}\n    (\\hat{o}_1, \\hat{a}_1, \\cdots, \\hat{o}_{i}, \\hat{a}_i)\\in{\\mathcal{T}}_\\text{sample},\\quad i=1, 2, \\cdots, n.\n\\end{aligned}')
('4.0', '{\\mathcal{T}}_\\text{sample}')
('4.0', '\\hat{s}_i=(\\hat{o}_1, \\hat{a}_1, \\cdots, \\hat{o}_{i})')
('4.0', '\\pi_{\\theta}')
('4.0', '\\theta')
('4.0', '(\\hat{o}_1, \\hat{a}_1, \\cdots, \\hat{o}_{i}, a^{\\theta}_i)\\in{\\mathcal{T}}^\\theta_\\text{sample}')
('4.0', '\\begin{aligned}\n    \\label{eq:atheta}\n    a^{\\theta}_i \\sim \\pi_\\theta(a|s).\n\\end{aligned}')
('4.1.0', '(t_\\text{sample}, t_{\\theta})')
('4.1.0', 't_\\text{sample}=(\\hat{o}_1')
('4.1.0', '\\hat{a}_1, \\cdots, \\hat{o}_{i}, \\hat{a}_i)')
('4.1.0', 't_{\\theta}=(\\hat{o}_1')
('4.1.0', '\\hat{a}_1, \\cdots, \\hat{o}_{i}, a^{\\theta}_i)')
('4.1.0', '\\begin{aligned}\n    L_\\text{implicit}(\\pi_\\theta, \\pi_e) = -\\mathbb{E}[\\log\\sigma(\\beta\\log\\frac{\\pi_\\theta(\\hat{a}_i|\\hat{s}_i)}{\\pi_e(\\hat{a}_i|\\hat{s}_i)}-\\beta\\log\\frac{\\pi_\\theta(a^{\\theta}_i|\\hat{s}_i)}{\\pi_e(a^{\\theta}_i|\\hat{s}_i)})],\n    \\label{eq:dpo}\n\\end{aligned}')
('4.1.0', '\\pi_\\theta')
('4.1.0', '\\pi_e')
('4.1.0', '\\pi_\\text{ref}')
('4.1.0', '\\beta')
('4.1.1', '\\rho_\\pi')
('4.1.1', '\\pi')
('4.1.1', '\\pi')
('4.1.1', '\\begin{aligned}\n    \\label{rhopi}\n    \\rho_\\pi(s,a)=(1-\\gamma)\\sum_{t=0}^\\infty \\gamma^t P_\\pi(s_t=s) \\pi(a|s),\n\\end{aligned}')
('4.1.1', '1-\\gamma')
('4.1.1', 'P_\\pi(s_t=s)')
('4.1.1', 's')
('4.1.1', 't')
('4.1.1', '\\pi')
('4.1.1', '\\rho_{\\pi_\\theta}')
('4.1.1', '\\rho_{\\pi_e}')
('4.1.1', '\\begin{aligned}\n    \\min_\\pi \\text{JS}(\\rho_{\\pi_\\theta}, \\rho_{\\pi_e})-\\lambda H(\\pi_\\theta),\n    \\label{eq:js}\n\\end{aligned}')
('4.1.1', '\\lambda')
('4.1.1', 'H(\\pi_\\theta)\\overset{\\triangle}{=}\\mathbb{E}_{\\pi_\\theta}[-\\log \\pi_\\theta(a|s)]')
('4.1.1', '\\gamma')
('4.1.1', '\\text{JS}(\\rho_{\\pi_\\theta}, \\rho_{\\pi_e})')
('4.1.1', '\\varpi(\\rho_{\\pi_\\theta}-\\rho_{\\pi_e})')
('4.1.1', '\\varpi: \\mathbb{R}^{{\\mathcal{S}}\\times{\\mathcal{A}}}\\to\\mathbb{R}\\cup\\{\\infty\\}')
('4.1.1', '\\begin{aligned}\n    \\varpi(c)\\triangleq\\left\\{\\begin{array}{ll}\n       \\mathbb{E}_{\\pi_e}[-c(s,a)-\\log(1-e^{c(s,a)})]  &  c<0; \\\\\n        +\\infty & c\\geq 0.\n    \\end{array} \\right.\n\\end{aligned}')
('4.1.1', '\\varpi(\\rho_{\\pi_\\theta}-\\rho_{\\pi_e})')
('4.1.1', '\\begin{aligned}\n    \\sup_{D\\in(0,1)^{\\mathcal{S}\\times\\mathcal{A}}} \\mathbb{E}_{\\pi_\\theta}[\\log(D(s,a))]\n    +\\mathbb{E}_{\\pi_e}[\\log(1-D(s,a))]. \\notag\n\\end{aligned}')
('4.1.1', '(\\pi, D)')
('4.1.1', '\\begin{aligned}\n    \\mathbb{E}_{\\pi_\\theta}[\\log(D(s,a))]+\\mathbb{E}_{\\pi_e}[\\log(1-D(s,a)]-\\lambda H({\\pi_\\theta}).\n    \\label{eq:discriminator}\n\\end{aligned}')
('4.1.1', 'D: {\\mathcal{S}}\\times{\\mathcal{A}}\\rightarrow(0,1)')
('4.1.1', 'D')
('4.1.1', '\\pi_\\theta')
('4.1.1', '\\pi_e')
('4.1.1', 'D')
('4.1.1', '\\rho_\\pi')
('4.1.1', '\\rho_{\\pi_e}')
('4.1.1', 'D')
('4.1.1', '(\\hat{o}_1, \\hat{a}_1, ..., \\hat{o}_{n-1}, \\hat{a}_{n})\\in{\\mathcal{T}}')
('4.1.1', '\\pi_{\\theta_0}')
('4.1.1', '\\pi_\\theta')
('4.1.1', '\\pi_{\\theta_1}\\leftarrow\\pi_{\\theta_0}')
('4.1.1', '(\\hat{o}_1, \\hat{a}_1, \\cdots,')
('4.1.1', '\\hat{o}_{t}, \\hat{a}_t)\\in{\\mathcal{T}}_\\text{sample}')
('4.1.1', '(\\hat{o}_1, \\hat{a}_1, \\cdots, \\hat{o}_t, a^{\\theta}_t)\\in{\\mathcal{T}}^\\theta_\\text{sample}')
('4.1.1', '\\pi_{\\theta_i}')
('4.1.1', '\\small\n        \\begin{aligned}\n            \\mathbb{E}_{\\pi_\\theta}[\\log(D_w(s,a))]+\\mathbb{E}_{\\pi_e}[\\log(1-D_w(s,a)]\n        \\end{aligned}')
('4.1.1', "D_w\\rightarrow D_{w'}")
('4.1.1', "\\log(D_{w'}(s,a))")
('4.1.1', "\\pi_{\\theta_i}\\rightarrow\\pi_{{\\theta_i}'}")
('5', '\\pi_\\theta')
('5', '\\rho_{\\pi_\\theta}')
('5', '\\rho_{\\pi_e}')
('5', '\\rho_{\\pi_\\theta}')
('5', '\\rho_{\\pi_e}')
('5', '\\text{KL/JS}(\\rho_{\\pi_\\theta},\\rho_{\\pi_e})')
('5', 'r(s,a)=\\beta \\log \\frac{\\pi_\\theta(a|s)}{\\pi_\\text{ref}(a|s)}+\\beta \\log Z(s),')
('5', 'Z(s)')
('5', 'p(a_1>a_2|s)=\\sigma(r(s,a_1)-r(s, a_2)).')
('5', 'J(\\theta) = -\\mathbb{E}_{(s,a) \\sim \\pi_\\theta} [\\log D(s,a)].')
('5', 'J(\\theta)')
('5', '\\nabla_\\theta J(\\theta) = \\mathbb{E}_{(s,a) \\sim \\pi_\\theta} \\left[ \\nabla_\\theta \\log \\pi_\\theta(a|s) R(s,a) \\right].')
('5', '\\nabla_\\theta J(\\theta) = \\mathbb{E}_{(s,a) \\sim \\pi_\\theta} \\left[ \\nabla_\\theta \\log \\pi_\\theta(a|s) D(s,a) \\right].')
('7.0', '_{\\text{7B}}')
('7.0', '_{\\text{8B}}')
('7.0', '\\times')
('7.0', '\\checkmark')
('7.0', '\\checkmark')
('7.0', '\\times')
('7.0', '\\checkmark')
('7.0', '\\checkmark')
('7.1', '_{\\text{8B}}')
('7.1', '\\xrightarrow{}')
('7.1', '\\xrightarrow{}')
('7.2', '_\\text{7B}')
('7.2', '_\\text{13B}')
('7.2', '_\\text{7B}')
('7.2', '_\\text{13B}')
('7.2', '_\\text{13B}')
