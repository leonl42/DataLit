('2', 'B')
('2', 'N')
('2', 'C')
('2', 'n')
('2', 'n')
('2', 'S_{i}')
('2', 'i')
('2', '\\mathbf{X}')
('2', 's_{i}')
('2', 'S_{i}')
('2', '\\mathbf{X}_{p,n}')
('2', 'n')
('2', '\\hat{s}')
('2', 'M')
('2.1', '\\mathrm{MHA}(x)=\\mathrm{Concat}(\\mathrm{head}_{1},\\dots,\\mathrm{head}_{H})%\n\\mathbf{W}^{O},\\quad\\mathrm{head}_{i}=\\mathrm{Att}(\\mathbf{Q}_{i},\\mathbf{K}_{%\ni},\\mathbf{V}_{i}),')
('2.1', '\\mathrm{Att}(\\mathbf{Q},\\mathbf{K},\\mathbf{V})=\\mathrm{softmax}\\left(\\frac{%\n\\mathbf{Q}\\mathbf{K}^{\\top}}{\\sqrt{d_{k}}}\\right)\\mathbf{V},\\quad x_{\\mathrm{%\nMHA}}=\\mathrm{LayerNorm}(x+\\mathrm{MHA}(x)),')
('2.1', '\\mathrm{Att}(\\cdot)')
('2.1', '\\mathbf{Q},\\mathbf{K},\\mathbf{V}')
('2.1', 'x_{\\mathrm{MHA}}')
('2.1', '\\mathrm{FFN}(x)=\\max(0,x\\mathbf{W}_{1}+\\mathbf{b}_{1})\\mathbf{W}_{2}+\\mathbf{b%\n}_{2},\\quad x_{\\mathrm{out}}=\\mathrm{LayerNorm}(x_{\\mathrm{MHA}}+\\mathrm{FFN}(%\nx_{\\mathrm{MHA}})),')
('2.1', '\\mathbf{W}_{1},\\mathbf{W}_{2},\\mathbf{b}_{1},\\mathbf{b}_{2}')
('2.1', '\\mathbf{X}\\in\\mathbb{R}^{[B,S_{1},S_{2},\\dots,S_{K},C]}')
('2.1', 'B')
('2.1', 'S_{1},S_{2},\\dots,S_{K}')
('2.1', 'K')
('2.1', 'C')
('2.1', '\\mathbf{X}_{\\mathrm{reshape}}=\\mathrm{Reshape}(\\mathbf{X},[B\\times\\prod_{j\\neq\ni%\n}S_{j},S_{i},C]).')
('2.1', 'i')
('2.1', '\\mathbf{X}_{\\mathrm{reshape}}')
('2.1', '\\mathbf{X}_{\\mathrm{out}}=\\mathrm{transformer\\_block}(\\mathbf{X}_{\\mathrm{%\nreshape}}).')
('2.1', 'N')
('2.1', '\\mathbf{X}_{\\mathrm{out}}')
('2.1', '\\mathbf{X}')
('3.2', '\\mathbf{X}\\in\\mathbb{R}^{[B,S_{1},S_{2},\\dots,S_{K},C]}')
('3.2', 'N')
('3.2', 'S_{1},\\dots,S_{K}')
('3.2', 'K')
('3.2', '\\mathbf{X}_{p,n}')
('3.2', '\\mathbf{X}')
('3.2', 'n')
('3.2', 'p')
('3.2', '\\min_{p}\\sum_{n=1}^{N}\\mathrm{CommCost}(\\mathbf{X}_{p,n})\\ \\ s.t.\\ \\ \\mathrm{%\nMemory}(\\mathbf{X}_{p,n})<Capacity.')
('3.2', '\\mathrm{Memory}(\\mathbf{X}{p,n})')
('3.2', '\\mathbf{X}_{p,n}')
('3.2', 'n')
('3.2', '\\mathrm{CommCost}(\\mathbf{X}_{p,n})')
('3.3', 's_{i}')
('3.3', 'i')
('3.3', '\\hat{s}')
('3.3', 'M')
('3.3', 'N')
('3.3', 's_{i}')
('3.3', 'i')
('3.3', '\\hat{s}')
('3.3', 'M')
('3.3', 'N')
('3.3', 's_{i}')
('3.3', 's_{i}')
('3.3', 's_{i}')
('3.3', 's_{j}')
('3.3', 'M/N')
('3.3', '\\hat{s}')
('3.3', 's_{i}')
('3.3', '0')
('3.3', 's_{i}')
('3.3', '\\hat{s}')
('3.3', 'M')
('3.3', '\\mathbf{X}\\in\\mathbb{R}^{[B,S_{1},\\dots,S_{i}/N,\\dots,S_{j},\\dots,S_{K},C]}')
('3.3', 'i')
('3.3', 'S_{i}/N')
('3.3', 'N')
('3.3', 'i')
('3.3', 'j')
('3.3', '\\mathbf{Y}=\\text{DynamicSwitch}(\\mathbf{X},i,j),')
('3.3', '\\mathbf{Y}')
('3.3', '\\mathbb{R}^{[B,S_{1},\\dots,S_{i},\\dots,S_{j}/N,\\dots,S_{K},C]}')
('4.1', 'M')
('4.1', 'N')
('4.1', '8M')
('4.1', 'M')
('4.1', 'N')
('4.1', '4M/N')
('4.1', '2M')
('4.1', '2M/N')
('4.1', 'M')
('4.1', 'N')
('4.1', 'M')
('4.1', 'N')
('4.1', '2M')
('4.1', '8M')
('4.1', '4M/N')
('4.1', '2M/N')
('A1.1', 't')
('A1.1', 's')
('A1.2', 'x')
('A1.2', '8M')
('A1.2', 'M')
('A1.2', 'N')
('A1.2', '4M/N')
('A1.2', '2M')
('A1.2', '2M/N')
('A1.4', 'shard')
('A1.4', 'shard')
('A1.4', 'dsp\\_dataloader')
('A1.4', 'split')
('A1.4', 'gather')
('A1.4', 'dynamic\\_switch')
('A1.4', 'dynamic\\_switch')
('A1.4', 'split')
('A1.4', 'gather')
('A1.4', 'dsp\\_dataloader')
