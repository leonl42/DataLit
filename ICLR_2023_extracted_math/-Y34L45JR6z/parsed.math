('2.1', 's')
('2.1', 'a')
('2.1', '\\pi(s)')
('2.1', '\\pi_{\\theta}(s)')
('2.1', '\\theta')
('2.1', 'Q(s,a)')
('2.1', 'Q(s,a)=r(s,a)+\\gamma\\mathbb{E}_{s^{\\prime}\\sim T(s,a),a^{\\prime}\\sim\\pi_{%\n\\theta}(s^{\\prime})}\\big{[}Q(s^{\\prime},a^{\\prime})\\big{]},')
('2.1', 'T(s,a)')
('2.1', 'r(s,a)')
('2.1', '\\gamma\\in(0,1)')
('2.1', 'Q(s,a)')
('2.1', 's')
('2.1', 'a')
('2.1', '\\pi_{\\theta}')
('2.1', '\\theta')
('2.1', '\\max_{\\theta}\\mathbb{E}_{s\\sim\\mathcal{D}}\\mathbb{E}_{a\\sim\\pi_{\\theta}}Q(s,a).')
('2.1', '\\mathcal{D}')
('2.1', 'Q(s,a)')
('2.1', 'Q_{\\phi}(s,a)')
('2.1', '\\phi')
('2.2', '\\mathcal{D}_{\\rm offline}=\\{(s_{i},a_{i})\\}')
('2.2', '(s_{i},a_{i})')
('2.2', '\\max_{\\theta}\\mathbb{E}_{(s,a)\\sim\\mathcal{D}_{\\rm offline}}\\log\\pi_{\\theta}(a%\n|s).')
('2.2', '\\max_{\\theta}\\mathbb{E}_{(s,a)\\sim\\mathcal{D}_{\\rm offline}}w(s,a)\\cdot\\log\\pi%\n_{\\theta}(a|s),')
('2.2', 'w(s,a)')
('4', '\\pi_{\\beta}')
('4', '\\pi_{\\theta}')
('4', '\\pi_{\\beta}')
('4', '\\pi_{\\theta}')
('4.1', '\\pi_{\\beta}')
('4.1', '\\pi_{\\beta}')
('4.1', '\\Pi=[\\pi_{\\beta}]')
('4.1', '\\pi_{\\beta}')
('4.1', '\\pi_{\\beta}')
('4.1', '\\Pi')
('4.1', '\\pi_{\\theta}')
('4.1', '\\Pi=[\\pi_{\\beta},\\pi_{\\theta}]')
('4.1', '\\pi_{\\beta}')
('4.1', '\\Pi')
('4.1', '\\Pi')
('4.1', '\\tilde{\\pi}')
('4.1', 's')
('4.1', '\\Pi')
('4.1', '\\mathbb{A}=\\{a_{i}\\!\\sim\\!\\pi_{i}(s)|\\pi_{i}\\in\\Pi\\}')
('4.1', '\\mathbf{Q}_{\\phi}\\!\\!=\\!\\![Q_{\\phi}(s,a_{i})|a_{i}\\in\\mathbb{A}]\\in\\mathbb{R}^%\n{K}')
('4.1', 'K')
('4.1', '\\Pi')
('4.1', 'K\\!=\\!2')
('4.1', 'P_{{\\mathbf{w}}}[i]=\\frac{\\exp(Q_{\\phi}(s,a_{i})/\\alpha)}{\\sum_{j}\\exp(Q_{\\phi%\n}(s,a_{j})/\\alpha)},\\quad\\forall i\\in[1,\\cdots K]')
('4.1', '\\alpha')
('4.1', '{\\mathbf{w}}')
('4.1', '{\\mathbf{w}}\\sim P_{{\\mathbf{w}}}')
('4.1', '\\tilde{\\pi}')
('4.1', '\\vspace{-0.08in}\\tilde{\\pi}(a|s)=[\\delta_{a\\sim\\pi_{\\beta}(s)},\\delta_{a\\sim%\n\\pi_{\\theta}(s)}]{\\mathbf{w}},\\quad{\\mathbf{w}}\\sim P_{{\\mathbf{w}}}\\vspace{-0%\n.055in}')
('4.1', '{\\mathbf{w}}\\!\\in\\!\\mathbb{R}^{K}')
('4.1', 's')
('4.1', '\\delta_{a\\sim\\pi}')
('4.1', 'a')
('4.1', '\\pi')
('4.1', '\\pi_{\\theta}')
('4.1', '\\pi_{\\beta}')
('4.1', '\\{L^{Q_{\\phi}}_{\\rm offline},L_{\\rm offline}^{\\pi_{\\beta}}\\}')
('4.1', '\\{L^{Q_{\\phi}}_{\\rm online},L_{\\rm online}^{\\pi_{\\theta}}\\}')
('4.1', '\\{L^{Q},L^{\\pi}\\}')
('4.1', '\\phi')
('4.1', '\\beta')
('4.1', '\\theta')
('4.1', '\\mathcal{D}_{\\rm offline}')
('4.1', '\\mathcal{D}_{\\rm offline}')
('4.1', '\\phi\\leftarrow\\phi-\\lambda_{Q}\\nabla_{\\phi}L^{Q}_{\\rm offline}(\\phi)')
('4.1', '\\beta\\leftarrow\\beta-\\lambda_{\\pi}\\nabla_{\\beta}L_{\\rm offline}^{\\pi_{\\beta}}(\\beta)')
('4.1', '\\tilde{\\pi}=[\\pi_{\\beta},\\pi_{\\theta}]')
('4.1', 'Q_{\\phi}')
('4.1', 'a_{t}\\sim\\tilde{\\pi}(a_{t}|s_{t})')
('4.1', 's_{t+1}\\sim T(s_{t+1}|s_{t},a_{t})')
('4.1', '\\mathcal{D}\\leftarrow\\mathcal{D}\\cup\\{(s_{t},a_{t},r(s_{t},a_{t}),s_{t+1})\\}')
('4.1', '\\mathcal{D}_{\\rm offline}')
('4.1', '\\mathcal{D}')
('4.1', '\\phi\\leftarrow\\phi-\\lambda_{Q}\\nabla_{\\phi}L^{Q}_{\\rm online}(\\phi)')
('4.1', '\\theta\\leftarrow\\theta-\\lambda_{\\pi}\\nabla_{\\theta}L_{\\rm online}^{\\pi_{\\theta%\n}}(\\theta)')
('4.2', '\\pi_{\\beta}')
('4.2', '\\mathcal{D}')
('4.2', '\\mathcal{D}')
('4.2', '\\mathcal{D}_{\\rm offline}')
('6.1', '\\mathcal{D}\\cup\\mathcal{D}_{\\rm offline}')
('6.3', '\\sim')
('6.3', '\\pi_{\\beta}')
('6.3', '\\pi_{\\beta}')
('6.3', '\\pi_{\\theta}')
('6.4', '\\Pi\\!=\\!\\{\\pi_{\\beta},\\pi_{\\theta}\\}')
('6.4', 'P_{{\\mathbf{w}}}')
('6.4', '\\pi_{\\beta}')
('6.4', '\\pi_{\\theta}')
('6.4', '\\pi_{\\beta}')
('6.4', '\\pi_{\\theta}')
('6.4', '\\pi_{\\theta}')
('6.4', '\\pi_{\\theta}')
('A1.1', 'a=2')
('A1.1', '[0,1]')
('A1.1', '\\epsilon')
('A1.1', '\\epsilon=0.1')
('A1.1', '\\pi_{\\beta}')
('A1.1', '\\pi_{\\theta}')
('A1.1', '\\pi_{\\beta}')
('A1.1', '5')
('A1.2', '\\pi_{\\beta}')
('A1.2', 'L_{Q}(\\phi)=\\mathbb{E}_{(s,a,r,s^{\\prime})\\sim\\mathcal{D}_{\\rm offline}}\\|Q_{%\n\\phi}(s,a)-(r+\\gamma V(s^{\\prime}))\\|^{2}')
('A1.2', 'L_{V}(\\psi)=\\mathbb{E}_{(s,a)\\sim\\mathcal{D}_{\\rm offline}}L_{2}^{\\tau}[Q_{%\n\\bar{\\phi}}(s,a)-V_{\\psi}(s)]')
('A1.2', 'L_{2}^{\\tau}(u)=|\\tau-\\mathbbm{1}(u<0)|u^{2}')
('A1.2', '\\tau')
('A1.2', '\\bar{\\phi}')
('A1.2', '{\\phi}')
('A1.2', '\\pi_{\\theta}')
('A1.2', 'L_{\\pi}(\\beta)=\\mathbb{E}_{(s,a)\\sim\\mathcal{D}_{\\rm offline}}-\\lfloor w(s,a)%\n\\rfloor\\cdot\\log\\pi_{\\beta}(a|s),')
('A1.2', 'w(s,a)=\\exp((Q(s,a)-V(s))/\\alpha)')
('A1.2', '\\lfloor\\cdot\\rfloor')
('A1.2', '\\mathcal{D}')
('A1.2', '\\mathcal{D}')
('A1.2', '\\mathcal{D}_{\\rm offline}')
('A1.2', '\\pi_{\\theta}')
('A1.2', 'L_{\\pi}(\\theta)=\\mathbb{E}_{s\\sim\\mathcal{D}_{\\rm offline}\\cup\\mathcal{D},a%\n\\sim\\tilde{\\pi}(s)}-\\lfloor w(s,a)\\rfloor\\cdot\\log\\pi_{\\theta}(a|s),')
('A1.2', 'a_{0}\\sim\\pi_{\\beta}(s_{t})')
('A1.2', '\\mathbb{E}_{s\\sim\\mathcal{D}}\\mathbb{E}_{a\\sim\\pi_{\\theta}}\\left\\|\\lfloor\\frac%\n{\\partial Q(s,a)}{\\partial a}+a\\rfloor-a\\right\\|^{2}')
('A1.2', '\\mathbb{E}_{s\\sim\\mathcal{D}}\\mathbb{E}_{a\\sim\\pi_{\\theta}}-Q(s,a)')
('A1.2', '\\mathbb{E}_{s\\sim\\mathcal{D}}\\mathbb{E}_{a\\sim\\tilde{\\pi},a_{0}\\sim\\pi_{\\theta%\n}}\\left\\|\\lfloor\\frac{\\partial Q(s,a)}{\\partial a}+a\\rfloor-a_{0}\\right\\|^{2}')
('A1.3', 'P_{\\mathbf{w}}')
('A1.3', 'P_{{\\mathbf{w}}}[i]=\\frac{\\exp(Q_{\\phi}(s,a_{i})/\\alpha)}{\\sum_{j}\\exp(Q_{\\phi%\n}(s,a_{j})/\\alpha)},\\quad\\forall i\\in[1,\\cdots K],')
('A1.3', 'K')
('A1.3', 'K=2')
('A1.3', 'P_{\\mathbf{w}}')
('A1.3', 'a_{1}')
('A1.3', 'a_{2}')
('A1.3', '\\pi_{\\beta}')
('A1.3', '\\pi_{\\theta}')
('A1.3', 'a_{1}\\sim\\pi_{\\beta}')
('A1.3', 'a_{2}\\sim\\pi_{\\theta}')
('A1.3', 's')
('A1.3', 'P_{{\\mathbf{w}}}')
('A1.3', '\\tilde{\\pi}')
('A1.3', '{\\tilde{\\pi}(a|s)}=\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}(a_{2}|s)%\n\\sum_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\delta(a=a_{i})da_{1}da_{2}')
('A1.3', '\\displaystyle V(s)=\\int_{a}\\tilde{\\pi}(a|s)Q_{\\phi}(s,a)da\\text{(plug in the %\ndefinition of policy in Eqn.(\\ref{eq:policy_def}))}')
('A1.3', '\\displaystyle V(s)')
('A1.3', '\\displaystyle=')
('A1.3', '\\displaystyle\\int_{a}\\tilde{\\pi}(a|s)Q_{\\phi}(s,a)da')
('A1.3', '\\displaystyle=\\int_{a}\\left[\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}%\n(a_{2}|s)\\sum_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\delta(a=a_{i})da_{1}da_{2}%\n\\right]Q_{\\phi}(s,a)da')
('A1.3', '\\displaystyle=')
('A1.3', '\\displaystyle\\int_{a}\\left[\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}(%\na_{2}|s)\\sum_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\delta(a=a_{i})da_{1}da_{2}%\n\\right]Q_{\\phi}(s,a)da')
('A1.3', '\\displaystyle=\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}(a_{2}|s)\\sum_%\n{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\left[\\int_{a}\\delta(a=a_{i})Q_{\\phi}(s,a)da%\n\\right]da_{1}da_{2}')
('A1.3', '\\displaystyle=')
('A1.3', '\\displaystyle\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}(a_{2}|s)\\sum_{%\ni}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\left[\\int_{a}\\delta(a=a_{i})Q_{\\phi}(s,a)da%\n\\right]da_{1}da_{2}')
('A1.3', '\\displaystyle=\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}(a_{2}|s)\\sum_%\n{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})Q(s,a_{i})da_{1}da_{2}')
('A1.3', '\\displaystyle=')
('A1.3', '\\displaystyle\\int_{a_{1},a_{2}}\\pi_{\\beta}(a_{1}|s)\\pi_{\\theta}(a_{2}|s)\\sum_{%\ni}P_{\\mathbf{w}}(i|s,a_{1},a_{2})Q(s,a_{i})da_{1}da_{2}')
('A1.3', '\\displaystyle=\\mathbb{E}_{a_{1}\\sim\\pi_{\\beta},a_{2}\\sim\\pi_{\\theta}}\\left[%\n\\sum_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})Q_{\\phi}(s,a_{i})\\right]')
('A1.3', '\\displaystyle=')
('A1.3', '\\displaystyle\\mathbb{E}_{a_{1}\\sim\\pi_{\\beta},a_{2}\\sim\\pi_{\\theta}}\\left[\\sum%\n_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})Q_{\\phi}(s,a_{i})\\right]')
('A1.3', '\\displaystyle\\mathbb{E}_{a_{1}\\sim\\pi_{\\beta},a_{2}\\sim\\pi_{\\theta}}\\left[\\sum%\n_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\left(Q_{\\phi}(s,a_{i})-\\alpha\\log P_{%\n\\mathbf{w}}(i|s,a_{1},a_{2})\\right)\\right].')
('A1.3', '\\displaystyle\\mathbb{E}_{a_{1}\\sim\\pi_{\\beta},a_{2}\\sim\\pi_{\\theta}}\\left[\\sum%\n_{i}P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\left(Q_{\\phi}(s,a_{i})-\\alpha\\log P_{%\n\\mathbf{w}}(i|s,a_{1},a_{2})\\right)\\right].')
('A1.3', 'P_{\\mathbf{w}}')
('A1.3', '\\pi_{\\beta}')
('A1.3', '\\pi_{\\theta}')
('A1.3', 'P_{\\mathbf{w}}(i|s,a_{1},a_{2})\\propto\\exp(Q_{\\phi}(s,a_{i})/\\alpha),\\quad%\n\\forall i\\in[1,2].')
('A1.3', 'P_{\\mathbf{w}}(i|s,a_{1},a_{2})=\\frac{\\exp(Q_{\\phi}(s,a_{i})/\\alpha)}{\\sum_{j}%\n\\exp(Q_{\\phi}(s,a_{j})/\\alpha)},\\quad\\forall i\\in[1,2].')
('A1.4', '\\pi_{\\theta}(s)\\!=\\!g_{\\theta_{g}}\\!\\circ\\!f_{\\theta_{f}}(s)')
('A1.4', 'f_{\\theta_{f}}(s)')
('A1.4', 's')
('A1.4', 'g')
('A1.4', 'f_{\\theta_{f}}')
('A1.4', 'f_{\\theta_{f}}(s)\\!\\triangleq\\!f_{\\theta_{1}}(s)\\!+\\!f_{\\theta_{2}}(s).')
('A1.4', 'f_{\\theta_{1}}')
('A1.4', '\\theta')
('A1.6', '\\alpha')
('A1.6', '\\beta^{-1}')
('A1.6', '\\tau')
('A1.6', '\\tau')
('A1.6', '\\alpha^{-1}')
('A1.6', '-d')
('A1.6', 'd')
('A1.6', 'd')
('A1.7', '\\alpha')
('A1.7', '\\alpha')
('A1.7', 'P_{{\\mathbf{w}}}')
('A1.7', 'P_{{\\mathbf{w}}}[i]=\\frac{\\exp(\\alpha^{-1}Q_{\\phi}(s,a_{i}))}{\\sum_{j}\\exp(%\n\\alpha^{-1}Q_{\\phi}(s,a_{j}))},\\quad\\forall i\\in[1,\\cdots K].')
('A1.7', '\\alpha^{-1}\\!=\\!10')
('A1.7', '\\alpha^{-1}\\!=\\!3')
('A1.7', '\\beta')
('A1.7', '\\alpha^{-1}')
('A1.7', '0.5\\alpha^{-1}')
('A1.7', '1\\alpha^{-1}')
('A1.7', '2\\alpha^{-1}')
('A1.7', '\\alpha^{-1}')
('A1.7', '0.5\\alpha^{-1}')
('A1.7', '1\\alpha^{-1}')
('A1.7', '2\\alpha^{-1}')
('A1.7', '\\alpha^{-1}')
('A1.7', '0.5\\alpha^{-1}')
('A1.7', '1\\alpha^{-1}')
('A1.7', '2\\alpha^{-1}')
('A1.7', '\\pi_{\\theta}')
('A1.7', 'e_{\\rm target}\\triangleq-d')
('A1.7', 'd')
('A1.7', '-d')
('A1.7', '0.5e_{\\rm target}')
('A1.7', '1\\cdot e_{\\rm target}')
('A1.7', '2e_{\\rm target}')
('A1.7', '0.5e_{\\rm target}')
('A1.7', '1e_{\\rm target}')
('A1.7', '2e_{\\rm target}')
('A1.7', '0.5e_{\\rm target}')
('A1.7', '1e_{\\rm target}')
('A1.7', '2e_{\\rm target}')
('A1.9', '\\pi_{\\beta}')
('A1.9', 'L_{\\pi_{\\beta}}')
('A1.9', '\\pi_{\\beta}')
('A1.10', '\\pi_{\\beta}')
('A1.10', '\\pi_{\\theta}')
('A1.10', '\\pi_{\\beta}')
('A1.10', '\\pi_{\\theta}')
('A1.10', '\\pi_{\\beta}')
('A1.10', '\\pi_{\\theta}')
