('2', 'k')
('2', '\\mathbf{M}')
('2', '\\mathbf{m}_k^{\\mkern-1.5mu\\mathsf{T}}')
('2', 'd')
('2', '\\mathbf {I}_d')
('2', 'd')
('2.0', '\\mathbf{Q}')
('2.0', '\\mathbf{K}')
('2.0', '\\mathbf{V}')
('2.0', '\\mathbf X\\in \\mathbb R^{n\\times d}')
('2.0', '\\begin{gathered}\n    \\mathbf{Q} = \\mathbf{X}\\mathbf{W}_Q  ,\n \\mathbf{K} =\\mathbf{X}\\mathbf{W}_K,\n\\mathbf{V} =\\mathbf{X}\\mathbf{W}_V \\in \\mathbb{R}^{n\\times d}.\n\\end{gathered}')
('2.0', '\\mathbf{O}\\in \\mathbb R^{n\\times d}')
('2.0', '\\begin{aligned}\n\\mathbf{O}&= \\mathrm{Softmax}(\\mathbf{Q} \\mathbf{K}^{\\mkern-1.5mu\\mathsf{T}}/ \\sqrt{d}) \\mathbf{V}.\n\\end{aligned}')
('2.0', 'n')
('2.0', '\\phi: \\mathbb R^d\\to \\mathbb R^{\\bar d}')
('2.0', '\\begin{aligned}\n\\mathbf{O}&=\\mathbf \\Delta^{-1} \\phi(\\mathbf{Q}) [\\phi(\\mathbf{K})^{\\mkern-1.5mu\\mathsf{T}}\\mathbf V ],\\\\\n\\mathbf{\\Delta} &= \\mathrm{diag}(\\phi(\\mathbf{Q}) [\\phi(\\mathbf{K})^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf 1}_n]). \n\\end{aligned}')
('2.0', '\\phi(\\mathbf{K})^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{V} \\in \\mathbb R^{d\\times d}')
('2.0', 'O(nd^2)')
('2.0', 'O(n)')
('2.0', 'd\\ll n')
('2.1', '\\mathbf P\\in \\mathbb R^{n\\times d}')
('2.1', '\\begin{gathered}\n\\mathbf q_s =\\mathbf  W_Q(\\mathbf x_s +\\mathbf  p_s), \n\\mathbf k_s =\\mathbf W_K(\\mathbf x_s +\\mathbf  p_s),\\\\\n\\mathbf v_s =\\mathbf W_V(\\mathbf x_s +\\mathbf  p_s),\n\\end{gathered}')
('2.1', 's')
('2.1', '\\begin{aligned}\n\\mathbf e_{st}=\\mathbf x_s^{\\mkern-1.5mu\\mathsf{T}}\\mathbf W_Q^{\\mkern-1.5mu\\mathsf{T}}\\mathbf  W_K\\mathbf  x_t + f(\\mathbf x_s,\\mathbf  x_t, t- s),\n\\end{aligned}')
('2.1', 's, t')
('2.1', '\\mathbf e_{st}')
('2.1', '\\mathbf{Q}\\mathbf{K}^{\\mkern-1.5mu\\mathsf{T}}')
('3.0', '\\mathbf{q}_s')
('3.0', '\\mathbf{k}_s')
('3.0', 'f_{\\mathrm{rel}}:\\mathbb C^d \\times \\mathbb C^d \\to \\mathbb C')
('3.0', 'f_{\\mathrm{rel}}(\\mathbf{q}_s, \\mathbf{k}_t)= \\sum_{l=1}^m  ({\\mathbf{\\hat q}_s^{(l)}}){^{\\mathsf{H}}} \\mathbf{W}_{t-s}^{(l)} \\mathbf{\\hat k}_t^{(l)} ,\\label{eq:rel}')
('3.0', '\\mathsf{H}')
('3.0', 'm')
('3.0', '\\mathbf{\\hat q}_s^{(l)}\\in \\mathbb C^{d^{(l)}_1}, \\mathbf{\\hat k}_t^{(l)}\\in \\mathbb C^{ d^{(l)}_2 }, \\mathbf{W}_{t-s}^{(l)}\\in \\mathbb C^{d^{(l)}_1 \\times d^{(l)}_2}')
('3.0.0', 'f_{\\mathrm{rel}}(\\mathbf{q}_s, \\mathbf{k}_t)= \\mathbf{q}_s^{\\mathsf{H}}\\mathbf{k}_t + w_{t-s},')
('3.0.0', '\\begin{aligned}\nm&=2, \\\\\n\\mathbf{\\hat q}_s^{(1)}= \\mathbf{q}_s,\n\\mathbf{\\hat k}_t^{(1)}&=\\mathbf{k}_t,\n\\mathbf{W}_{t-s}^{(1)}=\\mathbf{I}_d,\\\\\n\\mathbf{\\hat q}_s^{(2)}=\\mathbf{I}_d,\\mathbf{\\hat k}_t^{(2)}&=\\mathbf{I}_d,\n\\mathbf{W}_{t-s}^{(2)}=w_{t-s} \\mathbf{I}_d.\n\\end{aligned}')
('3.0.0', 'f_{\\mathrm{rel}}(\\mathbf{q}_s, \\mathbf{k}_t)= \\mathbf{q}_s^{\\mathsf{H}}\\mathbf {W}_{t-s} \\mathbf{k}_t,')
('3.0.0', '\\begin{gathered}\nm=1, \\\\\n\\mathbf{\\hat q}_s^{(1)}= \\mathbf{q}_s,\n\\mathbf{\\hat k}_t^{(1)}=\\mathbf{k}_t,\n\\mathbf{W}_{t-s}^{(1)}=\\mathbf W_{t-s}.\n\\end{gathered}')
('3.0.1', '\\begin{gathered}\n\\hat d_1=\\sum_{l=1}^m d^{(l)}_1, \\hat d_2=\\sum_{l=1}^m d^{(l)}_2, \\\\\n\\hat {\\mathbf q}_s = \n\\left[\\begin{matrix}\n({\\hat {\\mathbf q}_s^{(1)}})^{\\mkern-1.5mu\\mathsf{T}},\\ldots,\n({\\hat{\\mathbf q}_s^{(m)}})^{\\mkern-1.5mu\\mathsf{T}}\n\\end{matrix}\\right]^{\\mkern-1.5mu\\mathsf{T}}\\in \\mathbb C^{\\hat d_1},\n\\hat {\\mathbf k}_t = \n\\left[\\begin{matrix}\n({\\hat {\\mathbf k}_t^{(1)}})^{\\mkern-1.5mu\\mathsf{T}},\\ldots,\n({\\hat{\\mathbf k}_t^{(m)}})^{\\mkern-1.5mu\\mathsf{T}}\n\\end{matrix}\\right]^{\\mkern-1.5mu\\mathsf{T}}\\in \\mathbb C^{\\hat d_2},\\\\\n\\hat {\\mathbf  W}_{t-s}= \\text{block-diag} \\{ {\\mathbf W}_{t-s}^{(1)}\\ldots , \n{\\mathbf  W}_{t-s}^{(m)}\\}\\in \\mathbb C^{\\hat d_1 \\times \\hat  d_2}.\n\\end{gathered}')
('3.0.1', 'f_{\\mathrm{rel}}(\\mathbf q_s, \\mathbf k_t)= {\\hat{\\mathbf  q}_s}^{\\mathsf{H}}\\hat {\\mathbf W}_{t-s} \\hat{\\mathbf  k}_t')
('3.0.1', '\\hat {\\mathbf q}_s')
('3.0.1', '\\hat {\\mathbf k}_t')
('3.0.1', 'm=1')
('3.0.1', 'f_{\\mathrm{rel}}(\\mathbf q_s,\\mathbf  k_t)=\\mathbf  q_s^{\\mathsf{H}}\\mathbf W_{t-s} \\mathbf k_t.\n\\label{general1}')
('3.1', '\\begin{aligned}\n \\forall\\mathbf  q_s,\\mathbf  k_t \\in \\mathbb C^{d},  &f_{\\mathrm{rel}}(\\mathbf q_s,\\mathbf  k_t)\n= \\mathbf q_s^{\\mathsf{H}}\\mathbf W_{t-s}\\mathbf  k_t \\\\\n= & (\\mathbf M_s \\mathbf q_s)^{\\mathsf{H}}(\\mathbf M_t\\mathbf k_t)\n=\\mathbf q_s^{\\mathsf{H}}\\mathbf  M_s^{\\mathsf{H}}\\mathbf  M_t\\mathbf  k_t, \n\\end{aligned}\n\\label{eq_lrpe}')
('3.1', '\\mathbf q_s,\\mathbf  k_t\\in \\mathbb C^d')
('3.1', '\\mathbf W_s,\\mathbf M_s\\in \\mathbb C^{d\\times d},\\mathbf  W_{0}=\\mathbf  I_d')
('3.1', '\\mathbf W_0=\\mathbf I_d')
('3.1', 'O(n d^2)')
('3.1', 'n')
('3.1', 'd')
('3.1', '\\mathbf W_t')
('3.1', '\\label{main_eq} \n\\mathbf W_{t-s} =\\mathbf  W_s^{\\mathsf{H}}\\mathbf W_t.')
('3.1', '\\mathbf q_s, \\mathbf k_t')
('3.1', '\\label{eq_eq}\n  \\mathbf W_{t-s}= \\mathbf M_s^{\\mathsf{H}}\\mathbf M_t .')
('3.1', 's=t')
('3.1', '\\mathbf W_0= \\mathbf I_d')
('3.1', '\\mathbf M_s^{\\mathsf{H}}\\mathbf M_s =\\mathbf W_0= \\mathbf I_d.')
('3.1', '\\mathbf M_s')
('3.1', '\\mathbf P')
('3.1', '\\begin{aligned}\n  \\mathbf W_{t-s}\n  =& \\mathbf M_s^{\\mathsf{H}}\\mathbf M_t = \\mathbf M_s^{\\mathsf{H}}\\mathbf I_d \\mathbf M_t \\\\\n  =&\\mathbf M_s^{\\mathsf{H}}\\mathbf P^{\\mathsf{H}}\\mathbf P\\mathbf M_t=(\\mathbf P\\mathbf M_s)^{\\mathsf{H}}(\\mathbf P \\mathbf M_t).\n\\end{aligned}')
('3.1', '\\mathbf M_t')
('3.1', '\\mathbf P')
('3.1', '\\mathbf M_s')
('3.1', '\\mathbf M_0^{\\mathsf{H}}')
('3.1', '\\overline {\\mathbf M}_s = \\mathbf M_0^{\\mathsf{H}}\\mathbf M_s.')
('3.1', '\\overline{\\mathbf M}_s')
('3.1', '\\label{eq_eq1}\n\\mathbf W_{t-s} = \\overline{\\mathbf M}_s^{\\mathsf{H}}\\overline{\\mathbf M}_t.')
('3.1', 's=0')
('3.1', '\\mathbf W_t =  \\overline{\\mathbf M}_0^{\\mathsf{H}}\\overline{\\mathbf M}_t\n= \\mathbf M_0^{\\mathsf{H}}\\mathbf M_0  \\overline{\\mathbf M}_t\n=\\mathbf I_d \\overline{\\mathbf M}_t=\\overline {\\mathbf M}_t.')
('3.1', '\\mathbf W_{t-s} = \\mathbf W_s^{\\mathsf{H}}\\mathbf W_t.')
('3.1', '\\overline {\\mathbf M}_s')
('3.1', '\\mathbf W_s')
('3.1', '\\mathbf W_s^{\\mathsf{H}}\\mathbf W_s = \\mathbf I_d. \\qedhere')
('3.1.0', '\\mathbf W_s =\\mathbf P^{\\mathsf{H}}\\mathbf\\Lambda^{(s)}\\mathbf P')
('3.1.0', '\\mathbf P, \\mathbf \\Lambda^{(s)}')
('3.1.0', '\\mathbf W_s \\in \\mathbb C^{d\\times d}')
('3.1.0', '\\begin{aligned}\n\\mathbf W_s &=\\mathbf P^{\\mathsf{H}}\\mathbf\\Lambda^{(s)}\\mathbf P,\\\\\n\\mathbf\\Lambda^{(s)} &= \\mathrm{diag} \\{\\exp(i s\\alpha_1),\\ldots, \\exp(i s\\alpha_d)\\},\\\\\n\\end{aligned}')
('3.1.0', '\\mathbf P\\in \\mathbb C^{d\\times d}')
('3.1.0', '\\alpha_k, k=1,\\ldots,d')
('3.1.0', '\\mathbf W_s \\in \\mathbb R^{d\\times d}')
('3.1.0', '\\begin{gathered}\n\\mathbf W_s \n=\\mathbf  P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(s)}\\mathbf  P,\n\\mathbf \\Lambda^{(s)} =\\text{block-diag}\\{\\mathbf A^{(s)}, \\mathbf B^{(s)} \\},  \\\\\n\\mathbf A^{(s)}=\\text{block-diag}\\{\\mathbf A_1^{(s)},\\ldots, \\mathbf A_n^{(s)} \\} \\in \\mathbb R^{2p\\times 2p}, \n\\mathbf B^{(s)}= \\mathbf I_q\\in \\mathbb R^{q\\times q},\\\\\n\\mathbf A_k^{(s)}=\\left[\\begin{matrix}\n\\cos (s\\alpha_k) & -\\sin (s\\alpha_k) \\\\ \n\\sin (s\\alpha_k) & \\cos (s\\alpha_k)\n\\end{matrix}\\right],\n\\end{gathered}')
('3.1.0', '\\mathbf P\\in \\mathbb R^{d\\times d}')
('3.1.0', '\\alpha_k, k=1,\\ldots,d')
('3.1.0', '\\mathbf W_k \\in \\mathbb R^{d\\times d}')
('3.1.0', '\\begin{aligned}\n\\mathbf W_k &= \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(k)}\\mathbf  P,\\\\\n\\pi:\\{1,2, \\cdots, d\\} &\\rightarrow \\{1,2, \\cdots, d\\}\\text{ is permutation},\\\\\n\\mathbf \\Lambda^{(k)}&= (\\mathbf I)_{\\pi^k},\n\\end{aligned}')
('3.1.0', '\\mathbf P\\in \\mathbb R^{d\\times d}')
('3.1.0', '\\downarrow')
('3.2', '\\mathbf W_s =\\mathbf P^{\\mathsf{H}}\\mathbf\\Lambda^{(s)}\\mathbf P')
('3.2', '\\mathbf P')
('3.2', '\\mathbf \\Lambda^{(s)}')
('3.2', '\\mathbf P')
('3.2', '\\mathbf \\Lambda^{(s)}')
('3.2', '\\mathbf P')
('3.2', '\\mathbf P')
('4.0.0.1', '1+\\mathrm{elu}(\\cdot)')
('4.1', '\\downarrow')
('4.1', '\\downarrow')
('4.1', '\\downarrow')
('4.1', '\\downarrow')
('4.1', '\\uparrow')
('4.1', '\\uparrow')
('4.2.0', '\\mathbf P')
('4.2.0', '\\mathbf \\Lambda^{(s)}')
('4.2.0', '\\mathbf P')
('4.2.0', '\\uparrow')
('4.2.0.0', 'O(n)')
('6', '\\label{block_diag}\n\\text{block-diag} \\{\\mathbf{W}_1,\\mathbf{W}_2,\\ldots,\\mathbf{W}_n\\}=\n \\left[\n \\begin{matrix}\n   \\mathbf{W}_1 &     &        \\\\\n       & \\mathbf{W}_2 &   \\\\\n       &     &  \\ddots  \\\\\n       &     &   & \\mathbf W_n\n  \\end{matrix}\n  \\right].')
('7.0', '\\mathbf Q')
('7.0', '\\mathbf K')
('7.0', '\\mathbf V')
('7.0', '\\mathbf X\\in \\mathbb C^{n\\times d}')
('7.0', '\\begin{aligned}\n\\mathbf{X}\n&=\\left[\n \\begin{matrix}\n\\mathbf{x}_1^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n\\mathbf{x}_n^{\\mkern-1.5mu\\mathsf{T}}\n  \\end{matrix}\n  \\right] \\in \\mathbb R^{n\\times d},\\\\\n\\mathbf{Q}\n&=\\left[\n \\begin{matrix}\n\\mathbf{q}_1^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n\\mathbf{q}_n^{\\mkern-1.5mu\\mathsf{T}}\n  \\end{matrix}\n  \\right] =\\mathbf{XW}_Q=\\left[\n \\begin{matrix}\n\\mathbf{x}_1^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{W}_Q\\\\\n\\vdots\\\\\n\\mathbf{x}_n^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{W}_Q\n  \\end{matrix}\n  \\right] \\in \\mathbb R^{n\\times d}, \\\\\n \\mathbf{K}&= \\left[\n \\begin{matrix}\n \\mathbf{k}_1^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n \\mathbf{k}_n^{\\mkern-1.5mu\\mathsf{T}}\n  \\end{matrix}\n  \\right] \n  =\\mathbf{XW}_K=\\left[\n \\begin{matrix}\n\\mathbf{x}_1^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{W}_K\\\\\n\\vdots\\\\\n\\mathbf{x}_n^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{W}_K\n  \\end{matrix}\n  \\right] \\in \\mathbb R^{n\\times d}, \\\\\n\\mathbf{V}&=\\left[\n \\begin{matrix}\n\\mathbf{v}_1^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n\\mathbf{v}_n^{\\mkern-1.5mu\\mathsf{T}}\n  \\end{matrix}\n  \\right] \n  =\\mathbf{XW}_V=\\left[\n \\begin{matrix}\n\\mathbf{x}_1^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{W}_V\\\\\n\\vdots\\\\\n\\mathbf{x}_n^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{W}_V\n  \\end{matrix}\n  \\right] \\in \\mathbb R^{n\\times d}, \n\\end{aligned}')
('7.0', '\\mathbf{W}_Q,\\mathbf{W}_K,\\mathbf{W}_V \\in \\mathbb{R}^{d\\times d}')
('7.0', '\\begin{gathered}\n  \\mathbf{q}_s = \\mathbf{W}_Q^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{x}_s,\n \\mathbf{k}_s =\\mathbf{W}_K^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{x}_s,\n\\mathbf{v}_s =\\mathbf{W}_V^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{x}_s.\n\\end{gathered}')
('7.0', '\\mathbf{O}=\\left[\n \\begin{matrix}\n\\mathbf{o}_1^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n\\mathbf{o}_n^{\\mkern-1.5mu\\mathsf{T}}\n  \\end{matrix}\n  \\right] \\in \\mathbb  R^{n\\times d}.')
('7.1', '\\begin{aligned}\n\\mathbf{o}_s\n&=\\textrm{Attention}(\\mathbf{q}_s, \\mathbf{K}, \\mathbf{V})\\\\\n&=\\sum_{t=1}^n \\mathbf{a}_{st}  \\mathbf{v}_t\\\\\n&= \\sum_{t=1}^n \\frac{\\exp\\left(\\mathbf{q}_s^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{k}_{t}/\\sqrt{d} \\right) \\mathbf v_t}\n{\\sum_{r=1}^n\\exp\\left(\\mathbf{q}_s^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{k}_{r}/\\sqrt{d} \\right)},\\\\\n\\mathbf O&= \\textrm{Softmax}(\\mathbf{Q K}^{\\mkern-1.5mu\\mathsf{T}}/ \\sqrt{d}) \\mathbf{V}.\n\\end{aligned}')
('7.2', '\\begin{aligned}\n\\mathbf{o}_s\n&=\\textrm{LinearAttention}(\\mathbf{q}_s, \\mathbf{K}, \\mathbf{V})\\\\\n&=\\sum_{t=1}^n \\mathbf{a}_{st}  \\mathbf{v}_t\\\\\n&=\\sum_{t=1}^n \\frac{\\phi(\\mathbf{q}_s)^{\\mkern-1.5mu\\mathsf{T}}\\phi(\\mathbf{k}_{t})}\n{\\sum_{t=1}^n\\phi(\\mathbf{q}_s)^{\\mkern-1.5mu\\mathsf{T}}\\phi(\\mathbf{k}_{t})}  \\mathbf{v}_t\\\\\n&= \\frac{\\sum_{t=1}^n\\phi(\\mathbf{q}_s)^{\\mkern-1.5mu\\mathsf{T}}\\phi(\\mathbf{k}_{t}) \\mathbf{v}_t}\n{\\sum_{t=1}^n\\phi(\\mathbf{q}_s)^{\\mkern-1.5mu\\mathsf{T}}\\phi(\\mathbf{k}_{t})} \\\\\n&= \\phi(\\mathbf{q}_s)^{\\mkern-1.5mu\\mathsf{T}}\\frac{\\sum_{t=1}^n \\phi(\\mathbf{k}_{t}) \\mathbf{v}_t}\n{\\phi(\\mathbf{q}_s)^{\\mkern-1.5mu\\mathsf{T}}\\sum_{t=1}^n \\phi(\\mathbf{k}_{t})}, \\\\\n\\mathbf{O}&=\\mathbf \\Delta^{-1}  \\phi(\\mathbf{Q}) \\phi(\\mathbf{K})^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{V} \\\\\n&=\\mathbf \\Delta^{-1} \\phi(\\mathbf{Q}) [\\phi(\\mathbf{K})^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{V} ],\\\\\n\\mathbf \\Delta& = \\mathrm{diag}(\\phi(\\mathbf{Q})  [\\phi(\\mathbf{K})^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf 1}_n]).\n\\end{aligned}')
('8.0', '\\begin{aligned}\nf_{\\mathrm{rel}}(\\mathbf{q}_s, \\mathbf{k}_t)\n&=\\mathbf{q}_s^{\\mathsf{H}}\\mathbf{k}_t+\\mathbf{q}_s^{\\mathsf{H}}\\mathbf{\\bar k}_{{ g(s-t)}} +\\mathbf{\\bar q}_{{ g(t-s)}}^{\\mathsf{H}}\\mathbf{k}_t, \\\\\n g(x)&=\\begin{cases}\n0 & x \\le-c \\\\\n2 c-1 & x \\ge c \\\\\nx+c & \\text {others}.\n\\end{cases}\n\\end{aligned}')
('8.0', '\\begin{gathered}\nm=3, \\\\\n\\mathbf{\\hat q}_s^{(1)}= \\mathbf{q}_s,\\mathbf{\\hat k}_t^{(1)}=\\mathbf{k}_t,\\mathbf{W}_{t-s}^{(1)}=\\mathbf{I}_d,\\\\\n\\mathbf{\\hat q}_s^{(2)}=\\mathbf{q}_s,\\mathbf{\\hat k}_t^{(2)}= \\mathbf{I}_d,\\mathbf{W}_{t-s}^{(2)}=\\frac 1 d  \n\\underbrace{\\left[\n \\begin{matrix}\n  \\mathbf{\\bar  k}_{{ g(s-t)}} & \\ldots & \\mathbf{\\bar k}_{{ g(s-t)}}\n  \\end{matrix}\n  \\right]}_{d\\text{ columns}}, \\\\\n\\mathbf{\\hat q}_s^{(3)}=\\mathbf{I}_d\n ,\\mathbf{\\hat k}_t^{(3)}= \\mathbf{k}_t,\\mathbf{W}_{t-s}^{(3)}=\\frac 1 d  \n\\underbrace{\\left[\n \\begin{matrix}\n \\mathbf{\\bar q}_{{g(t-s)}} & \\ldots & \\mathbf{\\bar q}_{{ g(t-s)}}\n  \\end{matrix}\n  \\right]}_{d\\text{ columns}}.\n\\end{gathered}')
('8.0', '\\begin{aligned}\nf_{\\mathrm{rel}}(\\mathbf{q}_s, \\mathbf{k}_t)\n&=\\mathbf{q}_s^{\\mathsf{H}}\\mathbf{k}_t+\\mathbf{q}_s^{\\mathsf{H}}\\mathbf{c}_{t-s},  \\\\\n \\mathbf{c}_{t-s} &= \\mathbf{w}_{\\mathrm{clip}(t-s, k)}, \\\\\n \\mathrm{clip}(x, k)&=\\max (-k, \\min (k, x)), \\\\\n \\mathbf{w_{s}}&\\in \\mathbb C^ d ,-k\\le s \\le k .\n\\end{aligned}')
('8.0', '\\begin{gathered}\nm=2, \\\\\n\\mathbf{\\hat q}_s^{(1)}= \\mathbf{ q}_s,\\mathbf{\\hat k}_t^{(1)}=\\mathbf{ k}_t,\\mathbf{W}_{t-s}^{(1)}=\\mathbf{I}_d,\\\\\n\\mathbf{\\hat q}_s^{(2)}=\\mathbf{q}_s,\\mathbf{\\hat k}_t^{(2)}= \\mathbf{I}_d,\\mathbf{W}_{t-s}^{(2)}=\\frac 1 d  \n\\underbrace{\\left[\n \\begin{matrix}\n  \\mathbf{c}_{t-s} & \\ldots & \\mathbf{c}_{t-s}\n  \\end{matrix}\n  \\right]}_{d\\text{ columns}}.\n\\end{gathered}')
('8.0', 'f_{\\mathrm{rel}}(\\mathbf{q}_s, \\mathbf{k}_t)= \\mathbf{q}_s^{\\mathsf{H}}\\mathbf{k}_t\\cos(\\alpha(t-s)),')
('8.0', '\\begin{gathered}\nm=1, \\\\\n\\mathbf{\\hat q}_s^{(1)}= \\mathbf{q}_s,\n\\mathbf{\\hat k}_t^{(1)}=\\mathbf{k}_t,\n\\mathbf{W}_{t-s}^{(1)}=\\cos(\\alpha(t-s)) \\mathbf{I}_d.\n\\end{gathered}')
('8.1', 'n')
('8.1', '\\begin{aligned}\n \\mathbf Q= \\left[\n \\begin{matrix}\n\\mathbf{q}_1^{\\mathsf{H}}\\\\\n\\vdots\\\\\n\\mathbf{q}_n^{\\mathsf{H}}\n  \\end{matrix}\n  \\right] \\in \\mathbb  C^{n\\times d},\n \\mathbf K= \\left[\n \\begin{matrix}\n \\mathbf k_1^{\\mathsf{H}}\\\\\n\\vdots\\\\\n \\mathbf k_n^{\\mathsf{H}}\n  \\end{matrix}\n  \\right] \\in \\mathbb  C^{n\\times d},\n \\mathbf V=\\left[\n \\begin{matrix}\n \\mathbf v_1^{\\mathsf{H}}\\\\\n\\vdots\\\\\n \\mathbf v_n^{\\mathsf{H}}\n  \\end{matrix}\n  \\right] \\in \\mathbb  C^{n\\times d}, \\\\\n  \\tilde{\\mathbf{Q}}= \\left[\n \\begin{matrix}\n(\\mathbf M_1 \\mathbf q_1)^{\\mathsf{H}}\\\\\n\\vdots\\\\\n(\\mathbf M_n \\mathbf q_n)^{\\mathsf{H}}\n  \\end{matrix}\n  \\right] \\in \\mathbb  C^{n\\times d},\n\\tilde {\\mathbf K}= \\left[\n \\begin{matrix}\n(\\mathbf M_1 \\mathbf k_1)^{\\mathsf{H}}\\\\\n\\vdots\\\\\n(\\mathbf M_n \\mathbf k_n)^{\\mathsf{H}}\n  \\end{matrix}\n  \\right] \\in \\mathbb  C^{n\\times d}.\n\\end{aligned}')
('8.1', '\\mathbf Q, \\mathbf K')
('8.1', '\\tilde {\\mathbf Q}, \\tilde {\\mathbf K}')
('8.1', 'O(nd^2)')
('8.1', '\\begin{aligned}\n\\mathbf O&= \\mathbf Q(\\mathbf K^{\\mathsf{H}}\\mathbf V) \\in \\mathbb C^{n\\times d },\\\\\n\\mathbf O&=\\mathbf \\Delta^{-1}  \\tilde {\\mathbf Q} \\tilde {\\mathbf K}^{\\mathsf{H}}\\mathbf V \\\\\n&=\\mathbf \\Delta^{-1} \\tilde {\\mathbf Q} [\\tilde {\\mathbf K}^{\\mathsf{H}}\\mathbf V ],\\\\\n\\mathbf \\Delta& = \\mathrm{diag}(\\tilde {\\mathbf Q} ) [\\tilde {\\mathbf K}^{\\mathsf{H}}{\\mathbf 1}_n].\n\\end{aligned}\n\\label{sss}')
('8.1', 'O(nd^2)')
('8.1', 'O(nd^2)')
('8.2', '\\mathbf W\\in \\mathbb C^{d\\times d}')
('8.2', '\\mathbf P\\in \\mathbb C^{d\\times d}')
('8.2', '\\begin{aligned}\n\\mathbf W &=\\mathbf  P^{\\mathsf{H}}\\Lambda \\mathbf P,\\\\\n \\mathbf \\Lambda &=\\mathrm{diag} \\{\\exp(i\\theta_1),\\ldots, \\exp(i\\theta_d)\\},\\\\\n  i^2&= -1.\n\\end{aligned}')
('8.2', '\\mathbf W\\in \\mathbb R^{d\\times d}')
('8.2', '\\mathbf P\\in \\mathbb R^{d\\times d}')
('8.2', '\\begin{aligned}\n\\mathbf W &= \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda \\mathbf P,\\\\\n \\mathbf\\Lambda &=\\mathrm{diag} \\{\\mathbf\\Lambda_1,\\ldots,\\mathbf\\Lambda_r; 1,\\ldots, 1; -1,\\ldots,-1\\},\\\\\n\\mathbf\\Lambda_k&=\\left[\\begin{matrix}\n\\cos \\theta_{k} & -\\sin \\theta_{k} \\\\\n\\sin \\theta_{k} & \\cos \\theta_{k}\n\\end{matrix}\\right], k=1,\\ldots r.\n\\end{aligned}')
('8.3', '\\mathbf W_s')
('8.3', '\\mathbf P\\in \\mathbb C^{d\\times d}')
('8.3', '\\begin{aligned}\n\\mathbf W_s &= \\mathbf P^{\\mathsf{H}}\\mathbf \\Lambda^{(s)} \\mathbf P, \\\\\n  \\mathbf\\Lambda^{(s)}&=\\mathrm{diag} \\{\\exp(i\\theta_1^{(s)}),\\ldots, \\exp(i\\theta_d^{(s)})\\}.\n\\end{aligned}')
('8.3', '\\begin{aligned}\n\\mathbf W_s^{\\mathsf{H}}\\mathbf W_t &=\\mathbf W_{t-s},\\\\\n\\mathbf P^{\\mathsf{H}}{\\Lambda^{(s)}}^{\\mathsf{H}}\\mathbf P \\mathbf P^{\\mathsf{H}}\\Lambda^{(t)}\\mathbf P &= \\mathbf P^{\\mathsf{H}}\\Lambda^{(t-s)}\\mathbf P,\\\\\n\\mathbf P^{\\mathsf{H}}{\\mathbf \\Lambda^{(s)}}^{\\mathsf{H}}\\mathbf \\Lambda^{(t)}\\mathbf P &= \\mathbf P^{\\mathsf{H}}\\mathbf \\Lambda^{(t-s)}\\mathbf P,\\\\\n{\\mathbf \\Lambda^{(s)}}^{\\mathsf{H}}\\mathbf \\Lambda^{(t)}&=\\mathbf\\Lambda^{(t-s)},\\\\\n\\mathrm{diag}\\left\\{\nj(\\theta_1^{(t)}-\\theta_1^{(s)}),\nj(\\theta_2^{(t)}-\\theta_2^{(s)}),\\cdots, \nj(\\theta_d^{(t)}-\\theta_d^{(s)})\\right\\}&=\n\\mathrm{diag}\n\\left\\{\nj\\theta_1^{(t-s)},\nj\\theta_2^{(t-s)},\\cdots, \nj\\theta_d^{(t-s)}\\right\\}.\n\\end{aligned}')
('8.3', '\\forall k=1,\\ldots, d')
('8.3', '\\theta_k^{(t)}-\\theta_k^{(s)} = \\theta_k^{(t-s)} + 2l\\pi, k,l\\in \\mathbb Z.')
('8.3', '2l\\pi')
('8.3', 'l=0')
('8.3', '\\theta_k^{(t)}-\\theta_k^{(s)} = \\theta_k^{(t-s)}.')
('8.3', 't=s+1')
('8.3', '\\begin{aligned}\n&\\theta_k^{(s+1)} -\\theta_k^{(s)}=\\theta_k^{(1)},\\\\\n&\\theta_k^{(s)} =s \\theta^{(1)}_k \\triangleq s \\alpha_k.\n\\end{aligned}')
('8.4', '\\mathbf W_s')
('8.4', '\\mathbf P\\in \\mathbb R^{d\\times d}')
('8.4', '\\begin{aligned}\n\\mathbf W_s &= \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(s)}\\mathbf P,\\\\\n\\mathbf\\Lambda^{(s)} &= \\left[\\begin{matrix}\n\\mathbf A^{(s)} &  & \\\\ \n &\\mathbf B^{(s)} & \\\\\n & & \\mathbf C^{(s)}\n\\end{matrix}\\right],\\\\\n\\mathbf A^{(s)}&=\\left[\\begin{matrix}\n\\mathbf A_{1}^{(s)} &  \\\\ \n& \\ddots   \\\\ \n& & \\mathbf A_{n}^{(s)}  \\\\ \n\\end{matrix}\\right] \\in \\mathbb R^{2p\\times 2p},\\\\\n\\mathbf B^{(s)}&= \\mathbf I_q\\in \\mathbb R^{q\\times q},\\\\\n\\mathbf C^{(s)}&= \\mathbf -\\mathbf I_r \\in \\mathbb R^{r\\times r},\\\\\n\\mathbf A_k^{(s)}&=\\left[\\begin{matrix}\n\\cos \\theta_{k}^{(s)} & -\\sin \\theta_{k}^{(s)} \\\\\n\\sin \\theta_{k}^{(s)} & \\cos \\theta_{k}^{(s)}\n\\end{matrix}\\right].\n\\end{aligned}')
('8.4', '\\begin{aligned}\n\\mathbf W_s^{\\mkern-1.5mu\\mathsf{T}}\\mathbf W_t &=\\mathbf W_{t-s},\\\\\n\\mathbf{P}^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf{\\Lambda}^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf{P} \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(t)}\\mathbf P &= \\mathbf{P}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(t-s)} \\mathbf{P},\\\\\n\\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf\\Lambda^{(t)}\\mathbf P &= \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(t-s)}\\mathbf P,\\\\\n{{\\mathbf {\\Lambda}}^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(t)}&=\\mathbf \\Lambda^{(t-s)},\\\\\n\\left[\\begin{matrix}\n {\\mathbf A^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}& &    \\\\ \n & {\\mathbf B^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}&    \\\\\n  & &{\\mathbf C^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\n\\end{matrix}\\right] \n\\left[\\begin{matrix}\n\\mathbf A^{(t)} & &    \\\\ \n &\\mathbf B^{(t)} &    \\\\\n  & &\\mathbf C^{(t)}   \n\\end{matrix}\\right] &= \n\\left[\\begin{matrix}\n\\mathbf A^{(t-s)} & &    \\\\ \n &\\mathbf B^{(t-s)} &    \\\\\n  & &\\mathbf C^{(t-s)}   \n\\end{matrix}\\right],\n\\end{aligned}')
('8.4', '\\begin{aligned}\n{\\mathbf A^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf A^{(t)} &= \\mathbf A^{(t-s)}, \\\\\n{\\mathbf B^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf B^{(t)} &= \\mathbf B^{(t-s)}, \\\\\n{\\mathbf C^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf C^{(t)} &= \\mathbf C^{(t-s)}. \n\\end{aligned}')
('8.4', '\\mathbf A^{(s)}')
('8.4', 'k')
('8.4', '\\begin{aligned}\n{\\mathbf A^{(s)}_k}^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf A}^{(t)}_k &= {\\mathbf A}^{(t-s)}_k \\\\\n&=\\left[\\begin{array}{cc}\\cos  \\theta^{(s)}_{k} & \\sin \\theta^{(s)}_{k} \\\\ -\\sin \\theta^{(s)}_{k} & \\cos \\theta^{(s)}_{k} \\end{array}\\right]\n\\left[\\begin{array}{cc}\\cos  \\theta^{(t)}_{k} & -\\sin \\theta^{(t)}_{k} \\\\ \\sin \\theta^{(t)}_{k} & \\cos \\theta^{(t)}_{k} \\end{array}\\right]\\\\\n&=\\left[\\begin{array}{cc}\n\\cos \\theta^{(s)}_{k} \\cos \\theta^{(t)}_{k} +\\sin \\theta^{(s)}_{k}\\cos \\theta^{(t)}_{k}  &\n\\sin \\theta^{(s)}_{k}  \\cos \\theta^{(t)}_{k} - \\cos \\theta^{(s)}_{k}  \\sin\\theta^{(t)}_{k} \\\\ \n-\\sin  \\theta^{(s)}_{k} \\cos\\theta^{(t)}_{k}   +\\cos\\theta^{(s)}_{k} \\sin \\theta^{(t)}_{k} \n& \\cos\\theta^{(s)}_{k} \\cos \\theta^{(t)}_{k}  +\\sin\\theta^{(s)}_{k} \\sin \\theta^{(t)}_{k}  \n\\end{array}\\right]\\\\\n&=\\left[\\begin{array}{cc}\n\\cos \\left(\\theta^{(t)}_{k}-\\theta^{(s)}_{k} \\right)  &\n-\\sin \\left(\\theta^{(t)}_{k} -\\theta^{(s)}_{k} \\right) \\\\ \n\\sin \\left(\\theta^{(t)}_{k} -\\theta^{(s)}_{k} \\right)\n&\\cos \\left(\\theta^{(t)}_{k} -\\theta^{(s)}_{k} \\right) \\\\\n\\end{array}\\right]\\\\\n&=\\mathbf A^{(t-s)}_{k} \\\\\n&=\\left[\\begin{array}{cc}\\cos  \\theta^{(t-s)}_{k} & -\\sin \\theta^{(t-s)}_{k} \\\\ \\sin \\theta^{(t-s)}_{k} & \\cos \\theta^{(t-s)}_{k} \\end{array}\\right].\n\\end{aligned}')
('8.4', '\\forall k=1,\\ldots, d')
('8.4', '\\theta_k^{(t)}-\\theta_k^{(s)} = \\theta_k^{(t-s)} + 2k\\pi, k\\in \\mathbb Z.')
('8.4', '2t\\pi')
('8.4', 't=0')
('8.4', '\\theta_k^{(t)}-\\theta_k^{(s)} = \\theta_k^{(t-s)}.')
('8.4', 't=s+1')
('8.4', '\\begin{aligned}\n&\\theta_k^{(s+1)} -\\theta_k^{(s)}=\\theta_k^{(1)},\\\\\n&\\theta_k^{(s)} =s \\theta^{(1)}_k \\triangleq s \\alpha_k.\n\\end{aligned}')
('8.4', '\\mathbf B^{(s)}')
('8.4', '\\begin{aligned}\n{\\mathbf B^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf B^{(t)}\n&= \\mathbf I_{q}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf I_q \\\\\n&=\\mathbf I_q\\\\\n&= \\mathbf B^{(t-s)}. \\\\\n\\end{aligned}')
('8.4', '\\mathbf C^{(s)}')
('8.4', '\\begin{aligned}\n{\\mathbf C^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf C^{(t)}\n&= (-\\mathbf I_{r}^T )(-\\mathbf I_r) \\\\\n&=\\mathbf I_r\\\\\n&\\neq \\mathbf C^{(t-s)}. \\\\\n\\end{aligned}')
('8.4', 'r=0')
('8.5', '\\pi')
('8.5', '\\pi:\\{1,2, \\cdots, d\\} \\rightarrow \\{1,2, \\cdots, d\\}, d\\in \\mathbb Z^+.')
('8.5', '\\mathbf M=\\left[\\begin{matrix}\n\\mathbf m_1^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\mathbf m_2^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n\\mathbf m_d^{\\mkern-1.5mu\\mathsf{T}}\n\\end{matrix}\\right] \\in \\mathbb R^{d\\times d},\\mathbf m_k \\in \\mathbb R^d , k=1,\\ldots ,d,')
('8.5', '\\mathbf M_{\\pi}')
('8.5', '\\mathbf M_\\pi=\\left[\\begin{matrix}\n\\mathbf m_{\\pi(1)}^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\mathbf m_{\\pi(2)}^{\\mkern-1.5mu\\mathsf{T}}\\\\\n\\vdots\\\\\n\\mathbf m_{\\pi(d)}^{\\mkern-1.5mu\\mathsf{T}}\n\\end{matrix}\\right].')
('8.5', '\\mathbf I_d\\in \\mathbb R^{d\\times d}')
('8.5', '\\pi')
('8.5', '\\mathbf \\Lambda_k = (\\mathbf I_d)_{\\pi^k}.')
('8.5', '\\mathbf \\Lambda_k')
('8.5', '\\pi')
('8.5', '\\mathbf M\\in \\mathbb R^{d\\times d}')
('8.5', '\\mathbf \\Lambda_k \\in \\mathbb R^{d \\times d}')
('8.5', '\\mathbf M_{\\pi} = \\mathbf \\Lambda_1 \\mathbf M.')
('8.5', '\\mathbf I_d\\in \\mathbb R^{d\\times d}')
('8.5', '\\mathbf e_k\\in \\mathbb R^{d},k=1,\\ldots,d')
('8.5', 'k')
('8.5', '\\mathbf I_d=\\left[\\begin{array}{c}{\\mathbf e}_{1}^{\\mkern-1.5mu\\mathsf{T}}\\\\ {\\mathbf e}_{2}^{\\mkern-1.5mu\\mathsf{T}}\\\\ \\vdots \\\\ {\\mathbf e}_{d}^{\\mkern-1.5mu\\mathsf{T}}\\end{array}\\right].')
('8.5', '\\mathbf e_k^{\\mkern-1.5mu\\mathsf{T}}\\mathbf M = \\mathbf{m}_{k}^{\\mkern-1.5mu\\mathsf{T}},')
('8.5', '\\begin{aligned}\n\\mathbf \\Lambda_1 \\mathbf M\n&= \\left[\\begin{array}{c}{\\mathbf e}_{\\pi(1)}^{\\mkern-1.5mu\\mathsf{T}}\\\\ {\\mathbf e}_{\\pi(2)}^{\\mkern-1.5mu\\mathsf{T}}\\\\ \\vdots \\\\ {\\mathbf e}_{\\pi(d)}^{\\mkern-1.5mu\\mathsf{T}}\\end{array}\\right]\\mathbf M\\\\\n&= \\left[\\begin{array}{c}{\\mathbf e}_{\\pi(1)}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf  M \\\\ {\\mathbf e}_{\\pi(2)}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf  M \\\\ \\vdots \\\\ {\\mathbf e}_{\\pi(d)}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf  M\\end{array}\\right] \\\\\n&= \\left[\\begin{array}{c}\\mathbf m_{\\pi(1)}^{\\mkern-1.5mu\\mathsf{T}}\\\\ \\mathbf m_{\\pi(2)}^{\\mkern-1.5mu\\mathsf{T}}\\\\ \\vdots \\\\ \\mathbf m_{\\pi(d)}^{\\mkern-1.5mu\\mathsf{T}}\\end{array}\\right]\\\\\n&= \\mathbf M_{\\pi}.\n\\end{aligned}')
('8.5', '\\mathbf \\Lambda_k')
('8.5', '\\mathbf \\Lambda_k= \\mathbf \\Lambda_1^k.')
('8.5', 'k=1')
('8.5', 'k=s-1')
('8.5', 'k=s')
('8.5', '\\begin{aligned}\n\\mathbf \\Lambda_{s}\n&=(\\mathbf I_d)_{\\pi^s}\\\\\n&=((\\mathbf I_d)_{\\pi^{s-1}})_{\\pi}\\\\\n&=(\\mathbf \\Lambda_{s-1})_{\\pi}\\\\\n&= (\\mathbf \\Lambda_1^{s-1})_{\\pi}.\n\\end{aligned}')
('8.5', '\\begin{aligned}\n(\\mathbf \\Lambda_1^{s-1})_{\\pi}= \\mathbf \\Lambda_1^s =\\mathbf \\Lambda_1 \\mathbf \\Lambda_1^{s-1}. \n\\end{aligned}')
('8.5', '\\mathbf \\Lambda_k\\in \\mathbb R^{d \\times d}')
('8.5', '\\mathbf \\Lambda_k \\mathbf \\Lambda_k^T= \\mathbf \\Lambda_k^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda_k=\\mathbf I_d.')
('8.5', 'k=1')
('8.5', '\\begin{aligned}\n\\mathbf \\Lambda_1 \\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}}\n&= \\left[\\begin{array}{c}{\\mathbf e}_{\\pi(1)}^{\\mkern-1.5mu\\mathsf{T}}\\\\ {\\mathbf e}_{\\pi(2)}^{\\mkern-1.5mu\\mathsf{T}}\\\\ \\vdots \\\\ {\\mathbf e}_{\\pi(d)}^{\\mkern-1.5mu\\mathsf{T}}\\end{array}\\right]\n\\left[\\begin{matrix}{\\mathbf e}_{\\pi(1)} & {\\mathbf e}_{\\pi(2)} & \\ldots & {\\mathbf e}_{\\pi(d)}\\end {matrix}\\right],\\\\\n\\left[\\mathbf \\Lambda_1 \\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}}\\right]_{st}\n&= {\\mathbf e}_{\\pi(s)}^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf e}_{\\pi(t)} \\\\\n&=\\delta_{st}, \\\\\n\\mathbf \\Lambda_1 \\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}}& = \\mathbf I_d.\n\\end{aligned}')
('8.5', '\\mathbf \\Lambda_1')
('8.5', '\\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda_1=\\mathbf I_d.')
('8.5', '\\begin{aligned}\n\\mathbf \\Lambda_k \\mathbf \\Lambda_k^{\\mkern-1.5mu\\mathsf{T}}\n&= \\mathbf \\Lambda_1^k  ( \\mathbf \\Lambda_1^k)^{\\mkern-1.5mu\\mathsf{T}}\\\\\n&= \\mathbf \\Lambda_1^k(\\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}})^k \\\\\n&= \\mathbf \\Lambda_1^{k-1}\\mathbf \\Lambda_1 \\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}}(\\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}})^{k-1} \\\\\n&= \\mathbf \\Lambda_1^{k-1}(\\mathbf \\Lambda_1^{\\mkern-1.5mu\\mathsf{T}})^{k-1}\\\\\n&= \\ldots \\\\\n&= \\mathbf I_d.\n\\end{aligned}')
('8.5', '\\mathbf \\Lambda_k^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda_k=\\mathbf I_d.')
('8.5', '\\mathbf W_k')
('8.5', '\\mathbf P\\in \\mathbb R^{d\\times d}')
('8.5', '\\begin{aligned}\n\\mathbf W_k &= \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}\\mathbf \\Lambda^{(k)} \\mathbf P.\\\\\n\\end{aligned}')
('8.5', '\\label{eq:trick}\n\\begin{aligned}\n\\mathbf W_s^{\\mkern-1.5mu\\mathsf{T}}\\mathbf W_t\n&=  \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}\\mathbf P \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(t)}} \\mathbf P \\\\\n&=  \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(t)}} \\mathbf P \\\\\n&=  \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}(\\mathbf \\Lambda^{(1)})^t \\mathbf P \\\\\n&=  \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}(\\mathbf \\Lambda^{(1)})^s (\\mathbf \\Lambda^{(1)})^{t-s} \\mathbf P \\\\\n&=  \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}}^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(s)}} (\\mathbf \\Lambda^{(1)})^{t-s} \\mathbf P \\\\\n&=  \\mathbf P^{\\mkern-1.5mu\\mathsf{T}}{\\mathbf \\Lambda^{(t-s)}} \\mathbf P \\\\\n&=  \\mathbf W_{t-s}.\n\\end{aligned}')
('9.0', '\\mathbf W_s =\\mathbf P^{\\mathsf{H}}\\mathbf\\Lambda^{(s)}\\mathbf P')
('9.0', '\\mathbf P')
('9.0', '\\mathbf \\Lambda^{(s)}')
('9.0', '\\mathbf P / {\\mathbf \\Lambda}^{(s)}')
('9.0.0', '\\mathbf P')
('9.0.0', '\\mathbf v\\in \\mathbb R^d')
('9.0.0', '\\begin{aligned}\n\\mathbf W =\\mathbf  I_d - 2 \\mathbf v\\mathbf  v^{\\mkern-1.5mu\\mathsf{T}}/ (\\mathbf v^{\\mkern-1.5mu\\mathsf{T}}\\mathbf v).\n\\end{aligned}')
('9.0.0', '\\mathbf v')
('9.0.0', '\\begin{aligned}\n\\pi (2k) = k, \\pi(2k+1) = \\lfloor d/ 2\\rfloor + 1, 1\\le 2k, 2k+1 \\le d.\n\\end{aligned}')
('9.0.0', '\\mathbf \\Lambda^{(s)}')
('9.0.0', '\\alpha_t=10000^{-2t /d}')
('9.0.0', 'q=0')
('9.0.0', '\\alpha_t=10000^{-2t /d}')
('9.0.0', 'q=0')
('9.0.0', '\\alpha_t=10000^{-2t /d}')
('9.0.0.0', '\\begin{aligned}\n\\mathbf q_s^{\\mathsf{H}}\\mathbf  W_s^{\\mathsf{H}}\\mathbf  W_t\\mathbf  k_t \n&= \\mathbf q_s^{\\mathsf{H}}\\mathbf P^{\\mathsf{H}}(\\mathbf \\Lambda^{(s)})^{^{\\mathsf{H}}}\\mathbf P \n\\mathbf P^{\\mathsf{H}}\\mathbf \\Lambda^{(t)}\\mathbf P \\mathbf  k_t\\\\\n&=  \\mathbf q_s^{\\mathsf{H}}\\mathbf P^{\\mathsf{H}}(\\mathbf \\Lambda^{(s)})^{^{\\mathsf{H}}} \\mathbf \\Lambda^{(t)}\\mathbf P \\mathbf  k_t\\\\\n&= (\\mathbf \\Lambda^{(s)}\\mathbf P \\mathbf q_s)^{\\mathsf{H}}(\\mathbf \\Lambda^{(t)}\\mathbf P \\mathbf  k_t).\n\\end{aligned}')
('9.0.0.0', '\\mathbf W_s =\\mathbf P^{\\mathsf{H}}\\mathbf\\Lambda^{(s)}')
('9.0.0.0', '\\mathbf W_s =\\mathbf P^{\\mathsf{H}}\\mathbf\\Lambda^{(s)}\\mathbf P')
