('1', '5\\times')
('3.0', 'T')
('3.0', '\\mathcal{T}_{1:T}=\\{\\mathcal{T}_1, \\mathcal{T}_2, \\dots, \\mathcal{T}_T\\}')
('3.0', '\\mathcal{T}_t')
('3.0', '\\mathcal{D}^{t}=\\{({\\bm{x}}_{i}^{t}, y_{i}^{t})_{i=1}^{n_{t}}\\}')
('3.0', 'n_{t}')
('3.0', '{\\bm{x}}')
('3.0', 'y')
('3.0', '({\\bm{x}}_{i}^{t}, y_{i}^{t}) \\in  (\\mathcal{X}^{t}\\times\\mathcal{Y}^{t})')
('3.0', '(\\mathcal{X}^{t}\\times\\mathcal{Y}^{t})')
('3.0', "\\mathcal{Y}^{t} \\cap \\mathcal{Y}^{t'}=\\emptyset")
('3.0', "{t}\\neq{t'}")
('3.0', 't')
('3.0', 'f_{\\theta^t}(\\cdot):\\mathbb{R}^{W\\times H\\times C}\\rightarrow \\mathbb{R}^D')
('3.0', 'g_{\\phi^t}(\\cdot):\\mathbb{R}^D\\rightarrow \\mathbb{R}^K')
('3.0', '\\theta^t')
('3.0', '\\phi^t')
('3.0', 'f_{\\theta^t}(\\cdot)')
('3.0', 'g_{\\phi^t}(\\cdot)')
('3.0', '\\mathcal{T}_{1:t}')
('3.0', 't')
('3.0', '\\mathcal{D}^t')
('3.0', '\\mathcal{T}_t')
('3.1', '\\mathcal{D}_k^t')
('3.1', 'k')
('3.1', 't')
('3.1', 'k')
('3.1', '\\label{eq:class_mean}\n    {\\bm{\\mu}}_k = \\frac{1}{|\\mathcal{D}_k^t|}\\sum_{{\\bm{x}}\\in \\mathcal{D}_k^t} f_{\\theta}({\\bm{x}}).')
('3.1', '\\theta')
('3.1', '\\label{eq:argmax}\n    y^*=\\underset{y\\in\\{1, \\dots, K\\}}{\\mathop{\\mathrm{arg\\,min}}}\\{d({\\bm{u}}_y, f_\\theta({\\bm{x}}))\\},')
('3.1', 'd:\\mathbb{R}^{D} \\times \\mathbb{R}^{D} \\rightarrow \\mathbb{R}')
('3.1', 'd')
('3.2.0', '{\\bm{p}}_i \\in \\mathbb{R}^{L_p\\times D}')
('3.2.0', 'i')
('3.2.0', 'L_p')
('3.2.0', 'D')
('3.2.0', 'i')
('3.2.0', '= T_i([{\\bm{c}}_{i-1}, {\\bm{p}}_{i-1}, {\\bm{e}}_{i-1}]),')
('3.2.0', 'T_i')
('3.2.0', '{\\bm{c}}\\in\\mathbb{R}^{1\\times D}')
('3.2.0', '{\\bm{e}}\\in\\mathbb{R}^{L_e\\times D}')
('3.2.0', '[\\cdot]')
('3.2.0', 'S')
('3.2.0', 't')
('3.2.0', 'P^t=\\{{\\bm{p}}^t_1, {\\bm{p}}^t_2, \\dots, {\\bm{p}}^t_S\\}')
('3.2.0', 't')
('3.2.0', 'f_{\\theta^t}(\\cdot) \\rightarrow f_{\\{\\theta, P^t\\}}(\\cdot).')
('3.2.1', 't')
('3.2.1', 'I=\\{({\\bm{x}}_1, y_1),\\dots,({\\bm{x}}_N, y_N)\\}')
('3.2.1', 'N')
('3.2.1', 'Z=\\{{\\bm{z}}_1, \\dots,{\\bm{z}}_N\\}')
('3.2.1', '{\\bm{z}}')
('3.2.1', '{\\bm{z}}=m_{\\sigma^t}(f_{\\{\\theta; P^t\\}}({\\bm{x}}))')
('3.2.1', 'm_{\\sigma^t}(\\cdot)')
('3.2.1', '\\sigma^t')
('3.2.1', 'm_{\\sigma^t}(\\cdot)')
('3.2.1', '\\begin{gathered}\n    \\mathcal{L} = \\frac{1}{N}\\sum_{i\\in \\{1,\\dots, N\\}}{\\mathcal{L}_i},\\\\ \n    \\mathcal{L}_i = \\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p\\in P(i)}\\log{\\frac{\\exp({\\bm{z}}_i\\cdot {\\bm{z}}_p/\\tau)}{\\underset{{\\bm{z}}_n\\in N(i)\\cup \\hat{U}}\\sum\\exp({\\bm{z}}_i \\cdot {\\bm{z}}_n/\\tau)}},\n    \\label{eq:proto_con}\n\\end{gathered}')
('3.2.1', 'P(i)=\\{{\\bm{z}}_p \\in Z: y_p = y_i\\}')
('3.2.1', '{\\bm{z}}_i')
('3.2.1', 'N(i)=\\{{\\bm{z}}_n \\in Z: y_n \\neq y_i\\}')
('3.2.1', '{\\bm{z}}_i')
('3.2.1', '\\hat{U}=\\{\\hat{{\\bm{u}}}_1,\\dots,\\hat{{\\bm{u}}}_k\\}')
('3.2.1', 'U')
('3.2.1', '\\hat{{\\bm{\\mu}}} = {\\bm{\\mu}}+ m * {\\bm{e}}')
('3.2.1', '{\\bm{e}}\\sim\\mathcal{N}(0, 1)')
('3.2.1', 'm')
('3.2.2', 'k')
('3.2.2', 't')
('3.2.2', '{\\bm{u}}_k=\\frac{1}{|{D}_k^t|}\\sum_{{\\bm{x}}\\in\\mathcal{D}_k^t}f_{\\theta}({\\bm{x}})')
('3.2.2', '\\hat{{\\bm{u}}}=\\frac{1}{|{D}_k^t|}\\sum_{{\\bm{x}}\\in\\mathcal{D}_k^t}f_{\\{\\theta, P^t\\}}({\\bm{x}})')
('3.2.2', 't')
('3.2.2', 'U = \\{{\\bm{u}}_1,\\dots,{\\bm{u}}_K\\}')
('3.2.2', '\\hat{U} = \\{\\hat{{\\bm{u}}}_1,\\dots, \\hat{{\\bm{u}}}_K\\}')
('3.2.2', 'K')
('3.2.2', '{\\bm{q}}:\\mathbb{R}^{1\\times D}')
('3.2.2', '{\\bm{x}}')
('3.2.2', 'q({\\bm{q}}, U, r)')
('3.2.2', 'r')
('3.2.2', '\\{P^1,\\dots,P^J:J\\leq r\\}')
('3.2.2', 'J\\leq r')
('3.2.2', '{\\bm{q}}')
('3.2.2', '{\\bm{q}}= f_{\\theta}({\\bm{x}})')
('3.2.2', '{\\bm{q}}')
('3.2.2', 'U')
('3.2.2', '\\hat{Q}=\\{\\hat{{\\bm{q}}}^j: j\\in[1, J]\\}')
('3.2.2', '\\hat{{\\bm{q}}}^j=f_{\\{\\theta, P^j\\}}({\\bm{x}})')
('3.2.2', '\\label{eq:final_predict}\n    y^*=\\underset{y}{\\mathop{\\mathrm{arg\\,min}}}\\{d(\\hat{{\\bm{u}}}_y,\\hat{{\\bm{q}}}^j): y\\in[1,K], j\\in[1,J]\\}.')
('3.3', '{\\bm{S}}_k:\\mathbb{R}^{|\\mathcal{D}_k|\\times |\\mathcal{D}_k|}')
('3.3', 'k')
('3.3', '{\\bm{S}}_k')
('3.3', 'C')
('3.3', '\\{{\\bm{u}}_{k,c}\\}_{c=1}^C')
('3.3', 'r')
('3.3', '\\max(1, r/C)')
('4.1', '1 \\times 10^{-3}')
('4.1', '1 \\times 10^{-6}')
('4.1', 'L_p')
('4.1', 'C')
('4.1', 'r')
('4.2', '^2')
('4.3', '\\rho=1.0')
('4.3', '\\tau=0.6')
('4.3', 'L_p=1')
('4.3', 'C')
('4.3', 'r')
('4.3', 'C=5')
('4.3', 'r=3')
('4.4', '0.73')
('6', '{\\bm{z}}_i')
('6', '{\\bm{z}}_j')
('6', 's_{i,j}')
('6', 'N(i)\\cup \\hat{U}')
('6', '\\hat{N}(i)')
('6', '{\\bm{x}}_i')
('6', '\\label{eq:loss_for_k}\n    \\mathcal{L}_i = \\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\log\\frac{\\exp(s_{i,p}/\\tau)}{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}.')
('6', 's_{i,j}')
('6', '({\\bm{z}}_i, {\\bm{z}}_j)')
('6', 'z_j \\in P(i)')
('6', '\\begin{aligned}\n        \\frac{\\partial \\mathcal{L}_i^k}{\\partial s_{i,j}}\n        &=\\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\frac{\\partial }{\\partial s_{i,j}}\\left(s_{i,p}/\\tau - \\log{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}}\\exp(s_{i,n}/\\tau)\\right), \\\\\n        & = \\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\left(\\frac{1}{\\tau} \\cdot \\mathbbm{1}[p=j]-\\frac{\\frac{\\partial}{\\partial s_{i,j}}\\left(\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)\\right)}{{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}}\\exp(s_{i,n}/\\tau)}\\right), \\\\\n        & = \\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\left(\\frac{1}{\\tau}\\cdot\\mathbbm{1}[p=j]-0\\right), \\\\\n        & = \\frac{-1}{\\tau|P(i)|},\n    \\end{aligned}')
('6', '\\mathbbm{1}')
('6', 's_{i,m}')
('6', '({\\bm{z}}_i, {\\bm{z}}_m)')
('6', '{\\bm{z}}_m \\in N(i)')
('6', '\\begin{aligned}\n        \\frac{\\partial \\mathcal{L}_i^k}{\\partial s_{i,m}} & =\\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\frac{\\partial }{\\partial s_{i,m}}\\left(s_{i,p}/\\tau - \\log{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}}\\exp(s_{i,n}/\\tau)\\right), \\\\\n        & = \\frac{-1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\left(0-\\frac{\\frac{\\partial}{\\partial s_{i,m}}\\left(\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)\\right)}{{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}}\\exp(s_{i,n}/\\tau)}\\right), \\\\\n        & = \\frac{1}{|P(i)|}\\sum_{{\\bm{z}}_p \\in P(i)}\\left(\\frac{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\left(\\exp(s_{i,n}/\\tau)\\cdot \\frac{1}{\\tau} \\cdot \\mathbbm{1}[n=m]\\right)}{{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}}\\exp(s_{i,n}/\\tau)}\\right), \\\\\n        & = \\frac{1}{\\tau} \\frac{\\exp(s_{i,m}/\\tau)}{{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}}\\exp(s_{i,n}/\\tau)} .\n    \\end{aligned}')
('6', '\\exp(s_{i,m}/\\tau)')
('7', 'E_{\\theta}({\\bm{x}}): \\mathbb{R}^{D}\\rightarrow \\mathbb{R}')
('7', '\\theta')
('7', '{\\bm{x}}')
('7', 'E_{\\theta}(\\cdot)')
('7', 'p({\\bm{x}})')
('7', "p_{\\theta}(y|{\\bm{x}}) = \\frac{\\exp(-E_{\\theta}({\\bm{x}}, y)/\\tau)}{\\int_{y'}\\exp(-E_{\\theta}({\\bm{x}}, y')/\\tau)} = \\frac{\\exp(-E_{\\theta}({\\bm{x}}, y)/\\tau)}{\\exp(-E_{\\theta}({\\bm{x}})/\\tau)},\n    \\label{eq:energy}")
('7', 'E_{\\theta}(x)')
('7', '\\tau')
('7', "E_{\\theta}(x) = \\tau \\cdot -\\log\\int_{y'}\\exp(-E_{\\theta}({\\bm{x}}, y')/\\tau).")
('7', "p(y|{\\bm{x}}) = \\frac{\\exp(s_{x, y}/\\tau)}{\\sum_{y'=1}^{K}\\exp(s_{x, y'}/\\tau)},\n    \\label{eq:predict}")
('7', 's_{x, y} = \\langle f_{\\{\\theta, P\\}}({\\bm{x}}), \\hat{{\\bm{\\mu}}}_y\\rangle')
('7', 'E_{\\theta}({\\bm{x}}, y) = -s_{x,y}')
('7', '{\\bm{x}}')
('7', 'E_{\\theta}({\\bm{x}}) =  \\tau \\cdot -\\log\\sum_{y=1}^{K}\\exp(s_{x,y}/\\tau),')
('7', 's_{x,y^*}')
('7', '\\tau')
('7', '{\\bm{z}}_{p}')
('7', '\\begin{aligned}\n        \\label{eq:sim_loss_for_k}\n        \\mathcal{L}_i &= -\\log\\frac{\\exp(s_{i,p}/\\tau)}{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}, \\\\\n        & = - s_{i,p} + \\log{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}.\n    \\end{aligned}')
('7', '{\\bm{z}}_{p}')
('7', '\\hat{{\\bm{\\mu}}}')
('7', '\\mathcal{L}_i = \\underbrace{-\\langle{\\bm{z}}_i, \\hat{{\\bm{\\mu}}}\\rangle}_\\text{push down energy for target prototype} + \\underbrace{\\log{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}}_\\text{pull up energies for other prototypes}.')
('7', '\\hat{{\\bm{\\mu}}}')
('7', '\\hat{{\\bm{\\mu}}}')
('7', '\\begin{aligned}\n    \\label{eq:with_uniform}\n        \\mathcal{L}_i &= -\\log\\frac{\\exp(s_{i,p})}{\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau) + \\underset{{\\bm{z}}_n\\in\\hat{P}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}, \\\\\n        & = - s_{i,p} + \\log\\left({\\underset{{\\bm{z}}_n \\in \\hat{N}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}+ \\underbrace{\\underset{{\\bm{z}}_n\\in\\hat{P}(i)}{\\sum}\\exp(s_{i,n}/\\tau)}_\\text{harmfully pull up energy for target prototype}\\right),\n    \\end{aligned}')
('7', '\\hat{P}(i) = \\{z_j: y_j=y_i, i\\neq j\\}')
('7', '\\log')
('7', '-s_{i,p}')
('8', 'f_{\\theta}')
('8', 'T')
('8', 'E')
('8', '{\\{({\\bm{x}}_i^t, y_i^t)\\}_{i=1}^{n_t}}\\}_{t=1}^{T}')
('8', 'L_p')
('8', 'C')
('8', '\\{P^t \\}_{t=1}^T')
('8', 'U')
('8', '\\hat{U}')
('8', 'f_{\\theta}')
('8', 'U')
('8', '\\hat{U}')
('8', '\\{P^t\\}_{t=1}^T')
('8', 'q(,,r)')
('8', '{\\bm{x}}')
('8', '\\hat{Q}=\\varnothing')
('8', '{\\bm{q}}= f_{\\theta}({\\bm{x}})[0, :]')
('8', 'J = q({\\bm{q}}, U, r)')
('8', 'y')
('10', '12.2 \\times 768')
('10', '1/15')
('10', '224\\times224\\times3')
('10', 'C')
('10', 'r')
('11.0', 'A_{i, j}')
('11.0', 'j')
('11.0', 'i')
('11.0', 'A_i')
('11.0', 'F_i')
('11.0', 'i')
('11.0', '\\begin{aligned}\n        &A_{i}=\\frac{1}{i} \\sum_{j=1}^{i} A_{i, j},\\\\\n        &F_{i}=\\frac{1}{i-1} \\sum_{j=1}^{i-1} \\max _{j^{\\prime} \\in\\{1, \\cdots, i-1\\}}\\left(A_{j^{\\prime},j}-A_{i,j}\\right).\n    \\end{aligned}')
('11.0', 'T')
('11.0', 'Acc=A_T')
('11.0', 'Acc=\\frac{1}{T}\\sum_{i=1}^T A_i')
('11.1', '=224')
('11.1', '=[0.8, 1.0]')
('11.1', 'p=0.5')
('11.1', 'p=0.8')
('11.1', '=0.4')
('11.1', '=0.4')
('11.1', '=0.2')
('11.1', '=0.1')
('11.1', 'p=0.2')
('11.1', 'p=0.1')
('11.1', '=0.1')
('11.1', 'p=0.2')
('12', '1 \\times 10^{-4}')
('12', '1 \\times 10^{-4}')
('12', '1 \\times 10^{-4}')
('12', 'L_e=20')
('12', 'L_g=5')
('12', 'start_e=3')
('12', 'end_e=5')
('12', 'start_g=1')
('12', 'end_g=2')
('12', '0.005')
('13.2', 'r')
('13.2', 'r')
('13.2', 'r')
('13.2', 'r')
('13.2', 'r=3')
