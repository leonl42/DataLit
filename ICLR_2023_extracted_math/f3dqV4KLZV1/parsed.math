('1', 'M')
('1', '[M]')
('1', '\\{1,\\dots,M\\}.')
('1', '\\label{eq:SingleFL-obj}\n\\min_{w} F (w) \\coloneqq \\sum_{m \\in [M]} \\lambda_m \\phi \\left( w  ;  \\mathcal{D}_m \\right),')
('1', '\\phi (w ; \\mathcal{D}_m)')
('1', 'w')
('1', '\\mathcal{D}_m')
('1', 'm \\in [M]')
('1', '\\lambda_m')
('1', 'm')
('1', '\\lambda_m=n_m/n')
('1', 'n_m=\\vert \\mathcal{D}_m \\vert')
('1', 'm')
('1', 'n = \\sum^M_{m=1} n_m')
('1', 't')
('1', 'p^t=(p^t_1,\\dots,p^t_M)^{\\top}')
('1', 'K')
('1', '[M]')
('1', 'S^t \\subseteq [M]')
('1', '|S^t| = K')
('1', 'w^t')
('1', 'm \\in S^t')
('1', 'm')
('1', 'g^t_m')
('1', 'g^t_m')
('1', 'S^t')
('1', '\\label{eq:grad-est}\ng^t = \\frac{1}{K} \\sum_{m \\in S^t} \\frac{\\lambda_m}{p^t_m} g^t_m,')
('1', 'w^t')
('1', 'g^t')
('1', 'w^{t+1} = w^t - \\mu^t g^t')
('1', '\\{\\mu^t\\}_{t\\geq 1}')
('1', 'p^t=p^{\\rm unif}=(1/M,\\dots,1/M)^{\\top}')
('1.0', '\\{p^t\\}_{t\\geq 1}')
('1.1', '\\mathbb{R}^M_{+}=[0,\\infty)^M')
('1.1', '\\mathbb{R}^M_{++}=(0,\\infty)^M')
('1.1', 'M \\in \\mathbb{N}^{+}')
('1.1', '\\mathcal{P}_{M-1} \\coloneqq \\{ x \\in \\mathbb{R}^M : \\sum^M_{i=1} x_i = 1 \\}')
('1.1', '(M-1)')
('1.1', 'p=(p_1,\\dots,p_M)^{\\top}')
('1.1', '[M] \\coloneqq \\{1,\\dots,M\\}')
('1.1', 'p^{1:T}')
('1.1', '\\{p^t\\}_{t=1}^T')
('1.1', '\\Phi:\\mathcal{D}\\subseteq\\mathbb{R}^M \\mapsto\\mathbb{R}')
('1.1', '\\mathcal{D}')
('1.1', '\\mathcal{D}')
('1.1', '\\bar{\\mathcal{D}}')
('1.1', '\\mathcal{D}')
('1.1', 'x,y \\in \\mathcal{D}')
('1.1', '\\Phi')
('1.1', 'D_{\\Phi} \\left(x \\,\\Vert\\, y\\right) = \\Phi (x) - \\Phi (y) - \\langle \\nabla \\Phi (y), x - y \\rangle')
('1.1', '\\Phi_e(x)=\\sum^M_{m=1} x_m \\log x_m - \\sum^M_{m=1}x_m')
('1.1', 'x=(x_1,\\dots,x_M)^{\\top} \\in \\mathcal{D}=\\mathbb{R}^M_{+}')
('1.1', '0\\log0')
('1.1', '0')
('1.1', '\\Vert \\cdot \\Vert_p')
('1.1', 'L_p')
('1.1', '1\\leq p \\leq \\infty')
('1.1', 'x \\in \\mathbb{R}^n')
('1.1', '\\Vert x \\Vert_p = ( \\sum^n_{i=1} x^p_i )^{1/p}')
('1.1', '1<p<\\infty')
('1.1', '\\Vert x \\Vert_1 = \\sum^n_{i=1} \\vert x_i \\vert')
('1.1', '\\Vert x \\Vert_{\\infty} = \\max_{1\\leq i \\leq n} \\vert x_i \\vert')
('1.1', 'L_p')
('1.1', '\\Vert \\cdot \\Vert')
('1.1', '\\Vert z \\Vert_{\\star} \\coloneqq \\sup \\{ z^{\\top}x : \\Vert x \\Vert \\leq 1  \\}')
('1.1', '|\\mathcal{B}|')
('1.1', '|\\mathcal{B}|')
('1.1', '\\{a_n\\}')
('1.1', '\\{b_n\\}')
('1.1', 'a_n=O(b_n)')
('1.1', 'a_n \\lesssim b_n')
('1.1', 'C>0')
('1.1', '|a_n/b_n| \\leq C')
('1.1', 'n')
('1.1', 'a_n=\\Theta (b_n)')
('1.1', 'a_n=O(b_n)')
('1.1', 'b_n=O(a_n)')
('1.1', 'a_n=\\tilde{O} (b_n)')
('1.1', 'a_n=O(b_n \\log^k b_n)')
('1.1', 'k\\geq 0')
('1.1', 'a_n=\\tilde{\\Theta} (b_n)')
('1.1', 'a_n=\\tilde{O} (b_n)')
('1.1', 'b_n=\\tilde{O} (a_n)')
('3.0', 't')
('3.0', 'p^t')
('3.0', 'S^t')
('3.0', 'K')
('3.0', '[M]')
('3.0', 'w^t')
('3.0', 'm \\in S^t')
('3.0', 'g^t_m')
('3.0', 'g^t_m=\\nabla \\phi(w^t;\\mathcal{D}_m)')
('3.0', 'g^t_m=(1/B)\\sum^B_{b=1}\\nabla \\phi ( w^t ; \\xi^{t,b}_m )')
('3.0', '\\xi^{t,b}_m \\overset{i.i.d.}{\\sim} \\mathcal{D}_m')
('3.0', 'B')
('3.0', 'g^t_m = w^t - w^{t.B}_m')
('3.0', 'w^{t,b}_m = w^{t,b-1}_m - \\mu^t_l \\nabla f \\left( w^{t,b-1}_m ; \\xi^{t,b-1}_m \\right)')
('3.0', 'b =0,\\ldots,B-1')
('3.0', 'w^{t,0}_m=w^t')
('3.0', '\\xi^{t,b}_m \\overset{i.i.d.}{\\sim} \\mathcal{D}_m')
('3.0', '\\mu^t_l')
('3.0', 't')
('3.0', 't')
('3.0', 'J^t = \\sum^M_{m=1} \\lambda_m g^t_m.')
('3.0', 'J^t')
('3.0', 'g^t')
('3.0', 'J^t')
('3.0', '\\mathbb{E}_{S^t}\\left[ g^t \\right]=J^t')
('3.0', 'S^t')
('3.0', 'g^t_m')
('3.0', 'g^t_m')
('3.0', 'g^t')
('3.0', '\\label{eq:var-grad-est}\n\\begin{aligned}\n\\mathbb{V}_{S^t}[g^t]\n= \\frac{1}{K} \\left( \\sum^M_{m=1} \\frac{\\lambda_m^2 \\Vert g^t_m \\Vert^2}{p^t_m} - \\left\\Vert J^t \\right\\Vert^2 \\right).\n\\end{aligned}')
('3.0', 'p^t')
('3.0', 'S^t')
('3.0', 'p^t')
('3.0', 'a^t_m=\\lambda^2_m \\Vert g^t_m \\Vert^2/c')
('3.0', 'c>0')
('3.0', '\\mathbb{E}[\\Vert g^t_m \\Vert^2]/c = \\Theta(1)')
('3.0', 'c=1')
('3.0', 'q = (q_1,\\dots,q_M)^{\\top}')
('3.0', 'l_t(\\cdot)')
('3.0', '\\phi(\\cdot)')
('3.0', '\\phi(\\cdot)')
('3.0', '\\label{eq:var-reduc-loss}\nl_t(q) = \\frac{1}{K} \\sum^M_{m=1} \\frac{a^t_m}{q_m}.')
('3.0', 'S^t')
('3.0', 'q')
('3.0', '\\mathbb{V}_{S^t}[g^t] = l_t(q) - \\frac{1}{K} \\left\\Vert J^t \\right\\Vert^2.')
('3.0', 'q^{1:T}')
('3.0', 'L(q^{1:T}) \\coloneqq \\sum^T_{t=1} l_t(q^t)')
('3.0', 'q^{1:T}')
('3.0', '\\bar{L} (q^{1:T})  \\coloneqq \\mathbb{E}\\left[ L(q^{1:T}) \\right]')
('3.0', 'F(\\cdot)')
('3.0', '\\nu')
('3.0', 'g^t_m=\\nabla \\phi(w^t;\\mathcal{D}_m)')
('3.0', '\\mu^t=2/(\\nu t)')
('3.0', 'T\\geq 1')
('3.0', '\\label{eq:thm3-salehi2017stochastic}\n\\mathbb{E} \\left[  F \\left( \\frac{2}{T(T+1)} \\sum^T_{t=1}t \\cdot w^t \\right) \\right] - F(w^{\\star}) \\leq \\frac{2}{\\nu T (T+1)} \\bar{L}(p^{1:T}),')
('3.0', 'w^{\\star}')
('3.0', 'p^{1:T}')
('3.0', '\\bar{L}(p^{1:T})')
('3.0', 'p^{1:T}')
('3.0', '\\bar{L}(p^{1:T})')
('3.0', 't')
('3.0', '\\{ a^t_m \\}^M_{m=1}')
('3.0', 'p^t_{\\star} = (p^t_{\\star,1}, \\dots, p^t_{\\star,M})^{\\top} = \\arg\\min_{p \\in \\mathcal{P}_{M-1}} l_t(p)')
('3.0', 'p^t_{\\star,m} = \\sqrt{a^t_m} / (\\sum^M_{m=1}\\sqrt{a^t_m})')
('3.0', 'p^t_{\\star}')
('3.0', 'p^t_{\\star}')
('3.0', 'a^t_m')
('3.0', '\\{ a^t_m \\}^M_{m=1}')
('3.0', 'p^1')
('3.0', 't')
('3.0', 'K')
('3.0', '[M]')
('3.0', 'S^t')
('3.0', 'p^t')
('3.0', '\\{a^t_m\\}_{m \\in S^t}')
('3.0', 'a^t_m=\\lambda^2_m \\Vert g^t_m \\Vert^2')
('3.0', 'l_t(p^t)')
('3.0', 'p^{t+1}')
('3.0', '\\{ \\{ a^u_m \\}_{m \\in S^u} \\}^t_{u=1}')
('3.0', '\\{ p^u \\}^t_{u=1}')
('3.0', 'p^t')
('3.0', '\\{a^t\\}_{t\\geq 1}')
('3.0', '\\{S^t\\}_{t\\geq1}')
('3.0', 'p^t')
('3.1', 'l_t')
('3.1', '\\mathcal{P}_{M-1}')
('3.1', '\\nabla l_t (q) = - \\frac{1}{K} \\left( \\frac{ a^t_1 }{ (q_1 )^2},\\dots,\\frac{ a^t_M }{ (q_M )^2} \\right)^{\\top} \\in \\mathbb{R}^M \\quad \\text{for all}\\quad q=(q_1,\\dots,q_M)^{\\top} \\in \\mathbb{R}^M_{++}.')
('3.1', 'a^t')
('3.1', 'l_t (\\cdot)')
('3.1', '\\nabla l_t (\\cdot)')
('3.1', 'q \\in \\mathcal{P}_{M-1}')
('3.1', '\\hat{l}_t (q ; p^t )')
('3.1', 'l_t (q)')
('3.1', '\\label{eq:est-loss}\n\\hat{l}_t (q ; p^t ) = \\frac{1}{K^2} \\sum^M_{m=1} \\frac{ a^t_m }{ q_m p^t_m } \\mathcal{N} \\left\\{ m \\in S^t \\right\\},')
('3.1', '\\nabla \\hat{l}_t (q ; p^t ) \\in \\mathbb{R}^M')
('3.1', 'm')
('3.1', '\\label{eq:est-grad}\n\\left[ \\nabla \\hat{l}_t (q ; p^t ) \\right]_m = - \\frac{1}{K^2} \\cdot \\frac{ a^t_m }{ q^2_m p^t_m } \\mathcal{N} \\left\\{ m \\in S^t \\right\\}.')
('3.1', 'S^t')
('3.1', '[M]')
('3.1', 'p^t')
('3.1', '\\mathcal{N} \\left\\{ m \\in S^t \\right\\}')
('3.1', 'm')
('3.1', 'S^t')
('3.1', '0 \\leq \\mathcal{N} \\left\\{ m \\in S^t \\right\\} \\leq K')
('3.1', 'q')
('3.1', 'p^t')
('3.1', '\\hat{l}_t (q;p^t)')
('3.1', '\\nabla \\hat{l}_t (q;p^t)')
('3.1', '\\mathbb{R}')
('3.1', '\\mathbb{R}^M')
('3.1', '\\begin{aligned}\n\\mathbb{E}_{S^t} \\left[ \\hat{l}_t (q ; p^t) \\mid p^t \\right] = l_t (q), \\qquad\n\\mathbb{E}_{S^t} \\left[ \\nabla \\hat{l}_t (q ; p^t) \\mid p^t \\right] = \\nabla l_t (q).\n\\end{aligned}')
('3.1', 'S^t')
('3.1', 'p^t \\in \\mathbb{R}^M_{++}')
('3.1', '\\hat{l}_t (q;p^t)')
('3.1', 'q')
('3.1', '\\mathbb{R}^{M}_{++}')
('3.1', '\\hat{l}_t (q;p^t)-\\hat{l}_t (q^{\\prime};p^t) \\leq \\langle \\nabla \\hat{l}_t (q;p^t),q - q^{\\prime}  \\rangle')
('3.1', 'q,q^{\\prime} \\in \\mathbb{R}^{M}_{++}')
('3.1', '\\hat{l}_t (q ; p^t)')
('3.1', '\\nabla \\hat{l}_t (q ; p^t )')
('3.1', '\\hat{l}_t (q ; p^t)')
('3.1', '\\nabla \\hat{l}_t (q ; p^t )')
('3.1', '\\{\\eta_t\\}_{t \\geq 1}')
('3.1', '\\alpha \\in (0,1]')
('3.1', '\\mathcal{A}=\\mathcal{P}_{M-1}\\cap[\\alpha/M,\\infty)^M')
('3.1', 'T')
('3.1', '\\hat{p}^{1:T}')
('3.1', '\\hat{p}^1=p^{\\rm unif}')
('3.1', '\\mathcal{A}=\\mathcal{P}_{M-1}\\cap[\\alpha/M,\\infty)^M')
('3.1', '\\alpha \\in (0,1]')
('3.1', '\\Phi:\\mathcal{D}\\subseteq\\mathbb{R}^M \\mapsto\\mathbb{R}')
('3.1', '\\mathcal{D}')
('3.1', '\\mathcal{A} \\subseteq \\bar{\\mathcal{D}}')
('3.1', '\\{\\eta_t\\}_{t \\geq 1}')
('3.1', 'S^t')
('3.1', '\\Phi(\\cdot)')
('3.1', '\\Phi_e(\\cdot)')
('3.1', '\\{ \\tilde{p}^{t+1}_m \\}^M_{m=1}')
('3.1', 'O(M\\log M)')
('3.1', 'p^t')
('3.1', '\\tilde{p}^{t+1}')
('3.1', 'p^t')
('3.1', '\\tilde{p}^{t+1}')
('3.1', '\\hat{p}^t')
('3.1', 'S^t')
('3.1', '\\{ a^t_m \\}_{m \\in S^t}')
('3.1', '\\mathcal{A}=\\mathcal{P}_{M-1}\\cap[\\alpha/M,\\infty)^M')
('3.1', '\\hat{p}^{t+1}')
('3.1', '\\tilde{p}^{t+1}_m = p^t_m \\exp \\left\\{ \\mathcal{N}\\left\\{ m \\in S^t \\right\\} \\eta_t a^t_m / (K^2 (p^t_m)^3)  \\right\\}')
('3.1', 'm \\in [M]')
('3.1', '\\{ \\tilde{p}^{t+1}_m \\}^M_{m=1}')
('3.1', '\\tilde{p}^{t+1}_{\\pi(1)}\\leq\\tilde{p}^{t+1}_{\\pi(2)}\\leq\\dots\\leq\\tilde{p}^{t+1}_{\\pi(M)}')
('3.1', 'v_m=\\tilde{p}^{t+1}_{\\pi(m)} \\left( 1 -  \\frac{m-1}{M} \\alpha \\right)')
('3.1', 'm \\in [M]')
('3.1', 'u_m=\\frac{\\alpha}{M} \\sum^M_{j=m} \\tilde{p}^{t+1}_{\\pi(j)}')
('3.1', 'm \\in [M]')
('3.1', 'm')
('3.1', 'v_m > u_m')
('3.1', 'm^t_{\\star}')
('3.1', '\\hat{p}^{t+1}_m =\n\\begin{cases}\n\\alpha / M & \\text{if } \\pi(m) < m^t_{\\star} \\\\\n\\left((1 - ((m^t_{\\star}-1) / M) \\alpha ) \\tilde{p}^{t+1}_{m}\\right)/\\left(\\sum^M_{j=m^t_{\\star}} \\tilde{p}^{t+1}_{\\pi(j)}\\right) & \\text{otherwise}.\n\\end{cases}')
('4', '\\{\\hat{p}\\}_{t\\geq1}')
('4', 'q^{1:T} \\in \\mathcal{P}_{M-1}^T')
('4', '\\label{eq:dynamic-regret}\n\\text{D-Regret}_T (q^{1:T}) = \\bar{L} \\left( \\hat{p}^{1:T} \\right) - \\bar{L} \\left( q^{1:T} \\right).')
('4', 'q^1=\\dots=q^T')
('4', 'q^1=\\dots=q^T=q')
('4', '\\text{D-Regret}_T(q)')
('4', 'q^{1:T}')
('4', '\\Vert \\cdot \\Vert')
('4', '\\mathbb{R}^M')
('4', '\\text{TV} \\left( q^{1:T} \\right) = \\sum^{T-1}_{t=1} \\Vert q^{t+1} - q^t \\Vert')
('4', '\\text{TV} ( q^{1:T} )')
('4', 'q^{1:T}')
('4', '\\Phi(\\cdot)')
('4', '\\rho')
('4', '\\rho > 0')
('4', '\\Vert \\cdot \\Vert')
('4', '\\Phi (x) \\geq \\Phi (y) + \\langle \\nabla \\Phi (y), x - y \\rangle + \\frac{\\rho}{2} \\Vert x - y \\Vert^2, \\ \\ x,y \\in \\mathcal{D}.')
('4', 'H(M,\\alpha)')
('4', '\\{Q_t(M,\\alpha)\\}_{t\\geq1}')
('4', 'D_{\\max}(M,\\alpha)')
('4', '\\Vert \\nabla \\Phi(p) \\Vert_{\\star} \\leq H(M,\\alpha)')
('4', '\\Vert \\nabla \\hat{l}_t ( p ; q ) \\Vert_{\\star} \\leq Q_t(M,\\alpha)')
('4', 'D_{\\Phi}(q \\,\\Vert\\, p^{\\rm unif}) \\leq D_{\\max}(M,\\alpha)')
('4', 'p,q \\in \\mathcal{A}')
('4', '\\Phi=\\Phi_e')
('4', '\\Vert \\cdot \\Vert = \\Vert \\cdot \\Vert_1')
('4', 'D_{\\Phi} \\left(x \\,\\Vert\\, y\\right) \\geq (\\rho^2/2) \\Vert x - y \\Vert^2')
('4', 'M')
('4', '\\alpha')
('4', 'H')
('4', '\\{Q_t\\}_{t\\geq 1}')
('4', 'D_{\\max}')
('4', 'q^t')
('4', '\\mathcal{A}')
('4', 'q^t \\in \\mathcal{P}_{M-1}')
('4', '\\alpha \\in (0,1]')
('4', '\\begin{gathered}\n\\label{eq:def-psi-alpha}\n\\psi(q^t, \\alpha) \\coloneqq \\sum^M_{m=1} \\left( \\frac{\\alpha}{M} - q^t_m \\right)  \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\},\n\\qquad\n\\omega(q^t, \\alpha)  \\coloneqq \\frac{ \\sum^M_{m=1} \\left( \\frac{\\alpha}{M} - q^t_m \\right)  \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} }{ \\sum^M_{m=1} \\left( q^t_m - \\frac{\\alpha}{M} \\right) \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} }, \\\\\n\\phi(q^t, \\alpha) \\coloneqq \\frac{ \\omega(q^t, \\alpha) }{ 1 - \\omega(q^t, \\alpha) \\left( 1 - \\frac{\\alpha}{M} \\right)  }.\n\\end{gathered}')
('4', '\\Vert \\cdot \\Vert=\\Vert \\cdot \\Vert_1')
('4', '\\{\\eta_t\\}_{t \\geq 1}')
('4', '\\hat{p}^{1:T}')
('4', 'q^{1:T}')
('4', 'q^t')
('4', '\\begin{gathered}\n\\text{D-Regret}_T (q^{1:T}) \n\\leq \\underbrace{\\frac{ D_{\\max} }{\\eta_1} + \\frac{2H}{\\eta_T} \\mathbb{E}\\left[  \\text{TV} \\left( q^{1:T} \\right) \\right] + \\frac{2 }{\\rho} \\sum^T_{t=1} \\eta_t \\mathbb{E}\\left[ Q^2_t \\right] }_{\\text{Intrinsic Regret}} +\\\\ \\underbrace{ \\frac{8H}{\\eta_T} \\sum^T_{t=1} \\mathbb{E}\\left[ \\psi(q^t, \\alpha) \\right] + \\sum^T_{t=1} \\mathbb{E}\\left[\\phi(q^t, \\alpha) l_t (q^t) \\right] }_{\\text{Projection Error}}.\n\\end{gathered}')
('4', 'q^{1:T}')
('4', '\\mathcal{A}^T')
('4', '\\mathcal{A}^T')
('4', '\\mathcal{A}^T')
('4', '\\alpha')
('4', 'D_{\\max}')
('4', 'H')
('4', '\\{Q_t\\}_{t\\geq 1}')
('4', '0 \\leq \\omega(q^t, \\alpha) \\leq 1')
('4', '\\alpha \\in [0,1]')
('4', '\\phi(q^t, \\alpha) \\leq M / \\alpha')
('4', '\\psi(q^t, \\alpha) \\leq \\sum^M_{m=1} (\\alpha/M) \\mathds{1} \\left\\{ q^t_m < (\\alpha/M) \\right\\} \\leq \\alpha.')
('4', '(8H\\alpha)/\\eta_T + (M/\\alpha) \\sum^T_{t=1} l_t (q^t)')
('4', 'q^t_m \\in \\mathcal{A}')
('4', '\\psi(q^t, \\alpha)=\\omega(q^t, \\alpha)=\\phi(q^t, \\alpha)=0')
('4', '\\mathcal{A}^T')
('4', '\\alpha')
('4', '\\mathcal{A}')
('4', '\\mathcal{P}_{M-1}')
('4', '\\alpha')
('4', '\\alpha')
('4', '\\Vert \\cdot \\Vert = \\Vert \\cdot \\Vert_1')
('4', '\\Phi')
('4', '\\Phi_e(x)')
('4', '1')
('4', '\\mathcal{P}_{M-1}')
('4', '\\Vert \\cdot \\Vert_1')
('4', 'q^{1:T}')
('4', '\\mathbb{E}\\left[  \\text{TV} \\left( q^{1:T} \\right) \\right]=\\text{TV} \\left( q^{1:T} \\right)')
('4', '\\hat{p}^{1:T}')
('4', 'q^{1:T}')
('4', '\\alpha')
('4', 'q^t\\in\\mathcal{A}')
('4', 't \\in [T]')
('4', '\\label{eq:eta-choice-meta-pre}\n\\eta = \\frac{ K^2 \\alpha^3 }{ M^3 } \\sqrt{ \\frac{ \\log M + 2 \\log (M / \\alpha) \\mathbb{E} \\left[ \\text{TV} \\left( q^{1:T} \\right) \\right] }{ 2 \\sum^T_{t=1} \\mathbb{E} \\left[ (\\bar{a}^t)^2 \\right] } }.')
('4', '\\text{D-Regret}_T (q^{1:T}) \\leq \n\\frac{ 2 \\sqrt{2} M^3 }{ K^2 \\alpha^3 } \\sqrt{ \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( q^{1:T} \\right) \\right]  \\right] \\sum^T_{t=1} \\mathbb{E} \\left[ \\left( \\bar{a}^t \\right)^2 \\right] },')
('4', '\\bar{a}^t \\coloneqq \\max_{1\\leq m \\leq M} \\lambda^2_m \\Vert g^t_m \\Vert^2  = \\max_{1\\leq m \\leq M} a^t_m')
('4', 't \\in [T]')
('4', '\\{ \\bar{a}^t \\}^T_{t=1}')
('4', '\\sum^T_{t=1} \\mathbb{E} [ (\\bar{a}^t)^2 ]=O(T)')
('4', '\\bar{a}^t')
('4', '\\sum^T_{t=1} \\mathbb{E} [ (\\bar{a}^t)^2 ]=O(1)')
('4', 'TV(q^{1:T})=0')
('4', 'O(1)')
('4', 'TV(q^{1:T})>0')
('5.0', '\\alpha')
('5.0', '\\{\\eta^t\\}_{t \\geq 1}')
('5.0', '\\alpha')
('5.0', '\\{\\eta_t\\}_{t\\geq1}')
('5.0', '\\sum^T_{t=1} \\mathbb{E} \\left[ (\\bar{a}^t)^2 \\right]')
('5.0', '\\hat{p}^{1:T}')
('5.0', '\\alpha')
('5.0', 'p^t_{\\star}\\in\\mathcal{A}')
('5.0', 't \\in [T]')
('5.0', '\\label{eq:eta-choice-meta-pre-2}\n\\eta = \\frac{ K^2 \\alpha^3 }{ M^3 \\sqrt{\\mathbb{E}\\left[ (\\bar{a}^1)^2\\right]} } \\sqrt{ \\frac{ \\log M + 2 \\log (M / \\alpha) \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right] }{ 2 T  } }.')
('5.0', '\\label{eq:regret-meta-pre}\n\\text{D-Regret}_T (p^{1:T}_{\\star}) \\leq \n\\frac{ 2 \\sqrt{2} M^3 \\sqrt{\\mathbb{E}\\left[ (\\bar{a}^1)^2\\right]} }{ K^2 \\alpha^3 } \\sqrt{ \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right]  \\right] T },')
('5.0', '\\bar{a}^t \\coloneqq \\max_{1\\leq m \\leq M} a^t_m = \\max_{1\\leq m \\leq M} \\lambda^2_m \\Vert g^t_m \\Vert^2')
('5.0', '\\mathbb{E} [\\bar{a}^1]')
('5.0', '\\mathbb{E}[\\text{TV} ( p^{1:T}_{\\star} )]')
('5.0', 'T')
('5.0', '\\mathbb{E} [\\bar{a}^1]')
('5.0', 'w^0')
('5.0', '\\Vert g^0_m \\Vert^2')
('5.0', 'S^0')
('5.0', '\\hat{\\bar{a}}^1 \\coloneqq \\max_{m \\in S^0} \\lambda_m \\Vert g^0_m \\Vert^2')
('5.0', '\\mathbb{E}[\\text{TV} ( p^{1:T}_{\\star} )]')
('5.0', 'T')
('5.0', '\\mathbb{E}[\\text{TV} ( p^{1:T}_{\\star} )]')
('5.0', 'T')
('5.0', '\\label{eq:expert-rates-set}\n\\mathcal{E} \\coloneqq \\left\\{ \\left.  2^{e-1} \\cdot \\frac{K^2 \\alpha^3 }{ M^3  \\sqrt{\\mathbb{E}\\left[ (\\bar{a}^1)^2\\right]}  } \\sqrt{ \\frac{\\log M}{2 T  } } \\, \\right\\vert \\, e=1,2,\\dots,E \\right\\},')
('5.0', '\\label{eq:expert-rates-set-length}\nE = \\floor{ \\frac{1}{2} \\log_2 \\left( 1 + \\frac{4 \\log (M/\\alpha)}{\\log M}(T-1) \\right)  } + 1.')
('5.0', '\\eta_e \\in \\mathcal{E}')
('5.0', '\\hat{p}^{1:T}_e')
('5.0', '\\{\\hat{p}^{1:T}_e\\}^E_{e=1}')
('5.0', '\\hat{p}^{1:T}')
('5.0', '\\hat{l}_t (\\hat{p}^t_e ; \\hat{p}^t)')
('5.0', '\\nabla \\hat{l}_t (\\hat{p}^t_e ; \\hat{p}^t)')
('5.0', 'T \\vert \\mathcal{E} \\vert=T \\floor{\\log_2 T}')
('5.0', '\\log(T)')
('5.0', '\\Phi=\\Phi_e')
('5.0', '\\Vert \\cdot \\Vert=\\Vert \\cdot \\Vert_1')
('5.0', '\\alpha')
('5.0', 'p^{t}_{\\star} \\in \\mathcal{A}')
('5.0', 't\\in[T]')
('5.0', '\\hat{p}^{1:T}')
('5.0', '\\gamma=\\frac{\\alpha}{M}\\sqrt{\\frac{8 K}{T \\mathbb{E}[\\bar{a}^1]}}')
('5.0', 'p^{\\text{init}}=p^{\\rm unif}')
('5.0', '\\mathcal{E}')
('5.0', '\\begin{gathered}\n\\text{D-Regret}_T \\leq \n\\frac{ 3 \\sqrt{2} M^3 \\sqrt{\\mathbb{E} \\left[(\\bar{a}^1)^2\\right]} }{ K^2 \\alpha^3 } \\sqrt{ T \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[\\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right] \\right] } \\\\\n+ \\frac{M}{\\alpha} \\sqrt{ \\frac{T \\mathbb{E}\\left[\\bar{a}^1\\right] }{ 8 K } } \\left( 1 + 2 \\log E \\right).\n\\end{gathered}')
('5.0', '\\tilde{O}( (M/\\alpha) \\sqrt{ T/K } )')
('5.0', '\\mathbb{E} [\\text{TV} ( p^{1:T}_{\\star} )]')
('5.0', '\\gamma')
('5.0', '\\mathcal{E} = \\{\\eta_1 \\leq \\eta_2 \\leq \\dots \\leq \\eta_E \\}')
('5.0', 'E=\\vert \\mathcal{E} \\vert')
('5.0', '\\alpha \\in (0,1]')
('5.0', '\\mathcal{A}=\\mathcal{P}_{M-1}\\cap[\\alpha/M,\\infty)^M')
('5.0', 'T')
('5.0', 'p^{\\text{init}}')
('5.0', '\\hat{p}^{1:T}')
('5.0', '\\theta^1_e = (1 + 1/E) / (e(e+1))')
('5.0', '\\hat{p}^1_e=p^{\\text{init}}')
('5.0', 'e\\in[E]')
('5.1', 'T')
('5.1', 'T_b=2^{b-1}')
('5.1', 'b\\geq1')
('5.1', '\\gamma')
('5.1', '\\bar{a}^{T_b}')
('5.1', 'T_b')
('5.1', '\\label{eq:doub-trick-set}\n\\mathcal{E}_b \\coloneqq \\left\\{ \\left.  2^{e-\\frac{b}{2}-1} \\cdot \\frac{K^2 \\alpha^3 \\sqrt{ \\log M } }{ M^3  \\hat{a}^b  }  \\, \\right\\vert \\, e=1,2,\\dots,E_b \\right\\},')
('5.1', '\\label{eq:doub-trick-set-length}\nE_b = \\floor{ \\frac{1}{2} \\log_2 \\left( 1 + \\frac{4 \\log (M/\\alpha)}{\\log M}( 2^{b-1} - 1) \\right)  } + 1,')
('5.1', '\\gamma_b=\\frac{\\alpha}{M}\\sqrt{\\frac{8 K}{2^{b-1} \\hat{a}^b}}')
('5.1', 'b\\geq 1')
('5.1', '\\hat{\\bar{a}}^{T_b}=\\max_{m \\in S^{T_b-1}} a^{T_b-1}_m')
('5.1', 't=T_b')
('5.1', 't=T_b-1')
('5.1', 'a^0')
('5.1', 'w^0')
('5.1', '\\Vert g^0_m \\Vert^2')
('5.1', 'S^0')
('5.1', '\\hat{\\bar{a}}^1 \\coloneqq \\max_{m \\in S^0} a^0_m')
('5.1', 'a^0_m=\\lambda_m \\Vert g^0_m \\Vert^2')
('5.1', 'O(T \\vert \\mathcal{E} \\vert^2)=O(T \\floor{\\log_2 T})')
('5.1', '\\log(T)')
('5.1', '\\Phi=\\Phi_e')
('5.1', '\\Vert \\cdot \\Vert=\\Vert \\cdot \\Vert_1')
('5.1', '\\alpha')
('5.1', 'p^{1:T}_{\\star} \\in \\mathcal{A}^T')
('5.1', 'T')
('5.1', 'C>1')
('5.1', '\\hat{\\bar{a}}^{T_b} \\leq C \\bar{a}^{T_b}')
('5.1', 'b=1,2,\\dots,B')
('5.1', 'B=\\floor{\\log_2 (T+1)}')
('5.1', '\\hat{p}^{1:T}')
('5.1', 'p^{\\rm unif}')
('5.1', '\\begin{gathered}\n\\text{D-Regret}_T \\\\\n\\leq \\frac{\\sqrt{2(T+1)}}{\\sqrt{2}-1} \\left\\{ \\frac{ (2C+1) \\sqrt{2} M^3 \\sqrt{\\mathbb{E} \\left[(\\bar{a}^1)^2\\right]} }{ K^2 \\alpha^3 } \\sqrt{  \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[\\text{TV} \\left( p^{1:T}_{\\star} \\right] \\right) } \n+ \\right. \\\\\n\\left.\\frac{M}{\\alpha} \\sqrt{ \\frac{ \\mathbb{E}\\left[\\bar{a}^1\\right] }{ 8 K } } (C + 2 \\log E )  \\right\\}.\n\\end{gathered}')
('5.1', '\\mathbb{E} \\left[\\text{TV} ( p^{1:T}_{\\star} )\\right]')
('5.1', 'T')
('5.1', '\\alpha')
('5.1', '\\hat{p}^t')
('5.1', 't=1,\\dots,T')
('5.1', 'w^0')
('5.1', '\\{ a^0_m \\}_{ m \\in S^0 }')
('5.1', 'S^0')
('5.1', '\\hat{\\bar{a}}^1 = \\max_{m \\in S^0} a^0_m')
('5.1', 'b=1')
('5.2', 'w^1')
('5.2', '\\hat{p}^1')
('5.2', 'S^t=\\{m^t_1,\\cdots,m^t_K\\}')
('5.2', 'w^t')
('5.2', 'S^t')
('5.2', 'S^t')
('5.2', '\\left\\{g^t_{m^t_1},\\cdots,g^t_{m^t_K}\\right\\}')
('5.2', 'g^t_{(1)} = \\lambda^t_{m^t_1} g^t_{m^t_1}/\\hat{p}^{t}_{(1),m^t_1}')
('5.2', '\\tilde{g}^t = K^{-1} \\sum^K_{k=1} g^t_{(k)}')
('5.2', 'w^{t+1}')
('5.2', 'w^{t}')
('5.2', '\\tilde{g}^t')
('5.2', 'a^t_m=\\lambda^2_m \\Vert g^t_m \\Vert^2')
('5.2', 'm \\in S^t')
('5.2', '\\{a^t_m\\}_{m \\in S^t}')
('5.2', '\\hat{p}^{t+1}')
('5.2', 'S^t')
('5.2', 'p^t')
('5.2', 'K')
('5.2', 'M')
('5.2', 'p^t')
('5.2', 'p^t')
('5.2', '\\hat{p}^t=p')
('5.2', '\\tilde{g}^t')
('5.2', '\\tilde{g}^t = \\tilde{g}^t(p)')
('5.2', 'p')
('5.2', 'J^t=\\sum^M_{m=1}\\lambda_m g^t_m')
('5.2', '\\mathbb{E}_{S^t}\\left[ \\tilde{g}^t \\right] = J^t\n\\qquad \n\\text{and}\n\\qquad\n\\arg\\min_{p \\in \\mathcal{P}_{M-1}} \\mathbb{E}_{S^t}\\left[ \\Vert \\tilde{g}^t - J^t \\Vert^2_2 \\right] = \\arg\\min_{p \\in \\mathcal{P}_{M-1}} l_t(p),')
('5.2', 'l_t(\\cdot)')
('5.2', 'S^t')
('5.2', '\\tilde{g}^t')
('5.2', '\\tilde{g}^t')
('5.2', '\\tilde{g}^t')
('6', 'F_m(w)\\coloneqq \\phi \\left( w  ;  \\mathcal{D}_m \\right)')
('6', '\\lambda_m=1/M')
('6', 'm \\in [M]')
('6', 'L')
('6', 'm \\in [M]')
('6', 'F_m(\\cdot)')
('6', 'L')
('6', '\\left\\Vert \\nabla F_m(x) - \\nabla F_m(y) \\right\\Vert \\leq L \\Vert x - y \\Vert, \\quad \\text{ for all } x,y \\in \\mathbb{R}^d.')
('6', 'F_m(\\cdot)')
('6', 'F(\\cdot)')
('6', '\\inf_{w \\in } F(w) > -\\infty')
('6', 'F^{\\star} \\coloneqq \\inf_{w } F(w)')
('6', 'w')
('6', 'm \\in [M]')
('6', '\\mathbb{E}_{\\xi \\sim \\mathcal{D}_m} \\left[ \\nabla \\phi ( w ; \\xi )  \\right] = \\nabla F_m (w)')
('6', '\\mathbb{E}_{\\xi \\sim \\mathcal{D}_m} \\left[ \\left\\Vert \\nabla \\phi ( w ; \\xi ) - \\nabla F_m (w) \\right\\Vert^2  \\right] \\leq \\sigma^2')
('6', '\\label{eq:def-hetero}\n\\begin{aligned}\n\\zeta^2_0 &\\coloneqq \\sup_{w } \\frac{1}{M} \\sum^M_{m=1} \\Vert \\nabla F_m(w) - \\nabla F(w) \\Vert^2 = \\sup_{w } \\left\\{ \\frac{1}{M} \\sum^M_{m=1} \\Vert \\nabla F_m(w)  \\Vert^2 - \\Vert \\nabla F(w) \\Vert^2 \\right\\}, \\\\\n\\zeta^2_1 & \\coloneqq \\min_{p \\in \\mathcal{P}_{M-1}} \\sup_{w } \\left\\{ \\frac{1}{M^2} \\sum^M_{m=1} \\frac{1}{p_m} \\Vert \\nabla F_m(w)  \\Vert^2 - \\Vert \\nabla F(w) \\Vert^2 \\right\\}, \\\\\n\\zeta^2_2 & \\coloneqq \\sup_{w } \\left\\{ \\left( \\frac{1}{M} \\sum^M_{m=1}  \\Vert \\nabla F_m(w)  \\Vert \\right)^2 - \\Vert \\nabla F(w) \\Vert^2 \\right\\}.\n\\end{aligned}')
('6', '\\zeta_0')
('6', '\\zeta_1')
('6', '\\zeta_2')
('6', '\\zeta_0')
('6', '\\tilde{m}')
('6', '[M]')
('6', '\\mathbb{P}\\{\\tilde{m}=m\\}=p_m')
('6', 'm\\in [M]')
('6', '\\nabla F(w)')
('6', '\\nabla F_{\\tilde{m}}(w) / (M \\tilde{p}_m)')
('6', '\\zeta^2(w) \\coloneqq \\mathbb{E}_{\\tilde{m}} \\left[ \\left\\Vert \\frac{1}{M p_{\\tilde{m}}} \\nabla F_{\\tilde{m}}(w) - \\nabla F(w)  \\right\\Vert^2 \\right],')
('6', '\\mathbb{E}_{\\tilde{m}}[\\cdot]')
('6', '\\tilde{m}')
('6', '\\zeta^2(w)')
('6', 'w')
('6', '\\tilde{m}')
('6', '\\tilde{m}')
('6', '\\zeta^2_0=\\sup_{w} \\zeta^2(w)')
('6', '\\sup_{w} \\zeta^2(w)')
('6', '\\label{eq:best-fix-prob}\nq^{\\star} = \\text{argmin}_{p \\in \\mathcal{P}_{M-1}} \\sup_{w}  \\sum^M_{m=1} (1/ p_m) \\Vert \\nabla F_m(w)  \\Vert^2,')
('6', '\\tilde{m}')
('6', 'q^{\\star}')
('6', '\\zeta^2_1=\\sup_{w} \\zeta^2(w)')
('6', 'q^{\\star}')
('6', 'w')
('6', 'w')
('6', '\\zeta^2(w)')
('6', 'p^{\\star}(w)')
('6', 'p^{\\star}_m(w) \\coloneqq \\Vert \\nabla F_m (w) \\Vert / (\\sum^M_{m^{\\prime}=1} \\Vert \\nabla F_{m^{\\prime}} (w) \\Vert)')
('6', 'm=1,\\ldots,M')
('6', 'p^{\\star}_m(w)')
('6', '\\tilde{m}')
('6', '\\zeta^2_2=\\sup_{w} \\zeta^2(w)')
('6.0', 'T')
('6.0', 'K')
('6.0', 'B')
('6.0', 'w^0')
('6.0', '\\{ \\mu^t \\}^{T-1}_{t=0}')
('6.0', 'w^T')
('6.0', '\\hat{p}^0=p^{\\rm unif}')
('6.0', 'B')
('6.0', 'K=\\vert S^t \\vert')
('6.0', 'D^F \\coloneqq F(w^0)-F^{\\star}')
('6.0', '\\text{D-Regret}(q^{1:T})')
('6.0', 'q^{1:T}')
('6.0', '\\begin{aligned}\nR^{\\text{MB}}_0 & \\coloneqq \\frac{D^F L}{T} + \\frac{ \\sigma \\sqrt{D^F L} }{ \\sqrt{TKB } } + \\frac{\\zeta_0 \\sqrt{D^F L }}{\\sqrt{T K}}, \\\\\nR^{\\text{MB}}_1 & \\coloneqq \\frac{D^F L}{T} + \\frac{ \\sigma \\sqrt{D^F L} }{ \\sqrt{TKB \\alpha } } + \\frac{\\zeta_1 \\sqrt{D^F L }}{\\sqrt{T K}} + \\frac{ \\sqrt{ D^F L} \\sqrt{ \\text{D-Regret}_T(q^{\\star})) } }{ T }, \\\\\nR^{\\text{MB}}_2 & \\coloneqq \\frac{D^F L}{T} + \\frac{ \\sigma \\sqrt{D^F L} }{ \\sqrt{TKB \\alpha } } + \\frac{\\zeta_2 \\sqrt{D^F L }}{\\sqrt{T K}} + \\frac{ \\sqrt{ D^F L} \\sqrt{ \\text{D-Regret}_T(p^{1:T}_{\\star})) } }{ T }.\n\\end{aligned}')
('6.0', '\\{w^0,\\ldots,w^{T-1}\\}')
('6.0', 'w^R')
('6.0', 'q^{\\star} \\in \\mathcal{A}')
('6.0', '\\mu_t=\\mu')
('6.0', 't \\in [T]')
('6.0', '\\begin{aligned}\n     \\mu=\\min \\left\\{\\frac{1}{L},\\frac{1}{\\sigma}\\sqrt{\\frac{D^F K B \\alpha}{LT}},\\frac{1}{\\zeta_1}\\sqrt{\\frac{D^F K}{LT}},\\sqrt{\\frac{D^F}{L \\text{D-Regret}_T(q^{\\star})}}\\right\\},   \n    \n\\end{aligned}')
('6.0', '\\mathbb{E}\\left[ \\left\\Vert \\nabla F(w^R) \\right\\Vert^2 \\right] \\lesssim R^{\\text{MB}}_1')
('6.0', 'p^t_{\\star}\\in\\mathcal{A}')
('6.0', 't \\in [T]')
('6.0', '\\mu_t=\\mu')
('6.0', 't \\in [T]')
('6.0', '\\begin{aligned}\n     \\mu=\\min \\left\\{\\frac{1}{L},\\frac{1}{\\sigma}\\sqrt{\\frac{D^F K B \\alpha}{LT}},\\frac{1}{\\zeta_1}\\sqrt{\\frac{D^F K}{LT}},\\sqrt{\\frac{D^F}{L \\text{D-Regret}_T(p^{1::T}_{\\star})}}\\right\\},   \n    \n\\end{aligned}')
('6.0', '\\mathbb{E}\\left[ \\left\\Vert \\nabla F(w^R) \\right\\Vert^2 \\right] \\lesssim R^{\\text{MB}}_2')
('6.0', 'q^{\\star} \\in \\mathcal{A}')
('6.0', 'p^t_{\\star}\\in\\mathcal{A}')
('6.0', '\\mu_t=\\mu')
('6.0', 't \\in [T]')
('6.0', '\\mu')
('6.0', '\\mathbb{E}\\left[ \\left\\Vert \\nabla F(w^R) \\right\\Vert^2 \\right] \\lesssim \\min \\{R^{\\text{MB}}_1, R^{\\text{MB}}_2\\}')
('6.0', '\\tilde{S}^t')
('6.0', '\\tilde{S}^t')
('6.0', '\\tilde{S}^t')
('6.0', 'R^{\\text{MB}}_1')
('6.0', 'R^{\\text{MB}}_2')
('6.0', '\\alpha')
('6.0', '\\mathcal{A}')
('6.0', 'R^{\\text{MB}}_1')
('6.0', 'q^{\\star}')
('6.0', 'R^{\\text{MB}}_2')
('6.0', 'p^{1:T}_{\\star}')
('6.0', '\\mathcal{A}')
('6.0', '\\alpha')
('6.0', 'R^{\\text{MB}}_0')
('6.0', 'R^{\\text{MB}}_1')
('6.0', 'R^{\\text{MB}}_2')
('6.0', 'R^{\\text{MB}}_0')
('6.0', 'R^{\\text{MB}}_1 \\lesssim R^{\\text{MB}}_0')
('6.0', '(\\sigma/\\sqrt{K B})(1/\\sqrt{\\alpha}-1) + \\sqrt{\\text{D-Regret}_T(q^{\\star}) /T } \\lesssim (1/\\sqrt{K})(\\zeta_0-\\zeta_1).')
('6.0', '\\text{D-Regret}_T(q^{\\star})')
('6.0', 'O(\\sqrt{T})')
('6.0', '\\sum^T_{t=1}\\mathbb{E} [ (\\bar{a}^t)^2 ]=O(1)')
('6.0', '\\text{D-Regret}_T(q^{\\star})')
('6.0', 'O(1)')
('6.0', '\\text{D-Regret}_T(q^{\\star})/T=o(1)')
('6.0', 'R^{\\text{MB}}_1 \\lesssim R^{\\text{MB}}_0')
('6.0', '(\\sigma/\\sqrt{B})(1/\\sqrt{\\alpha}-1) \\ll \\zeta_0 - \\zeta_1')
('6.0', '(\\sigma/\\sqrt{B})(1/\\sqrt{\\alpha}-1)')
('6.0', '\\sigma=0')
('6.0', 'R^{\\text{MB}}_2 \\lesssim R^{\\text{MB}}_0')
('6.0', '(\\sigma/\\sqrt{K B})(1/\\sqrt{\\alpha}-1) + \\sqrt{\\text{D-Regret}_T(p^{\\star}_{\\star}) /T } \\lesssim (1/\\sqrt{K})(\\zeta_0-\\zeta_2).')
('6.0', '\\sum^T_{t=1}\\mathbb{E} [ (\\bar{a}^t)^2 ]=O(1)')
('6.0', '\\text{D-Regret}_T(p^{1:T}_{\\star})')
('6.0', 'O(\\sqrt{T})')
('6.0', '(\\sigma/\\sqrt{B})(1/\\sqrt{\\alpha}-1) \\ll \\zeta_0 - \\zeta_2')
('6.0', '(\\sigma/\\sqrt{B})(1/\\sqrt{\\alpha}-1)')
('6.0', '\\sigma=0')
('6.0', '\\Delta \\zeta_i = \\zeta_0-\\zeta_i')
('6.0', 'i=1,2')
('6.0', '\\Delta \\zeta_i')
('6.0', 'i=1,2')
('6.0', '\\zeta_0')
('6.0', '\\Delta \\zeta_1')
('6.0', '\\Delta \\zeta_2')
('6.1', 'T')
('6.1', 'K')
('6.1', 'B')
('6.1', 'w^0')
('6.1', '\\{ \\mu^t \\}^{T-1}_{t=0}')
('6.1', '\\{ \\mu^t_l \\}^{T-1}_{t=0}')
('6.1', 'w^T')
('6.1', '\\hat{p}^0=p^{\\rm unif}')
('6.1', 'a^t_m')
('6.1', '\\Vert g^t_m \\Vert^2')
('6.1', '(\\mu^t_l)^2 B')
('6.1', '\\mathbb{E}[\\Vert g^t_m \\Vert^2/(\\mu^t_l)^2 B]=\\Theta(1)')
('6.1', '\\mu^t_l \\to 0')
('6.1', 'B \\to \\infty')
('6.1', 'B')
('6.1', 'K=\\vert S^t \\vert')
('6.1', 'D^F \\coloneqq F(w^0)-F^{\\star}')
('6.1', '\\begin{aligned}\nR^{\\text{Avg}}_0 & \\coloneqq \\frac{D^F L }{T} + \\frac{  (D^F L)^{\\frac{2}{3}} \\zeta^{\\frac{2}{3}}_0  }{ T^{\\frac{2}{3}} } + \\frac{  (D^F L)^{\\frac{2}{3}}  \\sigma^{\\frac{2}{3}}  }{ B^{\\frac{1}{3}} T^{\\frac{2}{3}} }+ \\frac{ \\sqrt{ D^F L }\\zeta_0 }{ \\sqrt{T K} } + \\frac{ \\sqrt{ D^F L } \\sigma  }{ \\sqrt{ T K B } }, \\\\\nR^{\\text{Avg}}_1 & \\coloneqq \\frac{D^F L \\sqrt{1 + \\frac{1}{2 \\alpha}}}{T} + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F L)^{\\frac{2}{3}} \\zeta^{\\frac{2}{3}}_0  }{ T^{\\frac{2}{3}} } + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F L)^{\\frac{2}{3}}  \\sigma^{\\frac{2}{3}}  }{ B^{\\frac{1}{3}} T^{\\frac{2}{3}} } \\\\\n& \\quad + \\frac{ \\sqrt{ D^F L }\\zeta_1 }{ \\sqrt{T K} } + \\frac{ \\sqrt{ D^F L } \\sigma  }{ \\sqrt{ T K B \\alpha } } + \\frac{ \\sqrt{D^F L } }{ B \\sqrt{T} } \\sqrt{ \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{T}  }, \\\\\nR^{\\text{Avg}}_2 & \\coloneqq \\frac{D^F L \\sqrt{1 + \\frac{1}{2 \\alpha}}}{T} + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F L)^{\\frac{2}{3}} \\zeta^{\\frac{2}{3}}_0  }{ T^{\\frac{2}{3}} } + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F L)^{\\frac{2}{3}}  \\sigma^{\\frac{2}{3}}  }{ B^{\\frac{1}{3}} T^{\\frac{2}{3}} } \\\\\n& \\quad + \\frac{ \\sqrt{ D^F L }\\zeta_2 }{ \\sqrt{T K} } + \\frac{ \\sqrt{ D^F L } \\sigma  }{ \\sqrt{ T K B \\alpha } } + \\frac{ \\sqrt{D^F L } }{ B \\sqrt{T} } \\sqrt{ \\frac{ \\text{D-Regret}_T \\left( p^{1:T}_{\\star} \\right) }{T}  }.\n\\end{aligned}')
('6.1', '\\{w^0,\\ldots,w^{T-1}\\}')
('6.1', 'w^R')
('6.1', 'q^{\\star} \\in \\mathcal{A}')
('6.1', '\\mu^t=\\mu')
('6.1', '\\mu^t_l=\\mu_l')
('6.1', 't')
('6.1', '\\mu \\geq 1')
('6.1', '\\begin{gathered}\n    \\mu_l = \\min \\left\\{ \\frac{1}{4 \\mu B L} \\sqrt{\\frac{1}{1+1/(2\\alpha)}},  \\frac{(D^F)^{\\frac{1}{3}}}{  \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} \\mu B L^{\\frac{2}{3}} \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right)^{\\frac{1}{3}} T^{\\frac{1}{3}} }, \\right.\\\\ \n    \\left. \\frac{ \\sqrt{ 2 D^F }  }{ \\mu B \\sqrt{L} \\sqrt{ \\frac{2 \\zeta^2_1}{K} +  \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} } \\sqrt{T} } \\right\\}, \n    \n\\end{gathered}')
('6.1', '\\mathbb{E}\\left[ \\left\\Vert \\nabla F(w^R) \\right\\Vert^2 \\right] \\lesssim R^{\\text{Avg}}_1')
('6.1', 'p^{1:T}_{\\star} \\in \\mathcal{A}')
('6.1', 't \\in [T]')
('6.1', '\\mu^t=\\mu')
('6.1', '\\mu^t_l=\\mu_l')
('6.1', 't')
('6.1', '\\mu \\geq 1')
('6.1', '\\begin{gathered}\n    \\mu_l = \\min \\left\\{ \\frac{1}{4 \\mu B L} \\sqrt{\\frac{1}{1+1/(2\\alpha)}},  \\frac{(D^F)^{\\frac{1}{3}}}{  \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} \\mu B L^{\\frac{2}{3}} \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right)^{\\frac{1}{3}} T^{\\frac{1}{3}} }, \\right.\\\\ \n    \\left. \\frac{ \\sqrt{ 2 D^F }  }{ \\mu B \\sqrt{L} \\sqrt{ \\frac{2 \\zeta^2_1}{K} +  \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( p_{\\star}^{1:T} \\right) }{B T} } \\sqrt{T} } \\right\\}, \n    \n\\end{gathered}')
('6.1', '\\mathbb{E}\\left[ \\left\\Vert \\nabla F(w^R) \\right\\Vert^2 \\right] \\lesssim R^{\\text{Avg}}_2')
('6.1', 'q^{\\star} \\in \\mathcal{A}')
('6.1', 'p^t_{\\star}\\in\\mathcal{A}')
('6.1', '\\mu^t=\\mu')
('6.1', '\\mu^t_l=\\mu_l')
('6.1', 't')
('6.1', '\\mu \\geq 1')
('6.1', '\\mu_l')
('6.1', '\\mathbb{E}\\left[ \\left\\Vert \\nabla F(w^R) \\right\\Vert^2 \\right] \\lesssim \\min \\{R^{\\text{Avg}}_1, R^{\\text{Avg}}_2\\}.')
('6.1', 'R^{\\text{Avg}}_0')
('6.1', 'O(T^{-\\frac{2}{3}})')
('6.1', 'O(T^{-\\frac{1}{2}})')
('6.1', 'R^{\\text{Avg}}_1')
('6.1', 'R^{\\text{Avg}}_2')
('6.1', '\\alpha')
('6.1', 'R^{\\text{Avg}}_1 \\lesssim R^{\\text{Avg}}_0')
('6.1', '(1/B)\\sqrt{\\text{D-Regret}_T(q^{\\star}) /T } \\lesssim (1/\\sqrt{K})(\\zeta_0-\\zeta_1).')
('6.1', '\\text{D-Regret}_T(q^{\\star})')
('6.1', 'O(\\sqrt{T})')
('6.1', 'T \\to \\infty')
('6.1', 'R^{\\text{Avg}}_2 \\lesssim R^{\\text{Avg}}_0')
('6.1', '(1/B)\\sqrt{\\text{D-Regret}_T(p^{1:T}_{\\star}) /T } \\lesssim (1/\\sqrt{K})(\\zeta_0-\\zeta_1).')
('6.1', '\\text{D-Regret}_T(q^{\\star})')
('6.1', 'O(T)')
('6.1', '\\sum^T_{t=1}\\mathbb{E} [ (\\bar{a}^t)^2 ]=O(1)')
('6.1', '\\text{D-Regret}_T(p^{1:T}_{\\star})')
('6.1', 'O(\\sqrt{T})')
('7', '\\alpha')
('7', 'M=100')
('7', 'n_m=100')
('7', 'm \\in [M]')
('7', '\\label{eq:sync-data-generate}\ny_{m,i}=\\langle w_{\\star},x_{m,i} \\rangle + N(0,0.1^2), \\qquad i \\in [n_m],')
('7', 'w_{\\star} \\in \\mathbb{R}^d')
('7', 'N(10,3)')
('7', 'x_{m,i} \\in \\mathbb{R}^d')
('7', 'x_{m,i} \\sim N(0,\\Sigma_m)')
('7', '\\Sigma_m = s_m \\cdot \\Sigma')
('7', '\\Sigma')
('7', '\\Sigma_{jj}=\\kappa^{(j-1)/(d-1)-1}')
('7', '\\kappa>0')
('7', '\\Sigma')
('7', '\\{s_m\\}^M_{m=1}')
('7', 'e^{ N(0,\\sigma^2) }')
('7', 's_m \\leftarrow (s_m / \\max_{m \\in [M]} s_m) \\times 10')
('7', 's_m \\leq 10')
('7', 'm \\in [M]')
('7', '\\kappa')
('7', '\\sigma')
('7', '\\kappa=25')
('7', '\\sigma')
('7', 'd')
('7', 'd=10')
('7', '10')
('7', 'L(w)= \\frac1M \\sum^M_{m=1} L_m(w),\n\\qquad \\text{where} \\qquad \nL_m(w)= \\frac{1}{2 n_m} ( y_{m,i} - \\langle w_{\\star},x_{m,i} \\rangle )^2.')
('7', 't')
('7', 'K=5')
('7', 'S^t')
('7', 'm \\in S^t')
('7', '\\mathcal{B}^t_m')
('7', '\\bar{B}=10')
('7', 'w')
('7', 'w^{t+1} = w^t + \\frac{\\mu_{\\text{SGD}}}{M K \\bar{B}} \\sum_{m \\in S^t} \\frac{1}{ p^t_m } \\sum_{i \\in \\mathcal{B}^t_m} \\left( y_{m,i} - \\langle w_{\\star},x_{m,i} \\rangle \\right) \\cdot x_{m,i},')
('7', '\\mu_{\\text{SGD}}')
('7', '\\mu_{\\text{SGD}}=0.1')
('7', '\\alpha')
('7', '\\alpha=0.4')
('7.0', '\\sigma=1.0')
('7.0', '\\sigma=3.0')
('7.0', '\\sigma=10.0')
('7.0', '\\text{mean}\\pm\\text{standard deviation}')
('7.0', '\\sigma=1.0')
('7.0', '\\sigma=10.0')
('7.1', '\\sigma=1.0')
('7.1', '\\sigma=3.0')
('7.1', '\\sigma=10.0')
('7.1', '\\text{mean}\\pm\\text{standard deviation}')
('7.2', '\\alpha')
('7.2', '\\alpha \\in \\{0.01,0.1,0.4,0.7,0.9,1.0\\}')
('7.2', '\\alpha=1.0')
('7.2', '\\alpha')
('7.2', '\\alpha')
('7.3', '\\alpha')
('7.3', '\\sigma=1.0')
('7.3', '\\sigma=3.0')
('7.3', '\\sigma=10.0')
('7.3', '\\text{mean}\\pm\\text{standard deviation}')
('7.3', '\\sigma=1.0')
('7.3', '\\sigma=3.0')
('7.3', '\\sigma=10.0')
('7.3', '\\text{mean}\\pm\\text{standard deviation}')
('7.3', 'p^{\\text{IS}}')
('7.3', '\\nu=1.0')
('7.3', '\\nu=3.0')
('7.3', '\\nu=10.0')
('7.3', '\\text{mean}\\pm\\text{standard deviation}')
('7.3', '\\bar{a}^t')
('7.3', '\\sum^t_{l=1}(\\bar{a}^l)^2')
('7.3', 't')
('7.4', 'p^{\\text{IS}}')
('7.4', 'w_{\\star}')
('7.4', 'x_{m,i}')
('7.4', 'm \\in [M]')
('7.4', '\\mathbb{R}^d')
('7.4', '\\text{supp}(m) \\in [d]')
('7.4', 'x_{m,i}')
('7.4', 'i \\in [n_m]')
('7.4', 'x_{m,i}')
('7.4', 'x_{m,i}')
('7.4', 'N(1.0, 0.1^2)')
('7.4', 'w_{\\star}')
('7.4', 'e^{N(0, \\nu^2)}')
('7.4', '\\nu')
('7.4', 'w_{\\star}')
('7.4', '\\{1.0, 0.5, 0.1, 0.05, 0.01\\}')
('7.4', 'p^{\\text{IS}}')
('7.4', '\\nu')
('7.4', 'p^{\\text{IS}}')
('7.4', 'L_m(\\cdot)')
('7.5', 'q^{1:T}')
('7.5', '\\sum^T_{t=1}(\\bar{a}^t)^2')
('7.5', '\\bar{a}^t')
('7.5', '\\sum^t_{l=1}(\\bar{a}^l)^2')
('7.5', 't')
('7.5', '\\bar{a}^t')
('7.5', '\\sum^t_{l=1}(\\bar{a}^l)^2')
('7.5', 't')
('7.5', '\\bar{a}^t')
('7.5', '\\sum^t_{l=1}(\\bar{a}^l)^2')
('7.5', 't\\rightarrow \\infty')
('7.5', '\\sum^t_{l=1}(\\bar{a}^l)^2=O(1)')
('8', 'M=500')
('8', '65')
('8', '20')
('8', '5')
('8', '10')
('8', '30')
('8', '5')
('8', '100')
('8', '10')
('8', '5')
('8', 'y \\in \\{1,2,\\dots,C\\}')
('8', 'x \\in \\mathbb{R}^{p}')
('8', 'W \\in \\mathbb{R}^{C \\times p}')
('8', '\\phi (W ; x, y) \\coloneqq l_\\text{CE} \\left(\\varsigma (W x) \\, ; y \\right),')
('8', '\\varsigma (\\cdot) : \\mathbb{R}^{C} \\rightarrow \\mathbb{R}^{C}')
('8', '\\left[ \\varsigma (x) \\right]_i = \\frac{\\exp(x_i)}{\\sum^K_{j=1} \\exp(x_j)}, \\quad \\text{ for all } x \\in \\mathbb{R}^C,')
('8', 'l_\\text{CE}(x \\,; y)=\\sum^C_{i=1} \\mathds{1}(y=i) \\log x_i')
('8', 'x \\in \\mathbb{R}^C')
('8', 'y\\in \\{1,\\dots,C\\}')
('8', '0.075')
('8', '0.03')
('8', '1,000')
('8', 'K=10')
('8', '2')
('8', 'm')
('8', '\\min\\{5,n_m\\}')
('8', 'n_m')
('8', 'm')
('9', 'g^t')
('9.0', '\\label{eq:PrimProblem}\n\\min_{w, \\beta}  F(w,\\beta) \\coloneqq \\sum^{M}_{m=1} \\lambda_m \\phi(w,\\beta_m ; \\mathcal{D}_m),')
('9.0', 'w\\in \\mathbb{R}^{d_0}')
('9.0', '\\beta = (\\beta_1, \\dots, \\beta_M)')
('9.0', '\\beta_m\\in \\mathbb{R}^{d_m}')
('9.0', '\\label{eq:PrimProblem-bilevel}\n\\begin{aligned}\n\\min_{w}\\  & h(w) \\coloneqq \\sum^{M}_{m=1} \\lambda_m F_m(w,\\hat{\\beta}_m(w)) \\coloneqq \\sum^{M}_{m=1} \\lambda_m \\phi(w,\\hat{\\beta}_m (w) ; \\mathcal{D}_m) \\\\\n& \\text{subject to}\\quad \\hat{\\beta}_m  (w) = \\arg\\min_{\\beta_m} G_m(w, \\beta_m) \\coloneqq \\phi(w,\\beta_m ; \\bar{\\mathcal{D}}_m).\n\\end{aligned}')
('9.0', '\\mathcal{D}_m=\\bar{\\mathcal{D}}_m')
('9.0', '\\bar{\\mathcal{D}}_m \\neq \\mathcal{D}_m')
('9.0', '\\nabla_{w}')
('9.0', 'w')
('9.0', '\\beta_m')
('9.0', '\\nabla_{\\beta_m}')
('9.0', '\\beta_m')
('9.0', 'w')
('9.0', '\\nabla')
('9.0', 'w')
('9.0', '\\beta_m (w)')
('9.0', 'w')
('9.0', '\\nabla^2_{\\beta_m \\beta_m} G_m (w, \\beta_m) \\in \\mathbb{R}^{d_m\\times d_m}')
('9.0', 'G_m')
('9.0', '\\beta_m')
('9.0', 'w')
('9.0', '\\nabla^2_{w \\beta_m} G_m (w, \\beta_m) \\in \\mathbb{R}^{d_0 \\times d_m}')
('9.0', 'G_m')
('9.0', 'w')
('9.0', '\\beta_m')
('9.0', '\\begin{aligned}\n\\left[ \\nabla^2_{\\beta_m \\beta_m} G_m (w, \\beta_m) \\right]_{i,j} & =  \\frac{ \\partial G_m (w, \\beta_m) }{ \\partial \\beta_{m,i} \\beta_{m,j} } \\quad \\text{for all} \\, i,j = 1,2,\\dots, d_m, \\\\\n\\left[ \\nabla^2_{w \\beta_m} G_m (w, \\beta_m) \\right]_{i,j} & =  \\frac{ \\partial G_m (w, \\beta_m) }{ \\partial w_i \\beta_{m,j} } \\quad \\text{for all} \\, i = 1,2,\\dots, d_0, j=1,2,\\dots,d_m.\n\\end{aligned}')
('9.0', '\\label{eq:graidents-two-components}\n\\nabla h (w) = \\underbrace{\\frac{1}{M} \\sum^M_{m=1} \\lambda_m \\nabla_1 F_m (w, \\hat{\\beta}_m (w) )}_{\\nabla_1 h (w)} + \\underbrace{\\frac{1}{M} \\sum^M_{m=1} \\lambda_m \\nabla_2 F_m (w, \\hat{\\beta}_m (w) )}_{\\nabla_2 h (w)}')
('9.0', '\\begin{aligned}\n\\nabla_1 F_m (w, \\hat{\\beta}_m (w) ) & \\coloneqq  \\nabla_{w} F_m (w, \\hat{\\beta}_m (w)), \\\\\n\\nabla_2 F_m (w, \\hat{\\beta}_m (w) ) & \\coloneqq - \\nabla^2_{w \\beta_m} F_m (w, \\hat{\\beta}_m (w)) \\left[ \\nabla^2_{\\beta_m \\beta_m} F_m (w, \\hat{\\beta}_m (w)) \\right]^{-1} \\nabla_{\\beta_m} F_m (w, \\hat{\\beta}_m (w)).\n\\end{aligned}')
('9.0', '\\nabla h (w^t)')
('9.0', 'S^t')
('9.0', 'S^t_1')
('9.0', 'S^t_2')
('9.0', 'S^t=S^t_1 \\cup S^t_2')
('9.0', 'S^t_1')
('9.0', 'S^t_2')
('9.0', '\\nabla h (w)')
('9.0', '\\nabla_1 h (w)')
('9.0', '\\nabla_2 h (w)')
('9.0', 'g^t_{1,m}')
('9.0', '\\nabla_1 F_m (w, \\hat{\\beta}_m (w) )')
('9.0', 'g^t_{2,m}')
('9.0', '\\nabla_2 F_m (w, \\hat{\\beta}_m (w) )')
('9.0', '\\nabla_1 h (w)')
('9.0', '\\nabla_2 h (w)')
('9.0', '\\begin{aligned}\ng^t_1 =  \\frac{1}{K_1} \\sum_{m \\in S^t_1} \\lambda_m \\frac{g^t_{1,m}}{p^t_{1,m}}, \\qquad \ng^t_2 =  \\frac{1}{K_2} \\sum_{m \\in S^t_2} \\lambda_m \\frac{g^t_{2,m}}{p^t_{2,m}},\n\\end{aligned}')
('9.0', 'K_1=\\vert S^t_1 \\vert')
('9.0', 'K_2=\\vert S^t_2 \\vert')
('9.0', 'g^t=g^t_1+g^t_2')
('9.0', '\\nabla h (w)')
('9.0', 'p^t_1')
('9.0', 'p^t_2')
('9.0', 'S^t_1')
('9.0', 'S^t_2')
('9.0', '\\begin{gathered}\n\\min_{ p^t_1} \\mathbb{E}_1 \\left[ \\mathbb{E}_{S^t_1} \\left[ \\left\\Vert g^t_1  - \\nabla_1 h (w^t)  \\right\\Vert^2  \\right] \\right] + \\min_{ p^t_2} \\mathbb{E}_2 \\left[ \\mathbb{E}_{S^t_2} \\left[ \\left\\Vert g^t_2  - \\nabla_2 h (w^t)  \\right\\Vert^2  \\right] \\right] \\\\\n\\leq  \\min_{ p^t_1 = p^t_2 = p^t } \\mathbb{E} \\left[ \\mathbb{E}_{S^t} \\left[ \\left\\Vert g^t_1  - \\nabla_1 h (w^t)  + g^t_2  - \\nabla_2 h (w^t)  \\right\\Vert^2  \\right] \\right],\n\\end{gathered}')
('9.1', 't')
('9.1', 'I^t \\subseteq [M]')
('9.1', '\\vert I^t \\vert \\leq K')
('9.1', 'I^t')
('9.1', 't')
('9.1', 'S^t \\subseteq I^t')
('9.1', '\\hat{p}^t')
('9.1', '\\tilde{p}^t_m = \\hat{p}^t_m / (\\sum_{i \\in I^t} \\hat{p}^t_i)')
('9.1', '\\tilde{p}^t_m=0')
('9.1', 'm \\notin I^t')
('9.1', '\\tilde{p}^t_m')
('9.1', 'S^t')
('9.1', 'I^t')
('9.1', '\\{I^t\\}^T_{t=1}')
('9.1', 'I^t')
('9.1', '\\{I^t\\}^T_{t=1}')
('10.0', '\\Phi = \\Phi_e')
('10.0', '\\tilde{p}^{t+1}_m = p^t_m \\exp \\left\\{ \\mathcal{N}\\left\\{ m \\in S^t \\right\\} \\eta_t a^t_m / (K^2 (p^t_m)^3)  \\right\\}, \\qquad m \\in [M].')
('10.0', '\\pi:[M]\\mapsto[M]')
('10.0', '\\tilde{p}^{t+1}_{\\pi(1)}\\leq\\tilde{p}^{t+1}_{\\pi(2)}\\leq\\dots\\leq\\tilde{p}^{t+1}_{\\pi(M)}')
('10.0', 'm^t_{\\star}')
('10.0', 'm')
('10.0', '\\tilde{p}^{t+1}_{\\pi(m)} \\left( 1 -  \\frac{m-1}{M} \\alpha \\right) > \\frac{\\alpha}{M} \\sum^M_{j=m} \\tilde{p}^{t+1}_{\\pi(j)}.')
('10.0', '\\hat{p}^{t+1}_m =\n\\begin{cases}\n\\alpha / M & \\text{if } \\pi(m) < m^t_{\\star} \\\\\n\\left((1 - ((m^t_{\\star}-1) / M) \\alpha ) \\tilde{p}^{t+1}_{m}\\right)/\\left(\\sum^M_{j=m^t_{\\star}} \\tilde{p}^{t+1}_{\\pi(j)}\\right) & \\text{otherwise}.\n\\end{cases}')
('10.0', '\\hat{p}^{t+1}')
('10.0', '\\begin{aligned}\n\\tilde{p}^{t+1} & =  \\arg\\min_{ p \\in \\mathcal{D} } \\, \\eta_t \\langle p,\\nabla \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t)  \\rangle + D_{\\Phi_e} \\left( p \\,\\Vert\\, \\hat{p}^t  \\right), \\\\\n\\hat{p}^{t+1} & =  \\arg\\min_{ p \\in \\mathcal{A} } \\, D_{\\Phi_e} \\left( p \\,\\Vert\\, \\tilde{p}^{t+1}  \\right).\n\\end{aligned}')
('10.0', '\\tilde{p}^{t+1}')
('10.0', '\\label{eq:proof-prop1-1}\n\\eta_t \\nabla \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t) + \\nabla \\Phi_e ( \\tilde{p}^{t+1} ) - \\nabla \\Phi_e ( \\hat{p}^t ) = 0.')
('10.0', '\\hat{p}^{t+1}')
('10.0', '\\langle p - \\hat{p}^{t+1}, \\nabla \\Phi_e (\\hat{p}^{t+1}) - \\nabla \\Phi_e (\\tilde{p}^{t+1}) \\rangle \\geq 0, \\quad \\text{for all } p \\in \\mathcal{A}.')
('10.0', '\\langle p - \\hat{p}^{t+1}, \\eta_t \\nabla \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t) + \\nabla \\Phi_e (\\hat{p}^{t+1}) - \\nabla \\Phi_e (\\hat{p}^{t}) \\rangle \\geq 0, \\quad \\text{for all } p \\in \\mathcal{A}.')
('10.0', '\\hat{p}^{t+1}')
('10.0', '- \\frac{\\eta_t }{K^2} \\cdot \\frac{ a^t_m }{ ( p^t_m )^3 } \\mathcal{N} \\left\\{ m \\in S^t \\right\\} + \\log (\\tilde{p}^{t+1}_m) - \\log (\\hat{p}^t_m) = 0, \\qquad  m \\in [M].')
('10.0', '\\tilde{p}^{t+1}_m = \\hat{p}^t_m \\exp \\left( \\frac{\\eta_t a^t_m }{ K^2 \\left( \\hat{p}^t_m \\right)^3 } \\mathcal{N} \\left\\{ m \\in S^t \\right\\} \\right), \\qquad  m \\in [M],')
('10.1', '\\mathcal{A}')
('10.1', 'q^{1:T}')
('10.1', 'q^t \\in \\mathcal{A}')
('10.1', 't\\in[T]')
('10.1', '\\text{D-Regret}_T (q^{1:T})  \\leq \\frac{ D_{\\max} }{\\eta_1} + \\frac{2H}{\\eta_T} \\mathbb{E} \\left[ \\text{TV} \\left( q^{1:T} \\right) \\right] + \\frac{2 }{\\rho} \\sum^T_{t=1} \\eta_t \\mathbb{E} \\left[ Q^2_t \\right].')
('10.1', '\\hat{p}^{t+1}')
('10.1', '\\label{eq:proof-thm2-1}\n\\langle \\hat{p}^{t+1} - q^t,  \\nabla \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) \\rangle \\leq \\frac{1}{\\eta_t} \\langle  \\nabla \\Phi (\\hat{p}^{t}) - \\nabla \\Phi (\\hat{p}^{t+1}), \\hat{p}^{t+1} - q^t \\rangle.')
('10.1', '\\hat{l}_t ( \\cdot ; \\hat{p}^t )')
('10.1', '\\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) - \\hat{l}_t ( q^t ; \\hat{p}^t ) \\leq \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - q^t  \\rangle = \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^{t+1} - q^t  \\rangle + \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - \\hat{p}^{t+1}  \\rangle.')
('10.1', '\\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) - \\hat{l}_t ( q^t ; \\hat{p}^t ) \\leq \\frac{1}{\\eta_t} \\langle  \\nabla \\Phi (\\hat{p}^{t}) - \\nabla \\Phi (\\hat{p}^{t+1}), \\hat{p}^{t+1} - q^t \\rangle + \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - \\hat{p}^{t+1}  \\rangle.')
('10.1', '\\mathcal{D}')
('10.1', 'D_{\\Phi} \\left(x_1 \\,\\Vert\\, x_2 \\right) = D_{\\Phi} \\left(x_3 \\,\\Vert\\, x_2 \\right) + D_{\\Phi} \\left(x_1 \\,\\Vert\\, x_3 \\right) + \\langle \\nabla \\Phi(x_2) - \\nabla \\Phi(x_3), x_3 - x_1 \\rangle,\n\\qquad x_1,x_2,x_3\\in\\mathcal{D}.')
('10.1', '\\begin{aligned}\n\\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) & - \\hat{l}_t ( q^t ; \\hat{p}^t ) \\\\\n& \\leq \\frac{1}{\\eta_t} \\left[  D_{\\Phi} \\left( q^t \\Vert \\hat{p}^t \\right) -  D_{\\Phi} \\left( q^t \\Vert \\hat{p}^{t+1} \\right) - D_{\\Phi} \\left( \\hat{p}^{t+1} \\Vert \\hat{p}^t \\right) \\right] + \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - \\hat{p}^{t+1}  \\rangle \\\\\n& =  \\frac{1}{\\eta_t} \\left[ D_{\\Phi} \\left( q^t \\Vert \\hat{p}^t \\right) - D_{\\Phi} \\left( q^{t+1} \\Vert \\hat{p}^{t+1} \\right) \\right] + \\frac{1}{\\eta_t} \\left[ D_{\\Phi} \\left( q^{t+1} \\Vert \\hat{p}^{t+1} \\right) - D_{\\Phi} \\left( q^t \\Vert \\hat{p}^{t+1} \\right)  \\right] \\\\\n& \\qquad -  \\frac{1}{\\eta_t} D_{\\Phi} \\left( \\hat{p}^{t+1} \\Vert \\hat{p}^t \\right) + \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - \\hat{p}^{t+1}  \\rangle. \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm2-2}\n\\end{aligned}')
('10.1', '\\begin{aligned}\n D_{\\Phi} \\left( q^{t+1} \\Vert \\hat{p}^{t+1} \\right) - D_{\\Phi} \\left( q^t \\Vert \\hat{p}^{t+1} \\right)  \n& =  \\Phi (q^{t+1}) - \\Phi (q^t) - \\langle \\nabla \\Phi (\\hat{p}^{t+1}), q^{t+1} - q^t \\rangle  \\\\\n& \\overset{(a)}{\\leq}    \\langle \\nabla \\Phi (q^{t+1}) -  \\nabla \\Phi (\\hat{p}^{t+1}), q^{t+1} - q^t   \\rangle \\\\\n& \\overset{(b)}{\\leq}  \\Vert \\nabla \\Phi (q^{t+1}) -  \\nabla \\Phi (\\hat{p}^{t+1}) \\Vert_{\\star} \\Vert q^{t+1} - q^t \\Vert \\\\\n& \\overset{(c)}{\\leq} 2 H \\Vert q^{t+1} - q^t \\Vert, \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm2-3}\n\\end{aligned}')
('10.1', '\\Phi(\\cdot)')
('10.1', 'H')
('10.1', '\\Phi(\\cdot)')
('10.1', '\\rho')
('10.1', '- \\frac{1}{\\eta_t} D_{\\Phi} \\left( \\hat{p}^{t+1} \\Vert \\hat{p}^t \\right) + \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - \\hat{p}^{t+1}  \\rangle \\leq - \\frac{\\rho}{2 \\eta_t} \\Vert \\hat{p}^{t+1} - \\hat{p}^t \\Vert^2 + \\Vert \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) \\Vert_{\\star} \\Vert \\hat{p}^t - \\hat{p}^{t+1} \\Vert.')
('10.1', 'ab\\leq a^2 / (2\\epsilon) + b^2 \\epsilon / 2')
('10.1', 'a,b,\\epsilon>0')
('10.1', '\\begin{aligned}\n- \\frac{1}{\\eta_t} D_{\\Phi} \\left( \\hat{p}^{t+1} \\Vert \\hat{p}^t \\right) + \\langle \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ), \\hat{p}^t - \\hat{p}^{t+1}  \\rangle \\leq  \\frac{2 \\eta_t}{\\rho} \\Vert \\nabla  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) \\Vert^2_{\\star} \n\\leq  \\frac{2 \\eta_t}{\\rho}  Q_t^2. \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm2-4}\n\\end{aligned}')
('10.1', '\\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) - \\hat{l}_t ( q^t ; \\hat{p}^t ) \\leq \\frac{D_{\\Phi} \\left( q^t \\Vert \\hat{p}^t \\right)}{\\eta_t}   - \\frac{D_{\\Phi} \\left( q^{t+1} \\Vert \\hat{p}^{t+1} \\right)}{\\eta_t}  + 2 H \\frac{\\Vert q^{t+1} - q^t \\Vert}{\\eta_t}  + \\frac{2}{\\rho} \\eta_t Q^2_t.')
('10.1', '\\begin{aligned}\n\\sum^T_{t=1}\\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) &- \\sum^T_{t=1} \\hat{l}_t ( q^t ; \\hat{p}^t ) \\\\\n& \\leq  \\frac{D_{\\Phi} \\left( q^1 \\Vert \\hat{p}^1 \\right)}{\\eta_1} - \\frac{D_{\\Phi} \\left( q^{T+1} \\Vert \\hat{p}^{T+1} \\right)}{\\eta_{T+1}} + 2H \\sum^T_{t=1} \\frac{\\Vert q^{t+1} - q^t \\Vert}{\\eta_t} + \\frac{2  }{\\rho} \\sum^T_{t=1}  \\eta_t Q^2_t \\\\\n& \\leq  \\frac{ D_{\\Phi} \\left( q^1 \\Vert \\hat{p}^1 \\right) }{\\eta_1} + \\frac{2H}{\\eta_T} \\sum^T_{t=1} \\Vert q^{t+1} - q^t \\Vert + \\frac{2  }{\\rho} \\sum^T_{t=1}  \\eta_t Q^2_t \\\\\n& \\leq  \\frac{ D_{\\max} }{\\eta_1} + \\frac{2H}{\\eta_T} \\text{TV} \\left( q^{1:T} \\right) + \\frac{2  }{\\rho} \\sum^T_{t=1} \\eta_t Q^2_t, \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm2-5}\n\\end{aligned}')
('10.1', '\\hat{p}_1')
('10.1', '\\begin{aligned}\n\\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) - \\sum^T_{t=1} \\hat{l}_t ( q^t ; \\hat{p}^t )  \\right] & =  \\sum^T_{t=1} \\mathbb{E} \\left[  \\mathbb{E}_{S^t} \\left[  \\hat{l}_t ( \\hat{p}^t ; \\hat{p}^t ) \\right] - \\mathbb{E}_{S^t} \\left[ \\hat{l}_t ( q^t ; \\hat{p}^t ) \\right]  \\right] \\\\\n& =  \\sum^T_{t=1} \\mathbb{E} \\left[ l_t ( \\hat{p}^t ) -  l_t ( q^t ) \\right] \\\\\n& =  \\text{D-Regret}_T (q^{1:T}).\n\\end{aligned}')
('10.1', 'q^{1:T}')
('10.1', 'q^t \\in \\mathcal{P}_{M-1}')
('10.1', 't \\in [T]')
('10.1', '\\label{eq:proof-thm1-1}\n\\text{D-Regret}_T (q^{1:T}) \n=  \\mathbb{E} \\left[ \\sum^T_{t=1} l_t (\\hat{p}^t)  - \\sum^T_{t=1} l_t (\\tilde{q}^t) + \\sum^T_{t=1} l_t (\\tilde{q}^t) - \\sum^T_{t=1} l_t (q^t) \\right].')
('10.1', '\\begin{gathered}\n\\label{eq:proof-thm1-2} \n\\mathbb{E} \\left[ \\sum^T_{t=1} l_t (\\hat{p}^t)  - \\sum^T_{t=1} l_t (\\tilde{q}^t) \\right] \\\\\n\\leq \n\\frac{ D_{\\max} }{\\eta_1} + \\frac{2H}{\\eta_T} \\mathbb{E} \\left[ \\text{TV} \\left( q^{1:T} \\right) \\right] + \\frac{2 }{\\rho} \\sum^T_{t=1} \\eta_t \\mathbb{E} \\left[ Q^2_t \\right] + \\frac{2H}{\\eta_T} \\mathbb{E} \\left[ \\text{TV} \\left( \\tilde{q}^{1:T} \\right) - \\text{TV} \\left( q^{1:T} \\right)  \\right]. \n\\end{gathered}')
('10.1', '\\tilde{q}^{1:T}')
('10.1', '\\tilde{q}^t \\in \\mathcal{A}')
('10.1', '\\sum^T_{t=1} l_t (\\tilde{q}^t) - \\sum^T_{t=1} l_t (q^t)')
('10.1', '\\text{TV} \\left( \\tilde{q}^{1:T} \\right) - \\text{TV} \\left( q^{1:T} \\right)')
('10.1', '\\tilde{q}^t')
('10.1', '\\label{eq:proj-seq}\n\\tilde{q}^t_m =\n\\begin{cases}\n\\alpha/M & \\text{if } q^t_m < \\alpha/M, \\\\\n  q^t_m - \\omega(q^t, \\alpha) \\left( q^t_m - \\frac{\\alpha}{M} \\right)  & \\text{if } q^t_m \\geq \\alpha/M,\n\\end{cases}')
('10.1', '\\omega(q^t, \\alpha)')
('10.1', '\\tilde{q}^t \\in \\mathcal{A}')
('10.1', 't \\in [T]')
('10.1', '\\tilde{q}^t_m \\geq \\alpha / M')
('10.1', 'm \\in [M]')
('10.1', '\\sum_{m\\in[M]} \\tilde{q}^t_m = 1')
('10.1', 'm \\in [M]')
('10.1', 'q^t_m < \\alpha/M')
('10.1', '\\tilde{q}^t_m=\\alpha/M')
('10.1', 'm \\in [M]')
('10.1', 'q^t_m \\geq \\alpha/M')
('10.1', '\\tilde{q}^t_m - {\\alpha}/{M} = \\left( 1 - \\omega(q^t, \\alpha) \\right) \\left( q^t_m - {\\alpha}/{M} \\right)')
('10.1', '\\omega(q^t, \\alpha) \\leq 1')
('10.1', '\\begin{gathered}\n1=\\sum^M_{m=1} q^t_m \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} + \\sum^M_{m=1} q^t_m \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\\\\n\\geq \\sum^M_{m=1} \\frac{\\alpha}{M} \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} + \\sum^M_{m=1} \\frac{\\alpha}{M}\\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\}=\\alpha,\n\\end{gathered}')
('10.1', '\\sum^M_{m=1} \\left( q^t_m - \\frac{\\alpha}{M} \\right) \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\geq \\sum^M_{m=1} \\left( \\frac{\\alpha}{M} - q^t_m \\right) \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\}.')
('10.1', '0 \\leq \\omega(q^t, \\alpha) \\leq 1')
('10.1', '\\omega(q^t, 0)=1')
('10.1', '\\omega(q^t, 1)=1')
('10.1', '\\sum^M_{m=1} \\tilde{q}^t_m = 1')
('10.1', '\\omega(q^t, \\alpha)')
('10.1', '\\begin{aligned}\n\\sum^M_{m=1} \\tilde{q}^t_m \n& = \\sum^M_{m=1} \\frac{\\alpha}{M} \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} + \\sum^M_{m=1} q^t_m \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\\\\n& \\quad - \\omega(q^t, \\alpha) \\sum^M_{m=1} \\left( q^t_m - \\frac{\\alpha}{M}  \\right) \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\\\\n& = \\sum^M_{m=1} \\frac{\\alpha}{M} \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} + \\sum^M_{m=1} q^t_m \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} - \\sum^M_{m=1} \\left( \\frac{\\alpha}{M} - q^t_m \\right) \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} \\\\\n& = \\sum^M_{m=1} q^t_m \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} + \\sum^M_{m=1} q^t_m \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} \\\\\n& = 1.\n\\end{aligned}')
('10.1', '\\tilde{q}^t \\in \\mathcal{A}')
('10.1', 't \\in [T]')
('10.1', '\\sum^T_{t=1} l_t (\\tilde{q}^t) - \\sum^T_{t=1} l_t (q^t)')
('10.1', 'q^t_m < \\alpha / M')
('10.1', '1/\\tilde{q}^t_m - 1/q^t_m < 0')
('10.1', 'q^t_m \\geq \\alpha / M')
('10.1', '\\frac{1}{\\tilde{q}^t_m} - \\frac{1}{q^t_m} = \\frac{1}{q^t_m} \\cdot \\left[ \\frac{1}{1-\\omega(q^t, \\alpha)\\left( 1 - \\frac{\\alpha}{M q^t_m} \\right)} - 1\\right] = \\frac{1}{q^t_m} \\cdot \\frac{ \\omega(q^t, \\alpha)\\left( 1 - \\frac{\\alpha}{M q^t_m} \\right) }{ 1-\\omega(q^t, \\alpha)\\left( 1 - \\frac{\\alpha}{M q^t_m} \\right) }.')
('10.1', '\\omega(q^t, \\alpha)\\left( 1 - \\frac{\\alpha}{M q^t_m} \\right) \\leq \\omega(q^t, \\alpha)\n\\quad \n\\text{and}\n\\quad\n1-\\omega(q^t, \\alpha)\\left( 1 - \\frac{\\alpha}{M q^t_m} \\right)  \\geq 1 - \\omega(q^t, \\alpha) + \\frac{\\omega(q^t, \\alpha) \\alpha}{M}')
('10.1', 'q^t_m \\leq 1')
('10.1', '\\frac{1}{\\tilde{q}^t_m} - \\frac{1}{q^t_m} \\leq \\frac{1}{q^t_m} \\cdot \\frac{ \\omega(q^t, \\alpha) }{ 1 - \\omega(q^t, \\alpha) \\left( 1 - \\frac{\\alpha}{M} \\right)  }\n= \\frac{\\phi(q^t, \\alpha)}{q^t_m}.')
('10.1', '\\begin{aligned}\n\\sum^T_{t=1} l_t (\\tilde{q}^t) - \\sum^T_{t=1} l_t (q^t) & = \\sum^T_{t=1} \\sum^M_{m=1} a^t_m \\left( \\frac{1}{\\tilde{q}^t_m} - \\frac{1}{q^t_m} \\right) \\\\\n& \\leq \\sum^T_{t=1} \\sum^M_{m=1} a^t_m \\left( \\frac{1}{\\tilde{q}^t_m} - \\frac{1}{q^t_m} \\right) \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\\\\n& \\leq \\sum^T_{t=1} \\phi(q^t, \\alpha) \\sum^M_{m=1} \\frac{a^t_m}{q^t_m} \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\\\\n& \\leq \\sum^T_{t=1} \\phi(q^t, \\alpha) l_t (q^t). \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:thm1-proof-helper5}\n\\end{aligned}')
('10.1', '\\text{TV} \\left( \\tilde{q}^{1:T} \\right) - \\text{TV} \\left( q^{1:T} \\right)')
('10.1', '\\begin{aligned}\n\\text{TV} \\left( \\tilde{q}^{1:T} \\right) & = \\sum^T_{t=2} \\left\\Vert \\tilde{q}^t - \\tilde{q}^{t-1} \\right\\Vert_1 \\\\\n& = \\sum^T_{t=2} \\left\\Vert \\tilde{q}^t - q^t + q^t - q^{t-1} + q^{t-1} - \\tilde{q}^{t-1} \\right\\Vert_1 \\\\\n& \\leq \\sum^T_{t=2} \\left\\Vert \\tilde{q}^t - q^t \\right\\Vert_1 + \\sum^T_{t=2} \\left\\Vert q^t - q^{t-1} \\right\\Vert_1 + \\sum^T_{t=2} \\left\\Vert q^{t-1} - \\tilde{q}^{t-1} \\right\\Vert_1 \\\\\n& \\leq \\text{TV} \\left( q^{1:T} \\right) + 2 \\sum^T_{t=1} \\left\\Vert \\tilde{q}^t - q^t \\right\\Vert_1.\n\\end{aligned}')
('10.1', '\\sum^T_{t=1} \\left\\Vert \\tilde{q}^t - q^t \\right\\Vert_1')
('10.1', 'q^t_m < \\alpha/M')
('10.1', '\\vert \\tilde{q}^t_m - q^t_m  \\vert=\\alpha/M - q^t_m')
('10.1', 'q^t_m \\geq \\alpha/M')
('10.1', '\\left\\vert \\tilde{q}^t_m - q^t_m  \\right\\vert = \\omega(q^t, \\alpha) \\left( q^t_m - {\\alpha}/{M} \\right)')
('10.1', '\\psi(q^t, \\alpha)')
('10.1', '\\begin{aligned}\n\\left\\Vert \\tilde{q}^t - q^t \\right\\Vert_1 &= \\sum^M_{m=1} \\left( \\frac{\\alpha}{M} - q^t_m \\right) \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} + \\omega(q^t, \\alpha) \\sum^M_{m=1} \\left( q^t_m  -\\frac{\\alpha}{M} \\right) \\mathds{1} \\left\\{ q^t_m \\geq \\frac{\\alpha}{M} \\right\\} \\\\\n& = 2 \\sum^M_{m=1} \\left( \\frac{\\alpha}{M} - q^t_m \\right) \\mathds{1} \\left\\{ q^t_m < \\frac{\\alpha}{M} \\right\\} \\\\\n& = 2 \\psi(q^t, \\alpha)\n\\end{aligned}')
('10.1', '\\label{eq:thm1-proof-helper4}\n\\text{TV} \\left( \\tilde{q}^{1:T} \\right) - \\text{TV} \\left( q^{1:T} \\right) \\leq 4 \\sum^T_{t=1}\\psi(q^t, \\alpha).')
('10.2', '\\Phi=\\Phi_e')
('10.2', '\\{q^{1:T}\\}')
('10.2', '\\begin{gathered}\n\\text{D-Regret}_T (q^{1:T}) \\leq \\frac{ \\log M  }{ \\eta_1 } + \\frac{ 2 \\log (M / \\alpha) }{ \\eta_T } \\text{TV} \\left( q^{1:T} \\right) + \\frac{2 M^6}{ K^4 \\alpha^6 } \\sum^T_{t=1} \\eta_t \\left( \\bar{a}^t  \\right)^2 \\\\ \n+ \\frac{8H}{\\eta_T} \\sum^T_{t=1} \\psi(q^t, \\alpha) + \\sum^T_{t=1} \\phi(q^t, \\alpha) l_t (q^t),\n\\end{gathered}')
('10.2', '\\bar{a}^t \\coloneqq \\max_{1\\leq m \\leq M} a^t_m = \\max_{1\\leq m \\leq M} \\lambda^2_m \\Vert g^t_m \\Vert^2')
('10.2', '\\Phi=\\Phi_e')
('10.2', '\\rho=1')
('10.2', '\\Vert \\cdot \\Vert_{\\star} = \\Vert \\cdot \\Vert_{\\infty}')
('10.2', '\\nabla \\Phi_e (p) = ( \\log p_1, \\dots, \\log p_M )^{\\top}')
('10.2', '\\hat{p}^t \\in \\mathcal{A}=\\mathcal{P}_{M-1} \\cap [\\alpha/M, \\infty)^M')
('10.2', 't \\in [T]')
('10.2', 'Q_t=M^3 \\bar{a}^t / (K^2 \\alpha^3)')
('10.2', 'H=\\log(M/\\alpha)')
('10.2', 'D_{\\Phi_e}(q \\,\\Vert\\, p^{\\rm unif}) \\leq \\log M')
('10.2', 'q \\in \\mathcal{A}')
('10.2', 'D_{\\Phi_e}(q \\,\\Vert\\, p^{\\rm unif}) = \\log M + \\sum^M_{m=1} q_m \\log q_m \\leq \\log M')
('10.3', '\\eta_e \\in \\mathcal{E}')
('10.3', '\\hat{p}^{1:T}_e')
('10.3', '\\eta_e \\in \\mathcal{E}')
('10.3', '\\label{eq:proof-dap-1}\n\\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t_e ; \\hat{p}^t )  - \\sum^T_{t=1} l_t (p^t_{\\star}) \\right] \\leq \\frac{ 3 \\sqrt{2} M^3  \\sqrt{\\mathbb{E}\\left[ (\\bar{a}^1)^2\\right]}  }{ K^2 \\alpha^3 } \\sqrt{ T \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right]  \\right]   }.')
('10.3', 'S^t \\sim \\hat{p}^t')
('10.3', '\\label{eq:proof-dap-2}\n\\mathbb{E} \\left[ \\sum^T_{t=1} l_t (\\hat{p}^t ) \\right] - \\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t_e ; \\hat{p}^t ) \\right] \\leq \\frac{M}{\\alpha} \\sqrt{ \\frac{T \\mathbb{E} \\left[ \\bar{a}^1 \\right] }{ 8 K } } (1 + 2 \\log E ), \\qquad e \\in [E].')
('10.3', '0 \\leq \\mathbb{E}[\\text{TV} \\left( p^{1:T}_{\\star} \\right)] \\leq 2 (T-1)')
('10.3', '\\min \\mathcal{E} = \\frac{ K^2 \\alpha^3 }{ M^3 \\bar{a}^1 } \\sqrt{ \\frac{\\log M}{ 2 T  }  } \\leq \\eta^{\\star} \\leq \\frac{ K^2 \\alpha^3 }{ M^3 \\bar{a}^1 } \\sqrt{ \\frac{ \\log M + 4 \\log (M/\\alpha)(T-1)  }{ 2 T }  } \\leq \\max \\mathcal{E},')
('10.3', '\\eta^{\\star}')
('10.3', '\\eta_e \\in \\mathcal{E}')
('10.3', '\\eta_e \\leq \\eta^{\\star} \\leq 2 \\eta_e')
('10.3', '\\sum^T_{t=1}\\hat{l}_t ( \\hat{p}^t_e ; \\hat{p}^t ) - \\sum^T_{t=1} \\hat{l}_t ( p^t_{\\star} ; \\hat{p}^t ) \\leq \\frac{ \\log M  }{ \\eta_e } + \\frac{ 2 \\log (M / \\alpha) }{ \\eta_e } \\text{TV} \\left( p^{1:T}_{\\star} \\right) +  \\frac{2 \\eta_e M^6}{ K^4 \\alpha^6 } \\sum^T_{t=1}   \\left( \\bar{a}^t  \\right)^2,')
('10.3', '\\begin{gathered}\n\\mathbb{E} \\left[\\sum^T_{t=1}\\hat{l}_t ( \\hat{p}^t_e ; \\hat{p}^t ) - \\sum^T_{t=1} \\hat{l}_t ( p^t_{\\star} ; \\hat{p}^t ) \\right]\\leq \\frac{ \\log M  }{ \\eta_e } + \\frac{ 2 \\log (M / \\alpha) }{ \\eta_e } \\mathbb{E} \\left[\\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right] \\\\\n+  \\frac{2 \\eta_e M^6}{ K^4 \\alpha^6 } \\sum^T_{t=1}  \\mathbb{E} \\left[\\left( \\bar{a}^t  \\right)^2 \\right],\n\\end{gathered}')
('10.3', '\\eta^{\\star}/2 \\leq \\eta_e \\leq \\eta^{\\star}')
('10.3', '\\begin{aligned}\n& \\quad \\mathbb{E} \\left[\\sum^T_{t=1}\\hat{l}_t ( \\hat{p}^t_e ; \\hat{p}^t ) - \\sum^T_{t=1} \\hat{l}_t ( p^t_{\\star} ; \\hat{p}^t ) \\right] \\\\\n& \\leq  \\frac{ 2 \\log M  }{ \\eta^{\\star} } + \\frac{ 4 \\log (M / \\alpha) }{ \\eta^{\\star} } \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right] +  \\frac{2 \\eta^{\\star} M^6}{ K^4 \\alpha^6 } \\sum^T_{t=1} \\mathbb{E} \\left[ \\left( \\bar{a}^t \\right)^2 \\right] \\\\\n& \\leq  \\frac{ 2 \\log M  }{ \\eta^{\\star} } + \\frac{ 4 \\log (M / \\alpha) }{ \\eta^{\\star} } \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right] +  \\frac{2 \\eta^{\\star} M^6 T }{ K^4 \\alpha^6}  \\mathbb{E} \\left[ \\left( \\bar{a}^1 \\right)^2 \\right] \\\\\n& =  \\frac{ 3 \\sqrt{2} M^3 \\sqrt{\\mathbb{E}\\left[ (\\bar{a}^1)^2\\right]} }{ K^2 \\alpha^3 } \\sqrt{ T \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right] \\right] }.\n\\end{aligned}')
('10.3', '\\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t ( p^t_{\\star} ; \\hat{p}^t )  \\right] = \\sum^T_{t=1} \\mathbb{E} \\left[ \\mathbb{E}_{S^t} \\left[ \\hat{l}_t ( p^t_{\\star} ; \\hat{p}^t ) \\right]  \\right] = \\sum^T_{t=1} \\mathbb{E} \\left[ l_t (p^t_{\\star})  \\right].')
('10.3', '\\hat{L}^e_t = \\sum^t_{s=1} \\hat{l}_s ( \\hat{p}^s_e ; \\hat{p}^s ) \\quad e \\in [E], t \\in [T].')
('10.3', '\\theta^t_e')
('10.3', '\\theta^t_e = \\frac{ \\theta^1_e \\exp \\left( - \\gamma \\hat{L}^e_{t-1} \\right) }{ \\sum^E_{b=1} \\theta^1_b \\exp \\left( - \\gamma \\hat{L}^b_{t-1} \\right)  }, \\qquad t = 2, \\dots T.')
('10.3', '\\Theta_t = \\sum^E_{b=1} \\theta^1_b \\exp \\left\\{ - \\gamma \\hat{L}^b_t \\right\\}')
('10.3', '\\begin{aligned}\n\\log \\Theta_1 & = \\log \\left( \\sum^E_{b=1} \\theta^1_b  \\exp \\left\\{ -\\gamma \\hat{L}^b_1 \\right\\}  \\right) \\\\\n\\intertext{and, for $t \\geq 2$, }\n\\log \\left( \\frac{\\Theta_t}{\\Theta_{t-1}} \\right) \n& =  \\log \\left( \\frac{ \\sum^E_{b=1} \\theta^1_b \\exp \\left\\{ -\\gamma \\hat{L}^b_{t-1} \\right\\}  \\exp \\left\\{  - \\gamma \\hat{l}_t (\\hat{p}^t_b ; \\hat{p}^t) \\right\\}  }{ \\sum^E_{b=1} \\theta^1_b \\exp \\left\\{ -\\gamma \\hat{L}^b_{t-1} \\right\\} } \\right) \\\\\n& =  \\log \\left( \\sum^E_{b=1} \\theta^t_b \\exp \\left\\{  - \\gamma \\hat{l}_t (\\hat{p}^t_b ; \\hat{p}^t) \\right\\} \\right).\n\\end{aligned}')
('10.3', "\\begin{aligned}\n\\log \\Theta_T \n& = \\log \\Theta_1 + \\sum^T_{t=1} \\log \\left( \\frac{\\Theta_t}{\\Theta_{t-1}} \\right) \\\\\n& = \\sum^T_{t=1} \\log \\left( \\sum^E_{b=1} \\theta^t_b \\exp \\left\\{ -\\gamma \\hat{l}_t (\\hat{p}^t_b ; \\hat{p}^t)  \\right\\}  \\right) \\\\\n& \\leq \\sum^T_{t=1} \\left( \n- \\gamma \\sum^E_{b=1} \\theta^t_b \\hat{l}_t (\\hat{p}^t_b ; \\hat{p}^t) + \\frac{\\gamma^2 M^2 \\bar{a}^t }{ 8 K \\alpha^2 } \\right) && \\text{(Lemma~\\ref{lemma:Hoeffding-inequality})} \\\\\n& \\leq \n- \\gamma \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t ; \\hat{p}^t) + \\frac{\\gamma^2 M^2 \\left( \\sum^T_{t=1} \\bar{a}^t \\right) }{ 8 K \\alpha^2 } && \\text{(Jensen's inequality)}\n\\end{aligned}")
('10.3', '\\begin{gathered}\n\\log \\left( \\Theta_T  \\right) = \\log \\left( \\sum^E_{b=1} \\theta^1_b \\exp \\left\\{ - \\gamma \\hat{L}^b_T \\right\\} \\right) \\\\\n\\geq \\log \\left(  \\max_{1\\leq b \\leq E} \\theta^1_b \\exp \\left\\{ - \\gamma \\hat{L}^b_T \\right\\} \\right) \n= - \\gamma \\min_{1 \\leq b \\leq E} \\left\\{  \\hat{L}^b_T + \\frac{1}{\\gamma} \\log \\frac{1}{\\theta^1_b} \\right\\}.\n\\end{gathered}')
('10.3', '- \\gamma \\min_{1 \\leq b \\leq E} \\left\\{  \\hat{L}^b_T + \\frac{1}{\\gamma} \\log \\frac{1}{\\theta^1_b} \\right\\}\n\\leq - \\gamma \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t ; \\hat{p}^t) + \\frac{\\gamma^2 M^2 \\left( \\sum^T_{t=1} \\bar{a}^t \\right) }{ 8 K \\alpha^2 },')
('10.3', '\\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t ; \\hat{p}^t) - \\hat{L}^e_T \\leq \\frac{\\gamma M^2 \\left( \\sum^T_{t=1} \\bar{a}^t \\right) }{ 8 K \\alpha^2 } + \\frac{1}{\\gamma} \\log \\frac{1}{\\theta^1_e} \\leq \\frac{\\gamma M^2 T \\bar{a}^1 }{ 8 K \\alpha^2 } + \\frac{1}{\\gamma} \\log \\frac{1}{\\theta^1_e},\n\\quad e \\in [E].')
('10.3', '\\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t ; \\hat{p}^t) - \\hat{L}^e_T \\right] \\leq \\frac{\\gamma M^2 T \\mathbb{E} \\left[ \\bar{a}^1 \\right] }{ 8 K \\alpha^2 } + \\frac{1}{\\gamma} \\log \\frac{1}{\\theta^1_e}')
('10.3', '\\theta^1_e \\geq \\frac{1}{E^2}')
('10.3', '\\log 1/\\theta^1_e \\leq 2 \\log E')
('10.3', '\\gamma=\\sqrt{8 K \\alpha^2 / (T M^2 \\mathbb{E}[\\bar{a}^1] ) }')
('10.3', '\\log 1/\\theta^1_e')
('10.3', '\\begin{aligned}\n\\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t ; \\hat{p}^t) - \\hat{L}^e_T \\right] & = \\mathbb{E} \\left[ \\sum^T_{t=1} \\hat{l}_t (\\hat{p}^t ; \\hat{p}^t) - \\sum^T_{t=1} \\hat{l}_t ( \\hat{p}^t_e ; \\hat{p}^t ) \\right] \\\\\n& \\leq \\frac{M}{\\alpha} \\sqrt{ \\frac{T \\mathbb{E} \\left[ \\bar{a}^1 \\right]}{ 8 K } }  \\left( 1 + 2 \\log E \\right),\n\\quad e \\in [E].\n\\end{aligned}')
('10.4', 'T_b=2^{b-1}')
('10.4', '\\hat{p}^{T_b}')
('10.4', '\\text{D-Regret}_b  = \\mathbb{E} \\left[ \\sum^{T_{b+1}-1}_{t=T_b} l_t (\\hat{p}^t)  - \\sum^{T_{b+1}-1}_{t=T_b} l_t (p^t_{\\star}) \\right].')
('10.4', '\\begin{aligned}\n& \\quad \\text{D-Regret}_b \\\\\n& \\leq  \\frac{ (2C+1) \\sqrt{2} M^3 \\sqrt{\\mathbb{E} \\left[ (\\bar{a}^{T_b})^2 \\right]} }{ K^2 \\alpha^3 } \\sqrt{ \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( p^{T_b:(T_{b+1}-1)}_{\\star} \\right) \\right] \\right] (T_{b+1} - T_b) } \\\\\n& \\qquad \\qquad + \\frac{M}{\\alpha} \\sqrt{ \\frac{ (T_{b+1}-T_b) \\mathbb{E} \\left[\\bar{a}^{T_b} \\right] }{ 8 K } } (C + 2 \\log E_b ) \\\\\n& \\leq  \\frac{ (2C+1) \\sqrt{2} M^3  \\sqrt{\\mathbb{E} \\left[ (\\bar{a}^1)^2 \\right]} }{ K^2 \\alpha^3 } \\sqrt{ \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right]  \\right] } ( \\sqrt{2} )^{b-1} \\\\\n& \\qquad \\qquad + \\frac{M}{\\alpha} \\sqrt{ \\frac{  \\mathbb{E} \\left[\\bar{a}^1\\right] }{ 8 K } } (C + 2 \\log E ) (\\sqrt{2})^{b-1},\n\\end{aligned}')
('10.4', 'E')
('10.4', 'B=\\floor{\\log_2 (T+1)}')
('10.4', 'T_B \\leq T \\leq T_{B+1} - 1')
('10.4', '1 \\leq T - T_B + 1 \\leq T_{B+1} - T_B = 2^B')
('10.4', '\\begin{gathered}\n\\mathbb{E} \\left[ \\sum^T_{t=T_B} l_t (\\hat{p}^t)  - \\sum^T_{t=T_B} l_t (p^t_{\\star}) \\right]\\\\\n\\leq  \\frac{ (2C+1) \\sqrt{2} M^3 \\sqrt{\\mathbb{E} \\left[ (\\bar{a}^1)^2 \\right]} }{ K^2 \\alpha^3 } \\sqrt{ \\left[ \\log M + 2 \\log \\left( M / \\alpha \\right) \\mathbb{E} \\left[ \\text{TV} \\left( p^{1:T}_{\\star} \\right) \\right]  \\right] } (\\sqrt{2})^B \\\\\n+ \\frac{M}{\\alpha} \\sqrt{ \\frac{  \\mathbb{E} \\left[\\bar{a}^1\\right] }{ 8 K } } (C + 2 \\log E ) (\\sqrt{2})^B.\n\\end{gathered}')
('10.5', '[M]')
('10.5', 'R_1')
('10.5', 'R_0')
('10.5', 'R_2')
('10.5', '\\delta^t=g^t-\\nabla F(w^t)')
('10.5', '\\begin{aligned}\nF \\left( w^{t+1} \\right) & \\leq F \\left( w^t \\right) + \\left\\langle \\nabla F \\left( w^t \\right), w^{t+1} - w^t \\right\\rangle + \\frac{L}{2} \\mu^2 \\left\\Vert g^t \\right\\Vert^2 \\\\\n& = F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), g^t \\right\\rangle + \\frac{L}{2} \\mu^2 \\left\\Vert g^t \\right\\Vert^2 \\\\\n& = F \\left( w^t \\right) - \\mu \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 - \\mu \\left\\langle \\nabla F \\left( w^t \\right), \\delta^t \\right\\rangle \\\\\n& \\quad + \\frac{L}{2} \\mu^2 \\left[  \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 + 2 \\left\\langle \\nabla F \\left( w^t \\right), \\delta^t \\right\\rangle +  \\left\\Vert \\delta^t \\right\\Vert^2  \\right] \\\\\n& = F \\left( w^t \\right) - \\left( \\mu - \\frac{L}{2} \\mu^2 \\right) \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 - \\left( \\mu - L \\mu^2 \\right) \\left\\langle \\nabla F \\left( w^t \\right), \\delta^t \\right\\rangle + \\frac{L}{2} \\mu^2 \\left\\Vert \\delta^t \\right\\Vert^2. \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-opt-3}\n\\end{aligned}')
('10.5', '\\mathbb{E}\\left[ g^t \\mid w^t, \\hat{p}^t \\right]=\\nabla F(w^t)')
('10.5', '\\mathbb{E}\\left[ \\delta^t \\mid w^t, \\hat{p}^t \\right]=0')
('10.5', '\\mathbb{E}\\left[ \\left\\langle \\nabla F \\left( w^t \\right), \\delta^t \\right\\rangle \\right] = \\mathbb{E}\\left[ \\mathbb{E}\\left[ \\left\\langle \\nabla F \\left( w^t \\right), \\delta^t \\right\\rangle \\mid w^t, \\hat{p}^t \\right]\\right] = 0. \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-opt-2}')
('10.5', '\\tilde{S}^t')
('10.5', '\\vert \\tilde{S}^t \\vert=K')
('10.5', '[M]')
('10.5', 'q_{\\star}')
('10.5', 'J^t=(1/M)\\sum^M_{m=1}g^t_m')
('10.5', '\\tilde{g}^t \\coloneqq \\frac{1}{MK} \\sum_{m \\in \\tilde{S}^t} \\frac{g^t_m}{q^{\\star}_m}.')
('10.5', '\\begin{aligned}\n\\mathbb{E}_{S^t} \\left[  \\left\\Vert \\delta^t \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right] &= \\mathbb{E}_{S^t} \\left[  \\left\\Vert g^t - J^t + J^t - \\nabla F(w^t) \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right] \\\\\n& = \\mathbb{E}_{S^t} \\left[  \\left\\Vert g^t - J^t \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right] + \\left\\Vert J^t - \\nabla F(w^t) \\right\\Vert^2 \\\\\n& = l_t \\left( \\hat{p}^t \\right) - \\left\\Vert J^t \\right\\Vert^2 + \\left\\Vert J^t - \\nabla F(w^t) \\right\\Vert^2 \\\\\n& = l_t \\left( q_{\\star} \\right) - \\left\\Vert J^t \\right\\Vert^2 + \\left\\Vert J^t - \\nabla F(w^t) \\right\\Vert^2 + l_t \\left( \\hat{p}^t \\right) - l_t \\left( q_{\\star} \\right) \\\\\n& = \\mathbb{E}_{\\tilde{S}^t} \\left[  \\left\\Vert \\tilde{g}^t - \\nabla F(w^t) \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right] + l_t \\left( \\hat{p}^t \\right) - l_t \\left( q_{\\star} \\right).\n\\end{aligned}')
('10.5', '\\begin{aligned}\n& \\quad \\mathbb{E} \\left[  \\left\\Vert \\tilde{g}^t - \\nabla F(w^t) \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right]  \\\\\n&= \\mathbb{E} \\left[  \\left\\Vert \\frac{1}{MK} \\sum_{m \\in \\tilde{S}^t} \\frac{g^t_m}{ q^{\\star}_m } - \\nabla F(w^t) \\right\\Vert^2 \\mid w^t, \\hat{p}^t\\right] \\\\\n& \\leq 2\\mathbb{E} \\left[  \\left\\Vert \\frac{1}{MK} \\sum_{m \\in \\tilde{S}^t} \\frac{g^t_m}{ q^{\\star}_m } - \\frac{1}{MK} \\sum_{m \\in \\tilde{S}^t} \\frac{\\nabla F_m(w^t)}{ q^{\\star}_m } \\right\\Vert^2 \\mid w^t, \\hat{p}^t\\right] \\\\\n& \\quad + 2 \\mathbb{E} \\left[  \\left\\Vert \\frac{1}{MK} \\sum_{m \\in \\tilde{S}^t} \\frac{\\nabla F_m(w^t)}{ q^{\\star}_m } - \\nabla F(w^t) \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right] \\\\\n& = \\frac{2}{M^2 K^2} \\mathbb{E} \\left[ \\sum_{m \\in \\tilde{S}^t} \\mathbb{E} \\left[ \\frac{ \\left\\Vert g^t_m - \\nabla F_m(w^t) \\right\\Vert^2}{ (q^{\\star}_m)^2 } \\right] \\mid w^t, \\hat{p}^t\\right] \\\\\n& \\quad + \\frac{2}{K} \\left( \\frac{1}{M^2} \\sum^M_{m=1} \\frac{ \\left\\Vert \\nabla F_m(w^t) \\right\\Vert^2 }{ q^{\\star}_m } - \\left\\Vert \\nabla F(w^t) \\right\\Vert^2 \\right) \\\\\n& \\leq \\frac{2 \\sigma^2}{M^2 K B} \\sum^M_{m=1} \\frac{1}{ q^{\\star}_m } + \\frac{2 \\zeta^2_1}{K} \\leq \\frac{2 \\sigma^2}{K B \\alpha} + \\frac{2 \\zeta^2_1}{K},\n\\end{aligned}')
('10.5', '\\mathbb{E} \\left[\\left\\Vert g^t_m - \\nabla F_m(w^t) \\right\\Vert^2 \\right] \\leq \\sigma^2 / B')
('10.5', '\\zeta_1')
('10.5', 'q^{\\star}_m \\geq \\alpha / M')
('10.5', '\\begin{aligned}\n\\mathbb{E} \\left[  \\left\\Vert \\delta^t \\right\\Vert^2 \\mid w^t, \\hat{p}^t \\right] \\leq \\frac{2 \\sigma^2}{K B\\alpha} + \\frac{2 \\zeta^2_1}{K} + l_t \\left( \\hat{p}^t \\right) - l_t \\left( q_{\\star} \\right),\n\\end{aligned}')
('10.5', '\\begin{aligned}\n\\sum^{T-1}_{t=0} \\mathbb{E} \\left[  \\left\\Vert \\delta^t \\right\\Vert^2  \\right] &\\leq \\frac{2 T \\sigma^2}{K B \\alpha} + \\frac{2 T \\zeta^2_1}{K} + \\mathbb{E} \\left[ \\sum^{T-1}_{t=0} l_t \\left( \\hat{p}^t \\right) - \\sum^{T-1}_{t=0} l_t \\left( q_{\\star} \\right) \\right] \\\\\n& = \\frac{2 T \\sigma^2}{K B \\alpha} + \\frac{2 T \\zeta^2_1}{K} + \\text{D-Regret}_T(q^{\\star}). \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-opt-1}\n\\end{aligned}')
('10.5', '\\begin{aligned}\n& \\quad \\left( \\mu - \\frac{L}{2} \\mu^2 \\right) \\sum^{T-1}_{t=0} \\mathbb{E} \\left[ \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 \\right] \\\\\n& \\leq F(w^1) - F(w^T) + \\frac{L}{2} \\mu^2 \\left( \\frac{2 T \\sigma^2}{K B \\alpha} + \\frac{2 T \\zeta^2_1}{K} + \\text{D-Regret}_T(q^{\\star}) \\right)\\\\\n& \\leq D^F + \\frac{L}{2} \\mu^2 \\left( \\frac{2 T \\sigma^2}{K B \\alpha} + \\frac{2 T \\zeta^2_1}{K} + \\text{D-Regret}_T(q^{\\star}) \\right).\n\\end{aligned}')
('10.5', '\\mu \\leq 1/L')
('10.5', '(\\mu - \\frac{L}{2} \\mu^2)=\\mu(1-\\frac{L}{2} \\mu) \\geq \\mu/2')
('10.5', '\\begin{aligned}\n\\frac{1}{T} \\sum^{T-1}_{t=0} \\mathbb{E} \\left[ \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 \\right] \\leq \\frac{2 D^F}{T \\mu} + L \\mu \\left( \\frac{2 \\sigma^2}{K B \\alpha} + \\frac{2 \\zeta^2_1}{K} + \\frac{\\text{D-Regret}_T(q^{\\star})}{T}  \\right).\n\\end{aligned}')
('10.5', '\\label{eq:choice-mu}\n\\mu=\\min \\left\\{1/L, (1/\\sigma)\\sqrt{D^F K B \\alpha / (L T)}, (1/\\zeta_1)\\sqrt{D^F K / (T L)}, \\sqrt{D^F/(L \\text{D-Regret}_T(q^{\\star}))} \\right\\},')
('10.5', '\\begin{aligned}\n& \\quad \\frac{1}{T} \\sum^{T-1}_{t=0} \\mathbb{E} \\left[ \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 \\right] \\\\\n& \\lesssim \\frac{D^F}{T} \\max \\left\\{ L, \\sigma \\sqrt{ \\frac{L T}{ D^F K B \\alpha } }, \\zeta_1 \\sqrt{ \n\\frac{T L }{D^F K} }, \\sqrt{ \\frac{ L \\text{D-Regret}_T(q^{\\star})) }{D^F} } \\right\\} \\\\\n& \\quad + \\frac{ \\sigma \\sqrt{D^F L} }{ \\sqrt{TKB \\alpha } } + \\frac{\\zeta_1 \\sqrt{D^F L }}{\\sqrt{T K}} + \\frac{ \\sqrt{ D^F L} \\sqrt{ \\text{D-Regret}_T(q^{\\star})) } }{ T } \\\\\n& \\lesssim \\frac{D^F}{T} \\left( L + \\sigma \\sqrt{ \\frac{L T}{ D^F K B \\alpha } } + \\zeta_1 \\sqrt{ \n\\frac{T L }{D^F K} } + \\sqrt{ \\frac{ L \\text{D-Regret}_T(q^{\\star})) }{D^F} }  \\right) \\\\\n& \\quad + \\frac{ \\sigma \\sqrt{D^F L} }{ \\sqrt{TKB \\alpha } } + \\frac{\\zeta_1 \\sqrt{D^F L }}{\\sqrt{T K}} + \\frac{ \\sqrt{ D^F L} \\sqrt{ \\text{D-Regret}_T(q^{\\star})) } }{ T } \\\\\n& \\lesssim \\frac{D^F L}{T} + \\frac{ \\sigma \\sqrt{D^F L} }{ \\sqrt{TKB \\alpha } } + \\frac{\\zeta_1 \\sqrt{D^F L }}{\\sqrt{T K}} + \\frac{ \\sqrt{ D^F L} \\sqrt{ \\text{D-Regret}_T(q^{\\star})) } }{ T }.\n\\end{aligned}')
('10.6', '[M]')
('10.6', 'R_1')
('10.6', 'R_0')
('10.6', 'R_2')
('10.6', '\\begin{aligned}\nF \\left( w^{t+1} \\right) & \\leq F \\left( w^t \\right) + \\left\\langle \\nabla F \\left( w^t \\right), w^{t+1} - w^t \\right\\rangle + \\frac{L}{2} \\left\\Vert w^{t+1} - w^t \\right\\Vert^2,\n\\end{aligned}')
('10.6', 'w^{t+1} - w^t = - \\frac{\\mu}{MK} \\sum_{m \\in S^t} \\frac{1}{\\hat{p}^t_m} g^t_m , \\quad g^t_m = \\mu_l \\sum^{B-1}_{b=0} \\nabla \\phi ( w^{t,b}_m ; \\xi^{t,b}_{m} ).')
('10.6', '\\mathcal{B}^t_m= \\{ \\xi^{t,0}_{m},\\ldots,\\xi^{t,B-1}_{m} \\}')
('10.6', '\\mathbb{E}_{S^t}[\\cdot]')
('10.6', 'S^t')
('10.6', '\\begin{aligned}\n\\mathbb{E}_{S^t} \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), \\frac{1}{M} \\sum^M_{m=1} g^t_m \\right\\rangle \\\\\n& \\quad + \\frac{L \\mu^2}{2} \\mathbb{E}_{S^t} \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in S^t} \\frac{1}{M \\hat{p}^t_m} g^t_m \\right\\Vert^2 \\right]. \n\\end{aligned}')
('10.6', 'J^t=(1/M)\\sum^M_{m=1}g^t_m')
('10.6', '\\begin{aligned}\n\\mathbb{E}_{S^t} \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), J^t \\right\\rangle  + \\frac{L \\mu^2}{2 } \\mathbb{E}_{S^t} \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in S^t} \\frac{1}{M \\hat{p}^t_m} g^t_m - J^t + J^t\\right\\Vert^2 \\right] \\\\\n& = F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), J^t \\right\\rangle + \\frac{L \\mu^2}{2} \\left\\Vert J^t \\right\\Vert^2\\\\\n& \\quad + \\frac{L \\mu^2}{2 } \\mathbb{E}_{S^t} \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in S^t} \\frac{1}{M\\hat{p}^t_m} g^t_m - J^t \\right\\Vert^2 \\right].\n\\end{aligned}')
('10.6', 'a^t_m= \\frac{ \\Vert g^t_m \\Vert^2 }{B  (M \\mu_l)^2}')
('10.6', '\\begin{aligned}\n\\mathbb{E}_{S^t} \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in S^t} \\frac{1}{M\\hat{p}^t_m} g^t_m - J^t \\right\\Vert^2 \\right] & = \\frac{1}{K} \\sum^M_{m=1} \\frac{\\left\\Vert g^t_m \\right\\Vert^2}{M^2 \\hat{p}^t_m  } - \\frac{1}{K} \\left\\Vert J^t \\right\\Vert^2 \\\\\n& = B \\mu^2_l \\frac{1}{K} \\sum^M_{m=1} \\frac{\\left\\Vert g^t_m \\right\\Vert^2}{ B (\\mu_l M)^2 \\hat{p}^t_m  } - \\frac{1}{K} \\left\\Vert J^t \\right\\Vert^2 \\\\\n& = B \\mu^2_l \\frac{1}{K} \\sum^M_{m=1} \\frac{a^t_m}{  \\hat{p}^t_m  } - \\frac{1}{K} \\left\\Vert J^t \\right\\Vert^2 \\\\\n& = B \\mu^2_l l_t \\left( \\hat{p}^t \\right) - \\frac{1}{K} \\left\\Vert J^t \\right\\Vert^2,\n\\end{aligned}')
('10.6', '\\label{eq:proof-thm-fedavg-1}\n\\mathbb{E}_{S^t} \\left[ F \\left( w^{t+1} \\right) \\right] \\leq  F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), J^t \\right\\rangle + \\frac{L \\mu^2}{2 } \\left\\Vert J^t \\right\\Vert^2 + \\frac{ B L \\mu^2 \\mu^2_l }{2} \\left( l_t(\\hat{p}^t) - \\frac{1}{K} \\left\\Vert J^t  \\right\\Vert^2 \\right),')
('10.6', 'l_t(q)')
('10.6', '\\tilde{S}^t')
('10.6', '\\vert \\tilde{S}^t \\vert=K')
('10.6', '[M]')
('10.6', 'q_{\\star}')
('10.6', '\\tilde{g}^t \\coloneqq \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{g^t_m}{M q^{\\star}_m},')
('10.6', '\\mathbb{E}_{\\tilde{S}^t} \\left[ \\left\\Vert \\tilde{g}^t - J^t  \\right\\Vert^2  \\right] =  l_t(q^{\\star}) - \\frac{1}{K} \\left\\Vert J^t  \\right\\Vert^2 .')
('10.6', '\\begin{aligned}\n\\mathbb{E}_{S^t} \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), J^t \\right\\rangle + \\frac{L \\mu^2}{2 } \\left\\Vert J^t \\right\\Vert^2  + \\frac{L \\mu^2}{2} \\left(  l_t(q^{\\star}) - \\frac{1}{K} \\left\\Vert J^t  \\right\\Vert^2 \\right) \\\\\n& \\quad + \\frac{L \\mu^2 }{2} \\left( l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right) \\\\\n& = F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), J^t \\right\\rangle + \\frac{L \\mu^2}{2 } \\left\\Vert J^t \\right\\Vert^2 +  \\frac{B L \\mu^2 \\mu^2_l }{2} \\left( l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right) \\\\\n& \\quad + \\frac{L \\mu^2}{2 } \\mathbb{E}_{\\tilde{S}^t} \\left[ \\left\\Vert \\tilde{g}^t - J^t  \\right\\Vert^2  \\right] \\\\\n&= F \\left( w^t \\right) - \\mu \\left\\langle \\nabla F \\left( w^t \\right), J^t \\right\\rangle + \\frac{L \\mu^2}{2 } \\mathbb{E}_{\\tilde{S}^t} \\left[ \\left\\Vert \\tilde{g}^t \\right\\Vert^2  \\right] +  \\frac{B L \\mu^2 \\mu^2_l }{2} \\left( l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right).\n\\end{aligned}')
('10.6', '\\mathbb{E}_t[\\cdot]')
('10.6', 'w^t')
('10.6', '\\label{eq:proof-thm-fedavg-5}\n\\begin{aligned}\n\\mathbb{E}_t \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\frac{\\mu\\mu_l}{M} \\mathbb{E}_t \\left[  \\left\\langle \\nabla F \\left( w^t \\right), \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\nabla F_m(w^{t,b}_m) \\right\\rangle \\right] \\\\\n& \\quad + \\frac{L \\mu^2}{2 } \\mathbb{E}_t \\left[ \\left\\Vert \\tilde{g}^t \\right\\Vert^2  \\right] +  \\frac{L \\mu^2 }{2} \\mathbb{E}_t \\left[l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right].\n\\end{aligned}')
('10.6', 'u,v \\in \\mathbb{R}^d')
('10.6', '-\\langle u,v \\rangle = -\\frac{1}{2} \\Vert u \\Vert^2 + \\frac{1}{2} \\Vert u - v \\Vert - \\frac{1}{2} \\Vert v \\Vert^2 \\leq -\\frac{1}{2} \\Vert u \\Vert^2 + \\frac{1}{2} \\Vert u - v \\Vert')
('10.6', '\\begin{aligned}\n&\\quad \\mathbb{E}_t \\left[ - \\frac{\\mu \\mu_l}{M}\\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\langle \\nabla F \\left( w^t \\right),  \\nabla F_m(w^{t,b}_m) \\right\\rangle \\right] \\\\\n& = \\mathbb{E}_t \\left[ - \\mu \\mu_l \\sum^{B-1}_{b=0} \\left\\langle \\nabla F \\left( w^t \\right),  \\frac{1}{M}\\sum^M_{m=1}\\nabla F_m(w^{t,b}_m) \\right\\rangle \\right] \\\\\n& \\leq -\\frac{\\mu \\mu_l B}{2}  \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 + \\frac{\\mu \\mu_l}{2} \\sum^{B-1}_{b=0} \\left\\Vert \\nabla F \\left( w^t \\right) -\\frac{1}{M}\\sum^M_{m=1} \\nabla F_m(w^{t,b}_m) \\right\\Vert^2 \\\\\n& = -\\frac{\\mu \\mu_l B}{2}  \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 + \\frac{\\mu \\mu_l}{2} \\sum^{B-1}_{b=0} \\left\\Vert  \\frac{1}{M}\\sum^M_{m=1} \\left( \\nabla F_m \\left( w^t \\right) - \\nabla F_m(w^{t,b}_m) \\right) \\right\\Vert^2 \\\\\n& \\leq -\\frac{\\mu \\mu_l B}{2}  \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 + \\frac{\\mu \\mu_l}{2M} \\mathbb{E}_t \\left[ \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert \\nabla F_m \\left( w^t \\right) - \\nabla F_m(w^{t,b}_m) \\right\\Vert^2 \\right] \\\\\n& \\leq -\\frac{\\mu \\mu_l B}{2}  \\left\\Vert \\nabla F \\left( w^t \\right) \\right\\Vert^2 + \\frac{\\mu \\mu_l L^2}{2M} \\mathbb{E}_t \\left[ \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert w^t - w^{t,b}_m \\right\\Vert^2 \\right]. \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm-fedavg-6}\n\\end{aligned}')
('10.6', '\\begin{aligned}\n\\mathbb{E}_t \\left[ \\left\\Vert \\tilde{g}^t \\right\\Vert^2 \\right] &= \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{g^t_m}{M q^{\\star}_m} \\right\\Vert^2 \\right] = \\mu^2_l \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\sum^{B-1}_{b=0} \\nabla \\phi ( w^{t,b}_m ; \\xi^{t,b}_{m} ) \\right\\Vert^2 \\right] \\\\\n& = \\mu^2_l \\underbrace{\\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\sum^{B-1}_{b=0} \\left( \\nabla \\phi ( w^{t,b}_m ; \\xi^{t,b}_{m} ) - \\nabla F_m (w^{t,b}_m \\right) \\right\\Vert^2 \\right]}_\\text{$I_1$} \\\\\n& \\quad + \\mu^2_l \\underbrace{\\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\sum^{B-1}_{b=0} \\nabla F_m (w^{t,b}_m) \\right\\Vert^2 \\right]}_\\text{$I_2$}. \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm-fedavg-2}\n\\end{aligned}')
('10.6', 'I_1')
('10.6', '\\begin{aligned}\nI_1 & = \\frac{1}{K} \\sum^M_{m=1} \\frac{1}{M^2 q^{\\star}_m }  \\mathbb{E}_t \\left[ \\left\\Vert \\sum^{B-1}_{b=0} \\nabla \\phi ( w^{t,b}_m ; \\xi^{t,b}_{m} ) - \\nabla F_m (w^{t,b}) \\right\\Vert^2 \\right] \\\\\n& = \\frac{1}{K} \\sum^M_{m=1} \\frac{1}{M^2 q^{\\star}_m }  \\sum^{B-1}_{b=0}\\mathbb{E}_t \\left[  \\left\\Vert \\nabla \\phi ( w^{t,b}_m ; \\xi^{t,b}_{m} ) - \\nabla F_m (w^{t,b}) \\right\\Vert^2 \\right] \\\\\n& \\leq \\frac{\\sigma^2 B}{M^2K} \\sum^M_{m=1} \\frac{1}{ q^{\\star}_m }.\n\\end{aligned}')
('10.6', 'q^{\\star}_m \\geq \\alpha/M')
('10.6', '\\label{eq:proof-thm-fedavg-3}\nI_1 \\leq \\frac{\\sigma^2 B}{K \\alpha}.')
('10.6', 'I_2')
('10.6', '\\begin{aligned}\nI_2 & = \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\sum^{B-1}_{b=0} \\left( \\nabla F_m (w^{t,b}_m) - \\nabla F_m(w^t) + \\nabla F_m(w^t) \\right) \\right\\Vert^2 \\right] \\\\\n& \\leq 2 \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\sum^{B-1}_{b=0} \\left( \\nabla F_m (w^{t,b}_m) - \\nabla F_m(w^t)  \\right) \\right\\Vert^2 \\right] \\\\\n& \\quad + 2 B^2 \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m}  \\nabla F_m(w^t) \\right\\Vert^2 \\right] \\\\\n& \\leq 2 \\mathbb{E}_t \\left[  \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\left\\Vert \\frac{1}{M q^{\\star}_m} \\sum^{B-1}_{b=0} \\left( \\nabla F_m (w^{t,b}_m) - \\nabla F_m(w^t)  \\right) \\right\\Vert^2 \\right] \\\\\n& \\quad + 2 B^2 \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\nabla F_m(w^t) - \\nabla F (w^t) + \\nabla F(w^t) \\right\\Vert^2 \\right] \\\\\n&= 2 \\mathbb{E}_t \\left[  \\sum^M_{m=1} \\frac{1}{M^2 q^{\\star}_m}  \\left\\Vert \\sum^{B-1}_{b=0} \\left( \\nabla F_m (w^{t,b}_m) - \\nabla F_m(w^t)  \\right)  \\right\\Vert^2  \\right] \\\\\n& \\quad + 2 B^2 \\mathbb{E}_t \\left[ \\left\\Vert \\frac{1}{K} \\sum_{m \\in \\tilde{S}^t} \\frac{1}{M q^{\\star}_m} \\nabla F_m(w^t) - \\nabla F (w^t)  \\right\\Vert^2 \\right] +2 B^2 \\left\\Vert \\nabla F (w^t) \\right\\Vert^2 \\\\\n& \\leq 2 B \\mathbb{E}_t \\left[  \\sum^M_{m=1} \\frac{1}{M^2 q^{\\star}_m}   \\sum^{B-1}_{b=0} \\left\\Vert  \\nabla F_m (w^{t,b}_m) - \\nabla F_m(w^t)   \\right\\Vert^2  \\right] + 2 B^2 \\left\\Vert \\nabla F (w^t) \\right\\Vert^2 \\\\\n& \\quad + \\frac{2 B^2}{K} \\left( \\frac{1}{M^2} \\sum^M_{m=1} \\frac{1}{q^{\\star}_m} \\left\\Vert \\nabla F_m(w^t)  \\right\\Vert^2 -  \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 \\right) \\\\\n& \\leq 2 B \\mathbb{E}_t \\left[  \\sum^M_{m=1} \\frac{1}{M^2 q^{\\star}_m}   \\sum^{B-1}_{b=0} \\left\\Vert  \\nabla F_m (w^{t,b}_m) - \\nabla F_m(w^t)   \\right\\Vert^2  \\right] + 2 B^2 \\left\\Vert \\nabla F (w^t) \\right\\Vert^2 + \\frac{2 B^2 \\zeta^2_1 }{K} \\\\\n& \\leq 2 B L^2 \\mathbb{E}_t \\left[  \\sum^M_{m=1} \\frac{1}{M^2 q^{\\star}_m}   \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] + 2 B^2 \\left\\Vert \\nabla F (w^t) \\right\\Vert^2 + \\frac{2 B^2 \\zeta^2_1 }{K}, \\addtocounter{equation}{1}\\tag{\\theequation}\\label{eq:proof-thm-fedavg-4}\n\\end{aligned}')
('10.6', '\\zeta^2_1')
('10.6', 'q^{\\star}')
('10.6', 'q^{\\star}_m \\geq \\alpha/M')
('10.6', '\\label{eq:proof-thm-fedavg2-4}\nI_2 \\leq \\frac{2 B L^2}{M\\alpha} \\mathbb{E}_t \\left[  \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] + 2 B^2 \\left\\Vert \\nabla F (w^t) \\right\\Vert^2 + \\frac{2 B^2 \\zeta^2_1 }{K}.')
('10.6', '\\begin{aligned}\n\\frac{L \\mu^2 }{2} \\mathbb{E}_t \\left[ \\left\\Vert \\tilde{g}^t \\right\\Vert^2 \\right] & \\leq \\frac{\\mu^2 \\mu^2_l  L \\sigma^2 B}{2 K \\alpha} + \\frac{\\mu^2 \\mu^2_l  L^3 B}{M \\alpha}  \\mathbb{E}_t \\left[  \\sum^M_{m=1}  \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] \\\\\n& \\quad + \\mu^2 \\mu^2_l  B^2 L \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 + \\frac{\\mu^2 \\mu^2_l  L B^2 \\zeta^2_1}{K}.\n\\end{aligned}')
('10.6', '\\begin{aligned}\n\\mathbb{E}_t \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\frac{\\mu \\mu_l B}{2} \\left( 1 - 2 \\mu \\mu_l B L \\right) \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 \\\\\n& \\quad + \\frac{\\mu \\mu_l L^2}{M} \\left( \\frac{1}{2} + \\frac{\\mu \\mu_l L B}{\\alpha} \\right) \\mathbb{E}_t \\left[  \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] \\\\\n& \\quad + \\frac{\\mu^2 \\mu^2_l L \\sigma^2 B}{2 K \\alpha} + \\frac{\\mu^2 \\mu^2_l L B^2 \\zeta^2_1}{K} + \\frac{B L \\mu^2 \\mu^2_l }{2} \\mathbb{E}_t \\left[l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right].\n\\end{aligned}')
('10.6', '\\tilde{\\mu}=\\mu \\mu_l')
('10.6', '\\tilde{\\mu} \\leq \\frac{1}{4 B L}')
('10.6', '\\label{eq:proof-thm-fedavg-8}\n\\begin{aligned}\n\\mathbb{E}_t \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\frac{\\tilde{\\mu} B}{4} \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 \\\\\n& \\quad + \\tilde{\\mu} L^2 \\left( \\frac{1}{2} + \\frac{1}{4\\alpha} \\right) \\mathbb{E}_t \\left[ \\frac{1}{M} \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] \\\\\n& \\quad + \\frac{\\tilde{\\mu}^2 B L \\sigma^2}{2 K \\alpha} + \\frac{\\tilde{\\mu}^2 B^2 L  \\zeta^2_1}{K} + \\frac{B L \\mu^2 \\mu^2_l}{2} \\mathbb{E}_t \\left[l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right].\n\\end{aligned}')
('10.6', '\\label{eq:proof-thm-fedavg-7}\n\\mathbb{E}_t \\left[ \\frac{1}{M} \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] \\leq 4 B^3 \\mu^2_l \\zeta^2_0 + 4 B^3 \\mu^2_l \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 + 2 B^2 \\mu^2_l \\sigma^2.')
('10.6', 'b=0')
('10.6', 'w^{t,b}_m=w^t')
('10.6', '\\mathbb{E}_t [ \\Vert  w^{t,0}_m - w^t   \\Vert^2 ]=0')
('10.6', 'b \\geq 1')
('10.6', '\\begin{aligned}\n& \\quad \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b}_m - w^t \\right\\Vert^2 \\right] \\\\\n& = \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b-1}_m - \\mu_l \\nabla f \\left( w^{t,b-1}_m ; \\xi^{t,b-1}_m \\right) - w^t \\right\\Vert^2 \\right] \\\\\n& = \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b-1}_m - \\mu_l \\nabla F_m \\left( w^{t,b-1}_m  \\right) - w^t \\right\\Vert^2 \\right] \\\\\n& \\quad + \\mu^2_l \\mathbb{E}_t \\left[ \\left\\Vert  \\nabla f \\left( w^{t,b-1}_m ; \\xi^{t,b-1}_m \\right) - \\nabla F_m \\left( w^{t,b-1}_m  \\right) \\right\\Vert^2 \\right] \\\\\n& \\leq \\left( 1 - \\frac{1}{B-1} \\right) \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b-1}_m  - w^t \\right\\Vert^2 \\right] + B \\mu^2_l \\mathbb{E}_t \\left[ \\left\\Vert  \\nabla F_m \\left( w^{t,b-1}_m  \\right) \\right\\Vert^2 \\right] + \\mu^2_l \\sigma^2 \\\\\n& \\leq \\left( 1 - \\frac{1}{B-1} \\right) \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b-1}_m  - w^t \\right\\Vert^2 \\right] + 2 B \\mu^2_l \\left\\Vert \\nabla F_m \\left( w^{t,b-1}_m  \\right) - \\nabla F_m (w^t) \\right\\Vert^2 \\\\\n& \\quad + 2 B \\mu^2_l \\left\\Vert  \\nabla F_m (w^t) \\right\\Vert^2 + \\mu^2_l \\sigma^2 \\\\\n& \\leq \\left( 1 - \\frac{1}{B-1} + 2 B \\mu^2_l L^2 \\right) \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b-1}_m  - w^t \\right\\Vert^2 \\right] + 2 B \\mu^2_l \\left\\Vert  \\nabla F_m (w^t) \\right\\Vert^2 + \\mu^2_l \\sigma^2,\n\\end{aligned}')
('10.6', '\\mu_l \\leq \\frac{1}{2 B L}')
('10.6', '\\mathbb{E}_t \\left[ \\left\\Vert w^{t,b}_m - w^t \\right\\Vert^2 \\right] \\leq \\left( 1 - \\frac{1}{2 (B-1)}  \\right) \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b-1}_m  - w^t \\right\\Vert^2 \\right] + 2 B \\mu^2_l \\left\\Vert  \\nabla F_m (w^t) \\right\\Vert^2 + \\mu^2_l \\sigma^2.')
('10.6', '\\mathbb{E}_t \\left[ \\left\\Vert w^{t,b}_m - w^t \\right\\Vert^2 \\right] \\leq \\left( 2 B \\mu^2_l \\left\\Vert  \\nabla F_m (w^t) \\right\\Vert^2 + \\mu^2_l \\sigma^2 \\right) \\sum^{b-1}_{\\tau=0} \\left( 1 - \\frac{1}{2 (B-1)} \\right)^\\tau')
('10.6', '\\sum^{b-1}_{\\tau=0} \\left( 1 -  \\frac{1}{2 (B-1)} \\right)^\\tau = \\frac{1 - \\left( 1 - \\frac{1}{2 (B-1)} \\right)^\\tau }{  \\left( 1 - \\frac{1}{2 (B-1)} \\right)  } \\leq \\frac{1 }{  \\left( 1 - \\frac{1}{2 (B-1)} \\right)  } = 2 (B-1) \\leq 2 B,')
('10.6', '\\mathbb{E}_t \\left[ \\left\\Vert w^{t,b}_m - w^t \\right\\Vert^2 \\right] \\leq 4 B^2 \\mu^2_l \\left\\Vert  \\nabla F_m (w^t) \\right\\Vert^2 + 2 B \\mu^2_l \\sigma^2,')
('10.6', '\\begin{aligned}\n& \\quad \\frac{1}{M} \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\mathbb{E}_t \\left[ \\left\\Vert w^{t,b}_m - w^t \\right\\Vert^2 \\right] \\\\\n& \\leq 4 B^3 \\mu^2_l \\frac{1}{M} \\sum^M_{m=1}\\left\\Vert  \\nabla F_m (w^t) \\right\\Vert^2 + 2 B^2 \\mu^2_l \\sigma^2 \\\\\n& \\leq 4 B^3 \\mu^2_l \\left(\\frac{1}{M} \\sum^M_{m=1}\\left\\Vert  \\nabla F_m (w^t) - \\nabla F(w^t) \\right\\Vert^2 +  \\left\\Vert  \\nabla F(w^t) \\right\\Vert^2 \\right) + 2 B^2 \\mu^2_l \\sigma^2 \\\\\n& \\leq 4 B^3 \\mu^2_l \\zeta^2_0 + 4 B^3 \\mu^2_l \\left\\Vert  \\nabla F(w^t) \\right\\Vert^2 + 2 B^2 \\mu^2_l \\sigma^2,\n\\end{aligned}')
('10.6', '\\zeta^2_0')
('10.6', '\\begin{aligned}\n& \\quad \\tilde{\\mu} L^2 \\left( \\frac{1}{2} + \\frac{1}{4\\alpha} \\right) \\mathbb{E}_t \\left[ \\frac{1}{M} \\sum^M_{m=1} \\sum^{B-1}_{b=0} \\left\\Vert  w^{t,b}_m - w^t   \\right\\Vert^2  \\right] \\\\\n& \\leq \\left(2 + \\frac{1}{\\alpha} \\right) \\tilde{\\mu} \\mu^2_l B^3 L^2 \\zeta^2_0 + \\left(2 + \\frac{1}{\\alpha} \\right) \\tilde{\\mu} \\mu^2_l B^3 L^2 \\left\\Vert \\nabla F(w^t) \\right\\Vert^2 + \\left( 1 + \\frac{1}{2 \\alpha} \\right) \\tilde{\\mu} \\mu^2_l B^2 L^2 \\sigma^2.\n\\end{aligned}')
('10.6', '\\begin{aligned}\n\\mathbb{E}_t \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\frac{\\tilde{\\mu} B}{4} \\left( 1 - 4 \\left( 2 + \\frac{1}{\\alpha} \\right) \\mu^2_l B^2 L^2 \\right) \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 \\\\\n& \\quad + \\left( 2 + \\frac{1}{\\alpha} \\right) \\tilde{\\mu} \\mu^2_l B^2 L^2 \\left( B \\zeta^2_0 + \\frac{\\sigma^2}{2} \\right) + \\frac{ \\tilde{\\mu}^2 B L }{ K } \\left( \\frac{ \\sigma^2 }{2 \\alpha} + B \\zeta^2_1 \\right) \\\\\n& \\quad + \\frac{B L \\mu^2 \\mu^2_l}{2} \\mathbb{E}_t \\left[l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right].\n\\end{aligned}')
('10.6', '\\mu_l \\leq \\frac{1}{4 B L} \\sqrt{\\frac{1}{1+1/(2\\alpha)}}')
('10.6', '\\begin{aligned}\n\\mathbb{E}_t \\left[ F \\left( w^{t+1} \\right) \\right] & \\leq F \\left( w^t \\right) - \\frac{\\tilde{\\mu} B}{8} \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2  + \\left( 2 + \\frac{1}{\\alpha} \\right) \\tilde{\\mu} \\mu^2_l B^2 L^2 \\left( B \\zeta^2_0  + \\frac{\\sigma^2}{2} \\right) \\\\\n& \\quad + \\frac{ \\tilde{\\mu}^2 B L }{ K } \\left( \\frac{ \\sigma^2 }{2 \\alpha} + B \\zeta^2_1 \\right)  + \\frac{ B L \\tilde{\\mu}^2 }{2} \\mathbb{E}_t \\left[l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right],\n\\end{aligned}')
('10.6', '\\begin{aligned}\n\\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 & \\leq \\frac{ 8 }{\\tilde{\\mu} B } \\left( F \\left( w^t \\right) - \\mathbb{E}_t \\left[ F \\left( w^{t+1} \\right) \\right] \\right) + 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\mu^2_l B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right) \\\\\n&\\quad + \\frac{ 8 \\tilde{\\mu} B L }{ K } \\left( \\frac{\\sigma^2}{ 2 B \\alpha } + \\zeta^2_1 \\right) + 4 L \\tilde{\\mu} \\mathbb{E}_t \\left[l_t(\\hat{p}^t) - l_t(q^{\\star}) \\right].\n\\end{aligned}')
('10.6', 't=0')
('10.6', 't=T-1')
('10.6', '\\begin{aligned}\n\\frac{1}{T} \\sum^{T-1}_{t=0} \\mathbb{E} \\left[ \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 \\right] & \\leq \\frac{ 8 }{\\tilde{\\mu} B } \\left( F (w^0) - \\mathbb{E} \\left[ F(w^T) \\right] \\right) + 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\mu^2_l B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right) \\\\\n& \\quad + \\frac{ 8 \\tilde{\\mu} B L }{ K } \\left( \\frac{\\sigma^2}{ 2 B \\alpha } + \\zeta^2_1 \\right) + 4 L \\tilde{\\mu} \\times \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{T} \\\\\n& \\leq \\frac{ 8 }{\\tilde{\\mu} B } \\left( F (w^0) - F^{\\star} \\right) + 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\mu^2_l B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right) \\\\\n& \\quad + \\frac{ 8 \\tilde{\\mu} B L }{ K } \\left( \\frac{\\sigma^2}{ 2 B \\alpha } + \\zeta^2_1 \\right) + 4 L \\tilde{\\mu} \\times \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{T}.\n\\end{aligned}')
('10.6', '\\tilde{\\mu} \\leq \\frac{1}{4 B L}')
('10.6', '\\mu_l \\leq \\frac{1}{4 B L} \\sqrt{\\frac{1}{1+1/(2\\alpha)}}')
('10.6', '\\begin{aligned}\n\\mathbb{E} \\left[ \\left\\Vert \\nabla F(w^R)  \\right\\Vert^2 \\right] & =\n\\frac{1}{T} \\sum^{T-1}_{t=0} \\mathbb{E} \\left[ \\left\\Vert \\nabla F(w^t)  \\right\\Vert^2 \\right] \\\\\n& \\leq \\frac{ 8 }{\\tilde{\\mu} B T } \\left( F (w^0) - F^{\\star} \\right) + 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\mu^2_l B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right) \\\\\n& \\quad +  4 \\tilde{\\mu} B L  \\left( \\frac{2 \\zeta^2_1}{K} + \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} \\right).\n\\end{aligned}')
('10.6', '\\mu \\geq 1')
('10.6', '\\tilde{\\mu}\\leq \\frac{1}{4 B L} \\sqrt{\\frac{1}{1+1/(2\\alpha)}}')
('10.6', 'D^F=F (w^0) - F^{\\star}')
('10.6', '\\begin{aligned}\n\\mathbb{E} \\left[ \\left\\Vert \\nabla F(w^R)  \\right\\Vert^2 \\right] & \\leq \\frac{ 8 D^F}{\\tilde{\\mu} B T } + 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\tilde{\\mu}^2 B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right) \\\\\n& \\quad +  4 \\tilde{\\mu} B L  \\left( \\frac{2 \\zeta^2_1}{K} + \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} \\right).\n\\end{aligned}')
('10.6', '\\frac{ 8 D^F}{\\tilde{\\mu} B T } = 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\tilde{\\mu}^2 B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right),')
('10.6', '\\tilde{\\mu} = \\frac{(D^F)^{\\frac{1}{3}}}{  \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} B L^{\\frac{2}{3}} \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right)^{\\frac{1}{3}} T^{\\frac{1}{3}} },')
('10.6', '\\begin{gathered}\n\\frac{ 8 D^F}{\\tilde{\\mu} B T } + 8 \\left( 2 + \\frac{1}{\\alpha}  \\right) \\tilde{\\mu}^2 B^2 L^2 \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right) \\leq \\frac{ 16 \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F)^{\\frac{2}{3}} L^{\\frac{2}{3}} \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right)^{\\frac{1}{3}}  }{ T^{\\frac{2}{3}} } \\\\\n\\leq \\frac{ 16 \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F)^{\\frac{2}{3}} L^{\\frac{2}{3}} \\left( \\zeta^{\\frac{2}{3}}_0  + \\frac{\\sigma^{\\frac{2}{3}}}{ (2 B)^{\\frac{1}{3}} } \\right)  }{ T^{\\frac{2}{3}} }\n\\end{gathered}')
('10.6', '\\frac{ 8 D^F}{\\tilde{\\mu} B T } = 4 \\tilde{\\mu} B L  \\left( \\frac{2 \\zeta^2_1}{K} + \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} \\right),')
('10.6', '\\tilde{\\mu} = \\frac{ \\sqrt{ 2 D^F }  }{  B \\sqrt{L} \\sqrt{ \\frac{2 \\zeta^2_1}{K} +  \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} } \\sqrt{T} },')
('10.6', '\\begin{gathered}\n\\frac{ 8 D^F}{\\tilde{\\mu} B T } + 4 \\tilde{\\mu} B L  \\left( \\frac{2 \\zeta^2_1}{K} + \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} \\right) \\\\\n\\leq \\frac{ 8 \\sqrt{2} \\sqrt{ D^F } \\sqrt{ L } \\sqrt{ \\frac{2 \\zeta^2_1}{K} +  \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T}  } }{ \\sqrt{T} } \\\\\n\\leq \\frac{ 8 \\sqrt{2} \\sqrt{ D^F } \\sqrt{ L } }{ \\sqrt{T} } \\left( \\frac{\\sqrt{2}\\zeta_1}{\\sqrt{K}} + \\frac{\\sigma}{\\sqrt{K B \\alpha}} + \\sqrt{ \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T}  } \\right).\n\\end{gathered}')
('10.6', '\\mu \\geq 1')
('10.6', '\\begin{gathered}\n\\tilde{\\mu} = \\min \\left\\{ \\frac{1}{4 B L} \\sqrt{\\frac{1}{1+1/(2\\alpha)}},  \\frac{(D^F)^{\\frac{1}{3}}}{  \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} B L^{\\frac{2}{3}} \\left( \\zeta^2_0  + \\frac{\\sigma^2}{2 B} \\right)^{\\frac{1}{3}} T^{\\frac{1}{3}} }, \\right.\\\\ \n\\left. \\frac{ \\sqrt{ 2 D^F }  }{  B \\sqrt{L} \\sqrt{ \\frac{2 \\zeta^2_1}{K} +  \\frac{\\sigma^2}{K B \\alpha } + \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T} } \\sqrt{T} } \\right\\}, \n\\end{gathered}')
('10.6', '\\begin{aligned}\n\\mathbb{E} \\left[ \\left\\Vert \\nabla F(w^R)  \\right\\Vert^2 \\right] \\leq \\frac{32 D^F L \\sqrt{1 + \\frac{1}{2 \\alpha}}}{T} + \\frac{ 16 \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F)^{\\frac{2}{3}} L^{\\frac{2}{3}} \\left( \\zeta^{\\frac{2}{3}}_0  + \\frac{\\sigma^{\\frac{2}{3}}}{ (2 B)^{\\frac{1}{3}} } \\right)  }{ T^{\\frac{2}{3}} } \\\\\n+ \\frac{ 8 \\sqrt{2} \\sqrt{ D^F } \\sqrt{ L } }{ \\sqrt{T} } \\left( \\frac{\\sqrt{2}\\zeta_1}{\\sqrt{K}} + \\frac{\\sigma}{\\sqrt{K B \\alpha}} + \\sqrt{ \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{B T}  } \\right) \\\\\n\\lesssim \\frac{D^F L \\sqrt{1 + \\frac{1}{2 \\alpha}}}{T} + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F)^{\\frac{2}{3}} L^{\\frac{2}{3}} \\left( \\zeta^{\\frac{2}{3}}_0  + \\frac{\\sigma^{\\frac{2}{3}}}{ B^{\\frac{1}{3}} } \\right)  }{ T^{\\frac{2}{3}} } \\\\\n+ \\frac{ \\sqrt{ D^F } \\sqrt{ L } }{ \\sqrt{T} } \\left( \\frac{\\zeta_1}{\\sqrt{K}} + \\frac{\\sigma}{\\sqrt{K B \\alpha}} + \\sqrt{ \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{T B}  } \\right) \\\\\n\\lesssim \\frac{D^F L \\sqrt{1 + \\frac{1}{2 \\alpha}}}{T} + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F L)^{\\frac{2}{3}} \\zeta^{\\frac{2}{3}}_0  }{ T^{\\frac{2}{3}} } + \\frac{ \\left( 2 + \\frac{1}{\\alpha}  \\right)^{\\frac{1}{3}} (D^F L)^{\\frac{2}{3}}  \\sigma^{\\frac{2}{3}}  }{ B ^{\\frac{1}{3}} T^{\\frac{2}{3}} } \\\\\n+ \\frac{ \\sqrt{ D^F L }\\zeta_1 }{ \\sqrt{T K} } + \\frac{ \\sqrt{ D^F L } \\sigma  }{ \\sqrt{ T K B \\alpha } } + \\frac{ \\sqrt{D^F L } }{ B \\sqrt{T} } \\sqrt{ \\frac{ \\text{D-Regret}_T \\left( q^{\\star} \\right) }{T}  }.\n\\end{aligned}')
('11', 'f')
('11', '\\text{dom}f')
('11', '\\mathcal{X} \\subseteq \\text{dom}f')
('11', 'x')
('11', 'f')
('11', '\\mathcal{X}')
('11', '\\nabla f (x)^{\\top} (y-x) \\geq 0 \\quad \\text{for all } y \\in \\mathcal{X}.')
('11', 'f:\\mathcal{W} \\to \\mathbb{R}')
('11', '\\mathcal{W} \\subseteq \\mathbb{R}^d')
('11', '\\mathcal{W}')
('11', 'f')
('11', 'L')
('11', '\\Vert \\nabla f(x) - \\nabla f(y) \\Vert \\leq L \\Vert x - y \\Vert \\quad \\text{ for all } x,y \\in \\mathcal{W},')
('11', '\\left\\vert f(y) - f(x) - \\left\\langle \\nabla f(x), y - x \\right\\rangle \\right\\vert \\leq \\frac{L}{2} \\left\\Vert x -y \\right\\Vert^2 \\quad \\text{ for all } x,y \\in \\mathcal{W}.')
('11', '\\begin{aligned}\n& \\quad \\left\\vert f(y) - f(x) - \\left\\langle \\nabla f(x), y - x \\right\\rangle \\right\\vert \\\\\n& = \\left\\vert \\int^1_0 \\left\\langle \\nabla f\\left(x + t (y-x) \\right) , y - x \\right\\rangle dt - \\left\\langle \\nabla f(x),  y - x\\right\\rangle \\right\\vert \\\\\n& = \\left\\vert \\int^1_0 \\left\\langle \\nabla f\\left(x + t (y-x) \\right) - \\nabla f(x) , y - x \\right\\rangle dt \\right\\vert \\\\\n& \\leq \\int^1_0 \\left\\Vert \\nabla f\\left(x + t (y-x) \\right) - \\nabla f(x)  \\right\\Vert \\left\\Vert y - x  \\right\\Vert dt \\\\\n& \\leq \\int^1_0 L t \\left\\Vert y - x  \\right\\Vert^2 dt \\\\\n& = \\frac{L}{2} \\left\\Vert y - x  \\right\\Vert^2,\n\\end{aligned}')
('11', '\\{v_1,\\ldots,v_\\tau\\}')
('11', '\\tau')
('11', '\\mathbb{R}^d')
('11', '\\begin{aligned}\n\\Vert v_i + v_j \\Vert^2 & \\leq (1+a) \\Vert v_i \\Vert^2 + \\left( 1+ \\frac{1}{a} \\right) \\Vert v_j \\Vert^2 \\quad \\text{ for any } a > 0, \\\\\n\\left\\Vert \\sum^{\\tau}_{i=1}  v_i \\right\\Vert^2 & \\leq \\tau \\sum^{\\tau}_{i=1}  \\left\\Vert  v_i \\right\\Vert^2.\n\\end{aligned}')
('11', 'q \\in \\mathcal{P}_{M-1}')
('11', 'D_{\\Phi}(q \\, \\Vert \\, p^{\\rm unif}) \\leq \\log M')
('11', '\\Phi')
('11', '\\Phi(q)=\\sum^M_{m=1} q_m (\\log q_m - 1) \\leq 0')
('11', '\\Phi(p^{\\rm unif}) = - \\log M')
('11', '\\langle \\nabla \\Phi (p^{\\rm unif}), q - p^{\\rm unif}\\rangle = \\sum^M_{m=1} (q_m - \\frac{1}{M}) \\log \\frac{1}{M} = 0,')
('11', 'D_{\\Phi}(q \\, \\Vert \\, p) \\leq \\log M')
('11', 'X')
('11', 'a \\leq X \\leq b')
('11', 'a,b \\in \\mathbb{R}')
('11', 's \\in \\mathbb{R}')
('11', '\\log \\mathbb{E} \\left[ e^{sX} \\right] \\leq s \\mathbb{E} [X] + \\frac{s^2(b-a)^2}{8}.')
('11', '\\alpha \\in [0,1]')
('11', '\\mathcal{A}=\\mathcal{P}_{M-1} \\cap [ \\alpha/M, 1 ]^M')
('11', '\\mathcal{D}=[0,\\infty)^M')
('11', '\\Phi=\\Phi_e')
('11', '\\mathcal{D}')
('11', 'y \\in [0,\\infty)^M')
('11', 'x=\\arg\\min_{v \\in \\mathcal{A}} D_{\\Phi}(v \\Vert y)')
('11', 'y_1\\leq y_2 \\leq \\dots \\leq y_M')
('11', 'm^{\\star}')
('11', 'y_{m^{\\star}} \\left( 1 -  \\frac{ m^{\\star}-1 }{M} \\alpha \\right) > \\frac{  \\alpha}{M} \\sum^M_{m=m^{\\star}} y_m.')
('11', 'x_m = \n\\begin{cases}\n\\frac{\\alpha}{M} & \\text{if } m < m^{\\star} \\\\\n\\frac{(1 - \\frac{m^{\\star} -1}{M} \\alpha ) y_m}{\\sum^M_{n=m^{\\star}} y_n } & \\text{otherwise}.\n\\end{cases}')
('11', '\\begin{aligned}\n\\min_{ u \\in [0,\\infty)^M } \\, & \\sum^M_{m=1} u_m \\log \\frac{u_m}{y_m}, \\\\\n\\text{s.t. } & \\sum^M_{m=1} u_m = 1, \\\\\n& u_m \\geq \\frac{\\alpha}{M}, \\qquad m \\in [M].\n\\end{aligned}')
('11', 'x')
('11', '\\lambda,\\nu_1,\\dots,\\nu_M \\in \\mathbb{R}')
('11', '\\begin{aligned}\n\\log \\frac{x_m}{y_m} + 1- \\lambda - \\nu_m & =  0, \n\\qquad m \\in [M], \\label{eq:solv-lemma-1} \\\\\n\\sum^M_{m=1} x_m & = 1, \\label{eq:solv-lemma-2} \\\\\nx_m - \\frac{\\alpha}{M} & \\geq 0, \\qquad m \\in [M], \\label{eq:solv-lemma-3} \\\\\n\\nu_m & \\geq 0,  \\qquad m \\in [M], \\label{eq:solv-lemma-4} \\\\\n\\nu_m \\left( x_m - \\frac{\\alpha}{M} \\right) &= 0, \n\\qquad m \\in [M]. \\label{eq:solv-lemma-5}\n\\end{aligned}')
('11', 'x_m=y_m \\exp ( -1 + \\lambda + \\nu_m )')
('11', 'x_m=\\alpha/M')
('11', 'x_m=y_m \\exp ( -1 + \\lambda + \\nu_m ) \\geq y_m \\exp ( -1 + \\lambda )')
('11', 'x_m>\\alpha/M')
('11', 'x_m = y_m \\exp ( -1 + \\lambda )')
('11', 'x_1 = \\dots = x_{m^{\\star}-1} = \\alpha/M < x_{m^{\\star}} \\leq \\dots \\leq x_M')
('11', '1 = \\sum^M_{m=1} x_m = ( m^{\\star} -1 ) \\frac{\\alpha}{M} + \\exp (-1+\\lambda) \\cdot \\sum^M_{m=m^{\\star}} y_m,')
('11', '\\label{eq:lemma4-proof-helper1}\n\\exp (-1+\\lambda) = \\frac{ 1 - ( m^{\\star} -1 ) \\frac{\\alpha}{M}  }{  \\sum^M_{m=m^{\\star}} y_m }.')
('11', 'x_{m^{\\star}} = y_{m^{\\star}} \\exp (-1+\\lambda) = y_{m^{\\star}} \\frac{ 1 - ( m^{\\star} -1 ) \\frac{\\alpha}{M}  }{  \\sum^M_{m=m^{\\star}} y_m } > \\frac{\\alpha}{M},')
('11', '\\label{eq:solv-lemma-6}\ny_{m^{\\star}} \\left( 1 -  \\frac{ m^{\\star}-1 }{M} \\alpha \\right) > \\frac{  \\alpha}{M} \\sum^M_{m=m^{\\star}} y_m .')
('11', '\\label{eq:solv-lemma-7}\ny_{m^{\\prime}} \\left( 1 -  \\frac{ m^{\\prime}-1 }{M} \\alpha \\right) \\leq \\frac{  \\alpha}{M} \\sum^M_{m=m^{\\prime}} y_m')
('11', '1 \\leq m^{\\prime} \\leq m^{\\star}-1')
('11', '1 \\leq m^{\\prime} \\leq m^{\\star}-1')
('11', '\\alpha/M=y_{m^{\\prime}} \\exp ( -1 + \\lambda + \\nu_{m^{\\prime}} )')
('11', 'y_1 \\leq \\cdots \\leq y_M')
('11', '\\nu_1 \\geq \\cdots \\geq \\nu_{m^{\\star}-1}')
('11', '\\label{eq:lemma4-proof-helper2}\n\\left( m^{\\star}-m^{\\prime} \\right) \\frac{\\alpha}{M} = \\sum^{m^{\\star}-1}_{m=m^{\\prime}} y_m \\exp \\left( -1 + \\lambda + \\nu_m \\right) \\leq \\exp \\left( -1 + \\lambda + \\nu_{m^{\\prime}} \\right) \\sum^{m^{\\star}-1}_{m=m^{\\prime}} y_m.')
('11', '\\label{eq:lemma4-proof-helper3}\n1 - ( m^{\\star} -1 ) \\frac{\\alpha}{M} = \\exp (-1+\\lambda) \\sum^M_{m=m^{\\star}} y_m \\leq \\exp \\left( -1 + \\lambda + \\nu_{m^{\\prime}} \\right) \\sum^M_{m=m^{\\star}} y_m.')
('11', '\\begin{aligned}\n\\frac{ 1 - ( m^{\\prime} -1 ) \\frac{\\alpha}{M}  }{  \\sum^M_{m=m^{\\prime}} y_m } &=\n\\frac{ 1 - ( m^{\\star} -1 ) \\frac{\\alpha}{M} + ( m^{\\star} -m^{\\prime} ) \\frac{\\alpha}{M} }{  \\sum^M_{m=m^{\\prime}} y_m } \\\\\n& \\leq \\frac{ \\exp \\left( -1 + \\lambda + \\nu_{m^{\\prime}} \\right) \\left( \\sum^{m^{\\star}-1}_{m=m^{\\prime}} y_m + \\sum^M_{m=m^{\\star}} y_m \\right)  }{  \\sum^M_{m=m^{\\prime}} y_m } \\\\\n& = \\exp \\left( -1 + \\lambda + \\nu_{m^{\\prime}} \\right) \\\\\n& = \\frac{ \\frac{  \\alpha}{M} }{ y_{m^{\\prime}} }, \n\\end{aligned}')
