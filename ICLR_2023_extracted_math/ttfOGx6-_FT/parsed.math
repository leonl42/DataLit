('1', 'Q')
('2.0', '\\mu')
('2.0', '\\nu')
('2.0', '\\mathcal{X}')
('2.0', '\\mathcal{Y}')
('2.0', '\\mathcal{X},\\mathcal{Y}\\subset\\mathbb{R}^{D}')
('2.0', 'T: \\mathcal{X}\\rightarrow\\mathcal{Y}')
('2.0', '\\nu')
('2.0', 'c:\\mathcal{X}\\times\\mathcal{Y}\\rightarrow\\mathbb{R}')
('2.0', '\\mu,\\nu')
('2.0', '\\min_{T \\sharp \\mu=\\nu} \\mathbb{E}_{x\\sim \\mu}\\big[c(x, T(x))\\big].\n    \\label{eq:monge_OT}')
('2.0', 'T \\sharp')
('2.0', '{T} \\sharp \\mu=\\nu')
('2.0', 'x\\in\\mathcal{X}')
('2.0', 'y\\in \\mathcal{Y}')
('2.0', '\\mu')
('2.0', '\\nu')
('2.0', 'T')
('2.0', '\\mu')
('2.0', '\\nu')
('2.0', '\\min_{g\\in\\Pi(\\mu,\\nu)}\\mathbb{E}_{(x,y) \\sim g}\\big[c(x,y)\\big].\n\\label{eq:kant-primal-form}')
('2.0', 'g')
('2.0', '\\Pi')
('2.0', '\\mu')
('2.0', '\\nu')
('2.0', 'g^{*}')
('2.0', '\\Pi(\\mu,\\nu)')
('2.0', '\\max_{f}\\mathbb{E}_{x\\sim \\mu} \\big[f^{c}(x)\\big]+\\mathbb{E}_{y\\sim \\nu} \\big[f(y)\\big], \n\\label{eq:ot-dual-form-c}')
('2.0', 'f: \\mathcal{X}\\rightarrow\\mathbb{R}')
('2.0', '{f^{c}(x)\\!=\\!\\min\\limits_{y\\in\\nu}\\!\\big[c(x,y)\\!-\\!f(y)\\!\\big]}')
('2.0', 'c')
('2.0', 'f')
('2.0', 'c(x,y)=\\|x-y\\|_{2}')
('2.0', 'f^c')
('2.0', 'f')
('2.0', 'T')
('2.0', 'y\\in\\nu')
('2.0', 'T: \\mathcal{X}\\rightarrow \\mathcal{Y}')
('2.0', 'f')
('2.0', 'T')
('2.0', '\\max_{f}\\min_{T}\\mathbb{E}_{x \\sim \\mu}\\big[c(x,T(x)) - f(T(x))\\big]+\\mathbb{E}_{y\\sim \\nu}\\big[f(y)\\big]\n    \\label{dual_monge_OT}')
('2.0', '\\ell^2')
('2.0', '\\min_{\\substack{ T\\sharp \\mu \\leq w \\nu  }}\\mathbb{E}_{x \\sim \\mu}\\big[c(x,T(x))\\big].\n\\label{eq:IPLw}')
('2.0', 'w')
('2.0', 'w=1')
('2.0', 'T\\sharp \\mu \\leq w \\nu')
('2.0', 'T\\sharp \\mu = \\nu')
('2.0', '\\nu')
('2.0', '\\nu')
('2.0', 'w \\ge 1')
('2.0', '\\mu')
('2.0', '\\nu')
('2.0', '\\mu')
('2.0', 'c')
('2.0', 'T')
('2.0', '\\nu')
('2.1', '\\mathcal{M}=(S,A,P,r,\\gamma)')
('2.1', 'S')
('2.1', 'A')
('2.1', "P(s' \\mid s, a)")
('2.1', 'r(s, a)')
('2.1', '\\gamma')
('2.1', '\\pi(a|s)')
('2.1', 't')
('2.1', 'J(\\pi) \\stackrel{def}{=} {\\mathbb{E}_\\pi}[\\sum_{t=0}^{\\infty} \\gamma^{t} r(s_{t}, a_{t})]')
('2.1', '\\pi')
('2.1', 'd^\\pi(s)')
('2.1', '\\pi')
('2.1', 'Q^\\pi')
('2.1', "\\left.Q^\\pi\\left(s, a\\right)=r\\left(s, a\\right)+\\gamma \\mathbb{E}_{s' \\sim T\\left(s, a\\right), a' \\sim \\pi\\left(s'\\right)}\\left[Q^\\pi\\left(s', a'\\right)\\right)\\right].")
('2.1', 'Q^{\\pi}_\\phi(s, a)')
('2.1', '\\pi_\\theta')
('2.1', '\\mathcal{D} =\\{(s_{i},a_{i},s_{i}^{\\prime},r_{i})\\}')
('2.1', '\\pi')
('2.1', "\\min_{Q^{\\pi}_{\\phi}}\\mathbb{E}_{\\left(s, a, s^{\\prime}\\right) \\sim \\mathcal{D}}\\left[\\left(r(s,a)+\\gamma \\mathbb{E}_{a'\\sim \\pi_\\theta(s')}\\left[Q^\\pi_{\\phi}(s', a')\\right]- Q^{\\pi}_{\\phi}(s, a)\\right)^2\\right].\n   \\label{eq:q_update}")
('2.1', 'Q')
('2.1', '\\mathcal{D}')
('2.1', '\\beta')
('2.1', '\\mathcal{D}')
('2.1', '\\pi')
('2.1', 'Q')
('2.1', 'Q(s, a)')
('2.1', 'f')
('2.1', '{\\color{orange}\\alpha}')
('2.1', '\\begin{aligned}\n    &\\min_{\\pi} \\max_{{\\color{purple}\\|f\\|_L \\leq 1}}\\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim\\pi(s)} \\big[\\underbrace{-Q^{\\pi}(s, a)}_{\\text{{\\color{blue} Critic}}}\\big] + {\\color{orange}\\alpha} \\big(\\underbrace{\\mathbb{E}_{(s,a) \\sim \\mathcal{D}}\\big[f(s,a)\\big]-\\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim\\pi(s)}\\big[f(s,a)\\big]}_{\\text{{\\color{purple}\\emph{Wasserstein-1} distance}}}\\big)\n    \\label{eq:WGAN_RL}\n\\end{aligned}')
('2.1', '\\mathcal{D}')
('2.1', '\\eqref{eq:WGAN_RL}')
('2.1', 'f')
('2.1', '{\\color{orange}\\alpha}')
('3.0', 'c(x,y)')
('3.0', 'Q^\\pi(s,a)')
('3.0', '\\pi')
('3.0', 'd^\\beta(s)')
('3.0', 'd(s)')
('3.0', '\\beta(\\cdot|s)')
('3.0', '\\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim \\pi(s)}\\min_{\\substack{\\pi \\sharp  d(s) = \\beta(\\cdot|s)}}[-Q^{\\pi}(s,a)]')
('3.0', '\\min_{\\substack{\\big\\{\\pi \\sharp d(s) = \\beta(\\cdot|s)\\big\\}}}\\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim \\pi(s)}\\big[-Q^{\\pi}(s,a)\\big].\n\\label{eq:monge_cond}')
('3.0', 'Q^{\\pi}')
('3.0', 'Q^{\\beta}')
('3.0', '\\beta')
('3.0', "\\mathcal{D}(s,a,r,s')")
('3.0', 'Q_\\phi, \\pi_\\theta')
('3.0', 'f_\\omega')
('3.0', '\\beta')
('3.0', "(s,a,r,s')\\gets \\mathcal{D}")
('3.0', 'Q^{k+1} \\gets')
('3.0', 'Q^{\\pi}_\\phi')
('3.0', 'f^{k+1} \\gets')
('3.0', 'f_\\omega')
('3.0', '\\pi_\\theta')
('3.0', '\\mathop{\\mathrm{arg\\,min}}_{f}  - \\mathbb{E}_{s \\sim \\mathcal{D}, a \\sim \\pi^k(s)}[f^{k}(s,a)] + w\\mathbb{E}_{s, a \\sim \\mathcal{D}}[f^{k}(s,a)]')
('3.0', '\\pi^{k+1} \\gets')
('3.0', '\\pi_\\theta')
('3.0', '\\mathop{\\mathrm{arg\\,min}}_\\pi \\mathbb{E}_{s \\sim \\mathcal{D}, a \\sim \\pi^k(s)}[-Q^{k}(s, a) - f^{k}(s,a)].')
('3.1', 'Q')
('3.1', '\\min_{\\substack{  \\big\\{\\pi\\sharp d(s) \\leq w(\\beta(\\cdot|s))\\big\\}  }}\\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim \\pi(s)}\\big[-Q^{\\pi}(s,a)\\big].\n\\label{eq:IPLw}')
('3.1', 'w')
('3.1', 'w\\ge 1')
('3.1', '\\beta(\\cdot|s)')
('3.1', 'd(s)')
('3.1', '\\beta(\\cdot|s)')
('3.1', 'Q')
('3.1', 'Q^\\beta')
('3.1', '\\beta')
('3.1', '\\max_{f \\ge 0}\\mathbb{E}_{s\\sim \\mathcal{D}, a\\sim \\pi} \\big[f^{c}(s,a)\\big]+w\\mathbb{E}_{s\\sim \\mathcal{D}, a\\sim \\beta} \\big[f(s,a)\\big],\n\\label{eq:pot-dual-form-c}')
('3.1', 'Q')
('3.1', 'c')
('3.1', '\\mathbb{E}_{s\\sim \\mathcal{D}, a\\sim \\pi}[f^{c}(s,a)] =\\mathbb{E}_{s\\sim \\mathcal{D}}[\\min_{a}\\left\\lbrace -Q^\\pi(s,a)-f(s,a)\\right\\rbrace]')
('3.1', 'a')
('3.1', '\\pi:\\mathcal{S}\\rightarrow\\mathcal{A}')
('3.1', '\\begin{aligned}\n    \\max_{{\\color{purple}{f \\ge 0}}} \\min_\\pi \\mathbb{E}_{s \\sim \\mathcal{D}, a\\sim \\pi(s)}\\big[\\underbrace{-Q^{\\pi}(s, a)}_{\\text{{\\color{blue}Cost}}}-\\underbrace{f(s,a)\\big] + {\\color{orange}w}\\mathbb{E}_{(s,a) \\sim \\mathcal{D}}\\big[f(s,a)\\big]}_{\\text{{\\color{purple} Constraints}}}.\n    \\label{eq:IPL-dual_cond}\n\\end{aligned}')
('3.1', 'f^{*}(s,a)=0')
('3.1', '\\min_\\pi \\mathbb{E}_{s \\sim \\mathcal{D}, a \\sim \\pi(s)}[-Q(s,a) - f(s, a)]')
('3.1', 'f(s,a)=0')
('3.1', '-Q(s,a) - f(s,a)')
('3.1', 'w')
('3.1', 'w')
('3.1', 'w')
('3.1', '\\alpha')
('3.1', 'f')
('3.1', 'f')
('3.1', 'f\\geq 0')
('3.1', '\\pi_{\\theta}: {S}\\rightarrow A')
('3.1', 'f_{\\omega}:S\\times A\\rightarrow\\mathbb{R}')
('3.1', '\\pi')
('3.1', 'f')
('3.1', '\\mathcal{D}')
('3.1', '\\mathcal{D}')
('3.1', 'Q')
('3.1', 'f')
('3.1', 'k')
('3.1', 'Q^k')
('3.1', 'f^k')
('4', 'S_0')
('4', 'S_T')
('4', '\\beta')
('4', '\\beta^{*}')
('4', '\\pi^{*}')
('4', '\\beta')
('4', '-Q^\\beta(s,\\pi(s))')
('4', '\\pi')
('4', 'S_0')
('4', 'S_T')
('4', 'S_t')
('4', 'S_T')
('4', 'S_t')
('4', '\\pi^*')
('4', 'Q^\\beta')
('4', '\\beta')
('4', '\\mathcal{D}')
('4', 'Q^\\beta')
('4', '\\mathbb{E}_{s,a\\sim \\mathcal{D}}[-Q^\\beta(s,\\beta(s)) + \\|\\beta(s)-a\\|^{2}]')
('4', '\\beta')
('4', '-Q^\\beta(s,a)')
('4', 'Q^\\beta')
('4', '\\pi(s)')
('4', 'w=8')
('4', 'f(s,a)')
('5.0', 'Q')
('5.0', 'Q')
('5.1', '\\beta')
('5.1', 'Q^\\beta')
('5.1', 'Q^\\beta')
('5.1', '\\beta')
('5.1', '\\pi')
('5.1', '\\text{PPL}^{\\text{CQL}}')
('5.1', 'w')
('5.1', '\\text{PPL}^{\\text{R}}')
('5.1', 'Q')
('5.1', 'w')
('5.2', '\\text{PPL}^{\\text{CQL}}')
('5.2', '\\text{PPL}^{\\text{R}}')
('5.2', '\\text{PPL}^{\\text{R}}')
('5.2', '\\text{PPL}^{\\text{R}}')
('5.2', 'Q')
('5.2', 'Q')
('5.2', 'Q')
('5.2', 'f')
('5.2', 'w')
('5.3', 'w')
('5.3', 'w')
('5.3', 'w')
('5.3', 'w')
('6', 'D')
('6', '\\pi')
('6', '\\beta')
('6', '{D}(\\pi(\\cdot| s), \\beta(\\cdot| s))')
('6', 'f')
('6', 'Q')
('6', 'Q')
('6', 'Q^\\beta')
('6', '\\pi')
('6', '{A}^\\beta(s,a)')
('6', 'Q')
('6', 'V^\\beta(s)')
('7', 'w')
('9.0', '\\pi')
('9.0', 'J(\\pi) \\stackrel{def}{=} {\\mathbb{E}_\\pi}[\\sum_{t=0}^{\\infty} \\gamma^{t} r(s_{t}, a_{t})]')
('9.0', '\\pi')
('9.0', '(s_{0} \\sim S, a_{t} \\sim \\pi(s_{t}), s_{t+1} \\sim P(\\cdot \\mid s_{t}, a_{t}))')
('9.0', '\\beta')
('9.0', '\\pi')
('9.0', 'Q^\\beta')
('9.0', 'J(\\pi)\\geq J(\\beta).')
('9.0', '\\pi')
('9.0', '\\beta')
('9.0', 'J(\\pi)-J(\\beta)=\\frac{1}{1-\\gamma} \\underset{s \\sim d^\\pi}{\\mathbb{E}}\\left[A^\\beta(s, \\pi)\\right]')
('9.0', 'w\\rightarrow\\infty')
('9.0', '\\min_{\\substack{\\big\\{\\pi(\\cdot|s) \\subset\\text{Supp}(\\beta(\\cdot|s))\\big\\}}}\\mathbb{E}_{s \\sim \\mathcal{D},a\\sim \\pi}[-Q(s,a)].\n\\label{eq:IPLsupp}')
('9.0', '\\text{Supp}(\\beta(\\cdot|s))')
('9.0', '\\beta')
('9.0', 'Q')
('9.0', '\\beta')
('9.0', '\\pi')
('9.0', '\\beta')
('9.0', 'J(\\pi)-J(\\beta) =\\frac{1}{1-\\gamma} \\underset{s \\sim d^\\pi}{\\mathbb{E}}\\left[Q^{\\beta}(s, \\pi) - V^{\\beta}(s)\\right] =')
('9.0', '\\frac{1}{1-\\gamma} \\underset{s \\sim d^\\pi}{\\mathbb{E}}[Q^{\\beta}(s, \\max_{a \\subset \\text{Supp}(\\beta(\\cdot|s))}[Q^\\beta(s,a)]) - {\\mathbb{E}_{a\\sim \\beta(s)}}[Q^{\\beta}(s,a)]] \\geq 0')
('9.0', '\\pi')
('9.0', '\\beta')
('9.0', '\\square')
('9.0', '\\text{Supp}(\\beta(\\cdot|s))')
('9.0', 'A')
('9.1', '\\text{PPL}')
('9.1', '\\text{IPL}^{\\text{CQL}}')
('9.1', 'w')
('9.1', 'w')
('9.1', 'w')
('9.1', 'w')
