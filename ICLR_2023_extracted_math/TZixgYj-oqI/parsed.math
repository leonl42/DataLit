('1', '\\gamma')
('1', '\\gamma')
('1', '\\gamma')
('1', '\\gamma')
('2.0', '\\mathcal{M}')
('2.0', '\\mathcal{S},\\,\\mathcal{A},\\,P,\\,p_0,\\,R,\\,\\gamma')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', 'P')
('2.0', 'p_0')
('2.0', 'R')
('2.0', '[0, R_{\\max}]')
('2.0', '\\gamma\\in[0,1)')
('2.0', '\\pi(\\cdot\\vert s)')
('2.0', 's')
('2.0', '\\gamma')
('2.0', 'd^\\pi(s,a)')
('2.0', '\\pi')
('2.0', 'd^\\pi(s,a) = (1-\\gamma)\\sum_{t=0}^\\infty\\gamma^t\\textrm{Pr}(s_t=s,\\,a_t=a\n   \\,\\vert \\,p_0,\\,P,\\,\\pi).\n   %  % \\resizebox{\\textwidth}{!}{$d^\\pi(s,a) = (1-\\gamma)\\sum_{t=0}^\\infty\\gamma^tPr(s_t=s,\\,a_t=a\\,\\vert s_0\\sim p_0(\\cdot),\\,s_t\\sim P(\\cdot\\vert s_{t-1},a_{t-1}),\\,a_t\\sim\\pi(\\cdot\\vert s_t)).$}')
('2.0', 's_0 \\sim p_0(\\cdot)')
('2.0', 'a_t \\sim \\pi(\\cdot\\vert s_t ), s_{t+1}\\sim P(\\cdot\\vert s_t,a_t)')
('2.0', 't')
('2.0', '\\mathcal{D}^E')
('2.0', '\\mathcal{D}^O')
('2.0', '(s, a, s^\\prime)')
('2.0', '\\mathcal{D}^D=\\mathcal{D}^E\\cup \\mathcal{D}^O')
('2.0', '\\mathcal{D}^E')
('2.0', '\\pi^E')
('2.0', '\\mathcal{M}')
('2.0', '\\mathcal{D}^E')
('2.0', '\\mathcal{D}^D')
('2.0', 'E(s,a)')
('2.0', 'D(s,a)')
('2.0', '\\pi^E')
('2.0', 'd^E(s,a)')
('2.1', '\\label{BC}\n\\min_{\\pi} -\\mathbb{E}_{(s,a)\\sim E}\\left[\\log{\\pi(a\\vert s)} \\right].')
('2.1', '\\mathcal{D}^E')
('2.1', 'd^\\pi')
('2.1', 'd^E')
('2.1', '\\label{distribution matching}\n    \\max_{\\pi} -D_{\\text{KL}}\\left( d^\\pi\\Vert d^E\\right)=\\mathbb{E}_{(s,a)\\sim d^\\pi}\\left[\\log{\\frac{d^E(s,a)}{d^\\pi(s,a)}} \\right].')
('2.1', '\\label{distribution matching to RL}\n    \\max_{\\pi} -D_{\\text{KL}}\\left( d^\\pi\\Vert d^E\\right)=(1-\\gamma)\\cdot\\mathbb{E}_{\\begin{subarray}{1}s_0\\sim p_0,\\\\ a_t\\sim \\pi,\\\\ s_{t+1}\\sim P\\end{subarray}}\\left[\\sum_{t=0}^\\infty\\gamma^t\\log{\\frac{d^E(s_t,a_t)}{d^\\pi(s_t,a_t)}} \\right].')
('2.1', 'r=\\log{\\frac{d^E}{d^\\pi}}')
('2.1', 'd^\\pi')
('2.1', '\\pi')
('2.1', 'd^E')
('2.1', 'd^\\pi')
('2.1', '\\label{discriminator}\n    \\max_{c:S\\times A\\rightarrow(0,1)}\\mathbb{E}_{(s,a)\\sim d^E}\\left[\\log{c(s,a)} \\right]+\\mathbb{E}_{(s,a)\\sim d^\\pi}\\left[\\log{(1-c(s,a))} \\right],')
('2.1', 'c^*(s,a)')
('2.1', '\\log{c^*(s,a)}-\\log{(1-c^*(s,a))}=\\log{\\frac{d^E(s,a)}{d^\\pi(s,a)}}')
('2.1', 'd^\\pi')
('3.0', '\\pi')
('3.0', 'd^\\pi')
('3.0', 'd^\\pi')
('3.0', '\\begin{aligned}\n\\label{3.2_1}\n    \\max_{d^\\pi}\\;&-D_{KL}(d^\\pi\\Vert d^E) \\\\\n    \\label{3.2_2}\n        \\textrm{s.t}\\; &\\mathcal B_*d^\\pi(s,a)=(1-\\gamma)p_0(s)+\\gamma\\mathcal P_* d^\\pi(s,a)\\;\\,\\forall s,\\\\ \\label{3.2_3}\n        &\\sum_{s,a}d^\\pi(s,a)=1\\,,\\;d^\\pi(s,a) \\geq 0 \\;\\,\\forall s,a,\n\\end{aligned}')
('3.0', '\\mathcal{B_*}d^\\pi(s,a)=\\sum_a d^\\pi(s,a)')
('3.0', '\\mathcal{P}_*d^\\pi(s,a)=\\sum_{\\Bar{s},\\Bar{a}}P(s\\vert\\allowbreak\\Bar{s},\\Bar{a})d^\\pi(\\Bar{s},\\Bar{a})')
('3.0', "\\begin{split}\n    &\\sum_s \\nu(s)\\mathcal{P}_*d^\\pi(s,a) = \\sum_{s,a}d^\\pi(s,a) \\mathcal{P}\\nu(s),\\;\\textrm{where}\\;\\mathcal{P}\\nu(s)=\\sum_{s'} P(s'\\vert s,a)\\nu(s')\\\\\n    &\\sum_s \\nu(s)\\mathcal{B}_*d^\\pi(s,a) = \\sum_{s,a}d^\\pi(s,a) \\mathcal{B}\\nu(s),\\;\\textrm{where}\\;\\mathcal{B}\\nu(s)=\\nu(s).\n\\end{split}")
('3.0', '\\begin{aligned}\n\\begin{split}\n\\label{3.2_4}\n    \\max_{d^\\pi\\geq0}\\min_{\\nu,\\lambda}&-\\mathbb{E}_{s,a\\sim d^\\pi}\\left[\\log\\frac{d^\\pi(s,a)}{d^E(s,a)}\\right] +\\lambda\\left[\\sum_{s,a}d^\\pi(s,a)-1\\right]\\\\\n    &+\\sum_s \\nu(s)((1-\\gamma)p_0(s)+\\gamma\\mathcal P_*d^\\pi(s,a)-\\mathcal{B}_*d^\\pi(s,a))\n\\end{split}\n\\end{aligned}')
('3.0', '\\lambda')
('3.0', '\\nu(s)')
('3.0', 'd^\\pi(s,a)')
('3.0', '\\begin{aligned}\n\\label{3.2_5}\n\\max_{d^\\pi\\geq0}\\min\\limits_{\\nu,\\lambda}(1-\\gamma)\\mathbb{E}_{s\\sim p_0}[\\nu(s)]+\\sum_{s,a}d^\\pi(s,a)\\left[e_\\nu(s)+\\lambda-\\log\\frac{d^\\pi(s,a)}{d^E(s,a)}\\right]-\\lambda.\n\\end{aligned}')
('3.0', 'e_\\nu(s)=\\gamma \\mathcal{P}\\nu(s)-\\mathcal{B}\\nu(s)')
('3.0', 'D(s,a)')
('3.0', '\\zeta(s,a)=\\frac{d^\\pi(s,a)}{D(s,a)}')
('3.0', '\\begin{aligned}\n\\begin{split}\n\\label{3.2_6}\n    \\max_{\\zeta\\geq0}\\min_{\\nu,\\lambda}\n    &(1-\\gamma)\\mathbb{E}_{p_0}[\\nu(s)]+\\mathbb{E}_{D}\\left[\\zeta(s,a)\\left(A_\\nu(s,a)+\\lambda-\\log\\zeta(s,a)\\right)\\right]-\\lambda.\\\\&=:\\mathcal{L}(\\zeta,\\nu,\\lambda)\n\\end{split}\n\\end{aligned}')
('3.0', 'A_\\nu(s,a) = e_\\nu(s)+\\log\\frac{d^E(s,a)}{D(s,a)}')
('3.0', 'a')
('3.0', 's')
('3.0', 'r(s,a)=\\log\\frac{d^E(s,a)}{D(s,a)}')
('3.0', 'c(s,a)')
('3.0', '\\begin{aligned}\n\\label{3.2_11}\n    \\max_{c:S\\times A\\rightarrow[0,1]} \\;\\mathbb{E}_{(s,a)\\sim d^E}[\\log c(s,a)]+\\mathbb{E}_{(s,a)\\sim D}[\\log (1-c(s,a))],\n\\end{aligned}')
('3.0', 'c^*(s,a)')
('3.0', '\\log\\frac{d^E(s,a)}{D(s,a)} = \\log \\left(\\frac{c^*(s,a)}{1-c^*(s,a)}\\right)')
('3.0', 'A_\\nu(s,a)')
('3.0', 'c')
('3.0', '\\frac{\\partial\\mathcal{L}(\\zeta^*,\\nu,\\lambda)}{\\partial\\zeta} = 0')
('3.0', '\\zeta^*=\\exp{(A_\\nu(s,a)+\\lambda-1)}')
('3.0', '\\lambda^*=-\\log[\\mathbb{E}_{(s,a)\\sim D}\\exp{(A_\\nu(s,a)-1)}]')
('3.0', '\\zeta^*')
('3.0', '\\lambda^*')
('3.0', '\\begin{aligned}\n\\label{3.2_9}\n    \\min_\\nu \\;(1-\\gamma)\\mathbb{E}_{p_0}[\\nu(s)]+\\log\\mathbb{E}_{(s,a)\\sim D}\\left[\\exp{\\left(A_\\nu(s,a)\\right)}\\right]=:\\mathcal{L}(\\zeta^*,\\nu,\\lambda^*).\n\\end{aligned}')
('3.0', '\\nu^*')
('3.0', '\\zeta^*=\\text{softmax}(A_\\nu(s,a)-1)')
('3.0', '\\begin{aligned}\n\\label{3.2_10}\n    \\min_\\pi \\;\\mathbb{E}_{(s,a)\\sim d^{\\pi^*}}[\\log\\pi(a\\vert s)]=\\mathbb{E}_{(s,a)\\sim D}\\left[\\zeta^*\\log\\pi(a\\vert s)\\right].\n\\end{aligned}')
('3.0', '\\alpha=0')
('3.0', 'f')
('3.0', 'f')
('3.1', '\\gamma')
('3.1', 'P')
('3.1', '\\widehat{P}')
('3.1', '\\gamma')
('3.1', '\\hat{\\gamma}')
('3.1', '\\hat{\\gamma}\\le\\gamma')
('3.1', 'd^\\pi_{P, \\gamma}')
('3.1', '\\pi')
('3.1', 'P')
('3.1', '\\gamma')
('3.1', 'd^E_{P, \\gamma}')
('3.1', '\\pi^E')
('3.1', 'P')
('3.1', '\\gamma')
('3.1', '[0, R_{\\max}]')
('3.1', '\\pi')
('3.1', '\\begin{aligned}\n\\begin{split}\n\\label{theorem1_1}\n    \\left\\vert \\mathbb{E}_{d^\\pi_{P,\\gamma}}[ r(s,a) ]-\\mathbb{E}_{d^{E}_{P,\\gamma}}[ r(s,a) ]\\right\\vert \\le\n    \\frac{2R_{\\max}}{1-\\hat{\\gamma}}\\left(\\frac{\\gamma-\\hat{\\gamma}}{1-\\gamma}\n    +\\frac{\\hat{\\gamma}\\epsilon_P}{1-\\hat{\\gamma}}+\\frac{\\epsilon_\\pi}{1-\\hat{\\gamma}}\\right),\n\\end{split}\n\\end{aligned}')
('3.1', '\\epsilon_P=\\mathbb{E}_{d^\\pi_{\\widehat{P},\\hat{\\gamma}}}\\left[D_{TV}(\\widehat{P}\\Vert P)\\right]+\\mathbb{E}_{d^E_{\\widehat{P},\\hat{\\gamma}}}\\left[D_{TV}(\\widehat{P}\\Vert P)\\right]')
('3.1', '\\epsilon_{\\pi}=\\mathbb{E}_{d^\\pi_{\\widehat{P},\\hat{\\gamma}}}\\left[ D_{TV}(\\pi\\Vert\\pi^E)\\right]')
('3.1', '\\hat{\\gamma}')
('3.1', '\\gamma')
('3.1', '\\hat{\\gamma}')
('3.1', '\\gamma')
('3.1', '\\epsilon_P')
('3.1', '\\hat{\\gamma}')
('3.1', '\\epsilon_P')
('3.1', '\\pi')
('3.1', '\\pi^E')
('3.1', '\\epsilon_P')
('3.1', '\\pi')
('3.1', '\\pi^E')
('3.1', '\\hat{\\gamma}')
('3.1', '\\hat{\\gamma}')
('3.1', '\\gamma')
('4', '\\gamma')
('4', '\\gamma')
('4', '\\gamma')
('4', '0.99')
('4', '\\gamma')
('4', '\\mathcal{D}^O')
('4', '\\mathcal{D}^E')
('4', 's_0')
('4', 'g')
('4', '\\theta')
('4.0', 'd^E(s,a)')
('4.0', '\\pi^E')
('4.0', 'c(s,a)')
('4.0', 'D(s,a)')
('4.0', 'E(s,a)')
('4.0', '(s_t,a_t)')
('4.0', 't')
('4.0', 'd^E(s,a)')
('4.0', '\\gamma^t')
('4.0', 'E(s,a)')
('4.0', '\\gamma')
('4.0', 'r(s,a)=\\log\\frac{E(s,a)}{D(s,a)}')
('4.0', '\\begin{aligned}\n\\begin{split}\n\\label{4.1_1}\n    &\\max_{d^\\pi\\geq0}\\min_{\\nu,\\lambda}\\mathcal{L}(d^\\pi,\\nu,\\lambda) =(1-\\gamma)\\mathbb{E}_{s\\sim p_0}[\\nu(s)]\\\\&+\\sum_{s,a}d^\\pi(s,a)\\left[\\gamma \\mathcal{P}\\nu(s)-\\mathcal{B}\\nu(s)+\\log\\frac{E(s,a)}{D(s,a)}-\\log\\frac{d^\\pi(s,a)}{D(s,a)}+\\lambda\\right]-\\lambda.\n\\end{split}\n\\end{aligned}')
('4.0', '\\begin{aligned}\n\\begin{split}\n\\label{4.1_3}\n    \\max_{d^\\pi}\\;&-D_{KL}(d^\\pi(s,a)\\Vert E(s,a)).\n\\end{split}\n\\end{aligned}')
('4.0', 'd^\\pi(s,a)')
('4.0', 'E(s,a)')
('4.0', '\\pi')
('4.0', 'E(s,a)=d^E(s,a)')
('4.0', 'E(s,a)')
('4.0', 'E(s,a)')
('4.0', 'd^E')
('4.0', '\\pi^*\\neq \\pi_E')
('4.0', 'E(s,a)')
('4.0', '\\pi')
('4.0', 'D_{KL}(d^\\pi(s,a)\\Vert E(s,a))=0')
('4.0', 'E')
('4.0', 'd^E')
('4.0', '\\gamma')
('4.0', '\\mathcal{D}^E')
('4.0.0', '\\pi_E')
('4.0.0', '0.6')
('4.0.0', 'a_1')
('4.0.0', 's_0')
('4.0.0', '0.4')
('4.0.0', 'a_2')
('4.0.0', 's_0')
('4.0.0', '1')
('4.0.0', 'a_1')
('4.0.0', '\\mathcal{D}^E')
('4.0.0', '\\tau_1 = (s_0, a_1, s_1, a_1, g, a_1)')
('4.0.0', '\\tau_2 = (s_0, a_2, g, a_1, g, a_1)')
('4.0.0', '6:4')
('4.0.0', 'E(s,a)')
('4.0.0', '\\frac{\\textrm{The number of (s, a) pairs}}{\\textrm{Total number of state-action pairs}}')
('4.0.0', '\\pi(a_1|s_0)=\\theta')
('4.0.0', '\\pi(a_2|s_0)=1-\\theta')
('4.0.0', '\\pi(a_1|\\cdot)=1')
('4.0.0', 'd^\\pi')
('4.0.0', 'D_{KL}(d^\\pi\\Vert E)')
('4.0.0', '\\theta')
('4.0.0', '\\gamma')
('4.0.0', 'D_{KL}')
('4.0.0', '\\theta^*')
('4.0.0', '\\theta^*=0.6')
('4.0.0', '\\theta\\neq0.6')
('4.0.0', '\\gamma=0.5')
('4.0.0', 'd^\\pi(s,a)=d^\\pi(s)\\pi(a|s)')
('4.0.0', 'E(s,a)=E(s)\\pi^E(a|s)')
('4.0.0', '\\pi')
('4.0.0', '\\pi_E')
('4.1', '\\pi=\\pi^E')
('4.1', 'd^E=E')
('4.1', 'E')
('4.1', 'd^E')
('4.1', 'E')
('4.1', 'd^E')
('4.1', 't')
('4.1', '\\text{Geom}(1-\\gamma)')
('4.1', '(s_t,a_t)')
('4.1', 't')
('4.1', 'd^E')
('4.1', '\\mathcal{D}^E')
('4.1', 'd^E')
('4.1', '\\gamma')
('4.1', 'd^E')
('4.1', '\\mathcal{D}^E')
('4.1', '\\mathcal{D}^E')
('4.1', '\\pi=\\pi^E')
('4.1', 'p_0')
('4.1', 'd^\\pi')
('4.1', 'd^E')
('4.1', '\\pi')
('4.1', '\\pi_E')
('4.1', '\\pi=\\pi_E')
('4.1', 'd^E=E')
('4.1', '\\pi=\\pi_E')
('4.1', 'd^E')
('4.1', 't')
('4.1', '\\text{Geom}(1-\\gamma)')
('4.1', '(s_t,a_t)')
('4.1', 't')
('4.1', '\\tilde{p}_0')
('4.1', '\\mathcal{D}^E')
('4.1', '\\text{Geom}(1-\\gamma)')
('4.1', '\\tilde{d}^E')
('4.1', '\\tilde{d}^E=E')
('4.1', '\\tilde{d}^E=E')
('4.1', '\\tilde{p}_0(s\\vert t)')
('4.1', '\\tilde{d}^E=E')
('4.1', '\\mathcal{D}^E')
('4.1', '\\mathcal{D}^E')
('4.1', '\\mathcal{D}^E')
('4.1', '\\mathcal{D}^D')
('4.1', '\\tilde{d}^E')
('4.1', 'E')
('4.1', '\\mathcal{D}^E')
('4.1', '\\mathcal{D}^D')
('4.1', '\\mathcal{D}^E')
('4.1', '\\mathcal{D}^D')
('4.1', '\\gamma')
('4.1', '\\mathcal{D}^D')
('5.0.0', 'f')
('5.0.0', 'f')
('6.1', '\\mathcal{D}^E')
('6.1', '\\mathcal{D}^O')
('6.1', '\\gamma')
('6.1', '\\mathcal{D}^D')
('6.1', '\\gamma')
('6.1', '\\gamma\\in\\{0.99, 0.95, 0.9, 0.8, 0.7, 0.6\\}')
('6.1', '\\gamma')
('6.1', '\\gamma')
('6.1', '0.6')
('6.1', '\\gamma')
('6.1', '\\gamma')
('6.1', '\\gamma')
('6.1', '\\epsilon_P')
('7', '\\gamma')
('7', '\\pi^E')
('8', '\\textbf{P}')
('8', '\\hat{\\textbf{P}}')
('8', '\\mathbb{E}_{d^{\\pi}_{P,\\gamma}}[r(s,a)]')
('8', '\\gamma')
('8', '\\pi')
('8', '\\textbf{P}')
('8', '\\textbf{d}_0')
('8', '\\textbf{r}')
('8', '\\textbf{r}')
('8', '\\textbf{P}')
('8', '\\pi')
('8', '\\pi')
('8', '|r(s,a)|\\leq R_{\\text{max}}')
('8', '\\pi:S\\rightarrow A')
('8', '\\hat{\\gamma}\\leq\\gamma')
('8', '\\left|\\mathbb{E}_{d^{\\pi}_{P,\\gamma}}\\left[r(s,a)\\right]-\\mathbb{E}_{d^{\\pi}_{P,\\hat{\\gamma}}}\\left[r(s,a)\\right]\\right|\\leq R_{\\text{max}}\\frac{\\gamma-\\hat{\\gamma}}{(1-\\gamma)(1-\\hat{\\gamma})}.')
('8', '\\begin{aligned}\n        \\left|\\mathbb{E}_{d^{\\pi}_{P,\\gamma}}\\left[r(s,a)\\right]-\\mathbb{E}_{d^{\\pi}_{P,\\hat{\\gamma}}}\\left[r(s,a)\\right]\\right|&= \\left\\vert\\mathbb{E}_{d^{\\pi}_{P,\\hat{\\gamma}}}\\left[r(s,a)\\right]-\\mathbb{E}_{d^{\\pi}_{P,\\gamma}}\\left[r(s,a)\\right] \\right\\vert\\\\\n        &\\leq\\left\\Vert \\sum_{t=0}^\\infty\\left( \\gamma^t-\\hat{\\gamma}^t\\right){\\textbf{P}^\\pi}^t \\textbf{r}^\\pi\\right\\Vert_\\infty\\\\\n        &\\leq \\sum_{t=0}^\\infty\\left( \\gamma^t-\\hat{\\gamma}^t\\right)R_{\\text{max}}\\\\\n        &= \\left(\\frac{1}{1-\\gamma}-\\frac{1}{1-\\hat{\\gamma}} \\right)R_{\\text{max}}\\\\\n        &= \\frac{\\gamma-\\hat{\\gamma}}{(1-\\gamma)(1-\\hat{\\gamma})}R_{\\text{max}}\n    \n\\end{aligned}')
('8', '\\textbf{d}^\\pi_{P,\\gamma}')
('8', '\\pi')
('8', '\\textbf{P}')
('8', '\\gamma')
('8', '\\pi')
('8', '|r(s,a)|\\leq R_{\\text{max}}')
('8', '\\left|\\mathbb{E}_{d^{\\pi}_{P,\\gamma}}\\left[r(s,a)\\right]-\\mathbb{E}_{d^{\\pi}_{\\widehat{P},\\gamma}}\\left[r(s,a)\\right]\\right|\\leq \\frac{2\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\mathbb{E}_{\\begin{subarray}{l}s\\sim d^\\pi_{\\widehat{P},\\gamma},\\\\ a\\sim\\pi\\end{subarray}}\\left[\\mathbb{TV}\\left(\\hat{P}\\left(s^\\prime\\vert s,a\\right)\\Vert P\\left(s^\\prime\\vert s,a\\right)\\right)\\right].')
('8', '\\begin{aligned}\n        &\\left|\\mathbb{E}_{d^\\pi_{P,\\gamma}}[ r(s,a) ] - \\mathbb{E}_{d^\\pi_{\\widehat{P},\\gamma}}[ r(s,a) ]\\right|=\\left|\\mathbb{E}_{d^\\pi_{\\widehat{P},\\gamma}}[ r(s,a) ] - \\mathbb{E}_{d^\\pi_{P,\\gamma}}[ r(s,a) ]\\right|\\\\\n        \\label{using start}\n        &=\\left|\\textbf{r}^\\top\\left[(I-\\gamma\\hat{\\textbf{P}})^{-1}-(I-\\gamma\\textbf{P})^{-1}\\right]\\textbf{d}_0\\right| \\\\\n        &=\\left| \\textbf{r}^\\top(I-\\gamma\\textbf{P})^{-1}\\left[\\gamma\\hat{\\textbf{P}}-\\gamma\\textbf{P} \\right](I-\\gamma\\hat{\\textbf{P}})^{-1}\\textbf{d}_0\\right|\\\\\n        &=\\gamma\\left| \\textbf{r}^\\top(I-\\gamma\\textbf{P})^{-1}\\left[\\hat{\\textbf{P}}-\\textbf{P} \\right]\\frac{\\textbf{d}^\\pi_{\\widehat{P}}}{1-\\gamma}\\right|\\\\\n        &\\leq\\frac{\\gamma}{1-\\gamma}\\left\\Vert \\textbf{r}^\\top(I-\\gamma\\textbf{P})^{-1}\\right\\Vert_\\infty \\left\\Vert\\left[\\hat{\\textbf{P}}-\\textbf{P} \\right]\\textbf{d}^\\pi_{\\widehat{P}} \\right\\Vert_1\\\\\n        \\label{using end}\n        &\\leq\\frac{\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\left\\Vert\\left[\\hat{\\textbf{P}}-\\textbf{P} \\right]\\textbf{d}^\\pi_{\\widehat{P}} \\right\\Vert_1\\\\\n        &\\leq\\frac{\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\sum_{s^\\prime,a,s}\\left| \\hat{P}(s^\\prime\\vert s,a)-P(s^\\prime\\vert s,a)\\right|\\pi(a\\vert s)d^\\pi_{\\widehat{P}}(s)\\\\\n        &=\\frac{2\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\mathbb{E}_{\\begin{subarray}{l}s\\sim d^\\pi_{\\widehat{P},\\gamma},\\\\ a\\sim\\pi\\end{subarray}}\\left[\\mathbb{TV}\\left(\\hat{P}\\left(s^\\prime\\vert s,a\\right)\\Vert P\\left(s^\\prime\\vert s,a\\right)\\right)\\right]\n    \n\\end{aligned}')
('8', '\\pi')
('8', '\\mu')
('8', '|r(s,a)|\\leq R_{\\text{max}}')
('8', '\\left|\\mathbb{E}_{d^{\\pi}_{P,\\gamma}}\\left[r(s,a)\\right]-\\mathbb{E}_{d^{\\mu}_{P,\\gamma}}\\left[r(s,a)\\right]\\right|\\leq\\frac{2R_{\\text{max}}}{(1-\\gamma)^2}\\mathbb{E}_{s\\sim d^\\pi_P}\\left[\\mathbb{TV}(\\pi(a\\vert s)\\Vert\\mu(a\\vert s)) \\right].')
('8', '\\begin{aligned}\n        |\\mathbb{E}_{d^\\pi_{P,\\gamma}}[ r(s,a) ] - \\mathbb{E}_{d^{\\mu}_{P,\\gamma}}[ r(s,a) ]|=\\left| \\left[(\\textbf{r}^\\pi)^\\top(I-\\gamma\\textbf{P}^\\pi)^{-1}-(\\textbf{r}^{\\mu})^\\top(I-\\gamma\\textbf{P}^{\\mu})^{-1} \\right]\\textbf{d}_0\\right|&\\\\\n        \\leq\\left| (\\textbf{r}^\\pi-\\textbf{r}^{\\mu})^\\top\\frac{\\textbf{d}^\\pi_{P}}{1-\\gamma}\\right|+\\left|(\\textbf{r}^{\\mu})^\\top\\left[(I-\\gamma\\textbf{P}^\\pi)^{-1}-(I-\\gamma\\textbf{P}^{\\mu})^{-1} \\right]\\textbf{d}_0\\right|&.\n    \n\\end{aligned}')
('8', '\\label{policy bound_1}\n        \\left| (\\textbf{r}^\\pi-\\textbf{r}^{\\mu})^\\top\\frac{\\textbf{d}^\\pi_{P}}{1-\\gamma}\\right|\\leq\\frac{2R_{\\text{max}}}{1-\\gamma}\\mathbb{E}_{s\\sim d^\\pi_{P,\\gamma}}\\left[\\mathbb{TV}(\\pi(a\\vert s)\\Vert \\mu(a\\vert s)) \\right].')
('8', '\\begin{aligned}\n        \\left|(\\textbf{r}^{\\mu})^\\top\\left[(I-\\gamma\\textbf{P}^\\pi)^{-1}-(I-\\gamma\\textbf{P}^{\\mu})^{-1} \\right]\\textbf{d}_0\\right|\\leq\\frac{\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\left\\Vert \\left[\\textbf{P}^\\pi-\\textbf{P}^{\\mu}\\right]\\textbf{d}^\\pi_{P}\\right\\Vert_1\\\\\n        =\\frac{\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\sum_{s^\\prime}\\left| \\sum_{s,a}P(s^\\prime\\vert s,a)\\left[\\pi(a\\vert s)-\\mu(a\\vert s)\\right]d^\\pi_{P}(s)\\right|\\\\\n        \\leq \\frac{\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\sum_{s,a}\\left| \\pi(a\\vert s)-\\mu(a\\vert s)\\right|d^\\pi_{P}(s)\\\\\n        \\label{policy bound_2}\n        =\\frac{2\\gamma R_{\\text{max}}}{(1-\\gamma)^2}\\mathbb{E}_{s\\sim d^\\pi_{P,\\gamma}}\\left[\\mathbb{TV}\\left(\\pi(a\\vert s)\\Vert\\mu(a\\vert s)\\right) \\right].\n    \n\\end{aligned}')
('8', '\\pi')
('8', '\\begin{aligned}\n    &\\left| \\mathbb{E}_{d^\\pi_{P,\\gamma}}[ r(s,a) ]-\\mathbb{E}_{d^{\\pi^E}_{P,\\gamma}}[ r(s,a) ] \\right| \\\\\n    &\\le \\left|\\mathbb{E}_{d^\\pi_{P,\\gamma}}[ r(s,a) ] - \\mathbb{E}_{d^\\pi_{P,\\widehat{\\gamma}}}[ r(s,a) ]\\right| + \\left|\\mathbb{E}_{d^\\pi_{P,\\widehat{\\gamma}}}[ r(s,a) ] - \\mathbb{E}_{d^\\pi_{\\widehat{P},\\widehat{\\gamma}}}[ r(s,a) ]\\right|\\\\\n    &+\\left|\\mathbb{E}_{d^\\pi_{\\widehat{P},\\widehat{\\gamma}}}[ r(s,a) ] - \\mathbb{E}_{d^{\\pi^E}_{\\widehat{P},\\widehat{\\gamma}}}[ r(s,a) ]\\right| + \\left|\\mathbb{E}_{d^{\\pi^E}_{P,\\widehat{\\gamma}}}[ r(s,a) ] - \\mathbb{E}_{d^{\\pi^E}_{\\widehat{P},\\widehat{\\gamma}}}[ r(s,a) ]\\right|\\\\\n    &+ \\left|\\mathbb{E}_{d^{\\pi^E}_{P,\\widehat{\\gamma}}}[ r(s,a) ] - \\mathbb{E}_{d^{\\pi^E}_{P,\\gamma}}[ r(s,a) ]\\right|.\n\\end{aligned}')
('9', '\\pi^E(a_1\\vert s_0)=0.6,\\,\\pi^E(a_2\\vert s_0)=0.4,\\,\\pi^E(a_1\\vert s_1)=1\\,\\,\\pi^E(a_1\\vert g)=1.')
('9', '\\tau_1')
('9', '\\tau_2')
('9', '(s,a)')
('9', '(s,a)')
('9', 'E(s,a)')
('9', '\\begin{aligned}\n    &E(s_0,a_1)=\\frac{0.6N}{3N} = \\frac{1}{5},\\;E(s_0,a_2)=\\frac{0.4N}{3N} = \\frac{2}{15}\\\\&E(s_1,a_1)=\\frac{0.6N}{3N} = \\frac{1}{5},\\;E(g,a_1)=\\frac{1.4N}{3N} = \\frac{7}{15}\n\\end{aligned}')
('9', '\\pi(a_1\\vert s_0)=\\theta,\\,\\pi(a_2\\vert s_0)=1-\\theta,\\,\\pi(a_1\\vert s_1)=1\\,\\,\\pi(a_1\\vert g)=1.')
('9', 'd^\\pi(s,a)')
('9', '\\begin{aligned}\n    d^\\pi(s_0,a_1)&=\\pi(a_1|s_0)\\left[(1-\\gamma)p_0(s_0)+\\gamma\\sum_{\\Bar{s},\\Bar{a}}P(s_0\\vert\\Bar{s},\\Bar{a})d^\\pi(\\Bar{s},\\Bar{a})\\right] = \\theta(1-\\gamma)\\\\\n    d^\\pi(s_0,a_2)&=\\pi(a_2|s_0)\\left[(1-\\gamma)p_0(s_0)+\\gamma\\sum_{\\Bar{s},\\Bar{a}}P(s_0\\vert\\Bar{s},\\Bar{a})d^\\pi(\\Bar{s},\\Bar{a})\\right] = (1-\\theta)(1-\\gamma)\\\\\n    d^\\pi(s_1,a_1)&=\\pi(a_1|s_1)\\left[(1-\\gamma)p_0(s_1)+\\gamma\\sum_{\\Bar{s},\\Bar{a}}P(s_1\\vert\\Bar{s},\\Bar{a})d^\\pi(\\Bar{s},\\Bar{a})\\right]\\\\\n    &= 1\\cdot[(1-\\gamma)\\cdot0+\\gamma\\cdot1\\cdot d^\\pi(s_0,a_1)]=\\theta\\gamma(1-\\gamma)\\\\\n    d^\\pi(g,a_1)&=\\pi(a_1|g)\\left[(1-\\gamma)p_0(g)+\\gamma\\sum_{\\Bar{s},\\Bar{a}}P(g\\vert\\Bar{s},\\Bar{a})d^\\pi(\\Bar{s},\\Bar{a})\\right]\\\\ &= 1\\cdot[0+\\gamma(1\\cdot d^\\pi(s_0,a_2)+1\\cdot d^\\pi(s_1,a_1)+1\\cdot d^\\pi(g,a_1))]\\\\\n    &=(1-\\theta)\\gamma(1-\\gamma)+\\theta\\gamma^2(1-\\gamma)+\\gamma d^\\pi(g,a_1)\\\\\n    &\\rightarrow\\,d^\\pi(g,a_1) = (1-\\theta)\\gamma+\\theta\\gamma^2\n\\end{aligned}')
('9', 'd^\\pi(s,a)')
('9', 'D_{KL}(d^\\pi\\Vert E)')
('9', '\\begin{aligned}\n    \\min_\\pi\\; &D_{KL}(d^\\pi(s,a)\\Vert E(s,a))\\\\&=d^\\pi(s_0,a_1)\\log\\frac{d^\\pi(s_0,a_1)}{E(s_0,a_1)}+d^\\pi(s_0,a_2)\\log\\frac{d^\\pi(s_0,a_2)}{E(s_0,a_2)}\\\\&+d^\\pi(s_1,a_1)\\log\\frac{d^\\pi(s_1,a_1)}{E(s_1,a_1)}+d^\\pi(g,a_1)\\log\\frac{d^\\pi(g,a_1)}{E(g,a_1)}\n     % \\min_\\theta D_{KL}(d^\\pi(s,a)\\Vert E(s,a))=& \\theta(1-\\gamma)\\log\\frac{\\theta(1-\\gamma)}{1/5}+(1-\\theta)(1-\\gamma)\\log\\frac{(1-\\theta)(1-\\gamma)}{2/15}\\\\&+\\theta\\gamma(1-\\gamma)\\log\\frac{\\theta\\gamma(1-\\gamma)}{1/5}+(1-\\theta)\\gamma+\\theta\\gamma^2\\log\\frac{(1-\\theta)\\gamma+\\theta\\gamma^2}{7/15}\n\\end{aligned}')
('9', '\\begin{aligned}\n    % \\min_\\pi D_{KL}(d^\\pi(s,a)\\Vert E(s,a))=&d^\\pi(s_0,a_1)\\log\\frac{d^\\pi(s_0,a_1)}{E(s_0,a_1)}+d^\\pi(s_0,a_2)\\log\\frac{d^\\pi(s_0,a_2)}{E(s_0,a_2)}\\\\&+d^\\pi(s_1,a_1)\\log\\frac{d^\\pi(s_1,a_1)}{E(s_1,a_1)}+d^\\pi(g,a_1)\\log\\frac{d^\\pi(g,a_1)}{E(g,a_1)}\\\\\n     \\min_\\theta\\; &D_{KL}(d^\\pi(s,a)\\Vert E(s,a))\\\\&=\\theta(1-\\gamma)\\log\\frac{\\theta(1-\\gamma)}{1/5}+(1-\\theta)(1-\\gamma)\\log\\frac{(1-\\theta)(1-\\gamma)}{2/15}\\\\&+\\theta\\gamma(1-\\gamma)\\log\\frac{\\theta\\gamma(1-\\gamma)}{1/5}+\\left((1-\\theta)\\gamma+\\theta\\gamma^2\\right)\\log\\frac{(1-\\theta)\\gamma+\\theta\\gamma^2}{7/15}\n\\end{aligned}')
('9', '\\theta^*')
('9', '\\frac{\\partial D_{KL}(d^\\pi(s,a)\\Vert E(s,a))}{\\partial\\theta} = 0.')
('9', 'D_{KL}(d^\\pi(s,a)\\Vert E(s,a))')
('9', '\\begin{aligned}\n\\begin{split}\n    \\frac{\\partial D_{KL}(d^\\pi(s,a)\\Vert E(s,a))}{\\partial\\theta} &=(1-\\gamma)\\left[(1+\\gamma)\\log\\theta-\\log(1-\\theta)+\\log\\frac{2}{3}\\right]\\\\ &+\\gamma(1-\\gamma)\\left[\\log\\frac{7\\gamma(1-\\gamma)}{3}-\\log((1-\\theta)\\gamma+\\theta\\gamma^2)\\right]=0\n\\end{split}\n\\end{aligned}')
('9', '\\theta^*')
('9', '\\frac{3}{5}')
('9', '\\theta')
('9', '\\begin{aligned}\n\\begin{split}\n    &\\frac{\\partial D_{KL}(d^\\pi(s,a)\\Vert E(s,a))}{\\partial\\theta}\\\\& = (1-\\gamma)\\left[(1+\\gamma)\\log\\frac{3}{5}-\\log(1-\\frac{3}{5})+\\log\\frac{2}{3}\\right]\\\\&+\\gamma(1+\\gamma)\\left[\\log\\frac{7\\gamma(1-\\gamma)}{3}-\\log((1-\\frac{3}{5})\\gamma+\\frac{3}{5}\\gamma^2)\\right]=0\\\\\n    &\\rightarrow \\gamma\\log\\frac{3}{5}+\\gamma\\left[\\log\\frac{7\\gamma(1-\\gamma)}{3}-\\log\\left(\\frac{2}{5}\\gamma+\\frac{3}{5}\\gamma^2\\right)\\right]=0\\\\\n    &\\rightarrow \\log\\frac{3}{5}+\\log\\frac{7\\gamma(1-\\gamma)}{3}-\\log\\left(\\frac{2}{5}\\gamma+\\frac{3}{5}\\gamma^2\\right)=\\log\\left(\\frac{7(1-\\gamma)}{2+3\\gamma}\\right)=0\\\\\n    &\\rightarrow 7(1-\\gamma)=2+3\\gamma\n\\end{split}\n\\end{aligned}')
('9', '\\gamma\\in[0,1)')
('9', '\\gamma=1')
('9', '\\gamma=0.5')
('9', '\\gamma=0.5')
('9', '\\min_\\pi D_{KL}(d^\\pi(s,a)\\Vert E(s,a))')
('9', '\\gamma')
('10', '\\tilde{p}_0')
('10', 't_0+t_{geom}')
('10', 't_0\\sim\\tilde{p}_0(t)')
('10', 't_{geom}\\sim \\text{Geom}_{1-\\gamma}(t\\vert t_0)')
('10', '\\text{Geom}_{1-\\gamma}(t\\vert t_0)')
('10', '|T|')
('10', '|T|')
('10', '\\text{Geom}_{1-\\gamma}(t\\vert t_0)')
('10', 'T=t_0+t_{geom}')
('10', 'P_T(T)')
('10', '\\begin{aligned}\n\\begin{split}\n\\label{C.1}\n    P_T(T) &= \\sum^T_{t_0=0}\\text{Geom}_{1-\\gamma}(T-t_0|t_0)\\tilde{p}_0(t_0)\\\\\n    &= \\sum^T_{t_0=0}\\frac{(1-\\gamma)\\gamma^{T-t_0}}{\\sum_{i=0}^{|T|-t_0}(1-\\gamma)\\gamma^i}\\tilde{p}_0(t_0)\\\\\n    &= \\sum^T_{t_0=0}\\frac{(1-\\gamma)\\gamma^{T-t_0}}{Sum(|T|-t_0)}\\tilde{p}_0(t_0).\n\\end{split}\n\\end{aligned}')
('10', '\\sum_{i=0}^{|T|-t_0}(1-\\gamma)\\gamma^i')
('10', 'Sum(|T|-t_0)')
('10', '\\underbrace{\n\\begin{bmatrix}\nP_T(0)\\\\\\\\\\\\\n\\vdots\\\\\\\\\\\\\nP_T(|T|)\n\\end{bmatrix}}_{P_T}\n=\\underbrace{\n\\begin{bmatrix}\n\\frac{1-\\gamma}{Sum(|T|)} & 0 & 0 & \\cdots & 0 \\\\\n\\frac{(1-\\gamma)\\gamma}{Sum(|T|)} & \\frac{1-\\gamma}{Sum(|T|-1)} & 0 & \\cdots & 0 \\\\\n& \\frac{(1-\\gamma)\\gamma}{Sum(|T|-1)} & \\frac{1-\\gamma}{Sum(|T|-2)} & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n& &  & \\\\\n\\frac{(1-\\gamma)\\gamma^{|T|}}{Sum(|T|)} & \\frac{(1-\\gamma)\\gamma^{|T|-1}}{Sum(|T|-1)} & \\frac{(1-\\gamma)\\gamma^{|T|-2}}{Sum(|T|-2)} & \\cdots & 1-\\gamma\\;\n\\end{bmatrix}}_{P_{t_{geom}}}\n\\underbrace{\\begin{bmatrix}\n\\tilde{p}_0(0)\\\\\\\\\\\\\n\\vdots\\\\\\\\\\\\\n\\tilde{p}_0(|T|)\n\\end{bmatrix}}_{\\tilde{p}_0}')
('10', 'P_T(T) = \\frac{\\textrm{The number of data with timestep T in dataset}}{\\textrm{Total number of data in dataset}}')
('10', '\\tilde{p}_0 = P^{-1}_{t_{geom}}\\cdot P_T')
('10', '\\tilde{p}_0(t)')
('11.0', '\\mathcal{D}^D=\\mathcal{D}^E\\cup \\mathcal{D}^O')
('11.0', '\\tilde{p}_0')
('11.0', '\\pi_\\theta')
('11.0', '\\theta')
('11.0', '\\nu_\\phi')
('11.0', 'c_\\psi')
('11.0', '\\phi')
('11.0', '\\psi')
('11.0', '\\gamma')
('11.0', 'B')
('11.0', '\\alpha')
('11.0', 'P_{T_\\mathcal{D}}')
('11.0', 'P_T')
('11.0', '\\mathcal{D}')
('11.0', '\\mathcal{D}_t')
('11.0', '\\mathcal{D}')
('11.0', 't')
('11.0', '\\tilde{p}_0')
('11.0', '\\gamma')
('11.0', 'P_{T_{\\mathcal{D}^D}}')
('11.0', '\\{t_0^{(i)}\\}^{B}_{i=1}\\sim\\tilde{p}_0')
('11.0', '\\{t^{(i)}\\}^{B}_{i=1}\\sim P_{T_{\\mathcal{D}^D}}')
('11.0', '\\{t_e^{(i)}\\}^{B}_{i=1}\\sim P_{T_{\\mathcal{D}^E}}')
('11.0', '\\{s_0^{(i)}\\}\\sim \\mathcal{D}^D_{t_0^{(i)}}')
('11.0', 'i=1,...,B')
('11.0', '\\{(s^{(i)}, a^{(i)}, {s^\\prime}^{(i)})\\}\\sim \\mathcal{D}^D_{t^{(i)}}')
('11.0', 'i=1,...,B')
('11.0', '\\{(s_e^{(i)}, a_e^{(i)}, {s_e^\\prime}^{(i)})\\}\\sim \\mathcal{D}^E_{t_e^{(i)}}')
('11.0', 'i=1,...B')
('11.0', 'J_c')
('11.0', '\\{(s^{(i)},a^{(i)})\\}^{B}_{i=1}')
('11.0', '\\{(s^{(i)}_e,a^{(i)}_e)\\}^{B}_{i=1}')
('11.0', 'J_\\nu')
('11.0', '\\{s^{(i)}_0\\}^{B}_{i=1}')
('11.0', '\\{(s^{(i)}, a^{(i)}, {s^\\prime}^{(i)})\\}^{B}_{i=1}')
('11.0', 'J_\\pi')
('11.0', '\\{(s^{(i)}, a^{(i)}, {s^\\prime}^{(i)})\\}^{B}_{i=1}')
('11.0', '\\psi\\leftarrow\\psi-\\alpha\\nabla_\\psi J_c')
('11.0', '\\phi \\leftarrow \\phi-\\alpha\\nabla_\\phi J_\\nu')
('11.0', '\\theta \\leftarrow \\theta-\\alpha\\nabla_\\theta J_\\pi')
('11.0', 'd^E, D,')
('11.0', 'p_0')
('11.0', '\\text{Geom}(1-\\gamma')
('11.0', '\\gamma')
('11.0', 'P_T')
('11.0', 'D^D')
('11.0', 'P_T')
('11.0', '\\frac{\\textrm{The number of data with timestep T in dataset}}{\\textrm{Total number of data in dataset}}')
('11.0', 'd^E')
('11.0', 'P_{T_{D^E}}')
('11.0', 'A_\\nu(s,a)')
('11.0', '\\gamma\\nu({s^\\prime}^{(i)})')
('11.0', '\\gamma\\mathcal{P}\\nu(s^{(i)})')
('11.0', '\\log{\\frac{d^E(s,a)}{D(s,a)}}')
('11.0', '\\alpha')
('11.1', '3\\times10^{-4}')
('11.1', '[256, 256]')
('11.1', '3\\times10^{-4}')
('11.1', '[256, 256]')
('11.1', '10^{-4}')
('11.1', '3\\times10^{-4}')
('11.1', '[256, 256]')
('11.1', '10^6')
('12.0', '\\mathcal{D}^E')
('12.0', '\\mathcal{D}^O')
('12.0', 'Q')
('12.0', '\\omega\\in[0,1]')
('12.0', '\\omega V^*(s_0)+(1-\\omega)V^{\\pi_{\\text{unif}}}(s_0)')
('12.0', 'V^*')
('12.0', 'V^{\\pi_{\\text{unif}}}')
('12.0', '\\hat{P}')
('12.0', '\\hat{\\gamma}')
('12.0', '\\hat{\\gamma}\\in\\{0.99, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1\\}')
('12.0', '\\{5, 20, 60, 100\\}')
('12.0', '\\gamma')
('12.0', '\\gamma')
('12.1', '\\gamma')
('12.1', '\\gamma\\in\\{0.99, 0.95, 0.9, 0.8, 0.7, 0.6\\}')
('12.1', '\\gamma\\in\\{0.99, 0.95, 0.9, 0.8, 0.7, 0.6\\}')
('12.1', '\\gamma\\in\\{0.99, 0.95, 0.9, 0.8, 0.7, 0.6\\}')
('12.1', '\\gamma\\in\\{0.99, 0.95, 0.9, 0.8, 0.7, 0.6\\}')
('13.0', '\\gamma=0.99')
('13.0', '\\alpha')
('13.1', '\\epsilon_P')
('13.1', '\\epsilon_\\pi')
('13.1', 'd_{\\widehat{P}, \\hat{\\gamma}}^\\pi(s)')
('13.1', 'D_{TV}(\\pi\\Vert\\pi^E)')
('13.1', '\\epsilon_\\pi')
('13.2', '\\mathcal{D}^O')
('13.2', '\\gamma=0.99')
('13.2', '\\mathcal{D}^O')
