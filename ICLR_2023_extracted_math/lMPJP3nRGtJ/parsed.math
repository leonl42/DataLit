('1', 'n')
('1', '\\textbf{y}^{(i)}\\in\\mathbb{R}^D')
('1', 'i')
('1', '\\textbf{y}^{(i)}')
('1', '\\textrm{Loss}(\\textbf{y}^{(i)})')
('1', '\\textrm{Loss}(\\textbf{y})')
('1', '\\textrm{Loss}(h(\\textbf{y}))')
('1', 'h(\\cdot):\\mathbb{R}^D\\rightarrow \\mathbb{R}')
('1', 'h(\\cdot)')
('1', '\\textrm{Loss}(\\textbf{y}^{(i)})')
('1', '\\textrm{Loss}(\\textbf{y}^{(i)})  =\\textrm{Loss}(\\tilde{\\textbf{y}})+ (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{g} +\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{H}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})+R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('1', '\\textbf{g} \\in \\mathbb{R}^{D}')
('1', '\\textbf{H} \\in \\mathbb{R}^{D\\times D}')
('1', '\\tilde{\\textbf{y}}\\in\\mathbb{R}^D')
('1', '\\tilde{\\textbf{y}}')
('1', '\\textbf{y}^{(i)}')
('1', '{\\textbf{g}}')
('1', '{\\bf H}')
('1', '\\tilde{\\textbf{y}}')
('1', '{\\bf g}')
('1', '{\\bf H}')
('1', '\\textrm{Loss}(y^{(i)},\\textit{label}^{(i)})')
('1', '\\textbf{g}^{(i)}')
('1', '\\textbf{H}^{(i)}')
('1', '\\tilde{\\textbf{y}}')
('1', '\\tilde{\\textbf{y}}')
('1', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{g}^{(i)}')
('1', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{H}^{(i)}')
('1', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu')
('1', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu')
('1', '\\textbf{g}')
('1', '\\tilde{\\textbf{y}}')
('1', '\\textbf{H}')
('1', '\\tilde{\\textbf{y}}')
('1', '\\textbf{H}')
('1', '\\tilde{\\textbf{y}}')
('1', '{\\textbf{g}}')
('2', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu')
('3', 'n')
('3', '\\textbf{X}=[\\textbf{x}^{(1)}, \\textbf{x}^{(2)}, \\ldots, \\textbf{x}^{(n)}]\\in\\mathbb{R}^{D\\times n}')
('3', 'i')
('3', '\\textbf{x}^{(i)}\\in\\mathbb{R}^D')
('3', 'i')
('3', '\\textbf{Z} = \\textit{BN}(\\textbf{X})')
('3', '\\begin{aligned}\n        \\label{eq:bn1}\n        \\textbf{Z} &=  \\textit{diag}(\\boldsymbol{\\gamma})  \\textbf{Y} + \\boldsymbol{\\beta}\\textbf{1}_n^{\\top}\\qquad \\qquad \\qquad \\qquad\\ \\ \\  \\text{(affine transformation phase)}\\\\\n        \\label{eq:bn2}\n        \\textbf{Y} &=  \\textit{diag}(\\boldsymbol{\\sigma}\\circ \\boldsymbol{\\sigma} +\\varepsilon \\textbf{1}_D)^{-\\frac{1}{2}} ( \\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top} )    \\qquad \\text{(standardization phase)}\n    \n\\end{aligned}')
('3', '\\textbf{Z}=[\\textbf{z}^{(1)},\\textbf{z}^{(2)},\\ldots,\\textbf{z}^{(n)}]\\in\\mathbb{R}^{D \\times n}')
('3', '\\textbf{Y}=[\\textbf{y}^{(1)},\\textbf{y}^{(2)},\\ldots,\\textbf{y}^{(n)}]\\in\\mathbb{R}^{D \\times n}')
('3', '\\boldsymbol{\\gamma},\\boldsymbol{\\beta}\\in\\mathbb{R}^D')
('3', '\\boldsymbol{\\mu} = \\frac{1}{n}\\textbf{X}\\textbf{1}_n\\in\\mathbb{R}^D')
('3', '\\boldsymbol{\\sigma}=[\\sqrt{\\boldsymbol{\\Sigma}_{1,1}},\\ldots,\\sqrt{\\boldsymbol{\\Sigma}_{D,D}}]^{\\top}\\in\\mathbb{R}^D')
('3', '\\boldsymbol{\\Sigma} = \\frac{1}{n} (\\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top}) (\\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top})^{\\top}\\in\\mathbb{R}^{D\\times D}')
('3', '\\textbf{1}_n\\in\\mathbb{R}^n')
('3', '\\circ')
('3', '\\varepsilon')
('3', '\\varepsilon')
('3', '\\textit{diag}(\\cdot)')
('3', 'i')
('3', '\\textbf{y}^{(i)}')
('3', '\\tilde{\\textbf{y}}\\in\\mathbb{R}^D')
('3', '\\textbf{y}^{(i)}')
('3', '\\textbf{y}^{(i)}')
('3', '\\label{eq:TaylorExp}\n        \\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}})=\\textrm{Loss}(\\tilde{\\textbf{y}})+ (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{g} +\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{H}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})+R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\textbf{g} \\in \\mathbb{R}^{D}')
('3', '\\textbf{H} \\in \\mathbb{R}^{D \\times D}')
('3', '\\textrm{Loss}(\\textbf{y}^{(i)})')
('3', '\\tilde{\\textbf{y}}')
('3', 'R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\bullet')
('3', '\\textrm{Loss}(\\textbf{y}^{(i)})=-\\log p(\\textit{input}^{(i)})')
('3', '\\textit{input}^{(i)}')
('3', '\\textit{crossEntropy}(\\textbf{y}^{(i)}, \\textit{label}^*)')
('3', '\\textrm{Loss}^{\\text{batch}}=\\sum_{i=1}^{n}\\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}})')
('3', '\\label{eq:Taylor_simple}\n        \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H}) \\xlongequal{\\textbf{decomposed into}}\n        \\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) +\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H}) + \\sum\\nolimits_i R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\textrm{Loss}^{\\text{constant}}=n\\textrm{Loss}(\\tilde{\\textbf{y}})')
('3', '\\textbf{X}')
('3', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})=\\sum_{i=1}^{n}(\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})^{\\top}\\textbf{g}')
('3', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})=\\sum_{i=1}^{n}\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{H}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})')
('3', '\\textrm{Loss}^{\\text{constant}}')
('3', '\\textbf{X}')
('3', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{X}} = \\textbf{0}')
('3', '\\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{X}} = \\textbf{0}')
('3', '\\varepsilon=0')
('3', '\\varepsilon')
('3', '\\varepsilon')
('3', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})')
('3', 'i.e.')
('3', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})= \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}),')
('3', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) = \\sum_{i=1}^{n}\\frac{1}{2!} (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{diag}}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\textrm{Loss}^{\\text{off}} (\\textbf{H}^{\\text{off}})= \\sum_{i=1}^{n}\\frac{1}{2!} (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{off}}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\textbf{H}^{\\text{diag}}')
('3', '\\textbf{H}^{\\text{off}} = \\textbf{H} - \\textbf{H}^{\\text{diag}}')
('3', '\\textbf{H}')
('3', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('3', '\\textbf{X}')
('3', '\\frac{\\partial\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) }{\\partial \\textbf{X}} = \\textbf{0}')
('3', '\\textbf{x}_d=[\\textbf{X}_{d,1},\\textbf{X}_{d,2},\\ldots,\\textbf{X}_{d,n}]^{\\top}\\in\\mathbb{R}^n')
('3', 'd')
('3', 'n')
('3', '\\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})')
('3', '\\textbf{x}_d')
('3', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})= \\textbf{H}^{\\text{off}}_{d,:}(\\textbf{Y} -\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})  \\textbf{y}_d')
('3', '\\textbf{x}_d')
('3', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('3', '\\textbf{H}_{d,:}^{\\text{off}}=[\\textbf{H}_{d,1}^{\\text{off}},\\textbf{H}_{d,2}^{\\text{off}},\\ldots,\\textbf{H}_{d,D}^{\\text{off}}]\\in\\mathbb{R}^D')
('3', 'd')
('3', '\\textbf{H}^{\\text{off}}')
('3', '\\textbf{y}_d=[\\textbf{Y}_{d,1},\\textbf{Y}_{d,2},\\ldots,\\textbf{Y}_{d,n}]^{\\top}\\in\\mathbb{R}^n')
('3', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})')
('3', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})=L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})+L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}}),')
('3', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})=\\textbf{H}_{d,:}^{\\text{off}} \\textbf{Y}^{\\text{linear}}\\textbf{y}_d')
('3', 'L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})= \\textbf{H}_{d,:}^{\\text{off}} (\\textbf{Y}^{\\text{non}}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})\\textbf{y}_d')
('3', '\\textbf{Y}^{\\text{linear}}= [ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top} \\textbf{o}_d^{\\top}')
('3', '\\textbf{Y}^{\\text{non}}=\\textbf{Y}-\\textbf{Y}^{\\text{linear}}')
('3', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}')
('3', '\\textbf{y}_d')
('3', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})= \\lVert \\textbf{y}_d \\rVert  \\cdot  \\textbf{H}_{d,:}^{\\text{off}} [ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}')
('3', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} + \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('3', '\\forall d')
('3', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('3', 'd')
('3', 'n')
('3', '\\textbf{x}_d\\in\\mathbb{R}^n')
('3', '\\forall d,\\ \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\textbf{0},')
('3', '\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} = \\frac{\\partial ^2 }{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} (A  [ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}   ) = \\textbf{0}')
('3', 'A=\\lVert \\textbf{y}_d \\rVert  \\cdot  \\textbf{H}_{d,:}^{\\text{off}}')
('3', '\\frac{\\partial^2 L_d ^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d} \\partial \\textbf{H}_{d, :}^{\\text{off}}} =  \\frac{1}{\\boldsymbol{\\sigma}_d} \\cdot [(\\textbf{y}_{1}- \\| \\textbf{y}_{1} \\| \\cos(\\textbf{y}_1, \\textbf{y}_d)\\textbf{o}_d ), \\ldots,(\\textbf{y}_{D} - \\|\\textbf{y}_{D} \\| \\cos(\\textbf{y}_D, \\textbf{y}_d) \\textbf{o}_d  )]  \\ne \\textbf{0}')
('3', '\\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})')
('3', '\\textbf{x}_d')
('3', '\\forall d, \\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} + \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('3', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('3', '\\textbf{y}_d')
('3', '[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}')
('3', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}')
('3', '\\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('3', '\\textbf{y}_d')
('3', '\\textbf{y}_d')
('3', '\\forall j, \\textbf{y}_{j}- \\|\\textbf{y}_j\\| \\cos(\\textbf{y}_j, \\textbf{y}_d) \\textbf{o}_d')
('3', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\textbf{0}')
('3', 'd')
('3', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('3', '\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}}=\\textbf{0},\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}=\\textbf{0}')
('3', '\\forall d,\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}=\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}+\\frac{\\partial ^2 L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}')
('3', '\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} = \\textbf{0}')
('3', '\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}}\\ne\\textbf{0},\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\\ne\\textbf{0}')
('3', '\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} \\ne \\textbf{0}')
('3', '\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}^{\\top}}=\\textbf{0},\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}=\\textbf{0}')
('3', '\\forall d, \\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} = \\textbf{0}')
('3', '\\textbf{g}')
('3', '\\textbf{H}')
('3', '\\textbf{H}')
('3', '\\boldsymbol{\\mu}')
('3', '\\boldsymbol{\\sigma}')
('3', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g}),\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('3', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('3', '\\boldsymbol{\\gamma}')
('3', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})')
('3', '\\textbf{g}')
('3', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('3', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('3', '\\textbf{H}')
('3', '\\tilde{\\textbf{y}}')
('3', '\\mathbb{E}_i [\\textbf{y}^{(i)}]')
('3', '\\textbf{y}^{(i)}')
('3', '\\tilde{\\textbf{y}}')
('3', '\\bullet')
('3', 'i')
('3', '1\\le i \\le n')
('3', '\\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}}) = \\textrm{Loss}(\\tilde{\\textbf{y}}) + \\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu) +\\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{off}}) + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}^{\\prime (i)}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\prime (i) \\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\prime (i) \\text{off}}) + R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('3', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{g}^{(i)}')
('3', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{H}^{(i)}')
('3', '\\textbf{g}^{\\prime (i)} = \\textbf{g}^{(i)} - \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu')
('3', '\\textbf{H}^{\\prime (i)} = \\textbf{H}^{(i)} - \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu')
('3', 'i')
('3', '\\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu)')
('3', '\\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}})')
('3', '\\textrm{Loss}^{\\text{off}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{off}})')
('4', '\\bullet')
('4', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})')
('4', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('4', '\\forall 0\\le k\\le 4')
('4', '\\textrm{Loss}_k( \\textbf{y} | \\boldsymbol{\\lambda}) =\\sum_{i=1}^{n} \\sum_{k^\\prime=k}^4\n    \\lambda_{k^\\prime} (y^{(i)})^{k^\\prime}')
('4', '\\boldsymbol{\\lambda} = [\\lambda_0,\\lambda_1,\\ldots,\\lambda_4]^{\\top} \\sim N(\\boldsymbol{\\mu}=\\textbf{0},\\Sigma=I_{5\\times 5})')
('4', '\\boldsymbol{\\lambda}')
('4', 'k')
('4', '\\textrm{Loss}_k')
('4', 'M')
('4', 'N(\\boldsymbol{\\mu}=\\textbf{0},\\Sigma=I_{M\\times M})')
('4', '\\textrm{Loss}_k')
('4', '0\\le k\\le4')
('4', '\\Delta \\text{grad}_q = \\mathbb{E}_{\\boldsymbol{\\lambda}} \\left[ \\lVert \\frac{\\partial \\textrm{Loss}_q( \\textbf{y} | \\boldsymbol{\\lambda})  }{\\partial \\textbf{x}}-\\frac{\\partial \\textrm{Loss}_{q+1}( \\textbf{y}| \\boldsymbol{\\lambda}) }{\\partial \\textbf{x}} \\rVert  /  \\lVert \\frac{\\partial \\textrm{Loss}_q( \\textbf{y}| \\boldsymbol{\\lambda})  }{\\partial \\textbf{x}} \\rVert \\right],q=0,1,2,3')
('4', 'q')
('4', '\\Delta \\text{grad}_0 = 0, \\Delta \\text{grad}_1 \\approx 0')
('4', '\\Delta \\text{grad}_2 \\approx 0')
('4', '\\Delta \\text{grad}_3=0.51 \\pm 0.33')
('4', '\\textbf{g}')
('4', '\\textbf{H}')
('4', '\\textrm{Loss}^* = \\sum_{i=1}^{n}\\textrm{Loss}^{\\text{cls}}(\\textbf{y}^{(i)})')
('4', '\\textrm{Loss}_2')
('4', '\\textrm{Loss}_3')
('4', '\\textrm{Loss}_4')
('4', '\\textrm{Loss}_2 = \\sum_{i=1}^{n} (\\textrm{Loss}^{\\text{cls}}(\\textbf{y}^{(i)}) + \\boldsymbol{\\epsilon}^{\\top} \\textbf{y}^{(i)})')
('4', '\\textrm{Loss}_3 = \\sum_{i=1}^{n}(\\textrm{Loss}^{\\text{cls}}(\\textbf{y}^{(i)}) + (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top} \\textit{diag}(\\boldsymbol{\\epsilon})(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}))')
('4', '\\textrm{Loss}_4 = \\sum_{i=1}^{n}(\\textrm{Loss}^{\\text{cls}}(\\textbf{y}^{(i)}) + (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top} \\textbf{E}^{\\text{off}}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}))')
('4', '\\tilde{\\textbf{y}}=\\frac{1}{n}\\sum_{i=1}^{n}\\textbf{y}^{(i)}=\\textbf{0}')
('4', '\\boldsymbol{\\epsilon}\\in\\mathbb{R}^{D}')
('4', '\\textbf{E}^{\\text{off}}\\in\\mathbb{R}^{D\\times D}')
('4', 'N(\\mu=0,\\sigma^2=0.1^2)')
('4', '\\textbf{E}^{\\text{off}}')
('4', '\\frac{\\partial \\textrm{Loss}^* }{\\partial \\textbf{X}}=\\frac{\\partial \\textrm{Loss}_2 }{\\partial \\textbf{X}} =\\frac{\\partial \\textrm{Loss}_3 }{\\partial \\textbf{X}}')
('4', '\\textbf{g}')
('4', '\\textbf{H}')
('4', '\\Delta\\text{grad}^{\\text{first}} = \\lVert \\frac{\\partial \\textrm{Loss}^* }{\\partial \\textbf{X}}-\\frac{\\partial \\textrm{Loss}_2 }{\\partial \\textbf{X}} \\rVert_F / \\lVert \\frac{\\partial \\textrm{Loss}^* }{\\partial \\textbf{X}} \\rVert_F')
('4', '\\Delta\\text{grad}^{\\text{second,diag}} = \\lVert \\frac{\\partial \\textrm{Loss}^* }{\\partial \\textbf{X}}-\\frac{\\partial \\textrm{Loss}_3 }{\\partial \\textbf{X}} \\rVert_F / \\lVert \\frac{\\partial \\textrm{Loss}^*  }{\\partial \\textbf{X}} \\rVert_F')
('4', '\\Delta\\text{grad}^{\\text{second,off}} =\\lVert \\frac{\\partial \\textrm{Loss}^*  }{\\partial \\textbf{X}}-\\frac{\\partial \\textrm{Loss}_4 }{\\partial \\textbf{X}} \\rVert_F / \\lVert \\frac{\\partial \\textrm{Loss}^*}{\\partial \\textbf{X}} \\rVert_F')
('4', '\\textbf{g}')
('4', '\\textbf{H}')
('4', '\\textbf{H}')
('4', '\\frac{\\partial \\textrm{Loss}^*  }{\\partial \\textbf{X}}')
('4', '\\Delta\\text{grad}^{\\text{first}} \\approx 0')
('4', '\\Delta\\text{grad}^{\\text{second,diag}}\\approx 0')
('4', '\\textbf{g}')
('4', '\\textbf{H}')
('4', '\\Delta\\text{grad}^{\\text{second,off}}')
('4', '\\textbf{H}')
('4', '\\bullet')
('4', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('4', '\\lVert  \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} \\rVert')
('4', '\\textbf{H}_{d,:}^{\\text{off}}')
('4', '\\lVert  \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} \\rVert')
('4', 'd')
('4', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('4', '\\bullet')
('4', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})')
('4', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})=L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})+L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})')
('4', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('4', '\\textbf{y}_d')
('4', '\\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}')
('4', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('4', '\\textbf{x}_d')
('4', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}=\\textbf{0}')
('4', '\\lVert \\frac{ \\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d} \\rVert / \\lVert \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d} \\rVert')
('4', '\\frac{ \\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}')
('4', '\\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}')
('4', '\\lVert \\frac{ \\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d} \\rVert / \\lVert \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d} \\rVert')
('4', '\\frac{ \\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}')
('4', '\\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}')
('4', 'd')
('4', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('4', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})')
('4', '\\textbf{y}_d')
('4', '\\frac{ \\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}')
('4', '\\bullet')
('4', '-\\log p(\\textit{input})')
('4', 'I_1^{\\text{real}}')
('4', 'I_2^{\\text{real}}')
('4', 'I_{\\alpha}^{\\text{inter}} = \\alpha I_1^{\\text{real}} + (1-\\alpha) I_2^{\\text{real}}, \\alpha\\in(0,1)')
('4', 'I_{\\alpha}^{\\text{inter}}')
('4', '\\alpha')
('4', '\\mathbb{E}_{\\forall I_1^{\\text{real}},I_2^{\\text{real}}}[ \\log p(I_{\\alpha}^{\\text{inter}}) ]')
('4', '\\alpha=0')
('4', '\\alpha=1')
('4', '\\alpha=0')
('4', '\\alpha=1')
('4', '\\tilde{\\textbf{y}}')
('6', '\\boldsymbol{\\mu}')
('6', '\\boldsymbol{\\sigma}')
('6', '\\textbf{g}')
('6', '\\textbf{H}')
('7', 'n')
('7', '\\textbf{X}=[\\textbf{x}^{(1)}, \\textbf{x}^{(2)}, \\ldots, \\textbf{x}^{(n)}] =[ \\textbf{x}_{1}^{\\top}; \\textbf{x}_{2}^{\\top}; \\ldots; \\textbf{x}_{D}^{\\top}]\\in\\mathbb{R}^{D\\times n}')
('7', 'i')
('7', 'i')
('7', 'D')
('7', '\\textbf{x}^{(i)}\\in \\mathbb{R}^{D}')
('7', 'i = 1, \\cdots, n')
('7', 'd')
('7', 'd')
('7', 'n')
('7', '\\textbf{x}_d \\in \\mathbb{R}^{n}')
('7', 'd = 1, \\cdots, D')
('7', '\\textbf{X}')
('7', '\\label{eq:X}\n        \\textbf{X}=\n        \\begin{bmatrix}\n            \\vert & \\vert & \\cdots & \\vert \\\\\n            \\textbf{x}^{(1)}& \\textbf{x}^{(2)}& \\cdots & \\textbf{x}^{(n)}  \\\\\n            \\vert & \\vert & \\cdots & \\vert\n        \\end{bmatrix}=\n        %\n    \\begin{bmatrix}\n        \\begin{array}{@{\\protect\\rotatebox[origin=c]{90}{$\\vert$}\\;}c@{\\;\\protect\\rotatebox[origin=c]{90}{$\\vert$}}}\n            \\textbf{x}_{1}^{\\top}  \\\\ \\textbf{x}_{2}^{\\top}  \\\\ \\multicolumn{1}{@{}c@{}}{\\vdots}\\\\ \\textbf{x}_{D}^{\\top}\n        \\end{array}\n    \\end{bmatrix}\n=\n        \\begin{bmatrix}\n            \\textbf{X}_{1,1} & \\textbf{X}_{1,2} & \\cdots  & \\textbf{X}_{1,n}\\\\\n            \\textbf{X}_{2,1} & \\textbf{X}_{2,2} & \\cdots  & \\textbf{X}_{2,n}\\\\\n            \\vdots & \\vdots & \\ddots & \\vdots \\\\\n            \\textbf{X}_{D,1} & \\textbf{X}_{D,2} & \\cdots  & \\textbf{X}_{D,n}\\\\\n        \\end{bmatrix}. \\nonumber')
('7', '\\textbf{Z} = \\textit{BN}(\\textbf{X})')
('7', '\\textbf{X}')
('7', '\\begin{aligned}\n        \\label{eq:bn1}\n        \\textbf{Z} &=  \\textit{diag}(\\boldsymbol{\\gamma})  \\textbf{Y} + \\boldsymbol{\\beta}\\textbf{1}_n^{\\top}\\qquad \\qquad \\qquad \\qquad\\ \\ \\  \\text{(affine transformation phase)} \\\\\n        \\label{eq:bn2}\n        \\textbf{Y} &=  \\textit{diag}(\\boldsymbol{\\sigma}\\circ \\boldsymbol{\\sigma} +\\varepsilon \\textbf{1}_D)^{-\\frac{1}{2}} ( \\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top} )    \\qquad \\text{(standardization phase)}\n    \n\\end{aligned}')
('7', '\\textbf{Z}=[\\textbf{z}^{(1)},\\textbf{z}^{(2)},\\ldots,\\textbf{z}^{(n)}]\\in\\mathbb{R}^{D \\times n}')
('7', '\\textbf{Y}=[\\textbf{y}^{(1)},\\textbf{y}^{(2)},\\ldots,\\textbf{y}^{(n)}]=[ \\textbf{y}_{1}^{\\top}; \\textbf{y}_{2}^{\\top}; \\ldots; \\textbf{y}_{D}^{\\top}] \\in\\mathbb{R}^{D \\times n}')
('7', '\\boldsymbol{\\gamma},\\boldsymbol{\\beta}\\in\\mathbb{R}^D')
('7', '\\boldsymbol{\\mu} = \\frac{1}{n}\\textbf{X}\\textbf{1}_n\\in\\mathbb{R}^D')
('7', '\\boldsymbol{\\Sigma} = \\frac{1}{n} (\\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top}) (\\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top})^{\\top}\\in\\mathbb{R}^{D\\times D}')
('7', '\\textbf{X}')
('7', '\\boldsymbol{\\sigma}=[\\sqrt{\\boldsymbol{\\Sigma}_{1,1}},\\ldots,\\sqrt{\\boldsymbol{\\Sigma}_{D,D}}]^{\\top}\\in\\mathbb{R}^D')
('7', '\\boldsymbol{\\Sigma}')
('7', '\\textbf{1}_D\\in\\mathbb{R}^D')
('7', '\\textbf{1}_n\\in\\mathbb{R}^n')
('7', '\\circ')
('7', '\\varepsilon')
('7', '\\textit{diag}(\\cdot)')
('7', '\\label{eq:Y}\n        \\textbf{Y}=\n        \\begin{bmatrix}\n            \\vert & \\vert & \\cdots & \\vert \\\\\n            \\textbf{y}^{(1)}& \\textbf{y}^{(2)}& \\cdots & \\textbf{y}^{(n)}  \\\\\n            \\vert & \\vert & \\cdots & \\vert\n        \\end{bmatrix}=\n        %\n    \\begin{bmatrix}\n        \\begin{array}{@{\\protect\\rotatebox[origin=c]{90}{$\\vert$}\\;}c@{\\;\\protect\\rotatebox[origin=c]{90}{$\\vert$}}}\n            \\textbf{y}_{1}^{\\top}  \\\\ \\textbf{y}_{2}^{\\top}  \\\\ \\multicolumn{1}{@{}c@{}}{\\vdots}\\\\ \\textbf{y}_{D}^{\\top}  \n        \\end{array}\n    \\end{bmatrix}\n=\n        \\begin{bmatrix}\n            \\textbf{Y}_{1,1} & \\textbf{Y}_{1,2} & \\cdots  & \\textbf{Y}_{1,n}\\\\\n            \\textbf{Y}_{2,1} & \\textbf{Y}_{2,2} & \\cdots  & \\textbf{Y}_{2,n}\\\\\n            \\vdots & \\vdots & \\ddots & \\vdots \\\\\n            \\textbf{Y}_{D,1} & \\textbf{Y}_{D,2} & \\cdots  & \\textbf{Y}_{D,n}\\\\\n        \\end{bmatrix}. \\nonumber')
('7', '\\varepsilon')
('7', '\\begin{aligned}\n        \\label{eq:bn3}\n        \\textbf{Y} &=  \\textit{diag}(\\boldsymbol{\\sigma})^{-1} ( \\textbf{X} - \\boldsymbol{\\mu}\\textbf{1}_n^{\\top} )     \\qquad \\text{(standardization phase)}\n    \n\\end{aligned}')
('7', 'd')
('7', 'n')
('7', 'd = 1, \\cdots, D')
('7', '\\begin{aligned}\n        \\label{eq:bn4}\n        \\textbf{y}_d &= \\frac{\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n}{\\boldsymbol{\\sigma}_d} \\in\\mathbb{R}^{n}\n    \n\\end{aligned}')
('7', '\\textbf{y}_d')
('7', 'i.e.')
('7', '\\textbf{y}_d^{\\top}')
('7', 'd')
('7', '\\textbf{Y}')
('8', 'i')
('8', '\\textbf{y}^{(i)}')
('8', '\\textbf{y}^{(i)}')
('8', '\\label{eq:Taylor}\n        \\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}})=\\textrm{Loss}(\\tilde{\\textbf{y}})+ (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{g} +\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{H}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})+ R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\textbf{g} = \\left[\\textbf{g}_1, \\cdots, \\textbf{g}_D\\right] \\in \\mathbb{R}^{D}')
('8', '\\textbf{H} = \\left(\\textbf{H}_{j,k}\\right) \\in \\mathbb{R}^{D \\times D}')
('8', '\\textrm{Loss}(\\textbf{y}^{(i)})')
('8', '\\tilde{\\textbf{y}} = [\\tilde{\\textrm{y}}_1, \\tilde{\\textrm{y}}_2, \\cdots, \\tilde{\\textrm{y}}_D] \\in \\mathbb{R}^{D}')
('8', 'R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\textrm{Loss}^{\\text{batch}} \\in \\mathbb{R}')
('8', '\\textrm{Loss}^{\\text{batch}}')
('8', '\\textbf{Case 1}')
('8', '\\tilde{\\textbf{y}}')
('8', 'i')
('8', 'i = 1, \\cdots, n')
('8', '\\textrm{Loss}^{\\text{batch}}=\\sum_{i=1}^{n}\\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}})')
('8', '\\label{eq:Taylor_simple}\n        \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H}) \\xlongequal{\\textbf{decomposed into}}\n        \\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) +\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H}) + \\sum\\nolimits_i R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\textrm{Loss}^{\\text{constant}}=n\\textrm{Loss}(\\tilde{\\textbf{y}})')
('8', '\\textbf{X}')
('8', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})=\\sum_{i=1}^{n}(\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})^{\\top}\\textbf{g}')
('8', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})=\\sum_{i=1}^{n}\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{H}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\begin{aligned}\n                    \\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})\n                    &= \\sum_{i = 1}^n \\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}}) \\\\\n                    &= \\sum_{i = 1}^n \\left(\\textrm{Loss}(\\tilde{\\textbf{y}}) + (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})^{\\top} \\textbf{g} + \\frac{1}{2!} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}}) + R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})\\right)\\\\\n                    &= n \\textrm{Loss}(\\tilde{\\textbf{y}}) + \\sum_{i = 1}^n (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})^{\\top}\\textbf{g} + \\sum_{i = 1}^n\\frac{1}{2!} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}}) + \\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}). \\nonumber\n                \\end{aligned}')
('8', '\\begin{aligned}\n            &\\textrm{Loss}^{\\text{constant}} = n \\textrm{Loss}(\\tilde{\\textbf{y}}) \\\\\n            &\\textrm{Loss}^{\\text{grad}}(\\textbf{g}) = \\sum_{i = 1}^n (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})^{\\top} \\textbf{g} \\\\\n            &\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H}) = \\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})\n        \n\\end{aligned}')
('8', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})')
('8', '\\varepsilon=0')
('8', '\\varepsilon')
('8', '\\varepsilon')
('8', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})')
('8', 'i.e.')
('8', '\\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})= \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}),')
('8', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) = \\sum_{i=1}^{n}\\frac{1}{2!} (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{diag}}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\textrm{Loss}^{\\text{off}} (\\textbf{H}^{\\text{off}})= \\sum_{i=1}^{n}\\frac{1}{2!} (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{off}}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\textbf{H}^{\\text{diag}}')
('8', '\\textbf{H}^{\\text{off}} = \\textbf{H} - \\textbf{H}^{\\text{diag}}')
('8', '\\textbf{H}')
('8', '\\begin{aligned}\n                    \\textrm{Loss}^{\\text{Hessian}}(\\textbf{H})\n                    &= \\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})\\\\\n                    &= \\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\left(\\textbf{H}^{\\text{diag}} + \\textbf{H}^{\\text{off}}\\right)(\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})\\\\\n                    &= \\sum_{i = 1}^n\\frac{1}{2}\\left( (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{diag}}(\\textbf{y}^{(i)} - \\tilde{\\textbf{y}}) + (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{off}} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})\\right)\\\\\n                    &= \\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{diag}} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}}) + \\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{off}} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})\\\\\n                    &= \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})\n                \\end{aligned}')
('8', '\\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})')
('8', '\\textbf{x}_d=[\\textbf{X}_{d,1},\\textbf{X}_{d,2},\\ldots,\\textbf{X}_{d,n}]^{\\top}\\in\\mathbb{R}^n')
('8', 'd')
('8', 'n')
('8', '\\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})')
('8', '\\textbf{x}_d')
('8', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})= \\textbf{H}^{\\text{off}}_{d,:}(\\textbf{Y} -\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})  \\textbf{y}_d')
('8', '\\textbf{x}_d')
('8', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('8', '\\textbf{H}_{d,:}^{\\text{off}}=[\\textbf{H}_{d,1}^{\\text{off}},\\textbf{H}_{d,2}^{\\text{off}},\\ldots,\\textbf{H}_{d,D}^{\\text{off}}]\\in\\mathbb{R}^D')
('8', 'd')
('8', '\\textbf{H}^{\\text{off}}')
('8', '\\textbf{y}_d=[\\textbf{Y}_{d,1},\\textbf{Y}_{d,2},\\ldots,\\textbf{Y}_{d,n}]^{\\top}\\in\\mathbb{R}^n')
('8', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})')
('8', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})=L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})+L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}}),')
('8', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})=\\textbf{H}_{d,:}^{\\text{off}} \\textbf{Y}^{\\text{linear}}\\textbf{y}_d')
('8', 'L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})= \\textbf{H}_{d,:}^{\\text{off}} (\\textbf{Y}^{\\text{non}}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})\\textbf{y}_d')
('8', '\\textbf{Y}^{\\text{linear}}= [ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top} \\textbf{o}_d^{\\top}')
('8', '\\textbf{Y}^{\\text{non}}=\\textbf{Y}-\\textbf{Y}^{\\text{linear}}')
('8', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}')
('8', '\\textbf{y}_d')
('8', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})= \\lVert \\textbf{y}_d \\rVert  \\cdot  \\textbf{H}_{d,:}^{\\text{off}} [ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}')
('8', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} + \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('8', '\\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})')
('8', '\\textbf{x}_d')
('8', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})= \\textbf{H}^{\\text{off}}_{d,:}(\\textbf{Y} -\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})  \\textbf{y}_d')
('8', '\\textbf{x}_d')
('8', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('8', '\\begin{aligned}\n                \\qquad\\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) &= \\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{off}} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}}) \\nonumber\\\\\n                &= \\sum_{i = 1}^n \\left(\\frac{1}{2} \\sum_{j = 1}^D\\sum_{k=1}^D \\textbf{H}^{\\text{off}}_{j, k} (\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) (\\textbf{y}^{(i)}_k - \\tilde{\\textrm{y}}_k)\\right) \\nonumber\\\\\n                & = \\sum_{i = 1}^n \\frac{1}{2} \\left(\\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d)(\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) + \\sum_{k = 1}^D\\textbf{H}^{\\text{off}}_{k, d} (\\textbf{y}^{(i)}_k- \\tilde{\\textrm{y}}_k)(\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d) \\right) \\nonumber\\\\\n                & \\quad + \\sum_{i = 1}^n \\left(\\frac{1}{2} \\sum_{j = 1, j\\neq d}^D\\sum_{k=1, k\\neq d}^D \\textbf{H}^{\\text{off}}_{j, k} (\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) (\\textbf{y}^{(i)}_k - \\tilde{\\textrm{y}}_k)\\right) \\nonumber \\\\\n                & \\qquad \\slash \\slash {\\rm \\tiny Note \\ that \\ the \\ term\\ \\textbf{H}^{\\text{off}}_{d, d} (\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d) (\\textbf{y}^{(i)}_d - \\tilde{\\textrm{y}}_d) is computed twice for summation,} \\nonumber\\\\\n                & \\qquad {\\rm \\tiny \\ \\ \\ but\\ since \\ that \\ \\textbf{H}^{\\text{off}}_{d,d}=0 according to \\textit{Lemma}~\\ref{le:1}, this term is zero.} \\nonumber\\\\\n                &= \\sum_{i = 1}^n \\frac{1}{2} \\left(\\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d)(\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) + \\sum_{k = 1}^D\\textbf{H}^{\\text{off}}_{k, d} (\\textbf{y}^{(i)}_k- \\tilde{\\textrm{y}}_k)(\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d) \\right) + \\textrm{L}_d^{\\text{tmp-independent1}} \\nonumber \\\\\n                & \\qquad \\slash \\slash {\\rm \\tiny Let\\ \\textrm{L}_d^{\\text{tmp-independent1}} denote \\sum_{i = 1}^n \\left(\\frac{1}{2} \\sum_{j = 1, j\\neq d}^D\\sum_{k=1, k\\neq d}^D \\textbf{H}^{\\text{off}}_{j, k} (\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) (\\textbf{y}^{(i)}_k - \\tilde{\\textrm{y}}_k)\\right) for simplicity.} \\nonumber\\\\\n                &=\\sum_{i = 1}^n \\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d)(\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) + \\textrm{L}_d^{\\text{tmp-independent1}} \\quad  {\\rm  \\slash \\slash (\\textbf{H}^{\\text{off}}\\ is \\ symmetric.)}  \\nonumber \\\\\n                &= \\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j}\\left(\\sum_{i = 1}^n (\\textbf{y}^{(i)}_d- \\tilde{\\textrm{y}}_d)(\\textbf{y}^{(i)}_j- \\tilde{\\textrm{y}}_j) \\right) + \\textrm{L}_d^{\\text{tmp-independent1}} \\nonumber\\\\\n                &= \\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}_j-\\tilde{\\textrm{y}}_j \\textbf{1}_n)^{\\top} (\\textbf{y}_d-\\tilde{\\textrm{y}}_d \\textbf{1}_n) + \\textrm{L}_d^{\\text{tmp-independent1}} \\nonumber\\\\\n                &= \\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}_j-\\tilde{\\textrm{y}}_j \\textbf{1}_n)^{\\top} \\textbf{y}_d-\n                \\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}_j-\\tilde{\\textrm{y}}_j \\textbf{1}_n)^{\\top} \\tilde{\\textrm{y}}_d \\textbf{1}_n + \\textrm{L}_d^{\\text{tmp-independent1}} \\nonumber\\\\\n                &= \\textbf{H}^{\\text{off}}_{d, :}\\left(\\textbf{Y}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top}\\right)  \\textbf{y}_d\n                - \\tilde{\\textrm{y}}_d \\sum_{j = 1}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}_j^{\\top} \\textbf{1}_n-\\tilde{\\textrm{y}}_j \\textbf{1}_n^{\\top} \\textbf{1}_n)  + \\textrm{L}_d^{\\text{tmp-independent1}} \\nonumber\\\\\n                &= \\textbf{H}^{\\text{off}}_{d, :}\\left(\\textbf{Y}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top}\\right)  \\textbf{y}_d\n                - \\tilde{\\textrm{y}}_d \\sum_{j = 1, j \\neq d}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}_j^{\\top} \\textbf{1}_n-\\tilde{\\textrm{y}}_j \\textbf{1}_n^{\\top} \\textbf{1}_n)+ \\textrm{L}_d^{\\text{tmp-independent1}} \\qquad   \\slash \\slash \\textbf{H}^{\\text{off}}_{d,d}=0 \\nonumber \\\\\n                \\label{eq:ldderive}\n                &= \\textbf{H}^{\\text{off}}_{d, :}\\left(\\textbf{Y}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top}\\right)  \\textbf{y}_d\n                - \\textrm{L}_d^{\\text{tmp-independent2}} + \\textrm{L}_d^{\\text{tmp-independent1}} \\nonumber\\\\\n                & \\qquad \\slash \\slash {\\rm \\tiny Let\\ \\textrm{L}_d^{\\text{tmp-independent2}} denote \\tilde{\\textrm{y}}_d \\sum_{j = 1, j \\neq d}^D\\textbf{H}^{\\text{off}}_{d, j} (\\textbf{y}_j^{\\top} \\textbf{1}_n-\\tilde{\\textrm{y}}_j \\textbf{1}_n^{\\top} \\textbf{1}_n) for simplicity.} \\nonumber\\\\\n                &= \\textrm{L}_d(\\textbf{H}_{d,:}^{\\text{off}}) + \\textrm{L}_d^{\\text{independent}}. \\nonumber\\\\\n                & \\qquad \\slash \\slash {\\rm \\tiny Let\\ \\textrm{L}_d(\\textbf{H}_{d,:}^{\\text{off}}) denote \\textbf{H}^{\\text{off}}_{d, :}\\left(\\textbf{Y}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top}\\right), and let  \\textrm{L}_d^{\\text{independent}} denote (-\\textrm{L}_d^{\\text{tmp-independent2}} + \\textrm{L}_d^{\\text{tmp-independent1}})} \\nonumber\n            \n\\end{aligned}')
('8', '\\begin{aligned}\n                \\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}\n                &= \\frac{\\partial \\left(\\textrm{L}_d(\\textbf{H}_{d,:}^{\\text{off}}) + \\textrm{L}_d^{\\text{independent}}(\\textbf{H}_{d,:}^{\\text{off}}) \\right)}{\\partial \\textbf{x}_d}\n                = \\frac{\\partial \\textrm{L}_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} +\\frac{\\partial \\textrm{L}_d^{\\text{independent}}(\\textbf{H}_{d,:}^{\\text{off}}) }{\\partial \\textbf{x}_d}\\\\\n                &= \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} + \\textbf{0}\n                = \\frac{\\partial L_d(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}.\n            \n\\end{aligned}')
('8', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})')
('8', '\\begin{aligned}\n                    L_d(\\textbf{H}_{d,:}^{\\text{off}})\n                    &= \\textbf{H}^{\\text{off}}_{d, :}\\left(\\textbf{Y}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top}\\right)\\textbf{y}_d\\\\\n                    &= \\textbf{H}^{\\text{off}}_{d, :}\\left( \\textbf{Y}^{\\text{linear}} + \\textbf{Y}^{\\text{non}} -\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top} \\right)\\textbf{y}_d\n                    \\qquad \\slash \\slash \\textbf{Y} = \\textbf{Y}^{\\text{linear}}+\\textbf{Y}^{\\text{non}}\\\\\n                    &= \\textbf{H}^{\\text{off}}_{d, :}\\textbf{Y}^{\\text{linear}}\\textbf{y}_d\n                    + \\textbf{H}^{\\text{off}}_{d, :}\n                    \\left(\\textbf{Y}^{\\text{non}} -\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top} \\right)\\textbf{y}_d \\\\\n                    &= L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}}) + L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}}).\n                \\end{aligned}')
('8', '\\textbf{Y}^{\\text{linear}}= \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} \\textbf{o}_d^{\\top} \\in \\mathbb{R}^{D \\times n}')
('8', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}')
('8', '\\textbf{y}_d')
('8', '\\textbf{Y}^{\\text{non}} = \\left[\\textbf{y}_{1}- \\| \\textbf{y}_{1} \\| \\cos(\\textbf{y}_1, \\textbf{y}_d)\\textbf{o}_d , \\cdots,\\textbf{y}_{D} - \\|\\textbf{y}_{D} \\| \\cos(\\textbf{y}_D, \\textbf{y}_d) \\textbf{o}_d  \\right]^{\\top}')
('8', '\\begin{aligned}\n                L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})\n                &= \\textbf{H}_{d,:}^{\\text{off}} \\textbf{Y}^{\\text{linear}}\\textbf{y}_d\n                = \\textbf{H}_{d,:}^{\\text{off}} \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} \\textbf{o}_d^{\\top} \\textbf{y}_d\\\\\n                &= \\textbf{H}_{d,:}^{\\text{off}} \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} (\\frac{\\textbf{y}_d^{\\top}}{\\|\\textbf{y}_d\\|} \\textbf{y}_d)\\\\\n                &= \\textbf{H}_{d,:}^{\\text{off}} \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} (\\frac{\\|\\textbf{y}_d\\|^2}{\\|\\textbf{y}_d\\|}) \\\\\n                &=  \\lVert \\textbf{y}_d \\rVert  \\cdot  \\textbf{H}_{d,:}^{\\text{off}} \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top}\n            \\end{aligned}')
('8', 'd')
('8', 'L_d(\\textbf{H}_{d,:}^{\\text{off}})')
('8', '\\textbf{x}_d')
('8', '\\begin{aligned}\n                \\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}\n                &=\\frac{\\partial \\left(L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})+L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})\\right)}{\\partial \\textbf{x}_d}\\\\\n                &= \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} + \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d},\n            \\end{aligned}')
('8', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('8', '\\textbf{y}_d')
('8', '[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}')
('8', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}')
('8', '\\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('8', '\\textbf{y}_d')
('8', '\\textbf{y}_d')
('8', '\\forall j, \\textbf{y}_{j}- \\|\\textbf{y}_j\\| \\cos(\\textbf{y}_j, \\textbf{y}_d) \\textbf{o}_d')
('8', '\\textbf{Case 2}')
('8', '\\textbf{g}^{(i)}')
('8', '\\textbf{H}^{(i)}')
('8', '\\tilde{\\textbf{y}}')
('8', 'i')
('8', 'i')
('8', '1\\le i \\le n')
('8', '\\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}}) = \\textrm{Loss}(\\tilde{\\textbf{y}}) + \\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu) +\\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{off}}) + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}^{\\prime (i)}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\prime (i) \\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\prime (i) \\text{off}}) + R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('8', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{g}^{(i)}')
('8', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{H}^{(i)}')
('8', '\\textbf{g}^{\\prime (i)} = \\textbf{g}^{(i)} - \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu')
('8', '\\textbf{H}^{\\prime (i)} = \\textbf{H}^{(i)} - \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu')
('8', 'i')
('8', 'i')
('8', '1\\le i \\le n')
('8', '\\label{eq: gene taylor}\n                \\begin{aligned}\n                    \\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}})=\\textrm{Loss}(\\tilde{\\textbf{y}})+ (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{g}^{(i)} +\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\textbf{H}^{(i)}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})+ R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}).\n                \\end{aligned}')
('8', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{g}^{(i)}')
('8', '\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu = \\frac{1}{n}\\sum_{i=1}^{n}\\textbf{H}^{(i)}')
('8', '\\textbf{g}^{\\prime (i)} = \\textbf{g}^{(i)} - \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu')
('8', '\\textbf{H}^{\\prime (i)} = \\textbf{H}^{(i)} - \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu')
('8', "\\label{eq: gene decompose taylor}\n                \\begin{aligned}\n                    \\textrm{Loss}(\\textbf{y}^{(i)};\\tilde{\\textbf{y}})\n                    &=\\textrm{Loss}(\\tilde{\\textbf{y}})+ (\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\left( \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu + \\textbf{g}^{\\prime (i)} \\right) +\\frac{1}{2!}(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})^{\\top}\\left( \\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu + \\textbf{H}^{\\prime (i)} \\right)(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})+ R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})'\\\\\n                    &= \\left( \\textrm{Loss}(\\tilde{\\textbf{y}}) + \\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu) +\\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{off}}) \\right)\\\\\n                    & \\quad + \\left( \\textrm{Loss}^{\\text{grad}}(\\textbf{g}^{\\prime (i)}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\prime (i) \\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\prime (i) \\text{off}}) + R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}) \\right).\n                    %  &= \\textrm{Loss}^{\\text{share}} + \\textrm{Loss}^{\\text{distinct}}.\n                \\end{aligned}")
('9', 'd \\in \\{1, \\cdots, D\\}')
('9', '\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})')
('9', 'w.r.t.')
('9', 'd')
('9', 'n')
('9', 'i.e.')
('9', '\\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{x}_{d}}')
('9', '\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})')
('9', 'w.r.t.')
('9', 'd')
('9', 'n')
('9', 'i.e.')
('9', '\\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{y}_{d}}')
('9', '\\label{BN chain rule}\n        \\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{x}_{d}}\n        =\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H}) }{\\partial \\textbf{y}_{d}}\n        =\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H}) }{\\partial \\textbf{y}_{d}},')
('9', '\\textbf{J}_d = \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}')
('9', '\\textbf{y}_d')
('9', 'w.r.t.')
('9', '\\textbf{x}_d')
('9', '\\textbf{y}_d = \\frac{\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n}{\\boldsymbol{\\sigma}_d}')
('9', '\\begin{aligned}\n                \\textbf{J}_d\n                &= \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\\\\n                &= \\left( \\frac{\\partial \\boldsymbol{\\mu}_d}{\\partial \\textbf{x}_{d}}\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\boldsymbol{\\mu}_d}  + \\frac{\\partial \\boldsymbol{\\sigma}_d^2}{\\partial \\textbf{x}_d}\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\boldsymbol{\\sigma}_d^2}  + \\frac{\\partial \\textbf{x}_d^{\\top}}{\\partial \\textbf{x}_d} \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_d} \\right)  \\\\\n                &= \\left(\\frac{\\partial \\left(\\frac{1}{n} \\textbf{x}_d^{\\top}\\textbf{1}_n\\right)}{\\partial \\textbf{x}_d}\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\boldsymbol{\\mu}_d}  + \\frac{\\partial \\left(\\frac{1}{n}(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n)^{\\top} \\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\right)}{\\partial \\textbf{x}_d}\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\boldsymbol{\\sigma}_d^2}  + \\frac{\\partial \\textbf{x}_d^{\\top}}{\\partial \\textbf{x}_d} \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_d} \\right)  \\\\\n                &= \\left(\\frac{1}{n}\\textbf{1}_n\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\boldsymbol{\\mu}_d}  + \\frac{2}{n}\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\boldsymbol{\\sigma}_d^2}  + I \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_d}\\right)  \\\\\n                &= \\left(\\frac{1}{n}\\textbf{1}_n\\frac{\\partial \\left( \\frac{\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n}{\\boldsymbol{\\sigma}_d}\\right)^{\\top}}{\\partial \\boldsymbol{\\mu}_d}  + \\frac{2}{n}\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\frac{\\partial \\left( \\frac{\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n}{\\boldsymbol{\\sigma}_d}\\right)^{\\top}}{\\partial \\boldsymbol{\\sigma}_d^2} + \\frac{\\partial \\left( \\frac{\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n}{\\boldsymbol{\\sigma}_d}\\right)^{\\top}}{\\partial \\textbf{x}_d} \\right)  \\\\\n                &= \\left(-\\frac{1}{n}\\textbf{1}_n\\frac{1}{\\boldsymbol{\\sigma}_d}\\textbf{1}_n^{\\top}  + \\frac{2}{n} \\left(\\textbf{x}_{1} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\left(- \\frac{1}{2} {\\boldsymbol{\\sigma}_d}^{-3} \\right) + \\frac{1}{\\boldsymbol{\\sigma}_d}I \\right) \\\\\n                \\label{Jacobian}\n                &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right).\n            \\end{aligned}')
('9', '\\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})}{\\partial \\textbf{x}_d}')
('9', '\\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})}{\\partial \\textbf{y}_d}')
('9', '\\begin{aligned}\n            \\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})}{\\partial \\textbf{x}_d}\n            &= \\frac{\\partial }{\\partial \\textbf{x}_d} \\left(\\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) + \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) + \\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})\\right)\\\\\n            &= \\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{x}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}+ \\frac{\\partial (\\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}))}{\\partial \\textbf{x}_d}. \\\\\n            &= \\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{x}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_d} + \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} +\n            \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} \\\\\n            & \\qquad + \\frac{\\partial (\\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}))}{\\partial \\textbf{x}_d}. \\nonumber\n        \n\\end{aligned}')
('9', '\\begin{aligned}\n            \\frac{\\partial \\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})}{\\partial \\textbf{y}_d}\n            &= \\frac{\\partial }{\\partial \\textbf{y}_d} \\left(\\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) + \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) + \\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})\\right)\\\\\n            &= \\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{y}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{y}_d}+ \\frac{\\partial (\\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}))}{\\partial \\textbf{y}_d}. \\\\\n            &= \\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{y}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d} + \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d} + \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d} +\n            \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d} \\\\\n            & \\qquad + \\frac{\\partial (\\sum_{i = 1}^n R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}}))}{\\partial \\textbf{y}_d}. \\nonumber\n        \n\\end{aligned}')
('9', '\\begin{aligned}\n            \\label{eq:chain1}\n            \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_{d}} &=\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_{d}} =\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_{d}}. \\\\\n            \\label{eq:chain2}\n            \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_{d}} &=\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) }{\\partial \\textbf{y}_{d}}=\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) }{\\partial \\textbf{y}_{d}}. \\\\\n            \\label{eq:chain3}\n            \\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_{d}} &=\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) }{\\partial \\textbf{y}_{d}}=\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) }{\\partial \\textbf{y}_{d}}. \\\\\n            \\label{eq:chain4}\n            \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} &=\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}=\\textbf{J}_d \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}\\\\\n            \\label{eq:chain5}\n            \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}&=\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}=\\textbf{J}_d \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}.\n        \n\\end{aligned}')
('9', 'n')
('9', '\\textbf{x}^{(i)} \\in \\mathbb{R}^{D}')
('9', 'D')
('9', 'i')
('9', '\\textbf{y}^{(i)} \\in \\mathbb{R}^{D}')
('9', 'D')
('9', 'i')
('9', '\\textbf{x}_d\\in \\mathbb{R}^{n}')
('9', 'd')
('9', 'n')
('9', '\\textbf{y}_d\\in \\mathbb{R}^{n}')
('9', 'd')
('9', 'n')
('9', '\\textbf{J}_d\\in \\mathbb{R}^{n \\times n}')
('9', '\\textbf{y}_d')
('9', 'w.r.t.')
('9', '\\textbf{x}_d')
('9', 'i.e.')
('9', '\\textbf{J}_d=\\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}')
('9', '\\tilde{\\textbf{y}} \\in \\mathbb{R}^{D}')
('9', '\\textbf{o}_d \\in \\mathbb{R}^{D}')
('9', '\\textbf{y}_d')
('9', 'i.e.')
('9', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_{d}\\|}')
('9.0', '\\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})')
('9.0', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})')
('9.0', '\\textrm{Loss}^{\\text{constant}}')
('9.0', '\\textbf{X}')
('9.0', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{X}} = \\textbf{0}')
('9.0', '\\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{X}} = \\textbf{0}')
('9.0', '\\textrm{Loss}^{\\text{constant}}=n\\textrm{Loss}(\\tilde{\\textbf{y}})')
('9.0', '\\frac{\\partial \\textrm{Loss}^{\\text{constant}}}{\\partial \\textbf{x}_{d}} = \\textbf{0}')
('9.0', 'd = 1, \\cdots, D')
('9.0', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_{d}} =\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_{d}}')
('9.0', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}')
('9.0', '\\begin{aligned}\n                    \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}\n                    &=\\frac{\\partial \\left(\\sum_{i = 1}^n (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})^{\\top} \\textbf{g}\\right) }{\\partial \\textbf{y}_d}= \\frac{\\partial \\left(\\textbf{1}_n^{\\top}\\left(\\textbf{Y}^{\\top} - \\textbf{1}_n\\tilde{\\textbf{y}}^{\\top}\\right) \\textbf{g}\\right)}{\\partial \\textbf{y}_d}\\\\\n                    &= \\frac{\\partial \\left(\\textbf{1}_n^{\\top}\\sum_{j = 1}^D \\textbf{g}_j (\\textbf{y}_j - \\tilde{\\textrm{y}}_j \\textbf{1}_n )\\right) }{\\partial \\textbf{y}_d}= \\frac{\\partial \\left(\\textbf{g}_d \\textbf{1}_n^{\\top}(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n)\\right) }{\\partial \\textbf{y}_d}= \\textbf{g}_d \\textbf{1}_n \\in \\mathbb{R}^{n}, %\\nonumber\n                \\end{aligned}')
('9.0', '\\textbf{g}_d \\in \\mathbb{R}')
('9.0', 'd')
('9.0', '\\textbf{g} \\in \\mathbb{R}^{D}')
('9.0', '\\begin{aligned}\n                \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_d}\n                &= \\textbf{J}_d \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}\\\\\n                &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right)\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}\\\\\n                &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right) \\left(\\textbf{g}_d \\textbf{1}_n\\right)\\\\\n                &= \\frac{\\textbf{g}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{1}_n-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top}\\textbf{1}_n - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top}\\textbf{1}_n \\right)\\\\\n                &= \\frac{\\textbf{g}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{1}_n-\\textbf{1}_n - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d}^{\\top}\\textbf{1}_n - \\boldsymbol{\\mu}_d\\textbf{1}_n^{\\top}\\textbf{1}_n\\right) \\right)\\\\\n                &= \\frac{\\textbf{g}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{0} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{1} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(n\\boldsymbol{\\mu}_d - n\\boldsymbol{\\mu}_d\\right) \\right)\\\\\n                &= \\textbf{0} \\in \\mathbb{R}^{n} %\\nonumber\n            \n\\end{aligned}')
('9.1', '\\tilde{\\textbf{y}}')
('9.1', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('9.1', '\\textbf{X}')
('9.1', '\\frac{\\partial\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) }{\\partial \\textbf{X}} = 0')
('9.1', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{X}} = \\left[\n        \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_1},\n        \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_2},\n        \\ldots;\n        \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_D}\n        \\right]^{\\top}')
('9.1', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_{d}} = \\textbf{0}')
('9.1', '{\\forall} d \\in \\{1, \\cdots, D\\}')
('9.1', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_{d}} =\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) }{\\partial \\textbf{y}_{d}}')
('9.1', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d}')
('9.1', '\\begin{aligned}\n                \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d}\n                &= \\frac{\\partial\\left(\\sum_{i = 1}^n\\frac{1}{2} (\\textbf{y}^{(i)} -\\tilde{\\textbf{y}})^{\\top} \\textbf{H}^{\\text{diag}} (\\textbf{y}^{(i)} - \\tilde{\\textbf{y}})\\right)}{\\partial \\textbf{y}_d}\\\\\n                &= \\frac{1}{2}\\frac{\\partial\\left(\\sum_{i = 1}^n \\sum_{j = 1}^{D} \\textbf{H}_{j, j}^{\\text{diag}} (\\textbf{y}^{(i)}_j - \\tilde{\\textrm{y}}_j)^2\\right)}{\\partial \\textbf{y}_d}\n                \\qquad \\slash \\slash \\tilde{\\textbf{y}}_j \\in \\mathbb{R}\\ \\textrm{is the }j\\textrm{-th element of point}\\ \\tilde{\\textbf{y}} \\in \\mathbb{R}^{D}\\\\\n                &= \\frac{1}{2}\\frac{\\partial\\left(\\sum_{j = 1}^{D} \\textbf{H}_{j, j}^{\\text{diag}}\\sum_{i = 1}^n ((\\textbf{y}^{(i)}_j - \\tilde{\\textrm{y}}_j)^2\\right)}{\\partial \\textbf{y}_d}\\\\\n                &= \\frac{1}{2}\\frac{\\partial\\left(\\sum_{j = 1}^{D} \\textbf{H}_{j, j}^{\\text{diag}} \\left(\\textbf{y}_j - \\tilde{\\textrm{y}}_j \\textbf{1}_n\\right)^{\\top}\\left(\\textbf{y}_j - \\tilde{\\textrm{y}}_j \\textbf{1}_n\\right) \\right)}{\\partial \\textbf{y}_d}\\\\\n                &= \\frac{1}{2}\\frac{\\partial\\left(\\textbf{H}_{d, d}^{\\text{diag}} \\left(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n\\right)^{\\top}\\left(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n\\right) \\right)}{\\partial \\textbf{y}_d}\n                \\qquad \\slash \\slash \\tilde{\\textbf{y}}_d \\in \\mathbb{R}\\ \\textrm{is the }d\\textrm{-th element of point}\\ \\tilde{\\textbf{y}} \\in \\mathbb{R}^{D}\\\\\n                &= \\textbf{H}_{d, d}^{\\text{diag}} \\left(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n\\right),  \\nonumber\n            \n\\end{aligned}')
('9.1', '\\begin{aligned}\n                \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_d}\n                &=\\textbf{J}_d\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) }{\\partial \\textbf{y}_{d}}\n                \\qquad \\slash \\slash {\\rm \\ Equation~(\\ref{eq:chain2})}\\\\\n                &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right)\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d}\\\\\n                &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right)\\textbf{H}_{d, d}^{\\text{diag}} \\left(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n\\right)\\\\\n                &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right)\\textbf{H}_{d, d}^{\\text{diag}} \\frac{\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n}{\\boldsymbol{\\sigma}_d}\\\\\n                & \\quad - \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right)\\textbf{H}_{d, d}^{\\text{diag}} \\tilde{\\textrm{y}}_d \\textbf{1}_n\\\\\n                &= \\frac{\\textbf{H}_{d, d}^{\\text{diag}}}{\\boldsymbol{\\sigma}_d^2}\\left(\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top}\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right) - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top}\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\right)\\\\\n                & \\quad - \\frac{\\textbf{H}_{d, d}^{\\text{diag}} \\tilde{\\textrm{y}}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{1}_n-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top}\\textbf{1}_n - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top}\\textbf{1}_n \\right) \\\\\n                &= \\frac{\\textbf{H}_{d, d}^{\\text{diag}}}{\\boldsymbol{\\sigma}_d^2}\\left(\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)-\\frac{1}{n}\\textbf{1}_n\\left(\\textbf{1}_n^{\\top}\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n^{\\top}\\textbf{1}_n\\right) - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)n \\boldsymbol{\\sigma}_d^2\\right)\\\\\n                & \\quad - \\frac{\\textbf{H}_{d, d}^{\\text{diag}} \\tilde{\\textrm{y}}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{0} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d}^{\\top}\\textbf{1}_n - \\boldsymbol{\\mu}_d\\textbf{1}_n^{\\top}\\textbf{1}_n\\right) \\right) \\\\\n                &= \\frac{\\textbf{H}_{d, d}^{\\text{diag}}}{\\boldsymbol{\\sigma}_d^2}\\left(\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)-\\frac{1}{n}\\textbf{1}_n\\left(n\\boldsymbol{\\mu}_d - n\\boldsymbol{\\mu}_d\\right) - \\frac{n\\boldsymbol{\\sigma}_d^2}{n\\boldsymbol{\\sigma}_d^2 }\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\right)\\\\\n                & \\quad - \\frac{\\textbf{H}_{d, d}^{\\text{diag}} \\tilde{\\textrm{y}}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{0} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(n\\boldsymbol{\\mu}_d - n\\boldsymbol{\\mu}_d\\right) \\right) \\\\\n                &= \\frac{\\textbf{H}_{d, d}^{\\text{diag}}}{\\boldsymbol{\\sigma}_d^2}\\left(\\left(\\textbf{x}_d - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)-\\textbf{0} - \\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\right)\n                - \\frac{\\textbf{H}_{d, d}^{\\text{diag}} \\tilde{\\textrm{y}}_d}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{0} - \\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\textbf{0} \\right) \\\\\n                &= \\textbf{0} \\nonumber\n            \n\\end{aligned}')
('9.2', '\\tilde{\\textbf{y}}')
('9.2', '\\forall d')
('9.2', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('9.2', 'd')
('9.2', 'n')
('9.2', '\\textbf{x}_d\\in\\mathbb{R}^n')
('9.2', '\\forall d,\\ \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\textbf{0},')
('9.2', '\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} = \\frac{\\partial ^2 }{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} (A  [ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}   ) = \\textbf{0}')
('9.2', 'A=\\lVert \\textbf{y}_d \\rVert  \\cdot  \\textbf{H}_{d,:}^{\\text{off}}')
('9.2', '\\frac{\\partial^2 L_d ^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d} \\partial \\textbf{H}_{d, :}^{\\text{off}}} =  \\frac{1}{\\boldsymbol{\\sigma}_d} \\cdot [(\\textbf{y}_{1}- \\| \\textbf{y}_{1} \\| \\cos(\\textbf{y}_1, \\textbf{y}_d)\\textbf{o}_d ), \\ldots,(\\textbf{y}_{D} - \\|\\textbf{y}_{D} \\| \\cos(\\textbf{y}_D, \\textbf{y}_d) \\textbf{o}_d  )]  \\ne \\textbf{0}')
('9.2', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})=\\textbf{H}_{d,:}^{\\text{off}} \\textbf{Y}^{\\text{linear}}\\textbf{y}_d')
('9.2', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\textbf{0}')
('9.2', '\\begin{aligned}\n\\label{eq:LDlinear}\n                \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d}}\n                &= \\textbf{J}_d \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_{d}} \\quad \\qquad {\\rm \\slash \\slash Equation~(\\ref{eq:chain4})}\\\\\n                &= \\textbf{J}_d \\frac{\\partial\\left( \\textbf{H}^{\\text{off}}_{d, :}\\textbf{Y}^{\\text{linear}}\\textbf{y}_d\\right)}{\\partial \\textbf{y}_d}  \\\\\n                &= \\textbf{J}_d \\left(\\textbf{H}^{\\text{off}}_{d, :}\\textbf{Y}^{\\text{linear}}\\right)^{\\top}\\\\\n                &= \\textbf{J}_d \\left(\\textbf{H}^{\\text{off}}_{d, :} \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} \\textbf{o}_d^{\\top}\\right)^{\\top} \\\\\n                &=  \\textbf{J}_d \\textbf{o}_d \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right] \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\\\\\n                &=\\textbf{J}_d \\textbf{o}_d \\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                \\qquad \\slash \\slash  {\\rm \\small Let \\ \\boldsymbol\\lambda_d \\in \\mathbb{R}^{D} denote \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} for simplicity.}\\\\\n                &= \\textbf{J}_d \\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|} \\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                \\qquad \\slash \\slash  {\\rm \\small  \\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}}\\\\\n                &=  \\textbf{J}_d \\left(\\frac{\\textbf{x}_d - \\mu_d \\textbf{1}_n}{\\sigma_d \\|\\textbf{y}_d\\|}\\right) \\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                \\\\\n                &= \\frac{1}{\\sigma_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n\\sigma_d^2}\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)^{\\top} \\right)\\left(\\frac{\\textbf{x}_d - \\mu_d \\textbf{1}_n}{\\sigma_d \\|\\textbf{y}_d\\|}\\right) \\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                \\qquad {\\rm \\slash \\slash Equation~(\\ref{Jacobian})}\\\\\n                &= \\frac{\\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}}{\\sigma_d^2 \\|\\textbf{y}_d\\|}\\left(\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top}\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right) - \\frac{\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)^{\\top}\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)}{n\\sigma_d^2} \\right)  \\\\\n                &= \\frac{\\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}}{\\sigma_d^2 \\|\\textbf{y}_d\\|}\\left(\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)-\\frac{1}{n}\\textbf{1}_n\\left(\\textbf{1}_n^{\\top}\\textbf{x}_{d} - \\mu_d\\textbf{1}_n^{\\top}\\textbf{1}_n\\right) - \\frac{1}{n\\sigma_d^2}\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)n\\sigma_d^2 \\right)  \\\\\n                &= \\frac{\\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}}{\\sigma_d^2 \\|\\textbf{y}_d\\|}\\left(\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)-\\frac{1}{n}\\textbf{1}_n\\left(n\\mu_{d} - n\\mu_d\\right) - \\frac{n\\sigma_d^2}{n\\sigma_d^2}\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right) \\right)  \\\\\n                &= \\frac{\\boldsymbol\\lambda_{d}^{\\top} \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}}{\\sigma_d^2 \\|\\textbf{y}_d\\| }\\left(\\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right)-\\textbf{0} - \\left(\\textbf{x}_{d} - \\mu_d\\textbf{1}_n\\right) \\right)  \\\\\n                & = \\textbf{0} \\nonumber\n            \n\\end{aligned}')
('9.2', 'L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})')
('9.2', '\\frac{\\partial L_d ^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d}}')
('9.2', '\\begin{aligned}\n                    \\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d}}\n                    &= \\textbf{J}_d \\frac{\\partial\\left( \\textbf{H}^{\\text{off}}_{d, :}(\\textbf{Y}^{\\text{non}}-\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})\\textbf{y}_d\\right)}{\\partial \\textbf{y}_d}  \\quad {\\rm \\slash \\slash Equation~(\\ref{eq:chain5})}\\\\\n                    &= \\textbf{J}_d \\left(\\textbf{H}^{\\text{off}}_{d, :}\\textbf{Y}^{\\text{non}}\\right)^{\\top}\n                    - \\textbf{J}_d \\left(\\textbf{H}^{\\text{off}}_{d, :}(\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})\\right)^{\\top}\n                    \\\\\n                    &= \\textbf{J}_d (\\textbf{Y}^{\\text{non}})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    - \\textbf{J}_d (\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    \\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} -\\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top}\\right)(\\textbf{Y}^{\\text{non}})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} \\\\\n                    &\\quad - \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} -\\frac{1}{n\\boldsymbol{\\sigma}_d^2}\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top}\\right)(\\tilde{\\textbf{y}} \\textbf{1}_n ^{\\top})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n}\\textbf{y}_{d} \\textbf{y}_{d}^{\\top} \\right)(\\textbf{Y}^{\\text{non}})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} - \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n}\\textbf{y}_{d} \\textbf{y}_{d}^{\\top} \\right)\n                    (\\textbf{1}_n \\tilde{\\textbf{y}}^{\\top})\n                    \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n}\\textbf{y}_{d} \\textbf{y}_{d}^{\\top} \\right)(\\textbf{Y}^{\\text{non}})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} - \\frac{1}{\\boldsymbol{\\sigma}_d}\\left((\\textbf{1}_n-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top}\\textbf{1}_n) - \\frac{1}{n}\\textbf{y}_{d} (\\textbf{y}_{d}^{\\top}\\textbf{1}_n) \\right)\n                    \\tilde{\\textbf{y}}^{\\top}\n                    \\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n}\\textbf{y}_{d} \\textbf{y}_{d}^{\\top} \\right)(\\textbf{Y}^{\\text{non}})^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} - \\textbf{0}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left((\\textbf{Y}^{\\text{non}})^{\\top}-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top}(\\textbf{Y}^{\\text{non}})^{\\top} - \\frac{1}{n}\\textbf{y}_{d} \\textbf{y}_{d}^{\\top} (\\textbf{Y}^{\\text{non}})^{\\top}\\right)\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} \\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    - \\frac{1}{\\boldsymbol{n \\sigma}_d}\\textbf{1}_n\\textbf{1}_n^{\\top}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    - \\frac{1}{\\boldsymbol{n \\sigma}_d}\\textbf{y}_{d} \\textbf{y}_{d}^{\\top} \\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    - \\frac{1}{\\boldsymbol{n \\sigma}_d}\\textbf{1}_n \\left[ \\textbf{1}_n^{\\top}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\right]\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    - \\frac{1}{\\boldsymbol{n \\sigma}_d}\\textbf{y}_{d} \\left[ \\textbf{y}_{d}^{\\top} \\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top} \\right]\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} - \\textbf{0} - \\textbf{0} \\quad {\\rm \\small \\slash \\slash \\textbf{1}_n^{\\top}(\\textbf{Y}^{\\text{non}})^{\\top} = \\textbf{0} \\ and\\ \\textbf{y}_{d}^{\\top} (\\textbf{Y}^{\\text{non}})^{\\top} = \\textbf{0}  \\ are\\ proved \\ later .}\\\\\n                    &= \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top}\n                    \\\\ \\nonumber\n                \\end{aligned}')
('9.2', '\\textbf{1}_n^{\\top}(\\textbf{Y}^{\\text{non}})^{\\top} = \\textbf{0}')
('9.2', '\\textbf{y}_{d}^{\\top} (\\textbf{Y}^{\\text{non}})^{\\top} = \\textbf{0}')
('9.2', '\\textbf{Y}^{\\text{linear}}= \\left[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D \\right]^{\\top} \\textbf{o}_d^{\\top} = \\boldsymbol\\lambda_d \\textbf{o}_d^{\\top}')
('9.2', '\\textbf{o}_d^{\\top} \\textbf{y}_j \\in \\mathbb{R}')
('9.2', 'j=1, \\cdots, D')
('9.2', '\\begin{aligned}\n                    \\textbf{1}_n^{\\top}(\\textbf{Y}^{\\text{non}})^{\\top}\n                    &= \\textbf{1}_n^{\\top}(\\textbf{Y} - \\textbf{Y}^{\\text{linear}})^{\\top}\n                    =  \\textbf{1}_n^{\\top}\\textbf{Y}^{\\top} - \\textbf{1}_n^{\\top}  \\textbf{o}_d \\boldsymbol\\lambda_d^{\\top} \\\\\n                    &= \\textbf{1}_n^{\\top}\\textbf{Y}^{\\top} - \\textbf{1}_n^{\\top} \\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}\\boldsymbol\\lambda_d^{\\top} = \\textbf{0} - 0 \\cdot \\frac{\\boldsymbol\\lambda_d^{\\top}}{\\|\\textbf{y}_d\\|} \\\\\n                    &= \\textbf{0} \\in \\mathbb{R}^{1 \\times D}. \\nonumber\n                \\end{aligned}')
('9.2', '\\begin{aligned}\n                \\textbf{y}_{d}^{\\top} (\\textbf{Y}^{\\text{non}})^{\\top}\n                &=\\textbf{y}_{d}^{\\top} \\left( \\textbf{Y} - \\textbf{Y}^{\\text{linear}}\\right)^{\\top}\\\\\n                &=\\textbf{y}_{d}^{\\top} \\left(\\textbf{y}_1 - (\\textbf{o}_d^{\\top} \\textbf{y}_1) \\textbf{o}_d, \\cdots,  \\textbf{y}_D - (\\textbf{o}_d^{\\top} \\textbf{y}_D) \\textbf{o}_d\\right)\\\\\n                &=\\textbf{y}_{d}^{\\top} \\left( \\textbf{y}_1 -\\frac{\\textbf{y}_d^{\\top}\\textbf{y}_1}{\\|\\textbf{y}_d\\|} \\cdot \\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}, \\cdots,  \\textbf{y}_D -\\frac{\\textbf{y}_d^{\\top}\\textbf{y}_D}{\\|\\textbf{y}_d\\|} \\cdot \\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|} \\right)\\\\\n                &= \\left(\\textbf{y}_{d}^{\\top} \\left(\\textbf{y}_1 -\\frac{\\textbf{y}_d^{\\top}\\textbf{y}_1}{\\|\\textbf{y}_d\\|} \\cdot \\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|} \\right) , \\cdots,  \\textbf{y}_{d}^{\\top} \\left(\\textbf{y}_D -\\frac{\\textbf{y}_d^{\\top}\\textbf{y}_D}{\\|\\textbf{y}_d\\|} \\cdot \\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|} \\right)  \\right) \\\\\n                &= \\left( \\textbf{y}_d^{\\top}\\textbf{y}_1 - \\frac{\\textbf{y}_d^{\\top}\\textbf{y}_1}{\\|\\textbf{y}_d\\|^2} \\textbf{y}_d^{\\top}\\textbf{y}_d, \\cdots, \\textbf{y}_d^{\\top}\\textbf{y}_D - \\frac{\\textbf{y}_d^{\\top}\\textbf{y}_D}{\\|\\textbf{y}_d\\|^2} \\textbf{y}_d^{\\top}\\textbf{y}_d \\right) \\\\\n                &= \\left( \\textbf{y}_1^{\\top}\\textbf{y}_d - \\textbf{y}_1^{\\top}\\textbf{y}_d, \\cdots, \\textbf{y}_D^{\\top}\\textbf{y}_d - \\textbf{y}_D^{\\top}\\textbf{y}_d \\right) \\\\\n                &= \\left(0, \\cdots, 0 \\right) \\\\\n                &= \\textbf{0} \\in \\mathbb{R}^{1 \\times D} \\nonumber\n            \n\\end{aligned}')
('9.2', '\\begin{aligned}\n                    \\frac{\\partial^2 L_d ^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d} \\partial \\textbf{H}_{d, :}^{\\text{off}}}\n                    &=\\frac{\\partial}{ \\partial \\textbf{H}_{d, :}^{\\text{off}}}\n                    \\left(\\frac{\\partial L_d ^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d}}\\right)\n                    = \\frac{\\partial}{ \\partial \\textbf{H}_{d, :}^{\\text{off}}}\n                    \\left(\\frac{1}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\left(\\textbf{H}^{\\text{off}}_{d, :}\\right)^{\\top} \\right)^{\\top}\n                    =\\frac{1}{\\boldsymbol{\\sigma}_d}\\left(\\textbf{Y}^{\\text{non}}\\right)^{\\top}\\\\\n                    &=  \\frac{1}{\\boldsymbol{\\sigma}_d} \\cdot \\left[\\textbf{y}_{1}- \\| \\textbf{y}_{1} \\| \\cos(\\textbf{y}_1, \\textbf{y}_d)\\textbf{o}_d , \\cdots,\\textbf{y}_{D} - \\|\\textbf{y}_{D} \\| \\cos(\\textbf{y}_D, \\textbf{y}_d) \\textbf{o}_d  \\right].\n                \\end{aligned}')
('9.2', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('9.2', '\\textbf{y}_d')
('9.2', '[ \\textbf{o}_d^{\\top} \\textbf{y}_1,  \\textbf{o}_d^{\\top} \\textbf{y}_2, \\cdots,  \\textbf{o}_d^{\\top} \\textbf{y}_D ]^{\\top}')
('9.2', '\\textbf{o}_d=\\frac{\\textbf{y}_d}{\\|\\textbf{y}_d\\|}')
('9.2', '\\frac{\\partial L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('9.2', '\\textbf{y}_d')
('9.2', '\\textbf{y}_d')
('9.2', '\\forall j, \\textbf{y}_{j}- \\|\\textbf{y}_j\\| \\cos(\\textbf{y}_j, \\textbf{y}_d) \\textbf{o}_d')
('9.2', '\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d} = \\textbf{0}')
('9.2', 'd')
('9.2', '\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}')
('9.3', '\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}}=\\textbf{0},\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}=\\textbf{0}')
('9.3', '\\forall d,\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}=\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}+\\frac{\\partial ^2 L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}')
('9.3', '\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} = \\textbf{0}')
('9.3', '\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}}\\ne\\textbf{0},\\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\\ne\\textbf{0}')
('9.3', '\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}} \\ne \\textbf{0}')
('9.3', '\\textrm{Loss}^{\\text{batch}}(\\textbf{g}, \\textbf{H})')
('9.3', '\\label{eq:Taylor_complex}\n                \\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H}) =\n                \\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) + \\sum\\nolimits_i R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}}\n                    &= \\frac{\\partial ^2}{\\partial \\textbf{X} \\partial \\textbf{g}}\\left(\\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) + \\sum\\nolimits_i R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})\\right)\\\\\n                    &= \\frac{\\partial ^2}{\\partial \\textbf{X} \\partial \\textbf{g}}\\left( \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) \\right)\n                    = \\frac{\\partial}{\\partial \\textbf{g}}\\left(\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{X}}  \\right)\n                    \\xlongequal{\\textbf{Thm 1}} \\frac{\\partial}{\\partial \\textbf{g}}\\left(\\textbf{0}  \\right) = \\textbf{0} ;\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\n                    &= \\frac{\\partial ^2}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\\left(\\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) + \\sum\\nolimits_i R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})\\right)\\\\\n                    &= \\frac{\\partial ^2}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\\left( \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) \\right)\n                    = \\frac{\\partial}{\\partial \\textbf{H}^{\\text{diag}}}\\left(\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{X}}  \\right)\n                    \\xlongequal{\\textbf{Thm 2}} \\frac{\\partial}{\\partial \\textbf{H}^{\\text{diag}}}\\left(\\textbf{0}  \\right) = \\textbf{0} ;\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{x}_d \\partial  \\textbf{H}_{d,:}^{\\text{off}}}\n                    &= \\frac{\\partial ^2}{\\partial \\textbf{x}_d \\partial  \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\textrm{Loss}^{\\text{constant}} + \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) +\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) + \\sum\\nolimits_i R_2(\\textbf{y}^{(i)}-\\tilde{\\textbf{y}})\\right)\\\\\n                    &= \\frac{\\partial ^2}{\\partial \\textbf{x}_d \\partial  \\textbf{H}_{d,:}^{\\text{off}}}\\left( \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}}) \\right)\n                    = \\frac{\\partial}{\\partial \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\frac{\\partial \\textrm{Loss}^{\\text{off}}(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}  \\right)\n                    \\xlongequal{\\textbf{Lemma 2}} \\frac{\\partial}{\\partial \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\frac{\\partial L_d(\\textbf{H}^{\\text{off}})}{\\partial \\textbf{x}_d}  \\right)\\\\\n                    &\\xlongequal{\\textbf{Lemma 2}} \\frac{\\partial}{\\partial \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\frac{\\partial \\left(L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})+L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})\\right)}{\\partial \\textbf{x}_d}  \\right)\n                    =\\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}+\\frac{\\partial ^2 L_d^{\\text{non}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}},\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}\n                    &= \\frac{\\partial}{\\partial \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}  \\right)\n                    \\xlongequal{\\textbf{Thm 3}} \\frac{\\partial}{\\partial  \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\textbf{0}  \\right) = \\textbf{0}.\n                \\end{aligned}')
('9.3', '\\textbf{J}_d = \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}')
('9.3', 'i.e.')
('9.3', '\\textbf{J}_d = I \\in \\mathbb{R}^{n \\times n}')
('9.3', 'w.r.t.')
('9.3', '\\textbf{x}_d')
('9.3', 'w.r.t.')
('9.3', '\\textbf{y}_d')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_d}\n                    &= \\textbf{J}_d \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}\n                    =I \\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}\n                    = I \\left(\\textbf{g}_d \\textbf{1}_n\\right) = \\textbf{g}_d \\textbf{1}_n,\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_d}\n                    &= \\textbf{J}_d \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d}\n                    =I \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d}\n                    = \\textbf{H}_{d, d}^{\\text{diag}} \\left(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n\\right)   ,\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial  L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}\n                    &= \\textbf{J}_d \\frac{\\partial  L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}\n                    =I \\frac{\\partial L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{y}_d}\n                    = \\left(\\textbf{H}^{\\text{off}}_{d, :}\\textbf{Y}^{\\text{linear}}\\right)^{\\top}.\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{g}}\n                    &=  \\frac{\\partial ^2}{\\partial \\textbf{X} \\partial \\textbf{g}}\\left( \\textrm{Loss}^{\\text{grad}}(\\textbf{g}) \\right)\n                    = \\frac{\\partial}{\\partial \\textbf{g}}\\left(\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{X}}  \\right)\\\\\n                    &= \\frac{\\partial}{\\partial \\textbf{g}}\\left( \\left[\n                    \\left(\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_1} \\right)^{\\top};\n                    \\left(\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_2} \\right)^{\\top};\n                    \\ldots;\n                    \\left(\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_D}  \\right)^{\\top}\n                    \\right] \\right) \\\\\n                    &= \\frac{\\partial}{\\partial \\textbf{g}}\\left( \\left[\n                    \\textbf{g}_1 \\textbf{1}_{n}^{\\top};\n                    \\textbf{g}_2 \\textbf{1}_{n}^{\\top};\n                    \\ldots;\n                    \\textbf{g}_D \\textbf{1}_{n}^{\\top}\n                    \\right] \\right)\n                    =  \\frac{\\partial}{\\partial \\textbf{g}}\\left( \\textbf{g}  \\textbf{1}_{n}^{\\top}  \\right) \\neq  \\textbf{0} \\in \\mathbb{R}^{D^2 \\times n},\\\\\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2\\textrm{Loss}^{\\text{batch}}(\\textbf{g},\\textbf{H})}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\n                    &=  \\frac{\\partial ^2}{\\partial \\textbf{X} \\partial \\textbf{H}^{\\text{diag}}}\\left( \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}}) \\right)\n                    = \\frac{\\partial}{\\partial \\textbf{H}^{\\text{diag}}}\\left(\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{X}}  \\right)\\\\\n                    &= \\frac{\\partial}{\\partial \\textbf{H}^{\\text{diag}}}\\left( \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{X}} = \\left[\n                    \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_1},\n                    \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_2},\n                    \\ldots;\n                    \\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_D}\n                    \\right]^{\\top} \\right) \\\\\n                    &= \\frac{\\partial}{\\partial \\textbf{H}^{\\text{diag}}}\\left( \\left[\n                    \\textbf{H}_{1, 1}^{\\text{diag}} \\left(\\textbf{y}_1^{\\top} - \\tilde{\\textrm{y}}_1 \\textbf{1}_n^{\\top}\\right);\n                    \\textbf{H}_{2, 2}^{\\text{diag}} \\left(\\textbf{y}_2^{\\top} - \\tilde{\\textrm{y}}_2 \\textbf{1}_n^{\\top}\\right);\n                    \\ldots;\n                    \\textbf{H}_{D, 1}^{\\text{diag}} \\left(\\textbf{y}_D^{\\top} - \\tilde{\\textrm{y}}_D \\textbf{1}_n^{\\top}\\right)\n                    \\right] \\right)\\\\\n                    &=  \\frac{\\partial}{\\partial \\textbf{H}^{\\text{diag}}}\\left(  \\textbf{H}^{\\text{diag}} \\left(\\textbf{Y} - \\tilde{\\textbf{y}}  \\textbf{1}_{n}^{\\top} \\right) \\right)\n                    \\neq  \\textbf{0} \\in \\mathbb{R}^{D^2 \\times D\\cdot n},\\\\\n                \\end{aligned}')
('9.3', '\\begin{aligned}\n                    \\frac{\\partial ^2 L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}}) }{\\partial \\textbf{x}_d \\partial \\textbf{H}_{d,:}^{\\text{off}}}\n                    &= \\frac{\\partial}{\\partial \\textbf{H}_{d,:}^{\\text{off}}}\\left(\\frac{\\partial  L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_d}  \\right)\n                    = \\frac{\\partial}{\\partial \\textbf{H}_{d,:}^{\\text{off}}}\\left( \\left(\\textbf{H}^{\\text{off}}_{d, :}\\textbf{Y}^{\\text{linear}}\\right)^{\\top} \\right)\n                    \\neq  \\textbf{0} \\in \\mathbb{R}^{n \\times D}.\\\\\n                \\end{aligned}')
('10', '\\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu)')
('10', '\\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}})')
('10', '\\textrm{Loss}^{\\text{off}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{off}})')
('10', 'i.e.')
('10', '\\textrm{Loss}^{\\text{share}} =\\textrm{Loss}(\\tilde{\\textbf{y}}) + \\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu) +\\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}}) + \\textrm{Loss}^{\\text{off}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{off}})')
('10', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{g}}\\mkern-1.8mu}\\mkern 1.8mu)}{\\partial \\textbf{x}_d} = \\textbf{0}')
('10', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu^{\\text{diag}})}{\\partial \\textbf{x}_{d}} = \\textbf{0}')
('10', '\\frac{\\partial L_d^{\\rm linear}(\\mkern 1.8mu\\overline{\\mkern-1.8mu{\\textbf{H}}\\mkern-1.8mu}\\mkern 1.8mu_{d,:}^{\\text{off}})}{\\partial \\textbf{x}_{d}}= \\textbf{0}')
('11', 'L= -\\log \\textrm{Sigmoid}(z) = - \\log \\frac{e^z}{1+e^z} = -z + \\log (1+e^z)')
('11', 'z \\in \\mathbb{R}')
('11', 'L^{(m)}(z) = \\frac{d^m L}{dz}(z)')
('11', 'm')
('11', 'L')
('11', 'w.r.t.')
('11', 'z')
('11', 'L^{(m)}(z)')
('11', '\\frac{{(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m}')
('11', 'L^{(m)}(z)')
('11', 'L^{(m)}(z) = \\frac{\\sum_{k=1}^{m-2} a_{k}^{(m)} e^{k\\cdot z} + {(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m}')
('11', 'a_{k}^{(m)}')
('11', 'e^{k\\cdot z}')
('11', 'L^{(m)}(z)')
('11', 'm = 1')
('11', '\\begin{aligned}\n            &L^{\\prime}(z) =  \\frac{-1}{1+e^z} = \\frac{(-1)^{1}e^{(1-1)z}}{(1+e^z)^1}, \\\\\n        \n\\end{aligned}')
('11', 'm = 2,3,4')
('11', '\\begin{aligned}\n            &L^{\\prime \\prime}(z) = \\frac{e^z}{(1+e^z)^2},\\\\\n            &L^{(3)}(z) = \\frac{e^z-e^{2z}}{(1+e^z)^3},\\\\\n            &L^{(4)}(z) = \\frac{e^z-4e^{2z}+e^{3z}}{(1+e^z)^4}.\n        \n\\end{aligned}')
('11', 'L^{(m)}(z)')
('11', '\\frac{{(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m}')
('11', 'L^{(m)}(z) = \\frac{\\sum_{k=1}^{m-2} a_{k}^{(m)} e^{k\\cdot z} + {(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m}')
('11', '\\frac{{(-1)}^{m}e^{(m-1)z}}{(1+e^z)^m}')
('11', 'L^{(m+1)}(z)')
('11', '\\begin{aligned}\n                & \\qquad   \\frac{d}{dz}\\left({(-1)}^{m} \\cdot \\frac{ e^{(m-1)z}}{(1+e^z)^m}\\right) \\\\\n                &=  {(-1)}^{m} \\cdot \\frac{ \\left(e^{(m-1)z}\\cdot(m-1)\\cdot(1+e^z)^m - e^{(m-1)z}\\cdot m\\cdot (1+e^z)^{m-1}e^z\\right)}{(1+e^z)^{2m}}\\\\\n                &= {(-1)}^{m} \\cdot \\frac{e^{(m-1)z}\\cdot(m-1)\\cdot(1+e^z) - e^{(m-1)z}\\cdot m\\cdot e^z}{(1+e^z)^{m+1}}\\\\\n                &= {(-1)}^{m} \\cdot \\frac{(m-1)\\cdot e^{(m-1)z} + (m-1)\\cdot e^{mz} -  m\\cdot e^{mz}}{(1+e^z)^{m+1}}\\\\\n                &= {(-1)}^{m} \\cdot \\frac{(m-1)\\cdot e^{(m-1)z}  - e^{mz}}{(1+e^z)^{m+1}}\\\\\n                &= \\frac{{(-1)}^{m} \\cdot (m-1)\\cdot e^{(m-1)z}}{(1+e^z)^{m+1}} + \\frac{{(-1)}^{m+1} \\cdot  e^{mz}}{(1+e^z)^{m+1}}.\n            \\end{aligned}')
('11', 'L^{(m)}(z)')
('11', '\\frac{{(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m}')
('11', 'L^{(m)}(z)')
('11', 'L^{(m)}(z) = \\frac{\\sum_{k=1}^{m-2} a_{k}^{(m)} e^{k\\cdot z} + {(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m}')
('11', '\\lim\\limits_{z \\rightarrow + \\infty} \\frac{\\sum_{k=1}^{m-2} a_{k}^{(m)} e^{k\\cdot z} + {(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m} =0')
('11', '\\lim\\limits_{z \\rightarrow  -\\infty} \\frac{\\sum_{k=1}^{m-2} a_{k}^{(m)} e^{k\\cdot z} + {(-1)}^{m} e^{(m-1)z}}{(1+e^z)^m} =0')
('11', 'z \\in \\mathbb{R}')
('11', 'm')
('11', 'L^{(m)}(z)')
('11', 'z \\in \\mathbb{R}')
('13', '\\boldsymbol{\\mu}')
('13', '\\boldsymbol{\\sigma}')
('13', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g}),\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('13', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('13', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g}),\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('13', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('13', '\\textbf{y}_d')
('13', 'w.r.t.')
('13', '\\textbf{y}_d')
('13', 'w.r.t.')
('13', '\\textbf{x}_d')
('13', '\\textbf{J}_d  = \\frac{1}{\\boldsymbol{\\sigma}_d}\\left(I-\\frac{1}{n}\\textbf{1}_n\\textbf{1}_n^{\\top} - \\frac{1}{n \\boldsymbol{\\sigma}_d^2 }\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)\\left(\\textbf{x}_{d} - \\boldsymbol{\\mu}_d\\textbf{1}_n\\right)^{\\top} \\right) \\in \\mathbb{R}^{n \\times n}')
('13', '\\begin{aligned}\n                \\frac{\\partial \\textit{loss}}{\\partial \\textbf{x}_{d}} = = \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}\\frac{\\partial \\textit{loss} }{\\partial \\textbf{y}_{d}}= \\textbf{J}_d\\frac{\\partial \\textit{loss} }{\\partial \\textbf{y}_{d}},\n            \\end{aligned}')
('13', '\\textrm{Loss}^{\\text{grad}}(\\textbf{g})')
('13', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{y}_d}\n        = \\textbf{g}_d \\textbf{1}_n \\in \\mathbb{R}^{n}')
('13', '\\textbf{J}_d \\cdot \\textbf{1}_n = \\textbf{0}')
('13', '\\frac{\\partial \\textrm{Loss}^{\\text{grad}}(\\textbf{g})}{\\partial \\textbf{x}_d}\n        = \\textbf{0}')
('13', '\\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})')
('13', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{y}_d} = \\textbf{H}_{d, d}^{\\text{diag}} \\left(\\textbf{y}_d - \\tilde{\\textrm{y}}_d \\textbf{1}_n\\right)')
('13', '\\textbf{J}_d \\cdot \\textbf{1}_n = \\textbf{0}')
('13', '\\textbf{J}_d \\cdot \\textbf{y}_d = \\textbf{0}')
('13', '\\frac{\\partial \\textrm{Loss}^{\\text{diag}}(\\textbf{H}^{\\text{diag}})}{\\partial \\textbf{x}_d} = \\textbf{0}')
('13', 'L_d^{\\text{linear}}(\\textbf{H}_{d,:}^{\\text{off}})')
('13', 'w.r.t.')
('13', '\\textbf{x}_d')
('13', '\\textbf{J}_d \\cdot \\textbf{y}_d = \\textbf{0}')
('13', '\\textbf{J}_d = \\frac{\\partial \\textbf{y}_d^{\\top}}{\\partial \\textbf{x}_{d}}')
('13', '\\frac{\\partial \\textit{loss} }{\\partial \\textbf{y}_{d}}')
('13', '\\boldsymbol{\\mu}')
('13', '\\boldsymbol{\\sigma}')
('14.0', '\\varepsilon=1e-20')
('14.1', '\\mathbf{\\mu}')
('14.1', '\\mathbf{\\sigma}')
('14.2', '\\alpha=0')
('14.2', '\\alpha=1')
('14.2', '\\alpha=0')
('14.2', '\\alpha=1')
