('3.0', '\\mathcal{P}_s \\neq \\mathcal{P}_t')
('3.0', '\\mathcal{Y}_s \\cap \\mathcal{Y}_t=\\emptyset')
('3.0', 'S=\\{(x_i,y_i)\\}^{N_s}_{i=1}')
('3.0', 'Q=\\{(x_i,y_i)\\}^{N_q}_{i=1}')
('3.0', 'N_s')
('3.0', 'N_q')
('3.0', 'N')
('3.0', 'K')
('3.0', 'x')
('3.0', 'f_{\\theta}')
('3.0', 'p_n \\in \\mathbb{R}^D')
('3.0', 'p_n = \\frac{1}{K} \\sum\\nolimits_{(x,y) \\in S_n}f_{\\theta}(x)')
('3.0', 'S_n')
('3.0', 'K')
('3.0', 'n')
('3.0', 'P(y=j|x)=\\frac{\\exp(-d(f_\\theta(x),p_{j}))}{\\sum_{n=1}^{N}\\exp(-d(f_{\\theta}(x),p_n))},')
('3.0', 'd(.,.)')
('3.0', 'P(y=j|x)')
('3.0', 'x')
('3.0', 'j')
('3.0', '\\mathcal{L}_{CE}(Q) =  \\sum\\nolimits_{x\\in Q} \\ell_{CE}(P_x,Y_x),')
('3.0', '\\ell_{CE}')
('3.0', 'P_x')
('3.0', 'Y_x')
('3.0', 'x')
('3.1.0', '\\psi_{\\phi} : \\mathbb{R}^{K \\cdot D} \\rightarrow \\mathbb{R}^D')
('3.1.0', 'D')
('3.1.0', 'f_{\\theta}')
('3.1.0', 'K')
('3.1.0', '\\phi')
('3.1.0', '\\label{eq:prototypes}\n    p_{n} = \\psi_{\\phi} (concat (f_{\\theta}(x^n_1),..,f_{\\theta}(x^n_K))  ),')
('3.1.0', 'x^n_j')
('3.1.0', 'j')
('3.1.0', 'n')
('3.1.0', 'p_{n}')
('3.1.0', 'n')
('3.1.0', '\\psi_{\\phi}')
('3.1.0', 'N')
('3.1.0', '\\mathbb{P}=\\{p_1,p_2,..,p_N\\}')
('3.1.0', '\\mathcal{L}_{CE}(Q)')
('3.1.0', '\\mathcal{L}_{dis}')
('3.1.0', '\\label{eq:dis}\n\\mathcal{L}_{dis} =  \\frac{1} {\\sum_{\\{p_i,p_j\\} \\in \\mathbb{P}} \\, \\, d(p_i,p_j)},')
('3.1.0', 'd(\\cdot,\\cdot)')
('3.1.0', '\\mathcal{L}_{coh}')
('3.1.0', '\\label{eq:coh}\n\\mathcal{L}_{coh} = \\sum\\nolimits_{n=1}^{N}\\sum\\nolimits_{x \\in Q_{n}} d(p_n,f_\\theta(x) ),')
('3.1.0', 'Q_{n}')
('3.1.0', 'n')
('3.1.0', '\\label{eq:train_loss}\n        \\min_{ \\phi}\\;   \n    \\mathcal{L}_{train} \n    = \\mathcal{L}_{CE}(Q) + \\lambda_{dis} \\mathcal{L}_{dis} +\\lambda_{coh}  \\mathcal{L}_{coh},')
('3.1.0', '\\lambda_{dis}')
('3.1.0', '\\lambda_{coh}')
('3.1.0', '\\mathcal{L}_{dis}')
('3.1.0', '\\mathcal{L}_{coh}')
('3.1.0', 'D_{s}')
('3.1.0', 'K')
('3.1.0', 'N')
('3.1.0', 'f_\\theta')
('3.1.0', '\\gamma_1')
('3.1.0', '\\gamma_2')
('3.1.0', '\\phi \\leftarrow \\phi_0,\\theta \\leftarrow \\theta_0;')
('3.1.0', '\\theta, \\phi')
('3.1.0', 'V \\leftarrow')
('3.1.0', 'D_{s}')
('3.1.0', 'S_n,Q_n \\leftarrow')
('3.1.0', 'D_{s}^V')
('3.1.0', 'S=S_1 \\cup .. \\cup S_N')
('3.1.0', 'Q=Q_1 \\cup .. \\cup Q_N')
('3.1.0', '\\theta   \\leftarrow  \\theta   - \\gamma_1\\nabla_{ \\theta} \\mathcal{L}_{CE}  (S)')
('3.1.0', '\\mathcal{L}_{dis}')
('3.1.0', '\\mathcal{L}_{coh}')
('3.1.0', '\\mathcal{L}_{train}=\\lambda_{dis}\\mathcal{L}_{dis}+\\lambda_{coh}\\mathcal{L}_{dis}')
('3.1.0', '\\mathcal{L}_{train} \\leftarrow \\mathcal{L}_{train} + \\ell_{CE}(x,y)')
('3.1.0', '\\phi   \\leftarrow  \\phi   - \\gamma_2  \\nabla_\\phi\\mathcal{L}_{train}')
('3.1.1', 'f_\\theta')
('3.1.1', '\\psi_{\\phi}')
('3.1.1', 'f_\\theta')
('3.1.1', 'f_\\theta')
('3.1.1', 'i')
('3.1.1', 'x')
('3.1.1', '[p^i_1, p^i_2,\\cdots, p^i_N]')
('3.1.1', '\\psi_{\\phi}')
('3.1.1', 'S')
('3.1.1', 'N')
('3.1.1', 'x')
('3.1.1', 'h^{i}(x) = [d(f_{\\theta^i}(x),p^{i}_{1}), d(f_{\\theta^i}(x),p^{i}_{2}),..,d(f_{\\theta^i}(x),p^{i}_{N})  ]^{\\top}\n    \\label{eq:hx}')
('3.1.1', 'h^{i}(x)')
('3.1.1', '\\tilde{h}^{i}(x)')
('3.1.1', 'i')
('3.1.1', '\\tilde{h}^{i}(x) =   \\alpha_i \\; h^{i}(x)+ (1-\\alpha_i) \\;   \\tilde{h}^{i-1}(x),\n    \\label{eq:tildehx}')
('3.1.1', '\\alpha_i')
('3.1.1', 'x')
('3.1.1', '\\label{eq:pseudo}\n  \\tilde{P}^{i}(y=j|x)=\\frac{\\exp(-\\tilde{h}^{i}\n  _{j}(x))}{\\sum_{n=1}^{N}\\exp(-\\tilde{h}_{n}^{i}(x))},')
('3.1.1', '\\tilde{P}^{i}(y=j|x)')
('3.1.1', 'x')
('3.1.1', 'j')
('3.1.1', 'i')
('3.1.1', 'f_{\\theta}')
('3.1.1', '\\alpha_i')
('3.1.1', '\\alpha_i =  \\gamma\\, \\alpha_{i-1},\n    \\label{eq:alpha}')
('3.1.1', '\\gamma\\in(0,1)')
('3.1.1', '\\alpha')
('3.1.1', '\\tilde{h}^{i}')
('3.1.1', '\\alpha_0')
('3.1.1', '\\alpha_i')
('3.1.1', '(S, Q)')
('3.1.1', 'f_{\\theta}, \\psi_\\phi')
('3.1.1', '\\lambda_{dis}')
('3.1.1', '\\lambda_{coh}')
('3.1.1', '\\alpha_0, \\gamma')
('3.1.1', '\\epsilon')
('3.1.1', '\\theta^1\\!=\\!\\theta')
('3.1.1', '\\tilde{h}^{0}(x)=0,\\, \\forall x\\in Q')
('3.1.1', '\\theta')
('3.1.1', 'p_{n} = \\psi_{\\phi} (concat (f_{\\theta}(x^n_1),..,f_{\\theta}(x^n_K))),\\;')
('3.1.1', '\\mbox{for}\\ S_n=\\{x^n_1,\\cdots,x^n_K\\},\\forall n\\!\\in\\!\\{1,\\cdots, N\\}')
('3.1.1', '\\nabla_\\theta \\mathcal{L}_{ft}  \\leftarrow 0')
('3.1.1', '\\alpha_i')
('3.1.1', '\\tilde{P^i}(Y|x)')
('3.1.1', '\\nabla_\\theta\\mathcal{L}_{ft}  \\leftarrow \\nabla_\\theta\\mathcal{L}_{ft} \n      +  \\nabla_{\\theta} \\mathcal{L}^{tr}_{CE}  ((x,\\tilde{P^i}(Y|x));\\theta,\\phi)')
('3.1.1', '\\nabla_\\theta\\mathcal{L}_{ft}  \\leftarrow \\nabla_\\theta\\mathcal{L}_{ft} \n      + \\nabla_{\\theta } \\mathcal{L}_{CE}  (S)   \n      + \\lambda_{dis}\\nabla_{\\theta }\\mathcal{L}_{dis}')
('3.1.1', '+\\lambda_{coh}\\nabla_{\\theta }\\mathcal{L}^{ft}_{coh}')
('3.1.1', '\\theta^{i+1}  \\leftarrow \\theta^{i}  - \\eta \\nabla_{\\theta=\\theta^i}\\mathcal{L}_{ft}')
('3.1.1', '\\theta=\\theta^{i+1}')
('3.1.1', '\\theta^i,\\phi')
('3.1.1', 'f_{\\theta}')
('3.1.1', '\\epsilon')
('3.1.1', '\\label{eq:ce-psudo}\n\\mathcal{L}^{tr}_{CE}(Q)= \n\\sum_{x \\in Q}\n     \\begin{cases}\n         \\mathcal{L}_{CE}(x,\\tilde{P}^{i}(Y|x);\\theta,\\phi) &\\text{if }\\max(\\tilde{P}^{i}(Y|x))>\\epsilon\\\\\n       0 &\\text{otherwise}\n     \\end{cases}')
('3.1.1', '\\tilde{P}^{i}(Y|x)')
('3.1.1', 'x')
('3.1.1', '\\max(\\tilde{P}^{i}(Y|x))')
('3.1.1', 'x')
('3.1.1', '\\mathcal{L}_{CE}(x,\\tilde{P}^{i}(Y|x);\\theta,\\phi)')
('3.1.1', '(x,\\tilde{P}^{i}(Y|x))')
('3.1.1', 'f_\\theta')
('3.1.1', '\\psi_\\phi')
('3.1.1', '\\mathcal{L}_{dis}')
('3.1.1', '\\mathcal{L}_{coh}')
('3.1.1', '\\mathcal{L}_{coh}')
('3.1.1', '\\mathcal{L}^{ft}_{coh} = \\sum\\nolimits_{n=1}^{N}\\sum\\nolimits_{x \\in S_{n}} d(p_n,f_\\theta(x) ),')
('3.1.1', 'S_{n}')
('3.1.1', '\\label{eq:finetune}\n        \\min_{\\theta} \\;  \\mathcal{L}_{ft} = \\mathcal{L}_{CE}(S)+ \\mathcal{L}^{tr}_{CE}(Q) + \\lambda_{dis} \\mathcal{L}_{dis} \n      +\\lambda_{coh}       \\mathcal{L}^{ft}_{coh}%.')
('4.0', '\\lambda_{dis}')
('4.0', '\\lambda_{coh}')
('4.0', '\\alpha_0')
('4.0', '\\gamma')
('4.0', '\\epsilon')
('4.0', '0.5')
('4.0', '0.99')
('4.0', '0.4')
('4.1.1', 'g')
('4.1.1', 'g')
('4.1.1', "K'=5")
('4.1.1', '\\alpha_0')
('4.1.1', '\\epsilon')
('4.1.1', '\\lambda_{coh}')
('4.1.1', '\\lambda_{dis}')
('4.2', '- \\text{w/o } \\psi_{\\phi}')
('4.2', '- \\text{w/o } \\mathcal{L}_{dis}')
('4.2', '- \\text{w/o } \\mathcal{L}_{coh}')
('4.2', '\\mathcal{L}_{dis}')
('4.2', '\\mathcal{L}_{coh}')
('4.2', '- \\text{w/o } \\mathcal{L}_{CE}(S)')
('4.2', '- \\text{w/o } \\mathcal{L}^{tr}_{CE}(Q)')
('4.2', '- \\text{w/o}')
('4.2', '\\mathcal{L}_{dis}')
('4.2', '\\mathcal{L}_{coh}')
('4.2', '- \\text{w/o } \\mathcal{L}_{CE}(S)')
('4.2', '- \\text{w/o } \\psi_{\\phi}')
('4.2', '- \\text{w/o } \\psi_{\\phi}')
('4.2', '- \\text{w/o } \\mathcal{L}_{dis}')
('4.2', '- \\text{w/o } \\mathcal{L}_{coh}')
('4.2', '- \\text{w/o } \\mathcal{L}^{tr}_{CE}(Q)')
('4.2', '- \\text{w/o}')
('5', '\\alpha_0')
('5', '\\alpha_0')
('5', '\\lambda_{coh}')
('5', '\\lambda_{dis}')
('5', '\\lambda_{dis}')
('5', '\\lambda_{dis}')
('5', '\\epsilon')
('5', '\\epsilon')
('5', '\\epsilon')
('5', '\\epsilon')
