('1', '3')
('1', '3')
('3', '\\mathbf{X} \\in \\mathbb{R}^{N \\times D}')
('3', 'N')
('3', 'D')
('3', '\\mathbf{X}')
('3', '\\mathbf{Q}^{N\\times D_Q}')
('3', '\\mathbf{K} \\in \\mathbb{R}^{N\\times D_K}')
('3', '\\mathbf{V}\\in \\mathbb{R}^{N\\times D_V}')
('3', 'D_Q = D_K = D_V')
('3', '\\mathbf{Q}')
('3', '\\mathbf{K}')
('3', '\\mathbf{V}')
('3', 'M')
('3', '\\mathbf{Q} \\to [\\mathbf{Q}_1,\\cdots, \\mathbf{Q}_M],~\\mathbf{K} \\to [\\mathbf{K}_1,\\cdots, \\mathbf{K}_M],~\\mathbf{V} \\to [\\mathbf{V}_1,\\cdots, \\mathbf{V}_M],')
('3', 'm = 1, \\dots, M')
('3', '\\mathbf{Q}_m \\in \\mathbb{R}^{N\\times \\frac{D_Q}{M}},~\\mathbf{K}_m \\in \\mathbb{R}^{N\\times \\frac{D_K}{M}},~\\mathbf{V}_m \\in \\mathbb{R}^{N\\times \\frac{D_V}{M}}.')
('3', '\\{\\mathbf{Q}_m, \\mathbf{K}_m, \\mathbf{V}_m\\}')
('3', 'm = 1,\\dots,M')
('3', '\\mathbf{Y}_m =  \\mathrm{softmax}(\\frac{\\mathbf{Q}_m\\mathbf{K}^{\\top}_m}{\\sqrt{D_k}}) \\mathbf{V}_m,~ m = 1,\\dots,M.')
('3', '\\mathbf{Y} \\gets [\\mathbf{Y}_1,\\cdots,\\mathbf{Y}_M] \\in \\mathbb{R}^{N \\times D_V}.')
('3', 'D')
('3', '\\mathbf{x}  = [x_1,\\cdots,x_D]')
('3', '\\mu')
('3', '\\epsilon')
('3', '\\mu = \\frac{1}{D}\\sum_{i=1}^D x_i,~\\epsilon = \\sqrt{\\frac{1}{D}\\sum_{i=1}^D (x_i-\\mu)^2}.')
('3', '\\mathbf{x}')
('3', '\\hat{x}_i = \\gamma \\frac{x_i-\\mu}{\\epsilon} + \\beta,')
('3', '\\beta')
('3', '\\gamma')
('3', '\\mathbf{x} \\in \\mathbb{R}^{D}')
('3', '\\mathbf{x}')
('3', '\\mathrm{MLP}(\\mathbf{x}) = \\sigma(\\mathbf{x}\\mathbf{W}_1+\\mathbf{b}_1)\\mathbf{W}_2 + \\mathbf{b}_2,')
('3', '\\mathbf{W}_1 \\in \\mathbb{R}^{D \\times rD}')
('3', '\\mathbf{b}_1 \\in \\mathbb{R}^{rD}')
('3', 'D')
('3', 'rD')
('3', 'r>1')
('3', '\\mathbf{W}_2 \\in \\mathbb{R}^{rD \\times D}')
('3', '\\mathbf{b}_2 \\in \\mathbb{R}^{D}')
('3', 'rD')
('3', 'D')
('4.0', 'L')
('4.0', '\\{V^1,\\cdots, V^L\\}')
('4.0', 'V^j')
('4.0', 'j  = 1, \\dots, L')
('4.0', 'W\\times H \\times 3')
('4.0', 'w\\times h')
('4.0', 'p\\times p \\times 3')
('4.0', '\\mathbf{p} \\in \\mathbb{R}^{3p^2}')
('4.0', 'i')
('4.0', 'V^j')
('4.0', '\\mathbf{p}_{i}^j')
('4.0', 'i\\in[1,wh]')
('4.0', 'j\\in[1,L]')
('4.0', '\\mathbf{p}_{i}^j')
('4.0', 'D')
('4.0', '\\mathbf{x}_i^j \\gets \\mathbf{W}_0 \\mathbf{p}_i^j,~i = 1,\\dots, wh,~ j = 1, \\dots, L,')
('4.0', '\\mathbf{W}_0 \\in \\mathbb{R}^{D\\times 3p^2}')
('4.0', '\\mathbf{p}_i')
('4.0', 'i\\in[1,wh]')
('4.0', '\\mathbf{z}_i^j \\gets \\mathbf{x}_i^j + \\mathbf{p}_i.')
('4.0', '\\mathbf{p}_i')
('4.0', 'i')
('4.0', 'V^j')
('4.0', '\\mathbf{z}_0^j')
('4.0', '\\mathbf{z}_0^j')
('4.0', '\\{\\mathbf{z}_i^j\\}_{i=1}^{wh}')
('4.0', '\\mathbf{Z}^j')
('4.0', '\\label{input}\n    \\mathbf{Z}^j = [\\mathbf{z}_0^j,\\mathbf{z}_1^j,\\cdots,\\mathbf{z}_{wh}^j] \\in \\mathbb{R}^{D\\times{(wh+1)}}.')
('4.0', '\\{\\mathbf{Z}^j\\}_{j=1}^L')
('4.1', 'S')
('4.1', '\\mathbf{Z}^j')
('4.1', 'V^j')
('4.1', 'S')
('4.1', 's')
('4.1', '\\mathbf{Z}^j_{s-1}')
('4.1', '\\mathbf{Z}^j_{s}')
('4.1', '\\mathbf{Z}_0^j')
('4.1', '\\mathbf{Z}^j')
('4.1', 's')
('4.1', '\\{\\mathrm{MSA}_s^l,\\mathrm{MLP}_s^l, \\mathrm{LN}_{s,1}^l,\\mathrm{LN}_{s,2}^l\\}')
('4.1', 's')
('4.1', '\\begin{split}\n     \\mathbf{Z}_s^j    &\\gets  \\mathbf{Z}^j_{s-1} + \\mathrm{MSA}_s^l(\\mathrm{LN}_{s,1}^l(\\mathbf{Z}^j_{s-1})),~~~ j = 1 \\dots L,\\\\\\mathbf{Z}_s^j   &\\gets  \\mathbf{Z}^j_s + \\mathrm{MLP}_{s}^l(\\mathrm{LN}_{s,2}^l(\\mathbf{Z}_s^j)),~~~ j = 1 \\dots L.\n    \\end{split}')
('4.1', 'S')
('4.1', '\\mathbf{Z}^j_S')
('4.1', 'V^j')
('4.1', '\\{\\mathbf{Z}^j_S \\}_{j=1}^L')
('4.1', '\\mathbf{M} = [\\mathbf{Z}^1_S,\\cdots,\\mathbf{Z}^L_S ] \\in \\mathbb{R}^{D\\times Lwh}.')
('4.1', 't')
('4.1', '\\{\\mathrm{MSA}_t^g,\\mathrm{MLP}_t^g, \\mathrm{LN}_{t,1}^g,\\mathrm{LN}_{t,2}^g\\}')
('4.1', 't')
('4.1', '\\mathbf{M}_{t-1}')
('4.1', '\\mathbf{M}_{t}')
('4.1', 't')
('4.1', '\\begin{split}\n     \\mathbf{M}_t    &\\gets  \\mathbf{M}_{t-1} + \\mathrm{MSA}_t^g(\\mathrm{LN}^g_{t,1}(\\mathbf{M}_{t-1})),\\\\\\mathbf{M}_t   &\\gets  \\mathbf{M}_t + \\mathrm{MLP}_{t}^g(\\mathrm{LN}_{t,2}^g(\\mathbf{M}_t)).\n    \\end{split}')
('4.1', 'T')
('4.1', '\\mathbf{M}_{T}')
('4.1', '\\mathbf{M}_{T} = [\\mathbf{m}_0^1,\\mathbf{m}_1^1,\\cdots,\\mathbf{m}_{wh}^1,\\mathbf{m}_0^2,\\mathbf{m}_1^2,\\cdots,\\mathbf{m}_{wh}^2,\\cdots, \\mathbf{m}_0^L,\\mathbf{m}_1^L,\\cdots,\\mathbf{m}_{wh}^L] \\in \\mathbb{R}^{D\\times L(wh+1)},')
('4.1', '\\mathbf{m}_0^{j}')
('4.1', 'V^j')
('4.1', '\\{\\mathbf{m}_0^{j}\\}_{j=1}^L')
('4.1', '\\mathbf{m} = \\frac{1}{L} \\sum_{j=1}^L \\mathbf{m}_0^{j}.')
('4.1', '\\mathbf{m}')
('5', '12,311')
('5', '9,843')
('5', '2,468')
('5', '192')
('5', '3')
('5', '8')
('5', '4')
('5', '384')
('5', '6')
('5', '8')
('5', '4')
('5', '\\beta_1')
('5', '\\beta_2')
('5.0', '0')
('5.0', '0')
('5.0', '12')
('5.0', '3072')
('5.0', '8586')
('5.0', '24')
('5.0', '49')
('5.0', '25')
('5.0', '15')
('5.0', '8')
('5.0', '4')
('5.1', '89.98\\%')
('5.1', '95.26\\%')
('5.1', '1010')
('5.1', '10700')
('5.1', '3')
('5.1', '12')
('5.3', '91.9')
('5.3', '90.5')
('5.3', '20')
('5.3', '12')
