('2.0', 'f: {\\mathbb{R}}^D\\to  {\\mathbb{R}}')
('2.0', 'N')
('2.0', 'x_N = \\{x_n\\}_{n=1}^N')
('2.0', 'y_N = \\{y_n\\}_{n=1}^N')
('2.0', 'p(y_N|f_N) =  \\prod_{n=1}^{N} p(y_n|f_n)')
('2.0', 'f_n = f(x_n)')
('2.0', 'f_N = \\{f_n\\}_{n=1}^N')
('2.0', 'f')
('2.0', 'f \\sim \\mathcal{GP}(0,k)')
('2.0', 'k:  {\\mathbb{R}}^D \\times  {\\mathbb{R}}^D \\to {\\mathbb{R}}')
('2.0', 'p(f_N) = \\mathcal{N}\\left( f_N \\middle| 0, K_{NN} \\right)')
('2.0', "K_{NN} = \\{k(x_n,x_{n'})\\}_{n,n'=1}^N")
('2.0', 'M \\ll N')
('2.0', 'x_M = \\{x_m\\}_{m=1}^M')
('2.0', 'm,M\\ (n,N)')
('2.0', 'x_{m=1}')
('2.0', 'x_{n=1}')
('2.0', 'f_M = \\{f_m\\}_{m=1}^M')
('2.0', 'f_m = f(x_m)')
('2.0', 'f_N')
('2.0', 'p(f_N,f_M) = p(f_N|f_M)p(f_M),')
('2.0', 'p(f_M) = \\mathcal{N}\\left( f_M \\middle| 0, K_{MM} \\right)')
('2.0', 'p(f_N|f_M) = \\mathcal{N}\\left( f_N \\middle| \\widetilde{K}_{NM}f_M, \\widetilde{K}_{NN} \\right)')
('2.0', '\\begin{aligned}\n\\widetilde{K}_{NM} = K_{NM}\\left(K_{MM}\\right)^{-1},  \n \\quad \n\\widetilde{K}_{NN} = K_{NN} - K_{NM}\\left(K_{MM}\\right)^{-1} K_{MN}. \\label{eq:KNNtilde}\n\\end{aligned}')
('2.0', 'K')
('2.0', 'K_{NN}')
('2.0', 'K_{NM} = \\{k(x_n,x_m)\\}_{n,m=1}^{N,M}')
('2.1', 'L')
('2.1', 'T_l')
('2.1', 'l = 1,\\dots,L')
('2.1', 'T = \\sum_{l=1}^{L} T_l')
('2.1', 'l')
('2.1', 'f_N^l = [f^{l,1}(f_N^{l-1}), \\dots,f^{l,T_l}(f_N^{l-1})]')
('2.1', 'f_N^{0} = x_N')
('2.1', 'k^l')
('2.1', 'x_M^l')
('2.1', 'l')
('2.1', '\\label{eq:dgpprior}\np(y_N,f_N,f_M) = p(y_N|f_N^L)\\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1})p(f_M^l).')
('2.1', 'p(f_M^l) = \\prod_{t=1}^{T_l}\\mathcal{N}\\left( f_M^{l,t} \\middle| 0, K^l_{MM} \\right)')
('2.1', 'p(f_N^l|f_M^l;f_N^{l-1}) = \\prod_{t=1}^{T_l}\\mathcal{N}\\left( f_N^{l,t} \\middle| \\widetilde{K}_{NM}^l f_M^{l,t}, \\widetilde{K}_{NN}^l \\right)')
('2.1', '\\widetilde{K}_{NM}^l')
('2.1', '\\widetilde{K}_{NN}^l')
('2.1', 'f^1_N, \\ldots, f_N^{L-1}')
('2.1', 'q(f_N,f_M)')
('2.1', 'p(f_N,f_M|y_N)')
('2.1', 'q')
('2.1', 'q')
('2.1', '\\text{KL}[q||p]')
('2.1', '\\label{eq:elbogeneral}\n\\mathcal{L} = \\int q(f_N,f_M)\\log \\frac{p(y_N,f_N,f_M)}{q(f_N,f_M)} df_N df_M,')
('2.1', '\\label{eq:dgpvarfam}\nq(f_N,f_M) = q(f_M)\\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1}).')
('2.1', 'f_M = \\{f_M^{l,t} \\}_{l,t=1}^{L, T_l}')
('2.1', 'q(f_M) %= \\prod_{l=1}^L q(f_M^l) \n= \\prod_{l=1}^L\\prod_{t=1}^{T_l}q(f_M^{l,t}).')
('2.1', 'q(f_M^{l,t}) = \\mathcal{N}\\left( f_M^{l,t} \\middle| \\mu_M^{l,t}, S_M^{l,t} \\right)')
('2.1', '\\mu_M^{l,t}')
('2.1', 'S_M^{l,t}')
('2.1', 'f_M')
('2.1', 'q(f_M)')
('2.1', '\\label{eq:dgpelbomf}\n\\mathcal{L}\\!=\\! \\sum_{n=1}^{N}\\!  \\mathbb{E}_{q(f_n^L)} \\! \\left[\\log p(y_n|f_n^L)\\right]  - \\! \\sum_{l,t=1}^{L,T_l} \\! \\text{KL}[q(f_M^{l,t})||p(f_M^{l,t})].')
('2.1', 'q(f_n^L)')
('2.1', '\\begin{aligned}\n\\label{eq:dgpsamplingmf}\nq(f_n^L) = \\int \\prod_{l=1}^{L} q(f_n^l;f_n^{l-1})df_n^{1}\\cdots df_n^{L-1},\n&\\ \\text{where}\n&\nq(f_n^l;f_n^{l-1}) = \\prod_{t=1}^{T_l} \\mathcal{N}\\left( f_n^{l,t} \\middle| \\widetilde{\\mu}_n^{l,t}, \\widetilde{\\Sigma}_n^{l,t} \\right).\n\\end{aligned}')
('2.1', '\\begin{aligned}\n{\\widetilde{\\mu}_n^{l,t}}   =  \\widetilde{K}^l_{nM}\\mu^{l,t}_M,\n\\quad\n{\\widetilde{\\Sigma}_n^{l,t}} =  K^l_{nn} -\n\\widetilde{K}^l_{nM}\\left(K^l_{MM} - S^{l,t}_M\\right) \\widetilde{K}^l_{Mn}.\n\\end{aligned}')
('2.1', 'q(f_n^L)')
('2.1', 'f_n^1, \\ldots, f_n^{L-1}')
('2.1', 'f_M')
('3', 'f_M')
('3', 'f_M')
('3.0', 'q(f_M) = \\mathcal{N}\\left( f_M \\middle| \\mu_M, S_M \\right)')
('3.0', 'TM')
('3.0', 'q(f_N,f_M)')
('3.0', 'S_M')
('3.0', 'q(f_M)')
('3.0', '\\label{eq:elbodgpfc}\n\\mathcal{L}\\! = \\! \\sum_{n=1}^{N} \\! \\mathbb{E}_{q(f_n^L)} \\left[\\log p(y_n|f_n^L)\\right] - \\text{KL}[q(f_M)||\\prod_{l,t=1}^{L,T_l} p(f_M^{l,t})],')
('3.0', 'q(f_n^L)')
('3.0', 'f_M')
('3.0', 'L')
('3.0', 'q(f_M)')
('3.0', 'q(f_n^L)')
('3.0', '\\begin{aligned}\n\\label{eq:dgpsamplingfc}\nq(f_n^L) = \\int \\prod_{l=1}^{L} q(f_n^l | f_n^1,\\dots,f_n^{l-1})  df_n^{1}\\cdots df_n^{L-1}\n&  \\ \\text{where}\n& q(f_n^l | f_n^1,\\dots,f_n^{l-1}) = \\mathcal{N}\\left( f_n^l \\middle| \\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l \\right),\n\\end{aligned}')
('3.0', 'x_n')
('3.0', '\\begin{aligned}\n\\label{eq:muhatn}\n\\hat{\\mu}_n^l \\! &= \\! \\widetilde{\\mu}_n^l + \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} ( f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}), \n\\\\\n\\label{eq:Sigmahatn}\n\\hat{\\Sigma}_n^l \\!  &= \\! \\widetilde{S}_n^{ll} - \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} \\widetilde{S}_n^{1:l-1,l}, \n\\end{aligned}')
('3.0', '\\widetilde{\\mu}_n^l = \\widetilde{\\mathcal{K}}^l_{nM} \\mu_M^l')
('3.0', "\\widetilde{S}_n^{ll'} = \\delta_{ll'} \\mathcal{K}^l_{nn} - \\widetilde{\\mathcal{K}}^l_{nM} \\left(\\delta_{ll'} \\mathcal{K}^l_{MM} - S_M^{ll'}\\right) \\widetilde{\\mathcal{K}}^{l'}_{Mn}")
('3.0', "A^{l,1:l'}")
('3.0', 'A')
('3.0', "{A}^{l,1:l'} = \\left(A^{l,1} \\cdots A^{l,l'} \\right)")
('3.0', '\\mu_M^l  \\in \\mathbb{R}^{T_lM}')
('3.0', '\\mu_M')
('3.0', 'l')
('3.0', "S_M^{ll'} \\in \\mathbb{R}^{T_l M \\times T_{l'}M}")
('3.0', 'l')
('3.0', "l'")
('3.0', '\\widetilde{\\mu}_n^l')
('3.0', "\\widetilde{S}_n^{ll'}")
('3.0', '\\mathcal{K}^l  = \\left(\\mathbb{I}_{T_l} \\otimes K^l\\right)')
('3.0', '\\mathbb{I}_{T_l}')
('3.0', 'K^l')
('3.0', '\\delta')
('3.0', 'f_M')
('3.0', 'q(f_n^l \\vert f_n^1, \\ldots, f_n^{l-1})')
('3.0', 'f_n^{1:l-1}')
('3.0', '\\hat{\\mu}_n^l')
('3.0', '\\hat{\\Sigma}_n^l')
('3.0', '\\widetilde{S}_n')
('3.0', 'q(f_n^L)')
('3.0', "\\label{eq:proofgen}\n\tq(f_n^L) = \\int \\left[ \\int q(f_M)\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M \\right] df_n^{1}\\cdots df_n^{L-1},")
('3.0', "\\label{eq:proofform}\n\t%\\begin{aligned}\t\n\t\\int q(f_M)\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M = \\left[ \\prod_{l'=1}^{l-1} q( f_n^{l'} | f_n^{1:l'-1})\\right]% \\times \n\t\\int q(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) \\prod_{l'=l+1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'}.\n\t%\\end{aligned}")
('3.0', 'l=1,\\dots,L')
('3.0', '1,\\dots,l')
('3.0', 'l')
('3.0', 'l\\to l+1')
('3.0', 'f_n^l')
('3.0', '\\begin{aligned}\n \\label{eq:proofstep1}\n\tq(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) = q(f_n^l | f_n^{1:l-1}) q(f_M^{l+1:L} | f_n^{1:l}) %\\textcolor{red}{q(f_M^{l+1:L} | f_n^{1:l})}.\n\t\n\\end{aligned}')
('3.0', 'q(f_n^l | f_n^{1:l-1})')
('3.0', 'l')
('3.0', 'f_M^{l+1}')
('3.0', 'l +2')
('3.0', '\\begin{aligned}\n\t&\\int q(f_M^{l+1:L} | f_n^{1:l}) p(f_n^{l+1} | f_M^{l+1}) df_M^{l+1} \n\t= \\int q(f_M^{l+1} | f_n^{1:l}) q(f_M^{l+2:L} | f_n^{1:l}, f_M^{l+1}) p(f_n^{l+1} | f_M^{l+1}) df_M^{l+1} \\nonumber \\\\\n\t\\label{eq:prooflaststep}\n\t= &\\int q(f_M^{l+1} | f_n^{1:l}) q(f_n^{l+1},f_M^{l+2:L} | f_n^{1:l}, f_M^{l+1}) df_M^{l+1} = q(f_n^{l+1},f_M^{l+2:L} | f_n^{1:l}).\n\t\n\\end{aligned}')
('3.0', 'l\\to l+1')
('3.0', 'l=L')
('3.0', '\\prod_{l=1}^{L} q(f_n^l | f_n^1,\\dots,f_n^{l-1})')
('3.0', 'f_M')
('3.0', 'L=3')
('3.0', 'S_M')
('3.0', 'f_M')
('3.0', 'S_M')
('3.1', 'S_M')
('3.1', 'M\\times M')
('3.1', '\\tau')
('3.1', '\\mathcal{O}(\\tau L M^2)')
('3.1', '\\mathcal{O}(\\tau L^2 M^2)')
('3.1', '\\mathcal{O}(\\tau^2 L^2 M^2)')
('3.1', '\\tau = 5')
('3.1', 'L=3')
('3.1', 'M=128')
('3.1', '1.8\\times 10^5')
('3.1', '5.1\\times 10^5')
('3.1', '2.0\\times 10^6')
('3.1', '\\widetilde{S}_n^{1:l-1,1:l-1}')
('3.1', 'S_M')
('3.1', 'L')
('3.1', 'S_M = LL^\\top')
('3.1', 'S_M')
('3.1', '\\mathcal{O}(NM^2\\tau L^2 + N \\tau^3 L^3 + M^3\\tau L^3)')
('3.1', '\\mathcal{O}(NM^2\\tau L)')
('3.1', '\\mathcal{O}(NM^2\\tau^2 L^2 + N \\tau^3L^3 +M^3\\tau^3L^3)')
('3.2', 'f_M')
('3.2', 'f_M')
('3.2', 'f_M')
('4.0', '90:10')
('4.0', 'X')
('4.0', 'z = Xw')
('4.0', 'w \\in \\mathbb{R}^D')
('4.0', 'z')
('4.0', '50:50')
('4.0', '\\mu')
('4.0', '\\sigma')
('4.0', '\\mu > 0.50 + \\sigma')
('4.0', '{ \\sigma}_*^2')
('4.0', '{ \\sigma}_*^2')
('4.0', '\\text{Var}_* = \\mathbb{E}[(y_* - \\mu_*)^2]')
('4.0', 'y_*')
('4.0', '\\mu_*')
('4.0', '{ \\sigma}^2_*')
('4.0', '\\text{Var}_*')
('4.1', 'M')
('4.1', 'M=128')
('4.1', 'M')
('4.1', '\\mathcal{O}(M^2)')
('4.1', 'L')
('4.1', '\\tau')
('8', 'q(f_n^l)')
('8', '\\label{eq:appxqfnLproof0}\nq(f_n^L) = \\int \\left[ \\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M \\right] df_n^{1}\\cdots df_n^{L-1}.')
('8', '\\label{eq:appxmain}\n\\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M = \\prod_{l=1}^{L} q(f_n^l | f_n^1,\\dots,f_n^{l-1}),')
('8', 'q')
('8', 'q(f_M) = \\mathcal{N}\\left( f_M \\middle| \\mu_M, S_M \\right)')
('8', '\\label{eq:appxqfM}\nq(f_M^{1:L}) = \\mathcal{N}\\left( f_M^{1:L} \\middle| \\mu_M^{1:L}, S_M^{1:L,1:L} \\right) = q\n\\begin{pmatrix}\nf_M^1\\\\\n\\vdots\\\\\nf_M^L\n\\end{pmatrix} = \\mathcal{N}\n\\left(\n\\begin{pmatrix}\n\tf_M^1\\\\\n\t\\vdots\\\\\n\tf_M^L\n\\end{pmatrix}\n\\middle|\n\\begin{pmatrix}\n\t\\mu_M^1\\\\\n\t\\vdots\\\\\n\t\\mu_M^L\n\\end{pmatrix},\n\\begin{pmatrix}\n\tS_M^{11} & \\cdots & S_M^{1L}\\\\\n\t\\vdots & \\ddots & \\vdots\\\\\n\tS_M^{L1} & \\cdots & S_M^{LL}\n\\end{pmatrix}\n\\right),')
('8', '\\label{eq:appxpcond}\np(f_n^l | f_M^l; f_n^{l-1}) = \\mathcal{N}\\left(  f_n^l  \\middle|  \\widetilde{\\mathcal{K}}_{nM}^l f_M^l,  \\widetilde{\\mathcal{K}}_{nn}^l  \\right),')
('8', '\\begin{aligned}\n{2}\\label{eq:appxKnM}\n&\\widetilde{\\mathcal{K}}_{nM}^l &&= \\mathcal{K}_{nM}^l \\left( \\mathcal{K}_{MM}^l \\right)^{-1} \\\\ \\label{eq:appxKnn}\n&\\widetilde{\\mathcal{K}}_{nn}^l &&= \\mathcal{K}_{nn}^l - \\mathcal{K}_{nM}^l \\left( \\mathcal{K}_{MM}^l \\right)^{-1} \\mathcal{K}_{Mn}^l.\n\\end{aligned}')
('8', '\\forall l=1,\\dots,L')
('8', "\\label{eq:indmain}\n\t\\int q(f_M^{1:L})\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} =\n\t\\left[ \\prod_{l'=1}^{l-1} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\\int q(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) \\prod_{l'=l+1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'},")
('8', "q( f_n^{l'} | f_n^{1:l'-1})")
('8', '\\label{eq:indgauss}\n\tq(f_n^l,f_M^{l+1:L}| f_n^{1:l-1}) = \\mathcal{N}\\left( \\begin{pmatrix*}[l]\n\t\tf_n^l \\\\ f_M^{l+1:L}\n\t\t\\end{pmatrix*} \\middle| \\begin{pmatrix*}[l]\n\t\t\\phantom{^l}\\hat{\\mu}_n^l \\\\ ^l\\hat{\\mu}_M^{l+1:L}\n\t\t\\end{pmatrix*}, \\begin{pmatrix*}\n\t\t\\hat{\\Sigma}^l_n & ^l\\hat{\\Sigma}_{nM}^{l,l+1:L} \\\\\n\t\t\\left(^l\\hat{\\Sigma}_{nM}^{l,l+1:L}\\right)^\\top & ^l\\hat{\\Sigma}_{M}^{l+1:L,l+1:L}\n\t\t\\end{pmatrix*} \\right).')
('8', '\\hat{\\mu}_n^l')
('8', '\\hat{\\Sigma}^l_n')
('8', '\\label{eq:indhelp}\n\t\\begin{aligned}\n\t^l\\hat{\\mu}_M^{l+1:L} &= \\mu_M^{l+1:L} + S_M^{l+1:L,1:l-1} \\emph{diag}(\\widetilde{\\mathcal{K}}_{Mn}^{1:l-1}) \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1}( f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}) \\\\\n\t^l\\hat{\\Sigma}_{M}^{l+1:L,l+1:L} &= S_M^{l+1:L,l+1:L} - S_M^{l+1:L,1:l-1}\n\t\\emph{diag}(\\widetilde{\\mathcal{K}}_{Mn}^{1:l-1}) \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1}\\emph{diag}(\\widetilde{\\mathcal{K}}_{nM}^{1:l-1}) S_M^{1:l-1,l+1:L}\\\\\n\t^l\\hat{\\Sigma}_{nM}^{l,l+1:L} &= \\widetilde{\\mathcal{K}}_{nM}^l S_M^{l,l+1:L} -\t\\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1}\\emph{diag}(\\widetilde{\\mathcal{K}}_{nM}^{1:l-1})S_M^{1:l-1,l+1:L}.\n\t\\end{aligned}')
('8', '\\text{diag}(A^{1:l})')
('8', 'A^1,\\dots,A^l')
('8', '\\hat{\\mu}_n^l')
('8', '\\hat{\\Sigma}^l_n')
('8', '^l\\hat{\\Sigma}_{M}^{l+1:L,l+1:L}')
('8', 'l')
('8', 'l \\to l+1')
('8', 'S_M')
('8', '^l\\hat{\\Sigma}_{M}')
('8', 'L-l-1 \\times L-l-1')
('8', "T_lM \\times T_{l'}M")
('8', '\\label{eq:appxfinal}\nq(f_n^L) = \\int \\left[ \\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M \\right] df_n^{1}\\cdots df_n^{L-1}.')
('8', 'l=L')
('8', "\\int q(f_M^1, \\dots, f_M^L)\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} =\n\\left[ \\prod_{l'=1}^{L-1} q( f_n^{l'} | f_n^1, \\dots, f_n^{l'-1})\\right]\nq(f_n^L | f_n^1,\\dots, f_n^{L-1})")
('8', 'q(f_n^L | f_n^1,\\dots, f_n^{L-1})')
('8', "\\int q(f_M^1, \\dots, f_M^L)\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} =\n\\prod_{l'=1}^{L} q( f_n^{l'} | f_n^1, \\dots, f_n^{l'-1}).")
('8', "\\label{eq:appxfinal2}\nq(f_n^L) = \\int \\prod_{l'=1}^{L} q( f_n^{l'} | f_n^1, \\dots, f_n^{l'-1}) df_n^{1}\\cdots df_n^{L-1},")
('8', 'q')
('8', '\\label{eq:gacond}\n\\mathcal{N}\\left( \\begin{pmatrix}\n\tx\\\\ y\n\t\\end{pmatrix} \\middle| \\begin{pmatrix}\n\ta \\\\ b\n\t\\end{pmatrix}, \\begin{pmatrix}\n\tA & C \\\\\n\tC^\\top & B\n\t\\end{pmatrix} \\right) = \\mathcal{N}\\left( x \\middle| a, A \\right)\\mathcal{N}\\left( y \\middle| b + C^\\top A^{-1}(x-a), B - C^\\top A^{-1} C \\right),')
('8', '\\label{eq:gaint}\n\\int\\mathcal{N}\\left( x \\middle| a + Fy, A \\right)\\mathcal{N}\\left( y \\middle| b, B \\right) dy = \\mathcal{N}\\left( x \\middle| a + Fb, A +FBF^\\top \\right).')
('8.0', 'l=1')
('8.0', "\\label{eq:indbase}\n\t\\int q(f_M^1, \\dots, f_M^L)\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} =\n\t\\int q(f_n^1,f_M^2,\\dots,f_M^L ) \\prod_{l'=2}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'},")
('8.0', 'q(f_n^1,f_M^2,\\dots,f_M^L )')
('8.0', 'f_M^1')
('8.0', "\\int\\left[ \\int q(f_M^1, \\dots, f_M^L) p(f_n^{1} | f_M^{1}) df_M^{1}\\right]\\prod_{l'=2}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'}.")
('8.0', 'q')
('8.0', 'f^1_M')
('8.0', '\\int q(f_M^1, \\dots, f_M^L) p(f_n^{1} | f_M^{1}) df_M^{1} = \\int q(f_M^1) q(f_M^2, \\dots, f_M^L|f_M^1) p(f_n^{1} | f_M^{1}) df_M^{1}.')
('8.0', 'f_M^1')
('8.0', '\\int q(f_M^1) q(f_M^2, \\dots, f_M^L|f_M^1) p(f_n^{1} | f_M^{1}) df_M^{1} = \\int q(f_M^1) q(f_n^{1},f_M^2, \\dots, f_M^L|f_M^1)  df_M^{1}.')
('8.0', '\\int q(f_M^1) q(f_n^{1},f_M^2, \\dots, f_M^L|f_M^1)  df_M^{1} = q(f_n^{1},f_M^2, \\dots, f_M^L).')
('8.0', 'q(f_M^1, \\dots, f_M^L)')
('8.0', '\\label{eq:baseii}\n\t\\begin{aligned}\n\t&q(f_M^1, \\dots, f_M^L) = q(f_M^1) q(f_M^2, \\dots, f_M^L | f_M^1) \\\\\n\t=\\ &\\mathcal{N}\\left( f_M^1 \\middle| \\mu_M^1, S_M^{11} \\right)\n\t\\mathcal{N}\\left( f_M^{2:L} \\middle| \\mu_M^{2:L} + S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} (f_M^1-\\mu_M^1) , S_M^{2:L,2:L} - S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} S_M^{1,2:L}  \\right).\n\t\\end{aligned}')
('8.0', 'q(f_M^2, \\dots, f_M^L | f_M^1)')
('8.0', 'p(f_n^{1} | f_M^{1})')
('8.0', '\\mathcal{N}\\left( f_n^{1} \\middle| \\widetilde{\\mathcal{K}}_{nM}^1 f_M^1 ,  \\widetilde{ \\mathcal{K} }_{nn}^1 \\right)')
('8.0', '\\label{eq:baseiii}\n\t\\begin{aligned}\n\t&q(f_n^1,f_M^2, \\dots, f_M^L | f_M^1) = \n\tp(f_n^{1} | f_M^{1}) q(f_M^2, \\dots, f_M^L | f_M^1) \\\\\n\t=\\ &\\mathcal{N}\\left( \\begin{pmatrix*}[l]\n\t\tf_n^{1} \\\\ f_M^{2:L}\n\t\t\\end{pmatrix*} \\middle| \\begin{pmatrix}\n\t\t\\widetilde{\\mathcal{K}}_{nM}^1 f_M^1 \\\\ \\mu_M^{2:L} + S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} (f_M^1-\\mu_M^1)\n\t\t\\end{pmatrix}, \\begin{pmatrix}\n\t\t\\widetilde{\\mathcal{K}}_{nn}^1 & 0 \\\\\n\t\t0 & S_M^{2:L,2:L} - S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} S_M^{1,2:L}\n\t\t\\end{pmatrix} \\right).\n\t\\end{aligned}')
('8.0', 'q(f_M^1) = \\mathcal{N}\\left( f_M^1 \\middle| \\mu_M^1, S_M^{11} \\right)')
('8.0', '\\label{eq:baseiv}\n\t\\begin{aligned}\n\t&\\int q(f_n^1,f_M^2,\\dots,f_M^L | f_M^{1}) q(f_M^1) df_M^{1} \\\\\n\t=\\ &\\mathcal{N}\n\t\\left(\n\t\\begin{pmatrix*}[l]\tf_n^{1} \\\\ f_M^{2:L}\\end{pmatrix*}\n\t\\middle| \\vphantom{\\begin{pmatrix}\n\t\t\\widetilde{\\mathcal{K}}_{nM}^1 \\mu_M^1 \\\\ \\mu_M^{2:L} + S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} (\\mu_M^1-\\mu_M^1)\n\t\t\\end{pmatrix}} \\right.\n\t\\begin{aligned}[t]\n\t&\\begin{pmatrix}\n\t\\widetilde{\\mathcal{K}}_{nM}^1 \\mu_M^1 \\\\ \\mu_M^{2:L} + S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} (\\mu_M^1-\\mu_M^1)\n\t\\end{pmatrix}, \\\\\n\t&\\left. \\begin{pmatrix}\n\t\\widetilde{\\mathcal{K}}_{nn}^1 & 0 \\\\\n\t0 & S_M^{2:L,2:L} - S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1} S_M^{1,2:L}\n\t\\end{pmatrix} +\n\t\\begin{pmatrix}\n\t\\widetilde{\\mathcal{K}}_{nM}^1 \\\\ S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1}\n\t\\end{pmatrix} S_M^{11} \\begin{pmatrix}\n\t\\widetilde{\\mathcal{K}}_{nM}^1 \\\\ S_M^{2:L,1} \\left(S_M^{11}\\right)^{-1}\n\t\\end{pmatrix}^\\top \\right)\n\t\\end{aligned}\\\\\n\t=\\ &\\mathcal{N}\\left( \\begin{pmatrix*}[l]\tf_n^{1} \\\\ f_M^{2:L}\\end{pmatrix*} \\middle| \\begin{pmatrix}\n\t\t\\widetilde{\\mu}_n^1 \\\\[3pt] \\mu_M^{2:L}\n\t\t\\end{pmatrix}, \\begin{pmatrix*}\n\t\t\\widetilde{S}_n^{11} & \\widetilde{\\mathcal{K}}_{nM}^1S_M^{1,2:L} \\\\[3pt]\n\t\tS_M^{2:L,1}\\widetilde{\\mathcal{K}}_{Mn}^1 & S_M^{2:L,2:L}\n\t\t\\end{pmatrix*} \\right).\n\t\\end{aligned}')
('8.0', '\\widetilde{\\mu}_n^1')
('8.0', '\\widetilde{S}_n^{11}')
('8.0', 'l=1')
('8.0', '\\mathcal{N}\\left( \\begin{pmatrix*}[l]\n\t\tf_n^1 \\\\ f_M^{2:L}\n\t\t\\end{pmatrix*} \\middle| \\begin{pmatrix*}[l]\n\t\t\\phantom{^1}\\hat{\\mu}_n^1 \\\\ ^1\\hat{\\mu}_M^{2:L}\n\t\t\\end{pmatrix*}, \\begin{pmatrix*}\n\t\t\\hat{\\Sigma}^1_n & ^1\\hat{\\Sigma}_{nM}^{1,2:L} \\\\\n\t\t\\left(^1\\hat{\\Sigma}_{nM}^{l,2:L}\\right)^\\top & ^1\\hat{\\Sigma}_{M}^{2:L,2:L}\n\t\t\\end{pmatrix*} \\right),')
('8.0', 'q(f_n^1,f_M^2,\\dots,f_M^L)')
('8.0', 'l=1')
('8.0.0', 'l=1,\\dots,L-1')
('8.0.0', 'l+1')
('8.0.0', "\\label{eq:steprepeat}\n\t\\int q(f_M^{1:L})\\prod_{l'=1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} =\n\t\\left[ \\prod_{l'=1}^{l-1} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\\int q(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) \\prod_{l'=l+1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'},")
('8.0.0', 'l')
('8.0.0', "\\label{eq:stepmain}\n\t\\left[ \\prod_{l'=1}^{l} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\\int q(f_n^{l+1},f_M^{l+2:L} | f_n^{1:l}) \\prod_{l'=l+2}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'},")
('8.0.0', 'l\\to l+1')
('8.0.0', 'l')
('8.0.0', 'f_n^l')
('8.0.0', 'q')
('8.0.0', 'q(f_n^l| f_n^{1:l-1})')
('8.0.0', "\\begin{aligned}\n \\label{eq:stepo1}\n\t\t\t&\\left[ \\prod_{l'=1}^{l-1} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\t\t\\int q(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) \\prod_{l'=l+1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} \\\\ \\label{eq:stepo2}\n\t\t\t=\\ &\\left[ \\prod_{l'=1}^{l-1} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\t\t\\int q(f_n^l | f_n^{1:l-1}) q(f_M^{l+1:L} | f_n^{1:l}) \\prod_{l'=l+1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'} \\\\ \\label{eq:stepo3}\n\t\t\t=\\ &\\left[ \\prod_{l'=1}^{l} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\t\t\\int q(f_M^{l+1:L} | f_n^{1:l}) \\prod_{l'=l+1}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'}.\n\t\t\n\\end{aligned}")
('8.0.0', 'f_M^{l+1}')
('8.0.0', "\\left[ \\prod_{l'=1}^{l} q( f_n^{l'} | f_n^{1:l'-1})\\right]\n\t\t\\int \\left[ \\int  q(f_M^{l+1:L} | f_n^{1:l}) p(f_n^{l+1} | f_M^{l+1}) df_M^{l+1} \\right] \\prod_{l'=l+2}^L p(f_n^{l'} | f_M^{l'}) df_M^{l'}.")
('8.0.0', 'q(f_n^{l+1},f_M^{l+2:L} | f_n^{1:l})')
('8.0.0', 'q')
('8.0.0', 'f_M^{l+1}')
('8.0.0', '\\int  q(f_M^{l+1:L} | f_n^{1:l}) p(f_n^{l+1} | f_M^{l+1}) df_M^{l+1} = \\int  q(f_M^{l+1}| f_n^{1:l}) q(f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}) p(f_n^{l+1} | f_M^{l+1}) df_M^{l+1}.')
('8.0.0', 'f_M^{l+1}')
('8.0.0', '\\int  q(f_M^{l+1}| f_n^{1:l}) q(f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}) p(f_n^{l+1} | f_M^{l+1}) df_M^{l+1} = \\int  q(f_M^{l+1}| f_n^{1:l}) q(f_n^{l+1} ,f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}) df_M^{l+1}.')
('8.0.0', '\\int  q(f_M^{l+1}| f_n^{1:l}) q(f_n^{l+1} ,f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}) df_M^{l+1} = q(f_n^{l+1} ,f_M^{l+2:L} | f_n^{1:l}).')
('8.0.0', 'q(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) = \\mathcal{N}\\left( \\begin{pmatrix*}[l]\n\t\tf_n^l \\\\ f_M^{l+1:L}\n\t\t\\end{pmatrix*} \\middle| \\begin{pmatrix*}[l]\n\t\t\\phantom{^l}\\hat{\\mu}_n^l \\\\ ^l\\hat{\\mu}_M^{l+1:L}\n\t\t\\end{pmatrix*}, \\begin{pmatrix*}\n\t\t\\hat{\\Sigma}^l_n & ^l\\hat{\\Sigma}_{nM}^{l,l+1:L} \\\\\n\t\t\\left(^l\\hat{\\Sigma}_{nM}^{l,l+1:L}\\right)^\\top & ^l\\hat{\\Sigma}_{M}^{l+1:L,l+1:L}\n\t\t\\end{pmatrix*} \\right),')
('8.0.0', 'f_n^l')
('8.0.0', '\\begin{aligned} \\label{eq:stepoexplicit}\n\t&q(f_n^l,f_M^{l+1:L} | f_n^{1:l-1}) = q(f_n^l | f_n^{1:l-1}) q(f_M^{l+1:L} | f_n^{1:l})\n\t= \\mathcal{N}\\left( f_n^l \\middle| \\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l \\right) \\times \\\\ &\\mathcal{N}\\left( f_M^{l+1:L} \\middle| {}^l\\hat{\\mu}_M^{l+1:L} + \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l) , {}^l\\hat{\\Sigma}_M^{l+1:L,l+1:L} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1:L} \\right).\n\t\\end{aligned}')
('8.0.0', 'q(f_n^l | f_n^{1:l-1}) = \\mathcal{N}\\left( f_n^l \\middle| \\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l \\right)')
('8.0.0', '\\label{eq:stepi}\n\tp(f_n^{l+1} | f_M^{l+1}) = \\mathcal{N}\\left( f_n^{l+1} \\middle| \\widetilde{ \\mathcal{K}}_{nM}^{l+1} f_M^l,  \\widetilde{ \\mathcal{K}}_{nn}^{l+1} \\right).')
('8.0.0', 'q(f_M^{l+1:L} | f_n^{1:l})')
('8.0.0', 'q(f_M^{l+1:L} | f_n^{1:l}) = q(f_M^{l+1}| f_n^{1:l}) q(f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}),')
('8.0.0', '\\label{eq:stepii1}\n\tq(f_M^{l+1} | f_n^{1:l}) = \\mathcal{N}\\left( f_M^{l+1} \\middle| {}^l\\hat{\\mu}_M^{l+1} + \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l) , {}^l\\hat{\\Sigma}_M^{l+1,l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1} \\right)')
('8.0.0', '\\label{eq:stepii2}\n\t\\begin{aligned}\n\t&q(f_M^{l+2:L} | f_n^{1:l}, f_M^{l+1}) \\\\\n\t=\\ &\\begin{aligned}[t]\n\t\\mathcal{N}\\left( f_M^{l+2:L} \\middle| \\vphantom{\\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}} \\right. &{}^l\\hat{\\mu}_M^{l+2:L} + \\left( {}^l\\hat{\\Sigma}_{nM}^{l+2:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l) + \\left( {}^l\\hat{\\Sigma}_M^{l+2:L,l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+2:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1} \\right) \\times \\\\\n\t&\\left( {}^l\\hat{\\Sigma}_M^{l+1,l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1} \\right)^{-1} \\left( f_M^{l+1} - {}^l\\hat{\\mu}_M^{l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l) \\right),\\\\\n\t&{}^l\\hat{\\Sigma}_M^{l+2:L,l+2:L} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+2:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+2:L} - \\left( {}^l\\hat{\\Sigma}_M^{l+2:L,l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+2:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1} \\right) \\times \\\\\n\t&\\left( {}^l\\hat{\\Sigma}_M^{l+1,l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1} \\right)^{-1} \\left( {}^l\\hat{\\Sigma}_M^{l+1,l+2:L} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+2:L}\\right) \\left. \\vphantom{\\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}} \\right).\n\t\\end{aligned}\n\t\\end{aligned}')
('8.0.0', '\\label{eq:stepiii}\n\tq(f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}) p(f_n^{l+1} | f_M^{l+1}) = q(f_n^{l+1} ,f_M^{l+2:L} | f_n^{1:l},f_M^{l+1})')
('8.0.0', '\\label{eq:stepiv}\n\t\\begin{aligned}\n\t&q(f_n^{l+1} ,f_M^{l+2:L} | f_n^{1:l}) = \\int q(f_M^{l+1}| f_n^{1:l}) q(f_n^{l+1} ,f_M^{l+2:L} | f_n^{1:l},f_M^{l+1}) df_M^{l+1} \\\\\n\t=\\ &\\mathcal{N}\\left( \\begin{pmatrix*}[l]\n\t\tf_n^{l+1} \\\\[2mm] f_M^{l+2:L}\n\t\t\\end{pmatrix*} \\middle| \\begin{pmatrix*}[l]\n\t\t\\hat{m}_n^{l+1} \\\\[2mm] \\hat{m}_M^{l+2:L}\n\t\t\\end{pmatrix*}, \\begin{pmatrix*}\n\t\t\\hat{S}^{l+1}_n & \\hat{S}_{nM}^{l+1,l+2:L} \\\\\n\t\t\\left(\\hat{S}_{nM}^{l+1,l+2:L}\\right)^\\top & \\hat{S}_{M}^{l+2:L,l+2:L}\n\t\t\\end{pmatrix*} \\right),\n\t\\end{aligned}')
('8.0.0', '\\begin{aligned}\n\\label{eq:stepresfirst}\n\t\\hat{m}_n^{l+1} &= \\widetilde{\\mathcal{K}}_{nM}^{l+1}\\left({}^l\\hat{\\mu}_M^{l+1} + \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l) \\right)\\\\\\label{eq:stepressecond}\n\t\\hat{m}_M^{l+2:L} &= {}^l\\hat{\\mu}_M^{l+2:L} + \\left( {}^l\\hat{\\Sigma}_{nM}^{l+2:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l)\\\\\n\t\\hat{S}^{l+1}_n &= \\mathcal{K}^{l+1}_{nn} + \\mathcal{K}^{l+1}_{nM}\\left( {}^l\\hat{\\Sigma}_M^{l+1,l+1} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+1} \\right) \\mathcal{K}^{l+1}_{Mn}\\\\\n\t\\hat{S}_{nM}^{l+1,l+2:L} &= \\widetilde{\\mathcal{K}}_{nM}^{l+1} \\left( {}^l\\hat{\\Sigma}_M^{l+1,l+2:L} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+2:L}\\right)\\\\ \\label{eq:stepreslast}\n\t\\hat{S}_{M}^{l+2:L,l+2:L} &= {}^l\\hat{\\Sigma}_M^{l+2:L,l+2:L} - \\left( {}^l\\hat{\\Sigma}_{nM}^{l+2:L,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}{}^l\\hat{\\Sigma}_{nM}^{l,l+2:L}.\n\t\n\\end{aligned}')
('8.0.0', '\\label{eq:stepremainRHS}\n\tq(f_n^{l+1},f_M^{l+2:L} | f_n^{1:l}) = \\mathcal{N}\\left( \\begin{pmatrix*}[l]\n\t\tf_n^{l+1} \\\\ f_M^{l+2:L}\n\t\t\\end{pmatrix*} \\middle| \\begin{pmatrix*}[l]\n\t\t\\phantom{^{l+1}}\\hat{\\mu}_n^{l+1} \\\\ ^{l+1}\\hat{\\mu}_M^{l+2:L}\n\t\t\\end{pmatrix*}, \\begin{pmatrix*}\n\t\t\\hat{\\Sigma}^{l+1}_n & ^{l+1}\\hat{\\Sigma}_{nM}^{l+1,l+2:L} \\\\\n\t\t\\left(^{l+1}\\hat{\\Sigma}_{nM}^{l+1,l+2:L}\\right)^\\top & ^{l+1}\\hat{\\Sigma}_{M}^{l+2:L,l+2:L}\n\t\t\\end{pmatrix*} \\right),')
('8.0.0', '\\hat{m}_n^{l+1} = \\hat{\\mu}_n^{l+1}')
('8.0.0', '{}^l\\hat{\\mu}_M^{l+2:L}')
('8.0.0', '^{l+1}\\hat{\\mu}_M^{l+2:L}')
('8.0.0', '\\hat{m}_n^{l+1} = \\hat{\\mu}_n^{l+1}')
('8.0.0', '\\label{eq:stepmean1}\n\t\\begin{aligned}\n\t&\\hat{m}_n^{l+1} = \\widetilde{\\mathcal{K}}_{nM}^{l+1}\\left({}^l\\hat{\\mu}_M^{l+1} + \\left( {}^l\\hat{\\Sigma}_{nM}^{l+1,l} \\right)^\\top \\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}(f_n^l - \\hat{\\mu}_n^l) \\right)\\\\\n\t=\\ &\\widetilde{\\mu}_n^{l+1} + \\widetilde{S}_n^{l+1,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1}\\left(f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}\\right) + \\left( \\widetilde{S}_n^{l+1,l} - \\widetilde{S}_n^{l+1,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1}\\widetilde{S}_n^{1:l-1,l} \\right) \\times \\\\ \n\t&\\left(\\hat{\\Sigma}_n^{l}\\right)^{-1}\\left( f_n^l - \\widetilde{\\mu}_n^{l}  - \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1}\\left(f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}\\right) \\right),\n\t\\end{aligned}')
('8.0.0', '\\hat{\\cdot}')
('8.0.0', '\\hat{\\Sigma}_n^l')
('8.0.0', '\\widetilde{\\mu}_n')
('8.0.0', '\\widetilde{S}_n')
('8.0.0', '\\widetilde{\\mathcal{K}}')
('8.0.0', '\\label{eq:stepmeandef1}\n\tA = \\widetilde{S}_n^{1:l-1,1:l-1} , \\qquad  B = \\widetilde{S}_n^{1:l-1,l}, \\qquad C = \\widetilde{S}_n^{l,1:l-1},\n\t\\qquad \\widetilde{D} =\\hat{\\Sigma}^l_n,')
('8.0.0', '\\label{eq:stepmean2}\n\t\\hat{m}_n^{l+1} = \\widetilde{\\mu}_n^{l+1} +\n\t\\begin{pmatrix*}[c]\n\t\\widetilde{S}_n^{l+1,1:l-1} A^{-1} - \\left( \\widetilde{S}_n^{l+1,l} - \\widetilde{S}_n^{l+1,1:l-1} A^{-1} B \\right) \\widetilde{D}^{-1} C A^{-1} \\\\\n\t\\left( \\widetilde{S}_n^{l+1,l} - \\widetilde{S}_n^{l+1,1:l-1} A^{-1} B \\right) \\widetilde{D}^{-1}\n\t\\end{pmatrix*}^\\top\n\t\\begin{pmatrix}\n\tf_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1} \\\\ f_n^l - \\widetilde{\\mu}_n^l\n\t\\end{pmatrix}')
('8.0.0', '\\label{eq:stepmean3}\t\n\t\\hat{m}_n^{l+1} = \\widetilde{\\mu}_n^{l+1} + \\begin{pmatrix}\n\t\\widetilde{S}_n^{l+1,1:l-1} \\\\ \\widetilde{S}_n^{l+1,l}\n\t\\end{pmatrix}^\\top \n\t\\begin{pmatrix}\n\tA^{-1} + A^{-1}B\\widetilde{D}^{-1}CA^{-1} & -A^{-1}B\\widetilde{D}^{-1} \\\\\n\t-\\widetilde{D}^{-1}CA^{-1} & \\widetilde{D}^{-1}\n\t\\end{pmatrix}\n\t\\begin{pmatrix}\n\tf_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1} \\\\ f_n^l - \\widetilde{\\mu}_n^l\n\t\\end{pmatrix},')
('8.0.0', 'A')
('8.0.0', '\\widetilde{D}')
('8.0.0', 'B^\\top = C')
('8.0.0', '\\label{eq:blockinv}\n\t\\begin{pmatrix}\n\tA & B \\\\\n\tC & D\n\t\\end{pmatrix}^{-1} = \n\t\\begin{pmatrix}\n\tA^{-1} + A^{-1}B\\widetilde{D}^{-1}CA^{-1} & -A^{-1}B\\widetilde{D}^{-1} \\\\\n\t-\\widetilde{D}^{-1}CA^{-1} & \\widetilde{D}^{-1}\n\t\\end{pmatrix},')
('8.0.0', '\\widetilde{D} = D - CA^{-1}B')
('8.0.0', '\\hat{\\Sigma}_n^l = \\widetilde{S}_n^{ll} - \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} \\widetilde{S}_n^{1:l-1,l}')
('8.0.0', '\\widetilde{S}_n^{ll}= D')
('8.0.0', '\\label{eq:stepmeanfinal}\n\t\\begin{aligned}\n\t\\hat{m}_n^{l+1} &= \\widetilde{\\mu}_n^{l+1} + \\begin{pmatrix}\n\t\\widetilde{S}_n^{l+1,1:l-1} \\\\[2mm] \\widetilde{S}_n^{l+1,l}\n\t\\end{pmatrix}^\\top \\begin{pmatrix}\n\t\\widetilde{S}_n^{1:l-1,1:l-1} & \\widetilde{S}_n^{1:l-1,l} \\\\[2mm]\n\t\\widetilde{S}_n^{l,1:l-1} & \\widetilde{S}_n^{ll}\n\t\\end{pmatrix}^{-1}\n\t\\begin{pmatrix}\n\tf_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1} \\\\[2mm] f_n^l - \\widetilde{\\mu}_n^l\n\t\\end{pmatrix} \\\\\n\t&= \\widetilde{\\mu}_n^{l+1} + \\widetilde{S}_n^{l+1,1:l} \\left( \\widetilde{S}_n^{1:l,1:l}\\right)^{-1}\n\t\\left( f_n^{1:l} - \\widetilde{\\mu}_n^{1:l}\\right).\n\t\\end{aligned}')
('8.0.0', '\\hat{\\mu}^{l+1}_n')
('8.0.0', 'l\\to l+1')
('9.0', '\\label{eq:appxheurmain}\n\\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M = \\prod_{l=1}^{L} q(f_n^l | f_n^1,\\dots,f_n^{l-1}),')
('9.0', 'q')
('9.0', 'q(f_M) = \\mathcal{N}\\left( f_M \\middle| \\mu_M, S_M \\right)')
('9.0', '\\label{eq:appxheurqfM}\nq(f_M^{1:L}) = \\mathcal{N}\\left( f_M^{1:L} \\middle| \\mu_M^{1:L}, S_M^{1:L,1:L} \\right) = q\n\\begin{pmatrix}\nf_M^1\\\\\n\\vdots\\\\\nf_M^L\n\\end{pmatrix} = \\mathcal{N}\n\\left(\n\\begin{pmatrix}\nf_M^1\\\\\n\\vdots\\\\\nf_M^L\n\\end{pmatrix}\n\\middle|\n\\begin{pmatrix}\n\\mu_M^1\\\\\n\\vdots\\\\\n\\mu_M^L\n\\end{pmatrix},\n\\begin{pmatrix}\nS_M^{11} & \\cdots & S_M^{1L}\\\\\n\\vdots & \\ddots & \\vdots\\\\\nS_M^{L1} & \\cdots & S_M^{LL}\n\\end{pmatrix}\n\\right),')
('9.0', '\\label{eq:appxpheurcond}\np(f_n^l | f_M^l; f_n^{l-1}) = \\mathcal{N}\\left(  f_n^l  \\middle|  \\widetilde{\\mathcal{K}}_{nM}^l f_M^l,  \\widetilde{\\mathcal{K}}_{nn}^l  \\right),')
('9.0', '\\begin{aligned}\n{2}\\label{eq:appxheurKnM}\n&\\widetilde{\\mathcal{K}}_{nM}^l &&= \\mathcal{K}_{nM}^l \\left( \\mathcal{K}_{MM}^l \\right)^{-1} \\\\ \\label{eq:appxheurKnn}\n&\\widetilde{\\mathcal{K}}_{nn}^l &&= \\mathcal{K}_{nn}^l - \\mathcal{K}_{nM}^l \\left( \\mathcal{K}_{MM}^l \\right)^{-1} \\mathcal{K}_{Mn}^l.\n\\end{aligned}')
('9.0', '\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1})')
('9.0', '\\label{eq:appxheurpfn}\np(f_n | f_M) =\n\\mathcal{N}\n\\left(\n\\begin{pmatrix}\nf_n^1\\\\\n\\vdots\\\\\nf_n^L\n\\end{pmatrix}\n\\middle|\n\\begin{pmatrix}\n\\widetilde{\\mathcal{K}}_{nM}^1 & 0 & 0\\\\\n0 & \\ddots & 0\\\\\n0 & 0 & \\widetilde{\\mathcal{K}}_{nM}^L\n\\end{pmatrix}\n\\begin{pmatrix}\nf_M^1\\\\\n\\vdots\\\\\nf_M^L\n\\end{pmatrix},\n\\begin{pmatrix}\n\\widetilde{\\mathcal{K}}_{nn}^1 & 0 & 0\\\\\n0 & \\ddots & 0\\\\\n0 & 0 & \\widetilde{\\mathcal{K}}_{nn}^L\n\\end{pmatrix}\n\\right).\n%\\gauss{f_n}{\\text{diag} (\\widetilde{\\mathcal{K}}_{nM}^1, \\dots, \\widetilde{\\mathcal{K}}_{nM}^L) f_M}{\\text{diag} (\\widetilde{\\mathcal{K}}_{nn}^1, \\dots, \\widetilde{\\mathcal{K}}_{nn}^L)}.')
('9.0', 'f_n^l')
('9.0', '\\widetilde{\\mathcal{K}}_{nn}^{l+1}')
('9.0', '\\label{eq:gaintheur}\n\\int\\mathcal{N}\\left( x \\middle| a + Fy, A \\right)\\mathcal{N}\\left( y \\middle| b, B \\right) dy = \\mathcal{N}\\left( x \\middle| a + Fb, A +FBF^\\top \\right),')
('9.0', '\\label{eq:appxheurhacky}\nq(f_n) = \\int q(f_M) p(f_n | f_M) df_M =\n\\mathcal{N}\\left( \n\t\\begin{pmatrix}\n\tf_n^1\\\\\n\t\\vdots\\\\\n\tf_n^L\n\t\\end{pmatrix} \\middle| \n\t\\begin{pmatrix}\n\t\\widetilde{\\mu}_n^1\\\\\n\t\\vdots\\\\\n\t\\widetilde{\\mu}_n^L\n\t\\end{pmatrix}, \n\t\\begin{pmatrix}\n\t\\widetilde{S}_n^{11} & \\cdots & \\widetilde{S}_n^{1L}\\\\\n\t\\vdots & \\ddots & \\vdots\\\\\n\t\\widetilde{S}_n^{L1} & \\cdots & \\widetilde{S}_n^{LL}\n\t\\end{pmatrix} \\right),')
('9.0', "\\begin{aligned}\n\\label{eq:appxheurmutilde}\n\\widetilde{\\mu}_n^l &= \\widetilde{\\mathcal{K}}^l_{nM} \\mu_M^l, \n\\\\\n\\label{eq:appxheurStilde}\n\\widetilde{S}_n^{ll'} &= \\delta_{ll'} \\mathcal{K}^l_{nn} - \\widetilde{\\mathcal{K}}^l_{nM} \\left(\\delta_{ll'} \\mathcal{K}^l_{MM} - S_M^{ll'}\\right) \\widetilde{\\mathcal{K}}^{l'}_{Mn}.\n\\end{aligned}")
('9.0', '\\widetilde{\\mu}_n^l')
('9.0', "\\widetilde{S}_n^{ll'}")
('9.0', 'f_n^{l-1}')
('9.0', '\\label{eq:gacondheur}\n\\mathcal{N}\\left( \\begin{pmatrix}\n\tx\\\\ y\n\t\\end{pmatrix} \\middle| \\begin{pmatrix}\n\ta \\\\ b\n\t\\end{pmatrix}, \\begin{pmatrix}\n\tA & C \\\\\n\tC^\\top & B\n\t\\end{pmatrix} \\right) = \\mathcal{N}\\left( x \\middle| a, A \\right)\\mathcal{N}\\left( y \\middle| b + C^\\top A^{-1}(x-a), B - C^\\top A^{-1} C \\right),')
('9.0', '\\label{eq:heursamplingfc}\nq(f_n) =  \\prod_{l=1}^{L} q(f_n^l | f_n^1,\\dots,f_n^{l-1}) \n\\quad \\text{where} \\quad  q(f_n^l | f_n^1,\\dots,f_n^{l-1}) = \\mathcal{N}\\left( f_n^l \\middle| \\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l \\right),')
('9.0', '\\begin{aligned}\n\\label{eq:heurmuhatn}\n\\hat{\\mu}_n^l \\! &= \\! \\widetilde{\\mu}_n^l + \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} ( f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}), \n\\\\\n\\label{eq:heurSigmahatn}\n\\hat{\\Sigma}_n^l \\!  &= \\! \\widetilde{S}_n^{ll} - \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} \\widetilde{S}_n^{1:l-1,l}. \n\\end{aligned}')
('9.0', "A^{l,1:l'}")
('9.0', 'A')
('9.0', "{A}^{l,1:l'} = \\left(A^{l,1} \\cdots A^{l,l'} \\right)")
('9.1', '\\label{eq:appxmf}\nq(f_n^L) = \\int \\prod_{l=1}^{L} q(f_n^l;f_n^{l-1})df_n^{1}\\cdots df_n^{L-1},\n\\quad \\text{where} \\quad\nq(f_n^l;f_n^{l-1}) = \\prod_{t=1}^{T_l} \\mathcal{N}\\left( f_n^{l,t} \\middle| \\widetilde{\\mu}_n^{l,t}, \\widetilde{\\Sigma}_n^{l,t} \\right),')
('9.1', '\\label{eq:appxmfmeanvar}\n{\\widetilde{\\mu}_n^{l,t}}   =  \\widetilde{K}^l_{nM}\\mu^{l,t}_M,\n\\quad\n{\\widetilde{\\Sigma}_n^{l,t}} =  K^l_{nn} -\n\\widetilde{K}^l_{nM}\\left(K^l_{MM} - S^{l,t}_M\\right) \\widetilde{K}^l_{Mn}.')
('9.1', '\\label{eq:appxfc}\nq(f_n^L) = \\int \\prod_{l=1}^{L} q(f_n^l | f_n^1,\\dots,f_n^{l-1})  df_n^{1}\\cdots df_n^{L-1}\n\\quad \\text{where} \\quad\nq(f_n^l | f_n^1,\\dots,f_n^{l-1}) = \\mathcal{N}\\left( f_n^l \\middle| \\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l \\right),')
('9.1', '\\begin{aligned}\n\\label{eq:appxfcmean}\n\\hat{\\mu}_n^l \\! &= \\! \\widetilde{\\mu}_n^l + \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} ( f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}), \n\\\\\n\\label{eq:appxfcvar}\n\\hat{\\Sigma}_n^l \\!  &= \\! \\widetilde{S}_n^{ll} - \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} \\widetilde{S}_n^{1:l-1,l}, \n\\end{aligned}')
('9.1', "\\begin{aligned}\n\\label{eq:appxfcmutilde}\n\\widetilde{\\mu}_n^l &= \\widetilde{\\mathcal{K}}^l_{nM} \\mu_M^l, \n\\\\\n\\label{eq:appxfcStilde}\n\\widetilde{S}_n^{ll'} &= \\delta_{ll'} \\mathcal{K}^l_{nn} - \\widetilde{\\mathcal{K}}^l_{nM} \\left(\\delta_{ll'} \\mathcal{K}^l_{MM} - S_M^{ll'}\\right) \\widetilde{\\mathcal{K}}^{l'}_{Mn}.\n\\end{aligned}")
('9.1', '\\mathcal{K}^l  = \\left(\\mathbb{I}_{T_l} \\otimes K^l\\right)')
('9.1', '\\mathbb{I}_{T_l}')
('9.1', 'K^l')
('9.1', '\\delta')
('9.1', 'S_M = \\text{diag}(\\{S_M^{ll}\\}_{l=1}^L)')
('9.1', 'S_M^{ll} = \\text{diag}(\\{S_M^{l,t}\\}_{t=1}^{T_l})')
('9.1', 'S_M = \\text{diag}(\\{S_M^{ll}\\}_{l=1}^L)')
('9.1', "\\tilde{S}_n^{ll'} = 0")
('9.1', "l\\neq l'")
('9.1', '\\hat{\\mu}_n^l = \\widetilde{\\mu}_n^l')
('9.1', '\\hat{\\Sigma}_n^l = \\widetilde{S}_n^{ll}')
('9.1', 'q(f_n^l ;f_n^{l-1}) = \\mathcal{N}\\left( f_n^l \\middle| \\widetilde{\\mu}_n^l, \\widetilde{S}_n^{ll} \\right)')
('9.1', '\\widetilde{\\mu}_n^l = (\\widetilde{\\mu}_n^{l,1},\\dots,\\widetilde{\\mu}_n^{l,T_l})')
('9.1', 'S_M^{ll} = \\text{diag}(\\{S_M^{l,t}\\}_{t=1}^{T_l})')
('9.1', '{\\widetilde{S}_n^{ll}}')
('9.1', 'S_M^{ll} = \\text{diag}(\\{S_M^{l,t}\\}_{t=1}^{T_l})')
('9.1', '\\widetilde{\\Sigma}_n^{l,t}')
('10', '\\label{eq:appxelbofinal}\n\\mathcal{L} = \\sum_{n=1}^{N}\\mathbb{E}_{q(f_n^L)} \\left[\\log p(y_n|f_n^L)\\right] - \\text{KL}[q(f_M)||\\prod_{l=1}^{L}p(f_M^l)].')
('10', '\\begin{aligned}\n \\label{eq:appxelbogen}\n\\mathcal{L} &= \\int q(f_N,f_M)\\log \\frac{p(y_N,f_N,f_M)}{q(f_N,f_M)} df_N df_M,\\\\\np(y_N,f_N,f_M) &= p(y_N|f_N^L)\\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1})p(f_M^l),\\\\\nq(f_N,f_M) &= q(f_M)\\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1}), \n\\end{aligned}')
('10', 'p(y_N|f_N^L) = \\prod_{n=1}^N p(y_n|f_n^L)')
('10', '\\begin{aligned}\n\\mathcal{L} &= \\int q(f_N,f_M)\\log \\frac{p(y_N,f_N,f_M)}{q(f_N,f_M)} df_N df_M\n = \\int q(f_N,f_M) \\log \\frac{p(y_N|f_N^L) \\prod_{l=1}^{L} p(f_M^l)}{q(f_M)} df_N df_M\\\\\n &= \\int q(f_N,f_M) \\log p(y_N|f_N^L) df_N df_M + \n \\int q(f_N,f_M) \\log \\frac{\\prod_{l=1}^{L} p(f_M^l)}{q(f_M)} df_N df_M,\\\\\n &= \\int q(f_N,f_M) \\log \\prod_{n=1}^N p(y_n|f_n^L) df_N df_M + \n \\int q(f_M) \\log \\frac{\\prod_{l=1}^{L} p(f_M^l)}{q(f_M)} df_M,\\\\\n &= \\sum_{n=1}^{N} \\int q(f_n^L) \\log p(y_n|f_n^L) df_n^L -\\text{KL}[q(f_M)||\\prod_{l=1}^{L}p(f_M^l)].\n \n\\end{aligned}')
('10', 'q(f_n^L)')
('10', "\\label{eq:appxqfnL}\nq(f_n^L) = \\int q(f_N,f_M) df_M \\prod_{n'\\neq n} df_{n'}^L \\prod_{l=1}^{L-1} df_N^l.")
('11', 'q(f_n^L)')
('11', "f_{n'}^l")
('11', 'l')
('11', "n' \\neq n")
('11', '\\label{eq:appxqfnLproof}\nq(f_n^L) = \\int \\left[ \\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M \\right] df_n^{1}\\cdots df_n^{L-1}.')
('11', 'q(f_n^L)')
('11', '\\label{eq:appxreminder}\nq(f_N,f_M) = q(f_M)\\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1}), \\qquad\np(f_N^l|f_M^l;f_N^{l-1}) = \\mathcal{N}\\left(  f_N^l  \\middle|  \\widetilde{\\mathcal{K}}_{NM}^l f_M^l ,  \\widetilde{\\mathcal{K}}_{NN}^l \\right),')
('11', '\\widetilde{\\mathcal{K}}_{NM}^l = \\mathcal{K}_{NM}^l \\left( \\mathcal{K}_{MM}^l \\right)^{-1}')
('11', '\\widetilde{\\mathcal{K}}_{NN}^l = \\mathcal{K}_{NN}^l - \\mathcal{K}_{NM}^l \\left( \\mathcal{K}_{MM}^l \\right)^{-1} \\mathcal{K}_{MN}^l')
('11', "\\label{eq:appxqfnLexplicit}\nq(f_n^L) = \\int q(f_M) \\left[ \\int \\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1})  \\prod_{n'\\neq n} df_n^L \\prod_{l=1}^{L-1} df_N^l \\right] df_M.")
('11', "\\label{eq:appxqfnLinner}\n \\int \\left( \\int p(f_N^L|f_M^L;f_N^{L-1})  \\prod_{n'\\neq n}  df^L_{n'} \\right) \\prod_{l=1}^{L-1} p(f_N^l|f_M^l;f_N^{l-1})  df_N^{l}.")
('11', "\\begin{aligned}\n\\int p(f_N^L|f_M^L;f_N^{L-1}) \\prod_{n'\\neq n}  df^L_{n'} &= \\int \\mathcal{N}\\left(  f_N^L  \\middle|  \\widetilde{\\mathcal{K}}_{NM}^L (f_N^{L-1}) f_M^L ,  \\widetilde{\\mathcal{K}}_{NN}^L (f_N^{L-1}) \\right) \\prod_{n'\\neq n}  df^L_{n'}\\\\\n&= \\mathcal{N}\\left(  f_n^L  \\middle|  \\widetilde{\\mathcal{K}}_{nM}^L (f_N^{L-1}) f_M^L ,  \\widetilde{\\mathcal{K}}_{nn}^L (f_N^{L-1}) \\right),\n\\end{aligned}")
('11', '\\widetilde{\\mathcal{K}}^L')
('11', 'f_N^{L-1}')
('11', '\\widetilde{\\mathcal{K}}^l_{nM}')
('11', '\\widetilde{\\mathcal{K}}^l_{nn}')
('11', 'f_n^{L-1}')
('11', '\\mathcal{N}\\left(  f_n^L  \\middle|  \\widetilde{\\mathcal{K}}_{nM}^L (f_N^{L-1}) f_M^L ,  \\widetilde{\\mathcal{K}}_{nn}^L (f_N^{L-1}) \\right) = \\mathcal{N}\\left(  f_n^L  \\middle|  \\widetilde{\\mathcal{K}}_{nM}^L (f_n^{L-1}) f_M^L ,  \\widetilde{\\mathcal{K}}_{nn}^L (f_n^{L-1}) \\right) = p(f_n^L | f_M^L; f_n^{L-1}).')
('11', "\\int p(f_N^L|f_M^L;f_N^{L-1}) \\prod_{n'\\neq n}  df^L_{n'} = p(f_n^L | f_M^L; f_n^{L-1}).")
('11', 'f_N^l')
('11', 'f_n^l')
('11', "\\int \\prod_{l=1}^{L}p(f_N^l|f_M^l;f_N^{l-1})  \\prod_{n'\\neq n} df_n^L \\prod_{l=1}^{L-1} df_N^l = \\int \\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_n^{1}\\cdots df_n^{L-1}.")
('11', '\\label{eq:appxqfnLproof2}\nq(f_n^L) = \\int \\left[ \\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M \\right] df_n^{1}\\cdots df_n^{L-1},')
('11.0', '\\label{eq:appxpost}\nq(f_M) = \\begin{cases}\n\\mathcal{N}\\left( f_M \\middle| \\mu_M, S_M \\right) & \\text{for the FC DGP,} \\\\\n\\prod_{l=1}^L\\prod_{t=1}^{T_l} \\mathcal{N}\\left( f_M^{l,t} \\middle| \\mu_M^{l,t}, S_M^{l,t} \\right) & \\text{for the MF DGP.}\n\\end{cases}')
('11.0', 'q(f_M)')
('11.0', 'q(f_M) = \\prod_{l=1}^L q(f_M^l)')
('11.0', 'l')
('11.0', '\\int q(f_M)\\prod_{l=1}^L p(f_n^l | f_M^l; f_n^{l-1}) df_M =  \\prod_{l=1}^L \\int q(f_M^l) p(f_n^l | f_M^l; f_n^{l-1}) df_M^l,')
('12', '\\widetilde{S}_n^{l,1:l-1}')
('12', '\\left(\\widetilde{S}_n^{1:l-1,1:l-1}\\right)^{-1}')
('12', '\\hat{\\mu}^l_n')
('12', '\\hat{\\Sigma}^l_n')
('12', 'S_M')
('12', "\\begin{aligned}\n{2} \\label{eq:appxmuhatn}\n&\\hat{\\mu}_n^l &&= \\widetilde{\\mu}_n^l + \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} ( f_n^{1:l-1} - \\widetilde{\\mu}_n^{1:l-1}), \\\\ \\label{eq:appxSigmahatn}\n&\\hat{\\Sigma}_n^l &&= \\widetilde{S}_n^{ll} - \\widetilde{S}_n^{l,1:l-1} \\left( \\widetilde{S}_n^{1:l-1,1:l-1} \\right)^{-1} \\widetilde{S}_n^{1:l-1,l},\n\\\\ \\label{eq:appxStilden}\n&\\widetilde{S}_n^{ll'} &&=  \\left(\\widetilde{\\mathcal{K}}^l_{Mn}\\right)^\\top S_M^{ll'} \\widetilde{\\mathcal{K}}^{l'}_{Mn}, \\qquad \\text{ if } l \\neq l'.\n\\end{aligned}")
('12', 'S_M')
('12', "\\label{eq:Sm}\nS_M = \n\\begin{pmatrix}\nS_M^{11} & \\cdots & S_M^{1L}\\\\\n\\vdots & \\ddots & \\vdots\\\\\nS_M^{L1} & \\cdots & S_M^{LL}\n\\end{pmatrix},\\qquad\nS_M^{ll'} =\n\\begin{pmatrix}\n\\left(S_M^{ll'}\\right)_{11} & \\cdots & \\left(S_M^{ll'}\\right)_{1T_{l'}}\\\\\n\\vdots & \\ddots & \\vdots\\\\\n\\left(S_M^{ll'}\\right)_{T_l1} & \\cdots & \\left(S_M^{ll'}\\right)_{T_lT_{l'}}\n\\end{pmatrix},")
('12', 'S_M')
('12', "S_M^{ll'}")
('12', "\\left(S_M^{ll'}\\right)_{tt'}")
('12', 'M T \\times M T')
('12', 'T = \\sum_{l=1}^{L} T_l')
('12', "MT_l\\times MT_{l'}")
('12', 'M \\times M')
('12', 'l')
('12', "l'")
('12', 't')
('12', 'l')
('12', "t'")
('12', "l'")
('12', 'S_M')
('12', 'L_S')
('12', 'S_M = L_SL_S^\\top')
('12', 'S_M')
('12', 'L_S')
('12.0.0', '\\label{eq:Snlsub}\n\\widetilde{S}_n^{l,1:l-1} = \\begin{pmatrix}\n\\widetilde{S}_n^{l1} & \\widetilde{S}_n^{l2} & \\cdots & \\widetilde{S}_n^{l,l-1}\n\\end{pmatrix},')
('12.0.0', "T_l \\times \\sum_{l'=1}^{l-1} T_{l'}")
('12.0.0', 'l=1,\\dots,L')
('12.0.0', 'n=1,\\dots,N')
('12.0.0', 'L')
('12.0.0', "\\widetilde{S}_n^{ll'}")
('12.0.0', 'N')
('12.0.0', '\\widetilde{\\mathcal{K}}^{l}_{Mn} = \\mathbb{I}_{T_l} \\otimes \\widetilde{K}^{l}_{Mn}')
('12.0.0', "T_l,T_{l'} = 2")
('12.0.0', "\\label{eq:Snll'}\n\\widetilde{S}_n^{ll'} =\n\\begin{pmatrix}\n\\left(\\widetilde{K}^{l}_{Mn}\\right)^\\top (S_M^{ll'})_{11} \\widetilde{K}^{l'}_{Mn} &\n\\left(\\widetilde{K}^{l}_{Mn}\\right)^\\top (S_M^{ll'})_{12} \\widetilde{K}^{l'}_{Mn}\\\\\n\\left(\\widetilde{K}^{l}_{Mn}\\right)^\\top (S_M^{ll'})_{21} \\widetilde{K}^{l'}_{Mn} &\n\\left(\\widetilde{K}^{l}_{Mn}\\right)^\\top (S_M^{ll'})_{22} \\widetilde{K}^{l'}_{Mn}\n\\end{pmatrix}.")
('12.0.0', "\\widetilde{S}_n^{ll'}")
('12.0.0', "\\widetilde{\\mathcal{K}}_{nM}^l S_M^{ll'} \\widetilde{\\mathcal{K}}_{Mn}^{l'}")
('12.0.0', '\\widetilde{\\mathcal{K}}_{Mn}^{l}')
('12.0.0', '\\left(\\widetilde{K}^{l}_{Mn}\\right)^\\top')
('12.0.0', "\\widetilde{K}^{l'}_{Mn}")
('12.0.0', "T_l T_{l'}")
('12.0.0', 'M\\times M')
('12.0.0', "S_M^{ll'}")
('12.0.0', 'n=1,\\dots,N')
('12.0.0', 'L=3')
('12.0.0', '\\label{eq:traceSM}\nS_M = \n\\begin{pmatrix}\nS_M^{11} & S_M^{12} & S_M^{13}\\\\\nS_M^{21} & S_M^{22} & S_M^{23}\\\\\nS_M^{31} & S_M^{32} & S_M^{33}\n\\end{pmatrix}\n= L_S L_S^\\top =\n\\begin{pmatrix}\nL_S^{11} & 0 & 0\\\\\nL_S^{21} & L_S^{22} & 0\\\\\nL_S^{31} & L_S^{32} & L_S^{33}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\left(L_S^{11}\\right)^\\top & \\left(L_S^{21}\\right)^\\top & \\left(L_S^{31}\\right)^\\top\\\\\n0 & \\left(L_S^{22}\\right)^\\top & \\left(L_S^{32}\\right)^\\top\\\\\n0 & 0 & \\left(L_S^{33}\\right)^\\top\n\\end{pmatrix}.')
('12.0.0', 'S_M')
('12.0.0', 'S_M^{32} = \\begin{pmatrix} L_S^{31} & L_S^{32} \\end{pmatrix}\n\\begin{pmatrix} L_S^{21} & L_S^{22} \\end{pmatrix}^\\top')
('12.0.0', "\\label{eq:SMll'}\nS_M^{ll'} = L_S^{l,1:l'}\\left(L_S^{l',1:l'}\\right)^\\top,")
('12.0.0', "S_M^{ll'}")
('12.0.0', "l'<l")
('12.0.0', "l' \\geq l")
('12.0.0', 'N')
('12.0.0', '\\left(\\widetilde{S}_n^{ll} \\right)_{11}')
('12.0.0', 'n')
('12.0.0', 'N \\times N')
('12.0.0', "\\left(\\widetilde{K}^{l}_{MN}\\right)^\\top (S_M^{ll'})_{11} \\widetilde{K}^{l'}_{MN}")
('12.0.0', 'q \\times p')
('12.0.0', 'A,\\ C^\\top')
('12.0.0', 'q \\times q')
('12.0.0', 'B')
('12.0.0', '\\label{eq:diagtrick}\n\\text{diag}\\left(C^\\top BA\\right) = \\text{column\\_sum}(C^\\top \\odot BA),')
('12.0.0', '\\odot')
('12.0.0', "\\widetilde{S}_n^{ll'}")
('12.0.0', "S_M^{ll'}")
('12.0.0', "\\mathcal{O}(M^3T_lT_{l'}\\sum_{l''=1}^{l'} T_{l''})")
('12.0.0', "(S_M^{ll'})_{11} \\widetilde{K}^{l'}_{MN}")
('12.0.0', "T_lT_{l'}")
('12.0.0', "S_M^{ll'}")
('12.0.0', "\\mathcal{O}(NM^2T_lT_{l'})")
('12.0.0', "l' = 1, \\dots, l-1")
('12.0.0', 'l=1,\\dots,L')
('12.0.0', "\\mathcal{O}(M^3 \\sum_{l=1}^L T_l \\sum_{l'=1}^{l-1} T_{l'} \\sum_{l''=1}^{l'} T_{l''} + N M^2 \\sum_{l=1}^L T_l \\sum_{l'=1}^{l-1} T_{l'})")
('12.0.0.0', '\\left(\\widetilde{S}_n^{1:l-1,1:l-1}\\right)^{-1}')
('12.0.0.0', 'L_{Sn}^{1:l-1,1:l-1}')
('12.0.0.0', '\\label{eq:cholSn}\nL_{Sn}^{1:l-1,1:l-1} \\left(L_{Sn}^{1:l-1,1:l-1}\\right)^\\top = \\widetilde{S}_n^{1:l-1,1:l-1}.')
('12.0.0.0', '\\widetilde{S}_n^{l,1:l-1} \\left(\\widetilde{S}_n^{1:l-1,1:l-1}\\right)^{-1}')
('12.0.0.0', '\\hat{\\mu}^2_n')
('12.0.0.0', '\\hat{\\Sigma}^2_n')
('12.0.0.0', '\\widetilde{L}_{Sn}^{11}')
('12.0.0.0', '\\widetilde{S}_n^{12}')
('12.0.0.0', '\\widetilde{S}_n^{22}')
('12.0.0.0', '\\widetilde{S}_n^{1:2,1:2}')
('12.0.0.0', '\\label{eq:cholup2}\n\\widetilde{S}_n^{1:2,1:2} =\n\\begin{pmatrix}\n\\widetilde{L}_{Sn}^{11} \\left(\\widetilde{L}_{Sn}^{11}\\right)^\\top & \\widetilde{S}_n^{12} \\\\\n\\left(\\widetilde{S}_n^{12}\\right)^\\top & \\widetilde{S}_n^{22},\n\\end{pmatrix}')
('12.0.0.0', '\\label{eq:cholup3}\n\\widetilde{L}_{Sn}^{1:2,1:2} =\n\\begin{pmatrix}\nA & 0\\\\\nB & C\n\\end{pmatrix},')
('12.0.0.0', '\\begin{aligned}\n\\label{eq:cholup41}\nAA^\\top &= \\widetilde{L}_{Sn}^{11} \\left(\\widetilde{L}_{Sn}^{11}\\right)^\\top, \\\\\\label{eq:cholup42}\nAB^\\top &= \\widetilde{S}_n^{12},\n\\\\\\label{eq:cholup43}\nBB^\\top + CC^\\top &= \\widetilde{S}_n^{22}.\n\\end{aligned}')
('12.0.0.0', 'A = \\widetilde{L}_{Sn}^{11}')
('12.0.0.0', 'B^\\top')
('12.0.0.0', '\\widetilde{L}_{Sn}^{11}B^\\top = \\widetilde{S}_n^{12}')
('12.0.0.0', 'C')
('12.0.0.0', '\\widetilde{S}_n^{22} - BB^\\top')
('12.0.0.0', 'l')
('12.0.0.0', '\\widetilde{S}_n^{1:2,1:2}')
('12.0.0.0', 'l')
('12.0.0.0', '\\widetilde{L}_{Sn}^{11}\\rightarrow \\widetilde{L}_{Sn}^{1:l-1,1:l-1}')
('12.0.0.0', '\\widetilde{S}_n^{12} \\rightarrow \\widetilde{S}_n^{1:l-1,l}')
('12.0.0.0', '\\widetilde{S}_n^{22} \\rightarrow \\widetilde{S}_n^{ll}')
('12.0.0.0', 'A')
('12.0.0.0', 'B')
('12.0.0.0', 'C')
('12.0.0.0', 'l')
('12.0.0.0', "\\mathcal{O}(N(T_l^2 \\sum_{l'=1}^{l-1} T_{l'} + T_l (\\sum_{l'=1}^{l-1} T_{l'})^2 + T_l^3))")
('12.0.0.0', "\\mathcal{O}(N\\sum_{l=1}^{L-1} (T_l^2 \\sum_{l'=1}^{l-1} T_{l'} + T_l (\\sum_{l'=1}^{l-1} T_{l'})^2 + T_l^3))")
('12.0.0.1', "\\label{eq:compcos}\n\\mathcal{O}\\left(N \\sum_{l=1}^L \\left[M^2 T_l \\sum_{l'=1}^{l-1} T_{l'} + T_l^2 \\sum_{l'=1}^{l-1} T_{l'} + T_l (\\sum_{l'=1}^{l-1} T_{l'})^2 + T_l^3 + \\frac{M^3}{N} T_l \\sum_{l'=1}^{l-1} T_{l'} \\sum_{l''=1}^{l'} T_{l''} \\right]\\right).")
('12.0.0.1', 'L')
('12.0.0.1', 'T_l = \\tau')
('12.0.0.1', 'T_L=1')
('12.0.0.1', '\\label{eq:compcostfc}\n\\mathcal{O}(NM^2\\tau^2L^2 + N \\tau^3 L^3 + M^3\\tau^3L^3),')
('12.1', 'M\\times M')
('12.1', "\\left(S_M^{ll'}\\right)_{tt'}")
('12.1', "t=t'")
('12.1', 'l = L')
('12.1', "l'=L")
('12.1', 'L_S')
('12.1', 'M\\times M')
('12.1', "\\left(L_S^{ll'}\\right)_{tt'}")
('12.1', "l\\geq l'")
('12.1', "t=t'")
('12.1', 'l = L')
('12.1.0', 'S_M')
('12.1.0', 'L_S')
('12.1.0', '^\\text{diag}L_S')
('12.1.0', '^\\text{stripes}L_S')
('12.1.0', '^\\text{arrow}L_S')
('12.1.0', '^\\text{diag}L_S')
('12.1.0', '\\tau (L-1) +1')
('12.1.0', 'M\\times M')
('12.1.0', 'L_S')
('12.1.0', 't')
('12.1.0', 'l')
('12.1.0', '\\left(L_S^{ll}\\right)_{tt}')
('12.1.0', '^\\text{diag}L_S^{l,t}')
('12.1.0', '^\\text{stripes}L_S')
('12.1.0', '\\tau \\sum_{k=1}^{L-2}k= \\frac{\\tau}{2}(L-2)(L-1)')
('12.1.0', 'M\\times M')
('12.1.0', 'L_S')
('12.1.0', "\\left(L_S^{ll'}\\right)_{tt}")
('12.1.0', "L > l > l'")
('12.1.0', "^\\text{stripes}L_S^{l,l',t}")
('12.1.0', '\\tau (L-1)')
('12.1.0', 'M \\times M')
('12.1.0', '^\\text{arrow}L_S')
('12.1.0', '\\left(L_S^{Ll}\\right)_{1t}')
('12.1.0', '^\\text{arrow}L_S^{l,t}')
('12.1.0', 'S_M')
('12.1.0', '\\left(S_M^{ll}\\right)_{tt}')
('12.1.0', 'l < L')
('12.1.0', "\\left(S_M^{ll}\\right)_{tt} =\\ ^\\text{diag}L_S^{l,t} \\left(^\\text{diag}L_S^{l,t}\\right)^\\top + \\sum_{l' = 1}^{l-1}\\  ^\\text{stripes}L_S^{l,l',t}  \\left(^\\text{stripes}L_S^{l,l',t} \\right)^\\top")
('12.1.0', '\\left(S_M^{LL}\\right)_{11}')
('12.1.0', '\\left(S_M^{LL}\\right)_{11} =\\ ^\\text{diag}L_S^{L,1} \\left(^\\text{diag}L_S^{L,1}\\right)^\\top + \\sum_{l = 1}^{L-1} \\sum_{t = 1}^\\tau\\  ^\\text{arrow}L_S^{l,t}  \\left(^\\text{arrow}L_S^{l,t} \\right)^\\top')
('12.1.0', "\\left(S_M^{ll'}\\right)_{tt}")
('12.1.0', "L > l > l'")
('12.1.0', "l < l'")
('12.1.0', "\\left(S_M^{ll'}\\right)_{tt} =\\ ^\\text{stripes}L_S^{l,l',t} \\left(^\\text{diag}L_S^{l',t}\\right)^\\top + \\sum_{l'' = 1}^{l'-1}\\  ^\\text{stripe}L_S^{l,l'',t}  \\left(^\\text{stripes}L_S^{l',l'',t} \\right)^\\top")
('12.1.0', '\\left(S_M^{Ll}\\right)_{1t}')
('12.1.0', "\\left(S_M^{Ll}\\right)_{1t} = \\ ^\\text{arrow}L_S^{l,t} \\left(^\\text{diag}L_S^{l,t}\\right)^\\top + \\sum_{l' = 1}^{l-1}\\ ^\\text{arrow}L_S^{l',t} \\left(^\\text{stripes}L_S^{l,l',t}\\right)^\\top")
('12.1.0', "\\mathcal{O}(M^3l')")
('12.1.0', 'l = 2,\\dots, L-1')
('12.1.0', "l'=1,\\dots,l-1")
('12.1.0', 't=1,\\dots,\\tau')
('12.1.0', '\\mathcal{O}(M^3L^3\\tau)')
('12.1.0.0', "\\widetilde{S}_n^{ll'}")
('12.1.0.0', "\\left(\\widetilde{S}_n^{ll'}\\right)_{tt'}")
('12.1.0.0', "\\left(S_M^{ll'}\\right)_{tt'}")
('12.1.0.0', 'M\\times M')
('12.1.0.0', '\\mathcal{O}(NM^2)')
('12.1.0.0', '\\mathcal{O}(\\tau L^2)')
('12.1.0.0', '\\mathcal{O}(NM^2\\tau L^2)')
('12.1.0.1', '\\widetilde{S}_n^{1:l-1,1:l-1}')
('12.1.0.1', 'S_M')
('12.1.0.1', '\\mathcal{O}(N\\tau^3L^3)')
('12.1.0.2', '\\label{eq:compcostsa}\n\\mathcal{O}(NM^2\\tau L^2 + N \\tau^3 L^3 + M^3\\tau L^3).')
('13', '\\widetilde{S}_n')
('13', 'f_n^l')
('13', 'f_n^{1:l-1}')
('13', 'x_{N_b}')
('13', 'y_{N_b}')
('13', 'N_b')
('13', 'R')
('13', '\\mathcal{L} = 0')
('13', '\\text{list} = [x_n]')
('13', '\\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l, \\text{list}  = \\text{sample\\_layer}(l,\\text{list})')
('13', '\\mathcal{L} \\mathrel{+}= %1/S\\ \n\t\t\t\t\\frac{N}{N_b S}   \\text{var\\_log\\_likelihood}(y_n,\\hat{\\mu}_n^L, \\hat{\\Sigma}_n^L)')
('13', '\\mathcal{L} \\mathrel{-}= \\text{KL\\_term}()')
('13', '\\mathcal{L}')
('13', '\\widetilde{\\mu}_n^{l} = \\text{get\\_mu\\_tilde}()')
('13', '\\widetilde{S}_n^{l,1:l}')
('13', '\\text{get\\_S\\_tilde}(l,\\widetilde{\\mathcal{K}}^{1:l}_{nM})')
('13', '\\hat{\\mu}_n^l = \\widetilde{\\mu}_n^{l} + \\textcolor{orange}{\\text{correct\\_mu}(\\text{list}, \\widetilde{S}_n^{l,1:l-1})}')
('13', '\\hat{\\Sigma}_n^l = \\widetilde{S}_n^{ll} - \\textcolor{orange}{\\text{correct\\_Sigma}(\\text{list}, \\widetilde{S}_n^{l,1:l-1})}')
('13', 'f_n^l = \\text{sample\\_multivariate\\_gauss}(\\hat{\\mu}_n^l,\\hat{\\Sigma}_n^l)')
('13', '\\widetilde{\\mathcal{K}}^l_{nM}')
('13', '\\widetilde{\\mu}_n^l')
('13', '\\widetilde{S}_n^{l,1:l-1}')
('13', '\\widetilde{S}_n^{ll}')
('13', 'f_n^l')
('13', '\\hat{\\mu}_n^l, \\hat{\\Sigma}_n^l')
('13', '(\\widetilde{S}_n^{l,l})_{tt}= K^l_{nn} + \\widetilde{K}^l_{nM} \\left( (S_M^{ll})_{tt} - K^l_{MM} \\right) \\widetilde{K}^{l}_{Mn}')
('13', "(\\widetilde{S}_n^{l,l'})_{tt'}=  \\widetilde{K}^l_{nM} (S_M^{ll'})_{tt'} \\widetilde{K}^{l'}_{Mn}")
('13', '\\widetilde{S}_n^{l,1:l}')
('13', '(\\widetilde{S}_n^{l,l})_{tt}= K^l_{nn} + \\widetilde{K}^l_{nM} \\left( (S_M^{ll})_{tt} - K^l_{MM} \\right) \\widetilde{K}^{l}_{Mn}')
('13', "(\\widetilde{S}_n^{l,l'})_{tt'}=  \\widetilde{K}^l_{nM} (S_M^{ll'})_{tt'} \\widetilde{K}^{l'}_{Mn}")
('13', '\\widetilde{S}_n^{l,1:l}')
('14', 'M=128')
('14', 'L=3')
('14', '\\tau =5')
('14', '\\sigma^2_0 = 0.01')
('14', 'l_0=1')
('14', '\\sigma^2_0=1')
('14', 'nIter=20,000')
('14', 'mbs=512')
('14', 'R=5')
('14', 'lr=0.005')
('14', 's=1000')
('14', 'r=0.98')
('14', 'lr=0.001\\ (0.005)')
('14', 's=1000')
('14', 'r=0.99')
('14', '\\alpha=10^{-5}')
('14', 'L=3, \\tau = 5')
('14', 'L=4, \\tau = 3')
