('1', 'Q')
('2', 'Q')
('2', 'Q')
('3.0', 't')
('3.0', ' s_t  ')
('3.0', ' a_t ')
('3.0', 'r_t')
('3.0', ' s_{t+1} ')
('3.0', ' R_t = \\sum_{k=0}^{K}\\gamma^kr_{t+k} ')
('3.0', ' R_t ')
('3.0', 'K')
('3.0', ' \\gamma \\in (0,1] ')
('3.0', ' \\pi(s|\\theta^{\\pi}) ')
('3.0', ' Q(s,a|\\theta^Q) ')
('3.0', " \\pi'(s|\\theta^{\\pi'}) ")
('3.0', " Q'(s,a|\\theta^{Q'}) ")
('3.0', '\\tau')
('3.0', 'B')
('3.0', '(s_t, a_t, r_t, s_{t+1})')
('3.0', '\\pi_e(s_t)=\\pi(s_t|\\theta^{\\pi})+\\mathcal{N}')
('3.0', 'L = \\frac 1{N} \\sum_{i}(y^{(i)}_t-Q(s^{(i)}_t,a^{(i)}_t|\\theta^{Q}))^2\\eqno(1)')
('3.0', "y^{(i)}_t=r^{(i)}_t+\\gamma Q'(s^{(i)}_{t+1},\\pi'(s^{(i)}_{t+1}|\\theta^{\\pi'})|\\theta^{Q'})")
('3.0', '\\bigtriangledown_{\\theta^{\\pi}}\\pi|_{s^{(i)}} \\approx \\frac 1{N}\\sum_{i}\\bigtriangledown_aQ(s^{(i)},a|\\theta^Q)|_{a=\\pi(s^{(i)})}\\bigtriangledown_{\\theta^{\\pi}}\\pi(s^{(i)}|\\theta^{\\pi}) \\eqno(2)')
('3.2', 'D=\\{s_1,a_1,...,s_n,a_n\\}')
('3.2', 'J(\\theta) = \\frac 1{K}\\sum_{k=1}^{K}L(\\pi_{il}(s_k), a_k)')
('3.2', '\\pi_{il}')
('3.2', 'K')
('3.2', '\\pi_{il}')
('3.2', 'D_{\\pi}=\\{s_{n+1},...,s_{n+m}\\}')
('3.2', 'D_{\\pi}')
('3.2', 'D\\gets D \\cup D_{\\pi}')
('4.0', '\\pi_{pg}(s_t|\\theta^{pg})')
('4.0', '\\pi_{ea}(s_t|\\theta^{ea})')
('4.0', 's_t')
('4.0', '\\pi_{rl}=\\left\\{\n\\begin{array}{rcl}\n\\pi_{pg}, & & {Q(s_t, \\pi_{pg}(s_t|\\theta^{pg})|\\theta^Q) \\geq Q(s_t, \\pi_{ea}(s_t|\\theta^{ea})|\\theta^Q)}\\\\\\\\\n\\pi_{ea}, & & otherwise\n\\end{array} \\right. \\eqno(3)')
('4.0', '\\pi_{rl}')
('4.0', 'y^{(i)}_t')
('4.0', '\\pi_{rl}')
('4.0', "y^{(i)}_t=r^{(i)}_t+\\gamma Q'(s^{(i)}_{t+1},\\pi_{rl}(s^{(i)}_{t+1})|\\theta^{Q'}) \\eqno(4)")
('4.0', '\\pi_{rl}')
('4.0', "Q'")
('4.0', "Q'")
('4.0', "Q'")
('4.0', 'Q')
('4.0', '\\pi^*')
('4.0', "Q'")
('4.0', '\\pi^*')
('4.0', '\\pi^*')
('4.0', 'Q^*')
('4.0', "Q'")
('4.0', "E_{ddpg}(\\hat{Q'})")
('4.0', "Q'")
('4.0', "E_{rim}(\\hat{Q'})")
('4.0', "E_{ddpg}(\\hat{Q'}) \\leq E_{rim}(\\hat{Q'}) \\leq Q^*")
('4.0', '\\pi^*')
('4.0', "Q'")
('4.0', 'Q^*')
('4.0', '\\pi^*')
('4.0', "Q'")
('4.0', 'Q^*')
('4.0', "E_{rim}(\\hat{Q'}) \\leq Q^*")
('4.0', "E_{rim}(\\hat{Q'}) = Q^*")
('4.0', '\\pi_{rl}')
('4.0', '\\pi^*')
('4.0', "E_{ddpg}(\\hat{Q'}) \\leq Q^*")
('4.0', "E_{ddpg}(\\hat{Q'}) = Q^*")
('4.0', '\\pi_{ddpg}')
('4.0', '\\pi^*')
('4.0', '\\pi_{ddpg}')
('4.0', "Q'")
('4.0', 'x')
('4.0', 'p(x)')
('4.0', "E_{ddpg}(\\hat{Q'})=\\int_{-\\infty}^{+\\infty}(Q^*-x)p(x)dx")
('4.0', "Q'")
('4.0', '\\pi_{pg}')
('4.0', '\\pi_{ddpg}')
('4.0', "Q'")
('4.0', 'x')
('4.0', 'p(x)')
('4.0', '\\pi_{ea}')
('4.0', 'y')
('4.0', 'y\\geq0')
('4.0', 'q(y|x)')
('4.0', "\\begin{aligned}\n            E_{rim}(\\hat{Q'})&=\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}(Q^*-x+y)q(y|x)p(x)dydx\\\\\n            &=\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}(Q^*-x)q(y|x)p(x)dydx +\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}yq(y|x)p(x)dydx\\\\\n            &=\\int_{-\\infty}^{+\\infty}(Q^*-x)(\\int_{-\\infty}^{+\\infty}q(y|x)dy)p(x)dx +\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}yq(y|x)p(x)dydx\\\\\n            &=\\int_{-\\infty}^{+\\infty}(Q^*-x)p(x)dx +\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}yq(y|x)p(x)dydx\\\\\n            &=E_{ddpg}(\\hat{Q'})+\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}yq(y|x)p(x)dydx\\\\\n            \n\\end{aligned}")
('4.0', 'y\\geq0')
('4.0', 'q(y|x)p(x)\\geq0')
('4.0', '\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}yq(y|x)p(x)dydx \\geq 0')
('4.0', "E_{ddpg}(\\hat{Q'})\\leq E_{rim}(\\hat{Q'})")
('4.0', '\\hfill\\blacksquare')
('4.0', 'Q')
('4.0', "Q'")
('4.0', 'Q')
('4.0', "Q'")
('4.0', "Q'")
('4.0', '\\pi_{rim}')
('4.0', '\\pi_{ddpg}')
('4.0', 'Q^*')
('4.0', '\\pi_{ddpg}')
('4.0', '\\pi_{ea}')
('4.0', "Q'")
('4.1', 'J_0(\\theta^{wt}) = \\frac 1{K}\\sum_{k=1}^{K}L(\\pi_{wt}(s_k|\\theta^{wt}), \\pi_{rl}(s_k)) \\eqno(5)')
('4.1', '\\pi_{wt}')
('4.1', '\\pi_{wt}')
('4.1', '\\pi_{wt}')
('4.1', 'size \\gets len(B)')
('4.1', '\\{s_i\\}')
('4.1', 'a_i^{wt}')
('4.1', '\\pi_{wt}(s_i|\\theta^{wt})')
('4.1', '\\pi_{rl}')
('4.1', 'a_i')
('4.1', '\\pi_{rl}(s_i)')
('4.1', 'L')
('4.1', 'a_i^{wt}')
('4.1', 'a_i')
('4.1', '\\bigtriangledown_{\\theta^{wt}} L')
('4.1', '\\theta^{wt} \\gets \\theta^{wt} + \\alpha\\cdot\\bigtriangledown_{\\theta^{wt}} L')
('4.2', 'Q(s,a|\\theta^Q)')
('4.2', '\\pi_{pg}(s|\\theta^{pg})')
('4.2', '\\pi_{ea}(s|\\theta^{ea})')
('4.2', "Q'")
('4.2', "\\pi_{pg}'")
('4.2', "\\pi_{ea}'")
('4.2', "\\theta^{Q'} \\gets \\theta^{Q}")
('4.2', "\\theta^{pg'} \\gets \\theta^{pg}")
('4.2', "\\theta^{ea'} \\gets \\theta^{ea}")
('4.2', 'B')
('4.2', 'Env')
('4.2', '\\theta^{ea} \\gets \\theta^{champ}')
('4.2', 'Env')
('4.2', 's')
('4.2', 'done \\gets False')
('4.2', '\\pi(s) \\gets  max_\\pi\\{Q(s,\\pi_{pg}(s)), Q(s, \\pi_{ea}(s))\\}')
('4.2', 'a')
('4.2', '\\pi(s) + \\mathcal N')
('4.2', 'a')
('4.2', "(r, s', done) \\sim Env")
('4.2', "(s,a,r,s')")
('4.2', 'B')
('4.2', "s \\gets s'")
('4.2', '\\{(s_t, a_t, r_t, s_{t+1})_i\\}')
('4.2', "Q'(s_{t+1}^{(i)},a_{t+1}^{(i)}|\\theta^{Q'})\\gets max\\{Q'(s_{t+1}^{(i)},\\pi_{pg}'(s_{t+1}^{(i)})|\\theta^{Q'}), Q'(s_{t+1}^{(i)}, \\pi_{ea}'(s_{t+1}^{(i)})|\\theta^{Q'})\\}")
('4.2', "L^Q \\gets\\frac{1}{N}\\sum_i(r_t^{(i)}+Q'(s_{t+1}^{(i)},a_{t+1}^{(i)}|\\theta^{Q'})-Q(s_{t}^{(i)},a_{t}^{(i)}|\\theta^{Q}))^2")
('4.2', 'L^{\\pi} \\gets -\\frac{1}{N}{\\sum_iQ(s_{t}^{(i)},\\pi_{pg}(s_{t}^{(i)}|\\theta^{pg})|\\theta^{Q})}')
('4.2', '\\theta^Q')
('4.2', '\\theta^{pg}')
('4.2', '\\bigtriangledown_{\\theta^Q} L^Q')
('4.2', '\\bigtriangledown_{\\theta^{pg}} L^{\\pi}')
('4.2', "\\theta^{ea'} \\gets (1-\\tau_0)\\theta^{ea'} + \\tau_0\\theta^{ea}")
('4.2', "\\theta^{Q'} \\gets (1-\\tau_1)\\theta^{Q'} + \\tau_1\\theta^{Q}")
('4.2', "\\theta^{pg'} \\gets (1-\\tau_1)\\theta^{pg'} + \\tau_1\\theta^{pg}")
('4.2', '\\pi_{rl}')
('4.2', 'y^{(i)}_t')
('4.2', 'y^{(i)}_t')
('4.2', '\\pi_{ea}(s_t|\\theta^{ea})')
('4.2', "\\theta^{ea'} \\gets (1-\\tau_0)\\theta^{ea'} + \\tau_0\\theta^{ea} \\eqno(6)")
('4.2', '\\tau_0')
('5.0', '10^{-4}')
('5.0', '10^{-3}')
('5.0', '10')
('5.0', '10^{-3}')
('5.2', '\\pi_{wt}')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\%')
('5.2', '\\pi_{wt}')
('5.2', '\\pi_{wt}')
('5.2', '\\pi_{wt}')
('5.2', '\\pi_{wt}')
('5.2', '\\pi_{wt}')
('5.3', 'y^{(i)}')
('5.4', "Q'")
('5.4', "Q'")
('5.4', "Q'")
('5.4', "Q'")
('5.4', "Q'")
