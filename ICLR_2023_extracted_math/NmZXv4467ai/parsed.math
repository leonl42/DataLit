('3.1', '\\mathcal{M}=\\left\\langle\\mathcal{S},\\mathcal{A},\\mathcal{R},\\mu,\\mathcal{P},%\n\\mathcal{D},\\mathcal{O}_{\\mathcal{S}},\\mathcal{O}_{\\mathcal{R}}\\right\\rangle')
('3.1', '\\mathcal{S},\\mathcal{A}')
('3.1', '\\mathcal{P}\\left(s_{t+1}\\mid s_{t},a_{t}\\right)')
('3.1', '\\mathcal{R}(s_{t},a_{t})')
('3.1', '\\mu(s_{0})')
('3.1', '\\mathcal{D}')
('3.1', '\\mathcal{O}_{\\mathcal{S}}')
('3.1', '\\mathcal{O}_{\\mathcal{R}}')
('3.1', 'R_{t}=\\sum_{\\tau=0}^{t}r_{t}')
('3.1', 'r_{t}')
('3.1', 't')
('3.1', 'd_{t}\\in\\{0,1\\}')
('3.1', '\\mathcal{D}')
('3.1', 'd=1')
('3.1', 'd=0')
('3.1', '\\hat{s}_{t}')
('3.1', '\\hat{R}_{t}')
('3.1', '\\displaystyle\\hat{s}_{t}=\\mathcal{O}_{\\mathcal{S}}(s_{t},\\hat{s}_{t-1},d)=d%\n\\cdot\\hat{s}_{t-1}+(1-d)\\cdot s_{t}')
('3.1', '\\displaystyle\\hat{s}_{t}')
('3.1', '\\displaystyle=\\mathcal{O}_{\\mathcal{S}}(s_{t},\\hat{s}_{t-1},d)=d\\cdot\\hat{s}_{%\nt-1}+(1-d)\\cdot s_{t}')
('3.1', '\\displaystyle\\hat{R}_{t}=\\mathcal{O}_{\\mathcal{R}}(R_{t},\\hat{R}_{t-1},d)=d%\n\\cdot\\hat{R}_{t-1}+(1-d)\\cdot R_{t}')
('3.1', '\\displaystyle\\hat{R}_{t}')
('3.1', '\\displaystyle=\\mathcal{O}_{\\mathcal{R}}(R_{t},\\hat{R}_{t-1},d)=d\\cdot\\hat{R}_{%\nt-1}+(1-d)\\cdot R_{t}')
('3.1', '\\hat{s}_{t-1}')
('3.1', '\\hat{R}_{t-1}')
('3.1', 'R_{\\text{target}}')
('3.1', '\\displaystyle g_{t}=R_{\\text{target}}-R_{t}')
('3.1', '\\displaystyle\\hat{g}_{t}=R_{\\text{target}}-\\hat{R}_{t}')
('3.2.1', 'K')
('3.2.1', 'g_{t-K:t}')
('3.2.1', 's_{t-K:t}')
('3.2.1', 'a_{t-K:t}')
('3.2.1', '\\phi_{g},\\phi_{s}')
('3.2.1', '\\phi_{a}')
('3.2.1', 'd')
('3.2.1', '\\omega(t)')
('3.2.1', 'u_{g_{t}}')
('3.2.1', 'u_{s_{t}}')
('3.2.1', 'u_{a_{t}}')
('3.2.1', 't')
('3.2.1', 'v_{g_{t}}')
('3.2.1', 'v_{s_{t}}')
('3.2.1', 'v_{a_{t}}')
('3.2.1', '\\displaystyle u_{g_{t}}=\\phi_{g}(g_{t})+\\omega(t),\\quad u_{s_{t}}=\\phi_{s}(s_{%\nt})+\\omega(t),\\quad u_{a_{t}}=\\phi_{a}(a_{t})+\\omega(t)')
('3.2.1', '\\displaystyle v_{g_{t-K}},v_{s_{t-K}},v_{a_{t-K}},\\dots,v_{g_{t}},v_{s_{t}},v_%\n{a_{t}}=\\mathrm{DT}(u_{g_{t-K}},u_{s_{t-K}},u_{a_{t-K}},\\dots,u_{g_{t}},u_{s_{%\nt}},u_{a_{t}})')
('3.2.1', '\\omega(t)')
('3.2.1', 'a_{t}')
('3.2.1', '\\pi_{\\theta}\\left(a_{t}\\mid v_{s_{t}}\\right)=\\mathcal{N}\\left(\\mu_{\\theta}%\n\\left(v_{s_{t}}\\right),\\Sigma_{\\theta}\\left(v_{s_{t}}\\right)\\right)')
('3.2.1', '\\Sigma_{\\theta}')
('3.2.1', '\\mathcal{T}')
('3.2.1', 'J(\\theta)=\\frac{1}{K}\\mathbb{E}_{(\\mathbf{a},\\mathbf{s},\\mathbf{g})\\sim%\n\\mathcal{T}}\\left[-\\sum_{k=1}^{K}\\log\\pi_{\\theta}\\left(a_{k}\\mid v_{s_{k}}%\n\\right)\\right]')
('3.2.2', '\\hat{\\mathcal{D}}')
('3.2.2', '\\mathcal{D}')
('3.2.2', '\\hat{\\mathcal{D}}')
('3.2.2', 'p_{d}')
('3.2.2', '\\hat{\\mathcal{D}}')
('3.2.2', '\\hat{\\mathcal{D}}')
('3.2.2', 'p_{d}')
('3.2.2', 'p_{d}')
('3.2.3', '\\omega(t)')
('3.2.3', 'k_{t}')
('3.2.3', 't')
('3.2.3', '\\psi')
('3.2.3', 'k_{t}')
('3.2.3', 'd')
('3.2.3', 'u_{\\hat{s}_{t}}=\\phi_{s}(\\hat{s}_{t})+\\psi(k_{t})+\\omega(t),\\quad u_{\\hat{g}_{%\nt}}=\\phi_{g}(\\hat{g}_{t})+\\psi(k_{t})+\\omega(t),\\quad u_{a_{t}}=\\phi_{a}(a_{t}%\n)+\\omega(t)')
('3.2.4', '\\psi')
('3.2.4', '\\pi_{\\theta}')
('3.2.4', '\\hat{\\mathcal{D}}')
('3.2.4', 'p_{d}')
('4', 'p_{d}')
('4.1', 'p_{d}')
('4.4', '\\hat{s}_{t}')
('4.4', 's_{t}')
('4.4', '\\hat{s}_{t}')
('4.4', 's_{t}')
('4.5', 't')
('4.5', '\\omega(t)')
('4.5', '\\omega(t-k_{t})')
('4.5', 'u_{s_{t}}=\\phi_{s}(s_{t})+\\omega(t-k_{t}),\\ u_{g_{t}}=\\phi_{g}(g_{t})+\\omega(t%\n-k_{t}),\\ u_{a_{t}}=\\phi_{a}(a_{t})+\\omega(t)')
('x1', '\\mathrm{update\\_interval}')
('x1', '\\mathrm{n\\_updates,n\\_transitions}')
('x1', '\\mathbf{sample}(\\mathcal{S},~{}n)')
('x1', '\\mathcal{S}')
('x1', '\\mathbf{cumcount}(\\mathrm{flags})')
('x1', '\\mathbf{train}(\\mathrm{rtg},~{}\\mathrm{obs},~{}\\mathrm{act},~{}\\mathrm{%\ntimestep},~{}\\mathrm{dropspan},~{}\\mathrm{freeze\\_trunk})')
('x1', '\\mathrm{batch\\_size}')
('x1', '\\mathrm{act\\_buffer}')
('x1', '\\mathrm{obs\\_buffer}')
('x1', '\\mathrm{rtg\\_buffer}')
('x1', '\\mathrm{context\\_length}')
('x1', '\\mathrm{freeze\\_trunk}\\in')
('x1', 'N\\leftarrow\\mathrm{n\\_updates}')
('x1', 'N\\neq 0')
('x1', 'M\\leftarrow\\mathrm{update\\_interval}')
('x1', 'M\\leftarrow\\lfloor M/5\\rfloor')
('x1', '\\mathrm{drop\\_mask}\\leftarrow\\mathbf{sample}(\\mathrm{\\{\\TRUE,\\FALSE\\}},~{}%\n\\mathrm{n\\_transitions})')
('x1', '\\mathrm{dropspans}\\leftarrow\\mathbf{cumcount}(\\mathrm{drop\\_mask})')
('x1', 'M\\neq 0')
('x1', '\\mathrm{selected\\_index}\\leftarrow\\mathbf{sample}(\\{\\mathrm{0,1,...,n\\_%\ntransitions}\\},~{}\\mathrm{batch\\_size})')
('x1', '\\mathrm{timestep}\\leftarrow\\mathrm{selected\\_index}')
('x1', '\\mathrm{dropspan}\\leftarrow\\mathrm{dropspans}[\\mathrm{selected\\_index}]')
('x1', '\\mathrm{dropped\\_index}\\leftarrow\\mathrm{selected\\_index}-\\mathrm{dropspan}')
('x1', '\\mathrm{rtgs}\\leftarrow\\mathrm{rtg\\_buffer}[\\mathrm{dropped\\_index}\\colon%\n\\mathrm{dropped\\_index}+\\mathrm{context\\_length}]')
('x1', '\\mathrm{observations}\\leftarrow\\mathrm{obs\\_buffer}[\\mathrm{dropped\\_index}%\n\\colon\\mathrm{dropped\\_index}+\\mathrm{context\\_length}]')
('x1', '\\mathrm{actions}\\leftarrow\\mathrm{act\\_buffer}[\\mathrm{selected\\_index}\\colon%\n\\mathrm{selected\\_index}+\\mathrm{context\\_length}]')
('x1', '\\mathbf{train}(\\mathrm{rtgs},~{}\\mathrm{observations},~{}\\mathrm{actions},~{}%\n\\mathrm{timestep},~{}\\mathrm{dropspan},~{}\\mathrm{freeze\\_trunk})')
('x1', 'M\\leftarrow M-1')
('x1', 'N\\leftarrow N-1')
('A2.2.1', 'K')
('A2.2.2', 'K')
('A3.2', 'p_{d}')
('A3.2', 'p_{d}')
('A3.2', '\\mathbf{P}=\\begin{bmatrix}1-p_{1}&p_{1}\\\\\n1-p_{2}&p_{2}\\end{bmatrix}')
('A3.2', 'p_{1}')
('A3.2', 'p_{2}')
('A3.2', 'p_{1}=p_{2}')
('A3.2', 'p_{d}=0.5')
('A3.2', 'p_{d}=0.9')
('A3.2', 'p_{1}=0.2,\\ p_{2}=0.9')
('A3.2', '0.67')
('A3.2', 'p_{1}=0.3,\\ p_{2}=0.9')
('A3.2', '0.75')
('A3.2', 'p_{d}=0.5')
('A3.2', 'p_{d}=0.9')
('A3.2', 'p_{1}=0.2,\\ p_{2}=0.9')
('A3.2', '0.67')
('A3.2', 'p_{1}=0.3,\\ p_{2}=0.9')
('A3.2', '0.75')
('A3.2', 'p_{2}')
('A3.2', 'p_{d}')
('A3.2', 'p_{1}')
('A3.2', 'p_{2}')
('A3.2', 'p_{1}')
('A3.2', 'p_{1}')
('A3.2', 'p_{1}')
