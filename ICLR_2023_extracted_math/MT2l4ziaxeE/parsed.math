('3', '\\mathcal{M} = (\\mathcal{S},\\mathcal{A},T,d_0,r,\\gamma)')
('3', 's \\in \\mathcal{S}')
('3', 'a \\in \\mathcal{A}')
('3', "T = p(s'|s,a)")
('3', 'd_0(s_0)')
('3', 'r(s,a)')
('3', '\\gamma')
('3', '\\pi^*(a|s)')
('3', 'J(\\pi)')
('3', '\\pi^* = \\mathop{\\mathrm{arg\\,max}}_\\pi J(\\pi) = \\mathop{\\mathrm{arg\\,max}}_\\pi \\mathbb{E}_{\\tau \\sim \\rho_\\pi} \\left[ \\sum_{t=0}^{H} \\gamma^t r(s_t,a_t) \\right],')
('3', '\\tau')
('3', '(s_0,a_0,\\cdots,s_{H},a_{H})')
('3', 'H')
('3', '\\rho_\\pi')
('3', '\\pi')
('3', '\\rho_\\pi(\\tau) = d_0(s_0)\\prod_{t=0}^{H} \\pi(a_t|s_t)T(s_{t+1}|s_{t},a_{t})')
('3', 'J(\\pi_\\phi)')
('3', '\\phi')
('3', 'Q^\\pi(s,a)')
('3', "Q^\\pi(s_t,a_t) = \\mathbb{E}_{\\tau \\sim p^\\pi(s,a)} \\left[ \\sum_{t'=t}^{H} \\gamma^{t'-t} r(s_{t'},a_{t'}) \\right]")
('3', '\\pi_k')
('3', '\\pi_{k+1}')
('3', '\\pi_k')
('3', '\\pi_{k+1}')
('3', '\\begin{cases}\n  Q^{\\pi_k} = \\lim_{n \\rightarrow \\infty} \\big(\\mathcal{B}^{\\pi_k}\\big)^n Q^{\\pi_{k-1}} \\quad \\text{(policy evaluation)},\\\\\n  \\pi_{k+1}(a|s) = \\mathop{\\mathrm{arg\\,max}}_a \\ Q^{\\pi_k}(s,a) \\quad \\text{(policy improvement)}, \\label{policy-iteration}\n  \\end{cases}')
('3', '\\mathcal{B}^\\pi')
('3', 'Q^\\pi')
('3', '\\theta')
('3', '\\phi')
('3', "\\begin{cases}\n  \\theta_{k+1} \\leftarrow \\mathop{\\mathrm{arg\\,min}}_{\\theta} \\mathbb{E}_{s,a,r,s' \\sim D}\n  \\bigg[ d\\big(Q_\\theta(s,a), r + \\gamma \\mathbb{E}_{a' \\sim \\pi_k (a'|s')} Q_k(s',a') \\big) \\bigg]\\\\\n  \\phi_{k+1} \\leftarrow \\mathop{\\mathrm{arg\\,max}}_{\\phi} \\mathbb{E}_{s \\sim D, a \\sim \\pi_\\phi(a|s)} \\bigg[ Q_{k+1}(s, a) \\bigg]\n  \\end{cases} \\label{policy-iteration-in-the-wild}")
('3', 'k')
('3', 'd')
('3', 'l_2')
('3', 'D')
('3', "D = {(s,a,r,s')}")
('3', 'Q_{\\theta_{k}} := Q_k')
('3', '\\pi_{\\phi_{k}} := \\pi_k')
('4', 'p(s,a)')
('4', '\\tilde Q_\\theta(s,a) = Q_\\theta(s,a) - p(s,a)')
('4', 'p(s,a) = Q_{\\theta} - Q^{\\pi_\\phi}')
('4', "(s,a') \\notin D")
('4', 'Q_{\\theta}')
('4', 'Q_\\theta')
('4', '(s,a)')
('4.0', '\\tilde Q')
('4.0', '\\mathop{\\mathrm{KL}}\\big(\\pi(s)\\|\\pi_p(s)\\big)')
('4.0', '\\pi_p(a|s) = \\mathop{\\mathrm{softmax}}\\big(-p(s,a)\\big)')
('4.0', 'd')
('4.0', '\\langle u_1,u_2 \\rangle := \\sum_a u_1(\\cdot,a)u_2(\\cdot,a)')
('4.0', 'Z(s) = \\ln \\sum_{a} \\exp\\big(-p(s,a)\\big)')
('4.0', '\\begin{aligned}\n    \\langle \\pi, Q \\rangle(s) - \\mathop{\\mathrm{KL}}\\big(\\pi(s)\\|\\pi_p(s)\\big) &= \\langle \\pi, Q \\rangle(s) - \\langle \\pi,\\ln\\pi - \\ln\\pi_p \\rangle(s)\\\\\n    &= \\langle \\pi, Q + \\ln \\pi_p\\rangle(s) - \\langle \\pi,\\ln \\pi \\rangle(s) \\\\ \n    &= \\langle \\pi, Q - p\\rangle(s) - Z(s) + \\mathop{\\mathrm{H}}\\big(\\pi(s)\\big).\n\\end{aligned}')
('4.0', 'Z(s)')
('4.0', 'Z(s)')
('4.0', '\\phi')
('4.0', 'Z(s)')
('4.0', "|Z(s) - Z(s')| < \\epsilon")
('4.0', "(s,s') \\in \\mathcal{S} \\times \\mathcal{S}")
('4.0', 'p(s,a)')
('4.0', '- \\log(\\beta(a|s))')
('4.0', '^2')
('4.0', '\\text{MMD}^2(\\pi_k, \\beta)')
('4.0', '\\alpha |a - \\text{Dec}(\\text{Enc}(s,a))|_2^2')
('4.0', '\\text{Enc}')
('4.0', '\\text{Dec}')
('4.0', '\\alpha_1 Q_k(s,a) \\exp (-\\alpha_2 \\ \\text{D}(s,a))')
('4.0', '\\text{D}')
('4.0', '\\alpha |\\Sigma(s,a)|')
('4.0', '\\Sigma')
('4.0', '\\mathcal{T}')
('4.0', '\\alpha_k [ \\frac{\\mu_k}{\\beta} -1 ]')
('4.0', '\\mu_k')
('4.0', 'Q_k')
('4.1', '\\beta(a|s)')
('4.1', 'p(s,a) = \\begin{cases}\n  0\\ \\text{for}\\ \\{(s,a)|\\beta(a|s) \\ge \\epsilon \\}  \\\\\n  \\infty  \\ \\text{otherwise}\n  \\end{cases}')
('4.1', '\\epsilon')
('4.1', '(s,a)')
('4.1', '\\pi_p')
('4.1', '\\mathop{\\mathrm{KL}}(\\pi \\| \\pi_p)')
('4.1', '\\pi')
('4.1', '\\pi_p')
('4.1', '\\pi')
('4.1', '\\beta(a|s)')
('4.1', '\\beta(a|s)')
('4.1', '\\beta')
('4.1', '\\alpha_k')
('4.1', '\\beta')
('4.1', '\\pi')
('4.1', '\\beta')
('4.1', '\\beta')
('4.1', '\\beta')
('4.2', 'a')
('4.2', 's')
('4.2', '\\beta')
('4.2', '\\beta(a|s)')
('4.2', '\\beta')
('4.2', '\\beta')
('4.2', '\\beta(a|s)')
('4.2', 's_\\psi')
('4.2', 'p(x)')
('4.2', '\\nabla_x \\log p(x)')
('4.2', 's_\\psi(s,a)')
('4.2', '\\beta(a|s)')
('4.2', '\\epsilon')
('4.2', 'a')
('4.2', 's')
('4.2', '\\beta(a|s)')
('4.2', "L_{\\text{policy-eval}} = \\mathbb{E}_{s,a,r,s' \\sim D} \\bigg[ d\\bigg( Q_\\theta(s,a), r + \\gamma \\mathop{\\mathrm{\\textit{K}-th}}_{a' \\in \\mathop{\\mathrm{supp}}(\\beta(s'))} \\big[ Q_{\\tilde{\\theta}} (s',a') \\big] \\bigg) \\bigg]\n  \\label{ARQ-eval}")
('4.2', 'Q_{\\tilde{\\theta}}')
('4.2', '\\mathop{\\mathrm{\\textit{K}-th}}')
('4.2', 'K')
('4.2', 'K=1')
('4.2', '\\max')
('4.2', 'Q_{\\tilde{\\theta}}')
('4.2', '\\mathop{\\mathrm{\\textit{K}-th}}')
('4.2', 'Q_\\theta')
('4.2', 's_\\psi')
('4.2', "\\pi(a|s) = \\frac{\\exp\\big(\\alpha Q_\\theta(s,a)\\big)}{\\sum_{a' \\in \\text{supp}(\\beta)} \\exp\\big(\\alpha Q_\\theta(s,a')\\big)} \\quad\\text{or}\\quad \n\\frac{\\exp\\big(\\alpha A(s,a)\\big)}{\\sum_{a' \\in \\text{supp}(\\beta)} \\exp\\big(\\alpha A(s,a')\\big)}")
('4.2', "A(s,a) = Q_\\theta(s,a) - \\frac{1}{|\\text{supp}(\\beta)|}\\sum_{a' \\in \\text{supp}(\\beta)} Q_\\theta(s,a')")
('4.2', '\\alpha')
('4.2', 'Q')
('4.2', 'A')
('4.2', '\\alpha')
('4.2', '\\beta(a|s)')
('4.2', 'Q_\\theta')
('4.2', '\\pi')
('4.2', '\\beta')
('4.2', '\\pi_\\phi(a|s)')
('4.2', 'A(s,a)')
('4.2', 's_\\psi(a|s)')
('4.2', 'Q_\\theta(s,a)')
('4.2', '\\pi_\\phi(a|s)')
('4.2', 's_\\psi')
('4.2', 'N')
('4.2', 's \\in D')
('4.2', '\\beta_\\psi(a|s) > \\epsilon')
('4.2', 's_\\psi')
('4.2', 'Q_\\theta')
('4.2', '\\pi_\\phi')
('5', 's_\\psi')
('5', 'Q_\\theta')
('5', '\\pi_\\phi')
('5', 'K')
('5', '\\alpha')
('5', 'N=30')
('5', '\\epsilon=e^{-5}')
('5', '\\epsilon=e^{-5}')
('5', 's_\\psi')
('5', 'Q^\\beta')
('5', 's_\\psi')
('5', 'Q(\\beta)+s_\\psi')
('5', '+s_\\psi')
('5', 'Q^\\beta')
('6', '\\tilde{Q} = Q - p')
('6', 'p')
('7.0', 'p(x)')
('7.0', '\\nabla_x \\log p(x)')
('7.0', 'L_{\\text{score-matching}} = \\mathbb{E}_{p(x)}[\\| \\nabla_x \\log p(x) - s_\\psi(x)\\|]^2_2]')
('7.0', 'l_2')
('7.0', 's_\\psi')
('7.0', '\\beta')
('7.1', 's_\\psi')
('7.1', '\\pi_\\phi')
('7.1', 's_\\psi')
('7.1', 's_\\psi')
('7.1', '\\beta(a|s)')
('7.1', 's_\\psi')
('7.1', '\\epsilon=e^{-5}')
('7.1', '\\epsilon')
('7.1', 's_\\psi')
('7.1', 'Q_\\theta')
('7.1', 'K \\in [3,6,9]')
('7.1', '\\in')
('7.1', 'Q^\\beta')
('7.1', '\\mathop{\\mathrm{\\textit{K}-th}}')
('7.1', 's_\\psi')
('7.1', 's_\\psi')
('7.1', '\\mu(a|s)')
('7.1', '\\sigma(a)')
('7.1', '\\alpha')
('7.1', '\\alpha')
('7.1', 'Q^\\beta')
('7.1', 's_\\psi')
('7.1', '\\alpha')
('7.1', 's_\\psi')
('7.1', '\\pi_\\phi')
('7.1', '\\alpha')
('7.1', '\\pi_\\phi')
