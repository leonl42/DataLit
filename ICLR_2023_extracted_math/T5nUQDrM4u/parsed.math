('1', '\\sim')
('1', '\\sim')
('1', 'E')
('1', 'L')
('2', '\\text{Router}(x; \\theta_{gate})')
('2', '\\text{MLP}(\\cdot; \\theta_i)')
('2', '\\text{Router}(x; \\theta_{gate}) = \\text{Top-K} \\left( \\text{softmax}(\\text{MLP}(x; \\theta_{gate})) \\right),')
('2', 'y = x + \\sum_{i \\in E} \\text{Router}(x; \\theta_{gate}) \\cdot \\text{Expert}(x; \\theta_i),')
('2', '\\theta')
('2', 'E')
('2', '|E| = K')
('2', '\\mathbf{X} \\in \\mathbb{R}^{m \\times d}')
('2', 'm')
('2', 'd')
('2', '\\Phi \\in \\mathbb{R}^{d \\times (e \\cdot s)}')
('2', 'e \\times s')
('2', '\\tilde{\\mathbf{X}} \\in \\mathbb{R}^{ (e \\cdot s) \\times d}')
('2', '\\tilde{\\mathbf{X}} = \\text{softmax}(\\mathbf{X}\\Phi)^\\top \\mathbf{X}')
('2', 'e')
('2', '\\{f_i : \\mathbb{R}^d \\rightarrow \\mathbb{R}^d\\}_{i=1}^e')
('2', 's')
('2', '\\tilde{\\mathbf{Y}} \\in \\mathbb{R}^{(e \\cdot s) \\times d}')
('2', '\\tilde{\\mathbf{Y}}_{i,j} = f_i(\\tilde{\\mathbf{X}}_{i,j})')
('2', 'i \\in \\{1, \\ldots, e\\}')
('2', 'j \\in \\{1, \\ldots, s\\}')
('2', '\\mathbf{Y} \\in \\mathbb{R}^{m \\times d}')
('2', '\\mathbf{Y} = \\text{softmax}(\\mathbf{X}\\Phi)\\tilde{\\mathbf{Y}}')
('3.0', 'N')
('3.0', 'L_i')
('3.0', 'd')
('3.0', '4d')
('3.0', 'S')
('3.0', 'N')
('3.0', "L_i'")
('3.0', "d'")
('3.0', "d' \\leq d")
('3.0', 'N_1')
('3.0', 'N_2')
('3.0', 'N_1 = N_2 = \\frac{N}{2}')
('3.0', "S = \\left( \\{L_i'\\}_{i=0}^{\\frac{N}{2}-1}, \\{L_i'\\}_{i=\\frac{N}{2}}^{N-1} \\right).")
('3.0', 'N')
('3.0', "d'")
('3.0', "A_{c} = \\frac{1}{N} \\sum_{i=0}^{N-1} A_{L_i}^{c}, \\quad \\text{Top-}d' = \\text{argmax}_{c} (A_{c}), \\quad |c| = d',")
('3.0', 'A_{L_i}^{c}')
('3.0', 'c')
('3.0', 'L_i')
('3.0', 'A_{c}')
('3.0', 'c')
('3.0', 'N')
('3.0', "\\text{Top-}d'")
('3.0', "d'")
('3.0', "P(h|H) = \\frac{A_{h}}{\\sum_{h' \\in H} A_{h'}}, \\quad h_{\\text{successor}} \\sim P(h|H), \\quad |h_{\\text{successor}}| = 4d',")
('3.0', 'A_{h}')
('3.0', 'h')
('3.0', 'H')
('3.0', 'G = (V, E)')
('3.0', 'V')
('3.0', 'E')
('3.0', 'G = \\bigcup_{i=1}^{k} G_i, \\quad G_i = (V_i, E_i), \\quad V_i \\cap V_j = \\emptyset \\text{ for } i \\neq j.')
('3.0', 'd')
('3.0', "d'")
('3.0', "W_{\\text{successor}}^{(i)} = W_{\\text{predecessor}}^{(k)}, \\quad k = \\left\\lfloor \\frac{i \\cdot d}{d'} \\right\\rfloor, \\quad i \\in \\{0, \\ldots, d'-1\\}.")
('3.0', 'S')
('3.0', "S \\subseteq {0, \\ldots, d-1}, \\quad |S| = d'.")
('3.0', "W_{\\text{successor}}^{(i)} = W_{\\text{predecessor}}^{(j)}, \\quad j \\in S, \\quad i \\in \\{0, \\ldots, d'-1\\}.")
('3.1', "M = \\{L_i'\\}_{i=N/2}^{N-1}")
('3.1', '\\mathbf{X} \\in \\mathbb{R}^{b \\times n \\times d}')
('3.1', 'b')
('3.1', 'n')
('3.1', 'n')
('3.1', '\\mathbf{X}_{\\text{norm}}')
('3.1', '\\mathbf{Q} \\in \\mathbb{R}^{b \\times (e \\times s) \\times d}')
('3.1', '\\mathbf{X}_{\\text{norm}}')
('3.1', '\\mathbf{Q}_{\\text{norm}}')
('3.1', '\\mathbf{X}_{\\text{norm}}')
('3.1', '\\mathbf{K} \\in \\mathbb{R}^{b \\times n \\times d}')
('3.1', '\\mathbf{Q}_{\\text{norm}}')
('3.1', '\\mathbf{Q}_{\\text{norm}}')
('3.1', '\\mathbf{K}')
('3.1', '\\mathbf{S} \\in \\mathbb{R}^{b \\times (e \\times s) \\times n}')
('3.1', '\\mathbf{S} = \\mathbf{Q}_{\\text{norm}} \\mathbf{K}^T')
('3.1', '\\mathbf{K}')
('3.1', '\\tilde{\\mathbf{X}} \\in \\mathbb{R}^{b \\times (e \\times s) \\times d}')
('3.1', 'n')
('3.1', "\\tilde{\\mathbf{X}} = \\frac{\\exp(\\mathbf{S}_{ijk})}{\\sum_{k'=1}^n \\exp(\\mathbf{S}_{ijk'})} \\mathbf{X}_{\\text{norm}}.")
('3.1', '\\tilde{\\mathbf{X}_i}')
('3.1', '\\tilde{\\mathbf{Y}_i}')
('3.1', '\\mathbf{S}')
('3.1', '(e \\times s)')
('3.1', '\\mathbf{Y} \\in \\mathbb{R}^{b \\times n \\times d}')
('3.1', "\\mathbf{Y} = \\frac{\\exp(\\mathbf{S}_{ijk})}{\\sum_{j'=1}^{e \\times s} \\exp(\\mathbf{S}_{ij'k})} \\tilde{\\mathbf{Y}}.")
('3.1', 'T')
('3.1', 'T')
('3.1', 'T')
('3.1', '\\mathbf{S}')
('3.1', 'i')
('3.1', 'p')
('4.0', 'N/2')
('4.0', 'N')
('4.0', 'N')
('4.0', '\\downarrow')
('4.0', '73.9')
('4.0', '75.6')
('4.0', '77.1')
('4.0', '79.9')
('4.0', '+2.8')
('4.0', '79.6')
('4.0', '86.9')
('4.0', '82.0')
('4.0', '89.5')
('4.0', '+7.5')
('4.0', '92.4')
('4.0', '97.0')
('4.0', '92.9')
('4.0', '97.9')
('4.0', '+5.0')
('4.0', '72.3')
('4.0', '81.4')
('4.0', '75.9')
('4.0', '88.4')
('4.0', '+12.5')
('4.0', '61.5')
('4.0', '83.4')
('4.0', '67.7')
('4.0', '95.3')
('4.0', '+27.6')
('4.0', '62.4')
('4.0', '81.9')
('4.0', '70.8')
('4.0', '95.4')
('4.0', '+24.6')
('4.0', '25.0')
('4.0', '68.6')
('4.0', '45.5')
('4.0', '84.3')
('4.0', '+38.8')
('4.0', '49.4')
('4.0', '62.5')
('4.0', '51.3')
('4.0', '69.1')
('4.0', '+17.8')
('4.0', '76.1')
('4.0', '76.4')
('4.0', '79.1')
('4.0', '80.5')
('4.0', '+1.4')
('4.0', '86.9')
('4.0', '89.0')
('4.0', '88.7')
('4.0', '90.7')
('4.0', '+2.0')
('4.0', '96.6')
('4.0', '97.4')
('4.0', '97.3')
('4.0', '98.2')
('4.0', '+0.9')
('4.0', '81.4')
('4.0', '84.4')
('4.0', '82.8')
('4.0', '88.5')
('4.0', '+5.7')
('4.0', '81.4')
('4.0', '92.3')
('4.0', '79.4')
('4.0', '98.7')
('4.0', '+19.3')
('4.0', '80.3')
('4.0', '94.5')
('4.0', '83.3')
('4.0', '98.6')
('4.0', '+15.3')
('4.0', '72.9')
('4.0', '87.3')
('4.0', '77.4')
('4.0', '94.9')
('4.0', '+17.5')
('4.0', '63.7')
('4.0', '68.8')
('4.0', '64.7')
('4.0', '79.5')
('4.0', '+14.8')
('4.0', '\\text{RTX} 4090')
('4.2', '73.9')
('4.2', '72.3')
('4.2', '62.4')
('4.2', '69.5')
('4.2', '77.1')
('4.2', '75.9')
('4.2', '70.8')
('4.2', '74.6')
('4.2', '+5.1')
('4.2', '78.4')
('4.2', '84.7')
('4.2', '91.2')
('4.2', '84.8')
('4.2', '+15.3')
('4.2', '79.9')
('4.2', '88.4')
('4.2', '95.4')
('4.2', '\\mathbf{87.9}')
('4.2', '+18.4')
('4.2', '9.8\\%')
('4.2', '87.9\\%')
('4.2', '79.1')
('4.2', '79.5')
('4.2', '79.6')
('4.2', '79.8')
('4.2', '\\mathbf{79.9}')
('4.2', '1/3')
('4.2', '7')
('4.2', '7{-}12')
('4.2', '6')
('4.2', '1.1')
('4.2', '72.3')
('4.2', '73.9')
('4.2', '7{:}12')
('4.2', '197')
('4.2', '354')
('4.2', '1.2')
('4.2', '75.9')
('4.2', '77.1')
('4.2', '7{:}12')
('4.2', '197')
('4.2', '1412')
('4.2', '4.5')
('4.2', '77.5')
('4.2', '80.3')
('4.2', '6')
('4.2', '1.1')
('4.2', '81.4')
('4.2', '75.5')
('4.2', '11{:}12')
('4.2', '98')
('4.2', '196')
('4.2', '92')
('4.2', '1.1')
('4.2', '87.4')
('4.2', '9{:}12')
('4.2', '98')
('4.2', '196')
('4.2', '179')
('4.2', '1.1')
('4.2', '87.8')
('4.2', '5{:}12')
('4.2', '98')
('4.2', '196')
('4.2', '352')
('4.2', '1.2')
('4.2', '86.7')
('4.2', '7{:}12')
('4.2', '32')
('4.2', '64')
('4.2', '89')
('4.2', '0.8')
('4.2', '87.8')
('4.2', '7{:}12')
('4.2', '64')
('4.2', '128')
('4.2', '175')
('4.2', '1.0')
('4.2', '88.0')
('4.2', '7{:}12')
('4.2', '98')
('4.2', '196')
('4.2', '265')
('4.2', '1.1')
('4.2', '88.4')
('4.2', '79.9')
('4.2', '7{:}12')
('4.2', '98')
('4.2', '196')
('4.2', '1058')
('4.2', '4.3')
('4.2', '\\mathbf{89.9}')
('4.2', '\\mathbf{82.4}')
('4.3', '77\\%')
('4.3', '150')
('4.3', '\\mathbf{2}')
('4.3', '76\\%')
('4.3', '40')
('4.3', '\\mathbf{8}')
('4.3', '17\\times')
('7', '1.1')
('7', '1.1')
('7', '1.1')
('7', '1.1')
('7', '7')
('7', '12')
('7', '10')
('7', '18')
('7', '98')
('7', '98')
('7', '24')
('7', '196')
('7', '196')
('7', '48')
('8', '3,300')
('8', '8,000')
('8', '224 \\times 224')
('8', '4 \\times 10^{-3}')
('8', '0.05')
('8', '\\beta_1, \\beta_2=0.9, 0.999')
('8', '4096')
('8', '300')
('8', '50')
('8', '(9, 0.5)')
('8', '0.8')
('8', '1.0')
('8', '0.25')
('8', '0.1')
('8', '1 \\times 10^{-6}')
('8', '512')
('8', '50')
('8', '300')
('8', '0.1')
('8', '512')
('8', '50')
('8', '300')
('8', '0.1')
('8', '512')
('8', '100')
('8', '600')
('8', '0.1')
('8', '512')
('8', '100')
('8', '600')
('8', '0.1')
('8', '512')
('8', '50')
('8', '300')
('8', '0')
('8', '512')
('8', '50')
('8', '300')
('8', '0.1')
('8', '512')
('8', '100')
('8', '600')
('8', '0.2')
('8', '4096')
('8', '50')
('8', '300')
('8', '0')
('10', '1.71')
('10', '3.91')
('10', '2.52')
('10', '4.16')
('10', '3.78')
('10', '3.77')
('10', '8.17')
('10', '6.71')
('10', '17.66')
('10', '2.12')
('10', '7.36')
('10', '0.77')
