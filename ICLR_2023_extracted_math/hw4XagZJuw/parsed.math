('2.0', 'x, y')
('2.0', 'x_{i:k}, y_{a:c}')
('2.0', 'x_i')
('2.0', 'i')
('2.1', '\\rightarrow')
('2.1', '\\,\\,')
('2.1', '\\rightarrow')
('2.1', '\\,\\,')
('2.1', '\\rightarrow')
('2.1', '\\begin{aligned}\n\\vspace{-2mm}\n   &\\begin{CJK*}{UTF8}{gbsn}\\text{他们 $\\,\\,$ 在 $\\,\\,$ 桥上 $\\,\\,$ 谈笑 $\\,\\,$ 风生}\\end{CJK*} \\rightarrow \n  \\\\ &\\textit{They were laughing it up on the bridge}\n  \\vspace{-2mm}\n\\end{aligned}')
('2.1', '\\,\\,')
('2.1', '\\rightarrow')
('2.1', 'n')
('2.1', 'd_{\\text{tree}}')
('2.1', 'd_{\\text{leaf}}')
('2.1', '\\begin{aligned}\n    G[x] = \\left(Root, \\{T^n, S^n, I^n\\}_{n=1}^{|x|}, C, \\Sigma, \\mathcal{R}[x]\\right),\n\\end{aligned}')
('2.1', 'Root')
('2.1', '\\{T^n, S^n, I^n\\}_{n=1}^{|x|}')
('2.1', 'n')
('2.1', '|x|')
('2.1', 'C')
('2.1', '\\Sigma')
('2.1', '\\mathcal{R}[x]')
('2.1', '\\forall n \\in \\{1, 2 \\dots |x|\\}')
('2.1', '\\begin{aligned}\nRoot \\to T^n,  \\hspace{4mm}  T^n \\to S^n[x], \\hspace{4mm} T^n \\to I^n[x], \n\\end{aligned}')
('2.1', 'S, I')
('2.1', 'S')
('2.1', 'I')
('2.1', '\\begin{aligned}\n    & \\forall i,j,k \\in \\{0, 1 \\dots |x|\\} && \\textrm{s.t.} \\ \\  i < j < k \\\\\n        & \\hspace{3mm} S^n[x_{i:k}] \\to I^l[x_{i:j}] S^r[x_{j:k}], \\\\ \n        & \\hspace{3mm} S^n[x_{i:k}] \\to I^l[x_{i:j}] I^r[x_{j:k}],   \\\\\n    & \\hspace{3mm} I^n[x_{i:k}] \\to S^l[x_{j:k}] I^r[x_{i:j}],    \\\\ \n    & \\hspace{3mm} I^n[x_{i:k}] \\to S^l[x_{j:k}] S^r[x_{i:j}],  \n    \n\\end{aligned}')
('2.1', 'x_{i:k}')
('2.1', 'n')
('2.1', 'S \\to S I')
('2.1', 'I \\to I S')
('2.1', 'l+r=n')
('2.1', 'l')
('2.1', 'r')
('2.1', 'n')
('2.1', 'S^1')
('2.1', 'I^1')
('2.1', 'C')
('2.1', '\\begin{aligned}\n    & \\hspace{3mm} S^1[x_{i:k}] \\to C[x_{i:k}], && I^1[x_{i:k}] \\to C[x_{i:k}], \\\\\n    & \\hspace{3mm} C[x_{i:k}] \\to v, && v \\in \\Sigma^{+}.  \n\\end{aligned}')
('2.1', '\\mathop{\\mathrm{\\pi}}: \\mathcal{R}\\to \\mathbb R_{\\geq 0}')
('2.1', '\\begin{aligned}\n    \\mathop{\\mathrm{\\pi}}(C[x_{i:k}] \\to v) = p_{\\text{seq2seq}}(v | x_{i:k}). \n\\end{aligned}')
('2.1', 'Root \\to T^1')
('2.2', 'x')
('2.2', '\\mathop{\\mathrm{\\pi}}')
('2.2', 'p(d|x)')
('2.2', 'd')
('2.2', 'G[x]')
('2.2', 'd')
('2.2', 'n')
('2.2', 'd_{\\text{tree}}')
('2.2', 'C[x_{i:k}]')
('2.2', 'd_{\\text{leaf}}')
('2.2', 'p(d|x) = p(n|x) p(d_{\\text{tree}}|x, n)p(d_{\\text{leaf}}| x, d_{\\text{tree}})')
('2.2', 'd_{\\text{tree}}')
('2.2', 'x')
('2.2', 'd_{\\text{leaf}}')
('2.2', 'y')
('2.2.0', 'p(n|x)=\\lambda(1 - \\lambda)^{n-1},')
('2.2.0', '0 < \\lambda < 1')
('2.2.0', '1 \\leq n < |x|')
('2.2.0', 'n = |x|')
('2.2.0', '(1 - \\lambda)^{|x| - 1}')
('2.2.0', '\\begin{aligned}\n& \\mathop{\\mathrm{\\pi}}(Root \\to T^n) = p(n|x).\n%\n%\n\\end{aligned}')
('2.2.0', 'Root \\to T^1')
('2.2.0.0', 'R \\in \\mathcal{R}')
('2.2.0.0', 'S^n[x_{i:k}] \\to I^l[x_{i:j}] A^r[x_{j:k}]')
('2.2.0.0', '\\begin{aligned}\n\\mathop{\\mathrm{\\pi}}(R) = \\exp \\left( e_{A}^\\top f(\\mathbf{\\tilde h}_{i:j}, \\mathbf{\\tilde h}_{j:k}) \\right), \n\\end{aligned}')
('2.2.0.0', 'A \\in \\{S, I\\}')
('2.2.0.0', '\\mathbf{\\tilde h}_{i:j}')
('2.2.0.0', '\\mathbf{\\tilde h}_{j:k}')
('2.2.0.0', 'i, j, k')
('2.2.0.0', 'f')
('2.2.0.0', 'e_{A}')
('2.2.0.0', 'n')
('2.2.0.0', '\\begin{aligned}\n    p(d_{\\text{tree}}| x, n) \\propto \\prod_{R \\in d_{\\text{tree}}} \\mathop{\\mathrm{\\pi}}(R),\n\\end{aligned}')
('2.2.0.0', 'd_{\\text{tree}}')
('2.2.0.0', 'R')
('2.2.0.0', 'd_{\\text{tree}}')
('2.2.0.1', 'p(C[x_{i:k}] \\to v)')
('2.2.0.1', 'x_{i:k}')
('2.2.0.1', 'p_{\\text{seq2seq}}(v | x_{i:k})')
('2.2.0.1', 'x_{i:k}')
('2.2.0.1', 'm')
('2.2.0.1', '\\begin{aligned}\n    & p(d_{\\text{leaf}}| x, d_{\\text{tree}}) = \\prod_{R \\in d_{\\text{leaf}}} \\mathop{\\mathrm{\\pi}}(R) \\\\\n    &\\mathop{\\mathrm{\\pi}}(C[x_{i:k}] \\to v) = \\prod_{t = 1}^m p_{\\text{seq2seq}} (v_t \\,\\vert\\,v_{<t}, \\mathbf{h}_{i:k}), \\\\\n    &\\mathbf{h}_{i:k} = \\mathop{\\mathrm{Encoder}}(x)_{i:k}, \n\\end{aligned}')
('2.2.0.1', '\\mathbf{h}_{i:k}')
('2.2.0.1', 'x_{i:k}')
('2.2.0.1', '\\mathbf{h}_{i:k}')
('2.2.0.1', 'v_{<t}')
('2.2.0.1', 'v_t')
('2.2.0.1', '\\mathop{\\mathrm{\\pi}}(A^1[x_{i:k}] \\to C[x_{i:k}]) = 1')
('2.2.0.1', 'A \\in \\{S, I\\}')
('2.2.0.2', 'p(n|x)')
('2.2.0.2', 'p(d_{\\text{leaf}}|x, d_{\\text{tree}})')
('2.2.0.2', 'p(d_{\\text{tree}}|x, n)')
('2.2.0.2', 'd_{\\text{tree}}')
('2.2.0.2', 'Z_{\\text{tree}}(x, n)')
('2.2.0.2', 'd_{\\text{tree}}')
('2.2.0.2', '\\mathop{\\mathrm{\\pi}}')
('2.2.0.2', 'n')
('2.2.0.2', 'l, r')
('2.2.0.2', '\\mathop{\\mathrm{\\pi}}(R)')
('2.2.0.2', 'n, l, r')
('2.2.0.2', 'p(d_{\\text{tree}}|x, n)')
('2.2.0.2', 'Z_{\\text{tree}}(x, n)')
('2.2.0.2', '\\mathop{\\mathrm{\\pi}}')
('2.2.0.2', '\\mathop{\\mathrm{\\tilde\\pi}}')
('2.2.0.2', 'd_{\\text{tree}}')
('2.3', 'd = (n, d_{\\text{tree}}, d_{\\text{leaf}})')
('2.3', 'y')
('2.3', 'x')
('2.3', '\\begin{aligned}\n      &  p(y|x) =  \\sum_{d \\in D(x, y)} p(d|x) \\\\\n      &= \\sum_{d \\in D(x, y)} p(n|x) p(d_{\\text{tree}}| x, n) p(d_{\\text{leaf}}| x, d_{\\text{tree}}), \n\\vspace{-3cm}\n\\end{aligned}')
('2.3', 'D(x,y)')
('2.3', '\\mathop{\\mathrm{yield}}(D(x, y)) = (x,y)')
('2.3', 'O(L^7)')
('2.3', 'L = \\min(|x|, |y|)')
('2.3', 'n \\in [L]')
('2.3', 'O(n^6)')
('2.3', '\\sum_{n=1}^L O(n^6) = O(L^7)')
('2.3', 'n')
('2.3', 'd_{\\text{tree}}')
('2.3', 'd_{\\text{leaf}}')
('2.3', 'O(L^3)')
('2.3', 'q')
('2.3', 'p')
('2.3', 'y')
('2.3.0', 'p(n|x)')
('2.3.0', 'q(n|x, y)')
('2.3.0', '1 \\leq n \\leq \\min(|x|, |y|)')
('2.3.0.0', 'x')
('2.3.0.0', 'p(d_{\\text{tree}}| x, n)')
('2.3.0.0', 'y')
('2.3.0.0', '\\mathbf{\\tilde h}_{i:j}')
('2.3.0.0', '\\mathbf{\\tilde h}_{j:k}')
('2.3.0.0', 'x')
('2.3.0.0', 'y')
('2.3.0.0', 'x')
('2.3.0.0', 'y')
('2.3.0.0', '{p(d_{\\text{tree}}|x, n)}')
('2.3.0.1', '(x, y, d_{\\text{tree}})')
('2.3.0.1', 'd_{\\text{leaf}}')
('2.3.0.1', 'C[x_{i:k}] \\to y_{a:c}')
('2.3.0.1', 'y_{a:c}')
('2.3.0.1', 'q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})')
('2.3.0.1', 'd_{\\text{tree}}')
('2.3.0.1', '\\begin{aligned}\n& G[y, d_{\\text{tree}}] = \\left(Root, \\{T^s\\}_{s=1}^{n}, \\mathcal{R}[y, d_{\\text{tree}}]\\right),\n\\end{aligned}')
('2.3.0.1', '\\mathcal{R}[y, d_{\\text{tree}}]')
('2.3.0.1', 'm = l+r)')
('2.3.0.1', '\\begin{aligned}\n& Root \\to T^n[y], \\ \nT^m[y_{a:c}] \\to T^l[y_{a:b}] T^r[y_{b:c}]\n\\end{aligned}')
('2.3.0.1', 'A^m \\to B^l C^r')
('2.3.0.1', 'd_{\\text{tree}}')
('2.3.0.1', 'y')
('2.3.0.1', 'p(d_{\\text{tree}}| x, n)')
('2.3.0.2', '\\begin{aligned}\n\\vspace{-2mm}\n   & \\log p(y| x) \\geq \\mathbb{E}_{ q(n | x, y) }\\Big \\{  \n         \\mathbb{E}_{q(d_{\\text{tree}}| x, y, n)}  \\Big[ \\\\\n         & \\,\\,\\,\\,\\mathbb{E}_{q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})}[\\log  p(d_{\\text{leaf}}| x, d_{\\text{tree}})]\\\\& \\,\\,\\,\\, + \\mathbb{H}[q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})]\\Big]   \\\\\n    & \\,\\, - \\mathop{\\mathrm{KL}}[q(d_{\\text{tree}}| x, y, n) \\, \\Vert \\, p(d_{\\text{tree}}| x, n) ] \\Big \\}.\n\\end{aligned}')
('2.3.0.2', '\\mathop{\\mathrm{KL}}')
('2.3.0.2', 'q(n|x,y)')
('2.3.0.2', 'p(n|x)')
('2.3.0.2', '\\theta')
('2.3.0.2', '\\phi')
('2.3.0.2', 'p_\\theta(\\cdot)')
('2.3.0.2', 'q_\\phi(\\cdot)')
('2.3.0.2', '\\theta')
('2.3.0.2', '\\phi')
('2.3.0.2', '\\begin{aligned}\nn \\sim q(n | x, y). \n\\end{aligned}')
('2.3.0.2', "\\begin{aligned}\n &d'_{\\text{tree}} \\sim q(d_{\\text{tree}}| x, y, n), \\\\\n&d'_{\\text{leaf}} \\sim q(d_{\\text{leaf}}| x, y,d'_{\\text{tree}}),\n\\end{aligned}")
('2.3.0.2', 'A')
('2.3.0.2', "(d'_{\\text{tree}}, d'_{\\text{leaf}})")
('2.3.0.2', "\\log p(d'_{\\text{leaf}} | x, d'_{\\text{tree}})")
('2.3.0.2', '\\begin{aligned}\n    \\sum_{(x_{i:k}, y_{a:c}) \\in A} \\nabla_\\theta \\log p_{\\text{seq2seq}}(y_{a:c} | x_{i:k}).\n\\end{aligned}')
('2.3.0.2', 'q(d_{\\text{tree}}| x, y, n)')
('2.3.0.2', "\\begin{aligned}\n&\\hspace{-2mm} \\left(\\log p(d'_{\\text{leaf}} | x, d'_{\\text{tree}}) + \\mathbb{H}[q(d_{d_{\\text{leaf}}} | x, y, d'_{\\text{tree}})] \\right)   \\\\ & \\,\\,\\times \\nabla_\\phi \\log q(d'_{\\text{tree}}|x,y, n) - \\nabla_\\phi\\mathop{\\mathrm{KL}}[\\cdot],\n\\end{aligned}")
('2.3.0.2', 'q(d_{\\text{leaf}}| x, y, n)')
('2.3.0.2', "\\begin{aligned}\n&\\hspace{-2mm}  \\log p(d'_{\\text{leaf}} | x, d'_{\\text{tree}})\\times \\nabla_\\phi \\log q(d'_{\\text{leaf}}|x,y, d'_{\\text{tree}}) \\\\ &\\,\\, + \\nabla_\\phi\\mathbb{H}[q(d_{\\text{leaf}}| x, y, d'_{\\text{tree}})].\n\\end{aligned}")
('2.3.0.2', '- \\nabla_\\theta \\mathop{\\mathrm{KL}}[\\cdot]')
('2.3.0.2', 'p(d_{\\text{tree}}| x, n)')
('2.3.0.3', 'O(L^7)')
('2.3.0.3', 'O(L^3)')
('2.3.0.3', 'n')
('2.3.0.3', '(d_{\\text{tree}}, d_{\\text{leaf}})')
('2.3.0.3', 'O(L^3)')
('2.3.0.3', 'O(L^3)')
('2.4', 'n=1')
('2.4', 'Root \\to T^1')
('2.4.0', 'n=1')
('2.4.0', 'G[x]')
('2.4.0', 'C[x_{0, |x|}] \\to v')
('2.4.0', '1')
('2.4.0.0', 'y')
('2.4.0.0', '\\mathop{\\mathrm{argmax}}_y \\sum_{d \\in T(x, y)} p(d|x)')
('2.4.0.0', 'G[x]')
('2.4.0.0', '\\begin{aligned}\n\\vspace{-2mm}\n    & \\mathbb{C}_{i:k}[v_1v_2, S^n]  = \\sum_{l = 1, r = n-l}^{n-1} \\big \\{ \\\\\n        & \\hspace{7mm} \\mathbb{C}_{i:j}[v_1, I^l] \\cdot \\mathbb{C}_{j:k}[v_2, S^r] \\cdot \\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle S^n \\to I^l S^r}) + \\\\\n        & \\hspace{6.5mm} \\mathbb{C}_{i:j}[v_1, I^l] \\cdot \\mathbb{C}_{j:k}[v_2, I^r] \\cdot \\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle S^n \\to I^l I^r}) \\, \\big \\} \\\\\n    \\vspace{2mm}\n    & \\mathbb{C}_{i:k}[v_1v_2, I^n]  = \\sum_{l = 1, r = n-l}^{n-1} \\big \\{ \\\\\n        & \\hspace{7mm} \\mathbb{C}_{j:k}[v_1, S^l] \\cdot \\mathbb{C}_{i:j}[v_2, I^r] \\cdot \\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle I^n \\to S^l I^r}) + \\\\\n        & \\hspace{6.5mm} \\mathbb{C}_{j:k}[v_1, S^l] \\cdot \\mathbb{C}_{i:j}[v_2, S^r]  \\cdot \\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle I^n \\to S^l S^r}) \\, \\big \\} \n\\vspace{-10mm}\n\\end{aligned}')
('2.4.0.0', '\\mathbb{C}_{i:k}[v, A]')
('2.4.0.0', 'v')
('2.4.0.0', 'x_{i:k}')
('2.4.0.0', 'A')
('2.4.0.0', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle S^n \\to I^l S^r})')
('2.4.0.0', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle S^n[x_{i:k}] \\to I^l[x_{i:j}] S^r[x_{j:k}]})')
('2.4.0.0', 'i,j,k')
('2.4.0.0', '\\mathbb{C}')
('2.4.0.0', 'v, v_1, v_2')
('2.4.0.0', 'v_1 v_2')
('2.4.0.0', '\\begin{aligned}\n    & \\mathbb{C}_{i:k}[v, S^1]  = p_{\\text{seq2seq}}(v|x_{i:k}) \\cdot \\mathop{\\mathrm{\\pi}}({\\scriptstyle S^1 \\to C}), \\\\\n    & \\mathbb{C}_{i:k}[v, I^1]  = p_{\\text{seq2seq}}(v|x_{i:k}) \\cdot \\mathop{\\mathrm{\\pi}}({\\scriptstyle I^1 \\to C})\n\\end{aligned}')
('2.4.0.0', '\\begin{aligned}\n\\vspace{-2mm}\n    & \\mathbb{C}[v, T^n]  = \\mathbb{C}_{0, |x|}[v, S^n] \\cdot \\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle T^n \\to S^n}) + \\\\\n    &  \\hspace{20mm} \\mathbb{C}_{0, |x|}[v, I^n]  \\cdot\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle T^n \\to I^n}) \\\\\n    & \\mathbb{C}[v, Root] = \\sum_{n=1}^{|x|} \\mathbb{C}[v, T^n] \\cdot \\mathop{\\mathrm{\\pi}}({\\scriptstyle Root \\to T^n}). \n\\vspace{-2mm}\n\\end{aligned}')
('2.4.0.1', '\\mathbb{C}_{i:k}[v, S^1]')
('2.4.0.1', 'v \\in \\Sigma^{+}')
('2.4.0.1', 'K')
('2.4.0.1', 'A \\in \\{S, I\\}')
('2.4.0.1', '\\mathbb{C}_{i:k}[v, A^1]')
('2.4.0.1', 'K')
('2.4.0.1', 'K')
('2.4.0.1', '\\mathbb{C}_{i:k}[v, A^n]')
('2.4.0.1', '2 \\cdot (n - 1) \\cdot K \\cdot K')
('2.4.0.1', 'K')
('2.4.0.1', 'N')
('2.4.0.1', '1')
('2.4.0.1', 'O(K \\log K)')
('2.4.0.1', 'n')
('2.4.0.1', 'O\\left((K \\log K) |x|^4\\right)')
('2.4.0.1', 'N')
('2.4.0.1', '\\rightarrow')
('2.4.0.1', '\\rightarrow')
('2.4.0.1', '\\rightarrow')
('2.4.0.1', '\\leftrightarrow')
('2.4.0.1', '\\rightarrow')
('2.4.0.1', '\\rightarrow')
('2.4.0.1', '1')
('2.4.0.1', 'N')
('2.4.0.2', '\\langle x_{i:k} \\rightarrow v\\rangle')
('2.4.0.2', 'C[x_{i:k}] \\to v')
('2.4.0.2', '\\mathop{\\mathrm{\\pi}}(C[x_{i:k}] \\to v) = 1')
('3.0.0', 'N')
('3.0.0', 'Root \\rightarrow T^1')
('3.0.0', '1')
('3.0.0', 'N')
('4.0', '\\begin{aligned}\n    & Root \\to \\langle \\text{S} \\ \\text{V} \\ \\text{O} ,\\, \\ \\text{S} \\ \\text{O} \\ \\text{V}\\rangle, \\\\ & \\hspace*{2mm} \\text{S} \\to  \\text{NP}, \\hspace*{2mm}\n     \\text{O} \\to \\text{NP}, \\hspace*{2mm} \\text{V} \\to \\text{VP}, \\\\\n    & \\text{NP} \\to \\langle np_s , \\, \\ np_t\\rangle, \\hspace*{2mm} \\text{VP} \\to \\langle vp_s , \\, \\ vp_t\\rangle,\n\\end{aligned}')
('4.0', '\\langle np_s, np_t \\rangle')
('4.0', '\\langle vp_s, \\, vp_t \\rangle')
('4.0.0', 'np_s, np_t')
('4.0.0', 'np_s, np_t')
('4.0.0.1', 'N')
('4.0.0.1', 'N')
('4.0.0.1', 'N=3')
('4.0.0.1', '1')
('4.1.0', '1')
('4.1.0', 'N')
('4.1.0', 'N')
('4.1.0.0', '\\mathop{\\mathrm{argmax}}_{d} p(d|x)')
('4.1.0.0', 'n = 3')
('4.1.0.0', 'x')
('4.1.0.0', 'y')
('4.2', 'N')
('4.2', '1')
('4.2', '\\rightarrow')
('4.2', '\\rightarrow')
('4.2', '\\rightarrow')
('4.2', '\\rightarrow')
('4.2', '1')
('4.2', 'N')
('4.2', '1')
('4.2', 'N')
('4.3', 'N')
('4.3', '1')
('4.3', '\\rightarrow')
('4.3', '\\rightarrow')
('4.4', 'K')
('4.4', 'p_{\\text{seq2seq}} ( v | x_{i:k})')
('7', 'O(L^3)')
('7', 'O(L^7)')
('9.0', 'd_{\\text{tree}}')
('9.0', 'C[x_{i:k}] \\rightarrow v')
('9.0', 'x_{i:k}')
('9.0', 'v')
('9.0.0', 'd_{\\text{tree}}')
('9.0.0', '\\begin{aligned}\n&  \\forall n \\in \\{1, 2 \\dots |x|\\}, \\\\\n&  \\hspace{5mm}  T^n \\to S^n[x], \\hspace{4mm} T^n \\to I^n[x],\n\\end{aligned}')
('9.0.0', '\\begin{aligned}\n& \\forall i,j,k \\in \\{0, 1 \\dots |x|\\} && \\textrm{s.t.} \\ \\  i < j < k \\\\\n    & \\hspace{5mm} S^n[x_{i: k}] \\to I^l[x_{i: j}] S^r[x_{j: k}] \\\\\n    & \\hspace{5mm} S^n[x_{i: k}] \\to I^l[x_{i: j}] I^r[x_{j: k}] \\\\\n    & \\hspace{5mm} I^n[x_{i: k}] \\to S^l[x_{j: k}] I^r[x_{i: j}] \\\\ \n    & \\hspace{5mm} I^n[x_{i: k}] \\to S^l[x_{j: k}] S^r[x_{i: j}].\n\\end{aligned}')
('9.0.0', '\\begin{aligned}\n\\mathop{\\mathrm{\\pi}}({\\scriptstyle S^n[x_{i: k}] \\to I^l[x_{i: j}] S^r[x_{j: k}]}) = \\exp \\left( e_{S}^\\top f(\\mathbf{\\tilde h}_{i:j}, \\mathbf{\\tilde h}_{j:k}) \\right) \n\\end{aligned}')
('9.0.0', '\\mathbf{\\tilde h}_{i:j}')
('9.0.0', '\\mathbf{\\tilde h}_{j:k}')
('9.0.0', 'I^n[x_{i: k}] \\to S^l[x_{j: k}] I^r[x_{i: j}]')
('9.0.0', 'I^n[x_{i: k}] \\to S^l[x_{j: k}] S^r[x_{i: j}]')
('9.0.0', '\\begin{aligned}\n\\mathbf{\\tilde h}_{i:j} = \\text{Concat}[\\overrightarrow{ \\mathbf{h}}_j - \\overrightarrow{\\mathbf{h}}_i; \\overleftarrow{ \\mathbf{h}}_{j+1} - \\overleftarrow{\\mathbf{h}}_{i+1}]\n\\end{aligned}')
('9.0.0', '\\overrightarrow{\\mathbf{h}}_i')
('9.0.0', '\\overleftarrow{\\mathbf{h}}_i')
('9.0.0', '\\mathbf{h}_i')
('9.0.0', '\\mathbf{h}_i = \\text{Concat}[\\overrightarrow{\\mathbf{h}}_i ; \\overleftarrow{\\mathbf{h}}_i]')
('9.0.0', 'p(d_{\\text{tree}}|x, n)  =  \\left( \\prod_{R \\in d_{\\text{tree}}} \\mathop{\\mathrm{\\pi}}(R) \\right)  / Z_{\\text{tree}}(x, n),')
('9.0.0', 'Z_{d_{\\text{tree}}}(x, n) = \\sum_{d_{\\text{tree}}} \\left( \\prod_{R \\in d_{\\text{tree}}} \\mathop{\\mathrm{\\pi}}(R)\\right)')
('9.0.0.0', '\\begin{aligned}\n    q(d_{\\text{tree}}, d_{\\text{leaf}}|x,y,n) &= q(d_{\\text{tree}}|x,y,n) \\times \\\\ &\\,\\,\\,\\, \\,\\, \\, q(d_{\\text{leaf}}|x,y, d_{\\text{tree}}),\n\\end{aligned}')
('9.0.0.0', 'O(L^3)')
('9.0.0.0', 'L=\\min(|x|, |y|)')
('9.0.0.0', 'q(d_{\\text{tree}}|x,y,n)')
('9.0.0.0', 'p(d_{\\text{tree}}|x,n)')
('9.0.0.0', '\\mathbf{h}_i')
('9.0.0.0', 'y')
('9.0.0.0', 'x')
('9.0.0.0', 'x')
('9.0.0.0', 'y')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', 'x, y')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', 'y_{a:c}')
('9.0.0.0', 'C[x_{i:k}] \\rightarrow y_{a:c}')
('9.0.0.0', 'q(d_{\\text{leaf}}|x,y, d_{\\text{tree}})')
('9.0.0.0', '\\begin{aligned}\n& Root \\to T^n[y], \\ \nT^m[y_{a:c}] \\to T^l[y_{a:b}] T^r[y_{b:c}],\n\\end{aligned}')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', 'd_{\\text{leaf}}')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', '\\mathop{\\mathrm{\\pi}}({\\scriptstyle [T^m[y_{a:c}] \\to T^l[y_{a:b}] T^r[y_{b:c}] }) = \\exp \\left( f(\\tilde{ \\mathbf{h}}_{a:b}, \\tilde{ \\mathbf{h}}_{b:c}) \\right),')
('9.0.0.0', '\\tilde{ \\mathbf{h}}_{a:b}')
('9.0.0.0', '\\tilde{ \\mathbf{h}}_{b:c}')
('9.0.0.0', 'y')
('9.0.0.0', 'f')
('9.0.0.0', 'd_{\\text{leaf}}')
('9.0.0.0', '\\begin{aligned}\n  &  q(d_{\\text{leaf}}|x, n, d_{\\text{tree}}) \\hspace{-1mm} = \\hspace{-1mm}  \\left( \\prod_{R \\in d_{\\text{leaf}}} \\mathop{\\mathrm{\\pi}}(R)  \\right) / Z_{\\text{leaf}}(d_{\\text{tree}}, y)\n\\end{aligned}')
('9.0.0.0', 'Z_{d_{\\text{leaf}}}(d_{\\text{tree}}, y) = \\sum_{d_{\\text{leaf}}} \\left( \\prod_{R \\in d_{\\text{leaf}}} \\mathop{\\mathrm{\\pi}}(R)  \\right)')
('9.0.0.0', 'q(d_{\\text{leaf}}|x, n, d_{\\text{tree}})')
('9.0.0.0', 'd_{\\text{tree}}')
('9.0.0.0', '\\rightarrow')
('9.0.0.0', '\\rightarrow')
('9.0.0.0', '\\rightarrow')
('9.0.0.0', '\\leftrightarrow')
('9.0.0.1', 'p(n) =\n    \\begin{cases}\n     & \\lambda (1 - \\lambda)^{n - 1}, \\  n \\in \\{1, 2, \\dots N-1\\} \\\\\n     & (1 - \\lambda)^{n - 1}, \\ n = N\n    \\end{cases}')
('9.0.0.1', 'N')
('9.0.0.1', 'p(n|x)')
('9.0.0.1', 'N = |x|')
('9.0.0.1', 'q(n|x, y)')
('9.0.0.1', 'N = \\min(|x|, |y|)')
('9.0.0.1', '[3, 4 \\dots 8]')
('9.0.0.1', '\\lambda')
('9.0.0.1', '\\{0.5, 0.6, 0.7, 0.8, 0.9\\}')
('10', '\\begin{aligned}\n \\log p(y|x)  &  =  \\log \\sum_{d \\in D(x, y)} p(d|x) =  \\log \\sum_{d \\in D(x, y)} p(n|x) p(d_{\\text{tree}}| x, n) p(d_{\\text{leaf}}| x, d_{\\text{tree}}) \\\\ \n  & \\geq \\mathbb{E}_{q(n | x, y)}\\Big\\{ \\boxed{ \\log \\sum_{d_{\\text{tree}}, d_{\\text{leaf}}} p(d_{\\text{tree}}| x, n) p(d_{\\text{leaf}}| x, d_{\\text{tree}}) } \\Big\\} - \\mathop{\\mathrm{KL}}[q(n|x, y) \\Vert p(n|x)]   \\\\\n  & { \\quad \\quad \\quad \\geq \\mathbb{E}_{q(d_{\\text{tree}}| x, y, n)}\\Big\\{ \\boxed{ \\log  \\sum_{d_{\\text{leaf}}} p(d_{\\text{leaf}}| x, d_{\\text{tree}}) }  - \\mathop{\\mathrm{KL}}[q(d_{\\text{tree}}| x, y, n) \\Vert p(d_{\\text{tree}}|x, n)] \\Big  \\}  } \\\\\n  & {\\quad \\quad  \\quad \\quad \\quad \\quad   \\geq \\mathbb{E}_{q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})}[\\log  p(d_{\\text{leaf}}| x, d_{\\text{tree}})] + \\mathbb{H}[q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})]  }  \\\\\n  \\\\\n  \\log p(y|x) & \n        \\geq \\mathbb{E}_{ q(n | x, y) } \\Big \\{ \\mathbb{E}_{q(d_{\\text{tree}}| x, y, n)}   \\Big[  \n          \\mathbb{E}_{q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})}[\\log  p(d_{\\text{leaf}}| x, d_{\\text{tree}})] + \\mathbb{H}[q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})]\\Big]  \\\\ &\n      - \\mathop{\\mathrm{KL}}[q(d_{\\text{tree}}| x, y, n) \\Vert p(d_{\\text{tree}}| x, n) ] \\Big \\} - \\mathop{\\mathrm{KL}}[q(n|x, y) \\Vert p(n|x)]\n\\end{aligned}')
('11.0', 'p(d_{\\text{tree}}| x, n)')
('11.0', 'q(d_{\\text{leaf}}| x, d_{\\text{tree}})')
('11.0', 'q(d_{\\text{tree}}| x, y, n)')
('11.1', '\\mathbb{H}[q(d_{\\text{leaf}}| x, y, d_{\\text{tree}})]')
('11.1', '\\mathop{\\mathrm{KL}}[q(d_{\\text{tree}}| x, y, n) \\, || \\, p(d_{\\text{tree}}| x, n) ]')
('11.1', '\\mathop{\\mathrm{KL}}[q(n|x, y) \\Vert \\, p(n | x)]')
('11.2', 'n=1')
('11.2', 'n > 1')
('12', 'O(L^3)')
('13', 'x')
('13', 'n')
('13', '\\beta_{\\dots}[S^1] = 0')
('13', '\\beta_{\\dots}[I^1] = 0')
('13', 'k = i + w')
('13', 'r = m - l')
('13', '\\beta_{i:k}[S^m] \\mathrel{+}= \\mathop{\\mathrm{\\pi}}({\\scriptstyle \\color{blue} S^m[x_{i:k}] \\to I^l[x_{i:j}] S^r[x_{j:k}]}) \\cdot \\beta_{i:j}[I^l] \\cdot \\beta_{j:k}[S^r]')
('13', '\\beta_{i:k}[S^m] \\mathrel{+}=\\mathop{\\mathrm{\\pi}}({\\scriptstyle \\color{blue} S^m[x_{i:k}] \\to I^l[x_{i:j}] I^r[x_{j:k}]}) \\cdot \\beta_{i:j}[I^l] \\cdot \\beta_{j:k}[I^r]')
('13', '\\beta_{i:k}[I^m] \\mathrel{+}= \\mathop{\\mathrm{\\pi}}({\\scriptstyle \\color{blue} I^m[x_{i:k}] \\to S^l[x_{j:k}] I^r[x_{i:j}]}) \\cdot \\beta_{j:k}[S^l] \\cdot \\beta_{i:j}[I^r]')
('13', '\\beta_{i:k}[I^m] \\mathrel{+}= \\mathop{\\mathrm{\\pi}}({\\scriptstyle \\color{blue} I^m[x_{i:k}] \\to S^l[x_{j:k}] S^r[x_{i:j}]}) \\cdot \\beta_{j:k}[S^l] \\cdot \\beta_{i:j}[S^r]')
('13', 'k = i + w')
('13', 'r = m - l')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\color{blue} R_1}) = \\left( \\mathop{\\mathrm{\\pi}}({\\color{blue} R_1}) \\cdot \\beta_{i:j}[I^l] \\cdot \\beta_{j:k}[S^r] \\right) / \\beta_{i:k}[S^m]')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\color{blue} R_2}) = \\left( \\mathop{\\mathrm{\\pi}}({\\color{blue} R_2}) \\cdot \\beta_{i:j}[I^l] \\cdot \\beta_{j:k}[I^r] \\right) / \\beta_{i:k}[S^m]')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\color{blue} R_3})= \\left( \\mathop{\\mathrm{\\pi}}({\\color{blue} R_3}) \\cdot \\beta_{j:k}[S^l] \\cdot \\beta_{i:j}[I^r] \\right) / \\beta_{i:k}[I^m]')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\color{blue} R_4})= \\left( \\mathop{\\mathrm{\\pi}}({\\color{blue} R_4}) \\cdot \\beta_{j:k}[S^l] \\cdot \\beta_{i:j}[S^r] \\right) / \\beta_{i:k}[I^m]')
('13', '\\beta[T^n] = \\beta_{0: |x|}[S^n] + \\beta_{0: |x|}[I^n]')
('13', '\\quad')
('13', 'Z_{\\text{tree}}(x, n) = \\beta[T^n]')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle \\color{blue} T^n \\to S^n[x]}) = \\beta_{0: |x|}[S^n] / \\beta[T^n]')
('13', '\\quad')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle \\color{blue} T^n \\to I^n[x]}) = \\beta_{0: |x|}[I^n] / \\beta[T^n]')
('13', 'Z_{\\text{tree}}(x, n), \\beta, \\mathop{\\mathrm{\\tilde\\pi}}')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}')
('13', 'n')
('13', 'd_{\\text{tree}}')
('13', 'A \\in \\{S, I\\}')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle \\color{blue} T^n \\to A^n[x]})')
('13', 'd_{\\text{tree}}')
('13', '{\\scriptstyle \\color{blue} A^1[x_{i:k}] \\to C[x_{i:k}]}')
('13', 'd_{\\text{tree}}')
('13', '{\\scriptstyle \\color{blue} S^n[x_{i:k}] \\to A^l[x_{i:j}] B^r[x_{j:k}]}')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}(\\cdot)')
('13', '{\\scriptstyle \\color{blue} S^n[x_{i:k}] \\to A^l[x_{i:j}] B^r[x_{j:k}]}')
('13', 'd_{\\text{tree}}')
('13', '{\\scriptstyle \\color{blue} I^n[x_{i:k}] \\to A^l[x_{j:k}] B^r[x_{i:j}]}')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}(\\cdot)')
('13', '{\\scriptstyle \\color{blue} I^n[x_{i:k}] \\to A^l[x_{j:k}] B^r[x_{i:j}]}')
('13', 'd_{\\text{tree}}')
('13', 'y')
('13', 'd_{\\text{tree}}')
('13', 'n')
('13', 'd_{\\text{tree}}')
('13', '\\beta_{\\dots}[\\dots] = 0')
('13', 'k = i + w')
('13', 'r = m - l')
('13', '\\beta_{i:k}[T^m] \\mathrel{+}= \\mathop{\\mathrm{\\pi}}({\\scriptstyle \\color{blue} T^m[y_{i:k}]  \\to T^l[y_{i:j}] T^r[y_{j:k}]}) \\cdot \\beta_{i:j}[T^l] \\cdot \\beta_{j:k}[T^r]')
('13', '\\beta')
('13', '\\beta')
('13', 'd_{\\text{tree}}')
('13', 'y')
('13', 'n')
('13', 'd_{\\text{tree}}')
('13', 'd_{\\text{leaf}}')
('13', 'd_{\\text{leaf}}')
('13', '{\\scriptstyle \\color{blue} T^1[y_{i: k}] \\to y_{i:k}}')
('13', 'd_{\\text{leaf}}')
('13', 'l, r')
('13', 'd_{\\text{tree}}')
('13', 'n')
('13', 'Z = \\sum_{j} (\\beta_{i:j}[T^l] \\cdot \\beta_{j:k}[T^r])')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle \\color{blue} T^n[y_{i:k}] \\to T^l[y_{i:j}] T^r[y_{j:k}]}) = (\\beta_{i:j}[T^l] \\cdot \\beta_{j:k}[T^r]) / Z')
('13', '{\\scriptstyle \\color{blue} T^n[y_{i:k}] \\to T^l[y_{i:j}] T^r[y_{j:k}]}')
('13', 'd_{\\text{leaf}}')
('13', '\\beta')
('13', 'd_{\\text{tree}}')
('13', 'y')
('13', 'n')
('13', 'd_{\\text{tree}}')
('13', 'l, r')
('13', 'd_{\\text{tree}}')
('13', 'n')
('13', 'Z = \\sum_{j} (\\beta_{i:j}[T^l] \\cdot \\beta_{j:k}[T^r])')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}({\\scriptstyle \\color{blue} T^n[y_{i:k}] \\to T^l[y_{i:j}] T^r[y_{j:k}]}) = (\\beta_{i:j}[T^l] \\cdot \\beta_{j:k}[T^r]) / Z')
('13', '\\mathit{H} = 0')
('13', '\\mathit{H_l} =')
('13', '\\mathit{H_r}  =')
('13', '\\mathit{H} \\mathrel{+}= (\\mathit{H_l} + \\mathit{H_r} - \\log [ \\mathop{\\mathrm{\\tilde\\pi}}({\\color{blue} R})]) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}({\\color{blue} R})')
('13', '\\mathit{H}')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}_q')
('13', 'q(d_{\\text{tree}}| x, y, n)')
('13', '\\mathop{\\mathrm{\\tilde\\pi}}_p')
('13', 'p(d_{\\text{tree}}| x, n)')
('13', 'n')
('13', 'x')
('13', '\\mathop{\\mathrm{KL}}_{\\dots}[\\cdot] = 0')
('13', 'k = i + w')
('13', 'r = m - l')
('13', '\\mathop{\\mathrm{KL}}_{i, k}[S^m] \\hspace{-1mm}\\mathrel{+}= \\left( \\mathop{\\mathrm{KL}}_{i:j}[I^l] + \\mathop{\\mathrm{KL}}_{j:k}[S^r] + \\log [\\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_1})] - \\log [\\mathop{\\mathrm{\\tilde\\pi}}_p({\\color{blue}R_1})] \\right) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_1})')
('13', '\\mathop{\\mathrm{KL}}_{i, k}[S^m] \\hspace{-1mm} \\mathrel{+}= \\left( \\mathop{\\mathrm{KL}}_{i:j}[I^l] + \\mathop{\\mathrm{KL}}_{j:k}[I^r]+ \\log [\\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_2})] - \\log [\\mathop{\\mathrm{\\tilde\\pi}}_p({\\color{blue}R_2})] \\right) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_2})')
('13', '\\mathop{\\mathrm{KL}}_{i, k}[I^m]\\hspace{-1mm} \\mathrel{+}= \\left( \\mathop{\\mathrm{KL}}_{j:k}[S^l] + \\mathop{\\mathrm{KL}}_{i:j}[I^r]+ \\log [\\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_3})] - \\log [\\mathop{\\mathrm{\\tilde\\pi}}_p({\\color{blue}R_3})] \\right) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_3})')
('13', '\\mathop{\\mathrm{KL}}_{i, k}[I^m] \\hspace{-1mm} \\mathrel{+}= \\left( \\mathop{\\mathrm{KL}}_{j:k}[S^l] + \\mathop{\\mathrm{KL}}_{i:j}[S^r] + \\log [\\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_4})] - \\log [\\mathop{\\mathrm{\\tilde\\pi}}_p({\\color{blue}R_4})] \\right) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_4})')
('13', '\\mathop{\\mathrm{KL}}[T^n] \\mathrel{+}= \\left( \\mathop{\\mathrm{KL}}_{0:|x|}[S^n] + \\log[\\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_5})] - \\log[ \\mathop{\\mathrm{\\tilde\\pi}}_p({\\color{blue}R_5})]  \\right) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_5} )')
('13', '\\mathop{\\mathrm{KL}}[T^n] \\mathrel{+}= \\left( \\mathop{\\mathrm{KL}}_{0:|x|}[I^n] + \\log[\\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_6})] - \\log [ \\mathop{\\mathrm{\\tilde\\pi}}_p({\\color{blue}R_6})]   \\right) \\cdot \\mathop{\\mathrm{\\tilde\\pi}}_q({\\color{blue}R_6})')
('13', '\\mathop{\\mathrm{KL}}[T^n]')
