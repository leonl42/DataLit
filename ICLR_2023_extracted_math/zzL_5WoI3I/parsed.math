('2.0', '\\mathcal{M} = (\\mathcal{S}, \\mathcal{A}, P, r, T)')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', 'P : \\mathcal {S} \\times \\mathcal {A} \\times \\mathcal { S } \\rightarrow \\mathbb { R }')
('2.0', 'a')
('2.0', 's')
('2.0', "s'")
('2.0', 'r : \\mathcal { S \\times A} \\rightarrow \\mathbb { R }')
('2.0', 'a')
('2.0', 's')
('2.0', 'T')
('2.0', '\\pi')
('2.0', '\\pi : \\mathcal { S } \\times \\mathcal { A } \\rightarrow [ 0,1 ]')
('2.0', '\\pi_E')
('2.0', '\\tau_E')
('2.0', '\\pi_E')
('2.0', '\\tau')
('2.0', '%    J(\\pi) =  \\sum_{t=1}^T \\mathbb{E}_{(\\bs_t,\\ba_t) \\sim \\pi}[r(\\bs_t,\\ba_t)]. \\label{eq:rl}\n    \\theta^\\star = \\arg\\max_\\theta \\sum_{t=1}^T \\mathbb{E}_{(\\mathbf{s}_t,\\mathbf{a}_t) \\sim p(\\mathbf{s}_t,\\mathbf{a}_t|\\theta)}[r(\\mathbf{s}_t,\\mathbf{a}_t)]. \\label{eq:rl}')
('2.0', '\\mathcal{O}_t')
('2.0', '\\mathcal{O}_t =1')
('2.0', 'p(\\mathcal{O}_t = 1 | \\mathbf{s}_t, \\mathbf{a}_t) = \\exp(r(\\mathbf{s}_t,\\mathbf{a}_t)).\\label{eq:opdef}')
('2.0', '\\mathcal{O}_t')
('2.0', '\\mathcal{O}_t = 1')
('2.0', '\\mathcal{O}_{t}=1')
('2.0', 't \\in\\{1, \\ldots, T\\}')
('2.0', '\\begin{aligned} \n        p\\left(\\tau | \\mathcal{O}_{1 : T}\\right) \\propto p\\left(\\tau, \\mathcal{O}_{1 : T}\\right) &=p\\left(\\mathbf{s}_{1}\\right) \\prod_{t=1} p\\left(\\mathcal{O}_{t}=1 | \\mathbf{s}_{t}, \\mathbf{a}_{t}\\right) p\\left(\\mathbf{s}_{t+1} | \\mathbf{s}_{t}, \\mathbf{a}_{t}\\right) \\\\ &=p\\left(\\mathbf{s}_{1}\\right) \\prod_{t=1}^{T} \\exp \\left(r\\left(\\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)\\right) p\\left(\\mathbf{s}_{t+1} | \\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)\\\\&=\\left[p\\left(\\mathbf{s}_{1}\\right) \\prod_{t=1}^{T} p\\left(\\mathbf{s}_{t+1} | \\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)\\right] \\exp \\left(\\sum_{t=1}^{T} r\\left(\\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)\\right)\n        \\label{eq:dist1}\n    \\end{aligned}')
('2.0', '\\begin{aligned} \n        q(\\tau)=q\\left(\\mathbf{s}_{1}\\right) \\prod_{t=1}^{T} q\\left(\\mathbf{s}_{t+1} | \\mathbf{s}_{t}, \\mathbf{a}_{t}\\right) q\\left(\\mathbf{a}_{t} | \\mathbf{s}_{t}\\right).\n    \\label{eq:dist2}\n    \\end{aligned}')
('2.0', '\\begin{aligned} \n        \\log p\\left(\\mathcal{O}_{1 : T}\\right) &=\\log \\iint p\\left(\\mathcal{O}_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) d \\mathbf{s}_{1 : T} d \\mathbf{a}_{1 : T} \\\\ \n        &=\\log \\iint p\\left(\\mathcal{O}_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\frac{q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}{q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)} d \\mathbf{s}_{1 : T} d \\mathbf{a}_{1 : T} \\\\\n        &=\\log \\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\left[\\frac{p\\left(\\mathcal{O}_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}{q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\right] \\\\\n        &\\geq \\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\left[\\log p\\left(\\mathcal{O}_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)-\\log q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)\\right] \\\\\n        &=\\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\left[\\sum_{t=1}^{T} r\\left(\\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)-\\log q\\left(\\mathbf{a}_{t} | \\mathbf{s}_{t}\\right)\\right].\n    \\label{eq:dist3}\n    \\end{aligned}')
('2.1', 'r')
('2.1', '\\tau_E')
('2.1', '\\begin{aligned}\n        \\label{eq:GAILO}\n        \\max_{\\theta} \\min_{\\omega} \\mathbb{E}_{\\pi_\\theta}&[\\log(D_\\omega(s,a))]+\\mathbb{E}_{\\pi_{E}}& [\\log(1-D_\\omega(s,a))]\n    \n\\end{aligned}')
('2.1', '\\pi_\\theta')
('2.1', '\\pi_E')
('2.1', 'D_\\omega')
('2.1', '\\pi_\\theta')
('2.1', '\\pi_E')
('2.1', 'D_\\omega')
('2.1', '\\theta')
('2.1', '\\omega')
('3', '\\mathcal{O}_t^1, ..., \\mathcal{O}_t^N')
('3', 't')
('3', '\\begin{aligned}\n    p(\\mathcal{O}_{t}^{1},\\mathcal{O}_{t}^{2}, \\ldots  ,\\mathcal{O}_{t}^{N}|\\mathbf{s}_t,\\mathbf{a}_t) = \\prod_{n=1}^N p(\\mathcal{O}^{n}|\\mathbf{s}_t,\\mathbf{a}_t) \n\\end{aligned}')
('3', 'N')
('3', '\\mathcal{O}_{t}^{n}')
('3', 'n')
('3', 'p(\\tau | \\mathcal{O}_{1:T}^1, \\ldots  ,\\mathcal{O}_{1:T}^N)')
('3', '\\mathcal{O}_t^1 = 1,  \\ldots   , \\mathcal{O}_t^N = 1')
('3', 'T')
('3', '\\begin{aligned}\n    p(\\tau | \\mathcal{O}^1_{1:T},...,\\mathcal{O}^N_{1:T}) \\propto p(\\tau, \\mathbf{o}^1_{1:T},...,\\mathbf{o}^N_{1:T})= p(\\mathbf{s}_1)\\prod_{t=1}^T \\left[ p(\\mathbf{s}_{t+1}|\\mathbf{s}_t,\\mathbf{a}_t) \\prod_{n=1}^N p(\\mathcal{O}^{n}|\\mathbf{s}_t,\\mathbf{a}_t)\\right]  \\label{eq:3.1.1}\n\\end{aligned}')
('3', '\\begin{aligned} \n        \\log p\\left(\\mathcal{O}^1_{1 : T}, \\ldots ,\\mathcal{O}^N_{1 : T}\\right) &=\\log \\iint p\\left(\\mathcal{O}^1_{1 : T},\\ldots,\\mathcal{O}^N_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) d \\mathbf{s}_{1 : T} d \\mathbf{a}_{1 : T} \\\\ \n        &=\\log \\iint p\\left(\\mathcal{O}^1_{1 : T}, \\ldots  ,\\mathcal{O}^N_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\frac{q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}{q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)} d \\mathbf{s}_{1 : T} d \\mathbf{a}_{1 : T} \\\\\n        &=\\log \\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\left[\\frac{p\\left(\\mathcal{O}^1_{1 : T}, \\ldots  ,\\mathcal{O}^N_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}{q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\right] \\\\\n        &\\geq \\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\left[\\log p\\left(\\mathcal{O}^1_{1 : T}, \\ldots ,\\mathcal{O}^N_{1 : T}, \\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)-\\log q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)\\right] \\\\\n       &= \\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\sum_{t=1}^{T}\\left[ \\sum_{n=1}^{N} \\log p(\\mathcal{O}_t^n| \\mathbf{s}_t, \\mathbf{a}_t) -\\log q\\left(\\mathbf{s}_{t}| \\mathbf{a}_{t}\\right)\\right] \\\\\n    \\label{eq:3.1.2}\n    \\end{aligned}')
('3', 'p(\\mathcal{O}_t^n| \\mathbf{s}_t, \\mathbf{a}_t) = \\exp(r^n(\\mathbf{s}_t,\\mathbf{a}_t))')
('3', '\\begin{aligned} \n        \\log p\\left(\\mathcal{O}^1_{1 : T}, \\ldots ,\\mathcal{O}^N_{1 : T}\\right)\n        &\\geq \\mathbb{E}_{\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right) \\sim q\\left(\\mathbf{s}_{1 : T}, \\mathbf{a}_{1 : T}\\right)}\\sum_{t=1}^{T}\\left[ \\sum_{n=1}^{N}r^n\\left(\\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)%+\\ldots + r^N\\left(\\mathbf{s}_{t}, \\mathbf{a}_{t}\\right)\n       -\\log q\\left(\\mathbf{s}_{t}| \\mathbf{a}_{t}\\right)\\right]. \\\\\n     \\label{eq:3.1.3}\n    \\end{aligned}')
('4', '\\mathcal{O}_t^R')
('4', '\\mathcal{O}_t^I')
('4', '\\mathcal{O}_t^R')
('4', 'p(\\mathcal{O}_t^R = 1 | \\mathbf{s}_t, \\mathbf{a}_t) = \\exp(r(\\mathbf{s}_t,\\mathbf{a}_t)).\\label{eq:opgdef}')
('4', 'r')
('4', '\\mathcal{O}_t^I')
('4', 'D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t)')
('4', 'p(\\mathcal{O}_t^I = 1 | \\mathbf{s}_t, \\mathbf{a}_t)')
('4', 'p(\\mathcal{O}_t^I = 1 | \\mathbf{s}_t, \\mathbf{a}_t) = \\exp(\\log(D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t))) = D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t).\\label{eq:opddef}')
('4', 'p(\\mathcal{O}_t^I = 1 | \\mathbf{s}_t, \\mathbf{a}_t)')
('4', '\\omega')
('4', '\\begin{aligned}\n    \\log p(\\mathcal{O}^R_{1:T},\\mathcal{O}^I_{1:T}) \\geq  \\mathbb{E}_{(\\mathbf{s}_{1:T},\\mathbf{a}_{1:T})\\sim q(\\mathbf{s}_{1:T}, \\mathbf{a}_{1:T})} \\left[ \\sum_{t=1}^T r(\\mathbf{s}_t,\\mathbf{a}_t) + \\log(D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t)) - \\log q(\\mathbf{a}_t|\\mathbf{s}_t) \\right].\n\\end{aligned}')
('4', 'r(\\mathbf{s}_t,\\mathbf{a}_t) + \\log(D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t))')
('4', 'r(\\mathbf{s}_t,\\mathbf{a}_t) + \\log(D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t))')
('4', 'r(\\mathbf{s}_t,\\mathbf{a}_t) + \\log(D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t))')
('4', '\\tau_E \\sim \\pi_E')
('4', '\\theta, \\omega')
('4', '\\mathbf{a}_t\\sim \\pi_\\theta(\\mathbf{a}_t|\\mathbf{s}_t)')
('4', '\\mathbf{s}_{t+1}\\sim p(\\mathbf{s}_{t+1}| \\mathbf{s}_t, \\mathbf{a}_t)')
('4', '\\mathcal{D} \\leftarrow \\mathcal{D} \\cup \\left\\{(\\mathbf{s}_t, \\mathbf{a}_t, r(\\mathbf{s}_t, \\mathbf{a}_t), \\mathbf{s}_{t+1})\\right\\}')
('4', '\\tau_i \\sim \\mathcal{D}')
('4', 'w_i \\leftarrow w_i - \\lambda_D \\left( \\hat{\\mathbb{E}}_{\\tau_i}[\\nabla_w  \\log(D_w(s,a))] + \\hat{\\mathbb{E}}_{\\tau_E}[\\nabla_w  \\log(1-D_w(s,a))]\\right)')
('4', '\\theta_i \\leftarrow \\theta_i + \\lambda_\\pi \\mathbb{E}_{\\pi} \\left[ \\sum_{t=1}^T r(\\mathbf{s}_t,\\mathbf{a}_t) + \\log(D_\\omega(\\mathbf{s}_t,\\mathbf{a}_t)) - \\log \\pi_\\theta(\\mathbf{a}_t|\\mathbf{s}_t) \\right]')
