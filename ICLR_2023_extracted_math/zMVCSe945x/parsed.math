('0.0.0.0', 'M=\\langle \\mathcal{S}, \\mathcal{A}, T, d_0, r, \\gamma \\rangle')
('0.0.0.0', '\\mathcal{S}')
('0.0.0.0', '\\mathcal{A}')
('0.0.0.0', 'T(s_{t+1} | s_t, a_t)')
('0.0.0.0', 'd_0')
('0.0.0.0', 'r(s_t, a_t)')
('0.0.0.0', '\\gamma')
('0.0.0.0', '\\pi(a_t | s_t)')
('0.0.0.0', '\\mathbb{E}_{\\tau \\sim p_{\\pi}(\\tau)} \\Big[ \\sum_{t=0}^{|\\tau|} \\gamma^t r(s_t, a_t)\\Big]')
('0.0.0.0', 'p_{\\pi}(\\tau) = d_0(s_0) \\prod_{t=0}^{|\\tau|} \\pi(a_t|s_t) T(s_{t+1}| s_t, a_t)')
('0.0.0.0.0', 'D=\\{(s_t, a_t, s_{t+1}, r(s_t,a_t))\\}_{t=0}^N')
('0.0.0.0.0', '\\mu(a_t | s_t)')
('0.0.0.0.0', '\\pi(a_{t+1} | s_{t+1})')
('0.0.0.0.0', '\\label{policy_evaluation}\n    Q^{k+1}(s_t, a_t) = \\operatornamewithlimits{\\mathbb{E}}_{s_t,a_t,r,s_{t+1} \\sim \\mathcal{D}} [r + \\gamma Q^{k}(s_{t+1}, \\pi(a|s_{t+1}))]')
('0.0.0.0.0', '\\label{policy_improvement}\n    \\pi^{k+1} = \\mathop{\\mathrm{arg\\,max}}_{\\pi} Q(s_t, \\pi(s_t))')
('0.0.0.0.0.0', '\\pi^{k+1} = \\mathop{\\mathrm{arg\\,max}}_{\\pi} Q(s_t, \\pi(s_t)), \\qquad s.t. \\operatorname{closeness \\ constraint}')
('0.0.0.0.0.0', '\\begin{aligned}\n    \\label{eq:td3_bc}\n    \\pi = \\mathop{\\mathrm{arg\\,max}}_{\\pi} \\mathbb{E}_{(s_t,a_t)\\sim \\mathcal{D}} \\Big[ \n    \\frac{\\alpha}{\\mathbb{E}[|Q(s_t, a_t)|]} Q(s_t, \\pi(s_t)) - (\\pi(s_t) - a_t)^2\\Big],\n\\end{aligned}')
('0.0.0.0.0.0', '\\alpha')
('0.0.0.0.0.0', '\\begin{aligned}\n    \\pi = \\mathop{\\mathrm{arg\\,max}}_{\\pi} \\mathbb{E}_{s_t \\sim \\mathcal{D}} \\Big[\n    Q(s_t, \\pi(s_t)) \\Big] \\operatorname{ s.t. } \\ \\mathbb{E}_{s_t\\sim \\mathcal{D}} [\\operatorname{MMD} (\\beta(s_t), \\pi(s_t))] \\leq \\epsilon, \n\\end{aligned}')
('0.0.0.0.0.0', '\\beta')
('0.0.0.0.0.0', '\\epsilon=0.05')
('0.0.1.1', '\\mathcal{T}^\\Pi Q(s_t,a_t) := \\mathbb{E} \\big[ r + \\gamma \\max_{\\pi \\in \\Pi} \\mathbb{E}_{T(s_{t+1} | s_t, a_t)} [V_{\\pi}(s_{t+1})] \\big],')
('0.0.1.1', 'V_{\\pi}(s_t) := \\mathbb{E}_{\\pi} [Q(s_t, \\pi(a_t|s_t))]')
('0.0.1.1', '\\Pi')
('0.0.1.1', '\\lim_{k \\to \\infty} \\mathbb{E}_{d_0}\\big[\\Big|V^{\\pi^k}(s_t) - V^\\Pi(s_t)\\Big|\\big] \\le \n    \\frac{2\\gamma}{(1-\\gamma)^2} C_{\\Pi, \\mu} \\mathbb{E_{\\mu}}\\Big[ \\max_{\\pi \\in \\Pi} \\mathbb{E}_\\pi [\\delta(s_t,a_t)]\\Big]\n    \\label{inequality}')
('0.0.1.1', 'C_{\\Pi, \\mu}')
('0.0.1.1', '\\pi(a_t |s_t) \\sim \\Pi')
('0.0.1.1', '\\mu(a_t |s_t)')
('0.0.1.1', 'V^{\\Pi}')
('0.0.1.1', '\\mathcal{T}^\\Pi')
('0.0.1.1', 'd_0')
('0.0.1.1', 'C_{\\Pi, \\mu}')
('0.0.1.1', '\\pi')
('0.0.1.1', '\\mu')
('0.0.1.1', '\\pi \\sim \\Pi')
('0.0.1.1', '\\mu')
('0.0.1.1', 'C_{\\Pi, \\mu}')
('0.0.1.1', 'C_{\\Pi, \\mu}')
('0.0.1.1', 'C_{\\Pi, \\mu}')
('0.0.2.0', '\\pi^{k+1}_{\\theta} = \\mathop{\\mathrm{arg\\,max}}_{\\pi} Q(s_t, \\pi(s_t))')
('0.0.2.0', '\\label{equation:gradient_affects}\n    \\theta = \\theta + \\alpha \\cdot \\nabla_{a_t} Q(s_t,a_t) \\Big |_{a_t = \\pi_{\\theta}(s_t)} \\cdot \\nabla_{\\theta} \\pi_\\theta(s_t)')
('0.0.2.0', 'C_{\\Pi, \\mu}')
('0.0.2.0', '\\label{euqation:gradient_penalty}\n    \\mathcal{L}_{GP} = \\lambda_{GP} \\mathop{\\mathbb{E}}\\limits_{s_t\\sim \\mathcal{D}, \\ a} \\big[ \\operatorname{ReLU}\\big( \\big\\| \\nabla_{a} Q(s_t,a) \\big\\|_F  - 1 \\big) \\big]^2')
('0.0.2.0', '1')
('0.0.2.0', '\\lambda_{GP}')
('0.0.2.0', 'N')
('0.0.2.0', 'N')
('0.0.2.0', 'a')
('0.0.2.0', 'a \\sim \\pi')
('0.0.2.0', 'a \\sim \\mu')
('0.0.2.0', 'a \\sim \\mathcal{A}')
('0.0.2.1', '\\pi(a_t | s_t)')
('0.0.2.1', 'M= \\langle \\mathcal{S}, \\mathcal{A}, r, \\gamma, T \\rangle')
('0.0.2.1', '\\Big\\| \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{a_t}} \\Big\\|_F \\leq L_{\\pi,T} < 1')
('0.0.2.1', 'r(s_t, a_t)')
('0.0.2.1', '\\Big\\| \\frac{\\partial{r(s_t, a_t )}}{\\partial{a_t}}  \\Big \\| \\leq L_r')
('0.0.2.1', 'N')
('0.0.2.1', '\\label{euqation:upperbound}\n    \\Big\\| \\nabla_{a_t} Q^{\\pi}(s_t,a_t) \\Big\\|_F \\leq \\frac{\\sqrt{N} L_r}{1- \\gamma L_{\\pi, T}}')
('0.0.2.2', '\\mathop{\\mathbb{E}}\\limits_{s_t \\sim \\mathcal{D}} \\Big[  \\operatorname{Fisher}\\big( \\frac{\\exp{Q(s_t, \\cdot)}}{\\sum_a \\exp{Q(s_t,a)}} , \\mu(\\cdot| s_t) \\big)  \\Big] =  \\nonumber \n    \\mathop{\\mathbb{E}}\\limits_{s_t \\sim \\mathcal{D}, a \\sim \\pi_{emb}(\\cdot | s_t)} \\big[ \\| \\nabla_a Q(s_t,a) - \\nabla_{a} \\log \\mu(a|s_t) \\|_F^2  \\big].')
('0.0.2.2', '\\mu')
('0.0.2.2', '\\pi_{emb}')
('0.0.2.2', 'a \\sim \\pi_{emb}')
('0.0.3', 'W(s_t, a_t) = \\frac{Q(s_t,a_t) - Q_{min}}{Q_{max} - Q_{min}}')
('0.0.3', '\\pi = \\mathop{\\mathrm{arg\\,max}}_{\\pi} \\mathbb{E}_{s_t\\sim \\mathcal{D}} \\Big[\n    Q(s_t, \\pi(s_t)) \\Big] \\ \n    \\operatorname{ s.t. } \\mathbb{E}_{s_t \\sim \\mathcal{D}} [\\operatorname{MMD} \\big(\\beta(s_t), \\pi(\\cdot|s_t)\\big) \\cdot W\\big(s_t, \\beta(s_t)\\big)] \\leq \\epsilon,')
('0.0.3', '\\begin{aligned}\n    \\pi = \\mathop{\\mathrm{arg\\,max}}_{\\pi} \\mathop{\\mathbb{E}}\\limits_{(s_t,a_t)\\sim \\mathcal{D}} \\Big[ \n     \\frac{\\alpha}{\\mathbb{E}[|Q(s_t, a_t)|]} Q(s_t, \\pi(s_t)) - (\\pi(s_t) - a_t)^2 \\cdot W(s_t,a_t)\\Big]\n\\end{aligned}')
('0.0.3', 'W(s_t,a_t)')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4', '\\pm')
('0.0.4.0.0.1', 'X\\%')
('0.0.4.0.0.1', 'X\\%')
('0.0.4.1.0.1', '\\alpha')
('0.0.4.1.0.1', '\\alpha=1')
('0.0.4.1.0.1', '\\alpha=4')
('0.0.4.1.0.3', '\\%')
('0.0.4.1.0.3', '\\%')
('0.0.4.1.0.3', 'X')
('0.0.4.1.0.3', 'X\\pm10')
('1.0.1', '\\| \\frac{\\partial{Q(s_t, a_t)}}{\\partial{a_t}}\\|_F')
('1.0.1', '\\mathbb{E}_{s_{t+k} | s_t}[\\cdot]')
('1.0.1', 's_{t+k}')
('1.0.1', 's_t')
('1.0.1', '\\pi(a_t|s_t)')
('1.0.1', '\\mathbb{E}_{s_t} \\Big[ \\big(\\prod_{j=0}^k \\pi(a_{t+j} | s_{t+j}) T(s_{t+1+j} | s_{t+j} , a_{t+j}) \\big) [\\cdot] \\Big]')
('1.0.1', 'Q^{\\pi}(s_t, a_t)')
('1.0.1', '\\sum_{k=0}^{\\infty} \\gamma^k \\mathbb{E}_{s_{t+k} | s_t} [r(s_{t+k},a_{t+k})]')
('1.0.1', 'i-th')
('1.0.1', 'a_{t}^i')
('1.0.1', '\\pi')
('1.0.1', 'M=\\langle \\mathcal{S}, \\mathcal{A}, T, d_0, r, \\gamma \\rangle')
('1.0.1', 't')
('1.0.1', '\\Big\\| \\frac{\\partial{\\pi(a_{t+1} | s_{t+1}) }}{\\partial{a_t}} \\Big\\|_F \\leq L_{\\pi, T},')
('1.0.1', 'k')
('1.0.1', 't')
('1.0.1', '\\Big| \\nabla_{a_t^i} \\mathbb{E}_{s_{t+k}|s_t} [r(s_{t+k}, a_{t+k})] \\Big|\n    \\leq L_{\\pi, T} \\cdot \\mathbb{E}_{s_{t+1}|s_t}  \\Big| \\nabla_{a_{t+1}^i} \\mathbb{E}_{s_{t+k}|s_{t+1}} [r(s_{t+k}, a_{t+k})] \\Big|.')
('1.0.1', '\\begin{aligned}\n    \\Big| \\nabla_{a_t^i} \\mathbb{E}_{s_{t+k}|s_t} [r(s_{t+k}, a_{t+k})] \\Big|\n    &= \\Big| \\nabla_{a^i_{t+1}} \\mathbb{E}_{s_{t+1}|s_t} \\mathbb{E}_{s_{t+k}|s_{t+1}} [r(s_{t+k}, a_{t+k})] \n    \\cdot \\frac{\\partial{a^i_{t+1}}}{\\partial{a^i_t}}\\Big| \\\\\n    &\\leq \\Big| \\nabla_{a^i_{t+1}} \\mathbb{E}_{s_{t+1}|s_t} \\mathbb{E}_{s_{t+k}|s_{t+1}} [r(s_{t+k}, a_{t+k})] \\Big|\n    \\cdot \\Big|\\frac{\\partial{a^i_{t+1}}}{\\partial{a^i_t}}\\Big| \\\\\n    &=\\Big|\\frac{\\partial{a^i_{t+1}}}{\\partial{a^i_t}}\\Big| \\cdot \n    \\mathbb{E}_{s_{t+1}|s_t} \\Big| \\nabla_{a^i_{t+1}} \\mathbb{E}_{s_{t+k}|s_{t+1}} [r(s_{t+k}, a_{t+k})] \\Big| \\\\\n    &\\leq L_{\\pi, T} \\cdot \\mathbb{E}_{s_{t+1}|s_t}  \\Big| \\nabla_{a^i_{t+1}} \\mathbb{E}_{s_{t+k}|s_{t+1}} [r(s_{t+k}, a_{t+k})] \\Big| \\\\\n\\end{aligned}')
('1.0.1', '\\pi')
('1.0.1', 'M=\\langle \\mathcal{S}, \\mathcal{A}, T, d_0, r, \\gamma \\rangle')
('1.0.1', 't')
('1.0.1', '\\begin{aligned}\n    \\Big\\| \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{a_t}} \\Big\\|_F \\leq L_{\\pi,T} \\\\\n    \\Big\\| \\frac{\\partial{r(s_t, a_t )}}{\\partial{a_t}}  \\Big \\|_F \\leq L_r, \\quad\n\\end{aligned}')
('1.0.1', 't')
('1.0.1', '\\Big| \\nabla_{a_t^i} \\mathbb{E}_{s_{t+k}|s_t} [r(s_{t+k}, a_{t+k})] \\Big| \\leq L_{\\pi,T}^k \\cdot L_r.')
('1.0.1', '\\begin{aligned}\n    \\Big| \\nabla_{a_t^i} \\mathbb{E}_{s_{t+k}|s_t} [r(s_{t+k}, a_{t+k})] \\Big| \n    &\\leq L_{\\pi,T} \\cdot \\mathbb{E}_{s_{t+1}|s_t}  \\Big| \\nabla_{a_{t+1}^i} \\mathbb{E}_{s_{t+k}|s_{t+1}} [r(s_{t+k}, a_{t+k})] \\Big| \\\\\n    &\\leq L_{\\pi,T} \\cdot \\mathbb{E}_{s_{t+1}|s_t} \\cdots L_{\\pi,T} \\cdot \\mathbb{E}_{s_{t+k}|s_{t+k-1}} \\Big| \\nabla_{a_{t+k}^i} \\mathbb{E}_{s_{t+k}|s_{t+k}} [r(s_{t+k}, a_{t+k})] \\Big| \\\\\n    &= L_{\\pi,T}^k \\cdot \\mathbb{E}_{s_{t+k}|s_t}  \\Big| \\nabla_{a_{t+k}^i} \\mathbb{E}_{s_{t+k}|s_{t+k}} [r(s_{t+k}, a_{t+k})] \\Big| \\\\\n    &= L_{\\pi,T}^k \\cdot \\mathbb{E}_{s_{t+k}|s_t} \\Big| \\nabla_{a_{t+k}^i} r(s_{t+k}, a_{t+k}) \\Big| \\\\\n    &\\leq L_{\\pi,T}^k \\cdot \\mathbb{E}_{s_{t+k}|s_t} \\cdot L_r \\\\\n    &= L_{\\pi,T}^k \\cdot L_r\n\\end{aligned}')
('1.0.1', '\\pi(a_t | s_t)')
('1.0.1', 'M=\\langle \\mathcal{S}, \\mathcal{A}, T, d_0, r, \\gamma \\rangle')
('1.0.1', '\\Big\\| \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{a_t}} \\Big\\|_F \\leq L_{\\pi,T} < 1')
('1.0.1', 'r(s_t, a_t)')
('1.0.1', '\\Big\\| \\frac{\\partial{r(s_t, a_t )}}{\\partial{a_t}}  \\Big \\| \\leq L_r')
('1.0.1', 'N')
('1.0.1', '\\label{euqation:upperbound_in_app}\n    \\Big\\| \\nabla_{a_t} Q^{\\pi}(s_t,a_t) \\Big\\|_F \\leq \\frac{\\sqrt{N} L_r}{1- \\gamma L_{\\pi, T}}.')
('1.0.1', '\\begin{aligned}\n    \\Big\\| \\nabla_{a_t} Q^{\\pi}(s_t,a_t) \\Big\\|_F^2 \n    &= \\sum_{i=0}^N \\Big( \\nabla_{a_t^i} Q^{\\pi}(s_t, a_t)\\Big)^2 \\\\\n    &= \\sum_{i=0}^N \\Big( \\sum_{k=0}^{\\infty} \\gamma^k \\nabla_{a_t^i} \\mathbb{E}_{s_{t+k} | s_t}[r(s_{t+k}, a_{t+k})] \\Big)^2 \\\\\n    &\\leq \\sum_{i=0}^N \\Big( \\sum_{k=0}^{\\infty} \\gamma^k \\Big| \\nabla_{a_t^i}  \\mathbb{E}_{s_{t+k} | s_t}[r(s_{t+k}, a_{t+k})] \\Big|\\Big)^2 \\\\\n    &= \\sum_{i=0}^N \\Big( \\sum_{k=0}^{\\infty} \\gamma^k \\cdot L_{\\pi, T}^k \\cdot L_r \\Big)^2 \\\\\n    &= N \\big( L_r \\sum_{k=0}^{\\infty} (\\gamma L_{\\pi, T})^k \\big)^2,\n\\end{aligned}')
('1.0.1', '\\begin{aligned}\n    \\Big\\| \\nabla_{a_t} Q^{\\pi}(s_t,a_t) \\Big\\|_F \n    &\\leq \\sqrt{N} L_r \\sum_{k=0}^{\\infty} (\\gamma L_{\\pi, T})^k \\\\\n    &=  \\frac{\\sqrt{N} L_r}{1- \\gamma L_{\\pi, T}}\n\\end{aligned}')
('1.0.1', 'L_r')
('1.0.1', 'L_{\\pi, T}')
('1.0.1', '\\Big\\| \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{a_t}} \\Big\\|_F')
('1.0.1', 'a_{t+1}')
('1.0.1', 's_{t+1}')
('1.0.1', 'a_t')
('1.0.1', 'L_{\\pi, T}')
('1.0.1', '\\pi')
('1.0.1', 'T')
('1.0.1', "\\begin{aligned}\n    \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{a_t}} \n    &= \\frac{\\partial}{\\partial{a_t}} \\pi\\Big(a_{t+1} | T(s_{t+1} | s_t, a_t)\\Big) \\\\\n    &=  \\frac{\\partial{T(s_{t+1} | s_t, a_t)}}{\\partial{a_t}}  \\cdot \\frac{\\partial{\\pi(a_{t+1} | s')}}{\\partial{s'}} \\Big|_{s' = T(s_{t+1} | s_t, a_t)} \n\\end{aligned}")
('1.0.1', "\\begin{aligned}\n    \\Big \\|  \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{a_t}}  \\Big \\|_F \n    & =  \\Big \\| \\frac{\\partial{T(s_{t+1} | s_t, a_t)}}{\\partial{a_t}}  \\cdot \\frac{\\partial{\\pi(a_{t+1}| s')}}{\\partial{s'}} \\Big|_{s' = T(s_{t+1} | s_t, a_t)}  \\Big \\|_F \\\\\n    &\\leq  \\Big \\| \\frac{\\partial{\\pi(a_{t+1} | s_{t+1})}}{\\partial{s_{t+1}}} \\Big \\|_F \\cdot \\Big \\| \\frac{\\partial{T(s_{t+1} | s_t, a_t)}}{\\partial{a_t}} \\Big \\|_F\n\\end{aligned}")
('1.0.1', 'L_{\\pi,T}')
('1.0.1', '\\pi')
('1.0.1', 'T')
('1.0.2.1.0.0', '\\lambda_{GP}')
('1.0.2.1.0.0', '\\mathcal{L}_{GP}')
('1.0.2.1.0.0', '\\alpha')
('1.0.2.1.0.0', '\\alpha=2.5')
('1.0.2.1.0.0', '\\alpha')
('1.0.2.1.0.0', '\\alpha')
('1.0.2.1.0.0', '\\alpha')
('1.0.2.1.0.0', '\\lambda_{GP}')
('1.0.2.1.0.0', '\\lambda_{GP}')
('1.0.2.1.0.1', '\\alpha=2.5')
('1.0.2.1.0.1', '\\lambda_{GP}')
('1.0.2.1.0.1', '\\lambda_{GP}')
('1.0.2.2', '\\lambda_{GP}=0.02')
('1.0.2.2', '\\lambda_{GP}')
