('1', '\\times')
('3.0', 'W')
('3.0', 'M')
('3.0', '\\label{eq:synflow}\n    \\mathcal{S}_{\\text{SF}}(W^{l}_{ij}) = \n    \\left[\\mathds{1}^T\\prod_{k=l+1}^{N}\\left|W^{k}\\odot M^{k}\\right|\\right]_i \n    \\left|W^{l}_{ij} M^{l}_{ij}\\right| \n    \\left[\\prod_{k=1}^{l-1} \\left|W^{k}\\odot M^{k}\\right|\\mathds{1}\\right]_j,')
('3.0', 'N')
('3.0', 'W^{l}')
('3.0', 'M^{l}')
('3.0', 'l')
('3.0', '\\mathcal{S}_{\\text{SF}}(W^{l}_{ij})')
('3.0', 'W^{l}_{ij}')
('3.0', '\\odot')
('3.0', '|\\cdot|')
('3.0', '\\mathds{1}')
('3.0', 'W')
('3.0', 'M')
('3.0', '\\label{eq:trad}\n\\mbox{maximize } \\sum_{l=1}^N S^{l} \\cdot M^{l} \\quad \\mbox{ over } M \\quad \\mbox{ subject to } \\sum_{l=1}^N \\|M^{l}\\|_0 \\le B_{\\text{params}} \\ ,')
('3.0', 'N')
('3.0', 'S^{l}')
('3.0', 'l')
('3.0', 'M^{l}')
('3.0', 'l')
('3.0', '\\|\\cdot\\|_0')
('3.0', 'B_{\\text{params}}')
('3.1', 'M')
('3.1', 'p_l')
('3.1', 'W_l')
('3.1', 'M_l')
('3.1', 'W_l \\odot M_l')
('3.1', '\\odot')
('3.1', 'l')
('3.1', 'W^l')
('3.1', '\\alpha_l')
('3.1', 'l')
('3.1', 'D^l')
('3.1', 'A^l=\\{M, M_i \\in \\{0, 1\\}\\ \\forall 1\\le i\\le \\alpha_l, \\sum_i M_i = p_l \\times \\alpha_l\\}')
('3.1', 'W^l')
('3.1', 'p_l')
('3.1', 'M^l')
('3.1', 'l')
('3.1', 'A^l')
('3.1', 'M=\\{M^l, \\forall 1\\le l\\le N\\}')
('3.1', 'W=\\{W^l, \\forall 1\\le l\\le N\\}')
('3.1', 'N')
('3.1', 'M')
('3.1', 'W')
('3.1', 'M')
('3.1', 'W')
('3.1', 'M')
('3.1', 'W')
('3.1', '\\begin{aligned}\n\\label{eq:expectation}\n\\mbox{maximize} \\mathop{\\mathbb{E}}_{M, W}[\\mathcal{S}] \n=\\mathop{\\mathbb{E}}_{M, W}\\left[\\sum_{l=1}^N S^{l} \\cdot M^{l}\\right] \\quad \n\\mbox{ over } p_l \\quad \\mbox{ subject to }\n\\sum_{l=1}^N \\alpha_l \\cdot p_l \\le B_{\\text{params}} \\ , \n\\end{aligned}')
('3.1', 'p_l')
('3.1', 'l')
('3.1', '\\alpha_l')
('3.1', 'l')
('3.1', '\\mathop{\\mathbb{E}}_{M, W}[\\mathcal{S}]')
('3.1', '\\mathcal{S}')
('3.1', 'W')
('3.1', 'M')
('3.1', 'p_l')
('3.1', '\\mathcal{S}')
('3.1', '\\mathcal{S}_\\text{SF}')
('3.1', '\\mathbb{E}_{[M, W]} [\\mathcal{S}_\\text{SF}]')
('3.1', 'p_l')
('3.1', '\\label{eq:goal}\n\\mathop{\\mathbb{E}}_{M, W}[\\mathcal{S}_\\text{SF}] \n= N C_{N+1}\\prod_{l=1}^N (p_l C_{l} \\cdot \\mathbb{E}_{x\\sim \\mathcal{D}}[|x|]) \\ ,')
('3.1', 'N')
('3.1', '\\mathbb{E}_{x\\sim \\mathcal{D}}[|x|]')
('3.1', '\\mathcal{D}')
('3.1', 'C_l')
('3.1', 'l')
('3.1', 'l-1')
('3.1', 'p_l=\\frac{1}{\\alpha_l} \\|M_l\\|_0')
('3.1', 'N')
('3.1', 'C^l')
('3.1', '\\mathbb{E}_{|\\mathcal{D}^l|}')
('3.1', '\\mathcal{D}^l')
('3.1', 'p_l')
('3.1', 'p_l')
('3.1', 'p_l')
('3.2.0', 'B_\\text{params}')
('3.2.0', 'B_\\text{params}')
('3.2.0', 'p_l')
('3.2.0', '\\begin{aligned}\n\\label{eq:opt_params}\n\\begin{split}\n\\mbox{maximize } \\sum_{l=1}^N \\log p_l \\quad \\mbox{ over } p_l \\quad\n\\text{ subject to } \\\n& \\sum_{l=1}^N \\alpha_l \\cdot p_l \\le B_{\\text{params}} \\ , \\\\\n& 0<p_l \\le 1, \\forall 1\\le l \\le N \\ , \n\\end{split}\n\\end{aligned}')
('3.2.0', '\\alpha_l')
('3.2.0', 'l')
('3.2.1', 'B_{\\text{FLOPs}}')
('3.2.1', '\\begin{aligned}\n\\label{eq:opt_both}\n\\begin{split}\n\\mbox{maximize }\\sum_{l=1}^N \\log p_l \\quad \\mbox{ over } p_l  \\quad\n\\text{ subject to } \\\n& \\sum_{l=1}^N \\alpha_l \\cdot p_l \\le B_{\\text{params}}, \\sum_{l=1}^N \\beta_l \\cdot p_l \\le B_{\\text{FLOPs}} \\\\\n& 0<p_l \\le 1, \\forall 1\\le l \\le N,\n\\end{split}\n\\end{aligned}')
('3.2.1', '\\beta_l')
('3.2.1', 'l^{th}')
('3.2.1', 'B_\\text{params}')
('3.2.1', 'B_\\text{FLOPs}')
('3.2.1', '1.5\\times 10^4')
('4.0', 'C_{l}')
('4.0', 'C_{l+1}')
('4.0', 'l')
('4.0', 'l+1')
('4.0', 'p_l')
('4.0', 'l')
('4.0', 'p_l')
('4.0', 'C_l')
('4.0', 'C_{l+1}')
('4.0', 'l')
('4.0', 'l+1')
('4.0', 'C_{l+1}')
('4.0', 'l')
('4.0', 'l')
('4.0', '\\left\\lfloor\\sqrt{p_l} \\cdot C_{l+1}\\right\\rfloor')
('4.0', 'l+1')
('4.0', 'l')
('4.0', '\\left\\lfloor\\sqrt{p_{l}} \\cdot C_{l+1}\\right\\rfloor')
('4.0', 'l')
('4.0', '\\sqrt{p_{l-1} \\cdot p_l}')
('4.0', 'p_l')
('4.0', '\\sqrt{p_{l-1}\\cdot p_l}')
('4.0', 'p_l')
('4.0', 'p')
('4.0', 'p_lC_l\\ll C_{l+1}')
('4.0', 'C_l \\gg p_l C_{l+1}')
('4.0', 'l')
('4.0', 'C_l')
('4.0', 'C_{l+1}')
('4.0', '\\sqrt{p_l}C_l')
('4.0', '\\sqrt{p_l}C_{l+1}')
('4.0', 'l')
('4.0', 'l')
('4.0', 'l')
('4.0', 'l')
('4.0', '\\sqrt{p_l}C_{l+1}')
('4.0', 'l')
('4.1', '1')
('4.1', 'p_l\\le 1')
('4.1', 'p_l \\le 1')
('4.1', 'p_l>1')
('4.1', 'p_l<1')
('4.1', 'B_{\\text{params}}')
('4.1', 'B_{\\text{FLOPs}}')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.0', '^\\dagger')
('5.1', '0.3\\%')
('5.1', '20\\%')
('5.1', '3\\%')
('5.1', '0.3\\%')
('5.1', '80\\%')
('7', '\\mathbb{E}_{[M, W]} [\\mathcal{S}_\\text{SF}]')
('7', 'p_l')
('7', '\\mathop{\\mathbb{E}}_{M, W}[\\mathcal{S}_\\text{SF}] \n= N C_{N+1}\\prod_{l=1}^N (p_l C_{l} \\cdot \\mathbb{E}_{x\\sim \\mathcal{D}}[|x|]) \\ ,')
('7', 'N')
('7', '\\mathbb{E}_{x\\sim \\mathcal{D}}[|x|]')
('7', '\\mathcal{D}')
('7', 'C_l')
('7', 'l')
('7', 'l-1')
('7', 'p_l=\\frac{1}{\\alpha_l} \\|M_l\\|_0')
('7', 'N')
('7', 'W^l \\in \\mathbb{R}^{m_l \\times n_l}')
('7', 'M^l \\in \\{0, 1\\}^{C_l \\times C_{l+1}}')
('7', 'C_l')
('7', 'C_{l+1}')
('7', 'l')
('7', 'l')
('7', 'l+1')
('7', 'C_{l+1} = C_{l+1}, \\forall l<N')
('7', 'W^l_{ij}')
('7', 'M^l_{ij}')
('7', 'l')
('7', '\\begin{aligned}\n\\begin{split}\n\\label{eq:loss}\n    \\mathcal{S}_{\\text{SF}}(W^l_{(i,j)})\n    &=\\left[\\mathds{1}^T\\prod_{k=l+1}^{N}\\left|W^k\\odot M^k\\right|\\right]_i\n    \\left|W^l_{(i, j)} M^l_{(i,j)}\\right| \n    \\left[\\prod_{k=1}^{l-1} \\left|W^k\\odot M^k\\right|\\mathds{1}\\right]_j \n\\end{split}\n\\end{aligned}')
('7', 'l')
('7', '\\mathbb{E}_{[M, W]}(\\mathcal{S}_\\text{SF})^{[l]}')
('7', '\\label{eq:sum}\n    \\mathbb{E}_{[M, W]}(\\mathcal{S}_\\text{SF}) = \\sum_{l=1}^N \\mathbb{E}_{[M, W]}(\\mathcal{S}_\\text{SF})^{[l]}')
('7', 'i')
('7', 'j')
('7', 'l')
('7', 'E^l_{(i, *)}')
('7', 'E^l_{(*, j)}')
('7', 'E^l_{(*, *)}')
('7', '\\begin{aligned}\n    &\\mathbb{E}^l_{(i, *)} = \\frac{1}{C_{l+1}} \\sum_{x}|W^l_{(i, x)} M^l_{(i ,x)}| \\\\\n    &\\mathbb{E}^l_{(*, j)} = \\frac{1}{C_l} \\sum_{x}|W^l_{(x, j)} M^l_{(x ,j)}| \\\\\n    &\\mathbb{E}^l_{(i, j)} =\\mathbb{E}^l_{(*, *)} = \\frac{1}{C_lC_{l+1}} \\sum_{i, j}|W^l_{(i, j)} M^l_{(i ,j)}| \n    = \\frac{1}{\\alpha_l} \\sum_{i, j}|W^l_{(i, j)} M^l_{(i ,j)}|  \n    = p_l \\mathbb{E}_{|\\mathcal{D}^l|} \n\\end{aligned}')
('7', '\\mathbb{E}_{|\\mathcal{D}^l|}')
('7', '\\mathbb{E}_{x\\sim \\mathcal{D}}[|x|]')
('7', 'l')
('7', '\\mathcal{D}')
('7', '\\mathbb{E}^{[k]}_{(*, *)} \n    = \\mathbb{E}^k_{(i, *)} \n    = \\mathbb{E}^k_{(*, j)} \n    % = p_l \\E_{x\\sim \\mathcal{D}}[|x|]\n    = p_l \\mathbb{E}_{|\\mathcal{D}^l|}')
('7', 'E^k_{(i, *)}')
('7', 'E^k_{(*, j)}')
('7', 'E^l_{(*, *)}')
('7', '\\begin{aligned}\n\\begin{split}\n\\label{eq:loss_f}\n    \\mathbb{E}[\\mathcal{S}_{\\text{SF}}(W^l_{(i,j)})] &= \n    \\left( \\prod_{k=l+2}^{N} C_{k+1} \\mathbb{E}^k_{(*, *)} \\right) \\cdot\n    C_{l+2}\\mathbb{E}^{l+1}_{(i, *)} \\cdot\n    \\mathbb{E}^{l}_{(i, j)} \\cdot\n    C_{l-1}\\mathbb{E}^{l-1}_{(*, j)} \\cdot\n    \\left( \\prod_{k=1}^{l-2} C_k E^k_{(*, *)} \\right) \n\\end{split}\n\\end{aligned}')
('7', '\\begin{aligned}\n\\begin{split}\n    &\\mathbb{E}_{[M, W]}(\\mathcal{S}_\\text{SF})^{[l]} = \n    \\mathbb{E}\\left[ \\sum_{i=1}^{C_l}\\sum_{j=1}^{C_{l+1}}\\mathcal{S}_{\\text{SF}}(W^l_{(i,j)}) \\right]\n    = \\sum_{i=1}^{C_l}\\sum_{j=1}^{C_{l+1}} \\mathbb{E}\\left[\\mathcal{S}_{\\text{SF}}(W^l_{(i,j)}) \\right] \\\\\n    & = \\left( \\prod_{k=l+2}^{N} p_k C_{k+1} \\mathbb{E}_{|\\mathcal{D}^k|} \\right) \n    \\sum_{i=1}^{C_l}\\sum_{j=1}^{C_{l+1}} \\left(\n    p_{l+1} C_{l+2}\\mathbb{E}^{l+1}_{(i, *)} \\cdot\n    p_{l} \\mathbb{E}_{|\\mathcal{D}^l|} \\cdot\n    p_{l-1}C_{l-1}\\mathbb{E}^{l-1}_{(*, j)} \\right)\n    \\left( \\prod_{k=1}^{l-2} C_k \\mathbb{E}_{|\\mathcal{D}^k|} \\right)  \\\\\n    & = \\left( \\prod_{k=l+2}^{N} p_k C_{k+1} \\mathbb{E}_{|\\mathcal{D}^k|} \\right) \n    C_l C_{l+1}\\left(\n    p_{l+1}C_{l+2}\\mathbb{E}_{|\\mathcal{D}^{l+1}|} \\cdot\n    p_{l}\\mathbb{E}_{|\\mathcal{D}^l|} \\cdot\n    p_{l-1}C_{l-1}\\mathbb{E}_{|\\mathcal{D}^{l-1}|} \\right)\n    \\left( \\prod_{k=1}^{l-2} p_k C_k \\mathbb{E}_{|\\mathcal{D}^k|} \\right)  \\\\\n    & = C_{N+1}\\prod_{l=1}^N (p_lC_{l} \\mathbb{E}_{|\\mathcal{D}^l|})\n\\end{split}\n\\end{aligned}')
('7', '\\begin{aligned}\n\\begin{split}\n\\mathbb{E}_{[M, W]}(\\mathcal{S}_\\text{SF}) \n&= \\sum_{l=1}^N C_{N+1}\\prod_{l=1}^N (C_{l} \\mathbb{E}_{|\\mathcal{D}^l|}) \\\\\n&= N C_{N+1}\\prod_{l=1}^N (p_l C_{l} \\cdot \\mathbb{E}_{x\\sim \\mathcal{D}}[|x|]),\n\\end{split}\n\\end{aligned}')
('7', '\\frac{K^2}{C_{l+1}}')
('7', 'K')
('8.0', '\\begin{aligned}\n\\begin{split}\n& p_l = \\min(\\frac{\\mu}{\\alpha}, 1) \\\\\n\\text{where $\\mu$ satisfies: } &\\sum_{l=1}^N \\min(\\alpha_l, \\mu) = B_\\text{params}\n\\end{split}\n\\end{aligned}')
('8.1', '\\begin{aligned}\n\\begin{split}\n& p_l = \\min(\\frac{1}{\\mu_1\\alpha_l + \\mu_2\\beta_l}, 1)\\\\\n\\text{where $\\mu_1, \\mu_2$ satisfy: }\n&\\sum_{l=1}^N \\alpha_l \\min(\\frac{1}{\\mu_1\\alpha_l + \\mu_2\\beta_l}, 1) = B_\\text{params}\\\\\n&\\sum_{l=1}^N \\beta_l \\min(\\frac{1}{\\mu_1\\alpha_l + \\mu_2\\beta_l}, 1) = B_\\text{flops}\n\\end{split}\n\\end{aligned}')
('8.2', '\\begin{aligned}\n\\begin{split}\n& p_l = \\frac{1}{\\mu_1\\alpha_l + \\mu_2\\beta_l}\\\\\n\\text{where $\\mu_1, \\mu_2$ satisfy: }\n&\\sum_{l=1}^N \\alpha_l \\frac{1}{\\mu_1\\alpha_l + \\mu_2\\beta_l} = B_\\text{params}\\\\\n&\\sum_{l=1}^N \\beta_l \\frac{1}{\\mu_1\\alpha_l + \\mu_2\\beta_l} = B_\\text{flops}\n\\end{split}\n\\end{aligned}')
('8.2', '\\mu')
('9', 'p_l')
('9', 'p_l')
('11.1', '10^{-4}')
('11.1', '4\\times 10^{-5}')
('11.1', '10^{-4}')
('11.1', '4 \\times 10^{-5}')
