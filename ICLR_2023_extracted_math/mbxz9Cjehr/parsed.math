('2.0', '\\ensuremath{\\overline{\\mathbb{R}}}')
('2.0', '\\ensuremath{\\mathbb{R}}\\cup \\{ \\infty \\}')
('2.0', '\\mathcal{S}')
('2.0', '\\mathcal{A}')
('2.0', '\\Pi')
('2.0', '\\mathcal{A}')
('2.0', '\\mathcal{S}')
('2.0', "P(s'|s,a)")
('2.0', '\\gamma')
('2.0', '\\pi\\in\\Pi')
('2.0', '\\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)] \\triangleq \\ensuremath{\\mathbb{E}}\\left[\\sum_{t=0}^\\infty \\gamma^t c(s_t,a_t)\\right]')
('2.0', 's_0 \\sim p_0')
('2.0', 'a_t \\sim \\pi(\\cdot|s_t)')
('2.0', 's_{t+1}\\sim P(\\cdot|s_t,a_t)')
('2.0', 't\\geq 0')
('2.0', '\\hat\\ensuremath{\\mathbb{E}}_\\tau')
('2.0', '\\tau')
('2.0', '\\pi_E')
('2.0.0', '\\pi_E')
('2.0.0', '\\mathcal{C}')
('2.0.0', '\\begin{aligned}\n\\mathop{\\mathrm{maximize}}_{c\\in\\mathcal{C}} \\left(\\min_{\\pi\\in\\Pi} -H(\\pi) + \\ensuremath{\\mathbb{E}}_{\\pi} [c(s,a)]\\right) - \\ensuremath{\\mathbb{E}}_{\\pi_E} [c(s,a)] \\label{eq:irl}\n\\end{aligned}')
('2.0.0', 'H(\\pi) \\triangleq \\mathbb{E}_{\\pi}[-\\log \\pi(a|s)]')
('2.0.0', '\\gamma')
('2.0.0', '\\pi')
('2.0.0', '\\pi_E')
('2.0.0', '\\pi_E')
('2.0.0', '\\pi_E')
('2.0.0', 'c\\in\\mathcal{C}')
('2.0.0', '\\begin{aligned}\n\\mathop{\\mathrm{RL}}(c) = \\mathop{\\mathrm{arg\\,min}}_{\\pi\\in\\Pi} -H(\\pi) + \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)]\n\\end{aligned}')
('3', '\\mathcal{C}')
('3', '\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}= \\{c : \\mathcal{S}\\times\\mathcal{A}\\rightarrow\\ensuremath{\\mathbb{R}}\\}')
('3', '\\mathcal{C} = \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}')
('3', '\\mathcal{C}')
('3', '\\psi : \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}\\rightarrow \\ensuremath{\\overline{\\mathbb{R}}}')
('3', '\\psi')
('3', '\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}')
('3', '\\psi')
('3', '\\psi')
('3', '\\begin{aligned}\n\\mathop{\\mathrm{IRL}}_\\psi (\\pi_E) = \\mathop{\\mathrm{arg\\,max}}_{c\\in\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}} -\\psi(c) + \\left(\\min_{\\pi\\in\\Pi} -H(\\pi) + \\ensuremath{\\mathbb{E}}_{\\pi} [c(s,a)]\\right) - \\ensuremath{\\mathbb{E}}_{\\pi_E} [c(s,a)]\n\\end{aligned}')
('3', '\\tilde c \\in \\mathop{\\mathrm{IRL}}_\\psi(\\pi_E)')
('3', '\\mathop{\\mathrm{RL}}(\\tilde c)')
('3', '\\mathop{\\mathrm{RL}}(\\tilde c)')
('3', '\\pi\\in\\Pi')
('3', '\\rho_\\pi : \\mathcal{S}\\times\\mathcal{A}\\rightarrow\\ensuremath{\\mathbb{R}}')
('3', '\\rho_\\pi(s,a) = \\pi(a|s) \\sum_{t=0}^\\infty \\gamma^t P(s_t=s|\\pi)')
('3', '\\pi')
('3', '\\mathbb{E}_\\pi[c(s,a)] = \\sum_{s,a}\\rho_\\pi(s,a)c(s,a)')
('3', 'c')
('3', '\\mathcal{D} \\triangleq \\{\\rho_\\pi : \\pi \\in \\Pi \\}')
('3', 'p_0(s)')
('3', "P(s'|s,a)")
('3', "\\mathcal{D} = \\left\\{\\rho : \\rho \\geq 0\\quad  \\mathrm{and}\\quad \\sum_a \\rho(s,a) = p_0(s) + \\gamma \\sum_{s', a}P(s|s',a)\\rho(s',a)\\ \\ \\forall \\ s \\in \\mathcal{S}\n\\right\\}")
('3', '\\Pi')
('3', '\\mathcal{D}')
('3', '\\rho \\in \\mathcal{D}')
('3', '\\rho')
('3', "\\pi_\\rho(a|s) \\triangleq \\rho(s,a)/\\sum_{a'} \\rho(s,a')")
('3', '\\pi_\\rho')
('3', '\\rho')
('3', '\\pi_\\rho')
('3', '\\rho')
('3', 'f : \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}\\rightarrow \\ensuremath{\\overline{\\mathbb{R}}}')
('3', 'f^* : \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}\\rightarrow \\ensuremath{\\overline{\\mathbb{R}}}')
('3', 'f^*(x) = \\sup_{y \\in \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}} x^Ty - f(y)')
('3', '\\mathop{\\mathrm{RL}}(\\tilde c)')
('3', '\\mathop{\\mathrm{RL}}\\circ \\mathop{\\mathrm{IRL}}_{\\psi} (\\pi_E) = \\mathop{\\mathrm{arg\\,min}}_{\\pi\\in\\Pi} -H(\\pi) + \\psi^*(\\rho_\\pi - \\rho_{\\pi_E}) \\hfill \\stepcounter{equation}\\ (\\theequation)')
('3', '\\psi')
('3', '\\psi^*')
('3', '\\psi')
('3', '\\psi')
('3', '\\psi')
('3', '\\psi')
('3', '\\tilde c \\in \\mathop{\\mathrm{IRL}}_\\psi(\\pi_E)')
('3', '\\tilde\\pi \\in \\mathop{\\mathrm{RL}}(\\tilde c)')
('3', '\\rho_{\\tilde\\pi} = \\rho_{\\pi_E}')
('3', "\\bar H(\\rho) = -\\sum_{s,a} \\rho(s,a)\\log ( \\rho(s,a) / \\sum_{a'}\\rho(s,a') )")
('3', '\\bar H')
('3', '\\pi \\in \\Pi')
('3', '\\rho \\in \\mathcal{D}')
('3', 'H(\\pi) = \\bar H(\\rho_\\pi)')
('3', '\\bar H(\\rho) = H(\\pi_\\rho)')
('3', 'L(\\pi,c) = -H(\\pi) + \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)]')
('3', '\\bar L(\\rho,c) = -\\bar H(\\rho) + \\sum_{s,a}\\rho(s,a)c(s,a)')
('3', 'c')
('3', 'L(\\pi,c) = \\bar L(\\rho_\\pi, c)')
('3', '\\pi \\in \\Pi')
('3', '\\bar L(\\rho, c)  = L(\\pi_\\rho, c)')
('3', '\\rho \\in \\mathcal{D}')
('3', '\\bar L(\\rho,c) = -\\bar H(\\rho) + \\sum_{s,a}c(s,a)(\\rho(s,a) - \\rho_E(s,a))')
('3', '\\psi')
('3', '\\begin{aligned}\n\\tilde c &\\in \\mathop{\\mathrm{IRL}}_\\psi(\\pi_E) = \\mathop{\\mathrm{arg\\,max}}_{c\\in\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}} \\min_{\\pi \\in \\Pi} -H(\\pi) + \\ensuremath{\\mathbb{E}}_\\pi[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)] + \\mathrm{const.}\\\\\n&= \\mathop{\\mathrm{arg\\,max}}_{c\\in\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}} \\min_{\\rho \\in \\mathcal{D}} -\\bar H(\\rho) + \\sum_{s,a}\\rho(s,a)c(s,a) - \\sum_{s,a}\\rho_E(s,a)c(s,a) \n= \\mathop{\\mathrm{arg\\,max}}_{c\\in\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}} \\min_{\\rho \\in \\mathcal{D}} \\bar L(\\rho,c).\n\\end{aligned}')
('3', '\\begin{aligned}\n\\label{eq:primal}\n\\mathop{\\mathrm{minimize}}_{\\rho \\in \\mathcal{D}} -\\bar H(\\rho) \\quad \\text{subject to }\\quad \\rho(s,a) = \\rho_E(s,a) \\quad \\forall\\ s\\in\\mathcal{S},a\\in\\mathcal{A}\n\\end{aligned}')
('3', '\\bar L')
('3', 'c(s,a)')
('3', '\\tilde c')
('3', '\\mathcal{D}')
('3', '-\\bar H')
('3', '-\\bar H')
('3', '\\tilde \\rho = \\mathop{\\mathrm{arg\\,min}}_{\\rho\\in\\mathcal{D}} \\bar L(\\rho,\\tilde c) = \\mathop{\\mathrm{arg\\,min}}_{\\rho\\in\\mathcal{D}} -\\bar H(\\rho) + \\sum_{s,a} \\tilde c(s,a) \\rho(s,a) = \\rho_E,')
('3', '\\tilde\\rho')
('3', '\\bar L(\\cdot, \\tilde c)')
('3', '\\tilde\\pi \\in \\mathop{\\mathrm{RL}}(\\tilde c)')
('3', '\\rho_{\\tilde\\pi} = \\tilde\\rho = \\rho_E')
('4', '\\psi')
('4', '\\pi_\\theta')
('4', '\\theta')
('4', '\\ensuremath{\\mathcal{S}}\\times\\ensuremath{\\mathcal{A}}')
('4', '\\begin{aligned}\n\\mathop{\\mathrm{minimize}}_\\pi\\ d_\\psi(\\rho_\\pi, \\rho_E) - H(\\pi) \\label{eq:costobjective}\n\\end{aligned}')
('4', '\\psi')
('4', 'd_\\psi(\\rho_\\pi, \\rho_E) \\triangleq \\psi^*(\\rho_\\pi - \\rho_E)')
('4.0', '\\psi')
('4.0', '\\mathcal{C} \\subset \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}')
('4.0', '\\mathcal{C}')
('4.0', '\\begin{aligned}\n\\mathop{\\mathrm{minimize}}_\\pi\\ \\max_{c \\in \\mathcal{C}} \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)] \\label{eq:apprenticeship}\n\\end{aligned}')
('4.0', '\\mathcal{C}')
('4.0', 'f_1, \\dotsc, f_d')
('4.0', 'f(s,a) = [f_1(s,a), \\dotsc, f_d(s,a)]')
('4.0', '\\begin{aligned}\n\\mathcal{C_\\text{linear}} = \\left\\{ \\textstyle{\\sum}_i w_i f_i \\ :\\  \\|w\\|_2 \\leq 1 \\right\\} \\quad \\text{and}\\quad\n\\mathcal{C_\\text{convex}} = \\left\\{ \\textstyle{\\sum}_i w_i f_i \\ :\\  \\textstyle{\\sum}_i w_i = 1, w_i \\geq 0 \\ \\forall i \\right\\}. \\label{eq:linconvcosts}\n\\end{aligned}')
('4.0', '\\mathcal{C_\\text{linear}}')
('4.0', '\\ell_2')
('4.0', '\\max_{c \\in \\mathcal{C_\\text{linear}}} \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)] = \\|\\ensuremath{\\mathbb{E}}_{\\pi}[f(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[f(s,a)] \\|_2')
('4.0', '\\mathcal{C}_{\\text{convex}}')
('4.0', '\\max_{c \\in \\mathcal{C_\\text{convex}}} \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)] = \\max_{i \\in \\{1, \\dotsc, d\\}} \\ensuremath{\\mathbb{E}}_{\\pi}[f_i(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[f_i(s,a)]')
('4.0', '\\psi')
('4.0', '\\delta_{\\mathcal{C}} : \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}\\rightarrow \\ensuremath{\\overline{\\mathbb{R}}}')
('4.0', '\\delta_{\\mathcal{C}}(c) = 0')
('4.0', 'c \\in \\mathcal{C}')
('4.0', '+\\infty')
('4.0', '\\begin{aligned}\n\\max_{c \\in \\mathcal{C}} \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)]\\!-\\!\\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)] = \\!\\!\\max_{c\\in\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}} \\!\\!-\\delta_{\\mathcal{C}}(c)  + \\sum_{s,a} (\\rho_\\pi(s,a)\\!-\\!\\rho_{\\pi_E}\\!(s,a)) c(s,a) = \\delta_{\\mathcal{C}}^*(\\rho_\\pi\\!-\\!\\rho_{\\pi_E}\\!)\n\\end{aligned}')
('4.0', '\\begin{aligned}\n\\label{eq:erAL}\n\\mathop{\\mathrm{minimize}}_\\pi -H(\\pi) + \\max_{c \\in \\mathcal{C}} \\ensuremath{\\mathbb{E}}_{\\pi}[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)]\n\\end{aligned}')
('4.0', '\\psi = \\delta_{\\mathcal{C}}')
('4.0', '\\mathcal{C}')
('4.0', '\\mathcal{C}')
('4.0', '\\alpha')
('4.0', '\\{\\alpha c : c \\in \\mathcal{C}\\}')
('4.0', '\\alpha \\rightarrow \\infty')
('4.0.0', '\\mathcal{C}')
('4.0.0', 'f_1, \\dotsc, f_d')
('4.0.0', '\\mathcal{C}')
('4.0.0', '\\pi')
('4.0.0', '\\pi_E')
('4.0.0', '\\mathcal{C}')
('4.0.0', '\\pi')
('4.0.0', '\\pi_E')
('4.0.0', '\\pi_E')
('4.0.0', '\\mathcal{C}')
('4.0.0', '\\mathcal{C}')
('4.0.0.0', '\\mathcal{C}')
('4.0.0.0', '\\mathcal{C}')
('4.0.0.0', '\\pi_\\theta')
('4.0.0.0', '\\begin{aligned}\n \\begin{split}\n&\\nabla_\\theta \\max_{c \\in \\mathcal{C}} \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)] = \\nabla_\\theta \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[c^*(s,a)] = \\ensuremath{\\mathbb{E}}_{\\pi_\\theta} \\left[\\nabla_\\theta \\log\\pi_\\theta(a|s) Q_{c^*}(s,a) \\right] \\label{eq:apprpolicygrad} \\\\\n&\\text{where} \\ c^* \\!= \\mathop{\\mathrm{arg\\,max}}_{c\\in\\mathcal{C}} \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[c(s,a)] - \\ensuremath{\\mathbb{E}}_{\\pi_E}[c(s,a)],\n \\ Q_{c^*}(\\bar s,\\bar a) = \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[c^*(\\bar s, \\bar a) \\,|\\, s_0=\\bar s,a_0=\\bar a]\n\\end{split} \n\\end{aligned}')
('4.0.0.0', 'c^*')
('4.0.0.0', '\\pi_{\\theta_i}')
('4.0.0.0', 'c^*_i')
('4.0.0.0', '\\mathcal{C}_\\text{linear}')
('4.0.0.0', '\\mathcal{C}_\\text{convex}')
('4.0.0.0', 'c^*_i')
('4.0.0.0', '\\pi_{\\theta_{i+1}}')
('4.0.0.0', '\\pi_{\\theta_{i+1}}')
('4.0.0.0', '\\pi_{\\theta_i}')
('4.0.0.0', '\\psi')
('4.0.0.0', '\\mathcal{C}_\\text{linear}')
('4.0.0.0', '\\mathcal{C}_\\text{convex}')
('5', '\\begin{aligned}\n \\label{eq:psiga}\n\\ensuremath{\\psi_\\text{GA}}(c) \\triangleq \\begin{dcases*} \\ensuremath{\\mathbb{E}}_{\\pi_E}[g(c(s,a))] & if $c < 0$ \\\\ +\\infty & otherwise \\end{dcases*} \\ \\text{where}\\ g(x) = \\begin{dcases*}-x-\\log(1-e^x) & if $x < 0$ \\\\ +\\infty & otherwise\\end{dcases*}\n\\end{aligned}')
('5', 'c')
('5', 'c')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', 'c')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', '\\delta_\\mathcal{C}')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', '\\delta_\\mathcal{C}')
('5', '\\delta_\\mathcal{C}')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', '\\ensuremath{\\psi_\\text{GA}}')
('5', '\\begin{aligned}\n\\ensuremath{\\psi_\\text{GA}}^*(\\rho_\\pi - \\rho_{\\pi_E}) = \\max_{D \\in (0,1)^{\\mathcal{S} \\times \\mathcal{A}}} \\ensuremath{\\mathbb{E}}_{\\pi}[\\log(D(s,a))] + \\ensuremath{\\mathbb{E}}_{\\pi_E}[\\log(1-D(s,a))] \\label{eq:galoss}\n\\end{aligned}')
('5', 'D : \\mathcal{S} \\times \\mathcal{A} \\rightarrow (0,1)')
('5', '\\pi')
('5', '\\pi_E')
('5', 'D_{\\text{JS}}(\\rho_\\pi, \\rho_{\\pi_E}) \\triangleq D_{\\text{KL}}\\left(\\rho_\\pi \\middle\\| (\\rho_\\pi+\\rho_E)/2\\right) + D_{\\text{KL}}\\left(\\rho_E \\middle\\| (\\rho_\\pi+\\rho_E)/2\\right)')
('5', 'H')
('5', '\\lambda \\geq 0')
('5', '\\begin{aligned}\n\\mathop{\\mathrm{minimize}}_\\pi \\ \\ensuremath{\\psi_\\text{GA}}^*(\\rho_\\pi - \\rho_{\\pi_E}) - \\lambda H(\\pi) = D_{\\text{JS}}(\\rho_\\pi, \\rho_{\\pi_E}) - \\lambda H(\\pi), \\label{eq:gail}\n\\end{aligned}')
('5.0', 'G')
('5.0', 'D')
('5.0', 'D')
('5.0', 'G')
('5.0', 'D')
('5.0', 'G')
('5.0', 'G')
('5.0', '\\rho_\\pi')
('5.0', 'G')
('5.0', '\\rho_{\\pi_E}')
('5.0', '(\\pi, D)')
('5.0', '\\begin{aligned}\n\\ensuremath{\\mathbb{E}}_{\\pi}[\\log(D(s,a))] + \\ensuremath{\\mathbb{E}}_{\\pi_E}[\\log(1-D(s,a))] - \\lambda H(\\pi) \\label{eq:gailexplicit}\n\\end{aligned}')
('5.0', '\\pi')
('5.0', 'D')
('5.0', '\\pi_\\theta')
('5.0', '\\theta')
('5.0', 'D_w : \\mathcal{S}\\times\\mathcal{A}\\rightarrow (0,1)')
('5.0', 'w')
('5.0', 'w')
('5.0', 'D')
('5.0', '\\theta')
('5.0', '\\pi')
('5.0', 'c(s,a) = \\log D(s,a)')
('5.0', '\\nabla_\\theta H(\\pi_\\theta)')
('5.0', '\\tau_E \\sim \\pi_E')
('5.0', '\\theta_0, w_0')
('5.0', '\\tau_i \\sim \\pi_{\\theta_i}')
('5.0', 'w_i')
('5.0', 'w_{i+1}')
('5.0', '\\begin{aligned}\n \\hat\\ensuremath{\\mathbb{E}}_{\\tau_i}[\\nabla_w  \\log(D_w(s,a))] + \\hat\\ensuremath{\\mathbb{E}}_{\\tau_E}[  \\nabla_w  \\log(1-D_w(s,a))] \n\\end{aligned}')
('5.0', '\\theta_i')
('5.0', '\\theta_{i+1}')
('5.0', '\\log(D_{w_{i+1}}(s,a))')
('5.0', '\\begin{aligned}\n \\begin{split}\n                &\\hat\\ensuremath{\\mathbb{E}}_{\\tau_i} \\left[\\nabla_\\theta \\log\\pi_\\theta(a|s) Q(s,a) \\right] - \\lambda \\nabla_\\theta H(\\pi_\\theta),  \\label{eq:gailgrad} \\\\\n                &\\text{where}\\ Q(\\bar s, \\bar a) = \\hat\\ensuremath{\\mathbb{E}}_{\\tau_i}[\\log(D_{w_{i+1}}(s,a)) \\,|\\, s_0=\\bar s,a_0=\\bar a]\n                \\end{split}\n\\end{aligned}')
('6', '\\mathcal{C}_\\text{linear}')
('6', '\\mathcal{C}_\\text{convex}')
('6', '\\tanh')
('6', '\\lambda=0')
('6', '\\lambda=10^{-3}')
('6', 'p=.05')
('6', 'y')
('6', '\\lambda')
('8.0', '\\bar H')
('8.0', '\\rho')
('8.0', "\\rho'")
('8.0', '\\lambda \\in [0,1]')
('8.0', 's')
('8.0', 'a')
('8.0', "\\begin{aligned}\n  - &(\\lambda \\rho(s,a) + (1-\\lambda)\\rho'(s,a) )\\log \\frac{\\lambda \\rho(s,a) + (1-\\lambda)\\rho'(s,a) }{\\sum_{a'}(\\lambda \\rho(s,a') + (1-\\lambda)\\rho'(s,a') )} \\\\\n &= -(\\lambda \\rho(s,a) + (1-\\lambda)\\rho'(s,a) )\\log \\frac{\\lambda \\rho(s,a) + (1-\\lambda)\\rho'(s,a) }{\\lambda \\sum_{a'}\\rho(s,a') + (1-\\lambda)\\sum_{a'}\\rho'(s,a')} \\\\\n &\\geq -\\lambda \\rho(s,a)\\log\\frac{\\lambda\\rho(s,a)}{\\lambda\\sum_{a'}\\rho(s,a')} - (1-\\lambda)\\rho'(s,a)\\log\\frac{(1-\\lambda)\\rho'(s,a)}{(1-\\lambda)\\sum_{a'}\\rho'(s,a')} \\\\\n &= \\lambda \\left(-\\rho(s,a)\\log\\frac{\\rho(s,a)}{\\sum_{a'}\\rho(s,a')}\\right) + (1-\\lambda)\\left(-\\rho'(s,a)\\log\\frac{\\rho'(s,a)}{\\sum_{a'}\\rho'(s,a')}\\right),\n \n\\end{aligned}")
('8.0', "\\pi_\\rho \\triangleq \\rho(s,a)/\\sum_{a'}\\rho(s,a') = \\rho'(s,a)/\\sum_{a'}\\rho'(s,a') \\triangleq \\pi_{\\rho'}")
('8.0', 's')
('8.0', 'a')
('8.0', "\\bar H(\\lambda\\rho + (1-\\lambda)\\rho') \\geq \\lambda \\bar H(\\rho) + (1-\\lambda)\\bar H(\\rho')")
('8.0', "\\pi_\\rho = \\pi_{\\rho'}")
('8.0', "\\rho = \\rho'")
('8.0', '\\bar H')
('8.0', "\\begin{aligned}\nH(\\pi) &= \\ensuremath{\\mathbb{E}}_{\\pi}[-\\log \\pi(a|s)] \\\\\n&= -\\sum_{s,a}\\rho_\\pi(s,a) \\log \\pi(a|s) \\\\\n&= -\\sum_{s,a}\\rho_\\pi(s,a) \\log\\frac{\\rho_\\pi(s,a)}{\\sum_{a'}\\rho_\\pi(s,a')} \\\\\n&= \\bar H(\\rho_\\pi), \\\\\n\\intertext{and second,}\n\\bar H(\\rho) &= -\\sum_{s,a}\\rho(s,a)\\log\\frac{\\rho(s,a)}{\\sum_{a'}\\rho(s,a')} \\\\\n&= -\\sum_{s,a}\\rho_{\\pi_\\rho}(s,a)\\log \\pi_\\rho(a|s) \\\\\n&= \\ensuremath{\\mathbb{E}}_{\\pi_\\rho}[-\\log \\pi_\\rho(a|s)] \\\\ &\n= H(\\pi_\\rho).\n\\end{aligned}")
('8.0', '\\tilde c \\in \\mathop{\\mathrm{IRL}}_{\\psi}(\\pi_E)')
('8.0', '\\tilde \\pi \\in \\mathop{\\mathrm{RL}}(\\tilde c) = \\mathop{\\mathrm{RL}}\\circ\\mathop{\\mathrm{IRL}}_\\psi(\\pi_E)')
('8.0', '\\begin{aligned}\n\\pi_A &\\in \\mathop{\\mathrm{arg\\,min}}_\\pi -H(\\pi) + \\psi^*(\\rho_\\pi - \\rho_{\\pi_E}) \\\\\n&=\\mathop{\\mathrm{arg\\,min}}_\\pi \\max_c -H(\\pi)  -\\psi(c) + \\sum_{s,a}(\\rho_\\pi(s,a) - \\rho_{\\pi_E}(s,a))c(s,a)\n\\end{aligned}')
('8.0', '\\pi_A = \\tilde \\pi')
('8.0', '\\rho_A')
('8.0', '\\pi_A')
('8.0', '\\tilde \\rho')
('8.0', '\\tilde \\pi')
('8.0', '\\bar L : \\mathcal{D} \\times \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}\\rightarrow \\ensuremath{\\mathbb{R}}')
('8.0', '\\begin{aligned}\n\\bar L(\\rho,c) &= -\\bar H(\\rho) -\\psi(c) + \\sum_{s,a}\\rho(s,a)c(s,a) - \\sum_{s,a}\\rho_{\\pi_E}(s,a)c(s,a).\n\\end{aligned}')
('8.0', '\\begin{aligned}\n\\rho_A &\\in \\mathop{\\mathrm{arg\\,min}}_{\\rho\\in\\mathcal{D}} \\max_c \\bar L(\\rho, c), \\label{eq:relationships1} \\\\\n\\tilde c &\\in \\mathop{\\mathrm{arg\\,max}}_c \\min_{\\rho\\in\\mathcal{D}} \\bar L(\\rho, c), \\label{eq:relationships2} \\\\\n\\tilde \\rho &\\in \\mathop{\\mathrm{arg\\,min}}_{\\rho\\in\\mathcal{D}} \\bar L(\\rho, \\tilde c). \\label{eq:relationships3}\n\\end{aligned}')
('8.0', '\\mathcal{D}')
('8.0', '\\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}')
('8.0', '-\\bar H')
('8.0', '\\psi')
('8.0', '\\bar L(\\cdot,c)')
('8.0', 'c')
('8.0', '\\bar L(\\rho, \\cdot)')
('8.0', '\\rho')
('8.0', '\\begin{aligned}\n\\min_{\\rho\\in\\mathcal{D}} \\max_{c\\in\\mathcal{C}} \\bar L(\\rho, c) =  \\max_{c\\in\\mathcal{C}}\\min_{\\rho\\in\\mathcal{D}} \\bar L(\\rho,c)\n\\end{aligned}')
('8.0', '(\\rho_A, \\tilde c)')
('8.0', '\\bar L')
('8.0', '\\begin{aligned}\n\\rho_A \\in \\mathop{\\mathrm{arg\\,min}}_{\\rho\\in\\mathcal{D}} \\bar L(\\rho, \\tilde c). \\label{eq:relationships4}\n\\end{aligned}')
('8.0', '\\bar L(\\cdot, c)')
('8.0', 'c')
('8.0', '\\rho_A = \\tilde \\rho')
('8.0', '\\pi_A = \\tilde \\pi')
('8.1', '\\ensuremath{\\psi_\\text{GA}}')
('8.1', '\\ensuremath{\\psi_\\text{GA}}')
('8.1', '\\phi')
('8.1', '\\rho_\\pi')
('8.1', '\\rho_{\\pi_E}')
('8.1', '\\psi')
('8.1', '\\psi^*(\\rho_\\pi - \\rho_{\\pi_E})')
('8.1', 'R_\\phi(\\rho_\\pi,\\rho_{\\pi_E})')
('8.1', '\\phi')
('8.1', '\\begin{aligned}\nR_\\phi(\\pi,\\pi_E) &= \\sum_{s,a}\\min_{\\gamma\\in\\ensuremath{\\mathbb{R}}}\\ \\rho_\\pi(s,a)\\phi(\\gamma) + \\rho_{\\pi_E}(s,a)\\phi(-\\gamma)\n\\end{aligned}')
('8.1', 'R_\\phi')
('8.1', 'f')
('8.1', 'f')
('8.1', 'f')
('8.1', '\\phi')
('8.1', '\\phi : \\ensuremath{\\mathbb{R}}\\rightarrow \\ensuremath{\\mathbb{R}}')
('8.1', 'T')
('8.1', '-\\phi')
('8.1', 'g_\\phi : \\ensuremath{\\mathbb{R}}\\rightarrow \\ensuremath{\\overline{\\mathbb{R}}}')
('8.1', '\\psi_\\phi : \\ensuremath{\\mathbb{R}^{\\mathcal{S}\\times\\mathcal{A}}}\\rightarrow \\ensuremath{\\overline{\\mathbb{R}}}')
('8.1', '\\begin{aligned}\n \\begin{split} \\label{eq:genericconv} \ng_\\phi(x) &= \\begin{dcases*} -x + \\phi(-\\phi^{-1}(-x)) & if $x \\in T$ \\\\ +\\infty & otherwise \\end{dcases*} \\\\\n\\psi_\\phi(c) &= \\begin{dcases*} \\sum_{s,a}\\rho_{\\pi_E}(s,a)g_\\phi(c(s,a)) & if $c(s,a) \\in T$ for all $s,a$ \\\\  +\\infty & otherwise \\end{dcases*}\n\\end{split} \n\\end{aligned}')
('8.1', '\\psi_\\phi')
('8.1', '{\\mathop{\\mathrm{RL}}\\circ\\mathop{\\mathrm{IRL}}_{\\psi_\\phi}(\\pi_E) = \\mathop{\\mathrm{arg\\,min}}_\\pi -H(\\pi) - R_\\phi(\\rho_\\pi, \\rho_{\\pi_E})}')
('8.1', 'g_\\phi(x) = -x + \\phi(-\\phi^{-1}(-x))')
('8.1', 'x \\mapsto \\phi(-\\phi^{-1}(-x))')
('8.1', 'T')
('8.1', 'g_\\phi')
('8.1', 'g_\\phi')
('8.1', '\\phi')
('8.1', '\\phi')
('8.1', '\\ensuremath{\\mathbb{R}}')
('8.1', '(b, \\infty)')
('8.1', 'b \\in \\ensuremath{\\mathbb{R}}')
('8.1', '\\phi')
('8.1', '\\ensuremath{\\mathbb{R}}')
('8.1', 'g_\\phi')
('8.1', '\\phi')
('8.1', '(b, \\infty)')
('8.1', '\\phi(x) \\rightarrow b')
('8.1', 'x \\rightarrow \\infty')
('8.1', '\\phi(x) \\rightarrow \\infty')
('8.1', 'x \\rightarrow -\\infty')
('8.1', 'x \\rightarrow b')
('8.1', '\\phi^{-1}(-x) \\rightarrow \\infty')
('8.1', '\\phi(-\\phi^{-1}(-x)) \\rightarrow \\infty')
('8.1', 'g_\\phi(x) \\rightarrow \\infty')
('8.1', 'x \\rightarrow b')
('8.1', 'g_\\phi')
('8.1', '-R_\\phi(\\rho_\\pi, \\rho_{\\pi_E}) = \\psi_\\phi^*(\\rho_\\pi-\\rho_{\\pi_E})')
('8.1', '\\begin{aligned}\n\\psi_\\phi^*(\\rho_\\pi-\\rho_{\\pi_E}) &= \\max_{c\\in\\mathcal{C}} \\sum_{s,a}(\\rho_\\pi(s,a)-\\rho_{\\pi_E}(s,a))c(s,a) - \\sum_{s,a}\\rho_{\\pi_E}(s,a)g_\\phi(c(s,a))  \\\\\n&=  \\sum_{s,a} \\max_{c \\in T}\\ (\\rho_\\pi(s,a)-\\rho_{\\pi_E}(s,a))c - \\rho_{\\pi_E}(s,a)[-c + \\phi(-\\phi^{-1}(-c))] \\\\\n&=  \\sum_{s,a} \\max_{c \\in T}\\ \\rho_\\pi(s,a)c - \\rho_{\\pi_E}(s,a)\\phi(-\\phi^{-1}(-c)) \\\\\n&=  \\sum_{s,a} \\max_{\\gamma \\in \\ensuremath{\\mathbb{R}}}\\ \\rho_\\pi(s,a)(-\\phi(\\gamma)) - \\rho_{\\pi_E}(s,a)\\phi(-\\phi^{-1}(\\phi(\\gamma))) \\\\\n&=  \\sum_{s,a} \\max_{\\gamma \\in \\ensuremath{\\mathbb{R}}}\\ \\rho_\\pi(s,a)(-\\phi(\\gamma)) - \\rho_{\\pi_E}(s,a)\\phi(-\\gamma) \\\\\n&= -R_\\phi(\\rho_\\pi, \\rho_{\\pi_E})\n\\end{aligned}')
('8.1', 'c \\rightarrow -\\phi(\\gamma)')
('8.1', 'T')
('8.1', '-\\phi')
('8.1', '\\psi_\\phi')
('8.1', '\\phi')
('8.1', '\\begin{aligned}\n\\ensuremath{\\psi_\\text{GA}}(c) \\triangleq \\begin{dcases*} \\ensuremath{\\mathbb{E}}_{\\pi_E}[g(c(s,a))] & if $c < 0$ \\\\ +\\infty & otherwise \\end{dcases*} \\quad\\text{where}\\quad g(x) = \\begin{dcases*}-x-\\log(1-e^x) & if $x < 0$ \\\\ +\\infty & otherwise\\end{dcases*}\n\\end{aligned}')
('8.1', '\\begin{aligned}\n\\ensuremath{\\psi_\\text{GA}}^*(\\rho_\\pi - \\rho_{\\pi_E}) = \\max_{D \\in (0,1)^{\\mathcal{S} \\times \\mathcal{A}}} \\ensuremath{\\mathbb{E}}_{\\pi}[\\log(D(s,a))] + \\ensuremath{\\mathbb{E}}_{\\pi_E}[\\log(1-D(s,a))].\n\\end{aligned}')
('8.1', '\\phi(x) = \\log(1+e^{-x})')
('8.1', '\\ensuremath{\\psi_\\text{GA}}')
('8.1', '\\begin{aligned}\n\\ensuremath{\\psi_\\text{GA}}^*(\\rho_\\pi - \\rho_{\\pi_E}) &= -R_\\phi(\\rho_\\pi, \\rho_{\\pi_E}) \\\\\n&= \\sum_{s,a} \\max_{\\gamma\\in\\ensuremath{\\mathbb{R}}}\\ \\rho_\\pi(s,a)\\log\\left(\\frac{1}{1+e^{-\\gamma}}\\right) + \\rho_{\\pi_E}(s,a)\\log\\left(\\frac{1}{1+e^{\\gamma}}\\right) \\\\\n&= \\sum_{s,a} \\max_{\\gamma\\in\\ensuremath{\\mathbb{R}}}\\ \\rho_\\pi(s,a)\\log\\left(\\frac{1}{1+e^{-\\gamma}}\\right) + \\rho_{\\pi_E}(s,a)\\log\\left(1 - \\frac{1}{1+e^{-\\gamma}}\\right) \\\\\n&= \\sum_{s,a} \\max_{\\gamma\\in\\ensuremath{\\mathbb{R}}}\\ \\rho_\\pi(s,a)\\log(\\sigma(\\gamma)) + \\rho_{\\pi_E}(s,a)\\log(1 - \\sigma(\\gamma)), \\\\\n\\intertext{where $\\sigma(x) = 1/(1+e^{-x})$ is the sigmoid function. Because the range of $\\sigma$ is $(0,1)$, we can write}\n\\ensuremath{\\psi_\\text{GA}}^*(\\rho_\\pi - \\rho_{\\pi_E}) &= \\sum_{s,a} \\max_{d \\in (0,1)}\\ \\rho_\\pi(s,a)\\log d + \\rho_{\\pi_E}(s,a)\\log(1 - d) \\\\\n&= \\max_{D \\in (0,1)^{\\mathcal{S} \\times \\mathcal{A}}}\\ \\sum_{s,a} \\rho_\\pi(s,a)\\log(D(s,a)) + \\rho_{\\pi_E}(s,a)\\log(1 - D(s,a)),\n\\end{aligned}')
('8.1', '\\begin{aligned}\n\\begin{split}\n\\nabla_\\theta \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[-\\log \\pi_\\theta(a|s)] &= \\ensuremath{\\mathbb{E}}_{\\pi_\\theta} \\left[\\nabla_\\theta \\log\\pi_\\theta(a|s) Q_{\\mathrm{log}}(s,a) \\right], \\\\\n\\text{where}\\quad Q_{\\mathrm{log}}(\\bar s,\\bar a) &= \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[-\\log\\pi_\\theta(a|s) \\,|\\, s_0=\\bar s, a_0 = \\bar a].\n\\end{split}\n\\end{aligned}')
('8.1', '\\rho(s,a)')
('8.1', '\\rho(s) = \\sum_a \\rho(s,a)')
('8.1', '\\begin{aligned}\n\\nabla_\\theta \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[-\\log \\pi_\\theta(a|s)] &= -\\nabla_\\theta \\sum_{s,a}\\rho_{\\pi_\\theta}(s,a)\\log \\pi_\\theta(a|s) \\\\\n&= -\\sum_{s,a} (\\nabla_\\theta \\rho_{\\pi_\\theta}(s,a))\\log \\pi_\\theta(a|s) - \\sum_{s} \\rho_{\\pi_\\theta}(s)\\sum_a\\pi_\\theta(a|s)\\nabla_\\theta\\log \\pi_\\theta(a|s) \\\\\n&= -\\sum_{s,a} (\\nabla_\\theta \\rho_{\\pi_\\theta}(s,a))\\log \\pi_\\theta(a|s) - \\sum_{s} \\rho_{\\pi_\\theta}(s)\\sum_a\\nabla_\\theta \\pi_\\theta(a|s)\n\\end{aligned}')
('8.1', '\\sum_a\\nabla_\\theta \\pi_\\theta(a|s) = \\nabla_\\theta \\sum_a \\pi_\\theta(a|s) = \\nabla_\\theta 1 = 0')
('8.1', '\\begin{aligned}\n\\nabla_\\theta \\ensuremath{\\mathbb{E}}_{\\pi_\\theta}[-\\log \\pi_\\theta(a|s)] &= \\sum_{s,a} (\\nabla_\\theta \\rho_{\\pi_\\theta}(s,a))(-\\log \\pi_\\theta(a|s)),\n\\end{aligned}')
('8.1', 'c_\\mathrm{log}(s,a) \\triangleq -\\log\\pi_\\theta(a|s)')
('8.1', 'c_\\mathrm{log}')
('9', '\\gamma=.995')
('9', '\\lambda=.97')
