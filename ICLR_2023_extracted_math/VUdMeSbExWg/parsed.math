('1', 'N-')
('3.0', '\\mathcal{P}(\\mathcal{X})')
('3.0', '\\mathcal{X}')
('3.0', '\\mathcal{T} = \\{0,1,\\cdots,T\\}')
('3.0', 'T')
('3.0', '\\mathcal{S}')
('3.0', '\\mathcal{A}')
('3.0', 'N')
('3.0', 't')
('3.0', '\\mu_t(s) \\triangleq \\lim_{N\\rightarrow \\infty} \\frac{1}{N}\\sum_{i=1}^N \\mathds{1}{\\{s_t^i=s\\}}')
('3.0', 's_t^i')
('3.0', 'i')
('3.0', 't')
('3.0', '\\mathds{1}_{\\{e\\}}')
('3.0', '1')
('3.0', 'e')
('3.0', '0')
('3.0', '\\pmb{\\mu} = \\{\\mu_t\\}_{t\\in\\mathcal{T}}')
('3.0', 'P:\\mathcal{S}\\times \\mathcal{A}\\times \\mathcal{P}(\\mathcal{S}) \\rightarrow \\mathcal{P} (\\mathcal{S})')
('3.0', 't')
('3.0', 'a_t')
('3.0', '\\pi_t')
('3.0', 'r(s_t,a_t,\\mu_t)')
('3.0', 's_t\\in\\mathcal{S}')
('3.0', 'P(\\cdot|s_t,a_t,\\mu_t)')
('3.0', '\\pmb{\\mu}')
('3.0', '\\pmb{\\pi}=\\{\\pi_t\\}_{t\\in\\mathcal{T}}')
('3.0', '\\begin{aligned}\n\\label{eq:mfg}\n\\begin{array}{ll}\n\\text{maximize}_{\\pmb{\\pi}} & \\left.V_k(s,\\pmb{\\pi},\\pmb{\\mu})\\triangleq\\mathbb{E}\\left[\\sum\\limits_{t=k}^T  \\gamma^t r(s_t, a_t, {\\color{black}\\mu_t})\\right|s_k=s\\right]\\\\\n\\text{subject to} & s_{t+1}\\sim P(\\cdot|s_t,a_t,{\\color{black}\\mu_t}),\\quad a_t\\sim \\pi_t(s_t),\n\\end{array}\n\\end{aligned}')
('3.0', '\\gamma \\in (0, 1]')
('3.0', '\\pmb{\\pi}^\\star')
('3.0', '\\pmb{\\mu}^\\star')
('3.0', '\\mu_0')
('3.0', '\\pmb{\\pi}')
('3.0', 's\\sim \\mu_0')
('3.0', 'V_0\\left(s,\\pmb{\\pi}^\\star,{\\color{black}\\pmb{\\mu}^\\star}\\right)\\geq V_0\\left(s,\\pmb{\\pi},\\pmb{\\mu}^\\star\\right).')
('3.0', '\\pmb{\\mu}^*')
('3.0', '\\mu^*_{t}(\\cdot) = \\sum_{s\\in\\mathcal{S},a\\in \\mathcal{A}} P(\\cdot|s,a,\\mu_{t-1}^*)\\pi^*_{t-1}(a|s)\\mu^*_{t-1}(s),')
('3.0', '\\mu^*_0=\\mu_0')
('3.0', '\\pmb{\\pi}^\\star')
('3.0', '\\pmb{\\mu}')
('3.0', '\\pmb{\\mu}^{\\star}')
('3.1', '\\mathcal{M} = (\\mathcal{S}, \\mathcal{A}, P, r, \\mu_{0}, \\gamma, T)')
('3.1', '\\mathcal{S}')
('3.1', '\\mathcal{A}')
('3.1', 'P: \\mathcal{S} \\times \\mathcal{A} \\rightarrow \\mathcal{P}(\\mathcal{S})')
('3.1', 'r: \\mathcal{S} \\times \\mathcal{A} \\rightarrow \\mathbb{R}')
('3.1', 's_0')
('3.1', '\\mu_{0}')
('3.1', '\\gamma \\in (0, 1]')
('3.1', 'T')
('3.1', '\\pi')
('3.1', 'J(\\pi) = \\mathbb{E}\\left[\\sum_{t=0}^{T} \\gamma^{t} r(s_{t}, a_{t})\\right]')
('3.1', 's_0 \\sim \\mu_{0}')
('3.1', 'a_t \\sim \\pi(\\cdot|s_t)')
('3.1', 's_{t+1} \\sim P(\\cdot|s_t, a_t)')
('3.1', '\\pi^{E}')
('3.1', '\\pi^{E}')
('3.1', '\\tilde{r}=\\max_{r}\\big(\\min_{\\pi}-H(\\pi)-J(\\pi)\\big)+J(\\pi^{E})')
('3.1', '\\pi^{E}')
('3.1', 'H(\\pi)\\triangleq\\mathbb{E}_\\pi[-\\log\\pi(a|s)]')
('3.1', '\\pi')
('3.1', '\\tilde{r}')
('3.1', 'D_{\\omega}')
('3.1', '\\pi^{E}')
('3.1', '\\pi_{\\theta}')
('3.1', '\\theta')
('3.1', 'D_{\\omega}')
('3.1', '\\max_\\theta \\min _w \\mathbb{E}_{(s, a) \\sim \\pi_\\theta}\\left[\\log \\left(D_{\\omega}(s, a)\\right)\\right]+\\mathbb{E}_{(s, a) \\sim \\pi^{E}}\\left[\\log \\left(1-D_{\\omega}(s, a)\\right)\\right],')
('3.1', '\\mathbb{E}_{(s, a)\\sim\\pi_{\\theta}}')
('3.1', 's_{t+1}\\sim P(\\cdot|s_{t}, a_{t})')
('3.1', 'a_{t}\\sim\\pi_{\\theta}(\\cdot|s_{t})')
('3.1', 's_{0}\\sim\\mu_{0}')
('3.1', '\\mathbb{E}_{(s, a)\\sim\\pi^{E}}')
('3.1', 's_{t+1}\\sim P(\\cdot|s_{t}, a_{t})')
('3.1', 'a_{t}\\sim\\pi^{E}(\\cdot|s_{t})')
('3.1', 's_{0}\\sim\\mu_{0}')
('4.0', '\\rho_t\\in \\mathcal{P}(\\mathcal{Z})')
('4.0', '\\mathcal{Z}')
('4.0', 'z_t')
('4.0', 't')
('4.0', '\\pmb{\\rho}=\\{\\rho_t\\}_{t=0}^{T}')
('4.0', 't')
('4.0', '\\pi_t: \\mathcal{Z} \\times \\mathcal{S} \\rightarrow \\mathcal{P}(\\mathcal{A})')
('4.0', 's')
('4.0', 'z')
('4.0', '\\mathcal{A}')
('4.0', '\\pmb{\\pi} = \\{\\pi_t\\}_{t=0}^T')
('4.0', 't')
('4.0', 'z_t')
('4.0', '\\rho_t')
('4.0', 's_t')
('4.0', 'a_t')
('4.0', '\\pi_t(\\cdot|s_t, z_t)')
('4.0', 'a_t')
('4.0', '\\mathcal{I}_t =\\{ \\rho_t, a_t, \\pi_t, s_{t}, \\mu_{t}\\}')
('4.0', 't')
('4.0', '\\mathcal{I}_t')
('4.0', '\\mu_t')
('4.0', '\\pi(a|s, z)')
('4.0', '\\rho(z)')
('4.0', '\\pi_t')
('4.0', 'z_t')
('4.0', 'z_t')
('4.0', '\\mathcal{I}_t')
('4.0', "\\label{predict_z}\n    \\rho^{\\rm pred}_t(z_t=z|\\mathcal{I}_t)=\\frac{\\rho_t(z)\\pi_t(a_t|s_t, z)}{\\sum_{z'\\in\\mathcal{Z}}\\rho_t(z')\\pi_t(a_t|s_t, z')}.")
('4.0', 'z')
('4.0', '\\begin{aligned}\n        \\mu^{\\rm pred}_{t+1}(\\cdot|\\mathcal{I}_t, z) &= \\sum_{a \\in \\mathcal{A}}\\sum_{s\\in \\mathcal{S}} \\mu_{t}(s)P(\\cdot|s,a,\\mu_{t})\\pi_{t}(a|s,z)\\triangleq \\Phi(\\mu_{t}, \\pi_{t},z).\n    \\end{aligned}')
('4.0', '\\mu')
('4.0', 'a')
('4.0', "Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')")
('4.0', "Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')\n    = r(s, a, \\mu) + \\gamma\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}\\bigg[\\sum_{i=t+1}^{T}\\gamma^{i-t-1}r(s_i, a_i, \\mu_i)\\bigg].")
('4.0', '\\pmb{\\pi}')
('4.0', "\\pmb{\\pi}'")
('4.0', '\\pmb{\\rho}')
('4.0', '(s_t, a_t, \\mu_t, z_t)=(s, a, \\mu, z)')
('4.0', "\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}")
('4.0', 'z_t\\sim\\rho_t(\\cdot)')
('4.0', 's_t\\sim P(\\cdot|s_{t-1}')
('4.0', 'a_{t-1}, \\mu_{t-1}')
('4.0', 'a_t\\sim\\pi_t(\\cdot|s_t, z_t)')
('4.0', "\\mu_t=\\Phi(\\mu_{t-1}, \\pi_{t-1}', z_{t-1})")
('4.0', '\\mathcal{U}\\triangleq\\{u:\\mathcal{A}\\to\\mathcal{A}\\},')
('4.0', 'u')
('4.0', 'a')
('4.0', 'u(a)')
('4.0', '\\Delta_t(s, \\mu, u; \\pmb{\\pi}, \\pmb{\\rho})=\\mathbb{E}\\big[Q_t^{\\pmb{\\pi}}(s, u(a), \\mu, z; \\pmb{\\pi}) - Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\big]')
('4.0', 'u(a)')
('4.0', 'a')
('4.0', 'u\\in\\mathcal{U}')
('4.0', 'z\\sim\\rho_t(\\cdot)')
('4.0', 'a\\sim\\pi_t(\\cdot|s, z)')
('4.0', '(\\pmb{\\pi}^{\\star}, \\pmb{\\rho}^{\\star})')
('4.0', '\\pmb{\\pi}^{\\star}=\\{\\pi_t^{\\star}\\}_{t=0}^{T}')
('4.0', '\\pmb{\\rho}^{\\star}=\\{\\rho_t^{\\star}\\}_{t=0}^{T}')
('4.0', 'z')
('4.0', '\\Delta_t(s, \\mu_t^{\\star}, u; \\pmb{\\pi}^{\\star}, \\pmb{\\rho}^{\\star})\\le0, \\quad \n            \\forall u\\in \\mathcal{U}, \\forall s\\in\\mathcal{S}, \\forall t\\in\\mathcal{T}.')
('4.0', '\\pmb{\\mu}^*')
('4.0', '\\mu_{t}^{*}(\\cdot)=\\Phi(\\mu_{t-1}^{\\star}, \\pi_{t-1}^{\\star}, z_{t-1})')
('4.0', '\\{z_{t}\\}_{t=0}^{T}')
('4.0', '\\mu_{0}^{*}=\\mu_{0}')
('4.1', 'z')
('4.1', 'z_t')
('4.1', 't')
('4.1', '\\rho_t')
('4.1', 'a_t')
('4.1', '\\pi_t(a_t|s_t, z_t)')
('4.1', 's_t')
('4.1', 'a_t')
('4.1', 'z_t')
('4.1', 'z_t')
('4.1', 't')
('4.1', 'C')
('4.1', 'L')
('4.1', 'R')
('4.1', 'L')
('4.1', 'R')
('4.1', 'z')
('4.1', '\\mathcal{S}=\\{C, L, R\\}')
('4.1', '\\mathcal{A}=\\{L, R\\}')
('4.1', '\\mu_0(C)=1')
('4.1', 'r(s, a, \\mu)=\\mathds{1}_{\\{s=L\\}}\\mu(L)+\\mathds{1}_{\\{s=R\\}}\\mu(R)')
('4.1', 'P(s_{t+1}|s_t, a_t)')
('4.1', 'P(s_{t+1}=R|s_t, a)=1-P(s_{t+1}=L|s_t, a)')
('4.1', 's_t')
('4.1', 'C')
('4.1', 'C')
('4.1', 'L')
('4.1', 'L')
('4.1', 'R')
('4.1', 'R')
('4.1', 'a_t')
('4.1', 'L')
('4.1', 'R')
('4.1', 'L')
('4.1', 'R')
('4.1', 'L')
('4.1', 'R')
('4.1', 'P(s_{t+1}=L|s_t, a_t)')
('4.1', '\\pi(a=R|s, z)=1-\\pi(a=L|s, z)')
('4.1', 's')
('4.1', 'C')
('4.1', 'C')
('4.1', 'L')
('4.1', 'L')
('4.1', 'R')
('4.1', 'R')
('4.1', 't')
('4.1', '0')
('4.1', '0')
('4.1', '1')
('4.1', '1')
('4.1', '1')
('4.1', '1')
('4.1', 'z_t')
('4.1', '0')
('4.1', '1')
('4.1', '0')
('4.1', '1')
('4.1', '0')
('4.1', '1')
('4.1', '\\pi_t(a=L|s, z_t)')
('4.1', '2/3')
('4.1', '1/3')
('4.1', '1')
('4.1', '1/9')
('4.1', '8/9')
('4.1', '0')
('4.1', 't\\in\\mathcal{T}=\\{0, 1\\}')
('4.1', 'z')
('4.1', '\\mathcal{Z}=\\{0, 1\\}')
('4.1', '\\rho_t(z=0)=\\rho_t(z=1)=0.5')
('4.1', 'z')
('4.1', '\\pmb{\\pi}')
('4.1', '\\pmb{z} = \\{0, 1\\}')
('4.1', 'a_0 = L')
('4.1', 'a_1 = R')
('4.2', "\\mathrm{BR}(\\pmb{\\pi}; \\pmb{\\rho}) = \\mathop{\\arg\\max}_{\\pmb{\\pi}'}\\mathbb{E}_{\\pmb{\\pi}', \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^T\\gamma^t r(s_t, a_t, \\mu_t)\\right].")
('4.2', '\\mathrm{BR}')
('4.2', 'r(s,a,\\mu)')
('4.2', "P(s'|s, a, \\mu)")
('4.2', '\\mu')
('5', 'r')
('5', '\\pmb{\\rho}')
('5', '\\mathrm{AMFCE}(r, \\pmb{\\rho})')
('5', '\\pmb{\\pi}')
('5', 'a_{0:T}')
('5', '\\pmb{\\pi}')
('5', '\\pmb{\\rho}')
('5', '\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho}) \\triangleq \\mathbb{E}\\Big[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{0:T}\\Big] - J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}),')
('5', 'z_t\\sim\\rho_t(\\cdot)')
('5', 's_t\\sim P(\\cdot|s_{t-1}, a_{t-1}, \\mu_{t-1})')
('5', "J(\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho})=\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}\\left[\\sum_{t=0}^T\\gamma^t r(s_t, a_t, \\mu_t)\\right]")
('5', '\\pmb{\\pi}')
('5', "\\pmb{\\pi}'")
('5', '\\pmb{\\rho}')
('5', 'a_{0:T}')
('5', '\\pmb{\\pi}')
('5', '(\\pmb{\\pi}, \\pmb{\\rho})')
('5', '\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho})\\leq 0,')
('5', '\\forall a_{t}\\in\\mathcal{A}')
('5', '0\\le t\\le T')
('5', 'L(\\pmb{\\pi}, \\pmb{\\rho}, \\lambda, r) \\triangleq\\sum_{\\tau_k \\in \\mathcal{D}_E}\\lambda(\\tau_k)\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho}),')
('5', '\\mathcal{D}_E')
('5', '\\tau_k = \\{(a_t, z_t)\\}_{t=0}^T')
('5', '\\lambda')
('5', '\\pmb{\\pi}^*')
('5', '\\pmb{\\rho}')
('5', '\\lambda_{\\pmb{\\pi}^{*}}(\\tau_k)=\\prod_{t=0}^{T}\\rho_t(z_t)\\pi_t^*(a_t|s_t, z_t)')
('5', '\\tau_k')
('5', '\\pmb{\\pi}^*')
('5', '\\pmb{\\rho}')
('5', 'L(\\pmb{\\pi}, \\pmb{\\rho}, \\lambda_{\\pmb{\\pi}^{*}},r)=J(\\pmb{\\pi}^*, \\pmb{\\pi}, \\pmb{\\rho})-J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}).')
('5', '\\mathrm{AMFCE-IRL}_\\psi')
('5', '\\psi')
('5', '\\pmb{\\pi}^E')
('5', '\\pmb{\\pi}^E')
('5', '\\pmb{\\pi}')
('5', '\\label{mfirl}\n    \\mathrm{AMFCE-IRL}_\\psi(\\boldsymbol{\\pi}^E, \\pmb{\\rho}^E) = \\arg\\max_{r} \\Big(-\\psi(r) - \\max_{\\pmb{\\pi}} L(\\pmb{\\pi}^E, \\pmb{\\rho}^E, \\lambda_{\\pmb{\\pi}^{*}}, r)\\Big),')
('5', '(\\pmb{\\pi}^E, \\pmb{\\rho}^E)')
('5', '\\begin{aligned}\n        \\psi_{GA}(r) \\triangleq\\begin{cases}\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}^E}[\\sum_{t=0}^T\\gamma^{t}g(r(s_t, a_t, \\mu_t))] & \\text { if } r>0 \\\\ +\\infty & \\text { otherwise }\\end{cases}\n    \\end{aligned}')
('5', 'g(x)= \\begin{cases}-x-\\log \\left(1-e^{x}\\right) & \\text { if } x<0 \\\\ +\\infty & \\text { otherwise }\\end{cases}')
('5', '\\mathrm{AMFCE}(\\tilde{r}, \\pmb{\\rho}^E)')
('5', '\\tilde{r}=\\mathrm{AMFCE-IRL}(\\boldsymbol{\\pi}^E, \\pmb{\\rho}^E)')
('5', '\\label{eq:combine}\n    \\begin{aligned}\n        \\mathrm{AMFCE}\\circ\\operatorname{AMFCE-IRL}_\\psi(\\pmb{\\pi}^E, \\pmb{\\rho}^E)\n        =&\n        \\mathop{\\arg\\min}_{\\pmb{\\pi}} \n        \\max_{r} J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\\\\n        &- J(\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}^E) - \\psi_{GA}(r)\n    \\end{aligned},')
('5', '\\label{eq:objective}\n        \\begin{aligned}\n            \\min_{\\pmb{\\pi}}&\\max_{\\omega}\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^{t}\\log D_\\omega(s_t, a_t, \\mu_t)\\bigg]\\\\\n            +&\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^{t}\\log\\big(1 - D_\\omega(s_t, a_t, \\mu_t)\\big)\\bigg],\n        \\end{aligned}')
('5', 'D_\\omega')
('5', '\\omega')
('5', '(s_t, a_t, \\mu_t)')
('5', '(0, 1]')
('5', '\\pmb{\\rho}^{E}')
('5', '\\pmb{\\rho}')
('5', '\\rho_t^{\\phi}')
('5', '\\phi')
('5', '\\phi')
('5', 's')
('5', '\\mathbb{E}_{z\\sim\\rho_t^\\phi(\\cdot)}\\bigg[\\nabla_\\phi \\log \\rho_t^\\phi(z) \\mathbb{E}_{a\\sim\\pi_t(\\cdot|s, z)}Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\bigg].\n        % + \\sum_{a\\in\\mathcal{A}}\\pi_t(a\\vert s, z)Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\bigg)\\Bigg]')
('5', '\\mu_t')
('5', 'D_\\omega')
('5', '\\mu_t')
('5', '\\mu_t')
('5', '\\pmb{z}_{0:t}')
('5', '\\hat{\\mu}_t=\\mathrm{Sig}(\\pmb{z}_{0:t})')
('5', '(\\pmb{\\pi}, \\pmb{\\rho})')
('5', '\\mathcal{D}_E=\\{s_0, z_0, a_0, s_1, z_1, a_1, \\dots s_{T}, z_{T}, a_{T}\\}')
('5', '\\mu_0')
('5', '(\\pmb{\\pi}, \\pmb{\\rho})')
('5', 's_0 \\sim \\mu_0')
('5', 'a_t \\sim \\pi^{\\theta}(\\cdot \\vert s_t, z_t)')
('5', 's_{t+1} \\sim P(\\cdot\\mid s_t, \\mu_t)')
('5', 'z_t\\sim\\rho_t^\\phi(\\cdot)')
('5', '\\omega')
('5', '\\theta')
('5', '\\phi')
('5', '\\pmb{\\pi}^{\\theta}')
('5', '\\pmb{\\rho}^{\\phi}')
('5', '\\label{eq:surrogate}        \n    \\begin{aligned}    \n        \\min_{\\pmb{\\pi}}&\\max_{\\omega}\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^{t}\\log D_\\omega(s_t, a_t, \\hat{\\mu}_t)\\bigg]\\\\\n        &+\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^{t}\\log\\big(1 - D_\\omega(s_t, a_t, \\hat{\\mu}_t)\\big)\\bigg],\n    \\end{aligned}')
('5', 'P(\\cdot|s, a, \\mu)')
('5', 'r(s, a, \\mu)')
('5', '\\mu')
('5', 'L_P')
('5', 'L_R')
('5', 'r_{\\max}')
('5', '\\pmb{\\pi}^E')
('5', '\\pmb{\\pi}')
('5', '\\begin{aligned}\n            \\max_{\\omega}\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}&\\bigg[\\sum_{t=0}^{T}\\gamma^{t}\\log D_\\omega(s_t, a_t, \\hat{\\mu}_t)\\bigg]\\\\\n            &+\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^{t}\\log\\big(1 - D_\\omega(s_t, a_t, \\hat{\\mu}_t)\\big)\\bigg]\\le \\epsilon,\n        \\end{aligned}')
('5', 'a_{0:T}')
('5', '\\pmb{\\pi}')
('5', '\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho}^E)\\le 2\\left(2L_R+r_{\\max}+\\gamma TL_Pr_{\\max}\\right)\\sqrt{2\\epsilon T}.')
('5', '\\epsilon')
('5', '\\pmb{\\pi}')
('5', '\\epsilon=0')
('5', '\\pmb{\\pi}')
('5', '\\pmb{\\pi}')
('5', '\\max_{\\hat{\\pmb{\\pi}}}J(\\hat{\\pmb{\\pi}}, \\pmb{\\pi}, \\pmb{\\rho}^E)-J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E)\\le2(3L_R+\\gamma TL_Pr_{\\max}+r_{\\max})\\sqrt{2\\epsilon T}')
('6', '\\rho')
('6', '\\rho')
('6', '\\rho')
('6', '\\rho')
('6.1', '\\mathcal{T}=\\{0, 1\\}')
('6.1', '\\mathbb{E}_{a\\sim\\pi^E(\\cdot|s, z)}[-\\log(\\pi(a|s, z))]')
('6.1', '\\pi')
('6.1', '\\pi^E')
('6.1', '\\pi')
('6.1', '\\pi^E')
('8.0', 'u: \\Pi\\rightarrow\\Pi')
('8.0', '\\pmb{\\pi}\\in\\Pi')
('8.0', 'u(\\pmb{\\pi})\\in\\Pi')
('8.0', "\\begin{aligned}\n\\mathbb{E}_{z_T \\sim \\rho_T, a_T \\sim \\pi_T(\\cdot|s_T, z_T)}\\left[r(s_T, a_T', \\mu_T) - r(s_T, a_T, \\mu_T)\\right] \\leq 0, \\quad \\forall a_T' \\in \\mathcal{A}\n\\end{aligned}")
('8.0', '\\begin{aligned}\n    \\mathbb{E}_{z_T\\sim{\\rho}_T, a_T\\sim\\pi_T(\\cdot|s_T, z_T), a\\sim u(\\pi)(\\cdot|s_T, z_T)}\\left[r(s_T, a, \\mu_T)-r(s_T, a_T, \\mu_T)\\right]\\leq 0\n\\end{aligned}')
('8.0', 't=T')
('8.0', 'Q_t^{u(\\pmb{\\pi})}(s_t, a_t, \\mu_t, z; \\pmb{\\pi})\\leq Q_t^{\\pmb{\\pi}}(s_t, a_t, \\mu_t, z; \\pmb{\\pi})')
('8.0', 'a_t\\in\\mathcal{A}')
('8.0', 't=k')
('8.0', "\\begin{aligned}\nQ_{k-1}^{u(\\pmb{\\pi})}(s, a, \\mu, z; \\pmb{\\pi})\\leq r(s, a, \\mu)+\\gamma \\mathbb{E}\\left[Q_k^{u(\\pmb{\\pi})}(s', a', \\Phi(\\mu, \\pi_{k-1}, z); \\pmb{\\pi})\\right]\\\\\\leq r(s, a, \\mu)+\\gamma \\mathbb{E}\\left[Q_k^{\\pmb{\\pi}}(s', a', \\Phi(\\mu, \\pi_{k-1}, z); \\pmb{\\pi})\\right]=Q_{k-1}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\n\\end{aligned}")
('8.0', 'Q_1^{u(\\pmb{\\pi})}(s, a, \\mu, z; \\pmb{\\pi})\\leq Q_1^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}), \\forall a\\in\\mathcal{A}')
('8.0', '\\mathbb{E}_{u(\\pmb{\\pi}), \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=1}^{T}\\gamma^tr(s_t, a_t, \\mu_t)\\right]-\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=1}^{T}\\gamma^tr(s_t, a_t, \\mu_t)\\right]\\leq 0')
('8.0', '\\mathcal{G}')
('8.0', '\\mathcal{G}^N')
('8.0', 'N')
('8.0', '\\mathcal{G}^N')
('8.0', '\\mathcal{G}')
('8.0', '\\mathcal{G}^N')
('8.0', '\\bar{\\mu}')
('8.0', '\\bar{\\mu}(s)=\\frac1N\\sum_{n=1}^N\\mathbb{I}_{\\{s^i=s\\}}')
('8.0', 'r^N(s, a, \\bar{\\mu})')
('8.0', 'P^N(\\cdot|s, a, \\bar{\\mu})')
('8.0', '\\mathcal{G}^N')
('8.0', '\\mathcal{G}')
('8.0', '\\begin{aligned}\n    \\lim_{N\\to\\infty}\\mathbb{E}_{u(\\pmb{\\pi}^i), \\pmb{\\pi}^{-i}, \\pmb{\\rho}}\\left[\\sum_{t=1}^{T}\\gamma^tr^N(s_t^i, a_t^i, \\mu_t)\\right]-E_{\\pmb{\\pi}^i, \\pmb{\\pi}^{-i}, \\pmb{\\rho}}\\left[\\sum_{t=1}^{T}\\gamma^tr^N(s_t, a_t^i, \\mu_t)\\right]\\\\=E_{u(\\pmb{\\pi}), \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=1}^{T}\\gamma^tr(s_t, a_t, \\mu_t)\\right]-E_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=1}^{T}\\gamma^tr(s_t, a_t, \\mu_t)\\right]\\leq 0\n\\end{aligned}')
('8.0', '\\mathcal{G}')
('8.1', 'Q^{\\pmb{\\pi}}')
('8.1', 'Q^*')
('8.1', "\\begin{aligned}\n    Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')\n    =r(s, a, \\mu)+\\gamma\\mathbb{E}\\bigg[Q_{t+1}^{\\pmb{\\pi}}(s', a', \\Phi(\\mu, \\pi'_t, z), z'; \\pmb{\\pi}')\\bigg],\\nonumber\n\\end{aligned}")
('8.1', "z'\\sim\\rho_{t+1}(\\cdot)")
('8.1', "s'\\sim P(\\cdot|s, a, \\mu)")
('8.1', "a'\\sim\\pi_{t+1}(\\cdot|s, z')")
('8.1', '(s_t, a_t, \\mu_t, z_t)=(s, a, \\mu, z)')
('8.1', "\\begin{aligned}\n\\label{eq:Qf1}\n    &Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')\\\\=&r(s, a, \\mu)\\\\\n    &+\\gamma\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}\\left[\\sum_{i=t+1}^{T}\\gamma^{i-t-1}r(s_i, a_i, \\mu_i)\\middle|(s_t, a_t,\\mu_t, z_t)=(s, a, \\mu, z)\\right]\\nonumber\\\\\n    =&r(s, a, \\mu)+\\gamma\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}\\Big[r(s_{t+1}, a_{t+1}, \\Phi(\\mu, \\pi'_t, z))\\nonumber\\\\\n    &+\\gamma\\sum_{i=t+2}^{T}\\gamma^{i-t-2}r(s_i, a_i, \\mu_i)\\Big|(s_t, a_t,\\mu_t, z_t)=(s, a, \\mu, z)\\Big],\n\\end{aligned}")
('8.1', 'Q_t^{\\pmb{\\pi}}')
('8.1', "\\begin{aligned}\n\\label{eq:Qf2}\n    &\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}\\Big[r\\big(s', a', \\Phi(\\mu, \\pi'_t, z)\\big)+\\gamma\\sum_{i=t+2}^{T}\\gamma^{i-t-2}r(s_i, a_i, \\mu_i)\\Big]\\nonumber\\\\\n    =&\\mathbb{E}\\bigg[r\\big(s', a', \\Phi(\\mu, \\pi'_t, z)\\big)\\nonumber+\\gamma\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}', \\pmb{\\rho}}\\big[\\sum_{i=t+2}^{T}\\gamma^{i-t-2}r(s_i, a_i, \\mu_i)\\big]\\bigg]\\nonumber\\\\\n    =&\\mathbb{E}\\bigg[Q_{t+1}^{\\pmb{\\pi}}\\big(s', a', \\Phi(\\mu, \\pi'_t, z), z'; \\pmb{\\pi}'\\big)\\bigg],\n\\end{aligned}")
('8.1', "z'\\sim\\rho_{t+1}(\\cdot), s'\\sim P(\\cdot|s, a, \\mu), a'\\sim\\pi(\\cdot|s, z)")
('8.1', '(s_t, a_t, \\mu_t, z_t)=(s, a, \\mu, z)')
('8.1', "(s_{t+1}, a_{t+1}, \\mu_{t+1}, z_{t+1})=(s', a', \\Phi(\\mu, \\pi'_t, z), z')")
('8.1', '(s_t, a_t, \\mu_t, z_t)=(s, a, \\mu, z)')
('8.1', "(s_{t+1}, a_{t+1}, \\mu_{t+1}, z_{t+1})=(s', a', \\Phi(\\mu, \\pi'_t, z), z')")
('8.1', "\\begin{aligned}\n    &Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')=r(s, a, \\mu)+\\gamma\\mathbb{E}\\bigg[Q_{t+1}^{\\pmb{\\pi}}\\big(s', a', \\Phi(\\mu, \\pi'_t, z), z'; \\pmb{\\pi}'\\big)\\bigg],\n\\end{aligned}")
('8.1', "z'\\sim\\rho_{t+1}(\\cdot), s'\\sim P(\\cdot|s, a, \\mu), a'\\sim\\pi_t(\\cdot|s, z)")
('8.1', "Q_t^*(s, a, \\mu, z; \\pmb{\\pi}')")
('8.1', '\\pmb{\\pi}^*')
('8.1', "\\pmb{\\pi}'")
('8.1', 'Q^*')
('8.1', "\\begin{aligned}\n    Q_t^*(s, a, \\mu, z; \\pmb{\\pi}')=r(s, a, \\mu)+\\gamma\\max_{a'\\in\\mathcal{A}}\\mathbb{E}\\bigg[Q_{t+1}^*(s', a', \\Phi(\\mu, \\pi'_t, z), z'; \\pmb{\\pi}')\\bigg],\n\\end{aligned}")
('8.1', "z'\\sim\\rho_{t+1}(\\cdot), s'\\sim P(\\cdot\\mid s, a, \\mu_t)")
('8.1', '(s_t, a_t, \\mu_t, z_t)=(s, a, \\mu, z)')
('8.1', "\\pmb{\\pi'}")
('8.1', "Q_T^*(s, a, \\mu, z; \\pmb{\\pi}')\\geq Q_T^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')")
('8.1', '\\pmb{\\pi}')
('8.1', "Q_t^*(s, a, \\mu, z; \\pmb{\\pi}')\\geq Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi}')")
('8.1', 't\\in \\mathcal{T}')
('8.2', "\\pmb{\\pi}'")
('8.2', '\\pmb{\\pi}')
('8.2', '\\pmb{\\rho}')
('8.2', "\\sum_{z\\in\\mathcal{Z}}\\rho_t(z)\\pi'_t(a|s, z) > 0")
('8.2', "a\\in\\mathop{\\arg\\max}_{a' \\in \\mathcal A} \\mathbb{E}_{z\\sim\\rho^{\\rm pred}_t(\\cdot|\\mathcal{I}_t)}Q^*(s, a', \\mu, z; \\pmb{\\pi})")
('8.2', '\\forall t\\in\\mathcal{T}')
('8.2', '\\begin{aligned}\n        \\mathcal{Q}_t^{\\pmb{\\pi}}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi})=\\mathbb{E}_{z\\sim\\rho^{\\rm pred}_t(\\cdot|\\mathcal{I}_t)}Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\n    \n\\end{aligned}')
('8.2', '\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi})=\\mathbb{E}_{z\\sim\\rho^{\\rm pred}_t(\\cdot|\\mathcal{I}_t)}Q_t^{*}(s, a, \\mu, z; \\pmb{\\pi})')
('8.2', "\\pmb{\\pi}'\\in\\mathrm{BR}(\\pmb{\\pi}; \\pmb{\\rho})")
('8.2', '\\pmb{\\pi}')
('8.2', '\\pmb{\\rho}')
('8.2', "\\sum_{z\\in\\mathcal{Z}}\\rho_{t}(z)\\pi't(a|s, z) > 0")
('8.2', "a\\in\\mathop{\\arg\\max}{a' \\in \\mathcal A} \\mathcal{Q}t^{*}(s, a, \\mu, \\mathcal{I}t; \\pmb{\\pi})")
('8.2', 't\\in\\mathcal{T}')
('8.2', "\\sum{z\\in\\mathcal{Z}}\\rho{t}(z)\\pi't(a|s, z) > 0")
('8.2', "a \\not\\in \\mathop{\\arg\\max}{a' \\in \\mathcal A} \\mathcal{Q}_t^{*}(s, a', \\mu, \\mathcal{I}_t; \\pmb{\\pi})")
('8.2', '\\pmb{\\pi}')
('8.2', '\\pmb{\\rho}')
('8.2', '\\pmb{\\pi}')
('8.2', "J(\\pmb{\\pi}', \\pmb{\\pi}, \\pmb{\\rho})=\\mathbb{E}\\left[\\mathcal{Q}_0^{\\pmb{\\pi}'}(s_0, a_0, \\mu_0, \\mathcal{I}_0; \\pmb{\\pi})\\right]")
('8.2', 'z\\sim\\rho_0(\\cdot)')
('8.2', 's_0\\sim\\mu_0')
('8.2', "a_0\\sim\\pi'_0(\\cdot|s_0, z_0)")
('8.2', '\\pmb{\\pi}^*')
('8.2', '\\sum_{z\\in\\mathcal{Z}}\\rho_{t}(z)\\pi_t^*(a|s, z) > 0')
('8.2', "a \\in \\mathop{\\arg\\max}_{a' \\in \\mathcal A} \\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi})")
('8.2', '\\pmb{\\pi}^{*}')
('8.2', "\\pmb{\\pi}'")
('8.2', '\\pmb{\\pi}')
('8.2', "\\pmb{\\pi}'")
('8.2', "a \\in \\mathop{\\arg\\max}_{a' \\in \\mathcal A} \\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi})")
('8.2', "\\sum_{z\\in\\mathcal{Z}}\\rho_{t}(z)\\pi'_t(a|s, z) > 0")
('8.2', "\\mathbb{E}\\left[\\mathcal{Q}_0^{\\pmb{\\pi}'}(s_0, a_0, \\mu_0, \\mathcal{I}_0; \\pmb{\\pi})\\right]=\\max_{\\pmb{\\tilde{\\pi}}}\\mathbb{E}\\left[\\mathcal{Q}_0^{\\pmb{\\tilde{\\pi}}}(s_0, a_0, \\mu_0, \\mathcal{I}_0; \\pmb{\\pi})\\right]")
('8.2', 'z\\sim\\rho_0(\\cdot)')
('8.2', 's_0\\sim\\mu_0')
('8.2', "a_0\\sim\\pi'_0(\\cdot|s_0, z_0)")
('8.2', 'z\\sim\\rho_0(\\cdot)')
('8.2', 's_0\\sim\\mu_0')
('8.2', 'a_0\\sim\\tilde{\\pi}_0(\\cdot|s_0, z_0)')
('8.2', "\\pmb{\\pi}'")
('8.2', '\\pmb{\\pi}')
('8.2', '\\pmb{\\rho}')
('8.2', '\\operatorname{BR}(\\boldsymbol{\\pi}; \\pmb{\\rho})')
('8.2', '\\lim_{n\\to\\infty}\\pmb{\\pi}_n = \\pmb{\\pi}')
('8.2', "\\lim_{n\\to\\infty}\\pmb{\\pi}'_n = \\pmb{\\pi}'")
('8.2', "\\pmb{\\pi}_n\\in \\operatorname{BR}(\\pmb{\\pi}'_n; \\pmb{\\rho})")
('8.2', "\\pmb{\\pi}\\not\\in\\operatorname{BR}(\\pmb{\\pi}'; \\pmb{\\rho})")
('8.2', 'a\\in\\mathcal{A}')
('8.2', "\\sum_{z\\in\\mathcal{Z}}\\rho_{t}(z)\\pi_{n, t}(a|s, z) > 0, a\\in\\mathop{\\arg\\max}_{a'}\\mathcal{Q}_t^{*}(s, a', \\mu, \\mathcal{I}_t; \\pmb{\\pi}'_n)")
('8.2', "a\\not\\in\\mathop{\\arg\\max}_{a'}\\mathcal{Q}_t^{*}(s, a', \\mu, \\mathcal{I}_t; \\pmb{\\pi}')")
('8.2', "a^\\star = \\mathop{\\arg\\max}_{a'}\\mathcal{Q}_t^{*}(s, a', \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')")
('8.2', '\\epsilon')
('8.2', "\\begin{aligned}\n        \\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n') - \\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n') = \\epsilon > 0\n    \n\\end{aligned}")
('8.2', "\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')=\\mathbb{E}_{z\\sim\\rho_t(\\cdot)}Q_{t}^{*}(s, a, \\mu, z; \\pmb{\\pi}')")
('8.2', 'N \\in \\mathbb{N}')
('8.2', "\\vert\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')-\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}'_{n})\\vert<\\frac{\\epsilon}{2}")
('8.2', "\\forall n > N, a'\\in\\mathcal{A}")
('8.2', "\\begin{aligned}\n        &\\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')-\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}') \\\\\n        =& \\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')+\\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')\\\\\n        &-\\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')+\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')\\\\\n        &-\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')-\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')\\\\\n        \\ge&\\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n') - \\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n') \\\\\n        &- \\vert\\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')-\\mathcal{Q}_t^{*}(s, a^{\\star}, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')\\vert\\\\\n        &- \\vert\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}')-\\mathcal{Q}_t^{*}(s, a, \\mu, \\mathcal{I}_t; \\pmb{\\pi}_n')\\vert\\\\\n        >& \\epsilon - \\frac{\\epsilon}{2} - \\frac{\\epsilon}{2} = 0,\n    \n\\end{aligned}")
('8.2', "a\\in\\mathop{\\arg\\max}_{a'}\\mathcal{Q}_t^{*}(s, a', \\mu, \\mathcal{I}_t; \\pmb{\\pi}')")
('8.2', '\\operatorname{BR}(\\pmb{\\pi}; \\pmb{\\rho})')
('8.2', '\\operatorname{BR}(\\pmb{\\pi}; \\pmb{\\rho})')
('8.2', '\\pmb{\\pi}')
('8.2', "\\pmb{\\pi}_1\\in \\operatorname{BR}(\\boldsymbol{\\pi}'; \\pmb{\\rho})")
('8.2', "\\pmb{\\pi}_2\\in \\operatorname{BR}(\\boldsymbol{\\pi}'; \\pmb{\\rho})")
('8.2', '\\sum_{z\\in\\mathcal{Z}}\\rho_t(z)\\pi_{i, t}(a\\mid s, z)>0')
('8.2', "a\\in \\mathop{\\arg\\max}_{a'\\in \\mathcal{A}}\\mathcal{Q}^{*}(s, a', \\mu, I_t; \\pmb{\\pi}')")
('8.2', '\\forall t \\in \\mathcal{T}')
('8.2', '\\forall i\\in \\{1, 2\\}')
('8.2', '\\pmb{\\pi}=\\lambda\\pmb{\\pi}_1+(1-\\lambda)\\pmb{\\pi}_2, \\lambda\\in [0, 1]')
('8.2', "\\pmb{\\pi}\\in \\operatorname{BR}(\\pmb{\\pi}'; \\pmb{\\rho})")
('8.2', '\\operatorname{BR}(\\pmb{\\pi}; \\pmb{\\rho})')
('8.2', '\\pmb{\\pi}')
('8.2', '\\pi_t \\in \\mathcal{P}(\\mathcal{A})')
('8.2', '\\mathcal{P}(\\mathcal{A})')
('8.2', '\\operatorname{BR}(\\boldsymbol{\\pi}; \\pmb{\\rho})')
('8.2', '\\boldsymbol{\\mu}')
('8.2', '\\pmb{\\rho}')
('8.2', '\\operatorname{BR}(\\boldsymbol{\\pi}; \\pmb{\\rho})')
('8.2', '\\boldsymbol{\\pi}^* \\in \\operatorname{BR}(\\pmb{\\pi}^*; \\pmb{\\rho})')
('8.2', '\\forall u\\in \\mathcal{U}')
('8.2', '\\forall s\\in \\mathcal{A}')
('8.2', '\\forall t\\in \\mathcal{T}')
('8.2', '\\begin{aligned}\n       \\Delta_t(s_t, \\mu_t, u; \\pmb{\\pi}^*, \\pmb{\\rho}) &=\\sum_{z\\in\\mathcal{Z}}\\sum_{a\\in\\mathcal{A}} \\rho_t(z)\\pi_t^{*}(a|s, z) \\big(Q_t^{\\pmb{\\pi}^*}(s_t, u(a), \\mu_t, z; \\pmb{\\pi}^*) \\\\\n       &- Q^{\\pmb{\\pi}^*}(s_t, a, \\mu_t, z; \\pmb{\\pi}^*)\\big) \\le 0,\n    \n\\end{aligned}')
('8.2', '\\mu_{t}=\\Phi(\\mu_{t-1}, \\pi_{t-1}^{*}, z_t)')
('8.2', '(\\pmb{\\pi}^{*}, \\pmb{\\rho})')
('8.3', '(\\pmb{\\pi}, \\pmb{\\mu})')
('8.3', '\\pi_t(a\\mid s, z) > 0')
('8.3', "a \\in \\mathop{\\arg\\max}_{a' \\in \\mathcal A} Q_t^{*}(s, a', \\mu, z; \\pmb{\\pi})")
('8.3', '\\pmb{\\rho}=\\{\\rho_t\\}_{t\\in\\mathcal{T}}')
('8.3', '\\rho_t=\\delta(z)')
('8.3', 't\\in\\mathcal{T}')
('8.3', '\\sum_{z}\\rho_{t}(z)\\pi_{t}(a\\mid s, z) > 0')
('8.3', "a \\in \\mathop{\\arg\\max}_{a' \\in \\mathcal A} \\mathbb{E}_{z\\sim\\rho_{t}^{\\rm pred}(\\cdot|\\mathcal{I}_{t})}\\left[Q_{t}^{*}(s, a', \\mu, z; \\pmb{\\pi})\\right]")
('8.3', '\\pmb{\\mu}')
('8.3', '\\mu_{t}=\\Phi(\\mu_{t-1}, \\pi_{t-1}, z)')
('8.3', '(\\pmb{\\pi}, \\pmb{\\rho})')
('8.4', '(\\pmb{\\pi}, \\pmb{\\rho})')
('8.4', 't')
('8.4', '\\begin{aligned}\n    \\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, \\mu_t)\\middle|a_{0:T}\\right] > J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho})\n\\end{aligned}')
('8.4', "\\begin{aligned}\n    \\sum_{a\\in\\mathcal{A}}\\sum_{z\\in\\mathcal{Z}}\\rho_t(z)\\pi_t(a|s, z)\\Big[Q_t^{\\pmb{\\pi}}(s, a, \\mu_t, z; \\pmb{\\pi})-Q_t^{\\pmb{\\pi}}(s, a', \\mu_t, z; \\pmb{\\pi})\\Big]\\ge0\n\\end{aligned}")
('8.4', '\\begin{aligned}\n    &\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, \\mu_t)\\middle|a_{0:T}\\right]\\\\\n    =&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T-1} \\gamma^t r(a_t, s_t, \\mu_t) + \\gamma^{T}r(s_{T}, a_{T}, \\mu_{T})\\middle|a_{0:T}\\right]\\\\\n    \\le&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T-1} \\gamma^t r(a_t, s_t, \\mu_t) + \\gamma^{T}\\mathbb{E}\\left[Q_T^{\\pmb{\\pi}}(s_T, a, \\mu_T, z; \\pmb{\\pi})\\right]\\middle|a_{0:T-1}\\right]\n\\end{aligned}')
('8.4', 'z\\sim\\rho_{T}(\\cdot)')
('8.4', 'a\\sim\\pi_T(\\cdot|s_T, z)')
('8.4', '\\begin{aligned}\n    &\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, \\mu_t)\\middle|a_{0:T}\\right]\\\\\n    \\le&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\Bigg[\\sum_{t=0}^{T-2} \\gamma^t r(a_t, s_t, \\mu_t) + \\gamma^{T-1} r(s_{T-1}, a_{T-1}, \\mu_{T-1}) \\\\\n    &+ \\gamma^{T}\\mathbb{E}\\left[Q_T^{\\pmb{\\pi}}(s_T, a, \\mu_T, z; \\pmb{\\pi})\\right]\\bigg|a_{0:T-1}\\Bigg]\\\\\n    \\le&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T-2} \\gamma^t r(a_t, s_t, \\mu_t) + \\gamma^{T-1}\\mathbb{E}[Q_{T-1}^{\\pmb{\\pi}}(s_{T-1}, a, \\mu_{T-1}, z;\\pmb{\\pi})]\\middle|a_{0:T-2}\\right]\\\\\n    \\le&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\bigg[Q_0^{\\pmb{\\pi}}(s_{0}, a, \\mu_0, z; \\pmb{\\pi})\\bigg]=J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}),\n\\end{aligned}')
('8.4', 'z\\sim\\rho_0, s_0\\sim\\mu_0(\\cdot), a\\sim\\pi_{0}(\\cdot|s_0, z)')
('8.4', '(\\pmb{\\pi}, \\pmb{\\rho})')
('8.4', 't\\in \\mathcal{T}')
('8.4', '\\Delta_{t}(s, \\mu, u; \\pmb{\\pi}, \\pmb{\\rho})=\\mathbb{E}[Q_{t}^{\\pmb{\\pi}}(s, u(a), \\mu, z)-Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z)]>0')
('8.4', 'u(a)')
('8.4', 'a')
('8.4', 't')
('8.4', '\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho})>0')
('8.5', '\\begin{aligned}\n        \\sum_{\\tau_k\\in\\mathcal{D}_E}\\lambda_{\\pmb{\\pi}^*}(\\tau_i)&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T}\\gamma^t r(s_t, a_t, \\mu_t)\\middle|a_{0:T}\\right]\\\\\n        =&\\mathbb{E}_{\\pmb{\\pi}^{*}}\\left[\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T}\\gamma^t r(s_t, a_t, \\mu_t)\\middle|a_{0:T}\\right]\\right]\\\\\n        =&\\mathbb{E}_{\\pmb{\\pi}^*, \\pmb{\\pi}, \\pmb{\\rho}}\\left[\\sum_{t=0}^{T}\\gamma^{t}r(s_t, a_t, \\mu_t)\\right]\n    \n\\end{aligned}')
('8.5', '\\mathbb{E}_{\\pmb{\\pi}^{*}}')
('8.5', 'a_t\\sim\\pi_t^{*}(\\cdot|s_t, z_t)')
('8.5', '\\begin{aligned}\n        L(\\boldsymbol{\\pi}, \\pmb{\\rho}, \\lambda_{\\pmb{\\pi}^*}, r)=&J(\\pmb{\\pi}^*, \\pmb{\\pi}, \\pmb{\\rho})-J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho})\n    \n\\end{aligned}')
('8.6', '\\tilde{r}=\\operatorname{AMFCE-IRL}(\\boldsymbol{\\pi}^E, \\pmb{\\rho}^E)')
('8.6', 'L(\\pmb{\\pi}, \\pmb{\\rho}, \\lambda, r)')
('8.6', '\\lambda_{\\pmb{\\pi}}^{E}(\\tau_k)=\\prod_{t=0}^{T}\\pi_t^E(a_t|s_t, z_t)')
('8.6', '\\tilde{r}')
('8.6', '(\\pmb{\\pi}^E, \\pmb{\\rho}^E)\\in\\operatorname{AMFCE}')
('8.6', '(\\pmb{\\pi}^E, \\pmb{\\rho}^E)')
('8.6', '\\pmb{\\pi}^E')
('8.6', '\\begin{aligned}\n\\label{recover}\n        \\pmb{\\pi}&=\n        \\mathop{\\arg\\min}_{\\pmb{\\pi}}J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E) - \\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}[\\sum_{t=0}^{T}\\gamma^{t}\\tilde{r}(s_t, a_t, \\mu_t)]\\nonumber\\\\\n        &=\\mathop{\\arg\\min}_{\\pmb{\\pi}} \\max_{r} J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E) - J(\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}^E) - \\psi_{GA}(r)\n    \n\\end{aligned}')
('8.6', '\\psi_{GA}')
('8.6', 'r(s, a, \\mu) = \\log\\big(D_{\\omega}(s, a, \\mu)\\big)')
('8.6', '\\begin{aligned}\n        &\\max_{r} J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E) - J(\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}^E) - \\psi_{GA}(r)\\\\\n        =&\\max_{\\omega}\\mathbb{E}_{\\pmb{\\pi}_E, \\pmb{\\pi}_E, \\pmb{\\rho}_E}\\left[\\sum_{t=0}^{T}\\gamma^{t}\\log(D_{\\omega}(s, a, \\mu))\\right] \\\\\n        &- \\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}_E}\\left[\\sum_{t=0}^{T}\\gamma^{t}\\log(D_{\\omega}(s, a, \\mu))\\right] \\\\\n        &- \\max_{\\omega}\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}_E, \\pmb{\\rho}_E}\\left[\\sum_{t=0}^T g(r(s_t, a_t, \\mu_t))\\right]\\\\\n        =&\\max_{\\omega}\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^{T}\\gamma^{t}\\log D_\\omega(s_t, a_t, \\mu_t)\\right] \\\\\n        &+ \\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^{T}\\gamma^{t}\\log\\big(1 - D_\\omega(s_t, a_t, \\mu_t)\\big)\\right].\n    \n\\end{aligned}')
('8.7', '\\rho^\\phi')
('8.7', '\\begin{aligned}\n        \\nabla_\\phi\\Delta_t&(s, \\mu, u; \\pmb{\\pi}, \\pmb{\\rho})=\\nabla_{\\phi}\\sum_{z\\in\\mathcal{Z}}\\rho_t^{\\phi}(z)\\sum_{a\\in\\mathcal{A}}\\pi_t(a|s, z)Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\\\\n        =&\\sum_{z\\in\\mathcal{Z}}\\nabla_{\\phi}\\rho_{t}^{\\phi}(z)\\sum_{a\\in\\mathcal{A}}\\pi_{t}(a|s, z)Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\\\\n        =&\\mathbb{E}_{z\\sim\\rho_{t}^{\\phi}(\\cdot)}\\Big[\\sum_{a\\in\\mathcal{A}}\\pi_t(a|s, z)Q_t^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\nabla_{\\phi}\\log\\rho_t^{\\phi}(z)\\Big]\\\\\n        =&\\mathbb{E}_{z\\sim\\rho_{t}^{\\phi}(\\cdot)}\\bigg[\\nabla_{\\phi}\\log\\rho_t^{\\phi}(z)\\mathbb{E}_{a\\sim\\pi_t(\\cdot|s, z)}Q_{t}^{\\pmb{\\pi}}(s, a, \\mu, z; \\pmb{\\pi})\\bigg].\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        D_\\omega^*(s_t, a_t, \\hat{\\mu}_t)=\\frac{2\\eta_t^{\\pmb{\\pi}}(s_t, a_t, \\hat{\\mu}_t)}{\\eta_t^{\\pmb{\\pi}}(s_t, a_t, \\hat{\\mu}_t)+\\eta_t^{E}(s_t, a_t, \\hat{\\mu}_t)},\n    \n\\end{aligned}')
('8.8', '\\hat{\\mu}_t=\\mathrm{Sig}(\\pmb{z}_{0:t})')
('8.8', '\\eta_t^{\\pi}(s, a, \\hat{\\mu})')
('8.8', '\\eta_t^{E}(s, a, \\hat{\\mu})')
('8.8', 't')
('8.8', '\\eta_t^{E}')
('8.8', '\\eta_t^{\\pi}')
('8.8', "\\begin{aligned}\n        \\begin{cases}\n            \\eta_t^{\\pi}(s, a, \\hat{\\mu})=\\rho_t^E(z_t)\\pi_t(a|s, z_t)\\eta_t(s, \\hat{\\mu}_t)\\\\\n            \\eta_t^{\\pi}(s, \\hat{\\mu})=\\sum_{a'\\in\\mathcal{A}}\\sum_{s'\\in\\mathcal{S}}\\eta_{t-1}^\\pi(s', a')P(s|s', a', \\mu_{t-1})\\\\\n            \\eta_0^{\\pi}(s, \\hat{\\mu})=\\mu_0\n        \\end{cases}\n    \n\\end{aligned}")
('8.8', "\\begin{aligned}\n        \\begin{cases}\n            \\eta_t^{E}(s, a, \\hat{\\mu})=\\rho_t^E(z_t)\\pi_t^E(a|s, z_t)\\eta_t(s, \\hat{\\mu}_t)\\\\\n            \\eta_t^{E}(s, \\hat{\\mu})=\\sum_{a'\\in\\mathcal{A}}\\sum_{s'\\in\\mathcal{S}}\\eta_{t-1}^E(s', a')P(s|s', a', \\mu_{t-1})\\\\\n            \\eta_0^{E}(s, \\hat{\\mu})=\\mu_0\n        \\end{cases}\n    \n\\end{aligned}")
('8.8', '\\hat{\\mu}_t=\\mathrm{Sig}(\\pmb{z}_{0:t})')
('8.8', '\\begin{aligned}\n        \\max_{\\omega}&\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^t\\log D_\\omega^*(s_t, a_t, \\hat{\\mu}_t)\\bigg]\\nonumber\\\\\n        &+\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^t\\log\\big(1 - D_\\omega^*(s_t, a_t, \\hat{\\mu}_t)\\big)\\bigg]\\le\\epsilon,\n        % \\\\+\\alpha\\sum_{t=0}^{T}\\mathbb{E}H(\\pi_t|s_t, z_t)\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\sum_{t=0}^{T}\\gamma^tD_{\\mathrm{JS}}\\left(\\eta_t^{E}(s, a, \\hat{\\mu}), \\eta_t^{\\pi}(s, a, \\hat{\\mu})\\right)\\le\\epsilon.\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\frac{1}{2}&\\left\\|\\eta_t^E(s, a, \\hat{\\mu})-\\eta_t^\\pi(s, a, \\hat{\\mu})\\right\\|_1\\le\\nonumber\\\\&\\sqrt{2D_{\\mathrm{KL}}\\left(\\eta_t^\\pi(s, a, \\hat{\\mu}), \\frac{\\eta_t^E(s, a, \\hat{\\mu})+\\eta_t^\\pi(s, a, \\hat{\\mu})}{2}\\right)}.\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\left\\|\\eta_t^E(s, a, \\hat{\\mu})-\\eta_t^\\pi(s, a, \\hat{\\mu})\\right\\|_1\\le2\\sqrt{2D_{\\mathrm{JS}}(\\eta_t^{E}(s, a, \\hat{\\mu}), \\eta_t^{\\pi}(s, a, \\hat{\\mu}))}\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\frac{1}{T}&\\sum_{t=0}^{T}\\gamma^t\\left\\|\\eta_t^E(s, a, \\hat{\\mu})-\\eta_t^\\pi(s, a, \\hat{\\mu})\\right\\|_1\\\\&\\le\\frac{1}{T}\\sum_{t=0}^{T}2\\sqrt{2\\gamma^{2t}D_{\\mathrm{JS}}(\\eta_t^{E}(s, a, \\hat{\\mu}), \\eta_t^{\\pi}(s, a, \\hat{\\mu}))}\\\\\n        &\\le2\\sqrt{\\frac{1}{T}\\sum_{t=0}^{T}2\\gamma^{t}D_{\\mathrm{JS}}(\\eta_t^{E}(s, a, \\hat{\\mu}), \\eta_t^{\\pi}(s, a, \\hat{\\mu}))}\\\\\n        &\\le2\\sqrt{\\frac{2\\epsilon}{T}}\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\sum_{t=0}^{T}\\gamma^t\\left\\|\\eta_t^E(s, a, \\hat{\\mu})-\\eta_t^\\pi(s, a, \\hat{\\mu})\\right\\|_1\\le2\\sqrt{2\\epsilon T}.\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        D_{\\mathrm{KL}}&\\left(\\eta_t^E(s, a, \\hat{\\mu}), \\frac{\\eta_t^\\pi(s, a, \\hat{\\mu})+\\eta_t^E(s, a, \\hat{\\mu})}{2}\\right)\\\\\n        &=\\mathbb{E}_{\\eta_t^E(s, a, \\hat{\\mu})}\\log\\frac{2\\eta_t^E(s, a, \\hat{\\mu})}{\\eta_t^\\pi(s, a, \\hat{\\mu})+\\eta_t^E(s, a, \\hat{\\mu})}\\\\\n        &=\\sum_{s, a, \\hat{\\mu}}\\eta_t^E(s, a, \\hat{\\mu})\\log\\frac{2\\eta_t^E(s, a, \\hat{\\mu})}{\\eta_t^\\pi(s, a, \\hat{\\mu})+\\eta_t^E(s, a, \\hat{\\mu})}\\\\\n        &=\\sum_{s\\in\\mathcal{S}}\\eta_t^E(s, \\hat{\\mu})\\sum_{a\\in\\mathcal{A}}\\frac{\\eta_t^E(s, a, \\hat{\\mu})}{\\eta_t^E(s, \\hat{\\mu})}\\log\\frac{2\\eta_t^E(s, a, \\hat{\\mu})}{\\eta_t^\\pi(s, a, \\hat{\\mu})+\\eta_t^E(s, a, \\hat{\\mu})}\\\\\n        &\\ge\\sum_{s\\in\\mathcal{S}}\\eta_t^E(s, \\hat{\\mu})\\log\\frac{2\\eta_t^E(s, \\hat{\\mu})}{\\sum_{a\\in\\mathcal{A}}\\eta_t^\\pi(s, a, \\hat{\\mu})+\\eta_t^E(s, \\hat{\\mu})}\\\\\n        &=\\sum_{s\\in\\mathcal{S}}\\eta_t^E(s, \\hat{\\mu})\\log\\frac{2\\eta_t^E(s, \\hat{\\mu})}{\\eta_t^\\pi(s, \\hat{\\mu})+\\eta_t^E(s, \\hat{\\mu})}\\\\\n        &=D_{\\mathrm{KL}}\\left(\\eta_t^E(s, \\hat{\\mu}), \\frac{\\eta_t^\\pi(s, \\hat{\\mu})+\\eta_t^E(s, \\hat{\\mu})}{2}\\right)\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        D_{\\mathrm{KL}}&\\left(\\eta_t^\\pi(s, a, \\hat{\\mu}), \\frac{\\eta_t^\\pi(s, a, \\hat{\\mu})+\\eta_t^E(s, a, \\hat{\\mu})}{2}\\right)\\nonumber\\\\\\ge& D_{\\mathrm{KL}}\\left(\\eta_t^\\pi(s, \\hat{\\mu}), \\frac{\\eta_t^\\pi(s, \\hat{\\mu})+\\eta_t^E(s, \\hat{\\mu})}{2}\\right).\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\sum_{t=0}^{T}\\gamma^tD_{\\mathrm{JS}}(\\eta_t^E(s, \\hat{\\mu}), \\eta_t^\\pi(s, \\hat{\\mu}))\\le \\sum_{t=0}^{T}\\gamma^tD_{\\mathrm{JS}}(\\eta_t^E(s, a, \\hat{\\mu}), \\eta_t^\\pi(s, a, \\hat{\\mu}))\\le\\epsilon.\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\sum_{t=0}^{T}\\gamma^t\\left\\|\\eta_t^E(s, \\hat{\\mu})-\\eta_t^\\pi(s, \\hat{\\mu})\\right\\|_1\\le2\\sqrt{2\\epsilon T}.\n    \n\\end{aligned}')
('8.8', "\\pmb{\\mu}'")
('8.8', "\\mu_t'=\\Phi(\\mu_{t-1}', \\pi_{t-1}^E, z_{t-1})")
('8.8', "\\begin{aligned}\n        &\\left\\|J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E)-J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\right\\|_1=\\\\ &\\left\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^T\\gamma^t r(s_t, a_t, \\mu_t)\\right]-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^T\\gamma^t r(s_t, a_t, \\mu_t')\\right]\\right\\|_1\\\\\n        \\le &\\left\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^T\\gamma^t \\left(r(s_t, a_t, \\mu_t)-r(s_t, a_t, \\mu_t')\\right)\\right]\\right\\|_1+\\\\\n        &\\left\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^T\\gamma^t r(s_t, a_t, \\mu_t')\\right]-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\left[\\sum_{t=0}^T\\gamma^t r(s_t, a_t, \\mu_t')\\right]\\right\\|_1\\\\\n        \\le &2L_R\\sqrt{2\\epsilon T}+2r_{\\max}\\sqrt{2\\epsilon T}\\\\\n        \\le &2(L_R+r_{\\max})\\sqrt{2\\epsilon T}.\n    \n\\end{aligned}")
('8.8', '\\begin{aligned}\n        &\\left\\|\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho}^E)-\\mathcal{R}(a_{0:T}, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\right\\|_1\\\\&\\le\\left\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\Big[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{0:T}\\Big]\\right.\\\\\n        &\\quad\\left.-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=0}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{0:T}\\Big]\\right\\|_1\\\\\n        &\\quad+\\left\\|J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E)-J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\right\\|_1\\\\\n        &\\le 2\\left(2L_R+r_{\\max}+\\gamma TL_Pr_{\\max}\\right)\\sqrt{2\\epsilon T}.\n    \n\\end{aligned}')
('8.8', '\\mathcal{R}(a_{0:T}, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\le0')
('8.8', '\\begin{aligned}\n        \\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho}^E)\\le&\\left\\|\\mathcal{R}(a_{0:T}, \\pmb{\\pi}, \\pmb{\\rho}^E)-\\mathcal{R}(a_{0:T}, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\right\\|_1\\\\\\le& 2\\left(2L_R+r_{\\max}+\\gamma TL_Pr_{\\max}\\right)\\sqrt{2\\epsilon T}.\n    \n\\end{aligned}')
('8.8', '\\begin{aligned}\n        \\Bigg\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}&\\Big[\\sum_{t=k}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{k:T}\\Big]\\\\-&\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=k}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{k:T}\\Big]\\Bigg\\|_1\\\\\\le& (L_R+\\gamma TL_Pr_{\\max})\\sum_{t=k}^T\\gamma^{t-k}\\|\\eta_t^\\pi-\\eta_t^{E}\\|_1.\n    \n\\end{aligned}')
('8.8', 'k = T')
('8.8', '\\begin{aligned}\n        &\\bigg\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\Big[\\sum_{t=k}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{k:T}\\Big]\\\\\n        &\\quad\\quad\\quad-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=k}^{T} \\gamma^t r(s_t, a_t, \\mu_{t})\\Big|a_{k:T}\\Big]\\bigg\\|_1\\\\\n        =&\\Bigg\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\Big[r(s_k, a_k, \\mu_{k})\\\\\n        &+\\gamma\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\Big|a_{k:T}\\Big]\\\\\n        &-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[r(s_k, a_k, \\mu_{k})\\\\\n        &+\\gamma\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\Big|a_{k:T}\\Big]\\Bigg\\|_1\\\\\n        \\le&\\left\\|r(s_k, a_k, \\eta_{t}^E)-r(s_k, a_k, \\eta_{t}^\\pi)\\right\\|_1\\\\\n        &+\\left\\|P(s_{t+1}|s_t, a_t, \\eta_{t}^E)-P(s_{t+1}|s_t, a_t, \\eta_{t}^\\pi)\\right\\|_1\\\\\n        &\\left\\|\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\right\\|_1\\\\\n        &+\\gamma\\Bigg\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\\\\n        &-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\Bigg\\|_1\\\\\n        \\le& L_R\\|\\eta_k^E-\\eta_k^\\pi\\|_1+\\gamma Tr_{\\max}L_P\\|\\eta_k^E-\\eta_k^\\pi\\|_1\\\\\n        &\\quad+\\gamma\\Bigg\\|\\mathbb{E}_{\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\\\\n        &\\quad-\\mathbb{E}_{\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\Big[\\sum_{t=k+1}^{T} \\gamma^{t-k} r(s_t, a_t, \\mu_{t})\\Big|a_{k+1:T}\\Big]\\Bigg\\|_1\\\\\n        \\le& L_R\\|\\eta_k^E-\\eta_k^\\pi\\|_1\\\\\n        &+\\gamma Tr_{\\max}L_P\\|\\eta_k^E-\\eta_k^\\pi\\|_k+(L_R+\\gamma L_PTr_{\\max})\\sum_{t=k+1}^T\\gamma^{t-k}\\|\\eta_t^\\pi-\\eta_t^{E}\\|_1\\\\\n        \\le&(L_R+\\gamma TL_Pr_{\\max})\\sum_{t=k}^T\\gamma^{t-k}\\|\\eta_t^\\pi-\\eta_t^{E}\\|_1\n    \n\\end{aligned}')
('8.9', "\\pmb{\\pi}' = \\arg\\max_{\\hat{\\pmb{\\pi}}}J(\\hat{\\pmb{\\pi}}, \\pmb{\\pi}, \\pmb{\\rho}^E)")
('8.9', '\\pmb{\\pi}')
('8.9', '\\pmb{\\rho}^E')
('8.9', "\\begin{aligned}\n        &J(\\pmb{\\pi}', \\pmb{\\pi}, \\pmb{\\rho}^E) - J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E)\\\\&\\le \\left\\|\\mathbb{E}_{\\pmb{\\pi}', \\pmb{\\pi}, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^tr(s_t, a_t, \\mu_t)\\bigg]-\\mathbb{E}_{\\pmb{\\pi}', \\pmb{\\pi}, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^tr(s_t, a_t, \\mu_t')\\bigg]\\right\\|_1\\\\\n        &\\quad+\\left\\|\\mathbb{E}_{\\pmb{\\pi}', \\pmb{\\pi}, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^tr(s_t, a_t, \\mu_t')\\bigg]-\\mathbb{E}_{\\pmb{\\pi}', \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^tr(s_t, a_t, \\mu_t')\\bigg]\\right\\|_1\\\\\n        &\\quad+\\mathbb{E}_{\\pmb{\\pi}', \\pmb{\\pi}^E, \\pmb{\\rho}^E}\\bigg[\\sum_{t=0}^{T}\\gamma^tr(s_t, a_t, \\mu_t')\\bigg]-J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E)\\\\\n        &\\quad+J(\\pmb{\\pi}^E, \\pmb{\\pi}^E, \\pmb{\\rho}^E)-J(\\pmb{\\pi}, \\pmb{\\pi}, \\pmb{\\rho}^E)\\\\\n        &\\le 2L_R\\sqrt{2\\epsilon T}+2(L_R+\\gamma TL_Pr_{\\max})\\sqrt{2\\epsilon T}+0+2(L_R+r_{\\max})\\sqrt{2\\epsilon T}\\\\\n        &=2(3L_R+\\gamma TL_Pr_{\\max}+r_{\\max})\\sqrt{2\\epsilon T},\n    \n\\end{aligned}")
('8.9', "\\mu_t'=\\Phi(\\mu_{t-1}', \\pi_{t-1}^E, z_{t-1})")
('9', 'Q_{n}^{\\pi,\\mu}(x,u(a)|\\Xi_{n})-Q_{n}^{\\pi,\\mu}(x,a|\\Xi_{n})\\leq 0,')
('9', 'u(a)\\in\\mathcal{A}')
('9', '\\begin{aligned}\n        Q_N^{\\pi,\\mu}(x,a|\\Xi_N)=&r(x,a,\\mu_{N|\\Xi_N},\\xi_N),    \n    \\end{aligned}')
('9', '\\begin{aligned}\n        &Q_{n-1}^{\\pi,\\mu}(x,a|\\Xi_{n-1})=\\underbrace{\\sum_{\\xi}P(\\xi_{n-1}=\\xi|\\Xi_{n-1})}\\Big[ r(x,a,\\mu_{n-1,\\Xi_{n-1}},\\xi)\\\\&+\\sum_{x^{\\prime}\\in\\mathcal{X}}p(x^{\\prime}|x,a,\\xi)E_{\\pmb{b}\\sim\\pi_n(\\cdot|x^{\\prime},\\Xi_{n-1}\\cdot\\xi)}\\left[Q_n^{\\pi,\\mu}(x^{\\prime},b|\\Xi_{n-1}.\\xi)\\right]\\Big],\n    \\end{aligned}')
('9', 'z')
('9', 'a')
('9', '\\underbrace{\\sum_{z}\\frac{\\rho_t(z)\\pi_t(a|s, z)}{\\sum_{a}\\rho_t(z)\\pi_t(a|s, z)}}[Q_t^{\\pmb{\\pi}}( s, u(a) , \\mu, z; \\pmb{\\pi})-Q_t^{\\pmb{\\pi}}(s,a,\\mu,z;\\pmb{\\pi})]\\leq0.')
('9', '\\mathcal{G}')
('9', '\\mathcal{G}')
('9', 'S=\\{C,L,R\\}')
('9', 'A=\\{L,R\\}')
('9', '\\mu_0(C)=1')
('9', 'r(s,a,\\mu) = 1_{\\{ s= L\\} }\\mu( L) + 1_{\\{ s= R\\} }\\mu( R)')
('9', 'P(s_{t+1}=R|s_t=\\cdot,a=R)=1')
('9', 'P(s_{t+1}=L|s_t=\\cdot,a=L)=1')
('9', '\\mathcal{Z}=\\{0, 1\\}')
('9', '\\rho(z=0)=\\rho(z=1)=0.5')
('9', '\\pi(a=L|s=\\cdot, z=0)=\\frac23')
('9', '\\pi(a=L|s=\\cdot, z=1)=\\frac13')
('9', '\\pi(a=L|s=\\cdot, z=0)=1, 0, \\frac12')
('9', '\\pi(a=L|s=\\cdot, z=1)=1, 0, \\frac12')
('10', '\\boldsymbol{\\pi}')
('10', '\\mathcal{T}=\\{0, 1\\}')
('10.0.0', '\\mathcal{S}=\\{0, 1, 2\\}')
('10.0.0', '\\mathcal{A}=\\{0, 1\\}')
('10.0.0', '\\mu_0(s=2)=1')
('10.0.0', '\\begin{aligned}\n    &P(s_{t+1}=1\\mid s_t = \\cdot, a=1) = \\frac{3}{4},\n    &P(s_{t+1}=0\\mid s_t = \\cdot, a=1) = \\frac{1}{4}, \\\\\n    &P(s_{t+1}=1\\mid s_t = \\cdot, a=0) = \\frac{1}{4},\n    &P(s_{t+1}=0\\mid s_t=\\cdot, a=0) = \\frac{3}{4}\n\\end{aligned}')
('10.0.0', 'r(s, a, \\mu)=\\mathds{1}_{\\{s=L\\}}\\mu(L)+\\mathds{1}_{\\{s=R\\}}\\mu(R).')
('10.0.0.0', '\\begin{aligned}\n    P(s_{t+1}\\mid s_t, a_t, \\mu_t) = \\mathds{1}_{s_{t+1}=a_t}\n\\end{aligned}')
('10.0.0.0', '\\mathcal{S}=\\{C, R, P, S\\}')
('10.0.0.0', '\\mathcal{A}=\\{R, P, S\\}')
('10.0.0.0', 'C')
('10.0.0.0', '\\begin{aligned}\n    r(R, a, \\mu_t) = 2\\cdot\\mu_t(S) - 1\\cdot\\mu_t(P)\\\\\n    r(P, a, \\mu_t) = 4\\cdot\\mu_t(R) - 2\\cdot\\mu_t(S)\\\\\n    r(S, a, \\mu_t) = 2\\cdot\\mu_t(P) - 1\\cdot\\mu_t(R)\n\\end{aligned}')
('10.0.0.1', '\\begin{aligned}\n    x_{t+1}=x_{t}+v_{t} \\Delta t\n\\end{aligned}')
('10.0.0.1', '\\mathcal{A}=\\{0, 1, 2, 3\\}')
('10.0.0.1', '\\begin{aligned}\n    f_{\\beta}^{\\mathrm{flock}}(x, v, u, \\mu)=-\\left\\|\\int_{\\mathbb{R}^{2 d}} \\left(v-v^{\\prime}\\right)\\mathrm{d} \\mu\\left(x^{\\prime}, v^{\\prime}\\right)\\right\\|^{2}\n\\end{aligned}')
('11', 's_1')
('11', 's_1')
('11', 'B')
('11', '\\mu(s_1)=1')
('11', 'E')
('11', 's_2')
('11', 's_2')
('11', 's_2')
('11', '\\begin{aligned}\n        r(s, a, \\mu)=\\left\\{\\begin{array}{cc}\n            3(1-\\mu(s_1)), & a=E, s=s_1 \\\\\n            \\frac{1}{2}, & a=B, s=s_1, \\mu=\\cdot \\\\\n            0, & otherwise\n        \\end{array}\\right..\n    \n\\end{aligned}')
('11', 'E')
('11', "s'")
('11', 'B')
('11', 'E')
('11', "\\pi(B|s',z=0)")
('11', '\\rho(z=0)')
('11', "\\pi(B|s',z=0)")
('11', "\\pi(B|s',z=1)")
('11', '\\rho(z=0)')
('11', '\\rho(z=1)')
('12', '\\mathbf{z}')
('12', '\\pmb{\\pi}')
('12', '\\pi')
('12', '\\mathbf{z}')
('12', '\\pmb{\\mu}')
('12', '\\pmb{\\mu}')
('12', 'a_t')
('12', 't')
('12', 's_t')
('12', "V_t\\left(s,\\pmb{\\pi},{\\color{black}\\pmb{\\mu}}\\right)\\geq V_t\\left(s,\\pmb{\\pi}',\\pmb{\\mu}\\right).")
('12', "\\pmb{\\pi}'")
('12', 't\\in \\mathcal{T}')
('12', 's\\sim \\mu_0')
('13.0', '\\mathbf{x}=\\{x_1, \\dots, x_L\\}')
('13.0', 'x_i\\in\\mathbb{R}^d')
('13.0', 'i')
('13.0', 'L\\ge2')
('13.0', 'f:[0, 1]\\to\\mathbb{R}^{d}')
('13.0', 'f(\\frac{i-1}{L-1})=x_i')
('13.0', '\\forall i\\in\\{1, 2, \\dots, L\\}')
('13.0', '\\begin{aligned}\n\\label{eq:signature}\n        \\mathrm{Sig}(f)_{0, 1}=\\left(1, M_1, \\cdots, M_n, \\ldots\\right),\n    \n\\end{aligned}')
('13.0', 'M_n=\\int_{s<s_{1}<\\cdots<s_{n}<t}  \\frac{\\mathrm{d}f}{\\mathrm{d}t}(s_1) \\otimes \\cdots \\otimes \\frac{\\mathrm{d}f}{\\mathrm{d}t}(s_n)\\mathrm{d}t_1\\cdots \\mathrm{d}t_n')
('13.0', '\\mathbf{x}')
('13.0', '\\mathrm{Sig}(f)_{0,1}')
('13.0', '\\mathrm{Sig}(\\mathbf{x})')
('13.0', 'M_{n}')
('13.0', 'n')
('13.1', "\\mu_{t+1}(s)=\\sum_{a\\in\\mathcal{A}}\\sum_{s'\\in\\mathcal{S}}\\mu_t(s')P(s|s', a, \\mu_t)\\pi_t^E(a|s', z_t).")
('13.1', "P(s|s', a, \\mu_t)")
('13.1', '\\mu_t')
('13.1', "\\pi_t^E(a|s', z_t)")
('13.1', '\\mu_{t}(s)')
('13.1', 'z_{0:t}')
('13.1', '\\hat{\\mu_t}')
('13.1', "\\mu_t=\\phi(z_{0:t})=\\phi'({\\rm Sig}(z_{0:t}))")
('13.1', '{\\rm Sig}(z_{0:t})')
('13.1', '\\mu_t')
('13.1', '\\mu_t')
('13.1', 'z_{0:t}')
