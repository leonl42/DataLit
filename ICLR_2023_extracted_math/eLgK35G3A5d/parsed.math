('1', '\\log q(\\bm{x})')
('2.1', '\\bm{z}')
('2.1', '\\bm{x}')
('2.2', 'g_{\\theta}(.)')
('2.2', '\\bm{z}\\sim p_{z}')
('2.2', '\\bm{x}=g_{\\theta}(\\bm{z})')
('3', '\\bm{x}\\sim p')
('3', 'q_{\\phi}(\\bm{x})')
('3', 'p')
('3', 'p')
('3', 'q_{\\phi}')
('3', '\\displaystyle\\mathcal{D}_{FD}(p,q_{\\phi})\\coloneqq\\mathbb{E}_{\\bm{x}\\sim p}%\n\\biggl{\\{}\\|\\nabla_{\\bm{x}}\\log p(\\bm{x})\\|_{2}^{2}+\\|\\nabla_{\\bm{x}}\\log q_{%\n\\phi}(\\bm{x})\\|_{2}^{2}')
('3', '\\displaystyle\\mathcal{D}_{FD}(p,q_{\\phi})\\coloneqq')
('3', '\\displaystyle\\mathbb{E}_{\\bm{x}\\sim p}\\biggl{\\{}\\|\\nabla_{\\bm{x}}\\log p(\\bm{x}%\n)\\|_{2}^{2}+\\|\\nabla_{\\bm{x}}\\log q_{\\phi}(\\bm{x})\\|_{2}^{2}')
('3', '\\displaystyle-2\\langle\\nabla_{\\bm{x}}\\log p(\\bm{x}),\\nabla_{\\bm{x}}\\log q_{%\n\\phi}(\\bm{x})\\rangle\\biggl{\\}}.')
('3', '\\displaystyle-2\\langle\\nabla_{\\bm{x}}\\log p(\\bm{x}),\\nabla_{\\bm{x}}\\log q_{%\n\\phi}(\\bm{x})\\rangle\\biggl{\\}}.')
('3', '\\displaystyle\\mathcal{L}(\\phi)=\\mathbb{E}_{p}\\biggl{\\{}\\|\\nabla_{\\bm{x}}\\log q%\n_{\\phi}(\\bm{x})\\|_{2}^{2}+2\\Delta_{\\bm{x}}\\log q_{\\phi}(\\bm{x})\\biggl{\\}}.')
('3', '\\displaystyle\\mathcal{L}(\\phi)=\\mathbb{E}_{p}\\biggl{\\{}')
('3', '\\displaystyle\\|\\nabla_{\\bm{x}}\\log q_{\\phi}(\\bm{x})\\|_{2}^{2}+2\\Delta_{\\bm{x}}%\n\\log q_{\\phi}(\\bm{x})\\biggl{\\}}.')
('3', 'p')
('3', 'q_{\\phi}')
('3', '\\bm{s}_{\\phi}(\\bm{x})\\colon\\mathbb{R}^{D}\\to\\mathbb{R}^{D}')
('3', '\\Delta_{\\bm{x}}\\log q_{\\phi}(\\bm{x})')
('3', '\\bm{x}\\sim p')
('3', '\\bm{x}_{\\sigma}=\\bm{x}+\\sigma\\epsilon,~{}~{}\\epsilon\\sim\\mathcal{N}(\\bm{0},%\n\\mathcal{I})')
('3', '\\sigma')
('3', 'p_{\\sigma}')
('3', '\\bm{x}_{\\sigma}')
('3', 'p')
('3', '\\bm{x}_{0}')
('3', 'p(\\bm{x}_{\\sigma}|\\bm{x}_{0})')
('3', 'q_{\\phi}')
('3', '\\bm{s}_{\\phi}(.)')
('3', '\\displaystyle\\mathcal{L}_{DSM}(\\phi)=\\mathbb{E}_{\\bm{x}_{0}\\sim p,\\atop\\bm{x}_%\n{\\sigma}|\\bm{x}_{0}\\sim p(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bigg{\\{}\\|\\nabla_{\\bm{x%\n}_{\\sigma}}\\log q(\\bm{x}_{\\sigma})')
('3', '\\displaystyle\\mathcal{L}_{DSM}(\\phi)=')
('3', '\\displaystyle\\mathbb{E}_{\\bm{x}_{0}\\sim p,\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim p%\n(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bigg{\\{}\\|\\nabla_{\\bm{x}_{\\sigma}}\\log q(\\bm{x}_%\n{\\sigma})')
('3', '\\displaystyle-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\|_{2}%\n^{2}\\bigg{\\}}.')
('3', '\\displaystyle-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\|_{2}%\n^{2}\\bigg{\\}}.')
('4.1', 'g_{\\theta}(\\cdot)\\colon\\mathbb{R}^{D_{Z}}\\to\\mathbb{R}^{D_{X}}')
('4.1', 'p_{z}')
('4.1', 'p_{\\theta}')
('4.1', '\\bm{x}=g_{\\theta}(\\bm{z})')
('4.1', 'q(\\bm{x})')
('4.1', 'g_{\\theta}')
('4.1', 'p_{\\theta}(\\bm{x})')
('4.1', 'q(\\bm{x})')
('4.1', 'p_{\\theta}(\\bm{x})')
('4.1', 'q(\\bm{x})')
('4.1', '\\displaystyle\\bm{x}_{\\sigma}\\coloneqq\\bm{x}_{0}+\\sigma\\epsilon,~{}~{}\\bm{x}_{0%\n}=g_{\\theta}(\\bm{z}),~{}~{}\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I})')
('4.1', '\\displaystyle\\bm{x}_{\\sigma}\\coloneqq\\bm{x}_{0}+\\sigma\\epsilon,~{}~{}\\bm{x}_{0%\n}=g_{\\theta}(\\bm{z}),~{}~{}\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I})')
('4.1', 'p(\\bm{x}_{\\sigma}|\\bm{x}_{0})=\\mathcal{N}(\\bm{x}_{0},\\sigma^{2}\\mathcal{I})')
('4.1', '\\sigma')
('4.1', 'p_{\\theta,\\sigma}')
('4.1', '\\bm{x}_{\\sigma}')
('4.1', 'p_{\\theta}')
('4.1', '\\bm{x}_{0}')
('4.1', '\\bm{s}_{q}(\\bm{x}_{\\sigma})\\coloneqq\\nabla_{\\bm{x}_{\\sigma}}\\log q(\\bm{x}_{%\n\\sigma})')
('4.1', '\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\coloneqq\\nabla_{\\bm{x}_{\\sigma}}\\log p%\n_{\\theta,\\sigma}(\\bm{x}_{\\sigma})')
('4.1', 'p_{\\sigma,\\theta}(\\bm{x})')
('4.1', 'q(\\bm{x})')
('4.1', '\\displaystyle\\mathcal{D}_{FD}(\\theta)\\coloneqq\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p%\n_{\\theta,\\sigma}}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\|_{2}^{2}')
('4.1', '\\displaystyle\\mathcal{D}_{FD}(\\theta)\\coloneqq\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p%\n_{\\theta,\\sigma}}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\|_{2}^{2}')
('4.1', '\\bm{x}_{\\sigma}(\\theta)')
('4.1', '\\bm{x}_{\\sigma}')
('4.1', '\\bm{x}_{\\sigma}')
('4.1', '\\theta')
('4.1', '\\theta')
('4.1', '\\displaystyle\\frac{\\partial}{\\partial\\theta}\\mathcal{D}_{FD}(\\theta)=\\frac{%\n\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\|%\n\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}')
('4.1', '\\displaystyle\\frac{\\partial}{\\partial\\theta}\\mathcal{D}_{FD}(\\theta)=\\frac{%\n\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\|%\n\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}\\frac%\n{\\partial}{\\partial\\bm{x}_{\\sigma}}\\big{\\{}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s%\n}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\big{\\}}\\frac{\\partial\\bm{x}_{%\n\\sigma}(\\theta)}{\\partial\\theta}')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}\\frac%\n{\\partial}{\\partial\\bm{x}_{\\sigma}}\\big{\\{}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s%\n}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\big{\\}}\\frac{\\partial\\bm{x}_{%\n\\sigma}(\\theta)}{\\partial\\theta}')
('4.1', '\\displaystyle-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(%\n\\bm{x}_{\\sigma})\\bigg{\\}}')
('4.1', '\\displaystyle-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(%\n\\bm{x}_{\\sigma})\\bigg{\\}}')
('4.1', '\\displaystyle=\\operatorname{Grad}_{1}(\\theta)+\\operatorname{Grad}_{1}(\\theta).')
('4.1', '\\displaystyle=\\operatorname{Grad}_{1}(\\theta)+\\operatorname{Grad}_{1}(\\theta).')
('4.1', '\\operatorname{Grad}_{1}(\\theta)')
('4.1', '\\operatorname{Grad}_{2}(\\theta)')
('4.1', '\\displaystyle\\operatorname{Grad}_{1}(\\theta)=\\mathbb{E}_{p_{\\sigma,\\theta}}%\n\\bigg{\\{}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}\\big{\\{}\\|\\bm{s}_{q}(\\bm{x}_{%\n\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\big{\\}}\\frac{%\n\\partial\\bm{x}_{\\sigma}(\\theta)}{\\partial\\theta}\\bigg{\\}},')
('4.1', '\\displaystyle\\operatorname{Grad}_{1}(\\theta)=\\mathbb{E}_{p_{\\sigma,\\theta}}%\n\\bigg{\\{}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}\\big{\\{}\\|\\bm{s}_{q}(\\bm{x}_{%\n\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\big{\\}}\\frac{%\n\\partial\\bm{x}_{\\sigma}(\\theta)}{\\partial\\theta}\\bigg{\\}},')
('4.1', '\\displaystyle\\operatorname{Grad}_{2}(\\theta)=\\mathbb{E}_{p_{\\sigma,\\theta}}%\n\\bigg{\\{}-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\bigg{\\}}.')
('4.1', '\\displaystyle\\operatorname{Grad}_{2}(\\theta)=\\mathbb{E}_{p_{\\sigma,\\theta}}%\n\\bigg{\\{}-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\bigg{\\}}.')
('4.1', '\\theta')
('4.1', '\\operatorname{Grad}_{1}(\\theta)')
('4.1', '\\theta')
('4.1', '\\bm{s}_{\\theta,\\sigma}(.)')
('4.1', '\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(.)')
('4.1', '\\displaystyle\\mathcal{L}_{1}(\\theta)=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma%\n,\\theta}}\\bigg{\\{}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg}[%\n\\theta],\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\bigg{\\}}')
('4.1', '\\displaystyle\\mathcal{L}_{1}(\\theta)')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}\\|\\bm%\n{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{%\n\\sigma})\\|_{2}^{2}\\bigg{\\}}')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{z}\\sim p_{z},\\epsilon\\sim\\mathcal{N}(\\bm{0},%\n\\mathcal{I})\\atop\\bm{x}_{\\sigma}=g_{\\theta}(\\bm{z})+\\sigma\\epsilon}\\bigg{\\{}\\|%\n\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{%\n\\sigma})\\|_{2}^{2}\\bigg{\\}}')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{z}\\sim p_{z},\\epsilon\\sim\\mathcal{N}(\\bm{0},%\n\\mathcal{I})\\atop\\bm{x}_{\\sigma}=g_{\\theta}(\\bm{z})+\\sigma\\epsilon}\\bigg{\\{}\\|%\n\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{%\n\\sigma})\\|_{2}^{2}\\bigg{\\}}')
('4.1', '\\operatorname{Grad}_{2}(\\theta)')
('4.1', '\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(.)')
('4.1', '\\bm{s}_{\\theta,\\sigma}(.)')
('4.1', '\\theta')
('4.1', '\\operatorname{Grad}_{2}(\\theta)')
('4.1', 'p_{\\theta,\\sigma}')
('4.1', '\\bm{s}_{q}(.)')
('4.1', '\\theta')
('4.1', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}-2\\big%\n{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\big{]}^%\n{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\bigg%\n{\\}}')
('4.1', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}-2\\big%\n{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\big{]}^%\n{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\bigg%\n{\\}}')
('4.1', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{z}\\sim p_{Z},\\bm{%\nx}_{0}=g_{\\theta}(\\bm{z}),\\atop\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I}),\\bm%\n{x}_{\\sigma}=\\bm{x}_{0}+\\sigma\\epsilon}\\bigg{\\{}2\\big{[}\\bm{s}_{q}(\\bm{x}_{%\n\\sigma})-\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{]}^{T}')
('4.1', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{z}\\sim p_{Z},\\bm{%\nx}_{0}=g_{\\theta}(\\bm{z}),\\atop\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I}),\\bm%\n{x}_{\\sigma}=\\bm{x}_{0}+\\sigma\\epsilon}\\bigg{\\{}2\\big{[}\\bm{s}_{q}(\\bm{x}_{%\n\\sigma})-\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{]}^{T}')
('4.1', '\\displaystyle\\big{[}\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})%\n-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\big{]}\\bigg{\\}}')
('4.1', '\\displaystyle\\big{[}\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})%\n-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\big{]}\\bigg{\\}}')
('4.1', '\\operatorname{Grad}_{2}(\\theta)')
('4.1', '\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\cdot,\\cdot)')
('4.1', '\\operatorname{Grad}_{2}(\\theta)')
('4.1', '\\displaystyle\\mathcal{L}_{2}(\\theta)=\\mathbb{E}_{\\bm{z}\\sim p_{Z},\\bm{x}_{0}=g%\n_{\\theta}(\\bm{z}),\\atop\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I}),\\bm{x}_{%\n\\sigma}=\\bm{x}_{0}+\\sigma\\epsilon}\\bigg{\\{}2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})%\n-\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{]}^{T}')
('4.1', '\\displaystyle\\mathcal{L}_{2}(\\theta)')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{z}\\sim p_{Z},\\bm{x}_{0}=g_{\\theta}(\\bm{z}),\\atop%\n\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I}),\\bm{x}_{\\sigma}=\\bm{x}_{0}+\\sigma%\n\\epsilon}\\bigg{\\{}2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg%\n}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{]}^{T}')
('4.1', '\\displaystyle\\big{[}\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})%\n-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\big{]}\\bigg{\\}}')
('4.1', '\\displaystyle\\big{[}\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})%\n-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\big{]}\\bigg{\\}}')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{z}\\sim p_{Z},\\bm{x}_{0}=g_{\\theta}(\\bm{z}),\\atop%\n\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I}),\\bm{x}_{\\sigma}=\\bm{x}_{0}+\\sigma%\n\\epsilon}\\bigg{\\{}2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg%\n}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{]}^{T}')
('4.1', '\\displaystyle=\\mathbb{E}_{\\bm{z}\\sim p_{Z},\\bm{x}_{0}=g_{\\theta}(\\bm{z}),\\atop%\n\\epsilon\\sim\\mathcal{N}(\\bm{0},\\mathcal{I}),\\bm{x}_{\\sigma}=\\bm{x}_{0}+\\sigma%\n\\epsilon}\\bigg{\\{}2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\operatorname{sg%\n}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{]}^{T}')
('4.1', '\\displaystyle\\big{[}\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})%\n-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\big{]}\\bigg{\\}}')
('4.1', '\\displaystyle\\big{[}\\bm{s}_{\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})%\n-\\nabla_{\\bm{x}_{\\sigma}}\\log p(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\big{]}\\bigg{\\}}')
('4.1', '\\displaystyle\\mathcal{L}_{DFT}(\\theta)=\\mathcal{L}_{1}(\\theta)+\\mathcal{L}_{2}%\n(\\theta)')
('4.1', '\\displaystyle\\mathcal{L}_{DFT}(\\theta)=\\mathcal{L}_{1}(\\theta)+\\mathcal{L}_{2}%\n(\\theta)')
('4.1', '\\mathcal{L}_{1}(\\theta)')
('4.1', '\\mathcal{L}_{2}(\\theta)')
('4.1', '\\log q(\\bm{x})')
('4.1', 'p_{z}(\\bm{z})')
('4.1', 'g_{\\theta}(.)')
('4.1', '\\bm{s}_{\\phi}(.)')
('4.1', '(\\theta^{(0)},\\phi^{(0)})')
('4.1', 't')
('4.1', '\\theta')
('4.1', '\\phi')
('4.1', 'x_{i}=\\operatorname{sg}[g_{\\theta^{(t)}}(\\bm{z}_{i})],\\bm{z}_{i}\\sim p_{z}(\\bm%\n{z}),i=1,..,B')
('4.1', '\\phi')
('4.1', '\\theta')
('4.1', '\\phi')
('4.1', '\\theta')
('4.1', '\\theta')
('4.1', '\\bm{x}_{i}=g_{\\theta^{(t)}}(\\bm{z}_{i}),\\bm{z}_{i}\\sim p_{z}(\\bm{z}),i=1,..,B')
('4.1', '\\theta')
('4.1', '\\theta^{(t+1)}')
('4.1', '(\\theta,\\phi)')
('4.1', 'g_{\\theta}(\\cdot)')
('4.1', '\\bm{s}_{\\phi}(\\cdot)')
('4.1', '\\theta')
('4.1', 'g_{\\theta}')
('4.1', '\\bm{s}_{\\phi}')
('4.1', '\\phi')
('4.1', 'g_{\\theta}')
('5.1', '0.013\\pm 0.001')
('5.1', '0.044\\pm 0.006')
('5.1', '0.053\\pm 0.002')
('5.1', '0.057\\pm 0.004')
('5.1', '0.052\\pm 0.001')
('5.1', '0.024\\pm 0.002')
('5.1', '0.0367\\pm 0.016')
('5.1', '0.0545\\pm 0.006')
('5.1', '0.513\\pm 0.040')
('5.1', '0.0834\\pm 0.007')
('5.1', '0.0502\\pm 0.002')
('5.1', '0.0391\\pm 0.006')
('5.1', '0.776\\pm 0.069')
('5.1', '0.688\\pm 0.027')
('5.1', '1.498\\pm 0.078')
('5.1', '0.361\\pm 0.023')
('5.1', '0.189\\pm 0.023')
('5.1', '0.156\\pm 0.017')
('5.1', '1.681\\pm 0.073')
('5.1', '1.170\\pm 0.030')
('5.1', '2.673\\pm 0.163')
('5.1', '1.089\\pm 0.035')
('5.1', '0.612\\pm 0.072')
('5.1', '0.682\\pm 0.045')
('5.1', '0.107\\pm 0.025')
('5.1', '0.099\\pm 0.008')
('5.1', '0.152\\pm 0.030')
('5.1', '0.107\\pm 0.020')
('5.1', '0.116\\pm 0.029')
('5.1', '0.139\\pm 0.030')
('5.1', '0.141\\pm 0.024')
('5.1', '0.109\\pm 0.020')
('5.1', '0.284\\pm 0.037')
('5.1', '0.109\\pm 0.021')
('5.1', '0.144\\pm 0.017')
('5.1', '0.176\\pm 0.057')
('5.1', '0.277\\pm 0.042')
('5.1', '0.276\\pm 0.018')
('5.1', '0.691\\pm 0.030')
('5.1', '0.115\\pm 0.024')
('5.1', '0.231\\pm 0.029')
('5.1', '0.264\\pm 0.055')
('5.1', '0.669\\pm 0.073')
('5.1', '0.678\\pm 0.016')
('5.1', '1.198\\pm 0.038')
('5.1', '0.246\\pm 0.037')
('5.1', '0.387\\pm 0.033')
('5.1', '0.419\\pm 0.046')
('5.1', '0.094\\pm 0.020')
('5.1', '0.106\\pm 0.020')
('5.1', '0.134\\pm 0.034')
('5.1', '0.113\\pm 0.020')
('5.1', '0.135\\pm 0.010')
('5.1', '0.135\\pm 0.033')
('5.1', '0.109\\pm 0.025')
('5.1', '0.104\\pm 0.018')
('5.1', '0.137\\pm 0.023')
('5.1', '0.107\\pm 0.016')
('5.1', '0.132\\pm 0.028')
('5.1', '0.143\\pm 0.024')
('5.1', '0.114\\pm 0.031')
('5.1', '0.106\\pm 0.018')
('5.1', '0.205\\pm 0.031')
('5.1', '0.115\\pm 0.017')
('5.1', '0.129\\pm 0.029')
('5.1', '0.159\\pm 0.038')
('5.1', '0.199\\pm 0.038')
('5.1', '0.176\\pm 0.033')
('5.1', '0.501\\pm 0.032')
('5.1', '0.112\\pm 0.019')
('5.1', '0.176\\pm 0.033')
('5.1', '0.234\\pm 0.046')
('5.1', '0.102\\pm 0.028')
('5.1', '0.158\\pm 0.019')
('5.1', '0.150\\pm 0.026')
('5.1', '0.239\\pm 0.013')
('5.1', '0.269\\pm 0.019')
('5.1', '0.130\\pm 0.026')
('5.1', '0.206\\pm 0.043')
('5.1', '1.129\\pm 0.197')
('5.1', '1.531\\pm 0.058')
('5.1', '0.341\\pm 0.039')
('5.1', '0.396\\pm 0.221')
('5.1', '0.462\\pm 0.065')
('5.1', '0.091\\pm 0.013')
('5.1', '0.131\\pm 0.011')
('5.1', '0.121\\pm 0.022')
('5.1', '0.104\\pm 0.013')
('5.1', '0.129\\pm 0.020')
('5.1', '0.124\\pm 0.018')
('5.1', '0.095\\pm 0.016')
('5.1', '0.118\\pm 0.013')
('5.1', '0.157\\pm 0.030')
('5.1', '0.179\\pm 0.028')
('5.1', '7.837\\pm 1.614')
('5.1', '0.202\\pm 0.037')
('5.1', '0.099\\pm 0.015')
('5.1', '0.104\\pm 0.015')
('5.1', '0.123\\pm 0.021')
('5.1', '0.109\\pm 0.015')
('5.1', '0.115\\pm 0.012')
('5.1', '0.118\\pm 0.024')
('5.1', '0.098\\pm 0.019')
('5.1', '0.101\\pm 0.025')
('5.1', '0.121\\pm 0.016')
('5.1', '0.100\\pm 0.013')
('5.1', '0.081\\pm 0.009')
('5.1', '0.115\\pm 0.018')
('5.1', '\\operatorname{Grad}_{2}(\\theta)')
('5.1', '\\operatorname{Grad}_{2}(\\theta)')
('5.2', 'p(w|\\alpha)=\\mathcal{N}(w;~{}0,\\alpha^{-1})')
('5.2', '\\alpha')
('5.2', 'p(\\alpha)=\\text{Gamma}(\\alpha;~{}1,0.01)')
('5.2', '76.36\\%')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.2', '\\pm')
('5.3', '\\times')
('5.3', '\\times')
('5.3', '\\times')
('5.3', '\\times')
('5.3', '\\times')
('6', 'G')
('6', 'D')
('6', 'diffusion')
('6', 'energy\\_fun')
('6', 'max\\_iter')
('6', 'batch\\_size')
('6', 'D')
('6', 'G')
('6', 'anneal')
('6', 'val\\_interval')
('6', 'D\\_steps')
('6', 'distill\\_method')
('6', 'prefix')
('6', 'G')
('6', 'D')
('6', 'device\\leftarrow^{\\prime}cuda^{\\prime}')
('6', 'Doptim\\leftarrow Adam(D.parameters(),**D\\_opt\\_args)')
('6', 'Goptim\\leftarrow Adam(G.parameters(),**G\\_opt\\_args)')
('6', 'iiter\\in\\{0,1,\\ldots,max\\_iter\\}')
('6', 'distill\\_method==^{\\prime}dft-full^{\\prime}')
('6', 'D.train().requires\\_grad\\_(True)')
('6', 'G.eval().requires\\_grad\\_(False)')
('6', '\\_\\in\\{1,2,\\ldots,D\\_steps\\}')
('6', 'z\\leftarrow\\text{torch.randn}((batch\\_size,G.latent\\_dim,1,1)).cuda()')
('6', 'fake\\_x\\leftarrow G(z)')
('6', 't\\leftarrow\\text{random choice from }\\{1,2,\\ldots,diffusion.T\\}')
('6', 'fake\\_t,t,noise,sigma\\_t,g2\\_t\\leftarrow diffusion(fake\\_x,t=t,return\\_t=True)')
('6', 'wgt\\leftarrow g2\\_t/sigma\\_t.square()')
('6', 'd\\_loss\\leftarrow 0.5\\times wgt\\times(D(fake\\_t,t)+noise).square().sum([1,2,3])')
('6', 'd\\_loss\\leftarrow d\\_loss.mean()')
('6', 'Doptim.zero\\_grad()')
('6', 'd\\_loss.backward()')
('6', 'Doptim.step()')
('6', 'd\\_loss.item()')
('6', 'dlosses')
('6', 'D.eval().requires\\_grad\\_(False)')
('6', 'G.train().requires\\_grad\\_(True)')
('6', 'z\\leftarrow\\text{torch.randn}((batch\\_size,G.latent\\_dim,1,1)).to(device)')
('6', 'fake\\_x\\leftarrow G(z)')
('6', 't\\leftarrow\\text{random choice from }\\{7,8,\\ldots,50\\}')
('6', 'fake\\_t,t,noise,sigma\\_t,g2\\_t\\leftarrow diffusion(fake\\_x,t=t,return\\_t=True)')
('6', 'sigma\\_t\\leftarrow sigma\\_t.view(-1,1,1,1)')
('6', '{}_{f}ake\\_t\\leftarrow fake\\_t.clone().detach().requires\\_grad\\_(True)')
('6', 'lam\\leftarrow 1.0')
('6', 'score\\_true\\leftarrow\\text{torch.autograd.grad}(energy\\_fun(_{f}ake\\_t,lam=lam%\n).sum(),_{f}ake\\_t,create\\_graph=True,retain\\_graph=True)[0]/sigma\\_t')
('6', 'score\\_fake\\leftarrow D(_{f}ake\\_t,t)/sigma\\_t')
('6', 'score\\_diff\\leftarrow score\\_fake-score\\_true')
('6', 'cond\\_score\\leftarrow-noise/sigma\\_t')
('6', 'dloss\\_dx\\leftarrow-2\\times(score\\_diff\\times(score\\_fake-cond\\_score)).sum([1%\n,2,3])')
('6', 'dloss\\_dx\\leftarrow sigma\\_t**2\\times\\text{torch.autograd.grad}(dloss\\_dx.sum(%\n),_{f}ake\\_t,create\\_graph=False,retain\\_graph=False)[0]')
('6', 'g\\_loss\\leftarrow g2\\_t\\times(dloss\\_dx\\times fake\\_t).sum([1,2,3])')
('6', 'g\\_loss\\leftarrow g\\_loss.mean()')
('6', 'Goptim.zero\\_grad()')
('6', 'g\\_loss.backward()')
('6', 'Goptim.step()')
('6', 'g\\_loss.item()')
('6', 'glosses')
('6', 'iiter\\mod val\\_interval==0')
('A2.1', '\\displaystyle\\frac{\\partial}{\\partial\\theta}\\mathcal{D}_{FD}(\\theta)=\\frac{%\n\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\|%\n\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}')
('A2.1', '\\displaystyle\\frac{\\partial}{\\partial\\theta}\\mathcal{D}_{FD}(\\theta)')
('A2.1', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p%\n_{\\theta,\\sigma}}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\|_{2}^{2}')
('A2.1', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\epsilon\\sim\\mathcal{%\nN}(0,\\mathbf{I}),\\atop\\bm{z}\\sim p_{z}}\\|\\bm{s}_{q}(g_{\\theta}(\\bm{z})+\\sigma%\n\\epsilon)-\\bm{s}_{\\theta,\\sigma}(g_{\\theta}(\\bm{z})+\\sigma\\epsilon)\\|_{2}^{2}')
('A2.1', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\epsilon\\sim\\mathcal{%\nN}(0,\\mathbf{I}),\\atop\\bm{z}\\sim p_{z}}\\|\\bm{s}_{q}(g_{\\theta}(\\bm{z})+\\sigma%\n\\epsilon)-\\bm{s}_{\\theta,\\sigma}(g_{\\theta}(\\bm{z})+\\sigma\\epsilon)\\|_{2}^{2}')
('A2.1', '\\displaystyle=\\mathbb{E}_{\\epsilon\\sim\\mathcal{N}(0,\\mathbf{I}),\\atop\\bm{z}%\n\\sim p_{z}}\\bigg{\\{}\\frac{\\partial}{\\partial}\\big{\\{}\\|\\bm{s}_{q}(=g_{\\theta}(%\n\\bm{z})+\\sigma\\epsilon)-\\bm{s}_{\\theta,\\sigma}(=g_{\\theta}(\\bm{z})+\\sigma%\n\\epsilon)\\|_{2}^{2}\\big{\\}}\\frac{\\partial g_{\\theta}(\\bm{z})+\\sigma\\epsilon}{%\n\\partial\\theta}')
('A2.1', '\\displaystyle=\\mathbb{E}_{\\epsilon\\sim\\mathcal{N}(0,\\mathbf{I}),\\atop\\bm{z}%\n\\sim p_{z}}\\bigg{\\{}\\frac{\\partial}{\\partial}\\big{\\{}\\|\\bm{s}_{q}(=g_{\\theta}(%\n\\bm{z})+\\sigma\\epsilon)-\\bm{s}_{\\theta,\\sigma}(=g_{\\theta}(\\bm{z})+\\sigma%\n\\epsilon)\\|_{2}^{2}\\big{\\}}\\frac{\\partial g_{\\theta}(\\bm{z})+\\sigma\\epsilon}{%\n\\partial\\theta}')
('A2.1', '\\displaystyle-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(%\n\\bm{x}_{\\sigma})|_{\\bm{x}_{\\sigma}=g_{\\theta}(\\bm{z})+\\sigma\\epsilon}\\bigg{\\}}')
('A2.1', '\\displaystyle-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(%\n\\bm{x}_{\\sigma})|_{\\bm{x}_{\\sigma}=g_{\\theta}(\\bm{z})+\\sigma\\epsilon}\\bigg{\\}}')
('A2.1', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}\\frac%\n{\\partial}{\\partial}\\big{\\{}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,%\n\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\big{\\}}\\frac{\\partial(\\theta)}{\\partial%\n\\theta}-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\bigg{\\}}')
('A2.1', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bigg{\\{}\\frac%\n{\\partial}{\\partial}\\big{\\{}\\|\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,%\n\\sigma}(\\bm{x}_{\\sigma})\\|_{2}^{2}\\big{\\}}\\frac{\\partial(\\theta)}{\\partial%\n\\theta}-2\\big{[}\\bm{s}_{q}(\\bm{x}_{\\sigma})-\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{%\n\\sigma})\\big{]}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\theta,\\sigma}(\\bm{x%\n}_{\\sigma})\\bigg{\\}}')
('A2.1', '\\displaystyle=\\operatorname{Grad}_{1}(\\theta)+\\operatorname{Grad}_{1}(\\theta).')
('A2.1', '\\displaystyle=\\operatorname{Grad}_{1}(\\theta)+\\operatorname{Grad}_{1}(\\theta).')
('A2.2', '\\bm{u}(\\cdot)')
('A2.2', 'q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})=\\mathcal{N}(\\bm{x}_{\\sigma};\\bm{x}_{0},%\n\\sigma^{2}\\mathcal{I})')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta}\\atop\\bm{x}_{\\sigma}|\\bm{x%\n}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bm{u}(\\bm{x}_{\\sigma},\\theta%\n)^{T}\\bigg{\\{}\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})-\\nabla_{\\bm{x}_{t}}\\log q%\n_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\bigg{\\}}=0,~{}~{}~{}\\forall\\theta.')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta}\\atop\\bm{x}_{\\sigma}|\\bm{x%\n}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bm{u}(\\bm{x}_{\\sigma},\\theta%\n)^{T}\\bigg{\\{}\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})-\\nabla_{\\bm{x}_{t}}\\log q%\n_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\bigg{\\}}=0,~{}~{}~{}\\forall\\theta.')
('A2.2', 'p_{\\sigma,\\theta}')
('A2.2', '\\bm{s}_{\\theta,\\sigma}')
('A2.2', '\\displaystyle p_{\\sigma,\\theta}(\\bm{x}_{\\sigma})=\\int q_{\\sigma}(\\bm{x}_{%\n\\sigma}|\\bm{x}_{0})p_{\\theta,0}(\\bm{x}_{0})\\mathrm{d}\\bm{x}_{0}')
('A2.2', '\\displaystyle p_{\\sigma,\\theta}(\\bm{x}_{\\sigma})')
('A2.2', '\\displaystyle=\\int q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})p_{\\theta,0}(\\bm{x}_{%\n0})\\mathrm{d}\\bm{x}_{0}')
('A2.2', '\\displaystyle\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})=\\int\\nabla_{\\bm{x}_{%\n\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\frac{q_{\\sigma}(\\bm{x}_{%\n\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}_{0})}{p_{\\sigma,\\theta}(\\bm{x}_{\\sigma}%\n)}\\mathrm{d}\\bm{x}_{0}.')
('A2.2', '\\displaystyle\\bm{s}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})')
('A2.2', '\\displaystyle=\\int\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{%\nx}_{0})\\frac{q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}_{0})}{p%\n_{\\sigma,\\theta}(\\bm{x}_{\\sigma})}\\mathrm{d}\\bm{x}_{0}.')
('A2.2', '\\bm{u}')
('A2.2', '\\bm{u}(\\bm{x}_{\\sigma},\\theta)')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bm{u}^{T}\\bm{s%\n}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,%\n\\theta}}\\bm{u}^{T}\\int\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|%\n\\bm{x}_{0})\\frac{q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}_{0}%\n)}{p_{\\sigma,\\theta}(\\bm{x}_{\\sigma})}\\mathrm{d}\\bm{x}_{0}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bm{u}^{T}\\bm{s%\n}_{\\theta,\\sigma}(\\bm{x}_{\\sigma})')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\sigma,\\theta}}\\bm{u}^{T}\\int%\n\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\frac{q_{%\n\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}_{0})}{p_{\\sigma,\\theta}%\n(\\bm{x}_{\\sigma})}\\mathrm{d}\\bm{x}_{0}')
('A2.2', '\\displaystyle=\\int p_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bm{u}^{T}\\int\\nabla_{\\bm%\n{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\frac{q_{\\sigma}(\\bm{x%\n}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}_{0})}{p_{\\sigma,\\theta}(\\bm{x}_{%\n\\sigma})}\\mathrm{d}\\bm{x}_{0}\\mathrm{d}\\bm{x}_{\\sigma}')
('A2.2', '\\displaystyle=\\int p_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bm{u}^{T}\\int\\nabla_{\\bm%\n{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\frac{q_{\\sigma}(\\bm{x%\n}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}_{0})}{p_{\\sigma,\\theta}(\\bm{x}_{%\n\\sigma})}\\mathrm{d}\\bm{x}_{0}\\mathrm{d}\\bm{x}_{\\sigma}')
('A2.2', '\\displaystyle=\\int\\int\\bm{u}^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}%\n_{\\sigma}|\\bm{x}_{0})q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}%\n_{0})\\mathrm{d}\\bm{x}_{0}\\mathrm{d}\\bm{x}_{\\sigma}')
('A2.2', '\\displaystyle=\\int\\int\\bm{u}^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}%\n_{\\sigma}|\\bm{x}_{0})q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})p_{0,\\theta}(\\bm{x}%\n_{0})\\mathrm{d}\\bm{x}_{0}\\mathrm{d}\\bm{x}_{\\sigma}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bm{u}^{T}\\nabla_{\\bm{x}_{%\n\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bm{u}^{T}\\nabla_{\\bm{x}_{%\n\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})')
('A2.2', '\\theta')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\frac{%\n\\partial}{\\partial\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{%\n\\partial\\theta}\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}+\\mathbb{E}_{%\n\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}%\n\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{%\n\\sigma})\\bigg{\\}}\\frac{\\partial\\bm{x}_{\\sigma}}{\\partial\\theta}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\frac{%\n\\partial}{\\partial\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{%\n\\partial\\theta}\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}+\\mathbb{E}_{%\n\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}%\n\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{%\n\\sigma})\\bigg{\\}}\\frac{\\partial\\bm{x}_{\\sigma}}{\\partial\\theta}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\frac{\\partial}{\\partial%\n\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{%\n\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})+\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},%\n\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}%\n\\bigg{\\{}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}\\bigg{[}\\bm{u}(\\bm{x}_{\\sigma%\n},\\theta)^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0%\n})\\bigg{]}\\frac{\\partial\\bm{x}_{\\sigma}}{\\partial\\theta}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\frac{\\partial}{\\partial%\n\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{%\n\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})+\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},%\n\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}%\n\\bigg{\\{}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}\\bigg{[}\\bm{u}(\\bm{x}_{\\sigma%\n},\\theta)^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0%\n})\\bigg{]}\\frac{\\partial\\bm{x}_{\\sigma}}{\\partial\\theta}')
('A2.2', '\\displaystyle+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{\\partial\\bm{x}%\n_{0}}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\frac{%\n\\partial\\bm{x}_{0}}{\\partial\\theta}\\bigg{\\}}')
('A2.2', '\\displaystyle+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{\\partial\\bm{x}%\n_{0}}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\frac{%\n\\partial\\bm{x}_{0}}{\\partial\\theta}\\bigg{\\}}')
('A2.2', '\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\frac{\\partial}{%\n\\partial\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\bigg{\\}}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{%\n\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\frac{\\partial}{%\n\\partial\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\nabla_{\\bm{x}_{\\sigma}}\\log q%\n_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})')
('A2.2', '\\bm{u}(\\bm{x}_{\\sigma},\\theta)')
('A2.2', '\\frac{\\partial}{\\partial\\theta}\\bm{u}(\\bm{x}_{\\sigma},\\theta)')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\bm{u}%\n(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}+\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,%\n\\sigma}}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma%\n},\\theta)^{T}\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}\\frac{\\partial\\bm%\n{x}_{\\sigma}}{\\partial\\theta}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\bm{u}%\n(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}+\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,%\n\\sigma}}\\frac{\\partial}{\\partial\\bm{x}_{\\sigma}}\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma%\n},\\theta)^{T}\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}\\frac{\\partial\\bm%\n{x}_{\\sigma}}{\\partial\\theta}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bigg{\\{}\\frac{\\partial}{%\n\\partial\\bm{x}_{\\sigma}}\\bigg{[}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\nabla_{\\bm{%\nx}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\bigg{]}\\frac{\\partial%\n\\bm{x}_{\\sigma}}{\\partial\\theta}+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{%\n\\partial}{\\partial\\bm{x}_{0}}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{%\n\\sigma}|\\bm{x}_{0})\\frac{\\partial\\bm{x}_{0}}{\\partial\\theta}\\bigg{\\}}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bigg{\\{}\\frac{\\partial}{%\n\\partial\\bm{x}_{\\sigma}}\\bigg{[}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\nabla_{\\bm{%\nx}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})\\bigg{]}\\frac{\\partial%\n\\bm{x}_{\\sigma}}{\\partial\\theta}+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{%\n\\partial}{\\partial\\bm{x}_{0}}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{%\n\\sigma}|\\bm{x}_{0})\\frac{\\partial\\bm{x}_{0}}{\\partial\\theta}\\bigg{\\}}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\bm{u}%\n(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}\\bm{u}%\n(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bigg{\\{}\\frac{\\partial}{%\n\\partial\\bm{x}_{\\sigma}}\\bigg{[}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\big{\\{}%\n\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})-\\bm{s}_{%\n\\theta,\\sigma}(\\bm{x}_{\\sigma})\\big{\\}}\\bigg{]}\\frac{\\partial\\bm{x}_{\\sigma}}{%\n\\partial\\theta}+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial\\nabla_{\\bm{x}%\n_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}{\\partial\\bm{x}_{0}}%\n\\frac{\\partial\\bm{x}_{0}}{\\partial\\theta}\\bigg{\\}}')
('A2.2', '\\displaystyle=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},\\atop\\bm{x}_{\\sigma}|\\bm%\n{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}\\bigg{\\{}\\frac{\\partial}{%\n\\partial\\bm{x}_{\\sigma}}\\bigg{[}\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\big{\\{}%\n\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})-\\bm{s}_{%\n\\theta,\\sigma}(\\bm{x}_{\\sigma})\\big{\\}}\\bigg{]}\\frac{\\partial\\bm{x}_{\\sigma}}{%\n\\partial\\theta}+\\bm{u}(\\bm{x}_{\\sigma},\\theta)^{T}\\frac{\\partial\\nabla_{\\bm{x}%\n_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}{\\partial\\bm{x}_{0}}%\n\\frac{\\partial\\bm{x}_{0}}{\\partial\\theta}\\bigg{\\}}')
('A2.2', '\\displaystyle\\mathcal{L}_{2}(\\theta)=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},%\n\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}%\n\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma},\\operatorname{sg}[\\theta])^{T}\\big{\\{}\\nabla_{%\n\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})-\\bm{s}_{%\n\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{\\}}\\bigg{\\}}')
('A2.2', '\\displaystyle\\mathcal{L}_{2}(\\theta)=\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,\\theta},%\n\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})}%\n\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma},\\operatorname{sg}[\\theta])^{T}\\big{\\{}\\nabla_{%\n\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})-\\bm{s}_{%\n\\operatorname{sg}[\\theta],\\sigma}(\\bm{x}_{\\sigma})\\big{\\}}\\bigg{\\}}')
('A2.2', '\\bm{u}(\\bm{x}_{\\sigma},\\theta)=-2\\big{\\{}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{%\n\\sigma}(\\bm{x}_{\\sigma})-\\bm{s}_{\\sigma,\\theta}(\\bm{x}_{\\sigma})\\big{\\}}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}-2\\big%\n{\\{}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma})-\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})\\big{\\}}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{%\n\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}')
('A2.2', '\\displaystyle\\mathbb{E}_{\\bm{x}_{\\sigma}\\sim p_{\\theta,\\sigma}}\\bigg{\\{}-2\\big%\n{\\{}\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma})-\\bm{s}_{\\sigma,%\n\\theta}(\\bm{x}_{\\sigma})\\big{\\}}^{T}\\frac{\\partial}{\\partial\\theta}\\bm{s}_{%\n\\sigma,\\theta}(\\bm{x}_{\\sigma})\\bigg{\\}}')
('A2.2', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,%\n\\theta},\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_%\n{0})}\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma},\\operatorname{sg}[\\theta])^{T}\\big{\\{}%\n\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})-\\bm{s}_{%\n\\operatorname{sg}[\\theta]}(\\bm{x}_{\\sigma},t)\\big{\\}}\\bigg{\\}}')
('A2.2', '\\displaystyle=\\frac{\\partial}{\\partial\\theta}\\mathbb{E}_{\\bm{x}_{0}\\sim p_{0,%\n\\theta},\\atop\\bm{x}_{\\sigma}|\\bm{x}_{0}\\sim q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_%\n{0})}\\bigg{\\{}\\bm{u}(\\bm{x}_{\\sigma},\\operatorname{sg}[\\theta])^{T}\\big{\\{}%\n\\nabla_{\\bm{x}_{\\sigma}}\\log q_{\\sigma}(\\bm{x}_{\\sigma}|\\bm{x}_{0})-\\bm{s}_{%\n\\operatorname{sg}[\\theta]}(\\bm{x}_{\\sigma},t)\\big{\\}}\\bigg{\\}}')
('A3.2', 'p(w\\mid\\alpha)=\\mathcal{N}\\left(w;0,\\alpha^{-1}\\right)')
('A3.2', 'p(\\alpha)=\\operatorname{Gamma}(\\alpha;1,0.01)')
('A3.2', '0.0002')
('A3.2', '0.1/(t+1)^{0.55}')
('A3.2', '1e-07')
('A3.3', 'E_{d}(.)')
('A3.3', '\\sigma_{min}=0.3')
('A3.3', '\\sigma_{max}=3.0')
('A3.3', 'E_{\\sigma}(\\bm{x})=f(\\bm{x})/\\sigma')
('A3.3', 'S_{\\sigma}(\\bm{x})\\coloneqq S(\\bm{x})/\\sigma')
('A3.3', '\\sigma')
('A3.3', '[\\sigma_{min},\\sigma_{max}]')
('A3.3', '\\sigma^{2}')
('A3.3', '\\beta_{0}=0.9')
('A3.3', '\\beta_{1}=0.99')
('A3.3', '\\beta_{0}=0')
('A3.3', '\\beta_{1}=0.99')
