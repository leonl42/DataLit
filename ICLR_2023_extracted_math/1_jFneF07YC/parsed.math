('3', 'I = [I_1, ..., I_N] \\in [0, 1] ^{N \\times 3 \\times H \\times W}')
('3', 'N')
('3', 'K')
('3', 'P = [P_1, ..., P_N] \\in [0, 1]^{N \\times K \\times H \\times W}')
('3', 'K')
('3', 'I')
('3', '(H, W)')
('3', 'I')
('3', 'K')
('3', 'K')
('3', 'I_i \\in I')
('3', 'K')
('3', 'P_i')
('3.0', '\\Call{Encoder}{\\cdot}')
('3.0', 'L')
('3.0', 'l')
('3.0', 'A_l \\in [0, 1]^{(1 + hw) \\times (1 + hw)}')
('3.0', '\\begin{aligned}\n    A_l &= \\Call{Softmax}{\\frac{Q_l \\cdot K_l^ \\mathrm{ T }}{\\sqrt{d^\\prime}}}\n\\end{aligned}')
('3.0', 'Q_l,K_l \\in R^{(1 + hw) \\times d^{\\prime}}')
('3.0', 'x_l')
('3.0', 'd^{\\prime}')
('3.0', '(h, w)')
('3.0', '\\Call{Encoder}{\\cdot}')
('3.0', 'x^{cls}')
('3.0', 'x^{patch}')
('3.0', 'x^{patch}')
('3.0', 'x^{patch}')
('3.0', '\\begin{aligned}\n    \\Call{Mask}{x^\\prime, C} = \\frac{x^\\prime C^\\mathrm{T}}{\\sqrt{d}}\n    \\label{eq:segmenter}\n\\end{aligned}')
('3.0', 'x^\\prime')
('3.0', 'C \\in \\mathcal{R}^{K \\times d}')
('3.0', '\\Call{Mask}{x^\\prime, C} \\in R^{hw \\times K}')
('3.0', 'K')
('3.0', '(H, W)')
('3.0', 'P')
('3.0', '\\Call{Decoder}{\\cdot}')
('3.1', 'P')
('3.1', 'I')
('3.1', 'I_i')
('3.1', 'n_c')
('3.1', '\\beta \\times\\min(H, W)')
('3.1', '\\beta')
('3.1', 'I^c = [I^c_1, \\dots, I^c_N]')
('3.1', 'I^c_i')
('3.1', 'I_i')
('3.1', '(\\frac{\\min(H, W)}{2}, \\frac{\\min(H, W)}{2})')
('3.1', 'I^c')
('3.1', 'x^{c,\\textit{cls}} = [x_1^{c,\\textit{cls}}, \\dots, x_N^{c,\\textit{cls}}]')
('3.1', 'x^{c,\\textit{patch}} = [x_1^{c,\\textit{patch}}, \\dots, x_N^{c,\\textit{patch}}]')
('3.1', '\\begin{aligned}\n    (x^{c,\\textit{cls}}_i, x^{c,\\textit{patch}}_{i}) = \\Call{Encoder}{I_i^c}\n\\end{aligned}')
('3.1', 'x^{c,\\textit{cls}}')
('3.1', 'I')
('3.1', 'x^{c,\\textit{patch}}')
('3.1', 'K')
('3.1', 'S = [S_1, \\dots, S_K] \\in \\mathcal{R}^{K \\times d}')
('3.1', 'K')
('3.1', 'x^{c,\\textit{cls}} \\in \\mathcal{R}^{(N \\times n_c) \\times d}')
('3.1', '(N \\times n_c)')
('3.1', 'K')
('3.1', 'S_k \\in S')
('3.1', 'S')
('3.1', 'M = [M_1, \\dots, M_N]')
('3.1', 'M_i \\in [0, K]^{H \\times W}')
('3.1', 'x_i^{\\textit{cls}}')
('3.1', 'x_i^\\textit{patch}')
('3.1', 'I_i')
('3.1', '\\begin{aligned}\n    (x^{\\textit{cls}}_i, x^{\\textit{patch}}_{i}) = \\Call{Encoder}{I_i},\n\\end{aligned}')
('3.1', '\\textit{cls}')
('3.1', '\\textit{cls}')
('3.1', 'A_L^{\\textit{cls}} \\in [0, 1]^{h \\times w}')
('3.1', 'A_L^{\\textit{cls}}')
('3.1', 'S_k')
('3.1', 'x_i^{\\textit{cls}}')
('3.1', 'S_k \\in S')
('3.1', '\\begin{aligned}\n    \\min (1 - \\frac{x_i^{\\textit{cls}}S_k^\\mathrm{T}}{\\sqrt{d}}).\n\\end{aligned}')
('3.1', 'A_L^{\\textit{cls}}')
('3.1', 'A_L^{\\textit{cls}}')
('3.1', 'K')
('3.1', '[M_i^1, \\dots, M_i^K] \\in \\mathcal{R}^{K \\times h \\times w}')
('3.1', 'M_i')
('3.1', '\\mathop{\\mathrm{arg\\,max}}')
('3.1', '(h^{\\prime}, w^{\\prime})')
('3.1', 'K')
('3.1', 'h^{\\prime} \\in [0, h], w^{\\prime} \\in [0, w]')
('3.1', '(H, W)')
('3.1', '\\begin{aligned}\n    M_i &= \\Call{Upsample}{\\mathop{\\mathrm{arg\\,max}}_{(h^{\\prime}, w^{\\prime})} (M_i^1, \\dots, M_i^K)} , \\\\\n    M_{i}^{k} &= \\Call{Grad-CAM}{x_i^{\\textit{cls}}, S_k | A_L^{\\textit{cls}}} + A_L^{\\textit{cls}}.\n\\end{aligned}')
('3.1', 'M_i^{bg}')
('3.1', '\\begin{aligned}\n    M_i^{bg} = \\Call{Relu}{T^{\\textit{bg}} - \\max_{k \\in [0, K]}{M_i^k}}\n    \\label{eq:prob_bg}\n\\end{aligned}')
('3.1', 'T^{\\textit{bg}}')
('3.1', 'M_i^{\\textit{bg}}')
('3.1', 'M_i')
('3.1', 'P')
('3.1', '\\begin{aligned}\n    \\mathcal{L} = \\Call{CE}{P, M}.\n    \\label{eq:loss:ce}\n\\end{aligned}')
('3.2', 'K')
('3.2', '\\Call{Decoder}{\\cdot}')
('3.2', 'M')
('3.2', '\\hat{M} = [\\hat{M}_1, \\dots, \\hat{M}_N]')
('3.2', 'M')
('3.2', '\\hat{P} = [\\hat{P}_1, ..., \\hat{P}_N] \\in [0, 1]^{N \\times K \\times H \\times W}')
('3.2', '\\begin{aligned}\n    \\hat{P}_i &= \\Call{Teacher}{x_{i}^{\\textit{patch}}}, \\\\\n    \\hat{M}_i &= \\Call{Upsample}{\\mathop{\\mathrm{arg\\,max}}_{(h^{\\prime}, w^{\\prime})}(\\hat{M}_i^1, \\dots, \\hat{M}_i^K)} , \\\\\n    \\hat{M}_i^k &= 0.5 \\cdot (M_i^k + \\hat{P}_i^k), k \\in [1, \\dots, K].\n\\end{aligned}')
('3.2', '\\hat{P}_i^k \\in \\mathcal{R}^{h \\times w}')
('3.2', 'k')
('3.2', '\\hat{P}_i')
('3.2', '\\Call{CE}{P, \\hat{M}}')
('3.2', 'P')
('3.2', 'P_i = \\Call{Student}{x_{i}^{\\textit{patch}}}')
('3.2', '\\hat{P}')
('3.2', '\\hat{M}')
('3.2', '\\hat{M}')
('3.2', 'P')
('3.2', '\\hat{M}')
('3.2', '\\hat{M}^{\\prime}')
('3.2', 'P')
('3.2', '\\begin{aligned}\n    \\mathcal{L}_{peer} = \\Call{CE}{P, \\hat{M}} - \\alpha \\cdot \\Call{CE}{P, \\hat{M}^{\\prime}}.\n    \\label{eq:loss:peer}\n\\end{aligned}')
('3.2', '\\alpha')
('3.2', '\\hat{M}^{\\prime}')
('3.2', 'K')
('3.2', '\\hat{M}')
('3.2', 'P')
('3.2', '\\begin{aligned}\n    \\mathcal{L}_{unc} = 1 - \\frac{1}{hw} \\sum_{(h^{\\prime}, w^{\\prime})}(p^{\\prime} - p^{\\prime\\prime}).\n    \\label{eq:loss:unc}\n\\end{aligned}')
('3.2', 'p^{\\prime}, p^{\\prime\\prime}')
('3.2', 'K')
('3.2', '(h^{\\prime}, w^{\\prime})')
('3.2', 'K')
('3.2', '\\begin{aligned}\n    \\mathcal{L}_{div} = 1 + \\frac{1}{K^2}\\sum\\frac{C \\cdot C^T}{\\sqrt{d}}.\n    \\label{eq:loss:div}\n\\end{aligned}')
('3.2', 'C')
('3.2', '\\begin{aligned}\n    \\mathcal{L} = \\mathcal{L}_{peer} + \\omega_1 \\cdot \\mathcal{L}_{div} + \\omega_2 \\cdot \\mathcal{L}_{unc}.\n    \\label{eq:loss:all}\n\\end{aligned}')
('3.2', '\\omega_1, \\omega_2')
('4.1', '\\beta')
('4.1', '0.5, 0.4, 0.3, 0.2')
('4.1', '\\frac{1}{2} \\times \\beta \\times \\min(H, W)')
('4.1', '\\Bar{A}_L^{\\textit{cls}}')
('4.1', 'A_L^{\\textit{cls}}')
('4.1', 'A_L^{\\textit{cls}}')
('4.1', '50\\%')
('4.1', '\\Bar{A}_L^{\\textit{cls}}')
('4.1', '80\\%')
('4.1', '(1 - \\Bar{A}_L^{\\textit{cls}})')
('4.1', '8 \\times 8')
('4.1', '(\\frac{H}{2}, \\frac{W}{2})')
('4.1', '(\\frac{h}{2}, \\frac{w}{2})')
('4.2', '\\dag')
('4.2', '\\ddag')
('4.2', '\\dag')
('4.2', '\\dag')
('4.2', '\\dag')
('4.2', '\\dag')
('4.2', '\\ddag')
('4.2', '\\dag')
('4.2', '\\dag')
('4.2', '\\dag')
('4.3', 'd')
('4.3', 'K')
('6', '\\times')
('6', '\\alpha')
('6', '0.03')
('6', '0.1')
('6', 'T^{bg}')
('6', '\\omega 1, \\omega 2')
('6', '\\beta')
('6', 'K')
('6', 'K')
('6', 'K')
('6', 'K')
('6', '11.93')
('6', '9.43')
('6', '2.32')
('6', '11.93')
('6', '12.16')
('6', '11.93')
('6', '9.52')
