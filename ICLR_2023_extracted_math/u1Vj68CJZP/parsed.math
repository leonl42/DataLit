('0.0.1', '\\mathcal{M}=(\\mathcal{S}, \\mathcal{A}, P, \\gamma, \\{R_i, i \\}_{i=1}^N)')
('0.0.1', '\\mathcal{S}')
('0.0.1', '\\mathcal{A}')
('0.0.1', "P(\\mathbf{s}' | \\mathbf{s}, \\mathbf{a})")
('0.0.1', '\\gamma \\in [0, 1)')
('0.0.1', '1, \\cdots, N')
('0.0.1', 'R_1, \\cdots, R_N')
('0.0.1', 'i')
('0.0.1', 'R_i')
('0.0.1', 'P')
('0.0.1', '\\pi(\\mathbf{a}|\\mathbf{s}, i)')
('0.0.1', '\\{\\pi_1(\\mathbf{a}|\\mathbf{s}), \\cdots, \\pi_N(\\mathbf{a}|\\mathbf{s})\\}')
('0.0.1', '\\pi(\\mathbf{a}|\\mathbf{s}, i)')
('0.0.1', '\\pi^*(\\mathbf{a}|\\mathbf{s}, \\cdot) := \\arg \\max_{\\pi} \\mathbb{E}_{i \\sim [N]} \\mathbb{E}_{\\pi(\\cdot|\\cdot, i)}[\\sum_{t} \\gamma^t R_i(\\mathbf{s}_t, \\mathbf{a}_t)]')
('0.0.1', 'Q^\\pi(\\mathbf{s}, \\mathbf{a}, i)')
('0.0.1', '\\pi(\\cdot|\\cdot, i)')
('0.0.1', 'i')
('0.0.1', '\\mathbf{a}')
('0.0.1', '\\mathbf{s}')
('0.0.1', '\\pi')
('0.0.1', '\\pi(\\mathbf{a}|\\mathbf{s})')
('0.0.1', "\\mathcal{D} =  \\{(\\mathbf{s}_j, \\mathbf{a}_j, \\mathbf{s}'_j, r_j)\\}_{j=1}^N")
('0.0.1', '\\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('0.0.1', '\\mathcal{D}')
('0.0.1', '\\mathcal{D} = \\cup_{i=1}^N \\mathcal{D}_i')
('0.0.1', '\\mathcal{D}_i')
('0.0.1', 'i')
('0.0.1', 'i')
('0.0.1', '\\pi(\\cdot|\\cdot, i)')
('0.0.1', '\\mathcal{D}_{i}')
('0.0.1', 'j \\neq i')
('0.0.1', 'r_i')
('0.0.1', '\\pi(\\cdot|\\cdot, i)')
('0.0.1', 'r_i')
('0.0.1', '\\mathcal{D}_j')
('0.0.1', 'j')
('0.0.1', 'i')
('0.0.1', '\\mathcal{D}_{j \\rightarrow i}')
('0.0.1', 'i')
('0.0.1', 'i')
('0.0.1', '\\mathcal{D}^\\mathrm{eff}_i := \\mathcal{D}_i \\cup \\left( \\cup_{j \\neq i} \\mathcal{D}_{j \\rightarrow i} \\right)')
('0.0.1', '\\mathbf{a}\\sim \\pi(\\mathbf{a}|\\mathbf{s})')
('0.0.1', '\\label{eqn:generic_offline_rl}\n    \\pi^*(\\mathbf{a}|\\mathbf{s}) := \\arg \\max_{\\pi}~~ J_{\\mathcal{D}}(\\pi) - \\alpha D(\\pi, \\pi_\\beta).')
('0.0.1', 'J_{\\mathcal{D}}(\\pi)')
('0.0.1', '\\pi')
('0.0.1', 'D(\\pi, \\pi_\\beta)')
('0.0.1', 'D_{\\text{CQL}}')
('0.0.1', '\\pi')
('0.0.1', '\\pi_\\beta')
('0.0.1', 'i')
('0.0.1', '\\mathcal{D}^\\mathrm{eff}_i')
('0.0.1', '\\pi_\\beta^\\mathrm{eff}(\\mathbf{a}|\\mathbf{s}, i)')
('0.0.1', 'i')
('0.0.1', '\\pi_\\beta^\\mathrm{eff}(\\mathbf{a}|\\mathbf{s}, i) := |\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s}, \\mathbf{a})| / |\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('0.0.1', '\\label{eqn:generic_multitask_offline_rl}\n     \\forall i \\in [N], ~~\\pi^*(\\mathbf{a}|\\mathbf{s}, i) := \\arg \\max_{\\pi}~~ J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi) - \\alpha D(\\pi, \\pi^\\mathrm{eff}_\\beta).')
('0.0.2', '\\pi_\\mathrm{CQL}(\\mathbf{a}|\\mathbf{s}, i)')
('0.0.2', 'D(\\pi(\\cdot|\\cdot, i), \\pi^\\mathrm{eff}_\\beta(\\cdot|\\cdot, i))')
('0.0.2', '\\pi = \\pi_\\mathrm{CQL}(\\mathbf{a}|\\mathbf{s}, i)')
('0.0.2', 'D_\\text{KL}(\\pi, \\pi_\\beta)')
('0.0.2', 'i')
('0.0.2', 'j')
('0.0.2', '\\begin{aligned}\n\\label{eqn:spi}\n    J(\\pi^*) &\\geq J(\\pi_\\beta) - \\mathcal{O}(1/ (1 - \\gamma)^2) \\mathbb{E}_{\\mathbf{s}, \\mathbf{a}\\sim d^{\\pi}} \\left[\\sqrt{\\frac{D(\\pi(\\cdot|\\mathbf{s}), \\pi_\\beta(\\cdot|\\mathbf{s}))}{|\\mathcal{D}(\\mathbf{s})|}}\\right] + \\alpha/(1 - \\gamma) D(\\pi, \\pi_\\beta).\n\\end{aligned}')
('0.0.2', '\\mathcal{D} = \\mathcal{D}_i')
('0.0.2', '\\mathcal{D} = \\mathcal{D}^\\mathrm{eff}_i')
('0.0.2', '\\mathcal{D}_i')
('0.0.2', '\\pi^*')
('0.0.2', '\\mathcal{D}')
('0.0.2', 'D(\\pi(\\cdot|\\mathbf{s}), \\pi^\\beta(\\cdot|\\mathbf{s}))')
('0.0.2', '|\\mathcal{D}^\\mathrm{eff}(\\mathbf{s})|')
('0.0.2', '\\pi^\\mathrm{eff}_\\beta')
('0.0.2', '\\pi_\\beta')
('0.0.2', 'J(\\pi^\\mathrm{eff}_\\beta) < J(\\pi_\\beta)')
('0.0.3.0', "(\\mathbf{s}, \\mathbf{a}, r_j(\\mathbf{s}, \\mathbf{a}), \\mathbf{s}') \\in \\mathcal{D}_j")
('0.0.3.0', '\\mathcal{D}_j')
('0.0.3.0', 'i')
('0.0.3.0', "(\\mathbf{s}, \\mathbf{a}, r_i(\\mathbf{s}, \\mathbf{a}), \\mathbf{s}') \\in \\mathcal{D}^\\mathrm{eff}_i")
('0.0.3.0', '\\label{eqn:pessimistically_conservative}\n    \\text{\\textbf{CDS (basic)}:}~~~~~~~\\Delta^\\pi(\\mathbf{s}, \\mathbf{a}) := D(\\pi(\\cdot|\\cdot, i), \\pi_\\beta(\\cdot|\\cdot, i))(\\mathbf{s}) - D(\\pi(\\cdot|\\cdot, i), \\pi_\\beta^{\\text{eff}}(\\cdot|\\cdot, i))(\\mathbf{s}) \\geq 0.')
('0.0.3.0', 'D_\\mathrm{KL}(\\pi, \\pi_\\beta)')
('0.0.3.0', 'J_{\\mathcal{D}^\\text{eff}}(\\pi)')
('0.0.3.0', '|\\mathcal{D}^\\mathrm{eff}(\\mathbf{s})|')
('0.0.3.0', 'D(\\pi(\\cdot|\\mathbf{s}), \\pi_\\beta(\\cdot|\\mathbf{s})')
('0.0.3.1', '\\mathcal{D}^\\mathrm{eff}_i')
('0.0.3.1', '\\pi^\\mathrm{eff}_\\beta(\\mathbf{a}|\\mathbf{s}, i)')
('0.0.3.1', '\\pi^\\mathrm{eff}_\\beta')
('0.0.3.1', '\\pi')
('0.0.3.1', '\\pi^\\mathrm{eff}_\\beta')
('0.0.3.1', '\\begin{aligned}\n\\label{eqn:optimize_behavior}\n    \\arg \\max_{\\pi} \\textcolor{red}{\\max_{\\pi^\\mathrm{eff}_\\beta \\in \\Pi_{\\mathrm{relabel}}}}~~~ \\left[J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi) - \\alpha D(\\pi, \\pi^\\mathrm{eff}_\\beta; i)\\right],\n\\end{aligned}')
('0.0.3.1', '\\Pi_{\\mathrm{relabel}}')
('0.0.3.1', '\\pi^*(\\mathbf{a}|\\mathbf{s})')
('0.0.3.1', '\\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('0.0.3.1', '\\mathcal{D}_i')
('0.0.3.1', '\\geq 1 - \\delta')
('0.0.3.1', '\\pi^*')
('0.0.3.1', '\\zeta')
('0.0.3.1', '\\pi_\\beta')
('0.0.3.1', 'J(\\pi^*) \\geq J(\\pi_\\beta) - \\zeta')
('0.0.3.1', '\\zeta')
('0.0.3.1', '\\begin{aligned}\n\\small{\n    \\zeta = \\mathcal{O}\\left(\\frac{1}{(1 - \\gamma)^2}\\right)  \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}} \\right]\n    -  \\left[\\alpha D(\\pi^*, \\pi_\\beta^*) + \\underbrace{J(\\pi^*_\\beta) - J(\\pi_\\beta)}_{\\text{(a)}} \\right],}\n\\end{aligned}')
('0.0.3.1', '\\mathcal{D}^\\mathrm{eff}_i \\sim d^{\\pi_\\beta^*}(\\mathbf{s})')
('0.0.3.1', '\\pi^*_\\beta(\\mathbf{a}|\\mathbf{s})')
('0.0.3.1', '\\pi \\in \\Pi_{\\text{relabel}}')
('0.0.3.1', 'D_\\mathrm{CQL}(\\pi^*, \\pi_\\beta^*)')
('0.0.3.1', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('0.0.3.1', '(a)')
('0.0.3.1', '\\alpha')
('0.0.3.1', 'D_\\mathrm{CQL}(\\pi, \\pi_\\beta)')
('0.0.3.1', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('0.0.3.1', '\\pi^\\mathrm{eff}_\\beta(\\mathbf{a}|\\mathbf{s})')
('0.0.3.1', 'J_{\\mathcal{D}^\\mathrm{eff}}(\\pi)')
('0.0.3.1', 'D(\\pi, \\pi_\\beta)')
('0.0.3.1', "\\mathbb{E}_{\\mathbf{s}\\sim \\mathcal{D}^{\\mathrm{eff}}_i}[\\mathbb{E}_\\pi[Q(\\mathbf{s}, \\mathbf{a}, i)] - \\alpha' D(\\pi(\\cdot|\\mathbf{s},i), \\pi_\\beta^\\mathrm{eff}(\\cdot|\\mathbf{s},i))]")
('0.0.3.1', '\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a}, i)')
('0.0.3.1', 'i')
('0.0.3.1', '\\pi')
('0.0.3.1', '\\pi^\\mathrm{eff}_\\beta')
('0.0.3.1', '\\pi')
('0.0.3.1', '\\hat{Q}^\\pi')
('0.0.3.1', 'D(\\pi, \\pi^{\\mathrm{eff}}_\\beta; i)')
('0.0.3.1', '\\pi^{\\mathrm{eff}}_\\beta')
('0.0.3.1', '\\mathbb{E}_{\\mathbf{s}, \\mathbf{a}\\sim \\mathcal{D}^\\mathrm{eff}_i}[\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a}, i)] := \\mathbb{E}_{\\mathbf{s}, \\mathbf{a}\\sim \\mathcal{D}^\\mathrm{eff}_i}[Q(\\mathbf{s}, \\mathbf{a}, i)] - \\alpha D(\\pi, \\pi_\\beta^\\mathrm{eff}; i)')
('0.0.3.1', 'i')
('0.0.3.1', '\\mathcal{D}^\\mathrm{eff}_i')
('0.0.3.1', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi)')
('0.0.3.1', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('0.0.3.1', 'k^\\text{th}')
('0.0.3.1', '\\mathcal{D}_i')
('0.0.3.1', 'k')
('0.0.3.1', '(a) > 0')
('0.0.3.1', '|\\mathcal{D}^{\\mathrm{eff}}_i(\\mathbf{s})|')
('0.0.3.1', "(\\mathbf{s}, \\mathbf{a}, \\mathbf{s}') \\in \\mathcal{D}_j")
('0.0.3.1', "\\begin{aligned}\n   \\text{\\textbf{CDS}:~~~~~~~~} \\!\\!\\!\\!\\!\\!\\!\\!\\!(\\mathbf{s}, \\mathbf{a}, r_i, \\mathbf{s}') \\in \\mathcal{D}^{\\mathrm{eff}}_i  \\text{~if~} {\\Delta}^\\pi(\\mathbf{s}, \\mathbf{a})\\! := \\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a}, i) - P_{k\\%}\\!\\left\\{\\!\\hat{Q}^\\pi(\\mathbf{s}', \\mathbf{a}', i)\\!\\!: \\mathbf{s}', \\mathbf{a}' \\sim \\mathcal{D}_i\\!\\right\\} \\geq 0,\n\\label{eqn:method}\n\\end{aligned}")
('0.0.3.1', '\\hat{Q}^\\pi')
('0.0.3.1', '(\\mathbf{s}, \\mathbf{a})')
('0.0.3.1', "(\\mathbf{s}, \\mathbf{a}, r_{i}(\\mathbf{s}, \\mathbf{a}), \\mathbf{s}')")
('0.0.3.1', '\\mathcal{D}^\\mathrm{eff}_i')
('0.0.3.2', 'D')
('0.0.3.2', '\\Delta^\\pi(\\mathbf{s}, \\mathbf{a})')
('0.0.3.2', '\\Delta^\\pi(\\mathbf{s}, \\mathbf{a}) :=')
('0.0.3.2', "\\begin{aligned}\n    \\mathbb{E}_{\\mathbf{s}' \\sim \\mathcal{D}^i}\\left[\\mathbb{E}_{\\mathbf{a}' \\sim \\pi}[\\hat{Q}(\\mathbf{s}', \\mathbf{a}', i)] - \\mathbb{E}_{\\mathbf{a}'' \\sim \\mathcal{D}_i}[\\hat{Q}(\\mathbf{s}', \\mathbf{a}'', i)]\\right] - \\left(\\mathbb{E}_{\\mathbf{a}' \\sim \\pi}[\\hat{Q}(\\mathbf{s}, \\mathbf{a}', i)] - Q(\\mathbf{s}, \\mathbf{a}, i)\\right),\n\\label{eqn:p-cds}\n\\end{aligned}")
('0.0.3.2', '(\\mathbf{s}, \\mathbf{a})')
('0.0.3.2', 'i')
('0.0.3.2', '\\mathcal{D}_i')
('0.0.3.2', '\\pi(\\cdot|\\mathbf{s})')
('0.0.3.2', '\\pi_\\beta(\\cdot|\\mathbf{s})')
('0.0.3.2', '\\pi(\\mathbf{a}|\\mathbf{s}; i)')
('0.0.3.2', 'i')
('0.0.3.2', '\\pi(\\mathbf{a}|\\mathbf{s})')
('0.0.3.2', '\\mathcal{D}^\\mathrm{eff}_i')
('0.0.4', 'D_\\text{KL}(\\pi, \\pi_\\beta)')
('0.0.4', '{\\pi_\\beta}')
('0.0.4', 'D_\\text{KL}(\\pi, \\pi_\\beta)')
('0.0.4', 'D_\\text{KL}(\\pi, \\pi_\\beta)')
('0.0.4', '\\pi_\\beta')
('1.0.0', '\\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0', 'i')
('1.0.0', 'i')
('1.0.0', '\\pi_\\beta(\\mathbf{a}|\\mathbf{s}; i)')
('1.0.0', '\\mathcal{D}_i')
('1.0.0', '\\pi_\\beta')
('1.0.0', '\\mathcal{D} \\sim d^{\\pi_\\beta}(\\mathbf{s}) \\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0', 'd^{\\pi}_{\\mathcal{D}}')
('1.0.0', '\\mathcal{D}')
('1.0.0', '\\pi')
('1.0.0', 'D_\\text{CQL}(p, q)')
('1.0.0', 'p(\\mathbf{x})')
('1.0.0', 'q(\\mathbf{x})')
('1.0.0', '\\mathcal{X}')
('1.0.0', 'D_\\text{CQL}(p, q) := \\sum_{\\mathbf{x}\\in \\mathcal{X}} p(\\mathbf{x}) \\left(\\frac{p(\\mathbf{x})}{q(\\mathbf{x})} - 1 \\right).')
('1.0.0', 'D_\\text{CQL}')
('1.0.0', 'D')
('1.0.0', 'D_\\text{CQL}')
('1.0.0', '\\pi^*_{i}')
('1.0.0', 'J(\\pi^*_i) \\geq J(\\pi_\\beta) - \\zeta_i')
('1.0.0', '\\zeta_i')
('1.0.0', '\\label{eqn:single_task_guarantee}\n    \\zeta_i =  \\mathcal{O}\\left(\\frac{1}{(1 - \\gamma)^2}\\right) \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*_i}_{\\mathcal{D}_i}}\\left[\\sqrt{\\frac{D_{\\text{CQL}}(\\pi^*_i, \\pi_\\beta)(\\mathbf{s}) + 1}{|\\mathcal{D}_i(\\mathbf{s})|}} \\right] + \\alpha D(\\pi^*_i, \\pi_\\beta).')
('1.0.0', '\\pi^*_i')
('1.0.0', '\\mathcal{D}_i')
('1.0.0', '\\pi_\\beta')
('1.0.0', '\\mathbf{s}\\sim d^{\\pi^*_i}_{\\mathcal{D}_i}')
('1.0.0', 'J_\\mathcal{D}(\\pi)')
('1.0.0', '\\pi')
('1.0.0', '\\mathcal{D}')
('1.0.0', '\\label{eqn:eqn4_detailed}\n    \\pi^*(\\mathbf{a}|\\mathbf{s}), \\pi^*_\\beta(\\mathbf{a}|\\mathbf{s}) := \\arg \\max_{\\pi, \\pi_\\beta \\in \\Pi_{\\text{relabel}}}~~ \\underbrace{J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi) - \\alpha D(\\pi, \\pi_\\beta)}_{:= f(\\pi, \\pi_\\beta; \\mathcal{D}^\\mathrm{eff}_i)},')
('1.0.0', '\\pi^*_\\beta')
('1.0.0', '\\Pi_\\text{relabel}')
('1.0.0', '\\mathcal{D}^\\mathrm{eff}_i')
('1.0.0', '\\pi^*_\\beta')
('1.0.0', '\\mathcal{D}^\\mathrm{eff}_i \\sim d^{\\pi^*_\\beta}(\\mathbf{s}, \\mathbf{a})')
('1.0.0', 'f(\\pi_1, \\pi_2; \\mathcal{D}) := J_\\mathcal{D}(\\pi_1) - \\alpha D(\\pi_1, \\pi_2)')
('1.0.0', '\\pi_1')
('1.0.0', '\\pi_2')
('1.0.0', '\\mathcal{D}')
('1.0.0', '\\pi^*(\\mathbf{a}|\\mathbf{s})')
('1.0.0', '\\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0', '\\mathcal{D}_i')
('1.0.0', '\\geq 1 - \\delta')
('1.0.0', '\\pi^*')
('1.0.0', '\\zeta')
('1.0.0', '\\pi_\\beta')
('1.0.0', 'J(\\pi^*) \\geq J(\\pi_\\beta) - \\zeta')
('1.0.0', '\\zeta')
('1.0.0', '\\zeta = \\mathcal{O}\\left(\\frac{1}{(1 - \\gamma)^2}\\right) \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}} \\right] -  \\left[\\alpha D(\\pi^*, \\pi_\\beta^*) + \\underbrace{J(\\pi^*_\\beta) - J(\\pi_\\beta)}_{\\text{(a)}} \\right],')
('1.0.0', '\\mathcal{D}^\\mathrm{eff}_i \\sim d^{\\pi_\\beta^*}(\\mathbf{s})')
('1.0.0', '\\pi^*_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0', '\\pi \\in \\Pi_{\\text{relabel}}')
('1.0.0', '\\pi')
('1.0.0', '\\mathcal{D}^\\mathrm{eff}_i')
('1.0.0', '\\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0', '\\label{eqn:sampling_error}\n    J(\\pi) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i} (\\pi) - \\mathcal{O}\\left(\\frac{1}{(1 - \\gamma)^2}\\right) \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{D_{\\text{CQL}}(\\pi, \\pi^*_\\beta)(\\mathbf{s}) + 1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}} \\right],')
('1.0.0', '\\mathcal{O}(\\cdot)')
('1.0.0', '1 - \\delta')
('1.0.0', 'f(\\pi_1, \\pi_2; \\mathcal{D})')
('1.0.0', "\\begin{aligned}\n    &\\forall \\pi' \\in \\Pi_{\\text{relabel}}, ~~f(\\pi^*, \\pi^*_\\beta; \\mathcal{D}^\\mathrm{eff}_i) \\geq f(\\pi', \\pi', \\mathcal{D}^\\mathrm{eff}_i)\\\\\n    \\implies & \\forall \\pi' \\in \\Pi_{\\text{relabel}},~~ J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) - \\alpha D(\\pi^*, \\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi').\n    \\label{eqn:inequality_policy}\n\\end{aligned}")
('1.0.0', "\\begin{aligned}\n    &\\forall \\pi' \\in \\Pi_\\text{relabel}, ~~f(\\pi^*, \\pi^*_\\beta; \\mathcal{D}^\\mathrm{eff}_i) \\geq f(\\pi^*, \\pi'; \\mathcal{D}^\\mathrm{eff}_i),\\\\\n    \\implies &\\forall \\pi' \\in \\Pi_\\text{relabel},~~ D(\\pi^*, \\pi^*_\\beta) \\leq D(\\pi^*, \\pi').\n\\end{aligned}")
('1.0.0', '\\label{eqn:perf_increase}\n   J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) - J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta) \\geq \\alpha D(\\pi^*, \\pi^*_\\beta) + \\left( J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta^*) - J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta) \\right) \\approx \\alpha D(\\pi^*, \\pi^*_\\beta) + \\left(J(\\pi^*_\\beta) - J(\\pi_\\beta) \\right),')
('1.0.0', '\\approx')
('1.0.0', 'D_\\text{CQL}')
('1.0.0', '\\pi^*_\\beta')
('1.0.0', '\\pi_\\beta')
('1.0.0', '\\pi^*')
('1.0.0', '\\pi = \\pi^*')
('1.0.0', '\\pi^*')
('1.0.0', 'J(\\pi^*) - J(\\pi_\\beta) \\geq \\zeta')
('1.0.0', '\\zeta')
('1.0.0', '\\zeta = \\mathcal{O}\\left(\\frac{1}{(1 - \\gamma)^2}\\right) \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}} \\right] -  \\left[\\alpha D(\\pi^*, \\pi_\\beta^*) + \\underbrace{J(\\pi^*_\\beta) - J(\\pi_\\beta)}_{\\text{(a)}} \\right],')
('1.0.0', 'D_\\text{CQL}(\\pi^*, \\pi_\\beta^*)')
('1.0.0', 'D_\\text{CQL}(\\pi^*, \\pi_\\beta^*) \\leq D_\\text{CQL}(\\pi^*, \\pi_\\beta)')
('1.0.0', '\\pi^*_\\beta')
('1.0.0', '(a)')
('1.0.0', '\\pi^*')
('1.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*)')
('1.0.0', 'J(\\pi^*_\\beta)')
('1.0.0', '\\alpha')
('1.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta)')
('1.0.0', '(a) \\geq 0')
('1.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) - C \\frac{R_{\\max}}{1 - \\gamma} D_{\\mathrm{TV}}(\\pi^*, \\pi^*_\\beta)')
('1.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) - \\alpha D(\\pi^*, \\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta)')
('1.0.0', '\\alpha')
('1.0.0', '\\frac{C R_{\\max}}{1 - \\gamma } D_\\mathrm{TV}(\\pi^*, \\pi_\\beta^*) \\leq \\alpha D(\\pi^*, \\pi^*_\\beta),')
('1.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) - C \\frac{R_{\\max}}{1 - \\gamma} D_{\\mathrm{TV}}(\\pi^*, \\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) - \\alpha D(\\pi^*, \\pi^*_\\beta) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta),')
('1.0.0', '(a) \\geq 0')
('1.0.0', 'D_\\mathrm{TV}(\\pi^*, \\pi^*_\\beta) = 0')
('1.0.0', 'D_{\\text{CQL}}(\\pi^*, \\pi^*_\\beta) = 0')
('1.0.0', '\\pi^*(\\mathbf{a}|\\mathbf{s}) = \\pi^*_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*_\\beta) = J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi^*) \\geq J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi_\\beta)')
('1.0.0', '\\pi^*')
('1.0.0', '\\pi_\\beta')
('1.0.0', '(a)')
('1.0.0', '\\alpha')
('1.0.0', '\\pi^*')
('1.0.0', '\\pi^*_\\beta')
('1.0.0', 'D_\\text{CQL}(\\pi^*, \\pi^*_\\beta) \\leq \\varepsilon \\ll 1')
('1.0.0', '(\\$) := \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}} \\right] \\leq (1 + \\varepsilon)^{\\frac{1}{2}} \\underbrace{\\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}}~ \\right]}_{:= \\text{sampling error w/o distribution shift}}.')
('1.0.0', '\\begin{aligned}\n    (\\$) &= \\sum_{\\mathbf{s}} \\sqrt{d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}(\\mathbf{s}) (D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1)} \\sqrt{\\frac{d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}(\\mathbf{s})}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}}\\\\\n    &\\leq \\sqrt{\\left( \\sum_{\\mathbf{s}} d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}(\\mathbf{s}) (D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1) \\right) \\cdot \\left( \\sum_{\\mathbf{s}} \\frac{d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}(\\mathbf{s})}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|} \\right)}\\\\\n    &= \\sqrt{\\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s}) + 1\\right] \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[ \\frac{1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|} \\right]} \\leq (1 + \\varepsilon)^{0.5} \\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[\\sqrt{\\frac{1}{|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|}}~ \\right],\n\\end{aligned}')
('1.0.0', '\\mathbb{E}_{\\mathbf{s}\\sim d^{\\pi^*}_{\\mathcal{D}^\\mathrm{eff}_i}}\\left[D_{\\text{CQL}}(\\pi^*, \\pi_\\beta^*)(\\mathbf{s})\\right] = D_\\text{CQL}(\\pi^*, \\pi^*_\\beta) \\leq \\varepsilon')
('1.0.0', '\\sqrt{\\sum_i w_i \\frac{1}{x_i}} \\leq \\sum_i w_i \\frac{1}{\\sqrt{x_i}}')
('1.0.0', 'x_i, w_i > 0')
('1.0.0', '\\sum_i w_i = 1')
('1.0.0', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('1.0.0', 'D_\\text{CQL}(\\pi^*, \\pi^*_\\beta)')
('1.0.0.0', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('1.0.0.0', '\\pi^*_\\beta')
('1.0.0.0', 'J_{\\mathcal{D}^\\mathrm{eff}_i}(\\pi)')
('1.0.0.0', 'D_\\text{CQL}(\\pi, \\pi_\\beta)')
('1.0.0.0', '\\pi(\\mathbf{a}|\\mathbf{s})')
('1.0.0.0', '\\mathcal{D}^\\mathrm{eff}_i')
('1.0.0.0', 'd^{\\pi^*_\\beta}')
('1.0.0.0', '\\label{eqn:practical_eqn4}\n    \\text{(Practical Equation~\\ref{eqn:optimize_behavior})}~~~~ \\max_{\\pi} \\max_{\\pi_\\beta \\in \\Pi_\\text{relabel}}~~ \\mathbb{E}_{\\mathbf{s}\\sim \\mathcal{D}^{\\mathrm{eff}}_i}[\\mathbb{E}_{\\mathbf{a}\\sim \\pi(\\mathbf{a}|\\mathbf{s})}[Q(\\mathbf{s}, \\mathbf{a})] - \\alpha D(\\pi(\\cdot|\\mathbf{s}), \\pi_\\beta(\\cdot|\\mathbf{s}))]')
('1.0.0.0', '\\alpha')
('1.0.0.0', '\\alpha')
('1.0.0.0', 'D(\\pi^*, \\pi_\\beta^*)')
('1.0.0.0', 'd^{\\pi_\\beta^*}')
('1.0.0.0', 'd^{\\pi^*}')
('1.0.0.0', '\\pi')
('1.0.0.0', '\\pi_\\beta')
('1.0.0.0', '\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a}) = Q(\\mathbf{s}, \\mathbf{a}) - \\alpha \\left(\\frac{\\pi(\\mathbf{a}|\\mathbf{s})}{\\pi_\\beta(\\mathbf{a}|\\mathbf{s})} - 1 \\right)')
('1.0.0.0', '\\pi')
('1.0.0.0', '\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a})')
('1.0.0.0', '\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a})')
('1.0.0.0', '\\pi_\\beta \\in \\Pi_{\\text{relabel}}')
('1.0.0.0', "(\\mathbf{s}, \\mathbf{a}, r'_i, \\mathbf{s}') \\in \\mathcal{D}_{j \\rightarrow i}")
('1.0.0.0', '\\mathbb{E}_{\\mathbf{s}\\sim \\mathcal{D}^\\mathrm{eff}_i}\\left[\\mathbb{E}_{\\mathbf{a}\\sim \\pi_\\beta(\\cdot|\\mathbf{s})}\\left[\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a})\\right] \\right]')
('1.0.0.0', '\\mathbf{a}\\sim \\pi(\\mathbf{a}|\\mathbf{s})')
('1.0.0.0', '\\mathbf{a}\\sim \\pi_\\beta(\\mathbf{a}|\\mathbf{s})')
('1.0.0.0', '\\alpha')
('1.0.0.0', '\\pi')
('1.0.0.0', '\\pi_\\beta')
('1.0.0.0', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('1.0.0.0', '|\\mathcal{D}^\\mathrm{eff}_i(\\mathbf{s})|')
('1.0.0.0', '(\\mathbf{s}, \\mathbf{a}) \\in \\mathcal{D}_{j \\rightarrow i}')
('1.0.0.0', 'Q^\\pi(\\mathbf{s}, \\mathbf{a}; i) \\geq \\mathbb{E}_{\\mathbf{s}, \\mathbf{a}\\sim \\mathcal{D}_i}[\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a}; i)] \\geq 0')
('1.0.0.0', 'i')
('1.0.1.0', "\\begin{aligned}\n    \\hat{Q}^{k+1} \\leftarrow& \\arg\\min_{\\hat{Q}} \\mathbb{E}_{i\\sim[N]}\\left[\\beta\\left(\\mathbb{E}_{j \\sim[N]}\\left[\\mathbb{E}_{\\mathbf{s}\\sim \\mathcal{D}_j, \\mathbf{a}\\sim \\mu(\\cdot|\\mathbf{s},i)}\\left[w_{\\mathrm{CDS}}(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i)\\hat{Q}(\\mathbf{s},\\mathbf{a},i)\\right]\\right.\\right.\\right.\\\\\n    &\\left.\\left.\\left.- \\mathbb{E}_{\\mathbf{s}, \\mathbf{a}\\sim \\mathcal{D}_j}\\left[w_{\\mathrm{CDS}}(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i)\\hat{Q}(\\mathbf{s},\\mathbf{a}, i)\\right]\\right]\\right)\\right.\\\\\n    &\\left. + \\frac{1}{2}\\mathbb{E}_{j\\sim[N],(\\mathbf{s}, \\mathbf{a}, \\mathbf{s}') \\sim \\mathcal{D}_j}\\left[w_{\\mathrm{CDS}}(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i) \\left(\\hat{Q}(\\mathbf{s}, \\mathbf{a}, i) - \\widehat{\\mathcal{B}}^\\pi\\hat{Q}^k(\\mathbf{s}, \\mathbf{a}, i)\\right)^2 \\right]\\right],\n\\end{aligned}")
('1.0.1.0', "\\pi\\leftarrow \\arg \\max_{\\pi'} \\ \\mathbb{E}_{i \\sim [N]}\\left[\\mathbb{E}_{j\\sim[N],\\mathbf{s}\\sim \\mathcal{D}_j, \\mathbf{a}\\sim \\pi'(\\cdot | \\mathbf{s}, i)} \\left[ w_{\\mathrm{CDS}}(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i)\\hat{Q}^\\pi(\\mathbf{s}, \\mathbf{a}, i) \\right]\\right],")
('1.0.1.0', '\\beta')
('1.0.1.0', '\\mu')
('1.0.1.0', '\\widehat{\\mathcal{B}}')
('1.0.1.0', 'w_{\\mathrm{CDS}}(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i) := \\sigma \\left(\\frac{\\Delta(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i)}{\\tau} \\right)')
('1.0.1.0', '\\tau')
('1.0.1.0', '\\tau')
('1.0.1.0', '\\Delta(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i)')
('1.0.1.0', '0.995')
('1.0.1.0', '\\tau')
('1.0.1.0', '[10,\\infty]')
('1.0.1.0', '[5,\\infty]')
('1.0.1.0', '[10,25]')
('1.0.1.0', '[1, 50]')
('1.0.1.0', '[10, \\infty]')
('1.0.1.0', '128')
('1.0.1.0', 'i')
('1.0.1.0', '64')
('1.0.1.0', '\\mathcal{D}_i')
('1.0.1.0', '64')
('1.0.1.0', '\\cup_{j \\neq i} \\mathcal{D}_{j \\rightarrow i}')
('1.0.1.0', '\\Delta(\\mathbf{s}, \\mathbf{a}; j \\rightarrow i)')
('1.0.1.0', '\\mathcal{D}_i')
('1.0.1.0', 'i\\in[N]')
('1.0.1.0', '\\beta = 5.0')
('1.0.1.0', '\\beta = 1.0')
('1.0.1.0', '\\beta')
('1.0.1.0', '\\tau = 5.0')
('1.0.1.0', '1e-4')
('1.0.1.0', '3e-4')
('1.0.1.0', '0')
('1.0.1.0', '\\beta=1.0')
('1.0.1.0', '256')
('1.0.1.0', '472 \\times 472 \\times 3')
('1.0.1.0', '(g_\\text{status}, g_\\text{height})')
('1.0.1.1', 'r(s, a) = \\max\\{v_x, 3\\} - 0.1*\\|a\\|_2^2')
('1.0.1.1', 'r(s, a) = -\\max\\{v_x, 3\\} - 0.1*\\|a\\|_2^2')
('1.0.1.1', 'r(s, a) = - 0.1*\\|a\\|_2^2 + 15*(z - \\text{init z})')
('1.0.1.1', 'v_x')
('1.0.1.1', 'z')
('1.0.1.1', '\\text{init z}')
('1.0.1.1', 'r(s, a) = v_x - 0.001*\\|a\\|_2^2')
('1.0.1.1', 'r(s, a) = -v_x - 0.001*\\|a\\|_2^2')
('1.0.1.1', 'r(s, a) = - \\|v_x\\| - 0.001*\\|a\\|_2^2 + 10*(z - \\text{init z})')
('1.0.1.1', 'r(s, a) = v_x - 0.5*\\|a\\|_2^2 - 0.005*\\text{contact-cost}')
('1.0.1.1', 'r(s, a) = -v_x - 0.5*\\|a\\|_2^2 - 0.005*\\text{contact-cost}')
('1.0.1.1', 'r(s, a) = - \\|v_x\\| - 0.5*\\|a\\|_2^2 - 0.005*\\text{contact-cost} + 10*(z - \\text{init z})')
('1.0.2.0', 'D(\\pi, \\pi_\\beta)')
('1.0.2.0', 'r(\\mathbf{s}, \\mathbf{a})')
('1.0.2.0', '\\pi(a|s)')
('1.0.2.0', '\\pi^\\beta')
('1.0.2.0', '(s,a)')
('1.0.2.0', '\\hat{Q}(s, a) := Q(s,a) - \\alpha \\mathrm{D}_\\text{KL}(\\pi(a|s),\\pi^\\beta(a|s))')
('1.0.2.0', '\\pm')
('1.0.2.1', '\\rightarrow')
('1.0.2.1', '\\rightarrow')
('1.0.2.1', '\\rightarrow')
('1.0.2.1', '\\rightarrow')
('1.0.2.1', '\\rightarrow')
('1.0.2.1', '\\rightarrow')
('1.0.2.1', '(x, y)')
('1.0.2.1', '\\times')
('1.0.2.1', '(x, y)')
('1.0.2.2', '\\times')
