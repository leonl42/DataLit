('1', '1')
('2.0', 'M')
('2.0', '\\boldsymbol{x} \\in \\mathbb{R}^{F \\times N}')
('2.0', 'N')
('2.0', '\\boldsymbol{x}_{1}, \\dots, \\boldsymbol{x}_{N}')
('2.0', 'F')
('2.0', 'm \\in [M] = \\{1, \\dots, M\\}')
('2.0', '\\boldsymbol{w}_m \\in \\mathbb{R}^{F \\times \\mathcal{N}}')
('2.0', '\\boldsymbol{\\pi}_m \\in \\mathbb{R}^{1 \\times \\mathcal{L}}')
('2.0', '\\begin{aligned}\n    \\boldsymbol{x}=\\left(\\begin{array}{ccc}\n    \\mid & \\ldots & \\mid \\\\\n    \\boldsymbol{x}_1 & \\ldots & \\boldsymbol{x}_{N} \\\\\n    \\mid & \\ldots & \\mid\n    \\end{array}\\right),\\quad\\boldsymbol{w}_{m} = \\left(\\begin{array}{ccc}\n    \\mid & \\ldots & \\mid \\\\\n    \\boldsymbol{w}_{m,1} & \\ldots & \\boldsymbol{w}_{m,\\mathcal{N}} \\\\\n    \\mid & \\ldots & \\mid\n    \\end{array}\\right),\\quad\\boldsymbol{\\pi}_{m} = \\left(\n    \\pi_{m,1}, \\dots, \\pi_{m,\\mathcal{L}}\\right),\n\\end{aligned}')
('2.0', '1')
('2.0', '\\mathcal{N}')
('2.0', '1')
('2.0', '\\mathcal{L}')
('2.0', '\\mathcal{N}')
('2.0', '\\mathcal{L}')
('2.0.0', 'n \\in [\\mathcal{N}]  = \\{1, \\dots, \\mathcal{N}\\}')
('2.0.0', '\\ell \\swarrow n')
('2.0.0', 'n \\searrow \\ell')
('2.0.0', '\\ell \\in [\\mathcal{L}]  = \\{1, \\dots, \\mathcal{L}\\}')
('2.0.0', 'n')
('2.0.0', '\\mathds{1}_Q')
('2.0.0', 'Q')
('2.0.0', '\\mathds{1}_{Q} = 1')
('2.0.0', 'Q')
('2.0.0', '\\mathds{1}_{Q}=0')
('2.0.0', '\\ell \\in [\\mathcal{L}]')
('2.0.0', '\\mu_{m,\\ell} : \\mathbb{R}^{F} \\times \\mathbb{R}^{F \\times \\mathcal{N}} \\to [0,1]')
('2.0.0', '\\begin{aligned}\n    \\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_m)=\\prod_{n=1}^{\\mathcal{N}} {\\underbrace{\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)}_{\\text{\\upshape{flow to the left}}}}^{\\mathds{1}_{\\ell \\swarrow n}}{\\underbrace{(1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i))}_{\\text{\\upshape{flow to the right}}}} ^{\\mathds{1}_{n \\searrow \\ell}}, \\label{eq:mu}\n\\end{aligned}')
('2.0.0', '\\sigma: \\mathbb{R}\\to [0, 1]')
('2.0.0', '\\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_m)')
('2.0.0', '\\boldsymbol{x}_i')
('2.0.0', '\\ell')
('2.0.0', 'm')
('2.0.0', '\\boldsymbol{w}_m')
('2.0.0', '\\sigma')
('2.0.0', '0.0')
('2.0.0', '1.0')
('2.0.0', '\\operatorname{sigmoid}')
('2.0.0', '\\sigma(p) = \\frac{1}{2} \\operatorname{erf}(\\alpha p)+\\frac{1}{2} = \\frac{1}{2} (\\frac{2}{\\sqrt{\\pi}} \\int_{0}^{\\alpha p} e^{-t^{2}} \\mathrm{~d} t) + \\frac{1}{2}')
('2.0.0', '\\operatorname{sparsemax}')
('2.0.0', '\\sigma(p)=\\mathrm{sparsemax}([\\alpha p, 0])')
('2.0.0', '\\operatorname{entmax}')
('2.0.0', '\\sigma(p)=\\mathrm{entmax}([\\alpha p, 0])')
('2.0.0', '(0, 1/2)')
('2.0.0', '\\lim_{p\\to\\infty}\\sigma(p)=1')
('2.0.0', '\\lim_{p\\to-\\infty}\\sigma(p)=0')
('2.0.0', '\\sigma(0)=0.5')
('2.0.0', '\\operatorname{sigmoid}')
('2.0.0', '\\alpha \\in \\mathbb{R}^{+}')
('2.0.0', '\\operatorname{sigmoid}')
('2.0.0', '(1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i))')
('2.0.0', '0')
('2.0.0', '\\sum_{\\ell=1}^{\\mathcal{L}} \\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_{m})')
('2.0.0', '1')
('2.0.1', '\\boldsymbol{x}_i')
('2.0.1', 'm')
('2.0.1', '\\boldsymbol{w}_m')
('2.0.1', '\\boldsymbol{\\pi}_m')
('2.0.1', 'f_{m} : \\mathbb{R}^{F} \\times \\mathbb{R}^{F\\times\\mathcal{N}} \\times \\mathbb{R}^{1\\times\\mathcal{L}} \\to \\mathbb{R}')
('2.0.1', '\\begin{aligned}\n    f_m(\\boldsymbol{x}_i, \\boldsymbol{w}_m, \\boldsymbol{\\pi}_m)=\\sum_{\\ell=1}^{\\mathcal{L}} \\pi_{m,\\ell} \\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_m), \\label{eq:fm}\n\\end{aligned}')
('2.0.1', '\\pi_{m,\\ell}')
('2.0.1', '\\ell')
('2.0.1', 'm')
('2.0.1', '\\pi_{m,\\ell}')
('2.0.1', '\\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_m)')
('2.0.1', '\\boldsymbol{x}_i')
('2.0.1', '\\ell')
('2.0.1', '\\boldsymbol{w}_m')
('2.0.1', '\\boldsymbol{\\pi}_m')
('2.0.1', '\\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_m)')
('2.0.1', '1.0')
('2.0.1', '0.0')
('2.0.2', '\\begin{aligned}\n    f(\\boldsymbol{x}_i, \\boldsymbol{w}, \\boldsymbol{\\pi})=\\frac{1}{\\sqrt{M}} \\sum_{m=1}^{M} f_{m}(\\boldsymbol{x}_i, \\boldsymbol{w}_{m}, \\boldsymbol{\\pi}_{m}). \\label{eq:norm}\n\\end{aligned}')
('2.0.2', '1 / \\sqrt{M}')
('2.0.2', '\\boldsymbol{w}_{m,n}')
('2.0.2', '\\pi_{m,\\ell}')
('2.1', 'g')
('2.1', 'g')
('2.1', '\\tau')
('2.1', '\\widehat{\\boldsymbol{H}}_\\tau ^\\ast \\in \\mathbb{R}^{N\\times N}')
('2.1', '(i, j) \\in [N] \\times [N]')
('2.1', '\\begin{aligned}\n_{ij} \\coloneqq \\widehat{{\\Theta}}_\\tau ^\\ast (\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\coloneqq  \\left\\langle\\frac{\\partial g(\\boldsymbol{x}_i, \\boldsymbol{\\theta}_\\tau)}{\\partial \\boldsymbol{\\theta}_\\tau}, \\frac{\\partial g(\\boldsymbol{x}_j,\\boldsymbol{\\theta}_\\tau)}{\\partial \\boldsymbol{\\theta}_\\tau}\\right\\rangle\n    , \\label{eq:ntk}\n\\end{aligned}')
('2.1', '\\widehat{{\\Theta}}_\\tau ^\\ast: \\mathbb{R}^F \\times \\mathbb{R}^F \\to \\mathbb{R}')
('2.1', '\\langle\\cdot, \\cdot\\rangle')
('2.1', '\\boldsymbol{\\theta}_\\tau \\in \\mathbb{R}^P')
('2.1', 'P')
('2.1', '\\tau')
('2.1', '^\\ast{}')
('2.1', 'g:\\mathbb{R}^{F} \\times \\mathbb{R}^P \\to \\mathbb{R}')
('2.1', '\\sum_{m=1}^{M} \\sum_{n=1}^{\\mathcal{N}} \\left\\langle\\frac{\\partial f\\left(\\boldsymbol{x}_i, \\boldsymbol{w}, \\boldsymbol{\\pi}\\right)}{\\partial \\boldsymbol{w}_{m,n}}, \\frac{\\partial f\\left(\\boldsymbol{x}_j,\\boldsymbol{w}, \\boldsymbol{\\pi} \\right)}{\\partial \\boldsymbol{w}_{m,n}}\\right\\rangle + \\sum_{m=1}^{M} \\sum_{\\ell=1}^{\\mathcal{L}} \\left\\langle\\frac{\\partial f\\left(\\boldsymbol{x}_i, \\boldsymbol{w}, \\boldsymbol{\\pi}\\right)}{\\partial \\pi_{m,\\ell}}, \\frac{\\partial f\\left(\\boldsymbol{x}_j,\\boldsymbol{w}, \\boldsymbol{\\pi} \\right)}{\\partial \\pi_{m,\\ell}}\\right\\rangle')
('2.1', 'M\\to\\infty')
('2.1', '\\boldsymbol{u} \\in \\mathbb{R}^{F}')
('2.1', 'D')
('2.1', 'M\\to\\infty')
('2.1', '\\begin{aligned}\n    {\\Theta}^{(D, \\text{\\upshape{PB}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) &\\coloneqq \\lim_{M\\rightarrow\\infty} \\widehat{\\Theta}^{(D, \\text{\\upshape{PB}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\nonumber \\\\\n    &= \\underbrace{2^D D~\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j) (\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^{D-1}\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)}_{\\text{\\upshape contribution from internal nodes}} + \\underbrace{(2\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^D}_{\\text{\\upshape contribution from leaves}} , \\label{eq:tree_ntk}\n\\end{aligned}')
('2.1', '\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\coloneqq \\boldsymbol{x}_i^{\\top} \\boldsymbol{x}_j')
('2.1', '\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\coloneqq \\mathbb{E}[\\sigma(\\boldsymbol{u}^\\top \\boldsymbol{x}_i) \\sigma(\\boldsymbol{u}^\\top \\boldsymbol{x}_j)]')
('2.1', '\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\coloneqq \\mathbb{E}[\\dot{\\sigma}(\\boldsymbol{u}^\\top \\boldsymbol{x}_i) \\dot{\\sigma}(\\boldsymbol{u}^\\top \\boldsymbol{x}_j)]')
('2.1', '\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('2.1', '\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('2.1', '\\begin{aligned}\n    \\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) &= \\!\\frac{1}{2 \\pi} \\arcsin\\! \\left(\\!\\frac{\\alpha^2\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j)}{\\sqrt{(\\alpha^2\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_i)+0.5)(\\alpha^2\\Sigma(\\boldsymbol{x}_j, \\boldsymbol{x}_j)+0.5)}}\\right) \\!+\\! \\frac{1}{4}, \\label{eq:tau_sigmoid1} \\\\\n    \\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) &= \\!\\frac{\\alpha^2}{\\pi} \\frac{1}{\\sqrt{\\left(1+2\\alpha^2\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_i)\\right)(1+2\\alpha^2\\Sigma(\\boldsymbol{x}_j, \\boldsymbol{x}_j))\\!-\\!4\\alpha^4\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j)^{2}}}. \\label{eq:tau_sigmoid2}\n\\end{aligned}')
('2.1', '\\text{\\upshape{PB}}')
('2.1', '\\dot{\\sigma}(\\boldsymbol{u}^\\top \\boldsymbol{x}_i)')
('2.1', '\\mathbb{E}[\\cdot]')
('2.1', '\\pi')
('2.1', '\\boldsymbol{u}')
('2.1', '\\boldsymbol{w}_{m,n}')
('3.0', 'M\\to\\infty')
('3.0', 'M')
('3.0', 'D')
('3.0', 'M\\to\\infty')
('3.0', '\\begin{aligned}\n    {\\Theta}^{(D, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) &\\coloneqq \\lim_{M\\rightarrow\\infty} \\widehat{\\Theta}^{(D, \\text{\\upshape{Rule}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\nonumber \\\\\n    &= \\underbrace{D~\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j) (\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^{D-1}\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)}_{\\text{\\upshape contribution from internal nodes}} + \\underbrace{(\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^D}_{\\text{\\upshape contribution from leaves}} . \\label{eq:rule_ntk}\n\\end{aligned}')
('3.0', '2^D')
('3.0', '2^D {\\Theta}^{(D, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) = {\\Theta}^{(D, \\text{\\upshape{PB}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('3.0', '2^D')
('3.1', '\\mathcal{Q}: \\mathbb{N}\\to\\mathbb{N}\\cup\\{0\\}')
('3.1', 'M\\to\\infty')
('3.1', '\\begin{aligned}\n    \\Theta^{(\\text{\\upshape{ArbitraryTree}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\coloneqq \\lim_{M\\rightarrow\\infty} \\widehat{\\Theta}^{(\\text{\\upshape{ArbitraryTree}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j) = \\sum_{d=1}^{D} \\mathcal{Q}(d) ~\\Theta^{(d,\\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j).\n\\end{aligned}')
('3.1', '2^D {\\Theta}^{(D, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('3.1', '\\mathcal{Q}(D)=2^D')
('3.1', '0')
('3.1', '\\lambda_{\\text{\\upshape min}}')
('3.1', '\\lambda_{\\text{\\upshape max}}')
('3.1', '\\| \\boldsymbol{x}_i \\|_2 = 1')
('3.1', 'i \\in [N]')
('3.1', '\\boldsymbol{x}_i \\neq \\boldsymbol{x}_j~(i\\neq j)')
('3.1', '\\eta < 2/(\\lambda_{\\text{\\upshape min}} + \\lambda_{\\text{\\upshape max}})')
('3.1', '\\alpha')
('3.1', '\\begin{aligned}\n    \\sup\\left|{\\widehat{{\\Theta}}}_{\\tau}^{(\\text{\\upshape{ArbitraryTree}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) - \\widehat{{{\\Theta}}}_{0}^{(\\text{\\upshape{ArbitraryTree}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\right| = \\mathcal{O}\\left(\\frac{1}{\\sqrt{M}}\\right).\n\\end{aligned}')
('3.1', '\\mathcal{Q}(1)=0')
('3.1', '\\mathcal{Q}(2)=2')
('3.1', '\\mathcal{Q}(3)=4')
('3.1', '2{\\Theta}^{(2, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) + 4{\\Theta}^{(3, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('3.1', 'M = 16')
('3.1', 'M = 4096')
('3.1', '\\alpha=2.0')
('3.1', '0.1')
('3.1', '10')
('3.1', '10')
('3.1', 'F=5')
('3.1', 'M')
('4.0', '\\widehat{\\Theta}^{(5,\\text{\\upshape{PB}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('4.0', '\\widehat{\\Theta}^{(5,\\text{\\upshape{DL}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('4.0', '{\\Theta}^{(5,\\text{\\upshape{PB}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('4.0', '{\\Theta}^{(5,\\text{\\upshape{DL}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('4.0', 'M')
('4.0', '10')
('4.0', 'M\\to\\infty')
('4.0', 'D')
('4.0', 'M\\to\\infty')
('4.0', '\\begin{aligned}\n    \\Theta^{(D,\\text{\\upshape{DL}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)\n    \\coloneqq&\\lim_{M\\rightarrow\\infty} \\widehat{\\Theta}^{(D, \\text{\\upshape{DL}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\nonumber \\\\\n    =&\\ {\\Theta}^{(1, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) + {\\Theta}^{(2, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) +\\cdots+ 2{\\Theta}^{(D, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\nonumber \\\\\n    =&\\underbrace{\\Sigma\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) \\dot{\\mathcal{T}}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\left(\\sum_{d=1}^{D}\\left(d\\left(\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\right)^{d-1}\\right)+D\\left(\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\right)^{D-1}\\right)}_{\\text{\\upshape{contribution from internal nodes}}} \\nonumber \\\\\n    &\\qquad +\\underbrace{\\sum_{d=1}^{D}\\left((\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right))^d\\right) + (\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right))^D}_{\\text{\\upshape{contribution from leaves}}}. \\label{eq:asym_tntk}\n\\end{aligned}')
('4.0', '\\text{\\upshape{DL}}')
('4.0', 'M')
('4.0', '\\boldsymbol{x}_i = \\{1, 0\\}')
('4.0', '\\boldsymbol{x}_j = \\{\\cos(\\beta),\\sin(\\beta)\\}')
('4.0', '\\beta = [0, \\pi]')
('4.0', '10')
('4.0', 'M=16')
('4.0', '64')
('4.0', '256')
('4.0', '1024')
('4.0', '4096')
('4.1', '0 < \\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) < 0.5')
('4.1', 'D \\to \\infty')
('4.1', 'M\\to\\infty')
('4.1', '\\begin{aligned}\n    \\lim_{D\\to\\infty}\\Theta^{(D, \\text{\\upshape{DL}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)= \\underbrace{\\frac{\\Sigma\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) \\dot{\\mathcal{T}}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)}{\\left(1-\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\right)^2}}_{\\text{\\upshape{contribution from internal nodes}}} + \\underbrace{\\frac{\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)}{1-\\mathcal{T}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)}}_{\\text{\\upshape{contribution from leaves}}}.\n\\end{aligned}')
('4.1', '\\Theta^{(D, \\text{\\upshape{DL}})}')
('4.1', 'D \\to \\infty')
('4.1', '{\\Theta}^{(D,\\text{\\upshape{PB}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('4.1', '{\\Theta}^{(D,\\text{\\upshape{DL}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('4.1', '1.0')
('4.1', '90')
('4.1', '180')
('4.2', '90')
('4.2', '5000')
('4.2', 'D')
('4.2', '\\{2,4,8,16,32,64,128\\}')
('4.2', '\\alpha')
('4.2', '\\{1.0, 2.0, 4.0, 8.0, 16.0, 32.0\\}')
('4.2', '1.0\\times10^{-8}')
('4.2', '90')
('4.2', '10')
('4.2', '\\alpha')
('4.2', '\\alpha')
('4.2', 'U = \\sum_{d=1}^{D} \\mathds{1}_{\\mathcal{Q}(d)>0}')
('4.2', 'O(U)')
('4.2', 'O(1)')
('4.2', 'U = \\infty')
('7.0', 'M')
('7.0', 'D')
('7.0', 'M\\to\\infty')
('7.0', '\\begin{aligned}\n    {\\Theta}^{(D, \\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) &\\coloneqq \\lim_{M\\rightarrow\\infty} \\widehat{\\Theta}^{(D, \\text{\\upshape{Rule}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\nonumber \\\\\n    &= \\underbrace{D~\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j) (\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^{D-1}\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)}_{\\text{\\upshape contribution from internal nodes}} + \\underbrace{(\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^D}_{\\text{\\upshape contribution from leaves}} . \\nonumber \n\\end{aligned}')
('7.0', '\\Theta^{(D,\\text{\\upshape{Rule,nodes}})}')
('7.0', '\\Theta^{(D,\\text{\\upshape{Rule,leaves}})}')
('7.0', '\\begin{aligned}\n    \\Theta^{(D,\\text{\\upshape{Rule}})}\\left(\\boldsymbol{x}_i, \\boldsymbol{x}_j\\right) &= \\Theta^{(D,\\text{\\upshape{Rule,nodes}})}\\left(\\boldsymbol{x}_i, \\boldsymbol{x}_j\\right) + \\Theta^{(D,\\text{\\upshape{Rule,leaves}})}\\left(\\boldsymbol{x}_i, \\boldsymbol{x}_j\\right).\n\\end{aligned}')
('7.0', '\\begin{aligned}\n    \\frac{f^{(D,\\text{\\upshape{Rule}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{w}, \\boldsymbol{\\pi}\\right)}{\\partial \\boldsymbol{w}_{m,t}} = \\frac{1}{\\sqrt{M}}\\boldsymbol{x}_i \\dot{\\sigma}(\\boldsymbol{w}_{m,t}^\\top \\boldsymbol{x}_i) f_m^{(D-1,\\text{\\upshape{Rule}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{w}_{m, -t}, \\boldsymbol{\\pi}_m\\right),\n\\end{aligned}')
('7.0', 't')
('7.0', '\\boldsymbol{w}_{m,-t}')
('7.0', 't')
('7.0', 'D')
('7.0', 't')
('7.0', '\\begin{aligned}\n    \\Theta^{(D,\\text{\\upshape{Rule,nodes}})}\\left(\\boldsymbol{x}_i, \\boldsymbol{x}_j\\right) =D~\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j) (\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^{D-1}\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j), \\label{eq:a:nodes}\n\\end{aligned}')
('7.0', '\\begin{aligned}\n    &\\mathbb{E}_m\\left[f_m^{(D,\\text{\\upshape{Rule}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{w}_m, \\boldsymbol{\\pi}_m\\right)f_m^{(D,\\text{\\upshape{Rule}})}\\left(\\boldsymbol{x}_{j}, \\boldsymbol{w}_m, \\boldsymbol{\\pi}_m\\right)\\right] \\nonumber \\\\\n    =\\ &\\mathbb{E}_m \\left[\\underbrace{\\sigma(\\boldsymbol{w}_{m,1}^\\top \\boldsymbol{x}_i)\\sigma(\\boldsymbol{w}_{m,1}^\\top \\boldsymbol{x}_j)}_{\\rightarrow \\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)}\n    \\underbrace{\\sigma(\\boldsymbol{w}_{m,2}^\\top \\boldsymbol{x}_i)\\sigma(\\boldsymbol{w}_{m,2}^\\top \\boldsymbol{x}_j)}_{\\rightarrow \\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)}\n    \\cdots\n    \\underbrace{\\sigma(\\boldsymbol{w}_{m,D}^\\top \\boldsymbol{x}_i)\\sigma(\\boldsymbol{w}_{m,D}^\\top \\boldsymbol{x}_j)}_{\\rightarrow \\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)} \\underbrace{\\pi_{m,1}^2}_{\\rightarrow 1} \\right]\n    \\nonumber \\\\ \n    =\\ &(\\mathcal{T}(\\boldsymbol{x}_{i},\\boldsymbol{x}_{j}))^D\n\\end{aligned}')
('7.0', '\\rightarrow')
('7.0', '\\begin{aligned}\n    \\frac{f^{{(D,\\text{\\upshape{Rule}})}}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{w}, \\boldsymbol{\\pi}\\right)}{\\partial \\pi_{m,1}} = \\frac{1}{\\pi_{m,1} \\sqrt{M}} f_m ^{(D,\\text{\\upshape{Rule}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{w}_m, \\boldsymbol{\\pi}_m\\right),\n\\end{aligned}')
('7.0', '\\begin{aligned}\n    \\Theta^{(D,\\text{\\upshape{Rule,leaves}})}\\left(\\boldsymbol{x}_i, \\boldsymbol{x}_j\\right) = (\\mathcal{T}(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}))^D. \\label{eq:a:leaves}\n\\end{aligned}')
('7.1', '\\mathcal{Q}: \\mathbb{N}\\to\\mathbb{N}\\cup\\{0\\}')
('7.1', 'M\\to\\infty')
('7.1', '\\begin{aligned}\n    \\Theta^{(\\text{\\upshape{ArbitraryTree}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j) \\coloneqq \\lim_{M\\rightarrow\\infty} \\widehat{\\Theta}^{(\\text{\\upshape{ArbitraryTree}})}_0(\\boldsymbol{x}_i, \\boldsymbol{x}_j) = \\sum_{d=1}^{D} \\mathcal{Q}(d) ~\\Theta^{(d,\\text{\\upshape{Rule}})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j). \\nonumber\n\\end{aligned}')
('7.1', '\\begin{aligned}\n    \\mathbb{E}_m\\Bigl[(1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i))(1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j))\\Bigr] &= \\mathbb{E}_m \\Biggl[1- \\underbrace{\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)}_{\\rightarrow 0.5} - \\underbrace{\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j)}_{\\rightarrow 0.5} \\nonumber \\\\\n    &\\qquad\\qquad\\qquad\\qquad+ \\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j)\\Biggr] \\nonumber \\\\\n    &=\\mathbb{E}_m[\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j)],  \\label{eq:lr1} \\\\\n    \\mathbb{E}_m\\left[\\frac{\\partial (1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i))}{\\partial \\boldsymbol{w}_{m,n}}\\frac{\\partial (1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j))}{\\partial \\boldsymbol{w}_{m,n}}\\right] &= \\mathbb{E}_m \\left[\\boldsymbol{x}_i ^\\top \\boldsymbol{x}_j \\dot{\\sigma}(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)\\dot{\\sigma}(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j)\\right] \\nonumber \\\\\n    &=\\mathbb{E}_m\\left[\\frac{\\partial \\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)}{\\partial \\boldsymbol{w}_{m,n}}\\frac{\\partial \\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_j)}{\\partial \\boldsymbol{w}_{m,n}}\\right].  \\label{eq:lr2}    \n\\end{aligned}')
('7.1', '\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)')
('7.1', '0.5')
('7.1', '1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)')
('7.1', '\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)')
('7.1', '1-\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)')
('7.1', '\\sigma(\\boldsymbol{w}_{m,n}^\\top \\boldsymbol{x}_i)')
('7.1', '\\begin{aligned}\n    \\frac{\\partial f^{\\text{\\upshape{(ArbitraryTree)}}} (\\boldsymbol{x}_i, \\boldsymbol{w}, \\boldsymbol{\\pi})}{\\partial \\boldsymbol{w}_{m,n}} &=\n    \\frac{1}{\\sqrt{M}}\\sum_{\\ell=1}^{\\mathcal{L}} \\pi_{m, \\ell}\\frac{\\partial \\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_m)}{\\partial \\boldsymbol{w}_{m,n}} \\nonumber \\\\\n    &=\\frac{1}{\\sqrt{M}}\\sum_{\\ell=1}^{\\mathcal{L}} \\pi_{m, \\ell} S_{n,\\ell} (\\boldsymbol{x}_i, \\boldsymbol{w}_m)\\boldsymbol{x}_i \\dot{\\sigma}\\left(\\boldsymbol{w}_{m, n}^{\\top} \\boldsymbol{x}_{i}\\right),\n\\end{aligned}')
('7.1', '\\begin{aligned}\n    S_{n,\\ell} (\\boldsymbol{x}, \\boldsymbol{w}_m) \\coloneqq \\Biggl(\\prod_{n^\\prime =1}^{\\mathcal{N}} \\sigma\\left(\\boldsymbol{w}_{m, n^\\prime}^{\\top} \\boldsymbol{x}_{i}\\right)^{\\mathds{1}_{(\\ell \\swarrow n^\\prime)\\&(n \\neq n^\\prime)}}\\left(1-\\sigma\\left(\\boldsymbol{w}_{m, n^\\prime}^{\\top} \\boldsymbol{x}_{i}\\right)\\right)^{\\mathds{1}_{(n^\\prime \\searrow \\ell)\\&(n \\neq n^\\prime)}}\\Biggr)(-1)^{\\mathds{1}_{n \\searrow \\ell}},\n\\end{aligned}')
('7.1', '\\&')
('7.1', '\\pi_{m,\\ell}')
('7.1', "\\begin{aligned}\n\\mathbb{E}_m \\left[\\pi_{m,\\ell} \\pi_{m,\\ell'} \\right] = 0 ~~\\text{\\upshape{if}}~~\\ell \\neq \\ell'. \\label{eq:independence}\n\\end{aligned}")
('7.1', '\\begin{aligned}\n    &\\Theta^{\\text{\\upshape{(ArbitraryTree,nodes)}}}(\\boldsymbol{x}_i,\\boldsymbol{x}_j)\\nonumber \\\\\n    =\\ &\\mathbb{E}_m \\left[ \\sum_{\\ell=1}^{\\mathcal{L}} \\pi_{m, \\ell}^2 S_{n,\\ell} (\\boldsymbol{x}_i, \\boldsymbol{w}_m)S_{n,\\ell} (\\boldsymbol{x}_j, \\boldsymbol{w}_m)\\boldsymbol{x}_i^\\top \\boldsymbol{x}_j \\dot{\\sigma}\\left(\\boldsymbol{w}_{m, n}^{\\top} \\boldsymbol{x}_{i}\\right)\\dot{\\sigma}\\left(\\boldsymbol{w}_{m, n}^{\\top} \\boldsymbol{x}_{j}\\right)\\right] \\nonumber \\\\\n    =\\ &\\Sigma(\\boldsymbol{x}_i, \\boldsymbol{x}_j)\\dot{\\mathcal{T}}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)\\mathbb{E}_m \\left[\\sum_{\\ell=1}^{\\mathcal{L}} S_{n,\\ell} (\\boldsymbol{x}_i, \\boldsymbol{w}_m)S_{n,\\ell} (\\boldsymbol{x}_j, \\boldsymbol{w}_m)\\right]. \\label{eq:node}\n\\end{aligned}')
('7.1', '\\ell')
('7.1', 'd')
('7.1', '\\begin{aligned}\n    \\mathbb{E}_m \\left[S_{n,\\ell} (\\boldsymbol{x}_i, \\boldsymbol{w}_m)S_{n,\\ell} (\\boldsymbol{x}_j, \\boldsymbol{w}_m)\\right] = (\\mathcal{T}(\\boldsymbol{x}_i, \\boldsymbol{x}_j))^{d-1}. \\label{eq:s}\n\\end{aligned}')
('7.1', '\\begin{aligned}\n\\Theta^{\\text{\\upshape{(ArbitraryTree,nodes)}}}(\\boldsymbol{x}_i,\\boldsymbol{x}_j) = \\sum_{d=1}^{D}\\mathcal{Q}(d)\\Theta^{(d,\\text{\\upshape{Rule,nodes}})},\n\\end{aligned}')
('7.1', '\\Theta^{(d,\\text{\\upshape{Rule,nodes}})}')
('7.1', '\\begin{aligned}\n    \\frac{\\partial f^{\\text{\\upshape{(ArbitraryTree)}}}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{w}, \\boldsymbol{\\pi}\\right)}{\\partial \\pi_{m,\\ell}} = \\frac{1}{\\sqrt{M}}\\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_{m}).\n\\end{aligned}')
('7.1', '\\boldsymbol{w}_{m,n}')
('7.1', '\\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_{m})')
('7.1', '\\begin{aligned}\n    \\Theta^{\\text{\\upshape{(ArbitraryTree,leaves)}}}(\\boldsymbol{x}_i,\\boldsymbol{x}_j) &=\n    \\mathbb{E}_m\\left[\\sum_{\\ell=1}^{\\mathcal{L}} \\mu_{m,\\ell}(\\boldsymbol{x}_i, \\boldsymbol{w}_{m})\\mu_{m,\\ell}(\\boldsymbol{x}_j, \\boldsymbol{w}_{m})\\right] \\nonumber \\\\ &=\\sum_{d=1}^{D}\\mathcal{Q}(d)\\Theta^{(d,\\text{\\upshape{Rule,leaves}})},\n\\end{aligned}')
('7.1', '\\Theta^{(d,\\text{\\upshape{Rule,leaves}})}')
('7.2', '\\lambda_{\\text{\\upshape min}}')
('7.2', '\\lambda_{\\text{\\upshape max}}')
('7.2', '\\| \\boldsymbol{x}_i \\|_2 = 1')
('7.2', 'i \\in [N]')
('7.2', '\\boldsymbol{x}_i \\neq \\boldsymbol{x}_j~(i\\neq j)')
('7.2', '\\eta < 2/(\\lambda_{\\text{\\upshape min}} + \\lambda_{\\text{\\upshape max}})')
('7.2', '\\alpha')
('7.2', '\\begin{aligned}\n    \\sup\\left|{\\widehat{{\\Theta}}}_{\\tau}^{(\\text{\\upshape{ArbitraryTree}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) - \\widehat{{{\\Theta}}}_{0}^{(\\text{\\upshape{ArbitraryTree}})}\\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\right| = \\mathcal{O}\\left(\\frac{1}{\\sqrt{M}}\\right).\n\\end{aligned}')
('7.2', '\\boldsymbol{J}(\\boldsymbol{x}, \\boldsymbol{\\theta})')
('7.2', '(i,j)')
('7.2', '\\frac{\\partial f(\\boldsymbol{x}_i, \\boldsymbol{\\theta})}{\\partial {\\theta}_j}')
('7.2', '\\theta_j')
('7.2', 'j')
('7.2', '\\boldsymbol{\\theta}')
('7.2', '\\boldsymbol{x}')
('7.2', '\\lambda_{\\text{\\upshape min}}>0')
('7.2', '\\eta < 2(\\lambda_{\\text{\\upshape min}} + \\lambda_{\\text{\\upshape max}})')
('7.2', '\\begin{aligned}\n    \\sup\\left|{\\widehat{{\\Theta}}}_{\\tau} ^\\ast \\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right) - \\widehat{{{\\Theta}}}_{0} ^\\ast \\left(\\boldsymbol{x}_{i}, \\boldsymbol{x}_{j}\\right)\\right| = \\mathcal{O}\\left(\\frac{1}{\\sqrt{M}}\\right).\n\\end{aligned}')
('7.2', '\\alpha')
('7.2', 'K > 0')
('7.2', 'C>0')
('7.2', '\\begin{aligned}\n    \\left\\{\\begin{array}{rl}\n        \\|\\boldsymbol{J}(\\boldsymbol{x}, \\boldsymbol{\\theta})\\|_{F} & \\leq K \\\\\n        \\|\\boldsymbol{J}(\\boldsymbol{x}, \\boldsymbol{\\theta})-\\boldsymbol{J}(\\boldsymbol{x}, \\tilde{\\boldsymbol{\\theta}})\\|_{F} & \\leq K\\|\\boldsymbol{\\theta}-\\tilde{\\boldsymbol{\\theta}}\\|_{2}\n    \\end{array}, \\forall \\boldsymbol{\\theta}, \\tilde{\\boldsymbol{\\theta}} \\in B\\left(\\boldsymbol{\\theta}_{0}, C \\right)\\right.,\n\\end{aligned}')
('7.2', '\\begin{aligned}\n    B\\left(\\theta_{0}, C\\right):=\\left\\{\\boldsymbol{\\theta}:\\left\\|\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{0}\\right\\|_{2}<C\\right\\}.\n\\end{aligned}')
('7.2', '\\Theta^{(D, \\text{PB})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('7.2', '\\| \\boldsymbol{x}_i \\|_2 = 1')
('7.2', 'i \\in [N]')
('7.2', '\\boldsymbol{x}_i \\neq \\boldsymbol{x}_j~(i\\neq j)')
('7.2', '\\Theta^{(D, \\text{PB})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('7.2', '\\Theta^{(D, \\text{Rule})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('7.2', '\\Theta^{(D, \\text{Rule})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('7.2', '\\Theta^{(\\text{ArbitraryTree})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('7.2', '\\Theta^{(D, \\text{Rule})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('7.2', '\\Theta^{(\\text{ArbitraryTree})}(\\boldsymbol{x}_i, \\boldsymbol{x}_j)')
('8.0', '5000')
('8.0', '90')
('8.1', '1.0\\times10^{-8}')
('8.2', '252')
('8.3', 'D=4')
('8.3', 'D=128')
('8.3', '90')
('8.3', '\\alpha')
('8.3', 'D')
('8.3', '0.0012')
('8.3', '5')
('8.3', '2')
('9', '90')
('9', '\\alpha=4.0')
('9.0', 'f(\\boldsymbol{v}, \\boldsymbol{\\theta}_\\tau)=\\boldsymbol{H}(\\boldsymbol{v}, \\boldsymbol{x}) \\boldsymbol{H}(\\boldsymbol{x}, \\boldsymbol{x})^{-1}(\\boldsymbol{I}-\\exp [-\\eta \\boldsymbol{H}(\\boldsymbol{x}, \\boldsymbol{x}) \\tau]) \\boldsymbol{y}')
('9.0', '\\boldsymbol{v} \\in \\mathbb{R}^{F}')
('9.0', '\\boldsymbol{x} \\in \\mathbb{R}^{F \\times {N}}')
('9.0', '\\boldsymbol{y} \\in \\mathbb{R}^{N}')
('9.1', '\\texttt{max_depth}')
('9.1', '\\{2, 4, 6\\}')
('9.1', '\\texttt{subsample}')
('9.1', '\\{0.6, 0.8, 1.0\\}')
('9.1', '\\texttt{learning_rate}')
('9.1', '\\{0.1, 0.01, 0.001\\}')
('9.1', '\\texttt{n_estimators}')
('9.1', '\\{100, 300, 500\\}')
('9.1', '90')
('9.1', '\\{0, 1, 2, 3, 4\\}')
('9.1', '0.8010')
('9.1', '0.7889')
('9.1', '\\alpha=4.0')
('9.1', '35')
('9.1', '90')
