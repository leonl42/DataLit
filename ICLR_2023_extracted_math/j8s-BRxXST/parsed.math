('1', 'M')
('2', 'X=(x_1, x_2, \\dots, x_{|X|})')
('2', '|X|')
('2.0', 't')
('2.0', '\\begin{aligned}\n  % \\begin{split}\n  \\mathcal{L}_{CE}^t &= -\\log p(x_t| x_{<t}) \\label{eq:ce} \\\\\n    &= -\\log \\frac{\\exp(h_t^TW_{x_t})}{\\sum_{\\hat{x}_t \\in V}\\exp(h_t^TW_{\\hat{x}_t})} \\\\\n    % &=-\\log(\\frac{\\sum_{j\\not=i}^{|V|}\\exp(\\langle h_t, E_j \\rangle)}{\\exp(\\langle h_t, E_i \\rangle)} + \\frac{\\exp(\\langle h_t, E_i \\rangle)}{\\exp(\\langle h_t, E_i \\rangle)})\n    &=\\log\\left(1 + \\sum_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t}\\exp(h_t^TW_{\\hat{x}_t} - h_t^TW_{x_t})\\right), \\label{eq:cl}\n  % \\end{split}\n\\end{aligned}')
('2.0', 'h_t')
('2.0', 't')
('2.0', 'W')
('2.0', 'W_{x_t}')
('2.0', 'x_t')
('2.0', 'N')
('2.0', 'x_t')
('2.0', '\\hat{x}_t \\in V, \\hat{x}_t \\not = x_t')
('2.1', 't')
('2.1', '\\label{eq:ul}\n  \\mathcal{L}_{UL}^t = -\\sum_{x_t^- \\in C^t} \\log (1 - p(x_t^-| x_{<t})),\n    % &= -\\frac{1}{|X|}\\sum_{t=1}^{|X|}\\sum_{j \\in S_N^t}\\log (1 - \\frac{\\exp(\\langle h_t, E_i\\rangle)}{\\sum_j^{|V|}\\exp(\\langle h_t, E_j\\rangle)}) \\\\\n    % &= -\\frac{1}{|X|}\\sum_{t=1}^{|X|}\\sum_{j \\in S_N^t}\\log \\frac{\\sum_{j\\not=i}\\exp(\\langle h_t, E_j\\rangle)}{\\sum_j^{|V|}\\exp(\\langle h_t, E_j\\rangle)} \\\\')
('2.1', 'C^t=\\{x_1, \\dots, x_{t-1}\\} \\textbackslash \\{x_t\\}')
('2.1', 't')
('2.2', 'N')
('3.0', 't')
('3.0', '\\label{eq:ct}\n  \\mathcal{L}_{CT}^t = \\log\\left(1 + \\sum_{x_t^- \\in S_N^t}\\exp(h_t^TW_{x_t^-} - h_t^TW_{x_t})\\right),')
('3.0', 'S_N^t')
('3.0', 'x_t')
('3.0', 't')
('3.0', 'S_N^t')
('3.0', '\\mathcal{L}^t = \\mathcal{L}_{CE}^t + \\mathcal{L}_{CT}^t,\n  \\label{eq:loss}')
('3.0', '\\mathcal{L}_{CE}^t')
('3.0', '\\mathcal{L}_{CT}^t')
('3.1', 'S_N^t')
('3.1', 'M')
('3.1', 'M')
('3.1', 'S_N^t')
('3.1', '\\label{eq:neg_mine}\n  S_N^t = \\{x_{t-M}, \\dots, x_{t-1}\\} \\textbackslash \\{x_t\\}.')
('3.1', 'S_N^t')
('3.1', 'M')
('5', 'k')
('5', 'k=50')
('5', 'k')
('5', 'p=0.9')
('5', 'n')
('5', 'n')
('5', '1')
('5', '1')
('5', '\\texttt{rep-4} \\leq 0.05')
('6.0', '\\uparrow')
('6.0', '\\downarrow')
('6.0', '^\\ddag')
('6.0', '^\\dag')
('6.0', '\\downarrow')
('6.0', '\\downarrow')
('6.0', '\\downarrow')
('6.0', '\\downarrow')
('6.0', '\\downarrow')
('6.0', '\\downarrow')
('6.0', '\\uparrow')
('6.0', '\\uparrow')
('6.0', 'M=60')
('6.0', '\\geq 0.4')
('6.0', '\\geq 0.2')
('6.0', 'k')
('6.1', 'p < 0.05')
('6.1', 'k')
('6.1', 'k')
('7', 'M')
('9', 'X=(x_1, x_2, \\dots, x_{|X|})')
('9', 't')
('9', 'M')
('9', 'Z_t')
('9', 't')
('9', '\\mathcal{L}_{CT}^t')
('9', 'S_N^t~~~\\leftarrow SampleNegatives(X, M, t)')
('9', 'z_{x_t}~~~\\leftarrow GatherLogits(Z_t, x_t)')
('9', 'z_{S_N^t}~~\\leftarrow GatherLogits(Z_t, S_N^t)')
('9', '\\mathcal{L}_{CT}^t~\\leftarrow \\log\\left(1 + \\sum_{x_t^- \\in S_N^t}\\exp(z_{x_t^-} - z_{x_t})\\right)')
('9', '\\mathcal{L}_{CT}^t')
('9', '\\mathcal{L}_{CT}^t')
('10', '\\mathcal{L}_{NCE}^t = -\\log \\sigma(h_t^TW_{x_t}) - \\frac{1}{|S_N^t|}\\sum_{x_t^- \\in S_N^t}\\log \\sigma(-h_t^TW_{x_t^-}),\n  \\label{eq:nce}')
('10', '\\sigma(\\cdot)')
('11', 'z_{x_t} = h_t^TW_{x_t}')
('11', 'x_t')
('11', '\\partial\\mathcal{L}_*/\\partial z_*')
('11', '\\mathcal{L}_* \\in \\{L_{CE}, L_{UL}, L_{CT}\\}')
('11', 'z_* \\in \\{z_{x_t}, z_{\\hat{x}_t}, z_{x_t^-}\\}')
('11', 'p(*|x_{<t})')
('11', 'p_{*}')
('11', 'x_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{CE}}{\\partial z_{x_t}} &= -\\frac{\\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t} \\exp(z_{\\hat{x}_t} - z_{x_t})}{1 + \\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t}\\exp(z_{\\hat{x}_t} - z_{x_t})} \\\\\n    &= -\\frac{\\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t} \\exp(z_{\\hat{x}_t})}{\\exp(z_{x_t}) + \\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t} \\exp(z_{\\hat{x}_t})} \\\\\n    &= - \\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t} p_{\\hat{x}_t} \\\\\n    &= p_{x_t} - 1 \\\\\n    &\\leq 0, \\\\\n  \\end{split}')
('11', '\\hat{x}_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{CE}}{\\partial z_{\\hat{x}_t}} &= \\frac{\\exp(z_{\\hat{x}_t} - z_{x_t})}{1 + \\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t}\\exp(z_{\\hat{x}_t} - z_{x_t})} \\\\\n    &= \\frac{\\exp(z_{\\hat{x}_t})}{\\exp(z_{x_t}) + \\sum\\limits_{\\hat{x}_t \\in V, \\hat{x}_t \\not= x_t} \\exp(z_{\\hat{x}_t})} \\\\\n    &= p_{\\hat{x}_t} \\\\\n    &\\geq 0. \n  \\end{split}\n  \\label{eq:ce_non_label}')
('11', 'x_t^-')
('11', "\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{UL}}{\\partial z_{x_t^-}} &= -\\sum\\limits_{x_t^- \\in C^t} \\frac{\\partial \\log(1 - p_{x_t^-})}{\\partial p_{x_t^-}}\\frac{\\partial p_{x_t^-}}{\\partial z_{x_t^-}} \\\\\n    &= \\sum\\limits_{x_t^- \\in C^t} \\frac{1}{1 - p_{x_t^-}} \\frac{\\partial p_{x_t^-}}{\\partial z_{x_t^-}} \\\\\n    &= p_{x_t^-} - \\sum\\limits_{x_t^{-'} \\in C^t, x_t^{-'}\\not= x_t^-} \\frac{p_{x_t^-} p_{x_t^{-'}}}{1 - p_{x_t^{-'}}} \\\\\n    &= p_{x_t^-} (1 - \\sum\\limits_{x_t^{-'} \\in C^t, x_t^{-'}\\not= x_t^-}\\frac{p_{x_t^{-'}}}{1 - p_{x_t^{-'}}}) \\\\\n    &\\in (-\\infty, p_{x_t^-}], \\\\\n  \\end{split}\n  \\label{eq:ul_neg}")
('11', '\\hat{x}_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{UL}}{\\partial z_{\\hat{x}_t}} &= -\\sum\\limits_{x_t^- \\in C^t} \\frac{\\partial \\log(1 - p_{x_t^-})}{\\partial p_{x_t^-}}\\frac{\\partial p_{x_t^-}}{\\partial z_{\\hat{x}_t}} \\\\\n    &= \\sum\\limits_{x_t^- \\in C^t} \\frac{1}{1 - p_{x_t^-}} (-p_{x_t}p_{x_t^-}) \\\\\n    &= \\sum\\limits_{x_t^- \\in C^t} \\frac{p_{x_t}p_{x_t^-}}{p_{x_t^-} - 1} \\\\\n    &\\leq 0. \\\\\n  \\end{split}')
('11', 'x_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{CT}}{\\partial z_{x_t}} &= -\\frac{\\sum\\limits_{x_t^- \\in S_N^t}\\exp(z_{x_t^-} - z_{x_t})}{1 + \\sum\\limits_{x_t^- \\in S_N^t}\\exp(z_{x_t^-} - z_{x_t})} \\\\\n    &= -\\frac{\\sum\\limits_{x_t^- \\in S_N^t}p_{x_t^-}/p_{x_t}}{1 + \\sum\\limits_{x_t^- \\in S_N^t}p_{x_t^-} / p_{x_t}} \\\\\n    &\\leq 0,\n  \\end{split}')
('11', 'x_t^-')
('11', "\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{CT}}{\\partial z_{x_t^-}} &= \\frac{\\exp(z_{x_t^-} - z_{x_t})}{1 + \\sum\\limits_{x_t^{-'} \\in S_N^t}\\exp(z_{x_t^{-'}} - z_{x_t})} \\\\\n    &= \\frac{p_{x_t^-}/p_{x_t}}{1 + \\sum\\limits_{x_t^{-'} \\in S_N^t}p_{x_t^{-'}} / p_{x_t}} \\\\\n    &\\geq 0. \\\\\n  \\end{split}")
('11', '\\hat{x}_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{CT}}{\\partial z_{\\hat{x}_t}} &= 0. \\\\\n  \\end{split}')
('11', 'x_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{NCE}}{\\partial z_{x_t}} &= -\\sigma(z_{x_t})(1 - \\sigma(z_{x_t})) \\\\\n    &\\leq 0, \\\\\n  \\end{split}')
('11', 'x_t^-')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{NCE}}{\\partial z_{x_t^-}} &= \\sigma(-z_{x_t^-})(1 - \\sigma(-z_{x_t^-})) \\\\\n    &\\geq 0. \\\\\n  \\end{split}')
('11', '\\hat{x}_t')
('11', '\\begin{split}\n    \\frac{\\partial\\mathcal{L}_{NCE}}{\\partial z_{\\hat{x}_t}} &= 0.\n  \\end{split}')
('13.1', 'M')
('13.1', 'M=60')
('13.1', '1/4')
('13.1', 'M=1/8')
('13.1', 'M')
('16', '^\\ddag')
('16', '\\downarrow')
('16', '\\downarrow')
('16', '\\downarrow')
('16', '\\downarrow')
('16', '\\downarrow')
('16', '\\uparrow')
('16', '\\uparrow')
('16', '\\sim')
('16', 'M')
