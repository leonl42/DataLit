('1', 't')
('1', 'g_t')
('1', '\\tilde g_t = g_t + \\eta')
('1', '\\eta')
('1', '\\eta')
('1', '\\ell_2')
('1', 'g_t')
('1', 'g_t')
('1', '\\ell_2')
('1', '\\ell_2')
('1', 'L')
('1', 'L')
('1', '\\ell_2')
('1', 'L')
('1', 'm')
('1', '\\ell_2')
('1', 'L/m')
('1', '\\ell_2')
('1', '\\ell_2')
('1', 'c')
('1', 'g')
('1', 'c')
('1', '\\begin{aligned}\n\\label{eq: clip}\n   & \\text{clip}(g,c) = g \\cdot \\min\\left (1,\\frac{c}{\\|g\\|} \\right).\n\\end{aligned}')
('1', 'f(x) = \\frac{1}{3} \\sum_{i=1} ^3 \\frac{1}{2} (x-a_i)^2')
('1', 'x\\in \\mathbb{R}')
('1', 'a_1 = a_2 =  -3')
('1', 'a_3 = 9')
('1', '\\nabla f(x) = x-1')
('1', 'x^* = 1')
('1', 'c = 1')
('1', '1/3')
('1', 'x^*')
('1', 'f(x) = \\frac{1}{2} \\sum_{i=1} ^2 \\frac{1}{2} (x-a_i)^2')
('1', 'a_1 =  -3')
('1', 'a_2 = 3')
('1', 'f')
('1', 'x^* = 0')
('1', 'c = 1')
('1', 'x^*')
('1', 'x\\in [-2,2]')
('1', 'c')
('1.0', '\\mathbb{E}[\\langle \\nabla f(x_t), g_t\\rangle]')
('1.0', '\\nabla f(x)')
('1.0', 'g_t')
('1.0', '\\mathbb{E}[\\langle \\nabla f(x_t), g_t\\rangle]')
('1.0', '\\|\\nabla f(x_t)\\|')
('1.1', '\\ell_\\infty')
('1.1', '\\ell_2')
('2', '\\begin{aligned}\n    \\min_{x} f(x) \\triangleq \\mathbb E_{s \\sim D} [f(x,s)]\n\\end{aligned}')
('2', 'D')
('2', 's')
('2', 'D')
('2', 'x_t')
('2', '\\nabla f(x_t) + \\xi_t')
('2', '\\xi_t')
('2', 'f(x)')
('2', '\\|\\nabla f(x) - \\nabla f(y)\\|\\leq G \\|x - y\\|, \\forall x,y')
('2', 't')
('2', '\\begin{aligned}\n\\label{eq:clipping} \nx_{t+1} = x_t - \\alpha \\text{clip}({\\nabla f(x_t) + \\xi_t},c): = x_t - \\alpha g_t.\n\\end{aligned}')
('2', 'g_t =  \\text{clip}({\\nabla f(x_t) + \\xi_t},c)')
('2', '\\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle]')
('2', '\\|\\nabla f(x_t)\\|^2')
('2', 'c\\|\\nabla f(x_t)\\|')
('2', 'G')
('2', '\\nabla f')
('2', '\\|\\nabla f(x) - \\nabla f(y)\\|\\leq G \\|x - y\\|, \\forall x,y')
('2', 'c')
('2', '\\alpha = \\frac{1}{\\sqrt{T}}')
('2', '\\begin{aligned}\n    \\frac{1}{T} \\sum_{t=1}^T \\mathbb E \\left[ \\langle \\nabla f(x_t), g_t \\rangle\\right] \\leq \\frac{D_f}{\\sqrt{T} } + \\frac{G}{2\\sqrt{T}} c^2\n\\end{aligned}')
('2', 'D_f = f(x_1) - \\min_{x}f(x)')
('2', '\\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle ] =\\|\\nabla f(x_t)\\|^2')
('2', '\\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle ]')
('2', '\\|\\nabla f(x_t)\\|')
('2.0', 'p_t(\\xi_t)')
('2.0', '\\xi_t')
('2.0', '\\tilde{p}_t(\\xi_t)')
('2.0', '\\begin{aligned}\n\\label{eq: split_bias}\n    \\mathbb E_{\\xi_t \\sim p}[\\langle \\nabla f(x_t), g_t \\rangle ] \n    =& \\mathbb E_{\\xi_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle] + \\underbrace{\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (p_t(\\xi_t)-\\tilde{p_t}( \\xi_t)) d\\xi_t }_{b_t}\n\\end{aligned}')
('2.0', '\\xi_t \\sim p')
('2.0', '\\tilde{p}(\\xi_t)')
('2.0', '\\mathbb E_{\\xi_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle]')
('2.0', '\\|\\nabla f(x_t)\\|^2')
('2.0', 'p')
('2.0', '\\tilde p_t')
('2.0', '\\tilde{p}')
('2.0', '\\mathbb E_{\\xi_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle]')
('2.0', '\\langle \\nabla f(x_t),g_t \\rangle \\geq \\Omega(\\|\\nabla f(x_t)\\|_2^2),\\ \\forall g_t')
('2.0', '\\xi')
('2.0', '\\cos (\\nabla f(x_t), \\nabla f(x_t) + \\xi_t')
('2.0', '\\tilde p(\\xi_t) = \\tilde p(-\\xi_t)')
('2.0', 'c')
('2.0', '\\begin{aligned}\n\\textrm{1. If } \\|\\nabla f(x_t)\\| \\leq \\frac{3}{4}c,&\\quad \\text{ then }\\quad\n\\mathbb E_{\\xi_t \\sim \\tilde{p}}[\\langle \\nabla f(x_t), g_t \\rangle ]  \\geq \\| \\nabla f(x_t)\\|^2  \\mathbb P_{\\xi_t \\sim \\tilde p}\\left(\\|\\xi_t\\|<\\frac{c}{4}\\right)\\\\\n\\textrm{2. If } \\|\\nabla f(x_t)\\| > \\frac{3}{4}c,&\\quad \\text{ then } \\quad \\mathbb E_{\\xi_t \\sim \\tilde{p}}[\\langle \\nabla f(x_t), g_t \\rangle ]  \\geq \\frac{3}{4}  c \\| \\nabla f(x_t)\\|  \\mathbb P_{\\xi_t \\sim \\tilde p}\\left(\\|\\xi_t\\|<\\frac{c}{4} \\right)\n\\end{aligned}')
('2.0', '\\alpha = \\frac{1}{\\sqrt{T}}')
('2.0', '\\tilde p_t(\\xi) = \\tilde p_t(-\\xi)')
('2.0', '\\begin{aligned}\n \\label{eq: pure_conv}\n    &\\frac{1}{T} \\sum_{t=1}^T \\mathbb P_{\\xi_t \\sim \\tilde p_t}\\left(\\|\\xi_t\\|<\\frac{c}{4}\\right) \\min\\left\\{\\| \\nabla f(x_t)\\|, \\frac{3}{4}c\\right\\}  \\| \\nabla f(x_t)\\| \\leq \\frac{D_f}{\\sqrt{T} } + \\frac{G}{2\\sqrt{T}} c^2  - \\frac{1}{T}\\sum_{t=1}^T b_t,\n\\end{aligned}')
('2.0', 'b_t := \n\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (p_t(\\xi_t)-\\tilde p_t(\\xi_t)) d\\xi_t')
('2.0', '\\mathbb P_{\\xi_t \\sim \\tilde p_t}\\left(\\|\\xi_t\\|<\\frac{c}{4}\\right)')
('2.0', '\\tilde p_t')
('2.0', 'p_t')
('2.0', 'b_t')
('2.0', '\\tilde p(\\xi) = \\tilde p(-\\xi)')
('2.0', '\\xi')
('2.0', '\\ell_2')
('2.0', 'c/4')
('2.0', '\\|\\xi_t\\|')
('2.0', 'p')
('2.0', '\\tilde{p}')
('2.0', 'b_t')
('2.1', 'p')
('2.1', '\\tilde p')
('2.1', '\\sum_{t=1}^T b_t')
('2.1', 'b_t \\geq 0')
('2.1', 'b_t')
('2.1', 'p')
('2.1', 'p(\\xi) \\geq p(-\\xi)')
('2.1', '\\xi')
('2.1', '\\langle \\xi, \\nabla f(x) \\rangle >0')
('2.1', '\\tilde p (\\xi_t) = \\frac{1}{2} (p(\\xi_t)+p(-\\xi_t))')
('2.1', 'b_t')
('2.1', '\\begin{aligned}\n    \\int_{\\xi_t \\in \\{\\xi: \\langle \\xi, \\nabla f(x_t) \\rangle > 0\\} } \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) - \\text{clip}(\\nabla f(x_t)- \\xi_t,c) \\rangle (\\frac{1}{2} (p(\\xi_t)-p(-\\xi_t))) d\\xi_t,\n\\end{aligned}')
('2.1', '\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) - \\text{clip}(\\nabla f(x_t)- \\xi_t,c) \\rangle \\geq 0')
('2.1', '\\mathbb E_{\\xi_t \\sim p}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('2.1', '\\mathbb E_{\\xi_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle]')
('2.1', '\\mathbb E_{\\xi_t \\sim p}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('2.1', '\\nabla f(x_t) + \\xi_t')
('2.1', 'p_0')
('2.1', 'p_1')
('2.1', '0')
('2.1', 'v')
('2.1', '\\xi_t')
('2.1', 'v')
('2.1', 'w_0')
('2.1', '\\nabla f(x_t) + \\xi_t')
('2.1', 'p_0')
('2.1', '\\tilde p = p - w_0 p_0')
('2.1', 'v')
('2.1', '\\begin{aligned}\n    \\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle w_0 p_0(\\xi_t) d\\xi_t = 0\n\\end{aligned}')
('2.1', 'p_0(\\xi_t)')
('2.1', '\\nabla f(x_t)+ \\xi_t')
('2.1', '\\tilde p = p - w_0 p_0')
('2.1', '\\int \\tilde p(\\xi_t) = 1-w_0')
('2.1', '1-w_0')
('2.1', '\\tilde p(\\xi_t)/(1-w_0)')
('2.1', 'p')
('2.1', 'p')
('2.1', 'm')
('2.1', 'u_1,...,u_m')
('2.1', '\\langle f(x_t), u_i\\rangle \\geq 0, \\forall i \\in [m]')
('2.1', 'm')
('2.1', 'i')
('2.1', 'p_i(\\xi) = \\phi_i(\\|\\xi - u_i\\|)')
('2.1', '\\phi_i')
('2.1', '\\nabla f(x_t) = \\sum_{i=1}^n w_iu_i')
('2.1', 'w_i \\geq 0,  \\sum_{i=1}^m w_i = 1')
('2.1', "p'(\\xi) = \\sum_{i=1}^m w_i p_i(\\xi - \\nabla f(x_t) ),")
('2.1', '\\langle u_i, \\nabla f(x_t) \\rangle \\geq 0, \\forall i \\in [m]')
('2.1', "\\begin{aligned}\n\\mathbb E_{\\xi_t \\sim {p'}}[\\langle \\nabla f(x_t), g_t \\rangle ]  \\geq \\| \\nabla f(x_t)\\| \\sum_{i=1}^m w_i\\min(\\|u_i\\|,\\frac{3}{4}c)\\cos (\\nabla f(x_t),u_i)  \\mathbb P_{\\xi_t \\sim p_i}(\\|\\xi_t\\|<\\frac{c}{4}) \\geq 0\n\\end{aligned}")
('2.1', 'b_t')
('3', 'D')
('3', 'S')
('3', 'n')
('3', '\\{s_1, \\ldots , s_n\\}')
('3', 'f(x) = \\frac{1}{n} \\sum_{i=1}^n f(x, s_i)')
('3', 'x_t\\in \\mathbb{R}^d')
('3', 's_i')
('3', '\\xi_{t, i} = \\nabla f(x_t, s_i) - \\nabla f(x_t)')
('3', 'p_t')
('3', '\\xi_{t,i}')
('3', 't')
('3', '\\begin{aligned}\n \\label{eq: dpsgd}\nx_{t+1} = x_t - \\alpha \\left( \\left( \\frac{1}{|S_t|} \\sum_{i\\in S_t} \\text{clip}(\\nabla f(x_t) + \\xi_{t,i},c) \\right) + Z_t\\right)\n\\end{aligned}')
('3', 'S_t')
('3', 'S')
('3', 'Z_t \\sim \\mathcal N(0, \\sigma^2  I)')
('3', 'u')
('3', 'v')
('3', 'T')
('3', '\\epsilon \\leq u q^2 T')
('3', 'q = \\frac{|S_t|}{n}')
('3', 'c')
('3', '(\\epsilon, \\delta)')
('3', '\\delta >0')
('3', '\\sigma^{2} \\geq v \\frac{ c^{2} T \\ln \\left(\\frac{1}{\\delta}\\right)}{n^{2} \\epsilon^{2}}')
('3', 'b_t')
('3', 'd')
('3', '\\alpha = \\frac{ \\sqrt{D_fd\\ln(\\frac{1}{\\delta})}\n}{n\\epsilon c\\sqrt{L} }')
('3', '\\tilde{p}_t(\\xi_t) = \\tilde{p}_t(-\\xi_t)')
('3', 'm = |S_t|')
('3', 'u')
('3', 'v')
('3', '\\epsilon \\leq u \\frac{m^2}{n^2}T')
('3', '\\sigma^{2} = v \\frac{ c^{2} T \\ln \\left(\\frac{1}{\\delta}\\right)}{n^{2} \\epsilon^{2}}')
('3', '\\begin{aligned}\n%\\label{eq: sgd_clip_final2}\n    \\frac{1}{T}\\sum_{t=1}^T  \\mathbb P_{\\xi_t \\sim \\tilde p} \\left(\\|\\xi_t\\|<\\frac{c}{4} \\right)  h_c(\\|\\nabla f(x_t)\\|)\n    \\leq & \n    \\left(\\frac{1}{2 }v+\\frac{3}{2}\\right) {c}\\frac{ \\sqrt{D_fGd\\ln(\\frac{1}{\\delta})} \n}{n\\epsilon } + \\frac{1}{T}\\sum_{t=1}^T W_{\\nabla f(x_t),c}(\\tilde p_t, p_t)\n\\end{aligned}')
('3', 'h_c(y)  = \\min(y^2, \\frac{3}{4}cy)')
('3', "W_{v,c}(p,p')")
('3', 'p')
('3', "p'")
('3', 'd_{v,c}(a,b) = |\\langle v, \\text{clip}(v+ a,c) \\rangle - \\langle v, \\text{clip}(v+ b,c) \\rangle|')
('3', 'D_f \\geq f(x_1) - \\min_{x}f(x)')
('3', 'O({\\sqrt{d}}/{(n\\epsilon)})')
('3', 'O({\\sqrt{d}}/{(n\\epsilon)}) + \\text{clipping  bias}')
('3', 'O({\\sqrt{d}}/{(n\\epsilon)})')
('3', 'b_t')
('3', 'p_t')
('3', '\\tilde p_t')
('3', 'p_t')
('3', '\\tilde p')
('3', 'b_t')
('3', "\\begin{aligned}\n    -b_t = &\n\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (\\tilde p(\\xi_t)-{p}(\\xi_t)) d\\xi_t \\nonumber \\\\\n=& \\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle \\tilde p(\\xi_t) d\\xi_t - \\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle  p(\\xi_t') d\\xi_t'  \\nonumber \\\\\n=& \\int \\int (\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle - \\langle \\nabla f(x_t), \\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle) \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t \\nonumber \\\\\n\\leq & \\int \\int |\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle - \\langle \\nabla f(x_t), \\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle| \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t\n\\end{aligned}")
('3', '\\gamma')
('3', '\\tilde p')
('3', 'p')
('3', "\\begin{aligned}\n    b_t \\leq \\inf_{\\gamma \\in \\Gamma(\\tilde p, p)}\\int \\int |\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle - \\langle \\nabla f(x_t), \\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle| \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t \\nonumber\n\\end{aligned}")
('3', '\\Gamma(\\tilde p,  p)')
('3', '\\tilde p')
('3', 'p')
('3', 'd_{y,c}(a,b) = |\\langle y, \\text{clip}(y+ a,c) \\rangle - \\langle y, \\text{clip}(y+ b,c) \\rangle|')
('3', "\\begin{aligned}\n    b_t \\leq \\inf_{\\gamma \\in \\Gamma(\\tilde p, p)}\\int \\int d_{\\nabla f(x_t), c}(\\xi_t, \\xi_t') \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t \n\\end{aligned}")
('3', 'd_{\\nabla f(x_t), c}')
('3', '\\tilde p')
('3', 'n')
('3', '\\|\\nabla f(x)\\| c')
('3', '\\ell_2')
('3', 'b_t')
('3', '\\tilde p')
('4', '\\times')
('4', '\\alpha = 0.15')
('4', '\\times')
('4', '\\times')
('4', '\\alpha = 0.001')
('4', 'c=1')
('4', '\\cos(\\nabla f(x_t)+ \\xi_{t,i}, \\nabla f(x_t))')
('5', '\\begin{aligned}\n    g_t = \\text{clip}(\\nabla f(x_t)+ \\xi_t + k \\zeta_t,c),  \\zeta_t \\sim \\mathcal N(0,  I),\n\\end{aligned}')
('5', '|b_t| = O\\left(\\frac{\\sigma^2_{\\xi_t}}{k^2}\\right)')
('5', 'g_t = \\text{clip}(\\nabla f(x_t)+ \\xi_t + k \\zeta_t,c)')
('5', '\\zeta_t \\sim \\mathcal N(0,  I)')
('5', '\\begin{aligned}\n\\mathbb E_{\\xi_t \\sim {p}, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]  \\geq \\| \\nabla f(x_t)\\| \\min\\left\\{\\| \\nabla f(x_t)\\|, \\frac{3}{4}c\\right\\}  \\mathbb P(\\|k\\zeta_t\\|<\\frac{c}{4}) - O(\\frac{\\sigma^2_{\\xi_t}}{k^2})\n\\end{aligned}')
('5', '\\sigma^2_{\\xi_t}')
('5', '\\xi_t')
('5', '\\begin{aligned}\nx_{t+1} = x_t - \\alpha \\bigg( \\bigg( \\frac{1}{|S_t|} \\sum_{i\\in S_t} \\text{clip}(\\nabla f(x_t) + \\xi_{t,i} + k\\zeta_{t,i},c) \\bigg) + Z_t\\bigg), \\nonumber\n\\end{aligned}')
('5', '\\sigma = 1')
('5', 'Z_t \\sim \\mathcal N(0,I)')
('5', 'f(x) = \\frac{1}{n}\\sum_{i=1}^n\\frac{1}{2}\\|x-z_i\\|^2')
('5', 'n=10000')
('5', 'z_i')
('5', 'I')
('5', '\\mathcal N(0,36 I)')
('5', '\\mathcal N(0,4 I)')
('5', '\\mathcal N(0, I)')
('5', '\\alpha = 0.015')
('5', '\\alpha = 0.001')
('5', '\\|x_t - \\mathop{\\mathrm{arg\\,min}}_x f(x)\\|')
('5', 't')
('8', '\\begin{aligned}\n    f(x_{t+1}) \\leq f(x_t) + \\langle \\nabla f(x_t), x_{t+1} - x_t \\rangle + \\frac{1}{2}G \\|x_{t+1} - x_t\\|^2.\n\\end{aligned}')
('8', '\\|g_t\\| \\leq c')
('8', '\\begin{aligned}\n    f(x_{t+1}) \\leq &f(x_t) -\\alpha \\langle \\nabla f(x_t), g_t \\rangle + \\frac{1}{2}G \\alpha^2\\|g_t\\|^2 \\nonumber \\\\\n    \\leq& f(x_t) -\\alpha \\langle \\nabla f(x_t), g_t \\rangle + \\frac{1}{2}G \\alpha^2 c^2.\n\\end{aligned}')
('8', 't')
('8', 'T')
('8', 'T\\alpha')
('8', '\\alpha = \\frac{1}{\\sqrt{T}}')
('8', '\\begin{aligned}\n   \\frac{1}{T} \\sum_{t=1}^T \\mathbb E [ \\langle \\nabla f(x_t), g_t \\rangle ]   \\leq & \\frac{1}{T\\alpha} ( f(x_1) - f(x_{T+1}) )  + \\frac{1}{2}G \n   \\alpha c^2 \\nonumber \\\\\n   \\leq & \\frac{1}{\\sqrt{T}}\\mathbb E [ f(x_1) - f(x_{T+1}) ]  + \\frac{1}{2\\sqrt{T}} G c^2 \\nonumber \\\\\n   \\leq & \\frac{1}{\\sqrt{T}}D_f  + \\frac{1}{2\\sqrt{T}} G c^2 \n\\end{aligned}')
('8', 'D_f = f(x_1) - \\min_x f(x)')
('8', '\\square')
('9', '\\xi_t \\sim \\tilde p_t')
('9', '\\mathbb P')
('9', '\\mathbb E')
('9.0', '\\|\\nabla f(x_t)\\| \\leq \\frac{3}{4}c')
('9.0', 'B')
('9.0', '\\|\\nabla f(x_t) + \\xi_t\\| \\leq c')
('9.0', '\\|\\nabla f(x_t) - \\xi_t\\| \\leq c')
('9.0', '\\mathbb P (B) \\geq \\mathbb P (\\|\\xi_t\\| \\leq \\frac{c}{4})')
('9.0', 'D = \\{\\xi: \\|\\nabla f(x_t) + \\xi_t\\| > c\\  \\textrm{or}\\  \\|\\nabla f(x_t) - \\xi_t\\| > c \\}')
('9.0', 'x_t')
('9.0', '\\begin{aligned}\n    &\\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle ] \\nonumber \\\\\n    =&  \\langle \\nabla f(x_t), \\mathbb E[ \\text{clip}(\\nabla f(x_t) + \\xi_t, c)] \\rangle  \\nonumber \\\\\n    =&  \\left\\langle\\nabla f(x_t), \\mathbb E\\left[ \\text{clip}(\\nabla f(x_t) + \\xi_t, c)\\bigg| B \\right]\\right\\rangle\\mathbb P(B) \\nonumber \\\\\n    & +  \\left\\langle\\nabla f(x_t), \\mathbb \\int_{D  } \\text{clip}(\\nabla f(x_t) + \\xi_t,c) \\tilde p(\\xi_t) d \\xi_t \n    \\right\\rangle\\nonumber \\\\\n    \\geq &  \\| \\nabla f(x_t)\\|^2 \\mathbb P(\\|\\xi_t\\|\\leq \\frac{c}{4}) +  \\underbrace{\\left\\langle\\nabla f(x_t), \\mathbb \\int_{D} \\text{clip}(\\nabla f(x_t) + \\xi_t,c) \\tilde p(\\xi_t) d \\xi_t \n    \\right\\rangle}_{T_1}  \\nonumber     \n\\end{aligned}')
('9.0', '\\text{clip}(\\nabla f(x_t) + \\xi_t, c) = \\nabla f(x_t) + \\xi_t')
('9.0', 'B')
('9.0', '\\mathbb P (B) \\geq \\mathbb P (\\|\\xi_t\\| \\leq \\frac{c}{4})')
('9.0', '\\tilde p(\\xi) = \\tilde p(-\\xi)')
('9.0', 'T_1')
('9.0', '\\begin{aligned}\n    T_1 \n    = & \\frac{1}{2 }\\left(\\left\\langle\\nabla f(x_t), \\mathbb \\int_{D} \\text{clip}(\\nabla f(x_t) + \\xi_t,c) \\tilde p(\\xi_t) d \\xi_t\n    \\right\\rangle+ \\left\\langle\\nabla f(x_t), \\mathbb \\int_{D} \\text{clip}(\\nabla f(x_t) - \\xi_t,c) \\tilde p(\\xi_t) d \\xi_t \n    \\right\\rangle\\right) \\nonumber \\\\\n    = & \\frac{1}{2 }\\left\\langle\\nabla f(x_t), \\mathbb \\int_{D}\\left( \\text{clip}(\\nabla f(x_t) + \\xi_t,c) + \\text{clip}(\\nabla f(x_t) - \\xi_t,c)\\right) \\tilde p(\\xi_t) d \\xi_t \n    \\right\\rangle\\nonumber \\\\\n     = & \\frac{1}{2 } \\|\\nabla f(x_t)\\| \\nonumber \\\\\n     &\\times  \\int_{D}   \\underbrace{\\left( \\|  \\text{clip}(\\bar g_t + \\xi_t,c)\\| cos(\\bar g_t, \\bar g_t + \\xi_t)+ \\| \\text{clip}(\\bar g_t - \\xi_t,c)\\| cos(\\bar g_t, \\bar g_t- \\xi_t) \\right)}_{T_2(\\xi_t)} \\tilde p(\\xi_t) d \\xi_t\n\\end{aligned}')
('9.0', '\\bar g_t \\triangleq \\nabla f(x_t)')
('9.0', '\\langle a,b \\rangle = \\|a\\| \\|b\\| \\cos(a,b)')
('9.0', 'a,b')
('9.0', 'T_2(\\xi_t)')
('9.0', 'T_2(\\xi_t) \\geq 0')
('9.0', '||\\bar g_t+\\xi_t|| \\geq c')
('9.0', '||\\bar g_t-\\xi_t|| \\geq c')
('9.0', '\\begin{aligned}\n    T_2(\\xi) =  c( cos(\\bar g_t, \\bar g_t + \\xi_t)+  cos(\\bar g_t, \\bar g_t- \\xi_t) ) \\geq 0 \n\\end{aligned}')
('9.0', '||\\bar g_t+\\xi_t||')
('9.0', '||\\bar g_t-\\xi_t||')
('9.0', 'c')
('9.0', '\\cos(\\bar g_t, \\bar g_t- \\xi_t) <0')
('9.0', '\\cos(\\bar g_t,- \\xi_t) <0')
('9.0', 'cos(\\bar g_t,\\bar g_t + \\xi_t) >0')
('9.0', '\\begin{aligned}\n    ||\\bar g_t+\\xi|| \\geq ||\\bar g_t-\\xi||.\n\\end{aligned}')
('9.0', '\\begin{aligned}\n   T_2(\\xi_t) =&   \\|  \\text{clip}(\\bar g_t + \\xi_t,c)\\| \\cos(\\bar g_t, \\bar g_t + \\xi_t)+ \\| \\text{clip}(\\bar g_t - \\xi,c)\\| cos(\\bar g_t, \\bar g_t- \\xi) \\nonumber \\\\\n    = & c \\cdot \\cos(\\bar g_t, \\bar g_t + \\xi_t)+ \\| \\text{clip}(\\bar g_t - \\xi_t,c)\\| \\cos(\\bar g_t, \\bar g_t- \\xi_t) \\nonumber \\\\\n    \\geq  & c \\cdot \\cos(\\bar g_t, \\bar g_t + \\xi_t)+ c \\cdot cos(\\bar g_t, \\bar g_t- \\xi_t) \\nonumber \\\\\n    \\geq & 0\n\\end{aligned}')
('9.0', 'cos(\\bar g_t, \\bar g_t + \\xi_t) <0')
('9.0', 'cos(\\bar g_t, \\bar g_t+ \\xi_t) \\geq 0')
('9.0', 'cos(\\bar g_t, \\bar g_t- \\xi_t) \\geq 0')
('9.0', 'T_2(\\xi_t) \\geq 0')
('9.0', '\\begin{aligned}\n    &\\mathbb E[\\langle \\nabla f(x_t),  g_t \\rangle ] \n    \\geq   \\| \\nabla f(x_t)\\|^2 \\mathbb P(\\|\\xi_t\\|\\leq \\frac{c}{4}).    \n\\end{aligned}')
('9.1', '\\|\\nabla f(x_t)\\| \\geq \\frac{3}{4}c')
('9.1', '\\begin{aligned}\n\\label{eq: T_7}\n    &\\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle ] \\nonumber \\\\\n    =&  \\left\\langle\\nabla f(x_t), \\int_{\\xi} \\text{clip}(\\nabla f(x_t)+\\xi,c) p(\\xi) d \\xi \\right\\rangle\\nonumber \\\\\n    =&  \\int_{\\xi} \\left\\langle\\nabla f(x_t),  \\text{clip}(\\nabla f(x_t)+\\xi,c) p(\\xi) d \\xi \\right\\rangle\\nonumber \\\\\n     =&  \\|\\nabla f(x_t)\\| \\underbrace{\\int_{\\xi}  \\|\\text{clip}(\\nabla f(x_t)+\\xi,c)\\| cos(\\nabla f(x_t), \\nabla f(x_t) + \\xi) p(\\xi) d \\xi}_{T_7} \n\\end{aligned}')
('9.1', 'T_7')
('9.1', '\\|\\nabla f(x_t)\\|')
('9.1', 'T_7')
('9.1', '\\nabla f(x_t)')
('9.1', '\\nabla f(x_t)_1 = y > 0')
('9.1', '\\nabla f(x_t)_i = 0')
('9.1', '2\\leq i\\leq d')
('9.1', 'T_7')
('9.1', '\\|\\nabla f(x_t)\\|')
('9.1', 'y')
('9.1', '\\xi_t')
('9.1', '\\begin{aligned}\n\\label{eq: term_increase}\n     \\|\\text{clip}(\\nabla f(x_t)+\\xi_t,c)\\| cos(\\nabla f(x_t), \\nabla f(x_t) + \\xi_t)\n\\end{aligned}')
('9.1', 'y')
('9.1', 'y>0')
('9.1', '\\nabla f(x_t)= [y,0,...,0]')
('9.1', '\\|\\nabla f(x_t)+\\xi_t\\| \\leq c')
('9.1', '\\begin{aligned}\n     &\\|\\nabla f(x_t)+\\xi_t\\| cos(\\nabla f(x_t), \\nabla f(x_t) + \\xi_t) \\nonumber \\\\\n     = & \\|\\nabla f(x_t)+\\xi_t\\| \\frac{\\langle \\nabla f(x_t), \\nabla f(x_t) + \\xi_t \\rangle }{\\|\\nabla f(x_t)\\| \\|\\nabla f(x_t) + \\xi_t\\|} \\nonumber \\\\\n     = &  \\frac{\\langle \\nabla f(x_t), \\nabla f(x_t) + \\xi_t \\rangle }{\\|\\nabla f(x_t)\\|} \\nonumber \\\\\n     = &  \\frac{y(y+\\xi_{t,1}) }{y}  \n     =  y+\\xi_{t,1}\n\\end{aligned}')
('9.1', 'y')
('9.1', '\\|\\nabla f(x_t)+\\xi_t\\| \\geq c')
('9.1', '\\begin{aligned}\n\\label{eq: clip_cos}\n     & \\|\\text{clip}(\\nabla f(x_t)+\\xi,c)\\| cos(\\nabla f(x_t), \\nabla f(x_t) + \\xi_t) \\nonumber \\\\\n     =& c \\cdot cos(\\nabla f(x_t), \\nabla f(x_t) + \\xi_t) \\nonumber \\\\\n     =& c \\frac{\\langle \\nabla f(x_t), \\nabla f(x_t) + \\xi_t \\rangle }{\\|\\nabla f(x_t)\\| \\|\\nabla f(x_t) + \\xi_t\\|} \\nonumber \\\\ \n     =& c \\frac{y(y+\\xi_{t,1}) }{y \\sqrt{(y+\\xi_{t,1})^2 + \\sum_{i=2}^d \\xi_{t,i}^2}} = c \\frac{(y+\\xi_{t,1}) }{ \\sqrt{(y+\\xi_{t,1})^2 + \\sum_{i=2}^d \\xi_{t,i}^2}} \n\\end{aligned}')
('9.1', 'y')
('9.1', '\\begin{aligned}\n    r(z) = c \\frac{z}{\\sqrt{z^2+q^2}},\n\\end{aligned}')
('9.1', "r'(z) =c( 1-\\frac{z^2}{z^2+q^2}) \\geq 0")
('9.1', 'z = y+\\xi_{t,1}')
('9.1', 'q^2 = \\sum_{i=2}^d \\xi_{t,i}^2')
('9.1', '\\|\\nabla f(x_t)\\|')
('9.1', '\\begin{aligned}\n    &\\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle ] \\nonumber \\\\\n     =&  \\|\\nabla f(x_t)\\| {\\int_{\\xi_t}  \\|\\text{clip}(\\nabla f(x_t)+\\xi_t,c)\\| cos(\\nabla f(x_t), \\nabla f(x_t) + \\xi_t) p(\\xi_t) d \\xi_t}  \\nonumber \\\\\n     \\geq &   \\|\\nabla f(x_t)\\| {\\int_{\\xi_t}  \\|\\text{clip}(\\frac{3}{4} c\\frac{\\nabla f(x_t)}{\\|\\nabla f(x_t)\\|}+\\xi_t,c)\\| cos(\\frac{3}{4} c\\frac{\\nabla f(x_t)}{\\|\\nabla f(x_t)\\|}, \\frac{3}{4} c\\frac{\\nabla f(x_t)}{\\|\\nabla f(x_t)\\|} + \\xi_t) p(\\xi_t) d \\xi_t}  \n\\end{aligned}')
('9.1', '\\|\\nabla f(x_t)\\| =\\frac{3}{4} c')
('9.1', '\\begin{aligned}\n   \\mathbb E[\\langle \\nabla f(x_t), g_t \\rangle ] \\geq  \\| \\nabla f(x_t)\\|^2 \\mathbb P(\\|\\xi_t\\|<\\frac{c}{4}) =  \\| \\nabla f(x_t)\\| \\left(\\frac{3}{4}c \\cdot \\mathbb P(\\|\\xi_t\\|<\\frac{c}{4})\\right)\n\\end{aligned}')
('9.1', 'T_7')
('9.1', '\\|\\nabla f(x_t)\\| \\geq \\frac{3}{4}c')
('9.1', '\\| \\nabla f(x_t)\\|\\left(\\frac{3}{4}c \\cdot \\mathbb P(\\|\\xi\\|<\\frac{c}{4})\\right)\\le \\mathbb E[\\langle \\nabla f(x_t),g_t \\rangle ]=  \\| \\nabla f(x_t)\\| T_7,')
('9.1', 'T_7\\ge \\frac{3}{4}c \\cdot \\mathbb P(\\|\\xi\\|<\\frac{c}{4}).')
('9.2', 'g')
('9.2', '\\xi')
('9.2', '\\begin{aligned}\n    cos(g, g + \\xi)+  cos(g, g- \\xi) \\geq 0\n\\end{aligned}')
('9.2', 'cos')
('9.2', '\\begin{aligned}\n \\label{eq: cos_reduce}\n    &cos(g, g + \\xi)+  cos(g, g- \\xi) \\nonumber \\\\\n    =&\\frac{\\langle g,g+\\xi \\rangle}{\\|g\\| \\|g+\\xi\\|} + \\frac{\\langle g, g- \\xi \\rangle}{\\|g\\|\\|g-\\xi\\|} \\nonumber \\\\\n    =& \\frac{\n\\|g\\|}{\\|g+\\xi\\|}  + \\frac{\n\\|g\\|}{\\|g-\\xi\\|}  +    \\frac{\\langle g,\\xi \\rangle}{\\|g\\| \\|g+\\xi\\|} - \\frac{\\langle g,  \\xi \\rangle}{\\|g-\\xi\\|} \\nonumber \\\\\n=& \\frac{\n\\|g\\|}{\\|g+\\xi\\|}  + \\frac{\n\\|g\\|}{\\|g-\\xi\\|}  +    \\frac{\\|\\xi\\| cos(g,\\xi) }{\\|g+\\xi\\|} - \\frac{\\|\\xi\\|cos(g,\\xi)}{\\|g-\\xi\\|} \\nonumber \\\\\n=& \\frac{\\|g+\\xi\\|(\\|g\\|- \\|\\xi\\|e) +\\|g-\\xi\\|(\\|g\\|+ \\|\\xi\\|e) }{\\|g+\\xi\\|\\|g-\\xi\\|}\n\\end{aligned}')
('9.2', 'e = cos(g,\\xi)')
('9.2', 'h(\\xi) = cos(g, g + \\xi)+  cos(g, g- \\xi)')
('9.2', 'h')
('9.2', '\\xi_1 >0')
('9.2', '\\xi_{t,i} =0')
('9.2', '2\\leq i \\leq d')
('9.2', 'h(\\xi) = h(-\\xi)')
('9.2', 'g_1 \\geq 0')
('9.2', 'g_1 = a')
('9.2', '\\sum_{i=2}^d g_i^2 = b^2')
('9.2', 'T_3')
('9.2', '\\begin{aligned}\n    T_3 =& \\|g+\\xi\\|(\\|g\\|- \\|\\xi\\|e) +\\|g-\\xi\\|(\\|g\\|+ \\|\\xi\\|e)  \\nonumber \\\\\n    = &\\underbrace{\\sqrt{b^2 + (a+\\xi_1)^2}(\\sqrt{a^2+b^2}-\\xi_1e)}_{T_4} + \\underbrace{ \\sqrt{b^2 + (a-\\xi_1)^2}(\\sqrt{a^2+b^2}+\\xi_1e) }_{T_5}\n\\end{aligned}')
('9.2', 'e = \\frac{\\langle g,\\xi\\rangle}{\\|g\\| \\|\\xi\\|} =  \\frac{a}{\\sqrt{a^2+b^2}}')
('9.2', 'T_3')
('9.2', '\\xi_1>0')
('9.2', 'e \\geq 0')
('9.2', 'T_5 \\geq 0')
('9.2', 'T_3 \\geq 0')
('9.2', 'T_4 \\geq 0')
('9.2', '\\xi_1e \\leq \\sqrt{a^2 + b^2}')
('9.2', '\\xi_1e > \\sqrt{a^2 + b^2}')
('9.2', 'T_3 \\geq 0')
('9.2', 'T_5^2 \\geq T_4^2')
('9.2', '\\begin{aligned}\n    T_5^2 - T_4^2 = & {({b^2 + (a-\\xi_1)^2})(\\sqrt{a^2+b^2}+\\xi_1e)^2} - { ({b^2 + (a+\\xi_1)^2})(\\sqrt{a^2+b^2}-\\xi_1e)^2 } \\nonumber \\\\\n    = & 4b^2\\xi_1e\\sqrt{a^2+b^2} + \\underbrace{4\\xi_1e \\sqrt{a^2+b^2}(a^2+\\xi_1^2) - 4a\\xi_1(a^2+b^2+\\xi_1^2e^2)}_{T_6}\n\\end{aligned}')
('9.2', 'T_6')
('9.2', '\\begin{aligned}\n    T_6 = & 4\\xi_1e \\sqrt{a^2+b^2}(a^2+\\xi_1^2) - 4a\\xi_1(a^2+b^2+\\xi_1^2e^2) \\nonumber \\\\\n    = &4\\xi_1a(a^2+\\xi_1^2) - 4a\\xi_1(a^2+b^2+\\xi_1^2e^2) \\nonumber \\\\\n    = &  4\\xi_1a (\\xi_1^2(1-e^2) - b^2) \\nonumber \\\\\n    = &  4\\xi_1a (\\xi_1^2(\\frac{b^2}{a^2+ b^2}) - b^2) \\nonumber \\\\\n    = &  4\\xi_1a (b^2(\\frac{\\xi_1^2 - (a^2+b^2)}{a^2+ b^2}) ) \\nonumber \\\\\n    \\geq & 0\n\\end{aligned}')
('9.2', '\\xi^2 \\geq \\xi^2e^2 \\geq a^2+b^2')
('9.2', '\\xi_1a >0')
('9.2', 'T_6 \\geq 0 \\implies T_5^2- T_4^2 \\geq 0 \\implies T_3 \\geq 0 \\implies cos(g, g + \\xi)+  cos(g, g- \\xi) \\geq 0')
('9.2', 'g')
('9.2', '\\xi')
('9.2', '\\begin{aligned}\n    \\|g + \\xi\\| \\geq \\|g - \\xi\\| \n\\end{aligned}')
('9.2', 'cos(g, \\xi) > 0')
('9.2', '\\begin{aligned}\n    \\|g + \\xi\\| \\leq \\|g - \\xi\\| \n\\end{aligned}')
('9.2', 'cos(g, \\xi) < 0')
('9.2', '\\xi')
('9.2', 'g')
('9.2', 'v_1, v_2,... v_d')
('9.2', 'v_1')
('9.2', 'g/\\|g\\|')
('9.2', '\\xi = \\sum_{i=1}^d b_i v_i')
('9.2', 'cos(g,\\xi) > 0')
('9.2', 'b_1 >0')
('9.2', '\\begin{aligned}\n    \\|g+\\xi\\| =\\sqrt{(\\|g\\| +b_1)^2 + \\sum_{i=2}^d b_i^2 }\n\\end{aligned}')
('9.2', '\\begin{aligned}\n    \\|g-\\xi\\| =\\sqrt{(\\|g\\| -b_1)^2 + \\sum_{i=2}^d b_i^2 }.\n\\end{aligned}')
('9.2', '\\|g+\\xi\\| \\geq \\|g-\\xi\\|')
('9.2', 'b_1 >0')
('9.2', 'cos(g,\\xi) > 0')
('9.2', 'cos(g,\\xi) < 0')
('10', 'm')
('10', 'i')
('10', 'p_i(\\xi_t) = \\phi_i(\\|\\xi_t - u_i\\|)')
('10', '\\phi_i')
('10', '\\nabla f(x_t) = \\sum_{i=1}^m w_iu_i')
('10', 'w_i \\geq 0,  \\sum_{i=1}^m w_i = 1')
('10', "p'(\\xi_t) = \\sum_{i=1}^m w_i p_i(\\xi_t - \\nabla f(x_t) ),")
('10', '\\langle u_i, \\nabla f(x_t) \\rangle \\geq 0, \\forall i \\in [m]')
('10', "\\begin{aligned}\n\\mathbb E_{\\xi_t \\sim {p'}}[\\langle \\nabla f(x_t), g_t \\rangle ]  \\geq \\| \\nabla f(x_t)\\| \\sum_{i=1}^m w_i\\min(\\|u_i\\|,\\frac{3}{4}c)\\cos (\\nabla f(x_t),u_i)  \\mathbb P_{\\xi_t \\sim p_i}(\\|\\xi_t\\|<\\frac{c}{4}) \\geq 0\n\\end{aligned}")
('10', '\\xi \\sim \\tilde p')
('10', '\\tilde p(\\xi) = \\tilde p(-\\xi)')
('10', 'g')
('10', '\\begin{aligned}\n\\textrm{1. If } \\|g\\| \\leq \\frac{3}{4}c,&\\quad \\text{ then }\\quad\n\\mathbb E[\\langle g, \\text{clip}(g+\\xi,c) \\rangle ]  \\geq \\| g\\|^2  \\mathbb P\\left(\\|\\xi\\|<\\frac{c}{4}\\right)\\\\\n\\textrm{2. If } \\|g\\| > \\frac{3}{4}c,&\\quad \\text{ then } \\quad \\mathbb E[\\langle g,\\text{clip}(g+\\xi,c)  \\rangle ]  \\geq \\frac{3}{4}  c \\| g\\|  \\mathbb P\\left(\\|\\xi\\|<\\frac{c}{4} \\right)\n\\end{aligned}')
('10', '\\xi \\sim \\hat p')
('10', '\\hat p')
('10', '\\hat p(\\xi) = \\phi (\\|\\xi\\|)')
('10', '\\phi')
('10', 'g')
('10', '\\mathbb E [\\text{clip}(g + \\xi)] = r g')
('10', 'r')
('10', 'g')
('10', '\\tilde p')
('10', '\\tilde p(\\xi) = \\phi (\\|\\xi\\|)')
('10', '\\begin{aligned}\n\\label{eq: same_direc}\n    \\mathbb E[\\text{clip}(g+\\xi,c)] = r g  \n\\end{aligned}')
('10', 'r \\geq 0')
('10', '\\begin{aligned}\n    r\\|g\\| \\geq \\min(\\frac{3}{4}c,\\|g\\|)\\mathbb P\\left(\\|\\xi\\|<\\frac{c}{4} \\right).\n\\end{aligned}')
('10', "\\begin{aligned}\n    \\mathbb E_{\\xi_t \\sim {p'}}[\\langle \\nabla f(x_t), g_t \\rangle ] =  \\sum_{i=1}^m w_i \\mathbb E_{\\xi_t \\sim {p_i}}[\\langle \\nabla f(x_t), g_t \\rangle ].\n\\end{aligned}")
('10', 'E_{\\xi_t \\sim {p_i}}[g_t] = u_i')
('10', 'p_i')
('10', 'u_i')
('10', '\\begin{aligned}\n    E_{\\xi_t \\sim {p_i}}[\\langle \\nabla f(x_t), g_t \\rangle ] = \\langle \\nabla f(x_t),   E_{\\xi_t \\sim {p_i}}[g_t] \\rangle  = \\langle \\nabla f(x_t),  r_i u_i \\rangle \n\\end{aligned}')
('10', 'r_i \\|u_i\\| \\geq \\min(\\frac{3}{4}c,\\|u_i\\|)\\mathbb P_{\\xi_t \\sim p_i}\\left(\\|\\xi_t\\|<\\frac{c}{4} \\right)')
('10', '\\langle u_i, \\nabla f(x_t) \\rangle \\geq 0')
('10', "\\begin{aligned}\n    \\mathbb E_{\\xi_t \\sim {p'}}[\\langle \\nabla f(x_t), g_t \\rangle ] \\geq   \\|\\nabla f(x_t)\\|  \\sum_{i=1}^m w_i\\min(\\frac{3}{4}c,\\|u_i\\|) \\cos (u_i,\\nabla f(x_t))\\mathbb P_{\\xi_t \\sim p_i}\\left(\\|\\xi_t\\|<\\frac{c}{4} \\right) \\geq 0\n\\end{aligned}")
('11', '\\begin{aligned}\nx_{t+1} = x_t - \\alpha \\left( \\left( \\frac{1}{|S_t|} \\sum_{i\\in S_t} \\text{clip}(\\nabla f(x_t) + \\xi_{t,i},c) \\right) + Z_t\\right)\n\\end{aligned}')
('11', 'g_{t,i} \\triangleq \\nabla f(x_t)+ \\xi_{t,i}')
('11', 't')
('11', 'i')
('11', 'S_t')
('11', 'D')
('11', 'Z_t \\sim \\mathcal N(0, \\sigma^2  I)')
('11', 'g_t = \\frac{1}{|S_t|}\\sum_{i\\in  S_t} \\text{clip}(\\nabla f(x_t)+ \\xi_{t,i},c)')
('11', '\\begin{aligned}\n    f(x_{t+1}) \\leq f(x_t) + \\langle \\nabla f(x_t), x_{t+1} - x_t \\rangle + \\frac{1}{2}G \\|x_{t+1} - x_t\\|^2\n\\end{aligned}')
('11', '\\begin{aligned}\n    f(x_{t+1}) \\leq f(x_t) -  \\alpha \\langle \\nabla f(x_t), (  g_t  + Z_t) \\rangle + \\frac{1}{2}G \\alpha^2 \\| g_t + Z_t\\|^2\n\\end{aligned}')
('11', 'x_t')
('11', '\\begin{aligned}\n    &\\mathbb E[f(x_{t+1})]  \\nonumber \\\\\n    \\leq & f(x_t) -  \\alpha \\mathbb E[ \\langle \\nabla f(x_t),   g_t   \\rangle]+ \\frac{1}{2}G \\alpha^2 (\\mathbb E[\\| g_t\\|^2]  + \\sigma^2 c^2 d) \\nonumber \\\\\n    \\leq & f(x_t) -  \\alpha  \\mathbb E[  \\langle \\nabla f(x_t),   g_t   \\rangle]+ \\frac{1}{2}G \\alpha^2 (c^2  + \\sigma^2 c^2 d).\n\\end{aligned}')
('11', 't \\in [T]')
('11', '\\begin{aligned}\n    \\sum_{t=1}^T \\alpha  \\mathbb E[ \\langle \\nabla f(x_t),   g_t  \\rangle]\n    \\leq & f(x_1) - \\mathbb E[f(x_{T+1})]  + T \\frac{1}{2}G \\alpha^2 (c^2  + \\sigma^2 d).\n\\end{aligned}')
('11', 'T\\alpha')
('11', '\\begin{aligned}\n    \\frac{1}{T}\\sum_{t=1}^T  \\mathbb E[ \\langle \\nabla f(x_t),  g_t \\rangle]\n    \\leq & \\frac{f(x_1) - \\mathbb E[f(x_{T+1})]]}{T\\alpha}  +  \\frac{1}{2}G \\alpha (c^2  + \\sigma^2 d).\n\\end{aligned}')
('11', '(\\epsilon,\\delta)')
('11', '\\sigma^2 = v\\frac{Tc^2\\ln(\\frac{1}{\\delta})}{n^2 \\epsilon^2}')
('11', 'v')
('11', '\\sigma^2')
('11', '\\begin{aligned}\n    \\frac{1}{T}\\sum_{t=1}^T \\langle  \\mathbb E[ \\nabla f(x_t),   g_t   \\rangle]\n    \\leq & \\frac{D_f}{T\\alpha }  +  \\frac{1}{2}G \\alpha (c^2  + v\\frac{T\\ln(\\frac{1}{\\delta})}{n^2 \\epsilon^2}c^2  d)\n\\end{aligned}')
('11', 'D_f = f(x_1) - \\min_x f(x)')
('11', 'T\\alpha = \\frac{\\sqrt{D_f}n\\epsilon}{\n\\sqrt{G}c\\sqrt{d}\\sqrt{\\ln(\\frac{1}{\\delta})}}')
('11', '\\begin{aligned}\n    \\frac{1}{T}  \\sum_{t=1}^T \\mathbb E[ \\langle \\nabla f(x_t),   g_t   \\rangle]\n    \\leq & \n    \\left(\\frac{1}{2 }v+1\\right) \\frac{c \\sqrt{D_fGd\\ln(\\frac{1}{\\delta})}\n}{n\\epsilon }  +  \\frac{1}{2}G \\alpha c^2.\n\\end{aligned}')
('11', '\\alpha = \\frac{ \\sqrt{D_fd\\ln(\\frac{1}{\\delta})}\n}{n\\epsilon c\\sqrt{G} }')
('11', '\\begin{aligned}\n\\label{eq: sgd_clip}\n    \\frac{1}{T}\\sum_{t=1}^T   \\mathbb E[ \\langle \\nabla f(x_t),  g_t   \\rangle]\n    \\leq & \n    \\left(\\frac{1}{2 }v+\\frac{3}{2}\\right)\\frac{c \\sqrt{D_fGd\\ln(\\frac{1}{\\delta})}\n}{n\\epsilon }.\n\\end{aligned}')
('11', '\\begin{aligned}\n     \\mathbb E[ \\langle \\nabla f(x_t),   g_t \\rangle] =  \\mathbb E_{\\xi_t \\sim p}[ \\langle \\nabla f(x_t),   \\text{clip}(\\nabla f(x_t)+ \\xi_t,c)   \\rangle]\n\\end{aligned}')
('11', '\\xi_t')
('11', '\\xi_{t,i}, i \\in D')
('11', 'D')
('11', '\\begin{aligned}\n    \\mathbb E_{\\xi_t \\sim p}[\\langle \\nabla f(x_t), g_t \\rangle ] \n    =& \\mathbb E_{\\xi_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle] +\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (p_t(\\xi_t)-\\tilde{p_t}( \\xi_t)) d\\xi_t \n\\end{aligned}')
('11', '\\tilde p')
('11', '\\begin{aligned}\n    \\mathbb E_{\\xi_t \\sim \\tilde p}[ \\langle \\nabla f(x_t),   g_t,   \\rangle] \\geq \\mathbb P_{\\xi_t \\sim \\tilde p}(\\|\\xi_t\\|<\\frac{c}{4}) \\| \\nabla f(x_t)\\|^2  \n\\end{aligned}')
('11', '\\|\\nabla f(x_t)\\| \\leq \\frac{3}{4}c')
('11', '\\begin{aligned}\n    \\mathbb E_{\\xi_{t} \\sim \\tilde p}[ \\langle \\nabla f(x_t),   g_t  \\rangle] \\geq \\frac{3}{4} \\mathbb P_{\\xi_{t} \\sim \\tilde p}(\\|\\xi_t\\|<\\frac{c}{4}) c \\| \\nabla f(x_t)\\| \n\\end{aligned}')
('11', '\\|\\nabla f(x_t)\\| \\geq \\frac{3}{4}c')
('11', "\\begin{aligned}\n&-\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (p_t(\\xi_t)-\\tilde{p_t}( \\xi_t)) d\\xi_t \\nonumber \\\\\n   = &\n\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (\\tilde p(\\xi_t)-{p}(\\xi_t)) d\\xi_t \\nonumber \\\\\n=& \\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle \\tilde p(\\xi_t) d\\xi_t - \\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle  p(\\xi_t') d\\xi_t'  \\nonumber \\\\\n=& \\int \\int (\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle - \\langle \\nabla f(x_t), \\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle) \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t \\nonumber \\\\\n\\leq & \\int \\int |\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle - \\langle \\nabla f(x_t), \\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle| \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t\n\\end{aligned}")
('11', '\\gamma')
('11', '\\tilde p')
('11', 'p')
('11', "\\begin{aligned}\n&-\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (p_t(\\xi_t)-\\tilde{p_t}( \\xi_t)) d\\xi_t \\nonumber \\\\\n \\leq & \\inf_{\\gamma \\in \\Gamma(\\tilde p, p)}\\int \\int |\\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle - \\langle \\nabla f(x_t), \\text{clip}(\\nabla f(x_t)+ \\xi_t',c) \\rangle| \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t \n\\end{aligned}")
('11', '\\Gamma(\\tilde p,  p)')
('11', '\\tilde p')
('11', 'p')
('11', 'd_{y,c}(a,b) = |\\langle y, \\text{clip}(y+ a,c) \\rangle - \\langle y, \\text{clip}(y+ b,c) \\rangle|')
('11', "\\begin{aligned}\n   & -\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ \\xi_t,c) \\rangle (p_t(\\xi_t)-\\tilde{p_t}( \\xi_t)) d\\xi_t \\nonumber \\\\\n    \\leq &\\inf_{\\gamma \\in \\Gamma(\\tilde p, p)}\\int \\int d_{\\nabla f(x_t), c}(\\xi_t, \\xi_t') \\gamma (\\xi_t,\\xi_t')  d\\xi_t d\\xi'_t  = W_{\\nabla f(x_t),c} (\\tilde p_t,p_t)\n\\end{aligned}")
('11', "W_{v,c}( p, p')")
('11', 'p')
('11', "p'")
('11', 'd_{v,c}')
('11', 'h(y) = \\bigg\\{\\begin{array}{lr}\n        y^2, & \\text{for } y \\leq 3c/4\\\\\n        \\frac{3}{4} c y, & \\text{for } y > 3c/4\n        \\end{array},')
('11', '\\begin{aligned}\n\\label{eq: sgd_clip_final}\n    \\frac{1}{T}\\sum_{t=1}^T \\mathbb P_{\\xi_{t} \\sim \\tilde p_t}(\\|\\xi_t\\|<\\frac{c}{4}) h(\\|\\nabla f(x_t)\\|)\n    \\leq & \n    \\left(\\frac{1}{2 }v+\\frac{3}{2}\\right)\\frac{c \\sqrt{D_fGd\\ln(\\frac{1}{\\delta})} \n}{n\\epsilon } + \\frac{1}{T} \\sum_{t=1}^T W_{\\nabla f(x_t),c} (\\tilde p_t,p_t)\n\\end{aligned}')
('11', '\\square')
('12', 'g_t = \\text{clip}(\\nabla f(x_t)+ \\xi_t + k \\zeta_t,c)')
('12', '\\zeta_t \\sim \\mathcal N(0,  I)')
('12', '\\begin{aligned}\n\\mathbb E_{\\xi_t \\sim {p}, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]  \\geq \\| \\nabla f(x_t)\\| \\min\\left\\{\\| \\nabla f(x_t)\\|, \\frac{3}{4}c\\right\\}  \\mathbb P(\\|k\\zeta_t\\|<\\frac{c}{4}) - O(\\frac{\\sigma^2_{\\xi_t}}{k^2})\n\\end{aligned}')
('12', '\\sigma^2_{\\xi_t}')
('12', '\\xi_t')
('12', 'W_t =  \\xi_t + k \\zeta_t')
('12', 'W_t \\sim  \\bar p')
('12', '\\mathbb E [W_t] = 0')
('12', '\\bar p(W_t) = \\int_{\\xi_t} p(\\xi_t) \\frac{1}{k}\\psi(\\frac{W_t - \\xi_t}{k}) d\\xi_t')
('12', '\\psi')
('12', '\\mathcal N(0,  I)')
('12', '\\bar p(W_t)')
('12', '\\frac{1}{k}\\psi')
('12', 'O(\\frac{\\sigma_{\\xi_t}^2}{k^2})')
('12', 'b_t')
('12', '\\bar p(W_t)')
('12', 'k')
('12', "\\begin{aligned}\n   &\\int \\left|\\bar p(W_t) - \\frac{1}{k}\\psi(\\frac{W_t}{k})\\right| d{W_t} \\nonumber \\\\ \n   = & \\int_{W_t} \\left|\\int_{\\xi_t} p(\\xi_t) \\frac{1}{k}\\psi(\\frac{W_t - \\xi_t}{k}) d\\xi_t- \\frac{1}{k}\\psi(\\frac{W_t}{k})\\right| d{W_t} \\nonumber \\\\\n    = & k\\int_{W'_t} \\left|\\int_{\\xi_t} p(\\xi_t) \\frac{1}{k}\\psi(W_t'-\\frac{ \\xi_t}{k}) d\\xi_t- \\frac{1}{k}\\psi(W'_t)\\right| d{W'_t} \n\\end{aligned}")
('12', "\\begin{aligned}\n\\label{eq:taylor}\n    \\psi(W_t'-\\frac{ \\xi_t}{k}) =   \\psi({W'_t}) +   \\langle \\nabla \\psi({W'_t}), \\frac{- \\xi_t}{k}\\rangle +  \\int_{0}^1 \\left\\langle \\frac{\\xi_t}{k}, \\nabla^2 \\psi(W_t'-\\tau \\frac{\\xi_t}{k}) \\frac{\\xi_t}{k} \\right\\rangle(1-\\tau) d \\tau\n\\end{aligned}")
('12', "\\begin{aligned}\n\\label{eq: taylor_remainder}\n   &\\int |\\bar p(W_t) - \\frac{1}{k}\\psi(\\frac{W_t}{k})| d{W_t} \\nonumber \\\\ \n    = & \\int_{W'_t} \\left|\\int_{\\xi_t} p(\\xi_t) \\psi(W_t'-\\frac{ \\xi_t}{k}) d\\xi_t- \\psi(W'_t)\\right| d{W'_t} \\nonumber \\\\\n    = & \\int_{W'_t} \\left|\\int_{\\xi_t} p(\\xi_t)  \\int_{0}^1 \\langle \\frac{\\xi_t}{k}, \\nabla^2 \\psi(W_t'-t \\frac{\\xi_t}{k}) \\frac{\\xi_t}{k} \\rangle(1-\\tau) d t d \\xi_t\\right| d{W'_t} \\nonumber \\\\\n    \\leq & \\int_{0}^1  \\int_{\\xi_t} \\int_{W'_t} \\left| p(\\xi_t)  \\langle \\frac{\\xi_t}{k}, \\nabla^2 \\psi(W_t'-t \\frac{\\xi_t}{k}) \\frac{\\xi_t}{k} \\rangle(1-\\tau) \\right| d{W'_t} d \\xi_t d \\tau\n\\end{aligned}")
('12', '\\xi_t')
('12', '\\tau \\leq 1')
('12', "\\hat W_t = W_t'-\\tau \\frac{\\xi_t}{k}")
('12', "\\begin{aligned}\n  &  \\int_{W'_t} \\left| p(\\xi_t)  \\langle \\frac{\\xi_t}{k}, \\nabla^2 \n\\psi(W_t'-\\tau \\frac{\\xi_t}{k}) \\frac{\\xi_t}{k} \\rangle(1-\\tau) \\right| d{W'_t} \\nonumber \\\\\n= &   p(\\xi_t) (1-\\tau)    \\int_{ \\hat W_t} \\left|\\langle \\frac{\\xi_t}{k}, \\nabla^2 \n\\psi(\\hat W_t') \\frac{\\xi_t}{k} \\rangle \\right| \\frac{d{W'_t}}{d{\\hat W_t}} d{\\hat W_t}  \\nonumber \\\\\n= &   p(\\xi_t) (1-\\tau)    \\int_{ \\hat W_t} \\left|\\langle \\frac{\\xi_t}{k}, \\nabla^2 \n\\psi(\\hat W_t) \\frac{\\xi_t}{k} \\rangle \\right| d{\\hat W_t} \n\\end{aligned}")
('12', '\\|\\frac{\\xi_t}{k}\\|')
('12', '\\psi')
('12', '\\xi_{t,1} = \\|\\xi_t\\|')
('12', '\\xi_{t,i} = 0')
('12', 'i \\geq 2')
('12', "\\begin{aligned}\n\\label{eq: int_1}\n    &\\int_{W'_t} \\left| p(\\xi_t)  \\langle \\frac{\\xi_t}{k}, \\nabla^2 \\psi(W_t'-\\tau \\frac{\\xi_t}{k}) \\frac{\\xi_t}{k} \\rangle(1-\\tau) \\right| d{W'_t} \\nonumber \\\\\n    \\leq  & p(\\xi_t) (1-\\tau) \\int_{W'_t} \\frac{\\|\\xi_t\\|^2}{k^2} \\left|     \\nabla^2_{1,1} \\psi(W_t'-\\tau\\frac{\\xi_t}{k})   \\right| d{W'_t} \\nonumber \\\\\n     \\leq  & p(\\xi_t) (1-\\tau) \\int_{\\hat W_t} \\frac{\\|\\xi_t\\|^2}{k^2} \\left|     \\nabla^2_{1,1} \\psi(W_t)   \\right| \\frac{d{W'_t}}{d{\\hat W_t}} d{\\hat W_t} \\nonumber \\\\\n    \\leq  & p(\\xi_t) (1-\\tau)  \\frac{\\|\\xi_t\\|^2}{k^2} q\n\\end{aligned}")
('12', "\\hat W_t= W_t'-\\tau \\frac{\\xi_t}{k}")
('12', "q = \\int_{-\\infty}^{\\infty} |h''(x)| d x")
('12', 'h(x)')
('12', 'q')
('12', "\\begin{aligned}\n\\label{eq: total_var}\n   &\\int |\\bar p(W_t) - \\frac{1}{k}\\psi(\\frac{W_t}{k})| d_{W_t} \\nonumber \\\\ \n    \\leq & \\int_{0}^1  \\int_{\\xi_t} \\int_{W'_t} \\left| p(\\xi_t)  \\langle \\frac{\\xi_t}{k}, \\nabla^2 \\psi(W_t'-\\tau \\frac{\\xi_t}{k}) \\frac{\\xi_t}{k} \\rangle(1-\\tau) \\right| d{W'_t} d \\xi_t d \\tau \\nonumber \\\\\n    \\leq &\\int_{0}^1  \\int_{\\xi_t} p(\\xi_t) (1-\\tau)  \\frac{\\|\\xi_t\\|^2}{k^2} q d \\xi_t d \\tau \\nonumber \\\\\n    = &\\int_{0}^1 (1-\\tau)  \\frac{\\sigma_{\\xi_t}^2}{k^2} q  d \\tau \\nonumber \\\\\n    = &\\frac{1}{2} \\frac{\\sigma_{\\xi_t}^2}{k^2} q   \n\\end{aligned}")
('12', '\\mathbb E [\\xi_t] = 0')
('12', '\\sigma_{\\xi_t}^2')
('12', '\\xi_t')
('12', '\\begin{aligned}\n\\label{eq: bias_split_2}\n    \\mathbb E_{\\xi_t \\sim p, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]\n     & = \\mathbb E_{W_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle] \\nonumber\\\\\n    & + \\underbrace{\\int \\langle \\nabla f(x_t),\\text{clip}(\\nabla f(x_t)+ W_t,c) \\rangle (p_t(W_t)-\\tilde{p_t}( W_t)) d W_t }_{b_t}\n\\end{aligned}')
('12', '\\tilde p')
('12', 'k\\zeta_t')
('12', '\\begin{aligned}\n\\label{eq: descent_correct}\n    \\mathbb E_{W_t \\sim \\tilde{p}} [\\langle \\nabla f(x_t),g_t \\rangle] \\geq \\|\\nabla f(x_t)\\| \\min\\left\\{\\frac{3}{4}c, \\|\\nabla f(x_t)\\| \\right\\}\\mathbb P (\\|k\\zeta_t\\| \\leq \\frac{c}{4})\n\\end{aligned}')
('12', 'b_t')
('12', '\\begin{aligned}\n\\label{eq: bias_reduce}\n    |b_t| \\leq   \\|\\nabla f(x_t)\\| c  \\int |p_t(\\xi_t)-\\tilde{p_t}( \\xi_t)| d\\xi_t \\leq \\|\\nabla f(x_t)\\|  \\frac{c}{2} \\frac{\\sigma_{\\xi_t}^2}{k^2} q = O(\\frac{\\sigma_{\\xi_t}^2}{k^2})\n\\end{aligned}')
('14', '\\mathbb P (\\|\\xi_t\\| \\leq \\frac{1}{4}c)')
('14', 'p')
('14', '\\tilde p')
('14', '\\mathbb P (\\|\\xi_t\\| \\leq \\frac{1}{4}c) \\geq l')
('14', 'l >0')
('14', 'p')
('14', '\\frac{c}{4}')
('14', '\\mathbb P_{\\xi_t \\sim \\tilde p} (\\|\\xi_t\\| \\leq \\frac{1}{4}c)')
('14', '\\mathbb P_{\\xi_t \\sim \\tilde p} (\\|\\xi_t\\| \\leq zc)')
('14', 'z < 1')
('14', '\\frac{3}{4}c')
('14', '(1-z)c')
('15', 'k\\zeta_t')
('15', '\\mathbb P(\\|k\\zeta_t\\|<\\frac{c}{4})')
('15', 'k')
('15', 'd=1')
('15', '\\mathbb P(\\|k\\zeta_t\\|<\\frac{c}{4}) = \\textrm{erf}(\\frac{c}{4k})')
('15', 'O(\\frac{1}{k})')
('15', 'O(\\frac{1}{k^2})')
('15', 'k')
('15', 'k\\zeta_t')
('15', 'k\\zeta_t')
('15', 'W_t \\triangleq \\xi_t + k\\zeta_t')
('15', 'k')
('15', 'W_t')
('15', 'k\\zeta_t')
('15', 'O(\\frac{1}{k^2})')
('15', 'E_{\\xi_t=0, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('15', '\\tilde p')
('15', 'k\\zeta_t')
('15', 'd > 1')
('15', '\\mathbb P(\\|k\\zeta_t\\|<\\frac{c}{4})')
('15', 'k')
('15', 'd')
('15', 'E_{\\xi_t \\sim {p}, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('15', 'O(1/d)')
('15', 'O(1/k)')
('15', '\\|\\nabla f(x_t)\\|')
('15', '\\xi_t=0')
('15', '\\|\\nabla f(x_t)\\| = 10')
('15', 'E_{\\xi_t =0, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('15', '10^5')
('15', '\\zeta_t \\sim \\mathcal N(0,I)')
('15', 'd=1')
('15', '\\xi_t \\sim \\mathcal N (0,1)')
('15', 'c=1')
('15', '\\mathbb E_{\\xi_t \\sim \\tilde{p}}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('15', '10^5')
('15', '\\|\\nabla f(x_t)\\|')
('15', '\\tilde p( \\xi_t)')
('15', '\\mathcal N(0,  I)')
('15', 'E_{\\xi_t =0, \\zeta_t}[\\langle \\nabla f(x_t), g_t \\rangle ]')
('15', 'd')
('15', 'k')
('15', 'd=1')
('15', 'd=10')
('15', 'd=100')
('15', 'd=1000')
('15', 'd=10000')
('15', 'k=1')
('15', 'k=10')
('15', 'k=100')
('15', 'k=1000')
('15', '\\|\\nabla f(x_t)\\|')
('15', '\\mathbb E_{\\xi_t \\sim \\mathcal N(0,1)}[\\langle \\nabla f(x_t), g_t \\rangle ]')
