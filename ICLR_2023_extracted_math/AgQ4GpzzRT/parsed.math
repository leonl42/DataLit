('1', 'q')
('1', 'k_j')
('1', '\\label{def:loss-intro}\n    \\mathcal{L} = - \\mathbb{E}\\Biggl[\\log \\frac{\\exp(q^{\\top}k_0)}{\\sum_{j=0}^k\\exp(q^{\\top}k_{j})}\\Biggr]')
('1', 'q = f^q(\\mathbf{x})')
('1', '\\mathbf{x}')
('1', 'k_0 = f^k(\\mathbf{x}^{+})')
('1', '\\mathbf{x}^{+}')
('1', 'k_j = f^k(\\mathbf{x}_j)')
('1', '\\{\\mathbf{x}_j\\}_{j=1}^k')
('1', 'f^q')
('1', 'f^k')
('1', 'q')
('1', 'k_0')
('1', 'f^q')
('1', 'f^k')
('1', 'm')
('2.0', 'f(\\mathbf{x})^{\\top}\\theta')
('2.0', '76\\%')
('3.0', '[n] = \\{1,\\dots,n\\}')
('3.0', 'S = \\{\\mathbf{x}_i\\}_{i=1}^n')
('3.0', 'S^{\\setminus i} = S \\setminus \\{\\mathbf{x}_i\\}')
('3.0', '\\mathbf{x}_i')
('3.0', '\\mathcal{N}(0,\\mathbf{I}_m)')
('3.0', 'm')
('3.0', '\\mathbf{v}= (v_1,\\dots,v_m)^{\\top} \\in \\mathbb{R}^m')
('3.0', '\\|v\\|_2 = (\\sum_{i=1}^m v_i^2)^{1/2}')
('3.0', '\\ell_2')
('3.0', '\\mathbf{A}= (a_{i,j})_{m\\times n}')
('3.0', '\\|\\mathbf{A}\\|_0')
('3.0', '\\mathbf{A}')
('3.0', '\\|\\mathbf{A}\\|_2')
('3.0', '\\mathbf{A}=(a_{ij})_{m\\times n},\\, \\mathbf{B}= (b_{ij})_{m \\times n}')
('3.0', '\\langle \\mathbf{A},\\mathbf{B}\\rangle = \\langle \\mathbf{A},\\mathbf{B}\\rangle_F = \\text{tr}(\\mathbf{A}^{\\top}\\mathbf{B}) = (\\sum_{i,j}a_{ij}b_{ij})^{1/2}')
('3.0', '\\|\\mathbf{A}\\|_F = \\sqrt{\\langle \\mathbf{A},\\mathbf{A}\\rangle}')
('3.0', '\\mathbf{A}')
('3.0', '\\mathbf{W}= (\\mathbf{W}_0,\\dots,\\mathbf{W}_L)')
('3.0', "\\mathbf{W}' = (\\mathbf{W}_0,\\dots,\\mathbf{W}_L)\\in \\mathcal{W}")
('3.0', '\\mathcal{W} := \\mathbb{R}^{m\\times \\mathfrak{b}}\\times \\mathbb{R}^{(m\\times m)\\cdot(L-1)}\\times \\mathbb{R}^{d\\times m}')
('3.0', "\\langle \\mathbf{W},\\mathbf{W}'\\rangle:= \\sum_{l=0}^L \\langle \\mathbf{W}_l,\\mathbf{W}'_l\\rangle")
('3.0', '\\|\\mathbf{W}\\|_F = \\sqrt{\\langle \\mathbf{W},\\mathbf{W}\\rangle}')
('3.0', 'O(\\cdot),\\Omega(\\cdot)')
('3.0', '\\Theta(\\cdot)')
('3.1', 'f^q_{\\mathbf{W}}')
('3.1', 'f^k_{\\theta}')
('3.1', '(L+1)')
('3.1', 'f^q_{\\mathbf{W}}')
('3.1', 'f^k_{\\theta}')
('3.1', '\\begin{aligned}\n        f^q_{\\mathbf{W}}(\\mathbf{x}) = \\mathbf{W}_{L}\\sigma(\\cdots\\sigma(\\mathbf{W}_1\\sigma(\\mathbf{W}_0\\mathbf{x}))),\\qquad f^k_{\\theta}(\\mathbf{x}) = \\theta_{L}\\sigma(\\cdots\\sigma(\\theta_1\\sigma(\\theta_0\\mathbf{x})))\n    \n\\end{aligned}')
('3.1', '\\sigma(\\cdot)')
('3.1', '\\mathbf{W}_L,\\theta_L \\in \\mathbb{R}^{d\\times m}')
('3.1', '\\theta_l, \\mathbf{W}_l \\in \\mathbb{R}^{m\\times m}')
('3.1', '1 \\leq l \\leq L-1')
('3.1', '\\mathbf{W}_0, \\theta_0 \\in \\mathbb{R}^{m\\times \\mathfrak{b}}')
('3.1', '\\mathfrak{b}')
('3.1', 'd')
('3.1', '\\mathbf{W}= (\\mathbf{W}_l)_{l=0}^L')
('3.1', '\\theta = (\\theta_l)_{l=0}^L')
('3.1', '\\mathbf{W},\\theta')
('3.1', '(\\mathbf{W}_0)_{i,j},(\\theta_0)_{i,j} \\stackrel{\\text{i.i.d.}}\\sim \\mathcal{N}\\bigl(0,\\frac{2}{m}\\bigr)')
('3.1', '(i,j)\\in [m]\\times [\\mathfrak{b}]')
('3.1', '(\\mathbf{W}_l)_{i,j},(\\theta_l)_{i,j} \\stackrel{\\text{i.i.d.}}\\sim \\mathcal{N}\\bigl(0,\\frac{2}{m}\\bigr)')
('3.1', '(i,j)\\in [m]\\times [m]')
('3.1', 'l \\in [L-1]')
('3.1', '(\\mathbf{W}_L)_{i,j},(\\theta_L)_{i,j} \\stackrel{\\text{i.i.d.}}\\sim \\mathcal{N}\\bigl(0,\\frac{1}{d}\\bigr)')
('3.1', '(i,j)\\in [d]\\times [m]')
('3.1', 'k')
('3.1', '\\mathbf{x}_i \\in S')
('3.1', '\\mathbf{x}_{i,1},\\dots,\\mathbf{x}_{i,k} \\in S^{\\setminus i}')
('3.1', 'f^q_{\\mathbf{W}}')
('3.1', 'f^k_{\\theta}')
('3.1', 'q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('3.1', 'k_{i,0}=f^k_{\\theta}(\\mathbf{x}_i)')
('3.1', '\\ k_{i,j} = f^k_{\\theta}(\\mathbf{x}_{i,j})')
('3.1', '\\mathbf{x}_i')
('3.1', '\\{\\mathbf{x}_{i,j}\\}_{j=1}^k')
('3.1', '\\begin{aligned}\n\\label{def:loss-function-specific}\n        \\ell(f^q_{\\mathbf{W}},f^k_{\\theta},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) = - \\log \\Biggl[\\frac{\\exp( q_i^{\\top} k_{i,0} )}{\\sum_{j=0}^k \\exp(q_i^{\\top} k_{i,j})}\\Biggr]\n    \n\\end{aligned}')
('3.1', '(k+1)')
('3.1', 'q_i')
('3.1', 'k_{i,0}')
('3.1', '\\begin{aligned}\n\\label{def:loss-function-total}\n        L_S(\\mathbf{W}, \\theta) = \\frac{1}{n}\\sum_{i=1}^n \\mathbb{E}^{Neg(i)}\\bigl[ \\ell(f^q_{\\mathbf{W}},f^k_{\\theta}, \\mathbf{x}_i, \\{\\mathbf{x}_{i,j}\\}_{j=1}^k)\\bigr]\n    \n\\end{aligned}')
('3.1', '\\mathbb{E}^{Neg(i)}')
('3.1', '\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset S^{\\setminus i}')
('3.1', 'S = \\{\\mathbf{x}_i\\}_{i=1}^n')
('3.1', '\\eta, \\gamma')
('3.1', 'T')
('3.1', '\\mathbf{W}^{(0)},\\theta^{(0)}')
('3.1', '\\mathbf{W}^{(t+1)} = \\mathbf{W}^{(t)} - \\eta \\nabla_{\\mathbf{W}} L_S(\\mathbf{W}^{(t)},\\theta^{(t)})')
('3.1', '\\theta^{(t+1)} = \\theta^{(t)} - \\gamma \\nabla_{\\theta} L_S(\\mathbf{W}^{(t)},\\theta^{(t)})')
('3.1', '\\{\\mathbf{W}^{(t)},\\theta^{(t)}\\}_{t=0}^T')
('3.2', '1')
('3.2', '\\|\\cdot\\|_2')
('3.2', '\\mathbf{x}_i \\in S')
('3.2', '\\|\\mathbf{x}_i\\|_2 = 1')
('3.2', '\\mathbf{x}_i')
('3.2', '1')
('3.2', 'c_1 \\leq \\|\\mathbf{x}_i\\|\\leq c_2')
('3.2', 'c_2 > c_1 > 0')
('3.2', '\\delta > 0')
('3.2', 'i,j \\in [n]')
('3.2', 'i\\neq j')
('3.2', '\\|\\mathbf{x}_i - \\mathbf{x}_j\\|_2 \\geq \\delta')
('3.2', '\\lambda_{\\min}(\\mathbf{K}^{(L)}) > 0')
('3.2', '\\mathbf{K}^{(L)}')
('4', '\\textbf{loss}')
('4', 'q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('4', 'k_i = f^k_{\\theta}(\\mathbf{x}_i)')
('4', '\\begin{aligned}\n        \\widetilde{\\textbf{loss}}= (\\widetilde{\\textbf{loss}}_i)_{i=1}^n = \\bigl(\\partial L_S/ \\partial q_i\\bigr)_{i \\in [n]}, \\qquad \\widehat{\\textbf{loss}}= (\\widehat{\\textbf{loss}}_i)_{i=1}^n = \\bigl(\\partial L_S/\\partial k_i\\bigr)_{i \\in [n]}\n    \n\\end{aligned}')
('4', '\\textbf{loss}= (\\widetilde{\\textbf{loss}},\\widehat{\\textbf{loss}})')
('4', '\\varepsilon \\in (0,1)')
('4', '\\delta \\leq O(1/L)')
('4', '\\begin{aligned}\n        m &\\geq \\Omega\\bigl(n^{15}L^{12}(\\log m)^5\\delta^{-5}\\varepsilon^{-2}\\bigr) \\quad d\\geq\\Omega(\\log^2 m)\n    \n\\end{aligned}')
('4', '\\eta,\\gamma = \\Theta( d\\varepsilon^2\\delta^2/(n^{7}L^2km))')
('4', '1 - O(m^{-1})')
('4', '\\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\textbf{loss}^{(t)}\\|_2 \\leq \\varepsilon \\quad \\text{for }T = \\Theta\\biggl(\\frac{n^{10}L^{2}k}{\\delta^3}\\cdot \\frac{1}{\\varepsilon^4}\\biggr)')
('4', '\\textbf{loss}^{(t)}')
('4', 'f^q')
('4', 'f^k')
('4', '\\mathbf{W}^{(t)}')
('4', '\\theta^{(t)}')
('4', '\\mathbf{W}')
('4', '\\|\\nabla_f L_S\\| \\leq \\varepsilon')
('4', 'd')
('4', '\\Theta(\\log^2 m)')
('4', 'q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('4', 'k_{j} = f^k_{\\theta}(\\mathbf{x}_j)')
('4', 'd')
('4.0', '\\mathbf{W}')
('4.0', '\\theta')
('4.0', '\\omega, \\tau \\leq O(\\delta^{3/2}/(n^{3}L^6\\log^{3/2} m))')
('4.0', '1 - e^{-\\Omega(m\\omega^{3/2}L)} - e^{-\\Omega(m\\tau^{3/2}L)}')
('4.0', '\\mathbf{W}\\in B(\\mathbf{W}^{(0)},\\omega)')
('4.0', '\\theta\\in B(\\theta^{(0)},\\tau)')
('4.0', '\\|\\nabla_\\mathbf{W}L_S(\\mathbf{W},\\theta)\\|_F')
('4.0', '\\begin{aligned}\n            \\bigl\\| \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta)\\bigr\\|_F^2 &\\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n\\|\\widetilde{\\textbf{loss}}_i\\|_2^2 \\\\\n            \\bigl\\| \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta)\\bigr\\|_F^2 &\\leq O\\biggl(\\frac{Lm}{nd}\\biggr)\\sum_{i=1}^n\\|\\widetilde{\\textbf{loss}}_i\\|_2^2\n        \n\\end{aligned}')
('4.0', '\\|\\nabla_{\\theta}L_S(\\mathbf{W},\\theta)\\|_F')
('4.0', '\\begin{aligned}\n            \\bigl\\|\\nabla_{\\theta} L_S(\\mathbf{W},\\theta)\\bigr\\|_F^2 &\\geq \\Omega\\biggl(\\frac{m\\delta}{n^3 d}\\biggr)\\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2 \\\\\n             \\bigl\\|\\nabla_{\\theta} L_S(\\mathbf{W},\\theta)\\bigr\\|_F^2 &\\leq O\\biggl(\\frac{Lm}{nd}\\biggr) \\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2\n        \n\\end{aligned}')
('4.0', '\\widetilde{\\textbf{loss}}')
('4.0', '\\widehat{\\textbf{loss}}')
('4.0', 'f^q_{\\mathbf{W}}')
('4.0', 'f^k_{\\theta}')
('4.0', '\\widetilde{\\textbf{loss}}=(\\partial L_S/\\partial q_i)_{i=1}^n')
('4.0', '\\widehat{\\textbf{loss}}= (\\partial L_S/\\partial k_i)_{i=1}^n')
('4.0', "\\|\\mathbf{W}'\\|_2\\leq \\omega")
('4.0', "\\|\\theta'\\|_2\\leq \\tau")
('4.0', '\\omega, \\tau\\in [\\Omega(\\sqrt{d/m}),\\ O(1/ (L^{9/2} (\\log m)^{3/2}) )]')
('4.0', '\\mathbf{W}\\in B(\\mathbf{W}^{(0)},\\omega),\\theta \\in B(\\theta^{(0)},\\tau)')
('4.0', "\\mathbf{W}+ \\mathbf{W}' \\in B(\\mathbf{W}^{(0)},\\omega),\\quad \\theta + \\theta' \\in B(\\theta^{(0)},\\tau)")
('4.0', '1 - \\exp({-\\Omega(m\\omega^{3/2}L)})-\\exp({-\\Omega(m\\tau^{2/3}L)})')
('4.0', "\\begin{aligned}\n\\label{ineq:semi-smoothness}\n        \\begin{split}\n        L_S(\\mathbf{W}+ \\mathbf{W}',\\theta + \\theta')\\leq\\ &  L_S(\\mathbf{W},\\theta) + \\langle \\nabla_{(\\mathbf{W},\\theta)} L_S(\\mathbf{W},\\theta),(\\mathbf{W}', \\theta')\\rangle\\\\\n        & + O\\biggl(\\frac{\\omega^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr) \\|\\widetilde{\\textbf{loss}}\\|_2\\cdot\\|\\mathbf{W}'\\|_F \\\\\n        &+ O\\biggl(\\frac{\\tau^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr)\\|\\widehat{\\textbf{loss}}\\|_2\\cdot\\|\\theta'\\|_F\\\\\n        & + O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\Bigl(\\tau^2\\|\\mathbf{W}'\\|_F^2+\\omega^2\\|\\theta'\\|_F^2\\Bigr)\n        \\end{split}\n    \n\\end{aligned}")
('5.0', '\\begin{aligned}\n \\label{notation:query-key}\n    \\begin{split}\n    q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i),\\quad z_{j} = f^k_{\\theta}(\\mathbf{x}_{j}) - f^k_{\\theta}(\\mathbf{x}_i), \\quad z_{i,j} = f^k_{\\theta}(\\mathbf{x}_{i,j}) - f^k_{\\theta}(\\mathbf{x}_i)    \n    \\end{split}\n\\end{aligned}')
('5.0', '\\widetilde{\\textbf{loss}}')
('5.0', '\\widetilde{\\textbf{loss}}')
('5.0', 'i \\in [n]')
('5.0', '\\widetilde{\\textbf{loss}}_i')
('5.0', 'L_S(\\mathbf{W},\\theta)')
('5.0', 'q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('5.0', '\\begin{aligned}\n        \\widetilde{\\textbf{loss}}_i &= \\partial L_S/\\partial q_i = \\mathbb{E}^{Neg(i)}\\biggl[\\sum_{j=1}^k\\frac{\\exp(q_i^{\\top}z_{i,j})}{1 + \\sum_{s=1}^j\\exp(q_i^{\\top}z_{i,j})}\\cdot z_{i,j}\\biggr]\n    \n\\end{aligned}')
('5.0', '\\mathbb{E}^{Neg(i)}')
('5.0', '\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset S^{\\setminus i}')
('5.0', '\\widehat{\\textbf{loss}}')
('5.0', '\\widehat{\\textbf{loss}}')
('5.0', '(i,j) \\in [n]\\times[n]')
('5.0', 'i\\neq j')
('5.0', '\\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j)')
('5.0', '\\begin{aligned}\n        &\\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j) :=  \\frac{1}{\\binom{n-1}{k}}\\sum_{\\mathbf{x}_j \\in \\{\\mathbf{x}_{i,s}\\}_{s\\in [k]} \\subset S^{\\setminus i} } \\frac{\\exp(q_i^{\\top}z_{j})}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top} z_{i,s})}\\cdot q_i\n    \n\\end{aligned}')
('5.0', 'q_i,z_j,z_{i,s}')
('5.0', '\\{\\mathbf{x}_{i,s}\\}_{s=1}^k \\subset S^{\\setminus i}')
('5.0', '\\mathbf{x}_j')
('5.0', '\\widehat{\\textbf{loss}}_i')
('5.0', '\\begin{aligned}\n        \\widehat{\\textbf{loss}}_i &= \\partial L_S/\\partial k_i = \\sum_{j\\neq i}(\\textbf{loss}(\\mathbf{x}_j,\\mathbf{x}_i) - \\textbf{loss}(\\mathbf{x}_i,\\mathbf{x}_j))\n    \n\\end{aligned}')
('5.1', '\\begin{aligned}\n    \\mathbf{h}^q_{i,0} = \\sigma(\\mathbf{W}_0 \\mathbf{x}_i)\\quad \\mathbf{h}^q_{i,l} = \\sigma(\\mathbf{W}_l \\mathbf{h}^q_{i,l-1}) \\quad \\mathbf{h}^k_{i,0} = \\sigma(\\theta_0 \\mathbf{x}_i)\\quad \\mathbf{h}^k_{i,l} = \\sigma(\\theta_l \\mathbf{h}^q_{i,l-1})\n\\end{aligned}')
('5.1', '\\mathbf{D}^q_{i,l}')
('5.1', '\\mathbf{D}^k_{i,l}')
('5.1', '\\begin{aligned}\n    (\\mathbf{D}^q_{i,l})_{a,a}:= \\mathds{1}\\{\\sigma(\\mathbf{W}_l \\mathbf{h}^q_{i,l-1})_{a}\\geq 0\\} \\qquad (\\mathbf{D}^k_{i,l})_{a,a}&:= \\mathds{1}\\{\\sigma(\\theta_l \\mathbf{h}^k_{i,l-1})_{a}\\geq 0\\}\n\\end{aligned}')
('5.1.0', '\\text{Back}^q_{i,l}')
('5.1.0', '\\text{Back}^k_{i,l}')
('5.1.0', '\\begin{aligned}\n    &\\text{Back}^q_{i,l} = \\mathbf{W}_L \\mathbf{D}_{i,L-1}\\cdots \\mathbf{D}_{i,l}\\mathbf{W}_l, \\qquad \\text{Back}^k_{i,l} = \\theta_L \\mathbf{D}_{i,L-1}\\cdots \\mathbf{D}_{i,l}\\theta_l\n\\end{aligned}')
('5.1.0', '\\nabla_{\\mathbf{W}_l}L_S(\\mathbf{W},\\theta)')
('5.1.0', '\\nabla_{\\theta_l}L_S(\\mathbf{W},\\theta)')
('5.1.0', '\\begin{aligned}\n    &\\nabla_{\\mathbf{W}_l}L_S(\\mathbf{W},\\theta) = \\frac{1}{n}\\sum_{i=1}^n \\mathbf{D}_{i,l}^q\\Bigl((\\text{Back}_{i,l+1}^q)^{\\top}\\widetilde{\\textbf{loss}}_i\\Bigr)\\mathbf{h}_{i,l-1}^{q,\\top} \\\\\n    &\\nabla_{\\theta_l} L_S(\\mathbf{W},\\theta) = \\frac{1}{n}\\sum_{i=1}^n  \\mathbf{D}_{i,l}^k\\Bigl((\\text{Back}_{i,l+1}^k)^{\\top} \\widehat{\\textbf{loss}}_i \\Bigr) \\mathbf{h}_{i,l-1}^{k,\\top}\n\\end{aligned}')
('5.1.0', '(\\text{Back}_{i,l+1}^q)^{\\top}\\widetilde{\\textbf{loss}}_i')
('5.1.0', '\\sim \\sqrt{m/d}\\|\\widetilde{\\textbf{loss}}_i\\|_2')
('5.1.0', '(\\text{Back}_{i,l+1}^k)^{\\top} \\widehat{\\textbf{loss}}_i')
('5.1.0', '\\|(\\text{Back}_{i,l+1}^q)^{\\top}\\widetilde{\\textbf{loss}}_i\\|_2 \\leq O(\\sqrt{m/d})\\|\\widetilde{\\textbf{loss}}_i\\|_2')
('5.1.0.0', '\\ell(f^q_{\\mathbf{W}},f^k_{\\theta},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)')
('5.1.0.0', '\\begin{aligned}\n    &\\ell(f^q_{\\mathbf{W}},f^k_{\\theta},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) =  \\log \\biggl[ 1 + \\sum_{j=1}^k \\exp(q_i^{\\top}z_{i,j}) \\biggr]\n\\end{aligned}')
('5.1.0.0', 'q_i,z_{i,j}')
('5.1.0.0', 'q_i^{\\top}z_{i,j}')
('5.1.0.0', '1')
('5.1.0.0', 'q_i^{\\top}z_{i,j}')
('5.1.0.0', '\\begin{aligned}\n    &\\ell(f^q_{\\widetilde{\\mathbf{W}}},f^k_{\\widetilde{\\theta}},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) \\leq \\ell(f^q_{\\mathbf{W}},f^k_{\\theta},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) \\\\\n    & \\qquad + \\underbrace{\\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot \\bigl( \\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j} \\bigr)}_{\\text{\\ding{172}}} + \\underbrace{\\frac{1}{2} \\sum_{j=1}^k (\\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j})^2}_{\\text{\\ding{173}}}\n\\end{aligned}')
('5.1.0.0', '\\tilde{q}_i, \\tilde{z}_{i,j}')
('5.1.0.0', 'q_i,z_{i,j}')
('5.1.0.0', "\\widetilde{\\mathbf{W}} = \\mathbf{W}+ \\mathbf{W}'")
('5.1.0.0', "\\widetilde{\\theta}=\\theta + \\theta'")
('5.1.0.0', '\\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j}')
('5.1.0.0', '\\underbrace{(\\tilde{q}_i - q_i)^{\\top}z_{i,j}}_{\\text{\\ding{174}}} +  \\underbrace{q_i^{\\top}(\\tilde{z}_{i,j} - z_{i,j})}_{\\text{\\ding{175}}} + \\underbrace{(\\tilde{q}_i - q_i)^{\\top}(\\tilde{z}_{i,j} - z_{i,j})}_{\\text{\\ding{176}}}')
('5.1.0.0', '\\frac{1}{n}\\sum_{i=1}^n \\langle \\widetilde{\\textbf{loss}}_i,\\tilde{q}_i - q_i\\rangle')
('5.1.0.0', '\\frac{1}{n}\\sum_{i=1}^n \\langle \\widehat{\\textbf{loss}}_i,\\tilde{k}_i - k_i\\rangle')
('5.1.0.0', '\\tilde{k}_i = f^k_{\\widetilde{\\theta}}(\\mathbf{x}_i)')
('5.1.0.0', 'k_i = f^k_{\\theta}(\\mathbf{x}_i)')
('5.1.0.0', '+')
('5.1.0.0', '+')
('5.1.0.0', 'O(kL^2m^2/d^2)\\cdot (\\tau^2\\|\\widetilde{\\mathbf{W}}-\\mathbf{W}\\|_2^2 + \\omega^2\\|\\widetilde{\\theta}-\\theta\\|_2^2)')
('5.1.0.0', 'f^q_{\\widetilde{\\mathbf{W}}}(\\mathbf{x}) - f^q_{\\mathbf{W}}(\\mathbf{x})')
('5.1.0.0', 'f^k_{\\widetilde{\\theta}}(\\mathbf{x}) - f^k_{\\theta}(\\mathbf{x})')
('5.1.0.0', "f^q_{\\widetilde{\\mathbf{W}}}(\\mathbf{x}) - f^q_{\\mathbf{W}}(\\mathbf{x}) - \\nabla_{\\mathbf{W}} f^q_{\\mathbf{W}}(\\mathbf{x})(\\mathbf{W}')")
('5.1.0.0', "\\begin{aligned}\n    &\\frac{1}{n}\\sum_{i=1}^n \\langle \\widetilde{\\textbf{loss}}_i,\\tilde{q}_i - q_i\\rangle - \\langle \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta),\\mathbf{W}'\\rangle\\leq  \\|\\widetilde{\\textbf{loss}}\\|_2\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr)\\|\\mathbf{W}'\\|_F\n\\end{aligned}")
('5.1.0.0', 'f^k_{\\theta}(\\cdot)')
('5.2', '\\omega, \\tau = O\\bigl(n^{3.5}\\sqrt{d}/(\\delta\\varepsilon\\sqrt{m})\\bigr)')
('5.2', '\\mathbf{W}^{(t)},\\theta^{(t)}')
('5.2', '\\mathbf{W}^{(t)} \\in B(\\mathbf{W}^{(0)},\\omega),\\, \\theta^{(t)} \\in B(\\theta^{(0)},\\tau)')
('5.2', 't')
('5.2', '\\nabla_{\\mathbf{W},t} = \\nabla_{\\mathbf{W}}L_S(\\mathbf{W}^{(t)},\\theta^{(t)}),\\ \\nabla_{\\theta,t} = \\nabla_{\\theta}L_S(\\mathbf{W}^{(t)},\\theta^{(t)})')
('5.2', '\\omega, \\tau, \\eta, \\gamma')
('5.2', '\\begin{aligned}\n        L_S(\\mathbf{W}^{(t+1)},\\theta^{(t+1)}) \\leq & L_S(\\mathbf{W}^{(t)},\\theta^{(t)}) -\\Omega(\\eta)\\|\\nabla_{\\mathbf{W},t}\\|_F^2 -\\Omega(\\gamma)\\|\\nabla_{\\theta,t}\\|_F^2\\\\\n        & + O\\biggl(\\frac{\\omega^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr) \\|\\widetilde{\\textbf{loss}}\\|_2\\cdot\\eta\\|\\nabla_{\\mathbf{W},t}\\|_F \\\\\n        &+ O\\biggl(\\frac{\\tau^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr)\\|\\widehat{\\textbf{loss}}\\|_2\\cdot\\gamma\\|\\nabla_{\\theta,t}\\|_F\n    \n\\end{aligned}')
('5.2', '\\omega, \\tau')
('5.2', '\\begin{aligned}\n        L_S(\\mathbf{W}^{(t+1)},\\theta^{(t+1)})\\leq & L_S(\\mathbf{W}^{(t)},\\theta^{(t)}) -\\Omega\\biggl(\\frac{\\eta \\delta m}{n^3 d}\\biggr)\\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2^2 -\\Omega\\biggl(\\frac{\\gamma \\delta m}{n^3 d}\\biggr)\\|\\widehat{\\textbf{loss}}^{(t)}\\|_2^2\\\\\n        \\leq & - \\Omega\\biggl(\\frac{ \\delta m}{n^3 d}\\min(\\eta,\\gamma)\\biggr)\\|\\textbf{loss}^{(t)}\\|_2^2\n    \n\\end{aligned}')
('5.2', '\\textbf{loss}')
('5.2', 't = 0,\\dots,T-1')
('5.2', '\\eta, \\gamma')
('5.2', '\\begin{aligned}\n        \\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\textbf{loss}^{(t)}\\|_2 & \\leq O\\biggl(\\sqrt{\\frac{n^3d}{T\\min(\\eta,\\gamma)\\delta m}}\\biggr)\\cdot \\sqrt{L_S(\\mathbf{W}^{(0)},\\theta^{(0)}) - L_S(\\mathbf{W}^{(T)},\\theta^{(T)})}\\\\\n        & \\leq \\frac{1}{\\sqrt{T}}\\cdot O\\biggl(\\frac{n^{5}L\\sqrt{k}}{\\delta^{3/2}\\varepsilon}\\biggr)\n    \n\\end{aligned}')
('5.2', 'T = \\Theta(n^{10}L^2k/(\\delta^3\\varepsilon^4))')
('5.2', '\\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\textbf{loss}^{(t)}\\|_2 \\leq \\varepsilon')
('5.2', '\\mathbf{W}^{(t)}')
('5.2', '\\theta^{(t)}')
('5.2', 'B(\\mathbf{W}^{(0)},\\omega)')
('5.2', 'B(\\theta^{(0)},\\tau)')
('5.2', 'm \\geq \\Omega(n^{12}L^{12}(\\log m)^5 /(\\delta^5 \\varepsilon^2))')
('7', '\\textbf{loss}')
('7', 'i \\in [n]')
('7', '\\begin{aligned}\n        \\widetilde{\\textbf{loss}}= (\\widetilde{\\textbf{loss}}_i)_{i=1}^n = \\bigl(\\partial L_S/\\partial q_i)\\bigr)_{i \\in [n]}  ,\\qquad \\widehat{\\textbf{loss}}= (\\widehat{\\textbf{loss}}_i)_{i=1}^n = \\bigl(\\partial L_S/\\partial k_i\\bigr)_{i \\in [n]}\n    \n\\end{aligned}')
('7', '\\textbf{loss}= (\\widetilde{\\textbf{loss}},\\widehat{\\textbf{loss}})')
('7', '\\varepsilon \\in (0,1)')
('7', '\\delta \\in (0,O(L^{-1}))')
('7', 'm \\geq \\Omega\\bigl(n^{12}L^{12}(\\log m)^5\\delta^{-5}\\varepsilon^{-2}\\bigr),\\qquad \\eta,\\gamma = \\Theta( d\\varepsilon^2\\delta^2/(n^{7}L^2km)), \\qquad d\\geq\\Omega(\\log^2 m)')
('7', 't = 0,1,\\dots,T-1')
('7', '1 - O(m^{-1})')
('7', '\\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\textbf{loss}^{(t)}\\|_2 \\leq \\varepsilon \\quad \\text{for }T = \\Theta\\biggl(\\frac{n^{10}L^{2}k}{\\delta^3}\\cdot \\frac{1}{\\varepsilon^4}\\biggr) \\text{ iterations}')
('7', '\\textbf{loss}^{(t)}')
('7', 'f^q')
('7', 'f^k')
('7', '\\mathbf{W}^{(t)}')
('7', '\\theta^{(t)}')
('7.0', '\\omega, \\tau \\leq O(\\delta^{3/2}/(n^{3}L^6(\\log m)^{3/2}))')
('7.0', '1 - e^{-\\Omega(m\\omega^{3/2}L)} - e^{-\\Omega(m\\tau^{3/2}L)}')
('7.0', '\\mathbf{W}\\in B(\\mathbf{W}^{(0)},\\omega)')
('7.0', '\\theta\\in B(\\theta^{(0)},\\tau)')
('7.0', '\\|\\nabla_\\mathbf{W}L_S(\\mathbf{W},\\theta)\\|_F')
('7.0', '\\begin{aligned}\n            \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n\\|\\widetilde{\\textbf{loss}}_i\\|_2^2 \\leq \\Bigl\\| \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta)\\Bigr\\|_F^2 \\leq O\\biggl(\\frac{Lm}{nd}\\biggr)\\sum_{i=1}^n\\|\\widetilde{\\textbf{loss}}_i\\|_2^2\n        \n\\end{aligned}')
('7.0', '\\|\\nabla_{\\theta}L_S(\\mathbf{W},\\theta)\\|_F')
('7.0', '\\begin{aligned}\n            \\Omega\\biggl(\\frac{m\\delta}{n^3 d}\\biggr)\\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2 \\leq \\Bigl\\|\\nabla_{\\theta} L_S(\\mathbf{W},\\theta)\\Bigr\\|_F^2 \\leq O\\biggl(\\frac{Lm}{nd}\\biggr) \\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2\n        \n\\end{aligned}')
('7.0', "\\|\\mathbf{W}'\\|_2\\leq \\omega")
('7.0', "\\|\\theta'\\|_2\\leq \\tau")
('7.0', '\\omega, \\tau\\in [\\Omega(\\sqrt{d/m}),\\ O(1/ (L^{9/2} (\\log m)^{3/2}) )]')
('7.0', '1 - e^{-\\Omega(m\\omega^{3/2}L)}-e^{-\\Omega(m\\tau^{2/3}L)}')
('7.0', "\\begin{aligned}\n            L_S(\\mathbf{W}+ \\mathbf{W}',\\theta + \\theta')\\leq\\ & L_S(\\mathbf{W},\\theta) + \\langle \\nabla_{\\mathbf{W}} L_S(\\mathbf{W},\\theta),\\mathbf{W}'\\rangle + \\langle \\nabla_{\\theta} L_S(\\mathbf{W},\\theta),\\theta'\\rangle\\\\\n            & + O\\biggl(\\frac{\\omega^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr) \\|\\widetilde{\\textbf{loss}}\\|_2\\cdot\\|\\mathbf{W}'\\|_F \\\\\n            &+ O\\biggl(\\frac{\\tau^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr)\\|\\widehat{\\textbf{loss}}\\|_2\\cdot\\|\\theta'\\|_F\\\\\n            & + O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\Bigl(\\tau^2\\|\\mathbf{W}'\\|_F^2+\\omega^2\\|\\theta'\\|_F^2\\Bigr)\n        \n\\end{aligned}")
('7.1', '\\label{eq:parameter-choice}\n        m \\geq \\Omega\\bigl(n^{12}L^{12}(\\log m)^5\\delta^{-5}\\varepsilon^{-2}\\bigr),\\qquad \\eta,\\gamma = \\Theta( d\\varepsilon^2\\delta^2/(n^{7}kL^2m)), \\qquad d\\geq\\Omega(\\log^2 m)')
('7.1', '\\omega, \\tau = O\\biggl(\\frac{n^{7/2}\\sqrt{d}}{\\delta\\varepsilon\\sqrt{m}}\\biggr)')
('7.1', '\\widetilde{\\textbf{loss}}^{(t)}, \\widehat{\\textbf{loss}}^{(t)}')
('7.1', '\\widetilde{\\textbf{loss}}')
('7.1', '\\widehat{\\textbf{loss}}')
('7.1', 'f^q_{\\mathbf{W}}')
('7.1', 'f^k_{\\theta}')
('7.1', '\\mathbf{W}^{(t)}')
('7.1', '\\theta^{(t)}')
('7.1', '\\mathbf{W}^{(t+1)} = \\mathbf{W}^{(t)} - \\eta \\nabla_{\\mathbf{W}}L_S(\\mathbf{W}^{(t)},\\theta^{(t)}),\\qquad \\theta^{(t+1)} = \\theta^{(t)} - \\gamma \\nabla_{\\theta}L_S(\\mathbf{W}^{(t)},\\theta^{(t)})')
('7.1', '\\nabla_{\\mathbf{W},t} =  \\nabla_{\\mathbf{W}}L_S(\\mathbf{W}^{(t)},\\theta^{(t)}) \\quad \\text{and} \\quad \\nabla_{\\theta, t} =  \\nabla_{\\theta}L_S(\\mathbf{W}^{(t)},\\theta^{(t)})')
('7.1', '\\begin{aligned}\n        L_S(\\mathbf{W}^{(t+1)}, \\theta^{(t+1)}) &\\leq L_S(\\mathbf{W}^{(t)},\\theta^{(t)}) - \\eta\\|\\nabla_{\\mathbf{W},t}\\|_F^2 - \\gamma\\|\\nabla_{\\theta,t}\\|_F^2\\\\\n        & \\quad + \\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m \\log m}}{\\sqrt{nd}}\\biggr)\\cdot\\|\\nabla_{\\mathbf{W},t}\\|_F\\\\\n        & \\quad + \\|\\widehat{\\textbf{loss}}^{(t)}\\|_2\\cdot O\\biggl(\\frac{\\tau^{1/3}L^2 \\sqrt{m \\log m}}{\\sqrt{nd}}\\biggr)\\cdot\\|\\nabla_{\\theta,t}\\|_F \\\\\n        & \\quad + O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\cdot\\Bigl(\\eta^2\\tau^2\\|\\nabla_{\\mathbf{W},t}\\|_2^2+ \\gamma^2 \\omega^2\\|\\nabla_{\\theta,t}\\|_F^2\\Bigr)\n    \n\\end{aligned}')
('7.1', '\\eta,\\gamma = \\Theta(d\\varepsilon^2 \\delta^2/(n^{7}L^2km))')
('7.1', '\\omega, \\tau = O(n^{7/2}\\sqrt{d}/(\\delta\\varepsilon\\sqrt{m}))')
('7.1', '\\begin{aligned}\n        L_S(\\mathbf{W}^{(t+1)}, \\theta^{(t+1)}) &\\leq L_S(\\mathbf{W}^{(t)},\\theta^{(t)}) - \\frac{3\\eta}{4}\\|\\nabla_{\\mathbf{W},t}\\|_F^2 - \\frac{3\\gamma}{4}\\|\\nabla_{\\theta,t}\\|_F^2\\\\\n        & \\quad + \\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m \\log m}}{\\sqrt{nd}}\\biggr)\\cdot\\|\\nabla_{\\mathbf{W},t}\\|_F\\\\\n        & \\quad + \\|\\widehat{\\textbf{loss}}^{(t)}\\|_2\\cdot O\\biggl(\\frac{\\tau^{1/3}L^2 \\sqrt{m \\log m}}{\\sqrt{nd}}\\biggr)\\cdot\\|\\nabla_{\\theta,t}\\|_F \\\\\n        & \\leq  - \\frac{3\\eta}{4}\\|\\nabla_{\\mathbf{W},t}\\|_F \\biggl(\\|\\nabla_{\\mathbf{W},t}\\|_F -  O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m \\log m}}{\\sqrt{nd}}\\biggr)\\cdot\\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2 \\biggr) \\\\\n        & \\quad - \\frac{3\\gamma}{4}\\|\\nabla_{\\theta,t}\\|_F \\biggl(\\|\\nabla_{\\theta,t}\\|_F - O\\biggl(\\frac{\\tau^{1/3}L^2 \\sqrt{m \\log m}}{\\sqrt{nd}}\\biggr)\\cdot\\|\\widehat{\\textbf{loss}}^{(t)}\\|_2\\biggr)\n    \n\\end{aligned}')
('7.1', '\\nabla_{\\mathbf{W},t} = \\nabla_{\\mathbf{W}}L_S(\\mathbf{W}^{(t)},\\theta^{(t)}),\\ \\nabla_{\\theta,t} = \\nabla_{\\theta}L_S(\\mathbf{W}^{(t)},\\theta^{(t)})')
('7.1', '\\|\\nabla_{\\mathbf{W},t}\\|_F^2 \\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2^2,\\qquad \\|\\nabla_{\\theta,t}\\|_F^2 \\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\|\\widehat{\\textbf{loss}}^{(t)}\\|_2^2')
('7.1', '\\omega,\\tau = O(\\delta^{3/2}/(n^{3}L^6(\\log m)^{3/2}))')
('7.1', '\\begin{aligned}\n        L_S(\\mathbf{W}^{(t+1)},\\theta^{(t+1)}) - L_S(\\mathbf{W}^{(t)},\\theta^{(t)}) &\\leq  -\\Omega\\biggl( \\frac{\\eta \\delta m}{n^3d}\\biggr) \\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2^2 - \\Omega \\biggl( \\frac{\\gamma \\delta m}{n^3 d}\\biggr)\\|\\widehat{\\textbf{loss}}^{(t)}\\|_2^2 \\\\\n        & \\leq -\\Omega\\biggl(\\frac{\\min(\\eta,\\gamma)\\delta m}{n^3d}\\biggr)\\|\\textbf{loss}^{(t)}\\|_2^2\n    \n\\end{aligned}')
('7.1', 't=0,\\dots,T-1')
('7.1', '\\begin{aligned}\n \\label{eq:convergence}\n        \\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\textbf{loss}^{(t)}\\|_2 \\leq O\\Biggl(\\sqrt{\\frac{n^3 d}{T\\min(\\eta,\\gamma) \\delta m}}\\Biggr) \\sqrt{L_S(\\mathbf{W}^{(0)},\\theta^{(0)})} \\stackrel{\\text{\\ding{172}}}\\leq O\\Biggl(\\sqrt{\\frac{n^4 d}{T\\min(\\eta,\\gamma) \\delta m}}\\Biggr)\n    \n\\end{aligned}')
('7.1', '1-O(n)e^{-\\Omega(d)}')
('7.1', '\\|f^q_{\\mathbf{W}^{(0)}}(\\mathbf{x}_i)\\|_2,\\ \\|f^k_{\\theta^{(0)}}(\\mathbf{x}_i)\\|_2 \\leq O(1)\\quad \\text{for all } i \\in [n] \\implies L_S(\\mathbf{W}^{(0)},\\theta^{(0)}) \\leq O(\\log k)\\leq O(n)')
('7.1', 'T\\min(\\eta,\\gamma) =\\Theta (n^3d/(m\\delta\\varepsilon^2))')
('7.1', '\\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\textbf{loss}^{(t)}\\|_2 \\leq \\varepsilon \\quad\\implies\\quad \\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2 \\leq \\varepsilon,\\quad \\frac{1}{T}\\sum_{t=0}^{T-1}\\|\\widehat{\\textbf{loss}}^{(t)}\\|_2 \\leq \\varepsilon')
('7.1', '\\eta')
('7.1', '\\gamma')
('7.1', 'T\\eta,\\ T\\gamma = \\Theta (n^3d/(m\\delta\\varepsilon^2))')
('7.1', '\\mathbf{W}')
('7.1', '\\begin{aligned}\n\\label{eq:trajectory}\n        \\begin{split}\n        \\|\\mathbf{W}^{(t)} - \\mathbf{W}^{(0)}\\|_F &\\leq \\sum_{t=0}^{T-1}\\eta \\|\\nabla_{\\mathbf{W},t}\\|_F \\leq  \\sum_{t=0}^{T-1}\\eta \\sqrt{Lm/d} \\cdot\\|\\widetilde{\\textbf{loss}}^{(t)}\\|_2 \\\\\n        &\\leq \\sqrt{T\\eta}\\cdot O\\biggl(\\sqrt{\\frac{Lm}{d}\\cdot \\frac{n^4d}{m\\delta}}\\biggr) \\leq O\\biggl(\\frac{n^{3.5}\\sqrt{d}}{\\delta\\varepsilon\\sqrt{m}}\\biggr) = \\omega    \n        \\end{split}\n    \n\\end{aligned}')
('7.1', '\\theta')
('7.1', '\\begin{aligned}\n        \\|\\theta^{(t)} - \\theta^{(0)}\\|_F &\\leq \\sum_{t=0}^{T-1}\\gamma \\|\\nabla_{\\theta,t}\\|_F \\leq  \\sum_{t=0}^{T-1}\\gamma \\sqrt{Lm/d} \\cdot\\|\\widehat{\\textbf{loss}}^{(t)}\\|_2 \\\\\n        &\\leq \\sqrt{T\\gamma}\\cdot O\\biggl(\\sqrt{\\frac{Lm}{d}\\cdot \\frac{n^4d}{m\\delta}}\\biggr) \\leq O\\biggl(\\frac{n^{3.5}\\sqrt{d}}{\\delta\\varepsilon\\sqrt{m}}\\biggr) = \\tau\n    \n\\end{aligned}')
('7.1', '\\begin{aligned}\n        T = \\Theta \\biggl(\\frac{n^3d}{\\min(\\eta,\\gamma) m \\delta \\varepsilon^2}\\biggr) = \\Theta\\biggl(\\frac{n^{10}L^{2}k}{\\delta^3}\\cdot \\frac{1}{\\varepsilon^4}\\biggr)\n    \n\\end{aligned}')
('8', '\\mathbf{W}')
('8', 'f^q_{\\mathbf{W}}')
('8', '\\theta')
('8', 'f^k_{\\theta}')
('8', '\\mathbf{D}_{i,l}')
('8', '\\begin{aligned}\n        (\\mathbf{D}_{i,l})_{r,r} = \\mathds{1}\\{ ([\\mathbf{W}_l]_r \\mathbf{h}_{i,l})\\geq 0 \\}\\ r \\in [m] \\qquad \\text{for } i\\in [n],\\ 0\\leq l \\leq L,\n\\end{aligned}')
('8', '[\\mathbf{W}_l]_r')
('8', 'r')
('8', '\\mathbf{W}_l')
('8', '\\begin{aligned}\n    \\mathbf{h}_{i,0} = \\mathbf{D}_{i,0}\\mathbf{W}_0 \\mathbf{x}_i,\\qquad \\mathbf{h}_{i,l} = \\mathbf{D}_{i,l}\\mathbf{W}_l \\mathbf{h}_{i,l-1} \\text{ for } 1 \\leq l \\leq L-1,\\qquad f_{\\mathbf{W}}(\\mathbf{x}_i) = \\mathbf{W}_L \\mathbf{h}_{i,L-1}\n\\end{aligned}')
('8', '\\mathbf{A}_i')
('8', '\\prod_{l=a}^b \\mathbf{A}_l = \\mathbf{A}_b\\mathbf{A}_{b-1}\\cdots \\mathbf{A}_a\\qquad \\text{for matrices } \\mathbf{A}_a,\\dots,\\mathbf{A}_b')
('8', '\\mathbf{W}')
('8', '\\mathbf{W}^{(0)}')
('8', 'i \\in [n]')
('8', '1 \\leq l \\leq L')
('8', '\\mathbf{D}_{i,l}^{(0)}')
('8', '\\mathbf{h}^{(0)}_{i,l}')
('8', '\\begin{aligned}\n    \\mathbf{D}_{i,l}^{(0)} := \\text{diag}\\Bigl(\\mathds{1}( \\langle [\\mathbf{W}^{(0)}_{l}]_r, \\mathbf{h}_{i,l-1}\\rangle \\geq 0 ) \\Bigr)_{k=1}^m, \\quad\\mathbf{h}_{i,0}^{(0)} := \\mathbf{D}^{(0)}_{i,0}\\mathbf{W}_0^{(0)}\\mathbf{x}_i,  \\quad \\mathbf{h}^{(0)}_{i,l} = \\mathbf{D}^{(0)}_{i,l}\\mathbf{W}_l^{(0)}\\mathbf{h}^{(0)}_{i,l-1}\n\\end{aligned}')
('8', '\\varepsilon \\in (0,1)')
('8', '1 - e^{-\\Omega(\\varepsilon^2m/L)}')
('8', '\\mathbf{W}^{(0)}')
('8', '\\|\\mathbf{h}_{i,l}\\| \\in [1-\\varepsilon,1+\\varepsilon]')
('8', 'i\\in [n]')
('8', 'l \\in [L]')
('8', 'm \\geq \\Omega(nL\\log(nL))')
('8', '1 - e^{-\\Omega(m/L)}')
('8', '\\mathbf{W}^{(0)}')
('8', 'i \\in [n]')
('8', '1 \\leq a \\leq b \\leq L-1')
('8', '\\|\\mathbf{W}_b^{(0)} \\bigl(\\prod_{l=a}^{b-1}\\mathbf{D}^{(0)} _{i,l}\\mathbf{W}^{(0)} _l\\bigr)\\|_2 \\leq O(\\sqrt{L})')
('8', '\\|\\mathbf{W}_b^{(0)} \\bigl(\\prod_{l=a}^{b-1}\\mathbf{D}^{(0)} _{i,l}\\mathbf{W}^{(0)} _l\\bigr)v\\|_2 \\leq 2\\|v\\|_2')
('8', 'v \\in \\mathbb{R}^{m}')
('8', '\\|v\\|_0 \\leq O(\\frac{m}{L\\log m})')
('8', '\\|u^{\\top}\\mathbf{W}_b^{(0)} \\bigl(\\prod_{l=a}^{b-1}\\mathbf{D}^{(0)} _{i,l}\\mathbf{W}^{(0)} _l\\bigr)\\|_2 \\leq O(1)\\|u\\|_2')
('8', 'u \\in \\mathbb{R}^{m}')
('8', '\\|u\\|_0 \\leq O(\\frac{m}{L\\log m})')
('8', '1 \\leq s \\leq O(\\frac{m}{L\\log m})')
('8', '1 - e^{-\\Omega(s\\log m)}')
('8', '|u^{\\top}\\mathbf{W}_b^{(0)} \\bigl(\\prod_{l=a}^{b-1}\\mathbf{D}^{(0)} _{i,l}\\mathbf{W}^{(0)} _l\\bigr)v| \\leq O(\\sqrt{\\frac{s\\log m}{m}})\\|u\\|_2\\|v\\|_2')
('8', 'u,v \\in \\mathbb{R}^{m}')
('8', '\\|u\\|_0,\\|v_0\\| \\leq s')
('8', 'm \\geq \\Omega(nL\\log (nL))')
('8', '\\Omega(\\frac{d}{\\log m}) \\leq s \\leq O(\\frac{m}{L \\log m})')
('8', 'd \\leq O(\\frac{m}{L\\log m})')
('8', 'i \\in [n]')
('8', '1 \\leq a \\leq L-1')
('8', '1 - e^{\\Omega(s \\log m)}')
('8', 'v \\in \\mathbb{R}^d')
('8', '\\|v\\|_0 \\leq s')
('8', '\\Bigl|u^{\\top}\\mathbf{W}^{(0)} _L\\Bigl(\\prod_{l=a}^{L}\\mathbf{D}^{(0)} _{i,l}\\mathbf{W}^{(0)} _l\\Bigr)v\\Bigr| \\leq O\\Bigl(\\sqrt{\\frac{s\\log m}{m}}\\Bigr)\\|u\\|_2\\|v\\|_2')
('8', '1 - e^{-\\Omega(m/L)}')
('8', 'u \\in \\mathbb{R}^d')
('8', '\\Bigl\\|u^{\\top}\\mathbf{W}^{(0)} _L\\Bigl(\\prod_{l=a}^{L}\\mathbf{D}^{(0)} _{i,l}\\mathbf{W}^{(0)} _l\\Bigr)\\Bigr\\|_2 \\leq O(\\sqrt{m/d})\\cdot\\|u\\|_2')
('8', '\\omega \\leq O(L^{-9/2}(\\log m)^3)')
('8', '1-e^{-\\Omega(m\\omega^{2/3}L)}')
('8', '\\mathbf{W}')
('8', '\\|\\mathbf{W}- \\mathbf{W}^{(0)}\\|_2\\leq \\omega')
('8', '\\mathbf{D}_{i,l}')
('8', '{\\mathbf{D}_{i,l}^{(0)}}')
('8', "\\mathbf{D}'_{i,l}")
('8', "(\\mathbf{D}_{i,l})_{k,k} = \\mathds{1}\\{(\\mathbf{W}_l\\mathbf{h}_{i,l-1})_k \\geq 0\\},\\quad (\\mathbf{D}_{i,l}^{(0)})_{k,k} = \\mathds{1}\\{(\\mathbf{W}^{(0)}_l\\mathbf{h}^{(0)}_{i,l-1})_k \\geq 0\\},\\quad \\mathbf{D}'_{i,l} = \\mathbf{D}_{i,l} - \\mathbf{D}^{(0)}_{i,l}")
('8', "\\|\\mathbf{D}'_{i,l}\\|_0 \\leq O(m\\omega^{2/3}L)")
('8', "\\|\\mathbf{D}'_{i,l}\\mathbf{W}_{l}\\mathbf{h}_{i,l-1}\\|_2 \\leq O(\\omega L^{3/2})")
('8', '\\|\\mathbf{h}_{i,l}-\\mathbf{h}^{(0)}_{i,l}\\|_2\\leq O(\\omega L^{5/2}\\sqrt{\\log m})')
('8', 'L-1')
('8', 's')
('8', '1 \\leq s \\leq O(\\frac{m}{L^3\\log m})')
('8', '1 - e^{-\\Omega(s\\log m)}')
('8', 'i \\in [n]')
('8', '0 \\leq a \\leq b \\leq L')
('8', "\\mathbf{D}''_{i,0},\\dots,\\mathbf{D}''_{i,L-1} \\in [-3,3]^{m\\times m}")
('8', 's')
('8', "\\mathbf{W}' = (\\mathbf{W}'_0,\\mathbf{W}'_1,\\dots,\\mathbf{W}'_{L-1})\\in (\\mathbb{R}^{m\\times \\mathfrak{b}},\\mathbb{R}^{(m\\times m)L})")
('8', '\\|\\mathbf{W}\\|_2 \\leq \\omega \\in [0,1]')
('8', '\\|\\mathbf{W}_{b}^{(0)}(\\mathbf{D}_{i, b-1}^{(0)}+\\mathbf{D}_{i, b-1}^{\\prime \\prime}) \\cdots(\\mathbf{D}_{i, a}^{(0)}+\\mathbf{D}_{i, a}^{\\prime \\prime}) \\mathbf{W}_{a}^{(0)} \\|_{2} \\leq O(\\sqrt{L})')
('8', '\\|(\\mathbf{W}_{b}^{(0)}+\\mathbf{W}_{b}^{\\prime})(\\mathbf{D}_{i, b-1}^{(0)}+\\mathbf{D}_{i, b-1}^{\\prime \\prime}) \\cdots(\\mathbf{D}_{i, a}^{(0)}+\\mathbf{D}_{i, a}^{\\prime \\prime})(\\mathbf{W}_{a}^{(0)}+\\mathbf{W}_{a}^{\\prime})\\|_{2} \\leq O(\\sqrt{L})')
('8', '\\omega \\leq O(L^{-3/2})')
('8', '\\mathbf{W}_0 \\in \\mathbb{R}^{m\\times \\mathfrak{b}}')
('8', '\\|\\mathbf{W}_{b}^{(0)}\\mathbf{D}_{i, b-1}^{(0)} \\cdots\\mathbf{D}_{i, a}^{(0)}\\mathbf{W}_{0}^{(0)} \\|_{2} \\leq O(\\sqrt{L})')
('8', '1-e^{-\\Omega(m/L)}')
('8', 'd \\leq O(\\frac{m}{L \\log m}))')
('8', 's')
('8', '\\Omega(\\frac{d}{\\log m}) \\leq s \\leq O(\\frac{m}{L^3\\log m})')
('8', 'i \\in [n]')
('8', '1 \\leq a \\leq L')
('8', "\\mathbf{D}''_{i,0},\\dots,\\mathbf{D}''_{i,L-1} \\in [-3,3]^{m\\times m}")
('8', 's')
('8', "\\mathbf{W}' = (\\mathbf{W}'_{i,0},\\dots,\\mathbf{W}'_{i,L})")
('8', "\\|\\mathbf{W}'\\|_2 \\leq \\omega = O(\\frac{1}{L^{3/2}})")
('8', '1 - e^{-\\Omega(s \\log m)}')
('8', "\\begin{aligned}\n        \\biggl\\| (\\mathbf{W}^{(0)}_{L} + \\mathbf{W}'_{L})\\biggl(\\prod_{l=a+1}^L(\\mathbf{D}^{(0)}_{i,l}+\\mathbf{D}''_{i,l})(\\mathbf{W}_{l}^{(0)} + \\mathbf{W}'_{l})\\biggr)(\\mathbf{D}^{(0)}_{i,a} + \\mathbf{D}''_{i,a}) - \\mathbf{W}^{(0)}_{L}\\biggl(\\prod_{l=a+1}^L\\mathbf{D}^{(0)}_{i,l}\\mathbf{W}_{l}^{(0)} \\biggr)\\mathbf{D}^{(0)}_{i,a}\\biggr\\|_2\\\\\n        \\leq O(\\sqrt{L^3s\\log m/d}+\\omega\\sqrt{L^3m/d})\n    \n\\end{aligned}")
('8', 's = O(m\\omega^{2/3}L)')
('8', 'O(\\omega^{1/3}L^2\\sqrt{m\\log m/d})')
('8', 'i')
('8', "\\begin{aligned}\n        &\\biggl\\| (\\mathbf{W}^{(0)}_{L} + \\mathbf{W}'_{L})\\biggl(\\prod_{l=a+1}^L(\\mathbf{D}^{(0)}_{l}+\\mathbf{D}''_{l})(\\mathbf{W}_{l}^{(0)} + \\mathbf{W}'_{l})\\biggr)(\\mathbf{D}^{(0)}_{a} + \\mathbf{D}''_{a}) - \\mathbf{W}^{(0)}_{L}\\biggl(\\prod_{l=a+1}^L\\mathbf{D}^{(0)}_{l}\\mathbf{W}_{l}^{(0)} \\biggr)\\mathbf{D}^{(0)}_{a}\\biggr\\|_2\\\\\n        & \\leq \\sum_{l=a}^{L-1} \\underbrace{\\biggl\\|\\mathbf{W}^{(0)}_L\\biggl( \\prod_{b=l+1}^{L} \\mathbf{D}^{(0)}_{b}\\mathbf{W}^{(0)}_b \\biggr)\\biggr\\|_2}_{\\text{\\ding{172}}} \\|\\mathbf{D}''_{l}\\|_2 \\underbrace{\\biggl\\|  \\biggl(\\prod_{c=a}^{l}(\\mathbf{W}_{c}^{(0)} + \\mathbf{W}'_{c}) (\\mathbf{D}^{(0)}_{c} + \\mathbf{D}''_{c}) \\biggr) \\biggr\\|_2}_{\\text{\\ding{173}}}\\\\\n        & \\quad + \\sum_{l=a}^{L} \\underbrace{\\biggl\\|\\mathbf{W}^{(0)}_L  \\prod_{b=l+1}^{L-1} (\\mathbf{D}^{(0)}_{b}\\mathbf{W}^{(0)}_b)\\mathbf{D}^{(0)}_{l}\\biggr\\|_2}_{\\text{\\ding{174}}}\\|\\mathbf{W}'_{l}\\|_2 \\|\\mathbf{D}^{(0)}_{l} + \\mathbf{D}''_{l}\\|_2 \\underbrace{\\biggl\\|  \\biggl(\\prod_{c=a}^{l-1}(\\mathbf{W}_{c}^{(0)} + \\mathbf{W}'_{c}) (\\mathbf{D}^{(0)}_{c} + \\mathbf{D}''_{c}) \\biggr)\\biggr\\|_2}_{\\text{\\ding{175}}}\\\\\n        & \\leq L\\cdot O\\biggl(\\sqrt{\\frac{s\\log m}{d}}\\cdot\\sqrt{L}\\biggr) + L\\cdot O\\biggl(\\sqrt{m/d}\\cdot\\omega\\cdot\\sqrt{L}\\biggr) = O(\\sqrt{L^3s\\log m/d}+\\omega\\sqrt{L^3m/d})\n    \n\\end{aligned}")
('8', "\\mathbf{D}''_{l}\\prod_{c=a}^{l}(\\mathbf{W}_{c}^{(0)} + \\mathbf{W}'_{c}) (\\mathbf{D}^{(0)}_{c} + \\mathbf{D}''_{c})")
('8', 's')
('8', '\\mathbf{W}\\in B(\\mathbf{W}^{(0)},\\omega)')
('8', "\\mathbf{W}' = (\\mathbf{W}'_0,\\mathbf{W}'_1,\\dots,\\mathbf{W}'_L)")
('8', "\\|\\mathbf{W}'\\|_2\\leq \\omega")
('8', '\\omega \\leq O(\\frac{1}{L^6n^{3}(\\log m)^{3/2}})')
('8', "\\mathbf{h}_{i,0} = \\sigma(\\mathbf{W}_0\\mathbf{x}_i),\\quad \\mathbf{h}_{i,l} = \\sigma(\\mathbf{W}_l\\mathbf{h}_{i,l-1}),\\quad \\mathbf{h}'_{i,0} = \\sigma((\\mathbf{W}_0+\\mathbf{W}'_0)\\mathbf{x}_i),\\quad \\mathbf{h}'_{i,l} = \\sigma((\\mathbf{W}_l+\\mathbf{W}'_l)\\mathbf{h}'_{i,l-1})")
('8', "\\mathbf{D}''_{i,l} \\in \\mathbb{R}^{m\\times m}")
('8', '[-1,1]')
('8', 'i \\in [n]')
('8', '0 \\leq l \\leq L-1')
('8', "\\mathbf{h}'_{i,l} - \\mathbf{h}_{i,l} = \\sum_{a=1}^l\\biggl( \\prod_{b=a+1}^l (\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})\\mathbf{W}_l\\biggr)  (\\mathbf{D}_{i,a}+\\mathbf{D}''_{i,a})\\mathbf{W}'_a \\mathbf{h}'_{i,a-1}")
('8', '1-e^{-\\Omega(m\\omega^{2/3}L)}')
('8', "\\|\\mathbf{h}'_{i,l} - \\mathbf{h}_{i,l}\\|_2 \\leq O(L^{3/2})\\|\\mathbf{W}'\\|_2")
('8', "\\|f_{\\mathbf{W}+\\mathbf{W}'}(\\mathbf{x}_i) - f_{\\mathbf{W}}(\\mathbf{x}_i)\\|_2 \\leq O(L\\sqrt{m/d})\\|\\mathbf{W}'\\|_2")
('8', "\\|\\mathbf{D}''_{i,l}\\|_0 \\leq O(m\\omega^{2/3}L)")
('8', 'a,b \\in \\mathbb{R}^m')
('8', '\\mathbf{D}')
('8', '\\mathbf{D}_{k,k} = \\mathds{1}_{a_k\\geq 0}')
('8', "\\mathbf{D}'' \\in \\mathbb{R}^m")
('8', "|\\mathbf{D}_{k,k}-\\mathbf{D}''_{k,k}|\\leq 1")
('8', "|\\mathbf{D}''_{k,k}|\\leq 1")
('8', 'k \\in [m]')
('8', "\\mathbf{D}''_{k,k} \\neq 0")
('8', '\\mathds{1}_{a_k \\geq 0} \\neq \\mathds{1}_{b_k \\geq 0}')
('8', "\\sigma(a) - \\sigma(b) = (\\mathbf{D}+\\mathbf{D}'')(a-b)")
('8', 'i')
('8', "\\begin{aligned}\n        &\\|(\\mathbf{W}_L+\\mathbf{W}'_L)\\mathbf{h}'_{L-1} - \\mathbf{W}_L\\mathbf{h}_{L-1}\\|_2 \\\\\n        = \\ & \\|\\mathbf{W}'_L\\mathbf{h}'_{L-1} + \\mathbf{W}_L(\\mathbf{h}'_{L-1} - \\mathbf{h}_{L-1}) \\|_2\\\\\n        = \\ & \\|\\mathbf{W}'_L\\mathbf{h}'_{L-1} + \\mathbf{W}'_L(\\sigma((\\mathbf{W}_{L-1}+\\mathbf{W}_{L-1}')\\mathbf{h}'_{L-2}) - \\sigma(\\mathbf{W}_l\\mathbf{h}_{L-2})) \\|_2\\\\\n        \\stackrel{\\text{\\ding{172}}}= \\ & \\|\\mathbf{W}'_L\\mathbf{h}'_{L-1} + \\mathbf{W}_L(\\mathbf{D}_{L-1}+\\mathbf{D}''_{L-1})((\\mathbf{W}_{L-1}+\\mathbf{W}_{L-1}')\\mathbf{h}'_{L-2}-\\mathbf{W}_{L-1}\\mathbf{h}_{L-2})\\|_2 \\\\\n        \\leq \\ & \\|\\mathbf{W}'_L\\mathbf{h}'_{L-1}\\|_2 + \\|\\mathbf{W}_L(\\mathbf{D}_{L-1}+\\mathbf{D}''_{L-1})\\mathbf{W}'_{L-1}\\mathbf{h}'_{L-2}\\|_2\\\\\n        & + \\|\\mathbf{W}_L(\\mathbf{D}_{L-1}+\\mathbf{D}''_{L-1})\\mathbf{W}_{L-1}(\\mathbf{h}'_{L-2} - \\mathbf{h}_{L-2}) \\|_2\\\\\n        = \\ & \\underbrace{\\|\\mathbf{W}'_L\\mathbf{h}'_{L-1}\\|_2}_{\\leq \\|\\mathbf{W}'_L\\|_2\\|\\mathbf{h}'_{l-1}\\|_2 } + \\underbrace{\\biggl\\|\\sum_{l=0}^{L-1} \\mathbf{W}_L\\biggl( \\prod_{a=l+1}^{L-1} (\\mathbf{D}_{a}+\\mathbf{D}''_{a})\\mathbf{W}_a\\biggr)(\\mathbf{D}_{l}+\\mathbf{D}''_{l})\\biggr\\|_2}_{\\leq O(L\\sqrt{m/d}) \\text{ by Lemma \\ref{lem:backward-propagate} and Lemma \\ref{lem:backward-perturbation}}} \\cdot \\|\\mathbf{W}'_l\\mathbf{h}'_{l-1}\\|_2\\\\\n        \\leq \\ & O(L\\sqrt{m/d})\\|\\mathbf{W}'\\|_2\n    \n\\end{aligned}")
('8', "\\|\\mathbf{h}'_{l}\\|_2 \\leq \\|\\mathbf{h}^{(0)}_{l}\\|_2 + \\|\\mathbf{h}'_{l}-\\mathbf{h}^{(0)}_l\\|_2 \\leq O(1)")
('8', '0\\leq l \\leq L-1')
('8', '\\mathbf{W}\\in B(\\mathbf{W}^{(0)},\\omega)')
('8', '\\omega')
('8', 'd \\leq O(m/(L\\log m))')
('8', '1 - O(n)e^{-\\Omega(d)}')
('8', '\\|f_{\\mathbf{W}^{(0)}}(\\mathbf{x}_i)\\|_2 \\leq O(1)')
('8', '\\|f_{\\mathbf{W}}(\\mathbf{x}_i)\\|_2 \\leq O(1+\\omega L\\sqrt{m/d})')
('8', 'i \\in [n]')
('8', '1 - O(nL)e^{-\\Omega(m/L)}')
('8', '\\|\\sigma(\\mathbf{W}^{(0)}_{L-1}\\sigma(\\cdots\\sigma(\\mathbf{W}_0\\mathbf{x}_i)))\\|_2 \\leq O(1)')
('8', '(\\mathbf{W}^{(0)}_L)_{i,j} \\sim \\mathcal{N}(0,\\frac{1}{d}),\\ (i,j)\\in [d]\\times [m]')
('8', '\\mathbf{W}_L^{(0)}')
('8', 'f^q_{\\mathbf{W}^{(0)}}(\\mathbf{x}_i) = \\mathbf{W}_L\\sigma(\\cdots\\sigma(\\mathbf{W}_0\\mathbf{x}_i)) \\sim \\mathcal{N}(0,\\kappa^2\\mathbf{I}_d)')
('8', '\\kappa^2 \\leq O(\\frac{1}{d})')
('8', '1 - O(n)e^{-\\Omega(d)}')
('8', '\\|f^q_{\\mathbf{W}^{(0)}}(\\mathbf{x}_i)\\|_2 \\leq O(1)')
('8', "\\mathbf{W}' = \\mathbf{W}-\\mathbf{W}^{(0)}")
('8', "\\|\\mathbf{W}'\\|_2\\leq \\omega")
('8', '\\delta')
('8', '\\delta \\leq O(1/L)')
('8', 'i\\neq j')
('8', 'l \\in [L]')
('8', '1-O(n^2)e^{-\\Omega(m\\delta^4)}')
('8', '\\|\\mathbf{h}_{i,l}^{(0)} - \\mathbf{h}_{j,l}^{(0)}\\|_2 \\geq \\delta/2')
('8', 'l-1')
('8', '\\delta_{l-1}')
('8', '\\|\\mathbf{h}_{i,l-1}^{(0)} - \\mathbf{h}_{j,l-1}^{(0)}\\|_2 \\geq \\delta_{l-1}')
('8', '\\delta_{l-1}\\geq \\delta/2')
('8', 'l')
('8', '\\mathbf{w}_{l,r}')
('8', 'r')
('8', '\\mathbf{W}_l')
('8', 'l')
('8', '\\mathbf{w}_{l,r} \\in \\mathbb{R}^{1\\times m}')
('8', 'N(0,\\frac{2}{m}\\mathbf{I})')
('8', '\\mathbf{W}_l')
('8', '\\mathbf{h}_{i,l-1},\\mathbf{h}_{j,l-1}')
('8', '\\mathbf{w}_{l,r}\\mathbf{h}_{i,l-1},\\mathbf{w}_{l,r}\\mathbf{h}_{j,l-1}')
('8', '\\sigma(\\mathbf{w}_{l,k}\\mathbf{h}_{i,l-1}) - \\sigma(\\mathbf{w}_{l,r}\\mathbf{h}_{j,l-1})')
('8', 'l-1')
('8', '\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}) = \\begin{cases}\n            \\mathbf{w}_{r}(\\mathbf{h}_{i} -\\mathbf{h}_{j}), &\\qquad\\diamondsuit\\ \\text{ if both } \\mathbf{w}_{r}\\mathbf{h}_{i},\\ \\mathbf{w}_{r}\\mathbf{h}_{j} \\geq 0\\\\\n            0, &\\qquad\\clubsuit\\ \\text{ if both } \\mathbf{w}_{r}\\mathbf{h}_{i},\\ \\mathbf{w}_{r}\\mathbf{h}_{j} \\leq 0\\\\\n            \\mathbf{w}_{r}\\mathbf{h}_{i}, &\\qquad\\heartsuit\\ \\text{ if }  \\mathbf{w}_{r}\\mathbf{h}_{i} \\geq 0,\\ \\mathbf{w}_{r}\\mathbf{h}_{j} \\leq 0\\\\\n            \\mathbf{w}_{r}\\mathbf{h}_{j}, &\\qquad\\spadesuit\\ \\text{ if }  \\mathbf{w}_{r}\\mathbf{h}_{i} \\leq 0,\\ \\mathbf{w}_{r}\\mathbf{h}_{j} \\geq 0\n        \\end{cases}')
('8', '\\diamondsuit')
('8', '\\mathbb{E}[(\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}))^2|\\diamondsuit] \\geq \\frac{2\\delta^2}{m}')
('8', '\\clubsuit')
('8', '\\mathbb{E}[(\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}))^2|\\clubsuit] = 0')
('8', '\\heartsuit')
('8', '\\spadesuit')
('8', '\\|\\mathbf{h}_{i}\\|_2,\\|\\mathbf{h}_j\\|_2 \\in [1/2,2]')
('8', '\\mathbb{E}[(\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}))^2|\\heartsuit\\lor \\spadesuit] \\geq \\frac{2\\delta^2}{m}')
('8', '\\clubsuit')
('8', '1/2')
('8', '(i,j)')
('8', '\\mathbb{E}[(\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}))^2] \\geq \\frac{\\delta^2}{m},\\qquad \\mathbb{E}[ (\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}))^2] \\leq 2')
('8', 'l')
('8', '1 - e^{-\\Omega(m\\delta^4)}')
('8', '\\|\\mathbf{h}_{i,l} - \\mathbf{h}_{j,l}\\|_2^2 \\geq \\sum_{r=1}^m (1-O(\\delta))\\mathbb{E}[(\\sigma(\\mathbf{w}_{r}\\mathbf{h}_{i}) - \\sigma(\\mathbf{w}_{r}\\mathbf{h}_{j}))^2] \\geq \\delta^2(1- O(\\delta))')
('8', '(i,j)')
('8', '0\\leq l\\leq L')
('9.0', '\\mathbf{W}')
('9.0', '\\theta')
('9.0', '[\\mathbf{W}]_r')
('9.0', '[\\theta]_r')
('9.0', 'r')
('9.0', '[\\mathbf{W}]^r')
('9.0', '[\\theta]^r')
('9.0', 'r')
('9.0', 'f^q_{\\mathbf{W}}')
('9.0', '\\text{Back}_{i,l}^q:= \\mathbf{W}_L\\mathbf{D}_{i,L-1}\\cdots\\mathbf{D}_{i,l}\\mathbf{W}_l')
('9.0', '\\text{Back}^q_{i,L} = \\mathbf{W}_L')
('9.0', 'f^k_{\\theta}')
('9.0', '\\text{Back}_{i,l}^k:= \\theta_L\\mathbf{D}_{i,L-1}\\cdots\\mathbf{D}_{i,l}\\theta_l')
('9.0', '\\text{Back}^k_{i,L}=\\theta_L')
('9.0', '\\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta)')
('9.0', '\\mathbf{W}')
('9.0', "\\nabla_{[\\mathbf{W}_l]_r}L_S(\\mathbf{W},\\theta) := \\frac{1}{n}\\sum_{i=1}^n \\Bigl((\\text{Back}_{i,l+1}^q)_r^{\\top}\\widetilde{\\textbf{loss}}_i\\Bigr)\\cdot\\sigma'(\\langle [\\mathbf{W}_l]_{r},\\mathbf{h}_{i,l-1}\\rangle)\\cdot\\mathbf{h}_{i,l-1}")
('9.0', '\\widetilde{\\textbf{loss}}_i')
('9.0', '\\widetilde{\\textbf{loss}}_i := \\mathbb{E}^{Neg(i)}\\Biggl[ \\sum_{j=1}^k\\frac{\\exp(q_i^{\\top}z_{i,j})}{1 + \\sum_{s=1}^k\\exp(q_i^{\\top}z_{i,j})}z_{i,j} \\Biggr]')
('9.0', 'q_i:= f^q_{\\mathbf{W}}(\\mathbf{x}_i),\\ z_{i,j} = f^k_{\\theta}(\\mathbf{x}_{i,j}) - f^k_{\\theta}(\\mathbf{x}_i)')
('9.0', '\\nabla_{\\theta}L_S(\\mathbf{W},\\theta)')
('9.0', '\\theta')
('9.0', '\\begin{aligned}\n        \\nabla_{[\\theta_l]_r} L_S(\\mathbf{W},\\theta) & =  \\frac{1}{n}\\sum_{i=1}^n \\mathbb{E}^{Neg} \\biggl[\\nabla_{[\\theta_l]_r}\\ell(\\mathbf{W},\\theta,\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)\\biggr]\\\\\n        =  \\frac{1}{n}\\sum_{i=1}^n &\\frac{1}{\\binom{n-1}{k}} \\sum_{\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset S^{\\setminus i}} \\sum_{j=1}^k \\frac{\\exp(q_i^{\\top}z_{i,j})}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top} z_{i,s})} \\nabla_{[\\theta_l]_r}\\Bigl(q_i^{\\top} (f^k_{\\theta}(\\mathbf{x}_{i,j}) - f^k_{\\theta}(\\mathbf{x}_{i}))\\Bigr)\n    \n\\end{aligned}')
('9.0', '\\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j)')
('9.0', '\\textbf{loss}')
('9.0', '\\theta')
('9.0', 'f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('9.0', 'f^k_{\\theta}(\\mathbf{x}_j)')
('9.0', '\\label{def:losshat}\n        \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j) := \\frac{1}{\\binom{n-1}{k}}\\sum_{\\mathbf{x}_j \\in \\{\\mathbf{x}_{i,s}\\}_{s\\in [k]} \\subset S^{\\setminus i} } \\frac{\\exp(q_i^{\\top}z_{j})}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top} z_{i,s})}\\cdot q_i')
('9.0', 'q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i),\\ z_j = f^k_{\\theta}(\\mathbf{x}_{j}) - f^k_{\\theta}(\\mathbf{x}_i),\\ z_{i,s} = f^k_{\\theta}(\\mathbf{x}_{i,s}) - f^k_{\\theta}(\\mathbf{x}_i)')
('9.0', '\\nabla_{[\\theta_l]_r} L_S(\\mathbf{W},\\theta)')
('9.0', "\\begin{aligned}\n        &\\nabla_{[\\theta_l]_r} L_S(\\mathbf{W},\\theta) \\nonumber \\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\sum_{j\\neq i}  \\biggl( (\\text{Back}_{i,l}^k)^{\\top} \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j)\\biggr) \\Bigl(\\sigma'(\\langle [\\theta_l]_r,\\mathbf{h}_{j,l-1}\\rangle)\\mathbf{h}_{j,l-1}-\\sigma'(\\langle [\\theta_l]_r,\\mathbf{h}_{i,l-1}\\rangle)\\mathbf{h}_{i,l-1}\\Bigr) \\nonumber\\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n  \\Bigl((\\text{Back}_{i,l}^k)^{\\top} \\Bigl(\\sum_{j\\neq i}(\\widehat{\\textbf{loss}}(\\mathbf{x}_j,\\mathbf{x}_i) - \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j))\\Bigr)\\Bigr)\\cdot \\sigma'(\\langle [\\theta_l]_r,\\mathbf{h}_{i,l-1}\\rangle)\\cdot\\mathbf{h}_{i,l-1} \\nonumber\\\\\n        = \\ &  \\frac{1}{n}\\sum_{i=1}^n  \\Bigl((\\text{Back}_{i,l}^k)^{\\top} \\widehat{\\textbf{loss}}_i \\Bigr)\\cdot \\sigma'(\\langle [\\theta_l]_r,\\mathbf{h}_{i,l-1}\\rangle)\\cdot\\mathbf{h}_{i,l-1} \\label{eq:gradient-for-theta}\n    \n\\end{aligned}")
('9.0', '\\widehat{\\textbf{loss}}_i := \\sum_{j\\neq i}(\\widehat{\\textbf{loss}}(\\mathbf{x}_j,\\mathbf{x}_i) - \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j))')
('9.0', '\\nabla_{[\\theta_l]_r} L_S(\\mathbf{W},\\theta)')
('9.1', '1 - e^{-\\Omega(m\\delta^2/n^2)}')
('9.1', '1 - e^{-\\Omega(m\\delta/nd)}')
('9.1', 'm \\geq \\Omega(n^3d\\delta^{-2})')
('9.1', '\\mathbf{W}_L')
('9.1', '\\mathbf{W}_{L-1}')
('9.1', '1 - e^{-\\Omega(m\\delta^2/n^2)}')
('9.1', '\\mathbf{v}_i, i \\in [n]')
('9.1', "\\sum_{r=1}^m \\biggl\\|\\frac{1}{n}\\sum_{i=1}^n \\langle [\\mathbf{W}_L]^r, \\mathbf{v}_i\\rangle\\sigma'(\\langle [\\mathbf{W}_{L-1}]_r, \\mathbf{h}_{i,L-2}\\rangle)\\mathbf{h}_{i,L-2}\\biggr\\|_2 \\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^2")
('9.1', '\\mathbf{h}_1,\\dots,\\mathbf{h}_n \\in \\mathbb{R}^m')
('9.1', '1/2\\leq \\|\\mathbf{h}_i\\|_2 \\leq 2')
('9.1', '\\bar{\\mathbf{h}_i}:= \\mathbf{h}_i/\\|\\mathbf{h}_i\\|_2')
('9.1', '\\|\\bar{\\mathbf{h}}_i - \\bar{\\mathbf{h}}_j\\|_2 \\geq \\delta/2')
('9.1', "\\mathbf{Q}_i = [\\bar{\\mathbf{h}}_i,\\mathbf{Q}'_i] \\in \\mathbb{R}^{m\\times m}")
('9.1', '\\mathbf{w}\\sim \\mathcal{N}(0,\\mathbf{I}_m)')
('9.1', "\\mathbf{w}= \\mathbf{Q}_i\\mathbf{u}_i = u_{i,1}\\bar{\\mathbf{h}}_i + \\mathbf{Q}'_i\\mathbf{u}'_i")
('9.1', 'u_{i,1}')
('9.1', '\\mathbf{u}_i')
('9.1', "\\mathbf{u}'_i = (u_{i,2},\\dots,u_{i,m}) \\in \\mathbb{R}^{m-1}")
('9.1', '\\xi = \\sqrt{\\pi}\\delta / (16n)')
('9.1', '\\mathbf{w}')
('9.1', "W_i = \\{ |u_{i,1}| \\leq \\xi,  |\\langle \\mathbf{Q}'_i\\mathbf{u}'_i,\\bar{\\mathbf{h}}_j\\rangle| \\geq 2\\xi \\text{ for all } \\bar{\\mathbf{h}}_j \\text{ where } j \\neq i\\}")
('9.1', 'W_i')
('9.1', 'W_j')
('9.1', '\\mathbb{P}(\\mathbf{w}\\in W_i) \\geq \\frac{\\delta}{n16\\sqrt{2e}} \\quad \\text{and} \\quad W_i\\cap W_j = \\varnothing')
('9.1', 'a_1,\\dots,a_n')
('9.1', "\\mathbf{h}(\\mathbf{w}):= \\sum_{i=1}^n a_i \\sigma'(\\langle \\mathbf{w},\\mathbf{h}_i\\rangle)\\mathbf{h}_i")
('9.1', '\\mathbf{w}\\sim \\mathcal{N}(0,\\mathbf{I}_m)')
('9.1', '\\mathbb{P}\\Bigl( \\|\\mathbf{h}(\\mathbf{w})\\|_2 \\geq \\frac{|a_i|}{4} \\Big| \\mathbf{w}\\in W_i \\Bigr) \\geq 1/2')
('9.1', '\\mathbf{v}_1,\\dots,\\mathbf{v}_n')
('9.1', 'r \\in [m]')
('9.1', '\\mathbf{h}_r')
('9.1', "\\mathbf{h}_r(\\mathbf{W}_L,\\mathbf{W}_{L-1}) := \\sum_{i=1}^n \\langle [\\mathbf{W}_L]^r, \\mathbf{v}_i\\rangle\\cdot \\sigma'(\\langle \\mathbf{w}_{r,L-1},\\mathbf{h}_i\\rangle)\\cdot\\mathbf{h}_i")
('9.1', '[\\mathbf{W}_L]^r')
('9.1', 'r')
('9.1', '\\mathbf{W}_L')
('9.1', '\\mathbf{w}_{r,L-1} = \\sqrt{m/2}[\\mathbf{W}_{L-1}]_r')
('9.1', 'r')
('9.1', '\\sqrt{m/2}\\mathbf{W}_{L-1}')
('9.1', "\\sigma'(\\langle \\mathbf{w}_{r,L-1},\\mathbf{h}_i\\rangle) = \\sigma'(\\langle [\\mathbf{W}_{L-1}]_r,\\mathbf{h}_i\\rangle)")
('9.1', '\\mathbf{w}_{r,L-1} \\sim \\mathcal{N}(0,\\mathbf{I}_m)')
('9.1', '\\{A_i\\}_{i\\in [n]}')
('9.1', '[\\mathbf{W}_L]^r')
('9.1', '[\\mathbf{W}_{L-1}]_r')
('9.1', 'A_i = A_{i,1}\\cap A_{i,2} \\cap A_{i,3}')
('9.1', 'A_{i,1}:= \\{\\mathbf{w}_{r,L-1} \\in W_i\\}')
('9.1', 'A_{i,2}:= \\{\\|\\mathbf{h}_r(\\mathbf{W}_L,\\mathbf{W}_{L-1})\\|_2 \\geq |\\langle [\\mathbf{W}_L]^r, \\mathbf{v}_i\\rangle|/4\\}')
('9.1', 'A_{i,3}:= \\{  \\langle [\\mathbf{W}_L]^r, \\mathbf{v}_i\\rangle| \\geq \\|\\mathbf{v}_i\\|_2/\\sqrt{d} \\}')
('9.1', '\\mathbf{W}_L')
('9.1', '\\mathbf{W}_{L-1}')
('9.1', '\\begin{aligned}\n        &\\mathbb{P}(r \\in A_i) = \\mathbb{P}(A_{i,2}|A_{i,1})\\cdot \\mathbb{P}(A_{i,1}) \\cdot \\mathbb{P}(A_{i,3}) \\geq \\frac{\\delta}{256\\sqrt{2}en} \\quad \\text{ and} \\quad A_i \\cap A_j = \\varnothing \\text{ if } i \\neq j\n    \n\\end{aligned}')
('9.1', '\\sum_{i=1}^n \\mathds{1}_{r \\in A_i} \\leq 1')
('9.1', '\\begin{aligned}\n        \\sum_{r=1}^m\\|\\mathbf{h}_r(\\mathbf{W}_L,\\mathbf{W}_{L-1})\\|_2^2 \\geq  \\sum_{r=1}^m\\|\\mathbf{h}_r(\\mathbf{W}_L,\\mathbf{W}_{L-1})\\|_2^2\\sum_{r=1}^m \\mathds{1}_{r \\in A_i} \\geq  \\sum_{r=1}^m\\sum_{i=1}^n \\frac{\\|\\mathbf{v}_i\\|_2^2}{32d}\\mathds{1}_{r \\in A_i} \n    \n\\end{aligned}')
('9.1', 'Z_r := \\sum_{i=1}^n\\mathds{1}_{r \\in A_i}\\|\\mathbf{v}_i\\|_2^2/(32d)')
('9.1', 'A_i')
('9.1', '(Z_r)_{r \\in [m]}')
('9.1', '\\mathbf{w}_{r,L-1}, [\\mathbf{W}_L]^r')
('9.1', 'r')
('9.1', 'r \\in [m]')
('9.1', '\\begin{aligned}\n        \\mathbb{E}[Z_r] \\geq \\Omega\\biggl(\\frac{\\delta\\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^2}{dn}\\biggr),\\quad (\\mathbb{E}[Z_r])^2 \\geq \\Omega\\biggl(\\frac{\\delta^2\\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^4}{d^2n^2}\\biggr) ,\\quad \\mathbb{E}[Z_r^2] \\leq  O\\biggl(\\frac{\\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^4}{d^2}\\biggr)\n    \n\\end{aligned}')
('9.1', '\\begin{aligned}\n        \\mathbb{P}\\biggl( \\sum_{r=1}^m (Z_r - E[Z_r]) \\leq \\frac{m}{2}\\biggl(\\frac{1}{m}\\sum_{r=1}^m\\mathbb{E}[Z_r]\\biggr) \\biggr) &\\leq \\exp \\biggl\\{ - \\Omega \\biggl(\\frac{m(\\sum_{r=1}^m\\mathbb{E}[Z_r]/m)^2}{\\sum_{r=1}^m\\mathbb{E}[Z^2_r]/m} \\biggr)\\biggr\\}\\\\\n        & \\leq \\exp \\biggl\\{ - \\Omega \\biggl(\\frac{m^2\\min_{r \\in [m]}(\\mathbb{E}[Z_r])^2}{\\sum_{r=1}^m\\mathbb{E}[Z^2_r]} \\biggr)\\biggr\\} \\\\\n        & \\leq \\exp(-\\Omega(m\\delta^2/n^2))\n    \n\\end{aligned}')
('9.1', '1 - e^{-\\Omega(m\\delta^2/n^2)}')
('9.1', '\\begin{aligned}\n        \\frac{1}{n^2}\\sum_{r=1}^m\\|\\mathbf{h}_r(\\mathbf{W}_L,\\mathbf{W}_{L-1})\\|_2^2 \\geq \\frac{1}{2n^2}\\sum_{r=1}^m\\mathbb{E}[Z_r] \\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^2\\biggr)\n    \n\\end{aligned}')
('9.1', '(\\mathbf{v}_i)_{i \\in [n]}')
('9.1', '\\varepsilon')
('9.1', 'm \\geq \\Omega(n^3d\\delta^{-2})')
('9.1', '1 - e^{-\\Omega(m\\delta^2/n^2)}')
('9.2', '\\mathbf{W}')
('9.2', '\\theta')
('9.2', '1 - 2e^{-\\Omega(m\\delta^2/n^2)}')
('9.2', '\\|\\nabla_\\mathbf{W}L_S(\\mathbf{W}^{(0)},\\theta^{(0)})\\|_F')
('9.2', '\\begin{aligned}\n            \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n\\|\\widetilde{\\textbf{loss}}_i\\|_2^2 \\leq \\| \\nabla_{\\mathbf{W}}L_S(\\mathbf{W}^{(0)},\\theta^{(0)})\\|_F^2 \\leq O\\biggl(\\frac{Lm}{nd}\\biggr)\\sum_{i=1}^n\\|\\widetilde{\\textbf{loss}}_i\\|_2^2\n        \n\\end{aligned}')
('9.2', '\\|\\nabla_{\\theta}L_S(\\mathbf{W}^{(0)},\\theta^{(0)}\\|_F')
('9.2', '\\begin{aligned}\n            \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2 \\leq \\| \\nabla_{\\theta}L_S(\\mathbf{W}^{(0)},\\theta^{(0)})\\|_F^2 \\leq O\\biggl(\\frac{Lm}{nd}\\biggr)\\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2\n        \n\\end{aligned}')
('9.2', '\\mathbf{W}^{(0)}')
('9.2', '\\theta^{(0)}')
('9.2', 'f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('9.2', 'i \\in [n]')
('9.2', 'l \\in [L]')
('9.2', '\\begin{aligned}\n        \\Bigl\\| \\nabla_{\\mathbf{W}_l}L_S(\\mathbf{W},\\theta)\\Bigr\\|_F &= \\biggl\\| \\frac{1}{n}\\sum_{i=1}^n \\mathbf{D}_{i,l}\\cdot\\widetilde{\\textbf{loss}}_i^{\\top}(\\text{Back}_{i,l}^q)\\cdot\\mathbf{h}_{i,l-1}^{\\top}\\biggr\\|_F\\\\\n        & \\leq \\frac{1}{n}\\sum_{i=1}^n \\|\\mathbf{D}_{i,l}\\|_2\\cdot \\bigl\\|\\widetilde{\\textbf{loss}}_i^{\\top}(\\text{Back}_{i,l}^q)\\bigr\\|_2\\cdot \\|\\mathbf{h}_{i,l-1}\\|_2\\\\\n        & \\stackrel{\\text{\\ding{172}}}\\leq O(\\sqrt{m/d})\\cdot\\frac{1}{n}\\sum_{i=1}^n \\|\\widetilde{\\textbf{loss}}_i\\|_2 \\leq O(\\sqrt{m/nd})\\cdot \\biggl(\\sum_{i=1}^n \\|\\widetilde{\\textbf{loss}}_i\\|_2^2\\biggr)^{1/2}\n    \n\\end{aligned}')
('9.2', '1 - \\exp(-\\Omega(m/L))')
('9.2', 'l \\in [L]')
('9.2', 'f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('9.2', '1- \\exp(-\\Omega(m\\delta^2/n^2))')
('9.2', "\\begin{aligned}\n        \\|\\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta)\\|_F^2 &\\geq \\|\\nabla_{\\mathbf{W}_{L-1}}L_S(\\mathbf{W},\\theta)\\|_F^2 \\\\\n        &= \\sum_{r=1}^m \\biggl\\| \\frac{1}{n}\\sum_{i=1}^n \\langle [\\mathbf{W}_L]_r,\\widetilde{\\textbf{loss}}_i\\rangle\\sigma'(\\langle [\\mathbf{W}_{L-1}]_{r},\\mathbf{h}_{i,L-2}\\rangle)\\mathbf{h}_{i,L-2}\\biggr\\|_2^2\\\\\n        &\\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n \\|\\widetilde{\\textbf{loss}}_i\\|_2^2\n    \n\\end{aligned}")
('9.2', 'f^k_{\\theta}(\\mathbf{x}_i)')
('9.2', '\\begin{aligned}\n        \\|\\nabla_{\\theta_l} L_S(\\mathbf{W},\\theta)\\|_F &= \\biggl\\| \\frac{1}{n}\\sum_{i=1}^n  \\mathbf{D}_{i,l}^k\\Bigl((\\text{Back}_{i,l+1}^k)^{\\top} \\widehat{\\textbf{loss}}_i\\Bigr)\\mathbf{h}_{i,l-1}^{\\top}\\biggr\\|_F\n    \n\\end{aligned}')
('9.2', '\\begin{aligned}\n        \\|\\nabla_{\\theta_l} L_S(\\mathbf{W},\\theta)\\|_F &\\leq \\frac{1}{n}\\sum_{i=1}^n \\|\\mathbf{D}_{i,l}\\|_2\\cdot \\|\\widehat{\\textbf{loss}}_i^{\\top}\\text{Back}_{i,l+1}^k\\|_2\\cdot \\|\\mathbf{h}_{i,l-1}\\|_2\\\\\n        & \\stackrel{\\text{\\ding{172}}}\\leq O(\\sqrt{m/d})\\cdot \\frac{1}{n}\\sum_{i=1}^n \\|\\widehat{\\textbf{loss}}_i\\|_2 \\leq O(\\sqrt{m/nd})\\biggl(\\sum_{i=1}^n\\|\\widehat{\\textbf{loss}}_i\\|_2^2\\biggr)^{1/2}\n    \n\\end{aligned}')
('9.2', '1 - \\exp(-\\Omega(m/L))')
('9.2', 'l \\in {L}')
('9.2', 'f^k_{\\theta}(\\mathbf{x}_i)')
('9.2', '\\nabla_{\\theta_L}L_S(\\mathbf{W},\\theta_L)')
('9.2', "\\|\\nabla_{\\theta_{L-1}} L_S(\\mathbf{W},\\theta)\\|_F^2 = \\sum_{r=1}^{m}\\biggl\\| \\frac{1}{n}\\sum_{i=1}^n  \\langle [\\theta_L]_r, \\widehat{\\textbf{loss}}_i\\rangle\\cdot \\sigma'(\\langle [\\theta_{L-1}]_r,\\mathbf{h}_{i,L-2}\\rangle)\\cdot\\mathbf{h}_{i,L-2}\\biggr\\|_2^2")
('9.2', '1- \\exp(-\\Omega(m\\delta^2/n^2))')
('9.2', '\\|\\nabla_{\\theta} L_S(\\mathbf{W},\\theta)\\|_F^2 \\geq \\|\\nabla_{\\theta_{L-1}} L_S(\\mathbf{W},\\theta)\\|_F^2 \\geq \\Omega\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n \\|\\widehat{\\textbf{loss}}_i\\|_2^2')
('9.3', '\\mathbf{W}^{(t)}')
('9.3', '\\theta^{(t)}')
('9.3', 'B(\\mathbf{W}^{(0)},\\omega)')
('9.3', 'B(\\theta^{(0)},\\tau)')
('9.3', '\\mathbf{D}^{(0)}_{i,l}:= \\text{diag}\\Bigl(\\mathds{1}\\{[\\mathbf{W}^{(0)}]_r^{\\top} \\mathbf{h}^{(0)}_{i,l-1} \\geq 0 \\}_{r=1}^m\\Bigr)')
('9.3', '\\mathbf{h}_{i,l}^{(0)} = \\mathbf{D}^{(0)}_{i,l}\\mathbf{W}^{(0)}_l \\mathbf{h}_{i,l-1}^{(0)}')
('9.3', 'l')
('9.3', '\\mathbf{x}_i')
('9.3', '\\mathbf{D}_{i,l}, \\mathbf{h}_{i,l}')
('9.3', '\\text{Back}_{i,l}^{q,(0)} = \\mathbf{W}^{(0)}_L \\mathbf{D}^{(0)}_{i,L-1}\\mathbf{W}^{(0)}_{L-1} \\cdots \\mathbf{D}^{(0)}_{i,l}\\mathbf{W}^{(0)}_l')
('9.3', '\\mathbf{v}_i = \\widetilde{\\textbf{loss}}_i')
('9.3', '\\mathbf{W}_L')
('9.3', 'l \\leq L-1')
('9.3', '\\begin{aligned}\n        &\\nabla_{\\mathbf{W}_l} L_S(\\mathbf{W}^{(0)},\\theta) - \\nabla_{\\mathbf{W}_l} L_S(\\mathbf{W},\\theta)\\\\\n        = \\ &\\frac{1}{n}\\sum_{i=1}^n \\biggl(  \\mathbf{v}_i^{\\top}(\\text{Back}_{i,l+1}^{q,(0)}\\mathbf{D}^{(0)}_{i,l})\\cdot (\\mathbf{h}_{i,l-1}^{(0)})^{\\top} - \\mathbf{v}_i^{\\top}(\\text{Back}_{i,l+1}^{q}\\mathbf{D}_{i,l}) \\cdot (\\mathbf{h}_{i,l-1})^{\\top}\\biggr)\n    \n\\end{aligned}')
('9.3', '\\bigl\\|\\mathbf{v}_i^{\\top}\\text{Back}_{i,l+1}^{q,(0)}\\mathbf{D}^{(0)}_{i,l}-\\mathbf{v}_i^{\\top}\\text{Back}_{i,l+1}^{q}\\mathbf{D}_{i,l}\\bigr\\|_2 \\leq O(\\omega^{1/3}L^2\\sqrt{m\\log m/d})\\cdot\\|\\mathbf{v}_i\\|_2')
('9.3', '\\bigl\\|\\mathbf{v}_i^{\\top}\\text{Back}_{i,l+1}^{q,(0)}\\mathbf{D}^{(0)}_{i,l}\\bigr\\|_2 \\leq O(\\sqrt{m/d})\\cdot\\|\\mathbf{v}_i\\|_2')
('9.3', 'i \\in [n]')
('9.3', '\\|\\mathbf{h}^{(0)}_{i,l-1}\\|_2 \\leq O(1)\\text{  and  } \\|\\mathbf{h}_{i,l-1} - \\mathbf{h}_{i,l-1}^{(0)}\\|_2 \\leq O(\\omega L^{3/2}) \\implies \\|\\mathbf{h}_{i,l-1}\\|_2 \\leq O(1)')
('9.3', '\\begin{aligned}\n        \\Bigl\\| \\nabla_{\\mathbf{W}_l} L_S(\\mathbf{W}^{(0)},\\theta) - \\nabla_{\\mathbf{W}_l} L_S(\\mathbf{W},\\theta) \\Bigr\\|_F^2 &\\leq  \\frac{1}{n}\\sum_{i=1}^n\\biggl\\|  \\mathbf{v}_i^{\\top}(\\text{Back}_{i,l+1}^{q,(0)}\\mathbf{D}^{(0)}_{i,l})\\cdot (\\mathbf{h}_{i,l-1}^{(0)} - \\mathbf{h}_{i,l-1})^{\\top}\\biggr\\|_F^2\\\\\n        & \\quad + \\frac{1}{n}\\sum_{i=1}^n \\biggl\\| \\mathbf{v}_i^{\\top}\\Bigl(\\text{Back}_{i,l+1}^{q,(0)}\\mathbf{D}^{(0)}_{i,l} - \\text{Back}_{i,l+1}^{q}\\mathbf{D}_{i,l}\\Bigr)\\cdot \\mathbf{h}_{i,l-1}^{\\top} \\biggr\\|_F^2\\\\\n        & \\leq O\\biggl( \\frac{\\omega^{2/3}L^4m\\log m}{nd} \\biggr)\\cdot \\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^2\\\\\n        & \\stackrel{\\text{\\ding{172}}}\\leq O\\biggl(\\frac{m\\delta}{n^3d}\\biggr)\\sum_{i=1}^n\\|\\mathbf{v}_i\\|_2^2\n    \n\\end{aligned}')
('9.3', '\\omega')
('9.3', 'l \\in [L]')
('9.3', '\\theta')
('9.3', '(\\mathbf{v}_i)_{i \\in [n]}')
('9.3', '\\|\\nabla_{\\theta}L_S(\\mathbf{W},\\theta)\\|_F')
('10.0', 'y = (y_{i})_{i \\in [k]}')
('10.0', 'g(y) = \\log(1+\\sum_{i=1}^k \\exp(y_i))')
('10.0', '1')
('10.0', '(y_{i})_{i \\in [k]}')
('10.0', "g(y+y') \\leq g(y) + \\nabla_y g(y)^{\\top}y' + \\frac{1}{2}\\|y'\\|_2^2")
('10.0', 'y = (y_{i})_{i=1}^k')
('10.0', '\\nabla^2g(y)')
('10.0', '(\\nabla^2g(y))_{i,i} = \\frac{\\exp(y_{i})}{(1+\\sum_{s=1}^k\\exp(y_{s}))^2}\\Bigl(1 + \\sum_{j \\neq i}\\exp(y_{j}) \\Bigr)')
('10.0', 'i \\in [k]')
('10.0', '\\sum_{i=1}^k (\\nabla^2g(y))_{i,i} \\leq 1')
('10.0', 'g(y)')
('10.0', '(\\lambda_i)_{i \\in [k]}')
('10.0', '\\nabla^2g(y)')
('10.0', '\\lambda_i \\geq 0')
('10.0', '\\|\\nabla^2g(y)\\|_2 \\leq \\sum_{i=1}^k\\lambda_i = \\sum_{i=1}^k (\\nabla^2g(y))_{i,i} \\leq 1')
('10.0', '\\|\\nabla^2g(y)\\|_2')
('10.0', 'y = (y_{i}) \\in \\mathbb{R}^k')
('10.0', '\\mathbf{W}, \\widetilde{\\mathbf{W}} \\in B(\\mathbf{W}^{(0)},\\omega)')
('10.0', '\\theta,\\widetilde{\\theta} \\in B(\\theta^{(0)},\\tau)')
('10.0', '\\omega, \\tau\\in [\\Omega(\\sqrt{d/m}),\\ O(1/ (L^{9/2} (\\log m)^{3/2}) )]')
('10.0', '1-e^{-\\Omega(m\\omega^{3/2}L)}-e^{-\\Omega(m\\tau^{3/2}L)}')
('10.0', '\\begin{aligned}\n        L_S(\\widetilde{\\mathbf{W}},\\widetilde{\\theta}) - L_S(\\mathbf{W},\\theta) &\\leq \\frac{1}{n}\\sum_{i=1}^n \\langle \\widetilde{\\textbf{loss}}_i, \\tilde{q}_i - q_i\\rangle + \\langle \\widehat{\\textbf{loss}}_i, \\tilde{k}_i - k_i\\rangle \\\\\n        & \\quad + O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\Bigl( \\tau^2\\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2^2 + \\omega^2\\|\\widetilde{\\theta} - \\theta\\|_2^2 \\Bigr)\n    \n\\end{aligned}')
('10.0', '\\begin{aligned}\n        L_S(\\mathbf{W},\\theta) &= \\frac{1}{n}\\sum_{i=1}^n \\mathbb{E}^{Neg(i)} [\\ell(f^q_{\\mathbf{W}},f^k_{\\theta},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)]\\\\\n        & = \\frac{1}{n}\\sum_{i=1}^n\\frac{1}{\\binom{n-1}{k}}\\sum_{\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset  S^{\\setminus i}} \\log \\biggl(1 + \\sum_{j=1}^k \\exp(q_i^{\\top}z_{i,j}) \\biggr)\\\\\n        & = \\frac{1}{n}\\sum_{i=1}^n \\sum_{j\\neq i} \\sum_{ \\mathbf{x}_{j} \\in \\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset  S^{\\setminus i}} \\frac{1}{\\binom{n-1}{k}}\\log \\biggl(1 + \\sum_{j=1}^k \\exp(q_i^{\\top}z_{i,j}) \\biggr) \n    \n\\end{aligned}')
('10.0', 'q_i := f^q_{\\mathbf{W}}(\\mathbf{x}_i)')
('10.0', 'z_{i,j}:= f^k_{\\theta}(\\mathbf{x}_{i,j}) - f^k_{\\theta}(\\mathbf{x}_i)')
('10.0', 'z_{j} = f^k_{\\theta}(\\mathbf{x}_{j}) - f^k_{\\theta}(\\mathbf{x}_i)')
('10.0', '\\widetilde{\\mathbf{W}} \\in B(\\mathbf{W}^{(0)},\\omega)')
('10.0', '\\widetilde{\\theta} \\in B(\\theta^{(0)},\\tau)')
('10.0', '\\tilde{q}_i :=  f^q_{\\widetilde{\\mathbf{W}}}(\\mathbf{x}_i),\\qquad \\tilde{z}_{i,j}:= f^k_{\\widetilde{\\theta}}(\\mathbf{x}_{i,j}) - f^k_{\\widetilde{\\theta}}(\\mathbf{x}_i)')
('10.0', '\\begin{aligned}\n        \\ell(f^q_{\\widetilde{\\mathbf{W}}},f^k_{\\widetilde{\\theta}},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) &=\\log \\biggl(1 + \\sum_{j=1}^k \\exp(\\tilde{q}_i^{\\top}\\tilde{z}_{i,j}) \\biggr) \\\\\n        &\\leq \\log \\biggl(1 + \\sum_{j=1}^k \\exp(q_i^{\\top}z_{i,j}) \\biggr) \\\\\n        &\\quad + \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot \\Bigl( \\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j} \\Bigr) \\\\\n        &\\quad + \\frac{1}{2} \\sum_{j=1}^k(\\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j})^2\\\\\n        & = \\ell(f^q_{\\mathbf{W}},f^k_{\\theta},\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) + \\Phi_1 + \\Phi_2\n    \n\\end{aligned}')
('10.0', '\\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j}')
('10.0', '\\label{eq:decomposition}\n        \\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j} = (\\tilde{q}_i - q_i)^{\\top}z_{i,j} +  q_i^{\\top}(\\tilde{z}_{i,j} - z_{i,j})+ (\\tilde{q}_i - q_i)^{\\top}(\\tilde{z}_{i,j} - z_{i,j})')
('10.0', '\\Phi_1')
('10.0', '\\begin{aligned}\n        \\Phi_1 &=  \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot \\Bigl( \\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j} \\Bigr)\\\\\n        & =  \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot z_{i,j}^{\\top} (\\tilde{q}_i - q_i)\\\\\n        &\\quad +  \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot  q_i^{\\top}  (\\tilde{z}_{i,j} - z_{i,j})\\\\\n        & \\quad + \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot (\\tilde{q}_i - q_i)^{\\top}(\\tilde{z}_{i,j} - z_{i,j})\\\\\n        & = \\Psi_1(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) + \\Psi_2(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) + \\Psi_3(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)\n    \n\\end{aligned}')
('10.0', '\\Psi_1(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)')
('10.0', '\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset S^{\\setminus i}')
('10.0', '\\begin{aligned}\n        \\mathbb{E}^{Neg(i)}[\\Psi_1(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)] & = \\mathbb{E}^{Neg(i)} \\biggl[\\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot z_{i,j}\\biggr]^{\\top} (\\tilde{q}_i - q_i)\\\\\n        & \\stackrel{\\text{\\ding{172}}}= \\langle \\widetilde{\\textbf{loss}}_i, (\\tilde{q}_i - q_i)\\rangle\n    \n\\end{aligned}')
('10.0', '\\label{eq:Phi-1}\n        \\frac{1}{n}\\sum_{i=1}^n \\mathbb{E}^{Neg(i)}[\\Psi_1(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)] = \\frac{1}{n} \\sum_{i=1}^n \\langle \\widetilde{\\textbf{loss}}_i , \\tilde{q}_i - q_i\\rangle')
('10.0', '\\Psi_2(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)')
('10.0', '\\begin{aligned}\n\\label{eq:Psi-2-expectation}\n        & \\frac{1}{n} \\sum_{i=1}^n\\mathbb{E}^{Neg(i)}[\\Psi_2(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)] \\nonumber\\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\frac{1}{\\binom{n-1}{k}}\\sum_{  \\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset  S^{\\setminus i}} \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot  q_i^{\\top}  (\\tilde{z}_{i,j} - z_{i,j}) \\nonumber\\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\frac{1}{\\binom{n-1}{k}}\\sum_{ \\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset  S^{\\setminus i}} \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot  q_i^{\\top}  (\\tilde{z}_{i,j} - z_{i,j})\n    \n\\end{aligned}')
('10.0', 'k_{i,j} = f^k_{\\theta}(\\mathbf{x}_{i,j}),\\quad \\tilde{k}_{i,j} = f^k_{\\widetilde{\\theta}}(\\mathbf{x}_{i,j}),\\quad k_{i} = f^k_{\\theta}(\\mathbf{x}_{i}),\\quad \\tilde{k}_{i} = f^k_{\\widetilde{\\theta}}(\\mathbf{x}_{i})')
('10.0', '\\begin{aligned}\n        &\\frac{1}{n} \\sum_{i=1}^n\\mathbb{E}^{Neg(i)}[\\Psi_2(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)] \\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\sum_{j \\neq i} \\frac{1}{\\binom{n-1}{k}}\\sum_{ \\mathbf{x}_{j} \\in \\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset  S^{\\setminus i}} \\frac{\\exp(q_i^{\\top}(k_j - k_i) )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot  q_i^{\\top} \\Bigl((\\tilde{k}_j - k_j) - (\\tilde{k}_i - k_i) \\Bigr)\\\\\n        \\stackrel{\\text{\\ding{172}}}= \\ & \\frac{1}{n}\\sum_{i=1}^n \\sum_{j \\neq i}\\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j)^{\\top} \\Bigl((\\tilde{k}_j - k_j) - (\\tilde{k}_i - k_i) \\Bigr)\\\\\n        = \\ & \\frac{1}{n} \\sum_{i=1}^n \\sum_{j\\neq i} (\\widehat{\\textbf{loss}}(\\mathbf{x}_j,\\mathbf{x}_i) - \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j))^{\\top} (\\tilde{k}_i - k_i)\\\\\n        \\stackrel{\\text{\\ding{173}}}= \\ & \\frac{1}{n}\\sum_{i=1}^n \\langle \\widehat{\\textbf{loss}}_i, \\tilde{k}_i - k_i\\rangle\n    \n\\end{aligned}')
('10.0', '\\Psi_3(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)')
('10.0', '\\begin{aligned}\n        \\Psi_3(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k) &\\leq \\sum_{j = 1}^k \\frac{\\exp(q_i^{\\top}z_{i,j} )}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top}z_{i,s})}\\cdot \\|\\tilde{q}_i - q_i\\|_2\\cdot\\|\\tilde{z}_{i,j} - z_{i,j}\\|_2\\\\\n        & \\stackrel{\\text{\\ding{172}}}\\leq O\\biggl(\\frac{L^2m}{d}\\biggr)\\cdot \\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2\\cdot\\|\\widetilde{\\theta} - \\theta\\|_2\\\\\n        & \\leq O\\biggl(\\frac{L^2m}{d}\\biggr)\\Bigl( \\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2^2 + \\|\\widetilde{\\theta} - \\theta\\|_2^2\\Bigr)\n    \n\\end{aligned}')
('10.0', '\\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2 \\leq \\omega')
('10.0', '\\|\\widetilde{\\theta} - \\theta\\|_2 \\leq \\tau')
('10.0', '\\frac{1}{n}\\sum_{i=1}^n\\mathbb{E}^{Neg(i)}[\\Psi_3(\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)] \\leq O\\biggl(\\frac{L^2m}{d}\\biggr)\\Bigl( \\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2^2 + \\|\\widetilde{\\theta} - \\theta\\|_2^2\\Bigr)')
('10.0', '\\Phi_2')
('10.0', '\\begin{aligned}\n        \\Phi_2 &= \\frac{1}{2} \\sum_{j=1}^k(\\tilde{q}_i^{\\top}\\tilde{z}_{i,j} - q_i^{\\top}z_{i,j})^2 \\\\\n        & \\leq \\frac{3}{2} \\sum_{j=1}^k \\Bigl( \\|\\tilde{q}_i - q_i\\|_2^2\\cdot \\|z_{i,j}\\|_2^2 + \\|q_i\\|_2^2\\cdot\\|\\tilde{z}_{i,j} - z_{i,j}\\|_2^2 + \\|\\tilde{q}_i - q_i\\|_2^2\\cdot\\|\\tilde{z}_{i,j} - z_{i,j}\\|_2^2 \\Bigr)\\\\\n        &\\stackrel{\\text{\\ding{172}}}\\leq O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\cdot \\Bigl( \\tau^2\\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2^2 + \\omega^2\\|\\widetilde{\\theta} - \\theta\\|_2^2 + \\tau\\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2 \\cdot \\omega\\|\\widetilde{\\theta} - \\theta\\|_2^2 \\Bigr)\\\\\n        & \\stackrel{\\text{\\ding{173}}}\\leq  O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\cdot \\Bigl( \\tau^2\\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2^2 + \\omega^2\\|\\widetilde{\\theta} - \\theta\\|_2^2 \\Bigr)\n    \n\\end{aligned}')
('10.0', '\\|q_i\\|_2^2, \\|z_{i,j}\\|_2^2 \\leq O(1)')
('10.0', '\\omega L\\sqrt{m/d}')
('10.0', '\\|\\tilde{q}_i - q_i\\|_2^2 \\leq O\\biggl(\\frac{L^2m}{d}\\biggr)\\cdot\\|\\widetilde{\\mathbf{W}} - \\mathbf{W}\\|_2^2,\\qquad \\|\\tilde{z}_{i,j} - z_{i,j}\\|_2^2 \\leq O\\biggl(\\frac{L^2m}{d}\\biggr)\\cdot\\|\\widetilde{\\theta} - \\theta\\|_2^2')
('10.0', '\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset S^{\\setminus i}')
('10.0', 'i \\in [n]')
('10.1', "\\mathbf{W}',\\theta'")
('10.1', "\\|\\mathbf{W}'\\|_2 \\leq \\omega,\\ \\|\\theta'\\|_2 \\leq \\tau")
('10.1', "\\tilde{q}_i = f^q_{\\mathbf{W}+\\mathbf{W}'}(\\mathbf{x}_i), \\qquad q_i = f^q_{\\mathbf{W}}(\\mathbf{x}_i), \\qquad \\tilde{k}_i = f^k_{\\theta+\\theta'}(\\mathbf{x}_i), \\qquad k_i = f^k_{\\theta}(\\mathbf{x}_i).")
('10.1', "\\begin{aligned}\n        &L_S(\\mathbf{W}+ \\mathbf{W}',\\theta + \\theta') - L_S(\\mathbf{W},\\theta) - \\langle \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta),\\mathbf{W}'\\rangle - \\langle \\nabla_{\\theta}L_S(\\mathbf{W},\\theta),\\theta'\\rangle \\\\\n        \\leq \\ &- \\langle \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta),\\mathbf{W}'\\rangle - \\langle \\nabla_{\\theta}L_S(\\mathbf{W},\\theta),\\theta'\\rangle + \\frac{1}{n}\\sum_{i=1}^n \\langle \\widetilde{\\textbf{loss}}_i, \\tilde{q}_i - q_i\\rangle + \\langle \\widehat{\\textbf{loss}}_i, \\tilde{k}_i - k_i\\rangle  \\\\\n        & + O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\Bigl( \\tau^2\\|\\mathbf{W}'\\|_2^2 + \\omega^2\\|\\theta'\\|_2^2 \\Bigr)\\\\\n        = \\ & F_1 + F_2 + F_3\n    \n\\end{aligned}")
('10.1', "\\begin{aligned}\n        F_1 & = - \\langle \\nabla_{\\mathbf{W}}L_S(\\mathbf{W},\\theta),\\mathbf{W}'\\rangle + \\frac{1}{n}\\sum_{i=1}^n \\langle \\widetilde{\\textbf{loss}}_i, \\tilde{q}_i - q_i\\rangle\\\\\n        F_2 & = - \\langle \\nabla_{\\theta}L_S(\\mathbf{W},\\theta),\\theta'\\rangle + \\frac{1}{n}\\sum_{i=1}^n\\langle \\widehat{\\textbf{loss}}_i, \\tilde{k}_i - k_i\\rangle\\\\\n        F_3 & = O\\biggl(\\frac{kL^2m^2}{d^2}\\biggr)\\Bigl( \\tau^2\\|\\mathbf{W}'\\|_2^2 + \\omega^2\\|\\theta'\\|_2^2 \\Bigr)\n    \n\\end{aligned}")
('10.1', 'F_1')
('10.1', 'F_2')
('10.1', 'F_1')
('10.1', 'F_1')
('10.1', 'F_1 = \\frac{1}{n}\\sum_{i=1}^n F_1^i')
('10.1', 'F_1^i')
('10.1', "\\begin{aligned}\n        F_1^i = \\ & \\widetilde{\\textbf{loss}}_i^{\\top} \\Biggl(f^q_{\\mathbf{W}+ \\mathbf{W}'}(\\mathbf{x}_i) - f^q_{\\mathbf{W}}(\\mathbf{x}_i) - \\sum_{l=0}^L \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}\\mathbf{W}'_{l}\\mathbf{h}_{i,l-1} \\Biggr)\\\\\n        = \\ & \\widetilde{\\textbf{loss}}_i^{\\top} \\Biggl((\\mathbf{W}_L+\\mathbf{W}'_L)\\mathbf{h}'_{i,L-1} - \\mathbf{W}_L\\mathbf{h}_{i,L-1} - \\sum_{l=0}^L \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}\\mathbf{W}'_{l}\\mathbf{h}_{i,l-1} \\Biggr)\n    \n\\end{aligned}")
('10.1', "\\mathbf{h}'_{i,-1} = \\mathbf{x}_i,\\qquad \\mathbf{h}'_{i,l} = \\sigma((\\mathbf{W}_l + \\mathbf{W}'_l)\\mathbf{h}'_{i,l-1})\\quad \\text{for } 0 \\leq l \\leq L-1")
('10.1', 'i\\in [n]')
('10.1', 'k \\in [m]')
('10.1', "\\mathbf{D}''_{i,l}")
('10.1', "|(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})_{k,k}| \\leq 1")
('10.1', "\\begin{aligned}\n        &(\\mathbf{W}_L+\\mathbf{W}'_L)\\mathbf{h}'_{i,L-1} - \\mathbf{W}_L\\mathbf{h}_{i,L-1} \\\\\n        = \\ & \\mathbf{W}'_L\\mathbf{h}'_{i,L-1} + \\sum_{l=0}^{L-1} \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\mathbf{W}_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})\\mathbf{W}'_{l}\\mathbf{h}'_{i,l-1}\n    \n\\end{aligned}")
('10.1', "\\begin{aligned}\n        F_1^i &= \\widetilde{\\textbf{loss}}_i^{\\top}   \\biggl[ \\mathbf{W}'_L\\mathbf{h}'_{i,L-1} + \\sum_{l=0}^{L-1}\\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\mathbf{W}_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})\\mathbf{W}'_{l}\\mathbf{h}'_{i,l-1} \\nonumber\\\\\n        &\\qquad \\qquad \\qquad - \\mathbf{W}'_L\\mathbf{h}_{i,L-1} +\\sum_{l=0}^{L-1}\\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}\\mathbf{W}'_{l}\\mathbf{h}_{i,l-1}\\biggr] \\nonumber\\\\\n        & = \\widetilde{\\textbf{loss}}_i^\\top \\sum_{l=0}^{L-1}\\biggl[ \\mathbf{W}_L\\prod_{a=l+1}^{L-1} \\bigl((\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\mathbf{W}_{a}\\bigr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l}) - \\mathbf{W}_L\\prod_{a=l+1}^{L-1} \\bigl(\\mathbf{D}_{i,a}\\mathbf{W}_{a}\\bigr)\\mathbf{D}_{i,l}\\biggr]\\mathbf{W}'_{l}\\mathbf{h}'_{i,l-1}\\nonumber \\\\\n        & \\qquad + \\widetilde{\\textbf{loss}}_i^{\\top} \\biggl[\\mathbf{W}'_L + \\sum_{l=0}^{L-1} \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^L \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}\\mathbf{W}'_{l} \\biggr](\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1})\\nonumber \\\\\n        & =  \\sum_{l=0}^{L-1}Q_1^l + \\sum_{l=0}^LQ_2^l\\label{eq:semi-1-decom-2}\n    \n\\end{aligned}")
('10.1', 'Q_1^l')
('10.1', 'Q_2^l')
('10.1', 'Q_1^l')
('10.1', 's = O(m\\omega^{2/3}L)')
('10.1', 's')
('10.1', "\\mathbf{h}'_{i,l-1}")
('10.1', "\\begin{aligned}\n        Q_1^l & = \\widetilde{\\textbf{loss}}_i^\\top \\biggl[ \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^L (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\mathbf{W}_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})- \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^L \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}\\biggr]\\mathbf{W}'_{l}\\mathbf{h}'_{i,l-1} &\\nonumber\\\\\n        & \\leq \\|\\widetilde{\\textbf{loss}}_i\\|\\Biggl\\| \\mathbf{W}_L\\prod_{a=l+1}^L \\bigl((\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\mathbf{W}_{a}\\bigr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l}) - \\mathbf{W}_L\\prod_{a=l+1}^L (\\mathbf{D}_{i,a}\\mathbf{W}_{a})\\mathbf{D}_{i,l}\\Biggr\\| \\|\\mathbf{W}'_{l}\\mathbf{h}'_{i,l-1}\\| \\nonumber \\\\\n        & \\leq \\|\\widetilde{\\textbf{loss}}_i\\|_2 \\cdot O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m\\log m}}{\\sqrt{d}}\\biggr) \\cdot \\|\\mathbf{W}'_l\\|_F \\label{eq:Q-1-bound}\n    \n\\end{aligned}")
('10.1', 'Q_2^l')
('10.1', 'l = L')
('10.1', "Q_2^l \\leq \\|\\widetilde{\\textbf{loss}}_i\\|_2\\cdot\\|\\mathbf{W}'_L\\|_2\\cdot\\|\\mathbf{h}'_{i,L-1} -\\mathbf{h}_{i,L-1}\\|_2 \\leq \\|\\widetilde{\\textbf{loss}}_i\\|_2\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2\\sqrt{\\log m}}{\\sqrt{d}}\\biggr)\\cdot\\|\\mathbf{W}'\\|_F")
('10.1', 'l\\leq L-1')
('10.1', "\\begin{aligned}\n        Q_2^l & = \\widetilde{\\textbf{loss}}_i^{\\top} \\biggl[\\mathbf{W}_L\\biggl(\\prod_{a=l+1}^L \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}\\mathbf{W}'_{l} \\biggr](\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1})\\\\\n        & =  \\widetilde{\\textbf{loss}}_i^{\\top}\\biggl[\\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,a}\\mathbf{W}_{a}\\biggr)\\mathbf{D}_{i,l}-\\mathbf{B}\\biggl(\\prod_{a=l+1}^L \\mathbf{D}^{0}_{i,a}\\mathbf{W}^{(0)}_{a}\\biggr)\\mathbf{D}^{(0)}_{i,l} \\biggr]\\mathbf{W}'_{l} (\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1})\\\\\n        &\\qquad +  \\widetilde{\\textbf{loss}}_i^{\\top} \\mathbf{W}_L\\biggl(\\prod_{a=l+1}^{L-1} \\mathbf{D}^{(0)}_{i,a}\\mathbf{W}^{(0)}_{a}\\biggr)\\mathbf{D}^{(0)}_{i,l}\\mathbf{W}'_{l} (\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1})\\\\\n        & \\leq \\|\\widetilde{\\textbf{loss}}_i\\|_2 \\cdot O\\biggl(\\sqrt{\\frac{m}{d}}  + \\frac{\\omega^{1/3}L^2 \\sqrt{m\\log m}}{\\sqrt{d}}\\biggr)\\cdot\\|\\mathbf{W}'_l\\|_F\\cdot\\|\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1}\\|_2 \n    \n\\end{aligned}")
('10.1', "\\|\\mathbf{h}'_{i,l} - \\mathbf{h}_{i,l}\\| \\leq O(L^{3/2})\\|\\mathbf{W}\\|_2")
('10.1', '\\omega')
('10.1', "Q_2^l \\leq \\|\\widetilde{\\textbf{loss}}_i\\|_2 \\cdot O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m\\log m}}{\\sqrt{d}}\\biggr)\\cdot \\|\\mathbf{W}'_l\\|_F \\label{eq:Q-2-bound}")
('10.1', "\\label{eq:F-1-bound}\n        \\begin{split}\n        F_1 = \\frac{1}{n}\\sum_{i=1}^n F_1^i &\\leq \\frac{1}{n}\\sum_{i=1}^n \\sum_{l =0}^L\\|\\widetilde{\\textbf{loss}}_i\\|_2\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m\\log m}}{\\sqrt{d}}\\biggr)\\cdot \\|\\mathbf{W}'_l\\|_F \\\\\n        & \\leq \\|\\widetilde{\\textbf{loss}}\\|_2\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2 \\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr)\\cdot \\|\\mathbf{W}'\\|_F\n        \\end{split}")
('10.1', 'F_1')
('10.1', 'F_2')
('10.1', "\\langle \\nabla_{\\theta} L_S(\\mathbf{W},\\theta),\\theta'\\rangle")
('10.1', "\\begin{aligned}\n \\label{eq:first-order-term}\n        &\\langle \\nabla_{\\theta} L_S(\\mathbf{W},\\theta),\\theta'\\rangle \\nonumber\\\\\n        = \\ & \\biggl\\langle \\frac{1}{n}\\sum_{i=1}^n \\mathbb{E}^{Neg} \\biggl[\\nabla_{\\theta}\\ell(\\mathbf{W},\\theta,\\mathbf{x}_i,\\{\\mathbf{x}_{i,j}\\}_{j=1}^k)\\biggr] , \\theta'\\biggr\\rangle \\nonumber \\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\frac{1}{\\binom{n-1}{k}} \\sum_{\\{\\mathbf{x}_{i,j}\\}_{j=1}^k \\subset S^{\\setminus i}} \\sum_{j=1}^k \\frac{\\exp(q_i^{\\top}z_{i,j})}{1 + \\sum_{s=1}^k \\exp(q_i^{\\top} z_{i,s})} \\bigl\\langle\\nabla_{\\theta}\\, q_i^{\\top}(f^k_{\\theta}(\\mathbf{x}_{i,j}) - f^k_{\\theta}(\\mathbf{x}_{i})), \\theta' \\bigr\\rangle \\nonumber\\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\sum_{j\\neq i}  \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j)^{\\top}  \\Bigl(\\nabla_{\\theta} f^k_{\\theta}(\\mathbf{x}_{j})(\\theta') - \\nabla_{\\theta}f^k_{\\theta}(\\mathbf{x}_{i}) (\\theta')\\Bigr) \\nonumber\\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\sum_{j \\neq i} \\bigl(\\widehat{\\textbf{loss}}(\\mathbf{x}_j,\\mathbf{x}_i)- \\widehat{\\textbf{loss}}(\\mathbf{x}_i,\\mathbf{x}_j)\\bigr)^{\\top}  \\nabla_{\\theta} f^k_{\\theta}(\\mathbf{x}_{i}) (\\theta')  \\nonumber\\\\\n        = \\ & \\frac{1}{n}\\sum_{i=1}^n \\widehat{\\textbf{loss}}_i^{\\top} \\nabla_{\\theta} f^k_{\\theta}(\\mathbf{x}_{i}) (\\theta') \n    \n\\end{aligned}")
('10.1', "\\nabla_{\\theta}f^k_{\\theta}(\\mathbf{x}_i) (\\theta') := \\sum_{l=0}^L \\theta_L\\mathbf{D}_{i,L-1}\\theta_{L-1}\\cdots\\theta_{l+1}\\mathbf{D}_{i,l}\\,\\theta'_{l}\\,\\mathbf{h}_{i,l-1}")
('10.1', 'F_2 = \\frac{1}{n}\\sum_{i=1}^n F_2^i')
('10.1', "\\label{eq:F-2-i}\n        F_2^i = \\widehat{\\textbf{loss}}_i^{\\top} \\biggl[ (\\theta_L + \\theta'_L) \\mathbf{h}'_{i,L} - \\theta_L\\mathbf{h}_{i,L} - \\sum_{l=0}^L\\theta_L\\biggl( \\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,L}\\theta_a\\biggr)\\mathbf{D}_{i,l}\\,\\theta'_{l}\\,\\mathbf{h}_{i,l-1} \\biggr]")
('10.1', "\\begin{aligned}\n        (\\theta_L + \\theta'_L) \\mathbf{h}'_{i,L-1} - \\theta_L\\mathbf{h}_{i,L-1} &= \\theta'_L\\mathbf{h}'_{i,L-1} + \\sum_{l=0}^{L-1} \\biggl(\\prod_{a=l+1}^{L-1} (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\theta_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})\\,\\theta'_{l}\\,\\mathbf{h}'_{i,l-1}\n    \n\\end{aligned}")
('10.1', "\\begin{aligned}\n        F_2^i &=\\widehat{\\textbf{loss}}_i^{\\top}\\biggl[ \\theta'_L\\mathbf{h}'_{i,L-1} + \\sum_{l=1}^{L-1}\\theta_L\\biggl(\\prod_{a=l+1}^{L-1} (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\theta_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})\\theta'_{l}\\,\\mathbf{h}'_{i,l-1}\\biggr] \\\\\n        & \\qquad - \\widehat{\\textbf{loss}}_i^{\\top}\\sum_{l=0}^L\\theta_L\\biggl( \\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,a}\\theta_a\\biggr)\\mathbf{D}_{i,l}\\,\\theta'_{l}\\,\\mathbf{h}_{i,l-1}\\\\\n        & = \\sum_{l=0}^{L-1}\\widehat{\\textbf{loss}}_i^{\\top} \\Biggl[ \\theta_L\\biggl(\\prod_{a=l+1}^{L-1} (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\theta_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l})\\, \\theta'_{l}\\, - \\theta_L\\biggl(\\prod_{a=l+1}^{L-1} \\mathbf{D}_{i,a}\\theta_{a}\\biggr)\\mathbf{D}_{i,l}\\, \\theta'_{l}\\, \\Biggr]\\mathbf{h}'_{i,l-1} \\\\\n        & \\quad + \\sum_{l=0}^L \\widehat{\\textbf{loss}}_i^{\\top}\\theta_L\\biggl(\\prod_{a=l+1}^L \\mathbf{D}_{i,a}\\theta_{a}\\biggr)\\mathbf{D}_{i,l}\\, \\theta'_{l}\\, \\bigl(\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1}\\bigr)\\\\\n        & = F^i_{2,1} + F^i_{2,2}\n    \n\\end{aligned}")
('10.1', 'F^i_{2,1}')
('10.1', "\\begin{aligned}\n        F^i_{2,1} \\stackrel{\\text{\\ding{172}}}\\leq \\ &  \\sum_{l=0}^{L-1} \\|\\widehat{\\textbf{loss}}_i\\|_2 \\biggl\\|\\theta_L\\biggl(\\prod_{a=l+1}^L (\\mathbf{D}_{i,a} + \\mathbf{D}''_{i,a})\\theta_{a}\\biggr)(\\mathbf{D}_{i,l}+\\mathbf{D}''_{i,l}) - \\theta_L\\biggl(\\prod_{a=l+1}^L \\mathbf{D}_{i,a}\\theta_{a}\\biggr)\\mathbf{D}_{i,l} \\biggr\\|_2\\|\\theta'_{l}\\|_F\\\\\n        \\stackrel{\\text{\\ding{173}}}\\leq \\ & \\|\\widehat{\\textbf{loss}}_i\\|\\cdot O\\biggl(\\frac{\\omega^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{d}}\\biggr)\\cdot \\|\\theta'\\|_F\n    \n\\end{aligned}")
('10.1', "\\|\\mathbf{h}'_{i,l-1}\\|_2")
('10.1', "\\begin{aligned}\n        F^i_{2,2} &\\leq \\sum_{l=0}^{L-1} \\|\\widehat{\\textbf{loss}}_i\\|_2\\cdot O\\biggl(\\sqrt{\\frac{m}{d}}+ \\frac{\\tau^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{d}}\\biggr)\\cdot \\|\\theta'_l\\|_F\\cdot\\|\\mathbf{h}'_{i,l-1} -\\mathbf{h}_{i,l-1}\\|_2\\\\\n        & \\leq \\|\\widehat{\\textbf{loss}}_i\\|_2\\cdot O\\biggl(\\frac{\\tau^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{d}}\\biggr)\\cdot \\|\\theta'\\|_F\n    \n\\end{aligned}")
('10.1', '\\tau')
('10.1', "\\begin{aligned}\n        F_2 = \\frac{1}{n}\\sum_{i=1}^n F_2^i =\\frac{1}{n}\\sum_{i=1}^n (F^i_{2,1}+F^i_{2,2}) \\leq  \\|\\widehat{\\textbf{loss}}\\|_2\\cdot O\\biggl(\\frac{\\tau^{1/3}L^2\\sqrt{m\\log m}}{\\sqrt{nd}}\\biggr)\\cdot \\|\\theta'\\|_F\n    \n\\end{aligned}")
