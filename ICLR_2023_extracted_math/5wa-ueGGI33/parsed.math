('3.0', '\\mathcal{D}')
('3.0', 'K')
('3.0', '\\mathbf{x}_{k,i}')
('3.0', 'i')
('3.0', 'k')
('3.0', '\\mathbf{z}_{k,i} \\in \\mathbb{R}^d')
('3.0', '\\mathbf{W} = [\\mathbf{w}_1, ..., \\mathbf{w}_K] \\in \\mathbb{R}^{d \\times K}')
('3.0', '\\mathbf{m}_k \\in \\mathbb{R}^d')
('3.0', 'k=1,2,...,K, d \\ge K-1')
('3.0', 'k')
('3.0', '\\label{eq1}\n    \\mathbf{M}=\\sqrt{\\frac{K}{K-1}} \\mathbf{P} (\\mathbf{I}_K - \\frac{1}{K} \\mathbf{1}_K \\mathbf{1}_K^\\mathrm{T})')
('3.0', '\\mathbf{M}=[\\mathbf{m}_1, ..., \\mathbf{m}_K] \\in \\mathbb{R}^{d \\times K}')
('3.0', '\\mathbf{P} \\in \\mathbb{R}^{d \\times K}')
('3.0', '\\mathbf{P}^\\mathrm{T} \\mathbf{P} = \\mathbf{I}_K')
('3.0', '\\mathbf{I}_K')
('3.0', '\\mathbf{1}_K')
('3.0', '-\\frac{1}{K-1}')
('3.0', '\\mathbf{z}_{k,i}')
('3.0', 'k')
('3.0', '\\mathbf{\\overline{z}}_k = {\\rm Avg}_i \\{\\mathbf{z}_{k,i}\\}')
('3.0', '\\mathbf{z}_G={\\rm Avg}_{i,k} \\{\\mathbf{z}_{k,i}\\}, k \\in [1,...,K]')
('3.0', '\\mathbf{{\\tilde{z}}}_k = (\\mathbf{z}_k - \\mathbf{z}_G)/ \\lVert\\mathbf{z}_k - \\mathbf{z}_G \\rVert')
('3.0', '\\mathbf{w}_k')
('3.0', '\\mathbf{{\\tilde{z}}}_k')
('3.0', '\\mathbf{{\\tilde{z}}}_k = \\mathbf{w}_k / ||\\mathbf{w}_k||')
('3.0', '\\mathbf{z}')
('3.0', '\\arg\\max_k \\langle \\mathbf{z}, \\mathbf{w}_k \\rangle = \\arg\\min_k ||\\mathbf{z} - \\mathbf{\\overline{z}}_k||')
('3.1', '{\\rm \\mathcal{NC}_1}=\\frac{1}{K} {\\rm Tr}(\\Sigma_W\\Sigma_B^\\dag)')
('3.1', '{\\rm Tr}')
('3.1', '\\Sigma_B^\\dag')
('3.1', '\\Sigma_B')
('3.1', '\\Sigma_B = \\frac{1}{K} \\sum\\limits_{k \\in [K]} (\\mathbf{\\overline{z}}_k - \\mathbf{z}_G)(\\mathbf{\\overline{z}}_k - \\mathbf{z}_G)^\\mathrm{T}')
('3.1', '\\Sigma_W=\\frac{1}{K}\\sum\\limits_{k \\in [K]} \\frac{1}{n_k} \\sum\\limits_{i=1}^{n_k} (\\mathbf{z}_{k,i} - \\mathbf{\\overline{z}}_k)(\\mathbf{z}_{k,i} - \\mathbf{\\overline{z}}_k)^\\mathrm{T}')
('3.1', '{\\rm \\mathcal{NC}_2}=  \\Big\\lVert \\frac{\\mathbf{W}\\mathbf{W}^\\mathrm{T}}{||\\mathbf{W}\\mathbf{W}^\\mathrm{T}||_\\mathcal{F}} - \\frac{1}{\\sqrt{K-1}}(\\mathbf{I}_K-\\frac{1}{K}\\mathbf{1}_K \\mathbf{1}_K^\\mathrm{T}) \\Big\\rVert_\\mathcal{F}')
('3.1', '{\\rm \\mathcal{NC}_3}=  \\Big\\lVert \\frac{\\mathbf{W}\\mathbf{\\overline{Z}}}{||\\mathbf{W}\\mathbf{\\overline{Z}}||_\\mathcal{F}} - \\frac{1}{\\sqrt{K-1}}(\\mathbf{I}_K-\\frac{1}{K}\\mathbf{1}_K \\mathbf{1}_K^\\mathrm{T}) \\Big\\rVert_\\mathcal{F}')
('3.1', '\\mathbf{\\overline{Z}}=[\\mathbf{\\overline{z}}_1 - \\mathbf{z}_G, ..., \\mathbf{\\overline{z}}_K - \\mathbf{z}_G]')
('3.1', '\\blacktriangle')
('3.1', '\\blacktriangledown')
('4.1', '\\mathbf{M} \\in \\mathbb{R}^{d \\times B}')
('4.1', 'd')
('4.1', '\\mathbf{M}')
('4.1', '\\mathbf{b}_i \\in \\{1,...,B\\}')
('4.1', '[\\mathbf{m}_1,...,\\mathbf{m}_B]')
('4.1', 'b')
('4.1', 'E_\\phi')
('4.1', 'F_\\theta')
('4.1', 'i')
('4.1', '\\mathbf{x}_{i,b}')
('4.1', 'b')
('4.1', '\\mathbf{z}_{i,b}=E_\\phi(\\mathbf{x}_{i,b})')
('4.1', '\\mathbf{m}_b')
('4.1', 'b')
('4.1', 'F_\\theta')
('4.1', '\\mathbf{z}_{i,b}')
('4.1', '\\mathbf{m}_b')
('4.1', '\\hat{\\mathbf{y}}=F_\\theta(\\mathbf{z}_{i,b},\\mathbf{m}_b)')
('4.1', '\\begin{aligned}\n    \\min_{\\phi,\\theta} \\mathcal{L}_{\\rm CE}(\\mathbf{x}, \\mathbf{y}) = \\sum\n    _{i=1}^N\\mathcal{L}(F_\\theta(\\mathbf{z}_{i,b},\\mathbf{m}_b), \\mathbf{y}_{i,b})\n\\label{loss}\n\\end{aligned}')
('4.1', '\\mathbf{y}')
('4.1', '\\mathcal{L}')
('4.1', '\\mathbf{z}_{i,b}')
('4.1', '\\mathbf{m}_b')
('4.1', '\\label{eq:regularization}\n\\resizebox{0.9\\hsize}{!}{\n    $\\mathcal{L}_{\\rm RE}(\\mathbf{x}, \\mathbf{b}) = \\sum_{i=1}^N \\mathcal{L}(F_\\theta(\\mathbf{z}_{i,b},\\mathbf{m}_b)-F_\\theta(\\mathbf{z}_{i,b},\\mathbf{m}_{\\rm null}), \\mathbf{b})$}')
('4.1', '\\mathbf{m}_{\\rm null}')
('4.1', '\\mathbf{m}_b')
('4.1', '\\mathcal{L}')
('4.1', '\\label{objective}\n    \\min_{\\phi,\\theta} \\mathcal{L}_{\\rm CE}(\\mathbf{x}, \\mathbf{y}) + \\alpha \\mathcal{L}_{\\rm RE}(\\mathbf{x}, \\mathbf{b})')
('4.1', '\\alpha')
('4.1', '\\mathbf{x}_{i,b}')
('4.1', '\\mathbf{z}_{i,b}')
('4.1', '\\mathbf{m}_{\\rm null}')
('4.1', '\\hat{\\mathbf{y}}=F_\\theta(\\mathbf{z}_{i,b},\\mathbf{m}_{\\rm null})')
('4.2', 'i')
('4.2', 'k')
('4.2', '\\widetilde{\\mathbf{z}}_{k,i}=[\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}] \\in \\mathbb{R}^{2 \\times d}')
('4.2', '\\mathbf{z}_{k,i}')
('4.2', '\\mathbf{m}_{i,b}')
('4.2', 'b')
('4.2', '\\widetilde{\\mathbf{w}}_k=[\\mathbf{w}_{k}, \\mathbf{a}_k] \\in \\mathbb{R}^{2 \\times d}')
('4.2', '\\mathbf{w}_{k}')
('4.2', '\\mathbf{a}_k')
('4.2', '\\mathbf{a}_k')
('4.2', 'k')
('4.2', "\\resizebox{\\hsize}{!}{\n    $\\mathcal{L}_{\\rm CE}(\\widetilde{\\mathbf{z}}_{k,i}, \\widetilde{\\mathbf{w}}_k) = -\\log \\left( \\frac{\\exp([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k}, \\mathbf{a}_k])}{\\sum_{k'=1}^K \\exp([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_k'])} \\right)$}\n\\label{eq:ce}")
('4.2', '\\mathcal{L}_{\\rm CE}')
('4.2', '\\mathcal{L}_{\\rm CE}')
('4.2', '\\mathbf{\\widetilde{W}}=[\\widetilde{\\mathbf{w}}_1...,\\widetilde{\\mathbf{w}}_K]')
('4.2', "\\begin{aligned}\n\\label{eq:wrt_w}\n    \\frac{\\partial \\mathcal{L}_{\\rm CE}}{\\partial \\widetilde{\\mathbf{w}}_k} \n    &= \\sum_{i=1}^{n_k} -(1-p_k(\\widetilde{\\mathbf{z}}_{k,i}))\\widetilde{\\mathbf{z}}_{k,i} + \\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} p_k(\\widetilde{\\mathbf{z}}_{k',j})\\widetilde{\\mathbf{z}}_{k',j} \\nonumber\\\\\n    &\\le \\underbrace{\\sum_{i=1}^{n_k} - (1 - p_k^{(b)}(\\mathbf{m}_{i,b}) - p_k^{(l)}(\\mathbf{z}_{k,i}) ) \\widetilde{\\mathbf{z}}_{k,i}}_{\\rm pulling \\ part} \\nonumber\\\\\n    & + \\underbrace{\\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} (p_k^{(b)}(\\mathbf{m}_{j,b'}) + p_k^{(l)}(\\mathbf{z}_{k',j}) )\\widetilde{\\mathbf{z}}_{k',j}}_{\\rm forcing \\ part}\n\\end{aligned}")
('4.2', 'p_k^{(l)}')
('4.2', 'p_k^{(b)}')
('4.2', "\\begin{aligned}\n    p_k^{(l)}(\\mathbf{z}_{k,i}) = \\frac{\\exp (\\mathbf{z}_{k,i}^\\mathrm{T}\\mathbf{w}_{k})}{\\sum_{k'=1}^K \\exp ([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_{k'}])}\n\\label{eq:pk_1}\n\\end{aligned}")
('4.2', "p_k^{(b)}(\\mathbf{m}_{i,b}) = \\frac{\\exp (\\mathbf{m}_{i,b}^\\mathrm{T}\\mathbf{a}_{k})}{\\sum_{k'=1}^K \\exp ([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_{k'}])}\n\\label{eq:pk_2}")
('4.2', '\\mathbf{w}_k')
('4.2', 'k')
('4.2', '\\mathbf{w}_k')
('4.2', '\\widetilde{\\mathbf{z}}_{k,i}')
('4.2', '\\widetilde{\\mathbf{w}}_k')
('4.2', 'k')
('4.2', 'b')
('4.2', '\\mathbf{a}_k')
('4.2', '\\mathbf{m}_b')
('4.2', 'p_k^{(b)}\\propto\\exp(\\mathbf{m}_{b}^\\mathrm{T}\\mathbf{a}_{k})')
('4.2', '\\mathbf{m}_{b}')
('4.2', "\\mathbf{m}_{b'}")
('4.2', '\\widetilde{\\mathbf{w}}_k')
('4.2', '\\mathcal{L}_{\\rm CE}')
('4.2', '\\widetilde{\\mathbf{z}}_{k,i}')
('4.2', "\\begin{aligned}\n    \\frac{\\partial \\mathcal{L}_{\\rm CE}}{\\partial \\widetilde{\\mathbf{z}}_{k,i}} \n    &= -(1- p_k(\\widetilde{\\mathbf{z}}_{k,i})) \\mathbf{w}_k\n + \\sum_{k' \\ne k}^K p_{k'}(\\widetilde{\\mathbf{z}}_{k,i})\\mathbf{w}_{k'} \\nonumber\\\\[1mm]\n    &\\le \\underbrace{-(1 - p_k^{(b)}(\\mathbf{m}_{i,b}) - p_k^{(l)}(\\mathbf{z}_{k,i})) \\mathbf{w}_k}_{\\rm pulling \\ part}  \\nonumber\\\\\n    &+ \\underbrace{\\sum_{k' \\ne k}^K (p_{k'}^{(b)}(\\mathbf{m}_{i,b}) + p_{k'}^{(l)}(\\mathbf{z}_{k,i}))\\mathbf{w}_{k'}}_{\\rm forcing \\ part} \n\\label{eq:wrt_feat}\n\\end{aligned}")
('4.2', '\\widetilde{\\mathbf{z}}_{k,i}')
('4.2', '\\mathbf{w}_c')
('4.2', 'p_k^{(b)}')
('4.2', 'p_k^{(b)}')
('4.2', '\\mathbf{w}_k')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5', '\\pm')
('5.2', '\\alpha')
('5.2', '\\alpha')
('8.0', '\\mathbf{x}_{k,i}')
('8.0', 'i')
('8.0', 'k')
('8.0', '\\mathbf{z}_{k,i} \\in \\mathbb{R}^d')
('8.0', '\\mathbf{W}=[\\mathbf{w}_1, ..., \\mathbf{w}_K]')
('8.0', "\\mathcal{L}_{\\rm CE}(\\mathbf{z}_{k,i}, \\mathbf{W})=\n    -\\log \\left( \\frac{\\exp (\\mathbf{z}_{k,i}^\\mathrm{T} \\mathbf{w}_k)}{\\sum_{k'=1}^K \\exp(\\mathbf{z}_{k,i}^\\mathrm{T} \\mathbf{w}_{k'})}\n    \\right)")
('8.0', '\\mathcal{L}_{\\rm CE}')
('8.0', "\\label{sup:eq:2}\n    \\frac{\\partial \\mathcal{L}_{\\rm CE}}{\\partial \\mathbf{w}_k} =\n    \\underbrace{\\sum_{i=1}^{n_k} -(1-p_k(\\mathbf{z}_{k,i})) \\mathbf{z}_{k,i}}_{\\rm pulling \\ part} + \n    \\underbrace{\\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} p_{k}(\\mathbf{z}_{k',j}) \\mathbf{z}_{k',j}}_{\\rm forcing \\ part}")
('8.0', 'n_{k}')
('8.0', 'k')
('8.0', 'p_k(\\mathbf{z})')
('8.0', '\\mathbf{z}')
('8.0', 'k')
('8.0', "p_k(\\mathbf{z}) = \\frac{\\exp (\\mathbf{z}^{\\mathrm{T}}\\mathbf{w}_k)}{\\sum_{k'=1}^K \\exp (\\mathbf{z}^{\\mathrm{T}}\\mathbf{w}_{k'})}, 1 \\le k \\le K")
('8.0', '\\mathbf{w}_k')
('8.0', '\\mathbf{z}_{k,i}')
('8.0', 'k')
('8.0', '1-p_k(\\mathbf{z}_{k,i})')
('8.0', '\\mathbf{w}_k')
('8.0', "p_k(\\mathbf{z}_{k',j})")
('8.0', 'k')
('8.0', '\\mathbf{w}_k')
('8.0', 'k')
('8.0', 'b_k')
('8.0', '\\mathcal{L}_{\\rm CE}')
('8.0', "\\label{sup:eq:4}\n    \\frac{\\partial \\mathcal{L}_{\\rm CE}}{\\partial \\mathbf{z}_{k,i}} =\n    \\underbrace{-(1-p_k(\\mathbf{z}_{k,i})) \\mathbf{w}_{k}}_{\\rm pulling \\ part} + \n    \\underbrace{\\sum_{k' \\ne k}^K p_{k'}(\\mathbf{z}_{k,i}) \\mathbf{w}_{k'}}_{\\rm forcing \\ part}")
('8.0', '\\mathbf{w}_k')
('8.0', 'k')
('8.0', '\\mathbf{w}_k')
('8.1', '[1,...,K]')
('8.1', '[b_1,...,b_K]')
('8.1', 'i')
('8.1', 'k')
('8.1', '\\widetilde{\\mathbf{z}}_{k,i}=[\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}] \\in \\mathbb{R}^{2 \\times d}')
('8.1', '\\mathbf{z}_{k,i} \\in \\mathbb{R}^{d}')
('8.1', '\\mathbf{m}_{i,b} \\in \\mathbb{R}^{d}')
('8.1', 'b')
('8.1', 'k')
('8.1', '\\mathbf{x}_{k,i}')
('8.1', '\\widetilde{\\mathbf{z}}_{k,i}=[\\mathbf{z}_{k,i}, \\mathbf{m}_{b_k}]')
('8.1', "\\widetilde{\\mathbf{z}}_{k,i}=[\\mathbf{z}_{k,i}, \\mathbf{m}_{b_{k'}}], k' \\ne k")
('8.1', '\\widetilde{\\mathbf{w}}_{k}=[\\mathbf{w}_{k}, \\mathbf{a}_{k}] \\in \\mathbb{R}^{2 \\times d}')
('8.1', '\\mathbf{w}_{k} \\in \\mathbb{R}^{d}')
('8.1', '\\mathbf{a}_{k} \\in \\mathbb{R}^{d}')
('8.1', '\\mathbf{a}_{k}')
('8.1', '\\mathbf{m}_{b_k}')
('8.1', "\\label{sup:eq:5}\n    \\mathcal{L}_{\\rm CE}(\\widetilde{\\mathbf{z}}_{k,i}, \\widetilde{\\mathbf{W}}) = -\\log \\left( \\frac{\\exp (\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_k)}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k'})}\\right) \n    = -\\log \\left( \\frac{\\exp([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k}, \\mathbf{a}_k])}{\\sum_{k'=1}^K [\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_{k'}]} \\right)")
('8.1', '\\mathcal{L}_{\\rm CE}')
('8.1', '\\widetilde{\\mathbf{W}}')
('8.1', "\\begin{aligned}\n    \\frac{\\partial \\mathcal{L}_{\\rm CE}}{\\partial \\widetilde{\\mathbf{w}}_k} \n    &= \\sum_{i=1}^{n_k} -(1-p_k(\\widetilde{\\mathbf{z}}_{k,i}))\\widetilde{\\mathbf{z}}_{k,i} + \\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} p_k(\\widetilde{\\mathbf{z}}_{k',j})\\widetilde{\\mathbf{z}}_{k',j} \\nonumber\\\\\n    &= \\sum_{i=1}^{n_k} -\\left(1- \\frac{\\exp([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k}, \\mathbf{a}_k])}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k'})} \\right) \\widetilde{\\mathbf{z}}_{k,i} + \\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} \\frac{\\exp([\\mathbf{z}_{k',j}, \\mathbf{m}_{j,b'}]^\\mathrm{T}[\\mathbf{w}_{k}, \\mathbf{a}_k])}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k',j}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k'})} \\widetilde{\\mathbf{z}}_{k',j}  \\label{sup:eq:6} \\\\\n    &\\le \\sum_{i=1}^{n_k}  -\\left(1- \\frac{\\exp(\\mathbf{z}_{k,i}^\\mathrm{T}\\mathbf{w}_{k})}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T}\\widetilde{\\mathbf{w}}_{k'})} - \\frac{\\exp(\\mathbf{m}_{i,b}^\\mathrm{T}\\mathbf{a}_{k})}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T}\\widetilde{\\mathbf{w}}_{k'})} \\right) \\widetilde{\\mathbf{z}}_{k,i} \\nonumber\\\\\n    &\\ \\ \\ \\ + \\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} \\left( \\frac{\\exp(\\mathbf{z}_{k',j}^\\mathrm{T}\\mathbf{w}_k)}{\\sum_{k''=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k',j}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k''})} + \\frac{\\exp(\\mathbf{m}_{j,b'}^\\mathrm{T}\\mathbf{a}_k)}{\\sum_{k''=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k',j}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k''})} \\right) \\widetilde{\\mathbf{z}}_{k',j} \\label{sup:eq:7}\\\\ \n    &\\le \\underbrace{\\sum_{i=1}^{n_k} - (1 - p_k^{(b)}(\\mathbf{m}_{i,b}) - p_k^{(l)}(\\mathbf{z}_{k,i}) ) \\widetilde{\\mathbf{z}}_{k,i}}_{\\rm pulling \\ part} + \\underbrace{\\sum_{k' \\ne k}^K \\sum_{j=1}^{n_{k'}} (p_k^{(b)}(\\mathbf{m}_{j,b'}) + p_k^{(l)}(\\mathbf{z}_{k',j}) )\\widetilde{\\mathbf{z}}_{k',j}}_{\\rm forcing \\ part} \\label{sup:eq:8}\n\\end{aligned}")
('8.1', '0< (1-p_k(\\widetilde{\\mathbf{z}}_{k,i}))<1')
('8.1', "0<p_k(\\widetilde{\\mathbf{z}}_{k',j})<1")
('8.1', 'p_k^{(l)}')
('8.1', 'p_k^{(b)}')
('8.1', "\\begin{aligned}\n\\label{sup:eq:pk_1}\n    p_k^{(l)}(\\mathbf{z}_{k,i}) = \\frac{\\exp (\\mathbf{z}_{k,i}^\\mathrm{T}\\mathbf{w}_{k})}{\\sum_{k'=1}^K \\exp ([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_{k'}])}\n\\end{aligned}")
('8.1', "\\label{sup:eq:pk_2}\n    p_k^{(b)}(\\mathbf{m}_{i,b}) = \\frac{\\exp (\\mathbf{m}_{i,b}^\\mathrm{T}\\mathbf{a}_{k})}{\\sum_{k'=1}^K \\exp ([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_{k'}])}")
('8.1', 'p_k^{(b)}\\propto\\exp(\\mathbf{m}_{b}^\\mathrm{T}\\mathbf{a}_{k})')
('8.1', 'k')
('8.1', '\\widetilde{\\mathbf{z}}_{k,i}=[\\mathbf{z}_{k,i}, \\mathbf{m}_{b_k}]')
('8.1', 'p_k^{(b)}')
('8.1', "\\widetilde{\\mathbf{z}}_{k,j}=[\\mathbf{z}_{k,j}, \\mathbf{m}_{b_{k'}}], k' \\ne k")
('8.1', '(1 - p_k^{(b)}(\\mathbf{m}_{i,b}) - p_k^{(l)}(\\mathbf{z}_{k,i}) )')
('8.1', '\\mathbf{w}_k')
('8.1', 'b_k')
('8.1', '\\mathbf{w}_k')
('8.1', '\\mathcal{L}_{\\rm CE}')
('8.1', '\\widetilde{\\mathbf{z}}_{k,i}')
('8.1', "\\begin{aligned}\n    \\frac{\\partial \\mathcal{L}_{\\rm CE}}{\\partial \\widetilde{\\mathbf{z}}_{k,i}} \n    &= -(1- p_k(\\widetilde{\\mathbf{z}}_{k,i})) \\mathbf{w}_k\n + \\sum_{k' \\ne k}^K p_{k'}(\\widetilde{\\mathbf{z}}_{k,i})\\mathbf{w}_{k'} \\nonumber\\\\\n    &= -\\left(1- \\frac{\\exp([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k}, \\mathbf{a}_k])}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k'})} \\right) \\mathbf{w}_k + \\sum_{k' \\ne k}^K \\frac{\\exp([\\mathbf{z}_{k,i}, \\mathbf{m}_{i,b}]^\\mathrm{T}[\\mathbf{w}_{k'}, \\mathbf{a}_{k'}])}{\\sum_{k''=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k''})}\\mathbf{w}_{k'} \\label{sup:eq:11}\\\\\n    &\\le -\\left(1- \\frac{\\exp(\\mathbf{z}_{k,i}^\\mathrm{T}\\mathbf{w}_{k})}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T}\\widetilde{\\mathbf{w}}_{k'})} - \\frac{\\exp(\\mathbf{m}_{i,b}^\\mathrm{T}\\mathbf{a}_{k})}{\\sum_{k'=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T}\\widetilde{\\mathbf{w}}_{k'})} \\right) \\mathbf{w}_k \\nonumber\\\\\n    &\\ \\ \\ \\ + \\sum_{k' \\ne k}^K \\left( \\frac{\\exp(\\mathbf{z}_{k,i}^\\mathrm{T}\\mathbf{w}_{k'})}{\\sum_{k''=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k''})} + \\frac{\\exp(\\mathbf{m}_{i,b}^\\mathrm{T}\\mathbf{a}_{k'})}{\\sum_{k''=1}^K \\exp(\\widetilde{\\mathbf{z}}_{k,i}^\\mathrm{T} \\widetilde{\\mathbf{w}}_{k''})} \\right) \\mathbf{w}_{k'} \\label{sup:eq:12}\\\\\n    &\\le \\underbrace{-(1 - p_k^{(b)}(\\mathbf{m}_{i,b}) - p_k^{(l)}(\\mathbf{z}_{k,i})) \\mathbf{w}_k}_{\\rm pulling \\ part}  + \\underbrace{\\sum_{k' \\ne k}^K (p_{k'}^{(b)}(\\mathbf{m}_{i,b}) + p_{k'}^{(l)}(\\mathbf{z}_{k,i}))\\mathbf{w}_{k'}}_{\\rm forcing \\ part} \n\\label{eq:wrt_feat}\n\\end{aligned}")
('8.1', 'p_k^{(b)}\\propto\\exp(\\mathbf{m}_{b}^\\mathrm{T}\\mathbf{a}_{k})')
('8.1', '\\mathbf{m}_{b_k}')
('8.1', 'k')
('8.1', '\\mathbf{w}_k')
('8.1', '\\mathbf{w}_k')
('8.1', "\\mathbf{m}_{b_{k'}}")
('8.1', "\\mathbf{w}_{k'}")
('9.0', '\\{0.5 \\%, 1 \\%, 2 \\%, 5 \\%\\}')
('9.0', '\\{0.5 \\%, 1 \\%, 2 \\%, 5 \\%\\}')
('9.0', '\\{0.5 \\%, 1 \\%, 2 \\%, 5 \\%\\}')
('9.0', '\\{1 \\%, 5 \\%\\}')
('9.0', '\\{1 \\%, 5 \\%\\}')
('9.1', '\\alpha')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
('11', '\\pm')
