('1', '|M| = 128')
('2', 'f: \\mathbb{R}^d \\rightarrow \\mathbb{R}^C')
('2', 'C')
('2', '\\boldsymbol{\\theta}')
('2', '\\ell(\\mathbf{x}, y; \\boldsymbol{\\theta})')
('2', '\\mathbf{x}')
('2', 'y')
('2', '\\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}) = \\frac{1}{|\\mathcal{B}|}\\sum_{(\\mathbf{x}, y) \\in \\mathcal{B}} \\ell(\\mathbf{x}, y; \\boldsymbol{\\theta})')
('2', '\\mathcal{B}')
('2', '\\mathcal{B}')
('2.0', '\\|\\nabla\\mathcal{L}_{M}(\\boldsymbol{\\theta})\\|')
('2.0', 'M \\subseteq \\mathcal{B}')
('2.0', '\\mathcal{B}')
('2.0', 'M \\subseteq \\mathcal{B}')
('2.0', '\\nabla_{\\boldsymbol{\\theta}}\\mathcal{L}_{M}(\\boldsymbol{\\theta}) = \\frac{1}{|M|}\\sum_{(\\mathbf{x}, y) \\in M}\\nabla_{\\boldsymbol{\\theta}}\\ell(\\mathbf{x},y;\\boldsymbol{\\theta})')
('2.0', '\\label{eq:amlgnloss}\n    \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}) + \\lambda \\frac{|M|}{|\\mathcal{B}|}\\sum_{M \\in \\mathcal{B}} \\|\\nabla_{\\boldsymbol{\\theta}} \\mathcal{L}_{M}(\\boldsymbol{\\theta})\\|^2.')
('2.0', 'f')
('2.0', 'p')
('2.0', '\\mathbf{z}= f(\\mathbf{x};\\boldsymbol{\\theta}) \\in \\mathbb{R}^C')
('2.0', '\\mathbf{x}')
('2.0', 'y')
('2.0', '\\label{eq:gnjac}\n\\textcolor{red}{\\nabla_{\\boldsymbol{\\theta}}\\ell(\\mathbf{x}, y; \\boldsymbol{\\theta}) = (\\nabla_{\\boldsymbol{\\theta}}\\mathbf{z}) (\\nabla_{\\mathbf{z}}\\ell(\\mathbf{x}, y; \\boldsymbol{\\theta}))}')
('2.0', '\\nabla_{\\boldsymbol{\\theta}}\\mathbf{z}\\in \\mathbb{R}^{p \\times C}')
('2.1', 'y')
('2.1', '\\mathbf{F}')
('2.1', '\\text{Tr}(\\mathbf{F}) = \\mathbb{E}_{\\mathbf{x}\\sim \\mathcal{X}, \\hat{y} \\sim p_{\\boldsymbol{\\theta}}(y \\mid \\mathbf{x})} [\\| \\nabla_{\\boldsymbol{\\theta}} \\ell(\\mathbf{x}, \\hat{y}; \\boldsymbol{\\theta})\\|^2]')
('2.1', 'p_{\\boldsymbol{\\theta}}(y \\mid \\mathbf{x})')
('2.1', '\\mathcal{X}')
('2.1', '\\widehat{\\mathcal{L}}_{M}(\\boldsymbol{\\theta}) = \\frac{1}{|M|}\\sum_{\\mathbf{x}\\in M,  \\hat{y} \\sim p_{\\boldsymbol{\\theta}}(y \\mid \\mathbf{x})} \\ell(\\mathbf{x}, \\hat{y}; \\boldsymbol{\\theta})')
('2.1', '\\label{eq:fishloss}\n    \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}) + \\lambda \\frac{|M|}{|\\mathcal{B}|}\\sum_{M \\in \\mathcal{B}} \\|\\nabla_{\\boldsymbol{\\theta}} \\widehat{\\mathcal{L}}_{M}(\\boldsymbol{\\theta})\\|^2.')
('2.1', '\\label{eq:ftjac}\n    \\textcolor{red}{\\ell(\\mathbf{x}, \\hat{y}; \\boldsymbol{\\theta}) = (\\nabla_{\\boldsymbol{\\theta}} \\mathbf{z})(\\nabla_{\\mathbf{z}}\\ell(\\mathbf{x}, \\hat{y}; \\boldsymbol{\\theta}))}')
('2.2', '\\begin{aligned}\n\\label{eq:JacsAvg}  \n    \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}) + \\lambda \\frac{|M|}{|\\mathcal{B}|}\\sum_{M \\subseteq \\mathcal{B}} \\|J_{\\text{avg}}(M)\\|^2, \n    \\quad &\\quad \n    J_{\\text{avg}}(M)=\\frac{1}{|M|}\\sum_{(\\mathbf{x}, y) \\in M} (\\nabla_{\\boldsymbol{\\theta}} \\mathbf{z})(\\frac{1}{C}\\mathbbm{1}),\n\\end{aligned}')
('2.2', '\\begin{aligned}\n\\label{eq:JacsUnif}\n    \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}) + \\lambda \\frac{|M|}{|\\mathcal{B}|}\\sum_{M \\subseteq \\mathcal{B}} \\|J_{\\text{unit}}(M)\\|^2,\n    \\quad &\\quad \n    J_{\\text{unit}}(M)=\\frac{1}{|M|}\\sum_{(\\mathbf{x}, y) \\in M} (\\nabla_{\\boldsymbol{\\theta}} \\mathbf{z}) (\\mathbf{u}),\n\\end{aligned}')
('2.2', '\\mathbf{u} \\in \\mathbb{R}^C')
('2.2', '\\|\\mathbf{u}\\|_2 = 1')
('2.2', '\\mathbf{u}')
('2.2', '\\|\\nabla_{\\boldsymbol{\\theta}} \\mathbf{z}\\|_F^2')
('2.2', '\\|\\nabla_{\\boldsymbol{\\theta}} \\mathbf{z}\\|_2^2')
('3.0', '\\mathcal{B}= 128')
('3.0', '\\mathcal{B}= 5120')
('3.0', '\\eta')
('3.0', '\\lambda')
('3.0', '\\pm 0.10')
('3.0', '\\pm 0.27')
('3.0', '\\pm 0.18')
('3.0', '\\pm 0.12')
('3.0', '\\pm 0.11')
('3.0', '\\pm 0.29')
('3.0', '\\pm 0.09')
('3.0', '\\pm 0.33')
('3.0', '\\pm 0.03')
('3.0', '\\pm 0.27')
('3.0', '\\pm 0.07')
('3.0', '\\pm 0.01')
('3.0', '\\pm 0.05')
('3.0', '\\pm 0.16')
('3.0', '\\pm 0.02')
('3.0', '\\pm 0.16')
('3.0', '\\pm 0.01')
('3.0', '\\pm 0.33')
('3.0', '\\pm 0.95')
('3.0', '\\pm 0.11')
('3.0', '\\pm 0.20')
('3.0', '\\pm 0.06')
('3.0', '\\pm 0.54')
('3.0', '\\pm 0.01')
('3.1', '\\lambda')
('3.1', '\\approx0.3\\%')
('3.1', '\\approx0.4\\%')
('3.1', 'C')
('4.0', '|M| = 2560')
('4.0', '\\eta')
('4.0', '\\lambda')
('4.0', '71.01')
('4.0', '39.64')
('4.0', '|M|=128')
('4.0', '|M|=128')
('4.0', '|M|=2560')
('4.0', '|M|=2560')
('4.0', '\\pm 0.27')
('4.0', '\\pm 0.16')
('4.0', '\\pm 0.49')
('4.0', '\\pm 0.76')
('4.0', '\\pm 0.07')
('4.0', '\\pm 0.02')
('4.0', '\\pm 0.56')
('4.0', '\\pm 0.31')
('4.0', '|M|=100')
('4.0', '|M|=1000')
('4.0', '|M|=2500')
('4.0', '\\pm 0.72')
('4.0', '\\pm 0.10')
('4.0', '\\pm 0.29')
('4.1', '\\mathcal{B}')
('4.1', 'S')
('4.1', '\\mathcal{B}')
('4.1', '\\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}) + \\lambda \\|\\nabla_{\\boldsymbol{\\theta}} \\mathcal{L}_{S}(\\boldsymbol{\\theta})\\|^2.')
('4.1', '\\lambda')
('4.1', '\\lambda')
('4.1', '|S|')
('4.1', '\\lambda')
('4.1', '|S|')
('5.0', '\\mathcal{M}, \\mathcal{D}')
('5.0', '\\begin{aligned}\n\\label{eq:grafting}\n    g_\\mathcal{M} &= \\mathcal{M}(\\boldsymbol{\\theta}_k), \\quad \\quad g_\\mathcal{D} = \\mathcal{D}(\\boldsymbol{\\theta}_k) \\nonumber\\\\\n    \\boldsymbol{\\theta}_{k+1} &= \\boldsymbol{\\theta}_k - \\|g_\\mathcal{M}\\|\\frac{g_\\mathcal{D}}{\\|g_\\mathcal{D}\\|}\n\\end{aligned}')
('5.0', '\\mathcal{M}')
('5.0', '\\mathcal{D}')
('5.0', '\\mathcal{M}(\\boldsymbol{\\theta}_k) = \\eta \\nabla \\mathcal{L}_M(\\boldsymbol{\\theta}_k)')
('5.0', '\\mathcal{D}(\\boldsymbol{\\theta}_k) = \\nabla \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}_k)')
('5.0', 'M \\in \\mathcal{B}')
('5.0', "\\mathcal{M}(\\boldsymbol{\\theta}_k) = \\eta \\nabla \\mathcal{L}_M(\\boldsymbol{\\theta}_{k'})")
('5.0', '\\mathcal{D}(\\boldsymbol{\\theta}_k) = \\nabla \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}_k)')
('5.0', "\\nabla \\mathcal{L}_{B}(\\boldsymbol{\\theta}_{k'})")
('5.0', 'k')
('5.0', '\\mathcal{M}(\\boldsymbol{\\theta}_k) = \\eta')
('5.0', '\\mathcal{D}(\\boldsymbol{\\theta}_k) = \\eta \\nabla \\mathcal{L}_{\\mathcal{B}}(\\boldsymbol{\\theta}_k)')
('7.2', '\\sigma^2')
('7.2', '\\eta')
('7.2', '\\sigma^2')
('7.4', '\\eta')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.5')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.5')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.5')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.15')
('7.4', '\\eta=0.01')
('7.4', '\\eta=0.01')
('7.4', '\\eta=0.01')
('7.4', '\\eta=0.01')
('7.4', '\\lambda')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=0.001')
('7.4', '\\lambda=0.001')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=5 \\times 10^{-5}')
('7.4', '\\lambda=0.001')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=1 \\times 10^{-5}')
('7.4', '\\lambda=0.001')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=0.01')
('7.4', '\\lambda=0.0001')
('7.4', '\\lambda=0.001')
('7.4', '\\lambda=0.5')
('7.4', '\\lambda=0.5')
('7.4', '\\lambda=2 \\times 10^{-5}')
('7.4', '\\eta')
('7.4', '\\lambda')
('7.4', '\\eta')
('7.4', '\\lambda')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.2626')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.5')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.3951')
('7.4', '\\eta=0.05')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.05')
('7.4', '\\eta=0.05')
('7.4', '\\eta=0.2388')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.1')
('7.4', '\\eta=0.4322')
('7.4.0', '64 \\times 64')
('7.4.0', '32 \\times 32')
('7.4.0', '= 0.9')
('7.4.0', '=1\\times 10^{-4}')
