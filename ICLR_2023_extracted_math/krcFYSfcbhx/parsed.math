('3.0', '\\mathcal{X}')
('3.0', '\\mathcal{Y}')
('3.0', '(X, y) \\in (\\mathcal{X}, \\mathcal{Y})')
('3.0', '\\mathcal{E}_{train}')
('3.0', '\\mathcal{E}_{test}')
('3.0', '\\mathcal{E}_{all}')
('3.0', '\\mathcal{E}_{train}')
('3.0', '\\mathcal{E}_{test} \\subset \\mathcal{E}_{all}')
('3.0', 'N')
('3.0', 'D_i, i \\in [N]')
('3.0', 'm_i')
('3.0', 'i')
('3.0', '\\mathcal{X}')
('3.0', '\\mathcal{Y}')
('3.0', '\\Phi')
('3.0', 'w')
('3.0', '\\Phi')
('3.0', '\\mathcal{X}')
('3.0', '\\mathcal{H}')
('3.0', '\\Phi(X)\\in \\mathcal{H}')
('3.0', 'w')
('3.0', '\\hat{y}')
('3.0', '\\Phi(X)')
('3.0', 'f_{\\theta}=\\Phi \\circ w')
('3.0', 'f_{\\theta}')
('3.0', 'f')
('3.0', '\\theta')
('3.0', 'D')
('3.0', '\\mathcal{R}(f_{\\theta};D):=\\mathbb{E}_{(X,y)\\in D}[\\ell(f_{\\theta}(X), y)]')
('3.0', '\\ell')
('3.1', '\\Phi(X)')
('3.1', '\\mathbb{E}[y|\\Phi(X) = h, e] = \\mathbb{E}[y|\\Phi(X) = h, e^{\\prime}], \\forall h \\in \\mathcal{H}, \\forall e, e^{\\prime} \\in \\mathcal{E}_{all} \\tag{Invariance}\n\\label{invariance}')
('3.1', '\\Phi: \\mathcal{X} \\rightarrow \\mathcal{H}')
('3.1', 'w\\circ \\Phi')
('3.1', '\\mathcal{E}_{train}')
('3.1', '\\min_{f_{\\theta}:\\mathcal{X}\\rightarrow \\mathcal{Y}}\\sum_{e \\in \\mathcal{E}_{train}}\\mathcal{R}(f_{\\theta};e) + \\lambda \\cdot{\\lVert\\nabla_{\\bar{w}|\\bar{w}=1.0}\\mathcal{R}(\\bar{w}\\cdot f_{\\theta};e)\\rVert}^2, \\tag{IRMv1}\n\\label{IRMv1}')
('3.1', '\\mathcal{R}(f_{\\theta};e)')
('3.1', 'e')
('3.1', 'f_{\\theta}')
('3.1', '\\bar{w}')
('3.1', '\\mathcal{L}_{IRM}(\\theta; \\mathcal{E}_{train})=\\sum_{e \\in \\mathcal{E}_{train}}\\mathcal{R}(f_{\\theta};e) + \\lambda \\cdot{\\lVert\\nabla_{\\bar{w}|\\bar{w}=1.0}\\mathcal{R}(\\bar{w}\\cdot f_{\\theta};e)\\rVert}^2')
('3.1', '\\min_{f_{\\theta}:\\mathcal{X}\\rightarrow \\mathcal{Y}} \\max_{q\\in \\Delta_g}\\sum_{e\\in \\mathcal{E}_{train}}q_e\\cdot \\mathcal{R}(f_{\\theta};e), \\tag{GroupDRO}')
('3.1', 'g=\\lvert \\mathcal{E}_{train}\\rvert')
('3.1', '\\mathcal{L}_{GroupDRO}(\\theta; \\mathcal{E}_{train})=\\max_{q\\in \\Delta_g}\\sum_{e\\in \\mathcal{E}_{train}}q_e\\cdot \\mathcal{R}(f_{\\theta};e)')
('3.2', 'i')
('3.2', '\\Phi_{i}')
('3.2', '\\mathcal{E}^{i}_{all}')
('3.2', 'K=pN')
('3.2', '[N_K]\\subset [N]')
('3.2', '\\Phi_{j} (j\\in[N_K])')
('3.2', 'Z_{j}')
('3.2', 'Z_{j}')
('3.2', '\\Phi_{j}')
('3.2', '\\mathop{\\bigcap}_{i\\ne j, i\\in [N]}\\Phi_{i}')
('3.2', '\\max_{z\\subset Z_{j}}I(Y; z) = \\delta > 0')
('3.2', 'I(\\cdot;\\cdot)')
('3.2', '\\Phi_{g}=\\mathop{\\bigcap}_{i\\in [N]}\\Phi_{i}')
('3.2', '\\Phi_{i}')
('3.2', 'i\\in [N]')
('3.2', '\\Phi_{i}^{\\star}=\\arg\\max_{S\\subset \\Phi_i} I(Y; S)')
('3.2', '\\Phi_{g}^{\\star}=\\arg\\max_{S\\subset \\Phi_{g}} I(Y; S)')
('3.2', '\\frac{1}{N}\\sum_{i=1}^N I(Y; \\Phi_i^{\\star}) \\geq \\frac{1}{N}\\sum_{i=1}^N I(Y; \\Phi_g^{\\star}) + p{\\delta},')
('3.2', '0<p<1')
('3.2', '\\delta')
('3.2', 'N')
('4', 'K')
('4', 'i')
('4', '(X, y)\\in D_i')
('4', 'K_i')
('4', '\\mathcal{E}_{train}^i = \\{e_j^i| j\\in S_i\\}')
('4', 'S_i')
('4', '[K]')
('4', 'S_i')
('4', 'K_i')
('4.0', 'i')
('4.0', '(i\\in[N])')
('4.0', '\\theta_i^{\\star}\\in \\mathop{\\mathrm{arg\\,min}}_{\\theta_i} \\mathcal{L}_{INV}(\\theta_i; \\mathcal{E}_{train}^i)')
('4.0', '\\mathcal{L}_{INV}\\in \\{\\mathcal{L}_{IRM}, \\mathcal{L}_{GroupDRO}\\}')
('4.0', '\\mathcal{L}_{IRM}')
('4.0', 'i (i\\in [N])')
('4.0', '\\begin{aligned}\n&\\min_{\\theta_i} \\mathcal{L}_{INV}(\\theta_i; \\mathcal{E}_{train}^i) + \\beta{\\lVert \\theta_i - {\\nu}^{\\star}\\rVert}^2 \\label{ob:per-inv}\\\\\n&\\text{s.t.}\\quad {\\nu}^{\\star}\\in\\mathop{\\mathrm{arg\\,min}}_{\\nu}\\mathcal{L}_{INV}(\\nu; \\mathcal{E}^D) \\label{ob:glob-inv}\n\\end{aligned}')
('4.0', '\\mathcal{E^D}=\\{D_i|i=1,2,...,N\\}')
('4.0', '\\mathcal{L}_{INV} \\in \\{\\mathcal{L}_{IRM}, \\mathcal{L}_{GroupDRO}\\}.')
('4.0', '\\mathcal{L}_{INV}(\\theta_i; \\mathcal{E}_{train}^i)')
('4.0', '{\\lVert \\theta_i - \\nu^{\\star}\\rVert}^2')
('4.0', '\\mathcal{L}_{INV}=\\mathcal{L}_{IRM}')
('4.0', 'i')
('4.0', '\\begin{aligned}\n&\\min_{\\theta_i} \\sum_{j=1}^{K_i}\\mathcal{R}(f_{\\theta_i};e_j^i) + \\lambda\\cdot{\\lVert \\nabla_{\\bar{\\omega}|\\bar{\\omega}=1.0}\\mathcal{R}(\\bar{\\omega}\\cdot f_{\\theta_i};e_j^i)\\rVert}^2 + \\beta{\\lVert \\theta_i - {\\nu}^{\\star}\\rVert}^2 \\label{ob:per-irm}\\\\\n&\\text{s.t.}\\quad {\\nu}^{\\star}\\in\\mathop{\\mathrm{arg\\,min}}_{\\nu}\\sum_{i=1}^N \\mathcal{R}(f_{\\nu};D_i) + \\lambda\\cdot{\\lVert \\nabla_{\\bar{\\omega}|\\bar{\\omega}=1.0}\\mathcal{R}(\\bar{\\omega}\\cdot f_{\\nu};D_i)\\rVert}^2 \\label{ob:glob-irm}\n\\end{aligned}')
('4.0', '\\nu^{\\star}')
('4.0', 'N')
('4.0', '\\mathcal{L}_{IRM}(\\nu;\\mathcal{E}_D)')
('4.0', 'N')
('4.0', '\\mathcal{L}_{IRM}^i=\\mathcal{R}(f_{\\nu};D_i) + \\lambda \\cdot{\\lVert\\nabla_{\\bar{w}|\\bar{w}=1.0}\\mathcal{R}(\\bar{w}\\cdot f_{\\nu};D_i)\\rVert}^2, i\\in[N]')
('4.0', '\\mathcal{L}_{GroupDRO}(\\nu;\\mathcal{E_D})')
('4.0', '\\mathcal{L}_{GroupDRO}^i = q_i\\cdot \\mathcal{R}(f_{\\nu};D_i), i\\in [N]')
('4.0', 'q_i')
('4.0', '\\mathcal{R}(f_{\\nu};D_i), i \\in [N]')
('4.0', 'T, R, S, \\beta, \\eta, \\gamma, \\alpha')
('4.0', '\\nu^0')
('4.0', '\\{\\theta_i^0|i\\in [N]\\}')
('4.0', '\\nu^t')
('4.0', '\\nu_{i,0}^t \\gets \\nu^t')
('4.0', '\\theta_i^{s+1} \\gets \\theta_i^s - \\eta \\big(\\nabla \\mathcal{L}_{INV}(\\theta_i^s;\\mathcal{E}_{train}^i) + 2\\beta(\\theta_i^s - \\nu_{i,r}^t)\\big)')
('4.0', '\\nu_{i,r+1}^t \\gets \\nu_{i,r}^t - \\gamma\\nabla \\mathcal{L}_{INV}(\\nu_{i,r}^t;D_i)')
('4.0', '\\nu^{t+1} \\gets \\nu^t - \\alpha\\big(\\nu^t - \\frac{1}{N}\\sum_{i\\in [N]}\\nu_{i,R}^t\\big)')
('4.1', '\\mathcal{L}(\\nu):=\\frac{1}{N}\\mathcal{L}_{IRM}(\\nu;\\mathcal{E}^D)')
('4.1', '\\frac{1}{N}\\sum_{i=1}^{N}{\\lVert \\nabla\\mathcal{L}_{IRM}^i(\\nu;D_i) - \\nabla\\mathcal{L}_{IRM}(\\nu;\\mathcal{E}^D) \\rVert}^2 \\leq \\delta_L^2')
('4.1', '\\delta_L')
('4.1', '\\mathcal{L}_{IRM}(\\theta;e_j^i)')
('4.1', 'L_F')
('4.1', '\\forall')
('4.1', 'i')
('4.1', 'j')
('4.1', '\\gamma \\leq \\frac{\\gamma_0}{\\alpha R}')
('4.1', '\\forall')
('4.1', '\\alpha\\leq 1')
('4.1', 'R\\geq 1')
('4.1', '\\gamma_0:=\\frac{\\alpha}{\\sqrt{32(R+3)}L_F}')
('4.1', '\\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2 \\big] \\leq \\mathcal{O}\\big( \\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2\\big] \\big) := \\mathcal{O}\\Big( \\frac{\\Delta_\\mathcal{L}R^{\\frac{1}{2}}L_F}{\\beta T} + \\frac{{(\\Delta_\\mathcal{L}L_F)}^{\\frac{3}{4}} {(R\\delta_L^2)}^{\\frac{1}{4}} }{\\alpha^{\\frac{1}{2}} T^{\\frac{3}{4}}} + \\frac{{(\\Delta_\\mathcal{L} \\delta_L L_F)}^{\\frac{2}{3}}}{\\alpha^{\\frac{2}{3}} T^{\\frac{2}{3}}} \\Big).')
('4.1', '\\frac{1}{N}\\sum_{i=1}^N\\mathbb{E}\\big[{\\lVert \\theta_i^{S}(\\nu_{t^{\\star}}) - \\nu_{t^{\\star}} \\rVert}^2\\big] \\leq \\mathcal{O}\\Big( \\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2\\big] \\Big) + C,')
('4.1', '\\Delta_\\mathcal{L}:=\\mathcal{L}(\\nu_0) - \\mathcal{L}(\\nu_T)')
('4.1', 'C')
('4.1', 't^{\\star}')
('4.1', '\\{0, 1, ..., T-1\\}')
('4.1', 'C')
('4.1', 'S')
('4.1', '\\mathcal{O}(1/T^{2/3})')
('4.1', 'f=\\Phi\\cdot \\omega')
('4.1', '\\Phi_g^{\\star}\\in \\mathbb{R}^{d\\times d}')
('4.1', '\\tau>0')
('4.1', '\\Phi_i^{\\star}')
('4.1', '\\tau + q_i')
('4.1', 'q_i>0')
('4.1', '(i\\in[N])')
('4.1', 'd>\\max_{i\\in[N]} q_i + \\tau')
('4.1', '\\{f_{\\hat{\\theta}_i}=\\hat{\\Phi}_i \\cdot \\hat{\\omega}_i\\}')
('4.1', 'd-\\tau+\\frac{d}{\\tau}')
('4.1', '\\mathcal{E}^D')
('4.1', '\\tau')
('4.1', 'i')
('4.1', '(i\\in[N])')
('4.1', 'd-(\\tau+q_i)+\\frac{d}{\\tau+q_i}')
('4.1', '\\mathcal{E}_{train}^i')
('4.1', '\\tau+q_i')
('4.1', '\\beta')
('4.1', '\\mathbb{E}[Y|\\hat{\\Phi}_i(X),e] = \\mathbb{E}[Y|\\hat{\\Phi}_i(X),e^{\\prime}]')
('4.1', 'e, e^{\\prime}\\in \\mathcal{E}_{all}^i')
('4.1', '\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(f_{\\hat{\\theta}_i}(X),Y)] = \\min_{\\omega, \\Phi_i^{\\star}}\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(\\omega(\\Phi_i^{\\star}(X)),Y)]')
('4.1', 'e \\in \\mathcal{E}_{all}^i')
('4.1', '\\beta')
('4.1', '\\mathbb{E}[Y|\\hat{\\Phi}_i(X),e] = \\mathbb{E}[Y|\\hat{\\Phi}_i(X),e^{\\prime}], for\\text{ }all\\text{ }e, e^{\\prime}\\in \\mathcal{E}_{all}^i')
('4.1', '\\beta')
('4.1', '\\beta')
('4.1', '\\beta')
('5.0.0', 'p^e')
('5.0.0', '1-p^e')
('5.0.0', 'p^e')
('5.0.0', '1-p^e')
('5.0.0', 'p^e=p^e_{train}')
('5.0.0', 'p^e=p^e_{test}')
('5.0.0', 'p^e_{train}=0.95, 0.90, 0.85, 0.80')
('5.0.0', 'p^e_{test}=0.10')
('5.0.0', '0^{\\circ}')
('5.0.0', '90^{\\circ}')
('5.0.0', '180^{\\circ}')
('5.0.0', '270^{\\circ}')
('5.0.0', 'p^e')
('5.0.0', '1-p^e')
('5.0.0', 'p^e')
('5.0.0', '1-p^e')
('5.0.0', 'p^e_{train}=0.95, 0.90, 0.85, 0.80')
('5.0.0', 'p^e_{test}=0.10')
('5.0.0', 'p^e_{test}=0.10')
('5.1', 'p^e_{test} = 0.10, 0.20, 0.30, 0.40')
('5.1', '0.50')
('5.1', '73.99\\%')
('5.1', '\\mathbf{9\\%}')
('5.1', 'p^e_{test}')
('5.1', '51.48')
('5.1', '51.70')
('5.1', '52.17')
('5.1', '\\mathbf{51.53}')
('5.1', '51.18')
('5.1', '62.75')
('5.1', '62.75')
('5.1', '65.25')
('5.1', '66.42')
('5.1', '63.42')
('5.1', 'L2')
('5.1', '31.19')
('5.1', '29.35')
('5.1', '36.53')
('5.1', '43.06')
('5.1', '51.83')
('5.1', '56.83')
('5.1', '62.75')
('5.1', '58.75')
('5.1', '66.00')
('5.1', '59.42')
('5.1', '21.43')
('5.1', '22.37')
('5.1', '32.42')
('5.1', '40.32')
('5.1', '50.96')
('5.1', '55.67')
('5.1', '62.50')
('5.1', '65.05')
('5.1', '66.00')
('5.1', '63.75')
('5.1', '\\mathbf{53.46}')
('5.1', '\\mathbf{52.75}')
('5.1', '\\mathbf{53.63}')
('5.1', '51.41')
('5.1', '\\mathbf{52.73}')
('5.1', '\\mathbf{71.17}')
('5.1', '\\mathbf{74.15}')
('5.1', '\\mathbf{73.67}')
('5.1', '\\mathbf{75.13}')
('5.1', '\\mathbf{75.83}')
('5.1', 'L2')
('5.1', 'L2')
('5.1', 'L2')
('7.0', '\\frac{1}{N}\\sum_{i=1}^N I(Y; \\Phi_i^{\\star}) \\geq \\frac{1}{N}\\sum_{i=1}^N I(Y; \\Phi_g^{\\star}) + p{\\delta},')
('7.0', '0<p<1')
('7.0', '\\delta')
('7.0', 'N')
('7.0', 'N')
('7.0', 'i')
('7.0', '\\mathcal{E}_{all}^i')
('7.0', 'i \\in [N]')
('7.0', '\\label{equ:envs}\n\\mathcal{E}_{all} = \\mathop{\\bigcup}_{i\\in[N]}\\mathcal{E}_{all}^i')
('7.0', '\\mathcal{E}_{all}^i \\ne \\mathcal{E}_{all}')
('7.0', '\\mathcal{E}_{all}^i \\subset \\mathcal{E}_{all}')
('7.0', '\\forall i \\in [N]')
('7.0', '\\phi_g\\in \\Phi_g')
('7.0', '\\mathcal{E}_{all}')
('7.0', '\\phi_g \\in \\Phi_i, \\forall i \\in [N].')
('7.0', '\\Phi_g \\subseteq \\Phi_i, \\forall i \\in [N]')
('7.0', '\\begin{cases}\n\\Phi_g \\subset \\Phi_j, \\forall j \\in [N_K], \\\\\n\\Phi_g = \\Phi_j, \\forall j \\notin [N_K] \\text{ and } j\\in[N].\n\\end{cases}')
('7.0', '\\begin{aligned}\n\\frac{1}{N}\\sum_{i=1}^{N}I(Y;\\Phi_i^{\\star}) &= \\frac{1}{N}\\sum_{i=1}^{N}\\max_{S_i\\subseteq \\Phi_i} I(Y;S_i) \\\\\n&= \\frac{1}{N}\\sum_{i\\in[N_K]}\\max_{S_i\\subseteq \\Phi_i} I(Y;S_i) + \\frac{1}{N}\\sum_{i\\notin[N_K]}\\max_{S_i\\subseteq \\Phi_i} I(Y;S_i) \\\\\n&\\geq \\frac{1}{N}\\sum_{i\\in[N_K]}\\big\\{\\max_{S_{i,1}\\subseteq \\Phi_g} I(Y;S_{i,1}) + \\max_{S_{i,2}\\subseteq Z_i} I(Y;S_{i,2})\\big\\} + \\frac{1}{N}\\sum_{i\\notin[N_K]}\\max_{S_i\\subseteq \\Phi_i} I(Y;S_i) \\\\\n&\\geq \\frac{1}{N}\\sum_{i\\in[N_K]}\\max_{S_{i,1}\\subseteq \\Phi_g} I(Y;S_{i,1}) + \\frac{K}{N}\\delta + \\frac{1}{N}\\sum_{i\\notin[N_K]}\\max_{S_i\\subseteq \\Phi_g} I(Y;S_i) \\\\\n&= \\frac{1}{N}\\sum_{i\\in[N_K]}I(Y;\\Phi_g^{\\star}) + \\frac{K}{N}\\delta + \\frac{1}{N}\\sum_{i\\notin[N_K]}I(Y;\\Phi_g^{\\star}) \\\\\n&= \\frac{1}{N}\\sum_{i=1}^{N} I(Y;\\Phi_g^{\\star}) + p\\delta.\n\\end{aligned}')
('7.0', 'p\\delta')
('7.0', 'p')
('7.0', 'p')
('7.1', '\\mathcal{L}_{IRM}(\\theta;e_j^i)')
('7.1', 'L_F')
('7.1', '\\forall')
('7.1', 'i')
('7.1', 'j')
('7.1', '\\gamma \\leq \\frac{\\gamma_0}{\\alpha R}')
('7.1', '\\forall')
('7.1', '\\alpha\\leq 1')
('7.1', 'R\\geq 1')
('7.1', '\\gamma_0:=\\frac{\\alpha}{\\sqrt{32(R+3)}L_F}')
('7.1', '\\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2 \\big] \\leq \\mathcal{O}\\big( \\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2\\big] \\big) := \\mathcal{O}\\Big( \\frac{\\Delta_\\mathcal{L}R^{\\frac{1}{2}}L_F}{\\beta T} + \\frac{{(\\Delta_\\mathcal{L}L_F)}^{\\frac{3}{4}} {(R\\delta_L^2)}^{\\frac{1}{4}} }{\\alpha^{\\frac{1}{2}} T^{\\frac{3}{4}}} + \\frac{{(\\Delta_\\mathcal{L} \\delta_L L_F)}^{\\frac{2}{3}}}{\\alpha^{\\frac{2}{3}} T^{\\frac{2}{3}}} \\Big).')
('7.1', '\\frac{1}{N}\\sum_{i=1}^N\\mathbb{E}\\big[{\\lVert \\theta_i^{S}(\\nu_{t^{\\star}}) - \\nu_{t^{\\star}} \\rVert}^2\\big] \\leq \\mathcal{O}\\Big( \\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2\\big] \\Big) + C,')
('7.1', '\\Delta_\\mathcal{L}:=\\mathcal{L}(\\nu_0) - \\mathcal{L}(\\nu_T)')
('7.1', 'C')
('7.1', 't^{\\star}')
('7.1', '\\{0, 1, ..., T-1\\}')
('7.1', 'C')
('7.1', 'S')
('7.1', '\\nu_{i,r+1}^t = \\nu_{i,r}^t - \\gamma\\underbrace{\\nabla\\mathcal{L}_{IRM}(\\nu_{i,r}^t)}_{=:g_{i,r}^t}')
('7.1', '\\begin{aligned}\n\\nu_{t+1} &= \\nu_t - \\alpha(\\nu_t - \\frac{1}{N}\\sum_{i=1}^N\\nu_{i,R}^t) \\\\\n&= \\nu_t - \\frac{\\alpha}{N}\\sum_{i=1}^N(\\nu_t - \\nu_{i,R}^t) \\\\\n&= \\nu_t - \\underbrace{\\alpha\\gamma R}_{=:\\hat{\\gamma}}\\underbrace{\\frac{1}{NR}\\sum_{i=1}^N\\sum_{r=0}^{R-1}g_{i,r}^t}_{=:g_t},\n\\end{aligned}')
('7.1', 'L')
('7.1', '\\begin{aligned}\n&\\mathbb{E}[\\mathcal{L}(\\nu_{t+1}) - \\mathcal{L}(\\nu_t)] \\\\\n&\\leq \\mathbb{E}[\\left\\langle \\nabla\\mathcal{L}(\\nu_t), \\nu_{t+1}-\\nu_t \\right\\rangle] + \\frac{L_F}{2}\\mathbb{E}[{\\lVert \\nu_{t+1}-\\nu_t \\rVert}^2] \\\\\n&= -\\hat{\\gamma}\\mathbb{E}[\\left\\langle \\nabla\\mathcal{L}(\\nu_t), g_t \\right\\rangle] + \\frac{\\hat{\\gamma}^2 L_F}{2}\\mathbb{E}[{\\lVert g_t \\rVert}^2] \\\\\n&= -\\hat{\\gamma}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] - \\hat{\\gamma}\\mathbb{E}[\\left\\langle \\nabla\\mathcal{L}(\\nu_t), g_t-\\nabla\\mathcal{L}(\\nu_t) \\right\\rangle] + \\frac{\\hat{\\gamma}^2 L_F}{2}\\mathbb{E}[{\\lVert g_t \\rVert}^2] \\\\\n&\\leq -\\hat{\\gamma}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] + \\frac{\\hat{\\gamma}}{2}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] + \\frac{\\hat{\\gamma}}{2}\\mathbb{E}[\\lVert \\frac{1}{NR}\\sum_{i,r}^{N,R}g_{i,r}^t-\\nabla\\mathcal{L}(\\nu_t) \\rVert^2] + \\frac{\\hat{\\gamma}^2 L_F}{2}\\mathbb{E}[{\\lVert g_t \\rVert}^2] \\\\\n&= -\\frac{\\hat{\\gamma}}{2}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] + \\frac{\\hat{\\gamma}}{2}\\mathbb{E}[\\lVert \\frac{1}{NR}\\sum_{i,r}^{N,R}g_{i,r}^t-\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] + \\frac{\\hat{\\gamma}^2 L_F}{2}\\mathbb{E}[{\\lVert g_t \\rVert}^2] \\\\\n&= -\\frac{\\hat{\\gamma}}{2}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] + \\frac{\\hat{\\gamma}}{2}\\mathbb{E}[\\lVert \\frac{1}{NR}\\sum_{i,r}^{N,R}g_{i,r}^t-\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&\\quad+ \\frac{\\hat{\\gamma}^2 L_F}{2}\\mathbb{E}[\\lVert \\frac{1}{NR}\\sum_{i,r}^{N,R}g_{i,r}^t - \\nabla\\mathcal{L}^i(\\nu_t) + \\frac{1}{N}\\sum_{i=1}^N\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&\\leq -\\frac{\\hat{\\gamma}}{2}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] + \\frac{\\hat{\\gamma}}{2}\\mathbb{E}[\\lVert \\frac{1}{NR}\\sum_{i,r}^{N,R}g_{i,r}^t-\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&\\quad+ \\frac{\\hat{\\gamma}^2 L_F(1+R)}{2}\\mathbb{E}[\\lVert \\frac{1}{NR}\\sum_{i,r}^{N,R}g_{i,r}^t-\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] + \\frac{\\hat{\\gamma}^2 L_F(1+R)}{2R}\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] \\\\\n&\\leq -\\frac{\\hat{\\gamma}}{2}(1-\\frac{(R+1)\\hat{\\gamma}L_F}{R})\\mathbb{E}[{\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert}^2] + \\frac{\\hat{\\gamma}[1+(1+R)\\hat{\\gamma}L_F]}{2}\\frac{1}{NR}\\sum_{i,r}^{N,R}\\mathbb{E}[\\lVert g_{i,r}^t - \\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2]\n\\end{aligned}')
('7.1', '\\mathbb{E}[\\lVert g_{i,r}^t - \\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] = \\mathbb{E}[\\lVert \\nabla\\mathcal{L}^i(\\nu_{i,r}^t) - \\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\leq L_F^2\\mathbb{E}[\\lVert \\nu_{i,r}^t - \\nu_t \\rVert^2],')
('7.1', '\\mathbb{E}[\\lVert \\nu_{i,r}^t - \\nu_t \\rVert^2]')
('7.1', '\\begin{aligned}\n&\\mathbb{E}[\\lVert \\nu_{i,r}^t - \\nu_t \\rVert^2] \\\\\n&= \\mathbb{E}[\\lVert \\nu_{i,r-1}^t - \\nu_t - \\gamma\\nabla\\mathcal{L}^i(\\nu_t) + \\gamma\\nabla\\mathcal{L}^i(\\nu_t) - \\gamma g_{i,r-1}^t \\rVert^2] \\\\\n&\\leq (1+\\frac{1}{R})\\mathbb{E}[\\lVert \\nu_{i,r-1}^t - \\nu_t - \\gamma\\nabla\\mathcal{L}^i(\\nu_t)\\rVert^2] + (1+R)\\gamma^2\\mathbb{E}[\\lVert g_{i,r-1}^t - \\nabla\\mathcal{L}^i(\\nu_t)\\rVert^2] \\\\\n&\\leq (1+\\frac{1}{R})(1+\\frac{1}{2R})\\mathbb{E}[\\lVert \\nu_{i,r-1}^t - \\nu_t \\rVert^2] + (1+\\frac{1}{R})(1+2R)\\gamma^2\\mathbb{E}[\\lVert \\nabla\\mathcal{L}^i(\\nu_t)\\rVert^2] \\\\\n&\\quad+ (1+R)\\gamma^2 L_F^2 \\mathbb{E}[\\lVert \\nu_{i,r-1}^t - \\nu_t \\rVert^2] \\\\\n&= (1+\\frac{1}{R})(1+\\frac{1}{2R}+R\\gamma^2 L_F^2)\\mathbb{E}[\\lVert \\nu_{i,r-1}^t - \\nu_t \\rVert^2] + (1+\\frac{1}{R})(1+2R)\\gamma^2\\mathbb{E}[\\lVert \\nabla\\mathcal{L}^i(\\nu_t)\\rVert^2]\n\\end{aligned}')
('7.1', '\\gamma^2<\\frac{1}{2R^2 L_F^2}')
('7.1', '\\begin{aligned}\n&\\mathbb{E}[\\lVert g_{i,r}^t - \\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&\\leq L_F^2\\mathbb{E}[\\lVert \\nu_{i,r}^t - \\nu_t \\rVert^2] \\\\\n&\\leq R(R+1)\\{ [(1+\\frac{1}{R})^2]^r - 1\\}\\gamma^2 L_F^2 \\mathbb{E}[\\lVert \\nabla\\mathcal{L}^i(\\nu_t)\\rVert^2] \\\\\n&\\leq R(R+1)[(1+\\frac{1}{R})^2]^r \\gamma^2 L_F^2 \\mathbb{E}[\\lVert \\nabla\\mathcal{L}^i(\\nu_t)\\rVert^2] \\\\\n\\end{aligned}')
('7.1', '\\begin{aligned}\n&\\frac{1}{NR}\\sum_{i,r}^{N,R}\\mathbb{E}[\\lVert g_{i,r}^t - \\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&\\leq \\frac{1}{NR}\\sum_{i,r}^{N,R}R(R+1)\\gamma^2 L_F^2\\mathbb{E}[\\lVert\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] [(1+\\frac{1}{R})^2]^r \\\\\n&\\leq \\frac{1}{N}\\sum_{i=1}^N(R+1)\\gamma^2 L_F^2 \\frac{(e^2-1)}{2R+1}\\mathbb{E}[\\lVert\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&\\leq 8R^2\\gamma^2 L_F^2 \\frac{1}{N}\\sum_{i=1}^N \\mathbb{E}[\\lVert\\nabla\\mathcal{L}^i(\\nu_t) \\rVert^2] \\\\\n&= 8R^2\\gamma^2 L_F^2 \\frac{1}{N}\\sum_{i=1}^N \\mathbb{E}[\\lVert\\nabla\\mathcal{L}^i(\\nu_t) - \\nabla\\mathcal{L}(\\nu_t) + \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\\\\n&\\leq 8R^2\\gamma^2 L_F^2 \\frac{1}{N}\\sum_{i=1}^N \\big\\{ 2\\mathbb{E}[\\lVert\\nabla\\mathcal{L}^i(\\nu_t) - \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] + 2\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\big\\} \\\\\n&\\leq 16R^2\\gamma^2 L_F^2 \\frac{1}{N}\\sum_{i=1}^N\\mathbb{E}[\\lVert\\nabla\\mathcal{L}^i(\\nu_t) - \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] + 16R^2\\gamma^2 L_F^2 \\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\\\\n&\\leq 16R^2\\gamma^2 L_F^2 \\delta_L^2 + 16R^2\\gamma^2 L_F^2 \\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\\\\n\\end{aligned}')
('7.1', '\\begin{aligned}\n&\\mathbb{E}[\\mathcal{L}(\\nu_{t+1}) - \\mathcal{L}(\\nu_t)] \\\\\n&\\leq -\\frac{\\hat{\\gamma}}{2}\\big( 1-\\frac{(1+R)\\hat{\\gamma}L_F}{R} \\big)\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\\\\n&\\quad+ \\frac{\\hat{\\gamma}[1+(1+R)\\hat{\\gamma}L_F]}{2}\\big\\{ 16R^2\\gamma^2 L_F^2 \\delta_L^2 + 16R^2\\gamma^2 L_F^2\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\big\\} \\\\\n&= -\\frac{\\hat{\\gamma}}{2}\\Big\\{ 1-\\frac{(R+1)\\hat{\\gamma}L_F}{R}-\\frac{16[1+(1+R)\\hat{\\gamma}L_F]\\hat{\\gamma}^2 L_F^2}{\\alpha^2} \\Big\\}\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\\\\n&\\quad+ \\frac{8\\hat{\\gamma}[1+(1+R)\\hat{\\gamma}L_F]\\hat{\\gamma}^2 L_F^2 \\delta_L^2}{\\alpha^2} \\\\\n\\end{aligned}')
('7.1', '\\gamma \\leq \\frac{\\gamma_0}{\\alpha R}')
('7.1', '\\forall')
('7.1', '\\alpha\\leq 1')
('7.1', 'R\\geq 1')
('7.1', '\\gamma_0:=\\frac{\\alpha}{\\sqrt{32(R+3)}L_F}')
('7.1', '1-\\frac{(R+1)\\hat{\\gamma}L_F}{R}-\\frac{16[1+(1+R)\\hat{\\gamma}L_F]\\hat{\\gamma}^2 L_F^2}{\\alpha^2} > \\frac{1}{2}')
('7.1', '\\begin{aligned}\n&\\mathbb{E}[\\mathcal{L}(\\nu_{t+1}) - \\mathcal{L}(\\nu_t)] \\\\\n&\\leq -\\frac{\\hat{\\gamma}}{4}\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] + \\frac{8\\hat{\\gamma}^3 L_F^2 \\delta_L^2}{\\alpha^2} + \\frac{8(1+R)\\hat{\\gamma}^4 L_F^3 \\delta_L^2}{\\alpha^2}\n\\end{aligned}')
('7.1', '\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\leq \\frac{4\\big\\{ \\mathbb{E}[\\mathcal{L}(\\nu_{t}) -\\mathcal{L}(\\nu_{t+1})] \\big\\}}{\\hat{\\gamma}} + \\frac{32\\hat{\\gamma}^2 L_F^2 \\delta_L^2}{\\alpha^2} + \\frac{32(1+R)\\hat{\\gamma}^3 L_F^3 \\delta_L^2}{\\alpha^2}.')
('7.1', '\\begin{aligned}\n&\\frac{1}{T}\\sum_{t=0}^{T-1}\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\leq \\frac{4\\sum_{t=0}^{T-1}\\mathbb{E}[\\mathcal{L}(\\nu_{t}) - \\mathcal{L}(\\nu_{t+1})]}{\\hat{\\gamma}} + \\frac{32\\hat{\\gamma}^2 L_F^2 \\delta_L^2}{\\alpha^2} + \\frac{32(1+R)\\hat{\\gamma}^3 L_F^3 \\delta_L^2}{\\alpha^2}. \\\\\n\\quad &= \\frac{C_1}{\\hat{\\gamma}T} + \\frac{C_2\\hat{\\gamma}^2}{\\alpha^2} + \\frac{C_3\\hat{\\gamma}^3}{\\alpha^2},\n\\end{aligned}')
('7.1', 'C_1=4(\\mathcal{L}(\\nu_0) - \\mathcal{L}(\\nu_T))')
('7.1', 'C_2=32\\delta_L^2 L_F^2')
('7.1', 'C_3=32(1+R)\\delta_L^2 L_F^3')
('7.1', '\\gamma_0 \\geq \\min\\Big\\{ \\Big(\\frac{C_1\\alpha^2}{C_3T}\\Big)^{\\frac{1}{4}}, \\Big(\\frac{C_1\\alpha^2}{C_2T}\\Big)^{\\frac{1}{3}} \\Big\\}')
('7.1', '\\hat{\\gamma} = \\min\\Big\\{ \\Big(\\frac{C_1\\alpha^2}{C_3T}\\Big)^{\\frac{1}{4}}, \\Big(\\frac{C_1\\alpha^2}{C_2T}\\Big)^{\\frac{1}{3}} \\Big\\}')
('7.1', '\\frac{1}{2T}\\sum_{t=0}^{T-1}\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\leq \\frac{C_1^{\\frac{3}{4}}C_3^{\\frac{1}{4}}}{\\alpha^{\\frac{1}{2}}T^{\\frac{3}{4}}} + \\frac{C_1^{\\frac{2}{3}}C_2^{\\frac{1}{3}}}{\\alpha^{\\frac{2}{3}}T^{\\frac{2}{3}}}.')
('7.1', '\\gamma_0 \\leq \\min\\Big\\{ \\Big(\\frac{C_1\\alpha^2}{C_3T}\\Big)^{\\frac{1}{4}}, \\Big(\\frac{C_1\\alpha^2}{C_2T}\\Big)^{\\frac{1}{3}} \\Big\\}')
('7.1', '\\hat{\\gamma}=\\gamma_0')
('7.1', '\\frac{1}{2T}\\sum_{t=0}^{T-1}\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\leq \\frac{C_1}{\\gamma_0 T} + \\frac{C_1^{\\frac{3}{4}}C_3^{\\frac{1}{4}}}{\\alpha^{\\frac{1}{2}}T^{\\frac{3}{4}}} + \\frac{C_1^{\\frac{2}{3}}C_2^{\\frac{1}{3}}}{\\alpha^{\\frac{2}{3}}T^{\\frac{2}{3}}}.')
('7.1', '\\frac{1}{T}\\sum_{t=0}^{T-1}\\mathbb{E}[\\lVert \\nabla\\mathcal{L}(\\nu_t) \\rVert^2] \\leq \\mathcal{O}\\Big( \\frac{C_1}{\\gamma_0 T} + \\frac{C_1^{\\frac{3}{4}}C_3^{\\frac{1}{4}}}{\\alpha^{\\frac{1}{2}}T^{\\frac{3}{4}}} + \\frac{C_1^{\\frac{2}{3}}C_2^{\\frac{1}{3}}}{\\alpha^{\\frac{2}{3}}T^{\\frac{2}{3}}} \\Big).')
('7.1', '\\theta_i^{\\star}(\\nu)\\in\\mathop{\\mathrm{arg\\,min}}_{\\theta}\\mathcal{L}_{IRM}(\\theta;\\mathcal{E}_{train}^i) + \\beta{\\lVert \\theta - \\nu \\rVert}^2.')
('7.1', '\\mathcal{L}_{IRM}(\\theta;\\mathcal{E}_{train}^i)')
('7.1', 'L_F')
('7.1', 'S')
('7.1', '\\mathbb{E}[{\\lVert \\theta_i^S(\\nu) - \\theta_i^{\\star}(\\nu) \\rVert}^2] \\leq \\delta^2,')
('7.1', '\\delta')
('7.1', '\\frac{1}{N}\\sum_{i=1}^N\\mathbb{E}\\big[{\\lVert \\theta_i^{S}(\\nu_{t^{\\star}}) - \\nu_{t^{\\star}} \\rVert}^2\\big] \\leq \\mathcal{O}\\Big( \\mathbb{E}\\big[{\\lVert \\nabla\\mathcal{L}(\\nu_{t^{\\star}}) \\rVert}^2\\big] \\Big) + C,')
('7.1', 'C')
('7.1', 'S')
('7.2', 'i (i\\in[N])')
('7.2', '\\begin{aligned}\n&Y_i^e = H_i^e \\cdot \\rho_i + \\epsilon_i^e, \\quad\\quad H_i^e \\perp \\epsilon_i^e, \\quad\\quad \\mathbb{E}[\\epsilon_i^e] = 0, \\\\\n&X_i^e = G_i(H_i^e,Z_i^e)\n\\end{aligned}')
('7.2', '\\rho \\in \\mathbb{R}^c')
('7.2', 'X_i^e, H_i^e')
('7.2', 'Z_i^e')
('7.2', '\\mathbb{R}^d, \\mathbb{R}^c')
('7.2', '\\mathbb{R}^l')
('7.2', 'H')
('7.2', 'G_i')
('7.2', '\\widetilde{G}_i')
('7.2', '\\widetilde{G}_i(G_i(h,z)) = h')
('7.2', 'h\\in\\mathbb{R}^c')
('7.2', 'z\\in\\mathbb{R}^l')
('7.2', 'H_i^e')
('7.2', '\\epsilon_i^e')
('7.2', 'f=\\Phi\\cdot \\omega')
('7.2', '\\Phi_g^{\\star}\\in \\mathbb{R}^{d\\times d}')
('7.2', '\\tau>0')
('7.2', '\\Phi_i^{\\star}')
('7.2', '\\tau + q_i')
('7.2', 'q_i>0')
('7.2', '(i\\in[N])')
('7.2', 'd>\\max_{i\\in[N]} q_i + \\tau')
('7.2', '\\{f_{\\hat{\\theta}_i}=\\hat{\\Phi}_i \\cdot \\hat{\\omega}_i\\}')
('7.2', 'd-\\tau+\\frac{d}{\\tau}')
('7.2', '\\mathcal{E}^D')
('7.2', '\\tau')
('7.2', 'i')
('7.2', '(i\\in[N])')
('7.2', 'd-(\\tau+q_i)+\\frac{d}{\\tau+q_i}')
('7.2', '\\mathcal{E}_{train}^i')
('7.2', '\\tau+q_i')
('7.2', '\\beta')
('7.2', '\\mathbb{E}[Y|\\hat{\\Phi}_i(X),e] = \\mathbb{E}[Y|\\hat{\\Phi}_i(X),e^{\\prime}]')
('7.2', 'e, e^{\\prime}\\in \\mathcal{E}_{all}^i')
('7.2', '\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(f_{\\hat{\\theta}_i}(X),Y)] = \\min_{\\omega, Z\\subset \\Phi_i}\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(\\omega(Z(X)),Y)]')
('7.2', 'e \\in \\mathcal{E}_{all}^i')
('7.2', '\\beta')
('7.2', '\\mathbb{E}[Y|\\hat{\\Phi}_i(X),e] = \\mathbb{E}[Y|\\hat{\\Phi}_i(X),e^{\\prime}], for\\text{ }all\\text{ }e, e^{\\prime}\\in \\mathcal{E}_{all}^i')
('7.2', 'f_{{\\nu}^{\\star}}\\in\\mathop{\\mathrm{arg\\,min}}_{\\nu}\\sum_{i=1}^N \\mathcal{R}(f_{\\nu};D_i) + \\lambda\\cdot{\\lVert \\nabla_{\\bar{\\omega}|\\bar{\\omega}=1.0}\\mathcal{R}(\\bar{\\omega}\\cdot f_{\\nu};D_i)\\rVert}^2,')
('7.2', 'f_{\\nu^{\\star}} := \\Phi_{\\nu^{\\star}}\\cdot \\omega_{\\nu^{\\star}}')
('7.2', 'd-\\tau+\\frac{d}{\\tau}')
('7.2', '\\mathcal{E}^D')
('7.2', '\\tau')
('7.2', '\\Phi_{\\nu^{\\star}}')
('7.2', 'f_{\\nu^{\\star}} = \\Phi_{\\nu^{\\star}}\\cdot \\omega_{\\nu^{\\star}}')
('7.2', 'e\\in\\mathcal{E}_{all}')
('7.2', '\\mathcal{E}_{all}^i\\subset \\mathcal{E}_{all}')
('7.2', 'i\\in[N]')
('7.2.0', 'd-(\\tau+q_i)+\\frac{d}{\\tau+q_i}')
('7.2.0', '\\mathcal{E}_{train}^i')
('7.2.0', '\\tau+q_i')
('7.2.0', '\\hat{\\Phi}_i')
('7.2.0', 'f_{\\hat{\\theta}_i} = \\hat{\\Phi}_i\\cdot \\hat{\\omega}_i')
('7.2.0', 'e\\in\\mathcal{E}_{all}^i')
('7.2.0', 'f_{\\bar{\\theta_i}}=\\bar{\\Phi}_i\\cdot\\bar{\\omega}_i')
('7.2.0', '\\beta')
('7.2.0', 'f_{\\bar{\\theta_i}}')
('7.2.0', '\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(f_{\\bar{\\theta}_i}(X),Y)] = \\min_{\\omega, Z\\subset \\Phi_i}\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(\\omega(Z(X)),Y)]')
('7.2.0', 'e \\in \\mathcal{E}_{all}^i')
('7.2.0', '\\min_{\\theta_i} \\sum_{j=1}^{K_i}\\mathcal{R}(f_{\\theta_i};e_j^i) + \\lambda\\cdot{\\lVert \\nabla_{\\bar{\\omega}|\\bar{\\omega}=1.0}\\mathcal{R}(\\bar{\\omega}\\cdot f_{\\theta_i};e_j^i)\\rVert}^2 + \\beta{\\lVert \\theta_i - {\\nu}^{\\star}\\rVert}^2')
('7.2.0', '\\beta')
('7.2.0', '\\begin{aligned}\n&\\min_{\\theta_i} \\sum_{j=1}^{K_i}\\mathcal{R}(f_{\\theta_i};e_j^i) + \\lambda\\cdot{\\lVert \\nabla_{\\bar{\\omega}|\\bar{\\omega}=1.0}\\mathcal{R}(\\bar{\\omega}\\cdot f_{\\theta_i};e_j^i)\\rVert}^2 \\\\\n&s.t. \\quad {\\lVert \\theta_i - {\\nu}^{\\star}\\rVert}^2 \\leq \\delta_d^2\n\\end{aligned}')
('7.2.0', '\\delta_d')
('7.2.0', '\\beta')
('7.2.0', 'f_{\\bar{\\theta_i}}=\\bar{\\Phi}_i\\cdot\\bar{\\omega}_i')
('7.2.0', '\\mathbb{E}_{(X,Y)\\sim \\mathbb{P}^{e}}[\\ell(f_{\\bar{\\theta}_i}(X),Y)]')
('7.2.0', 'e\\in\\mathcal{E}_{all}^i')
('7.2.0.0', '\\beta')
('7.2.0.0', 'f_{\\hat{\\theta}_i}=\\hat{\\Phi}_i \\cdot \\hat{\\omega}_i = f_{\\nu^{\\star}}')
('7.2.0.0', 'f_{\\nu^{\\star}}')
('7.2.0.0', '\\mathbb{E}[Y|\\Phi_{\\nu^{\\star}}(X),e] = \\mathbb{E}[Y|\\Phi_{\\nu^{\\star}}(X),e^{\\prime}], for\\text{ }all\\text{ }e, e^{\\prime}\\in \\mathcal{E}_{all}')
('7.2.0.0', '\\mathcal{E}_{all}^i\\subset \\mathcal{E}_{all}')
('7.2.0.0', 'i\\in[N]')
('7.2.0.0', 'f_{\\nu^{\\star}}')
('7.2.0.0', '\\mathbb{E}[Y|\\Phi_{\\nu^{\\star}}(X),e] = \\mathbb{E}[Y|\\Phi_{\\nu^{\\star}}(X),e^{\\prime}], for\\text{ }all\\text{ }e, e^{\\prime}\\in \\mathcal{E}_{all}^i')
('7.3.0', '28*28')
('7.3.0', '28*28*2')
('7.3.0', '14*14*2')
