('1', 'Q')
('1', 'Q')
('1', 'Q')
('1', 'Q')
('1', 'Q')
('1', 'Q')
('1', 'Q')
('1', 'Q')
('2', 'Q')
('2', 'Q')
('2', 'Q')
('2', 'M')
('2', 'N')
('2', 'M^{N}')
('2', 'Q')
('2', 'Q')
('2', 'Q')
('2', 'M \\times N')
('2', 'Q')
('2', 'Q')
('3', 'Q')
('3.0', '\\mathcal{A} := {a \\in \\mathbb{R}^M}')
('3.0', 'M')
('3.0', 'a(t)=[a_1(t) \\,a_2(t)\\, \\cdots \\,a_M(t)]^{\\sf T}')
('3.0', 'a_m(t)  \\in [-1, 1]')
('3.0', 'm\\in[ M] := {1,2,\\ldots,M}')
('3.0', 'm')
('3.0', 'N')
('3.0', '\\mathcal{A}^d_m')
('3.0', 'm')
('3.0', '\\label{actionspace}\n    \\mathcal{A}_{m}^d:=\\left\\{a^d_{m,1},\\, a^d_{m,2},\\,...,\\, a^d_{m,N}\\right\\}, \\quad {\\rm for}\\quad  m\\in[ M], %:=\\{1,2,\\ldots,M\\}')
('3.0', 'a^d_{m,n}')
('3.0', 'n')
('3.0', 'm')
('3.0', 'm')
('3.0', '\\mathcal{A}^d_{m}')
('3.0', 'M \\times N')
('3.0', 'M')
('3.0', 'Q')
('3.0', 'M \\times N')
('3.0', 'D(s(t);\\theta_d)')
('3.0', 's(t)')
('3.0', '\\theta_d')
('3.0', 'd_{m,n}(s(t);\\theta_d)')
('3.0', 'n')
('3.0', 'm')
('3.0', 'D(s(t);\\theta_d)')
('3.0', 'D')
('3.0', '\\label{policy}\n    \\pi(a(t)|s(t);\\theta_d) = \\{\\pi_m\\}_{m\\in [M]}, \\ \\ {\\rm with} \\ \\  \\pi_m(a^d_{m,n}|s(t);\\theta_d)=\\frac{{\\rm exp}(d_{m,n}(s(t);\\theta_d))}{\\sum^N_{j=1}{\\rm exp}(d_{m,j}(s(t);\\theta_d))}.')
('3.0', '\\pi(a(t)|s(t);\\theta_d)')
('3.0', 's(t)')
('3.0', '\\pi_m(a^d_{m,n}|s(t);\\theta_d)')
('3.0', 'n')
('3.0', 'm')
('3.0', 's(t)')
('3.0', 'a(t):=\\{a_1(t),a_2(t),  \\cdots, a_M(t)\\}')
('3.0', 'Q')
('3.0', 'Q(s(t), a(t); \\theta_Q)')
('3.0', '\\theta_Q')
('3.0', "\\label{valueits}\n    J^Q (\\theta_Q)= \\Big[Q(s(t), a(t); \\theta_{Q})- \\Big(r_t +\\gamma \\big(\\alpha \\mathcal{H}(s(t+1);\\theta_d)+Q(s(t+1), \\widetilde{a}(t+1); \\theta_{Q}')\\big)\\Big) \\Big]^2,")
('3.0', 'r_t=r(s(t), a(t))')
('3.0', 'a(t)')
('3.0', 's(t)')
('3.0', '\\gamma')
('3.0', '\\alpha')
('3.0', "\\theta_Q'")
('3.0', '\\widetilde{a}(t+1)')
('3.0', '\\pi')
('3.0', '\\mathcal{H}')
('3.0', '\\mathcal{H}_m')
('3.0', '\\mathcal{H}')
('3.0', '\\label{entropy}\n    \\mathcal{H}=\\sum_{i=1}^M \\mathcal{H}_m, \\ \\ {\\rm where} \\ \\  \\mathcal{H}_m(s(t);\\theta_d)=\\sum_{j=1}^N \\pi_m(a^d_{m,n}|s(t);\\theta_d) \\ {\\rm log} \\ \\pi_m(a^d_{m,n}|s(t);\\theta_d).')
('3.0', 'Q')
('3.0', 'D')
('3.1', '\\{\\mathcal{S}, \\mathcal{A}, p, r\\}')
('3.1', '\\mathcal{S}')
('3.1', 'p(s(t+1)|s(t), a(t))')
('3.1', 'r(s(t), a(t))')
('3.1', 'Q')
('3.1', '\\label{continuousQ}\n    Q(s(t), a(t))=r(s(t), a(t)) + \\mathbb{E}_{s(\\!t\\!+\\!k\\!)\\!\\sim\\! p, a(\\!t\\!+\\!k\\!)\\!\\sim\\! \\pi}\\!\\Big[\\sum_{k=1}^{\\infty}\\gamma^k \\big(r(s(t\\!+\\!k), a(t\\!+\\!k)) + \\alpha\\mathcal{H}(s(t\\!+\\!k))\\big)\\Big].')
('3.1', 'Q(s(t), a(t))')
('3.1', 'a(t)')
('3.1', 's(t)')
('3.1', 'r(s(t), a(t))')
('3.1', '\\mathcal{A}')
('3.1', '\\mathcal{A}^d_m')
('3.1', '\\{\\mathcal{S}, \\mathcal{A}^d_m, p_m, r_m\\}')
('3.1', '\\overline{\\pi}_m=\\{\\pi_i| {i\\in [M], i\\neq m} \\}')
('3.1', 'm')
('3.1', 'm')
('3.1', '\\overline{\\pi}_m')
('3.1', 'p_m')
('3.1', 'r_m')
('3.1', '\\label{MDPrelations}\n    \\begin{align}\n        &p_m\\big(s(t+1)|s(t), a_m(t);\\overline{\\pi}_m\\big) =  \\ p\\big( s(t+1)|s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) \\\\ \\label{ptransform}\n        &r_m\\big(s(t), a_m(t);\\overline{\\pi}_m\\big) = \\ r\\big(s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) + \\alpha\\overline{\\mathcal{H}}_m\\big(s(t), \\overline{\\pi}_m\\big)\\\\[-0.1cm] \\label{rtransform}\n        &{\\rm where} \\quad \\overline{a}_m(t)\\sim\\overline{\\pi}_m\\big(\\overline{a}_m(t) | s(t)\\big),\\quad \\overline{\\mathcal{H}}_m\\big(s(t), \\overline{\\pi}_m\\big) = \\sum_{i=1, i\\neq m}^{M}\\mathcal{H}_i\\notag.\n    \\end{align}')
('3.1', 'm')
('3.1', 'a_m(t)\\in \\mathcal{A}^d_m')
('3.1', '\\overline{a}_m(t)')
('3.1', '\\overline{\\pi}_m')
('3.1', '\\overline{\\pi}_m')
('3.1', 'Q')
('3.1', '\\begin{aligned}\n    Q_d(s(t), a_m(t); &\\overline{\\pi}_m) = r_m(s(t),a_m(t);\\overline{\\pi}_m) +  \\\\[-0.05cm]\n    &\\mathbb{E}_{s(\\!t\\!+\\!k\\!)\\sim p_m, a_m(\\!t\\!+\\!k\\!)\\sim \\pi_m}\\Big[\\sum_{k=1}^{\\infty}\\gamma^k \\big(r_m(s(t+k), a_m(t+k)) + \\alpha\\mathcal{H}_m(s(t+k))\\big)\\Big]\\notag .\n\\end{aligned}')
('3.1', 'Q_d')
('3.1', 'p_m')
('3.1', 'r_m')
('3.1', '{s(t), a(t), r_t, s(t+1)}')
('3.1', '\\alpha=0')
('3.1', 'Q')
('3.1', '\\label{Q-bridge}\n    \\mathbb{E}_{a_m(t)\\sim\\pi_m}\\big[Q_d(s(t), a_m(t);\\overline{\\pi}_m)\\big] = \\mathbb{E}_{a(t)\\sim\\pi}\\big[Q(s(t), a(t))\\big].')
('3.1', 'Q')
('3.1', '\\begin{aligned}\n    \\label{KLloss}\n    J^{\\pi}_m(\\theta_{d}) \n    &={\\rm D_{KL}} \\bigg(\\pi_m(\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}}|s(t);\\theta_{d})\\Bigg|\\Bigg|\\frac{\\exp\\big(\\frac{1}{\\alpha}Q_d(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\n        \\overline{\\pi}_m)\\big)}{\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q_d(s(t),a^d_{m,j} ;\n        \\overline{\\pi}_m)\\big)} \\bigg)  \\\\\n    &={\\rm D_{KL}} \\bigg(\\pi_m(\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}}|s(t);\\theta_{d})\\Bigg|\\Bigg|\\frac{\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}},\\overline{a}_m(t)\\};\n        \\theta_Q)\\big)}{\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\n        \\theta_Q)\\big)} \\bigg) \\notag\n\\end{aligned}')
('3.1', 'J^{\\pi}_m(\\theta_{d})')
('3.1', 'M')
('3.1', 'J^{\\pi}(\\theta_{d})=\\frac{1}{M}\\sum_{m = 1}^{M} J^{\\pi}_m(\\theta_{d})')
('3.2', 'Q')
('3.2', '\\{s(t),a(t), r_t, s(t+1)\\}')
('3.2', 'Q')
('3.2', 'J(\\alpha)')
('3.2', '\\widehat{\\mathcal{H}}')
('3.2', '\\label{alphaloss}\n    J(\\alpha)= \\frac{1}{M} \\sum_{m = 1}^{M}\\mathbb{E}_{\\pi_m}\\!\\big[-\\alpha \\log \\pi_m(\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}})|s(t);\\theta_{d})-\\alpha\\widehat{{\\mathcal{H}}} \\big].')
('3.2', '\\widehat{\\mathcal{H}}')
('3.2', '\\widehat{\\mathcal{H}}')
('3.2', 'N')
('3.2', '\\mathcal{H}_m')
('3.2', '\\label{practicalEntropy}\n    \\mathcal{H}_m(s(t);\\theta_d)=\\sum_{j=1}^N \\pi_m(a^d_{m,n}|s(t);\\theta_d) \\ {\\rm log} \\ \\big(\\frac{2}{N}\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\big).')
('3.2', 'J^{\\pi}(\\theta_{d})')
('3.2', '\\begin{aligned}\n    \\label{policyloss}\n    J^{\\pi}(\\theta_{d}) & =\\frac{1}{M}\\sum_{m = 1}^{M}\\sum_{n = 1}^{N}J^{\\pi}_{m,n}(\\theta_{d}) \\ , \\quad {\\rm where}\\\\\n    J^{\\pi}_{m,n}(\\theta_{d}) &=\\pi_m(a^d_{m,n}|s(t);\\theta_{d})\\Big\n    [\\alpha\\log \\pi_m(a^d_{m,n}|s(t);\\theta_{d})-Q(s(t), \\{a^d_{m,n}, \\overline{a}_m(t)\\}; \\theta_{Q}) \\Big].\\notag     \n\\end{aligned}')
('3.2', 'Q')
('3.2', 'J_{1,1}^{\\pi}(\\theta_d)')
('3.2', 'J_{m,n}^{\\pi}(\\theta_d)')
('4', 'Q')
('4', 'Q')
('4', 'Q')
('4', 'Q')
('4.0', 'Q')
('4.0', 'Q')
('4.0', '\\pi_m^*(a_m(t)|s(t);\\theta_d^*)')
('4.0', '\\theta_d^*')
('4.0', 'J^\\pi_m(\\theta_d^*)=0')
('4.0', '\\pi_m^*(a_m(t)|s(t);\\theta_d^*)')
('4.0', '\\label{optimalpolicy}   \n    \\pi_m(a^d_{m,n}|s(t);\\theta_d)=\\frac{\\exp\\big(\\frac{1}{\\alpha}Q(s(t),{a^d_{m,n},\\overline{a}_m(t)};\\theta_Q)\\big)}{\\sum_{j=1}^N \\exp\\big(\\frac{1}{\\alpha}Q(s(t),{a^d_{m,j},\\overline{a}_m(t)};\\theta_Q)\\big)}.')
('4.0', 'D(s(t);\\theta_d^*)')
('4.0', 'Q')
('4.0', '\\begin{aligned}\n\\label{DtoQ}   \n    &\\forall m\\in[M];  \\  j,k\\in[N]:  \\notag\\\\[-0.1cm]  \n     &d_{m,j}(s(t);\\theta_d^*) - d_{m,k}(s(t);\\theta_d^*) = \\frac{1}{\\alpha}\\Big(Q_d(s(t), a^d_{m, j};\\overline{\\pi}^*_{m}) - Q_d(s(t), a^d_{m, k};\\overline{\\pi}^*_{m})\\Big).\n\\end{aligned}')
('4.0', 'D(s(t);\\theta_d^*)')
('4.0', 'Q')
('4.0', '\\label{advantage}\n    A(s(t); a^d_{m, n})= \\alpha\\Big(d_{m,n}(s(t);\\theta_d^*) - \\sum_{j=1}^N \\pi_m^*(a^d_{m,n}|s(t);\\theta_d^*) d_{m,j}(s(t);\\theta_d^*)\\Big)')
('4.0', 'Q')
('4.0', 'Q')
('4.0', 'Q')
('4.0', 'Q')
('4.0', 'D(s(t);\\theta_d)')
('4.0', 'Q')
('4.0', '\\label{decomposedQnet}\n    Q_d(s(t),a^d_{m,n};\\theta_d)=d_{m,n}(s(t);\\theta_d) .')
('4.0', '\\alpha')
('4.0', '\\label{boltzmann}\n    \\pi_m(a^d_{m,n}|s(t);\\theta_d,\\alpha)=\\frac{\\exp \\big(\\frac{1}{\\alpha} Q_d(s(t),a^d_{m,n};\\theta_d)\\big)}{\\sum_{j=1}^{N}\\exp \\big(\\frac{1}{\\alpha} Q_d(s(t),a^d_{m,j};\\theta_d)\\big)}.')
('4.0', 'J^\\pi_m(\\theta_d)')
('4.0', '\\pi_m')
('4.0', 'J^{\\pi}_m(\\theta_{d})')
('4.0', 'Q_d(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d)- Q(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\} ;\\theta_Q)=\\delta')
('4.0', 'm')
('4.0', '\\delta\\in \\mathbb{R}')
('4.0', 'J^{\\pi}_m(\\theta_d)')
('4.0', '\\sigma_{\\pi_m}^2')
('4.0', 'Q - Q_d')
('4.0', 'm')
('4.0', '\\begin{aligned}\n\\label{supervisedequality}\n    \\lim\\limits_{Q_d\\rightarrow Q + \\delta}J^{\\pi}_m(\\theta_d)=& \\ \\sigma_{\\pi_m}^2\\Big[Q_d\\big(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d\\big)- Q\\big(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\};\\theta_Q\\big)\\Big] \\notag\\\\\n    =& \\ \\mathbb{E}_{\\pi_m}\\big[(Q_d- Q)^2\\big]-\\big(\\mathbb{E}_{\\pi_m}(Q_d- Q)\\big)^2.\n\\end{aligned}')
('4.0', '\\mathbb{E}_{\\pi_m}\\big[(Q_d- Q)^2\\big]')
('4.0', '\\delta=0')
('4.0', 'J^{\\pi}_m(\\theta_d)')
('4.0', '\\big(\\mathbb{E}_{\\pi_m}(Q_d- Q)\\big)^2')
('4.0', 'J^{\\pi}_m(\\theta_d)')
('4.0', '\\label{supervisedorigin}\n    J^{d}_m(\\theta_d) = \\mathbb{E}_{\\pi_m}\\!\\Big[\\big(Q_d(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d)- Q(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\};\\theta_Q)\\big)^2\\Big]')
('4.0', 'Q_d')
('4.0', 'Q')
('4.0', 'J^{\\pi}_m(\\theta_d)')
('4.0', 'J^{d}_m(\\theta_d)')
('4.1', 'Q')
('4.1', 'A_d')
('4.1', '\\label{practicaladvantage}\n    A_d(s(t);a^d_{m,n};\\theta_d) = d_{m,n}(s(t);\\theta_d) =  Q_d(s(t),a^d_{m,n};\\theta_d) - \\mathbb{E}_{\\pi_m}\\big[Q_d(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d)\\big].')
('4.1', '\\begin{aligned}\n\\label{supervisedloss}\n    J^{d}(\\theta_{d})&=\\frac{1}{M}\\sum_{m = 1}^{M}\\sum_{n = 1}^{N}J^{d}_{m,n}(\\theta_{d}),\\quad {\\rm where}  \\\\[-0.15cm]\n    J^{d}_{m,n}(\\theta_{d}) &= \\Big(d_{m,n}(s(t);\\theta_d) -\\big(Q(s(t),\\{a^d_{m,n},\\overline{a}_m(t)\\};\\theta_Q) - \\mathbb{E}_{\\pi_m}[Q_d(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}}, \\overline{a}_m(t)\\} ;\\theta_Q)]\\big)\\Big)^2 \\notag\n\\end{aligned}')
('4.1', 'Q')
('4.1', '\\alpha')
('4.1', '\\widetilde{a}_{t+1}')
('4.1', "\\alpha'")
('4.1', "\\alpha'\\leftarrow (1-\\tau)\\alpha' + \\tau\\alpha, \\tau \\in (0,1)")
('4.1', "\\alpha'")
('4.1', "\\pi'(\\widetilde{a}(t+1)|s(t+1);\\theta_d,\\alpha')")
('4.1', "\\mathcal{H}'_{t+1}=\\mathcal{H}(s(t+1); \\theta_d, \\alpha')")
('4.1', '\\widetilde{a}(t+3)')
('4.1', "\\pi'")
('4.1', "\\begin{aligned}\n\\label{multistep}\n    J^Q (\\theta_Q)= \\Big(Q(s(t), &a(t); \\theta_{Q})\n    - \\Big(r_t +\\gamma \\big(\\alpha \\mathcal{H}_{t+1} + r_{t+1}\\big) \\\\[-0.15cm]\n    &+ \\gamma^2\\big(\\mathcal{H}_{t+2} + r_{t+2}\\big)\n    +\\gamma^3\\big(\\mathcal{H}_{t+3} + Q(s(t+3), \\widetilde{a}(t+3); \\theta_{Q}')\\big)\\Big)\\Big)^2 \\notag.\n\\end{aligned}")
('4.1', 'r_t')
('4.1', '\\{s(t),a(t), p_{\\text{old}}(a(t)), r_t, s(t+1)\\}')
('4.1', '\\mathcal{D}')
('4.1', 'p_{\\text{old}} (a(t))')
('4.1', 'I(t)')
('4.1', "\\begin{align}\\label{importance}\n    I(t) =  p_{old}\\big(a(t)\\big) \\big/ \\pi\\big(a(t)|s(t);\\theta_d;\\alpha'\\big).\n \\end{align}\n The critic parameters $\\theta_Q$ are updated by taking steps in the direction that minimize the following expectation over a mini-batch $\\mathcal{D}^-$ sampled from $\\mathcal{D}$\n\\begin{align}\\label{paramiteration}\n    \\theta_Q\\leftarrow\\theta_Q - \\lambda_Q  \\  \\mathbb{E}_{\\mathcal{D}^-}\\Big[I(t+1)I(t+2) \\frac{\\partial J^Q(\\theta_Q)} { \\partial \\theta_Q}\\Big].\n\\end{align}")
('4.1', '\\lambda_Q')
('4.1', 'I(t)')
('4.1', '\\sigma_{\\mathcal{D}^-}')
('4.1', '\\log I(t)')
('4.1', '\\mathcal{D}^-')
('4.1', '\\sigma')
('4.1', '2')
('4.1', '\\label{importancenorm}\n    I(t)\\leftarrow \\exp\\Big(\\sigma \\cdot \\rm{clip}\\big(\\frac{\\log \\emph{I}(t) - \\mathbb{E}_{\\mathcal{D}^-}[\\log \\emph{I}(\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{)}{$\\m@th.5\\bullet$}}}}]}{\\sigma_{\\mathcal{D}^-}[\\log \\emph{I}(\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{)}{$\\m@th.5\\bullet$}}}}]},  \\ -1, \\ 1 \\big)\\Big).')
('4.1', 'Q')
('5', '\\sigma=0.05')
('5', 'N=20')
('5', '[-1, 1]')
('5', '\\widehat{\\mathcal{H}}=-1')
('5', '\\widehat{\\mathcal{H}}=0')
('5', '1,000')
('5', '5,000')
('5', '1/2')
('5', '5')
('6', 'Q')
('7.0', '\\mathcal{H}_m')
('7.0', '\\hat{\\mathcal{H}}')
('7.0', '\\hat{\\mathcal{H}}')
('7.0', 'dim(\\mathcal{A})')
('7.0', 'N')
('7.0', '\\hat{\\mathcal{H}}')
('7.0', '\\mathcal{H}_m=\\sum_{n=1}^{N}-\\pi_m(a^d_{m,n}|s(t);\\theta_{d})\\log  \\pi_m(a^d_{m,n}|s(t);\\theta_{d})')
('7.0', 'N')
('7.0', '\\mathcal{H}_m')
('7.0', '\\hat{\\mathcal{H}}')
('7.0', '\\mu=0')
('7.0', '\\sigma=0.3')
('7.0', '[-1, 1]')
('7.0', '\\mathbb\\mathcal{H}_m=-3.78')
('7.0', 'N=100')
('7.0', '\\mathcal{H}_m=-3.09')
('7.0', 'N=50')
('7.0', '\\mathcal{H}_m=-2.18')
('7.0', 'N=20')
('7.0', '\\mathbb{E}(\\mathcal{H}_m)')
('7.0', 'N')
('7.0', '\\hat{\\mathcal{H}}')
('7.0', '[-1, 1]')
('7.0', 'N')
('7.0', '2/N')
('7.0', '\\pi_m(a^d_{m,n}|s(t);\\theta_{d})')
('7.0', '2\\pi_m(a^d_{m,n}|s(t);\\theta_{d})/N')
('7.0', '\\mathcal{H}_m')
('7.0', '\\mathcal{H}_m=\\sum_{n=1}^{N}-\\pi_m(a^d_{m,n}|s(t);\\theta_{d})\\log \\big[\\frac{2}{N} \\pi_m(a^d_{m,n}|s(t);\\theta_{d})\\big]')
('7.0', '\\mathcal{H}_m = 0.131')
('7.0', 'N=100')
('7.0', '\\mathcal{H}_m = 0.130')
('7.0', 'N=50')
('7.0', '\\mathcal{H}_m = 0.122')
('7.0', 'N=20')
('7.0', 'N')
('7.0', '\\hat{\\mathcal{H}}')
('7.1', '\\theta_{Q1}')
('7.1', '\\theta_{Q2}')
('7.1', "\\theta'_{Q1}")
('7.1', "\\theta'_{Q2}")
('7.1', "\\begin{aligned}\n    \\label{doublevalueits}\n    J^Q (\\theta_{Q_i}) = \\Big[Q(s(t), a(t); \\theta_{Q}) - \\Big(r_t &+\\gamma \\big(\\alpha \\mathcal{H}(s(t+1);\\theta_d)\\notag\\\\[-0.25cm]\n    &+\\min_{j=\\{1,2\\}}Q(s(t+1), \\widetilde{a}(t+1); \\theta_{Q_j}')\\big)\\Big) \\Big]^2.\n\\end{aligned}")
('7.1', 'i\\in\\{1,2\\}')
('7.1', '\\widetilde{a}(t+1)')
('7.1', '\\pi(a(t)|s(t);\\theta_d)')
('7.1', '\\begin{aligned}\n    \\label{doublepolicyloss}\n    J^{\\pi}(\\theta_{d}) & =\\frac{1}{M}\\sum_{m = 1}^{M}\\sum_{n = 1}^{N}J^{\\pi}_{m,n}(\\theta_{d}) \\ , \\quad {\\rm where}\\\\[-0.1cm]\n    J^{\\pi}_{m,n}(\\theta_{d}) &=\\pi_m(a^d_{m,n}|s(t);\\theta_{d})\\Big\n    [\\alpha\\log \\pi_m(a^d_{m,n}|s(t);\\theta_{d})-\\min_{j=\\{1,2\\}}Q(s(t), \\{a^d_{m,n}, \\overline{a}_m(t)\\}; \\theta_{Q_j}) \\Big].\\notag   \n\\end{aligned}')
('7.1', '\\tau')
('7.1', "\\begin{aligned}\n    \\theta_{Q1}'\\leftarrow \\tau \\theta_{Q1} +  (1 - \\tau) \\theta_{Q1}\\\\\n    \\theta_{Q2}'\\leftarrow \\tau \\theta_{Q2} +  (1 - \\tau) \\theta_{Q2}''\\notag\n\\end{aligned}")
('7.1', '\\lambda_d')
('7.1', '\\lambda_Q')
('7.1', '\\lambda_\\alpha')
('7.1', '\\alpha')
('7.1', '\\theta_{d}')
('7.1', '\\theta_{Q1}')
('7.1', '\\theta_{Q2}')
('7.1', "\\theta_{Q1}'")
('7.1', "\\theta_{Q2}'")
('7.1', '\\mathcal{D}\\leftarrow \\{ \\}')
('7.1', '\\alpha')
('7.1', '\\lambda_d, \\ \\lambda_Q, \\ \\lambda_\\alpha,\\ \\tau, \\ \\gamma')
('7.1', '\\hat{\\mathcal{H}}')
('7.1', 'a(t) \\sim \\pi(a(t)|s(t);\\theta_{d})')
('7.1', 'a(t)')
('7.1', 'r_t')
('7.1', 's(t+1)')
('7.1', '\\{s(t), a(t), r_t, s(t+1)\\}')
('7.1', '\\mathcal{D}')
('7.1', '\\mathcal{D}^-')
('7.1', '\\mathcal{D}')
('7.1', '\\theta_{Qi} \\leftarrow \\theta_{Qi} - \\lambda_Q\\nabla_{\\theta_{Qi}} J^{Q} (\\theta_{Qi})')
('7.1', '\\theta_{d} \\leftarrow \\theta_{d}-\\lambda_d\\nabla_{\\theta_{d}} J^\\pi (\\theta_{d})')
('7.1', '\\alpha \\leftarrow \\alpha-\\lambda_\\alpha\\nabla_{\\alpha} J(\\alpha)')
('7.1', "\\theta_{Q1}'\\leftarrow \\tau \\theta_{Q1} +  (1 - \\tau) \\theta_{Q1}'")
('7.1', "\\theta_{Q2}'\\leftarrow \\tau \\theta_{Q2} +  (1 - \\tau) \\theta_{Q2}'")
('7.2', 'M\\times N')
('7.2', 'Q(s(t), a(t);\\theta_Q)')
('7.2', 'N')
('7.2', 'M \\times N')
('7.2', 'M \\times N')
('7.2', 'N')
('7.2', 'M \\times N')
('7.3', 'N')
('7.3', '\\hat{\\mathcal{H}}')
('7.3', '\\tau')
('7.3', '5\\times 10^{-3}')
('7.3', '\\gamma')
('7.3', '0.99')
('7.3', '\\mathcal{D}')
('7.3', '\\mathcal{D}^-')
('7.3', '\\max(\\log \\ \\alpha)')
('7.3', '\\min(\\log \\ \\alpha)')
('7.3', '\\lambda_\\alpha')
('7.3', '3\\times 10^{-4}')
('7.3', '\\lambda_d')
('7.3', '3\\times 10^{-4}')
('7.3', '10^{-3}')
('7.3', '\\lambda_Q')
('7.3', '3\\times 10^{-4}')
('7.3', '10^{-3}')
('8.0', "\\begin{aligned}\n\\label{doublemultistep}\n    J^Q (\\theta_{Q_i})&= \\Big((s(t), a(t); \\theta_{Q_i})\n    - \\Big(r_t +\\gamma \\big(\\alpha \\mathcal{H}_{t+1} + r_{t+1}\\big) \\\\[-0.15cm]\n    &+ \\gamma^2\\big(\\mathcal{H}_{t+2} + r_{t+2}\\big)\n    +\\gamma^3\\big(\\mathcal{H}_{t+3} + \\min_{j=\\{1,2\\}}Q(s(t+3), \\widetilde{a}(t+3); \\theta_{Q_j}')\\big)\\Big)\\Big)^2 \\notag.\n\\end{aligned}")
('8.0', '\\begin{aligned}\n\\label{doublesupervisedloss}\n    J^{d}(\\theta_{d})&=\\frac{1}{M}\\sum_{m = 1}^{M}\\sum_{n = 1}^{N}J^{d}_{m,n}(\\theta_{d}),\\quad {\\rm where}  \\\\[-0.15cm]\n    J^{d}_{m,n}(\\theta_{d}) &= \\Big(d_{m,n}(s(t);\\theta_d) -\\min_{j=\\{1,2\\}}\\big(Q(s(t),\\{a^d_{m,n},\\overline{a}_m(t)\\};\\theta_{Q_j})  \\notag\\\\\n    &\\quad \\quad \\quad \\quad \\quad \\quad \\quad \\ \\  \\  -\\mathbb{E}_{\\pi_m}[\\min_{j=\\{1,2\\}}Q(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}}, \\overline{a}_m(t)\\} ;\\theta_{Q_j})]\\big)\\Big)^2 \\notag\n\\end{aligned}')
('8.0', "\\alpha'")
('8.0', "\\alpha'\\leftarrow \\tau \\alpha +  (1 - \\tau) \\alpha'")
('8.0', '\\theta_{d}')
('8.0', '\\theta_{Q1}')
('8.0', '\\theta_{Q2}')
('8.0', "\\theta_{Q1}'")
('8.0', "\\theta_{Q2}'")
('8.0', '\\mathcal{D}\\leftarrow \\{ \\}')
('8.0', '\\alpha')
('8.0', "\\alpha'")
('8.0', '\\lambda_d, \\ \\lambda_Q, \\ \\lambda_\\alpha,\\ \\tau, \\ \\gamma')
('8.0', '\\hat{\\mathcal{H}}')
('8.0', '\\sigma')
('8.0', '\\pi_m(a^d_{m,n}|s(t);\\theta_d,\\alpha)')
('8.0', 'D(s(t);\\theta_d)')
('8.0', 'a(t) \\sim \\pi(a(t)|s(t);\\theta_{d})')
('8.0', 'p_{old}(a(t))')
('8.0', 'a(t)')
('8.0', 'a(t)')
('8.0', 'r_t')
('8.0', 's(t+1)')
('8.0', '\\{s(t), a(t),p_{old}(a(t)), r_t, s(t+1)\\}')
('8.0', '\\mathcal{D}')
('8.0', '\\mathcal{D}^-')
('8.0', '\\mathcal{D}')
('8.0', '\\emph{I}(t+1),\\emph{I}(t+2)')
('8.0', '\\theta_{Q_i}\\leftarrow\\theta_{Q_i} - \\lambda_Q  \\  \\mathbb{E}_{\\mathcal{D}^-}\\Big[I(t+1)I(t+2) \\frac{\\partial J^Q(\\theta_{Q_i})} { \\partial \\theta_{Q_i}}\\Big]')
('8.0', 'i\\in\\{1,2\\}')
('8.0', '\\theta_{d} \\leftarrow \\theta_{d}-\\lambda_d\\nabla_{\\theta_{d}} J^d (\\theta_{d})')
('8.0', '\\alpha \\leftarrow \\alpha-\\lambda_\\alpha\\nabla_{\\alpha} J(\\alpha)')
('8.0', "\\alpha'\\leftarrow \\tau \\alpha +  (1 - \\tau) \\alpha'")
('8.0', "\\theta_{Q1}'\\leftarrow \\tau \\theta_{Q1} +  (1 - \\tau) \\theta_{Q1}'")
('8.0', "\\theta_{Q2}'\\leftarrow \\tau \\theta_{Q2} +  (1 - \\tau) \\theta_{Q2}'")
('8.1', '\\hat{\\mathcal{H}}=0')
('8.1', '\\hat{\\mathcal{H}}=-1.5')
('8.1', '\\hat{\\mathcal{H}}')
('8.1', '\\epsilon-{\\rm greedy}')
('8.1', '\\sigma')
('8.1', 'N')
('8.1', '\\hat{\\mathcal{H}}')
('8.1', '\\tau')
('8.1', '5\\times 10^{-3}')
('8.1', '\\gamma')
('8.1', '0.99')
('8.1', '\\mathcal{D}')
('8.1', '\\mathcal{D}^-')
('8.1', '\\max(\\log \\ \\alpha)')
('8.1', '\\min(\\log \\ \\alpha)')
('8.1', '\\lambda_\\alpha')
('8.1', '3\\times 10^{-4}')
('8.1', '\\lambda_d')
('8.1', '3\\times 10^{-4}')
('8.1', '10^{-3}')
('8.1', '\\lambda_Q')
('8.1', '3\\times 10^{-4}')
('8.1', '10^{-3}')
('8.1', '\\sigma')
('8.1', '\\max(\\emph{I}(t)/ \\sigma)')
('8.1', '\\min(\\emph{I}(t)/ \\sigma)')
('9.0', '{\\mathcal{S}, \\mathcal{A}^d_m, p_m, r_m}')
('9.0', '{\\mathcal{S}, \\mathcal{A}, p_m, r_m}')
('9.0', '\\begin{align}\n        &p_m\\big(s(t+1)|s(t), a_m(t);\\overline{\\pi}_m\\big) =  \\ p\\big( s(t+1)|s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) \\notag\\\\\n        &r_m\\big(s(t), a_m(t);\\overline{\\pi}_m\\big) = \\ r\\big(s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) + \\alpha\\overline{\\mathcal{H}}_m\\big(s(t), \\overline{\\pi}_m\\big)\\notag\\\\[-0.1cm]\n        &{\\rm where} \\quad \\overline{a}_m(t)\\sim\\overline{\\pi}_m\\big(\\overline{a}_m(t) | s(t)\\big),\\quad \\overline{\\mathcal{H}}_m\\big(s(t), \\overline{\\pi}_m\\big) = \\sum_{i=1, i\\neq m}^{M}\\mathcal{H}_i\\notag.\n    \\end{align}')
('9.0', '\\overline{\\pi}_m=\\{\\pi_i| {i\\in [M], i\\neq m} \\}')
('9.0', 'm')
('9.0', '{\\mathcal{S}, \\mathcal{A}^d_m, p_m, r_m}')
('9.0', '\\begin{aligned}\n    \\mathbb{E}_{a_m(t)\\sim\\pi_m}\\big[Q_d(s(t), a_m(t);\\overline{\\pi}_m)\\big] = \\mathbb{E}_{a(t)\\sim\\pi}\\big[Q(s(t), a(t))\\big].\\notag \n\\end{aligned}')
('9.0', '\\begin{aligned}\n    Q_d(s(t), a_m(t); \\overline{\\pi}_m) &= r_m(s(t),a_m(t);\\overline{\\pi}_m)    \\\\[-0.05cm]\n    &\\quad+\\mathbb{E}_{p_m, \\pi_m}\\Big[\\sum_{k=1}^{\\infty}\\gamma^k \\big(r_m(s(t+k), a_m(t+k)) + \\alpha\\mathcal{H}_m(s(t+k))\\big)\\Big]\\notag\\\\\n     &= \\mathbb{E}_{\\overline{\\pi}_m}\\big[r\\big(s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) + \\alpha\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big] \\notag\\\\\n    &\\quad+\\mathbb{E}_{ p_m,  \\pi_m}\\Big[\\sum_{k=1}^{\\infty}\\gamma^k \\big(\\mathbb{E}_{\\overline{\\pi}_m}\\big(r(s(t+k), \\{a_m(t+k), \\overline{a}_m(t+k)\\} ) \\notag\\\\\n    &\\quad+\\alpha\\overline{\\mathcal{H}}_m(s(t+k))\\big)\n    + \\alpha\\mathcal{H}_m(s(t+k))\\big)\\Big]\\notag\\\\\n    &= \\mathbb{E}_{\\overline{\\pi}_m}\\big[r\\big(s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) + \\alpha\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big] \\notag\\\\\n    &\\quad+\\mathbb{E}_{ p_m,  \\pi_m}\\Big[\\sum_{k=1}^{\\infty}\\gamma^k \\big(\\mathbb{E}_{\\overline{\\pi}_m}\\big(r(s(t+k), \\{a_m(t+k), \\overline{a}_m(t+k)\\} )\\big) \\notag\\\\\n    &\\quad+\\alpha\\mathbb{E}_{\\overline{\\pi}_m}\\big(\\overline{\\mathcal{H}}_m(s(t+k))\n    + \\mathcal{H}_m(s(t+k))\\big)\\big)\\Big]\\notag\\\\\n    &= \\mathbb{E}_{\\overline{\\pi}_m}\\big[r\\big(s(t), \\{a_m(t), \\overline{a}_m(t)\\} \\big) + \\alpha\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big] \\notag\\\\\n    &\\quad+\\mathbb{E}_{ p_m, \\pi_m, \\overline{\\pi}_m}\\Big[\\!\\sum_{k=1}^{\\infty}\\!\\gamma^k \\big(r(s(t\\!+\\!k), \\{a_m(t\\!+\\!k), \\overline{a}_m(t\\!+\\!k)\\!\\} )\\!+\\!\\alpha\\mathcal{H}(s(t\\!+\\!k))\\big)\\!\\Big]\\notag\n\\end{aligned}')
('9.0', '\\pi=\\{\\pi_m, \\overline{\\pi}_m\\}')
('9.0', 'a(t)=\\{a_m(t), \\overline{a}_m(t)\\}')
('9.0', 'p_m')
('9.0', '\\overline{\\pi}_m')
('9.0', 'Q_d(s(t), a_m(t); \\overline{\\pi}_m)')
('9.0', '\\begin{aligned}\n\\label{MDPproof}\n    Q_d(s(t), a_m(t); \\overline{\\pi}_m) &= \\mathbb{E}_{\\overline{\\pi}_m}\\big[r\\big(s(t), a(t) \\big)\\big] + \\alpha\\mathbb{E}_{\\overline{\\pi}_m}\\big[\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big] \\notag\\\\\n    &\\quad+\\mathbb{E}_{p, \\pi}\\Big[\\sum_{k=1}^{\\infty}\\gamma^k \\big(r(s(t+k), a(t+k))+\\alpha\\mathcal{H}(s(t+k))\\big)\\Big]\\notag\\\\\n    &=\\mathbb{E}_{\\overline{\\pi}_m}\\big[Q(s(t), a(t))\\big]+\\alpha\\mathbb{E}_{\\overline{\\pi}_m}\\big[\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big];\\notag\\\\[0.4cm]\n    \\mathbb{E}_{\\pi_m}\\big[Q_d(s(t), a_m(t); \\overline{\\pi}_m)\\big]&=\\mathbb{E}_{\\pi_m}\\big[\\mathbb{E}_{\\overline{\\pi}_m}\\big[Q(s(t), a(t))\\big]\\big]+\\alpha\\mathbb{E}_{\\pi_m}\\big[\\mathbb{E}_{\\overline{\\pi}_m}\\big[\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big]\\big]\\notag\\\\[0.15cm]\n    &=\\mathbb{E}_{\\pi}\\big[Q(s(t), a(t))\\big]+\\alpha\\mathbb{E}_{\\overline{\\pi}_m}\\big[\\overline{\\mathcal{H}}_m\\big(s(t)\\big)\\big]\n\\end{aligned}')
('9.0', '\\alpha\\mathbb{E}_{\\overline{\\pi}_m}[\\overline{\\mathcal{H}}_m(s(t))]')
('9.0', '\\pi_m')
('9.1', '\\begin{aligned}\n    \\label{KLprove}\nJ^{\\pi}_m(\\theta_{d}) \n&={\\rm D_{KL}} \\bigg(\\pi_m(\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}}|s(t);\\theta_{d})\\Bigg|\\Bigg|\\frac{\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}},\\overline{a}_m(t)\\};\n    \\theta_Q)\\big)}{\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)} \\bigg)\\notag\\\\\n&=\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\Big(\\log\\pi_m(a^d_{m,n}|s(t);\\theta_d) \\notag\\\\ \n&\\quad -\\log\\frac{\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,n} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)}{\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)}\\Big)\\notag\\\\  \n&=\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\Big(\\log\\pi_m(a^d_{m,n}|s(t);\\theta_d)-\\frac{1}{\\alpha}Q\\big(s(t),\\{a^d_{m,n} ,\\overline{a}_m(t)\\};\\theta_Q\\big) \\notag\\\\ \n&\\quad +\\log\\big[\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)\\big]\\Big)\\notag\\\\ \n&=\\frac{1}{\\alpha}\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\Big[\\alpha\\log\\pi_m(a^d_{m,n}|s(t);\\theta_d)-Q\\big(s(t),\\{a^d_{m,n} ,\\overline{a}_m(t)\\};\\theta_Q\\big)\\Big] \\notag\\\\ \n&\\quad +\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\log\\big[\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)\\big]\\notag\\\\\n&=\\frac{1}{\\alpha}\\sum_{n=1}^N J^\\pi_{m,n}(\\theta_d) + \\log\\big[\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)\\big] \\\\[0.3cm]\nJ^{\\pi}(\\theta_{d}) &= J^{\\pi}(\\theta_{d})=\\frac{1}{M}\\sum_{m = 1}^{M} J^{\\pi}_m(\\theta_{d})\\notag\\\\\n&=\\frac{1}{\\alpha M}\\sum_{m = 1}^{M}\\sum_{n = 1}^{N}J^{\\pi}_{m,n}(\\theta_{d}) + \\log\\big[\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q(s(t),\\{a^d_{m,j} ,\\overline{a}_m(t)\\};\\theta_Q)\\big)\\big]\\label{provedpolicyloss}\n\\end{aligned}')
('9.1', 'J^{\\pi}(\\theta_{d})')
('9.1', '\\theta_{d}')
('9.1', '\\alpha')
('9.1', 'J^{\\pi}(\\theta_{d})')
('9.2', 'J^{\\pi}_m(\\theta_{d})')
('9.2', '\\sigma_{\\pi_m}^2')
('9.2', 'Q - Q_d')
('9.2', 'Q_d(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d)- Q(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}},\\overline{a}_m(t)\\} ;\\theta_Q)=\\delta')
('9.2', 'm')
('9.2', 'X')
('9.2', 'Q_d')
('9.2', 'Q-\\sigma')
('9.2', '\\begin{aligned}\nX = \\begin{bmatrix}\n    x_1 \\\\[0.05cm]\n    x_2 \\\\\n    \\vdots \\\\\n    x_N\n\\end{bmatrix}\n=\\begin{bmatrix}\nQ_d(s(t),a^d_{m,1} ;\\theta_d)- Q(s(t),\\{a^d_{m,1} ,\\overline{a}_m(t)\\} ;\\theta_Q)-\\delta \\\\[0.1cm]\nQ_d(s(t),a^d_{m,2} ;\\theta_d)- Q(s(t),\\{a^d_{m,2} ,\\overline{a}_m(t)\\} ;\\theta_Q)-\\delta \\\\\n\\vdots\\\\\nQ_d(s(t),a^d_{m,N} ;\\theta_d)- Q(s(t),\\{a^d_{m,N} ,\\overline{a}_m(t)\\} ;\\theta_Q)-\\delta\n\\end{bmatrix}\n\\end{aligned}')
('9.2', '\\ J^{\\pi}_m(\\theta_{d})|_{X=O}=0')
('9.2', 'Q_{m,n}')
('9.2', 'Q(s(t),\\{a^d_{m,n} ,\\overline{a}_m(t)\\} ;\\theta_Q)')
('9.2', 'Q^d_{m,n}')
('9.2', 'Q_d(s(t),a^d_{m,n} ;\\theta_d)')
('9.2', '\\begin{aligned}\nJ^{\\pi}_m(\\theta_{d}) \n&={\\rm D_{KL}} \\bigg(\\frac{\\exp \\big(\\frac{1}{\\alpha} Q^d_{m, \\mathpalette\\bigcdot@{.5}}\\big)}{\\sum_{j=1}^{N}\\exp \\big(\\frac{1}{\\alpha} Q^d_{m, j}\\big)}\\Bigg|\\Bigg|\n\\frac{\\exp\\big(\\frac{1}{\\alpha}Q_{m, \\mathpalette\\bigcdot@{.5}}\\big)}{\\sum_{j=1}^{N}\\exp\\big(\\frac{1}{\\alpha}Q_{m, j}\\big)} \\bigg)\\notag\\\\   \n&=\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\Big[\\frac{1}{\\alpha}Q^d_{m, n} - \\log\\sum_{j=1}^{N} \\exp \\big(\\frac{1}{\\alpha} Q^d_{m, j}\\big) -\\frac{1}{\\alpha}Q_{m, n} \\notag\\\\\n&\\quad+ \\log\\sum_{j=1}^{N} \\exp \\big(\\frac{1}{\\alpha} Q_{m, j}\\big)\\Big]\\notag\\\\\n&=-\\log\\sum_{n=1}^{N} \\exp \\big(\\frac{1}{\\alpha} (x_n + Q_{m,n} + \\sigma)\\big)  + \\log\\sum_{n=1}^{N} \\exp \\big(\\frac{1}{\\alpha} Q_{m, n}\\big)\\notag\\\\\n&\\quad +\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\big[\\frac{1}{\\alpha}(x_n+\\sigma)\\big].\n\\end{aligned}')
('9.2', '\\log\\sum_{n=1}^{N} \\exp \\big(\\frac{1}{\\alpha} Q_{m, n}\\big)')
('9.2', '\\sigma')
('9.2', '\\theta_d')
('9.2', '\\xi')
('9.2', 'J^{\\pi}_m(\\theta_{d})')
('9.2', '0')
('9.2', '\\begin{aligned}\n    J^{\\pi}_m(\\theta_{d})\n    &=\\sum_{n=1}^N\\frac{x_n}{\\alpha}\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\pi}{$\\m@th.5\\bullet$}}}}_m(a^d_{m,n}|s(t);\\theta_d) - \\log\\sum_{n=1}^{N} \\exp \\big(\\frac{x_n + Q_{m,n}}{\\alpha}\\big)+\\xi\\notag\\\\\n    &=\\sum_{n=1}^N\\frac{x_n}{\\alpha}\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\frac}{$\\m@th.5\\bullet$}}}}{\\exp \\big(\\frac{1}{\\alpha} Q^d_{m, n}\\big)}{\\sum_{j=1}^{N}\\exp \\big(\\frac{1}{\\alpha} Q^d_{m, j}\\big)}- \\log\\sum_{n=1}^{N} \\exp \\big(\\frac{x_n + Q_{m,n}}{\\alpha}\\big)+\\xi\\notag\\\\[0.15cm]\n    &=\\dfrac{\\sum_{n=1}^N x_n\\exp \\big(\\dfrac{x_n + Q_{m, n}}{\\alpha}\\big)}{\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{x_n + Q_{m, n}}{\\alpha}\\big)}- \\log\\sum_{n=1}^{N} \\exp \\big(\\frac{x_n + Q_{m,n}}{\\alpha}\\big)+\\xi\\label{xloss}\n\\end{aligned}')
('9.2', 'J^{\\pi}_m(X)')
('9.2', '\\begin{aligned}\n\\label{partial1}\n    &\\frac{\\partial J^{\\pi}_m(X)}{\\partial X} = \\\\\n    &\\begin{bmatrix}\n        \\dfrac{x_1\\exp \\! \\big(\\dfrac{x_1\\! + \\!Q_{m, 1}}{\\alpha}\\big)\\! \\sum_{n =1}^N \\exp \\! \\big(\\dfrac{x_n \\! +\\! Q_{m, n}}{\\alpha}\\big)\n        \\!-\\! \\exp \\! \\big(\\dfrac{x_1\\! + \\! Q_{m, 1}}{\\alpha}\\big)\\! \\sum_{n =1}^N x_n\\exp \\! \\big(\\dfrac{x_n \\! +\\! Q_{m, n}}{\\alpha}\\big)}\n        {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{x_n + Q_{m, n}}{\\alpha}\\big)\\Big]^2} \\\\[0.05cm]\n    \\vdots \\\\[0.1cm]\n        \\dfrac{x_N\\exp \\!\\big(\\dfrac{x_N \\! +\\! Q_{m, N}}{\\alpha}\\big)\\! \\sum_{n =1}^N \\exp \\!\\big(\\dfrac{x_n \\! +\\! Q_{m, n}}{\\alpha}\\big)\n        \\!-\\!\\exp \\!\\big(\\dfrac{x_N \\!+\\! Q_{m, N}}{\\alpha}\\big)\\! \\sum_{n =1}^N x_n\\exp \\!\\big(\\dfrac{x_n \\! + \\! Q_{m, n}}{\\alpha}\\big)}\n        {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{x_n +  Q_{m, n}}{\\alpha}\\big)\\Big]^2}\n    \\end{bmatrix}\\notag\n\\end{aligned}')
('9.2', '\\partial J^{\\pi}_m(X) / \\partial X = O')
('9.2', 'X = O')
('9.2', '\\partial J^{\\pi}_m(X)')
('9.2', 'J^{\\pi}_m(X)')
('9.2', 'J^{\\pi}_m(X)')
('9.2', 'X=0')
('9.2', '\\begin{aligned}\n    &\\frac{\\partial^2 J^{\\pi}_m(X)}{\\partial x_j^2} \\bigg|_{X=0} =  \n    \\dfrac{\\exp\\big(\\dfrac{Q_{m, j}}{\\alpha}\\big)\\sum_{n=1, n\\neq j}^N \\exp  \\big(\\dfrac{ Q_{m, n}}{\\alpha}\\big)}   \n    {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{Q_{m, n}}{\\alpha}\\big)\\Big]^2} \\label{partial11}\\\\[0.3cm]\n    &\\frac{\\partial^2 J^{\\pi}_m(X)}{\\partial x_j\\partial x_k} \\bigg|_{X=0} = \n    \\dfrac{-\\exp\\big(\\dfrac{Q_{m, j}}{\\alpha}\\big)\\exp\\big(\\dfrac{Q_{m, k}}{\\alpha}\\big)}   \n    {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{Q_{m, n}}{\\alpha}\\big)\\Big]^2}\\label{partial12}  \n\\end{aligned}')
('9.2', 'J^{\\pi}_m(X)')
('9.2', 'X=O')
('9.2', '\\begin{aligned}\n\\label{Taylor}\n    &\\lim\\limits_{X \\rightarrow O} \\! J^{\\pi}_m(X) \\\\[0.3cm]\n    &= J^{\\pi}_m(O)+ X^T\\Big[\\frac{\\partial J^{\\pi}_m(X)}{\\partial X}\\Big]_{\\! X \\! =O} \n    + \\frac{1}{2}X^T\n    \\begin{bmatrix}\n         \\dfrac{\\partial^2 J^{\\pi}_m(X)}{\\partial x_1^2}  & \\cdots & \\dfrac{\\partial^2 J^{\\pi}_m(X)}{\\partial x_1\\partial x_N} \\\\[0.05cm]\n        \\vdots & \\ddots&\\vdots \\\\[0.1cm]\n        \\dfrac{\\partial^2 J^{\\pi}_m(X)}{\\partial x_1\\partial x_N} &\\cdots &\\dfrac{\\partial^2 J^{\\pi}_m(X)}{\\partial x_1^2} \n    \\end{bmatrix}_{ \\! \\! X \\! = O \\!}\n    X+ o(X^2) \\notag\\\\[0.5cm]\n    &= \\dfrac{1}{2}X^T \\!\\!\n    \\begin{bmatrix}\n        \\dfrac{\n        \\exp \\! \\big(  \\! \\dfrac{ Q_{m, 1} } {\\alpha} \\! \\big)\n        \\! \\sum_{n=1, n\\neq j}^N \\!\n        \\exp \\! \\big(  \\! \\dfrac{ Q_{m, n} } {\\alpha} \\! \\big)} \n        {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{Q_{m, n}}{\\alpha}\\big)\\Big]^2}\\!\\!\\!\n        & \\cdots \n        & \\dfrac{\n        -\\exp\\big(  \\! \\dfrac{ Q_{m, 1} } {\\alpha} \\! \\big)\n        \\exp\\big(  \\! \\dfrac{ Q_{m, N} } {\\alpha} \\! \\big)} \n        {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{Q_{m, n}}{\\alpha}\\big)\\Big]^2}\n         \\\\[0.05cm]\n        \\vdots & \\ddots&\\vdots \\\\[0.1cm]\n        \\dfrac{\n        -\\exp\\big(  \\! \\dfrac{ Q_{m, N} } {\\alpha} \\! \\big)\n        \\exp\\big(  \\! \\dfrac{ Q_{m, 1} } {\\alpha} \\! \\big)} \n        {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{Q_{m, n}}{\\alpha}\\big)\\Big]^2} \n        &\\cdots \n        &\\!\\!\\dfrac{\n        \\exp \\! \\big(  \\! \\dfrac{ Q_{m, 1} } {\\alpha} \\! \\big)\n        \\! \\sum_{n=1, n\\neq j}^N \\! \n        \\exp \\! \\big(  \\! \\dfrac{ Q_{m, n} } {\\alpha} \\! \\big)} \n        {\\Big[\\alpha\\sum_{n=1}^{N}\\exp \\big(\\dfrac{Q_{m, n}}{\\alpha}\\big)\\Big]^2}\n    \\end{bmatrix}\n    \\!\\! X \\! + o(X^2) \\notag\n\\end{aligned}')
('9.2', '\\mathbb{E}_{\\pi_m}[X^2]')
('9.2', '\\mathbb{E}_{\\pi_m}(X)^2')
('9.2', '\\begin{aligned}\n    &\\lim\\limits_{X \\rightarrow O}   J^{\\pi}_m(X) \\notag\\\\  \n    &= \\dfrac{1}{2\\Big[ \\alpha   \\sum_{  n=1   }^{N}  \\exp    \\big(   \\dfrac{Q_{  m,  n}}{\\alpha}   \\big)\\Big]^2}\\bigg(\n    X^T   \n    \\begin{bmatrix}\n        \\exp\\big(    \\dfrac{ Q_{m, 1} } {\\alpha}   \\big)           & &  \\\\[0.05cm]\n        & \\ddots&\\\\[0.05cm]\n        &  &          \\exp\\big(    \\dfrac{ Q_{m, N} } {\\alpha}   \\big)\n    \\end{bmatrix}    X \\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\sum}{$\\m@th.5\\bullet$}}}}_{n=1}^{N}  \\exp    \\big(    \\dfrac{ Q_{m, n} } {\\alpha}   \\big) \\notag\\\\[0.5cm]\n    &\\quad - X^T   \n    \\begin{bmatrix}\n        \\exp\\big(    \\dfrac{ Q_{m, 1} } {\\alpha}   \\big)^2  &\\cdots & \n        \\exp\\big(    \\dfrac{ Q_{m, 1} } {\\alpha}   \\big)\n        \\exp\\big(    \\dfrac{ Q_{m, N} } {\\alpha}   \\big) \\\\[0.05cm]\n        \\vdots& \\ddots& \\vdots \\\\[0.1cm]\n        \\exp\\big(    \\dfrac{ Q_{m, N} } {\\alpha}   \\big)\n        \\exp\\big(    \\dfrac{ Q_{m, 1} } {\\alpha}   \\big)\n    & \\cdots & \\exp\\big(    \\dfrac{ Q_{m, 1} } {\\alpha}   \\big)^2\n    \\end{bmatrix}  X\\bigg)+ o(X^2)\\notag\\\\[0.3cm]\n    &=\\dfrac{1}{2\\alpha^2}\\bigg(\n    \\dfrac{\\sum_{n=1}^N x_n^2\\exp\\big(    \\dfrac{ Q_{m, n} } {\\alpha}   \\big)}\n    {\\sum_{  n=1   }^{N}  \\exp    \\big(   \\dfrac{Q_{  m,  n}}{\\alpha}   \\big)}\n    - \\dfrac{\\sum_{  n=1   }^{N} \\sum_{  j=1   }^{N}x_n x_j \n    \\exp\\big(    \\dfrac{ Q_{m, n} } {\\alpha}   \\big)\n    \\exp\\big(    \\dfrac{ Q_{m, j} } {\\alpha}   \\big)}\n    {\\Big[    \\sum_{  n=1   }^{N}  \\exp    \\big(   \\dfrac{Q_{  m,  n}}{\\alpha}              \\big)\\Big]^2}\\bigg)+ o(X^2)\\notag\\\\[0.2cm]\n    &=\\dfrac{1}{2\\alpha^2}\\! \\bigg(\\!\\sum_{n=1}^N x_n^2\\frac{\n        \\exp\\big(  \\! \\dfrac{ Q_{m, n} } {\\alpha} \\! \\big)}\n    {{\\sum_{  j=1 \\! }^{N}  \\exp  \\! \\big( \\! \\dfrac{Q_{\\! m,  j}}{\\alpha} \\! \\big)}}\n    \\!- \\! \\sum_{  n=1 \\! }^{N}x_n\n    \\dfrac{\\exp\\big(  \\! \\dfrac{ Q_{m, n} } {\\alpha} \\! \\big)}\n    {\\sum_{  k=1 \\! }^{N}  \\exp  \\! \\big( \\! \\dfrac{Q_{\\! m,  k}}{\\alpha} \\! \\big)}\n    \\sum_{  j=1 \\! }^{N}x_j\n    \\dfrac{\\exp\\big(  \\! \\dfrac{ Q_{m, j} } {\\alpha} \\! \\big)}\n    {\\sum_{  k=1 \\! }^{N}  \\exp  \\! \\big( \\! \\dfrac{Q_{\\! m,  k}}{\\alpha} \\! \\big)}\\!\\bigg) \n    \\! + \\! o(X^2)\n    \\notag\\\\[0.2cm]\n    &=\\dfrac{1}{2\\alpha^2}\\bigg(\\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{x}{$\\m@th.5\\bullet$}}}}_n^2    \n    -\\Big[ \\sum_{n=1}^N\\pi_m(a^d_{m,n}|s(t);\\theta_d)\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{x}{$\\m@th.5\\bullet$}}}}_n\\Big]^2\\bigg) + o(X^2)\\notag\\\\[0.2cm]\n    &=\\dfrac{1}{2\\alpha^2}\\mathbb{E}_{\\pi_m}\\bigg[\\Big(Q_d\\big(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d\\big)- Q\\big(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\};\\theta_Q\\big)-\\delta\\Big)^2\\bigg] \\notag\\\\[0.1cm]\n    &\\quad -  \\bigg(\\mathbb{E}_{\\pi_m}\\Big[Q_d\\big(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d\\big)- Q\\big(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\};\\theta_Q\\big)-\\delta\\Big]\\bigg)^2+ o(X^2)\\notag\\\\[0.2cm]\n    &=\\dfrac{1}{2\\alpha^2}\\sigma_{\\pi_m}^2\\Big[Q_d\\big(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d\\big)- Q\\big(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\};\\theta_Q\\big)-\\delta\\Big]+ o(X^2)\\notag\\\\[0.2cm]\n    &=\\dfrac{1}{2\\alpha^2}\\sigma_{\\pi_m}^2\\Big[Q_d\\big(s(t),\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{\\ }{$\\m@th.5\\bullet$}}}};\\theta_d\\big)- Q\\big(s(t),\\{\\mathpalette\\mathbin{\\vcenter{\\hbox{\\scalebox{,}{$\\m@th.5\\bullet$}}}}\\overline{a}_m(t)\\};\\theta_Q\\big)\\Big]+ o(X^2)\\label{supereqproof}\n\\end{aligned}')
('9.2', '\\dfrac{1}{2\\alpha^2}')
('10', '376')
('10', '111')
('11.0', 'N')
('11.0', 'N')
('11.0', 'N')
('11.0', 'N=10, 20')
('11.0', '50')
('11.0', 'N')
('11.0', 'N')
('11.0', 'N')
('11.0', 'N')
('11.0', 'M\\times N')
('11.0', 'N')
('11.0', 'N')
('11.0', 'N')
('11.1', '\\hat{\\mathcal{H}}')
('11.1', '\\hat{\\mathcal{H}}')
('11.1', '-\\dim(\\mathcal{A})')
('11.1', '\\hat{\\mathcal{H}}=-1')
('11.1', '\\hat{\\mathcal{H}}=1')
('11.1', '\\hat{\\mathcal{H}}')
('11.1', '\\hat{\\mathcal{H}}')
('11.1', '\\hat{\\mathcal{H}}')
('11.2', '\\hat{\\mathcal{H}}=1')
('11.2', '\\hat{\\mathcal{H}}=0')
('11.2', '\\hat{\\mathcal{H}}=-1')
('11.2', '\\hat{\\mathcal{H}}')
('11.5', '\\widetilde{a}(t+1)')
('11.5', '\\alpha')
('11.5', "alpha'")
('11.5', "\\alpha'")
('11.5', "\\alpha'")
('11.5', "\\alpha'")
