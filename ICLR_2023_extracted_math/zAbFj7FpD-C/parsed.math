('2.0', '\\mathbf{s}_t \\in {\\mathcal{S}}')
('2.0', '\\mathbf{a}_t \\in {\\mathcal{A}}')
('2.0', 't')
('2.0', 'r_t = r (\\mathbf{s}_t , \\mathbf{a}_t)')
('2.0', '\\mathbf{s}_{t+1} \\sim p_\\textrm{env} (\\mathbf{s}_{t+1} | \\mathbf{s}_t, \\mathbf{a}_t)')
('2.0', 'p_\\theta (\\mathbf{a}_t | \\mathbf{s}_t)')
('2.0', '\\theta')
('2.0', 'p_\\theta (\\mathbf{a}_t | \\mathbf{s}_t) = \\mathcal{U} (-1, 1)')
('2.0', '\\mathcal{R} (\\tau) = \\sum_t \\gamma^t r_t')
('2.0', '\\gamma \\in ( 0, 1 ]')
('2.0', '\\tau = (\\mathbf{s}_1, \\mathbf{a}_1, \\dots)')
('2.0', 'p (\\tau) = \\rho (\\mathbf{s}_1) \\prod_{t=1}^{T-1} p_\\textrm{env} (\\mathbf{s}_{t+1} | \\mathbf{s}_t, \\mathbf{a}_t) p_\\theta (\\mathbf{a}_t | \\mathbf{s}_t),')
('2.0', '\\rho (\\mathbf{s}_1)')
('2.0', '\\mathbb{E}_{p (\\tau)} \\left[ {\\mathcal{R}}(\\tau) \\right]')
('2.0', '\\gamma = 1')
('2.0', '\\gamma')
('2.1', '\\mathcal{O}')
('2.1', 'p (\\mathcal{O} = 1 | \\tau ) \\propto \\exp \\big( \\mathcal{R} (\\tau) / \\alpha \\big), \\nonumber')
('2.1', '\\alpha')
('2.1', '\\tau')
('2.1', '\\theta')
('2.1', '\\log p(\\mathcal{O} = 1)')
('2.1', 'p(\\mathcal{O} = 1) = \\int p(\\tau, \\mathcal{O}=1) d \\tau \\nonumber')
('2.1', '\\pi(\\tau | \\mathcal{O}) = \\rho (\\mathbf{s}_1) \\prod_{t=1}^{T-1} p_\\textrm{env} (\\mathbf{s}_{t+1} | \\mathbf{s}_t , \\mathbf{a}_{t}) \\pi (\\mathbf{a}_t | \\mathbf{s}_t , \\mathcal{O}).')
('2.1', '\\begin{aligned}\n    \\log p(\\mathcal{O} = 1) & = \\log \\int p(\\mathcal{O}=1|\\tau) p(\\tau) d \\tau \\\\\n    & \\geq \\int \\pi(\\tau | \\mathcal{O}) \\bigg[ \\log \\frac{p(\\mathcal{O}=1|\\tau) p(\\tau)}{\\pi(\\tau | \\mathcal{O})} \\bigg] d \\tau \\label{eq: iapo exact integration}\\\\\n    &= \\mathbb{E}_\\pi [\\mathcal{R} (\\tau) / \\alpha] - D_{\\mathrm{KL}}(\\pi(\\tau | \\mathcal{O})\\|p(\\tau)) .\n\\end{aligned}')
('2.1', '\\alpha')
('2.1', '\\mathcal{J} (\\pi, \\theta) \\equiv \\mathbb{E}_\\pi [\\mathcal{R} (\\tau)] - \\alpha D_{\\mathrm{KL}}(\\pi(\\tau | \\mathcal{O})\\|p(\\tau)). \\label{eqn:obj}')
('2.1', '\\pi(\\tau | \\mathcal{O})')
('2.1', 'p(\\tau)')
('2.1', '\\mathcal{J} (\\pi, \\theta) = \\mathbb{E}_{\\substack{\\mathbf{s}_t, r_t \\sim p_\\textrm{env} \\\\ \\mathbf{a}_t \\sim \\pi }} \\left[ \\sum_{t=1}^T r_t - \\alpha\\log \\frac{\\pi ( \\mathbf{a}_t | \\mathbf{s}_t, \\mathcal{O})}{p_\\theta (\\mathbf{a}_t | \\mathbf{s}_t)} \\right].')
('2.1', 't')
('2.1', 'Q_\\pi')
('2.1', '\\mathbf{s}_t \\sim p_\\textrm{env}')
('2.1', 't')
('2.1', '\\mathcal{J} (\\pi, \\theta) = \\mathbb{E}_{\\pi} \\left[ Q_\\pi (\\mathbf{s}_t , \\mathbf{a}_t ) \\right] - \\alpha D_{\\mathrm{KL}}(\\pi (\\mathbf{a}_t | \\mathbf{s}_t, \\mathcal{O}) || p_\\theta (\\mathbf{a}_t | \\mathbf{s}_t)).\n    \\label{eq: iapo Q and KL obj}')
('2.1', '\\mathcal{J}')
('2.1', '\\pi')
('2.1', '\\pi')
('2.1', '\\bm{\\lambda}')
('2.1', '\\bm{\\mu}')
('2.1', '\\bm{\\sigma}^2')
('2.1', '\\bm{\\lambda} \\leftarrow \\textrm{arg} \\max_{\\bm{\\lambda}} \\mathcal{J} (\\pi, \\theta).\n    \\label{eq: generic policy opt}')
('2.1', '\\theta')
('2.2', 'f_\\phi')
('2.2', '\\bm{\\lambda}')
('2.2', '\\mathbf{s}')
('2.2', '\\begin{aligned}\n    \\bm{\\lambda} \\leftarrow f_\\phi (\\mathbf{s}), && \\text{(direct amortization)}\n    \\label{eq: iapo direct amortization}\n\\end{aligned}')
('2.2', '\\pi_\\phi (\\mathbf{a} | \\mathbf{s}, \\mathcal{O}; \\bm{\\lambda})')
('2.2', 'f_\\phi')
('2.2', '\\pi_\\phi (\\mathbf{a} | \\mathbf{s}) = p_\\theta (\\mathbf{a} | \\mathbf{s})')
('2.2.0', '\\pi_\\phi')
('2.2.0', '\\widehat{\\pi}')
('2.2.0', '\\mathcal{J} (\\pi_\\phi, \\theta) \\leq \\mathcal{J} (\\widehat{\\pi}, \\theta). \\nonumber')
('2.2.0', '\\mathcal{J}')
('2.2.0', '\\mathcal{J}')
('2.2.0', '\\mathbin{\\blacklozenge}')
('2.2.0', '\\bigstar')
('2.2.0.1', 'Q_\\pi (\\mathbf{s}, \\mathbf{a})')
('2.2.0.1', 'p_\\theta (\\mathbf{a} | \\mathbf{s})')
('2.3', 'Q')
('3.0', '\\begin{aligned}\n    \\bm{\\lambda} \\leftarrow f_\\phi (\\mathbf{s}, \\bm{\\lambda}, \\nabla_{\\bm{\\lambda}} \\mathcal{J}), && \\text{(iterative amortization)}\n\\end{aligned}')
('3.0', 'f_\\phi')
('3.0', '\\bm{\\lambda}')
('3.0', '\\pi = \\mathcal{N} (\\mathbf{a}; \\bm{\\mu}, \\operatorname{diag}(\\bm{\\sigma}^2))')
('3.0', '\\bm{\\lambda} \\equiv \\left[\\bm{\\mu}, \\bm{\\sigma}  \\right]')
('3.0', '\\mathbf{s}')
('3.0', '\\mathcal{J}')
('3.0', '\\bm{\\omega}_\\phi \\in [0, 1]')
('3.0', '\\bm{\\delta}_\\phi')
('3.0', 'f_\\phi')
('3.0', '\\bm{\\lambda} \\leftarrow \\bm{\\omega}_\\phi \\odot \\bm{\\lambda} + (\\mathbf{1} - \\bm{\\omega}_\\phi) \\odot \\bm{\\delta}_\\phi,\n    \\label{eq: iapo gated update}')
('3.0', '\\odot')
('3.0', '\\nabla_\\phi \\mathcal{J}')
('3.0', '\\nabla_{\\bm{\\lambda}} \\mathcal{J}')
('3.0', '\\mathcal{J}')
('3.0', 'Q')
('3.1.0', '\\bullet')
('3.2', 'Q_\\pi')
('3.2', '\\widehat{Q}_\\pi')
('3.2', 'Q')
('3.2', 'Q')
('3.2', 'Q')
('3.2', 'Q')
('3.2', 'Q_{\\psi_1}')
('3.2', 'Q_{\\psi_2}')
('3.2', '\\widehat{Q}_\\pi (\\mathbf{s}, \\mathbf{a}) = \\min_{i=1,2} Q_{\\psi_i^\\prime} (\\mathbf{s}, \\mathbf{a}), \\nonumber')
('3.2', '\\psi_i^\\prime')
('3.2', 'Q')
('3.2', '\\widehat{Q}_\\pi (\\mathbf{s}, \\mathbf{a}) = \\mu_Q (\\mathbf{s}, \\mathbf{a}) - \\beta \\sigma_Q (\\mathbf{s}, \\mathbf{a}),\n    \\label{eq: iapo pessimistic value est}')
('3.2', '\\mu_Q (\\mathbf{s}, \\mathbf{a}) \\equiv \\frac{1}{2} \\sum_{i=1,2} Q_{\\psi_i^\\prime} (\\mathbf{s}, \\mathbf{a})')
('3.2', '\\sigma_Q (\\mathbf{s}, \\mathbf{a}) \\equiv (\\frac{1}{2} \\sum_{i=1,2} (Q_{\\psi_i^\\prime} (\\mathbf{s}, \\mathbf{a}) -  \\mu_Q (\\mathbf{s}, \\mathbf{a}))^2 )^{1/2}')
('3.2', '\\beta = 1')
('3.2', '\\beta')
('3.2', '\\beta')
('3.2', '\\beta')
('3.2', '\\beta = 1')
('3.2', '\\beta = 2.5')
('3.2', '\\alpha')
('3.2', 'Q')
('3.2', '\\beta')
('4.0', 'Q')
('4.0', 'p_\\theta (\\mathbf{a} | \\mathbf{s}) = \\mathcal{U}(-1, 1)')
('4.0', '\\alpha')
('4.0', '5')
('4.1.1', '\\pm')
('4.1.1', '5')
('4.1.2', '\\mathcal{J}')
('4.1.2', '10')
('4.1.2', '\\pm')
('4.1.2', '5')
('4.1.2', '100')
('4.1.2', '\\pm')
('4.1.2', '5')
('4.1.3', '\\mathcal{J}')
('4.1.3', '\\bm{\\lambda} \\equiv \\left[ \\bm{\\mu}, \\bm{\\sigma} \\right]')
('4.1.3', '5')
('4.1.3', '5')
('4.1.3', 'Q')
('4.1.3', '\\{ 1, 2, 5 \\}')
('4.1.3', 'Q')
('4.1.3', '\\bm{\\mu}')
('4.1.3', 'i')
('4.1.3', 'j')
('4.1.3', '3')
('4.1.3', '10')
('5', 'Q')
('5', '\\beta')
('7', '4.20')
('7', '2')
('7', '1')
('7.0', '\\mathcal{J}')
('7.0', '\\bm{\\mu}')
('7.0', '1')
('7.0', '3')
('7.0', '2')
('7.0', '6')
('7.1', 'Q')
('7.1', 'Q')
('7.1', '\\widehat{Q}_\\pi')
('7.1', 'Q_\\pi')
('7.1', '100')
('7.1', '\\mathbb{E}_{\\mathbf{s}, \\mathbf{a}} \\left[ \\widehat{Q}_\\pi - Q_\\pi \\right]')
('7.1', 'Q_\\pi')
('7.1', '100')
('7.1', '\\gamma = 0.99')
('7.1', '\\alpha')
('7.1', '\\pm')
('7.1', '100')
('7.2', '\\mathcal{J}')
('7.2', 'Q')
('7.2', '\\widehat{\\pi}')
('7.2', '\\mathcal{J}')
('7.2', '\\bm{\\lambda}')
('7.2', '\\pi_\\phi')
('7.2', '5 \\times 10^{-3}')
('7.2', '100')
('7.2', '\\widehat{\\pi}')
('7.2', '100')
('7.2', '\\mathcal{J} (\\theta, \\widehat{\\pi}) - \\mathcal{J} (\\theta, \\pi)')
('7.2', '\\pm')
('7.2', '5')
('7.3', 'Q')
('7.3.0', '\\alpha')
('7.3.0', '\\epsilon_\\alpha = |\\mathcal{A}|')
('7.3.0', '|\\mathcal{A}|')
('7.3.0', '\\mathbf{s}')
('7.3.0', '\\bm{\\lambda}')
('7.3.0', '\\mathbf{s}')
('7.3.0', '\\bm{\\lambda}')
('7.3.0', '\\nabla_{\\bm{\\lambda}} \\mathcal{J}')
('7.3.0', '\\bm{\\delta}')
('7.3.0', '\\bm{\\omega}')
('7.3.0.0', '\\texttt{tanh}')
('7.3.0.0', '\\mathbf{a} \\in [-1, 1]')
('7.3.0.0', '\\bm{\\lambda} = \\left[ \\bm{\\mu}, \\bm{\\sigma} \\right]')
('7.3.0.0', '\\bm{\\delta}')
('7.3.0.0', '\\bm{\\omega}')
('7.3.0.0', '\\bm{\\mu}')
('7.3.0.0', '\\bm{\\sigma}')
('7.3.0.0', '\\bm{\\mu} = \\mathbf{0}')
('7.3.0.0', '\\bm{\\sigma} = \\mathbf{1}')
('7.3.0.0', 'Q')
('7.3.0.0', 'Q')
('7.3.0.1', 'Q')
('7.3.0.1', 'Q')
('7.3.0.1', '2')
('7.3.0.1', 'Q')
('7.3.0.2', '\\beta')
('7.3.0.2', '\\beta = 1')
('7.3.0.2', '\\beta')
('7.3.0.2', '\\beta = 1.5')
('7.3.0.2', '\\beta=2.5')
('7.3.0.2', '\\beta = 1')
('7.3.0.2', '(\\gamma)')
('7.3.0.2', '0.99')
('7.3.0.2', 'Q')
('7.3.0.2', '(\\tau)')
('7.3.0.2', '5 \\cdot 10^{-3}')
('7.3.0.2', '3 \\cdot 10^{-4}')
('7.3.0.2', '256')
('7.3.0.2', '5 \\cdot 10^3')
('7.3.0.2', '10^6')
('7.4', '2')
('7.4', 'Q')
('7.4.0', 'p_\\textrm{env} (\\mathbf{s}_{t+1} | \\mathbf{s}_t , \\mathbf{a}_t)')
('7.4.0', 'r (\\mathbf{s}_t , \\mathbf{a}_t)')
('7.4.0', '\\Delta_{\\mathbf{s}_t}')
('7.4.0', '\\bm{\\mu}_{\\mathbf{s}_{t+1}} = \\mathbf{s}_t + \\Delta_{\\mathbf{s}_t}. \\nonumber')
('7.4.0', 'h')
('7.4.0', '\\lambda')
('7.4.0', '10^3')
('7.4.0', 'p_\\theta (\\mathbf{a}_t | \\mathbf{s}_t)')
('7.4.0', 'r (\\mathbf{s}_t, \\mathbf{a}_t)')
('7.4.0', '\\mathbf{s}_{t+1} | \\mathbf{s}_t, \\mathbf{a}_t')
('7.4.0', 'H')
('7.4.0', 'Q')
('7.4.0.0', 'Q')
('7.4.0.0', '256')
('7.4.0.0', '10^3')
('7.4.0.1', 'Q')
('7.4.0.1', 'Q')
('7.4.0.1', 'Q')
('7.4.0.1', 'Q')
('7.4.0.1', '\\widehat{Q}_\\psi (\\mathbf{s} , \\mathbf{a})')
('7.4.0.1', '\\widehat{r} (\\mathbf{s}, \\mathbf{a})')
('7.4.0.1', 'Q')
('7.4.0.1', '\\widehat{Q}_\\pi (\\mathbf{s}_t , \\mathbf{a}_t) = \\widehat{Q}_\\psi (\\mathbf{s}_t , \\mathbf{a}_t) + \\mathbb{E} \\left[ \\sum_{t^\\prime = t}^{t+h} \\gamma^{t^\\prime - t} \\lambda^{t^\\prime - t} \\delta_{t^\\prime} \\right],\n    \\label{eq: iapo retrace}')
('7.4.0.1', '\\delta_{t^\\prime}')
('7.4.0.1', '\\delta_{t^\\prime} \\equiv \\widehat{r} (\\mathbf{s}_{t^\\prime}, \\mathbf{a}_{t^\\prime}) + \\gamma \\widehat{V}_\\psi (\\mathbf{s}_{t^\\prime + 1})  - \\widehat{Q}_\\psi (\\mathbf{s}_{t^\\prime} , \\mathbf{a}_{t^\\prime}),')
('7.4.0.1', '\\lambda')
('7.4.0.1', 'h')
('7.4.0.1', 'V_\\pi (\\mathbf{s})')
('7.4.0.1', 'V_\\pi (\\mathbf{s}) = \\mathbb{E}_\\pi \\left[ Q_\\pi (\\mathbf{s}, \\mathbf{a}) - \\alpha \\log \\frac{\\pi (\\mathbf{a} | \\mathbf{s}, \\mathcal{O})}{p_\\theta (\\mathbf{a} | \\mathbf{s})} \\right].\n    \\label{eq: iapo state value def}')
('7.4.0.1', 'V_\\pi')
('7.4.0.1', 'Q')
('7.4.0.1', 'Q_\\pi')
('7.4.0.1', '\\widehat{V}_\\psi (\\mathbf{s})')
('7.4.0.1', 'Q')
('7.4.0.1', 'Q')
('7.4.0.2', '\\pi')
('7.4.0.2', 'p_\\theta (\\mathbf{a} | \\mathbf{s})')
('7.4.0.2', 'D_\\textrm{KL} (\\pi_\\textrm{it.} || \\pi_\\textrm{dir.})')
('7.4.0.2', '\\pm')
('7.4.0.2', '4')
('7.4.0.3', '1')
('8.0', '5')
('8.0', '\\pm')
('8.0', '5')
('8.1', '2')
('8.1', '256')
('8.1', '\\mathcal{J}')
('8.2', '5')
('8.3', '100')
('8.3', '\\mathcal{J}')
('8.3', '0.01')
('8.3', '10')
('8.3', '100')
('8.3', '10')
('8.3', '64')
('8.3', '6')
('8.3', '5')
('8.3', '1.25 \\times')
('8.3', '1.15 \\times')
('8.5', 'Q')
('8.5', '\\mathcal{J}')
('8.5', 'Q')
('8.5', '1')
('8.5', '2')
('8.5', '5')
('8.5', '1')
('8.5', '2')
('8.5', '5')
('8.5', '50')
('8.5', '5')
('8.5', '5')
('8.6', '10')
('8.6', '[-1, 1]')
('8.6', '2 \\sqrt{|\\mathcal{A}|}')
('8.6', '|\\mathcal{A}|')
('8.6', '100')
('8.6', '5')
('8.6', '\\bm{\\mu}')
('8.6', 'i')
('8.6', 'j')
('8.6', '3')
('8.6', '10')
